Compiling Program: L:\Vdf6\Develop\Empor\AppSrc\test2.src
Memory Available: 2147483647
1>Use AllEntSc
Using pre-compiled package ALLENTSC
INCLUDING FILE: ALLENTSC.PKI
30325>
30325>Register_Object Client_Area
30325>
30325>//AB-StoreTopStart
30325>Use Workspc.pkg
30325>
30325>// Set date attributes as needed
30325>Set_Date_Attribute sysdate4_State to (TRUE)
30326>Set_Date_Attribute Date4_State    to (TRUE)
30327>Set_Date_Attribute epoch_value    to 30
30328>
30328>Object ProgramWorkspace is a WorkspaceSub
30330>    Set WorkspaceName to CURRENT$WORKSPACE
30331>    Set kEnter_Next_State to True
30332>//    Set ModuleName    to 'ProgramName' // Special module name.
30332>//    Set HelpName      to 'HelpName.hlp'// Please provide the name of your Windows help file.
30332>End_Object
30333>
30333>Use Help_Ids.inc // Developer should provide this file of help context links.
INCLUDING FILE: HELP_IDS.INC
30333>>>// Help_ids.inc
30333>>>//
30333>>>// Context ids for the order entry system. This uses
30333>>>// help file ordentry.hlp.
30333>>>//
30333>>>// This is a sample version. YOU must supply
30333>>>// the ID values
30333>>>
30333>>>//  Generic Context Ids
30333>>>//
30333>>>
30333>>>// It is expected that file-names ids will be the same as their
30333>>>// filenumber.
30333>>>
30333>>>
30333>>>//  View and selection-list specific context ids
30333>>>//
30333>>>//..........add view, object, selection-list ids here....
30333>Use Std_Help.pkg
INCLUDING FILE: STD_HELP.PKG
30333>>>// STD_HELP.PKG
30333>>>//
30333>>>// Global Help Object
30333>>>//
30333>>>//  Creates all Help Support required to access WINDOWs help system
30333>>>//  with DataFlex. Creates a global object named Help_Object.
30333>>>//
30333>>>//  9/19/97 JJT - Modified to define stadnard help Ids if they are undefined
30333>>>
30333>>>use DFHlpSys // Context Sensitive Help Support
30333>>>
30333>>>
30333>>>// This file needs to be provided by the developer. It will contain
30333>>>// symbolic replacements for the ID integer values used to access the
30333>>>// the windows help file's topics.
30333>>>//
30333>>>use Help_ids.inc
30333>>>
30333>>>// If the following are not defined in help_ids.inc,
30333>>>//  create default 0 values for them
30333>>>Define GeneralHelpId    for    0
30333>>>Define KeysHelpId       for    0
30333>>>Define FileHelpId       for    0
30333>>>Define ErrorHelpId      for    0  // probably not used in VDF
30333>>>Define IndexHelpId      for    0  // probably not used in VDF
30333>>>
30333>>>object Help_Object is a HelpSystem // global help object
30335>>>
30335>>>   Set Help_Id_General to GeneralHelpId    // these should all be defined
30336>>>   Set Help_Id_Index   to IndexHelpId      // in help_ids.inc.
30337>>>   Set Help_Id_Keys    to KeysHelpId       //
30338>>>   Set Help_Id_Files   to FileHelpId       //
30339>>>   Set Help_Id_Errors  to ErrorHelpId      //
30340>>>
30340>>>end_object
30341>Use WinQlSQL.Sub
INCLUDING FILE: WINQLSQL.SUB
30341>>>Use CrystalReport.pkg
30341>>>
30341>>>
30341>>>
30341>>>Type PEWindowOptions
30341>>>  Field PEWindowOptions.StructSize As Word
30341>>>  Field PEWindowOptions.hasGroupTree As Word
30341>>>  Field PEWindowOptions.canDrillDown As Word
30341>>>  Field PEWindowOptions.hasNavigationControls As Word
30341>>>  Field PEWindowOptions.hasCancelButton As Word
30341>>>  Field PEWindowOptions.hasPrintButton As Word
30341>>>  Field PEWindowOptions.hasExportButton As Word
30341>>>  Field PEWindowOptions.hasZoomControl As Word
30341>>>  Field PEWindowOptions.hasCloseButton As Word
30341>>>  Field PEWindowOptions.hasProgressControls As Word
30341>>>  Field PEWindowOptions.hasSearchButton As Word
30341>>>  Field PEWindowOptions.hasPrintSetupButton As Word
30341>>>  Field PEWindowOptions.hasRefreshButton As Word
30341>>>End_Type // PEWindowOptions
30341>>>
30341>>>External_Function32 PESetWindowOptions "PESetWindowOptions" CRPE32.DLL ;  Integer printJob pointer Options Returns Integer
30342>>>
30342>>>Class CrystalReportSubSQL Is A CrystalReport
30343>>>
30343>>>    Procedure Construct_Object
30344>>>        Forward send Construct_Object
30346>>>        // Everything on except hasGroupTree by default
30346>>>        property integer hasGroupTree 0
30347>>>        property integer canDrillDown 1
30348>>>        property integer hasNavigationControls 1
30349>>>        property integer hasCancelButton 1
30350>>>        property integer hasPrintButton 1
30351>>>        property integer hasExportButton 1
30352>>>        property integer hasZoomControl 1
30353>>>        property integer hasCloseButton 1
30354>>>        property integer hasProgressControls 1
30355>>>        property integer hasSearchButton 1
30356>>>        property integer hasPrintSetupButton 1
30357>>>        property integer hasRefreshButton 1
30358>>>
30358>>>        Set WindowStyle To (WS_MAXIMIZE iOr WS_OVERLAPPEDWINDOW)
30359>>>    End_Procedure // Construct_Object
30360>>>
30360>>>    Procedure OutputToWindow String sTitle Integer iLeft Integer iTop Integer iWidth Integer iHeight Integer iStyle Handle hParent
30361>>>        Integer iPrintJob iResult
30362>>>        String sPEWindowOptions
30362>>>        Pointer pPeWindowOptions
30362>>>
30362>>>        Get PrintJob To iPrintJob
30363>>>        FillType PEWindowOptions with 0     to sPEWindowOptions
30364>>>        put PEWindowOptions_Size            to sPEWindowOptions at PEWindowOptions.StructSize
30365>>>        put (hasGroupTree(self))            to sPEWindowOptions at PEWindowOptions.hasGroupTree
30366>>>        put (canDrillDown(self))            to sPEWindowOptions at PEWindowOptions.canDrillDown
30367>>>        put (hasNavigationControls(self))   to sPEWindowOptions at PEWindowOptions.hasNavigationControls
30368>>>        put (hasCancelButton(self))         to sPEWindowOptions at PEWindowOptions.hasCancelButton
30369>>>        put (hasPrintButton(self))          to sPEWindowOptions at PEWindowOptions.hasPrintButton
30370>>>        put (hasExportButton(self))         to sPEWindowOptions at PEWindowOptions.hasExportButton
30371>>>        put (hasZoomControl(self))          to sPEWindowOptions at PEWindowOptions.hasZoomControl
30372>>>        put (hasCloseButton(self))          to sPEWindowOptions at PEWindowOptions.hasCloseButton
30373>>>        put (hasProgressControls(self))     to sPEWindowOptions at PEWindowOptions.hasProgressControls
30374>>>        put (hasSearchButton(self))         to sPEWindowOptions at PEWindowOptions.hasSearchButton
30375>>>        put (hasPrintSetupButton(self))     to sPEWindowOptions at PEWindowOptions.hasPrintSetupButton
30376>>>        put (hasRefreshButton(self))        to sPEWindowOptions at PEWindowOptions.hasrefreshButton
30377>>>        GetAddress of sPEWindowOptions      to pPEWindowOptions
30378>>>        Move (PESetWindowOptions(iPrintJob, pPEWindowOptions)) to iResult
30379>>>        Forward Send OutputToWindow sTitle iLeft iTop iWidth iHeight iStyle hParent
30381>>>    End_Procedure // OutputToWindow
30382>>>
30382>>>    Procedure Set TmpFileDir String aDir
30383>>>        String lsCurrWspc lsDir
30384>>>
30384>>>//        If (ghoWorkSpace <> 0) Begin
30384>>>//            Get WorkSpaceName of ghoWorkSpace to lsCurrWspc
30384>>>//            Insert "WorkSpaces\" in lsCurrWspc at 1
30384>>>//            Get_Profile_String lsCurrWspc aDir to lsDir
30384>>>//            Set Report_Data_Path to lsDir
30384>>>//        End
30384>>>    End_Procedure
30385>>>
30385>>>    Procedure DoWinQLReport
30386>>>        // This can be used when reports must be able to run in different data directories
30386>>>        Set TmpFileDir to "TmpFileDir"
30387>>>        Forward Send DoWinQLReport
30389>>>    End_Procedure
30390>>>
30390>>>
30390>>>    // This hook procedure is called after the print job has been opened.
30390>>>
30390>>>    Procedure OnInitializeReport000
30391>>>    ////// SOS Na ginei xana OnInitializeReport ///////////
30391>>>
30391>>>        Integer iTables iMax iCount iType
30392>>>        String  sLocation sLocation2 sPath DirSep
30392>>>        String  sNewPath sNewLocation sDataPath sMyLocation
30392>>>
30392>>>//        Open Sysfile
30392>>>
30392>>>        String  sActualSQL
30392>>>        String  sActualTemp
30392>>>        String  sOldSQL
30392>>>        String  sOldTemp
30392>>>        String  sServerName
30392>>>        String  sDatabaseName
30392>>>        String  sUserID
30392>>>
30392>>>//        Move Sysfile.ActualSQL      to sActualSQL
30392>>>//        Move Sysfile.ActualTemp     to sActualTemp
30392>>>//        Move Sysfile.OldSQL         to sOldSQL
30392>>>//        Move Sysfile.OldTemp        to sOldTemp
30392>>>//        Move Sysfile.cServerName    to sServerName
30392>>>//        Move Sysfile.cDatabaseName  to sDatabaseName
30392>>>//        Move Sysfile.cUserID        to sUserID
30392>>>
30392>>>        Move 'SMS'                 to sOldSQL
30393>>>        Move 'C:\Dns_tmp\'         to sOldTemp
30394>>>        Move 'SMSMET'        to sActualSQL      // Database
30395>>>        Move 'C:\Dns_tmp\'         to sActualTemp
30396>>>        Move 'SMSMET'        to sServerName    // ODBC
30397>>>        Move 'SMSMET'        to sDatabaseName  // DataBase
30398>>>     //   Move 'sa'               to sUserID
30398>>>
30398>>>//        Move 'SMS'                 to sOldSQL
30398>>>//        Move 'C:\Dns_tmp\'         to sOldTemp
30398>>>//        Move 'SMSKORINTHOS'        to sActualSQL      // Database
30398>>>//        Move 'C:\Dns_tmp\'         to sActualTemp
30398>>>//        Move 'SMSKORINTHOS'        to sServerName    // ODBC
30398>>>//        Move 'SMSKORINTHOS'        to sDatabaseName  // DataBase
30398>>>
30398>>>
30398>>>        Move (Trim(sActualSQL   )) to sActualSQL
30399>>>        Move (Trim(sActualTemp  )) to sActualTemp
30400>>>        Move (Trim(sOldSQL      )) to sOldSQL
30401>>>        Move (Trim(sOldTemp     )) to sOldTemp
30402>>>        Move (Trim(sServerName  )) to sServerName
30403>>>        Move (Trim(sDatabaseName)) to sDatabaseName
30404>>>        Move (Trim(sUserID      )) to sUserID
30405>>>
30405>>>
30405>>>        Forward Send OnInitializeReport
30407>>>
30407>>>        Move (Sysconf(SYSCONF_DIR_SEPARATOR)) To DirSep
30408>>>        Get NTables To iMax
30409>>>        Decrement iMax
30410>>>        Get Report_Data_Path                                    To sPath
30411>>>        If Not (Right(sPath,1)) Eq DirSep Move (sPath-DirSep)   To sPath
30414>>>        For iCount From 0 To iMax
30420>>>>
30420>>>            Get NthTableLocation iCount         To sLocation
30421>>>            Get Report_Base_File_Name sLocation To sLocation2
30422>>>            Get NthTableDBType           iCount to iType
30423>>>
30423>>>            // An einai type 1 topiko
30423>>>            //               2=SQL
30423>>>            If (iType=2) Begin
30425>>>                If (sLocation contains sOldSQL) Begin
30427>>>                    Move (Replace(sOldSQL,sLocation,sActualSQL))    to sLocation
30428>>>                    Set NthTableLocation iCount                     to (Trim(sLocation))
30429>>>                End
30429>>>>
30429>>>            End
30429>>>>
30429>>>            Else If (iType=1) Begin
30432>>>                If (sLocation contains sOldTemp) Begin
30434>>>                    Move (Replace(sOldTemp,sLocation,sActualTemp))  to sLocation
30435>>>                    Set NthTableLocation iCount                     to (Trim(sLocation))
30436>>>                End
30436>>>>
30436>>>            End
30436>>>>
30436>>>            Set nthTableLogOnServerName     iCount to sServerName     0
30437>>>            Set nthTableLogOnDataBaseName   iCount to sDatabaseName   0
30438>>>            Set nthTableLogOnUserID         iCount to sUserID         0 // 'sa'     0
30439>>>        Loop // For iCount From 0 To iMax
30440>>>>
30440>>>
30440>>>    End_Procedure // OnInitializeReport
30441>>>
30441>>>
30441>>>//                Showln '--------------------------------------------------------'
30441>>>//                Showln iCount
30441>>>//                Showln sLocation
30441>>>//                Showln sPath
30441>>>//                Showln sLocation2
30441>>>//                Showln iType
30441>>>
30441>>>                //If (Trim(LowerCase(sLocation2))='btnemp.dat') Begin
30441>>>                  //Set Report_Data_Path to ''
30441>>>                  //Get NthTableDBType              iCount to iType
30441>>>                    //Set nthTableLogOnPassword       iCount to '123'     0
30441>>>                  //Set NthTableLocation            iCount To "BTNEMP"
30441>>>                    //Set NthTableLocation iCount To (sPath-sLocation2)
30441>>>                  //Get NthTableLocation iCount                 To sMyLocation
30441>>>                  //Move (Replace(sLocation,sMyLocation,''))    To sMyLocation
30441>>>                  //Showln sMyLocation
30441>>>                  //Set NthTableLocation            iCount To sMyLocation
30441>>>                //End
30441>>>
30441>>>
30441>>>
30441>>>    // This hook procedure is called just before a print job is closed.
30441>>>    Procedure OnDeInitializeReport
30442>>>        Forward Send OnDEInitializeReport
30444>>>    End_Procedure // OnDeInitializeReport
30445>>>
30445>>>    // This hook procedure is called just before a the print job is started.
30445>>>    Procedure OnStartPrinting
30446>>>        Forward Send OnStartPrinting
30448>>>    End_Procedure // OnStartPrinting
30449>>>
30449>>>    // This hook procedure is called just after a print job has finished.
30449>>>    Procedure OnStopPrinting
30450>>>        Forward Send OnStopPrinting
30452>>>    End_Procedure // OnStopPrinting
30453>>>
30453>>>
30453>>>End_Class // CrystalReportSubSQL
30454>>>
30454>Integer giWait_Obj
30454>
30454>
30454>
30454>//Use SelectCY.sl
30454>//Send Select_Company
30454>
30454>
30454>
30454>
30454>
30454>// General Functions-Procedures and Variables
30454>Use Globals.Inc
INCLUDING FILE: GLOBALS.INC
30454>>>
30454>>>        String  gs_Selected_Company_Code
30454>>>        String  gs_Selected_Branch_Code
30454>>>        Integer gi_Selected_Year
30454>>>        String gs_Selected_Year_Recr
30454>>>        String  gs_Module_Code
30454>>>
30454>>>
30454>>>//Open Currency
30454>>>//Function CurrDigits Global String asCurr Returns Integer
30454>>>//    Integer liDecX
30454>>>//    Clear Currency
30454>>>//    move asCurr to Currency.Currency_C_Code
30454>>>//    Find Eq Currency By Index.1
30454>>>//    move Currency.Currency_Dec to liDecX
30454>>>//    Function_Return liDecX
30454>>>//End_Function // CurrDigits
30454>>>
30454>>>Open Nomisma
INCLUDING FILE: NOMISMA.FD
30456>>>Open SysCurXr
INCLUDING FILE: SYSCURXR.FD
30458>>>
30458>>>Function fiDekadika_Nomismatos Global String asNomisma Returns Integer
30459>>>    Move (Trim(asNomisma)) to asNomisma
30460>>>    Clear Nomisma
30461>>>    If ( asNomisma<>'' ) Move asNomisma         to Nomisma.Nomisma_Code
30464>>>    Else                 Move SysCurXr.C_Code0  to Nomisma.Nomisma_Code
30466>>>    Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
30467>>>>
30467>>>    Function_Return Nomisma.Dekadika
30468>>>End_Function //
30469>>>
30469>>>Function fsgCode_W_Zeroes Global Integer aiCode Integer aiPlaces Returns String
30470>>>    String rVal
30471>>>    Integer iLength iInt
30471>>>    Move aiCode to rVal
30472>>>    Move (trim(rVal)) to rVal
30473>>>    For iInt From 1 to (aiPlaces-(Length(rVal)))
30479>>>>
30479>>>        Move (Insert('0',rVal,1)) to rVal
30480>>>    Loop
30481>>>>
30481>>>    Function_Return rVal
30482>>>End_Function
30483>>>
30483>>>Function fsgCode_n_Zeroes Global number aiCode Integer aiPlaces Returns String
30484>>>    String rVal
30485>>>    Integer iLength iInt ipos
30485>>>    Move aiCode to rVal
30486>>>    Move (trim(rVal)) to rVal
30487>>>    MOVE (aiPlaces-(Length(rVal))) to ipos
30488>>>    For iInt From 1 to ipos
30494>>>>
30494>>>        Move (Insert('0',rVal,1)) to rVal
30495>>>    Loop
30496>>>>
30496>>>    Function_Return rVal
30497>>>End_Function
30498>>>
30498>>>
30498>>>Open Year
INCLUDING FILE: YEAR.FD
30500>>>Procedure EnumDDsForRebuildConstrain for DataDictionary integer aiMsg integer ahId
30501>>>    Send aiMsg to Self
30502>>>End_Procedure
30503>>>
30503>>>Procedure DoRefindYear for baseclass Integer aiPanel Integer aiYearDD
30504>>>    Integer liChanged
30505>>>
30505>>>    If ((aiYearDD = 0) or (Main_File(aiYearDD)<>Year.File_Number)) ;        Procedure_Return (Message_Box("Invalid Year_DD","Developer's Warning",MB_OK,MB_ICONWARNING))
30508>>>    If (Not(Current_Record(aiYearDD))) Begin
30510>>>        Get Should_Save of aiPanel to liChanged
30511>>>        Send Clear to aiYearDD
30512>>>        Move gs_Selected_Company_Code to Year.Company_Code
30513>>>        Move gs_Selected_Branch_Code  to Year.Branch_Code
30514>>>        Move gi_Selected_Year         to Year.Year_Year
30515>>>        Send Find to aiYearDD Eq 1 //Year.Index.1 - company_code+ranch_code+year_year
30516>>>        If (Not(liChanged)) Set Changed_State of aiPanel to False
30519>>>    End
30519>>>>
30519>>>End_Procedure
30520>>>
30520>>>Procedure RebuildConstrainIfYearChanged for baseclass Integer aiPanel String asCurrentYearRecr Integer aiYearDDId
30521>>>    Integer liSrvr
30522>>>    String  lsCurrentYearRecr
30522>>>
30522>>>    If (asCurrentYearRecr <> gs_Selected_Year_Recr) Begin
30524>>>        Broadcast Send EnumDDsForRebuildConstrain to aiPanel msg_Rebuild_Constraints Self
30526>>>    End
30526>>>>
30526>>>    Send DoRefindYear aiPanel aiYearDDId //(Year_DD(Self))
30527>>>    Get Server of aiPanel to liSrvr
30528>>>    // Respects Default values
30528>>>    If (liSrvr) If (Not(Current_Record(liSrvr))) Send Request_Clear to aiPanel
30533>>>End_Procedure
30534>>>
30534>>>//                                       ’¦ View            Property «¦¬ View             ’¦ Year DDO «¦¬ View
30534>>>//                                                          Holds the current year rec0
30534>>>// ‰¢ã©ž : Send RbldConstrIfYearChanged (Gplan_Test(Self))  (psCurrentYearRecr(Self))     (Year_DD(Self))
30534>>>
30534>>>
30534>>>Function fiRefindYear Global Returns Integer
30535>>>    Clear Year
30536>>>    Move gs_Selected_Company_Code to Year.Company_Code
30537>>>    Move gs_Selected_Branch_Code  to Year.Branch_Code
30538>>>    Move gi_Selected_Year         to Year.Year_Year
30539>>>    Find eq Year by Index.1 //company_code+ranch_code+year_year
30540>>>>
30540>>>    Function_Return (Found = 0)
30541>>>End_Function //fiRefindYear
30542>>>
30542>>>Procedure DoRunApplication for Baseclass String sAppName
30543>>>    string sRuntime  lsStr
30544>>>
30544>>>    Append lsStr 'C:\Dns.bat ' sAppName
30546>>>    RunProgram Wait  lsStr
30547>>>
30547>>>//    get_profile_string "defaults" "VDFBinDir" to sRuntime
30547>>>//    append sRuntime "\dfrun " sAppName
30547>>>    Append sRuntime 'C:\Program Files\Accessories\WORDPAD.EXE ' sAppName
30549>>>    runprogram background sRuntime
30550>>>End_procedure // DoRunApplication
30551>>>
30551>>>// Run the Editor
30551>>>Procedure DoRunEditor for Baseclass String asFile
30552>>>    string sRunPath lsWspcName
30553>>>    Move (WorkspaceName(ProgramWorkspace(Self))) to lsWspcName
30554>>>    get_profile_string ("workspaces\"+lsWspcName) "programpath" to sRunPath
30557>>>    //append sRunPath "\Editor "  asFile //// js 15/03/2002 " " lsWspcName
30557>>>    Move (Replace('.',asFile,'')) to asFile
30558>>>    append sRunPath asFile //// js 15/03/2002 " " lsWspcName
30559>>>    send DoRunApplication sRunPath
30560>>>End_Procedure // DoRunEditor
30561>>>
30561>>>//--------------------------------------
30561>>>
30561>>>//start of global functions and procedures
30561>>>
30561>>>
30561>>>//®¨ž© £¦§¦ œå«˜  ˜§æ: ˜) gmoves.dd    :private.update_gmhnes_ghmnies
30561>>>Function gsfFind_Previous Global String lsCode;                                 String lsDelimiter;                                 Returns String
30562>>>         String  lsTemp_Code1 lsTemp_Code2
30563>>>         Integer liCounter
30563>>>
30563>>>         //1.˜­˜å¨œ©ž ¡œ¤é¤
30563>>>         Move (Trim(lsCode)) to lsCode                                  //§® 30.12.345
30564>>>
30564>>>         //2.˜¤« ©«¨¦­ã
30564>>>         For liCounter From 1 to (Length(lsCode))
30570>>>>
30570>>>             Move (Insert(;                           (Mid(lsCode,1,liCounter)),;                           lsTemp_Code1,;                           1;                         )) to lsTemp_Code1                             //§® 543.21.03
30571>>>         Loop
30572>>>>
30572>>>
30572>>>         //3.˜­˜å¨œ©ž ¡œ¤é¤ (›â¤ ®¨œ áœ«˜ , safety only)
30572>>>         Move (Trim(lsTemp_Code1)) to lsTemp_Code1
30573>>>
30573>>>         //4.§˜å¨¤à £æ¤¦ «¦ ›œ¥ æ £â¨¦ª «¦¬ ˜¤«å©«¨¦­¦¬, £œ«á «¦ §¨é«¦ delimiter
30573>>>         Move (Right(;                      lsTemp_Code1,;                      ((Length(lsTemp_Code1))-((Pos(lsDelimiter,lsTemp_Code1))));                    )) to lsTemp_Code1                                  // §® 21.03
30574>>>
30574>>>         //5.¥˜¤á ˜¤« ©«¨¦­ã «¦¬ ˜¤«å©«¨¦­¦¬
30574>>>         For liCounter from 1 to (Length(lsTemp_Code1))
30580>>>>
30580>>>             Move (Insert(;                           (Mid(lsTemp_Code1,1,liCounter)),;                           lsTemp_Code2,;                           1;                         )) to lsTemp_Code2                             //§® 30.12
30581>>>         Loop
30582>>>>
30582>>>
30582>>>         Function_Return (Trim(lsTemp_Code2))
30583>>>End_Function //gsffind_previous
30584>>>
30584>>>
30584>>>Function gifSystem_Check Returns Integer
30585>>>         Integer liF_Gtypkins liF_Garicls liF_Gmoves liF_Gplans liF_Gmhnes liF_Ghmnies
30586>>>         Integer liS_Gtypkins liS_Garicls liS_Gmoves liS_Gplans liS_Gmhnes liS_Ghmnies
30586>>>//       Clear Company
30586>>>//       Find Gt Company.Recnum
30586>>>//       While (Found = 1)
30586>>>//             Add Company.Company_NumGtypkin to liS_Gtypkins § Ÿ˜¤é© ©«¦ sysfile ¤˜ «˜ ¡˜¨˜«áà ˜¬«á
30586>>>//             Add Company.Company_NumGarticl to liS_Garticls
30586>>>//             Add Company.Company_NumGmoves  to liS_Gmoves
30586>>>//             //d Company.Company_NumGtypkin to liS_Gtypkins
30586>>>//             Add Company.Company_NumGplan   to liS_GPlans
30586>>>//             Add Company.Company_NumGmhnes  to liS_Gmhnes
30586>>>//             Add Company.Company_NumGhmnies to liS_Ghmnies
30586>>>//             Find Gt Company.Recnum
30586>>>//       Loop
30586>>>//
30586>>>//       Get_Attribute {attribute} [of {file-handle} ;
30586>>>//                        [{field-num} | {index-num} [{segment-num}]]] ;
30586>>>//                        To {variable}
30586>>>//
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Garticl.File_Number to liF_Garticls
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmoves.File_Number  to liF_Gmoves
30586>>>//       //t_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gplan.File_Number   to liF_Gplans
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmhnes.File_Number  to liF_Gmhnes
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Ghmnies.File_Number to liF_Ghmnies
30586>>>//
30586>>>
30586>>>//       //â¢œš®¦ª DF_FILE_MAX_RECORDS+ £œ records used
30586>>>
30586>>>//       //â¢œš®¦ª last rec0 = sysrec rec0
30586>>>
30586>>>    Function_Return 0
30587>>>End_Function //gifSystem_Check
30588>>>
30588>>>/////////////////////////////////////////////////////////////////
30588>>>//‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª, £œ ž ®à¨åª ›œ¡˜› ¡á  JS
30588>>>Function Sfi_All_Numbers Global Number anValue Integer aiLengthAkeraios Integer aiLengthDekadika Returns String
30589>>>
30589>>>    String  lsRetval lsValue lsAkeraios lsDekadika
30590>>>    Integer liInt liInteger iTimes iStart
30590>>>    Number  lnDecimals
30590>>>
30590>>>    Move (Integer(anValue))                                         to liInteger
30591>>>    Move (Round(AnValue-(Integer(anValue))*(10^aiLengthDekadika)))  to lnDecimals
30592>>>
30592>>>    Move liInteger              to lsAkeraios
30593>>>    Move lnDecimals             to lsDekadika
30594>>>    Move (Trim(lsAkeraios))     to lsAkeraios
30595>>>    Move (Trim(lsDekadika))     to lsDekadika
30596>>>
30596>>>    Move (Length(lsAkeraios)) to iStart
30597>>>    For iTimes From iStart to (aiLengthAkeraios-1)
30603>>>>
30603>>>        Insert "0" in lsAkeraios at 1
30605>>>    Loop
30606>>>>
30606>>>    Move (Trim(lsAkeraios)) to lsAkeraios
30607>>>
30607>>>    Move (Length(lsDekadika)) to iStart
30608>>>    For iTimes From iStart to (aiLengthDekadika-1)
30614>>>>
30614>>>        Move (Append(lsDekadika,"0")) to lsDekadika
30615>>>    Loop
30616>>>>
30616>>>    Move (Trim(lsDekadika)) to lsDekadika
30617>>>
30617>>>    If (aiLengthDekadika=0) Move '' to lsDekadika
30620>>>    Move '' to lsRetVal
30621>>>    Move (Pad((lsAkeraios-lsDekadika),(aiLengthAkeraios+aiLengthDekadika))) to lsRetval
30622>>>    Function_Return lsRetval
30623>>>End_Function //sfi_All_Numbers  ‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª
30624>>>              //                 £œ ž ®à¨åª ›œ¡˜› ¡á (JS)
30624>>>
30624>>>Open Codemast
30626>>>
30626>>>
30626>>>Function gsfCode_Mast Global String lsType String lsValue Returns String
30627>>>         Clear Codemast
30628>>>         Move lsType  to Codemast.Type
30629>>>         Move lsValue to Codemast.Code
30630>>>         Find Eq Codemast by Index.1 //type+code
30631>>>>
30631>>>         Function_Return Codemast.Description
30632>>>End_Function //code_mast
30633>>>
30633>>>
30633>>>Open Branch
INCLUDING FILE: BRANCH.FD
30635>>>Function fsgCode_With_Zeroes Global Integer aiCode    ;                                    Integer aiPlaces  ;                                    String asCompany  ;                                    String asBranch   ;                               Returns String
30636>>>    String rVal
30637>>>    Integer iInt
30637>>>    Clear Branch
30638>>>    Move asCompany  to Branch.Company_Code
30639>>>    Move asBranch   to Branch.Branch_Code
30640>>>    Find Eq Branch by Index.1
30641>>>>
30641>>>    If (Trim(Branch.Tomeas_Code)<>'') Move (Trim(Branch.Tomeas_Code)) to asBranch
30644>>>    Move (Trim(asCompany))  to asCompany
30645>>>    Move (Trim(asBranch))   to asBranch
30646>>>    If (Length(asCompany)=1) Insert '0' In asCompany At 1
30650>>>    If (Length(asBranch) =1) Insert '0' In asBranch  At 1
30654>>>    Move ''                                           to rVal
30655>>>    Move (Sfi_All_Numbers(aiCode,aiPlaces,0))         to rVal
30656>>>    Move (Append((asCompany+'.'+asBranch+'.'),rVal))  to rVal
30657>>>    Move (Trim(rVal))                                 to rVal
30658>>>    Function_Return rVal
30659>>>End_Function
30660>>>
30660>>>Function fsgStripCodeFromID Global String asID Returns Integer
30661>>>      Integer iLen iPos iInt
30662>>>      If (Trim(asID)='') Function_Return 0
30665>>>      Move (Trim  (asID)) to asID
30666>>>      Move (Length(asID)) to iLen
30667>>>      For iInt From 1     to iLen
30673>>>>
30673>>>          If (Mid(asID,1,iInt)='.') Move iInt to iPos
30676>>>      Loop
30677>>>>
30677>>>      Function_Return (Right(asID,(iLen-iPos)))
30678>>>End_Function
30679>>>
30679>>>Function fsCityDescr Global Integer aiCityID Returns String
30680>>>    String rVal
30681>>>    Open Cities
INCLUDING FILE: CITIES.FD
30683>>>    Clear Cities
30684>>>    Move aiCityID to Cities.City_ID
30685>>>    Find Eq Cities By Index.1
30686>>>>
30686>>>    If (Found=1) Move Cities.City_descr to rVal
30689>>>    Else         Move '' to rVal
30691>>>    Function_Return rVal
30692>>>End_Function
30693>>>
30693>>>Function fiTownIDFromCity Global Integer aiCityID Returns Integer
30694>>>    Open Cities
30696>>>    Clear Cities
30697>>>    Move aiCityID to Cities.City_ID
30698>>>    Find Eq Cities By Index.1
30699>>>>
30699>>>    Function_Return Cities.Town_ID
30700>>>End_Function
30701>>>
30701>>>Function fiCountryIDFromTown Global Integer aiTownID Returns Integer
30702>>>    Open Towns
INCLUDING FILE: TOWNS.FD
30704>>>    Clear Towns
30705>>>    Move aiTownID to Towns.Town_ID
30706>>>    Find Eq Towns By Index.1
30707>>>>
30707>>>    Function_Return Towns.Country_ID
30708>>>End_Function
30709>>>
30709>>>Function fsTownDescr Global Integer aiTownID Returns String
30710>>>    String rVal
30711>>>    Open Towns
30713>>>    Clear Towns
30714>>>    Move aiTownID to Towns.Town_ID
30715>>>    Find Eq Towns By Index.1
30716>>>>
30716>>>    If (Found=1) Move Towns.Town_descr to rVal
30719>>>    Else         Move '' to rVal
30721>>>    Function_Return rVal
30722>>>End_Function
30723>>>
30723>>>Function fsCountryDescr Global Integer aiCountryID Returns String
30724>>>    String rVal
30725>>>    Open Country
INCLUDING FILE: COUNTRY.FD
30727>>>    Clear Country
30728>>>    Move aiCountryID to Country.Country_ID
30729>>>    Find Eq Country By Index.1
30730>>>>
30730>>>    If (Found=1) Move Country.Country_descr to rVal
30733>>>    Else         Move '' to rVal
30735>>>    Function_Return rVal
30736>>>End_Function
30737>>>
30737>>>Function fsAreaDescr Global Integer aiAreaID Returns String
30738>>>    String rVal
30739>>>    Open Areas
INCLUDING FILE: AREAS.FD
30741>>>    Clear Areas
30742>>>    Move aiAreaID to Areas.Area_ID
30743>>>    Find Eq Areas By Index.1
30744>>>>
30744>>>    If (Found=1) Move Areas.Area_descr to rVal
30747>>>    Else         Move '' to rVal
30749>>>    Function_Return rVal
30750>>>End_Function
30751>>>
30751>>>Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
30752>>>    Local String rVal lsTmp lsOO lsLL
30753>>>    Local Number lnOO lnLL
30753>>>
30753>>>    Move '' to lsOO
30754>>>    Move '' to lsLL
30755>>>    Move '' to rVal
30756>>>
30756>>>    Move (Integer(anTime))                              to lnOO
30757>>>
30757>>>    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
30758>>>
30758>>>    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
30761>>>    Else         Move (String(lnOO))                    to lsOO
30763>>>    Move (Trim(lsOO))                                   to lsOO
30764>>>
30764>>>    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
30767>>>    Else         Move (String(lnLL))                    to lsLL
30769>>>    Move (Trim(lsLL))                                   to lsLL
30770>>>
30770>>>    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
30771>>>
30771>>>    Move (Trim(rVal)) to rVal
30772>>>
30772>>>    Function_Return rVal
30773>>>End_Function
30774>>>
30774>>>Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
30775>>>    Local Number rVal nOres nLepta
30776>>>    Move (Integer(aiMinutes/60))    to nOres
30777>>>    Move (    Mod(aiMinutes,60))    to nLepta
30778>>>    Move (nOres+(nLepta/100))       to rVal
30779>>>    Function_Return rVal
30780>>>End_Function
30781>>>
30781>>>Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
30782>>>    Local Integer rVal
30783>>>    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
30784>>>    Function_Return rVal
30785>>>End_Function
30786>>>
30786>>>Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;                                                                    Number anEndTime    ;                                                                    Returns Integer
30787>>>    Local Integer rVal iMinStart iMinEnd
30788>>>
30788>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30791>>>
30791>>>    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
30792>>>    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
30793>>>    Move (iMinEnd-iMinStart)                                                     to rVal
30794>>>    Function_Return rVal
30795>>>End_Function
30796>>>
30796>>>
30796>>>Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;                                                                Number anEndTime    ;                                                                Returns Number
30797>>>    Local Integer iTmp
30798>>>    Local Number  rVal
30798>>>
30798>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30801>>>
30801>>>    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
30802>>>    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
30803>>>    Function_Return rVal
30804>>>End_Function
30805>>>
30805>>>
30805>>>
30805>>>Open WitemCL
INCLUDING FILE: WITEMCL.FD
30807>>>Open WitemCld
INCLUDING FILE: WITEMCLD.FD
30809>>>Open WitemxT
INCLUDING FILE: WITEMXT.FD
30811>>>
30811>>>Function fnTeleytaiaTimhAgoras String asPromCode String asItemCode  ;                               Date   adHmnia    Number anQty       ;                               Returns Number
30812>>>  Integer iExodos
30813>>>  Number nPoso nPct
30813>>>  Move 0 to nPoso
30814>>>  Move 0 to nPct
30815>>>  Move 0 to iExodos
30816>>>
30816>>>  Move (Trim(asItemCode)) to asItemCode
30817>>>  Move (Trim(asPromCode)) to asPromCode
30818>>>
30818>>>  // 1.Anazhthsh sto arxeio Witemcld
30818>>>  Clear Witemcld
30819>>>  Move asItemCode to Witemcld.Item_Code
30820>>>  Move asPromCode to Witemcld.Client_Code
30821>>>  Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30822>>>>
30822>>>  While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;                       (Witemcld.Client_Code= asPromCode) And ;                       (iExodos=0))
30826>>>      If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30828>>>          Move 1 to iExodos
30829>>>               If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30832>>>          Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30836>>>      End
30836>>>>
30836>>>      Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30837>>>>
30837>>>  Loop
30838>>>>
30838>>>  If (iExodos) Begin
30840>>>      If (nPoso) Function_Return nPoso
30843>>>      Else Function_Return nPct
30845>>>  End
30845>>>>
30845>>>
30845>>>  // 2.Anazhthsh sto arxeio Witemcl
30845>>>  Clear WitemCL
30846>>>  Move (Trim(asPromCode)) to WitemCL.Client_Code
30847>>>  Move (Trim(asItemCode)) to WitemCL.Item_Code
30848>>>  Find Eq WitemCL By Index.1
30849>>>>
30849>>>  If (Found=1) Function_Return WitemCL.Client_Price
30852>>>
30852>>>  Function_Return 0
30853>>>End_Function
30854>>>
30854>>>
30854>>>Open BtnOrdd
INCLUDING FILE: BTNORDD.FD
30856>>>
30856>>>Function fnTeleytaiaTimhPolhshs String asWitemxRecr String asClientID ;                                String asWitemxCode Date   adHmnia    ;                                String asItemCode   Number anQty      ;                                String asCNCode     Returns Number
30857>>>
30857>>>  Integer iExodos iCheckDeop
30858>>>  Number nPoso nPct
30858>>>
30858>>>  Move (Num_Arguments=7) to iCheckDeop
30859>>>
30859>>>  Move 0 to nPoso
30860>>>  Move 0 to nPct
30861>>>  Move 0 to iExodos
30862>>>
30862>>>  Move (Trim(asItemCode))                 to asItemCode
30863>>>  Move (Trim(asClientID))                 to asClientID
30864>>>  Move (Trim(asWitemxRecr))               to asWitemxRecr
30865>>>  Move (Trim(asWitemxCode))               to asWitemxCode
30866>>>  If (iCheckDeop) Move (Trim(asCNCode))   to asCNCode
30869>>>
30869>>>  // 1. Anazhthsh apo DEOP ef' oson yparxei kodikos ergou
30869>>>  If (iCheckDeop) Begin
30871>>>      Clear btnordd
30872>>>      Move asClientID   to btnordd.vclient_id
30873>>>      Move asCNCode     to btnordd.vcn_code
30874>>>      Move asWitemxCode to btnordd.vitem
30875>>>      Move 0            to btnordd.vactive
30876>>>      Move adHmnia      to btnordd.arxh_date
30877>>>      Find LE btnordd by index.4//client_id+cn_code+item+arxh_date
30878>>>>
30878>>>      If ((found=1) and (asWitemxCode=btnordd.vitem)    and (adHmnia>=btnordd.arxh_date) ;                    and (adHmnia<=btnordd.deop_date)    and (btnordd.vactive=0)          ;                    and (asCNCode=btnordd.vcn_code)) begin
30880>>>          move btnordd.vprice to nPoso
30881>>>          If (nPoso) Function_Return nPoso
30884>>>      End
30884>>>>
30884>>>  End
30884>>>>
30884>>>
30884>>>  // 2.Anazhthsh sto arxeio Witemcld (Timokatalogos Pelath/Eidous)
30884>>>  Clear Witemcld
30885>>>  Move asItemCode to Witemcld.Item_Code
30886>>>  Move asClientID to Witemcld.Client_Code
30887>>>  Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30888>>>>
30888>>>  While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;                       (Witemcld.Client_Code= asClientID) And ;                       (iExodos=0))
30892>>>      If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30894>>>          Move 1 to iExodos
30895>>>               If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30898>>>          Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30902>>>      End
30902>>>>
30902>>>      Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30903>>>>
30903>>>  Loop
30904>>>>
30904>>>  If (iExodos) Begin
30906>>>      If (nPoso) Function_Return nPoso
30909>>>      Else Function_Return nPct
30911>>>  End
30911>>>>
30911>>>
30911>>>
30911>>>  // 3.Anazhthsh sto arxeio Witemxt (Timokatalogos Eidous)
30911>>>  Clear Witemxt
30912>>>  Move SysCurXr.Company_Code  to Witemxt.Company_Code
30913>>>  Move SysCurXr.Branch_Code   to Witemxt.Branch_Code
30914>>>  Move SysCurXr.Year_Year     to Witemxt.Year_Year
30915>>>  Move asWitemxRecr           to Witemxt.Witemx_Recr
30916>>>  Find Gt Witemxt By Index.1 // Witemxt:Index.1
30917>>>>
30917>>>  While ((Found=1) And (Witemxt.Company_Code = SysCurXr.Company_Code) And ;                       (Witemxt.Branch_Code  = SysCurXr.Branch_Code ) And ;                       (Witemxt.Year_Year    = SysCurXr.Year_Year   ) And ;                       (Witemxt.Witemx_Recr  = asWitemxRecr         ) And ;                       (iExodos=0))
30921>>>      If ((adHmnia>=Witemxt.Value_Date) And (anQty<=Witemxt.Qty)) Begin
30923>>>          Move 1 to iExodos
30924>>>               If (Witemxt.Axia0 <>0) Move  Witemxt.Axia0         to nPoso
30927>>>          Else If (Witemxt.PcDisc<>0) Move (Witemxt.PcDisc*(-1))  to nPct
30931>>>      End
30931>>>>
30931>>>      Find Gt Witemxt By Index.1 // Witemxt:Index.1
30932>>>>
30932>>>  Loop
30933>>>>
30933>>>  If (iExodos) Begin
30935>>>      If (nPoso) Function_Return nPoso
30938>>>      Else Function_Return nPct
30940>>>  End
30940>>>>
30940>>>
30940>>>
30940>>>  // 4.Anazhthsh sto arxeio Witemcl (Teleytaia Timh Agoras)
30940>>>  Clear WitemCL
30941>>>  Move (Trim(asClientID)) to WitemCL.Client_Code
30942>>>  Move (Trim(asItemCode)) to WitemCL.Item_Code
30943>>>  Find Eq WitemCL By Index.1
30944>>>>
30944>>>  If (Found=1) Function_Return WitemCL.Client_Price
30947>>>
30947>>>  Function_Return 0
30948>>>End_Function
30949>>>
30949>>>Function fsStripTextFieldFromEnter Global String asStr Returns String
30950>>>    String sEnter
30951>>>    Move '' to sEnter
30952>>>    Move (Trim(asStr)) to asStr
30953>>>    Append sEnter (Character(13)) (Character(10))
30955>>>    Move (Replaces(sEnter,asStr,' ')) to asStr
30956>>>    Function_return (Trim(asStr))
30957>>>End_function
30958>>>
30958>>>
30958>>>//end   of global functions and procedures
30958>>>Use Wait.DG
INCLUDING FILE: WAIT.DG
30958>>>>>USE AllEntSc
30958>>>>>
30958>>>>>//AB-IgnoreEnd
30958>>>>>
30958>>>>>
30958>>>>>//AB-IgnoreEnd
30958>>>>>
30958>>>>>Object Wait is a ModalPanelSub
30960>>>>>
30960>>>>>    //AB-StoreTopStart
30960>>>>>
30960>>>>>    // How to Use It
30960>>>>>    // Get the maximum position of the bar
30960>>>>>    // Move (Bar_Maximum_position(Wait(self))) to iMax
30960>>>>>    //
30960>>>>>    // Set the maximum position of the bar
30960>>>>>    // Set Bar_Maximum_position of (Wait(self)) to iMax
30960>>>>>    //
30960>>>>>    // Start Bar Progress from beginning
30960>>>>>    // Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
30960>>>>>    //
30960>>>>>    // End Bar Progress
30960>>>>>    // Send Bar_Current_Position to (Wait(Self)) iMax iMax iMax False
30960>>>>>    //
30960>>>>>    // Update Bar Progress
30960>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax True OR
30960>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax False
30960>>>>>    // When you want the update to be done for every i (this is slower)
30960>>>>>    // Where i=Counter's current value, icounter=Counter's Max Value and iMax=Bar Max Position
30960>>>>>    //
30960>>>>>    // Display Buttons on the object
30960>>>>>    // Set Button_State of (Wait(Self)) to False/True
30960>>>>>    // If the Progress Bar gets initialized without buttons, it MUST be Deactivated
30960>>>>>    //
30960>>>>>    // Initialization of the Progress Bar
30960>>>>>    // Send Popup to (Wait(Self))
30960>>>>>    //
30960>>>>>    // Deactivation of the Progress Bar
30960>>>>>    // Send Deactivate to (Wait(Self))
30960>>>>>    //
30960>>>>>    // Message during the process
30960>>>>>    // Set Wait_Message of (Wait(Self)) to "Now Processing..."
30960>>>>>    //
30960>>>>>    // Extra Info for button "Info >>"
30960>>>>>    // Send Wait_Details to (Wait(Self)) sFile sDetail bInitData
30960>>>>>    // If sFile<>'' then reads the contents of the file
30960>>>>>    // Else Fills the Edit with the string of sDetail
30960>>>>>    // If bInitData is True then the edit object is cleared first else extra info is appended
30960>>>>>    //
30960>>>>>    // Remarks instead of Progress Bar
30960>>>>>    // Set Button_State of (Wait(Self))     to False
30960>>>>>    // Set BarVisibleState of (Wait(Self))  to 'Remarks' False
30960>>>>>    // Update During Process
30960>>>>>    // Send UpdateWait to (Wait(Self)) 'Remarks'
30960>>>>>
30960>>>>>    //AB-StoreTopEnd
30960>>>>>
30960>>>>>    Set Exit_Application_Local_State to FALSE
30961>>>>>    Set Modal_State to FALSE
30962>>>>>    Set Popup_State to TRUE
30963>>>>>    Set Border_Style to Border_Thick
30964>>>>>    Set Minimize_Icon to FALSE
30965>>>>>    Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
30966>>>>>    Set Size to 138 256
30967>>>>>
30967>>>>>    //AB-DDOStart
30967>>>>>
30967>>>>>
30967>>>>>    //AB-DDOEnd
30967>>>>>
30967>>>>>    Object WaitBar is a ProgressBarSub
30969>>>>>
30969>>>>>        //AB-StoreTopStart
30969>>>>>
30969>>>>>        //AB-StoreTopEnd
30969>>>>>
30969>>>>>        Set Size to 21 243
30970>>>>>        Set Location to 7 4
30971>>>>>
30971>>>>>        //AB-StoreStart
30971>>>>>        Send DoRegSize  self smTopRight
30972>>>>>        //AB-StoreEnd
30972>>>>>
30972>>>>>    End_Object
30973>>>>>
30973>>>>>    Object WaitText is a TextBoxSub
30975>>>>>
30975>>>>>        //AB-StoreTopStart
30975>>>>>
30975>>>>>        //AB-StoreTopEnd
30975>>>>>
30975>>>>>        Set Enabled_State to TRUE
30976>>>>>        Set Label to "Processing"
30977>>>>>        Set FontSize to 4 0
30978>>>>>        Set Size to 10 81
30979>>>>>        Set Location to 36 5
30980>>>>>
30980>>>>>        //AB-StoreStart
30980>>>>>
30980>>>>>        //AB-StoreEnd
30980>>>>>
30980>>>>>    End_Object
30981>>>>>
30981>>>>>    Object bnCancel is a ButtonSub
30983>>>>>
30983>>>>>        //AB-StoreTopStart
30983>>>>>
30983>>>>>        //AB-StoreTopEnd
30983>>>>>
30983>>>>>        Set Default_State to TRUE
30984>>>>>        Set Label to "OK"
30985>>>>>        Set Location to 34 143
30986>>>>>
30986>>>>>        //AB-StoreStart
30986>>>>>
30986>>>>>        Procedure OnClick
30988>>>>>             Send Deactivate to (Wait(Self))
30989>>>>>        End_Procedure
30990>>>>>
30990>>>>>        Send DoRegAlign self amTopRight
30991>>>>>        //AB-StoreEnd
30991>>>>>
30991>>>>>    End_Object
30992>>>>>
30992>>>>>    Object bnDetail is a ButtonSub
30994>>>>>
30994>>>>>        //AB-StoreTopStart
30994>>>>>
30994>>>>>        //AB-StoreTopEnd
30994>>>>>
30994>>>>>        Set Focus_Mode to Pointer_Only
30995>>>>>        Set Label to "Info >>"
30996>>>>>        Set Location to 34 197
30997>>>>>
30997>>>>>        //AB-StoreStart
30997>>>>>
30997>>>>>        Procedure OnClick
30999>>>>>            Delegate Send Show_Details False
31001>>>>>        End_Procedure
31002>>>>>
31002>>>>>        Send DoRegAlign self amTopRight
31003>>>>>        //AB-StoreEnd
31003>>>>>
31003>>>>>    End_Object
31004>>>>>
31004>>>>>    Object LineControlSub1 is a LineControlSub
31006>>>>>
31006>>>>>        //AB-StoreTopStart
31006>>>>>
31006>>>>>        //AB-StoreTopEnd
31006>>>>>
31006>>>>>        Set Size to 2 243
31007>>>>>        Set Location to 54 4
31008>>>>>
31008>>>>>        //AB-StoreStart
31008>>>>>
31008>>>>>        Send DoRegSize  self smTopRight
31009>>>>>        //AB-StoreEnd
31009>>>>>
31009>>>>>    End_Object
31010>>>>>
31010>>>>>    Object WaitEdit is a editSub
31012>>>>>
31012>>>>>        //AB-StoreTopStart
31012>>>>>
31012>>>>>        //AB-StoreTopEnd
31012>>>>>
31012>>>>>        Set Enabled_State to FALSE
31013>>>>>        Set Read_Only_State to TRUE
31014>>>>>        Set Size to 58 243
31015>>>>>        Set Location to 60 4
31016>>>>>        Set Color to clWhite
31017>>>>>
31017>>>>>        //AB-StoreStart
31017>>>>>
31017>>>>>        Send DoRegSize Self amBottomRight
31018>>>>>        Delegate Set Size to 66 256
31020>>>>>
31020>>>>>        //AB-StoreEnd
31020>>>>>
31020>>>>>    End_Object
31021>>>>>
31021>>>>>    Object oTxtAntiBar is a TextBoxSub
31023>>>>>        Set Enabled_State to TRUE
31024>>>>>        Set Visible_State to FALSE
31025>>>>>        Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
31026>>>>>        Set Justification_Mode to (jMode_Center IOR jMode_VCenter)
31027>>>>>        Set Auto_Size_State to FALSE
31028>>>>>        Set FontWeight to 600
31029>>>>>        Set FontSize to 4 0
31030>>>>>        Set Size to 10 209
31031>>>>>        Set Location to 10 4
31032>>>>>        Set TextColor to clNavy
31033>>>>>    End_Object
31034>>>>>
31034>>>>>
31034>>>>>    //AB-StoreStart
31034>>>>>    Property Integer piWaitSize  Public (Size(Self))
31036>>>>>    Property Integer piPrevSize  Public (Size(Self))
31038>>>>>    Property Integer piState     Public False
31040>>>>>
31040>>>>>    Set Locate_Mode to Center_On_Screen
31041>>>>>    Set Destroy_Object_State to True
31042>>>>>
31042>>>>>    Procedure Show_Details Integer bAlways
31044>>>>>        Local Integer liOriSize liSize hiSize hiOriSize lowSize bState
31045>>>>>        Local String sLabel
31045>>>>>        Get Size                to liSize
31046>>>>>        Get piState             to bState
31047>>>>>        Get piWaitSize          to liOriSize
31048>>>>>        Move (Hi(liSize))       to hiSize
31049>>>>>        Move (Low(liSize))      to lowSize
31050>>>>>        Move (Hi(liOriSize))    to hiOriSize
31051>>>>>        If (bAlways) Begin
31053>>>>>            Set piState         to False
31054>>>>>            Move 0              to bState
31055>>>>>        End
31055>>>>>>
31055>>>>>        If bState Begin
31057>>>>>             Set Size to hiOriSize lowSize
31058>>>>>             Set Label of (bnDetail(Self)) to "Info >>"
31059>>>>>        End
31059>>>>>>
31059>>>>>        Else Begin
31060>>>>>             Set Size to 138 lowSize
31061>>>>>             Set Label of (bnDetail(Self)) to "<< Info"
31062>>>>>        End
31062>>>>>>
31062>>>>>        Set piState to (1-bState)
31063>>>>>    End_Procedure
31064>>>>>
31064>>>>>    Procedure Bar_Current_Position Integer iCount Integer iOccurances Integer iMaximum Integer bState
31066>>>>>       If (bState) Begin
31068>>>>>         If (Mod(iCount,(iCount*((Number(iMaximum))/(Number(iOccurances)))))=0) ;            Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
31071>>>>>       End
31071>>>>>>
31071>>>>>       Else Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
31073>>>>>    End_Procedure
31074>>>>>
31074>>>>>    Procedure DoInitialize_WaitBar
31076>>>>>        Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
31077>>>>>    End_Procedure
31078>>>>>
31078>>>>>    Procedure DoTerminate_WaitBar
31080>>>>>        Local Integer iMax
31081>>>>>        Get Maximum_position of (WaitBar(Self)) to iMax
31082>>>>>        Send Bar_Current_Position to (Wait(Self)) iMax iMax Imax False
31083>>>>>    End_Procedure
31084>>>>>
31084>>>>>    Procedure Set Bar_Maximum_Position Integer iMaximum
31086>>>>>         Set Maximum_position of (WaitBar(Self)) to iMaximum
31087>>>>>    End_Procedure
31088>>>>>
31088>>>>>    Function Bar_Maximum_Position Returns Integer
31090>>>>>        Function_Return (Maximum_position(WaitBar(Self)))
31091>>>>>    End_Function
31092>>>>>
31092>>>>>    Procedure Set Bar_Minimum_Position Integer iMinimum
31094>>>>>         Set Minimum_position of (WaitBar(Self)) to iMinimum
31095>>>>>    End_Procedure
31096>>>>>
31096>>>>>    Function Bar_Minimum_Position Returns Integer
31098>>>>>        Function_Return (Minimum_position(WaitBar(Self)))
31099>>>>>    End_Function
31100>>>>>
31100>>>>>    Procedure Set Bar_Step_Value Integer iStep
31102>>>>>         Set Step_Value of (WaitBar(Self)) to iStep
31103>>>>>    End_Procedure
31104>>>>>
31104>>>>>    Function Bar_Step_Value Returns Integer
31106>>>>>        Function_Return (Step_Value(WaitBar(Self)))
31107>>>>>    End_Function
31108>>>>>
31108>>>>>    Procedure Set Wait_Message String sMessage
31110>>>>>        Set Value of (WaitText(Self)) to sMessage
31111>>>>>    End_Procedure
31112>>>>>
31112>>>>>    Procedure Wait_Details String sFile String sDetail Integer bInitData
31114>>>>>        Local Integer liEditId
31115>>>>>        Move (WaitEdit(Self)) to liEditId
31116>>>>>        If bInitData Send Delete_Data to liEditId
31119>>>>>        If sFile ne "" Begin
31121>>>>>           Send Read to liEditId sFile
31122>>>>>           Send Beginning_Of_Data to liEditId
31123>>>>>        End
31123>>>>>>
31123>>>>>        Else Begin
31124>>>>>           Send Insert to liEditId sDetail
31125>>>>>        End
31125>>>>>>
31125>>>>>    End_Procedure
31126>>>>>
31126>>>>>    Procedure OnResize
31128>>>>>        Local Integer liSize liHiSize liPrevSize liHiPrevSize bState liHiLoc liLoc
31129>>>>>        Get Size to liPrevSize
31130>>>>>        Move (Hi(liPrevSize)) to liHiPrevSize
31131>>>>>        Forward Send OnResize
31133>>>>>        Get Location of (WaitEdit(Self)) to liLoc
31134>>>>>        Move (Hi(liLoc)) to liHiLoc
31135>>>>>        Get piState to bState
31136>>>>>        Get Size to liSize
31137>>>>>        Move (Hi(liSize)) to liHiSize
31138>>>>>        If (liHiSize > (liHiLoc +30)) Begin
31140>>>>>            Set Value of (bnDetail(Self)) to "<< Info"
31141>>>>>            If (liHiPrevSize <= (liHiLoc +30)) Set piState to (1-bState)
31144>>>>>        End
31144>>>>>>
31144>>>>>        Else Begin
31145>>>>>            Set Value of (bnDetail(Self)) to "Info >>"
31146>>>>>            If (liHiPrevSize > (liHiLoc +30)) Set piState to (1-bState)
31149>>>>>        End
31149>>>>>>
31149>>>>>    End_Procedure
31150>>>>>
31150>>>>>    Procedure Set Button_State Integer bState
31152>>>>>        If bState Begin
31154>>>>>            Set Caption_Bar to True
31155>>>>>            Set Size to 66 256
31156>>>>>        End
31156>>>>>>
31156>>>>>        Else Begin
31157>>>>>            Set Caption_Bar to False
31158>>>>>            Set Size to 38 256
31159>>>>>        End
31159>>>>>>
31159>>>>>    End_Procedure
31160>>>>>
31160>>>>>    Procedure Set BarVisibleState String sMsg Integer bState
31162>>>>>        Set Visible_State of (oTxtAntiBar(Self)) to (bState = 0)
31163>>>>>        Set Visible_State of (WaitBar(Self))     to (bState = 1)
31164>>>>>        If (bState = 0) Begin
31166>>>>>            Set Size to 24 256
31167>>>>>            Set Location of (oTxtAntiBar(Self)) to 6 5
31168>>>>>        End
31168>>>>>>
31168>>>>>        If sMsg ne "" Set Value of (oTxtAntiBar(Self)) to sMsg
31171>>>>>    End_Procedure
31172>>>>>
31172>>>>>    Procedure Deactivating integer search_mode Returns Integer
31174>>>>>        local integer rval
31175>>>>>        Forward Get MSG_Deactivating search_mode to rval
31177>>>>>        Set Modal_State of (Wait(Self)) to False
31178>>>>>        Set BarVisibleState of (Wait(Self)) to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..." True
31179>>>>>        Procedure_Return rval
31180>>>>>    End_Procedure
31181>>>>>
31181>>>>>    Procedure UpdateWait String sMsg
31183>>>>>        Set Value of (oTxtAntiBar(Self)) to sMsg
31184>>>>>    End_Procedure
31185>>>>>
31185>>>>>
31185>>>>>    Procedure Set Horizontal_Justification Integer aiMode
31187>>>>>        Set Justification_Mode of oTxtAntiBar to (jMode_VCenter IOR aiMode)
31188>>>>>    End_Procedure
31189>>>>>
31189>>>>>
31189>>>>>
31189>>>>>
31189>>>>>
31189>>>>>
31189>>>>>    //AB-StoreEnd
31189>>>>>
31189>>>>>End_Object
31190>>>>>
31190>>>>>
31190>>>>>//AB-StoreStart
31190>>>>>
31190>>>>>//AB-StoreEnd
31190>>>>>
31190>>>>>//AB/ End_Object    // prj
31190>>>
31190>Use Calendar.sl
INCLUDING FILE: CALENDAR.SL
31190>>>//AB/ Project Calendar
31190>>>//AB/ Object prj is a Lookup_Project
31190>>>//AB/     Set ProjectName to "Calendar"
31190>>>//AB/     Set ProjectFileName to "Calendar.sl"
31190>>>
31190>>>// Project Object Structure
31190>>>//   oCalendar is a dbModalPanel
31190>>>//     Container3d1 is a Container3d
31190>>>//       Grid2 is a Grid
31190>>>//       Textbox2 is a Textbox
31190>>>//       Textbox3 is a Textbox
31190>>>//       Textbox4 is a Textbox
31190>>>//       Textbox5 is a Textbox
31190>>>//       Textbox6 is a Textbox
31190>>>//       Textbox7 is a Textbox
31190>>>//       Textbox8 is a Textbox
31190>>>//       LineControl1 is a LineControl
31190>>>//       Container3d2 is a Container3d
31190>>>//         oRght is a BitmapContainer
31190>>>//         oLeft is a BitmapContainer
31190>>>//         oMonth is a Textbox
31190>>>//           oSelectMonth is a FloatingPopupMenu
31190>>>//         oYear is a Textbox
31190>>>//         oSelectYear is a Form
31190>>>//     BitmapContainer3 is a BitmapContainer
31190>>>//     oToday is a Textbox
31190>>>
31190>>>// Register all objects
31190>>>Register_Object BitmapContainer3
31190>>>Register_Object Container3d1
31190>>>Register_Object Container3d2
31190>>>Register_Object Grid2
31190>>>Register_Object LineControl1
31190>>>Register_Object oCalendar
31190>>>Register_Object oLeft
31190>>>Register_Object oMonth
31190>>>Register_Object oRght
31190>>>Register_Object oSelectMonth
31190>>>Register_Object oSelectYear
31190>>>Register_Object oToday
31190>>>Register_Object oYear
31190>>>Register_Object Textbox2
31190>>>Register_Object Textbox3
31190>>>Register_Object Textbox4
31190>>>Register_Object Textbox5
31190>>>Register_Object Textbox6
31190>>>Register_Object Textbox7
31190>>>Register_Object Textbox8
31190>>>
31190>>>
31190>>>
31190>>>//AB-StoreTopStart
31190>>>Use dates.utl
INCLUDING FILE: DATES.UTL
31190>>>>>// **********************************************************************
31190>>>>>// Use Dates.utl    // Date manipulation for VDF and DF3.1
31190>>>>>//
31190>>>>>// by Sture Andersen (sa1@vd.dk)
31190>>>>>//
31190>>>>>// The file contains a number of global functions for manipulating
31190>>>>>// dates. The package may be used with DataFlex 3.1 and Visual DataFlex.
31190>>>>>// This package is public domain.
31190>>>>>//
31190>>>>>// The package file is accompanied by a Word document (dfutil.doc)
31190>>>>>// listing the functions and their use.
31190>>>>>//
31190>>>>>//
31190>>>>>// Create: Fri  06-06-1997 - Merger of s_utl020, 021, 022, 023, 024, 025.
31190>>>>>// Update: Thu  26-06-1997 - Fixes for strange behavior when date4_state is set.
31190>>>>>//                         - Addition of popup_calendar to VDF.
31190>>>>>//         Sun  29-06-1997 - Character mode popup calender.
31190>>>>>//         Fri  04-07-1997 - Function WeekToDate added.
31190>>>>>//         Thu  10-07-1997 - Fixes.
31190>>>>>//         Mon  11-08-1997 - WeekToDate fixed.
31190>>>>>//         Sun  24-08-1997 - Character mode popup calender finished.
31190>>>>>//         Mon  15-12-1997 - Procedure Request_Popup_Calendar added.
31190>>>>>//         Mon  29-12-1997 - Procedures ItemYear2to4, ItemDate2to4 and
31190>>>>>//                           ItemSysdate added.
31190>>>>>//         Mon  29-12-1997 - Procedures FieldYear2to4, FieldDate2to4 and
31190>>>>>//                           FieldSysdate added.
31190>>>>>//         Sun  01-02-1998 - Functions Module_Compile_Date and
31190>>>>>//                           Module_Compile_Time added.
31190>>>>>//         Wed  25-02-1998 - Request_Popup in calendar object now only
31190>>>>>//                           responds if entry_state of the calling object
31190>>>>>//                           is true (VDF version). (No apparent effect)
31190>>>>>//         Sat  28-03-1998 - Added the following functions:
31190>>>>>//                             TS_SysTime      TS_ExtractDate
31190>>>>>//                             TS_ExtractTime  TS_ConvertToString
31190>>>>>//         Tue  26-05-1998 - Procedure TS_UI_Update added
31190>>>>>//         Sat  01-08-1998 - mask_date_window taken into account
31190>>>>>//         Mon  10-08-1998 - Functions Module_Start_Date and
31190>>>>>//                           Module_Start_Time added.
31190>>>>>//         Wed  02-09-1998 - Parameter for Module_Start_Date removed
31190>>>>>//         Mon  12-10-1998 - Portuguese added
31190>>>>>//         Wed  04-11-1998 - TS_TimeEstimator class added
31190>>>>>//         Tue  29-12-1998 - Function DateAsString added
31190>>>>>//         Wed  13-01-1999 - Function DateWeekNumber changed according to
31190>>>>>//                           Kjetil Johanson
31190>>>>>//         Mon  18-01-1999 - Function DateWeekNumber changed according to
31190>>>>>//                           Kjetil Johanson (again)
31190>>>>>//         Tue  19-01-1999 - Changed procedure names in TS_TimeEstimator
31190>>>>>//                           class (Continue->TS_Continue and Pause->
31190>>>>>//                           TS_Pause)
31190>>>>>//         Thu  21-01-1999 - Procedures DateFormatAsString and DateFormatName
31190>>>>>//                           added.
31190>>>>>//                         - Procedures DateCurrentSeparator and
31190>>>>>//                           DateCurrentFormat added.
31190>>>>>//         Tue  13-04-1999 - Julian constants added: Jan1st1900, Jan1st2000
31190>>>>>//                           Jan1st1000 and Jan1st100
31190>>>>>//         Mon  26-04-1999 - Changed procedure FieldYear2to4 and ItemYear2to4
31190>>>>>//                           to trap 3 digit years.
31190>>>>>//         Wed  27-04-1999 - Changed Dutch abbriviated day names (to 2 characters)
31190>>>>>//         Sun  02-05-1999 - Added function TS_Compose2
31190>>>>>//                         - Fixed error in TS_ConvertToString
31190>>>>>//         Tue  01-06-1999 - Added procedure popup_no_export to calendar.
31190>>>>>//         Thu  15-06-1999 - Fixed Date4to2 function and exporting dates
31190>>>>>//                           from the calendar to forms with no form_margin.
31190>>>>>//         Tue  07-09-1999 - Added function DateAsText
31190>>>>>//         Wed  27-10-1999 - Temporary fix for Module_Compile_Date function
31190>>>>>//                           in combination with y2k.
31190>>>>>//         Wed  19-12-1999 - Function StringToDate added.
31190>>>>>//                         - Existing function DateAsString renamed to
31190>>>>>//                           DateToString.
31190>>>>>//         Mon  03-01-2000 - Fix for VDF4. Popup calendar on empty date field
31190>>>>>//                           would result in seeding the calendar on year 100.
31190>>>>>//                           This error was caused by the fact that VDF 4
31190>>>>>//                           ignores SYSDATE4_STATE such that the sysdate
31190>>>>>//                           command returns 03-01-100
31190>>>>>//         Wed  01-02-2000 - Define instead of #REPLACE
31190>>>>>//         Wed  23-08-2000 - Function TS_Module_Compile_Time added
31190>>>>>//
31190>>>>>// NOTE:  There is language dependent string constants in this file.
31190>>>>>//        Currently there are sections for dutch, english, danish, swedish,
31190>>>>>//        norwegian, spanish, german and portuguese
31190>>>>>//
31190>>>>>//        These sections may be identified by searching the symbol LNG_DEFAULT
31190>>>>>//
31190>>>>>// ***********************************************************************
31190>>>>>
31190>>>>>Use ui
31190>>>>>Use Language    // Set default languange if not set by compiler command line
INCLUDING FILE: LANGUAGE.PKG
31190>>>>>>>// Use Language     // Default language setup
31190>>>>>>>// Sets default languange if not set by compiler command line
31190>>>>>>>
31190>>>>>>>define lng_dutch      for 131
31190>>>>>>>define lng_french     for 133 // NOT TRANSLATED. DO NOT SELECT!
31190>>>>>>>define lng_spanish    for 134
31190>>>>>>>define lng_italian    for 139 // NOT TRANSLATED. DO NOT SELECT!
31190>>>>>>>define lng_english    for 144
31190>>>>>>>define lng_danish     for 145
31190>>>>>>>define lng_swedish    for 146
31190>>>>>>>define lng_norwegian  for 147
31190>>>>>>>define lng_Greek    for 148
31190>>>>>>>define lng_german     for 149
31190>>>>>>>define lng_portuguese for 155
31190>>>>>>>define lng_papiamentu for 199 // NOT TRANSLATED. DO NOT SELECT!
31190>>>>>>>
31190>>>>>>>
31190>>>>>>>define lng_default for !@
31190>>>>>>>
31190>>>>>>>  define _LANGUAGE_ for $ENGLISH$
31190>>>>>>>
#REM LANGUAGE SET BY LANGUAGE.PKG: $ENGLISH$
31190>>>>>Use Seq_Chnl    // Defines global sequential device management operations (DAC)
31190>>>>>Use Macros.utl  // Various macros (DESKTOP_SECTION)
INCLUDING FILE: MACROS.UTL
31190>>>>>>>// Use Macros.utl   // Various macros (FOR_EX...)
31190>>>>>>>
31190>>>>>>>//  FOR_EX (extended FOR command)
31190>>>>>>>//  -----------------------------
31190>>>>>>>//> The FOR_EX command is exactly like the standard FOR command except
31190>>>>>>>//> that it will allow you to use keyword "DOWN_TO" instead of "TO" if
31190>>>>>>>//> you need to do a decremental loop.
31190>>>>>>>
31190>>>>>>>
31190>>>>>>>//  DESKTOP_SECTION
31190>>>>>>>//  ---------------
31190>>>>>>>//> The DESKTOP_SECTION/END_DESKTOP_SECTION commands will make a sequence of
31190>>>>>>>//> code compile (or rather instantiate) as if it was situated on the DESKTOP
31190>>>>>>>//> even when it isn't. DESKTOP_SECTION's may not be nested.
31190>>>>>>>
31190>>>>>>>
31190>>>>>>>
31190>>>>>
31190>>>>>// Switches
31190>>>>>
31190>>>>>define DATES_INCLUDE_POPUP for 1   // If set to 0 the popup calendar will not be included
31190>>>>>define DATES_DF31B_EPOCH   for 40  // DF3.1b didn't have an epoch setting. Therefore this symbol defines the epoch value for that version.
31190>>>>>
31190>>>>> define t.calendar.year           for "Year"
31190>>>>> define t.calendar.month          for "Month"
31190>>>>> define t.calendar.day            for "Day"
31190>>>>> define t.calendar.week           for "Wk."
31190>>>>> define t.calendar.calendar_popup for "Calendar Popup"
31190>>>>> define t.calendar.Monday         for "Monday"
31190>>>>> define t.calendar.Tuesday        for "Tuesday"
31190>>>>> define t.calendar.Wednesday      for "Wednesday"
31190>>>>> define t.calendar.Thursday       for "Thursday"
31190>>>>> define t.calendar.Friday         for "Friday"
31190>>>>> define t.calendar.Saturday       for "Saturday"
31190>>>>> define t.calendar.Sunday         for "Sunday"
31190>>>>> define t.calendar.January        for "January"
31190>>>>> define t.calendar.February       for "February"
31190>>>>> define t.calendar.March          for "March"
31190>>>>> define t.calendar.April          for "April"
31190>>>>> define t.calendar.May            for "May"
31190>>>>> define t.calendar.June           for "June"
31190>>>>> define t.calendar.July           for "July"
31190>>>>> define t.calendar.August         for "August"
31190>>>>> define t.calendar.September      for "September"
31190>>>>> define t.calendar.October        for "October"
31190>>>>> define t.calendar.November       for "November"
31190>>>>> define t.calendar.December       for "December"
31190>>>>> define t.calendar.ok             for "OK"
31190>>>>> define t.calendar.Cancel         for "Cancel"
31190>>>>> define t.calendar.Activate       for "Activate popup calendar (Ctrl+D)"
31190>>>>>
31190>>>>>define LargestPossibleDate for 913490 // December 31st 2500
31190>>>>>define Jan1st1900          for 693975
31190>>>>>define Jan1st2000          for 730500
31190>>>>>define Jan1st1000          for 365250
31190>>>>>define Jan1st105           for 38352
31190>>>>>define Jan1st100           for 36525
31190>>>>>
31190>>>>>enumeration_list // Date Segments
31190>>>>>  define DS_DAY
31190>>>>>  define DS_WEEK
31190>>>>>  define DS_MONTH
31190>>>>>  define DS_YEAR
31190>>>>>end_enumeration_list
31190>>>>>
31190>>>>>integer Dates$Year Dates$Month Dates$Day // internal use
31190>>>>>
31190>>>>>procedure DateDecompose global date date# //very internal!!
31191>>>>>  local integer pos1# pos2# format#
31192>>>>>  local string str# sep#
31192>>>>>  get_attribute DF_DATE_FORMAT to format#
31195>>>>>  get_attribute DF_DATE_SEPARATOR to pos1# // overload
31198>>>>>  character pos1# to sep#                  // end overload
31199>>>>>>
31199>>>>>  move date# to str#
31200>>>>>  replace sep# in str# with "$"
31202>>>>>  move strmark to pos1#
31203>>>>>  if [found] begin
31205>>>>>    replace sep# in str# with "$"
31207>>>>>    move strmark to pos2#
31208>>>>>  end
31208>>>>>>
31208>>>>>  else begin
31209>>>>>    move 0 to Dates$Year
31210>>>>>    move 0 to Dates$Month
31211>>>>>    move 0 to Dates$Day
31212>>>>>  end
31212>>>>>>
31212>>>>>  [ found] begin
31214>>>>>>
31214>>>>>    if format# eq DF_DATE_EUROPEAN ;          left str# to Dates$Day    (pos1#-1)
31218>>>>>    if format# eq DF_DATE_USA begin
31220>>>>>          mid  str# to Dates$Day    (pos2#-pos1#-1) (pos1#+1)
31223>>>>>>
31223>>>>>          left str# to Dates$Month  (pos1#-1)
31225>>>>>>
31225>>>>>    end
31225>>>>>>
31225>>>>>    else  mid  str# to Dates$Month  (pos2#-pos1#-1) (pos1#+1)
31229>>>>>
31229>>>>>    if format# eq DF_DATE_MILITARY begin
31231>>>>>          mid  str# to Dates$Day  2 (pos2#+1)
31234>>>>>>
31234>>>>>          left str# to Dates$Year   (pos1#-1)
31236>>>>>>
31236>>>>>    end
31236>>>>>>
31236>>>>>    else  mid  str# to Dates$Year 4 (pos2#+1)
31240>>>>>  end
31240>>>>>>
31240>>>>>end_procedure
31241>>>>>
31241>>>>>function DateCompose global integer day# integer month# integer year# returns date
31242>>>>>  local integer format#
31243>>>>>  local date date#
31243>>>>>  local string sep#
31243>>>>>  ifnot (day#*month#*year#) function_return 0
31246>>>>>  get_attribute DF_DATE_SEPARATOR to format# // overload
31249>>>>>  character format# to sep#                  // end overload
31250>>>>>>
31250>>>>>  get_attribute DF_DATE_FORMAT to format#
31253>>>>>  if day# gt 28 begin
31255>>>>>    if format# eq DF_DATE_EUROPEAN move (date(string(day#)+sep#+string(month#)+sep#+string(year#))) to date# // DMY
31258>>>>>    if format# eq DF_DATE_USA      move (date(string(month#)+sep#+string(day#)+sep#+string(year#))) to date# // MDY
31261>>>>>    if format# eq DF_DATE_MILITARY move (date(string(year#)+sep#+string(month#)+sep#+string(day#))) to date# // YMD
31264>>>>>    send DateDecompose date#
31265>>>>>    if Dates$Month ne month# move (day#-Dates$Day) to day#
31268>>>>>  end
31268>>>>>>
31268>>>>>  if format# eq DF_DATE_EUROPEAN function_return (date(string(day#)+sep#+string(month#)+sep#+string(year#))) // DMY
31271>>>>>  if format# eq DF_DATE_USA function_return (date(string(month#)+sep#+string(day#)+sep#+string(year#))) // MDY
31274>>>>>  function_return (date(string(year#)+sep#+string(month#)+sep#+string(day#))) // YMD
31275>>>>>end_function
31276>>>>>
31276>>>>>function DateFormatName global integer format# returns string
31277>>>>>  if format# eq DF_DATE_EUROPEAN function_return "European"
31280>>>>>  if format# eq DF_DATE_USA      function_return "United States"
31283>>>>>  if format# eq DF_DATE_MILITARY function_return "Military"
31286>>>>>end_function
31287>>>>>
31287>>>>>function DateCurrentSeparator global returns string
31288>>>>>  local integer rval#
31289>>>>>  get_attribute DF_DATE_SEPARATOR to rval#
31292>>>>>  function_return (character(rval#))
31293>>>>>end_function
31294>>>>>
31294>>>>>function DateCurrentFormat global returns integer
31295>>>>>  local integer rval#
31296>>>>>  get_attribute DF_DATE_FORMAT to rval#
31299>>>>>  function_return rval#
31300>>>>>end_function
31301>>>>>
31301>>>>>function DateFormatAsString global integer format# integer long# string sep# returns string
31302>>>>>  local string rval# letter#
31303>>>>>  if format# eq DF_DATE_EUROPEAN move "3342241111" to rval#
31306>>>>>  if format# eq DF_DATE_USA      move "2243341111" to rval#
31309>>>>>  if format# eq DF_DATE_MILITARY move "1111422433" to rval#
31312>>>>>  left t.calendar.year to letter# 1
31314>>>>>>
31314>>>>>  replace "1" in rval# with letter#
31316>>>>>  replace "1" in rval# with letter#
31318>>>>>  ifnot long# move "" to letter#
31321>>>>>  move (replaces("1",rval#,letter#)) to rval#
31322>>>>>  move (replaces("2",rval#,left(t.calendar.month,1))) to rval#
31323>>>>>  move (replaces("3",rval#,left(t.calendar.day,1))) to rval#
31324>>>>>  if sep# eq "" begin
31326>>>>>    get_attribute DF_DATE_SEPARATOR to format#
31329>>>>>    character format# to sep#
31330>>>>>>
31330>>>>>  end
31330>>>>>>
31330>>>>>  move (replaces("4",rval#,sep#)) to rval#
31331>>>>>  function_return rval#
31332>>>>>end_function
31333>>>>>
31333>>>>>function StringToDate global string date# integer format# integer four_digit_year# string sep# returns date
31334>>>>>  local integer sep_len# day# month# year#
31335>>>>>  move (length(sep#)) to sep_len#
31336>>>>>  if four_digit_year# move 4 to four_digit_year#
31339>>>>>  else move 2 to four_digit_year#
31341>>>>>  if format# eq DF_DATE_EUROPEAN begin // DMY
31343>>>>>    move (mid(date#,2,1)) to day#
31344>>>>>    move (mid(date#,2,3+sep_len#)) to month#
31345>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31346>>>>>  end
31346>>>>>>
31346>>>>>  if format# eq DF_DATE_USA begin // MDY
31348>>>>>    move (mid(date#,2,1)) to month#
31349>>>>>    move (mid(date#,2,3+sep_len#)) to year#
31350>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31351>>>>>  end
31351>>>>>>
31351>>>>>  if format# eq DF_DATE_MILITARY begin // YMD
31353>>>>>    move (mid(date#,four_digit_year#,1)) to year#
31354>>>>>    move (mid(date#,2,1+four_digit_year#+sep_len#)) to month#
31355>>>>>    move (mid(date#,2,3+four_digit_year#+sep_len#+sep_len#)) to day#
31356>>>>>  end
31356>>>>>>
31356>>>>>  function_return (DateCompose(day#,month#,year#))
31357>>>>>end_function
31358>>>>>
31358>>>>>function DateToString global date date# integer format# integer four_digit_year# string sep# returns string
31359>>>>>  local string rval# day# month# year#
31360>>>>>  get Date2to4 date# to date#
31361>>>>>  if (integer(date#)) begin
31363>>>>>    send DateDecompose date#
31364>>>>>    move Dates$Day to day#
31365>>>>>    if Dates$Day lt 10 insert "0" in day# at 1
31369>>>>>    move Dates$Month to month#
31370>>>>>    if Dates$Month lt 10 insert "0" in month# at 1
31374>>>>>    move Dates$Year to year#
31375>>>>>    ifnot four_digit_year# move (right(year#,2)) to year#
31378>>>>>    if format# eq DF_DATE_EUROPEAN move (day#+sep#+month#+sep#+year#) to rval# // DMY
31381>>>>>    if format# eq DF_DATE_USA      move (month#+sep#+day#+sep#+year#) to rval# // MDY
31384>>>>>    if format# eq DF_DATE_MILITARY move (year#+sep#+month#+sep#+day#) to rval# // YMD
31387>>>>>  end
31387>>>>>>
31387>>>>>  function_return rval#
31388>>>>>end_function
31389>>>>>
31389>>>>>// Function DateAsString is only here for compatibility with earlier versions.
31389>>>>>// Use function DateToString instead.
31389>>>>>function DateAsString global date date# integer format# integer four_digit_year# string sep# returns string
31390>>>>>  function_return (DateToString(date#,format#,four_digit_year#,sep#))
31391>>>>>end_function
31392>>>>>
31392>>>>>function DateIncrement global date date# integer segment# integer amount# returns date
31393>>>>>  if (date#=0) function_return 0
31396>>>>>  if segment# eq DS_WEEK function_return (date#+(amount#*7)) //weeks
31399>>>>>  if (segment#<>DS_DAY) begin // months or years
31401>>>>>    send DateDecompose date#
31402>>>>>    if segment# eq DS_MONTH begin //months
31404>>>>>      move (Dates$Month+amount#) to Dates$Month
31405>>>>>      if amount# ge 0 function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-1)/12)*12),Dates$Year+((Dates$Month-1)/12)))
31408>>>>>      function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-12)/12)*12),Dates$Year+((Dates$Month-12)/12)))
31409>>>>>    end //years:
31409>>>>>>
31409>>>>>    if segment# eq DS_YEAR function_return (DateCompose(Dates$Day,Dates$Month,Dates$Year+amount#))
31412>>>>>  end
31412>>>>>>
31412>>>>>  else function_return (date#+amount#) //days
31414>>>>>end_function
31415>>>>>
31415>>>>>function DateSegment global date date# integer segment# returns integer
31416>>>>>  send DateDecompose date#
31417>>>>>  if segment# eq DS_DAY   function_return Dates$Day
31420>>>>>  if segment# eq DS_MONTH function_return Dates$Month
31423>>>>>  if segment# eq DS_YEAR  function_return Dates$Year
31426>>>>>end_function
31427>>>>>
31427>>>>>function DateToInteger global date date# returns integer
31428>>>>>  send DateDecompose date#
31429>>>>>  function_return (Dates$Year*100+Dates$Month*100+Dates$Day)
31430>>>>>end_function
31431>>>>>
31431>>>>>function FirstDayInMonth global date date# returns date
31432>>>>>  local integer month# year#
31433>>>>>  move (DateSegment(date#,DS_MONTH)) to month#
31434>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31435>>>>>  function_return (DateCompose(1,month#,year#))
31436>>>>>end_function
31437>>>>>
31437>>>>>function LastDayInMonth global date date# returns date
31438>>>>>  move (DateIncrement(date#,DS_MONTH,1)) to date#
31439>>>>>  function_return (FirstDayInMonth(date#)-1)
31440>>>>>end_function
31441>>>>>
31441>>>>>function FirstDayInYear global date date# returns date
31442>>>>>  local integer year#
31443>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31444>>>>>  function_return (DateCompose(1,1,year#))
31445>>>>>end_function
31446>>>>>
31446>>>>>function LastDayInYear global date date# returns date
31447>>>>>  move (DateIncrement(date#,DS_YEAR,1)) to date#
31448>>>>>  function_return (FirstDayInYear(date#)-1)
31449>>>>>end_function
31450>>>>>
31450>>>>>// Prior to 18/1-99 version of DateWeekNumber
31450>>>>>//function DateWeekNumber global date date# returns integer
31450>>>>>//  local integer week# first_wd# day_of_year# year#
31450>>>>>//  if (date#=0) function_return 0
31450>>>>>//  get Date2to4 date# to date#
31450>>>>>//  move (DateSegment(date#,DS_YEAR)) to year#
31450>>>>>//  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31450>>>>>//  move (date#-FirstDayInYear(date#)) to day_of_year#
31450>>>>>//  move (day_of_year#-1-7+first_wd#) to day_of_year#
31450>>>>>//  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31450>>>>>//  else move 0 to week#
31450>>>>>//  if first_wd# le 4 increment week#
31450>>>>>//  if week# gt 52 begin
31450>>>>>//    move 1 to week#
31450>>>>>//    if first_wd# eq 4 move 53 to week#
31450>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31450>>>>>//  end
31450>>>>>//  if week# eq 0 begin
31450>>>>>//    //get DateWeekNumber (DateIncrement(date#,DS_YEAR,-1)) to first_wd# // Original line
31450>>>>>//    get DateDayNumber  (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#ÿ // changed line
31450>>>>>//    move 52 to week#
31450>>>>>//    if first_wd# eq 4 move 53 to week#
31450>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31450>>>>>//  end
31450>>>>>//  function_return week#
31450>>>>>//end_function
31450>>>>>
31450>>>>>function DateWeekNumber global date date# returns integer
31451>>>>>  local integer week# first_wd# day_of_year# year# wd#
31452>>>>>  if (date#=0) function_return 0
31455>>>>>  get Date2to4 date# to date#
31456>>>>>  // Leap-year test for actual or previous year
31456>>>>>  // Year# only used for selection between 52 and
31456>>>>>  // Therefore get year# from the first day of actual week
31456>>>>>  get DateDayNumber date# to wd#
31457>>>>>  move (DateSegment(date#-wd#+1,DS_YEAR)) to year#
31458>>>>>
31458>>>>>  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31459>>>>>  move (date#-FirstDayInYear(date#)) to day_of_year#
31460>>>>>  move (day_of_year#-1-7+first_wd#) to day_of_year#
31461>>>>>  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31464>>>>>  else move 0 to week#
31466>>>>>  if first_wd# le 4 increment week#
31469>>>>>  if week# gt 52 begin
31471>>>>>    move 1 to week#
31472>>>>>    if first_wd# eq 4 move 53 to week#
31475>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31482>>>>>  end
31482>>>>>>
31482>>>>>  if week# eq 0 begin
31484>>>>>    // Week 52 or 53
31484>>>>>    get DateDayNumber (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#
31485>>>>>    move 52 to week#
31486>>>>>    if first_wd# eq 4 move 53 to week#
31489>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31496>>>>>  end
31496>>>>>>
31496>>>>>  function_return week#
31497>>>>>end_function
31498>>>>>
31498>>>>>function DayName global integer int# returns string
31499>>>>>  if int# eq 1 function_return t.calendar.Monday
31502>>>>>  if int# eq 2 function_return t.calendar.Tuesday
31505>>>>>  if int# eq 3 function_return t.calendar.Wednesday
31508>>>>>  if int# eq 4 function_return t.calendar.Thursday
31511>>>>>  if int# eq 5 function_return t.calendar.Friday
31514>>>>>  if int# eq 6 function_return t.calendar.Saturday
31517>>>>>  if int# eq 7 function_return t.calendar.Sunday
31520>>>>>  function_return ""
31521>>>>>end_function
31522>>>>>
31522>>>>>function DateDayNumber global date date# returns integer
31523>>>>>  local integer rval# // 1=Monday, ... , 7=Sunday
31524>>>>>  get Date2to4 date# to date#
31525>>>>>  move date# to rval#
31526>>>>>  if rval# begin
31528>>>>>    if rval# gt 693975 move (rval#-2) to rval#
31531>>>>>    move (rval#-((rval#/7)*7)) to rval#
31532>>>>>    if rval# eq 0 move 7 to rval#
31535>>>>>  end
31535>>>>>>
31535>>>>>  function_return rval#
31536>>>>>end_function
31537>>>>>
31537>>>>>function DateDayName global date date# returns string
31538>>>>>  function_return (DayName(DateDayNumber(date#)))
31539>>>>>end_function
31540>>>>>
31540>>>>>function YearMaxWeek global integer year# returns integer
31541>>>>>  local integer wk1# wk2#
31542>>>>>  get DateWeekNumber (DateCompose(31,12,year#)) to wk1#
31543>>>>>  get DateWeekNumber (DateCompose(24,12,year#)) to wk2#
31544>>>>>  function_return (wk1# max wk2#)
31545>>>>>end_function
31546>>>>>
31546>>>>>function WeekToDate global integer year# integer week# returns date
31547>>>>>  local date date#
31548>>>>>  move (DateCompose(1,1,year#)) to date#
31549>>>>>  if (DateWeekNumber(date#)) ne 1 move (date#+7) to date# // week 52 or 53
31552>>>>>  move (date#-DateDayNumber(date#)+1) to date# // Now it's a Monday
31553>>>>>  function_return (week#-1*7+date#)
31554>>>>>end_function
31555>>>>>
31555>>>>>function MonthName global integer int# returns string
31556>>>>>  if int# eq  1 function_return t.calendar.January
31559>>>>>  if int# eq  2 function_return t.calendar.February
31562>>>>>  if int# eq  3 function_return t.calendar.March
31565>>>>>  if int# eq  4 function_return t.calendar.April
31568>>>>>  if int# eq  5 function_return t.calendar.May
31571>>>>>  if int# eq  6 function_return t.calendar.June
31574>>>>>  if int# eq  7 function_return t.calendar.July
31577>>>>>  if int# eq  8 function_return t.calendar.August
31580>>>>>  if int# eq  9 function_return t.calendar.September
31583>>>>>  if int# eq 10 function_return t.calendar.October
31586>>>>>  if int# eq 11 function_return t.calendar.November
31589>>>>>  if int# eq 12 function_return t.calendar.December
31592>>>>>  function_return ""
31593>>>>>end_function
31594>>>>>
31594>>>>>function DateMonthName global date date# returns string
31595>>>>>  function_return (MonthName(DateSegment(date#,DS_MONTH)))
31596>>>>>end_function
31597>>>>>
31597>>>>>function DateAsText global date date# string format# returns string
31598>>>>>  if date# eq 0 function_return ""
31601>>>>>  move (replace("#DN",format#,DateDayName(date#)))                  to format#
31602>>>>>  move (replace("#MN",format#,DateMonthName(date#)))                to format#
31603>>>>>  move (replace("#D" ,format#,string(DateSegment(date#,DS_DAY))))   to format#
31604>>>>>  move (replace("#Y" ,format#,string(DateSegment(date#,DS_YEAR))))  to format#
31605>>>>>  move (replace("#M" ,format#,string(DateSegment(date#,DS_MONTH)))) to format#
31606>>>>>  function_return format#
31607>>>>>end_function
31608>>>>>
31608>>>>>function Year2to4 global integer year# returns integer
31609>>>>>  local integer epoch_value#
31610>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31611>>>>>  if year# lt 100 begin
31613>>>>>    if year# gt epoch_value# function_return (year#+1900)
31616>>>>>    function_return (year#+2000)
31617>>>>>  end
31617>>>>>>
31617>>>>>  function_return year# // No conversion done!
31618>>>>>end_function
31619>>>>>
31619>>>>>function Date2to4 global date date# returns date
31620>>>>>  local integer epoch_value#
31621>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31622>>>>>  if date# gt 0 begin // Only if there is a date to convert
31624>>>>>    if (DateSegment(date#,DS_YEAR)) lt 105 begin
31626>>>>>      if Dates$Year gt epoch_value# function_return (DateIncrement(date#,DS_YEAR,1900))
31629>>>>>      function_return (DateIncrement(date#,DS_YEAR,2000))
31630>>>>>    end
31630>>>>>>
31630>>>>>    function_return date# // No conversion done!
31631>>>>>  end
31631>>>>>>
31631>>>>>end_function
31632>>>>>
31632>>>>>function Date4to2 global date date# returns date
31633>>>>>  local integer epoch_value# year#
31634>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31635>>>>>  if date# gt 0 begin // Only if there is a date to convert
31637>>>>>    move (DateSegment(date#,DS_YEAR)) to year#
31638>>>>>    if year# ge 100 begin // Only then conversion is needed!
31640>>>>>      if (year#>=(1900+epoch_value#) and year#<(2000+epoch_value#)) begin
31642>>>>>        if year# lt 2000 function_return (DateIncrement(date#,DS_YEAR,-1900))
31645>>>>>        else             function_return (DateIncrement(date#,DS_YEAR,-2000))
31647>>>>>      end
31647>>>>>>
31647>>>>>      else error 301 "Date is out of epoch range"
31649>>>>>    end
31649>>>>>>
31649>>>>>  end
31649>>>>>>
31649>>>>>  function_return date# // No conversion done!
31650>>>>>end_function
31651>>>>>
31651>>>>>function dSysDate global returns date
31652>>>>>  local date date#
31653>>>>>  sysdate4 date#
31654>>>>>  function_return date#
31655>>>>>end_function
31656>>>>>
31656>>>>>function iSysYear global returns integer
31657>>>>>  local date date#
31658>>>>>  sysdate4 date#
31659>>>>>  function_return (DateSegment(date#,DS_YEAR))
31660>>>>>end_function
31661>>>>>
31661>>>>>procedure ItemSysdate for desktop integer itm#
31662>>>>>  local date date#
31663>>>>>  get value item itm# to date#
31664>>>>>  if date# eq 0 begin
31666>>>>>    sysdate4 date#
31667>>>>>    set changed_value item itm# to date#
31668>>>>>  end
31668>>>>>>
31668>>>>>end_procedure
31669>>>>>
31669>>>>>procedure ItemDate2to4 for desktop integer itm#
31670>>>>>  local integer year#
31671>>>>>  local date date# new_date#
31671>>>>>  get value item itm# to date#
31672>>>>>
31672>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31673>>>>>  if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31676>>>>>  else move date# to new_date#
31678>>>>>
31678>>>>>  move (Date2to4(new_date#)) to new_date#
31679>>>>>  move (DateSegment(new_date#,3)) to year#
31680>>>>>  if (year#>99 and year#<1000) begin
31682>>>>>    error 15 // Illegal entry in this window
31683>>>>>>
31683>>>>>    procedure_return 1
31684>>>>>  end
31684>>>>>>
31684>>>>>  if new_date# ne date# set value item itm# to new_date#
31687>>>>>end_procedure
31688>>>>>
31688>>>>>procedure ItemYear2to4 for desktop integer itm#
31689>>>>>  local integer year# new_year#
31690>>>>>  get value item itm# to year#
31691>>>>>  if (year#>99 and year#<1000) begin
31693>>>>>    error 15 // Illegal entry in this window
31694>>>>>>
31694>>>>>    procedure_return 1
31695>>>>>  end
31695>>>>>>
31695>>>>>  move (Year2to4(year#)) to new_year#
31696>>>>>  if new_year# ne year# set value item itm# to new_year#
31699>>>>>end_procedure
31700>>>>>
31700>>>>> procedure FieldSysdate for DataDictionary integer fld#
31701>>>>>   local date date#
31702>>>>>   get field_current_value fld# to date#
31703>>>>>   if date# eq 0 begin
31705>>>>>     sysdate4 date#
31706>>>>>     set field_changed_value fld# to date#
31707>>>>>   end
31707>>>>>>
31707>>>>> end_procedure
31708>>>>>
31708>>>>> procedure FieldDate2to4 for DataDictionary integer fld#
31709>>>>>   local integer year#
31710>>>>>   local date date# new_date#
31710>>>>>   get field_current_value fld# to date#
31711>>>>>
31711>>>>>   move (DateSegment(date#,DS_YEAR)) to year#
31712>>>>>   if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31715>>>>>   else move date# to new_date#
31717>>>>>
31717>>>>>   move (Date2to4(new_date#)) to new_date#
31718>>>>>   move (DateSegment(new_date#,3)) to year#
31719>>>>>   if (year#>99 and year# <=999) begin
31721>>>>>     error 15 // Illegal entry in this window
31722>>>>>>
31722>>>>>     procedure_return 1
31723>>>>>   end
31723>>>>>>
31723>>>>>   if new_date# ne date# set field_changed_value fld# to new_date#
31726>>>>> end_procedure
31727>>>>>
31727>>>>> procedure FieldYear2to4 for DataDictionary integer fld#
31728>>>>>   local integer year# new_year# changed#
31729>>>>>   get field_current_value fld# to year#
31730>>>>>   get field_changed_state fld# to changed#
31731>>>>>   if changed# begin
31733>>>>>     if (year#>99 and year#<1000) begin
31735>>>>>       error 15 // Illegal entry in this window
31736>>>>>>
31736>>>>>       procedure_return 1
31737>>>>>     end
31737>>>>>>
31737>>>>>     move (Year2to4(year#)) to new_year#
31738>>>>>     if new_year# ne year# set field_changed_value fld# to new_year#
31741>>>>>   end
31741>>>>>>
31741>>>>> end_procedure
31742>>>>>
31742>>>>> function SysDate global returns date
31743>>>>>   function_return (dSysDate())
31744>>>>> end_function
31745>>>>>
31745>>>>>function sSysTime global returns string
31746>>>>>  local integer h# m# s#
31747>>>>>  sysdate4 h# h# m# s#
31751>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31752>>>>>end_function
31753>>>>>
31753>>>>>function TS_SysTime global returns number
31754>>>>>  local integer d# h# m# s#
31755>>>>>  sysdate4 d# h# m# s#
31759>>>>>  function_return (d#*24.0+h#*60+m#*60+s#)
31760>>>>>end_function
31761>>>>>
31761>>>>>//> This function returns a TS value composed from the date and time
31761>>>>>//> passed to it. Note that the time variable must be of the format
31761>>>>>//> "hh:mm:ss".
31761>>>>>function TS_Compose global date date# string time# returns number
31762>>>>>  local integer h# m# s#
31763>>>>>  left time# to h# 2
31765>>>>>>
31765>>>>>  mid time# to m# 2 4
31768>>>>>>
31768>>>>>  mid time# to s# 2 7
31771>>>>>>
31771>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31772>>>>>end_function
31773>>>>>
31773>>>>>function TS_Compose2 global date date# integer h# integer m# integer s# returns number
31774>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31775>>>>>end_function
31776>>>>>
31776>>>>>function TS_ExtractDate global number time# returns date
31777>>>>>  function_return (time#/86400) // 86400=24*60*60
31778>>>>>end_function
31779>>>>>
31779>>>>>function TS_ExtractTime global number time# returns string
31780>>>>>  local integer h# m# s#
31781>>>>>  move (time#-(86400.0*integer(TS_ExtractDate(time#)))) to s#
31782>>>>>  move (s#/3600) to h#
31783>>>>>  move (s#-(h#*3600)) to s#
31784>>>>>  move (s#/60) to m#
31785>>>>>  move (s#-(m#*60)) to s#
31786>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31787>>>>>end_function
31788>>>>>
31788>>>>>function TS_ConvertToString global number time# returns string
31789>>>>>  local date d#
31790>>>>>  move (TS_ExtractDate(time#)) to d#
31791>>>>>  if (integer(d#)) function_return (string(d#)+" "+TS_ExtractTime(time#))
31794>>>>>  else function_return (TS_ExtractTime(time#))
31796>>>>>end_function
31797>>>>>
31797>>>>>function TS_ConvertToStringNoDate global number ts# returns string
31798>>>>>  local integer h# m#
31799>>>>>  move (ts#/3600) to h#
31800>>>>>  move (ts#-(h#*3600)) to ts#
31801>>>>>  move (ts#/60) to m#
31802>>>>>  move (ts#-(m#*60)) to ts#
31803>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(ts#<10,"0","")+string(ts#))
31804>>>>>end_function
31805>>>>>
31805>>>>>// This procedure is used when a TS-variable must be displayed on screen.
31805>>>>>procedure TS_UI_Update global number TS# integer obj1# integer itm1# integer tmp_obj2# integer tmp_itm2#
31806>>>>>  local integer obj2# itm2#
31807>>>>>  if num_arguments gt 3 begin
31809>>>>>    move tmp_obj2# to obj2#
31810>>>>>    move tmp_itm2# to itm2#
31811>>>>>  end
31811>>>>>>
31811>>>>>  else begin
31812>>>>>    move obj1# to obj2#
31813>>>>>    move (itm1#+1) to itm2#
31814>>>>>  end
31814>>>>>>
31814>>>>>  set value of obj1# item itm1# to (TS_ExtractDate(TS#))
31815>>>>>  set value of obj2# item itm2# to (TS_ExtractTime(TS#))
31816>>>>>end_procedure
31817>>>>>
31817>>>>>class TS_TimeEstimator is an array
31818>>>>>  procedure construct_object
31819>>>>>    forward send construct_object
31821>>>>>    set delegation_mode to delegate_to_parent
31822>>>>>    property number  pnTotal   public 0 // Seconds needed to run the loop.
31823>>>>>    property number  pnElapsed public 0 // Seconds elapsed so far.
31824>>>>>    property number  pnLeft    public 0 // Number of seconds left
31825>>>>>    property number  pnStart   public 0
31826>>>>>    property number  pnPause   public 0
31827>>>>>    property number  pnPercent public 0
31828>>>>>    property integer piMin     public 0
31829>>>>>    property integer piMax     public 0
31830>>>>>  end_procedure
31831>>>>>
31831>>>>>  procedure TS_Start integer min# integer max#
31832>>>>>    set piMin to min#
31833>>>>>    set piMax to max#
31834>>>>>    set pnStart to (TS_SysTime())
31835>>>>>    set pnElapsed to 0
31836>>>>>    set pnPercent to 0
31837>>>>>  end_procedure
31838>>>>>
31838>>>>>  procedure TS_Calculate integer pos#
31839>>>>>    local integer min# max#
31840>>>>>    get piMin to min#
31841>>>>>    get piMax to max#
31842>>>>>    set pnElapsed to (TS_SysTime()-pnStart(current_object))
31843>>>>>    set pnTotal   to (pnElapsed(current_object)*(max#-min#)/number(pos#-min#))
31844>>>>>    set pnLeft    to (pnTotal(current_object)-pnElapsed(current_object))
31845>>>>>    set pnPercent to (100.0*(pos#-min#)/(max#-min#))
31846>>>>>  end_procedure
31847>>>>>
31847>>>>>  procedure TS_Pause
31848>>>>>    set pnPause to (TS_SysTime())
31849>>>>>  end_procedure
31850>>>>>
31850>>>>>  procedure TS_Continue
31851>>>>>    set pnStart to (pnStart(current_object)+TS_SysTime()-pnPause(current_object))
31852>>>>>  end_procedure
31853>>>>>end_class
31854>>>>>
31854>>>>>function TS_Module_Compile_Time global string path# returns number
31855>>>>>  local integer pos# day# month# year# seqeof# ch#
31856>>>>>  local string date# str# time#
31856>>>>>  move path# to str#
31857>>>>>  if str# ne "" begin
31859>>>>>    get Seq_New_Channel to ch#   // This method and Seq_Release_Channel are
31860>>>>>    send Seq_Release_Channel ch# // We only need it for a second
31861>>>>>      direct_input channel ch# (trim(str#)+".vd6") // VDF 6
31863>>>>>      [seqeof] direct_input channel ch# (trim(str#)+".vd5") // VDF 5
31865>>>>>    [ seqeof] move 1 to seqeof#
31866>>>>>    [~seqeof] move 0 to seqeof#
31867>>>>>    [~seqeof] readln str#
31868>>>>>    close_input channel ch#
31870>>>>>  end
31870>>>>>>
31870>>>>>  if seqeof# function_return 0
31873>>>>>  pos "," in str# to pos#
31875>>>>>>
31875>>>>>  move (mid(str#,18,pos#+2)) to str#
31876>>>>>  move (integer(mid(str#,2,4))) to day#
31877>>>>>  move (integer(mid(str#,2,1))) to month#
31878>>>>>  move (integer(mid(str#,2,7))) to year#
31879>>>>>  if year# eq 10 begin
31881>>>>>    move (integer(mid(str#,3,7))+1900) to year#
31882>>>>>    move (mid(str#,8,11)) to str#
31883>>>>>  end
31883>>>>>>
31883>>>>>  else move (mid(str#,8,10)) to str#
31885>>>>>  move (DateCompose(day#,month#,year#)) to date#
31886>>>>>  move (Date2to4(date#)) to date#
31887>>>>>  pos ":" in str# to pos#
31889>>>>>>
31889>>>>>  function_return (TS_Compose(date#,mid(str#,8,pos#-2)))
31890>>>>>end_function
31891>>>>>
31891>>>>>string Dates$Module_Compile_Time
31891>>>>>move "" to Dates$Module_Compile_Time
31892>>>>>
31892>>>>>function Module_Compile_Date global returns date
31893>>>>>  local number ts#
31894>>>>>  local string str#
31894>>>>>  get module_name to str# // 'module_name' is most likely the name of the .flx file.
31895>>>>>  get TS_Module_Compile_Time str# to ts#
31896>>>>>  move (TS_ExtractTime(ts#)) to Dates$Module_Compile_Time
31897>>>>>  function_return (TS_ExtractDate(ts#))
31898>>>>>end_function
31899>>>>>
31899>>>>>function Module_Compile_Time global returns string
31900>>>>>  local date grb#
31901>>>>>  // Module_Compile_Date must be called before this one!
31901>>>>>  if Dates$Module_Compile_Time eq "" move (Module_Compile_Date()) to grb#
31904>>>>>  function_return Dates$Module_Compile_Time
31905>>>>>end_function
31906>>>>>
31906>>>>>date   Dates$ModuleStartDate
31906>>>>>string Dates$ModuleStartTime 8
31906>>>>>move (dSysDate()) to Dates$ModuleStartDate
31907>>>>>move (sSysTime()) to Dates$ModuleStartTime
31908>>>>>
31908>>>>>function Module_Start_Date global returns date
31909>>>>>  function_return Dates$ModuleStartDate
31910>>>>>end_function
31911>>>>>
31911>>>>>function Module_Start_Time global returns string
31912>>>>>  function_return Dates$ModuleStartTime
31913>>>>>end_function
31914>>>>>
31914>>>>> register_procedure NotifyPopupCalendarChange date date#
31914>>>>> register_procedure NotifyPopupCalendarSelect date date#
31914>>>>>  use dfAllent
31914>>>>>  class calendar.textbox is a textbox
31915>>>>>    procedure construct_object
31916>>>>>      forward send construct_object
31918>>>>>      Set Auto_Size_State To False
31919>>>>>      Set Justification_Mode To (jMode_vCenter+jMode_Center)
31920>>>>>    end_procedure
31921>>>>>  end_class
31922>>>>>
31922>>>>>  register_object btn1
31922>>>>>  register_object btn6
31922>>>>>
31922>>>>>  class calendar.button is a button
31923>>>>>
31923>>>>>    procedure construct_object
31924>>>>>      forward send construct_object
31926>>>>>      set size to 15 18
31927>>>>>      on_key kleftarrow   send prev_day
31928>>>>>      on_key krightarrow  send next_day
31929>>>>>      on_key kuparrow     send prev_week
31930>>>>>      on_key kdownarrow   send next_week
31931>>>>>      property date p_assigned_date public 0
31932>>>>>    end_procedure
31933>>>>>
31933>>>>>    procedure switch // This makes all 42 buttons act as if they are one focus
31934>>>>>      send activate to (btn1(current_object))
31935>>>>>    end_procedure
31936>>>>>    procedure switch_back
31937>>>>>      send activate to (btn6(current_object))
31938>>>>>    end_procedure
31939>>>>>
31939>>>>>    procedure mouse_down
31940>>>>>      local integer current_object#
31941>>>>>      forward send mouse_down
31943>>>>>      move current_object to current_object#
31944>>>>>      delegate set p_current_date to (p_assigned_date(current_object#))
31946>>>>>    end_procedure
31947>>>>>  end_class
31948>>>>>
31948>>>>>  desktop_section
31954>>>>>    object popup_calendar is a ModalPanel
31956>>>>>      set size to 160 250
31957>>>>>      property date    p_current_date  public 0
31959>>>>>      property integer p_current_year  public -1
31961>>>>>      property integer p_current_month public -1
31963>>>>>      property integer pExportState    public 1
31965>>>>>
31965>>>>>      on_key key_ctrl+key_pgup send prev_year
31966>>>>>      on_key key_ctrl+key_pgdn send next_year
31967>>>>>      on_key          key_pgup send prev_month
31968>>>>>      on_key          key_pgdn send next_month
31969>>>>>      on_key key_ctrl+key_d    send go_today
31970>>>>>      on_key kcancel           send cancel
31971>>>>>
31971>>>>>      object cont3d is a container3d
31973>>>>>        set location to 5 5
31974>>>>>        set size to 120 237
31975>>>>>        object textbox_year is a calendar.textbox
31977>>>>>          set location to 5 5
31978>>>>>          set size to 15 30
31979>>>>>          set border_style to border_staticedge
31980>>>>>          procedure display
31982>>>>>            set value to (p_current_year(current_object))
31983>>>>>          end_procedure
31984>>>>>        end_object
31985>>>>>        object dayname_header is a container3d
31987>>>>>          set location to 5 39
31988>>>>>          set size to 15 126
31989>>>>>          set border_style to border_staticedge
31990>>>>>          procedure initialize
31992>>>>>            local integer itm#
31993>>>>>            for itm# from 0 to 6
31999>>>>>>
31999>>>>>              object txt is a calendar.textbox
32001>>>>>                set size to 12 17
32002>>>>>                set location to 0 (itm#*17.6+1)
32003>>>>>                 set value to (left(DayName(itm#+1),3))
32004>>>>>              end_object
32005>>>>>            loop
32006>>>>>>
32006>>>>>          end_procedure
32007>>>>>          send initialize
32008>>>>>        end_object
32009>>>>>        object weeknumber_header is a container3d
32011>>>>>          set location to 24 5
32012>>>>>          set size     to 89 30
32013>>>>>          set border_style to border_staticedge
32014>>>>>          object obj_id_array is an array
32016>>>>>          end_object
32017>>>>>          procedure initialize
32019>>>>>            local integer itm# obj#
32020>>>>>            move (obj_id_array(current_object)) to obj#
32021>>>>>            for itm# from 0 to 5
32027>>>>>>
32027>>>>>              object txt is a textbox
32029>>>>>                set size to 15 30
32030>>>>>                set location to (itm#*15+1) 1
32031>>>>>                set value of obj# item (item_count(obj#)) to current_object
32032>>>>>              end_object
32033>>>>>            loop
32034>>>>>>
32034>>>>>          end_procedure
32035>>>>>          procedure display
32037>>>>>            local integer itm# obj#
32038>>>>>            local date date# last_date#
32038>>>>>            move (obj_id_array(current_object)) to obj#
32039>>>>>            get p_current_date to date#
32040>>>>>            move (FirstDayInMonth(date#)) to date#
32041>>>>>            move (LastDayInMonth(date#)) to last_date#
32042>>>>>            move (date#-DateDayNumber(date#)+1) to date#
32043>>>>>            for itm# from 0 to 5
32049>>>>>>
32049>>>>>              if (itm#*7+date#) le last_date# ;                set value of (integer(value(obj#,itm#))) to (t.calendar.week*string(DateWeekNumber(itm#*7+date#)))
32052>>>>>              else set value of (integer(value(obj#,itm#))) to ""
32054>>>>>            loop
32055>>>>>>
32055>>>>>          end_procedure
32056>>>>>          send initialize
32057>>>>>        end_object
32058>>>>>        object days_grid is a container3d
32060>>>>>          set location to 23 39
32061>>>>>          set size     to 100 127
32062>>>>>          set border_style to border_none
32063>>>>>          object btn_array is an array
32065>>>>>          end_object
32066>>>>>          procedure initialize
32068>>>>>            local integer row# col# button_array#
32069>>>>>            move (btn_array(current_object)) to button_array#
32070>>>>>            for row# from 0 to 5
32076>>>>>>
32076>>>>>              for col# from 0 to 6
32082>>>>>>
32082>>>>>                object btn is a calendar.button
32084>>>>>                  set location to (row#*15) (col#*18)
32085>>>>>                  set value of button_array# item (item_count(button_array#)) to current_object
32086>>>>>                  on_item "" send move_value_out_ok
32087>>>>>                end_object
32088>>>>>              loop
32089>>>>>>
32089>>>>>            loop
32090>>>>>>
32090>>>>>          end_procedure
32091>>>>>          send initialize
32092>>>>>
32092>>>>>          procedure display.iii integer itm# integer day# integer activate#
32094>>>>>            local integer obj# current_day#
32095>>>>>            move (integer(value(btn_array(current_object),itm#))) to obj#
32096>>>>>            move (DateSegment(p_current_date(current_object),DS_DAY)) to current_day#
32097>>>>>            if activate# begin
32099>>>>>              if day# eq current_day# send activate to obj#
32102>>>>>            end
32102>>>>>>
32102>>>>>            else begin
32103>>>>>              if day# begin
32105>>>>>                set value of obj# to day#
32106>>>>>                set visible_state of obj# to true
32107>>>>>                set p_assigned_date of obj# to (DateCompose(day#,p_current_month(current_object),p_current_year(current_object)))
32108>>>>>              end
32108>>>>>>
32108>>>>>              else set visible_state of obj# to false
32110>>>>>            end
32110>>>>>>
32110>>>>>          end_procedure
32111>>>>>
32111>>>>>          procedure display integer activate#
32113>>>>>            local integer first_item# last_item# itm# day# date#
32114>>>>>            get p_current_date to date#
32115>>>>>            move (FirstDayInMonth(date#)) to date#
32116>>>>>            move (DateDayNumber(date#)-1) to first_item#
32117>>>>>            move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32118>>>>>            ifnot activate# begin
32120>>>>>              for itm# from 0 to (first_item#-1)
32126>>>>>>
32126>>>>>                send display.iii itm# 0 0
32127>>>>>              loop
32128>>>>>>
32128>>>>>            end
32128>>>>>>
32128>>>>>            move 1 to day#
32129>>>>>            for itm# from first_item# to last_item#
32135>>>>>>
32135>>>>>              send display.iii itm# day# activate#
32136>>>>>              increment day#
32137>>>>>            loop
32138>>>>>>
32138>>>>>            ifnot activate# begin
32140>>>>>              for itm# from (last_item#+1) to 41
32146>>>>>>
32146>>>>>                send display.iii itm# 0 0
32147>>>>>              loop
32148>>>>>>
32148>>>>>            end
32148>>>>>>
32148>>>>>          end_procedure
32149>>>>>        end_object
32150>>>>>        object txt_month is a calendar.textbox
32152>>>>>          set size to 12 27
32153>>>>>          set location to 25 185
32154>>>>>          set value to t.calendar.month
32155>>>>>        end_object
32156>>>>>        object btn1 is a button
32158>>>>>          set size to 12 12
32159>>>>>          set location to 40 185
32160>>>>>          on_item "" send prev_month
32161>>>>>          set bitmap to "prev.bmp"
32162>>>>>          procedure switch_back
32164>>>>>            send display_main
32165>>>>>          end_procedure
32166>>>>>        end_object
32167>>>>>        object btn2 is a button
32169>>>>>          set size to 12 12
32170>>>>>          set location to 40 200
32171>>>>>          on_item "" send next_month
32172>>>>>          set bitmap to "next.bmp"
32173>>>>>        end_object
32174>>>>>        object txt_year is a calendar.textbox
32176>>>>>          set size to 12 27
32177>>>>>          set location to 70 185
32178>>>>>          set value to t.calendar.year
32179>>>>>        end_object
32180>>>>>        object btn3 is a button
32182>>>>>          set size to 12 12
32183>>>>>          set location to 85 185
32184>>>>>          on_item "" send prev_year
32185>>>>>          set bitmap to "prev.bmp"
32186>>>>>        end_object
32187>>>>>        object btn4 is a button
32189>>>>>          set size to 12 12
32190>>>>>          set location to 85 200
32191>>>>>          on_item "" send next_year
32192>>>>>          set bitmap to "next.bmp"
32193>>>>>        end_object
32194>>>>>      end_object
32195>>>>>      object btn5 is a button
32197>>>>>        set size to 14 60
32198>>>>>        set location to 129 115
32199>>>>>        on_item t.calendar.ok send move_value_out_ok
32200>>>>>      end_object
32201>>>>>      object btn6 is a button
32203>>>>>        set size to 14 60
32204>>>>>        set location to 129 182
32205>>>>>        on_item t.calendar.cancel send cancel
32206>>>>>        procedure switch
32208>>>>>          send display_main
32209>>>>>        end_procedure
32210>>>>>      end_object
32211>>>>>      procedure next_year
32213>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32214>>>>>        send display_main
32215>>>>>      end_procedure
32216>>>>>      procedure prev_year
32218>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32219>>>>>        send display_main
32220>>>>>      end_procedure
32221>>>>>      procedure next_month
32223>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32224>>>>>        send display_main
32225>>>>>      end_procedure
32226>>>>>      procedure prev_month
32228>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32229>>>>>        send display_main
32230>>>>>      end_procedure
32231>>>>>      procedure next_week
32233>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,1))
32234>>>>>        send display_main
32235>>>>>      end_procedure
32236>>>>>      procedure prev_week
32238>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,-1))
32239>>>>>        send display_main
32240>>>>>      end_procedure
32241>>>>>      procedure next_day
32243>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,1))
32244>>>>>        send display_main
32245>>>>>      end_procedure
32246>>>>>      procedure prev_day
32248>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,-1))
32249>>>>>        send display_main
32250>>>>>      end_procedure
32251>>>>>      procedure go_today
32253>>>>>        local date date#
32254>>>>>        sysdate4 date#
32255>>>>>        set p_current_date to date#
32256>>>>>        send display_main
32257>>>>>      end_procedure
32258>>>>>      property integer invoking_object_id public 0
32260>>>>>      procedure OnChange date date#
32262>>>>>        local integer focus# dm#
32263>>>>>        get invoking_object_id to focus#
32264>>>>>        if focus# gt desktop begin
32266>>>>>          get delegation_mode of focus# to dm#
32267>>>>>          set delegation_mode of focus# to no_delegate_or_error
32268>>>>>          send NotifyPopupCalendarChange to focus# date#
32269>>>>>          set delegation_mode of focus# to dm#
32270>>>>>        end
32270>>>>>>
32270>>>>>      end_procedure
32271>>>>>      procedure display
32273>>>>>        local integer date# month# year#
32274>>>>>        get p_current_date to date#
32275>>>>>        send OnChange date#
32276>>>>>        move (DateSegment(date#,DS_YEAR)) to year#
32277>>>>>        move (DateSegment(date#,DS_MONTH)) to month#
32278>>>>>        if (p_current_year(current_object)<>year# or p_current_month(current_object)<>month#) begin
32280>>>>>          set p_current_year to year#
32281>>>>>          set p_current_month to month#
32282>>>>>          set value to (t.calendar.calendar_popup+", "+MonthName(month#))
32283>>>>>          send display to (textbox_year(cont3d(current_object)))
32284>>>>>          send display to (weeknumber_header(cont3d(current_object)))
32285>>>>>          send display to (days_grid(cont3d(current_object))) 0
32286>>>>>        end
32286>>>>>>
32286>>>>>      end_procedure
32287>>>>>      procedure display_main
32289>>>>>        send display
32290>>>>>        send display to (days_grid(cont3d(current_object))) 1
32291>>>>>      end_procedure
32292>>>>>      procedure popup_no_export
32294>>>>>        set pExportState to false
32295>>>>>        send popup
32296>>>>>        set pExportState to true
32297>>>>>      end_procedure
32298>>>>>
32298>>>>>      procedure popup_group
32300>>>>>        local integer focus#
32301>>>>>        local date date#
32301>>>>>        move (focus(desktop)) to focus#
32302>>>>>        set invoking_object_id to focus#
32303>>>>>        get value of focus# item current to date#
32304>>>>>        ifnot (integer(date#)) move (dSysdate()) to date#
32307>>>>>        move (Date2to4(date#)) to date#
32308>>>>>        set p_current_date to date#
32309>>>>>        send display
32310>>>>>        forward send popup_group
32312>>>>>        send display to (days_grid(cont3d(current_object))) 1
32313>>>>>      end_procedure
32314>>>>>
32314>>>>>      procedure move_value_out
32316>>>>>        local integer focus# dm# margin# datatype#
32317>>>>>        if (pExportState(current_object)) begin
32319>>>>>          get invoking_object_id to focus#
32320>>>>>          if focus# gt desktop begin
32322>>>>>            get delegation_mode of focus# to dm#
32323>>>>>            set delegation_mode of focus# to no_delegate_or_error
32324>>>>>            send NotifyPopupCalendarSelect to focus# (p_current_date(current_object))
32325>>>>>            get form_margin of focus# item current to margin#
32326>>>>>            get form_datatype of focus# item current to datatype#
32327>>>>>            set delegation_mode of focus# to dm#
32328>>>>>            if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to (p_current_date(current_object))
32331>>>>>            else             set value of focus# item current to (Date4to2(p_current_date(current_object)))
32333>>>>>            set item_changed_state of focus# item current to true
32334>>>>>          end
32334>>>>>>
32334>>>>>        end
32334>>>>>>
32334>>>>>      end_procedure
32335>>>>>
32335>>>>>      procedure move_value_out_ok
32337>>>>>        send move_value_out
32338>>>>>        send deactivate
32339>>>>>      end_procedure
32340>>>>>
32340>>>>>      procedure request_popup
32342>>>>>        local integer focus# type# dm#
32343>>>>>        move (focus(desktop)) to focus#
32344>>>>>        if focus# gt desktop begin
32346>>>>>          get delegation_mode of focus# to dm#
32347>>>>>          set delegation_mode of focus# to no_delegate_or_error
32348>>>>>          get form_datatype of focus# item current to type#
32349>>>>>          if (type#=date_window or type#=mask_date_window) send popup
32352>>>>>          set delegation_mode of focus# to dm#
32353>>>>>        end
32353>>>>>>
32353>>>>>      end_procedure
32354>>>>>    end_object
32355>>>>>  end_desktop_section
32357>>>>>  // If the procedure below was not defined "for BaseClass" its symbolic
32357>>>>>  // substitute would become negative (because located on the desktop). This
32357>>>>>  // would result in the toolbar object not being able to handle it. Therefore:
32357>>>>>  procedure request_popup_calendar for BaseClass
32358>>>>>    send request_popup to (popup_calendar(current_object))
32359>>>>>  end_procedure
32360>>>>>  procedure popup_calendar_no_export
32361>>>>>    send popup_no_export to (popup_calendar(current_object))
32362>>>>>  end_procedure
32363>>>>>  register_procedure Add_Toolbar_Button_Bitmap string bmp# string Tip# string StHlp# integer msg# integer obj#
32363>>>>>  procedure Add_Calendar_tbButton integer oTb#
32364>>>>>    send Add_Toolbar_Button_Bitmap to oTb# "DfCalend.bmp" t.calendar.calendar_popup t.calendar.Activate msg_request_popup_calendar
32365>>>>>  end_procedure
32366>>>>> function s.calendar returns integer // Backwards compatible!!
32367>>>>>   function_return (popup_calendar(current_object))
32368>>>>> end_function
32369>>>>>
32369>>>>>// Karl,
32369>>>>>// Structure is as follows,
32369>>>>>//
32369>>>>>// //put this code in the top portion of the view code or in the program
32369>>>>>// code.
32369>>>>>//
32369>>>>>// Type SystemTime
32369>>>>>//   field SystemTime.iYear As Word
32369>>>>>//   field SystemTime.iMonth As Word
32369>>>>>//   field SystemTime.iDayOfWeek As Word
32369>>>>>//   field SystemTime.iDay As Word
32369>>>>>//   field SystemTime.iHour As Word
32369>>>>>//   field SystemTime.iMinute As Word
32369>>>>>//   field SystemTime.iSecond As Word
32369>>>>>//   field SystemTime.iMilliseconds As Word
32369>>>>>// End_Type
32369>>>>>//
32369>>>>>// external_function GetSystemTime "GetSystemTime" kernel32.dll Pointer lpGST Returns VOID_TYPE
32369>>>>>//
32369>>>>>// //put this code in an onClick or wherever
32369>>>>>// procedure onclick
32369>>>>>//   local integer iRetVal
32369>>>>>//   local string TimeData
32369>>>>>//   local pointer GST
32369>>>>>//
32369>>>>>//   ZeroType SystemTime to TimeData
32369>>>>>//   getAddress from TimeData to GST
32369>>>>>//
32369>>>>>//   move (GetSystemTime(GST)) to iRetVal
32369>>>>>// end_procedure
32369>>>>>//
32369>>>>>// To extract the data from the Structure after calling the function use
32369>>>>>// the getbuff command as follows:
32369>>>>>//
32369>>>>>// getbuff from TimeData as SystemTime.IVAL to var
32369>>>>>//
32369>>>>>// where IVAL is one of the vars such as iYear or iDay, etc.
32369>>>>>//
32369>>>>>// OLIVER NELSON
32369>>>>>//
32369>>>>>//
32369>>>
32369>>>//AB-StoreTopEnd
32369>>>
32369>>>//AB-IgnoreStart
32369>>>
32369>>>Use DFAllEnt.pkg
32369>>>
32369>>>
32369>>>//AB-IgnoreEnd
32369>>>
32369>>>CD_Popup_Object oCalendar is a dbModalPanel
32388>>>
32388>>>    //AB-StoreTopStart
32388>>>    on_key kcancel           send cancel
32389>>>    //AB-StoreTopEnd
32389>>>
32389>>>    Set Border_Style to Border_Normal
32390>>>    Set Caption_Bar to FALSE
32391>>>    Set Label to "Ÿ­¢ àì, 2001"
32392>>>    Set Size to 98 123
32393>>>    Set Location to 10 22
32394>>>    Set Color to clWhite
32395>>>
32395>>>    //AB-DDOStart
32395>>>
32395>>>
32395>>>    //AB-DDOEnd
32395>>>
32395>>>    Object Container3d1 is a Container3d
32397>>>        Set Size to 88 135
32398>>>        Set Location to -2 -1
32399>>>        Set Color to clWhite
32400>>>        Set Border_Style to Border_None
32401>>>        Object Grid2 is a Grid
32403>>>
32403>>>            //AB-StoreTopStart
32403>>>            property date    p_current_date     public 0
32405>>>            property integer p_current_year     public -1
32407>>>            property integer p_current_month    public -1
32409>>>            property integer p_selected_day     public -1
32411>>>            property integer pExportState       public 1
32413>>>            property integer invoking_object_id public 0
32415>>>            
32415>>>            Set Border_Style To BORDER_NONE
32416>>>            Set header_visible_state To False
32417>>>            set select_mode to no_select
32418>>>            Set Gridline_mode To GRID_VISIBLE_NONE
32419>>>            
32419>>>            on_key Key_F1 Send Help
32420>>>            on_key key_ctrl+key_pgup send prev_year
32421>>>            on_key key_ctrl+key_pgdn send next_year
32422>>>            on_key          key_pgup send prev_month
32423>>>            on_key          key_pgdn send next_month
32424>>>            on_key key_enter         send move_value_out
32425>>>            on_key key_ctrl+key_d    send go_today
32426>>>            
32426>>>            //AB-StoreTopEnd
32426>>>
32426>>>            Set Color to clWhite
32427>>>            Set CurrentCellColor to clWhite
32428>>>            Set CurrentCellTextColor to clWhite
32429>>>            Set Size to 61 145
32430>>>            Set Location to 30 1
32431>>>            Set Resize_Column_state to FALSE
32432>>>
32432>>>            Set Line_Width to 7 0
32433>>>
32433>>>            Set Form_Width    item 0 to 18
32434>>>            Set Header_Label  item 0 to "­"
32435>>>            
32435>>>            Set Form_Width    item 1 to 18
32436>>>            Set Header_Label  item 1 to "‚â"
32437>>>            
32437>>>            Set Form_Width    item 2 to 18
32438>>>            Set Header_Label  item 2 to "‘à"
32439>>>            
32439>>>            Set Form_Width    item 3 to 18
32440>>>            Set Header_Label  item 3 to "—â"
32441>>>            
32441>>>            Set Form_Width    item 4 to 18
32442>>>            Set Header_Label  item 4 to "â"
32443>>>            
32443>>>            Set Form_Width    item 5 to 18
32444>>>            Set Header_Label  item 5 to "‘¡"
32445>>>            
32445>>>            Set Form_Width    item 6 to 18
32446>>>            Set Header_Label  item 6 to "‚á"
32447>>>            
32447>>>
32447>>>            //AB-StoreStart
32447>>>            
32447>>>            procedure go_today
32449>>>                Date date#
32450>>>                sysdate4 date#
32451>>>                set p_current_date to date#
32452>>>                Send Update_Calendar
32453>>>            end_procedure
32454>>>            
32454>>>            procedure next_month
32456>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32457>>>                Send Update_Calendar
32458>>>            end_procedure
32459>>>            
32459>>>            procedure prev_month
32461>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32462>>>                Send Update_Calendar
32463>>>            end_procedure
32464>>>            
32464>>>            procedure next_year
32466>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32467>>>                Send Update_Calendar
32468>>>            end_procedure
32469>>>            
32469>>>            procedure prev_year
32471>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32472>>>                Send Update_Calendar
32473>>>            end_procedure
32474>>>            
32474>>>            Procedure Activate
32476>>>                Date date#
32477>>>                Forward Send Activate
32479>>>                Set current_item to (p_selected_day(Self))
32480>>>            End_Procedure
32481>>>            
32481>>>            Procedure Update_Calendar
32483>>>                Set Dynamic_Update_State To False
32484>>>                send Fill_List
32485>>>                Set Dynamic_Update_State To True
32486>>>                // Send Update_Label
32486>>>                Set current_item to (p_selected_day(Self))
32487>>>                Send Date_Changing to (oYear(Container3d2(self)))
32488>>>                Send Date_Changing to (oMonth(Container3d2(self)))
32489>>>            End_Procedure
32490>>>            
32490>>>            Procedure Fill_List
32492>>>                Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
32493>>>                Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
32493>>>                Date dToday
32493>>>                Send Delete_Data
32494>>>            
32494>>>                Get p_current_date to date#
32495>>>            
32495>>>                SysDate4 dToday
32496>>>                move (DateSegment(dToday,DS_DAY)) to cur_day#
32497>>>                move (DateSegment(dToday,DS_MONTH)) to cur_month#
32498>>>                move (DateSegment(dToday,DS_YEAR)) to cur_year#
32499>>>            
32499>>>                move (DateSegment(date#,DS_DAY)) to sel_day#
32500>>>                move (DateSegment(date#,DS_MONTH)) to sel_month#
32501>>>                move (DateSegment(date#,DS_YEAR)) to sel_year#
32502>>>                Set p_current_month To sel_month#
32503>>>                Set p_current_year To sel_year#
32504>>>            
32504>>>                move (FirstDayInMonth(date#)) to date#
32505>>>                move (DateDayNumber(date#)-1) to first_item#
32506>>>                move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32507>>>                move (DateIncrement(date#,DS_Month,-1)) To prevdate#
32508>>>                move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
32509>>>            
32509>>>                If (first_item# > 0) Begin
32511>>>                    Move (first_item#-1) to day#
32512>>>                    For iFor from 0 to (first_item#-1)
32518>>>>
32518>>>                        Send Add_Item msg_move_value_out (prev_last#-day#)
32519>>>                        Set Entry_State Item iFor To False
32520>>>                        Set ItemTextColor Item iFor To clGray
32521>>>                        Decrement day#
32522>>>                    Loop
32523>>>>
32523>>>                End
32523>>>>
32523>>>            
32523>>>                Move 1 To day#
32524>>>                For iFor from first_item# to last_item#
32530>>>>
32530>>>                    Send Add_Item Msg_Move_Value_Out day#
32531>>>                    Set Entry_State Item iFor To False
32532>>>                    If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Set Form_Bitmap Item iFor To "cdate.bmp"
32535>>>                    If Day# eq sel_day# Set p_selected_day To iFor
32538>>>                    Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
32539>>>                    Set form_datatype item iFor To mask_numeric_window
32540>>>                    Set form_Mask item iFor To "## "
32541>>>                    Increment day#
32542>>>                Loop
32543>>>>
32543>>>            
32543>>>                move (DateIncrement(date#,DS_Month,1)) To nextdate#
32544>>>                move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
32545>>>            
32545>>>                If (last_item# < 41) Begin
32547>>>                    Move 1 to day#
32548>>>                    For iFor from (last_item#+1) to 41
32554>>>>
32554>>>                        Send Add_Item msg_move_value_out day#
32555>>>                        Set Entry_State Item iFor To False
32556>>>                        Set ItemTextColor Item iFor To clGray
32557>>>                        Increment day#
32558>>>                    Loop
32559>>>>
32559>>>                End
32559>>>>
32559>>>            
32559>>>            End_Procedure
32560>>>            
32560>>>            Procedure Help
32562>>>                Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<PgUp>, <PgDn> - Select year.\n\n(c) 2001, SCR. Special thanks to Sture Andersen.") ("Help on Calendar")
32563>>>            End_Procedure
32564>>>            
32564>>>            procedure mouse_click integer window integer char_pos
32566>>>                Send Move_Value_Out
32567>>>                forward send mouse_click window char_pos
32569>>>            end_procedure
32570>>>            
32570>>>            Procedure Move_Value_Out
32572>>>                Integer iYear iMonth iDay iItm
32573>>>                Date Date# next_date# prev_date#
32573>>>                Get Current_Item To iItm
32574>>>                If (pExportState(Self)) Begin
32576>>>                    Get Value Item iItm To iDay
32577>>>                    Get p_current_month to iMonth
32578>>>                    Get p_current_year  to iYear
32579>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32580>>>            
32580>>>                    If ((iItm>27)and(iDay<15)) Begin
32582>>>                        Move (DateCompose(1,iMonth,iYear)) To next_date#
32583>>>                        move (DateIncrement(next_date#,DS_Month,1)) To next_date#
32584>>>                        move (DateSegment(next_date#,DS_MONTH)) to iMonth
32585>>>                        move (DateSegment(next_date#,DS_YEAR)) to iYear
32586>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32587>>>                    End
32587>>>>
32587>>>                    If ((iItm<7)and(iDay>20)) Begin
32589>>>                        Move (DateCompose(1,iMonth,iYear)) To prev_date#
32590>>>                        move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
32591>>>                        move (DateSegment(prev_date#,DS_MONTH)) to iMonth
32592>>>                        move (DateSegment(prev_date#,DS_YEAR)) to iYear
32593>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32594>>>                    End
32594>>>>
32594>>>            
32594>>>                    Send Export_Date date#
32595>>>                End
32595>>>>
32595>>>            End_Procedure
32596>>>            
32596>>>            Procedure Export_Date date date#
32598>>>                local integer focus# dm# margin# datatype#
32599>>>                get invoking_object_id to focus#
32600>>>            
32600>>>                if focus# gt desktop begin
32602>>>                     get delegation_mode of focus# to dm#
32603>>>                     set delegation_mode of focus# to no_delegate_or_error
32604>>>                     get form_margin of focus# item current to margin#
32605>>>                     get form_datatype of focus# item current to datatype#
32606>>>                     set delegation_mode of focus# to dm#
32607>>>                     if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
32610>>>                     else             set value of focus# item current to (Date4to2(date#))
32612>>>                     set item_changed_state of focus# item current to true
32613>>>                end
32613>>>>
32613>>>                Send Close_Calendar
32614>>>            End_Procedure
32615>>>            //AB-StoreEnd
32615>>>
32615>>>        End_Object    // Grid2
32616>>>
32616>>>        Object Textbox2 is a Textbox
32618>>>            Set Label to "­"
32619>>>            Set Auto_Size_State to FALSE
32620>>>            Set Transparent_State to TRUE
32621>>>            Set Color to clWhite
32622>>>            Set TextColor to clNavy
32623>>>            Set Location to 19 4
32624>>>            Set Size to 10 15
32625>>>
32625>>>            //AB-StoreStart
32625>>>                                        
32625>>>            Set Label To (left(t.calendar.Monday,2))
32626>>>            //AB-StoreEnd
32626>>>
32626>>>        End_Object    // Textbox2
32627>>>
32627>>>        Object Textbox3 is a Textbox
32629>>>            Set Label to "‚â"
32630>>>            Set Auto_Size_State to FALSE
32631>>>            Set Transparent_State to TRUE
32632>>>            Set Color to clWhite
32633>>>            Set TextColor to clNavy
32634>>>            Set Location to 19 22
32635>>>            Set Size to 10 12
32636>>>
32636>>>            //AB-StoreStart
32636>>>                                        
32636>>>            Set Label To (left(t.calendar.Tuesday,2))
32637>>>            //AB-StoreEnd
32637>>>
32637>>>        End_Object    // Textbox3
32638>>>
32638>>>        Object Textbox4 is a Textbox
32640>>>            Set Label to "‘à"
32641>>>            Set Auto_Size_State to FALSE
32642>>>            Set Transparent_State to TRUE
32643>>>            Set Color to clWhite
32644>>>            Set TextColor to clNavy
32645>>>            Set Location to 19 39
32646>>>            Set Size to 10 15
32647>>>
32647>>>            //AB-StoreStart
32647>>>                                        
32647>>>            Set Label To (left(t.calendar.Wednesday,2))
32648>>>            //AB-StoreEnd
32648>>>
32648>>>        End_Object    // Textbox4
32649>>>
32649>>>        Object Textbox5 is a Textbox
32651>>>            Set Label to "—â"
32652>>>            Set Auto_Size_State to FALSE
32653>>>            Set Transparent_State to TRUE
32654>>>            Set Color to clWhite
32655>>>            Set TextColor to clNavy
32656>>>            Set Location to 19 57
32657>>>            Set Size to 10 17
32658>>>
32658>>>            //AB-StoreStart
32658>>>                                        
32658>>>            Set Label To (left(t.calendar.Thursday,2))
32659>>>            //AB-StoreEnd
32659>>>
32659>>>        End_Object    // Textbox5
32660>>>
32660>>>        Object Textbox6 is a Textbox
32662>>>            Set Label to "â"
32663>>>            Set Auto_Size_State to FALSE
32664>>>            Set Transparent_State to TRUE
32665>>>            Set Color to clWhite
32666>>>            Set TextColor to clNavy
32667>>>            Set Location to 19 76
32668>>>            Set Size to 10 17
32669>>>
32669>>>            //AB-StoreStart
32669>>>                                        
32669>>>            Set Label To (left(t.calendar.Friday,2))
32670>>>            //AB-StoreEnd
32670>>>
32670>>>        End_Object    // Textbox6
32671>>>
32671>>>        Object Textbox7 is a Textbox
32673>>>            Set Label to "‘¡"
32674>>>            Set Auto_Size_State to FALSE
32675>>>            Set Transparent_State to TRUE
32676>>>            Set Color to clWhite
32677>>>            Set TextColor to clNavy
32678>>>            Set Location to 19 91
32679>>>            Set Size to 10 18
32680>>>
32680>>>            //AB-StoreStart
32680>>>                                        
32680>>>            Set Label To (left(t.calendar.Saturday,2))
32681>>>            //AB-StoreEnd
32681>>>
32681>>>        End_Object    // Textbox7
32682>>>
32682>>>        Object Textbox8 is a Textbox
32684>>>            Set Label to "‚á"
32685>>>            Set Auto_Size_State to FALSE
32686>>>            Set Transparent_State to TRUE
32687>>>            Set Color to clWhite
32688>>>            Set TextColor to clNavy
32689>>>            Set Location to 19 109
32690>>>            Set Size to 10 17
32691>>>
32691>>>            //AB-StoreStart
32691>>>                                        
32691>>>            Set Label To (left(t.calendar.Sunday,2))
32692>>>            //AB-StoreEnd
32692>>>
32692>>>        End_Object    // Textbox8
32693>>>
32693>>>        Object LineControl1 is a LineControl
32695>>>            Set Line_Style to lnSINGLE
32696>>>            Set Size to 1 116
32697>>>            Set Location to 28 4
32698>>>
32698>>>            //AB-StoreStart
32698>>>                                        
32698>>>            //AB-StoreEnd
32698>>>
32698>>>        End_Object    // LineControl1
32699>>>
32699>>>        Object Container3d2 is a Container3d
32701>>>            Set Size to 18 131
32702>>>            Set Location to 1 1
32703>>>            Set Color to clNavy
32704>>>            Set Border_Style to Border_None
32705>>>            Object oRght is a BitmapContainer
32707>>>                Set Size to 10 14
32708>>>                Set Location to 4 105
32709>>>                Set Bitmap to "rght.bmp"
32710>>>                Set Border_Style to Border_None
32711>>>
32711>>>                //AB-StoreStart
32711>>>                Procedure Mouse_Down
32713>>>                    Send Next_Month to Grid2
32714>>>                End_Procedure
32715>>>                //AB-StoreEnd
32715>>>
32715>>>            End_Object    // oRght
32716>>>
32716>>>            Object oLeft is a BitmapContainer
32718>>>                Set Size to 10 14
32719>>>                Set Location to 4 3
32720>>>                Set Bitmap to "lft.bmp"
32721>>>                Set Border_Style to Border_None
32722>>>
32722>>>                //AB-StoreStart
32722>>>                Procedure Mouse_Down
32724>>>                    Send Prev_Month to Grid2
32725>>>                End_Procedure
32726>>>                //AB-StoreEnd
32726>>>
32726>>>            End_Object    // oLeft
32727>>>
32727>>>            Object oMonth is a Textbox
32729>>>
32729>>>                //AB-StoreTopStart
32729>>>                Property integer piSelected_Month public 0
32731>>>                //AB-StoreTopEnd
32731>>>
32731>>>                Set Label to "January"
32732>>>                Set Auto_Size_State to FALSE
32733>>>                Set Transparent_State to TRUE
32734>>>                Set Color to clWhite
32735>>>                Set TextColor to clWhite
32736>>>                Set Location to 4 23
32737>>>                Set Size to 10 43
32738>>>                Set FontWeight to 800
32739>>>                Set Justification_Mode to jMode_Center
32740>>>
32740>>>                //AB-StoreStart
32740>>>                                    
32740>>>                Procedure Mouse_Down
32742>>>                    Integer iState
32743>>>                    Get Visible_State of oSelectYear to iState
32744>>>                    If (iState) Send OnKillFocus to oSelectYear
32747>>>                    Send Popup to oSelectMonth
32748>>>                End_Procedure
32749>>>                
32749>>>                Procedure pSelectJan
32751>>>                    Set Label to t.calendar.january
32752>>>                    Set piSelected_Month to 1
32753>>>                    Send Adjust_Calendar
32754>>>                End_Procedure
32755>>>                Procedure pSelectFeb
32757>>>                    Set Label to t.calendar.february
32758>>>                    Set piSelected_Month to 2
32759>>>                    Send Adjust_Calendar
32760>>>                End_Procedure
32761>>>                Procedure pSelectMar
32763>>>                    Set Label to t.calendar.march
32764>>>                    Set piSelected_Month to 3
32765>>>                    Send Adjust_Calendar
32766>>>                End_Procedure
32767>>>                Procedure pSelectApr
32769>>>                    Set Label to t.calendar.april
32770>>>                    Set piSelected_Month to 4
32771>>>                    Send Adjust_Calendar
32772>>>                End_Procedure
32773>>>                Procedure pSelectMay
32775>>>                    Set Label to t.calendar.may
32776>>>                    Set piSelected_Month to 5
32777>>>                    Send Adjust_Calendar
32778>>>                End_Procedure
32779>>>                Procedure pSelectJun
32781>>>                    Set Label to t.calendar.june
32782>>>                    Set piSelected_Month to 6
32783>>>                    Send Adjust_Calendar
32784>>>                End_Procedure
32785>>>                Procedure pSelectJul
32787>>>                    Set Label to t.calendar.july
32788>>>                    Set piSelected_Month to 7
32789>>>                    Send Adjust_Calendar
32790>>>                End_Procedure
32791>>>                Procedure pSelectAug
32793>>>                    Set Label to t.calendar.august
32794>>>                    Set piSelected_Month to 8
32795>>>                    Send Adjust_Calendar
32796>>>                End_Procedure
32797>>>                Procedure pSelectSep
32799>>>                    Set Label to t.calendar.september
32800>>>                    Set piSelected_Month to 9
32801>>>                    Send Adjust_Calendar
32802>>>                End_Procedure
32803>>>                Procedure pSelectOct
32805>>>                    Set Label to t.calendar.october
32806>>>                    Set piSelected_Month to 10
32807>>>                    Send Adjust_Calendar
32808>>>                End_Procedure
32809>>>                Procedure pSelectNov
32811>>>                    Set Label to t.calendar.november
32812>>>                    Set piSelected_Month to 11
32813>>>                    Send Adjust_Calendar
32814>>>                End_Procedure
32815>>>                Procedure pSelectDec
32817>>>                    Set Label to t.calendar.december
32818>>>                    Set piSelected_Month to 12
32819>>>                    Send Adjust_Calendar
32820>>>                End_Procedure
32821>>>                
32821>>>                Object oSelectMonth is a FloatingPopupMenu
32823>>>                    Send Add_Item msg_pSelectJan t.calendar.january
32824>>>                    Send Add_Item msg_pSelectFeb t.calendar.february
32825>>>                    Send Add_Item msg_pSelectMar t.calendar.march
32826>>>                    Send Add_Item msg_pSelectApr t.calendar.april
32827>>>                    Send Add_Item msg_pSelectMay t.calendar.may
32828>>>                    Send Add_Item msg_pSelectJun t.calendar.june
32829>>>                    Send Add_Item msg_pSelectJul t.calendar.july
32830>>>                    Send Add_Item msg_pSelectAug t.calendar.august
32831>>>                    Send Add_Item msg_pSelectSep t.calendar.september
32832>>>                    Send Add_Item msg_pSelectOct t.calendar.october
32833>>>                    Send Add_Item msg_pSelectNov t.calendar.november
32834>>>                    Send Add_Item msg_pSelectDec t.calendar.december
32835>>>                End_Object
32836>>>                
32836>>>                Procedure Adjust_Calendar
32838>>>                    Date date#
32839>>>                    Integer iDay iMonth iYear iItm
32839>>>                    Set Visible_State to false
32840>>>                    Set Visible_State to true
32841>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32842>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32843>>>                    Get piSelected_Month to iMonth
32844>>>                    Get Label of oYear to iYear
32845>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32846>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32847>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32848>>>                End_Procedure
32849>>>                
32849>>>                Procedure Activating
32851>>>                    Forward Send Activating
32853>>>                    Send Date_Changing
32854>>>                End_Procedure
32855>>>                
32855>>>                Procedure Date_Changing
32857>>>                    Set Visible_State to false
32858>>>                    Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
32859>>>                    Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
32860>>>                    Set Visible_State to true
32861>>>                End_Procedure
32862>>>                
32862>>>                
32862>>>                //AB-StoreEnd
32862>>>
32862>>>            End_Object    // oMonth
32863>>>
32863>>>            Object oYear is a Textbox
32865>>>                Set Label to "2001"
32866>>>                Set Transparent_State to TRUE
32867>>>                Set Color to clWhite
32868>>>                Set TextColor to clWhite
32869>>>                Set Location to 4 77
32870>>>                Set Size to 10 18
32871>>>                Set FontWeight to 800
32872>>>
32872>>>                //AB-StoreStart
32872>>>                                                    
32872>>>                Procedure Mouse_Down
32874>>>                    String sVal
32875>>>                    Get Label to sVal
32876>>>                    Set Value of oSelectYear item 0 to sVal
32877>>>                    Set Visible_State of oSelectYear to True
32878>>>                    Send Activate to (oSelectYear(Self))
32879>>>                End_Procedure
32880>>>                
32880>>>                Procedure Activating
32882>>>                    Forward Send Activating
32884>>>                    Send Date_Changing
32885>>>                End_Procedure
32886>>>                
32886>>>                Procedure Date_Changing
32888>>>                    Set Visible_State to false
32889>>>                    Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
32890>>>                    Set Visible_State to true
32891>>>                End_Procedure
32892>>>                //AB-StoreEnd
32892>>>
32892>>>            End_Object    // oYear
32893>>>
32893>>>            Object oSelectYear is a Form
32895>>>
32895>>>                //AB-StoreTopStart
32895>>>                Set Visible_State To False
32896>>>                //AB-StoreTopEnd
32896>>>
32896>>>                Set Size to 10 24
32897>>>                Set Location to 4 75
32898>>>                Set Color to clWhite
32899>>>                Set TextColor to clNavy
32900>>>                Set Form_Border Item 0 to Border_Normal
32901>>>
32901>>>                //AB-StoreStart
32901>>>                                                    
32901>>>                On_Key Key_Enter Send OnKillFocus
32902>>>                On_Key Key_Escape Send OnKillFocus
32903>>>                
32903>>>                Procedure SetFontWeight
32905>>>                    Set Form_FontWeight item 0 to 800
32906>>>                End_Procedure
32907>>>                
32907>>>                Procedure OnKillFocus
32909>>>                    String sVal
32910>>>                    Integer iMonth iDay iYear iItm
32910>>>                    Date date#
32910>>>                    Get Value item 0 to sVal
32911>>>                    Set Visible_State of oYear to false
32912>>>                    Set Label of oYear to sVal
32913>>>                    Set Visible_State of oYear to true
32914>>>                    Set Visible_State to false
32915>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32916>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32917>>>                    Get piSelected_Month of oMonth to iMonth
32918>>>                    Get Value item 0 to iYear
32919>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32920>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32921>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32922>>>                End_Procedure
32923>>>                
32923>>>                Send SetFontWeight
32924>>>                //AB-StoreEnd
32924>>>
32924>>>            End_Object    // oSelectYear
32925>>>
32925>>>
32925>>>            //AB-StoreStart
32925>>>                            
32925>>>            Procedure Mouse_Down
32927>>>                Integer iState
32928>>>                Get Visible_State of oSelectYear to iState
32929>>>                If (iState) Send OnKillFocus to oSelectYear
32932>>>            End_Procedure
32933>>>            
32933>>>            //AB-StoreEnd
32933>>>
32933>>>        End_Object    // Container3d2
32934>>>
32934>>>
32934>>>        //AB-StoreStart
32934>>>                            
32934>>>        //AB-StoreEnd
32934>>>
32934>>>    End_Object    // Container3d1
32935>>>
32935>>>    Object BitmapContainer3 is a BitmapContainer
32937>>>        Set Size to 9 19
32938>>>        Set Location to 88 3
32939>>>        Set Color to clWhite
32940>>>        Set Bitmap to "cdate.bmp"
32941>>>        Set Border_Style to Border_None
32942>>>
32942>>>        //AB-StoreStart
32942>>>        Procedure Mouse_Down
32944>>>            Send go_today to (Grid2(Container3d1(Self)))
32945>>>            Send Adjust_Label to oToday
32946>>>        End_Procedure
32947>>>        //AB-StoreEnd
32947>>>
32947>>>    End_Object    // BitmapContainer3
32948>>>
32948>>>    Object oToday is a Textbox
32950>>>        Set Label to "Today: 01.01.2001"
32951>>>        Set Auto_Size_State to FALSE
32952>>>        Set Color to clWhite
32953>>>        Set Location to 88 22
32954>>>        Set Size to 8 73
32955>>>        Set FontWeight to 800
32956>>>
32956>>>        //AB-StoreStart
32956>>>        Procedure Mouse_Down
32958>>>            Send go_today to (Grid2(Container3d1(Self)))
32959>>>            Send Adjust_Label
32960>>>        End_Procedure
32961>>>        
32961>>>        Procedure Adjust_Label
32963>>>            date date#
32964>>>            SysDate4 date#
32965>>>            Set Visible_State To false
32966>>>            Set Label         to (t.calendar.today+": "+String(date#))
32967>>>            Set Visible_State To true
32968>>>        End_Procedure
32969>>>        
32969>>>        Procedure Activating
32971>>>            Forward Send Activating
32973>>>            Send Adjust_Label
32974>>>        End_Procedure
32975>>>        //AB-StoreEnd
32975>>>
32975>>>    End_Object    // oToday
32976>>>
32976>>>
32976>>>    //AB-StoreStart
32976>>>                
32976>>>    procedure popup
32978>>>        local integer focus# icItm iYear iMonth
32979>>>        local date date#
32979>>>        move (focus(desktop)) to focus#
32980>>>        set invoking_object_id of (Grid2(Container3d1(self))) to focus#
32981>>>        get value of focus# item current to date#
32982>>>        ifnot (integer(date#)) sysdate date#
32985>>>        move (Date2to4(date#)) to date#
32986>>>        set p_current_date of (Grid2(Container3d1(self))) to date#
32987>>>        send fill_list to (Grid2(Container3d1(self)))
32988>>>        move (DateSegment(date#,DS_YEAR)) to iYear
32989>>>        move (DateSegment(date#,DS_MONTH)) to iMonth
32990>>>        Set Label To (MonthName(iMonth)+', '+String(iYear))
32991>>>        forward send popup
32993>>>    end_procedure
32994>>>    
32994>>>    Procedure Close_Calendar
32996>>>        Send Exit
32997>>>    End_Procedure
32998>>>    //AB-StoreEnd
32998>>>
32998>>>CD_End_Object    // oCalendar
33000>>>>
33000>>>
33000>>>
33000>>>//AB-StoreStart
33000>>>    
33000>>>    
33000>>>//AB-StoreEnd
33000>>>
33000>>>//AB/ End_Object    // prj
33000>Use Dates.Utl
33000>use roundfn.fnc
INCLUDING FILE: ROUNDFN.FNC
33000>>>// ===========================================================================
33000>>>//
33000>>>// The ROUND_NUMBER global function has been designed to return the rounded
33000>>>// value of a given 'numeric' argument at a specified rounding precision.
33000>>>//
33000>>>// ---------------------------------------------------------------------------
33000>>>// This version dispenses with the use of powers (10 ^ n) to perform the
33000>>>// necessary calculations.  It uses a string handling technique instead.
33000>>>// ---------------------------------------------------------------------------
33000>>>//
33000>>>// The function requires two arguments, as follows:-
33000>>>//
33000>>>// (a) The numeric value to be rounded, where the range of valid values is
33000>>>//     +/- 99,999,999,999,999.99999999.
33000>>>//
33000>>>// (b) The rounding precision required.  This must be an integer value in the
33000>>>//     range -13 to +8.  If a value outside this range is used, the nearest
33000>>>//     threshold value is substituted.
33000>>>//
33000>>>//     Values in the range +1 to +7 perform rounding on the decimal part of
33000>>>//     the number.  A value of +8 will perform no rounding at all.  A zero
33000>>>//     value will round to the nearest whole number.  Values -1 to -13 will
33000>>>//     round progressively to the left of the decimal point (a frequent
33000>>>//     requirement in financial reporting).
33000>>>//
33000>>>// If the result of the rounding produces a value outside the valid numeric
33000>>>// range (+/- 99,999,999,999,999.99999999) then a zero value is returned.
33000>>>//
33000>>>// Assumptions:-  The only assumptions made have been that the range of
33000>>>// numeric values and the limit of eight decimal places are unlikely to change
33000>>>// in the forseeable future.
33000>>>//
33000>>>// Examples:-
33000>>>//
33000>>>//  1st Argument      2nd Argument   Return Value
33000>>>//  ------------      ------------   ------------
33000>>>//  123456.87654321         8         123456.87654321
33000>>>//  123456.87654321         2         123456.88
33000>>>// -123456.87654321         2        -123456.88
33000>>>//  123456.98765432         0         123457
33000>>>// -123456.98765432        -1        -123460
33000>>>//  123456.98765432        -2         123500
33000>>>//  123456.98765432        -3         123000
33000>>>//  987654                 -4         990000
33000>>>//  987654                 -5        1000000
33000>>>//  987654                 -6        1000000
33000>>>//  987654                 -7              0
33000>>>//
33000>>>// ===========================================================================
33000>>>
33000>>>
33000>>>Function Round_Number GLOBAL number nVal integer iRnd returns Number
33001>>>
33001>>>  Local Number nAdj
33002>>>
33002>>>  Move 10000000000000 to nAdj
33003>>>
33003>>>  // If the rounding precision falls in the range 0 to 8, then return:-
33003>>>
33003>>>  If (iRnd >= 0) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 / (Number(Left(nAdj, ((iRnd + 1) ;      min 9)))) + nVal / (Number(Left(nAdj, (9 - (iRnd min 8))))) ;        * (Number(Left(nAdj, (9 - (iRnd min 8))))))
33006>>>
33006>>>  // Else, where the rounding precision is in the range -1 to -5, return:-
33006>>>
33006>>>  If (iRnd >= -5) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(Left(nAdj, (Abs(iRnd) + 9)))) ;        * (Number(Left(nAdj, (Abs(iRnd) + 9)))))
33009>>>
33009>>>  // Else, where the rounding precision is in the range -6 to -13, return:-
33009>>>
33009>>>  Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(nAdj)) / (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))) ;        * (Number(nAdj)) * (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))))
33010>>>
33010>>>End_Function
33011>use checkafm.pkg
INCLUDING FILE: CHECKAFM.PKG
33011>>>
33011>>>
33011>>>Function Check_Afm Global String Afm_Num Returns Integer
33012>>>    Integer iii Num1 Num2
33013>>>
33013>>>    Move (Trim(Afm_Num)) To Afm_Num
33014>>>
33014>>>    For iii From 1 To (Length(Trim(Afm_Num)))
33020>>>>
33020>>>        If Not (Mid(Afm_Num,1,iii)) In  "0123456789" Function_Return 3
33023>>>    Loop
33024>>>>
33024>>>
33024>>>    Move (Right(Afm_Num,1)) to Num2
33025>>>
33025>>>    If (Length(Afm_Num)<>9) Function_Return 2
33028>>>
33028>>>    Move 0 to Num1
33029>>>
33029>>>    For iii From 1 to 8
33035>>>>
33035>>>        Add ((Mid(Afm_Num,1,iii)) * (2 ^ (9 - iii))) to Num1
33036>>>    Loop
33037>>>>
33037>>>
33037>>>    Move (Mod(Num1,11)) to Num1
33038>>>    If (Num1=10) Move 0 to Num1
33041>>>
33041>>>    If (Num1=Num2)  Function_Return 0
33044>>>    Else            Function_Return 1
33046>>>End_Function
33047>>>
33047>use checklog.pkg
INCLUDING FILE: CHECKLOG.PKG
33047>>>open syscurgl
INCLUDING FILE: SYSCURGL.FD
33049>>>open syscurxr
33051>>>open gplan
INCLUDING FILE: GPLAN.FD
33053>>>//open gplanl
33053>>>open iteml
INCLUDING FILE: ITEML.FD
33055>>>open cn
INCLUDING FILE: CN.FD
33057>>>open payresp
INCLUDING FILE: PAYRESP.FD
33059>>>open salesmen
INCLUDING FILE: SALESMEN.FD
33061>>>open mhxanik
INCLUDING FILE: MHXANIK.FD
33063>>>open constrct
INCLUDING FILE: CONSTRCT.FD
33065>>>open clients
INCLUDING FILE: CLIENTS.FD
33067>>>open wtypkin
INCLUDING FILE: WTYPKIN.FD
33069>>>open wax
INCLUDING FILE: WAX.FD
33071>>>Function Check_log Global String slog Returns Integer
33072>>>    clear gplan
33073>>>    move syscurxr.company_code to gplan.company_code
33074>>>    move syscurxr.branch_code  to gplan.branch_code
33075>>>    move syscurxr.year_year    to gplan.year_year
33076>>>    move slog                  to gplan.gplan_code
33077>>>    find eq gplan by index.1
33078>>>>
33078>>>    if (found=1) function_return 0
33081>>>    else         function_return 1
33083>>>
33083>>>End_Function
33084>>>
33084>>>Function Check_last Global String slog Returns Integer
33085>>>    clear gplan
33086>>>    move syscurxr.company_code to gplan.company_code
33087>>>    move syscurxr.branch_code  to gplan.branch_code
33088>>>    move syscurxr.year_year    to gplan.year_year
33089>>>    move slog                  to gplan.gplan_code
33090>>>    find eq gplan by index.1
33091>>>>
33091>>>    if ((found=1) and (Gplan.Gplan_Yn_Last = 1)) Function_Return 0
33094>>>    else                                         Function_return 1
33096>>>
33096>>>End_Function
33097>>>
33097>>>Function fsgplandescr String slog Returns string
33098>>>    clear gplan
33099>>>    move syscurgl.company_code to gplan.company_code
33100>>>    move syscurgl.branch_code  to gplan.branch_code
33101>>>    move syscurgl.year_year    to gplan.year_year
33102>>>    move slog                  to gplan.gplan_code
33103>>>    find eq gplan by index.1
33104>>>>
33104>>>    if (found=1) function_return gplan.gplan_descr1
33107>>>    else         function_return ''
33109>>>
33109>>>End_Function
33110>>>
33110>>>//Function fsgplanperi String slog Returns string
33110>>>//    string sdescr
33110>>>//    clear gplanl
33110>>>//    move syscurgl.company_code to  gplanl.company_code
33110>>>//    move syscurgl.branch_code  to  gplanl.branch_code
33110>>>//    move slog                  to  gplanl.gplan_code
33110>>>//    find eq gplanl by index.1
33110>>>//    if (found=1) begin
33110>>>//        move gplanl.gplan_descr1 to sdescr
33110>>>//        function_return sdescr
33110>>>//    end
33110>>>//    else         function_return ''
33110>>>//End_Function
33110>>>
33110>>>
33110>>>
33110>>>Function fsclient string code Returns string
33111>>>    string name
33112>>>    clear clients
33113>>>    move code to clients.client_id
33114>>>    find eq clients by index.6
33115>>>>
33115>>>    if (found) move clients.client_name to name
33118>>>    else       move '' to name
33120>>>    function_return name
33121>>>end_Function
33122>>>
33122>>>Function fspayresp string code Returns string
33123>>>    string name
33124>>>    clear payresp
33125>>>    move code to payresp.presp_id
33126>>>    find eq payresp by index.7
33127>>>>
33127>>>    if (found) move payresp.presp_name to name
33130>>>    else       move '' to name
33132>>>    function_return name
33133>>>end_Function
33134>>>
33134>>>Function fssalesmen string code Returns string
33135>>>    string name
33136>>>    clear salesmen
33137>>>    move code to salesmen.sls_id
33138>>>    find eq salesmen by index.4
33139>>>>
33139>>>    if (found) move salesmen.sls_name to name
33142>>>    else       move '' to name
33144>>>    function_return name
33145>>>end_Function
33146>>>
33146>>>Function fsconstrct string code Returns string
33147>>>    string name
33148>>>    clear constrct
33149>>>    move code to constrct.cnt_id
33150>>>    find eq constrct by index.5
33151>>>>
33151>>>    if (found) move constrct.cnt_name to name
33154>>>    else       move '' to name
33156>>>    function_return name
33157>>>end_Function
33158>>>
33158>>>Function fsmhxanik string code Returns string
33159>>>    string name
33160>>>    clear mhxanik
33161>>>    move code to mhxanik.mhx_id
33162>>>    find eq mhxanik by index.4
33163>>>>
33163>>>    if (found) move mhxanik.mhx_name to name
33166>>>    else       move '' to name
33168>>>    function_return name
33169>>>end_Function
33170>>>
33170>>>
33170>>>Function fsptyppar string code Returns string
33171>>>    string sdescr
33172>>>    clear ptypparl
INCLUDING FILE: PTYPPARL.FD
33173>>>    move syscurxr.company_code to ptypparl.company_code
33174>>>    move syscurxr.branch_code  to ptypparl.branch_code
33175>>> //   move syscurxr.year_year    to ptypparl.year_year
33175>>>    move code                  to ptypparl.ptyppar_code
33176>>>    find eq ptypparl by index.1
33177>>>>
33177>>>    move ptypparl.ptyppar_descr to sdescr
33178>>>    function_return sdescr
33179>>>end_Function
33180>>>
33180>>>Function fsgplan string code Returns string
33181>>>    string sdescr
33182>>>    clear gplan
33183>>>    move syscurxr.company_code to gplan.company_code
33184>>>    move syscurxr.branch_code  to gplan.branch_code
33185>>>    move syscurxr.year_year    to gplan.year_year
33186>>>    move code                  to gplan.gplan_code
33187>>>    find eq gplan by index.1
33188>>>>
33188>>>    move gplan.gplan_descr1    to sdescr
33189>>>    function_return sdescr
33190>>>end_Function
33191>>>
33191>>>Function fsitem string scode Returns string
33192>>>    clear iteml
33193>>>    move scode to iteml.item_code
33194>>>    find eq iteml by index.5
33195>>>>
33195>>>    function_return iteml.item_descr
33196>>>end_Function
33197>>>
33197>>>Function fswax string srecr Returns string
33198>>>    clear wax
33199>>>    move srecr to wax.wax_recr
33200>>>    find eq wax by index.2
33201>>>>
33201>>>    function_return wax.wax_descr
33202>>>end_Function
33203>>>
33203>>>
33203>>>Function fswitemx string code Returns string
33204>>>    string name
33205>>>    clear witemx
INCLUDING FILE: WITEMX.FD
33206>>>    move syscurxr.company_code to witemx.company_code
33207>>>    move syscurxr.branch_code  to witemx.branch_code
33208>>>    move syscurxr.year_year    to witemx.year_year
33209>>>    move code to witemx.witemx_code
33210>>>    find eq witemx by index.5
33211>>>>
33211>>>    move witemx.witemx_descr to name
33212>>>    function_return name
33213>>>end_Function
33214>>>
33214>>>Function fsCNDescr String asItem Returns String
33215>>>    Clear CN
33216>>>    move asItem to CN.CN_Code
33217>>>    Find Eq CN by Index.5
33218>>>>
33218>>>    Function_Return CN.CN_Descr
33219>>>End_Function
33220>>>
33220>>>Function fswtypkin String askin Returns String
33221>>>    Clear Wtypkin
33222>>>    move askin to Wtypkin.wtypkin_code
33223>>>    Find Eq wtypkin by Index.1
33224>>>>
33224>>>    Function_Return Wtypkin.wtypkin_descr
33225>>>End_Function
33226>>>
33226>>>Function FindGtypkinDescr Integer aiCode Returns String
33227>>>    String lsDescr
33228>>>    Clear Gtypkin
INCLUDING FILE: GTYPKIN.FD
33229>>>    Move syscurxr.company_code    to Gtypkin.Company_Code
33230>>>    Move syscurxr.Branch_Code     to Gtypkin.Branch_Code
33231>>>    Move syscurxr.Year_year       to Gtypkin.Year_Year
33232>>>    Move aiCode                   to Gtypkin.Gtypkin_Code
33233>>>    Find eq Gtypkin by Index.1
33234>>>>
33234>>>    [Found] Move Gtypkin.Gtypkin_Descr to lsDescr
33235>>>    Function_Return lsDescr
33236>>>End_Function // FindGtypkinDescr
33237>>>
33237>>>Function FindBtypkinDescr Integer aiCode Returns String
33238>>>    String lsDescr
33239>>>    Clear Btypkin
INCLUDING FILE: BTYPKIN.FD
33240>>>    Move syscurxr.company_code    to Btypkin.Company_Code
33241>>>    Move syscurxr.Branch_Code     to Btypkin.Branch_Code
33242>>>    Move syscurxr.Year_year       to Btypkin.Year_Year
33243>>>    Move aiCode                   to Btypkin.btypkin_Code
33244>>>    Find eq Btypkin by Index.1
33245>>>>
33245>>>    [Found] Move Btypkin.Btypkin_Descr to lsDescr
33246>>>    Function_Return lsDescr
33247>>>End_Function // FindGtypkinDescr
33248>>>
33248>>>
33248>Use Connect.Dg
INCLUDING FILE: CONNECT.DG
33248>>>//AB/ Project Connect
33248>>>//AB/ Object prj is a Dialog_Project
33248>>>//AB/     Set ProjectName to "Connect"
33248>>>//AB/     Set ProjectFileName to "Connect.dg"
33248>>>
33248>>>// Project Object Structure
33248>>>//   Connect is a BasicPanelSub
33248>>>//     BitmapContainer1 is a BitmapContainerSub
33248>>>//     Textbox5 is a TextBoxSub
33248>>>//     ComboForm2 is a ComboFormSub
33248>>>//     Textbox6 is a TextBoxSub
33248>>>//     Form4 is a FormSub
33248>>>//     Textbox7 is a TextBoxSub
33248>>>//     Form5 is a FormSub
33248>>>//     Textbox8 is a TextBoxSub
33248>>>//     Form6 is a FormSub
33248>>>//     CheckBox1 is a CheckBoxSub
33248>>>//     oOK_bn is a ButtonSub
33248>>>//     oCancel_bn is a ButtonSub
33248>>>
33248>>>// Register all objects
33248>>>Register_Object BitmapContainer1
33248>>>Register_Object CheckBox1
33248>>>Register_Object ComboForm2
33248>>>Register_Object Connect
33248>>>Register_Object Form4
33248>>>Register_Object Form5
33248>>>Register_Object Form6
33248>>>Register_Object oCancel_bn
33248>>>Register_Object oOK_bn
33248>>>Register_Object Textbox5
33248>>>Register_Object Textbox6
33248>>>Register_Object Textbox7
33248>>>Register_Object Textbox8
33248>>>
33248>>>
33248>>>
33248>>>//AB-StoreTopStart
33248>>>
33248>>>///#INCLUDE
33248>>>Use mertech.inc
INCLUDING FILE: MERTECH.INC
33248>>>>>USE UI
33248>>>>>
#REM -----------------------------------------------
#REM MERTECH DATA SYSTEMS INC. - WWW.MERTECHDATA.COM
#REM MERTECH.INC VERSION 2.1.9
#REM -----------------------------------------------
33248>>>>>
33248>>>>>
33248>>>>>
33248>>>>>
33248>>>>>
33248>>>>>//
33248>>>>>//
33248>>>>>//
33248>>>>>//
33248>>>>>//
33248>>>>>//-----------------------------------------------
33248>>>>>// SELECT_COLUMNS_FIND <FILE> <START> THRU <END>
33248>>>>>// SELECT_COLUMNS_FIND <FILE> <FIELD>
33248>>>>>// This command will issue a properly commands to define the FETCH attribute status
33248>>>>>// for file fields.
33248>>>>>//
33248>>>>>//------------------------------------------------------------------------------
33248>>>>>// RESET_FETCH_FIELDS <FILE NAME>|<FILE NUMBER> <DF_FETCH_TRUE>|<DF_FETCH_FALSE>
33248>>>>>//
33248>>>>>//
33248>>>>>//-----------------------------
33248>>>>>// SQL_FOR_ONEROW <file number>
33248>>>>>//
33248>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get just
33248>>>>>// one ROW for each DataFlex FIND command issued
33248>>>>>// In this case the DBMS optimizer will generate a query with just one row
33248>>>>>//
33248>>>>>//
33248>>>>>//-------------------------------------------------------------------------------
33248>>>>>// SQL_FOR_SET <file number> MAXROWS <number of rows> CACHE|NOCACHE <return code>
33248>>>>>//
33248>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get a SET of rows.
33248>>>>>// In this case the DBMS optimizer will generate a query with <number of rows> Rows.
33248>>>>>// if CACHE is passed as argument, all these rows will be transfered to ORAFlex and then it will
33248>>>>>// save them in a local CACHE buffer. Just the FIND GT and FIND LT will get local cache.
33248>>>>>// Otherwise, i.e NOCACHE,  ORAFLex won't create a local cache.
33248>>>>>//
33248>>>>>//
33248>>>>>//---------------
33248>>>>>// SQL_SET <stmt>
33248>>>>>//
33248>>>>>//-----------------------------------------
33248>>>>>// SQL_APPEND <stmt1> <stmt2> .... <stmtn>
33248>>>>>//
33248>>>>>//------------
33248>>>>>// SQL_EXECUTE
33248>>>>>//
33248>>>>>//----------------------------------------------------------------------
33248>>>>>// LOCK_TABLE [<FILE NAME>|<FILE NUMBER> <FILE NAME>|<FILE NUMBER> ....]
33248>>>>>//
33248>>>>>// LOCK_TABLE will lock the entire table specified as an argument
33248>>>>>// This command will start a new transaction if it still wasn't done.
33248>>>>>// LOCK_TABLE won't lock the other opened tables or the current rows present
33248>>>>>// in their buffers it will be necessary issue a REREAD command to Lock the current
33248>>>>>// rows and then atualize their buffers
33248>>>>>//
33248>>>>>//
33248>>>>>//-------------------------------------------
33248>>>>>// SQL_CHECK_TABLE <SCHEMA NAME> <TABLE NAME>
33248>>>>>//
33248>>>>>//-------------------------------
33248>>>>>// CREATE_TD_FILE  DFTRUE|DFFALSE
33248>>>>>// SET A GLOBAL ATTRIBUTE TO CREATE THE TD FILE AFTER CLOSING AN OPENED FILE
33248>>>>>//
33248>>>>>//-------------------------------------------------
33248>>>>>// OPEN_INT <DATAFLEX FILE NAME>
33248>>>>>// OPEN_INT <PHYSICAL NAME> AS <DATAFLEX FILE NAME>
33248>>>>>//
33248>>>>>// OPEN_INT will check if the OPEN done is an OPEN AS. IF it's true, OPEN_INT
33248>>>>>// will try to open an intermediate file, if there is one. Otherwise OPEN_INT
33248>>>>>// will issue a OPEN command
33248>>>>>// OPEN_INT must be inserted into FMAC file instead OPEN COMMAND
33248>>>>>//
33248>>>>>//=========================================================================================================
33248>>>>>// SELECT STUFFS
33248>>>>>//--------------
33248>>>>>// SQL_SET_STMT OF FILENAME|FILENUMBER TO <STATMENT1>
33248>>>>>//
33248>>>>>// SQL_APPEND_ OF FILENAME|FILENUMBER TO <STATMENT1> <STATMENT2> ... <STATMENTn>
33248>>>>>//
33248>>>>>//
33248>>>>>// SQL_APPEND_UPDCOL_STMT OF FILENAME|FILENUMBER VALUE EXPRESSION WITH FIELD1 FIELD2 ... FIELDN
33248>>>>>//
33248>>>>>// SQL_PREPARE_STMT OF FILENAME|FILENUMBER
33248>>>>>//
33248>>>>>// SQL_BIND_COLUMN [FILENAME|FILENUMBER] [FIELDNAME|FIELDNUMBER]
33248>>>>>//
33248>>>>>// SQL_BINDCOLUMNS_STMT OF FILENAME|FILENUMBER TO <COLUMN1> <COLUMN2> ... <COLUMNn>
33248>>>>>//
33248>>>>>// SQL_EXECUTE_STMT OF FILENAME|FILENUMBER
33248>>>>>//
33248>>>>>// SQL_COMMIT_STMT
33248>>>>>//
33248>>>>>// SQL_ROLLBACK_STMT
33248>>>>>//
33248>>>>>// SQL_FETCH_NEXT_ROW OF FILENAME|FILENUMBER
33248>>>>>//
33248>>>>>//
33248>>>>>//
33248>>>>>//
33248>>>>>// CALL_STORED_PROCEDURE will call a stored procedure passing arguments
33248>>>>>//
33248>>>>>// FORMAT TO USE : CALL_STORED_PROCEDURE <STORED_PROC_NAME> [PASSING <ARG1> <ARG2> ....<ARGn>]
33248>>>>>//
33248>>>>>//
33248>>>>>//---------------------------------------------------------------------------------------------
33248>>>>>// CALL_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
33248>>>>>// CALL_STORED_FUNCTION will call an Oracle stored function passing arguments
33248>>>>>//
33248>>>>>//---------------------------
33248>>>>>// SQL_TEXT_MESSAGE <MESSAGE>
33248>>>>>// Writes a message inside driver log trace file if this is activated
33248>>>>>//
33248>>>>>//-----------------------------------------------------
33248>>>>>// OUTPUT_INT_FILE FOR <FILE NUMBER> TO <INT FILE NAME>
33248>>>>>// Generating the INT file
33248>>>>>//
33248>>>>>// -----------------------
33248>>>>>// SQL_ERROR_MESSAGE <VAR>
33248>>>>>// SQL_ERROR_MESSAGE retrieve the native error message issued by server for error number 25000
33248>>>>>
33248>>>>>
33248>>>>>//=======================================================================================
33248>>>>>// SQLFlex Commands
33248>>>>>//-----------------
33248>>>>>//
33248>>>>>//-----------------------
33248>>>>>// SQLFlex_REVISION <VAR>
33248>>>>>// Retrieves SQLFlex revision
33248>>>>>//
33248>>>>>//-------------------------------------
33248>>>>>// SET_DATABASE_NAME TO <DATABASE NAME>
33248>>>>>// Sets current database
33248>>>>>//
33248>>>>>//---------------------------
33248>>>>>// GET_DATABASE_NAME TO <VAR>
33248>>>>>// Gets name of current database
33248>>>>>//
33248>>>>>//----------------------------------
33248>>>>>// SET_SCHEMA_NAME TO <SCHEMA NAME>
33248>>>>>// Sets current schema name
33248>>>>>//
33248>>>>>//-------------------------
33248>>>>>// GET_SCHEMA_NAME TO <VAR>
33248>>>>>// Gets current schema name
33248>>>>>//
33248>>>>>//--------------------------------
33248>>>>>// SQL_USEDATABASE <DATABASE NAME>
33248>>>>>// Specifies the current Database
33248>>>>>//
33248>>>>>//----------------------------
33248>>>>>// SET_CURRENT_SERVER TO <VAR>
33248>>>>>// Set the current logged server
33248>>>>>//
33248>>>>>//----------------------------
33248>>>>>// GET_CURRENT_SERVER TO <VAR>
33248>>>>>// Retrieves the current logged server
33248>>>>>//
33248>>>>>//-----------------------------
33248>>>>>// SET_HOST_NAME TO <HOST NAME>
33248>>>>>// Defines current host name
33248>>>>>//
33248>>>>>//-----------------------
33248>>>>>// GET_HOST_NAME TO <VAR>
33248>>>>>// Retrieves the current host name
33248>>>>>//
33248>>>>>//---------------------------------------------------------------
33248>>>>>// LOGIN_SQLFLEX <SERVER NAME> <USER NAME> <PASSWORD> <HOST NAME>
33248>>>>>// Specifies host name during login process
33248>>>>>//
33248>>>>>// SQL_CANCEL_QUERY_STMT
33248>>>>>//
33248>>>>>//========================================
33248>>>>>// SQL SERVER Stored Procedure Call engine
33248>>>>>//----------------------------------------
33248>>>>>//
33248>>>>>//
33248>>>>>
33248>>>>>//
33248>>>>>//--------------------------------------------------------------------------------------------------------------
33248>>>>>// CALL_SQLSERVER_PROCEDURE <procedure name> PASSING <VALUE1|VARIABLE1> [SQLOUT] <VALUE2|VARIABLE2> [SQLOUT] ...
33248>>>>>//
33248>>>>>// Executes a stored procedure. SQLOUT will be used to indicate that the stored procedure
33248>>>>>// returns a parameter. The matching parameter in the stored proceudre must have been created with
33248>>>>>// the keyword OUTPUT. Call all procedures that doesn't returns any query with this syntax
33248>>>>>//
33248>>>>>//
33248>>>>>//
33248>>>>>//-----------------------------------------------------------------------------
33248>>>>>
33248>>>>>
33248>>>>>//=============================================================================
33248>>>>>// ORAFlex Commands
33248>>>>>//-----------------
33248>>>>>//----------------------------
33248>>>>>// ORAFlex_REVISION <VARIABLE>
33248>>>>>// Retrieves ORAFlex revision
33248>>>>>//
33248>>>>>//---------------------------------
33248>>>>>// KEEP_FILES_OPEN OF <SERVER NAME>
33248>>>>>// Keeps all files opened even during a LOGOUT
33248>>>>>//
33248>>>>>//-----------------------------------------------
33248>>>>>// SET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
33248>>>>>// Defines the maximum number of cursors that ORAFlex will be allowed for using
33248>>>>>//
33248>>>>>//-----------------------------------------------
33248>>>>>// GET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
33248>>>>>// Retrieves the maximum number of cursors allowed for ORAFlex use
33248>>>>>//
33248>>>>>//---------------------------------------------
33248>>>>>// GET_OPENED_CURSORS OF <SERVER NAME> TO <VAR>
33248>>>>>// Retrieves the number of opened cursors
33248>>>>>//
33248>>>>>//-----------------------------------------------
33248>>>>>// ACTIVATE_TIME_STAMP OF <SERVER NAME> TO ON|OFF
33248>>>>>// Activates Time stamp for date columns
33248>>>>>//
33248>>>>>//----------------------------------------------------------------------------------------------------
33248>>>>>// CALL_ORACLE_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
33248>>>>>// CALL_ORACLE_STORED_FUNCTION will call an Oracle stored function passing arguments
33248>>>>>//
33248>>>>>//-----------------------------------------------------------------------------
33248>>>>>
33248>>>>>//=============================================================================
33248>>>>>// BUFFER save stuffs
33248>>>>>//-------------------
33248>>>>>
33248>>>>>//-------------------------------------------------------
33248>>>>>// SQL_SAVE_BUFFER_BEGIN OF <FILE NUMBER> TO <CACHE SIZE>
33248>>>>>// Initialize the BUFFER buffer
33248>>>>>//
33248>>>>>//---------------------------------
33248>>>>>// SQL_SAVE_BUFFER OF <FILE NUMBER>
33248>>>>>// Moves field buffer values to cache buffer
33248>>>>>//-------------------------------------
33248>>>>>// SQL_SAVE_BUFFER_END OF <FILE NUMBER>
33248>>>>>// Save rows that remains in cache
33248>>>>>//-----------------------------------------------------------------------------
33248>>>>>
33248>>>
33248>>>//AB-StoreTopEnd
33248>>>
33248>>>//AB-IgnoreStart
33248>>>
33248>>>Use Panel.Sub
33248>>>Use Bitmap.Sub
33248>>>Use Txtbox.Sub
33248>>>Use Cmbfrm.Sub
33248>>>Use Form.Sub
33248>>>Use Chkbox.Sub
33248>>>Use Button.Sub
33248>>>
33248>>>
33248>>>//AB-IgnoreEnd
33248>>>
33248>>>Object Connect is a BasicPanelSub
33250>>>
33250>>>    //AB-StoreTopStart
33250>>>
33250>>>    //AB-StoreTopEnd
33250>>>
33250>>>    Set Sysmenu_Icon to FALSE
33251>>>    Set Minimize_Icon to FALSE
33252>>>    Set Label to "Login"
33253>>>    Set Size to 105 230
33254>>>    Set Location to 20 37
33255>>>
33255>>>    //AB-DDOStart
33255>>>
33255>>>
33255>>>    //AB-DDOEnd
33255>>>
33255>>>    Object BitmapContainer1 is a BitmapContainerSub
33257>>>        Set Size to 21 23
33258>>>        Set Location to 4 4
33259>>>        Set Bitmap to "Login1.bmp"
33260>>>        Set Border_Style to Border_None
33261>>>        Set Bitmap_Style to Bitmap_Center
33262>>>        Set Dialog_Caption to "Select a bitmap file"
33263>>>
33263>>>        //AB-StoreStart
33263>>>
33263>>>
33263>>>
33263>>>
33263>>>        //AB-StoreEnd
33263>>>
33263>>>    End_Object    // BitmapContainer1
33264>>>
33264>>>    Object Textbox5 is a TextBoxSub
33266>>>        Set Label to "Driver:"
33267>>>        Set FontSize to 4 0
33268>>>        Set Location to 6 34
33269>>>        Set Size to 13 40
33270>>>        Set TypeFace to "MS Sans Serif"
33271>>>        Set Enabled_State to TRUE
33272>>>    End_Object    // Textbox5
33273>>>
33273>>>    Object ComboForm2 is a ComboFormSub
33275>>>
33275>>>        //AB-StoreTopStart
33275>>>
33275>>>        Set CapsLock_State to True
33276>>>
33276>>>        //AB-StoreTopEnd
33276>>>
33276>>>        Set Size to 13 85
33277>>>        Set Location to 6 76
33278>>>        Set Label_Col_Offset to 2
33279>>>        Set Label_Justification_Mode to jMode_Right
33280>>>
33280>>>        //AB-StoreStart
33280>>>        Procedure Combo_Fill_List
33282>>>                Local String Availdrv## TempDrv##
33283>>>                Local Integer HowMany i p1## p2##
33283>>>
33283>>>                get_profile_string "WorkSpaces" "CurrentWorkspace" to AvailDrv##
33286>>>                If AvailDrv## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to AvailDrv##
33289>>>                insert "WorkSpaces\" in AvailDrv## at 1
33291>>>                get_profile_string AvailDrv## "AvailableDrivers" to AvailDrv##
33294>>>
33294>>>                Move Availdrv## to Tempdrv##
33295>>>                Repeat
33295>>>>
33295>>>                    Replace "|" in Tempdrv## With ""
33297>>>                    [Found] Increment HowMany
33298>>>                Until [Finderr]
33300>>>
33300>>>                Send Combo_add_Item ""
33301>>>
33301>>>                If HowMany lt 1 Begin
33303>>>                    If Availdrv## ne "" Send Combo_Add_Item (UpperCase(Availdrv##))
33306>>>                End
33306>>>>
33306>>>                Else Begin
33307>>>                    For i From 0 to HowMany
33313>>>>
33313>>>                        If i eq 0 Move 1 to p1##
33316>>>                        Else Begin
33317>>>                            Move ((Pos("|",Availdrv##))+1) to p1##
33318>>>                            Replace "|" in Availdrv## With ","
33320>>>                        End
33320>>>>
33320>>>                        Move ((Pos("|",Availdrv##))) to p2##
33321>>>                        Send Combo_Add_Item (UpperCase(Mid(Availdrv##,(p2##-p1##),p1##)))
33322>>>                    Loop
33323>>>>
33323>>>                End
33323>>>>
33323>>>        End_Procedure
33324>>>
33324>>>        Set Allow_Blank_state to True
33325>>>
33325>>>
33325>>>
33325>>>        //AB-StoreEnd
33325>>>
33325>>>    End_Object    // ComboForm2
33326>>>
33326>>>    Object Textbox6 is a TextBoxSub
33328>>>        Set Label to "Server:"
33329>>>        Set FontSize to 4 0
33330>>>        Set Location to 22 34
33331>>>        Set Size to 13 40
33332>>>        Set TypeFace to "MS Sans Serif"
33333>>>        Set Enabled_State to TRUE
33334>>>    End_Object    // Textbox6
33335>>>
33335>>>    Object Form4 is a FormSub
33337>>>        Set Size to 13 93
33338>>>        Set Location to 22 76
33339>>>        Set Label_Col_Offset to 2
33340>>>        Set Label_Justification_Mode to jMode_Right
33341>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33342>>>    End_Object    // Form4
33343>>>
33343>>>    Object Textbox7 is a TextBoxSub
33345>>>        Set Label to "User Name:"
33346>>>        Set FontSize to 4 0
33347>>>        Set Location to 38 34
33348>>>        Set Size to 13 40
33349>>>        Set TypeFace to "MS Sans Serif"
33350>>>        Set Enabled_State to TRUE
33351>>>    End_Object    // Textbox7
33352>>>
33352>>>    Object Form5 is a FormSub
33354>>>        Set Size to 13 93
33355>>>        Set Location to 38 76
33356>>>        Set Label_Col_Offset to 2
33357>>>        Set Label_Justification_Mode to jMode_Right
33358>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33359>>>    End_Object    // Form5
33360>>>
33360>>>    Object Textbox8 is a TextBoxSub
33362>>>        Set Label to "Password:"
33363>>>        Set FontSize to 4 0
33364>>>        Set Location to 54 34
33365>>>        Set Size to 13 40
33366>>>        Set TypeFace to "MS Sans Serif"
33367>>>        Set Enabled_State to TRUE
33368>>>    End_Object    // Textbox8
33369>>>
33369>>>    Object Form6 is a FormSub
33371>>>        Set Size to 13 93
33372>>>        Set Location to 54 76
33373>>>        Set Label_Col_Offset to 2
33374>>>        Set Label_Justification_Mode to jMode_Right
33375>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33376>>>
33376>>>        //AB-StoreStart
33376>>>        Set Password_State Item 0 to True
33377>>>
33377>>>        //AB-StoreEnd
33377>>>
33377>>>    End_Object    // Form6
33378>>>
33378>>>    Object CheckBox1 is a CheckBoxSub
33380>>>        Set Label to "Save Password"
33381>>>        Set Size to 10 66
33382>>>        Set Location to 73 76
33383>>>        Set Status_Help to "Remember The Password at Next Login"
33384>>>    End_Object    // CheckBox1
33385>>>
33385>>>    Object oOK_bn is a ButtonSub
33387>>>        Set Label to "Co&nnect"
33388>>>        Set Default_State to TRUE
33389>>>        Set Bitmap to "mcr.bmp"
33390>>>        Set Size to 28 33
33391>>>        Set Location to 9 184
33392>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33393>>>
33393>>>        //AB-StoreStart
33393>>>        Procedure OnClick
33395>>>            Set LoginOk to True
33396>>>            Send Stop_Modal_ui
33397>>>        End_Procedure
33398>>>        Set Status_Help to "Connect"
33399>>>        //AB-StoreEnd
33399>>>
33399>>>    End_Object    // oOK_bn
33400>>>
33400>>>    Object oCancel_bn is a ButtonSub
33402>>>        Set Label to "&Cancel"
33403>>>        Set Bitmap to "exit2.bmp"
33404>>>        Set Size to 28 32
33405>>>        Set Location to 39 184
33406>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33407>>>
33407>>>        //AB-StoreStart
33407>>>
33407>>>        ON_KEY KENTER SEND Exit_Application to (Connect(Current_Object))
33408>>>
33408>>>        Procedure OnClick
33410>>>            Set LoginOk to False
33411>>>            Send Exit_Application to (Connect(Current_Object))
33412>>>        End_Procedure
33413>>>
33413>>>        Set Status_Help to "Close Application"
33414>>>
33414>>>
33414>>>        //AB-StoreEnd
33414>>>
33414>>>    End_Object    // oCancel_bn
33415>>>
33415>>>
33415>>>    //AB-StoreStart
33415>>>
33415>>>    Set Modal_State to True
33416>>>
33416>>>    // Now is WorkspaceAware
33416>>>
33416>>>    ON_KEY KENTER SEND OnClick to (oOk_bn(Current_Object))
33417>>>    ON_KEY KSAVE_RECORD SEND OK
33418>>>    ON_KEY KCANCEL SEND EXIT_APPLICATION
33419>>>    ON_KEY KCLOSE_PANEL SEND EXIT_APPLICATION
33420>>>
33420>>>    Set Locate_Mode to Center_On_Screen
33421>>>    Set Exit_Application_Local_State to False
33422>>>    Set Exit_MSG to Exit
33423>>>    Set Description_State to True
33424>>>
33424>>>    Property Integer LoginOk public false
33426>>>
33426>>>    External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;        Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
33427>>>
33427>>>    Function Network_User_Name Returns String
33429>>>        Local String sName sLength
33430>>>        Local Pointer lpName_Addr lpLength_Addr
33430>>>        Local Integer iRetval
33430>>>
33430>>>        Movestr (Repeat (Character (0), 255)) To sName
33431>>>>
33431>>>        GetAddress Of sName To lpName_Addr
33432>>>        Movestr (DwordToBytes (255)) To sLength
33433>>>>
33433>>>        GetAddress Of sLength To lpLength_Addr
33434>>>
33434>>>        Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
33435>>>>
33435>>>
33435>>>        If iRetval Eq 0 Function_Return (CString (sName))
33438>>>        Else Function_Return "User Unknown"
33440>>>    End_Function // Network_User_Name
33441>>>
33441>>>    Function fsCrypto String lsWay String lsOld Returns String
33443>>>        Local String lsNew lsTemp
33444>>>        Local Integer liCount
33444>>>           For liCount From 1 to (Length(lsOld))
33450>>>>
33450>>>               Mid lsOld to lsTemp 1 liCount
33453>>>>
33453>>>               If ((Uppercase(lsWay)) eq 'FORWARD') Begin
33455>>>               If ((Ascii(lsTemp) = 255)) Move (Character(32)) to lsTemp
33458>>>               Else Move (Character(Ascii(lsTemp)+1)) to lsTemp
33460>>>               End
33460>>>>
33460>>>               Else Begin
33461>>>                   If ((Uppercase(lsWay)) eq 'BACKWARD') Begin
33463>>>                       If ((Ascii(lsTemp) = 32)) Move (Character(255)) to lsTemp
33466>>>                       Else Move (Character(Ascii(lsTemp)-1)) to lsTemp
33468>>>                   End
33468>>>>
33468>>>               End
33468>>>>
33468>>>               Append lsNew lsTemp
33469>>>           Loop
33470>>>>
33470>>>        Function_Return (lsNew)
33471>>>    End_Function
33472>>>
33472>>>    Procedure Activating
33474>>>        Local String LoginDriver## LoginServer## LoginUserid## LoginPassword##
33475>>>        Local String LastLogin## LoginSeq##
33475>>>        Local Integer SavePassword##
33475>>>
33475>>>        Forward Send Activating
33477>>>
33477>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33480>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33483>>>        insert "WorkSpaces\" in LastLogin## at 1
33485>>>        Append LastLogin## "\" (Module_Name(Self)) "\LastLogin"
33488>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33491>>>
33491>>>        If "|" in LoginSeq## move (left(LoginSeq##,(pos("|",LoginSeq##) -1))) to LoginDriver##
33494>>>        Else Move LoginSeq## to LoginDriver##
33496>>>        get_profile_string LastLogin## "LoginServer"  to LoginServer##
33499>>>        get_profile_string LastLogin## "LoginUserId"  to LoginUserId##
33502>>>        get_profile_string LastLogin## "SavePassword" to SavePassword##
33505>>>        If LoginUserId## eq "" Move (Network_User_Name(Current_Object)) to LoginUserId##
33508>>>
33508>>>        If (((UpperCase(LoginDriver##)) eq "DATAFLEX") or (LoginDriver## eq "")) Begin
33510>>>                Set Value of (ComboForm2(Current_Object)) Item 0 to ""
33511>>>                Set Value of (Form4(Current_Object))      Item 0 to ""
33512>>>        End
33512>>>>
33512>>>        Else Begin
33513>>>            Set Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
33514>>>            Set Value of (Form4(Current_Object))      Item 0 to LoginServer##
33515>>>        End
33515>>>>
33515>>>        Set Value of (Form5(Current_Object))      Item 0 to LoginUserID##
33516>>>        Set Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
33517>>>        If (SavePassword##) Begin
33519>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33520>>>            get_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to LoginPassword##
33524>>>            Set Value of (Form6(Current_Object))      Item 0 to (fsCrypto(Self,"backward",LoginPassword##))
33525>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33526>>>        End
33526>>>>
33526>>>    End_Procedure
33527>>>
33527>>>    Function LoginUser Returns Integer
33529>>>        Integer SavePassword## Size## PasswordOk
33530>>>        String LoginDriver## LoginServer## LoginUserid## LoginPassword## LoginSeq## LastLogin##
33530>>>        String lsLoginDate lsHH lsMM lsSS sDepartment
33530>>>        Integer liOpenCursors
33530>>>
33530>>>        Send Popup_Modal
33531>>>
33531>>>        Get Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
33532>>>        Get Value of (Form4(Current_Object))      Item 0 to LoginServer##
33533>>>        Get Value of (Form5(Current_Object))      Item 0 to LoginUserID##
33534>>>        Get Value of (Form6(Current_Object))      Item 0 to LoginPassword##
33535>>>        Get Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
33536>>>        Set Value of (Form6(Current_Object))      Item 0 to ""
33537>>>
33537>>>    //tolis 03/02/2004
33537>>>        If ((LoginDriver## <> "") and (UpperCase(LoginDriver##)<>"DATAFLEX"))  begin
33539>>>    //        send ignore_error to (error_info_object(current_object)) 25000
33539>>>    //        send ignore_error to (error_info_object(current_object)) 4255
33539>>>    //        send ignore_error to (error_info_object(current_object)) 12293
33539>>>    //        login LoginServer## LoginUserId## LoginPassword## LoginDriver##
33539>>>    //        send trap_error to (error_info_object(current_object)) 25000
33539>>>    //        send trap_error to (error_info_object(current_object)) 4255
33539>>>    //        send trap_error to (error_info_object(current_object)) 12293
33539>>>    //        If LastErr eq 25000 Begin
33539>>>    //            Error LastErr "Invalid Login Information"
33539>>>    //            Set LoginOk to False
33539>>>    //            Send Exit_Application
33539>>>    //        End
33539>>>    //        If LastErr eq 4255 Begin
33539>>>    //            Error LastErr "Invalid Driver Name"
33539>>>    //            Set LoginOk to False
33539>>>    //            Send Exit_Application
33539>>>    //        End
33539>>>    //        If LastErr eq 12293 Begin
33539>>>    //            Error LastErr "(IBM CLI)Database alias name or Database name not found"
33539>>>    //            Set LoginOk to False
33539>>>    //           Send Exit_Application
33539>>>    //      End
33539>>>            Set LoginOk to True
33540>>>    //        If (UpperCase(LoginDriver##) = "ORA_DRV") Begin
33540>>>    //            GET_MAX_OPEN_CURSORS of LoginServer## to liOpenCursors
33540>>>    //            If (liOpenCursors <> 0) SET_MAX_OPEN_CURSORS of LoginServer## to (liOpenCursors+2)
33540>>>    //        End
33540>>>        End
33540>>>>
33540>>>        Else Begin
33541>>>            Set LoginOk to True
33542>>>            Open "Users" as Users
INCLUDING FILE: USERS.FD
33544>>>            Move "DATAFLEX" To LoginDriver##
33545>>>            Move "" to LoginServer##
33546>>>            File_Size Users to Size##
33549>>>            If Size## ne 0 Begin
33551>>>                 Clear Users
33552>>>                 Move LoginUSerId##   to Users.Login_Id
33553>>>                 Find eq Users by Index.1
33554>>>>
33554>>>                 [Finderr] Begin
33556>>>>
33556>>>                    Error 25000 "Unknown User"
33557>>>>
33557>>>                    Set LoginOk to False
33558>>>                    Get LoginOk to PasswordOk
33559>>>                    Function_Return PasswordOk
33560>>>                 End
33560>>>>
33560>>>                 [Found] Begin
33562>>>>
33562>>>                    If (LoginPassword## ne Users.Password) Begin
33564>>>                        Error 25000 "Invalid Password"
33565>>>>
33565>>>                        Set LoginOk to False
33566>>>                        Get LoginOk to PasswordOk
33567>>>                        Function_Return PasswordOk
33568>>>                    End
33568>>>>
33568>>>                    Else Move Users.Departm_Code to sDepartment
33570>>>                    Move (Trim(sDepartment)) to sDepartment
33571>>>                 End
33571>>>>
33571>>>            End
33571>>>>
33571>>>            Close Users
33572>>>
33572>>>
33572>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33572>>>    //            Integer bFileExists
33572>>>    //            Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33572>>>    //            If (NOT(bFileExists)) Begin
33572>>>
33572>>>    //                Get Get_File_Exists  "C:\UsrLogin.txt" To bFileExists
33572>>>    //                If (bFileExists) Begin
33572>>>
33572>>>    ////                        If Size## ne 0 Begin
33572>>>
33572>>>    //                            Local String ss1 ss2 ss3 ss4
33572>>>    //                            Local String dd1 dd2 dd3 dd4
33572>>>    //                            Move '' to dd1
33572>>>    //                            Move '' to dd2
33572>>>    //                            Move '' to dd3
33572>>>    //                            Move '' to dd4
33572>>>
33572>>>    //                            Direct_Input Channel 8 "C:\UsrLogin.txt"
33572>>>    //                            Readln Channel 8 ss1 ss2 ss3 ss4
33572>>>    //                            While (Not(Seqeof))
33572>>>    //                                Move (Trim(ss1)) to ss1
33572>>>    //                                Move (Trim(ss2)) to ss2
33572>>>    //                                Move (Trim(ss3)) to ss3
33572>>>    //                                Move (Trim(ss4)) to ss4
33572>>>    //                                Append dd1 '"' ss1 '"'
33572>>>    //                                Append dd2 '"' ss2 '"'
33572>>>    //                                Append dd3 '"' ss3 '"'
33572>>>    //                                Append dd4 '"' ss4 '"'
33572>>>    //                                Login dd1 dd2 dd3 dd4
33572>>>    //                                Readln Channel 8 ss1 ss2 ss3 ss4
33572>>>    //                            Loop
33572>>>
33572>>>
33572>>>    ////                            // Only Filmnet Users Log on to SQL
33572>>>    ////                            If (sDepartment='FILMNET') Begin
33572>>>    ////                                ////// 20/06/2001 js Allagh apo Oracle se SQL server
33572>>>    ////                                ////// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33572>>>    ////                                login '192.168.128.5'   'sa'    ''   'SQL_DRV'
33572>>>    ////                                login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33572>>>    ////                            End
33572>>>    ////                            Else login '192.168.128.5'      'sa'    ''   'SQL_DRV'
33572>>>    ////                            //Else login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33572>>>
33572>>>    ////                        End
33572>>>    ////                        Else Begin
33572>>>    ////                            ////// 20/06/2001 js Allagh apo Oracle se SQL server
33572>>>    ////                            ///// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33572>>>    ////                            login '192.168.128.5'       'sa'    ''   'SQL_DRV'
33572>>>    ////                            //login '192.168.128.5'   'EPGDNS'    'DNS'   'SQL_DRV'
33572>>>    ////                            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33572>>>    ////                        End
33572>>>
33572>>>
33572>>>    //                End
33572>>>
33572>>>    //            End
33572>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33572>>>
33572>>>
33572>>>
33572>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33572>>>            //*Integer bFileExists
33572>>>            //*Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33572>>>            //*If (NOT(bFileExists)) Begin
33572>>>            //*    If Size## ne 0 Begin
33572>>>            //*        // Only Filmnet Users Log on to SQL
33572>>>            //*        If (sDepartment='FILMNET') Begin
33572>>>            //*            login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33572>>>            //*            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33572>>>            //*        End
33572>>>            //*        Else login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33572>>>            //*    End
33572>>>            //*    Else Begin
33572>>>            //*        login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33572>>>            //*        login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33572>>>            //*    End
33572>>>            //*
33572>>>            //*End
33572>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33572>>>
33572>>>
33572>>>
33572>>>        End
33572>>>>
33572>>>
33572>>>        Open Users
33574>>>        //Open "Users" as Users
33574>>>        File_Size Users to Size##
33577>>>        If Size## ne 0 Begin
33579>>>             Clear Users
33580>>>             Move LoginUSerId##   to Users.Login_Id
33581>>>             Find eq Users by Index.1
33582>>>>
33582>>>             [Finderr] Begin
33584>>>>
33584>>>                Error 25000 "Unknown User"
33585>>>>
33585>>>                Set LoginOk to False
33586>>>                Get LoginOk to PasswordOk
33587>>>                Function_Return PasswordOk
33588>>>             End
33588>>>>
33588>>>             [Found] Begin
33590>>>>
33590>>>                If (LoginPassword## ne Users.Password) Begin
33592>>>                    Error 25000 "Invalid Password"
33593>>>>
33593>>>                    Set LoginOk to False
33594>>>                    Get LoginOk to PasswordOk
33595>>>                    Function_Return PasswordOk
33596>>>                End
33596>>>>
33596>>>                Else Move Users.Departm_Code to sDepartment
33598>>>                Move (Trim(sDepartment)) to sDepartment
33599>>>             End
33599>>>>
33599>>>        End
33599>>>>
33599>>>        Close Users
33600>>>
33600>>>        Get LoginOk to PasswordOk
33601>>>        Sysdate lsLoginDate lsHH lsMM lsSS
33605>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33608>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33611>>>        insert "WorkSpaces\" in LastLogin## at 1
33613>>>        get_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33616>>>        If ((LoginDriver## ne "") and ((UpperCase(LoginDriver##)) ne "DATAFLEX")) Begin
33618>>>           If Not LoginDriver## in LoginSeq## Begin
33620>>>                 If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33623>>>                 Else Move (LoginSeq##+"|"+LoginDriver##) to LoginSeq##
33625>>>                 set_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33628>>>           End
33628>>>>
33628>>>        End
33628>>>>
33628>>>        Append LastLogin## "\" (Module_Name(Self))
33630>>>        Append LastLogin## "\LastLogin"
33631>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33634>>>
33634>>>        If "|" in LoginSeq## Begin
33636>>>            If ((left(LoginSeq##,(pos("|",LoginSeq##) -1))) ne LoginDriver##) Insert (LoginDriver##+"|") in LoginSeq## at 1
33640>>>        End
33640>>>>
33640>>>        Else Begin
33641>>>            If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33644>>>            Else If LoginSeq## ne LoginDriver## Insert (LoginDriver##+"|") in LoginSeq## at 1
33649>>>        End
33649>>>>
33649>>>        Left LoginSeq## to LoginSeq## 250
33651>>>>
33651>>>        set_profile_string LastLogin## "LoginDriver" to (UpperCase(LoginSeq##))
33654>>>        set_profile_string LastLogin## "LoginServer" to LoginServer##
33657>>>        set_profile_string LastLogin## "LoginUserId" to LoginUserId##
33660>>>        set_profile_string LastLogin## "SavePassword" to SavePassword##
33663>>>        If lsHH lt 10 Insert 0 in lsHH at 1
33667>>>        If lsMM lt 10 Insert 0 in lsMM at 1
33671>>>        If lsSS lt 10 Insert 0 in lsSS at 1
33675>>>        Append lsLoginDate " - " lsHH ":" lsMM ":" lsSS
33681>>>        set_profile_string LastLogin## "LoginTime" to lsLoginDate
33684>>>        If (SavePassword##) Begin
33686>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33687>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to (fsCrypto(Self,"forward",LoginPassword##))
33690>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33691>>>        End
33691>>>>
33691>>>        Else Begin
33692>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33693>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to ""
33696>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33697>>>        End
33697>>>>
33697>>>
33697>>>        Function_Return PasswordOk
33698>>>    End_Function
33699>>>
33699>>>    Procedure Login For Desktop
33700>>>        Local Integer LoginPassword##
33701>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33702>>>        If Not LoginPassword## Send Exit_Application
33705>>>    End_Procedure
33706>>>
33706>>>    Function CheckLogin For Desktop Returns Integer
33707>>>        Local Integer LoginPassword##
33708>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33709>>>        Function_Return LoginPassword##
33710>>>    End_Function
33711>>>
33711>>>
33711>>>
33711>>>
33711>>>
33711>>>
33711>>>    //AB-StoreEnd
33711>>>
33711>>>End_Object    // Connect
33712>>>
33712>>>
33712>>>//AB-StoreStart
33712>>>
33712>>>
33712>>>
33712>>>//AB-StoreEnd
33712>>>
33712>>>//AB/ End_Object    // prj
33712>Send Login
33713>Set Button_State    of (Wait(Self)) to False
33714>Set BarVisibleState of (Wait(Self)) to '' False
33715>Send Popup                          to (Wait(Self))
33716>Send UpdateWait to (Wait(Self))     '˜¨˜¡˜¢é œ¨ £â¤œ«œ. „¢œš®¦ª ˜¨®œåà¤ œ­˜¨£¦šãª'
33717>Use Menu_Sec.Sub
INCLUDING FILE: MENU_SEC.SUB
33717>>>
33717>>>Use Idiotht.pkg
INCLUDING FILE: IDIOTHT.PKG
33717>>>>>
33717>>>>>Open Users
33719>>>>>Open UserGrps
INCLUDING FILE: USERGRPS.FD
33721>>>>>Open Pedia
INCLUDING FILE: PEDIA.FD
33723>>>>>Open Arxeia
INCLUDING FILE: ARXEIA.FD
33725>>>>>Open GrpPedia
INCLUDING FILE: GRPPEDIA.FD
33727>>>>>Open GrpPed0
INCLUDING FILE: GRPPED0.FD
33729>>>>>Open GrpArx
INCLUDING FILE: GRPARX.FD
33731>>>>>Open GrpArx0
INCLUDING FILE: GRPARX0.FD
33733>>>>>Open ViewFlds
INCLUDING FILE: VIEWFLDS.FD
33735>>>>>Open Oth
INCLUDING FILE: OTH.FD
33737>>>>>Open GrpOth
INCLUDING FILE: GRPOTH.FD
33739>>>>>Open GrpOth0
INCLUDING FILE: GRPOTH0.FD
33741>>>>>Open Departm
INCLUDING FILE: DEPARTM.FD
33743>>>>>
33743>>>>>
33743>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
33744>>>>>
33744>>>>>Function Network_User_Name Returns String
33745>>>>>    Local String sName sLength
33746>>>>>    Local Pointer lpName_Addr lpLength_Addr
33746>>>>>    Local Integer iRetval
33746>>>>>    Movestr (Repeat (Character (0), 255)) To sName
33747>>>>>>
33747>>>>>    GetAddress Of sName To lpName_Addr
33748>>>>>    Movestr (DwordToBytes (255)) To sLength
33749>>>>>>
33749>>>>>    GetAddress Of sLength To lpLength_Addr
33750>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
33751>>>>>>
33751>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
33754>>>>>    Else Function_Return "User Unknown"
33756>>>>>End_Function // Network_User_Name
33757>>>>>
33757>>>>>Function fsGetOfficePath Global Returns String
33758>>>>>    String sRegistryKeyPath sRegOfficePath
33759>>>>>    Set_Registry_Root                                                   to HKEY_LOCAL_MACHINE "Software"
33760>>>>>    Move "Microsoft\Office\9.0\Word"                                    to sRegistryKeyPath
33761>>>>>    Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path"    to sRegOfficePath
33765>>>>>    Move (Trim(sRegOfficePath))                                         to sRegOfficePath
33766>>>>>    If (sRegOfficePath='') Begin
33768>>>>>        Move "Microsoft\Office\8.0\Word"                                to sRegistryKeyPath
33769>>>>>        Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
33773>>>>>        Move (Trim(sRegOfficePath))                                     to sRegOfficePath
33774>>>>>        If (sRegOfficePath='') Begin
33776>>>>>            Move "Microsoft\Office\7.0\Word"                             to sRegistryKeyPath
33777>>>>>            Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
33781>>>>>            Move (Trim(sRegOfficePath))                                     to sRegOfficePath
33782>>>>>            If (sRegOfficePath='') Begin
33784>>>>>                Move "Microsoft\Office\10.0\Word"                                to sRegistryKeyPath
33785>>>>>                Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
33789>>>>>                Move (Trim(sRegOfficePath))                                     to sRegOfficePath
33790>>>>>            End
33790>>>>>>
33790>>>>>        End
33790>>>>>>
33790>>>>>    End
33790>>>>>>
33790>>>>>    Function_Return sRegOfficePath
33791>>>>>End_Procedure
33792>>>>>
33792>>>>>
33792>>>>>Function fsGetLastDir Global Returns String
33793>>>>>    String sRegistryKeyPath sRegDir sUserName
33794>>>>>    Get Network_User_Name to sUserName
33795>>>>>
33795>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
33798>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
33801>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
33803>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
33805>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
33806>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
33807>>>>>    Get_profile_string sRegistryKeyPath "Path" to sRegDir
33810>>>>>    Function_Return sRegDir
33811>>>>>End_Procedure
33812>>>>>
33812>>>>>Function fiPutLastDir Global String asDirectory Returns Integer
33813>>>>>    String sRegistryKeyPath sRegDir sUserName
33814>>>>>    Get Network_User_Name to sUserName
33815>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
33818>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
33821>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
33823>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
33825>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
33826>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
33827>>>>>    Set_profile_string sRegistryKeyPath "Path" to asDirectory
33830>>>>>    Function_Return 0
33831>>>>>End_Procedure
33832>>>>>
33832>>>>>
33832>>>>>Function fsVresExt Global String asFileName Returns String
33833>>>>>    String rVal
33834>>>>>    Integer iPos iLen
33834>>>>>    Move (UpperCase(asFileName)) to asFileName
33835>>>>>    Move (Trim(asFileName)) to asFileName
33836>>>>>    Move 0 to iPos
33837>>>>>    For iLen from 1 to (length(asFileName))
33843>>>>>>
33843>>>>>        If (Mid(asFileName,1,iLen)='.') Move iLen to iPos
33846>>>>>    Loop
33847>>>>>>
33847>>>>>    If (Not(iPos)) Function_Return ''
33850>>>>>    Move (Right(asFileName,(Length(asFileName)-iPos))) to rVal
33851>>>>>    Move (Trim(rVal)) to rVal
33852>>>>>    Function_Return rVal
33853>>>>>End_Function
33854>>>>>
33854>>>>>
33854>>>>>Function fiScreenFieldStatus Global String asViewName String asDbFormName Returns Integer
33855>>>>>    Integer rVal iUser iGroup
33856>>>>>    String  sUser sRecr
33856>>>>>    Move (Trim(asViewName))     to asViewName
33857>>>>>    Move (Trim(asDbFormName))   to asDbFormName
33858>>>>>
33858>>>>>    If ((asViewName<>'') And (asDbFormName<>'')) Begin
33860>>>>>        Get fsLoginUserID to sUser
33861>>>>>        Clear Users
33862>>>>>        Move sUser        to Users.Login_ID
33863>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
33864>>>>>>
33864>>>>>        If (Found=1) Begin
33866>>>>>            Move Users.User_ID  to iUser
33867>>>>>            Move Users.Grp_ID   to iGroup
33868>>>>>            Clear GrpOth
33869>>>>>            Move iUser          to GrpOth.User_ID
33870>>>>>            Move asViewName     to GrpOth.View_Name
33871>>>>>            Move asDbFormName   to GrpOth.Scr_Field_Name
33872>>>>>            Find eq GrpOth by Index.2 // GrpOth:Index.2:User_ID+View_Name+Scr_Field_Name
33873>>>>>>
33873>>>>>            If (Found=1) Begin
33875>>>>>                // rVal=1 ==> NO READ ALLOWED
33875>>>>>                // rVal=2 ==> NO EDIT BUT CAN COPY
33875>>>>>                // rVal=3 ==> NO EDIT AND NO COPY
33875>>>>>                If (GrpOth.Allow_Read <>'1') Move 1 to rVal
33878>>>>>                Else Begin
33879>>>>>                    If (GrpOth.Allow_Change<>'1') Begin
33881>>>>>                        If (GrpOth.Allow_Copy<>'1') Move 3 to rVal
33884>>>>>                        Else                        Move 2 to rVal
33886>>>>>                    End
33886>>>>>>
33886>>>>>                End
33886>>>>>>
33886>>>>>            End
33886>>>>>>
33886>>>>>            Else Begin
33887>>>>>                Clear GrpOth0
33888>>>>>                Move iGroup         to GrpOth0.Group_ID
33889>>>>>                Move asViewName     to GrpOth0.View_Name
33890>>>>>                Move asDbFormName   to GrpOth0.Scr_Field_Name
33891>>>>>
33891>>>>>                Find eq GrpOth0 by Index.2 // GrpOth0:Index.2:Group_ID+View_Name+Scr_Field_Name
33892>>>>>>
33892>>>>>                If (Found=1) Begin
33894>>>>>                    // rVal=1 ==> NO READ ALLOWED
33894>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
33894>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
33894>>>>>                    If (GrpOth0.Allow_Read <>'1') Move 1 to rVal
33897>>>>>                    Else Begin
33898>>>>>                        If (GrpOth0.Allow_Change<>'1') Begin
33900>>>>>                            If (GrpOth0.Allow_Copy<>'1') Move 3 to rVal
33903>>>>>                            Else                         Move 2 to rVal
33905>>>>>                        End
33905>>>>>>
33905>>>>>                    End
33905>>>>>>
33905>>>>>                End
33905>>>>>>
33905>>>>>                Else Move 0 to rVal
33907>>>>>            End
33907>>>>>>
33907>>>>>        End
33907>>>>>>
33907>>>>>        Else Move 0 to rVal
33909>>>>>    End
33909>>>>>>
33909>>>>>    Function_Return rVal
33910>>>>>End_Function
33911>>>>>
33911>>>>>Function fiFieldStatus Global Integer aiFileNumber Integer aiFieldNumber Returns Integer
33912>>>>>    Integer rVal iUser iGroup
33913>>>>>    String  sUser sRecr
33913>>>>>    If ((aiFileNumber) And (aiFieldNumber)) Begin
33915>>>>>        Get fsLoginUserID to sUser
33916>>>>>        Clear Users
33917>>>>>        Move sUser        to Users.Login_ID
33918>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
33919>>>>>>
33919>>>>>        If (Found=1) Begin
33921>>>>>            Move Users.User_ID  to iUser
33922>>>>>            Move Users.Grp_ID   to iGroup
33923>>>>>            Clear Pedia
33924>>>>>            Move aiFileNumber  to Pedia.Arxeio_ID
33925>>>>>            Move aiFieldNumber to Pedia.Pedio_Number
33926>>>>>            Find eq Pedia By Index.1 // Pedia:Index.1:Arxeio_ID+Pedio_Number
33927>>>>>>
33927>>>>>            If (Found=1) Begin
33929>>>>>                Move (Trim(Pedia.Pedio_Recr))   to sRecr
33930>>>>>                // Find Combination User/File/Field in GRPPEDIA
33930>>>>>                Clear GrpPedia
33931>>>>>                Move iUser                      to GrpPedia.User_ID
33932>>>>>                Move (Trim(sRecr))              to GrpPedia.Pedio_Recr
33933>>>>>                Find eq GrpPedia by Index.4 // GrpPedia:Index.4:Pedio_Recr + User_ID
33934>>>>>>
33934>>>>>                If (Found=1) Begin
33936>>>>>                    // rVal=1 ==> NO READ ALLOWED
33936>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
33936>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
33936>>>>>                    If (GrpPedia.Allow_Read <>'1') Move 1 to rVal
33939>>>>>                    Else Begin
33940>>>>>                        If (GrpPedia.Allow_Change<>'1') Begin
33942>>>>>                            If (GrpPedia.Allow_Copy<>'1')   Move 3 to rVal
33945>>>>>                            Else                            Move 2 to rVal
33947>>>>>                        End
33947>>>>>>
33947>>>>>                    End
33947>>>>>>
33947>>>>>                End
33947>>>>>>
33947>>>>>                Else Begin
33948>>>>>                    // Find Combination UserGrps/File/Field in GRPPED0
33948>>>>>                    Clear GrpPed0
33949>>>>>                    Move iGroup         to GrpPed0.Group_ID
33950>>>>>                    Move (Trim(sRecr))  to GrpPed0.Pedio_Recr
33951>>>>>                    Find eq GrpPed0 by Index.4 // GrpPed0:Index.4:Pedio_Recr + Group_ID
33952>>>>>>
33952>>>>>                    If (Found=1) Begin
33954>>>>>                        // rVal=1 ==> NO READ ALLOWED
33954>>>>>                        // rVal=2 ==> NO EDIT BUT CAN COPY
33954>>>>>                        // rVal=3 ==> NO EDIT AND NO COPY
33954>>>>>                        If (GrpPed0.Allow_Read <>'1') Move 1 to rVal
33957>>>>>                        Else Begin
33958>>>>>                            If (GrpPed0.Allow_Change<>'1') Begin
33960>>>>>                                If (GrpPed0.Allow_Copy<>'1')   Move 3 to rVal
33963>>>>>                                Else                           Move 2 to rVal
33965>>>>>                            End
33965>>>>>>
33965>>>>>                        End
33965>>>>>>
33965>>>>>                    End
33965>>>>>>
33965>>>>>                End
33965>>>>>>
33965>>>>>            End
33965>>>>>>
33965>>>>>            Else Begin
33966>>>>>                Move 0 to rVal
33967>>>>>            End
33967>>>>>>
33967>>>>>        End
33967>>>>>>
33967>>>>>        Else Begin
33968>>>>>            Move 0 to rVal
33969>>>>>        End
33969>>>>>>
33969>>>>>    End
33969>>>>>>
33969>>>>>    Function_Return rVal
33970>>>>>End_Function
33971>>>>>
33971>>>>>Function fsReturnFileFromPath Global String asFullPath Returns String
33972>>>>>    String rVal lsDirSep
33973>>>>>    Integer iPos iMet iLen iCnt
33973>>>>>    Move (Trim(asFullPath))                 To rVal
33974>>>>>    Move (Sysconf(SYSCONF_DIR_SEPARATOR))   To lsDirSep
33975>>>>>    If (rVal Contains lsDirSep) Begin
33977>>>>>        Move (Length(rVal)) to iLen
33978>>>>>        Move iLen to iCnt
33979>>>>>        While iCnt Gt 0
33983>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Begin
33985>>>>>                If (iCnt=iLen) Function_Return asFullPath
33988>>>>>                Else Function_Return (Right(rVal,(iLen-iCnt)))
33990>>>>>            End
33990>>>>>>
33990>>>>>            Decrement iCnt
33991>>>>>        End // While iCnt Gt 0
33992>>>>>>
33992>>>>>    End
33992>>>>>>
33992>>>>>    Else  Function_Return (Trim(asFullPath))
33994>>>>>    Function_Return rVal
33995>>>>>End_Function
33996>>>>>
33996>>>>>Function fsReturnDirectoriesFromPath Global String asFullPath Returns String
33997>>>>>    String rVal lsDirSep
33998>>>>>    Integer iPos iMet iLen iCnt
33998>>>>>    Move (Trim(asFullPath))                 To rVal
33999>>>>>    Move (Sysconf(SYSCOnF_DIR_SEPARATOR))   To lsDirSep
34000>>>>>    If (rVal Contains lsDirSep) Begin
34002>>>>>        Move (Length(rVal)) to iLen
34003>>>>>        Move iLen to iCnt
34004>>>>>        While iCnt Gt 0
34008>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Function_Return (Left(rVal,iCnt))
34011>>>>>            Decrement iCnt
34012>>>>>        End // While iCnt Gt 0
34013>>>>>>
34013>>>>>    End
34013>>>>>>
34013>>>>>    Function_Return rVal
34014>>>>>End_Function
34015>>>>>
34015>>>>>//Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
34015>>>>>//    Local String rVal lsTmp lsOO lsLL
34015>>>>>//    Local Number lnOO lnLL
34015>>>>>
34015>>>>>//    Move '' to lsOO
34015>>>>>//    Move '' to lsLL
34015>>>>>//    Move '' to rVal
34015>>>>>
34015>>>>>//    Move (Integer(anTime))                              to lnOO
34015>>>>>//    ////////////////////////////////////////////
34015>>>>>//    // sos sos sos jsjsjsjsjs yannis 30/03/2000
34015>>>>>//    //If ((lnOO=24) and (lnll=0)) Move 0 to lnOO
34015>>>>>//    ////////////////////////////////////////////
34015>>>>>
34015>>>>>//    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
34015>>>>>
34015>>>>>//    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
34015>>>>>//    Else         Move (String(lnOO))                    to lsOO
34015>>>>>//    Move (Trim(lsOO))                                   to lsOO
34015>>>>>
34015>>>>>//    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
34015>>>>>//    Else         Move (String(lnLL))                    to lsLL
34015>>>>>//    Move (Trim(lsLL))                                   to lsLL
34015>>>>>
34015>>>>>//    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
34015>>>>>
34015>>>>>//    Move (Trim(rVal)) to rVal
34015>>>>>
34015>>>>>//    Function_Return rVal
34015>>>>>//End_Function
34015>>>>>
34015>>>>>//Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
34015>>>>>//    Local Number rVal nOres nLepta
34015>>>>>//    Move (Integer(aiMinutes/60))    to nOres
34015>>>>>//    Move (    Mod(aiMinutes,60))    to nLepta
34015>>>>>//    Move (nOres+(nLepta/100))       to rVal
34015>>>>>//    Function_Return rVal
34015>>>>>//End_Function
34015>>>>>
34015>>>>>//Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
34015>>>>>//    Local Integer rVal
34015>>>>>//    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
34015>>>>>//    Function_Return rVal
34015>>>>>//End_Function
34015>>>>>
34015>>>>>//Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;
34015>>>>>//                                                                    Number anEndTime    ;
34015>>>>>//                                                                    Returns Integer
34015>>>>>//    Local Integer rVal iMinStart iMinEnd
34015>>>>>
34015>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
34015>>>>>
34015>>>>>//    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
34015>>>>>//    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
34015>>>>>//    Move (iMinEnd-iMinStart)                                                     to rVal
34015>>>>>//    Function_Return rVal
34015>>>>>//End_Function
34015>>>>>
34015>>>>>
34015>>>>>//Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;
34015>>>>>//                                                                Number anEndTime    ;
34015>>>>>//                                                                Returns Number
34015>>>>>//    Local Integer iTmp
34015>>>>>//    Local Number  rVal
34015>>>>>
34015>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
34015>>>>>
34015>>>>>//    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
34015>>>>>//    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
34015>>>>>//    Function_Return rVal
34015>>>>>//End_Function
34015>>>>>
34015>>>>>
34015>>>>>Function fsLoginUserID Global Returns String
34016>>>>>    Local String LastLogin# LoginUserid#
34017>>>>>    get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin#
34020>>>>>    If LastLogin# eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin#
34023>>>>>    insert "WorkSpaces\" in LastLogin# at 1
34025>>>>>    Append LastLogin# "\" (Module_Name(Self)) "\LastLogin"
34028>>>>>    get_profile_string LastLogin# "LoginUserId"  to LoginUserId#
34031>>>>>    Trim LoginUserID# to LoginUserID#
34032>>>>>>
34032>>>>>    If LoginUserId# eq "" Move (Network_User_Name(Current_Object)) to LoginUserId#
34035>>>>>    Function_Return LoginUserID#
34036>>>>>End_Function
34037>>>>>
34037>>>>>Function fiWriteRegistryLastSDFPath Global String asLastPath Returns Integer
34038>>>>>    Integer rVal
34039>>>>>    String  lsCurrentWksp
34039>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34042>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34045>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34047>>>>>    // Œœ¦ ¡¢œ ›   - Last_SDF_Path -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
34047>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
34047>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
34050>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
34053>>>>>    Function_Return rVal
34054>>>>>End_Function
34055>>>>>
34055>>>>>
34055>>>>>Function fsReadRegistryLastSDFPath Global Returns String
34056>>>>>    String rVal lsCurrentWksp
34057>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34060>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34063>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34065>>>>>    // Œœ¦ ¡¢œ ›   - LastParastUsed -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
34065>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
34065>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
34068>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
34071>>>>>    Function_Return (Trim(rVal))
34072>>>>>End_Function
34073>>>>>
34073>>>>>
34073>>>>>Function fiWriteRegistryLastMCryptPath Global String asLastPath Returns Integer
34074>>>>>    Integer rVal
34075>>>>>    String  lsCurrentWksp
34075>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34078>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34081>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34083>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
34086>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
34089>>>>>    Function_Return rVal
34090>>>>>End_Function
34091>>>>>
34091>>>>>
34091>>>>>Function fsReadRegistryLastMCryptPath Global Returns String
34092>>>>>    String rVal lsCurrentWksp
34093>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34096>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34099>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34101>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
34104>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
34107>>>>>    Function_Return (Trim(rVal))
34108>>>>>End_Function
34109>>>>>
34109>>>>>Function fiWriteRegistryLastWEBPath Global String asLastPath Returns Integer
34110>>>>>    Integer rVal
34111>>>>>    String  lsCurrentWksp
34111>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34114>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34117>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34119>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
34122>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
34125>>>>>    Function_Return rVal
34126>>>>>End_Function
34127>>>>>
34127>>>>>
34127>>>>>Function fsReadRegistryLastWEBPath Global Returns String
34128>>>>>    String rVal lsCurrentWksp
34129>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34132>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34135>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34137>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
34140>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
34143>>>>>    Function_Return (Trim(rVal))
34144>>>>>End_Function
34145>>>>>
34145>>>>>Function fsReadRegistryFEMRootDir Global Returns String
34146>>>>>    String rVal lsCurrentWksp
34147>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34150>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34153>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34155>>>>>    Append lsCurrentWksp "\FEM"
34156>>>>>    Get_Profile_String lsCurrentWksp "RootDir"  to rVal
34159>>>>>    Function_Return (Trim(rVal))
34160>>>>>End_Function
34161>>>>>
34161>>>>>Function fsReadRegistryFEMDevicePath Global Returns String
34162>>>>>    String rVal lsCurrentWksp
34163>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34166>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34169>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34171>>>>>    Append lsCurrentWksp "\FEM"
34172>>>>>    Get_Profile_String lsCurrentWksp "DevicePath"  to rVal
34175>>>>>    Function_Return (Trim(rVal))
34176>>>>>End_Function
34177>>>>>
34177>>>>>Function fiWriteRegistryFEMRootDir Global Returns Integer
34178>>>>>    Integer rVal
34179>>>>>    String  lsCurrentWksp
34179>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34182>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34185>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34187>>>>>    Append lsCurrentWksp "\FEM"
34188>>>>>    Set_Profile_String lsCurrentWksp "RootDir"  to "C:\FEM_ROOT\"
34191>>>>>    Function_Return rVal
34192>>>>>End_Function
34193>>>>>
34193>>>>>Function fiWriteRegistryFEMDevicePath Global Returns Integer
34194>>>>>    Integer rVal
34195>>>>>    String  lsCurrentWksp
34195>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
34198>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
34201>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
34203>>>>>    Append lsCurrentWksp "\FEM"
34204>>>>>    Set_Profile_String lsCurrentWksp "DevicePath"  to "C:\FEM_ROOT\Device_File1.dat"
34207>>>>>    Function_Return rVal
34208>>>>>End_Function
34209>>>>>
34209>>>>>
34209>>>>>
34209>>>>>
34209>>>>>
34209>>>>>Function fig_Is_Admin Global Returns Integer
34210>>>>>    String sUser
34211>>>>>    Integer rVal
34211>>>>>    Get fsLoginUserID to sUser
34212>>>>>    Move (trim(sUser)) to sUser
34213>>>>>    Clear Users
34214>>>>>    Move sUser to Users.Login_ID
34215>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34216>>>>>>
34216>>>>>    Move Users.Admin_Rights to rVal
34217>>>>>    Function_Return rVal
34218>>>>>End_Function
34219>>>>>
34219>>>>>Function fig_The_User_Group Global Returns Integer
34220>>>>>    String sUser
34221>>>>>    Get fsLoginUserID   to sUser
34222>>>>>    Move (trim(sUser))  to sUser
34223>>>>>    Clear Users
34224>>>>>    Move sUser          to Users.Login_ID
34225>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34226>>>>>>
34226>>>>>    Clear UserGrps
34227>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
34228>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
34229>>>>>>
34229>>>>>    Function_Return UserGrps.Grp_ID
34230>>>>>End_Function
34231>>>>>
34231>>>>>Function fsg_The_User_Department Global Returns String
34232>>>>>    String sUser
34233>>>>>    Get fsLoginUserID   to sUser
34234>>>>>    Move (trim(sUser))  to sUser
34235>>>>>    Clear Users
34236>>>>>    Move sUser          to Users.Login_ID
34237>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34238>>>>>>
34238>>>>>    Clear Departm
34239>>>>>    Move Users.Departm_Code   to Departm.Code
34240>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
34241>>>>>>
34241>>>>>    Function_Return Departm.Code
34242>>>>>End_Function
34243>>>>>
34243>>>>>
34243>>>>>Function fig_Is_Specific_Admin Global String asUser Returns Integer
34244>>>>>    Integer rVal
34245>>>>>    Move (trim(asUser)) to asUser
34246>>>>>    Clear Users
34247>>>>>    Move asUser to Users.Login_ID
34248>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34249>>>>>>
34249>>>>>    Move Users.Admin_Rights to rVal
34250>>>>>    Function_Return rVal
34251>>>>>End_Function
34252>>>>>
34252>>>>>Function fig_The_Specific_User_Group Global String asUser Returns Integer
34253>>>>>    Move (trim(asUser))  to asUser
34254>>>>>    Clear Users
34255>>>>>    Move asUser          to Users.Login_ID
34256>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34257>>>>>>
34257>>>>>    Clear UserGrps
34258>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
34259>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
34260>>>>>>
34260>>>>>    Function_Return UserGrps.Grp_ID
34261>>>>>End_Function
34262>>>>>
34262>>>>>Function fsg_The_Specific_User_Department Global String asUser Returns String
34263>>>>>    Move (trim(asUser))  to asUser
34264>>>>>    Clear Users
34265>>>>>    Move asUser          to Users.Login_ID
34266>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
34267>>>>>>
34267>>>>>    Clear Departm
34268>>>>>    Move Users.Departm_Code   to Departm.Code
34269>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
34270>>>>>>
34270>>>>>    Function_Return Departm.Code
34271>>>>>End_Function
34272>>>>>
34272>>>>>
34272>>>
34272>>>Class ViewPopupMenu_Sec Is A ViewPopupMenu
34273>>>
34273>>>    Open Sysfile
INCLUDING FILE: SYSFILE.FD
34275>>>    Open Users
34277>>>    Open Views
INCLUDING FILE: VIEWS.FD
34279>>>    Open GrpViews
INCLUDING FILE: GRPVIEWS.FD
34281>>>    Open GrpView0
INCLUDING FILE: GRPVIEW0.FD
34283>>>    Open Arxeia
34285>>>    Open GrpArx
34287>>>
34287>>>    Function Find_User_Rights_In_Class String asView Returns Integer
34288>>>        String  lsView lsLogin
34289>>>        Integer liUser  liViews iGroup
34289>>>
34289>>>        Move (fsLoginUserID())      to lsLogin
34290>>>        Move (Trim(ToOEM(asView)))  to lsView
34291>>>
34291>>>        //////  /////////////////////////////////////
34291>>>        Clear Users
34292>>>        Move lsLogin    to Users.Login_ID
34293>>>
34293>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34294>>>>
34294>>>        If (Found=1)  Begin
34296>>>            Move Users.User_ID  to liUser
34297>>>            Move Users.Grp_ID   to iGroup
34298>>>        End
34298>>>>
34298>>>        Else Function_Return 0
34300>>>
34300>>>        Clear Views
34301>>>        Move (Trim(lsView)) to Views.Menu_Name
34302>>>        Find eq Views by Index.2 // Views:Index.2:Views.Menu_Name
34303>>>>
34303>>>        If (Found=1) Begin
34305>>>            Move Views.View_ID to liViews
34306>>>            Clear GrpViews
34307>>>            Move liUser    to GrpViews.User_ID
34308>>>            Move liViews   to GrpViews.View_ID
34309>>>            Find Eq GrpViews by Index.1 // GrpViews:Index.1:GrpViews.User_ID+GrpViews.View_ID
34310>>>>
34310>>>            If (Found=1) Begin // And (liUser=GrpViews.User_ID) And (liViews=GrpViews.View_ID)) Begin
34312>>>                Function_Return (GrpViews.Allow_Read<>'1')
34313>>>            End
34313>>>>
34313>>>            Else Begin
34314>>>                Clear GrpView0
34315>>>                Move iGroup    to GrpView0.Group_ID
34316>>>                Move liViews   to GrpView0.View_ID
34317>>>                Find eq GrpView0 by Index.1 // GrpView0:Index.1:Group_ID+View_ID
34318>>>>
34318>>>                If (Found=1) Begin
34320>>>                    Function_Return (GrpView0.Allow_Read<>'1')
34321>>>                End
34321>>>>
34321>>>                Else         Function_Return 0
34323>>>            End
34323>>>>
34323>>>        End
34323>>>>
34323>>>        Else Function_Return 0
34325>>>    End_Function
34326>>>
34326>>>//    Procedure Enhmerose_Views_File_In_Class
34326>>>//        Integer liCount liInt liLastNo
34326>>>//        String lsStr
34326>>>//        Get Item_Count to liCount
34326>>>//        // find last view_id
34326>>>//        Clear Views
34326>>>//        Move 9999 to Views.View_ID
34326>>>//        Find lt Views by index.1 // view_id
34326>>>//        If (Found=1)    Move Views.View_ID  to liLastNo
34326>>>//        Else            Move 0              to liLastNo
34326>>>//        For liInt From 0 to (liCount-1)
34326>>>//            Get Value item liInt to lsStr
34326>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
34326>>>//            //Move (Trim(lsStr)) to lsStr
34326>>>//            If (lsStr<>'') Begin
34326>>>//                Clear Views
34326>>>//                Move lsStr to Views.Menu_Name
34326>>>//                Find eq Views by index.2 // Views.Menu_Name
34326>>>//                If (NOT(Found)) Begin
34326>>>//                    Add 1 to liLastNo
34326>>>//                    Move liLastNo to Views.View_ID
34326>>>//                    Saverecord Views
34326>>>//                End
34326>>>//            End
34326>>>//        Loop
34326>>>//        For liInt From 0 to (liCount-1)
34326>>>//            Get Value item liInt to lsStr
34326>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
34326>>>//            //Move (Trim(lsStr)) to lsStr
34326>>>//            If (lsStr<>'') Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
34326>>>//        Loop
34326>>>//    End_procedure
34326>>>
34326>>>    Procedure OnInitMenu
34327>>>        Integer liCount liInt liLastNo
34328>>>        String lsStr
34328>>>
34328>>>        Get Item_Count to liCount
34329>>>
34329>>>        // find last view_id
34329>>>        Clear Views
34330>>>        Move 9999 to Views.View_ID
34331>>>        Find lt Views by index.1 // view_id
34332>>>>
34332>>>        If (Found=1)    Move Views.View_ID  to liLastNo
34335>>>        Else            Move 0              to liLastNo
34337>>>        For liInt From 0 to (liCount-1)
34343>>>>
34343>>>            Get Value item liInt to lsStr
34344>>>            Move (Trim(lsStr)) to lsStr
34345>>>            If ((lsStr<>'') and (Length(lsStr)>2)) Begin
34347>>>                Clear Views
34348>>>                Move (ToOEM(lsStr)) to Views.Menu_Name
34349>>>                Find eq Views by index.2 // Views.Menu_Name
34350>>>>
34350>>>                If (NOT(Found)) Begin
34352>>>                    Add 1 to liLastNo
34353>>>                    Move liLastNo to Views.View_ID
34354>>>                    //Move (ToOEM(lsStr)) to Views.Menu_Name
34354>>>                    Saverecord Views
34355>>>                End
34355>>>>
34355>>>            End
34355>>>>
34355>>>        Loop
34356>>>>
34356>>>        For liInt From 0 to (liCount-1)
34362>>>>
34362>>>            Get Value item liInt to lsStr
34363>>>            Move (Trim(lsStr)) to lsStr
34364>>>            Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
34365>>>        Loop
34366>>>>
34366>>>
34366>>>    End_procedure
34367>>>
34367>>>//    Procedure End_Construct_Object
34367>>>//        Forward Send End_Construct_Object
34367>>>//        Send Enhmerose_Views_File_In_Class
34367>>>//    End_Procedure
34367>>>
34367>>>End_Class //ButtonSub
34368>>>
34368>>>
34368>open bttmp1
INCLUDING FILE: BTTMP1.FD
34370>Use TranLock
INCLUDING FILE: TRANLOCK.PKG
34370>>>// Statement of purpose:
34370>>>// When using a reread command in VDF you will unfortunately lock many more
34370>>>// files than are necessary.  In order to only lock the files necessary I
34370>>>// use the following procedure to set all files to readonly, manually set
34370>>>// the files being worked on to (default) and then reset all back at the end.
34370>>>// This is what a data dictionary does in a VDF program for it's ddo tree.
34370>>>
34370>>>// The original package is a contribution of another programmer whom I cannot
34370>>>// remember their name (sorry).  The alteration I have done is to make sure that any file
34370>>>// with a non-default filemode will be set back to it's previous setting.
34370>>>
34370>>>Object FileModeArray Is An Array
34372>>>    // 0 = File Number
34372>>>    // 1 = Non-Default FileMode Existing Before Change By ChangeAllFileModes Procedure
34372>>>End_Object
34373>>>
34373>>>Procedure Write_Attribute_Array Integer iFile Integer iFileMode
34374>>>    Integer iCounter hArray iExists
34375>>>    Move (FileModeArray(Self)) To hArray
34376>>>    For iCounter From 0 To 1000
34382>>>>
34382>>>        Get Array_Value Of hArray Item ((iCounter * 2) + 0) To iExists
34383>>>        If (Not(iExists) Or (iExists = iFile)) Begin
34385>>>            Set Array_Value Of hArray Item ((iCounter * 2) + 0) To iFile
34386>>>            Set Array_Value Of hArray Item ((iCounter * 2) + 1) To iFileMode
34387>>>        End
34387>>>>
34387>>>        If (Not(iExists) Or (iExists = iFile)) Break
34390>>>    Loop
34391>>>>
34391>>>End_Procedure
34392>>>
34392>>>Procedure Clear_FileModeArray
34393>>>    Send Delete_Data To (FileModeArray(Self))
34394>>>End_Procedure
34395>>>
34395>>>Function Is_NonStandardFileMode Integer iFile Returns Integer
34396>>>    Integer iCounter iExists iNonStandardFileMode hArray
34397>>>    Move (FileModeArray(Self)) To hArray
34398>>>    For iCounter From 0 To 1000
34404>>>>
34404>>>        Get Array_Value Of hArray Item ((iCounter * 2) + 0) To iExists
34405>>>        If (Not(iExists)) Function_Return 0 // Not Listed In Array
34408>>>        If (iExists = iFile) Begin
34410>>>            Get Array_Value Of hArray Item ((iCounter * 2) + 1) To iNonStandardFileMode
34411>>>            Function_Return iNonStandardFileMode
34412>>>        End
34412>>>>
34412>>>    Loop
34413>>>>
34413>>>    Function_Return
34414>>>End_Function
34415>>>
34415>>>Procedure ChangeAllFileModes Integer iMode
34416>>>    Integer iFile iExistingFileMode iNonStandardFileMode
34417>>>    If (iMode = DF_FileMode_ReadOnly) Send Clear_FileModeArray
34420>>>    Repeat
34420>>>>
34420>>>        // Get Each Opened File, One At A Time...
34420>>>        Get_Attribute DF_File_Next_Opened Of iFile To iFile
34423>>>        If (Not(iFile)) Break
34426>>>        If (iMode = DF_Filemode_ReadOnly) Begin  // Setting All Files To Readonly: Check Alias Stuff
34428>>>            Get_Attribute DF_File_Mode Of iFile To iExistingFileMode
34431>>>            If (iExistingFileMode <> DF_Filemode_Default) Send Write_Attribute_Array iFile iExistingFileMode
34434>>>        End
34434>>>>
34434>>>        If (iMode = DF_Filemode_Default) Begin  // Setting All Files Back To Default
34436>>>            Get Is_NonStandardFileMode iFile To iNonStandardFileMode
34437>>>        End
34437>>>>
34437>>>        If (iNonStandardFileMode) Set_Attribute DF_File_Mode Of iFile To iNonStandardFileMode
34442>>>        Else                      Set_Attribute DF_File_Mode Of iFile To iMode
34446>>>    Loop
34447>>>>
34447>>>End_Procedure
34448>>>
34448>>>// // Comment: Example Of Usage:
34448>>>//    Send ChangeAllFileModes DF_Filemode_ReadOnly  // See Stark.Pkg for This Desktop Procedure
34448>>>// // Comment: Set All Open Files To ReadOnly Except For... (Files Used In Transaction Block)
34448>>>//    Set_Attribute DF_File_Mode Of MyFile1.File_Number To DF_Filemode_Default
34448>>>//    Set_Attribute DF_File_Mode Of MyFile2.File_Number  To DF_Filemode_Default
34448>>>//    Indicate Err False
34448>>>//    Begin_Transaction
34448>>>//
34448>>>//        Clear MyFile1
34448>>>//        Move 1 To MyFile1.Key
34448>>>//        Find EQ MyFile1 By Index.1
34448>>>//        Relate MyFile1
34448>>>//        Add MyFile2.Amount To MyFile1.Amount
34448>>>//        Saverecord MyFile1
34448>>>//        Saverecord MyFile2
34448>>>//        If (Condition) Error 300 "Error Message Here" // Saves Rolled Back
34448>>>//
34448>>>//    End_Transaction
34448>>>//    If (Err) Begin
34448>>>//        Send Info_Box "Errors Were Encountered: No Files Were Altered By This Process (All Changes Rolled Back)"
34448>>>//    End
34448>>>//    Send ChangeAllFileModes DF_Filemode_Default  // Set FileModes Back From Readonly To Normal
34448>Use GridUtil.Utl
INCLUDING FILE: GRIDUTIL.UTL
34448>>>// Use GridUtil.utl // Grid and List utilities
34448>>>
34448>>>//> This package provides a number of functions working on objects of the
34448>>>//> Grid class (VDF) and List class (character mode DF). On the other hand
34448>>>//> it does not work with dbGrid (VDF) class or Table classes (character
34448>>>//> mode DF).
34448>>>//>
34448>>>//> Rather than having these function inplemented in a subclass of the
34448>>>//> Grid- or List classes I have made global functions and procedures
34448>>>//> that all takes the objects ID as the first parameter.
34448>>>//>
34448>>>//> To sort the contents of a grid by the contents of column column# use:
34448>>>//>
34448>>>//>    procedure Grid_SortByColumn global integer oGrd# integer column#
34448>>>//>
34448>>>//> The set the entry_state of all items in a grid in one go use:
34448>>>//>
34448>>>//>    procedure Grid_SetEntryState global integer obj# integer st#
34448>>>//>
34448>>>//> To figure out the number of the first item in the current row use:
34448>>>//>
34448>>>//>    function Grid_BaseItem global integer obj# returns integer
34448>>>//>
34448>>>//> To figure out the current column use:
34448>>>//>
34448>>>//>    function Grid_CurrentColumn global integer obj# returns integer
34448>>>//>
34448>>>//> And finally, to figure out the number of columns use:
34448>>>//>
34448>>>//>    function Grid_Columns global integer obj# returns integer
34448>>>//>
34448>>>
34448>>>Use Base.utl     // Item_Property command, Various macros (FOR_EX...), cArray, cSet and cStack classes
INCLUDING FILE: BASE.UTL
34448>>>>>// Use Base.utl     // Item_Property command, Various macros (FOR_EX...), cArray, cSet and cStack classes
34448>>>>>
34448>>>>>// This purpose of this package is to relieve me of having to remember which
34448>>>>>// package exactly holds a particular command or class.
34448>>>>>
34448>>>>>Use Array.utl    // Item_Property command
INCLUDING FILE: ARRAY.UTL
34448>>>>>>>// Use Array.utl    // Item_Property command
34448>>>>>>>
34448>>>>>>>// This package defines three commands ITEM_PROPERTY_LIST, ITEM_PROPERTY
34448>>>>>>>// and END_ITEM_PROPERTY_LIST. They should be used like this:
34448>>>>>>>//
34448>>>>>>>//          object oTest is an Array
34448>>>>>>>//            item_property_list
34448>>>>>>>//              item_property string  pItem_Label
34448>>>>>>>//              item_property integer pItem_Type
34448>>>>>>>//              item_property string  pItem_Default
34448>>>>>>>//            end_item_property_list // IF IN CLASS REPEAT CLASS NAME HERE!
34448>>>>>>>//          end_object
34448>>>>>>>//
34448>>>>>>>// You will now be able to write code like:
34448>>>>>>>//
34448>>>>>>>//          set pItem_Label   item 2 to "Amazing"
34448>>>>>>>//          get pItem_Default item 0 to sVar
34448>>>>>>>//
34448>>>>>>>// Note that you do not need to sub-class the array in order to fo this.
34448>>>>>>>// The ITEM_PROPERTY command structure simply defines a number of messages
34448>>>>>>>// that lets you set the values of the array using your own names.
34448>>>>>>>//
34448>>>>>>>// In a normal array you may get the number of items by using the Item_Count
34448>>>>>>>// function. Of course you may still do that, but you would more likely
34448>>>>>>>// want to retrieve the number of 'rows' currently in the array. For this
34448>>>>>>>// purpose the END_ITEM_PROPERTY_LIST command defines a function called
34448>>>>>>>// Row_Count.
34448>>>>>>>//
34448>>>>>>>// In an empty array the Row_Count function returns 0 (surprise). Having
34448>>>>>>>// set just one of the values of the 1'st row (row number 0) the Row_Count
34448>>>>>>>// function will return 1.
34448>>>>>>>//
34448>>>>>>>// If you want to define item_properties as part of a class definition
34448>>>>>>>// you should NOT define them inside procedure construct_object as you
34448>>>>>>>// would with normal properties. Instead it looks like this:
34448>>>>>>>//
34448>>>>>>>//          class cTest is an Array
34448>>>>>>>//            item_property_list
34448>>>>>>>//              item_property string  pItem_Label
34448>>>>>>>//              item_property integer pItem_Type
34448>>>>>>>//              item_property string  pItem_Default
34448>>>>>>>//            end_item_property_list cTest // NOTE: Class name as parameter!
34448>>>>>>>//          end_class
34448>>>>>>>
34448>>>>>>>use ui
34448>>>>>>>
34448>>>>>>>Enumeration_List // Symbols used internally by the item_property command
34448>>>>>>>  define EA$INTEGER
34448>>>>>>>  define EA$STRING
34448>>>>>>>  define EA$REAL
34448>>>>>>>  define EA$NUMBER
34448>>>>>>>  define EA$DATE
34448>>>>>>>End_Enumeration_List
34448>>>>>>>
34448>>>>>>>
34448>>>>>>>
34448>>>>>>>
34448>>>>>>>
34448>>>>>>>
34448>>>>>>>
34448>>>>>>>
34448>>>>>>>
34448>>>>>>>
34448>>>>>>>procedure Clone_Array global integer source# integer target#
34449>>>>>>>  local integer itm# max#
34450>>>>>>>  move (item_count(source#)) to max#
34451>>>>>>>  send delete_data to target#
34452>>>>>>>  for itm# from 0 to (max#-1)
34458>>>>>>>>
34458>>>>>>>    set value of target# item itm# to (value(source#,itm#))
34459>>>>>>>  loop
34460>>>>>>>>
34460>>>>>>>end_procedure
34461>>>>>Use Macros.utl   // Various macros (FOR_EX...)
34461>>>>>Use Set.utl      // cArray, cSet and cStack classes
INCLUDING FILE: SET.UTL
34461>>>>>>>// Use Set.utl      // cArray, cSet and cStack classes
34461>>>>>>>
34461>>>>>>>use ui
34461>>>>>>>Use DestObj.pkg  // DAW - Defines request_destroy_object
34461>>>>>>>
34461>>>>>>>class cArray is an Array
34462>>>>>>>  procedure construct_object integer img#
34463>>>>>>>    forward send construct_object img#
34465>>>>>>>    set delegation_mode to delegate_to_parent
34466>>>>>>>  end_procedure
34467>>>>>>>end_class // cArray
34468>>>>>>>
34468>>>>>>>class cArray2d is a cArray
34469>>>>>>>  function iObjectID.i integer x# returns integer
34470>>>>>>>    local integer obj#
34471>>>>>>>    get value item x# to obj#
34472>>>>>>>    ifnot obj# begin
34474>>>>>>>      object oArray2d is a cArray no_image
34476>>>>>>>        move current_object to obj#
34477>>>>>>>      end_object
34478>>>>>>>      set value item x# to obj#
34479>>>>>>>    end
34479>>>>>>>>
34479>>>>>>>    function_return obj#
34480>>>>>>>  end_function
34481>>>>>>>  procedure set Value.ii integer x# integer y# string value#
34482>>>>>>>    local integer obj#
34483>>>>>>>    get iObjectID.i x# to obj#
34484>>>>>>>    set value of obj# item y# to value#
34485>>>>>>>  end_procedure
34486>>>>>>>  function Value.ii integer x# integer y# returns string
34487>>>>>>>    local integer obj#
34488>>>>>>>    get value item x# to obj#
34489>>>>>>>    if obj# function_return (value(obj#,y#))
34492>>>>>>>    function_return 0
34493>>>>>>>  end_function
34494>>>>>>>  procedure reset
34495>>>>>>>    local integer itm# max# obj#
34496>>>>>>>    get item_count to max#
34497>>>>>>>    for itm# from 0 to (max#-1)
34503>>>>>>>>
34503>>>>>>>      get value item itm# to obj#
34504>>>>>>>      if obj# send request_destroy_object to obj#
34507>>>>>>>    loop
34508>>>>>>>>
34508>>>>>>>    send delete_data
34509>>>>>>>  end_procedure
34510>>>>>>>end_class // cArray2d
34511>>>>>>>
34511>>>>>>>class cArray3d is a cArray2d
34512>>>>>>>  function iObjectID.ii integer x# integer y# returns integer
34513>>>>>>>    local integer obj#
34514>>>>>>>    get Value.ii x# y# to obj#
34515>>>>>>>    ifnot obj# begin
34517>>>>>>>      object oArray3d is a cArray no_image
34519>>>>>>>        move current_object to obj#
34520>>>>>>>      end_object
34521>>>>>>>      set Value.ii x# y# to obj#
34522>>>>>>>    end
34522>>>>>>>>
34522>>>>>>>    function_return obj#
34523>>>>>>>  end_function
34524>>>>>>>  procedure set Value.iii integer x# integer y# integer z# string value#
34525>>>>>>>    local integer obj#
34526>>>>>>>    get iObjectID.ii x# y# to obj#
34527>>>>>>>    set value of obj# item z# to value#
34528>>>>>>>  end_procedure
34529>>>>>>>  function Value.iii integer x# integer y# integer z# returns string
34530>>>>>>>    local integer obj#
34531>>>>>>>    get value item x# to obj#
34532>>>>>>>    if obj# begin
34534>>>>>>>      get value of obj# item y# to obj#
34535>>>>>>>      if obj# function_return (value(obj#,z#))
34538>>>>>>>    end
34538>>>>>>>>
34538>>>>>>>    function_return 0
34539>>>>>>>  end_function
34540>>>>>>>  procedure reset
34541>>>>>>>    local integer xmax# ymax# x# y# yobj# zobj#
34542>>>>>>>    get item_count to xmax#
34543>>>>>>>    for x# from 0 to (xmax#-1)
34549>>>>>>>>
34549>>>>>>>      get value item x# to yobj#
34550>>>>>>>      if yobj# begin
34552>>>>>>>        get item_count of yobj# to ymax#
34553>>>>>>>        for y# from 0 to (ymax#-1)
34559>>>>>>>>
34559>>>>>>>          get value of yobj# item y# to zobj#
34560>>>>>>>          if zobj# send request_destroy_object to zobj#
34563>>>>>>>        loop
34564>>>>>>>>
34564>>>>>>>      end
34564>>>>>>>>
34564>>>>>>>    loop
34565>>>>>>>>
34565>>>>>>>    forward send reset
34567>>>>>>>  end_procedure
34568>>>>>>>end_class // cArray3d
34569>>>>>>>
34569>>>>>>>class cSet is an cArray
34570>>>>>>>  function element_find string sVar returns integer
34571>>>>>>>    local integer max# itm#
34572>>>>>>>    get item_count to max#
34573>>>>>>>    move 0 to itm#
34574>>>>>>>    while itm# lt max#
34578>>>>>>>      if sVar eq (value(current_object,itm#)) function_return itm# // Dirty exit
34581>>>>>>>      increment itm#
34582>>>>>>>    end
34583>>>>>>>>
34583>>>>>>>    function_return -1
34584>>>>>>>  end_function
34585>>>>>>>
34585>>>>>>>  procedure element_add string sVar
34586>>>>>>>    if (element_find(current_object,sVar)=-1) set value item (item_count(current_object)) to sVar
34589>>>>>>>  end_procedure
34590>>>>>>>
34590>>>>>>>  procedure element_remove string sVar
34591>>>>>>>    local integer itm#
34592>>>>>>>    get element_find sVar to itm#
34593>>>>>>>    if itm# ge 0 send delete_item itm#
34596>>>>>>>  end_procedure
34597>>>>>>>
34597>>>>>>>  function iAddOrFind_Element string sVar returns integer
34598>>>>>>>    local integer rval#
34599>>>>>>>    get element_find sVar to rval#
34600>>>>>>>    if rval# eq -1 begin
34602>>>>>>>      get item_count to rval#
34603>>>>>>>      set value item rval# to sVar
34604>>>>>>>    end
34604>>>>>>>>
34604>>>>>>>    function_return rval#
34605>>>>>>>  end_function
34606>>>>>>>
34606>>>>>>>//// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
34606>>>>>>>//// Original procedures (optimized) are mentioned for compatibility:
34606>>>>>>>//
34606>>>>>>>//function find_element string sVar returns integer
34606>>>>>>>//  local integer max# itm#
34606>>>>>>>//  get item_count to max#
34606>>>>>>>//  move 0 to itm#
34606>>>>>>>//  while itm# lt max#
34606>>>>>>>//    if sVar eq (value(current_object,itm#)) function_return itm# // Dirty exit
34606>>>>>>>//    increment itm#
34606>>>>>>>//  end
34606>>>>>>>//  function_return -1
34606>>>>>>>//end_function
34606>>>>>>>//
34606>>>>>>>//procedure Add_Element string sVar returns integer
34606>>>>>>>//  local integer rval#
34606>>>>>>>//  get find_element sVar to rval#
34606>>>>>>>//  if rval# lt 0 get item_count to rval#
34606>>>>>>>//  set array_value item rval# to sVar
34606>>>>>>>//  procedure_return rval#
34606>>>>>>>//end_procedure
34606>>>>>>>//
34606>>>>>>>//procedure Remove_Element string sVar
34606>>>>>>>//  local integer itm#
34606>>>>>>>//  get Find_Element item sVar to itm#
34606>>>>>>>//  if itm# gt -1 send delete_item itm#
34606>>>>>>>//end_procedure
34606>>>>>>>//// -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
34606>>>>>>>end_class
34607>>>>>>>
34607>>>>>>>class cStack is an cArray
34608>>>>>>>  function Stack_Empty returns integer
34609>>>>>>>    function_return (item_count(current_object)=0)
34610>>>>>>>  end_function
34611>>>>>>>  // *** Integer interface **************************************
34611>>>>>>>  procedure Push.i integer value#
34612>>>>>>>    set value item (item_count(current_object)) to value#
34613>>>>>>>  end_procedure
34614>>>>>>>  function iPop returns integer
34615>>>>>>>    local integer rval# itm#
34616>>>>>>>    move (item_count(current_object)-1) to itm#
34617>>>>>>>    get value item itm# to rval#
34618>>>>>>>    send delete_item itm#
34619>>>>>>>    function_return rval#
34620>>>>>>>  end_function
34621>>>>>>>  function iCopy returns integer
34622>>>>>>>    function_return (value(current_object,item_count(current_object)-1))
34623>>>>>>>  end_function
34624>>>>>>>  // *** String interface ***************************************
34624>>>>>>>  procedure Push.s string value#
34625>>>>>>>    set value item (item_count(current_object)) to value#
34626>>>>>>>  end_procedure
34627>>>>>>>  function sPop returns string
34628>>>>>>>    local integer itm#
34629>>>>>>>    local string rval#
34629>>>>>>>    move (item_count(current_object)-1) to itm#
34630>>>>>>>    get value item itm# to rval#
34631>>>>>>>    send delete_item itm#
34632>>>>>>>    function_return rval#
34633>>>>>>>  end_function
34634>>>>>>>  function sCopy returns string
34635>>>>>>>    function_return (value(current_object,item_count(current_object)-1))
34636>>>>>>>  end_function
34637>>>>>>>end_class
34638>>>>>
34638>>>Use Strings.utl  // String manipulation for VDF and 3.1
INCLUDING FILE: STRINGS.UTL
34638>>>>>// **********************************************************************
34638>>>>>// Use Strings.utl  // String manipulation for VDF and 3.1
34638>>>>>//
34638>>>>>// By Sture Andersen
34638>>>>>//
34638>>>>>// The file contains a number of global functions for manipulating
34638>>>>>// strings and converting numbers to strings. The package may be used
34638>>>>>// with DataFlex 3.1 and Visual DataFlex. This package is public domain.
34638>>>>>//
34638>>>>>//
34638>>>>>// Create: Fri  23-05-1997 - Merger of s_utl002, 006.
34638>>>>>// Update: Tue  25-08-1997 - Introduced fixes from Magnus Bergh
34638>>>>>//         Sun  14-12-1997 - Added the following functions:
34638>>>>>//                             ExtractWord           ExtractInteger
34638>>>>>//                             HowManyWords          HowManyIntegers
34638>>>>>//                             ExtractItemNeg        IsIntegerPresent
34638>>>>>//         Tue  31-03-1998 - Added the following functions:
34638>>>>>//                             Text_RemoveTrailingCr Text_CompressSubstCr
34638>>>>>//                             Text_RTrim            Text_Format.sii
34638>>>>>//                             Text_Trim             Text_FormattedLine.i
34638>>>>>//                             Text_Compress
34638>>>>>//         Fri  06-11-1998 - Added function InsertThousandsSep
34638>>>>>//         Sun  14-02-1999 - Added function Byte_ToHex
34638>>>>>//         Wed  27-04-1999 - Added function CurrentDecimalSeparator
34638>>>>>//
34638>>>>>// ***********************************************************************
34638>>>>>
34638>>>>>// Returns the string of length len# inside which src# is right justified:
34638>>>>>Function RightShift global string src# integer len# returns string
34639>>>>>  trim src# to src#
34640>>>>>>
34640>>>>>  if (length(src#)) lt len# insert (left(pad("",len#),len#-length(src#))) in src# at 1
34644>>>>>  function_return (left(src#,len#))
34645>>>>>End_Function
34646>>>>>
34646>>>>>// Returns the string of length len# inside which src# is centered:
34646>>>>>Function CenterString global string src# integer len# returns string
34647>>>>>  trim src# to src#
34648>>>>>>
34648>>>>>  if (length(src#)) lt len# insert (left(pad("",len#),len#-length(src#)/2)) in src# at 1
34652>>>>>  function_return (left(src#,len#))
34653>>>>>End_Function
34654>>>>>
34654>>>>>// Returns all characters to the right of position pos# (including the character at
34654>>>>>// posistion pos#)
34654>>>>>Function RightFromPos global string str# integer pos# returns string
34655>>>>>  function_return (right(str#,length(str#)-pos#+1))
34656>>>>>End_Function
34657>>>>>
34657>>>>>// Number converting functions:
34657>>>>>
34657>>>>>integer NumToStringConversionMode#
34657>>>>>
34657>>>>>move NUMTOSTR_THOUSANDS_SEPARATOR_OFF to NumToStringConversionMode#
34658>>>>>
34658>>>>>procedure set pNumToStringConversionMode integer value#
34659>>>>>  move value# to NumToStringConversionMode#
34660>>>>>end_procedure
34661>>>>>
34661>>>>>function InsertThousandsSep global string str# returns string
34662>>>>>  local integer pos# tmp#
34663>>>>>  local string sep#
34663>>>>>  trim str# to str#
34664>>>>>>
34664>>>>>  get_attribute DF_DECIMAL_SEPARATOR to pos#
34667>>>>>  character pos# to sep#
34668>>>>>>
34668>>>>>  move (pos(sep#,str#)) to pos#
34669>>>>>  ifnot pos# move (length(str#)+1) to pos#
34672>>>>>  get_attribute DF_THOUSANDS_SEPARATOR to tmp#
34675>>>>>  character tmp# to sep# // End overload
34676>>>>>>
34676>>>>>  while pos# gt 4
34680>>>>>    move (pos#-3) to pos#
34681>>>>>    insert sep# in str# at pos#
34683>>>>>  loop
34684>>>>>>
34684>>>>>  function_return str#
34685>>>>>end_function
34686>>>>>
34686>>>>>// Calling the function below will convert the number stored in src# to a
34686>>>>>// string containing dcp# decimals rounding excess decimals. Parameter dcp#
34686>>>>>// may be negative. The expression (NumToStr(1789,-3)) will evaluate to "2000".
34686>>>>>// The functions in this package all respects the value of global attribute
34686>>>>>// DF_DECIMAL_SEPARATOR.
34686>>>>>Function NumToStr global number src# integer dcp# returns string
34687>>>>>  local integer pos#
34688>>>>>  local string rval# radix#
34688>>>>>  if dcp# lt 0 function_return (NumToStr(src#*(10^dcp#),0)+left("00000000",-dcp#))
34691>>>>>  if src# ge 0 move (src#+(0.5/(10^dcp#))) to src#
34694>>>>>  else move (src#-(0.5/(10^dcp#))) to src#
34696>>>>>  get_attribute DF_DECIMAL_SEPARATOR to pos# // Overload
34699>>>>>  character pos# to radix# // End overload
34700>>>>>>
34700>>>>>  move src# to rval#
34701>>>>>  ifnot (pos(radix#,rval#)) append rval# radix#
34704>>>>>
34704>>>>>  append rval# "00000000"
34705>>>>>
34705>>>>>  move (pos(radix#,rval#)) to pos#
34706>>>>>  if dcp# eq 0 decrement pos#
34709>>>>>  move (left(rval#,pos#+dcp#)) to rval#
34710>>>>>  if NumToStringConversionMode# move (InsertThousandsSep(rval#)) to rval#
34713>>>>>  function_return rval#
34714>>>>>End_Function
34715>>>>>
34715>>>>>// This function is the same as NumToStr except that you have to specify
34715>>>>>// the length of the target string (len#). The number will be right
34715>>>>>// justified accordingly. Post-fix `R' means right justify:
34715>>>>>Function NumToStrR global number src# integer dcp# integer len# returns string
34716>>>>>  function_return (RightShift(NumToStr(src#,dcp#),len#))
34717>>>>>End_Function
34718>>>>>
34718>>>>>// This function is the same as NumToStrR except that you do not specify
34718>>>>>// the number of decimals:
34718>>>>>Function IntToStrR global number src# integer len# returns string
34719>>>>>  function_return (NumToStrR(src#,0,len#)) // Fixed, Magnus Bergh
34720>>>>>End_Function
34721>>>>>
34721>>>>>// Is the same as IntToStrR, except that leading blanks are substituted
34721>>>>>// for leading zeros (zf=zero fill):
34721>>>>>Function IntToStrRzf global number src# integer len# returns string
34722>>>>>  function_return (replaces(" ",NumToStrR(src#,0,len#),"0")) // Fixed, Magnus Bergh
34723>>>>>End_Function
34724>>>>>
34724>>>>>// Use this to obtain the number of the least significant "non zero
34724>>>>>// decimal in src#. 0.702 will return 3 while 100 will return -2:
34724>>>>>Function NumberOfDecs global number src# returns integer
34725>>>>>  local integer count#
34726>>>>>  local string tmp# radix#
34726>>>>>  if src# eq 0 function_return 0 // Special case
34729>>>>>  move src# to tmp# // This removes superflous decimals
34730>>>>>  get_attribute DF_DECIMAL_SEPARATOR to count# // Overload
34733>>>>>  character count# to radix# // End overload
34734>>>>>>
34734>>>>>  if radix# in src# function_return (length(tmp#)-pos(radix#,tmp#))
34737>>>>>  move 0 to count#
34738>>>>>  while (right(tmp#,1)="0")
34742>>>>>    move (left(tmp#,length(tmp#)-1)) to tmp#
34743>>>>>    decrement count#
34744>>>>>  end
34745>>>>>>
34745>>>>>  function_return count#
34746>>>>>End_Function
34747>>>>>
34747>>>>>function CurrentDecimalSeparator global returns string
34748>>>>>  local integer rval#
34749>>>>>  get_attribute DF_DECIMAL_SEPARATOR to rval#
34752>>>>>  function_return (character(rval#))
34753>>>>>end_function
34754>>>>>
34754>>>>>
34754>>>>>// StripFromLastOccurance takes two strings (src# and val#) as
34754>>>>>// arguments. src# is scanned backwards for occurrances of substring
34754>>>>>// val#. If found, the function will return a string equal to src#
34754>>>>>// truncated at the first character of the right most occurance of substring
34754>>>>>// val#.
34754>>>>>//
34754>>>>>// StripFromLastOccurance("To be or not to be...","be") = "To be or not to "
34754>>>>>// StripFromLastOccurance("Mary had a little lamb","white") = ""
34754>>>>>// StripFromLastOccurance("Mary had a little lamb","") = "Mary had a little lamb"
34754>>>>>//
34754>>>>>Function StripFromLastOccurance global string src# string val# returns string
34755>>>>>  local integer len# search_len#
34756>>>>>  local string tmp#
34756>>>>>  length val# to search_len#
34757>>>>>>
34757>>>>>  if search_len# eq 0 function_return src#
34760>>>>>  repeat
34760>>>>>>
34760>>>>>    length src# to len#
34761>>>>>>
34761>>>>>    if len# le search_len# function_return ""
34764>>>>>    move (right(src#,search_len#)) to tmp#
34765>>>>>    if tmp# eq val# function_return (left(src#,len#-search_len#))
34768>>>>>    move (left(src#,len#-1)) to src#
34769>>>>>  loop
34770>>>>>>
34770>>>>>End_Function
34771>>>>>
34771>>>>>Function GetFromLastOccurance global string src# string val# returns string
34772>>>>>  function_return (replace(StripFromLastOccurance(src#,val#),src#,""))
34773>>>>>End_Function
34774>>>>>
34774>>>>>// (ExtractWord("item1 item2"," ",0)) = ""
34774>>>>>// (ExtractWord("item1 item2"," ",1)) = "item1"
34774>>>>>// (ExtractWord("item1 item2"," ",2)) = "item2"
34774>>>>>// (ExtractWord("item1 item2"," ",3)) = ""
34774>>>>>// (ExtractWord(" item1 item2 "," ",x)) =
34774>>>>>//                       (ExtractWord("item1 item2"," ",x))
34774>>>>>//
34774>>>>>                         //        source     delimiters  item number
34774>>>>>Function ExtractWord global string src# string dlm# integer itm# returns string
34775>>>>>  local integer count# pos# in_item# len#
34776>>>>>  local string rval# atom#
34776>>>>>  move "" to rval#
34777>>>>>  move 0 to count#
34778>>>>>  move 0 to in_item#
34779>>>>>  move (length(src#)) to len#
34780>>>>>  for pos# from 1 to len#
34786>>>>>>
34786>>>>>    mid src# to atom# 1 pos#
34789>>>>>>
34789>>>>>    if in_item# begin
34791>>>>>      if atom# in dlm# move 0 to in_item#
34794>>>>>      else if count# eq itm# append rval# atom#
34798>>>>>    end
34798>>>>>>
34798>>>>>    else begin
34799>>>>>      ifnot atom# in dlm# begin
34801>>>>>        increment count#
34802>>>>>        move 1 to in_item#
34803>>>>>        if count# eq itm# move atom# to rval#
34806>>>>>      end
34806>>>>>>
34806>>>>>    end
34806>>>>>>
34806>>>>>  loop
34807>>>>>>
34807>>>>>  function_return rval#
34808>>>>>End_Function
34809>>>>>Function ExtractItem global string src# string dlm# integer itm# returns string
34810>>>>>  Function_Return (ExtractWord(src#,dlm#,itm#))
34811>>>>>End_Function
34812>>>>>                          //        source     delimiters
34812>>>>>Function HowManyWords global string src# string dlm# returns integer
34813>>>>>  local integer count# pos# in_item# len#
34814>>>>>  local string atom#
34814>>>>>  move 0 to count#
34815>>>>>  move 0 to in_item#
34816>>>>>  move (length(src#)) to len#
34817>>>>>  for pos# from 1 to len#
34823>>>>>>
34823>>>>>    mid src# to atom# 1 pos#
34826>>>>>>
34826>>>>>    if in_item# begin
34828>>>>>      if atom# in dlm# move 0 to in_item#
34831>>>>>    end
34831>>>>>>
34831>>>>>    else begin
34832>>>>>      ifnot atom# in dlm# begin
34834>>>>>        increment count#
34835>>>>>        move 1 to in_item#
34836>>>>>      end
34836>>>>>>
34836>>>>>    end
34836>>>>>>
34836>>>>>  loop
34837>>>>>>
34837>>>>>  function_return count#
34838>>>>>end_function
34839>>>>>Function HowManyItems global string src# string dlm# returns integer
34840>>>>>  function_return (HowManyWords(src#,dlm#))
34841>>>>>End_Function
34842>>>>>                            //        source     legal char  item number
34842>>>>>function ExtractItemNeg global string src# string lch# integer itm# returns string
34843>>>>>  local integer count# pos# in_item? len#
34844>>>>>  local string rval# atom#
34844>>>>>  move "" to rval#
34845>>>>>  move 0 to count#
34846>>>>>  move 0 to in_item?
34847>>>>>  move (length(src#)) to len#
34848>>>>>  for pos# from 1 to len#
34854>>>>>>
34854>>>>>    mid src# to atom# 1 pos#
34857>>>>>>
34857>>>>>    if in_item? begin
34859>>>>>      ifnot atom# in lch# move 0 to in_item?
34862>>>>>      else if count# eq itm# append rval# atom#
34866>>>>>    end
34866>>>>>>
34866>>>>>    else begin
34867>>>>>      if atom# in lch# begin
34869>>>>>        increment count#
34870>>>>>        move 1 to in_item?
34871>>>>>        if count# eq itm# move atom# to rval#
34874>>>>>      end
34874>>>>>>
34874>>>>>    end
34874>>>>>>
34874>>>>>  loop
34875>>>>>>
34875>>>>>  function_return rval#
34876>>>>>end_function
34877>>>>>
34877>>>>>// ExtractInteger("123 456 789",0) = 0
34877>>>>>// ExtractInteger("123 456 789",2) = 456
34877>>>>>// ExtractInteger("123 456 789",4) = 0
34877>>>>>
34877>>>>>function ExtractInteger global string str# integer itm# returns integer
34878>>>>>  function_return (integer(ExtractItemNeg(str#,"0123456789",itm#)))
34879>>>>>end_function
34880>>>>>
34880>>>>>function HowManyIntegers global string str# returns integer
34881>>>>>  local integer rval# pos# len# in_int?
34882>>>>>  move 0 to in_int? //in integer?
34883>>>>>  move 0 to rval#
34884>>>>>  move (length(str#)) to len#
34885>>>>>  for pos# from 1 to len#
34891>>>>>>
34891>>>>>    if (mid(str#,1,pos#)) in "0123456789" begin
34893>>>>>      ifnot in_int? begin
34895>>>>>        increment rval#
34896>>>>>        move 1 to in_int?
34897>>>>>      end
34897>>>>>>
34897>>>>>    end
34897>>>>>>
34897>>>>>    else if in_int? move 0 to in_int?
34901>>>>>  loop
34902>>>>>>
34902>>>>>  function_return rval#
34903>>>>>end_function
34904>>>>>
34904>>>>>function IsIntegerPresent global string str# integer int# returns integer
34905>>>>>  local integer max# itm#
34906>>>>>  if str# eq "" function_return 0
34909>>>>>  move (HowManyIntegers(str#)) to max#
34910>>>>>  for itm# from 1 to max#
34916>>>>>>
34916>>>>>    if (ExtractInteger(str#,itm#)=int#) function_return 1
34919>>>>>  loop
34920>>>>>>
34920>>>>>  function_return 0
34921>>>>>end_function
34922>>>>>
34922>>>>>function AddIntegerToString global string str# integer int# returns string
34923>>>>>  function_return (trim(str#+" "+string(int#)))
34924>>>>>end_function
34925>>>>>
34925>>>>>// This function is used to compose a new string from an existing string. This
34925>>>>>// is similar to the way Windows 95 generates 8.3 file names.
34925>>>>>
34925>>>>>//    For example:    StringIncrementId("STURE",8) = "STURE ~1"
34925>>>>>//                    StringIncrementId("STURE ~1",8) = "STURE ~2"
34925>>>>>//                    StringIncrementId("STURE ~2",8) = "STURE ~3"
34925>>>>>//                    etc...
34925>>>>>function StringIncrementId global string id# integer len# returns string
34926>>>>>  local string char#
34927>>>>>  if (mid(id#,1,len#-1)) eq "~" begin
34929>>>>>    move (mid(id#,1,len#)) to char#
34930>>>>>    if (ascii(char#)) lt 93 function_return (overstrike(character(ascii(char#)+1),id#,len#))
34933>>>>>    else function_return ""
34935>>>>>  end
34935>>>>>>
34935>>>>>  function_return (overstrike("~1",id#,len#-1))
34936>>>>>end_function
34937>>>>>
34937>>>>>function StringUppercaseFirstLetters global string str# returns string
34938>>>>>  local integer len# pos# in_word#
34939>>>>>  local string rval# char#
34939>>>>>  move (lowercase(Str#)) to str#
34940>>>>>  move (length(str#)) to len#
34941>>>>>  move 0 to in_word#
34942>>>>>  for pos# from 1 to len#
34948>>>>>>
34948>>>>>    move (mid(str#,1,pos#)) to char#
34949>>>>>    if char# eq "" move 0 to in_word#
34952>>>>>    else begin
34953>>>>>      ifnot in_word# begin
34955>>>>>        uppercase char# to char#
34956>>>>>>
34956>>>>>        move 1 to in_word#
34957>>>>>      end
34957>>>>>>
34957>>>>>    end
34957>>>>>>
34957>>>>>    move (rval#+char#) to rval#
34958>>>>>  loop
34959>>>>>>
34959>>>>>  function_return rval#
34960>>>>>end_function
34961>>>>>
34961>>>>>function StringLeftBut global string str# integer but# returns string
34962>>>>>  function_return (left(str#,length(str#)-but#))
34963>>>>>end_function
34964>>>>>function StringRightBut global string str# integer but# returns string
34965>>>>>  function_return (right(str#,length(str#)-but#))
34966>>>>>end_function
34967>>>>>
34967>>>>>function StringConsistsOf global string src# string tpl# returns integer
34968>>>>>  local integer count# len#
34969>>>>>  trim src# to src#
34970>>>>>>
34970>>>>>  move (length(src#)) to len#
34971>>>>>  for count# from 1 to len#
34977>>>>>>
34977>>>>>    ifnot (mid(src#,1,count#)) in tpl# function_return 0
34980>>>>>  loop
34981>>>>>>
34981>>>>>  function_return 1
34982>>>>>end_function
34983>>>>>
34983>>>>>function RemoveDblBlanks global string str# returns string
34984>>>>>  local integer fin#
34985>>>>>  move 0 to fin#
34986>>>>>  repeat
34986>>>>>>
34986>>>>>    move (replaces("  ",str#," ")) to str#
34987>>>>>    ifnot "  " in str# move 1 to fin#
34990>>>>>  until fin#
34992>>>>>  function_return str#
34993>>>>>end_function
34994>>>>>
34994>>>>>function Byte_ToHex global integer byte# returns string
34995>>>>>  function_return (mid("0123456789ABCDEF",1,byte#/16+1)+mid("0123456789ABCDEF",1,byte# iand 15+1))
34996>>>>>end_function
34997>>>>>
34997>>>>>function Text_RemoveTrailingCr global string str# returns string
34998>>>>>  local integer fin# char#
34999>>>>>  move 0 to fin#
35000>>>>>  repeat
35000>>>>>>
35000>>>>>    if str# eq "" function_return ""
35003>>>>>    if (right(str#,1)=character(10) or right(str#,1)=" " or right(str#,1)=character(13)) move (left(str#,(length(str#)-1))) to str#
35006>>>>>    else move 1 to fin#
35008>>>>>  until fin#
35010>>>>>  function_return str#
35011>>>>>end_function
35012>>>>>
35012>>>>>function Text_RTrim global string str# returns string
35013>>>>>  move (rtrim(replaces(character(255),str#," "))) to str#
35014>>>>>  function_return (Text_RemoveTrailingCr(str#))
35015>>>>>end_function
35016>>>>>
35016>>>>>function Text_Trim global string str# returns string
35017>>>>>  move (trim(replaces(character(255),str#," "))) to str#
35018>>>>>  function_return (Text_RemoveTrailingCr(str#))
35019>>>>>end_function
35020>>>>>
35020>>>>>function Text_Compress global string str# returns string
35021>>>>>  move (replaces(character(10),str#," ")) to str#
35022>>>>>  trim str# to str#
35023>>>>>>
35023>>>>>  move (RemoveDblBlanks(str#)) to str#
35024>>>>>  function_return str#
35025>>>>>end_function
35026>>>>>
35026>>>>>function Text_CompressSubstCr global string str# string new_line# returns string
35027>>>>>  function_return (RemoveDblBlanks(trim(replaces(character(10),Text_RemoveTrailingCr(str#),new_line#))))
35028>>>>>end_function
35029>>>>>
35029>>>>>class cText_Formatter is an array
35030>>>>>  procedure construct_object integer img#
35031>>>>>    forward send construct_object img#
35033>>>>>    property integer pRmargin         public 40
35034>>>>>    property integer pCompress_state  public 0
35035>>>>>    property integer pTrim_state      public 1 // 0=no trim, 1=trim, 2=rtrim
35036>>>>>    property integer pSubst_below_32_state  public 0
35037>>>>>  end_procedure
35038>>>>>
35038>>>>>  procedure add_item.s string str#
35039>>>>>    local integer char#
35040>>>>>    if (pSubst_below_32_state(current_object)) begin
35042>>>>>      for char# from 0 to 31
35048>>>>>>
35048>>>>>        move (replaces(character(char#),str#," ")) to str#
35049>>>>>      loop
35050>>>>>>
35050>>>>>    end
35050>>>>>>
35050>>>>>    set array_value item (item_count(current_object)) to str#
35051>>>>>  end_procedure
35052>>>>>
35052>>>>>  function split_word string str# integer len# returns string
35053>>>>>    local integer pos#
35054>>>>>    local string rval#
35054>>>>>    move (pos("-",str#)) to pos#
35055>>>>>    if (pos# and pos#<=len#) move (replace("-",str#," ")) to rval#
35058>>>>>    else begin
35059>>>>>      move (left(str#,len#)) to rval#
35060>>>>>      move (rval#+" "+replace(rval#,str#,"")) to rval#
35061>>>>>    end
35061>>>>>>
35061>>>>>    function_return rval# // The space in the return value indicates
35062>>>>>  end_function            // where to split the word
35063>>>>>
35063>>>>>  procedure format.s string str#
35064>>>>>    local integer Trim_state# done# pRmargin# word_done# pos# max# len#
35065>>>>>    local string word# line# lf# left# char#
35065>>>>>
35065>>>>>    //pre-format:
35065>>>>>    get pTrim_state to Trim_state#
35066>>>>>    if Trim_state# eq 1 move (Text_Trim(str#)) to str#
35069>>>>>    else if Trim_state# eq 2 move (Text_RTrim(str#)) to str#
35073>>>>>    if (pCompress_state(current_object)) move (Text_Compress(str#)) to str#
35076>>>>>
35076>>>>>    move (character(10)) to lf#
35077>>>>>    get pRmargin to pRmargin#
35078>>>>>    if pRmargin# gt 1 begin // Otherwise nothing makes sense!
35080>>>>>      move 0 to done#
35081>>>>>      move "" to line#
35082>>>>>      move 1 to pos#
35083>>>>>      move (length(str#)) to max#
35084>>>>>      repeat
35084>>>>>>
35084>>>>>
35084>>>>>        move "" to word#
35085>>>>>        move 0 to word_done#
35086>>>>>        repeat
35086>>>>>>
35086>>>>>          if pos# gt max# move 1 to word_done#
35089>>>>>          else begin
35090>>>>>            mid str# to char# 1 pos#
35093>>>>>>
35093>>>>>            if char# eq lf# begin // Line feed
35095>>>>>              if word# eq "" begin
35097>>>>>                move lf# to word#
35098>>>>>                increment pos#
35099>>>>>              end
35099>>>>>>
35099>>>>>              move 1 to word_done#
35100>>>>>            end
35100>>>>>>
35100>>>>>            else begin
35101>>>>>              if char# eq "" begin
35103>>>>>                if word# eq "" increment pos#
35106>>>>>                else move 1 to word_done#
35108>>>>>              end
35108>>>>>>
35108>>>>>              else begin
35109>>>>>                move (word#+char#) to word#
35110>>>>>                increment pos#
35111>>>>>              end
35111>>>>>>
35111>>>>>            end
35111>>>>>>
35111>>>>>          end
35111>>>>>>
35111>>>>>        until word_done#
35113>>>>>
35113>>>>>        if word# eq "" move 1 to done# // We're done!
35116>>>>>        else begin
35117>>>>>          if word# eq lf# begin // If hard return:
35119>>>>>            send add_item.s line#
35120>>>>>            move "" to line#
35121>>>>>          end
35121>>>>>>
35121>>>>>          else begin //
35122>>>>>            if (length(line#)+length(word#)+1) gt pRmargin# begin // Soft new line
35124>>>>>              if line# ne "" begin
35126>>>>>                send add_item.s line# // Could be that word is longer that pRmargin
35127>>>>>                move "" to line#
35128>>>>>              end
35128>>>>>>
35128>>>>>              if (length(word#)) gt pRmargin# begin // Word IS longer that line!
35130>>>>>                repeat
35130>>>>>>
35130>>>>>                  if line# eq "" move (pRmargin#-1) to len#
35133>>>>>                  else move (pRmargin#-length(line#)-2) to len#
35135>>>>>                  move (split_word(current_object,word#,len#)) to word#
35136>>>>>                  move (ExtractItem(word#," ",1)) to left#
35137>>>>>                  move (ExtractItem(word#," ",2)) to word#
35138>>>>>                  if word# eq "" move left# to line#
35141>>>>>                  else send add_item.s (left#+"-")
35143>>>>>                until word# eq ""
35145>>>>>              end
35145>>>>>>
35145>>>>>              else move word# to line#
35147>>>>>            end
35147>>>>>>
35147>>>>>            else begin
35148>>>>>              if line# ne "" move (line#+" "+word#) to line# // add word to line
35151>>>>>              else move word# to line#
35153>>>>>            end
35153>>>>>>
35153>>>>>          end
35153>>>>>>
35153>>>>>        end
35153>>>>>>
35153>>>>>      until done#
35155>>>>>      if line# ne "" send add_item.s line#
35158>>>>>    end
35158>>>>>>
35158>>>>>  end_procedure
35159>>>>>end_class
35160>>>>>
35160>>>>>object oText_Formatter is a cText_Formatter no_image
35162>>>>>  set pSubst_below_32_state to true
35163>>>>>end_object
35164>>>>>
35164>>>>>function Text_Format.sii global string str# integer width# integer reset# returns integer
35165>>>>>  local integer obj#
35166>>>>>  move (oText_Formatter(current_object)) to obj#
35167>>>>>  if reset# send delete_data to obj#
35170>>>>>  set pRmargin of obj# to width#
35171>>>>>  send format.s to obj# str#
35172>>>>>  function_return (item_count(obj#))
35173>>>>>end_function
35174>>>>>
35174>>>>>function Text_FormattedLine.i global integer line# returns string
35175>>>>>  function_return (string_value(oText_Formatter(current_object),line#))
35176>>>>>end_function
35177>>>
35177>>>//desktop_section
35177>>>  object oGridMoveSelectedListItems is an cArray no_image
35179>>>  end_object
35180>>>//end_desktop_section
35180>>>
35180>>>//> Procedure Grid_CopySelectedListItems is meant for List objects or grid's
35180>>>//> with only one column
35180>>>procedure Grid_CopySelectedListItems global integer source_grid# integer target_grid# integer all_items# integer delete_from_source#
35181>>>  local integer max# itm# select# obj# delete_itm#
35182>>>  local string fn#
35182>>>  move (oGridMoveSelectedListItems(current_object)) to obj#
35183>>>  get item_count of source_grid# to max#
35184>>>  for itm# from 0 to (max#-1) // Copy selected items
35190>>>>
35190>>>    ifnot all_items# get select_state of source_grid# item itm# to select#
35193>>>    if (select# or all_items#) begin
35195>>>      get value of source_grid# item itm# to fn#
35196>>>      send add_item to target_grid# msg_none fn#
35197>>>      set value of obj# item (item_count(obj#)) to itm#
35198>>>    end
35198>>>>
35198>>>  loop
35199>>>>
35199>>>  if all_items# send delete_data to source_grid#
35202>>>  else begin
35203>>>    get item_count of obj# to max#
35204>>>    for_ex itm# from (max#-1) down_to 0 // Remove selected items
35211>>>      get value of obj# item itm# to delete_itm#
35212>>>      send delete_item to source_grid# delete_itm#
35213>>>    loop
35214>>>>
35214>>>  end
35214>>>>
35214>>>  send delete_data to obj#
35215>>>  send sort_items to source_grid#
35216>>>  send sort_items to target_grid#
35217>>>  set dynamic_update_state of source_grid# to true
35218>>>  set dynamic_update_state of target_grid# to true
35219>>>end_procedure
35220>>>
35220>>>//> Function Grid_Columns takes the object ID of a Grid or List
35220>>>//> object and returns the number of columns in that object.
35220>>>function Grid_Columns global integer obj# returns integer
35221>>>  local integer lw#
35222>>>  get matrix_size of obj# to lw#
35223>>>  function_return (low(lw#))
35224>>>end_function
35225>>>
35225>>>function Grid_CurrentColumn global integer obj# returns integer
35226>>>  local integer columns# ci# base#
35227>>>  get Grid_Columns obj# to columns#
35228>>>  get current_item of obj# to ci#
35229>>>  move ((ci#/columns#)*columns#) to base#
35230>>>  function_return (ci#-base#)
35231>>>end_function
35232>>>
35232>>>function Grid_BaseItem global integer obj# returns integer
35233>>>  local integer columns# ci#
35234>>>//#IFDEF IS$WINDOWS
35234>>>  get Grid_Columns obj# to columns#
35235>>>  get current_item of obj# to ci#
35236>>>  function_return ((ci#/columns#)*columns#)
35237>>>//#ELSE
35237>>>//#ENDIF
35237>>>end_function
35238>>>
35238>>>function Grid_ItemBaseItem global integer obj# integer ci# returns integer
35239>>>  local integer columns#
35240>>>  get Grid_Columns obj# to columns#
35241>>>  function_return ((ci#/columns#)*columns#)
35242>>>end_function
35243>>>
35243>>>//> Set Entry_State for all items in a Grid
35243>>>procedure Grid_SetEntryState global integer obj# integer st#
35244>>>  local integer itm# max#
35245>>>  get item_count of obj# to max#
35246>>>  for itm# from 0 to (max#-1)
35252>>>>
35252>>>    set entry_state of obj# item itm# to st#
35253>>>  loop
35254>>>>
35254>>>end_procedure
35255>>>
35255>>>//> What is the number of the base item of row row#
35255>>>function Grid_RowBaseItem global integer obj# integer row# returns integer
35256>>>  local integer columns#
35257>>>  get Grid_Columns obj# to columns#
35258>>>  function_return (row#*columns#)
35259>>>end_function
35260>>>
35260>>>//> Return the number of the row that includes the current_item
35260>>>function Grid_CurrentRow global integer obj# returns integer
35261>>>  local integer ci#
35262>>>  get current_item of obj# to ci#
35263>>>  function_return (ci#/Grid_Columns(obj#))
35264>>>end_function
35265>>>
35265>>>//> Return the number of rows currently in the Grid
35265>>>function Grid_RowCount global integer obj# returns integer
35266>>>  local integer columns#
35267>>>  get Grid_Columns obj# to columns#
35268>>>  function_return (item_count(obj#)/columns#)
35269>>>end_function
35270>>>
35270>>>procedure Grid_SwapRows global integer obj# integer row1# integer row2#
35271>>>  local integer base1# base2# itm# max#
35272>>>  local string str#
35272>>>  get Grid_RowBaseItem obj# row1# to base1#
35273>>>  get Grid_RowBaseItem obj# row2# to base2#
35274>>>  get Grid_Columns obj# to max#
35275>>>  for itm# from 0 to (max#-1)
35281>>>>
35281>>>    // value
35281>>>    get value of obj# item (base1#+itm#) to str#
35282>>>    set value of obj# item (base1#+itm#) to (value(obj#,base2#+itm#))
35283>>>    set value of obj# item (base2#+itm#) to str#
35284>>>    // entry_state
35284>>>    get entry_state of obj# item (base1#+itm#) to str#
35285>>>    set entry_state of obj# item (base1#+itm#) to (entry_state(obj#,base2#+itm#))
35286>>>    set entry_state of obj# item (base2#+itm#) to str#
35287>>>      // color
35287>>>      get itemcolor of obj# item (base1#+itm#) to str#
35288>>>      set itemcolor of obj# item (base1#+itm#) to (itemcolor(obj#,base2#+itm#))
35289>>>      set itemcolor of obj# item (base2#+itm#) to str#
35290>>>    // checkbox_item_state
35290>>>    get checkbox_item_state of obj# item (base1#+itm#) to str#
35291>>>    set checkbox_item_state of obj# item (base1#+itm#) to (checkbox_item_state(obj#,base2#+itm#))
35292>>>    set checkbox_item_state of obj# item (base2#+itm#) to str#
35293>>>    // aux_value
35293>>>    get aux_value of obj# item (base1#+itm#) to str#
35294>>>    set aux_value of obj# item (base1#+itm#) to (aux_value(obj#,base2#+itm#))
35295>>>    set aux_value of obj# item (base2#+itm#) to str#
35296>>>    // select_state
35296>>>    get select_state of obj# item (base1#+itm#) to str#
35297>>>    set select_state of obj# item (base1#+itm#) to (select_state(obj#,base2#+itm#))
35298>>>    set select_state of obj# item (base2#+itm#) to str#
35299>>>  loop
35300>>>>
35300>>>end_procedure
35301>>>
35301>>>
35301>>>// Use like this (from within a Grid object):
35301>>>//
35301>>>//   procedure MoveItemUp
35301>>>//     send Grid_SwapCurrentRowUp self
35301>>>//   end_procedure
35301>>>//   procedure MoveItemDown
35301>>>//     send Grid_SwapCurrentRowDown self
35301>>>//   end_procedure
35301>>>//   on_key key_ctrl+key_up_arrow   send MoveItemUp
35301>>>//   on_key key_ctrl+key_down_arrow send MoveItemDown
35301>>>//
35301>>>procedure Grid_SwapCurrentRowUp global integer obj#
35302>>>  local integer cr# ci#
35303>>>  get Grid_CurrentRow obj# to cr#
35304>>>  if cr# gt 0 begin
35306>>>    get Current_Item of obj# to ci#
35307>>>    send Grid_SwapRows obj# cr# (cr#-1)
35308>>>    set Current_Item of obj# to (ci#-Grid_Columns(obj#))
35309>>>  end
35309>>>>
35309>>>end_procedure
35310>>>procedure Grid_SwapCurrentRowDown global integer obj#
35311>>>  local integer cr# ci#
35312>>>  get Grid_CurrentRow obj# to cr#
35313>>>  if cr# lt (Grid_RowCount(obj#)-1) begin
35315>>>    get Current_Item of obj# to ci#
35316>>>    send Grid_SwapRows obj# cr# (cr#+1)
35317>>>    set Current_Item of obj# to (ci#+Grid_Columns(obj#))
35318>>>  end
35318>>>>
35318>>>end_procedure
35319>>>
35319>>>//desktop_section
35319>>>   Use FieldInf     // Global field info objects and abstract field types
INCLUDING FILE: FIELDINF.PKG
35319>>>>>//**********************************************************************
35319>>>>>// Use FieldInf     // Global field info objects
35319>>>>>//
35319>>>>>// By Sture Andersen
35319>>>>>//
35319>>>>>// Create:  Wed  28-01-1997
35319>>>>>// Update:  Tue  11-02-1997 - Abstract field thing added
35319>>>>>//          Thu  20-02-1997 - Register_abstract_field_label may now be
35319>>>>>//                            be used with only one argument (does nothing)
35319>>>>>//          Thu  04-03-1997 - ascii_window and date_window are now defined
35319>>>>>//                            if not already (for use with CM)
35319>>>>>//          Tue  22-04-1997 - File_Display_Name_Array added
35319>>>>>//          Tue  29-04-1997 - Changed REGISTER_FIELD_LABEL command
35319>>>>>//          Wed  04-02-1998 - Functions gl_generic_form_margin and
35319>>>>>//                            gl_generic_form_datatype added
35319>>>>>//          Fri  29-01-1999 - DataDictionary_Class property moved to here
35319>>>>>//                            from dynamo.utl.
35319>>>>>//          Wed  17-02-1999 - Class cVirtualFields added.
35319>>>>>//          Mon  15-03-1999 - DataDictionary classes are now used when
35319>>>>>//                            determining field labels
35319>>>>>//
35319>>>>>// Purpose: To provide a global mechanism for registering field labels.
35319>>>>>//          If used with APS, db-controls will automatically obtain their
35319>>>>>//          labels from here, unless they are set manually or they are
35319>>>>>//          specifically told not to.
35319>>>>>//
35319>>>>>//          The package also let's you define abstract field types for
35319>>>>>//          use with non-db controls or for overriding the definition of
35319>>>>>//          DBMS fields. A classical example of the latter is that while
35319>>>>>//          your data field is defined to have 4 decimal points you
35319>>>>>//          really want the field to display with only 3.
35319>>>>>//
35319>>>>>//          You set these global informations using the four commands
35319>>>>>//          listed here:
35319>>>>>//
35319>>>>>//      1   REGISTER_FIELD_LABEL dffile.field <field label> ;
35319>>>>>//                                   [<grid label> [<status help>]]
35319>>>>>//
35319>>>>>//      2   REGISTER_ABSTRACT_FIELD_TYPE <un-typed abstract_id> ;
35319>>>>>//                                       <length> <data_type>
35319>>>>>//
35319>>>>>//      3   MODIFY_FIELD_TYPE dffile.field <abstract_id>
35319>>>>>//
35319>>>>>//      4   REGISTER_FILE_ALIAS <master_dffile> <shadow_dffile>
35319>>>>>//
35319>>>>>//          As you can see it is possible to register status help lines.
35319>>>>>//          This was implemented since it felt to natural to do so. APS
35319>>>>>//          will make use of such registrations only if used with the
35319>>>>>//          aps.DataDictionary and only if status help has not been
35319>>>>>//          registered the standard DD way.
35319>>>>>//
35319>>>>>//
35319>>>>>// Note:    This package makes permanent use of compile-time variable J$.
35319>>>>>//          If this is in conflict with your application source it is
35319>>>>>//          easily changed since it is only referenced from within this
35319>>>>>//          file.
35319>>>>>//
35319>>>>>//**********************************************************************
35319>>>>>
35319>>>>>Use ui
35319>>>>>Use Seq_Chnl     // Defines global sequential device management operations (DAC)
35319>>>>>Use Array.utl    // Item_Property command
35319>>>>>Use Macros.utl   // Various macros (DESKTOP_SECTION)
35319>>>>>
35319>>>>>class cFieldInfoStuff is an array
35320>>>>>  function array_id.i integer file# returns integer
35321>>>>>    local integer rval#
35322>>>>>    get value item file# to rval#
35323>>>>>    ifnot rval# begin
35325>>>>>      object fldinf.array is an array
35327>>>>>        move current_object to rval#
35328>>>>>      end_object
35329>>>>>      set value item file# to rval#
35330>>>>>    end
35330>>>>>>
35330>>>>>    function_return rval#
35331>>>>>  end_function
35332>>>>>  procedure set string_value.ii integer file# integer field# string str#
35333>>>>>    set value of (array_id.i(current_object,file#)) item field# to str#
35334>>>>>  end_procedure
35335>>>>>  function string_value.ii integer file# integer field# returns string
35336>>>>>    local integer arr#
35337>>>>>    get value item file# to arr#
35338>>>>>    if arr# function_return (value(arr#,field#))
35341>>>>>    function_return ""
35342>>>>>  end_function
35343>>>>>  procedure set integer_value.ii integer file# integer field# integer int#
35344>>>>>    set value of (array_id.i(current_object,file#)) item field# to int#
35345>>>>>  end_procedure
35346>>>>>  function integer_value.ii integer file# integer field# returns integer
35347>>>>>    local integer arr#
35348>>>>>    get value item file# to arr#
35349>>>>>    if arr# function_return (value(arr#,field#))
35352>>>>>    function_return 0
35353>>>>>  end_function
35354>>>>>
35354>>>>>  //> The purpose of the make_alias procedure is to redirect references
35354>>>>>  //> to file number <alias#> refer to file number <master#> instead.
35354>>>>>  procedure make_alias integer master# integer alias#
35355>>>>>    local integer master_arr#
35356>>>>>    get array_id.i master# to master_arr#
35357>>>>>    set value item alias# to master_arr#
35358>>>>>  end_procedure
35359>>>>>end_class
35360>>>>>
35360>>>>>integer field_labels_array#  grid_labels_array# status_help_array#
35360>>>>>integer form_datatype_array# form_margin_array# abstract_array#
35360>>>>>
35360>>>>>object field_labels_array is a cFieldInfoStuff
35362>>>>>  move current_object to field_labels_array#
35363>>>>>end_object
35364>>>>>object grid_labels_array is a cFieldInfoStuff
35366>>>>>  move current_object to grid_labels_array#
35367>>>>>end_object
35368>>>>>object status_help_array is a cFieldInfoStuff
35370>>>>>  move current_object to status_help_array#
35371>>>>>end_object
35372>>>>>object form_datatype_array is a cFieldInfoStuff
35374>>>>>  move current_object to form_datatype_array#
35375>>>>>end_object
35376>>>>>object form_margin_array is a cFieldInfoStuff
35378>>>>>  move current_object to form_margin_array#
35379>>>>>end_object
35380>>>>>object abtract_array is a cFieldInfoStuff
35382>>>>>  // If a DBMS field (file,field) has an entry in this array it means
35382>>>>>  // that its corresponding form_datatype and form_margin should be
35382>>>>>  // looked up in the other arrays rather than using its original values.
35382>>>>>  move current_object to abstract_array#
35383>>>>>end_object
35384>>>>>object capslocked_array is a cFieldInfoStuff
35386>>>>>//  move current_object to abstract_array#
35386>>>>>end_object
35387>>>>>
35387>>>>>// Prefix "gl_" means "global"
35387>>>>>function gl_field_label for desktop integer file# integer field# returns string
35388>>>>>  local string rval#
35389>>>>>  move (string_value.ii(field_labels_array#,file#,field#)) to rval#
35390>>>>>  if rval# eq "" begin
35392>>>>>    get_attribute df_field_name of file# field# to rval#
35395>>>>>    move (replaces("_",rval#," ")) to rval#
35396>>>>>    move (lowercase(rval#)) to rval#
35397>>>>>    move (overstrike(uppercase(left(rval#,1)),rval#,1)) to rval#
35398>>>>>    set string_value.ii of field_labels_array# file# field# to rval#
35399>>>>>  end
35399>>>>>>
35399>>>>>  function_return rval#
35400>>>>>end_function
35401>>>>>function gl_grid_label for desktop integer file# integer field# returns string
35402>>>>>  local string rval#
35403>>>>>  move (string_value.ii(grid_labels_array#,file#,field#)) to rval#
35404>>>>>  if rval# eq "" begin
35406>>>>>    get_attribute df_field_name of file# field# to rval#
35409>>>>>    move (replaces("_",rval#," ")) to rval#
35410>>>>>    move (lowercase(rval#)) to rval#
35411>>>>>    move (overstrike(uppercase(left(rval#,1)),rval#,1)) to rval#
35412>>>>>    set string_value.ii of grid_labels_array# file# field# to rval#
35413>>>>>  end
35413>>>>>>
35413>>>>>  function_return rval#
35414>>>>>end_function
35415>>>>>function gl_status_help for desktop integer file# integer field# returns string
35416>>>>>  function_return (string_value.ii(status_help_array#,file#,field#))
35417>>>>>end_function
35418>>>>>function gl_datatype for desktop integer file# integer field# returns integer
35419>>>>>  function_return (integer_value.ii(form_datatype_array#,file#,field#))
35420>>>>>end_function
35421>>>>>function gl_margin for desktop integer file# integer field# returns integer
35422>>>>>  function_return (integer_value.ii(form_margin_array#,file#,field#))
35423>>>>>end_function
35424>>>>>function gl_abstract for desktop integer file# integer field# returns integer
35425>>>>>  function_return (integer_value.ii(abstract_array#,file#,field#))
35426>>>>>end_function
35427>>>>>
35427>>>>>
35427>>>>>// REGISTER_FIELD_LABEL dffile.field <field label> ;
35427>>>>>//                              [<grid label> [<status help>]]
35427>>>>>
35427>>>>>
35427>>>>>
35427>>>>>//  REGISTER_ABSTRACT_FIELD_TYPE <un-typed name> ;
35427>>>>>//                                            <margin> <data_type>
35427>>>>>
35427>>>>>
35427>>>>>
35427>>>>>//  REGISTER_ABSTRACT_FIELD_LABEL <previously un-typed name> ;
35427>>>>>//                             <field label> [<grid label> [<status help>]]
35427>>>>>//
35427>>>>>//  Registrations done with the REGISTER_ABSTRACT_FIELD_LABEL are not
35427>>>>>//  currently used by APS
35427>>>>>
35427>>>>>
35427>>>>>
35427>>>>>//  MODIFY_FIELD_TYPE dffile.field <abstract_id>
35427>>>>>
35427>>>>>
35427>>>>>//  REGISTER_FILE_ALIAS <master_dffile> <shadow_dffile>
35427>>>>>
35427>>>>>
35427>>>>>
35427>>>>>  function gl_generic_form_datatype global integer file# integer field# returns integer
35428>>>>>    local integer type# rval#
35429>>>>>    get_attribute DF_FIELD_TYPE of file# field# to type#
35432>>>>>    if type# eq DF_ASCII function_return ascii_window
35435>>>>>    if type# eq DF_DATE  function_return date_window
35438>>>>>    if type# eq DF_BCD begin
35440>>>>>      get_attribute DF_FIELD_PRECISION of file# field# to rval#
35443>>>>>      function_return rval#
35444>>>>>    end
35444>>>>>>
35444>>>>>    function_return ascii_window // DF_OVERLAP DF_TEXT DF_BINARY
35445>>>>>  end_function
35446>>>>>
35446>>>>>  function gl_generic_form_margin global integer file# integer field# returns integer
35447>>>>>    local integer datatype# len#
35448>>>>>    move (gl_generic_form_datatype(file#,field#)) to datatype#
35449>>>>>    if datatype# eq date_window function_return 10
35452>>>>>    get_attribute DF_FIELD_LENGTH of file# field# to len#
35455>>>>>    if datatype# eq ascii_window function_return len#
35458>>>>>    function_return (len#+1) // Room for comma
35459>>>>>  end_function
35460>>>>>
35460>>>>>  function gl_effective_form_datatype global integer file# integer field# returns integer
35461>>>>>    local integer abstract#
35462>>>>>    get gl_abstract file# field# to abstract#
35463>>>>>    if abstract# function_return (gl_datatype(current_object,0,abstract#))
35466>>>>>    function_return (gl_generic_form_datatype(file#,field#))
35467>>>>>  end_function
35468>>>>>  function gl_effective_form_margin global integer file# integer field# returns integer
35469>>>>>    local integer rval#
35470>>>>>    get gl_margin file# field# to rval#
35471>>>>>    if rval# function_return rval#
35474>>>>>    function_return (gl_generic_form_margin(file#,field#))
35475>>>>>  end_function
35476>>>>>
35476>>>>>register_abstract_field_type aft_ascii2       2 ascii_window
35478>>>>>register_abstract_field_type aft_ascii3       3 ascii_window
35480>>>>>register_abstract_field_type aft_ascii4       4 ascii_window
35482>>>>>register_abstract_field_type aft_ascii5       5 ascii_window
35484>>>>>register_abstract_field_type aft_ascii6       6 ascii_window
35486>>>>>register_abstract_field_type aft_ascii10     10 ascii_window
35488>>>>>register_abstract_field_type aft_ascii15     15 ascii_window
35490>>>>>register_abstract_field_type aft_ascii20     20 ascii_window
35492>>>>>register_abstract_field_type aft_ascii25     25 ascii_window
35494>>>>>register_abstract_field_type aft_ascii30     30 ascii_window
35496>>>>>register_abstract_field_type aft_ascii35     35 ascii_window
35498>>>>>register_abstract_field_type aft_ascii40     40 ascii_window
35500>>>>>register_abstract_field_type aft_ascii50     50 ascii_window
35502>>>>>register_abstract_field_type aft_ascii80     80 ascii_window
35504>>>>>register_abstract_field_type aft_numeric1.2   4 2 // Length 4, 2 decimal points
35506>>>>>register_abstract_field_type aft_numeric2.0   2 0 // Length 2, 0 decimal points
35508>>>>>register_abstract_field_type aft_numeric2.1   4 1 // Length 4, 1 decimal points
35510>>>>>register_abstract_field_type aft_numeric2.2   4 2 // Length 4, 1 decimal points
35512>>>>>register_abstract_field_type aft_numeric3.0   3 0 // Length 3, 0 decimal points
35514>>>>>register_abstract_field_type aft_numeric4.0   4 0 // Length 4, 0 decimal points
35516>>>>>register_abstract_field_type aft_numeric4.2   7 2 // Length 7, 2 decimal points
35518>>>>>register_abstract_field_type aft_numeric6.0   6 0 // Length 6, 0 decimal points
35520>>>>>register_abstract_field_type aft_numeric8.0   8 0 // Length 8, 0 decimal points
35522>>>>>register_abstract_field_type aft_numeric10.0 10 0 // Length 10, 0 decimal points
35524>>>>>register_abstract_field_type aft_date        10 date_window
35526>>>>>register_abstract_field_type aft_boolean      1 0
35528>>>>>
35528>>>>>
35528>>>>>// An extra feature allows specifying a replacement to the user display name
35528>>>>>// of files (df_File_Display_Name). APS makes no use of such registrations.
35528>>>>>//
35528>>>>>//   REGISTER_FILE_DISPLAY_NAME dffile <string>
35528>>>>>
35528>>>>>desktop_section
35533>>>>> object File_Display_Name_Array is an array
35535>>>>> end_object
35536>>>>>end_desktop_section
35538>>>>>procedure set File_Display_Name global integer file# string name#
35539>>>>>  set value of (File_Display_Name_Array(current_object)) item file# to name#
35540>>>>>end_procedure
35541>>>>>function File_Display_Name global integer file# returns string
35542>>>>>  local string rval#
35543>>>>>  move (value(File_Display_Name_Array(current_object),file#)) to rval#
35544>>>>>  if rval# eq "" begin
35546>>>>>    get_attribute df_File_Display_Name of file# to rval#
35549>>>>>    set File_Display_Name file# to rval#
35550>>>>>  end
35550>>>>>>
35550>>>>>  function_return rval#
35551>>>>>end_function
35552>>>>>
35552>>>>>
35552>>>>>// In order for the aps_ObjectDynamo class to be able to use the
35552>>>>>// generic DD-classes a few lines is needed that will allow us to
35552>>>>>// register which classes to use when creating DDO's for the various
35552>>>>>// data files.
35552>>>>>//
35552>>>>>// Use like this:
35552>>>>>//
35552>>>>>//   set DataDictionary_Class OrderHdr.file_number to U_OrderHdr_DD
35552>>>>>//
35552>>>>>
35552>>>>>desktop_section
35557>>>>> object oDataDictionary_Class_Array is an array
35559>>>>> end_object
35560>>>>>end_desktop_section
35562>>>>>function DataDictionary_Class global integer file# returns integer
35563>>>>>  function_return (value(oDataDictionary_Class_Array(current_object),file#))
35564>>>>>end_function
35565>>>>>procedure set DataDictionary_Class global integer file# integer class#
35566>>>>>  set value of (oDataDictionary_Class_Array(current_object)) item file# to class#
35567>>>>>end_procedure
35568>>>>>
35568>>>>>desktop_section
35573>>>>> object oDataDictionary_Object_Array is an array
35575>>>>> end_object
35576>>>>>end_desktop_section
35578>>>>>function DataDictionary_Object global integer file# returns integer
35579>>>>>  function_return (value(oDataDictionary_Object_Array(current_object),file#))
35580>>>>>end_function
35581>>>>>procedure set DataDictionary_Object global integer file# integer obj#
35582>>>>>  set value of (oDataDictionary_Object_Array(current_object)) item file# to obj#
35583>>>>>end_procedure
35584>>>>>
35584>>>>>function iDD_Object global integer file# returns integer
35585>>>>>  local integer rval# class# current_object#
35586>>>>>  get DataDictionary_Object file# to rval#
35587>>>>>  ifnot rval# begin
35589>>>>>    get DataDictionary_Class file# to class#
35590>>>>>    if class# begin
35592>>>>>      name class# U_fieldinf_class             // Cannot be understoodÄÄÄÄÄ¿
35592>>>>>      move current_object to current_object#   // Push current_object       ³
35593>>>>>      move desktop to current_object           // Create at desktop         ³
35594>>>>>      object dynamo_object is a fieldinf_class // Create an object of classÄÙ
35596>>>>>        move current_object to rval#           // Get the object ID to rval#
35597>>>>>      end_object                               //
35598>>>>>      move current_object# to current_object   // Pop current_object
35599>>>>>      set DataDictionary_Object file# to rval# // Register the new object
35600>>>>>    end
35600>>>>>>
35600>>>>>  end
35600>>>>>>
35600>>>>>  function_return rval#
35601>>>>>end_function
35602>>>>>
35602>>>>>class cVirtualFields is an array
35603>>>>>  procedure construct_object integer img#
35604>>>>>    forward send construct_object img#
35606>>>>>    set delegation_mode to delegate_to_parent
35607>>>>>    property integer pMainFile              public 0
35608>>>>>    property integer private.pCurrentRecord public -1
35609>>>>>    property string  pUserName              public "Un-named"
35610>>>>>  end_procedure
35611>>>>>  item_property_list
35611>>>>>    item_property integer piFieldActive.i
35611>>>>>    item_property string  psFieldLabel.i
35611>>>>>    item_property string  psFieldLabel_Short.i
35611>>>>>    item_property integer piFieldType.i
35611>>>>>    item_property integer piFieldLength.i
35611>>>>>    item_property integer piFieldDecPoint.i
35611>>>>>    item_property integer piFieldCapslock.i
35611>>>>>    item_property integer piFieldLoadMessage.i
35611>>>>>    item_property integer piFieldLoadObject.i
35611>>>>>    item_property string  psFieldValue.i
35611>>>>>    item_property integer piFieldDirty.i
35611>>>>>  end_item_property_list cVirtualFields // When in class, class neame must be repeated here
35695>>>>>  procedure SetAllFieldsDirty integer state#
35696>>>>>    local integer max# field#
35697>>>>>    get row_count to max#
35698>>>>>    for field# from 0 to (max#-1)
35704>>>>>>
35704>>>>>      set piFieldDirty.i field# to state#
35705>>>>>    loop
35706>>>>>>
35706>>>>>  end_procedure
35707>>>>>  procedure set pCurrentRecord integer rec#
35708>>>>>    local integer field# prev_rec#
35709>>>>>    get private.pCurrentRecord to prev_rec#
35710>>>>>    if rec# ne prev_rec# send SetAllFieldsDirty dftrue
35713>>>>>    set private.pCurrentRecord to prev_rec#
35714>>>>>  end_procedure
35715>>>>>  function pCurrentRecord returns integer
35716>>>>>    function_return (private.pCurrentRecord(current_object))
35717>>>>>  end_function
35718>>>>>  procedure LoadFieldValue integer field#
35719>>>>>    local integer get# obj#
35720>>>>>    local string str#
35720>>>>>    get piFieldLoadMessage.i field# to get#
35721>>>>>    get piFieldLoadObject.i  field# to obj#
35722>>>>>    if obj# get get# of obj# to str#
35725>>>>>    else get get# to str#
35727>>>>>    set psFieldValue.i field# to str#
35728>>>>>    set piFieldDirty.i field# to dffalse
35729>>>>>  end_procedure
35730>>>>>  procedure CheckCurrentRecord
35731>>>>>    local integer file# rec#
35732>>>>>    get pMainFile to file#
35733>>>>>    if file# begin
35735>>>>>      get_field_value file# 0 to rec#
35738>>>>>      if rec# ne (private.pCurrentRecord(current_object)) set pCurrentRecord to rec#
35741>>>>>    end
35741>>>>>>
35741>>>>>  end_procedure
35742>>>>>  function sFieldValue.i integer field# returns string
35743>>>>>    send CheckCurrentRecord
35744>>>>>    if (piFieldDirty.i(current_object,field#)) send LoadFieldValue field#
35747>>>>>    function_return (psFieldValue.i(current_object,field#))
35748>>>>>  end_function
35749>>>>>  procedure define_field integer field# string Label# string Label_Short# integer Type# integer Length# integer DecPoint# integer LoadMessage# integer LoadObjectTmp#
35750>>>>>    local integer LoadObject#
35751>>>>>    if num_arguments gt 7 move LoadObjectTmp# to LoadObject#
35754>>>>>    else move 0 to LoadObject#
35756>>>>>    set psFieldLabel.i field# to Label#
35757>>>>>
35757>>>>>    if Label_Short# ne "" ;         set psFieldLabel_Short.i field# to Label_Short#
35760>>>>>    else set psFieldLabel_Short.i field# to Label#
35762>>>>>
35762>>>>>    set piFieldType.i        field# to Type#
35763>>>>>    set piFieldLength.i      field# to Length#
35764>>>>>    set piFieldDecPoint.i    field# to DecPoint#
35765>>>>>    set piFieldLoadMessage.i field# to LoadMessage#
35766>>>>>    set piFieldLoadObject.i  field# to LoadObject#
35767>>>>>    set piFieldDirty.i       field# to dftrue
35768>>>>>    set piFieldActive.i      field# to dftrue
35769>>>>>    set piFieldCapslock.i    field# to dffalse
35770>>>>>  end_procedure
35771>>>>>end_class
35772>>>>>
35772>>>>>integer oFieldInf_VitualFields#
35772>>>>>object oFieldInf_VitualFields is an array
35774>>>>>  move current_object to oFieldInf_VitualFields#
35775>>>>>end_object
35776>>>>>
35776>>>>>function FieldInf_VirtualFields_Object global integer file# returns integer
35777>>>>>  function_return (value(oFieldInf_VitualFields#,file#))
35778>>>>>end_function
35779>>>>>procedure set FieldInf_VirtualFields_Object global integer file# integer value#
35780>>>>>  set value of (oFieldInf_VitualFields#) item file# to value#
35781>>>>>end_procedure
35782>>>>>
35782>>>>>function FieldInf_FieldType global integer file# integer field# returns integer
35783>>>>>  local integer fieldtype#
35784>>>>>  if field# lt 256 get_attribute DF_FIELD_TYPE of file# field# to fieldtype#
35789>>>>>  else move (piFieldType.i(FieldInf_VirtualFields_Object(file#),field#-256)) to fieldtype#
35791>>>>>  function_return fieldtype#
35792>>>>>end_function
35793>>>>>function FieldInf_FieldValue global integer file# integer field# returns string
35794>>>>>  local integer fi# fn#
35795>>>>>  local string rval#
35795>>>>>  move fieldindex to fi#
35796>>>>>  move fieldnumber to fn#
35797>>>>>  if field# lt 256 get_field_value file# field# to rval#
35802>>>>>  else move (sFieldValue.i(FieldInf_VirtualFields_Object(file#),field#-256)) to rval#
35804>>>>>  move fi#  to fieldindex
35805>>>>>  move fn# to fieldnumber
35806>>>>>  function_return rval#
35807>>>>>end_function
35808>>>>>function FieldInf_DecPoints global integer file# integer field# returns string
35809>>>>>  local integer rval#
35810>>>>>//  if field# lt 256 get_attribute DF_FIELD_PRECISION of file# field# to rval#
35810>>>>>  if field# lt 256 get gl_effective_form_datatype file# field# to rval#
35813>>>>>  else move (piFieldDecPoint.i(FieldInf_VirtualFields_Object(file#),field#-256)) to rval#
35815>>>>>  function_return rval#
35816>>>>>end_function
35817>>>>>function FieldInf_FieldLabel_Long global integer file# integer field# returns string
35818>>>>>  local integer dd#
35819>>>>>  local string rval#
35819>>>>>  move (string_value.ii(field_labels_array#,file#,field#)) to rval#
35820>>>>>  if field# lt 256 begin
35822>>>>>    if rval# eq "" begin // No global label was assigned
35824>>>>>        get iDD_Object file# to dd#
35825>>>>>        if dd# get Field_Label_Long of dd# field# to rval#
35828>>>>>        if rval# eq "" get gl_field_label file# field# to rval#
35831>>>>>    end
35831>>>>>>
35831>>>>>  end
35831>>>>>>
35831>>>>>  else move (psFieldLabel.i(FieldInf_VirtualFields_Object(file#),field#-256)) to rval#
35833>>>>>  function_return rval#
35834>>>>>end_function
35835>>>>>function FieldInf_FieldLabel_Short global integer file# integer field# returns string
35836>>>>>  local integer dd#
35837>>>>>  local string rval#
35837>>>>>  if field# lt 256 begin
35839>>>>>    move (string_value.ii(grid_labels_array#,file#,field#)) to rval#
35840>>>>>    if rval# eq "" begin // No global label was assigned
35842>>>>>        get iDD_Object file# to dd#
35843>>>>>        if dd# get Field_Label_Short of dd# field# to rval#
35846>>>>>        if rval# eq "" get gl_grid_label file# field# to rval#
35849>>>>>    end
35849>>>>>>
35849>>>>>  end
35849>>>>>>
35849>>>>>  else move (psFieldLabel_Short.i(FieldInf_VirtualFields_Object(file#),field#-256)) to rval#
35851>>>>>  function_return rval#
35852>>>>>end_function
35853>>>   object oGridPrepare is a cArray
35855>>>     property integer piNextPrevious public 1
35857>>>     item_property_list
35857>>>       item_property string  psHeaderLabel.i
35857>>>       item_property integer piAbstractOrFile.i
35857>>>       item_property integer piField.i
35857>>>     end_item_property_list
35902>>>     procedure add_column string label# integer abstract# integer field#
35904>>>       local integer row#
35905>>>       get row_count to row#
35906>>>       set psHeaderLabel.i row# to label#
35907>>>       set piAbstractOrFile.i row# to abstract#
35908>>>       set piField.i row# to field#
35909>>>     end_procedure
35910>>>     procedure reset
35912>>>       send delete_data
35913>>>       set piNextPrevious to 1
35914>>>     end_procedure
35915>>>     procedure apply_settings integer obj# integer DoColor#
35917>>>       local integer row# max#
35918>>>       get row_count to max#
35919>>>       set line_width of obj# to max# 0
35920>>>       for row# from 0 to (max#-1)
35926>>>>
35926>>>         set header_label of obj# row# to (psHeaderLabel.i(current_object,row#))
35927>>>         if (piField.i(current_object,row#)) eq -1 ;           set form_margin of obj# row# to (integer_value.ii(form_margin_array#,0,piAbstractOrFile.i(current_object,row#)))
35930>>>         else set form_margin of obj# row# to (gl_effective_form_margin(piAbstractOrFile.i(current_object,row#),piField.i(current_object,row#)))
35932>>>       loop
35933>>>>
35933>>>       set select_mode of obj# to no_select
35934>>>       if DoColor# begin
35936>>>         set highlight_row_state of obj# to true
35937>>>         set highlight_row_color of obj# to (rgb(0,255,255))
35938>>>         set current_item_color of obj# to (rgb(0,255,255))
35939>>>       end
35939>>>>
35939>>>       if (piNextPrevious(current_object)) begin
35941>>>         move current_object to max# // Overload
35942>>>         move obj# to current_object
35943>>>         on_key knext_item send switch
35944>>>         on_key kprevious_item send switch_back
35945>>>         move max# to current_object
35946>>>       end
35946>>>>
35946>>>     end_procedure
35947>>>   end_object // oGridPrepare
35948>>>   procedure GridPrepare_Reset global
35949>>>     send reset to (oGridPrepare(current_object))
35950>>>   end_procedure
35951>>>   procedure GridPrepare_AddCheckBoxColumn global
35952>>>     send add_column to (oGridPrepare(current_object)) "" AFT_ASCII3 -1
35953>>>   end_procedure
35954>>>   procedure GridPrepare_AddColumn global string label# integer abstract#
35955>>>     send add_column to (oGridPrepare(current_object)) label# abstract# -1
35956>>>   end_procedure
35957>>>   procedure GridPrepare_AddColumnFileField global string label# integer file# integer field#
35958>>>     send add_column to (oGridPrepare(current_object)) label# file# field#
35959>>>   end_procedure
35960>>>   procedure GridPrepare_Apply global integer obj# integer DoColor#
35961>>>     local integer tmp#
35962>>>     if num_arguments gt 1 move DoColor# to tmp#
35965>>>     else move 1 to tmp#
35967>>>     send apply_settings to (oGridPrepare(current_object)) obj# tmp#
35968>>>     send GridPrepare_Reset
35969>>>   end_procedure
35970>>>  // Here is a temporary array used for storing different values while
35970>>>  // a grid is being sorted.
35970>>>  object oSortGrid_Data is a cArray no_image
35972>>>    property integer piCurrentGridID public 0 // Not used
35974>>>    property integer piCurrentRow    public 0
35976>>>    property integer piCurrentColumn public 0
35978>>>    object oSortedData is a cArray no_image
35980>>>    end_object
35981>>>    object oAuxValues is a cArray no_image
35983>>>    end_object
35984>>>    object oEntryStates is a cArray no_image
35986>>>    end_object
35987>>>    object oSelectStates is a cArray no_image
35989>>>    end_object
35990>>>     object oItemColors is a cArray no_image
35992>>>     end_object
35993>>>    object oCheckboxItemStates is a cArray no_image
35995>>>    end_object
35996>>>    // Get data out of the grid to this structure
35996>>>    procedure reset
35998>>>      send delete_data
35999>>>      send delete_data to (oAuxValues(current_object))
36000>>>      send delete_data to (oSortedData(current_object))
36001>>>      send delete_data to (oEntryStates(current_object))
36002>>>      send delete_data to (oSelectStates(current_object))
36003>>>      send delete_data to (oCheckboxItemStates(current_object))
36004>>>    //send delete_data to (oMessages(current_object))
36004>>>      send delete_data to (oItemColors(current_object))
36005>>>      set piCurrentGridID to 0
36006>>>      set piCurrentRow to 0
36007>>>      set piCurrentColumn to 0
36008>>>    end_procedure
36009>>>    // Get data from grid
36009>>>    procedure load_grid_data integer oGrd#
36011>>>      local integer max# itm# AuxValues# EntryStates# ci# cc# columns#
36012>>>      local integer SelectStates# CheckboxItemStates# ItemColors#
36012>>>      move (oAuxValues(current_object)) to AuxValues#
36013>>>      move (oEntryStates(current_object)) to EntryStates#
36014>>>      move (oSelectStates(current_object)) to SelectStates#
36015>>>      move (oCheckboxItemStates(current_object)) to CheckboxItemStates#
36016>>>      move (oItemColors(current_object)) to ItemColors#
36017>>>      send delete_data
36018>>>      send delete_data to AuxValues#
36019>>>      send delete_data to EntryStates#
36020>>>      send delete_data to SelectStates#
36021>>>      send delete_data to CheckboxItemStates#
36022>>>      send delete_data to ItemColors#
36023>>>      set piCurrentGridID to oGrd#
36024>>>      get item_count of oGrd# to max#
36025>>>      for itm# from 0 to (max#-1)
36031>>>>
36031>>>        set value item itm# to (value(oGrd#,itm#))
36032>>>        set value of AuxValues# item itm# to (aux_value(oGrd#,itm#))
36033>>>        set value of EntryStates# item itm# to (entry_state(oGrd#,itm#))
36034>>>        set value of SelectStates# item itm# to (select_state(oGrd#,itm#))
36035>>>        set value of CheckboxItemStates# item itm# to (checkbox_item_state(oGrd#,itm#))
36036>>>        set value of ItemColors# item itm# to (ItemColor(oGrd#,itm#))
36037>>>      loop
36038>>>>
36038>>>      get current_item of oGrd# to ci#
36039>>>      get Grid_Columns oGrd# to columns#
36040>>>      set piCurrentRow    to (ci#/columns#)
36041>>>      set piCurrentColumn to (ci#-(columns#*piCurrentRow(current_object)))
36042>>>    end_procedure
36043>>>    register_function iSpecialSortValueOnColumn.i integer column# returns integer
36043>>>    register_function sSortValue.ii integer column# integer itm# returns string
36043>>>    procedure sort_data integer oGrd# integer column#
36045>>>      local integer sort_arr# row# max# columns# itm# st# custom#
36046>>>      local string value#
36046>>>      move (oSortedData(current_object)) to sort_arr#
36047>>>      send delete_data to sort_arr#
36048>>>      get Grid_Columns oGrd# to columns#
36049>>>      get item_count of oGrd# to max#
36050>>>      get delegation_mode of oGrd# to st#
36051>>>      set delegation_mode of oGrd# to NO_DELEGATE_OR_ERROR
36052>>>      get iSpecialSortValueOnColumn.i of oGrd# column# to custom#
36053>>>      set delegation_mode of oGrd# to st#
36054>>>      move (max#/columns#) to max# // Number of rows#
36055>>>      for row# from 0 to (max#-1)
36061>>>>
36061>>>        move (row#*columns#+column#) to itm#
36062>>>        if custom# get sSortValue.ii of oGrd# column# itm# to value#
36065>>>        else get value of oGrd# item itm# to value#
36067>>>        move (value#+IntToStrR(row#,6)) to value#
36068>>>        set value of sort_arr# item row# to value#
36069>>>      loop
36070>>>>
36070>>>      send sort_items to sort_arr# //ASCENDING
36071>>>    end_procedure
36072>>>    procedure fill_grid integer oGrd#
36074>>>      local integer sort_arr# row# max# itm# columns# itm_min# itm_max# cr#
36075>>>      local integer grid_row#
36075>>>      local integer EntryStates# AuxValues# grid_itm#
36075>>>      local integer SelectStates# CheckboxItemStates# ItemColors#
36075>>>      local string value#
36075>>>      move (oSortedData(current_object)) to sort_arr#
36076>>>      move (oAuxValues(current_object)) to AuxValues#
36077>>>      move (oEntryStates(current_object)) to EntryStates#
36078>>>      move (oSelectStates(current_object)) to SelectStates#
36079>>>      move (oCheckboxItemStates(current_object)) to CheckboxItemStates#
36080>>>      move (oItemColors(current_object)) to ItemColors#
36081>>>      send delete_data to oGrd#
36082>>>      get Grid_Columns oGrd# to columns#
36083>>>      get item_count of sort_arr# to max#
36084>>>      get piCurrentRow to cr#
36085>>>      move 0 to grid_itm#
36086>>>      for row# from 0 to (max#-1)
36092>>>>
36092>>>        move (right(value(sort_arr#,row#),6)) to grid_row#
36093>>>        if grid_row# eq cr# set piCurrentRow to row#
36096>>>        move (grid_row#*columns#) to itm_min#
36097>>>        move (itm_min#+columns#-1) to itm_max#
36098>>>        for itm# from itm_min# to itm_max#
36104>>>>
36104>>>          send add_item to oGrd# msg_none (value(current_object,itm#))
36105>>>          set checkbox_item_state of oGrd# item grid_itm# to (value(CheckboxItemStates#,itm#))
36106>>>          set select_state of oGrd# item grid_itm# to (value(SelectStates#,itm#))
36107>>>          set aux_value of oGrd# item grid_itm# to (value(AuxValues#,itm#))
36108>>>          set entry_state of oGrd# item grid_itm# to (value(EntryStates#,itm#))
36109>>>          set itemcolor of oGrd# item grid_itm# to (value(ItemColors#,itm#))
36110>>>          increment grid_itm#
36111>>>        loop
36112>>>>
36112>>>      loop
36113>>>>
36113>>>    end_procedure
36114>>>    procedure Sort_Grid integer oGrd# integer column#
36116>>>      local integer cr# cc# columns#
36117>>>       send cursor_wait to (cursor_control(current_object))
36118>>>      set dynamic_update_state of oGrd# to false
36119>>>      send reset
36120>>>      send load_grid_data oGrd#
36121>>>      send sort_data oGrd# column#
36122>>>      send fill_grid oGrd#
36123>>>      set dynamic_update_state of oGrd# to true
36124>>>      get piCurrentRow to cr#
36125>>>      get piCurrentColumn to cc#
36126>>>      get Grid_Columns oGrd# to columns#
36127>>>      set current_item of oGrd# to (columns#*cr#+cc#)
36128>>>      send reset
36129>>>       send cursor_ready to (cursor_control(current_object))
36130>>>    end_procedure
36131>>>  end_object // oSortGrid_Data
36132>>>//end_desktop_section
36132>>>
36132>>>procedure Grid_SortByColumn global integer oGrd# integer column#
36133>>>  send Sort_Grid to (oSortGrid_Data(current_object)) oGrd# column#
36134>>>end_procedure
36135>>>
36135>>>procedure Grid_AddCheckBoxItem global integer oGrd# integer iState
36136>>>  local integer iItm
36137>>>  get item_count of oGrd# to iItm
36138>>>  send add_item to oGrd# msg_none ""
36139>>>  set checkbox_item_state of oGrd# item iItm to DFTRUE
36140>>>  set select_state of oGrd# item iItm to iState
36141>>>end_procedure
36142>>>procedure Grid_RowMakeSelectable global integer oGrd#
36143>>>end_procedure
36144>>>procedure Grid_RowSelectAll global integer oGrd#
36145>>>  local integer iRow iMax
36146>>>  get Grid_RowCount oGrd# to iMax
36147>>>  decrement iMax
36148>>>  for iRow from 0 to iMax
36154>>>>
36154>>>    set select_state of oGrd# item (Grid_RowBaseItem(oGrd#,iRow)) to DFTRUE
36155>>>  loop
36156>>>>
36156>>>end_procedure
36157>>>procedure Grid_RowDeselectAll global integer oGrd#
36158>>>  local integer iRow iMax
36159>>>  get Grid_RowCount oGrd# to iMax
36160>>>  decrement iMax
36161>>>  for iRow from 0 to iMax
36167>>>>
36167>>>    set select_state of oGrd# item (Grid_RowBaseItem(oGrd#,iRow)) to DFFALSE
36168>>>  loop
36169>>>>
36169>>>end_procedure
36170>>>procedure Grid_RowSelectInvert global integer oGrd#
36171>>>  local integer iRow iMax iSelect iBase
36172>>>  get Grid_RowCount oGrd# to iMax
36173>>>  decrement iMax
36174>>>  for iRow from 0 to iMax
36180>>>>
36180>>>    move (Grid_RowBaseItem(oGrd#,iRow)) to iBase
36181>>>    get select_state of oGrd# item iBase to iSelect
36182>>>    set select_state of oGrd# item iBase to (not(iSelect))
36183>>>  loop
36184>>>>
36184>>>end_procedure
36185>>>procedure Grid_RowSelectCostum global integer oGrd# integer iGet
36186>>>  local integer iRow iMax iSelect iBase
36187>>>  get Grid_RowCount oGrd# to iMax
36188>>>  decrement iMax
36189>>>  for iRow from 0 to iMax
36195>>>>
36195>>>    move (Grid_RowBaseItem(oGrd#,iRow)) to iBase
36196>>>    get iGet of oGrd# iRow iBase to iSelect
36197>>>    set select_state of oGrd# item iBase to iSelect
36198>>>  loop
36199>>>>
36199>>>end_procedure
36200>>>procedure Grid_RowCallBackSelected global integer oGrd# integer iMsg
36201>>>  local integer iRow iMax iBase iSelect
36202>>>  get Grid_RowCount oGrd# to iMax
36203>>>  decrement iMax
36204>>>  for iRow from 0 to iMax
36210>>>>
36210>>>    move (Grid_RowBaseItem(oGrd#,iRow)) to iBase
36211>>>    get select_state of oGrd# item iBase to iSelect
36212>>>    if iSelect send iMsg to oGrd# iRow iBase
36215>>>  loop
36216>>>>
36216>>>end_procedure
36217>>>
36217>>>// procedure row_change integer iRowFrom integer iRowTo
36217>>>// end_procedure
36217>>>// procedure item_change integer iItm1 integer iItm2 returns integer
36217>>>//   local integer iRval iColumns
36217>>>//   get Grid_Columns current_object to iColumns
36217>>>//   forward get msg_item_change iItm1 iItm2 to iRval
36217>>>//   if (iItm1/iColumns) ne (iItm2/iColumns) send row_change (iItm1/iColumns) (iItm2/iColumns)
36217>>>//   procedure_return iRval
36217>>>// end_procedure
36217>>>
36217>>>// procedure select_toggling integer itm# integer i#
36217>>>//   local integer ci# iColumns
36217>>>//   get Grid_Columns current_object to iColumns
36217>>>//   get current_item to ci#
36217>>>//   move ((ci#/iColumns)*iColumns) to ci# // Redirect to first column
36217>>>//   forward send select_toggling ci# i#
36217>>>// end_procedure
36217>>>
36217>Use rptVw.Sub
INCLUDING FILE: RPTVW.SUB
36217>>>Use DFRptvw.pkg
36217>>>Use dbRptvw.pkg
INCLUDING FILE: DBRPTVW.PKG
36217>>>>>
36217>>>>>Use Windows
36217>>>>>Use DfPanel
36217>>>>>Use EnClient
36217>>>>>Use DFNav_mx
36217>>>>>Use dfConfrm
36217>>>>>Use dfRptVw
36217>>>>>Use DFGSINI
36217>>>>>
36217>>>>>Class dbReportAppClient_ is a ReportView STARTMAC ECstart
36218>>>>>    Import_Class_Protocol Entry_Client
36219>>>>>    //  Defeat the activating augmentation for auto-locate
36219>>>>>    Procedure Activating Returns Integer
36220>>>>>      local integer RVal
36221>>>>>      forward get MSG_activating to rVal
36223>>>>>      Procedure_Return rVal
36224>>>>>    End_Procedure
36225>>>>>End_Class // dbReportAppClient_
36226>>>>>
36226>>>>>Class dbReportAppView_ is a dbReportAppClient_
36227>>>>>  import_Class_protocol entry_view_Client
36228>>>>>End_Class // dbReportAppView_
36229>>>>>
36229>>>>>
36229>>>>>Class dbReportView is a dbReportAppView_
36230>>>>>
36230>>>>>     Procedure Construct_Object
36231>>>>>      Forward Send Construct_Object No_Image
36233>>>>>      Send Define_DFNavigation  // GUI navigate changes
36234>>>>>      // dialog views get activated as popup objects.
36234>>>>>      set Dso_Detach_Mode to Detach_Always
36235>>>>>
36235>>>>>      Set Verify_Data_Loss_Msg TO GET_No_Confirmation
36236>>>>>      Set Verify_Delete_Msg    TO GET_No_Confirmation
36237>>>>>      Set Verify_Save_Msg      TO GET_No_Confirmation
36238>>>>>      Set Verify_Exit_Msg      TO GET_No_confirmation
36239>>>>>      //
36239>>>>>      // This reportview-client will almost always be a modalpanel, therefore minimizing
36239>>>>>      // is out of the question...
36239>>>>>      Set Minimize_Icon To False
36240>>>>>      Set Maximize_Icon To False
36241>>>>>   End_Procedure // Construct_Object
36242>>>>>
36242>>>>>   Procedure Request_Delete
36243>>>>>   End_Procedure // request_delete
36244>>>>>
36244>>>>>   Procedure Request_Save
36245>>>>>   End_Procedure // request_save
36246>>>>>
36246>>>>>   Function Exit_Application_Check Returns Integer
36247>>>>>     Function_return 0
36248>>>>>   End_Function
36249>>>>>
36249>>>>>   Import_Class_Protocol DFNavigate_Mixin
36250>>>>>
36250>>>>>  //  Returns TRUE to indicate that this is a DEO. This is used by
36250>>>>>  //  delegation to figure out if you are within a DEO and should therefore
36250>>>>>  //  send a DEO message. DEO clients set this true
36250>>>>>  Function DEO_Object Returns integer
36251>>>>>    Function_Return 1
36252>>>>>  End_Function // DEO_Object
36253>>>>>
36253>>>>>  //
36253>>>>>  //  Activate message for views that:
36253>>>>>  //  1. restores the view if it is minimized
36253>>>>>  //  2. Maintains the current scope's focus.
36253>>>>>  //
36253>>>>>  Procedure Activate_current_scope
36254>>>>>    If ( View_mode(Current_Object)=VIEWMODE_ICONIZE ) ;       Set view_mode to viewmode_normal
36257>>>>>    Set Current_Scope to Current_Object
36258>>>>>  End_Procedure // Activate_current_scope
36259>>>>>
36259>>>>>  //  Pass full object name - return the relative name
36259>>>>>  //  e.g.,  Main.View.Obj1 --> Obj1
36259>>>>>  Function Local_Object_name string nm returns string
36260>>>>>     local integer ps
36261>>>>>     Repeat
36261>>>>>>
36261>>>>>       pos "." in nm to ps
36263>>>>>>
36263>>>>>       If ps eq 0 function_return nm
36266>>>>>       increment ps
36267>>>>>       Mid Nm to Nm 255 ps
36270>>>>>>
36270>>>>>     Loop
36271>>>>>>
36271>>>>>  end_function
36272>>>>>
36272>>>>>  //  Take string "#1,#2" and return integer hi #1 + #2
36272>>>>>  Function Parse_Complex string sVal returns integer
36273>>>>>     Local integer ps
36274>>>>>     Pos "," in sVal to ps
36276>>>>>>
36276>>>>>     if ps ;        Function_Return ( integer(left(sVal,ps-1))*65536 + ;                          integer(mid(sVal,255,ps+1)) )
36279>>>>>  End_Function // Parse_Complex
36280>>>>>
36280>>>>>  // Convert a complex integer to a string "hi,Low"
36280>>>>>  //
36280>>>>>  Function Complex_to_String integer i1 returns string
36281>>>>>     function_return ( string(hi(i1)) - "," - String(low(i1)) )
36282>>>>>  End_function
36283>>>>>
36283>>>>>
36283>>>>>  // *WvA: I don't want to save locations of a reportview noted in the registry.
36283>>>>>  // These printing dialogs are centered on the panel anyway, so it doesn't make any
36283>>>>>  // sense to clutter up the registry with this kind of nonsense.
36283>>>>>  ////
36283>>>>>  ////  Save View information to dfwin.ini file. Save as:
36283>>>>>  ////  View_ObjectName=LOC:Row,Col  e.g., Cust_Ent=LOC:10,20
36283>>>>>  ////     Leaving room for growth here.
36283>>>>>  ////
36283>>>>>  Procedure Save_Environment
36284>>>>>  //   Local String nm Vn st
36284>>>>>  //   Local Integer H
36284>>>>>  //
36284>>>>>  //   Get System_Profile_String "SaveEnvironment" to St
36284>>>>>  //   Move (Uppercase(trim(st))) to st
36284>>>>>  //   If (st="YES" or st="ON" or st="TRUE") Begin
36284>>>>>  //     // Note with the 3.05 version we will have problems if the view has
36284>>>>>  //     // been maximized and then iconized. We still don't know what the normal
36284>>>>>  //     // size/loc is when maximized. We will take a chance and assume that an
36284>>>>>  //     // iconized view is always non-zoomed (since views don't support the zoom
36284>>>>>  //     // button).
36284>>>>>  //     If (View_mode(Current_Object)<>VIEWMODE_ZOOM) Begin
36284>>>>>  //
36284>>>>>  //       Get Name to Vn // full name of object
36284>>>>>  //       Get Local_Object_Name Vn to Vn   // just get the local name
36284>>>>>  //       Get GUILocation to H             // complex location
36284>>>>>  //       Get Complex_to_String h to nm    // convert complex to "hi,low"
36284>>>>>  //       Set System_Profile_String VN to ("LOC:"+Nm)
36284>>>>>  //     End
36284>>>>>  //   End
36284>>>>>  //
36284>>>>>  End_Procedure
36285>>>>>  //
36285>>>>>  //// Augment to check for view string in .INI. Currently, if found
36285>>>>>  //// set the location
36285>>>>>  ////
36285>>>>>  Procedure Load_Environment
36286>>>>>  //   Local String nm Vn Lc
36286>>>>>  //   Local Integer H ps
36286>>>>>  //   // see above for reasoning on this
36286>>>>>  //   If (View_mode(Current_Object)=VIEWMODE_NORMAL) Begin
36286>>>>>  //     Get Name to Vn
36286>>>>>  //     Get Local_Object_Name Vn to Vn
36286>>>>>  //     Get System_Profile_String Vn to Nm
36286>>>>>  //     IF Nm ne '' Begin
36286>>>>>  //        Pos "LOC:" in Nm to Ps   // look for LOC:row,col
36286>>>>>  //        If Ps Begin
36286>>>>>  //           Mid Nm to Lc 255 (Ps+4)
36286>>>>>  //           Pos " " in Lc to ps
36286>>>>>  //           if Ps left lc to lc (ps-1)
36286>>>>>  //           Get Parse_Complex lc to H
36286>>>>>  //           Set GUILocation to (Hi(H)) (Low(H))
36286>>>>>  //           Send Adjust_Logicals
36286>>>>>  //        End
36286>>>>>  //     End
36286>>>>>  //   End
36286>>>>>  End_Procedure
36287>>>>>
36287>>>>>  Function View_Changed returns Integer
36288>>>>>     Local Integer Changed
36289>>>>>     Broadcast Get Data_Set_Should_Save to Changed // Ask for changes in Data-sets
36291>>>>>     Function_Return Changed
36292>>>>>  End_Function
36293>>>>>
36293>>>>>  Procedure Notify_Exit_Application
36294>>>>>    Send Save_Environment
36295>>>>>  End_procedure
36296>>>>>
36296>>>>>  Procedure End_Construct_Object
36297>>>>>     Send Load_Environment
36298>>>>>     //Send Define_SysMenu
36298>>>>>     Forward Send End_Construct_Object
36300>>>>>  End_Procedure // End_Construct_Object
36301>>>>>
36301>>>>>  Procedure Close_Client
36302>>>>>     Send Exit_Function
36303>>>>>  End_Procedure
36304>>>>>
36304>>>>>  Procedure Entering_Scope returns Integer
36305>>>>>     Local Integer rVal
36306>>>>>     Forward Get MSG_Entering_Scope to rVal
36308>>>>>     If not rVal send Show_View_Name (Label(Current_Object))
36311>>>>>  End_Procedure
36312>>>>>
36312>>>>>  Procedure Exiting_Scope integer whereto returns Integer
36313>>>>>     Local Integer rVal
36314>>>>>     Forward Get MSG_Exiting_Scope whereto to rVal
36316>>>>>     If not rVal Send Show_View_Name ''
36319>>>>>  End_Procedure
36320>>>>>
36320>>>>>  Procedure Show_view_Name string sHelp
36321>>>>>     Local Integer rVal Id
36322>>>>>     Get Statusbar_id to id
36323>>>>>     If Id Send Show_View_Name to Id sHelp
36326>>>>>  End_Procedure
36327>>>>>
36327>>>>>  Function Should_Save_Recursive returns integer
36328>>>>>    Function_return (View_Changed(Current_Object))
36329>>>>>  End_Function
36330>>>>>
36330>>>>>End_Class // dbReportView
36331>>>
36331>>>Class ReportViewSub is a ReportView
36332>>>
36332>>>    Procedure Construct_Object
36333>>>        Forward Send Construct_Object
36335>>>        Property Integer Server 0
36336>>>    End_Procedure // Construct_Object
36337>>>
36337>>>    Procedure Page Integer PageMode
36338>>>        Integer hWnd
36339>>>        Forward Send Page PageMode
36341>>>        Get Window_Handle to hWnd
36342>>>        If (hWnd) Begin
36344>>>            Send GreekSysMenu
36345>>>        End
36345>>>>
36345>>>    End_Procedure
36346>>>
36346>>>    Procedure Close_Panel
36347>>>        Local Integer liScope
36348>>>        Move (Prior_Scope(Desktop)) To liScope
36349>>>        Move (Scope_Focus(liScope)) To liScope
36350>>>        Forward Send Close_Panel
36352>>>        Send Activate To liScope
36353>>>    End_Procedure // Close_Panel
36354>>>
36354>>>End_Class
36355>>>
36355>>>Class dbReportViewSub is a dbReportView
36356>>>
36356>>>    Procedure Construct_Object
36357>>>        Forward Send Construct_Object
36359>>>        Property Integer Server 0
36360>>>    End_Procedure // Construct_Object
36361>>>
36361>>>    Procedure Page Integer PageMode
36362>>>        Integer hWnd
36363>>>        Forward Send Page PageMode
36365>>>        Get Window_Handle to hWnd
36366>>>        If (hWnd) Begin
36368>>>            Send GreekSysMenu
36369>>>        End
36369>>>>
36369>>>    End_Procedure
36370>>>
36370>>>    Procedure Close_Panel
36371>>>        Local Integer liScope
36372>>>        Move (Prior_Scope(Desktop)) To liScope
36373>>>        Move (Scope_Focus(liScope)) To liScope
36374>>>        Forward Send Close_Panel
36376>>>        Send Activate To liScope
36377>>>    End_Procedure // Close_Panel
36378>>>End_Class
36379>>>
36379>
36379>
36379>
36379>//------------------------------
36379>Use Flexole
INCLUDING FILE: FLEXOLE.PKG
36379>>>//****************************************************************************
36379>>>//
36379>>>// $File name  : FlexOLE
36379>>>// $File title : Base class for OLE Automation in DataFlex under win95/NT
36379>>>// Notice      : Copyright (c) ADB-UTVECKLING AB 1996-1998
36379>>>// $Author     : JW, SF
36379>>>// $System     : DFOLE
36379>>>// Created     : 96-05-30 @ 18.12.51
36379>>>// $Last Rev   : 96-10-09 @ 14.59.35
36379>>>//
36379>>>// $Description
36379>>>// This file contains the complete FlexOLE OLE2 implementation in DataFlex.
36379>>>// Including all DLL interface declarations and DataFlex classes
36379>>>//
36379>>>// $Rev History
36379>>>//   96-05-30 File header created
36379>>>//
36379>>>//****************************************************************************
36379>>>
36379>>>USE DLL
36379>>>USE FOLE_API
INCLUDING FILE: FOLE_API.PKG
36379>>>>>//****************************************************************************
36379>>>>>//
36379>>>>>// $File name  : FOLE_API
36379>>>>>// $File title : API for FlexOLE
36379>>>>>// Notice      : Copyright (c) ADB-UTVECKLING AB 1996-1998
36379>>>>>// $Author     : JW, SF
36379>>>>>// $System     : FlexOLE
36379>>>>>// Created     : 96-05-30 @ 18.12.51
36379>>>>>// $Last Rev   : 96-10-09 @ 14.59.35
36379>>>>>//
36379>>>>>// $Description
36379>>>>>//  DLL interface declarations
36379>>>>>//
36379>>>>>// $Rev History
36379>>>>>//   96-05-30 File header created
36379>>>>>//
36379>>>>>//****************************************************************************
36379>>>>>
36379>>>>>
36379>>>>>USE DLL
36379>>>>>
36379>>>>>// Global variable for OLE
36379>>>>>Integer WM_DFOCXEVENT // This is the message sent from the DLL
36379>>>>>Integer WM_DFOCXNOTIFYEVENT // This is the notify message sent from the DLL
36379>>>>>
36379>>>>>//Global integer for objectId
36379>>>>>Integer oOLEVariantId
36379>>>>>
36379>>>>>
36379>>>>>
36379>>>>>// Optional param for OLEVariant.
36379>>>>>// For optional parameters, pass OLE_VT_OPTIONAL instead of an OLEVariant
36379>>>>>
36379>>>>>// DISP_E_PARAMNOTFOUND is the constant used together with OLE_VT_ERROR
36379>>>>>// to signify that this parameter is optional and not specified.
36379>>>>>// It is only used internally, DON'T use it directly, see above constant.
36379>>>>>
36379>>>>>// The current maximum size of strings, used both for String and OLEVariant with OLE_VT_BSTR
36379>>>>>
36379>>>>>// Null terminating for C strings
36379>>>>>
36379>>>>>// Alias data types
36379>>>>>                            // but since DataFlex has no substitute data type
36379>>>>>                            // it is internally casted back and forth
36379>>>>>                            // into an Integer
36379>>>>>                            // NOTE! Might be changed to a one char string
36379>>>>>
36379>>>>>
36379>>>>>
36379>>>>>// Pointers to vars needs to be inside a Type to use GetAddress...
36379>>>>>// It looks like we have to create these anyway (to compile cleanly)
36379>>>>>
36379>>>>>
36379>>>>>Type TP_OLEVariant
36379>>>>>    Field Variant.vt     as DWORD      // An OLE_VT_XXX constant
36379>>>>>    Field Variant.iVal   as DWORD      // If vt is OLE_VT_I2 this field contains a Short value
36379>>>>>    Field Variant.lVal   as DWORD      // If vt is OLE_VT_I4 this field contains an Integer value
36379>>>>>    Field Variant.fltVal as Char 10    // If vt is OLE_VT_R4 this field contains a ShortReal value
36379>>>>>    Field Variant.dblVal as Char 20    // If vt is OLE_VT_R8 this field contains a Real value
36379>>>>>    Field Variant.cyVal  as Char 25    // If vt is OLE_VT_CY this field contains a Currency value
36379>>>>>    Field Variant.dtVal  as Date       // If vt is OLE_VT_DATE this field contains a Date value
36379>>>>>    Field Variant.strVal as Char 255   // If vt is OLE_VT_BSTR this field contains a pointer to a String
36379>>>>>    Field Variant.dspVal as LPDISPATCH // If vt is OLE_VT_DISPATCH this field contains an LPDISPATCH
36379>>>>>    Field Variant.errVal as OLEError   // If vt is OLE_VT_ERROR this field contains an OLEError
36379>>>>>    Field Variant.blVal  as Bool       // If vt is OLE_VT_BOOL this field contains a Bool value
36379>>>>>    Field Variant.uknVal as LPIUNKNOWN // If vt is OLE_VT_UNKNOWN this field contains an LPIUnknown
36379>>>>>    Field Variant.ui1Val as DWORD      // If vt is OLE_VT_UI1 this field contains a UChar value
36379>>>>>End_Type
36379>>>>>
36379>>>>>
36379>>>>>// VARIANT constants used with the vt field in an OLEVariant type
36379>>>>>
36379>>>>>
36379>>>>>
36379>>>>>// SetFocus/KillFocus event, sent in wParam of WM_DFOCXNOTIFYEVENT
36379>>>>>
36379>>>>>// Used to register the OCX event notification messages
36379>>>>>External_Function32 RegisterWindowMessage "RegisterWindowMessageA" USER32.DLL;                    String sWM_MSG;                    Returns Integer
36380>>>>>
36380>>>>>// External functions providing access to DFOLECLN.DLL
36380>>>>>// These functions are normally not accessed directly, they are
36380>>>>>// rather accessed through an Automation_Client/OCX_Client derived class/object
36380>>>>>
36380>>>>>//********DLL Interface OLE Auto General Functions************
36380>>>>>
36380>>>>>External_Function32 CreateAutomationClient "CreateAutomationClient" DFOLECLN.DLL;                    Returns DWORD
36381>>>>>
36381>>>>>
36381>>>>>External_Function32 DestroyAutomationClient "DestroyAutomationClient" DFOLECLN.DLL;                    Integer clientId;                    Returns DWORD
36382>>>>>
36382>>>>>External_Function32 CreateAutoClientDispatch "CreateAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    String progIdStr;                    Returns DWORD
36383>>>>>
36383>>>>>External_Function32 AttachAutoClientDispatch "AttachAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    LPDispatch disp;                    Integer addRef;                    Returns DWORD
36384>>>>>
36384>>>>>External_Function32 AttachAutoClientActiveObject "AttachAutoClientActiveObject" DFOLECLN.DLL;                    Integer clientId;                    String progIdStr;                    Returns DWORD
36385>>>>>
36385>>>>>External_Function32 ReleaseAutoClientDispatch "ReleaseAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    Returns DWORD
36386>>>>>
36386>>>>>External_Function32 GetAutoClientDispatch "GetAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    Returns LPDispatch
36387>>>>>
36387>>>>>//********DLL Interface OLE Auto Get Property Functions**************
36387>>>>>
36387>>>>>External_Function32 GetAutoClientBoolProperty "GetAutoClientBoolProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
36388>>>>>
36388>>>>>External_Function32 GetAutoClientCurrencyProperty "GetAutoClientCurrencyProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
36389>>>>>
36389>>>>>External_Function32 GetAutoClientDateProperty "GetAutoClientDateProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Date
36390>>>>>
36390>>>>>External_Function32 GetAutoClientLPDispatchProperty "GetAutoClientLPDispatchProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns LPDispatch
36391>>>>>
36391>>>>>External_Function32 GetAutoClientRealProperty "GetAutoClientRealProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
36392>>>>>
36392>>>>>External_Function32 GetAutoClientShortRealProperty "GetAutoClientShortRealProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Real
36393>>>>>
36393>>>>>External_Function32 GetAutoClientIntegerProperty "GetAutoClientIntegerProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
36394>>>>>
36394>>>>>External_Function32 GetAutoClientShortProperty "GetAutoClientShortProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Integer
36395>>>>>
36395>>>>>
36395>>>>>External_Function32 GetAutoClientStringProperty "GetAutoClientStringProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns DWORD
36396>>>>>
36396>>>>>External_Function32 GetAutoClientOLEVariantProperty "GetAutoClientOLEVariantProperty" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    LPOLEVar destVar;                    Returns  LPOLEVar
36397>>>>>
36397>>>>>
36397>>>>>//********DLL Interface OLE Auto Set Property Functions**************
36397>>>>>
36397>>>>>External_Function32 SetAutoClientBoolProperty "SetAutoClientBoolProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    DWORD    prop;                    Returns DWORD
36398>>>>>
36398>>>>>External_Function32 SetAutoClientCurrencyProperty "SetAutoClientCurrencyProperty" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    String prop;                    Returns  DWORD
36399>>>>>
36399>>>>>External_Function32 SetAutoClientDateProperty "SetAutoClientDateProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Date    prop;                    Returns DWORD
36400>>>>>
36400>>>>>External_Function32 SetAutoClientLPDispatchProperty "SetAutoClientLPDispatchProperty" DFOLECLN.DLL;                    Integer    clientId;                    DWORD    dwDispId;                    LPDispatch prop;                    Returns    DWORD
36401>>>>>
36401>>>>>External_Function32 SetAutoClientRealProperty "SetAutoClientRealProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    String   prop;                    Returns DWORD
36402>>>>>
36402>>>>>External_Function32 SetAutoClientShortRealProperty "SetAutoClientShortRealProperty" DFOLECLN.DLL;                    Integer   clientId;                    DWORD   dwDispId;                    String prop;                    Returns   DWORD
36403>>>>>
36403>>>>>External_Function32 SetAutoClientIntegerProperty "SetAutoClientIntegerProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    DWORD prop;                    Returns DWORD
36404>>>>>
36404>>>>>External_Function32 SetAutoClientShortProperty "SetAutoClientShortProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Integer   prop;                    Returns DWORD
36405>>>>>
36405>>>>>External_Function32 SetAutoClientStringProperty "SetAutoClientStringProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    String  prop;                    Returns DWORD
36406>>>>>
36406>>>>>External_Function32 SetAutoClientOLEVariantProperty "SetAutoClientOLEVariantProperty" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    String prop;                    Returns  DWORD
36407>>>>>
36407>>>>>
36407>>>>>//******DLL Interface OLE Auto Pre Invoke Functions**************
36407>>>>>
36407>>>>>External_Function32 DeclareAutoClientInvokeParams "DeclareAutoClientInvokeParams" DFOLECLN.DLL;                    Integer clientId;                    DWORD nrOfParams;                    Returns DWORD
36408>>>>>
36408>>>>>External_Function32 DefineAutoClientBoolParam "DefineAutoClientBoolParam" DFOLECLN.DLL;                    Integer clientId;                    DWORD    param;                    Returns DWORD
36409>>>>>
36409>>>>>External_Function32 DefineAutoClientCurrencyParam "DefineAutoClientCurrencyParam" DFOLECLN.DLL;                    Integer clientId;                    String  param;                    Returns DWORD
36410>>>>>
36410>>>>>External_Function32 DefineAutoClientDateParam "DefineAutoClientDateParam" DFOLECLN.DLL;                    Integer clientId;                    Date    param;                    Returns DWORD
36411>>>>>
36411>>>>>External_Function32 DefineAutoClientRealParam "DefineAutoClientRealParam" DFOLECLN.DLL;                    Integer clientId;                    String    param;                    Returns DWORD
36412>>>>>
36412>>>>>External_Function32 DefineAutoClientShortRealParam "DefineAutoClientShortRealParam" DFOLECLN.DLL;                    Integer   clientId;                    String param;                    Returns   DWORD
36413>>>>>
36413>>>>>External_Function32 DefineAutoClientIntegerParam "DefineAutoClientIntegerParam" DFOLECLN.DLL;                    Integer clientId;                    DWORD param;                    Returns DWORD
36414>>>>>
36414>>>>>External_Function32 DefineAutoClientShortParam "DefineAutoClientShortParam" DFOLECLN.DLL;                    Integer clientId;                    Integer   param;                    Returns DWORD
36415>>>>>
36415>>>>>External_Function32 DefineAutoClientLPDispatchParam "DefineAutoClientLPDispatchParam" DFOLECLN.DLL;                    Integer clientId;                    LPDispatch param;                    Returns DWORD
36416>>>>>
36416>>>>>External_Function32 DefineAutoClientStringParam "DefineAutoClientStringParam" DFOLECLN.DLL;                    Integer clientId;                    String  param;                    Returns DWORD
36417>>>>>
36417>>>>>External_Function32 DefineAutoClientOLEVariantParam "DefineAutoClientOLEVariantParam" DFOLECLN.DLL;                    Integer  clientId;                    OLEVariant param;                    Returns  DWORD
36418>>>>>
36418>>>>>//********DLL Interface OLE Auto Invoke Functions*********************
36418>>>>>
36418>>>>>External_Function32 InvokeAutoClientVoidFunction "InvokeAutoClientVoidFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
36419>>>>>
36419>>>>>External_Function32 InvokeAutoClientBoolFunction "InvokeAutoClientBoolFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
36420>>>>>
36420>>>>>External_Function32 InvokeAutoClientCurrencyFunction "InvokeAutoClientCurrencyFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
36421>>>>>
36421>>>>>External_Function32 InvokeAutoClientDateFunction "InvokeAutoClientDateFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Date
36422>>>>>
36422>>>>>External_Function32 InvokeAutoClientLPDispatchFunction "InvokeAutoClientLPDispatchFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns LPDispatch
36423>>>>>
36423>>>>>External_Function32 InvokeAutoClientRealFunction "InvokeAutoClientRealFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
36424>>>>>
36424>>>>>External_Function32 InvokeAutoClientShortRealFunction "InvokeAutoClientShortRealFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
36425>>>>>
36425>>>>>External_Function32 InvokeAutoClientIntegerFunction "InvokeAutoClientIntegerFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
36426>>>>>
36426>>>>>External_Function32 InvokeAutoClientShortFunction "InvokeAutoClientShortFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Integer
36427>>>>>
36427>>>>>External_Function32 InvokeAutoClientStringFunction "InvokeAutoClientStringFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer  destStr;                    Returns Integer
36428>>>>>
36428>>>>>
36428>>>>>External_Function32 InvokeAutoClientOLEVariantFunction "InvokeAutoClientOLEVariantFunction" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    LPOLEVar destVar;                    Returns  Integer
36429>>>>>
36429>>>>>//********DLL Interface OLE Control Functions*********************
36429>>>>>
36429>>>>>
36429>>>>>External_Function32 CreateOCXClient "CreateOCXClient" DFOLECLN.DLL;                    Returns Integer
36430>>>>>
36430>>>>>
36430>>>>>External_Function32 CreateOCXControl "CreateOCXControl" DFOLECLN.DLL;                    Integer iCId;                    Pointer pPar;                    String  sCId;                    String  sCap;                    Dword   wSty;                    String  sLic;                    String  sFile;                    Returns Integer
36431>>>>>
36431>>>>>External_Function32 DestroyOCXControl "DestroyOCXControl" DFOLECLN.DLL;                    Integer iClientId;                    Returns Integer
36432>>>>>
36432>>>>>External_Function32 GetOCXEventBoolParam "GetOCXEventBoolParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Integer
36433>>>>>
36433>>>>>External_Function32 GetOCXEventCurrencyParam "GetOCXEventCurrencyParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer destStr;                    Returns Integer
36434>>>>>
36434>>>>>External_Function32 GetOCXEventDateParam "GetOCXEventDateParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Date
36435>>>>>
36435>>>>>External_Function32 GetOCXEventRealParam "GetOCXEventRealParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer destStr;                    Returns Integer
36436>>>>>
36436>>>>>External_Function32 GetOCXEventShortRealParam "GetOCXEventShortRealParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer destStr;                    Returns Integer
36437>>>>>
36437>>>>>External_Function32 GetOCXEventIntegerParam "GetOCXEventIntegerParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Integer
36438>>>>>
36438>>>>>External_Function32 GetOCXEventShortParam "GetOCXEventShortParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Integer
36439>>>>>
36439>>>>>External_Function32 GetOCXEventStringParam "GetOCXEventStringParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer pDestStr;                    Returns Integer
36440>>>>>
36440>>>>>External_Function32 GetOCXEventOLEVariantParam "GetOCXEventOLEVariantParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    LPOLEVAR pDestVar;                    Returns Integer
36441>>>>>
36441>>>>>External_Function32 EnableOCXControl "EnableOCXControl" DFOLECLN.DLL;                    Integer iClientId;                    BOOL bEnable;                    Returns Integer
36442>>>>>
36442>>>>>External_Function32 GetOCXControlCaption "GetOCXControlCaption" DFOLECLN.DLL;                    Integer iClientId;                    Pointer lpDestStr;                    Returns Integer
36443>>>>>
36443>>>>>External_Function32 SetOCXControlCaption "SetOCXControlCaption" DFOLECLN.DLL;                    Integer iClientId;                    String  sCaption;                    Returns Integer
36444>>>>>
36444>>>>>External_Function32 LoadOlePicture "LoadOlePicture" DFOLECLN.DLL;                    String  sFilename;                    Returns LPDispatch
36445>>>>>
36445>>>>>External_Function32 ReleaseComPointer "ReleaseComPtr" DFOLECLN.DLL;                    LPIUnknown  comPtr;                    Returns Integer
36446>>>>>
36446>>>>>External_Function32 DFOleInit "DFOleInit" DFOLECLN.DLL;                    Returns Integer
36447>>>>>
36447>>>>>External_Function32 DFOleUninit "DFOleUninit" DFOLECLN.DLL;                    Returns Integer
36448>>>>>
36448>>>>>External_Function32 AlterOCXEventParam "AlterOCXEventParam" DFOLECLN.DLL;                    Pointer  pdispParams;                    Integer iparam;                    OLEVariant vNewValue;                    Returns  Integer
36449>>>>>
36449>>>>>
36449>>>>>
36449>>>>>// This command is only used internaly and should NOT be used by the developer
36449>>>>>
36449>>>USE DFEXTCLM
36449>>>USE EXTFRM
36449>>>USE DBEXTFRM
36449>>>
36449>>>//**********
36449>>>//*** Error messages***
36449>>>//**********
36449>>>
36449>>>    Enum_List
36449>>>        Define OLE_SV_LANG
36449>>>        Define OLE_US_LANG
36449>>>    End_Enum_List
36449>>>
36449>>>    Define OLE_CURR_LANG For OLE_US_LANG
36449>>>
36449>>>        //*** US
INCLUDING FILE: FLXOLEUS.INC
36449>>>>
36449>>>
36449>>>
36449>>>// This class encapsulates the behaviour of an OLEVariant, and simplifies
36449>>>// tasks involved working with the OLEVariant.
36449>>>Class cOLEVariant is an array
36450>>>    Procedure Construct_Object
36451>>>        Forward Send Construct_Object
36453>>>        Local Integer iRetVal
36454>>>        Move (DFOleInit()) to iRetVal
36455>>>        Send OCXInit
36456>>>    End_Procedure
36457>>>
36457>>>    Procedure Destroy_Object
36458>>>        Local Integer iRetVal
36459>>>        Move (DFOleUninit()) to iRetVal
36460>>>        Forward Send Destroy_Object
36462>>>    End_Procedure
36463>>>
36463>>>    Procedure OCXInit
36464>>>        Move (RegisterWindowMessage("WM_DFOCXEVENT")) to WM_DFOCXEVENT
36465>>>        Move (RegisterWindowMessage("WM_DFOCXNOTIFYEVENT")) to WM_DFOCXNOTIFYEVENT
36466>>>    End_Procedure
36467>>>
36467>>>    Function GetType  OLEVariant var Returns DWORD
36468>>>        Local DWORD varVt
36469>>>        GetBuff from var at Variant.vt to varVt
36470>>>        Function_Return varVt
36471>>>    End_Function
36472>>>
36472>>>    Function GetShort OLEVariant var Returns Integer
36473>>>        Local Integer iVal
36474>>>        GetBuff from var at Variant.iVal to iVal
36475>>>        Function_Return iVal
36476>>>    End_Function
36477>>>
36477>>>    Function GetInteger OLEVariant var Returns Integer
36478>>>        Local Integer lVal
36479>>>        GetBuff from var at Variant.lVal to lVal
36480>>>        Function_Return lVal
36481>>>    End_Function
36482>>>
36482>>>    Function GetFloat OLEVariant var Returns OLEReal
36483>>>        Local OLEReal fltVal
36484>>>        GetBuff_String from var at Variant.fltVal to fltVal
36485>>>        Function_Return fltVal
36486>>>    End_Function
36487>>>
36487>>>    Function GetDouble OLEVariant var Returns OLEReal
36488>>>        Local OLEReal dblVal
36489>>>        GetBuff_String from var at Variant.dblVal to dblVal
36490>>>        Function_Return dblVal
36491>>>    End_Function
36492>>>
36492>>>    Function GetCurrency OLEVariant var Returns Number
36493>>>        Local Number cyVal
36494>>>        GetBuff_String from var at Variant.cyVal to cyVal
36495>>>        Function_Return cyVal
36496>>>    End_Function
36497>>>
36497>>>    Function GetDate OLEVariant var Returns Date
36498>>>        Local Date dtVal
36499>>>        GetBuff from var at Variant.dtVal to dtVal
36500>>>        Function_Return dtVal
36501>>>    End_Function
36502>>>
36502>>>    Function GetString OLEVariant var Returns String
36503>>>        Local String strVal
36504>>>        GetBuff_String from var at Variant.strVal to strVal
36505>>>        Function_Return strVal
36506>>>    End_Function
36507>>>
36507>>>    Function GetLPDispatch OLEVariant var Returns LPDispatch
36508>>>        Local LPDispatch dspVal
36509>>>        GetBuff from var at Variant.dspVal to dspVal
36510>>>        Function_Return dspVal
36511>>>    End_Function
36512>>>
36512>>>    Function GetOLEError OLEVariant var Returns OLEError
36513>>>        Local OLEError errVal
36514>>>        GetBuff from var at Variant.errVal to errVal
36515>>>        Function_Return errVal
36516>>>    End_Function
36517>>>
36517>>>    Function GetBool OLEVariant var Returns Bool
36518>>>        Local Bool blVal
36519>>>        GetBuff from var at Variant.blVal to blVal
36520>>>        Function_Return blVal
36521>>>    End_Function
36522>>>
36522>>>    Function GetLPIUnknown OLEVariant var Returns LPIUnknown
36523>>>        Local LPIUnknown uknVal
36524>>>        GetBuff from var at Variant.uknVal to uknVal
36525>>>        Function_Return uknVal
36526>>>    End_Function
36527>>>
36527>>>    Function GetUChar OLEVariant var Returns UChar
36528>>>        Local UChar ui1Val
36529>>>        GetBuff from var at Variant.ui1Val to ui1Val
36530>>>        Function_Return ui1Val
36531>>>    End_Function
36532>>>
36532>>>    Function GetValue OLEVariant var Returns String
36533>>>        Local DWORD vt
36534>>>        Local String retVal
36534>>>        Get GetType var to vt
36535>>>             If vt Eq OLE_VT_I2        Get GetShort var to retVal
36538>>>        Else If vt Eq OLE_VT_I4        Get GetInteger var to retVal
36542>>>        Else If vt Eq OLE_VT_R4        Get GetFloat var to retVal
36546>>>        Else If vt Eq OLE_VT_R8        Get GetDouble var to retVal
36550>>>        Else If vt Eq OLE_VT_CY        Get GetCurrency var to retVal
36554>>>        Else If vt Eq OLE_VT_DATE      Get GetDate var to retVal
36558>>>        Else If vt Eq OLE_VT_BSTR      Get GetString var to retVal
36562>>>        Else If vt Eq OLE_VT_DISPATCH  Get GetLPDispatch var to retVal
36566>>>        Else If vt Eq OLE_VT_ERROR     Get GetOLEError var to retVal
36570>>>        Else If vt Eq OLE_VT_BOOL      Get GetBool var to retVal
36574>>>        Else If vt Eq OLE_VT_UNKNOWN   Get GetLPIUnknown var to retVal
36578>>>        Else If vt Eq OLE_VT_UI1       Get GetUChar var to retVal
36582>>>        Function_Return retVal
36583>>>    End_Function
36584>>>
36584>>>    Function PutValue DWORD vt String val Returns OLEVariant
36585>>>        Inst_OLEVariant var
36587>>>        Put vt to var at Variant.vt
36588>>>             If vt Eq OLE_VT_I2        Put (Integer(val)) to var at Variant.iVal
36591>>>        Else If vt Eq OLE_VT_I4        Put (Integer(val)) to var at Variant.lVal
36595>>>        Else If vt Eq OLE_VT_R4        Put_String val to var at Variant.fltVal
36599>>>        Else If vt Eq OLE_VT_R8        Put_String val to var at Variant.dblVal
36603>>>        Else If vt Eq OLE_VT_CY        Put_String val to var at Variant.cyVal
36607>>>        Else If vt Eq OLE_VT_DATE      Put (Date(val)) to var at Variant.dtVal
36611>>>        Else If vt Eq OLE_VT_BSTR      Put_String val to var at Variant.strVal
36615>>>        Else If vt Eq OLE_VT_DISPATCH  Put (LPDispatch(val)) to var at Variant.dspVal
36619>>>        Else If vt Eq OLE_VT_ERROR     Put (OLEError(val)) to var at Variant.errVal
36623>>>        Else If vt Eq OLE_VT_BOOL      Put (Bool(val)) to var at Variant.blVal
36627>>>        Else If vt Eq OLE_VT_UNKNOWN   Put (LPIUnknown(val)) to var at Variant.uknVal
36631>>>        Else If vt Eq OLE_VT_UI1       Put (UChar(val)) to var at Variant.ui1Val
36635>>>        Else begin
36636>>>            Put OLE_VT_ERROR to var at Variant.vt
36637>>>            Put DISP_E_PARAMNOTFOUND to var at Variant.errVal
36638>>>        End
36638>>>>
36638>>>        Function_Return var
36639>>>    End_Function
36640>>>
36640>>>End_Class
36641>>>
36641>>>// The one and only cOLEVariant helper object
36641>>>Object oOLEVariant is a cOLEVariant
36643>>>        Move Current_Object to oOLEVariantId
36644>>>End_Object
36645>>>
36645>>>//Command so we get nicer code for the events, only used internally
36645>>>
36645>>>// Command to extract the value of an OLEVariant no matter what datatype its currently holding
36645>>>
36645>>>// Command to both set the datatype and value to an OLEVariant
36645>>>
36645>>>
36645>>>// The OLE Base class, all OLE classes are derived from this class
36645>>>// Defines basic functionality and conversation with DLL interface
36645>>>
36645>>>Class cCOM_IDispatch is a Message
36646>>>
36646>>>    Procedure DefineCOM_IDispatch
36647>>>        Property String  progIdStr Public ""
36648>>>        Property Integer ClientId Public 0
36649>>>        Property Integer AutoAddRef Public 0
36650>>>    End_Procedure
36651>>>
36651>>>// GetProperty functions
36651>>>    Function GetIntegerProperty DWORD dwDispId returns Integer
36652>>>        Local Integer lpropVal iClientId
36653>>>        Get clientId to iClientId
36654>>>        Move (GetAutoClientIntegerProperty (iClientId,dwDispId)) to lpropVal
36655>>>        Function_Return lpropVal
36656>>>    End_Function
36657>>>
36657>>>    Function GetShortProperty DWORD dwDispId returns Integer
36658>>>        Local Integer lpropVal iClientId
36659>>>        Get clientId to iClientId
36660>>>        Move (GetAutoClientShortProperty (iClientId,dwDispId)) to lpropVal
36661>>>        Function_Return lpropVal
36662>>>    End_Function
36663>>>
36663>>>    Function GetBoolProperty DWORD dwDispId returns BOOL
36664>>>        Local BOOL lpropVal
36665>>>        Local Integer iClientId
36665>>>        Get clientId to iClientId
36666>>>        Move (GetAutoClientBoolProperty (iClientId,dwDispId)) to lpropVal
36667>>>        Function_Return lpropVal
36668>>>    End_Function
36669>>>
36669>>>    Function GetCurrencyProperty DWORD dwDispId returns Number
36670>>>        Local Number lpropVal
36671>>>        Local String lsProp
36671>>>        Local Integer iClientId iRetVal
36671>>>        Local Pointer llpsprop
36671>>>        Get clientId to iClientId
36672>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lsProp
36673>>>        GetAddress of lsprop to llpsprop
36674>>>        Move (GetAutoClientCurrencyProperty (iClientId,dwDispId,llpsprop)) to iRetVal
36675>>>        Move lsProp to lpropVal
36676>>>        Function_Return lpropVal
36677>>>    End_Function
36678>>>
36678>>>    Function GetDateProperty DWORD dwDispId returns Date
36679>>>        Local Date lpropVal
36680>>>        Local Integer iClientId
36680>>>        Get clientId to iClientId
36681>>>        Move (GetAutoClientDateProperty (iClientId,dwDispId)) to lpropVal
36682>>>        Function_Return lpropVal
36683>>>    End_Function
36684>>>
36684>>>    Function GetLPDispatchProperty DWORD dwDispId returns Date
36685>>>        Local LPDispatch lpropVal
36686>>>        Local Integer iClientId
36686>>>        Get clientId to iClientId
36687>>>        Move (GetAutoClientLPDispatchProperty (iClientId,dwDispId)) to lpropVal
36688>>>        Function_Return lpropVal
36689>>>    End_Function
36690>>>
36690>>>    Function GetRealProperty DWORD dwDispId returns OLEReal
36691>>>        Local OLEReal lpropVal
36692>>>        Local Integer iClientId iRetVal
36692>>>        Local String lsProp
36692>>>        Local Pointer llpsprop
36692>>>        Get clientId to iClientId
36693>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lsProp
36694>>>        GetAddress of lsprop to llpsprop
36695>>>        Move (GetAutoClientRealProperty (iClientId,dwDispId,llpsprop)) to iRetVal
36696>>>        Move lsProp to lpropVal
36697>>>        Function_Return lpropVal
36698>>>    End_Function
36699>>>
36699>>>    Function GetShortRealProperty DWORD dwDispId returns OLEReal
36700>>>        Local OLEReal lpropVal
36701>>>        Local Integer iClientId iRetVal
36701>>>        Local String lsProp
36701>>>        Local Pointer llpsprop
36701>>>        Get clientId to iClientId
36702>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lsProp
36703>>>        GetAddress of lsprop to llpsprop
36704>>>        Move (GetAutoClientShortRealProperty (iClientId,dwDispId,llpsprop)) to iRetVal
36705>>>        Move lsProp to lpropVal
36706>>>        Function_Return lpropVal
36707>>>    End_Function
36708>>>
36708>>>    Function GetStringProperty DWORD dwDispId returns String
36709>>>        Local String lpropVal
36710>>>        Local Integer iClientId iRetVal
36710>>>        Local Pointer llppropVal
36710>>>        Get clientId to iClientId
36711>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lpropVal
36712>>>        GetAddress of lpropVal to llppropval
36713>>>        Move (GetAutoClientStringProperty (iClientId,dwDispId,llppropVal)) to iRetVal
36714>>>        Function_Return (CString(lpropVal))
36715>>>    End_Function
36716>>>
36716>>>    Function GetOLEVariantProperty DWORD dwDispId returns OLEVariant
36717>>>        Local OLEVariant lpropVal
36718>>>        Local Integer iClientId iRetVal
36718>>>        Local Pointer llppropVal
36718>>>        Get clientId to iClientId
36719>>>        ZeroType TP_OLEVariant to lpropVal
36720>>>        GetAddress of lpropVal to llppropval
36721>>>        Move (GetAutoClientOLEVariantProperty (iClientId,dwDispId,llppropVal)) to iRetVal
36722>>>        Function_Return lpropVal
36723>>>    End_Function
36724>>>
36724>>>// SetProperty procedures
36724>>>    Procedure SetIntegerProperty DWORD dwDispId Integer lpropVal
36725>>>        Local Integer iClientId iRetVal
36726>>>        Get ClientId to iClientId
36727>>>        Move (SetAutoClientIntegerProperty (iClientId,dwDispId,lpropVal)) to iRetVal
36728>>>    End_Procedure
36729>>>
36729>>>    Procedure SetShortProperty DWORD dwDispId Integer lpropVal
36730>>>        Local Integer iClientId iRetVal
36731>>>        Get ClientId to iClientId
36732>>>        Move (SetAutoClientShortProperty (iClientId,dwDispId,lpropVal)) to iRetVal
36733>>>    End_Procedure
36734>>>
36734>>>    Procedure SetBoolProperty DWORD dwDispId BOOL lpropVal
36735>>>        Local Integer iClientId iRetVal
36736>>>        Get ClientId to iClientId
36737>>>        Move (SetAutoClientShortProperty (iClientId,dwDispId,lpropVal)) to iRetVal
36738>>>    End_Procedure
36739>>>
36739>>>    Procedure SetCurrencyProperty DWORD dwDispId Number lpropVal
36740>>>        Local Integer iClientId iRetVal
36741>>>        Local String lsprop
36741>>>        Get ClientId to iClientId
36742>>>        Move lpropVal to lsprop
36743>>>        Move (SetAutoClientCurrencyProperty(iClientId,dwDispId,lsprop)) to iRetVal
36744>>>    End_Procedure
36745>>>
36745>>>    Procedure SetDateProperty DWORD dwDispId Date lpropVal
36746>>>        Local Integer iClientId iRetVal
36747>>>        Get ClientId to iClientId
36748>>>        Move (SetAutoClientDateProperty(iClientId,dwDispId,lpropVal)) to iRetVal
36749>>>    End_Procedure
36750>>>
36750>>>    Procedure SetLPDispatchProperty DWORD dwDispId LPDispatch lpropVal
36751>>>        Local Integer iClientId iRetVal
36752>>>        Get ClientId to iClientId
36753>>>        Move (SetAutoClientLPDispatchProperty(iClientId,dwDispId,lpropVal)) to iRetVal
36754>>>    End_Procedure
36755>>>
36755>>>    Procedure SetRealProperty DWORD dwDispId OLEReal lpropVal
36756>>>        Local Integer iClientId iRetVal
36757>>>        Local String lsprop
36757>>>        Get ClientId to iClientId
36758>>>        Move lpropVal to lsprop
36759>>>        Move (SetAutoClientRealProperty(iClientId,dwDispId,lsprop)) to iRetVal
36760>>>    End_Procedure
36761>>>
36761>>>    Procedure SetShortRealProperty DWORD dwDispId OLEReal lpropVal
36762>>>        Local Integer iClientId iRetVal
36763>>>        Local String lsprop
36763>>>        Get ClientId to iClientId
36764>>>        Move lpropVal to lsprop
36765>>>        Move (SetAutoClientShortRealProperty(iClientId,dwDispId,lsprop)) to iRetVal
36766>>>    End_Procedure
36767>>>
36767>>>    Procedure SetStringProperty DWORD dwDispId String lpropVal
36768>>>        Local Integer iClientId iRetVal
36769>>>        Get ClientId to iClientId
36770>>>        Move (SetAutoClientStringProperty(iClientId,dwDispId,lpropVal)) to iRetVal
36771>>>    End_Procedure
36772>>>
36772>>>    Procedure SetOLEVariantProperty DWORD dwDispId OLEVariant lpropVal
36773>>>        Local Integer iClientId iRetVal
36774>>>        Get ClientId to iClientId
36775>>>        If (Length(lpropval)) Lt TP_OLEVariant_Size;            Get PutValue of oOLEVariantId OLE_VT_ERROR DISP_E_PARAMNOTFOUND to lpropVal
36778>>>        Move (SetAutoClientOLEVariantProperty(iClientId,dwDispId,lpropVal)) to iRetVal
36779>>>    End_Procedure
36780>>>
36780>>>// Pre-Invoke functions
36780>>>    Procedure DeclareParams Integer nrOfParams
36781>>>        Local Integer iClientId iRetVal
36782>>>        Get ClientId to iCLientId
36783>>>        Move (DeclareAutoClientInvokeParams(iClientId,nrOfParams)) to iRetVal
36784>>>    End_Procedure
36785>>>
36785>>>    Procedure DefineIntegerParam Integer param
36786>>>        Local Integer iClientId iRetVal
36787>>>        Get ClientId to iClientId
36788>>>        Move (DefineAutoClientIntegerParam(iClientId,param)) to iRetVal
36789>>>    End_Procedure
36790>>>
36790>>>    Procedure DefineShortParam Integer param
36791>>>        Local Integer iClientId iRetVal
36792>>>        Get ClientId to iClientId
36793>>>        Move (DefineAutoClientShortParam(iClientId,param)) to iRetVal
36794>>>    End_Procedure
36795>>>
36795>>>    Procedure DefineBoolParam BOOL param
36796>>>        Local Integer iClientId iRetVal
36797>>>        Get ClientId to iClientId
36798>>>        Move (DefineAutoClientBoolParam(iClientId,param)) to iRetVal
36799>>>    End_Procedure
36800>>>
36800>>>    Procedure DefineCurrencyParam Number param
36801>>>        Local Integer iClientId iRetVal
36802>>>        Local String lsparam
36802>>>        Get ClientId to iClientId
36803>>>        Move param to lsparam
36804>>>        Move (DefineAutoClientCurrencyParam(iClientId,lsparam)) to iRetVal
36805>>>    End_Procedure
36806>>>
36806>>>    Procedure DefineDateParam Date param
36807>>>        Local Integer iClientId iRetVal
36808>>>        Get ClientId to iClientId
36809>>>        Move (DefineAutoClientDateParam(iClientId,param)) to iRetVal
36810>>>    End_Procedure
36811>>>
36811>>>    Procedure DefineLPDispatchParam LPDispatch param
36812>>>        Local Integer iClientId iRetVal
36813>>>        Get ClientId to iClientId
36814>>>        Move (DefineAutoClientLPDispatchParam(iClientId,param)) to iRetVal
36815>>>    End_Procedure
36816>>>
36816>>>    Procedure DefineRealParam OLEReal param
36817>>>        Local Integer iClientId iRetVal
36818>>>        Local String lsparam
36818>>>        Get ClientId to iClientId
36819>>>        Move param to lsparam
36820>>>        Move (DefineAutoClientRealParam(iClientId,lsparam)) to iRetVal
36821>>>    End_Procedure
36822>>>
36822>>>    Procedure DefineShortRealParam OLEReal param
36823>>>        Local Integer iClientId iRetVal
36824>>>        Local String lsparam
36824>>>        Get ClientId to iClientId
36825>>>        Move param to lsparam
36826>>>        Move (DefineAutoClientShortRealParam(iClientId,lsparam)) to iRetVal
36827>>>    End_Procedure
36828>>>
36828>>>    Procedure DefineStringParam String param
36829>>>        Local Integer iClientId iRetVal
36830>>>        Get ClientId to iClientId
36831>>>        Append param OLENull
36832>>>        Move (DefineAutoClientStringParam(iClientId,param)) to iRetVal
36833>>>    End_Procedure
36834>>>
36834>>>    Procedure DefineOLEVariantParam OLEVariant param
36835>>>        Local Integer iClientId iRetVal
36836>>>        Get ClientId to iClientId
36837>>>        If (Length(param)) Lt TP_OLEVariant_Size ;            Get PutValue of oOLEVariantId OLE_VT_ERROR DISP_E_PARAMNOTFOUND to param
36840>>>        Move (DefineAutoClientOLEVariantParam(iClientId,param)) to iRetVal
36841>>>    End_Procedure
36842>>>
36842>>>// Invoke functions
36842>>>    Procedure InvokeVoidFunction DWORD dwDispId
36843>>>        Local Integer iClientId iRetVal
36844>>>        Get ClientId to iClientId
36845>>>        Move (InvokeAutoClientVoidFunction(iClientId,dwDispId)) to iRetVal
36846>>>    End_Procedure
36847>>>
36847>>>    Function InvokeIntegerFunction DWORD dwDispId returns Integer
36848>>>        Local Integer iClientId iRetVal
36849>>>        Get ClientId to iClientId
36850>>>        Move (InvokeAutoClientIntegerFunction(iClientId,dwDispId)) to iRetVal
36851>>>        Function_Return iRetVal
36852>>>    End_Function
36853>>>
36853>>>    Function InvokeShortFunction DWORD dwDispId returns Integer
36854>>>        Local Integer iClientId iRetVal
36855>>>        Get ClientId to iClientId
36856>>>        Move (InvokeAutoClientShortFunction(iClientId,dwDispId)) to iRetVal
36857>>>        Function_Return iRetVal
36858>>>    End_Function
36859>>>
36859>>>    Function InvokeBoolFunction DWORD dwDispId returns BOOL
36860>>>        Local Integer iClientId iRetVal
36861>>>        Get ClientId to iClientId
36862>>>        Move (InvokeAutoClientBoolFunction(iClientId,dwDispId)) to iRetVal
36863>>>        Function_Return iRetVal
36864>>>    End_Function
36865>>>
36865>>>    Function InvokeCurrencyFunction DWORD dwDispId returns Number
36866>>>        Local Integer iClientId iRetVal
36867>>>        Local Number nRetVal
36867>>>        Local String sRetVal
36867>>>        Local Pointer psRetVal
36867>>>        Get ClientId to iClientId
36868>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
36869>>>        GetAddress of sRetVal to psRetVal
36870>>>        Move (InvokeAutoClientCurrencyFunction(iClientId,dwDispId,psRetVal)) to iRetVal
36871>>>        Move sRetVal to nRetVal
36872>>>        Function_Return nRetVal
36873>>>    End_Function
36874>>>
36874>>>    Function InvokeDateFunction DWORD dwDispId returns Date
36875>>>        Local Integer iClientId
36876>>>        Local Date dRetVal
36876>>>        Get ClientId to iClientId
36877>>>        Move (InvokeAutoClientDateFunction(iClientId,dwDispId)) to dRetVal
36878>>>        Function_Return dRetVal
36879>>>    End_Function
36880>>>
36880>>>    Function InvokeLPDispatchFunction DWORD dwDispId returns LPDispatch
36881>>>        Local Integer iClientId
36882>>>        Local LPDispatch lpdRetVal
36882>>>        Get ClientId to iClientId
36883>>>        Move (InvokeAutoClientLPDispatchFunction(iClientId,dwDispId)) to lpdRetVal
36884>>>        Function_Return lpdRetVal
36885>>>    End_Function
36886>>>
36886>>>    Function InvokeRealFunction DWORD dwDispId returns OLEReal
36887>>>        Local Integer iClientId iRetVal
36888>>>        Local OLEReal rRetVal
36888>>>        Local String sRetVal
36888>>>        Local Pointer psRetVal
36888>>>        Get ClientId to iClientId
36889>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
36890>>>        GetAddress of sRetVal to psRetVal
36891>>>        Move (InvokeAutoClientRealFunction(iClientId,dwDispId,psRetVal)) to iRetVal
36892>>>        Move sRetVal to rRetVal
36893>>>        Function_Return rRetVal
36894>>>    End_Function
36895>>>
36895>>>    Function InvokeShortRealFunction DWORD dwDispId returns OLEReal
36896>>>        Local Integer iClientId iRetVal
36897>>>        Local OLEReal rRetVal
36897>>>        Local String sRetVal
36897>>>        Local Pointer psRetVal
36897>>>        Get ClientId to iClientId
36898>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
36899>>>        GetAddress of sRetVal to psRetVal
36900>>>        Move (InvokeAutoClientShortRealFunction(iClientId,dwDispId,psRetVal)) to iRetVal
36901>>>        Move sRetVal to rRetVal
36902>>>        Function_Return rRetVal
36903>>>    End_Function
36904>>>
36904>>>    Function InvokeStringFunction DWORD dwDispId returns String
36905>>>        Local Integer iClientId iRetVal
36906>>>        Local String sRetVal
36906>>>        Local Pointer psRetVal
36906>>>        Get ClientId to iClientId
36907>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
36908>>>        GetAddress of sRetVal to psRetVal
36909>>>        Move (InvokeAutoClientStringFunction(iClientId,dwDispId,psRetVal)) to iRetVal
36910>>>        Function_Return (CString(sRetVal))
36911>>>    End_Function
36912>>>
36912>>>    Function InvokeOleVariantFunction DWORD dwDispId returns OLEVariant
36913>>>        Local Integer iClientId iRetVal
36914>>>        Local OLEVariant vRetVal
36914>>>        Local Pointer pvRetVal
36914>>>        Get ClientId to iClientId
36915>>>        ZeroType TP_OLEVariant to vRetVal
36916>>>        GetAddress of vRetVal to pvRetVal
36917>>>        Move (InvokeAutoClientOLEVariantFunction(iClientId,dwDispId,pvRetVal)) to iRetVal
36918>>>        Function_Return vRetVal
36919>>>    End_Function
36920>>>
36920>>>
36920>>>// Event parameter functions, might be moved to cOCX_Client_Mixin or similar
36920>>>    Function GetEventIntegerParam DWORD lParam DWORD iPara returns Integer
36921>>>        Local Integer iRetVal
36922>>>        Move (GetOCXEventIntegerParam(lParam,iPara)) to iRetVal
36923>>>        Function_Return iRetVal
36924>>>    End_Function
36925>>>
36925>>>    Function GetEventShortParam DWORD lParam DWORD iPara returns Integer
36926>>>        Local Integer iRetVal
36927>>>        Move (GetOCXEventShortParam(lParam,iPara)) to iRetVal
36928>>>        Function_Return iRetVal
36929>>>    End_Function
36930>>>
36930>>>    Function GetEventBoolParam DWORD lParam DWORD iPara returns Bool
36931>>>        Local Bool iRetVal
36932>>>        Move (GetOCXEventBoolParam(lParam,iPara)) to iRetVal
36933>>>        Function_Return iRetVal
36934>>>    End_Function
36935>>>
36935>>>    Function GetEventCurrencyParam DWORD lParam DWORD iPara returns Currency
36936>>>        Local Integer iretVal
36937>>>        Local Currency cRetVal
36937>>>        Local String destStr
36937>>>        Local Pointer pdestStr
36937>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
36938>>>        GetAddress of destStr to pdestStr
36939>>>        Move (GetOCXEventCurrencyParam(lParam,iPara,pdestStr)) to iRetVal
36940>>>        Move (CString(destStr)) to cRetVal
36941>>>        Function_Return cRetVal
36942>>>    End_Function
36943>>>
36943>>>    Function GetEventDateParam DWORD lParam DWORD iPara returns Date
36944>>>        Local Date dRetVal
36945>>>        Move (GetOCXEventDateParam(lParam,iPara)) to dRetVal
36946>>>        Function_Return dRetVal
36947>>>    End_Function
36948>>>
36948>>>    Function GetEventLPDispatchParam DWORD lParam DWORD iPara returns LPDispatch
36949>>>        Local LPDispatch lpRetVal
36950>>>        Get GetEventIntegerParam lParam iPara to lpRetVal
36951>>>        Function_Return lpRetVal
36952>>>    End_Function
36953>>>
36953>>>    Function GetEventRealParam DWORD lParam DWORD iPara returns OLEReal
36954>>>        Local Integer iretVal
36955>>>        Local OLEReal rRetVal
36955>>>        Local String destStr
36955>>>        Local Pointer pdestStr
36955>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
36956>>>        GetAddress of destStr to pdestStr
36957>>>        Move (GetOCXEventRealParam(lParam,iPara,pdestStr)) to iRetVal
36958>>>        Move (CString(destStr)) to rRetVal
36959>>>        Function_Return rRetVal
36960>>>    End_Function
36961>>>
36961>>>    Function GetEventShortRealParam DWORD lParam DWORD iPara returns ShortReal
36962>>>        Local Integer iretVal
36963>>>        Local ShortReal rRetVal
36963>>>        Local String destStr
36963>>>        Local Pointer pdestStr
36963>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
36964>>>        GetAddress of destStr to pdestStr
36965>>>        Move (GetOCXEventShortRealParam(lParam,iPara,pdestStr)) to iRetVal
36966>>>        Move (CString(destStr)) to rRetVal
36967>>>        Function_Return rRetVal
36968>>>    End_Function
36969>>>
36969>>>    Function GetEventStringParam DWORD lParam DWORD iPara returns String
36970>>>        Local Integer iretVal
36971>>>        Local String sRetVal
36971>>>        Local Pointer psRetVal
36971>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
36972>>>        GetAddress of sRetVal to psRetVal
36973>>>        Move (GetOCXEventStringParam(lParam,iPara,psRetVal)) to iRetVal
36974>>>        Function_Return (CString(sRetVal))
36975>>>    End_Function
36976>>>
36976>>>    Function GetEventOLEVariantParam DWORD lParam DWORD iPara returns OLEVariant
36977>>>        Local Integer iretVal
36978>>>        Inst_OLEVariant vRetVal
36979>>>        Local Pointer pvRetVal
36979>>>        GetAddress of vRetVal to pvRetVal
36980>>>        Move (GetOCXEventOLEVariantParam(lParam,iPara,pvRetVal)) to iRetVal
36981>>>        Function_Return vRetVal
36982>>>    End_Function
36983>>>
36983>>>End_Class
36984>>>
36984>>>
36984>>>// The OLE Automation base class,
36984>>>// which all automation classes are derived from
36984>>>
36984>>>Class Automation_Client is a cCOM_IDispatch
36985>>>    Procedure Construct_Object
36986>>>        Forward Send Construct_Object
36988>>>        Send DefineCOM_IDispatch
36989>>>        Local Integer iClientId
36990>>>        Move (CreateAutomationClient()) To iClientId
36991>>>        If iClientId Eq 0 Begin
36993>>>            Set ClientId to 0
36994>>>            Error 1002 DFOLEError1002
36995>>>>
36995>>>        End
36995>>>>
36995>>>        Else Set ClientId To iClientId
36997>>>        End_Procedure
36998>>>
36998>>>    Procedure Destroy_Object
36999>>>        Local Integer iRetVal iClientId
37000>>>        Get ClientId to iClientId
37001>>>        Move (DestroyAutomationClient(iClientId)) to iRetVal
37002>>>        Forward Send Destroy_Object
37004>>>    End_Procedure
37005>>>
37005>>>    Procedure CreateDispatch
37006>>>                Local Integer iRetVal
37007>>>                Local Integer iClientId
37007>>>        Local String sCLSID
37007>>>        Get progIdStr to sCLSID
37008>>>        Append sCLSID OLENull
37009>>>
37009>>>                Get clientId to iClientId
37010>>>        Move (CreateAutoClientDispatch (iClientId,sCLSID)) To iRetVal
37011>>>                If iRetVal Eq 0 Begin
37013>>>            Error 1000 DFOLEError1000
37014>>>>
37014>>>                End
37014>>>>
37014>>>        End_Procedure
37015>>>
37015>>>        Procedure AttachDispatch LPDispatch pdisp
37016>>>                Local Integer iRetVal
37017>>>                Local Integer iClientId
37017>>>                Local Integer bAutoAddRef
37017>>>                Get clientId to iClientId
37018>>>                Get AutoAddRef to bAutoAddRef
37019>>>                Move (AttachAutoClientDispatch (iClientId,pdisp,bAutoAddRef)) To iRetVal
37020>>>                If iRetVal Eq 0 Begin
37022>>>                Error 1001 DFOLEError1001
37023>>>>
37023>>>                End
37023>>>>
37023>>>    End_Procedure
37024>>>
37024>>>    Function AttachActiveObject Returns Bool
37025>>>                Local Bool bRetVal
37026>>>                Local Integer iClientId
37026>>>                Local String sCLSID
37026>>>                Get progIdStr to sCLSID
37027>>>                Append sCLSID OLENull
37028>>>                Get clientId to iClientId
37029>>>                Move (AttachAutoClientActiveObject (iClientId,sCLSID)) To bRetVal
37030>>>                Function_Return bRetVal
37031>>>    End_Function
37032>>>
37032>>>    Procedure ReleaseDispatch
37033>>>        Local Integer iRetVal
37034>>>        Local Integer iClientId
37034>>>        Get clientId to iClientId
37035>>>        Move (ReleaseAutoClientDispatch (iClientId)) to iRetVal
37036>>>    End_Procedure
37037>>>
37037>>>    Function GetDispatch returns LPDispatch
37038>>>        Local LPDispatch retVal
37039>>>        Local Integer iClientId
37039>>>        Get clientId to iClientId
37040>>>        Move (GetAutoClientDispatch(iClientId)) to retVal
37041>>>        Function_Return retVal
37042>>>    End_Function
37043>>>
37043>>>End_Class
37044>>>
37044>>>
37044>>>//     cCom_IDispatch  External_Class_Mixin
37044>>>//                 |       |    
37044>>>//                 |       cOCXNavigation_Mixin
37044>>>//                 |         |    
37044>>>//               cOCX_Client_Mixin
37044>>>//                        |    |
37044>>>//                        |    |
37044>>>// Form_External_Control  |    |   dbForm_External_Control
37044>>>//                 |      |    |        |  
37044>>>//                OCX_Client   dbOCX_Client
37044>>>
37044>>>
37044>>>
37044>>>// The focus navigation mixin class for ActiveX controls
37044>>>Class cOCX_Navigation_Class_Mixin is a Mixin 
37045>>>    Import_Class_Protocol External_Class_Mixin
37046>>>    Register_Procedure WMDF_DFOCXNotifyEvent
37046>>>
37046>>>    Procedure WMDF_DFOCXNotifyEvent Integer wParam Integer lParam
37047>>>        ON_EVENT WM_DFOCX_FOCUSCHANGE Fire OCXFocusChange
37050>>>    End_Procedure
37051>>>
37051>>>    Procedure OCXFocusChange Integer lParam
37052>>>        If (lParam);            Send External_SetFocus
37055>>>        Else;            Send External_KillFocus
37057>>>    End_Procedure
37058>>>
37058>>>    //Provided just to cancel the External_Class_Mixin implementation
37058>>>    //It actually gets cancelled in the cOCX_Clint_Mixin, but hey!?
37058>>>    Procedure Page_Object Integer state
37059>>>        Forward Send Page_Object state        
37061>>>    End_Procedure
37062>>>
37062>>>    Procedure Enable_Window integer iState
37063>>>      // Here we switch iState again, for backwards compatibility
37063>>>      Set OcxShadow_State to (Not(iState))
37064>>>    End_procedure
37065>>>
37065>>>End_Class
37066>>>
37066>>>
37066>>>//The standard OCX class mixin, it is the 
37066>>>// OCX base class which all OLE Controls are derived from (read mixin'd)
37066>>>Class cOCX_Client_Mixin is a Mixin
37067>>>
37067>>>    Import_Class_Protocol cCOM_IDispatch
37068>>>    Import_Class_Protocol cOCX_Navigation_Class_Mixin
37069>>>    Register_Procedure WMDF_DFOCXEVENT Integer wParam Integer lParam
37069>>>
37069>>>    Procedure DefineOCX_Client
37070>>>        Send DefineCOM_IDispatch
37071>>>        Local Integer iClientId
37072>>>        Property integer Private.OCXShadowState Public 0
37073>>>        Property String  Private.OCXCaption Public ""
37074>>>        Property String  OCXLicense Public ""
37075>>>        Property String  OCXPropFile Public ""
37076>>>        Move (CreateOCXClient()) to iclientId
37077>>>                Set ClientId to iClientId
37078>>>        Send Use_Parent_Color
37079>>>    End_Procedure
37080>>>
37080>>>    Function OCXShadow_State Returns Integer
37081>>>        Local Integer bEnabled
37082>>>        Get Private.OCXShadowState to bEnabled
37083>>>        Function_Return bEnabled
37084>>>    End_Function
37085>>>
37085>>>    Procedure Set OCXShadow_State Integer bEnable
37086>>>        Local integer hWnd iSuccess iCLientId
37087>>>        Set Private.OCXShadowState to bEnable
37088>>>        Get clientId to iClientId
37089>>>        If bEnable;            Move (false) to bEnable
37092>>>        else;            Move (true) to bEnable
37094>>>        Get Window_Handle to hWnd
37095>>>        If hWnd;            Move (EnableOCXControl(iClientId,bEnable)) To iSuccess
37098>>>    End_Procedure
37099>>>
37099>>>    Procedure SetOCXCaption String sCaption
37100>>>        Local Integer iClientId iRetVal
37101>>>        Get ClientId to iClientId
37102>>>        Append sCaption OLENull
37103>>>        Move (SetOCXControlCaption(iClientId,sCaption)) to iRetVal
37104>>>        If (Not(iRetVal));            Error 1004 DFOLEError1004
37107>>>        Else;            Set Private.OCXCaption to sCaption
37109>>>    End_Procedure
37110>>>
37110>>>    Function GetOCXCaption Returns String
37111>>>        Local Integer iClientId iRetVal
37112>>>        Local String destStr
37112>>>        Local Pointer lpDestStr
37112>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
37113>>>        GetAddress of destStr to lpDestStr
37114>>>        Move (GetOCXControlCaption(iClientId,lpDestStr)) to iRetVal
37115>>>        If (not(iRetVal));            Error 1004 DFOLEError1004
37118>>>        Set Private.OCXCaption to (CString(destStr))
37119>>>        Function_Return (Private.OCXCaption(Current_Object))
37120>>>    End_Function
37121>>>
37121>>>    Procedure SET OCXCaption String sCaption
37122>>>        If (Window_Handle(Current_Object));            Send SetOCXCaption sCaption
37125>>>        Else;            Set Private.OCXCaption to sCaption
37127>>>    End_Procedure
37128>>>
37128>>>    Function OCXCaption Returns String
37129>>>        If (Window_Handle(Current_Object));            Function_Return (GetOCXCaption(Current_Object))
37132>>>        Else;            Function_Return (Private.OCXCaption(Current_Object))
37134>>>    End_Procedure
37135>>>
37135>>>    // To avoid flickering during resize operations
37135>>>    Procedure Use_Parent_Color
37136>>>        Local Integer Clr Txtclr Backclr
37137>>>        Delegate Get Object_Color To Clr
37139>>>        Move (Hi(Clr)) To Txtclr
37140>>>        Move (Low(Clr)) To Backclr
37141>>>        Set Object_Color To Txtclr Backclr
37142>>>    End_Procedure
37143>>>
37143>>>    Procedure Page_Object integer iState
37144>>>        Forward Send Page_Object iState
37146>>>        If iState Eq (True) Send LoadOCX
37149>>>    End_Procedure
37150>>>
37150>>>    Procedure Remove_Object
37151>>>        Send UnloadOCX
37152>>>        Forward send Remove_Object
37154>>>    End_Procedure
37155>>>
37155>>>    Procedure LoadOCX
37156>>>        Local Pointer HWnd
37157>>>        Local Integer iCLientId iRetVal iVisible iShadow dwSty
37157>>>        Local String sPrgId lic sCap sPropFile
37157>>>        Send PreCreateOCX
37158>>>        Get ClientId to iClientId
37159>>>        Get Window_Handle to hwnd
37160>>>        Get progIdStr to sPrgId
37161>>>        Append sPrgId OLENull
37162>>>        Get Private.OCXCaption To sCap
37163>>>        Append sCap OLENull
37164>>>        Get OCXLicense To Lic
37165>>>        Append Lic OLENull
37166>>>        Get OCXPropFile To sPropFile
37167>>>        Append sPropfile OLENull
37168>>>        Get Visible_State to iVisible
37169>>>        If (iVisible) Move WS_VISIBLE to dwSty
37172>>>        Else Move 0 to dwSty
37174>>>        Get Private.OCXShadowState to iShadow
37175>>>        If (iShadow) Move (dwSty ior WS_DISABLED) to dwSty
37178>>>        Move (dwSty ior WS_TABSTOP) to dwSty
37179>>>        Move (CreateOCXControl(iClientId,HWnd,sPrgId,sCap,dwSty,lic,sPropFile)) to iRetVal
37180>>>        Send PostCreateOCX
37181>>>    End_Procedure
37182>>>
37182>>>    Procedure UnloadOCX
37183>>>        Local Integer iRetVal
37184>>>                Local Integer iClientId
37184>>>                Get ClientId to iClientId
37185>>>                Move (DestroyOCXControl(iClientId)) to iRetVal
37186>>>    End_Procedure
37187>>>
37187>>>    //This procedure is triggered before the OCX control is created
37187>>>    Procedure PreCreateOCX
37188>>>    End_Procedure
37189>>>
37189>>>    //This procedure is triggered after the OCX control is created but
37189>>>    //before it's shown
37189>>>    Procedure PostCreateOCX
37190>>>    End_Procedure
37191>>>End_Class
37192>>>
37192>>>// The non data aware OCX class
37192>>>// Derive from this class if you DON'T want your ActiveX control to be data aware
37192>>>Class OCX_Client is a FormExternalControl
37193>>>    Import_Class_Protocol cOCX_Client_Mixin
37194>>>
37194>>>    //These allows us to use the VDF standard 'Value' to get and set the
37194>>>    // caption of the ActiveX control (e.g. Get/Set Value to someVariable)
37194>>>
37194>>>    Procedure Set ControlValue string sVal
37195>>>        Set OCXCaption to sVal
37196>>>    End_Procedure
37197>>>
37197>>>    Function Value Integer item_number Returns String
37198>>>        Function_Return (OCXCaption(Current_Object))
37199>>>    End_Function
37200>>>
37200>>>End_Class
37201>>>
37201>>>
37201>>>// The Data aware OCX class
37201>>>// Derive from this class if you want your ActiveX control to be data aware
37201>>>Class dbOCX_Client is a dbFormExternalControl
37202>>>    Import_Class_Protocol cOCX_Client_Mixin
37203>>>
37203>>>    Procedure DefinedbOCX_Client
37204>>>        Send DefineOCX_Client
37205>>>        Property String  Private.OCXdbValue public ""
37206>>>    End_Procedure
37207>>>
37207>>>    Procedure Set ControlValue string sVal
37208>>>        If (Window_Handle(Current_Object));            Send OnRefreshDbOcxValue sVal
37211>>>    End_Procedure
37212>>>
37212>>>    Function ControlValue Returns String
37213>>>        Function_Return (Private.OCXDbValue(Current_Object))
37214>>>    End_Function
37215>>>
37215>>>    //Triggered when the database value has changed,
37215>>>    // and the ActiveX control needs to be updated
37215>>>    //Override and perform necessary updating to the OCX
37215>>>    Procedure OnRefreshDbOcxValue String sVal
37216>>>    End_Procedure
37217>>>
37217>>>    //Should be called when the ActiveX control's value has changed,
37217>>>    // and the database value needs to be updated
37217>>>    Procedure UpdateDbOcxValue String sVal
37218>>>        Set Private.OCXdbValue to sVal
37219>>>        Send ControlValueChanged
37220>>>    End_Procedure
37221>>>
37221>>>End_Class
37222>>>
37222>>>
37222>>>// Command for common declarations of ActiveX control classes, only used internally
37222>>>
37222>>>
37222>>>Use FontDisp
INCLUDING FILE: FONTDISP.PKG
37222>>>>>// OLEStdFont Charset Constants
37222>>>>>Enum_List
37222>>>>>        Define OLEANSI_CHARSET for 0 
37222>>>>>        Define OLEDEFAULT_CHARSET for 1
37222>>>>>        Define OLESYMBOL_CHARSET for 2
37222>>>>>End_Enum_List
37222>>>>>
37222>>>>>
37222>>>>>// CLSID:{BEF6E003-A874-101A-8BBA-00AA00300CAB}
37222>>>>>// ProgId: 
37222>>>>>Class OLEFontMixin is a Automation_Client
37223>>>>>
37223>>>>>        Function StdFontName Returns String
37224>>>>>                Local String lpropVal
37225>>>>>                Get GetStringProperty 0 to lpropVal
37226>>>>>                Function_Return lpropVal
37227>>>>>        End_Function
37228>>>>>
37228>>>>>        Procedure SET StdFontName String lpropVal
37229>>>>>                Send SetStringProperty 0 lpropVal
37230>>>>>        End_Procedure
37231>>>>>
37231>>>>>        Function StdFontSize Returns Currency
37232>>>>>                Local Currency lpropVal
37233>>>>>                Get GetCurrencyProperty 2 to lpropVal
37234>>>>>                Function_Return lpropVal
37235>>>>>        End_Function
37236>>>>>
37236>>>>>        Procedure SET StdFontSize Currency lpropVal
37237>>>>>                Send SetCurrencyProperty 2 lpropVal
37238>>>>>        End_Procedure
37239>>>>>
37239>>>>>        Function StdFontBold Returns Bool
37240>>>>>                Local Bool lpropVal
37241>>>>>                Get GetBoolProperty 3 to lpropVal
37242>>>>>                Function_Return lpropVal
37243>>>>>        End_Function
37244>>>>>
37244>>>>>        Procedure SET StdFontBold Bool lpropVal
37245>>>>>                Send SetBoolProperty 3 lpropVal
37246>>>>>        End_Procedure
37247>>>>>
37247>>>>>        Function StdFontItalic Returns Bool
37248>>>>>                Local Bool lpropVal
37249>>>>>                Get GetBoolProperty 4 to lpropVal
37250>>>>>                Function_Return lpropVal
37251>>>>>        End_Function
37252>>>>>
37252>>>>>        Procedure SET StdFontItalic Bool lpropVal
37253>>>>>                Send SetBoolProperty 4 lpropVal
37254>>>>>        End_Procedure
37255>>>>>
37255>>>>>        Function StdFontUnderline Returns Bool
37256>>>>>                Local Bool lpropVal
37257>>>>>                Get GetBoolProperty 5 to lpropVal
37258>>>>>                Function_Return lpropVal
37259>>>>>        End_Function
37260>>>>>
37260>>>>>        Procedure SET StdFontUnderline Bool lpropVal
37261>>>>>                Send SetBoolProperty 5 lpropVal
37262>>>>>        End_Procedure
37263>>>>>
37263>>>>>        Function StdFontStrikethrough Returns Bool
37264>>>>>                Local Bool lpropVal
37265>>>>>                Get GetBoolProperty 6 to lpropVal
37266>>>>>                Function_Return lpropVal
37267>>>>>        End_Function
37268>>>>>
37268>>>>>        Procedure SET StdFontStrikethrough Bool lpropVal
37269>>>>>                Send SetBoolProperty 6 lpropVal
37270>>>>>        End_Procedure
37271>>>>>
37271>>>>>        Function StdFontWeight Returns Integer
37272>>>>>                Local Integer lpropVal
37273>>>>>                Get GetShortProperty 7 to lpropVal
37274>>>>>                Function_Return lpropVal
37275>>>>>        End_Function
37276>>>>>
37276>>>>>        Procedure SET StdFontWeight Integer lpropVal
37277>>>>>                Send SetShortProperty 7 lpropVal
37278>>>>>        End_Procedure
37279>>>>>
37279>>>>>        Function StdFontCharset Returns Integer
37280>>>>>                Local Integer lpropVal
37281>>>>>                Get GetShortProperty 8 to lpropVal
37282>>>>>                Function_Return lpropVal
37283>>>>>        End_Function
37284>>>>>
37284>>>>>        Procedure SET StdFontCharset Integer lpropVal
37285>>>>>                Send SetShortProperty 8 lpropVal
37286>>>>>        End_Procedure
37287>>>>>
37287>>>>>End_Class
37288>>>>>
37288>>>>>// CoClass CLSID:{0BE35203-8F91-11CE-9DE3-00AA004BB851}
37288>>>>>// ProgId: StdFont
37288>>>>>// Number of impl.Types:1
37288>>>>>// Referenced class Font
37288>>>>>Class OLEStdFont is a Automation_Client
37289>>>>>        Import_Class_Protocol OLEFontMixin
37290>>>>>
37290>>>>>        Procedure Construct_Object
37291>>>>>                Forward Send Construct_Object
37293>>>>>                Set progIdStr to "StdFont"
37294>>>>>        End_Procedure
37295>>>>>End_Class
37296>>>Use PicDisp
INCLUDING FILE: PICDISP.PKG
37296>>>>>
37296>>>>>// Picture Type Constants
37296>>>>>//Enum_List
37296>>>>>        Define OLEPICTYPE_UNINITIALIZED for -1 // Uninitialized
37296>>>>>        Define OLEPICTYPE_NONE for 0 // None
37296>>>>>        Define OLEPICTYPE_BITMAP for 1 // Bitmap
37296>>>>>        Define OLEPICTYPE_METAFILE for 2 // Windows Metafile
37296>>>>>        Define OLEPICTYPE_ICON for 3 // Icon
37296>>>>>        Define OLEPICTYPE_ENHMETAFILE for 4 // Enhanced Metafile
37296>>>>>//End_Enum_List
37296>>>>>
37296>>>>>// CLSID:{7BF80981-BF32-101A-8BBB-00AA00300CAB}
37296>>>>>// ProgId: 
37296>>>>>Class OLEPictureMixin is a Automation_Client
37297>>>>>
37297>>>>>        Function StdPictureHandle Returns OLE_HANDLE
37298>>>>>                Local OLE_HANDLE lpropVal
37299>>>>>                Get GetIntegerProperty 0 to lpropVal
37300>>>>>                Function_Return lpropVal
37301>>>>>        End_Function
37302>>>>>
37302>>>>>        Function StdPicturehPal Returns OLE_HANDLE
37303>>>>>                Local OLE_HANDLE lpropVal
37304>>>>>                Get GetIntegerProperty 2 to lpropVal
37305>>>>>                Function_Return lpropVal
37306>>>>>        End_Function
37307>>>>>
37307>>>>>        Procedure SET StdPicturehPal OLE_HANDLE lpropVal
37308>>>>>                Send SetIntegerProperty 2 lpropVal
37309>>>>>        End_Procedure
37310>>>>>
37310>>>>>        Function StdPictureType Returns Integer
37311>>>>>                Local Integer lpropVal
37312>>>>>                Get GetShortProperty 3 to lpropVal
37313>>>>>                Function_Return lpropVal
37314>>>>>        End_Function
37315>>>>>
37315>>>>>        Function StdPictureWidth Returns OLE_XSIZE_HIMETRIC
37316>>>>>                Local OLE_XSIZE_HIMETRIC lpropVal
37317>>>>>                Get GetIntegerProperty 4 to lpropVal
37318>>>>>                Function_Return lpropVal
37319>>>>>        End_Function
37320>>>>>
37320>>>>>        Function StdPictureHeight Returns OLE_YSIZE_HIMETRIC
37321>>>>>                Local OLE_YSIZE_HIMETRIC lpropVal
37322>>>>>                Get GetIntegerProperty 5 to lpropVal
37323>>>>>                Function_Return lpropVal
37324>>>>>        End_Function
37325>>>>>
37325>>>>>        Procedure StdPictureRender DWORD lhdc DWORD lx DWORD ly DWORD lcx DWORD lcy OLE_XPOS_HIMETRIC lxSrc OLE_YPOS_HIMETRIC lySrc OLE_XSIZE_HIMETRIC lcxSrc OLE_YSIZE_HIMETRIC lcySrc LPOLE_RECT lprcWBounds
37326>>>>>                Send DeclareParams 10
37327>>>>>                Send DefineIntegerParam lhdc
37328>>>>>                Send DefineIntegerParam lx
37329>>>>>                Send DefineIntegerParam ly
37330>>>>>                Send DefineIntegerParam lcx
37331>>>>>                Send DefineIntegerParam lcy
37332>>>>>                Send DefineIntegerParam lxSrc
37333>>>>>                Send DefineIntegerParam lySrc
37334>>>>>                Send DefineIntegerParam lcxSrc
37335>>>>>                Send DefineIntegerParam lcySrc
37336>>>>>                Send DefineIntegerParam lprcWBounds
37337>>>>>                Send InvokeVoidFunction 6
37338>>>>>        End_Procedure 
37339>>>>>
37339>>>>>End_Class
37340>>>>>
37340>>>>>// CoClass CLSID:{0BE35204-8F91-11CE-9DE3-00AA004BB851}
37340>>>>>// ProgId: StdPicture
37340>>>>>// Number of impl.Types:1
37340>>>>>// Referenced class Picture
37340>>>>>Class OLEStdPicture is a Automation_Client
37341>>>>>        Import_Class_Protocol OLEPictureMixin
37342>>>>>
37342>>>>>        Procedure Construct_Object
37343>>>>>                Forward Send Construct_Object
37345>>>>>                Set progIdStr to "StdPicture"
37346>>>>>        End_Procedure
37347>>>>>End_Class
37348>Use DPDlg    // Full Path Directory Picker
INCLUDING FILE: DPDLG.PKG
37348>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\DPDLG.OCX
37348>>>// Generated by FlexOLE Class Generator Friday, November 10, 2000 17:30:33
37348>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
37348>>>
37348>>>//Enum_List
37348>>>    Define OLEdpdDesktop        for  0 // Desktop
37348>>>    Define OLEdpdControlPanel   for  1 // Control Panel
37348>>>    Define OLEdpdDesktopDir     for  2 // Desktop Directory
37348>>>    Define OLEdpdMyComputer     for  3 // My Computer
37348>>>    Define OLEdpdFontDir        for  4 // Font Directory
37348>>>    Define OLEdpdNetwork        for  5 // Network Neighborhood
37348>>>    Define OLEdpdPrinters       for  6 // Printers
37348>>>    Define OLEdpdPrograms       for  7 // Programs
37348>>>    Define OLEdpdRecent         for  8 // Recent
37348>>>    Define OLEdpdRecycleBin     for  9 // Recycle Bin
37348>>>    Define OLEdpdSendTo         for 10 // Send To
37348>>>    Define OLEdpdStartMenu      for 11 // Start Menu
37348>>>    Define OLEdpdStartUp        for 12 // Start Up
37348>>>    Define OLEdpdTemplates      for 13 // Templates
37348>>>    Define OLEdpdCustom         for 14 // Custom Root
37348>>>//End_Enum_List
37348>>>
37348>>>// Dispatch interface for DPDlg Control
37348>>>// CLSID:{BE5AB244-F888-11D0-9F5E-B42103C10710}
37348>>>// ProgId:
37348>>>Class OLE_DDPDlg is a Message
37349>>>
37349>>>        Function DPDlgBrowseForComputer Returns Bool
37350>>>                Local Bool lpropVal
37351>>>                Get GetBoolProperty 1 to lpropVal
37352>>>                Function_Return lpropVal
37353>>>        End_Function
37354>>>
37354>>>        Procedure SET DPDlgBrowseForComputer Bool lpropVal
37355>>>                Send SetBoolProperty 1 lpropVal
37356>>>        End_Procedure
37357>>>
37357>>>        Function DPDlgBrowseForPrinter Returns Bool
37358>>>                Local Bool lpropVal
37359>>>                Get GetBoolProperty 2 to lpropVal
37360>>>                Function_Return lpropVal
37361>>>        End_Function
37362>>>
37362>>>        Procedure SET DPDlgBrowseForPrinter Bool lpropVal
37363>>>                Send SetBoolProperty 2 lpropVal
37364>>>        End_Procedure
37365>>>
37365>>>        Function DPDlgDontGoBelowDomain Returns Bool
37366>>>                Local Bool lpropVal
37367>>>                Get GetBoolProperty 3 to lpropVal
37368>>>                Function_Return lpropVal
37369>>>        End_Function
37370>>>
37370>>>        Procedure SET DPDlgDontGoBelowDomain Bool lpropVal
37371>>>                Send SetBoolProperty 3 lpropVal
37372>>>        End_Procedure
37373>>>
37373>>>        Function DPDlgReturnFSAncestors Returns Bool
37374>>>                Local Bool lpropVal
37375>>>                Get GetBoolProperty 4 to lpropVal
37376>>>                Function_Return lpropVal
37377>>>        End_Function
37378>>>
37378>>>        Procedure SET DPDlgReturnFSAncestors Bool lpropVal
37379>>>                Send SetBoolProperty 4 lpropVal
37380>>>        End_Procedure
37381>>>
37381>>>        Function DPDlgReturnOnlyFSDirs Returns Bool
37382>>>                Local Bool lpropVal
37383>>>                Get GetBoolProperty 5 to lpropVal
37384>>>                Function_Return lpropVal
37385>>>        End_Function
37386>>>
37386>>>        Procedure SET DPDlgReturnOnlyFSDirs Bool lpropVal
37387>>>                Send SetBoolProperty 5 lpropVal
37388>>>        End_Procedure
37389>>>
37389>>>        Function DPDlgRoot Returns OLE_ROOTSHORT
37390>>>                Local OLE_ROOTSHORT lpropVal
37391>>>                Get GetIntegerProperty 6 to lpropVal
37392>>>                Function_Return lpropVal
37393>>>        End_Function
37394>>>
37394>>>        Procedure SET DPDlgRoot OLE_ROOTSHORT lpropVal
37395>>>                Send SetIntegerProperty 6 lpropVal
37396>>>        End_Procedure
37397>>>
37397>>>        Function DPDlghWnd Returns OLE_HANDLE
37398>>>                Local OLE_HANDLE lpropVal
37399>>>                Get GetIntegerProperty -515 to lpropVal
37400>>>                Function_Return lpropVal
37401>>>        End_Function
37402>>>
37402>>>        Procedure SET DPDlghWnd OLE_HANDLE lpropVal
37403>>>                Send SetIntegerProperty -515 lpropVal
37404>>>        End_Procedure
37405>>>
37405>>>        Function DPDlgIcon Returns LPDispatch
37406>>>                Local LPDispatch lpropVal
37407>>>                Get GetLPDispatchProperty 7 to lpropVal
37408>>>                Function_Return lpropVal
37409>>>        End_Function
37410>>>
37410>>>        Procedure SET DPDlgIcon LPDispatch lpropVal
37411>>>                Send SetLPDispatchProperty 7 lpropVal
37412>>>        End_Procedure
37413>>>
37413>>>        Function DPDlgFolder Returns String
37414>>>                Local String lpropVal
37415>>>                Get GetStringProperty 8 to lpropVal
37416>>>                Function_Return lpropVal
37417>>>        End_Function
37418>>>
37418>>>        Procedure SET DPDlgFolder String lpropVal
37419>>>                Send SetStringProperty 8 lpropVal
37420>>>        End_Procedure
37421>>>
37421>>>        Function DPDlgCaption Returns String
37422>>>                Local String lpropVal
37423>>>                Get GetStringProperty -518 to lpropVal
37424>>>                Function_Return lpropVal
37425>>>        End_Function
37426>>>
37426>>>        Procedure SET DPDlgCaption String lpropVal
37427>>>                Send SetStringProperty -518 lpropVal
37428>>>        End_Procedure
37429>>>
37429>>>        Function DPDlg_Caption Returns String
37430>>>                Local String lpropVal
37431>>>                Get GetStringProperty 0 to lpropVal
37432>>>                Function_Return lpropVal
37433>>>        End_Function
37434>>>
37434>>>        Procedure SET DPDlg_Caption String lpropVal
37435>>>                Send SetStringProperty 0 lpropVal
37436>>>        End_Procedure
37437>>>
37437>>>        Function DPDlgPath Returns String
37438>>>                Local String lpropVal
37439>>>                Get GetStringProperty 9 to lpropVal
37440>>>                Function_Return lpropVal
37441>>>        End_Function
37442>>>
37442>>>        Procedure SET DPDlgPath String lpropVal
37443>>>                Send SetStringProperty 9 lpropVal
37444>>>        End_Procedure
37445>>>
37445>>>        Function DPDlgCustomRoot Returns String
37446>>>                Local String lpropVal
37447>>>                Get GetStringProperty 10 to lpropVal
37448>>>                Function_Return lpropVal
37449>>>        End_Function
37450>>>
37450>>>        Procedure SET DPDlgCustomRoot String lpropVal
37451>>>                Send SetStringProperty 10 lpropVal
37452>>>        End_Procedure
37453>>>
37453>>>        Function DPDlgShow Returns Bool
37454>>>                Local Bool lretVal
37455>>>                Get InvokeBoolFunction 11 to lretVal
37456>>>                Function_Return lretVal
37457>>>        End_Function
37458>>>
37458>>>        Procedure DPDlgAboutBox
37459>>>                Send InvokeVoidFunction -552
37460>>>        End_Procedure
37461>>>
37461>>>End_Class
37462>>>
37462>>>// Event interface for DPDlg Control
37462>>>// CLSID:{BE5AB245-F888-11D0-9F5E-B42103C10710}
37462>>>// ProgId:
37462>>>Class OLE_DDPDlgEvents is a Message
37463>>>
37463>>>        Procedure OnDPDlgFolderSelected String lPath Bool lAllow
37464>>>        End_Procedure
37465>>>
37465>>>End_Class
37466>>>
37466>>>// DPDlg Control
37466>>>// CoClass CLSID:{BE5AB246-F888-11D0-9F5E-B42103C10710}
37466>>>// ProgId: DPDLG.DPDlgCtrl.1
37466>>>// Number of impl.Types:2
37466>>>// Referenced class _DDPDlg
37466>>>// Referenced class _DDPDlgEvents
37466>>>Class OLEDPDlg is a OCX_Client
37467>>>        Import_Class_Protocol OLE_DDPDlg
37468>>>        Import_Class_Protocol OLE_DDPDlgEvents
37469>>>
37469>>>        Procedure Construct_Object
37470>>>                Forward Send Construct_Object
37472>>>                Send DefineOCX_Client
37473>>>                Set progIdStr to "DPDLG.DPDlgCtrl.1"
37474>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEDPDlg"
37477>>>        End_Procedure
37478>>>
37478>>>        Procedure PreDPDlgFolderSelected Integer lParam
37479>>>                Local String lPath
37480>>>                Local Bool lAllow
37480>>>                Get GetEventStringParam lParam 0 to lPath
37481>>>                Get GetEventBoolParam lParam 1 to lAllow
37482>>>                Send OnDPDlgFolderSelected lPath lAllow
37483>>>        End_Procedure
37484>>>
37484>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
37485>>>                ON_EVENT 1 Fire PreDPDlgFolderSelected
37488>>>        End_Procedure
37489>>>End_Class
37490>>>
37490>>>// DPDlg Control
37490>>>// CoClass CLSID:{BE5AB246-F888-11D0-9F5E-B42103C10710}
37490>>>// ProgId: DPDLG.DPDlgCtrl.1
37490>>>// Number of impl.Types:2
37490>>>// Referenced class _DDPDlg
37490>>>// Referenced class _DDPDlgEvents
37490>>>Class dbOLEDPDlg is a dbOCX_Client
37491>>>        Import_Class_Protocol OLE_DDPDlg
37492>>>        Import_Class_Protocol OLE_DDPDlgEvents
37493>>>
37493>>>        Procedure Construct_Object
37494>>>                Forward Send Construct_Object
37496>>>                Send DefineDbOCX_Client
37497>>>                Set progIdStr to "DPDLG.DPDlgCtrl.1"
37498>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEDPDlg"
37501>>>        End_Procedure
37502>>>
37502>>>        Procedure PreDPDlgFolderSelected Integer lParam
37503>>>                Local String lPath
37504>>>                Local Bool lAllow
37504>>>                Get GetEventStringParam lParam 0 to lPath
37505>>>                Get GetEventBoolParam lParam 1 to lAllow
37506>>>                Send OnDPDlgFolderSelected lPath lAllow
37507>>>        End_Procedure
37508>>>
37508>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
37509>>>                ON_EVENT 1 Fire PreDPDlgFolderSelected
37512>>>        End_Procedure
37513>>>End_Class
37514>Use RasxDll  // Ras Package
INCLUDING FILE: RASXDLL.PKG
37514>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\RASX.DLL
37514>>>// Generated by FlexOLE Class Generator Friday, November 08, 2002 15:47:23
37514>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
37514>>>
37514>>>//Enum_List
37514>>>    Define OLERasActionNone         for 0 // No action
37514>>>    Define OLERasActionConnect      for 1 // Connect server
37514>>>    Define OLERasActionGetEntry     for 2 // Get phonebook entry
37514>>>    Define OLERasActionDisconnect   for 3 // Hang up (disconnect from server)
37514>>>    Define OLERasActionRefresh      for 4 // Refresh entries list
37514>>>    Define OLERasActionCreateEntry  for 5 // Create phonebook entry
37514>>>    Define OLERasActionEditEntry    for 6 // Edit phonebook entry
37514>>>//End_Enum_List
37514>>>
37514>>>// IRasXCom Interface
37514>>>// CLSID:{8E71552C-4915-11D3-B4C3-0020AFD69DE6}
37514>>>// ProgId:
37514>>>Class OLEIRasXCom is a Automation_Client
37515>>>
37515>>>// Sets or returns the filename of the phonebook to use.
37515>>>        Function RasXComPhoneBook Returns String
37516>>>                Local String lpropVal
37517>>>                Get GetStringProperty 1 to lpropVal
37518>>>                Function_Return lpropVal
37519>>>        End_Function
37520>>>
37520>>>// Sets or returns the filename of the phonebook to use.
37520>>>        Procedure SET RasXComPhoneBook String lpropVal
37521>>>                Send SetStringProperty 1 lpropVal
37522>>>        End_Procedure
37523>>>
37523>>>// Sets or returns the phone number to dial.
37523>>>        Function RasXComPhoneNumber Returns String
37524>>>                Local String lpropVal
37525>>>                Get GetStringProperty 2 to lpropVal
37526>>>                Function_Return lpropVal
37527>>>        End_Function
37528>>>
37528>>>// Sets or returns the phone number to dial.
37528>>>        Procedure SET RasXComPhoneNumber String lpropVal
37529>>>                Send SetStringProperty 2 lpropVal
37530>>>        End_Procedure
37531>>>
37531>>>// Sets or returns the name to use when logging on.
37531>>>        Function RasXComLogonName Returns String
37532>>>                Local String lpropVal
37533>>>                Get GetStringProperty 3 to lpropVal
37534>>>                Function_Return lpropVal
37535>>>        End_Function
37536>>>
37536>>>// Sets or returns the name to use when logging on.
37536>>>        Procedure SET RasXComLogonName String lpropVal
37537>>>                Send SetStringProperty 3 lpropVal
37538>>>        End_Procedure
37539>>>
37539>>>// Sets or returns the password to use.
37539>>>        Function RasXComLogonPassword Returns String
37540>>>                Local String lpropVal
37541>>>                Get GetStringProperty 4 to lpropVal
37542>>>                Function_Return lpropVal
37543>>>        End_Function
37544>>>
37544>>>// Sets or returns the password to use.
37544>>>        Procedure SET RasXComLogonPassword String lpropVal
37545>>>                Send SetStringProperty 4 lpropVal
37546>>>        End_Procedure
37547>>>
37547>>>// Sets or returns the phone number that a server should call back for certain kinds of verification.
37547>>>        Function RasXComCallbackNumber Returns String
37548>>>                Local String lpropVal
37549>>>                Get GetStringProperty 5 to lpropVal
37550>>>                Function_Return lpropVal
37551>>>        End_Function
37552>>>
37552>>>// Sets or returns the phone number that a server should call back for certain kinds of verification.
37552>>>        Procedure SET RasXComCallbackNumber String lpropVal
37553>>>                Send SetStringProperty 5 lpropVal
37554>>>        End_Procedure
37555>>>
37555>>>// Sets or returns the name of the current phone book entry.
37555>>>        Function RasXComEntryName Returns String
37556>>>                Local String lpropVal
37557>>>                Get GetStringProperty 6 to lpropVal
37558>>>                Function_Return lpropVal
37559>>>        End_Function
37560>>>
37560>>>// Sets or returns the name of the current phone book entry.
37560>>>        Procedure SET RasXComEntryName String lpropVal
37561>>>                Send SetStringProperty 6 lpropVal
37562>>>        End_Procedure
37563>>>
37563>>>// Sets or returns the domain to use for user authentication.
37563>>>        Function RasXComDomain Returns String
37564>>>                Local String lpropVal
37565>>>                Get GetStringProperty 7 to lpropVal
37566>>>                Function_Return lpropVal
37567>>>        End_Function
37568>>>
37568>>>// Sets or returns the domain to use for user authentication.
37568>>>        Procedure SET RasXComDomain String lpropVal
37569>>>                Send SetStringProperty 7 lpropVal
37570>>>        End_Procedure
37571>>>
37571>>>// Determines if methods are blocking.
37571>>>        Function RasXComBlocking Returns Bool
37572>>>                Local Bool lpropVal
37573>>>                Get GetBoolProperty 8 to lpropVal
37574>>>                Function_Return lpropVal
37575>>>        End_Function
37576>>>
37576>>>// Determines if methods are blocking.
37576>>>        Procedure SET RasXComBlocking Bool lpropVal
37577>>>                Send SetBoolProperty 8 lpropVal
37578>>>        End_Procedure
37579>>>
37579>>>// Returns the version of the control.
37579>>>        Function RasXComVersion Returns String
37580>>>                Local String lpropVal
37581>>>                Get GetStringProperty 9 to lpropVal
37582>>>                Function_Return lpropVal
37583>>>        End_Function
37584>>>
37584>>>// Returns the number of names in the current phonebook.
37584>>>        Function RasXComEntryCount Returns Integer
37585>>>                Local Integer lpropVal
37586>>>                Get GetShortProperty 10 to lpropVal
37587>>>                Function_Return lpropVal
37588>>>        End_Function
37589>>>
37589>>>// Returns whether or not RAS services are available.
37589>>>        Function RasXComRASAvailable Returns Bool
37590>>>                Local Bool lpropVal
37591>>>                Get GetBoolProperty 11 to lpropVal
37592>>>                Function_Return lpropVal
37593>>>        End_Function
37594>>>
37594>>>// Holds the last error number reported.
37594>>>        Function RasXComLastError Returns Integer
37595>>>                Local Integer lpropVal
37596>>>                Get GetShortProperty 12 to lpropVal
37597>>>                Function_Return lpropVal
37598>>>        End_Function
37599>>>
37599>>>// Returns the last method executed.
37599>>>        Function RasXComLastMethod Returns OLE_MethodsEnum
37600>>>                Local OLE_MethodsEnum lpropVal
37601>>>                Get GetIntegerProperty 13 to lpropVal
37602>>>                Function_Return lpropVal
37603>>>        End_Function
37604>>>
37604>>>// Holds a description of the last error number reported.
37604>>>        Function RasXComLastErrorString Returns String
37605>>>                Local String lpropVal
37606>>>                Get GetStringProperty 14 to lpropVal
37607>>>                Function_Return lpropVal
37608>>>        End_Function
37609>>>
37609>>>// The current state of the control.
37609>>>        Function RasXComState Returns Integer
37610>>>                Local Integer lpropVal
37611>>>                Get GetShortProperty 15 to lpropVal
37612>>>                Function_Return lpropVal
37613>>>        End_Function
37614>>>
37614>>>// A user-friendly version of the current state of the control.
37614>>>        Function RasXComStateString Returns String
37615>>>                Local String lpropVal
37616>>>                Get GetStringProperty 16 to lpropVal
37617>>>                Function_Return lpropVal
37618>>>        End_Function
37619>>>
37619>>>// Returns the RAS handle of a connection.
37619>>>        Function RasXComHandle Returns DWORD
37620>>>                Local DWORD lpropVal
37621>>>                Get GetIntegerProperty 17 to lpropVal
37622>>>                Function_Return lpropVal
37623>>>        End_Function
37624>>>
37624>>>// Returns whether or not a connection is active.
37624>>>        Function RasXComEntryConnected Returns Bool
37625>>>                Local Bool lpropVal
37626>>>                Get GetBoolProperty 18 to lpropVal
37627>>>                Function_Return lpropVal
37628>>>        End_Function
37629>>>
37629>>>// Returns the list of names in a phone book.
37629>>>        Function RasXComEntryList Integer lIndex Returns String
37630>>>                Local String lpropVal
37631>>>                Send DeclareParams 1
37632>>>                Send DefineShortParam lIndex
37633>>>                Get GetStringProperty 19 to lpropVal
37634>>>                Function_Return lpropVal
37635>>>        End_Function
37636>>>
37636>>>// Holds licensing information.
37636>>>        Function RasXComLicenseKey Returns String
37637>>>                Local String lpropVal
37638>>>                Get GetStringProperty 20 to lpropVal
37639>>>                Function_Return lpropVal
37640>>>        End_Function
37641>>>
37641>>>// Holds licensing information.
37641>>>        Procedure SET RasXComLicenseKey String lpropVal
37642>>>                Send SetStringProperty 20 lpropVal
37643>>>        End_Procedure
37644>>>
37644>>>// Connects to a server.
37644>>>        Procedure RasXComConnect
37645>>>                Send InvokeVoidFunction 22
37646>>>        End_Procedure
37647>>>
37647>>>// Disconnects (logs off) from the server.
37647>>>        Procedure RasXComDisconnect
37648>>>                Send InvokeVoidFunction 23
37649>>>        End_Procedure
37650>>>
37650>>>// Retrives an entry from the current phonebook.
37650>>>        Procedure RasXComGetEntry
37651>>>                Send InvokeVoidFunction 24
37652>>>        End_Procedure
37653>>>
37653>>>// Creates and entry in the current phone book.
37653>>>        Procedure RasXComCreateEntry
37654>>>                Send InvokeVoidFunction 25
37655>>>        End_Procedure
37656>>>
37656>>>// Allows the user to edit a RAS phone book entry.
37656>>>        Procedure RasXComEditEntry
37657>>>                Send InvokeVoidFunction 26
37658>>>        End_Procedure
37659>>>
37659>>>// Resets the component to its original state and re-loads the phone book.
37659>>>        Procedure RasXComRefresh
37660>>>                Send InvokeVoidFunction -550
37661>>>        End_Procedure
37662>>>
37662>>>// Displays About Box.
37662>>>        Procedure RasXComAbout
37663>>>                Send InvokeVoidFunction -552
37664>>>        End_Procedure
37665>>>
37665>>>// Allows object to unload without disconnecting the current connection.
37665>>>        Function RasXComDisconnectOnDestroy Returns Bool
37666>>>                Local Bool lpropVal
37667>>>                Get GetBoolProperty 28 to lpropVal
37668>>>                Function_Return lpropVal
37669>>>        End_Function
37670>>>
37670>>>// Allows object to unload without disconnecting the current connection.
37670>>>        Procedure SET RasXComDisconnectOnDestroy Bool lpropVal
37671>>>                Send SetBoolProperty 28 lpropVal
37672>>>        End_Procedure
37673>>>
37673>>>// Sets or returns an object reference to an object supporting the Fast Notification interface.
37673>>>        Function RasXComNotificationObject Returns LPDispatch
37674>>>                Local LPDispatch lpropVal
37675>>>                Get GetLPDispatchProperty 27 to lpropVal
37676>>>                Function_Return lpropVal
37677>>>        End_Function
37678>>>
37678>>>// Sets or returns an object reference to an object supporting the Fast Notification interface.
37678>>>        Procedure SET RasXComNotificationObject LPDispatch lpropVal
37679>>>                Send SetLPDispatchProperty 27 lpropVal
37680>>>        End_Procedure
37681>>>
37681>>>// Returns the version of the control.
37681>>>        Procedure SET RasXComVersion String lpropVal
37682>>>                Send SetStringProperty 9 lpropVal
37683>>>        End_Procedure
37684>>>
37684>>>End_Class
37685>>>
37685>>>// _IRasXComEvents Interface
37685>>>// CLSID:{8E71552E-4915-11D3-B4C3-0020AFD69DE6}
37685>>>// ProgId:
37685>>>Class OLE_IRasXComEvents is a Automation_Client
37686>>>
37686>>>// Fired when a method finishes.
37686>>>        Procedure RasXComDone OLE_MethodsEnum lLastMethod Integer lErrorCode String lErrorString
37687>>>                Send DeclareParams 3
37688>>>                Send DefineIntegerParam lLastMethod
37689>>>                Send DefineShortParam lErrorCode
37690>>>                Send DefineStringParam lErrorString
37691>>>                Send InvokeVoidFunction 1
37692>>>        End_Procedure
37693>>>
37693>>>// Fired when the control's internal state changes.
37693>>>        Procedure RasXComStateChanged Integer lNewState Integer lOldState
37694>>>                Send DeclareParams 2
37695>>>                Send DefineShortParam lNewState
37696>>>                Send DefineShortParam lOldState
37697>>>                Send InvokeVoidFunction 2
37698>>>        End_Procedure
37699>>>
37699>>>End_Class
37700>>>
37700>>>// RasXCom Class
37700>>>// CoClass CLSID:{8E71552D-4915-11D3-B4C3-0020AFD69DE6}
37700>>>// ProgId: Mabry.RasXCom.1
37700>>>// Number of impl.Types:2
37700>>>// Referenced class IRasXCom
37700>>>// Referenced class _IRasXComEvents
37700>>>Class OLERasXCom is a Automation_Client
37701>>>        Import_Class_Protocol OLEIRasXCom
37702>>>        Import_Class_Protocol OLE_IRasXComEvents
37703>>>
37703>>>        Procedure Construct_Object
37704>>>                Forward Send Construct_Object
37706>>>        Set progIdStr to "Mabry.RasXCom"
37707>>>        End_Procedure
37708>>>End_Class
37709>>>
37709>>>// IRasXComNotify Interface
37709>>>// CLSID:{40B44160-49E0-11D3-B4C3-0020AFD69DE6}
37709>>>// ProgId:
37709>>>Class OLEIRasXComNotify is a Automation_Client
37710>>>
37710>>>// Done
37710>>>        Procedure IRasXComNotifyDone LPDispatch lPackageObject OLE_MethodsEnum lLastMethod Integer lErrorCode String lErrorString
37711>>>                Send DeclareParams 4
37712>>>                Send DefineLPDispatchParam lPackageObject
37713>>>                Send DefineIntegerParam lLastMethod
37714>>>                Send DefineShortParam lErrorCode
37715>>>                Send DefineStringParam lErrorString
37716>>>                Send InvokeVoidFunction 1
37717>>>        End_Procedure
37718>>>
37718>>>// Fired when the control's internal state changes.
37718>>>        Procedure IRasXComNotifyStateChanged LPDispatch lPackageObject Integer lNewState Integer lOldState
37719>>>                Send DeclareParams 3
37720>>>                Send DefineLPDispatchParam lPackageObject
37721>>>                Send DefineShortParam lNewState
37722>>>                Send DefineShortParam lOldState
37723>>>                Send InvokeVoidFunction 2
37724>>>        End_Procedure
37725>>>
37725>>>End_Class
37726>Use Xfind    // Recursive Directory FILE FINDER
INCLUDING FILE: XFIND.PKG
37726>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\XFIND10DEMO.OCX
37726>>>// Generated by FlexOLE Class Generator Friday, November 10, 2000 16:23:24
37726>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
37726>>>
37726>>>// Dispatch interface for xfind Control
37726>>>// CLSID:{DF5A0221-37A0-11D4-881C-E7F891A83074}
37726>>>// ProgId: 
37726>>>Class OLEIxfind is a Message
37727>>>
37727>>>        Procedure xfindAboutBox
37728>>>                Send InvokeVoidFunction -552
37729>>>        End_Procedure 
37730>>>
37730>>>        Function xfindSearchString Returns String
37731>>>                Local String lpropVal
37732>>>                Get GetStringProperty 6 to lpropVal
37733>>>                Function_Return lpropVal
37734>>>        End_Function
37735>>>
37735>>>        Procedure SET xfindSearchString String lpropVal
37736>>>                Send SetStringProperty 6 lpropVal
37737>>>        End_Procedure
37738>>>
37738>>>        Function xfindSearchFrom Returns String
37739>>>                Local String lpropVal
37740>>>                Get GetStringProperty 7 to lpropVal
37741>>>                Function_Return lpropVal
37742>>>        End_Function
37743>>>
37743>>>        Procedure SET xfindSearchFrom String lpropVal
37744>>>                Send SetStringProperty 7 lpropVal
37745>>>        End_Procedure
37746>>>
37746>>>        Function xfindSearchSubDirs Returns Bool
37747>>>                Local Bool lpropVal
37748>>>                Get GetBoolProperty 8 to lpropVal
37749>>>                Function_Return lpropVal
37750>>>        End_Function
37751>>>
37751>>>        Procedure SET xfindSearchSubDirs Bool lpropVal
37752>>>                Send SetBoolProperty 8 lpropVal
37753>>>        End_Procedure
37754>>>
37754>>>        Procedure xfindStartSearching
37755>>>                Send InvokeVoidFunction 2
37756>>>        End_Procedure 
37757>>>
37757>>>        Function xfindIsSearching Returns Bool
37758>>>                Local Bool lpropVal
37759>>>                Get GetBoolProperty 5 to lpropVal
37760>>>                Function_Return lpropVal
37761>>>        End_Function
37762>>>
37762>>>        Procedure xfindAbortSearch
37763>>>                Send InvokeVoidFunction 9
37764>>>        End_Procedure 
37765>>>
37765>>>        Function xfindFileName Returns String
37766>>>                Local String lpropVal
37767>>>                Get GetStringProperty 3 to lpropVal
37768>>>                Function_Return lpropVal
37769>>>        End_Function
37770>>>
37770>>>        Function xfindFileSize Returns DWORD
37771>>>                Local DWORD lpropVal
37772>>>                Get GetIntegerProperty 4 to lpropVal
37773>>>                Function_Return lpropVal
37774>>>        End_Function
37775>>>
37775>>>End_Class
37776>>>
37776>>>// Events interface for xfind Control
37776>>>// CLSID:{DF5A0223-37A0-11D4-881C-E7F891A83074}
37776>>>// ProgId: 
37776>>>Class OLEIxfindEvents is a Message
37777>>>
37777>>>        Procedure OnxfindActivate
37778>>>        End_Procedure
37779>>>
37779>>>        Procedure OnxfindClick
37780>>>        End_Procedure
37781>>>
37781>>>        Procedure OnxfindCreate
37782>>>        End_Procedure
37783>>>
37783>>>        Procedure OnxfindDblClick
37784>>>        End_Procedure
37785>>>
37785>>>        Procedure OnxfindDestroy
37786>>>        End_Procedure
37787>>>
37787>>>        Procedure OnxfindDeactivate
37788>>>        End_Procedure
37789>>>
37789>>>        Procedure OnxfindKeyPress Integer lKey
37790>>>        End_Procedure
37791>>>
37791>>>        Procedure OnxfindPaint
37792>>>        End_Procedure
37793>>>
37793>>>        Procedure OnxfindFinishedSearch
37794>>>        End_Procedure
37795>>>
37795>>>        Procedure OnxfindFoundFile
37796>>>        End_Procedure
37797>>>
37797>>>End_Class
37798>>>
37798>>>// xfind Control
37798>>>// CoClass CLSID:{DF5A0225-37A0-11D4-881C-E7F891A83074}
37798>>>// ProgId: xfind10.xfind
37798>>>// Number of impl.Types:2
37798>>>// Referenced class Ixfind
37798>>>// Referenced class IxfindEvents
37798>>>Class OLExfind is a OCX_Client
37799>>>        Import_Class_Protocol OLEIxfind
37800>>>        Import_Class_Protocol OLEIxfindEvents
37801>>>
37801>>>        Procedure Construct_Object
37802>>>                Forward Send Construct_Object
37804>>>                Send DefineOCX_Client
37805>>>                Set progIdStr to "xfind10.xfind"
37806>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLExfind"
37809>>>        End_Procedure
37810>>>
37810>>>        Procedure PrexfindKeyPress Integer lParam
37811>>>                Local Integer lKey
37812>>>                Get GetEventShortParam lParam 0 to lKey
37813>>>                Send OnxfindKeyPress lKey
37814>>>        End_Procedure
37815>>>
37815>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
37816>>>                ON_EVENT 1 Fire OnxfindActivate
37819>>>                ON_EVENT 2 Fire OnxfindClick
37822>>>                ON_EVENT 3 Fire OnxfindCreate
37825>>>                ON_EVENT 5 Fire OnxfindDblClick
37828>>>                ON_EVENT 6 Fire OnxfindDestroy
37831>>>                ON_EVENT 7 Fire OnxfindDeactivate
37834>>>                ON_EVENT 11 Fire PrexfindKeyPress
37837>>>                ON_EVENT 16 Fire OnxfindPaint
37840>>>                ON_EVENT 4 Fire OnxfindFinishedSearch
37843>>>                ON_EVENT 8 Fire OnxfindFoundFile
37846>>>        End_Procedure
37847>>>End_Class
37848>>>
37848>>>// xfind Control
37848>>>// CoClass CLSID:{DF5A0225-37A0-11D4-881C-E7F891A83074}
37848>>>// ProgId: xfind10.xfind
37848>>>// Number of impl.Types:2
37848>>>// Referenced class Ixfind
37848>>>// Referenced class IxfindEvents
37848>>>Class dbOLExfind is a dbOCX_Client
37849>>>        Import_Class_Protocol OLEIxfind
37850>>>        Import_Class_Protocol OLEIxfindEvents
37851>>>
37851>>>        Procedure Construct_Object
37852>>>                Forward Send Construct_Object
37854>>>                Send DefineDbOCX_Client
37855>>>                Set progIdStr to "xfind10.xfind"
37856>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLExfind"
37859>>>        End_Procedure
37860>>>
37860>>>        Procedure PrexfindKeyPress Integer lParam
37861>>>                Local Integer lKey
37862>>>                Get GetEventShortParam lParam 0 to lKey
37863>>>                Send OnxfindKeyPress lKey
37864>>>        End_Procedure
37865>>>
37865>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
37866>>>                ON_EVENT 1 Fire OnxfindActivate
37869>>>                ON_EVENT 2 Fire OnxfindClick
37872>>>                ON_EVENT 3 Fire OnxfindCreate
37875>>>                ON_EVENT 5 Fire OnxfindDblClick
37878>>>                ON_EVENT 6 Fire OnxfindDestroy
37881>>>                ON_EVENT 7 Fire OnxfindDeactivate
37884>>>                ON_EVENT 11 Fire PrexfindKeyPress
37887>>>                ON_EVENT 16 Fire OnxfindPaint
37890>>>                ON_EVENT 4 Fire OnxfindFinishedSearch
37893>>>                ON_EVENT 8 Fire OnxfindFoundFile
37896>>>        End_Procedure
37897>>>End_Class
37898>Use dvFtp    // FTP Package
INCLUDING FILE: DVFTP.PKG
37898>>>// DVFTP.PKG - Internet File Transfer Protocol (FTP) functions
37898>>>//             for Visual Dataflex
37898>>>//
37898>>>// Created by: Marcel J. Zwiebel
37898>>>//             Dataview - The Netherlands
37898>>>// E-mail    : marcel@dataview-sc.com
37898>>>// CIS id    : 100273,2473
37898>>>// Web URL   : http://www.dataview-sc.com
37898>>>//
37898>>>// Date      : 28/07/1997 
37898>>>
37898>>>Use Windows.pkg
37898>>>Use DLL.pkg
37898>>>
37898>>>// register external functions of the dvftp.dll
37898>>>
37898>>>
37898>>>// function   : dvInternetAttemptConnect
37898>>>//
37898>>>// description: Attemps to make a connection to the Internet. If the user has a dialup-connection
37898>>>//              to an Internet Service Provider (ISP) and the computer is not connected to this 
37898>>>//              ISP, the standard dialup dialog box will be evoked.
37898>>>//                   
37898>>>// parameters : none
37898>>>//
37898>>>// returns    : integer - Is 0 (ok) or error-number.
37898>>>//
37898>>>External_Function dvInternetAttemptConnect "dvInternetAttemptConnect" DVFTP.DLL ;     Returns Integer
37899>>>
37899>>>
37899>>>// function   : dvInternetOpen
37899>>>//
37899>>>// description: Initializes the application's use of the WIN32 Internet functions.
37899>>>//
37899>>>// parameters : none
37899>>>//
37899>>>// returns    : integer - Is 0 (ok) or error-number.
37899>>>//
37899>>>External_Function dvInternetOpen "dvInternetOpen" DVFTP.DLL ;     Returns Integer
37900>>>
37900>>>
37900>>>// function   : dvInternetConnect
37900>>>//
37900>>>// description: Opens an FTP-session with a server.
37900>>>//
37900>>>// parameters : string ServerName - Can be a DNS-name (for example: ftp.daccess.com) or 
37900>>>//                                  an ip-number (for example: 145.58.31.4).
37900>>>//              string UserName   - Login-name for the server, can be empty for 
37900>>>//                                  "anonymous" login (default for most FTP servers).
37900>>>//              string Password   - Password for the server, can be empty for 
37900>>>//                                  "anonymous" login (default for most FTP servers).
37900>>>//              integer Firewall  - Must be 1 for connecting through a SOCKS firewall
37900>>>//                                  server, otherwise 0.
37900>>>//
37900>>>// returns    : integer - Is 0 (ok) or error-number.
37900>>>//
37900>>>External_Function dvInternetConnect "dvInternetConnect" DVFTP.DLL ;     String szServerName String szUserName String szPassword Integer iFirewall;     Returns Integer
37901>>>
37901>>>
37901>>>// function   : dvFtpSetCurrentDirectory
37901>>>//
37901>>>// description: Changes to a different working directory on the FTP server.
37901>>>//
37901>>>// parameters : string directory - Name of the directory to change to on the remote system. 
37901>>>//                                 This can be either a fully qualified path or a name 
37901>>>//                                 relative to the current directory. 
37901>>>//                                 A backslash (\) or forward slash (/) can be used as the 
37901>>>//                                 directory separator for either name. dvFtpSetCurrentDirectory
37901>>>//                                 translates the directory name separators to the appropriate 
37901>>>//                                 character before they are used. 
37901>>>//                                 Use dvFtpGetCurrentDirectory to determine the remote site's 
37901>>>//                                 current working directory (not all remote systems use a
37901>>>//                                 hierarchical naming scheme for directories).
37901>>>//
37901>>>// returns    : integer - Is 0 (ok) or error-number.
37901>>>//
37901>>>External_Function dvFtpSetCurrentDirectory "dvFtpSetCurrentDirectory" DVFTP.DLL ;     String szDirectory Returns Integer
37902>>>
37902>>>
37902>>>// function   : dvFtpGetCurrentDirectory
37902>>>//
37902>>>// description: Retrieves the current directory for the specified FTP session.
37902>>>//
37902>>>// parameters : none
37902>>>//
37902>>>// returns    : string - Name of the current directory.
37902>>>//
37902>>>External_Function dvFtpGetCurrentDirectory "dvFtpGetCurrentDirectory" DVFTP.DLL ;     Returns String
37903>>>
37903>>>
37903>>>// function   : dvFtpCreateDirectory
37903>>>//
37903>>>// description: Creates a new directory on the FTP server. 
37903>>>//
37903>>>// parameters : string Directory - The name of the directory to create on the remote system.
37903>>>//                                 This can be either a fully qualified path or a name 
37903>>>//                                 relative to the current directory. 
37903>>>//                                 A backslash (\) or forward slash (/) can be used as the 
37903>>>//                                 directory separator for either name. dvFtpCreateDirectory
37903>>>//                                 translates the directory name separators to the appropriate 
37903>>>//                                 character before they are used. 
37903>>>//                                 Use dvFtpGetCurrentDirectory to determine the remote site's 
37903>>>//                                 current working directory (not all remote systems use a
37903>>>//                                 hierarchical naming scheme for directories).
37903>>>//
37903>>>// returns    : integer - Is 0 (ok) or error-number.
37903>>>//
37903>>>External_Function dvFtpCreateDirectory "dvFtpCreateDirectory" DVFTP.DLL ;     String szDirectory Returns Integer
37904>>>
37904>>>
37904>>>// function   : dvFtpRemoveDirectory
37904>>>//
37904>>>// description: Removes the specified directory on the FTP server. 
37904>>>//
37904>>>// parameters : string Directory - The name of the directory to remove on the remote system.
37904>>>//                                 This can be either a fully qualified path or a name 
37904>>>//                                 relative to the current directory. 
37904>>>//                                 A backslash (\) or forward slash (/) can be used as the 
37904>>>//                                 directory separator for either name. dvFtpRemoveDirectory
37904>>>//                                 translates the directory name separators to the appropriate 
37904>>>//                                 character before they are used. 
37904>>>//                                 Use dvFtpGetCurrentDirectory to determine the remote site's 
37904>>>//                                 current working directory (not all remote systems use a
37904>>>//                                 hierarchical naming scheme for directories).
37904>>>//
37904>>>// returns    : integer - Is 0 (ok) or error-number.
37904>>>//
37904>>>External_Function dvFtpRemoveDirectory "dvFtpRemoveDirectory" DVFTP.DLL ;     String szDirectory Returns Integer
37905>>>
37905>>>
37905>>>// function   : dvFtpFindFirstFile
37905>>>//
37905>>>// description: Searches the specified directory of the given FTP session.
37905>>>//
37905>>>// parameters : string FileSelect - A valid directory path or file name (wildcards allowed) for
37905>>>//                                  the FTP server's file system. If the string is empty the 
37905>>>//                                  first file in the current directory on the server will be 
37905>>>//                                  searched for. 
37905>>>//              integer UseCache  - Indicates using the local computer's cache.
37905>>>//                                  If the value is 0 then the the cache will be used. 
37905>>>//                                  If the value is 1 then a download of the requested file, 
37905>>>//                                  object, or directory listing from the origin server will be 
37905>>>//                                  forced, not from the cache.
37905>>>//
37905>>>// returns    : string - Name of the first file found or empty when no files found. When the 
37905>>>//                       searched directory is empty the string "directory is empty" is returned.
37905>>>//
37905>>>External_Function dvFtpFindFirstFile "dvFtpFindFirstFile" DVFTP.DLL ;     String szFileSelect Integer iUseCache Returns String
37906>>>
37906>>>
37906>>>// function   : dvFtpFindNextFile
37906>>>//
37906>>>// description: Continues a file search started as a result of executing dvFtpFindFirstFile.
37906>>>//
37906>>>// parameters : none
37906>>>//
37906>>>// returns    : string - Name of the next file found or empty when no more files are found.
37906>>>//
37906>>>External_Function dvFtpFindNextFile "dvFtpFindNextFile" DVFTP.DLL ;     Returns String
37907>>>
37907>>>
37907>>>// function   : dvFtpDeleteFile
37907>>>//
37907>>>// description: Deletes a file stored on the FTP server. 
37907>>>//
37907>>>// parameters : string FileSelect - Name of the file to be deleted.
37907>>>//                                  Can be file names relative to the current directory. 
37907>>>//                                  A backslash (\) or forward slash (/) can be used as 
37907>>>//                                  the directory separator. dvFtpDeleteFile translates the 
37907>>>//                                  directory name separators to the appropriate character 
37907>>>//                                  before they are used. 
37907>>>//
37907>>>// returns    : integer - Is 0 (ok) or error-number.
37907>>>//
37907>>>External_Function dvFtpDeleteFile "dvFtpDeleteFile" DVFTP.DLL ;     String szFileSelect Returns Integer
37908>>>
37908>>>
37908>>>// function   : dvFtpRenameFile
37908>>>//
37908>>>// description: Renames a file stored on the FTP server. 
37908>>>//
37908>>>// parameters : string Existing - The name of the file that will have its name changed on the
37908>>>//                                remote FTP server. 
37908>>>//              string New      - The new name for the remote file. 
37908>>>//
37908>>>//                                Both names can be relative to the current directory. A backslash 
37908>>>//                                (\) or forward slash (/) can be used as the directory separator 
37908>>>//                                for either name. dvFtpRenameFile translates the directory name 
37908>>>//                                separators to the appropriate character before they are used. 
37908>>>//
37908>>>// returns    : integer - Is 0 (ok) or error-number.
37908>>>//
37908>>>External_Function dvFtpRenameFile "dvFtpRenameFile" DVFTP.DLL ;     String szExisting String szNew Returns Integer
37909>>>
37909>>>
37909>>>// function   : dvFtpGetFile
37909>>>//
37909>>>// description: Retrieves a file from the FTP server and stores it under the specified file name, 
37909>>>//              creating a new local file in the process. 
37909>>>//
37909>>>// parameters : string  RemoteFile   - The name of the file to retrieve from the remote system. 
37909>>>//              string  NewFile      - The name of the file to create on the local system. 
37909>>>//              integer FailIfExists - Boolean flag that indicates whether the function should 
37909>>>//                                     proceed if a local file of the specified name already exists. 
37909>>>//                                     If value is 1 and the local file exists, dvFtpGetFile fails. 
37909>>>//              integer FileType     - Indicates the transfer method.
37909>>>//                                     If the value is 0 then the function transfers the file using 
37909>>>//                                     FTP's ASCII (Type A) transfer method. Control and formatting 
37909>>>//                                     information is converted to local equivalents. 
37909>>>//                                     If the value is 1 then the function transfers the file using 
37909>>>//                                     FTP's Image (Type I) transfer method. The file is transferred 
37909>>>//                                     exactly as it exists with no changes. 
37909>>>//
37909>>>// returns    : integer - Is 0 (ok) or error-number.
37909>>>//
37909>>>External_Function dvFtpGetFile "dvFtpGetFile" DVFTP.DLL ;     String szRemoteFile String szNewFile Integer bFailIfExists Integer iFileType Returns Integer
37910>>>
37910>>>
37910>>>// function   : dvFtpPutFile
37910>>>//
37910>>>// description: Stores a file on the FTP server. 
37910>>>//
37910>>>// parameters : string  LocalFile     - The name of the file to send from the local system. 
37910>>>//              string  NewRemoteFile - The name of the file to create on the remote system.
37910>>>//              integer FileType      - Indicates the transfer method.
37910>>>//                                      If the value is 0 then the function transfers the 
37910>>>//                                      file as ASCII. 
37910>>>//                                      If the value is 1 then the function transfres the
37910>>>//                                      file as binary. 
37910>>>//
37910>>>// returns    : integer - Is 0 (ok) or error-number.
37910>>>//
37910>>>External_Function dvFtpPutFile "dvFtpPutFile" DVFTP.DLL ;     String szLocalFile String szNewRemoteFile Integer iFileType Returns Integer
37911>>>
37911>>>
37911>>>
37911>>>// The following functions give common file-information after performing dvFtpFindFirstFile
37911>>>// and dvFtpFindNextFile. Because the FTP protocol provides no standard means of enumerating, 
37911>>>// some of the common information about files, such as file creation date and time, is not 
37911>>>// always available or correct. When this happens, dvFtpFindFirstFile and dvFtpFindNextFile 
37911>>>// fill in unavailable information with a best guess based on available information. For example,
37911>>>// creation and last access dates will often be the same as the file's modification date.
37911>>>
37911>>>
37911>>>// function   : dvFtpFilename
37911>>>//
37911>>>// description: The name of the file. 
37911>>>//
37911>>>// parameters : none
37911>>>//
37911>>>// returns    : string - Name of the file
37911>>>//
37911>>>External_Function dvFtpFilename "dvFtpFilename" DVFTP.DLL ;     Returns String
37912>>>
37912>>>
37912>>>// function   : dvFtpAlternateFilename
37912>>>//
37912>>>// description: An alternative name for the file. This name is in the classic 8.3 (filename.ext)
37912>>>//              filename format.
37912>>>//
37912>>>// parameters : none
37912>>>//
37912>>>// returns    : string - Alternate name for the file. If the file has a long filename, the complete 
37912>>>//                       name can be retrieved by the dvFtpFilename function, and the 8.3 format
37912>>>//                       truncated version of the name can be retrieved with this function. Otherwise, 
37912>>>//                       this function returns an empty string.
37912>>>//
37912>>>External_Function dvFtpAlternateFilename "dvFtpAlternateFilename" DVFTP.DLL ;     Returns String
37913>>>
37913>>>
37913>>>// function   : dvFtpFileCreated
37913>>>//              
37913>>>// description: The date/time the file was created in 24-hour format.
37913>>>//
37913>>>// parameters : integer DateFormat - The format of the date to be retrieved.
37913>>>//                                   If value is 0 then US-formatted date is returned (mm/dd/yyyy).
37913>>>//                                   If value is 1 then European-formatted date is returned (dd/mm/yyyy).
37913>>>//                                   If value is 2 then military-formatted date is returned (yyyy.mm.dd).
37913>>>//
37913>>>// returns    : string - The file creation-date/time
37913>>>//
37913>>>External_Function dvFtpFileCreated "dvFtpFileCreated" DVFTP.DLL ;     Integer iDateFormat Returns String
37914>>>
37914>>>
37914>>>// function   : dvFtpFileAccessed
37914>>>//              
37914>>>// description: The last date/time the file was accessed in 24-hour format.
37914>>>//
37914>>>// parameters : integer DateFormat - The format of the date to be retrieved.
37914>>>//                                   If value is 0 then US-formatted date is returned (mm/dd/yyyy).
37914>>>//                                   If value is 1 then European-formatted date is returned (dd/mm/yyyy).
37914>>>//                                   If value is 2 then military-formatted date is returned (yyyy.mm.dd).
37914>>>//
37914>>>// returns    : string - The last file access-date/time
37914>>>//
37914>>>External_Function dvFtpFileAccessed "dvFtpFileAccessed" DVFTP.DLL ;     Integer iDateFormat Returns String
37915>>>
37915>>>
37915>>>// function   : dvFtpFileWritten
37915>>>//              
37915>>>// description: The last date/time the file was written to in 24-hour format.
37915>>>//
37915>>>// parameters : integer DateFormat - The format of the date to be retrieved.
37915>>>//                                   If value is 0 then US-formatted date is returned (mm/dd/yyyy).
37915>>>//                                   If value is 1 then European-formatted date is returned (dd/mm/yyyy).
37915>>>//                                   If value is 2 then military-formatted date is returned (yyyy.mm.dd).
37915>>>//
37915>>>// returns    : string - The last file written to-date/time
37915>>>//
37915>>>External_Function dvFtpFileWritten "dvFtpFileWritten" DVFTP.DLL ;     Integer iDateFormat Returns String
37916>>>
37916>>>
37916>>>// function   : dvFtpFileSize
37916>>>//              
37916>>>// description: The size of the file in bytes.
37916>>>//
37916>>>// parameters : none
37916>>>//
37916>>>// returns    : integer - Filesize in bytes.
37916>>>//
37916>>>External_Function dvFtpFileSize "dvFtpFileSize" DVFTP.DLL ;     Returns Integer
37917>>>
37917>>>
37917>>>// function   : dvFtpIsDirectory
37917>>>//              
37917>>>// description: The file is an directory.
37917>>>//
37917>>>// parameters : none
37917>>>//
37917>>>// returns    : integer - If value is 1 the file is directory, otherwise 0 will be returned.
37917>>>//
37917>>>External_Function dvFtpIsDirectory "dvFtpIsDirectory" DVFTP.DLL ;     Returns Integer
37918>>>
37918>>>
37918>>>// function   : dvGetServerMsg
37918>>>//              
37918>>>// description: Gets the returned message from the FTP server (error-number will
37918>>>//              be 12003 "extended error").
37918>>>//
37918>>>// parameters : none
37918>>>//
37918>>>// returns    : string - Return message from the FTP server.
37918>>>//
37918>>>External_Function dvGetServerMsg "dvGetServerMsg" DVFTP.DLL;     Returns String
37919>>>
37919>>>
37919>>>// error-numbers returned
37919>>>//
37919>>>// 12001  "out of handles"            
37919>>>// 12002  "timeout"
37919>>>// 12003  "extended error"
37919>>>// 12004  "internal error"            
37919>>>// 12005  "invalid url"               
37919>>>// 12006  "unrecognized scheme"       
37919>>>// 12007  "name not resolved"         
37919>>>// 12008  "protocol not found"        
37919>>>// 12009  "invalid option"            
37919>>>// 12010  "bad option length"         
37919>>>// 12011  "option not settable"      
37919>>>// 12012  "shutdown"                  
37919>>>// 12013  "incorrect user name"       
37919>>>// 12014  "incorrect password"
37919>>>// 12015  "login failure"             
37919>>>// 12016  "invalid operation"         
37919>>>// 12017  "operation cancelled"       
37919>>>// 12018  "incorrect handle type"     
37919>>>// 12019  "incorrect handle state"
37919>>>// 12020  "not proxy request"         
37919>>>// 12021  "registry value not found"
37919>>>// 12022  "bad registry parameter"    
37919>>>// 12023  "no direct access"          
37919>>>// 12024  "no context"                
37919>>>// 12025  "no callback"               
37919>>>// 12026  "request pending"           
37919>>>// 12027  "incorrect format"          
37919>>>// 12028  "item not found"            
37919>>>// 12029  "cannot connect"            
37919>>>// 12030  "connection aborted"        
37919>>>// 12031  "connection reset"          
37919>>>// 12032  "force retry"               
37919>>>// 12033  "invalid proxy request"     
37919>>>// 12034  "need ui"                   
37919>>>// 12036  "handle exists"             
37919>>>// 12037  "sec cert date invalid"     
37919>>>// 12038  "sec cert cn invalid"       
37919>>>// 12039  "http to https on redir"    
37919>>>// 12040  "https to http on_redir"    
37919>>>// 12041  "mixed security"            
37919>>>// 12042  "chg post is non secure"    
37919>>>// 12043  "post is non_secure"        
37919>>>// 12044  "client auth cert needed"   
37919>>>// 12045  "invalid ca"                
37919>>>// 12046  "client auth not setup"     
37919>>>// 12047  "async thread failed"       
37919>>>// 12048  "redirect scheme change"    
37919>>>// 12049  "dialog pending"            
37919>>>// 12050  "retry dialog"              
37919>>>// 12110  "ftp transfer in progress"  
37919>>>// 12111  "ftp dropped"               
37919>>>// 12112  "ftp no passive mode"       
37919>>>// 12157  "security channel error"    
37919>>>// 12158  "unable to cache file"      
37919>>>// 12159  "tcpip not installed"       
37919>>>// 12163  "disconnected"              
37919>>>// 12164  "server unreachable"        
37919>>>// 12165  "proxy server unreachable"  
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>>>
37919>Use DVDIALER // Vdf6 Dialer
INCLUDING FILE: DVDIALER.PKG
37919>>>// DVDIALER.PKG - Automatic dialing functions for dial-up access to the Internet
37919>>>//
37919>>>// Created by: Marcel J. Zwiebel
37919>>>//             Dataview - The Netherlands
37919>>>// E-mail    : marcel@dataview-sc.com
37919>>>// Web URL   : http://www.dataview-sc.com
37919>>>//
37919>>>// Date      : 03/24/1999
37919>>>
37919>>>Use Windows.pkg
37919>>>Use DLL.pkg 
37919>>>
37919>>>
37919>>>// register external functions of the dvdailer.dll
37919>>>
37919>>>
37919>>>// function   : dvInternetGetConnectedState
37919>>>//
37919>>>// description: Retrieves the connected state of the local system.
37919>>>//                   
37919>>>// parameters : none
37919>>>//
37919>>>// returns    : integer - value 1 = the local system is (currently) connected by a modem to the Internet.
37919>>>//                              2 = the local system uses a local area network to connect to the Internet.
37919>>>//                              3 = the local system uses a proxy server to connect to the Internet.
37919>>>//                              4 = the local system's modem is busy with a non-Internet connection.
37919>>>//                              0 = there is no Internet connection.
37919>>>//
37919>>>External_Function32 dvInternetGetConnectedState "dvInternetGetConnectedState" DVDIALER.DLL Returns Integer
37920>>>
37920>>>
37920>>>// function   : dvInternetAutodial
37920>>>//
37920>>>// description: Automatically causes the modem to dial the default Internet connection.
37920>>>//              Use the function dvInternetAutodialHangup to hangup this connection.
37920>>>//                   
37920>>>// parameters : none
37920>>>//
37920>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37920>>>//
37920>>>External_Function32 dvInternetAutodial "dvInternetAutodial" DVDIALER.DLL Returns Integer
37921>>>
37921>>>
37921>>>// function   : dvInternetAutodialHangup
37921>>>//
37921>>>// description: Disconnects an automatic dial-up connection invoked by dvInternetAutodial. 
37921>>>//                   
37921>>>// parameters : none
37921>>>//
37921>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37921>>>//
37921>>>External_Function32 dvInternetAutodialHangup "dvInternetAutodialHangup" DVDIALER.DLL Returns Integer
37922>>>
37922>>>
37922>>>// function   : dvInternetDial
37922>>>//
37922>>>// description: Initiates a connection to the Internet using a modem connection and a phonebook entry.
37922>>>//              Use the function dvInternetHangup to hangup this connection.
37922>>>//                   
37922>>>// parameters : string - The name of the dial-up connection to use (phonebook entry).
37922>>>//
37922>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37922>>>//
37922>>>External_Function32 dvInternetDial "dvInternetDial" DVDIALER.DLL String szConnectiontoid Returns Integer
37923>>>
37923>>>
37923>>>// function   : dvInternetHangup
37923>>>//
37923>>>// description: Instructs the modem to disconnect from the Internet (connection invoked by dvInternetDial). 
37923>>>//              
37923>>>// parameters : none
37923>>>//
37923>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37923>>>//
37923>>>External_Function32 dvInternetHangUp "dvInternetHangUp" DVDIALER.DLL Returns Integer
37924>>>
37924>>>
37924>>>
37924>>>
37924>>>
37924>>>
37924>>>
37924>>>
37924>>>
37924>>>
37924>>>
37924>>>
37924>Use mbForm
INCLUDING FILE: MBFORM.PKG
37924>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\MBFORMEX.OCX
37924>>>// Generated by FlexOLE Class Generator Friday, February 07, 2003 15:11:24
37924>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
37924>>>
37924>>>//Enum_List
37924>>>        Define OLEmbNone for 0 // mbNone
37924>>>        Define OLEmbClientOnly for 1 // mbClientOnly
37924>>>        Define OLEmbWindow for 2 // mbWindow
37924>>>//End_Enum_List
37924>>>
37924>>>// CLSID:{2BF273CB-D8EB-11D3-8ED1-CFAA7A653C7F}
37924>>>// ProgId:
37924>>>Class OLE_FormEx is a Message
37925>>>
37925>>>// Opens the AboutBox dialog.
37925>>>        Procedure FormExAbout
37926>>>                Send InvokeVoidFunction -552
37927>>>        End_Procedure
37928>>>
37928>>>// Saves the position and the size of all the controls. This method is useful if you add controls at runtime and you want to save their position and size as the ResizeControls can work correctly.
37928>>>        Procedure FormExSaveCtlPos
37929>>>                Send InvokeVoidFunction 1610809379
37930>>>        End_Procedure
37931>>>
37931>>>// Adds a item to the system menu and returns its identifier.
37931>>>        Function FormExAddSysItem LPString lsText Returns DWORD
37932>>>                Local DWORD lretVal
37933>>>                Send DeclareParams 1
37934>>>                Send DefineIntegerParam lsText
37935>>>                Get InvokeIntegerFunction 1610809363 to lretVal
37936>>>                Function_Return lretVal
37937>>>        End_Function
37938>>>
37938>>>// Removes the system menu item with the specified identifier.
37938>>>        Function FormExRemoveSysItem DWORD lID Returns Bool
37939>>>                Local Bool lretVal
37940>>>                Send DeclareParams 1
37941>>>                Send DefineIntegerParam lID
37942>>>                Get InvokeBoolFunction 1610809364 to lretVal
37943>>>                Function_Return lretVal
37944>>>        End_Function
37945>>>
37945>>>// Returns the identifier of the system menu item with the specified index.
37945>>>        Function FormExGetIdentifier DWORD lIndex Returns DWORD
37946>>>                Local DWORD lretVal
37947>>>                Send DeclareParams 1
37948>>>                Send DefineIntegerParam lIndex
37949>>>                Get InvokeIntegerFunction 1610809365 to lretVal
37950>>>                Function_Return lretVal
37951>>>        End_Function
37952>>>
37952>>>// Sets the text of the specified system menu item.
37952>>>        Function FormExGetSysItemText DWORD lID Returns String
37953>>>                Local String lretVal
37954>>>                Send DeclareParams 1
37955>>>                Send DefineIntegerParam lID
37956>>>                Get InvokeStringFunction 1610809366 to lretVal
37957>>>                Function_Return lretVal
37958>>>        End_Function
37959>>>
37959>>>// Sets the text of the specified system menu item.
37959>>>        Function FormExSetSysItemText DWORD lID LPString lsNewText Returns Bool
37960>>>                Local Bool lretVal
37961>>>                Send DeclareParams 2
37962>>>                Send DefineIntegerParam lID
37963>>>                Send DefineIntegerParam lsNewText
37964>>>                Get InvokeBoolFunction 1610809367 to lretVal
37965>>>                Function_Return lretVal
37966>>>        End_Function
37967>>>
37967>>>// Returns/Sets a value indicating whether the form's size is limited.
37967>>>        Function FormExLimitSize Returns Bool
37968>>>                Local Bool lpropVal
37969>>>                Get GetBoolProperty 1745027089 to lpropVal
37970>>>                Function_Return lpropVal
37971>>>        End_Function
37972>>>
37972>>>// Returns/Sets a value indicating whether the form's size is limited.
37972>>>        Procedure SET FormExLimitSize Bool lpropVal
37973>>>                Send SetBoolProperty 1745027089 lpropVal
37974>>>        End_Procedure
37975>>>
37975>>>// Returns/Sets the form's max width (in pixels).
37975>>>        Function FormExMaxWidth Returns DWORD
37976>>>                Local DWORD lpropVal
37977>>>                Get GetIntegerProperty 1745027088 to lpropVal
37978>>>                Function_Return lpropVal
37979>>>        End_Function
37980>>>
37980>>>// Returns/Sets the form's max width (in pixels).
37980>>>        Procedure SET FormExMaxWidth DWORD lpropVal
37981>>>                Send SetIntegerProperty 1745027088 lpropVal
37982>>>        End_Procedure
37983>>>
37983>>>// Returns/Sets the form's max height (in pixels).
37983>>>        Function FormExMaxHeight Returns DWORD
37984>>>                Local DWORD lpropVal
37985>>>                Get GetIntegerProperty 1745027087 to lpropVal
37986>>>                Function_Return lpropVal
37987>>>        End_Function
37988>>>
37988>>>// Returns/Sets the form's max height (in pixels).
37988>>>        Procedure SET FormExMaxHeight DWORD lpropVal
37989>>>                Send SetIntegerProperty 1745027087 lpropVal
37990>>>        End_Procedure
37991>>>
37991>>>// Returns/Sets the form's min height (in pixels).
37991>>>        Function FormExMinHeight Returns DWORD
37992>>>                Local DWORD lpropVal
37993>>>                Get GetIntegerProperty 1745027086 to lpropVal
37994>>>                Function_Return lpropVal
37995>>>        End_Function
37996>>>
37996>>>// Returns/Sets the form's min height (in pixels).
37996>>>        Procedure SET FormExMinHeight DWORD lpropVal
37997>>>                Send SetIntegerProperty 1745027086 lpropVal
37998>>>        End_Procedure
37999>>>
37999>>>// Returns/Sets the form's min width (in pixels).
37999>>>        Function FormExMinWidth Returns DWORD
38000>>>                Local DWORD lpropVal
38001>>>                Get GetIntegerProperty 1745027085 to lpropVal
38002>>>                Function_Return lpropVal
38003>>>        End_Function
38004>>>
38004>>>// Returns/Sets the form's min width (in pixels).
38004>>>        Procedure SET FormExMinWidth DWORD lpropVal
38005>>>                Send SetIntegerProperty 1745027085 lpropVal
38006>>>        End_Procedure
38007>>>
38007>>>// Returns/Sets the Left coordinate when the form is maximized.
38007>>>        Function FormExLeftWhenMax Returns DWORD
38008>>>                Local DWORD lpropVal
38009>>>                Get GetIntegerProperty 1745027084 to lpropVal
38010>>>                Function_Return lpropVal
38011>>>        End_Function
38012>>>
38012>>>// Returns/Sets the Left coordinate when the form is maximized.
38012>>>        Procedure SET FormExLeftWhenMax DWORD lpropVal
38013>>>                Send SetIntegerProperty 1745027084 lpropVal
38014>>>        End_Procedure
38015>>>
38015>>>// Returns/Sets the Topt coordinate when the form is maximized.
38015>>>        Function FormExTopWhenMax Returns DWORD
38016>>>                Local DWORD lpropVal
38017>>>                Get GetIntegerProperty 1745027083 to lpropVal
38018>>>                Function_Return lpropVal
38019>>>        End_Function
38020>>>
38020>>>// Returns/Sets the Topt coordinate when the form is maximized.
38020>>>        Procedure SET FormExTopWhenMax DWORD lpropVal
38021>>>                Send SetIntegerProperty 1745027083 lpropVal
38022>>>        End_Procedure
38023>>>
38023>>>// Returns/Sets a value indicating whether the form is visible in the Windows Task List.
38023>>>        Function FormExShowInTaskList Returns Bool
38024>>>                Local Bool lpropVal
38025>>>                Get GetBoolProperty 1745027082 to lpropVal
38026>>>                Function_Return lpropVal
38027>>>        End_Function
38028>>>
38028>>>// Returns/Sets a value indicating whether the form is visible in the Windows Task List.
38028>>>        Procedure SET FormExShowInTaskList Bool lpropVal
38029>>>                Send SetBoolProperty 1745027082 lpropVal
38030>>>        End_Procedure
38031>>>
38031>>>// Returns/Sets a value indicating whether the form is always on top.
38031>>>        Function FormExAlwaysOnTop Returns Bool
38032>>>                Local Bool lpropVal
38033>>>                Get GetBoolProperty 1745027081 to lpropVal
38034>>>                Function_Return lpropVal
38035>>>        End_Function
38036>>>
38036>>>// Returns/Sets a value indicating whether the form is always on top.
38036>>>        Procedure SET FormExAlwaysOnTop Bool lpropVal
38037>>>                Send SetBoolProperty 1745027081 lpropVal
38038>>>        End_Procedure
38039>>>
38039>>>// Returns/Sets a value indicating whether the form accepts drag-dropped files.
38039>>>        Function FormExAcceptFiles Returns Bool
38040>>>                Local Bool lpropVal
38041>>>                Get GetBoolProperty 1745027080 to lpropVal
38042>>>                Function_Return lpropVal
38043>>>        End_Function
38044>>>
38044>>>// Returns/Sets a value indicating whether the form accepts drag-dropped files.
38044>>>        Procedure SET FormExAcceptFiles Bool lpropVal
38045>>>                Send SetBoolProperty 1745027080 lpropVal
38046>>>        End_Procedure
38047>>>
38047>>>// Returns/Sets a value indicating whether the form is transparent (client only or the entire window).
38047>>>        Function FormExTransparent Returns OLE_mbTransparent
38048>>>                Local OLE_mbTransparent lpropVal
38049>>>                Get GetIntegerProperty 1745027079 to lpropVal
38050>>>                Function_Return lpropVal
38051>>>        End_Function
38052>>>
38052>>>// Returns/Sets a value indicating whether the form is transparent (client only or the entire window).
38052>>>        Procedure SET FormExTransparent OLE_mbTransparent lpropVal
38053>>>                Send SetIntegerProperty 1745027079 lpropVal
38054>>>        End_Procedure
38055>>>
38055>>>// Returns/Sets a value indicating whether the controls are resized with the form.
38055>>>        Function FormExResizeControls Returns Bool
38056>>>                Local Bool lpropVal
38057>>>                Get GetBoolProperty 1745027078 to lpropVal
38058>>>                Function_Return lpropVal
38059>>>        End_Function
38060>>>
38060>>>// Returns/Sets a value indicating whether the controls are resized with the form.
38060>>>        Procedure SET FormExResizeControls Bool lpropVal
38061>>>                Send SetBoolProperty 1745027078 lpropVal
38062>>>        End_Procedure
38063>>>
38063>>>// Returns/Sets a value indicating whether the controls' fonts are resized with the form.
38063>>>        Function FormExResizeFonts Returns Bool
38064>>>                Local Bool lpropVal
38065>>>                Get GetBoolProperty 1745027077 to lpropVal
38066>>>                Function_Return lpropVal
38067>>>        End_Function
38068>>>
38068>>>// Returns/Sets a value indicating whether the controls' fonts are resized with the form.
38068>>>        Procedure SET FormExResizeFonts Bool lpropVal
38069>>>                Send SetBoolProperty 1745027077 lpropVal
38070>>>        End_Procedure
38071>>>
38071>>>// Returns/Sets a value indicating whether the form is flashing.
38071>>>        Function FormExFlashingCaption Returns Bool
38072>>>                Local Bool lpropVal
38073>>>                Get GetBoolProperty 1745027076 to lpropVal
38074>>>                Function_Return lpropVal
38075>>>        End_Function
38076>>>
38076>>>// Returns/Sets a value indicating whether the form is flashing.
38076>>>        Procedure SET FormExFlashingCaption Bool lpropVal
38077>>>                Send SetBoolProperty 1745027076 lpropVal
38078>>>        End_Procedure
38079>>>
38079>>>// Returns/Sets the flash interval.
38079>>>        Function FormExFlashInterval Returns DWORD
38080>>>                Local DWORD lpropVal
38081>>>                Get GetIntegerProperty 1745027075 to lpropVal
38082>>>                Function_Return lpropVal
38083>>>        End_Function
38084>>>
38084>>>// Returns/Sets the flash interval.
38084>>>        Procedure SET FormExFlashInterval DWORD lpropVal
38085>>>                Send SetIntegerProperty 1745027075 lpropVal
38086>>>        End_Procedure
38087>>>
38087>>>// Returns/Sets a value indicating whether the form is in fullscreen mode.
38087>>>        Function FormExFullScreen Returns Bool
38088>>>                Local Bool lpropVal
38089>>>                Get GetBoolProperty 1745027074 to lpropVal
38090>>>                Function_Return lpropVal
38091>>>        End_Function
38092>>>
38092>>>// Returns/Sets a value indicating whether the form is in fullscreen mode.
38092>>>        Procedure SET FormExFullScreen Bool lpropVal
38093>>>                Send SetBoolProperty 1745027074 lpropVal
38094>>>        End_Procedure
38095>>>
38095>>>// Returns/Sets a value indicating whether the form can be moved clicking on its client area.
38095>>>        Function FormExDraggable Returns Bool
38096>>>                Local Bool lpropVal
38097>>>                Get GetBoolProperty 1745027073 to lpropVal
38098>>>                Function_Return lpropVal
38099>>>        End_Function
38100>>>
38100>>>// Returns/Sets a value indicating whether the form can be moved clicking on its client area.
38100>>>        Procedure SET FormExDraggable Bool lpropVal
38101>>>                Send SetBoolProperty 1745027073 lpropVal
38102>>>        End_Procedure
38103>>>
38103>>>// Returns/Sets the picture to tile to create the wallpaper.
38103>>>        Function FormExPicture Returns LPDispatch
38104>>>                Local LPDispatch lpropVal
38105>>>                Get GetLPDispatchProperty 1745027072 to lpropVal
38106>>>                Function_Return lpropVal
38107>>>        End_Function
38108>>>
38108>>>// Returns/Sets the picture to tile to create the wallpaper.
38108>>>        Procedure SET FormExPicture LPDispatch lpropVal
38109>>>                Send SetLPDispatchProperty 1745027072 lpropVal
38110>>>        End_Procedure
38111>>>
38111>>>End_Class
38112>>>
38112>>>// CLSID:{2BF273CE-D8EB-11D3-8ED1-CFAA7A653C7F}
38112>>>// ProgId:
38112>>>Class OLE__FormEx is a Message
38113>>>
38113>>>// Occurs when a custom item of the system menu is clicked. The parameter specifies the ID of the item that is the value returned by the AddSysItem method.
38113>>>        Procedure OnFormExSysItemClick DWORD lID String lsItem
38114>>>        End_Procedure
38115>>>
38115>>>// Occurs when a menu item (system or not) is selected.
38115>>>        Procedure OnFormExItemSelect DWORD lID
38116>>>        End_Procedure
38117>>>
38117>>>// Occurs when one or more files are dropped over the form.
38117>>>        Procedure OnFormExDragDropFiles String lFilesArray
38118>>>        End_Procedure
38119>>>
38119>>>// Occurs when the form is moved.
38119>>>        Procedure OnFormExMove
38120>>>        End_Procedure
38121>>>
38121>>>// Occurs when the form is painted.
38121>>>        Procedure OnFormExPaint
38122>>>        End_Procedure
38123>>>
38123>>>// Occurs when the application is activated.
38123>>>        Procedure OnFormExActivateApp
38124>>>        End_Procedure
38125>>>
38125>>>// Occurs when the application is deactivated.
38125>>>        Procedure OnFormExDeactivateApp
38126>>>        End_Procedure
38127>>>
38127>>>// Occurs when the system memory is low.
38127>>>        Procedure OnFormExCompactingMemory
38128>>>        End_Procedure
38129>>>
38129>>>// Occurs when the display resolution is changed. The parameters specify the new size and the number of colors.
38129>>>        Procedure OnFormExDisplayChanged DWORD lWidth DWORD lHeight DWORD lNumColors
38130>>>        End_Procedure
38131>>>
38131>>>End_Class
38132>>>
38132>>>// CoClass CLSID:{2BF273CC-D8EB-11D3-8ED1-CFAA7A653C7F}
38132>>>// ProgId: MBFormEx.FormEx
38132>>>// Number of impl.Types:2
38132>>>// Referenced class _FormEx
38132>>>// Referenced class __FormEx
38132>>>Class OLEFormEx is a OCX_Client
38133>>>        Import_Class_Protocol OLE_FormEx
38134>>>        Import_Class_Protocol OLE__FormEx
38135>>>
38135>>>        Procedure Construct_Object
38136>>>                Forward Send Construct_Object
38138>>>                Send DefineOCX_Client
38139>>>                Set progIdStr to "MBFormEx.FormEx"
38140>>>                Set OCXLicense to ""
38141>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEFormEx"
38144>>>        End_Procedure
38145>>>
38145>>>        Procedure PreFormExSysItemClick Integer lParam
38146>>>                Local DWORD lID
38147>>>                Local String lsItem
38147>>>                Get GetEventIntegerParam lParam 0 to lID
38148>>>                Get GetEventStringParam lParam 1 to lsItem
38149>>>                Send OnFormExSysItemClick lID lsItem
38150>>>        End_Procedure
38151>>>
38151>>>        Procedure PreFormExItemSelect Integer lParam
38152>>>                Local DWORD lID
38153>>>                Get GetEventIntegerParam lParam 0 to lID
38154>>>                Send OnFormExItemSelect lID
38155>>>        End_Procedure
38156>>>
38156>>>        Procedure PreFormExDragDropFiles Integer lParam
38157>>>                Local String lFilesArray
38158>>>                Get GetEventIntegerParam lParam 0 to lFilesArray
38159>>>                Send OnFormExDragDropFiles lFilesArray
38160>>>        End_Procedure
38161>>>
38161>>>        Procedure PreFormExDisplayChanged Integer lParam
38162>>>                Local DWORD lWidth
38163>>>                Local DWORD lHeight
38163>>>                Local DWORD lNumColors
38163>>>                Get GetEventIntegerParam lParam 0 to lWidth
38164>>>                Get GetEventIntegerParam lParam 1 to lHeight
38165>>>                Get GetEventIntegerParam lParam 2 to lNumColors
38166>>>                Send OnFormExDisplayChanged lWidth lHeight lNumColors
38167>>>        End_Procedure
38168>>>
38168>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
38169>>>                ON_EVENT 1 Fire PreFormExSysItemClick
38172>>>                ON_EVENT 2 Fire PreFormExItemSelect
38175>>>                ON_EVENT 3 Fire PreFormExDragDropFiles
38178>>>                ON_EVENT 4 Fire OnFormExMove
38181>>>                ON_EVENT 5 Fire OnFormExPaint
38184>>>                ON_EVENT 6 Fire OnFormExActivateApp
38187>>>                ON_EVENT 7 Fire OnFormExDeactivateApp
38190>>>                ON_EVENT 8 Fire OnFormExCompactingMemory
38193>>>                ON_EVENT 9 Fire PreFormExDisplayChanged
38196>>>        End_Procedure
38197>>>End_Class
38198>>>
38198>>>// CoClass CLSID:{2BF273CC-D8EB-11D3-8ED1-CFAA7A653C7F}
38198>>>// ProgId: MBFormEx.FormEx
38198>>>// Number of impl.Types:2
38198>>>// Referenced class _FormEx
38198>>>// Referenced class __FormEx
38198>>>Class dbOLEFormEx is a dbOCX_Client
38199>>>        Import_Class_Protocol OLE_FormEx
38200>>>        Import_Class_Protocol OLE__FormEx
38201>>>
38201>>>        Procedure Construct_Object
38202>>>                Forward Send Construct_Object
38204>>>                Send DefineDbOCX_Client
38205>>>                Set progIdStr to "MBFormEx.FormEx"
38206>>>                Set OCXLicense to ""
38207>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEFormEx"
38210>>>        End_Procedure
38211>>>
38211>>>        Procedure PreFormExSysItemClick Integer lParam
38212>>>                Local DWORD lID
38213>>>                Local String lsItem
38213>>>                Get GetEventIntegerParam lParam 0 to lID
38214>>>                Get GetEventStringParam lParam 1 to lsItem
38215>>>                Send OnFormExSysItemClick lID lsItem
38216>>>        End_Procedure
38217>>>
38217>>>        Procedure PreFormExItemSelect Integer lParam
38218>>>                Local DWORD lID
38219>>>                Get GetEventIntegerParam lParam 0 to lID
38220>>>                Send OnFormExItemSelect lID
38221>>>        End_Procedure
38222>>>
38222>>>        Procedure PreFormExDragDropFiles Integer lParam
38223>>>                Local String lFilesArray
38224>>>                Get GetEventIntegerParam lParam 0 to lFilesArray
38225>>>                Send OnFormExDragDropFiles lFilesArray
38226>>>        End_Procedure
38227>>>
38227>>>        Procedure PreFormExDisplayChanged Integer lParam
38228>>>                Local DWORD lWidth
38229>>>                Local DWORD lHeight
38229>>>                Local DWORD lNumColors
38229>>>                Get GetEventIntegerParam lParam 0 to lWidth
38230>>>                Get GetEventIntegerParam lParam 1 to lHeight
38231>>>                Get GetEventIntegerParam lParam 2 to lNumColors
38232>>>                Send OnFormExDisplayChanged lWidth lHeight lNumColors
38233>>>        End_Procedure
38234>>>
38234>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
38235>>>                ON_EVENT 1 Fire PreFormExSysItemClick
38238>>>                ON_EVENT 2 Fire PreFormExItemSelect
38241>>>                ON_EVENT 3 Fire PreFormExDragDropFiles
38244>>>                ON_EVENT 4 Fire OnFormExMove
38247>>>                ON_EVENT 5 Fire OnFormExPaint
38250>>>                ON_EVENT 6 Fire OnFormExActivateApp
38253>>>                ON_EVENT 7 Fire OnFormExDeactivateApp
38256>>>                ON_EVENT 8 Fire OnFormExCompactingMemory
38259>>>                ON_EVENT 9 Fire PreFormExDisplayChanged
38262>>>        End_Procedure
38263>>>End_Class
38264>>>
38264>>>// CLSID:{2BF273D2-D8EB-11D3-8ED1-CFAA7A653C7F}
38264>>>// ProgId:
38264>>>Class OLE_General is a Automation_Client
38265>>>//ERROR - No Function Description
38265>>>//ERROR - Failed to retrieve Function Descriptions
38265>>>
38265>>>End_Class
38266>>>
38266>>>// CoClass CLSID:{2BF273D3-D8EB-11D3-8ED1-CFAA7A653C7F}
38266>>>// ProgId:
38266>>>// Number of impl.Types:1
38266>>>// Referenced class _General
38266>>>Class OLEGeneral is a Automation_Client
38267>>>        Import_Class_Protocol OLE_General
38268>>>
38268>>>        Procedure Construct_Object
38269>>>                Forward Send Construct_Object
38271>>>                Set progIdStr to "{2BF273D3-D8EB-11D3-8ED1-CFAA7A653C7F}"
38272>>>        End_Procedure
38273>>>End_Class
38274>Use mbMessage
INCLUDING FILE: MBMESSAGE.PKG
38274>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\MBMSGEX.OCX
38274>>>// Generated by FlexOLE Class Generator Friday, February 07, 2003 15:12:11
38274>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
38274>>>
38274>>>//Enum_List
38274>>>        Define OLEmbApplicationModal for 0 // mbApplicationModal
38274>>>        Define OLEmbSystemModal for 4096 // mbSystemModal
38274>>>//End_Enum_List
38274>>>
38274>>>//Enum_List
38274>>>        Define OLEmbNone for 0 // mbNone
38274>>>        Define OLEmbCritical for 16 // mbCritical
38274>>>        Define OLEmbQuestion for 32 // mbQuestion
38274>>>        Define OLEmbExclamation for 48 // mbExclamation
38274>>>        Define OLEmbInformation for 64 // mbInformation
38274>>>        Define OLEmbCustomIcon for 100 // mbCustomIcon
38274>>>//End_Enum_List
38274>>>
38274>>>//Enum_List
38274>>>        Define OLEmbCriticalSound for 16 // mbCriticalSound
38274>>>        Define OLEmbQuestionSound for 32 // mbQuestionSound
38274>>>        Define OLEmbExclamationSound for 48 // mbExclamationSound
38274>>>        Define OLEmbInformationSound for 64 // mbInformationSound
38274>>>//End_Enum_List
38274>>>
38274>>>//Enum_List
38274>>>        Define OLEmbAbortRetryIgnore for 2 // mbAbortRetryIgnore
38274>>>        Define OLEmbOKCancel for 1 // mbOKCancel
38274>>>        Define OLEmbOKOnly for 0 // mbOKOnly
38274>>>        Define OLEmbRetryCancel for 5 // mbRetryCancel
38274>>>        Define OLEmbYesNo for 4 // mbYesNo
38274>>>        Define OLEmbYesNoCancel for 3 // mbYesNoCancel
38274>>>        Define OLEmbOneCustomButton for 101 // mbOneCustomButton
38274>>>        Define OLEmbTwoCustomButtons for 102 // mbTwoCustomButtons
38274>>>        Define OLEmbThreeCustomButtons for 103 // mbThreeCustomButtons
38274>>>        Define OLEmbFourCustomButtons for 104 // mbFourCustomButtons
38274>>>//End_Enum_List
38274>>>
38274>>>//Enum_List
38274>>>        Define OLEmbDefaultButton1 for 0 // mbDefaultButton1
38274>>>        Define OLEmbDefaultButton2 for 256 // mbDefaultButton2
38274>>>        Define OLEmbDefaultButton3 for 512 // mbDefaultButton3
38274>>>        Define OLEmbDefaultButton4 for 768 // mbDefaultButton4
38274>>>//End_Enum_List
38274>>>
38274>>>//Enum_List
38274>>>        Define OLEmbAbort for 3 // mbAbort
38274>>>        Define OLEmbCancel for 2 // mbCancel
38274>>>        Define OLEmbIgnore for 5 // mbIgnore
38274>>>        Define OLEmbNo for 7 // mbNo
38274>>>        Define OLEmbOK for 1 // mbOK
38274>>>        Define OLEmbRetry for 4 // mbRetry
38274>>>        Define OLEmbYes for 6 // mbYes
38274>>>        Define OLEmbCustomButton1 for 6 // mbCustomButton1
38274>>>        Define OLEmbCustomButton2 for 7 // mbCustomButton2
38274>>>        Define OLEmbCustomButton3 for 2 // mbCustomButton3
38274>>>        Define OLEmbCustomButton4 for 1 // mbCustomButton4
38274>>>//End_Enum_List
38274>>>
38274>>>// CLSID:{572FF23F-2066-11D4-8ED4-00E07D815373}
38274>>>// ProgId: 
38274>>>Class OLE_MsgBoxEx is a Message
38275>>>
38275>>>// Returns/sets a value that determines whether the message box window is the foreground window.
38275>>>        Function MsgBoxExForeground Returns Bool
38276>>>                Local Bool lpropVal
38277>>>                Get GetBoolProperty 1073938433 to lpropVal
38278>>>                Function_Return lpropVal
38279>>>        End_Function
38280>>>
38280>>>// Returns/sets a value that determines whether the message box window is the foreground window.
38280>>>        Procedure SET MsgBoxExForeground Bool lpropVal
38281>>>                Send SetBoolProperty 1073938433 lpropVal
38282>>>        End_Procedure
38283>>>
38283>>>// Returns/sets the text displayed as the message in the dialog box.
38283>>>        Function MsgBoxExPrompt Returns String
38284>>>                Local String lpropVal
38285>>>                Get GetStringProperty 1073938434 to lpropVal
38286>>>                Function_Return lpropVal
38287>>>        End_Function
38288>>>
38288>>>// Returns/sets the text displayed as the message in the dialog box.
38288>>>        Procedure SET MsgBoxExPrompt String lpropVal
38289>>>                Send SetStringProperty 1073938434 lpropVal
38290>>>        End_Procedure
38291>>>
38291>>>// Returns/sets the title of the message box.
38291>>>        Function MsgBoxExTitle Returns String
38292>>>                Local String lpropVal
38293>>>                Get GetStringProperty 1073938435 to lpropVal
38294>>>                Function_Return lpropVal
38295>>>        End_Function
38296>>>
38296>>>// Returns/sets the title of the message box.
38296>>>        Procedure SET MsgBoxExTitle String lpropVal
38297>>>                Send SetStringProperty 1073938435 lpropVal
38298>>>        End_Procedure
38299>>>
38299>>>// Returns/sets the number and the type of buttons to display.
38299>>>        Function MsgBoxExButtons Returns OLE_mbButtonConstants
38300>>>                Local OLE_mbButtonConstants lpropVal
38301>>>                Get GetIntegerProperty 1073938436 to lpropVal
38302>>>                Function_Return lpropVal
38303>>>        End_Function
38304>>>
38304>>>// Returns/sets the number and the type of buttons to display.
38304>>>        Procedure SET MsgBoxExButtons OLE_mbButtonConstants lpropVal
38305>>>                Send SetIntegerProperty 1073938436 lpropVal
38306>>>        End_Procedure
38307>>>
38307>>>// Returns/sets a value that determines whether the message box is modal to the parent application or to the entire system.
38307>>>        Function MsgBoxExModal Returns OLE_mbModalConstants
38308>>>                Local OLE_mbModalConstants lpropVal
38309>>>                Get GetIntegerProperty 1073938437 to lpropVal
38310>>>                Function_Return lpropVal
38311>>>        End_Function
38312>>>
38312>>>// Returns/sets a value that determines whether the message box is modal to the parent application or to the entire system.
38312>>>        Procedure SET MsgBoxExModal OLE_mbModalConstants lpropVal
38313>>>                Send SetIntegerProperty 1073938437 lpropVal
38314>>>        End_Procedure
38315>>>
38315>>>// Returns/sets the  default button.
38315>>>        Function MsgBoxExDefaultButton Returns OLE_mbDefaultButtonConstants
38316>>>                Local OLE_mbDefaultButtonConstants lpropVal
38317>>>                Get GetIntegerProperty 1073938438 to lpropVal
38318>>>                Function_Return lpropVal
38319>>>        End_Function
38320>>>
38320>>>// Returns/sets the  default button.
38320>>>        Procedure SET MsgBoxExDefaultButton OLE_mbDefaultButtonConstants lpropVal
38321>>>                Send SetIntegerProperty 1073938438 lpropVal
38322>>>        End_Procedure
38323>>>
38323>>>// Returns/sets the context number assigned to the appropriate Help topic by the Help author. If context is provided, HelpFile must also be provided. The Help button is added automatically.
38323>>>        Function MsgBoxExHelpContextID Returns DWORD
38324>>>                Local DWORD lpropVal
38325>>>                Get GetIntegerProperty 1073938439 to lpropVal
38326>>>                Function_Return lpropVal
38327>>>        End_Function
38328>>>
38328>>>// Returns/sets the context number assigned to the appropriate Help topic by the Help author. If context is provided, HelpFile must also be provided. The Help button is added automatically.
38328>>>        Procedure SET MsgBoxExHelpContextID DWORD lpropVal
38329>>>                Send SetIntegerProperty 1073938439 lpropVal
38330>>>        End_Procedure
38331>>>
38331>>>// Returns/sets the Help file to use to provide context-sensitive Help for the dialog box. If HelpFile is provided, context must also be provided. The Help button is added automatically.
38331>>>        Function MsgBoxExHelpFile Returns String
38332>>>                Local String lpropVal
38333>>>                Get GetStringProperty 1073938440 to lpropVal
38334>>>                Function_Return lpropVal
38335>>>        End_Function
38336>>>
38336>>>// Returns/sets the Help file to use to provide context-sensitive Help for the dialog box. If HelpFile is provided, context must also be provided. The Help button is added automatically.
38336>>>        Procedure SET MsgBoxExHelpFile String lpropVal
38337>>>                Send SetStringProperty 1073938440 lpropVal
38338>>>        End_Procedure
38339>>>
38339>>>// Returns/sets the type of icon to display on the left of the dialog.
38339>>>        Function MsgBoxExIcon Returns OLE_mbIconConstants
38340>>>                Local OLE_mbIconConstants lpropVal
38341>>>                Get GetIntegerProperty 1073938441 to lpropVal
38342>>>                Function_Return lpropVal
38343>>>        End_Function
38344>>>
38344>>>// Returns/sets the type of icon to display on the left of the dialog.
38344>>>        Procedure SET MsgBoxExIcon OLE_mbIconConstants lpropVal
38345>>>                Send SetIntegerProperty 1073938441 lpropVal
38346>>>        End_Procedure
38347>>>
38347>>>// Returns/sets the sound to use if the Icon property is mbCustomIcon.
38347>>>        Function MsgBoxExCustomIconSound Returns OLE_mbIconSoundConstants
38348>>>                Local OLE_mbIconSoundConstants lpropVal
38349>>>                Get GetIntegerProperty 1073938442 to lpropVal
38350>>>                Function_Return lpropVal
38351>>>        End_Function
38352>>>
38352>>>// Returns/sets the sound to use if the Icon property is mbCustomIcon.
38352>>>        Procedure SET MsgBoxExCustomIconSound OLE_mbIconSoundConstants lpropVal
38353>>>                Send SetIntegerProperty 1073938442 lpropVal
38354>>>        End_Procedure
38355>>>
38355>>>// Returns/sets a value indicating whether the text is aligned to the right.
38355>>>        Function MsgBoxExRightAligned Returns Bool
38356>>>                Local Bool lpropVal
38357>>>                Get GetBoolProperty 1073938443 to lpropVal
38358>>>                Function_Return lpropVal
38359>>>        End_Function
38360>>>
38360>>>// Returns/sets a value indicating whether the text is aligned to the right.
38360>>>        Procedure SET MsgBoxExRightAligned Bool lpropVal
38361>>>                Send SetBoolProperty 1073938443 lpropVal
38362>>>        End_Procedure
38363>>>
38363>>>// Returns or sets a value specifying the position of the message box when it first appears.
38363>>>        Function MsgBoxExPosition Returns DWORD //OLE_StartUpPositionConstants
38364>>>                Local DWORD lpropVal
38365>>>//              Local OLE_StartUpPositionConstants lpropVal
38365>>>                Get GetIntegerProperty 1073938444 to lpropVal
38366>>>                Function_Return lpropVal
38367>>>        End_Function
38368>>>
38368>>>// Returns or sets a value specifying the position of the message box when it first appears.
38368>>>        Procedure SET MsgBoxExPosition DWORD lpropVal//OLE_StartUpPositionConstants lpropVal
38369>>>                Send SetIntegerProperty 1073938444 lpropVal
38370>>>        End_Procedure
38371>>>
38371>>>// Returns/sets the pixel coordinate of the dialog box's top edge, relative to the entire screen. Evaluated only if Position is set to vbStartUpManual.
38371>>>        Function MsgBoxExTopDialogPos Returns DWORD
38372>>>                Local DWORD lpropVal
38373>>>                Get GetIntegerProperty 1073938445 to lpropVal
38374>>>                Function_Return lpropVal
38375>>>        End_Function
38376>>>
38376>>>// Returns/sets the pixel coordinate of the dialog box's top edge, relative to the entire screen. Evaluated only if Position is set to vbStartUpManual.
38376>>>        Procedure SET MsgBoxExTopDialogPos DWORD lpropVal
38377>>>                Send SetIntegerProperty 1073938445 lpropVal
38378>>>        End_Procedure
38379>>>
38379>>>// Returns/sets the pixel coordinate of the dialog box's left edge, relative to the entire screen. Evaluated only if Position is set to vbStartUpManual.
38379>>>        Function MsgBoxExLeftDialogPos Returns DWORD
38380>>>                Local DWORD lpropVal
38381>>>                Get GetIntegerProperty 1073938446 to lpropVal
38382>>>                Function_Return lpropVal
38383>>>        End_Function
38384>>>
38384>>>// Returns/sets the pixel coordinate of the dialog box's left edge, relative to the entire screen. Evaluated only if Position is set to vbStartUpManual.
38384>>>        Procedure SET MsgBoxExLeftDialogPos DWORD lpropVal
38385>>>                Send SetIntegerProperty 1073938446 lpropVal
38386>>>        End_Procedure
38387>>>
38387>>>// Returns/sets the icon to use if the Icon property is mbCustomIcon.
38387>>>        Function MsgBoxExCustomIcon Returns LPDispatch
38388>>>                Local LPDispatch lpropVal
38389>>>                Get GetLPDispatchProperty 1073938447 to lpropVal
38390>>>                Function_Return lpropVal
38391>>>        End_Function
38392>>>
38392>>>// Returns/sets the icon to use if the Icon property is mbCustomIcon.
38392>>>        Procedure SET MsgBoxExCustomIcon LPDispatch lpropVal
38393>>>                Send SetLPDispatchProperty 1073938447 lpropVal
38394>>>        End_Procedure
38395>>>
38395>>>// Returns/sets the caption of the first custom button.
38395>>>        Function MsgBoxExButton1Caption Returns String
38396>>>                Local String lpropVal
38397>>>                Get GetStringProperty 1073938448 to lpropVal
38398>>>                Function_Return lpropVal
38399>>>        End_Function
38400>>>
38400>>>// Returns/sets the caption of the first custom button.
38400>>>        Procedure SET MsgBoxExButton1Caption String lpropVal
38401>>>                Send SetStringProperty 1073938448 lpropVal
38402>>>        End_Procedure
38403>>>
38403>>>// Returns/sets the caption of the second custom button.
38403>>>        Function MsgBoxExButton2Caption Returns String
38404>>>                Local String lpropVal
38405>>>                Get GetStringProperty 1073938449 to lpropVal
38406>>>                Function_Return lpropVal
38407>>>        End_Function
38408>>>
38408>>>// Returns/sets the caption of the second custom button.
38408>>>        Procedure SET MsgBoxExButton2Caption String lpropVal
38409>>>                Send SetStringProperty 1073938449 lpropVal
38410>>>        End_Procedure
38411>>>
38411>>>// Returns/sets the caption of the third custom button.
38411>>>        Function MsgBoxExButton3Caption Returns String
38412>>>                Local String lpropVal
38413>>>                Get GetStringProperty 1073938450 to lpropVal
38414>>>                Function_Return lpropVal
38415>>>        End_Function
38416>>>
38416>>>// Returns/sets the caption of the third custom button.
38416>>>        Procedure SET MsgBoxExButton3Caption String lpropVal
38417>>>                Send SetStringProperty 1073938450 lpropVal
38418>>>        End_Procedure
38419>>>
38419>>>// Returns/sets the caption of the fourth custom button.
38419>>>        Function MsgBoxExButton4Caption Returns String
38420>>>                Local String lpropVal
38421>>>                Get GetStringProperty 1073938451 to lpropVal
38422>>>                Function_Return lpropVal
38423>>>        End_Function
38424>>>
38424>>>// Returns/sets the caption of the fourth custom button.
38424>>>        Procedure SET MsgBoxExButton4Caption String lpropVal
38425>>>                Send SetStringProperty 1073938451 lpropVal
38426>>>        End_Procedure
38427>>>
38427>>>// Returns the result of the message box.
38427>>>        Function MsgBoxExResult Returns OLE_mbResultConstants
38428>>>                Local OLE_mbResultConstants lpropVal
38429>>>                Get GetIntegerProperty 0 to lpropVal
38430>>>                Function_Return lpropVal
38431>>>        End_Function
38432>>>
38432>>>// Opens the AboutBox dialog.
38432>>>        Procedure MsgBoxExAbout
38433>>>                Send InvokeVoidFunction -552
38434>>>        End_Procedure 
38435>>>
38435>>>// Opens the message box.
38435>>>        Function MsgBoxExShow Returns OLE_mbResultConstants
38436>>>                Local OLE_mbResultConstants lretVal
38437>>>                Get InvokeIntegerFunction 1610809344 to lretVal
38438>>>                Function_Return lretVal
38439>>>        End_Function 
38440>>>
38440>>>End_Class
38441>>>
38441>>>// CLSID:{572FF241-2066-11D4-8ED4-00E07D815373}
38441>>>// ProgId: 
38441>>>Class OLE__MsgBoxEx is a Message
38442>>>
38442>>>End_Class
38443>>>
38443>>>// CoClass CLSID:{572FF240-2066-11D4-8ED4-00E07D815373}
38443>>>// ProgId: MBMsgBoxEx.MsgBoxEx
38443>>>// Number of impl.Types:2
38443>>>// Referenced class _MsgBoxEx
38443>>>// Referenced class __MsgBoxEx
38443>>>Class OLEMsgBoxEx is a OCX_Client
38444>>>        Import_Class_Protocol OLE_MsgBoxEx
38445>>>        Import_Class_Protocol OLE__MsgBoxEx
38446>>>
38446>>>        Procedure Construct_Object
38447>>>                Forward Send Construct_Object
38449>>>                Send DefineOCX_Client
38450>>>                Set progIdStr to "MBMsgBoxEx.MsgBoxEx"
38451>>>                Set OCXLicense to ""
38452>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEMsgBoxEx"
38455>>>        End_Procedure
38456>>>
38456>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
38457>>>        End_Procedure
38458>>>End_Class
38459>>>
38459>>>// CoClass CLSID:{572FF240-2066-11D4-8ED4-00E07D815373}
38459>>>// ProgId: MBMsgBoxEx.MsgBoxEx
38459>>>// Number of impl.Types:2
38459>>>// Referenced class _MsgBoxEx
38459>>>// Referenced class __MsgBoxEx
38459>>>Class dbOLEMsgBoxEx is a dbOCX_Client
38460>>>        Import_Class_Protocol OLE_MsgBoxEx
38461>>>        Import_Class_Protocol OLE__MsgBoxEx
38462>>>
38462>>>        Procedure Construct_Object
38463>>>                Forward Send Construct_Object
38465>>>                Send DefineDbOCX_Client
38466>>>                Set progIdStr to "MBMsgBoxEx.MsgBoxEx"
38467>>>                Set OCXLicense to ""
38468>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEMsgBoxEx"
38471>>>        End_Procedure
38472>>>
38472>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
38473>>>        End_Procedure
38474>>>End_Class
38475>>>
38475>>>// CLSID:{572FF237-2066-11D4-8ED4-00E07D815373}
38475>>>// ProgId: 
38475>>>Class OLE_CMsgBoxEx is a Automation_Client
38476>>>
38476>>>// Returns/sets a value that determines whether the message box window is the foreground window.
38476>>>        Function CMsgBoxExForeground Returns Bool
38477>>>                Local Bool lpropVal
38478>>>                Get GetBoolProperty 1073938432 to lpropVal
38479>>>                Function_Return lpropVal
38480>>>        End_Function
38481>>>
38481>>>// Returns/sets a value that determines whether the message box window is the foreground window.
38481>>>        Procedure SET CMsgBoxExForeground Bool lpropVal
38482>>>                Send SetBoolProperty 1073938432 lpropVal
38483>>>        End_Procedure
38484>>>
38484>>>// Returns/sets the text displayed as the message in the dialog box.
38484>>>        Function CMsgBoxExPrompt Returns String
38485>>>                Local String lpropVal
38486>>>                Get GetStringProperty 1073938433 to lpropVal
38487>>>                Function_Return lpropVal
38488>>>        End_Function
38489>>>
38489>>>// Returns/sets the text displayed as the message in the dialog box.
38489>>>        Procedure SET CMsgBoxExPrompt String lpropVal
38490>>>                Send SetStringProperty 1073938433 lpropVal
38491>>>        End_Procedure
38492>>>
38492>>>// Returns/sets the title of the message box.
38492>>>        Function CMsgBoxExTitle Returns String
38493>>>                Local String lpropVal
38494>>>                Get GetStringProperty 1073938434 to lpropVal
38495>>>                Function_Return lpropVal
38496>>>        End_Function
38497>>>
38497>>>// Returns/sets the title of the message box.
38497>>>        Procedure SET CMsgBoxExTitle String lpropVal
38498>>>                Send SetStringProperty 1073938434 lpropVal
38499>>>        End_Procedure
38500>>>
38500>>>// Returns/sets the number and the type of buttons to display.
38500>>>        Function CMsgBoxExButtons Returns OLE_mbButtonConstants
38501>>>                Local OLE_mbButtonConstants lpropVal
38502>>>                Get GetIntegerProperty 1073938435 to lpropVal
38503>>>                Function_Return lpropVal
38504>>>        End_Function
38505>>>
38505>>>// Returns/sets the number and the type of buttons to display.
38505>>>        Procedure SET CMsgBoxExButtons OLE_mbButtonConstants lpropVal
38506>>>                Send SetIntegerProperty 1073938435 lpropVal
38507>>>        End_Procedure
38508>>>
38508>>>// Returns/sets a value that determines whether the message box is modal to the parent application or to the entire system.
38508>>>        Function CMsgBoxExModal Returns OLE_mbModalConstants
38509>>>                Local OLE_mbModalConstants lpropVal
38510>>>                Get GetIntegerProperty 1073938436 to lpropVal
38511>>>                Function_Return lpropVal
38512>>>        End_Function
38513>>>
38513>>>// Returns/sets a value that determines whether the message box is modal to the parent application or to the entire system.
38513>>>        Procedure SET CMsgBoxExModal OLE_mbModalConstants lpropVal
38514>>>                Send SetIntegerProperty 1073938436 lpropVal
38515>>>        End_Procedure
38516>>>
38516>>>// Returns/sets the  default button.
38516>>>        Function CMsgBoxExDefaultButton Returns OLE_mbDefaultButtonConstants
38517>>>                Local OLE_mbDefaultButtonConstants lpropVal
38518>>>                Get GetIntegerProperty 1073938437 to lpropVal
38519>>>                Function_Return lpropVal
38520>>>        End_Function
38521>>>
38521>>>// Returns/sets the  default button.
38521>>>        Procedure SET CMsgBoxExDefaultButton OLE_mbDefaultButtonConstants lpropVal
38522>>>                Send SetIntegerProperty 1073938437 lpropVal
38523>>>        End_Procedure
38524>>>
38524>>>// Returns/sets the context number assigned to the appropriate Help topic by the Help author. If context is provided, HelpFile must also be provided. The Help button is added automatically.
38524>>>        Function CMsgBoxExHelpContextID Returns DWORD
38525>>>                Local DWORD lpropVal
38526>>>                Get GetIntegerProperty 1073938438 to lpropVal
38527>>>                Function_Return lpropVal
38528>>>        End_Function
38529>>>
38529>>>// Returns/sets the context number assigned to the appropriate Help topic by the Help author. If context is provided, HelpFile must also be provided. The Help button is added automatically.
38529>>>        Procedure SET CMsgBoxExHelpContextID DWORD lpropVal
38530>>>                Send SetIntegerProperty 1073938438 lpropVal
38531>>>        End_Procedure
38532>>>
38532>>>// Returns/sets the Help file to use to provide context-sensitive Help for the dialog box. If HelpFile is provided, context must also be provided. The Help button is added automatically.
38532>>>        Function CMsgBoxExHelpFile Returns String
38533>>>                Local String lpropVal
38534>>>                Get GetStringProperty 1073938439 to lpropVal
38535>>>                Function_Return lpropVal
38536>>>        End_Function
38537>>>
38537>>>// Returns/sets the Help file to use to provide context-sensitive Help for the dialog box. If HelpFile is provided, context must also be provided. The Help button is added automatically.
38537>>>        Procedure SET CMsgBoxExHelpFile String lpropVal
38538>>>                Send SetStringProperty 1073938439 lpropVal
38539>>>        End_Procedure
38540>>>
38540>>>// Returns/sets the type of icon to display on the left of the dialog.
38540>>>        Function CMsgBoxExIcon Returns OLE_mbIconConstants
38541>>>                Local OLE_mbIconConstants lpropVal
38542>>>                Get GetIntegerProperty 1073938440 to lpropVal
38543>>>                Function_Return lpropVal
38544>>>        End_Function
38545>>>
38545>>>// Returns/sets the type of icon to display on the left of the dialog.
38545>>>        Procedure SET CMsgBoxExIcon OLE_mbIconConstants lpropVal
38546>>>                Send SetIntegerProperty 1073938440 lpropVal
38547>>>        End_Procedure
38548>>>
38548>>>// Returns/sets the sound to use if the Icon property is mbCustomIcon.
38548>>>        Function CMsgBoxExCustomIconSound Returns OLE_mbIconSoundConstants
38549>>>                Local OLE_mbIconSoundConstants lpropVal
38550>>>                Get GetIntegerProperty 1073938441 to lpropVal
38551>>>                Function_Return lpropVal
38552>>>        End_Function
38553>>>
38553>>>// Returns/sets the sound to use if the Icon property is mbCustomIcon.
38553>>>        Procedure SET CMsgBoxExCustomIconSound OLE_mbIconSoundConstants lpropVal
38554>>>                Send SetIntegerProperty 1073938441 lpropVal
38555>>>        End_Procedure
38556>>>
38556>>>// Returns/sets a value indicating whether the text is aligned to the right.
38556>>>        Function CMsgBoxExRightAligned Returns Bool
38557>>>                Local Bool lpropVal
38558>>>                Get GetBoolProperty 1073938442 to lpropVal
38559>>>                Function_Return lpropVal
38560>>>        End_Function
38561>>>
38561>>>// Returns/sets a value indicating whether the text is aligned to the right.
38561>>>        Procedure SET CMsgBoxExRightAligned Bool lpropVal
38562>>>                Send SetBoolProperty 1073938442 lpropVal
38563>>>        End_Procedure
38564>>>
38564>>>// Returns or sets a value specifying the position of the message box when it first appears.
38564>>>        Function CMsgBoxExPosition Returns DWORD //OLE_StartUpPositionConstants
38565>>>                Local DWORD lpropVal //OLE_StartUpPositionConstants lpropVal
38566>>>                Get GetIntegerProperty 1073938443 to lpropVal
38567>>>                Function_Return lpropVal
38568>>>        End_Function
38569>>>
38569>>>// Returns or sets a value specifying the position of the message box when it first appears.
38569>>>        Procedure SET CMsgBoxExPosition DWORD lpropVal //OLE_StartUpPositionConstants lpropVal
38570>>>                Send SetIntegerProperty 1073938443 lpropVal
38571>>>        End_Procedure
38572>>>
38572>>>// Returns/sets the pixel coordinate of the dialog box's top edge, relative to the entire screen. Evaluated only if Position is set to vbStartUpManual.
38572>>>        Function CMsgBoxExTopDialogPos Returns DWORD
38573>>>                Local DWORD lpropVal
38574>>>                Get GetIntegerProperty 1073938444 to lpropVal
38575>>>                Function_Return lpropVal
38576>>>        End_Function
38577>>>
38577>>>// Returns/sets the pixel coordinate of the dialog box's top edge, relative to the entire screen. Evaluated only if Position is set to vbStartUpManual.
38577>>>        Procedure SET CMsgBoxExTopDialogPos DWORD lpropVal
38578>>>                Send SetIntegerProperty 1073938444 lpropVal
38579>>>        End_Procedure
38580>>>
38580>>>// Returns/sets the pixel coordinate of the dialog box's left edge, relative to the entire screen. Evaluated only if Position is set to vbStartUpManual.
38580>>>        Function CMsgBoxExLeftDialogPos Returns DWORD
38581>>>                Local DWORD lpropVal
38582>>>                Get GetIntegerProperty 1073938445 to lpropVal
38583>>>                Function_Return lpropVal
38584>>>        End_Function
38585>>>
38585>>>// Returns/sets the pixel coordinate of the dialog box's left edge, relative to the entire screen. Evaluated only if Position is set to vbStartUpManual.
38585>>>        Procedure SET CMsgBoxExLeftDialogPos DWORD lpropVal
38586>>>                Send SetIntegerProperty 1073938445 lpropVal
38587>>>        End_Procedure
38588>>>
38588>>>// Returns/sets the icon to use if the Icon property is mbCustomIcon.
38588>>>        Function CMsgBoxExCustomIcon Returns LPDispatch
38589>>>                Local LPDispatch lpropVal
38590>>>                Get GetLPDispatchProperty 1073938446 to lpropVal
38591>>>                Function_Return lpropVal
38592>>>        End_Function
38593>>>
38593>>>// Returns/sets the icon to use if the Icon property is mbCustomIcon.
38593>>>        Procedure SET CMsgBoxExCustomIcon LPDispatch lpropVal
38594>>>                Send SetLPDispatchProperty 1073938446 lpropVal
38595>>>        End_Procedure
38596>>>
38596>>>// Returns/sets the caption of the first custom button.
38596>>>        Function CMsgBoxExButton1Caption Returns String
38597>>>                Local String lpropVal
38598>>>                Get GetStringProperty 1073938447 to lpropVal
38599>>>                Function_Return lpropVal
38600>>>        End_Function
38601>>>
38601>>>// Returns/sets the caption of the first custom button.
38601>>>        Procedure SET CMsgBoxExButton1Caption String lpropVal
38602>>>                Send SetStringProperty 1073938447 lpropVal
38603>>>        End_Procedure
38604>>>
38604>>>// Returns/sets the caption of the second custom button.
38604>>>        Function CMsgBoxExButton2Caption Returns String
38605>>>                Local String lpropVal
38606>>>                Get GetStringProperty 1073938448 to lpropVal
38607>>>                Function_Return lpropVal
38608>>>        End_Function
38609>>>
38609>>>// Returns/sets the caption of the second custom button.
38609>>>        Procedure SET CMsgBoxExButton2Caption String lpropVal
38610>>>                Send SetStringProperty 1073938448 lpropVal
38611>>>        End_Procedure
38612>>>
38612>>>// Returns/sets the caption of the third custom button.
38612>>>        Function CMsgBoxExButton3Caption Returns String
38613>>>                Local String lpropVal
38614>>>                Get GetStringProperty 1073938449 to lpropVal
38615>>>                Function_Return lpropVal
38616>>>        End_Function
38617>>>
38617>>>// Returns/sets the caption of the third custom button.
38617>>>        Procedure SET CMsgBoxExButton3Caption String lpropVal
38618>>>                Send SetStringProperty 1073938449 lpropVal
38619>>>        End_Procedure
38620>>>
38620>>>// Returns/sets the caption of the fourth custom button.
38620>>>        Function CMsgBoxExButton4Caption Returns String
38621>>>                Local String lpropVal
38622>>>                Get GetStringProperty 1073938450 to lpropVal
38623>>>                Function_Return lpropVal
38624>>>        End_Function
38625>>>
38625>>>// Returns/sets the caption of the fourth custom button.
38625>>>        Procedure SET CMsgBoxExButton4Caption String lpropVal
38626>>>                Send SetStringProperty 1073938450 lpropVal
38627>>>        End_Procedure
38628>>>
38628>>>// Returns the result of the message box.
38628>>>        Function CMsgBoxExResult Returns OLE_mbResultConstants
38629>>>                Local OLE_mbResultConstants lpropVal
38630>>>                Get GetIntegerProperty 0 to lpropVal
38631>>>                Function_Return lpropVal
38632>>>        End_Function
38633>>>
38633>>>// Opens the AboutBox dialog.
38633>>>        Procedure CMsgBoxExAbout
38634>>>                Send InvokeVoidFunction -552
38635>>>        End_Procedure 
38636>>>
38636>>>// Opens the message box.
38636>>>        Function CMsgBoxExShow Returns OLE_mbResultConstants
38637>>>                Local OLE_mbResultConstants lretVal
38638>>>                Get InvokeIntegerFunction 1610809344 to lretVal
38639>>>                Function_Return lretVal
38640>>>        End_Function 
38641>>>
38641>>>End_Class
38642>>>
38642>>>// CoClass CLSID:{572FF238-2066-11D4-8ED4-00E07D815373}
38642>>>// ProgId: MBMsgBoxEx.CMsgBoxEx
38642>>>// Number of impl.Types:1
38642>>>// Referenced class _CMsgBoxEx
38642>>>Class OLECMsgBoxEx is a Automation_Client
38643>>>        Import_Class_Protocol OLE_CMsgBoxEx
38644>>>
38644>>>        Procedure Construct_Object
38645>>>                Forward Send Construct_Object
38647>>>                Set progIdStr to "MBMsgBoxEx.CMsgBoxEx"
38648>>>        End_Procedure
38649>>>End_Class
38650>Use Wait.Dg
38650>
INCLUDING FILE: XRHSH.PKG
38650>>//------------------------------
38650>>Use SelectXr.Dg
INCLUDING FILE: SELECTXR.DG
38650>>>>//AB/ Project SelectXr
38650>>>>//AB/     Object prj is a Dialog_Project
38650>>>>//AB/         Set ProjectName to "SelectXr"
38650>>>>//AB/         Set ProjectFileName to "SelectXr.DG"
38650>>>>//AB/         Set GenerateFileName to "NONAME"
38650>>>>
38650>>>>// Project Object Structure
38650>>>>//   oSelectYear is a dbModalPanelSub
38650>>>>//     Company_DD is a DataDictionary
38650>>>>//     Branch_DD is a DataDictionary
38650>>>>//     Year_DD is a DataDictionary
38650>>>>//     Company_Company_Code is a dbFormSub
38650>>>>//     Company_Company_Name is a dbFormSub
38650>>>>//     Branch_Branch_Code is a dbFormSub
38650>>>>//     Branch_Branch_Name is a dbFormSub
38650>>>>//     Year_Year_Year is a dbFormSub
38650>>>>//     Year_Year_Descr is a dbFormSub
38650>>>>//     Year_Year_Entrydate is a dbFormSub
38650>>>>//     oOk_bn is a ButtonSub
38650>>>>//     oCancel_bn is a ButtonSub
38650>>>>//     otxtCompany is a TextBoxSub
38650>>>>//     otxtBranch is a TextBoxSub
38650>>>>//     otxtYear is a TextBoxSub
38650>>>>//     otxtWorkingDay is a TextBoxSub
38650>>>>//     otxtWorkingDay is a TextBoxSub
38650>>>>//     chkxr is a CheckBoxSub
38650>>>>
38650>>>>// Register all objects
38650>>>>Register_Object Branch_Branch_Code
38650>>>>Register_Object Branch_Branch_Name
38650>>>>Register_Object Branch_DD
38650>>>>Register_Object Company_Company_Code
38650>>>>Register_Object Company_Company_Name
38650>>>>Register_Object Company_DD
38650>>>>Register_Object chkxr
38650>>>>Register_Object oCancel_bn
38650>>>>Register_Object oOk_bn
38650>>>>Register_Object oSelectYear
38650>>>>Register_Object otxtBranch
38650>>>>Register_Object otxtCompany
38650>>>>Register_Object otxtWorkingDay
38650>>>>Register_Object otxtYear
38650>>>>Register_Object Year_DD
38650>>>>Register_Object Year_Year_Descr
38650>>>>Register_Object Year_Year_Entrydate
38650>>>>Register_Object Year_Year_Year
38650>>>>
38650>>>>
38650>>>>
38650>>>>    //AB-StoreTopStart
38650>>>>
38650>>>>
38650>>>>
38650>>>>
38650>>>>           String  gs_selected_beto_site
38650>>>>
38650>>>>    Open SysCurXR
38652>>>>    Open Nomisma
38654>>>>
38654>>>>    //AB-StoreTopEnd
38654>>>>
38654>>>>    //AB-IgnoreStart
38654>>>>
38654>>>>    Use DFAllEnt.pkg
38654>>>>    Use dbForm.Sub
38654>>>>    Use Button.Sub
38654>>>>    Use Txtbox.Sub
38654>>>>    Use Chkbox.Sub
38654>>>>
38654>>>>
38654>>>>    Use COMPANY.DD
INCLUDING FILE: COMPANY.DD
38654>>>>>>//DDB-FileStart
38654>>>>>>//DDB-HeaderStart
38654>>>>>>
38654>>>>>>// File Name : COMPANY.DD
38654>>>>>>// Class Name: Company_DataDictionary
38654>>>>>>// Revision  : 62
38654>>>>>>// Version   : 2
38654>>>>>>
38654>>>>>>Use  Windows           // Basic Definitions
38654>>>>>>Use  DataDict          // DataDictionary Class Definition
38654>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38654>>>>>>
38654>>>>>>Open Company
INCLUDING FILE: COMPANY.FD
38656>>>>>>Open Branch
38658>>>>>>
38658>>>>>>//DDB-HeaderEnd
38658>>>>>>//DDB-ValidationStart
38658>>>>>>
38658>>>>>>Register_Object Company_Company_Doy_VT
38658>>>>>>Register_Object Company_Company_J_Code_VT
38658>>>>>>
38658>>>>>>Object Company_Company_Doy_VT  is a CodeValidationTable
38660>>>>>>    Set Type_Value        To "DOY"
38661>>>>>>    Set Allow_Blank_State To TRUE
38662>>>>>>    //DDB-ValidationCustomStart
38662>>>>>>    //DDB-ValidationCustomEnd
38662>>>>>>End_Object   // Company_Company_Doy_VT
38663>>>>>>
38663>>>>>>Object Company_Company_J_Code_VT  is a CodeValidationTable
38665>>>>>>    Set Type_Value        To "JOB"
38666>>>>>>    Set Allow_Blank_State To TRUE
38667>>>>>>    //DDB-ValidationCustomStart
38667>>>>>>    //DDB-ValidationCustomEnd
38667>>>>>>End_Object   // Company_Company_J_Code_VT
38668>>>>>>//DDB-ValidationEnd
38668>>>>>>//DDB-SelectionStart
38668>>>>>>//DDB/ ExternalSelectionList sl001  sl001.sl
38668>>>>>>Register_Object sl001
38668>>>>>>//DDB-SelectionEnd
38668>>>>>> 
38668>>>>>>Class Company_DataDictionary  is a DataDictionary
38669>>>>>> 
38669>>>>>>    // Update:
38669>>>>>> 
38669>>>>>>    Procedure Update
38670>>>>>>        Forward Send Update
38672>>>>>>        move 'DOY' to company.doy_type
38673>>>>>>        move 'JOB' to company.jcode_type 
38674>>>>>>        // Insert Code Here
38674>>>>>>    End_Procedure   // Update
38675>>>>>> 
38675>>>>>>
38675>>>>>>    // Operation_Not_Allowed:
38675>>>>>>
38675>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
38676>>>>>>        // Insert Code Here
38676>>>>>>        Case Begin
38676>>>>>>             Case (iError_Num = 1001)
38678>>>>>>                  Error 1001 "DDC 051:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª „«˜ ¨œå˜ª!\n\n‰œ¤æª ‰à› ¡æª"
38679>>>>>>>
38679>>>>>>             Case Break
38680>>>>>>
38680>>>>>>             Case Else
38680>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
38682>>>>>>        Case End
38682>>>>>>    End_Procedure   // Operation_Not_Allowed
38683>>>>>>
38683>>>>>>
38683>>>>>>    // Validate_Save:
38683>>>>>>
38683>>>>>>    Function Validate_Save  Returns Integer
38684>>>>>>        Local Integer iReturnVal
38685>>>>>>        Forward Get Validate_Save  To iReturnVal
38687>>>>>>        If (Not(iReturnVal)) Begin
38689>>>>>>            // Insert Code Here
38689>>>>>>            If (Company.Company_Code="") Send Operation_Not_Allowed 1001
38692>>>>>>        End
38692>>>>>>>
38692>>>>>>        Function_Return iReturnVal
38693>>>>>>    End_Function   // Validate_Save
38694>>>>>>
38694>>>>>>
38694>>>>>>    // Define_Fields:
38694>>>>>>    // This procedure is used to set up all data-dictionary rules.
38694>>>>>>
38694>>>>>>    Procedure Define_Fields
38695>>>>>>        Forward Send Define_Fields
38697>>>>>>        //DDB-Generated-Code-Location
38697>>>>>>        //DDB-DefineFieldStart
38697>>>>>>
38697>>>>>>        Set Main_File            To Company.File_Number
38698>>>>>>        Set Cascade_Delete_State To FALSE
38699>>>>>>
38699>>>>>>
38699>>>>>>        // Child (Client) file structure................
38699>>>>>>        Send Add_Client_File  Branch.File_Number
38700>>>>>>
38700>>>>>>        // Field-based properties.......................
38700>>>>>>
38700>>>>>>        // Company.Company_Code
38700>>>>>>        Set Field_Options          Field Company.Company_Code To DD_AUTOFIND   
38701>>>>>>        Set Field_Prompt_Object    Field Company.Company_Code To (sl001(Self))
38702>>>>>>
38702>>>>>>        // Company.Company_Name
38702>>>>>>        Set Field_Options          Field Company.Company_Name To DD_REQUIRED   
38703>>>>>>        Set Field_Prompt_Object    Field Company.Company_Name To (sl001(Self))
38704>>>>>>
38704>>>>>>        // Company.Company_Afm
38704>>>>>>        Set Field_Options          Field Company.Company_Afm To DD_AUTOFIND   
38705>>>>>>
38705>>>>>>        // Company.Company_Addr
38705>>>>>>
38705>>>>>>        // Company.Company_Tk
38705>>>>>>
38705>>>>>>        // Company.Company_Poli
38705>>>>>>
38705>>>>>>        // Company.Company_Doy
38705>>>>>>        Set Field_Value_Table      Field Company.Company_Doy To (Company_Company_Doy_VT(Self))
38706>>>>>>
38706>>>>>>        // Company.Company_J_Code
38706>>>>>>        Set Field_Value_Table      Field Company.Company_J_Code To (Company_Company_J_Code_VT(Self))
38707>>>>>>
38707>>>>>>        // Company.Company_C_Code0
38707>>>>>>
38707>>>>>>        // Company.Company_C_Cod00
38707>>>>>>
38707>>>>>>        // Company.Company_C_Coder
38707>>>>>>
38707>>>>>>        // Company.Company_Tel
38707>>>>>>
38707>>>>>>        // Company.Company_Fax
38707>>>>>>
38707>>>>>>        // Company.Company_Email
38707>>>>>>
38707>>>>>>        // Company.Company_Resp
38707>>>>>>
38707>>>>>>        // Company.Company_Bitmap
38707>>>>>>
38707>>>>>>        // Company.Beto_Site
38707>>>>>>
38707>>>>>>        // Company.Logo
38707>>>>>>
38707>>>>>>        // Company.Doy_Type
38707>>>>>>
38707>>>>>>        // Company.Jcode_Type
38707>>>>>>
38707>>>>>>        // Company.Sap_Code
38707>>>>>>
38707>>>>>>        // Company.Sap_Path
38707>>>>>>
38707>>>>>>        //DDB-DefineFieldEnd
38707>>>>>>    End_Procedure    // Define_Fields
38708>>>>>>
38708>>>>>>    // Field_Defaults:
38708>>>>>>    // This procedure is used to establish default field values.
38708>>>>>>
38708>>>>>>    Procedure Field_Defaults
38709>>>>>>        Forward Send Field_Defaults
38711>>>>>>        //DDB-Generated-Code-Location
38711>>>>>>        //DDB-FieldDefaultStart
38711>>>>>>        //DDB-FieldDefaultEnd
38711>>>>>>    End_Procedure    // Field_Defaults
38712>>>>>>End_Class    // Company_DataDictionary
38713>>>>>>
38713>>>>>>//DDB-Selection-pkg-Start
38713>>>>>>
38713>>>>>>Use sl001.sl         // sl001
INCLUDING FILE: SL001.SL
38713>>>>>>>>//AB/ Project sl001 : Etairies
38713>>>>>>>>//AB/     Object prj is a Lookup_Project
38713>>>>>>>>//AB/         Set ProjectName to "sl001 : Etairies"
38713>>>>>>>>//AB/         Set ProjectFileName to "sl001.SL"
38713>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
38713>>>>>>>>
38713>>>>>>>>// Project Object Structure
38713>>>>>>>>//   sl001 is a dbModalPanel
38713>>>>>>>>//     Company_DD is a DataDictionary
38713>>>>>>>>//     oSelList is a dbList
38713>>>>>>>>//     oOK_bn is a ButtonSub
38713>>>>>>>>//     oCancel_bn is a ButtonSub
38713>>>>>>>>//     oSearch_bn is a ButtonSub
38713>>>>>>>>
38713>>>>>>>>// Register all objects
38713>>>>>>>>Register_Object Company_DD
38713>>>>>>>>Register_Object oCancel_bn
38713>>>>>>>>Register_Object oOK_bn
38713>>>>>>>>Register_Object oSearch_bn
38713>>>>>>>>Register_Object oSelList
38713>>>>>>>>Register_Object sl001
38713>>>>>>>>
38713>>>>>>>>
38713>>>>>>>>    //AB-IgnoreStart
38713>>>>>>>>
38713>>>>>>>>    Use DFAllEnt.pkg
38713>>>>>>>>    Use Button.Sub
38713>>>>>>>>
38713>>>>>>>>
38713>>>>>>>>    Use COMPANY.DD
38713>>>>>>>>    
38713>>>>>>>>    //AB-IgnoreEnd
38713>>>>>>>>
38713>>>>>>>>    CD_Popup_Object sl001 is a dbModalPanel
38732>>>>>>>>        Set Label to "„«˜ ¨åœª"
38733>>>>>>>>        Set Size to 148 297
38734>>>>>>>>        Set Location to 12 27
38735>>>>>>>>
38735>>>>>>>>        //AB-DDOStart
38735>>>>>>>>
38735>>>>>>>>        Object Company_DD is a Company_DataDictionary
38737>>>>>>>>        End_Object    // Company_DD
38738>>>>>>>>
38738>>>>>>>>        Set Main_DD to (Company_DD(self))
38739>>>>>>>>        Set Server to (Company_DD(self))
38740>>>>>>>>
38740>>>>>>>>        //AB-DDOEnd
38740>>>>>>>>
38740>>>>>>>>        Object oSelList is a dbList
38742>>>>>>>>            Set Main_File to Company.File_Number
38743>>>>>>>>            Set Size to 105 280
38744>>>>>>>>            Set Location to 6 6
38745>>>>>>>>
38745>>>>>>>>            Begin_Row
38748>>>>>>>>                Entry_Item Company.Company_code
38749>>>>>>>>                Entry_Item Company.Company_name
38750>>>>>>>>                Entry_Item Company.Company_afm
38751>>>>>>>>            End_Row
38756>>>>>>>>
38756>>>>>>>>            Set Form_Width    item 0 to 42
38757>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
38758>>>>>>>>            
38758>>>>>>>>            Set Form_Width    item 1 to 150
38759>>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
38760>>>>>>>>            
38760>>>>>>>>            Set Form_Width    item 2 to 80
38761>>>>>>>>            Set Header_Label  item 2 to "€.”.‹"
38762>>>>>>>>            
38762>>>>>>>>        End_Object    // oSelList
38763>>>>>>>>
38763>>>>>>>>        Object oOK_bn is a ButtonSub
38765>>>>>>>>            Set Label to "&„§ ¢¦šã"
38766>>>>>>>>            Set Location to 115 126
38767>>>>>>>>
38767>>>>>>>>            //AB-StoreStart
38767>>>>>>>>            Procedure OnClick
38769>>>>>>>>                Send OK To (oSelList(current_object))
38770>>>>>>>>            End_Procedure
38771>>>>>>>>            //AB-StoreEnd
38771>>>>>>>>
38771>>>>>>>>        End_Object    // oOK_bn
38772>>>>>>>>
38772>>>>>>>>        Object oCancel_bn is a ButtonSub
38774>>>>>>>>            Set Label to "&€¡ç¨à©ž"
38775>>>>>>>>            Set Location to 115 181
38776>>>>>>>>
38776>>>>>>>>            //AB-StoreStart
38776>>>>>>>>            Procedure OnClick
38778>>>>>>>>                Send Cancel To (oSelList(current_object))
38779>>>>>>>>            End_Procedure
38780>>>>>>>>            //AB-StoreEnd
38780>>>>>>>>
38780>>>>>>>>        End_Object    // oCancel_bn
38781>>>>>>>>
38781>>>>>>>>        Object oSearch_bn is a ButtonSub
38783>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
38784>>>>>>>>            Set Location to 115 236
38785>>>>>>>>
38785>>>>>>>>            //AB-StoreStart
38785>>>>>>>>            Procedure OnClick
38787>>>>>>>>                Send Search To (oSelList(current_object))
38788>>>>>>>>            End_Procedure
38789>>>>>>>>            //AB-StoreEnd
38789>>>>>>>>
38789>>>>>>>>        End_Object    // oSearch_bn
38790>>>>>>>>
38790>>>>>>>>
38790>>>>>>>>        //AB-StoreStart
38790>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To oOk_bn
38791>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To oCancel_bn
38792>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To oSearch_bn
38793>>>>>>>>        //AB-StoreEnd
38793>>>>>>>>
38793>>>>>>>>    CD_End_Object    // sl001
38795>>>>>>>>>
38795>>>>>>>>
38795>>>>>>>>//AB/     End_Object    // prj
38795>>>>>>
38795>>>>>>//DDB-Selection-pkg-End
38795>>>>>>//DDB-FileEnd
38795>>>>    Use BRANCH.DD
INCLUDING FILE: BRANCH.DD
38795>>>>>>//DDB-FileStart
38795>>>>>>//DDB-HeaderStart
38795>>>>>>
38795>>>>>>// File Name : BRANCH.DD
38795>>>>>>// Class Name: Branch_DataDictionary
38795>>>>>>// Revision  : 89
38795>>>>>>// Version   : 2
38795>>>>>>
38795>>>>>>Use  Windows           // Basic Definitions
38795>>>>>>Use  DataDict          // DataDictionary Class Definition
38795>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38795>>>>>>
38795>>>>>>Open Branch
38797>>>>>>Open Year
38799>>>>>>Open Brzones
INCLUDING FILE: BRZONES.FD
38801>>>>>>Open Tpbranch
INCLUDING FILE: TPBRANCH.FD
38803>>>>>>Open Company
38805>>>>>>Open Sysrecg
INCLUDING FILE: SYSRECG.FD
38807>>>>>>
38807>>>>>>//DDB-HeaderEnd
38807>>>>>>//DDB-ValidationStart
38807>>>>>>
38807>>>>>>Register_Object Branch_Branch_Doy_VT
38807>>>>>>Register_Object Branch_Branch_C_Code0_VT
38807>>>>>>
38807>>>>>>Object Branch_Branch_Doy_VT  is a CodeValidationTable
38809>>>>>>    Set Type_Value        To "DOY"
38810>>>>>>    Set Validate_State    To FALSE
38811>>>>>>    Set Allow_Blank_State To TRUE
38812>>>>>>    //DDB-ValidationCustomStart
38812>>>>>>    //DDB-ValidationCustomEnd
38812>>>>>>End_Object   // Branch_Branch_Doy_VT
38813>>>>>>
38813>>>>>>Object Branch_Branch_C_Code0_VT  is a CodeValidationTable
38815>>>>>>    Set Type_Value        To ""
38816>>>>>>    Set Allow_Blank_State To TRUE
38817>>>>>>    //DDB-ValidationCustomStart
38817>>>>>>    //DDB-ValidationCustomEnd
38817>>>>>>End_Object   // Branch_Branch_C_Code0_VT
38818>>>>>>//DDB-ValidationEnd
38818>>>>>>//DDB-SelectionStart
38818>>>>>>//DDB/ ExternalSelectionList SL002  Sl002.sl
38818>>>>>>Register_Object SL002
38818>>>>>>//DDB-SelectionEnd
38818>>>>>>
38818>>>>>>Class Branch_DataDictionary  is a DataDictionary
38819>>>>>> 
38819>>>>>>    Procedure Save_Main_File
38820>>>>>>        Forward Send Save_Main_File
38822>>>>>>        // Insert Code Here
38822>>>>>>    End_Procedure   // Save_Main_File
38823>>>>>> 
38823>>>>>>    Procedure Creating
38824>>>>>>        Forward Send Creating
38826>>>>>>        // Insert Code Here
38826>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Branch.Branch_Rec0)))))) to Branch.Branch_Recr
38827>>>>>>    End_Procedure   // Creating
38828>>>>>>
38828>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
38829>>>>>>        // Insert Code Here
38829>>>>>>        Case Begin
38829>>>>>>             Case (iError_Num = 1001)
38831>>>>>>                  Error 1001 "DDC 052:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
38832>>>>>>>
38832>>>>>>             Case Break
38833>>>>>>
38833>>>>>>             Case Else
38833>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
38835>>>>>>        Case End
38835>>>>>>    End_Procedure   // Operation_Not_Allowed
38836>>>>>>
38836>>>>>>
38836>>>>>>    // Validate_Save:
38836>>>>>>
38836>>>>>>    Function Validate_Save  Returns Integer
38837>>>>>>        Local Integer iReturnVal
38838>>>>>>        Forward Get Validate_Save  To iReturnVal
38840>>>>>>        If (Not(iReturnVal)) Begin
38842>>>>>>            // Insert Code Here
38842>>>>>>            If (Branch.Branch_Code="") Send Operation_Not_Allowed 1001
38845>>>>>>        End
38845>>>>>>>
38845>>>>>>        Function_Return iReturnVal
38846>>>>>>    End_Function   // Validate_Save
38847>>>>>>
38847>>>>>>
38847>>>>>>    // Define_Fields:
38847>>>>>>    // This procedure is used to set up all data-dictionary rules.
38847>>>>>>
38847>>>>>>    Procedure Define_Fields
38848>>>>>>        Forward Send Define_Fields
38850>>>>>>        //DDB-Generated-Code-Location
38850>>>>>>        //DDB-DefineFieldStart
38850>>>>>>
38850>>>>>>        Set Main_File            To Branch.File_Number
38851>>>>>>        Set Cascade_Delete_State To FALSE
38852>>>>>>
38852>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38853>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOENTER     DD_FINDREQ    
38854>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38855>>>>>>
38855>>>>>>        // Child (Client) file structure................
38855>>>>>>        Send Add_Client_File  Year.File_Number
38856>>>>>>        Send Add_Client_File  Brzones.File_Number
38857>>>>>>        Send Add_Client_File  Tpbranch.File_Number
38858>>>>>>
38858>>>>>>        // Parent (Server) file structure...............
38858>>>>>>        Send Add_Server_File  Company.File_Number
38859>>>>>>
38859>>>>>>        // External (System) file structure.............
38859>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
38860>>>>>>
38860>>>>>>        Define_Auto_Increment  Sysrecg.Branch_Rec0  To Branch.Branch_Rec0
38863>>>>>>
38863>>>>>>        // Field-based properties.......................
38863>>>>>>
38863>>>>>>        // Branch.Company_Code
38863>>>>>>
38863>>>>>>        // Branch.Branch_Code
38863>>>>>>        Set Field_Options          Field Branch.Branch_Code To DD_AUTOFIND   
38864>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Code To (SL002(Self))
38865>>>>>>        Set Key_Field_State        Field Branch.Branch_Code To TRUE
38866>>>>>>
38866>>>>>>        // Branch.Branch_Rec0
38866>>>>>>
38866>>>>>>        // Branch.Branch_Recr
38866>>>>>>
38866>>>>>>        // Branch.Branch_Name
38866>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Name To (SL002(Self))
38867>>>>>>
38867>>>>>>        // Branch.Branch_Afm
38867>>>>>>
38867>>>>>>        // Branch.Branch_Addr
38867>>>>>>
38867>>>>>>        // Branch.Branch_Tk
38867>>>>>>
38867>>>>>>        // Branch.Branch_Poli
38867>>>>>>
38867>>>>>>        // Branch.Branch_Doy
38867>>>>>>        Set Field_Value_Table      Field Branch.Branch_Doy To (Branch_Branch_Doy_VT(Self))
38868>>>>>>
38868>>>>>>        // Branch.Branch_J_Code
38868>>>>>>
38868>>>>>>        // Branch.Branch_C_Code0
38868>>>>>>        Set Field_Value_Table      Field Branch.Branch_C_Code0 To (Branch_Branch_C_Code0_VT(Self))
38869>>>>>>
38869>>>>>>        // Branch.Branch_C_Code00
38869>>>>>>
38869>>>>>>        // Branch.Branch_C_Coder
38869>>>>>>
38869>>>>>>        // Branch.Branch_Tel
38869>>>>>>
38869>>>>>>        // Branch.Branch_Fax
38869>>>>>>
38869>>>>>>        // Branch.Branch_Email
38869>>>>>>
38869>>>>>>        // Branch.Branch_Resp
38869>>>>>>
38869>>>>>>        // Branch.Branch_Bitmap
38869>>>>>>
38869>>>>>>        // Branch.Branch_Site
38869>>>>>>
38869>>>>>>        // Branch.Branch_Apoth
38869>>>>>>
38869>>>>>>        // Branch.Beto_Site
38869>>>>>>
38869>>>>>>        // Branch.Path_Exp
38869>>>>>>
38869>>>>>>        // Branch.Exp_Txtname
38869>>>>>>
38869>>>>>>        // Branch.Send_Phone
38869>>>>>>
38869>>>>>>        // Branch.Send_Path_Files
38869>>>>>>
38869>>>>>>        // Branch.Send_Path_Conf
38869>>>>>>
38869>>>>>>        // Branch.Tomeas_Code
38869>>>>>>
38869>>>>>>        // Branch.Ftp_Sec_Retry
38869>>>>>>
38869>>>>>>        // Branch.Ftp_Sec_Exit
38869>>>>>>
38869>>>>>>        // Branch.Ras_Name
38869>>>>>>
38869>>>>>>        // Branch.Ras_Passw
38869>>>>>>
38869>>>>>>        // Branch.Ras_Domain
38869>>>>>>
38869>>>>>>        // Branch.Last_Hmnia_Ekt
38869>>>>>>
38869>>>>>>        // Branch.Deop_Logo
38869>>>>>>
38869>>>>>>        // Branch.Entolh
38869>>>>>>
38869>>>>>>        // Branch.Paragogh
38869>>>>>>
38869>>>>>>        // Branch.Locked_Until
38869>>>>>>
38869>>>>>>        // Branch.Sap_Code
38869>>>>>>
38869>>>>>>        // Branch.Perioxh
38869>>>>>>
38869>>>>>>        // Branch.Egkatastash
38869>>>>>>
38869>>>>>>        //DDB-DefineFieldEnd
38869>>>>>>    End_Procedure    // Define_Fields
38870>>>>>>
38870>>>>>>    // Field_Defaults:
38870>>>>>>    // This procedure is used to establish default field values.
38870>>>>>>
38870>>>>>>    Procedure Field_Defaults
38871>>>>>>        Forward Send Field_Defaults
38873>>>>>>        //DDB-Generated-Code-Location
38873>>>>>>        //DDB-FieldDefaultStart
38873>>>>>>        //DDB-FieldDefaultEnd
38873>>>>>>    End_Procedure    // Field_Defaults
38874>>>>>>End_Class    // Branch_DataDictionary
38875>>>>>>
38875>>>>>>//DDB-Selection-pkg-Start
38875>>>>>>
38875>>>>>>Use Sl002.sl         // SL002
INCLUDING FILE: SL002.SL
38875>>>>>>>>//AB/ Project SL002:Branch
38875>>>>>>>>//AB/ Object prj is a Lookup_Project
38875>>>>>>>>//AB/     Set ProjectName to "SL002:Branch"
38875>>>>>>>>//AB/     Set ProjectFileName to "Sl002.sl"
38875>>>>>>>>
38875>>>>>>>>// Project Object Structure
38875>>>>>>>>//   SL002 is a dbModalPanelSub
38875>>>>>>>>//     Company_DD is a DataDictionary
38875>>>>>>>>//     Branch_DD is a DataDictionary
38875>>>>>>>>//     oSelList is a dbListSub
38875>>>>>>>>//     oOK_bn is a ButtonSub
38875>>>>>>>>//     oCancel_bn is a ButtonSub
38875>>>>>>>>//     oSearch_bn is a ButtonSub
38875>>>>>>>>
38875>>>>>>>>// Register all objects
38875>>>>>>>>Register_Object Branch_DD
38875>>>>>>>>Register_Object Company_DD
38875>>>>>>>>Register_Object oCancel_bn
38875>>>>>>>>Register_Object oOK_bn
38875>>>>>>>>Register_Object oSearch_bn
38875>>>>>>>>Register_Object oSelList
38875>>>>>>>>Register_Object SL002
38875>>>>>>>>
38875>>>>>>>>
38875>>>>>>>>//AB-IgnoreStart
38875>>>>>>>>
38875>>>>>>>>Use DFAllEnt.pkg
38875>>>>>>>>Use dbList.Sub
38875>>>>>>>>Use Button.Sub
38875>>>>>>>>
38875>>>>>>>>
38875>>>>>>>>Use COMPANY.DD
38875>>>>>>>>Use BRANCH.DD
38875>>>>>>>>
38875>>>>>>>>//AB-IgnoreEnd
38875>>>>>>>>
38875>>>>>>>>Object SL002 is a dbModalPanelSub
38877>>>>>>>>
38877>>>>>>>>    //AB-StoreTopStart
38877>>>>>>>>    Property String psFragmaCompanyCode  ""
38879>>>>>>>>    
38879>>>>>>>>    //AB-StoreTopEnd
38879>>>>>>>>
38879>>>>>>>>    Set Minimize_Icon to FALSE
38880>>>>>>>>    Set Label to "“§¦¡˜«˜©«ã£˜«˜"
38881>>>>>>>>    Set Size to 146 430
38882>>>>>>>>    Set Location to 4 5
38883>>>>>>>>    Set Exit_Application_Local_State to FALSE
38884>>>>>>>>    Set Modal_State to FALSE
38885>>>>>>>>
38885>>>>>>>>    //AB-DDOStart
38885>>>>>>>>
38885>>>>>>>>    Object Company_DD is a Company_DataDictionary
38887>>>>>>>>    End_Object    // Company_DD
38888>>>>>>>>
38888>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
38890>>>>>>>>        Set DDO_Server to (Company_DD(self))
38891>>>>>>>>
38891>>>>>>>>        //AB-StoreStart
38891>>>>>>>>        Procedure OnConstrain
38893>>>>>>>>             String lsCompanyCode
38894>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
38895>>>>>>>>             If (lsCompanyCode <> "") Constrain Branch.Company_code eq lsCompanyCode
38899>>>>>>>>        End_Procedure // OnConstrain
38900>>>>>>>>        
38900>>>>>>>>        
38900>>>>>>>>        
38900>>>>>>>>        //AB-StoreEnd
38900>>>>>>>>
38900>>>>>>>>    End_Object    // Branch_DD
38901>>>>>>>>
38901>>>>>>>>    Set Main_DD to (Branch_DD(self))
38902>>>>>>>>    Set Server to (Branch_DD(self))
38903>>>>>>>>
38903>>>>>>>>    //AB-DDOEnd
38903>>>>>>>>
38903>>>>>>>>    Object oSelList is a dbListSub
38905>>>>>>>>        Set Main_File to Branch.File_Number
38906>>>>>>>>        Set Size to 105 415
38907>>>>>>>>        Set Location to 6 6
38908>>>>>>>>
38908>>>>>>>>        Begin_Row
38911>>>>>>>>            Entry_Item Branch.Branch_code
38912>>>>>>>>            Entry_Item Branch.Branch_name
38913>>>>>>>>            Entry_Item Company.Company_code
38914>>>>>>>>            Entry_Item Company.Company_name
38915>>>>>>>>            Entry_Item Branch.Beto_site
38916>>>>>>>>            Entry_Item Branch.Branch_recr
38917>>>>>>>>        End_Row
38922>>>>>>>>
38922>>>>>>>>        Set Form_Width    item 0 to 60
38923>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
38924>>>>>>>>        
38924>>>>>>>>        Set Form_Width    item 1 to 128
38925>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜"
38926>>>>>>>>        
38926>>>>>>>>        Set Form_Width    item 2 to 69
38927>>>>>>>>        Set Header_Label  item 2 to "‰à› ¡æª „«˜ ¨å˜ª"
38928>>>>>>>>        
38928>>>>>>>>        Set Form_Width    item 3 to 109
38929>>>>>>>>        Set Header_Label  item 3 to "Ž¤¦£˜ „«˜ ¨å˜ª"
38930>>>>>>>>        
38930>>>>>>>>        Set Form_Width    item 4 to 42
38931>>>>>>>>        Set Header_Label  item 4 to "Site"
38932>>>>>>>>        
38932>>>>>>>>        Set Form_Width    item 5 to 0
38933>>>>>>>>        Set Header_Label  item 5 to ""
38934>>>>>>>>        
38934>>>>>>>>
38934>>>>>>>>        //AB-StoreStart
38934>>>>>>>>                
38934>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
38936>>>>>>>>        
38936>>>>>>>>        Procedure Store_Defaults
38938>>>>>>>>            forward send Store_Defaults
38940>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
38941>>>>>>>>        end_Procedure // Store_Defaults
38942>>>>>>>>        
38942>>>>>>>>        Procedure Restore_Defaults
38944>>>>>>>>            forward send Restore_Defaults
38946>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
38947>>>>>>>>        end_Procedure // Restore_Defaults
38948>>>>>>>>        
38948>>>>>>>>        Procedure Activating
38950>>>>>>>>            Forward Send Activating
38952>>>>>>>>            Send Rebuild_Constraints to (Branch_DD(self))
38953>>>>>>>>        End_Procedure // Activating
38954>>>>>>>>        
38954>>>>>>>>        Set Column_Options Item 5 to NoEnter True
38955>>>>>>>>        
38955>>>>>>>>        
38955>>>>>>>>        //AB-StoreEnd
38955>>>>>>>>
38955>>>>>>>>    End_Object    // oSelList
38956>>>>>>>>
38956>>>>>>>>    Object oOK_bn is a ButtonSub
38958>>>>>>>>        Set Label to "&„§ ¢¦šã"
38959>>>>>>>>        Set Location to 112 262
38960>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
38961>>>>>>>>
38961>>>>>>>>        //AB-StoreStart
38961>>>>>>>>        Procedure OnClick
38963>>>>>>>>            Send OK To (oSelList(current_object))
38964>>>>>>>>        End_Procedure
38965>>>>>>>>        //AB-StoreEnd
38965>>>>>>>>
38965>>>>>>>>    End_Object    // oOK_bn
38966>>>>>>>>
38966>>>>>>>>    Object oCancel_bn is a ButtonSub
38968>>>>>>>>        Set Label to "&€¡ç¨à©ž"
38969>>>>>>>>        Set Location to 112 317
38970>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
38971>>>>>>>>
38971>>>>>>>>        //AB-StoreStart
38971>>>>>>>>        Procedure OnClick
38973>>>>>>>>            Send Cancel To (oSelList(current_object))
38974>>>>>>>>        End_Procedure
38975>>>>>>>>        //AB-StoreEnd
38975>>>>>>>>
38975>>>>>>>>    End_Object    // oCancel_bn
38976>>>>>>>>
38976>>>>>>>>    Object oSearch_bn is a ButtonSub
38978>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
38979>>>>>>>>        Set Location to 112 372
38980>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
38981>>>>>>>>
38981>>>>>>>>        //AB-StoreStart
38981>>>>>>>>        Procedure OnClick
38983>>>>>>>>            Send Search To (oSelList(current_object))
38984>>>>>>>>        End_Procedure
38985>>>>>>>>        //AB-StoreEnd
38985>>>>>>>>
38985>>>>>>>>    End_Object    // oSearch_bn
38986>>>>>>>>
38986>>>>>>>>
38986>>>>>>>>    //AB-StoreStart
38986>>>>>>>>    
38986>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
38987>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
38988>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
38989>>>>>>>>    
38989>>>>>>>>    
38989>>>>>>>>    
38989>>>>>>>>    //AB-StoreEnd
38989>>>>>>>>
38989>>>>>>>>End_Object    // SL002
38990>>>>>>>>
38990>>>>>>>>//AB/ End_Object    // prj
38990>>>>>>
38990>>>>>>//DDB-Selection-pkg-End
38990>>>>>>//DDB-FileEnd
38990>>>>    Use YEAR.DD
INCLUDING FILE: YEAR.DD
38990>>>>>>//DDB-FileStart
38990>>>>>>//DDB-HeaderStart
38990>>>>>>
38990>>>>>>// File Name : YEAR.DD
38990>>>>>>// Class Name: Year_DataDictionary
38990>>>>>>// Revision  : 119
38990>>>>>>// Version   : 2
38990>>>>>>
38990>>>>>>Use  Windows           // Basic Definitions
38990>>>>>>Use  DataDict          // DataDictionary Class Definition
38990>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38990>>>>>>
38990>>>>>>Open Year
38992>>>>>>Open Branch
38994>>>>>>Open Syscurxr
38996>>>>>>
38996>>>>>>//DDB-HeaderEnd
38996>>>>>>//DDB-ValidationStart
38996>>>>>>
38996>>>>>>Register_Object Year_Year_C_Code0_VT1
38996>>>>>>Register_Object Year_Year_C_Code00_VT1
38996>>>>>>Register_Object Year_Year_C_Coder_VT1
38996>>>>>>
38996>>>>>>Object Year_Year_C_Code0_VT1  is a CodeValidationTable
38998>>>>>>    Set Type_Value        To "CURRENCY"
38999>>>>>>    //DDB-ValidationCustomStart
38999>>>>>>    //DDB-ValidationCustomEnd
38999>>>>>>End_Object   // Year_Year_C_Code0_VT1
39000>>>>>>
39000>>>>>>Object Year_Year_C_Code00_VT1  is a CodeValidationTable
39002>>>>>>    Set Type_Value        To "CURRENCY"
39003>>>>>>    //DDB-ValidationCustomStart
39003>>>>>>    //DDB-ValidationCustomEnd
39003>>>>>>End_Object   // Year_Year_C_Code00_VT1
39004>>>>>>
39004>>>>>>Object Year_Year_C_Coder_VT1  is a CodeValidationTable
39006>>>>>>    Set Type_Value        To "CURRENCY"
39007>>>>>>    //DDB-ValidationCustomStart
39007>>>>>>    //DDB-ValidationCustomEnd
39007>>>>>>End_Object   // Year_Year_C_Coder_VT1
39008>>>>>>//DDB-ValidationEnd
39008>>>>>>//DDB-SelectionStart
39008>>>>>>//DDB/ ExternalSelectionList SL003  Sl003.sl
39008>>>>>>Register_Object SL003
39008>>>>>>//DDB-SelectionEnd
39008>>>>>>            
39008>>>>>>Class Year_DataDictionary  is a DataDictionary
39009>>>>>>    
39009>>>>>>    Procedure Creating
39010>>>>>>        Forward Send Creating
39012>>>>>>        // Insert Code Here
39012>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Year.Year_Year)))))) to Year.Year_Recr
39013>>>>>>    End_Procedure   // Creating
39014>>>>>>
39014>>>>>>
39014>>>>>>    // Operation_Not_Allowed:
39014>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
39015>>>>>>        // Insert Code Here
39015>>>>>>        Case Begin    
39015>>>>>>             Case (iError_Num = 1001)
39017>>>>>>                  Error 1001 "DDC 053:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
39018>>>>>>>
39018>>>>>>             Case Break
39019>>>>>>             Case (iError_Num=1002)
39022>>>>>>                Error 1002 "DDC 053:Branch Site ¡˜«œ™˜å¤œ  ©«¦ Year ¡œ¤æ"
39023>>>>>>>
39023>>>>>>             Case Break
39024>>>>>>             Case (iError_Num=1003)
39027>>>>>>                Error 1003 "DDC 053:Company Code=0"
39028>>>>>>>
39028>>>>>>             Case Break
39029>>>>>>             Case (iError_Num=1004)
39032>>>>>>                Error 1004 "DDC 053:Branch Code=0"
39033>>>>>>>
39033>>>>>>             Case Break
39034>>>>>>             Case Else
39034>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
39036>>>>>>        Case End
39036>>>>>>    End_Procedure   // Operation_Not_Allowed
39037>>>>>>
39037>>>>>>
39037>>>>>>    // Update:
39037>>>>>>    // Use this message to effect changes in related-to files. The
39037>>>>>>    // Backout message should be designed to reverse the effects of this
39037>>>>>>    // message. It is invoked while the database is locked.
39037>>>>>>
39037>>>>>>    Procedure Update
39038>>>>>>        Forward Send Update
39040>>>>>>        // Insert Code Here
39040>>>>>>        Move Company.Company_Code   to Year.Company_Code
39041>>>>>>        Move Branch.Branch_Code     to Year.Branch_Code
39042>>>>>>        move branch.beto_site       to year.beto_site
39043>>>>>>
39043>>>>>>        //sos:parametrika apo sysfile?
39043>>>>>>       
39043>>>>>>       // If ((Year.Year_EntryDate-14) < Year.Year_XrhshFrom) Begin
39043>>>>>>       //     Move Year.Year_XrhshFrom to Year.Year_OpenFrom
39043>>>>>>       // End
39043>>>>>>       // Else Begin
39043>>>>>>       //     Move (Year.Year_EntryDate-14) to Year.Year_OpenFrom
39043>>>>>>       // End
39043>>>>>>      //  Move Year.Year_EntryDate      to Year.Year_OpenTo
39043>>>>>>    End_Procedure   // Update
39044>>>>>>
39044>>>>>>    // Validate_Save:
39044>>>>>>
39044>>>>>>    Function Validate_Save  Returns Integer
39045>>>>>>        Local Integer iReturnVal
39046>>>>>>        Forward Get Validate_Save  To iReturnVal
39048>>>>>>        If (Not(iReturnVal)) Begin
39050>>>>>>                 If (Year.Year_Year   = 0) Send Operation_Not_Allowed 1001
39053>>>>>>            Else If (Year.Company_Code='') Send Operation_Not_Allowed 1003
39057>>>>>>            Else If (Year.Branch_Code ='') Send Operation_Not_Allowed 1004
39061>>>>>>        End
39061>>>>>>>
39061>>>>>>        Function_Return iReturnVal
39062>>>>>>    End_Function   // Validate_Save
39063>>>>>>
39063>>>>>>
39063>>>>>>    // Define_Fields:
39063>>>>>>    // This procedure is used to set up all data-dictionary rules.
39063>>>>>>
39063>>>>>>    Procedure Define_Fields
39064>>>>>>        Forward Send Define_Fields
39066>>>>>>        //DDB-Generated-Code-Location
39066>>>>>>        //DDB-DefineFieldStart
39066>>>>>>
39066>>>>>>        Set Main_File            To Year.File_Number
39067>>>>>>        Set Cascade_Delete_State To FALSE
39068>>>>>>
39068>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39069>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39070>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39071>>>>>>
39071>>>>>>        // Parent (Server) file structure...............
39071>>>>>>        Send Add_Server_File  Branch.File_Number
39072>>>>>>
39072>>>>>>        // External (System) file structure.............
39072>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
39073>>>>>>
39073>>>>>>        // Field-based properties.......................
39073>>>>>>
39073>>>>>>        // Year.Company_Code
39073>>>>>>
39073>>>>>>        // Year.Branch_Code
39073>>>>>>
39073>>>>>>        // Year.Year_Year
39073>>>>>>        Set Field_Options          Field Year.Year_Year To DD_AUTOFIND    DD_REQUIRED   
39074>>>>>>        Set Field_Prompt_Object    Field Year.Year_Year To (SL003(Self))
39075>>>>>>        Set Key_Field_State        Field Year.Year_Year To TRUE
39076>>>>>>
39076>>>>>>        // Year.Year_Recr
39076>>>>>>        Set Field_Prompt_Object    Field Year.Year_Recr To (SL003(Self))
39077>>>>>>
39077>>>>>>        // Year.Branch_Recr
39077>>>>>>
39077>>>>>>        // Year.Year_Descr
39077>>>>>>
39077>>>>>>        // Year.Year_Isolfrom
39077>>>>>>
39077>>>>>>        // Year.Year_Isolto
39077>>>>>>
39077>>>>>>        // Year.Year_Openfrom
39077>>>>>>
39077>>>>>>        // Year.Year_Opento
39077>>>>>>
39077>>>>>>        // Year.Year_Entrydate
39077>>>>>>
39077>>>>>>        // Year.Year_Dateaa
39077>>>>>>
39077>>>>>>        // Year.Year_Xrhshfrom
39077>>>>>>
39077>>>>>>        // Year.Year_Xrhshto
39077>>>>>>
39077>>>>>>        // Year.Year_Myflimit
39077>>>>>>
39077>>>>>>        // Year.Year_Numgtypkin
39077>>>>>>
39077>>>>>>        // Year.Year_Numgarticl
39077>>>>>>
39077>>>>>>        // Year.Year_Numgmove
39077>>>>>>
39077>>>>>>        // Year.Year_Numgplan
39077>>>>>>
39077>>>>>>        // Year.Year_Numgformat
39077>>>>>>
39077>>>>>>        // Year.Year_Numgthaa
39077>>>>>>
39077>>>>>>        // Year.Year_Numgopen
39077>>>>>>
39077>>>>>>        // Year.Year_Numbtypkin
39077>>>>>>
39077>>>>>>        // Year.Year_Numbaxio
39077>>>>>>
39077>>>>>>        // Year.Year_Numbarticl
39077>>>>>>
39077>>>>>>        // Year.Year_Numbmove
39077>>>>>>
39077>>>>>>        // Year.Year_Delimiter
39077>>>>>>
39077>>>>>>        // Year.Year_Printer
39077>>>>>>
39077>>>>>>        // Year.Year_Valid_Char
39077>>>>>>
39077>>>>>>        // Year.Year_C_Code0
39077>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0 To "dbComboFormSub"
39078>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code0 To (Year_Year_C_Code0_VT1(Self))
39079>>>>>>
39079>>>>>>        // Year.Year_C_Code00
39079>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00 To "dbComboFormSub"
39080>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code00 To (Year_Year_C_Code00_VT1(Self))
39081>>>>>>
39081>>>>>>        // Year.Year_C_Coder
39081>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder To "dbComboFormSub"
39082>>>>>>        Set Field_Value_Table      Field Year.Year_C_Coder To (Year_Year_C_Coder_VT1(Self))
39083>>>>>>
39083>>>>>>        // Year.Beto_Site
39083>>>>>>
39083>>>>>>        // Year.Clients_Plafon
39083>>>>>>
39083>>>>>>        // Year.Payresp_Plafon
39083>>>>>>
39083>>>>>>        // Year.Clients_Ofeilh
39083>>>>>>
39083>>>>>>        // Year.Payresp_Ofeilh
39083>>>>>>
39083>>>>>>        // Year.Working
39083>>>>>>
39083>>>>>>        //DDB-DefineFieldEnd
39083>>>>>>
39083>>>>>>        Set Main_File            To Year.File_Number
39084>>>>>>        Set Cascade_Delete_State To FALSE
39085>>>>>>
39085>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
39086>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
39087>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39088>>>>>>
39088>>>>>>        // Child (Client) file structure................
39088>>>>>>
39088>>>>>>        // Parent (Server) file structure...............
39088>>>>>>        Send Add_Server_File  Branch.File_Number
39089>>>>>>
39089>>>>>>        // Field-based properties.......................
39089>>>>>>
39089>>>>>>        // Year.Company_Code
39089>>>>>>
39089>>>>>>        // Year.Branch_Code
39089>>>>>>
39089>>>>>>        // Year.Year_Year
39089>>>>>>        Set Field_Label_Long       Field Year.Year_Year           To "•¨ã©ž"
39090>>>>>>        Set Field_Label_Short      Field Year.Year_Year           To "•¨ã©ž"
39091>>>>>>        Set Field_Options          Field Year.Year_Year           To DD_REQUIRED
39092>>>>>>        //Set Field_Prompt_Object    Field Year.Year_Year           To (SL053(Self))
39092>>>>>>
39092>>>>>>        // Year.Year_Descr
39092>>>>>>        Set Field_Label_Long       Field Year.Year_Descr          To "œ¨ š¨˜­ã •¨ã©žª"
39093>>>>>>        Set Field_Label_Short      Field Year.Year_Descr          To "œ¨.•¨ã©žª"
39094>>>>>>
39094>>>>>>        // Year.Year_C_Code0
39094>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0        To "dbComboForm"
39095>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code0        To "‰ç¨ ¦ Œæ£ ©£˜"
39096>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code0        To "‰¬¨.Œ¦£ ©£˜"
39097>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code0        To (Year_Year_C_Code0_VT(Self))
39097>>>>>>
39097>>>>>>        // Year.Year_C_Code00
39097>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00       To "dbComboForm"
39098>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
39099>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
39100>>>>>>        //Set Field_Options          Field Year.Year_C_Code00       To DD_REQUIRED
39100>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code00       To (Year_Year_C_Code1_VT(Self))
39100>>>>>>
39100>>>>>>        // Year.Year_C_Coder
39100>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder        To "dbComboForm"
39101>>>>>>        Set Field_Label_Long       Field Year.Year_C_Coder        To "Œæ£ ©£˜ REPORTING"
39102>>>>>>        Set Field_Label_Short      Field Year.Year_C_Coder        To "Œæ£ ©£˜ REP"
39103>>>>>>        //Set Field_Options          Field Year.Year_C_Coder        To DD_REQUIRED
39103>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Coder        To (Year_Year_C_Coder_VT(Self))
39103>>>>>>
39103>>>>>>        // Year.Year_Isolfrom
39103>>>>>>        Set Field_Label_Long       Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
39104>>>>>>        Set Field_Label_Short      Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
39105>>>>>>
39105>>>>>>        // Year.Year_Isolto
39105>>>>>>        Set Field_Label_Long       Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
39106>>>>>>        Set Field_Label_Short      Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
39107>>>>>>
39107>>>>>>        // Year.Year_Openfrom
39107>>>>>>        Set Field_Label_Long       Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
39108>>>>>>        Set Field_Label_Short      Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
39109>>>>>>
39109>>>>>>        // Year.Year_Opento
39109>>>>>>        Set Field_Label_Long       Field Year.Year_Opento         To "„šš¨˜­âª „àª"
39110>>>>>>        Set Field_Label_Short      Field Year.Year_Opento         To "„šš¨˜­âª „àª"
39111>>>>>>
39111>>>>>>        // Year.Year_Entrydate
39111>>>>>>        Set Field_Label_Long       Field Year.Year_Entrydate      To "†£œ¨¦£ž¤å˜ „¨š˜©å˜ª"
39112>>>>>>        Set Field_Label_Short      Field Year.Year_Entrydate      To "†£/¤å˜ „¨š˜©å˜ª"
39113>>>>>>
39113>>>>>>        // Year.Year_Dateaa
39113>>>>>>
39113>>>>>>        // Year.Year_Xrhshfrom
39113>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
39114>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
39115>>>>>>
39115>>>>>>        // Year.Year_Xrhshto
39115>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
39116>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
39117>>>>>>
39117>>>>>>        // Year.Year_Myflimit
39117>>>>>>        Set Field_Label_Long       Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
39118>>>>>>        Set Field_Label_Short      Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
39119>>>>>>
39119>>>>>>        // Year.Year_Numgtypkin
39119>>>>>>        Set Field_Options          Field Year.Year_Numgtypkin     To DD_DISPLAYONLY
39120>>>>>>
39120>>>>>>        // Year.Year_Numgarticl
39120>>>>>>        Set Field_Options          Field Year.Year_Numgarticl     To DD_DISPLAYONLY
39121>>>>>>
39121>>>>>>        // Year.Year_Numgmove
39121>>>>>>        Set Field_Options          Field Year.Year_Numgmove       To DD_DISPLAYONLY
39122>>>>>>
39122>>>>>>        // Year.Year_Numgplan
39122>>>>>>        Set Field_Options          Field Year.Year_Numgplan       To DD_DISPLAYONLY
39123>>>>>>
39123>>>>>>        // Year.Year_Numgformat
39123>>>>>>        Set Field_Options          Field Year.Year_Numgformat     To DD_DISPLAYONLY
39124>>>>>>
39124>>>>>>        // Year.Year_Numgthaa
39124>>>>>>        Set Field_Options          Field Year.Year_Numgthaa       To DD_DISPLAYONLY
39125>>>>>>
39125>>>>>>        // Year.Year_Numgopen
39125>>>>>>        Set Field_Options          Field Year.Year_Numgopen       To DD_DISPLAYONLY
39126>>>>>>
39126>>>>>>        // Year.Year_Numbaxio
39126>>>>>>        Set Field_Options          Field Year.Year_Numbaxio       To DD_DISPLAYONLY
39127>>>>>>
39127>>>>>>        // Year.Year_Numbarticl
39127>>>>>>        Set Field_Options          Field Year.Year_Numbarticl     To DD_DISPLAYONLY
39128>>>>>>
39128>>>>>>        // Year.Year_Numbmove
39128>>>>>>        Set Field_Options          Field Year.Year_Numbmove       To DD_DISPLAYONLY
39129>>>>>>
39129>>>>>>        // Year.Year_Delimiter
39129>>>>>>        Set Status_Help            Field Year.Year_Delimiter      To "ƒ ˜®à¨ ©« ¡æ š ˜ «¦ Š‘ «žª •¨ã©œàª"
39130>>>>>>
39130>>>>>>        // Year.Year_Printer
39130>>>>>>
39130>>>>>>        // Year.Year_Valid_Char
39130>>>>>>
39130>>>>>>    End_Procedure    // Define_Fields
39131>>>>>>
39131>>>>>>    // Field_Defaults:
39131>>>>>>    // This procedure is used to establish default field values.
39131>>>>>>
39131>>>>>>    Procedure Field_Defaults
39132>>>>>>        Forward Send Field_Defaults
39134>>>>>>        //DDB-Generated-Code-Location
39134>>>>>>        //DDB-FieldDefaultStart
39134>>>>>>        //DDB-FieldDefaultEnd
39134>>>>>>        Set Field_Changed_Value   Field Year.Year_Delimiter      To "."
39135>>>>>>        Set Field_Changed_Value   Field Year.Year_Printer        To "LPT1:"
39136>>>>>>        Set Field_Changed_Value   Field Year.Year_Valid_Char     To "1234567890"
39137>>>>>>    End_Procedure    // Field_Defaults
39138>>>>>>
39138>>>>>>End_Class    // Year_DataDictionary
39139>>>>>>//DDB-Selection-pkg-Start
39139>>>>>>
39139>>>>>>Use Sl003.sl         // SL003
INCLUDING FILE: SL003.SL
39139>>>>>>>>//AB/ Project SL003:Year
39139>>>>>>>>//AB/ Object prj is a Lookup_Project
39139>>>>>>>>//AB/     Set ProjectName to "SL003:Year"
39139>>>>>>>>//AB/     Set ProjectFileName to "Sl003.sl"
39139>>>>>>>>
39139>>>>>>>>// Project Object Structure
39139>>>>>>>>//   SL003 is a dbModalPanelSub
39139>>>>>>>>//     Company_DD is a DataDictionary
39139>>>>>>>>//     Branch_DD is a DataDictionary
39139>>>>>>>>//     Year_DD is a DataDictionary
39139>>>>>>>>//     oSelList is a dbListSub
39139>>>>>>>>//     oOK_bn is a ButtonSub
39139>>>>>>>>//     oCancel_bn is a ButtonSub
39139>>>>>>>>//     oSearch_bn is a ButtonSub
39139>>>>>>>>
39139>>>>>>>>// Register all objects
39139>>>>>>>>Register_Object Branch_DD
39139>>>>>>>>Register_Object Company_DD
39139>>>>>>>>Register_Object oCancel_bn
39139>>>>>>>>Register_Object oOK_bn
39139>>>>>>>>Register_Object oSearch_bn
39139>>>>>>>>Register_Object oSelList
39139>>>>>>>>Register_Object SL003
39139>>>>>>>>Register_Object Year_DD
39139>>>>>>>>
39139>>>>>>>>
39139>>>>>>>>//AB-IgnoreStart
39139>>>>>>>>
39139>>>>>>>>Use DFAllEnt.pkg
39139>>>>>>>>Use dbList.Sub
39139>>>>>>>>Use Button.Sub
39139>>>>>>>>
39139>>>>>>>>
39139>>>>>>>>Use COMPANY.DD
39139>>>>>>>>Use BRANCH.DD
39139>>>>>>>>Use YEAR.DD
39139>>>>>>>>
39139>>>>>>>>//AB-IgnoreEnd
39139>>>>>>>>
39139>>>>>>>>CD_Popup_Object SL003 is a dbModalPanelSub
39158>>>>>>>>
39158>>>>>>>>    //AB-StoreTopStart
39158>>>>>>>>    Property String psFragmaCompanyCode  ""
39160>>>>>>>>    Property String psFragmaBranchCode   ""
39162>>>>>>>>    property integer pifragmaactive public 0
39164>>>>>>>>    //AB-StoreTopEnd
39164>>>>>>>>
39164>>>>>>>>    Set Minimize_Icon to FALSE
39165>>>>>>>>    Set Label to "•¨ã©œ ª"
39166>>>>>>>>    Set Size to 149 449
39167>>>>>>>>    Set Location to 4 7
39168>>>>>>>>    Set Exit_Application_Local_State to FALSE
39169>>>>>>>>    Set Modal_State to FALSE
39170>>>>>>>>
39170>>>>>>>>    //AB-DDOStart
39170>>>>>>>>
39170>>>>>>>>    Object Company_DD is a Company_DataDictionary
39172>>>>>>>>    End_Object    // Company_DD
39173>>>>>>>>
39173>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
39175>>>>>>>>        Set DDO_Server to (Company_DD(self))
39176>>>>>>>>    End_Object    // Branch_DD
39177>>>>>>>>
39177>>>>>>>>    Object Year_DD is a Year_DataDictionary
39179>>>>>>>>        Set DDO_Server to (Branch_DD(self))
39180>>>>>>>>
39180>>>>>>>>        //AB-StoreStart
39180>>>>>>>>        Procedure OnConstrain
39182>>>>>>>>             String lsCompanyCode lsBranchCode
39183>>>>>>>>             integer iactive
39183>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
39184>>>>>>>>             get pifragmaactive to iactive
39185>>>>>>>>             If (lsCompanyCode <> "") Begin
39187>>>>>>>>                Get psFragmaBranchCode  to lsBranchCode
39188>>>>>>>>                Constrain Year.Company_Code eq lsCompanyCode
39190>>>>>>>>                If (lsBranchCode <> "") Constrain Year.Branch_code eq lsBranchCode
39194>>>>>>>>             End
39194>>>>>>>>>
39194>>>>>>>>             if (iactive = 0) constrain year.working ne 1
39198>>>>>>>>        End_Procedure // OnConstrain
39199>>>>>>>>        
39199>>>>>>>>        
39199>>>>>>>>        
39199>>>>>>>>        
39199>>>>>>>>        
39199>>>>>>>>        //AB-StoreEnd
39199>>>>>>>>
39199>>>>>>>>    End_Object    // Year_DD
39200>>>>>>>>
39200>>>>>>>>    Set Main_DD to (Year_DD(self))
39201>>>>>>>>    Set Server to (Year_DD(self))
39202>>>>>>>>
39202>>>>>>>>    //AB-DDOEnd
39202>>>>>>>>
39202>>>>>>>>    Object oSelList is a dbListSub
39204>>>>>>>>        Set Main_File to Year.File_Number
39205>>>>>>>>        Set Size to 105 433
39206>>>>>>>>        Set Location to 6 6
39207>>>>>>>>
39207>>>>>>>>        Begin_Row
39210>>>>>>>>            Entry_Item Year.Year_year
39211>>>>>>>>            Entry_Item Company.Company_code
39212>>>>>>>>            Entry_Item Company.Company_name
39213>>>>>>>>            Entry_Item Branch.Branch_code
39214>>>>>>>>            Entry_Item Branch.Branch_name
39215>>>>>>>>        End_Row
39220>>>>>>>>
39220>>>>>>>>        Set Form_Width    item 0 to 36
39221>>>>>>>>        Set Header_Label  item 0 to "•¨ã©ž :          "
39222>>>>>>>>        
39222>>>>>>>>        Set Form_Width    item 1 to 71
39223>>>>>>>>        Set Header_Label  item 1 to "‰à› ¡æª „«˜ ¨å˜ª"
39224>>>>>>>>        
39224>>>>>>>>        Set Form_Width    item 2 to 136
39225>>>>>>>>        Set Header_Label  item 2 to "Ž¤¦£˜ „«˜ ¨å˜ª"
39226>>>>>>>>        
39226>>>>>>>>        Set Form_Width    item 3 to 73
39227>>>>>>>>        Set Header_Label  item 3 to "‰à› ¡æª “§¦¡/«¦ª"
39228>>>>>>>>        
39228>>>>>>>>        Set Form_Width    item 4 to 109
39229>>>>>>>>        Set Header_Label  item 4 to "Ž¤¦£˜ “§¦¡/«¦ª"
39230>>>>>>>>        
39230>>>>>>>>
39230>>>>>>>>        //AB-StoreStart
39230>>>>>>>>                                                
39230>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
39232>>>>>>>>        Property String psStoreFragmaBranchCode   ""
39234>>>>>>>>        
39234>>>>>>>>        Procedure Store_Defaults
39236>>>>>>>>            forward send Store_Defaults
39238>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
39239>>>>>>>>            Set psStoreFragmaBranchCode  to (psFragmaBranchCode(Self))
39240>>>>>>>>        end_Procedure // Store_Defaults
39241>>>>>>>>        
39241>>>>>>>>        Procedure Restore_Defaults
39243>>>>>>>>            forward send Restore_Defaults
39245>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
39246>>>>>>>>            Set psFragmaBranchCode  to (psStoreFragmaBranchCode(self))
39247>>>>>>>>        end_Procedure // Restore_Defaults
39248>>>>>>>>        
39248>>>>>>>>        Procedure Activating
39250>>>>>>>>            Forward Send Activating
39252>>>>>>>>            Send Rebuild_Constraints to (Year_DD(self))
39253>>>>>>>>        End_Procedure // Activating
39254>>>>>>>>        
39254>>>>>>>>        
39254>>>>>>>>        
39254>>>>>>>>        //AB-StoreEnd
39254>>>>>>>>
39254>>>>>>>>    End_Object    // oSelList
39255>>>>>>>>
39255>>>>>>>>    Object oOK_bn is a ButtonSub
39257>>>>>>>>        Set Label to "&„§ ¢¦šã"
39258>>>>>>>>        Set Location to 112 280
39259>>>>>>>>
39259>>>>>>>>        //AB-StoreStart
39259>>>>>>>>        Procedure OnClick
39261>>>>>>>>            Send OK To (oSelList(current_object))
39262>>>>>>>>        End_Procedure
39263>>>>>>>>        //AB-StoreEnd
39263>>>>>>>>
39263>>>>>>>>    End_Object    // oOK_bn
39264>>>>>>>>
39264>>>>>>>>    Object oCancel_bn is a ButtonSub
39266>>>>>>>>        Set Label to "&€¡ç¨à©ž"
39267>>>>>>>>        Set Location to 112 335
39268>>>>>>>>
39268>>>>>>>>        //AB-StoreStart
39268>>>>>>>>        Procedure OnClick
39270>>>>>>>>            Send Cancel To (oSelList(current_object))
39271>>>>>>>>        End_Procedure
39272>>>>>>>>        //AB-StoreEnd
39272>>>>>>>>
39272>>>>>>>>    End_Object    // oCancel_bn
39273>>>>>>>>
39273>>>>>>>>    Object oSearch_bn is a ButtonSub
39275>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
39276>>>>>>>>        Set Location to 112 390
39277>>>>>>>>
39277>>>>>>>>        //AB-StoreStart
39277>>>>>>>>        Procedure OnClick
39279>>>>>>>>            Send Search To (oSelList(current_object))
39280>>>>>>>>        End_Procedure
39281>>>>>>>>        //AB-StoreEnd
39281>>>>>>>>
39281>>>>>>>>    End_Object    // oSearch_bn
39282>>>>>>>>
39282>>>>>>>>
39282>>>>>>>>    //AB-StoreStart
39282>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39283>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39284>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39285>>>>>>>>    
39285>>>>>>>>    
39285>>>>>>>>    
39285>>>>>>>>    //AB-StoreEnd
39285>>>>>>>>
39285>>>>>>>>CD_End_Object    // SL003
39287>>>>>>>>>
39287>>>>>>>>
39287>>>>>>>>//AB/ End_Object    // prj
39287>>>>>>
39287>>>>>>//DDB-Selection-pkg-End
39287>>>>>>//DDB-FileEnd
39287>>>>
39287>>>>    //AB-IgnoreEnd
39287>>>>
39287>>>>    Object oSelectYear is a dbModalPanelSub
39289>>>>
39289>>>>        //AB-StoreTopStart
39289>>>>
39289>>>>        Property String  psSelectedYearRecr  ''
39291>>>>        Property Integer piChangeState False
39293>>>>
39293>>>>        //AB-StoreTopEnd
39293>>>>
39293>>>>        Set Minimize_Icon to FALSE
39294>>>>        Set Label to "„§ ¢¦šã „«˜ ¨œå˜ª - “§¦¡˜«˜©«ã£˜«¦ª - •¨ã©žª"
39295>>>>        Set Size to 111 372
39296>>>>        Set Location to 60 40
39297>>>>        Set Color to 12232306
39298>>>>        Set Popup_State to TRUE
39299>>>>
39299>>>>        //AB-DDOStart
39299>>>>
39299>>>>        Object Company_DD is a Company_DataDictionary
39301>>>>
39301>>>>            //AB-StoreStart
39301>>>>            Set Foreign_Field_Options DD_KEYFIELD                   to DD_Clear_Field_Options DD_FindReq
39302>>>>            Set Foreign_Field_Options DD_INDEXFIELD                 to DD_Clear_Field_Options DD_FindReq
39303>>>>            Set Foreign_Field_Options Field Company.Company_Name    to DD_DisplayOnly
39304>>>>
39304>>>>
39304>>>>
39304>>>>            //AB-StoreEnd
39304>>>>
39304>>>>        End_Object    // Company_DD
39305>>>>
39305>>>>        Object Branch_DD is a Branch_DataDictionary
39307>>>>            Set DDO_Server to (Company_DD(self))
39308>>>>
39308>>>>            //AB-StoreStart
39308>>>>            Set Foreign_Field_Options DD_KEYFIELD   to DD_Clear_Field_Options DD_FindReq
39309>>>>            Set Foreign_Field_Options DD_INDEXFIELD to DD_Clear_Field_Options DD_FindReq
39310>>>>
39310>>>>            Set Foreign_Field_Options DD_KEYFIELD   to DD_AutoFind_GE
39311>>>>            Set Foreign_Field_Options DD_INDEXFIELD to DD_AutoFind_GE
39312>>>>
39312>>>>            Set Foreign_Field_Options Field Branch.Branch_Name to DD_DisplayOnly
39313>>>>            //AB-StoreEnd
39313>>>>
39313>>>>        End_Object    // Branch_DD
39314>>>>
39314>>>>        Object Year_DD is a Year_DataDictionary
39316>>>>            Set DDO_Server to (Branch_DD(self))
39317>>>>
39317>>>>            //AB-StoreStart
39317>>>>
39317>>>>            Set Field_Options Field Year.Year_Descr to DD_DisplayOnly
39318>>>>            Set Field_Options Field Year.Year_Year to DD_AutoFind_GE
39319>>>>
39319>>>>            Function Validate_Delete Returns Integer
39321>>>>                Function_Return 1
39322>>>>            End_Function
39323>>>>
39323>>>>            //AB-StoreEnd
39323>>>>
39323>>>>        End_Object    // Year_DD
39324>>>>
39324>>>>        Set Main_DD to (Year_DD(self))
39325>>>>        Set Server to (Year_DD(self))
39326>>>>
39326>>>>        //AB-DDOEnd
39326>>>>
39326>>>>        Object Company_Company_Code is a dbFormSub
39328>>>>            Entry_Item Company.Company_code
39329>>>>            Set Size to 13 71
39330>>>>            Set Location to 9 112
39331>>>>            Set Label_Col_Offset to 2
39332>>>>            Set Label_Justification_Mode to jMode_Right
39333>>>>            Set Prompt_Button_Mode to pb_PromptOn
39334>>>>            Set Auto_Clear_Deo_State to FALSE
39335>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39336>>>>
39336>>>>            //AB-StoreStart
39336>>>>
39336>>>>            Set Prompt_Object to (sl001(Self))
39337>>>>
39337>>>>
39337>>>>            //AB-StoreEnd
39337>>>>
39337>>>>        End_Object    // Company_Company_Code
39338>>>>
39338>>>>        Object Company_Company_Name is a dbFormSub
39340>>>>            Entry_Item Company.Company_name
39341>>>>            Set Size to 13 168
39342>>>>            Set Location to 9 188
39343>>>>            Set Label_Col_Offset to 2
39344>>>>            Set Label_Justification_Mode to jMode_Right
39345>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39346>>>>
39346>>>>            //AB-StoreStart
39346>>>>
39346>>>>            //AB-StoreEnd
39346>>>>
39346>>>>        End_Object    // Company_Company_Name
39347>>>>
39347>>>>        Object Branch_Branch_Code is a dbFormSub
39349>>>>            Entry_Item Branch.Branch_code
39350>>>>            Set Size to 13 71
39351>>>>            Set Location to 23 112
39352>>>>            Set Label_Col_Offset to 2
39353>>>>            Set Label_Justification_Mode to jMode_Right
39354>>>>            Set Prompt_Button_Mode to pb_PromptOn
39355>>>>            Set Auto_Clear_Deo_State to FALSE
39356>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39357>>>>
39357>>>>            //AB-StoreStart
39357>>>>            Set Prompt_Object to (sl002(Self))
39358>>>>
39358>>>>            Procedure Prompt_CallBack Integer hPrompt
39360>>>>                string lsCompanyCode
39361>>>>                Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
39362>>>>                Set psFragmaCompanyCode of hPrompt to lsCompanyCode
39363>>>>            End_Procedure
39364>>>>
39364>>>>
39364>>>>
39364>>>>
39364>>>>            //AB-StoreEnd
39364>>>>
39364>>>>        End_Object    // Branch_Branch_Code
39365>>>>
39365>>>>        Object Branch_Branch_Name is a dbFormSub
39367>>>>            Entry_Item Branch.Branch_name
39368>>>>            Set Size to 13 168
39369>>>>            Set Location to 23 188
39370>>>>            Set Label_Justification_Mode to jMode_Right
39371>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39372>>>>
39372>>>>            //AB-StoreStart
39372>>>>
39372>>>>
39372>>>>            //AB-StoreEnd
39372>>>>
39372>>>>        End_Object    // Branch_Branch_Name
39373>>>>
39373>>>>        Object Year_Year_Year is a dbFormSub
39375>>>>            Entry_Item Year.Year_year
39376>>>>            Set Size to 13 71
39377>>>>            Set Location to 37 112
39378>>>>            Set Label_Col_Offset to 2
39379>>>>            Set Label_Justification_Mode to jMode_Right
39380>>>>            Set Prompt_Button_Mode to pb_PromptOn
39381>>>>            Set Auto_Clear_Deo_State to FALSE
39382>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39383>>>>
39383>>>>            //AB-StoreStart
39383>>>>            Set Prompt_Object to (sl003(Self))
39384>>>>
39384>>>>            Procedure Prompt_CallBack Integer hPrompt
39386>>>>                String lsCompanyCode lsBranchCode
39387>>>>                integer icheck
39387>>>>                get checked_state of (chkxr(self)) to icheck
39388>>>>                Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
39389>>>>                Get Field_Current_Value of Branch_DD  Field Branch.Branch_Code   to lsBranchCode
39390>>>>                Set psFragmaCompanyCode of hPrompt to lsCompanyCode
39391>>>>                Set psFragmaBranchCode  of hPrompt to lsBranchCode
39392>>>>                set pifragmaactive      of hPrompt to icheck
39393>>>>            End_Procedure
39394>>>>
39394>>>>
39394>>>>
39394>>>>
39394>>>>
39394>>>>
39394>>>>            //AB-StoreEnd
39394>>>>
39394>>>>        End_Object    // Year_Year_Year
39395>>>>
39395>>>>        Object Year_Year_Descr is a dbFormSub
39397>>>>            Entry_Item Year.Year_descr
39398>>>>            Set Size to 13 168
39399>>>>            Set Location to 37 188
39400>>>>            Set Label_Col_Offset to 2
39401>>>>            Set Label_Justification_Mode to jMode_Right
39402>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39403>>>>
39403>>>>            //AB-StoreStart
39403>>>>
39403>>>>            //AB-StoreEnd
39403>>>>
39403>>>>        End_Object    // Year_Year_Descr
39404>>>>
39404>>>>        Object Year_Year_Entrydate is a dbFormSub
39406>>>>            Entry_Item Year.Year_entrydate
39407>>>>            Set Size to 13 71
39408>>>>            Set Location to 52 112
39409>>>>            Set Label_Col_Offset to 2
39410>>>>            Set Label_Justification_Mode to jMode_Right
39411>>>>            Set Auto_Clear_Deo_State to FALSE
39412>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39413>>>>        End_Object    // Year_Year_Entrydate
39414>>>>
39414>>>>        Object oOk_bn is a ButtonSub
39416>>>>            Set Label to "€§¦›¦®ã (F2)"
39417>>>>            Set Size to 17 54
39418>>>>            Set Location to 74 188
39419>>>>            Set Form_FontHeight Item 0 to 14
39420>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39421>>>>
39421>>>>            //AB-StoreStart
39421>>>>
39421>>>>            Procedure OnClick
39423>>>>                Delegate Send AcceptTheValues
39425>>>>            End_Procedure
39426>>>>
39426>>>>
39426>>>>
39426>>>>
39426>>>>            //AB-StoreEnd
39426>>>>
39426>>>>        End_Object    // oOk_bn
39427>>>>
39427>>>>        Object oCancel_bn is a ButtonSub
39429>>>>            Set Label to "„¥¦›¦ª "
39430>>>>            Set Size to 17 54
39431>>>>            Set Location to 74 302
39432>>>>            Set Form_FontHeight Item 0 to 14
39433>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39434>>>>
39434>>>>            //AB-StoreStart
39434>>>>
39434>>>>            Procedure OnClick
39436>>>>               Send Exit_Application to oSelectYear
39437>>>>            End_Procedure
39438>>>>
39438>>>>
39438>>>>
39438>>>>            //AB-StoreEnd
39438>>>>
39438>>>>        End_Object    // oCancel_bn
39439>>>>
39439>>>>        Object otxtCompany is a TextBoxSub
39441>>>>            Set Label to "„«˜ ¨œå˜"
39442>>>>            Set Auto_Size_State to FALSE
39443>>>>            Set Color to 12232306
39444>>>>            Set FontSize to 14 8
39445>>>>            Set Location to 9 10
39446>>>>            Set Size to 10 35
39447>>>>            Set FontWeight to 600
39448>>>>            Set TypeFace to "MS Sans Serif"
39449>>>>            Set Enabled_State to TRUE
39450>>>>        End_Object    // otxtCompany
39451>>>>
39451>>>>        Object otxtBranch is a TextBoxSub
39453>>>>            Set Label to "“§¦¡˜«˜©«ã£˜«˜"
39454>>>>            Set Auto_Size_State to FALSE
39455>>>>            Set Color to 12232306
39456>>>>            Set FontSize to 14 8
39457>>>>            Set Location to 23 10
39458>>>>            Set Size to 10 63
39459>>>>            Set FontWeight to 600
39460>>>>            Set TypeFace to "MS Sans Serif"
39461>>>>            Set Enabled_State to TRUE
39462>>>>        End_Object    // otxtBranch
39463>>>>
39463>>>>        Object otxtYear is a TextBoxSub
39465>>>>            Set Label to "•¨ã©ž :          "
39466>>>>            Set Auto_Size_State to FALSE
39467>>>>            Set Color to 12232306
39468>>>>            Set FontSize to 14 8
39469>>>>            Set Location to 38 10
39470>>>>            Set Size to 10 40
39471>>>>            Set FontWeight to 600
39472>>>>            Set TypeFace to "MS Sans Serif"
39473>>>>            Set Enabled_State to TRUE
39474>>>>        End_Object    // otxtYear
39475>>>>
39475>>>>        Object otxtWorkingDay is a TextBoxSub
39477>>>>            Set Label to "†£/¤å˜ „¨š˜©å˜ª"
39478>>>>            Set Auto_Size_State to FALSE
39479>>>>            Set Color to 12232306
39480>>>>            Set FontSize to 14 8
39481>>>>            Set Location to 52 10
39482>>>>            Set Size to 10 63
39483>>>>            Set FontWeight to 600
39484>>>>            Set TypeFace to "MS Sans Serif"
39485>>>>            Set Enabled_State to TRUE
39486>>>>        End_Object    // otxtWorkingDay
39487>>>>
39487>>>>        Object otxtWorkingDay is a TextBoxSub
39489>>>>            Set Label to "Ž¢œª ¦  ®¨ã©œ ª"
39490>>>>            Set Auto_Size_State to FALSE
39491>>>>            Set Color to 12232306
39492>>>>            Set FontSize to 14 8
39493>>>>            Set Location to 79 9
39494>>>>            Set Size to 10 63
39495>>>>            Set FontWeight to 600
39496>>>>            Set TypeFace to "MS Sans Serif"
39497>>>>            Set Enabled_State to TRUE
39498>>>>        End_Object    // otxtWorkingDay
39499>>>>
39499>>>>        Object chkxr is a CheckBoxSub
39501>>>>            Set Size to 13 22
39502>>>>            Set Location to 79 113
39503>>>>            Set Color to 12232306
39504>>>>        End_Object    // chkxr
39505>>>>
39505>>>>
39505>>>>        //AB-StoreStart
39505>>>>
39505>>>>        On_Key Key_Ctrl+Key_X Send None
39506>>>>        On_Key Key_Alt+Key_X  Send None
39507>>>>
39507>>>>        Function ifSelect_Xrhsh Returns String
39509>>>>            String  lsRecord_id
39510>>>>            Set psSelectedYearRecr to gs_Selected_Year_Recr
39511>>>>            send popup_modal
39512>>>>            Get psSelectedYearRecr to lsRecord_id
39513>>>>            Function_return lsRecord_Id
39514>>>>        End_Function
39515>>>>
39515>>>>        Procedure AcceptTheValues
39517>>>>            Integer iRetVal liYearDD liCompanyDD liBranchDD
39518>>>>            String ldcheck lsYearRecr lsSite sCname sBname sYname sNom1 sNom2 sNom3
39518>>>>            Date ldYearXrhsh_From ldYearXrhsh_To
39518>>>>            Move Year_DD to liYearDD
39519>>>>            Get Field_Current_Value of liYearDD Field Year.Year_EntryDate to ldcheck
39520>>>>            if (ldcheck = "") ;                Get Message_Box "ƒœ¤ œ§ ¢â¥˜«œ ©à©«ã ž£œ¨¦£ž¤å˜." "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
39523>>>>            else begin
39524>>>>                Get Field_Current_Value of liYearDD Field Year.Year_XrhshFrom   to ldYearXrhsh_From
39525>>>>                Get Field_Current_Value of liYearDD Field Year.Year_XrhshTo     to ldYearXrhsh_To
39526>>>>                if ((ldcheck < ldYearXrhsh_From) or (ldcheck > ldYearXrhsh_To)) ;                    Get Message_Box "†£œ¨/¤å˜ œ¡«éª ¦¨åà¤" "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
39529>>>>                else begin
39530>>>>                    Move Company_DD to liCompanyDD
39531>>>>                    Move Branch_DD  to liBranchDD
39532>>>>                    Move Year_DD    to liYearDD
39533>>>>                    send Request_Save to liYearDD
39534>>>>                    Get Field_Current_Value of liCompanyDD Field Company.Company_Code to gs_Selected_Company_Code
39535>>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_Code   to gs_Selected_Branch_Code
39536>>>>
39536>>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Beto_Site   to gs_Selected_Beto_Site
39537>>>>
39537>>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_Site   to lsSite
39538>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_Year       to gi_Selected_Year
39539>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_Recr       to lsYearRecr
39540>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_C_Code0    to sNom1
39541>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_C_Code00   to sNom2
39542>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_C_CodeR    to sNom3
39543>>>>
39543>>>>                    Get Field_Current_Value of liCompanyDD Field Company.Company_Name to sCname
39544>>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_name   to sBname
39545>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_Descr      to sYname
39546>>>>
39546>>>>
39546>>>>                    Local String    sCode
39546>>>>                    Local Integer   iBreak
39546>>>>                    Move 0 to iBreak
39547>>>>                    Clear Nomisma
39548>>>>                    Find Gt Nomisma.Recnum
39549>>>>>
39549>>>>                    While ((Found=1) And (iBreak=0))
39553>>>>                        If (Nomisma.Einai_Euro='1') Begin
39555>>>>                            Move 1 to iBreak
39556>>>>                            Move Nomisma.Nomisma_Code to sCode
39557>>>>                        End
39557>>>>>
39557>>>>                        If (Not(iBreak)) Find Gt Nomisma.Recnum
39560>>>>                    Loop
39561>>>>>
39561>>>>                    Move (Trim(sCode)) to sCode
39562>>>>
39562>>>>
39562>>>>                    Reread SysCurXR
39566>>>>                    Move gs_Selected_Company_Code   to SysCurXR.Company_Code
39567>>>>                    Move gs_Selected_beto_site      to SysCurXR.beto_site
39568>>>>                    Move gs_Selected_Branch_Code    to SysCurXR.Branch_Code
39569>>>>                    Move gi_Selected_Year           to SysCurXR.Year_Year
39570>>>>                    Move lsYearRecr                 to SysCurXR.Year_Recr
39571>>>>                    Move lsSite                     to SysCurXR.Branch_Site
39572>>>>
39572>>>>                    Move sCname                     to SysCurXR.Company_Name
39573>>>>                    Move sBname                     to SysCurXR.Branch_Name
39574>>>>                    Move sYname                     to SysCurXR.Year_Descr
39575>>>>
39575>>>>                    Move ldYearXrhsh_From           to SysCurXr.Year_XrhshFrom
39576>>>>                    Move ldYearXrhsh_To             to SysCurXr.Year_XrhshTo
39577>>>>
39577>>>>                    Move  (Trim(sNom1))             to SysCurXR.C_Code0
39578>>>>                    Move  (Trim(sNom2))             to SysCurXR.C_Code00
39579>>>>                    Move  (Trim(sNom3))             to SysCurXR.C_CodeR
39580>>>>
39580>>>>                    Move sCode                      to SysCurXR.Euro_Code
39581>>>>
39581>>>>                    Saverecord SysCurXR
39582>>>>                    Unlock
39583>>>>>
39583>>>>
39583>>>>                    Move lsYearRecr                 to gs_Selected_Year_Recr
39584>>>>                    Set psSelectedYearRecr          to lsYearRecr
39585>>>>
39585>>>>                    Send Stop_Modal_ui
39586>>>>
39586>>>>                    Set kEnter_Next_State of ghoWorkSpace to TRUE
39587>>>>                End
39587>>>>>
39587>>>>            end
39587>>>>>
39587>>>>        End_Procedure
39588>>>>
39588>>>>        Set Locate_Mode to Center_On_Screen
39589>>>>
39589>>>>        On_Key KCancel      Send KeyAction to (oCancel_Bn(Self))
39590>>>>        On_Key KClose_Panel Send KeyAction to (oCancel_Bn(Self))
39591>>>>        On_Key Ksave_record send KeyAction to (oOK_Bn(Self))
39592>>>>
39592>>>>        On_Key Key_alt+Key_A send KeyAction to (oOK_Bn(Self))
39593>>>>        On_Key Key_alt+Key_Q send KeyAction to (oCancel_Bn(Self))
39594>>>>
39594>>>>
39594>>>>
39594>>>>
39594>>>>
39594>>>>
39594>>>>
39594>>>>        //AB-StoreEnd
39594>>>>
39594>>>>    End_Object    // oSelectYear
39595>>>>
39595>>>>
39595>>>>    //AB-StoreStart
39595>>>>
39595>>>>
39595>>>>    //AB-StoreEnd
39595>>>>
39595>>>>//AB/     End_Object    // prj
39595>>
39595>>Procedure Epelexe_Xrhsh
39596>>    Integer liCompanyDD liBranchDD liYearDD liYear liModalId
39597>>    String lsCompany lsBranch lsWhatXrhsh
39597>>    Move oSelectYear to liModalId
39598>>    Get ifSelect_Xrhsh Of liModalId to lsWhatXrhsh
39599>>    if (Trim(lsWhatXrhsh)='') Send Exit_Application
39602>>End_Procedure
39603>>
39603>>Procedure Allaxe_Xrhsh
39604>>    Integer rVal liModalId iID
39605>>    If (Close_All_Views(Self,True)=0) Begin
39607>>        Move oSelectYear to liModalId
39608>>        Send Epelexe_Xrhsh
39609>>    End
39609>>>
39609>>End_Procedure
39610>>
39610>>On_Key Key_Ctrl+Key_X Send Allaxe_Xrhsh
39611>>On_Key Key_Alt+Key_X  Send Allaxe_Xrhsh
39612>>
39612>>Send Epelexe_Xrhsh
39613>>//------------------------------
39613>>
39613>
39613>//AB-StoreTopEnd
39613>
39613>
39613>Object Main is a Panelsub
39615>    Set Label To "test2"
39616>    Use jsMenu00.mn //  Menu package.
INCLUDING FILE: JSMENU00.MN
39616>>>
39616>>>DFCreate_Menu Main_Menu                            
39619>>>
39619>>>    Property String psMenuModule Public ''
39621>>>
39621>>>    DFCreate_Menu "Programmata Module 01 Polhseis" View1_PopupMenu IS A ViewPopupMenu
39625>>>        On_Item 'amaxia'    Send Activate_r54_1
39626>>>//        On_Item 'Execute SQL Script'    Send Activate_ExecScript
39626>>>//        On_Item 'tmpSAP'    Send Activate_vwSap
39626>>>//        On_Item 'SAP'    Send Activate_vSap
39626>>>//        On_Item '‹œ«˜­¦¨á “§¦¢¦å§à¤'   Send Activate_rmetafyp
39626>>>//        On_Item 'WorkSpc'   Send Activate_WorkSpc
39626>>>//        On_Item 'MYF' Send Activate_vwMyf
39626>>>//        On_Item 'SAP' Send Activate_Sap1        
39626>>>//          On_Item 'tropoi' Send Activate_rtropoi  
39626>>>//        On_Item '€¤˜§¨¦©˜¨£¦šã' Send Activate_v193c
39626>>>//        On_Item '‘¬©®œ«å©œ ª' Send Activate_r100_e
39626>>>        On_Item 'Stoixeia Emporias ' Send Activate_StoixEmp2
39627>>>//        On_Item '„¤ž£â¨à©ž SAP š ˜ œ¢á«œª ˜¤˜›¨¦£ ¡á' Send Activate_enhclients
39627>>>          On_Item '¡˜¨«œ¢œª ' Send Activate_r6_1hm  
39628>>>//          On_Item 'metaf' Send Activate_rmetafth  
39628>>>//          On_Item '„¤ž¢ ¡åà©ž sls' Send Activate_r6_52
39628>>>//        On_Item 'Enh Sls ID'        Send Activate_EnhSlsID
39628>>>//        On_Item "vwKartel"          Send Activate_vwKartel  
39628>>>//        On_Item "Parastatika"       Send Activate_Ptyppar
39628>>>//        On_Item "Ctypkin"           Send Activate_vwCytpkin
39628>>>//        On_Item "Cflagkin"          Send Activate_Cflagkin
39628>>>//        On_Item "tOpenItems"          Send Activate_tOpItem
39628>>>//        On_Item "tOpItDEL"            Send Activate_tOpItDel
39628>>>//        On_Item '€¥ æš¨˜­˜' Send Activate_v037
39628>>>//        On_Item 'Metafora Ypoloipon' Send Activate_RmetafYp        
39628>>>//        On_Item 'FixTxt' Send Activate_FixTxt
39628>>>//        On_Item "Enhmerosh Cmoves apo Bmove Recr" Send Activate_Enhcmbm
39628>>>//        On_Item "„«˜ ¨åœª-“§¦¡˜«˜©«ã£˜«˜" Send Activate_v3
39628>>>//        On_Item "LockTest"                Send Activate_LockTest
39628>>>//        On_Item "V192"                Send Activate_v192
39628>>>//        On_Item "V14a"                Send Activate_v14a
39628>>>//        On_Item "Ektyp Axiog"         Send Activate_r36a
39628>>>//        On_Item "V192"                Send Activate_V192
39628>>>//        On_Item "FTP"                 Send Activate_FtpView
39628>>>//        On_Item "Read Ascii"          Send Activate_Taxio
39628>>>//        On_Item "PRN Delt. Parag"     Send Activate_rvDorder
39628>>>//        On_Item "Particle"            Send Activate_Particle
39628>>>//        On_Item "anapros"         Send Activate_v193c
39628>>>//        On_Item "mazikos"     Send Activate_v014
39628>>>//        On_Item 'Deop' Send Activate_v193
39628>>>//        On_Item "Xrhsh"               Send Activate_V3
39628>>>//        On_Item "V041"                Send Activate_v041
39628>>>//        On_Item "rvApotEr"                Send Activate_rvApotEr
39628>>>//        On_Item "v21"                   Send Activate_V21
39628>>>//        On_Item "Clients"             Send Activate_vwClients
39628>>>//        On_Item "Cmoves"              Send Activate_vwCmoves
39628>>>//        On_Item "Codemast"            Send Activate_Types_Maint
39628>>>//        On_Item "Export"              Send Activate_vwExport
39628>>>
39628>>>//        On_Item "§˜¨˜¢˜™œª"     Send Activate_r100_34
39628>>>//        On_Item "HPAL"                  Send Activate_Hpal
39628>>>//        On_Item "Open Items"          Send Activate_Copen
39628>>>//        On_Item "Karteles"            Send Activate_vwkartel
39628>>>//        On_Item "r100_3"              Send Activate_r100_3
39628>>>//        On_Item "Gefyres Titana"      Send Activate_tAxio
39628>>>//        On_Item "Step 1"              Send Activate_v192
39628>>>//        On_Item "Step 2"              Send Activate_v014
39628>>>        
39628>>>//        On_Item "rMhtrAxio"           Send Activate_RMHTRAXIO
39628>>>//          On_Item "Batch Enhm"        Send Activate_tOpItem
39628>>>//          On_Item "Batch Diag"        Send Activate_tOpItDel
39628>>>
39628>>>//        On_Item "Enhlikiosh Pelaton"                Send Activate_r6_5
39628>>>
39628>>>
39628>>>        Procedure OnInitMenu
39630>>>            Forward Send OnInitMenu
39632>>>            Set psMenuModule to '01'
39633>>>            Move '01' to gs_Module_Code
39634>>>        End_Procedure
39635>>>
39635>>>    End_Pull_Down // &View
39637>>>
39637>>>//    DFCreate_Menu "Programmata module 02 Agores" View2_PopupMenu IS A ViewPopupMenu
39637>>>//        On_Item "Particle"      Send Activate_Particle
39637>>>//        On_Item "Parastatika"   Send Activate_Ptyppar
39637>>>//        On_Item "Ctypkin"       Send Activate_vwCytpkin
39637>>>//        On_Item "Cflagkin"       Send Activate_Cflagkin
39637>>>//        On_Item "Hmgio"                Send Activate_Hmgio
39637>>>//        Procedure OnInitMenu
39637>>>//            Forward Send OnInitMenu
39637>>>//            Set psMenuModule to '02'
39637>>>//        End_Procedure
39637>>>//    End_Pull_Down // &View
39637>>>
39637>>>    DFCreate_Menu "Programmata module 03 Apothiki" ApothView3_PopupMenu IS A ViewPopupMenu
39641>>>//        On_Item "Kinapoth"           Send Activate_v182s
39641>>>//        On_Item "Hmgio"                Send Activate_Hmgio
39641>>>//        On_Item "aXIOeXOFL"           Send Activate_aXIOeXOFL
39641>>>//        On_Item "rv037c"                Send Activate_rv037c
39641>>>//        On_Item 'Metafora Ypoloipon' Send Activate_r17_1        
39641>>>//        On_Item 'v182s' Send Activate_v182s
39641>>>        
39641>>>        Procedure OnInitMenu
39643>>>          Forward Send OnInitMenu
39645>>>          Set psMenuModule to '03'
39646>>>            Move '03' to gs_Module_Code
39647>>>        End_Procedure
39648>>>
39648>>>    End_Pull_Down // &View
39650>>>
39650>>>
39650>>>    DFCreate_Menu "ƒ ˜®œå¨ ©ž €¥ ¦š¨á­à¤" Axiografa_Main_PopupMenu IS A ViewPopupMenu   
39654>>>    
39654>>>//        On_Item " ¤á¡ ¦"   Send Activate_r36k
39654>>>//        On_Item "Barticl"   Send Activate_V036
39654>>>//        On_Item "Btypkin"   Send Activate_V031
39654>>>//        On_Item "Baxiokat"   Send Activate_V034
39654>>>
39654>>>        Procedure OnInitMenu
39656>>>            Forward Send OnInitMenu
39658>>>            Set psMenuModule to '04'
39659>>>            Move '04' to gs_Module_Code
39660>>>        End_Procedure
39661>>>
39661>>>    End_Pull_Down // &View
39663>>>
39663>>>End_Menu // Main_Menu
39665>>>
39665>>>Register_Object Client_Area
39665>    
39665>    Use Ewbtnbar.pkg //  Tool-Bar object.
INCLUDING FILE: EWBTNBAR.PKG
39665>>>// 23/07/1998 SPY
39665>>>
39665>>>Use DFMainBt  // dfMain_ButtonBar
INCLUDING FILE: DFMAINBT.PKG
39665>>>>>//-------------------------------------------------------------------------
39665>>>>>// DFMainBt.pkg - DfMain_ButtonBar class
39665>>>>>//
39665>>>>>//
39665>>>>>// 07/23/96 JJT - New Class names
39665>>>>>//-------------------------------------------------------------------------
39665>>>>>
39665>>>>>Use DfPanel // dfapp_buttonbar
39665>>>>>
39665>>>>>Class ToolBar is a AppToolBar
39666>>>>>
39666>>>>>    Function Is_Function Integer MsgId Integer ObjId Integer DelegateFg Returns Integer
39667>>>>>      Local integer rval MainObj#
39668>>>>>      Get Main_Panel_id to MainObj#
39669>>>>>      If (ObjId>Desktop AND MainObj#) ;         Get Is_Function of MainObj# MsgId ObjId DelegateFg to rVal
39672>>>>>      Function_Return rVal
39673>>>>>    End_Function
39674>>>>>
39674>>>>>    Procedure Redirect_Button_Message integer Itm
39675>>>>>         Local integer Msg# Aux# rval Understood
39676>>>>>         If (Shadow_State(Current_Object,itm)) Procedure_Return
39679>>>>>         Get Message   item itm  to Msg#
39680>>>>>         Get Aux_Value item itm  to Aux#
39681>>>>>         If Msg# Begin
39683>>>>>           If Aux# eq 0 Begin
39685>>>>>              Get Focus to Aux#
39686>>>>>              Get Is_Function Get_DEO_Object Aux# TRUE to Understood
39687>>>>>              If Not Understood Move 0 to Aux#
39690>>>>>           End
39690>>>>>>
39690>>>>>           If Aux# Get Msg# of Aux# to rval
39693>>>>>           Procedure_return rval
39694>>>>>         end
39694>>>>>>
39694>>>>>    End_Procedure // Redirect_Message
39695>>>>>
39695>>>>>End_Class
39696>>>>>
39696>>>>>
39696>>>Use Dates.utl
39696>>>
39696>>>Register_Object CalendarEz
39696>>>Register_Procedure Activate_Sort_Vw
39696>>>Register_Procedure DoPrintScreen
39696>>>
39696>>>Procedure doPopupCalendar
39698>>>    Send request_popup to (Popup_calendar(Self))
39699>>>End_Procedure
39700>>>
39700>>>Procedure doRebuild
39702>>>    Send Activate_Sort_Vw To (Client_Area(Main(Self)))
39703>>>End_Procedure
39704>>>
39704>>>Procedure doExit_Application
39706>>>    send Exit_Application to desktop
39707>>>End_Procedure
39708>>>
39708>>>Procedure DoRefresh_Grids
39710>>>    Integer liObj
39711>>>    
39711>>>    Move (Focus(Desktop)) to liObj
39712>>>    If (Base_class(liObj) = list_class) Send beginning_of_data to liObj
39715>>>End_Procedure
39716>>>
39716>>>Procedure DoPopupCalc
39718>>>    Runprogram background "Calc.exe"
39719>>>End_Procedure
39720>>>
39720>>>Procedure DoPopupSetup
39722>>>    string sRunPath
39723>>>    get_profile_string "workspaces\ad" "dfparamspath" to sRunPath
39726>>>    append sRunPath "\dfparams"
39727>>>    send DoRunApplication sRunPath
39728>>>End_Procedure
39729>>>
39729>>>Object oMyWinPrint is an DF_PRINTER
39731>>>    Procedure DFPrint
39733>>>        Integer iRetVal
39734>>>        Get DFGetPrintDialogFlags To iRetVal
39735>>>        If iRetVal Begin
39737>>>            Send DFPrintDoc
39738>>>            Send DFClearDoc
39739>>>        End
39739>>>>
39739>>>    End_Procedure
39740>>>    Move Current_Object to WinPrintId
39741>>>End_Object
39742>>>
39742>>>
39742>>>Procedure DoPrint
39744>>>    Send DfPrint to (oMyWinPrint(Self))
39745>>>End_Procedure
39746>>>
39746>>>Procedure DoShowPropertiesPage
39748>>>   If (Close_All_Views(Self,True)=0) Send Activate_View to (piPropertiesObjectId(self))
39751>>>End_Procedure
39752>>>
39752>>>   //  Button bar object.
39752>>>//
39752>>>Object Tool_Bar is a ToolBar     
39754>>>    
39754>>>    Property Integer piOutputDestination Public 0
39756>>>
39756>>>    Send ImageList_Add 'bgn.bmp'      // 0
39757>>>    Send ImageList_Add 'end.bmp'      // 1
39758>>>    Send ImageList_Add 'next.bmp'     // 2
39759>>>    Send ImageList_Add 'prev.bmp'     // 3
39760>>>    Send ImageList_Add 'clr.bmp'      // 4
39761>>>    Send ImageList_Add 'clra.bmp'     // 5
39762>>>    Send ImageList_Add 'calend.bmp'   // 6
39763>>>    Send ImageList_Add 'Abfile.bmp'   // 7
39764>>>    Send ImageList_Add 'Dbexplor.bmp' // 8
39765>>>    Send ImageList_Add 'Ddb_find.bmp' // 9
39766>>>    Send ImageList_Add 'Abup.bmp'     // 10
39767>>>    Send ImageList_Add 'Arrow2.bmp'   // 11
39768>>>    Send ImageList_Add 'Save1.bmp'    // 12
39769>>>    Send ImageList_Add 'Exitm.bmp'    // 13
39770>>>    Send ImageList_Add 'include.bmp'  // 14
39771>>>    Send ImageList_Add 'Zoom_m1.bmp'  // 15
39772>>>    Send ImageList_Add 'Zoom2mg.bmp'  // 16
39773>>>    Send ImageList_Add 'DbeRefrh.Bmp' // 17
39774>>>    Send ImageList_Add 'calc1.bmp'    // 18
39775>>>    Send ImageList_Add 'print_m0.bmp' // 19
39776>>>    Send ImageList_Add 'Abcodeed.bmp' // 20
39777>>>    Send ImageList_Add 'vuur.bmp'     // 21
39778>>>    //Send ImageList_Add 'wmsui329.bmp' // 22
39778>>>
39778>>>    send Add_button (ico_user+0) msg_beginning_of_data
39779>>>    Send Add_ToolTip "€¨®ã €¨®œå¦¬ (Ctrl+Home)"
39780>>>    Set  Status_Help To '¨å©¡œ  «ž¤ ¨é«ž „šš¨˜­ã (Ctrl+Home)'
39781>>>
39781>>>    send Add_button (ico_user+3) msg_find_previous
39782>>>    Send Add_ToolTip "¨¦žš¦ç£œ¤ž „šš¨˜­ã (F7)"
39783>>>    Set  Status_Help To '¨å©¡œ  «ž¤ ¨¦žš¦ç£œ¤ž „šš¨˜­ã (F7)'
39784>>>
39784>>>    send Add_button (ico_user+10) msg_find_GE
39785>>>    Send Add_ToolTip "€¤˜ã«ž©ž (F9)"
39786>>>    Set  Status_Help To '¨å©¡œ  «ž¤ „šš¨˜­ã á©œ  «à¤ ‘«¦ ®œåà¤ (F9)'
39787>>>
39787>>>    send Add_button (ico_user+2) msg_find_next
39788>>>    Send Add_ToolTip "„§æ£œ¤ž „šš¨˜­ã (F8)"
39789>>>    Set  Status_Help To '¨å©¡œ  «ž¤ „§æ£œ¤ž „šš¨˜­ã (F8)'
39790>>>
39790>>>    send Add_button (ico_user+1) msg_end_of_data
39791>>>    Send Add_ToolTip "’â¢¦ª €¨®œå¦¬ (Ctrl+End)"
39792>>>    Set  Status_Help To '¨å©¡œ  «ž¤ ’œ¢œ¬«˜å˜ „šš¨˜­ã (Ctrl+End)'
39793>>>
39793>>>    send Add_space
39794>>>
39794>>>    send Add_button ico_std_find msg_prompt
39795>>>    Send Add_ToolTip "Šå©«˜ (F4)"
39796>>>    Set  Status_Help To '‹§¦¨œåª ¤˜ ›œåª æ¢œª « ª › ˜Ÿâ© £œª œ§ ¢¦šâª (F4)'
39797>>>
39797>>>    send Add_button (ico_User+15) msg_zoom
39798>>>    Send Add_ToolTip "Z¦¦£ (Alt+F9)"
39799>>>    Set  Status_Help To '‹§¦¨œåª ¤˜ ›œåª §¨æ©Ÿœ«œª §¢ž¨¦­¦¨åœª (Alt+F9)'
39800>>>
39800>>>    send Add_button (ico_user+6) msg_doPopupCalendar
39801>>>    Send Add_ToolTip "†£œ¨¦¢æš ¦"
39802>>>    Set  Status_Help To "†£œ¨¦¢æš ¦ ƒ ˜Ÿâ© £¦ £æ¤¦ ©œ §œ›å˜-†£œ¨¦£ž¤åœª"
39803>>>
39803>>>    send Add_space
39804>>>
39804>>>    send Add_button (ico_user+4) msg_request_clear
39805>>>    Send Add_ToolTip "€¡ç¨à©ž (F5)"
39806>>>    Set  Status_Help To '€¡ç¨à©ž «¨â®¦¬©˜ª œšš¨˜­ãª / ¨æ©Ÿœ©ž ¤â˜ª œšš¨˜­ãª (F5)'
39807>>>
39807>>>    send Add_button (ico_user+5) msg_request_clear_all
39808>>>    Send Add_ToolTip "Ž¢ ¡ã €¡ç¨à©ž (Ctrl+F5)"
39809>>>    Set  Status_Help To 'Ž¢ ¡ã ˜¡ç¨à©ž «à¤ ›œ›¦£â¤à¤ ©«ž¤ æ¯ž §¦¬ › ˜®œ ¨åœ«˜  ¦ ®¨ã©«žª (Ctrl+F5)'
39810>>>
39810>>>    send Add_button (ico_user+17) msg_DoRefresh_Grids
39811>>>    Send Add_ToolTip "€¤˜¤âà©ž ƒœ›¦£â¤à¤ (Ctrl+Home)"
39812>>>    Set  Status_Help To '€¤˜¤œé¤œ  «˜ ›œ›¦£â¤˜ ©«˜ Grids (Ctrl+Home)'
39813>>>
39813>>>    send Add_space
39814>>>
39814>>>    send Add_button ico_std_filesave msg_request_save
39815>>>    Send Add_ToolTip "„šš¨˜­ã+€¡ç¨à©ž (F2)"
39816>>>    Set  Status_Help To '‘éœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã ©«¦ ˜¨®œå¦ (F2)'
39817>>>
39817>>>    send Add_button ico_std_delete msg_request_delete
39818>>>    Send Add_ToolTip "ƒ ˜š¨˜­ã (Shift+F2)"
39819>>>    Set  Status_Help To 'ƒ ˜š¨á­œ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã ˜§æ «¦ ˜¨®œå¦ (Shift+F2)'
39820>>>
39820>>>    send Add_button (ico_user+12) msg_request_save_no_clear
39821>>>    Send Add_ToolTip "„šš¨˜­ã (F12)"
39822>>>    Set  Status_Help To '‘éœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã ©«¦ ˜¨®œå¦ ®à¨åª ¤˜ ¡˜Ÿ˜¨åœ  «˜ ›œ›¦£â¤˜ (F12)'
39823>>>
39823>>>    send Add_space
39824>>>
39824>>>    send Add_button ico_std_cut msg_cut
39825>>>    Send Add_ToolTip "€§¦¡¦§ã"
39826>>>    Set  Status_Help To "€§¦¡æ§«œ  «¦ œ§ ¢œš£â¤¦ ¡¦££á«  ¡˜  «¦ ¡¨˜«áœ  ©«¦ Clipboard"
39827>>>
39827>>>    send Add_button ico_std_copy msg_copy
39828>>>    Send Add_ToolTip "€¤« š¨˜­ã"
39829>>>    Set  Status_Help To "€¤« š¨á­œ  «¦ œ§ ¢œš£â¤¦ ¡¦££á«  ¡˜  «¦ ¡¨˜«áœ  ©«¦ Clipboard"
39830>>>
39830>>>    send Add_button ico_std_paste msg_paste
39831>>>    Send Add_ToolTip "„ ©˜šàšã"
39832>>>    Set  Status_Help To "„ ©ášœ  §œ¨ œ®æ£œ¤˜ ˜§æ «¦ Clipboard"
39833>>>
39833>>>    //send Add_button (ico_user+19) msg_DoPrint
39833>>>    send Add_button ICO_STD_PRINT msg_DoPrint
39834>>>    Send Add_ToolTip "„¡«ç§à©ž"
39835>>>    Set  Status_Help To "„¡«¬§é©œ ª ‰œ £â¤à¤"
39836>>>
39836>>>    send Add_space              
39837>>>
39837>>>    //send Add_button (ico_user+20) msg_DoPrintScreen
39837>>>    send Add_button ICO_STD_PRINTPRE msg_DoPrintScreen
39838>>>    Send Add_ToolTip "„¡«ç§à©ž ¦Ÿæ¤žª"
39839>>>    Set  Status_Help To "„¡«ç§à©ž ¦Ÿæ¤žª ©«¦ Clipboard ã ©«¦¤ „¡«à§à«ã"
39840>>>    
39840>>>    Object oOutputSelector Is A ComboFormSub
39842>>>       Set Entry_State Item 0 to FALSE
39843>>>       Set Combo_Sort_State to FALSE
39844>>>       Set GuiLocation to 1 480
39845>>>       Set Size to 14 55
39846>>>       Set Status_Help to "„§â¢œ¥œ §¦¬ Ÿ˜ šå¤œ  ž œ¡«ç§à©ž «žª ¦Ÿæ¤žª"
39847>>>       Set Focus_Mode to Pointer_Only
39848>>>       Set Skip_State to True
39849>>>       
39849>>>       Procedure Combo_Fill_List
39851>>>       
39851>>>           Send Combo_Add_Item '„¡«¬§à«ãª'
39852>>>           Send Combo_Add_Item 'Clipboard'
39853>>>       
39853>>>       End_Procedure
39854>>>       
39854>>>       Procedure OnChange
39856>>>           String liValue
39857>>>           
39857>>>           Get Value Item 0 to liValue 
39858>>>           If (Combo_Value(Self,0) = liValue) Set piOutputDestination to 0
39861>>>           Else If (Combo_Value(Self,1) = liValue) Set piOutputDestination to 1
39865>>>       End_Procedure
39866>>>       
39866>>>    End_Object   // oReportSelector
39867>>>    
39867>>>    For WindowIndex from 1 to 12
39873>>>>
39873>>>        send Add_space              
39874>>>    Loop
39875>>>>
39875>>>
39875>>>    send Add_button (ico_user+7) msg_DoRebuild
39876>>>    Send Add_ToolTip "„§ › æ¨Ÿà©ž á©žª ƒœ›¦£â¤à¤"
39877>>>    Set  Status_Help To "€¤˜¡˜«˜©¡œ¬ã «à¤ ˆndexes (Reindex) ¡˜  ¡˜Ÿ˜¨ ©£æª «¦¬ª (CleanUp) ˜¤ ®¨œ áœ«˜ "
39878>>>
39878>>>    send Add_button (ico_user+18) msg_DoPopupCalc
39879>>>    Send Add_ToolTip "€¨ Ÿ£¦£ž®˜¤ã"
39880>>>    Set  Status_Help To ""
39881>>>
39881>>>    send Add_button (ico_user+21) msg_DoPopupSetup
39882>>>    Send Add_ToolTip "Setup Client"
39883>>>    Set  Status_Help To "Machine Settings Network Parameter"
39884>>>
39884>>>    send Add_space
39885>>>
39885>>>    send Add_button ico_std_properties msg_DoShowPropertiesPage
39886>>>    Send Add_ToolTip "ˆ› æ«ž«œª"
39887>>>    Set  Status_Help To "ˆ› æ«ž«œª ¡˜  ®˜¨˜¡«ž¨ ©« ¡á «žª œ­˜¨£¦šãª"
39888>>>
39888>>>    send Add_button ico_std_help msg_Help_On_Topic
39889>>>    Send Add_ToolTip "¦ãŸœ ˜ (F1)"
39890>>>    Set  Status_Help To "‰¢ã©ž ©¬©«ã£˜«¦ª ™¦žŸœå˜ª (F1)"
39891>>>
39891>>>    send Add_space
39892>>>
39892>>>    send Add_button (ico_user+13) msg_Exit_Application
39893>>>    Send Add_ToolTip "„¥¦›¦ª (Alt+F4)"
39894>>>    Set  Status_Help To "„¥¦›¦ ˜§æ „­˜¨£¦šã (Alt+F4)"
39895>>>
39895>>>    Procedure DoPrintScreen
39897>>>        Integer iVoid aiWhereTo
39898>>>        
39898>>>        Get piOutputDestination to aiWhereTo
39899>>>        If (aiWhereTo = 0) Send Print_Screen to Desktop ""
39902>>>        Else If (aiWhereTo = 1) Move (Keybd_Event(VK_SNAPSHOT, 0, 0, 0)) To iVoid
39906>>>    End_Procedure
39907>>>
39907>>>
39907>>>    Procedure Redirect_Button_Message integer Itm
39909>>>        Integer msg# liObj liCls
39910>>>        
39910>>>        Get Message   item itm  to Msg#
39911>>>        If (Msg_DoRebuild = Msg#)  Send DoRebuild
39914>>>        Else If (msg_Help_On_Topic = Msg#) Send Help_On_Topic
39918>>>        Else If (msg_Exit_Application = Msg#) Send Exit_Application
39922>>>        Else If (msg_DoPopupCalc = Msg#) Send DoPopupCalc
39926>>>        Else If (msg_DoPrintScreen = Msg#) Send DoPrintScreen
39930>>>        Else If (msg_DoShowPropertiesPage = Msg#) Send DoShowPropertiesPage
39934>>>        Else If (msg_DoPopupSetup = Msg#) Send DoPopupSetup
39938>>>        Else Forward Send Redirect_Button_Message Itm
39941>>>    End_Procedure // Redirect_Message
39942>>>
39942>>>    Procedure DoChangeToolBarIcon Integer iItem Integer iImageIndex
39944>>>        Integer hoClient
39945>>>        
39945>>>        Delegate Get Client_Id To hoClient
39947>>>        Delegate Set Client_Id To 0
39949>>>        //----Changes the Icon
39949>>>        //Set Toolbar_State To False
39949>>>        //Set Form_Image_Index Item iItem To iImageIndex
39949>>>        //Set Toolbar_State To True
39949>>>        //----Changes the Shadow_State
39949>>>        Set Shadow_State Item iItem To iImageIndex
39950>>>        Delegate Set Client_Id To hoClient
39952>>>    End_Procedure // DoChangeToolBarIcon
39953>>>
39953>>>    Procedure Page_Object Integer iState
39955>>>      Integer hoCurrentObject
39956>>>      
39956>>>      Forward Send Page_Object iState
39958>>>      Move (Self) to hoCurrentObject
39959>>>      Send Add_Focus To (oOutputSelector(SELF)) hoCurrentObject
39960>>>    End_Procedure   // Page_Object
39961>>>
39961>>>    
39961>>>    Procedure Page Integer iState
39963>>>        Forward Send Page iState
39965>>>        Set Shadow_State Item 40 to (piPropertiesObjectId(Main_Menu(Self))=0)
39966>>>        If iState Begin
39968>>>             //Set Timer_Active_State Of (oToolBarTimer (Self)) To True
39968>>>        End
39968>>>>
39968>>>    End_Procedure
39969>>>    
39969>>>//    Object oToolBarTimer Is A DfTimer
39969>>>//        Procedure OnTimer
39969>>>//           Local Integer hoFocus bIsDeo bState hoToolBar bIsModal
39969>>>//           
39969>>>//           Get Focus To hoFocus
39969>>>//           If hoFocus Gt Desktop Begin
39969>>>//                Get Is_Function Get_Modal_State hoFocus Dftrue To bIsModal
39969>>>//                // **WvA: 11-10-1999, we should not check the DEO object any more if 
39969>>>//                //                    if it is a modal panel, this could throw up error messages.
39969>>>//                If (bIsModal = DfFalse) Begin
39969>>>//                  Get Is_Function Get_DEO_Object hoFocus Dftrue To bIsDeo
39969>>>//                End
39969>>>//                Move (bIsDeo = Dffalse Or bIsModal = Dftrue) To bState
39969>>>//                Move (Parent (Self)) To hoToolBar
39969>>>//                If (pbToolbarWasDisabled (hoToolBar)) Ne bState Begin
39969>>>//                   Set pbToolbarWasDisabled Of hoToolBar To bState
39969>>>//                   Set Shadow_State Of hoToolBar Item 0 To bState
39969>>>//                   Set Shadow_State Of hoToolBar Item 1 To bState
39969>>>//                   Set Shadow_State Of hoToolBar Item 2 To bState
39969>>>//                   Set Shadow_State Of hoToolBar Item 3 To bState
39969>>>//                   Set Shadow_State Of hoToolBar Item 5 To bState
39969>>>//                   Set Shadow_State Of hoToolBar Item 6 To bState
39969>>>//                   Set Shadow_State Of hoToolBar Item 7 To bState
39969>>>//                   Set Shadow_State Of hoToolBar Item 9 To bState
39969>>>//                   Set Shadow_State Of hoToolBar Item 10 To bState
39969>>>//                End
39969>>>//           End
39969>>>//       End_Procedure // OnTimer
39969>>>//   End_Object // oToolBarTimer
39969>>>   
39969>>>End_Object
39970>>>
39970>>>
39970>    
39970>    Object Client_Area is a AppClientAreasub
39972>
39972>        //AB-ClientStoreTopStart
39972>        
39972>        String  Plhktro_BIP  Plhktro_Esc  Plhktro_N11  Plhktro_N00  Plhktro_FS  Plhktro_AAA  Plhktro_DSI
39972>        String  Plhktro_SO   Plhktro_DC4     //expanded for 1 line
39972>        String  Plhktro_SI   Plhktro_DC2     //condesed
39972>        String  Plhktro_PAV              //underline
39972>        String  Plhktro_EEE  Plhktro_FFF     //emphasized
39972>        String  Plhktro_GGG  Plhktro_HHH     //double strike
39972>        String  Plhktro_WWW              //expanded
39972>        string  Plhktro_Q Plhktro_160
39972>        Integer giviewid
39972>        String  gsviewname
39972>        
39972>        Use DD_Sec.Sub
INCLUDING FILE: DD_SEC.SUB
39972>>>
39972>>>Open Sysfile
39974>>>Open UserGrps
39976>>>Open Users
39978>>>Open Views
39980>>>Open GrpViews
39982>>>Open Arxeia
39984>>>Open GrpArx
39986>>>Open GrpArx0
39988>>>Open GrpView0
39990>>>
39990>>>Use DD.Sub
39990>>>
39990>>>Class Datadictionary_Sec  Is A DatadictionarySub
39991>>>
39991>>>
39991>>>    Procedure Construct_Object
39992>>>        Forward Send Construct_Object
39994>>>        Property Integer cpiUpdate              0
39995>>>        Property Integer cpiBackout             0
39996>>>        Property Integer cpiEditing             0
39997>>>        Property Integer cpiFileNumber          0
39998>>>        Property String  cpsFileName            ''
39999>>>        Property String  cpsLoginID             ''
40000>>>        Property Integer cpiCannot_Read         0
40001>>>        Property Integer cpiCannot_Create       0
40002>>>        Property Integer cpiCannot_Delete       0
40003>>>        Property Integer cpiCannot_Edit         0
40004>>>        Property Integer piFN                   0
40005>>>    End_Procedure
40006>>>
40006>>>//    Procedure Save_Main_File
40006>>>//        If (Operation_Origin<>Self) Begin
40006>>>//            If Indirect_File.Recnum Eq 0 Procedure_Return
40006>>>//        End
40006>>>//        Forward Send Save_Main_File
40006>>>//    End_Procedure
40006>>>
40006>>>
40006>>>
40006>>>    Function Validate_Save Returns Integer
40007>>>        Integer rVal
40008>>>        Forward Get Validate_Save to rVal
40010>>>        If (Not(rVal)) Begin
40012>>>            Get cpiCannot_Read to rVal
40013>>>            If (Not(rVal)) Begin
40015>>>                Set cpiEditing to ((cpiBackout(Self)=1) and (cpiUpdate(Self)=1))
40016>>>                If (cpiEditing(Self)=1) Get cpiCannot_Edit      to rVal
40019>>>                Else                    Get cpiCannot_Create    to rVal
40021>>>            End
40021>>>>
40021>>>            If (rVal) Send Operation_Not_Allowed rVal
40024>>>        End
40024>>>>
40024>>>        Function_Return rVal
40025>>>    End_Function
40026>>>
40026>>>    Function Validate_Delete Returns Integer
40027>>>        Integer rVal
40028>>>        Forward Get Validate_Delete to rVal
40030>>>        If (Not(rVal)) Begin
40032>>>            Get cpiCannot_Read to rVal
40033>>>            If (Not(rVal)) Get cpiCannot_Delete to rVal
40036>>>            If (rVal) Send Operation_Not_Allowed rVal
40039>>>        End
40039>>>>
40039>>>        Function_Return rVal
40040>>>    End_Function
40041>>>
40041>>>    Procedure End_Construct_Object
40042>>>        Integer liSrv rVal
40043>>>        String lsStr
40043>>>        Forward Send End_Construct_Object
40045>>>        Get Main_File                                   To liSrv
40046>>>        Set cpiFileNumber                               To liSrv
40047>>>        Get_Attribute DF_FILE_PHYSICAL_NAME Of liSrv    To lsStr
40050>>>        Set cpsFileName                                 To (Trim(Uppercase(lsStr)))
40051>>>        Set cpsLoginID                                  To (fsLoginUserID())
40052>>>        Send Find_User_Rights
40053>>>        Set piFN to lisrv
40054>>>    End_Procedure
40055>>>
40055>>>    Procedure Find_User_Rights
40056>>>        String lsArxeio lsLogin
40057>>>        Integer liUser liArxeio iGroup
40057>>>
40057>>>        Get cpiFileNumber   to liArxeio
40058>>>        Get cpsFileName     to lsArxeio
40059>>>        Get cpsLoginID      to lsLogin
40060>>>
40060>>>        Clear Users
40061>>>        Move lsLogin    to Users.Login_ID
40062>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
40063>>>>
40063>>>        If (Found=1)  Begin
40065>>>            Move Users.User_ID  to liUser
40066>>>            Move Users.Grp_ID   to iGroup
40067>>>        End
40067>>>>
40067>>>        //Else Send Operation_Not_Allowed 9999
40067>>>
40067>>>        Clear Arxeia
40068>>>
40068>>>        Move liArxeio to Arxeia.Arxeio_ID
40069>>>        Find eq Arxeia by Index.1 // Arxeia:Index.1:Arxeia.Arxeio_ID
40070>>>>
40070>>>
40070>>>        If (Found=1) Begin
40072>>>            Move Arxeia.Arxeio_ID to liArxeio
40073>>>
40073>>>            Clear GrpArx
40074>>>            Move liUser     to GrpArx.User_ID
40075>>>            Move liArxeio   to GrpArx.Arxeio_ID
40076>>>            Find eq GrpArx by Index.1 // GrpArx:Index.1:GrpArx.User_ID+GrpArx.Arxeio_ID
40077>>>>
40077>>>            If (Found=1) Begin
40079>>>               If (GrpArx.Allow_Read  ='1') Set cpiCannot_Read   to 0
40082>>>               Else                         Set cpiCannot_Read   to 10003
40084>>>               If (GrpArx.Allow_Create='1') Set cpiCannot_Create to 0
40087>>>               Else                         Set cpiCannot_Create to 10000
40089>>>               If (GrpArx.Allow_Change='1') Set cpiCannot_Edit   to 0
40092>>>               Else                         Set cpiCannot_Edit   to 10001
40094>>>               If (GrpArx.Allow_Delete='1') Set cpiCannot_Delete to 0
40097>>>               Else                         Set cpiCannot_Delete to 10002
40099>>>            End
40099>>>>
40099>>>            Else Begin
40100>>>                Clear GrpArx0
40101>>>                Move iGroup   to GrpArx0.Group_ID
40102>>>                Move liArxeio to GrpArx0.Arxeio_ID
40103>>>                Find eq GrpArx0 by Index.1 // GrpArx0:Index.1:Group_ID+Arxeio_ID
40104>>>>
40104>>>                If (Found=1) Begin
40106>>>                    If (GrpArx0.Allow_Read  ='1')   Set cpiCannot_Read   to 0
40109>>>                    Else                            Set cpiCannot_Read   to 20003
40111>>>                    If (GrpArx0.Allow_Create='1')   Set cpiCannot_Create to 0
40114>>>                    Else                            Set cpiCannot_Create to 20000
40116>>>                    If (GrpArx0.Allow_Change='1')   Set cpiCannot_Edit   to 0
40119>>>                    Else                            Set cpiCannot_Edit   to 20001
40121>>>                    If (GrpArx0.Allow_Delete='1')   Set cpiCannot_Delete to 0
40124>>>                    Else                            Set cpiCannot_Delete to 20002
40126>>>                End
40126>>>>
40126>>>                Else Begin
40127>>>                    Set cpiCannot_Read   to 0
40128>>>                    Set cpiCannot_Edit   to 0
40129>>>                    Set cpiCannot_Create to 0
40130>>>                    Set cpiCannot_Delete to 0
40131>>>                End
40131>>>>
40131>>>            End
40131>>>>
40131>>>        End
40131>>>>
40131>>>        Else Begin
40132>>>            // €¤ ›œ¤ ™¨œŸœ  «¦ ˜¨®œ ¦ «¦«œ Ÿœà¨¦¬£œ ¦«  ¦ ®¨ž©«žª œ®œ  §¨¦©™˜©ž ©'˜¬«¦
40132>>>            Set cpiCannot_Read   to 0
40133>>>            Set cpiCannot_Edit   to 0
40134>>>            Set cpiCannot_Create to 0
40135>>>            Set cpiCannot_Delete to 0
40136>>>        End
40136>>>>
40136>>>    End_Procedure
40137>>>
40137>>>    Procedure Clear_main_file
40138>>>        Forward Send Clear_main_file
40140>>>        Set cpiBackout to 0
40141>>>        Set cpiUpdate  to 0
40142>>>    End_Procedure
40143>>>
40143>>>    Procedure Update
40144>>>        Forward Send Update
40146>>>        Set cpiUpdate to 1
40147>>>    End_Procedure
40148>>>
40148>>>    Procedure Backout
40149>>>        Forward Send Backout
40151>>>        Set cpiBackout to 1
40152>>>    End_Procedure
40153>>>
40153>>>    Procedure OnConstrain
40154>>>        Integer rVal liSrv
40155>>>        Forward Send OnConstrain
40157>>>        Get cpiFileNumber  To liSrv
40158>>>        Move liSrv         To Filenumber
40159>>>        Get cpiCannot_Read to rVal
40160>>>        If (rVal) Constrain Indirect_File.Recnum eq 0
40164>>>    End_Procedure
40165>>>
40165>>>    Procedure Operation_Not_Allowed  Integer iError_Num
40166>>>        String sLektiko
40167>>>        Move '' to sLektiko
40168>>>
40168>>>             If iError_Num eq 10000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
40171>>>        Else If iError_Num eq 10001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Users permissions. Check with your Administrator"    to sLektiko
40175>>>        Else If iError_Num eq 10002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
40179>>>        Else If iError_Num eq 10003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
40183>>>        Else If iError_Num eq 20000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
40187>>>        Else If iError_Num eq 20001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Group permissions. Check with your Administrator"    to sLektiko
40191>>>        Else If iError_Num eq 20002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
40195>>>        Else If iError_Num eq 20003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
40199>>>        Else If iError_Num eq  9999 Move "Unknown User in Users File"                                                                                    to sLektiko
40203>>>        Else If iError_Num eq 20101 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Change its Data"                 to sLektiko
40207>>>        Else If iError_Num eq 20102 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Delete It"                       to sLektiko
40211>>>        Append sLektiko '\nFile = ' (String(cpiFileNumber(Self))) ' - ' (CpsFileName(Self))
40215>>>
40215>>>             If iError_Num eq 10000 Error 10000 sLektiko
40218>>>        Else If iError_Num eq 10001 Error 10001 sLektiko
40222>>>        Else If iError_Num eq 10002 Error 10002 sLektiko
40226>>>        Else If iError_Num eq 10003 Error 10003 sLektiko
40230>>>        Else If iError_Num eq 20000 Error 20000 sLektiko
40234>>>        Else If iError_Num eq 20001 Error 20001 sLektiko
40238>>>        Else If iError_Num eq 20002 Error 20002 sLektiko
40242>>>        Else If iError_Num eq 20003 Error 20003 sLektiko
40246>>>        Else If iError_Num eq  9999 Error  9999 sLektiko
40250>>>        Else If iError_Num eq 20101 Error 20101 sLektiko
40254>>>        Else If iError_Num eq 20102 Error 20102 sLektiko
40258>>>
40258>>>        Else Forward Send Operation_Not_Allowed  iError_Num
40261>>>    End_Procedure   // Operation_Not_Allowed
40262>>>
40262>>>
40262>>>End_Class //Datadictionary_Sec
40263>        use dbviews.sub
INCLUDING FILE: DBVIEWS.SUB
40263>>>
40263>>>Class DbviewSubs Is A DbviewSub
40264>>>
40264>>>    Procedure Construct_Object
40265>>>        Integer iPos iCount
40266>>>        Forward Send Construct_Object
40268>>>
40268>>>        Property String     psMyViewName    Public ''
40269>>>        Property Integer    piMyViewID      Public  0
40270>>>
40270>>>        Get Name            to gsViewName
40271>>>        Get Object_ID       to giViewID
40272>>>
40272>>>        Move 0 to iPos
40273>>>        For iCount From 1 to (Length(gsViewName))
40279>>>>
40279>>>            If (Mid(gsViewName,1,iCount)='.') Move iCount to iPos
40282>>>        Loop
40283>>>>
40283>>>        Move (Right(gsViewName,(Length(gsViewName)-iPos))) to gsViewName
40284>>>        Move (Trim(gsViewName)) to gsViewName
40285>>>
40285>>>        Set psMyViewName    to (Trim(gsViewName))
40286>>>        Set piMyViewID      to giViewID
40287>>>
40287>>>    End_Procedure
40288>>>
40288>>>    Procedure End_Construct_Object
40289>>>        Integer iFileNumber iFieldNumber iUser iColor iLimit iBase iCurr iCol iDeo iPos
40290>>>        Integer iObj iPrototype iColumn iItem iInt iFieldStatus iCurCol iCount
40290>>>        String  sFileName sFieldName sUser sRecr sStr sDbFormName sViewLabel sDeo svn
40290>>>
40290>>>        Forward Send End_Construct_Object
40292>>>
40292>>>
40292>>>        Get psMyViewName        to gsViewName
40293>>>        Get piMyViewID          to giViewID
40294>>>        Get Label Of giViewID   to sViewLabel
40295>>>        Move (Trim(sViewLabel)) to sViewLabel
40296>>>
40296>>>        Clear Oth
40297>>>        Move gsViewName to Oth.View_Name
40298>>>        Find eq Oth By Index.2 // Oth:Index.2:View_Name
40299>>>>
40299>>>        If (Not(Found)) Begin
40301>>>            Move sViewLabel to Oth.View_Label
40302>>>            Move giViewID    to Oth.View_ID
40303>>>            Saverecord Oth
40304>>>        End
40304>>>>
40304>>>
40304>>>    End_Procedure //End_Construct_Object
40305>>>
40305>>>End_Class //dbviewSubs
40306>>>
40306>>>
40306>        use dbforms.sub
INCLUDING FILE: DBFORMS.SUB
40306>>>
40306>>>Class dbFormSubs Is a dbFormSub
40307>>>
40307>>>//    Register_Procedure Set psMyViewName
40307>>>//    Register_Function      psMyViewName Returns String
40307>>>//    Register_Procedure Set piMyViewID
40307>>>//    Register_Function      piMyViewID   Returns Integer
40307>>>
40307>>>    Procedure End_Construct_Object
40308>>>        Integer iFileNumber iFieldNumber iServer
40309>>>        Integer iPos icount iColor iFieldStatus iFileNumber2
40309>>>        String  sStr sDbFormName sViewLabel
40309>>>
40309>>>        Forward Send End_Construct_Object
40311>>>
40311>>>        //If (SysRec.Scr_Fld_Lock='1') Begin
40311>>>
40311>>>            Get Name            to sDbFormName
40312>>>            Get psMyViewName    to gsViewName
40313>>>            Get piMyViewID      to giViewID
40314>>>
40314>>>            Move 0 to iPos
40315>>>            For iCount From 1 to (Length(sDbFormName))
40321>>>>
40321>>>                If (Mid(sDbFormName,1,iCount)='.') Move iCount to iPos
40324>>>            Loop
40325>>>>
40325>>>            Move (Right(sDbFormName,(Length(sDbFormName)-iPos))) to sDbFormName
40326>>>            Move (Trim(sDbFormName)) to sDbFormName
40327>>>
40327>>>            Move (Trim(gsViewName)) to gsViewName
40328>>>
40328>>>            Clear Oth
40329>>>            Move gsViewName to Oth.View_Name
40330>>>            Find eq Oth By Index.2 // Oth:Index.2:View_Name
40331>>>>
40331>>>            Move Oth.View_Label to sViewLabel
40332>>>            Move (Trim(sViewLabel)) to sViewLabel
40333>>>
40333>>>            Clear ViewFlds
40334>>>            Move gsViewName     to ViewFlds.View_Name
40335>>>            Move sDbFormName    to ViewFlds.Scr_Field_Name
40336>>>            Find eq ViewFlds By Index.1 // ViewFlds:Index.1:View_Name+Scr_Field_Name
40337>>>>
40337>>>            If (Not(Found)) Begin
40339>>>                Reread Sysrec
INCLUDING FILE: SYSREC.FD
40343>>>                Move (SysRec.Viewflds_Rec0+1) to ViewFlds.ViewFlds_Rec0
40344>>>                Move (SysRec.Viewflds_Rec0+1) to SysRec.ViewFlds_Rec0
40345>>>                Saverecord SysRec
40346>>>                UnLock
40347>>>>
40347>>>                Move sViewLabel to ViewFlds.View_Label
40348>>>                Saverecord ViewFlds
40349>>>            End
40349>>>>
40349>>>            Else If ((Trim(ViewFlds.View_Label)='') And (sViewLabel<>'')) Begin
40352>>>                Reread ViewFlds
40356>>>                Move sViewLabel to ViewFlds.View_Label
40357>>>                Saverecord ViewFlds
40358>>>                Unlock
40359>>>>
40359>>>            End
40359>>>>
40359>>>            Move (fiScreenFieldStatus(gsViewName,sDbFormName))  to iFieldStatus
40360>>>
40360>>>
40360>>>        // iFieldStatus=0 ==> EVERYTHING IS ALLOWED
40360>>>        // iFieldStatus=1 ==> NO READ ALLOWED
40360>>>        // iFieldStatus=2 ==> NO EDIT BUT CAN COPY
40360>>>        // iFieldStatus=3 ==> NO EDIT AND NO COPY
40360>>>        If (Not(iFieldStatus)) Begin
40362>>>            ////// Field is NORMAL ////////
40362>>>        End
40362>>>>
40362>>>        Else Begin
40363>>>            If (iFieldStatus=1) Begin
40365>>>                ////// Field is NO DISPLAY ////////
40365>>>                Set Enabled_State   Item 0 to False
40366>>>                Set Entry_State     Item 0 to False
40367>>>                Get Color                  to iColor
40368>>>                Set TextColor              to iColor
40369>>>            End
40369>>>>
40369>>>            Else Begin
40370>>>                If (iFieldStatus=2) Begin
40372>>>                    ////// Field is NO EDIT  /////////
40372>>>                    Get Server                                      to iServer
40373>>>                    Get Data_File   Item 0                          to iFileNumber
40374>>>                    If (iServer) Get piFN of iServer                to iFileNumber2
40377>>>
40377>>>                    // €¤ ¦ server œå¤˜  › ˜­¦¨œ« ¡æª ˜§¦ «¦¤ ˜¨ Ÿ£¦ «¦¬ datafile «¦¬ §œ› ¦¬
40377>>>                    // «¦«œ «¦ §œ›å¦ œå¤˜  £§˜£§áª ¡˜  «¦ Noput ›œ¤ §˜ œ  ¦§¦«œ ¡æ™¦¬£œ «¦ Enter
40377>>>                    If (iFileNumber=iFileNumber2)   Set Item_Option Item 0  to Noput True
40380>>>                    Else                            Set Item_Option Item 0  to NoEnter True
40382>>>                End
40382>>>>
40382>>>                Else Begin
40383>>>                    If (iFieldStatus=3) Begin
40385>>>                        ////// Field is NO EDIT AND NO COPY     /////////
40385>>>                        Set Enabled_State   Item 0 to False
40386>>>                        Set Entry_State     Item 0 to False
40387>>>                        Set Shadow_State    Item 0 to True
40388>>>                    End
40388>>>>
40388>>>                End
40388>>>>
40388>>>            End
40388>>>>
40388>>>        End
40388>>>>
40388>>>     End_Procedure
40389>>>
40389>>>End_Class //DbformSubs
40390>>>
40390>        
40390>        Use Stbarpsc.pkg
INCLUDING FILE: STBARPSC.PKG
40390>>>Use DFStatBr.pkg
40390>>>
40390>>>Class BasicPanelStatusBarSub is a BasicStatusBar
40391>>>
40391>>>    Procedure Construct_Object
40392>>>        Forward Send Construct_Object
40394>>>        Property Integer Status_Help_Item Public 0
40395>>>        Property Integer Menu_Simple_State public TRUE
40396>>>        Property Integer Menu_status_State public False
40397>>>        Property Integer Old_Simple_State  public false
40398>>>        Property String  Old_Status_Value  public ''
40399>>>        Set Attach_Parent_State To TRUE
40400>>>        Delegate Set StatusBar_id To Self
40402>>>    End_Procedure
40403>>>
40403>>>    Procedure SET Status_Help_Value String sHelp
40404>>>        Local Integer iPart
40405>>>        Get Status_Help_Item To iPart
40406>>>        Set Value item iPart To sHelp
40407>>>    End_Procedure
40408>>>
40408>>>    Function Status_Help_Value Returns String
40409>>>        Local Integer iPart
40410>>>        Local String sHelp
40410>>>        Get Status_Help_Item To iPart
40411>>>        Get Value item iPart To sHelp
40412>>>        Function_Return sHelp
40413>>>    End_Procedure
40414>>>
40414>>>    Procedure Initialize_Menu
40415>>>       Local integer iState OldState
40416>>>       If Not (Menu_Status_state(Self)) Begin
40418>>>          Get Simple_State to OldState
40419>>>          Set Old_Simple_State to OldState
40420>>>          If OldState   Set Old_Status_Value to (Simple_Value(Self))
40423>>>          Else          Set Old_Status_Value to (Status_Help_Value(Self))
40425>>>          Set Simple_State to (Menu_Simple_State(Self))
40426>>>          Set Menu_Status_State to TRUE
40427>>>       End
40427>>>>
40427>>>    End_Procedure
40428>>>
40428>>>    Procedure Exit_Menu
40429>>>       Local Integer OldState
40430>>>       Local String OldVal
40430>>>       If (Menu_Status_state(Self)) Begin
40432>>>          Get Old_Simple_State to OldState
40433>>>          Set Simple_State     to OldState
40434>>>          Get old_status_Value to oldVal
40435>>>          If OldState ;             Set Simple_Value to OldVal
40438>>>          Else ;             Set Status_Help_Value to OldVal
40440>>>          Set Menu_Status_State to FALSE
40441>>>       End
40441>>>>
40441>>>    End_Procedure // Exit_Menu
40442>>>
40442>>>    Procedure Show_Status_Help String sHelp
40443>>>        Local Integer iState
40444>>>        Get Simple_State to iState
40445>>>        If NOT iState Set Status_Help_Value To sHelp
40448>>>        Else          Set Simple_Value      To sHelp
40450>>>    End_Procedure
40451>>>
40451>>>    Function Current_Status_Help Returns String
40452>>>        Local Integer iState
40453>>>        Local String sHelp
40453>>>        Get Simple_State to iState
40454>>>        If NOT iState Get Status_Help_Value To sHelp
40457>>>        Else          Get Simple_Value      To sHelp
40459>>>        Function_Return sHelp
40460>>>    End_Function
40461>>>
40461>>>
40461>>>End_Class
40462>        
40462>        //Use bpKost1.dg
40462>        
40462>        Open Nomisma
40464>        Open Isotimia
INCLUDING FILE: ISOTIMIA.FD
40466>        Use Roundfn.Fnc
40466>        Function fngConvertPoso Global String asNomismaCodeApo Number anPoso ;                                       String asNomismaCodeSe  Date   adHmnia;                                       Number nIsotimia  Returns Number
40467>        
40467>            Number rVal nApo_Euro_Isot nSe_Euro_Isot
40468>            Integer iApo_Einai_Euro_Zone iApo_Einai_DRX iApo_Einai_Euro iDekadika_Apo
40468>            Integer iSe_Einai_Euro_Zone  iSe_Einai_DRX  iSe_Einai_Euro  iDekadika_Se
40468>            String  sCode
40468>        
40468>            If (asNomismaCodeApo=asNomismaCodeSe) Function_Return anPoso
40471>        
40471>            Clear Nomisma
40472>            Move (Trim(asNomismaCodeApo)) to Nomisma.Nomisma_Code
40473>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
40474>            Move Nomisma.Euro_Zone      to iApo_Einai_Euro_Zone
40475>            Move Nomisma.Einai_DRX      to iApo_Einai_DRX
40476>            Move Nomisma.Einai_EURO     to iApo_Einai_Euro
40477>            Move Nomisma.KL_ISOT_EURO   to nApo_Euro_Isot
40478>            Move Nomisma.Dekadika       to iDekadika_Apo
40479>            // 1. An to nomisma APO den einai ths zonhs euro prepei na vrethei h isotimia tou
40479>            If ((NOT(iApo_Einai_Euro_Zone)) And (nApo_Euro_Isot=0))  Begin
40481>                If (adHmnia='') Sysdate            adHmnia
40484>                Move (Trim(asNomismaCodeApo))   to sCode
40485>                Clear Isotimia
40486>                Move sCode                      to Isotimia.Nomisma_Code
40487>                Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
40488>                Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
40489>                Move Isotimia.Isotimia_Euro     to nApo_Euro_Isot
40490>            End
40490>        
40490>            Clear Nomisma
40491>            Move (Trim(asNomismaCodeSe)) to Nomisma.Nomisma_Code
40492>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
40493>            Move Nomisma.Euro_Zone      to iSe_Einai_Euro_Zone
40494>            Move Nomisma.Einai_DRX      to iSe_Einai_DRX
40495>            Move Nomisma.Einai_EURO     to iSe_Einai_Euro
40496>            Move Nomisma.KL_ISOT_EURO   to nSe_Euro_Isot
40497>            Move Nomisma.Dekadika       to iDekadika_Se
40498>            // 2. An to nomisma SE den einai ths zonhs euro prepei na vrethei h isotimia tou
40498>            If ((NOT(iSe_Einai_Euro_Zone)) And (nSe_Euro_Isot=0)) Begin
40500>                If (adHmnia='') Sysdate            adHmnia
40503>                Move (Trim(asNomismaCodeSe))    to sCode
40504>                Clear Isotimia
40505>                Move sCode                      to Isotimia.Nomisma_Code
40506>                Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
40507>                Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
40508>                Move Isotimia.Isotimia_Euro     to nSe_Euro_Isot
40509>            End
40509>        
40509>            Calc (anPoso/nApo_Euro_Isot) to rVal
40510>            Move (Round_Number(rVal,6)) to rVal
40511>            Calc (rVal*nSe_Euro_Isot) to rVal
40512>            Move (Round_Number(rVal,iDekadika_Se)) to rVal
40513>        
40513>            Function_Return rVal
40514>        End_Function
40515>        
40515>        Register_Object oStatusBarSub
40515>        
40515>        Open Syscurxr
40517>        Open SysFile
40519>        Open Sysrecc
INCLUDING FILE: SYSRECC.FD
40521>        Open Sysrecb
INCLUDING FILE: SYSRECB.FD
40523>        Open Sysrecw
INCLUDING FILE: SYSRECW.FD
40525>        
40525>        Procedure Reset_All_Files_Except_System
40527>            Local Integer File# Open# File_Number# liInt iMax iWait isSystem
40528>            Local String Physicalname# DisplayName# Logicalname# Rootname#
40528>            Move 0 To File#
40529>            Repeat
40529>              Get_Attribute Df_File_Next_Opened Of File# To File#
40532>              If (File#) Begin
40534>                Get_Attribute DF_FILE_IS_SYSTEM_FILE    Of File# To isSystem
40537>                If (NOT(isSystem)) Clear File#
40540>              End
40540>            Until File# Eq 0
40542>        End_Procedure
40543>        
INCLUDING FILE: FEM.PKG
40543>>///////////////////////////////////////////////
40543>>// Ginetai #Include sto Program //
40543>>///////////////////////////////////////////////
40543>>Use Idiotht.pkg
40543>>
40543>>Integer igC
40543>>String  sgC sgFull sgRootDir sgDevicePath
40543>>Move 0 to igC
40544>>
40544>>Move (fsReadRegistryFEMRootDir   ()) To sgRootDir
40545>>Move (fsReadRegistryFEMDevicePath()) To sgDevicePath
40546>>
40546>>// An den yparxoun ta settings sto registry (apo Setup Egkatastashs)
40546>>// Tote ta ftiaxnoume me ex orismou C:\FEM_ROOT\ & C:\FEM_ROOT\Device_File1.dat
40546>>// mesa apo tis 2 parakato functions (sto Idiotht.pkg)
40546>>If (Trim(sgRootDir)   ='') Get fiWriteRegistryFEMRootDir    to iGC
40549>>If (Trim(sgDevicePath)='') Get fiWriteRegistryFEMDevicePath to iGC
40552>>//
40552>>
40552>>// ** START ** Function ths forologikhs ektypotikhs mhxanhs
40552>>External_Function32 FSL_Command "FSL_Command" rapidsign.dll;                    String  sBaseDir    ;                    String  sCommand    ;                    String  sDevFile    ;                    String  sParam1     ;                    String  sParam2     ;                    Returns Integer
40553>>
40553>>External_Function32 FSL_SignDocument "FSL_SignDocument" rapidsign.dll;                    String  sDevFile    ;                    String  sParam      ;                    String  sResult     ;                    Returns Integer
40554>>// ** END ** Function ths forologikhs ektypotikhs mhxanhs
40554>>
40554>>
40554>>// ** START ** Gemisma global string me escape xarakthron gia afairesh tous apo to ascii ths forologikhs
40554>>Move '' to sgC
40555>>For igC From 1 to 254
40561>>>
40561>>    If ((igC<32) Or ((igC>175) And (igC<224)) Or (igC>240)) Begin
40563>>        Move (Append(sgC,Character(igC))) to sgC
40564>>    End
40564>>>
40564>>Loop
40565>>>
40565>>// ** END ** Gemisma escape xarakthron gia afairesh tous apo to ascii ths forologikhs
40565>>
40565>>
40565>>Function fiEtoimaseTaAscii Returns Integer
40567>>    Integer iFileExist iii iii2 isOK
40568>>    String  sLine sLine2 sLetter sLetter2
40568>>    // 1. Check if file was outputed (C:\##Parast.txt)
40568>>    Get Get_File_Exists 'C:\##Parast.txt' to iFileExist
40569>>    If (Not(iFileExist)) Function_Return 12556
40572>>
40572>>    // 2. Check if file is outputed but empty
40572>>    Direct_Input Channel 7 "C:\##Parast.txt"
40574>>    If (Seqeof) Begin
40576>>        Close_Input Channel 7
40578>>        Function_Return 12557
40579>>    End
40579>>>
40579>>
40579>>    // 3. Strip file from escape sequences
40579>>    Direct_Output Channel 9 "C:\##Parast0.txt"
40581>>    Repeat
40581>>>
40581>>        Readln Channel 7 sLine
40583>>        For iii From 1 to (Length(sgC))
40589>>>
40589>>            Move (Replaces((Mid(sgC,1,iii)),sLine,' ')) to sLine
40590>>        Loop
40591>>>
40591>>        Writeln Channel 9 sLine
40594>>    Until (Seqeof)
40596>>    Close_Input Channel 7
40598>>    Close_Output Channel 9
40600>>
40600>>    // 4. Check if new ascii without escape
40600>>    //    sequences is outputed (C:\##Parast0.txt)
40600>>    Get Get_File_Exists 'C:\##Parast0.txt' to iFileExist
40601>>    If (Not(iFileExist)) Function_Return 12558
40604>>
40604>>    // 5. Check if new file is outputed but empty
40604>>    Direct_Input Channel 7 "C:\##Parast0.txt"
40606>>    If (Seqeof) Begin
40608>>        Close_Input Channel 7
40610>>        Function_Return 12559
40611>>    End
40611>>>
40611>>
40611>>    // 6. Convert file to ELOT
40611>>    Direct_Output Channel 9 "C:\##Parast1.txt"
40613>>    Repeat
40613>>>
40613>>        Readln Channel 7        sLine
40615>>        Move (ToAnsi(sLine)) to sLine2
40616>>        Writeln Channel 9       sLine2
40619>>    Until (Seqeof)
40621>>    Close_Input  Channel 7
40623>>    Close_Output Channel 9
40625>>
40625>>    // 7. Check if converted ELOT ascii is outputed (C:\##Parast1.txt)
40625>>    Get Get_File_Exists 'C:\##Parast1.txt' to iFileExist
40626>>    If (Not(iFileExist)) Function_Return 12560
40629>>
40629>>    // 8. Check if converted ELOT ascii is NOT Empty
40629>>    Direct_Input Channel 7 "C:\##Parast1.txt"
40631>>    If (Seqeof) Begin
40633>>        Close_Output Channel 7
40635>>        Function_Return 12561
40636>>    End
40636>>>
40636>>    Close_Output Channel 7
40638>>
40638>>    Function_Return 1 // Everything OK
40639>>End_function
40640>>
40640>>Function fiPareYpografh Returns String
40642>>    Integer iFileExist iii iii2 isOK
40643>>    String  sLine sLine2 sLetter sLetter2
40643>>    Move 0 to isOK
40644>>
40644>>    Move (FSL_Command(sgRootDir,'SIGN',sgDevicePath ,'C:\##Parast1.txt','C:\##Signature.txt')) to isOK
40645>>    If (isOK<>0) Function_Return ''
40648>>
40648>>    Direct_Input Channel 7 'C:\##Signature.txt'
40650>>    If (Seqeof) Function_Return '12562'
40653>>    Readln Channel 7 sLine
40655>>    Move (Trim(sLine)) to sLine
40656>>    If (Length(sLine)<>77) Function_Return '12563'
40659>>
40659>>    EraseFile "C:\##Parast*.txt"
40660>>>
40660>>    EraseFile "C:\##Signature.txt"
40661>>>
40661>>
40661>>    Function_return (Trim(sLine))
40662>>End_function
40663>>
40663>>Function fiVgaleZ Returns Integer
40665>>    Integer isOK
40666>>    Move 0 to isOK
40667>>    Move (FSL_Command(sgRootDir,'Z',sgDevicePath ,'','')) to isOK
40668>>    Function_return isOK
40669>>    // 0= ok
40669>>End_function
40670>>
40670>>Function fiShowCTL Returns Integer
40672>>    Integer isOK
40673>>    Move 0 to isOK
40674>>    Move (FSL_Command(sgRootDir,'CTL',sgDevicePath ,'','')) to isOK
40675>>    Function_return isOK
40676>>    // 0= ok
40676>>End_function
40677>>
40677>>Use RptVwFem.Sub
INCLUDING FILE: RPTVWFEM.SUB
40677>>>>Use DFRptvw.pkg
40677>>>>Use dbRptvw.pkg
40677>>>>
40677>>>>Use RptVW.Sub
40677>>>>
40677>>>>Class ReportViewFEMSub is a ReportViewSub    
40678>>>>
40678>>>>    Procedure Construct_Object
40679>>>>        Forward Send Construct_Object
40681>>>>
40681>>>>        Property Integer    piIsReportCancelled     Public  0
40682>>>>        Property Integer    piAsciiOrPrinter        Public  0
40683>>>>    
40683>>>>    End_Procedure
40684>>>>    
40684>>>>
40684>>>>// ‡˜ â§¨œ§œ ž procedure ˜¬«ž
40684>>>>//
40684>>>>//    Procedure StartReport
40684>>>>//        send Gemise_Escape_Characters
40684>>>>//        String Whme_APO sRecr
40684>>>>//        integer wnees wclose
40684>>>>//        Local Integer iOutputDevice
40684>>>>//        Local String  FileName
40684>>>>//        local integer inew_state
40684>>>>//        Get Output_Device_Mode To iOutputDevice
40684>>>>//        get new_state to inew_state
40684>>>>//        set piprinter to 0
40684>>>>//        //?????????????????????????????????????????????
40684>>>>//        Get Output_Device_Mode To iOutputDevice
40684>>>>
40684>>>>//        If iOutputDevice EQ PRINT_TO_WINDOW Begin
40684>>>>//            Set piAsciiOrPrinter    to 0
40684>>>>//            Make_Temp_File "TXT" FileName
40684>>>>//            Move (".\" - FileName)  To FileName
40684>>>>//            Set Output_Device_Name  To FileName
40684>>>>//        End
40684>>>>//        Else Begin
40684>>>>
40684>>>>//            If (Sysfile.Use_Sql_Reports='1') Begin
40684>>>>//                If (piAsciiOrPrinter(Self)=0) Error 7000 'ƒœ¤ ©œ«á¨˜«œ «¦ piAsciiOrPrinter\n(ƒœ¤ §¨¦©› ¦¨å©«ž¡œ ˜¤ ˜­¦¨á ASCII ã „¡«¬§à«ã)'
40684>>>>//            End
40684>>>>
40684>>>>//            Get psRecr Of TIMOLOGIO_BasicReport to sRecr
40684>>>>//            Move (Trim(sRecr)) to sRecr
40684>>>>
40684>>>>//            If (sRecr='') Error 7003 'ƒœ¤ ¬§á¨®œ  Recr š ˜ «¦ §˜¨˜©«˜« ¡æ'
40684>>>>
40684>>>>//            Clear Particle
40684>>>>//            Move sRecr to Particle.Partl_Recr
40684>>>>//            Find Eq Particle by index.2
40684>>>>//            If (Not(Found)) Error 7001 'ƒœ¤ ™¨âŸž¡œ «¦ §˜¨˜©«˜« ¡æ'
40684>>>>
40684>>>>//            Clear Pseira
40684>>>>//            Move SyscurXr.Company_Code  to Pseira.Company_Code
40684>>>>//            Move SyscurXr.Branch_Code   to Pseira.Branch_Code
40684>>>>//            Move Particle.Ptyppar_Code  to Pseira.Ptyppar_Code
40684>>>>//            Move Particle.Pseira_Seira  to Pseira.Pseira_Seira
40684>>>>//            Find Eq Pseira By Index.1 // Pseira:Index.1:Company_Code+Branch_Code+Year_Year+Ptyppar_Code+Pseira_Seira
40684>>>>//            If (Not(Found)) Error 7002 'ƒœ¤ ™¨âŸž¡œ ž ©œ ¨á'
40684>>>>
40684>>>>//            If (piAsciiOrPrinter(Self)=1) Begin
40684>>>>//                // 1= Output ©œ Ascii
40684>>>>//                Set Output_Device_Name  To 'C:\##Parast.txt'
40684>>>>//            End
40684>>>>//            Else If (piAsciiOrPrinter(Self)=2) Begin
40684>>>>//                // 2= Output ©œ Printer
40684>>>>//                Set Output_Device_Name  To Pseira.Pseira_Printer
40684>>>>//            End
40684>>>>//            Else Error 7004 '’¦ Flag piAsciiOrPrinter ›œ¤ œå¤˜  ©à©«æ'
40684>>>>//        End
40684>>>>
40684>>>>//        Send Run_Report  //record
40684>>>>
40684>>>>//        If iOutputDevice EQ PRINT_TO_WINDOW Begin
40684>>>>//            RunProgram background "notepad" FileName
40684>>>>//            EraseFile FileName
40684>>>>//        End
40684>>>>
40684>>>>//    End_Procedure   // StartReport
40684>>>>
40684>>>>
40684>>>>End_Class
40685>>>>
40685>>>>Class dbReportViewFEMSub is a dbReportViewSub
40686>>>>    Procedure Construct_Object
40687>>>>        Forward Send Construct_Object
40689>>>>
40689>>>>        Property Integer    piIsReportCancelled     Public  0
40690>>>>        Property Integer    piAsciiOrPrinter        Public  0
40691>>>>    
40691>>>>    End_Procedure
40692>>>>End_Class
40693>>>>
40693>>Use BasrpFem.Sub
INCLUDING FILE: BASRPFEM.SUB
40693>>>>Use Dfrpt.pkg
40693>>>>
40693>>>>Use BasicRpt.Sub
INCLUDING FILE: BASICRPT.SUB
40693>>>>>>Use Dfrpt.pkg
40693>>>>>>
40693>>>>>>Class BasicReportSub is a BasicReport
40694>>>>>>
40694>>>>>>    Procedure Start_Log
40695>>>>>>        Send Log_Status ("Starting Report:"+Report_Title(Current_Object))
40696>>>>>>    End_Procedure // Start_Log
40697>>>>>>
40697>>>>>>    Procedure End_Log
40698>>>>>>        Send Log_Status ("Ending Report:  " + Report_Title(Current_Object))
40699>>>>>>    End_Procedure // End_Log
40700>>>>>>
40700>>>>>>    Procedure Error_Log_Status integer ErrNum integer Err_Line string ErrMsg
40701>>>>>>        Send Log_Status ("Error #"* String(ErrNum) + "." * ErrMsg)
40702>>>>>>    End_Procedure // Error_Log_Status
40703>>>>>>
40703>>>>>>    Procedure Update_Status_Page
40704>>>>>>        If (Page_End(Current_Object)) EQ 0 ;             Send Update_Status ("Record: " + String(Page_Count(Current_Object)))
40707>>>>>>        Else Send Update_Status ("Page: "   + String(Page_Count(Current_Object)))
40709>>>>>>    End_Procedure // Update_Status_Page
40710>>>>>>
40710>>>>>>    Procedure onError integer ErrNum integer Err_Line string ErrMsg
40711>>>>>>        If (Display_Error_State(Self)) Send End_Status
40714>>>>>>        Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
40715>>>>>>>
40715>>>>>>    End_procedure
40716>>>>>>
40716>>>>>>    Function Report_Interrupt Returns Integer
40717>>>>>>        Integer rVal
40718>>>>>>        String Mess
40718>>>>>>        If (Error_Check_State(Current_Object)) ;            Move "„£­˜¤å©«ž¡œ œ¤˜ ©­á¢£˜ ¡˜«˜ «ž¤ œ§œ¥œ¨š˜©å˜. Œ˜ › ˜¡¦§œå ž œ¡«ç§à©ž ?" to Mess
40721>>>>>>        Else   Move  "Œ˜ ˜¡¬¨é©à «ž¤ œ¡«ç§à©ž ?" to Mess
40723>>>>>>        Get YesNo_Box Mess "ƒ ˜¡¦§ã „§œ¥œ¨š˜©å˜ª" to rVal
40724>>>>>>        If (rVal=MBR_YES) Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
40727>>>>>>        Function_Return (Rval=MBR_YES)
40728>>>>>>    End_Function  // Report_Interrupt
40729>>>>>>
40729>>>>>>End_Class // BasicReportSub
40730>>>>>>
40730>>>>>>Class WinReportSub is a WinReport
40731>>>>>>
40731>>>>>>    Procedure Start_Log
40732>>>>>>        Send Log_Status ("Start Report:"+Report_Title(Current_Object))
40733>>>>>>    End_Procedure // Start_Log
40734>>>>>>
40734>>>>>>    Procedure End_Log
40735>>>>>>        Send Log_Status ("End Report:  " + Report_Title(Current_Object))
40736>>>>>>    End_Procedure // End_Log
40737>>>>>>
40737>>>>>>    Procedure Error_Log_Status integer ErrNum integer Err_Line string ErrMsg
40738>>>>>>        Send Log_Status ("Error #"* String(ErrNum) + "." * ErrMsg)
40739>>>>>>    End_Procedure // Error_Log_Status
40740>>>>>>
40740>>>>>>    Procedure Update_Status_Page
40741>>>>>>        If (Page_End(Current_Object)) EQ 0 ;            Send Update_Status ("Record: " + String(Page_Count(Current_Object)))
40744>>>>>>        Else Send Update_Status ("Page: " + String(Page_Count(Current_Object)))
40746>>>>>>    End_Procedure // Update_Status_Page
40747>>>>>>
40747>>>>>>    Procedure onError integer ErrNum integer Err_Line string ErrMsg
40748>>>>>>        If (Display_Error_State(Self)) Send End_Status
40751>>>>>>        Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
40752>>>>>>>
40752>>>>>>    End_procedure
40753>>>>>>
40753>>>>>>    Function Report_Interrupt Returns Integer
40754>>>>>>        Integer rVal
40755>>>>>>        String Mess
40755>>>>>>        If (Error_Check_State(Current_Object)) ;            Move "„£­˜¤å©«ž¡œ œ¤˜ ©­á¢£˜ ¡˜«˜ «ž¤ œ§œ¥œ¨š˜©å˜. Œ˜ › ˜¡¦§œå ž œ¡«ç§à©ž ?" to Mess
40758>>>>>>        Else   Move  "Œ˜ ˜¡¬¨é©à «ž¤ œ¡«ç§à©ž ?" to Mess
40760>>>>>>        Get YesNo_Box Mess "ƒ ˜¡¦§ã „§œ¥œ¨š˜©å˜ª" to rVal
40761>>>>>>        If (rVal=MBR_YES) Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
40764>>>>>>        Function_Return (Rval=MBR_YES)
40765>>>>>>    End_Function  // Report_Interrupt
40766>>>>>>
40766>>>>>>End_Class // WinReportSub
40767>>>>>>
40767>>>>
40767>>>>Class BasicReportFemSub is a BasicReportSub
40768>>>>
40768>>>>    Function Starting_Main_Report Returns Integer
40769>>>>        Integer   iRetVal iindexr14_1
40770>>>>        Forward Get Starting_Main_Report to iRetval
40772>>>>        If (Report_View_Id(Self)) Set piIsReportCancelled Of (Report_View_Id(Self)) to 0
40775>>>>        Function_Return iRetval
40776>>>>    End_Function
40777>>>>
40777>>>>    Procedure Ending_Report
40778>>>>        Integer isCancelled
40779>>>>        Get Cancelled_State         to isCancelled
40780>>>>        //If Already with error do not touch
40780>>>>        If (Report_View_Id(Self)) Begin
40782>>>>            If (piIsReportCancelled(Report_View_Id(Self))<>1) Begin
40784>>>>                Set piIsReportCancelled Of (Report_View_ID(Self)) to (isCancelled=1)
40785>>>>                Error 9999 '€¡ç¨à©ž „¡«ç§à©žª'
40786>>>>>
40786>>>>            End
40786>>>>>
40786>>>>            Else Error 7777 '‘­á¢£˜ ¡˜«á «ž¤ œ¡«ç§à©ž'
40788>>>>        End
40788>>>>>
40788>>>>        Forward Send Ending_Report
40790>>>>    End_Procedure
40791>>>>
40791>>>>    Procedure onError integer ErrNum integer Err_Line string ErrMsg
40792>>>>        If (Display_Error_State(Self)) Send End_Status
40795>>>>        Set piIsReportCancelled Of (Report_View_ID(Self)) to 1
40796>>>>        Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
40797>>>>>
40797>>>>    End_procedure
40798>>>>
40798>>>>    Function Report_Interrupt Returns Integer
40799>>>>        Integer rVal
40800>>>>        String Mess
40800>>>>        If (Error_Check_State(Current_Object)) ;            Move "„£­˜¤å©«ž¡œ œ¤˜ ©­á¢£˜ ¡˜«˜ «ž¤ œ§œ¥œ¨š˜©å˜. Œ˜ › ˜¡¦§œå ž œ¡«ç§à©ž ?" to Mess
40803>>>>        Else   Move  "Œ˜ ˜¡¬¨é©à «ž¤ œ¡«ç§à©ž ?" to Mess
40805>>>>        Get YesNo_Box Mess "ƒ ˜¡¦§ã „§œ¥œ¨š˜©å˜ª" to rVal
40806>>>>        If (rVal=MBR_YES) Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
40809>>>>        Function_Return (Rval=MBR_YES)
40810>>>>    End_Function  // Report_Interrupt
40811>>>>
40811>>>>
40811>>>>
40811>>>>End_Class
40812>>>>
40812>>>>Class WinReportFEMSub is a WinReportSUB
40813>>>>
40813>>>>    Function Starting_Main_Report Returns Integer
40814>>>>        Integer   iRetVal iindexr14_1
40815>>>>        Forward Get Starting_Main_Report to iRetval
40817>>>>        If (Report_View_Id(Self)) Set piIsReportCancelled Of (Report_View_Id(Self)) to 0
40820>>>>        Function_Return iRetval
40821>>>>    End_Function
40822>>>>
40822>>>>    Procedure Ending_Report
40823>>>>        Integer isCancelled
40824>>>>        Get Cancelled_State         to isCancelled
40825>>>>        //If Already with error do not touch
40825>>>>        If (Report_View_Id(Self)) Begin
40827>>>>            If (piIsReportCancelled(Report_View_Id(Self))<>1) Begin
40829>>>>                Set piIsReportCancelled Of (Report_View_ID(Self)) to (isCancelled=1)
40830>>>>                Error 9999 '€¡ç¨à©ž „¡«ç§à©žª'
40831>>>>>
40831>>>>            End
40831>>>>>
40831>>>>            Else Error 7777 '‘­á¢£˜ ¡˜«á «ž¤ œ¡«ç§à©ž'
40833>>>>        End
40833>>>>>
40833>>>>        Forward Send Ending_Report
40835>>>>    End_Procedure
40836>>>>
40836>>>>    Procedure onError integer ErrNum integer Err_Line string ErrMsg
40837>>>>        If (Display_Error_State(Self)) Send End_Status
40840>>>>        Set piIsReportCancelled Of (Report_View_ID(Self)) to 1
40841>>>>        Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
40842>>>>>
40842>>>>    End_procedure  
40843>>>>
40843>>>>    Function Report_Interrupt Returns Integer
40844>>>>        Integer rVal
40845>>>>        String Mess
40845>>>>        If (Error_Check_State(Current_Object)) ;            Move "„£­˜¤å©«ž¡œ œ¤˜ ©­á¢£˜ ¡˜«˜ «ž¤ œ§œ¥œ¨š˜©å˜. Œ˜ › ˜¡¦§œå ž œ¡«ç§à©ž ?" to Mess
40848>>>>        Else   Move  "Œ˜ ˜¡¬¨é©à «ž¤ œ¡«ç§à©ž ?" to Mess
40850>>>>        Get YesNo_Box Mess "ƒ ˜¡¦§ã „§œ¥œ¨š˜©å˜ª" to rVal
40851>>>>        If (rVal=MBR_YES) Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
40854>>>>        Function_Return (Rval=MBR_YES)
40855>>>>    End_Function  // Report_Interrupt
40856>>>>
40856>>>>End_Class
40857>>>>
40857>>
40857>        
40857>        //AB-ClientStoreTopEnd
40857>
40857>        //  Include all views
40857>
40857>        //  Include all reports
40857>        Use StoixEmp2.RV                                                                    
INCLUDING FILE: STOIXEMP2.RV
40857>>>//AB/ Project StoixEmp2
40857>>>//AB/     Object prj is a Report_Project
40857>>>//AB/         Set ProjectName to "StoixEmp2"
40857>>>//AB/         Set ProjectFileName to "StoixEmp2.RV"
40857>>>//AB/         Set GenerateFileName to "NONAME"
40857>>>
40857>>>// Project Object Structure
40857>>>//   StoixEmp2 is a ReportViewSub
40857>>>//     RadioGroupSub1 is a RadioGroupSub
40857>>>//       Radio1 is a RadioSub
40857>>>//       Radio2 is a RadioSub
40857>>>//       Radio3 is a RadioSub
40857>>>//       TextBoxSub28 is a TextBoxSub
40857>>>//     GroupSub1 is a GroupSub
40857>>>//       F_CODE_APO is a FormSub
40857>>>//       TextBoxSub1 is a TextBoxSub
40857>>>//       FormSub3 is a FormSub
40857>>>//     GroupSub3 is a GroupSub
40857>>>//       TextBoxSub25 is a TextBoxSub
40857>>>//       frmYear is a FormSub
40857>>>//       TextBoxSub26 is a TextBoxSub
40857>>>//       frmMonth is a FormSub
40857>>>//       frmMonthLekt is a FormSub
40857>>>//       frmPolhths is a FormSub
40857>>>//       frmPolhthsDescr is a FormSub
40857>>>//       frmYpeyth is a FormSub
40857>>>//       frmYpeythDescr is a FormSub
40857>>>//       TextBoxSub1 is a TextBoxSub
40857>>>//       TextBoxSub2 is a TextBoxSub
40857>>>//       FormSub1 is a FormSub
40857>>>//       Textbox1 is a Textbox
40857>>>//       Form2 is a FormSub
40857>>>//       chkMhden is a CheckBoxSub
40857>>>//       chkApokripsi is a CheckBoxSub
40857>>>//     ButtonSub1 is a Button
40857>>>//       oPinakas is a Array
40857>>>//       oPinakas2 is a Array
40857>>>//       oPinHpal is a c2dArray
40857>>>//     FCP_ProgressBar1 is a FCP_ProgressBar
40857>>>//     RadioGroupSub2 is a RadioGroupSub
40857>>>//       Radio1 is a RadioSub
40857>>>//       Radio2 is a RadioSub
40857>>>//       Radio3 is a RadioSub
40857>>>//       ButtonSub1 is a ButtonSub
40857>>>//     btnMess is a ButtonSub
40857>>>//     ReportEmporias is a CrystalReportSubSQL
40857>>>//     ReportMakeMeresRecords is a CrystalReportSubSQL
40857>>>//     ReportMakeAnoixtosRecords is a CrystalReportSubSQL
40857>>>//     ReportMakeHpalRecords is a CrystalReportSubSQL
40857>>>//     ReportMakeTzirosRecords is a CrystalReport
40857>>>//     ReportMakeAxioRecords is a CrystalReport
40857>>>//     ReportMakeEisprakteaAxiografa is a CrystalReport
40857>>>//     ReportMakeOfeilhRecords is a CrystalReport
40857>>>//     ReportMakepaliaAxioRecords is a CrystalReport
40857>>>
40857>>>// Register all objects
40857>>>Register_Object ButtonSub1
40857>>>Register_Object btnMess
40857>>>Register_Object chkApokripsi
40857>>>Register_Object chkMhden
40857>>>Register_Object F_CODE_APO
40857>>>Register_Object FCP_ProgressBar1
40857>>>Register_Object Form2
40857>>>Register_Object FormSub1
40857>>>Register_Object FormSub3
40857>>>Register_Object frmMonth
40857>>>Register_Object frmMonthLekt
40857>>>Register_Object frmPolhths
40857>>>Register_Object frmPolhthsDescr
40857>>>Register_Object frmYear
40857>>>Register_Object frmYpeyth
40857>>>Register_Object frmYpeythDescr
40857>>>Register_Object GroupSub1
40857>>>Register_Object GroupSub3
40857>>>Register_Object oPinakas
40857>>>Register_Object oPinakas2
40857>>>Register_Object oPinHpal
40857>>>Register_Object Radio1
40857>>>Register_Object Radio2
40857>>>Register_Object Radio3
40857>>>Register_Object RadioGroupSub1
40857>>>Register_Object RadioGroupSub2
40857>>>Register_Object ReportEmporias
40857>>>Register_Object ReportMakeAnoixtosRecords
40857>>>Register_Object ReportMakeAxioRecords
40857>>>Register_Object ReportMakeEisprakteaAxiografa
40857>>>Register_Object ReportMakeHpalRecords
40857>>>Register_Object ReportMakeMeresRecords
40857>>>Register_Object ReportMakeOfeilhRecords
40857>>>Register_Object ReportMakepaliaAxioRecords
40857>>>Register_Object ReportMakeTzirosRecords
40857>>>Register_Object StoixEmp2
40857>>>Register_Object TextBoxSub1
40857>>>Register_Object TextBoxSub2
40857>>>Register_Object TextBoxSub25
40857>>>Register_Object TextBoxSub26
40857>>>Register_Object TextBoxSub28
40857>>>Register_Object Textbox1
40857>>>
40857>>>
40857>>>//AB/     Report View
40857>>>
40857>>>
40857>>>    //AB-StoreTopStart
40857>>>    Use dfallrpt
40857>>>    Use syscurxr.dd
INCLUDING FILE: SYSCURXR.DD
40857>>>>>//DDB-FileStart
40857>>>>>//DDB-HeaderStart
40857>>>>>
40857>>>>>// File Name : SYSCURXR.DD
40857>>>>>// Class Name: Syscurxr_DataDictionary
40857>>>>>// Revision  : 8
40857>>>>>// Version   : 2
40857>>>>>
40857>>>>>Use  Windows           // Basic Definitions
40857>>>>>Use  DataDict          // DataDictionary Class Definition
40857>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40857>>>>>
40857>>>>>Open Syscurxr
40859>>>>>
40859>>>>>//DDB-HeaderEnd
40859>>>>>
40859>>>>>Class Syscurxr_DataDictionary  is a DataDictionary_Sec
40860>>>>>
40860>>>>>    // Define_Fields:
40860>>>>>    // This procedure is used to set up all data-dictionary rules.
40860>>>>>
40860>>>>>    Procedure Define_Fields
40861>>>>>        Forward Send Define_Fields
40863>>>>>        //DDB-Generated-Code-Location
40863>>>>>        //DDB-DefineFieldStart
40863>>>>>
40863>>>>>        Set Main_File            To Syscurxr.File_Number
40864>>>>>
40864>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
40865>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
40866>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
40867>>>>>
40867>>>>>        // Field-based properties.......................
40867>>>>>
40867>>>>>        // Syscurxr.Company_Code
40867>>>>>
40867>>>>>        // Syscurxr.Branch_Code
40867>>>>>
40867>>>>>        // Syscurxr.Year_Year
40867>>>>>
40867>>>>>        // Syscurxr.Branch_Site
40867>>>>>
40867>>>>>        // Syscurxr.Year_Recr
40867>>>>>
40867>>>>>        // Syscurxr.Company_Name
40867>>>>>
40867>>>>>        // Syscurxr.Branch_Name
40867>>>>>
40867>>>>>        // Syscurxr.Year_Descr
40867>>>>>
40867>>>>>        // Syscurxr.C_Code0
40867>>>>>
40867>>>>>        // Syscurxr.C_Code00
40867>>>>>
40867>>>>>        // Syscurxr.C_Coder
40867>>>>>
40867>>>>>        // Syscurxr.Year_Xrhshfrom
40867>>>>>
40867>>>>>        // Syscurxr.Year_Xrhshto
40867>>>>>
40867>>>>>        // Syscurxr.Beto_Site
40867>>>>>
40867>>>>>        // Syscurxr.Euro_Code
40867>>>>>
40867>>>>>        //DDB-DefineFieldEnd
40867>>>>>    End_Procedure    // Define_Fields
40868>>>>>
40868>>>>>    // Field_Defaults:
40868>>>>>    // This procedure is used to establish default field values.
40868>>>>>
40868>>>>>    Procedure Field_Defaults
40869>>>>>        Forward Send Field_Defaults
40871>>>>>        //DDB-Generated-Code-Location
40871>>>>>        //DDB-FieldDefaultStart
40871>>>>>        //DDB-FieldDefaultEnd
40871>>>>>    End_Procedure    // Field_Defaults
40872>>>>>
40872>>>>>End_Class    // Syscurxr_DataDictionary
40873>>>>>//DDB-FileEnd
40873>>>    Use sl100.sl
INCLUDING FILE: SL100.SL
40873>>>>>//AB/ Project SL100:PELATES
40873>>>>>//AB/     Object prj is a Lookup_Project
40873>>>>>//AB/         Set ProjectName to "SL100:PELATES"
40873>>>>>//AB/         Set ProjectFileName to "SL100.SL"
40873>>>>>
40873>>>>>// Project Object Structure
40873>>>>>//   sl100 is a dbModalPanelSub
40873>>>>>//     Clients_DD is a DataDictionary
40873>>>>>//     oSelList is a dbListSub
40873>>>>>//     oOK_bn is a ButtonSub
40873>>>>>//     oCancel_bn is a ButtonSub
40873>>>>>//     oSearch_bn is a ButtonSub
40873>>>>>
40873>>>>>// Register all objects
40873>>>>>Register_Object Clients_DD
40873>>>>>Register_Object oCancel_bn
40873>>>>>Register_Object oOK_bn
40873>>>>>Register_Object oSearch_bn
40873>>>>>Register_Object oSelList
40873>>>>>Register_Object sl100
40873>>>>>
40873>>>>>
40873>>>>>    //AB-IgnoreStart
40873>>>>>
40873>>>>>    Use DFAllEnt.pkg
40873>>>>>    Use dbList.Sub
40873>>>>>    Use Button.Sub
40873>>>>>
40873>>>>>
40873>>>>>    Use CLIENTS.DD
INCLUDING FILE: CLIENTS.DD
40873>>>>>>>//DDB-FileStart
40873>>>>>>>//DDB-HeaderStart
40873>>>>>>>
40873>>>>>>>// File Name : CLIENTS.DD
40873>>>>>>>// Class Name: Clients_DataDictionary
40873>>>>>>>// Revision  : 234
40873>>>>>>>// Version   : 2
40873>>>>>>>
40873>>>>>>>Use  Windows           // Basic Definitions
40873>>>>>>>Use  DataDict          // DataDictionary Class Definition
40873>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40873>>>>>>>
40873>>>>>>>Open Clients
40875>>>>>>>Open Cmoves
INCLUDING FILE: CMOVES.FD
40877>>>>>>>Open Particle
INCLUDING FILE: PARTICLE.FD
40879>>>>>>>Open Cmovesa
INCLUDING FILE: CMOVESA.FD
40881>>>>>>>Open Cn
40883>>>>>>>Open Particll
INCLUDING FILE: PARTICLL.FD
40885>>>>>>>Open Clnbank
INCLUDING FILE: CLNBANK.FD
40887>>>>>>>Open Tpclient
INCLUDING FILE: TPCLIENT.FD
40889>>>>>>>Open Clorder
INCLUDING FILE: CLORDER.FD
40891>>>>>>>Open Clitem
INCLUDING FILE: CLITEM.FD
40893>>>>>>>Open Cities
40895>>>>>>>Open Areas
40897>>>>>>>Open Payresp
40899>>>>>>>Open Syscurxr
40901>>>>>>>Open Sysrecc
40903>>>>>>>Open Ptypparl
40905>>>>>>>
40905>>>>>>>//DDB-HeaderEnd
40905>>>>>>>//DDB-ValidationStart
40905>>>>>>>
40905>>>>>>>Register_Object Clients_Client_Doy_VT
40905>>>>>>>Register_Object Clients_Client_Job_VT
40905>>>>>>>Register_Object Clients_Client_Categfpa_VT
40905>>>>>>>Register_Object Clients_Client_Catjob_VT1
40905>>>>>>>Register_Object Clients_Client_Idiot_VT
40905>>>>>>>Register_Object Clients_Feregios_VT
40905>>>>>>>
40905>>>>>>>Object Clients_Client_Doy_VT  is a CodeValidationTable
40907>>>>>>>    Set Type_Value        To "DOY"
40908>>>>>>>    Set Validate_State    To FALSE
40909>>>>>>>    Set Allow_Blank_State To TRUE
40910>>>>>>>    Set Table_Title       To "ƒ.Ž.“"
40911>>>>>>>    //DDB-ValidationCustomStart
40911>>>>>>>    //DDB-ValidationCustomEnd
40911>>>>>>>End_Object   // Clients_Client_Doy_VT
40912>>>>>>>
40912>>>>>>>Object Clients_Client_Job_VT  is a CodeValidationTable
40914>>>>>>>    Set Type_Value        To "JOB"
40915>>>>>>>    Set Validate_State    To FALSE
40916>>>>>>>    Set Allow_Blank_State To TRUE
40917>>>>>>>    Set Table_Title       To "„§˜ššâ¢£˜«˜"
40918>>>>>>>    //DDB-ValidationCustomStart
40918>>>>>>>    //DDB-ValidationCustomEnd
40918>>>>>>>End_Object   // Clients_Client_Job_VT
40919>>>>>>>
40919>>>>>>>Object Clients_Client_Categfpa_VT  is a CodeValidationTable
40921>>>>>>>    Set Type_Value        To "VAT_STATUS"
40922>>>>>>>    Set Validate_State    To FALSE
40923>>>>>>>    Set Allow_Blank_State To TRUE
40924>>>>>>>    //DDB-ValidationCustomStart
40924>>>>>>>    //DDB-ValidationCustomEnd
40924>>>>>>>End_Object   // Clients_Client_Categfpa_VT
40925>>>>>>>
40925>>>>>>>Object Clients_Client_Catjob_VT1  is a CodeValidationTable
40927>>>>>>>    Set Type_Value        To "JOB"
40928>>>>>>>    Set Validate_State    To FALSE
40929>>>>>>>    Set Allow_Blank_State To TRUE
40930>>>>>>>    //DDB-ValidationCustomStart
40930>>>>>>>    //DDB-ValidationCustomEnd
40930>>>>>>>End_Object   // Clients_Client_Catjob_VT1
40931>>>>>>>
40931>>>>>>>Object Clients_Client_Idiot_VT  is a CodeValidationTable
40933>>>>>>>    Set Type_Value        To "IDIOT"
40934>>>>>>>    Set Validate_State    To FALSE
40935>>>>>>>    Set Allow_Blank_State To TRUE
40936>>>>>>>    Set Table_Title       To "€¨®œå¦ ˆ› ¦«ã«à¤"
40937>>>>>>>    //DDB-ValidationCustomStart
40937>>>>>>>    //DDB-ValidationCustomEnd
40937>>>>>>>End_Object   // Clients_Client_Idiot_VT
40938>>>>>>>
40938>>>>>>>Object Clients_Feregios_VT  is a CodeValidationTable
40940>>>>>>>    Set Type_Value        To "FEREGIOS"
40941>>>>>>>    Set Allow_Blank_State To TRUE
40942>>>>>>>    Set Table_Title       To "ƒœå¡«œª ”œ¨œšš¬æ«ž«˜ª ”¦¨âà¤"
40943>>>>>>>    //DDB-ValidationCustomStart
40943>>>>>>>    //DDB-ValidationCustomEnd
40943>>>>>>>End_Object   // Clients_Feregios_VT
40944>>>>>>>//DDB-ValidationEnd
40944>>>>>>>//DDB-SelectionStart
40944>>>>>>>//DDB/ ExternalSelectionList sl100  sl100.SL
40944>>>>>>>Register_Object sl100
40944>>>>>>>//DDB-SelectionEnd
40944>>>>>>>Open Sysfile
40946>>>>>>>open year
40948>>>>>>>
40948>>>>>>>Class Clients_DataDictionary  is a DataDictionary_Sec
40949>>>>>>>
40949>>>>>>>    Procedure Construct_Object
40950>>>>>>>        Forward Send Construct_Object
40952>>>>>>>        Property Integer piMustNOTConstrain Public 0
40953>>>>>>>        Property Integer piCheckPlaf        Public 0
40954>>>>>>>    End_Procedure
40955>>>>>>>
40955>>>>>>>    // Backout:
40955>>>>>>>    Procedure Backout
40956>>>>>>>        Forward Send Backout
40958>>>>>>>        // Insert Code Here
40958>>>>>>>    End_Procedure   // Backout
40959>>>>>>>
40959>>>>>>>
40959>>>>>>>
40959>>>>>>>    Procedure Update
40960>>>>>>>        Forward Send Update
40962>>>>>>>        // Insert Code Here
40962>>>>>>>        Move SysCurXR.Company_Code  to Clients.Company_Code
40963>>>>>>>        Move SysCurXR.Branch_Code   to Clients.Branch_Code
40964>>>>>>>        Move SysCurXR.Year_Year     to Clients.Year_Year
40965>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
40965>>>>>>>        Move (Clients.Xreosh-Clients.Pistosh)   to Clients.Ypoloipo
40966>>>>>>>        Move (Clients.Plafon-Clients.Ypoloipo)  to Clients.Overhead
40967>>>>>>>
40967>>>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
40967>>>>>>>
40967>>>>>>>        //betolink
40967>>>>>>>        Move SysCurXR.Beto_Site      to Clients.Client_SiteW
40968>>>>>>>        Move Clients.Client_Rec0     to Clients.Client_SN
40969>>>>>>>        Move Clients.Client_id       to Clients.Client_Repm
40970>>>>>>>        Move Clients.Company_Code    to Clients.CLIENT_COMPANY
40971>>>>>>>        Move Clients.Client_id       to Clients.Client_RepMatch
40972>>>>>>>     //   Move (gsfCode_Mast('JOB',Clients.Client_CatJob)) to Clients.Client_Job
40972>>>>>>>    End_Procedure   // Update
40973>>>>>>>
40973>>>>>>>
40973>>>>>>>    Procedure Creating
40974>>>>>>>        date ddate iYes
40975>>>>>>>        Forward Send Creating
40977>>>>>>>        // Insert Code Here
40977>>>>>>>
40977>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Clients.Client_Rec0))))));                                    to Clients.Client_Recr
40978>>>>>>>        Move '1'                    to Clients.Client_Active
40979>>>>>>>        get fsgCode_With_Zeroes Clients.Client_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Clients.Client_ID
40980>>>>>>>        sysdate4 ddate
40981>>>>>>>        move ddate                  to Clients.Client_Hmnia
40982>>>>>>>        clear year
40983>>>>>>>        move syscurxr.company_code  to year.company_code
40984>>>>>>>        move syscurxr.branch_code   to year.branch_code
40985>>>>>>>        move syscurxr.year_year     to year.year_year
40986>>>>>>>        find eq year by index.1
40987>>>>>>>>
40987>>>>>>>        If (found=1) begin
40989>>>>>>>            move year.clients_plafon to clients.plafon
40990>>>>>>>            move year.clients_ofeilh to clients.orio_syn_ofeilh
40991>>>>>>>        end
40991>>>>>>>>
40991>>>>>>>    End_Procedure   // Creating
40992>>>>>>>
40992>>>>>>>    Function Validate_Save  Returns Integer
40993>>>>>>>        Integer iReturnVal iCheck iYes
40994>>>>>>>        Forward Get Validate_Save  To iReturnVal
40996>>>>>>>        If (Not(iReturnVal)) Begin
40998>>>>>>>
40998>>>>>>>            If (clients.is_eksoter <> '1') begin
41000>>>>>>>                If (Clients.Is_Xondr='1') Begin
41002>>>>>>>                    If (Sysfile.Check_Afm=1) Begin
41004>>>>>>>                        Move (Check_AFM(Clients.Client_Afm)) to iCheck
41005>>>>>>>                        If (iCheck) Begin
41007>>>>>>>                                 If (iCheck=1) Move 4001 to iReturnVal
41010>>>>>>>                            Else If (iCheck=2) Move 4002 to iReturnVal
41014>>>>>>>                            Else If (iCheck=3) Move 4003 to iReturnVal
41018>>>>>>>                        End
41018>>>>>>>>
41018>>>>>>>                    End
41018>>>>>>>>
41018>>>>>>>                End
41018>>>>>>>>
41018>>>>>>>            End
41018>>>>>>>>
41018>>>>>>>
41018>>>>>>>            If (piCheckPlaf(Self)=1) Begin
41020>>>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Dap)>Clients.Plafon)) Begin
41022>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4000 Clients' to iYes
41023>>>>>>>                    If (iYes=MBR_NO) Error 4004 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž' //Move 4004 to iReturnVal
41026>>>>>>>                End
41026>>>>>>>>
41026>>>>>>>                Else If ((PayResp.Plafon<>0) And (PayResp.Plafon<=PayResp.Synolikh_Ofeilh)) Begin
41029>>>>>>>                    Get YesNo_Box 'Ž ¬§œçŸ¬¤¦ª §¢ž¨à£ãª ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž\nŒ˜ ©¬¤œ®å©à ©«ž¤ ›ž£ ¦¬¨šå˜ œšš¨˜­ãª §œ¢á«ž;' to iYes
41030>>>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
41033>>>>>>>                End
41033>>>>>>>>
41033>>>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Clients.Orio_Syn_Ofeilh)) Begin
41036>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4001 Clients' to iYes
41037>>>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
41040>>>>>>>                End
41040>>>>>>>>
41040>>>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (PayResp.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Payresp.Orio_Syn_Ofeilh)) Begin
41043>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4002 Clients' to iYes
41044>>>>>>>                    If (iYes=MBR_NO) Error 4006 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'   //Move 4006 to iReturnVal
41047>>>>>>>                End
41047>>>>>>>>
41047>>>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Parag)>Clients.Plafon)) Begin
41049>>>>>>>                    Send Info_Box '’˜ §¦©á «à¤ ž£œ¨ž©åà¤ §˜¨˜ššœ¢ é¤\n¬§œ¨™˜å¤¦¬¤ «¦ › ˜Ÿâ© £¦ ¬§æ¢¦ §¦\n™á©ž §¢˜­æ¤ «¦¬ §œ¢á«ž' '¨¦©¦®ã !!!'
41050>>>>>>>                End
41050>>>>>>>>
41050>>>>>>>            End
41050>>>>>>>>
41050>>>>>>>
41050>>>>>>>            If (iReturnVal) Begin
41052>>>>>>>                Send Operation_Not_Allowed iReturnVal
41053>>>>>>>            End
41053>>>>>>>>
41053>>>>>>>        End
41053>>>>>>>>
41053>>>>>>>        Function_Return iReturnVal
41054>>>>>>>    End_Function   // Validate_Save
41055>>>>>>>
41055>>>>>>>
41055>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
41056>>>>>>>        String lsError_Message
41057>>>>>>>
41057>>>>>>>        Case Begin
41057>>>>>>>            Case (iError_Num = 4001)
41059>>>>>>>                Move "DDC 100: Š˜¤Ÿ˜©£â¤¦ €”‹ œ¢á«ž" ;                    to lsError_Message
41060>>>>>>>              Case Break
41061>>>>>>>            Case (iError_Num = 4002)
41064>>>>>>>                Move "DDC 100: ’¦ €”‹ œ¢á«ž ›œ¤ œå¤˜  9 ¯ã­ ¦" ;                    to lsError_Message
41065>>>>>>>              Case Break
41066>>>>>>>            Case (iError_Num = 4003)
41069>>>>>>>                Move "DDC 100: €¡˜«á¢¢ž¢¦ª ®˜¨˜¡«ã¨˜ª ©«¦ €”‹ œ¢á«ž" ;                    to lsError_Message
41070>>>>>>>              Case Break
41071>>>>>>>            Case (iError_Num = 4004)
41074>>>>>>>                Move "DDC 100: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ §œ¢á«ž" ;                    to lsError_Message
41075>>>>>>>              Case Break
41076>>>>>>>            Case (iError_Num = 4005)
41079>>>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª" ;                    to lsError_Message
41080>>>>>>>              Case Break
41081>>>>>>>            Case (iError_Num = 4006)
41084>>>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª «¦¬ “§œ¬Ÿç¤¦¬" ;                    to lsError_Message
41085>>>>>>>              Case Break
41086>>>>>>>
41086>>>>>>>            Case Else
41086>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
41088>>>>>>>        Case End
41088>>>>>>>
41088>>>>>>>        Error iError_Num lsError_Message
41089>>>>>>>>
41089>>>>>>>    End_Procedure // operation_not_allowed
41090>>>>>>>
41090>>>>>>>
41090>>>>>>>    // Define_Fields:
41090>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41090>>>>>>>
41090>>>>>>>    Procedure Define_Fields
41091>>>>>>>        Forward Send Define_Fields
41093>>>>>>>        //DDB-Generated-Code-Location
41093>>>>>>>        //DDB-DefineFieldStart
41093>>>>>>>
41093>>>>>>>        Set Main_File            To Clients.File_Number
41094>>>>>>>        Set Cascade_Delete_State To FALSE
41095>>>>>>>
41095>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41096>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41097>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41098>>>>>>>
41098>>>>>>>        // Child (Client) file structure................
41098>>>>>>>        Send Add_Client_File  Cmoves.File_Number
41099>>>>>>>        Send Add_Client_File  Particle.File_Number
41100>>>>>>>        Send Add_Client_File  Cmovesa.File_Number
41101>>>>>>>        Send Add_Client_File  Cn.File_Number
41102>>>>>>>        Send Add_Client_File  Particll.File_Number
41103>>>>>>>        Send Add_Client_File  Clnbank.File_Number
41104>>>>>>>        Send Add_Client_File  Tpclient.File_Number
41105>>>>>>>        Send Add_Client_File  Clorder.File_Number
41106>>>>>>>        Send Add_Client_File  Clitem.File_Number
41107>>>>>>>
41107>>>>>>>        // Parent (Server) file structure...............
41107>>>>>>>        Send Add_Server_File  Cities.File_Number
41108>>>>>>>        Send Add_Server_File  Areas.File_Number
41109>>>>>>>        Send Add_Server_File  Payresp.File_Number
41110>>>>>>>
41110>>>>>>>        // External (System) file structure.............
41110>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
41111>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
41112>>>>>>>        Send Add_System_File  Ptypparl.File_Number  DD_LOCK_ON_ALL
41113>>>>>>>
41113>>>>>>>        Define_Auto_Increment  Sysrecc.Client_Rec0  To Clients.Client_Rec0
41116>>>>>>>
41116>>>>>>>        // Field-based properties.......................
41116>>>>>>>
41116>>>>>>>        // Clients.Company_Code
41116>>>>>>>
41116>>>>>>>        // Clients.Branch_Code
41116>>>>>>>
41116>>>>>>>        // Clients.Year_Year
41116>>>>>>>
41116>>>>>>>        // Clients.Custprom_Code
41116>>>>>>>
41116>>>>>>>        // Clients.Client_Id
41116>>>>>>>        Set Field_Options          Field Clients.Client_Id To DD_AUTOFIND    DD_NOPUT      
41117>>>>>>>        Set Field_Prompt_Object    Field Clients.Client_Id To (sl100(Self))
41118>>>>>>>        Set Key_Field_State        Field Clients.Client_Id To TRUE
41119>>>>>>>
41119>>>>>>>        // Clients.Client_Name
41119>>>>>>>        Set Field_Prompt_Object    Field Clients.Client_Name To (sl100(Self))
41120>>>>>>>
41120>>>>>>>        // Clients.Client_Afm
41120>>>>>>>        Set Field_Options          Field Clients.Client_Afm To DD_AUTOFIND   
41121>>>>>>>
41121>>>>>>>        // Clients.Client_Rec0
41121>>>>>>>        Set Field_Options          Field Clients.Client_Rec0 To DD_AUTOFIND   
41122>>>>>>>
41122>>>>>>>        // Clients.Custprom_Recr
41122>>>>>>>
41122>>>>>>>        // Clients.Client_Recr
41122>>>>>>>        Set Field_Options          Field Clients.Client_Recr To DD_AUTOFIND   
41123>>>>>>>
41123>>>>>>>        // Clients.Last_Xreosh
41123>>>>>>>
41123>>>>>>>        // Clients.Last_Pistosh
41123>>>>>>>
41123>>>>>>>        // Clients.Last_Order
41123>>>>>>>        Set Field_Class_Name       Field Clients.Last_Order To "dbComboFormSub"
41124>>>>>>>
41124>>>>>>>        // Clients.Client_Doy
41124>>>>>>>        Set Field_Value_Table      Field Clients.Client_Doy To (Clients_Client_Doy_VT(Self))
41125>>>>>>>
41125>>>>>>>        // Clients.Client_Address
41125>>>>>>>
41125>>>>>>>        // Clients.Client_City_Id
41125>>>>>>>
41125>>>>>>>        // Clients.Client_Area
41125>>>>>>>
41125>>>>>>>        // Clients.Client_Job
41125>>>>>>>        Set Field_Value_Table      Field Clients.Client_Job To (Clients_Client_Job_VT(Self))
41126>>>>>>>
41126>>>>>>>        // Clients.Client_Respons
41126>>>>>>>
41126>>>>>>>        // Clients.Client_Zipcode
41126>>>>>>>
41126>>>>>>>        // Clients.Client_Phone
41126>>>>>>>
41126>>>>>>>        // Clients.Client_Fax
41126>>>>>>>
41126>>>>>>>        // Clients.Client_Mobile
41126>>>>>>>
41126>>>>>>>        // Clients.Client_Aoh
41126>>>>>>>
41126>>>>>>>        // Clients.Client_Email
41126>>>>>>>
41126>>>>>>>        // Clients.Client_Class
41126>>>>>>>
41126>>>>>>>        // Clients.Client_Details
41126>>>>>>>
41126>>>>>>>        // Clients.Client_Sitew
41126>>>>>>>
41126>>>>>>>        // Clients.Client_Codem
41126>>>>>>>
41126>>>>>>>        // Clients.Client_Categfpa
41126>>>>>>>        Set Field_Value_Table      Field Clients.Client_Categfpa To (Clients_Client_Categfpa_VT(Self))
41127>>>>>>>
41127>>>>>>>        // Clients.Client_Fpa
41127>>>>>>>
41127>>>>>>>        // Clients.Client_Public
41127>>>>>>>
41127>>>>>>>        // Clients.Client_Sn
41127>>>>>>>
41127>>>>>>>        // Clients.Client_Repm
41127>>>>>>>
41127>>>>>>>        // Clients.Client_Active
41127>>>>>>>
41127>>>>>>>        // Clients.Client_Reported
41127>>>>>>>
41127>>>>>>>        // Clients.Client_Pelprom
41127>>>>>>>
41127>>>>>>>        // Clients.Client_Lastupd
41127>>>>>>>
41127>>>>>>>        // Clients.Client_Markexp
41127>>>>>>>
41127>>>>>>>        // Clients.Client_Catjob
41127>>>>>>>        Set Field_Value_Table      Field Clients.Client_Catjob To (Clients_Client_Catjob_VT1(Self))
41128>>>>>>>
41128>>>>>>>        // Clients.Is_Promhtheyths
41128>>>>>>>
41128>>>>>>>        // Clients.Xreosh
41128>>>>>>>
41128>>>>>>>        // Clients.Pistosh
41128>>>>>>>
41128>>>>>>>        // Clients.Ypoloipo
41128>>>>>>>
41128>>>>>>>        // Clients.Plafon
41128>>>>>>>
41128>>>>>>>        // Clients.Overhead
41128>>>>>>>
41128>>>>>>>        // Clients.Client_Company
41128>>>>>>>
41128>>>>>>>        // Clients.Client_Repmatch
41128>>>>>>>
41128>>>>>>>        // Clients.Client_Hmnia
41128>>>>>>>
41128>>>>>>>        // Clients.Client_Presp
41128>>>>>>>
41128>>>>>>>        // Clients.Client_Locked
41128>>>>>>>
41128>>>>>>>        // Clients.Synolikh_Ofeilh
41128>>>>>>>
41128>>>>>>>        // Clients.Client_Idiot
41128>>>>>>>        Set Field_Value_Table      Field Clients.Client_Idiot To (Clients_Client_Idiot_VT(Self))
41129>>>>>>>
41129>>>>>>>        // Clients.Client_Add_No
41129>>>>>>>
41129>>>>>>>        // Clients.Client_Nomos
41129>>>>>>>
41129>>>>>>>        // Clients.Client_Xora
41129>>>>>>>
41129>>>>>>>        // Clients.Polh_Recr
41129>>>>>>>
41129>>>>>>>        // Clients.Presp_Id
41129>>>>>>>
41129>>>>>>>        // Clients.Sum_Pct_Tpcl
41129>>>>>>>
41129>>>>>>>        // Clients.Is_Client
41129>>>>>>>
41129>>>>>>>        // Clients.Sysxetish
41129>>>>>>>
41129>>>>>>>        // Clients.Poso_Se_Apait
41129>>>>>>>
41129>>>>>>>        // Clients.Client_Glcode
41129>>>>>>>
41129>>>>>>>        // Clients.Is_Eksoter
41129>>>>>>>
41129>>>>>>>        // Clients.Is_Xondr
41129>>>>>>>
41129>>>>>>>        // Clients.Orio_Syn_Ofeilh
41129>>>>>>>
41129>>>>>>>        // Clients.Posa_Apo_Dap
41129>>>>>>>
41129>>>>>>>        // Clients.Client_Doybtm
41129>>>>>>>
41129>>>>>>>        // Clients.Posa_Apo_Parag
41129>>>>>>>
41129>>>>>>>        // Clients.Client_Ptyppar
41129>>>>>>>
41129>>>>>>>        // Clients.Client_Seira
41129>>>>>>>
41129>>>>>>>        // Clients.Hpso
41129>>>>>>>
41129>>>>>>>        // Clients.Hpal
41129>>>>>>>
41129>>>>>>>        // Clients.Feregios
41129>>>>>>>        Set Field_Value_Table      Field Clients.Feregios To (Clients_Feregios_VT(Self))
41130>>>>>>>
41130>>>>>>>        // Clients.Diakin
41130>>>>>>>
41130>>>>>>>        // Clients.Status
41130>>>>>>>
41130>>>>>>>        // Clients.Anal
41130>>>>>>>
41130>>>>>>>        // Clients.Endoomil
41130>>>>>>>
41130>>>>>>>        // Clients.Npdd
41130>>>>>>>
41130>>>>>>>        // Clients.Sap_Hmnia
41130>>>>>>>
41130>>>>>>>        //DDB-DefineFieldEnd
41130>>>>>>>    End_Procedure    // Define_Fields
41131>>>>>>>
41131>>>>>>>    // Field_Defaults:
41131>>>>>>>    // This procedure is used to establish default field values.
41131>>>>>>>
41131>>>>>>>    Procedure Field_Defaults
41132>>>>>>>        Forward Send Field_Defaults
41134>>>>>>>        //DDB-Generated-Code-Location
41134>>>>>>>        //DDB-FieldDefaultStart
41134>>>>>>>        Set Field_Changed_Value   Field Clients.Client_Doy To "0"
41135>>>>>>>        //DDB-FieldDefaultEnd
41135>>>>>>>    End_Procedure    // Field_Defaults
41136>>>>>>>
41136>>>>>>>End_Class    // Clients_DataDictionary
41137>>>>>>>//DDB-Selection-pkg-Start
41137>>>>>>>
41137>>>>>>>Use sl100.SL         // sl100
41137>>>>>>>
41137>>>>>>>//DDB-Selection-pkg-End
41137>>>>>>>//DDB-FileEnd
41137>>>>>    
41137>>>>>    //AB-IgnoreEnd
41137>>>>>
41137>>>>>    Object sl100 is a dbModalPanelSub
41139>>>>>
41139>>>>>        //AB-StoreTopStart
41139>>>>>                                        
41139>>>>>        Property String     FragmaClient        Public ''
41141>>>>>        Property String     psIsPromhtheyths    Public ''
41143>>>>>        Property Integer    piMustConstrain     Public  0
41145>>>>>        Property String     psModule            Public ''
41147>>>>>        
41147>>>>>        //AB-StoreTopEnd
41147>>>>>
41147>>>>>        Set Label to "(Xlate(Label(Self)))"
41148>>>>>        Set Size to 252 509
41149>>>>>        Set Location to 4 5
41150>>>>>        Set Popup_State to TRUE
41151>>>>>
41151>>>>>        //AB-DDOStart
41151>>>>>
41151>>>>>        Object Clients_DD is a Clients_DataDictionary
41153>>>>>
41153>>>>>            //AB-StoreTopStart
41153>>>>>                        
41153>>>>>            //AB-StoreTopEnd
41153>>>>>
41153>>>>>
41153>>>>>            //AB-StoreStart
41153>>>>>                        
41153>>>>>            Begin_Constraints
41155>>>>>                     If (psModule(Self)='01') BEGIN
41157>>>>>                        Constrain Clients.is_Client        Eq '1'
41159>>>>>                     end
41159>>>>>>
41159>>>>>                     Else If (psModule(Self)='02') begin
41162>>>>>                        Constrain Clients.is_Promhtheyths  Eq '1'
41164>>>>>                     end
41164>>>>>>
41164>>>>>            End_Constraints
41167>>>>>            
41167>>>>>            
41167>>>>>            
41167>>>>>            
41167>>>>>            
41167>>>>>            //AB-StoreEnd
41167>>>>>
41167>>>>>        End_Object    // Clients_DD
41168>>>>>
41168>>>>>        Set Main_DD to (Clients_DD(self))
41169>>>>>        Set Server to (Clients_DD(self))
41170>>>>>
41170>>>>>        //AB-DDOEnd
41170>>>>>
41170>>>>>        Object oSelList is a dbListSub
41172>>>>>            Set Main_File to Clients.File_Number
41173>>>>>            Set Size to 204 496
41174>>>>>            Set Location to 7 5
41175>>>>>            Set Auto_Index_State to FALSE
41176>>>>>            Set Modal_State to TRUE
41177>>>>>
41177>>>>>            Begin_Row
41180>>>>>                Entry_Item Clients.Client_id
41181>>>>>                Entry_Item Clients.Client_name
41182>>>>>                Entry_Item Clients.Client_afm
41183>>>>>                Entry_Item Clients.Last_xreosh
41184>>>>>                Entry_Item Clients.Last_pistosh
41185>>>>>                Entry_Item Clients.Last_order
41186>>>>>                Entry_Item Clients.Is_client
41187>>>>>                Entry_Item Clients.Is_promhtheyths
41188>>>>>            End_Row
41193>>>>>
41193>>>>>            Set Form_Width    item 0 to 64
41194>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
41195>>>>>            
41195>>>>>            Set Form_Width    item 1 to 133
41196>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
41197>>>>>            
41197>>>>>            Set Form_Width    item 2 to 62
41198>>>>>            Set Header_Label  item 2 to "€”‹"
41199>>>>>            
41199>>>>>            Set Form_Width    item 3 to 60
41200>>>>>            Set Header_Label  item 3 to "’œ¢. •¨âà©ž"
41201>>>>>            
41201>>>>>            Set Form_Width    item 4 to 60
41202>>>>>            Set Header_Label  item 4 to "’œ¢. å©«à©ž"
41203>>>>>            
41203>>>>>            Set Form_Width    item 5 to 60
41204>>>>>            Set Header_Label  item 5 to "’œ¢. ˜¨˜š"
41205>>>>>            
41205>>>>>            Set Form_Width    item 6 to 26
41206>>>>>            Set Header_Label  item 6 to "œ¢"
41207>>>>>            Set Column_Checkbox_State  item 6 to True
41208>>>>>            
41208>>>>>            Set Form_Width    item 7 to 26
41209>>>>>            Set Header_Label  item 7 to "¨¦£"
41210>>>>>            Set Column_Checkbox_State  item 7 to True
41211>>>>>            
41211>>>>>
41211>>>>>            //AB-StoreStart
41211>>>>>                                                
41211>>>>>            //Property String StoreFragmaClient   Public ''
41211>>>>>            //Property String StorePsModule       Public ''
41211>>>>>            
41211>>>>>            //Procedure Store_Defaults
41211>>>>>            //    Forward Send Store_Defaults
41211>>>>>            //    Set StoreFragmaClient   to (FragmaClient(Self))
41211>>>>>            //    Set StorePsModule       to (psModule    (Self))
41211>>>>>            //End_Procedure
41211>>>>>            
41211>>>>>            //Procedure ReStore_Defaults
41211>>>>>            //    Forward Send ReStore_Defaults
41211>>>>>            //    Set FragmaClient to (StoreFragmaClient(Self))
41211>>>>>            //    Set psModule     to (StorePsModule    (Self))
41211>>>>>            //End_Procedure
41211>>>>>            
41211>>>>>            Set Column_Option Item 6 to NoEnter True
41212>>>>>            Set Column_Option Item 7 to NoEnter True
41213>>>>>            
41213>>>>>            Procedure Activating
41215>>>>>                Forward Send Activating
41217>>>>>                Set Auto_Index_State to True
41218>>>>>            End_Procedure
41219>>>>>            
41219>>>>>            Procedure Activate
41221>>>>>                Send Rebuild_Constraints    to Clients_DD
41222>>>>>                If (FragmaClient(Self)<>'') Begin
41224>>>>>                    Clear Clients
41225>>>>>                    Move (FragmaClient(Self)) to Clients.Client_ID
41226>>>>>                    Find Eq Clients By Index.6
41227>>>>>>
41227>>>>>                    If (Found) Send Request_Find to Clients_DD Eq Clients.File_Number 6
41230>>>>>                End
41230>>>>>>
41230>>>>>                Forward Send Activate
41232>>>>>            End_procedure
41233>>>>>            
41233>>>>>            
41233>>>>>            
41233>>>>>            
41233>>>>>            //AB-StoreEnd
41233>>>>>
41233>>>>>        End_Object    // oSelList
41234>>>>>
41234>>>>>        Object oOK_bn is a ButtonSub
41236>>>>>            Set Label to "&„§ ¢¦šã"
41237>>>>>            Set Location to 218 341
41238>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
41239>>>>>
41239>>>>>            //AB-StoreStart
41239>>>>>            Procedure OnClick
41241>>>>>                Send OK To (oSelList(current_object))
41242>>>>>            End_Procedure
41243>>>>>            //AB-StoreEnd
41243>>>>>
41243>>>>>        End_Object    // oOK_bn
41244>>>>>
41244>>>>>        Object oCancel_bn is a ButtonSub
41246>>>>>            Set Label to "&€¡ç¨à©ž"
41247>>>>>            Set Location to 218 396
41248>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
41249>>>>>
41249>>>>>            //AB-StoreStart
41249>>>>>            Procedure OnClick
41251>>>>>                Send Cancel To (oSelList(current_object))
41252>>>>>            End_Procedure
41253>>>>>            //AB-StoreEnd
41253>>>>>
41253>>>>>        End_Object    // oCancel_bn
41254>>>>>
41254>>>>>        Object oSearch_bn is a ButtonSub
41256>>>>>            Set Label to "€&¤˜ã«ž©ž..."
41257>>>>>            Set Location to 218 451
41258>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
41259>>>>>
41259>>>>>            //AB-StoreStart
41259>>>>>            Procedure OnClick
41261>>>>>                Send Search To (oSelList(current_object))
41262>>>>>            End_Procedure
41263>>>>>            //AB-StoreEnd
41263>>>>>
41263>>>>>        End_Object    // oSearch_bn
41264>>>>>
41264>>>>>
41264>>>>>        //AB-StoreStart
41264>>>>>                                        
41264>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41265>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41266>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41267>>>>>        
41267>>>>>        Set Locate_Mode to Center_On_Screen
41268>>>>>        Set Modal_State to True
41269>>>>>        
41269>>>>>        Procedure Activating Returns Integer
41271>>>>>            Integer rVal
41272>>>>>            Forward Get Msg_Activating to rVal
41274>>>>>                 if (psmodule(self)='01') set label of sl100 to '‰˜«á¢¦š¦ª œ¢˜«é¤'
41277>>>>>            else if (psmodule(self)='02') set label of sl100 to '‰˜«á¢¦š¦ª ¨¦£žŸœ¬«é¤'
41281>>>>>            Procedure_Return rVal
41282>>>>>        End_procedure
41283>>>>>        
41283>>>>>        
41283>>>>>        
41283>>>>>        
41283>>>>>        
41283>>>>>        
41283>>>>>        
41283>>>>>        //AB-StoreEnd
41283>>>>>
41283>>>>>    End_Object    // sl100
41284>>>>>
41284>>>>>//AB/     End_Object    // prj
41284>>>    use sl007.sl
INCLUDING FILE: SL007.SL
41284>>>>>//AB/ Project Ctypkin : sl007
41284>>>>>//AB/ Object prj is a Lookup_Project
41284>>>>>//AB/     Set ProjectName to "Ctypkin : sl007"
41284>>>>>//AB/     Set ProjectFileName to "sl007.SL"
41284>>>>>//AB/     Set GenerateFileName to "NONAME"
41284>>>>>
41284>>>>>// Project Object Structure
41284>>>>>//   sl007 is a dbModalPanelSub
41284>>>>>//     Ctypkin_DD is a DataDictionary
41284>>>>>//     oSelList is a dbListSub
41284>>>>>//     oOK_bn is a ButtonSub
41284>>>>>//     oCancel_bn is a ButtonSub
41284>>>>>//     oSearch_bn is a ButtonSub
41284>>>>>
41284>>>>>// Register all objects
41284>>>>>Register_Object Ctypkin_DD
41284>>>>>Register_Object oCancel_bn
41284>>>>>Register_Object oOK_bn
41284>>>>>Register_Object oSearch_bn
41284>>>>>Register_Object oSelList
41284>>>>>Register_Object sl007
41284>>>>>
41284>>>>>
41284>>>>>//AB-IgnoreStart
41284>>>>>
41284>>>>>Use DFAllEnt.pkg
41284>>>>>Use dbList.Sub
41284>>>>>Use Button.Sub
41284>>>>>
41284>>>>>
41284>>>>>Use CTYPKIN.DD
INCLUDING FILE: CTYPKIN.DD
41284>>>>>>>//DDB-FileStart
41284>>>>>>>//DDB-HeaderStart
41284>>>>>>>
41284>>>>>>>// File Name : CTYPKIN.DD
41284>>>>>>>// Class Name: Ctypkin_DataDictionary
41284>>>>>>>// Revision  : 70
41284>>>>>>>// Version   : 2
41284>>>>>>>
41284>>>>>>>Use  Windows           // Basic Definitions
41284>>>>>>>Use  DataDict          // DataDictionary Class Definition
41284>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41284>>>>>>>
41284>>>>>>>Open Ctypkin
INCLUDING FILE: CTYPKIN.FD
41286>>>>>>>Open Cmoves
41288>>>>>>>Open Cflagkin
INCLUDING FILE: CFLAGKIN.FD
41290>>>>>>>Open Ptypparl
41292>>>>>>>Open Ptyppar
INCLUDING FILE: PTYPPAR.FD
41294>>>>>>>Open Hmctyp
INCLUDING FILE: HMCTYP.FD
41296>>>>>>>Open Cmovesa
41298>>>>>>>Open Sysrecc
41300>>>>>>>Open Syscurxr
41302>>>>>>>
41302>>>>>>>//DDB-HeaderEnd
41302>>>>>>>//DDB-ValidationStart
41302>>>>>>>
41302>>>>>>>Register_Object Ctypkin_Ctypkin_Module_VT
41302>>>>>>>
41302>>>>>>>Object Ctypkin_Ctypkin_Module_VT  is a CodeValidationTable
41304>>>>>>>    Set Type_Value        To "MODULE"
41305>>>>>>>    //DDB-ValidationCustomStart
41305>>>>>>>    //DDB-ValidationCustomEnd
41305>>>>>>>End_Object   // Ctypkin_Ctypkin_Module_VT
41306>>>>>>>//DDB-ValidationEnd
41306>>>>>>>//DDB-SelectionStart
41306>>>>>>>//DDB/ ExternalSelectionList sl007  sl007.SL
41306>>>>>>>Register_Object sl007
41306>>>>>>>//DDB-SelectionEnd
41306>>>>>>>
41306>>>>>>>Class Ctypkin_DataDictionary  is a DataDictionary
41307>>>>>>>         
41307>>>>>>>    Procedure Construct_Object
41308>>>>>>>        Forward Send Construct_Object
41310>>>>>>>        Property Integer piMustNOTConstrain Public 0
41311>>>>>>>    End_Procedure
41312>>>>>>>
41312>>>>>>>    Procedure Save_Main_File
41313>>>>>>>        If (Operation_Origin<>Self) Begin
41315>>>>>>>            If Ctypkin.Recnum Eq 0 Procedure_Return
41318>>>>>>>        End
41318>>>>>>>>
41318>>>>>>>        Forward Send Save_Main_File
41320>>>>>>>    End_Procedure
41321>>>>>>>
41321>>>>>>>     Procedure Creating
41322>>>>>>>        Forward Send Creating
41324>>>>>>>        // Insert Code Here
41324>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Ctypkin.Ctypkin_Rec0)))))) to Ctypkin.Ctypkin_Recr
41325>>>>>>>    End_Procedure   // Creating
41326>>>>>>>
41326>>>>>>>
41326>>>>>>>    // Define_Fields:
41326>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41326>>>>>>>
41326>>>>>>>    Procedure Define_Fields
41327>>>>>>>        Forward Send Define_Fields
41329>>>>>>>        //DDB-Generated-Code-Location
41329>>>>>>>        //DDB-DefineFieldStart
41329>>>>>>>
41329>>>>>>>        Set Main_File            To Ctypkin.File_Number
41330>>>>>>>        Set Cascade_Delete_State To FALSE
41331>>>>>>>
41331>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41332>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41333>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41334>>>>>>>
41334>>>>>>>        // Child (Client) file structure................
41334>>>>>>>        Send Add_Client_File  Cmoves.File_Number
41335>>>>>>>        Send Add_Client_File  Cflagkin.File_Number
41336>>>>>>>        Send Add_Client_File  Ptypparl.File_Number
41337>>>>>>>        Send Add_Client_File  Ptyppar.File_Number
41338>>>>>>>        Send Add_Client_File  Hmctyp.File_Number
41339>>>>>>>        Send Add_Client_File  Cmovesa.File_Number
41340>>>>>>>
41340>>>>>>>        // External (System) file structure.............
41340>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
41341>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
41342>>>>>>>
41342>>>>>>>        Define_Auto_Increment  Sysrecc.Ctypkin_Rec0  To Ctypkin.Ctypkin_Rec0
41345>>>>>>>
41345>>>>>>>        // Field-based properties.......................
41345>>>>>>>
41345>>>>>>>        // Ctypkin.Company_Code
41345>>>>>>>
41345>>>>>>>        // Ctypkin.Branch_Code
41345>>>>>>>
41345>>>>>>>        // Ctypkin.Year_Year
41345>>>>>>>
41345>>>>>>>        // Ctypkin.Ctypkin_Code
41345>>>>>>>        Set Field_Options          Field Ctypkin.Ctypkin_Code To DD_AUTOFIND   
41346>>>>>>>        Set Field_Prompt_Object    Field Ctypkin.Ctypkin_Code To (sl007(Self))
41347>>>>>>>        Set Key_Field_State        Field Ctypkin.Ctypkin_Code To TRUE
41348>>>>>>>
41348>>>>>>>        // Ctypkin.Ctypkin_Rec0
41348>>>>>>>
41348>>>>>>>        // Ctypkin.Ctypkin_Recr
41348>>>>>>>
41348>>>>>>>        // Ctypkin.Year_Recr
41348>>>>>>>
41348>>>>>>>        // Ctypkin.Ctypkin_Descr
41348>>>>>>>        Set Field_Prompt_Object    Field Ctypkin.Ctypkin_Descr To (sl007(Self))
41349>>>>>>>
41349>>>>>>>        // Ctypkin.Ctypkin_Anti
41349>>>>>>>
41349>>>>>>>        // Ctypkin.Ctypkin_Flags
41349>>>>>>>
41349>>>>>>>        // Ctypkin.Ctypkin_Module
41349>>>>>>>        Set Field_Value_Table      Field Ctypkin.Ctypkin_Module To (Ctypkin_Ctypkin_Module_VT(Self))
41350>>>>>>>
41350>>>>>>>        // Ctypkin.Open_Item
41350>>>>>>>
41350>>>>>>>        // Ctypkin.Check_Overhead
41350>>>>>>>
41350>>>>>>>        // Ctypkin.Max_Days_Sx_Par
41350>>>>>>>
41350>>>>>>>        // Ctypkin.Singular
41350>>>>>>>
41350>>>>>>>        // Ctypkin.Sub
41350>>>>>>>
41350>>>>>>>        // Ctypkin.Subreport
41350>>>>>>>
41350>>>>>>>        //DDB-DefineFieldEnd
41350>>>>>>>    End_Procedure    // Define_Fields
41351>>>>>>>
41351>>>>>>>    // Field_Defaults:
41351>>>>>>>    // This procedure is used to establish default field values.
41351>>>>>>>
41351>>>>>>>    Procedure Field_Defaults
41352>>>>>>>        Forward Send Field_Defaults
41354>>>>>>>        //DDB-Generated-Code-Location
41354>>>>>>>        //DDB-FieldDefaultStart
41354>>>>>>>        //DDB-FieldDefaultEnd
41354>>>>>>>    End_Procedure    // Field_Defaults
41355>>>>>>>
41355>>>>>>>End_Class    // Ctypkin_DataDictionary
41356>>>>>>>//DDB-Selection-pkg-Start
41356>>>>>>>
41356>>>>>>>Use sl007.SL         // sl007
41356>>>>>>>
41356>>>>>>>//DDB-Selection-pkg-End
41356>>>>>>>//DDB-FileEnd
41356>>>>>
41356>>>>>//AB-IgnoreEnd
41356>>>>>
41356>>>>>Object sl007 is a dbModalPanelSub
41358>>>>>
41358>>>>>    //AB-StoreTopStart
41358>>>>>    Property String psModule Public ''
41360>>>>>    
41360>>>>>    //AB-StoreTopEnd
41360>>>>>
41360>>>>>    Set Label to "‰ ¤ã©œ ª    "
41361>>>>>    Set Size to 148 350
41362>>>>>    Set Location to 4 7
41363>>>>>    Set Exit_Application_Local_State to FALSE
41364>>>>>    Set Modal_State to FALSE
41365>>>>>
41365>>>>>    //AB-DDOStart
41365>>>>>
41365>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
41367>>>>>
41367>>>>>        //AB-StoreStart
41367>>>>>                                
41367>>>>>        Begin_Constraints
41369>>>>>            If (psModule(sl007(Self))<>'') Constrain Ctypkin.Ctypkin_Module eq (psModule(sl007(Self)))
41373>>>>>        End_Constraints
41376>>>>>        
41376>>>>>        
41376>>>>>        
41376>>>>>        
41376>>>>>        //AB-StoreEnd
41376>>>>>
41376>>>>>    End_Object    // Ctypkin_DD
41377>>>>>
41377>>>>>    Set Main_DD to (Ctypkin_DD(self))
41378>>>>>    Set Server to (Ctypkin_DD(self))
41379>>>>>
41379>>>>>    //AB-DDOEnd
41379>>>>>
41379>>>>>    Object oSelList is a dbListSub
41381>>>>>        Set Main_File to Ctypkin.File_Number
41382>>>>>        Set Size to 105 335
41383>>>>>        Set Location to 6 6
41384>>>>>
41384>>>>>        Begin_Row
41387>>>>>            Entry_Item Ctypkin.Ctypkin_code
41388>>>>>            Entry_Item Ctypkin.Ctypkin_descr
41389>>>>>        End_Row
41394>>>>>
41394>>>>>        Set Form_Width    item 0 to 71
41395>>>>>        Set Header_Label  item 0 to "‰à› ¡æª ‰ ¤ã©œàª"
41396>>>>>        
41396>>>>>        Set Form_Width    item 1 to 255
41397>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã ‰ ¤ã©œàª"
41398>>>>>        
41398>>>>>
41398>>>>>        //AB-StoreStart
41398>>>>>                    
41398>>>>>                    
41398>>>>>        Procedure Activate
41400>>>>>            Forward Send Activate
41402>>>>>            Send Beginning_Of_Data to oSelList True
41403>>>>>        End_Procedure
41404>>>>>        
41404>>>>>        
41404>>>>>        
41404>>>>>        
41404>>>>>        //AB-StoreEnd
41404>>>>>
41404>>>>>    End_Object    // oSelList
41405>>>>>
41405>>>>>    Object oOK_bn is a ButtonSub
41407>>>>>        Set Label to "&„§ ¢¦šã"
41408>>>>>        Set Location to 113 171
41409>>>>>
41409>>>>>        //AB-StoreStart
41409>>>>>        Procedure OnClick
41411>>>>>            Send OK To (oSelList(current_object))
41412>>>>>        End_Procedure
41413>>>>>        //AB-StoreEnd
41413>>>>>
41413>>>>>    End_Object    // oOK_bn
41414>>>>>
41414>>>>>    Object oCancel_bn is a ButtonSub
41416>>>>>        Set Label to "&€¡ç¨à©ž"
41417>>>>>        Set Location to 113 226
41418>>>>>
41418>>>>>        //AB-StoreStart
41418>>>>>        Procedure OnClick
41420>>>>>            Send Cancel To (oSelList(current_object))
41421>>>>>        End_Procedure
41422>>>>>        //AB-StoreEnd
41422>>>>>
41422>>>>>    End_Object    // oCancel_bn
41423>>>>>
41423>>>>>    Object oSearch_bn is a ButtonSub
41425>>>>>        Set Label to "€&¤˜ã«ž©ž"
41426>>>>>        Set Location to 113 281
41427>>>>>
41427>>>>>        //AB-StoreStart
41427>>>>>        Procedure OnClick
41429>>>>>            Send Search To (oSelList(current_object))
41430>>>>>        End_Procedure
41431>>>>>        //AB-StoreEnd
41431>>>>>
41431>>>>>    End_Object    // oSearch_bn
41432>>>>>
41432>>>>>
41432>>>>>    //AB-StoreStart
41432>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41433>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41434>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41435>>>>>    
41435>>>>>    Procedure Activate Returns Integer
41437>>>>>        Integer rVal
41438>>>>>        Send Rebuild_Constraints to Ctypkin_DD
41439>>>>>        Forward Get Msg_Activate to rVal
41441>>>>>        Procedure_Return rVal
41442>>>>>    End_Procedure
41443>>>>>    
41443>>>>>    //AB-StoreEnd
41443>>>>>
41443>>>>>End_Object    // sl007
41444>>>>>
41444>>>>>//AB/ End_Object    // prj
41444>>>    open clients
41446>>>    use hmgio.sl
INCLUDING FILE: HMGIO.SL
41446>>>>>//AB/ Project Hmgio:Lookup
41446>>>>>//AB/ Object prj is a Lookup_Project
41446>>>>>//AB/     Set ProjectName to "Hmgio:Lookup"
41446>>>>>//AB/     Set ProjectFileName to "Hmgio.SL"
41446>>>>>//AB/     Set GenerateFileName to "NONAME"
41446>>>>>
41446>>>>>// Project Object Structure
41446>>>>>//   Hmgio is a dbModalPanelSub
41446>>>>>//     Hmgio_DD is a DataDictionary
41446>>>>>//     oSelList is a dbListSub
41446>>>>>//     oOK_bn is a ButtonSub
41446>>>>>//     oCancel_bn is a ButtonSub
41446>>>>>//     oSearch_bn is a ButtonSub
41446>>>>>
41446>>>>>// Register all objects
41446>>>>>Register_Object Hmgio
41446>>>>>Register_Object Hmgio_DD
41446>>>>>Register_Object oCancel_bn
41446>>>>>Register_Object oOK_bn
41446>>>>>Register_Object oSearch_bn
41446>>>>>Register_Object oSelList
41446>>>>>
41446>>>>>
41446>>>>>//AB-IgnoreStart
41446>>>>>
41446>>>>>Use DFAllEnt.pkg
41446>>>>>Use dbList.Sub
41446>>>>>Use Button.Sub
41446>>>>>
41446>>>>>
41446>>>>>Use HMGIO.DD
INCLUDING FILE: HMGIO.DD
41446>>>>>>>//DDB-FileStart
41446>>>>>>>//DDB-HeaderStart
41446>>>>>>>
41446>>>>>>>// File Name : HMGIO.DD
41446>>>>>>>// Class Name: Hmgio_DataDictionary
41446>>>>>>>// Revision  : 8
41446>>>>>>>// Version   : 2
41446>>>>>>>
41446>>>>>>>Use  Windows           // Basic Definitions
41446>>>>>>>Use  DataDict          // DataDictionary Class Definition
41446>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41446>>>>>>>
41446>>>>>>>Open Hmgio
INCLUDING FILE: HMGIO.FD
41448>>>>>>>Open Hmctyp
41450>>>>>>>Open Sysrecc
41452>>>>>>>
41452>>>>>>>//DDB-HeaderEnd
41452>>>>>>>//DDB-ValidationStart
41452>>>>>>>
41452>>>>>>>Register_Object Hmgio_Hmgio_Module_VT
41452>>>>>>>
41452>>>>>>>Object Hmgio_Hmgio_Module_VT  is a CodeValidationTable
41454>>>>>>>    Set Type_Value        To "MODULE"
41455>>>>>>>    Set Validate_State    To FALSE
41456>>>>>>>    Set Allow_Blank_State To TRUE
41457>>>>>>>    //DDB-ValidationCustomStart
41457>>>>>>>    //DDB-ValidationCustomEnd
41457>>>>>>>End_Object   // Hmgio_Hmgio_Module_VT
41458>>>>>>>//DDB-ValidationEnd
41458>>>>>>>//DDB-SelectionStart
41458>>>>>>>//DDB/ ExternalSelectionList Hmgio  Hmgio.SL
41458>>>>>>>Register_Object Hmgio
41458>>>>>>>//DDB-SelectionEnd
41458>>>>>>>
41458>>>>>>>Class Hmgio_DataDictionary  is a DataDictionary_Sec
41459>>>>>>>
41459>>>>>>>    // Define_Fields:
41459>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41459>>>>>>>
41459>>>>>>>    Procedure Define_Fields
41460>>>>>>>        Forward Send Define_Fields
41462>>>>>>>        //DDB-Generated-Code-Location
41462>>>>>>>        //DDB-DefineFieldStart
41462>>>>>>>
41462>>>>>>>        Set Main_File            To Hmgio.File_Number
41463>>>>>>>        Set Cascade_Delete_State To FALSE
41464>>>>>>>
41464>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41465>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41466>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41467>>>>>>>
41467>>>>>>>        // Child (Client) file structure................
41467>>>>>>>        Send Add_Client_File  Hmctyp.File_Number
41468>>>>>>>
41468>>>>>>>        // External (System) file structure.............
41468>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
41469>>>>>>>
41469>>>>>>>        Define_Auto_Increment  Sysrecc.Hmgio_Code  To Hmgio.Hmgio_Code
41472>>>>>>>
41472>>>>>>>        // Field-based properties.......................
41472>>>>>>>
41472>>>>>>>        // Hmgio.Hmgio_Code
41472>>>>>>>        Set Field_Options          Field Hmgio.Hmgio_Code To DD_AUTOFIND   
41473>>>>>>>        Set Field_Prompt_Object    Field Hmgio.Hmgio_Code To (Hmgio(Self))
41474>>>>>>>        Set Key_Field_State        Field Hmgio.Hmgio_Code To TRUE
41475>>>>>>>
41475>>>>>>>        // Hmgio.Hmgio_Descr
41475>>>>>>>        Set Field_Prompt_Object    Field Hmgio.Hmgio_Descr To (Hmgio(Self))
41476>>>>>>>
41476>>>>>>>        // Hmgio.Hmgio_Module
41476>>>>>>>        Set Field_Value_Table      Field Hmgio.Hmgio_Module To (Hmgio_Hmgio_Module_VT(Self))
41477>>>>>>>
41477>>>>>>>        //DDB-DefineFieldEnd
41477>>>>>>>    End_Procedure    // Define_Fields
41478>>>>>>>
41478>>>>>>>    // Field_Defaults:
41478>>>>>>>    // This procedure is used to establish default field values.
41478>>>>>>>
41478>>>>>>>    Procedure Field_Defaults
41479>>>>>>>        Forward Send Field_Defaults
41481>>>>>>>        //DDB-Generated-Code-Location
41481>>>>>>>        //DDB-FieldDefaultStart
41481>>>>>>>        //DDB-FieldDefaultEnd
41481>>>>>>>    End_Procedure    // Field_Defaults
41482>>>>>>>
41482>>>>>>>End_Class    // Hmgio_DataDictionary
41483>>>>>>>//DDB-Selection-pkg-Start
41483>>>>>>>
41483>>>>>>>Use Hmgio.SL         // Hmgio
41483>>>>>>>
41483>>>>>>>//DDB-Selection-pkg-End
41483>>>>>>>//DDB-FileEnd
41483>>>>>
41483>>>>>//AB-IgnoreEnd
41483>>>>>
41483>>>>>Object Hmgio is a dbModalPanelSub
41485>>>>>
41485>>>>>    //AB-StoreTopStart
41485>>>>>    Property String psModule Public ''
41487>>>>>    
41487>>>>>    //AB-StoreTopEnd
41487>>>>>
41487>>>>>    Set Label to "†£œ¨¦¢æš ˜"
41488>>>>>    Set Size to 200 297
41489>>>>>    Set Location to 4 5
41490>>>>>    Set Exit_Application_Local_State to FALSE
41491>>>>>    Set Modal_State to FALSE
41492>>>>>
41492>>>>>    //AB-DDOStart
41492>>>>>
41492>>>>>    Object Hmgio_DD is a Hmgio_DataDictionary
41494>>>>>
41494>>>>>        //AB-StoreStart
41494>>>>>        Function fiEggrafh_OK Returns Integer
41496>>>>>            Integer rVal
41497>>>>>            String sModule
41497>>>>>            Get psModule to sModule
41498>>>>>            If ((hmgio.Hmgio_Module=smodule) Or (hmgio.Hmgio_Module='04')) Move 1 to rVal
41501>>>>>            Function_Return rVal
41502>>>>>        End_Function
41503>>>>>        
41503>>>>>        Begin_Constraints
41505>>>>>             Constrain hmgio as (fiEggrafh_OK(Self)=1)
41506>>>>>        End_Constraints
41509>>>>>        
41509>>>>>        
41509>>>>>        
41509>>>>>        
41509>>>>>        
41509>>>>>        //AB-StoreEnd
41509>>>>>
41509>>>>>    End_Object    // Hmgio_DD
41510>>>>>
41510>>>>>    Set Main_DD to (Hmgio_DD(self))
41511>>>>>    Set Server to (Hmgio_DD(self))
41512>>>>>
41512>>>>>    //AB-DDOEnd
41512>>>>>
41512>>>>>    Object oSelList is a dbListSub
41514>>>>>        Set Main_File to Hmgio.File_Number
41515>>>>>        Set Size to 161 280
41516>>>>>        Set Location to 6 6
41517>>>>>        Set Auto_Index_State to FALSE
41518>>>>>
41518>>>>>        Begin_Row
41521>>>>>            Entry_Item Hmgio.Hmgio_code
41522>>>>>            Entry_Item Hmgio.Hmgio_descr
41523>>>>>        End_Row
41528>>>>>
41528>>>>>        Set Form_Width    item 0 to 84
41529>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
41530>>>>>        
41530>>>>>        Set Form_Width    item 1 to 188
41531>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
41532>>>>>        
41532>>>>>
41532>>>>>        //AB-StoreStart
41532>>>>>                                    
41532>>>>>        Procedure Activate
41534>>>>>            Forward Send Activate
41536>>>>>            Send Rebuild_Constraints to Hmgio_DD
41537>>>>>            Send Beginning_Of_Data to oSelList True
41538>>>>>        End_Procedure
41539>>>>>        
41539>>>>>        //AB-StoreEnd
41539>>>>>
41539>>>>>    End_Object    // oSelList
41540>>>>>
41540>>>>>    Object oOK_bn is a ButtonSub
41542>>>>>        Set Label to "&„§ ¢¦šã"
41543>>>>>        Set Location to 169 131
41544>>>>>
41544>>>>>        //AB-StoreStart
41544>>>>>        Procedure OnClick
41546>>>>>            Send OK To (oSelList(current_object))
41547>>>>>        End_Procedure
41548>>>>>        //AB-StoreEnd
41548>>>>>
41548>>>>>    End_Object    // oOK_bn
41549>>>>>
41549>>>>>    Object oCancel_bn is a ButtonSub
41551>>>>>        Set Label to "&€¡ç¨à©ž"
41552>>>>>        Set Location to 169 185
41553>>>>>
41553>>>>>        //AB-StoreStart
41553>>>>>        Procedure OnClick
41555>>>>>            Send Cancel To (oSelList(current_object))
41556>>>>>        End_Procedure
41557>>>>>        //AB-StoreEnd
41557>>>>>
41557>>>>>    End_Object    // oCancel_bn
41558>>>>>
41558>>>>>    Object oSearch_bn is a ButtonSub
41560>>>>>        Set Label to "€&¤˜ã«ž©ž"
41561>>>>>        Set Location to 169 241
41562>>>>>
41562>>>>>        //AB-StoreStart
41562>>>>>        Procedure OnClick
41564>>>>>            Send Search To (oSelList(current_object))
41565>>>>>        End_Procedure
41566>>>>>        //AB-StoreEnd
41566>>>>>
41566>>>>>    End_Object    // oSearch_bn
41567>>>>>
41567>>>>>
41567>>>>>    //AB-StoreStart
41567>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41568>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41569>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41570>>>>>    
41570>>>>>    //AB-StoreEnd
41570>>>>>
41570>>>>>End_Object    // Hmgio
41571>>>>>
41571>>>>>//AB/ End_Object    // prj
41571>>>    use slrep.sl
INCLUDING FILE: SLREP.SL
41571>>>>>//AB/ Project slrep:lista ektyposeon
41571>>>>>//AB/     Object prj is a Lookup_Project
41571>>>>>//AB/         Set ProjectName to "slrep:lista ektyposeon"
41571>>>>>//AB/         Set ProjectFileName to "slrep.SL"
41571>>>>>//AB/         Set GenerateFileName to "NONAME"
41571>>>>>
41571>>>>>// Project Object Structure
41571>>>>>//   slrep is a dbModalPanelSub
41571>>>>>//     Sysfile_DD is a DataDictionary
41571>>>>>//     Sysrep_DD is a DataDictionary
41571>>>>>//     oSelList is a dbListSub
41571>>>>>//     oOK_bn is a ButtonSub
41571>>>>>//     oCancel_bn is a ButtonSub
41571>>>>>//     oSearch_bn is a ButtonSub
41571>>>>>
41571>>>>>// Register all objects
41571>>>>>Register_Object oCancel_bn
41571>>>>>Register_Object oOK_bn
41571>>>>>Register_Object oSearch_bn
41571>>>>>Register_Object oSelList
41571>>>>>Register_Object Sysfile_DD
41571>>>>>Register_Object Sysrep_DD
41571>>>>>Register_Object slrep
41571>>>>>
41571>>>>>
41571>>>>>    //AB-IgnoreStart
41571>>>>>
41571>>>>>    Use DFAllEnt.pkg
41571>>>>>    Use dbList.Sub
41571>>>>>    Use Button.Sub
41571>>>>>
41571>>>>>
41571>>>>>    Use SYSFILE.DD
INCLUDING FILE: SYSFILE.DD
41571>>>>>>>//DDB-FileStart
41571>>>>>>>//DDB-HeaderStart
41571>>>>>>>
41571>>>>>>>// File Name : SYSFILE.DD
41571>>>>>>>// Class Name: Sysfile_DataDictionary
41571>>>>>>>// Revision  : 60
41571>>>>>>>// Version   : 2
41571>>>>>>>
41571>>>>>>>Use  Windows           // Basic Definitions
41571>>>>>>>Use  DataDict          // DataDictionary Class Definition
41571>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41571>>>>>>>
41571>>>>>>>Open Sysfile
41573>>>>>>>
41573>>>>>>>//DDB-HeaderEnd
41573>>>>>>>
41573>>>>>>>Class Sysfile_DataDictionary  is a DataDictionary_Sec
41574>>>>>>>
41574>>>>>>>    // Define_Fields:
41574>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41574>>>>>>>
41574>>>>>>>    Procedure Define_Fields
41575>>>>>>>        Forward Send Define_Fields
41577>>>>>>>        //DDB-Generated-Code-Location
41577>>>>>>>        //DDB-DefineFieldStart
41577>>>>>>>
41577>>>>>>>        Set Main_File            To Sysfile.File_Number
41578>>>>>>>
41578>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41579>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41580>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41581>>>>>>>
41581>>>>>>>        // Field-based properties.......................
41581>>>>>>>
41581>>>>>>>        // Sysfile.Company_Name
41581>>>>>>>
41581>>>>>>>        // Sysfile.Serial_Number
41581>>>>>>>
41581>>>>>>>        // Sysfile.Version_Number
41581>>>>>>>
41581>>>>>>>        // Sysfile.Can_Force_Open
41581>>>>>>>
41581>>>>>>>        // Sysfile.Use_Sql_Reports
41581>>>>>>>
41581>>>>>>>        // Sysfile.Client_Digits
41581>>>>>>>
41581>>>>>>>        // Sysfile.Use_English
41581>>>>>>>
41581>>>>>>>        // Sysfile.Over_Overhead
41581>>>>>>>
41581>>>>>>>        // Sysfile.Chk_Apothema
41581>>>>>>>
41581>>>>>>>        // Sysfile.Hm_Kleisimatos
41581>>>>>>>
41581>>>>>>>        // Sysfile.Check_Article
41581>>>>>>>
41581>>>>>>>        // Sysfile.Last_Hmnia_Ekt
41581>>>>>>>        Set Field_Mask_Type        Field Sysfile.Last_Hmnia_Ekt To MASK_DATE_WINDOW
41582>>>>>>>
41582>>>>>>>        // Sysfile.Enhm_Arxeia
41582>>>>>>>
41582>>>>>>>        // Sysfile.Dferr_Path
41582>>>>>>>
41582>>>>>>>        // Sysfile.Analytika_Dap
41582>>>>>>>
41582>>>>>>>        // Sysfile.Mhdeniko_Partl
41582>>>>>>>
41582>>>>>>>        // Sysfile.Check_Afm
41582>>>>>>>
41582>>>>>>>        // Sysfile.Enhm_Witemxt
41582>>>>>>>
41582>>>>>>>        // Sysfile.Files_Send_Path
41582>>>>>>>
41582>>>>>>>        // Sysfile.Titan
41582>>>>>>>
41582>>>>>>>        // Sysfile.Wapokat_Etoima
41582>>>>>>>
41582>>>>>>>        // Sysfile.Elleipes
41582>>>>>>>
41582>>>>>>>        // Sysfile.Mast_Elleipes
41582>>>>>>>
41582>>>>>>>        // Sysfile.Orio_Myf
41582>>>>>>>
41582>>>>>>>        // Sysfile.Enhm_Pmssxet
41582>>>>>>>
41582>>>>>>>        // Sysfile.Wapokat_Ayles
41582>>>>>>>
41582>>>>>>>        // Sysfile.Online_Logist
41582>>>>>>>        Set Field_Checkbox_Values  Field Sysfile.Online_Logist To "1"  "0"
41583>>>>>>>        Set Field_Class_Name       Field Sysfile.Online_Logist To "dbCheckBoxsub"
41584>>>>>>>
41584>>>>>>>        // Sysfile.Fpa_On_Total
41584>>>>>>>
41584>>>>>>>        // Sysfile.Ascclientid
41584>>>>>>>
41584>>>>>>>        // Sysfile.Aajob
41584>>>>>>>
41584>>>>>>>        // Sysfile.Aadoy
41584>>>>>>>
41584>>>>>>>        //DDB-DefineFieldEnd
41584>>>>>>>    End_Procedure    // Define_Fields
41585>>>>>>>
41585>>>>>>>    // Field_Defaults:
41585>>>>>>>    // This procedure is used to establish default field values.
41585>>>>>>>
41585>>>>>>>    Procedure Field_Defaults
41586>>>>>>>        Forward Send Field_Defaults
41588>>>>>>>        //DDB-Generated-Code-Location
41588>>>>>>>        //DDB-FieldDefaultStart
41588>>>>>>>        //DDB-FieldDefaultEnd
41588>>>>>>>    End_Procedure    // Field_Defaults
41589>>>>>>>
41589>>>>>>>End_Class    // Sysfile_DataDictionary
41590>>>>>>>//DDB-FileEnd
41590>>>>>    Use SYSREP.DD
INCLUDING FILE: SYSREP.DD
41590>>>>>>>//DDB-FileStart
41590>>>>>>>//DDB-HeaderStart
41590>>>>>>>
41590>>>>>>>// File Name : SYSREP.DD
41590>>>>>>>// Class Name: Sysrep_DataDictionary
41590>>>>>>>// Revision  : 11
41590>>>>>>>// Version   : 2
41590>>>>>>>
41590>>>>>>>Use  Windows           // Basic Definitions
41590>>>>>>>Use  DataDict          // DataDictionary Class Definition
41590>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41590>>>>>>>
41590>>>>>>>Open Sysrep
INCLUDING FILE: SYSREP.FD
41592>>>>>>>
41592>>>>>>>//DDB-HeaderEnd
41592>>>>>>>
41592>>>>>>>Class Sysrep_DataDictionary  is a DataDictionary_Sec
41593>>>>>>>
41593>>>>>>>    // Define_Fields:
41593>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41593>>>>>>>
41593>>>>>>>    Procedure Define_Fields
41594>>>>>>>        Forward Send Define_Fields
41596>>>>>>>        //DDB-Generated-Code-Location
41596>>>>>>>        //DDB-DefineFieldStart
41596>>>>>>>
41596>>>>>>>        Set Main_File            To Sysrep.File_Number
41597>>>>>>>        Set Cascade_Delete_State To FALSE
41598>>>>>>>
41598>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41599>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41600>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41601>>>>>>>
41601>>>>>>>        // Field-based properties.......................
41601>>>>>>>
41601>>>>>>>        // Sysrep.View
41601>>>>>>>
41601>>>>>>>        // Sysrep.Descr
41601>>>>>>>
41601>>>>>>>        // Sysrep.Name
41601>>>>>>>
41601>>>>>>>        // Sysrep.Titan
41601>>>>>>>
41601>>>>>>>        // Sysrep.Descr1
41601>>>>>>>
41601>>>>>>>        //DDB-DefineFieldEnd
41601>>>>>>>    End_Procedure    // Define_Fields
41602>>>>>>>
41602>>>>>>>    // Field_Defaults:
41602>>>>>>>    // This procedure is used to establish default field values.
41602>>>>>>>
41602>>>>>>>    Procedure Field_Defaults
41603>>>>>>>        Forward Send Field_Defaults
41605>>>>>>>        //DDB-Generated-Code-Location
41605>>>>>>>        //DDB-FieldDefaultStart
41605>>>>>>>        //DDB-FieldDefaultEnd
41605>>>>>>>    End_Procedure    // Field_Defaults
41606>>>>>>>
41606>>>>>>>End_Class    // Sysrep_DataDictionary
41607>>>>>>>//DDB-FileEnd
41607>>>>>    
41607>>>>>    //AB-IgnoreEnd
41607>>>>>
41607>>>>>    Object slrep is a dbModalPanelSub
41609>>>>>
41609>>>>>        //AB-StoreTopStart
41609>>>>>        property string pskathg public ''
41611>>>>>        //AB-StoreTopEnd
41611>>>>>
41611>>>>>        Set Label to "Šå©«˜ „¡«¬§é©œà¤"
41612>>>>>        Set Size to 148 388
41613>>>>>        Set Location to 4 5
41614>>>>>        Set Exit_Application_Local_State to FALSE
41615>>>>>        Set Modal_State to FALSE
41616>>>>>
41616>>>>>        //AB-DDOStart
41616>>>>>
41616>>>>>        Object Sysfile_DD is a Sysfile_DataDictionary
41618>>>>>        End_Object    // Sysfile_DD
41619>>>>>
41619>>>>>        Object Sysrep_DD is a Sysrep_DataDictionary
41621>>>>>
41621>>>>>            //AB-StoreStart
41621>>>>>            begin_constraints
41623>>>>>                constrain sysrep.view eq (pskathg(self))
41625>>>>>                if (sysfile.titan=1) constrain sysrep.titan eq ''
41629>>>>>            end_constraints
41632>>>>>            
41632>>>>>            
41632>>>>>            
41632>>>>>            
41632>>>>>            
41632>>>>>            //AB-StoreEnd
41632>>>>>
41632>>>>>        End_Object    // Sysrep_DD
41633>>>>>
41633>>>>>        Set Main_DD to (Sysrep_DD(self))
41634>>>>>        Set Server to (Sysrep_DD(self))
41635>>>>>
41635>>>>>        //AB-DDOEnd
41635>>>>>
41635>>>>>        Object oSelList is a dbListSub
41637>>>>>            Set Main_File to Sysrep.File_Number
41638>>>>>            Set Ordering to 1
41639>>>>>            Set Size to 105 372
41640>>>>>            Set Location to 6 6
41641>>>>>
41641>>>>>            Begin_Row
41644>>>>>                Entry_Item Sysrep.Name
41645>>>>>                Entry_Item Sysrep.Descr
41646>>>>>                Entry_Item Sysrep.Descr1
41647>>>>>            End_Row
41652>>>>>
41652>>>>>            Set Form_Width    item 0 to 101
41653>>>>>            Set Header_Label  item 0 to "Ž¤¦£˜ Report"
41654>>>>>            
41654>>>>>            Set Form_Width    item 1 to 263
41655>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã „¡«ç§à©žª"
41656>>>>>            
41656>>>>>            Set Form_Width    item 2 to 263
41657>>>>>            Set Header_Label  item 2 to "œ¨ š¨˜­ã „¡«ç§à©žª"
41658>>>>>            
41658>>>>>
41658>>>>>            //AB-StoreStart
41658>>>>>            
41658>>>>>            Set Resize_Column_State to FALSE
41659>>>>>            
41659>>>>>            //AB-StoreEnd
41659>>>>>
41659>>>>>        End_Object    // oSelList
41660>>>>>
41660>>>>>        Object oOK_bn is a ButtonSub
41662>>>>>            Set Label to "&„§ ¢¦šã"
41663>>>>>            Set Location to 113 219
41664>>>>>
41664>>>>>            //AB-StoreStart
41664>>>>>            Procedure OnClick
41666>>>>>                Send OK To (oSelList(current_object))
41667>>>>>            End_Procedure
41668>>>>>            //AB-StoreEnd
41668>>>>>
41668>>>>>        End_Object    // oOK_bn
41669>>>>>
41669>>>>>        Object oCancel_bn is a ButtonSub
41671>>>>>            Set Label to "&€¡ç¨à©ž"
41672>>>>>            Set Location to 113 273
41673>>>>>
41673>>>>>            //AB-StoreStart
41673>>>>>            Procedure OnClick
41675>>>>>                Send Cancel To (oSelList(current_object))
41676>>>>>            End_Procedure
41677>>>>>            //AB-StoreEnd
41677>>>>>
41677>>>>>        End_Object    // oCancel_bn
41678>>>>>
41678>>>>>        Object oSearch_bn is a ButtonSub
41680>>>>>            Set Label to "€&¤˜ã«ž©ž..."
41681>>>>>            Set Location to 113 329
41682>>>>>
41682>>>>>            //AB-StoreStart
41682>>>>>            Procedure OnClick
41684>>>>>                Send Search To (oSelList(current_object))
41685>>>>>            End_Procedure
41686>>>>>            //AB-StoreEnd
41686>>>>>
41686>>>>>        End_Object    // oSearch_bn
41687>>>>>
41687>>>>>
41687>>>>>        //AB-StoreStart
41687>>>>>        
41687>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41688>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41689>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41690>>>>>        
41690>>>>>        Procedure Activate
41692>>>>>            string smodule
41693>>>>>            Forward Send Activate
41695>>>>>            Get psMenuModule  Of Main_Menu  to sModule
41696>>>>>            if (smodule = '02') begin
41698>>>>>                Set Form_Width      Of oSelList Item 1  to 0
41699>>>>>                Set Column_Option   Of oSelList Item 1  to NoEnter True
41700>>>>>                Set Form_Width      Of oSelList Item 2  to 263
41701>>>>>            end
41701>>>>>>
41701>>>>>            else begin
41702>>>>>                Set Form_Width      Of oSelList Item 2 to 0
41703>>>>>                Set Column_Option   Of oSelList Item 2 to NoEnter True
41704>>>>>                Set Form_Width      Of oSelList Item 1 to 263
41705>>>>>            end
41705>>>>>>
41705>>>>>            Send Rebuild_Constraints to sysrep_DD
41706>>>>>            Send Beginning_Of_Data to oSelList True
41707>>>>>        End_Procedure
41708>>>>>        
41708>>>>>        
41708>>>>>        
41708>>>>>        
41708>>>>>        
41708>>>>>        
41708>>>>>        
41708>>>>>        
41708>>>>>        
41708>>>>>        
41708>>>>>        //AB-StoreEnd
41708>>>>>
41708>>>>>    End_Object    // slrep
41709>>>>>
41709>>>>>//AB/     End_Object    // prj
41709>>>    open sysrep
41711>>>    Use sl111.sl
INCLUDING FILE: SL111.SL
41711>>>>>//AB/ Project sl111
41711>>>>>//AB/ Object prj is a Lookup_Project
41711>>>>>//AB/     Set ProjectName to "sl111"
41711>>>>>//AB/     Set ProjectFileName to "sl111.SL"
41711>>>>>//AB/     Set GenerateFileName to "NONAME"
41711>>>>>
41711>>>>>// Project Object Structure
41711>>>>>//   sl111 is a dbModalPanelSub
41711>>>>>//     Payresp_DD is a DataDictionary
41711>>>>>//     oSelList is a dbListSub
41711>>>>>//     oOK_bn is a ButtonSub
41711>>>>>//     oCancel_bn is a ButtonSub
41711>>>>>//     oSearch_bn is a ButtonSub
41711>>>>>
41711>>>>>// Register all objects
41711>>>>>Register_Object oCancel_bn
41711>>>>>Register_Object oOK_bn
41711>>>>>Register_Object oSearch_bn
41711>>>>>Register_Object oSelList
41711>>>>>Register_Object Payresp_DD
41711>>>>>Register_Object sl111
41711>>>>>
41711>>>>>
41711>>>>>//AB-IgnoreStart
41711>>>>>
41711>>>>>Use DFAllEnt.pkg
41711>>>>>Use dbList.Sub
41711>>>>>Use Button.Sub
41711>>>>>
41711>>>>>
41711>>>>>Use PAYRESP.DD
INCLUDING FILE: PAYRESP.DD
41711>>>>>>>//DDB-FileStart
41711>>>>>>>//DDB-HeaderStart
41711>>>>>>>
41711>>>>>>>// File Name : PAYRESP.DD
41711>>>>>>>// Class Name: Payresp_DataDictionary
41711>>>>>>>// Revision  : 78
41711>>>>>>>// Version   : 2
41711>>>>>>>
41711>>>>>>>Use  Windows           // Basic Definitions
41711>>>>>>>Use  DataDict          // DataDictionary Class Definition
41711>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41711>>>>>>>
41711>>>>>>>Open Payresp
41713>>>>>>>Open Prspbank
INCLUDING FILE: PRSPBANK.FD
41715>>>>>>>Open Tppresp
INCLUDING FILE: TPPRESP.FD
41717>>>>>>>Open Clients
41719>>>>>>>Open Sysrecc
41721>>>>>>>
41721>>>>>>>//DDB-HeaderEnd
41721>>>>>>>//DDB-ValidationStart
41721>>>>>>>
41721>>>>>>>Register_Object Payresp_Presp_Doy_VT
41721>>>>>>>Register_Object Payresp_Presp_Categfpa_VT
41721>>>>>>>Register_Object Payresp_Feregios_VT
41721>>>>>>>
41721>>>>>>>Object Payresp_Presp_Doy_VT  is a CodeValidationTable
41723>>>>>>>    Set Type_Value        To "DOY"
41724>>>>>>>    Set Allow_Blank_State To TRUE
41725>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
41726>>>>>>>    //DDB-ValidationCustomStart
41726>>>>>>>    //DDB-ValidationCustomEnd
41726>>>>>>>End_Object   // Payresp_Presp_Doy_VT
41727>>>>>>>
41727>>>>>>>Object Payresp_Presp_Categfpa_VT  is a CodeValidationTable
41729>>>>>>>    Set Type_Value        To "VAT_STATUS"
41730>>>>>>>    Set Validate_State    To FALSE
41731>>>>>>>    Set Allow_Blank_State To TRUE
41732>>>>>>>    //DDB-ValidationCustomStart
41732>>>>>>>    //DDB-ValidationCustomEnd
41732>>>>>>>End_Object   // Payresp_Presp_Categfpa_VT
41733>>>>>>>
41733>>>>>>>Object Payresp_Feregios_VT  is a CodeValidationTable
41735>>>>>>>    Set Type_Value        To "FEREGIOS"
41736>>>>>>>    Set Allow_Blank_State To TRUE
41737>>>>>>>    Set Table_Title       To "ƒœå¡«œª ”œ¨œšš¬æ«ž«˜ª ”¦¨âà¤"
41738>>>>>>>    //DDB-ValidationCustomStart
41738>>>>>>>    //DDB-ValidationCustomEnd
41738>>>>>>>End_Object   // Payresp_Feregios_VT
41739>>>>>>>//DDB-ValidationEnd
41739>>>>>>>//DDB-SelectionStart
41739>>>>>>>//DDB/ ExternalSelectionList sl111  sl111.SL
41739>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
41739>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
41739>>>>>>>Register_Object sl111
41739>>>>>>>Register_Object sl198
41739>>>>>>>Register_Object sl197
41739>>>>>>>//DDB-SelectionEnd
41739>>>>>>>
41739>>>>>>>Open Year      
41741>>>>>>>
41741>>>>>>>Class Payresp_DataDictionary  is a DataDictionary_Sec
41742>>>>>>>
41742>>>>>>>    Procedure Construct_Object
41743>>>>>>>        Forward Send Construct_Object
41745>>>>>>>        Property Integer piCheckPlaf        Public 0
41746>>>>>>>    End_procedure
41747>>>>>>>
41747>>>>>>>    Procedure Update
41748>>>>>>>        Forward Send Update
41750>>>>>>>        Move SysCurXR.Company_Code  to payresp.Company_Code
41751>>>>>>>        Move SysCurXR.Branch_Code   to payresp.Branch_Code
41752>>>>>>>        Move SysCurXR.Year_Year     to payresp.Year_Year
41753>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
41753>>>>>>>        Move (payresp.Xreosh-payresp.Pistosh)   to payresp.Ypoloipo
41754>>>>>>>        Move (payresp.Plafon-payresp.ypoloipo)  to payresp.Overhead
41755>>>>>>>
41755>>>>>>>        //betolink
41755>>>>>>>        Move SysCurXR.Beto_Site      to payresp.presp_SiteW
41756>>>>>>>        Move payresp.presp_Rec0      to payresp.presp_SN
41757>>>>>>>        Move payresp.presp_id        to payresp.presp_Repm
41758>>>>>>>
41758>>>>>>>    End_Procedure   // Update
41759>>>>>>>
41759>>>>>>>     Procedure Creating
41760>>>>>>>        Forward Send Creating
41762>>>>>>>        // Insert Code Here
41762>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(payresp.presp_Rec0))))));                                    to payresp.presp_Recr
41763>>>>>>>        Move '1'                    to payresp.presp_Active
41764>>>>>>>        get fsgCode_With_Zeroes payresp.presp_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to payresp.presp_ID
41765>>>>>>>        clear year
41766>>>>>>>        move syscurxr.branch_code   to year.branch_code
41767>>>>>>>        move syscurxr.company_code  to year.company_code
41768>>>>>>>        move syscurxr.year_year     to YEAR.year_year
41769>>>>>>>        find eq year by index.1
41770>>>>>>>>
41770>>>>>>>        if (found=1) begin
41772>>>>>>>            move year.payresp_plafon to payresp.plafon
41773>>>>>>>            move year.payresp_ofeilh to payresp.orio_syn_ofeilh
41774>>>>>>>        end
41774>>>>>>>>
41774>>>>>>>    End_Procedure   // Creating
41775>>>>>>>
41775>>>>>>>   Function Validate_Save  Returns Integer
41776>>>>>>>        Integer iReturnVal iCheck iYes
41777>>>>>>>        Forward Get Validate_Save  To iReturnVal
41779>>>>>>>        If (Not(iReturnVal)) Begin
41781>>>>>>>
41781>>>>>>>            If (Sysfile.Check_Afm=1) Begin
41783>>>>>>>                Move (Check_AFM(payresp.presp_Afm)) to iCheck
41784>>>>>>>                If (iCheck) Begin
41786>>>>>>>                         If (iCheck=1) Move 4001 to iReturnVal
41789>>>>>>>                    Else If (iCheck=2) Move 4002 to iReturnVal
41793>>>>>>>                    Else If (iCheck=3) Move 4003 to iReturnVal
41797>>>>>>>                End
41797>>>>>>>>
41797>>>>>>>            End
41797>>>>>>>>
41797>>>>>>>
41797>>>>>>>           If (piCheckPlaf(Self)=1) Begin
41799>>>>>>>                If ((PayResp.Plafon>0) And ((PayResp.Ypoloipo+PayResp.Posa_Apo_Dap)>PayResp.Plafon)) Begin
41801>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 5000 Payresp'  to iYes
41802>>>>>>>                        If (iYes=MBR_NO) Error 4004 'DDC111: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4004 to iReturnVal
41805>>>>>>>                End
41805>>>>>>>>
41805>>>>>>>                Else If ((PayResp.Orio_Syn_Ofeilh>0) And (PayResp.Synolikh_Ofeilh>PayResp.Orio_Syn_Ofeilh)) Begin
41808>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 5001 Payresp' to iYes
41809>>>>>>>                        If (iYes=MBR_NO) Error 4005 'DDC111: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
41812>>>>>>>                End
41812>>>>>>>>
41812>>>>>>>           End
41812>>>>>>>>
41812>>>>>>>        If (iReturnVal) Send Operation_Not_Allowed iReturnVal
41815>>>>>>>        End
41815>>>>>>>>
41815>>>>>>>        Function_Return iReturnVal
41816>>>>>>>    End_Function   // Validate_Save
41817>>>>>>>
41817>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
41818>>>>>>>        String lsError_Message
41819>>>>>>>        Case Begin
41819>>>>>>>            Case (iError_Num = 4001)
41821>>>>>>>                Move "DDC 100: Š˜¤Ÿ˜©£â¤¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤" to lsError_Message
41822>>>>>>>              Case Break
41823>>>>>>>            Case (iError_Num = 4002)
41826>>>>>>>                Move "DDC 100: ’¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤ ›œ¤ œå¤˜  9 ¯ã­ ¦" to lsError_Message
41827>>>>>>>              Case Break
41828>>>>>>>            Case (iError_Num = 4003)
41831>>>>>>>                Move "DDC 100: €¡˜«á¢¢ž¢¦ª ®˜¨˜¡«ã¨˜ª ©«¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤ " to lsError_Message
41832>>>>>>>              Case Break
41833>>>>>>>            Case (iError_Num = 4004)
41836>>>>>>>                Move "DDC 100: „š ¤œ ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç" to lsError_Message
41837>>>>>>>              Case Break
41838>>>>>>>            Case (iError_Num = 4005)
41841>>>>>>>                Move "DDC 100: „š ¤œ ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª" to lsError_Message
41842>>>>>>>              Case Break
41843>>>>>>>            Case Else
41843>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
41845>>>>>>>        Case End
41845>>>>>>>        Error iError_Num lsError_Message
41846>>>>>>>>
41846>>>>>>>    End_Procedure // operation_not_allowed
41847>>>>>>>
41847>>>>>>>
41847>>>>>>>
41847>>>>>>>    Procedure Define_Fields
41848>>>>>>>        Forward Send Define_Fields
41850>>>>>>>        //DDB-Generated-Code-Location
41850>>>>>>>        //DDB-DefineFieldStart
41850>>>>>>>
41850>>>>>>>        Set Main_File            To Payresp.File_Number
41851>>>>>>>        Set Cascade_Delete_State To FALSE
41852>>>>>>>
41852>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41853>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41854>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41855>>>>>>>
41855>>>>>>>        // Child (Client) file structure................
41855>>>>>>>        Send Add_Client_File  Prspbank.File_Number
41856>>>>>>>        Send Add_Client_File  Tppresp.File_Number
41857>>>>>>>        Send Add_Client_File  Clients.File_Number
41858>>>>>>>
41858>>>>>>>        // External (System) file structure.............
41858>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
41859>>>>>>>
41859>>>>>>>        Define_Auto_Increment  Sysrecc.Payresp_Rec0  To Payresp.Presp_Rec0
41862>>>>>>>
41862>>>>>>>        // Field-based properties.......................
41862>>>>>>>
41862>>>>>>>        // Payresp.Company_Code
41862>>>>>>>
41862>>>>>>>        // Payresp.Branch_Code
41862>>>>>>>
41862>>>>>>>        // Payresp.Year_Year
41862>>>>>>>
41862>>>>>>>        // Payresp.Custprom_Code
41862>>>>>>>
41862>>>>>>>        // Payresp.Presp_Id
41862>>>>>>>        Set Field_Options          Field Payresp.Presp_Id To DD_AUTOFIND    DD_NOPUT      
41863>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Id To (sl111(Self))
41864>>>>>>>        Set Key_Field_State        Field Payresp.Presp_Id To TRUE
41865>>>>>>>
41865>>>>>>>        // Payresp.Presp_Name
41865>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Name To (sl111(Self))
41866>>>>>>>
41866>>>>>>>        // Payresp.Presp_Afm
41866>>>>>>>
41866>>>>>>>        // Payresp.Presp_Rec0
41866>>>>>>>
41866>>>>>>>        // Payresp.Custprom_Recr
41866>>>>>>>
41866>>>>>>>        // Payresp.Presp_Recr
41866>>>>>>>
41866>>>>>>>        // Payresp.Last_Xreosh
41866>>>>>>>
41866>>>>>>>        // Payresp.Last_Pistosh
41866>>>>>>>
41866>>>>>>>        // Payresp.Last_Order
41866>>>>>>>
41866>>>>>>>        // Payresp.Presp_Doy
41866>>>>>>>        Set Field_Value_Table      Field Payresp.Presp_Doy To (Payresp_Presp_Doy_VT(Self))
41867>>>>>>>
41867>>>>>>>        // Payresp.Presp_Address
41867>>>>>>>
41867>>>>>>>        // Payresp.Presp_City_Id
41867>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_City_Id To (sl198(Self))
41868>>>>>>>
41868>>>>>>>        // Payresp.Presp_Area
41868>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Area To (sl197(Self))
41869>>>>>>>
41869>>>>>>>        // Payresp.Presp_Job
41869>>>>>>>
41869>>>>>>>        // Payresp.Presp_Respons
41869>>>>>>>
41869>>>>>>>        // Payresp.Presp_Zipcode
41869>>>>>>>
41869>>>>>>>        // Payresp.Presp_Phone
41869>>>>>>>
41869>>>>>>>        // Payresp.Presp_Fax
41869>>>>>>>
41869>>>>>>>        // Payresp.Presp_Mobile
41869>>>>>>>
41869>>>>>>>        // Payresp.Presp_Aoh
41869>>>>>>>
41869>>>>>>>        // Payresp.Presp_Email
41869>>>>>>>
41869>>>>>>>        // Payresp.Presp_Class
41869>>>>>>>
41869>>>>>>>        // Payresp.Presp_Details
41869>>>>>>>
41869>>>>>>>        // Payresp.Presp_Sitew
41869>>>>>>>
41869>>>>>>>        // Payresp.Presp_Codem
41869>>>>>>>
41869>>>>>>>        // Payresp.Presp_Categfpa
41869>>>>>>>        Set Field_Value_Table      Field Payresp.Presp_Categfpa To (Payresp_Presp_Categfpa_VT(Self))
41870>>>>>>>
41870>>>>>>>        // Payresp.Presp_Fpa
41870>>>>>>>
41870>>>>>>>        // Payresp.Presp_Public
41870>>>>>>>
41870>>>>>>>        // Payresp.Presp_Sn
41870>>>>>>>
41870>>>>>>>        // Payresp.Presp_Repm
41870>>>>>>>
41870>>>>>>>        // Payresp.Presp_Active
41870>>>>>>>
41870>>>>>>>        // Payresp.Presp_Reported
41870>>>>>>>
41870>>>>>>>        // Payresp.Presp_Pelprom
41870>>>>>>>
41870>>>>>>>        // Payresp.Presp_Lastupd
41870>>>>>>>
41870>>>>>>>        // Payresp.Presp_Markexp
41870>>>>>>>
41870>>>>>>>        // Payresp.Presp_Catjob
41870>>>>>>>
41870>>>>>>>        // Payresp.Is_Promhtheyths
41870>>>>>>>
41870>>>>>>>        // Payresp.Xreosh
41870>>>>>>>
41870>>>>>>>        // Payresp.Pistosh
41870>>>>>>>
41870>>>>>>>        // Payresp.Ypoloipo
41870>>>>>>>
41870>>>>>>>        // Payresp.Plafon
41870>>>>>>>
41870>>>>>>>        // Payresp.Overhead
41870>>>>>>>
41870>>>>>>>        // Payresp.Presp_Add_No
41870>>>>>>>
41870>>>>>>>        // Payresp.Presp_Nomos
41870>>>>>>>
41870>>>>>>>        // Payresp.Presp_Xora
41870>>>>>>>
41870>>>>>>>        // Payresp.Polh_Recr
41870>>>>>>>
41870>>>>>>>        // Payresp.Synolikh_Ofeilh
41870>>>>>>>
41870>>>>>>>        // Payresp.Stoxos_Ipal
41870>>>>>>>
41870>>>>>>>        // Payresp.Stoxos_Ipso
41870>>>>>>>
41870>>>>>>>        // Payresp.Poso_Se_Apait
41870>>>>>>>
41870>>>>>>>        // Payresp.Orio_Syn_Ofeilh
41870>>>>>>>
41870>>>>>>>        // Payresp.Posa_Apo_Dap
41870>>>>>>>
41870>>>>>>>        // Payresp.Feregios
41870>>>>>>>        Set Field_Value_Table      Field Payresp.Feregios To (Payresp_Feregios_VT(Self))
41871>>>>>>>
41871>>>>>>>        //DDB-DefineFieldEnd
41871>>>>>>>    End_Procedure    // Define_Fields
41872>>>>>>>
41872>>>>>>>    // Field_Defaults:
41872>>>>>>>    // This procedure is used to establish default field values.
41872>>>>>>>
41872>>>>>>>    Procedure Field_Defaults
41873>>>>>>>        Forward Send Field_Defaults
41875>>>>>>>        //DDB-Generated-Code-Location
41875>>>>>>>        //DDB-FieldDefaultStart
41875>>>>>>>        Set Field_Changed_Value   Field Payresp.Presp_Doy To "0"
41876>>>>>>>        //DDB-FieldDefaultEnd
41876>>>>>>>    End_Procedure    // Field_Defaults
41877>>>>>>>
41877>>>>>>>End_Class    // Payresp_DataDictionary
41878>>>>>>>//DDB-Selection-pkg-Start
41878>>>>>>>
41878>>>>>>>Use sl111.SL         // sl111
41878>>>>>>>Use sl198.sl         // sl198
INCLUDING FILE: SL198.SL
41878>>>>>>>>>//AB/ Project sl198:cities
41878>>>>>>>>>//AB/ Object prj is a Lookup_Project
41878>>>>>>>>>//AB/     Set ProjectName to "sl198:cities"
41878>>>>>>>>>//AB/     Set ProjectFileName to "sl198.SL"
41878>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
41878>>>>>>>>>
41878>>>>>>>>>// Project Object Structure
41878>>>>>>>>>//   sl198 is a dbModalPanelSub
41878>>>>>>>>>//     Cities_DD is a DataDictionary
41878>>>>>>>>>//     oSelList is a dbListSub
41878>>>>>>>>>//     oOK_bn is a ButtonSub
41878>>>>>>>>>//     oCancel_bn is a ButtonSub
41878>>>>>>>>>//     oSearch_bn is a ButtonSub
41878>>>>>>>>>
41878>>>>>>>>>// Register all objects
41878>>>>>>>>>Register_Object Cities_DD
41878>>>>>>>>>Register_Object oCancel_bn
41878>>>>>>>>>Register_Object oOK_bn
41878>>>>>>>>>Register_Object oSearch_bn
41878>>>>>>>>>Register_Object oSelList
41878>>>>>>>>>Register_Object sl198
41878>>>>>>>>>
41878>>>>>>>>>
41878>>>>>>>>>//AB-IgnoreStart
41878>>>>>>>>>
41878>>>>>>>>>Use DFAllEnt.pkg
41878>>>>>>>>>Use dbList.Sub
41878>>>>>>>>>Use Button.Sub
41878>>>>>>>>>
41878>>>>>>>>>
41878>>>>>>>>>Use CITIES.DD
INCLUDING FILE: CITIES.DD
41878>>>>>>>>>>>//DDB-FileStart
41878>>>>>>>>>>>//DDB-HeaderStart
41878>>>>>>>>>>>
41878>>>>>>>>>>>// File Name : CITIES.DD
41878>>>>>>>>>>>// Class Name: Cities_DataDictionary
41878>>>>>>>>>>>// Revision  : 14
41878>>>>>>>>>>>// Version   : 2
41878>>>>>>>>>>>
41878>>>>>>>>>>>Use  Windows           // Basic Definitions
41878>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41878>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41878>>>>>>>>>>>
41878>>>>>>>>>>>Open Cities
41880>>>>>>>>>>>Open Clients
41882>>>>>>>>>>>Open Towns
41884>>>>>>>>>>>
41884>>>>>>>>>>>//DDB-HeaderEnd
41884>>>>>>>>>>>//DDB-SelectionStart
41884>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.SL
41884>>>>>>>>>>>Register_Object sl198
41884>>>>>>>>>>>//DDB-SelectionEnd
41884>>>>>>>>>>>
41884>>>>>>>>>>>Class Cities_DataDictionary  is a DataDictionary_Sec
41885>>>>>>>>>>>
41885>>>>>>>>>>>    // Define_Fields:
41885>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41885>>>>>>>>>>>
41885>>>>>>>>>>>    Procedure Define_Fields
41886>>>>>>>>>>>        Forward Send Define_Fields
41888>>>>>>>>>>>        //DDB-Generated-Code-Location
41888>>>>>>>>>>>        //DDB-DefineFieldStart
41888>>>>>>>>>>>
41888>>>>>>>>>>>        Set Main_File            To Cities.File_Number
41889>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
41890>>>>>>>>>>>
41890>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41891>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41892>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41893>>>>>>>>>>>
41893>>>>>>>>>>>        // Child (Client) file structure................
41893>>>>>>>>>>>        Send Add_Client_File  Clients.File_Number
41894>>>>>>>>>>>
41894>>>>>>>>>>>        // Parent (Server) file structure...............
41894>>>>>>>>>>>        Send Add_Server_File  Towns.File_Number
41895>>>>>>>>>>>
41895>>>>>>>>>>>        // Field-based properties.......................
41895>>>>>>>>>>>
41895>>>>>>>>>>>        // Cities.City_Id
41895>>>>>>>>>>>        Set Field_Options          Field Cities.City_Id To DD_AUTOFIND   
41896>>>>>>>>>>>        Set Field_Prompt_Object    Field Cities.City_Id To (sl198(Self))
41897>>>>>>>>>>>        Set Key_Field_State        Field Cities.City_Id To TRUE
41898>>>>>>>>>>>
41898>>>>>>>>>>>        // Cities.City_Descr
41898>>>>>>>>>>>        Set Field_Prompt_Object    Field Cities.City_Descr To (sl198(Self))
41899>>>>>>>>>>>
41899>>>>>>>>>>>        // Cities.Town_Id
41899>>>>>>>>>>>
41899>>>>>>>>>>>        //DDB-DefineFieldEnd
41899>>>>>>>>>>>    End_Procedure    // Define_Fields
41900>>>>>>>>>>>
41900>>>>>>>>>>>    // Field_Defaults:
41900>>>>>>>>>>>    // This procedure is used to establish default field values.
41900>>>>>>>>>>>
41900>>>>>>>>>>>    Procedure Field_Defaults
41901>>>>>>>>>>>        Forward Send Field_Defaults
41903>>>>>>>>>>>        //DDB-Generated-Code-Location
41903>>>>>>>>>>>        //DDB-FieldDefaultStart
41903>>>>>>>>>>>        //DDB-FieldDefaultEnd
41903>>>>>>>>>>>    End_Procedure    // Field_Defaults
41904>>>>>>>>>>>
41904>>>>>>>>>>>End_Class    // Cities_DataDictionary
41905>>>>>>>>>>>//DDB-Selection-pkg-Start
41905>>>>>>>>>>>
41905>>>>>>>>>>>Use sl198.SL         // sl198
41905>>>>>>>>>>>
41905>>>>>>>>>>>//DDB-Selection-pkg-End
41905>>>>>>>>>>>//DDB-FileEnd
41905>>>>>>>>>
41905>>>>>>>>>//AB-IgnoreEnd
41905>>>>>>>>>
41905>>>>>>>>>Object sl198 is a dbModalPanelSub
41907>>>>>>>>>    Set Label to "€¨®œå¦ æ¢œà¤"
41908>>>>>>>>>    Set Size to 148 297
41909>>>>>>>>>    Set Location to 4 5
41910>>>>>>>>>    Set Exit_Application_Local_State to FALSE
41911>>>>>>>>>    Set Modal_State to FALSE
41912>>>>>>>>>
41912>>>>>>>>>    //AB-DDOStart
41912>>>>>>>>>
41912>>>>>>>>>    Object Cities_DD is a Cities_DataDictionary
41914>>>>>>>>>
41914>>>>>>>>>        //AB-StoreStart
41914>>>>>>>>>                
41914>>>>>>>>>                
41914>>>>>>>>>        //AB-StoreEnd
41914>>>>>>>>>
41914>>>>>>>>>    End_Object    // Cities_DD
41915>>>>>>>>>
41915>>>>>>>>>    Set Main_DD to (Cities_DD(self))
41916>>>>>>>>>    Set Server to (Cities_DD(self))
41917>>>>>>>>>
41917>>>>>>>>>    //AB-DDOEnd
41917>>>>>>>>>
41917>>>>>>>>>    Object oSelList is a dbListSub
41919>>>>>>>>>        Set Main_File to Cities.File_Number
41920>>>>>>>>>        Set Size to 105 280
41921>>>>>>>>>        Set Location to 6 6
41922>>>>>>>>>
41922>>>>>>>>>        Begin_Row
41925>>>>>>>>>            Entry_Item Cities.City_id
41926>>>>>>>>>            Entry_Item Cities.City_descr
41927>>>>>>>>>        End_Row
41932>>>>>>>>>
41932>>>>>>>>>        Set Form_Width    item 0 to 50
41933>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
41934>>>>>>>>>        
41934>>>>>>>>>        Set Form_Width    item 1 to 221
41935>>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
41936>>>>>>>>>        
41936>>>>>>>>>
41936>>>>>>>>>        //AB-StoreStart
41936>>>>>>>>>        
41936>>>>>>>>>        Set Column_Option Item 0 to NoEnter True
41937>>>>>>>>>        
41937>>>>>>>>>        
41937>>>>>>>>>        
41937>>>>>>>>>        
41937>>>>>>>>>        
41937>>>>>>>>>        //AB-StoreEnd
41937>>>>>>>>>
41937>>>>>>>>>    End_Object    // oSelList
41938>>>>>>>>>
41938>>>>>>>>>    Object oOK_bn is a ButtonSub
41940>>>>>>>>>        Set Label to "&„§ ¢¦šã"
41941>>>>>>>>>        Set Location to 115 126
41942>>>>>>>>>
41942>>>>>>>>>        //AB-StoreStart
41942>>>>>>>>>        Procedure OnClick
41944>>>>>>>>>            Send OK To (oSelList(current_object))
41945>>>>>>>>>        End_Procedure
41946>>>>>>>>>        //AB-StoreEnd
41946>>>>>>>>>
41946>>>>>>>>>    End_Object    // oOK_bn
41947>>>>>>>>>
41947>>>>>>>>>    Object oCancel_bn is a ButtonSub
41949>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
41950>>>>>>>>>        Set Location to 115 181
41951>>>>>>>>>
41951>>>>>>>>>        //AB-StoreStart
41951>>>>>>>>>        Procedure OnClick
41953>>>>>>>>>            Send Cancel To (oSelList(current_object))
41954>>>>>>>>>        End_Procedure
41955>>>>>>>>>        //AB-StoreEnd
41955>>>>>>>>>
41955>>>>>>>>>    End_Object    // oCancel_bn
41956>>>>>>>>>
41956>>>>>>>>>    Object oSearch_bn is a ButtonSub
41958>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
41959>>>>>>>>>        Set Location to 115 236
41960>>>>>>>>>
41960>>>>>>>>>        //AB-StoreStart
41960>>>>>>>>>        Procedure OnClick
41962>>>>>>>>>            Send Search To (oSelList(current_object))
41963>>>>>>>>>        End_Procedure
41964>>>>>>>>>        //AB-StoreEnd
41964>>>>>>>>>
41964>>>>>>>>>    End_Object    // oSearch_bn
41965>>>>>>>>>
41965>>>>>>>>>
41965>>>>>>>>>    //AB-StoreStart
41965>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41966>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41967>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41968>>>>>>>>>    //AB-StoreEnd
41968>>>>>>>>>
41968>>>>>>>>>End_Object    // sl198
41969>>>>>>>>>
41969>>>>>>>>>//AB/ End_Object    // prj
41969>>>>>>>Use sl197.SL         // sl197
INCLUDING FILE: SL197.SL
41969>>>>>>>>>//AB/ Project sl197:areas
41969>>>>>>>>>//AB/     Object prj is a Lookup_Project
41969>>>>>>>>>//AB/         Set ProjectName to "sl197:areas"
41969>>>>>>>>>//AB/         Set ProjectFileName to "sl197.SL"
41969>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
41969>>>>>>>>>
41969>>>>>>>>>// Project Object Structure
41969>>>>>>>>>//   sl197 is a dbModalPanelSub
41969>>>>>>>>>//     Areas_DD is a DataDictionary
41969>>>>>>>>>//     oSelList is a dbListSub
41969>>>>>>>>>//     oOK_bn is a ButtonSub
41969>>>>>>>>>//     oCancel_bn is a ButtonSub
41969>>>>>>>>>//     oSearch_bn is a ButtonSub
41969>>>>>>>>>
41969>>>>>>>>>// Register all objects
41969>>>>>>>>>Register_Object Areas_DD
41969>>>>>>>>>Register_Object oCancel_bn
41969>>>>>>>>>Register_Object oOK_bn
41969>>>>>>>>>Register_Object oSearch_bn
41969>>>>>>>>>Register_Object oSelList
41969>>>>>>>>>Register_Object sl197
41969>>>>>>>>>
41969>>>>>>>>>
41969>>>>>>>>>    //AB-IgnoreStart
41969>>>>>>>>>
41969>>>>>>>>>    Use DFAllEnt.pkg
41969>>>>>>>>>    Use dbList.Sub
41969>>>>>>>>>    Use Button.Sub
41969>>>>>>>>>
41969>>>>>>>>>
41969>>>>>>>>>    Use AREAS.DD
INCLUDING FILE: AREAS.DD
41969>>>>>>>>>>>//DDB-FileStart
41969>>>>>>>>>>>//DDB-HeaderStart
41969>>>>>>>>>>>
41969>>>>>>>>>>>// File Name : AREAS.DD
41969>>>>>>>>>>>// Class Name: Areas_DataDictionary
41969>>>>>>>>>>>// Revision  : 8
41969>>>>>>>>>>>// Version   : 2
41969>>>>>>>>>>>
41969>>>>>>>>>>>Use  Windows           // Basic Definitions
41969>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41969>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41969>>>>>>>>>>>
41969>>>>>>>>>>>Open Areas
41971>>>>>>>>>>>Open Clients
41973>>>>>>>>>>>
41973>>>>>>>>>>>//DDB-HeaderEnd
41973>>>>>>>>>>>//DDB-SelectionStart
41973>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
41973>>>>>>>>>>>Register_Object sl197
41973>>>>>>>>>>>//DDB-SelectionEnd
41973>>>>>>>>>>>
41973>>>>>>>>>>>Class Areas_DataDictionary  is a DataDictionary_Sec
41974>>>>>>>>>>>
41974>>>>>>>>>>>    // Define_Fields:
41974>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41974>>>>>>>>>>>
41974>>>>>>>>>>>    Procedure Define_Fields
41975>>>>>>>>>>>        Forward Send Define_Fields
41977>>>>>>>>>>>        //DDB-Generated-Code-Location
41977>>>>>>>>>>>        //DDB-DefineFieldStart
41977>>>>>>>>>>>
41977>>>>>>>>>>>        Set Main_File            To Areas.File_Number
41978>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
41979>>>>>>>>>>>
41979>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41980>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41981>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41982>>>>>>>>>>>
41982>>>>>>>>>>>        // Child (Client) file structure................
41982>>>>>>>>>>>        Send Add_Client_File  Clients.File_Number
41983>>>>>>>>>>>
41983>>>>>>>>>>>        // Field-based properties.......................
41983>>>>>>>>>>>
41983>>>>>>>>>>>        // Areas.Area_Id
41983>>>>>>>>>>>        Set Field_Options          Field Areas.Area_Id To DD_AUTOFIND   
41984>>>>>>>>>>>        Set Field_Prompt_Object    Field Areas.Area_Id To (sl197(Self))
41985>>>>>>>>>>>
41985>>>>>>>>>>>        // Areas.Area_Descr
41985>>>>>>>>>>>        Set Field_Prompt_Object    Field Areas.Area_Descr To (sl197(Self))
41986>>>>>>>>>>>
41986>>>>>>>>>>>        // Areas.Area_Site
41986>>>>>>>>>>>
41986>>>>>>>>>>>        //DDB-DefineFieldEnd
41986>>>>>>>>>>>    End_Procedure    // Define_Fields
41987>>>>>>>>>>>
41987>>>>>>>>>>>    // Field_Defaults:
41987>>>>>>>>>>>    // This procedure is used to establish default field values.
41987>>>>>>>>>>>
41987>>>>>>>>>>>    Procedure Field_Defaults
41988>>>>>>>>>>>        Forward Send Field_Defaults
41990>>>>>>>>>>>        //DDB-Generated-Code-Location
41990>>>>>>>>>>>        //DDB-FieldDefaultStart
41990>>>>>>>>>>>        //DDB-FieldDefaultEnd
41990>>>>>>>>>>>    End_Procedure    // Field_Defaults
41991>>>>>>>>>>>
41991>>>>>>>>>>>End_Class    // Areas_DataDictionary
41992>>>>>>>>>>>//DDB-Selection-pkg-Start
41992>>>>>>>>>>>
41992>>>>>>>>>>>Use sl197.SL         // sl197
41992>>>>>>>>>>>
41992>>>>>>>>>>>//DDB-Selection-pkg-End
41992>>>>>>>>>>>//DDB-FileEnd
41992>>>>>>>>>    
41992>>>>>>>>>    //AB-IgnoreEnd
41992>>>>>>>>>
41992>>>>>>>>>    Object sl197 is a dbModalPanelSub
41994>>>>>>>>>
41994>>>>>>>>>        //AB-StoreTopStart
41994>>>>>>>>>                    
41994>>>>>>>>>        //AB-StoreTopEnd
41994>>>>>>>>>
41994>>>>>>>>>        Set Label to "€¨®œå¦ œ¨ ¦®é¤"
41995>>>>>>>>>        Set Size to 148 297
41996>>>>>>>>>        Set Location to 4 5
41997>>>>>>>>>        Set Exit_Application_Local_State to FALSE
41998>>>>>>>>>        Set Modal_State to FALSE
41999>>>>>>>>>
41999>>>>>>>>>        //AB-DDOStart
41999>>>>>>>>>
41999>>>>>>>>>        Object Areas_DD is a Areas_DataDictionary
42001>>>>>>>>>
42001>>>>>>>>>            //AB-StoreStart
42001>>>>>>>>>                                    
42001>>>>>>>>>            //AB-StoreEnd
42001>>>>>>>>>
42001>>>>>>>>>        End_Object    // Areas_DD
42002>>>>>>>>>
42002>>>>>>>>>        Set Main_DD to (Areas_DD(self))
42003>>>>>>>>>        Set Server to (Areas_DD(self))
42004>>>>>>>>>
42004>>>>>>>>>        //AB-DDOEnd
42004>>>>>>>>>
42004>>>>>>>>>        Object oSelList is a dbListSub
42006>>>>>>>>>            Set Main_File to Areas.File_Number
42007>>>>>>>>>            Set Ordering to 2
42008>>>>>>>>>            Set Size to 105 280
42009>>>>>>>>>            Set Location to 5 5
42010>>>>>>>>>            Set Export_Item_State to TRUE
42011>>>>>>>>>
42011>>>>>>>>>            Begin_Row
42014>>>>>>>>>                Entry_Item Areas.Area_id
42015>>>>>>>>>                Entry_Item Areas.Area_descr
42016>>>>>>>>>                Entry_Item Areas.Area_site
42017>>>>>>>>>            End_Row
42022>>>>>>>>>
42022>>>>>>>>>            Set Form_Width    item 0 to 45
42023>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
42024>>>>>>>>>            
42024>>>>>>>>>            Set Form_Width    item 1 to 192
42025>>>>>>>>>            Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
42026>>>>>>>>>            
42026>>>>>>>>>            Set Form_Width    item 2 to 35
42027>>>>>>>>>            Set Header_Label  item 2 to "’¦£â˜ª"
42028>>>>>>>>>            
42028>>>>>>>>>
42028>>>>>>>>>            //AB-StoreStart
42028>>>>>>>>>            
42028>>>>>>>>>            Set Column_Option Item 0 to NoEnter True
42029>>>>>>>>>            
42029>>>>>>>>>            
42029>>>>>>>>>            //AB-StoreEnd
42029>>>>>>>>>
42029>>>>>>>>>        End_Object    // oSelList
42030>>>>>>>>>
42030>>>>>>>>>        Object oOK_bn is a ButtonSub
42032>>>>>>>>>            Set Label to "&„§ ¢¦šã"
42033>>>>>>>>>            Set Location to 115 126
42034>>>>>>>>>
42034>>>>>>>>>            //AB-StoreStart
42034>>>>>>>>>            Procedure OnClick
42036>>>>>>>>>                Send OK To (oSelList(current_object))
42037>>>>>>>>>            End_Procedure
42038>>>>>>>>>            //AB-StoreEnd
42038>>>>>>>>>
42038>>>>>>>>>        End_Object    // oOK_bn
42039>>>>>>>>>
42039>>>>>>>>>        Object oCancel_bn is a ButtonSub
42041>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
42042>>>>>>>>>            Set Location to 115 181
42043>>>>>>>>>
42043>>>>>>>>>            //AB-StoreStart
42043>>>>>>>>>            Procedure OnClick
42045>>>>>>>>>                Send Cancel To (oSelList(current_object))
42046>>>>>>>>>            End_Procedure
42047>>>>>>>>>            //AB-StoreEnd
42047>>>>>>>>>
42047>>>>>>>>>        End_Object    // oCancel_bn
42048>>>>>>>>>
42048>>>>>>>>>        Object oSearch_bn is a ButtonSub
42050>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
42051>>>>>>>>>            Set Location to 115 236
42052>>>>>>>>>
42052>>>>>>>>>            //AB-StoreStart
42052>>>>>>>>>            Procedure OnClick
42054>>>>>>>>>                Send Search To (oSelList(current_object))
42055>>>>>>>>>            End_Procedure
42056>>>>>>>>>            //AB-StoreEnd
42056>>>>>>>>>
42056>>>>>>>>>        End_Object    // oSearch_bn
42057>>>>>>>>>
42057>>>>>>>>>
42057>>>>>>>>>        //AB-StoreStart
42057>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
42058>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
42059>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
42060>>>>>>>>>        
42060>>>>>>>>>        
42060>>>>>>>>>        
42060>>>>>>>>>        
42060>>>>>>>>>        
42060>>>>>>>>>        //AB-StoreEnd
42060>>>>>>>>>
42060>>>>>>>>>    End_Object    // sl197
42061>>>>>>>>>
42061>>>>>>>>>//AB/     End_Object    // prj
42061>>>>>>>
42061>>>>>>>//DDB-Selection-pkg-End
42061>>>>>>>//DDB-FileEnd
42061>>>>>
42061>>>>>//AB-IgnoreEnd
42061>>>>>
42061>>>>>Object sl111 is a dbModalPanelSub
42063>>>>>    Set Label to "“§œçŸ¬¤¦  ¢ž¨à£é¤ "
42064>>>>>    Set Size to 148 443
42065>>>>>    Set Location to 4 5
42066>>>>>    Set Exit_Application_Local_State to FALSE
42067>>>>>    Set Modal_State to FALSE
42068>>>>>
42068>>>>>    //AB-DDOStart
42068>>>>>
42068>>>>>    Object Payresp_DD is a Payresp_DataDictionary
42070>>>>>    End_Object    // Payresp_DD
42071>>>>>
42071>>>>>    Set Main_DD to (Payresp_DD(self))
42072>>>>>    Set Server to (Payresp_DD(self))
42073>>>>>
42073>>>>>    //AB-DDOEnd
42073>>>>>
42073>>>>>    Object oSelList is a dbListSub
42075>>>>>        Set Main_File to Payresp.File_Number
42076>>>>>        Set Size to 105 430
42077>>>>>        Set Location to 6 6
42078>>>>>
42078>>>>>        Begin_Row
42081>>>>>            Entry_Item Payresp.Presp_id
42082>>>>>            Entry_Item Payresp.Presp_name
42083>>>>>            Entry_Item Payresp.Presp_afm
42084>>>>>            Entry_Item Payresp.Presp_address
42085>>>>>            Entry_Item Payresp.Presp_phone
42086>>>>>        End_Row
42091>>>>>
42091>>>>>        Set Form_Width    item 0 to 60
42092>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
42093>>>>>        
42093>>>>>        Set Form_Width    item 1 to 106
42094>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
42095>>>>>        
42095>>>>>        Set Form_Width    item 2 to 60
42096>>>>>        Set Header_Label  item 2 to "€.”.‹"
42097>>>>>        
42097>>>>>        Set Form_Width    item 3 to 135
42098>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
42099>>>>>        
42099>>>>>        Set Form_Width    item 4 to 60
42100>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
42101>>>>>        
42101>>>>>    End_Object    // oSelList
42102>>>>>
42102>>>>>    Object oOK_bn is a ButtonSub
42104>>>>>        Set Label to "&„§ ¢¦šã"
42105>>>>>        Set Location to 113 277
42106>>>>>
42106>>>>>        //AB-StoreStart
42106>>>>>        Procedure OnClick
42108>>>>>            Send OK To (oSelList(current_object))
42109>>>>>        End_Procedure
42110>>>>>        //AB-StoreEnd
42110>>>>>
42110>>>>>    End_Object    // oOK_bn
42111>>>>>
42111>>>>>    Object oCancel_bn is a ButtonSub
42113>>>>>        Set Label to "&€¡ç¨à©ž"
42114>>>>>        Set Location to 113 332
42115>>>>>
42115>>>>>        //AB-StoreStart
42115>>>>>        Procedure OnClick
42117>>>>>            Send Cancel To (oSelList(current_object))
42118>>>>>        End_Procedure
42119>>>>>        //AB-StoreEnd
42119>>>>>
42119>>>>>    End_Object    // oCancel_bn
42120>>>>>
42120>>>>>    Object oSearch_bn is a ButtonSub
42122>>>>>        Set Label to "€&¤˜ã«ž©ž"
42123>>>>>        Set Location to 113 387
42124>>>>>
42124>>>>>        //AB-StoreStart
42124>>>>>        Procedure OnClick
42126>>>>>            Send Search To (oSelList(current_object))
42127>>>>>        End_Procedure
42128>>>>>        //AB-StoreEnd
42128>>>>>
42128>>>>>    End_Object    // oSearch_bn
42129>>>>>
42129>>>>>
42129>>>>>    //AB-StoreStart
42129>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
42130>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
42131>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
42132>>>>>    //AB-StoreEnd
42132>>>>>
42132>>>>>End_Object    // sl111
42133>>>>>
42133>>>>>//AB/ End_Object    // prj
42133>>>    Use sl108.sl
INCLUDING FILE: SL108.SL
42133>>>>>//AB/ Project sl108:polhtes
42133>>>>>//AB/ Object prj is a Lookup_Project
42133>>>>>//AB/     Set ProjectName to "sl108:polhtes"
42133>>>>>//AB/     Set ProjectFileName to "sl108.SL"
42133>>>>>//AB/     Set GenerateFileName to "NONAME"
42133>>>>>
42133>>>>>// Project Object Structure
42133>>>>>//   sl108 is a dbModalPanelSub
42133>>>>>//     Salesmen_DD is a DataDictionary
42133>>>>>//     oSelList is a dbListSub
42133>>>>>//     oOK_bn is a ButtonSub
42133>>>>>//     oCancel_bn is a ButtonSub
42133>>>>>//     oSearch_bn is a ButtonSub
42133>>>>>
42133>>>>>// Register all objects
42133>>>>>Register_Object oCancel_bn
42133>>>>>Register_Object oOK_bn
42133>>>>>Register_Object oSearch_bn
42133>>>>>Register_Object oSelList
42133>>>>>Register_Object Salesmen_DD
42133>>>>>Register_Object sl108
42133>>>>>
42133>>>>>
42133>>>>>//AB-IgnoreStart
42133>>>>>
42133>>>>>Use DFAllEnt.pkg
42133>>>>>Use dbList.Sub
42133>>>>>Use Button.Sub
42133>>>>>
42133>>>>>
42133>>>>>Use SALESMEN.DD
INCLUDING FILE: SALESMEN.DD
42133>>>>>>>//DDB-FileStart
42133>>>>>>>//DDB-HeaderStart
42133>>>>>>>
42133>>>>>>>// File Name : SALESMEN.DD
42133>>>>>>>// Class Name: Salesmen_DataDictionary
42133>>>>>>>// Revision  : 57
42133>>>>>>>// Version   : 2
42133>>>>>>>
42133>>>>>>>Use  Windows           // Basic Definitions
42133>>>>>>>Use  DataDict          // DataDictionary Class Definition
42133>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
42133>>>>>>>
42133>>>>>>>Open Salesmen
42135>>>>>>>Open Cn
42137>>>>>>>Open Sysrecc
42139>>>>>>>
42139>>>>>>>//DDB-HeaderEnd
42139>>>>>>>//DDB-ValidationStart
42139>>>>>>>
42139>>>>>>>Register_Object Salesmen_Sls_Doy_VT
42139>>>>>>>
42139>>>>>>>Object Salesmen_Sls_Doy_VT  is a CodeValidationTable
42141>>>>>>>    Set Type_Value        To "DOY"
42142>>>>>>>    Set Allow_Blank_State To TRUE
42143>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
42144>>>>>>>    //DDB-ValidationCustomStart
42144>>>>>>>    //DDB-ValidationCustomEnd
42144>>>>>>>End_Object   // Salesmen_Sls_Doy_VT
42145>>>>>>>//DDB-ValidationEnd
42145>>>>>>>//DDB-SelectionStart
42145>>>>>>>//DDB/ ExternalSelectionList sl108  sl108.sl
42145>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
42145>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
42145>>>>>>>Register_Object sl108
42145>>>>>>>Register_Object sl198
42145>>>>>>>Register_Object sl197
42145>>>>>>>//DDB-SelectionEnd
42145>>>>>>>
42145>>>>>>>Class Salesmen_DataDictionary  is a DataDictionary_Sec
42146>>>>>>> 
42146>>>>>>>    // Save_Main_File:
42146>>>>>>> 
42146>>>>>>>    Procedure Save_Main_File
42147>>>>>>>        If ((Operation_Origin<>Self) And (Salesmen.Sls_ID='')) Procedure_Return
42150>>>>>>>        Forward Send Save_Main_File
42152>>>>>>>    End_Procedure   // Save_Main_File
42153>>>>>>> 
42153>>>>>>>    // Define_Fields:
42153>>>>>>>    // This procedure is used to set up all data-dictionary rules.
42153>>>>>>>     Procedure Update
42154>>>>>>>        Forward Send Update
42156>>>>>>>        // Insert Code Here
42156>>>>>>>        Move SysCurXR.Company_Code  to salesmen.Company_Code
42157>>>>>>>        Move SysCurXR.Branch_Code   to salesmen.Branch_Code
42158>>>>>>>        Move SysCurXR.Year_Year     to salesmen.Year_Year
42159>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
42159>>>>>>>        Move (salesmen.Xreosh-salesmen.Pistosh)   to salesmen.Ypoloipo
42160>>>>>>>        Move (salesmen.Plafon-salesmen.ypoloipo)  to salesmen.Overhead
42161>>>>>>>
42161>>>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
42161>>>>>>>
42161>>>>>>>        //betolink
42161>>>>>>>        Move SysCurXR.Beto_Site      to salesmen.sls_SiteW
42162>>>>>>>        Move salesmen.sls_Rec0       to salesmen.sls_SN
42163>>>>>>>        Move salesmen.sls_id         to salesmen.sls_Repm
42164>>>>>>>
42164>>>>>>>    End_Procedure   // Update
42165>>>>>>>
42165>>>>>>>     Procedure Creating
42166>>>>>>>        Forward Send Creating
42168>>>>>>>        // Insert Code Here
42168>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(salesmen.sls_Rec0))))));                                    to salesmen.sls_Recr
42169>>>>>>>        Move '1'                    to salesmen.sls_Active
42170>>>>>>>        get fsgCode_With_Zeroes salesmen.sls_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to salesmen.sls_ID
42171>>>>>>>    End_Procedure   // Creating
42172>>>>>>>
42172>>>>>>>    Procedure Define_Fields
42173>>>>>>>        Forward Send Define_Fields
42175>>>>>>>        //DDB-Generated-Code-Location
42175>>>>>>>        //DDB-DefineFieldStart
42175>>>>>>>
42175>>>>>>>        Set Main_File            To Salesmen.File_Number
42176>>>>>>>        Set Cascade_Delete_State To FALSE
42177>>>>>>>
42177>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
42178>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
42179>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
42180>>>>>>>
42180>>>>>>>        // Child (Client) file structure................
42180>>>>>>>        Send Add_Client_File  Cn.File_Number
42181>>>>>>>
42181>>>>>>>        // External (System) file structure.............
42181>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
42182>>>>>>>
42182>>>>>>>        Define_Auto_Increment  Sysrecc.Salesmen_Rec0  To Salesmen.Sls_Rec0
42185>>>>>>>
42185>>>>>>>        // Field-based properties.......................
42185>>>>>>>
42185>>>>>>>        // Salesmen.Company_Code
42185>>>>>>>
42185>>>>>>>        // Salesmen.Branch_Code
42185>>>>>>>
42185>>>>>>>        // Salesmen.Year_Year
42185>>>>>>>
42185>>>>>>>        // Salesmen.Sls_Id
42185>>>>>>>        Set Field_Options          Field Salesmen.Sls_Id To DD_AUTOFIND    DD_FINDREQ    
42186>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Id To (sl108(Self))
42187>>>>>>>        Set Key_Field_State        Field Salesmen.Sls_Id To TRUE
42188>>>>>>>
42188>>>>>>>        // Salesmen.Sls_Name
42188>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Name To (sl108(Self))
42189>>>>>>>
42189>>>>>>>        // Salesmen.Sls_Afm
42189>>>>>>>
42189>>>>>>>        // Salesmen.Sls_Rec0
42189>>>>>>>
42189>>>>>>>        // Salesmen.Sls_Recr
42189>>>>>>>
42189>>>>>>>        // Salesmen.Last_Xreosh
42189>>>>>>>
42189>>>>>>>        // Salesmen.Last_Pistosh
42189>>>>>>>
42189>>>>>>>        // Salesmen.Last_Order
42189>>>>>>>
42189>>>>>>>        // Salesmen.Sls_Doy
42189>>>>>>>        Set Field_Value_Table      Field Salesmen.Sls_Doy To (Salesmen_Sls_Doy_VT(Self))
42190>>>>>>>
42190>>>>>>>        // Salesmen.Sls_Address
42190>>>>>>>
42190>>>>>>>        // Salesmen.Sls_City
42190>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_City To (sl198(Self))
42191>>>>>>>
42191>>>>>>>        // Salesmen.Sls_Area
42191>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Area To (sl197(Self))
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Job
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Respons
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Zipcode
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Phone
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Fax
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Mobile
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Aoh
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Email
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Class
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Details
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Sitew
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Codem
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Categfpa
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Fpa
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Public
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Sn
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Repm
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Active
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Reported
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Lastupd
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Markexp
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Catjob
42192>>>>>>>
42192>>>>>>>        // Salesmen.Xreosh
42192>>>>>>>
42192>>>>>>>        // Salesmen.Pistosh
42192>>>>>>>
42192>>>>>>>        // Salesmen.Ypoloipo
42192>>>>>>>
42192>>>>>>>        // Salesmen.Plafon
42192>>>>>>>
42192>>>>>>>        // Salesmen.Overhead
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Add_No
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Nomos
42192>>>>>>>
42192>>>>>>>        // Salesmen.Sls_Xora
42192>>>>>>>
42192>>>>>>>        // Salesmen.Polh_Recr
42192>>>>>>>
42192>>>>>>>        //DDB-DefineFieldEnd
42192>>>>>>>    End_Procedure    // Define_Fields
42193>>>>>>>
42193>>>>>>>    // Field_Defaults:
42193>>>>>>>    // This procedure is used to establish default field values.
42193>>>>>>>
42193>>>>>>>    Procedure Field_Defaults
42194>>>>>>>        Forward Send Field_Defaults
42196>>>>>>>        //DDB-Generated-Code-Location
42196>>>>>>>        //DDB-FieldDefaultStart
42196>>>>>>>        Set Field_Changed_Value   Field Salesmen.Sls_Doy To "0"
42197>>>>>>>        //DDB-FieldDefaultEnd
42197>>>>>>>    End_Procedure    // Field_Defaults
42198>>>>>>>
42198>>>>>>>End_Class    // Salesmen_DataDictionary
42199>>>>>>>//DDB-Selection-pkg-Start
42199>>>>>>>
42199>>>>>>>Use sl108.sl         // sl108
42199>>>>>>>Use sl198.sl         // sl198
42199>>>>>>>Use sl197.SL         // sl197
42199>>>>>>>
42199>>>>>>>//DDB-Selection-pkg-End
42199>>>>>>>//DDB-FileEnd
42199>>>>>
42199>>>>>//AB-IgnoreEnd
42199>>>>>
42199>>>>>Object sl108 is a dbModalPanelSub
42201>>>>>    Set Label to "‹ž«¨é¦ à¢ž«é¤"
42202>>>>>    Set Size to 148 421
42203>>>>>    Set Location to 4 5
42204>>>>>    Set Exit_Application_Local_State to FALSE
42205>>>>>    Set Modal_State to FALSE
42206>>>>>
42206>>>>>    //AB-DDOStart
42206>>>>>
42206>>>>>    Object Salesmen_DD is a Salesmen_DataDictionary
42208>>>>>    End_Object    // Salesmen_DD
42209>>>>>
42209>>>>>    Set Main_DD to (Salesmen_DD(self))
42210>>>>>    Set Server to (Salesmen_DD(self))
42211>>>>>
42211>>>>>    //AB-DDOEnd
42211>>>>>
42211>>>>>    Object oSelList is a dbListSub
42213>>>>>        Set Main_File to Salesmen.File_Number
42214>>>>>        Set Size to 105 408
42215>>>>>        Set Location to 6 6
42216>>>>>
42216>>>>>        Begin_Row
42219>>>>>            Entry_Item Salesmen.Sls_id
42220>>>>>            Entry_Item Salesmen.Sls_name
42221>>>>>            Entry_Item Salesmen.Sls_afm
42222>>>>>            Entry_Item Salesmen.Sls_address
42223>>>>>            Entry_Item Salesmen.Sls_phone
42224>>>>>        End_Row
42229>>>>>
42229>>>>>        Set Form_Width    item 0 to 60
42230>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
42231>>>>>        
42231>>>>>        Set Form_Width    item 1 to 100
42232>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
42233>>>>>        
42233>>>>>        Set Form_Width    item 2 to 60
42234>>>>>        Set Header_Label  item 2 to "€.”.‹"
42235>>>>>        
42235>>>>>        Set Form_Width    item 3 to 125
42236>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
42237>>>>>        
42237>>>>>        Set Form_Width    item 4 to 54
42238>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
42239>>>>>        
42239>>>>>    End_Object    // oSelList
42240>>>>>
42240>>>>>    Object oOK_bn is a ButtonSub
42242>>>>>        Set Label to "&„§ ¢¦šã"
42243>>>>>        Set Location to 117 255
42244>>>>>
42244>>>>>        //AB-StoreStart
42244>>>>>        Procedure OnClick
42246>>>>>            Send OK To (oSelList(current_object))
42247>>>>>        End_Procedure
42248>>>>>        //AB-StoreEnd
42248>>>>>
42248>>>>>    End_Object    // oOK_bn
42249>>>>>
42249>>>>>    Object oCancel_bn is a ButtonSub
42251>>>>>        Set Label to "&€¡ç¨à©ž"
42252>>>>>        Set Location to 117 310
42253>>>>>
42253>>>>>        //AB-StoreStart
42253>>>>>        Procedure OnClick
42255>>>>>            Send Cancel To (oSelList(current_object))
42256>>>>>        End_Procedure
42257>>>>>        //AB-StoreEnd
42257>>>>>
42257>>>>>    End_Object    // oCancel_bn
42258>>>>>
42258>>>>>    Object oSearch_bn is a ButtonSub
42260>>>>>        Set Label to "€&¤˜ã«ž©ž"
42261>>>>>        Set Location to 117 365
42262>>>>>
42262>>>>>        //AB-StoreStart
42262>>>>>        Procedure OnClick
42264>>>>>            Send Search To (oSelList(current_object))
42265>>>>>        End_Procedure
42266>>>>>        //AB-StoreEnd
42266>>>>>
42266>>>>>    End_Object    // oSearch_bn
42267>>>>>
42267>>>>>
42267>>>>>    //AB-StoreStart
42267>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
42268>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
42269>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
42270>>>>>    //AB-StoreEnd
42270>>>>>
42270>>>>>End_Object    // sl108
42271>>>>>
42271>>>>>//AB/ End_Object    // prj
42271>>>    Open Rptmp
INCLUDING FILE: RPTMP.FD
42273>>>    Open Clients
42275>>>    Open Cmoves
42277>>>    Open Wcmoves
INCLUDING FILE: WCMOVES.FD
42279>>>    Open Particle
42281>>>    Open Barticl
INCLUDING FILE: BARTICL.FD
42283>>>    Open Btypkin
42285>>>    Open Ctypkin
42287>>>    Open Bmove
INCLUDING FILE: BMOVE.FD
42289>>>    Open Baxiokat
INCLUDING FILE: BAXIOKAT.FD
42291>>>    Open Baxio
INCLUDING FILE: BAXIO.FD
42293>>>    Use sl002.sl
42293>>>    Use obarray2d.pkg
INCLUDING FILE: OBARRAY2D.PKG
42293>>>>>//************************************************************************************************
42293>>>>>// OBArray2D.pkg
42293>>>>>//
42293>>>>>// Copyright (c) 1999-2001 Out of the Box Consulting, Inc.
42293>>>>>// All rights reserved.
42293>>>>>//
42293>>>>>//***************************************************************************
42293>>>>>//  Description:
42293>>>>>//      This is a set of classes that enhance the built in VDF array class.
42293>>>>>//      There is support for 2D arrays mainly, but also an enhancement or two
42293>>>>>//      in relation to adding items to a regular array and some sorting
42293>>>>>//      abilities.
42293>>>>>//
42293>>>>>//  Author: Oliver T. Nelson
42293>>>>>//***************************************************************************
42293>>>>>
42293>>>>>Register_Object objIDRef
42293>>>>>
42293>>>>>Class CustomArray is an Array
42294>>>>>
42294>>>>>    Procedure pAddItem String Val
42295>>>>>        integer iCnt
42296>>>>>        get item_count to iCnt
42297>>>>>        set array_value item iCnt to Val
42298>>>>>    end_procedure
42299>>>>>
42299>>>>>    Function fAddItem String Val returns integer
42300>>>>>        integer iCnt
42301>>>>>        get item_count to iCnt
42302>>>>>        set array_value item iCnt to Val
42303>>>>>        function_return (iCnt)
42304>>>>>    end_function
42305>>>>>
42305>>>>>    Procedure InsertItem String sVal Integer iIndex
42306>>>>>        integer iTotal iCnt iNumImages
42307>>>>>        string misc
42307>>>>>
42307>>>>>        get item_count to iTotal
42308>>>>>        move (iTotal-1) to iCnt
42309>>>>>
42309>>>>>        send pAddItem ""
42310>>>>>
42310>>>>>        repeat
42310>>>>>>
42310>>>>>            get string_value item iCnt to misc
42311>>>>>            set array_value item (iCnt+1) to misc
42312>>>>>            decrement iCnt
42313>>>>>        until iCnt lt (iIndex-1)
42315>>>>>
42315>>>>>        set array_value item (iIndex) to sVal
42316>>>>>
42316>>>>>    end_procedure
42317>>>>>
42317>>>>>end_class
42318>>>>>
42318>>>>>Class ColumnArray is a CustomArray
42319>>>>>    Procedure Construct_object
42320>>>>>        forward send Construct_Object
42322>>>>>
42322>>>>>        integer iSelf
42323>>>>>
42323>>>>>        move Self to iSelf
42324>>>>>        Send pAddItem to (objIDRef(self)) iSelf
42325>>>>>    End_Procedure
42326>>>>>End_Class
42327>>>>>
42327>>>>>Class c2dArray is a CustomArray
42328>>>>>
42328>>>>>    Procedure Construct_Object
42329>>>>>        Property Integer piNumColumns PUBLIC 0
42330>>>>>
42330>>>>>        Forward Send Construct_Object
42332>>>>>
42332>>>>>        Object objIDRef is a CustomArray
42334>>>>>        End_Object
42335>>>>>
42335>>>>>    end_procedure
42336>>>>>
42336>>>>>    Procedure AddColumn Integer iNumtoAdd
42337>>>>>        integer iNumColumns iCnt
42338>>>>>
42338>>>>>        for iCnt from 1 to iNumtoAdd
42344>>>>>>
42344>>>>>            Object nthItem is a ColumnArray
42346>>>>>            end_Object
42347>>>>>        loop
42348>>>>>>
42348>>>>>
42348>>>>>        Get piNumColumns to iNumColumns
42349>>>>>        add iNumtoAdd to iNumColumns
42350>>>>>        set piNumColumns to iNumColumns
42351>>>>>
42351>>>>>    end_procedure
42352>>>>>
42352>>>>>    Procedure DeleteArray_Data
42353>>>>>        integer iNumColumns iCnt iColumnObj
42354>>>>>        get piNumColumns to iNumColumns
42355>>>>>        for iCnt from 0 to (iNumColumns-1)
42361>>>>>>
42361>>>>>            get integer_value of (objIDRef(self)) item iCnt to iColumnObj
42362>>>>>            if (iColumnObj<>0) send Delete_Data to iColumnObj
42365>>>>>        loop
42366>>>>>>
42366>>>>>    end_procedure
42367>>>>>
42367>>>>>    Procedure End_Construct_object
42368>>>>>        forward send End_Construct_object
42370>>>>>
42370>>>>>        Integer iNumColumns
42371>>>>>
42371>>>>>        Get piNumColumns to iNumColumns
42372>>>>>        Set piNumColumns to 0
42373>>>>>        if iNumColumns Send AddColumn iNumColumns
42376>>>>>    end_procedure
42377>>>>>
42377>>>>>    Procedure Set Cell_Value Integer iColumn Integer iRow String sVal
42378>>>>>        integer ColumnObj iTotal
42379>>>>>
42379>>>>>        get item_count of (objIDRef(self)) to iTotal
42380>>>>>        if (iColumn+1) le iTotal begin
42382>>>>>            get integer_value of (objIDRef(self)) item iColumn to ColumnObj
42383>>>>>            set array_value of ColumnObj item iRow to sVal
42384>>>>>        end
42384>>>>>>
42384>>>>>    end_procedure
42385>>>>>
42385>>>>>    Function Cell_Value Integer iColumn Integer iRow Returns String
42386>>>>>        String sVal
42387>>>>>        integer ColumnObj iTotal
42387>>>>>
42387>>>>>        get item_count of (objIDRef(self)) to iTotal
42388>>>>>        if (iColumn+1) le iTotal begin
42390>>>>>            get integer_value of (objIDRef(self)) item iColumn to ColumnObj
42391>>>>>            Get string_value of ColumnObj item iRow to sVal
42392>>>>>        end
42392>>>>>>
42392>>>>>
42392>>>>>        function_return sVal
42393>>>>>    end_function
42394>>>>>
42394>>>>>    Function Find_Item_First_Col String asItem Returns Integer
42395>>>>>        Integer iRow iRowCount iInt
42396>>>>>        String  sItem
42396>>>>>        Get RecordCount to iRowCount
42397>>>>>        For iInt From 0 to (iRowCount-1)
42403>>>>>>
42403>>>>>            Get Cell_Value 0 iInt to sItem
42404>>>>>            If (Trim(sItem)=Trim(asItem)) Function_Return iInt
42407>>>>>        Loop
42408>>>>>>
42408>>>>>        Function_return -1
42409>>>>>    End_function
42410>>>>>
42410>>>>>    Function Sum_Column Integer aiColumn Returns Number
42411>>>>>        Number  rVal sVal
42412>>>>>        Integer iRowCount iInt
42412>>>>>        Move 0 to rVal
42413>>>>>        Get RecordCount to iRowCount
42414>>>>>        For iInt From 0 to (iRowCount-1)
42420>>>>>>
42420>>>>>            Get Cell_Value 0 iInt to sVal
42421>>>>>            Add sVal to rVal
42422>>>>>        Loop
42423>>>>>>
42423>>>>>        Function_return rVal
42424>>>>>    End_function
42425>>>>>
42425>>>>>    Procedure RemoveColumn Integer iColumn#
42426>>>>>        integer ColumnObj iNumColumns
42427>>>>>
42427>>>>>        get integer_value of (objIDRef(self)) item (iColumn#-1) to ColumnObj
42428>>>>>        send destroy_object to ColumnObj
42429>>>>>
42429>>>>>        send delete_item to (objIDRef(self)) (iColumn#-1)
42430>>>>>
42430>>>>>        set piNumColumns to (piNumColumns(self)-1)
42431>>>>>    end_procedure
42432>>>>>
42432>>>>>    Procedure RemoveRow Integer iRow#
42433>>>>>        integer iColObj iNumColumns iCnt
42434>>>>>
42434>>>>>        get piNumColumns to iNumColumns
42435>>>>>
42435>>>>>        for iCnt from 0 to (iNumColumns-1)
42441>>>>>>
42441>>>>>            get integer_value of (objIDRef(self)) item iCnt to iColObj
42442>>>>>
42442>>>>>            if iColObj ne 0 begin
42444>>>>>                send delete_item to iColObj iRow#
42445>>>>>            end
42445>>>>>>
42445>>>>>        loop
42446>>>>>>
42446>>>>>    end_procedure
42447>>>>>
42447>>>>>    Procedure InsertRow Integer iRow#
42448>>>>>        integer iColObj iNumColumns iCnt
42449>>>>>
42449>>>>>        get piNumColumns to iNumColumns
42450>>>>>
42450>>>>>        for iCnt from 0 to (iNumColumns-1)
42456>>>>>>
42456>>>>>            get integer_value of (objIDRef(self)) item iCnt to iColObj
42457>>>>>
42457>>>>>            if iColObj ne 0 begin
42459>>>>>                send insertitem to iColObj "" iRow#
42460>>>>>            end
42460>>>>>>
42460>>>>>        loop
42461>>>>>>
42461>>>>>    end_procedure
42462>>>>>
42462>>>>>    Procedure CopyRecord Integer bOverWrite Handle hoDestination Integer iSourceRow Integer iDestinationRow
42463>>>>>        integer iNumColumns iCnt
42464>>>>>        string sVal
42464>>>>>
42464>>>>>        get piNumColumns to iNumColumns
42465>>>>>
42465>>>>>        if (not(bOverWrite)) Send InsertRow to hoDestination iDestinationRow
42468>>>>>        for iCnt from 0 to (iNumColumns - 1)
42474>>>>>>
42474>>>>>            get cell_value iCnt iSourceRow to sVal
42475>>>>>            set cell_value of hoDestination iCnt iDestinationRow to sVal
42476>>>>>        loop
42477>>>>>>
42477>>>>>    end_procedure
42478>>>>>
42478>>>>>    Function RecordCount returns integer
42479>>>>>        integer iColumnObj iRetVal
42480>>>>>
42480>>>>>        get integer_value of (objIDRef(self)) item 0 to iColumnObj
42481>>>>>        get item_count of iColumnObj to iRetVal
42482>>>>>
42482>>>>>        function_return iRetVal
42483>>>>>    end_function
42484>>>>>
42484>>>>>    Function ScoreAsc String sVal returns integer
42485>>>>>        string misc ScoreList
42486>>>>>        integer iScore
42486>>>>>
42486>>>>>        move "zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA9876543210" to ScoreList
42487>>>>>    end_function
42488>>>>>
42488>>>>>    Procedure SwapRows Integer iFirstRow# integer iSecondRow#
42489>>>>>        integer iNumColumns iCnt
42490>>>>>        string misc
42490>>>>>
42490>>>>>        get piNumColumns to iNumColumns
42491>>>>>
42491>>>>>        object MyArray is a CustomArray
42493>>>>>        end_object
42494>>>>>
42494>>>>>        // this loop copies all data in the FirstRow to a temp array
42494>>>>>        for iCnt from 0 to iNumColumns
42500>>>>>>
42500>>>>>            move "" to misc
42501>>>>>            get cell_value iCnt iFirstRow# to misc
42502>>>>>            Send pAddItem to (MyArray(self)) misc
42503>>>>>        loop
42504>>>>>>
42504>>>>>
42504>>>>>        // this loop moves data from SecondRow to FirstRow
42504>>>>>        for iCnt from 0 to iNumColumns
42510>>>>>>
42510>>>>>            move "" to misc
42511>>>>>            get cell_value iCnt iSecondRow# to misc
42512>>>>>            set Cell_value to iCnt iFirstRow# misc
42513>>>>>        loop
42514>>>>>>
42514>>>>>
42514>>>>>        // this loop moves data from temp array to SecondRow
42514>>>>>        for iCnt from 0 to iNumColumns
42520>>>>>>
42520>>>>>            move "" to misc
42521>>>>>            get array_value of (MyArray(self)) item iCnt to misc
42522>>>>>            set cell_value to iCnt iSecondRow# misc
42523>>>>>        loop
42524>>>>>>
42524>>>>>
42524>>>>>        send destroy_object to (MyArray(self))
42525>>>>>    end_procedure
42526>>>>>
42526>>>>>    // This procedure needs to be extended to work on ascii columns.  Right now it will
42526>>>>>    // only sort numeric columns.  Another sorting algorithm procedure needs to be added
42526>>>>>    // for ascii.
42526>>>>>    Procedure Sort Integer iColumn
42527>>>>>        integer iColumnObj iTotal iCnt iRowTotal iTmp
42528>>>>>
42528>>>>>        // first we have to figure out the number of rows in the 2D array.  This is done
42528>>>>>        // by finding the column (really just an array) with the most items.
42528>>>>>        get item_count of (objIDRef(self)) to iTotal
42529>>>>>        for iCnt from 0 to (iTotal-1)
42535>>>>>>
42535>>>>>            get integer_value of (objIDRef(self)) item iCnt to iColumnObj
42536>>>>>
42536>>>>>            get item_count of iColumnObj to iTmp
42537>>>>>            if iTmp gt iRowTotal move iTmp to iRowTotal
42540>>>>>        loop
42541>>>>>>
42541>>>>>
42541>>>>>        Send iQuickSort 0 iRowTotal iColumn
42542>>>>>        send RemoveRow 0
42543>>>>>    end_procedure
42544>>>>>
42544>>>>>    Procedure iQuickSort integer iFirst integer iLast integer iColumn
42545>>>>>
42545>>>>>        integer iLeftpointer iRightpointer iPartition
42546>>>>>        number nPartitionVal nTemp
42546>>>>>        integer bNoIterate1 bNoIterate2
42546>>>>>
42546>>>>>        move iFirst to iLeftpointer
42547>>>>>        move iLast to iRightPointer
42548>>>>>        move ((iFirst + iLast)/2) to iPartition
42549>>>>>        get cell_value iColumn iPartition to nPartitionVal
42550>>>>>
42550>>>>>        Repeat
42550>>>>>>
42550>>>>>            get cell_value iColumn iLeftPointer to nTemp
42551>>>>>            while nTemp lt nPartitionVal
42555>>>>>                increment iLeftPointer
42556>>>>>                get cell_value iColumn iLeftPointer to nTemp
42557>>>>>            end
42558>>>>>>
42558>>>>>
42558>>>>>            get cell_value iColumn iRightPointer to nTemp
42559>>>>>            while nTemp gt nPartitionVal
42563>>>>>                decrement iRightPointer
42564>>>>>                get cell_value iColumn iRightPointer to nTemp
42565>>>>>            end
42566>>>>>>
42566>>>>>
42566>>>>>            If iLeftPointer le iRightPointer begin
42568>>>>>                Send SwapRows iLeftPointer iRightPointer
42569>>>>>                increment iLeftPointer
42570>>>>>                decrement iRightPointer
42571>>>>>            End
42571>>>>>>
42571>>>>>        Until iLeftPointer gt iRightPointer
42573>>>>>
42573>>>>>        If iFirst lt iRightPointer Send iQuickSort iFirst iRightPointer iColumn
42576>>>>>        If iLast gt iLeftPointer Send iQuickSort iLeftPointer iLast iColumn
42579>>>>>    end_procedure
42580>>>>>
42580>>>>>end_class
42581>>>    Open sysfile
42583>>>    //AB-StoreTopEnd
42583>>>
42583>>>    //AB-IgnoreStart
42583>>>
42583>>>    Use Rptvw.Sub
42583>>>    Use Rgroup.Sub
42583>>>    Use Radio.Sub
42583>>>    Use Txtbox.Sub
42583>>>    Use Group.Sub
42583>>>    Use Form.Sub
42583>>>    Use DFAllEnt.pkg
42583>>>    Use Chkbox.Sub
42583>>>    Use FCP_ProgressBar.PKG
INCLUDING FILE: FCP_PROGRESSBAR.PKG
42583>>>>>// Created on : Aug 27th, 2002
42583>>>>>// Created by : Frank Cheng
42583>>>>>// Home Page  : www.FrankCheng.com
42583>>>>>// Package    : FCP_ProgressBar.pkg
42583>>>>>// Email      : wintime98@yahoo.com
42583>>>>>//
42583>>>>>
42583>>>>>// [What does it do, and why would you want to use it?]
42583>>>>>// Added a few enhancements to the existing cProgressBar class.
42583>>>>>
42583>>>>>// 1. You can show the percentage completed inside the progress bar.
42583>>>>>// 2. You can show gradient color (fading effect) for the progress bar.
42583>>>>>// 3. It supports the use of system color. If you specify system color in
42583>>>>>//    cProgressBar, all you will get is the color black.
42583>>>>>
42583>>>>>// [New Properties]
42583>>>>>// pbPercent    - Shows the percentage completed in the progress bar. pbSmooth has to be true also.
42583>>>>>// piBarColor   - Specify the color for the beginning-end of the progress bar
42583>>>>>// piBarColor1  - Specify the color for the finishing-end of the progress bar
42583>>>>>
42583>>>>>// [How to use]
42583>>>>>// The same way you would use a cProgressBar. Consult with the VDF online help if you
42583>>>>>// need more information on cProgressBar
42583>>>>>
42583>>>>>
42583>>>>>Use DfAllEnt.pkg
42583>>>>>Use CommCtrl.pkg
42583>>>>>
42583>>>>>Define PBS_PERCENT              For     (|CI$10)
42583>>>>>Define PBM_SETBARCOLOR1 For     (WM_USER+20)
42583>>>>>
42583>>>>>//#IF (!@<70)
42583>>>>>Define clDefault for |CI$FF000000
42583>>>>>Define CCM_FIRST for |CI$2000
42583>>>>>Define CCM_SETBKCOLOR for (CCM_FIRST + 1)
42583>>>>>Define PBS_SMOOTH      for |CI01
42583>>>>>Define PBS_VERTICAL    for |CI04
42583>>>>>Define PBM_SETRANGE    for (WM_USER+1)
42583>>>>>Define PBM_SETPOS      for (WM_USER+2)
42583>>>>>Define PBM_DELTAPOS    for (WM_USER+3)
42583>>>>>Define PBM_SETSTEP     for (WM_USER+4)
42583>>>>>Define PBM_STEPIT      for (WM_USER+5)
42583>>>>>Define PBM_SETRANGE32  for (WM_USER+6)     // lParam = high, wParam = low
42583>>>>>Define PBM_GETRANGE    for (WM_USER+7)
42583>>>>>Define PBM_GETPOS      for (WM_USER+8)
42583>>>>>Define PBM_SETBARCOLOR for (WM_USER+9)     // lParam = bar color
42583>>>>>Define PBM_SETBKCOLOR  for CCM_SETBKCOLOR  // lParam = bkColor
42583>>>>>
42583>>>>>//#ENDIF
42583>>>>>
42583>>>>>Function FCPWindowsMessage Global Integer iMsg Integer wParam Integer lParam Returns Integer
42584>>>>>    Handle hWnd
42585>>>>>    Get Window_Handle To hWnd
42586>>>>>    If (hWnd) Function_Return (SendMessage(hWnd, iMsg, wParam, lParam))
42589>>>>>End_Function
42590>>>>>
42590>>>>>
42590>>>>>External_Function FCP_9 "FCP_9" FCP.DLL Returns Integer
42591>>>>>
42591>>>>>Procedure Initialize_FCP_ProgressBar
42593>>>>>        Integer iVoid
42594>>>>>        Move (FCP_9()) to iVoid
42595>>>>>End_Procedure
42596>>>>>
42596>>>>>Send Initialize_FCP_ProgressBar
42597>>>>>
42597>>>>>
42597>>>>>Class FCP_ProgressBar is a DFControl
42598>>>>>    Procedure Construct_Object
42599>>>>>        Forward Send Construct_Object
42601>>>>>        Property integer private_piMinimum
42602>>>>>        Property integer private_piMaximum   100
42603>>>>>        Property integer private_piAdvanceBy 10
42604>>>>>        Property integer private_piPosition  0
42605>>>>>        Property Integer private_pbPercent   True
42606>>>>>        Property Integer private_pbVertical  False
42607>>>>>        Property Integer private_pbSmooth    True
42608>>>>>        Property Integer private_piBackColor clDefault
42609>>>>>        Property Integer private_piBarColor  clDefault
42610>>>>>        Property Integer private_piBarColor1 clDefault
42611>>>>>        Set External_Class_Name 'FCP_ProgressBar' To 'FCPProgressBar'
42612>>>>>        Set Border_Style to Border_StaticEdge
42613>>>>>        Set Focus_Mode To NonFocusable
42614>>>>>    End_Procedure
42615>>>>>
42615>>>>>        Function SysColor Integer iColor Returns Integer
42616>>>>>                if ((iColor<0) And (iColor<>clDefault)) Function_return (GetSysColor(iColor IAND |CI$FFFFFF))
42619>>>>>                Function_Return iColor
42620>>>>>        End_Function
42621>>>>>
42621>>>>>    Procedure Set piMinimum integer iMin
42622>>>>>        Integer iMax
42623>>>>>        Set private_piMinimum to iMin
42624>>>>>        Get private_piMaximum To iMax
42625>>>>>        Send Windows_Message PBM_SETRANGE32 iMin iMax
42626>>>>>    End_Procedure
42627>>>>>    Function piMinimum Returns Integer
42628>>>>>        If (Window_Handle(self)) Function_Return (FCPWindowsMessage(PBM_GETRANGE, 1, 0))
42631>>>>>        Else Function_Return (private_piMinimum(self))
42633>>>>>    End_Function
42634>>>>>
42634>>>>>    Procedure Set piMaximum integer iMax
42635>>>>>        Integer iMin
42636>>>>>        Set private_piMaximum to iMax
42637>>>>>        Get private_piMinimum To iMin
42638>>>>>        Send Windows_Message PBM_SETRANGE32 iMin iMax
42639>>>>>    End_Procedure
42640>>>>>    Function piMaximum Returns Integer
42641>>>>>        If (Window_Handle(self)) Function_Return (FCPWindowsMessage(PBM_GETRANGE, 0, 0))
42644>>>>>        Else Function_Return (private_piMaximum(self))
42646>>>>>    End_Function
42647>>>>>
42647>>>>>    Procedure Set piAdvanceBy integer iAdvanceBy
42648>>>>>        Set private_piAdvanceBy To iAdvanceBy
42649>>>>>        Send Windows_Message PBM_SETSTEP iAdvanceBy 0
42650>>>>>    End_Procedure
42651>>>>>    Function piAdvanceBy Returns Integer
42652>>>>>        Function_Return (private_piAdvanceBy(self))
42653>>>>>    End_Function
42654>>>>>
42654>>>>>    Procedure Set piPosition integer iPos
42655>>>>>        Set private_piPosition To iPos
42656>>>>>        Send Windows_Message PBM_SETPOS iPos 0
42657>>>>>    End_Procedure
42658>>>>>    Function piPosition Returns Integer
42659>>>>>        If (Window_Handle(self)) Function_Return (FCPWindowsMessage(PBM_GETPOS, 0, 0))
42662>>>>>        Else Function_Return (private_piPosition(self))
42664>>>>>    End_Function
42665>>>>>
42665>>>>>    Procedure Set pbVertical Integer bVertical
42666>>>>>        Set private_pbVertical To bVertical
42667>>>>>        Set Window_Style to PBS_VERTICAL bVertical
42668>>>>>    End_Procedure
42669>>>>>    Function pbVertical Returns Integer
42670>>>>>        Integer bVertical
42671>>>>>        If (Window_Handle(self)) Begin
42673>>>>>                Get Window_Style PBS_VERTICAL to bVertical
42674>>>>>                Function_Return bVertical
42675>>>>>        End
42675>>>>>>
42675>>>>>        Else Function_Return (private_pbVertical(self))
42677>>>>>    End_Function
42678>>>>>
42678>>>>>    Procedure Set pbSmooth Integer bSmooth
42679>>>>>        Set private_pbSmooth To bSmooth
42680>>>>>        Set Window_Style to PBS_SMOOTH bSmooth
42681>>>>>    End_Procedure
42682>>>>>    Function pbSmooth Returns Integer
42683>>>>>        Integer bSmooth
42684>>>>>        If (Window_Handle(self)) Begin
42686>>>>>                Get Window_Style PBS_SMOOTH to bSmooth
42687>>>>>                Function_Return bSmooth
42688>>>>>        End
42688>>>>>>
42688>>>>>        Function_Return (private_pbSmooth(self))
42689>>>>>    End_Function
42690>>>>>
42690>>>>>    Procedure Set pbPercent Integer bPercent
42691>>>>>        Set private_pbPercent To bPercent
42692>>>>>        Set Window_Style to PBS_Percent bPercent
42693>>>>>    End_Procedure
42694>>>>>    Function pbPercent Returns Integer
42695>>>>>        Integer bPercent
42696>>>>>        If (Window_Handle(self)) Begin
42698>>>>>                Get Window_Style PBS_Percent to bPercent
42699>>>>>                Function_Return bPercent
42700>>>>>        End
42700>>>>>>
42700>>>>>        Function_Return (private_pbPercent(self))
42701>>>>>    End_Function
42702>>>>>
42702>>>>>    Procedure Set piBackColor Integer rgbColor
42703>>>>>        Set private_piBackColor To rgbColor
42704>>>>>        Send Windows_Message PBM_SETBKCOLOR 0 (SysColor(Self,rgbColor))
42705>>>>>    End_Procedure
42706>>>>>    Function piBackColor Returns Integer
42707>>>>>        Function_Return (private_piBackColor(self))
42708>>>>>    End_Function
42709>>>>>
42709>>>>>    Procedure Set piBarColor Integer rgbColor
42710>>>>>        Set private_piBarColor To rgbColor
42711>>>>>        Send Windows_Message PBM_SETBARCOLOR 0 (SysColor(Self,rgbColor))
42712>>>>>    End_Procedure
42713>>>>>    Function piBarColor Returns Integer
42714>>>>>        Function_Return (private_piBarColor(self))
42715>>>>>    End_Function
42716>>>>>
42716>>>>>    Procedure Set piBarColor1 Integer rgbColor
42717>>>>>        Set private_piBarColor1 To rgbColor
42718>>>>>        Send Windows_Message PBM_SETBARCOLOR1 0 (SysColor(Self,rgbColor))
42719>>>>>    End_Procedure
42720>>>>>    Function piBarColor1 Returns Integer
42721>>>>>        Function_Return (private_piBarColor1(self))
42722>>>>>    End_Function
42723>>>>>
42723>>>>>
42723>>>>>    Procedure DoAdvance
42724>>>>>        Send Windows_Message PBM_STEPIT 0 0
42725>>>>>    End_procedure
42726>>>>>
42726>>>>>    Procedure DoAdvanceBy  integer iAdvanceBy
42727>>>>>        Send Windows_Message PBM_DELTAPOS iAdvanceBy 0
42728>>>>>    End_procedure
42729>>>>>
42729>>>>>    Procedure private_DoInitWindow
42730>>>>>        Set piBarColor  To (private_piBarColor(self))
42731>>>>>        Set piBarColor1  To (private_piBarColor1(self))
42732>>>>>        Set piBackColor To (private_piBackColor(self))
42733>>>>>        Set piAdvanceBy To (private_piAdvanceBy(self))
42734>>>>>        Set piMinimum   To (private_piMinimum(self))
42735>>>>>        Set piMaximum   To (private_piMaximum(self))
42736>>>>>        Set piPosition  To (private_piPosition(self))
42737>>>>>    End_Procedure
42738>>>>>
42738>>>>>    Procedure Page_Object integer iState
42739>>>>>        Handle hWnd
42740>>>>>        Get Window_Handle To hWnd
42741>>>>>        If (hWnd=0 and iState) Begin
42743>>>>>            Set Window_Style To PBS_VERTICAL (private_pbVertical(self))
42744>>>>>            Set Window_Style To PBS_SMOOTH   (private_pbSmooth(self))
42745>>>>>            Set Window_Style To PBS_PERCENT   (private_pbPercent(self))
42746>>>>>            Forward Send Page_Object True
42748>>>>>        End
42748>>>>>>
42748>>>>>        Else Forward Send Page_Object iState
42751>>>>>    End_Procedure
42752>>>>>
42752>>>>>    Procedure Page integer iState
42753>>>>>        Forward Send Page iState
42755>>>>>        If (iState =1) Send private_DoInitWindow
42758>>>>>    End_Procedure
42759>>>>>
42759>>>>>End_Class
42760>>>    Use Button.Sub
42760>>>
42760>>>    //AB-IgnoreEnd
42760>>>
42760>>>    DEFERRED_VIEW Activate_StoixEmp2 FOR ;    ;    Object StoixEmp2 is a ReportViewSub
42779>>>
42779>>>        //AB-StoreTopStart
42779>>>        
42779>>>        Property String  psModule       Public ''
42781>>>        property integer Epil           public 0
42783>>>        property integer piWhat         public 0
42785>>>        property integer piWhere        public 0
42787>>>        property string  psBranch       public ''
42789>>>        property string  psRep          public ''
42791>>>        Property Integer piPoios        Public 0
42793>>>        property string  psClientID     public ''
42795>>>        property string  psPrespID      public ''
42797>>>        property string  psSlsID        public ''
42799>>>        property string  psClientName   public ''
42801>>>        property string  psPrespName    public ''
42803>>>        property string  psSlsName      public ''
42805>>>        property integer piepidika      public 0
42807>>>        
42807>>>        property integer piyear         public 0
42809>>>        
42809>>>        //AB-StoreTopEnd
42809>>>
42809>>>        Set Label to "Management Information System  - Ž ¡¦¤¦£ ¡á v2"
42810>>>        Set Size to 234 455
42811>>>        Set Location to 4 11
42812>>>        Set Color to 10859729
42813>>>
42813>>>        //AB-DDOStart
42813>>>
42813>>>
42813>>>        //AB-DDOEnd
42813>>>
42813>>>        Object RadioGroupSub1 is a RadioGroupSub
42815>>>            Set Size to 105 151
42816>>>            Set Location to 1 3
42817>>>            Set Color to 10859729
42818>>>            Object Radio1 is a RadioSub
42820>>>                Set Label to "œ¢á«œª"
42821>>>                Set Size to 10 53
42822>>>                Set Location to 10 5
42823>>>                Set Color to 10859729
42824>>>            End_Object    // Radio1
42825>>>
42825>>>            Object Radio2 is a RadioSub
42827>>>                Set Label to "à¢ž«âª"
42828>>>                Set Size to 10 54
42829>>>                Set Location to 10 87
42830>>>                Set Color to 10859729
42831>>>            End_Object    // Radio2
42832>>>
42832>>>            Object Radio3 is a RadioSub
42834>>>                Set Label to "“§. ¢ž¨à£é¤"
42835>>>                Set Size to 10 65
42836>>>                Set Location to 25 5
42837>>>                Set Color to 10859729
42838>>>            End_Object    // Radio3
42839>>>
42839>>>            Object TextBoxSub28 is a TextBoxSub
42841>>>
42841>>>                //AB-StoreTopStart
42841>>>                                                                                                                                                                                                                                                                                                
42841>>>                //AB-StoreTopEnd
42841>>>
42841>>>                Set Label to "€¤ ›œ¤ œ§ ¢œšœå ©¬š¡œ¡¨ £â¤¦ª “§œçŸ. ã à¢ž«ãª «æ«œ «˜ œ¡«¬§à« ¡á Ÿ˜ ™š¦ç¤ ˜¤˜ “§œçŸ. ã à¢ž«ã"
42842>>>                Set Color to 10859729
42843>>>                Set TextColor to clYellow
42844>>>                Set Location to 37 5
42845>>>                Set Size to 25 142
42846>>>                Set Justification_Mode to jMode_Left
42847>>>                Set TypeFace to "MS Sans Serif"
42848>>>
42848>>>                //AB-StoreStart
42848>>>                                                                                                                                                                                                                                                                                                
42848>>>                Set TextColor to clYellow
42849>>>                
42849>>>                
42849>>>                //AB-StoreEnd
42849>>>
42849>>>            End_Object    // TextBoxSub28
42850>>>
42850>>>
42850>>>            //AB-StoreStart
42850>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
42852>>>                Integer isChecked
42853>>>                Set piPoios to iToItem
42854>>>            End_Procedure
42855>>>            
42855>>>            //AB-StoreEnd
42855>>>
42855>>>        End_Object    // RadioGroupSub1
42856>>>
42856>>>        Object GroupSub1 is a GroupSub
42858>>>            Set Label to "„§ ¢¦šã ”¦¨â˜"
42859>>>            Set Size to 28 283
42860>>>            Set Location to 1 158
42861>>>            Set Color to 10859729
42862>>>            Object F_CODE_APO is a FormSub
42864>>>
42864>>>                //AB-StoreTopStart
42864>>>                                                                                                                                                                                                                                                                                                
42864>>>                //AB-StoreTopEnd
42864>>>
42864>>>                Set Size to 13 65
42865>>>                Set Location to 10 60
42866>>>                Set Label_Col_Offset to 2
42867>>>                Set Label_Justification_Mode to jMode_Right
42868>>>                Set Prompt_Button_Mode to pb_PromptOn
42869>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
42870>>>
42870>>>                //AB-StoreStart
42870>>>                                                                                                                                                                                                                                                                                                
42870>>>                Set Prompt_Object to (SL100(Current_object))
42871>>>                
42871>>>                Procedure Prompt_Callback integer hPrompt
42873>>>                    set Export_Column of hPrompt to 0
42874>>>                    Set Initial_Column of hPrompt to 0
42875>>>                end_procedure
42876>>>                
42876>>>                procedure onchange
42878>>>                    String sclient
42879>>>                    Get value item 0 to sClient
42880>>>                    Set psClientID to sClient
42881>>>                    Move (fsclient(Self,sclient)) to sclient
42882>>>                    set value of (formsub3(self)) to sclient
42883>>>                    Set psClientName to sClient
42884>>>                end_procedure
42885>>>                
42885>>>                procedure prompt
42887>>>                    Set psModule Of (sl100(Self)) to (psModule(Self))
42888>>>                    Forward Send Prompt
42890>>>                end_procedure
42891>>>                
42891>>>                
42891>>>                
42891>>>                
42891>>>                //AB-StoreEnd
42891>>>
42891>>>            End_Object    // F_CODE_APO
42892>>>
42892>>>            Object TextBoxSub1 is a TextBoxSub
42894>>>                Set Label to "€§æ ‰à› ¡æ :"
42895>>>                Set Auto_Size_State to FALSE
42896>>>                Set Color to 10859729
42897>>>                Set FontSize to 4 0
42898>>>                Set Location to 11 5
42899>>>                Set Size to 10 44
42900>>>                Set TypeFace to "MS Sans Serif"
42901>>>                Set Enabled_State to TRUE
42902>>>            End_Object    // TextBoxSub1
42903>>>
42903>>>            Object FormSub3 is a FormSub
42905>>>                Set Size to 13 152
42906>>>                Set Location to 10 127
42907>>>                Set Color to 10859729
42908>>>                Set Label_Col_Offset to 2
42909>>>                Set Enabled_State to FALSE
42910>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
42911>>>                Set Item_Shadow_State Item 0 to TRUE
42912>>>                Set Shadow_State Item 0 to TRUE
42913>>>
42913>>>                //AB-StoreStart
42913>>>                set enabled_state to false
42914>>>                //AB-StoreEnd
42914>>>
42914>>>            End_Object    // FormSub3
42915>>>
42915>>>
42915>>>            //AB-StoreStart
42915>>>            Function StartNumber Returns string
42917>>>                Function_return (Value(f_code_apo(Current_object), 0))
42918>>>            End_function
42919>>>            
42919>>>            //AB-StoreEnd
42919>>>
42919>>>        End_Object    // GroupSub1
42920>>>
42920>>>        Object GroupSub3 is a GroupSub
42922>>>            Set Label to "„§ ¢¦šã „«¦¬ª/‹ã¤˜, à¢ž«ã && “§. ¢ž¨à£é¤"
42923>>>            Set Size to 148 283
42924>>>            Set Location to 36 158
42925>>>            Set Color to 10859729
42926>>>            Object TextBoxSub25 is a TextBoxSub
42928>>>                Set Label to "à¢ž«ãª"
42929>>>                Set Auto_Size_State to FALSE
42930>>>                Set Color to 10859729
42931>>>                Set FontSize to 4 0
42932>>>                Set Location to 42 7
42933>>>                Set Size to 10 31
42934>>>                Set TypeFace to "MS Sans Serif"
42935>>>                Set Enabled_State to TRUE
42936>>>            End_Object    // TextBoxSub25
42937>>>
42937>>>            Object frmYear is a FormSub
42939>>>                Set Size to 13 40
42940>>>                Set Location to 24 7
42941>>>                Set Label_Col_Offset to 2
42942>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
42943>>>
42943>>>                //AB-StoreStart
42943>>>                                                                                                                                                                                                                                                                                                
42943>>>                //        Procedure OnChange
42943>>>                //            Set piYear  to (Value(Self,0))
42943>>>                //        End_Procedure
42943>>>                
42943>>>                //AB-StoreEnd
42943>>>
42943>>>            End_Object    // frmYear
42944>>>
42944>>>            Object TextBoxSub26 is a TextBoxSub
42946>>>                Set Label to "“§. ¢ž¨à£é¤"
42947>>>                Set Auto_Size_State to FALSE
42948>>>                Set Color to 10859729
42949>>>                Set FontSize to 4 0
42950>>>                Set Location to 66 7
42951>>>                Set Size to 13 50
42952>>>                Set TypeFace to "MS Sans Serif"
42953>>>                Set Enabled_State to TRUE
42954>>>            End_Object    // TextBoxSub26
42955>>>
42955>>>            Object frmMonth is a FormSub
42957>>>                Set Size to 13 28
42958>>>                Set Location to 24 98
42959>>>                Set Label_Col_Offset to 2
42960>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
42961>>>
42961>>>                //AB-StoreStart
42961>>>                                                                                                                                                                                                                                                                                                
42961>>>                Procedure OnChange
42963>>>                    //Set piMonth to (Value(Self,0))
42963>>>                    Set Value Of frmMonthLekt Item 0 to ;                        (TheMonthName(Value(Self,0),mMonthOnom))
42964>>>                End_Procedure
42965>>>                
42965>>>                
42965>>>                //AB-StoreEnd
42965>>>
42965>>>            End_Object    // frmMonth
42966>>>
42966>>>            Object frmMonthLekt is a FormSub
42968>>>                Set Size to 13 109
42969>>>                Set Location to 24 132
42970>>>                Set Color to 10859729
42971>>>                Set Label_Col_Offset to 2
42972>>>                Set Enabled_State to FALSE
42973>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
42974>>>                Set Item_Shadow_State Item 0 to TRUE
42975>>>                Set Shadow_State Item 0 to TRUE
42976>>>            End_Object    // frmMonthLekt
42977>>>
42977>>>            Object frmPolhths is a FormSub
42979>>>
42979>>>                //AB-StoreTopStart
42979>>>                                                                                                                                                                                                                                                                                                
42979>>>                //AB-StoreTopEnd
42979>>>
42979>>>                Set Size to 13 83
42980>>>                Set Location to 52 7
42981>>>                Set Label_Col_Offset to 2
42982>>>                Set Label_Justification_Mode to jMode_Right
42983>>>                Set Prompt_Button_Mode to pb_PromptOn
42984>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
42985>>>
42985>>>                //AB-StoreStart
42985>>>                                                                                                                                                                                                                                                                                                
42985>>>                Set Prompt_Object to (sl108(Current_object))
42986>>>                Procedure Prompt_Callback integer hPrompt
42988>>>                    set Export_Column  of hPrompt to 0
42989>>>                    Set Initial_Column of hPrompt to 0
42990>>>                end_procedure
42991>>>                
42991>>>                procedure onchange
42993>>>                    string sclient
42994>>>                    get value item 0    to sclient
42995>>>                    Set psSlsID         to sClient
42996>>>                    Move (fsSalesmen(Self,sclient))         to sclient
42997>>>                    set value of (frmPolhthsDescr(self))    to sclient
42998>>>                    Set psSlsName to sClient
42999>>>                end_procedure
43000>>>                
43000>>>                
43000>>>                
43000>>>                
43000>>>                
43000>>>                //AB-StoreEnd
43000>>>
43000>>>            End_Object    // frmPolhths
43001>>>
43001>>>            Object frmPolhthsDescr is a FormSub
43003>>>                Set Size to 13 143
43004>>>                Set Location to 52 98
43005>>>                Set Color to 10859729
43006>>>                Set Label_Col_Offset to 2
43007>>>                Set Enabled_State to FALSE
43008>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
43009>>>                Set Item_Shadow_State Item 0 to TRUE
43010>>>                Set Shadow_State Item 0 to TRUE
43011>>>
43011>>>                //AB-StoreStart
43011>>>                set enabled_state to false
43012>>>                //AB-StoreEnd
43012>>>
43012>>>            End_Object    // frmPolhthsDescr
43013>>>
43013>>>            Object frmYpeyth is a FormSub
43015>>>
43015>>>                //AB-StoreTopStart
43015>>>                                                                                                                                                                                                                                                                                                
43015>>>                //AB-StoreTopEnd
43015>>>
43015>>>                Set Size to 13 83
43016>>>                Set Location to 79 7
43017>>>                Set Label_Col_Offset to 2
43018>>>                Set Label_Justification_Mode to jMode_Right
43019>>>                Set Prompt_Button_Mode to pb_PromptOn
43020>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
43021>>>
43021>>>                //AB-StoreStart
43021>>>                                                                                                                                                                                                                                                                                                
43021>>>                Set Prompt_Object to (sl111(Current_object))
43022>>>                
43022>>>                Procedure Prompt_Callback integer hPrompt
43024>>>                    set Export_Column  of hPrompt to 0
43025>>>                    Set Initial_Column of hPrompt to 0
43026>>>                end_procedure
43027>>>                
43027>>>                procedure onchange
43029>>>                    string sclient
43030>>>                    get value item 0    to sclient
43031>>>                    Set psPrespID       to sClient
43032>>>                    Move (fsPayresp(Self,sclient))      to sclient
43033>>>                    set value of (frmYpeythDescr(self)) to sclient
43034>>>                    Set psPrespName to sClient
43035>>>                end_procedure
43036>>>                
43036>>>                
43036>>>                
43036>>>                
43036>>>                
43036>>>                
43036>>>                
43036>>>                //AB-StoreEnd
43036>>>
43036>>>            End_Object    // frmYpeyth
43037>>>
43037>>>            Object frmYpeythDescr is a FormSub
43039>>>                Set Size to 13 143
43040>>>                Set Location to 79 98
43041>>>                Set Color to 10859729
43042>>>                Set Label_Col_Offset to 2
43043>>>                Set Enabled_State to FALSE
43044>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
43045>>>                Set Item_Shadow_State Item 0 to TRUE
43046>>>                Set Shadow_State Item 0 to TRUE
43047>>>
43047>>>                //AB-StoreStart
43047>>>                set enabled_state to false
43048>>>                //AB-StoreEnd
43048>>>
43048>>>            End_Object    // frmYpeythDescr
43049>>>
43049>>>            Object TextBoxSub1 is a TextBoxSub
43051>>>                Set Label to "„«¦ª"
43052>>>                Set Color to 10859729
43053>>>                Set Location to 13 7
43054>>>                Set Size to 10 19
43055>>>                Set TypeFace to "MS Sans Serif"
43056>>>            End_Object    // TextBoxSub1
43057>>>
43057>>>            Object TextBoxSub2 is a TextBoxSub
43059>>>                Set Label to "’¨â®¦¤ ‹ã¤˜ª"
43060>>>                Set Color to 10859729
43061>>>                Set Location to 13 98
43062>>>                Set Size to 10 49
43063>>>                Set TypeFace to "MS Sans Serif"
43064>>>            End_Object    // TextBoxSub2
43065>>>
43065>>>            Object FormSub1 is a FormSub
43067>>>                Set Size to 13 83
43068>>>                Set Location to 104 7
43069>>>                Set Label_Col_Offset to 2
43070>>>                Set Prompt_Button_Mode to pb_PromptOn
43071>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
43072>>>
43072>>>                //AB-StoreStart
43072>>>                                                                                                                                                                                                                                                                                                
43072>>>                                                                                                                                                                                                                                                                                                
43072>>>                Set Visible_State to False
43073>>>                Set Enabled_State to False
43074>>>                
43074>>>                
43074>>>                Set Prompt_Object to (sl002(Current_object))
43075>>>                
43075>>>                Procedure Prompt_Callback integer hPrompt
43077>>>                    set Export_Column of hPrompt to 0
43078>>>                    Set Initial_Column of hPrompt to 0
43079>>>                end_procedure
43080>>>                
43080>>>                procedure onchange
43082>>>                    string sbranch
43083>>>                    get value item 0 to sbranch
43084>>>                    clear branch
43085>>>                    move syscurxr.company_code to branch.company_code
43086>>>                    move sbranch               to branch.branch_code
43087>>>                    find eq branch by index.1
43088>>>>
43088>>>                    if (found=1) set value of (form2(self)) to branch.branch_name
43091>>>                    else         set value of (form2(self)) to ''
43093>>>                end_procedure
43094>>>                
43094>>>                
43094>>>                
43094>>>                
43094>>>                
43094>>>                
43094>>>                //AB-StoreEnd
43094>>>
43094>>>            End_Object    // FormSub1
43095>>>
43095>>>            Object Textbox1 is a Textbox
43097>>>                Set Label to "“§¦¡/£˜"
43098>>>                Set Color to 10859729
43099>>>                Set Location to 94 7
43100>>>                Set Size to 10 31
43101>>>                Set TypeFace to "MS Sans Serif"
43102>>>
43102>>>                //AB-StoreStart
43102>>>                                                                                                                                                                                                                                                                                                
43102>>>                Set Visible_State to False
43103>>>                
43103>>>                
43103>>>                //AB-StoreEnd
43103>>>
43103>>>            End_Object    // Textbox1
43104>>>
43104>>>            Object Form2 is a FormSub
43106>>>                Set Size to 13 143
43107>>>                Set Location to 103 99
43108>>>                Set Color to 10859729
43109>>>                Set Enabled_State to FALSE
43110>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
43111>>>                Set Item_Shadow_State Item 0 to TRUE
43112>>>                Set Shadow_State Item 0 to TRUE
43113>>>
43113>>>                //AB-StoreStart
43113>>>                                                                                                                                                                                                                                                                                                
43113>>>                Set Visible_State to False
43114>>>                Set Enabled_State to False
43115>>>                
43115>>>                //AB-StoreEnd
43115>>>
43115>>>            End_Object    // Form2
43116>>>
43116>>>            Object chkMhden is a CheckBoxSub
43118>>>                Set Label to "œ¢á«œª £œ 0  †€Š && †‘Ž"
43119>>>                Set Size to 10 109
43120>>>                Set Location to 125 8
43121>>>                Set Color to 10859729
43122>>>            End_Object    // chkMhden
43123>>>
43123>>>            Object chkApokripsi is a CheckBoxSub
43125>>>                Set Label to "•à¨ ª ›ž£ ¦¬¨šå˜ œ¡ «à¤ §¨à«â¨à¤ «à¤ 8 œšš¨˜­é¤/§œ¢á«ž"
43126>>>                Set Size to 10 225
43127>>>                Set Location to 135 8
43128>>>                Set Color to 10859729
43129>>>                Set Checked_State to TRUE
43130>>>            End_Object    // chkApokripsi
43131>>>
43131>>>
43131>>>            //AB-StoreStart
43131>>>                                                                                                                                                                                                                
43131>>>            Function fsPolhths Returns string
43133>>>                Function_return (Value(frmPolhths(Current_object), 0))
43134>>>            End_function
43135>>>            
43135>>>            Function fsYpeyth Returns string
43137>>>                Function_return (Value(frmYpeyth(Current_object), 0))
43138>>>            End_function
43139>>>            
43139>>>            Function fiYear Returns Integer
43141>>>                Function_return (Value(frmYear(Current_object), 0))
43142>>>            End_function
43143>>>            
43143>>>            Function fiMonth Returns Integer
43145>>>                Function_return (Value(frmMonth(Current_object), 0))
43146>>>            End_function
43147>>>            
43147>>>            Function fsMonth Returns String
43149>>>                Function_return (Value(frmMonthLekt(Current_object), 0))
43150>>>            End_function
43151>>>            
43151>>>            
43151>>>            
43151>>>            //AB-StoreEnd
43151>>>
43151>>>        End_Object    // GroupSub3
43152>>>
43152>>>        Object ButtonSub1 is a Button
43154>>>
43154>>>            //AB-StoreTopStart
43154>>>                                                                                                                                                                                                                
43154>>>            Object oPinakas is a Array
43156>>>            End_Object
43157>>>            
43157>>>            Object oPinakas2 is a Array
43159>>>            End_Object
43160>>>            
43160>>>            Object oPinHpal is a c2dArray
43162>>>                Set piNumColumns to 3
43163>>>            End_Object
43164>>>            
43164>>>            Function fiStoxosHpal String asCode Integer aiFlag Returns Integer
43166>>>                If (aiFlag=0) Begin
43168>>>                    Clear Clients
43169>>>                    Move asCode to Clients.Client_ID
43170>>>                    Find Eq Clients By Index.6
43171>>>>
43171>>>                    Function_Return Clients.Hpal
43172>>>                End
43172>>>>
43172>>>                Else If (aiFlag=1 )Begin
43175>>>                    Clear Payresp
43176>>>                    Move asCode to Payresp.Presp_ID
43177>>>                    Find Eq Payresp By Index.7
43178>>>>
43178>>>                    Function_Return Payresp.Stoxos_Ipal
43179>>>                End
43179>>>>
43179>>>                Else Begin
43180>>>                    Clear Salesmen
43181>>>                    Move asCode to Salesmen.sls_ID
43182>>>                    Find Eq Salesmen By Index.4
43183>>>>
43183>>>                    Function_Return Salesmen.sls_categfpa
43184>>>                End
43184>>>>
43184>>>            End_Function
43185>>>            
43185>>>            Function fiStoxosHpso String asCode Integer aiFlag Returns Integer
43187>>>                If (aiFlag=0) Begin
43189>>>                    Clear Clients
43190>>>                    Move asCode to Clients.Client_ID
43191>>>                    Find Eq Clients By Index.6
43192>>>>
43192>>>                    Function_Return Clients.Hpso
43193>>>                End
43193>>>>
43193>>>                Else If (aiFlag=1) Begin
43196>>>                    Clear Payresp
43197>>>                    Move asCode to Payresp.Presp_ID
43198>>>                    Find Eq Payresp By Index.7
43199>>>>
43199>>>                    Function_Return Payresp.Stoxos_Ipso
43200>>>                End
43200>>>>
43200>>>                Else Begin
43201>>>                    Clear Salesmen
43202>>>                    Move asCode to Salesmen.sls_ID
43203>>>                    Find Eq Salesmen By Index.4
43204>>>>
43204>>>                    Function_Return Salesmen.sls_fpa
43205>>>                End
43205>>>>
43205>>>            End_Function
43206>>>            
43206>>>            Function fsClientPayResp String asCode Returns String
43208>>>                Clear Clients
43209>>>                Move asCode to Clients.Client_ID
43210>>>                Find Eq Clients By Index.6
43211>>>>
43211>>>                Function_Return (Trim(Clients.Presp_ID))
43212>>>            End_Function
43213>>>            
43213>>>            //AB-StoreTopEnd
43213>>>
43213>>>            Set Bitmap to "RUNPROG.BMP"
43214>>>            Set Size to 18 28
43215>>>            Set Location to 198 410
43216>>>
43216>>>            //AB-StoreStart
43216>>>                                                                                                                                                                                                                
43216>>>            //Set TooltipValue to "Œœ˜ „§œ¥œ¨š˜©å˜ ¡˜  ˜§¦«œ¢â©£˜«˜"
43216>>>            
43216>>>            Procedure OnClick
43218>>>                Integer iYearTo iMonthTo iYearFrom iMonthFrom iBranch iDeikths iApokripsi iDeikths2
43219>>>                Date    dHmniaApo dHmniaEos dHmnia
43219>>>                String  sCompany sBranch sClientID s1  nOfeilh nAnoixtos iHpal sVal sName
43219>>>                String  iHpso sPrespID sClientID2
43219>>>                integer ihmgio iYes iFS iCount
43219>>>                Number  n1 n2
43219>>>            
43219>>>                Get Value Of (FormSub1(GroupSub3(Self)))    to sBranch
43220>>>                Move (Trim(sBranch))                        to sBranch
43221>>>                Set psBranch                                to sBranch
43222>>>            
43222>>>                Move SyscurXR.Company_Code                  to sCompany
43223>>>                Get fiYear  Of GroupSub3                    to iYearTo
43224>>>                Get fiMonth Of GroupSub3                    to iMonthTo
43225>>>                Move iMonthTo                               to iMonthFrom
43226>>>                Move (iYearTo-1)                            to iYearFrom
43227>>>            
43227>>>                // Basikoi elegxoi data entry filtra epiloghs
43227>>>                If ((iMonthTo<1) Or (iMonthTo>12)) Begin
43229>>>                    Send Stop_Box 'Š˜¤Ÿ˜©£â¤ž œ§ ¢¦šã £ã¤˜' '¨¦©¦®ã'
43230>>>                    Send Activate to (frmMonth(GroupSub3(Self)))
43231>>>                    Procedure_Return
43232>>>                End
43232>>>>
43232>>>                If ((iYearTo<2002) Or (iYearTo>2100)) Begin
43234>>>                    Send Stop_Box 'Š˜¤Ÿ˜©£â¤ž œ§ ¢¦šã â«¦¬ª' '¨¦©¦®ã'
43235>>>                    Send Activate to (frmyear(GroupSub3(Self)))
43236>>>                    Procedure_Return
43237>>>                End
43237>>>>
43237>>>                If (psClientID(Self)<>'') Begin
43239>>>                    Clear Clients
43240>>>                    Move (psClientID(Self)) to Clients.Client_ID
43241>>>                    Find Eq Clients By Index.6
43242>>>>
43242>>>                    If (Not(Found)) Begin
43244>>>                        Send Stop_Box '€¤ç§˜¨¡«¦ª œ¢á«žª' '¨¦©¦®ã'
43245>>>                        Send Activate to (f_code_apo(GroupSub1(Self)))
43246>>>                        Procedure_Return
43247>>>                    End
43247>>>>
43247>>>                End
43247>>>>
43247>>>                If (psSlsID(Self)<>'') Begin
43249>>>                    Clear Salesmen
43250>>>                    Move (psSlsID(Self)) to Salesmen.Sls_ID
43251>>>                    Find Eq Salesmen By Index.4
43252>>>>
43252>>>                    If (Not(Found)) Begin
43254>>>                        Send Stop_Box '€¤ç§˜¨¡«¦ª à¢ž«ãª' '¨¦©¦®ã'
43255>>>                        Send Activate to (frmPolhths(GroupSub3(Self)))
43256>>>                        Procedure_Return
43257>>>                    End
43257>>>>
43257>>>                End
43257>>>>
43257>>>                If (psPrespID(Self)<>'') Begin
43259>>>                    Clear Payresp
43260>>>                    Move (psPrespID(Self)) to Payresp.Presp_ID
43261>>>                    Find Eq Payresp By Index.7
43262>>>>
43262>>>                    If (Not(Found)) Begin
43264>>>                        Send Stop_Box '€¤ç§˜¨¡«¦ª ¬§œçŸ¬¤¦ª §¢ž¨à£é¤' '¨¦©¦®ã'
43265>>>                        Send Activate to (frmYpeyth(GroupSub3(Self)))
43266>>>                        Procedure_Return
43267>>>                    End
43267>>>>
43267>>>                End
43267>>>>
43267>>>            //
43267>>>                Zerofile Rptmp
43268>>>                Erasefile "c:\hpal.txt"
43269>>>>
43269>>>                Erasefile "c:\rptmp3.txt"
43270>>>>
43270>>>                Erasefile "c:\rptmp3ax.txt"
43271>>>>
43271>>>                Erasefile "c:\rptmp3axn.txt"
43272>>>>
43272>>>                Erasefile "c:\rptmp3di.txt"
43273>>>>
43273>>>                Erasefile "c:\rptmp3dN.txt"
43274>>>>
43274>>>                Erasefile "c:\rptmp4.txt"
43275>>>>
43275>>>                Erasefile "c:\rptmp5.txt"
43276>>>>
43276>>>                Erasefile "c:\rptmp6.txt"
43277>>>>
43277>>>                Erasefile "c:\RptmHP.txt"
43278>>>>
43278>>>                Erasefile "c:\Anoixtos.txt"
43279>>>>
43279>>>            
43279>>>                Move (DateCompose(TheDaySegment(EndOfMonth  (iMonthTo  ,iYearTo  )),iMonthTo  ,iYearTo  )) to dHmniaEos
43280>>>                Move (DateCompose(TheDaySegment(BeginOfMonth(iMonthFrom,iYearFrom)),iMonthFrom,iYearFrom)) to dHmniaApo
43281>>>            
43281>>>                Get Checked_State Of (chkApokripsi(GroupSub3(Self))) to iApokripsi
43282>>>            
43282>>>                If (Not(iApokripsi)) Begin
43284>>>                    // Make all records to keep all the rows for each client
43284>>>                    // or for 1 client
43284>>>                    If (piPoios(Self)=0) Begin
43286>>>                        If (psClientID(Self)<>'') Begin
43288>>>                            Clear Clients
43289>>>                            Move (psClientID(Self)) to Clients.Client_ID
43290>>>                            Find Eq Clients By Index.6
43291>>>>
43291>>>                            If (Not(Found)) Begin
43293>>>                                Send Stop_Box '€¤ç§˜¨¡«¦ª œ¢á«žª' '¨¦©¦®ã'
43294>>>                                Procedure_Return
43295>>>                            End
43295>>>>
43295>>>                            For iCount From 1 to 8
43301>>>>
43301>>>                                Clear Rptmp
43302>>>                                Move sCompany               to Rptmp.Company_Code
43303>>>                                Move sBranch                to Rptmp.Branch_Code
43304>>>                                Move Clients.Client_ID      to Rptmp.ID1
43305>>>                                Move iCount                 to Rptmp.Seira
43306>>>                                Move Clients.Client_Name    to Rptmp.Name1
43307>>>                                Move Clients.Hpso           to Rptmp.Stoxos_Hpso
43308>>>                                Move Clients.Hpal           to Rptmp.Stoxos_Hpal
43309>>>                                Saverecord Rptmp
43310>>>                            Loop
43311>>>>
43311>>>                        End
43311>>>>
43311>>>                        Else Begin
43312>>>                            File_Size Clients                   to iFS
43315>>>                            Set piMinimum   Of FCP_ProgressBar1 to 1
43316>>>                            Set piMaximum   Of FCP_ProgressBar1 to iFS
43317>>>                            Set piAdvanceBy Of FCP_ProgressBar1 to 1
43318>>>                            Set Label Of BtnMess to '¨¦œ«¦ £˜©å˜ æ¢à¤ «à¤ œšš¨˜­é¤'
43319>>>                            Clear Clients
43320>>>                            Move 1 to Clients.Is_Client
43321>>>                            Find Gt Clients By Index.7
43322>>>>
43322>>>                            While ((Found) And (Clients.Is_Client=1))
43326>>>                                Send DoAdvance Of FCP_ProgressBar1
43327>>>                                For iCount From 1 to 8
43333>>>>
43333>>>                                    Clear Rptmp
43334>>>                                    Move sCompany               to Rptmp.Company_Code
43335>>>                                    Move sBranch                to Rptmp.Branch_Code
43336>>>                                    Move Clients.Client_ID      to Rptmp.ID1
43337>>>                                    Move iCount                 to Rptmp.Seira
43338>>>                                    Move Clients.Client_Name    to Rptmp.Name1
43339>>>                                    Move Clients.Hpso           to Rptmp.Hpso
43340>>>                                    Move Clients.Hpal           to Rptmp.Hpal
43341>>>                                    Saverecord Rptmp
43342>>>                                Loop
43343>>>>
43343>>>                                Find Gt Clients By Index.7
43344>>>>
43344>>>                            Loop
43345>>>>
43345>>>                        End
43345>>>>
43345>>>                    End
43345>>>>
43345>>>                    Else If (piPoios(Self)=1) Begin
43348>>>                        If (psSlsID(Self)<>'') Begin
43350>>>                            Clear Salesmen
43351>>>                            Move (psSlsID(Self)) to Salesmen.SLS_ID
43352>>>                            Find Eq Salesmen By Index.4
43353>>>>
43353>>>                            If (Not(Found)) Begin
43355>>>                                Send Stop_Box '€¤ç§˜¨¡«¦ª à¢ž«ãª' '¨¦©¦®ã'
43356>>>                                Procedure_Return
43357>>>                            End
43357>>>>
43357>>>                            For iCount From 1 to 8
43363>>>>
43363>>>                                Clear Rptmp
43364>>>                                Move sCompany           to Rptmp.Company_Code
43365>>>                                Move sBranch            to Rptmp.Branch_Code
43366>>>                                Move Salesmen.Sls_ID    to Rptmp.ID1
43367>>>                                Move iCount             to Rptmp.Seira
43368>>>                                Move Salesmen.Sls_Name  to Rptmp.Name1
43369>>>                                Saverecord Rptmp
43370>>>                            Loop
43371>>>>
43371>>>                        End
43371>>>>
43371>>>                        Else Begin
43372>>>                            File_Size Salesmen                  to iFS
43375>>>                            Set piMinimum   Of FCP_ProgressBar1 to 1
43376>>>                            Set piMaximum   Of FCP_ProgressBar1 to iFS
43377>>>                            Set piAdvanceBy Of FCP_ProgressBar1 to 1
43378>>>                            Set Label Of BtnMess to '¨¦œ«¦ £˜©å˜ æ¢à¤ «à¤ œšš¨˜­é¤'
43379>>>                            Clear Salesmen
43380>>>                            Find Gt Salesmen.Recnum
43381>>>>
43381>>>                            While (Found)
43385>>>                                Send DoAdvance Of FCP_ProgressBar1
43386>>>                                For iCount From 1 to 8
43392>>>>
43392>>>                                    Clear Rptmp
43393>>>                                    Move sCompany          to Rptmp.Company_Code
43394>>>                                    Move sBranch           to Rptmp.Branch_Code
43395>>>                                    Move Salesmen.Sls_ID   to Rptmp.ID1
43396>>>                                    Move iCount            to Rptmp.Seira
43397>>>                                    Move Salesmen.Sls_Name to Rptmp.Name1
43398>>>                                    Saverecord Rptmp
43399>>>                                Loop
43400>>>>
43400>>>                                Find Gt Salesmen.Recnum
43401>>>>
43401>>>                            Loop
43402>>>>
43402>>>                        End
43402>>>>
43402>>>                    End
43402>>>>
43402>>>                    Else Begin
43403>>>                        If (psPrespID(Self)<>'') Begin
43405>>>                            Clear Payresp
43406>>>                            Move (psPrespID(Self)) to Payresp.Presp_ID
43407>>>                            Find Eq Payresp By Index.7
43408>>>>
43408>>>                            If (Not(Found)) Begin
43410>>>                                Send Stop_Box '€¤ç§˜¨¡«¦ª “§. ¢ž¨à£é¤' '¨¦©¦®ã'
43411>>>                                Procedure_Return
43412>>>                            End
43412>>>>
43412>>>                            For iCount From 1 to 8
43418>>>>
43418>>>                                Clear Rptmp
43419>>>                                Move sCompany           to Rptmp.Company_Code
43420>>>                                Move sBranch            to Rptmp.Branch_Code
43421>>>                                Move Payresp.Presp_ID   to Rptmp.ID1
43422>>>                                Move iCount             to Rptmp.Seira
43423>>>                                Move Payresp.Presp_Name to Rptmp.Name1
43424>>>                                Saverecord Rptmp
43425>>>                            Loop
43426>>>>
43426>>>                        End
43426>>>>
43426>>>                        Else Begin
43427>>>                            File_Size Payresp                   to iFS
43430>>>                            Set piMinimum   Of FCP_ProgressBar1 to 1
43431>>>                            Set piMaximum   Of FCP_ProgressBar1 to iFS
43432>>>                            Set piAdvanceBy Of FCP_ProgressBar1 to 1
43433>>>                            Set Label Of BtnMess to '¨¦œ«¦ £˜©å˜ æ¢à¤ «à¤ œšš¨˜­é¤'
43434>>>                            Clear Payresp
43435>>>                            Find Gt Payresp.Recnum
43436>>>>
43436>>>                            While (Found)
43440>>>                                Send DoAdvance Of FCP_ProgressBar1
43441>>>                                For iCount From 1 to 8
43447>>>>
43447>>>                                    Clear Rptmp
43448>>>                                    Move sCompany           to Rptmp.Company_Code
43449>>>                                    Move sBranch            to Rptmp.Branch_Code
43450>>>                                    Move Payresp.Presp_ID   to Rptmp.ID1
43451>>>                                    Move iCount             to Rptmp.Seira
43452>>>                                    Move Payresp.Presp_Name to Rptmp.Name1
43453>>>                                    Saverecord Rptmp
43454>>>                                Loop
43455>>>>
43455>>>                                Find Gt Payresp.Recnum
43456>>>>
43456>>>                            Loop
43457>>>>
43457>>>                        End
43457>>>>
43457>>>                    End
43457>>>>
43457>>>                End
43457>>>>
43457>>>            
43457>>>            
43457>>>            ///////////////////////////////////////////////////////////////
43457>>>            ///////////////////////////////////////////////////////////////
43457>>>                Number n30 n60 n90 n90Syn
43457>>>            
43457>>>                Set Label Of BtnMess to '“§¦¢¦š ©£¦å €¤á¢¬©žª €¤¦ ®«¦ç'
43458>>>                Send Run_Report to ReportMakeAnoixtosRecords
43459>>>            
43459>>>                Direct_Input Channel 9 'C:\Anoixtos.txt'
43461>>>                Send Delete_Data to oPinakas
43462>>>            
43462>>>                While (Not(Seqeof))
43466>>>                    Read    Channel 9 sClientID n30 n60 n90 n90Syn
43472>>>                    If (Trim(sClientID)='') Goto Telos_EdoN
43475>>>            
43475>>>                    // 17/02/2004
43475>>>                    // Ellhnikoi Xarakthres mesa sto ID
43475>>>                    If (Sysfile.version_Number='1') Move (ToOEM (sClientID)) to sClientID2
43478>>>                    Else Move sClientID to sClientID2
43480>>>            
43480>>>                    // Make record 2 pedia anoixtou +30 +60 +90 90+ (Array 26-29)
43480>>>                    Clear Rptmp
43481>>>                    Move sCompany   to Rptmp.Company_Code
43482>>>                    Move sBranch    to Rptmp.Branch_Code
43483>>>                    Move sClientID2 to Rptmp.ID1
43484>>>                    Move 2          to Rptmp.Seira
43485>>>                    Find Eq Rptmp By Index.1
43486>>>>
43486>>>            
43486>>>                    Move (Round_Number(n30   ,2)) to Rptmp.A30
43487>>>                    Move (Round_Number(n60   ,2)) to Rptmp.A60
43488>>>                    Move (Round_Number(n90   ,2)) to Rptmp.A90
43489>>>                    Move (Round_Number(n90Syn,2)) to Rptmp.A120
43490>>>            
43490>>>            
43490>>>                         If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID2)) to Rptmp.name1
43493>>>                    Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID2)) to Rptmp.name1
43497>>>                    Else                                                 Move (fsClient  (Self,sClientID2)) to Rptmp.name1
43499>>>                    If (Trim(Rptmp.name1)='') Begin
43501>>>                             If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID)) to Rptmp.name1
43504>>>                        Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID)) to Rptmp.name1
43508>>>                        Else                                                 Move (fsClient  (Self,sClientID)) to Rptmp.name1
43510>>>                    End
43510>>>>
43510>>>            
43510>>>                    Saverecord Rptmp
43511>>>            
43511>>>                    Set Label Of BtnMess to ('€¤á¢¬©ž €¤¦ ®«¦ç Š¦š/£¦ç'+'  '+String(rptmp.recnum))
43512>>>                    Readln  Channel 9
43514>>>                    Send Delete_Data to oPinakas
43515>>>                Loop
43516>>>>
43516>>>                Telos_EdoN:
43516>>>                Close_Input Channel 9 'C:\Anoixtos.txt'
43518>>>            
43518>>>            
43518>>>            ////////////////////////////////////////////////////////////////////////
43518>>>            //////////////////// Tziros kai M3 /////////////////////////////////////
43518>>>                Set Label Of BtnMess to '“§¦¢¦š ©£¦å ’å¨¦¬ ¡˜  ¡¬™ ¡é¤'
43519>>>                Send Run_Report to ReportMakeTzirosRecords
43520>>>                Send Delete_Data to oPinakas
43521>>>            
43521>>>                Direct_Input Channel 9 'C:\rptmp3.txt'
43523>>>            
43523>>>                While (Not(Seqeof))
43527>>>                    Read    Channel 9 sClientID sName
43530>>>                    If (Trim(sClientID)='') Goto Telos_Edo2N
43533>>>            
43533>>>                    // 17/02/2004
43533>>>                    // Ellhnikoi Xarakthres mesa sto ID
43533>>>                    If (Sysfile.version_Number='1') Move (ToOEM (sClientID)) to sClientID2
43536>>>                    Else Move sClientID to sClientID2
43538>>>            
43538>>>                    Send Delete_Data to oPinakas
43539>>>            
43539>>>                    // Gemizei to array apo 0-12 Tziros & 13-25 M3
43539>>>                    For iDeikths From 0 to 25
43545>>>>
43545>>>                        Read    Channel 9 s1
43547>>>                        Set Array_Value Of (oPinakas(Self)) Item iDeikths to s1
43548>>>                    Loop
43549>>>>
43549>>>                    // Ayta ta 2 read einai gia ta lektika ton synolon
43549>>>                    Read    Channel 9 s1 s1
43552>>>                    // Gemizei to array apo 26-38 Syn Tzirou & 39-51 Syn M3
43552>>>                    For iDeikths From 26 to 51
43558>>>>
43558>>>                        Read    Channel 9 s1
43560>>>                        Set Array_Value Of (oPinakas(Self)) Item iDeikths to s1
43561>>>                    Loop
43562>>>>
43562>>>            
43562>>>            
43562>>>                    // Make record 1 for M3 (Array 13-25)
43562>>>                    Clear Rptmp
43563>>>                    Move sCompany  to Rptmp.Company_Code
43564>>>                    Move sBranch   to Rptmp.Branch_Code
43565>>>                    Move sClientID2 to Rptmp.ID1
43566>>>                    Move 1         to Rptmp.Seira
43567>>>                    Find Eq Rptmp By Index.1
43568>>>>
43568>>>            
43568>>>                    For iDeikths From 13 to 25
43574>>>>
43574>>>                        Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
43575>>>                        Move (iDeikths-13)  to FieldIndex
43576>>>                        Add (Round_Number(n1,1)) to Rptmp.Mhnas_Trex&
43577>>>                    Loop
43578>>>>
43578>>>            
43578>>>                         If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID2)) to Rptmp.name1
43581>>>                    Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID2)) to Rptmp.name1
43585>>>                    Else                                                 Move (fsClient  (Self,sClientID2)) to Rptmp.name1
43587>>>                    If (Trim(Rptmp.name1)='') Begin
43589>>>                             If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID)) to Rptmp.name1
43592>>>                        Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID)) to Rptmp.name1
43596>>>                        Else                                                 Move (fsClient  (Self,sClientID)) to Rptmp.name1
43598>>>                    End
43598>>>>
43598>>>            
43598>>>                    Saverecord Rptmp
43599>>>            
43599>>>                    Set Label Of BtnMess to ('“§¦¢¦š ©£¦å ’å¨¦¬ ¡˜  ¡¬™ ¡é¤'+'  '+String(Rptmp.Recnum))
43600>>>            
43600>>>            
43600>>>                    // Make record 6 for Tziros (Array 0-12)
43600>>>                    Clear Rptmp
43601>>>                    Move sCompany  to Rptmp.Company_Code
43602>>>                    Move sBranch   to Rptmp.Branch_Code
43603>>>                    Move sClientID2 to Rptmp.ID1
43604>>>                    Move 6         to Rptmp.Seira
43605>>>                    Find Eq Rptmp By Index.1
43606>>>>
43606>>>                    For iDeikths From 0 to 12
43612>>>>
43612>>>                        Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
43613>>>                        Move iDeikths  to FieldIndex
43614>>>                        Add (Round_Number(n1,2)) to Rptmp.Mhnas_Trex&
43615>>>                    Loop
43616>>>>
43616>>>            
43616>>>                         If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID2)) to Rptmp.name1
43619>>>                    Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID2)) to Rptmp.name1
43623>>>                    Else                                                 Move (fsClient  (Self,sClientID2)) to Rptmp.name1
43625>>>                    If (Trim(Rptmp.name1)='') Begin
43627>>>                             If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID)) to Rptmp.name1
43630>>>                        Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID)) to Rptmp.name1
43634>>>                        Else                                                 Move (fsClient  (Self,sClientID)) to Rptmp.name1
43636>>>                    End
43636>>>>
43636>>>            
43636>>>                    Saverecord Rptmp
43637>>>            
43637>>>                    Set Label Of BtnMess to ('“§¦¢¦š ©£¦å ’å¨¦¬ ¡˜  ¡¬™ ¡é¤'+'  '+String(Rptmp.Recnum))
43638>>>                    Readln  Channel 9
43640>>>                Loop
43641>>>>
43641>>>                Telos_Edo2N:
43641>>>            
43641>>>            
43641>>>                // Make Synola record 1 for M3 (Array 39-51)
43641>>>                Clear Rptmp
43642>>>            
43642>>>                Move sCompany                                  to Rptmp.Company_Code
43643>>>                Move sBranch                                   to Rptmp.Branch_Code
43644>>>                Move '99999999'                                 to Rptmp.ID1
43645>>>                Move 1                                          to Rptmp.Seira
43646>>>                Find Eq Rptmp By Index.1
43647>>>>
43647>>>                For iDeikths From 39 to 51
43653>>>>
43653>>>                    Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
43654>>>                    Move (iDeikths-39)  to FieldIndex
43655>>>                    Add (Round_Number(n1,1)) to Rptmp.Mhnas_Trex&
43656>>>                Loop
43657>>>>
43657>>>                Move '——6ÿ‘ç¤¦¢˜ à¢ã©œ ª ‹3'                  to Rptmp.name1
43658>>>                Saverecord Rptmp
43659>>>            
43659>>>            
43659>>>                // Make Synola record 6 for Tziros (Array 26-38)
43659>>>                Clear Rptmp
43660>>>            
43660>>>                Move sCompany                                  to Rptmp.Company_Code
43661>>>                Move sBranch                                   to Rptmp.Branch_Code
43662>>>                Move '99999999'                                 to Rptmp.ID1
43663>>>                Move 6                                          to Rptmp.Seira
43664>>>                Find Eq Rptmp By Index.1
43665>>>>
43665>>>                For iDeikths From 26 to 38
43671>>>>
43671>>>                    Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
43672>>>                    Move (iDeikths-26)  to FieldIndex
43673>>>                    Add (Round_Number(n1,2)) to Rptmp.Mhnas_Trex&
43674>>>                Loop
43675>>>>
43675>>>                Move '——6ÿ‘ç¤¦¢˜ ’å¨¦¬'                        to Rptmp.name1
43676>>>                Saverecord Rptmp
43677>>>                Close_Input Channel 9 'C:\rptmp3.txt'
43679>>>            
43679>>>            
43679>>>            
43679>>>            ////////////////////////////////////////////////////////////////////////
43679>>>            //////  ‹ake record 3 aksiografon /////////////
43679>>>                Set Label Of BtnMess to '“§¦¢¦š ©£¦å „ ©§¨˜¡«âà¤ €¥ ¦š¨á­à¤'
43680>>>                Set Report_Name     of ReportMakeAxioRecords to "rptmp3ax.rpt"
43681>>>                Set ExportFileName  of ReportMakeAxioRecords to "c:\rptmp3ax.txt"
43682>>>                Set piEpidika       of ReportMakeAxioRecords to 0
43683>>>                Send Run_Report to ReportMakeAxioRecords
43684>>>                Send Delete_Data to oPinakas
43685>>>            
43685>>>                Direct_Input Channel 9 'C:\rptmp3ax.txt'
43687>>>            
43687>>>                //
43687>>>            
43687>>>                While (Not(Seqeof))
43691>>>                    Read    Channel 9 sClientID sName
43694>>>                    If (Trim(sClientID)='') Goto Telos_Edo3N
43697>>>                    // 17/02/2004
43697>>>                    // Ellhnikoi Xarakthres mesa sto ID
43697>>>                    If (Sysfile.version_Number='1') Move (ToOEM (sClientID)) to sClientID2
43700>>>                    Else Move sClientID to sClientID2
43702>>>            
43702>>>                    Send Delete_Data to oPinakas
43703>>>            
43703>>>                    // Gemizei to array apo 0-12 aksiografa
43703>>>                    For iDeikths From 0 to 12
43709>>>>
43709>>>                        Read    Channel 9 s1
43711>>>                        Set Array_Value Of (oPinakas(Self)) Item iDeikths to s1
43712>>>                    Loop
43713>>>>
43713>>>                    // Ayta ta 2 read einai gia ta lektika ton synolon
43713>>>                    Read    Channel 9 s1 s1
43716>>>                    // Gemizei to array apo 13-25 Syn aksiografon
43716>>>                    For iDeikths From 13 to 25
43722>>>>
43722>>>                        Read    Channel 9 s1
43724>>>                        Set Array_Value Of (oPinakas(Self)) Item iDeikths to s1
43725>>>                    Loop
43726>>>>
43726>>>            
43726>>>            
43726>>>                    // Make record 3 for axiografa (Array 0-12)
43726>>>                    Clear Rptmp
43727>>>            
43727>>>                    Move sCompany  to Rptmp.Company_Code
43728>>>                    Move sBranch   to Rptmp.Branch_Code
43729>>>                    Move sClientID2 to Rptmp.ID1
43730>>>                    Move 3         to Rptmp.Seira
43731>>>                    Find Eq Rptmp By Index.1
43732>>>>
43732>>>                    For iDeikths From 0 to 12
43738>>>>
43738>>>                        Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
43739>>>                        Move iDeikths   to FieldIndex
43740>>>                        Add (Round_Number(n1,2)) to Rptmp.Mhnas_Trex&
43741>>>                    Loop
43742>>>>
43742>>>                         If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID2)) to Rptmp.name1
43745>>>                    Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID2)) to Rptmp.name1
43749>>>                    Else                                                 Move (fsClient  (Self,sClientID2)) to Rptmp.name1
43751>>>                    If (Trim(Rptmp.name1)='') Begin
43753>>>                             If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID)) to Rptmp.name1
43756>>>                        Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID)) to Rptmp.name1
43760>>>                        Else                                                 Move (fsClient  (Self,sClientID)) to Rptmp.name1
43762>>>                    End
43762>>>>
43762>>>            
43762>>>                    Saverecord Rptmp
43763>>>            
43763>>>                    Set Label Of BtnMess to ('“§¦¢¦š ©£¦å „ ©§¨˜¡«âà¤ €¥ ¦š¨á­à¤'+'  '+String(Rptmp.Recnum))
43764>>>                    Readln  Channel 9
43766>>>                loop
43767>>>>
43767>>>                Telos_Edo3N:
43767>>>            
43767>>>            
43767>>>                // Make Synola record 3 for aksiografa synola (Array 13-25)
43767>>>                Clear Rptmp
43768>>>            
43768>>>                Move sCompany                                  to Rptmp.Company_Code
43769>>>                Move sBranch                                   to Rptmp.Branch_Code
43770>>>                Move '99999999'                                to Rptmp.ID1
43771>>>                Move 3                                         to Rptmp.Seira
43772>>>                Find Eq Rptmp By Index.1
43773>>>>
43773>>>                For iDeikths From 13 to 25
43779>>>>
43779>>>                    Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
43780>>>                    Move (iDeikths-13)  to FieldIndex
43781>>>                    Add (Round_Number(n1,2)) to Rptmp.Mhnas_Trex&
43782>>>                Loop
43783>>>>
43783>>>                Move '——3ÿ‘ç¤¦¢˜ „ ©§¨˜¡«âà¤ €¥ ¦š¨á­à¤'       to Rptmp.name1
43784>>>                Saverecord Rptmp
43785>>>                Close_Input Channel 9 'C:\rptmp3ax.txt'
43787>>>            
43787>>>            
43787>>>            ////////////////////////////////////////////////////////////////////////
43787>>>            //// Neos kodikas & report gia ta epidika
43787>>>            //// me thn nea logikh tou Btypkin.Gtypkin_Code
43787>>>            //// to opoio an exei timh 0 tote ola doyleyoun opos prepei,
43787>>>            //// an exei timh 1 tote DEN lamvanetai yp opsin to poso
43787>>>            //// kai an exei timh 2 tote to poso tou axiografou erxetai arnhtika
43787>>>            //// Edo asxoloumaste MONO me to record 4 ton epidikon
43787>>>            /////////////////////////////////////////////////////////////////////////
43787>>>                Erasefile "c:\rptmp3dN.txt"
43788>>>>
43788>>>                Set Label Of BtnMess to '“§¦¢¦š ©£¦å „§å› ¡à¤ €¥ ¦š¨á­à¤'
43789>>>                Set Report_Name     of ReportMakeAxioRecords to "rptmp3diNew.rpt"
43790>>>                Set ExportFileName  of ReportMakeAxioRecords to "c:\rptmp3dN.txt"
43791>>>                Set piEpidika       of ReportMakeAxioRecords to 1
43792>>>                Send Run_Report to ReportMakeAxioRecords
43793>>>                Send Delete_Data to oPinakas
43794>>>            
43794>>>                Direct_Input Channel 9 'C:\rptmp3dN.txt'
43796>>>            
43796>>>                While (Not(Seqeof))
43800>>>                    Read    Channel 9 sClientID sName
43803>>>                    If (Trim(sClientID)='') Goto Telos_Edo3N_1N
43806>>>                    // 17/02/2004
43806>>>                    // Ellhnikoi Xarakthres mesa sto ID
43806>>>                    If (Sysfile.version_Number='1') Move (ToOEM (sClientID)) to sClientID2
43809>>>                    Else Move sClientID to sClientID2
43811>>>            
43811>>>                    Send Delete_Data to oPinakas
43812>>>            
43812>>>                    // Gemizei to array apo 0-14 aksiografa
43812>>>                    For iDeikths From 0 to 14
43818>>>>
43818>>>                        Read    Channel 9 s1
43820>>>                        Set Array_Value Of (oPinakas(Self)) Item iDeikths to s1
43821>>>                    Loop
43822>>>>
43822>>>                    // Ayta ta 2 read einai gia ta lektika ton synolon
43822>>>                    Read    Channel 9 s1 s1
43825>>>                    // Gemizei to array apo 15-27 Syn aksiografon
43825>>>                    For iDeikths From 15 to 27
43831>>>>
43831>>>                        Read    Channel 9 s1
43833>>>                        Set Array_Value Of (oPinakas(Self)) Item iDeikths to s1
43834>>>                    Loop
43835>>>>
43835>>>            
43835>>>                    // Make record 4 for œ§ › ¡˜ aksiografa (Array 0-12) +2 gia synola epit/synal
43835>>>                    Clear Rptmp
43836>>>            
43836>>>                    Move sCompany  to Rptmp.Company_Code
43837>>>                    Move sBranch   to Rptmp.Branch_Code
43838>>>                    Move sClientID2 to Rptmp.ID1
43839>>>                    Move 4         to Rptmp.Seira
43840>>>                    Find Eq Rptmp By Index.1
43841>>>>
43841>>>                    For iDeikths From 0 to 14
43847>>>>
43847>>>                        Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
43848>>>                        If (iDeikths>12) Begin
43850>>>                            If (iDeikths=13) Add (Round_Number(n1,2)) to Rptmp.Epid_Epitag
43853>>>                            Else             Add (Round_Number(n1,2)) to Rptmp.Epid_Synal
43855>>>                        End
43855>>>>
43855>>>                        Else Begin
43856>>>                            Move iDeikths   to FieldIndex
43857>>>                            Add (Round_Number(n1,2)) to Rptmp.Mhnas_Trex&
43858>>>                        End
43858>>>>
43858>>>                    Loop
43859>>>>
43859>>>            
43859>>>                         If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID2)) to Rptmp.name1
43862>>>                    Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID2)) to Rptmp.name1
43866>>>                    Else                                                 Move (fsClient  (Self,sClientID2)) to Rptmp.name1
43868>>>                    If (Trim(Rptmp.name1)='') Begin
43870>>>                             If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID)) to Rptmp.name1
43873>>>                        Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID)) to Rptmp.name1
43877>>>                        Else                                                 Move (fsClient  (Self,sClientID)) to Rptmp.name1
43879>>>                    End
43879>>>>
43879>>>            
43879>>>                    Saverecord Rptmp
43880>>>            
43880>>>            
43880>>>                    Set Label Of BtnMess to ('“§¦¢¦š ©£¦å „§å› ¡à¤ €¥ ¦š¨á­à¤'+'  '+String(Rptmp.Recnum))
43881>>>                    Readln  Channel 9
43883>>>                loop
43884>>>>
43884>>>                Telos_Edo3N_1N:
43884>>>            
43884>>>                // Make Synola record 4 for aksiografa synola (Array 13-25)
43884>>>                Clear Rptmp
43885>>>                Move sCompany                                  to Rptmp.Company_Code
43886>>>                Move sBranch                                   to Rptmp.Branch_Code
43887>>>                Move '99999999'                                to Rptmp.ID1
43888>>>                Move 4                                         to Rptmp.Seira
43889>>>                Find Eq Rptmp By Index.1
43890>>>>
43890>>>                For iDeikths From 15 to 27
43896>>>>
43896>>>                    Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
43897>>>                    Move (iDeikths-15)  to FieldIndex
43898>>>                    Add (Round_Number(n1,2)) to Rptmp.Mhnas_Trex&
43899>>>                Loop
43900>>>>
43900>>>                Move '——4ÿ‘ç¤¦¢˜ „§å› ¡à¤ €¥ ¦š¨á­à¤'          to Rptmp.name1
43901>>>                Saverecord Rptmp
43902>>>            
43902>>>                Close_Input Channel 9 'C:\rptmp3dN.txt'
43904>>>            
43904>>>            
43904>>>            
43904>>>            
43904>>>            ////////////////////////////////////////////////////////////////////////
43904>>>            //////////////////// Anoixtos Logar + Syn. Ofeilh///////////////////////
43904>>>            ////////////////////////////////////////////////////////////////////////
43904>>>            
43904>>>                Set Label Of BtnMess to '¨¦œ«¦ £˜©å˜ €¤¦ ®«¦ç Š¦š/£¦ç && ‘¬¤. Ž­œ ¢ãª'
43905>>>                Send Run_Report to ReportMakeOfeilhRecords
43906>>>                Send Delete_Data to oPinakas
43907>>>            
43907>>>                Direct_Input Channel 9 'C:\rptmp4.txt'
43909>>>            
43909>>>                While (Not(Seqeof))
43913>>>                    Read    Channel 9 sClientID sName
43916>>>                    If (Trim(sClientID)='') Goto Telos_Edo4N
43919>>>            
43919>>>                    // 17/02/2004
43919>>>                    // Ellhnikoi Xarakthres mesa sto ID
43919>>>                    If (Sysfile.version_Number='1') Move (ToOEM (sClientID)) to sClientID2
43922>>>                    Else Move sClientID to sClientID2
43924>>>            
43924>>>                    Send Delete_Data to oPinakas
43925>>>                    // Gemizei to array apo 0-12 An.Logariasmos
43925>>>                    For iDeikths From 0 to 12
43931>>>>
43931>>>                        Read    Channel 9 s1
43933>>>                        Set Array_Value Of (oPinakas(Self)) Item iDeikths to s1
43934>>>                    Loop
43935>>>>
43935>>>            
43935>>>                    // Make record 2 and 5 for Anoixtos Logariasmos and Syn Ofeilh (Array 0-12)
43935>>>                    // Oles oi xreoseis kai oi pistoseis apo kykloma cmoves.
43935>>>                    // diamorfonoun A.Log & S. Ofeilh
43935>>>                    Clear Rptmp
43936>>>                    Move sCompany  to Rptmp.Company_Code
43937>>>                    Move sBranch   to Rptmp.Branch_Code
43938>>>                    Move sClientID2 to Rptmp.ID1
43939>>>                    Move 2         to Rptmp.Seira
43940>>>                    Find Eq Rptmp By Index.1
43941>>>>
43941>>>                    For iDeikths From 0 to 12
43947>>>>
43947>>>                        Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
43948>>>                        Move iDeikths  to FieldIndex
43949>>>                        Add (Round_Number(n1,2)) to Rptmp.Mhnas_Trex&
43950>>>                    Loop
43951>>>>
43951>>>                         If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID2)) to Rptmp.name1
43954>>>                    Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID2)) to Rptmp.name1
43958>>>                    Else                                                 Move (fsClient  (Self,sClientID2)) to Rptmp.name1
43960>>>                    If (Trim(Rptmp.name1)='') Begin
43962>>>                             If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID)) to Rptmp.name1
43965>>>                        Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID)) to Rptmp.name1
43969>>>                        Else                                                 Move (fsClient  (Self,sClientID)) to Rptmp.name1
43971>>>                    End
43971>>>>
43971>>>                    Saverecord Rptmp
43972>>>            
43972>>>                    Clear Rptmp
43973>>>                    Move sCompany  to Rptmp.Company_Code
43974>>>                    Move sBranch   to Rptmp.Branch_Code
43975>>>                    Move sClientID2 to Rptmp.ID1
43976>>>                    Move 5         to Rptmp.Seira
43977>>>                    Find Eq Rptmp By Index.1
43978>>>>
43978>>>                    For iDeikths From 0 to 12
43984>>>>
43984>>>                        Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
43985>>>                        Move iDeikths  to FieldIndex
43986>>>                        Add (Round_Number(n1,2)) to Rptmp.Mhnas_Trex&
43987>>>                    Loop
43988>>>>
43988>>>                         If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID2)) to Rptmp.name1
43991>>>                    Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID2)) to Rptmp.name1
43995>>>                    Else                                                 Move (fsClient  (Self,sClientID2)) to Rptmp.name1
43997>>>                    If (Trim(Rptmp.name1)='') Begin
43999>>>                             If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID)) to Rptmp.name1
44002>>>                        Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID)) to Rptmp.name1
44006>>>                        Else                                                 Move (fsClient  (Self,sClientID)) to Rptmp.name1
44008>>>                    End
44008>>>>
44008>>>                    Saverecord Rptmp
44009>>>            
44009>>>            
44009>>>                    // Make Synola record 2 for Anoixtos logariasmos
44009>>>                    Clear Rptmp
44010>>>                    Move sCompany                                  to Rptmp.Company_Code
44011>>>                    Move sBranch                                   to Rptmp.Branch_Code
44012>>>                    Move '99999999'                                to Rptmp.ID1
44013>>>                    Move 2                                         to Rptmp.Seira
44014>>>                    Find Eq Rptmp By Index.1
44015>>>>
44015>>>                    For iDeikths From 0 to 12
44021>>>>
44021>>>                        Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
44022>>>                        Move iDeikths   to FieldIndex
44023>>>                        Add (Round_Number(n1,2)) to Rptmp.Mhnas_Trex&
44024>>>                    Loop
44025>>>>
44025>>>                    Move '——2ÿ‘ç¤¦¢˜ €¤¦ ®«¦ç Š¦š˜¨ ˜©£¦ç'       to Rptmp.name1
44026>>>                    Saverecord Rptmp
44027>>>            
44027>>>                    // Make Synola record 5 for synolikh ofeilh
44027>>>                    Clear Rptmp
44028>>>                    Move sCompany                                  to Rptmp.Company_Code
44029>>>                    Move sBranch                                   to Rptmp.Branch_Code
44030>>>                    Move '99999999'                                to Rptmp.ID1
44031>>>                    Move 5                                         to Rptmp.Seira
44032>>>                    Find Eq Rptmp By Index.1
44033>>>>
44033>>>                    For iDeikths From 0 to 12
44039>>>>
44039>>>                        Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
44040>>>                        Move iDeikths   to FieldIndex
44041>>>                        Add (Round_Number(n1,2)) to Rptmp.Mhnas_Trex&
44042>>>                    Loop
44043>>>>
44043>>>                    Move '——5ÿ‘ç¤¦¢˜ ‘¬¤¦¢ ¡ãª Ž­œ ¢ãª'       to Rptmp.name1
44044>>>                    Saverecord Rptmp
44045>>>            
44045>>>                    Set Label Of BtnMess to ('¨¦œ«¦ £˜©å˜ €¤¦ ®«¦ç Š¦š/£¦ç && ‘¬¤. Ž­œ ¢ãª'+'  '+Trim(sClientID2)+' '+String(Rptmp.Recnum))
44046>>>                    Readln  Channel 9
44048>>>                Loop
44049>>>>
44049>>>                Telos_Edo4N:
44049>>>            
44049>>>                Close_Input Channel 9 'C:\rptmp4.txt'
44051>>>            
44051>>>            
44051>>>                //////////////////////////////////////////////////////////////////
44051>>>                // Anadiorganosh An.logariasmou & Syn. Ofeilhs Ana Pelath/Ypeuthyno
44051>>>                // me thn logikh oti gia kathe mhna prosthetoume tous pio piso
44051>>>                // PROSOXH KANEI ANADIORGANOSH KAI STA SYNOLA
44051>>>                //////////////////////////////////////////////////////////////////
44051>>>                Number nTotal
44051>>>                Move 0 to nTotal
44052>>>                Clear Rptmp
44053>>>                Move sCompany  to Rptmp.Company_Code
44054>>>                Move sBranch   to Rptmp.Branch_Code
44055>>>                Move 2         to Rptmp.Seira
44056>>>                Find Gt Rptmp By Index.6
44057>>>>
44057>>>                While ((Found=1) And (sCompany=Rptmp.Company_Code) And (sBranch=Rptmp.Branch_Code) And (Rptmp.Seira=2))
44061>>>                    Move 12 to iCount
44062>>>                    For iDeikths2 From 0 to 12
44068>>>>
44068>>>                        Move 0 to nTotal
44069>>>                        For iDeikths From iDeikths2 to iCount
44075>>>>
44075>>>                            Move iDeikths  to FieldIndex
44076>>>                            Add Rptmp.Mhnas_Trex& to nTotal
44077>>>                        Loop
44078>>>>
44078>>>                        Move iDeikths2  to FieldIndex
44079>>>                        Move nTotal     to Rptmp.Mhnas_Trex&
44080>>>                    Loop
44081>>>>
44081>>>                    Saverecord Rptmp
44082>>>                    Set Label Of BtnMess to ('ƒ ˜£æ¨­à©ž €¤¦ ®«¦ç Š¦š/£¦ç '+'  '+Trim(Rptmp.ID1)+' '+String(Rptmp.Recnum))
44083>>>            
44083>>>                    Find Gt Rptmp By Index.6
44084>>>>
44084>>>                Loop
44085>>>>
44085>>>            
44085>>>                Move 0 to nTotal
44086>>>                Clear Rptmp
44087>>>                Move sCompany  to Rptmp.Company_Code
44088>>>                Move sBranch   to Rptmp.Branch_Code
44089>>>                Move 5         to Rptmp.Seira
44090>>>                Find Gt Rptmp By Index.6
44091>>>>
44091>>>                While ((Found=1) And (sCompany=Rptmp.Company_Code) And (sBranch=Rptmp.Branch_Code) And (Rptmp.Seira=5))
44095>>>                    Move 12 to iCount
44096>>>                    For iDeikths2 From 0 to 12
44102>>>>
44102>>>                        Move 0 to nTotal
44103>>>                        For iDeikths From iDeikths2 to iCount
44109>>>>
44109>>>                            Move iDeikths  to FieldIndex
44110>>>                            Add Rptmp.Mhnas_Trex& to nTotal
44111>>>                        Loop
44112>>>>
44112>>>                        Move iDeikths2  to FieldIndex
44113>>>                        Move nTotal to Rptmp.Mhnas_Trex&
44114>>>                    Loop
44115>>>>
44115>>>                    Saverecord Rptmp
44116>>>                    Set Label Of BtnMess to ('ƒ ˜£æ¨­à©ž ‘¬¤. Ž­œ ¢ãª'+'  '+Trim(Rptmp.Id1)+' '+String(Rptmp.Recnum))
44117>>>            
44117>>>                    Find Gt Rptmp By Index.6
44118>>>>
44118>>>                Loop
44119>>>>
44119>>>            
44119>>>            ////////////////////////////////////////////////////////////////////////
44119>>>            ////////            Make record 5 Synolilh ofeilh          /////////////
44119>>>            ////////            ¨¦©Ÿœ«¦¬£œ «˜ ˜¢ž¡«˜ ˜¥ ¦š¨˜­˜        /////////////
44119>>>            ////////////////////////////////////////////////////////////////////////
44119>>>            //   Nea logikh gia Posa Synolikon ofeilon
44119>>>            ////////////////////////////////////////////////////////////////////////
44119>>>                Integer jj jMhnas jEtos kMhnas kEtos
44119>>>                Date    ddate
44119>>>            
44119>>>                Get fiYear  Of GroupSub3  to iYearTo
44120>>>                Get fiMonth Of GroupSub3  to iMonthTo
44121>>>            
44121>>>                For jj From 0 to 12
44127>>>>
44127>>>            
44127>>>                    Move (iMonthTo-jj) to jMhnas
44128>>>                    Move iYearTo       to kEtos
44129>>>            
44129>>>                    If (jMhnas<=0) Begin
44131>>>                        Move (12-(ABS(jMhnas))) to kMhnas
44132>>>                        Move (iYearTo-1)        to kEtos
44133>>>                    End
44133>>>>
44133>>>                    Else Move jMhnas            to kMhnas
44135>>>            
44135>>>                    Set piTrexonEtos  Of ReportMakeEisprakteaAxiografa to kEtos
44136>>>                    Set piTrexonMhnas Of ReportMakeEisprakteaAxiografa to kMhnas
44137>>>            
44137>>>                    Move (DateCompose(TheDaySegment(beginOfMonth(kMhnas,(kEtos  ))),kMhnas,(kEtos  ))) to ddate
44138>>>                    Move (DateCompose(TheDaySegment(endOfMonth  (kMhnas,(kEtos  ))),kMhnas,(kEtos  ))) to dhmniaeos
44139>>>                    Move (DateCompose(TheDaySegment(BeginOfMonth(kMhnas,(kEtos-1))),kMhnas,(kEtos-1))) to dHmniaApo
44140>>>            
44140>>>            
44140>>>                    Set Label Of BtnMess to 'ƒ ˜®¨¦¤ ¡¦å “§¦¢/©£¦å „ ©§¨. €¥ ¦š¨á­à¤'
44141>>>                    Set Report_Name     of ReportMakeEisprakteaAxiografa to "rptmp3axn.rpt"
44142>>>                    Set ExportFileName  of ReportMakeEisprakteaAxiografa to ("c:\"+String(jj)+".txt")
44143>>>                    Send Run_Report to ReportMakeEisprakteaAxiografa
44144>>>            
44144>>>                    Send Delete_Data to oPinakas
44145>>>            
44145>>>                    Direct_Input Channel 9 ("c:\"+String(jj)+".txt")
44147>>>            
44147>>>                    //
44147>>>            
44147>>>                    While (Not(Seqeof))
44151>>>                        Read    Channel 9 sClientID sName n1
44155>>>                        If (Trim(sClientID)='') Goto Telos_Edo3axn
44158>>>                        // 17/02/2004
44158>>>                        // Ellhnikoi Xarakthres mesa sto ID
44158>>>                        If (Sysfile.version_Number='1') Move (ToOEM (sClientID)) to sClientID2
44161>>>                        Else Move sClientID to sClientID2
44163>>>            
44163>>>                        // Make record 5 for Synolikh ofeilh (Array 0-12)
44163>>>                        Clear Rptmp
44164>>>                        Move sCompany  to Rptmp.Company_Code
44165>>>                        Move sBranch   to Rptmp.Branch_Code
44166>>>                        Move sClientID2 to Rptmp.ID1
44167>>>                        Move 5         to Rptmp.Seira
44168>>>                        Find Eq Rptmp By Index.1
44169>>>>
44169>>>                        //Move s1 to n1
44169>>>                        Move jj to FieldIndex
44170>>>                        Add (Round_Number(n1,2)) to Rptmp.Mhnas_Trex&
44171>>>            
44171>>>                             If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID2)) to Rptmp.name1
44174>>>                        Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID2)) to Rptmp.name1
44178>>>                        Else                                                 Move (fsClient  (Self,sClientID2)) to Rptmp.name1
44180>>>                        If (Trim(Rptmp.name1)='') Begin
44182>>>                                 If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID)) to Rptmp.name1
44185>>>                            Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID)) to Rptmp.name1
44189>>>                            Else                                                 Move (fsClient  (Self,sClientID)) to Rptmp.name1
44191>>>                        End
44191>>>>
44191>>>                        Saverecord Rptmp
44192>>>            
44192>>>                        // Make Synola record 5 for synolikh ofeilh
44192>>>                        Clear Rptmp
44193>>>                        Move sCompany                                  to Rptmp.Company_Code
44194>>>                        Move sBranch                                   to Rptmp.Branch_Code
44195>>>                        Move '99999999'                                to Rptmp.ID1
44196>>>                        Move 5                                         to Rptmp.Seira
44197>>>                        Find Eq Rptmp By Index.1
44198>>>>
44198>>>                        //Move s1 to n1
44198>>>                        Move jj to FieldIndex
44199>>>                        Add (Round_Number(n1,2)) to Rptmp.Mhnas_Trex&
44200>>>                        Move '——5ÿ‘ç¤¦¢˜ ‘¬¤¦¢ ¡ãª Ž­œ ¢ãª'       to Rptmp.name1
44201>>>                        Saverecord Rptmp
44202>>>                        Set Label Of BtnMess to ('ƒ ˜®¨¦¤ ¡¦å “§¦¢/©£¦å „ ©§¨. €¥ ¦š¨á­à¤'+'  '+Trim(sClientID2))
44203>>>                        Readln  Channel 9
44205>>>                    loop
44206>>>>
44206>>>                    Telos_Edo3axn:
44206>>>                    Close_Input Channel 9 'C:\rptmp3ax.txt'
44208>>>            
44208>>>                Loop
44209>>>>
44209>>>            
44209>>>            
44209>>>            ////////////////////////////////////////////////////////////////////////
44209>>>            //////// Hmeres HPAL kai HPSO + analysh anoixtou 30/60/90/90+///////////
44209>>>                Set Label Of BtnMess to '†£â¨œª †€Š ¡˜  †‘Ž'
44210>>>                Set piSelection Of ReportMakeMeresRecords to 0
44211>>>                Send Run_Report to ReportMakeMeresRecords
44212>>>                Send Delete_Data to oPinakas
44213>>>                Number nHpal nHpso
44213>>>                Direct_Input Channel 9 'C:\RptmHp.txt'
44215>>>            
44215>>>                While (Not(Seqeof))
44219>>>                    Read    Channel 9 sClientID sName nHpal nHpso
44224>>>                    If (Trim(sClientID)='') Goto Telos_Edo2P
44227>>>            
44227>>>                    // 17/02/2004
44227>>>                    // Ellhnikoi Xarakthres mesa sto ID
44227>>>                    If (Sysfile.version_Number='1') Move (ToOEM (sClientID)) to sClientID2
44230>>>                    Else Move sClientID to sClientID2
44232>>>            
44232>>>                    Send Delete_Data to oPinakas
44233>>>            
44233>>>                    // Gemizei to array apo
44233>>>                    //  0-12 Meres HPAL
44233>>>                    // 13-25 Meres HPSO
44233>>>                    For iDeikths From 0 to 12
44239>>>>
44239>>>                        Read    Channel 9 s1
44241>>>                        Set Array_Value Of (oPinakas(Self)) Item iDeikths to s1
44242>>>                    Loop
44243>>>>
44243>>>                    For iDeikths From 13 to 25
44249>>>>
44249>>>                        Read    Channel 9 s1
44251>>>                        Set Array_Value Of (oPinakas(Self)) Item iDeikths to s1
44252>>>                    Loop
44253>>>>
44253>>>            
44253>>>                    // Make record 8 for Hpso (Array 13-25)
44253>>>                    Clear Rptmp
44254>>>                    Move sCompany   to Rptmp.Company_Code
44255>>>                    Move sBranch    to Rptmp.Branch_Code
44256>>>                    Move sClientID2 to Rptmp.ID1
44257>>>                    Move 8          to Rptmp.Seira
44258>>>                    Find Eq Rptmp By Index.1
44259>>>>
44259>>>            
44259>>>                    For iDeikths From 13 to 25
44265>>>>
44265>>>                        Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
44266>>>                        Move (iDeikths-13)  to FieldIndex
44267>>>                        Move (Round_Number(n1,0)) to Rptmp.Mhnas_Trex&
44268>>>                    Loop
44269>>>>
44269>>>            
44269>>>                         If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID2)) to Rptmp.name1
44272>>>                    Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID2)) to Rptmp.name1
44276>>>                    Else                                                 Move (fsClient  (Self,sClientID2)) to Rptmp.name1
44278>>>                    If (Trim(Rptmp.name1)='') Begin
44280>>>                             If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID)) to Rptmp.name1
44283>>>                        Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID)) to Rptmp.name1
44287>>>                        Else                                                 Move (fsClient  (Self,sClientID)) to Rptmp.name1
44289>>>                    End
44289>>>>
44289>>>            
44289>>>                    If ((piPoios(Self)=2) And (psPrespID(Self)='')) Begin
44291>>>                        Get fiStoxosHpso sClientID2 1 to Rptmp.Stoxos_Hpso
44292>>>                        Get fiStoxosHpal sClientID2 1 to Rptmp.Stoxos_Hpal
44293>>>                    End
44293>>>>
44293>>>                    Else If ((piPoios(Self)=1) And (psSlsID(Self)='')) Begin
44296>>>                        Get fiStoxosHpso sClientID2 2 to Rptmp.Stoxos_Hpso
44297>>>                        Get fiStoxosHpal sClientID2 2 to Rptmp.Stoxos_Hpal
44298>>>                    End
44298>>>>
44298>>>                    Else Begin
44299>>>                        Get fiStoxosHpso sClientID2 0 to Rptmp.Stoxos_Hpso
44300>>>                        Get fiStoxosHpal sClientID2 0 to Rptmp.Stoxos_Hpal
44301>>>                    End
44301>>>>
44301>>>            
44301>>>                    Move nHpal to Rptmp.Hpal
44302>>>                    Move nHpso to Rptmp.Hpso
44303>>>            
44303>>>                    Saverecord Rptmp
44304>>>                    Set Label Of BtnMess to ('“§¦¢¦š ©£¦å †€Š / †‘Ž'+'  '+String(rptmp.recnum))
44305>>>            //
44305>>>                    // Make record 7 for Hpal (Array 0-12)
44305>>>                    Clear Rptmp
44306>>>                    Move sCompany  to Rptmp.Company_Code
44307>>>                    Move sBranch   to Rptmp.Branch_Code
44308>>>                    Move sClientID2 to Rptmp.ID1
44309>>>                    Move 7         to Rptmp.Seira
44310>>>                    Find Eq Rptmp By Index.1
44311>>>>
44311>>>            
44311>>>                    For iDeikths From 0 to 12
44317>>>>
44317>>>                        Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
44318>>>                        Move iDeikths  to FieldIndex
44319>>>                        Move (Round_Number(n1,0)) to Rptmp.Mhnas_Trex&
44320>>>                    Loop
44321>>>>
44321>>>            
44321>>>                         If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID2)) to Rptmp.name1
44324>>>                    Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID2)) to Rptmp.name1
44328>>>                    Else                                                 Move (fsClient  (Self,sClientID2)) to Rptmp.name1
44330>>>                    If (Trim(Rptmp.name1)='') Begin
44332>>>                             If ((piPoios(Self)=2) And (psPrespID(Self)='')) Move (fsPayResp (Self,sClientID)) to Rptmp.name1
44335>>>                        Else If ((piPoios(Self)=1) And (psSlsID  (Self)='')) Move (fsSalesmen(Self,sClientID)) to Rptmp.name1
44339>>>                        Else                                                 Move (fsClient  (Self,sClientID)) to Rptmp.name1
44341>>>                    End
44341>>>>
44341>>>            
44341>>>                    If ((piPoios(Self)=2) And (psPrespID(Self)='')) Begin
44343>>>                        Get fiStoxosHpso sClientID2 1 to Rptmp.Stoxos_Hpso
44344>>>                        Get fiStoxosHpal sClientID2 1 to Rptmp.Stoxos_Hpal
44345>>>                    End
44345>>>>
44345>>>                    Else If ((piPoios(Self)=1) And (psSlsID(Self)='')) Begin
44348>>>                        Get fiStoxosHpso sClientID2 2 to Rptmp.Stoxos_Hpso
44349>>>                        Get fiStoxosHpal sClientID2 2 to Rptmp.Stoxos_Hpal
44350>>>                    End
44350>>>>
44350>>>                    Else Begin
44351>>>                        Get fiStoxosHpso sClientID2 0 to Rptmp.Stoxos_Hpso
44352>>>                        Get fiStoxosHpal sClientID2 0 to Rptmp.Stoxos_Hpal
44353>>>                    End
44353>>>>
44353>>>            
44353>>>                    Saverecord Rptmp
44354>>>            
44354>>>                    Readln  Channel 9
44356>>>                Loop
44357>>>>
44357>>>                Telos_Edo2P:
44357>>>            
44357>>>                Close_Input Channel 9 'C:\rptmHP.txt'
44359>>>            
44359>>>            
44359>>>            ///////////// 2h klhsh gia ta synola hpal kai hpso /////////////////////
44359>>>            ////////////////////////////////////////////////////////////////////////
44359>>>            //////// Hmeres HPAL kai HPSO + analysh anoixtou 30/60/90/90+///////////
44359>>>                Set Label Of BtnMess to '†£â¨œª †€Š ¡˜  †‘Ž'
44360>>>                Set piSelection Of ReportMakeMeresRecords to 1
44361>>>                Send Run_Report to ReportMakeMeresRecords
44362>>>                Send Delete_Data to oPinakas
44363>>>                Direct_Input Channel 9 'C:\RptmHp.txt'
44365>>>            
44365>>>                While (Not(Seqeof))
44369>>>                    Read    Channel 9 sClientID sName nHpal nHpso
44374>>>                    If (Trim(sClientID)='') Goto Telos_Edo2PP
44377>>>            
44377>>>                    // 17/02/2004
44377>>>                    // Ellhnikoi Xarakthres mesa sto ID
44377>>>                    If (Sysfile.version_Number='1') Move (ToOEM (sClientID)) to sClientID2
44380>>>                    Else Move sClientID to sClientID2
44382>>>            
44382>>>                    Send Delete_Data to oPinakas
44383>>>            
44383>>>                    // Gemizei to array apo
44383>>>                    //  0-12 Meres HPAL
44383>>>                    // 13-25 Meres HPSO
44383>>>                    For iDeikths From 0 to 12
44389>>>>
44389>>>                        Read    Channel 9 s1
44391>>>                        Set Array_Value Of (oPinakas(Self)) Item iDeikths to s1
44392>>>                    Loop
44393>>>>
44393>>>                    For iDeikths From 13 to 25
44399>>>>
44399>>>                        Read    Channel 9 s1
44401>>>                        Set Array_Value Of (oPinakas(Self)) Item iDeikths to s1
44402>>>                    Loop
44403>>>>
44403>>>                    Clear Rptmp
44404>>>                    Move sCompany   to Rptmp.Company_Code
44405>>>                    Move sBranch    to Rptmp.Branch_Code
44406>>>                    Move '99999999' to Rptmp.ID1
44407>>>                    Move 8          to Rptmp.Seira
44408>>>                    Find Eq Rptmp By Index.1
44409>>>>
44409>>>            
44409>>>                    For iDeikths From 13 to 25
44415>>>>
44415>>>                        Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
44416>>>                        Move (iDeikths-13)  to FieldIndex
44417>>>                        Move (Round_Number(n1,0)) to Rptmp.Mhnas_Trex&
44418>>>                    Loop
44419>>>>
44419>>>            
44419>>>                    Move nHpal to Rptmp.Hpal
44420>>>                    Move nHpso to Rptmp.Hpso
44421>>>            
44421>>>                    Move '——8ÿ‘ç¤¦¢˜ †‘Ž' to Rptmp.name1
44422>>>                    Saverecord Rptmp
44423>>>            
44423>>>                    Set Label Of BtnMess to ('“§¦¢¦š ©£¦å †€Š / †‘Ž'+'  '+String(rptmp.recnum))
44424>>>                    Clear Rptmp
44425>>>                    Move sCompany  to Rptmp.Company_Code
44426>>>                    Move sBranch   to Rptmp.Branch_Code
44427>>>                    Move '99999999' to Rptmp.ID1
44428>>>                    Move 7         to Rptmp.Seira
44429>>>                    Find Eq Rptmp By Index.1
44430>>>>
44430>>>            
44430>>>                    For iDeikths From 0 to 12
44436>>>>
44436>>>                        Get Array_Value Of (oPinakas(Self)) Item iDeikths to n1
44437>>>                        Move iDeikths  to FieldIndex
44438>>>                        Move (Round_Number(n1,0)) to Rptmp.Mhnas_Trex&
44439>>>                    Loop
44440>>>>
44440>>>            
44440>>>                    Move nHpal to Rptmp.Hpal
44441>>>                    Move nHpso to Rptmp.Hpso
44442>>>                    Move '——7ÿ‘ç¤¦¢˜ †€Š' to Rptmp.name1
44443>>>                    Saverecord Rptmp
44444>>>            
44444>>>                    Set piHpal Of (ReportEmporias(Self)) to nHpal
44445>>>                    Set piHpso Of (ReportEmporias(Self)) to nHpso
44446>>>            
44446>>>                    Readln  Channel 9
44448>>>                Loop
44449>>>>
44449>>>                Telos_Edo2PP:
44449>>>            
44449>>>                Close_Input Channel 9 'C:\rptmHP.txt'
44451>>>            
44451>>>            
44451>>>            /////////////////////////////////////////////////////////////////
44451>>>            /////// Telos olon ton report pou xrhsimopoihthikan /////////////
44451>>>            /////// gia na vgaloume ta epimerous apotelesmata   /////////////
44451>>>            /////////////////////////////////////////////////////////////////
44451>>>            
44451>>>                Send RunemporReport  to (ReportEmporias(current_object))
44452>>>                Set Label Of BtnMess to ''
44453>>>            
44453>>>                Set Epil           to 0
44454>>>                Set piWhat         to 0
44455>>>                Set piWhere        to 0
44456>>>                Set psBranch       to ''
44457>>>                Set psRep          to ''
44458>>>                Set psClientID     to ''
44459>>>                Set psPrespID      to ''
44460>>>                Set psSlsID        to ''
44461>>>                Set psClientName   to ''
44462>>>                Set psPrespName    to ''
44463>>>                Set psSlsName      to ''
44464>>>                Set piepidika      to 0
44465>>>            
44465>>>                Set Value Of (frmYpeyth (GroupSub3(Self))) Item 0 to ''
44466>>>                Set Value Of (frmPolhths(GroupSub3(Self))) Item 0 to ''
44467>>>                Set Value Of (F_Code_Apo(GroupSub1(Self))) Item 0 to ''
44468>>>            
44468>>>            End_Procedure // OnClick
44469>>>            
44469>>>            
44469>>>            
44469>>>            //AB-StoreEnd
44469>>>
44469>>>        End_Object    // ButtonSub1
44470>>>
44470>>>        Object FCP_ProgressBar1 is a FCP_ProgressBar
44472>>>            Set Size to 13 249
44473>>>            Set Location to 202 158
44474>>>
44474>>>            //AB-StoreStart
44474>>>                                                                                                                                                                                                                
44474>>>            Set piBarColor1 to clAqua
44475>>>            Set pbPercent   to False
44476>>>            Set pbSmooth    to true
44477>>>            Set pbVertical  to False
44478>>>            
44478>>>            
44478>>>            
44478>>>            //AB-StoreEnd
44478>>>
44478>>>        End_Object    // FCP_ProgressBar1
44479>>>
44479>>>        Object RadioGroupSub2 is a RadioGroupSub
44481>>>            Set Size to 109 151
44482>>>            Set Location to 106 3
44483>>>            Set Color to 10859729
44484>>>            Object Radio1 is a RadioSub
44486>>>                Set Label to "‘«¦ ®œå˜ „£§¦¨å˜ª"
44487>>>                Set Size to 10 79
44488>>>                Set Location to 10 5
44489>>>                Set Color to 10859729
44490>>>            End_Object    // Radio1
44491>>>
44491>>>            Object Radio2 is a RadioSub
44493>>>                Set Label to "ƒ ˜®¨¦¤ ¡æ †€Š/†‘Ž"
44494>>>                Set Size to 10 103
44495>>>                Set Location to 25 5
44496>>>                Set Color to 10859729
44497>>>            End_Object    // Radio2
44498>>>
44498>>>            Object Radio3 is a RadioSub
44500>>>                Set Label to "€¤á¢¬©ž €¤. Š¦š˜¨/£¦ç. && ‘¬¤. Ž­œ ¢."
44501>>>                Set Size to 10 143
44502>>>                Set Location to 40 5
44503>>>                Set Color to 10859729
44504>>>            End_Object    // Radio3
44505>>>
44505>>>            Object ButtonSub1 is a ButtonSub
44507>>>                Set Label to "ButtonSub1"
44508>>>                Set Bitmap to "print_m.bmp"
44509>>>                Set Size to 22 22
44510>>>                Set Location to 84 124
44511>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
44512>>>
44512>>>                //AB-StoreStart
44512>>>                                                                                                                                                                                                                                                                                                
44512>>>                Set TooltipValue to "’œ¢œ¬«˜å˜ ˜§¦«œ¢â©£˜«˜ ®à¨åª ¤â˜ œ§œ¥œ¨š˜©å˜"
44513>>>                
44513>>>                Procedure OnClick
44515>>>                    Send RunemporReport  to (ReportEmporias(current_object))
44516>>>                End_Procedure // OnClick
44517>>>                
44517>>>                
44517>>>                
44517>>>                //AB-StoreEnd
44517>>>
44517>>>            End_Object    // ButtonSub1
44518>>>
44518>>>
44518>>>            //AB-StoreStart
44518>>>                                                                                                                                                                                                                
44518>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
44520>>>                Set piWhat to (iToItem+1)
44521>>>            End_Procedure
44522>>>            
44522>>>            // If you set Current_radio you must set this after the
44522>>>            // radio objects have been created AND after Notify_select_State has been
44522>>>            // created. i.e. Set in bottom-code at end!!
44522>>>            //Set Current_Radio to 0
44522>>>            
44522>>>            
44522>>>            
44522>>>            //AB-StoreEnd
44522>>>
44522>>>        End_Object    // RadioGroupSub2
44523>>>
44523>>>        Object btnMess is a ButtonSub
44525>>>            Set Size to 13 249
44526>>>            Set Location to 188 158
44527>>>            Set Border_Style to Border_Normal
44528>>>            Set Focus_Mode to NonFocusable
44529>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
44530>>>
44530>>>            //AB-StoreStart
44530>>>            Procedure OnClick
44532>>>            
44532>>>            End_Procedure // OnClick
44533>>>            //AB-StoreEnd
44533>>>
44533>>>        End_Object    // btnMess
44534>>>
44534>>>
44534>>>        //AB-StoreStart
44534>>>        
44534>>>        Procedure Activate_View Returns Integer
44536>>>            Integer rVal iYear iMonth iYearProthApografh
44537>>>            Date    dHmnia
44537>>>            String  sModule
44537>>>            Sysdate dHmnia
44538>>>            Forward Get Msg_Activate_View   to rVal
44540>>>            Get psMenuModule  Of Main_Menu  to sModule
44541>>>            Set psModule                    to sModule
44542>>>            Move (TheMonthSegment(dHmnia))  to iMonth
44543>>>            Move (TheYearSegment (dHmnia))  to iYear
44544>>>            Set Value Of (frmYear (GroupSub3(Self)))   Item 0   to iYear
44545>>>            Set Value Of (frmMonth(GroupSub3(Self)))   Item 0   to iMonth
44546>>>            Move (TheYearSegment(Sysfile.Last_Hmnia_Ekt))       to iYearProthApografh
44547>>>            Set piYear                                          to iYearProthApografh
44548>>>            Procedure_Return rVal
44549>>>        End_Procedure
44550>>>        
44550>>>        Object ReportEmporias is a CrystalReportSubSQL
44552>>>        
44552>>>            Property    Integer piTiTrexei  Public 0
44554>>>            Property    Integer piHpal      Public 0
44556>>>            Property    Integer piHpso      Public 0
44558>>>        
44558>>>            Set Report_View_id      to (Parent(Self))
44559>>>            Set Output_Destination  to WQL_PRINT_TO_WINDOW
44560>>>        
44560>>>            Procedure OnStartPrinting
44562>>>                Date    dHmniaEos
44563>>>                String  Selection sHmgio sbranch
44563>>>                String  sClientName sPrespName sSlsName
44563>>>                String  sClientID sPrespID sSlsID sReport
44563>>>                Integer iMhden iYearTo iMonthTo
44563>>>                Get Report_Name         to sReport
44564>>>        
44564>>>                If (Trim(sReport)="Hpalpeln.rpt") Begin
44566>>>                    Set Formula 'sHpal' to (Winql_Number(piHpal(Self)))
44567>>>                    Set Formula 'sHpso' to (Winql_Number(piHpso(Self)))
44568>>>                End
44568>>>>
44568>>>        
44568>>>                Get fiYear  Of GroupSub3  to iYearTo
44569>>>                Get fiMonth Of GroupSub3  to iMonthTo
44570>>>                Move (DateCompose(TheDaySegment(EndOfMonth  (iMonthTo  ,iYearTo  )),iMonthTo  ,iYearTo  )) to dHmniaEos
44571>>>        
44571>>>                Get psClientID          to sClientID
44572>>>                Get psClientName        to sClientName
44573>>>                Get psSlsID             to sSlsID
44574>>>                Get psSlsName           to sSlsName
44575>>>                Get psPrespID           to sPrespID
44576>>>                Get psPrespName         to sPrespName
44577>>>        
44577>>>                Get Checked_State Of (chkMhden(GroupSub3(StoixEmp2(Self)))) Item 0 to iMhden
44578>>>        
44578>>>                If (sSlsID<>'') Begin
44580>>>                    Set Formula 'fPolhths'      to (Winql_String(Trim(sSlsID)))
44581>>>                    Move (Replaces('"',sSlsName,'')) to sSlsName
44582>>>                    Move (Replaces("'",sSlsName,'')) to sSlsName
44583>>>                    Set Formula 'fPolhthsDescr' to (Winql_String(Trim(sSlsName)))
44584>>>                End
44584>>>>
44584>>>                If (sPrespID<>'') Begin
44586>>>                    Set Formula 'fYpeyth'      to (Winql_String(Trim(sPrespID)))
44587>>>                    Move (Replaces('"',sPrespName,'')) to sPrespName
44588>>>                    Move (Replaces("'",sPrespName,'')) to sPrespName
44589>>>                    Set Formula 'fYpeythDescr' to (Winql_String(Trim(sPrespName)))
44590>>>                End
44590>>>>
44590>>>                Get psbranch to sbranch
44591>>>        
44591>>>                Set Formula 'HmniaEos' to (WinQl_Date(dHmniaEos))
44592>>>                Set Formula 'Mhdenikous'  to (Winql_Integer(iMhden))
44593>>>        
44593>>>            End_procedure // OnStartPrinting
44594>>>        
44594>>>            Procedure RunemporReport
44596>>>                Send Cursor_Wait To (Cursor_Control(Current_Object))
44597>>>                     if (piwhat(self)=1) Set Report_Name         to "Rptmp1n.rpt"
44600>>>                else if (piwhat(self)=2) Set Report_Name         to "Rptmp2.rpt"
44604>>>                else if (piwhat(self)=3) Set Report_Name         to "Hpalpeln.rpt"
44608>>>                Set piTiTrexei to (piWhat(Self))
44609>>>                Send Run_report
44610>>>                Send Cursor_Ready To (Cursor_Control(Current_Object))
44611>>>            End_procedure // Runempor
44612>>>        End_Object
44613>>>        
44613>>>        
44613>>>        
44613>>>        
44613>>>        
44613>>>        Object ReportMakeMeresRecords is a CrystalReportSubSQL
44615>>>            Property Integer piSelection Public 0
44617>>>            Set Report_Name     to "RptmHP.rpt"
44618>>>            Set Report_View_id  to (Parent(Self))
44619>>>        //    Set Output_Destination          to WQL_PRINT_TO_WINDOW
44619>>>                Set Output_Destination          to WQL_PRINT_TO_FILE
44620>>>                Set ExportFileName              to "c:\RptmHP.txt"
44621>>>                Set UseReportNumberFormat_State to True
44622>>>                Set ExportFormatType            to WQL_CommaSeparatedType
44623>>>                Set FieldDelimiter              to ","
44624>>>                Set StringDelimiter             to '"'
44625>>>                Set UseReportDateFormat_State   To True
44626>>>        
44626>>>            Procedure OnStartPrinting
44628>>>                Integer iSelection
44629>>>                Get piSelection             to iSelection
44630>>>                Set Formula 'piSelection'   to (Winql_Integer(iSelection))
44631>>>            End_procedure // OnStartPrinting
44632>>>        
44632>>>        End_Object
44633>>>        
44633>>>        Object ReportMakeAnoixtosRecords is a CrystalReportSubSQL
44635>>>            Set Report_Name     to "Rptmp8.rpt"
44636>>>            Set Report_View_id  to (Parent(Self))
44637>>>        //        Set Output_Destination          to WQL_PRINT_TO_WINDOW
44637>>>            Set Output_Destination          to WQL_PRINT_TO_FILE
44638>>>            Set ExportFileName              to "c:\Anoixtos.txt"
44639>>>            Set UseReportNumberFormat_State to True
44640>>>            Set ExportFormatType            to WQL_CommaSeparatedType
44641>>>            Set FieldDelimiter              to ","
44642>>>            Set StringDelimiter             to '"'
44643>>>            Set UseReportDateFormat_State   To True
44644>>>        
44644>>>            Procedure OnStartPrinting
44646>>>        
44646>>>                local string  lscatypes Startnumbern Startnamen Endnamen
44647>>>                Local Date    Starthmen Endhmen dyear
44647>>>                Local integer iyear
44647>>>                Local string  sstr  Selection FileName slabel shmgio sPolhths sYpeyth
44647>>>                local integer FileType Destination SortOrder starttypkinn iMhden iYearTo iMonthTo iWhat
44647>>>                Local Integer NumSortFields CurSortField SortDirection wdate fepil iMhnas iEtos iPoios
44647>>>                date apo eos ddate dHmniaEos
44647>>>                string flysh1 flysh2 sbranch sPolhthsDescr sYpeythDescr sKinEpid
44647>>>        
44647>>>                Get fiYear  Of GroupSub3  to iYearTo
44648>>>                Get fiMonth Of GroupSub3  to iMonthTo
44649>>>                Move (DateCompose(TheDaySegment(EndOfMonth  (iMonthTo  ,iYearTo  )),iMonthTo  ,iYearTo  )) to dHmniaEos
44650>>>                Get fsPolhths           to sPolhths
44651>>>                Get fsYpeyth            to sYpeyth
44652>>>                Move (Trim(sYpeyth))    to sYpeyth
44653>>>                Move (Trim(sPolhths))   to sPolhths
44654>>>        
44654>>>                Get Value Of (frmPolhthsDescr(GroupSub3(StoixEmp2(Self)))) Item 0 to sPolhthsDescr
44655>>>                Get Value Of (frmYpeythDescr (GroupSub3(StoixEmp2(Self)))) Item 0 to sYpeythDescr
44656>>>                Get Checked_State Of (chkMhden(GroupSub3(StoixEmp2(Self)))) Item 0 to iMhden
44657>>>        
44657>>>                get psbranch to sbranch
44658>>>        
44658>>>                Move "" To Selection
44659>>>                Append Selection (If(Selection <> "", " and ", ""))"{cmoves.company_code} = " '"' (Trim(syscurxr.company_code)) '"'
44664>>>                if (sbranch<>'') Append Selection (If(Selection <> "", " and ", ""))"{cmoves.branch_code} = " '"' (Trim(sbranch)) '"'
44671>>>        
44671>>>                Append Selection (If(Selection <> "", " and ", "")) "{cmoves.cmoves_axia} <> " '' (0) ''
44676>>>        
44676>>>                Get StartNumber To StartNumbern
44677>>>        
44677>>>                If (Trim(StartNumbern)) ne "" ;                  Append Selection (If(Selection <> "", " and ", "")) "{cmoves.client_id} = " '"' (Trim(startnumbern)) '"'
44684>>>        
44684>>>                Append Selection (If(Selection <> "", " and ", "")) "{cmoves.cmoves_hmnia} <= " (winql_date(dHmniaEos))
44687>>>        
44687>>>        
44687>>>        
44687>>>        
44687>>>        
44687>>>                // Gia to etos 2003 theloume kai tis kinhseis apografhs eno gia
44687>>>                // ta ypoloipa eth DEN ta theloume
44687>>>                Get piPoios Of StoixEmp2  to iPoios
44688>>>                     If (iPoios=0) Append Selection (If(Selection <> "", " and ", "")) "{cmoves.client_id} <> ''"
44692>>>                Else If (iPoios=1) Append Selection (If(Selection <> "", " and ", "")) "{cmoves.sls_id} <> ''"
44697>>>                Else If (iPoios=2) Append Selection (If(Selection <> "", " and ", "")) "{cmoves.presp_id} <> ''"
44702>>>        
44702>>>                if (sPolhths<>'') Append Selection (If(Selection <> "", " and ", ""))"{cmoves.SLS_ID} = "   (Winql_String(sPolhths))  //'"' (Trim(sPolhths)) '"'
44707>>>                if (sYpeyth <>'') Append Selection (If(Selection <> "", " and ", ""))"{cmoves.PRESP_ID} = " (Winql_String(sYpeyth))  //'"' (Trim(sYpeyth)) '"'
44712>>>        
44712>>>                get  psModule to flysh1
44713>>>                move "04" to flysh2
44714>>>                Move '' to sStr
44715>>>                Move (Append(sStr,(flysh1+flysh2))) to sStr
44716>>>                Move (Trim(sStr)) to sStr
44717>>>                Append Selection (If(Selection <> "", " and ", "")) "InStr('" sStr "',{cmoves.module_from})<>0"
44721>>>                Append Selection (If(Selection <> "", " and ", "")) ;                      "If (Year({CMOVES.CMOVES_HMNIA}) <> " (piYear(Self)) ") Then If ({CMOVES.CTYPKIN_CODE}<> '101' And {CMOVES.CTYPKIN_CODE}<> '102' And {CMOVES.CTYPKIN_CODE}<> '201' And {CMOVES.CTYPKIN_CODE}<> '202') Then True Else False Else True"
44725>>>        
44725>>>        //        Append Selection (If(Selection <> "", " and ", "")) "if (Year({CMOVES.CMOVES_HMNIA})<> ''(2003)'') then true "
44725>>>        
44725>>>                // SOS SOS SOS 07/03/2005
44725>>>                // Kovoume tis kinhseis epidikon apo ta axiografa
44725>>>                //Move '185,186,187,188' to sKinEpid
44725>>>        
44725>>>                //Append Selection (If(Selection <> "", " and ", "")) "InStr('" sKinEpid "',{cmoves.Ctypkin_Code})=0"
44725>>>        
44725>>>                get  epil to fepil
44726>>>                //Set Formula 'fForeas'   to (Winql_String(iPoios+1))
44726>>>                Set Formula 'MhnasEos'  to (Winql_Number(iMonthTo))
44727>>>                Set Formula 'EtosEos'   to (Winql_Number(iYearTo))
44728>>>                Set Formula 'HmniaEos'  to (winql_date(dHmniaEos))
44729>>>        
44729>>>                     If ((iPoios=2) And (sYpeyth =''))  Set Formula 'fforeas'  to (Winql_Number(1))
44732>>>                Else If ((iPoios=1) And (sPolhths=''))  Set Formula 'fforeas'  to (Winql_Number(2))
44736>>>                Else                                    Set Formula 'fforeas'  to (Winql_Number(0))
44738>>>        
44738>>>                Set SelectionFormula To Selection
44739>>>            End_procedure // OnStartPrinting
44740>>>        
44740>>>        End_Object
44741>>>        
44741>>>        
44741>>>        Object ReportMakeHpalRecords is a CrystalReportSubSQL
44743>>>            Set Report_Name     to "Hpal0_For_New.rpt"
44744>>>            Set Report_View_id  to (Parent(Self))
44745>>>        //        Set Output_Destination          to WQL_PRINT_TO_WINDOW
44745>>>            Set Output_Destination          to WQL_PRINT_TO_FILE
44746>>>            Set ExportFileName              to "c:\hpal.txt"
44747>>>            Set UseReportNumberFormat_State to True
44748>>>            Set ExportFormatType            to WQL_CommaSeparatedType
44749>>>            Set FieldDelimiter              to ","
44750>>>            Set StringDelimiter             to '"'
44751>>>            Set UseReportDateFormat_State   To True
44752>>>        
44752>>>            Procedure OnStartPrinting
44754>>>        
44754>>>                local string  lscatypes Startnumbern Startnamen Endnamen
44755>>>                Local Date    Starthmen Endhmen
44755>>>                Local string  sstr  Selection FileName slabel shmgio sPolhths sYpeyth
44755>>>                local integer FileType Destination SortOrder starttypkinn iMhden iYearTo iMonthTo iWhat
44755>>>                Local Integer NumSortFields CurSortField SortDirection wdate fepil iMhnas iEtos iPoios
44755>>>                local integer iyear
44755>>>                date apo eos ddate dHmniaEos
44755>>>                string flysh1 flysh2 sbranch sPolhthsDescr sYpeythDescr
44755>>>        
44755>>>                Get fiYear  Of GroupSub3  to iYearTo
44756>>>                Get fiMonth Of GroupSub3  to iMonthTo
44757>>>                Move (DateCompose(TheDaySegment(EndOfMonth  (iMonthTo  ,iYearTo  )),iMonthTo  ,iYearTo  )) to dHmniaEos
44758>>>        
44758>>>                Get fsPolhths           to sPolhths
44759>>>                Get fsYpeyth            to sYpeyth
44760>>>                Move (Trim(sYpeyth))    to sYpeyth
44761>>>                Move (Trim(sPolhths))   to sPolhths
44762>>>        
44762>>>                Get Value Of (frmPolhthsDescr(GroupSub3(StoixEmp2(Self)))) Item 0 to sPolhthsDescr
44763>>>                Get Value Of (frmYpeythDescr (GroupSub3(StoixEmp2(Self)))) Item 0 to sYpeythDescr
44764>>>                Get Checked_State Of (chkMhden(GroupSub3(StoixEmp2(Self)))) Item 0 to iMhden
44765>>>        
44765>>>                get psbranch to sbranch
44766>>>        
44766>>>                Move "" To Selection
44767>>>                Append Selection (If(Selection <> "", " and ", ""))"{cmoves.company_code} = " '"' (Trim(syscurxr.company_code)) '"'
44772>>>                if (sbranch<>'') Append Selection (If(Selection <> "", " and ", ""))"{cmoves.branch_code} = " '"' (Trim(sbranch)) '"'
44779>>>        
44779>>>                Append Selection (If(Selection <> "", " and ", "")) "{cmoves.cmoves_axia} <> " '' (0) ''
44784>>>        
44784>>>                Get StartNumber To StartNumbern
44785>>>        
44785>>>                If (Trim(StartNumbern)) ne "" ;                  Append Selection (If(Selection <> "", " and ", "")) "{cmoves.client_id} = " '"' (Trim(startnumbern)) '"'
44792>>>        
44792>>>                Append Selection (If(Selection <> "", " and ", "")) "{cmoves.cmoves_hmnia} <= " (winql_date(dHmniaEos))
44795>>>        
44795>>>                // Gia to etos 2003 theloume kai tis kinhseis apografhs eno gia
44795>>>                // ta ypoloipa eth DEN ta theloume
44795>>>        
44795>>>                Get piPoios Of StoixEmp2  to iPoios
44796>>>                     If (iPoios=0) Append Selection (If(Selection <> "", " and ", "")) "{cmoves.client_id} <> ''"
44800>>>                Else If (iPoios=1) Append Selection (If(Selection <> "", " and ", "")) "{cmoves.sls_id} <> ''"
44805>>>                Else If (iPoios=2) Append Selection (If(Selection <> "", " and ", "")) "{cmoves.presp_id} <> ''"
44810>>>        
44810>>>                if (sPolhths<>'') Append Selection (If(Selection <> "", " and ", ""))"{cmoves.SLS_ID} = "   (Winql_String(sPolhths))  //'"' (Trim(sPolhths)) '"'
44815>>>                if (sYpeyth <>'') Append Selection (If(Selection <> "", " and ", ""))"{cmoves.PRESP_ID} = " (Winql_String(sYpeyth))  //'"' (Trim(sYpeyth)) '"'
44820>>>        
44820>>>                get  psModule to flysh1
44821>>>                move "04" to flysh2
44822>>>                Move '' to sStr
44823>>>                Move (Append(sStr,(flysh1+flysh2))) to sStr
44824>>>                Move (Trim(sStr)) to sStr
44825>>>                Append Selection (If(Selection <> "", " and ", "")) "InStr('" sStr "',{cmoves.module_from})<>0"
44829>>>                Append Selection (If(Selection <> "", " and ", "")) ;                      "If (Year({CMOVES.CMOVES_HMNIA})<> " (piYear(Self)) ") Then If ({CMOVES.CTYPKIN_CODE}<> '101' And {CMOVES.CTYPKIN_CODE}<> '102' And {CMOVES.CTYPKIN_CODE}<> '201' And {CMOVES.CTYPKIN_CODE}<> '202') Then True Else False Else True"
44833>>>        
44833>>>                get  epil to fepil
44834>>>                //Set Formula 'fForeas'   to (Winql_String(iPoios+1))
44834>>>                Set Formula 'MhnasEos'  to (Winql_Number(iMonthTo))
44835>>>                Set Formula 'EtosEos'   to (Winql_Number(iYearTo))
44836>>>                Set Formula 'HmniaEos'  to (winql_date(dHmniaEos))
44837>>>        
44837>>>                     If ((iPoios=2) And (sYpeyth =''))  Set Formula 'fforeas'  to (Winql_Number(1))
44840>>>                Else If ((iPoios=1) And (sPolhths=''))  Set Formula 'fforeas'  to (Winql_Number(2))
44844>>>                Else                                    Set Formula 'fforeas'  to (Winql_Number(0))
44846>>>        
44846>>>                Set SelectionFormula To Selection
44847>>>            End_procedure // OnStartPrinting
44848>>>        
44848>>>        End_Object
44849>>>        
44849>>>        
44849>>>        Object ReportMakeTzirosRecords is a CrystalReport
44851>>>            Set Report_Name     to "rptmp3.rpt"
44852>>>            Set Report_View_id  to (Parent(Self))
44853>>>        //    Set Output_Destination          to WQL_PRINT_TO_WINDOW
44853>>>            Set Output_Destination          to WQL_PRINT_TO_FILE
44854>>>            Set ExportFileName              to "c:\rptmp3.txt"
44855>>>            Set UseReportNumberFormat_State to True
44856>>>            Set ExportFormatType            to WQL_CommaSeparatedType
44857>>>            Set FieldDelimiter              to ","
44858>>>            Set StringDelimiter             to '"'
44859>>>            Set UseReportDateFormat_State   To True
44860>>>        
44860>>>            Procedure OnStartPrinting
44862>>>        
44862>>>                local string  lscatypes Startnumbern Startnamen Endnamen
44863>>>                Local Date    Starthmen Endhmen
44863>>>                Local string  sstr  Selection FileName slabel shmgio sPolhths sYpeyth
44863>>>                local integer FileType Destination SortOrder starttypkinn iMhden iYearTo iMonthTo
44863>>>                Local Integer NumSortFields CurSortField SortDirection wdate fepil iMhnas iEtos iPoios
44863>>>                date apo eos ddate dHmniaEos dHmniaApo
44863>>>                string flysh1 flysh2 sbranch sPolhthsDescr sYpeythDescr
44863>>>        
44863>>>                Get fiYear  Of GroupSub3  to iYearTo
44864>>>                Get fiMonth Of GroupSub3  to iMonthTo
44865>>>        
44865>>>                Move (DateCompose(TheDaySegment(EndOfMonth(iMonthTo,(iYearTo))),iMonthTo,(iYearTo)))        to dHmniaEos
44866>>>                Move (DateCompose(TheDaySegment(BeginOfMonth(iMonthTo,(iYearTo-1))),iMonthTo,(iYearTo-1)))  to dHmniaApo
44867>>>        
44867>>>                Get fsPolhths           to sPolhths
44868>>>                Get fsYpeyth            to sYpeyth
44869>>>                Move (Trim(sYpeyth))    to sYpeyth
44870>>>                Move (Trim(sPolhths))   to sPolhths
44871>>>        
44871>>>                Get Value Of (frmPolhthsDescr(GroupSub3(StoixEmp2(Self)))) Item 0 to sPolhthsDescr
44872>>>                Get Value Of (frmYpeythDescr (GroupSub3(StoixEmp2(Self)))) Item 0 to sYpeythDescr
44873>>>                Get Checked_State Of (chkMhden(GroupSub3(StoixEmp2(Self)))) Item 0 to iMhden
44874>>>        
44874>>>                get psbranch to sbranch
44875>>>                Move "" To Selection
44876>>>                Append Selection (If(Selection <> "", " and ", ""))"{wcmoves.company_code} = " '"' (Trim(syscurxr.company_code)) '"'
44881>>>        //        if (sbranch<>'') Append Selection (If(Selection <> "", " and ", ""))"{wcmoves.branch_code} = " '"' (Trim(sbranch)) '"'
44881>>>        
44881>>>                Get piPoios Of StoixEmp2  to iPoios
44882>>>                     If (iPoios=0) Append Selection (If(Selection <> "", " and ", "")) "{wcmoves.client_id} <> ''"
44886>>>                Else If (iPoios=1) Append Selection (If(Selection <> "", " and ", "")) "{wcmoves.sls_id} <> ''"
44891>>>                Else If (iPoios=2) Append Selection (If(Selection <> "", " and ", "")) "{wcmoves.presp_id} <> ''"
44896>>>        
44896>>>                Get StartNumber To StartNumbern
44897>>>        
44897>>>                If (Trim(StartNumbern)) ne "" ;                  Append Selection (If(Selection <> "", " and ", "")) "{wcmoves.client_id} = " '"' (Trim(startnumbern)) '"'
44904>>>        
44904>>>        
44904>>>                Append Selection (If(Selection <> "", " and ", "")) "{wcmoves.wcmove_hmnia} >= " (winql_date(dHmniaApo))
44907>>>                Append Selection (If(Selection <> "", " and ", "")) "{wcmoves.wcmove_hmnia} <= " (winql_date(dHmniaEos))
44910>>>        
44910>>>                if (sPolhths<>'') Append Selection (If(Selection <> "", " and ", ""))"{wcmoves.SLS_ID} = " '"' (Trim(sPolhths)) '"'
44917>>>                if (sYpeyth <>'') Append Selection (If(Selection <> "", " and ", ""))"{wcmoves.PRESP_ID} = " '"' (Trim(sYpeyth)) '"'
44924>>>        
44924>>>                get  psModule to flysh1
44925>>>                Append Selection (If(Selection <> "", " and ", ""))"{wcmoves.Module_From} = " '"' (Trim(flysh1)) '"'
44930>>>        
44930>>>        
44930>>>                Set Formula 'fMhnas'  to (Winql_Number(iMonthTo))
44931>>>                Set Formula 'fEtos'   to (Winql_Number(iYearTo))
44932>>>        
44932>>>                     If ((iPoios=2) And (sYpeyth =''))  Set Formula 'fforeas'  to (Winql_Number(1))
44935>>>                Else If ((iPoios=1) And (sPolhths=''))  Set Formula 'fforeas'  to (Winql_Number(2))
44939>>>                Else                                    Set Formula 'fforeas'  to (Winql_Number(0))
44941>>>                Set SelectionFormula To Selection
44942>>>        
44942>>>            End_procedure // OnStartPrinting
44943>>>        
44943>>>        End_Object
44944>>>        
44944>>>        Object ReportMakeAxioRecords is a CrystalReport
44946>>>            Set Report_View_id  to (Parent(Self))
44947>>>        //    Set Output_Destination          to WQL_PRINT_TO_WINDOW
44947>>>            Set Output_Destination          to WQL_PRINT_TO_FILE
44948>>>            Set UseReportNumberFormat_State to True
44949>>>            Set ExportFormatType            to WQL_CommaSeparatedType
44950>>>            Set FieldDelimiter              to ","
44951>>>            Set StringDelimiter             to '"'
44952>>>            Set UseReportDateFormat_State   To True
44953>>>        
44953>>>            Procedure OnStartPrinting
44955>>>        
44955>>>                local string  lscatypes Startnumbern Startnamen Endnamen stext
44956>>>                Local Date    Starthmen Endhmen
44956>>>                Local string  sstr  Selection FileName slabel shmgio sPolhths sYpeyth sone
44956>>>                local integer FileType Destination SortOrder starttypkinn iMhden iYearTo iMonthTo
44956>>>                Local Integer NumSortFields CurSortField SortDirection wdate fepil iMhnas iEtos iPoios
44956>>>                date apo eos ddate dHmniaEos dHmniaApo
44956>>>                string flysh1 flysh2 sbranch sPolhthsDescr sYpeythDescr
44956>>>                local integer iepidika
44956>>>        
44956>>>                get piepidika to iepidika
44957>>>                move  1 to sone
44958>>>                Get piPoios Of StoixEmp2  to iPoios
44959>>>        
44959>>>                Get fiYear  Of GroupSub3  to iYearTo
44960>>>                Get fiMonth Of GroupSub3  to iMonthTo
44961>>>        
44961>>>                Move (DateCompose(TheDaySegment(beginOfMonth(iMonthTo,(iYearTo))),iMonthTo,(iYearTo)))        to ddate
44962>>>                Move (DateCompose(TheDaySegment(endOfMonth(iMonthTo,(iYearTo))),iMonthTo,(iYearTo)))          to dhmniaeos
44963>>>                Move (DateCompose(TheDaySegment(BeginOfMonth(iMonthTo,(iYearTo-1))),iMonthTo,(iYearTo-1)))    to dHmniaApo
44964>>>        
44964>>>                Get fsPolhths           to sPolhths
44965>>>                Get fsYpeyth            to sYpeyth
44966>>>                Move (Trim(sYpeyth))    to sYpeyth
44967>>>                Move (Trim(sPolhths))   to sPolhths
44968>>>        
44968>>>                Get Value Of (frmPolhthsDescr(GroupSub3(StoixEmp2(Self)))) Item 0 to sPolhthsDescr
44969>>>                Get Value Of (frmYpeythDescr (GroupSub3(StoixEmp2(Self)))) Item 0 to sYpeythDescr
44970>>>                Get Checked_State Of (chkMhden(GroupSub3(StoixEmp2(Self)))) Item 0 to iMhden
44971>>>        
44971>>>                Move "" To Selection
44972>>>                Append Selection (If(Selection <> "", " and ", ""))"{baxio.company_code} = " '"' (Trim(syscurxr.company_code)) '"'
44977>>>                if (sbranch<>'') Append Selection (If(Selection <> "", " and ", ""))"{baxio.branch_code} = " '"' (Trim(sbranch)) '"'
44984>>>                Append Selection (If(Selection <> "", " and ", ""))"{btypkin.btypkin_anti_xp} = 2"
44986>>>        
44986>>>        
44986>>>                // 12/02/2004 KOBONTAI OI DESMEYMENES EPITAGES
44986>>>                // kapoies palies epitages tou 01.A5.23111 me lanthasmena flags
44986>>>                // vgazoun anoixto kai synolikh apo thn prosthiki 13469... apo
44986>>>                // diamartyrimenes epitages.
44986>>>                // Aytes tis gyrname se status 5 kai tis kovoume
44986>>>                Append Selection (If(Selection <> "", " and ", ""))"{baxio.BAXIO_STATUS} <> 5 "
44988>>>                //
44988>>>        
44988>>>                if (iepidika=0) begin
44990>>>                    Append Selection (If(Selection <> "", " and ", ""))"{btypkin.btypkin_sign} = 1"
44992>>>                    Append Selection (If(Selection <> "", " and ", ""))"{baxio.BAXIO_PLACE} <> 2 "
44994>>>                    Append Selection (If(Selection <> "", " and ", "")) "{baxio.baxio_hmnial} >= " (winql_date(ddate))
44997>>>                end
44997>>>>
44997>>>                else begin
44998>>>                    Append Selection (If(Selection <> "", " and ", ""))"{baxio.BAXIO_status} = 3 "
45000>>>                    Append Selection (If(Selection <> "", " and ", "")) "{baxio.baxio_hmnial} >= " (winql_date(dhmniaapo))
45003>>>                    Append Selection (If(Selection <> "", " and ", "")) "{baxio.baxio_hmnial} <= " (winql_date(dhmniaeos))
45006>>>                end
45006>>>>
45006>>>        
45006>>>                Append Selection (If(Selection <> "", " and ", "")) "{barticl.barticl_hmnia} <= " (winql_date(dhmniaeos))
45009>>>        
45009>>>                Append Selection (If(Selection <> "", " and ", ""))"{barticl.barticl_ekleise} = " '"' (Trim(sone)) '"'
45014>>>                move '#1#2#10#' to stext
45015>>>                Append Selection (If(Selection <> "", " and ", "")) "InStr('" stext "',('#'+TOTEXT ({baxio.baxiokat_code},0)+'#'))<>0"
45019>>>        
45019>>>        
45019>>>                     If (iPoios=0) Append Selection (If(Selection <> "", " and ", "")) "{baxio.baxio_code_in} <> ''"
45023>>>                Else If (iPoios=1) Append Selection (If(Selection <> "", " and ", "")) "{bmove.sls_id} <> ''"
45028>>>                Else If (iPoios=2) Append Selection (If(Selection <> "", " and ", "")) "{bmove.presp_id} <> ''"
45033>>>        
45033>>>                Get StartNumber To StartNumbern
45034>>>        
45034>>>                If (Trim(StartNumbern)) ne "" ;                    Append Selection (If(Selection <> "", " and ", "")) "{baxio.baxio_code_in} = " '"' (Trim(startnumbern)) '"'
45041>>>        
45041>>>        
45041>>>                if (sPolhths<>'') Append Selection (If(Selection <> "", " and ", ""))"{bmove.SLS_ID} = " '"' (Trim(sPolhths)) '"'
45048>>>                if (sYpeyth <>'') Append Selection (If(Selection <> "", " and ", ""))"{bmove.PRESP_ID} = " '"' (Trim(sYpeyth)) '"'
45055>>>        
45055>>>        
45055>>>                Set Formula 'fMhnas'  to (Winql_Number(iMonthTo))
45056>>>                Set Formula 'fEtos'   to (Winql_Number(iYearTo))
45057>>>        
45057>>>                     If ((iPoios=2) And (sYpeyth =''))  Set Formula 'fforeas'  to (Winql_Number(1))
45060>>>                Else If ((iPoios=1) And (sPolhths=''))  Set Formula 'fforeas'  to (Winql_Number(2))
45064>>>                Else                                    Set Formula 'fforeas'  to (Winql_Number(0))
45066>>>        
45066>>>                Set SelectionFormula To Selection
45067>>>        
45067>>>            End_procedure // OnStartPrinting
45068>>>        
45068>>>        End_Object
45069>>>        
45069>>>        
45069>>>        Object ReportMakeEisprakteaAxiografa is a CrystalReport
45071>>>            Property Integer piTrexonMhnas  Public 0
45073>>>            Property Integer piTrexonEtos   Public 0
45075>>>            Set Report_View_id  to (Parent(Self))
45076>>>        //    Set Output_Destination          to WQL_PRINT_TO_WINDOW
45076>>>            Set Output_Destination          to WQL_PRINT_TO_FILE
45077>>>            Set UseReportNumberFormat_State to True
45078>>>            Set ExportFormatType            to WQL_CommaSeparatedType
45079>>>            Set FieldDelimiter              to ","
45080>>>            Set StringDelimiter             to '"'
45081>>>            Set UseReportDateFormat_State   To True
45082>>>        
45082>>>            Procedure OnStartPrinting
45084>>>        
45084>>>                local string  lscatypes Startnumbern Startnamen Endnamen stext
45085>>>                Local Date    Starthmen Endhmen
45085>>>                Local string  sstr  Selection FileName slabel shmgio sPolhths sYpeyth sone
45085>>>                local integer FileType Destination SortOrder starttypkinn iMhden iYearTo iMonthTo
45085>>>                Local Integer NumSortFields CurSortField SortDirection wdate fepil iMhnas iEtos iPoios
45085>>>                date apo eos ddate dHmniaEos dHmniaApo
45085>>>                string flysh1 flysh2 sbranch sPolhthsDescr sYpeythDescr
45085>>>                local integer iepidika
45085>>>        
45085>>>                move  1 to sone
45086>>>                Get piPoios Of StoixEmp2  to iPoios
45087>>>        
45087>>>                Get piTrexonEtos  to iYearTo
45088>>>                Get piTrexonMhnas to iMonthTo
45089>>>        
45089>>>                Move (DateCompose(TheDaySegment(BeginOfMonth(iMonthTo,(iYearTo  ))),iMonthTo,(iYearTo)))    to ddate
45090>>>                Move (DateCompose(TheDaySegment(EndOfMonth  (iMonthTo,(iYearTo  ))),iMonthTo,(iYearTo)))    to dhmniaeos
45091>>>                Move (DateCompose(TheDaySegment(BeginOfMonth(iMonthTo,(iYearTo-1))),iMonthTo,(iYearTo-1)))  to dHmniaApo
45092>>>        
45092>>>                Get fsPolhths           to sPolhths
45093>>>                Get fsYpeyth            to sYpeyth
45094>>>                Move (Trim(sYpeyth))    to sYpeyth
45095>>>                Move (Trim(sPolhths))   to sPolhths
45096>>>        
45096>>>                Get Value Of (frmPolhthsDescr(GroupSub3(StoixEmp2(Self)))) Item 0 to sPolhthsDescr
45097>>>                Get Value Of (frmYpeythDescr (GroupSub3(StoixEmp2(Self)))) Item 0 to sYpeythDescr
45098>>>                Get Checked_State Of (chkMhden(GroupSub3(StoixEmp2(Self)))) Item 0 to iMhden
45099>>>        
45099>>>                Move "" To Selection
45100>>>                Append Selection (If(Selection <> "", " and ", ""))"{baxio.company_code} = " '"' (Trim(syscurxr.company_code)) '"'
45105>>>                if (sbranch<>'') Append Selection (If(Selection <> "", " and ", ""))"{baxio.branch_code} = " '"' (Trim(sbranch)) '"'
45112>>>                Append Selection (If(Selection <> "", " and ", ""))"{btypkin.btypkin_anti_xp} = 2"
45114>>>        
45114>>>        
45114>>>                // 12/02/2004 KOBONTAI OI DESMEYMENES EPITAGES
45114>>>                // kapoies palies epitages tou 01.A5.23111 me lanthasmena flags
45114>>>                // vgazoun anoixto kai synolikh apo thn prosthiki 13469... apo
45114>>>                // diamartyrimenes epitages.
45114>>>                // Aytes tis gyrname se status 5 kai tis kovoume
45114>>>                ///////////Append Selection (If(Selection <> "", " and ", ""))"{baxio.BAXIO_STATUS} <> 5 "
45114>>>        
45114>>>                // 04/03/2003 Nea proseggish
45114>>>                // Gia na mhn kanoun exoflhseis axiografon prohgoumenhs xrhshs
45114>>>                // giati ayta ta axiografa logo tis metaforas tous exoun ftiaxei
45114>>>                // neo soma kata thn allagh ths xrhshs kai etsi emfanixontai 2 FORES
45114>>>                // ta kovoume me th paradoxh oti an ena axiografo exei
45114>>>                // to year ths hmnias lhxhs > apo to year ths hmnias kataxorhshs
45114>>>                // tote sigoyra tha exei metaferthei opote to kovoume
45114>>>        
45114>>>               // Append Selection (If(Selection <> "", " and ", "")) "(NOT(Year ({BAXIO.BAXIO_HMNIAL})>{BAXIO.YEAR_YEAR}))"
45114>>>                Append Selection (If(Selection <> "", " and ", ""))"{baxio.BAXIO_PLACE} <> 2 "
45116>>>                Append Selection (If(Selection <> "", " and ", ""))"{baxio.baxio_hmnial} > "(winql_date(dhmniaeos))
45119>>>                Append Selection (If(Selection <> "", " and ", ""))"{barticl.barticl_hmnia} <= " (winql_date(dhmniaeos))
45122>>>                Append Selection (If(Selection <> "", " and ", ""))"{barticl.barticl_ekleise} = " '"' (Trim(sone)) '"'
45127>>>                move '#1#2#10#' to stext
45128>>>                Append Selection (If(Selection <> "", " and ", "")) "InStr('" stext "',('#'+TOTEXT ({baxio.baxiokat_code},0)+'#'))<>0"
45132>>>        
45132>>>                     If (iPoios=0) Append Selection (If(Selection <> "", " and ", "")) "{baxio.baxio_code_in} <> ''"
45136>>>                Else If (iPoios=1) Append Selection (If(Selection <> "", " and ", "")) "{bmove.sls_id} <> ''"
45141>>>                Else If (iPoios=2) Append Selection (If(Selection <> "", " and ", "")) "{bmove.presp_id} <> ''"
45146>>>        
45146>>>                Get StartNumber To StartNumbern
45147>>>        
45147>>>                If (Trim(StartNumbern)) ne "" ;                    Append Selection (If(Selection <> "", " and ", "")) "{baxio.baxio_code_in} = " '"' (Trim(startnumbern)) '"'
45154>>>        
45154>>>        
45154>>>                if (sPolhths<>'') Append Selection (If(Selection <> "", " and ", ""))"{bmove.SLS_ID} = " '"' (Trim(sPolhths)) '"'
45161>>>                if (sYpeyth <>'') Append Selection (If(Selection <> "", " and ", ""))"{bmove.PRESP_ID} = " '"' (Trim(sYpeyth)) '"'
45168>>>        
45168>>>        
45168>>>                Set Formula 'fMhnas'  to (Winql_Number(iMonthTo))
45169>>>                Set Formula 'fEtos'   to (Winql_Number(iYearTo))
45170>>>        
45170>>>                     If ((iPoios=2) And (sYpeyth =''))  Set Formula 'fforeas'  to (Winql_Number(1))
45173>>>                Else If ((iPoios=1) And (sPolhths=''))  Set Formula 'fforeas'  to (Winql_Number(2))
45177>>>                Else                                    Set Formula 'fforeas'  to (Winql_Number(0))
45179>>>        
45179>>>                Set SelectionFormula To Selection
45180>>>        
45180>>>            End_procedure // OnStartPrinting
45181>>>        
45181>>>        End_Object
45182>>>        
45182>>>        
45182>>>        //  RPTMP4.TXT
45182>>>        // '¨¦œ«¦ £˜©å˜ €¤¦ ®«¦ç Š¦š/£¦ç && ‘¬¤. Ž­œ ¢ãª'
45182>>>        // Mazeyei oles tis xreoseis & oles tis pistoseis apo Cmoves
45182>>>        Object ReportMakeOfeilhRecords is a CrystalReport
45184>>>            Set Report_Name     to "rptmp4n.rpt"
45185>>>            Set Report_View_id  to (Parent(Self))
45186>>>        //    Set Output_Destination          to WQL_PRINT_TO_WINDOW
45186>>>            Set Output_Destination          to WQL_PRINT_TO_FILE
45187>>>            Set ExportFileName              to "c:\rptmp4.txt"
45188>>>            Set UseReportNumberFormat_State to True
45189>>>            Set ExportFormatType            to WQL_CommaSeparatedType
45190>>>            Set FieldDelimiter              to ","
45191>>>            Set StringDelimiter             to '"'
45192>>>            Set UseReportDateFormat_State   To True
45193>>>        
45193>>>            Procedure OnStartPrinting
45195>>>        
45195>>>                local string  lscatypes Startnumbern Startnamen Endnamen
45196>>>                Local Date    Starthmen Endhmen
45196>>>                Local string  sstr  Selection FileName slabel shmgio sPolhths sYpeyth
45196>>>                local integer FileType Destination SortOrder starttypkinn iMhden iYearTo iMonthTo iWhat
45196>>>                Local Integer NumSortFields CurSortField SortDirection wdate fepil iMhnas iEtos iPoios
45196>>>                local integer iyear
45196>>>                date apo eos ddate dHmniaEos
45196>>>                string flysh1 flysh2 sbranch sPolhthsDescr sYpeythDescr
45196>>>        
45196>>>                Move (TheYearSegment (sysfile.last_hmnia_ekt)) to iyear
45197>>>                set piyear to iyear
45198>>>        
45198>>>                Get fiYear  Of GroupSub3  to iYearTo
45199>>>                Get fiMonth Of GroupSub3  to iMonthTo
45200>>>                Move (DateCompose(TheDaySegment(EndOfMonth  (iMonthTo  ,iYearTo  )),iMonthTo  ,iYearTo  )) to dHmniaEos
45201>>>        
45201>>>                Get fsPolhths           to sPolhths
45202>>>                Get fsYpeyth            to sYpeyth
45203>>>                Move (Trim(sYpeyth))    to sYpeyth
45204>>>                Move (Trim(sPolhths))   to sPolhths
45205>>>        
45205>>>                Get Value Of (frmPolhthsDescr(GroupSub3(StoixEmp2(Self)))) Item 0 to sPolhthsDescr
45206>>>                Get Value Of (frmYpeythDescr (GroupSub3(StoixEmp2(Self)))) Item 0 to sYpeythDescr
45207>>>                Get Checked_State Of (chkMhden(GroupSub3(StoixEmp2(Self)))) Item 0 to iMhden
45208>>>        
45208>>>                get psbranch to sbranch
45209>>>                Move "" To Selection
45210>>>                Append Selection (If(Selection <> "", " and ", ""))"{cmoves.company_code} = " '"' (Trim(syscurxr.company_code)) '"'
45215>>>                if (sbranch<>'') Append Selection (If(Selection <> "", " and ", ""))"{cmoves.branch_code} = " '"' (Trim(sbranch)) '"'
45222>>>        
45222>>>                Append Selection (If(Selection <> "", " and ", "")) "{cmoves.cmoves_axia} <> " '' (0) ''
45227>>>        
45227>>>                Get StartNumber To StartNumbern
45228>>>        
45228>>>                If (Trim(StartNumbern)) ne "" ;                  Append Selection (If(Selection <> "", " and ", "")) "{cmoves.client_id} = " '"' (Trim(startnumbern)) '"'
45235>>>        
45235>>>                Append Selection (If(Selection <> "", " and ", "")) "{cmoves.cmoves_hmnia} <= " (winql_date(dHmniaEos))
45238>>>        
45238>>>        
45238>>>                Get piPoios Of StoixEmp2  to iPoios
45239>>>                     If (iPoios=0) Append Selection (If(Selection <> "", " and ", "")) "{cmoves.client_id} <> ''"
45243>>>                Else If (iPoios=1) Append Selection (If(Selection <> "", " and ", "")) "{cmoves.sls_id} <> ''"
45248>>>                Else If (iPoios=2) Append Selection (If(Selection <> "", " and ", "")) "{cmoves.presp_id} <> ''"
45253>>>        
45253>>>        
45253>>>                if (sPolhths<>'') Append Selection (If(Selection <> "", " and ", ""))"{cmoves.SLS_ID} = " '"' (Trim(sPolhths)) '"'
45260>>>                if (sYpeyth <>'') Append Selection (If(Selection <> "", " and ", ""))"{cmoves.PRESP_ID} = " '"' (Trim(sYpeyth)) '"'
45267>>>        
45267>>>                get  psModule to flysh1
45268>>>                Append Selection (If(Selection <> "", " and ", ""))"{cmoves.Module_From} = " '"' (Trim(flysh1)) '"'
45273>>>        
45273>>>                Append Selection (If(Selection <> "", " and ", "")) ;                      "If (Year({CMOVES.CMOVES_HMNIA})<> " (piYear(Self)) ") Then If ({CMOVES.CTYPKIN_CODE}<> '101' And {CMOVES.CTYPKIN_CODE}<> '102' And {CMOVES.CTYPKIN_CODE}<> '201' And {CMOVES.CTYPKIN_CODE}<> '202') Then True Else False Else True"
45277>>>        
45277>>>                Set Formula 'fMhnas'  to (Winql_Number(iMonthTo))
45278>>>                Set Formula 'fEtos'   to (Winql_Number(iYearTo))
45279>>>                ///Set Formula 'fForeas' to (Winql_String(iPoios+1))
45279>>>        
45279>>>                     If ((iPoios=2) And (sYpeyth =''))  Set Formula 'fforeas'  to (Winql_Number(1))
45282>>>                Else If ((iPoios=1) And (sPolhths=''))  Set Formula 'fforeas'  to (Winql_Number(2))
45286>>>                Else                                    Set Formula 'fforeas'  to (Winql_Number(0))
45288>>>        
45288>>>                Set SelectionFormula To Selection
45289>>>        
45289>>>            End_procedure // OnStartPrinting
45290>>>        
45290>>>        End_Object
45291>>>        
45291>>>        
45291>>>        Object ReportMakepaliaAxioRecords is a CrystalReport
45293>>>            Set Report_View_id  to (Parent(Self))
45294>>>        //    Set Output_Destination          to WQL_PRINT_TO_WINDOW
45294>>>            Set Output_Destination          to WQL_PRINT_TO_FILE
45295>>>            Set UseReportNumberFormat_State to True
45296>>>            Set ExportFormatType            to WQL_CommaSeparatedType
45297>>>            Set FieldDelimiter              to ","
45298>>>            Set StringDelimiter             to '"'
45299>>>            Set UseReportDateFormat_State   To True
45300>>>        
45300>>>            Procedure OnStartPrinting
45302>>>        
45302>>>                local string  lscatypes Startnumbern Startnamen Endnamen stext
45303>>>                Local Date    Starthmen Endhmen
45303>>>                Local string  sstr  Selection FileName slabel shmgio sPolhths sYpeyth sone
45303>>>                local integer FileType Destination SortOrder starttypkinn iMhden iYearTo iMonthTo
45303>>>                Local Integer NumSortFields CurSortField SortDirection wdate fepil iMhnas iEtos iPoios
45303>>>                date apo eos ddate dHmniaEos dHmniaApo
45303>>>                string flysh1 flysh2 sbranch sPolhthsDescr sYpeythDescr
45303>>>                local integer iepidika
45303>>>        
45303>>>                get piepidika to iepidika
45304>>>                move  1 to sone
45305>>>                Get piPoios Of StoixEmp2  to iPoios
45306>>>        
45306>>>                Get fiYear  Of GroupSub3  to iYearTo
45307>>>                Get fiMonth Of GroupSub3  to iMonthTo
45308>>>        
45308>>>                Move (DateCompose(TheDaySegment(beginOfMonth(iMonthTo,(iYearTo))),iMonthTo,(iYearTo)))        to ddate
45309>>>                Move (DateCompose(TheDaySegment(endOfMonth(iMonthTo,(iYearTo))),iMonthTo,(iYearTo)))          to dhmniaeos
45310>>>                Move (DateCompose(TheDaySegment(BeginOfMonth(iMonthTo,(iYearTo-1))),iMonthTo,(iYearTo-1)))    to dHmniaApo
45311>>>        
45311>>>                Get fsPolhths           to sPolhths
45312>>>                Get fsYpeyth            to sYpeyth
45313>>>                Move (Trim(sYpeyth))    to sYpeyth
45314>>>                Move (Trim(sPolhths))   to sPolhths
45315>>>        
45315>>>                Get Value Of (frmPolhthsDescr(GroupSub3(StoixEmp2(Self)))) Item 0 to sPolhthsDescr
45316>>>                Get Value Of (frmYpeythDescr (GroupSub3(StoixEmp2(Self)))) Item 0 to sYpeythDescr
45317>>>                Get Checked_State Of (chkMhden(GroupSub3(StoixEmp2(Self)))) Item 0 to iMhden
45318>>>        
45318>>>                Move "" To Selection
45319>>>                Append Selection (If(Selection <> "", " and ", ""))"{baxio.company_code} = " '"' (Trim(syscurxr.company_code)) '"'
45324>>>                if (sbranch<>'') Append Selection (If(Selection <> "", " and ", ""))"{baxio.branch_code} = " '"' (Trim(sbranch)) '"'
45331>>>                Append Selection (If(Selection <> "", " and ", ""))"{btypkin.btypkin_anti_xp} = 2"
45333>>>                Append Selection (If(Selection <> "", " and ", ""))"{btypkin.btypkin_sign} = 1"
45335>>>        
45335>>>                Append Selection (If(Selection <> "", " and ", ""))"{baxio.BAXIO_PLACE} <> 2 "
45337>>>        
45337>>>                Append Selection (If(Selection <> "", " and ", "")) "{baxio.baxio_hmnial} <= " (winql_date(dhmniaeos))
45340>>>                Append Selection (If(Selection <> "", " and ", "")) "{barticl.barticl_hmnia} <= " (winql_date(dhmniaeos))
45343>>>        
45343>>>                Append Selection (If(Selection <> "", " and ", ""))"{barticl.barticl_ekleise} = " '"' (Trim(sone)) '"'
45348>>>                move '#1#2#10#' to stext
45349>>>                Append Selection (If(Selection <> "", " and ", "")) "InStr('" stext "',('#'+TOTEXT ({baxio.baxiokat_code},0)+'#'))<>0"
45353>>>        
45353>>>        
45353>>>                     If (iPoios=0) Append Selection (If(Selection <> "", " and ", "")) "{baxio.baxio_code_in} <> ''"
45357>>>                Else If (iPoios=1) Append Selection (If(Selection <> "", " and ", "")) "{bmove.sls_id} <> ''"
45362>>>                Else If (iPoios=2) Append Selection (If(Selection <> "", " and ", "")) "{bmove.presp_id} <> ''"
45367>>>        
45367>>>                Get StartNumber To StartNumbern
45368>>>        
45368>>>                If (Trim(StartNumbern)) ne "" ;                    Append Selection (If(Selection <> "", " and ", "")) "{baxio.baxio_code_in} = " '"' (Trim(startnumbern)) '"'
45375>>>        
45375>>>        
45375>>>                if (sPolhths<>'') Append Selection (If(Selection <> "", " and ", ""))"{bmove.SLS_ID} = " '"' (Trim(sPolhths)) '"'
45382>>>                if (sYpeyth <>'') Append Selection (If(Selection <> "", " and ", ""))"{bmove.PRESP_ID} = " '"' (Trim(sYpeyth)) '"'
45389>>>        
45389>>>        
45389>>>                Set Formula 'fMhnas'  to (Winql_Number(iMonthTo))
45390>>>                Set Formula 'fEtos'   to (Winql_Number(iYearTo))
45391>>>        
45391>>>                     If ((iPoios=2) And (sYpeyth =''))  Set Formula 'fforeas'  to (Winql_Number(1))
45394>>>                Else If ((iPoios=1) And (sPolhths=''))  Set Formula 'fforeas'  to (Winql_Number(2))
45398>>>                Else                                    Set Formula 'fforeas'  to (Winql_Number(0))
45400>>>                //Set Formula 'fForeas' to (Winql_String(iPoios+1))
45400>>>        
45400>>>                Set SelectionFormula To Selection
45401>>>        
45401>>>            End_procedure // OnStartPrinting
45402>>>        
45402>>>        End_Object
45403>>>        
45403>>>        
45403>>>        Function Startname Returns String
45405>>>            Function_return (Startname(groupSub3(Current_object)))
45406>>>        End_function // StartCustomer
45407>>>        
45407>>>        Function Starthme Returns integer
45409>>>            Function_return (Starthme(groupSub3(Current_object)))
45410>>>        End_function // StartNumber
45411>>>        
45411>>>        Function fsPolhths Returns string
45413>>>            Function_return (fsPolhths(groupSub3(Current_object)))
45414>>>        End_function
45415>>>        
45415>>>        Function fsYpeyth Returns string
45417>>>            Function_return (fsYpeyth(groupSub3(Current_object)))
45418>>>        End_function
45419>>>        
45419>>>        Function Endname Returns String
45421>>>            Function_return (Endname(groupSub3(Current_object)))
45422>>>        End_function // StartCustomer
45423>>>        
45423>>>        Function StartNumber Returns string
45425>>>            Function_return (StartNumber(groupSub1(Current_object)))
45426>>>        End_function // StartNumber
45427>>>        
45427>>>        
45427>>>        
45427>>>        
45427>>>        
45427>>>        
45427>>>        
45427>>>        //AB-StoreEnd
45427>>>
45427>>>    CD_End_Object    // StoixEmp2
45429>>>>
45429>>>
45429>>>
45429>>>    //AB-StoreStart
45429>>>                                                
45429>>>                                                
45429>>>    //AB-StoreEnd
45429>>>
45429>>>//AB/     End_Object    // prj
45429>        Use R54_1.RV                                                                        
INCLUDING FILE: R54_1.RV
45429>>>//AB/ Project r54_1:kinhseis cars
45429>>>//AB/ Object prj is a Report_Project
45429>>>//AB/     Set ProjectName to "r54_1:kinhseis cars"
45429>>>//AB/     Set ProjectFileName to "R54_1.RV"
45429>>>
45429>>>// Project Object Structure
45429>>>//   r54_1 is a ReportViewSub
45429>>>//     Company_DD is a DataDictionary
45429>>>//     Branch_DD is a DataDictionary
45429>>>//     GroupSub5 is a GroupSub
45429>>>//       parast_apo is a FormSub
45429>>>//       TextBoxSub29 is a TextBoxSub
45429>>>//       parast_descr is a FormSub
45429>>>//       TextBoxSub31 is a TextBoxSub
45429>>>//       car_apo is a FormSub
45429>>>//       apo_descr is a FormSub
45429>>>//       TextBoxSub32 is a TextBoxSub
45429>>>//       car_eos is a FormSub
45429>>>//       eos_descr is a FormSub
45429>>>//     GroupSub4 is a GroupSub
45429>>>//       F_HME_APO is a FormSub
45429>>>//       F_HME_EOS is a FormSub
45429>>>//       Textbox3 is a Textbox
45429>>>//       Textbox4 is a Textbox
45429>>>//     ComboF is a ComboFormSub
45429>>>//     Ffortio is a FormSub
45429>>>//     DestRadio is a RadioGroup
45429>>>//       WindowRadio is a Radio
45429>>>//       PrinterRadio is a Radio
45429>>>//       FileRadio is a Radio
45429>>>//     FileTypeGroup is a Group
45429>>>//       FileNameForm is a Form
45429>>>//         New_dialog is a SaveAsdialog
45429>>>//       TypeCombo is a ComboForm
45429>>>//       ApplyExtCheckBox is a CheckBox
45429>>>//       TextBoxSub23 is a TextBoxSub
45429>>>//       TextBoxSub24 is a TextBoxSub
45429>>>//     ButtonSub1 is a Button
45429>>>//     ButtonSub2 is a ButtonSub
45429>>>//     LineControlSub1 is a LineControlSub
45429>>>//     Textbox6 is a Textbox
45429>>>//     Form1 is a Form
45429>>>//     Form2 is a Form
45429>>>//     dblstBranch is a dbListSub
45429>>>//     Textbox7 is a Textbox
45429>>>//     TextBoxSub33 is a TextBoxSub
45429>>>//     TextBoxSub34 is a TextBoxSub
45429>>>//     carsWQLReport is a CrystalReportSubSQL
45429>>>
45429>>>// Register all objects
45429>>>Register_Object ApplyExtCheckBox
45429>>>Register_Object apo_descr
45429>>>Register_Object Branch_DD
45429>>>Register_Object ButtonSub1
45429>>>Register_Object ButtonSub2
45429>>>Register_Object ComboF
45429>>>Register_Object Company_DD
45429>>>Register_Object car_apo
45429>>>Register_Object car_eos
45429>>>Register_Object carsWQLReport
45429>>>Register_Object DestRadio
45429>>>Register_Object dblstBranch
45429>>>Register_Object eos_descr
45429>>>Register_Object F_HME_APO
45429>>>Register_Object F_HME_EOS
45429>>>Register_Object Ffortio
45429>>>Register_Object FileNameForm
45429>>>Register_Object FileRadio
45429>>>Register_Object FileTypeGroup
45429>>>Register_Object Form1
45429>>>Register_Object Form2
45429>>>Register_Object GroupSub4
45429>>>Register_Object GroupSub5
45429>>>Register_Object LineControlSub1
45429>>>Register_Object New_dialog
45429>>>Register_Object PrinterRadio
45429>>>Register_Object parast_apo
45429>>>Register_Object parast_descr
45429>>>Register_Object r54_1
45429>>>Register_Object TextBoxSub23
45429>>>Register_Object TextBoxSub24
45429>>>Register_Object TextBoxSub29
45429>>>Register_Object TextBoxSub31
45429>>>Register_Object TextBoxSub32
45429>>>Register_Object TextBoxSub33
45429>>>Register_Object TextBoxSub34
45429>>>Register_Object Textbox3
45429>>>Register_Object Textbox4
45429>>>Register_Object Textbox6
45429>>>Register_Object Textbox7
45429>>>Register_Object TypeCombo
45429>>>Register_Object WindowRadio
45429>>>
45429>>>
45429>>>//AB/ Report View
45429>>>
45429>>>
45429>>>//AB-StoreTopStart
45429>>>Use dfallrpt
45429>>>open branch
45431>>>open cars
INCLUDING FILE: CARS.FD
45433>>>use sl012.sl
INCLUDING FILE: SL012.SL
45433>>>>>//AB/ Project sl012 : Ptyppar
45433>>>>>//AB/ Object prj is a Lookup_Project
45433>>>>>//AB/     Set ProjectName to "sl012 : Ptyppar"
45433>>>>>//AB/     Set ProjectFileName to "sl012.SL"
45433>>>>>//AB/     Set GenerateFileName to "NONAME"
45433>>>>>
45433>>>>>// Project Object Structure
45433>>>>>//   sl012 is a dbModalPanelSub
45433>>>>>//     Ctypkin_DD is a DataDictionary
45433>>>>>//     Wtypkin_DD is a DataDictionary
45433>>>>>//     Ptyppar_DD is a DataDictionary
45433>>>>>//     oSelList is a dbListSub
45433>>>>>//     oOK_bn is a ButtonSub
45433>>>>>//     oCancel_bn is a ButtonSub
45433>>>>>//     oSearch_bn is a ButtonSub
45433>>>>>
45433>>>>>// Register all objects
45433>>>>>Register_Object Ctypkin_DD
45433>>>>>Register_Object oCancel_bn
45433>>>>>Register_Object oOK_bn
45433>>>>>Register_Object oSearch_bn
45433>>>>>Register_Object oSelList
45433>>>>>Register_Object Ptyppar_DD
45433>>>>>Register_Object sl012
45433>>>>>Register_Object Wtypkin_DD
45433>>>>>
45433>>>>>
45433>>>>>//AB-IgnoreStart
45433>>>>>
45433>>>>>Use DFAllEnt.pkg
45433>>>>>Use dbList.Sub
45433>>>>>Use Button.Sub
45433>>>>>
45433>>>>>
45433>>>>>Use CTYPKIN.DD
45433>>>>>Use WTYPKIN.DD
INCLUDING FILE: WTYPKIN.DD
45433>>>>>>>//DDB-FileStart
45433>>>>>>>//DDB-HeaderStart
45433>>>>>>>
45433>>>>>>>// File Name : WTYPKIN.DD
45433>>>>>>>// Class Name: Wtypkin_DataDictionary
45433>>>>>>>// Revision  : 49
45433>>>>>>>// Version   : 2
45433>>>>>>>
45433>>>>>>>Use  Windows           // Basic Definitions
45433>>>>>>>Use  DataDict          // DataDictionary Class Definition
45433>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
45433>>>>>>>
45433>>>>>>>Open Wtypkin
45435>>>>>>>Open Ptyppar
45437>>>>>>>Open Wcmoves
45439>>>>>>>Open Hmwtyp
INCLUDING FILE: HMWTYP.FD
45441>>>>>>>Open Wflagkin
INCLUDING FILE: WFLAGKIN.FD
45443>>>>>>>Open Sysrecw
45445>>>>>>>Open Syscurxr
45447>>>>>>>
45447>>>>>>>//DDB-HeaderEnd
45447>>>>>>>//DDB-ValidationStart
45447>>>>>>>
45447>>>>>>>Register_Object Wtypkin_Wtypkin_Module_VT
45447>>>>>>>
45447>>>>>>>Object Wtypkin_Wtypkin_Module_VT  is a CodeValidationTable
45449>>>>>>>    Set Type_Value        To "MODULE"
45450>>>>>>>    //DDB-ValidationCustomStart
45450>>>>>>>    //DDB-ValidationCustomEnd
45450>>>>>>>End_Object   // Wtypkin_Wtypkin_Module_VT
45451>>>>>>>//DDB-ValidationEnd
45451>>>>>>>//DDB-SelectionStart
45451>>>>>>>//DDB/ ExternalSelectionList sl029a  sl029a.SL
45451>>>>>>>Register_Object sl029a
45451>>>>>>>//DDB-SelectionEnd
45451>>>>>>>
45451>>>>>>>Class Wtypkin_DataDictionary  is a DataDictionary
45452>>>>>>>               
45452>>>>>>>    Procedure Construct_Object
45453>>>>>>>        Forward Send Construct_Object
45455>>>>>>>        Property Integer piMustNOTConstrain Public 0
45456>>>>>>>    End_Procedure
45457>>>>>>>
45457>>>>>>>    Procedure Save_Main_File
45458>>>>>>>        If (Operation_Origin<>Self) Begin
45460>>>>>>>            If Wtypkin.Recnum Eq 0 Procedure_Return
45463>>>>>>>        End
45463>>>>>>>>
45463>>>>>>>        Forward Send Save_Main_File
45465>>>>>>>    End_Procedure
45466>>>>>>>
45466>>>>>>>
45466>>>>>>>     Procedure Creating
45467>>>>>>>        Forward Send Creating
45469>>>>>>>        // Insert Code Here
45469>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wtypkin.Wtypkin_Rec0)))))) to Wtypkin.Wtypkin_Recr
45470>>>>>>>    End_Procedure   // Creating
45471>>>>>>>
45471>>>>>>>    // Define_Fields:
45471>>>>>>>    // This procedure is used to set up all data-dictionary rules.
45471>>>>>>>
45471>>>>>>>    Procedure Define_Fields
45472>>>>>>>        Forward Send Define_Fields
45474>>>>>>>        //DDB-Generated-Code-Location
45474>>>>>>>        //DDB-DefineFieldStart
45474>>>>>>>
45474>>>>>>>        Set Main_File            To Wtypkin.File_Number
45475>>>>>>>        Set Cascade_Delete_State To FALSE
45476>>>>>>>
45476>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
45477>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
45478>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
45479>>>>>>>
45479>>>>>>>        // Child (Client) file structure................
45479>>>>>>>        Send Add_Client_File  Ptyppar.File_Number
45480>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
45481>>>>>>>        Send Add_Client_File  Hmwtyp.File_Number
45482>>>>>>>        Send Add_Client_File  Wflagkin.File_Number
45483>>>>>>>
45483>>>>>>>        // External (System) file structure.............
45483>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
45484>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
45485>>>>>>>
45485>>>>>>>        Define_Auto_Increment  Sysrecw.Wtypkin_Rec0  To Wtypkin.Wtypkin_Rec0
45488>>>>>>>
45488>>>>>>>        // Field-based properties.......................
45488>>>>>>>
45488>>>>>>>        // Wtypkin.Company_Code
45488>>>>>>>
45488>>>>>>>        // Wtypkin.Branch_Code
45488>>>>>>>
45488>>>>>>>        // Wtypkin.Year_Year
45488>>>>>>>
45488>>>>>>>        // Wtypkin.Wtypkin_Code
45488>>>>>>>        Set Field_Options          Field Wtypkin.Wtypkin_Code To DD_AUTOFIND   
45489>>>>>>>        Set Field_Prompt_Object    Field Wtypkin.Wtypkin_Code To (sl029a(Self))
45490>>>>>>>        Set Key_Field_State        Field Wtypkin.Wtypkin_Code To TRUE
45491>>>>>>>
45491>>>>>>>        // Wtypkin.Wtypkin_Rec0
45491>>>>>>>        Set Field_Options          Field Wtypkin.Wtypkin_Rec0 To DD_AUTOFIND   
45492>>>>>>>
45492>>>>>>>        // Wtypkin.Wtypkin_Recr
45492>>>>>>>
45492>>>>>>>        // Wtypkin.Year_Recr
45492>>>>>>>
45492>>>>>>>        // Wtypkin.Wtypkin_Descr
45492>>>>>>>        Set Field_Prompt_Object    Field Wtypkin.Wtypkin_Descr To (sl029a(Self))
45493>>>>>>>
45493>>>>>>>        // Wtypkin.Wtypkin_Anti
45493>>>>>>>
45493>>>>>>>        // Wtypkin.Wtypkin_Module
45493>>>>>>>        Set Field_Value_Table      Field Wtypkin.Wtypkin_Module To (Wtypkin_Wtypkin_Module_VT(Self))
45494>>>>>>>
45494>>>>>>>        // Wtypkin.Max_Days_Sx_Par
45494>>>>>>>
45494>>>>>>>        //DDB-DefineFieldEnd
45494>>>>>>>    End_Procedure    // Define_Fields
45495>>>>>>>
45495>>>>>>>    // Field_Defaults:
45495>>>>>>>    // This procedure is used to establish default field values.
45495>>>>>>>
45495>>>>>>>    Procedure Field_Defaults
45496>>>>>>>        Forward Send Field_Defaults
45498>>>>>>>        //DDB-Generated-Code-Location
45498>>>>>>>        //DDB-FieldDefaultStart
45498>>>>>>>        //DDB-FieldDefaultEnd
45498>>>>>>>    End_Procedure    // Field_Defaults
45499>>>>>>>
45499>>>>>>>End_Class    // Wtypkin_DataDictionary
45500>>>>>>>//DDB-Selection-pkg-Start
45500>>>>>>>
45500>>>>>>>Use sl029a.SL        // sl029a
INCLUDING FILE: SL029A.SL
45500>>>>>>>>>//AB/ Project sl029a:wtypkin
45500>>>>>>>>>//AB/     Object prj is a Lookup_Project
45500>>>>>>>>>//AB/         Set ProjectName to "sl029a:wtypkin"
45500>>>>>>>>>//AB/         Set ProjectFileName to "sl029a.SL"
45500>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
45500>>>>>>>>>
45500>>>>>>>>>// Project Object Structure
45500>>>>>>>>>//   sl029a is a dbModalPanelSub
45500>>>>>>>>>//     Wtypkin_DD is a DataDictionary
45500>>>>>>>>>//     oSelList is a dbListSub
45500>>>>>>>>>//     oOK_bn is a ButtonSub
45500>>>>>>>>>//     oCancel_bn is a ButtonSub
45500>>>>>>>>>//     oSearch_bn is a ButtonSub
45500>>>>>>>>>
45500>>>>>>>>>// Register all objects
45500>>>>>>>>>Register_Object oCancel_bn
45500>>>>>>>>>Register_Object oOK_bn
45500>>>>>>>>>Register_Object oSearch_bn
45500>>>>>>>>>Register_Object oSelList
45500>>>>>>>>>Register_Object sl029a
45500>>>>>>>>>Register_Object Wtypkin_DD
45500>>>>>>>>>
45500>>>>>>>>>
45500>>>>>>>>>    //AB-IgnoreStart
45500>>>>>>>>>
45500>>>>>>>>>    Use DFAllEnt.pkg
45500>>>>>>>>>    Use dbList.Sub
45500>>>>>>>>>    Use Button.Sub
45500>>>>>>>>>
45500>>>>>>>>>
45500>>>>>>>>>    Use WTYPKIN.DD
45500>>>>>>>>>    
45500>>>>>>>>>    //AB-IgnoreEnd
45500>>>>>>>>>
45500>>>>>>>>>    Object sl029a is a dbModalPanelSub
45502>>>>>>>>>        set label to "Ž¨ ©£æª ‰ ¤ã©œà¤ €§¦Ÿã¡žª" 
45503>>>>>>>>>        Set Size to 148 297
45504>>>>>>>>>        Set Location to 4 5
45505>>>>>>>>>        Set Exit_Application_Local_State to FALSE
45506>>>>>>>>>        Set Modal_State to FALSE
45507>>>>>>>>>
45507>>>>>>>>>        //AB-DDOStart
45507>>>>>>>>>
45507>>>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
45509>>>>>>>>>        End_Object    // Wtypkin_DD
45510>>>>>>>>>
45510>>>>>>>>>        Set Main_DD to (Wtypkin_DD(self))
45511>>>>>>>>>        Set Server to (Wtypkin_DD(self))
45512>>>>>>>>>
45512>>>>>>>>>        //AB-DDOEnd
45512>>>>>>>>>
45512>>>>>>>>>        Object oSelList is a dbListSub
45514>>>>>>>>>            Set Main_File to Wtypkin.File_Number
45515>>>>>>>>>            Set Size to 105 280
45516>>>>>>>>>            Set Location to 6 6
45517>>>>>>>>>
45517>>>>>>>>>            Begin_Row
45520>>>>>>>>>                Entry_Item Wtypkin.Wtypkin_code
45521>>>>>>>>>                Entry_Item Wtypkin.Wtypkin_descr
45522>>>>>>>>>            End_Row
45527>>>>>>>>>
45527>>>>>>>>>            Set Form_Width    item 0 to 60
45528>>>>>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
45529>>>>>>>>>            
45529>>>>>>>>>            Set Form_Width    item 1 to 212
45530>>>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
45531>>>>>>>>>            
45531>>>>>>>>>        End_Object    // oSelList
45532>>>>>>>>>
45532>>>>>>>>>        Object oOK_bn is a ButtonSub
45534>>>>>>>>>            set label to "&„§ ¢¦šã" 
45535>>>>>>>>>            Set Location to 115 126
45536>>>>>>>>>
45536>>>>>>>>>            //AB-StoreStart
45536>>>>>>>>>            Procedure OnClick
45538>>>>>>>>>                Send OK To (oSelList(current_object))
45539>>>>>>>>>            End_Procedure
45540>>>>>>>>>            //AB-StoreEnd
45540>>>>>>>>>
45540>>>>>>>>>        End_Object    // oOK_bn
45541>>>>>>>>>
45541>>>>>>>>>        Object oCancel_bn is a ButtonSub
45543>>>>>>>>>            set label to "&€¡ç¨à©ž" 
45544>>>>>>>>>            Set Location to 115 181
45545>>>>>>>>>
45545>>>>>>>>>            //AB-StoreStart
45545>>>>>>>>>            Procedure OnClick
45547>>>>>>>>>                Send Cancel To (oSelList(current_object))
45548>>>>>>>>>            End_Procedure
45549>>>>>>>>>            //AB-StoreEnd
45549>>>>>>>>>
45549>>>>>>>>>        End_Object    // oCancel_bn
45550>>>>>>>>>
45550>>>>>>>>>        Object oSearch_bn is a ButtonSub
45552>>>>>>>>>            set label to "€&¤˜ã«ž©ž" 
45553>>>>>>>>>            Set Location to 115 236
45554>>>>>>>>>
45554>>>>>>>>>            //AB-StoreStart
45554>>>>>>>>>            Procedure OnClick
45556>>>>>>>>>                Send Search To (oSelList(current_object))
45557>>>>>>>>>            End_Procedure
45558>>>>>>>>>            //AB-StoreEnd
45558>>>>>>>>>
45558>>>>>>>>>        End_Object    // oSearch_bn
45559>>>>>>>>>
45559>>>>>>>>>
45559>>>>>>>>>        //AB-StoreStart
45559>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
45560>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
45561>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
45562>>>>>>>>>        //AB-StoreEnd
45562>>>>>>>>>
45562>>>>>>>>>    End_Object    // sl029a
45563>>>>>>>>>
45563>>>>>>>>>//AB/     End_Object    // prj
45563>>>>>>>
45563>>>>>>>//DDB-Selection-pkg-End
45563>>>>>>>//DDB-FileEnd
45563>>>>>Use PTYPPAR.DD
INCLUDING FILE: PTYPPAR.DD
45563>>>>>>>//DDB-FileStart
45563>>>>>>>//DDB-HeaderStart
45563>>>>>>>
45563>>>>>>>// File Name : PTYPPAR.DD
45563>>>>>>>// Class Name: Ptyppar_DataDictionary
45563>>>>>>>// Revision  : 88
45563>>>>>>>// Version   : 2
45563>>>>>>>
45563>>>>>>>Use  Windows           // Basic Definitions
45563>>>>>>>Use  DataDict          // DataDictionary Class Definition
45563>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
45563>>>>>>>
45563>>>>>>>Open Ptyppar
45565>>>>>>>Open Particle
45567>>>>>>>Open Pseira
INCLUDING FILE: PSEIRA.FD
45569>>>>>>>Open Ptypmet
INCLUDING FILE: PTYPMET.FD
45571>>>>>>>Open Ptypparh
INCLUDING FILE: PTYPPARH.FD
45573>>>>>>>Open Ctypkin
45575>>>>>>>Open Wtypkin
45577>>>>>>>Open Sysrecp
INCLUDING FILE: SYSRECP.FD
45579>>>>>>>Open Syscurxr
45581>>>>>>>
45581>>>>>>>//DDB-HeaderEnd
45581>>>>>>>//DDB-ValidationStart
45581>>>>>>>
45581>>>>>>>Register_Object Ptyppar_Year_Recr_VT
45581>>>>>>>Register_Object Ptyppar_Ptyppar_Is_What_VT
45581>>>>>>>Register_Object Ptyppar_Ptyppar_Module_VT
45581>>>>>>>Register_Object Ptyppar_Ti_Typonei_Pms_VT1
45581>>>>>>>
45581>>>>>>>Object Ptyppar_Year_Recr_VT  is a DescriptionValidationTable
45583>>>>>>>    Set Allow_Blank_State To TRUE
45584>>>>>>>
45584>>>>>>>    Procedure Fill_List
45586>>>>>>>        Forward Send Fill_List
45588>>>>>>>        Send Add_Table_Value  ""  "ƒœ¤ ‘¬££œ«â®œ "
45589>>>>>>>        Send Add_Table_Value  "1"  "¨¦©Ÿœ« ¡á"
45590>>>>>>>        Send Add_Table_Value  "2"  "€­˜ ¨œ« ¡á"
45591>>>>>>>    End_Procedure    // Fill_List
45592>>>>>>>    //DDB-ValidationCustomStart
45592>>>>>>>    //DDB-ValidationCustomEnd
45592>>>>>>>End_Object   // Ptyppar_Year_Recr_VT
45593>>>>>>>
45593>>>>>>>Object Ptyppar_Ptyppar_Is_What_VT  is a DescriptionValidationTable
45595>>>>>>>
45595>>>>>>>    Procedure Fill_List
45597>>>>>>>        Forward Send Fill_List
45599>>>>>>>        Send Add_Table_Value  "1"  "€š¦¨á"
45600>>>>>>>        Send Add_Table_Value  "2"  "é¢ž©ž"
45601>>>>>>>        Send Add_Table_Value  "3"  "€ŠŠŽ"
45602>>>>>>>    End_Procedure    // Fill_List
45603>>>>>>>    //DDB-ValidationCustomStart
45603>>>>>>>    //DDB-ValidationCustomEnd
45603>>>>>>>End_Object   // Ptyppar_Ptyppar_Is_What_VT
45604>>>>>>>
45604>>>>>>>Object Ptyppar_Ptyppar_Module_VT  is a CodeValidationTable
45606>>>>>>>    Set Type_Value        To "MODULE"
45607>>>>>>>    Set Allow_Blank_State To TRUE
45608>>>>>>>    //DDB-ValidationCustomStart
45608>>>>>>>    //DDB-ValidationCustomEnd
45608>>>>>>>End_Object   // Ptyppar_Ptyppar_Module_VT
45609>>>>>>>
45609>>>>>>>Object Ptyppar_Ti_Typonei_Pms_VT1  is a DescriptionValidationTable
45611>>>>>>>    Set Allow_Blank_State To TRUE
45612>>>>>>>
45612>>>>>>>    Procedure Fill_List
45614>>>>>>>        Forward Send Fill_List
45616>>>>>>>        Send Add_Table_Value  ""  "¦©æ«ž«œª ¡˜  €¥åœª"
45617>>>>>>>        Send Add_Table_Value  "1"  "¦©æ«ž«œª"
45618>>>>>>>        Send Add_Table_Value  "2"  "€¥åœª"
45619>>>>>>>    End_Procedure    // Fill_List
45620>>>>>>>    //DDB-ValidationCustomStart
45620>>>>>>>    //DDB-ValidationCustomEnd
45620>>>>>>>End_Object   // Ptyppar_Ti_Typonei_Pms_VT1
45621>>>>>>>//DDB-ValidationEnd
45621>>>>>>>//DDB-SelectionStart
45621>>>>>>>//DDB/ ExternalSelectionList sl012  sl012.SL
45621>>>>>>>Register_Object sl012
45621>>>>>>>//DDB-SelectionEnd
45621>>>>>>>
45621>>>>>>>Class Ptyppar_DataDictionary  is a DataDictionary_Sec
45622>>>>>>>
45622>>>>>>>    Procedure Construct_Object
45623>>>>>>>        Forward Send Construct_Object
45625>>>>>>>        Property Integer piMustNOTConstrain Public 0
45626>>>>>>>        Property Integer piOldCtypkin       Public 0
45627>>>>>>>        Property Integer piOldWtypkin       Public 0
45628>>>>>>>    End_Procedure
45629>>>>>>>
45629>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
45630>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
45632>>>>>>>        Set piOldCtypkin to Ctypkin.Ctypkin_Code
45633>>>>>>>        Set piOldWtypkin to Wtypkin.Wtypkin_Code
45634>>>>>>>    End_Procedure   // New_Current_Record
45635>>>>>>>
45635>>>>>>>    Procedure OnConstrain
45636>>>>>>>        If (piMustNotConstrain(Self)=0) Begin
45638>>>>>>>            Constrain Ptyppar.Company_Code  eq SysCurXR.Company_Code
45640>>>>>>>            Constrain Ptyppar.Branch_Code   eq SysCurXR.Branch_Code
45642>>>>>>>        End
45642>>>>>>>>
45642>>>>>>>    End_Procedure
45643>>>>>>>
45643>>>>>>>    Procedure Clear_Main_File
45644>>>>>>>        Forward Send Clear_Main_File
45646>>>>>>>        Set piOldCtypkin to 0
45647>>>>>>>        Set piOldWtypkin to 0
45648>>>>>>>    End_Procedure
45649>>>>>>>
45649>>>>>>>    Procedure Save_Main_File
45650>>>>>>>        Integer isAdmin iYes
45651>>>>>>>        String  sStr
45651>>>>>>>        Get fig_Is_Admin to isAdmin
45652>>>>>>>
45652>>>>>>>        If (Operation_Origin<>Self) Begin
45654>>>>>>>            If Ptyppar.Recnum Eq 0 Procedure_Return
45657>>>>>>>        End
45657>>>>>>>>
45657>>>>>>>        If (Operation_Origin=Self) Begin
45659>>>>>>>            If ((piOldCtypkin(Self)<>0) And (piOldCtypkin(Self)<>Ctypkin.Ctypkin_Code)) Begin
45661>>>>>>>                If (Not(isAdmin)) Error 1001 'ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ¡å¤ž©žª §œ¢á«ž'
45664>>>>>>>                Else Begin
45665>>>>>>>                    Move '' to sStr
45666>>>>>>>                    Append sStr '€¤ ˜¢¢á¥œ«œ ¡å¤ž©ž, £§¦¨œå ¤˜ œ§ž¨œá©œ  ã›ž ¡˜«˜®à¨ž£â¤˜ §˜¨˜©«˜« ¡á\n «˜ ¦§¦å˜ â®¦¬¤ ­« ˜®«œå £œ « ª §˜¢ âª ¡ ¤ã©œ ª §¦¬ «é¨˜ ˜¢¢áœ«œ\n„å©«œ ™â™˜ ¦  §àª Ÿâ¢œ«œ ¤˜ ©¬¤œ®å©à ?'
45667>>>>>>>                    Get YesNo_Box sStr to iYes
45668>>>>>>>                    If (iYes=MBR_NO) Error 1000 '€¡¬¨éŸž¡œ ž › ˜› ¡˜©å˜ ˜¢¢˜šãª ˜§¦ «¦¤ ®¨ã©«ž'
45671>>>>>>>                End
45671>>>>>>>>
45671>>>>>>>            End // If ((piOldCtypkin(Self)<>0) And (piOldCtypkin(Self)<>Ctypkin.Ctypkin_Code))
45671>>>>>>>>
45671>>>>>>>            If ((piOldWtypkin(Self)<>0) And (piOldWtypkin(Self)<>Wtypkin.Wtypkin_Code)) Begin
45673>>>>>>>                If (Not(isAdmin)) Error 1002 'ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ¡å¤ž©žª ˜§¦Ÿã¡žª'
45676>>>>>>>                Else Begin
45677>>>>>>>                    Move '' to sStr
45678>>>>>>>                    Append sStr '€¤ ˜¢¢á¥œ«œ ¡å¤ž©ž, £§¦¨œå ¤˜ œ§ž¨œá©œ  ã›ž ¡˜«˜®à¨ž£â¤˜ §˜¨˜©«˜« ¡á\n «˜ ¦§¦å˜ â®¦¬¤ ­« ˜®«œå £œ « ª §˜¢ âª ¡ ¤ã©œ ª §¦¬ «é¨˜ ˜¢¢áœ«œ\n„å©«œ ™â™˜ ¦  §àª Ÿâ¢œ«œ ¤˜ ©¬¤œ®å©à ?'
45679>>>>>>>                    Get YesNo_Box sStr to iYes
45680>>>>>>>                    If (iYes=MBR_NO) Error 1000 '€¡¬¨éŸž¡œ ž › ˜› ¡˜©å˜ ˜¢¢˜šãª ˜§¦ «¦¤ ®¨ã©«ž'
45683>>>>>>>                End
45683>>>>>>>>
45683>>>>>>>            End // ((piOldWtypkin(Self)<>0) And (piOldWtypkin(Self)<>Wtypkin.Wtypkin_Code))
45683>>>>>>>>
45683>>>>>>>        End // If (Operation_Origin=Self)
45683>>>>>>>>
45683>>>>>>>        Forward Send Save_Main_File
45685>>>>>>>    End_Procedure // Save_Main_File
45686>>>>>>>
45686>>>>>>>
45686>>>>>>>    Procedure Update
45687>>>>>>>        Forward Send Update
45689>>>>>>>        // Insert Code Here
45689>>>>>>>//        If (piMustNotConstrain(Self)=0) Begin
45689>>>>>>>            Move SysCurXR.Company_Code  to Ptyppar.Company_Code
45690>>>>>>>            Move SysCurXR.Branch_Code   to Ptyppar.Branch_Code
45691>>>>>>>//        end
45691>>>>>>>//        Move SysCurXR.Year_Year     to Ptyppar.Year_Year
45691>>>>>>>//        Move SysCurXR.Year_Recr     to Ptyppar.Year_Recr
45691>>>>>>>        Move Ctypkin.Ctypkin_Code   to Ptyppar.Ctypkin_Code
45692>>>>>>>        Move Wtypkin.Wtypkin_Code   to Ptyppar.Wtypkin_Code
45693>>>>>>>    End_Procedure   // Update
45694>>>>>>>
45694>>>>>>>    Procedure Creating
45695>>>>>>>        Forward Send Creating
45697>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Ptyppar.Ptyppar_Rec0)))))) to Ptyppar.Ptyppar_Recr
45698>>>>>>>    End_Procedure   // Creating
45699>>>>>>>
45699>>>>>>>
45699>>>>>>>    // Define_Fields:
45699>>>>>>>    // This procedure is used to set up all data-dictionary rules.
45699>>>>>>>    Procedure Define_Fields
45700>>>>>>>        Forward Send Define_Fields
45702>>>>>>>        //DDB-Generated-Code-Location
45702>>>>>>>        //DDB-DefineFieldStart
45702>>>>>>>
45702>>>>>>>        Set Main_File            To Ptyppar.File_Number
45703>>>>>>>        Set Cascade_Delete_State To FALSE
45704>>>>>>>
45704>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
45705>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
45706>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
45707>>>>>>>
45707>>>>>>>        // Child (Client) file structure................
45707>>>>>>>        Send Add_Client_File  Particle.File_Number
45708>>>>>>>        Send Add_Client_File  Pseira.File_Number
45709>>>>>>>        Send Add_Client_File  Ptypmet.File_Number
45710>>>>>>>        Send Add_Client_File  Ptypparh.File_Number
45711>>>>>>>
45711>>>>>>>        // Parent (Server) file structure...............
45711>>>>>>>        Send Add_Server_File  Ctypkin.File_Number
45712>>>>>>>        Send Add_Server_File  Wtypkin.File_Number
45713>>>>>>>
45713>>>>>>>        // External (System) file structure.............
45713>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
45714>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
45715>>>>>>>
45715>>>>>>>        Define_Auto_Increment  Sysrecp.Ptyppar_Rec0  To Ptyppar.Ptyppar_Rec0
45718>>>>>>>
45718>>>>>>>        // Field-based properties.......................
45718>>>>>>>
45718>>>>>>>        // Ptyppar.Company_Code
45718>>>>>>>
45718>>>>>>>        // Ptyppar.Branch_Code
45718>>>>>>>
45718>>>>>>>        // Ptyppar.Year_Year
45718>>>>>>>
45718>>>>>>>        // Ptyppar.Ctypkin_Code
45718>>>>>>>
45718>>>>>>>        // Ptyppar.Wtypkin_Code
45718>>>>>>>
45718>>>>>>>        // Ptyppar.Year_Recr
45718>>>>>>>        Set Field_Value_Table      Field Ptyppar.Year_Recr To (Ptyppar_Year_Recr_VT(Self))
45719>>>>>>>
45719>>>>>>>        // Ptyppar.Ctypkin_Recr
45719>>>>>>>
45719>>>>>>>        // Ptyppar.Wtypkin_Recr
45719>>>>>>>
45719>>>>>>>        // Ptyppar.Ptyppar_Code
45719>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Code To DD_AUTOFIND   
45720>>>>>>>        Set Field_Prompt_Object    Field Ptyppar.Ptyppar_Code To (sl012(Self))
45721>>>>>>>        Set Key_Field_State        Field Ptyppar.Ptyppar_Code To TRUE
45722>>>>>>>
45722>>>>>>>        // Ptyppar.Ptyppar_Rec0
45722>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Rec0 To DD_AUTOFIND   
45723>>>>>>>
45723>>>>>>>        // Ptyppar.Ptyppar_Descr
45723>>>>>>>        Set Field_Prompt_Object    Field Ptyppar.Ptyppar_Descr To (sl012(Self))
45724>>>>>>>
45724>>>>>>>        // Ptyppar.Ptyppar_Recr
45724>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Recr To DD_AUTOFIND   
45725>>>>>>>
45725>>>>>>>        // Ptyppar.Ptyppar_Is_What
45725>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ptyppar_Is_What To (Ptyppar_Ptyppar_Is_What_VT(Self))
45726>>>>>>>
45726>>>>>>>        // Ptyppar.Ptyppar_Module
45726>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ptyppar_Module To (Ptyppar_Ptyppar_Module_VT(Self))
45727>>>>>>>
45727>>>>>>>        // Ptyppar.Ptyppar_Abrev
45727>>>>>>>
45727>>>>>>>        // Ptyppar.Ftiaxnei_Tpay
45727>>>>>>>        Set Field_Class_Name       Field Ptyppar.Ftiaxnei_Tpay To "dbCheckBoxsub"
45728>>>>>>>
45728>>>>>>>        // Ptyppar.Ti_Typonei_Pms
45728>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ti_Typonei_Pms To (Ptyppar_Ti_Typonei_Pms_VT1(Self))
45729>>>>>>>
45729>>>>>>>        // Ptyppar.Einai_Paroxh_Yp
45729>>>>>>>        Set Field_Checkbox_Values  Field Ptyppar.Einai_Paroxh_Yp To "1"  "0"
45730>>>>>>>        Set Field_Class_Name       Field Ptyppar.Einai_Paroxh_Yp To "dbCheckBoxsub"
45731>>>>>>>
45731>>>>>>>        // Ptyppar.Gtypkin_Code
45731>>>>>>>
45731>>>>>>>        // Ptyppar.Sysxet_Ptyppar
45731>>>>>>>
45731>>>>>>>        // Ptyppar.Sysx_Ptyp_Recr
45731>>>>>>>
45731>>>>>>>        // Ptyppar.Check_Posa_Plaf
45731>>>>>>>
45731>>>>>>>        // Ptyppar.Singular
45731>>>>>>>
45731>>>>>>>        // Ptyppar.Sub
45731>>>>>>>
45731>>>>>>>        // Ptyppar.Constrain
45731>>>>>>>
45731>>>>>>>        // Ptyppar.Label
45731>>>>>>>
45731>>>>>>>        // Ptyppar.Label1
45731>>>>>>>
45731>>>>>>>        // Ptyppar.Sap
45731>>>>>>>
45731>>>>>>>        // Ptyppar.Is_Xondr
45731>>>>>>>
45731>>>>>>>        //DDB-DefineFieldEnd
45731>>>>>>>    End_Procedure    // Define_Fields
45732>>>>>>>
45732>>>>>>>    // Field_Defaults:
45732>>>>>>>    // This procedure is used to establish default field values.
45732>>>>>>>
45732>>>>>>>    Procedure Field_Defaults
45733>>>>>>>        Forward Send Field_Defaults
45735>>>>>>>        //DDB-Generated-Code-Location
45735>>>>>>>        //DDB-FieldDefaultStart
45735>>>>>>>        Set Field_Changed_Value   Field Ptyppar.Ftiaxnei_Tpay To "1"
45736>>>>>>>        Set Field_Changed_Value   Field Ptyppar.Einai_Paroxh_Yp To 0
45737>>>>>>>        //DDB-FieldDefaultEnd
45737>>>>>>>    End_Procedure    // Field_Defaults
45738>>>>>>>
45738>>>>>>>End_Class    // Ptyppar_DataDictionary
45739>>>>>>>//DDB-Selection-pkg-Start
45739>>>>>>>
45739>>>>>>>Use sl012.SL         // sl012
45739>>>>>>>
45739>>>>>>>//DDB-Selection-pkg-End
45739>>>>>>>//DDB-FileEnd
45739>>>>>
45739>>>>>//AB-IgnoreEnd
45739>>>>>
45739>>>>>Object sl012 is a dbModalPanelSub
45741>>>>>
45741>>>>>    //AB-StoreTopStart
45741>>>>>    Property String psModule Public ''
45743>>>>>    Property integer pifromclient Public 0
45745>>>>>    
45745>>>>>    //AB-StoreTopEnd
45745>>>>>
45745>>>>>    Set Label to "’ç§¦  §˜¨˜©«˜« ¡é¤"
45746>>>>>    Set Size to 203 490
45747>>>>>    Set Location to 4 4
45748>>>>>    Set Exit_Application_Local_State to FALSE
45749>>>>>    Set Modal_State to FALSE
45750>>>>>
45750>>>>>    //AB-DDOStart
45750>>>>>
45750>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
45752>>>>>    End_Object    // Ctypkin_DD
45753>>>>>
45753>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
45755>>>>>    End_Object    // Wtypkin_DD
45756>>>>>
45756>>>>>    Object Ptyppar_DD is a Ptyppar_DataDictionary
45758>>>>>        Set DDO_Server to (Ctypkin_DD(self))
45759>>>>>        Set DDO_Server to (Wtypkin_DD(self))
45760>>>>>
45760>>>>>        //AB-StoreStart
45760>>>>>        
45760>>>>>        Procedure OnConstrain
45762>>>>>            Forward Send OnConstrain
45764>>>>>            If (psModule(Self)<>'') Begin
45766>>>>>                Constrain Ptyppar.Ptyppar_Module eq (psModule(Self))
45768>>>>>            End
45768>>>>>>
45768>>>>>            If (pifromclient(self)=1) Begin
45770>>>>>                Constrain Ptyppar.constrain eq '1'
45772>>>>>            End
45772>>>>>>
45772>>>>>        End_Procedure
45773>>>>>        
45773>>>>>        
45773>>>>>        
45773>>>>>        
45773>>>>>        //AB-StoreEnd
45773>>>>>
45773>>>>>    End_Object    // Ptyppar_DD
45774>>>>>
45774>>>>>    Set Main_DD to (Ptyppar_DD(self))
45775>>>>>    Set Server to (Ptyppar_DD(self))
45776>>>>>
45776>>>>>    //AB-DDOEnd
45776>>>>>
45776>>>>>    Object oSelList is a dbListSub
45778>>>>>        Set Main_File to Ptyppar.File_Number
45779>>>>>        Set Size to 161 474
45780>>>>>        Set Location to 6 6
45781>>>>>
45781>>>>>        Begin_Row
45784>>>>>            Entry_Item Ptyppar.Ptyppar_code
45785>>>>>            Entry_Item Ptyppar.Ptyppar_descr
45786>>>>>            Entry_Item Ctypkin.Ctypkin_descr
45787>>>>>            Entry_Item Wtypkin.Wtypkin_descr
45788>>>>>        End_Row
45793>>>>>
45793>>>>>        Set Form_Width    item 0 to 77
45794>>>>>        Set Header_Label  item 0 to "‰à›. ˜¨˜©«˜« ¡¦ç"
45795>>>>>        
45795>>>>>        Set Form_Width    item 1 to 125
45796>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
45797>>>>>        
45797>>>>>        Set Form_Width    item 2 to 137
45798>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
45799>>>>>        
45799>>>>>        Set Form_Width    item 3 to 129
45800>>>>>        Set Header_Label  item 3 to "‰å¤ž©ž €§¦Ÿã¡žª"
45801>>>>>        
45801>>>>>
45801>>>>>        //AB-StoreStart
45801>>>>>        
45801>>>>>        Procedure Activate
45803>>>>>            Forward Send Activate
45805>>>>>            Send Rebuild_Constraints to Ptyppar_DD
45806>>>>>            Send Beginning_Of_Data to oSelList True
45807>>>>>        End_Procedure
45808>>>>>        
45808>>>>>        //AB-StoreEnd
45808>>>>>
45808>>>>>    End_Object    // oSelList
45809>>>>>
45809>>>>>    Object oOK_bn is a ButtonSub
45811>>>>>        Set Label to "&„§ ¢¦šã"
45812>>>>>        Set Location to 171 323
45813>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45814>>>>>
45814>>>>>        //AB-StoreStart
45814>>>>>        Procedure OnClick
45816>>>>>            Send OK To (oSelList(current_object))
45817>>>>>        End_Procedure
45818>>>>>        //AB-StoreEnd
45818>>>>>
45818>>>>>    End_Object    // oOK_bn
45819>>>>>
45819>>>>>    Object oCancel_bn is a ButtonSub
45821>>>>>        Set Label to "&€¡ç¨à©ž"
45822>>>>>        Set Location to 171 377
45823>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45824>>>>>
45824>>>>>        //AB-StoreStart
45824>>>>>        Procedure OnClick
45826>>>>>            Send Cancel To (oSelList(current_object))
45827>>>>>        End_Procedure
45828>>>>>        //AB-StoreEnd
45828>>>>>
45828>>>>>    End_Object    // oCancel_bn
45829>>>>>
45829>>>>>    Object oSearch_bn is a ButtonSub
45831>>>>>        Set Label to "€&¤˜ã«ž©ž"
45832>>>>>        Set Location to 171 433
45833>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45834>>>>>
45834>>>>>        //AB-StoreStart
45834>>>>>        Procedure OnClick
45836>>>>>            Send Search To (oSelList(current_object))
45837>>>>>        End_Procedure
45838>>>>>        //AB-StoreEnd
45838>>>>>
45838>>>>>    End_Object    // oSearch_bn
45839>>>>>
45839>>>>>
45839>>>>>    //AB-StoreStart
45839>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
45840>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
45841>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
45842>>>>>    
45842>>>>>    
45842>>>>>    //AB-StoreEnd
45842>>>>>
45842>>>>>End_Object    // sl012
45843>>>>>
45843>>>>>//AB/ End_Object    // prj
45843>>>use sl054.sl
INCLUDING FILE: SL054.SL
45843>>>>>//AB/ Project sl054:cars
45843>>>>>//AB/ Object prj is a Lookup_Project
45843>>>>>//AB/     Set ProjectName to "sl054:cars"
45843>>>>>//AB/     Set ProjectFileName to "sl054.SL"
45843>>>>>//AB/     Set GenerateFileName to "NONAME"
45843>>>>>
45843>>>>>// Project Object Structure
45843>>>>>//   sl054 is a dbModalPanelSub
45843>>>>>//     Cars_DD is a DataDictionary
45843>>>>>//     oSelList is a dbListSub
45843>>>>>//     oOK_bn is a ButtonSub
45843>>>>>//     oCancel_bn is a ButtonSub
45843>>>>>//     oSearch_bn is a ButtonSub
45843>>>>>
45843>>>>>// Register all objects
45843>>>>>Register_Object Cars_DD
45843>>>>>Register_Object oCancel_bn
45843>>>>>Register_Object oOK_bn
45843>>>>>Register_Object oSearch_bn
45843>>>>>Register_Object oSelList
45843>>>>>Register_Object sl054
45843>>>>>
45843>>>>>
45843>>>>>//AB-IgnoreStart
45843>>>>>
45843>>>>>Use DFAllEnt.pkg
45843>>>>>Use dbList.Sub
45843>>>>>Use Button.Sub
45843>>>>>
45843>>>>>
45843>>>>>Use Cars.DD
INCLUDING FILE: CARS.DD
45843>>>>>>>//DDB-FileStart
45843>>>>>>>//DDB-HeaderStart
45843>>>>>>>
45843>>>>>>>// File Name : CARS.DD
45843>>>>>>>// Class Name: Cars_DataDictionary
45843>>>>>>>// Revision  : 9
45843>>>>>>>// Version   : 2
45843>>>>>>>
45843>>>>>>>Use  Windows           // Basic Definitions
45843>>>>>>>Use  DataDict          // DataDictionary Class Definition
45843>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
45843>>>>>>>
45843>>>>>>>Open Cars
45845>>>>>>>
45845>>>>>>>//DDB-HeaderEnd
45845>>>>>>>//DDB-ValidationStart
45845>>>>>>>
45845>>>>>>>Register_Object Cars_Ctype_Id_VT
45845>>>>>>>
45845>>>>>>>Object Cars_Ctype_Id_VT  is a CodeValidationTable
45847>>>>>>>    Set Type_Value        To "PUMPSTYPE"
45848>>>>>>>    Set Validate_State    To FALSE
45849>>>>>>>    Set Allow_Blank_State To TRUE
45850>>>>>>>    //DDB-ValidationCustomStart
45850>>>>>>>    //DDB-ValidationCustomEnd
45850>>>>>>>End_Object   // Cars_Ctype_Id_VT
45851>>>>>>>//DDB-ValidationEnd
45851>>>>>>>//DDB-SelectionStart
45851>>>>>>>//DDB/ ExternalSelectionList sl054  sl054.SL
45851>>>>>>>Register_Object sl054
45851>>>>>>>//DDB-SelectionEnd
45851>>>>>>>
45851>>>>>>>Class Cars_DataDictionary  is a DataDictionary_Sec
45852>>>>>>>
45852>>>>>>>    // Update:
45852>>>>>>>
45852>>>>>>>    Procedure Update
45853>>>>>>>        Forward Send Update
45855>>>>>>>        move syscurxr.company_code  to cars.car_company
45856>>>>>>>        move syscurxr.beto_site     to cars.car_bsite
45857>>>>>>>        // Insert Code Here
45857>>>>>>>    End_Procedure   // Update
45858>>>>>>>
45858>>>>>>>
45858>>>>>>>    // Define_Fields:
45858>>>>>>>    // This procedure is used to set up all data-dictionary rules.
45858>>>>>>>
45858>>>>>>>    Procedure Define_Fields
45859>>>>>>>        Forward Send Define_Fields
45861>>>>>>>        //DDB-Generated-Code-Location
45861>>>>>>>        //DDB-DefineFieldStart
45861>>>>>>>
45861>>>>>>>        Set Main_File            To Cars.File_Number
45862>>>>>>>
45862>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
45863>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
45864>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
45865>>>>>>>
45865>>>>>>>        // Field-based properties.......................
45865>>>>>>>
45865>>>>>>>        // Cars.Car_Recnum
45865>>>>>>>
45865>>>>>>>        // Cars.Car_Company
45865>>>>>>>
45865>>>>>>>        // Cars.Car_Id
45865>>>>>>>        Set Field_Options          Field Cars.Car_Id To DD_AUTOFIND   
45866>>>>>>>        Set Field_Prompt_Object    Field Cars.Car_Id To (sl054(Self))
45867>>>>>>>        Set Key_Field_State        Field Cars.Car_Id To TRUE
45868>>>>>>>
45868>>>>>>>        // Cars.Car_Descr
45868>>>>>>>        Set Field_Prompt_Object    Field Cars.Car_Descr To (sl054(Self))
45869>>>>>>>
45869>>>>>>>        // Cars.Car_License
45869>>>>>>>
45869>>>>>>>        // Cars.Car_Driverrecn
45869>>>>>>>
45869>>>>>>>        // Cars.Car_Details
45869>>>>>>>
45869>>>>>>>        // Cars.Car_Maxm3
45869>>>>>>>
45869>>>>>>>        // Cars.Car_Sitew
45869>>>>>>>
45869>>>>>>>        // Cars.Car_Tare
45869>>>>>>>
45869>>>>>>>        // Cars.Car_Codematch
45869>>>>>>>
45869>>>>>>>        // Cars.Car_Driverid
45869>>>>>>>
45869>>>>>>>        // Cars.Car_Sn
45869>>>>>>>
45869>>>>>>>        // Cars.Car_Lastupdated
45869>>>>>>>
45869>>>>>>>        // Cars.Car_Markexp
45869>>>>>>>
45869>>>>>>>        // Cars.Car_748tare1
45869>>>>>>>
45869>>>>>>>        // Cars.Car_748tare2
45869>>>>>>>
45869>>>>>>>        // Cars.Car_748sign
45869>>>>>>>
45869>>>>>>>        // Cars.Car_Bsite
45869>>>>>>>
45869>>>>>>>        // Cars.Ctype_Id
45869>>>>>>>        Set Field_Class_Name       Field Cars.Ctype_Id To "dbComboFormsub"
45870>>>>>>>        Set Field_Value_Table      Field Cars.Ctype_Id To (Cars_Ctype_Id_VT(Self))
45871>>>>>>>
45871>>>>>>>        // Cars.Pagio
45871>>>>>>>
45871>>>>>>>        // Cars.Parakrat
45871>>>>>>>
45871>>>>>>>        // Cars.Car_What
45871>>>>>>>
45871>>>>>>>        // Cars.Car_Lc
45871>>>>>>>
45871>>>>>>>        // Cars.Car_Ln
45871>>>>>>>
45871>>>>>>>        //DDB-DefineFieldEnd
45871>>>>>>>    End_Procedure    // Define_Fields
45872>>>>>>>
45872>>>>>>>    // Field_Defaults:
45872>>>>>>>    // This procedure is used to establish default field values.
45872>>>>>>>
45872>>>>>>>    Procedure Field_Defaults
45873>>>>>>>        Forward Send Field_Defaults
45875>>>>>>>        //DDB-Generated-Code-Location
45875>>>>>>>        //DDB-FieldDefaultStart
45875>>>>>>>        //DDB-FieldDefaultEnd
45875>>>>>>>    End_Procedure    // Field_Defaults
45876>>>>>>>
45876>>>>>>>End_Class    // Cars_DataDictionary
45877>>>>>>>//DDB-Selection-pkg-Start
45877>>>>>>>
45877>>>>>>>Use sl054.SL         // sl054
45877>>>>>>>
45877>>>>>>>//DDB-Selection-pkg-End
45877>>>>>>>//DDB-FileEnd
45877>>>>>
45877>>>>>//AB-IgnoreEnd
45877>>>>>
45877>>>>>Object sl054 is a dbModalPanelSub
45879>>>>>    Set Label to "€¨®œå¦ Ž®ž£á«à¤"
45880>>>>>    Set Size to 148 420
45881>>>>>    Set Location to 4 5
45882>>>>>    Set Exit_Application_Local_State to FALSE
45883>>>>>    Set Modal_State to FALSE
45884>>>>>
45884>>>>>    //AB-DDOStart
45884>>>>>
45884>>>>>    Object Cars_DD is a Cars_DataDictionary
45886>>>>>    End_Object    // Cars_DD
45887>>>>>
45887>>>>>    Set Main_DD to (Cars_DD(self))
45888>>>>>    Set Server to (Cars_DD(self))
45889>>>>>
45889>>>>>    //AB-DDOEnd
45889>>>>>
45889>>>>>    Object oSelList is a dbListSub
45891>>>>>        Set Main_File to Cars.File_Number
45892>>>>>        Set Size to 105 403
45893>>>>>        Set Location to 6 6
45894>>>>>
45894>>>>>        Begin_Row
45897>>>>>            Entry_Item Cars.Car_id
45898>>>>>            Entry_Item Cars.Car_descr
45899>>>>>            Entry_Item Cars.Car_license
45900>>>>>            Entry_Item Cars.Car_maxm3
45901>>>>>            Entry_Item Cars.Car_driverid
45902>>>>>        End_Row
45907>>>>>
45907>>>>>        Set Form_Width    item 0 to 80
45908>>>>>        Set Header_Label  item 0 to "‰à›.Ž®ã£˜«¦ª"
45909>>>>>        
45909>>>>>        Set Form_Width    item 1 to 120
45910>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
45911>>>>>        
45911>>>>>        Set Form_Width    item 2 to 80
45912>>>>>        Set Header_Label  item 2 to "€¨ Ÿ.‰¬¡¢¦­¦¨å˜ª"
45913>>>>>        
45913>>>>>        Set Form_Width    item 3 to 50
45914>>>>>        Set Header_Label  item 3 to "Max.m3"
45915>>>>>        
45915>>>>>        Set Form_Width    item 4 to 65
45916>>>>>        Set Header_Label  item 4 to "‰à›.Ž›žš¦ç"
45917>>>>>        
45917>>>>>    End_Object    // oSelList
45918>>>>>
45918>>>>>    Object oOK_bn is a ButtonSub
45920>>>>>        Set Label to "&„§ ¢¦šã"
45921>>>>>        Set Location to 114 249
45922>>>>>
45922>>>>>        //AB-StoreStart
45922>>>>>        Procedure OnClick
45924>>>>>            Send OK To (oSelList(current_object))
45925>>>>>        End_Procedure
45926>>>>>        //AB-StoreEnd
45926>>>>>
45926>>>>>    End_Object    // oOK_bn
45927>>>>>
45927>>>>>    Object oCancel_bn is a ButtonSub
45929>>>>>        Set Label to "&€¡ç¨à©ž"
45930>>>>>        Set Location to 114 305
45931>>>>>
45931>>>>>        //AB-StoreStart
45931>>>>>        Procedure OnClick
45933>>>>>            Send Cancel To (oSelList(current_object))
45934>>>>>        End_Procedure
45935>>>>>        //AB-StoreEnd
45935>>>>>
45935>>>>>    End_Object    // oCancel_bn
45936>>>>>
45936>>>>>    Object oSearch_bn is a ButtonSub
45938>>>>>        Set Label to "€&¤˜ã«ž©ž..."
45939>>>>>        Set Location to 114 359
45940>>>>>
45940>>>>>        //AB-StoreStart
45940>>>>>        Procedure OnClick
45942>>>>>            Send Search To (oSelList(current_object))
45943>>>>>        End_Procedure
45944>>>>>        //AB-StoreEnd
45944>>>>>
45944>>>>>    End_Object    // oSearch_bn
45945>>>>>
45945>>>>>
45945>>>>>    //AB-StoreStart
45945>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
45946>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
45947>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
45948>>>>>    //AB-StoreEnd
45948>>>>>
45948>>>>>End_Object    // sl054
45949>>>>>
45949>>>>>//AB/ End_Object    // prj
45949>>>open sysfile
45951>>>use slrep.sl
45951>>>open sysrep
45953>>>open codemast
45955>>>//AB-StoreTopEnd
45955>>>
45955>>>//AB-IgnoreStart
45955>>>
45955>>>Use Rptvw.Sub
45955>>>Use DFAllEnt.pkg
45955>>>Use Group.Sub
45955>>>Use Form.Sub
45955>>>Use Txtbox.Sub
45955>>>Use Cmbfrm.Sub
45955>>>Use Button.Sub
45955>>>Use Line.Sub
45955>>>Use dbList.Sub
45955>>>
45955>>>Use COMPANY.DD
45955>>>Use BRANCH.DD
45955>>>
45955>>>//AB-IgnoreEnd
45955>>>
45955>>>DEFERRED_VIEW Activate_r54_1 FOR ;;Object r54_1 is a ReportViewSub
45974>>>
45974>>>    //AB-StoreTopStart
45974>>>    property string psbranch public ''
45976>>>    property string psrep    public ''
45978>>>    //AB-StoreTopEnd
45978>>>
45978>>>    Set Label to "‰ ¤ã©œ ª Ž®ž£á«à¤"
45979>>>    Set Size to 270 288
45980>>>    Set Location to 2 7
45981>>>
45981>>>    //AB-DDOStart
45981>>>
45981>>>    Object Company_DD is a Company_DataDictionary
45983>>>    End_Object    // Company_DD
45984>>>
45984>>>    Object Branch_DD is a Branch_DataDictionary
45986>>>        Set DDO_Server to (Company_DD(self))
45987>>>    End_Object    // Branch_DD
45988>>>
45988>>>
45988>>>    //AB-DDOEnd
45988>>>
45988>>>    Object GroupSub5 is a GroupSub
45990>>>        Set Label to "„§ ¢¦šã ˜¨˜©«˜« ¡¦ç - Ž®ž£á«à¤"
45991>>>        Set Size to 72 283
45992>>>        Set Location to 1 1
45993>>>        Object parast_apo is a FormSub
45995>>>            Set Size to 13 58
45996>>>            Set Location to 21 63
45997>>>            Set Label_Col_Offset to 2
45998>>>            Set Prompt_Button_Mode to pb_PromptOn
45999>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
46000>>>
46000>>>            //AB-StoreStart
46000>>>            set prompt_object to (sl012(self))
46001>>>            Procedure Prompt
46003>>>                String sVal
46004>>>                Set Modal_State Of (sl012(Current_object)) to True
46005>>>                Set psModule Of (sl012(Current_object)) to '01'
46006>>>                Forward Send Prompt
46008>>>            End_procedure
46009>>>            
46009>>>            procedure onchange
46011>>>                string spar sdescr
46012>>>                get value item 0 to spar
46013>>>                move (fsptyppar(self,spar)) to sdescr
46014>>>                set value of (parast_descr(groupsub5(self))) to sdescr
46015>>>            end_procedure
46016>>>            
46016>>>            
46016>>>            
46016>>>            
46016>>>            
46016>>>            
46016>>>            
46016>>>            
46016>>>            
46016>>>            
46016>>>            
46016>>>            
46016>>>            
46016>>>            
46016>>>            
46016>>>            
46016>>>            
46016>>>            
46016>>>            
46016>>>            //AB-StoreEnd
46016>>>
46016>>>        End_Object    // parast_apo
46017>>>
46017>>>        Object TextBoxSub29 is a TextBoxSub
46019>>>            Set Label to "˜¨˜©«˜« ¡æ      :"
46020>>>            Set Location to 21 4
46021>>>            Set Size to 10 48
46022>>>            Set TypeFace to "MS Sans Serif"
46023>>>        End_Object    // TextBoxSub29
46024>>>
46024>>>        Object parast_descr is a FormSub
46026>>>            Set Size to 13 149
46027>>>            Set Location to 21 121
46028>>>            Set Color to clBtnFace
46029>>>            Set Label_Col_Offset to 2
46030>>>            Set Enabled_State to FALSE
46031>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
46032>>>            Set Item_Shadow_State Item 0 to TRUE
46033>>>            Set Shadow_State Item 0 to TRUE
46034>>>        End_Object    // parast_descr
46035>>>
46035>>>        Object TextBoxSub31 is a TextBoxSub
46037>>>            Set Label to "€§æ Ž®ž£˜"
46038>>>            Set Auto_Size_State to FALSE
46039>>>            Set FontSize to 4 0
46040>>>            Set Location to 38 4
46041>>>            Set Size to 10 44
46042>>>            Set TypeFace to "MS Sans Serif"
46043>>>            Set Enabled_State to TRUE
46044>>>        End_Object    // TextBoxSub31
46045>>>
46045>>>        Object car_apo is a FormSub
46047>>>
46047>>>            //AB-StoreTopStart
46047>>>                                                                                                                                                                                                                                            
46047>>>            //AB-StoreTopEnd
46047>>>
46047>>>            Set Size to 13 58
46048>>>            Set Location to 38 63
46049>>>            Set Label_Col_Offset to 2
46050>>>            Set Label_Justification_Mode to jMode_Right
46051>>>            Set Prompt_Button_Mode to pb_PromptOn
46052>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
46053>>>
46053>>>            //AB-StoreStart
46053>>>                                                                                                                                                                                                                                            
46053>>>            Set Prompt_Object to (SL054(Current_object))
46054>>>            Procedure Prompt_Callback integer hPrompt
46056>>>                set Export_Column of hPrompt to 0
46057>>>                Set Initial_Column of hPrompt to 0
46058>>>            end_procedure
46059>>>            
46059>>>            procedure onchange
46061>>>                string witem sdescr
46062>>>                get value item 0 to witem
46063>>>                clear cars
46064>>>                move witem to cars.car_id
46065>>>                find eq cars by index.2
46066>>>>
46066>>>                set value of (apo_descr(self)) to cars.car_descr
46067>>>            end_procedure
46068>>>            
46068>>>            
46068>>>            
46068>>>            
46068>>>            
46068>>>            
46068>>>            
46068>>>            
46068>>>            
46068>>>            
46068>>>            
46068>>>            //AB-StoreEnd
46068>>>
46068>>>        End_Object    // car_apo
46069>>>
46069>>>        Object apo_descr is a FormSub
46071>>>            Set Size to 13 149
46072>>>            Set Location to 38 121
46073>>>            Set Color to clBtnFace
46074>>>            Set Label_Col_Offset to 2
46075>>>            Set Enabled_State to FALSE
46076>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
46077>>>            Set Item_Shadow_State Item 0 to TRUE
46078>>>            Set Shadow_State Item 0 to TRUE
46079>>>        End_Object    // apo_descr
46080>>>
46080>>>        Object TextBoxSub32 is a TextBoxSub
46082>>>            Set Label to "„éª Ž®ž£˜"
46083>>>            Set Auto_Size_State to FALSE
46084>>>            Set FontSize to 4 0
46085>>>            Set Location to 54 4
46086>>>            Set Size to 10 44
46087>>>            Set TypeFace to "MS Sans Serif"
46088>>>            Set Enabled_State to TRUE
46089>>>        End_Object    // TextBoxSub32
46090>>>
46090>>>        Object car_eos is a FormSub
46092>>>
46092>>>            //AB-StoreTopStart
46092>>>                                                                                                                                                                                                                                            
46092>>>            //AB-StoreTopEnd
46092>>>
46092>>>            Set Size to 13 58
46093>>>            Set Location to 53 63
46094>>>            Set Label_Col_Offset to 2
46095>>>            Set Label_Justification_Mode to jMode_Right
46096>>>            Set Prompt_Button_Mode to pb_PromptOn
46097>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
46098>>>
46098>>>            //AB-StoreStart
46098>>>            Set Prompt_Object to (SL054(Current_object))
46099>>>            Procedure Prompt_Callback integer hPrompt
46101>>>                set Export_Column of hPrompt to 0
46102>>>                Set Initial_Column of hPrompt to 0
46103>>>            end_procedure
46104>>>            
46104>>>            procedure onchange
46106>>>                string witem sdescr
46107>>>                get value item 0 to witem
46108>>>                clear cars
46109>>>                move witem to cars.car_id
46110>>>                find eq cars by index.2
46111>>>>
46111>>>                set value of (eos_descr(self)) to cars.car_descr
46112>>>            end_procedure
46113>>>            
46113>>>            
46113>>>            
46113>>>            
46113>>>            
46113>>>            
46113>>>            
46113>>>            
46113>>>            
46113>>>            
46113>>>            
46113>>>            
46113>>>            //AB-StoreEnd
46113>>>
46113>>>        End_Object    // car_eos
46114>>>
46114>>>        Object eos_descr is a FormSub
46116>>>            Set Size to 13 149
46117>>>            Set Location to 53 121
46118>>>            Set Color to clBtnFace
46119>>>            Set Label_Col_Offset to 2
46120>>>            Set Enabled_State to FALSE
46121>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
46122>>>            Set Item_Shadow_State Item 0 to TRUE
46123>>>            Set Shadow_State Item 0 to TRUE
46124>>>        End_Object    // eos_descr
46125>>>
46125>>>
46125>>>        //AB-StoreStart
46125>>>        Function StartNumber Returns string
46127>>>            Function_return (Value(car_apo(Current_object), 0))
46128>>>        End_function
46129>>>        
46129>>>        Function EndNumber Returns string
46131>>>            Function_return (Value(car_eos(Current_object), 0))
46132>>>        End_function
46133>>>        
46133>>>        Function Startapo Returns string
46135>>>            Function_return (Value(parast_apo(Current_object), 0))
46136>>>        End_function
46137>>>        
46137>>>        
46137>>>        
46137>>>        
46137>>>        
46137>>>        
46137>>>        
46137>>>        
46137>>>        
46137>>>        
46137>>>        
46137>>>        
46137>>>        //AB-StoreEnd
46137>>>
46137>>>    End_Object    // GroupSub5
46138>>>
46138>>>    Object GroupSub4 is a GroupSub
46140>>>        Set Label to "„§ ¢¦šã †£œ¨/¤å˜ª ‰ ¤ã©œà¤"
46141>>>        Set Size to 40 139
46142>>>        Set Location to 79 0
46143>>>        Object F_HME_APO is a FormSub
46145>>>            Set Size to 13 72
46146>>>            Set Location to 8 60
46147>>>            Set Label_Col_Offset to 2
46148>>>            Set Label_Justification_Mode to jMode_Right
46149>>>            Set Form_Datatype Item 0 to Mask_Date_Window
46150>>>            Set Prompt_Button_Mode to pb_PromptOn
46151>>>            Set Form_Mask Item 0 to "d/M/yyyy"
46152>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
46153>>>
46153>>>            //AB-StoreStart
46153>>>            set prompt_object to (ocalendar(self))
46154>>>            
46154>>>            
46154>>>            
46154>>>            
46154>>>            
46154>>>            //AB-StoreEnd
46154>>>
46154>>>        End_Object    // F_HME_APO
46155>>>
46155>>>        Object F_HME_EOS is a FormSub
46157>>>            Set Size to 13 72
46158>>>            Set Location to 24 60
46159>>>            Set Label_Col_Offset to 2
46160>>>            Set Label_Justification_Mode to jMode_Right
46161>>>            Set Form_Datatype Item 0 to Mask_Date_Window
46162>>>            Set Prompt_Button_Mode to pb_PromptOn
46163>>>            Set Form_Mask Item 0 to "d/M/yyyy"
46164>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
46165>>>
46165>>>            //AB-StoreStart
46165>>>            set prompt_object to (ocalendar(self))
46166>>>            
46166>>>            
46166>>>            
46166>>>            
46166>>>            
46166>>>            //AB-StoreEnd
46166>>>
46166>>>        End_Object    // F_HME_EOS
46167>>>
46167>>>        Object Textbox3 is a Textbox
46169>>>            Set Label to "€§æ †£/¤å˜ :"
46170>>>            Set Location to 53 5
46171>>>            Set Size to 10 47
46172>>>            Set TypeFace to "MS Sans Serif"
46173>>>        End_Object    // Textbox3
46174>>>
46174>>>        Object Textbox4 is a Textbox
46176>>>            Set Label to "„àª †£¤å˜  :"
46177>>>            Set Location to 24 5
46178>>>            Set Size to 12 45
46179>>>            Set TypeFace to "MS Sans Serif"
46180>>>        End_Object    // Textbox4
46181>>>
46181>>>
46181>>>        //AB-StoreStart
46181>>>        Function Starthme Returns string
46183>>>            Function_return (Value(f_hme_apo(Current_object), 0))
46184>>>        End_function
46185>>>        
46185>>>        Function Endhme Returns string
46187>>>            Function_return (Value(f_hme_eos(Current_object), 0))
46188>>>        End_function
46189>>>        
46189>>>        
46189>>>        
46189>>>        
46189>>>        
46189>>>        
46189>>>        
46189>>>        
46189>>>        
46189>>>        
46189>>>        
46189>>>        
46189>>>        //AB-StoreEnd
46189>>>
46189>>>    End_Object    // GroupSub4
46190>>>
46190>>>    Object ComboF is a ComboFormSub
46192>>>        Set Size to 14 59
46193>>>        Set Location to 121 73
46194>>>        Set Label_Col_Offset to 2
46195>>>
46195>>>        //AB-StoreStart
46195>>>        Procedure Combo_Fill_List
46197>>>            Send Combo_Add_Item ''
46198>>>            Clear codemast
46199>>>            move 'PUMPSTYPE' to codemast.type
46200>>>            Find Gt codemast by index.1
46201>>>>
46201>>>            While ((Found) and (codemast.type='PUMPSTYPE'))
46205>>>                Send Combo_Add_Item (trim(CODEMAST.code)+' - '+Trim(codemast.description))
46206>>>                Find Gt codemast by index.1
46207>>>>
46207>>>            Loop
46208>>>>
46208>>>        End_Procedure
46209>>>        
46209>>>        
46209>>>        //AB-StoreEnd
46209>>>
46209>>>    End_Object    // ComboF
46210>>>
46210>>>    Object Ffortio is a FormSub
46212>>>        Set Size to 13 59
46213>>>        Set Location to 137 73
46214>>>        Set Label_Col_Offset to 2
46215>>>        Set Form_Datatype Item 0 to Mask_Numeric_Window
46216>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
46217>>>
46217>>>        //AB-StoreStart
46217>>>        Set Numeric_Mask  Item 0 to 14 1 '*, '
46218>>>        //AB-StoreEnd
46218>>>
46218>>>    End_Object    // Ffortio
46219>>>
46219>>>    Object DestRadio is a RadioGroup
46221>>>
46221>>>        //AB-StoreTopStart
46221>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
46221>>>        //AB-StoreTopEnd
46221>>>
46221>>>        Set Label to "„¡«ç&§à©ž"
46222>>>        Set Size to 60 49
46223>>>        Set Location to 163 1
46224>>>        Object WindowRadio is a Radio
46226>>>            Set Size to 13 30
46227>>>            Set Location to 12 12
46228>>>            Set Bitmap to "screen4.bmp"
46229>>>        End_Object    // WindowRadio
46230>>>
46230>>>        Object PrinterRadio is a Radio
46232>>>            Set Size to 10 31
46233>>>            Set Location to 30 12
46234>>>            Set Bitmap to "PRINT_M1.BMP"
46235>>>        End_Object    // PrinterRadio
46236>>>
46236>>>        Object FileRadio is a Radio
46238>>>            Set Size to 10 29
46239>>>            Set Location to 47 12
46240>>>            Set Bitmap to "FILE16.BMP"
46241>>>        End_Object    // FileRadio
46242>>>
46242>>>
46242>>>        //AB-StoreStart
46242>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
46242>>>        //***
46242>>>        //*** Procedure: Notify_Select_state
46242>>>        //*** Purpose  : Augemented to setup the output destination of the WinQL
46242>>>        //***            report. The procedure is sent when the user changes the
46242>>>        //***            selection.
46242>>>        //***
46242>>>        
46242>>>        Procedure Notify_Select_State  Integer iNewItem  Integer iOldItem
46244>>>            Forward Send Notify_Select_State  iNewItem  iOldItem
46246>>>            If iNewItem Eq 0 ;                Set Output_Device_Mode To WQL_PRINT_TO_WINDOW
46249>>>            Else If iNewItem Eq 1;                Set Output_Device_Mode To WQL_PRINT_TO_PRINTER
46253>>>            Else If iNewItem Eq 2 ;                Set Output_Device_Mode To WQL_PRINT_TO_FILE
46257>>>        
46257>>>        
46257>>>            Send AdjustFileTypeShadow (iNewItem < 2)
46258>>>        End_Procedure
46259>>>        
46259>>>        
46259>>>        //AB-StoreEnd
46259>>>
46259>>>    End_Object    // DestRadio
46260>>>
46260>>>    Object FileTypeGroup is a Group
46262>>>
46262>>>        //AB-StoreTopStart
46262>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
46262>>>        //AB-StoreTopEnd
46262>>>
46262>>>        Set Label to "€¤˜­¦¨á €¨®œå¦¬"
46263>>>        Set Size to 61 169
46264>>>        Set Location to 163 52
46265>>>        Object FileNameForm is a Form
46267>>>
46267>>>            //AB-StoreTopStart
46267>>>                                                                                                                                                                                                                                            
46267>>>            //AB-StoreTopEnd
46267>>>
46267>>>            Set Size to 13 133
46268>>>            Set Location to 10 33
46269>>>            Set Label_Col_Offset to 2
46270>>>            Set Label_Justification_Mode to jMode_Right
46271>>>            Set Prompt_Button_Mode to pb_PromptOn
46272>>>
46272>>>            //AB-StoreStart
46272>>>            //*** Default item value
46272>>>            Set Value item 0 to "cars.doc"
46273>>>            
46273>>>            Procedure Prompt
46275>>>                Local String  SelectedFile
46276>>>                Local String  Extension
46276>>>                Local String  Filter
46276>>>                Local Integer Type
46276>>>                Local Integer Selected
46276>>>            
46276>>>                //*** Setup initial file name
46276>>>                Get Value Item 0 To SelectedFile
46277>>>                If SelectedFile Eq "" Begin
46279>>>                    Get WQLFileExt To Extension
46280>>>                    Move ("cars" + Extension) To SelectedFile
46281>>>                End
46281>>>>
46281>>>            
46281>>>                //*** Create a filter for the save as dialog
46281>>>                Move "" To Filter
46282>>>                Get WQLFileTYpe To Type
46283>>>                If Type Eq WQL_WordWinType ;                    Append Filter "Word for Windows (*.doc)|*.doc"
46286>>>                If ((Type Eq WQL_Xls2Type) Or (Type Eq WQL_Xls3Type) Or (Type Eq WQL_Xls4Type) Or (Type Eq WQL_Xls5Type)) ;                    Append Filter "Excel (*.xls)|*.xls"
46289>>>                If Type Eq WQL_RichTextFormatType ;                    Append Filter "Rich Text (*.rtf)|*.rtf"
46292>>>                If Type Eq WQL_TextType ;                    Append Filter "Text (*.txt)|*.txt"
46295>>>                If Type Eq WQL_RecordType ;                    Append Filter "Record Style (*.rec)|*.rec"
46298>>>                If Type Eq WQL_CommaSeparatedType ;                    Append Filter "Comma Separated Values (*.csv)|*.csv"
46301>>>                If Type Eq WQL_DIFType ;                    Append Filter "Data Interchange Format (*.dif)|*.dif"
46304>>>                Append Filter "|All Files|*.*"
46305>>>            
46305>>>                //*** Create a save as dialog
46305>>>                Object New_dialog Is A SaveAsdialog
46307>>>                    //*** Setup title
46307>>>                    Set Dialog_Caption        To "Item report export to disk, give file name"
46308>>>                    Set Filter_String         To Filter
46309>>>                    Set Hidereadonly_State    To True
46310>>>                    Set Overwriteprompt_State To True
46311>>>                    Set Showfiletitle_State   To True
46312>>>                    Set File_Title            To SelectedFile
46313>>>                End_object // New_dialog
46314>>>            
46314>>>                //*** Start the save as dialog
46314>>>                Get Show_Dialog Of (New_dialog(Current_object)) To Selected
46315>>>                If Selected Begin
46317>>>                    Get File_Name Of (New_Dialog(Current_object)) To SelectedFile
46318>>>                    Set Value Item 0 To SelectedFile
46319>>>                End
46319>>>>
46319>>>            
46319>>>                //*** Destroy the save as dialog
46319>>>                Send Request_Destroy_object To (New_dialog(Current_object))
46320>>>            End_procedure // Start_Prompt
46321>>>            
46321>>>            //***
46321>>>            //*** Function: FileName
46321>>>            //*** Purpose : Returns the name of the file to export to
46321>>>            //***
46321>>>            
46321>>>            Function FileName Returns String
46323>>>                Local String  SelectedFile
46324>>>            
46324>>>                //*** Get file name
46324>>>                Get Value Item 0 To SelectedFile
46325>>>                If SelectedFile Eq "" ;                    Move "cars.doc" To SelectedFile
46328>>>            
46328>>>                Function_return SelectedFile
46329>>>            End_function // FileName
46330>>>            
46330>>>            
46330>>>            
46330>>>            
46330>>>            
46330>>>            
46330>>>            
46330>>>            
46330>>>            
46330>>>            
46330>>>            
46330>>>            
46330>>>            
46330>>>            //AB-StoreEnd
46330>>>
46330>>>        End_Object    // FileNameForm
46331>>>
46331>>>        Object TypeCombo is a ComboForm
46333>>>
46333>>>            //AB-StoreTopStart
46333>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
46333>>>            //AB-StoreTopEnd
46333>>>
46333>>>            Set Size to 13 133
46334>>>            Set Location to 29 33
46335>>>            Set Label_Col_Offset to 2
46336>>>            Set Label_Justification_Mode to jMode_Right
46337>>>
46337>>>            //AB-StoreStart
46337>>>            //*** Make sure the user picks a list item and cannot enter information
46337>>>            Set Entry_state Item 0 To False
46338>>>            
46338>>>            //*** Show list unsorted. This must be done because we raly on the order of the
46338>>>            //*** list to determine the type of the file. (See FileType function)
46338>>>            Set Combo_Sort_State To False
46339>>>            
46339>>>            //***
46339>>>            //*** Procedure: Combo_Fill_list
46339>>>            //*** Purpose  : Augemebnted to fill the list with export file types.
46339>>>            //***
46339>>>            
46339>>>            Procedure Combo_Fill_List
46341>>>                Send Combo_Add_item "Word for Windows"
46342>>>                Send Combo_Add_Item "Excel 2.1"
46343>>>                Send Combo_Add_Item "Excel 3.0"
46344>>>                Send Combo_Add_Item "Excel 4.0"
46345>>>                Send Combo_Add_Item "Excel 5.0"
46346>>>                Send Combo_Add_Item "Rich Text"
46347>>>                Send Combo_Add_Item "Text"
46348>>>                Send Combo_Add_Item "Record Style"
46349>>>                Send Combo_Add_Item "Comma Separated"
46350>>>                Send Combo_Add_Item "Data Interchage Format (DIF)"
46351>>>            End_procedure // Combo_Fill_List
46352>>>            
46352>>>            
46352>>>            //***
46352>>>            //*** Function: FileType
46352>>>            //*** Purpose : Type to export to
46352>>>            //***
46352>>>            
46352>>>            Function FileType Returns Integer
46354>>>                Local String  FileTypeName
46355>>>                Local Integer FileTypeValue
46355>>>                Local Integer SelectedItem
46355>>>            
46355>>>                Get Value Item 0 To FileTypeName
46356>>>                Get Combo_Item_Matching FileTypeName To SelectedItem
46357>>>                Move WQL_TextType To FileTypeValue
46358>>>                If SelectedItem Ne -1 Begin
46360>>>                    If SelectedItem Eq 0 Move WQL_WordWinType        To FileTypeValue
46363>>>                    If SelectedItem Eq 1 Move WQL_Xls2Type           To FileTypeValue
46366>>>                    If SelectedItem Eq 2 Move WQL_Xls3Type           To FileTypeValue
46369>>>                    If SelectedItem Eq 3 Move WQL_Xls4Type           To FileTypeValue
46372>>>                    If SelectedItem Eq 4 Move WQL_Xls5Type           To FileTypeValue
46375>>>                    If SelectedItem Eq 5 Move WQL_RichTextFormatType To FileTypeValue
46378>>>                    If SelectedItem Eq 6 Move WQL_TextType           To FileTypeValue
46381>>>                    If SelectedItem Eq 7 Move WQL_RecordType         To FileTypeValue
46384>>>                    If SelectedItem Eq 8 Move WQL_CommaSeparatedType To FileTypeValue
46387>>>                    If SelectedItem Eq 9 Move WQL_DIFType            To FileTypeValue
46390>>>                End
46390>>>>
46390>>>            
46390>>>                Function_return FileTypeValue
46391>>>            End_function // FileType
46392>>>            
46392>>>            
46392>>>            //***
46392>>>            //*** Function: FileExt
46392>>>            //*** Purpose : Extension for the type to export to
46392>>>            //***
46392>>>            
46392>>>            Function FileExt Returns String
46394>>>                Local String  FileTypeExt
46395>>>                Local Integer FileTypeValue
46395>>>            
46395>>>                Get FileType To FileTypeValue
46396>>>                If FileTypeValue Eq WQL_WordWinType        Move ".doc" To FileTypeExt
46399>>>                If FileTypeValue Eq WQL_Xls2Type           Move ".xls" To FileTypeExt
46402>>>                If FileTypeValue Eq WQL_Xls3Type           Move ".xls" To FileTypeExt
46405>>>                If FileTypeValue Eq WQL_Xls4Type           Move ".xls" To FileTypeExt
46408>>>                If FileTypeValue Eq WQL_Xls5Type           Move ".xls" To FileTypeExt
46411>>>                If FileTypeValue Eq WQL_RichTextFormatType Move ".rtf" To FileTypeExt
46414>>>                If FileTypeValue Eq WQL_TextType           Move ".txt" To FileTypeExt
46417>>>                If FileTypeValue Eq WQL_RecordType         Move ".rec" To FileTypeExt
46420>>>                If FileTypeValue Eq WQL_CommaSeparatedType Move ".csv" To FileTypeExt
46423>>>                If FileTypeValue Eq WQL_DIFType            Move ".dif" To FileTypeExt
46426>>>            
46426>>>                Function_return FileTypeExt
46427>>>            End_function // FileExt
46428>>>            
46428>>>            
46428>>>            
46428>>>            //***
46428>>>            //*** Procedure: OnCloseUp
46428>>>            //*** Purpose  : Augemented to auto,matically change the extension of the
46428>>>            //***            filename
46428>>>            //***
46428>>>            
46428>>>            Procedure OnChange
46430>>>                Local String  OldName
46431>>>                Local String  Extension
46431>>>                Local Integer ChangeExt
46431>>>            
46431>>>                Get ChangeExtension To ChangeExt
46432>>>                If ChangeExt Begin
46434>>>                    Get WQLFileName To OldName
46435>>>                    Get FileExt To Extension
46436>>>                    Set WQLFileName To (Left(OldName, (Pos(".", Oldname) - 1)) + Extension)
46437>>>                End
46437>>>>
46437>>>            End_procedure // OnChange
46438>>>            
46438>>>            //AB-StoreEnd
46438>>>
46438>>>        End_Object    // TypeCombo
46439>>>
46439>>>        Object ApplyExtCheckBox is a CheckBox
46441>>>
46441>>>            //AB-StoreTopStart
46441>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
46441>>>            //AB-StoreTopEnd
46441>>>
46441>>>            Set Label to "Apply combo extension"
46442>>>            Set Size to 10 89
46443>>>            Set Location to 47 33
46444>>>
46444>>>            //AB-StoreStart
46444>>>            //*** Apply extensions by default
46444>>>            Set Select_state Item 0 To True
46445>>>            //AB-StoreEnd
46445>>>
46445>>>        End_Object    // ApplyExtCheckBox
46446>>>
46446>>>        Object TextBoxSub23 is a TextBoxSub
46448>>>            Set Label to "Ž¤¦£˜"
46449>>>            Set FontSize to 4 0
46450>>>            Set Location to 10 6
46451>>>            Set Size to 10 25
46452>>>            Set TypeFace to "MS Sans Serif"
46453>>>            Set Enabled_State to TRUE
46454>>>        End_Object    // TextBoxSub23
46455>>>
46455>>>        Object TextBoxSub24 is a TextBoxSub
46457>>>            Set Label to "’ç§¦ª"
46458>>>            Set FontSize to 4 0
46459>>>            Set Location to 30 5
46460>>>            Set Size to 10 23
46461>>>            Set TypeFace to "MS Sans Serif"
46462>>>            Set Enabled_State to TRUE
46463>>>        End_Object    // TextBoxSub24
46464>>>
46464>>>
46464>>>        //AB-StoreStart
46464>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
46464>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
46464>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
46464>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
46464>>>        Function WQLFileName Returns String
46466>>>            Function_return (FileName(FileNameForm(Current_object)))
46467>>>        End_function // WQLFIleName
46468>>>        
46468>>>        Procedure Set WQLFileName String NewName
46470>>>            Set Value Of (FileNameForm(Current_object)) Item 0 To NewName
46471>>>        End_procedure // Set WQLFIleName
46472>>>        
46472>>>        
46472>>>        //***
46472>>>        //*** Function: WQLFIleType
46472>>>        //*** Purpose : The extension type of the file to export to
46472>>>        //***
46472>>>        
46472>>>        Function WQLFileType Returns Integer
46474>>>            Function_return (FileType(TypeCombo(Current_object)))
46475>>>        End_function // WQLFIleType
46476>>>        
46476>>>        
46476>>>        //***
46476>>>        //*** Function: WQLFIleExt
46476>>>        //*** Purpose : The extension type of the file to export to
46476>>>        //***
46476>>>        
46476>>>        Function WQLFileExt Returns Integer
46478>>>            Function_return (FileExt(TypeCombo(Current_object)))
46479>>>        End_function // WQLFIleExt
46480>>>        
46480>>>        
46480>>>        
46480>>>        //***
46480>>>        //*** Function: ChangeExtension
46480>>>        //*** Purpose : Must extension be dynamically updated?
46480>>>        //***
46480>>>        
46480>>>        Function ChangeExtension Returns Integer
46482>>>            Function_return (Select_state(ApplyExtCheckBox(Current_object), 0))
46483>>>        End_function // ChangeExtension
46484>>>        
46484>>>        
46484>>>        //AB-StoreEnd
46484>>>
46484>>>    End_Object    // FileTypeGroup
46485>>>
46485>>>    Object ButtonSub1 is a Button
46487>>>
46487>>>        //AB-StoreTopStart
46487>>>                                                                                                                                                                    
46487>>>        //AB-StoreTopEnd
46487>>>
46487>>>        Set Bitmap to "RUNPROG.BMP"
46488>>>        Set Size to 18 28
46489>>>        Set Location to 174 227
46490>>>
46490>>>        //AB-StoreStart
46490>>>        Procedure OnClick
46492>>>             Send RuncarsReport To (carsWQLReport(Current_Object))
46493>>>        End_Procedure
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        
46494>>>        //AB-StoreEnd
46494>>>
46494>>>    End_Object    // ButtonSub1
46495>>>
46495>>>    Object ButtonSub2 is a ButtonSub
46497>>>
46497>>>        //AB-StoreTopStart
46497>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
46497>>>        //AB-StoreTopEnd
46497>>>
46497>>>        Set Bitmap to "CANCEL.BMP"
46498>>>        Set Size to 18 28
46499>>>        Set Location to 200 226
46500>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
46501>>>
46501>>>        //AB-StoreStart
46501>>>        Procedure OnClick
46503>>>            Send Request_Cancel
46504>>>        End_Procedure
46505>>>        
46505>>>        
46505>>>        
46505>>>        
46505>>>        //AB-StoreEnd
46505>>>
46505>>>    End_Object    // ButtonSub2
46506>>>
46506>>>    Object LineControlSub1 is a LineControlSub
46508>>>        Set Line_Style to lnSINGLE
46509>>>        Set Size to 1 306
46510>>>        Set Location to 159 -2
46511>>>    End_Object    // LineControlSub1
46512>>>
46512>>>    Object Textbox6 is a Textbox
46514>>>        Set Label to "„§ ¢¦šã œ¡«ç§à©žª "
46515>>>        Set Location to 229 3
46516>>>        Set Size to 10 69
46517>>>        Set TypeFace to "MS Sans Serif"
46518>>>    End_Object    // Textbox6
46519>>>
46519>>>    Object Form1 is a Form
46521>>>        Set Size to 13 65
46522>>>        Set Location to 240 3
46523>>>        Set Prompt_Button_Mode to pb_PromptOn
46524>>>
46524>>>        //AB-StoreStart
46524>>>                                                                                                                        
46524>>>        Set Prompt_Object to (SLrep(Current_object))
46525>>>        procedure prompt
46527>>>            Set pskathg Of (slrep(Self)) to 'r54_1.rv'
46528>>>            Forward Send Prompt
46530>>>        end_procedure
46531>>>        
46531>>>        procedure onchange
46533>>>            string skathg
46534>>>            get value item 0 to skathg
46535>>>            clear sysrep
46536>>>            move 'r54_1.rv' to sysrep.view
46537>>>            move skathg to sysrep.name
46538>>>            find eq sysrep by index.1
46539>>>>
46539>>>            set value of (form2(self)) to sysrep.descr
46540>>>            set psrep to sysrep.name
46541>>>        end_procedure
46542>>>        
46542>>>        
46542>>>        
46542>>>        
46542>>>        
46542>>>        
46542>>>        
46542>>>        
46542>>>        
46542>>>        
46542>>>        //AB-StoreEnd
46542>>>
46542>>>    End_Object    // Form1
46543>>>
46543>>>    Object Form2 is a Form
46545>>>        Set Size to 13 213
46546>>>        Set Location to 240 71
46547>>>
46547>>>        //AB-StoreStart
46547>>>        set enabled_state to false
46548>>>        //AB-StoreEnd
46548>>>
46548>>>    End_Object    // Form2
46549>>>
46549>>>    Object dblstBranch is a dbListSub
46551>>>        Set Main_File to Branch.File_Number
46552>>>        Set Server to (Branch_DD(self))
46553>>>        Set Size to 71 127
46554>>>        Set Location to 79 149
46555>>>        Set Color to 15263976
46556>>>        Set CurrentCellColor to 14205112
46557>>>        Set Highlight_Row_State to FALSE
46558>>>        Set Auto_Index_State to FALSE
46559>>>        Set Auto_Column_State to FALSE
46560>>>        Set Move_Value_Out_State to FALSE
46561>>>        Set Auto_Export_State to FALSE
46562>>>        Set Auto_Shadow_State to FALSE
46563>>>        Set Find_Search_State to FALSE
46564>>>        Set Select_Mode to Multi_Select
46565>>>
46565>>>        Begin_Row
46568>>>            Entry_Item ('')
46569>>>            Entry_Item Branch.Branch_code
46570>>>            Entry_Item Branch.Branch_name
46571>>>        End_Row
46576>>>
46576>>>        Set Form_Width    item 0 to 15
46577>>>        Set Header_Label  item 0 to ""
46578>>>        
46578>>>        Set Form_Width    item 1 to 42
46579>>>        Set Header_Label  item 1 to "‰à› ¡æª"
46580>>>        
46580>>>        Set Form_Width    item 2 to 64
46581>>>        Set Header_Label  item 2 to "“§¦¡˜«á©«ž£˜"
46582>>>        
46582>>>
46582>>>        //AB-StoreStart
46582>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
46582>>>        Set Select_Mode                     to Multi_Select
46583>>>        Set Column_Option           item 0  to Noenter False
46584>>>        Set Column_checkBox_state   item 0  to true
46585>>>        Set Auto_Shadow_State               to False
46586>>>        Set Auto_Index_State                to False
46587>>>        Set Popup_Search_State              to True
46588>>>        Set Find_Search_State               to False
46589>>>        
46589>>>        Set Color                           to 15263976
46590>>>        Set TextColor                       to clWindowText
46591>>>        Set CurrentRowColor                 to 14205112
46592>>>        Set Highlight_row_color             to 14205112
46593>>>        Set CurrentRowTextColor             to clWindowText
46594>>>        Set CurrentCellColor                to 14205112
46595>>>        Set CurrentCellTextColor            to clBtnText
46596>>>        
46596>>>        
46596>>>        Procedure Toggle_Select
46598>>>            Local integer iBase iOffset iCol
46599>>>            Move 0 to iOffset
46600>>>            Get Base_Item to iBase
46601>>>            Get Current_Col to iCol
46602>>>            Forward Send Toggle_Select
46604>>>            Send DoDisplayCheckBox (iBase+iOffset) (Select_State(self,iBase))
46605>>>            Set Dynamic_Update_State to true
46606>>>            Set Dynamic_Update_State to true
46607>>>        End_Procedure  //Toggle_Select
46608>>>        
46608>>>        Procedure Entry_Display Integer i1 Integer i2
46610>>>            Local integer iBase iOffset iSelItemsID bState
46611>>>            Get base_Item to iBase
46612>>>            move 0 to iOffset
46613>>>            move (Selected_Items(self)) to iSelItemsID
46614>>>            Forward Send Entry_Display i1 i2
46616>>>            Get find_element of iSelItemsID branch.recnum to bState
46617>>>            Send DoDisplayCheckBox (iBase+iOffset) (bState<>-1)
46618>>>        End_Procedure // Entry_Display
46619>>>        
46619>>>        
46619>>>        
46619>>>        
46619>>>        
46619>>>        
46619>>>        
46619>>>        
46619>>>        
46619>>>        
46619>>>        
46619>>>        
46619>>>        
46619>>>        //AB-StoreEnd
46619>>>
46619>>>    End_Object    // dblstBranch
46620>>>
46620>>>    Object Textbox7 is a Textbox
46622>>>        Set Label to "€§æ †£/¤å˜ :"
46623>>>        Set Location to 10 6
46624>>>        Set Size to 10 47
46625>>>        Set TypeFace to "MS Sans Serif"
46626>>>    End_Object    // Textbox7
46627>>>
46627>>>    Object TextBoxSub33 is a TextBoxSub
46629>>>        Set Label to "’ç§¦ª Ž®ã£˜«¦ª"
46630>>>        Set Location to 123 3
46631>>>        Set Size to 10 58
46632>>>        Set TypeFace to "MS Sans Serif"
46633>>>    End_Object    // TextBoxSub33
46634>>>
46634>>>    Object TextBoxSub34 is a TextBoxSub
46636>>>        Set Label to "”¦¨«å¦ < ‰¬™ ¡é¤"
46637>>>        Set Location to 138 4
46638>>>        Set Size to 12 65
46639>>>        Set TypeFace to "MS Sans Serif"
46640>>>    End_Object    // TextBoxSub34
46641>>>
46641>>>
46641>>>    //AB-StoreStart
46641>>>    Procedure Activate_View Returns Integer
46643>>>        String sStr sModule StrDisp
46644>>>        Integer rVal iint icheck
46644>>>        string scompany six
46644>>>        set value of (f_hme_apo(groupsub4(current_object))) to syscurxr.year_xrhshfrom
46645>>>        set value of (f_hme_eos(groupsub4(current_object))) to syscurxr.year_xrhshto
46646>>>        Forward Get Msg_Activate_View to rVal
46648>>>        Send Delete_Data            to (Selected_Items(dblstBRANCH(self)))
46649>>>        Send Find to (branch_dd(self)) First_Record 1
46650>>>        Set Dynamic_Update_State of (dblstbranch(self)) to false
46651>>>        While (Found=1)
46655>>>            get field_current_value of branch_dd field branch.company_code to scompany
46656>>>            get field_current_value of branch_dd field branch.branch_apoth to icheck
46657>>>            if ((syscurxr.company_code=scompany) and (icheck=1));                Set Array_Value of (Selected_Items(dblstbranch(self))) Item iInt to branch.Recnum
46660>>>            Add 1 to iInt
46661>>>            Send Find to (branch_dd(self)) Next_Record 1
46662>>>        Loop
46663>>>>
46663>>>        Send Beginning_Of_Data    to (dblstbranch(self))
46664>>>        Set Dynamic_Update_State of (dblstbranch(self)) to true
46665>>>        Procedure_Return rVal
46666>>>    End_Procedure
46667>>>    
46667>>>    Object carsWQLReport Is A CrystalReportSubSQL
46669>>>        Property Integer ReportReady Public False
46671>>>        Set Report_View_id To (Parent(Current_object))
46672>>>    
46672>>>        Procedure OnStartPrinting
46674>>>            date datef datet apo eos
46675>>>            local string  startapon  sbranch setoima slabel six
46675>>>            Local integer Starthmen Endhmen iwhat ikat
46675>>>            Local String  Selection FileName Startnumbern EndNumbern stype
46675>>>            Local Integer FileType Destination SortOrder NumSortFields CurSortField
46675>>>            Local Integer SortDirection wdate sepil iepil
46675>>>            Integer iint icheck icount irec
46675>>>            string  stext scode sname srecr sbrecr
46675>>>            local number nqty
46675>>>            move sysfile.wapokat_etoima to setoima
46676>>>            Move "" To Selection
46677>>>            get value of ffortio item 0 to nqty
46678>>>            get value of combof  item 0 to six
46679>>>            left six to stype 1
46681>>>>
46681>>>            get startapo    to startapon
46682>>>            get startnumber to startnumbern
46683>>>            get endnumber   to endnumbern
46684>>>            get psbranch    to sbranch
46685>>>            Append Selection (If(Selection <> "", " and ", ""))"{pmoves.company_code} = " '"' (Trim(syscurxr.company_code)) '"'
46690>>>            Get Select_Count of (dblstbranch(Self)) to iInt
46691>>>            If (iInt>0) Begin
46693>>>                move '' to stext
46694>>>                For iCount from 0 to (iInt-1)
46700>>>>
46700>>>                    Get array_value of (Selected_Items(dblstbranch(self))) Item iCount to iRec
46701>>>                    Clear branch
46702>>>                    Move iRec to branch.Recnum
46703>>>                    Find Eq branch.Recnum
46704>>>>
46704>>>                    move branch.branch_code to scode
46705>>>                    move branch.branch_name to sname
46706>>>           //         move branch.branch_recr to sbrecr
46706>>>                    Move (Append(sbranch,(trim(sname)+' '))) to sbranch
46707>>>                    Move (Append(stext,(trim(scode)+' '))) to stext
46708>>>          //          Move (Append(srecr,(trim(sbrecr)+' '))) to srecr
46708>>>                Loop
46709>>>>
46709>>>            End
46709>>>>
46709>>>            Append Selection (If(Selection <> "", " and ", "")) "InStr('" stext "',{pmoves.branch_code})<>0"
46713>>>            Append Selection (If(Selection <> "", " and ", "")) "{pmoves.year_year} = " '' (syscurxr.year_year) ''
46718>>>        //    if (startapon ne '');
46718>>>            Append Selection (If(Selection <> "", " and ", ""))"{pmoves.ptyppar_code} = " '"' (Trim(startapon)) '"'
46723>>>            Append Selection (If(Selection <> "", " and ", ""))"{pmoves.wapokat_code} = " '"' (Trim(setoima)) '"'
46728>>>            if (startnumbern ne '');                Append Selection (If(Selection <> "", " and ", ""))"{cars.car_id} >= " '"' (Trim(startnumbern)) '"'
46735>>>    
46735>>>            If (endnumbern ne "") ;               Append Selection (If(Selection <> "", " and ", "")) "{cars.car_id} <= " '"' (trim(endnumbern)) '"'
46742>>>            if (trim(stype)<>'');               Append Selection (If(Selection <> "", " and ", ""))"{cars.ctype_id} = " '"' (Trim(stype)) '"'
46749>>>            get starthme to starthmen
46750>>>            Get Endhme   To Endhmen
46751>>>    
46751>>>            If (trim(starthmen)) ne 0 ;               Append Selection (If(Selection <> "", " and ", "")) "{pmoves.partl_hmnia} >= " (winql_date(starthmen))
46756>>>    
46756>>>            If (trim(Endhmen)) ne 0 ;               Append Selection (If(Selection <> "", " and ", "")) "{pmoves.partl_hmnia} <= " (winql_date(Endhmen))
46761>>>    
46761>>>         //   if (psrep(self)='r54_1.rpt');
46761>>>         //       Append Selection (If(Selection <> "", " and ", "")) "InStr('" srecr "',{brzones.branch_recr})<>0"
46761>>>    
46761>>>    
46761>>>            Set SelectionFormula To Selection
46762>>>    
46762>>>            If Selection Eq "" ;                Set Formula "SelTxt" To ('"' + "NONE" + '"')
46765>>>            Else ;                Set Formula "SelTxt" To ('"' + (Replaces('"', Selection, "")) + '"')
46767>>>            get starthme to apo
46768>>>            get endhme   to eos
46769>>>    
46769>>>            if (apo='') move syscurxr.year_xrhshfrom to apo
46772>>>            if (eos='') move syscurxr.year_xrhshto   to eos
46775>>>            Set Formula "fbranch" to (Winql_String(sbranch))
46776>>>            Set Formula "fapo" To (winql_date(apo))
46777>>>            Set Formula "feos" To (winql_date(eos))
46778>>>            get value of form2 to slabel
46779>>>            Set Formula "flabel" To  (winql_string(slabel))
46780>>>    
46780>>>            Get NSortFields To NumSortFields
46781>>>            For CurSortField From 0 To (NumSortFields - 1)
46787>>>>
46787>>>            Send DeleteNthSortField 0
46788>>>            Loop
46789>>>>
46789>>>            get descasc to sortdirection
46790>>>            IF (PSREP(SELF)<>'r54_20.rpt') begin
46792>>>                set GroupField PE_GROUPHEADER to "{cars.car_id}"
46793>>>                Set GroupSortDirection PE_GROUPHEADER to SortDirection
46794>>>            End
46794>>>>
46794>>>            else begin
46795>>>                Set Formula "fepilkib" To (winql_number(nqty))
46796>>>                Set Formula "fix" To (winql_string(six))
46797>>>            end
46797>>>>
46797>>>            Send AddSortField "{pmoves.partl_hmnia}" SortDirection
46798>>>            Send AddSortField "{pmoves.partl_no}" SortDirection
46799>>>    
46799>>>            Get Output_Destination To Destination
46800>>>            If ((Destination Eq WQL_PRINT_TO_FILE) Or (Destination Eq WQL_PRINT_TO_MAPI)) Begin
46802>>>                Get WQLFileName To FileName
46803>>>                Get WQLFileType To FileType
46804>>>    
46804>>>                Set ExportFileName   To FileName
46805>>>                Set ExportFormatType To FileType
46806>>>            End
46806>>>>
46806>>>            Else If Destination Eq WQL_PRINT_TO_PRINTER ;            Send SelectAndSetPrinter
46810>>>    
46810>>>            If Destination EQ WQL_PRINT_TO_WINDOW ;                Set ReportReady To False
46813>>>            Else ;                Set ReportReady To True
46815>>>        End_procedure // OnStartPrinting
46816>>>    
46816>>>    
46816>>>        Procedure RuncarsReport
46818>>>            Send Cursor_Wait To (Cursor_Control(Current_Object))
46819>>>            Set Report_name  To (psrep(self))
46820>>>            Send Run_report
46821>>>            Send Cursor_Ready To (Cursor_Control(Current_Object))
46822>>>            If (ReportReady(Current_object)) ;                Send Info_box "WinQL report ready."
46825>>>        End_procedure // RunCarsReport
46826>>>    
46826>>>    End_object
46827>>>    
46827>>>    Function Startapo Returns string
46829>>>        Function_return (startapo(groupsub5(Current_object)))
46830>>>    End_function
46831>>>    
46831>>>    Function StartNumber Returns string
46833>>>        Function_return (StartNumber(groupSub5(Current_object)))
46834>>>    End_function // StartNumber
46835>>>    
46835>>>    Function EndNumber Returns string
46837>>>            Function_return (EndNumber(groupSub5(Current_object)))
46838>>>    End_function // StartNumber
46839>>>    
46839>>>    Function Starthme Returns integer
46841>>>        Function_return (Starthme(groupSub4(Current_object)))
46842>>>    End_function // StartNumber
46843>>>    
46843>>>    Function Endhme Returns integer
46845>>>        Function_return (Endhme(groupSub4(Current_object)))
46846>>>    End_function // StartNumber
46847>>>    
46847>>>    Function DescAsc Returns Integer
46849>>>        Function_return 1
46850>>>    End_function // DescAsc
46851>>>    
46851>>>    Procedure AdjustFileTypeShadow Integer NewState
46853>>>        Set Object_Shadow_State Of (FileTypeGroup(Current_Object)) To NewState
46854>>>    End_procedure // AdjustFileTypeShadow
46855>>>    
46855>>>    Procedure AdjustBoundaryShadow Integer GroupNum
46857>>>        Set Object_Shadow_State Of (groupSub4(Current_object)) To (GroupNum <> 0)
46858>>>        Set Object_Shadow_State Of (groupSub4(Current_object))   To (GroupNum = 0)
46859>>>    End_procedure // AdjustBoundaryShadow
46860>>>    
46860>>>    Function WQLFileName Returns String
46862>>>        Function_return (WQLFileName(FileTypeGroup(Current_object)))
46863>>>    End_function // WQLFIleName
46864>>>    
46864>>>    
46864>>>    Function WQLFileType Returns Integer
46866>>>        Function_return (WQLFileType(FileTypeGroup(Current_object)))
46867>>>    End_function // WQLFIleType
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    
46868>>>    //AB-StoreEnd
46868>>>
46868>>>CD_End_Object    // r54_1
46870>>>>
46870>>>
46870>>>
46870>>>//AB-StoreStart
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>        
46870>>>//AB-StoreEnd
46870>>>
46870>>>//AB/ End_Object    // prj
46870>        Use R6_1hm.RV                                                                       
INCLUDING FILE: R6_1HM.RV
46870>>>//AB/ Project r6_1hm: karteles pelaton hmgio
46870>>>//AB/     Object prj is a Report_Project
46870>>>//AB/         Set ProjectName to "r6_1hm: karteles pelaton hmgio"
46870>>>//AB/         Set ProjectFileName to "R6_1hm.RV"
46870>>>
46870>>>// Project Object Structure
46870>>>//   r6_1hm is a ReportViewSub
46870>>>//     Company_DD is a DataDictionary
46870>>>//     Branch_DD is a DataDictionary
46870>>>//     GroupSub1 is a GroupSub
46870>>>//       F_CODE_APO is a FormSub
46870>>>//       F_CODE_EOS is a FormSub
46870>>>//       TextBoxSub1 is a TextBoxSub
46870>>>//       TextBoxSub2 is a TextBoxSub
46870>>>//       FormSub3 is a FormSub
46870>>>//       FormSub4 is a FormSub
46870>>>//     GroupSub4 is a GroupSub
46870>>>//       F_HME_APO is a FormSub
46870>>>//       F_HME_EOS is a FormSub
46870>>>//       Textbox3 is a Textbox
46870>>>//       Textbox4 is a Textbox
46870>>>//       axiastatus is a CheckBoxSub
46870>>>//       e_status is a CheckBoxSub
46870>>>//     GroupSub5 is a GroupSub
46870>>>//       TextBoxSub25 is a TextBoxSub
46870>>>//       FormSub1 is a FormSub
46870>>>//       FormSub6 is a FormSub
46870>>>//     dblstBranch is a dbListSub
46870>>>//     DestRadio is a RadioGroup
46870>>>//       WindowRadio is a Radio
46870>>>//       PrinterRadio is a Radio
46870>>>//       FileRadio is a Radio
46870>>>//     dbRadioGroupSub1 is a dbRadioGroupSub
46870>>>//       Radio1 is a RadioSub
46870>>>//       Radio2 is a RadioSub
46870>>>//       Radio3 is a RadioSub
46870>>>//     FileTypeGroup is a Group
46870>>>//       FileNameForm is a Form
46870>>>//         New_dialog is a SaveAsdialog
46870>>>//       TypeCombo is a ComboForm
46870>>>//       ApplyExtCheckBox is a CheckBox
46870>>>//       TextBoxSub23 is a TextBoxSub
46870>>>//       TextBoxSub24 is a TextBoxSub
46870>>>//     ButtonSub1 is a Button
46870>>>//     ButtonSub2 is a ButtonSub
46870>>>//     Textbox7 is a Textbox
46870>>>//     Form3 is a Form
46870>>>//     Form4 is a Form
46870>>>//     cmovesWQLReport is a CrystalReportSubSQL
46870>>>
46870>>>// Register all objects
46870>>>Register_Object ApplyExtCheckBox
46870>>>Register_Object axiastatus
46870>>>Register_Object Branch_DD
46870>>>Register_Object ButtonSub1
46870>>>Register_Object ButtonSub2
46870>>>Register_Object Company_DD
46870>>>Register_Object cmovesWQLReport
46870>>>Register_Object DestRadio
46870>>>Register_Object dblstBranch
46870>>>Register_Object dbRadioGroupSub1
46870>>>Register_Object e_status
46870>>>Register_Object F_CODE_APO
46870>>>Register_Object F_CODE_EOS
46870>>>Register_Object F_HME_APO
46870>>>Register_Object F_HME_EOS
46870>>>Register_Object FileNameForm
46870>>>Register_Object FileRadio
46870>>>Register_Object FileTypeGroup
46870>>>Register_Object Form3
46870>>>Register_Object Form4
46870>>>Register_Object FormSub1
46870>>>Register_Object FormSub3
46870>>>Register_Object FormSub4
46870>>>Register_Object FormSub6
46870>>>Register_Object GroupSub1
46870>>>Register_Object GroupSub4
46870>>>Register_Object GroupSub5
46870>>>Register_Object New_dialog
46870>>>Register_Object PrinterRadio
46870>>>Register_Object Radio1
46870>>>Register_Object Radio2
46870>>>Register_Object Radio3
46870>>>Register_Object r6_1hm
46870>>>Register_Object TextBoxSub1
46870>>>Register_Object TextBoxSub2
46870>>>Register_Object TextBoxSub23
46870>>>Register_Object TextBoxSub24
46870>>>Register_Object TextBoxSub25
46870>>>Register_Object Textbox3
46870>>>Register_Object Textbox4
46870>>>Register_Object Textbox7
46870>>>Register_Object TypeCombo
46870>>>Register_Object WindowRadio
46870>>>
46870>>>
46870>>>//AB/     Report View
46870>>>
46870>>>
46870>>>    //AB-StoreTopStart
46870>>>    Use dfallrpt
46870>>>    open hmctyp
46872>>>    OPEN syscurxr
46874>>>    Use sl100.sl
46874>>>    use hmgio.sl
46874>>>    use slrep.sl
46874>>>    open sysrep
46876>>>    open nomisma
46878>>>    //AB-StoreTopEnd
46878>>>
46878>>>    //AB-IgnoreStart
46878>>>
46878>>>    Use Rptvw.Sub
46878>>>    Use DFAllEnt.pkg
46878>>>    Use Group.Sub
46878>>>    Use Form.Sub
46878>>>    Use Txtbox.Sub
46878>>>    Use Chkbox.Sub
46878>>>    Use dbList.Sub
46878>>>    Use dbRgroup.Sub
46878>>>    Use Radio.Sub
46878>>>    Use Button.Sub
46878>>>
46878>>>    Use COMPANY.DD
46878>>>    Use BRANCH.DD
46878>>>    
46878>>>    //AB-IgnoreEnd
46878>>>
46878>>>    ACTIVATE_VIEW Activate_r6_1hm FOR r6_1hm
46882>>>
46882>>>    Object r6_1hm is a ReportViewSub
46884>>>
46884>>>        //AB-StoreTopStart
46884>>>        property integer    epil public 0
46886>>>        Property String     psModule  ""
46888>>>        property string     psbranch public ''
46890>>>        property integer    piwhat public 0
46892>>>        property integer    pipol public 0
46894>>>        property string     psrep public ''
46896>>>        //AB-StoreTopEnd
46896>>>
46896>>>        Set Label to "„¡«ç§à©ž ‰ ¤ã©œà¤ œ¢˜«é¤"
46897>>>        Set Size to 290 293
46898>>>        Set Location to 6 13
46899>>>
46899>>>        //AB-DDOStart
46899>>>
46899>>>        Object Company_DD is a Company_DataDictionary
46901>>>        End_Object    // Company_DD
46902>>>
46902>>>        Object Branch_DD is a Branch_DataDictionary
46904>>>            Set DDO_Server to (Company_DD(self))
46905>>>        End_Object    // Branch_DD
46906>>>
46906>>>
46906>>>        //AB-DDOEnd
46906>>>
46906>>>        Object GroupSub1 is a GroupSub
46908>>>            Set Label to "„§ ¢¦šã ”¦¨âà¤"
46909>>>            Set Size to 42 283
46910>>>            Set Location to 1 1
46911>>>            Object F_CODE_APO is a FormSub
46913>>>
46913>>>                //AB-StoreTopStart
46913>>>                                
46913>>>                //AB-StoreTopEnd
46913>>>
46913>>>                Set Size to 13 61
46914>>>                Set Location to 10 60
46915>>>                Set Label_Col_Offset to 2
46916>>>                Set Label_Justification_Mode to jMode_Right
46917>>>                Set Prompt_Button_Mode to pb_PromptOn
46918>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
46919>>>
46919>>>                //AB-StoreStart
46919>>>                                
46919>>>                Set Prompt_Object to (SL100(Current_object))
46920>>>                Procedure Prompt_Callback integer hPrompt
46922>>>                    set Export_Column of hPrompt to 0
46923>>>                    Set Initial_Column of hPrompt to 0
46924>>>                end_procedure
46925>>>                
46925>>>                procedure onkillfocus
46927>>>                    string sclient
46928>>>                    get value item 0 to sclient
46929>>>                    Move (fsclient(Self,sclient)) to sclient
46930>>>                    set value of (formsub3(self)) to sclient
46931>>>                end_procedure
46932>>>                
46932>>>                procedure prompt
46934>>>                    Set psModule Of (sl100(Self)) to (psModule(Self))
46935>>>                    Forward Send Prompt
46937>>>                end_procedure
46938>>>                
46938>>>                
46938>>>                
46938>>>                
46938>>>                
46938>>>                
46938>>>                
46938>>>                //AB-StoreEnd
46938>>>
46938>>>            End_Object    // F_CODE_APO
46939>>>
46939>>>            Object F_CODE_EOS is a FormSub
46941>>>
46941>>>                //AB-StoreTopStart
46941>>>                                
46941>>>                //AB-StoreTopEnd
46941>>>
46941>>>                Set Size to 13 61
46942>>>                Set Location to 26 60
46943>>>                Set Label_Col_Offset to 2
46944>>>                Set Label_Justification_Mode to jMode_Right
46945>>>                Set Prompt_Button_Mode to pb_PromptOn
46946>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
46947>>>
46947>>>                //AB-StoreStart
46947>>>                                
46947>>>                Set Prompt_Object to (SL100(Current_object))
46948>>>                Procedure Prompt_Callback integer hPrompt
46950>>>                    set Export_Column of hPrompt to 0
46951>>>                    Set Initial_Column of hPrompt to 0
46952>>>                end_procedure
46953>>>                
46953>>>                procedure onkillfocus
46955>>>                    string sclient
46956>>>                    get value item 0 to sclient
46957>>>                    Move (fsclient(Self,sclient)) to sclient
46958>>>                    set value of (formsub4(self)) to sclient
46959>>>                end_procedure
46960>>>                
46960>>>                procedure prompt
46962>>>                    Set psModule Of (sl100(Self)) to (psModule(Self))
46963>>>                    Forward Send Prompt
46965>>>                end_procedure
46966>>>                
46966>>>                
46966>>>                
46966>>>                
46966>>>                
46966>>>                
46966>>>                
46966>>>                
46966>>>                
46966>>>                
46966>>>                
46966>>>                
46966>>>                
46966>>>                
46966>>>                
46966>>>                
46966>>>                
46966>>>                
46966>>>                
46966>>>                
46966>>>                
46966>>>                
46966>>>                
46966>>>                
46966>>>                
46966>>>                
46966>>>                //AB-StoreEnd
46966>>>
46966>>>            End_Object    // F_CODE_EOS
46967>>>
46967>>>            Object TextBoxSub1 is a TextBoxSub
46969>>>                Set Label to "€§æ ‰à› ¡æ :"
46970>>>                Set Auto_Size_State to FALSE
46971>>>                Set FontSize to 4 0
46972>>>                Set Location to 11 5
46973>>>                Set Size to 10 44
46974>>>                Set TypeFace to "MS Sans Serif"
46975>>>                Set Enabled_State to TRUE
46976>>>            End_Object    // TextBoxSub1
46977>>>
46977>>>            Object TextBoxSub2 is a TextBoxSub
46979>>>                Set Label to "„àª ‰à› ¡æ :"
46980>>>                Set Auto_Size_State to FALSE
46981>>>                Set FontSize to 4 0
46982>>>                Set Location to 26 5
46983>>>                Set Size to 13 47
46984>>>                Set TypeFace to "MS Sans Serif"
46985>>>                Set Enabled_State to TRUE
46986>>>            End_Object    // TextBoxSub2
46987>>>
46987>>>            Object FormSub3 is a FormSub
46989>>>                Set Size to 13 155
46990>>>                Set Location to 10 124
46991>>>                Set Label_Col_Offset to 2
46992>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
46993>>>
46993>>>                //AB-StoreStart
46993>>>                set enabled_state to false
46994>>>                //AB-StoreEnd
46994>>>
46994>>>            End_Object    // FormSub3
46995>>>
46995>>>            Object FormSub4 is a FormSub
46997>>>                Set Size to 13 155
46998>>>                Set Location to 26 124
46999>>>                Set Label_Col_Offset to 2
47000>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
47001>>>
47001>>>                //AB-StoreStart
47001>>>                set enabled_state to false
47002>>>                //AB-StoreEnd
47002>>>
47002>>>            End_Object    // FormSub4
47003>>>
47003>>>
47003>>>            //AB-StoreStart
47003>>>            Function StartNumber Returns string
47005>>>                Function_return (Value(f_code_apo(Current_object), 0))
47006>>>            End_function
47007>>>            
47007>>>            Function EndNumber Returns string
47009>>>                Function_return (Value(f_code_eos(Current_object), 0))
47010>>>            End_function
47011>>>            
47011>>>            
47011>>>            
47011>>>            
47011>>>            
47011>>>            //AB-StoreEnd
47011>>>
47011>>>        End_Object    // GroupSub1
47012>>>
47012>>>        Object GroupSub4 is a GroupSub
47014>>>            Set Label to "„§ ¢¦šã †£œ¨/¤å˜ª ‰ ¤ã©œà¤"
47015>>>            Set Size to 40 283
47016>>>            Set Location to 43 1
47017>>>            Object F_HME_APO is a FormSub
47019>>>                Set Size to 13 69
47020>>>                Set Location to 8 60
47021>>>                Set Label_Col_Offset to 2
47022>>>                Set Label_Justification_Mode to jMode_Right
47023>>>                Set Form_Datatype Item 0 to Mask_Date_Window
47024>>>                Set Prompt_Button_Mode to pb_PromptOn
47025>>>                Set Form_Mask Item 0 to "d/M/yyyy"
47026>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
47027>>>
47027>>>                //AB-StoreStart
47027>>>                set prompt_object to (ocalendar(self))
47028>>>                
47028>>>                
47028>>>                
47028>>>                
47028>>>                
47028>>>                //AB-StoreEnd
47028>>>
47028>>>            End_Object    // F_HME_APO
47029>>>
47029>>>            Object F_HME_EOS is a FormSub
47031>>>                Set Size to 13 69
47032>>>                Set Location to 24 60
47033>>>                Set Label_Col_Offset to 2
47034>>>                Set Label_Justification_Mode to jMode_Right
47035>>>                Set Form_Datatype Item 0 to Mask_Date_Window
47036>>>                Set Prompt_Button_Mode to pb_PromptOn
47037>>>                Set Form_Mask Item 0 to "d/M/yyyy"
47038>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
47039>>>
47039>>>                //AB-StoreStart
47039>>>                set prompt_object to (ocalendar(self))
47040>>>                
47040>>>                
47040>>>                
47040>>>                
47040>>>                
47040>>>                //AB-StoreEnd
47040>>>
47040>>>            End_Object    // F_HME_EOS
47041>>>
47041>>>            Object Textbox3 is a Textbox
47043>>>                Set Label to "€§æ †£/¤å˜ :"
47044>>>                Set Location to 10 6
47045>>>                Set Size to 10 47
47046>>>                Set TypeFace to "MS Sans Serif"
47047>>>            End_Object    // Textbox3
47048>>>
47048>>>            Object Textbox4 is a Textbox
47050>>>                Set Label to "„àª †£¤å˜  :"
47051>>>                Set Location to 24 5
47052>>>                Set Size to 12 45
47053>>>                Set TypeFace to "MS Sans Serif"
47054>>>            End_Object    // Textbox4
47055>>>
47055>>>            Object axiastatus is a CheckBoxSub
47057>>>                Set Label to "‹æ¤¦ €¥åœª"
47058>>>                Set Size to 10 55
47059>>>                Set Location to 10 157
47060>>>                Set Checked_State to TRUE
47061>>>
47061>>>                //AB-StoreStart
47061>>>                                                                                                                                                                                                                                
47061>>>                //AB-StoreEnd
47061>>>
47061>>>            End_Object    // axiastatus
47062>>>
47062>>>            Object e_status is a CheckBoxSub
47064>>>                Set Label to "€¤á¢¬©ž ˜¨˜©«˜« ¡¦ç"
47065>>>                Set Size to 10 96
47066>>>                Set Location to 26 157
47067>>>            End_Object    // e_status
47068>>>
47068>>>
47068>>>            //AB-StoreStart
47068>>>            Function Starthme Returns string
47070>>>                Function_return (Value(f_hme_apo(Current_object), 0))
47071>>>            End_function
47072>>>            
47072>>>            Function Endhme Returns string
47074>>>                Function_return (Value(f_hme_eos(Current_object), 0))
47075>>>            End_function
47076>>>            
47076>>>            
47076>>>            Function analstat Returns integer
47078>>>                Function_return (Select_state(e_status(Current_object), 0))
47079>>>            End_function
47080>>>            
47080>>>            Function axiastat Returns integer
47082>>>                Function_return (Select_state(axiastatus(Current_object), 0))
47083>>>            End_function
47084>>>            
47084>>>            
47084>>>            
47084>>>            
47084>>>            
47084>>>            
47084>>>            
47084>>>            //AB-StoreEnd
47084>>>
47084>>>        End_Object    // GroupSub4
47085>>>
47085>>>        Object GroupSub5 is a GroupSub
47087>>>            Set Label to "„§ ¢¦šã †£œ¨¦¢¦šå¦¬"
47088>>>            Set Size to 29 281
47089>>>            Set Location to 85 1
47090>>>            Object TextBoxSub25 is a TextBoxSub
47092>>>                Set Label to "†£œ¨¦¢æš ¦"
47093>>>                Set Location to 14 5
47094>>>                Set Size to 10 44
47095>>>                Set TypeFace to "MS Sans Serif"
47096>>>            End_Object    // TextBoxSub25
47097>>>
47097>>>            Object FormSub1 is a FormSub
47099>>>                Set Size to 13 49
47100>>>                Set Location to 12 60
47101>>>                Set Label_Col_Offset to 2
47102>>>                Set Prompt_Button_Mode to pb_PromptOn
47103>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
47104>>>
47104>>>                //AB-StoreStart
47104>>>                Set Prompt_Object to (hmgio(Current_object))
47105>>>                Set Numeric_Mask Item 0 to 2 0 '*, '
47106>>>                Procedure Prompt_Callback integer hPrompt
47108>>>                    set Export_Column of hPrompt to 0
47109>>>                    Set Initial_Column of hPrompt to 0
47110>>>                end_procedure
47111>>>                
47111>>>                procedure onchange
47113>>>                    string whmgio
47114>>>                    get value item 0 to whmgio
47115>>>                    move whmgio to hmgio.hmgio_code
47116>>>                    find eq hmgio by index.1
47117>>>>
47117>>>                    if (found);                        set value of (formsub6(self)) to hmgio.hmgio_descr
47120>>>                    else;                        set value of (formsub6(self)) to ''
47122>>>                end_procedure
47123>>>                
47123>>>                
47123>>>                procedure prompt
47125>>>                    set psmodule of (hmgio(self)) to (psmodule(self))
47126>>>                    forward send prompt
47128>>>                end_procedure
47129>>>                
47129>>>                
47129>>>                //AB-StoreEnd
47129>>>
47129>>>            End_Object    // FormSub1
47130>>>
47130>>>            Object FormSub6 is a FormSub
47132>>>                Set Size to 13 165
47133>>>                Set Location to 12 111
47134>>>                Set Label_Col_Offset to 2
47135>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
47136>>>
47136>>>                //AB-StoreStart
47136>>>                set enabled_state to false
47137>>>                //AB-StoreEnd
47137>>>
47137>>>            End_Object    // FormSub6
47138>>>
47138>>>
47138>>>            //AB-StoreStart
47138>>>            Function Starttypkin Returns String
47140>>>                Function_return (Value(formsub1(Current_object), 0))
47141>>>            End_function
47142>>>            
47142>>>            
47142>>>            
47142>>>            
47142>>>            //AB-StoreEnd
47142>>>
47142>>>        End_Object    // GroupSub5
47143>>>
47143>>>        Object dblstBranch is a dbListSub
47145>>>            Set Main_File to Branch.File_Number
47146>>>            Set Server to (Branch_DD(self))
47147>>>            Set Size to 71 199
47148>>>            Set Location to 116 84
47149>>>            Set Color to 15263976
47150>>>            Set CurrentCellColor to 14205112
47151>>>            Set Highlight_Row_State to FALSE
47152>>>            Set Auto_Index_State to FALSE
47153>>>            Set Auto_Column_State to FALSE
47154>>>            Set Move_Value_Out_State to FALSE
47155>>>            Set Auto_Export_State to FALSE
47156>>>            Set Auto_Shadow_State to FALSE
47157>>>            Set Find_Search_State to FALSE
47158>>>            Set Select_Mode to Multi_Select
47159>>>
47159>>>            Begin_Row
47162>>>                Entry_Item ('')
47163>>>                Entry_Item Branch.Branch_code
47164>>>                Entry_Item Branch.Branch_name
47165>>>            End_Row
47170>>>
47170>>>            Set Form_Width    item 0 to 15
47171>>>            Set Header_Label  item 0 to ""
47172>>>            
47172>>>            Set Form_Width    item 1 to 42
47173>>>            Set Header_Label  item 1 to "‰à› ¡æª"
47174>>>            
47174>>>            Set Form_Width    item 2 to 135
47175>>>            Set Header_Label  item 2 to "“§¦¡˜«á©«ž£˜"
47176>>>            
47176>>>
47176>>>            //AB-StoreStart
47176>>>                                                                                                                                                    
47176>>>            Set Select_Mode                     to Multi_Select
47177>>>            Set Column_Option           item 0  to Noenter False
47178>>>            Set Column_checkBox_state   item 0  to true
47179>>>            Set Auto_Shadow_State               to False
47180>>>            Set Auto_Index_State                to False
47181>>>            Set Popup_Search_State              to True
47182>>>            Set Find_Search_State               to False
47183>>>            
47183>>>            Set Color                           to 15263976
47184>>>            Set TextColor                       to clWindowText
47185>>>            Set CurrentRowColor                 to 14205112
47186>>>            Set Highlight_row_color             to 14205112
47187>>>            Set CurrentRowTextColor             to clWindowText
47188>>>            Set CurrentCellColor                to 14205112
47189>>>            Set CurrentCellTextColor            to clBtnText
47190>>>            
47190>>>            
47190>>>            Procedure Toggle_Select
47192>>>                Local integer iBase iOffset iCol
47193>>>                Move 0 to iOffset
47194>>>                Get Base_Item to iBase
47195>>>                Get Current_Col to iCol
47196>>>                Forward Send Toggle_Select
47198>>>                Send DoDisplayCheckBox (iBase+iOffset) (Select_State(self,iBase))
47199>>>                Set Dynamic_Update_State to true
47200>>>                Set Dynamic_Update_State to true
47201>>>            End_Procedure  //Toggle_Select
47202>>>            
47202>>>            Procedure Entry_Display Integer i1 Integer i2
47204>>>                Local integer iBase iOffset iSelItemsID bState
47205>>>                Get base_Item to iBase
47206>>>                move 0 to iOffset
47207>>>                move (Selected_Items(self)) to iSelItemsID
47208>>>                Forward Send Entry_Display i1 i2
47210>>>                Get find_element of iSelItemsID branch.recnum to bState
47211>>>                Send DoDisplayCheckBox (iBase+iOffset) (bState<>-1)
47212>>>            End_Procedure // Entry_Display
47213>>>            
47213>>>            
47213>>>            
47213>>>            
47213>>>            
47213>>>            
47213>>>            
47213>>>            
47213>>>            
47213>>>            
47213>>>            
47213>>>            
47213>>>            
47213>>>            //AB-StoreEnd
47213>>>
47213>>>        End_Object    // dblstBranch
47214>>>
47214>>>        Object DestRadio is a RadioGroup
47216>>>
47216>>>            //AB-StoreTopStart
47216>>>                                                                                                                                
47216>>>            //AB-StoreTopEnd
47216>>>
47216>>>            Set Label to "„¡«ç&§à©ž"
47217>>>            Set Size to 60 49
47218>>>            Set Location to 188 3
47219>>>            Object WindowRadio is a Radio
47221>>>                Set Size to 13 30
47222>>>                Set Location to 12 12
47223>>>                Set Bitmap to "screen4.bmp"
47224>>>            End_Object    // WindowRadio
47225>>>
47225>>>            Object PrinterRadio is a Radio
47227>>>                Set Size to 10 31
47228>>>                Set Location to 30 12
47229>>>                Set Bitmap to "PRINT_M1.BMP"
47230>>>            End_Object    // PrinterRadio
47231>>>
47231>>>            Object FileRadio is a Radio
47233>>>                Set Size to 10 29
47234>>>                Set Location to 47 12
47235>>>                Set Bitmap to "FILE16.BMP"
47236>>>            End_Object    // FileRadio
47237>>>
47237>>>
47237>>>            //AB-StoreStart
47237>>>                                                                                                                                
47237>>>            Procedure Notify_Select_State  Integer iNewItem  Integer iOldItem
47239>>>                Forward Send Notify_Select_State  iNewItem  iOldItem
47241>>>                If iNewItem Eq 0 ;                    Set Output_Device_Mode To WQL_PRINT_TO_WINDOW
47244>>>                Else If iNewItem Eq 1;                    Set Output_Device_Mode To WQL_PRINT_TO_PRINTER
47248>>>                Else If iNewItem Eq 2 ;                    Set Output_Device_Mode To WQL_PRINT_TO_FILE
47252>>>                Send AdjustFileTypeShadow (iNewItem < 2)
47253>>>            End_Procedure
47254>>>            
47254>>>            //AB-StoreEnd
47254>>>
47254>>>        End_Object    // DestRadio
47255>>>
47255>>>        Object dbRadioGroupSub1 is a dbRadioGroupSub
47257>>>            Set Size to 50 61
47258>>>            Set Location to 125 10
47259>>>            Object Radio1 is a RadioSub
47261>>>                Set Label to "Œæ£ ©£˜ 1"
47262>>>                Set Size to 10 46
47263>>>                Set Location to 10 5
47264>>>
47264>>>                //AB-StoreStart
47264>>>                set label to syscurxr.c_code0
47265>>>                //AB-StoreEnd
47265>>>
47265>>>            End_Object    // Radio1
47266>>>
47266>>>            Object Radio2 is a RadioSub
47268>>>                Set Label to "Œæ£ ©£˜ 2"
47269>>>                Set Size to 10 46
47270>>>                Set Location to 23 5
47271>>>
47271>>>                //AB-StoreStart
47271>>>                set label to syscurxr.c_code00
47272>>>                //AB-StoreEnd
47272>>>
47272>>>            End_Object    // Radio2
47273>>>
47273>>>            Object Radio3 is a RadioSub
47275>>>                Set Label to "Œæ£ ©£˜ 3"
47276>>>                Set Size to 10 46
47277>>>                Set Location to 36 5
47278>>>
47278>>>                //AB-StoreStart
47278>>>                set label to syscurxr.c_coder
47279>>>                //AB-StoreEnd
47279>>>
47279>>>            End_Object    // Radio3
47280>>>
47280>>>
47280>>>            //AB-StoreStart
47280>>>            Procedure Notify_Select_State  Integer iNewItem  Integer iOldItem
47282>>>                string snom1 snom2 snom3
47283>>>                Clear Nomisma
47284>>>                move syscurxr.c_code0 to nomisma.nomisma_code
47285>>>                Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
47286>>>>
47286>>>                move nomisma.dekadika to snom1
47287>>>                Clear Nomisma
47288>>>                move syscurxr.c_code00 to nomisma.nomisma_code
47289>>>                Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
47290>>>>
47290>>>                move nomisma.dekadika to snom2
47291>>>                clear nomisma
47292>>>                move syscurxr.c_coder to nomisma.nomisma_code
47293>>>                Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
47294>>>>
47294>>>                move nomisma.dekadika to snom3
47295>>>                Forward Send Notify_Select_State  iNewItem  iOldItem
47297>>>                If iNewItem Eq 0;                    Set epil to snom1
47300>>>                Else If iNewItem Eq 1;                    Set epil to snom2
47304>>>                Else If iNewItem Eq 2 ;                    Set epil to snom3
47308>>>                If iNewItem Eq 0;                    Set piwhat to 1
47311>>>                Else If iNewItem Eq 1;                    Set piwhat to 2
47315>>>                Else If iNewItem Eq 2 ;                    Set piwhat to 3
47319>>>            
47319>>>            End_Procedure
47320>>>            
47320>>>            //AB-StoreEnd
47320>>>
47320>>>        End_Object    // dbRadioGroupSub1
47321>>>
47321>>>        Object FileTypeGroup is a Group
47323>>>
47323>>>            //AB-StoreTopStart
47323>>>                                                                                                                                
47323>>>            //AB-StoreTopEnd
47323>>>
47323>>>            Set Label to "€¤˜­¦¨á €¨®œå¦¬"
47324>>>            Set Size to 60 169
47325>>>            Set Location to 189 53
47326>>>            Object FileNameForm is a Form
47328>>>
47328>>>                //AB-StoreTopStart
47328>>>                                                                                                                                                                                                                                
47328>>>                //AB-StoreTopEnd
47328>>>
47328>>>                Set Size to 13 133
47329>>>                Set Location to 10 33
47330>>>                Set Label_Col_Offset to 2
47331>>>                Set Label_Justification_Mode to jMode_Right
47332>>>                Set Prompt_Button_Mode to pb_PromptOn
47333>>>
47333>>>                //AB-StoreStart
47333>>>                //*** Default item value
47333>>>                Set Value item 0 to "cmoves.doc"
47334>>>                
47334>>>                Procedure Prompt
47336>>>                    Local String  SelectedFile
47337>>>                    Local String  Extension
47337>>>                    Local String  Filter
47337>>>                    Local Integer Type
47337>>>                    Local Integer Selected
47337>>>                
47337>>>                    //*** Setup initial file name
47337>>>                    Get Value Item 0 To SelectedFile
47338>>>                    If SelectedFile Eq "" Begin
47340>>>                        Get WQLFileExt To Extension
47341>>>                        Move ("cmoves" + Extension) To SelectedFile
47342>>>                    End
47342>>>>
47342>>>                
47342>>>                    //*** Create a filter for the save as dialog
47342>>>                    Move "" To Filter
47343>>>                    Get WQLFileTYpe To Type
47344>>>                    If Type Eq WQL_WordWinType ;                        Append Filter "Word for Windows (*.doc)|*.doc"
47347>>>                    If ((Type Eq WQL_Xls2Type) Or (Type Eq WQL_Xls3Type) Or (Type Eq WQL_Xls4Type) Or (Type Eq WQL_Xls5Type)) ;                        Append Filter "Excel (*.xls)|*.xls"
47350>>>                    If Type Eq WQL_RichTextFormatType ;                        Append Filter "Rich Text (*.rtf)|*.rtf"
47353>>>                    If Type Eq WQL_TextType ;                        Append Filter "Text (*.txt)|*.txt"
47356>>>                    If Type Eq WQL_RecordType ;                        Append Filter "Record Style (*.rec)|*.rec"
47359>>>                    If Type Eq WQL_CommaSeparatedType ;                        Append Filter "Comma Separated Values (*.csv)|*.csv"
47362>>>                    If Type Eq WQL_DIFType ;                        Append Filter "Data Interchange Format (*.dif)|*.dif"
47365>>>                    Append Filter "|All Files|*.*"
47366>>>                
47366>>>                    //*** Create a save as dialog
47366>>>                    Object New_dialog Is A SaveAsdialog
47368>>>                        //*** Setup title
47368>>>                        Set Dialog_Caption        To "Item report export to disk, give file name"
47369>>>                        Set Filter_String         To Filter
47370>>>                        Set Hidereadonly_State    To True
47371>>>                        Set Overwriteprompt_State To True
47372>>>                        Set Showfiletitle_State   To True
47373>>>                        Set File_Title            To SelectedFile
47374>>>                    End_object // New_dialog
47375>>>                
47375>>>                    //*** Start the save as dialog
47375>>>                    Get Show_Dialog Of (New_dialog(Current_object)) To Selected
47376>>>                    If Selected Begin
47378>>>                        Get File_Name Of (New_Dialog(Current_object)) To SelectedFile
47379>>>                        Set Value Item 0 To SelectedFile
47380>>>                    End
47380>>>>
47380>>>                
47380>>>                    //*** Destroy the save as dialog
47380>>>                    Send Request_Destroy_object To (New_dialog(Current_object))
47381>>>                End_procedure // Start_Prompt
47382>>>                
47382>>>                //***
47382>>>                //*** Function: FileName
47382>>>                //*** Purpose : Returns the name of the file to export to
47382>>>                //***
47382>>>                
47382>>>                Function FileName Returns String
47384>>>                    Local String  SelectedFile
47385>>>                
47385>>>                    //*** Get file name
47385>>>                    Get Value Item 0 To SelectedFile
47386>>>                    If SelectedFile Eq "" ;                        Move "cmoves.doc" To SelectedFile
47389>>>                
47389>>>                    Function_return SelectedFile
47390>>>                End_function // FileName
47391>>>                
47391>>>                
47391>>>                
47391>>>                
47391>>>                
47391>>>                
47391>>>                
47391>>>                
47391>>>                
47391>>>                
47391>>>                
47391>>>                //AB-StoreEnd
47391>>>
47391>>>            End_Object    // FileNameForm
47392>>>
47392>>>            Object TypeCombo is a ComboForm
47394>>>
47394>>>                //AB-StoreTopStart
47394>>>                                                                                                                                                                                    
47394>>>                //AB-StoreTopEnd
47394>>>
47394>>>                Set Size to 13 133
47395>>>                Set Location to 29 33
47396>>>                Set Label_Col_Offset to 2
47397>>>                Set Label_Justification_Mode to jMode_Right
47398>>>
47398>>>                //AB-StoreStart
47398>>>                Set Entry_state Item 0 To False
47399>>>                Set Combo_Sort_State To False
47400>>>                
47400>>>                Procedure Combo_Fill_List
47402>>>                    Send Combo_Add_item "Word for Windows"
47403>>>                    Send Combo_Add_Item "Excel 2.1"
47404>>>                    Send Combo_Add_Item "Excel 3.0"
47405>>>                    Send Combo_Add_Item "Excel 4.0"
47406>>>                    Send Combo_Add_Item "Excel 5.0"
47407>>>                    Send Combo_Add_Item "Rich Text"
47408>>>                    Send Combo_Add_Item "Text"
47409>>>                    Send Combo_Add_Item "Record Style"
47410>>>                    Send Combo_Add_Item "Comma Separated"
47411>>>                    Send Combo_Add_Item "Data Interchage Format (DIF)"
47412>>>                End_procedure // Combo_Fill_List
47413>>>                
47413>>>                Function FileType Returns Integer
47415>>>                    Local String  FileTypeName
47416>>>                    Local Integer FileTypeValue
47416>>>                    Local Integer SelectedItem
47416>>>                
47416>>>                    Get Value Item 0 To FileTypeName
47417>>>                    Get Combo_Item_Matching FileTypeName To SelectedItem
47418>>>                    Move WQL_TextType To FileTypeValue
47419>>>                    If SelectedItem Ne -1 Begin
47421>>>                        If SelectedItem Eq 0 Move WQL_WordWinType        To FileTypeValue
47424>>>                        If SelectedItem Eq 1 Move WQL_Xls2Type           To FileTypeValue
47427>>>                        If SelectedItem Eq 2 Move WQL_Xls3Type           To FileTypeValue
47430>>>                        If SelectedItem Eq 3 Move WQL_Xls4Type           To FileTypeValue
47433>>>                        If SelectedItem Eq 4 Move WQL_Xls5Type           To FileTypeValue
47436>>>                        If SelectedItem Eq 5 Move WQL_RichTextFormatType To FileTypeValue
47439>>>                        If SelectedItem Eq 6 Move WQL_TextType           To FileTypeValue
47442>>>                        If SelectedItem Eq 7 Move WQL_RecordType         To FileTypeValue
47445>>>                        If SelectedItem Eq 8 Move WQL_CommaSeparatedType To FileTypeValue
47448>>>                        If SelectedItem Eq 9 Move WQL_DIFType            To FileTypeValue
47451>>>                    End
47451>>>>
47451>>>                
47451>>>                    Function_return FileTypeValue
47452>>>                End_function // FileType
47453>>>                
47453>>>                Function FileExt Returns String
47455>>>                    Local String  FileTypeExt
47456>>>                    Local Integer FileTypeValue
47456>>>                
47456>>>                    Get FileType To FileTypeValue
47457>>>                    If FileTypeValue Eq WQL_WordWinType        Move ".doc" To FileTypeExt
47460>>>                    If FileTypeValue Eq WQL_Xls2Type           Move ".xls" To FileTypeExt
47463>>>                    If FileTypeValue Eq WQL_Xls3Type           Move ".xls" To FileTypeExt
47466>>>                    If FileTypeValue Eq WQL_Xls4Type           Move ".xls" To FileTypeExt
47469>>>                    If FileTypeValue Eq WQL_Xls5Type           Move ".xls" To FileTypeExt
47472>>>                    If FileTypeValue Eq WQL_RichTextFormatType Move ".rtf" To FileTypeExt
47475>>>                    If FileTypeValue Eq WQL_TextType           Move ".txt" To FileTypeExt
47478>>>                    If FileTypeValue Eq WQL_RecordType         Move ".rec" To FileTypeExt
47481>>>                    If FileTypeValue Eq WQL_CommaSeparatedType Move ".csv" To FileTypeExt
47484>>>                    If FileTypeValue Eq WQL_DIFType            Move ".dif" To FileTypeExt
47487>>>                
47487>>>                    Function_return FileTypeExt
47488>>>                End_function // FileExt
47489>>>                
47489>>>                Procedure OnChange
47491>>>                    Local String  OldName
47492>>>                    Local String  Extension
47492>>>                    Local Integer ChangeExt
47492>>>                
47492>>>                    Get ChangeExtension To ChangeExt
47493>>>                    If ChangeExt Begin
47495>>>                        Get WQLFileName To OldName
47496>>>                        Get FileExt To Extension
47497>>>                        Set WQLFileName To (Left(OldName, (Pos(".", Oldname) - 1)) + Extension)
47498>>>                    End
47498>>>>
47498>>>                End_procedure // OnChange
47499>>>                
47499>>>                
47499>>>                //AB-StoreEnd
47499>>>
47499>>>            End_Object    // TypeCombo
47500>>>
47500>>>            Object ApplyExtCheckBox is a CheckBox
47502>>>
47502>>>                //AB-StoreTopStart
47502>>>                                                                                                                                                                                                                                
47502>>>                //AB-StoreTopEnd
47502>>>
47502>>>                Set Label to "Apply combo extension"
47503>>>                Set Size to 10 89
47504>>>                Set Location to 47 33
47505>>>
47505>>>                //AB-StoreStart
47505>>>                //*** Apply extensions by default
47505>>>                Set Select_state Item 0 To True
47506>>>                //AB-StoreEnd
47506>>>
47506>>>            End_Object    // ApplyExtCheckBox
47507>>>
47507>>>            Object TextBoxSub23 is a TextBoxSub
47509>>>                Set Label to "Ž¤¦£˜"
47510>>>                Set FontSize to 4 0
47511>>>                Set Location to 10 6
47512>>>                Set Size to 10 25
47513>>>                Set TypeFace to "MS Sans Serif"
47514>>>                Set Enabled_State to TRUE
47515>>>            End_Object    // TextBoxSub23
47516>>>
47516>>>            Object TextBoxSub24 is a TextBoxSub
47518>>>                Set Label to "’ç§¦ª"
47519>>>                Set FontSize to 4 0
47520>>>                Set Location to 30 5
47521>>>                Set Size to 10 23
47522>>>                Set TypeFace to "MS Sans Serif"
47523>>>                Set Enabled_State to TRUE
47524>>>            End_Object    // TextBoxSub24
47525>>>
47525>>>
47525>>>            //AB-StoreStart
47525>>>            Function WQLFileName Returns String
47527>>>                Function_return (FileName(FileNameForm(Current_object)))
47528>>>            End_function // WQLFIleName
47529>>>            
47529>>>            Procedure Set WQLFileName String NewName
47531>>>                Set Value Of (FileNameForm(Current_object)) Item 0 To NewName
47532>>>            End_procedure // Set WQLFIleName
47533>>>            
47533>>>            Function WQLFileType Returns Integer
47535>>>                Function_return (FileType(TypeCombo(Current_object)))
47536>>>            End_function // WQLFIleType
47537>>>            
47537>>>            Function WQLFileExt Returns Integer
47539>>>                Function_return (FileExt(TypeCombo(Current_object)))
47540>>>            End_function // WQLFIleExt
47541>>>            
47541>>>            Function ChangeExtension Returns Integer
47543>>>                Function_return (Select_state(ApplyExtCheckBox(Current_object), 0))
47544>>>            End_function // ChangeExtension
47545>>>            
47545>>>            //AB-StoreEnd
47545>>>
47545>>>        End_Object    // FileTypeGroup
47546>>>
47546>>>        Object ButtonSub1 is a Button
47548>>>
47548>>>            //AB-StoreTopStart
47548>>>                                                                                                                                
47548>>>            //AB-StoreTopEnd
47548>>>
47548>>>            Set Bitmap to "RUNPROG.BMP"
47549>>>            Set Size to 18 28
47550>>>            Set Location to 199 231
47551>>>
47551>>>            //AB-StoreStart
47551>>>            Procedure OnClick
47553>>>               string dateapo dateeos datehh datemm dateyy  msgstr
47554>>>               integer epil listatus ihmgio
47554>>>               Get Starthme To dateapo
47555>>>               Get Endhme   To dateeos
47556>>>               Get value of (formsub1(GroupSub5(Self)))  item 0 to ihmgio
47557>>>               if (ihmgio = 0) begin
47559>>>                  send info_box "ƒâ¤ „§ ¢â¥˜«œ †£œ¨¦¢æš ¦ !!" "¢ž¨¦­¦¨å˜"
47560>>>                  procedure_return
47561>>>                end
47561>>>>
47561>>>               if dateeos eq "" begin
47563>>>                 move 31 to datehh
47564>>>                 move 12 to datemm
47565>>>                 move syscurxr.year_year to dateyy
47566>>>                 Append dateeos datehh
47567>>>                 append dateeos datemm
47568>>>                 append dateeos dateyy
47569>>>                end
47569>>>>
47569>>>            
47569>>>                if dateapo eq "" begin
47571>>>                  move 01 to datehh
47572>>>                  move 01 to datemm
47573>>>                  move syscurxr.year_year to dateyy
47574>>>                  append dateapo datehh
47575>>>                  append dateapo "/"
47576>>>                  append dateapo datemm
47577>>>                  append dateapo "/"
47578>>>                  append dateapo dateyy
47579>>>            
47579>>>               end
47579>>>>
47579>>>                move 0 to listatus
47580>>>                     if (dateapo ne "") begin
47582>>>                       if ((dateapo<syscurxr.year_xrhshfrom) or (dateapo>syscurxr.year_xrhshto)) begin
47584>>>                          move "" to msgstr
47585>>>                          move 1 to listatus
47586>>>                          move "†£/¤åœª „§ ¢¦šãª „¡«æª Ž¨åà¤ •¨ã©žª" to msgstr
47587>>>                          error 999 msgstr
47588>>>>
47588>>>            
47588>>>                       end
47588>>>>
47588>>>                     end
47588>>>>
47588>>>            
47588>>>                      if (dateeos ne "") begin
47590>>>                       if ((dateeos<syscurxr.year_xrhshfrom) or (dateeos>syscurxr.year_xrhshto)) begin
47592>>>                          move "" to msgstr
47593>>>                           move 1 to listatus
47594>>>                          move "†£/¤åœª „§ ¢¦šãª „¡«æª Ž¨åà¤ •¨ã©žª" to msgstr
47595>>>                          error 999 msgstr
47596>>>>
47596>>>                       end
47596>>>>
47596>>>                      end
47596>>>>
47596>>>               if (listatus = 0) begin
47598>>>                    Send RuncmovesReport To (cmovesWQLReport(Current_Object))
47599>>>               end
47599>>>>
47599>>>            End_Procedure
47600>>>            
47600>>>            //AB-StoreEnd
47600>>>
47600>>>        End_Object    // ButtonSub1
47601>>>
47601>>>        Object ButtonSub2 is a ButtonSub
47603>>>
47603>>>            //AB-StoreTopStart
47603>>>                                                                                                                                                                
47603>>>            //AB-StoreTopEnd
47603>>>
47603>>>            Set Bitmap to "CANCEL.BMP"
47604>>>            Set Size to 18 28
47605>>>            Set Location to 222 231
47606>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
47607>>>
47607>>>            //AB-StoreStart
47607>>>            Procedure OnClick
47609>>>                Send Request_Cancel
47610>>>            End_Procedure
47611>>>            
47611>>>            
47611>>>            
47611>>>            
47611>>>            //AB-StoreEnd
47611>>>
47611>>>        End_Object    // ButtonSub2
47612>>>
47612>>>        Object Textbox7 is a Textbox
47614>>>            Set Label to "„§ ¢¦šã œ¡«ç§à©žª "
47615>>>            Set Location to 249 7
47616>>>            Set Size to 10 69
47617>>>            Set TypeFace to "MS Sans Serif"
47618>>>        End_Object    // Textbox7
47619>>>
47619>>>        Object Form3 is a Form
47621>>>            Set Size to 13 65
47622>>>            Set Location to 261 6
47623>>>            Set Prompt_Button_Mode to pb_PromptOn
47624>>>
47624>>>            //AB-StoreStart
47624>>>                                                                        
47624>>>            Set Prompt_Object to (SLrep(Current_object))
47625>>>            procedure prompt
47627>>>                Set pskathg Of (slrep(Self)) to 'r6_1hm.rv'
47628>>>                Forward Send Prompt
47630>>>            end_procedure
47631>>>            
47631>>>            procedure onchange
47633>>>                string skathg
47634>>>                get value item 0 to skathg
47635>>>                clear sysrep
47636>>>                move 'r6_1hm.rv' to sysrep.view
47637>>>                move skathg to sysrep.name
47638>>>                find eq sysrep by index.1
47639>>>>
47639>>>                if (psmodule(self)='02')  set value of (form4(self)) to sysrep.descr1
47642>>>                else                      set value of (form4(self)) to sysrep.descr
47644>>>                set psrep to sysrep.name
47645>>>            end_procedure
47646>>>            
47646>>>            
47646>>>            
47646>>>            
47646>>>            
47646>>>            
47646>>>            
47646>>>            
47646>>>            //AB-StoreEnd
47646>>>
47646>>>        End_Object    // Form3
47647>>>
47647>>>        Object Form4 is a Form
47649>>>            Set Size to 13 213
47650>>>            Set Location to 261 74
47651>>>
47651>>>            //AB-StoreStart
47651>>>            set enabled_state to false
47652>>>            //AB-StoreEnd
47652>>>
47652>>>        End_Object    // Form4
47653>>>
47653>>>
47653>>>        //AB-StoreStart
47653>>>        
47653>>>        Procedure Activate_View Returns Integer
47655>>>            String sStr sModule StrDisp rval scompany
47656>>>            Integer iInt icheck
47656>>>            set value of (f_hme_apo(groupsub4(current_object))) to syscurxr.year_xrhshfrom
47657>>>            set value of (f_hme_eos(groupsub4(current_object))) to syscurxr.year_xrhshto
47658>>>        
47658>>>            Forward Get Msg_Activate_View to rVal
47660>>>        
47660>>>            Get psMenuModule  Of Main_Menu  to sModule
47661>>>            Set psModule                    to sModule
47662>>>        
47662>>>            if (smodule = "01") begin
47664>>>                 Set Label Of r6_1hm to "‰˜¨«â¢œª œ¢˜«é¤"
47665>>>            end
47665>>>>
47665>>>            if (smodule = "02") begin
47667>>>                 Set Label Of r6_1hm to "‰˜¨«â¢œª ¨¦£žŸœ¬«é¤"
47668>>>            end
47668>>>>
47668>>>           ////////////////////
47668>>>            Send Delete_Data            to (Selected_Items(dblstBRANCH(self)))
47669>>>            Send Find to (branch_dd(self)) First_Record 1
47670>>>            Set Dynamic_Update_State of (dblstbranch(self)) to false
47671>>>            While (Found=1)
47675>>>                get field_current_value of branch_dd field branch.company_code to scompany
47676>>>                get field_current_value of branch_dd field branch.branch_apoth to icheck
47677>>>                if ((syscurxr.company_code=scompany) and (icheck=1));                    Set Array_Value of (Selected_Items(dblstbranch(self))) Item iInt to branch.Recnum
47680>>>                Add 1 to iInt
47681>>>                Send Find to (branch_dd(self)) Next_Record 1
47682>>>            Loop
47683>>>>
47683>>>            Send Beginning_Of_Data    to (dblstbranch(self))
47684>>>            Set Dynamic_Update_State of (dblstbranch(self)) to true
47685>>>            ///////////////////////
47685>>>        End_Procedure
47686>>>        
47686>>>        Object cmovesWQLReport Is A CrystalReportSubSQL
47688>>>        
47688>>>            Property Integer ReportReady Public False
47690>>>            Set Report_View_id To (Parent(Current_object))
47691>>>        
47691>>>            Procedure OnStartPrinting
47693>>>        
47693>>>                local string  lscatypes Startnumbern Endnumbern Startnamen Endnamen
47694>>>                Local integer Starthmen Endhmen repstatus StartantliaNumber ianal
47694>>>                Local string   endtypkinn Selection FileName sbranch slabel srep
47694>>>                Local integer EndantliaNumber FileType Destination SortOrder;                              NumSortFields CurSortField SortDirection wdate starttypkinn
47694>>>                local number startposon fstartposo
47694>>>                local integer fepil  iwhat axiastatn iint icount irec
47694>>>                string flysh1 sStr flysh2  module shmgio stext scode sname
47694>>>                date   apo eos
47694>>>                Get starthme to starthmen
47695>>>                get value of form3 to srep
47696>>>                Move "" To Selection
47697>>>                get axiastat to axiastatn
47698>>>                Append Selection (If(Selection <> "", " and ", ""))"{cmoves.company_code} = " '"' (Trim(syscurxr.company_code)) '"'
47703>>>                ////////////
47703>>>                Get Select_Count of (dblstbranch(Self)) to iInt
47704>>>                If (iInt>0) Begin
47706>>>                    move '' to stext
47707>>>                    For iCount from 0 to (iInt-1)
47713>>>>
47713>>>                        Get array_value of (Selected_Items(dblstbranch(self))) Item iCount to iRec
47714>>>                        Clear branch
47715>>>                        Move iRec to branch.Recnum
47716>>>                        Find Eq branch.Recnum
47717>>>>
47717>>>                        move branch.branch_code to scode
47718>>>                        move branch.branch_name to sname
47719>>>                        Move (Append(sbranch,(trim(sname)+' '))) to sbranch
47720>>>                        Move (Append(stext,(trim(scode)+' '))) to stext
47721>>>                    Loop
47722>>>>
47722>>>                End
47722>>>>
47722>>>                Append Selection (If(Selection <> "", " and ", "")) "InStr('" stext "',{cmoves.branch_code})<>0"
47726>>>                /////////////
47726>>>                Append Selection (If(Selection <> "", " and ", "")) "{cmoves.year_year} = " '' (syscurxr.year_year) ''
47731>>>        
47731>>>                If axiastatn eq 1;                    Append Selection (If(Selection <> "", " and ", "")) "{cmoves.cmoves_axia} <>  " '' (0) ''
47738>>>                Get StartNumber To StartNumbern
47739>>>                Get EndNumber   To Endnumbern
47740>>>                If (Trim(StartNumbern)) ne "" ;                   Append Selection (If(Selection <> "", " and ", "")) "{cmoves.client_id} >= " '"' (Trim(startnumbern)) '"'
47747>>>                If (Trim(EndNumbern)) ne "" ;                   Append Selection (If(Selection <> "", " and ", "")) "{cmoves.client_id} <= " '"' (Trim(Endnumbern)) '"'
47754>>>                Get Starttypkin To Starttypkinn
47755>>>        
47755>>>                 Move '' to sStr
47756>>>                 clear hmctyp
47757>>>                 move starttypkinn to hmctyp.hmgio_code
47758>>>                 find gt hmctyp by index.1
47759>>>>
47759>>>                 while  ((found) and (hmctyp.hmgio_code=starttypkinn))
47763>>>                    Move (Append(sStr,(trim(hmctyp.ctypkin_code)+' '))) to sStr
47764>>>                    find gt hmctyp by index.1
47765>>>>
47765>>>                 loop
47766>>>>
47766>>>                 Move (Trim(sStr)) to sStr
47767>>>                 Append Selection (If(Selection <> "", " and ", "")) "InStr('" sStr "',{cmoves.ctypkin_code})<>0"
47771>>>        
47771>>>                 get value of (formsub6(groupsub5(self))) to shmgio
47772>>>                 Set Formula "fhmgio" To (winql_string(shmgio))
47773>>>        
47773>>>                 Get Endhme   To Endhmen
47774>>>                 If (trim(Endhmen)) ne 0 ;                      Append Selection (If(Selection <> "", " and ", "")) "{cmoves.cmoves_hmnia} <= " (winql_date(Endhmen))
47779>>>                 If (srep="r6_1hmp.rpt");                      Append Selection (If(Selection <> "", " and ", "")) "{cmoves.cmoves_hmnia} >= " (winql_date(starthmen))
47784>>>                 get value of (form4(self)) to slabel
47785>>>                 Set Formula "formula1" to (Winql_String(psModule(Self)))
47786>>>                 Set Formula "flabel" to (Winql_String(slabel))
47787>>>                 Set Formula "fwhat" to (Winql_number(piwhat(Self)))
47788>>>                 get  psModule to flysh1
47789>>>                 move "04" to flysh2
47790>>>        
47790>>>                 Move '' to sStr
47791>>>                 Move (Append(sStr,(flysh1+flysh2))) to sStr
47792>>>                 Move (Trim(sStr)) to sStr
47793>>>                 Append Selection (If(Selection <> "", " and ", "")) "InStr('" sStr "',{cmoves.module_from})<>0"
47797>>>        
47797>>>                Set SelectionFormula To Selection
47798>>>        
47798>>>                get analstat to ianal
47799>>>                get starthme to apo
47800>>>                get endhme   to eos
47801>>>                get psModule to module
47802>>>                get epil to fepil
47803>>>        
47803>>>                set formula "fanal" to (winql_number(ianal))
47804>>>                Set Formula "fepil" to (winql_number(fepil))  ////////To ('"' + (Replaces('"', fepil, "")) + '"')
47805>>>                Set Formula "fapo" To (winql_date(apo))
47806>>>                Set Formula "feos" To (winql_date(eos))
47807>>>                Set Formula "fmodule" To  (winql_string(module))
47808>>>                set formula "fbranch" to (winql_string(sbranch))
47809>>>                If Selection Eq "" ;                    Set Formula "SelTxt" To ('"' + "NONE" + '"')
47812>>>                Else ;                    Set Formula "SelTxt" To ('"' + (Replaces('"', Selection, "")) + '"')
47814>>>        
47814>>>                move 1 To SortDirection
47815>>>                Send AddSortField "{cmoves.cmoves_hmnia}" SortDirection
47816>>>                Get Output_Destination To Destination
47817>>>                If ((Destination Eq WQL_PRINT_TO_FILE) Or (Destination Eq WQL_PRINT_TO_MAPI)) Begin
47819>>>                    Get WQLFileName To FileName
47820>>>                    Get WQLFileType To FileType
47821>>>                    Set ExportFileName   To FileName
47822>>>                    Set ExportFormatType To FileType
47823>>>                End
47823>>>>
47823>>>                If Destination EQ WQL_PRINT_TO_WINDOW ;                    Set ReportReady To False
47826>>>                Else ;                    Set ReportReady To True
47828>>>            End_procedure // OnStartPrinting
47829>>>        
47829>>>        
47829>>>            Procedure RuncmovesReport
47831>>>               Set Report_name  to (psrep(self))
47832>>>               Send Run_report
47833>>>               Send Cursor_Ready To (Cursor_Control(Current_Object))
47834>>>               If (ReportReady(Current_object)) ;                    Send Info_box "WinQL report ready."
47837>>>            End_procedure // RunCustReport
47838>>>        
47838>>>        End_object // CustWQLReport
47839>>>        
47839>>>        Function StartNumber Returns string
47841>>>            Function_return (StartNumber(groupSub1(Current_object)))
47842>>>        End_function // StartNumber
47843>>>        
47843>>>        Function EndNumber Returns string
47845>>>            Function_return (EndNumber(groupSub1(Current_object)))
47846>>>        End_function // StartNumber
47847>>>        
47847>>>        Function Starthme Returns integer
47849>>>            Function_return (Starthme(groupSub4(Current_object)))
47850>>>        End_function // StartNumber
47851>>>        
47851>>>        Function Endhme Returns integer
47853>>>            Function_return (Endhme(groupSub4(Current_object)))
47854>>>        End_function // StartNumber
47855>>>        
47855>>>        Function Starttypkin Returns integer
47857>>>            Function_return (Starttypkin(groupSub5(Current_object)))
47858>>>        End_function // Starttypkin
47859>>>        
47859>>>        Function analstat Returns integer
47861>>>            Function_return (analstat(groupsub4(Current_object)))
47862>>>        End_function
47863>>>        
47863>>>        Function axiastat Returns integer
47865>>>            Function_return (axiastat(groupsub4(Current_object)))
47866>>>        End_function
47867>>>        Procedure AdjustFileTypeShadow Integer NewState
47869>>>            Set Object_Shadow_State Of (FileTypeGroup(Current_Object)) To NewState
47870>>>        End_procedure // AdjustFileTypeShadow
47871>>>        
47871>>>        Procedure AdjustBoundaryShadow Integer GroupNum
47873>>>            Set Object_Shadow_State Of (groupSub1(Current_object)) To (GroupNum <> 0)
47874>>>        End_procedure // AdjustBoundaryShadow
47875>>>        
47875>>>        Function WQLFileName Returns String
47877>>>            Function_return (WQLFileName(FileTypeGroup(Current_object)))
47878>>>        End_function // WQLFIleName
47879>>>        
47879>>>        Function WQLFileType Returns Integer
47881>>>            Function_return (WQLFileType(FileTypeGroup(Current_object)))
47882>>>        End_function // WQLFIleType
47883>>>        
47883>>>        
47883>>>        
47883>>>        
47883>>>        
47883>>>        
47883>>>        
47883>>>        
47883>>>        
47883>>>        
47883>>>        //AB-StoreEnd
47883>>>
47883>>>    End_Object    // r6_1hm
47884>>>
47884>>>
47884>>>    //AB-StoreStart
47884>>>                        
47884>>>                        
47884>>>                        
47884>>>                        
47884>>>                        
47884>>>                        
47884>>>                        
47884>>>                        
47884>>>                        
47884>>>                        
47884>>>                        
47884>>>                        
47884>>>                        
47884>>>                        
47884>>>    //AB-StoreEnd
47884>>>
47884>>>//AB/     End_Object    // prj
47884>
47884>        //AB-ClientStoreStart
47884>        
47884>        Use Baxio.dd
INCLUDING FILE: BAXIO.DD
47884>>>//DDB-FileStart
47884>>>//DDB-HeaderStart
47884>>>
47884>>>// File Name : BAXIO.DD
47884>>>// Class Name: Baxio_DataDictionary
47884>>>// Revision  : 112
47884>>>// Version   : 2
47884>>>
47884>>>Use  Windows           // Basic Definitions
47884>>>Use  DataDict          // DataDictionary Class Definition
47884>>>Use  DDvalTbl          // Validation Table Class Definitions
47884>>>
47884>>>Open Baxio
47886>>>Open Bmove
47888>>>Open Baxiokat
47890>>>Open Sysrecb
47892>>>
47892>>>//DDB-HeaderEnd
47892>>>//DDB-ValidationStart
47892>>>
47892>>>//DDB/ ExternalValidationTable Baxio_Status_VT  Baxio.pkg
47892>>>//DDB/ ExternalValidationTable Bfile_VT  Baxio.pkg
47892>>>
47892>>>Register_Object Baxio_Status_VT
47892>>>Register_Object Baxio_Baxio_Place_VT
47892>>>Register_Object Bfile_VT
47892>>>Register_Object Baxio_Baxio_Bank_VT
47892>>>Register_Object Baxio_Baxio_Banka_VT
47892>>>Register_Object Baxio_Baxio_From_VT
47892>>>Register_Object Baxio_Baxio_Topos_VT1
47892>>>Use Baxio.pkg        // Baxio_Status_VT, Bfile_VT
INCLUDING FILE: BAXIO.PKG
47892>>>>>// **************************************************************************
47892>>>>>// *Code Style   : Object                                                   *
47892>>>>>// *Name         : Baxio.vts                                                *
47892>>>>>// *Revision     : 1                                                        *
47892>>>>>// *Main File    :                                                          *
47892>>>>>// *Location     : \Home.Win\Easyware\ED\Appsrc                             *
47892>>>>>// *Creation Date: 01/09/99                                                 *
47892>>>>>// *Last Update  :                                                          *
47892>>>>>// *Author       : JA                                                       *
47892>>>>>// *Includes     :                                                          *
47892>>>>>// *Comments     : œ¨ â®œ  æ¢˜ «˜ static validation tables «¦¬             *
47892>>>>>// *             : module «à¤ ˜¥ ¦š¨á­à¤.                                   *
47892>>>>>// *             :                                                          *
47892>>>>>// *             :                                                          *
47892>>>>>// *Returns      :                                                          *
47892>>>>>// *             :                                                          *
47892>>>>>// *‰nown bugs   :                                                          *
47892>>>>>// *             :                                                          *
47892>>>>>// *Improvements :                                                          *
47892>>>>>// *             :                                                          *
47892>>>>>// *             :                                                          *
47892>>>>>// **************************************************************************
47892>>>>>// *                        A N A L Y S I S                                 *
47892>>>>>// **************************************************************************
47892>>>>>// *                                                                        *
47892>>>>>// **************************************************************************
47892>>>>>
47892>>>>>
47892>>>>>//Set Allow_Blank_State To TRUE
47892>>>>>
47892>>>>>//used by: 1. baxiokat.baxiokat_type
47892>>>>>Object Baxiokat_Type_VT  is a DescriptionValidationTable
47894>>>>>       set table_title to "„å›¦ª €¥ ¦š¨á­¦¬"
47895>>>>>       Procedure Fill_List
47897>>>>>                 Forward Send Fill_List
47899>>>>>                 Send Add_Table_Value  "1"  "„ ©§¨˜¡«â¦"
47900>>>>>                 send add_table_value  "2"  "¢ž¨à«â¦"
47901>>>>>       End_Procedure //fill_list
47902>>>>>End_Object   //Baxiokat_Type_VT
47903>>>>>
47903>>>>>
47903>>>>>//¡˜«˜©«á©œ ª ˜¥ ¦š¨á­à¤
47903>>>>>//used by: 1. bkinkat.baxio_stat_from :¡˜«á©«˜©ž ˜§æ
47903>>>>>//         2. bkinkat.baxio_stat_to   :¡˜«á©«˜©ž ©â
47903>>>>>//         3. baxio.baxio_status      :¡˜«á©«˜©ž
47903>>>>>//â¤˜ ˜¥ æš¨˜­¦ œå¤˜  § Ÿ˜¤æ ¤˜ ™¨œŸœå ©« ª §˜¨˜¡á«à 3 ¡˜«˜©«á©œ ª:
47903>>>>>Object Baxio_Status_VT  is a DescriptionValidationTable
47905>>>>>       set table_title to "‰˜«˜©«á©œ ª €¥ ¦š¨á­à¤"
47906>>>>>       Procedure Fill_List
47908>>>>>                 Forward Send Fill_List
47910>>>>>                 Send Add_Table_Value  "1"  "„¡¡¨œ£âª"
47911>>>>>                 Send Add_Table_Value  "2"  "„¥¦­¢ž£â¤¦"
47912>>>>>                 Send Add_Table_Value  "3"  "ƒ ˜£˜¨«¬¨ž£â¤¦"
47913>>>>>                 Send Add_Table_Value  "4"  "’˜£œå¦"
47914>>>>>                 Send Add_Table_Value  "5"  "ƒœ©£œ¬£â¤¦"
47915>>>>>
47915>>>>>       End_Procedure // fill_list
47916>>>>>End_Object   //Baxio_Status_VT1
47917>>>>>
47917>>>>>
47917>>>>>
47917>>>>>//used by: 1. btypkin.btypkin_anti1
47917>>>>>//         2. btypkin.btypkin_anti2
47917>>>>>//         3. baxio.baxio_file_in
47917>>>>>//         4. baxio.baxio_file_out
47917>>>>>//         5. baxio.baxio_lfile
47917>>>>>Object Bfile_VT  is a DescriptionValidationTable
47919>>>>>       set table_title to "‘¬¤˜¢¢˜©æ£œ¤¦ª/˜¨˜¢ã§«žª ˜§æ"
47920>>>>>       Procedure Fill_List
47922>>>>>                 Forward Send Fill_List
47924>>>>>                 Send Add_Table_Value  "-1" "ƒœ¤ “§á¨®œ "
47925>>>>>                 Send Add_Table_Value  "0"  "Data Entry"
47926>>>>>                 Send Add_Table_Value  "1"  "Š¦š˜¨ ˜©£é¤ ‚Š"
47927>>>>>                 send add_table_value  "2"  "”¦¨â˜ª"
47928>>>>>                 Send Add_Table_Value  "3"  "¨¦£žŸœ¬«é¤"
47929>>>>>                 Send Add_Table_Value  "5"  "Ž ‘¬¤˜¢¢˜©æ£œ¤¦ª"
47930>>>>>                 Send Add_Table_Value  "6"  "’œ¢.˜¨˜¢ã§«žª"
47931>>>>>       End_Procedure // fill_list
47932>>>>>End_Object   // Btypkin_Btypkin_Anti_VT
47933>>>>>
47933>>>
47933>>>Object Baxio_Baxio_Place_VT  is a CodeValidationTable
47935>>>    Set Type_Value        To "BAXIOPLACE"
47936>>>    //DDB-ValidationCustomStart
47936>>>    //DDB-ValidationCustomEnd
47936>>>End_Object   // Baxio_Baxio_Place_VT
47937>>>
47937>>>Object Baxio_Baxio_Bank_VT  is a CodeValidationTable
47939>>>    Set Type_Value        To "BANK"
47940>>>    Set Allow_Blank_State To TRUE
47941>>>    //DDB-ValidationCustomStart
47941>>>    //DDB-ValidationCustomEnd
47941>>>End_Object   // Baxio_Baxio_Bank_VT
47942>>>
47942>>>Object Baxio_Baxio_Banka_VT  is a CodeValidationTable
47944>>>    Set Type_Value        To "BANK"
47945>>>    Set Allow_Blank_State To TRUE
47946>>>    //DDB-ValidationCustomStart
47946>>>    //DDB-ValidationCustomEnd
47946>>>End_Object   // Baxio_Baxio_Banka_VT
47947>>>
47947>>>Object Baxio_Baxio_From_VT  is a DescriptionValidationTable
47949>>>    Set Allow_Blank_State To TRUE
47950>>>    Set Table_Title       To "€¥ æš¨˜­¦  ›å¦¬ / «¨å«¦¬"
47951>>>
47951>>>    Procedure Fill_List
47953>>>        Forward Send Fill_List
47955>>>        Send Add_Table_Value  "0"  "ˆ›å¦¬"
47956>>>        Send Add_Table_Value  "1"  "’¨å«¦¬"
47957>>>    End_Procedure    // Fill_List
47958>>>    //DDB-ValidationCustomStart
47958>>>    //DDB-ValidationCustomEnd
47958>>>End_Object   // Baxio_Baxio_From_VT
47959>>>
47959>>>Object Baxio_Baxio_Topos_VT1  is a DescriptionValidationTable
47961>>>    Set Allow_Blank_State To TRUE
47962>>>    Set Table_Title       To "€¥ æš¨˜­¦ €«« ¡ãª / „§˜¨®å˜ª"
47963>>>
47963>>>    Procedure Fill_List
47965>>>        Forward Send Fill_List
47967>>>        Send Add_Table_Value  "0"  "€«« ¡ãª"
47968>>>        Send Add_Table_Value  "1"  "„§˜¨®å˜ª"
47969>>>    End_Procedure    // Fill_List
47970>>>    //DDB-ValidationCustomStart
47970>>>    //DDB-ValidationCustomEnd
47970>>>End_Object   // Baxio_Baxio_Topos_VT1
47971>>>//DDB-ValidationEnd
47971>>>//DDB-SelectionStart
47971>>>//DDB/ ExternalSelectionList SL037  SL037.SL
47971>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
47971>>>Register_Object SL037
47971>>>Register_Object slNomism
47971>>>//DDB-SelectionEnd
47971>>>
47971>>>Class Baxio_DataDictionary  is a DataDictionary_Sec
47972>>>
47972>>>      Procedure Construct_Object
47973>>>                Forward Send Construct_Object
47975>>>
47975>>>                //btypkin related properties:
47975>>>                //œ¤ž£œ¨é¤¦¤«˜  ©«ã¤: update «¦¬ bmove,
47975>>>                //£ž›œ¤å¦¤«˜   ©«ž¤: request save & delete «¦¬ bmove.
47975>>>                Property Integer piBtypkin_Flag03 0
47976>>>                Property Integer piBtypkin_Flag04 0
47977>>>                Property Integer pifromxrhsh      0
47978>>>
47978>>>                //baxio related properties:
47978>>>                //œ¤ž£œ¨é¤œ«˜     ©«ž¤: creating,
47978>>>                //®¨ž© £¦§¦ œå«˜  ©«ž¤: update «¦¬ bmove š ˜ ¤˜ œ¤œ¨š¦§¦ ã©œ  «ž¤ private.created_baxio «¦¬ bmove,
47978>>>                //£ž›œ¤åœ«˜      ©«ž¤: request save & delete «¦¬ bmove.
47978>>>                Property Integer piCreated_Baxio  0
47979>>>
47979>>>                //œ¤ž£œ¨é¤¦¤«˜     ©«ž¤: backout,
47979>>>                //®¨ž© £¦§¦ ¦ç¤«˜  ©«ž¤: validate_save š ˜ «¦¤ â¢œš®¦ editing «¦¬ baxio,
47979>>>                //£ž›œ¤å¦¤«˜      ©«ž¤: request save & delete «¦¬ bmove.
47979>>>                Property Number  pnB_Baxio_V2      0
47980>>>                Property Number  pnB_Baxio_V0      0
47981>>>                Property Number  pnB_Baxio_V00     0
47982>>>                Property Number  pnB_Baxio_Vr      0
47983>>>                Property String  psB_Baxio_C_Code2 ""
47984>>>                Property Integer piB_Baxio_Status  0
47985>>>                Property Integer piB_Baxio_Place   0
47986>>>
47986>>>                //properties š ˜ œ¢âš®¦¬ª ˜¢˜ššãª parent records:
47986>>>                //œ¤ž£œ¨é¤¦¤«˜     ©«ž¤:backout,
47986>>>                //®¨ž© £¦§¦ ¦ç¤«˜  ©«ž¤: validate_save š ˜ «¦¤ â¢œš®¦ editing «à¤ §œ›åà¤,
47986>>>                //£ž›œ¤å¦¤«˜      ©«ž¤: request save & delete «¦¬ bmove.
47986>>>                Property Integer piB_Baxiokat_Code 0
47987>>>                Property Integer piB_Year_Year     0
47988>>>                Property Integer piMustNOTConstrain Public 0
47989>>>      End_Procedure //construct_object
47990>>>
47990>>>
47990>>>
47990>>>//    Function fngConvertPoso_Baxio String asNomismaCodeApo ;
47990>>>//                            Number anPoso           ;
47990>>>//                            String asNomismaCodeSe  ;
47990>>>//                            Date   adHmnia          ;
47990>>>//                            Number nIsotimia  Returns Number
47990>>>
47990>>>//        Number rVal nApo_Euro_Isot nSe_Euro_Isot
47990>>>//        Integer iApo_Einai_Euro_Zone iApo_Einai_DRX iApo_Einai_Euro iDekadika_Apo
47990>>>//        Integer iSe_Einai_Euro_Zone  iSe_Einai_DRX  iSe_Einai_Euro  iDekadika_Se
47990>>>
47990>>>//        If (asNomismaCodeApo=asNomismaCodeSe) Function_Return anPoso
47990>>>
47990>>>//        Clear Nomisma
47990>>>//        Move (Trim(asNomismaCodeApo)) to Nomisma.Nomisma_Code
47990>>>//        Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
47990>>>//        Move Nomisma.Euro_Zone      to iApo_Einai_Euro_Zone
47990>>>//        Move Nomisma.Einai_DRX      to iApo_Einai_DRX
47990>>>//        Move Nomisma.Einai_EURO     to iApo_Einai_Euro
47990>>>//        Move Nomisma.KL_ISOT_EURO   to nApo_Euro_Isot
47990>>>//        Move Nomisma.Dekadika       to iDekadika_Apo
47990>>>
47990>>>//        Clear Nomisma
47990>>>//        Move (Trim(asNomismaCodeSe)) to Nomisma.Nomisma_Code
47990>>>//        Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
47990>>>//        Move Nomisma.Euro_Zone      to iSe_Einai_Euro_Zone
47990>>>//        Move Nomisma.Einai_DRX      to iSe_Einai_DRX
47990>>>//        Move Nomisma.Einai_EURO     to iSe_Einai_Euro
47990>>>//        Move Nomisma.KL_ISOT_EURO   to nSe_Euro_Isot
47990>>>//        Move Nomisma.Dekadika       to iDekadika_Se
47990>>>
47990>>>//        //05a. ??ÿ??? ? --> ??? 
47990>>>//        Calc (anPoso/nApo_Euro_Isot) to rVal
47990>>>//        Move (Round_Number(rVal,6)) to rVal
47990>>>//        //05b. ???         --> ??ÿ??? ?™ *
47990>>>//        Calc (rVal*nSe_Euro_Isot) to rVal
47990>>>//        Move (Round_Number(rVal,iDekadika_Se)) to rVal
47990>>>//        Function_Return rVal
47990>>>//    End_Function
47990>>>
47990>>>
47990>>>
47990>>>      //¡˜Ÿ¦¨åœ  «ž¤ default « £ã «¦¬ ¤¦£å©£˜«¦ª ˜¤á¢¦š˜ £œ «¦ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
47990>>>      Function Default_Axio_C_Code2 Returns String
47991>>>               String lsBaxio_C_Code_2
47992>>>               //Get File_Field_Current_Value File_Field SyscurXr.C_Code0 to lsBaxio_C_Code_2
47992>>>               Move SyscurXr.C_Code0 to lsBaxio_C_Code_2
47993>>>               Function_Return (Trim(lsBaxio_C_Code_2))
47994>>>      End_Function //default_axio_c_code2
47995>>>
47995>>>
47995>>>      // js 09/02/2002 den yparxei enhmerosh ton nomismatvn xrhshs
47995>>>      Procedure Convert_Axio_Values
47996>>>
47996>>>                Integer liBtypkin_Flag03 liBtypkin_Flag04
47997>>>
47997>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_Code0    ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_Rate0       to Baxio.Baxio_V0
47998>>>
47998>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_Code00   ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_Rate00      to Baxio.Baxio_V00
47999>>>
47999>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_CodeR    ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_RateR       to Baxio.Baxio_VR
48000>>>
48000>>>
48000>>>//                Move (fngConvertPoso_Baxio(Self,Baxio.Baxio_C_Code2,   ;
48000>>>//                                     Baxio.Baxio_V2,        ;
48000>>>//                                     SyscurXr.C_Code0,      ;
48000>>>//                                     Baxio.Baxio_HmniaE,    ;
48000>>>//                                     Baxio.Baxio_Rate0)     ;
48000>>>//                                    ) to Baxio.Baxio_V0
48000>>>//                If (liBtypkin_Flag03 = TRUE);
48000>>>//                     Begin
48000>>>//                      //˜¥å˜ 2-->00
48000>>>//                      Move (fngConvertPoso_Baxio(Self, Baxio.Baxio_C_Code2, ;
48000>>>//                                            Baxio.Baxio_V2,      ;
48000>>>//                                            SyscurXr.C_Code00,   ;
48000>>>//                                            Baxio.Baxio_HmniaE,  ;
48000>>>//                                            Baxio.Baxio_Rate00)  ;
48000>>>//                                          ) to Baxio.Baxio_V00
48000>>>//                     End
48000>>>//                Else Begin
48000>>>//                      Move 0            to Baxio.Baxio_V00
48000>>>//                     End
48000>>>//                If (liBtypkin_Flag04 = TRUE);
48000>>>//                     Begin
48000>>>//                      //˜¥å˜ 2-->r
48000>>>//                      Move (fngConvertPoso_Baxio(Self,Baxio.Baxio_C_Code2, ;
48000>>>//                                       Baxio.Baxio_V2,      ;
48000>>>//                                       SyscurXr.C_CodeR,    ;
48000>>>//                                       Baxio.Baxio_HmniaE,  ;
48000>>>//                                       Baxio.Baxio_RateR)   ;
48000>>>//                                      ) to Baxio.Baxio_VR
48000>>>//                     End
48000>>>//                Else Begin
48000>>>//                      Move 0            to Baxio.Baxio_VR
48000>>>//                     End
48000>>>      End_Procedure
48001>>>
48001>>>
48001>>>
48001>>>      Procedure Constrain
48002>>>                Forward Send Constrain
48004>>>                If (piMustNOTConstrain(Self)=1) Begin
48006>>>                End 
48006>>>>
48006>>>                else If (piMustNOTConstrain(Self)=2) Begin 
48009>>>                    Constrain Baxio.Company_Code Eq Syscurxr.Company_Code
48011>>>                    Constrain Baxio.Branch_Code  Eq Syscurxr.Branch_Code
48013>>>                end    
48013>>>>
48013>>>                Else Begin
48014>>>                    Constrain Baxio.Company_Code Eq Syscurxr.Company_Code
48016>>>                    Constrain Baxio.Branch_Code  Eq Syscurxr.Branch_Code
48018>>>                    Constrain Baxio.Year_Year    Eq Syscurxr.Year_Year
48020>>>                End
48020>>>>
48020>>>      End_Procedure   //constrain
48021>>>
48021>>>
48021>>>      //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
48021>>>      //™) ˜¤áš¤à©ž properties
48021>>>      //š) › ˜®œå¨ ©ž calculated §œ›åà¤
48021>>>      //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
48021>>>      //œ) œ¤ž£â¨à©ž properties after
48021>>>      Procedure Update
48022>>>                Forward Send Update
48024>>>                
48024>>>                If (Baxio.Baxio_C_Code2='') Move SyscurXr.C_Code0 to Baxio.Baxio_C_Code2
48027>>>                
48027>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
48027>>>                Move Syscurxr.Company_Code  to Baxio.Company_Code
48028>>>                Move Syscurxr.Branch_Code   to Baxio.Branch_Code
48029>>>                Move Syscurxr.Year_Year     to Baxio.Year_Year
48030>>>                Move Syscurxr.Year_Recr     to Baxio.Year_Recr
48031>>>                Move Baxiokat.Baxiokat_Code to Baxio.Baxiokat_Code
48032>>>
48032>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
48032>>>                //š01:œ¥ ¦¨ ©£¦ç, «˜ §¢ž¨à«â˜ ›â¤ â®¦¬¤ ©«¦ ®œå˜ §˜¨˜¢¢˜™ãª
48032>>>                If (Baxiokat.Baxiokat_Type = 2);                Begin //˜¥ æš¨˜­˜ §¢ž¨à«â˜
48034>>>                     Move "" to Baxio.Baxio_Code_In
48035>>>                     Move "" to Baxio.Baxio_Epon_In
48036>>>                     Move 0  to Baxio.Baxio_Fpar_In
48037>>>                End
48037>>>>
48037>>>                //š02:yyyy + mm + dd ¢ã¥žª š ˜ «˜ reports
48037>>>                Move (TheYearSegment (Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_YYYY
48038>>>                Move (TheMonthSegment(Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_MM
48039>>>                Move (TheDaySegment  (Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_DD
48040>>>
48040>>>                //š03:§¨é«¦ª & «œ¢œ¬«˜å¦ª §˜¨˜¢ã§«žª
48040>>>                If (Baxio.Baxio_Lcode = "");                Begin
48042>>>                     Move (-1) to Baxio.Baxio_File_Out
48043>>>                     Move ""   to Baxio.Baxio_Code_Out
48044>>>                     Move ""   to Baxio.Baxio_Epon_Out
48045>>>                     Move ""   to Baxio.Baxio_Fpar_Out
48046>>>
48046>>>                     Move (-1) to Baxio.Baxio_Lfile
48047>>>                     Move ""   to Baxio.Baxio_Lepon
48048>>>                     Move ""   to Baxio.Baxio_Lpar
48049>>>                End
48049>>>>
48049>>>      End_Procedure //update
48050>>>
48050>>>
48050>>>      Procedure Backout
48051>>>                Forward Send Backout
48053>>>
48053>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
48053>>>                Set pnB_Baxio_V2      to Baxio.Baxio_V2
48054>>>                Set pnB_Baxio_V0      to Baxio.Baxio_V0
48055>>>                Set pnB_Baxio_V00     to Baxio.Baxio_V00
48056>>>                Set pnB_Baxio_Vr      to Baxio.Baxio_Vr
48057>>>                Set psB_Baxio_C_Code2 to Baxio.Baxio_C_Code2
48058>>>                Set piB_Baxio_Status  to Baxio.Baxio_Status
48059>>>                Set piB_Baxio_Place   to Baxio.Baxio_Place
48060>>>                Set piB_Baxiokat_Code to Baxio.Baxiokat_Code    //š ˜ â¢œš®¦ ˜¢˜ššãª parent
48061>>>                Set piB_Year_Year     to Baxio.Year_Year        //š ˜ â¢œš®¦ ˜¢˜ššãª parent
48062>>>      End_Procedure //backout
48063>>>
48063>>>
48063>>>      Procedure New_Current_Record Integer liOld_Record Integer liNew_Record
48064>>>                Forward Send New_Current_Record liOld_Record liNew_Record
48066>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
48066>>>                Set pnB_Baxio_V2      to Baxio.Baxio_V2
48067>>>                Set pnB_Baxio_V0      to Baxio.Baxio_V0
48068>>>                Set pnB_Baxio_V00     to Baxio.Baxio_V00
48069>>>                Set pnB_Baxio_Vr      to Baxio.Baxio_Vr
48070>>>                Set psB_Baxio_C_Code2 to Baxio.Baxio_C_Code2
48071>>>                Set piB_Baxio_Status  to Baxio.Baxio_Status
48072>>>                Set piB_Baxiokat_Code to Baxio.Baxiokat_Code    //š ˜ â¢œš®¦ ˜¢˜ššãª parent
48073>>>                Set piB_Year_Year     to Baxio.Year_Year        //š ˜ â¢œš®¦ ˜¢˜ššãª parent
48074>>>      End_Procedure //new_current_record
48075>>>
48075>>>
48075>>>      Procedure Creating
48076>>>                Forward Send Creating
48078>>>
48078>>>                //˜¨ Ÿ£æª ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
48078>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBaxio
48078>>>
48078>>>                //«œ¢œ¬«˜å¦ª ¡à› ¡æª ˜¨ Ÿ£æª ˜¥ ¦š¨á­¦¬
48078>>>                Add 1 to Baxiokat.Baxio_Lcode
48079>>>                Move Baxiokat.Baxio_Lcode to Baxio.Baxio_Code
48080>>>
48080>>>                //«¦ property ˜¬«æ œ¤œ¨š¦§¦ œå «ž¤ private.created_baxio
48080>>>                //£â©à «žª update ©«¦ bmove
48080>>>                Set piCreated_Baxio to TRUE
48081>>>
48081>>>//
48081>>>//                Move SysCurXr.C_Code0 to Baxio.Baxio_C_Code2
48081>>>
48081>>>                Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                 (Trim(String(Baxio.Baxio_Rec0)))))) to Baxio.Baxio_Recr
48082>>>
48082>>>      End_Procedure //creating
48083>>>
48083>>>
48083>>>      Procedure Operation_Not_Allowed Integer iError_Num
48084>>>                String lsError_Message
48085>>>                Case Begin
48085>>>                     //˜§æ validate save
48085>>>                     Case (iError_Num = 1001)
48087>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  ¦§à©›ã§¦«œ ž£œ¨¦£ž¤å˜ ¢ã¥œàª!");                          to lsError_Message
48088>>>                     Case Break
48089>>>                     Case (iError_Num = 1002)
48092>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
48093>>>                     Case Break
48094>>>                     Case (iError_Num = 1003)
48097>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  ¦§à©›ã§¦«œ ¤æ£ ©£˜!");                          to lsError_Message
48098>>>                     Case Break
48099>>>                     Case (iError_Num = 1004)
48102>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
48103>>>                     Case Break
48104>>>                     Case (iError_Num = 1005)
48107>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
48108>>>                     Case Break
48109>>>                     Case (iError_Num = 1006)
48112>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ Reporting).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
48113>>>                     Case Break
48114>>>
48114>>>                     Case (iError_Num = 1007)
48117>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\nŒâ˜ €¥ æš¨˜­˜ ›ž£ ¦¬¨š¦ç¤«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
48118>>>                     Case Break
48119>>>                     Case (iError_Num = 1008)
48122>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ¤æ£ ©£˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
48123>>>                     Case Break
48124>>>                     Case (iError_Num = 1009)
48127>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
48128>>>                     Case Break
48129>>>                     Case (iError_Num = 1010)
48132>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©žª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
48133>>>                     Case Break
48134>>>                     Case (iError_Num = 1011)
48137>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜ •¨ã©žª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
48138>>>                     Case Break
48139>>>                     Case (iError_Num = 1012)
48142>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (Œæ£ ©£˜ Reporting) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
48143>>>                     Case Break
48144>>>                     Case (iError_Num = 1013)
48147>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ˜¥ æš¨˜­¦ â®œ  œ¥¦­¢žŸœå !");                          to lsError_Message
48148>>>                     Case Break
48149>>>
48149>>>                     Case (iError_Num = 1014)
48152>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ ›â¤ œ§ «¨â§œ«˜  ¤˜ ˜¢¢á¥œ  ¡˜«žš¦¨å˜!");                          to lsError_Message
48153>>>                     Case Break
48154>>>                     Case (iError_Num = 1015)
48157>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ ›â¤ œ§ «¨â§œ«˜  ¤˜ ˜¢¢á¥œ  ®¨ã©ž!");                          to lsError_Message
48158>>>                     Case Break
48159>>>                     Case (iError_Num = 1100)
48162>>>                          Move "DDC 037:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
48163>>>                          Case Break
48164>>>
48164>>>                     //˜§æ validate delete
48164>>>                     Case (iError_Num = 2007)
48167>>>                          Move ("DDC 037:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n’¦ €¥ æš¨˜­¦ › ˜š¨á­œ«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
48168>>>                     Case Break
48169>>>                     Case (iError_Num = 2100)
48172>>>                          Move "DDC 037:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
48173>>>                          Case Break
48174>>>
48174>>>                     Case Else
48174>>>                          Forward Send Operation_Not_Allowed iError_Num
48176>>>                Case End
48176>>>
48176>>>                Error iError_Num lsError_Message
48177>>>>
48177>>>      End_Procedure // operation_not_allowed
48178>>>
48178>>>      //1001:baxio_hmnial > 0
48178>>>      //1002:baxio_v2 > 0            (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ œšš¨˜­ãª
48178>>>      //1003:baxio_c_code2 <> ""     (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ £ã¤ â®œ  ¤æ£ ©£˜)
48178>>>
48178>>>      //1004:baxio_v0 > 0            (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©žª
48178>>>      //1005:baxio_v00 > 0 if flag 3 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©žª
48178>>>      //1006:baxio_vr > 0  of flag 4 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ reporting
48178>>>
48178>>>
48178>>>      //1007:›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬ œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ «¦ bmove_dd, ›ž¢˜›ã §¨â§œ 
48178>>>      //       If (baxio.recnum=0) then operation_origin must be = bmove_dd
48178>>>      //1008:«¨¦§¦§¦åž©ž (edit) baxio_c_code2 £æ¤¦¤ ˜§æ bmove_dd
48178>>>      //1009:«¨¦§¦§¦åž©ž (edit) baxio_v2      £æ¤¦¤ ˜§æ bmove_dd
48178>>>      //1010:«¨¦§¦§¦åž©ž (edit) baxio_v0      £æ¤¦¤ ˜§æ bmove_dd
48178>>>      //1011:«¨¦§¦§¦åž©ž (edit) baxio_v00     £æ¤¦¤ ˜§æ bmove_dd
48178>>>      //1012:«¨¦§¦§¦åž©ž (edit) baxio_vr      £æ¤¦¤ ˜§æ bmove_dd
48178>>>
48178>>>      //1013:œá¤ «¦ status œå¤˜  œ¥¦­¢ž£â¤¦, ˜§˜š¦¨œçœ¦¤«˜  æ¢˜ «˜ §œ¨˜ «â¨à edits
48178>>>
48178>>>      //1014:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent baxiokat record
48178>>>      //1015:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent year     record
48178>>>      Function Validate_Save Returns Integer
48179>>>               Integer iReturnVal
48180>>>
48180>>>               Forward Get Validate_Save to iReturnVal
48182>>>
48182>>>               If (Not(iReturnVal));               Begin
48184>>>
48184>>>                //---------â¢œš®¦  ›ž£ ¦¬¨šå˜ª ¤â¦¬ baxio record----------------------
48184>>>                //sososo £ž§àª §¨œ§œ  ¤˜ §˜ ¥à £œ «ž¤ current record ????
48184>>>                If (Baxio.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ record
48186>>>                      //1007:â¢œš®¦ª ›ž£ ¦¬¨šå˜ª ¤â¦¬ ˜¥ ¦š¨á­¦¬ ˜§¦ «¦ baxio_dd
48186>>>
48186>>>                      If (pifromxrhsh(Self)=0) Begin
48188>>>                        If (Not((Main_File(OPERATION_ORIGIN)) =  Bmove.File_Number)) Send Operation_Not_Allowed 1007
48191>>>                      End
48191>>>>
48191>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ baxio record
48191>>>>
48191>>>
48191>>>
48191>>>                //---------â¢œš®¦  editing existing baxio records---------------------
48191>>>                Else;                Begin //edit an existing record
48192>>>                      //1008:«¨¦§¦§¦åž©ž (edit) baxio_c_code2 £æ¤¦¤ ˜§æ bmove_dd
48192>>>
48192>>>                      If (pifromxrhsh(Self)=0) Begin
48194>>>
48194>>>                        If (;                            ((psB_Baxio_C_Code2(Self))     <> Baxio.Baxio_C_Code2) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1008
48197>>>                        //1009:«¨¦§¦§¦åž©ž (edit) baxio_v2 £æ¤¦¤ ˜§æ bmove_dd
48197>>>                        If (;                            ((pnB_Baxio_V2(Self))          <> Baxio.Baxio_V2      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1009
48200>>>                        //1010:«¨¦§¦§¦åž©ž (edit) baxio_v0 £æ¤¦¤ ˜§æ bmove_dd
48200>>>                        If (;                            ((pnB_Baxio_V0(Self))          <> Baxio.Baxio_V0      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1010
48203>>>                        //1011:«¨¦§¦§¦åž©ž (edit) baxio_v00 £æ¤¦¤ ˜§æ bmove_dd
48203>>>                        If (;                            ((pnB_Baxio_V00(Self))         <> Baxio.Baxio_V00     ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1011
48206>>>                        //1012:«¨¦§¦§¦åž©ž (edit) baxio_vr £æ¤¦¤ ˜§æ bmove_dd
48206>>>                        If (;                            ((pnB_Baxio_Vr(Self))          <> Baxio.Baxio_Vr      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1012
48209>>>
48209>>>                      End
48209>>>>
48209>>>                        // Egine rem 20/12/2001 giati an orisoume sta metrhta gia paradeigma
48209>>>                        // oti to status SE einai exoflhmeno, tote xtypaei to validation sto
48209>>>                        // kleisimo toy barticle. Alloste den vlepoume giati den mporei na
48209>>>                        // anoigokleisei
48209>>>//                      //1013:œá¤ «¦ status œå¤˜  œ¥¦­¢ž£â¤¦, ˜§˜š¦¨œç¦¤«˜  æ¢˜ «˜ §œ¨˜ «â¨à edits ˜§¦ «¦ bmove
48209>>>//                      If (;
48209>>>//                           ((piB_Baxio_Status(Self))      = 2                    ) and;
48209>>>//                           ((Main_File(OPERATION_ORIGIN)) =  Bmove.File_Number);
48209>>>//                         )                                                       Send Operation_Not_Allowed 1013
48209>>>
48209>>>                      If (pifromxrhsh(Self)=0) Begin
48211>>>                        //1014:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent baxiokat record
48211>>>                        If (Not;                            ((piB_Baxiokat_Code(Self)) =  Baxiokat.Baxiokat_Code);                            )                                                       Send Operation_Not_Allowed 1014
48214>>>
48214>>>                        //1015:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent year record
48214>>>                        If (Not;                            ((piB_Year_Year    (Self)) =  SysCurXr.Year_Year        );                            )                                                       Send Operation_Not_Allowed 1015
48217>>>                      End
48217>>>>
48217>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing baxio records
48217>>>>
48217>>>
48217>>>                //¢¦§¦å â¢œš®¦ 
48217>>>                //1001:baxio_hmnial > 0
48217>>>                If (Not(Baxio.Baxio_Hmnial > 0 ))   Send Operation_Not_Allowed 1001
48220>>>                //1002:baxio_v2 > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ œšš¨˜­ãª
48220>>>                If (Not(Baxio.Baxio_V2 > 0))         Send Operation_Not_Allowed 1002
48223>>>                //1003:baxio_c_code2 <> ""
48223>>>                If (Not(Baxio.Baxio_C_Code2 <>""))    Send Operation_Not_Allowed 1003
48226>>>                //1004:baxio_v0 > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
48226>>>//--------------If (Not(Baxio.Baxio_V0 > 0))         Send Operation_Not_Allowed 1004
48226>>>                //1005:baxio_v00> 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©œàª
48226>>>//--------------If (Not(Baxio.Baxio_V00> 0))         Send Operation_Not_Allowed 1005
48226>>>                //1006:baxio_vr > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ reporting
48226>>>//--------------If (Not(Baxio.Baxio_VR > 0))         Send Operation_Not_Allowed 1006
48226>>>                //1100:cby = globals
48226>>>
48226>>>                If (pifromxrhsh(Self)=0) Begin
48228>>>
48228>>>                    If ( ;                        (Not(Baxio.Company_Code = SyscurXr.Company_Code)) or;                        (Not(Baxio.Branch_Code  = SyscurXr.Branch_Code )) or;                        (Not(Baxio.Year_Year    = SyscurXr.Year_Year   ));                        )                                                   Send Operation_Not_Allowed 1100
48231>>>
48231>>>               End
48231>>>>
48231>>>
48231>>>               End //«â¢¦ª ¡é› ¡˜ validation
48231>>>>
48231>>>               Function_Return iReturnVal
48232>>>      End_Function //validate_save
48233>>>
48233>>>
48233>>>      //2007:ž › ˜š¨˜­ã ˜¥ ¦š¨á­¦¬ œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ «¦ bmove_dd
48233>>>      Function Validate_Delete  Returns Integer
48234>>>               Integer iReturnVal
48235>>>               Forward Get Validate_Delete  To iReturnVal
48237>>>               If (Not(iReturnVal));               Begin
48239>>>
48239>>>                  //2007:â¢œš®¦ª › ˜š¨˜­ãª ˜¥ ¦š¨á­¦¬ (£æ¤¦¤ ˜§¦ bmove_dd)
48239>>>                  If ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number)          Send Operation_Not_Allowed 2007
48242>>>
48242>>>                  //2100:cby = globals
48242>>>                  If ( ;                      (Not(Baxio.Company_Code = Syscurxr.Company_Code)) or;                      (Not(Baxio.Branch_Code  = Syscurxr.Branch_Code )) or;                      (Not(Baxio.Year_Year    = Syscurxr.Year_Year        ));                      )                                                   Send Operation_Not_Allowed 2100
48245>>>               End //«â¢¦ª ¡é› ¡˜ validation
48245>>>>
48245>>>               Function_Return iReturnVal
48246>>>      End_Function //validate_delete
48247>>>
48247>>>
48247>>>//------------------------------------------------------------------
48247>>>    Procedure Define_Fields
48248>>>        Forward Send Define_Fields
48250>>>        //DDB-Generated-Code-Location
48250>>>        //DDB-DefineFieldStart
48250>>>
48250>>>        Set Main_File            To Baxio.File_Number
48251>>>        Set Cascade_Delete_State To FALSE
48252>>>
48252>>>
48252>>>        // Child (Client) file structure................
48252>>>        Send Add_Client_File  Bmove.File_Number
48253>>>
48253>>>        // Parent (Server) file structure...............
48253>>>        Send Add_Server_File  Baxiokat.File_Number
48254>>>
48254>>>        // External (System) file structure.............
48254>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
48255>>>
48255>>>        Define_Auto_Increment  Sysrecb.Baxio_Rec0  To Baxio.Baxio_Rec0
48258>>>
48258>>>        // Field-based properties.......................
48258>>>
48258>>>        // Baxio.Company_Code
48258>>>
48258>>>        // Baxio.Branch_Code
48258>>>
48258>>>        // Baxio.Year_Year
48258>>>
48258>>>        // Baxio.Baxiokat_Code
48258>>>
48258>>>        // Baxio.Baxio_Code
48258>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Code To (SL037(Self))
48259>>>
48259>>>        // Baxio.Baxio_Rec0
48259>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Rec0 To (SL037(Self))
48260>>>
48260>>>        // Baxio.Year_Recr
48260>>>
48260>>>        // Baxio.Baxiokat_Recr
48260>>>
48260>>>        // Baxio.Baxio_Recr
48260>>>
48260>>>        // Baxio.Baxio_Status
48260>>>        Set Field_Value_Table      Field Baxio.Baxio_Status To (Baxio_Status_VT(Self))
48261>>>
48261>>>        // Baxio.Baxio_Place
48261>>>        Set Field_Value_Table      Field Baxio.Baxio_Place To (Baxio_Baxio_Place_VT(Self))
48262>>>
48262>>>        // Baxio.Baxio_File_In
48262>>>        Set Field_Value_Table      Field Baxio.Baxio_File_In To (Bfile_VT(Self))
48263>>>
48263>>>        // Baxio.Baxio_Code_In
48263>>>        //DDB/ Comment_Short       Field Baxio.Baxio_Code_In To "To BIAXIOKAT_FILE ¡˜Ÿ¦¨åœ  «ž¤ ©®œ« ¡ã ¢å©«˜"
48263>>>
48263>>>        // Baxio.Baxio_Epon_In
48263>>>
48263>>>        // Baxio.Baxio_Fpar_In
48263>>>
48263>>>        // Baxio.Baxio_File_Out
48263>>>        Set Field_Value_Table      Field Baxio.Baxio_File_Out To (Bfile_VT(Self))
48264>>>
48264>>>        // Baxio.Baxio_Code_Out
48264>>>
48264>>>        // Baxio.Baxio_Epon_Out
48264>>>
48264>>>        // Baxio.Baxio_Fpar_Out
48264>>>
48264>>>        // Baxio.Baxio_Lfile
48264>>>
48264>>>        // Baxio.Baxio_Lcode
48264>>>        Set Field_Value_Table      Field Baxio.Baxio_Lcode To (Bfile_VT(Self))
48265>>>
48265>>>        // Baxio.Baxio_Lepon
48265>>>
48265>>>        // Baxio.Baxio_Lpar
48265>>>
48265>>>        // Baxio.Baxio_Bank00000
48265>>>        Set Field_Value_Table      Field Baxio.Baxio_Bank00000 To (Baxio_Baxio_Bank_VT(Self))
48266>>>
48266>>>        // Baxio.Baxio_Hmniae
48266>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniae To (SL037(Self))
48267>>>
48267>>>        // Baxio.Baxio_Hmniap000
48267>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniap000 To (SL037(Self))
48268>>>
48268>>>        // Baxio.Baxio_Hmnial
48268>>>        //DDB/ Comment_Short       Field Baxio.Baxio_Hmnial To "†£/¤å˜ Šã¥žª:"
48268>>>
48268>>>        // Baxio.Baxio_Ekdoths
48268>>>
48268>>>        // Baxio.Baxio_Ekdothse
48268>>>
48268>>>        // Baxio.Baxio_Sediatagh
48268>>>
48268>>>        // Baxio.Baxio_Sdiataghe
48268>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Sdiataghe To (SL037(Self))
48269>>>
48269>>>        // Baxio.Baxio_Banka
48269>>>        Set Field_Value_Table      Field Baxio.Baxio_Banka To (Baxio_Baxio_Banka_VT(Self))
48270>>>
48270>>>        // Baxio.Baxio_Opistho
48270>>>
48270>>>        // Baxio.Baxio_No
48270>>>
48270>>>        // Baxio.Baxio_V2
48270>>>
48270>>>        // Baxio.Baxio_V0
48270>>>
48270>>>        // Baxio.Baxio_V00
48270>>>
48270>>>        // Baxio.Baxio_Vr
48270>>>
48270>>>        // Baxio.Baxio_Rate0
48270>>>
48270>>>        // Baxio.Baxio_Rate00
48270>>>
48270>>>        // Baxio.Baxio_Rater
48270>>>
48270>>>        // Baxio.Baxio_C_Code2
48270>>>        Set Field_Entry_msg        Field Baxio.Baxio_C_Code2 To get_Default_Axio_C_Code2
48271>>>        Set Field_Options          Field Baxio.Baxio_C_Code2 To DD_CAPSLOCK   
48272>>>        Set Field_Prompt_Object    Field Baxio.Baxio_C_Code2 To (slNomism(Self))
48273>>>
48273>>>        // Baxio.Baxio_Lixi_Yyyy
48273>>>
48273>>>        // Baxio.Baxio_Lixi_Mm
48273>>>
48273>>>        // Baxio.Baxio_Lixi_Dd
48273>>>
48273>>>        // Baxio.Baxio_Bmove_Laa
48273>>>
48273>>>        // Baxio.Baxio_Desm
48273>>>
48273>>>        // Baxio.Baxio_From
48273>>>        Set Field_Value_Table      Field Baxio.Baxio_From To (Baxio_Baxio_From_VT(Self))
48274>>>
48274>>>        // Baxio.Baxio_Topos
48274>>>        Set Field_Value_Table      Field Baxio.Baxio_Topos To (Baxio_Baxio_Topos_VT1(Self))
48275>>>
48275>>>        //DDB-DefineFieldEnd
48275>>>
48275>>>        Set Main_File            To Baxio.File_Number
48276>>>        Set Cascade_Delete_State To FALSE
48277>>>
48277>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
48278>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
48279>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48280>>>
48280>>>        // Child (Client) file structure................
48280>>>        Send Add_Client_File  Bmove.File_Number
48281>>>
48281>>>        // Parent (Server) file structure...............
48281>>>        Send Add_Server_File  Baxiokat.File_Number
48282>>>
48282>>>        // External (System) file structure.............
48282>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
48283>>>
48283>>>        Define_Auto_Increment  Sysrecb.Baxio_Rec0  To Baxio.Baxio_Rec0
48286>>>
48286>>>        // Field-based properties.......................
48286>>>
48286>>>        // Baxio.Company_Code
48286>>>
48286>>>        // Baxio.Branch_Code
48286>>>
48286>>>        // Baxio.Year_Year
48286>>>
48286>>>        // Baxio.Baxiokat_Code
48286>>>
48286>>>        // Baxio.Baxio_Code
48286>>>        Set Field_Label_Long       Field Baxio.Baxio_Code         To "‰à› ¡æª €¥ ¦š¨á­¦¬"
48287>>>        Set Field_Label_Short      Field Baxio.Baxio_Code         To "‰à› ¡æª"
48288>>>        Set Field_Options          Field Baxio.Baxio_Code         To DD_AUTOFIND    DD_NOPUT
48289>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Code         To (sl037(Self))
48290>>>        Set Key_Field_State        Field Baxio.Baxio_Code         To TRUE
48291>>>
48291>>>        // Baxio.Baxio_Rec0
48291>>>        Set Field_Options          Field Baxio.Baxio_Rec0         To DD_AUTOFIND    DD_REQUIRED
48292>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Rec0         To (sl037(Self))
48293>>>        Set Key_Field_State        Field Baxio.Baxio_Rec0         To TRUE
48294>>>
48294>>>        // Baxio.Year_Rec0
48294>>>
48294>>>        // Baxio.Baxiokat_Rec0
48294>>>
48294>>>        // Baxio.Baxio_Status
48294>>>        Set Field_Class_Name       Field Baxio.Baxio_Status       To "dbComboForm_EZ"
48295>>>        Set Field_Label_Long       Field Baxio.Baxio_Status       To "‰˜«á©«˜©ž"
48296>>>        Set Field_Label_Short      Field Baxio.Baxio_Status       To "‰˜«á©«˜©ž"
48297>>>        Set Field_Options  Field Baxio.Baxio_Status  To DD_DISPLAYONLY
48298>>>        Set Field_Value_Table      Field Baxio.Baxio_Status       To (Baxio_Status_VT(Self))
48299>>>
48299>>>        // Baxio.Baxio_Place
48299>>>        Set Field_Class_Name       Field Baxio.Baxio_Place        To "dbComboForm_EZ"
48300>>>        Set Field_Label_Long       Field Baxio.Baxio_Place        To "„¬¨å©¡œ«˜ "
48301>>>        Set Field_Label_Short      Field Baxio.Baxio_Place        To "„¬¨å©¡œ«˜ "
48302>>>        Set Field_Options          Field Baxio.Baxio_Place        To DD_DISPLAYONLY
48303>>>        Set Field_Value_Table      Field Baxio.Baxio_Place        To (Baxio_Baxio_Place_VT(Self))
48304>>>
48304>>>        // Baxio.Baxio_File_In
48304>>>        Set Field_Value_Table      Field Baxio.Baxio_File_In      To (Bfile_VT(Self))
48305>>>
48305>>>        // Baxio.Baxio_Code_In
48305>>>        Set Field_Label_Long       Field Baxio.Baxio_Code_In      To "˜¨œ¢ã­Ÿž €§æ"
48306>>>        Set Field_Label_Short      Field Baxio.Baxio_Code_In      To "˜¨œ¢ã­Ÿž €§æ"
48307>>>        Set Field_Options          Field Baxio.Baxio_Code_In      To DD_DISPLAYONLY
48308>>>
48308>>>        // Baxio.Baxio_Epon_In
48308>>>        Set Field_Label_Long       Field Baxio.Baxio_Epon_In      To "„§à¤¬£å˜"
48309>>>        Set Field_Label_Short      Field Baxio.Baxio_Epon_In      To "„§à¤¬£å˜"
48310>>>        Set Field_Options          Field Baxio.Baxio_Epon_In      To DD_DISPLAYONLY
48311>>>
48311>>>        // Baxio.Baxio_Fpar_In
48311>>>        Set Field_Label_Long       Field Baxio.Baxio_Fpar_In      To "˜¨/¡æ ˜¨˜¢˜™ãª"
48312>>>        Set Field_Label_Short      Field Baxio.Baxio_Fpar_In      To "˜¨/¡æ ˜¨˜¢."
48313>>>        Set Field_Options          Field Baxio.Baxio_Fpar_In      To DD_DISPLAYONLY
48314>>>
48314>>>        // Baxio.Baxio_File_Out
48314>>>        Set Field_Value_Table      Field Baxio.Baxio_File_Out     To (Bfile_VT(Self))
48315>>>
48315>>>        // Baxio.Baxio_Code_Out
48315>>>        Set Field_Label_Long       Field Baxio.Baxio_Code_Out     To "¨é«¦ª ˜¨˜¢ã§«žª"
48316>>>        Set Field_Label_Short      Field Baxio.Baxio_Code_Out     To "¨é«¦ª ˜¨˜¢ã§«žª"
48317>>>        Set Field_Options          Field Baxio.Baxio_Code_Out     To DD_DISPLAYONLY
48318>>>
48318>>>        // Baxio.Baxio_Epon_Out
48318>>>        Set Field_Label_Long       Field Baxio.Baxio_Epon_Out     To "„§à¤¬£å˜"
48319>>>        Set Field_Label_Short      Field Baxio.Baxio_Epon_Out     To "„§à¤¬£å˜"
48320>>>        Set Field_Options          Field Baxio.Baxio_Epon_Out     To DD_DISPLAYONLY
48321>>>
48321>>>        // Baxio.Baxio_Fpar_Out
48321>>>        Set Field_Options          Field Baxio.Baxio_Fpar_Out     To DD_DISPLAYONLY
48322>>>
48322>>>        // Baxio.Baxio_Lfile
48322>>>        Set Field_Value_Table      Field Baxio.Baxio_Lfile        To (Bfile_VT(Self))
48323>>>
48323>>>        // Baxio.Baxio_Lcode
48323>>>        Set Field_Label_Long       Field Baxio.Baxio_Lcode        To "’œ¢œ¬«˜å¦ª ˜¨˜¢ã§«žª"
48324>>>        Set Field_Label_Short      Field Baxio.Baxio_Lcode        To "’œ¢.˜¨˜¢ã§«žª"
48325>>>        Set Field_Options          Field Baxio.Baxio_Lcode        To DD_DISPLAYONLY
48326>>>
48326>>>        // Baxio.Baxio_Lepon
48326>>>        Set Field_Options          Field Baxio.Baxio_Lepon        To DD_DISPLAYONLY
48327>>>
48327>>>        // Baxio.Baxio_Lpar
48327>>>        Set Field_Label_Long       Field Baxio.Baxio_Lpar         To "˜¨/¡æ ˜¨á›¦©žª"
48328>>>        Set Field_Label_Short      Field Baxio.Baxio_Lpar         To "˜¨/¡æ ˜¨á›¦©žª"
48329>>>        Set Field_Options          Field Baxio.Baxio_Lpar         To DD_DISPLAYONLY
48330>>>
48330>>>        // Baxio.Baxio_Bank00000
48330>>>        Set Field_Class_Name       Field Baxio.Baxio_Bank00000    To "dbComboForm_EZ"
48331>>>        Set Field_Value_Table      Field Baxio.Baxio_Bank00000    To (Baxio_Baxio_Bank_VT(Self))
48332>>>
48332>>>        // Baxio.Baxio_Hmniae
48332>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmniae       To "dbSpinForm_EZ"
48333>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmniae       To "†£/¤å˜ „¡›¦©žª"
48334>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmniae       To "†£/¤å˜ „¡›¦©žª"
48335>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniae       To (sl037(Self))
48336>>>
48336>>>        // Baxio.Baxio_Hmniap000
48336>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmniap000    To "dbSpinForm_EZ"
48337>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmniap000    To "†£/¤å˜ ˜¨˜¢˜™ãª"
48338>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmniap000    To "†£/¤å˜ ˜¨˜¢˜™ãª"
48339>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniap000    To (sl037(Self))
48340>>>
48340>>>        // Baxio.Baxio_Hmnial
48340>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmnial       To "dbSpinForm_EZ"
48341>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmnial       To "†£/¤å˜ Šã¥žª"
48342>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmnial       To "†£/¤å˜ Šã¥žª"
48343>>>        Set Field_Options          Field Baxio.Baxio_Hmnial       To DD_REQUIRED
48344>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmnial       To (sl037(Self))
48345>>>
48345>>>        // Baxio.Baxio_Ekdoths
48345>>>        Set Field_Label_Long       Field Baxio.Baxio_Ekdoths      To "€¨® ¡æª „¡›æ«žª"
48346>>>        Set Field_Label_Short      Field Baxio.Baxio_Ekdoths      To "€¨®.„¡›æ«žª"
48347>>>
48347>>>        // Baxio.Baxio_Ekdothse
48347>>>        Set Field_Label_Long       Field Baxio.Baxio_Ekdothse     To "„§à¤¬£å˜ €¨® ¡¦ç „¡›æ«ž"
48348>>>        Set Field_Label_Short      Field Baxio.Baxio_Ekdothse     To "„§à¤¬£å˜"
48349>>>
48349>>>        // Baxio.Baxio_Sediatagh
48349>>>        Set Field_Label_Long       Field Baxio.Baxio_Sediatagh    To "‘œ ƒ ˜«˜šã"
48350>>>        Set Field_Label_Short      Field Baxio.Baxio_Sediatagh    To "‘œ ƒ ˜«˜šã"
48351>>>
48351>>>        // Baxio.Baxio_Sdiataghe
48351>>>        Set Field_Label_Long       Field Baxio.Baxio_Sdiataghe    To "„§à¤¬£å˜ €¨® ¡¦ç ƒ ¡˜ ¦ç®¦¬"
48352>>>        Set Field_Label_Short      Field Baxio.Baxio_Sdiataghe    To "„§à¤¬£å˜"
48353>>>
48353>>>        // Baxio.Baxio_Banka
48353>>>        Set Field_Class_Name       Field Baxio.Baxio_Banka        To "dbComboForm_EZ"
48354>>>        Set Field_Label_Long       Field Baxio.Baxio_Banka        To "’¨á§œ˜"
48355>>>        Set Field_Label_Short      Field Baxio.Baxio_Banka        To "’¨á§œ˜"
48356>>>        Set Field_Value_Table      Field Baxio.Baxio_Banka        To (Baxio_Baxio_Banka_VT(Self))
48357>>>
48357>>>        // Baxio.Baxio_Opistho
48357>>>        Set Field_Label_Long       Field Baxio.Baxio_Opistho      To "Š¦ §¦å Ž§ ©Ÿ¦š¨á­¦ "
48358>>>
48358>>>        // Baxio.Baxio_No
48358>>>        Set Field_Label_Long       Field Baxio.Baxio_No           To "€¨ Ÿ£æª"
48359>>>        Set Field_Label_Short      Field Baxio.Baxio_No           To "€¨ Ÿ£æª"
48360>>>
48360>>>        // Baxio.Baxio_V2
48360>>>        Set Field_Label_Long       Field Baxio.Baxio_V2           To "¦©æ"
48361>>>        Set Field_Label_Short      Field Baxio.Baxio_V2           To "¦©æ"
48362>>>        Set Field_Options          Field Baxio.Baxio_V2           To DD_REQUIRED
48363>>>
48363>>>        // Baxio.Baxio_V0
48363>>>        Set Field_Label_Long       Field Baxio.Baxio_V0           To "¦©æ ‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª"
48364>>>        Set Field_Label_Short      Field Baxio.Baxio_V0           To "¦©æ(‰¬¨. Œæ£.•¨.)"
48365>>>
48365>>>        // Baxio.Baxio_V00
48365>>>        Set Field_Label_Long       Field Baxio.Baxio_V00          To "¦©æ ƒœ¬«œ¨œç¦¤  Œæ£ ©£˜ •¨ã©œàª"
48366>>>        Set Field_Label_Short      Field Baxio.Baxio_V00          To "¦©æ(ƒœ¬«. Œæ£.•¨.)"
48367>>>
48367>>>        // Baxio.Baxio_Vr
48367>>>        Set Field_Label_Long       Field Baxio.Baxio_Vr           To "¦©æ Œæ£ ©£˜ Reporting"
48368>>>        Set Field_Label_Short      Field Baxio.Baxio_Vr           To "¦©æ( Œæ£.Rep.)"
48369>>>
48369>>>        // Baxio.Baxio_Rate0
48369>>>        Set Field_Label_Long       Field Baxio.Baxio_Rate0        To "Rate 1"
48370>>>        Set Field_Label_Short      Field Baxio.Baxio_Rate0        To "Rate 1"
48371>>>
48371>>>        // Baxio.Baxio_Rate00
48371>>>        Set Field_Label_Long       Field Baxio.Baxio_Rate00       To "Rate 2"
48372>>>        Set Field_Label_Short      Field Baxio.Baxio_Rate00       To "Rate 2"
48373>>>
48373>>>        // Baxio.Baxio_Rater
48373>>>        Set Field_Label_Long       Field Baxio.Baxio_Rater        To "Rate 3"
48374>>>        Set Field_Label_Short      Field Baxio.Baxio_Rater        To "Rate 3"
48375>>>
48375>>>        // Baxio.Baxio_C_Code2
48375>>>        Set Field_Class_Name       Field Baxio.Baxio_C_Code2      To "dbComboForm_EZ"
48376>>>        Set Field_Label_Long       Field Baxio.Baxio_C_Code2      To "Œæ£ ©£˜"
48377>>>        Set Field_Label_Short      Field Baxio.Baxio_C_Code2      To "Œæ£ ©£˜"
48378>>>        Set Field_Options          Field Baxio.Baxio_C_Code2      To DD_REQUIRED
48379>>>
48379>>>        // Baxio.Baxio_Lixi_Yyyy
48379>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Yyyy    To DD_DISPLAYONLY
48380>>>
48380>>>        // Baxio.Baxio_Lixi_Mm
48380>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Mm      To DD_DISPLAYONLY
48381>>>
48381>>>        // Baxio.Baxio_Lixi_Dd
48381>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Dd      To DD_DISPLAYONLY
48382>>>
48382>>>        // Baxio.Baxio_Bmove_Laa
48382>>>        Set Field_Options          Field Baxio.Baxio_Bmove_Laa    To DD_DISPLAYONLY
48383>>>
48383>>>    End_Procedure    // Define_Fields
48384>>>
48384>>>
48384>>>    Procedure Field_Defaults
48385>>>        Forward Send Field_Defaults
48387>>>        //DDB-Generated-Code-Location
48387>>>        //DDB-FieldDefaultStart
48387>>>        Set Field_Changed_Value   Field Baxio.Baxio_Status To 1
48388>>>        Set Field_Changed_Value   Field Baxio.Baxio_Place To 1
48389>>>        //DDB-FieldDefaultEnd
48389>>>    End_Procedure    // Field_Defaults
48390>>>
48390>>>End_Class    // Baxio_DataDictionary
48391>>>//DDB-Selection-pkg-Start
48391>>>
48391>>>Use SL037.SL         // SL037
INCLUDING FILE: SL037.SL
48391>>>>>//AB/ Project SL037:BAXIO
48391>>>>>//AB/ Object prj is a Lookup_Project
48391>>>>>//AB/     Set ProjectName to "SL037:BAXIO"
48391>>>>>//AB/     Set ProjectFileName to "SL037.SL"
48391>>>>>
48391>>>>>// Project Object Structure
48391>>>>>//   SL037 is a dbModalPanelSub
48391>>>>>//     Baxiokat_DD is a DataDictionary
48391>>>>>//     Baxio_DD is a DataDictionary
48391>>>>>//     oSelList is a dbListSub
48391>>>>>//     TextBoxSub1 is a TextBoxSub
48391>>>>>//     cSyDateForm1 is a cSyDateForm
48391>>>>>//     TextBoxSub2 is a TextBoxSub
48391>>>>>//     cSyDateForm2 is a cSyDateForm
48391>>>>>//     TextBoxSub4 is a TextBoxSub
48391>>>>>//     TextBoxSub5 is a TextBoxSub
48391>>>>>//     FormSub1 is a FormSub
48391>>>>>//     FormSub2 is a FormSub
48391>>>>>//     FormSub3 is a FormSub
48391>>>>>//     FormSub4 is a FormSub
48391>>>>>//     ButtonSub1 is a ButtonSub
48391>>>>>//     oOK_bn is a ButtonSub
48391>>>>>
48391>>>>>// Register all objects
48391>>>>>Register_Object Baxio_DD
48391>>>>>Register_Object Baxiokat_DD
48391>>>>>Register_Object ButtonSub1
48391>>>>>Register_Object cSyDateForm1
48391>>>>>Register_Object cSyDateForm2
48391>>>>>Register_Object FormSub1
48391>>>>>Register_Object FormSub2
48391>>>>>Register_Object FormSub3
48391>>>>>Register_Object FormSub4
48391>>>>>Register_Object oOK_bn
48391>>>>>Register_Object oSelList
48391>>>>>Register_Object SL037
48391>>>>>Register_Object TextBoxSub1
48391>>>>>Register_Object TextBoxSub2
48391>>>>>Register_Object TextBoxSub4
48391>>>>>Register_Object TextBoxSub5
48391>>>>>
48391>>>>>
48391>>>>>
48391>>>>>//AB-StoreTopStart
48391>>>>>    
48391>>>>>Use sl100.sl
48391>>>>>
48391>>>>>
48391>>>>>//AB-StoreTopEnd
48391>>>>>
48391>>>>>//AB-IgnoreStart
48391>>>>>
48391>>>>>Use DFAllEnt.pkg
48391>>>>>Use dbList.Sub
48391>>>>>Use Txtbox.Sub
48391>>>>>Use cSyDateForm.Pkg
INCLUDING FILE: CSYDATEFORM.PKG
48391>>>>>>>Use cSyDateIntelliMix.pkg
INCLUDING FILE: CSYDATEINTELLIMIX.PKG
48391>>>>>>>>>Use cOutlook.Sl // Needed for date prompt.
INCLUDING FILE: COUTLOOK.SL
48391>>>>>>>>>>>//AB/ Project Calendar Outlook
48391>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
48391>>>>>>>>>>>//AB/         Set ProjectName to "Calendar Outlook"
48391>>>>>>>>>>>//AB/         Set ProjectFileName to "coutlook.sl"
48391>>>>>>>>>>>
48391>>>>>>>>>>>// Project Object Structure
48391>>>>>>>>>>>//   oCalendar is a BasicPanelSub
48391>>>>>>>>>>>//     Container3d1 is a Container3d
48391>>>>>>>>>>>//       Grid2 is a Grid
48391>>>>>>>>>>>//         cOutlookFloatingMenu is a FloatingPopupMenu
48391>>>>>>>>>>>//       Textbox2 is a Textbox
48391>>>>>>>>>>>//       Textbox3 is a Textbox
48391>>>>>>>>>>>//       Textbox4 is a Textbox
48391>>>>>>>>>>>//       Textbox5 is a Textbox
48391>>>>>>>>>>>//       Textbox6 is a Textbox
48391>>>>>>>>>>>//       Textbox7 is a Textbox
48391>>>>>>>>>>>//       Textbox8 is a Textbox
48391>>>>>>>>>>>//       LineControl1 is a LineControl
48391>>>>>>>>>>>//       Container3d2 is a Container3d
48391>>>>>>>>>>>//         oRght is a BitmapContainer
48391>>>>>>>>>>>//         oLeft is a BitmapContainer
48391>>>>>>>>>>>//         oMonth is a Textbox
48391>>>>>>>>>>>//           oSelectMonth is a FloatingPopupMenu
48391>>>>>>>>>>>//         oCalendarYear is a Textbox
48391>>>>>>>>>>>//         oSelectCalendarYear is a Form
48391>>>>>>>>>>>//     BitmapContainer3 is a BitmapContainer
48391>>>>>>>>>>>//     oToday is a Textbox
48391>>>>>>>>>>>//     oCloseCalendar_bn is a BitmapContainer
48391>>>>>>>>>>>//     Help_Container is a Container3d
48391>>>>>>>>>>>//       Help_Info is a Edit
48391>>>>>>>>>>>//         HelpFloatingMenu is a FloatingPopupMenu
48391>>>>>>>>>>>
48391>>>>>>>>>>>// Register all objects
48391>>>>>>>>>>>Register_Object BitmapContainer3
48391>>>>>>>>>>>Register_Object Container3d1
48391>>>>>>>>>>>Register_Object Container3d2
48391>>>>>>>>>>>Register_Object cOutlookFloatingMenu
48391>>>>>>>>>>>Register_Object Grid2
48391>>>>>>>>>>>Register_Object Help_Container
48391>>>>>>>>>>>Register_Object Help_Info
48391>>>>>>>>>>>Register_Object HelpFloatingMenu
48391>>>>>>>>>>>Register_Object LineControl1
48391>>>>>>>>>>>Register_Object oCalendar
48391>>>>>>>>>>>Register_Object oCalendarYear
48391>>>>>>>>>>>Register_Object oCloseCalendar_bn
48391>>>>>>>>>>>Register_Object oLeft
48391>>>>>>>>>>>Register_Object oMonth
48391>>>>>>>>>>>Register_Object oRght
48391>>>>>>>>>>>Register_Object oSelectCalendarYear
48391>>>>>>>>>>>Register_Object oSelectMonth
48391>>>>>>>>>>>Register_Object oToday
48391>>>>>>>>>>>Register_Object Textbox2
48391>>>>>>>>>>>Register_Object Textbox3
48391>>>>>>>>>>>Register_Object Textbox4
48391>>>>>>>>>>>Register_Object Textbox5
48391>>>>>>>>>>>Register_Object Textbox6
48391>>>>>>>>>>>Register_Object Textbox7
48391>>>>>>>>>>>Register_Object Textbox8
48391>>>>>>>>>>>
48391>>>>>>>>>>>
48391>>>>>>>>>>>
48391>>>>>>>>>>>    //AB-StoreTopStart
48391>>>>>>>>>>>    Use dates.utl
48391>>>>>>>>>>>
48391>>>>>>>>>>>
48391>>>>>>>>>>>    //AB-StoreTopEnd
48391>>>>>>>>>>>
48391>>>>>>>>>>>    //AB-IgnoreStart
48391>>>>>>>>>>>
48391>>>>>>>>>>>    Use Panel.Sub
48391>>>>>>>>>>>    Use DFAllEnt.pkg
48391>>>>>>>>>>>
48391>>>>>>>>>>>
48391>>>>>>>>>>>
48391>>>>>>>>>>>    //AB-IgnoreEnd
48391>>>>>>>>>>>
48391>>>>>>>>>>>    Object oCalendar is a BasicPanelSub
48393>>>>>>>>>>>        Set Border_Style to Border_Normal
48394>>>>>>>>>>>        Set Caption_Bar to FALSE
48395>>>>>>>>>>>        Set Label to "January, 2001"
48396>>>>>>>>>>>        Set Size to 98 123
48397>>>>>>>>>>>        Set Location to 10 22
48398>>>>>>>>>>>        Set Color to clWhite
48399>>>>>>>>>>>        Set Exit_Application_Local_State to TRUE
48400>>>>>>>>>>>        Set Popup_State to TRUE
48401>>>>>>>>>>>
48401>>>>>>>>>>>        //AB-DDOStart
48401>>>>>>>>>>>
48401>>>>>>>>>>>
48401>>>>>>>>>>>        //AB-DDOEnd
48401>>>>>>>>>>>
48401>>>>>>>>>>>        Object Container3d1 is a Container3d
48403>>>>>>>>>>>            Set Size to 88 135
48404>>>>>>>>>>>            Set Location to -2 -1
48405>>>>>>>>>>>            Set Color to clWhite
48406>>>>>>>>>>>            Set Border_Style to Border_None
48407>>>>>>>>>>>            Object Grid2 is a Grid
48409>>>>>>>>>>>
48409>>>>>>>>>>>                //AB-StoreTopStart
48409>>>>>>>>>>>                property date    p_current_date     0
48411>>>>>>>>>>>                property integer p_current_year     -1
48413>>>>>>>>>>>                property integer p_current_month    -1
48415>>>>>>>>>>>                property integer p_selected_day     -1
48417>>>>>>>>>>>                property integer pExportState       1
48419>>>>>>>>>>>                property integer invoking_object_id 0
48421>>>>>>>>>>>                Property integer piCurrentDayItem   -1
48423>>>>>>>>>>>
48423>>>>>>>>>>>                Set Border_Style To BORDER_NONE
48424>>>>>>>>>>>                Set header_visible_state To False
48425>>>>>>>>>>>                set select_mode to no_select
48426>>>>>>>>>>>                Set Gridline_mode To GRID_VISIBLE_NONE
48427>>>>>>>>>>>
48427>>>>>>>>>>>                on_key Key_F1 Send Help
48428>>>>>>>>>>>                on_key key_ctrl+key_pgup send prev_year
48429>>>>>>>>>>>                on_key key_ctrl+key_pgdn send next_year
48430>>>>>>>>>>>                on_key          key_pgup send prev_month
48431>>>>>>>>>>>                on_key          key_pgdn send next_month
48432>>>>>>>>>>>                on_key key_enter         send move_value_out
48433>>>>>>>>>>>                on_key key_ctrl+key_d    send go_today
48434>>>>>>>>>>>                on_key key_ctrl+key_y    send Change_Year
48435>>>>>>>>>>>
48435>>>>>>>>>>>                //AB-StoreTopEnd
48435>>>>>>>>>>>
48435>>>>>>>>>>>                Set Color to clWhite
48436>>>>>>>>>>>                Set CurrentCellColor to clWhite
48437>>>>>>>>>>>                Set CurrentCellTextColor to clWhite
48438>>>>>>>>>>>                Set Size to 61 145
48439>>>>>>>>>>>                Set Location to 30 1
48440>>>>>>>>>>>                Set Resize_Column_state to FALSE
48441>>>>>>>>>>>
48441>>>>>>>>>>>                Set Line_Width to 7 0
48442>>>>>>>>>>>
48442>>>>>>>>>>>                Set Form_Width    item 0 to 18
48443>>>>>>>>>>>                Set Header_Label  item 0 to "Mo"
48444>>>>>>>>>>>
48444>>>>>>>>>>>                Set Form_Width    item 1 to 18
48445>>>>>>>>>>>                Set Header_Label  item 1 to "Tu"
48446>>>>>>>>>>>
48446>>>>>>>>>>>                Set Form_Width    item 2 to 18
48447>>>>>>>>>>>                Set Header_Label  item 2 to "We"
48448>>>>>>>>>>>
48448>>>>>>>>>>>                Set Form_Width    item 3 to 18
48449>>>>>>>>>>>                Set Header_Label  item 3 to "Th"
48450>>>>>>>>>>>
48450>>>>>>>>>>>                Set Form_Width    item 4 to 18
48451>>>>>>>>>>>                Set Header_Label  item 4 to "Fr"
48452>>>>>>>>>>>
48452>>>>>>>>>>>                Set Form_Width    item 5 to 18
48453>>>>>>>>>>>                Set Header_Label  item 5 to "Sa"
48454>>>>>>>>>>>
48454>>>>>>>>>>>                Set Form_Width    item 6 to 18
48455>>>>>>>>>>>                Set Header_Label  item 6 to "Su"
48456>>>>>>>>>>>
48456>>>>>>>>>>>
48456>>>>>>>>>>>                //AB-StoreStart
48456>>>>>>>>>>>
48456>>>>>>>>>>>                Procedure Change_Year
48458>>>>>>>>>>>                    Send Mouse_Down to (oCalendarYear(Container3d2(Self)))
48459>>>>>>>>>>>                End_Procedure // Change_Year
48460>>>>>>>>>>>
48460>>>>>>>>>>>                procedure go_today
48462>>>>>>>>>>>                    Date date#
48463>>>>>>>>>>>                    sysdate4 date#
48464>>>>>>>>>>>                    set p_current_date to date#
48465>>>>>>>>>>>                    Send Update_Calendar
48466>>>>>>>>>>>                end_procedure
48467>>>>>>>>>>>
48467>>>>>>>>>>>                procedure next_month
48469>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
48470>>>>>>>>>>>                    Send Update_Calendar
48471>>>>>>>>>>>                end_procedure
48472>>>>>>>>>>>
48472>>>>>>>>>>>                procedure prev_month
48474>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
48475>>>>>>>>>>>                    Send Update_Calendar
48476>>>>>>>>>>>                end_procedure
48477>>>>>>>>>>>
48477>>>>>>>>>>>                procedure next_year
48479>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
48480>>>>>>>>>>>                    Send Update_Calendar
48481>>>>>>>>>>>                end_procedure
48482>>>>>>>>>>>
48482>>>>>>>>>>>                procedure prev_year
48484>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
48485>>>>>>>>>>>                    Send Update_Calendar
48486>>>>>>>>>>>                end_procedure
48487>>>>>>>>>>>
48487>>>>>>>>>>>                Procedure Activate
48489>>>>>>>>>>>                    Date date#
48490>>>>>>>>>>>                    Forward Send Activate
48492>>>>>>>>>>>                    Set current_item to (p_selected_day(Self))
48493>>>>>>>>>>>                End_Procedure
48494>>>>>>>>>>>
48494>>>>>>>>>>>                Procedure Update_Calendar
48496>>>>>>>>>>>                    Set Dynamic_Update_State To False
48497>>>>>>>>>>>                    send Fill_List
48498>>>>>>>>>>>                    Set Dynamic_Update_State To True
48499>>>>>>>>>>>                    // Send Update_Label
48499>>>>>>>>>>>                    Set current_item to (p_selected_day(Self))
48500>>>>>>>>>>>                    Send Date_Changing to (oCalendarYear(Container3d2(self)))
48501>>>>>>>>>>>                    Send Date_Changing to (oMonth(Container3d2(self)))
48502>>>>>>>>>>>                End_Procedure
48503>>>>>>>>>>>
48503>>>>>>>>>>>                Procedure Fill_List
48505>>>>>>>>>>>                    Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
48506>>>>>>>>>>>                    Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
48506>>>>>>>>>>>                    Date dToday
48506>>>>>>>>>>>                    Send Delete_Data
48507>>>>>>>>>>>
48507>>>>>>>>>>>                    Get p_current_date to date#
48508>>>>>>>>>>>
48508>>>>>>>>>>>                    SysDate4 dToday
48509>>>>>>>>>>>                    move (DateSegment(dToday,DS_DAY)) to cur_day#
48510>>>>>>>>>>>                    move (DateSegment(dToday,DS_MONTH)) to cur_month#
48511>>>>>>>>>>>                    move (DateSegment(dToday,DS_YEAR)) to cur_year#
48512>>>>>>>>>>>
48512>>>>>>>>>>>                    move (DateSegment(date#,DS_DAY)) to sel_day#
48513>>>>>>>>>>>                    move (DateSegment(date#,DS_MONTH)) to sel_month#
48514>>>>>>>>>>>                    move (DateSegment(date#,DS_YEAR)) to sel_year#
48515>>>>>>>>>>>                    Set p_current_month To sel_month#
48516>>>>>>>>>>>                    Set p_current_year To sel_year#
48517>>>>>>>>>>>
48517>>>>>>>>>>>                    move (FirstDayInMonth(date#)) to date#
48518>>>>>>>>>>>                    move (DateDayNumber(date#)-1) to first_item#
48519>>>>>>>>>>>                    move (LastDayInMonth(date#)-date#+first_item#) to last_item#
48520>>>>>>>>>>>                    move (DateIncrement(date#,DS_Month,-1)) To prevdate#
48521>>>>>>>>>>>                    move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
48522>>>>>>>>>>>
48522>>>>>>>>>>>                    If (first_item# > 0) Begin
48524>>>>>>>>>>>                        Move (first_item#-1) to day#
48525>>>>>>>>>>>                        For iFor from 0 to (first_item#-1)
48531>>>>>>>>>>>>
48531>>>>>>>>>>>                            Send Add_Item msg_move_value_out (prev_last#-day#)
48532>>>>>>>>>>>                            Set Entry_State Item iFor To False
48533>>>>>>>>>>>                            Set ItemTextColor Item iFor To clGray
48534>>>>>>>>>>>                            Decrement day#
48535>>>>>>>>>>>                        Loop
48536>>>>>>>>>>>>
48536>>>>>>>>>>>                    End
48536>>>>>>>>>>>>
48536>>>>>>>>>>>
48536>>>>>>>>>>>                    Move 1 To day#
48537>>>>>>>>>>>                    For iFor from first_item# to last_item#
48543>>>>>>>>>>>>
48543>>>>>>>>>>>                        Send Add_Item Msg_Move_Value_Out day#
48544>>>>>>>>>>>                        Set Entry_State Item iFor To False
48545>>>>>>>>>>>                        If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Begin
48547>>>>>>>>>>>                            Set Form_Bitmap Item iFor To "cdate.bmp"
48548>>>>>>>>>>>                            Set piCurrentDayItem to iFor
48549>>>>>>>>>>>                        End
48549>>>>>>>>>>>>
48549>>>>>>>>>>>                        If Day# eq sel_day# Set p_selected_day To iFor
48552>>>>>>>>>>>                        Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
48553>>>>>>>>>>>                        Set form_datatype item iFor To mask_numeric_window
48554>>>>>>>>>>>                        Set form_Mask item iFor To "## "
48555>>>>>>>>>>>                        Increment day#
48556>>>>>>>>>>>                    Loop
48557>>>>>>>>>>>>
48557>>>>>>>>>>>
48557>>>>>>>>>>>                    move (DateIncrement(date#,DS_Month,1)) To nextdate#
48558>>>>>>>>>>>                    move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
48559>>>>>>>>>>>
48559>>>>>>>>>>>                    If (last_item# < 41) Begin
48561>>>>>>>>>>>                        Move 1 to day#
48562>>>>>>>>>>>                        For iFor from (last_item#+1) to 41
48568>>>>>>>>>>>>
48568>>>>>>>>>>>                            Send Add_Item msg_move_value_out day#
48569>>>>>>>>>>>                            Set Entry_State Item iFor To False
48570>>>>>>>>>>>                            Set ItemTextColor Item iFor To clGray
48571>>>>>>>>>>>                            Increment day#
48572>>>>>>>>>>>                        Loop
48573>>>>>>>>>>>>
48573>>>>>>>>>>>                    End
48573>>>>>>>>>>>>
48573>>>>>>>>>>>
48573>>>>>>>>>>>                End_Procedure
48574>>>>>>>>>>>
48574>>>>>>>>>>>                Procedure Help
48576>>>>>>>>>>>                    //Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<Y> - select year.\n<Ctrl>+<PgUp>, <PgDn> - Select year.") ("Help on Calendar")
48576>>>>>>>>>>>                    Set Visible_State of Help_Container to True
48577>>>>>>>>>>>                    Set Enabled_State of Help_Container to True
48578>>>>>>>>>>>                    Send Activate to Help_Container
48579>>>>>>>>>>>                End_Procedure
48580>>>>>>>>>>>
48580>>>>>>>>>>>                procedure mouse_click integer window integer char_pos
48582>>>>>>>>>>>                    Send Move_Value_Out
48583>>>>>>>>>>>                    forward send mouse_click window char_pos
48585>>>>>>>>>>>                end_procedure
48586>>>>>>>>>>>
48586>>>>>>>>>>>                Procedure Move_Value_Out
48588>>>>>>>>>>>                    Integer iYear iMonth iDay iItm
48589>>>>>>>>>>>                    Date Date# next_date# prev_date#
48589>>>>>>>>>>>                    Get Current_Item To iItm
48590>>>>>>>>>>>                    If (pExportState(Self)) Begin
48592>>>>>>>>>>>                        Get Value Item iItm To iDay
48593>>>>>>>>>>>                        Get p_current_month to iMonth
48594>>>>>>>>>>>                        Get p_current_year  to iYear
48595>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
48596>>>>>>>>>>>
48596>>>>>>>>>>>                        If ((iItm>27)and(iDay<15)) Begin
48598>>>>>>>>>>>                            Move (DateCompose(1,iMonth,iYear)) To next_date#
48599>>>>>>>>>>>                            move (DateIncrement(next_date#,DS_Month,1)) To next_date#
48600>>>>>>>>>>>                            move (DateSegment(next_date#,DS_MONTH)) to iMonth
48601>>>>>>>>>>>                            move (DateSegment(next_date#,DS_YEAR)) to iYear
48602>>>>>>>>>>>                            move (DateCompose(iDay,iMonth,iYear)) to date#
48603>>>>>>>>>>>                        End
48603>>>>>>>>>>>>
48603>>>>>>>>>>>                        If ((iItm<7)and(iDay>20)) Begin
48605>>>>>>>>>>>                            Move (DateCompose(1,iMonth,iYear)) To prev_date#
48606>>>>>>>>>>>                            move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
48607>>>>>>>>>>>                            move (DateSegment(prev_date#,DS_MONTH)) to iMonth
48608>>>>>>>>>>>                            move (DateSegment(prev_date#,DS_YEAR)) to iYear
48609>>>>>>>>>>>                            move (DateCompose(iDay,iMonth,iYear)) to date#
48610>>>>>>>>>>>                        End
48610>>>>>>>>>>>>
48610>>>>>>>>>>>
48610>>>>>>>>>>>                        Send Export_Date date#
48611>>>>>>>>>>>                    End
48611>>>>>>>>>>>>
48611>>>>>>>>>>>                End_Procedure
48612>>>>>>>>>>>
48612>>>>>>>>>>>                Procedure Export_Date date date#
48614>>>>>>>>>>>                    local integer focus# dm# margin# datatype#
48615>>>>>>>>>>>                    get invoking_object_id to focus#
48616>>>>>>>>>>>
48616>>>>>>>>>>>                    if focus# gt desktop begin
48618>>>>>>>>>>>                         get delegation_mode of focus# to dm#
48619>>>>>>>>>>>                         set delegation_mode of focus# to no_delegate_or_error
48620>>>>>>>>>>>                         get form_margin of focus# item current to margin#
48621>>>>>>>>>>>                         get form_datatype of focus# item current to datatype#
48622>>>>>>>>>>>                         set delegation_mode of focus# to dm#
48623>>>>>>>>>>>                         if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
48626>>>>>>>>>>>                         else             set value of focus# item current to (Date4to2(date#))
48628>>>>>>>>>>>                         set item_changed_state of focus# item current to true
48629>>>>>>>>>>>                    end
48629>>>>>>>>>>>>
48629>>>>>>>>>>>                    Send Close_Calendar
48630>>>>>>>>>>>                End_Procedure
48631>>>>>>>>>>>
48631>>>>>>>>>>>                Object cOutlookFloatingMenu is a FloatingPopupMenu
48633>>>>>>>>>>>
48633>>>>>>>>>>>                    Procedure Close_Calendar
48635>>>>>>>>>>>                        Send Close_Calendar to (oCalendar(Self))
48636>>>>>>>>>>>                    End_Procedure // Close_Calendar
48637>>>>>>>>>>>
48637>>>>>>>>>>>                    Send Add_item msg_go_today         t.calendar.today
48638>>>>>>>>>>>                    Send Add_item msg_None             ""
48639>>>>>>>>>>>                    Send Add_Item msg_prev_year        t.calendar.PrevYear
48640>>>>>>>>>>>                    Send Add_Item msg_next_year        t.calendar.NextYear
48641>>>>>>>>>>>                    Send Add_Item msg_prev_month       t.calendar.PrevMonth
48642>>>>>>>>>>>                    Send Add_Item msg_next_month       t.calendar.NextMonth
48643>>>>>>>>>>>                    Send Add_item msg_None             ""
48644>>>>>>>>>>>                    Send Add_Item msg_move_value_out   t.calendar.Select
48645>>>>>>>>>>>                    Send Add_item msg_None             ""
48646>>>>>>>>>>>                    Send Add_item msg_Close_Calendar   t.calendar.Cancel
48647>>>>>>>>>>>                End_Object // cOutlookFloatingMenu
48648>>>>>>>>>>>
48648>>>>>>>>>>>                Set floating_menu_object to (cOutlookFloatingMenu(Self))
48649>>>>>>>>>>>
48649>>>>>>>>>>>                procedure item_change integer fromi integer toi returns integer
48651>>>>>>>>>>>                    Integer new_item liMonth
48652>>>>>>>>>>>                    Date    ldSysdate
48652>>>>>>>>>>>                    forward get msg_item_change fromi toi to new_item
48654>>>>>>>>>>>                    If (Focus(Desktop) = Self) Begin
48656>>>>>>>>>>>                        If (new_item >= 0) Begin
48658>>>>>>>>>>>                            Sysdate4 ldSysdate
48659>>>>>>>>>>>                            Move (TheMonthSegment(ldSysdate)) to liMonth
48660>>>>>>>>>>>                            If ((p_current_month(Self) = liMonth) and (piCurrentDayItem(Self) = fromi)) Set Form_Bitmap Item fromi to "Cdate.bmp"
48663>>>>>>>>>>>                            Else Set Form_Bitmap Item fromi to ""
48665>>>>>>>>>>>                            If (((p_current_month(Self) = liMonth) and (piCurrentDayItem(Self) <> new_item)) or;                                 (p_current_month(Self) <> liMonth)) Set Form_Bitmap Item new_item   to "Cdate1.bmp"
48668>>>>>>>>>>>                        End
48668>>>>>>>>>>>>
48668>>>>>>>>>>>                    End
48668>>>>>>>>>>>>
48668>>>>>>>>>>>                    procedure_return new_item
48669>>>>>>>>>>>                End_Procedure // Current_Item
48670>>>>>>>>>>>
48670>>>>>>>>>>>
48670>>>>>>>>>>>
48670>>>>>>>>>>>                //AB-StoreEnd
48670>>>>>>>>>>>
48670>>>>>>>>>>>            End_Object    // Grid2
48671>>>>>>>>>>>
48671>>>>>>>>>>>            Object Textbox2 is a Textbox
48673>>>>>>>>>>>                Set Label to "Mo"
48674>>>>>>>>>>>                Set Auto_Size_State to FALSE
48675>>>>>>>>>>>                Set Transparent_State to TRUE
48676>>>>>>>>>>>                Set Color to clWhite
48677>>>>>>>>>>>                Set TextColor to clNavy
48678>>>>>>>>>>>                Set Location to 19 4
48679>>>>>>>>>>>                Set Size to 10 15
48680>>>>>>>>>>>
48680>>>>>>>>>>>                //AB-StoreStart
48680>>>>>>>>>>>
48680>>>>>>>>>>>                Set Label To (left(t.calendar.Monday,2))
48681>>>>>>>>>>>                //AB-StoreEnd
48681>>>>>>>>>>>
48681>>>>>>>>>>>            End_Object    // Textbox2
48682>>>>>>>>>>>
48682>>>>>>>>>>>            Object Textbox3 is a Textbox
48684>>>>>>>>>>>                Set Label to "Tu"
48685>>>>>>>>>>>                Set Auto_Size_State to FALSE
48686>>>>>>>>>>>                Set Transparent_State to TRUE
48687>>>>>>>>>>>                Set Color to clWhite
48688>>>>>>>>>>>                Set TextColor to clNavy
48689>>>>>>>>>>>                Set Location to 19 22
48690>>>>>>>>>>>                Set Size to 10 12
48691>>>>>>>>>>>
48691>>>>>>>>>>>                //AB-StoreStart
48691>>>>>>>>>>>
48691>>>>>>>>>>>                Set Label To (left(t.calendar.Tuesday,2))
48692>>>>>>>>>>>                //AB-StoreEnd
48692>>>>>>>>>>>
48692>>>>>>>>>>>            End_Object    // Textbox3
48693>>>>>>>>>>>
48693>>>>>>>>>>>            Object Textbox4 is a Textbox
48695>>>>>>>>>>>                Set Label to "We"
48696>>>>>>>>>>>                Set Auto_Size_State to FALSE
48697>>>>>>>>>>>                Set Transparent_State to TRUE
48698>>>>>>>>>>>                Set Color to clWhite
48699>>>>>>>>>>>                Set TextColor to clNavy
48700>>>>>>>>>>>                Set Location to 19 39
48701>>>>>>>>>>>                Set Size to 10 15
48702>>>>>>>>>>>
48702>>>>>>>>>>>                //AB-StoreStart
48702>>>>>>>>>>>
48702>>>>>>>>>>>                Set Label To (left(t.calendar.Wednesday,2))
48703>>>>>>>>>>>                //AB-StoreEnd
48703>>>>>>>>>>>
48703>>>>>>>>>>>            End_Object    // Textbox4
48704>>>>>>>>>>>
48704>>>>>>>>>>>            Object Textbox5 is a Textbox
48706>>>>>>>>>>>                Set Label to "Th"
48707>>>>>>>>>>>                Set Auto_Size_State to FALSE
48708>>>>>>>>>>>                Set Transparent_State to TRUE
48709>>>>>>>>>>>                Set Color to clWhite
48710>>>>>>>>>>>                Set TextColor to clNavy
48711>>>>>>>>>>>                Set Location to 19 57
48712>>>>>>>>>>>                Set Size to 10 17
48713>>>>>>>>>>>
48713>>>>>>>>>>>                //AB-StoreStart
48713>>>>>>>>>>>
48713>>>>>>>>>>>                Set Label To (left(t.calendar.Thursday,2))
48714>>>>>>>>>>>                //AB-StoreEnd
48714>>>>>>>>>>>
48714>>>>>>>>>>>            End_Object    // Textbox5
48715>>>>>>>>>>>
48715>>>>>>>>>>>            Object Textbox6 is a Textbox
48717>>>>>>>>>>>                Set Label to "Fr"
48718>>>>>>>>>>>                Set Auto_Size_State to FALSE
48719>>>>>>>>>>>                Set Transparent_State to TRUE
48720>>>>>>>>>>>                Set Color to clWhite
48721>>>>>>>>>>>                Set TextColor to clNavy
48722>>>>>>>>>>>                Set Location to 19 76
48723>>>>>>>>>>>                Set Size to 10 17
48724>>>>>>>>>>>
48724>>>>>>>>>>>                //AB-StoreStart
48724>>>>>>>>>>>
48724>>>>>>>>>>>                Set Label To (left(t.calendar.Friday,2))
48725>>>>>>>>>>>                //AB-StoreEnd
48725>>>>>>>>>>>
48725>>>>>>>>>>>            End_Object    // Textbox6
48726>>>>>>>>>>>
48726>>>>>>>>>>>            Object Textbox7 is a Textbox
48728>>>>>>>>>>>                Set Label to "Sa"
48729>>>>>>>>>>>                Set Auto_Size_State to FALSE
48730>>>>>>>>>>>                Set Transparent_State to TRUE
48731>>>>>>>>>>>                Set Color to clWhite
48732>>>>>>>>>>>                Set TextColor to clNavy
48733>>>>>>>>>>>                Set Location to 19 91
48734>>>>>>>>>>>                Set Size to 10 18
48735>>>>>>>>>>>
48735>>>>>>>>>>>                //AB-StoreStart
48735>>>>>>>>>>>
48735>>>>>>>>>>>                Set Label To (left(t.calendar.Saturday,2))
48736>>>>>>>>>>>                //AB-StoreEnd
48736>>>>>>>>>>>
48736>>>>>>>>>>>            End_Object    // Textbox7
48737>>>>>>>>>>>
48737>>>>>>>>>>>            Object Textbox8 is a Textbox
48739>>>>>>>>>>>                Set Label to "Su"
48740>>>>>>>>>>>                Set Auto_Size_State to FALSE
48741>>>>>>>>>>>                Set Transparent_State to TRUE
48742>>>>>>>>>>>                Set Color to clWhite
48743>>>>>>>>>>>                Set TextColor to clNavy
48744>>>>>>>>>>>                Set Location to 19 109
48745>>>>>>>>>>>                Set Size to 10 17
48746>>>>>>>>>>>
48746>>>>>>>>>>>                //AB-StoreStart
48746>>>>>>>>>>>
48746>>>>>>>>>>>                Set Label To (left(t.calendar.Sunday,2))
48747>>>>>>>>>>>                //AB-StoreEnd
48747>>>>>>>>>>>
48747>>>>>>>>>>>            End_Object    // Textbox8
48748>>>>>>>>>>>
48748>>>>>>>>>>>            Object LineControl1 is a LineControl
48750>>>>>>>>>>>                Set Line_Style to lnSINGLE
48751>>>>>>>>>>>                Set Size to 1 116
48752>>>>>>>>>>>                Set Location to 28 4
48753>>>>>>>>>>>
48753>>>>>>>>>>>                //AB-StoreStart
48753>>>>>>>>>>>
48753>>>>>>>>>>>                //AB-StoreEnd
48753>>>>>>>>>>>
48753>>>>>>>>>>>            End_Object    // LineControl1
48754>>>>>>>>>>>
48754>>>>>>>>>>>            Object Container3d2 is a Container3d
48756>>>>>>>>>>>                Set Size to 18 131
48757>>>>>>>>>>>                Set Location to 1 1
48758>>>>>>>>>>>                Set Color to clNavy
48759>>>>>>>>>>>                Set Border_Style to Border_None
48760>>>>>>>>>>>                Object oRght is a BitmapContainer
48762>>>>>>>>>>>                    Set Size to 10 14
48763>>>>>>>>>>>                    Set Location to 4 105
48764>>>>>>>>>>>                    Set Bitmap to "rght.bmp"
48765>>>>>>>>>>>                    Set Border_Style to Border_None
48766>>>>>>>>>>>
48766>>>>>>>>>>>                    //AB-StoreStart
48766>>>>>>>>>>>                    Procedure Mouse_Down
48768>>>>>>>>>>>                        Send Next_Month to Grid2
48769>>>>>>>>>>>                    End_Procedure
48770>>>>>>>>>>>                    //AB-StoreEnd
48770>>>>>>>>>>>
48770>>>>>>>>>>>                End_Object    // oRght
48771>>>>>>>>>>>
48771>>>>>>>>>>>                Object oLeft is a BitmapContainer
48773>>>>>>>>>>>                    Set Size to 10 14
48774>>>>>>>>>>>                    Set Location to 4 3
48775>>>>>>>>>>>                    Set Bitmap to "lft.bmp"
48776>>>>>>>>>>>                    Set Border_Style to Border_None
48777>>>>>>>>>>>
48777>>>>>>>>>>>                    //AB-StoreStart
48777>>>>>>>>>>>                    Procedure Mouse_Down
48779>>>>>>>>>>>                        Send Prev_Month to Grid2
48780>>>>>>>>>>>                    End_Procedure
48781>>>>>>>>>>>                    //AB-StoreEnd
48781>>>>>>>>>>>
48781>>>>>>>>>>>                End_Object    // oLeft
48782>>>>>>>>>>>
48782>>>>>>>>>>>                Object oMonth is a Textbox
48784>>>>>>>>>>>
48784>>>>>>>>>>>                    //AB-StoreTopStart
48784>>>>>>>>>>>                    Property integer piSelected_Month public 0
48786>>>>>>>>>>>                    //AB-StoreTopEnd
48786>>>>>>>>>>>
48786>>>>>>>>>>>                    Set Label to "January"
48787>>>>>>>>>>>                    Set Auto_Size_State to FALSE
48788>>>>>>>>>>>                    Set Transparent_State to TRUE
48789>>>>>>>>>>>                    Set Color to clWhite
48790>>>>>>>>>>>                    Set TextColor to clWhite
48791>>>>>>>>>>>                    Set Location to 4 19
48792>>>>>>>>>>>                    Set Size to 10 46
48793>>>>>>>>>>>                    Set FontWeight to 800
48794>>>>>>>>>>>                    Set Justification_Mode to jMode_Center
48795>>>>>>>>>>>
48795>>>>>>>>>>>                    //AB-StoreStart
48795>>>>>>>>>>>
48795>>>>>>>>>>>                    Procedure Mouse_Down
48797>>>>>>>>>>>                        Integer iState
48798>>>>>>>>>>>                        Get Visible_State of oSelectCalendarYear to iState
48799>>>>>>>>>>>                        If (iState) Send OnKillFocus to oSelectCalendarYear
48802>>>>>>>>>>>                        Send Popup to oSelectMonth
48803>>>>>>>>>>>                    End_Procedure
48804>>>>>>>>>>>
48804>>>>>>>>>>>                    Procedure pSelectJan
48806>>>>>>>>>>>                        Set Label to t.calendar.january
48807>>>>>>>>>>>                        Set piSelected_Month to 1
48808>>>>>>>>>>>                        Send Adjust_Calendar
48809>>>>>>>>>>>                    End_Procedure
48810>>>>>>>>>>>                    Procedure pSelectFeb
48812>>>>>>>>>>>                        Set Label to t.calendar.february
48813>>>>>>>>>>>                        Set piSelected_Month to 2
48814>>>>>>>>>>>                        Send Adjust_Calendar
48815>>>>>>>>>>>                    End_Procedure
48816>>>>>>>>>>>                    Procedure pSelectMar
48818>>>>>>>>>>>                        Set Label to t.calendar.march
48819>>>>>>>>>>>                        Set piSelected_Month to 3
48820>>>>>>>>>>>                        Send Adjust_Calendar
48821>>>>>>>>>>>                    End_Procedure
48822>>>>>>>>>>>                    Procedure pSelectApr
48824>>>>>>>>>>>                        Set Label to t.calendar.april
48825>>>>>>>>>>>                        Set piSelected_Month to 4
48826>>>>>>>>>>>                        Send Adjust_Calendar
48827>>>>>>>>>>>                    End_Procedure
48828>>>>>>>>>>>                    Procedure pSelectMay
48830>>>>>>>>>>>                        Set Label to t.calendar.may
48831>>>>>>>>>>>                        Set piSelected_Month to 5
48832>>>>>>>>>>>                        Send Adjust_Calendar
48833>>>>>>>>>>>                    End_Procedure
48834>>>>>>>>>>>                    Procedure pSelectJun
48836>>>>>>>>>>>                        Set Label to t.calendar.june
48837>>>>>>>>>>>                        Set piSelected_Month to 6
48838>>>>>>>>>>>                        Send Adjust_Calendar
48839>>>>>>>>>>>                    End_Procedure
48840>>>>>>>>>>>                    Procedure pSelectJul
48842>>>>>>>>>>>                        Set Label to t.calendar.july
48843>>>>>>>>>>>                        Set piSelected_Month to 7
48844>>>>>>>>>>>                        Send Adjust_Calendar
48845>>>>>>>>>>>                    End_Procedure
48846>>>>>>>>>>>                    Procedure pSelectAug
48848>>>>>>>>>>>                        Set Label to t.calendar.august
48849>>>>>>>>>>>                        Set piSelected_Month to 8
48850>>>>>>>>>>>                        Send Adjust_Calendar
48851>>>>>>>>>>>                    End_Procedure
48852>>>>>>>>>>>                    Procedure pSelectSep
48854>>>>>>>>>>>                        Set Label to t.calendar.september
48855>>>>>>>>>>>                        Set piSelected_Month to 9
48856>>>>>>>>>>>                        Send Adjust_Calendar
48857>>>>>>>>>>>                    End_Procedure
48858>>>>>>>>>>>                    Procedure pSelectOct
48860>>>>>>>>>>>                        Set Label to t.calendar.october
48861>>>>>>>>>>>                        Set piSelected_Month to 10
48862>>>>>>>>>>>                        Send Adjust_Calendar
48863>>>>>>>>>>>                    End_Procedure
48864>>>>>>>>>>>                    Procedure pSelectNov
48866>>>>>>>>>>>                        Set Label to t.calendar.november
48867>>>>>>>>>>>                        Set piSelected_Month to 11
48868>>>>>>>>>>>                        Send Adjust_Calendar
48869>>>>>>>>>>>                    End_Procedure
48870>>>>>>>>>>>                    Procedure pSelectDec
48872>>>>>>>>>>>                        Set Label to t.calendar.december
48873>>>>>>>>>>>                        Set piSelected_Month to 12
48874>>>>>>>>>>>                        Send Adjust_Calendar
48875>>>>>>>>>>>                    End_Procedure
48876>>>>>>>>>>>
48876>>>>>>>>>>>                    Object oSelectMonth is a FloatingPopupMenu
48878>>>>>>>>>>>                        Send Add_Item msg_pSelectJan t.calendar.january
48879>>>>>>>>>>>                        Send Add_Item msg_pSelectFeb t.calendar.february
48880>>>>>>>>>>>                        Send Add_Item msg_pSelectMar t.calendar.march
48881>>>>>>>>>>>                        Send Add_Item msg_pSelectApr t.calendar.april
48882>>>>>>>>>>>                        Send Add_Item msg_pSelectMay t.calendar.may
48883>>>>>>>>>>>                        Send Add_Item msg_pSelectJun t.calendar.june
48884>>>>>>>>>>>                        Send Add_Item msg_pSelectJul t.calendar.july
48885>>>>>>>>>>>                        Send Add_Item msg_pSelectAug t.calendar.august
48886>>>>>>>>>>>                        Send Add_Item msg_pSelectSep t.calendar.september
48887>>>>>>>>>>>                        Send Add_Item msg_pSelectOct t.calendar.october
48888>>>>>>>>>>>                        Send Add_Item msg_pSelectNov t.calendar.november
48889>>>>>>>>>>>                        Send Add_Item msg_pSelectDec t.calendar.december
48890>>>>>>>>>>>                    End_Object
48891>>>>>>>>>>>
48891>>>>>>>>>>>                    Procedure Adjust_Calendar
48893>>>>>>>>>>>                        Date date#
48894>>>>>>>>>>>                        Integer iDay iMonth iYear iItm
48894>>>>>>>>>>>                        Set Visible_State to false
48895>>>>>>>>>>>                        Set Visible_State to true
48896>>>>>>>>>>>                        Get Current_Item of (Grid2(Container3D1(Self))) to iItm
48897>>>>>>>>>>>                        Get value of (Grid2(Container3D1(Self))) item iItm to iDay
48898>>>>>>>>>>>                        Get piSelected_Month to iMonth
48899>>>>>>>>>>>                        Get Label of oCalendarYear to iYear
48900>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
48901>>>>>>>>>>>                        Set p_current_date of (Grid2(Container3D1(Self))) to date#
48902>>>>>>>>>>>                        Send Update_Calendar to (Grid2(Container3D1(Self)))
48903>>>>>>>>>>>                    End_Procedure
48904>>>>>>>>>>>
48904>>>>>>>>>>>                    Procedure Activating
48906>>>>>>>>>>>                        Forward Send Activating
48908>>>>>>>>>>>                        Send Date_Changing
48909>>>>>>>>>>>                    End_Procedure
48910>>>>>>>>>>>
48910>>>>>>>>>>>                    Procedure Date_Changing
48912>>>>>>>>>>>                        Set Visible_State to false
48913>>>>>>>>>>>                        Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
48914>>>>>>>>>>>                        Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
48915>>>>>>>>>>>                        Set Visible_State to true
48916>>>>>>>>>>>                    End_Procedure
48917>>>>>>>>>>>
48917>>>>>>>>>>>
48917>>>>>>>>>>>
48917>>>>>>>>>>>                    //AB-StoreEnd
48917>>>>>>>>>>>
48917>>>>>>>>>>>                End_Object    // oMonth
48918>>>>>>>>>>>
48918>>>>>>>>>>>                Object oCalendarYear is a Textbox
48920>>>>>>>>>>>                    Set Label to "2001"
48921>>>>>>>>>>>                    Set Transparent_State to TRUE
48922>>>>>>>>>>>                    Set Color to clWhite
48923>>>>>>>>>>>                    Set TextColor to clWhite
48924>>>>>>>>>>>                    Set Location to 4 77
48925>>>>>>>>>>>                    Set Size to 10 18
48926>>>>>>>>>>>                    Set FontWeight to 800
48927>>>>>>>>>>>
48927>>>>>>>>>>>                    //AB-StoreStart
48927>>>>>>>>>>>
48927>>>>>>>>>>>                    Procedure Mouse_Down
48929>>>>>>>>>>>                        String sVal
48930>>>>>>>>>>>                        Get Label to sVal
48931>>>>>>>>>>>                        Set Value of oSelectCalendarYear item 0 to sVal
48932>>>>>>>>>>>                        Set Visible_State of oSelectCalendarYear to True
48933>>>>>>>>>>>                        Send Activate to (oSelectCalendarYear(Self))
48934>>>>>>>>>>>                    End_Procedure
48935>>>>>>>>>>>
48935>>>>>>>>>>>                    Procedure Activating
48937>>>>>>>>>>>                        Forward Send Activating
48939>>>>>>>>>>>                        Send Date_Changing
48940>>>>>>>>>>>                    End_Procedure
48941>>>>>>>>>>>
48941>>>>>>>>>>>                    Procedure Date_Changing
48943>>>>>>>>>>>                        Set Visible_State to false
48944>>>>>>>>>>>                        Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
48945>>>>>>>>>>>                        Set Visible_State to true
48946>>>>>>>>>>>                    End_Procedure
48947>>>>>>>>>>>
48947>>>>>>>>>>>                    //AB-StoreEnd
48947>>>>>>>>>>>
48947>>>>>>>>>>>                End_Object    // oCalendarYear
48948>>>>>>>>>>>
48948>>>>>>>>>>>                Object oSelectCalendarYear is a Form
48950>>>>>>>>>>>
48950>>>>>>>>>>>                    //AB-StoreTopStart
48950>>>>>>>>>>>                    Set Visible_State To False
48951>>>>>>>>>>>                    //AB-StoreTopEnd
48951>>>>>>>>>>>
48951>>>>>>>>>>>                    Set Size to 10 24
48952>>>>>>>>>>>                    Set Location to 4 75
48953>>>>>>>>>>>                    Set Color to clWhite
48954>>>>>>>>>>>                    Set TextColor to clNavy
48955>>>>>>>>>>>                    Set Form_Border Item 0 to Border_Normal
48956>>>>>>>>>>>
48956>>>>>>>>>>>                    //AB-StoreStart
48956>>>>>>>>>>>
48956>>>>>>>>>>>                    On_Key Key_Enter Send OnKillFocus
48957>>>>>>>>>>>                    On_Key Key_Escape Send OnKillFocus
48958>>>>>>>>>>>
48958>>>>>>>>>>>                    Procedure SetFontWeight
48960>>>>>>>>>>>                        Set Form_FontWeight item 0 to 800
48961>>>>>>>>>>>                    End_Procedure
48962>>>>>>>>>>>
48962>>>>>>>>>>>                    Procedure OnKillFocus
48964>>>>>>>>>>>                        String sVal
48965>>>>>>>>>>>                        Integer iMonth iDay iYear iItm
48965>>>>>>>>>>>                        Date date#
48965>>>>>>>>>>>                        Get Value item 0 to sVal
48966>>>>>>>>>>>                        Set Visible_State of oCalendarYear to false
48967>>>>>>>>>>>                        Set Label of oCalendarYear to sVal
48968>>>>>>>>>>>                        Set Visible_State of oCalendarYear to true
48969>>>>>>>>>>>                        Set Visible_State to false
48970>>>>>>>>>>>                        Get Current_Item of (Grid2(Container3D1(Self))) to iItm
48971>>>>>>>>>>>                        Get value of (Grid2(Container3D1(Self))) item iItm to iDay
48972>>>>>>>>>>>                        Get piSelected_Month of oMonth to iMonth
48973>>>>>>>>>>>                        Get Value item 0 to iYear
48974>>>>>>>>>>>                        If (iYear = 0) Move 2000 to iYear
48977>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
48978>>>>>>>>>>>                        Set p_current_date of (Grid2(Container3D1(Self))) to date#
48979>>>>>>>>>>>                        Send Update_Calendar to (Grid2(Container3D1(Self)))
48980>>>>>>>>>>>                        Send Activate        to (Grid2(Container3D1(Self)))
48981>>>>>>>>>>>                    End_Procedure
48982>>>>>>>>>>>
48982>>>>>>>>>>>                    Send SetFontWeight
48983>>>>>>>>>>>
48983>>>>>>>>>>>
48983>>>>>>>>>>>
48983>>>>>>>>>>>                    //AB-StoreEnd
48983>>>>>>>>>>>
48983>>>>>>>>>>>                End_Object    // oSelectCalendarYear
48984>>>>>>>>>>>
48984>>>>>>>>>>>
48984>>>>>>>>>>>                //AB-StoreStart
48984>>>>>>>>>>>
48984>>>>>>>>>>>                Procedure Mouse_Down
48986>>>>>>>>>>>                    Integer iState
48987>>>>>>>>>>>                    Get Visible_State of oSelectCalendarYear to iState
48988>>>>>>>>>>>                    If (iState) Send OnKillFocus to oSelectCalendarYear
48991>>>>>>>>>>>                End_Procedure
48992>>>>>>>>>>>
48992>>>>>>>>>>>
48992>>>>>>>>>>>                //AB-StoreEnd
48992>>>>>>>>>>>
48992>>>>>>>>>>>            End_Object    // Container3d2
48993>>>>>>>>>>>
48993>>>>>>>>>>>
48993>>>>>>>>>>>            //AB-StoreStart
48993>>>>>>>>>>>
48993>>>>>>>>>>>
48993>>>>>>>>>>>            //AB-StoreEnd
48993>>>>>>>>>>>
48993>>>>>>>>>>>        End_Object    // Container3d1
48994>>>>>>>>>>>
48994>>>>>>>>>>>        Object BitmapContainer3 is a BitmapContainer
48996>>>>>>>>>>>            Set Size to 9 19
48997>>>>>>>>>>>            Set Location to 88 3
48998>>>>>>>>>>>            Set Color to clWhite
48999>>>>>>>>>>>            Set Bitmap to "cdate.bmp"
49000>>>>>>>>>>>            Set Border_Style to Border_None
49001>>>>>>>>>>>
49001>>>>>>>>>>>            //AB-StoreStart
49001>>>>>>>>>>>            Procedure Mouse_Down
49003>>>>>>>>>>>                Send go_today to (Grid2(Container3d1(Self)))
49004>>>>>>>>>>>                Send Adjust_Label to oToday
49005>>>>>>>>>>>            End_Procedure
49006>>>>>>>>>>>            //AB-StoreEnd
49006>>>>>>>>>>>
49006>>>>>>>>>>>        End_Object    // BitmapContainer3
49007>>>>>>>>>>>
49007>>>>>>>>>>>        Object oToday is a Textbox
49009>>>>>>>>>>>            Set Label to "Today: 01.01.2001"
49010>>>>>>>>>>>            Set Auto_Size_State to FALSE
49011>>>>>>>>>>>            Set Color to clWhite
49012>>>>>>>>>>>            Set Location to 88 22
49013>>>>>>>>>>>            Set Size to 8 70
49014>>>>>>>>>>>            Set FontWeight to 800
49015>>>>>>>>>>>
49015>>>>>>>>>>>            //AB-StoreStart
49015>>>>>>>>>>>            Procedure Mouse_Down
49017>>>>>>>>>>>                Send go_today to (Grid2(Container3d1(Self)))
49018>>>>>>>>>>>                Send Adjust_Label
49019>>>>>>>>>>>            End_Procedure
49020>>>>>>>>>>>
49020>>>>>>>>>>>            Procedure Adjust_Label
49022>>>>>>>>>>>                date date#
49023>>>>>>>>>>>                SysDate4 date#
49024>>>>>>>>>>>                Set Visible_State To false
49025>>>>>>>>>>>                Set Label         to (t.calendar.today+": "+String(date#))
49026>>>>>>>>>>>                Set Visible_State To true
49027>>>>>>>>>>>            End_Procedure
49028>>>>>>>>>>>
49028>>>>>>>>>>>            Procedure Activating
49030>>>>>>>>>>>                Forward Send Activating
49032>>>>>>>>>>>                Send Adjust_Label
49033>>>>>>>>>>>            End_Procedure
49034>>>>>>>>>>>            //AB-StoreEnd
49034>>>>>>>>>>>
49034>>>>>>>>>>>        End_Object    // oToday
49035>>>>>>>>>>>
49035>>>>>>>>>>>        Object oCloseCalendar_bn is a BitmapContainer
49037>>>>>>>>>>>            Set Size to 9 10
49038>>>>>>>>>>>            Set Location to 88 112
49039>>>>>>>>>>>            Set Bitmap to "Cdate1.bmp"
49040>>>>>>>>>>>            Set Bitmap_Style to Bitmap_Center
49041>>>>>>>>>>>
49041>>>>>>>>>>>            //AB-StoreStart
49041>>>>>>>>>>>
49041>>>>>>>>>>>            Procedure Mouse_Up
49043>>>>>>>>>>>                Send Close_Calendar
49044>>>>>>>>>>>            End_Procedure // Mouse_Up
49045>>>>>>>>>>>
49045>>>>>>>>>>>
49045>>>>>>>>>>>
49045>>>>>>>>>>>
49045>>>>>>>>>>>            //AB-StoreEnd
49045>>>>>>>>>>>
49045>>>>>>>>>>>        End_Object    // oCloseCalendar_bn
49046>>>>>>>>>>>
49046>>>>>>>>>>>
49046>>>>>>>>>>>        //AB-StoreStart
49046>>>>>>>>>>>
49046>>>>>>>>>>>        Set Block_Mouse_State to True
49047>>>>>>>>>>>        Set Popup_State to True
49048>>>>>>>>>>>        Set Locate_Mode to Popup_Locate
49049>>>>>>>>>>>
49049>>>>>>>>>>>        procedure popup
49051>>>>>>>>>>>            local integer focus# icItm iYear iMonth
49052>>>>>>>>>>>            local date date#
49052>>>>>>>>>>>            move (focus(desktop)) to focus#
49053>>>>>>>>>>>            set invoking_object_id of (Grid2(Container3d1(self))) to focus#
49054>>>>>>>>>>>            get value of focus# item current to date#
49055>>>>>>>>>>>            ifnot (integer(date#)) sysdate date#
49058>>>>>>>>>>>            move (Date2to4(date#)) to date#
49059>>>>>>>>>>>            set p_current_date of (Grid2(Container3d1(self))) to date#
49060>>>>>>>>>>>            send fill_list to (Grid2(Container3d1(self)))
49061>>>>>>>>>>>            move (DateSegment(date#,DS_YEAR)) to iYear
49062>>>>>>>>>>>            move (DateSegment(date#,DS_MONTH)) to iMonth
49063>>>>>>>>>>>            Set Label To (MonthName(iMonth)+', '+String(iYear))
49064>>>>>>>>>>>            forward send popup
49066>>>>>>>>>>>        end_procedure
49067>>>>>>>>>>>
49067>>>>>>>>>>>        Procedure Close_Calendar
49069>>>>>>>>>>>            Send Exit
49070>>>>>>>>>>>        End_Procedure // Close_Calendar
49071>>>>>>>>>>>
49071>>>>>>>>>>>        Object Help_Container is a Container3d
49073>>>>>>>>>>>            Set Location to 0 0
49074>>>>>>>>>>>            Set Size     to 98 122
49075>>>>>>>>>>>            Set Visible_State to False
49076>>>>>>>>>>>            Set Enabled_State to False
49077>>>>>>>>>>>            Set Border_Style to Border_None
49078>>>>>>>>>>>            Set TextColor to clNavy
49079>>>>>>>>>>>
49079>>>>>>>>>>>            Object Help_Info is an Edit
49081>>>>>>>>>>>                Set Location to 0 0
49082>>>>>>>>>>>                Set Size     to 98 122
49083>>>>>>>>>>>                Set read_only_state to true
49084>>>>>>>>>>>                Set Border_Style to Border_None
49085>>>>>>>>>>>                Set scroll_bar_visible_state to False
49086>>>>>>>>>>>                Set FontWeight to 800
49087>>>>>>>>>>>
49087>>>>>>>>>>>                Procedure ReadHelpComments
49089>>>>>>>>>>>                    String lsFile
49090>>>>>>>>>>>
49090>>>>>>>>>>>                    Get_File_Path "Calendar.txt" to lsFile
49091>>>>>>>>>>>                    If (lsFile <> "") Send read lsFile
49094>>>>>>>>>>>                End_Procedure // ReadHelpComments
49095>>>>>>>>>>>
49095>>>>>>>>>>>                Procedure SetComments
49097>>>>>>>>>>>                    Send append_text "Help on Calendar"
49098>>>>>>>>>>>                    Send Insert ""
49099>>>>>>>>>>>                    Send Insert ""
49100>>>>>>>>>>>                    Send append_text "1.<Up>,<Dn>,<Lft>,<Rgt>"
49101>>>>>>>>>>>                    Send Insert ""
49102>>>>>>>>>>>                    Send append_text "  - select date."
49103>>>>>>>>>>>                    Send Insert ""
49104>>>>>>>>>>>                    Send append_text "2.<PgUp>,<PgDn>"
49105>>>>>>>>>>>                    Send Insert ""
49106>>>>>>>>>>>                    Send append_text "  - select month."
49107>>>>>>>>>>>                    Send Insert ""
49108>>>>>>>>>>>                    Send append_text "3.<Ctrl>+<D>"
49109>>>>>>>>>>>                    Send Insert ""
49110>>>>>>>>>>>                    Send append_text "  - set current date."
49111>>>>>>>>>>>                    Send Insert ""
49112>>>>>>>>>>>                    Send append_text "4.<Ctrl>+<Y>"
49113>>>>>>>>>>>                    Send Insert ""
49114>>>>>>>>>>>                    Send append_text "  - Change year."
49115>>>>>>>>>>>                    Send Insert ""
49116>>>>>>>>>>>                    Send append_text "5.<Ctrl>+<PgUp>,<PgDn>"
49117>>>>>>>>>>>                    Send Insert ""
49118>>>>>>>>>>>                    Send append_text "  - Select year."
49119>>>>>>>>>>>                End_procedure // SetComments
49120>>>>>>>>>>>
49120>>>>>>>>>>>                //Send SetComments
49120>>>>>>>>>>>                Set Color     to clWhite
49121>>>>>>>>>>>                Set TextColor to clNavy
49122>>>>>>>>>>>
49122>>>>>>>>>>>                Procedure OnSetFocus
49124>>>>>>>>>>>                    Send ReadHelpComments
49125>>>>>>>>>>>                End_Procedure
49126>>>>>>>>>>>
49126>>>>>>>>>>>                Object HelpFloatingMenu is a FloatingPopupMenu
49128>>>>>>>>>>>
49128>>>>>>>>>>>                    Procedure Close_Help
49130>>>>>>>>>>>                        Send Close_Help to Help_Container
49131>>>>>>>>>>>                    End_Procedure // Close_Calendar
49132>>>>>>>>>>>
49132>>>>>>>>>>>                    Send Add_item msg_Close_Help   t.calendar.Ok
49133>>>>>>>>>>>                End_Object // cOutlookFloatingMenu
49134>>>>>>>>>>>
49134>>>>>>>>>>>                Procedure Mouse_Up2 Integer aiWindow Integer aiChar_Pos
49136>>>>>>>>>>>                    Send Popup to HelpFloatingMenu
49137>>>>>>>>>>>                End_Procedure // Mouse_Up2
49138>>>>>>>>>>>
49138>>>>>>>>>>>            End_Object
49139>>>>>>>>>>>
49139>>>>>>>>>>>            Procedure Close_Help
49141>>>>>>>>>>>                Send Delete_Data to Help_Info
49142>>>>>>>>>>>                Set Visible_State to False
49143>>>>>>>>>>>                Set Enabled_State to False
49144>>>>>>>>>>>                Send Activate to (Grid2(Container3D1(Self)))
49145>>>>>>>>>>>            End_Procedure // Close_Help
49146>>>>>>>>>>>
49146>>>>>>>>>>>            On_Key kCancel Send Close_Help
49147>>>>>>>>>>>            On_Key Key_F1  Send Close_Help
49148>>>>>>>>>>>            On_Key kEnter  Send Close_Help
49149>>>>>>>>>>>        End_Object // Help_Info
49150>>>>>>>>>>>
49150>>>>>>>>>>>        on_key kcancel           send Close_Calendar
49151>>>>>>>>>>>
49151>>>>>>>>>>>
49151>>>>>>>>>>>
49151>>>>>>>>>>>
49151>>>>>>>>>>>
49151>>>>>>>>>>>
49151>>>>>>>>>>>        //AB-StoreEnd
49151>>>>>>>>>>>
49151>>>>>>>>>>>    End_Object    // oCalendar
49152>>>>>>>>>>>
49152>>>>>>>>>>>
49152>>>>>>>>>>>    //AB-StoreStart
49152>>>>>>>>>>>
49152>>>>>>>>>>>    Procedure Request_Popup_cOutlookCalendar for BaseClass
49153>>>>>>>>>>>        Integer focus# type# dm#
49154>>>>>>>>>>>
49154>>>>>>>>>>>        move (focus(desktop)) to focus#
49155>>>>>>>>>>>        if focus# gt desktop begin
49157>>>>>>>>>>>          get delegation_mode of focus# to dm#
49158>>>>>>>>>>>          set delegation_mode of focus# to no_delegate_or_error
49159>>>>>>>>>>>          get form_datatype of focus# item current to type#
49160>>>>>>>>>>>          if (type#=date_window or type#=mask_date_window) send popup to oCalendar
49163>>>>>>>>>>>          set delegation_mode of focus# to dm#
49164>>>>>>>>>>>        end
49164>>>>>>>>>>>>
49164>>>>>>>>>>>    End_Procedure
49165>>>>>>>>>>>
49165>>>>>>>>>>>    On_Key Key_Ctrl+Key_F1 Send Request_Popup_cOutlookCalendar
49166>>>>>>>>>>>    On_Key Key_Ctrl+Key_H  Send Request_Popup_cOutlookCalendar
49167>>>>>>>>>>>
49167>>>>>>>>>>>
49167>>>>>>>>>>>    //AB-StoreEnd
49167>>>>>>>>>>>
49167>>>>>>>>>>>//AB/     End_Object    // prj
49167>>>>>>>>>Use Dates.Utl
49167>>>>>>>>>
49167>>>>>>>>>   Define cStatusHelp       for "F4 = Calendar. T = Today, B = Begin of month, E = End of month."
49167>>>>>>>>>   Define cDateToday        for "T"
49167>>>>>>>>>   Define cDateBeginOfMonth for "B"
49167>>>>>>>>>   Define cDateEndOfMonth   for "E"
49167>>>>>>>>>
49167>>>>>>>>>Class cSyIntelliSense_Date_Mixin is a Message
49168>>>>>>>>>   Procedure DoDefineIntelliSenseDateMixin
49169>>>>>>>>>      Property Date    pdOriginal_Value          Public 0
49170>>>>>>>>>      Property Integer pbIntelliSense_Date_State Public dfTrue
49171>>>>>>>>>      Property Integer pbEnableCalendarPrompt    Public dfTrue
49172>>>>>>>>>      On_Key KUpArrow         Send DoAddOneDay
49173>>>>>>>>>      On_Key KDownArrow       Send DoSubOneDay
49174>>>>>>>>>   End_Procedure // DoDefineIntelliSenseDateMixin
49175>>>>>>>>>
49175>>>>>>>>>   Procedure DoAddOneDay
49176>>>>>>>>>        Integer rVal
49177>>>>>>>>>        Date dHmnia
49177>>>>>>>>>
49177>>>>>>>>>        Get Value Item 0 to dHmnia
49178>>>>>>>>>        Add 1 to dHmnia
49179>>>>>>>>>        Set Value Item 0 to dHmnia
49180>>>>>>>>>    End_Procedure // Add_One_Day
49181>>>>>>>>>
49181>>>>>>>>>    Procedure DoSubOneDay
49182>>>>>>>>>        Integer rVal
49183>>>>>>>>>        Date dHmnia
49183>>>>>>>>>
49183>>>>>>>>>        Get Value Item 0 to dHmnia
49184>>>>>>>>>        Sub 1 to dHmnia
49185>>>>>>>>>        Set Value Item 0 to dHmnia
49186>>>>>>>>>    End_Procedure // Add_One_Day
49187>>>>>>>>>
49187>>>>>>>>>   // **WvA: Augmented to store the current date-value before any changes are made
49187>>>>>>>>>   Procedure Entering returns Integer
49188>>>>>>>>>      Integer iRetVal
49189>>>>>>>>>      Date    dOriginal
49189>>>>>>>>>      Forward Get Msg_Entering to iRetVal
49191>>>>>>>>>      If (iRetVal = 0) Begin
49193>>>>>>>>>         Send DoStoreOriginalDate
49194>>>>>>>>>      End
49194>>>>>>>>>>
49194>>>>>>>>>      Procedure_Return iRetVal
49195>>>>>>>>>   End_Procedure // Entering
49196>>>>>>>>>
49196>>>>>>>>>   //**WvA: This procedure is augmented to see if the user entered a 1 or 2 digit
49196>>>>>>>>>   //       value with the intention to only change the day-part of the current date.
49196>>>>>>>>>   Procedure Next
49197>>>>>>>>>      Send DoIntelliSenseDate
49198>>>>>>>>>      Forward Send Next
49200>>>>>>>>>   End_Procedure // Next
49201>>>>>>>>>
49201>>>>>>>>>   // **WvA: Store the current date-value before any changes are made
49201>>>>>>>>>   Procedure DoStoreOriginalDate
49202>>>>>>>>>      Date    dOriginal
49203>>>>>>>>>      //If (pbIntelliSense_Date_State(Self)) Begin
49203>>>>>>>>>         Get Value Item 0 to dOriginal
49204>>>>>>>>>         Set pdOriginal_Value to dOriginal
49205>>>>>>>>>      //End
49205>>>>>>>>>   End_Procedure // DoStoreOriginalDate
49206>>>>>>>>>
49206>>>>>>>>>   Procedure DoIntelliSenseDate
49207>>>>>>>>>      Integer iCurrent iStored iDaysOffSet iSep iDate_Format bChanged iYear
49208>>>>>>>>>      Date    dCurrent dOriginal
49208>>>>>>>>>      String  sStored  sCurrent sSep sMask
49208>>>>>>>>>
49208>>>>>>>>>      Get Item_Changed_State Item 0 to bChanged
49209>>>>>>>>>      Get pdOriginal_Value to dOriginal
49210>>>>>>>>>      If (pbIntelliSense_Date_State(Self) And (bChanged)) Begin
49212>>>>>>>>>         If (dOriginal Eq 0) Sysdate4 dOriginal
49215>>>>>>>>>
49215>>>>>>>>>         // We need the masked value, because the normal value is corrected by the runtime for
49215>>>>>>>>>         // USA dates.
49215>>>>>>>>>         Get Masked_Value Item 0 to sCurrent // getting a 2 digit entered date to a datavariable results in an error.
49216>>>>>>>>>         Move (Replaces(" ",sCurrent,"")) to sCurrent
49217>>>>>>>>>         Get_Attribute DF_DATE_SEPARATOR to iSep
49220>>>>>>>>>         Move (Character(iSep)) to sSep
49221>>>>>>>>>
49221>>>>>>>>>         // Although the sep value is "/" in the European date format, the mask seperator is "-".
49221>>>>>>>>>         Move (Replaces("-",sCurrent,sSep)) to sCurrent
49222>>>>>>>>>         Move (sSep+sSep) to sMask
49223>>>>>>>>>
49223>>>>>>>>>         // Now check if the user just entered a day or a day and a month.
49223>>>>>>>>>         // Something very special is going on here. We are interpreting a string, so the format
49223>>>>>>>>>         // will always be the same, even for USA or Military dates. "99//" where 9 can be any number
49223>>>>>>>>>         //If ( (length(sCurrent) > 2) And (Right(sCurrent,2) = sMask)  ) Begin
49223>>>>>>>>>         If ((length(sCurrent) <= 4) And (Right(sCurrent,2) = sMask)) Begin
49225>>>>>>>>>            Move (replace(sMask,sCurrent,"")) to sCurrent
49226>>>>>>>>>            Move sCurrent to iCurrent
49227>>>>>>>>>            If ((iCurrent >= 1) And (iCurrent <= 31)) Begin
49229>>>>>>>>>               Get_Attribute DF_DATE_FORMAT to iDate_Format
49232>>>>>>>>>               If (iDate_Format = DF_DATE_USA) Begin
49234>>>>>>>>>                  Move (Mid( String(dOriginal),2,4)) to iDaysOffSet
49235>>>>>>>>>               End
49235>>>>>>>>>>
49235>>>>>>>>>               Else If (iDate_Format = DF_DATE_EUROPEAN) Begin
49238>>>>>>>>>                  Move (Left( String(dOriginal),2 )) to iDaysOffSet
49239>>>>>>>>>               End
49239>>>>>>>>>>
49239>>>>>>>>>               Else If (iDate_Format = DF_DATE_MILITARY) Begin
49242>>>>>>>>>                  Move (Right( String(dOriginal),2 )) to iDaysOffSet
49243>>>>>>>>>               End
49243>>>>>>>>>>
49243>>>>>>>>>               Set Value Item 0 to (Date(dOriginal - iDaysOffSet + iCurrent))
49244>>>>>>>>>            End // Let the runtime handle the error if value not in the range 1..31
49244>>>>>>>>>>
49244>>>>>>>>>         End
49244>>>>>>>>>>
49244>>>>>>>>>         Else If ((length(sCurrent) > 4) And (Right(sCurrent,1) = sSep)) Begin
49247>>>>>>>>>            Get_Attribute DF_DATE_FORMAT to iDate_Format
49250>>>>>>>>>            If ((iDate_Format = DF_DATE_USA) Or (iDate_Format = DF_DATE_EUROPEAN)) Begin
49252>>>>>>>>>               Move (Right(dOriginal,4)) to iYear
49253>>>>>>>>>            End
49253>>>>>>>>>>
49253>>>>>>>>>            Else If (iDate_Format = DF_DATE_MILITARY) Begin
49256>>>>>>>>>               Move (Left(dOriginal,4))  to iYear
49257>>>>>>>>>            End
49257>>>>>>>>>>
49257>>>>>>>>>            Set Value Item 0 to (Date(sCurrent + String(iYear)))
49258>>>>>>>>>         End
49258>>>>>>>>>>
49258>>>>>>>>>      End
49258>>>>>>>>>>
49258>>>>>>>>>   End_Procedure // DoIntelliSenseDate
49259>>>>>>>>>
49259>>>>>>>>>   Procedure Key Integer iKey Returns Integer
49260>>>>>>>>>      Date dToday dTemp
49261>>>>>>>>>      Sysdate4 dToday
49262>>>>>>>>>
49262>>>>>>>>>      If ((Character(iKey) EQ cDateToday) OR (Character(iKey) EQ Lowercase(cDateToday))) Begin
49264>>>>>>>>>         Set Value to dToday
49265>>>>>>>>>      End
49265>>>>>>>>>>
49265>>>>>>>>>      Else If ((Character(iKey) EQ cDateBeginOfMonth) OR (Character(iKey) EQ Lowercase(cDateBeginOfMonth))) Begin
49268>>>>>>>>>         Get FirstDayInMonth dToday to dTemp
49269>>>>>>>>>         Set Value to dTemp
49270>>>>>>>>>      End
49270>>>>>>>>>>
49270>>>>>>>>>      Else If ((Character(iKey) EQ cDateEndOfMonth) OR (Character(iKey) EQ Lowercase(cDateEndOfMonth))) Begin
49273>>>>>>>>>         Get LastDayInMonth dToday to dTemp
49274>>>>>>>>>         Set Value to dTemp
49275>>>>>>>>>      End
49275>>>>>>>>>>
49275>>>>>>>>>      Else Forward Send Key iKey
49278>>>>>>>>>   End_procedure
49279>>>>>>>>>
49279>>>>>>>>>End_Class // cSyIntelliSense_Date_Mixin
49280>>>>>>>
49280>>>>>>>Class cSyDateForm Is A FormSub
49281>>>>>>>   Procedure Construct_Object
49282>>>>>>>      Forward Send Construct_Object
49284>>>>>>>
49284>>>>>>>      Set Prompt_Button_Mode   to PB_PromptOn
49285>>>>>>>      Set Form_Datatype Item 0 to Mask_Date_Window
49286>>>>>>>
49286>>>>>>>      Send DoDefineIntelliSenseDateMixin
49287>>>>>>>
49287>>>>>>>      On_Key kPrompt Send Prompt
49288>>>>>>>
49288>>>>>>>      Set Prompt_Object to (oCalendar(Self))
49289>>>>>>>      Set Status_Help   to cStatusHelp
49290>>>>>>>
49290>>>>>>>   End_Procedure // Construct_Object
49291>>>>>>>
49291>>>>>>>   Import_Class_Protocol cSyIntelliSense_Date_Mixin
49292>>>>>>>
49292>>>>>>>//   Function Form_Datatype Integer iItem Returns Integer
49292>>>>>>>//      Integer iDatatype
49292>>>>>>>//
49292>>>>>>>//      If (iItem = Current) Begin
49292>>>>>>>//         Get Current_Item to iItem
49292>>>>>>>//      End
49292>>>>>>>//
49292>>>>>>>//      Forward Get Form_Datatype Item iItem to iDataType
49292>>>>>>>//
49292>>>>>>>//      Function_Return iDatatype
49292>>>>>>>//   End_Function // Form_Datatype
49292>>>>>>>
49292>>>>>>>End_Class // cSyDateForm
49293>>>>>Use Form.Sub
49293>>>>>Use Button.Sub
49293>>>>>
49293>>>>>
49293>>>>>Use BAXIOKAT.DD
INCLUDING FILE: BAXIOKAT.DD
49293>>>>>>>//DDB-FileStart
49293>>>>>>>//DDB-HeaderStart
49293>>>>>>>
49293>>>>>>>// File Name : BAXIOKAT.DD
49293>>>>>>>// Class Name: Baxiokat_DataDictionary
49293>>>>>>>// Revision  : 45
49293>>>>>>>// Version   : 2
49293>>>>>>>
49293>>>>>>>Use  Windows           // Basic Definitions
49293>>>>>>>Use  DataDict          // DataDictionary Class Definition
49293>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49293>>>>>>>
49293>>>>>>>Open Baxiokat
49295>>>>>>>Open Baxio
49297>>>>>>>Open Bkinkat
INCLUDING FILE: BKINKAT.FD
49299>>>>>>>Open Tpclient
49301>>>>>>>Open Tperga
INCLUDING FILE: TPERGA.FD
49303>>>>>>>Open Tparticl
INCLUDING FILE: TPARTICL.FD
49305>>>>>>>Open Sysrecb
49307>>>>>>>
49307>>>>>>>//DDB-HeaderEnd
49307>>>>>>>//DDB-ValidationStart
49307>>>>>>>
49307>>>>>>>//DDB/ ExternalValidationTable Baxiokat_Type_VT  BAXIO.PKG
49307>>>>>>>
49307>>>>>>>Register_Object Baxiokat_Type_VT
49307>>>>>>>Register_Object Baxiokat_Baxiokat_Yn5390_VT
49307>>>>>>>Register_Object Baxiokat_Baxiokat_Bank_VT
49307>>>>>>>Register_Object Baxiokat_Baxiokat_Formul_VT
49307>>>>>>>Use BAXIO.PKG        // Baxiokat_Type_VT
49307>>>>>>>
49307>>>>>>>Object Baxiokat_Baxiokat_Yn5390_VT  is a DescriptionValidationTable
49309>>>>>>>
49309>>>>>>>    Procedure Fill_List
49311>>>>>>>        Forward Send Fill_List
49313>>>>>>>        Send Add_Table_Value  "0"  "Ž® "
49314>>>>>>>        Send Add_Table_Value  "1"  "Œ˜ "
49315>>>>>>>    End_Procedure    // Fill_List
49316>>>>>>>    //DDB-ValidationCustomStart
49316>>>>>>>    //DDB-ValidationCustomEnd
49316>>>>>>>End_Object   // Baxiokat_Baxiokat_Yn5390_VT
49317>>>>>>>
49317>>>>>>>Object Baxiokat_Baxiokat_Bank_VT  is a CodeValidationTable
49319>>>>>>>    Set Type_Value        To "BANK"
49320>>>>>>>    Set Allow_Blank_State To TRUE
49321>>>>>>>    //DDB-ValidationCustomStart
49321>>>>>>>    //DDB-ValidationCustomEnd
49321>>>>>>>End_Object   // Baxiokat_Baxiokat_Bank_VT
49322>>>>>>>
49322>>>>>>>Object Baxiokat_Baxiokat_Formul_VT  is a DescriptionValidationTable
49324>>>>>>>    Set Allow_Blank_State To TRUE
49325>>>>>>>
49325>>>>>>>    Procedure Fill_List
49327>>>>>>>        Forward Send Fill_List
49329>>>>>>>        Send Add_Table_Value  "0"  ""
49330>>>>>>>        Send Add_Table_Value  "1"  "’ç§¦ª 1"
49331>>>>>>>        Send Add_Table_Value  "2"  "’ç§¦ª 2"
49332>>>>>>>    End_Procedure    // Fill_List
49333>>>>>>>    //DDB-ValidationCustomStart
49333>>>>>>>    //DDB-ValidationCustomEnd
49333>>>>>>>End_Object   // Baxiokat_Baxiokat_Formul_VT
49334>>>>>>>//DDB-ValidationEnd
49334>>>>>>>//DDB-SelectionStart
49334>>>>>>>//DDB/ ExternalSelectionList SL034  SL034.SL
49334>>>>>>>Register_Object SL034
49334>>>>>>>//DDB-SelectionEnd
49334>>>>>>>
49334>>>>>>>Open Syscurxr
49336>>>>>>>Open Btypkin
49338>>>>>>>Open Bkinkat
49340>>>>>>>
49340>>>>>>>
49340>>>>>>>// Apo Baxio_DD
49340>>>>>>>Register_Function private.Default_Axio_C_Code2 Returns String
49340>>>>>>>//
49340>>>>>>>
49340>>>>>>>Class Baxiokat_DataDictionary  is a DataDictionary_Sec
49341>>>>>>>
49341>>>>>>>     Procedure Creating
49342>>>>>>>        Forward Send Creating
49344>>>>>>>        // Insert Code Here
49344>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Baxiokat.Baxiokat_Rec0)))))) to Baxiokat.Baxiokat_Recr
49345>>>>>>>    End_Procedure   // Creating
49346>>>>>>>
49346>>>>>>>     Procedure Construct_Object
49347>>>>>>>               Forward Send Construct_Object
49349>>>>>>>
49349>>>>>>>               //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
49349>>>>>>>               //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
49349>>>>>>>               //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
49349>>>>>>>               //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
49349>>>>>>>               Property Integer piBarticl_dd  0
49350>>>>>>>               Property Integer piBmove_dd    0
49351>>>>>>>               Property Integer piBaxio_dd    0
49352>>>>>>>               Property Integer piBtypkin_dd 0
49353>>>>>>>     End_Procedure   //construct_object
49354>>>>>>>
49354>>>>>>>
49354>>>>>>>     //private
49354>>>>>>>     //¡˜¢œå«˜  ˜§æ: iexit «¦¬ baxiokat_code
49354>>>>>>>     //©œ«á¨œ      : «ž¤ default « £ã «¦¬ baxio_c_code2, ˜¤á¢¦š˜ £œ «¦ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
49354>>>>>>>     Procedure private.Exit_Baxiokat_Code Integer liField Integer liBaxiokat_Code
49355>>>>>>>               String lsBaxio_C_Code_2
49356>>>>>>>        PROCEDURE_RETURN
49357>>>>>>>//jsjsjs 24/01/2001
49357>>>>>>>//               Get File_Field_Current_Value File_Field Year.Year_C_Code0 to lsBaxio_C_Code_2
49357>>>>>>>
49357>>>>>>>//               Set Field_Changed_Value of (piBaxio_dd(Self)) Field Baxio.Baxio_C_Code2 to  lsBaxio_C_Code_2 //(private.Default_Axio_C_Code2((piBAxio_dd(Self))))
49357>>>>>>>//jsjsjs 24/01/2001
49357>>>>>>>     End_Procedure //private.exit_baxiokat_code
49358>>>>>>>
49358>>>>>>>
49358>>>>>>>    //private
49358>>>>>>>    //¡˜¢œå«˜  ˜§æ:
49358>>>>>>>    //©œ«á¨œ : «ž¤ default value to baxiokat_code, ˜¤á¢¦š˜ £œ «¦ btypkin.baxiokat_num
49358>>>>>>>    Procedure private.Entry_Baxiokat_Code Integer liField Integer liBaxiokat_Code
49359>>>>>>>              Integer liBtypkin_dd liBkinkat_Num liBtypkin_Rec0
49360>>>>>>>
49360>>>>>>>        PROCEDURE_RETURN
49361>>>>>>>
49361>>>>>>>
49361>>>>>>>    End_Procedure //private.entry_gtypkin_code
49362>>>>>>>
49362>>>>>>>
49362>>>>>>>
49362>>>>>>>
49362>>>>>>>    Procedure Update
49363>>>>>>>          Forward Send Update
49365>>>>>>>          If (Baxiokat.Baxiokat_Yn5390 = 0);          Begin //œá¤ ›â¤ œå¤˜  £ž®˜¤¦š¨˜­ž£â¤œª œ§ «˜šâª, £ž›â¤ ©œ æ¢˜ «˜ ©®œ« ¡á §œ›å˜
49367>>>>>>>               Move "" to Baxiokat.Baxiokat_Bank
49368>>>>>>>               Move "" to Baxiokat.Baxiokat_Lno
49369>>>>>>>               Move 0  to Baxiokat.Baxiokat_Formul
49370>>>>>>>          End
49370>>>>>>>>
49370>>>>>>>    End_Procedure
49371>>>>>>>
49371>>>>>>>
49371>>>>>>>    Procedure Define_Fields
49372>>>>>>>        Forward Send Define_Fields
49374>>>>>>>        //DDB-Generated-Code-Location
49374>>>>>>>        //DDB-DefineFieldStart
49374>>>>>>>
49374>>>>>>>        Set Main_File            To Baxiokat.File_Number
49375>>>>>>>        Set Cascade_Delete_State To FALSE
49376>>>>>>>
49376>>>>>>>
49376>>>>>>>        // Child (Client) file structure................
49376>>>>>>>        Send Add_Client_File  Baxio.File_Number
49377>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
49378>>>>>>>        Send Add_Client_File  Tpclient.File_Number
49379>>>>>>>        Send Add_Client_File  Tperga.File_Number
49380>>>>>>>        Send Add_Client_File  Tparticl.File_Number
49381>>>>>>>
49381>>>>>>>        // External (System) file structure.............
49381>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
49382>>>>>>>
49382>>>>>>>        Define_Auto_Increment  Sysrecb.Baxiokat_Rec0  To Baxiokat.Baxiokat_Rec0
49385>>>>>>>
49385>>>>>>>        // Field-based properties.......................
49385>>>>>>>
49385>>>>>>>        // Baxiokat.Baxiokat_Code
49385>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Code To (SL034(Self))
49386>>>>>>>
49386>>>>>>>        // Baxiokat.Baxiokat_Descr
49386>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Descr To (SL034(Self))
49387>>>>>>>
49387>>>>>>>        // Baxiokat.Baxiokat_Rec0
49387>>>>>>>
49387>>>>>>>        // Baxiokat.Baxiokat_Recr
49387>>>>>>>
49387>>>>>>>        // Baxiokat.Baxiokat_Type
49387>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Type To (Baxiokat_Type_VT(Self))
49388>>>>>>>
49388>>>>>>>        // Baxiokat.Baxio_Lcode
49388>>>>>>>        //DDB/ Comment_Short       Field Baxiokat.Baxio_Lcode To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ creating/deleting «¦¬ baxio)"
49388>>>>>>>
49388>>>>>>>        // Baxiokat.Baxiokat_Yn5390
49388>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Yn5390 To (Baxiokat_Baxiokat_Yn5390_VT(Self))
49389>>>>>>>
49389>>>>>>>        // Baxiokat.Baxiokat_Bank
49389>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Bank To (Baxiokat_Baxiokat_Bank_VT(Self))
49390>>>>>>>
49390>>>>>>>        // Baxiokat.Baxiokat_Lno
49390>>>>>>>
49390>>>>>>>        // Baxiokat.Baxiokat_Formul
49390>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Formul To (Baxiokat_Baxiokat_Formul_VT(Self))
49391>>>>>>>
49391>>>>>>>        //DDB-DefineFieldEnd
49391>>>>>>>
49391>>>>>>>        Set Main_File            To Baxiokat.File_Number
49392>>>>>>>        Set Cascade_Delete_State To FALSE
49393>>>>>>>
49393>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
49394>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
49395>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49396>>>>>>>
49396>>>>>>>        // Child (Client) file structure................
49396>>>>>>>        Send Add_Client_File  Baxio.File_Number
49397>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
49398>>>>>>>
49398>>>>>>>        // External (System) file structure.............
49398>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
49399>>>>>>>
49399>>>>>>>        Define_Auto_Increment  Sysrecb.Baxiokat_Rec0  To Baxiokat.Baxiokat_Rec0
49402>>>>>>>
49402>>>>>>>        // Field-based properties.......................
49402>>>>>>>
49402>>>>>>>        // Baxiokat.Baxiokat_Code
49402>>>>>>>        Set Field_Entry_msg        Field Baxiokat.Baxiokat_Code   To private.Entry_Baxiokat_Code
49403>>>>>>>        Set Field_Exit_msg         Field Baxiokat.Baxiokat_Code   To private.Exit_Baxiokat_Code
49404>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Code   To "‰à› ¡æª „å›¦¬ª €¥ ¦š¨á­¦¬"
49405>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Code   To "„å›¦ª"
49406>>>>>>>        Set Field_Options          Field Baxiokat.Baxiokat_Code   To DD_AUTOFIND    DD_REQUIRED
49407>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Code   To (SL034(Self))
49408>>>>>>>        Set Key_Field_State        Field Baxiokat.Baxiokat_Code   To TRUE
49409>>>>>>>
49409>>>>>>>        // Baxiokat.Baxiokat_Descr
49409>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Descr  To "œ¨ š¨˜­ã „å›¦¬ª €¥ ¦š¨á­¦¬"
49410>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Descr  To "œ¨ š¨˜­ã"
49411>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Descr  To (SL034(Self))
49412>>>>>>>
49412>>>>>>>        // Baxiokat.Baxiokat_Rec0
49412>>>>>>>        Set Field_Options          Field Baxiokat.Baxiokat_Rec0   To DD_AUTOFIND    DD_REQUIRED
49413>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Rec0   To (SL034(Self))
49414>>>>>>>        Set Key_Field_State        Field Baxiokat.Baxiokat_Rec0   To TRUE
49415>>>>>>>
49415>>>>>>>        // Baxiokat.Baxiokat_Type
49415>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Type   To "dbComboForm_EZ"
49416>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Type   To "„ ©§¨˜¡«â¦/¢ž¨à«â¦"
49417>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Type   To "„ ©./¢ã¨."
49418>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Type   To (Baxiokat_Type_VT(Self))
49419>>>>>>>
49419>>>>>>>        // Baxiokat.Baxio_Lcode
49419>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxio_Lcode     To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª €¥ ¦šá­¦¬"
49420>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxio_Lcode     To "’œ¢.€¨ Ÿ£æª"
49421>>>>>>>        //Set Field_Options          Field Baxiokat.Baxio_Lcode     To DD_DISPLAYONLY
49421>>>>>>>
49421>>>>>>>        // Baxiokat.Baxiokat_Yn5390
49421>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Yn5390 To "dbComboForm_EZ"
49422>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Yn5390 To "‹ž®˜¤¦š¨˜­ž£â¤œª „§ «˜šâª ?"
49423>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Yn5390 To "‹ž®/¡âª „§ «˜šâª"
49424>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Yn5390 To (Baxiokat_Baxiokat_Yn5390_VT(Self))
49425>>>>>>>
49425>>>>>>>        // Baxiokat.Baxiokat_Bank
49425>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Bank   To "dbComboForm_EZ"
49426>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Bank   To "’¨á§œ˜"
49427>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Bank   To "’¨á§œ˜"
49428>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Bank   To (Baxiokat_Baxiokat_Bank_VT(Self))
49429>>>>>>>
49429>>>>>>>        // Baxiokat.Baxiokat_Lno
49429>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Lno    To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª"
49430>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Lno    To "’œ¢.€¨ Ÿ£æª"
49431>>>>>>>
49431>>>>>>>        // Baxiokat.Baxiokat_Formul
49431>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Formul To "dbComboForm_EZ"
49432>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Formul To "€¢šæ¨ Ÿ£¦ª Check Digit"
49433>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Formul To "Check Digit"
49434>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Formul To (Baxiokat_Baxiokat_Formul_VT(Self))
49435>>>>>>>
49435>>>>>>>    End_Procedure    // Define_Fields
49436>>>>>>>
49436>>>>>>>
49436>>>>>>>    Procedure Field_Defaults
49437>>>>>>>        Forward Send Field_Defaults
49439>>>>>>>        //DDB-Generated-Code-Location
49439>>>>>>>        //DDB-FieldDefaultStart
49439>>>>>>>        //DDB-FieldDefaultEnd
49439>>>>>>>        Set Field_Changed_Value   Field Baxiokat.Baxiokat_Yn5390 To 0
49440>>>>>>>    End_Procedure    // Field_Defaults
49441>>>>>>>
49441>>>>>>>End_Class    // Baxiokat_DataDictionary
49442>>>>>>>//DDB-Selection-pkg-Start
49442>>>>>>>
49442>>>>>>>Use SL034.SL         // SL034
INCLUDING FILE: SL034.SL
49442>>>>>>>>>//AB/ Project SL034:BAXIOKAT
49442>>>>>>>>>//AB/ Object prj is a Lookup_Project
49442>>>>>>>>>//AB/     Set ProjectName to "SL034:BAXIOKAT"
49442>>>>>>>>>//AB/     Set ProjectFileName to "SL034.SL"
49442>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
49442>>>>>>>>>
49442>>>>>>>>>// Project Object Structure
49442>>>>>>>>>//   SL034 is a dbModalPanelSub
49442>>>>>>>>>//     Baxiokat_DD is a DataDictionary
49442>>>>>>>>>//     oSelList is a dbListSub
49442>>>>>>>>>//     oOK_bn is a ButtonSub
49442>>>>>>>>>//     oCancel_bn is a ButtonSub
49442>>>>>>>>>//     oSearch_bn is a ButtonSub
49442>>>>>>>>>
49442>>>>>>>>>// Register all objects
49442>>>>>>>>>Register_Object Baxiokat_DD
49442>>>>>>>>>Register_Object oCancel_bn
49442>>>>>>>>>Register_Object oOK_bn
49442>>>>>>>>>Register_Object oSearch_bn
49442>>>>>>>>>Register_Object oSelList
49442>>>>>>>>>Register_Object SL034
49442>>>>>>>>>
49442>>>>>>>>>
49442>>>>>>>>>//AB-IgnoreStart
49442>>>>>>>>>
49442>>>>>>>>>Use DFAllEnt.pkg
49442>>>>>>>>>Use dbList.Sub
49442>>>>>>>>>Use Button.Sub
49442>>>>>>>>>
49442>>>>>>>>>
49442>>>>>>>>>Use BAXIOKAT.DD
49442>>>>>>>>>
49442>>>>>>>>>//AB-IgnoreEnd
49442>>>>>>>>>
49442>>>>>>>>>CD_Popup_Object SL034 is a dbModalPanelSub
49461>>>>>>>>>    set label to "‰˜«žš¦¨åœª €¥ ¦š¨á­à¤" 
49462>>>>>>>>>    Set Size to 206 347
49463>>>>>>>>>    Set Location to 4 5
49464>>>>>>>>>    Set Exit_Application_Local_State to FALSE
49465>>>>>>>>>    Set Modal_State to FALSE
49466>>>>>>>>>
49466>>>>>>>>>    //AB-DDOStart
49466>>>>>>>>>
49466>>>>>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
49468>>>>>>>>>    End_Object    // Baxiokat_DD
49469>>>>>>>>>
49469>>>>>>>>>    Set Main_DD to (Baxiokat_DD(self))
49470>>>>>>>>>    Set Server to (Baxiokat_DD(self))
49471>>>>>>>>>
49471>>>>>>>>>    //AB-DDOEnd
49471>>>>>>>>>
49471>>>>>>>>>    Object oSelList is a dbListSub
49473>>>>>>>>>        Set Main_File to Baxiokat.File_Number
49474>>>>>>>>>        Set Size to 164 335
49475>>>>>>>>>        Set Location to 5 4
49476>>>>>>>>>
49476>>>>>>>>>        Begin_Row
49479>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_code
49480>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_descr
49481>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_type
49482>>>>>>>>>            Entry_Item (Export_Code_Description(Self,2,Baxiokat.Baxiokat_type))
49483>>>>>>>>>        End_Row
49488>>>>>>>>>
49488>>>>>>>>>        Set Form_Width    item 0 to 55
49489>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
49490>>>>>>>>>
49490>>>>>>>>>        Set Form_Width    item 1 to 172
49491>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
49492>>>>>>>>>
49492>>>>>>>>>        Set Form_Width    item 2 to 16
49493>>>>>>>>>        set header_label  item 2 to "’ç§¦ª" 
49494>>>>>>>>>
49494>>>>>>>>>        Set Form_Width    item 3 to 83
49495>>>>>>>>>        set header_label  item 3 to "„ ©./¢ž¨." 
49496>>>>>>>>>
49496>>>>>>>>>    End_Object    // oSelList
49497>>>>>>>>>
49497>>>>>>>>>    Object oOK_bn is a ButtonSub
49499>>>>>>>>>        set label to "&„§ ¢¦šã" 
49500>>>>>>>>>        Set Location to 172 180
49501>>>>>>>>>
49501>>>>>>>>>        //AB-StoreStart
49501>>>>>>>>>        Procedure OnClick
49503>>>>>>>>>            Send OK To oSelList
49504>>>>>>>>>        End_Procedure
49505>>>>>>>>>        //AB-StoreEnd
49505>>>>>>>>>
49505>>>>>>>>>    End_Object    // oOK_bn
49506>>>>>>>>>
49506>>>>>>>>>    Object oCancel_bn is a ButtonSub
49508>>>>>>>>>        set label to "&€¡ç¨à©ž" 
49509>>>>>>>>>        Set Location to 172 234
49510>>>>>>>>>
49510>>>>>>>>>        //AB-StoreStart
49510>>>>>>>>>        Procedure OnClick
49512>>>>>>>>>            Send Cancel To oSelList
49513>>>>>>>>>        End_Procedure
49514>>>>>>>>>        //AB-StoreEnd
49514>>>>>>>>>
49514>>>>>>>>>    End_Object    // oCancel_bn
49515>>>>>>>>>
49515>>>>>>>>>    Object oSearch_bn is a ButtonSub
49517>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
49518>>>>>>>>>        Set Location to 172 289
49519>>>>>>>>>
49519>>>>>>>>>        //AB-StoreStart
49519>>>>>>>>>        Procedure OnClick
49521>>>>>>>>>            Send Search To oSelList
49522>>>>>>>>>        End_Procedure
49523>>>>>>>>>        //AB-StoreEnd
49523>>>>>>>>>
49523>>>>>>>>>    End_Object    // oSearch_bn
49524>>>>>>>>>
49524>>>>>>>>>
49524>>>>>>>>>    //AB-StoreStart
49524>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
49525>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
49526>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
49527>>>>>>>>>    //AB-StoreEnd
49527>>>>>>>>>
49527>>>>>>>>>CD_End_Object    // SL034
49529>>>>>>>>>>
49529>>>>>>>>>
49529>>>>>>>>>//AB/ End_Object    // prj
49529>>>>>>>
49529>>>>>>>//DDB-Selection-pkg-End
49529>>>>>>>//DDB-FileEnd
49529>>>>>Use BAXIO.DD
49529>>>>>
49529>>>>>//AB-IgnoreEnd
49529>>>>>
49529>>>>>Object SL037 is a dbModalPanelSub
49531>>>>>
49531>>>>>    //AB-StoreTopStart
49531>>>>>                        
49531>>>>>    Property Integer piFragmaBaxiokatRec0 Public  0
49533>>>>>    Property Integer piFragmaBaxiokatCode Public  0
49535>>>>>    Property Integer piFragmaBaxioStatus  Public  0
49537>>>>>    Property Integer piFragmaBaxioPlace   Public  0
49539>>>>>    Property string  psfragmaclient       Public ''
49541>>>>>    Property String  psFragmaBaxioStatus  Public ''
49543>>>>>    Property String  psEkdoths            Public ''
49545>>>>>    Property String  psApodekths          Public ''
49547>>>>>    Property Date pdApo                   Public ''
49549>>>>>    Property Date pdEos                   Public ''
49551>>>>>    
49551>>>>>    //AB-StoreTopEnd
49551>>>>>
49551>>>>>    Set Label to "‰˜«á¢¦š¦ª €¥ ¦š¨á­à¤"
49552>>>>>    Set Size to 287 527
49553>>>>>    Set Location to 2 3
49554>>>>>    Set Exit_Application_Local_State to FALSE
49555>>>>>    Set Modal_State to FALSE
49556>>>>>
49556>>>>>    //AB-DDOStart
49556>>>>>
49556>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
49558>>>>>    End_Object    // Baxiokat_DD
49559>>>>>
49559>>>>>    Object Baxio_DD is a Baxio_DataDictionary
49561>>>>>        Set DDO_Server to (Baxiokat_DD(self))
49562>>>>>
49562>>>>>        //AB-StoreStart
49562>>>>>                                                    
49562>>>>>        Function fiIsOK Returns Integer
49564>>>>>            String lsBaxioStatus sclient
49565>>>>>            Get psFragmaBaxioStatus  to lsBaxioStatus
49566>>>>>            Get psfragmaclient       to sclient
49567>>>>>            If (Trim(sClient)='') Begin
49569>>>>>                If (lsBaxioStatus Contains Baxio.Baxio_Status) Function_Return 1
49572>>>>>            End
49572>>>>>>
49572>>>>>            Else Begin
49573>>>>>                If (baxio.baxio_desm Eq sClient And lsBaxioStatus Contains Baxio.Baxio_Status) Function_Return 1
49576>>>>>            End
49576>>>>>>
49576>>>>>            Function_Return 0
49577>>>>>        End_Function
49578>>>>>        
49578>>>>>        Procedure OnConstrain
49580>>>>>        
49580>>>>>            Integer liBaxiokatCode liBaxioStatus liBaxioPlace
49581>>>>>            string  sclient lsBaxioStatus sApodekths sEkdoths
49581>>>>>            Date    dApo dEos
49581>>>>>        
49581>>>>>            Forward Send OnConstrain
49583>>>>>        
49583>>>>>            Get piFragmaBaxiokatCode    to liBaxiokatCode
49584>>>>>            Get psFragmaBaxioStatus     to lsBaxioStatus
49585>>>>>            Get piFragmaBaxioPlace      to liBaxioPlace
49586>>>>>        
49586>>>>>            Get psApodekths             to sApodekths
49587>>>>>            Get psEkdoths               to sEkdoths
49588>>>>>            Get pdApo                   to dApo
49589>>>>>            Get pdEos                   to dEos
49590>>>>>        
49590>>>>>            If (liBaxioKatCode <> 0) Begin
49592>>>>>                Constrain Baxio.Baxiokat_Code eq liBaxiokatCode
49594>>>>>                If (liBaxioPlace  <> 0)  Constrain Baxio.Baxio_Place eq liBaxioPlace
49598>>>>>                If (lsBaxioStatus <> '') Constrain Baxio as (fiIsOK(Self)=1)
49601>>>>>            End
49601>>>>>>
49601>>>>>        
49601>>>>>            If (sApodekths  <>'') Constrain Baxio.Baxio_Code_Out    Eq sApodekths
49605>>>>>            If (sEkdoths    <>'') Constrain Baxio.Baxio_Code_In     Eq sEkdoths
49609>>>>>            If (dApo        <>'') Constrain Baxio.Baxio_HmniaL      Ge dApo
49613>>>>>            If (dEos        <>'') Constrain Baxio.Baxio_HmniaL      Le dEos
49617>>>>>        
49617>>>>>        End_Procedure // OnConstrain
49618>>>>>        
49618>>>>>        
49618>>>>>        
49618>>>>>        
49618>>>>>        
49618>>>>>        
49618>>>>>        
49618>>>>>        
49618>>>>>        
49618>>>>>        
49618>>>>>        
49618>>>>>        
49618>>>>>        
49618>>>>>        //AB-StoreEnd
49618>>>>>
49618>>>>>    End_Object    // Baxio_DD
49619>>>>>
49619>>>>>    Set Main_DD to (Baxio_DD(self))
49620>>>>>    Set Server to (Baxio_DD(self))
49621>>>>>
49621>>>>>    //AB-DDOEnd
49621>>>>>
49621>>>>>    Object oSelList is a dbListSub
49623>>>>>        Set Main_File to Baxio.File_Number
49624>>>>>        Set Size to 228 514
49625>>>>>        Set Location to 4 6
49626>>>>>
49626>>>>>        Begin_Row
49629>>>>>            Entry_Item Baxio.Baxio_code
49630>>>>>            Entry_Item Baxio.Baxio_epon_in
49631>>>>>            Entry_Item Baxio.Baxio_epon_out
49632>>>>>            Entry_Item Baxiokat.Baxiokat_descr
49633>>>>>            Entry_Item Baxio.Baxio_hmnial
49634>>>>>            Entry_Item Baxio.Baxio_v2
49635>>>>>            Entry_Item Baxio.Baxio_banka
49636>>>>>            Entry_Item (Export_Code_Description(Self,6,Baxio.Baxio_banka))
49637>>>>>            Entry_Item Baxio.Baxio_no
49638>>>>>        End_Row
49643>>>>>
49643>>>>>        Set Form_Width    item 0 to 41
49644>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
49645>>>>>        
49645>>>>>        Set Form_Width    item 1 to 98
49646>>>>>        Set Header_Label  item 1 to "„¡›æ«žª"
49647>>>>>        
49647>>>>>        Set Form_Width    item 2 to 94
49648>>>>>        Set Header_Label  item 2 to "€§¦›â¡«žª"
49649>>>>>        
49649>>>>>        Set Form_Width    item 3 to 75
49650>>>>>        Set Header_Label  item 3 to "œ¨ š¨˜­ã"
49651>>>>>        
49651>>>>>        Set Form_Width    item 4 to 47
49652>>>>>        Set Header_Label  item 4 to "Šã¥ž"
49653>>>>>        
49653>>>>>        Set Form_Width    item 5 to 48
49654>>>>>        Set Header_Label  item 5 to "¦©æ"
49655>>>>>        
49655>>>>>        Set Form_Width    item 6 to 12
49656>>>>>        Set Header_Label  item 6 to "‰à› ¡æª ’¨á§œ˜"
49657>>>>>        
49657>>>>>        Set Form_Width    item 7 to 42
49658>>>>>        Set Header_Label  item 7 to "’¨á§œ˜"
49659>>>>>        
49659>>>>>        Set Form_Width    item 8 to 53
49660>>>>>        Set Header_Label  item 8 to "€¨ Ÿ£æª"
49661>>>>>        
49661>>>>>
49661>>>>>        //AB-StoreStart
49661>>>>>                
49661>>>>>        Property Integer piStoreFragmaBaxiokatRec0 Public 0
49663>>>>>        Property Integer piStoreFragmaBaxiokatCode Public 0
49665>>>>>        Property Integer piStoreFragmaBaxioStatus  Public 0
49667>>>>>        Property Integer piStoreFragmaBaxioPlace   Public 0
49669>>>>>        Property String  psStoreFragmaBaxioStatus  Public ''
49671>>>>>        
49671>>>>>        Procedure Store_Defaults
49673>>>>>            Forward Send Store_Defaults
49675>>>>>            Set piStoreFragmaBaxiokatRec0 to (piFragmaBaxiokatRec0(Self))
49676>>>>>            Set piStoreFragmaBaxiokatCode to (piFragmaBaxiokatCode(Self))
49677>>>>>            Set piStoreFragmaBaxioStatus  to (piFragmaBaxioStatus(Self))
49678>>>>>            Set piStoreFragmaBaxioPlace   to (piFragmaBaxioPlace(Self))
49679>>>>>            Set psStoreFragmaBaxioStatus  to (psFragmaBaxioStatus(Self))
49680>>>>>        End_Procedure // Store_Defaults
49681>>>>>        
49681>>>>>        Procedure Restore_Defaults
49683>>>>>            Forward Send Restore_Defaults
49685>>>>>            Set piFragmaBaxiokatRec0 to (piStoreFragmaBaxiokatRec0(Self))
49686>>>>>            Set piFragmaBaxiokatCode to (piStoreFragmaBaxiokatCode(Self))
49687>>>>>            Set piFragmaBaxioStatus  to (piStoreFragmaBaxioStatus(Self))
49688>>>>>            Set piFragmaBaxioPlace   to (piStoreFragmaBaxioPlace(Self))
49689>>>>>            Set psFragmaBaxioStatus  to (psStoreFragmaBaxioStatus(Self))
49690>>>>>        End_Procedure // Restore_Defaults
49691>>>>>        
49691>>>>>        Procedure Activating
49693>>>>>            Forward Send Activating
49695>>>>>         //   Set Auto_Index_State        to True
49695>>>>>            Send Rebuild_Constraints    to Baxio_DD
49696>>>>>        End_Procedure
49697>>>>>        
49697>>>>>        Procedure End_Construct_Object
49699>>>>>            Integer iDecs
49700>>>>>            Forward Send End_Construct_Object
49702>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    iDecs
49703>>>>>            Set Points Item 5 to iDecs
49704>>>>>            Set Numeric_Mask Item 5 to 10 iDecs ' ,*'
49705>>>>>        End_Procedure
49706>>>>>        
49706>>>>>        
49706>>>>>        
49706>>>>>        
49706>>>>>        
49706>>>>>        
49706>>>>>        
49706>>>>>        
49706>>>>>        
49706>>>>>        
49706>>>>>        
49706>>>>>        //AB-StoreEnd
49706>>>>>
49706>>>>>    End_Object    // oSelList
49707>>>>>
49707>>>>>    Object TextBoxSub1 is a TextBoxSub
49709>>>>>        Set Label to "Šã¥ž ˜§¦"
49710>>>>>        Set Location to 241 7
49711>>>>>        Set Size to 10 35
49712>>>>>        Set TypeFace to "MS Sans Serif"
49713>>>>>    End_Object    // TextBoxSub1
49714>>>>>
49714>>>>>    Object cSyDateForm1 is a cSyDateForm
49716>>>>>        Set Size to 13 66
49717>>>>>        Set Location to 240 45
49718>>>>>        Set Label_Col_Offset to 2
49719>>>>>        Set Label_Justification_Mode to jMode_Right
49720>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
49721>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
49722>>>>>
49722>>>>>        //AB-StoreStart
49722>>>>>                                                    
49722>>>>>        Procedure Key Integer iKey
49724>>>>>            Integer iRetVal
49725>>>>>            Forward Send Key iKey
49727>>>>>            If (iKey=277) Begin
49729>>>>>                Set Value Item 0 to ''
49730>>>>>                //Send KeyAction to ButtonSub1
49730>>>>>            End
49730>>>>>>
49730>>>>>        End_Procedure
49731>>>>>        
49731>>>>>        
49731>>>>>        //AB-StoreEnd
49731>>>>>
49731>>>>>    End_Object    // cSyDateForm1
49732>>>>>
49732>>>>>    Object TextBoxSub2 is a TextBoxSub
49734>>>>>        Set Label to "Šã¥ž œàª"
49735>>>>>        Set Location to 258 7
49736>>>>>        Set Size to 10 35
49737>>>>>        Set TypeFace to "MS Sans Serif"
49738>>>>>    End_Object    // TextBoxSub2
49739>>>>>
49739>>>>>    Object cSyDateForm2 is a cSyDateForm
49741>>>>>        Set Size to 13 66
49742>>>>>        Set Location to 256 45
49743>>>>>        Set Label_Col_Offset to 2
49744>>>>>        Set Label_Justification_Mode to jMode_Right
49745>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
49746>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
49747>>>>>
49747>>>>>        //AB-StoreStart
49747>>>>>                                                    
49747>>>>>        Procedure Key Integer iKey
49749>>>>>            Integer iRetVal
49750>>>>>            Forward Send Key iKey
49752>>>>>            If (iKey=277) Begin
49754>>>>>                Set Value Item 0 to ''
49755>>>>>                //Send KeyAction to ButtonSub1
49755>>>>>            End
49755>>>>>>
49755>>>>>        End_Procedure
49756>>>>>        
49756>>>>>        
49756>>>>>        //AB-StoreEnd
49756>>>>>
49756>>>>>    End_Object    // cSyDateForm2
49757>>>>>
49757>>>>>    Object TextBoxSub4 is a TextBoxSub
49759>>>>>        Set Label to "„¡›æ«žª"
49760>>>>>        Set Location to 241 118
49761>>>>>        Set Size to 10 33
49762>>>>>        Set TypeFace to "MS Sans Serif"
49763>>>>>    End_Object    // TextBoxSub4
49764>>>>>
49764>>>>>    Object TextBoxSub5 is a TextBoxSub
49766>>>>>        Set Label to "€§¦›â¡«žª"
49767>>>>>        Set Location to 258 118
49768>>>>>        Set Size to 10 39
49769>>>>>        Set TypeFace to "MS Sans Serif"
49770>>>>>    End_Object    // TextBoxSub5
49771>>>>>
49771>>>>>    Object FormSub1 is a FormSub
49773>>>>>        Set Size to 13 77
49774>>>>>        Set Location to 240 159
49775>>>>>        Set Label_Col_Offset to 2
49776>>>>>        Set Prompt_Button_Mode to pb_PromptOn
49777>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
49778>>>>>
49778>>>>>        //AB-StoreStart
49778>>>>>                                                    
49778>>>>>        Set Prompt_Object to (sl100(Self))
49779>>>>>        
49779>>>>>        Procedure OnChange
49781>>>>>            String s1
49782>>>>>            Get Value Item 0 to s1
49783>>>>>            Set Value Of FormSub2 Item 0 to (fsClient(Self,s1))
49784>>>>>            Set psEkdoths to s1
49785>>>>>        End_Procedure
49786>>>>>        
49786>>>>>        
49786>>>>>        
49786>>>>>        
49786>>>>>        
49786>>>>>        
49786>>>>>        
49786>>>>>        //AB-StoreEnd
49786>>>>>
49786>>>>>    End_Object    // FormSub1
49787>>>>>
49787>>>>>    Object FormSub2 is a FormSub
49789>>>>>        Set Size to 13 187
49790>>>>>        Set Location to 240 240
49791>>>>>        Set Color to clBtnFace
49792>>>>>        Set Label_Col_Offset to 2
49793>>>>>        Set Enabled_State to FALSE
49794>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
49795>>>>>        Set Item_Shadow_State Item 0 to TRUE
49796>>>>>        Set Shadow_State Item 0 to TRUE
49797>>>>>    End_Object    // FormSub2
49798>>>>>
49798>>>>>    Object FormSub3 is a FormSub
49800>>>>>        Set Size to 13 77
49801>>>>>        Set Location to 256 159
49802>>>>>        Set Label_Col_Offset to 2
49803>>>>>        Set Prompt_Button_Mode to pb_PromptOn
49804>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
49805>>>>>
49805>>>>>        //AB-StoreStart
49805>>>>>                                                    
49805>>>>>        Set Prompt_Object to (sl100(Self))
49806>>>>>        
49806>>>>>        Procedure OnChange
49808>>>>>            String s1
49809>>>>>            Get Value Item 0 to s1
49810>>>>>            Set Value Of FormSub4 Item 0 to (fsClient(Self,s1))
49811>>>>>            Set psApodekths to s1
49812>>>>>        End_Procedure
49813>>>>>        
49813>>>>>        
49813>>>>>        
49813>>>>>        
49813>>>>>        
49813>>>>>        
49813>>>>>        
49813>>>>>        //AB-StoreEnd
49813>>>>>
49813>>>>>    End_Object    // FormSub3
49814>>>>>
49814>>>>>    Object FormSub4 is a FormSub
49816>>>>>        Set Size to 13 187
49817>>>>>        Set Location to 256 240
49818>>>>>        Set Color to clBtnFace
49819>>>>>        Set Label_Col_Offset to 2
49820>>>>>        Set Enabled_State to FALSE
49821>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
49822>>>>>        Set Item_Shadow_State Item 0 to TRUE
49823>>>>>        Set Shadow_State Item 0 to TRUE
49824>>>>>    End_Object    // FormSub4
49825>>>>>
49825>>>>>    Object ButtonSub1 is a ButtonSub
49827>>>>>        Set Label to "œ¨ æ¨ ©œ"
49828>>>>>        Set Size to 14 43
49829>>>>>        Set Location to 256 430
49830>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
49831>>>>>
49831>>>>>        //AB-StoreStart
49831>>>>>                                                    
49831>>>>>        Procedure OnClick
49833>>>>>            Date dApo dEos
49834>>>>>            Get Value Of cSyDateForm1 Item 0 to dApo
49835>>>>>            Get Value Of cSyDateForm2 Item 0 to dEos
49836>>>>>            Set pdApo to dApo
49837>>>>>            Set pdEos to dEos
49838>>>>>            Send Rebuild_Constraints to Baxio_DD
49839>>>>>            Send Beginning_Of_Data to oSelList True
49840>>>>>        End_Procedure // OnClick
49841>>>>>        
49841>>>>>        
49841>>>>>        
49841>>>>>        
49841>>>>>        
49841>>>>>        
49841>>>>>        
49841>>>>>        
49841>>>>>        
49841>>>>>        
49841>>>>>        
49841>>>>>        
49841>>>>>        
49841>>>>>        //AB-StoreEnd
49841>>>>>
49841>>>>>    End_Object    // ButtonSub1
49842>>>>>
49842>>>>>    Object oOK_bn is a ButtonSub
49844>>>>>        Set Label to "&„§ ¢¦šã"
49845>>>>>        Set Size to 14 43
49846>>>>>        Set Location to 256 478
49847>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
49848>>>>>
49848>>>>>        //AB-StoreStart
49848>>>>>        Procedure OnClick
49850>>>>>            Send OK To oSelList
49851>>>>>        End_Procedure
49852>>>>>        //AB-StoreEnd
49852>>>>>
49852>>>>>    End_Object    // oOK_bn
49853>>>>>
49853>>>>>
49853>>>>>    //AB-StoreStart
49853>>>>>                        
49853>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
49854>>>>>    
49854>>>>>    Procedure Request_Cancel
49856>>>>>        Set Value Of cSyDateForm1 Item 0 to ''
49857>>>>>        Set Value Of cSyDateForm2 Item 0 to ''
49858>>>>>        Set Value Of FormSub1     Item 0 to ''
49859>>>>>        Set Value Of FormSub2     Item 0 to ''
49860>>>>>        Forward Send Request_Cancel
49862>>>>>    End_Procedure
49863>>>>>    
49863>>>>>    
49863>>>>>    
49863>>>>>    
49863>>>>>    
49863>>>>>    //AB-StoreEnd
49863>>>>>
49863>>>>>End_Object    // SL037
49864>>>>>
49864>>>>>
49864>>>>>//AB-StoreStart
49864>>>>>    
49864>>>>>//AB-StoreEnd
49864>>>>>
49864>>>>>//AB/ End_Object    // prj
49864>>>Use slnomism.sl      // slNomism
INCLUDING FILE: SLNOMISM.SL
49864>>>>>//AB/ Project slNomism
49864>>>>>//AB/ Object prj is a Lookup_Project
49864>>>>>//AB/     Set ProjectName to "slNomism"
49864>>>>>//AB/     Set ProjectFileName to "slNomism.SL"
49864>>>>>//AB/     Set GenerateFileName to "NONAME"
49864>>>>>
49864>>>>>// Project Object Structure
49864>>>>>//   slNomism is a dbModalPanelSub
49864>>>>>//     Nomisma_DD is a DataDictionary
49864>>>>>//     oSelList is a dbListSub
49864>>>>>//     oOK_bn is a ButtonSub
49864>>>>>//     oSearch_bn is a ButtonSub
49864>>>>>
49864>>>>>// Register all objects
49864>>>>>Register_Object Nomisma_DD
49864>>>>>Register_Object oOK_bn
49864>>>>>Register_Object oSearch_bn
49864>>>>>Register_Object oSelList
49864>>>>>Register_Object slNomism
49864>>>>>
49864>>>>>
49864>>>>>//AB-IgnoreStart
49864>>>>>
49864>>>>>Use DFAllEnt.pkg
49864>>>>>Use dbList.Sub
49864>>>>>Use Button.Sub
49864>>>>>
49864>>>>>
49864>>>>>Use NOMISMA.DD
INCLUDING FILE: NOMISMA.DD
49864>>>>>>>//DDB-FileStart
49864>>>>>>>//DDB-HeaderStart
49864>>>>>>>
49864>>>>>>>// File Name : NOMISMA.DD
49864>>>>>>>// Class Name: Nomisma_DataDictionary
49864>>>>>>>// Revision  : 52
49864>>>>>>>// Version   : 2
49864>>>>>>>
49864>>>>>>>Use  Windows           // Basic Definitions
49864>>>>>>>Use  DataDict          // DataDictionary Class Definition
49864>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49864>>>>>>>
49864>>>>>>>Open Nomisma
49866>>>>>>>Open Isotimia
49868>>>>>>>Open Particle
49870>>>>>>>
49870>>>>>>>//DDB-HeaderEnd
49870>>>>>>>//DDB-ValidationStart
49870>>>>>>>
49870>>>>>>>Register_Object Nomisma_Nomisma_Type_VT
49870>>>>>>>Register_Object Nomisma_Nomisma_Sign0_VT
49870>>>>>>>Register_Object Nomisma_Nomisma_Sign00_VT
49870>>>>>>>Register_Object Nomisma_Nomisma_Signr_VT
49870>>>>>>>
49870>>>>>>>Object Nomisma_Nomisma_Type_VT  is a DescriptionValidationTable
49872>>>>>>>
49872>>>>>>>    Procedure Fill_List
49874>>>>>>>        Forward Send Fill_List
49876>>>>>>>        Send Add_Table_Value  "1"  "Book1"
49877>>>>>>>        Send Add_Table_Value  "2"  "Book2"
49878>>>>>>>        Send Add_Table_Value  "3"  "Reporting"
49879>>>>>>>        Send Add_Table_Value  "0"  "Other"
49880>>>>>>>    End_Procedure    // Fill_List
49881>>>>>>>    //DDB-ValidationCustomStart
49881>>>>>>>    //DDB-ValidationCustomEnd
49881>>>>>>>End_Object   // Nomisma_Nomisma_Type_VT
49882>>>>>>>
49882>>>>>>>Object Nomisma_Nomisma_Sign0_VT  is a DescriptionValidationTable
49884>>>>>>>
49884>>>>>>>    Procedure Fill_List
49886>>>>>>>        Forward Send Fill_List
49888>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
49889>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
49890>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨œ¯ £¦"
49891>>>>>>>    End_Procedure    // Fill_List
49892>>>>>>>    //DDB-ValidationCustomStart
49892>>>>>>>    //DDB-ValidationCustomEnd
49892>>>>>>>End_Object   // Nomisma_Nomisma_Sign0_VT
49893>>>>>>>
49893>>>>>>>Object Nomisma_Nomisma_Sign00_VT  is a DescriptionValidationTable
49895>>>>>>>
49895>>>>>>>    Procedure Fill_List
49897>>>>>>>        Forward Send Fill_List
49899>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
49900>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
49901>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨â¯ £¦"
49902>>>>>>>    End_Procedure    // Fill_List
49903>>>>>>>    //DDB-ValidationCustomStart
49903>>>>>>>    //DDB-ValidationCustomEnd
49903>>>>>>>End_Object   // Nomisma_Nomisma_Sign00_VT
49904>>>>>>>
49904>>>>>>>Object Nomisma_Nomisma_Signr_VT  is a DescriptionValidationTable
49906>>>>>>>
49906>>>>>>>    Procedure Fill_List
49908>>>>>>>        Forward Send Fill_List
49910>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
49911>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
49912>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨â¯ £¦"
49913>>>>>>>    End_Procedure    // Fill_List
49914>>>>>>>    //DDB-ValidationCustomStart
49914>>>>>>>    //DDB-ValidationCustomEnd
49914>>>>>>>End_Object   // Nomisma_Nomisma_Signr_VT
49915>>>>>>>//DDB-ValidationEnd
49915>>>>>>>//DDB-SelectionStart
49915>>>>>>>//DDB/ ExternalSelectionList sl059  sl059.sl
49915>>>>>>>Register_Object sl059
49915>>>>>>>//DDB-SelectionEnd
49915>>>>>>>
49915>>>>>>>Class Nomisma_DataDictionary  is a DataDictionary_Sec
49916>>>>>>>
49916>>>>>>>    Procedure Construct_Object
49917>>>>>>>        Forward Send Construct_Object
49919>>>>>>>        Property String psOldCode Public ''
49920>>>>>>>    End_procedure
49921>>>>>>>
49921>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
49922>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
49924>>>>>>>        Set psOldCode to Nomisma.Nomisma_Code
49925>>>>>>>    End_Procedure   // New_Current_Record
49926>>>>>>>
49926>>>>>>>    Procedure Save_Main_File
49927>>>>>>>        If ((Operation_Origin<>Self) And;             (Nomisma.Recnum=0)) Procedure_Return
49930>>>>>>>        Forward Send Save_Main_File
49932>>>>>>>    End_Procedure   // Save_Main_File
49933>>>>>>>
49933>>>>>>>    Function Validate_Save  Returns Integer
49934>>>>>>>        Local Integer iReturnVal 
49935>>>>>>>        Forward Get Validate_Save  To iReturnVal
49937>>>>>>>        If (Not(iReturnVal)) ;            Begin
49939>>>>>>>                     If  Nomisma.nomisma_Code eq ''                 Move 6220 to iReturnVal
49942>>>>>>>                Else If (Nomisma.Nomisma_Code <>(psOldCode(Self)) And ;                         (psOldCode(Self)<>''))  Move 6030 to iReturnVal
49946>>>>>>>                if iReturnVal Send Operation_Not_Allowed iReturnVal
49949>>>>>>>            End
49949>>>>>>>>
49949>>>>>>>        Function_Return iReturnVal
49950>>>>>>>    End_Function   // Validate_Save
49951>>>>>>>
49951>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
49952>>>>>>>             if iError_num eq 6220 error 6220 "Œ¦£ ©£˜«˜ => ‰à› ¡æª ¡œ¤æª "
49955>>>>>>>        Else if iError_num eq 6030 error 6030 "„§ ¢â¥«œ ¤æ£ ©£˜ ˜§¦ «ž¤ ¢å©«˜ £œ (F4)\nž §˜«ã©«œ §¨é«˜ F5 ©«¦ ž›ž ¬§á¨®¦¤\nà©«œ ¤˜ ¡˜Ÿ˜¨å©œ  ž ˜¨® ¡ã «¦¬ « £ã\n§¨å¤ œ§ ¢â¥œ«œ á¢¢¦"
49959>>>>>>>        //Else if iError_num eq 6030 error 6030 "ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ©«¦ ¡à› ¡æ ¤¦£å©£˜«¦ª"
49959>>>>>>>        else Forward Send Operation_Not_Allowed  iError_Num
49962>>>>>>>    End_Procedure   // Operation_Not_Allowed
49963>>>>>>>
49963>>>>>>>    Procedure Update
49964>>>>>>>        Forward Send Update
49966>>>>>>>        // Insert Code Here
49966>>>>>>>        SYSDATE NOMISMA.LUP
49967>>>>>>>    End_Procedure   // Update
49968>>>>>>>
49968>>>>>>>    Procedure Creating
49969>>>>>>>        Forward Send Creating
49971>>>>>>>        // Insert Code Here
49971>>>>>>>        SYSDATE NOMISMA.FUP
49972>>>>>>>    End_Procedure   // Creating
49973>>>>>>>
49973>>>>>>>    // Define_Fields:
49973>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49973>>>>>>>
49973>>>>>>>    Procedure Define_Fields
49974>>>>>>>        Forward Send Define_Fields
49976>>>>>>>        //DDB-Generated-Code-Location
49976>>>>>>>        //DDB-DefineFieldStart
49976>>>>>>>
49976>>>>>>>        Set Main_File            To Nomisma.File_Number
49977>>>>>>>        Set Cascade_Delete_State To FALSE
49978>>>>>>>
49978>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49979>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49980>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49981>>>>>>>
49981>>>>>>>        // Child (Client) file structure................
49981>>>>>>>        Send Add_Client_File  Isotimia.File_Number
49982>>>>>>>        Send Add_Client_File  Particle.File_Number
49983>>>>>>>
49983>>>>>>>        // Field-based properties.......................
49983>>>>>>>
49983>>>>>>>        // Nomisma.Nomisma_Code
49983>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Code To DD_AUTOFIND    DD_CAPSLOCK   
49984>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Code To (sl059(Self))
49985>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Code To TRUE
49986>>>>>>>
49986>>>>>>>        // Nomisma.Nomisma_Descr
49986>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Descr To DD_CAPSLOCK   
49987>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Descr To (sl059(Self))
49988>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Descr To TRUE
49989>>>>>>>
49989>>>>>>>        // Nomisma.Nomisma_Short
49989>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Short To DD_CAPSLOCK   
49990>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Short To (sl059(Self))
49991>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Short To TRUE
49992>>>>>>>
49992>>>>>>>        // Nomisma.Dekadika
49992>>>>>>>
49992>>>>>>>        // Nomisma.Fup
49992>>>>>>>
49992>>>>>>>        // Nomisma.Lup
49992>>>>>>>
49992>>>>>>>        // Nomisma.Euro_Zone
49992>>>>>>>
49992>>>>>>>        // Nomisma.Einai_Drx
49992>>>>>>>
49992>>>>>>>        // Nomisma.Einai_Euro
49992>>>>>>>
49992>>>>>>>        // Nomisma.Monades
49992>>>>>>>
49992>>>>>>>        // Nomisma.Kl_Isot_Euro
49992>>>>>>>
49992>>>>>>>        // Nomisma.Nomisma_Type
49992>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Type To (Nomisma_Nomisma_Type_VT(Self))
49993>>>>>>>
49993>>>>>>>        // Nomisma.Nomisma_Sign0
49993>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Sign0 To (Nomisma_Nomisma_Sign0_VT(Self))
49994>>>>>>>
49994>>>>>>>        // Nomisma.Nomisma_Sign00
49994>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Sign00 To (Nomisma_Nomisma_Sign00_VT(Self))
49995>>>>>>>
49995>>>>>>>        // Nomisma.Nomisma_Signr
49995>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Signr To (Nomisma_Nomisma_Signr_VT(Self))
49996>>>>>>>
49996>>>>>>>        //DDB-DefineFieldEnd
49996>>>>>>>    End_Procedure    // Define_Fields
49997>>>>>>>
49997>>>>>>>    // Field_Defaults:
49997>>>>>>>    // This procedure is used to establish default field values.
49997>>>>>>>
49997>>>>>>>    Procedure Field_Defaults
49998>>>>>>>        Forward Send Field_Defaults
50000>>>>>>>        //DDB-Generated-Code-Location
50000>>>>>>>        //DDB-FieldDefaultStart
50000>>>>>>>        //DDB-FieldDefaultEnd
50000>>>>>>>    End_Procedure    // Field_Defaults
50001>>>>>>>
50001>>>>>>>End_Class    // Nomisma_DataDictionary
50002>>>>>>>//DDB-Selection-pkg-Start
50002>>>>>>>
50002>>>>>>>Use sl059.sl         // sl059
INCLUDING FILE: SL059.SL
50002>>>>>>>>>//AB/ Project sl059
50002>>>>>>>>>//AB/     Object prj is a LOOKUP_Project
50002>>>>>>>>>//AB/         Set ProjectName to "sl059"
50002>>>>>>>>>//AB/         Set ProjectFileName to "sl059.SL"
50002>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
50002>>>>>>>>>
50002>>>>>>>>>    //AB-IgnoreStart
50002>>>>>>>>>
50002>>>>>>>>>
50002>>>>>>>>>
50002>>>>>>>>>
50002>>>>>>>>>    Use NOMISMA.DD
50002>>>>>>>>>
50002>>>>>>>>>    //AB-IgnoreEnd
50002>>>>>>>>>
50002>>>>>>>>>    CD_Popup_Object sl059 is a dbModalPanelSub
50021>>>>>>>>>        Set Exit_Application_Local_State to FALSE
50022>>>>>>>>>        Set Modal_State to FALSE
50023>>>>>>>>>        Set Popup_State to FALSE
50024>>>>>>>>>        Set Minimize_Icon to FALSE
50025>>>>>>>>>        set label to "Œ¦£å©£˜«˜" 
50026>>>>>>>>>        Set Size to 148 295
50027>>>>>>>>>        Set Location to 4 5
50028>>>>>>>>>
50028>>>>>>>>>        //AB-DDOStart
50028>>>>>>>>>
50028>>>>>>>>>        Object Nomisma_DD is a Nomisma_DataDictionary
50030>>>>>>>>>        End_Object    // Nomisma_DD
50031>>>>>>>>>
50031>>>>>>>>>        Set Main_DD to (Nomisma_DD(Current_Object))
50032>>>>>>>>>        Set Server to (Nomisma_DD(Current_Object))
50033>>>>>>>>>
50033>>>>>>>>>        //AB-DDOEnd
50033>>>>>>>>>
50033>>>>>>>>>        Object oSelList is a dbListSub
50035>>>>>>>>>            Set Main_File to Nomisma.File_Number
50036>>>>>>>>>            Set Size to 105 278
50037>>>>>>>>>            Set Location to 6 6
50038>>>>>>>>>
50038>>>>>>>>>            Begin_Row
50041>>>>>>>>>                Entry_Item Nomisma.Nomisma_code
50042>>>>>>>>>                Entry_Item Nomisma.Nomisma_descr
50043>>>>>>>>>                Entry_Item Nomisma.Nomisma_short
50044>>>>>>>>>                Entry_Item Nomisma.Dekadika
50045>>>>>>>>>            End_Row
50050>>>>>>>>>
50050>>>>>>>>>            Set Form_Width    item 0 to 45
50051>>>>>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
50052>>>>>>>>>
50052>>>>>>>>>            Set Form_Width    item 1 to 115
50053>>>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
50054>>>>>>>>>
50054>>>>>>>>>            Set Form_Width    item 2 to 58
50055>>>>>>>>>            set header_label  item 2 to "‘ç¤«¦£ž" 
50056>>>>>>>>>
50056>>>>>>>>>            Set Form_Width    item 3 to 54
50057>>>>>>>>>            set header_label  item 3 to "ƒœ¡˜› ¡á" 
50058>>>>>>>>>
50058>>>>>>>>>        End_Object    // oSelList
50059>>>>>>>>>
50059>>>>>>>>>        Object oOK_bn is a ButtonSub
50061>>>>>>>>>            set label to "&„§ ¢¦šã" 
50062>>>>>>>>>            Set Location to 113 124
50063>>>>>>>>>
50063>>>>>>>>>            //AB-StoreStart
50063>>>>>>>>>            Procedure OnClick
50065>>>>>>>>>                Send OK To (oSelList(current_object))
50066>>>>>>>>>            End_Procedure
50067>>>>>>>>>            //AB-StoreEnd
50067>>>>>>>>>
50067>>>>>>>>>        End_Object    // oOK_bn
50068>>>>>>>>>
50068>>>>>>>>>        Object oCancel_bn is a ButtonSub
50070>>>>>>>>>            set label to "&€¡ç¨à©ž" 
50071>>>>>>>>>            Set Location to 113 179
50072>>>>>>>>>
50072>>>>>>>>>            //AB-StoreStart
50072>>>>>>>>>            Procedure OnClick
50074>>>>>>>>>                Send Cancel To (oSelList(current_object))
50075>>>>>>>>>            End_Procedure
50076>>>>>>>>>            //AB-StoreEnd
50076>>>>>>>>>
50076>>>>>>>>>        End_Object    // oCancel_bn
50077>>>>>>>>>
50077>>>>>>>>>        Object oSearch_bn is a ButtonSub
50079>>>>>>>>>            set label to "€&¤˜ã«ž©ž" 
50080>>>>>>>>>            Set Location to 113 234
50081>>>>>>>>>
50081>>>>>>>>>            //AB-StoreStart
50081>>>>>>>>>            Procedure OnClick
50083>>>>>>>>>                Send Search To (oSelList(current_object))
50084>>>>>>>>>            End_Procedure
50085>>>>>>>>>            //AB-StoreEnd
50085>>>>>>>>>
50085>>>>>>>>>        End_Object    // oSearch_bn
50086>>>>>>>>>
50086>>>>>>>>>
50086>>>>>>>>>        //AB-StoreStart
50086>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
50087>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
50088>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
50089>>>>>>>>>        //AB-StoreEnd
50089>>>>>>>>>
50089>>>>>>>>>    CD_End_Object    // sl059
50091>>>>>>>>>>
50091>>>>>>>>>
50091>>>>>>>>>//AB/     End_Object    // prj
50091>>>>>>>
50091>>>>>>>//DDB-Selection-pkg-End
50091>>>>>>>//DDB-FileEnd
50091>>>>>
50091>>>>>//AB-IgnoreEnd
50091>>>>>
50091>>>>>Object slNomism is a dbModalPanelSub
50093>>>>>
50093>>>>>    //AB-StoreTopStart
50093>>>>>    
50093>>>>>    
50093>>>>>    
50093>>>>>    //AB-StoreTopEnd
50093>>>>>
50093>>>>>    Set Label to "Œ¦£å©£˜«˜"
50094>>>>>    Set Size to 175 397
50095>>>>>    Set Location to 5 7
50096>>>>>    Set Exit_Application_Local_State to FALSE
50097>>>>>    Set Modal_State to FALSE
50098>>>>>
50098>>>>>    //AB-DDOStart
50098>>>>>
50098>>>>>    Object Nomisma_DD is a Nomisma_DataDictionary
50100>>>>>    End_Object    // Nomisma_DD
50101>>>>>
50101>>>>>    Set Main_DD to (Nomisma_DD(self))
50102>>>>>    Set Server to (Nomisma_DD(self))
50103>>>>>
50103>>>>>    //AB-DDOEnd
50103>>>>>
50103>>>>>    Object oSelList is a dbListSub
50105>>>>>        Set Main_File to Nomisma.File_Number
50106>>>>>        Set Size to 130 382
50107>>>>>        Set Location to 6 6
50108>>>>>
50108>>>>>        Begin_Row
50111>>>>>            Entry_Item Nomisma.Nomisma_code
50112>>>>>            Entry_Item Nomisma.Nomisma_descr
50113>>>>>            Entry_Item Nomisma.Dekadika
50114>>>>>            Entry_Item Nomisma.Euro_zone
50115>>>>>            Entry_Item Nomisma.Einai_drx
50116>>>>>            Entry_Item Nomisma.Einai_euro
50117>>>>>        End_Row
50122>>>>>
50122>>>>>        Set Form_Width    item 0 to 49
50123>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
50124>>>>>        
50124>>>>>        Set Form_Width    item 1 to 115
50125>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
50126>>>>>        
50126>>>>>        Set Form_Width    item 2 to 47
50127>>>>>        Set Header_Label  item 2 to "ƒœ¡˜› ¡á"
50128>>>>>        
50128>>>>>        Set Form_Width    item 3 to 55
50129>>>>>        Set Header_Label  item 3 to "…é¤ž EURO"
50130>>>>>        Set Column_Checkbox_State  item 3 to True
50131>>>>>        
50131>>>>>        Set Form_Width    item 4 to 55
50132>>>>>        Set Header_Label  item 4 to "„å¤˜  ƒ•"
50133>>>>>        Set Column_Checkbox_State  item 4 to True
50134>>>>>        
50134>>>>>        Set Form_Width    item 5 to 55
50135>>>>>        Set Header_Label  item 5 to "„å¤˜  „¬¨é"
50136>>>>>        Set Column_Checkbox_State  item 5 to True
50137>>>>>        
50137>>>>>
50137>>>>>        //AB-StoreStart
50137>>>>>        
50137>>>>>        //AB-StoreEnd
50137>>>>>
50137>>>>>    End_Object    // oSelList
50138>>>>>
50138>>>>>    Object oOK_bn is a ButtonSub
50140>>>>>        Set Label to "&„§ ¢¦šã"
50141>>>>>        Set Location to 140 279
50142>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
50143>>>>>
50143>>>>>        //AB-StoreStart
50143>>>>>        Procedure OnClick
50145>>>>>            Send OK To (oSelList(current_object))
50146>>>>>        End_Procedure
50147>>>>>        //AB-StoreEnd
50147>>>>>
50147>>>>>    End_Object    // oOK_bn
50148>>>>>
50148>>>>>    Object oSearch_bn is a ButtonSub
50150>>>>>        Set Label to "€&¤˜ã«ž©ž"
50151>>>>>        Set Location to 140 339
50152>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
50153>>>>>
50153>>>>>        //AB-StoreStart
50153>>>>>        
50153>>>>>        Procedure OnClick
50155>>>>>            Send Search To (oSelList(current_object))
50156>>>>>        End_Procedure
50157>>>>>        
50157>>>>>        
50157>>>>>        Set Visible_State to False
50158>>>>>        Set Enabled_State to False
50159>>>>>        //AB-StoreEnd
50159>>>>>
50159>>>>>    End_Object    // oSearch_bn
50160>>>>>
50160>>>>>
50160>>>>>    //AB-StoreStart
50160>>>>>    
50160>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
50161>>>>>    
50161>>>>>    On_Key Key_Alt+Key_s Send KeyAction To (oSearch_bn(current_object))
50162>>>>>    
50162>>>>>    
50162>>>>>    
50162>>>>>    
50162>>>>>    //AB-StoreEnd
50162>>>>>
50162>>>>>End_Object    // slNomism
50163>>>>>
50163>>>>>//AB/ End_Object    // prj
50163>>>
50163>>>//DDB-Selection-pkg-End
50163>>>//DDB-FileEnd
50163>        
50163>        
50163>        
50163>        
50163>        
50163>        
50163>        
50163>        
50163>        
50163>        
50163>        
50163>        
50163>        
50163>        
50163>        
50163>        
50163>        
50163>        
50163>        
50163>        
50163>        
50163>        //AB-ClientStoreEnd
50163>
50163>
50163>    End_Object  // Client_Area
50164>    
50164>    Use DFStdSbr.pkg //  Status-Bar object.
INCLUDING FILE: DFSTDSBR.PKG
50164>>>// 07/23/96 JJT - New Class names
50164>>>// Very prototype global status bar
50164>>>//
50164>>>Use dfMainSt.pkg
INCLUDING FILE: DFMAINST.PKG
50164>>>>>// 07/23/96 JJT - New Class names
50164>>>>>Use dfAstbar.pkg
50164>>>>>
50164>>>>>Class StatusBar is a AppStatusBar
50165>>>>>
50165>>>>>    Procedure Construct_Object
50166>>>>>       Forward Send Construct_Object
50168>>>>>       //
50168>>>>>       Send Add_Item 350  ''     // micro-help
50169>>>>>       Send Add_Item  40  'View:'
50170>>>>>       Set Item_Display_Style To sbNORMAL
50171>>>>>       Send Add_Item 200  ''     // view name
50172>>>>>       Send Add_Item   0  ''     // spring 'normal' to end
50173>>>>>       Set Item_Display_Style To sbNORMAL
50174>>>>>    End_Procedure // Construct_Object
50175>>>>>
50175>>>>>    Procedure Show_View_Name String sName
50176>>>>>        Set Value item 2 to sName
50177>>>>>    End_Procedure
50178>>>>>
50178>>>>>End_Class
50179>>>
50179>>>If (Wait(Self)) Send Deactivate to (Wait(Self))
50182>>>
50182>>>Object oStatusBarSub  is a StatusBar
50184>>>    Use DFTimer // DfTimer Manager Must Have a WindowHandle
50184>>>    
50184>>>    Property Integer piStdPanes Public (PaneCount(Self))
50186>>>    
50186>>>    //Set Value     Item 1 to (ToANSI("„§ ¢¦šã:"))
50186>>>    Set PaneWidth item 1 to 50
50187>>>    
50187>>>    Send AddPane 55  ""        sbLOWERED
50188>>>    Send AddPane 70  ""        sbLOWERED
50189>>>    Send AddPane 55  ""        sbLOWERED
50190>>>    
50190>>>    Procedure pTimer
50192>>>        String lsDay lsHour lsHH lsMM lsSS
50193>>>        Integer liStdPanes lbState
50193>>>    
50193>>>        Get piStdPanes to liStdPanes
50194>>>        Sysdate lsDay lsHH lsMM lsSS
50198>>>        If (Length(lsHH)=1) Insert "0" In lsHH At 1
50202>>>        If (Length(lsMM)=1) Insert "0" In lsMM At 1
50206>>>        If (Length(lsSS)=1) Insert "0" In lsSS At 1
50210>>>        Move (lsHH+":"+lsMM+":"+lsSS) to lsHour
50211>>>        Get Simple_state to lbState
50212>>>        If  Not (lbState) Begin
50214>>>            Set Value Item liStdPanes     to lsHour
50215>>>            Set Value Item (liStdPanes+1) to lsDay
50216>>>        End
50216>>>>
50216>>>    
50216>>>    End_Procedure // pTimer
50217>>>    
50217>>>    
50217>>>    Object oTimerObj Is A DFTimer
50219>>>        Set Timeout to 1000
50220>>>        Set Timer_Active_State to TRUE
50221>>>        Set Timer_Object to (oStatusBarSub(Current_Object))
50222>>>        Set Timer_Message to pTimer
50223>>>    End_Object // oTimerOdj
50224>>>End_Object // oStatusBar
50225>>>
50225>>>
50225>
50225>    //AB-PanelStoreStart
50225>    Use StdAbout.pkg // Standard "About" package.
INCLUDING FILE: STDABOUT.PKG
50225>>>//************************************************************************
50225>>>// Confidential Trade Secret.
50225>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
50225>>>// as an unpublished work.  All rights reserved.
50225>>>// DataFlex is a registered trademark of Data Access Corporation.
50225>>>//
50225>>>//************************************************************************
50225>>>//************************************************************************
50225>>>//
50225>>>// $File name  : StdAbout.pkg
50225>>>// $File title : Standard about object package for VDF
50225>>>// Notice      :
50225>>>// $Author(s)  : John Tuohy
50225>>>//
50225>>>// $Rev History
50225>>>//
50225>>>// JT 06/27/97   File created
50225>>>//************************************************************************
50225>>>
50225>>>// This provides a quick and simple way to create an about package for a program.
50225>>>// You need to create a message inside you client area called Activate_About.
50225>>>// Within this message you should send the message DoAbout passing needed
50225>>>// string information.
50225>>>//
50225>>>//       Procedure Activate_About
50225>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
50225>>>//       End_Procedure
50225>>>//    where: sTitle =     Name of application. If none provided, uses caption
50225>>>//                        bar title
50225>>>//           sVersion   = Version Line. If none provided, will be blank
50225>>>//           sCopyRight = Copyright Line. If none provided, will be blank
50225>>>//           sAuthor    = Author name, blank if none provided
50225>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
50225>>>//                        is used.
50225>>>// It is expected that you will place this in your own object package. For
50225>>>// example an order about package may look like this:
50225>>>//
50225>>>//   // OrderAbout.pkg
50225>>>//   Use StdAbout.pkg
50225>>>//   Procedure Activate_About
50225>>>//      Local String sTitle sCopyright sVersion sAuthor
50225>>>//      Move "My Order Entry System" to sTitle
50225>>>//      Move "Version 2.1" to sVersion
50225>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
50225>>>//      Move "John Smith"  to sAuthor
50225>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
50225>>>//   end_procedure
50225>>>//   // end of file.
50225>>>
50225>>>Use DfAbout.pkg
INCLUDING FILE: DFABOUT.PKG
50225>>>>>//************************************************************************
50225>>>>>// Confidential Trade Secret.
50225>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
50225>>>>>// as an unpublished work.  All rights reserved.
50225>>>>>// DataFlex is a registered trademark of Data Access Corporation.
50225>>>>>//
50225>>>>>//************************************************************************
50225>>>>>//************************************************************************
50225>>>>>//
50225>>>>>// $File name  : DfAbout.pkg
50225>>>>>// $File title : About class support
50225>>>>>// Notice      :
50225>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
50225>>>>>//
50225>>>>>// $Rev History
50225>>>>>//
50225>>>>>// JJT 11/5/98    Added version information
50225>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
50225>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
50225>>>>>//                workspace package.
50225>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
50225>>>>>//                class can create this object.
50225>>>>>//                Cleaned up the interface (used correct classes and messages)
50225>>>>>//                Added workspace reporting support to sys-info.
50225>>>>>//                Turned off wrapping in the sys-info editor.
50225>>>>>// KR  ??/??/96   File created
50225>>>>>//************************************************************************
50225>>>>>Use windows.pkg
50225>>>>>Use DFbitmap.pkg
50225>>>>>
50225>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
50226>>>>>
50226>>>>>//****************************************************************************
50226>>>>>// $Module type: FUNCTION
50226>>>>>// $Module name: Network_User_Name
50226>>>>>// $Author     : AK/VOO/KCR
50226>>>>>// Created     : 24-09-96 @ 19:17
50226>>>>>//
50226>>>>>// Description
50226>>>>>//    This function reads the current username of windows and returns that
50226>>>>>//    name or an text unknown user
50226>>>>>//
50226>>>>>// $Rev History
50226>>>>>//    24-09-96  Module header created
50226>>>>>//****************************************************************************
50226>>>>>Function Network_User_Name Returns String
50228>>>>>    Local String sName sLength
50229>>>>>    Local Pointer lpName_Addr lpLength_Addr
50229>>>>>    Local Integer iRetval
50229>>>>>
50229>>>>>    Movestr (Repeat (Character (0), 255)) To sName
50230>>>>>>
50230>>>>>    GetAddress Of sName To lpName_Addr
50231>>>>>    Movestr (DwordToBytes (255)) To sLength
50232>>>>>>
50232>>>>>    GetAddress Of sLength To lpLength_Addr
50233>>>>>
50233>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
50234>>>>>>
50234>>>>>
50234>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
50237>>>>>    Else Function_Return "User Unknown"
50239>>>>>End_Function // Network_User_Name
50240>>>>>
50240>>>>>Type MEMORYSTATUS
50240>>>>>   Field MEMORYSTATUS.dwLength         As Dword // sizeof(MEMORYSTATUS)
50240>>>>>   Field MEMORYSTATUS.dwMemoryLoad     As Dword // percent of memory in use
50240>>>>>   Field MEMORYSTATUS.dwTotalPhys      As Dword // bytes of physical memory
50240>>>>>   Field MEMORYSTATUS.dwAvailPhys      As Dword // free physical memory bytes
50240>>>>>   Field MEMORYSTATUS.dwTotalPageFile  As Dword // bytes of paging file
50240>>>>>   Field MEMORYSTATUS.dwAvailPageFile  As Dword // free bytes of paging file
50240>>>>>   Field MEMORYSTATUS.dwTotalVirtual   As Dword // user bytes of address space
50240>>>>>   Field MEMORYSTATUS.dwAvailVirtual   As Dword // free user bytes
50240>>>>>End_Type // MEMORYSTATUS
50240>>>>>
50240>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
50241>>>>>
50241>>>>>// If a global workspace object exists it will use this variable to store
50241>>>>>// its object id.
50241>>>>>
50241>>>>>Class SysinfoDisplay Is An Edit
50242>>>>>    Procedure Construct_Object
50243>>>>>        forward send construct_object
50245>>>>>
50245>>>>>        Set Location To 6 6
50246>>>>>        Set Size To 110 255
50247>>>>>        Set Read_Only_State To True
50248>>>>>        Set wrap_state to False
50249>>>>>    end_Procedure
50250>>>>>
50250>>>>>    //****************************************************************************
50250>>>>>    // $Module type: PROCEDURE
50250>>>>>    // $Module name: Add_Line
50250>>>>>    // $Author     : VOO
50250>>>>>    // Created     : 06-10-96 @ 15:23
50250>>>>>    //
50250>>>>>    // Description
50250>>>>>    //    This method will add a line to this edit object, it should go simpler
50250>>>>>    //    but it seems to be done this way.
50250>>>>>    //
50250>>>>>    // $Rev History
50250>>>>>    //    06-10-96  Module header created
50250>>>>>    //****************************************************************************
50250>>>>>    Procedure Add_Line String sVal
50251>>>>>        Local Integer iLine
50252>>>>>
50252>>>>>        Moveint (Line_Count (Current_Object)) To iLine
50253>>>>>>
50253>>>>>        If (iLine = 1 And Changed_State (Current_Object) = False) Moveint 0 To iLine
50256>>>>>        Set Value Item iLine To sVal
50257>>>>>    End_Procedure // Add_Line
50258>>>>>
50258>>>>>    //****************************************************************************
50258>>>>>    // $Module type: PROCEDURE
50258>>>>>    // $Module name: Show_Current_Directory
50258>>>>>    // $Author     : VOO
50258>>>>>    // Created     : 06-10-96 @ 15:24
50258>>>>>    //
50258>>>>>    // Description
50258>>>>>    //    This method will show the name of the current directory in the system
50258>>>>>    //    information box
50258>>>>>    //
50258>>>>>    // $Rev History
50258>>>>>    //    06-10-96  Module header created
50258>>>>>    //****************************************************************************
50258>>>>>    Procedure Show_Current_Directory
50259>>>>>        Local String sDir
50260>>>>>
50260>>>>>        Get_Current_Directory To sDir
50261>>>>>        Send Add_Line ("Current Directory: " + sDir)
50262>>>>>    End_Procedure // Show_Current_Directory
50263>>>>>
50263>>>>>    Procedure Show_Windows_Directory
50264>>>>>        Local String sWindir
50265>>>>>
50265>>>>>        Get_Windows_Directory To sWindir
50266>>>>>        Send Add_Line ("Windows Directory: " * sWindir)
50267>>>>>    End_Procedure // Show_Windows_Directory
50268>>>>>
50268>>>>>    Procedure Show_Current_User
50269>>>>>        Send Add_Line ("Network User Name: " * Network_User_Name (Current_Object))
50270>>>>>    End_Procedure // Show_Current_User
50271>>>>>
50271>>>>>    Procedure Show_Number_Format
50272>>>>>        Local Integer iFormat
50273>>>>>
50273>>>>>        Get_Attribute Df_Thousands_Separator To iFormat
50276>>>>>        Send Add_Line ('Thousands Separator: "' - Character (iFormat) - '" (' - String (iFormat) - ')')
50277>>>>>        Get_Number_Format To iFormat
50278>>>>>        Send Add_Line ('Decimal Separator: "' - If (iFormat = 0, '.', ',') - '"')
50279>>>>>    End_Procedure // Show_Number_Format
50280>>>>>
50280>>>>>    Procedure Show_Filelist_Name
50281>>>>>        Local String sFilename
50282>>>>>
50282>>>>>        Get_Attribute Df_Filelist_Name To sFilename
50285>>>>>        Send Add_Line ("Current Filelist: " * sFilename)
50286>>>>>    End_Procedure // Show_Filelist_Name
50287>>>>>
50287>>>>>    Procedure Show_Lock_Delay
50288>>>>>        Local Integer iLockdelay
50289>>>>>
50289>>>>>        Get_Attribute Df_Lock_Delay To iLockdelay
50292>>>>>        Send Add_Line ("Database Locking Delay: " * String (iLockdelay) * "Milliseconds")
50293>>>>>    End_Procedure // Show_Lock_Delay
50294>>>>>
50294>>>>>    Procedure Show_Lock_Timeout
50295>>>>>        Local Integer iLockTimeout
50296>>>>>
50296>>>>>        Get_Attribute Df_Lock_Timeout To iLockTimeout
50299>>>>>        Send Add_Line ("Database Locking Timeout: " * String (iLockTimeout) * "Milliseconds")
50300>>>>>    End_Procedure // Show_Lock_Timeout
50301>>>>>
50301>>>>>    Procedure Show_Screen_Size
50302>>>>>        Local Integer iYscreensize iXscreensize
50303>>>>>
50303>>>>>        Moveint (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
50304>>>>>>
50304>>>>>        Moveint (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
50305>>>>>>
50305>>>>>
50305>>>>>        Send Add_Line ("Video Resolution: " * String (iXscreensize) * "by" * String (iYscreensize))
50306>>>>>    End_Procedure // Show_Screen_Size
50307>>>>>
50307>>>>>    Procedure Show_Page_Size
50308>>>>>        Send Add_Line ("Page End: " * String (Pageend) * "Form Feed: " * String (Pagefeed))
50309>>>>>    End_procedure
50310>>>>>
50310>>>>>    Procedure Show_Date
50311>>>>>        Local Date dToday
50312>>>>>
50312>>>>>        Sysdate4 dToday
50313>>>>>        Send Add_Line ("Current System Date: " * String (dToday))
50314>>>>>    End_procedure // Show_Date
50315>>>>>
50315>>>>>    Procedure Show_Date_Format
50316>>>>>        Local Integer iDateFormat
50317>>>>>        Local String sDateFormat
50317>>>>>
50317>>>>>        Get_Attribute Df_Date_Format To iDateFormat
50320>>>>>        if iDateFormat Eq DF_DATE_USA ;            Movestr "USA" To sDateFormat
50323>>>>>        else if iDateformat Eq DF_DATE_EUROPEAN ;            Movestr "European" To sDateFormat
50327>>>>>        else if iDateformat Eq DF_DATE_MILITARY ;            Movestr "Military" To sDateFormat
50331>>>>>        else ;            Movestr "Unknown Date Type" To sDateFormat
50333>>>>>        Send Add_Line ("Date Format: " * sDateformat)
50334>>>>>    End_Procedure // Show_Date_Format
50335>>>>>
50335>>>>>    Procedure Show_Memavail
50336>>>>>        Local Integer iMem
50337>>>>>
50337>>>>>        Memory iMem
50338>>>>>>
50338>>>>>        Send Add_Line ("Available Memory: " * String (iMem))
50339>>>>>    End_Procedure // Show_Memavail
50340>>>>>
50340>>>>>    Procedure Show_Systemresources
50341>>>>>        Local String sMemoryStatus
50342>>>>>        Local Pointer lpsMemoryStatus
50342>>>>>        Local Integer iVoid
50342>>>>>        Local Dword dwMemoryLoad dwTotalPhys dwAvailPhys dwTotalPageFile dwAvailPageFile dwTotalVirtual dwAvailVirtual
50342>>>>>
50342>>>>>        ZeroType MEMORYSTATUS To sMemoryStatus
50343>>>>>        GetAddress Of sMemoryStatus To lpsMemoryStatus
50344>>>>>
50344>>>>>        Moveint (GlobalMemoryStatus (lpsMemoryStatus)) To iVoid
50345>>>>>>
50345>>>>>
50345>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwMemoryLoad    To dwMemoryLoad
50346>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPhys     To dwTotalPhys
50347>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPhys     To dwAvailPhys
50348>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPageFile To dwTotalPageFile
50349>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPageFile To dwAvailPageFile
50350>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalVirtual  To dwTotalVirtual
50351>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailVirtual  To dwAvailVirtual
50352>>>>>
50352>>>>>        Send Add_Line ("Current memory utilization:" * String (dwMemoryLoad))
50353>>>>>        Send Add_Line ("Percentage available physical memory:" * String (dwAvailPhys / dwTotalPhys * 100.0) - "%")
50354>>>>>        Send Add_Line ("Percentage available pagefile space:" * String (dwAvailPageFile / dwTotalPageFile * 100.0) - "%")
50355>>>>>        Send Add_Line ("Percentage available virtual memory:" * String (dwAvailVirtual / dwTotalVirtual * 100.0) - "%")
50356>>>>>    End_Procedure // Show_Systemresources
50357>>>>>
50357>>>>>    Procedure Show_Registration
50358>>>>>        Local String sRegName
50359>>>>>        Local Integer iSN
50359>>>>>        Registration sRegName iSN
50360>>>>>>
50360>>>>>
50360>>>>>        Send Add_Line ("Serial# : " + (String(iSN)))
50361>>>>>        Send Add_Line ("Reg Name: " + sRegName)
50362>>>>>
50362>>>>>    End_Procedure // Show_Current_Directory
50363>>>>>
50363>>>>>
50363>>>>>
50363>>>>>    //****************************************************************************
50363>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
50363>>>>>    // to the workspace object passing the an object and message to send back
50363>>>>>    // to this object. It is expected that the workspace object will send this
50363>>>>>    // message for every line of information it wants displayed (passing the
50363>>>>>    // information to be displayed
50363>>>>>    //****************************************************************************
50363>>>>>    register_procedure EnumerateWorkspaceData integer hObjId integer hmMessId
50363>>>>>    Procedure Show_WorkspaceInformation
50364>>>>>        If ghoWorkspace ;            Send EnumerateWorkspaceData to ghoWorkspace Current_object Msg_add_Line
50367>>>>>    End_Procedure
50368>>>>>
50368>>>>>    Function VersionStr integer iVer integer iRev integer iBld Returns string
50369>>>>>        Function_Return (string(iVer)-"."-string(iRev)-"."-string(iBld))
50370>>>>>    End_Function
50371>>>>>
50371>>>>>    Procedure Show_Versions
50372>>>>>        local integer iVersion iRevision iBuild
50373>>>>>        Version_information iVersion iRevision iBuild
50375>>>>>        Send Add_Line ("Runtime Version:" * VersionStr(self,iVersion,iRevision,iBuild) )
50376>>>>>        Send Add_Line ("Package Version:" * VersionStr(self,PKG_VERSION, PKG_REVISION, PKG_BUILD) )
50377>>>>>        Send Add_Line ("FMAC Version:"    * VersionStr(self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) )
50378>>>>>    End_Procedure
50379>>>>>
50379>>>>>
50379>>>>>    //***
50379>>>>>    //*** BW
50379>>>>>    //*** Procedure: Show_Drivers
50379>>>>>    //*** Purpose  : Show loaed database drivers
50379>>>>>    //***
50379>>>>>
50379>>>>>    Procedure Show_Drivers
50380>>>>>        Local String  Current_drvr
50381>>>>>        Local String  Loadeddrvrs
50381>>>>>        Local Integer Number_of_drvrs
50381>>>>>        Local Integer Count
50381>>>>>
50381>>>>>        Move "" To Loadeddrvrs
50382>>>>>        Get_attribute DF_NUMBER_DRIVERS To Number_of_drvrs
50385>>>>>        For Count From 1 To Number_of_drvrs
50391>>>>>>
50391>>>>>            Get_attribute DF_DRIVER_NAME Of Count To Current_drvr
50394>>>>>            If (Loadeddrvrs <> "") ;                Move (Append(Loadeddrvrs, ", ")) To Loadeddrvrs
50397>>>>>            Move (Append(Loadeddrvrs, Current_drvr)) To Loadeddrvrs
50398>>>>>        Loop
50399>>>>>>
50399>>>>>        Send Add_Line ("Database driver(s):" * Loadeddrvrs)
50400>>>>>    End_Procedure // Show_Drivers
50401>>>>>
50401>>>>>    //****************************************************************************
50401>>>>>    // $Module type: PROCEDURE
50401>>>>>    // $Module name: Add_Focus
50401>>>>>    // $Author     : VOO
50401>>>>>    // Created     : 24-09-96 @ 19:43
50401>>>>>    //
50401>>>>>    // Description
50401>>>>>    //    During activation we will remove the old information and add the newly
50401>>>>>    //    found systeminformation
50401>>>>>    //
50401>>>>>    // $Rev History
50401>>>>>    //    24-09-96  Module header created
50401>>>>>    //****************************************************************************
50401>>>>>    Procedure Add_Focus Integer hoRoot
50402>>>>>        Forward Send Add_Focus hoRoot
50404>>>>>
50404>>>>>        Send Delete_Data
50405>>>>>        Set Changed_State To False
50406>>>>>        Set Read_Only_State To True
50407>>>>>        Send Show_WorkSpaceInformation // added to show WS info
50408>>>>>        SEnd Show_Drivers
50409>>>>>        Send Show_Current_User
50410>>>>>        Send Show_Windows_Directory
50411>>>>>        Send Show_Current_Directory
50412>>>>>        Send Show_Filelist_Name
50413>>>>>        Send Show_Versions
50414>>>>>        Send Show_Memavail
50415>>>>>        Send Show_Screen_Size
50416>>>>>        Send Show_Page_Size
50417>>>>>        Send Show_Number_Format
50418>>>>>        Send Show_Date_Format
50419>>>>>        Send Show_Lock_Delay
50420>>>>>        Send Show_Lock_Timeout
50421>>>>>        Send Show_Date
50422>>>>>        Send Show_Systemresources
50423>>>>>        Send Show_Registration
50424>>>>>    End_Procedure // Show_All_Info
50425>>>>>
50425>>>>>End_Class // SysinfoDisplay
50426>>>>>
50426>>>>>
50426>>>>>//****************************************************************************
50426>>>>>// $Module type: OBJECT
50426>>>>>// $Module name: Sysinfo_Dialog
50426>>>>>// $Author     : VOO
50426>>>>>// Created     : 24-09-96 @ 18:47
50426>>>>>//
50426>>>>>// Description
50426>>>>>//    This object shows the systeminformation on the screen
50426>>>>>//
50426>>>>>// $Rev History
50426>>>>>//    24-09-96  Module header created
50426>>>>>//****************************************************************************
50426>>>>>Class SysInfoDialog Is A ModalPanel
50427>>>>>    Procedure Construct_Object
50428>>>>>        forward send construct_object
50430>>>>>
50430>>>>>        Set Caption_Bar To True
50431>>>>>        Set Sysmenu_Icon To True
50432>>>>>        Set Label To "System Information"
50433>>>>>        Set Size To 152 270
50434>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
50435>>>>>        Set Minimize_Icon To False
50436>>>>>        Set Maximize_Icon To False
50437>>>>>        Set Border_Style To Border_Dialog
50438>>>>>
50438>>>>>        Object Sysinfo_Display Is A SysInfoDisplay
50440>>>>>        End_Object
50441>>>>>
50441>>>>>        Object Close_Button Is A Button
50443>>>>>            Set Label to "&Close"
50444>>>>>            Set Location To 120 212
50445>>>>>            Set Message item 0 to msg_Close_Panel
50446>>>>>            Set default_action_button to current_object
50447>>>>>        End_Object // Close_Button
50448>>>>>
50448>>>>>        On_Key Kcancel       Send Close_Panel
50449>>>>>        On_Key Key_Alt+Key_C Send Close_Panel
50450>>>>>    End_procedure
50451>>>>>
50451>>>>>End_Class // SysinfoDialog
50452>>>>>
50452>>>>>// Purpose:
50452>>>>>//
50452>>>>>// Ken Ross 12/17/96 5:16PM
50452>>>>>//
50452>>>>>Class AboutDialog Is A ModalPanel
50453>>>>>
50453>>>>>    Procedure construct_object
50454>>>>>        String sVdfRootDir
50455>>>>>        forward send construct_object
50457>>>>>        Set Label to "About..."
50458>>>>>        Set Size to 100 217
50459>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
50460>>>>>
50460>>>>>        Object SysInfo_Dialog is a SysInfoDialog
50462>>>>>        End_Object
50463>>>>>
50463>>>>>        Object oBox is a Container3d
50465>>>>>            Set Border_Style to Border_StaticEdge
50466>>>>>            Set Size to 63 202
50467>>>>>            Set Location to 4 5
50468>>>>>
50468>>>>>            Object AboutGraphic is a BitmapContainer
50470>>>>>                Set Border_Style to Border_None
50471>>>>>                Set Bitmap_Style to Bitmap_Center
50472>>>>>                Set Size to 48 48
50473>>>>>                Set Location to 7 2
50474>>>>>            End_Object    // AboutGraphic
50475>>>>>
50475>>>>>            Object ProductName is a TextBox
50477>>>>>                Set label to "ProductName"
50478>>>>>                Set Size to 10 45
50479>>>>>                Set Location to 8 53
50480>>>>>            End_Object    // ProductName
50481>>>>>
50481>>>>>            Object Version is a TextBox
50483>>>>>                Set label to "Version"
50484>>>>>                Set Size to 10 25
50485>>>>>                Set Location to 21 53
50486>>>>>            End_Object    // Version
50487>>>>>
50487>>>>>            Object Copyright is a TextBox
50489>>>>>                Set label to "Copyright"
50490>>>>>                Set Size to 10 31
50491>>>>>                Set Location to 34 53
50492>>>>>            End_Object    // Copyright
50493>>>>>
50493>>>>>            Object Author is a TextBox
50495>>>>>                Set label to "Author"
50496>>>>>                Set Size to 10 22
50497>>>>>                Set Location to 46 53
50498>>>>>            End_Object    // Author
50499>>>>>
50499>>>>>        End_Object    // oBox
50500>>>>>
50500>>>>>        Object OK_bn is a Button
50502>>>>>            On_Item "&OK" Send Close_Panel
50503>>>>>            Set Size to 14 50
50504>>>>>            Set Location to 71 157
50505>>>>>        End_Object    // OK_bn
50506>>>>>
50506>>>>>        Object SysInfo_bn is a Button
50508>>>>>            On_Item "&System Info" Send Show_Sysinfo
50509>>>>>            Set Size to 14 50
50510>>>>>            Set Location to 71 101
50511>>>>>        End_Object    // SysInfo_bn
50512>>>>>
50512>>>>>        On_Key Kcancel Send KeyAction to (Ok_bn(Current_Object))
50513>>>>>        On_Key Key_Alt+Key_O Send KeyAction to (Ok_bn(Current_Object))
50514>>>>>        On_Key Key_Alt+Key_S Send KeyAction to (SysInfo_bn(Current_Object))
50515>>>>>
50515>>>>>        Get_Profile_String "Defaults" "VdfRootDir" To sVdfRootDir
50518>>>>>        Set logo to (sVdfRootDir +"\Bitmaps\DacAbout.bmp")  // square bitmaps of 42x42 work best
50519>>>>>
50519>>>>>    End_Procedure
50520>>>>>
50520>>>>>    Procedure set productname string sval
50521>>>>>        set label of (productname(oBox(current_object))) to sval
50522>>>>>    End_Procedure
50523>>>>>
50523>>>>>    Procedure set version string sval
50524>>>>>        set label of (version(oBox(current_object))) to sval
50525>>>>>    End_Procedure
50526>>>>>
50526>>>>>    Procedure set copyright string sval
50527>>>>>        set label of (copyright(oBox(current_object))) to sval
50528>>>>>    End_Procedure
50529>>>>>
50529>>>>>    Procedure set author string sval
50530>>>>>        set label of (author(oBox(current_object))) to sval
50531>>>>>    End_Procedure
50532>>>>>
50532>>>>>    // square bitmaps of 42x42 work best
50532>>>>>    //
50532>>>>>    Procedure set logo string sval
50533>>>>>        set bitmap of (aboutgraphic(oBox(current_object))) to sval
50534>>>>>    End_Procedure
50535>>>>>
50535>>>>>    Procedure Show_Sysinfo
50536>>>>>        Send Popup_Modal To (Sysinfo_Dialog(Current_Object))
50537>>>>>    End_Procedure // Show_Sysinfo
50538>>>>>
50538>>>>>End_Class
50539>>>>>
50539>>>>>
50539>>>>>//Object About_Dialog is an AboutDialog
50539>>>>>//    set productname to "Visual DataFlex"
50539>>>>>//    set version to "version 4.0"
50539>>>>>//    set copyright to "Copyright 1997 Data Access Corporation"
50539>>>>>//    set author to ""
50539>>>>>//    set logo to "ablogo.bmp"  // square bitmaps of 42x42 work best
50539>>>>>//End_Object
50539>>>>>
50539>>>>>//Procedure Activate_About
50539>>>>>//   Send Popup_Modal To (About_Dialog (Current_Object))
50539>>>>>//End_Procedure
50539>>>
50539>>>// *************************************************************************
50539>>>//  Public message. This is the default message. It is expected that you will
50539>>>//   create your own message to override this
50539>>>// *************************************************************************
50539>>>
50539>>>Procedure Activate_About
50541>>>   Send DoAbout "" "" "" "" "" ""
50542>>>End_Procedure
50543>>>
50543>>>// *************************************************************************
50543>>>//  Public message. It is expected that you will send this message (most
50543>>>//  likely from Activate_About. This creates an about object, activates it
50543>>>//  and destroys it when done. It is not exepected that you will augment this.
50543>>>// *************************************************************************
50543>>>
50543>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
50545>>>        Local integer hoObj hoMain
50546>>>
50546>>>        // create object
50546>>>        Object About is an AboutDialog
50548>>>            // if no title passed use the label of the main panel
50548>>>            // (if a main panel exists).
50548>>>            if sTitle     eq '' Begin
50550>>>                Get Main_Window to hoMain
50551>>>                if hoMain Get Label of hoMain to sTitle
50554>>>            end
50554>>>>
50554>>>            set productname to sTitle
50555>>>            set version     to sVersion
50556>>>            set copyright   to sCopyRight
50557>>>            set author      to sAuthor
50558>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
50561>>>            Move Current_Object to hoObj // object Id
50562>>>        End_Object
50563>>>        Send Popup to hoObj    // popup the about object
50564>>>        Send Request_Destroy_Object to hoObj // when done, it will be destroyed
50565>>>End_procedure
50566>    Use Tooltip.Inc
INCLUDING FILE: TOOLTIP.INC
50566>>>Use Tooltip.pkg
50566>>>
50566>>>object StandardToolTip is a StandardToolTip000
50568>>>    move (current_object) to DefaultTooltipHintID
50569>>>end_object
50570>>>
50570>>>object ToolTipTimer is a ToolTipTimer000
50572>>>    move (current_object) to TooltipControllerID
50573>>>end_object
50574>    
50574>    
50574>    
50574>    
50574>    //AB-PanelStoreEnd
50574>
50574>
50574>End_Object
50575>
50575>
50575>//AB-StoreStart
50575>
50575>set bitmap of (client_area(main(self))) to "protem1.bmp"
50576>
50576>Start_UI
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>
50577>//AB-StoreEnd
50577>
50577>
Summary
Memory Available: 2147483647
Total Errors   : 0
Total Symbols  : 27557
Total Resources: 0
Total Commands : 50576
Total Windows  : 1
Total Pages    : 1
Static Data    : 362200
Message area   : 271122
Total Blocks   : 16673
