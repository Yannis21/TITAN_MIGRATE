Compiling Program: L:\VDF6\Develop\Empor\AppSrc\#chkclients.src
Memory Available: 2147483647
1>Use AllEntSc
Using pre-compiled package ALLENTSC
INCLUDING FILE: ALLENTSC.PKI
30333>
30333>Register_Object Client_Area
30333>
30333>//AB-StoreTopStart
30333>Use Workspc.pkg
30333>
30333>//  Set date attributes as needed
30333>Set_Date_Attribute sysdate4_State to (TRUE)
30334>Set_Date_Attribute Date4_State    to (TRUE)
30335>Set_Date_Attribute epoch_value    to 30
30336>
30336>Object ProgramWorkspace is a WorkspaceSub
30338>    Set WorkspaceName to CURRENT$WORKSPACE
30339>    Set kEnter_Next_State to True
30340>//    Set ModuleName    to 'ProgramName' // Special module name.
30340>//    Set HelpName      to 'HelpName.hlp'// Please provide the name of your Windows help file.
30340>End_Object
30341>
30341>Use Help_Ids.inc // Developer should provide this file of help context links.
INCLUDING FILE: HELP_IDS.INC
30341>>>// Help_ids.inc
30341>>>//
30341>>>// Context ids for the order entry system. This uses
30341>>>// help file ordentry.hlp.
30341>>>//
30341>>>// This is a sample version. YOU must supply
30341>>>// the ID values
30341>>>
30341>>>//  Generic Context Ids
30341>>>//
30341>>>
30341>>>// It is expected that file-names ids will be the same as their
30341>>>// filenumber.
30341>>>
30341>>>
30341>>>//  View and selection-list specific context ids
30341>>>//
30341>>>//..........add view, object, selection-list ids here....
30341>Use Std_Help.pkg
INCLUDING FILE: STD_HELP.PKG
30341>>>// STD_HELP.PKG
30341>>>//
30341>>>// Global Help Object
30341>>>//
30341>>>//  Creates all Help Support required to access WINDOWs help system
30341>>>//  with DataFlex. Creates a global object named Help_Object.
30341>>>//
30341>>>//  9/19/97 JJT - Modified to define stadnard help Ids if they are undefined
30341>>>
30341>>>use DFHlpSys // Context Sensitive Help Support
30341>>>
30341>>>
30341>>>// This file needs to be provided by the developer. It will contain
30341>>>// symbolic replacements for the ID integer values used to access the
30341>>>// the windows help file's topics.
30341>>>//
30341>>>use Help_ids.inc
30341>>>
30341>>>// If the following are not defined in help_ids.inc,
30341>>>//  create default 0 values for them
30341>>>Define GeneralHelpId    for    0
30341>>>Define KeysHelpId       for    0
30341>>>Define FileHelpId       for    0
30341>>>Define ErrorHelpId      for    0  // probably not used in VDF
30341>>>Define IndexHelpId      for    0  // probably not used in VDF
30341>>>
30341>>>object Help_Object is a HelpSystem // global help object
30343>>>
30343>>>   Set Help_Id_General to GeneralHelpId    // these should all be defined
30344>>>   Set Help_Id_Index   to IndexHelpId      // in help_ids.inc.
30345>>>   Set Help_Id_Keys    to KeysHelpId       //
30346>>>   Set Help_Id_Files   to FileHelpId       //
30347>>>   Set Help_Id_Errors  to ErrorHelpId      //
30348>>>
30348>>>end_object
30349>
30349>Use WinQlSQL.Sub
INCLUDING FILE: WINQLSQL.SUB
30349>>>Use CrystalReport.pkg
30349>>>
30349>>>Define PE_SUBREPORT_NAME_LEN       for 128
30349>>>
30349>>>Type PESubreportInfo
30349>>>  Field PESubreportInfo.structSize as Word
30349>>>  Field PESubreportInfo.name       as Char PE_SUBREPORT_NAME_LEN
30349>>>  Field PESubreportInfo.NLinks     as Short
30349>>>  Field PESubreportInfo.IsOnDemand as Short
30349>>>End_Type // PESubreportInfo
30349>>>
30349>>>
30349>>>External_Function PEGetNSections "PEGetNSections" CRPE32.DLL ;  Integer printJob ;  Returns Integer
30350>>>
30350>>>External_Function PEGetSectionCode "PEGetSectionCode" CRPE32.DLL ;  Integer printJob ;  Integer sectionN ;  Returns Integer
30351>>>
30351>>>External_Function PECloseSubreport "PECloseSubreport" CRPE32.DLL ;  Integer printJob ;  Returns Integer
30352>>>
30352>>>External_Function PEGetNSubreportsInSection "PEGetNSubreportsInSection" CRPE32.DLL ;  Integer printJob ;  Integer sectionCode ;  Returns Integer
30353>>>
30353>>>External_Function PEGetNthSubreportInSection "PEGetNthSubreportInSection" CRPE32.DLL ;  Integer printJob ;  Integer sectionCode ;  Integer subreportN ;  Returns Integer
30354>>>
30354>>>External_Function PEGetSubreportInfo "PEGetSubreportInfo" CRPE32.DLL ;  Integer printJob ;  Integer subreportHandle ;  Pointer subreportInfo ;  Returns Integer
30355>>>
30355>>>External_Function PEOpenSubreport "PEOpenSubreport" CRPE32.DLL ;  Integer parentJob ;  Pointer subreportName ;  Returns Integer
30356>>>
30356>>>
30356>>>Type PEWindowOptions
30356>>>  Field PEWindowOptions.StructSize As Word
30356>>>  Field PEWindowOptions.hasGroupTree As Word
30356>>>  Field PEWindowOptions.canDrillDown As Word
30356>>>  Field PEWindowOptions.hasNavigationControls As Word
30356>>>  Field PEWindowOptions.hasCancelButton As Word
30356>>>  Field PEWindowOptions.hasPrintButton As Word
30356>>>  Field PEWindowOptions.hasExportButton As Word
30356>>>  Field PEWindowOptions.hasZoomControl As Word
30356>>>  Field PEWindowOptions.hasCloseButton As Word
30356>>>  Field PEWindowOptions.hasProgressControls As Word
30356>>>  Field PEWindowOptions.hasSearchButton As Word
30356>>>  Field PEWindowOptions.hasPrintSetupButton As Word
30356>>>  Field PEWindowOptions.hasRefreshButton As Word
30356>>>End_Type // PEWindowOptions
30356>>>
30356>>>External_Function32 PESetWindowOptions "PESetWindowOptions" CRPE32.DLL ;  Integer printJob pointer Options Returns Integer
30357>>>
30357>>>Class CrystalReportSubSQL Is A CrystalReport
30358>>>
30358>>>    Procedure Construct_Object
30359>>>        Forward send Construct_Object
30361>>>        // Everything on except hasGroupTree by default
30361>>>        property integer hasGroupTree 0
30362>>>        property integer canDrillDown 1
30363>>>        property integer hasNavigationControls 1
30364>>>        property integer hasCancelButton 1
30365>>>        property integer hasPrintButton 1
30366>>>        property integer hasExportButton 1
30367>>>        property integer hasZoomControl 1
30368>>>        property integer hasCloseButton 1
30369>>>        property integer hasProgressControls 1
30370>>>        property integer hasSearchButton 1
30371>>>        property integer hasPrintSetupButton 1
30372>>>        property integer hasRefreshButton 1
30373>>>
30373>>>        Set WindowStyle To (WS_MAXIMIZE iOr WS_OVERLAPPEDWINDOW)
30374>>>    End_Procedure // Construct_Object
30375>>>
30375>>>    Procedure OutputToWindow String sTitle Integer iLeft Integer iTop Integer iWidth Integer iHeight Integer iStyle Handle hParent
30376>>>        Integer iPrintJob iResult
30377>>>        String sPEWindowOptions
30377>>>        Pointer pPeWindowOptions
30377>>>
30377>>>        Get PrintJob To iPrintJob
30378>>>        FillType PEWindowOptions with 0     to sPEWindowOptions
30379>>>        put PEWindowOptions_Size            to sPEWindowOptions at PEWindowOptions.StructSize
30380>>>        put (hasGroupTree(self))            to sPEWindowOptions at PEWindowOptions.hasGroupTree
30381>>>        put (canDrillDown(self))            to sPEWindowOptions at PEWindowOptions.canDrillDown
30382>>>        put (hasNavigationControls(self))   to sPEWindowOptions at PEWindowOptions.hasNavigationControls
30383>>>        put (hasCancelButton(self))         to sPEWindowOptions at PEWindowOptions.hasCancelButton
30384>>>        put (hasPrintButton(self))          to sPEWindowOptions at PEWindowOptions.hasPrintButton
30385>>>        put (hasExportButton(self))         to sPEWindowOptions at PEWindowOptions.hasExportButton
30386>>>        put (hasZoomControl(self))          to sPEWindowOptions at PEWindowOptions.hasZoomControl
30387>>>        put (hasCloseButton(self))          to sPEWindowOptions at PEWindowOptions.hasCloseButton
30388>>>        put (hasProgressControls(self))     to sPEWindowOptions at PEWindowOptions.hasProgressControls
30389>>>        put (hasSearchButton(self))         to sPEWindowOptions at PEWindowOptions.hasSearchButton
30390>>>        put (hasPrintSetupButton(self))     to sPEWindowOptions at PEWindowOptions.hasPrintSetupButton
30391>>>        put (hasRefreshButton(self))        to sPEWindowOptions at PEWindowOptions.hasrefreshButton
30392>>>        GetAddress of sPEWindowOptions      to pPEWindowOptions
30393>>>        Move (PESetWindowOptions(iPrintJob, pPEWindowOptions)) to iResult
30394>>>        Forward Send OutputToWindow sTitle iLeft iTop iWidth iHeight iStyle hParent
30396>>>    End_Procedure // OutputToWindow
30397>>>
30397>>>    Procedure Set TmpFileDir String aDir
30398>>>        String lsCurrWspc lsDir
30399>>>
30399>>>//        If (ghoWorkSpace <> 0) Begin
30399>>>//            Get WorkSpaceName of ghoWorkSpace to lsCurrWspc
30399>>>//            Insert "WorkSpaces\" in lsCurrWspc at 1
30399>>>//            Get_Profile_String lsCurrWspc aDir to lsDir
30399>>>//            Set Report_Data_Path to lsDir
30399>>>//        End
30399>>>    End_Procedure
30400>>>
30400>>>    Procedure DoWinQLReport
30401>>>        // This can be used when reports must be able to run in different data directories
30401>>>        Set TmpFileDir to "TmpFileDir"
30402>>>        Forward Send DoWinQLReport
30404>>>    End_Procedure
30405>>>
30405>>>
30405>>>  Function NSections Returns Integer
30406>>>    Integer iPrintJob iResult
30407>>>
30407>>>    Get PrintJob To iPrintJob
30408>>>    Move (PEGetNSections(iPrintJob)) To iResult
30409>>>    Move (Low(iResult)) To iResult
30410>>>    Function_Return iResult
30411>>>  End_Function // NSections
30412>>>
30412>>>  Function SectionCode Integer iSectionN Returns Integer
30413>>>    Integer iPrintJob iResult
30414>>>
30414>>>    Get PrintJob To iPrintJob
30415>>>    Move (PEGetSectionCode(iPrintJob,iSectionN)) To iResult
30416>>>    Move (Low(iResult)) To iResult
30417>>>    Function_Return iResult
30418>>>  End_Function // SectionCode
30419>>>
30419>>>  Function CloseSubreport Integer iSubreport Returns Integer
30420>>>    Integer iResult
30421>>>
30421>>>    Move (PECloseSubreport(iSubreport)) To iResult
30422>>>    Function_Return iResult
30423>>>  End_Function // CloseSubreport
30424>>>
30424>>>  Function NSubreportsInSection Integer iSectionCode Returns Integer
30425>>>    Integer iPrintJob iResult
30426>>>
30426>>>    Get PrintJob To iPrintJob
30427>>>    Move (PEGetNSubreportsInSection(iPrintJob,iSectionCode)) To iResult
30428>>>    Move (Low(iResult)) To iResult
30429>>>    Function_Return iResult
30430>>>  End_Function // nSubreportsInSection
30431>>>
30431>>>  Function NthSubreportInSection Integer iSectionCode Integer iSubreportN Returns Integer
30432>>>    Integer iPrintJob iResult
30433>>>
30433>>>    Get PrintJob To iPrintJob
30434>>>    Move (PEGetNthSubreportInSection(iPrintJob,iSectionCode,iSubreportN)) To iResult
30435>>>    Function_Return iResult
30436>>>  End_Function // NthSubreportInSection
30437>>>
30437>>>  Function SubreportName Integer iSubreportHandle Returns String
30438>>>    String sPESubreportInfo sResult
30439>>>    Pointer pPESubreportInfo
30439>>>    Integer iPrintJob iResult
30439>>>
30439>>>    ZeroType PESubreportInfo To sPESubreportInfo
30440>>>    Put PESubreportInfo_Size To sPESubreportInfo at PESubreportInfo.structSize
30441>>>    GetAddress Of sPESubreportInfo to pPESubreportInfo
30442>>>
30442>>>    Get PrintJob To iPrintJob
30443>>>    Move (PEGetsubreportInfo(iPrintJob,iSubreportHandle,pPESubreportInfo)) To iResult
30444>>>    If iResult GetBuff_String From sPESubreportInfo at PESubreportInfo.name To sResult
30447>>>    Function_Return (ToOEM(sResult))
30448>>>  End_Function // SubreportName
30449>>>
30449>>>  Function SubreportNLinks Integer iSubreportHandle Returns Integer
30450>>>    String sPESubreportInfo
30451>>>    Pointer pPESubreportInfo
30451>>>    Integer iPrintJob iResult
30451>>>
30451>>>    ZeroType PESubreportInfo To sPESubreportInfo
30452>>>    Put PESubreportInfo_Size To sPESubreportInfo at PESubreportInfo.structSize
30453>>>    GetAddress Of sPESubreportInfo to pPESubreportInfo
30454>>>
30454>>>    Get PrintJob To iPrintJob
30455>>>    Move (PEGetsubreportInfo(iPrintJob,iSubreportHandle,pPESubreportInfo)) To iResult
30456>>>    If iResult GetBuff From sPESubreportInfo at PESubreportInfo.NLinks To iResult
30459>>>    Function_Return iResult
30460>>>  End_Function // SubreportNLinks
30461>>>
30461>>>  Function SubreportIsOnDemand Integer iSubreportHandle Returns Integer
30462>>>    String sPESubreportInfo
30463>>>    Pointer pPESubreportInfo
30463>>>    Integer iPrintJob iResult
30463>>>
30463>>>    ZeroType PESubreportInfo To sPESubreportInfo
30464>>>    Put PESubreportInfo_Size To sPESubreportInfo at PESubreportInfo.structSize
30465>>>    GetAddress Of sPESubreportInfo to pPESubreportInfo
30466>>>
30466>>>    Get PrintJob To iPrintJob
30467>>>    Move (PEGetsubreportInfo(iPrintJob,iSubreportHandle,pPESubreportInfo)) To iResult
30468>>>    If iResult GetBuff From sPESubreportInfo at PESubreportInfo.IsOnDemand To iResult
30471>>>    Function_Return iResult
30472>>>  End_Function // SubreportIsOnDemand
30473>>>
30473>>>  Function OpenSubReport String sSubreport Returns Integer
30474>>>    Integer iPrintJob iResult
30475>>>    Pointer pSubreport
30475>>>
30475>>>    Get PrintJob To iPrintJob
30476>>>    GetAddress Of sSubreport To pSubreport
30477>>>    Move (PEOpenSubreport(iPrintJob,pSubreport)) To iResult
30478>>>    Move (Low(iResult)) To iResult
30479>>>    Function_Return iResult
30480>>>  End_Function // OpenSubReport
30481>>>
30481>>>  Function NTablesInSubreport Integer iSubreportHandle Returns Integer
30482>>>    Local Integer iResult
30483>>>
30483>>>    Move (PEGetNTables(iSubreportHandle)) To iResult
30484>>>    Move (Low(iResult)) To iResult
30485>>>    Function_Return iResult
30486>>>  End_Function // NTablesInSubreport
30487>>>
30487>>>  Function NthTableLocationInSubreport Integer iSubreportHandle Integer iTableN Returns String
30488>>>    Local String sPETableLocation sReturn
30489>>>    Local Pointer pPETableLocation
30489>>>    Local Integer iResult
30489>>>
30489>>>    FillType PETableLocation With 0 To sPETableLocation
30490>>>    Put PETableLocation_Size To sPETableLocation At PETableLocation.StructSize
30491>>>    GetAddress Of sPETableLocation To pPETableLocation
30492>>>    Move (PEGetNthTableLocation(iSubreportHandle,iTableN,pPETableLocation)) To iResult
30493>>>    If iResult GetBuff_String From sPETableLocation At PETableLocation.Location To sReturn
30496>>>    Function_Return (ToOEM(sReturn))
30497>>>  End_Function // NthTableLocationInSubreport
30498>>>
30498>>>  Procedure Set NthTableLocationInSubreport Integer iSubreportHandle Integer iTableN String sLocation
30499>>>    Local String sPETableLocation
30500>>>    Local Pointer pPETableLocation
30500>>>    Local Integer iResult
30500>>>
30500>>>    Move (ToANSI(sLocation+Character(0))) To sLocation
30501>>>    FillType PETableLocation With 0 To sPETableLocation
30502>>>    Put PETableLocation_Size To sPETableLocation At PETableLocation.StructSize
30503>>>    Put_String sLocation To sPETableLocation At PETableLocation.Location
30504>>>    GetAddress Of sPETableLocation To pPETableLocation
30505>>>    Move (PESetNthTableLocation(iSubreportHandle,iTableN,pPETableLocation)) To iResult
30506>>>  End_Procedure // Set NthTableLocationInSubreport
30507>>>
30507>>>
30507>>>    // This hook procedure is called after the print job has been opened.
30507>>>    Procedure OnInitializeReport
30508>>>    ////// SOS Na ginei xana OnInitializeReport ///////////
30508>>>
30508>>>        Integer iTables iMax iCount iType
30509>>>        String  sLocation sLocation2 sPath DirSep
30509>>>        String  sNewPath sNewLocation sDataPath sMyLocation
30509>>>
30509>>>        Integer lnSections lnSubreports lnTables iPrintJob iPath
30509>>>        Integer iSection iCode iSubreport iTable iNumPaths bExists
30509>>>        Handle hSubreport
30509>>>        String sTable sSubreport sTempFilePath
30509>>>        Boolean bCheckforTempfile bTemp
30509>>>
30509>>>        //Forward Send OnInitializeReport
30509>>>
30509>>>        Open Company
INCLUDING FILE: COMPANY.FD
30511>>>        Open Syscurxr
INCLUDING FILE: SYSCURXR.FD
30513>>>
30513>>>        Clear Company
30514>>>        Move SyscurXr.Company_Code to Company.Company_Code
30515>>>        Find Eq Company By Index.1
30516>>>>
30516>>>
30516>>>        If ((Found) And (Company.Company_C_CodeR='')) Procedure_Return
30519>>>        String  sActualSQL
30519>>>        String  sActualTemp
30519>>>        String  sOldSQL
30519>>>        String  sOldTemp
30519>>>        String  sServerName
30519>>>        String  sDatabaseName
30519>>>        String  sUserID
30519>>>
30519>>>        Move Company.Company_C_CodeR    to sServerName          // ODBC sto 1o pedio
30520>>>        Move Company.Company_C_CodER    to sActualSQL           // Database sto 2o pedio
30521>>>        Move Company.Company_C_CodER    to sDatabaseName        // Database sto 2o pedio
30522>>>
30522>>>        Move 'SMS'              to sOldSQL
30523>>>        Move 'C:\Dns_tmp\'      to sOldTemp
30524>>>
30524>>>
30524>>>        Move 'C:\Dns_tmp\'      to sActualTemp
30525>>>
30525>>>        Move (Trim(sActualSQL   )) to sActualSQL
30526>>>        Move (Trim(sActualTemp  )) to sActualTemp
30527>>>        Move (Trim(sOldSQL      )) to sOldSQL
30528>>>        Move (Trim(sOldTemp     )) to sOldTemp
30529>>>        Move (Trim(sServerName  )) to sServerName
30530>>>        Move (Trim(sDatabaseName)) to sDatabaseName
30531>>>        Move (Trim(sUserID      )) to sUserID
30532>>>
30532>>>        Move (Sysconf(SYSCONF_DIR_SEPARATOR)) To DirSep
30533>>>
30533>>>        Get NTables To iMax
30534>>>        Decrement iMax
30535>>>        Get Report_Data_Path                                    To sPath
30536>>>        If Not (Right(sPath,1)) Eq DirSep Move (sPath-DirSep)   To sPath
30539>>>        For iCount From 0 To iMax
30545>>>>
30545>>>            Get NthTableLocation iCount         To sLocation
30546>>>            Get Report_Base_File_Name sLocation To sLocation2
30547>>>            Get NthTableDBType           iCount to iType
30548>>>
30548>>>            // An einai type 1 topiko
30548>>>            //               2=SQL
30548>>>            If (iType=2) Begin
30550>>>                If (sLocation contains sOldSQL) Begin
30552>>>                    Move (Replace(sOldSQL,sLocation,sActualSQL))    to sLocation
30553>>>                    Set NthTableLocation iCount                     to (Trim(sLocation))
30554>>>                End
30554>>>>
30554>>>            End
30554>>>>
30554>>>            Else If (iType=1) Begin
30557>>>                If (sLocation contains sOldTemp) Begin
30559>>>                    Move (Replace(sOldTemp,sLocation,sActualTemp))  to sLocation
30560>>>                    Set NthTableLocation iCount                     to (Trim(sLocation))
30561>>>                End
30561>>>>
30561>>>            End
30561>>>>
30561>>>            Set nthTableLogOnServerName     iCount to sServerName     0
30562>>>            Set nthTableLogOnDataBaseName   iCount to sDatabaseName   0
30563>>>            Set nthTableLogOnUserID         iCount to sUserID         0 // 'sa'     0
30564>>>        Loop // For iCount From 0 To iMax
30565>>>>
30565>>>
30565>>>        // Set the location of the tables for the subreports
30565>>>        Get NSections To lnSections
30566>>>        For iSection From 0 To (lnSections-1)
30572>>>>
30572>>>            Get SectionCode iSection To iCode
30573>>>            Get NSubreportsInSection iCode To lnSubreports
30574>>>            For iSubreport From 0 To (lnSubreports-1)
30580>>>>
30580>>>                Get NthSubreportInSection iCode iSubreport To hSubreport
30581>>>                Get SubreportName hSubreport To sSubreport
30582>>>                Get OpenSubreport sSubreport To iPrintJob
30583>>>                Get NTablesInSubreport iPrintJob To lnTables
30584>>>                For iTable From 0 To (lnTables-1)
30590>>>>
30590>>>                    Get NthTableLocationInSubreport iPrintJob iTable To sTable
30591>>>                    If (sTable contains sOldSQL) Begin
30593>>>                            Move '' to sLocation
30594>>>                            Move (Replace(sOldSQL,sTable,sActualSQL)) to sLocation
30595>>>                            Set NthTableLocationInSubreport iPrintJob iTable To (Trim(sLocation))
30596>>>                            Set nthTableLogOnServerName     iTable to sServerName     0
30597>>>                            Set nthTableLogOnDataBaseName   iTable to sDatabaseName   0
30598>>>                            Set nthTableLogOnUserID         iTable to sUserID         0 // 'sa'     0
30599>>>                    End
30599>>>>
30599>>>                Loop // For iTable From 0 To nTables
30600>>>>
30600>>>            Loop // For iSubreport From 0 To nSubreports
30601>>>>
30601>>>        Loop // For iSection From 0 To (iSections-1)
30602>>>>
30602>>>
30602>>>    End_Procedure // OnInitializeReport
30603>>>
30603>>>
30603>>>    // This hook procedure is called just before a print job is closed.
30603>>>    Procedure OnDeInitializeReport
30604>>>        Forward Send OnDEInitializeReport
30606>>>    End_Procedure // OnDeInitializeReport
30607>>>
30607>>>    // This hook procedure is called just before a the print job is started.
30607>>>    Procedure OnStartPrinting
30608>>>        Forward Send OnStartPrinting
30610>>>    End_Procedure // OnStartPrinting
30611>>>
30611>>>    // This hook procedure is called just after a print job has finished.
30611>>>    Procedure OnStopPrinting
30612>>>        Forward Send OnStopPrinting
30614>>>    End_Procedure // OnStopPrinting
30615>>>End_Class // CrystalReportSubSQL
30616>>>
30616>Integer giWait_Obj
30616>
30616>// General Functions-Procedures and Variables
30616>Use Globals.Inc
INCLUDING FILE: GLOBALS.INC
30616>>>
30616>>>        String  gs_Selected_Company_Code
30616>>>        String  gs_Selected_Branch_Code
30616>>>        Integer gi_Selected_Year
30616>>>        String gs_Selected_Year_Recr
30616>>>        String  gs_Module_Code
30616>>>
30616>>>
30616>>>//Open Currency
30616>>>//Function CurrDigits Global String asCurr Returns Integer
30616>>>//    Integer liDecX
30616>>>//    Clear Currency
30616>>>//    move asCurr to Currency.Currency_C_Code
30616>>>//    Find Eq Currency By Index.1
30616>>>//    move Currency.Currency_Dec to liDecX
30616>>>//    Function_Return liDecX
30616>>>//End_Function // CurrDigits
30616>>>
30616>>>Open Nomisma
INCLUDING FILE: NOMISMA.FD
30618>>>Open SysCurXr
30620>>>
30620>>>Function fiDekadika_Nomismatos Global String asNomisma Returns Integer
30621>>>    Move (Trim(asNomisma)) to asNomisma
30622>>>    Clear Nomisma
30623>>>    If ( asNomisma<>'' ) Move asNomisma         to Nomisma.Nomisma_Code
30626>>>    Else                 Move SysCurXr.C_Code0  to Nomisma.Nomisma_Code
30628>>>    Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
30629>>>>
30629>>>    Function_Return Nomisma.Dekadika
30630>>>End_Function //
30631>>>
30631>>>Function fsgCode_W_Zeroes Global Integer aiCode Integer aiPlaces Returns String
30632>>>    String rVal
30633>>>    Integer iLength iInt
30633>>>    Move aiCode to rVal
30634>>>    Move (trim(rVal)) to rVal
30635>>>    For iInt From 1 to (aiPlaces-(Length(rVal)))
30641>>>>
30641>>>        Move (Insert('0',rVal,1)) to rVal
30642>>>    Loop
30643>>>>
30643>>>    Function_Return rVal
30644>>>End_Function
30645>>>
30645>>>Function fsgCode_n_Zeroes Global number aiCode Integer aiPlaces Returns String
30646>>>    String rVal
30647>>>    Integer iLength iInt ipos
30647>>>    Move aiCode to rVal
30648>>>    Move (trim(rVal)) to rVal
30649>>>    MOVE (aiPlaces-(Length(rVal))) to ipos
30650>>>    For iInt From 1 to ipos
30656>>>>
30656>>>        Move (Insert('0',rVal,1)) to rVal
30657>>>    Loop
30658>>>>
30658>>>    Function_Return rVal
30659>>>End_Function
30660>>>
30660>>>
30660>>>Open Year
INCLUDING FILE: YEAR.FD
30662>>>Procedure EnumDDsForRebuildConstrain for DataDictionary integer aiMsg integer ahId
30663>>>    Send aiMsg to Self
30664>>>End_Procedure
30665>>>
30665>>>Procedure DoRefindYear for baseclass Integer aiPanel Integer aiYearDD
30666>>>    Integer liChanged
30667>>>
30667>>>    If ((aiYearDD = 0) or (Main_File(aiYearDD)<>Year.File_Number)) ;        Procedure_Return (Message_Box("Invalid Year_DD","Developer's Warning",MB_OK,MB_ICONWARNING))
30670>>>    If (Not(Current_Record(aiYearDD))) Begin
30672>>>        Get Should_Save of aiPanel to liChanged
30673>>>        Send Clear to aiYearDD
30674>>>        Move gs_Selected_Company_Code to Year.Company_Code
30675>>>        Move gs_Selected_Branch_Code  to Year.Branch_Code
30676>>>        Move gi_Selected_Year         to Year.Year_Year
30677>>>        Send Find to aiYearDD Eq 1 //Year.Index.1 - company_code+ranch_code+year_year
30678>>>        If (Not(liChanged)) Set Changed_State of aiPanel to False
30681>>>    End
30681>>>>
30681>>>End_Procedure
30682>>>
30682>>>Procedure RebuildConstrainIfYearChanged for baseclass Integer aiPanel String asCurrentYearRecr Integer aiYearDDId
30683>>>    Integer liSrvr
30684>>>    String  lsCurrentYearRecr
30684>>>
30684>>>    If (asCurrentYearRecr <> gs_Selected_Year_Recr) Begin
30686>>>        Broadcast Send EnumDDsForRebuildConstrain to aiPanel msg_Rebuild_Constraints Self
30688>>>    End
30688>>>>
30688>>>    Send DoRefindYear aiPanel aiYearDDId //(Year_DD(Self))
30689>>>    Get Server of aiPanel to liSrvr
30690>>>    // Respects Default values
30690>>>    If (liSrvr) If (Not(Current_Record(liSrvr))) Send Request_Clear to aiPanel
30695>>>End_Procedure
30696>>>
30696>>>//                                       ’¦ View            Property «¦¬ View             ’¦ Year DDO «¦¬ View
30696>>>//                                                          Holds the current year rec0
30696>>>// ‰¢ã©ž : Send RbldConstrIfYearChanged (Gplan_Test(Self))  (psCurrentYearRecr(Self))     (Year_DD(Self))
30696>>>
30696>>>
30696>>>Function fiRefindYear Global Returns Integer
30697>>>    Clear Year
30698>>>    Move gs_Selected_Company_Code to Year.Company_Code
30699>>>    Move gs_Selected_Branch_Code  to Year.Branch_Code
30700>>>    Move gi_Selected_Year         to Year.Year_Year
30701>>>    Find eq Year by Index.1 //company_code+ranch_code+year_year
30702>>>>
30702>>>    Function_Return (Found = 0)
30703>>>End_Function //fiRefindYear
30704>>>
30704>>>Procedure DoRunApplication for Baseclass String sAppName
30705>>>    string sRuntime  lsStr
30706>>>
30706>>>    Append lsStr 'C:\Dns.bat ' sAppName
30708>>>    RunProgram Wait  lsStr
30709>>>
30709>>>//    get_profile_string "defaults" "VDFBinDir" to sRuntime
30709>>>//    append sRuntime "\dfrun " sAppName
30709>>>    Append sRuntime 'C:\Program Files\Accessories\WORDPAD.EXE ' sAppName
30711>>>    runprogram background sRuntime
30712>>>End_procedure // DoRunApplication
30713>>>
30713>>>// Run the Editor
30713>>>Procedure DoRunEditor for Baseclass String asFile
30714>>>    string sRunPath lsWspcName
30715>>>    Move (WorkspaceName(ProgramWorkspace(Self))) to lsWspcName
30716>>>    get_profile_string ("workspaces\"+lsWspcName) "programpath" to sRunPath
30719>>>    //append sRunPath "\Editor "  asFile //// js 15/03/2002 " " lsWspcName
30719>>>    Move (Replace('.',asFile,'')) to asFile
30720>>>    append sRunPath asFile //// js 15/03/2002 " " lsWspcName
30721>>>    send DoRunApplication sRunPath
30722>>>End_Procedure // DoRunEditor
30723>>>
30723>>>//--------------------------------------
30723>>>
30723>>>//start of global functions and procedures
30723>>>
30723>>>
30723>>>//®¨ž© £¦§¦ œå«˜  ˜§æ: ˜) gmoves.dd    :private.update_gmhnes_ghmnies
30723>>>Function gsfFind_Previous Global String lsCode;                                 String lsDelimiter;                                 Returns String
30724>>>         String  lsTemp_Code1 lsTemp_Code2
30725>>>         Integer liCounter
30725>>>
30725>>>         //1.˜­˜å¨œ©ž ¡œ¤é¤
30725>>>         Move (Trim(lsCode)) to lsCode                                  //§® 30.12.345
30726>>>
30726>>>         //2.˜¤« ©«¨¦­ã
30726>>>         For liCounter From 1 to (Length(lsCode))
30732>>>>
30732>>>             Move (Insert(;                           (Mid(lsCode,1,liCounter)),;                           lsTemp_Code1,;                           1;                         )) to lsTemp_Code1                             //§® 543.21.03
30733>>>         Loop
30734>>>>
30734>>>
30734>>>         //3.˜­˜å¨œ©ž ¡œ¤é¤ (›â¤ ®¨œ áœ«˜ , safety only)
30734>>>         Move (Trim(lsTemp_Code1)) to lsTemp_Code1
30735>>>
30735>>>         //4.§˜å¨¤à £æ¤¦ «¦ ›œ¥ æ £â¨¦ª «¦¬ ˜¤«å©«¨¦­¦¬, £œ«á «¦ §¨é«¦ delimiter
30735>>>         Move (Right(;                      lsTemp_Code1,;                      ((Length(lsTemp_Code1))-((Pos(lsDelimiter,lsTemp_Code1))));                    )) to lsTemp_Code1                                  // §® 21.03
30736>>>
30736>>>         //5.¥˜¤á ˜¤« ©«¨¦­ã «¦¬ ˜¤«å©«¨¦­¦¬
30736>>>         For liCounter from 1 to (Length(lsTemp_Code1))
30742>>>>
30742>>>             Move (Insert(;                           (Mid(lsTemp_Code1,1,liCounter)),;                           lsTemp_Code2,;                           1;                         )) to lsTemp_Code2                             //§® 30.12
30743>>>         Loop
30744>>>>
30744>>>
30744>>>         Function_Return (Trim(lsTemp_Code2))
30745>>>End_Function //gsffind_previous
30746>>>
30746>>>
30746>>>Function gifSystem_Check Returns Integer
30747>>>         Integer liF_Gtypkins liF_Garicls liF_Gmoves liF_Gplans liF_Gmhnes liF_Ghmnies
30748>>>         Integer liS_Gtypkins liS_Garicls liS_Gmoves liS_Gplans liS_Gmhnes liS_Ghmnies
30748>>>//       Clear Company
30748>>>//       Find Gt Company.Recnum
30748>>>//       While (Found = 1)
30748>>>//             Add Company.Company_NumGtypkin to liS_Gtypkins § Ÿ˜¤é© ©«¦ sysfile ¤˜ «˜ ¡˜¨˜«áà ˜¬«á
30748>>>//             Add Company.Company_NumGarticl to liS_Garticls
30748>>>//             Add Company.Company_NumGmoves  to liS_Gmoves
30748>>>//             //d Company.Company_NumGtypkin to liS_Gtypkins
30748>>>//             Add Company.Company_NumGplan   to liS_GPlans
30748>>>//             Add Company.Company_NumGmhnes  to liS_Gmhnes
30748>>>//             Add Company.Company_NumGhmnies to liS_Ghmnies
30748>>>//             Find Gt Company.Recnum
30748>>>//       Loop
30748>>>//
30748>>>//       Get_Attribute {attribute} [of {file-handle} ;
30748>>>//                        [{field-num} | {index-num} [{segment-num}]]] ;
30748>>>//                        To {variable}
30748>>>//
30748>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30748>>>//       Get_Attribute DF_FILE_RECORDS_USED of Garticl.File_Number to liF_Garticls
30748>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmoves.File_Number  to liF_Gmoves
30748>>>//       //t_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30748>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gplan.File_Number   to liF_Gplans
30748>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmhnes.File_Number  to liF_Gmhnes
30748>>>//       Get_Attribute DF_FILE_RECORDS_USED of Ghmnies.File_Number to liF_Ghmnies
30748>>>//
30748>>>
30748>>>//       //â¢œš®¦ª DF_FILE_MAX_RECORDS+ £œ records used
30748>>>
30748>>>//       //â¢œš®¦ª last rec0 = sysrec rec0
30748>>>
30748>>>    Function_Return 0
30749>>>End_Function //gifSystem_Check
30750>>>
30750>>>/////////////////////////////////////////////////////////////////
30750>>>//‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª, £œ ž ®à¨åª ›œ¡˜› ¡á  JS
30750>>>Function Sfi_All_Numbers Global Number anValue Integer aiLengthAkeraios Integer aiLengthDekadika Returns String
30751>>>
30751>>>    String  lsRetval lsValue lsAkeraios lsDekadika
30752>>>    Integer liInt liInteger iTimes iStart
30752>>>    Number  lnDecimals
30752>>>
30752>>>    Move (Integer(anValue))                                         to liInteger
30753>>>    Move (Round(AnValue-(Integer(anValue))*(10^aiLengthDekadika)))  to lnDecimals
30754>>>
30754>>>    Move liInteger              to lsAkeraios
30755>>>    Move lnDecimals             to lsDekadika
30756>>>    Move (Trim(lsAkeraios))     to lsAkeraios
30757>>>    Move (Trim(lsDekadika))     to lsDekadika
30758>>>
30758>>>    Move (Length(lsAkeraios)) to iStart
30759>>>    For iTimes From iStart to (aiLengthAkeraios-1)
30765>>>>
30765>>>        Insert "0" in lsAkeraios at 1
30767>>>    Loop
30768>>>>
30768>>>    Move (Trim(lsAkeraios)) to lsAkeraios
30769>>>
30769>>>    Move (Length(lsDekadika)) to iStart
30770>>>    For iTimes From iStart to (aiLengthDekadika-1)
30776>>>>
30776>>>        Move (Append(lsDekadika,"0")) to lsDekadika
30777>>>    Loop
30778>>>>
30778>>>    Move (Trim(lsDekadika)) to lsDekadika
30779>>>
30779>>>    If (aiLengthDekadika=0) Move '' to lsDekadika
30782>>>    Move '' to lsRetVal
30783>>>    Move (Pad((lsAkeraios-lsDekadika),(aiLengthAkeraios+aiLengthDekadika))) to lsRetval
30784>>>    Function_Return lsRetval
30785>>>End_Function //sfi_All_Numbers  ‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª
30786>>>              //                 £œ ž ®à¨åª ›œ¡˜› ¡á (JS)
30786>>>
30786>>>Open Codemast
30788>>>
30788>>>
30788>>>Function gsfCode_Mast Global String lsType String lsValue Returns String
30789>>>         Clear Codemast
30790>>>         Move lsType  to Codemast.Type
30791>>>         Move lsValue to Codemast.Code
30792>>>         Find Eq Codemast by Index.1 //type+code
30793>>>>
30793>>>         Function_Return Codemast.Description
30794>>>End_Function //code_mast
30795>>>
30795>>>
30795>>>Open Branch
INCLUDING FILE: BRANCH.FD
30797>>>Function fsgCode_With_Zeroes Global Integer aiCode    ;                                    Integer aiPlaces  ;                                    String asCompany  ;                                    String asBranch   ;                               Returns String
30798>>>    String rVal
30799>>>    Integer iInt
30799>>>    Clear Branch
30800>>>    Move asCompany  to Branch.Company_Code
30801>>>    Move asBranch   to Branch.Branch_Code
30802>>>    Find Eq Branch by Index.1
30803>>>>
30803>>>    If (Trim(Branch.Tomeas_Code)<>'') Move (Trim(Branch.Tomeas_Code)) to asBranch
30806>>>    Move (Trim(asCompany))  to asCompany
30807>>>    Move (Trim(asBranch))   to asBranch
30808>>>    If (Length(asCompany)=1) Insert '0' In asCompany At 1
30812>>>    If (Length(asBranch) =1) Insert '0' In asBranch  At 1
30816>>>    Move ''                                           to rVal
30817>>>    Move (Sfi_All_Numbers(aiCode,aiPlaces,0))         to rVal
30818>>>    Move (Append((asCompany+'.'+asBranch+'.'),rVal))  to rVal
30819>>>    Move (Trim(rVal))                                 to rVal
30820>>>    Function_Return rVal
30821>>>End_Function
30822>>>
30822>>>Function fsgStripCodeFromID Global String asID Returns Integer
30823>>>      Integer iLen iPos iInt
30824>>>      If (Trim(asID)='') Function_Return 0
30827>>>      Move (Trim  (asID)) to asID
30828>>>      Move (Length(asID)) to iLen
30829>>>      For iInt From 1     to iLen
30835>>>>
30835>>>          If (Mid(asID,1,iInt)='.') Move iInt to iPos
30838>>>      Loop
30839>>>>
30839>>>      Function_Return (Right(asID,(iLen-iPos)))
30840>>>End_Function
30841>>>
30841>>>Function fsCityDescr Global Integer aiCityID Returns String
30842>>>    String rVal
30843>>>    Open Cities
INCLUDING FILE: CITIES.FD
30845>>>    Clear Cities
30846>>>    Move aiCityID to Cities.City_ID
30847>>>    Find Eq Cities By Index.1
30848>>>>
30848>>>    If (Found=1) Move Cities.City_descr to rVal
30851>>>    Else         Move '' to rVal
30853>>>    Function_Return rVal
30854>>>End_Function
30855>>>
30855>>>Function fiTownIDFromCity Global Integer aiCityID Returns Integer
30856>>>    Open Cities
30858>>>    Clear Cities
30859>>>    Move aiCityID to Cities.City_ID
30860>>>    Find Eq Cities By Index.1
30861>>>>
30861>>>    Function_Return Cities.Town_ID
30862>>>End_Function
30863>>>
30863>>>Function fiCountryIDFromTown Global Integer aiTownID Returns Integer
30864>>>    Open Towns
INCLUDING FILE: TOWNS.FD
30866>>>    Clear Towns
30867>>>    Move aiTownID to Towns.Town_ID
30868>>>    Find Eq Towns By Index.1
30869>>>>
30869>>>    Function_Return Towns.Country_ID
30870>>>End_Function
30871>>>
30871>>>Function fsTownDescr Global Integer aiTownID Returns String
30872>>>    String rVal
30873>>>    Open Towns
30875>>>    Clear Towns
30876>>>    Move aiTownID to Towns.Town_ID
30877>>>    Find Eq Towns By Index.1
30878>>>>
30878>>>    If (Found=1) Move Towns.Town_descr to rVal
30881>>>    Else         Move '' to rVal
30883>>>    Function_Return rVal
30884>>>End_Function
30885>>>
30885>>>Function fsCountryDescr Global Integer aiCountryID Returns String
30886>>>    String rVal
30887>>>    Open Country
INCLUDING FILE: COUNTRY.FD
30889>>>    Clear Country
30890>>>    Move aiCountryID to Country.Country_ID
30891>>>    Find Eq Country By Index.1
30892>>>>
30892>>>    If (Found=1) Move Country.Country_descr to rVal
30895>>>    Else         Move '' to rVal
30897>>>    Function_Return rVal
30898>>>End_Function
30899>>>
30899>>>Function fsAreaDescr Global Integer aiAreaID Returns String
30900>>>    String rVal
30901>>>    Open Areas
INCLUDING FILE: AREAS.FD
30903>>>    Clear Areas
30904>>>    Move aiAreaID to Areas.Area_ID
30905>>>    Find Eq Areas By Index.1
30906>>>>
30906>>>    If (Found=1) Move Areas.Area_descr to rVal
30909>>>    Else         Move '' to rVal
30911>>>    Function_Return rVal
30912>>>End_Function
30913>>>
30913>>>Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
30914>>>    Local String rVal lsTmp lsOO lsLL
30915>>>    Local Number lnOO lnLL
30915>>>
30915>>>    Move '' to lsOO
30916>>>    Move '' to lsLL
30917>>>    Move '' to rVal
30918>>>
30918>>>    Move (Integer(anTime))                              to lnOO
30919>>>
30919>>>    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
30920>>>
30920>>>    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
30923>>>    Else         Move (String(lnOO))                    to lsOO
30925>>>    Move (Trim(lsOO))                                   to lsOO
30926>>>
30926>>>    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
30929>>>    Else         Move (String(lnLL))                    to lsLL
30931>>>    Move (Trim(lsLL))                                   to lsLL
30932>>>
30932>>>    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
30933>>>
30933>>>    Move (Trim(rVal)) to rVal
30934>>>
30934>>>    Function_Return rVal
30935>>>End_Function
30936>>>
30936>>>Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
30937>>>    Local Number rVal nOres nLepta
30938>>>    Move (Integer(aiMinutes/60))    to nOres
30939>>>    Move (    Mod(aiMinutes,60))    to nLepta
30940>>>    Move (nOres+(nLepta/100))       to rVal
30941>>>    Function_Return rVal
30942>>>End_Function
30943>>>
30943>>>Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
30944>>>    Local Integer rVal
30945>>>    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
30946>>>    Function_Return rVal
30947>>>End_Function
30948>>>
30948>>>Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;                                                                    Number anEndTime    ;                                                                    Returns Integer
30949>>>    Local Integer rVal iMinStart iMinEnd
30950>>>
30950>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30953>>>
30953>>>    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
30954>>>    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
30955>>>    Move (iMinEnd-iMinStart)                                                     to rVal
30956>>>    Function_Return rVal
30957>>>End_Function
30958>>>
30958>>>
30958>>>Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;                                                                Number anEndTime    ;                                                                Returns Number
30959>>>    Local Integer iTmp
30960>>>    Local Number  rVal
30960>>>
30960>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30963>>>
30963>>>    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
30964>>>    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
30965>>>    Function_Return rVal
30966>>>End_Function
30967>>>
30967>>>
30967>>>Open WitemCL
INCLUDING FILE: WITEMCL.FD
30969>>>Open WitemCld
INCLUDING FILE: WITEMCLD.FD
30971>>>Open WitemxT
INCLUDING FILE: WITEMXT.FD
30973>>>
30973>>>Function fnTeleytaiaTimhAgoras String asPromCode String asItemCode  ;                               Date   adHmnia    Number anQty       ;                               Returns Number
30974>>>  Integer iExodos
30975>>>  Number nPoso nPct
30975>>>  Move 0 to nPoso
30976>>>  Move 0 to nPct
30977>>>  Move 0 to iExodos
30978>>>
30978>>>  Move (Trim(asItemCode)) to asItemCode
30979>>>  Move (Trim(asPromCode)) to asPromCode
30980>>>
30980>>>  // 1.Anazhthsh sto arxeio Witemcld
30980>>>  Clear Witemcld
30981>>>  Move asItemCode to Witemcld.Item_Code
30982>>>  Move asPromCode to Witemcld.Client_Code
30983>>>  Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30984>>>>
30984>>>  While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;                       (Witemcld.Client_Code= asPromCode) And ;                       (iExodos=0))
30988>>>      If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30990>>>          Move 1 to iExodos
30991>>>               If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30994>>>          Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30998>>>      End
30998>>>>
30998>>>      Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30999>>>>
30999>>>  Loop
31000>>>>
31000>>>  If (iExodos) Begin
31002>>>      If (nPoso) Function_Return nPoso
31005>>>      Else Function_Return nPct
31007>>>  End
31007>>>>
31007>>>
31007>>>  // 2.Anazhthsh sto arxeio Witemcl
31007>>>  Clear WitemCL
31008>>>  Move (Trim(asPromCode)) to WitemCL.Client_Code
31009>>>  Move (Trim(asItemCode)) to WitemCL.Item_Code
31010>>>  Find Eq WitemCL By Index.1
31011>>>>
31011>>>  If (Found=1) Function_Return WitemCL.Client_Price
31014>>>
31014>>>  Function_Return 0
31015>>>End_Function
31016>>>
31016>>>
31016>>>Open BtnOrdd
INCLUDING FILE: BTNORDD.FD
31018>>>
31018>>>Function fnTeleytaiaTimhPolhshs String asWitemxRecr String asClientID ;                                String asWitemxCode Date   adHmnia    ;                                String asItemCode   Number anQty      ;                                String asCNCode     Returns Number
31019>>>
31019>>>  Integer iExodos iCheckDeop
31020>>>  Number nPoso nPct
31020>>>
31020>>>  Move (Num_Arguments=7) to iCheckDeop
31021>>>
31021>>>  Move 0 to nPoso
31022>>>  Move 0 to nPct
31023>>>  Move 0 to iExodos
31024>>>
31024>>>  Move (Trim(asItemCode))                 to asItemCode
31025>>>  Move (Trim(asClientID))                 to asClientID
31026>>>  Move (Trim(asWitemxRecr))               to asWitemxRecr
31027>>>  Move (Trim(asWitemxCode))               to asWitemxCode
31028>>>  If (iCheckDeop) Move (Trim(asCNCode))   to asCNCode
31031>>>
31031>>>  // 1. Anazhthsh apo DEOP ef' oson yparxei kodikos ergou
31031>>>  If (iCheckDeop) Begin
31033>>>      Clear btnordd
31034>>>      Move asClientID   to btnordd.vclient_id
31035>>>      Move asCNCode     to btnordd.vcn_code
31036>>>      Move asWitemxCode to btnordd.vitem
31037>>>      Move 0            to btnordd.vactive
31038>>>      Move adHmnia      to btnordd.arxh_date
31039>>>      Find LE btnordd by index.4//client_id+cn_code+item+arxh_date
31040>>>>
31040>>>      If ((found=1) and (asWitemxCode=btnordd.vitem)    and (adHmnia>=btnordd.arxh_date) ;                    and (adHmnia<=btnordd.deop_date)    and (btnordd.vactive=0)          ;                    and (asCNCode=btnordd.vcn_code)) begin
31042>>>          move btnordd.vprice to nPoso
31043>>>          If (nPoso) Function_Return nPoso
31046>>>      End
31046>>>>
31046>>>  End
31046>>>>
31046>>>  // 19-03-2007 Tolhs na pernei times mono an brei apo deop
31046>>>  // 2.Anazhthsh sto arxeio Witemcld (Timokatalogos Pelath/Eidous)
31046>>> // Clear Witemcld
31046>>> // Move asItemCode to Witemcld.Item_Code
31046>>> // Move asClientID to Witemcld.Client_Code
31046>>> // Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
31046>>> // While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;
31046>>> //                      (Witemcld.Client_Code= asClientID) And ;
31046>>> //                      (iExodos=0))
31046>>> //     If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
31046>>> //         Move 1 to iExodos
31046>>> //              If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
31046>>> //         Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
31046>>> //     End
31046>>> //     Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
31046>>> // Loop
31046>>> // If (iExodos) Begin
31046>>> //     If (nPoso) Function_Return nPoso
31046>>> //     Else Function_Return nPct
31046>>> // End
31046>>>
31046>>>
31046>>>  // 3.Anazhthsh sto arxeio Witemxt (Timokatalogos Eidous)
31046>>>  //Clear Witemxt
31046>>>  //Move SysCurXr.Company_Code  to Witemxt.Company_Code
31046>>>  //Move SysCurXr.Branch_Code   to Witemxt.Branch_Code
31046>>>  //Move SysCurXr.Year_Year     to Witemxt.Year_Year
31046>>>  //Move asWitemxRecr           to Witemxt.Witemx_Recr
31046>>>  //Find Gt Witemxt By Index.1 // Witemxt:Index.1
31046>>>  //While ((Found=1) And (Witemxt.Company_Code = SysCurXr.Company_Code) And ;
31046>>>  //                     (Witemxt.Branch_Code  = SysCurXr.Branch_Code ) And ;
31046>>>  //                     (Witemxt.Year_Year    = SysCurXr.Year_Year   ) And ;
31046>>>  //                     (Witemxt.Witemx_Recr  = asWitemxRecr         ) And ;
31046>>>  //                     (iExodos=0))
31046>>>  //    If ((adHmnia>=Witemxt.Value_Date) And (anQty<=Witemxt.Qty)) Begin
31046>>>  //        Move 1 to iExodos
31046>>>  //             If (Witemxt.Axia0 <>0) Move  Witemxt.Axia0         to nPoso
31046>>>  //        Else If (Witemxt.PcDisc<>0) Move (Witemxt.PcDisc*(-1))  to nPct
31046>>>  //    End
31046>>>  //    Find Gt Witemxt By Index.1 // Witemxt:Index.1
31046>>>  //Loop
31046>>>  //If (iExodos) Begin
31046>>>  //    If (nPoso) Function_Return nPoso
31046>>>  //    Else Function_Return nPct
31046>>>  //End
31046>>>
31046>>>
31046>>>  // 4.Anazhthsh sto arxeio Witemcl (Teleytaia Timh Agoras)
31046>>>  //Clear WitemCL
31046>>>  //Move (Trim(asClientID)) to WitemCL.Client_Code
31046>>>  //Move (Trim(asItemCode)) to WitemCL.Item_Code
31046>>>  //Find Eq WitemCL By Index.1
31046>>>  //If (Found=1) Function_Return WitemCL.Client_Price
31046>>>
31046>>>  Function_Return 0
31047>>>End_Function
31048>>>
31048>>>Function fsStripTextFieldFromEnter Global String asStr Returns String
31049>>>    String sEnter
31050>>>    Move '' to sEnter
31051>>>    Move (Trim(asStr)) to asStr
31052>>>    Append sEnter (Character(13)) (Character(10))
31054>>>    Move (Replaces(sEnter,asStr,' ')) to asStr
31055>>>    Function_return (Trim(asStr))
31056>>>End_function
31057>>>
31057>>>
31057>>>//end   of global functions and procedures
31057>>>Use Wait.DG
INCLUDING FILE: WAIT.DG
31057>>>>>USE AllEntSc
31057>>>>>
31057>>>>>//AB-IgnoreEnd
31057>>>>>
31057>>>>>
31057>>>>>//AB-IgnoreEnd
31057>>>>>
31057>>>>>Object Wait is a ModalPanelSub
31059>>>>>
31059>>>>>    //AB-StoreTopStart
31059>>>>>
31059>>>>>    // How to Use It
31059>>>>>    // Get the maximum position of the bar
31059>>>>>    // Move (Bar_Maximum_position(Wait(self))) to iMax
31059>>>>>    //
31059>>>>>    // Set the maximum position of the bar
31059>>>>>    // Set Bar_Maximum_position of (Wait(self)) to iMax
31059>>>>>    //
31059>>>>>    // Start Bar Progress from beginning
31059>>>>>    // Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
31059>>>>>    //
31059>>>>>    // End Bar Progress
31059>>>>>    // Send Bar_Current_Position to (Wait(Self)) iMax iMax iMax False
31059>>>>>    //
31059>>>>>    // Update Bar Progress
31059>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax True OR
31059>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax False
31059>>>>>    // When you want the update to be done for every i (this is slower)
31059>>>>>    // Where i=Counter's current value, icounter=Counter's Max Value and iMax=Bar Max Position
31059>>>>>    //
31059>>>>>    // Display Buttons on the object
31059>>>>>    // Set Button_State of (Wait(Self)) to False/True
31059>>>>>    // If the Progress Bar gets initialized without buttons, it MUST be Deactivated
31059>>>>>    //
31059>>>>>    // Initialization of the Progress Bar
31059>>>>>    // Send Popup to (Wait(Self))
31059>>>>>    //
31059>>>>>    // Deactivation of the Progress Bar
31059>>>>>    // Send Deactivate to (Wait(Self))
31059>>>>>    //
31059>>>>>    // Message during the process
31059>>>>>    // Set Wait_Message of (Wait(Self)) to "Now Processing..."
31059>>>>>    //
31059>>>>>    // Extra Info for button "Info >>"
31059>>>>>    // Send Wait_Details to (Wait(Self)) sFile sDetail bInitData
31059>>>>>    // If sFile<>'' then reads the contents of the file
31059>>>>>    // Else Fills the Edit with the string of sDetail
31059>>>>>    // If bInitData is True then the edit object is cleared first else extra info is appended
31059>>>>>    //
31059>>>>>    // Remarks instead of Progress Bar
31059>>>>>    // Set Button_State of (Wait(Self))     to False
31059>>>>>    // Set BarVisibleState of (Wait(Self))  to 'Remarks' False
31059>>>>>    // Update During Process
31059>>>>>    // Send UpdateWait to (Wait(Self)) 'Remarks'
31059>>>>>
31059>>>>>    //AB-StoreTopEnd
31059>>>>>
31059>>>>>    Set Exit_Application_Local_State to FALSE
31060>>>>>    Set Modal_State to FALSE
31061>>>>>    Set Popup_State to TRUE
31062>>>>>    Set Border_Style to Border_Thick
31063>>>>>    Set Minimize_Icon to FALSE
31064>>>>>    Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
31065>>>>>    Set Size to 138 256
31066>>>>>
31066>>>>>    //AB-DDOStart
31066>>>>>
31066>>>>>
31066>>>>>    //AB-DDOEnd
31066>>>>>
31066>>>>>    Object WaitBar is a ProgressBarSub
31068>>>>>
31068>>>>>        //AB-StoreTopStart
31068>>>>>
31068>>>>>        //AB-StoreTopEnd
31068>>>>>
31068>>>>>        Set Size to 21 243
31069>>>>>        Set Location to 7 4
31070>>>>>
31070>>>>>        //AB-StoreStart
31070>>>>>        Send DoRegSize  self smTopRight
31071>>>>>        //AB-StoreEnd
31071>>>>>
31071>>>>>    End_Object
31072>>>>>
31072>>>>>    Object WaitText is a TextBoxSub
31074>>>>>
31074>>>>>        //AB-StoreTopStart
31074>>>>>
31074>>>>>        //AB-StoreTopEnd
31074>>>>>
31074>>>>>        Set Enabled_State to TRUE
31075>>>>>        Set Label to "Processing"
31076>>>>>        Set FontSize to 4 0
31077>>>>>        Set Size to 10 81
31078>>>>>        Set Location to 36 5
31079>>>>>
31079>>>>>        //AB-StoreStart
31079>>>>>
31079>>>>>        //AB-StoreEnd
31079>>>>>
31079>>>>>    End_Object
31080>>>>>
31080>>>>>    Object bnCancel is a ButtonSub
31082>>>>>
31082>>>>>        //AB-StoreTopStart
31082>>>>>
31082>>>>>        //AB-StoreTopEnd
31082>>>>>
31082>>>>>        Set Default_State to TRUE
31083>>>>>        Set Label to "OK"
31084>>>>>        Set Location to 34 143
31085>>>>>
31085>>>>>        //AB-StoreStart
31085>>>>>
31085>>>>>        Procedure OnClick
31087>>>>>             Send Deactivate to (Wait(Self))
31088>>>>>        End_Procedure
31089>>>>>
31089>>>>>        Send DoRegAlign self amTopRight
31090>>>>>        //AB-StoreEnd
31090>>>>>
31090>>>>>    End_Object
31091>>>>>
31091>>>>>    Object bnDetail is a ButtonSub
31093>>>>>
31093>>>>>        //AB-StoreTopStart
31093>>>>>
31093>>>>>        //AB-StoreTopEnd
31093>>>>>
31093>>>>>        Set Focus_Mode to Pointer_Only
31094>>>>>        Set Label to "Info >>"
31095>>>>>        Set Location to 34 197
31096>>>>>
31096>>>>>        //AB-StoreStart
31096>>>>>
31096>>>>>        Procedure OnClick
31098>>>>>            Delegate Send Show_Details False
31100>>>>>        End_Procedure
31101>>>>>
31101>>>>>        Send DoRegAlign self amTopRight
31102>>>>>        //AB-StoreEnd
31102>>>>>
31102>>>>>    End_Object
31103>>>>>
31103>>>>>    Object LineControlSub1 is a LineControlSub
31105>>>>>
31105>>>>>        //AB-StoreTopStart
31105>>>>>
31105>>>>>        //AB-StoreTopEnd
31105>>>>>
31105>>>>>        Set Size to 2 243
31106>>>>>        Set Location to 54 4
31107>>>>>
31107>>>>>        //AB-StoreStart
31107>>>>>
31107>>>>>        Send DoRegSize  self smTopRight
31108>>>>>        //AB-StoreEnd
31108>>>>>
31108>>>>>    End_Object
31109>>>>>
31109>>>>>    Object WaitEdit is a editSub
31111>>>>>
31111>>>>>        //AB-StoreTopStart
31111>>>>>
31111>>>>>        //AB-StoreTopEnd
31111>>>>>
31111>>>>>        Set Enabled_State to FALSE
31112>>>>>        Set Read_Only_State to TRUE
31113>>>>>        Set Size to 58 243
31114>>>>>        Set Location to 60 4
31115>>>>>        Set Color to clWhite
31116>>>>>
31116>>>>>        //AB-StoreStart
31116>>>>>
31116>>>>>        Send DoRegSize Self amBottomRight
31117>>>>>        Delegate Set Size to 66 256
31119>>>>>
31119>>>>>        //AB-StoreEnd
31119>>>>>
31119>>>>>    End_Object
31120>>>>>
31120>>>>>    Object oTxtAntiBar is a TextBoxSub
31122>>>>>        Set Enabled_State to TRUE
31123>>>>>        Set Visible_State to FALSE
31124>>>>>        Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
31125>>>>>        Set Justification_Mode to (jMode_Center IOR jMode_VCenter)
31126>>>>>        Set Auto_Size_State to FALSE
31127>>>>>        Set FontWeight to 600
31128>>>>>        Set FontSize to 4 0
31129>>>>>        Set Size to 10 209
31130>>>>>        Set Location to 10 4
31131>>>>>        Set TextColor to clNavy
31132>>>>>    End_Object
31133>>>>>
31133>>>>>
31133>>>>>    //AB-StoreStart
31133>>>>>    Property Integer piWaitSize  Public (Size(Self))
31135>>>>>    Property Integer piPrevSize  Public (Size(Self))
31137>>>>>    Property Integer piState     Public False
31139>>>>>
31139>>>>>    Set Locate_Mode to Center_On_Screen
31140>>>>>    Set Destroy_Object_State to True
31141>>>>>
31141>>>>>    Procedure Show_Details Integer bAlways
31143>>>>>        Local Integer liOriSize liSize hiSize hiOriSize lowSize bState
31144>>>>>        Local String sLabel
31144>>>>>        Get Size                to liSize
31145>>>>>        Get piState             to bState
31146>>>>>        Get piWaitSize          to liOriSize
31147>>>>>        Move (Hi(liSize))       to hiSize
31148>>>>>        Move (Low(liSize))      to lowSize
31149>>>>>        Move (Hi(liOriSize))    to hiOriSize
31150>>>>>        If (bAlways) Begin
31152>>>>>            Set piState         to False
31153>>>>>            Move 0              to bState
31154>>>>>        End
31154>>>>>>
31154>>>>>        If bState Begin
31156>>>>>             Set Size to hiOriSize lowSize
31157>>>>>             Set Label of (bnDetail(Self)) to "Info >>"
31158>>>>>        End
31158>>>>>>
31158>>>>>        Else Begin
31159>>>>>             Set Size to 138 lowSize
31160>>>>>             Set Label of (bnDetail(Self)) to "<< Info"
31161>>>>>        End
31161>>>>>>
31161>>>>>        Set piState to (1-bState)
31162>>>>>    End_Procedure
31163>>>>>
31163>>>>>    Procedure Bar_Current_Position Integer iCount Integer iOccurances Integer iMaximum Integer bState
31165>>>>>       If (bState) Begin
31167>>>>>         If (Mod(iCount,(iCount*((Number(iMaximum))/(Number(iOccurances)))))=0) ;            Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
31170>>>>>       End
31170>>>>>>
31170>>>>>       Else Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
31172>>>>>    End_Procedure
31173>>>>>
31173>>>>>    Procedure DoInitialize_WaitBar
31175>>>>>        Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
31176>>>>>    End_Procedure
31177>>>>>
31177>>>>>    Procedure DoTerminate_WaitBar
31179>>>>>        Local Integer iMax
31180>>>>>        Get Maximum_position of (WaitBar(Self)) to iMax
31181>>>>>        Send Bar_Current_Position to (Wait(Self)) iMax iMax Imax False
31182>>>>>    End_Procedure
31183>>>>>
31183>>>>>    Procedure Set Bar_Maximum_Position Integer iMaximum
31185>>>>>         Set Maximum_position of (WaitBar(Self)) to iMaximum
31186>>>>>    End_Procedure
31187>>>>>
31187>>>>>    Function Bar_Maximum_Position Returns Integer
31189>>>>>        Function_Return (Maximum_position(WaitBar(Self)))
31190>>>>>    End_Function
31191>>>>>
31191>>>>>    Procedure Set Bar_Minimum_Position Integer iMinimum
31193>>>>>         Set Minimum_position of (WaitBar(Self)) to iMinimum
31194>>>>>    End_Procedure
31195>>>>>
31195>>>>>    Function Bar_Minimum_Position Returns Integer
31197>>>>>        Function_Return (Minimum_position(WaitBar(Self)))
31198>>>>>    End_Function
31199>>>>>
31199>>>>>    Procedure Set Bar_Step_Value Integer iStep
31201>>>>>         Set Step_Value of (WaitBar(Self)) to iStep
31202>>>>>    End_Procedure
31203>>>>>
31203>>>>>    Function Bar_Step_Value Returns Integer
31205>>>>>        Function_Return (Step_Value(WaitBar(Self)))
31206>>>>>    End_Function
31207>>>>>
31207>>>>>    Procedure Set Wait_Message String sMessage
31209>>>>>        Set Value of (WaitText(Self)) to sMessage
31210>>>>>    End_Procedure
31211>>>>>
31211>>>>>    Procedure Wait_Details String sFile String sDetail Integer bInitData
31213>>>>>        Local Integer liEditId
31214>>>>>        Move (WaitEdit(Self)) to liEditId
31215>>>>>        If bInitData Send Delete_Data to liEditId
31218>>>>>        If sFile ne "" Begin
31220>>>>>           Send Read to liEditId sFile
31221>>>>>           Send Beginning_Of_Data to liEditId
31222>>>>>        End
31222>>>>>>
31222>>>>>        Else Begin
31223>>>>>           Send Insert to liEditId sDetail
31224>>>>>        End
31224>>>>>>
31224>>>>>    End_Procedure
31225>>>>>
31225>>>>>    Procedure OnResize
31227>>>>>        Local Integer liSize liHiSize liPrevSize liHiPrevSize bState liHiLoc liLoc
31228>>>>>        Get Size to liPrevSize
31229>>>>>        Move (Hi(liPrevSize)) to liHiPrevSize
31230>>>>>        Forward Send OnResize
31232>>>>>        Get Location of (WaitEdit(Self)) to liLoc
31233>>>>>        Move (Hi(liLoc)) to liHiLoc
31234>>>>>        Get piState to bState
31235>>>>>        Get Size to liSize
31236>>>>>        Move (Hi(liSize)) to liHiSize
31237>>>>>        If (liHiSize > (liHiLoc +30)) Begin
31239>>>>>            Set Value of (bnDetail(Self)) to "<< Info"
31240>>>>>            If (liHiPrevSize <= (liHiLoc +30)) Set piState to (1-bState)
31243>>>>>        End
31243>>>>>>
31243>>>>>        Else Begin
31244>>>>>            Set Value of (bnDetail(Self)) to "Info >>"
31245>>>>>            If (liHiPrevSize > (liHiLoc +30)) Set piState to (1-bState)
31248>>>>>        End
31248>>>>>>
31248>>>>>    End_Procedure
31249>>>>>
31249>>>>>    Procedure Set Button_State Integer bState
31251>>>>>        If bState Begin
31253>>>>>            Set Caption_Bar to True
31254>>>>>            Set Size to 66 256
31255>>>>>        End
31255>>>>>>
31255>>>>>        Else Begin
31256>>>>>            Set Caption_Bar to False
31257>>>>>            Set Size to 38 256
31258>>>>>        End
31258>>>>>>
31258>>>>>    End_Procedure
31259>>>>>
31259>>>>>    Procedure Set BarVisibleState String sMsg Integer bState
31261>>>>>        Set Visible_State of (oTxtAntiBar(Self)) to (bState = 0)
31262>>>>>        Set Visible_State of (WaitBar(Self))     to (bState = 1)
31263>>>>>        If (bState = 0) Begin
31265>>>>>            Set Size to 24 256
31266>>>>>            Set Location of (oTxtAntiBar(Self)) to 6 5
31267>>>>>        End
31267>>>>>>
31267>>>>>        If sMsg ne "" Set Value of (oTxtAntiBar(Self)) to sMsg
31270>>>>>    End_Procedure
31271>>>>>
31271>>>>>    Procedure Deactivating integer search_mode Returns Integer
31273>>>>>        local integer rval
31274>>>>>        Forward Get MSG_Deactivating search_mode to rval
31276>>>>>        Set Modal_State of (Wait(Self)) to False
31277>>>>>        Set BarVisibleState of (Wait(Self)) to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..." True
31278>>>>>        Procedure_Return rval
31279>>>>>    End_Procedure
31280>>>>>
31280>>>>>    Procedure UpdateWait String sMsg
31282>>>>>        Set Value of (oTxtAntiBar(Self)) to sMsg
31283>>>>>    End_Procedure
31284>>>>>
31284>>>>>
31284>>>>>    Procedure Set Horizontal_Justification Integer aiMode
31286>>>>>        Set Justification_Mode of oTxtAntiBar to (jMode_VCenter IOR aiMode)
31287>>>>>    End_Procedure
31288>>>>>
31288>>>>>
31288>>>>>
31288>>>>>
31288>>>>>
31288>>>>>
31288>>>>>    //AB-StoreEnd
31288>>>>>
31288>>>>>End_Object
31289>>>>>
31289>>>>>
31289>>>>>//AB-StoreStart
31289>>>>>
31289>>>>>//AB-StoreEnd
31289>>>>>
31289>>>>>//AB/ End_Object    // prj
31289>>>
31289>Use Calendar.sl
INCLUDING FILE: CALENDAR.SL
31289>>>//AB/ Project Calendar
31289>>>//AB/ Object prj is a Lookup_Project
31289>>>//AB/     Set ProjectName to "Calendar"
31289>>>//AB/     Set ProjectFileName to "Calendar.sl"
31289>>>
31289>>>// Project Object Structure
31289>>>//   oCalendar is a dbModalPanel
31289>>>//     Container3d1 is a Container3d
31289>>>//       Grid2 is a Grid
31289>>>//       Textbox2 is a Textbox
31289>>>//       Textbox3 is a Textbox
31289>>>//       Textbox4 is a Textbox
31289>>>//       Textbox5 is a Textbox
31289>>>//       Textbox6 is a Textbox
31289>>>//       Textbox7 is a Textbox
31289>>>//       Textbox8 is a Textbox
31289>>>//       LineControl1 is a LineControl
31289>>>//       Container3d2 is a Container3d
31289>>>//         oRght is a BitmapContainer
31289>>>//         oLeft is a BitmapContainer
31289>>>//         oMonth is a Textbox
31289>>>//           oSelectMonth is a FloatingPopupMenu
31289>>>//         oYear is a Textbox
31289>>>//         oSelectYear is a Form
31289>>>//     BitmapContainer3 is a BitmapContainer
31289>>>//     oToday is a Textbox
31289>>>
31289>>>// Register all objects
31289>>>Register_Object BitmapContainer3
31289>>>Register_Object Container3d1
31289>>>Register_Object Container3d2
31289>>>Register_Object Grid2
31289>>>Register_Object LineControl1
31289>>>Register_Object oCalendar
31289>>>Register_Object oLeft
31289>>>Register_Object oMonth
31289>>>Register_Object oRght
31289>>>Register_Object oSelectMonth
31289>>>Register_Object oSelectYear
31289>>>Register_Object oToday
31289>>>Register_Object oYear
31289>>>Register_Object Textbox2
31289>>>Register_Object Textbox3
31289>>>Register_Object Textbox4
31289>>>Register_Object Textbox5
31289>>>Register_Object Textbox6
31289>>>Register_Object Textbox7
31289>>>Register_Object Textbox8
31289>>>
31289>>>
31289>>>
31289>>>//AB-StoreTopStart
31289>>>Use dates.utl
INCLUDING FILE: DATES.UTL
31289>>>>>// **********************************************************************
31289>>>>>// Use Dates.utl    // Date manipulation for VDF and DF3.1
31289>>>>>//
31289>>>>>// by Sture Andersen (sa1@vd.dk)
31289>>>>>//
31289>>>>>// The file contains a number of global functions for manipulating
31289>>>>>// dates. The package may be used with DataFlex 3.1 and Visual DataFlex.
31289>>>>>// This package is public domain.
31289>>>>>//
31289>>>>>// The package file is accompanied by a Word document (dfutil.doc)
31289>>>>>// listing the functions and their use.
31289>>>>>//
31289>>>>>//
31289>>>>>// Create: Fri  06-06-1997 - Merger of s_utl020, 021, 022, 023, 024, 025.
31289>>>>>// Update: Thu  26-06-1997 - Fixes for strange behavior when date4_state is set.
31289>>>>>//                         - Addition of popup_calendar to VDF.
31289>>>>>//         Sun  29-06-1997 - Character mode popup calender.
31289>>>>>//         Fri  04-07-1997 - Function WeekToDate added.
31289>>>>>//         Thu  10-07-1997 - Fixes.
31289>>>>>//         Mon  11-08-1997 - WeekToDate fixed.
31289>>>>>//         Sun  24-08-1997 - Character mode popup calender finished.
31289>>>>>//         Mon  15-12-1997 - Procedure Request_Popup_Calendar added.
31289>>>>>//         Mon  29-12-1997 - Procedures ItemYear2to4, ItemDate2to4 and
31289>>>>>//                           ItemSysdate added.
31289>>>>>//         Mon  29-12-1997 - Procedures FieldYear2to4, FieldDate2to4 and
31289>>>>>//                           FieldSysdate added.
31289>>>>>//         Sun  01-02-1998 - Functions Module_Compile_Date and
31289>>>>>//                           Module_Compile_Time added.
31289>>>>>//         Wed  25-02-1998 - Request_Popup in calendar object now only
31289>>>>>//                           responds if entry_state of the calling object
31289>>>>>//                           is true (VDF version). (No apparent effect)
31289>>>>>//         Sat  28-03-1998 - Added the following functions:
31289>>>>>//                             TS_SysTime      TS_ExtractDate
31289>>>>>//                             TS_ExtractTime  TS_ConvertToString
31289>>>>>//         Tue  26-05-1998 - Procedure TS_UI_Update added
31289>>>>>//         Sat  01-08-1998 - mask_date_window taken into account
31289>>>>>//         Mon  10-08-1998 - Functions Module_Start_Date and
31289>>>>>//                           Module_Start_Time added.
31289>>>>>//         Wed  02-09-1998 - Parameter for Module_Start_Date removed
31289>>>>>//         Mon  12-10-1998 - Portuguese added
31289>>>>>//         Wed  04-11-1998 - TS_TimeEstimator class added
31289>>>>>//         Tue  29-12-1998 - Function DateAsString added
31289>>>>>//         Wed  13-01-1999 - Function DateWeekNumber changed according to
31289>>>>>//                           Kjetil Johanson
31289>>>>>//         Mon  18-01-1999 - Function DateWeekNumber changed according to
31289>>>>>//                           Kjetil Johanson (again)
31289>>>>>//         Tue  19-01-1999 - Changed procedure names in TS_TimeEstimator
31289>>>>>//                           class (Continue->TS_Continue and Pause->
31289>>>>>//                           TS_Pause)
31289>>>>>//         Thu  21-01-1999 - Procedures DateFormatAsString and DateFormatName
31289>>>>>//                           added.
31289>>>>>//                         - Procedures DateCurrentSeparator and
31289>>>>>//                           DateCurrentFormat added.
31289>>>>>//         Tue  13-04-1999 - Julian constants added: Jan1st1900, Jan1st2000
31289>>>>>//                           Jan1st1000 and Jan1st100
31289>>>>>//         Mon  26-04-1999 - Changed procedure FieldYear2to4 and ItemYear2to4
31289>>>>>//                           to trap 3 digit years.
31289>>>>>//         Wed  27-04-1999 - Changed Dutch abbriviated day names (to 2 characters)
31289>>>>>//         Sun  02-05-1999 - Added function TS_Compose2
31289>>>>>//                         - Fixed error in TS_ConvertToString
31289>>>>>//         Tue  01-06-1999 - Added procedure popup_no_export to calendar.
31289>>>>>//         Thu  15-06-1999 - Fixed Date4to2 function and exporting dates
31289>>>>>//                           from the calendar to forms with no form_margin.
31289>>>>>//         Tue  07-09-1999 - Added function DateAsText
31289>>>>>//         Wed  27-10-1999 - Temporary fix for Module_Compile_Date function
31289>>>>>//                           in combination with y2k.
31289>>>>>//         Wed  19-12-1999 - Function StringToDate added.
31289>>>>>//                         - Existing function DateAsString renamed to
31289>>>>>//                           DateToString.
31289>>>>>//         Mon  03-01-2000 - Fix for VDF4. Popup calendar on empty date field
31289>>>>>//                           would result in seeding the calendar on year 100.
31289>>>>>//                           This error was caused by the fact that VDF 4
31289>>>>>//                           ignores SYSDATE4_STATE such that the sysdate
31289>>>>>//                           command returns 03-01-100
31289>>>>>//         Wed  01-02-2000 - Define instead of #REPLACE
31289>>>>>//         Wed  23-08-2000 - Function TS_Module_Compile_Time added
31289>>>>>//
31289>>>>>// NOTE:  There is language dependent string constants in this file.
31289>>>>>//        Currently there are sections for dutch, english, danish, swedish,
31289>>>>>//        norwegian, spanish, german and portuguese
31289>>>>>//
31289>>>>>//        These sections may be identified by searching the symbol LNG_DEFAULT
31289>>>>>//
31289>>>>>// ***********************************************************************
31289>>>>>
31289>>>>>Use ui
31289>>>>>Use Language    // Set default languange if not set by compiler command line
INCLUDING FILE: LANGUAGE.PKG
31289>>>>>>>// Use Language     // Default language setup
31289>>>>>>>// Sets default languange if not set by compiler command line
31289>>>>>>>
31289>>>>>>>define lng_dutch      for 131
31289>>>>>>>define lng_french     for 133 // NOT TRANSLATED. DO NOT SELECT!
31289>>>>>>>define lng_spanish    for 134
31289>>>>>>>define lng_italian    for 139 // NOT TRANSLATED. DO NOT SELECT!
31289>>>>>>>define lng_english    for 144
31289>>>>>>>define lng_danish     for 145
31289>>>>>>>define lng_swedish    for 146
31289>>>>>>>define lng_norwegian  for 147
31289>>>>>>>define lng_Greek    for 148
31289>>>>>>>define lng_german     for 149
31289>>>>>>>define lng_portuguese for 155
31289>>>>>>>define lng_papiamentu for 199 // NOT TRANSLATED. DO NOT SELECT!
31289>>>>>>>
31289>>>>>>>
31289>>>>>>>define lng_default for !@
31289>>>>>>>
31289>>>>>>>  define _LANGUAGE_ for $ENGLISH$
31289>>>>>>>
#REM LANGUAGE SET BY LANGUAGE.PKG: $ENGLISH$
31289>>>>>Use Seq_Chnl    // Defines global sequential device management operations (DAC)
31289>>>>>Use Macros.utl  // Various macros (DESKTOP_SECTION)
INCLUDING FILE: MACROS.UTL
31289>>>>>>>// Use Macros.utl   // Various macros (FOR_EX...)
31289>>>>>>>
31289>>>>>>>//  FOR_EX (extended FOR command)
31289>>>>>>>//  -----------------------------
31289>>>>>>>//> The FOR_EX command is exactly like the standard FOR command except
31289>>>>>>>//> that it will allow you to use keyword "DOWN_TO" instead of "TO" if
31289>>>>>>>//> you need to do a decremental loop.
31289>>>>>>>
31289>>>>>>>
31289>>>>>>>//  DESKTOP_SECTION
31289>>>>>>>//  ---------------
31289>>>>>>>//> The DESKTOP_SECTION/END_DESKTOP_SECTION commands will make a sequence of
31289>>>>>>>//> code compile (or rather instantiate) as if it was situated on the DESKTOP
31289>>>>>>>//> even when it isn't. DESKTOP_SECTION's may not be nested.
31289>>>>>>>
31289>>>>>>>
31289>>>>>>>
31289>>>>>
31289>>>>>// Switches
31289>>>>>
31289>>>>>define DATES_INCLUDE_POPUP for 1   // If set to 0 the popup calendar will not be included
31289>>>>>define DATES_DF31B_EPOCH   for 40  // DF3.1b didn't have an epoch setting. Therefore this symbol defines the epoch value for that version.
31289>>>>>
31289>>>>> define t.calendar.year           for "Year"
31289>>>>> define t.calendar.month          for "Month"
31289>>>>> define t.calendar.day            for "Day"
31289>>>>> define t.calendar.week           for "Wk."
31289>>>>> define t.calendar.calendar_popup for "Calendar Popup"
31289>>>>> define t.calendar.Monday         for "Monday"
31289>>>>> define t.calendar.Tuesday        for "Tuesday"
31289>>>>> define t.calendar.Wednesday      for "Wednesday"
31289>>>>> define t.calendar.Thursday       for "Thursday"
31289>>>>> define t.calendar.Friday         for "Friday"
31289>>>>> define t.calendar.Saturday       for "Saturday"
31289>>>>> define t.calendar.Sunday         for "Sunday"
31289>>>>> define t.calendar.January        for "January"
31289>>>>> define t.calendar.February       for "February"
31289>>>>> define t.calendar.March          for "March"
31289>>>>> define t.calendar.April          for "April"
31289>>>>> define t.calendar.May            for "May"
31289>>>>> define t.calendar.June           for "June"
31289>>>>> define t.calendar.July           for "July"
31289>>>>> define t.calendar.August         for "August"
31289>>>>> define t.calendar.September      for "September"
31289>>>>> define t.calendar.October        for "October"
31289>>>>> define t.calendar.November       for "November"
31289>>>>> define t.calendar.December       for "December"
31289>>>>> define t.calendar.ok             for "OK"
31289>>>>> define t.calendar.Cancel         for "Cancel"
31289>>>>> define t.calendar.Activate       for "Activate popup calendar (Ctrl+D)"
31289>>>>>
31289>>>>>define LargestPossibleDate for 913490 // December 31st 2500
31289>>>>>define Jan1st1900          for 693975
31289>>>>>define Jan1st2000          for 730500
31289>>>>>define Jan1st1000          for 365250
31289>>>>>define Jan1st105           for 38352
31289>>>>>define Jan1st100           for 36525
31289>>>>>
31289>>>>>enumeration_list // Date Segments
31289>>>>>  define DS_DAY
31289>>>>>  define DS_WEEK
31289>>>>>  define DS_MONTH
31289>>>>>  define DS_YEAR
31289>>>>>end_enumeration_list
31289>>>>>
31289>>>>>integer Dates$Year Dates$Month Dates$Day // internal use
31289>>>>>
31289>>>>>procedure DateDecompose global date date# //very internal!!
31290>>>>>  local integer pos1# pos2# format#
31291>>>>>  local string str# sep#
31291>>>>>  get_attribute DF_DATE_FORMAT to format#
31294>>>>>  get_attribute DF_DATE_SEPARATOR to pos1# // overload
31297>>>>>  character pos1# to sep#                  // end overload
31298>>>>>>
31298>>>>>  move date# to str#
31299>>>>>  replace sep# in str# with "$"
31301>>>>>  move strmark to pos1#
31302>>>>>  if [found] begin
31304>>>>>    replace sep# in str# with "$"
31306>>>>>    move strmark to pos2#
31307>>>>>  end
31307>>>>>>
31307>>>>>  else begin
31308>>>>>    move 0 to Dates$Year
31309>>>>>    move 0 to Dates$Month
31310>>>>>    move 0 to Dates$Day
31311>>>>>  end
31311>>>>>>
31311>>>>>  [ found] begin
31313>>>>>>
31313>>>>>    if format# eq DF_DATE_EUROPEAN ;          left str# to Dates$Day    (pos1#-1)
31317>>>>>    if format# eq DF_DATE_USA begin
31319>>>>>          mid  str# to Dates$Day    (pos2#-pos1#-1) (pos1#+1)
31322>>>>>>
31322>>>>>          left str# to Dates$Month  (pos1#-1)
31324>>>>>>
31324>>>>>    end
31324>>>>>>
31324>>>>>    else  mid  str# to Dates$Month  (pos2#-pos1#-1) (pos1#+1)
31328>>>>>
31328>>>>>    if format# eq DF_DATE_MILITARY begin
31330>>>>>          mid  str# to Dates$Day  2 (pos2#+1)
31333>>>>>>
31333>>>>>          left str# to Dates$Year   (pos1#-1)
31335>>>>>>
31335>>>>>    end
31335>>>>>>
31335>>>>>    else  mid  str# to Dates$Year 4 (pos2#+1)
31339>>>>>  end
31339>>>>>>
31339>>>>>end_procedure
31340>>>>>
31340>>>>>function DateCompose global integer day# integer month# integer year# returns date
31341>>>>>  local integer format#
31342>>>>>  local date date#
31342>>>>>  local string sep#
31342>>>>>  ifnot (day#*month#*year#) function_return 0
31345>>>>>  get_attribute DF_DATE_SEPARATOR to format# // overload
31348>>>>>  character format# to sep#                  // end overload
31349>>>>>>
31349>>>>>  get_attribute DF_DATE_FORMAT to format#
31352>>>>>  if day# gt 28 begin
31354>>>>>    if format# eq DF_DATE_EUROPEAN move (date(string(day#)+sep#+string(month#)+sep#+string(year#))) to date# // DMY
31357>>>>>    if format# eq DF_DATE_USA      move (date(string(month#)+sep#+string(day#)+sep#+string(year#))) to date# // MDY
31360>>>>>    if format# eq DF_DATE_MILITARY move (date(string(year#)+sep#+string(month#)+sep#+string(day#))) to date# // YMD
31363>>>>>    send DateDecompose date#
31364>>>>>    if Dates$Month ne month# move (day#-Dates$Day) to day#
31367>>>>>  end
31367>>>>>>
31367>>>>>  if format# eq DF_DATE_EUROPEAN function_return (date(string(day#)+sep#+string(month#)+sep#+string(year#))) // DMY
31370>>>>>  if format# eq DF_DATE_USA function_return (date(string(month#)+sep#+string(day#)+sep#+string(year#))) // MDY
31373>>>>>  function_return (date(string(year#)+sep#+string(month#)+sep#+string(day#))) // YMD
31374>>>>>end_function
31375>>>>>
31375>>>>>function DateFormatName global integer format# returns string
31376>>>>>  if format# eq DF_DATE_EUROPEAN function_return "European"
31379>>>>>  if format# eq DF_DATE_USA      function_return "United States"
31382>>>>>  if format# eq DF_DATE_MILITARY function_return "Military"
31385>>>>>end_function
31386>>>>>
31386>>>>>function DateCurrentSeparator global returns string
31387>>>>>  local integer rval#
31388>>>>>  get_attribute DF_DATE_SEPARATOR to rval#
31391>>>>>  function_return (character(rval#))
31392>>>>>end_function
31393>>>>>
31393>>>>>function DateCurrentFormat global returns integer
31394>>>>>  local integer rval#
31395>>>>>  get_attribute DF_DATE_FORMAT to rval#
31398>>>>>  function_return rval#
31399>>>>>end_function
31400>>>>>
31400>>>>>function DateFormatAsString global integer format# integer long# string sep# returns string
31401>>>>>  local string rval# letter#
31402>>>>>  if format# eq DF_DATE_EUROPEAN move "3342241111" to rval#
31405>>>>>  if format# eq DF_DATE_USA      move "2243341111" to rval#
31408>>>>>  if format# eq DF_DATE_MILITARY move "1111422433" to rval#
31411>>>>>  left t.calendar.year to letter# 1
31413>>>>>>
31413>>>>>  replace "1" in rval# with letter#
31415>>>>>  replace "1" in rval# with letter#
31417>>>>>  ifnot long# move "" to letter#
31420>>>>>  move (replaces("1",rval#,letter#)) to rval#
31421>>>>>  move (replaces("2",rval#,left(t.calendar.month,1))) to rval#
31422>>>>>  move (replaces("3",rval#,left(t.calendar.day,1))) to rval#
31423>>>>>  if sep# eq "" begin
31425>>>>>    get_attribute DF_DATE_SEPARATOR to format#
31428>>>>>    character format# to sep#
31429>>>>>>
31429>>>>>  end
31429>>>>>>
31429>>>>>  move (replaces("4",rval#,sep#)) to rval#
31430>>>>>  function_return rval#
31431>>>>>end_function
31432>>>>>
31432>>>>>function StringToDate global string date# integer format# integer four_digit_year# string sep# returns date
31433>>>>>  local integer sep_len# day# month# year#
31434>>>>>  move (length(sep#)) to sep_len#
31435>>>>>  if four_digit_year# move 4 to four_digit_year#
31438>>>>>  else move 2 to four_digit_year#
31440>>>>>  if format# eq DF_DATE_EUROPEAN begin // DMY
31442>>>>>    move (mid(date#,2,1)) to day#
31443>>>>>    move (mid(date#,2,3+sep_len#)) to month#
31444>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31445>>>>>  end
31445>>>>>>
31445>>>>>  if format# eq DF_DATE_USA begin // MDY
31447>>>>>    move (mid(date#,2,1)) to month#
31448>>>>>    move (mid(date#,2,3+sep_len#)) to year#
31449>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31450>>>>>  end
31450>>>>>>
31450>>>>>  if format# eq DF_DATE_MILITARY begin // YMD
31452>>>>>    move (mid(date#,four_digit_year#,1)) to year#
31453>>>>>    move (mid(date#,2,1+four_digit_year#+sep_len#)) to month#
31454>>>>>    move (mid(date#,2,3+four_digit_year#+sep_len#+sep_len#)) to day#
31455>>>>>  end
31455>>>>>>
31455>>>>>  function_return (DateCompose(day#,month#,year#))
31456>>>>>end_function
31457>>>>>
31457>>>>>function DateToString global date date# integer format# integer four_digit_year# string sep# returns string
31458>>>>>  local string rval# day# month# year#
31459>>>>>  get Date2to4 date# to date#
31460>>>>>  if (integer(date#)) begin
31462>>>>>    send DateDecompose date#
31463>>>>>    move Dates$Day to day#
31464>>>>>    if Dates$Day lt 10 insert "0" in day# at 1
31468>>>>>    move Dates$Month to month#
31469>>>>>    if Dates$Month lt 10 insert "0" in month# at 1
31473>>>>>    move Dates$Year to year#
31474>>>>>    ifnot four_digit_year# move (right(year#,2)) to year#
31477>>>>>    if format# eq DF_DATE_EUROPEAN move (day#+sep#+month#+sep#+year#) to rval# // DMY
31480>>>>>    if format# eq DF_DATE_USA      move (month#+sep#+day#+sep#+year#) to rval# // MDY
31483>>>>>    if format# eq DF_DATE_MILITARY move (year#+sep#+month#+sep#+day#) to rval# // YMD
31486>>>>>  end
31486>>>>>>
31486>>>>>  function_return rval#
31487>>>>>end_function
31488>>>>>
31488>>>>>// Function DateAsString is only here for compatibility with earlier versions.
31488>>>>>// Use function DateToString instead.
31488>>>>>function DateAsString global date date# integer format# integer four_digit_year# string sep# returns string
31489>>>>>  function_return (DateToString(date#,format#,four_digit_year#,sep#))
31490>>>>>end_function
31491>>>>>
31491>>>>>function DateIncrement global date date# integer segment# integer amount# returns date
31492>>>>>  if (date#=0) function_return 0
31495>>>>>  if segment# eq DS_WEEK function_return (date#+(amount#*7)) //weeks
31498>>>>>  if (segment#<>DS_DAY) begin // months or years
31500>>>>>    send DateDecompose date#
31501>>>>>    if segment# eq DS_MONTH begin //months
31503>>>>>      move (Dates$Month+amount#) to Dates$Month
31504>>>>>      if amount# ge 0 function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-1)/12)*12),Dates$Year+((Dates$Month-1)/12)))
31507>>>>>      function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-12)/12)*12),Dates$Year+((Dates$Month-12)/12)))
31508>>>>>    end //years:
31508>>>>>>
31508>>>>>    if segment# eq DS_YEAR function_return (DateCompose(Dates$Day,Dates$Month,Dates$Year+amount#))
31511>>>>>  end
31511>>>>>>
31511>>>>>  else function_return (date#+amount#) //days
31513>>>>>end_function
31514>>>>>
31514>>>>>function DateSegment global date date# integer segment# returns integer
31515>>>>>  send DateDecompose date#
31516>>>>>  if segment# eq DS_DAY   function_return Dates$Day
31519>>>>>  if segment# eq DS_MONTH function_return Dates$Month
31522>>>>>  if segment# eq DS_YEAR  function_return Dates$Year
31525>>>>>end_function
31526>>>>>
31526>>>>>function DateToInteger global date date# returns integer
31527>>>>>  send DateDecompose date#
31528>>>>>  function_return (Dates$Year*100+Dates$Month*100+Dates$Day)
31529>>>>>end_function
31530>>>>>
31530>>>>>function FirstDayInMonth global date date# returns date
31531>>>>>  local integer month# year#
31532>>>>>  move (DateSegment(date#,DS_MONTH)) to month#
31533>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31534>>>>>  function_return (DateCompose(1,month#,year#))
31535>>>>>end_function
31536>>>>>
31536>>>>>function LastDayInMonth global date date# returns date
31537>>>>>  move (DateIncrement(date#,DS_MONTH,1)) to date#
31538>>>>>  function_return (FirstDayInMonth(date#)-1)
31539>>>>>end_function
31540>>>>>
31540>>>>>function FirstDayInYear global date date# returns date
31541>>>>>  local integer year#
31542>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31543>>>>>  function_return (DateCompose(1,1,year#))
31544>>>>>end_function
31545>>>>>
31545>>>>>function LastDayInYear global date date# returns date
31546>>>>>  move (DateIncrement(date#,DS_YEAR,1)) to date#
31547>>>>>  function_return (FirstDayInYear(date#)-1)
31548>>>>>end_function
31549>>>>>
31549>>>>>// Prior to 18/1-99 version of DateWeekNumber
31549>>>>>//function DateWeekNumber global date date# returns integer
31549>>>>>//  local integer week# first_wd# day_of_year# year#
31549>>>>>//  if (date#=0) function_return 0
31549>>>>>//  get Date2to4 date# to date#
31549>>>>>//  move (DateSegment(date#,DS_YEAR)) to year#
31549>>>>>//  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31549>>>>>//  move (date#-FirstDayInYear(date#)) to day_of_year#
31549>>>>>//  move (day_of_year#-1-7+first_wd#) to day_of_year#
31549>>>>>//  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31549>>>>>//  else move 0 to week#
31549>>>>>//  if first_wd# le 4 increment week#
31549>>>>>//  if week# gt 52 begin
31549>>>>>//    move 1 to week#
31549>>>>>//    if first_wd# eq 4 move 53 to week#
31549>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31549>>>>>//  end
31549>>>>>//  if week# eq 0 begin
31549>>>>>//    //get DateWeekNumber (DateIncrement(date#,DS_YEAR,-1)) to first_wd# // Original line
31549>>>>>//    get DateDayNumber  (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#ÿ // changed line
31549>>>>>//    move 52 to week#
31549>>>>>//    if first_wd# eq 4 move 53 to week#
31549>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31549>>>>>//  end
31549>>>>>//  function_return week#
31549>>>>>//end_function
31549>>>>>
31549>>>>>function DateWeekNumber global date date# returns integer
31550>>>>>  local integer week# first_wd# day_of_year# year# wd#
31551>>>>>  if (date#=0) function_return 0
31554>>>>>  get Date2to4 date# to date#
31555>>>>>  // Leap-year test for actual or previous year
31555>>>>>  // Year# only used for selection between 52 and
31555>>>>>  // Therefore get year# from the first day of actual week
31555>>>>>  get DateDayNumber date# to wd#
31556>>>>>  move (DateSegment(date#-wd#+1,DS_YEAR)) to year#
31557>>>>>
31557>>>>>  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31558>>>>>  move (date#-FirstDayInYear(date#)) to day_of_year#
31559>>>>>  move (day_of_year#-1-7+first_wd#) to day_of_year#
31560>>>>>  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31563>>>>>  else move 0 to week#
31565>>>>>  if first_wd# le 4 increment week#
31568>>>>>  if week# gt 52 begin
31570>>>>>    move 1 to week#
31571>>>>>    if first_wd# eq 4 move 53 to week#
31574>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31581>>>>>  end
31581>>>>>>
31581>>>>>  if week# eq 0 begin
31583>>>>>    // Week 52 or 53
31583>>>>>    get DateDayNumber (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#
31584>>>>>    move 52 to week#
31585>>>>>    if first_wd# eq 4 move 53 to week#
31588>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31595>>>>>  end
31595>>>>>>
31595>>>>>  function_return week#
31596>>>>>end_function
31597>>>>>
31597>>>>>function DayName global integer int# returns string
31598>>>>>  if int# eq 1 function_return t.calendar.Monday
31601>>>>>  if int# eq 2 function_return t.calendar.Tuesday
31604>>>>>  if int# eq 3 function_return t.calendar.Wednesday
31607>>>>>  if int# eq 4 function_return t.calendar.Thursday
31610>>>>>  if int# eq 5 function_return t.calendar.Friday
31613>>>>>  if int# eq 6 function_return t.calendar.Saturday
31616>>>>>  if int# eq 7 function_return t.calendar.Sunday
31619>>>>>  function_return ""
31620>>>>>end_function
31621>>>>>
31621>>>>>function DateDayNumber global date date# returns integer
31622>>>>>  local integer rval# // 1=Monday, ... , 7=Sunday
31623>>>>>  get Date2to4 date# to date#
31624>>>>>  move date# to rval#
31625>>>>>  if rval# begin
31627>>>>>    if rval# gt 693975 move (rval#-2) to rval#
31630>>>>>    move (rval#-((rval#/7)*7)) to rval#
31631>>>>>    if rval# eq 0 move 7 to rval#
31634>>>>>  end
31634>>>>>>
31634>>>>>  function_return rval#
31635>>>>>end_function
31636>>>>>
31636>>>>>function DateDayName global date date# returns string
31637>>>>>  function_return (DayName(DateDayNumber(date#)))
31638>>>>>end_function
31639>>>>>
31639>>>>>function YearMaxWeek global integer year# returns integer
31640>>>>>  local integer wk1# wk2#
31641>>>>>  get DateWeekNumber (DateCompose(31,12,year#)) to wk1#
31642>>>>>  get DateWeekNumber (DateCompose(24,12,year#)) to wk2#
31643>>>>>  function_return (wk1# max wk2#)
31644>>>>>end_function
31645>>>>>
31645>>>>>function WeekToDate global integer year# integer week# returns date
31646>>>>>  local date date#
31647>>>>>  move (DateCompose(1,1,year#)) to date#
31648>>>>>  if (DateWeekNumber(date#)) ne 1 move (date#+7) to date# // week 52 or 53
31651>>>>>  move (date#-DateDayNumber(date#)+1) to date# // Now it's a Monday
31652>>>>>  function_return (week#-1*7+date#)
31653>>>>>end_function
31654>>>>>
31654>>>>>function MonthName global integer int# returns string
31655>>>>>  if int# eq  1 function_return t.calendar.January
31658>>>>>  if int# eq  2 function_return t.calendar.February
31661>>>>>  if int# eq  3 function_return t.calendar.March
31664>>>>>  if int# eq  4 function_return t.calendar.April
31667>>>>>  if int# eq  5 function_return t.calendar.May
31670>>>>>  if int# eq  6 function_return t.calendar.June
31673>>>>>  if int# eq  7 function_return t.calendar.July
31676>>>>>  if int# eq  8 function_return t.calendar.August
31679>>>>>  if int# eq  9 function_return t.calendar.September
31682>>>>>  if int# eq 10 function_return t.calendar.October
31685>>>>>  if int# eq 11 function_return t.calendar.November
31688>>>>>  if int# eq 12 function_return t.calendar.December
31691>>>>>  function_return ""
31692>>>>>end_function
31693>>>>>
31693>>>>>function DateMonthName global date date# returns string
31694>>>>>  function_return (MonthName(DateSegment(date#,DS_MONTH)))
31695>>>>>end_function
31696>>>>>
31696>>>>>function DateAsText global date date# string format# returns string
31697>>>>>  if date# eq 0 function_return ""
31700>>>>>  move (replace("#DN",format#,DateDayName(date#)))                  to format#
31701>>>>>  move (replace("#MN",format#,DateMonthName(date#)))                to format#
31702>>>>>  move (replace("#D" ,format#,string(DateSegment(date#,DS_DAY))))   to format#
31703>>>>>  move (replace("#Y" ,format#,string(DateSegment(date#,DS_YEAR))))  to format#
31704>>>>>  move (replace("#M" ,format#,string(DateSegment(date#,DS_MONTH)))) to format#
31705>>>>>  function_return format#
31706>>>>>end_function
31707>>>>>
31707>>>>>function Year2to4 global integer year# returns integer
31708>>>>>  local integer epoch_value#
31709>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31710>>>>>  if year# lt 100 begin
31712>>>>>    if year# gt epoch_value# function_return (year#+1900)
31715>>>>>    function_return (year#+2000)
31716>>>>>  end
31716>>>>>>
31716>>>>>  function_return year# // No conversion done!
31717>>>>>end_function
31718>>>>>
31718>>>>>function Date2to4 global date date# returns date
31719>>>>>  local integer epoch_value#
31720>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31721>>>>>  if date# gt 0 begin // Only if there is a date to convert
31723>>>>>    if (DateSegment(date#,DS_YEAR)) lt 105 begin
31725>>>>>      if Dates$Year gt epoch_value# function_return (DateIncrement(date#,DS_YEAR,1900))
31728>>>>>      function_return (DateIncrement(date#,DS_YEAR,2000))
31729>>>>>    end
31729>>>>>>
31729>>>>>    function_return date# // No conversion done!
31730>>>>>  end
31730>>>>>>
31730>>>>>end_function
31731>>>>>
31731>>>>>function Date4to2 global date date# returns date
31732>>>>>  local integer epoch_value# year#
31733>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31734>>>>>  if date# gt 0 begin // Only if there is a date to convert
31736>>>>>    move (DateSegment(date#,DS_YEAR)) to year#
31737>>>>>    if year# ge 100 begin // Only then conversion is needed!
31739>>>>>      if (year#>=(1900+epoch_value#) and year#<(2000+epoch_value#)) begin
31741>>>>>        if year# lt 2000 function_return (DateIncrement(date#,DS_YEAR,-1900))
31744>>>>>        else             function_return (DateIncrement(date#,DS_YEAR,-2000))
31746>>>>>      end
31746>>>>>>
31746>>>>>      else error 301 "Date is out of epoch range"
31748>>>>>    end
31748>>>>>>
31748>>>>>  end
31748>>>>>>
31748>>>>>  function_return date# // No conversion done!
31749>>>>>end_function
31750>>>>>
31750>>>>>function dSysDate global returns date
31751>>>>>  local date date#
31752>>>>>  sysdate4 date#
31753>>>>>  function_return date#
31754>>>>>end_function
31755>>>>>
31755>>>>>function iSysYear global returns integer
31756>>>>>  local date date#
31757>>>>>  sysdate4 date#
31758>>>>>  function_return (DateSegment(date#,DS_YEAR))
31759>>>>>end_function
31760>>>>>
31760>>>>>procedure ItemSysdate for desktop integer itm#
31761>>>>>  local date date#
31762>>>>>  get value item itm# to date#
31763>>>>>  if date# eq 0 begin
31765>>>>>    sysdate4 date#
31766>>>>>    set changed_value item itm# to date#
31767>>>>>  end
31767>>>>>>
31767>>>>>end_procedure
31768>>>>>
31768>>>>>procedure ItemDate2to4 for desktop integer itm#
31769>>>>>  local integer year#
31770>>>>>  local date date# new_date#
31770>>>>>  get value item itm# to date#
31771>>>>>
31771>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31772>>>>>  if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31775>>>>>  else move date# to new_date#
31777>>>>>
31777>>>>>  move (Date2to4(new_date#)) to new_date#
31778>>>>>  move (DateSegment(new_date#,3)) to year#
31779>>>>>  if (year#>99 and year#<1000) begin
31781>>>>>    error 15 // Illegal entry in this window
31782>>>>>>
31782>>>>>    procedure_return 1
31783>>>>>  end
31783>>>>>>
31783>>>>>  if new_date# ne date# set value item itm# to new_date#
31786>>>>>end_procedure
31787>>>>>
31787>>>>>procedure ItemYear2to4 for desktop integer itm#
31788>>>>>  local integer year# new_year#
31789>>>>>  get value item itm# to year#
31790>>>>>  if (year#>99 and year#<1000) begin
31792>>>>>    error 15 // Illegal entry in this window
31793>>>>>>
31793>>>>>    procedure_return 1
31794>>>>>  end
31794>>>>>>
31794>>>>>  move (Year2to4(year#)) to new_year#
31795>>>>>  if new_year# ne year# set value item itm# to new_year#
31798>>>>>end_procedure
31799>>>>>
31799>>>>> procedure FieldSysdate for DataDictionary integer fld#
31800>>>>>   local date date#
31801>>>>>   get field_current_value fld# to date#
31802>>>>>   if date# eq 0 begin
31804>>>>>     sysdate4 date#
31805>>>>>     set field_changed_value fld# to date#
31806>>>>>   end
31806>>>>>>
31806>>>>> end_procedure
31807>>>>>
31807>>>>> procedure FieldDate2to4 for DataDictionary integer fld#
31808>>>>>   local integer year#
31809>>>>>   local date date# new_date#
31809>>>>>   get field_current_value fld# to date#
31810>>>>>
31810>>>>>   move (DateSegment(date#,DS_YEAR)) to year#
31811>>>>>   if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31814>>>>>   else move date# to new_date#
31816>>>>>
31816>>>>>   move (Date2to4(new_date#)) to new_date#
31817>>>>>   move (DateSegment(new_date#,3)) to year#
31818>>>>>   if (year#>99 and year# <=999) begin
31820>>>>>     error 15 // Illegal entry in this window
31821>>>>>>
31821>>>>>     procedure_return 1
31822>>>>>   end
31822>>>>>>
31822>>>>>   if new_date# ne date# set field_changed_value fld# to new_date#
31825>>>>> end_procedure
31826>>>>>
31826>>>>> procedure FieldYear2to4 for DataDictionary integer fld#
31827>>>>>   local integer year# new_year# changed#
31828>>>>>   get field_current_value fld# to year#
31829>>>>>   get field_changed_state fld# to changed#
31830>>>>>   if changed# begin
31832>>>>>     if (year#>99 and year#<1000) begin
31834>>>>>       error 15 // Illegal entry in this window
31835>>>>>>
31835>>>>>       procedure_return 1
31836>>>>>     end
31836>>>>>>
31836>>>>>     move (Year2to4(year#)) to new_year#
31837>>>>>     if new_year# ne year# set field_changed_value fld# to new_year#
31840>>>>>   end
31840>>>>>>
31840>>>>> end_procedure
31841>>>>>
31841>>>>> function SysDate global returns date
31842>>>>>   function_return (dSysDate())
31843>>>>> end_function
31844>>>>>
31844>>>>>function sSysTime global returns string
31845>>>>>  local integer h# m# s#
31846>>>>>  sysdate4 h# h# m# s#
31850>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31851>>>>>end_function
31852>>>>>
31852>>>>>function TS_SysTime global returns number
31853>>>>>  local integer d# h# m# s#
31854>>>>>  sysdate4 d# h# m# s#
31858>>>>>  function_return (d#*24.0+h#*60+m#*60+s#)
31859>>>>>end_function
31860>>>>>
31860>>>>>//> This function returns a TS value composed from the date and time
31860>>>>>//> passed to it. Note that the time variable must be of the format
31860>>>>>//> "hh:mm:ss".
31860>>>>>function TS_Compose global date date# string time# returns number
31861>>>>>  local integer h# m# s#
31862>>>>>  left time# to h# 2
31864>>>>>>
31864>>>>>  mid time# to m# 2 4
31867>>>>>>
31867>>>>>  mid time# to s# 2 7
31870>>>>>>
31870>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31871>>>>>end_function
31872>>>>>
31872>>>>>function TS_Compose2 global date date# integer h# integer m# integer s# returns number
31873>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31874>>>>>end_function
31875>>>>>
31875>>>>>function TS_ExtractDate global number time# returns date
31876>>>>>  function_return (time#/86400) // 86400=24*60*60
31877>>>>>end_function
31878>>>>>
31878>>>>>function TS_ExtractTime global number time# returns string
31879>>>>>  local integer h# m# s#
31880>>>>>  move (time#-(86400.0*integer(TS_ExtractDate(time#)))) to s#
31881>>>>>  move (s#/3600) to h#
31882>>>>>  move (s#-(h#*3600)) to s#
31883>>>>>  move (s#/60) to m#
31884>>>>>  move (s#-(m#*60)) to s#
31885>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31886>>>>>end_function
31887>>>>>
31887>>>>>function TS_ConvertToString global number time# returns string
31888>>>>>  local date d#
31889>>>>>  move (TS_ExtractDate(time#)) to d#
31890>>>>>  if (integer(d#)) function_return (string(d#)+" "+TS_ExtractTime(time#))
31893>>>>>  else function_return (TS_ExtractTime(time#))
31895>>>>>end_function
31896>>>>>
31896>>>>>function TS_ConvertToStringNoDate global number ts# returns string
31897>>>>>  local integer h# m#
31898>>>>>  move (ts#/3600) to h#
31899>>>>>  move (ts#-(h#*3600)) to ts#
31900>>>>>  move (ts#/60) to m#
31901>>>>>  move (ts#-(m#*60)) to ts#
31902>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(ts#<10,"0","")+string(ts#))
31903>>>>>end_function
31904>>>>>
31904>>>>>// This procedure is used when a TS-variable must be displayed on screen.
31904>>>>>procedure TS_UI_Update global number TS# integer obj1# integer itm1# integer tmp_obj2# integer tmp_itm2#
31905>>>>>  local integer obj2# itm2#
31906>>>>>  if num_arguments gt 3 begin
31908>>>>>    move tmp_obj2# to obj2#
31909>>>>>    move tmp_itm2# to itm2#
31910>>>>>  end
31910>>>>>>
31910>>>>>  else begin
31911>>>>>    move obj1# to obj2#
31912>>>>>    move (itm1#+1) to itm2#
31913>>>>>  end
31913>>>>>>
31913>>>>>  set value of obj1# item itm1# to (TS_ExtractDate(TS#))
31914>>>>>  set value of obj2# item itm2# to (TS_ExtractTime(TS#))
31915>>>>>end_procedure
31916>>>>>
31916>>>>>class TS_TimeEstimator is an array
31917>>>>>  procedure construct_object
31918>>>>>    forward send construct_object
31920>>>>>    set delegation_mode to delegate_to_parent
31921>>>>>    property number  pnTotal   public 0 // Seconds needed to run the loop.
31922>>>>>    property number  pnElapsed public 0 // Seconds elapsed so far.
31923>>>>>    property number  pnLeft    public 0 // Number of seconds left
31924>>>>>    property number  pnStart   public 0
31925>>>>>    property number  pnPause   public 0
31926>>>>>    property number  pnPercent public 0
31927>>>>>    property integer piMin     public 0
31928>>>>>    property integer piMax     public 0
31929>>>>>  end_procedure
31930>>>>>
31930>>>>>  procedure TS_Start integer min# integer max#
31931>>>>>    set piMin to min#
31932>>>>>    set piMax to max#
31933>>>>>    set pnStart to (TS_SysTime())
31934>>>>>    set pnElapsed to 0
31935>>>>>    set pnPercent to 0
31936>>>>>  end_procedure
31937>>>>>
31937>>>>>  procedure TS_Calculate integer pos#
31938>>>>>    local integer min# max#
31939>>>>>    get piMin to min#
31940>>>>>    get piMax to max#
31941>>>>>    set pnElapsed to (TS_SysTime()-pnStart(current_object))
31942>>>>>    set pnTotal   to (pnElapsed(current_object)*(max#-min#)/number(pos#-min#))
31943>>>>>    set pnLeft    to (pnTotal(current_object)-pnElapsed(current_object))
31944>>>>>    set pnPercent to (100.0*(pos#-min#)/(max#-min#))
31945>>>>>  end_procedure
31946>>>>>
31946>>>>>  procedure TS_Pause
31947>>>>>    set pnPause to (TS_SysTime())
31948>>>>>  end_procedure
31949>>>>>
31949>>>>>  procedure TS_Continue
31950>>>>>    set pnStart to (pnStart(current_object)+TS_SysTime()-pnPause(current_object))
31951>>>>>  end_procedure
31952>>>>>end_class
31953>>>>>
31953>>>>>function TS_Module_Compile_Time global string path# returns number
31954>>>>>  local integer pos# day# month# year# seqeof# ch#
31955>>>>>  local string date# str# time#
31955>>>>>  move path# to str#
31956>>>>>  if str# ne "" begin
31958>>>>>    get Seq_New_Channel to ch#   // This method and Seq_Release_Channel are
31959>>>>>    send Seq_Release_Channel ch# // We only need it for a second
31960>>>>>      direct_input channel ch# (trim(str#)+".vd6") // VDF 6
31962>>>>>      [seqeof] direct_input channel ch# (trim(str#)+".vd5") // VDF 5
31964>>>>>    [ seqeof] move 1 to seqeof#
31965>>>>>    [~seqeof] move 0 to seqeof#
31966>>>>>    [~seqeof] readln str#
31967>>>>>    close_input channel ch#
31969>>>>>  end
31969>>>>>>
31969>>>>>  if seqeof# function_return 0
31972>>>>>  pos "," in str# to pos#
31974>>>>>>
31974>>>>>  move (mid(str#,18,pos#+2)) to str#
31975>>>>>  move (integer(mid(str#,2,4))) to day#
31976>>>>>  move (integer(mid(str#,2,1))) to month#
31977>>>>>  move (integer(mid(str#,2,7))) to year#
31978>>>>>  if year# eq 10 begin
31980>>>>>    move (integer(mid(str#,3,7))+1900) to year#
31981>>>>>    move (mid(str#,8,11)) to str#
31982>>>>>  end
31982>>>>>>
31982>>>>>  else move (mid(str#,8,10)) to str#
31984>>>>>  move (DateCompose(day#,month#,year#)) to date#
31985>>>>>  move (Date2to4(date#)) to date#
31986>>>>>  pos ":" in str# to pos#
31988>>>>>>
31988>>>>>  function_return (TS_Compose(date#,mid(str#,8,pos#-2)))
31989>>>>>end_function
31990>>>>>
31990>>>>>string Dates$Module_Compile_Time
31990>>>>>move "" to Dates$Module_Compile_Time
31991>>>>>
31991>>>>>function Module_Compile_Date global returns date
31992>>>>>  local number ts#
31993>>>>>  local string str#
31993>>>>>  get module_name to str# // 'module_name' is most likely the name of the .flx file.
31994>>>>>  get TS_Module_Compile_Time str# to ts#
31995>>>>>  move (TS_ExtractTime(ts#)) to Dates$Module_Compile_Time
31996>>>>>  function_return (TS_ExtractDate(ts#))
31997>>>>>end_function
31998>>>>>
31998>>>>>function Module_Compile_Time global returns string
31999>>>>>  local date grb#
32000>>>>>  // Module_Compile_Date must be called before this one!
32000>>>>>  if Dates$Module_Compile_Time eq "" move (Module_Compile_Date()) to grb#
32003>>>>>  function_return Dates$Module_Compile_Time
32004>>>>>end_function
32005>>>>>
32005>>>>>date   Dates$ModuleStartDate
32005>>>>>string Dates$ModuleStartTime 8
32005>>>>>move (dSysDate()) to Dates$ModuleStartDate
32006>>>>>move (sSysTime()) to Dates$ModuleStartTime
32007>>>>>
32007>>>>>function Module_Start_Date global returns date
32008>>>>>  function_return Dates$ModuleStartDate
32009>>>>>end_function
32010>>>>>
32010>>>>>function Module_Start_Time global returns string
32011>>>>>  function_return Dates$ModuleStartTime
32012>>>>>end_function
32013>>>>>
32013>>>>> register_procedure NotifyPopupCalendarChange date date#
32013>>>>> register_procedure NotifyPopupCalendarSelect date date#
32013>>>>>  use dfAllent
32013>>>>>  class calendar.textbox is a textbox
32014>>>>>    procedure construct_object
32015>>>>>      forward send construct_object
32017>>>>>      Set Auto_Size_State To False
32018>>>>>      Set Justification_Mode To (jMode_vCenter+jMode_Center)
32019>>>>>    end_procedure
32020>>>>>  end_class
32021>>>>>
32021>>>>>  register_object btn1
32021>>>>>  register_object btn6
32021>>>>>
32021>>>>>  class calendar.button is a button
32022>>>>>
32022>>>>>    procedure construct_object
32023>>>>>      forward send construct_object
32025>>>>>      set size to 15 18
32026>>>>>      on_key kleftarrow   send prev_day
32027>>>>>      on_key krightarrow  send next_day
32028>>>>>      on_key kuparrow     send prev_week
32029>>>>>      on_key kdownarrow   send next_week
32030>>>>>      property date p_assigned_date public 0
32031>>>>>    end_procedure
32032>>>>>
32032>>>>>    procedure switch // This makes all 42 buttons act as if they are one focus
32033>>>>>      send activate to (btn1(current_object))
32034>>>>>    end_procedure
32035>>>>>    procedure switch_back
32036>>>>>      send activate to (btn6(current_object))
32037>>>>>    end_procedure
32038>>>>>
32038>>>>>    procedure mouse_down
32039>>>>>      local integer current_object#
32040>>>>>      forward send mouse_down
32042>>>>>      move current_object to current_object#
32043>>>>>      delegate set p_current_date to (p_assigned_date(current_object#))
32045>>>>>    end_procedure
32046>>>>>  end_class
32047>>>>>
32047>>>>>  desktop_section
32053>>>>>    object popup_calendar is a ModalPanel
32055>>>>>      set size to 160 250
32056>>>>>      property date    p_current_date  public 0
32058>>>>>      property integer p_current_year  public -1
32060>>>>>      property integer p_current_month public -1
32062>>>>>      property integer pExportState    public 1
32064>>>>>
32064>>>>>      on_key key_ctrl+key_pgup send prev_year
32065>>>>>      on_key key_ctrl+key_pgdn send next_year
32066>>>>>      on_key          key_pgup send prev_month
32067>>>>>      on_key          key_pgdn send next_month
32068>>>>>      on_key key_ctrl+key_d    send go_today
32069>>>>>      on_key kcancel           send cancel
32070>>>>>
32070>>>>>      object cont3d is a container3d
32072>>>>>        set location to 5 5
32073>>>>>        set size to 120 237
32074>>>>>        object textbox_year is a calendar.textbox
32076>>>>>          set location to 5 5
32077>>>>>          set size to 15 30
32078>>>>>          set border_style to border_staticedge
32079>>>>>          procedure display
32081>>>>>            set value to (p_current_year(current_object))
32082>>>>>          end_procedure
32083>>>>>        end_object
32084>>>>>        object dayname_header is a container3d
32086>>>>>          set location to 5 39
32087>>>>>          set size to 15 126
32088>>>>>          set border_style to border_staticedge
32089>>>>>          procedure initialize
32091>>>>>            local integer itm#
32092>>>>>            for itm# from 0 to 6
32098>>>>>>
32098>>>>>              object txt is a calendar.textbox
32100>>>>>                set size to 12 17
32101>>>>>                set location to 0 (itm#*17.6+1)
32102>>>>>                 set value to (left(DayName(itm#+1),3))
32103>>>>>              end_object
32104>>>>>            loop
32105>>>>>>
32105>>>>>          end_procedure
32106>>>>>          send initialize
32107>>>>>        end_object
32108>>>>>        object weeknumber_header is a container3d
32110>>>>>          set location to 24 5
32111>>>>>          set size     to 89 30
32112>>>>>          set border_style to border_staticedge
32113>>>>>          object obj_id_array is an array
32115>>>>>          end_object
32116>>>>>          procedure initialize
32118>>>>>            local integer itm# obj#
32119>>>>>            move (obj_id_array(current_object)) to obj#
32120>>>>>            for itm# from 0 to 5
32126>>>>>>
32126>>>>>              object txt is a textbox
32128>>>>>                set size to 15 30
32129>>>>>                set location to (itm#*15+1) 1
32130>>>>>                set value of obj# item (item_count(obj#)) to current_object
32131>>>>>              end_object
32132>>>>>            loop
32133>>>>>>
32133>>>>>          end_procedure
32134>>>>>          procedure display
32136>>>>>            local integer itm# obj#
32137>>>>>            local date date# last_date#
32137>>>>>            move (obj_id_array(current_object)) to obj#
32138>>>>>            get p_current_date to date#
32139>>>>>            move (FirstDayInMonth(date#)) to date#
32140>>>>>            move (LastDayInMonth(date#)) to last_date#
32141>>>>>            move (date#-DateDayNumber(date#)+1) to date#
32142>>>>>            for itm# from 0 to 5
32148>>>>>>
32148>>>>>              if (itm#*7+date#) le last_date# ;                set value of (integer(value(obj#,itm#))) to (t.calendar.week*string(DateWeekNumber(itm#*7+date#)))
32151>>>>>              else set value of (integer(value(obj#,itm#))) to ""
32153>>>>>            loop
32154>>>>>>
32154>>>>>          end_procedure
32155>>>>>          send initialize
32156>>>>>        end_object
32157>>>>>        object days_grid is a container3d
32159>>>>>          set location to 23 39
32160>>>>>          set size     to 100 127
32161>>>>>          set border_style to border_none
32162>>>>>          object btn_array is an array
32164>>>>>          end_object
32165>>>>>          procedure initialize
32167>>>>>            local integer row# col# button_array#
32168>>>>>            move (btn_array(current_object)) to button_array#
32169>>>>>            for row# from 0 to 5
32175>>>>>>
32175>>>>>              for col# from 0 to 6
32181>>>>>>
32181>>>>>                object btn is a calendar.button
32183>>>>>                  set location to (row#*15) (col#*18)
32184>>>>>                  set value of button_array# item (item_count(button_array#)) to current_object
32185>>>>>                  on_item "" send move_value_out_ok
32186>>>>>                end_object
32187>>>>>              loop
32188>>>>>>
32188>>>>>            loop
32189>>>>>>
32189>>>>>          end_procedure
32190>>>>>          send initialize
32191>>>>>
32191>>>>>          procedure display.iii integer itm# integer day# integer activate#
32193>>>>>            local integer obj# current_day#
32194>>>>>            move (integer(value(btn_array(current_object),itm#))) to obj#
32195>>>>>            move (DateSegment(p_current_date(current_object),DS_DAY)) to current_day#
32196>>>>>            if activate# begin
32198>>>>>              if day# eq current_day# send activate to obj#
32201>>>>>            end
32201>>>>>>
32201>>>>>            else begin
32202>>>>>              if day# begin
32204>>>>>                set value of obj# to day#
32205>>>>>                set visible_state of obj# to true
32206>>>>>                set p_assigned_date of obj# to (DateCompose(day#,p_current_month(current_object),p_current_year(current_object)))
32207>>>>>              end
32207>>>>>>
32207>>>>>              else set visible_state of obj# to false
32209>>>>>            end
32209>>>>>>
32209>>>>>          end_procedure
32210>>>>>
32210>>>>>          procedure display integer activate#
32212>>>>>            local integer first_item# last_item# itm# day# date#
32213>>>>>            get p_current_date to date#
32214>>>>>            move (FirstDayInMonth(date#)) to date#
32215>>>>>            move (DateDayNumber(date#)-1) to first_item#
32216>>>>>            move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32217>>>>>            ifnot activate# begin
32219>>>>>              for itm# from 0 to (first_item#-1)
32225>>>>>>
32225>>>>>                send display.iii itm# 0 0
32226>>>>>              loop
32227>>>>>>
32227>>>>>            end
32227>>>>>>
32227>>>>>            move 1 to day#
32228>>>>>            for itm# from first_item# to last_item#
32234>>>>>>
32234>>>>>              send display.iii itm# day# activate#
32235>>>>>              increment day#
32236>>>>>            loop
32237>>>>>>
32237>>>>>            ifnot activate# begin
32239>>>>>              for itm# from (last_item#+1) to 41
32245>>>>>>
32245>>>>>                send display.iii itm# 0 0
32246>>>>>              loop
32247>>>>>>
32247>>>>>            end
32247>>>>>>
32247>>>>>          end_procedure
32248>>>>>        end_object
32249>>>>>        object txt_month is a calendar.textbox
32251>>>>>          set size to 12 27
32252>>>>>          set location to 25 185
32253>>>>>          set value to t.calendar.month
32254>>>>>        end_object
32255>>>>>        object btn1 is a button
32257>>>>>          set size to 12 12
32258>>>>>          set location to 40 185
32259>>>>>          on_item "" send prev_month
32260>>>>>          set bitmap to "prev.bmp"
32261>>>>>          procedure switch_back
32263>>>>>            send display_main
32264>>>>>          end_procedure
32265>>>>>        end_object
32266>>>>>        object btn2 is a button
32268>>>>>          set size to 12 12
32269>>>>>          set location to 40 200
32270>>>>>          on_item "" send next_month
32271>>>>>          set bitmap to "next.bmp"
32272>>>>>        end_object
32273>>>>>        object txt_year is a calendar.textbox
32275>>>>>          set size to 12 27
32276>>>>>          set location to 70 185
32277>>>>>          set value to t.calendar.year
32278>>>>>        end_object
32279>>>>>        object btn3 is a button
32281>>>>>          set size to 12 12
32282>>>>>          set location to 85 185
32283>>>>>          on_item "" send prev_year
32284>>>>>          set bitmap to "prev.bmp"
32285>>>>>        end_object
32286>>>>>        object btn4 is a button
32288>>>>>          set size to 12 12
32289>>>>>          set location to 85 200
32290>>>>>          on_item "" send next_year
32291>>>>>          set bitmap to "next.bmp"
32292>>>>>        end_object
32293>>>>>      end_object
32294>>>>>      object btn5 is a button
32296>>>>>        set size to 14 60
32297>>>>>        set location to 129 115
32298>>>>>        on_item t.calendar.ok send move_value_out_ok
32299>>>>>      end_object
32300>>>>>      object btn6 is a button
32302>>>>>        set size to 14 60
32303>>>>>        set location to 129 182
32304>>>>>        on_item t.calendar.cancel send cancel
32305>>>>>        procedure switch
32307>>>>>          send display_main
32308>>>>>        end_procedure
32309>>>>>      end_object
32310>>>>>      procedure next_year
32312>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32313>>>>>        send display_main
32314>>>>>      end_procedure
32315>>>>>      procedure prev_year
32317>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32318>>>>>        send display_main
32319>>>>>      end_procedure
32320>>>>>      procedure next_month
32322>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32323>>>>>        send display_main
32324>>>>>      end_procedure
32325>>>>>      procedure prev_month
32327>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32328>>>>>        send display_main
32329>>>>>      end_procedure
32330>>>>>      procedure next_week
32332>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,1))
32333>>>>>        send display_main
32334>>>>>      end_procedure
32335>>>>>      procedure prev_week
32337>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,-1))
32338>>>>>        send display_main
32339>>>>>      end_procedure
32340>>>>>      procedure next_day
32342>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,1))
32343>>>>>        send display_main
32344>>>>>      end_procedure
32345>>>>>      procedure prev_day
32347>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,-1))
32348>>>>>        send display_main
32349>>>>>      end_procedure
32350>>>>>      procedure go_today
32352>>>>>        local date date#
32353>>>>>        sysdate4 date#
32354>>>>>        set p_current_date to date#
32355>>>>>        send display_main
32356>>>>>      end_procedure
32357>>>>>      property integer invoking_object_id public 0
32359>>>>>      procedure OnChange date date#
32361>>>>>        local integer focus# dm#
32362>>>>>        get invoking_object_id to focus#
32363>>>>>        if focus# gt desktop begin
32365>>>>>          get delegation_mode of focus# to dm#
32366>>>>>          set delegation_mode of focus# to no_delegate_or_error
32367>>>>>          send NotifyPopupCalendarChange to focus# date#
32368>>>>>          set delegation_mode of focus# to dm#
32369>>>>>        end
32369>>>>>>
32369>>>>>      end_procedure
32370>>>>>      procedure display
32372>>>>>        local integer date# month# year#
32373>>>>>        get p_current_date to date#
32374>>>>>        send OnChange date#
32375>>>>>        move (DateSegment(date#,DS_YEAR)) to year#
32376>>>>>        move (DateSegment(date#,DS_MONTH)) to month#
32377>>>>>        if (p_current_year(current_object)<>year# or p_current_month(current_object)<>month#) begin
32379>>>>>          set p_current_year to year#
32380>>>>>          set p_current_month to month#
32381>>>>>          set value to (t.calendar.calendar_popup+", "+MonthName(month#))
32382>>>>>          send display to (textbox_year(cont3d(current_object)))
32383>>>>>          send display to (weeknumber_header(cont3d(current_object)))
32384>>>>>          send display to (days_grid(cont3d(current_object))) 0
32385>>>>>        end
32385>>>>>>
32385>>>>>      end_procedure
32386>>>>>      procedure display_main
32388>>>>>        send display
32389>>>>>        send display to (days_grid(cont3d(current_object))) 1
32390>>>>>      end_procedure
32391>>>>>      procedure popup_no_export
32393>>>>>        set pExportState to false
32394>>>>>        send popup
32395>>>>>        set pExportState to true
32396>>>>>      end_procedure
32397>>>>>
32397>>>>>      procedure popup_group
32399>>>>>        local integer focus#
32400>>>>>        local date date#
32400>>>>>        move (focus(desktop)) to focus#
32401>>>>>        set invoking_object_id to focus#
32402>>>>>        get value of focus# item current to date#
32403>>>>>        ifnot (integer(date#)) move (dSysdate()) to date#
32406>>>>>        move (Date2to4(date#)) to date#
32407>>>>>        set p_current_date to date#
32408>>>>>        send display
32409>>>>>        forward send popup_group
32411>>>>>        send display to (days_grid(cont3d(current_object))) 1
32412>>>>>      end_procedure
32413>>>>>
32413>>>>>      procedure move_value_out
32415>>>>>        local integer focus# dm# margin# datatype#
32416>>>>>        if (pExportState(current_object)) begin
32418>>>>>          get invoking_object_id to focus#
32419>>>>>          if focus# gt desktop begin
32421>>>>>            get delegation_mode of focus# to dm#
32422>>>>>            set delegation_mode of focus# to no_delegate_or_error
32423>>>>>            send NotifyPopupCalendarSelect to focus# (p_current_date(current_object))
32424>>>>>            get form_margin of focus# item current to margin#
32425>>>>>            get form_datatype of focus# item current to datatype#
32426>>>>>            set delegation_mode of focus# to dm#
32427>>>>>            if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to (p_current_date(current_object))
32430>>>>>            else             set value of focus# item current to (Date4to2(p_current_date(current_object)))
32432>>>>>            set item_changed_state of focus# item current to true
32433>>>>>          end
32433>>>>>>
32433>>>>>        end
32433>>>>>>
32433>>>>>      end_procedure
32434>>>>>
32434>>>>>      procedure move_value_out_ok
32436>>>>>        send move_value_out
32437>>>>>        send deactivate
32438>>>>>      end_procedure
32439>>>>>
32439>>>>>      procedure request_popup
32441>>>>>        local integer focus# type# dm#
32442>>>>>        move (focus(desktop)) to focus#
32443>>>>>        if focus# gt desktop begin
32445>>>>>          get delegation_mode of focus# to dm#
32446>>>>>          set delegation_mode of focus# to no_delegate_or_error
32447>>>>>          get form_datatype of focus# item current to type#
32448>>>>>          if (type#=date_window or type#=mask_date_window) send popup
32451>>>>>          set delegation_mode of focus# to dm#
32452>>>>>        end
32452>>>>>>
32452>>>>>      end_procedure
32453>>>>>    end_object
32454>>>>>  end_desktop_section
32456>>>>>  // If the procedure below was not defined "for BaseClass" its symbolic
32456>>>>>  // substitute would become negative (because located on the desktop). This
32456>>>>>  // would result in the toolbar object not being able to handle it. Therefore:
32456>>>>>  procedure request_popup_calendar for BaseClass
32457>>>>>    send request_popup to (popup_calendar(current_object))
32458>>>>>  end_procedure
32459>>>>>  procedure popup_calendar_no_export
32460>>>>>    send popup_no_export to (popup_calendar(current_object))
32461>>>>>  end_procedure
32462>>>>>  register_procedure Add_Toolbar_Button_Bitmap string bmp# string Tip# string StHlp# integer msg# integer obj#
32462>>>>>  procedure Add_Calendar_tbButton integer oTb#
32463>>>>>    send Add_Toolbar_Button_Bitmap to oTb# "DfCalend.bmp" t.calendar.calendar_popup t.calendar.Activate msg_request_popup_calendar
32464>>>>>  end_procedure
32465>>>>> function s.calendar returns integer // Backwards compatible!!
32466>>>>>   function_return (popup_calendar(current_object))
32467>>>>> end_function
32468>>>>>
32468>>>>>// Karl,
32468>>>>>// Structure is as follows,
32468>>>>>//
32468>>>>>// //put this code in the top portion of the view code or in the program
32468>>>>>// code.
32468>>>>>//
32468>>>>>// Type SystemTime
32468>>>>>//   field SystemTime.iYear As Word
32468>>>>>//   field SystemTime.iMonth As Word
32468>>>>>//   field SystemTime.iDayOfWeek As Word
32468>>>>>//   field SystemTime.iDay As Word
32468>>>>>//   field SystemTime.iHour As Word
32468>>>>>//   field SystemTime.iMinute As Word
32468>>>>>//   field SystemTime.iSecond As Word
32468>>>>>//   field SystemTime.iMilliseconds As Word
32468>>>>>// End_Type
32468>>>>>//
32468>>>>>// external_function GetSystemTime "GetSystemTime" kernel32.dll Pointer lpGST Returns VOID_TYPE
32468>>>>>//
32468>>>>>// //put this code in an onClick or wherever
32468>>>>>// procedure onclick
32468>>>>>//   local integer iRetVal
32468>>>>>//   local string TimeData
32468>>>>>//   local pointer GST
32468>>>>>//
32468>>>>>//   ZeroType SystemTime to TimeData
32468>>>>>//   getAddress from TimeData to GST
32468>>>>>//
32468>>>>>//   move (GetSystemTime(GST)) to iRetVal
32468>>>>>// end_procedure
32468>>>>>//
32468>>>>>// To extract the data from the Structure after calling the function use
32468>>>>>// the getbuff command as follows:
32468>>>>>//
32468>>>>>// getbuff from TimeData as SystemTime.IVAL to var
32468>>>>>//
32468>>>>>// where IVAL is one of the vars such as iYear or iDay, etc.
32468>>>>>//
32468>>>>>// OLIVER NELSON
32468>>>>>//
32468>>>>>//
32468>>>
32468>>>//AB-StoreTopEnd
32468>>>
32468>>>//AB-IgnoreStart
32468>>>
32468>>>Use DFAllEnt.pkg
32468>>>
32468>>>
32468>>>//AB-IgnoreEnd
32468>>>
32468>>>CD_Popup_Object oCalendar is a dbModalPanel
32487>>>
32487>>>    //AB-StoreTopStart
32487>>>    on_key kcancel           send cancel
32488>>>    //AB-StoreTopEnd
32488>>>
32488>>>    Set Border_Style to Border_Normal
32489>>>    Set Caption_Bar to FALSE
32490>>>    Set Label to "Ÿ­¢ àì, 2001"
32491>>>    Set Size to 98 123
32492>>>    Set Location to 10 22
32493>>>    Set Color to clWhite
32494>>>
32494>>>    //AB-DDOStart
32494>>>
32494>>>
32494>>>    //AB-DDOEnd
32494>>>
32494>>>    Object Container3d1 is a Container3d
32496>>>        Set Size to 88 135
32497>>>        Set Location to -2 -1
32498>>>        Set Color to clWhite
32499>>>        Set Border_Style to Border_None
32500>>>        Object Grid2 is a Grid
32502>>>
32502>>>            //AB-StoreTopStart
32502>>>            property date    p_current_date     public 0
32504>>>            property integer p_current_year     public -1
32506>>>            property integer p_current_month    public -1
32508>>>            property integer p_selected_day     public -1
32510>>>            property integer pExportState       public 1
32512>>>            property integer invoking_object_id public 0
32514>>>            
32514>>>            Set Border_Style To BORDER_NONE
32515>>>            Set header_visible_state To False
32516>>>            set select_mode to no_select
32517>>>            Set Gridline_mode To GRID_VISIBLE_NONE
32518>>>            
32518>>>            on_key Key_F1 Send Help
32519>>>            on_key key_ctrl+key_pgup send prev_year
32520>>>            on_key key_ctrl+key_pgdn send next_year
32521>>>            on_key          key_pgup send prev_month
32522>>>            on_key          key_pgdn send next_month
32523>>>            on_key key_enter         send move_value_out
32524>>>            on_key key_ctrl+key_d    send go_today
32525>>>            
32525>>>            //AB-StoreTopEnd
32525>>>
32525>>>            Set Color to clWhite
32526>>>            Set CurrentCellColor to clWhite
32527>>>            Set CurrentCellTextColor to clWhite
32528>>>            Set Size to 61 145
32529>>>            Set Location to 30 1
32530>>>            Set Resize_Column_state to FALSE
32531>>>
32531>>>            Set Line_Width to 7 0
32532>>>
32532>>>            Set Form_Width    item 0 to 18
32533>>>            Set Header_Label  item 0 to "­"
32534>>>            
32534>>>            Set Form_Width    item 1 to 18
32535>>>            Set Header_Label  item 1 to "‚â"
32536>>>            
32536>>>            Set Form_Width    item 2 to 18
32537>>>            Set Header_Label  item 2 to "‘à"
32538>>>            
32538>>>            Set Form_Width    item 3 to 18
32539>>>            Set Header_Label  item 3 to "—â"
32540>>>            
32540>>>            Set Form_Width    item 4 to 18
32541>>>            Set Header_Label  item 4 to "â"
32542>>>            
32542>>>            Set Form_Width    item 5 to 18
32543>>>            Set Header_Label  item 5 to "‘¡"
32544>>>            
32544>>>            Set Form_Width    item 6 to 18
32545>>>            Set Header_Label  item 6 to "‚á"
32546>>>            
32546>>>
32546>>>            //AB-StoreStart
32546>>>            
32546>>>            procedure go_today
32548>>>                Date date#
32549>>>                sysdate4 date#
32550>>>                set p_current_date to date#
32551>>>                Send Update_Calendar
32552>>>            end_procedure
32553>>>            
32553>>>            procedure next_month
32555>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32556>>>                Send Update_Calendar
32557>>>            end_procedure
32558>>>            
32558>>>            procedure prev_month
32560>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32561>>>                Send Update_Calendar
32562>>>            end_procedure
32563>>>            
32563>>>            procedure next_year
32565>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32566>>>                Send Update_Calendar
32567>>>            end_procedure
32568>>>            
32568>>>            procedure prev_year
32570>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32571>>>                Send Update_Calendar
32572>>>            end_procedure
32573>>>            
32573>>>            Procedure Activate
32575>>>                Date date#
32576>>>                Forward Send Activate
32578>>>                Set current_item to (p_selected_day(Self))
32579>>>            End_Procedure
32580>>>            
32580>>>            Procedure Update_Calendar
32582>>>                Set Dynamic_Update_State To False
32583>>>                send Fill_List
32584>>>                Set Dynamic_Update_State To True
32585>>>                // Send Update_Label
32585>>>                Set current_item to (p_selected_day(Self))
32586>>>                Send Date_Changing to (oYear(Container3d2(self)))
32587>>>                Send Date_Changing to (oMonth(Container3d2(self)))
32588>>>            End_Procedure
32589>>>            
32589>>>            Procedure Fill_List
32591>>>                Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
32592>>>                Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
32592>>>                Date dToday
32592>>>                Send Delete_Data
32593>>>            
32593>>>                Get p_current_date to date#
32594>>>            
32594>>>                SysDate4 dToday
32595>>>                move (DateSegment(dToday,DS_DAY)) to cur_day#
32596>>>                move (DateSegment(dToday,DS_MONTH)) to cur_month#
32597>>>                move (DateSegment(dToday,DS_YEAR)) to cur_year#
32598>>>            
32598>>>                move (DateSegment(date#,DS_DAY)) to sel_day#
32599>>>                move (DateSegment(date#,DS_MONTH)) to sel_month#
32600>>>                move (DateSegment(date#,DS_YEAR)) to sel_year#
32601>>>                Set p_current_month To sel_month#
32602>>>                Set p_current_year To sel_year#
32603>>>            
32603>>>                move (FirstDayInMonth(date#)) to date#
32604>>>                move (DateDayNumber(date#)-1) to first_item#
32605>>>                move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32606>>>                move (DateIncrement(date#,DS_Month,-1)) To prevdate#
32607>>>                move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
32608>>>            
32608>>>                If (first_item# > 0) Begin
32610>>>                    Move (first_item#-1) to day#
32611>>>                    For iFor from 0 to (first_item#-1)
32617>>>>
32617>>>                        Send Add_Item msg_move_value_out (prev_last#-day#)
32618>>>                        Set Entry_State Item iFor To False
32619>>>                        Set ItemTextColor Item iFor To clGray
32620>>>                        Decrement day#
32621>>>                    Loop
32622>>>>
32622>>>                End
32622>>>>
32622>>>            
32622>>>                Move 1 To day#
32623>>>                For iFor from first_item# to last_item#
32629>>>>
32629>>>                    Send Add_Item Msg_Move_Value_Out day#
32630>>>                    Set Entry_State Item iFor To False
32631>>>                    If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Set Form_Bitmap Item iFor To "cdate.bmp"
32634>>>                    If Day# eq sel_day# Set p_selected_day To iFor
32637>>>                    Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
32638>>>                    Set form_datatype item iFor To mask_numeric_window
32639>>>                    Set form_Mask item iFor To "## "
32640>>>                    Increment day#
32641>>>                Loop
32642>>>>
32642>>>            
32642>>>                move (DateIncrement(date#,DS_Month,1)) To nextdate#
32643>>>                move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
32644>>>            
32644>>>                If (last_item# < 41) Begin
32646>>>                    Move 1 to day#
32647>>>                    For iFor from (last_item#+1) to 41
32653>>>>
32653>>>                        Send Add_Item msg_move_value_out day#
32654>>>                        Set Entry_State Item iFor To False
32655>>>                        Set ItemTextColor Item iFor To clGray
32656>>>                        Increment day#
32657>>>                    Loop
32658>>>>
32658>>>                End
32658>>>>
32658>>>            
32658>>>            End_Procedure
32659>>>            
32659>>>            Procedure Help
32661>>>                Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<PgUp>, <PgDn> - Select year.\n\n(c) 2001, SCR. Special thanks to Sture Andersen.") ("Help on Calendar")
32662>>>            End_Procedure
32663>>>            
32663>>>            procedure mouse_click integer window integer char_pos
32665>>>                Send Move_Value_Out
32666>>>                forward send mouse_click window char_pos
32668>>>            end_procedure
32669>>>            
32669>>>            Procedure Move_Value_Out
32671>>>                Integer iYear iMonth iDay iItm
32672>>>                Date Date# next_date# prev_date#
32672>>>                Get Current_Item To iItm
32673>>>                If (pExportState(Self)) Begin
32675>>>                    Get Value Item iItm To iDay
32676>>>                    Get p_current_month to iMonth
32677>>>                    Get p_current_year  to iYear
32678>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32679>>>            
32679>>>                    If ((iItm>27)and(iDay<15)) Begin
32681>>>                        Move (DateCompose(1,iMonth,iYear)) To next_date#
32682>>>                        move (DateIncrement(next_date#,DS_Month,1)) To next_date#
32683>>>                        move (DateSegment(next_date#,DS_MONTH)) to iMonth
32684>>>                        move (DateSegment(next_date#,DS_YEAR)) to iYear
32685>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32686>>>                    End
32686>>>>
32686>>>                    If ((iItm<7)and(iDay>20)) Begin
32688>>>                        Move (DateCompose(1,iMonth,iYear)) To prev_date#
32689>>>                        move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
32690>>>                        move (DateSegment(prev_date#,DS_MONTH)) to iMonth
32691>>>                        move (DateSegment(prev_date#,DS_YEAR)) to iYear
32692>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32693>>>                    End
32693>>>>
32693>>>            
32693>>>                    Send Export_Date date#
32694>>>                End
32694>>>>
32694>>>            End_Procedure
32695>>>            
32695>>>            Procedure Export_Date date date#
32697>>>                local integer focus# dm# margin# datatype#
32698>>>                get invoking_object_id to focus#
32699>>>            
32699>>>                if focus# gt desktop begin
32701>>>                     get delegation_mode of focus# to dm#
32702>>>                     set delegation_mode of focus# to no_delegate_or_error
32703>>>                     get form_margin of focus# item current to margin#
32704>>>                     get form_datatype of focus# item current to datatype#
32705>>>                     set delegation_mode of focus# to dm#
32706>>>                     if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
32709>>>                     else             set value of focus# item current to (Date4to2(date#))
32711>>>                     set item_changed_state of focus# item current to true
32712>>>                end
32712>>>>
32712>>>                Send Close_Calendar
32713>>>            End_Procedure
32714>>>            //AB-StoreEnd
32714>>>
32714>>>        End_Object    // Grid2
32715>>>
32715>>>        Object Textbox2 is a Textbox
32717>>>            Set Label to "­"
32718>>>            Set Auto_Size_State to FALSE
32719>>>            Set Transparent_State to TRUE
32720>>>            Set Color to clWhite
32721>>>            Set TextColor to clNavy
32722>>>            Set Location to 19 4
32723>>>            Set Size to 10 15
32724>>>
32724>>>            //AB-StoreStart
32724>>>                                        
32724>>>            Set Label To (left(t.calendar.Monday,2))
32725>>>            //AB-StoreEnd
32725>>>
32725>>>        End_Object    // Textbox2
32726>>>
32726>>>        Object Textbox3 is a Textbox
32728>>>            Set Label to "‚â"
32729>>>            Set Auto_Size_State to FALSE
32730>>>            Set Transparent_State to TRUE
32731>>>            Set Color to clWhite
32732>>>            Set TextColor to clNavy
32733>>>            Set Location to 19 22
32734>>>            Set Size to 10 12
32735>>>
32735>>>            //AB-StoreStart
32735>>>                                        
32735>>>            Set Label To (left(t.calendar.Tuesday,2))
32736>>>            //AB-StoreEnd
32736>>>
32736>>>        End_Object    // Textbox3
32737>>>
32737>>>        Object Textbox4 is a Textbox
32739>>>            Set Label to "‘à"
32740>>>            Set Auto_Size_State to FALSE
32741>>>            Set Transparent_State to TRUE
32742>>>            Set Color to clWhite
32743>>>            Set TextColor to clNavy
32744>>>            Set Location to 19 39
32745>>>            Set Size to 10 15
32746>>>
32746>>>            //AB-StoreStart
32746>>>                                        
32746>>>            Set Label To (left(t.calendar.Wednesday,2))
32747>>>            //AB-StoreEnd
32747>>>
32747>>>        End_Object    // Textbox4
32748>>>
32748>>>        Object Textbox5 is a Textbox
32750>>>            Set Label to "—â"
32751>>>            Set Auto_Size_State to FALSE
32752>>>            Set Transparent_State to TRUE
32753>>>            Set Color to clWhite
32754>>>            Set TextColor to clNavy
32755>>>            Set Location to 19 57
32756>>>            Set Size to 10 17
32757>>>
32757>>>            //AB-StoreStart
32757>>>                                        
32757>>>            Set Label To (left(t.calendar.Thursday,2))
32758>>>            //AB-StoreEnd
32758>>>
32758>>>        End_Object    // Textbox5
32759>>>
32759>>>        Object Textbox6 is a Textbox
32761>>>            Set Label to "â"
32762>>>            Set Auto_Size_State to FALSE
32763>>>            Set Transparent_State to TRUE
32764>>>            Set Color to clWhite
32765>>>            Set TextColor to clNavy
32766>>>            Set Location to 19 76
32767>>>            Set Size to 10 17
32768>>>
32768>>>            //AB-StoreStart
32768>>>                                        
32768>>>            Set Label To (left(t.calendar.Friday,2))
32769>>>            //AB-StoreEnd
32769>>>
32769>>>        End_Object    // Textbox6
32770>>>
32770>>>        Object Textbox7 is a Textbox
32772>>>            Set Label to "‘¡"
32773>>>            Set Auto_Size_State to FALSE
32774>>>            Set Transparent_State to TRUE
32775>>>            Set Color to clWhite
32776>>>            Set TextColor to clNavy
32777>>>            Set Location to 19 91
32778>>>            Set Size to 10 18
32779>>>
32779>>>            //AB-StoreStart
32779>>>                                        
32779>>>            Set Label To (left(t.calendar.Saturday,2))
32780>>>            //AB-StoreEnd
32780>>>
32780>>>        End_Object    // Textbox7
32781>>>
32781>>>        Object Textbox8 is a Textbox
32783>>>            Set Label to "‚á"
32784>>>            Set Auto_Size_State to FALSE
32785>>>            Set Transparent_State to TRUE
32786>>>            Set Color to clWhite
32787>>>            Set TextColor to clNavy
32788>>>            Set Location to 19 109
32789>>>            Set Size to 10 17
32790>>>
32790>>>            //AB-StoreStart
32790>>>                                        
32790>>>            Set Label To (left(t.calendar.Sunday,2))
32791>>>            //AB-StoreEnd
32791>>>
32791>>>        End_Object    // Textbox8
32792>>>
32792>>>        Object LineControl1 is a LineControl
32794>>>            Set Line_Style to lnSINGLE
32795>>>            Set Size to 1 116
32796>>>            Set Location to 28 4
32797>>>
32797>>>            //AB-StoreStart
32797>>>                                        
32797>>>            //AB-StoreEnd
32797>>>
32797>>>        End_Object    // LineControl1
32798>>>
32798>>>        Object Container3d2 is a Container3d
32800>>>            Set Size to 18 131
32801>>>            Set Location to 1 1
32802>>>            Set Color to clNavy
32803>>>            Set Border_Style to Border_None
32804>>>            Object oRght is a BitmapContainer
32806>>>                Set Size to 10 14
32807>>>                Set Location to 4 105
32808>>>                Set Bitmap to "rght.bmp"
32809>>>                Set Border_Style to Border_None
32810>>>
32810>>>                //AB-StoreStart
32810>>>                Procedure Mouse_Down
32812>>>                    Send Next_Month to Grid2
32813>>>                End_Procedure
32814>>>                //AB-StoreEnd
32814>>>
32814>>>            End_Object    // oRght
32815>>>
32815>>>            Object oLeft is a BitmapContainer
32817>>>                Set Size to 10 14
32818>>>                Set Location to 4 3
32819>>>                Set Bitmap to "lft.bmp"
32820>>>                Set Border_Style to Border_None
32821>>>
32821>>>                //AB-StoreStart
32821>>>                Procedure Mouse_Down
32823>>>                    Send Prev_Month to Grid2
32824>>>                End_Procedure
32825>>>                //AB-StoreEnd
32825>>>
32825>>>            End_Object    // oLeft
32826>>>
32826>>>            Object oMonth is a Textbox
32828>>>
32828>>>                //AB-StoreTopStart
32828>>>                Property integer piSelected_Month public 0
32830>>>                //AB-StoreTopEnd
32830>>>
32830>>>                Set Label to "January"
32831>>>                Set Auto_Size_State to FALSE
32832>>>                Set Transparent_State to TRUE
32833>>>                Set Color to clWhite
32834>>>                Set TextColor to clWhite
32835>>>                Set Location to 4 23
32836>>>                Set Size to 10 43
32837>>>                Set FontWeight to 800
32838>>>                Set Justification_Mode to jMode_Center
32839>>>
32839>>>                //AB-StoreStart
32839>>>                                    
32839>>>                Procedure Mouse_Down
32841>>>                    Integer iState
32842>>>                    Get Visible_State of oSelectYear to iState
32843>>>                    If (iState) Send OnKillFocus to oSelectYear
32846>>>                    Send Popup to oSelectMonth
32847>>>                End_Procedure
32848>>>                
32848>>>                Procedure pSelectJan
32850>>>                    Set Label to t.calendar.january
32851>>>                    Set piSelected_Month to 1
32852>>>                    Send Adjust_Calendar
32853>>>                End_Procedure
32854>>>                Procedure pSelectFeb
32856>>>                    Set Label to t.calendar.february
32857>>>                    Set piSelected_Month to 2
32858>>>                    Send Adjust_Calendar
32859>>>                End_Procedure
32860>>>                Procedure pSelectMar
32862>>>                    Set Label to t.calendar.march
32863>>>                    Set piSelected_Month to 3
32864>>>                    Send Adjust_Calendar
32865>>>                End_Procedure
32866>>>                Procedure pSelectApr
32868>>>                    Set Label to t.calendar.april
32869>>>                    Set piSelected_Month to 4
32870>>>                    Send Adjust_Calendar
32871>>>                End_Procedure
32872>>>                Procedure pSelectMay
32874>>>                    Set Label to t.calendar.may
32875>>>                    Set piSelected_Month to 5
32876>>>                    Send Adjust_Calendar
32877>>>                End_Procedure
32878>>>                Procedure pSelectJun
32880>>>                    Set Label to t.calendar.june
32881>>>                    Set piSelected_Month to 6
32882>>>                    Send Adjust_Calendar
32883>>>                End_Procedure
32884>>>                Procedure pSelectJul
32886>>>                    Set Label to t.calendar.july
32887>>>                    Set piSelected_Month to 7
32888>>>                    Send Adjust_Calendar
32889>>>                End_Procedure
32890>>>                Procedure pSelectAug
32892>>>                    Set Label to t.calendar.august
32893>>>                    Set piSelected_Month to 8
32894>>>                    Send Adjust_Calendar
32895>>>                End_Procedure
32896>>>                Procedure pSelectSep
32898>>>                    Set Label to t.calendar.september
32899>>>                    Set piSelected_Month to 9
32900>>>                    Send Adjust_Calendar
32901>>>                End_Procedure
32902>>>                Procedure pSelectOct
32904>>>                    Set Label to t.calendar.october
32905>>>                    Set piSelected_Month to 10
32906>>>                    Send Adjust_Calendar
32907>>>                End_Procedure
32908>>>                Procedure pSelectNov
32910>>>                    Set Label to t.calendar.november
32911>>>                    Set piSelected_Month to 11
32912>>>                    Send Adjust_Calendar
32913>>>                End_Procedure
32914>>>                Procedure pSelectDec
32916>>>                    Set Label to t.calendar.december
32917>>>                    Set piSelected_Month to 12
32918>>>                    Send Adjust_Calendar
32919>>>                End_Procedure
32920>>>                
32920>>>                Object oSelectMonth is a FloatingPopupMenu
32922>>>                    Send Add_Item msg_pSelectJan t.calendar.january
32923>>>                    Send Add_Item msg_pSelectFeb t.calendar.february
32924>>>                    Send Add_Item msg_pSelectMar t.calendar.march
32925>>>                    Send Add_Item msg_pSelectApr t.calendar.april
32926>>>                    Send Add_Item msg_pSelectMay t.calendar.may
32927>>>                    Send Add_Item msg_pSelectJun t.calendar.june
32928>>>                    Send Add_Item msg_pSelectJul t.calendar.july
32929>>>                    Send Add_Item msg_pSelectAug t.calendar.august
32930>>>                    Send Add_Item msg_pSelectSep t.calendar.september
32931>>>                    Send Add_Item msg_pSelectOct t.calendar.october
32932>>>                    Send Add_Item msg_pSelectNov t.calendar.november
32933>>>                    Send Add_Item msg_pSelectDec t.calendar.december
32934>>>                End_Object
32935>>>                
32935>>>                Procedure Adjust_Calendar
32937>>>                    Date date#
32938>>>                    Integer iDay iMonth iYear iItm
32938>>>                    Set Visible_State to false
32939>>>                    Set Visible_State to true
32940>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32941>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32942>>>                    Get piSelected_Month to iMonth
32943>>>                    Get Label of oYear to iYear
32944>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32945>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32946>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32947>>>                End_Procedure
32948>>>                
32948>>>                Procedure Activating
32950>>>                    Forward Send Activating
32952>>>                    Send Date_Changing
32953>>>                End_Procedure
32954>>>                
32954>>>                Procedure Date_Changing
32956>>>                    Set Visible_State to false
32957>>>                    Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
32958>>>                    Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
32959>>>                    Set Visible_State to true
32960>>>                End_Procedure
32961>>>                
32961>>>                
32961>>>                //AB-StoreEnd
32961>>>
32961>>>            End_Object    // oMonth
32962>>>
32962>>>            Object oYear is a Textbox
32964>>>                Set Label to "2001"
32965>>>                Set Transparent_State to TRUE
32966>>>                Set Color to clWhite
32967>>>                Set TextColor to clWhite
32968>>>                Set Location to 4 77
32969>>>                Set Size to 10 18
32970>>>                Set FontWeight to 800
32971>>>
32971>>>                //AB-StoreStart
32971>>>                                                    
32971>>>                Procedure Mouse_Down
32973>>>                    String sVal
32974>>>                    Get Label to sVal
32975>>>                    Set Value of oSelectYear item 0 to sVal
32976>>>                    Set Visible_State of oSelectYear to True
32977>>>                    Send Activate to (oSelectYear(Self))
32978>>>                End_Procedure
32979>>>                
32979>>>                Procedure Activating
32981>>>                    Forward Send Activating
32983>>>                    Send Date_Changing
32984>>>                End_Procedure
32985>>>                
32985>>>                Procedure Date_Changing
32987>>>                    Set Visible_State to false
32988>>>                    Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
32989>>>                    Set Visible_State to true
32990>>>                End_Procedure
32991>>>                //AB-StoreEnd
32991>>>
32991>>>            End_Object    // oYear
32992>>>
32992>>>            Object oSelectYear is a Form
32994>>>
32994>>>                //AB-StoreTopStart
32994>>>                Set Visible_State To False
32995>>>                //AB-StoreTopEnd
32995>>>
32995>>>                Set Size to 10 24
32996>>>                Set Location to 4 75
32997>>>                Set Color to clWhite
32998>>>                Set TextColor to clNavy
32999>>>                Set Form_Border Item 0 to Border_Normal
33000>>>
33000>>>                //AB-StoreStart
33000>>>                                                    
33000>>>                On_Key Key_Enter Send OnKillFocus
33001>>>                On_Key Key_Escape Send OnKillFocus
33002>>>                
33002>>>                Procedure SetFontWeight
33004>>>                    Set Form_FontWeight item 0 to 800
33005>>>                End_Procedure
33006>>>                
33006>>>                Procedure OnKillFocus
33008>>>                    String sVal
33009>>>                    Integer iMonth iDay iYear iItm
33009>>>                    Date date#
33009>>>                    Get Value item 0 to sVal
33010>>>                    Set Visible_State of oYear to false
33011>>>                    Set Label of oYear to sVal
33012>>>                    Set Visible_State of oYear to true
33013>>>                    Set Visible_State to false
33014>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
33015>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
33016>>>                    Get piSelected_Month of oMonth to iMonth
33017>>>                    Get Value item 0 to iYear
33018>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
33019>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
33020>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
33021>>>                End_Procedure
33022>>>                
33022>>>                Send SetFontWeight
33023>>>                //AB-StoreEnd
33023>>>
33023>>>            End_Object    // oSelectYear
33024>>>
33024>>>
33024>>>            //AB-StoreStart
33024>>>                            
33024>>>            Procedure Mouse_Down
33026>>>                Integer iState
33027>>>                Get Visible_State of oSelectYear to iState
33028>>>                If (iState) Send OnKillFocus to oSelectYear
33031>>>            End_Procedure
33032>>>            
33032>>>            //AB-StoreEnd
33032>>>
33032>>>        End_Object    // Container3d2
33033>>>
33033>>>
33033>>>        //AB-StoreStart
33033>>>                            
33033>>>        //AB-StoreEnd
33033>>>
33033>>>    End_Object    // Container3d1
33034>>>
33034>>>    Object BitmapContainer3 is a BitmapContainer
33036>>>        Set Size to 9 19
33037>>>        Set Location to 88 3
33038>>>        Set Color to clWhite
33039>>>        Set Bitmap to "cdate.bmp"
33040>>>        Set Border_Style to Border_None
33041>>>
33041>>>        //AB-StoreStart
33041>>>        Procedure Mouse_Down
33043>>>            Send go_today to (Grid2(Container3d1(Self)))
33044>>>            Send Adjust_Label to oToday
33045>>>        End_Procedure
33046>>>        //AB-StoreEnd
33046>>>
33046>>>    End_Object    // BitmapContainer3
33047>>>
33047>>>    Object oToday is a Textbox
33049>>>        Set Label to "Today: 01.01.2001"
33050>>>        Set Auto_Size_State to FALSE
33051>>>        Set Color to clWhite
33052>>>        Set Location to 88 22
33053>>>        Set Size to 8 73
33054>>>        Set FontWeight to 800
33055>>>
33055>>>        //AB-StoreStart
33055>>>        Procedure Mouse_Down
33057>>>            Send go_today to (Grid2(Container3d1(Self)))
33058>>>            Send Adjust_Label
33059>>>        End_Procedure
33060>>>        
33060>>>        Procedure Adjust_Label
33062>>>            date date#
33063>>>            SysDate4 date#
33064>>>            Set Visible_State To false
33065>>>            Set Label         to (t.calendar.today+": "+String(date#))
33066>>>            Set Visible_State To true
33067>>>        End_Procedure
33068>>>        
33068>>>        Procedure Activating
33070>>>            Forward Send Activating
33072>>>            Send Adjust_Label
33073>>>        End_Procedure
33074>>>        //AB-StoreEnd
33074>>>
33074>>>    End_Object    // oToday
33075>>>
33075>>>
33075>>>    //AB-StoreStart
33075>>>                
33075>>>    procedure popup
33077>>>        local integer focus# icItm iYear iMonth
33078>>>        local date date#
33078>>>        move (focus(desktop)) to focus#
33079>>>        set invoking_object_id of (Grid2(Container3d1(self))) to focus#
33080>>>        get value of focus# item current to date#
33081>>>        ifnot (integer(date#)) sysdate date#
33084>>>        move (Date2to4(date#)) to date#
33085>>>        set p_current_date of (Grid2(Container3d1(self))) to date#
33086>>>        send fill_list to (Grid2(Container3d1(self)))
33087>>>        move (DateSegment(date#,DS_YEAR)) to iYear
33088>>>        move (DateSegment(date#,DS_MONTH)) to iMonth
33089>>>        Set Label To (MonthName(iMonth)+', '+String(iYear))
33090>>>        forward send popup
33092>>>    end_procedure
33093>>>    
33093>>>    Procedure Close_Calendar
33095>>>        Send Exit
33096>>>    End_Procedure
33097>>>    //AB-StoreEnd
33097>>>
33097>>>CD_End_Object    // oCalendar
33099>>>>
33099>>>
33099>>>
33099>>>//AB-StoreStart
33099>>>    
33099>>>    
33099>>>//AB-StoreEnd
33099>>>
33099>>>//AB/ End_Object    // prj
33099>Use Dates.Utl
33099>Use Roundfn.Fnc
INCLUDING FILE: ROUNDFN.FNC
33099>>>// ===========================================================================
33099>>>//
33099>>>// The ROUND_NUMBER global function has been designed to return the rounded
33099>>>// value of a given 'numeric' argument at a specified rounding precision.
33099>>>//
33099>>>// ---------------------------------------------------------------------------
33099>>>// This version dispenses with the use of powers (10 ^ n) to perform the
33099>>>// necessary calculations.  It uses a string handling technique instead.
33099>>>// ---------------------------------------------------------------------------
33099>>>//
33099>>>// The function requires two arguments, as follows:-
33099>>>//
33099>>>// (a) The numeric value to be rounded, where the range of valid values is
33099>>>//     +/- 99,999,999,999,999.99999999.
33099>>>//
33099>>>// (b) The rounding precision required.  This must be an integer value in the
33099>>>//     range -13 to +8.  If a value outside this range is used, the nearest
33099>>>//     threshold value is substituted.
33099>>>//
33099>>>//     Values in the range +1 to +7 perform rounding on the decimal part of
33099>>>//     the number.  A value of +8 will perform no rounding at all.  A zero
33099>>>//     value will round to the nearest whole number.  Values -1 to -13 will
33099>>>//     round progressively to the left of the decimal point (a frequent
33099>>>//     requirement in financial reporting).
33099>>>//
33099>>>// If the result of the rounding produces a value outside the valid numeric
33099>>>// range (+/- 99,999,999,999,999.99999999) then a zero value is returned.
33099>>>//
33099>>>// Assumptions:-  The only assumptions made have been that the range of
33099>>>// numeric values and the limit of eight decimal places are unlikely to change
33099>>>// in the forseeable future.
33099>>>//
33099>>>// Examples:-
33099>>>//
33099>>>//  1st Argument      2nd Argument   Return Value
33099>>>//  ------------      ------------   ------------
33099>>>//  123456.87654321         8         123456.87654321
33099>>>//  123456.87654321         2         123456.88
33099>>>// -123456.87654321         2        -123456.88
33099>>>//  123456.98765432         0         123457
33099>>>// -123456.98765432        -1        -123460
33099>>>//  123456.98765432        -2         123500
33099>>>//  123456.98765432        -3         123000
33099>>>//  987654                 -4         990000
33099>>>//  987654                 -5        1000000
33099>>>//  987654                 -6        1000000
33099>>>//  987654                 -7              0
33099>>>//
33099>>>// ===========================================================================
33099>>>
33099>>>
33099>>>Function Round_Number GLOBAL number nVal integer iRnd returns Number
33100>>>
33100>>>  Local Number nAdj
33101>>>
33101>>>  Move 10000000000000 to nAdj
33102>>>
33102>>>  // If the rounding precision falls in the range 0 to 8, then return:-
33102>>>
33102>>>  If (iRnd >= 0) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 / (Number(Left(nAdj, ((iRnd + 1) ;      min 9)))) + nVal / (Number(Left(nAdj, (9 - (iRnd min 8))))) ;        * (Number(Left(nAdj, (9 - (iRnd min 8))))))
33105>>>
33105>>>  // Else, where the rounding precision is in the range -1 to -5, return:-
33105>>>
33105>>>  If (iRnd >= -5) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(Left(nAdj, (Abs(iRnd) + 9)))) ;        * (Number(Left(nAdj, (Abs(iRnd) + 9)))))
33108>>>
33108>>>  // Else, where the rounding precision is in the range -6 to -13, return:-
33108>>>
33108>>>  Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(nAdj)) / (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))) ;        * (Number(nAdj)) * (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))))
33109>>>
33109>>>End_Function
33110>Use Connect.Dg
INCLUDING FILE: CONNECT.DG
33110>>>//AB/ Project Connect
33110>>>//AB/ Object prj is a Dialog_Project
33110>>>//AB/     Set ProjectName to "Connect"
33110>>>//AB/     Set ProjectFileName to "Connect.dg"
33110>>>
33110>>>// Project Object Structure
33110>>>//   Connect is a BasicPanelSub
33110>>>//     BitmapContainer1 is a BitmapContainerSub
33110>>>//     Textbox5 is a TextBoxSub
33110>>>//     ComboForm2 is a ComboFormSub
33110>>>//     Textbox6 is a TextBoxSub
33110>>>//     Form4 is a FormSub
33110>>>//     Textbox7 is a TextBoxSub
33110>>>//     Form5 is a FormSub
33110>>>//     Textbox8 is a TextBoxSub
33110>>>//     Form6 is a FormSub
33110>>>//     CheckBox1 is a CheckBoxSub
33110>>>//     oOK_bn is a ButtonSub
33110>>>//     oCancel_bn is a ButtonSub
33110>>>
33110>>>// Register all objects
33110>>>Register_Object BitmapContainer1
33110>>>Register_Object CheckBox1
33110>>>Register_Object ComboForm2
33110>>>Register_Object Connect
33110>>>Register_Object Form4
33110>>>Register_Object Form5
33110>>>Register_Object Form6
33110>>>Register_Object oCancel_bn
33110>>>Register_Object oOK_bn
33110>>>Register_Object Textbox5
33110>>>Register_Object Textbox6
33110>>>Register_Object Textbox7
33110>>>Register_Object Textbox8
33110>>>
33110>>>
33110>>>
33110>>>//AB-StoreTopStart
33110>>>
33110>>>///#INCLUDE
33110>>>Use mertech.inc
INCLUDING FILE: MERTECH.INC
33110>>>>>USE UI
33110>>>>>
#REM -----------------------------------------------
#REM MERTECH DATA SYSTEMS INC. - WWW.MERTECHDATA.COM
#REM MERTECH.INC VERSION 2.1.9
#REM -----------------------------------------------
33110>>>>>
33110>>>>>
33110>>>>>
33110>>>>>
33110>>>>>
33110>>>>>//
33110>>>>>//
33110>>>>>//
33110>>>>>//
33110>>>>>//
33110>>>>>//-----------------------------------------------
33110>>>>>// SELECT_COLUMNS_FIND <FILE> <START> THRU <END>
33110>>>>>// SELECT_COLUMNS_FIND <FILE> <FIELD>
33110>>>>>// This command will issue a properly commands to define the FETCH attribute status
33110>>>>>// for file fields.
33110>>>>>//
33110>>>>>//------------------------------------------------------------------------------
33110>>>>>// RESET_FETCH_FIELDS <FILE NAME>|<FILE NUMBER> <DF_FETCH_TRUE>|<DF_FETCH_FALSE>
33110>>>>>//
33110>>>>>//
33110>>>>>//-----------------------------
33110>>>>>// SQL_FOR_ONEROW <file number>
33110>>>>>//
33110>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get just
33110>>>>>// one ROW for each DataFlex FIND command issued
33110>>>>>// In this case the DBMS optimizer will generate a query with just one row
33110>>>>>//
33110>>>>>//
33110>>>>>//-------------------------------------------------------------------------------
33110>>>>>// SQL_FOR_SET <file number> MAXROWS <number of rows> CACHE|NOCACHE <return code>
33110>>>>>//
33110>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get a SET of rows.
33110>>>>>// In this case the DBMS optimizer will generate a query with <number of rows> Rows.
33110>>>>>// if CACHE is passed as argument, all these rows will be transfered to ORAFlex and then it will
33110>>>>>// save them in a local CACHE buffer. Just the FIND GT and FIND LT will get local cache.
33110>>>>>// Otherwise, i.e NOCACHE,  ORAFLex won't create a local cache.
33110>>>>>//
33110>>>>>//
33110>>>>>//---------------
33110>>>>>// SQL_SET <stmt>
33110>>>>>//
33110>>>>>//-----------------------------------------
33110>>>>>// SQL_APPEND <stmt1> <stmt2> .... <stmtn>
33110>>>>>//
33110>>>>>//------------
33110>>>>>// SQL_EXECUTE
33110>>>>>//
33110>>>>>//----------------------------------------------------------------------
33110>>>>>// LOCK_TABLE [<FILE NAME>|<FILE NUMBER> <FILE NAME>|<FILE NUMBER> ....]
33110>>>>>//
33110>>>>>// LOCK_TABLE will lock the entire table specified as an argument
33110>>>>>// This command will start a new transaction if it still wasn't done.
33110>>>>>// LOCK_TABLE won't lock the other opened tables or the current rows present
33110>>>>>// in their buffers it will be necessary issue a REREAD command to Lock the current
33110>>>>>// rows and then atualize their buffers
33110>>>>>//
33110>>>>>//
33110>>>>>//-------------------------------------------
33110>>>>>// SQL_CHECK_TABLE <SCHEMA NAME> <TABLE NAME>
33110>>>>>//
33110>>>>>//-------------------------------
33110>>>>>// CREATE_TD_FILE  DFTRUE|DFFALSE
33110>>>>>// SET A GLOBAL ATTRIBUTE TO CREATE THE TD FILE AFTER CLOSING AN OPENED FILE
33110>>>>>//
33110>>>>>//-------------------------------------------------
33110>>>>>// OPEN_INT <DATAFLEX FILE NAME>
33110>>>>>// OPEN_INT <PHYSICAL NAME> AS <DATAFLEX FILE NAME>
33110>>>>>//
33110>>>>>// OPEN_INT will check if the OPEN done is an OPEN AS. IF it's true, OPEN_INT
33110>>>>>// will try to open an intermediate file, if there is one. Otherwise OPEN_INT
33110>>>>>// will issue a OPEN command
33110>>>>>// OPEN_INT must be inserted into FMAC file instead OPEN COMMAND
33110>>>>>//
33110>>>>>//=========================================================================================================
33110>>>>>// SELECT STUFFS
33110>>>>>//--------------
33110>>>>>// SQL_SET_STMT OF FILENAME|FILENUMBER TO <STATMENT1>
33110>>>>>//
33110>>>>>// SQL_APPEND_ OF FILENAME|FILENUMBER TO <STATMENT1> <STATMENT2> ... <STATMENTn>
33110>>>>>//
33110>>>>>//
33110>>>>>// SQL_APPEND_UPDCOL_STMT OF FILENAME|FILENUMBER VALUE EXPRESSION WITH FIELD1 FIELD2 ... FIELDN
33110>>>>>//
33110>>>>>// SQL_PREPARE_STMT OF FILENAME|FILENUMBER
33110>>>>>//
33110>>>>>// SQL_BIND_COLUMN [FILENAME|FILENUMBER] [FIELDNAME|FIELDNUMBER]
33110>>>>>//
33110>>>>>// SQL_BINDCOLUMNS_STMT OF FILENAME|FILENUMBER TO <COLUMN1> <COLUMN2> ... <COLUMNn>
33110>>>>>//
33110>>>>>// SQL_EXECUTE_STMT OF FILENAME|FILENUMBER
33110>>>>>//
33110>>>>>// SQL_COMMIT_STMT
33110>>>>>//
33110>>>>>// SQL_ROLLBACK_STMT
33110>>>>>//
33110>>>>>// SQL_FETCH_NEXT_ROW OF FILENAME|FILENUMBER
33110>>>>>//
33110>>>>>//
33110>>>>>//
33110>>>>>//
33110>>>>>// CALL_STORED_PROCEDURE will call a stored procedure passing arguments
33110>>>>>//
33110>>>>>// FORMAT TO USE : CALL_STORED_PROCEDURE <STORED_PROC_NAME> [PASSING <ARG1> <ARG2> ....<ARGn>]
33110>>>>>//
33110>>>>>//
33110>>>>>//---------------------------------------------------------------------------------------------
33110>>>>>// CALL_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
33110>>>>>// CALL_STORED_FUNCTION will call an Oracle stored function passing arguments
33110>>>>>//
33110>>>>>//---------------------------
33110>>>>>// SQL_TEXT_MESSAGE <MESSAGE>
33110>>>>>// Writes a message inside driver log trace file if this is activated
33110>>>>>//
33110>>>>>//-----------------------------------------------------
33110>>>>>// OUTPUT_INT_FILE FOR <FILE NUMBER> TO <INT FILE NAME>
33110>>>>>// Generating the INT file
33110>>>>>//
33110>>>>>// -----------------------
33110>>>>>// SQL_ERROR_MESSAGE <VAR>
33110>>>>>// SQL_ERROR_MESSAGE retrieve the native error message issued by server for error number 25000
33110>>>>>
33110>>>>>
33110>>>>>//=======================================================================================
33110>>>>>// SQLFlex Commands
33110>>>>>//-----------------
33110>>>>>//
33110>>>>>//-----------------------
33110>>>>>// SQLFlex_REVISION <VAR>
33110>>>>>// Retrieves SQLFlex revision
33110>>>>>//
33110>>>>>//-------------------------------------
33110>>>>>// SET_DATABASE_NAME TO <DATABASE NAME>
33110>>>>>// Sets current database
33110>>>>>//
33110>>>>>//---------------------------
33110>>>>>// GET_DATABASE_NAME TO <VAR>
33110>>>>>// Gets name of current database
33110>>>>>//
33110>>>>>//----------------------------------
33110>>>>>// SET_SCHEMA_NAME TO <SCHEMA NAME>
33110>>>>>// Sets current schema name
33110>>>>>//
33110>>>>>//-------------------------
33110>>>>>// GET_SCHEMA_NAME TO <VAR>
33110>>>>>// Gets current schema name
33110>>>>>//
33110>>>>>//--------------------------------
33110>>>>>// SQL_USEDATABASE <DATABASE NAME>
33110>>>>>// Specifies the current Database
33110>>>>>//
33110>>>>>//----------------------------
33110>>>>>// SET_CURRENT_SERVER TO <VAR>
33110>>>>>// Set the current logged server
33110>>>>>//
33110>>>>>//----------------------------
33110>>>>>// GET_CURRENT_SERVER TO <VAR>
33110>>>>>// Retrieves the current logged server
33110>>>>>//
33110>>>>>//-----------------------------
33110>>>>>// SET_HOST_NAME TO <HOST NAME>
33110>>>>>// Defines current host name
33110>>>>>//
33110>>>>>//-----------------------
33110>>>>>// GET_HOST_NAME TO <VAR>
33110>>>>>// Retrieves the current host name
33110>>>>>//
33110>>>>>//---------------------------------------------------------------
33110>>>>>// LOGIN_SQLFLEX <SERVER NAME> <USER NAME> <PASSWORD> <HOST NAME>
33110>>>>>// Specifies host name during login process
33110>>>>>//
33110>>>>>// SQL_CANCEL_QUERY_STMT
33110>>>>>//
33110>>>>>//========================================
33110>>>>>// SQL SERVER Stored Procedure Call engine
33110>>>>>//----------------------------------------
33110>>>>>//
33110>>>>>//
33110>>>>>
33110>>>>>//
33110>>>>>//--------------------------------------------------------------------------------------------------------------
33110>>>>>// CALL_SQLSERVER_PROCEDURE <procedure name> PASSING <VALUE1|VARIABLE1> [SQLOUT] <VALUE2|VARIABLE2> [SQLOUT] ...
33110>>>>>//
33110>>>>>// Executes a stored procedure. SQLOUT will be used to indicate that the stored procedure
33110>>>>>// returns a parameter. The matching parameter in the stored proceudre must have been created with
33110>>>>>// the keyword OUTPUT. Call all procedures that doesn't returns any query with this syntax
33110>>>>>//
33110>>>>>//
33110>>>>>//
33110>>>>>//-----------------------------------------------------------------------------
33110>>>>>
33110>>>>>
33110>>>>>//=============================================================================
33110>>>>>// ORAFlex Commands
33110>>>>>//-----------------
33110>>>>>//----------------------------
33110>>>>>// ORAFlex_REVISION <VARIABLE>
33110>>>>>// Retrieves ORAFlex revision
33110>>>>>//
33110>>>>>//---------------------------------
33110>>>>>// KEEP_FILES_OPEN OF <SERVER NAME>
33110>>>>>// Keeps all files opened even during a LOGOUT
33110>>>>>//
33110>>>>>//-----------------------------------------------
33110>>>>>// SET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
33110>>>>>// Defines the maximum number of cursors that ORAFlex will be allowed for using
33110>>>>>//
33110>>>>>//-----------------------------------------------
33110>>>>>// GET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
33110>>>>>// Retrieves the maximum number of cursors allowed for ORAFlex use
33110>>>>>//
33110>>>>>//---------------------------------------------
33110>>>>>// GET_OPENED_CURSORS OF <SERVER NAME> TO <VAR>
33110>>>>>// Retrieves the number of opened cursors
33110>>>>>//
33110>>>>>//-----------------------------------------------
33110>>>>>// ACTIVATE_TIME_STAMP OF <SERVER NAME> TO ON|OFF
33110>>>>>// Activates Time stamp for date columns
33110>>>>>//
33110>>>>>//----------------------------------------------------------------------------------------------------
33110>>>>>// CALL_ORACLE_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
33110>>>>>// CALL_ORACLE_STORED_FUNCTION will call an Oracle stored function passing arguments
33110>>>>>//
33110>>>>>//-----------------------------------------------------------------------------
33110>>>>>
33110>>>>>//=============================================================================
33110>>>>>// BUFFER save stuffs
33110>>>>>//-------------------
33110>>>>>
33110>>>>>//-------------------------------------------------------
33110>>>>>// SQL_SAVE_BUFFER_BEGIN OF <FILE NUMBER> TO <CACHE SIZE>
33110>>>>>// Initialize the BUFFER buffer
33110>>>>>//
33110>>>>>//---------------------------------
33110>>>>>// SQL_SAVE_BUFFER OF <FILE NUMBER>
33110>>>>>// Moves field buffer values to cache buffer
33110>>>>>//-------------------------------------
33110>>>>>// SQL_SAVE_BUFFER_END OF <FILE NUMBER>
33110>>>>>// Save rows that remains in cache
33110>>>>>//-----------------------------------------------------------------------------
33110>>>>>
33110>>>
33110>>>//AB-StoreTopEnd
33110>>>
33110>>>//AB-IgnoreStart
33110>>>
33110>>>Use Panel.Sub
33110>>>Use Bitmap.Sub
33110>>>Use Txtbox.Sub
33110>>>Use Cmbfrm.Sub
33110>>>Use Form.Sub
33110>>>Use Chkbox.Sub
33110>>>Use Button.Sub
33110>>>
33110>>>
33110>>>//AB-IgnoreEnd
33110>>>
33110>>>Object Connect is a BasicPanelSub
33112>>>
33112>>>    //AB-StoreTopStart
33112>>>
33112>>>    //AB-StoreTopEnd
33112>>>
33112>>>    Set Sysmenu_Icon to FALSE
33113>>>    Set Minimize_Icon to FALSE
33114>>>    Set Label to "Login"
33115>>>    Set Size to 105 230
33116>>>    Set Location to 20 37
33117>>>
33117>>>    //AB-DDOStart
33117>>>
33117>>>
33117>>>    //AB-DDOEnd
33117>>>
33117>>>    Object BitmapContainer1 is a BitmapContainerSub
33119>>>        Set Size to 21 23
33120>>>        Set Location to 4 4
33121>>>        Set Bitmap to "Login1.bmp"
33122>>>        Set Border_Style to Border_None
33123>>>        Set Bitmap_Style to Bitmap_Center
33124>>>        Set Dialog_Caption to "Select a bitmap file"
33125>>>
33125>>>        //AB-StoreStart
33125>>>
33125>>>
33125>>>
33125>>>
33125>>>        //AB-StoreEnd
33125>>>
33125>>>    End_Object    // BitmapContainer1
33126>>>
33126>>>    Object Textbox5 is a TextBoxSub
33128>>>        Set Label to "Driver:"
33129>>>        Set FontSize to 4 0
33130>>>        Set Location to 6 34
33131>>>        Set Size to 13 40
33132>>>        Set TypeFace to "MS Sans Serif"
33133>>>        Set Enabled_State to TRUE
33134>>>    End_Object    // Textbox5
33135>>>
33135>>>    Object ComboForm2 is a ComboFormSub
33137>>>
33137>>>        //AB-StoreTopStart
33137>>>
33137>>>        Set CapsLock_State to True
33138>>>
33138>>>        //AB-StoreTopEnd
33138>>>
33138>>>        Set Size to 13 85
33139>>>        Set Location to 6 76
33140>>>        Set Label_Col_Offset to 2
33141>>>        Set Label_Justification_Mode to jMode_Right
33142>>>
33142>>>        //AB-StoreStart
33142>>>        Procedure Combo_Fill_List
33144>>>                Local String Availdrv## TempDrv##
33145>>>                Local Integer HowMany i p1## p2##
33145>>>
33145>>>                get_profile_string "WorkSpaces" "CurrentWorkspace" to AvailDrv##
33148>>>                If AvailDrv## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to AvailDrv##
33151>>>                insert "WorkSpaces\" in AvailDrv## at 1
33153>>>                get_profile_string AvailDrv## "AvailableDrivers" to AvailDrv##
33156>>>
33156>>>                Move Availdrv## to Tempdrv##
33157>>>                Repeat
33157>>>>
33157>>>                    Replace "|" in Tempdrv## With ""
33159>>>                    [Found] Increment HowMany
33160>>>                Until [Finderr]
33162>>>
33162>>>                Send Combo_add_Item ""
33163>>>
33163>>>                If HowMany lt 1 Begin
33165>>>                    If Availdrv## ne "" Send Combo_Add_Item (UpperCase(Availdrv##))
33168>>>                End
33168>>>>
33168>>>                Else Begin
33169>>>                    For i From 0 to HowMany
33175>>>>
33175>>>                        If i eq 0 Move 1 to p1##
33178>>>                        Else Begin
33179>>>                            Move ((Pos("|",Availdrv##))+1) to p1##
33180>>>                            Replace "|" in Availdrv## With ","
33182>>>                        End
33182>>>>
33182>>>                        Move ((Pos("|",Availdrv##))) to p2##
33183>>>                        Send Combo_Add_Item (UpperCase(Mid(Availdrv##,(p2##-p1##),p1##)))
33184>>>                    Loop
33185>>>>
33185>>>                End
33185>>>>
33185>>>        End_Procedure
33186>>>
33186>>>        Set Allow_Blank_state to True
33187>>>
33187>>>
33187>>>
33187>>>        //AB-StoreEnd
33187>>>
33187>>>    End_Object    // ComboForm2
33188>>>
33188>>>    Object Textbox6 is a TextBoxSub
33190>>>        Set Label to "Server:"
33191>>>        Set FontSize to 4 0
33192>>>        Set Location to 22 34
33193>>>        Set Size to 13 40
33194>>>        Set TypeFace to "MS Sans Serif"
33195>>>        Set Enabled_State to TRUE
33196>>>    End_Object    // Textbox6
33197>>>
33197>>>    Object Form4 is a FormSub
33199>>>        Set Size to 13 93
33200>>>        Set Location to 22 76
33201>>>        Set Label_Col_Offset to 2
33202>>>        Set Label_Justification_Mode to jMode_Right
33203>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33204>>>    End_Object    // Form4
33205>>>
33205>>>    Object Textbox7 is a TextBoxSub
33207>>>        Set Label to "User Name:"
33208>>>        Set FontSize to 4 0
33209>>>        Set Location to 38 34
33210>>>        Set Size to 13 40
33211>>>        Set TypeFace to "MS Sans Serif"
33212>>>        Set Enabled_State to TRUE
33213>>>    End_Object    // Textbox7
33214>>>
33214>>>    Object Form5 is a FormSub
33216>>>        Set Size to 13 93
33217>>>        Set Location to 38 76
33218>>>        Set Label_Col_Offset to 2
33219>>>        Set Label_Justification_Mode to jMode_Right
33220>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33221>>>    End_Object    // Form5
33222>>>
33222>>>    Object Textbox8 is a TextBoxSub
33224>>>        Set Label to "Password:"
33225>>>        Set FontSize to 4 0
33226>>>        Set Location to 54 34
33227>>>        Set Size to 13 40
33228>>>        Set TypeFace to "MS Sans Serif"
33229>>>        Set Enabled_State to TRUE
33230>>>    End_Object    // Textbox8
33231>>>
33231>>>    Object Form6 is a FormSub
33233>>>        Set Size to 13 93
33234>>>        Set Location to 54 76
33235>>>        Set Label_Col_Offset to 2
33236>>>        Set Label_Justification_Mode to jMode_Right
33237>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33238>>>
33238>>>        //AB-StoreStart
33238>>>        Set Password_State Item 0 to True
33239>>>
33239>>>        //AB-StoreEnd
33239>>>
33239>>>    End_Object    // Form6
33240>>>
33240>>>    Object CheckBox1 is a CheckBoxSub
33242>>>        Set Label to "Save Password"
33243>>>        Set Size to 10 66
33244>>>        Set Location to 73 76
33245>>>        Set Status_Help to "Remember The Password at Next Login"
33246>>>    End_Object    // CheckBox1
33247>>>
33247>>>    Object oOK_bn is a ButtonSub
33249>>>        Set Label to "Co&nnect"
33250>>>        Set Default_State to TRUE
33251>>>        Set Bitmap to "mcr.bmp"
33252>>>        Set Size to 28 33
33253>>>        Set Location to 9 184
33254>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33255>>>
33255>>>        //AB-StoreStart
33255>>>        Procedure OnClick
33257>>>            Set LoginOk to True
33258>>>            Send Stop_Modal_ui
33259>>>        End_Procedure
33260>>>        Set Status_Help to "Connect"
33261>>>        //AB-StoreEnd
33261>>>
33261>>>    End_Object    // oOK_bn
33262>>>
33262>>>    Object oCancel_bn is a ButtonSub
33264>>>        Set Label to "&Cancel"
33265>>>        Set Bitmap to "exit2.bmp"
33266>>>        Set Size to 28 32
33267>>>        Set Location to 39 184
33268>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33269>>>
33269>>>        //AB-StoreStart
33269>>>
33269>>>        ON_KEY KENTER SEND Exit_Application to (Connect(Current_Object))
33270>>>
33270>>>        Procedure OnClick
33272>>>            Set LoginOk to False
33273>>>            Send Exit_Application to (Connect(Current_Object))
33274>>>        End_Procedure
33275>>>
33275>>>        Set Status_Help to "Close Application"
33276>>>
33276>>>
33276>>>        //AB-StoreEnd
33276>>>
33276>>>    End_Object    // oCancel_bn
33277>>>
33277>>>
33277>>>    //AB-StoreStart
33277>>>
33277>>>    Set Modal_State to True
33278>>>
33278>>>    // Now is WorkspaceAware
33278>>>
33278>>>    ON_KEY KENTER SEND OnClick to (oOk_bn(Current_Object))
33279>>>    ON_KEY KSAVE_RECORD SEND OK
33280>>>    ON_KEY KCANCEL SEND EXIT_APPLICATION
33281>>>    ON_KEY KCLOSE_PANEL SEND EXIT_APPLICATION
33282>>>
33282>>>    Set Locate_Mode to Center_On_Screen
33283>>>    Set Exit_Application_Local_State to False
33284>>>    Set Exit_MSG to Exit
33285>>>    Set Description_State to True
33286>>>
33286>>>    Property Integer LoginOk public false
33288>>>
33288>>>    External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;        Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
33289>>>
33289>>>    Function Network_User_Name Returns String
33291>>>        Local String sName sLength
33292>>>        Local Pointer lpName_Addr lpLength_Addr
33292>>>        Local Integer iRetval
33292>>>
33292>>>        Movestr (Repeat (Character (0), 255)) To sName
33293>>>>
33293>>>        GetAddress Of sName To lpName_Addr
33294>>>        Movestr (DwordToBytes (255)) To sLength
33295>>>>
33295>>>        GetAddress Of sLength To lpLength_Addr
33296>>>
33296>>>        Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
33297>>>>
33297>>>
33297>>>        If iRetval Eq 0 Function_Return (CString (sName))
33300>>>        Else Function_Return "User Unknown"
33302>>>    End_Function // Network_User_Name
33303>>>
33303>>>    Function fsCrypto String lsWay String lsOld Returns String
33305>>>        Local String lsNew lsTemp
33306>>>        Local Integer liCount
33306>>>           For liCount From 1 to (Length(lsOld))
33312>>>>
33312>>>               Mid lsOld to lsTemp 1 liCount
33315>>>>
33315>>>               If ((Uppercase(lsWay)) eq 'FORWARD') Begin
33317>>>               If ((Ascii(lsTemp) = 255)) Move (Character(32)) to lsTemp
33320>>>               Else Move (Character(Ascii(lsTemp)+1)) to lsTemp
33322>>>               End
33322>>>>
33322>>>               Else Begin
33323>>>                   If ((Uppercase(lsWay)) eq 'BACKWARD') Begin
33325>>>                       If ((Ascii(lsTemp) = 32)) Move (Character(255)) to lsTemp
33328>>>                       Else Move (Character(Ascii(lsTemp)-1)) to lsTemp
33330>>>                   End
33330>>>>
33330>>>               End
33330>>>>
33330>>>               Append lsNew lsTemp
33331>>>           Loop
33332>>>>
33332>>>        Function_Return (lsNew)
33333>>>    End_Function
33334>>>
33334>>>    Procedure Activating
33336>>>        Local String LoginDriver## LoginServer## LoginUserid## LoginPassword##
33337>>>        Local String LastLogin## LoginSeq##
33337>>>        Local Integer SavePassword##
33337>>>
33337>>>        Forward Send Activating
33339>>>
33339>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33342>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33345>>>        insert "WorkSpaces\" in LastLogin## at 1
33347>>>        Append LastLogin## "\" (Module_Name(Self)) "\LastLogin"
33350>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33353>>>
33353>>>        If "|" in LoginSeq## move (left(LoginSeq##,(pos("|",LoginSeq##) -1))) to LoginDriver##
33356>>>        Else Move LoginSeq## to LoginDriver##
33358>>>        get_profile_string LastLogin## "LoginServer"  to LoginServer##
33361>>>        get_profile_string LastLogin## "LoginUserId"  to LoginUserId##
33364>>>        get_profile_string LastLogin## "SavePassword" to SavePassword##
33367>>>        If LoginUserId## eq "" Move (Network_User_Name(Current_Object)) to LoginUserId##
33370>>>
33370>>>        If (((UpperCase(LoginDriver##)) eq "DATAFLEX") or (LoginDriver## eq "")) Begin
33372>>>                Set Value of (ComboForm2(Current_Object)) Item 0 to ""
33373>>>                Set Value of (Form4(Current_Object))      Item 0 to ""
33374>>>        End
33374>>>>
33374>>>        Else Begin
33375>>>            Set Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
33376>>>            Set Value of (Form4(Current_Object))      Item 0 to LoginServer##
33377>>>        End
33377>>>>
33377>>>        Set Value of (Form5(Current_Object))      Item 0 to LoginUserID##
33378>>>        Set Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
33379>>>        If (SavePassword##) Begin
33381>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33382>>>            get_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to LoginPassword##
33386>>>            Set Value of (Form6(Current_Object))      Item 0 to (fsCrypto(Self,"backward",LoginPassword##))
33387>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33388>>>        End
33388>>>>
33388>>>    End_Procedure
33389>>>
33389>>>    Function LoginUser Returns Integer
33391>>>        Integer SavePassword## Size## PasswordOk
33392>>>        String LoginDriver## LoginServer## LoginUserid## LoginPassword## LoginSeq## LastLogin##
33392>>>        String lsLoginDate lsHH lsMM lsSS sDepartment
33392>>>        Integer liOpenCursors
33392>>>
33392>>>        Send Popup_Modal
33393>>>
33393>>>        Get Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
33394>>>        Get Value of (Form4(Current_Object))      Item 0 to LoginServer##
33395>>>        Get Value of (Form5(Current_Object))      Item 0 to LoginUserID##
33396>>>        Get Value of (Form6(Current_Object))      Item 0 to LoginPassword##
33397>>>        Get Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
33398>>>        Set Value of (Form6(Current_Object))      Item 0 to ""
33399>>>
33399>>>    //tolis 03/02/2004
33399>>>        If ((LoginDriver## <> "") and (UpperCase(LoginDriver##)<>"DATAFLEX"))  begin
33401>>>    //        send ignore_error to (error_info_object(current_object)) 25000
33401>>>    //        send ignore_error to (error_info_object(current_object)) 4255
33401>>>    //        send ignore_error to (error_info_object(current_object)) 12293
33401>>>    //        login LoginServer## LoginUserId## LoginPassword## LoginDriver##
33401>>>    //        send trap_error to (error_info_object(current_object)) 25000
33401>>>    //        send trap_error to (error_info_object(current_object)) 4255
33401>>>    //        send trap_error to (error_info_object(current_object)) 12293
33401>>>    //        If LastErr eq 25000 Begin
33401>>>    //            Error LastErr "Invalid Login Information"
33401>>>    //            Set LoginOk to False
33401>>>    //            Send Exit_Application
33401>>>    //        End
33401>>>    //        If LastErr eq 4255 Begin
33401>>>    //            Error LastErr "Invalid Driver Name"
33401>>>    //            Set LoginOk to False
33401>>>    //            Send Exit_Application
33401>>>    //        End
33401>>>    //        If LastErr eq 12293 Begin
33401>>>    //            Error LastErr "(IBM CLI)Database alias name or Database name not found"
33401>>>    //            Set LoginOk to False
33401>>>    //           Send Exit_Application
33401>>>    //      End
33401>>>            Set LoginOk to True
33402>>>    //        If (UpperCase(LoginDriver##) = "ORA_DRV") Begin
33402>>>    //            GET_MAX_OPEN_CURSORS of LoginServer## to liOpenCursors
33402>>>    //            If (liOpenCursors <> 0) SET_MAX_OPEN_CURSORS of LoginServer## to (liOpenCursors+2)
33402>>>    //        End
33402>>>        End
33402>>>>
33402>>>        Else Begin
33403>>>            Set LoginOk to True
33404>>>            Open "Users" as Users
INCLUDING FILE: USERS.FD
33406>>>            Move "DATAFLEX" To LoginDriver##
33407>>>            Move "" to LoginServer##
33408>>>            File_Size Users to Size##
33411>>>            If Size## ne 0 Begin
33413>>>                 Clear Users
33414>>>                 Move LoginUSerId##   to Users.Login_Id
33415>>>                 Find eq Users by Index.1
33416>>>>
33416>>>                 [Finderr] Begin
33418>>>>
33418>>>                    Error 25000 "Unknown User"
33419>>>>
33419>>>                    Set LoginOk to False
33420>>>                    Get LoginOk to PasswordOk
33421>>>                    Function_Return PasswordOk
33422>>>                 End
33422>>>>
33422>>>                 [Found] Begin
33424>>>>
33424>>>                    If (LoginPassword## ne Users.Password) Begin
33426>>>                        Error 25000 "Invalid Password"
33427>>>>
33427>>>                        Set LoginOk to False
33428>>>                        Get LoginOk to PasswordOk
33429>>>                        Function_Return PasswordOk
33430>>>                    End
33430>>>>
33430>>>                    Else Move Users.Departm_Code to sDepartment
33432>>>                    Move (Trim(sDepartment)) to sDepartment
33433>>>                 End
33433>>>>
33433>>>            End
33433>>>>
33433>>>            Close Users
33434>>>
33434>>>
33434>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33434>>>    //            Integer bFileExists
33434>>>    //            Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33434>>>    //            If (NOT(bFileExists)) Begin
33434>>>
33434>>>    //                Get Get_File_Exists  "C:\UsrLogin.txt" To bFileExists
33434>>>    //                If (bFileExists) Begin
33434>>>
33434>>>    ////                        If Size## ne 0 Begin
33434>>>
33434>>>    //                            Local String ss1 ss2 ss3 ss4
33434>>>    //                            Local String dd1 dd2 dd3 dd4
33434>>>    //                            Move '' to dd1
33434>>>    //                            Move '' to dd2
33434>>>    //                            Move '' to dd3
33434>>>    //                            Move '' to dd4
33434>>>
33434>>>    //                            Direct_Input Channel 8 "C:\UsrLogin.txt"
33434>>>    //                            Readln Channel 8 ss1 ss2 ss3 ss4
33434>>>    //                            While (Not(Seqeof))
33434>>>    //                                Move (Trim(ss1)) to ss1
33434>>>    //                                Move (Trim(ss2)) to ss2
33434>>>    //                                Move (Trim(ss3)) to ss3
33434>>>    //                                Move (Trim(ss4)) to ss4
33434>>>    //                                Append dd1 '"' ss1 '"'
33434>>>    //                                Append dd2 '"' ss2 '"'
33434>>>    //                                Append dd3 '"' ss3 '"'
33434>>>    //                                Append dd4 '"' ss4 '"'
33434>>>    //                                Login dd1 dd2 dd3 dd4
33434>>>    //                                Readln Channel 8 ss1 ss2 ss3 ss4
33434>>>    //                            Loop
33434>>>
33434>>>
33434>>>    ////                            // Only Filmnet Users Log on to SQL
33434>>>    ////                            If (sDepartment='FILMNET') Begin
33434>>>    ////                                ////// 20/06/2001 js Allagh apo Oracle se SQL server
33434>>>    ////                                ////// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33434>>>    ////                                login '192.168.128.5'   'sa'    ''   'SQL_DRV'
33434>>>    ////                                login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33434>>>    ////                            End
33434>>>    ////                            Else login '192.168.128.5'      'sa'    ''   'SQL_DRV'
33434>>>    ////                            //Else login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33434>>>
33434>>>    ////                        End
33434>>>    ////                        Else Begin
33434>>>    ////                            ////// 20/06/2001 js Allagh apo Oracle se SQL server
33434>>>    ////                            ///// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33434>>>    ////                            login '192.168.128.5'       'sa'    ''   'SQL_DRV'
33434>>>    ////                            //login '192.168.128.5'   'EPGDNS'    'DNS'   'SQL_DRV'
33434>>>    ////                            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33434>>>    ////                        End
33434>>>
33434>>>
33434>>>    //                End
33434>>>
33434>>>    //            End
33434>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33434>>>
33434>>>
33434>>>
33434>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33434>>>            //*Integer bFileExists
33434>>>            //*Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33434>>>            //*If (NOT(bFileExists)) Begin
33434>>>            //*    If Size## ne 0 Begin
33434>>>            //*        // Only Filmnet Users Log on to SQL
33434>>>            //*        If (sDepartment='FILMNET') Begin
33434>>>            //*            login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33434>>>            //*            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33434>>>            //*        End
33434>>>            //*        Else login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33434>>>            //*    End
33434>>>            //*    Else Begin
33434>>>            //*        login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33434>>>            //*        login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33434>>>            //*    End
33434>>>            //*
33434>>>            //*End
33434>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33434>>>
33434>>>
33434>>>
33434>>>        End
33434>>>>
33434>>>
33434>>>        Open Users
33436>>>        //Open "Users" as Users
33436>>>        File_Size Users to Size##
33439>>>        If Size## ne 0 Begin
33441>>>             Clear Users
33442>>>             Move LoginUSerId##   to Users.Login_Id
33443>>>             Find eq Users by Index.1
33444>>>>
33444>>>             [Finderr] Begin
33446>>>>
33446>>>                Error 25000 "Unknown User"
33447>>>>
33447>>>                Set LoginOk to False
33448>>>                Get LoginOk to PasswordOk
33449>>>                Function_Return PasswordOk
33450>>>             End
33450>>>>
33450>>>             [Found] Begin
33452>>>>
33452>>>                If (LoginPassword## ne Users.Password) Begin
33454>>>                    Error 25000 "Invalid Password"
33455>>>>
33455>>>                    Set LoginOk to False
33456>>>                    Get LoginOk to PasswordOk
33457>>>                    Function_Return PasswordOk
33458>>>                End
33458>>>>
33458>>>                Else Move Users.Departm_Code to sDepartment
33460>>>                Move (Trim(sDepartment)) to sDepartment
33461>>>             End
33461>>>>
33461>>>        End
33461>>>>
33461>>>        Close Users
33462>>>
33462>>>        Get LoginOk to PasswordOk
33463>>>        Sysdate lsLoginDate lsHH lsMM lsSS
33467>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33470>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33473>>>        insert "WorkSpaces\" in LastLogin## at 1
33475>>>        get_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33478>>>        If ((LoginDriver## ne "") and ((UpperCase(LoginDriver##)) ne "DATAFLEX")) Begin
33480>>>           If Not LoginDriver## in LoginSeq## Begin
33482>>>                 If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33485>>>                 Else Move (LoginSeq##+"|"+LoginDriver##) to LoginSeq##
33487>>>                 set_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33490>>>           End
33490>>>>
33490>>>        End
33490>>>>
33490>>>        Append LastLogin## "\" (Module_Name(Self))
33492>>>        Append LastLogin## "\LastLogin"
33493>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33496>>>
33496>>>        If "|" in LoginSeq## Begin
33498>>>            If ((left(LoginSeq##,(pos("|",LoginSeq##) -1))) ne LoginDriver##) Insert (LoginDriver##+"|") in LoginSeq## at 1
33502>>>        End
33502>>>>
33502>>>        Else Begin
33503>>>            If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33506>>>            Else If LoginSeq## ne LoginDriver## Insert (LoginDriver##+"|") in LoginSeq## at 1
33511>>>        End
33511>>>>
33511>>>        Left LoginSeq## to LoginSeq## 250
33513>>>>
33513>>>        set_profile_string LastLogin## "LoginDriver" to (UpperCase(LoginSeq##))
33516>>>        set_profile_string LastLogin## "LoginServer" to LoginServer##
33519>>>        set_profile_string LastLogin## "LoginUserId" to LoginUserId##
33522>>>        set_profile_string LastLogin## "SavePassword" to SavePassword##
33525>>>        If lsHH lt 10 Insert 0 in lsHH at 1
33529>>>        If lsMM lt 10 Insert 0 in lsMM at 1
33533>>>        If lsSS lt 10 Insert 0 in lsSS at 1
33537>>>        Append lsLoginDate " - " lsHH ":" lsMM ":" lsSS
33543>>>        set_profile_string LastLogin## "LoginTime" to lsLoginDate
33546>>>        If (SavePassword##) Begin
33548>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33549>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to (fsCrypto(Self,"forward",LoginPassword##))
33552>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33553>>>        End
33553>>>>
33553>>>        Else Begin
33554>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33555>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to ""
33558>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33559>>>        End
33559>>>>
33559>>>
33559>>>        Function_Return PasswordOk
33560>>>    End_Function
33561>>>
33561>>>    Procedure Login For Desktop
33562>>>        Local Integer LoginPassword##
33563>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33564>>>        If Not LoginPassword## Send Exit_Application
33567>>>    End_Procedure
33568>>>
33568>>>    Function CheckLogin For Desktop Returns Integer
33569>>>        Local Integer LoginPassword##
33570>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33571>>>        Function_Return LoginPassword##
33572>>>    End_Function
33573>>>
33573>>>
33573>>>
33573>>>
33573>>>
33573>>>
33573>>>    //AB-StoreEnd
33573>>>
33573>>>End_Object    // Connect
33574>>>
33574>>>
33574>>>//AB-StoreStart
33574>>>
33574>>>
33574>>>
33574>>>//AB-StoreEnd
33574>>>
33574>>>//AB/ End_Object    // prj
33574>use checkafm.pkg
INCLUDING FILE: CHECKAFM.PKG
33574>>>
33574>>>
33574>>>Function Check_Afm Global String Afm_Num Returns Integer
33575>>>    Integer iii Num1 Num2
33576>>>
33576>>>    Move (Trim(Afm_Num)) To Afm_Num
33577>>>
33577>>>    For iii From 1 To (Length(Trim(Afm_Num)))
33583>>>>
33583>>>        If Not (Mid(Afm_Num,1,iii)) In  "0123456789" Function_Return 3
33586>>>    Loop
33587>>>>
33587>>>
33587>>>    Move (Right(Afm_Num,1)) to Num2
33588>>>
33588>>>    If (Length(Afm_Num)<>9) Function_Return 2
33591>>>
33591>>>    Move 0 to Num1
33592>>>
33592>>>    For iii From 1 to 8
33598>>>>
33598>>>        Add ((Mid(Afm_Num,1,iii)) * (2 ^ (9 - iii))) to Num1
33599>>>    Loop
33600>>>>
33600>>>
33600>>>    Move (Mod(Num1,11)) to Num1
33601>>>    If (Num1=10) Move 0 to Num1
33604>>>
33604>>>    If (Num1=Num2)  Function_Return 0
33607>>>    Else            Function_Return 1
33609>>>End_Function
33610>>>
33610>use checklog.pkg
INCLUDING FILE: CHECKLOG.PKG
33610>>>open syscurgl
INCLUDING FILE: SYSCURGL.FD
33612>>>open syscurxr
33614>>>open gplan
INCLUDING FILE: GPLAN.FD
33616>>>//open gplanl
33616>>>open iteml
INCLUDING FILE: ITEML.FD
33618>>>open cn
INCLUDING FILE: CN.FD
33620>>>open payresp
INCLUDING FILE: PAYRESP.FD
33622>>>open salesmen
INCLUDING FILE: SALESMEN.FD
33624>>>open mhxanik
INCLUDING FILE: MHXANIK.FD
33626>>>open constrct
INCLUDING FILE: CONSTRCT.FD
33628>>>open clients
INCLUDING FILE: CLIENTS.FD
33630>>>open wtypkin
INCLUDING FILE: WTYPKIN.FD
33632>>>open wax
INCLUDING FILE: WAX.FD
33634>>>Function Check_log Global String slog Returns Integer
33635>>>    clear gplan
33636>>>    move syscurxr.company_code to gplan.company_code
33637>>>    move syscurxr.branch_code  to gplan.branch_code
33638>>>    move syscurxr.year_year    to gplan.year_year
33639>>>    move slog                  to gplan.gplan_code
33640>>>    find eq gplan by index.1
33641>>>>
33641>>>    if (found=1) function_return 0
33644>>>    else         function_return 1
33646>>>
33646>>>End_Function
33647>>>
33647>>>Function Check_last Global String slog Returns Integer
33648>>>    clear gplan
33649>>>    move syscurxr.company_code to gplan.company_code
33650>>>    move syscurxr.branch_code  to gplan.branch_code
33651>>>    move syscurxr.year_year    to gplan.year_year
33652>>>    move slog                  to gplan.gplan_code
33653>>>    find eq gplan by index.1
33654>>>>
33654>>>    if ((found=1) and (Gplan.Gplan_Yn_Last = 1)) Function_Return 0
33657>>>    else                                         Function_return 1
33659>>>
33659>>>End_Function
33660>>>
33660>>>Function fsgplandescr String slog Returns string
33661>>>    clear gplan
33662>>>    move syscurgl.company_code to gplan.company_code
33663>>>    move syscurgl.branch_code  to gplan.branch_code
33664>>>    move syscurgl.year_year    to gplan.year_year
33665>>>    move slog                  to gplan.gplan_code
33666>>>    find eq gplan by index.1
33667>>>>
33667>>>    if (found=1) function_return gplan.gplan_descr1
33670>>>    else         function_return ''
33672>>>
33672>>>End_Function
33673>>>
33673>>>//Function fsgplanperi String slog Returns string
33673>>>//    string sdescr
33673>>>//    clear gplanl
33673>>>//    move syscurgl.company_code to  gplanl.company_code
33673>>>//    move syscurgl.branch_code  to  gplanl.branch_code
33673>>>//    move slog                  to  gplanl.gplan_code
33673>>>//    find eq gplanl by index.1
33673>>>//    if (found=1) begin
33673>>>//        move gplanl.gplan_descr1 to sdescr
33673>>>//        function_return sdescr
33673>>>//    end
33673>>>//    else         function_return ''
33673>>>//End_Function
33673>>>
33673>>>
33673>>>
33673>>>Function fsclient string code Returns string
33674>>>    string name
33675>>>    clear clients
33676>>>    move code to clients.client_id
33677>>>    find eq clients by index.6
33678>>>>
33678>>>    if (found) move clients.client_name to name
33681>>>    else       move '' to name
33683>>>    function_return name
33684>>>end_Function
33685>>>
33685>>>Function fspayresp string code Returns string
33686>>>    string name
33687>>>    clear payresp
33688>>>    move code to payresp.presp_id
33689>>>    find eq payresp by index.7
33690>>>>
33690>>>    if (found) move payresp.presp_name to name
33693>>>    else       move '' to name
33695>>>    function_return name
33696>>>end_Function
33697>>>
33697>>>Function fssalesmen string code Returns string
33698>>>    string name
33699>>>    clear salesmen
33700>>>    move code to salesmen.sls_id
33701>>>    find eq salesmen by index.4
33702>>>>
33702>>>    if (found) move salesmen.sls_name to name
33705>>>    else       move '' to name
33707>>>    function_return name
33708>>>end_Function
33709>>>
33709>>>Function fsconstrct string code Returns string
33710>>>    string name
33711>>>    clear constrct
33712>>>    move code to constrct.cnt_id
33713>>>    find eq constrct by index.5
33714>>>>
33714>>>    if (found) move constrct.cnt_name to name
33717>>>    else       move '' to name
33719>>>    function_return name
33720>>>end_Function
33721>>>
33721>>>Function fsmhxanik string code Returns string
33722>>>    string name
33723>>>    clear mhxanik
33724>>>    move code to mhxanik.mhx_id
33725>>>    find eq mhxanik by index.4
33726>>>>
33726>>>    if (found) move mhxanik.mhx_name to name
33729>>>    else       move '' to name
33731>>>    function_return name
33732>>>end_Function
33733>>>
33733>>>
33733>>>Function fsptyppar string code Returns string
33734>>>    string sdescr
33735>>>    clear ptypparl
INCLUDING FILE: PTYPPARL.FD
33736>>>    move syscurxr.company_code to ptypparl.company_code
33737>>>    move syscurxr.branch_code  to ptypparl.branch_code
33738>>> //   move syscurxr.year_year    to ptypparl.year_year
33738>>>    move code                  to ptypparl.ptyppar_code
33739>>>    find eq ptypparl by index.1
33740>>>>
33740>>>    move ptypparl.ptyppar_descr to sdescr
33741>>>    function_return sdescr
33742>>>end_Function
33743>>>
33743>>>Function fsgplan string code Returns string
33744>>>    string sdescr
33745>>>    clear gplan
33746>>>    move syscurxr.company_code to gplan.company_code
33747>>>    move syscurxr.branch_code  to gplan.branch_code
33748>>>    move syscurxr.year_year    to gplan.year_year
33749>>>    move code                  to gplan.gplan_code
33750>>>    find eq gplan by index.1
33751>>>>
33751>>>    move gplan.gplan_descr1    to sdescr
33752>>>    function_return sdescr
33753>>>end_Function
33754>>>
33754>>>Function fsitem string scode Returns string
33755>>>    clear iteml
33756>>>    move scode to iteml.item_code
33757>>>    find eq iteml by index.5
33758>>>>
33758>>>    function_return iteml.item_descr
33759>>>end_Function
33760>>>
33760>>>Function fswax string srecr Returns string
33761>>>    clear wax
33762>>>    move srecr to wax.wax_recr
33763>>>    find eq wax by index.2
33764>>>>
33764>>>    function_return wax.wax_descr
33765>>>end_Function
33766>>>
33766>>>
33766>>>Function fswitemx string code Returns string
33767>>>    string name
33768>>>    clear witemx
INCLUDING FILE: WITEMX.FD
33769>>>    move syscurxr.company_code to witemx.company_code
33770>>>    move syscurxr.branch_code  to witemx.branch_code
33771>>>    move syscurxr.year_year    to witemx.year_year
33772>>>    move code to witemx.witemx_code
33773>>>    find eq witemx by index.5
33774>>>>
33774>>>    move witemx.witemx_descr to name
33775>>>    function_return name
33776>>>end_Function
33777>>>
33777>>>Function fsCNDescr String asItem Returns String
33778>>>    Clear CN
33779>>>    move asItem to CN.CN_Code
33780>>>    Find Eq CN by Index.5
33781>>>>
33781>>>    Function_Return CN.CN_Descr
33782>>>End_Function
33783>>>
33783>>>Function fswtypkin String askin Returns String
33784>>>    Clear Wtypkin
33785>>>    move askin to Wtypkin.wtypkin_code
33786>>>    Find Eq wtypkin by Index.1
33787>>>>
33787>>>    Function_Return Wtypkin.wtypkin_descr
33788>>>End_Function
33789>>>
33789>>>Function FindGtypkinDescr Integer aiCode Returns String
33790>>>    String lsDescr
33791>>>    Clear Gtypkin
INCLUDING FILE: GTYPKIN.FD
33792>>>    Move syscurxr.company_code    to Gtypkin.Company_Code
33793>>>    Move syscurxr.Branch_Code     to Gtypkin.Branch_Code
33794>>>    Move syscurxr.Year_year       to Gtypkin.Year_Year
33795>>>    Move aiCode                   to Gtypkin.Gtypkin_Code
33796>>>    Find eq Gtypkin by Index.1
33797>>>>
33797>>>    [Found] Move Gtypkin.Gtypkin_Descr to lsDescr
33798>>>    Function_Return lsDescr
33799>>>End_Function // FindGtypkinDescr
33800>>>
33800>>>Function FindBtypkinDescr Integer aiCode Returns String
33801>>>    String lsDescr
33802>>>    Clear Btypkin
INCLUDING FILE: BTYPKIN.FD
33803>>>    Move syscurxr.company_code    to Btypkin.Company_Code
33804>>>    Move syscurxr.Branch_Code     to Btypkin.Branch_Code
33805>>>    Move syscurxr.Year_year       to Btypkin.Year_Year
33806>>>    Move aiCode                   to Btypkin.btypkin_Code
33807>>>    Find eq Btypkin by Index.1
33808>>>>
33808>>>    [Found] Move Btypkin.Btypkin_Descr to lsDescr
33809>>>    Function_Return lsDescr
33810>>>End_Function // FindGtypkinDescr
33811>>>
33811>>>
33811>Send Login
33812>Use Xrhsh.pkg
INCLUDING FILE: XRHSH.PKG
33812>>>//------------------------------
33812>>>Use SelectXr.Dg
INCLUDING FILE: SELECTXR.DG
33812>>>>>//AB/ Project Select / Change Xrhsh
33812>>>>>//AB/ Object prj is a Dialog_Project
33812>>>>>//AB/     Set ProjectName to "Select / Change Xrhsh"
33812>>>>>//AB/     Set ProjectFileName to "SelectXR.DG"
33812>>>>>
33812>>>>>// Project Object Structure
33812>>>>>//   oSelectYear is a dbModalPanelSub
33812>>>>>//     Company_DD is a DataDictionary
33812>>>>>//     Branch_DD is a DataDictionary
33812>>>>>//     Year_DD is a DataDictionary
33812>>>>>//     Company_Company_Code is a dbFormSub
33812>>>>>//     Company_Company_Name is a dbFormSub
33812>>>>>//     Branch_Branch_Code is a dbFormSub
33812>>>>>//     Branch_Branch_Name is a dbFormSub
33812>>>>>//     Year_Year_Year is a dbFormSub
33812>>>>>//     Year_Year_Descr is a dbFormSub
33812>>>>>//     Year_Year_Entrydate is a dbFormSub
33812>>>>>//     oOk_bn is a ButtonSub
33812>>>>>//     oCancel_bn is a ButtonSub
33812>>>>>//     otxtCompany is a TextBoxSub
33812>>>>>//     otxtBranch is a TextBoxSub
33812>>>>>//     otxtYear is a TextBoxSub
33812>>>>>//     otxtWorkingDay is a TextBoxSub
33812>>>>>//     otxtWorkingDay is a TextBoxSub
33812>>>>>//     chkxr is a CheckBoxSub
33812>>>>>
33812>>>>>// Register all objects
33812>>>>>Register_Object Branch_Branch_Code
33812>>>>>Register_Object Branch_Branch_Name
33812>>>>>Register_Object Branch_DD
33812>>>>>Register_Object Company_Company_Code
33812>>>>>Register_Object Company_Company_Name
33812>>>>>Register_Object Company_DD
33812>>>>>Register_Object chkxr
33812>>>>>Register_Object oCancel_bn
33812>>>>>Register_Object oOk_bn
33812>>>>>Register_Object oSelectYear
33812>>>>>Register_Object otxtBranch
33812>>>>>Register_Object otxtCompany
33812>>>>>Register_Object otxtWorkingDay
33812>>>>>Register_Object otxtYear
33812>>>>>Register_Object Year_DD
33812>>>>>Register_Object Year_Year_Descr
33812>>>>>Register_Object Year_Year_Entrydate
33812>>>>>Register_Object Year_Year_Year
33812>>>>>
33812>>>>>
33812>>>>>
33812>>>>>//AB-StoreTopStart
33812>>>>>
33812>>>>>
33812>>>>>
33812>>>>>
33812>>>>>       String  gs_selected_beto_site
33812>>>>>
33812>>>>>Open SysCurXR
33814>>>>>Open Nomisma
33816>>>>>
33816>>>>>//AB-StoreTopEnd
33816>>>>>
33816>>>>>//AB-IgnoreStart
33816>>>>>
33816>>>>>Use DFAllEnt.pkg
33816>>>>>Use dbForm.Sub
33816>>>>>Use Button.Sub
33816>>>>>Use Txtbox.Sub
33816>>>>>Use Chkbox.Sub
33816>>>>>
33816>>>>>
33816>>>>>Use COMPANY.DD
INCLUDING FILE: COMPANY.DD
33816>>>>>>>//DDB-FileStart
33816>>>>>>>//DDB-HeaderStart
33816>>>>>>>
33816>>>>>>>// File Name : COMPANY.DD
33816>>>>>>>// Class Name: Company_DataDictionary
33816>>>>>>>// Revision  : 64
33816>>>>>>>// Version   : 2
33816>>>>>>>
33816>>>>>>>Use  Windows           // Basic Definitions
33816>>>>>>>Use  DataDict          // DataDictionary Class Definition
33816>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33816>>>>>>>
33816>>>>>>>Open Company
33818>>>>>>>Open Branch
33820>>>>>>>
33820>>>>>>>//DDB-HeaderEnd
33820>>>>>>>//DDB-ValidationStart
33820>>>>>>>
33820>>>>>>>Register_Object Company_Company_Doy_VT
33820>>>>>>>Register_Object Company_Company_J_Code_VT
33820>>>>>>>
33820>>>>>>>Object Company_Company_Doy_VT  is a CodeValidationTable
33822>>>>>>>    Set Type_Value        To "DOY"
33823>>>>>>>    Set Allow_Blank_State To TRUE
33824>>>>>>>    //DDB-ValidationCustomStart
33824>>>>>>>    //DDB-ValidationCustomEnd
33824>>>>>>>End_Object   // Company_Company_Doy_VT
33825>>>>>>>
33825>>>>>>>Object Company_Company_J_Code_VT  is a CodeValidationTable
33827>>>>>>>    Set Type_Value        To "JOB"
33828>>>>>>>    Set Allow_Blank_State To TRUE
33829>>>>>>>    //DDB-ValidationCustomStart
33829>>>>>>>    //DDB-ValidationCustomEnd
33829>>>>>>>End_Object   // Company_Company_J_Code_VT
33830>>>>>>>//DDB-ValidationEnd
33830>>>>>>>//DDB-SelectionStart
33830>>>>>>>//DDB/ ExternalSelectionList sl001  sl001.sl
33830>>>>>>>Register_Object sl001
33830>>>>>>>//DDB-SelectionEnd
33830>>>>>>> 
33830>>>>>>>Class Company_DataDictionary  is a DataDictionary
33831>>>>>>> 
33831>>>>>>>    // Update:
33831>>>>>>> 
33831>>>>>>>    Procedure Update
33832>>>>>>>        Forward Send Update
33834>>>>>>>        move 'DOY' to company.doy_type
33835>>>>>>>        move 'JOB' to company.jcode_type 
33836>>>>>>>        // Insert Code Here
33836>>>>>>>    End_Procedure   // Update
33837>>>>>>> 
33837>>>>>>>
33837>>>>>>>    // Operation_Not_Allowed:
33837>>>>>>>
33837>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33838>>>>>>>        // Insert Code Here
33838>>>>>>>        Case Begin
33838>>>>>>>             Case (iError_Num = 1001)
33840>>>>>>>                  Error 1001 "DDC 051:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª „«˜ ¨œå˜ª!\n\n‰œ¤æª ‰à› ¡æª"
33841>>>>>>>>
33841>>>>>>>             Case Break
33842>>>>>>>
33842>>>>>>>             Case Else
33842>>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33844>>>>>>>        Case End
33844>>>>>>>    End_Procedure   // Operation_Not_Allowed
33845>>>>>>>
33845>>>>>>>
33845>>>>>>>    // Validate_Save:
33845>>>>>>>
33845>>>>>>>    Function Validate_Save  Returns Integer
33846>>>>>>>        Local Integer iReturnVal
33847>>>>>>>        Forward Get Validate_Save  To iReturnVal
33849>>>>>>>        If (Not(iReturnVal)) Begin
33851>>>>>>>            // Insert Code Here
33851>>>>>>>            If (Company.Company_Code="") Send Operation_Not_Allowed 1001
33854>>>>>>>        End
33854>>>>>>>>
33854>>>>>>>        Function_Return iReturnVal
33855>>>>>>>    End_Function   // Validate_Save
33856>>>>>>>
33856>>>>>>>
33856>>>>>>>    // Define_Fields:
33856>>>>>>>    // This procedure is used to set up all data-dictionary rules.
33856>>>>>>>
33856>>>>>>>    Procedure Define_Fields
33857>>>>>>>        Forward Send Define_Fields
33859>>>>>>>        //DDB-Generated-Code-Location
33859>>>>>>>        //DDB-DefineFieldStart
33859>>>>>>>
33859>>>>>>>        Set Main_File            To Company.File_Number
33860>>>>>>>        Set Cascade_Delete_State To FALSE
33861>>>>>>>
33861>>>>>>>
33861>>>>>>>        // Child (Client) file structure................
33861>>>>>>>        Send Add_Client_File  Branch.File_Number
33862>>>>>>>
33862>>>>>>>        // Field-based properties.......................
33862>>>>>>>
33862>>>>>>>        // Company.Company_Code
33862>>>>>>>        Set Field_Options          Field Company.Company_Code To DD_AUTOFIND   
33863>>>>>>>        Set Field_Prompt_Object    Field Company.Company_Code To (sl001(Self))
33864>>>>>>>
33864>>>>>>>        // Company.Company_Name
33864>>>>>>>        Set Field_Options          Field Company.Company_Name To DD_REQUIRED   
33865>>>>>>>        Set Field_Prompt_Object    Field Company.Company_Name To (sl001(Self))
33866>>>>>>>
33866>>>>>>>        // Company.Company_Afm
33866>>>>>>>        Set Field_Options          Field Company.Company_Afm To DD_AUTOFIND   
33867>>>>>>>
33867>>>>>>>        // Company.Company_Addr
33867>>>>>>>
33867>>>>>>>        // Company.Company_Tk
33867>>>>>>>
33867>>>>>>>        // Company.Company_Poli
33867>>>>>>>
33867>>>>>>>        // Company.Company_Doy
33867>>>>>>>        Set Field_Value_Table      Field Company.Company_Doy To (Company_Company_Doy_VT(Self))
33868>>>>>>>
33868>>>>>>>        // Company.Company_J_Code
33868>>>>>>>        Set Field_Value_Table      Field Company.Company_J_Code To (Company_Company_J_Code_VT(Self))
33869>>>>>>>
33869>>>>>>>        // Company.Company_C_Code0
33869>>>>>>>
33869>>>>>>>        // Company.Company_C_Cod00
33869>>>>>>>
33869>>>>>>>        // Company.Company_C_Coder
33869>>>>>>>
33869>>>>>>>        // Company.Company_Tel
33869>>>>>>>
33869>>>>>>>        // Company.Company_Fax
33869>>>>>>>
33869>>>>>>>        // Company.Company_Email
33869>>>>>>>
33869>>>>>>>        // Company.Company_Resp
33869>>>>>>>
33869>>>>>>>        // Company.Company_Bitmap
33869>>>>>>>
33869>>>>>>>        // Company.Beto_Site
33869>>>>>>>
33869>>>>>>>        // Company.Logo
33869>>>>>>>
33869>>>>>>>        // Company.Doy_Type
33869>>>>>>>
33869>>>>>>>        // Company.Jcode_Type
33869>>>>>>>
33869>>>>>>>        // Company.Sap_Code
33869>>>>>>>
33869>>>>>>>        // Company.Sap_Path
33869>>>>>>>
33869>>>>>>>        //DDB-DefineFieldEnd
33869>>>>>>>    End_Procedure    // Define_Fields
33870>>>>>>>
33870>>>>>>>    // Field_Defaults:
33870>>>>>>>    // This procedure is used to establish default field values.
33870>>>>>>>
33870>>>>>>>    Procedure Field_Defaults
33871>>>>>>>        Forward Send Field_Defaults
33873>>>>>>>        //DDB-Generated-Code-Location
33873>>>>>>>        //DDB-FieldDefaultStart
33873>>>>>>>        //DDB-FieldDefaultEnd
33873>>>>>>>    End_Procedure    // Field_Defaults
33874>>>>>>>End_Class    // Company_DataDictionary
33875>>>>>>>
33875>>>>>>>//DDB-Selection-pkg-Start
33875>>>>>>>
33875>>>>>>>Use sl001.sl         // sl001
INCLUDING FILE: SL001.SL
33875>>>>>>>>>//AB/ Project sl001 : Etairies
33875>>>>>>>>>//AB/     Object prj is a Lookup_Project
33875>>>>>>>>>//AB/         Set ProjectName to "sl001 : Etairies"
33875>>>>>>>>>//AB/         Set ProjectFileName to "sl001.SL"
33875>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
33875>>>>>>>>>
33875>>>>>>>>>// Project Object Structure
33875>>>>>>>>>//   sl001 is a dbModalPanel
33875>>>>>>>>>//     Company_DD is a DataDictionary
33875>>>>>>>>>//     oSelList is a dbList
33875>>>>>>>>>//     oOK_bn is a ButtonSub
33875>>>>>>>>>//     oCancel_bn is a ButtonSub
33875>>>>>>>>>//     oSearch_bn is a ButtonSub
33875>>>>>>>>>
33875>>>>>>>>>// Register all objects
33875>>>>>>>>>Register_Object Company_DD
33875>>>>>>>>>Register_Object oCancel_bn
33875>>>>>>>>>Register_Object oOK_bn
33875>>>>>>>>>Register_Object oSearch_bn
33875>>>>>>>>>Register_Object oSelList
33875>>>>>>>>>Register_Object sl001
33875>>>>>>>>>
33875>>>>>>>>>
33875>>>>>>>>>    //AB-IgnoreStart
33875>>>>>>>>>
33875>>>>>>>>>    Use DFAllEnt.pkg
33875>>>>>>>>>    Use Button.Sub
33875>>>>>>>>>
33875>>>>>>>>>
33875>>>>>>>>>    Use COMPANY.DD
33875>>>>>>>>>    
33875>>>>>>>>>    //AB-IgnoreEnd
33875>>>>>>>>>
33875>>>>>>>>>    CD_Popup_Object sl001 is a dbModalPanel
33894>>>>>>>>>        Set Label to "„«˜ ¨åœª"
33895>>>>>>>>>        Set Size to 148 297
33896>>>>>>>>>        Set Location to 12 27
33897>>>>>>>>>
33897>>>>>>>>>        //AB-DDOStart
33897>>>>>>>>>
33897>>>>>>>>>        Object Company_DD is a Company_DataDictionary
33899>>>>>>>>>        End_Object    // Company_DD
33900>>>>>>>>>
33900>>>>>>>>>        Set Main_DD to (Company_DD(self))
33901>>>>>>>>>        Set Server to (Company_DD(self))
33902>>>>>>>>>
33902>>>>>>>>>        //AB-DDOEnd
33902>>>>>>>>>
33902>>>>>>>>>        Object oSelList is a dbList
33904>>>>>>>>>            Set Main_File to Company.File_Number
33905>>>>>>>>>            Set Size to 105 280
33906>>>>>>>>>            Set Location to 6 6
33907>>>>>>>>>
33907>>>>>>>>>            Begin_Row
33910>>>>>>>>>                Entry_Item Company.Company_code
33911>>>>>>>>>                Entry_Item Company.Company_name
33912>>>>>>>>>                Entry_Item Company.Company_afm
33913>>>>>>>>>            End_Row
33918>>>>>>>>>
33918>>>>>>>>>            Set Form_Width    item 0 to 42
33919>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
33920>>>>>>>>>            
33920>>>>>>>>>            Set Form_Width    item 1 to 150
33921>>>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
33922>>>>>>>>>            
33922>>>>>>>>>            Set Form_Width    item 2 to 80
33923>>>>>>>>>            Set Header_Label  item 2 to "€.”.‹"
33924>>>>>>>>>            
33924>>>>>>>>>        End_Object    // oSelList
33925>>>>>>>>>
33925>>>>>>>>>        Object oOK_bn is a ButtonSub
33927>>>>>>>>>            Set Label to "&„§ ¢¦šã"
33928>>>>>>>>>            Set Location to 115 126
33929>>>>>>>>>
33929>>>>>>>>>            //AB-StoreStart
33929>>>>>>>>>            Procedure OnClick
33931>>>>>>>>>                Send OK To (oSelList(current_object))
33932>>>>>>>>>            End_Procedure
33933>>>>>>>>>            //AB-StoreEnd
33933>>>>>>>>>
33933>>>>>>>>>        End_Object    // oOK_bn
33934>>>>>>>>>
33934>>>>>>>>>        Object oCancel_bn is a ButtonSub
33936>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
33937>>>>>>>>>            Set Location to 115 181
33938>>>>>>>>>
33938>>>>>>>>>            //AB-StoreStart
33938>>>>>>>>>            Procedure OnClick
33940>>>>>>>>>                Send Cancel To (oSelList(current_object))
33941>>>>>>>>>            End_Procedure
33942>>>>>>>>>            //AB-StoreEnd
33942>>>>>>>>>
33942>>>>>>>>>        End_Object    // oCancel_bn
33943>>>>>>>>>
33943>>>>>>>>>        Object oSearch_bn is a ButtonSub
33945>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
33946>>>>>>>>>            Set Location to 115 236
33947>>>>>>>>>
33947>>>>>>>>>            //AB-StoreStart
33947>>>>>>>>>            Procedure OnClick
33949>>>>>>>>>                Send Search To (oSelList(current_object))
33950>>>>>>>>>            End_Procedure
33951>>>>>>>>>            //AB-StoreEnd
33951>>>>>>>>>
33951>>>>>>>>>        End_Object    // oSearch_bn
33952>>>>>>>>>
33952>>>>>>>>>
33952>>>>>>>>>        //AB-StoreStart
33952>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To oOk_bn
33953>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To oCancel_bn
33954>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To oSearch_bn
33955>>>>>>>>>        //AB-StoreEnd
33955>>>>>>>>>
33955>>>>>>>>>    CD_End_Object    // sl001
33957>>>>>>>>>>
33957>>>>>>>>>
33957>>>>>>>>>//AB/     End_Object    // prj
33957>>>>>>>
33957>>>>>>>//DDB-Selection-pkg-End
33957>>>>>>>//DDB-FileEnd
33957>>>>>Use BRANCH.DD
INCLUDING FILE: BRANCH.DD
33957>>>>>>>//DDB-FileStart
33957>>>>>>>//DDB-HeaderStart
33957>>>>>>>
33957>>>>>>>// File Name : BRANCH.DD
33957>>>>>>>// Class Name: Branch_DataDictionary
33957>>>>>>>// Revision  : 96
33957>>>>>>>// Version   : 2
33957>>>>>>>
33957>>>>>>>Use  Windows           // Basic Definitions
33957>>>>>>>Use  DataDict          // DataDictionary Class Definition
33957>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33957>>>>>>>
33957>>>>>>>Open Branch
33959>>>>>>>Open Year
33961>>>>>>>Open Brzones
INCLUDING FILE: BRZONES.FD
33963>>>>>>>Open Tpbranch
INCLUDING FILE: TPBRANCH.FD
33965>>>>>>>Open Company
33967>>>>>>>Open Sysrecg
INCLUDING FILE: SYSRECG.FD
33969>>>>>>>
33969>>>>>>>//DDB-HeaderEnd
33969>>>>>>>//DDB-ValidationStart
33969>>>>>>>
33969>>>>>>>Register_Object Branch_Branch_Doy_VT
33969>>>>>>>Register_Object Branch_Branch_C_Code0_VT
33969>>>>>>>
33969>>>>>>>Object Branch_Branch_Doy_VT  is a CodeValidationTable
33971>>>>>>>    Set Type_Value        To "DOY"
33972>>>>>>>    Set Validate_State    To FALSE
33973>>>>>>>    Set Allow_Blank_State To TRUE
33974>>>>>>>    //DDB-ValidationCustomStart
33974>>>>>>>    //DDB-ValidationCustomEnd
33974>>>>>>>End_Object   // Branch_Branch_Doy_VT
33975>>>>>>>
33975>>>>>>>Object Branch_Branch_C_Code0_VT  is a CodeValidationTable
33977>>>>>>>    Set Type_Value        To ""
33978>>>>>>>    Set Allow_Blank_State To TRUE
33979>>>>>>>    //DDB-ValidationCustomStart
33979>>>>>>>    //DDB-ValidationCustomEnd
33979>>>>>>>End_Object   // Branch_Branch_C_Code0_VT
33980>>>>>>>//DDB-ValidationEnd
33980>>>>>>>//DDB-SelectionStart
33980>>>>>>>//DDB/ ExternalSelectionList SL002  Sl002.sl
33980>>>>>>>Register_Object SL002
33980>>>>>>>//DDB-SelectionEnd
33980>>>>>>>
33980>>>>>>>Class Branch_DataDictionary  is a DataDictionary
33981>>>>>>> 
33981>>>>>>>    Procedure Save_Main_File
33982>>>>>>>        Forward Send Save_Main_File
33984>>>>>>>        // Insert Code Here
33984>>>>>>>    End_Procedure   // Save_Main_File
33985>>>>>>> 
33985>>>>>>>    Procedure Creating
33986>>>>>>>        Forward Send Creating
33988>>>>>>>        // Insert Code Here
33988>>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Branch.Branch_Rec0)))))) to Branch.Branch_Recr
33989>>>>>>>    End_Procedure   // Creating
33990>>>>>>>
33990>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33991>>>>>>>        // Insert Code Here
33991>>>>>>>        Case Begin
33991>>>>>>>             Case (iError_Num = 1001)
33993>>>>>>>                  Error 1001 "DDC 002:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
33994>>>>>>>>
33994>>>>>>>             Case Break
33995>>>>>>>
33995>>>>>>>             Case Else
33995>>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33997>>>>>>>        Case End
33997>>>>>>>    End_Procedure   // Operation_Not_Allowed
33998>>>>>>>
33998>>>>>>>
33998>>>>>>>    // Validate_Save:
33998>>>>>>>
33998>>>>>>>    Function Validate_Save  Returns Integer
33999>>>>>>>        Local Integer iReturnVal
34000>>>>>>>        Forward Get Validate_Save  To iReturnVal
34002>>>>>>>        If (Not(iReturnVal)) Begin
34004>>>>>>>            // Insert Code Here
34004>>>>>>>            If (Branch.Branch_Code="") Send Operation_Not_Allowed 1001
34007>>>>>>>        End
34007>>>>>>>>
34007>>>>>>>        Function_Return iReturnVal
34008>>>>>>>    End_Function   // Validate_Save
34009>>>>>>>
34009>>>>>>>
34009>>>>>>>    // Define_Fields:
34009>>>>>>>    // This procedure is used to set up all data-dictionary rules.
34009>>>>>>>
34009>>>>>>>    Procedure Define_Fields
34010>>>>>>>        Forward Send Define_Fields
34012>>>>>>>        //DDB-Generated-Code-Location
34012>>>>>>>        //DDB-DefineFieldStart
34012>>>>>>>
34012>>>>>>>        Set Main_File            To Branch.File_Number
34013>>>>>>>        Set Cascade_Delete_State To FALSE
34014>>>>>>>
34014>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
34015>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOENTER     DD_FINDREQ    
34016>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
34017>>>>>>>
34017>>>>>>>        // Child (Client) file structure................
34017>>>>>>>        Send Add_Client_File  Year.File_Number
34018>>>>>>>        Send Add_Client_File  Brzones.File_Number
34019>>>>>>>        Send Add_Client_File  Tpbranch.File_Number
34020>>>>>>>
34020>>>>>>>        // Parent (Server) file structure...............
34020>>>>>>>        Send Add_Server_File  Company.File_Number
34021>>>>>>>
34021>>>>>>>        // External (System) file structure.............
34021>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
34022>>>>>>>
34022>>>>>>>        Define_Auto_Increment  Sysrecg.Branch_Rec0  To Branch.Branch_Rec0
34025>>>>>>>
34025>>>>>>>        // Field-based properties.......................
34025>>>>>>>
34025>>>>>>>        // Branch.Company_Code
34025>>>>>>>
34025>>>>>>>        // Branch.Branch_Code
34025>>>>>>>        Set Field_Options          Field Branch.Branch_Code To DD_AUTOFIND   
34026>>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Code To (SL002(Self))
34027>>>>>>>        Set Key_Field_State        Field Branch.Branch_Code To TRUE
34028>>>>>>>
34028>>>>>>>        // Branch.Branch_Rec0
34028>>>>>>>
34028>>>>>>>        // Branch.Branch_Recr
34028>>>>>>>
34028>>>>>>>        // Branch.Branch_Name
34028>>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Name To (SL002(Self))
34029>>>>>>>
34029>>>>>>>        // Branch.Branch_Afm
34029>>>>>>>
34029>>>>>>>        // Branch.Branch_Addr
34029>>>>>>>
34029>>>>>>>        // Branch.Branch_Tk
34029>>>>>>>
34029>>>>>>>        // Branch.Branch_Poli
34029>>>>>>>
34029>>>>>>>        // Branch.Branch_Doy
34029>>>>>>>        Set Field_Value_Table      Field Branch.Branch_Doy To (Branch_Branch_Doy_VT(Self))
34030>>>>>>>
34030>>>>>>>        // Branch.Branch_J_Code
34030>>>>>>>
34030>>>>>>>        // Branch.Branch_C_Code0
34030>>>>>>>        Set Field_Value_Table      Field Branch.Branch_C_Code0 To (Branch_Branch_C_Code0_VT(Self))
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_C_Code00
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_C_Coder
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_Tel
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_Fax
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_Email
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_Resp
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_Bitmap
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_Site
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_Apoth
34031>>>>>>>
34031>>>>>>>        // Branch.Beto_Site
34031>>>>>>>
34031>>>>>>>        // Branch.Path_Exp
34031>>>>>>>
34031>>>>>>>        // Branch.Exp_Txtname
34031>>>>>>>
34031>>>>>>>        // Branch.Send_Phone
34031>>>>>>>
34031>>>>>>>        // Branch.Send_Path_Files
34031>>>>>>>
34031>>>>>>>        // Branch.Send_Path_Conf
34031>>>>>>>
34031>>>>>>>        // Branch.Tomeas_Code
34031>>>>>>>
34031>>>>>>>        // Branch.Ftp_Sec_Retry
34031>>>>>>>
34031>>>>>>>        // Branch.Ftp_Sec_Exit
34031>>>>>>>
34031>>>>>>>        // Branch.Ras_Name
34031>>>>>>>
34031>>>>>>>        // Branch.Ras_Passw
34031>>>>>>>
34031>>>>>>>        // Branch.Ras_Domain
34031>>>>>>>
34031>>>>>>>        // Branch.Last_Hmnia_Ekt
34031>>>>>>>
34031>>>>>>>        // Branch.Deop_Logo
34031>>>>>>>
34031>>>>>>>        // Branch.Entolh
34031>>>>>>>
34031>>>>>>>        // Branch.Paragogh
34031>>>>>>>
34031>>>>>>>        // Branch.Locked_Until
34031>>>>>>>
34031>>>>>>>        // Branch.Sap_Code
34031>>>>>>>
34031>>>>>>>        // Branch.Perioxh
34031>>>>>>>
34031>>>>>>>        // Branch.Egkatastash
34031>>>>>>>
34031>>>>>>>        // Branch.Date_Locked
34031>>>>>>>        Set Field_Mask_Type        Field Branch.Date_Locked To MASK_DATE_WINDOW
34032>>>>>>>
34032>>>>>>>        // Branch.Ypokat1
34032>>>>>>>
34032>>>>>>>        // Branch.Ypokat1a
34032>>>>>>>
34032>>>>>>>        // Branch.Ypokat2
34032>>>>>>>
34032>>>>>>>        // Branch.Edra1
34032>>>>>>>
34032>>>>>>>        // Branch.Edra1a
34032>>>>>>>
34032>>>>>>>        // Branch.Edra2
34032>>>>>>>
34032>>>>>>>        //DDB-DefineFieldEnd
34032>>>>>>>    End_Procedure    // Define_Fields
34033>>>>>>>
34033>>>>>>>    // Field_Defaults:
34033>>>>>>>    // This procedure is used to establish default field values.
34033>>>>>>>
34033>>>>>>>    Procedure Field_Defaults
34034>>>>>>>        Forward Send Field_Defaults
34036>>>>>>>        //DDB-Generated-Code-Location
34036>>>>>>>        //DDB-FieldDefaultStart
34036>>>>>>>        //DDB-FieldDefaultEnd
34036>>>>>>>    End_Procedure    // Field_Defaults
34037>>>>>>>End_Class    // Branch_DataDictionary
34038>>>>>>>
34038>>>>>>>//DDB-Selection-pkg-Start
34038>>>>>>>
34038>>>>>>>Use Sl002.sl         // SL002
INCLUDING FILE: SL002.SL
34038>>>>>>>>>//AB/ Project SL002:Branch
34038>>>>>>>>>//AB/ Object prj is a Lookup_Project
34038>>>>>>>>>//AB/     Set ProjectName to "SL002:Branch"
34038>>>>>>>>>//AB/     Set ProjectFileName to "Sl002.sl"
34038>>>>>>>>>
34038>>>>>>>>>// Project Object Structure
34038>>>>>>>>>//   SL002 is a dbModalPanelSub
34038>>>>>>>>>//     Company_DD is a DataDictionary
34038>>>>>>>>>//     Branch_DD is a DataDictionary
34038>>>>>>>>>//     oSelList is a dbListSub
34038>>>>>>>>>//     oOK_bn is a ButtonSub
34038>>>>>>>>>//     oCancel_bn is a ButtonSub
34038>>>>>>>>>//     oSearch_bn is a ButtonSub
34038>>>>>>>>>
34038>>>>>>>>>// Register all objects
34038>>>>>>>>>Register_Object Branch_DD
34038>>>>>>>>>Register_Object Company_DD
34038>>>>>>>>>Register_Object oCancel_bn
34038>>>>>>>>>Register_Object oOK_bn
34038>>>>>>>>>Register_Object oSearch_bn
34038>>>>>>>>>Register_Object oSelList
34038>>>>>>>>>Register_Object SL002
34038>>>>>>>>>
34038>>>>>>>>>
34038>>>>>>>>>//AB-IgnoreStart
34038>>>>>>>>>
34038>>>>>>>>>Use DFAllEnt.pkg
34038>>>>>>>>>Use dbList.Sub
34038>>>>>>>>>Use Button.Sub
34038>>>>>>>>>
34038>>>>>>>>>
34038>>>>>>>>>Use COMPANY.DD
34038>>>>>>>>>Use BRANCH.DD
34038>>>>>>>>>
34038>>>>>>>>>//AB-IgnoreEnd
34038>>>>>>>>>
34038>>>>>>>>>Object SL002 is a dbModalPanelSub
34040>>>>>>>>>
34040>>>>>>>>>    //AB-StoreTopStart
34040>>>>>>>>>    Property String psFragmaCompanyCode  ""
34042>>>>>>>>>    
34042>>>>>>>>>    //AB-StoreTopEnd
34042>>>>>>>>>
34042>>>>>>>>>    Set Minimize_Icon to FALSE
34043>>>>>>>>>    Set Label to "“§¦¡˜«˜©«ã£˜«˜"
34044>>>>>>>>>    Set Size to 146 430
34045>>>>>>>>>    Set Location to 4 5
34046>>>>>>>>>    Set Exit_Application_Local_State to FALSE
34047>>>>>>>>>    Set Modal_State to FALSE
34048>>>>>>>>>
34048>>>>>>>>>    //AB-DDOStart
34048>>>>>>>>>
34048>>>>>>>>>    Object Company_DD is a Company_DataDictionary
34050>>>>>>>>>    End_Object    // Company_DD
34051>>>>>>>>>
34051>>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
34053>>>>>>>>>        Set DDO_Server to (Company_DD(self))
34054>>>>>>>>>
34054>>>>>>>>>        //AB-StoreStart
34054>>>>>>>>>        Procedure OnConstrain
34056>>>>>>>>>             String lsCompanyCode
34057>>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
34058>>>>>>>>>             If (lsCompanyCode <> "") Constrain Branch.Company_code eq lsCompanyCode
34062>>>>>>>>>        End_Procedure // OnConstrain
34063>>>>>>>>>        
34063>>>>>>>>>        
34063>>>>>>>>>        
34063>>>>>>>>>        //AB-StoreEnd
34063>>>>>>>>>
34063>>>>>>>>>    End_Object    // Branch_DD
34064>>>>>>>>>
34064>>>>>>>>>    Set Main_DD to (Branch_DD(self))
34065>>>>>>>>>    Set Server to (Branch_DD(self))
34066>>>>>>>>>
34066>>>>>>>>>    //AB-DDOEnd
34066>>>>>>>>>
34066>>>>>>>>>    Object oSelList is a dbListSub
34068>>>>>>>>>        Set Main_File to Branch.File_Number
34069>>>>>>>>>        Set Size to 105 415
34070>>>>>>>>>        Set Location to 6 6
34071>>>>>>>>>
34071>>>>>>>>>        Begin_Row
34074>>>>>>>>>            Entry_Item Branch.Branch_code
34075>>>>>>>>>            Entry_Item Branch.Branch_name
34076>>>>>>>>>            Entry_Item Company.Company_code
34077>>>>>>>>>            Entry_Item Company.Company_name
34078>>>>>>>>>            Entry_Item Branch.Beto_site
34079>>>>>>>>>            Entry_Item Branch.Branch_recr
34080>>>>>>>>>        End_Row
34085>>>>>>>>>
34085>>>>>>>>>        Set Form_Width    item 0 to 60
34086>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
34087>>>>>>>>>        
34087>>>>>>>>>        Set Form_Width    item 1 to 128
34088>>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜"
34089>>>>>>>>>        
34089>>>>>>>>>        Set Form_Width    item 2 to 69
34090>>>>>>>>>        Set Header_Label  item 2 to "‰à› ¡æª „«˜ ¨å˜ª"
34091>>>>>>>>>        
34091>>>>>>>>>        Set Form_Width    item 3 to 109
34092>>>>>>>>>        Set Header_Label  item 3 to "Ž¤¦£˜ „«˜ ¨å˜ª"
34093>>>>>>>>>        
34093>>>>>>>>>        Set Form_Width    item 4 to 42
34094>>>>>>>>>        Set Header_Label  item 4 to "Site"
34095>>>>>>>>>        
34095>>>>>>>>>        Set Form_Width    item 5 to 0
34096>>>>>>>>>        Set Header_Label  item 5 to ""
34097>>>>>>>>>        
34097>>>>>>>>>
34097>>>>>>>>>        //AB-StoreStart
34097>>>>>>>>>                
34097>>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
34099>>>>>>>>>        
34099>>>>>>>>>        Procedure Store_Defaults
34101>>>>>>>>>            forward send Store_Defaults
34103>>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
34104>>>>>>>>>        end_Procedure // Store_Defaults
34105>>>>>>>>>        
34105>>>>>>>>>        Procedure Restore_Defaults
34107>>>>>>>>>            forward send Restore_Defaults
34109>>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
34110>>>>>>>>>        end_Procedure // Restore_Defaults
34111>>>>>>>>>        
34111>>>>>>>>>        Procedure Activating
34113>>>>>>>>>            Forward Send Activating
34115>>>>>>>>>            Send Rebuild_Constraints to (Branch_DD(self))
34116>>>>>>>>>        End_Procedure // Activating
34117>>>>>>>>>        
34117>>>>>>>>>        Set Column_Options Item 5 to NoEnter True
34118>>>>>>>>>        
34118>>>>>>>>>        
34118>>>>>>>>>        //AB-StoreEnd
34118>>>>>>>>>
34118>>>>>>>>>    End_Object    // oSelList
34119>>>>>>>>>
34119>>>>>>>>>    Object oOK_bn is a ButtonSub
34121>>>>>>>>>        Set Label to "&„§ ¢¦šã"
34122>>>>>>>>>        Set Location to 112 262
34123>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34124>>>>>>>>>
34124>>>>>>>>>        //AB-StoreStart
34124>>>>>>>>>        Procedure OnClick
34126>>>>>>>>>            Send OK To (oSelList(current_object))
34127>>>>>>>>>        End_Procedure
34128>>>>>>>>>        //AB-StoreEnd
34128>>>>>>>>>
34128>>>>>>>>>    End_Object    // oOK_bn
34129>>>>>>>>>
34129>>>>>>>>>    Object oCancel_bn is a ButtonSub
34131>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
34132>>>>>>>>>        Set Location to 112 317
34133>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34134>>>>>>>>>
34134>>>>>>>>>        //AB-StoreStart
34134>>>>>>>>>        Procedure OnClick
34136>>>>>>>>>            Send Cancel To (oSelList(current_object))
34137>>>>>>>>>        End_Procedure
34138>>>>>>>>>        //AB-StoreEnd
34138>>>>>>>>>
34138>>>>>>>>>    End_Object    // oCancel_bn
34139>>>>>>>>>
34139>>>>>>>>>    Object oSearch_bn is a ButtonSub
34141>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
34142>>>>>>>>>        Set Location to 112 372
34143>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34144>>>>>>>>>
34144>>>>>>>>>        //AB-StoreStart
34144>>>>>>>>>        Procedure OnClick
34146>>>>>>>>>            Send Search To (oSelList(current_object))
34147>>>>>>>>>        End_Procedure
34148>>>>>>>>>        //AB-StoreEnd
34148>>>>>>>>>
34148>>>>>>>>>    End_Object    // oSearch_bn
34149>>>>>>>>>
34149>>>>>>>>>
34149>>>>>>>>>    //AB-StoreStart
34149>>>>>>>>>    
34149>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
34150>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
34151>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
34152>>>>>>>>>    
34152>>>>>>>>>    
34152>>>>>>>>>    
34152>>>>>>>>>    //AB-StoreEnd
34152>>>>>>>>>
34152>>>>>>>>>End_Object    // SL002
34153>>>>>>>>>
34153>>>>>>>>>//AB/ End_Object    // prj
34153>>>>>>>
34153>>>>>>>//DDB-Selection-pkg-End
34153>>>>>>>//DDB-FileEnd
34153>>>>>Use YEAR.DD
INCLUDING FILE: YEAR.DD
34153>>>>>>>//DDB-FileStart
34153>>>>>>>//DDB-HeaderStart
34153>>>>>>>
34153>>>>>>>// File Name : YEAR.DD
34153>>>>>>>// Class Name: Year_DataDictionary
34153>>>>>>>// Revision  : 119
34153>>>>>>>// Version   : 2
34153>>>>>>>
34153>>>>>>>Use  Windows           // Basic Definitions
34153>>>>>>>Use  DataDict          // DataDictionary Class Definition
34153>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
34153>>>>>>>
34153>>>>>>>Open Year
34155>>>>>>>Open Branch
34157>>>>>>>Open Syscurxr
34159>>>>>>>
34159>>>>>>>//DDB-HeaderEnd
34159>>>>>>>//DDB-ValidationStart
34159>>>>>>>
34159>>>>>>>Register_Object Year_Year_C_Code0_VT1
34159>>>>>>>Register_Object Year_Year_C_Code00_VT1
34159>>>>>>>Register_Object Year_Year_C_Coder_VT1
34159>>>>>>>
34159>>>>>>>Object Year_Year_C_Code0_VT1  is a CodeValidationTable
34161>>>>>>>    Set Type_Value        To "CURRENCY"
34162>>>>>>>    //DDB-ValidationCustomStart
34162>>>>>>>    //DDB-ValidationCustomEnd
34162>>>>>>>End_Object   // Year_Year_C_Code0_VT1
34163>>>>>>>
34163>>>>>>>Object Year_Year_C_Code00_VT1  is a CodeValidationTable
34165>>>>>>>    Set Type_Value        To "CURRENCY"
34166>>>>>>>    //DDB-ValidationCustomStart
34166>>>>>>>    //DDB-ValidationCustomEnd
34166>>>>>>>End_Object   // Year_Year_C_Code00_VT1
34167>>>>>>>
34167>>>>>>>Object Year_Year_C_Coder_VT1  is a CodeValidationTable
34169>>>>>>>    Set Type_Value        To "CURRENCY"
34170>>>>>>>    //DDB-ValidationCustomStart
34170>>>>>>>    //DDB-ValidationCustomEnd
34170>>>>>>>End_Object   // Year_Year_C_Coder_VT1
34171>>>>>>>//DDB-ValidationEnd
34171>>>>>>>//DDB-SelectionStart
34171>>>>>>>//DDB/ ExternalSelectionList SL003  Sl003.sl
34171>>>>>>>Register_Object SL003
34171>>>>>>>//DDB-SelectionEnd
34171>>>>>>>            
34171>>>>>>>Class Year_DataDictionary  is a DataDictionary
34172>>>>>>>    
34172>>>>>>>    Procedure Creating
34173>>>>>>>        Forward Send Creating
34175>>>>>>>        // Insert Code Here
34175>>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Year.Year_Year)))))) to Year.Year_Recr
34176>>>>>>>    End_Procedure   // Creating
34177>>>>>>>
34177>>>>>>>
34177>>>>>>>    // Operation_Not_Allowed:
34177>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
34178>>>>>>>        // Insert Code Here
34178>>>>>>>        Case Begin    
34178>>>>>>>             Case (iError_Num = 1001)
34180>>>>>>>                  Error 1001 "DDC 053:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
34181>>>>>>>>
34181>>>>>>>             Case Break
34182>>>>>>>             Case (iError_Num=1002)
34185>>>>>>>                Error 1002 "DDC 053:Branch Site ¡˜«œ™˜å¤œ  ©«¦ Year ¡œ¤æ"
34186>>>>>>>>
34186>>>>>>>             Case Break
34187>>>>>>>             Case (iError_Num=1003)
34190>>>>>>>                Error 1003 "DDC 053:Company Code=0"
34191>>>>>>>>
34191>>>>>>>             Case Break
34192>>>>>>>             Case (iError_Num=1004)
34195>>>>>>>                Error 1004 "DDC 053:Branch Code=0"
34196>>>>>>>>
34196>>>>>>>             Case Break
34197>>>>>>>             Case Else
34197>>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
34199>>>>>>>        Case End
34199>>>>>>>    End_Procedure   // Operation_Not_Allowed
34200>>>>>>>
34200>>>>>>>
34200>>>>>>>    // Update:
34200>>>>>>>    // Use this message to effect changes in related-to files. The
34200>>>>>>>    // Backout message should be designed to reverse the effects of this
34200>>>>>>>    // message. It is invoked while the database is locked.
34200>>>>>>>
34200>>>>>>>    Procedure Update
34201>>>>>>>        Forward Send Update
34203>>>>>>>        // Insert Code Here
34203>>>>>>>        Move Company.Company_Code   to Year.Company_Code
34204>>>>>>>        Move Branch.Branch_Code     to Year.Branch_Code
34205>>>>>>>        move branch.beto_site       to year.beto_site
34206>>>>>>>
34206>>>>>>>        //sos:parametrika apo sysfile?
34206>>>>>>>       
34206>>>>>>>       // If ((Year.Year_EntryDate-14) < Year.Year_XrhshFrom) Begin
34206>>>>>>>       //     Move Year.Year_XrhshFrom to Year.Year_OpenFrom
34206>>>>>>>       // End
34206>>>>>>>       // Else Begin
34206>>>>>>>       //     Move (Year.Year_EntryDate-14) to Year.Year_OpenFrom
34206>>>>>>>       // End
34206>>>>>>>      //  Move Year.Year_EntryDate      to Year.Year_OpenTo
34206>>>>>>>    End_Procedure   // Update
34207>>>>>>>
34207>>>>>>>    // Validate_Save:
34207>>>>>>>
34207>>>>>>>    Function Validate_Save  Returns Integer
34208>>>>>>>        Local Integer iReturnVal
34209>>>>>>>        Forward Get Validate_Save  To iReturnVal
34211>>>>>>>        If (Not(iReturnVal)) Begin
34213>>>>>>>                 If (Year.Year_Year   = 0) Send Operation_Not_Allowed 1001
34216>>>>>>>            Else If (Year.Company_Code='') Send Operation_Not_Allowed 1003
34220>>>>>>>            Else If (Year.Branch_Code ='') Send Operation_Not_Allowed 1004
34224>>>>>>>        End
34224>>>>>>>>
34224>>>>>>>        Function_Return iReturnVal
34225>>>>>>>    End_Function   // Validate_Save
34226>>>>>>>
34226>>>>>>>
34226>>>>>>>    // Define_Fields:
34226>>>>>>>    // This procedure is used to set up all data-dictionary rules.
34226>>>>>>>
34226>>>>>>>    Procedure Define_Fields
34227>>>>>>>        Forward Send Define_Fields
34229>>>>>>>        //DDB-Generated-Code-Location
34229>>>>>>>        //DDB-DefineFieldStart
34229>>>>>>>
34229>>>>>>>        Set Main_File            To Year.File_Number
34230>>>>>>>        Set Cascade_Delete_State To FALSE
34231>>>>>>>
34231>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
34232>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
34233>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
34234>>>>>>>
34234>>>>>>>        // Parent (Server) file structure...............
34234>>>>>>>        Send Add_Server_File  Branch.File_Number
34235>>>>>>>
34235>>>>>>>        // External (System) file structure.............
34235>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
34236>>>>>>>
34236>>>>>>>        // Field-based properties.......................
34236>>>>>>>
34236>>>>>>>        // Year.Company_Code
34236>>>>>>>
34236>>>>>>>        // Year.Branch_Code
34236>>>>>>>
34236>>>>>>>        // Year.Year_Year
34236>>>>>>>        Set Field_Options          Field Year.Year_Year To DD_AUTOFIND    DD_REQUIRED   
34237>>>>>>>        Set Field_Prompt_Object    Field Year.Year_Year To (SL003(Self))
34238>>>>>>>        Set Key_Field_State        Field Year.Year_Year To TRUE
34239>>>>>>>
34239>>>>>>>        // Year.Year_Recr
34239>>>>>>>        Set Field_Prompt_Object    Field Year.Year_Recr To (SL003(Self))
34240>>>>>>>
34240>>>>>>>        // Year.Branch_Recr
34240>>>>>>>
34240>>>>>>>        // Year.Year_Descr
34240>>>>>>>
34240>>>>>>>        // Year.Year_Isolfrom
34240>>>>>>>
34240>>>>>>>        // Year.Year_Isolto
34240>>>>>>>
34240>>>>>>>        // Year.Year_Openfrom
34240>>>>>>>
34240>>>>>>>        // Year.Year_Opento
34240>>>>>>>
34240>>>>>>>        // Year.Year_Entrydate
34240>>>>>>>
34240>>>>>>>        // Year.Year_Dateaa
34240>>>>>>>
34240>>>>>>>        // Year.Year_Xrhshfrom
34240>>>>>>>
34240>>>>>>>        // Year.Year_Xrhshto
34240>>>>>>>
34240>>>>>>>        // Year.Year_Myflimit
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numgtypkin
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numgarticl
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numgmove
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numgplan
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numgformat
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numgthaa
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numgopen
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numbtypkin
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numbaxio
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numbarticl
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numbmove
34240>>>>>>>
34240>>>>>>>        // Year.Year_Delimiter
34240>>>>>>>
34240>>>>>>>        // Year.Year_Printer
34240>>>>>>>
34240>>>>>>>        // Year.Year_Valid_Char
34240>>>>>>>
34240>>>>>>>        // Year.Year_C_Code0
34240>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0 To "dbComboFormSub"
34241>>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code0 To (Year_Year_C_Code0_VT1(Self))
34242>>>>>>>
34242>>>>>>>        // Year.Year_C_Code00
34242>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00 To "dbComboFormSub"
34243>>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code00 To (Year_Year_C_Code00_VT1(Self))
34244>>>>>>>
34244>>>>>>>        // Year.Year_C_Coder
34244>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder To "dbComboFormSub"
34245>>>>>>>        Set Field_Value_Table      Field Year.Year_C_Coder To (Year_Year_C_Coder_VT1(Self))
34246>>>>>>>
34246>>>>>>>        // Year.Beto_Site
34246>>>>>>>
34246>>>>>>>        // Year.Clients_Plafon
34246>>>>>>>
34246>>>>>>>        // Year.Payresp_Plafon
34246>>>>>>>
34246>>>>>>>        // Year.Clients_Ofeilh
34246>>>>>>>
34246>>>>>>>        // Year.Payresp_Ofeilh
34246>>>>>>>
34246>>>>>>>        // Year.Working
34246>>>>>>>
34246>>>>>>>        //DDB-DefineFieldEnd
34246>>>>>>>
34246>>>>>>>        Set Main_File            To Year.File_Number
34247>>>>>>>        Set Cascade_Delete_State To FALSE
34248>>>>>>>
34248>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
34249>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
34250>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
34251>>>>>>>
34251>>>>>>>        // Child (Client) file structure................
34251>>>>>>>
34251>>>>>>>        // Parent (Server) file structure...............
34251>>>>>>>        Send Add_Server_File  Branch.File_Number
34252>>>>>>>
34252>>>>>>>        // Field-based properties.......................
34252>>>>>>>
34252>>>>>>>        // Year.Company_Code
34252>>>>>>>
34252>>>>>>>        // Year.Branch_Code
34252>>>>>>>
34252>>>>>>>        // Year.Year_Year
34252>>>>>>>        Set Field_Label_Long       Field Year.Year_Year           To "•¨ã©ž"
34253>>>>>>>        Set Field_Label_Short      Field Year.Year_Year           To "•¨ã©ž"
34254>>>>>>>        Set Field_Options          Field Year.Year_Year           To DD_REQUIRED
34255>>>>>>>        //Set Field_Prompt_Object    Field Year.Year_Year           To (SL053(Self))
34255>>>>>>>
34255>>>>>>>        // Year.Year_Descr
34255>>>>>>>        Set Field_Label_Long       Field Year.Year_Descr          To "œ¨ š¨˜­ã •¨ã©žª"
34256>>>>>>>        Set Field_Label_Short      Field Year.Year_Descr          To "œ¨.•¨ã©žª"
34257>>>>>>>
34257>>>>>>>        // Year.Year_C_Code0
34257>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0        To "dbComboForm"
34258>>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code0        To "‰ç¨ ¦ Œæ£ ©£˜"
34259>>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code0        To "‰¬¨.Œ¦£ ©£˜"
34260>>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code0        To (Year_Year_C_Code0_VT(Self))
34260>>>>>>>
34260>>>>>>>        // Year.Year_C_Code00
34260>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00       To "dbComboForm"
34261>>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
34262>>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
34263>>>>>>>        //Set Field_Options          Field Year.Year_C_Code00       To DD_REQUIRED
34263>>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code00       To (Year_Year_C_Code1_VT(Self))
34263>>>>>>>
34263>>>>>>>        // Year.Year_C_Coder
34263>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder        To "dbComboForm"
34264>>>>>>>        Set Field_Label_Long       Field Year.Year_C_Coder        To "Œæ£ ©£˜ REPORTING"
34265>>>>>>>        Set Field_Label_Short      Field Year.Year_C_Coder        To "Œæ£ ©£˜ REP"
34266>>>>>>>        //Set Field_Options          Field Year.Year_C_Coder        To DD_REQUIRED
34266>>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Coder        To (Year_Year_C_Coder_VT(Self))
34266>>>>>>>
34266>>>>>>>        // Year.Year_Isolfrom
34266>>>>>>>        Set Field_Label_Long       Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
34267>>>>>>>        Set Field_Label_Short      Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
34268>>>>>>>
34268>>>>>>>        // Year.Year_Isolto
34268>>>>>>>        Set Field_Label_Long       Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
34269>>>>>>>        Set Field_Label_Short      Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
34270>>>>>>>
34270>>>>>>>        // Year.Year_Openfrom
34270>>>>>>>        Set Field_Label_Long       Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
34271>>>>>>>        Set Field_Label_Short      Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
34272>>>>>>>
34272>>>>>>>        // Year.Year_Opento
34272>>>>>>>        Set Field_Label_Long       Field Year.Year_Opento         To "„šš¨˜­âª „àª"
34273>>>>>>>        Set Field_Label_Short      Field Year.Year_Opento         To "„šš¨˜­âª „àª"
34274>>>>>>>
34274>>>>>>>        // Year.Year_Entrydate
34274>>>>>>>        Set Field_Label_Long       Field Year.Year_Entrydate      To "†£œ¨¦£ž¤å˜ „¨š˜©å˜ª"
34275>>>>>>>        Set Field_Label_Short      Field Year.Year_Entrydate      To "†£/¤å˜ „¨š˜©å˜ª"
34276>>>>>>>
34276>>>>>>>        // Year.Year_Dateaa
34276>>>>>>>
34276>>>>>>>        // Year.Year_Xrhshfrom
34276>>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
34277>>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
34278>>>>>>>
34278>>>>>>>        // Year.Year_Xrhshto
34278>>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
34279>>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
34280>>>>>>>
34280>>>>>>>        // Year.Year_Myflimit
34280>>>>>>>        Set Field_Label_Long       Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
34281>>>>>>>        Set Field_Label_Short      Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
34282>>>>>>>
34282>>>>>>>        // Year.Year_Numgtypkin
34282>>>>>>>        Set Field_Options          Field Year.Year_Numgtypkin     To DD_DISPLAYONLY
34283>>>>>>>
34283>>>>>>>        // Year.Year_Numgarticl
34283>>>>>>>        Set Field_Options          Field Year.Year_Numgarticl     To DD_DISPLAYONLY
34284>>>>>>>
34284>>>>>>>        // Year.Year_Numgmove
34284>>>>>>>        Set Field_Options          Field Year.Year_Numgmove       To DD_DISPLAYONLY
34285>>>>>>>
34285>>>>>>>        // Year.Year_Numgplan
34285>>>>>>>        Set Field_Options          Field Year.Year_Numgplan       To DD_DISPLAYONLY
34286>>>>>>>
34286>>>>>>>        // Year.Year_Numgformat
34286>>>>>>>        Set Field_Options          Field Year.Year_Numgformat     To DD_DISPLAYONLY
34287>>>>>>>
34287>>>>>>>        // Year.Year_Numgthaa
34287>>>>>>>        Set Field_Options          Field Year.Year_Numgthaa       To DD_DISPLAYONLY
34288>>>>>>>
34288>>>>>>>        // Year.Year_Numgopen
34288>>>>>>>        Set Field_Options          Field Year.Year_Numgopen       To DD_DISPLAYONLY
34289>>>>>>>
34289>>>>>>>        // Year.Year_Numbaxio
34289>>>>>>>        Set Field_Options          Field Year.Year_Numbaxio       To DD_DISPLAYONLY
34290>>>>>>>
34290>>>>>>>        // Year.Year_Numbarticl
34290>>>>>>>        Set Field_Options          Field Year.Year_Numbarticl     To DD_DISPLAYONLY
34291>>>>>>>
34291>>>>>>>        // Year.Year_Numbmove
34291>>>>>>>        Set Field_Options          Field Year.Year_Numbmove       To DD_DISPLAYONLY
34292>>>>>>>
34292>>>>>>>        // Year.Year_Delimiter
34292>>>>>>>        Set Status_Help            Field Year.Year_Delimiter      To "ƒ ˜®à¨ ©« ¡æ š ˜ «¦ Š‘ «žª •¨ã©œàª"
34293>>>>>>>
34293>>>>>>>        // Year.Year_Printer
34293>>>>>>>
34293>>>>>>>        // Year.Year_Valid_Char
34293>>>>>>>
34293>>>>>>>    End_Procedure    // Define_Fields
34294>>>>>>>
34294>>>>>>>    // Field_Defaults:
34294>>>>>>>    // This procedure is used to establish default field values.
34294>>>>>>>
34294>>>>>>>    Procedure Field_Defaults
34295>>>>>>>        Forward Send Field_Defaults
34297>>>>>>>        //DDB-Generated-Code-Location
34297>>>>>>>        //DDB-FieldDefaultStart
34297>>>>>>>        //DDB-FieldDefaultEnd
34297>>>>>>>        Set Field_Changed_Value   Field Year.Year_Delimiter      To "."
34298>>>>>>>        Set Field_Changed_Value   Field Year.Year_Printer        To "LPT1:"
34299>>>>>>>        Set Field_Changed_Value   Field Year.Year_Valid_Char     To "1234567890"
34300>>>>>>>    End_Procedure    // Field_Defaults
34301>>>>>>>
34301>>>>>>>End_Class    // Year_DataDictionary
34302>>>>>>>//DDB-Selection-pkg-Start
34302>>>>>>>
34302>>>>>>>Use Sl003.sl         // SL003
INCLUDING FILE: SL003.SL
34302>>>>>>>>>//AB/ Project SL003:Year
34302>>>>>>>>>//AB/ Object prj is a Lookup_Project
34302>>>>>>>>>//AB/     Set ProjectName to "SL003:Year"
34302>>>>>>>>>//AB/     Set ProjectFileName to "Sl003.sl"
34302>>>>>>>>>
34302>>>>>>>>>// Project Object Structure
34302>>>>>>>>>//   SL003 is a dbModalPanelSub
34302>>>>>>>>>//     Company_DD is a DataDictionary
34302>>>>>>>>>//     Branch_DD is a DataDictionary
34302>>>>>>>>>//     Year_DD is a DataDictionary
34302>>>>>>>>>//     oSelList is a dbListSub
34302>>>>>>>>>//     oOK_bn is a ButtonSub
34302>>>>>>>>>//     oCancel_bn is a ButtonSub
34302>>>>>>>>>//     oSearch_bn is a ButtonSub
34302>>>>>>>>>
34302>>>>>>>>>// Register all objects
34302>>>>>>>>>Register_Object Branch_DD
34302>>>>>>>>>Register_Object Company_DD
34302>>>>>>>>>Register_Object oCancel_bn
34302>>>>>>>>>Register_Object oOK_bn
34302>>>>>>>>>Register_Object oSearch_bn
34302>>>>>>>>>Register_Object oSelList
34302>>>>>>>>>Register_Object SL003
34302>>>>>>>>>Register_Object Year_DD
34302>>>>>>>>>
34302>>>>>>>>>
34302>>>>>>>>>//AB-IgnoreStart
34302>>>>>>>>>
34302>>>>>>>>>Use DFAllEnt.pkg
34302>>>>>>>>>Use dbList.Sub
34302>>>>>>>>>Use Button.Sub
34302>>>>>>>>>
34302>>>>>>>>>
34302>>>>>>>>>Use COMPANY.DD
34302>>>>>>>>>Use BRANCH.DD
34302>>>>>>>>>Use YEAR.DD
34302>>>>>>>>>
34302>>>>>>>>>//AB-IgnoreEnd
34302>>>>>>>>>
34302>>>>>>>>>CD_Popup_Object SL003 is a dbModalPanelSub
34321>>>>>>>>>
34321>>>>>>>>>    //AB-StoreTopStart
34321>>>>>>>>>    Property String psFragmaCompanyCode  ""
34323>>>>>>>>>    Property String psFragmaBranchCode   ""
34325>>>>>>>>>    property integer pifragmaactive public 0
34327>>>>>>>>>    //AB-StoreTopEnd
34327>>>>>>>>>
34327>>>>>>>>>    Set Minimize_Icon to FALSE
34328>>>>>>>>>    Set Label to "•¨ã©œ ª"
34329>>>>>>>>>    Set Size to 149 449
34330>>>>>>>>>    Set Location to 4 7
34331>>>>>>>>>    Set Exit_Application_Local_State to FALSE
34332>>>>>>>>>    Set Modal_State to FALSE
34333>>>>>>>>>
34333>>>>>>>>>    //AB-DDOStart
34333>>>>>>>>>
34333>>>>>>>>>    Object Company_DD is a Company_DataDictionary
34335>>>>>>>>>    End_Object    // Company_DD
34336>>>>>>>>>
34336>>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
34338>>>>>>>>>        Set DDO_Server to (Company_DD(self))
34339>>>>>>>>>    End_Object    // Branch_DD
34340>>>>>>>>>
34340>>>>>>>>>    Object Year_DD is a Year_DataDictionary
34342>>>>>>>>>        Set DDO_Server to (Branch_DD(self))
34343>>>>>>>>>
34343>>>>>>>>>        //AB-StoreStart
34343>>>>>>>>>        Procedure OnConstrain
34345>>>>>>>>>             String lsCompanyCode lsBranchCode
34346>>>>>>>>>             integer iactive
34346>>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
34347>>>>>>>>>             get pifragmaactive to iactive
34348>>>>>>>>>             If (lsCompanyCode <> "") Begin
34350>>>>>>>>>                Get psFragmaBranchCode  to lsBranchCode
34351>>>>>>>>>                Constrain Year.Company_Code eq lsCompanyCode
34353>>>>>>>>>                If (lsBranchCode <> "") Constrain Year.Branch_code eq lsBranchCode
34357>>>>>>>>>             End
34357>>>>>>>>>>
34357>>>>>>>>>             if (iactive = 0) constrain year.working ne 1
34361>>>>>>>>>        End_Procedure // OnConstrain
34362>>>>>>>>>        
34362>>>>>>>>>        
34362>>>>>>>>>        
34362>>>>>>>>>        
34362>>>>>>>>>        
34362>>>>>>>>>        //AB-StoreEnd
34362>>>>>>>>>
34362>>>>>>>>>    End_Object    // Year_DD
34363>>>>>>>>>
34363>>>>>>>>>    Set Main_DD to (Year_DD(self))
34364>>>>>>>>>    Set Server to (Year_DD(self))
34365>>>>>>>>>
34365>>>>>>>>>    //AB-DDOEnd
34365>>>>>>>>>
34365>>>>>>>>>    Object oSelList is a dbListSub
34367>>>>>>>>>        Set Main_File to Year.File_Number
34368>>>>>>>>>        Set Size to 105 433
34369>>>>>>>>>        Set Location to 6 6
34370>>>>>>>>>
34370>>>>>>>>>        Begin_Row
34373>>>>>>>>>            Entry_Item Year.Year_year
34374>>>>>>>>>            Entry_Item Company.Company_code
34375>>>>>>>>>            Entry_Item Company.Company_name
34376>>>>>>>>>            Entry_Item Branch.Branch_code
34377>>>>>>>>>            Entry_Item Branch.Branch_name
34378>>>>>>>>>        End_Row
34383>>>>>>>>>
34383>>>>>>>>>        Set Form_Width    item 0 to 36
34384>>>>>>>>>        Set Header_Label  item 0 to "•¨ã©ž :          "
34385>>>>>>>>>        
34385>>>>>>>>>        Set Form_Width    item 1 to 71
34386>>>>>>>>>        Set Header_Label  item 1 to "‰à› ¡æª „«˜ ¨å˜ª"
34387>>>>>>>>>        
34387>>>>>>>>>        Set Form_Width    item 2 to 136
34388>>>>>>>>>        Set Header_Label  item 2 to "Ž¤¦£˜ „«˜ ¨å˜ª"
34389>>>>>>>>>        
34389>>>>>>>>>        Set Form_Width    item 3 to 73
34390>>>>>>>>>        Set Header_Label  item 3 to "‰à› ¡æª “§¦¡/«¦ª"
34391>>>>>>>>>        
34391>>>>>>>>>        Set Form_Width    item 4 to 109
34392>>>>>>>>>        Set Header_Label  item 4 to "Ž¤¦£˜ “§¦¡/«¦ª"
34393>>>>>>>>>        
34393>>>>>>>>>
34393>>>>>>>>>        //AB-StoreStart
34393>>>>>>>>>                                                
34393>>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
34395>>>>>>>>>        Property String psStoreFragmaBranchCode   ""
34397>>>>>>>>>        
34397>>>>>>>>>        Procedure Store_Defaults
34399>>>>>>>>>            forward send Store_Defaults
34401>>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
34402>>>>>>>>>            Set psStoreFragmaBranchCode  to (psFragmaBranchCode(Self))
34403>>>>>>>>>        end_Procedure // Store_Defaults
34404>>>>>>>>>        
34404>>>>>>>>>        Procedure Restore_Defaults
34406>>>>>>>>>            forward send Restore_Defaults
34408>>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
34409>>>>>>>>>            Set psFragmaBranchCode  to (psStoreFragmaBranchCode(self))
34410>>>>>>>>>        end_Procedure // Restore_Defaults
34411>>>>>>>>>        
34411>>>>>>>>>        Procedure Activating
34413>>>>>>>>>            Forward Send Activating
34415>>>>>>>>>            Send Rebuild_Constraints to (Year_DD(self))
34416>>>>>>>>>        End_Procedure // Activating
34417>>>>>>>>>        
34417>>>>>>>>>        
34417>>>>>>>>>        
34417>>>>>>>>>        //AB-StoreEnd
34417>>>>>>>>>
34417>>>>>>>>>    End_Object    // oSelList
34418>>>>>>>>>
34418>>>>>>>>>    Object oOK_bn is a ButtonSub
34420>>>>>>>>>        Set Label to "&„§ ¢¦šã"
34421>>>>>>>>>        Set Location to 112 280
34422>>>>>>>>>
34422>>>>>>>>>        //AB-StoreStart
34422>>>>>>>>>        Procedure OnClick
34424>>>>>>>>>            Send OK To (oSelList(current_object))
34425>>>>>>>>>        End_Procedure
34426>>>>>>>>>        //AB-StoreEnd
34426>>>>>>>>>
34426>>>>>>>>>    End_Object    // oOK_bn
34427>>>>>>>>>
34427>>>>>>>>>    Object oCancel_bn is a ButtonSub
34429>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
34430>>>>>>>>>        Set Location to 112 335
34431>>>>>>>>>
34431>>>>>>>>>        //AB-StoreStart
34431>>>>>>>>>        Procedure OnClick
34433>>>>>>>>>            Send Cancel To (oSelList(current_object))
34434>>>>>>>>>        End_Procedure
34435>>>>>>>>>        //AB-StoreEnd
34435>>>>>>>>>
34435>>>>>>>>>    End_Object    // oCancel_bn
34436>>>>>>>>>
34436>>>>>>>>>    Object oSearch_bn is a ButtonSub
34438>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
34439>>>>>>>>>        Set Location to 112 390
34440>>>>>>>>>
34440>>>>>>>>>        //AB-StoreStart
34440>>>>>>>>>        Procedure OnClick
34442>>>>>>>>>            Send Search To (oSelList(current_object))
34443>>>>>>>>>        End_Procedure
34444>>>>>>>>>        //AB-StoreEnd
34444>>>>>>>>>
34444>>>>>>>>>    End_Object    // oSearch_bn
34445>>>>>>>>>
34445>>>>>>>>>
34445>>>>>>>>>    //AB-StoreStart
34445>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
34446>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
34447>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
34448>>>>>>>>>    
34448>>>>>>>>>    
34448>>>>>>>>>    
34448>>>>>>>>>    //AB-StoreEnd
34448>>>>>>>>>
34448>>>>>>>>>CD_End_Object    // SL003
34450>>>>>>>>>>
34450>>>>>>>>>
34450>>>>>>>>>//AB/ End_Object    // prj
34450>>>>>>>
34450>>>>>>>//DDB-Selection-pkg-End
34450>>>>>>>//DDB-FileEnd
34450>>>>>
34450>>>>>//AB-IgnoreEnd
34450>>>>>
34450>>>>>Object oSelectYear is a dbModalPanelSub
34452>>>>>
34452>>>>>    //AB-StoreTopStart
34452>>>>>    
34452>>>>>    Property String  psSelectedYearRecr  ''
34454>>>>>    Property Integer piChangeState False
34456>>>>>    
34456>>>>>    //AB-StoreTopEnd
34456>>>>>
34456>>>>>    Set Minimize_Icon to FALSE
34457>>>>>    Set Label to "„§ ¢¦šã „«˜ ¨œå˜ª - “§¦¡˜«˜©«ã£˜«¦ª - •¨ã©žª"
34458>>>>>    Set Size to 111 372
34459>>>>>    Set Location to 60 40
34460>>>>>    Set Color to 12232306
34461>>>>>
34461>>>>>    //AB-DDOStart
34461>>>>>
34461>>>>>    Object Company_DD is a Company_DataDictionary
34463>>>>>
34463>>>>>        //AB-StoreStart
34463>>>>>        Set Foreign_Field_Options DD_KEYFIELD                   to DD_Clear_Field_Options DD_FindReq
34464>>>>>        Set Foreign_Field_Options DD_INDEXFIELD                 to DD_Clear_Field_Options DD_FindReq
34465>>>>>        Set Foreign_Field_Options Field Company.Company_Name    to DD_DisplayOnly
34466>>>>>        
34466>>>>>        
34466>>>>>        
34466>>>>>        //AB-StoreEnd
34466>>>>>
34466>>>>>    End_Object    // Company_DD
34467>>>>>
34467>>>>>    Object Branch_DD is a Branch_DataDictionary
34469>>>>>        Set DDO_Server to (Company_DD(self))
34470>>>>>
34470>>>>>        //AB-StoreStart
34470>>>>>        Set Foreign_Field_Options DD_KEYFIELD   to DD_Clear_Field_Options DD_FindReq
34471>>>>>        Set Foreign_Field_Options DD_INDEXFIELD to DD_Clear_Field_Options DD_FindReq
34472>>>>>        
34472>>>>>        Set Foreign_Field_Options DD_KEYFIELD   to DD_AutoFind_GE
34473>>>>>        Set Foreign_Field_Options DD_INDEXFIELD to DD_AutoFind_GE
34474>>>>>        
34474>>>>>        Set Foreign_Field_Options Field Branch.Branch_Name to DD_DisplayOnly
34475>>>>>        //AB-StoreEnd
34475>>>>>
34475>>>>>    End_Object    // Branch_DD
34476>>>>>
34476>>>>>    Object Year_DD is a Year_DataDictionary
34478>>>>>        Set DDO_Server to (Branch_DD(self))
34479>>>>>
34479>>>>>        //AB-StoreStart
34479>>>>>        
34479>>>>>        Set Field_Options Field Year.Year_Descr to DD_DisplayOnly
34480>>>>>        Set Field_Options Field Year.Year_Year to DD_AutoFind_GE
34481>>>>>        
34481>>>>>        Function Validate_Delete Returns Integer
34483>>>>>            Function_Return 1
34484>>>>>        End_Function
34485>>>>>        
34485>>>>>        //AB-StoreEnd
34485>>>>>
34485>>>>>    End_Object    // Year_DD
34486>>>>>
34486>>>>>    Set Main_DD to (Year_DD(self))
34487>>>>>    Set Server to (Year_DD(self))
34488>>>>>
34488>>>>>    //AB-DDOEnd
34488>>>>>
34488>>>>>    Object Company_Company_Code is a dbFormSub
34490>>>>>        Entry_Item Company.Company_code
34491>>>>>        Set Size to 13 71
34492>>>>>        Set Location to 9 112
34493>>>>>        Set Color to 12232306
34494>>>>>        Set Label_Col_Offset to 2
34495>>>>>        Set Label_Justification_Mode to jMode_Right
34496>>>>>        Set Prompt_Button_Mode to pb_PromptOn
34497>>>>>        Set Auto_Clear_Deo_State to FALSE
34498>>>>>        Set Enabled_State to FALSE
34499>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34500>>>>>        Set Item_Shadow_State Item 0 to TRUE
34501>>>>>        Set Shadow_State Item 0 to TRUE
34502>>>>>
34502>>>>>        //AB-StoreStart
34502>>>>>        
34502>>>>>        Set Prompt_Object to (sl001(Self))
34503>>>>>        
34503>>>>>        
34503>>>>>        //AB-StoreEnd
34503>>>>>
34503>>>>>    End_Object    // Company_Company_Code
34504>>>>>
34504>>>>>    Object Company_Company_Name is a dbFormSub
34506>>>>>        Entry_Item Company.Company_name
34507>>>>>        Set Size to 13 168
34508>>>>>        Set Location to 9 188
34509>>>>>        Set Color to 12232306
34510>>>>>        Set Label_Col_Offset to 2
34511>>>>>        Set Label_Justification_Mode to jMode_Right
34512>>>>>        Set Enabled_State to FALSE
34513>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34514>>>>>        Set Item_Shadow_State Item 0 to TRUE
34515>>>>>        Set Shadow_State Item 0 to TRUE
34516>>>>>
34516>>>>>        //AB-StoreStart
34516>>>>>        
34516>>>>>        //AB-StoreEnd
34516>>>>>
34516>>>>>    End_Object    // Company_Company_Name
34517>>>>>
34517>>>>>    Object Branch_Branch_Code is a dbFormSub
34519>>>>>        Entry_Item Branch.Branch_code
34520>>>>>        Set Size to 13 71
34521>>>>>        Set Location to 23 112
34522>>>>>        Set Color to 12232306
34523>>>>>        Set Label_Col_Offset to 2
34524>>>>>        Set Label_Justification_Mode to jMode_Right
34525>>>>>        Set Prompt_Button_Mode to pb_PromptOn
34526>>>>>        Set Auto_Clear_Deo_State to FALSE
34527>>>>>        Set Enabled_State to FALSE
34528>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34529>>>>>        Set Item_Shadow_State Item 0 to TRUE
34530>>>>>        Set Shadow_State Item 0 to TRUE
34531>>>>>
34531>>>>>        //AB-StoreStart
34531>>>>>        Set Prompt_Object to (sl002(Self))
34532>>>>>        
34532>>>>>        Procedure Prompt_CallBack Integer hPrompt
34534>>>>>            string lsCompanyCode
34535>>>>>            Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
34536>>>>>            Set psFragmaCompanyCode of hPrompt to lsCompanyCode
34537>>>>>        End_Procedure
34538>>>>>        
34538>>>>>        
34538>>>>>        
34538>>>>>        
34538>>>>>        //AB-StoreEnd
34538>>>>>
34538>>>>>    End_Object    // Branch_Branch_Code
34539>>>>>
34539>>>>>    Object Branch_Branch_Name is a dbFormSub
34541>>>>>        Entry_Item Branch.Branch_name
34542>>>>>        Set Size to 13 168
34543>>>>>        Set Location to 23 188
34544>>>>>        Set Color to 12232306
34545>>>>>        Set Label_Justification_Mode to jMode_Right
34546>>>>>        Set Enabled_State to FALSE
34547>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34548>>>>>        Set Item_Shadow_State Item 0 to TRUE
34549>>>>>        Set Shadow_State Item 0 to TRUE
34550>>>>>
34550>>>>>        //AB-StoreStart
34550>>>>>        
34550>>>>>        
34550>>>>>        //AB-StoreEnd
34550>>>>>
34550>>>>>    End_Object    // Branch_Branch_Name
34551>>>>>
34551>>>>>    Object Year_Year_Year is a dbFormSub
34553>>>>>        Entry_Item Year.Year_year
34554>>>>>        Set Size to 13 71
34555>>>>>        Set Location to 37 112
34556>>>>>        Set Label_Col_Offset to 2
34557>>>>>        Set Label_Justification_Mode to jMode_Right
34558>>>>>        Set Prompt_Button_Mode to pb_PromptOn
34559>>>>>        Set Auto_Clear_Deo_State to FALSE
34560>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34561>>>>>
34561>>>>>        //AB-StoreStart
34561>>>>>        Set Prompt_Object to (sl003(Self))
34562>>>>>        
34562>>>>>        Procedure Prompt_CallBack Integer hPrompt
34564>>>>>            String lsCompanyCode lsBranchCode
34565>>>>>            integer icheck
34565>>>>>            get checked_state of (chkxr(self)) to icheck
34566>>>>>            Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
34567>>>>>            Get Field_Current_Value of Branch_DD  Field Branch.Branch_Code   to lsBranchCode
34568>>>>>            Set psFragmaCompanyCode of hPrompt to lsCompanyCode
34569>>>>>            Set psFragmaBranchCode  of hPrompt to lsBranchCode
34570>>>>>            set pifragmaactive      of hPrompt to icheck
34571>>>>>        End_Procedure
34572>>>>>        
34572>>>>>        
34572>>>>>        
34572>>>>>        
34572>>>>>        
34572>>>>>        
34572>>>>>        //AB-StoreEnd
34572>>>>>
34572>>>>>    End_Object    // Year_Year_Year
34573>>>>>
34573>>>>>    Object Year_Year_Descr is a dbFormSub
34575>>>>>        Entry_Item Year.Year_descr
34576>>>>>        Set Size to 13 168
34577>>>>>        Set Location to 37 188
34578>>>>>        Set Color to 12232306
34579>>>>>        Set Label_Col_Offset to 2
34580>>>>>        Set Label_Justification_Mode to jMode_Right
34581>>>>>        Set Enabled_State to FALSE
34582>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34583>>>>>        Set Item_Shadow_State Item 0 to TRUE
34584>>>>>        Set Shadow_State Item 0 to TRUE
34585>>>>>
34585>>>>>        //AB-StoreStart
34585>>>>>        
34585>>>>>        //AB-StoreEnd
34585>>>>>
34585>>>>>    End_Object    // Year_Year_Descr
34586>>>>>
34586>>>>>    Object Year_Year_Entrydate is a dbFormSub
34588>>>>>        Entry_Item Year.Year_entrydate
34589>>>>>        Set Size to 13 71
34590>>>>>        Set Location to 52 112
34591>>>>>        Set Label_Col_Offset to 2
34592>>>>>        Set Label_Justification_Mode to jMode_Right
34593>>>>>        Set Auto_Clear_Deo_State to FALSE
34594>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34595>>>>>    End_Object    // Year_Year_Entrydate
34596>>>>>
34596>>>>>    Object oOk_bn is a ButtonSub
34598>>>>>        Set Label to "€§¦›¦®ã (F2)"
34599>>>>>        Set Size to 17 54
34600>>>>>        Set Location to 74 188
34601>>>>>        Set Form_FontHeight Item 0 to 14
34602>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34603>>>>>
34603>>>>>        //AB-StoreStart
34603>>>>>        
34603>>>>>        Procedure OnClick
34605>>>>>            Delegate Send AcceptTheValues
34607>>>>>        End_Procedure
34608>>>>>        
34608>>>>>        
34608>>>>>        
34608>>>>>        
34608>>>>>        //AB-StoreEnd
34608>>>>>
34608>>>>>    End_Object    // oOk_bn
34609>>>>>
34609>>>>>    Object oCancel_bn is a ButtonSub
34611>>>>>        Set Label to "„¥¦›¦ª "
34612>>>>>        Set Size to 17 54
34613>>>>>        Set Location to 74 302
34614>>>>>        Set Form_FontHeight Item 0 to 14
34615>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34616>>>>>
34616>>>>>        //AB-StoreStart
34616>>>>>        
34616>>>>>        Procedure OnClick
34618>>>>>           Send Exit_Application to oSelectYear
34619>>>>>        End_Procedure
34620>>>>>        
34620>>>>>        
34620>>>>>        
34620>>>>>        //AB-StoreEnd
34620>>>>>
34620>>>>>    End_Object    // oCancel_bn
34621>>>>>
34621>>>>>    Object otxtCompany is a TextBoxSub
34623>>>>>        Set Label to "„«˜ ¨œå˜"
34624>>>>>        Set Auto_Size_State to FALSE
34625>>>>>        Set Color to 12232306
34626>>>>>        Set FontSize to 14 8
34627>>>>>        Set Location to 9 10
34628>>>>>        Set Size to 10 35
34629>>>>>        Set FontWeight to 600
34630>>>>>        Set TypeFace to "MS Sans Serif"
34631>>>>>        Set Enabled_State to TRUE
34632>>>>>    End_Object    // otxtCompany
34633>>>>>
34633>>>>>    Object otxtBranch is a TextBoxSub
34635>>>>>        Set Label to "“§¦¡˜«˜©«ã£˜«˜"
34636>>>>>        Set Auto_Size_State to FALSE
34637>>>>>        Set Color to 12232306
34638>>>>>        Set FontSize to 14 8
34639>>>>>        Set Location to 23 10
34640>>>>>        Set Size to 10 63
34641>>>>>        Set FontWeight to 600
34642>>>>>        Set TypeFace to "MS Sans Serif"
34643>>>>>        Set Enabled_State to TRUE
34644>>>>>    End_Object    // otxtBranch
34645>>>>>
34645>>>>>    Object otxtYear is a TextBoxSub
34647>>>>>        Set Label to "•¨ã©ž :          "
34648>>>>>        Set Auto_Size_State to FALSE
34649>>>>>        Set Color to 12232306
34650>>>>>        Set FontSize to 14 8
34651>>>>>        Set Location to 38 10
34652>>>>>        Set Size to 10 40
34653>>>>>        Set FontWeight to 600
34654>>>>>        Set TypeFace to "MS Sans Serif"
34655>>>>>        Set Enabled_State to TRUE
34656>>>>>    End_Object    // otxtYear
34657>>>>>
34657>>>>>    Object otxtWorkingDay is a TextBoxSub
34659>>>>>        Set Label to "†£/¤å˜ „¨š˜©å˜ª"
34660>>>>>        Set Auto_Size_State to FALSE
34661>>>>>        Set Color to 12232306
34662>>>>>        Set FontSize to 14 8
34663>>>>>        Set Location to 52 10
34664>>>>>        Set Size to 10 63
34665>>>>>        Set FontWeight to 600
34666>>>>>        Set TypeFace to "MS Sans Serif"
34667>>>>>        Set Enabled_State to TRUE
34668>>>>>    End_Object    // otxtWorkingDay
34669>>>>>
34669>>>>>    Object otxtWorkingDay is a TextBoxSub
34671>>>>>        Set Label to "Ž¢œª ¦  ®¨ã©œ ª"
34672>>>>>        Set Auto_Size_State to FALSE
34673>>>>>        Set Color to 12232306
34674>>>>>        Set FontSize to 14 8
34675>>>>>        Set Location to 79 9
34676>>>>>        Set Size to 10 63
34677>>>>>        Set FontWeight to 600
34678>>>>>        Set TypeFace to "MS Sans Serif"
34679>>>>>        Set Enabled_State to TRUE
34680>>>>>    End_Object    // otxtWorkingDay
34681>>>>>
34681>>>>>    Object chkxr is a CheckBoxSub
34683>>>>>        Set Size to 13 22
34684>>>>>        Set Location to 79 113
34685>>>>>        Set Color to 12232306
34686>>>>>    End_Object    // chkxr
34687>>>>>
34687>>>>>
34687>>>>>    //AB-StoreStart
34687>>>>>    
34687>>>>>    On_Key Key_Ctrl+Key_X Send None
34688>>>>>    On_Key Key_Alt+Key_X  Send None
34689>>>>>    
34689>>>>>    Function ifSelect_Xrhsh Returns String
34691>>>>>        String  lsRecord_id
34692>>>>>        Set psSelectedYearRecr to gs_Selected_Year_Recr
34693>>>>>        send popup_modal
34694>>>>>        Get psSelectedYearRecr to lsRecord_id
34695>>>>>        Function_return lsRecord_Id
34696>>>>>    End_Function
34697>>>>>    
34697>>>>>    Procedure AcceptTheValues
34699>>>>>        Integer iRetVal liYearDD liCompanyDD liBranchDD
34700>>>>>        String ldcheck lsYearRecr lsSite sCname sBname sYname sNom1 sNom2 sNom3
34700>>>>>        Date ldYearXrhsh_From ldYearXrhsh_To
34700>>>>>        Move Year_DD to liYearDD
34701>>>>>        Get Field_Current_Value of liYearDD Field Year.Year_EntryDate to ldcheck
34702>>>>>        if (ldcheck = "") ;            Get Message_Box "ƒœ¤ œ§ ¢â¥˜«œ ©à©«ã ž£œ¨¦£ž¤å˜." "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
34705>>>>>        else begin
34706>>>>>            Get Field_Current_Value of liYearDD Field Year.Year_XrhshFrom   to ldYearXrhsh_From
34707>>>>>            Get Field_Current_Value of liYearDD Field Year.Year_XrhshTo     to ldYearXrhsh_To
34708>>>>>            if ((ldcheck < ldYearXrhsh_From) or (ldcheck > ldYearXrhsh_To)) ;                Get Message_Box "†£œ¨/¤å˜ œ¡«éª ¦¨åà¤" "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
34711>>>>>            else begin
34712>>>>>                Move Company_DD to liCompanyDD
34713>>>>>                Move Branch_DD  to liBranchDD
34714>>>>>                Move Year_DD    to liYearDD
34715>>>>>                send Request_Save to liYearDD
34716>>>>>                Get Field_Current_Value of liCompanyDD Field Company.Company_Code to gs_Selected_Company_Code
34717>>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_Code   to gs_Selected_Branch_Code
34718>>>>>    
34718>>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Beto_Site   to gs_Selected_Beto_Site
34719>>>>>    
34719>>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_Site   to lsSite
34720>>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Year       to gi_Selected_Year
34721>>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Recr       to lsYearRecr
34722>>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_Code0    to sNom1
34723>>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_Code00   to sNom2
34724>>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_CodeR    to sNom3
34725>>>>>    
34725>>>>>                Get Field_Current_Value of liCompanyDD Field Company.Company_Name to sCname
34726>>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_name   to sBname
34727>>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Descr      to sYname
34728>>>>>    
34728>>>>>    
34728>>>>>                Local String    sCode
34728>>>>>                Local Integer   iBreak
34728>>>>>                Move 0 to iBreak
34729>>>>>                Clear Nomisma
34730>>>>>                Find Gt Nomisma.Recnum
34731>>>>>>
34731>>>>>                While ((Found=1) And (iBreak=0))
34735>>>>>                    If (Nomisma.Einai_Euro='1') Begin
34737>>>>>                        Move 1 to iBreak
34738>>>>>                        Move Nomisma.Nomisma_Code to sCode
34739>>>>>                    End
34739>>>>>>
34739>>>>>                    If (Not(iBreak)) Find Gt Nomisma.Recnum
34742>>>>>                Loop
34743>>>>>>
34743>>>>>                Move (Trim(sCode)) to sCode
34744>>>>>    
34744>>>>>    
34744>>>>>                Reread SysCurXR
34748>>>>>                Move gs_Selected_Company_Code   to SysCurXR.Company_Code
34749>>>>>                Move gs_Selected_beto_site      to SysCurXR.beto_site
34750>>>>>                Move gs_Selected_Branch_Code    to SysCurXR.Branch_Code
34751>>>>>                Move gi_Selected_Year           to SysCurXR.Year_Year
34752>>>>>                Move lsYearRecr                 to SysCurXR.Year_Recr
34753>>>>>                Move lsSite                     to SysCurXR.Branch_Site
34754>>>>>    
34754>>>>>                Move sCname                     to SysCurXR.Company_Name
34755>>>>>                Move sBname                     to SysCurXR.Branch_Name
34756>>>>>                Move sYname                     to SysCurXR.Year_Descr
34757>>>>>    
34757>>>>>                Move ldYearXrhsh_From           to SysCurXr.Year_XrhshFrom
34758>>>>>                Move ldYearXrhsh_To             to SysCurXr.Year_XrhshTo
34759>>>>>    
34759>>>>>                Move  (Trim(sNom1))             to SysCurXR.C_Code0
34760>>>>>                Move  (Trim(sNom2))             to SysCurXR.C_Code00
34761>>>>>                Move  (Trim(sNom3))             to SysCurXR.C_CodeR
34762>>>>>    
34762>>>>>                Move sCode                      to SysCurXR.Euro_Code
34763>>>>>    
34763>>>>>                Saverecord SysCurXR
34764>>>>>                Unlock
34765>>>>>>
34765>>>>>    
34765>>>>>                Move lsYearRecr                 to gs_Selected_Year_Recr
34766>>>>>                Set psSelectedYearRecr          to lsYearRecr
34767>>>>>    
34767>>>>>                Send Stop_Modal_ui
34768>>>>>    
34768>>>>>                Set kEnter_Next_State of ghoWorkSpace to TRUE
34769>>>>>            End
34769>>>>>>
34769>>>>>        end
34769>>>>>>
34769>>>>>    End_Procedure
34770>>>>>    
34770>>>>>    Set Locate_Mode to Center_On_Screen
34771>>>>>    
34771>>>>>    On_Key KCancel      Send KeyAction to (oCancel_Bn(Self))
34772>>>>>    On_Key KClose_Panel Send KeyAction to (oCancel_Bn(Self))
34773>>>>>    On_Key Ksave_record send KeyAction to (oOK_Bn(Self))
34774>>>>>    
34774>>>>>    On_Key Key_alt+Key_A send KeyAction to (oOK_Bn(Self))
34775>>>>>    On_Key Key_alt+Key_Q send KeyAction to (oCancel_Bn(Self))
34776>>>>>    
34776>>>>>    
34776>>>>>    
34776>>>>>    
34776>>>>>    
34776>>>>>    
34776>>>>>    
34776>>>>>    //AB-StoreEnd
34776>>>>>
34776>>>>>End_Object    // oSelectYear
34777>>>>>
34777>>>>>
34777>>>>>//AB-StoreStart
34777>>>>>
34777>>>>>
34777>>>>>//AB-StoreEnd
34777>>>>>
34777>>>>>//AB/ End_Object    // prj
34777>>>
34777>>>Procedure Epelexe_Xrhsh
34778>>>    Integer liCompanyDD liBranchDD liYearDD liYear liModalId
34779>>>    String lsCompany lsBranch lsWhatXrhsh
34779>>>    Move oSelectYear to liModalId
34780>>>    Get ifSelect_Xrhsh Of liModalId to lsWhatXrhsh
34781>>>    if (Trim(lsWhatXrhsh)='') Send Exit_Application
34784>>>End_Procedure
34785>>>
34785>>>Procedure Allaxe_Xrhsh
34786>>>    Integer rVal liModalId iID
34787>>>    If (Close_All_Views(Self,True)=0) Begin
34789>>>        Move oSelectYear to liModalId
34790>>>        Send Epelexe_Xrhsh
34791>>>    End
34791>>>>
34791>>>End_Procedure
34792>>>
34792>>>On_Key Key_Ctrl+Key_X Send Allaxe_Xrhsh
34793>>>On_Key Key_Alt+Key_X  Send Allaxe_Xrhsh
34794>>>
34794>>>Send Epelexe_Xrhsh
34795>>>//------------------------------
34795>>>
34795>//Send Epelexe_Xrhsh
34795>
34795>Use Menu_Sec.Sub
INCLUDING FILE: MENU_SEC.SUB
34795>>>
34795>>>Use Idiotht.pkg
INCLUDING FILE: IDIOTHT.PKG
34795>>>>>
34795>>>>>Open Users
34797>>>>>Open UserGrps
INCLUDING FILE: USERGRPS.FD
34799>>>>>Open Pedia
INCLUDING FILE: PEDIA.FD
34801>>>>>Open Arxeia
INCLUDING FILE: ARXEIA.FD
34803>>>>>Open GrpPedia
INCLUDING FILE: GRPPEDIA.FD
34805>>>>>Open GrpPed0
INCLUDING FILE: GRPPED0.FD
34807>>>>>Open GrpArx
INCLUDING FILE: GRPARX.FD
34809>>>>>Open GrpArx0
INCLUDING FILE: GRPARX0.FD
34811>>>>>Open ViewFlds
INCLUDING FILE: VIEWFLDS.FD
34813>>>>>Open Oth
INCLUDING FILE: OTH.FD
34815>>>>>Open GrpOth
INCLUDING FILE: GRPOTH.FD
34817>>>>>Open GrpOth0
INCLUDING FILE: GRPOTH0.FD
34819>>>>>Open Departm
INCLUDING FILE: DEPARTM.FD
34821>>>>>
34821>>>>>
34821>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
34822>>>>>
34822>>>>>Function Network_User_Name Returns String
34823>>>>>    Local String sName sLength
34824>>>>>    Local Pointer lpName_Addr lpLength_Addr
34824>>>>>    Local Integer iRetval
34824>>>>>    Movestr (Repeat (Character (0), 255)) To sName
34825>>>>>>
34825>>>>>    GetAddress Of sName To lpName_Addr
34826>>>>>    Movestr (DwordToBytes (255)) To sLength
34827>>>>>>
34827>>>>>    GetAddress Of sLength To lpLength_Addr
34828>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
34829>>>>>>
34829>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
34832>>>>>    Else Function_Return "User Unknown"
34834>>>>>End_Function // Network_User_Name
34835>>>>>
34835>>>>>Function fsGetOfficePath Global Returns String
34836>>>>>    String sRegistryKeyPath sRegOfficePath
34837>>>>>    Set_Registry_Root                                                   to HKEY_LOCAL_MACHINE "Software"
34838>>>>>    Move "Microsoft\Office\9.0\Word"                                    to sRegistryKeyPath
34839>>>>>    Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path"    to sRegOfficePath
34843>>>>>    Move (Trim(sRegOfficePath))                                         to sRegOfficePath
34844>>>>>    If (sRegOfficePath='') Begin
34846>>>>>        Move "Microsoft\Office\8.0\Word"                                to sRegistryKeyPath
34847>>>>>        Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34851>>>>>        Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34852>>>>>        If (sRegOfficePath='') Begin
34854>>>>>            Move "Microsoft\Office\7.0\Word"                             to sRegistryKeyPath
34855>>>>>            Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34859>>>>>            Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34860>>>>>            If (sRegOfficePath='') Begin
34862>>>>>                Move "Microsoft\Office\10.0\Word"                                to sRegistryKeyPath
34863>>>>>                Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34867>>>>>                Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34868>>>>>            End
34868>>>>>>
34868>>>>>        End
34868>>>>>>
34868>>>>>    End
34868>>>>>>
34868>>>>>    Function_Return sRegOfficePath
34869>>>>>End_Procedure
34870>>>>>
34870>>>>>
34870>>>>>Function fsGetLastDir Global Returns String
34871>>>>>    String sRegistryKeyPath sRegDir sUserName
34872>>>>>    Get Network_User_Name to sUserName
34873>>>>>
34873>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
34876>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
34879>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
34881>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
34883>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
34884>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
34885>>>>>    Get_profile_string sRegistryKeyPath "Path" to sRegDir
34888>>>>>    Function_Return sRegDir
34889>>>>>End_Procedure
34890>>>>>
34890>>>>>Function fiPutLastDir Global String asDirectory Returns Integer
34891>>>>>    String sRegistryKeyPath sRegDir sUserName
34892>>>>>    Get Network_User_Name to sUserName
34893>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
34896>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
34899>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
34901>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
34903>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
34904>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
34905>>>>>    Set_profile_string sRegistryKeyPath "Path" to asDirectory
34908>>>>>    Function_Return 0
34909>>>>>End_Procedure
34910>>>>>
34910>>>>>
34910>>>>>Function fsVresExt Global String asFileName Returns String
34911>>>>>    String rVal
34912>>>>>    Integer iPos iLen
34912>>>>>    Move (UpperCase(asFileName)) to asFileName
34913>>>>>    Move (Trim(asFileName)) to asFileName
34914>>>>>    Move 0 to iPos
34915>>>>>    For iLen from 1 to (length(asFileName))
34921>>>>>>
34921>>>>>        If (Mid(asFileName,1,iLen)='.') Move iLen to iPos
34924>>>>>    Loop
34925>>>>>>
34925>>>>>    If (Not(iPos)) Function_Return ''
34928>>>>>    Move (Right(asFileName,(Length(asFileName)-iPos))) to rVal
34929>>>>>    Move (Trim(rVal)) to rVal
34930>>>>>    Function_Return rVal
34931>>>>>End_Function
34932>>>>>
34932>>>>>
34932>>>>>Function fiScreenFieldStatus Global String asViewName String asDbFormName Returns Integer
34933>>>>>    Integer rVal iUser iGroup
34934>>>>>    String  sUser sRecr
34934>>>>>    Move (Trim(asViewName))     to asViewName
34935>>>>>    Move (Trim(asDbFormName))   to asDbFormName
34936>>>>>
34936>>>>>    If ((asViewName<>'') And (asDbFormName<>'')) Begin
34938>>>>>        Get fsLoginUserID to sUser
34939>>>>>        Clear Users
34940>>>>>        Move sUser        to Users.Login_ID
34941>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34942>>>>>>
34942>>>>>        If (Found=1) Begin
34944>>>>>            Move Users.User_ID  to iUser
34945>>>>>            Move Users.Grp_ID   to iGroup
34946>>>>>            Clear GrpOth
34947>>>>>            Move iUser          to GrpOth.User_ID
34948>>>>>            Move asViewName     to GrpOth.View_Name
34949>>>>>            Move asDbFormName   to GrpOth.Scr_Field_Name
34950>>>>>            Find eq GrpOth by Index.2 // GrpOth:Index.2:User_ID+View_Name+Scr_Field_Name
34951>>>>>>
34951>>>>>            If (Found=1) Begin
34953>>>>>                // rVal=1 ==> NO READ ALLOWED
34953>>>>>                // rVal=2 ==> NO EDIT BUT CAN COPY
34953>>>>>                // rVal=3 ==> NO EDIT AND NO COPY
34953>>>>>                If (GrpOth.Allow_Read <>'1') Move 1 to rVal
34956>>>>>                Else Begin
34957>>>>>                    If (GrpOth.Allow_Change<>'1') Begin
34959>>>>>                        If (GrpOth.Allow_Copy<>'1') Move 3 to rVal
34962>>>>>                        Else                        Move 2 to rVal
34964>>>>>                    End
34964>>>>>>
34964>>>>>                End
34964>>>>>>
34964>>>>>            End
34964>>>>>>
34964>>>>>            Else Begin
34965>>>>>                Clear GrpOth0
34966>>>>>                Move iGroup         to GrpOth0.Group_ID
34967>>>>>                Move asViewName     to GrpOth0.View_Name
34968>>>>>                Move asDbFormName   to GrpOth0.Scr_Field_Name
34969>>>>>
34969>>>>>                Find eq GrpOth0 by Index.2 // GrpOth0:Index.2:Group_ID+View_Name+Scr_Field_Name
34970>>>>>>
34970>>>>>                If (Found=1) Begin
34972>>>>>                    // rVal=1 ==> NO READ ALLOWED
34972>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
34972>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
34972>>>>>                    If (GrpOth0.Allow_Read <>'1') Move 1 to rVal
34975>>>>>                    Else Begin
34976>>>>>                        If (GrpOth0.Allow_Change<>'1') Begin
34978>>>>>                            If (GrpOth0.Allow_Copy<>'1') Move 3 to rVal
34981>>>>>                            Else                         Move 2 to rVal
34983>>>>>                        End
34983>>>>>>
34983>>>>>                    End
34983>>>>>>
34983>>>>>                End
34983>>>>>>
34983>>>>>                Else Move 0 to rVal
34985>>>>>            End
34985>>>>>>
34985>>>>>        End
34985>>>>>>
34985>>>>>        Else Move 0 to rVal
34987>>>>>    End
34987>>>>>>
34987>>>>>    Function_Return rVal
34988>>>>>End_Function
34989>>>>>
34989>>>>>Function fiFieldStatus Global Integer aiFileNumber Integer aiFieldNumber Returns Integer
34990>>>>>    Integer rVal iUser iGroup
34991>>>>>    String  sUser sRecr
34991>>>>>    If ((aiFileNumber) And (aiFieldNumber)) Begin
34993>>>>>        Get fsLoginUserID to sUser
34994>>>>>        Clear Users
34995>>>>>        Move sUser        to Users.Login_ID
34996>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34997>>>>>>
34997>>>>>        If (Found=1) Begin
34999>>>>>            Move Users.User_ID  to iUser
35000>>>>>            Move Users.Grp_ID   to iGroup
35001>>>>>            Clear Pedia
35002>>>>>            Move aiFileNumber  to Pedia.Arxeio_ID
35003>>>>>            Move aiFieldNumber to Pedia.Pedio_Number
35004>>>>>            Find eq Pedia By Index.1 // Pedia:Index.1:Arxeio_ID+Pedio_Number
35005>>>>>>
35005>>>>>            If (Found=1) Begin
35007>>>>>                Move (Trim(Pedia.Pedio_Recr))   to sRecr
35008>>>>>                // Find Combination User/File/Field in GRPPEDIA
35008>>>>>                Clear GrpPedia
35009>>>>>                Move iUser                      to GrpPedia.User_ID
35010>>>>>                Move (Trim(sRecr))              to GrpPedia.Pedio_Recr
35011>>>>>                Find eq GrpPedia by Index.4 // GrpPedia:Index.4:Pedio_Recr + User_ID
35012>>>>>>
35012>>>>>                If (Found=1) Begin
35014>>>>>                    // rVal=1 ==> NO READ ALLOWED
35014>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
35014>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
35014>>>>>                    If (GrpPedia.Allow_Read <>'1') Move 1 to rVal
35017>>>>>                    Else Begin
35018>>>>>                        If (GrpPedia.Allow_Change<>'1') Begin
35020>>>>>                            If (GrpPedia.Allow_Copy<>'1')   Move 3 to rVal
35023>>>>>                            Else                            Move 2 to rVal
35025>>>>>                        End
35025>>>>>>
35025>>>>>                    End
35025>>>>>>
35025>>>>>                End
35025>>>>>>
35025>>>>>                Else Begin
35026>>>>>                    // Find Combination UserGrps/File/Field in GRPPED0
35026>>>>>                    Clear GrpPed0
35027>>>>>                    Move iGroup         to GrpPed0.Group_ID
35028>>>>>                    Move (Trim(sRecr))  to GrpPed0.Pedio_Recr
35029>>>>>                    Find eq GrpPed0 by Index.4 // GrpPed0:Index.4:Pedio_Recr + Group_ID
35030>>>>>>
35030>>>>>                    If (Found=1) Begin
35032>>>>>                        // rVal=1 ==> NO READ ALLOWED
35032>>>>>                        // rVal=2 ==> NO EDIT BUT CAN COPY
35032>>>>>                        // rVal=3 ==> NO EDIT AND NO COPY
35032>>>>>                        If (GrpPed0.Allow_Read <>'1') Move 1 to rVal
35035>>>>>                        Else Begin
35036>>>>>                            If (GrpPed0.Allow_Change<>'1') Begin
35038>>>>>                                If (GrpPed0.Allow_Copy<>'1')   Move 3 to rVal
35041>>>>>                                Else                           Move 2 to rVal
35043>>>>>                            End
35043>>>>>>
35043>>>>>                        End
35043>>>>>>
35043>>>>>                    End
35043>>>>>>
35043>>>>>                End
35043>>>>>>
35043>>>>>            End
35043>>>>>>
35043>>>>>            Else Begin
35044>>>>>                Move 0 to rVal
35045>>>>>            End
35045>>>>>>
35045>>>>>        End
35045>>>>>>
35045>>>>>        Else Begin
35046>>>>>            Move 0 to rVal
35047>>>>>        End
35047>>>>>>
35047>>>>>    End
35047>>>>>>
35047>>>>>    Function_Return rVal
35048>>>>>End_Function
35049>>>>>
35049>>>>>Function fsReturnFileFromPath Global String asFullPath Returns String
35050>>>>>    String rVal lsDirSep
35051>>>>>    Integer iPos iMet iLen iCnt
35051>>>>>    Move (Trim(asFullPath))                 To rVal
35052>>>>>    Move (Sysconf(SYSCONF_DIR_SEPARATOR))   To lsDirSep
35053>>>>>    If (rVal Contains lsDirSep) Begin
35055>>>>>        Move (Length(rVal)) to iLen
35056>>>>>        Move iLen to iCnt
35057>>>>>        While iCnt Gt 0
35061>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Begin
35063>>>>>                If (iCnt=iLen) Function_Return asFullPath
35066>>>>>                Else Function_Return (Right(rVal,(iLen-iCnt)))
35068>>>>>            End
35068>>>>>>
35068>>>>>            Decrement iCnt
35069>>>>>        End // While iCnt Gt 0
35070>>>>>>
35070>>>>>    End
35070>>>>>>
35070>>>>>    Else  Function_Return (Trim(asFullPath))
35072>>>>>    Function_Return rVal
35073>>>>>End_Function
35074>>>>>
35074>>>>>Function fsReturnDirectoriesFromPath Global String asFullPath Returns String
35075>>>>>    String rVal lsDirSep
35076>>>>>    Integer iPos iMet iLen iCnt
35076>>>>>    Move (Trim(asFullPath))                 To rVal
35077>>>>>    Move (Sysconf(SYSCOnF_DIR_SEPARATOR))   To lsDirSep
35078>>>>>    If (rVal Contains lsDirSep) Begin
35080>>>>>        Move (Length(rVal)) to iLen
35081>>>>>        Move iLen to iCnt
35082>>>>>        While iCnt Gt 0
35086>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Function_Return (Left(rVal,iCnt))
35089>>>>>            Decrement iCnt
35090>>>>>        End // While iCnt Gt 0
35091>>>>>>
35091>>>>>    End
35091>>>>>>
35091>>>>>    Function_Return rVal
35092>>>>>End_Function
35093>>>>>
35093>>>>>//Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
35093>>>>>//    Local String rVal lsTmp lsOO lsLL
35093>>>>>//    Local Number lnOO lnLL
35093>>>>>
35093>>>>>//    Move '' to lsOO
35093>>>>>//    Move '' to lsLL
35093>>>>>//    Move '' to rVal
35093>>>>>
35093>>>>>//    Move (Integer(anTime))                              to lnOO
35093>>>>>//    ////////////////////////////////////////////
35093>>>>>//    // sos sos sos jsjsjsjsjs yannis 30/03/2000
35093>>>>>//    //If ((lnOO=24) and (lnll=0)) Move 0 to lnOO
35093>>>>>//    ////////////////////////////////////////////
35093>>>>>
35093>>>>>//    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
35093>>>>>
35093>>>>>//    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
35093>>>>>//    Else         Move (String(lnOO))                    to lsOO
35093>>>>>//    Move (Trim(lsOO))                                   to lsOO
35093>>>>>
35093>>>>>//    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
35093>>>>>//    Else         Move (String(lnLL))                    to lsLL
35093>>>>>//    Move (Trim(lsLL))                                   to lsLL
35093>>>>>
35093>>>>>//    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
35093>>>>>
35093>>>>>//    Move (Trim(rVal)) to rVal
35093>>>>>
35093>>>>>//    Function_Return rVal
35093>>>>>//End_Function
35093>>>>>
35093>>>>>//Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
35093>>>>>//    Local Number rVal nOres nLepta
35093>>>>>//    Move (Integer(aiMinutes/60))    to nOres
35093>>>>>//    Move (    Mod(aiMinutes,60))    to nLepta
35093>>>>>//    Move (nOres+(nLepta/100))       to rVal
35093>>>>>//    Function_Return rVal
35093>>>>>//End_Function
35093>>>>>
35093>>>>>//Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
35093>>>>>//    Local Integer rVal
35093>>>>>//    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
35093>>>>>//    Function_Return rVal
35093>>>>>//End_Function
35093>>>>>
35093>>>>>//Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;
35093>>>>>//                                                                    Number anEndTime    ;
35093>>>>>//                                                                    Returns Integer
35093>>>>>//    Local Integer rVal iMinStart iMinEnd
35093>>>>>
35093>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
35093>>>>>
35093>>>>>//    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
35093>>>>>//    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
35093>>>>>//    Move (iMinEnd-iMinStart)                                                     to rVal
35093>>>>>//    Function_Return rVal
35093>>>>>//End_Function
35093>>>>>
35093>>>>>
35093>>>>>//Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;
35093>>>>>//                                                                Number anEndTime    ;
35093>>>>>//                                                                Returns Number
35093>>>>>//    Local Integer iTmp
35093>>>>>//    Local Number  rVal
35093>>>>>
35093>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
35093>>>>>
35093>>>>>//    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
35093>>>>>//    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
35093>>>>>//    Function_Return rVal
35093>>>>>//End_Function
35093>>>>>
35093>>>>>
35093>>>>>Function fsLoginUserID Global Returns String
35094>>>>>    Local String LastLogin# LoginUserid#
35095>>>>>    get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin#
35098>>>>>    If LastLogin# eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin#
35101>>>>>    insert "WorkSpaces\" in LastLogin# at 1
35103>>>>>    Append LastLogin# "\" (Module_Name(Self)) "\LastLogin"
35106>>>>>    get_profile_string LastLogin# "LoginUserId"  to LoginUserId#
35109>>>>>    Trim LoginUserID# to LoginUserID#
35110>>>>>>
35110>>>>>    If LoginUserId# eq "" Move (Network_User_Name(Current_Object)) to LoginUserId#
35113>>>>>    Function_Return LoginUserID#
35114>>>>>End_Function
35115>>>>>
35115>>>>>Function fiWriteRegistryLastSDFPath Global String asLastPath Returns Integer
35116>>>>>    Integer rVal
35117>>>>>    String  lsCurrentWksp
35117>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35120>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35123>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35125>>>>>    // Œœ¦ ¡¢œ ›   - Last_SDF_Path -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
35125>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
35125>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
35128>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
35131>>>>>    Function_Return rVal
35132>>>>>End_Function
35133>>>>>
35133>>>>>
35133>>>>>Function fsReadRegistryLastSDFPath Global Returns String
35134>>>>>    String rVal lsCurrentWksp
35135>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35138>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35141>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35143>>>>>    // Œœ¦ ¡¢œ ›   - LastParastUsed -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
35143>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
35143>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
35146>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
35149>>>>>    Function_Return (Trim(rVal))
35150>>>>>End_Function
35151>>>>>
35151>>>>>
35151>>>>>Function fiWriteRegistryLastMCryptPath Global String asLastPath Returns Integer
35152>>>>>    Integer rVal
35153>>>>>    String  lsCurrentWksp
35153>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35156>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35159>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35161>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
35164>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
35167>>>>>    Function_Return rVal
35168>>>>>End_Function
35169>>>>>
35169>>>>>
35169>>>>>Function fsReadRegistryLastMCryptPath Global Returns String
35170>>>>>    String rVal lsCurrentWksp
35171>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35174>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35177>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35179>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
35182>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
35185>>>>>    Function_Return (Trim(rVal))
35186>>>>>End_Function
35187>>>>>
35187>>>>>Function fiWriteRegistryLastWEBPath Global String asLastPath Returns Integer
35188>>>>>    Integer rVal
35189>>>>>    String  lsCurrentWksp
35189>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35192>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35195>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35197>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
35200>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
35203>>>>>    Function_Return rVal
35204>>>>>End_Function
35205>>>>>
35205>>>>>
35205>>>>>Function fsReadRegistryLastWEBPath Global Returns String
35206>>>>>    String rVal lsCurrentWksp
35207>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35210>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35213>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35215>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
35218>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
35221>>>>>    Function_Return (Trim(rVal))
35222>>>>>End_Function
35223>>>>>
35223>>>>>Function fsReadRegistryFEMRootDir Global Returns String
35224>>>>>    String rVal lsCurrentWksp
35225>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35228>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35231>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35233>>>>>    Append lsCurrentWksp "\FEM"
35234>>>>>    Get_Profile_String lsCurrentWksp "RootDir"  to rVal
35237>>>>>    Function_Return (Trim(rVal))
35238>>>>>End_Function
35239>>>>>
35239>>>>>Function fsReadRegistryFEMDevicePath Global Returns String
35240>>>>>    String rVal lsCurrentWksp
35241>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35244>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35247>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35249>>>>>    Append lsCurrentWksp "\FEM"
35250>>>>>    Get_Profile_String lsCurrentWksp "DevicePath"  to rVal
35253>>>>>    Function_Return (Trim(rVal))
35254>>>>>End_Function
35255>>>>>
35255>>>>>Function fiWriteRegistryFEMRootDir Global Returns Integer
35256>>>>>    Integer rVal
35257>>>>>    String  lsCurrentWksp
35257>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35260>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35263>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35265>>>>>    Append lsCurrentWksp "\FEM"
35266>>>>>    Set_Profile_String lsCurrentWksp "RootDir"  to "C:\FEM_ROOT\"
35269>>>>>    Function_Return rVal
35270>>>>>End_Function
35271>>>>>
35271>>>>>Function fiWriteRegistryFEMDevicePath Global Returns Integer
35272>>>>>    Integer rVal
35273>>>>>    String  lsCurrentWksp
35273>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35276>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35279>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35281>>>>>    Append lsCurrentWksp "\FEM"
35282>>>>>    Set_Profile_String lsCurrentWksp "DevicePath"  to "C:\FEM_ROOT\Device_File1.dat"
35285>>>>>    Function_Return rVal
35286>>>>>End_Function
35287>>>>>
35287>>>>>
35287>>>>>
35287>>>>>
35287>>>>>
35287>>>>>Function fig_Is_Admin Global Returns Integer
35288>>>>>    String sUser
35289>>>>>    Integer rVal
35289>>>>>    Get fsLoginUserID to sUser
35290>>>>>    Move (trim(sUser)) to sUser
35291>>>>>    Clear Users
35292>>>>>    Move sUser to Users.Login_ID
35293>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35294>>>>>>
35294>>>>>    Move Users.Admin_Rights to rVal
35295>>>>>    Function_Return rVal
35296>>>>>End_Function
35297>>>>>
35297>>>>>Function fig_The_User_Group Global Returns Integer
35298>>>>>    String sUser
35299>>>>>    Get fsLoginUserID   to sUser
35300>>>>>    Move (trim(sUser))  to sUser
35301>>>>>    Clear Users
35302>>>>>    Move sUser          to Users.Login_ID
35303>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35304>>>>>>
35304>>>>>    Clear UserGrps
35305>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
35306>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
35307>>>>>>
35307>>>>>    Function_Return UserGrps.Grp_ID
35308>>>>>End_Function
35309>>>>>
35309>>>>>Function fsg_The_User_Department Global Returns String
35310>>>>>    String sUser
35311>>>>>    Get fsLoginUserID   to sUser
35312>>>>>    Move (trim(sUser))  to sUser
35313>>>>>    Clear Users
35314>>>>>    Move sUser          to Users.Login_ID
35315>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35316>>>>>>
35316>>>>>    Clear Departm
35317>>>>>    Move Users.Departm_Code   to Departm.Code
35318>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
35319>>>>>>
35319>>>>>    Function_Return Departm.Code
35320>>>>>End_Function
35321>>>>>
35321>>>>>
35321>>>>>Function fig_Is_Specific_Admin Global String asUser Returns Integer
35322>>>>>    Integer rVal
35323>>>>>    Move (trim(asUser)) to asUser
35324>>>>>    Clear Users
35325>>>>>    Move asUser to Users.Login_ID
35326>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35327>>>>>>
35327>>>>>    Move Users.Admin_Rights to rVal
35328>>>>>    Function_Return rVal
35329>>>>>End_Function
35330>>>>>
35330>>>>>Function fig_The_Specific_User_Group Global String asUser Returns Integer
35331>>>>>    Move (trim(asUser))  to asUser
35332>>>>>    Clear Users
35333>>>>>    Move asUser          to Users.Login_ID
35334>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35335>>>>>>
35335>>>>>    Clear UserGrps
35336>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
35337>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
35338>>>>>>
35338>>>>>    Function_Return UserGrps.Grp_ID
35339>>>>>End_Function
35340>>>>>
35340>>>>>Function fsg_The_Specific_User_Department Global String asUser Returns String
35341>>>>>    Move (trim(asUser))  to asUser
35342>>>>>    Clear Users
35343>>>>>    Move asUser          to Users.Login_ID
35344>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35345>>>>>>
35345>>>>>    Clear Departm
35346>>>>>    Move Users.Departm_Code   to Departm.Code
35347>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
35348>>>>>>
35348>>>>>    Function_Return Departm.Code
35349>>>>>End_Function
35350>>>>>
35350>>>>>
35350>>>
35350>>>Class ViewPopupMenu_Sec Is A ViewPopupMenu
35351>>>
35351>>>    Open Sysfile
INCLUDING FILE: SYSFILE.FD
35353>>>    Open Users
35355>>>    Open Views
INCLUDING FILE: VIEWS.FD
35357>>>    Open GrpViews
INCLUDING FILE: GRPVIEWS.FD
35359>>>    Open GrpView0
INCLUDING FILE: GRPVIEW0.FD
35361>>>    Open Arxeia
35363>>>    Open GrpArx
35365>>>
35365>>>    Function Find_User_Rights_In_Class String asView Returns Integer
35366>>>        String  lsView lsLogin
35367>>>        Integer liUser  liViews iGroup
35367>>>
35367>>>        Move (fsLoginUserID())      to lsLogin
35368>>>        Move (Trim(ToOEM(asView)))  to lsView
35369>>>
35369>>>        //////  /////////////////////////////////////
35369>>>        Clear Users
35370>>>        Move lsLogin    to Users.Login_ID
35371>>>
35371>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
35372>>>>
35372>>>        If (Found=1)  Begin
35374>>>            Move Users.User_ID  to liUser
35375>>>            Move Users.Grp_ID   to iGroup
35376>>>        End
35376>>>>
35376>>>        Else Function_Return 0
35378>>>
35378>>>        Clear Views
35379>>>        Move (Trim(lsView)) to Views.Menu_Name
35380>>>        Find eq Views by Index.2 // Views:Index.2:Views.Menu_Name
35381>>>>
35381>>>        If (Found=1) Begin
35383>>>            Move Views.View_ID to liViews
35384>>>            Clear GrpViews
35385>>>            Move liUser    to GrpViews.User_ID
35386>>>            Move liViews   to GrpViews.View_ID
35387>>>            Find Eq GrpViews by Index.1 // GrpViews:Index.1:GrpViews.User_ID+GrpViews.View_ID
35388>>>>
35388>>>            If (Found=1) Begin // And (liUser=GrpViews.User_ID) And (liViews=GrpViews.View_ID)) Begin
35390>>>                Function_Return (GrpViews.Allow_Read<>'1')
35391>>>            End
35391>>>>
35391>>>            Else Begin
35392>>>                Clear GrpView0
35393>>>                Move iGroup    to GrpView0.Group_ID
35394>>>                Move liViews   to GrpView0.View_ID
35395>>>                Find eq GrpView0 by Index.1 // GrpView0:Index.1:Group_ID+View_ID
35396>>>>
35396>>>                If (Found=1) Begin
35398>>>                    Function_Return (GrpView0.Allow_Read<>'1')
35399>>>                End
35399>>>>
35399>>>                Else         Function_Return 0
35401>>>            End
35401>>>>
35401>>>        End
35401>>>>
35401>>>        Else Function_Return 0
35403>>>    End_Function
35404>>>
35404>>>//    Procedure Enhmerose_Views_File_In_Class
35404>>>//        Integer liCount liInt liLastNo
35404>>>//        String lsStr
35404>>>//        Get Item_Count to liCount
35404>>>//        // find last view_id
35404>>>//        Clear Views
35404>>>//        Move 9999 to Views.View_ID
35404>>>//        Find lt Views by index.1 // view_id
35404>>>//        If (Found=1)    Move Views.View_ID  to liLastNo
35404>>>//        Else            Move 0              to liLastNo
35404>>>//        For liInt From 0 to (liCount-1)
35404>>>//            Get Value item liInt to lsStr
35404>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
35404>>>//            //Move (Trim(lsStr)) to lsStr
35404>>>//            If (lsStr<>'') Begin
35404>>>//                Clear Views
35404>>>//                Move lsStr to Views.Menu_Name
35404>>>//                Find eq Views by index.2 // Views.Menu_Name
35404>>>//                If (NOT(Found)) Begin
35404>>>//                    Add 1 to liLastNo
35404>>>//                    Move liLastNo to Views.View_ID
35404>>>//                    Saverecord Views
35404>>>//                End
35404>>>//            End
35404>>>//        Loop
35404>>>//        For liInt From 0 to (liCount-1)
35404>>>//            Get Value item liInt to lsStr
35404>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
35404>>>//            //Move (Trim(lsStr)) to lsStr
35404>>>//            If (lsStr<>'') Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
35404>>>//        Loop
35404>>>//    End_procedure
35404>>>
35404>>>    Procedure OnInitMenu
35405>>>        Integer liCount liInt liLastNo
35406>>>        String lsStr
35406>>>
35406>>>        Get Item_Count to liCount
35407>>>
35407>>>        // find last view_id
35407>>>        Clear Views
35408>>>        Move 9999 to Views.View_ID
35409>>>        Find lt Views by index.1 // view_id
35410>>>>
35410>>>        If (Found=1)    Move Views.View_ID  to liLastNo
35413>>>        Else            Move 0              to liLastNo
35415>>>        For liInt From 0 to (liCount-1)
35421>>>>
35421>>>            Get Value item liInt to lsStr
35422>>>            Move (Trim(lsStr)) to lsStr
35423>>>            If ((lsStr<>'') and (Length(lsStr)>2)) Begin
35425>>>                Clear Views
35426>>>                Move (ToOEM(lsStr)) to Views.Menu_Name
35427>>>                Find eq Views by index.2 // Views.Menu_Name
35428>>>>
35428>>>                If (NOT(Found)) Begin
35430>>>                    Add 1 to liLastNo
35431>>>                    Move liLastNo to Views.View_ID
35432>>>                    //Move (ToOEM(lsStr)) to Views.Menu_Name
35432>>>                    Saverecord Views
35433>>>                End
35433>>>>
35433>>>            End
35433>>>>
35433>>>        Loop
35434>>>>
35434>>>        For liInt From 0 to (liCount-1)
35440>>>>
35440>>>            Get Value item liInt to lsStr
35441>>>            Move (Trim(lsStr)) to lsStr
35442>>>            Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
35443>>>        Loop
35444>>>>
35444>>>
35444>>>    End_procedure
35445>>>
35445>>>//    Procedure End_Construct_Object
35445>>>//        Forward Send End_Construct_Object
35445>>>//        Send Enhmerose_Views_File_In_Class
35445>>>//    End_Procedure
35445>>>
35445>>>End_Class //ButtonSub
35446>>>
35446>>>
35446>Use DD_Sec.Sub
INCLUDING FILE: DD_SEC.SUB
35446>>>
35446>>>Open Sysfile
35448>>>Open UserGrps
35450>>>Open Users
35452>>>Open Views
35454>>>Open GrpViews
35456>>>Open Arxeia
35458>>>Open GrpArx
35460>>>Open GrpArx0
35462>>>Open GrpView0
35464>>>
35464>>>Use DD.Sub
35464>>>
35464>>>Class Datadictionary_Sec  Is A DatadictionarySub
35465>>>
35465>>>
35465>>>    Procedure Construct_Object
35466>>>        Forward Send Construct_Object
35468>>>        Property Integer cpiUpdate              0
35469>>>        Property Integer cpiBackout             0
35470>>>        Property Integer cpiEditing             0
35471>>>        Property Integer cpiFileNumber          0
35472>>>        Property String  cpsFileName            ''
35473>>>        Property String  cpsLoginID             ''
35474>>>        Property Integer cpiCannot_Read         0
35475>>>        Property Integer cpiCannot_Create       0
35476>>>        Property Integer cpiCannot_Delete       0
35477>>>        Property Integer cpiCannot_Edit         0
35478>>>        Property Integer piFN                   0
35479>>>    End_Procedure
35480>>>
35480>>>//    Procedure Save_Main_File
35480>>>//        If (Operation_Origin<>Self) Begin
35480>>>//            If Indirect_File.Recnum Eq 0 Procedure_Return
35480>>>//        End
35480>>>//        Forward Send Save_Main_File
35480>>>//    End_Procedure
35480>>>
35480>>>
35480>>>
35480>>>    Function Validate_Save Returns Integer
35481>>>        Integer rVal
35482>>>        Forward Get Validate_Save to rVal
35484>>>        If (Not(rVal)) Begin
35486>>>            Get cpiCannot_Read to rVal
35487>>>            If (Not(rVal)) Begin
35489>>>                Set cpiEditing to ((cpiBackout(Self)=1) and (cpiUpdate(Self)=1))
35490>>>                If (cpiEditing(Self)=1) Get cpiCannot_Edit      to rVal
35493>>>                Else                    Get cpiCannot_Create    to rVal
35495>>>            End
35495>>>>
35495>>>            If (rVal) Send Operation_Not_Allowed rVal
35498>>>        End
35498>>>>
35498>>>        Function_Return rVal
35499>>>    End_Function
35500>>>
35500>>>    Function Validate_Delete Returns Integer
35501>>>        Integer rVal
35502>>>        Forward Get Validate_Delete to rVal
35504>>>        If (Not(rVal)) Begin
35506>>>            Get cpiCannot_Read to rVal
35507>>>            If (Not(rVal)) Get cpiCannot_Delete to rVal
35510>>>            If (rVal) Send Operation_Not_Allowed rVal
35513>>>        End
35513>>>>
35513>>>        Function_Return rVal
35514>>>    End_Function
35515>>>
35515>>>    Procedure End_Construct_Object
35516>>>        Integer liSrv rVal
35517>>>        String lsStr
35517>>>        Forward Send End_Construct_Object
35519>>>        Get Main_File                                   To liSrv
35520>>>        Set cpiFileNumber                               To liSrv
35521>>>        Get_Attribute DF_FILE_PHYSICAL_NAME Of liSrv    To lsStr
35524>>>        Set cpsFileName                                 To (Trim(Uppercase(lsStr)))
35525>>>        Set cpsLoginID                                  To (fsLoginUserID())
35526>>>        Send Find_User_Rights
35527>>>        Set piFN to lisrv
35528>>>    End_Procedure
35529>>>
35529>>>    Procedure Find_User_Rights
35530>>>        String lsArxeio lsLogin
35531>>>        Integer liUser liArxeio iGroup
35531>>>
35531>>>        Get cpiFileNumber   to liArxeio
35532>>>        Get cpsFileName     to lsArxeio
35533>>>        Get cpsLoginID      to lsLogin
35534>>>
35534>>>        Clear Users
35535>>>        Move lsLogin    to Users.Login_ID
35536>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
35537>>>>
35537>>>        If (Found=1)  Begin
35539>>>            Move Users.User_ID  to liUser
35540>>>            Move Users.Grp_ID   to iGroup
35541>>>        End
35541>>>>
35541>>>        //Else Send Operation_Not_Allowed 9999
35541>>>
35541>>>        Clear Arxeia
35542>>>
35542>>>        Move liArxeio to Arxeia.Arxeio_ID
35543>>>        Find eq Arxeia by Index.1 // Arxeia:Index.1:Arxeia.Arxeio_ID
35544>>>>
35544>>>
35544>>>        If (Found=1) Begin
35546>>>            Move Arxeia.Arxeio_ID to liArxeio
35547>>>
35547>>>            Clear GrpArx
35548>>>            Move liUser     to GrpArx.User_ID
35549>>>            Move liArxeio   to GrpArx.Arxeio_ID
35550>>>            Find eq GrpArx by Index.1 // GrpArx:Index.1:GrpArx.User_ID+GrpArx.Arxeio_ID
35551>>>>
35551>>>            If (Found=1) Begin
35553>>>               If (GrpArx.Allow_Read  ='1') Set cpiCannot_Read   to 0
35556>>>               Else                         Set cpiCannot_Read   to 10003
35558>>>               If (GrpArx.Allow_Create='1') Set cpiCannot_Create to 0
35561>>>               Else                         Set cpiCannot_Create to 10000
35563>>>               If (GrpArx.Allow_Change='1') Set cpiCannot_Edit   to 0
35566>>>               Else                         Set cpiCannot_Edit   to 10001
35568>>>               If (GrpArx.Allow_Delete='1') Set cpiCannot_Delete to 0
35571>>>               Else                         Set cpiCannot_Delete to 10002
35573>>>            End
35573>>>>
35573>>>            Else Begin
35574>>>                Clear GrpArx0
35575>>>                Move iGroup   to GrpArx0.Group_ID
35576>>>                Move liArxeio to GrpArx0.Arxeio_ID
35577>>>                Find eq GrpArx0 by Index.1 // GrpArx0:Index.1:Group_ID+Arxeio_ID
35578>>>>
35578>>>                If (Found=1) Begin
35580>>>                    If (GrpArx0.Allow_Read  ='1')   Set cpiCannot_Read   to 0
35583>>>                    Else                            Set cpiCannot_Read   to 20003
35585>>>                    If (GrpArx0.Allow_Create='1')   Set cpiCannot_Create to 0
35588>>>                    Else                            Set cpiCannot_Create to 20000
35590>>>                    If (GrpArx0.Allow_Change='1')   Set cpiCannot_Edit   to 0
35593>>>                    Else                            Set cpiCannot_Edit   to 20001
35595>>>                    If (GrpArx0.Allow_Delete='1')   Set cpiCannot_Delete to 0
35598>>>                    Else                            Set cpiCannot_Delete to 20002
35600>>>                End
35600>>>>
35600>>>                Else Begin
35601>>>                    Set cpiCannot_Read   to 0
35602>>>                    Set cpiCannot_Edit   to 0
35603>>>                    Set cpiCannot_Create to 0
35604>>>                    Set cpiCannot_Delete to 0
35605>>>                End
35605>>>>
35605>>>            End
35605>>>>
35605>>>        End
35605>>>>
35605>>>        Else Begin
35606>>>            // €¤ ›œ¤ ™¨œŸœ  «¦ ˜¨®œ ¦ «¦«œ Ÿœà¨¦¬£œ ¦«  ¦ ®¨ž©«žª œ®œ  §¨¦©™˜©ž ©'˜¬«¦
35606>>>            Set cpiCannot_Read   to 0
35607>>>            Set cpiCannot_Edit   to 0
35608>>>            Set cpiCannot_Create to 0
35609>>>            Set cpiCannot_Delete to 0
35610>>>        End
35610>>>>
35610>>>    End_Procedure
35611>>>
35611>>>    Procedure Clear_main_file
35612>>>        Forward Send Clear_main_file
35614>>>        Set cpiBackout to 0
35615>>>        Set cpiUpdate  to 0
35616>>>    End_Procedure
35617>>>
35617>>>    Procedure Update
35618>>>        Forward Send Update
35620>>>        Set cpiUpdate to 1
35621>>>    End_Procedure
35622>>>
35622>>>    Procedure Backout
35623>>>        Forward Send Backout
35625>>>        Set cpiBackout to 1
35626>>>    End_Procedure
35627>>>
35627>>>    Procedure OnConstrain
35628>>>        Integer rVal liSrv
35629>>>        Forward Send OnConstrain
35631>>>        Get cpiFileNumber  To liSrv
35632>>>        Move liSrv         To Filenumber
35633>>>        Get cpiCannot_Read to rVal
35634>>>        If (rVal) Constrain Indirect_File.Recnum eq 0
35638>>>    End_Procedure
35639>>>
35639>>>    Procedure Operation_Not_Allowed  Integer iError_Num
35640>>>        String sLektiko
35641>>>        Move '' to sLektiko
35642>>>
35642>>>             If iError_Num eq 10000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
35645>>>        Else If iError_Num eq 10001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Users permissions. Check with your Administrator"    to sLektiko
35649>>>        Else If iError_Num eq 10002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
35653>>>        Else If iError_Num eq 10003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
35657>>>        Else If iError_Num eq 20000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
35661>>>        Else If iError_Num eq 20001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Group permissions. Check with your Administrator"    to sLektiko
35665>>>        Else If iError_Num eq 20002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
35669>>>        Else If iError_Num eq 20003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
35673>>>        Else If iError_Num eq  9999 Move "Unknown User in Users File"                                                                                    to sLektiko
35677>>>        Else If iError_Num eq 20101 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Change its Data"                 to sLektiko
35681>>>        Else If iError_Num eq 20102 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Delete It"                       to sLektiko
35685>>>        Append sLektiko '\nFile = ' (String(cpiFileNumber(Self))) ' - ' (CpsFileName(Self))
35689>>>
35689>>>             If iError_Num eq 10000 Error 10000 sLektiko
35692>>>        Else If iError_Num eq 10001 Error 10001 sLektiko
35696>>>        Else If iError_Num eq 10002 Error 10002 sLektiko
35700>>>        Else If iError_Num eq 10003 Error 10003 sLektiko
35704>>>        Else If iError_Num eq 20000 Error 20000 sLektiko
35708>>>        Else If iError_Num eq 20001 Error 20001 sLektiko
35712>>>        Else If iError_Num eq 20002 Error 20002 sLektiko
35716>>>        Else If iError_Num eq 20003 Error 20003 sLektiko
35720>>>        Else If iError_Num eq  9999 Error  9999 sLektiko
35724>>>        Else If iError_Num eq 20101 Error 20101 sLektiko
35728>>>        Else If iError_Num eq 20102 Error 20102 sLektiko
35732>>>
35732>>>        Else Forward Send Operation_Not_Allowed  iError_Num
35735>>>    End_Procedure   // Operation_Not_Allowed
35736>>>
35736>>>
35736>>>End_Class //Datadictionary_Sec
35737>
35737>
35737>//AB-StoreTopEnd
35737>
35737>
35737>Object Main is a Panelsub
35739>
35739>    //AB-PanelStoreTopStart
35739>    
35739>    
35739>    //AB-PanelStoreTopEnd
35739>
35739>    Set Label To "#ChkClients"
35740>
35740>    DFCreate_Menu Main_Menu
INCLUDING FILE: FILE_PM.INC
35743>>//************************************************************************
35743>>//
35743>>//* Copyright (c) 1997 Data Access Corporation, Miami Florida,
35743>>//* All rights reserved.
35743>>//* DataFlex is a registered trademark of Data Access Corporation.
35743>>//*
35743>>//*
35743>>//*  Module Name:
35743>>//*      FILE_PM.INC
35743>>//*
35743>>//*  Creator:
35743>>//*        LS, MAZ, JJT(changed for windaf)
35743>>//*
35743>>//*  Date:
35743>>//*      November 31, 1992
35743>>//*      10/28/94 03:17 pm - JJT windaf chagges
35743>>//*
35743>>//*  Purpose:
35743>>//*         package for creating generic record_pull_down object for entry
35743>>//*             object actions(assumed to be used as first pull down menu,
35743>>//*             hence EXIT option as last item)
35743>>//*
35743>>//*************************************************************************
35743>>// JJT - Modified to shadow items if not a DEO OR if no server
35743>>//*************************************************************************
35743>>
35743>>
35743>>Object oMyWinPrint is an DF_PRINTER
35745>>
35745>>    Procedure DFPrint
35747>>        Local Integer iRetVal
35748>>
35748>>        Get DFGetPrintDialogFlags To iRetVal
35749>>
35749>>        If iRetVal Begin
35751>>            Send DFPrintDoc
35752>>            Send DFClearDoc
35753>>        End
35753>>>
35753>>    End_Procedure
35754>>    Move Current_Object to WinPrintId
35755>>End_Object
35756>>
35756>>Register_Procedure Set piPropertiesObjectId
35756>>Register_Function piPropertiesObjectId Returns Integer
35756>>
35756>>Register_Function Close_All_Views Integer bWith_Confirmation Returns Integer
35756>>
35756>>DFCreate_Menu "&„šš¨˜­âª" File_Menu is a DEOPopupMenu
35760>>    On_Item "&€¡ç¨à©ž/Add\aF5" send Request_Clear
35761>>        Set Status_Help To '‰˜Ÿ˜¨åœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã'
35762>>
35762>>    On_Item "&Super €¡ç¨à©ž\aCtrl+F5" send Request_Clear_All
35763>>        Set Status_Help To '‰˜Ÿ˜¨åœ  æ¢˜ «˜ ›œ›¦£â¤˜ ˜§æ «ž¤ æ¯ž'
35764>>
35764>>    On_Item "&ƒ ˜š¨˜­ã\aShift+F2" send Request_Delete
35765>>        Set Status_Help To 'ƒ ˜š¨á­œ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã'
35766>>
35766>>    On_Item "&€¤˜ã«ž©ž\aF9" send Find_GE
35767>>        Set Status_Help To '¨å©¡œ  £ á œšš¨˜­ã'
35768>>
35768>>    On_Item "&„§æ£œ¤¦\aF8" send Find_Next
35769>>        Set Status_Help To '¨å©¡œ  «ž¤ œ§æ£œ¤ž œšš¨˜­ã'
35770>>
35770>>    On_Item "&¨¦žš¦ç£œ¤¦\aF7" send Find_Previous
35771>>        Set Status_Help To '¨å©¡œ  «ž¤ §¨¦žš¦ç£œ¤ž œšš¨˜­ã'
35772>>
35772>>    //On_Item "Super ˜¤˜ã«ž©ž\aShift+F9" send Superfind
35772>>    //    Set Status_Help To 'Super_˜¤˜ã«ž©ž £ áª œšš¨˜­ãª'
35772>>
35772>>    //On_Item "Super œ§æ£œ¤¦\aShift+F8" send Superfind_Next
35772>>    //    Set Status_Help To 'Super_˜¤˜ã«ž©ž œ§æ£œ¤žª œšš¨˜­ãª'
35772>>
35772>>    //On_Item "Super §¨¦žš¦ç£œ¤¦\aShift+F7" send Superfind_Previous
35772>>    //    Set Status_Help To 'Super_˜¤˜ã«ž©ž §¨¦žš¦ç£œ¤žª œšš¨˜­ãª'
35772>>
35772>>    On_Item "&¨é«¦\aCtrl+Home" send Beginning_Of_Data
35773>>        Set Status_Help To '¨å©¡œ  «ž¤ §¨é«ž œšš¨˜­ã'
35774>>
35774>>    On_Item "’œ&¢œ¬«˜å¦\aCtrl+End" send End_Of_Data
35775>>        Set Status_Help To '¨å©¡œ  «ž¤ «œ¢œ¬«˜¢å˜ œšš¨˜­ã'
35776>>
35776>>    On_Item "&„šš¨˜­ž\aF2" send Request_Save
35777>>        Set Status_Help To '‘éœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã'
35778>>
35778>>    On_Item "" send NONE
35779>>
35779>>    //on_item   "çŸ£ ©ž œ¡«ç§à©žª  "  Send Activate_oPrnSetup to (client_area(current_object))
35779>>    on_item   "çŸ£ ©ž œ¡«ç§à©žª  "  send DFPrintSetup       to (oWinPrint(Self))
35780>>    Set Status_Help To "çŸ£ ©ž œ¡«ç§à©žª"
35781>>    on_item   "„¡«ç§à©ž           "  send DFPrint            to (oMyWinPrint(Self))
35782>>    Set Status_Help To "„¡«ç§à©ž œšš¨á­¦¬"
35783>>
35783>>    On_Item "" send NONE
35784>>
35784>>    On_Item "&ˆ› ¦«ž«œª\aAlt+I" send DoShowProperties to Self
35785>>    Set Status_Help To '‰˜Ÿ¦¨ ©£æª ˆ› ¦«ã«à¤ «žª œ­˜¨£¦šãª'
35786>>
35786>>    On_Item "" send NONE
35787>>
35787>>    On_Item "„&¥¦›¦ª\aAlt+F4" send Exit_Application to desktop
35788>>        Set Status_Help To 'š˜å¤œ  ˜§¦ «ž¤ œ­˜¨£¦šã'
35789>>
35789>>    Procedure DoShowProperties
35791>>        If (Close_All_Views(Self,True)=0) Send Activate_View to (piPropertiesObjectId(self))
35794>>    End_Procedure
35795>>
35795>>    On_Key Key_Alt+Key_I Send DoShowProperties
35796>>
35796>>    //  When ever the menu [pulldown] is initialized, check/set
35796>>    //  the state of its items.
35796>>    //
35796>>    Procedure OnInitMenu
35798>>        Local integer Obj# IsDeo Changed NoIndex File# Field# Srvr Itm
35799>>        Local integer IsDeoControl lId liClId
35799>>        Get Focus to Obj#
35800>>        Get is_Function Get_DEO_Object Obj# TRUE to IsDeo
35801>>        If IsDeo Get Server of obj# to Srvr          // invoking data-set
35804>>        If (isDeo AND Srvr) Begin
35806>>            // returns T if object in question is a DEO control object (i.e.
35806>>            // understands the data_file, data_field messages).
35806>>            Get is_Function Get_DEO_Control_Object Obj# False to IsDeoControl
35807>>            Get Should_Save of Obj# to changed  // changed file?
35808>>            If IsDEOControl Begin
35810>>                Get data_file of Obj# to file#
35811>>                Get data_field of Obj# to field#
35812>>                Move ( File#=0 OR ;                    (Field_Main_Index(Srvr,File#,Field#)=-1) ;                    ) to NoIndex             // has a find index?
35813>>            End
35813>>>
35813>>            Else ;                Move 1 to NoIndex
35815>>            Set Shadow_state item 0  to False
35816>>            Set Shadow_state item 1  to False
35817>>            Set Shadow_state item 2  to (Current_record(Srvr)=0)
35818>>            Set Shadow_state item 3  to NoIndex
35819>>            Set Shadow_state item 4  to NoIndex
35820>>            Set Shadow_state item 5  to NoIndex
35821>>            Set Shadow_state item 6  to NoIndex
35822>>            Set Shadow_state item 7  to NoIndex
35823>>            Set Shadow_state item 8  to (Should_Save(Srvr)=0)
35824>>         //   Set Shadow_state item 9  to NoIndex
35824>>         //   Set Shadow_state item 10  to NoIndex
35824>>         //   Set Shadow_state item 11 to NoIndex
35824>>         //   Set Shadow_state item 12 to (Should_Save(Srvr)=0)
35824>>        End
35824>>>
35824>>        Else Begin
35825>>            for itm from 0 to 8 //11
35831>>>
35831>>                set shadow_State item itm to TRUE
35832>>            Loop
35833>>>
35833>>        End
35833>>>
35833>>        Set Shadow_State Item 13 to (piPropertiesObjectId(Self)=0)
35834>>    End_Procedure
35835>>
35835>>    Register_Procedure Activate_oPrnSetup
35835>>
35835>>End_Pull_Down
35837>>Set Status_Help to "€¤˜ã«ž©ž, „šš¨˜­ã, ƒ ˜š¨˜­ã, €¡ç¨à©ž ›œ›¦£â¤à¤ ã â¥¦›¦ª ˜§¦ «ž¤ œ­˜¨£¦šã"
35838>
35838>        DFCreate_Menu "&View" ViewPopupMenu is a ViewPopupMenu
35842>            On_Item "&ChkClnt\aCtrl+1" Send Activate_ChkClnt
35843>        End_Pull_down
35845>        Set Status_Help To "Available Views"
35846>        
INCLUDING FILE: NAVI_PM.INC
35846>>Use DFDEOMnu
35846>>
35846>>DFCreate_Menu "&Navigation" NAVIGATE_Menu is a DEOPopupMenu
35850>>    On_Item "&Next Area\aF6"            send Switch_Next_Area
35851>>        Set Status_Help To  'Move to Next Area'
35852>>
35852>>    On_Item "&Previous Area\aShift+F6"  send Switch_Prior_Area
35853>>        Set Status_Help To  'Move to Previous Area'
35854>>
35854>>    On_Item "N&ext View\aAlt+F6"        send Switch_Next_View
35855>>        Set Status_Help To  'Move to Next View'
35856>>
35856>>    On_Item "P&revious View\aCtrl+F6"   send Switch_Prior_View
35857>>        Set Status_Help To  'Move to Previous View'
35858>>
35858>>    On_Item ""                          send none
35859>>
35859>>    On_Item "&List\aF4"               send Prompt
35860>>        Set Status_Help To  'Show Selection Lists'
35861>>
35861>>    On_Item "&Zoom\aAlt+F9"             send Zoom
35862>>        Set Status_Help To  'Show Zoom'
35863>>
35863>>    Procedure OnInitMenu
35865>>        Local integer Obj# IsDeo Itm prmpt zm isDeoControl
35866>>        Get Focus to Obj#
35867>>        Get is_Function Get_DEO_Object Obj# TRUE to IsDeo
35868>>        If IsDeo Begin
35870>>            Get is_Function Get_DEO_Control_Object Obj# False to IsDeoControl
35871>>            If IsDeoControl Begin
35873>>                Get Prompt_Object of Obj# to Prmpt
35874>>                Get Zoom_Object of Obj# to zm
35875>>            End
35875>>>
35875>>            Set Shadow_state item 0  to False
35876>>            Set Shadow_state item 1  to False
35877>>            Set Shadow_state item 2  to False
35878>>            Set Shadow_state item 3  to False
35879>>            Set Shadow_state item 5  to (Prmpt=0)
35880>>            Set Shadow_state item 6  to (Zm=0)
35881>>        End
35881>>>
35881>>        Else Begin
35882>>            for itm from 0 to 6
35888>>>
35888>>                set shadow_State item itm to TRUE
35889>>            Loop
35890>>>
35890>>        End
35890>>>
35890>>    End_Procedure
35891>>
35891>>End_Pull_Down
35893>>Set Status_Help to "Navigation in different areas of the screen"
35894>>
INCLUDING FILE: WIN_PM.INC
35894>>DFCreate_Menu "&Window" Window_Menu
35898>>    Set select_mode to Multi_Select
35899>>    // normal number of items in pulldown (w/ no active views)
35899>>    property integer std_item_count public 0
35901>>
35901>>    DFCreate_Menu "&Preferences" Display_Options_Menu
35905>>        Set select_mode to Multi_Select
35906>>        On_Item "&ToolBar"        Send Toggle_Toolbar             To Self
35907>>        On_Item "&StatusBar"      Send Toggle_Statusbar           To Self
35908>>        On_Item "&Arrange Icons"  Send Toggle_Auto_Arrange_Icons  To Self
35909>>
35909>>        //  When ever the menu [pulldown] is initialized, check/set
35909>>        //  the state of its items.
35909>>        //
35909>>        Procedure OnInitMenu
35911>>            local integer bState
35912>>
35912>>            Get ToolBar_State to bState
35913>>            Set Select_State Item 0 to bState
35914>>            if  bState   Set Status_Help Item 0 To '' //'Hide the ToolBar'
35917>>            Else         Set Status_Help Item 0 to '' //'Show the ToolBar'
35919>>
35919>>            Get Statusbar_State to bState
35920>>            Set Select_State Item 1 to bState
35921>>            if  bState  Set Status_Help Item 1 To ''// 'Hide the StatusBar'
35924>>            Else        Set Status_Help Item 1 to ''// 'Show the StatusBar'
35926>>
35926>>            Get Auto_Arrange_Icons_State to bState
35927>>            Set Select_State Item 2 to bState
35928>>            if  bState  Set Status_Help Item 2 To '' //'Hide AutoArrange Icons'
35931>>            Else        Set Status_Help Item 2 to '' //'Show AutoArrange Icons'
35933>>
35933>>        End_procedure
35934>>
35934>>
35934>>    End_Pull_Down
35936>>    Set Status_Help                                           To '' //"Enable Toolbar, StatusBar, and AutoArrange Icons options"
35937>>
35937>>    On_Item ""
35938>>
35938>>    On_Item "&Cascade" send Cascade_Windows                   To Self
35939>>        Set Status_Help                                       To ''
35940>>
35940>>    On_Item "Tile &Horizontally" send Tile_Windows_Horizontal To Self
35941>>        Set Status_Help                                       To ''
35942>>
35942>>    On_Item "Tile &Vertically" send Tile_Windows_Vertical     To Self
35943>>        Set Status_Help                                       To ''
35944>>
35944>>    On_Item ""
35945>>
35945>>    On_Item "Minimize all" send Minimize_all_Windows          To Current_Object
35946>>        Set Status_Help                                       To ''
35947>>
35947>>    On_Item "&Restore all" send Restore_all_Windows           To Current_Object
35948>>        Set Status_Help                                       To ''
35949>>
35949>>    On_Item ""
35950>>
35950>>    On_Item "&Arrange Icons" send Arrange_Icons               To Current_Object
35951>>        Set Status_Help                                       To ''
35952>>
35952>>    // set this to the number of items in the menu with no views.
35952>>    Set Std_item_count to (item_count(current_object))
35953>>
35953>>    // add all active views to the end of the menu
35953>>    Procedure OnInitMenu
35955>>        local integer iStdCnt iNumCnt hVw hCl iCount
35956>>        Local string sLbl
35956>>        //*** Remove all old view items
35956>>        Get Item_count     to iNumCnt
35957>>        get Std_item_count to iStdCnt
35958>>        For iCount from 1  to (iNumCnt - iStdCnt)
35964>>>
35964>>            Send Delete_item iStdCnt
35965>>        Loop
35966>>>
35966>>
35966>>        Move iStdcnt to iNumCnt
35967>>        get Client_id to hCl // object id of client area
35968>>        If hCl Begin
35970>>           Get Next_Mdi_Dialog of hcl TRUE to hVw // find first view
35971>>           While hVw
35975>>              if (Active_state(hVw)) Begin
35977>>                 if iNumCnt eq iStdCnt Begin // if first view, add separator
35979>>                    send add_item 0 ''
35980>>                    increment iNumCnt
35981>>                 end
35981>>>
35981>>                 Get Label of hVw to sLbl // caption bar (name) of view
35982>>                 // note that all views understand the message activate_view.
35982>>                 send add_item msg_activate_view sLbl // set message, value and destination
35983>>                 set aux_value item iNumcnt to hVw
35984>>                 // if this is the focus view, mark it.
35984>>                 If (current_scope(desktop)=hVw and View_mode(hVw)<>VIEWMODE_ICONIZE) ;                     set select_state item iNumCnt to True
35987>>                 // create status help
35987>>                 Set Status_help item iNumCnt to ("Make this view (" - trim(sLbl) - ") the active window.")
35988>>                 increment iNumCnt
35989>>              end
35989>>>
35989>>              Get Next_Mdi_Dialog of hcl FALSE to hVw // find next
35990>>           End
35991>>>
35991>>        End
35991>>>
35991>>    End_Procedure // OnInitMenu
35992>>
35992>>End_Pull_Down
35994>>Set Status_Help to ''
INCLUDING FILE: HELPA_PM.INC
35995>>
35995>>
35995>>DFCreate_Menu "&Help" Help_Menu
35999>>    on_item "&Help Topic" send Help_on_topic
36000>>        Set Status_Help To "Search for help on a particular subject."
36001>>        on_item "" send NONE
36002>>    on_item "&Context Help"          send Extended_Help
36003>>        Set Status_Help To "Show Context sensitive help."
36004>>
36004>>    on_item "&Files Help"            send File_Help
36005>>        Set Status_Help To "Show Files help."
36006>>
36006>>    on_item "&Keys Help"             send Keys_Help
36007>>        Set Status_Help To "Show Keys help."
36008>>
36008>>    on_item "" send NONE
36009>>
36009>>    on_item "&How to Use Help"       send Help_For_Help
36010>>        Set Status_Help To "How to Use Help"
36011>>
36011>>    on_item "" send NONE
36012>>
36012>>    On_Item "&Tips of the Day" send Activate_TipOfDay
36013>>        Set Status_Help To "Tips of the Day"
36014>>
36014>>    on_item "" send NONE
36015>>
36015>>    On_item "About" Send Activate_About
36016>>        Set Status_Help To "System Information"
36017>>end_pull_down
36019>>Set Status_Help to "Access to the program's help subsystem"
36020>>
36020>>Register_Procedure Activate_TipOfDay
36020>>
36020>>
36020>    End_Menu
36022>
36022>    Use DFStdBtn.pkg //  Tool-Bar object.
INCLUDING FILE: DFSTDBTN.PKG
36022>>>// 07/23/96 JJT - New Class names
36022>>>// 10/03/97 KCR - removed leading separator
36022>>>
36022>>>Use DFMainBt  // dfMain_ButtonBar
INCLUDING FILE: DFMAINBT.PKG
36022>>>>>//-------------------------------------------------------------------------
36022>>>>>// DFMainBt.pkg - DfMain_ButtonBar class
36022>>>>>//
36022>>>>>//
36022>>>>>// 07/23/96 JJT - New Class names
36022>>>>>//-------------------------------------------------------------------------
36022>>>>>
36022>>>>>Use DfPanel // dfapp_buttonbar
36022>>>>>
36022>>>>>Class ToolBar is a AppToolBar
36023>>>>>
36023>>>>>    Function Is_Function Integer MsgId Integer ObjId Integer DelegateFg Returns Integer
36024>>>>>      Local integer rval MainObj#
36025>>>>>      Get Main_Panel_id to MainObj#
36026>>>>>      If (ObjId>Desktop AND MainObj#) ;         Get Is_Function of MainObj# MsgId ObjId DelegateFg to rVal
36029>>>>>      Function_Return rVal
36030>>>>>    End_Function
36031>>>>>
36031>>>>>    Procedure Redirect_Button_Message integer Itm
36032>>>>>         Local integer Msg# Aux# rval Understood
36033>>>>>         If (Shadow_State(Current_Object,itm)) Procedure_Return
36036>>>>>         Get Message   item itm  to Msg#
36037>>>>>         Get Aux_Value item itm  to Aux#
36038>>>>>         If Msg# Begin
36040>>>>>           If Aux# eq 0 Begin
36042>>>>>              Get Focus to Aux#
36043>>>>>              Get Is_Function Get_DEO_Object Aux# TRUE to Understood
36044>>>>>              If Not Understood Move 0 to Aux#
36047>>>>>           End
36047>>>>>>
36047>>>>>           If Aux# Get Msg# of Aux# to rval
36050>>>>>           Procedure_return rval
36051>>>>>         end
36051>>>>>>
36051>>>>>    End_Procedure // Redirect_Message
36052>>>>>
36052>>>>>End_Class
36053>>>>>
36053>>>>>
36053>>>
36053>>>//  Button bar object.
36053>>>//
36053>>>Object Tool_Bar is a ToolBar
36055>>>
36055>>>    Send ImageList_Add 'bgn.bmp'   // 0
36056>>>    Send ImageList_Add 'end.bmp'   // 1
36057>>>    Send ImageList_Add 'next.bmp'  // 2
36058>>>    Send ImageList_Add 'prev.bmp'  // 3
36059>>>    Send ImageList_Add 'clr.bmp'   // 4
36060>>>    Send ImageList_Add 'clra.bmp'  // 5
36061>>>
36061>>>    send Add_button (ico_user+0) msg_beginning_of_data
36062>>>    Send Add_ToolTip "Beginning of file"
36063>>>    Set  Status_Help To 'Find the First record (Ctrl+Home)'
36064>>>
36064>>>    send Add_button (ico_user+3) msg_find_previous
36065>>>    Send Add_ToolTip "Find Previous"
36066>>>    Set  Status_Help To 'Find the Previous record (F7)'
36067>>>
36067>>>    send Add_button (ico_user+2) msg_find_next
36068>>>    Send Add_ToolTip "Find Next"
36069>>>    Set  Status_Help To 'Find the Next record (F8)'
36070>>>
36070>>>    send Add_button (ico_user+1) msg_end_of_data
36071>>>    Send Add_ToolTip "End of File"
36072>>>    Set  Status_Help To 'Find the Last record (Ctrl+End)'
36073>>>
36073>>>    send Add_space
36074>>>
36074>>>    send Add_button ico_std_find msg_prompt
36075>>>    Send Add_ToolTip "Prompt"
36076>>>    Set  Status_Help To 'Show available selections (F4)'
36077>>>
36077>>>    send Add_button (ico_user+4) msg_request_clear
36078>>>    Send Add_ToolTip "Clear"
36079>>>    Set  Status_Help To 'Clear current record / Add a new record (F5)'
36080>>>
36080>>>    send Add_button (ico_user+5) msg_request_clear_all
36081>>>    Send Add_ToolTip "Clear All"
36082>>>    Set  Status_Help To 'Clear all data from view (Ctrl+F5)'
36083>>>
36083>>>    send Add_space
36084>>>
36084>>>    send Add_button ico_std_filesave msg_request_save
36085>>>    Send Add_ToolTip "Save"
36086>>>    Set  Status_Help To 'Save the current record (F2)'
36087>>>
36087>>>    send Add_button ico_std_delete msg_request_delete
36088>>>    Send Add_ToolTip "Delete"
36089>>>    Set  Status_Help To 'Delete the current record (Shift+F2)'
36090>>>
36090>>>    send Add_space
36091>>>
36091>>>    send Add_button ico_std_cut msg_cut
36092>>>    Send Add_ToolTip "Cut"
36093>>>    Set  Status_Help to "Cuts the selection and puts it on the Clipboard"
36094>>>
36094>>>    send Add_button ico_std_copy msg_copy
36095>>>    Send Add_ToolTip "Copy"
36096>>>    Set  Status_Help to "Copies the selection and puts it on the Clipboard"
36097>>>
36097>>>    send Add_button ico_std_paste msg_paste
36098>>>    Send Add_ToolTip "Paste"
36099>>>    Set  Status_Help to "Inserts Clipboard contents"
36100>>>
36100>>>End_Object
36101>>>
36101>    
36101>    Object Client_Area is a AppClientAreasub
36103>
36103>        //AB-ClientStoreTopStart
36103>        // Ž‘Ž•† ‚„Œˆ‰„‘ ‹„’€Š†’„‘ //
36103>        String Plhktro_BIP  Plhktro_Esc  Plhktro_N11  Plhktro_N00  Plhktro_FS  Plhktro_AAA  Plhktro_DSI
36103>        String Plhktro_SO   Plhktro_DC4     //expanded for 1 line
36103>        String Plhktro_SI   Plhktro_DC2     //condesed
36103>        String Plhktro_PAV                  //underline
36103>        String Plhktro_EEE  Plhktro_FFF     //emphasized
36103>        String Plhktro_GGG  Plhktro_HHH     //double strike
36103>        String Plhktro_WWW                  //expanded
36103>        string Plhktro_Q Plhktro_160
36103>        Integer giViewID
36103>        String  gsViewName
36103>        // Ž‘Ž•† ‚„Œˆ‰„‘ ‹„’€Š†’„‘ //
36103>        
36103>        Open Sysfile
36105>        Open Sysrec
INCLUDING FILE: SYSREC.FD
36107>        
36107>        //Use dbViews.Sub
36107>        //Use dbForms.Sub
36107>        
36107>        //Use GrpPed00.vw
36107>        //Use GrpPedia.vw
36107>        //Use GrpView0.vw
36107>        //Use GrpViews.vw
36107>        //Use GrpOth0.vw
36107>        //Use GrpOth.vw
36107>        //Use Users.vw
36107>        //Use UserGrps.vw
36107>        //Use Departm.vw
36107>        //Use Othon.vw
36107>        //Use Views.vw
36107>        //Use Arxeia.vw
36107>        //Use Pedia.vw
36107>        //Use Viewflds.vw
36107>        
36107>        //Use Cflagkin.vw
36107>        //Use Wflagkin.vw
36107>        
36107>        Use Listes
INCLUDING FILE: LISTES.PKG
36107>>>Use Wax.sl
INCLUDING FILE: WAX.SL
36107>>>>>//AB/ Project Wax:Lookup Apothikhs
36107>>>>>//AB/ Object prj is a Lookup_Project
36107>>>>>//AB/     Set ProjectName to "Wax:Lookup Apothikhs"
36107>>>>>//AB/     Set ProjectFileName to "Wax.SL"
36107>>>>>//AB/     Set GenerateFileName to "NONAME"
36107>>>>>
36107>>>>>// Project Object Structure
36107>>>>>//   Wax is a dbModalPanelSub
36107>>>>>//     Wapokat_DD is a DataDictionary
36107>>>>>//     Wapomast_DD is a DataDictionary
36107>>>>>//     Wax_DD is a DataDictionary
36107>>>>>//     oSelList is a dbListSub
36107>>>>>//     oOK_bn is a ButtonSub
36107>>>>>//     oCancel_bn is a ButtonSub
36107>>>>>//     oSearch_bn is a ButtonSub
36107>>>>>
36107>>>>>// Register all objects
36107>>>>>Register_Object oCancel_bn
36107>>>>>Register_Object oOK_bn
36107>>>>>Register_Object oSearch_bn
36107>>>>>Register_Object oSelList
36107>>>>>Register_Object Wapokat_DD
36107>>>>>Register_Object Wapomast_DD
36107>>>>>Register_Object Wax
36107>>>>>Register_Object Wax_DD
36107>>>>>
36107>>>>>
36107>>>>>//AB-IgnoreStart
36107>>>>>
36107>>>>>Use DFAllEnt.pkg
36107>>>>>Use dbList.Sub
36107>>>>>Use Button.Sub
36107>>>>>
36107>>>>>
36107>>>>>Use WAPOKAT.DD
INCLUDING FILE: WAPOKAT.DD
36107>>>>>>>//DDB-FileStart
36107>>>>>>>//DDB-HeaderStart
36107>>>>>>>
36107>>>>>>>// File Name : WAPOKAT.DD
36107>>>>>>>// Class Name: Wapokat_DataDictionary
36107>>>>>>>// Revision  : 21
36107>>>>>>>// Version   : 2
36107>>>>>>>
36107>>>>>>>Use  Windows           // Basic Definitions
36107>>>>>>>Use  DataDict          // DataDictionary Class Definition
36107>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36107>>>>>>>
36107>>>>>>>Open Wapokat
INCLUDING FILE: WAPOKAT.FD
36109>>>>>>>Open Wapomast
INCLUDING FILE: WAPOMAST.FD
36111>>>>>>>Open Sysrecw
INCLUDING FILE: SYSRECW.FD
36113>>>>>>>Open Syscurxr
36115>>>>>>>
36115>>>>>>>//DDB-HeaderEnd
36115>>>>>>>//DDB-SelectionStart
36115>>>>>>>//DDB/ ExternalSelectionList sl022  sl022.SL
36115>>>>>>>Register_Object sl022
36115>>>>>>>//DDB-SelectionEnd
36115>>>>>>>
36115>>>>>>>Class Wapokat_DataDictionary  is a DataDictionary
36116>>>>>>>
36116>>>>>>>    // Update:
36116>>>>>>>    Procedure Update
36117>>>>>>>        Forward Send Update
36119>>>>>>>        // Insert Code Here
36119>>>>>>>//        Move SysCurXR.Company_Code   to Wapokat.Company_Code
36119>>>>>>>//        Move SysCurXR.Branch_Code     to Wapokat.Branch_Code
36119>>>>>>>//        Move SysCurXR.Year_Year         to Wapokat.Year_Year
36119>>>>>>>    End_Procedure   // Update
36120>>>>>>> 
36120>>>>>>>     Procedure Creating
36121>>>>>>>        Forward Send Creating
36123>>>>>>>        // Insert Code Here
36123>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wapokat.Wapokat_Rec0)))))) to Wapokat.Wapokat_Recr
36124>>>>>>>    End_Procedure   // Creating
36125>>>>>>>
36125>>>>>>>
36125>>>>>>>    // Define_Fields:
36125>>>>>>>    // This procedure is used to set up all data-dictionary rules.
36125>>>>>>>
36125>>>>>>>    Procedure Define_Fields
36126>>>>>>>        Forward Send Define_Fields
36128>>>>>>>        //DDB-Generated-Code-Location
36128>>>>>>>        //DDB-DefineFieldStart
36128>>>>>>>
36128>>>>>>>        Set Main_File            To Wapokat.File_Number
36129>>>>>>>        Set Cascade_Delete_State To FALSE
36130>>>>>>>
36130>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
36131>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
36132>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
36133>>>>>>>
36133>>>>>>>        // Child (Client) file structure................
36133>>>>>>>        Send Add_Client_File  Wapomast.File_Number
36134>>>>>>>
36134>>>>>>>        // External (System) file structure.............
36134>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
36135>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
36136>>>>>>>
36136>>>>>>>        Define_Auto_Increment  Sysrecw.Wapokat_Rec0  To Wapokat.Wapokat_Rec0
36139>>>>>>>
36139>>>>>>>        // Field-based properties.......................
36139>>>>>>>
36139>>>>>>>        // Wapokat.Wapokat_Code
36139>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Code To DD_AUTOFIND   
36140>>>>>>>        Set Field_Prompt_Object    Field Wapokat.Wapokat_Code To (sl022(Self))
36141>>>>>>>
36141>>>>>>>        // Wapokat.Wapokat_Rec0
36141>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Rec0 To DD_AUTOFIND   
36142>>>>>>>
36142>>>>>>>        // Wapokat.Wapokat_Descr
36142>>>>>>>        Set Field_Prompt_Object    Field Wapokat.Wapokat_Descr To (sl022(Self))
36143>>>>>>>
36143>>>>>>>        // Wapokat.Wapokat_Recr
36143>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Recr To DD_AUTOFIND   
36144>>>>>>>
36144>>>>>>>        // Wapokat.Enhm_Sap
36144>>>>>>>
36144>>>>>>>        // Wapokat.Sap_Descr
36144>>>>>>>
36144>>>>>>>        // Wapokat.Gl
36144>>>>>>>
36144>>>>>>>        // Wapokat.Glzz
36144>>>>>>>
36144>>>>>>>        // Wapokat.Oximm1
36144>>>>>>>
36144>>>>>>>        //DDB-DefineFieldEnd
36144>>>>>>>    End_Procedure    // Define_Fields
36145>>>>>>>
36145>>>>>>>    // Field_Defaults:
36145>>>>>>>    // This procedure is used to establish default field values.
36145>>>>>>>
36145>>>>>>>    Procedure Field_Defaults
36146>>>>>>>        Forward Send Field_Defaults
36148>>>>>>>        //DDB-Generated-Code-Location
36148>>>>>>>        //DDB-FieldDefaultStart
36148>>>>>>>        //DDB-FieldDefaultEnd
36148>>>>>>>    End_Procedure    // Field_Defaults
36149>>>>>>>
36149>>>>>>>End_Class    // Wapokat_DataDictionary
36150>>>>>>>//DDB-Selection-pkg-Start
36150>>>>>>>
36150>>>>>>>Use sl022.SL         // sl022
INCLUDING FILE: SL022.SL
36150>>>>>>>>>//AB/ Project sl022:kathg-apothkon
36150>>>>>>>>>//AB/ Object prj is a Lookup_Project
36150>>>>>>>>>//AB/     Set ProjectName to "sl022:kathg-apothkon"
36150>>>>>>>>>//AB/     Set ProjectFileName to "sl022.SL"
36150>>>>>>>>>
36150>>>>>>>>>// Project Object Structure
36150>>>>>>>>>//   sl022 is a dbModalPanelSub
36150>>>>>>>>>//     Wapokat_DD is a DataDictionary
36150>>>>>>>>>//     oSelList is a dbListSub
36150>>>>>>>>>//     oOK_bn is a ButtonSub
36150>>>>>>>>>//     oCancel_bn is a ButtonSub
36150>>>>>>>>>//     oSearch_bn is a ButtonSub
36150>>>>>>>>>
36150>>>>>>>>>// Register all objects
36150>>>>>>>>>Register_Object oCancel_bn
36150>>>>>>>>>Register_Object oOK_bn
36150>>>>>>>>>Register_Object oSearch_bn
36150>>>>>>>>>Register_Object oSelList
36150>>>>>>>>>Register_Object sl022
36150>>>>>>>>>Register_Object Wapokat_DD
36150>>>>>>>>>
36150>>>>>>>>>
36150>>>>>>>>>//AB-IgnoreStart
36150>>>>>>>>>
36150>>>>>>>>>Use DFAllEnt.pkg
36150>>>>>>>>>Use dbList.Sub
36150>>>>>>>>>Use Button.Sub
36150>>>>>>>>>
36150>>>>>>>>>
36150>>>>>>>>>Use WAPOKAT.DD
36150>>>>>>>>>
36150>>>>>>>>>//AB-IgnoreEnd
36150>>>>>>>>>
36150>>>>>>>>>CD_Popup_Object sl022 is a dbModalPanelSub
36169>>>>>>>>>    set label to "‰˜«žš¦¨åœª €§¦Ÿž¡é¤" 
36170>>>>>>>>>    Set Size to 148 297
36171>>>>>>>>>    Set Location to 12 19
36172>>>>>>>>>    Set Exit_Application_Local_State to FALSE
36173>>>>>>>>>    Set Modal_State to FALSE
36174>>>>>>>>>
36174>>>>>>>>>    //AB-DDOStart
36174>>>>>>>>>
36174>>>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
36176>>>>>>>>>    End_Object    // Wapokat_DD
36177>>>>>>>>>
36177>>>>>>>>>    Set Main_DD to (Wapokat_DD(self))
36178>>>>>>>>>    Set Server to (Wapokat_DD(self))
36179>>>>>>>>>
36179>>>>>>>>>    //AB-DDOEnd
36179>>>>>>>>>
36179>>>>>>>>>    Object oSelList is a dbListSub
36181>>>>>>>>>        Set Main_File to Wapokat.File_Number
36182>>>>>>>>>        Set Size to 105 280
36183>>>>>>>>>        Set Location to 6 6
36184>>>>>>>>>
36184>>>>>>>>>        Begin_Row
36187>>>>>>>>>            Entry_Item Wapokat.Wapokat_code
36188>>>>>>>>>            Entry_Item Wapokat.Wapokat_descr
36189>>>>>>>>>        End_Row
36194>>>>>>>>>
36194>>>>>>>>>        Set Form_Width    item 0 to 42
36195>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
36196>>>>>>>>>        
36196>>>>>>>>>        Set Form_Width    item 1 to 228
36197>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
36198>>>>>>>>>        
36198>>>>>>>>>    End_Object    // oSelList
36199>>>>>>>>>
36199>>>>>>>>>    Object oOK_bn is a ButtonSub
36201>>>>>>>>>        set label to "&„§ ¢¦šã" 
36202>>>>>>>>>        Set Location to 115 126
36203>>>>>>>>>
36203>>>>>>>>>        //AB-StoreStart
36203>>>>>>>>>        Procedure OnClick
36205>>>>>>>>>            Send OK To (oSelList(current_object))
36206>>>>>>>>>        End_Procedure
36207>>>>>>>>>        //AB-StoreEnd
36207>>>>>>>>>
36207>>>>>>>>>    End_Object    // oOK_bn
36208>>>>>>>>>
36208>>>>>>>>>    Object oCancel_bn is a ButtonSub
36210>>>>>>>>>        set label to "&€¡ç¨à©ž" 
36211>>>>>>>>>        Set Location to 115 181
36212>>>>>>>>>
36212>>>>>>>>>        //AB-StoreStart
36212>>>>>>>>>        Procedure OnClick
36214>>>>>>>>>            Send Cancel To (oSelList(current_object))
36215>>>>>>>>>        End_Procedure
36216>>>>>>>>>        //AB-StoreEnd
36216>>>>>>>>>
36216>>>>>>>>>    End_Object    // oCancel_bn
36217>>>>>>>>>
36217>>>>>>>>>    Object oSearch_bn is a ButtonSub
36219>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
36220>>>>>>>>>        Set Location to 115 236
36221>>>>>>>>>
36221>>>>>>>>>        //AB-StoreStart
36221>>>>>>>>>        Procedure OnClick
36223>>>>>>>>>            Send Search To (oSelList(current_object))
36224>>>>>>>>>        End_Procedure
36225>>>>>>>>>        //AB-StoreEnd
36225>>>>>>>>>
36225>>>>>>>>>    End_Object    // oSearch_bn
36226>>>>>>>>>
36226>>>>>>>>>
36226>>>>>>>>>    //AB-StoreStart
36226>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
36227>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
36228>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
36229>>>>>>>>>    //AB-StoreEnd
36229>>>>>>>>>
36229>>>>>>>>>CD_End_Object    // sl022
36231>>>>>>>>>>
36231>>>>>>>>>
36231>>>>>>>>>//AB/ End_Object    // prj
36231>>>>>>>
36231>>>>>>>//DDB-Selection-pkg-End
36231>>>>>>>//DDB-FileEnd
36231>>>>>Use WAPOMAST.DD
INCLUDING FILE: WAPOMAST.DD
36231>>>>>>>//DDB-FileStart
36231>>>>>>>//DDB-HeaderStart
36231>>>>>>>
36231>>>>>>>// File Name : WAPOMAST.DD
36231>>>>>>>// Class Name: Wapomast_DataDictionary
36231>>>>>>>// Revision  : 13
36231>>>>>>>// Version   : 2
36231>>>>>>>
36231>>>>>>>Use  Windows           // Basic Definitions
36231>>>>>>>Use  DataDict          // DataDictionary Class Definition
36231>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36231>>>>>>>
36231>>>>>>>Open Wapomast
36233>>>>>>>Open Wax
36235>>>>>>>Open Wapokat
36237>>>>>>>Open Sysrecw
36239>>>>>>>
36239>>>>>>>//DDB-HeaderEnd
36239>>>>>>>//DDB-SelectionStart
36239>>>>>>>//DDB/ ExternalSelectionList sl023  sl023.SL
36239>>>>>>>Register_Object sl023
36239>>>>>>>//DDB-SelectionEnd
36239>>>>>>>
36239>>>>>>>Class Wapomast_DataDictionary  is a DataDictionary
36240>>>>>>>    // Update:
36240>>>>>>>    Procedure Update
36241>>>>>>>        Forward Send Update
36243>>>>>>>        // Insert Code Here
36243>>>>>>>//        Move SysCurXR.Company_Code   to Wapomast.Company_Code
36243>>>>>>>//        Move SysCurXR.Branch_Code     to Wapomast.Branch_Code
36243>>>>>>>//        Move SysCurXR.Year_Year         to Wapomast.Year_Year
36243>>>>>>>        Move Wapokat.Wapokat_Code   to Wapomast.Wapokat_Code
36244>>>>>>>    End_Procedure   // Update
36245>>>>>>> 
36245>>>>>>>     Procedure Creating
36246>>>>>>>        Forward Send Creating
36248>>>>>>>        // Insert Code Here
36248>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wapomast.Wapomast_Rec0)))))) to Wapomast.Wapomast_Recr
36249>>>>>>>    End_Procedure   // Creating
36250>>>>>>>
36250>>>>>>>
36250>>>>>>>    // Define_Fields:
36250>>>>>>>    // This procedure is used to set up all data-dictionary rules.
36250>>>>>>>
36250>>>>>>>    Procedure Define_Fields
36251>>>>>>>        Forward Send Define_Fields
36253>>>>>>>        //DDB-Generated-Code-Location
36253>>>>>>>        //DDB-DefineFieldStart
36253>>>>>>>
36253>>>>>>>        Set Main_File            To Wapomast.File_Number
36254>>>>>>>        Set Cascade_Delete_State To FALSE
36255>>>>>>>
36255>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
36256>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
36257>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
36258>>>>>>>
36258>>>>>>>        // Child (Client) file structure................
36258>>>>>>>        Send Add_Client_File  Wax.File_Number
36259>>>>>>>
36259>>>>>>>        // Parent (Server) file structure...............
36259>>>>>>>        Send Add_Server_File  Wapokat.File_Number
36260>>>>>>>
36260>>>>>>>        // External (System) file structure.............
36260>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
36261>>>>>>>
36261>>>>>>>        Define_Auto_Increment  Sysrecw.Wapomast_Rec0  To Wapomast.Wapomast_Rec0
36264>>>>>>>
36264>>>>>>>        // Field-based properties.......................
36264>>>>>>>
36264>>>>>>>        // Wapomast.Wapokat_Code
36264>>>>>>>
36264>>>>>>>        // Wapomast.Wapokat_Recr
36264>>>>>>>
36264>>>>>>>        // Wapomast.Wapomast_Code
36264>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Code To DD_AUTOFIND   
36265>>>>>>>        Set Field_Prompt_Object    Field Wapomast.Wapomast_Code To (sl023(Self))
36266>>>>>>>
36266>>>>>>>        // Wapomast.Wapomast_Rec0
36266>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Rec0 To DD_AUTOFIND   
36267>>>>>>>
36267>>>>>>>        // Wapomast.Wapomast_Descr
36267>>>>>>>        Set Field_Prompt_Object    Field Wapomast.Wapomast_Descr To (sl023(Self))
36268>>>>>>>
36268>>>>>>>        // Wapomast.Wapomast_Recr
36268>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Recr To DD_AUTOFIND   
36269>>>>>>>
36269>>>>>>>        //DDB-DefineFieldEnd
36269>>>>>>>    End_Procedure    // Define_Fields
36270>>>>>>>
36270>>>>>>>    // Field_Defaults:
36270>>>>>>>    // This procedure is used to establish default field values.
36270>>>>>>>
36270>>>>>>>    Procedure Field_Defaults
36271>>>>>>>        Forward Send Field_Defaults
36273>>>>>>>        //DDB-Generated-Code-Location
36273>>>>>>>        //DDB-FieldDefaultStart
36273>>>>>>>        //DDB-FieldDefaultEnd
36273>>>>>>>    End_Procedure    // Field_Defaults
36274>>>>>>>
36274>>>>>>>End_Class    // Wapomast_DataDictionary
36275>>>>>>>//DDB-Selection-pkg-Start
36275>>>>>>>
36275>>>>>>>Use sl023.SL         // sl023
INCLUDING FILE: SL023.SL
36275>>>>>>>>>//AB/ Project sl023:apothkes
36275>>>>>>>>>//AB/ Object prj is a Lookup_Project
36275>>>>>>>>>//AB/     Set ProjectName to "sl023:apothkes"
36275>>>>>>>>>//AB/     Set ProjectFileName to "sl023.SL"
36275>>>>>>>>>
36275>>>>>>>>>// Project Object Structure
36275>>>>>>>>>//   sl023 is a dbModalPanelSub
36275>>>>>>>>>//     Wapokat_DD is a DataDictionary
36275>>>>>>>>>//     Wapomast_DD is a DataDictionary
36275>>>>>>>>>//     oSelList is a dbListSub
36275>>>>>>>>>//     oOK_bn is a ButtonSub
36275>>>>>>>>>//     oCancel_bn is a ButtonSub
36275>>>>>>>>>//     oSearch_bn is a ButtonSub
36275>>>>>>>>>
36275>>>>>>>>>// Register all objects
36275>>>>>>>>>Register_Object oCancel_bn
36275>>>>>>>>>Register_Object oOK_bn
36275>>>>>>>>>Register_Object oSearch_bn
36275>>>>>>>>>Register_Object oSelList
36275>>>>>>>>>Register_Object sl023
36275>>>>>>>>>Register_Object Wapokat_DD
36275>>>>>>>>>Register_Object Wapomast_DD
36275>>>>>>>>>
36275>>>>>>>>>
36275>>>>>>>>>//AB-IgnoreStart
36275>>>>>>>>>
36275>>>>>>>>>Use DFAllEnt.pkg
36275>>>>>>>>>Use dbList.Sub
36275>>>>>>>>>Use Button.Sub
36275>>>>>>>>>
36275>>>>>>>>>
36275>>>>>>>>>Use WAPOKAT.DD
36275>>>>>>>>>Use WAPOMAST.DD
36275>>>>>>>>>
36275>>>>>>>>>//AB-IgnoreEnd
36275>>>>>>>>>
36275>>>>>>>>>Object sl023 is a dbModalPanelSub
36277>>>>>>>>>
36277>>>>>>>>>    //AB-StoreTopStart
36277>>>>>>>>>    property string psapokat public ''
36279>>>>>>>>>    //AB-StoreTopEnd
36279>>>>>>>>>
36279>>>>>>>>>    Set Label to "€§¦Ÿã¡œª"
36280>>>>>>>>>    Set Size to 126 260
36281>>>>>>>>>    Set Location to 4 19
36282>>>>>>>>>    Set Exit_Application_Local_State to FALSE
36283>>>>>>>>>    Set Modal_State to FALSE
36284>>>>>>>>>
36284>>>>>>>>>    //AB-DDOStart
36284>>>>>>>>>
36284>>>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
36286>>>>>>>>>    End_Object    // Wapokat_DD
36287>>>>>>>>>
36287>>>>>>>>>    Object Wapomast_DD is a Wapomast_DataDictionary
36289>>>>>>>>>        Set DDO_Server to (Wapokat_DD(self))
36290>>>>>>>>>
36290>>>>>>>>>        //AB-StoreStart
36290>>>>>>>>>        
36290>>>>>>>>>        begin_constraints
36292>>>>>>>>>          if (psapokat(self) <> '') constrain wapomast.wapokat_code eq (psapokat(self))
36296>>>>>>>>>        
36296>>>>>>>>>        end_constraints
36299>>>>>>>>>        
36299>>>>>>>>>        //AB-StoreEnd
36299>>>>>>>>>
36299>>>>>>>>>    End_Object    // Wapomast_DD
36300>>>>>>>>>
36300>>>>>>>>>    Set Main_DD to (Wapomast_DD(self))
36301>>>>>>>>>    Set Server to (Wapomast_DD(self))
36302>>>>>>>>>
36302>>>>>>>>>    //AB-DDOEnd
36302>>>>>>>>>
36302>>>>>>>>>    Object oSelList is a dbListSub
36304>>>>>>>>>        Set Main_File to Wapomast.File_Number
36305>>>>>>>>>        Set Server to (Wapokat_DD(self))
36306>>>>>>>>>        Set Size to 89 240
36307>>>>>>>>>        Set Location to 6 6
36308>>>>>>>>>
36308>>>>>>>>>        Begin_Row
36311>>>>>>>>>            Entry_Item Wapomast.Wapomast_code
36312>>>>>>>>>            Entry_Item Wapomast.Wapomast_descr
36313>>>>>>>>>        End_Row
36318>>>>>>>>>
36318>>>>>>>>>        Set Form_Width    item 0 to 70
36319>>>>>>>>>        Set Header_Label  item 0 to "€§¦Ÿã¡ž      :"
36320>>>>>>>>>        
36320>>>>>>>>>        Set Form_Width    item 1 to 160
36321>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
36322>>>>>>>>>        
36322>>>>>>>>>
36322>>>>>>>>>        //AB-StoreStart
36322>>>>>>>>>                    
36322>>>>>>>>>                    
36322>>>>>>>>>        //AB-StoreEnd
36322>>>>>>>>>
36322>>>>>>>>>    End_Object    // oSelList
36323>>>>>>>>>
36323>>>>>>>>>    Object oOK_bn is a ButtonSub
36325>>>>>>>>>        Set Label to "&„§ ¢¦šã"
36326>>>>>>>>>        Set Location to 92 81
36327>>>>>>>>>
36327>>>>>>>>>        //AB-StoreStart
36327>>>>>>>>>        Procedure OnClick
36329>>>>>>>>>            Send OK To (oSelList(current_object))
36330>>>>>>>>>        End_Procedure
36331>>>>>>>>>        //AB-StoreEnd
36331>>>>>>>>>
36331>>>>>>>>>    End_Object    // oOK_bn
36332>>>>>>>>>
36332>>>>>>>>>    Object oCancel_bn is a ButtonSub
36334>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
36335>>>>>>>>>        Set Location to 92 135
36336>>>>>>>>>
36336>>>>>>>>>        //AB-StoreStart
36336>>>>>>>>>        Procedure OnClick
36338>>>>>>>>>            Send Cancel To (oSelList(current_object))
36339>>>>>>>>>        End_Procedure
36340>>>>>>>>>        //AB-StoreEnd
36340>>>>>>>>>
36340>>>>>>>>>    End_Object    // oCancel_bn
36341>>>>>>>>>
36341>>>>>>>>>    Object oSearch_bn is a ButtonSub
36343>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
36344>>>>>>>>>        Set Location to 92 191
36345>>>>>>>>>
36345>>>>>>>>>        //AB-StoreStart
36345>>>>>>>>>        Procedure OnClick
36347>>>>>>>>>            Send Search To (oSelList(current_object))
36348>>>>>>>>>        End_Procedure
36349>>>>>>>>>        //AB-StoreEnd
36349>>>>>>>>>
36349>>>>>>>>>    End_Object    // oSearch_bn
36350>>>>>>>>>
36350>>>>>>>>>
36350>>>>>>>>>    //AB-StoreStart
36350>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
36351>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
36352>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
36353>>>>>>>>>    
36353>>>>>>>>>    procedure activate
36355>>>>>>>>>        send rebuild_constraints to wapomast_dd
36356>>>>>>>>>        send beginning_of_data to osellist true
36357>>>>>>>>>        forward send activate
36359>>>>>>>>>    end_procedure
36360>>>>>>>>>    
36360>>>>>>>>>    
36360>>>>>>>>>    //AB-StoreEnd
36360>>>>>>>>>
36360>>>>>>>>>End_Object    // sl023
36361>>>>>>>>>
36361>>>>>>>>>//AB/ End_Object    // prj
36361>>>>>>>
36361>>>>>>>//DDB-Selection-pkg-End
36361>>>>>>>//DDB-FileEnd
36361>>>>>Use WAX.DD
INCLUDING FILE: WAX.DD
36361>>>>>>>//DDB-FileStart
36361>>>>>>>//DDB-HeaderStart
36361>>>>>>>
36361>>>>>>>// File Name : WAX.DD
36361>>>>>>>// Class Name: Wax_DataDictionary
36361>>>>>>>// Revision  : 39
36361>>>>>>>// Version   : 2
36361>>>>>>>
36361>>>>>>>Use  Windows           // Basic Definitions
36361>>>>>>>Use  DataDict          // DataDictionary Class Definition
36361>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36361>>>>>>>
36361>>>>>>>Open Wax
36363>>>>>>>Open Pmoves
INCLUDING FILE: PMOVES.FD
36365>>>>>>>Open Wcmoves
INCLUDING FILE: WCMOVES.FD
36367>>>>>>>Open Wam
INCLUDING FILE: WAM.FD
36369>>>>>>>Open Pmovesl
INCLUDING FILE: PMOVESL.FD
36371>>>>>>>Open Wapomast
36373>>>>>>>Open Sysrecw
36375>>>>>>>Open Syscurxr
36377>>>>>>>
36377>>>>>>>//DDB-HeaderEnd
36377>>>>>>>//DDB-SelectionStart
36377>>>>>>>//DDB/ ExternalSelectionList Wax  Wax.SL
36377>>>>>>>Register_Object Wax
36377>>>>>>>//DDB-SelectionEnd
36377>>>>>>>
36377>>>>>>>Open Units
INCLUDING FILE: UNITS.FD
36379>>>>>>>Open Wapokat
36381>>>>>>>Open WitemKat
INCLUDING FILE: WITEMKAT.FD
36383>>>>>>>
36383>>>>>>>Class Wax_DataDictionary  is a DataDictionary_Sec
36384>>>>>>>
36384>>>>>>>    Procedure Construct_Object
36385>>>>>>>        Forward Send Construct_Object
36387>>>>>>>        Property Integer piMustNOTConstrain Public 0
36388>>>>>>>    End_Procedure //construct_object
36389>>>>>>>
36389>>>>>>>    Procedure OnConstrain
36390>>>>>>>        Forward Send OnConstrain
36392>>>>>>>        If (piMustNOTConstrain(Self)) Begin
36394>>>>>>>        End
36394>>>>>>>>
36394>>>>>>>        Else Begin
36395>>>>>>>            Constrain Wax.Company_Code  eq SysCurXR.Company_Code
36397>>>>>>>            Constrain Wax.Branch_Code   eq SysCurXR.Branch_Code
36399>>>>>>>            Constrain Wax.Year_Year     eq SysCurXR.Year_Year
36401>>>>>>>        End
36401>>>>>>>>
36401>>>>>>>    End_Procedure
36402>>>>>>>
36402>>>>>>>
36402>>>>>>>    // Update:
36402>>>>>>>    Procedure Update
36403>>>>>>>        Forward Send Update
36405>>>>>>>        // Insert Code Here
36405>>>>>>>        Move SysCurXR.Company_Code  to Wax.Company_Code
36406>>>>>>>        Move SysCurXR.Branch_Code   to Wax.Branch_Code
36407>>>>>>>        Move SysCurXR.Year_Year     to Wax.Year_Year
36408>>>>>>>        Move SysCurXR.Year_Recr     to Wax.Year_Recr
36409>>>>>>>        Move Wapokat.Wapokat_Code   to Wax.Wapokat_Code
36410>>>>>>>        Move Wapomast.Wapomast_Code to Wax.Wapomast_Code
36411>>>>>>>    End_Procedure   // Update
36412>>>>>>>
36412>>>>>>>     Procedure Creating
36413>>>>>>>        Forward Send Creating
36415>>>>>>>        // Insert Code Here
36415>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wax.Wax_Rec0)))))) to Wax.Wax_Recr
36416>>>>>>>    End_Procedure   // Creating
36417>>>>>>>
36417>>>>>>>
36417>>>>>>>
36417>>>>>>>    // Define_Fields:
36417>>>>>>>    // This procedure is used to set up all data-dictionary rules.
36417>>>>>>>
36417>>>>>>>    Procedure Define_Fields
36418>>>>>>>        Forward Send Define_Fields
36420>>>>>>>        //DDB-Generated-Code-Location
36420>>>>>>>        //DDB-DefineFieldStart
36420>>>>>>>
36420>>>>>>>        Set Main_File            To Wax.File_Number
36421>>>>>>>        Set Cascade_Delete_State To FALSE
36422>>>>>>>
36422>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
36423>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
36424>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
36425>>>>>>>
36425>>>>>>>        // Child (Client) file structure................
36425>>>>>>>        Send Add_Client_File  Pmoves.File_Number
36426>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
36427>>>>>>>        Send Add_Client_File  Wam.File_Number
36428>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
36429>>>>>>>
36429>>>>>>>        // Parent (Server) file structure...............
36429>>>>>>>        Send Add_Server_File  Wapomast.File_Number
36430>>>>>>>
36430>>>>>>>        // External (System) file structure.............
36430>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
36431>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
36432>>>>>>>
36432>>>>>>>        Define_Auto_Increment  Sysrecw.Wax_Rec0  To Wax.Wax_Rec0
36435>>>>>>>
36435>>>>>>>        // Field-based properties.......................
36435>>>>>>>
36435>>>>>>>        // Wax.Company_Code
36435>>>>>>>
36435>>>>>>>        // Wax.Branch_Code
36435>>>>>>>
36435>>>>>>>        // Wax.Year_Year
36435>>>>>>>
36435>>>>>>>        // Wax.Wapokat_Code
36435>>>>>>>
36435>>>>>>>        // Wax.Wapomast_Code
36435>>>>>>>
36435>>>>>>>        // Wax.Wax_Code
36435>>>>>>>        Set Field_Options          Field Wax.Wax_Code To DD_AUTOFIND   
36436>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Code To (Wax(Self))
36437>>>>>>>
36437>>>>>>>        // Wax.Year_Recr
36437>>>>>>>
36437>>>>>>>        // Wax.Wapomast_Recr
36437>>>>>>>
36437>>>>>>>        // Wax.Wax_Rec0
36437>>>>>>>        Set Field_Options          Field Wax.Wax_Rec0 To DD_AUTOFIND   
36438>>>>>>>
36438>>>>>>>        // Wax.Wax_Recr
36438>>>>>>>        Set Field_Options          Field Wax.Wax_Recr To DD_AUTOFIND   
36439>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Recr To (Wax(Self))
36440>>>>>>>
36440>>>>>>>        // Wax.Wax_Descr
36440>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Descr To (Wax(Self))
36441>>>>>>>
36441>>>>>>>        //DDB-DefineFieldEnd
36441>>>>>>>    End_Procedure    // Define_Fields
36442>>>>>>>
36442>>>>>>>    // Field_Defaults:
36442>>>>>>>    // This procedure is used to establish default field values.
36442>>>>>>>
36442>>>>>>>    Procedure Field_Defaults
36443>>>>>>>        Forward Send Field_Defaults
36445>>>>>>>        //DDB-Generated-Code-Location
36445>>>>>>>        //DDB-FieldDefaultStart
36445>>>>>>>        //DDB-FieldDefaultEnd
36445>>>>>>>    End_Procedure    // Field_Defaults
36446>>>>>>>
36446>>>>>>>End_Class    // Wax_DataDictionary
36447>>>>>>>//DDB-Selection-pkg-Start
36447>>>>>>>
36447>>>>>>>Use Wax.SL           // Wax
36447>>>>>>>
36447>>>>>>>//DDB-Selection-pkg-End
36447>>>>>>>//DDB-FileEnd
36447>>>>>
36447>>>>>//AB-IgnoreEnd
36447>>>>>
36447>>>>>Object Wax is a dbModalPanelSub
36449>>>>>
36449>>>>>    //AB-StoreTopStart
36449>>>>>                                    
36449>>>>>    Property Integer    piMustConstrain Public  0
36451>>>>>    Property Integer    piYear          Public  0
36453>>>>>    Property String     psCompany       Public ''
36455>>>>>    Property String     psBranch        Public ''
36457>>>>>    Property String     psWapokat       Public ''
36459>>>>>    
36459>>>>>    //AB-StoreTopEnd
36459>>>>>
36459>>>>>    Set Label to "‰˜«á¢¦š¦ª €§¦Ÿž¡é¤"
36460>>>>>    Set Size to 148 355
36461>>>>>    Set Location to 8 21
36462>>>>>    Set Exit_Application_Local_State to FALSE
36463>>>>>    Set Modal_State to FALSE
36464>>>>>
36464>>>>>    //AB-DDOStart
36464>>>>>
36464>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
36466>>>>>    End_Object    // Wapokat_DD
36467>>>>>
36467>>>>>    Object Wapomast_DD is a Wapomast_DataDictionary
36469>>>>>        Set DDO_Server to (Wapokat_DD(self))
36470>>>>>    End_Object    // Wapomast_DD
36471>>>>>
36471>>>>>    Object Wax_DD is a Wax_DataDictionary
36473>>>>>        Set DDO_Server to (Wapomast_DD(self))
36474>>>>>
36474>>>>>        //AB-StoreStart
36474>>>>>        
36474>>>>>        Begin_Constraints
36476>>>>>            Integer iMustConstrain iYear
36477>>>>>            String  sCompany sBranch sWapokat
36477>>>>>            Get piMustConstrain to iMustConstrain
36478>>>>>            If (iMustConstrain) Begin
36480>>>>>                Get piYear     to  iYear
36481>>>>>                Get psCompany  to  sCompany
36482>>>>>                Get psBranch   to  sBranch
36483>>>>>                Get psWapokat  to  sWapokat
36484>>>>>                If (sCompany<>'') Begin
36486>>>>>                    Constrain Wax.Company_Code eq sCompany
36488>>>>>                    If (sBranch<>'') Begin
36490>>>>>                        Constrain Wax.Branch_Code eq sBranch
36492>>>>>                        If (iYear<>0) Begin
36494>>>>>                            Constrain Wax.Year_Year eq iYear
36496>>>>>                            If (sWapokat<>'') Begin
36498>>>>>                                Constrain Wax.Wapokat_Code eq sWapokat
36500>>>>>                            End
36500>>>>>>
36500>>>>>                        End
36500>>>>>>
36500>>>>>                    End
36500>>>>>>
36500>>>>>                End
36500>>>>>>
36500>>>>>            End
36500>>>>>>
36500>>>>>        End_Constraints
36503>>>>>        
36503>>>>>        
36503>>>>>        
36503>>>>>        
36503>>>>>        
36503>>>>>        
36503>>>>>        //AB-StoreEnd
36503>>>>>
36503>>>>>    End_Object    // Wax_DD
36504>>>>>
36504>>>>>    Set Main_DD to (Wax_DD(self))
36505>>>>>    Set Server to (Wax_DD(self))
36506>>>>>
36506>>>>>    //AB-DDOEnd
36506>>>>>
36506>>>>>    Object oSelList is a dbListSub
36508>>>>>        Set Main_File to Wax.File_Number
36509>>>>>        Set Size to 105 340
36510>>>>>        Set Location to 5 6
36511>>>>>
36511>>>>>        Begin_Row
36514>>>>>            Entry_Item Wax.Wax_recr
36515>>>>>            Entry_Item Wax.Wax_code
36516>>>>>            Entry_Item Wax.Wax_descr
36517>>>>>        End_Row
36522>>>>>
36522>>>>>        Set Form_Width    item 0 to 33
36523>>>>>        Set Header_Label  item 0 to "Recr"
36524>>>>>        
36524>>>>>        Set Form_Width    item 1 to 80
36525>>>>>        Set Header_Label  item 1 to "‰à› ¡æª"
36526>>>>>        
36526>>>>>        Set Form_Width    item 2 to 219
36527>>>>>        Set Header_Label  item 2 to "œ¨ š¨˜­ã"
36528>>>>>        
36528>>>>>
36528>>>>>        //AB-StoreStart
36528>>>>>        
36528>>>>>        Procedure Activate
36530>>>>>            Send Rebuild_Constraints to Wax_DD
36531>>>>>            Send Beginning_Of_Data to oSelList True
36532>>>>>            Forward Send Activate
36534>>>>>        End_procedure
36535>>>>>        
36535>>>>>        //AB-StoreEnd
36535>>>>>
36535>>>>>    End_Object    // oSelList
36536>>>>>
36536>>>>>    Object oOK_bn is a ButtonSub
36538>>>>>        Set Label to "&„§ ¢¦šã"
36539>>>>>        Set Location to 113 186
36540>>>>>
36540>>>>>        //AB-StoreStart
36540>>>>>        Procedure OnClick
36542>>>>>            Send OK To (oSelList(current_object))
36543>>>>>        End_Procedure
36544>>>>>        //AB-StoreEnd
36544>>>>>
36544>>>>>    End_Object    // oOK_bn
36545>>>>>
36545>>>>>    Object oCancel_bn is a ButtonSub
36547>>>>>        Set Label to "&€¡ç¨à©ž"
36548>>>>>        Set Location to 113 241
36549>>>>>
36549>>>>>        //AB-StoreStart
36549>>>>>        Procedure OnClick
36551>>>>>            Send Cancel To (oSelList(current_object))
36552>>>>>        End_Procedure
36553>>>>>        //AB-StoreEnd
36553>>>>>
36553>>>>>    End_Object    // oCancel_bn
36554>>>>>
36554>>>>>    Object oSearch_bn is a ButtonSub
36556>>>>>        Set Label to "€&¤˜ã«ž©ž"
36557>>>>>        Set Location to 113 296
36558>>>>>
36558>>>>>        //AB-StoreStart
36558>>>>>        Procedure OnClick
36560>>>>>            Send Search To (oSelList(current_object))
36561>>>>>        End_Procedure
36562>>>>>        //AB-StoreEnd
36562>>>>>
36562>>>>>    End_Object    // oSearch_bn
36563>>>>>
36563>>>>>
36563>>>>>    //AB-StoreStart
36563>>>>>                                    
36563>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
36564>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
36565>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
36566>>>>>    
36566>>>>>    
36566>>>>>    
36566>>>>>    
36566>>>>>    
36566>>>>>    
36566>>>>>    //AB-StoreEnd
36566>>>>>
36566>>>>>End_Object    // Wax
36567>>>>>
36567>>>>>//AB/ End_Object    // prj
36567>>>Use sl001.sl
36567>>>Use sl002.sl
36567>>>Use sl003.sl
36567>>>Use sl006.sl
INCLUDING FILE: SL006.SL
36567>>>>>//AB/ Project sl006:Cmoves lookup
36567>>>>>//AB/ Object prj is a Lookup_Project
36567>>>>>//AB/     Set ProjectName to "sl006:Cmoves lookup"
36567>>>>>//AB/     Set ProjectFileName to "sl006.SL"
36567>>>>>//AB/     Set GenerateFileName to "NONAME"
36567>>>>>
36567>>>>>// Project Object Structure
36567>>>>>//   sl006 is a dbModalPanelSub
36567>>>>>//     Ctypkin_DD is a DataDictionary
36567>>>>>//     Clients_DD is a DataDictionary
36567>>>>>//     Cmoves_DD is a DataDictionary
36567>>>>>//     oSelList is a dbListSub
36567>>>>>//     oOK_bn is a ButtonSub
36567>>>>>//     oCancel_bn is a ButtonSub
36567>>>>>//     oSearch_bn is a ButtonSub
36567>>>>>//     Cmoves_Axia_Pros_Sysx is a dbFormSub
36567>>>>>//     Cmoves_Axia_Sysxet is a dbFormSub
36567>>>>>//     Cmoves_Axia_Ypol_Sysx is a dbFormSub
36567>>>>>//     TextBoxSub1 is a TextBoxSub
36567>>>>>//     TextBoxSub2 is a TextBoxSub
36567>>>>>//     TextBoxSub3 is a TextBoxSub
36567>>>>>//     RadioGroupSub2 is a RadioGroupSub
36567>>>>>//       Radio4 is a RadioSub
36567>>>>>//       Radio5 is a RadioSub
36567>>>>>//       Radio6 is a RadioSub
36567>>>>>
36567>>>>>// Register all objects
36567>>>>>Register_Object Clients_DD
36567>>>>>Register_Object Cmoves_Axia_Pros_Sysx
36567>>>>>Register_Object Cmoves_Axia_Sysxet
36567>>>>>Register_Object Cmoves_Axia_Ypol_Sysx
36567>>>>>Register_Object Cmoves_DD
36567>>>>>Register_Object Ctypkin_DD
36567>>>>>Register_Object oCancel_bn
36567>>>>>Register_Object oOK_bn
36567>>>>>Register_Object oSearch_bn
36567>>>>>Register_Object oSelList
36567>>>>>Register_Object Radio4
36567>>>>>Register_Object Radio5
36567>>>>>Register_Object Radio6
36567>>>>>Register_Object RadioGroupSub2
36567>>>>>Register_Object sl006
36567>>>>>Register_Object TextBoxSub1
36567>>>>>Register_Object TextBoxSub2
36567>>>>>Register_Object TextBoxSub3
36567>>>>>
36567>>>>>
36567>>>>>//AB-IgnoreStart
36567>>>>>
36567>>>>>Use DFAllEnt.pkg
36567>>>>>Use dbList.Sub
36567>>>>>Use Button.Sub
36567>>>>>Use dbForm.Sub
36567>>>>>Use Txtbox.Sub
36567>>>>>Use Rgroup.Sub
36567>>>>>Use Radio.Sub
36567>>>>>
36567>>>>>
36567>>>>>Use CTYPKIN.DD
INCLUDING FILE: CTYPKIN.DD
36567>>>>>>>//DDB-FileStart
36567>>>>>>>//DDB-HeaderStart
36567>>>>>>>
36567>>>>>>>// File Name : CTYPKIN.DD
36567>>>>>>>// Class Name: Ctypkin_DataDictionary
36567>>>>>>>// Revision  : 70
36567>>>>>>>// Version   : 2
36567>>>>>>>
36567>>>>>>>Use  Windows           // Basic Definitions
36567>>>>>>>Use  DataDict          // DataDictionary Class Definition
36567>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36567>>>>>>>
36567>>>>>>>Open Ctypkin
INCLUDING FILE: CTYPKIN.FD
36569>>>>>>>Open Cmoves
INCLUDING FILE: CMOVES.FD
36571>>>>>>>Open Cflagkin
INCLUDING FILE: CFLAGKIN.FD
36573>>>>>>>Open Ptypparl
36575>>>>>>>Open Ptyppar
INCLUDING FILE: PTYPPAR.FD
36577>>>>>>>Open Hmctyp
INCLUDING FILE: HMCTYP.FD
36579>>>>>>>Open Cmovesa
INCLUDING FILE: CMOVESA.FD
36581>>>>>>>Open Sysrecc
INCLUDING FILE: SYSRECC.FD
36583>>>>>>>Open Syscurxr
36585>>>>>>>
36585>>>>>>>//DDB-HeaderEnd
36585>>>>>>>//DDB-ValidationStart
36585>>>>>>>
36585>>>>>>>Register_Object Ctypkin_Ctypkin_Module_VT
36585>>>>>>>
36585>>>>>>>Object Ctypkin_Ctypkin_Module_VT  is a CodeValidationTable
36587>>>>>>>    Set Type_Value        To "MODULE"
36588>>>>>>>    //DDB-ValidationCustomStart
36588>>>>>>>    //DDB-ValidationCustomEnd
36588>>>>>>>End_Object   // Ctypkin_Ctypkin_Module_VT
36589>>>>>>>//DDB-ValidationEnd
36589>>>>>>>//DDB-SelectionStart
36589>>>>>>>//DDB/ ExternalSelectionList sl007  sl007.SL
36589>>>>>>>Register_Object sl007
36589>>>>>>>//DDB-SelectionEnd
36589>>>>>>>
36589>>>>>>>Class Ctypkin_DataDictionary  is a DataDictionary
36590>>>>>>>         
36590>>>>>>>    Procedure Construct_Object
36591>>>>>>>        Forward Send Construct_Object
36593>>>>>>>        Property Integer piMustNOTConstrain Public 0
36594>>>>>>>    End_Procedure
36595>>>>>>>
36595>>>>>>>    Procedure Save_Main_File
36596>>>>>>>        If (Operation_Origin<>Self) Begin
36598>>>>>>>            If Ctypkin.Recnum Eq 0 Procedure_Return
36601>>>>>>>        End
36601>>>>>>>>
36601>>>>>>>        Forward Send Save_Main_File
36603>>>>>>>    End_Procedure
36604>>>>>>>
36604>>>>>>>     Procedure Creating
36605>>>>>>>        Forward Send Creating
36607>>>>>>>        // Insert Code Here
36607>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Ctypkin.Ctypkin_Rec0)))))) to Ctypkin.Ctypkin_Recr
36608>>>>>>>    End_Procedure   // Creating
36609>>>>>>>
36609>>>>>>>
36609>>>>>>>    // Define_Fields:
36609>>>>>>>    // This procedure is used to set up all data-dictionary rules.
36609>>>>>>>
36609>>>>>>>    Procedure Define_Fields
36610>>>>>>>        Forward Send Define_Fields
36612>>>>>>>        //DDB-Generated-Code-Location
36612>>>>>>>        //DDB-DefineFieldStart
36612>>>>>>>
36612>>>>>>>        Set Main_File            To Ctypkin.File_Number
36613>>>>>>>        Set Cascade_Delete_State To FALSE
36614>>>>>>>
36614>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
36615>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
36616>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
36617>>>>>>>
36617>>>>>>>        // Child (Client) file structure................
36617>>>>>>>        Send Add_Client_File  Cmoves.File_Number
36618>>>>>>>        Send Add_Client_File  Cflagkin.File_Number
36619>>>>>>>        Send Add_Client_File  Ptypparl.File_Number
36620>>>>>>>        Send Add_Client_File  Ptyppar.File_Number
36621>>>>>>>        Send Add_Client_File  Hmctyp.File_Number
36622>>>>>>>        Send Add_Client_File  Cmovesa.File_Number
36623>>>>>>>
36623>>>>>>>        // External (System) file structure.............
36623>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
36624>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
36625>>>>>>>
36625>>>>>>>        Define_Auto_Increment  Sysrecc.Ctypkin_Rec0  To Ctypkin.Ctypkin_Rec0
36628>>>>>>>
36628>>>>>>>        // Field-based properties.......................
36628>>>>>>>
36628>>>>>>>        // Ctypkin.Company_Code
36628>>>>>>>
36628>>>>>>>        // Ctypkin.Branch_Code
36628>>>>>>>
36628>>>>>>>        // Ctypkin.Year_Year
36628>>>>>>>
36628>>>>>>>        // Ctypkin.Ctypkin_Code
36628>>>>>>>        Set Field_Options          Field Ctypkin.Ctypkin_Code To DD_AUTOFIND   
36629>>>>>>>        Set Field_Prompt_Object    Field Ctypkin.Ctypkin_Code To (sl007(Self))
36630>>>>>>>        Set Key_Field_State        Field Ctypkin.Ctypkin_Code To TRUE
36631>>>>>>>
36631>>>>>>>        // Ctypkin.Ctypkin_Rec0
36631>>>>>>>
36631>>>>>>>        // Ctypkin.Ctypkin_Recr
36631>>>>>>>
36631>>>>>>>        // Ctypkin.Year_Recr
36631>>>>>>>
36631>>>>>>>        // Ctypkin.Ctypkin_Descr
36631>>>>>>>        Set Field_Prompt_Object    Field Ctypkin.Ctypkin_Descr To (sl007(Self))
36632>>>>>>>
36632>>>>>>>        // Ctypkin.Ctypkin_Anti
36632>>>>>>>
36632>>>>>>>        // Ctypkin.Ctypkin_Flags
36632>>>>>>>
36632>>>>>>>        // Ctypkin.Ctypkin_Module
36632>>>>>>>        Set Field_Value_Table      Field Ctypkin.Ctypkin_Module To (Ctypkin_Ctypkin_Module_VT(Self))
36633>>>>>>>
36633>>>>>>>        // Ctypkin.Open_Item
36633>>>>>>>
36633>>>>>>>        // Ctypkin.Check_Overhead
36633>>>>>>>
36633>>>>>>>        // Ctypkin.Max_Days_Sx_Par
36633>>>>>>>
36633>>>>>>>        // Ctypkin.Singular
36633>>>>>>>
36633>>>>>>>        // Ctypkin.Sub
36633>>>>>>>
36633>>>>>>>        // Ctypkin.Subreport
36633>>>>>>>
36633>>>>>>>        //DDB-DefineFieldEnd
36633>>>>>>>    End_Procedure    // Define_Fields
36634>>>>>>>
36634>>>>>>>    // Field_Defaults:
36634>>>>>>>    // This procedure is used to establish default field values.
36634>>>>>>>
36634>>>>>>>    Procedure Field_Defaults
36635>>>>>>>        Forward Send Field_Defaults
36637>>>>>>>        //DDB-Generated-Code-Location
36637>>>>>>>        //DDB-FieldDefaultStart
36637>>>>>>>        //DDB-FieldDefaultEnd
36637>>>>>>>    End_Procedure    // Field_Defaults
36638>>>>>>>
36638>>>>>>>End_Class    // Ctypkin_DataDictionary
36639>>>>>>>//DDB-Selection-pkg-Start
36639>>>>>>>
36639>>>>>>>Use sl007.SL         // sl007
INCLUDING FILE: SL007.SL
36639>>>>>>>>>//AB/ Project Ctypkin : sl007
36639>>>>>>>>>//AB/ Object prj is a Lookup_Project
36639>>>>>>>>>//AB/     Set ProjectName to "Ctypkin : sl007"
36639>>>>>>>>>//AB/     Set ProjectFileName to "sl007.SL"
36639>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
36639>>>>>>>>>
36639>>>>>>>>>// Project Object Structure
36639>>>>>>>>>//   sl007 is a dbModalPanelSub
36639>>>>>>>>>//     Ctypkin_DD is a DataDictionary
36639>>>>>>>>>//     oSelList is a dbListSub
36639>>>>>>>>>//     oOK_bn is a ButtonSub
36639>>>>>>>>>//     oCancel_bn is a ButtonSub
36639>>>>>>>>>//     oSearch_bn is a ButtonSub
36639>>>>>>>>>
36639>>>>>>>>>// Register all objects
36639>>>>>>>>>Register_Object Ctypkin_DD
36639>>>>>>>>>Register_Object oCancel_bn
36639>>>>>>>>>Register_Object oOK_bn
36639>>>>>>>>>Register_Object oSearch_bn
36639>>>>>>>>>Register_Object oSelList
36639>>>>>>>>>Register_Object sl007
36639>>>>>>>>>
36639>>>>>>>>>
36639>>>>>>>>>//AB-IgnoreStart
36639>>>>>>>>>
36639>>>>>>>>>Use DFAllEnt.pkg
36639>>>>>>>>>Use dbList.Sub
36639>>>>>>>>>Use Button.Sub
36639>>>>>>>>>
36639>>>>>>>>>
36639>>>>>>>>>Use CTYPKIN.DD
36639>>>>>>>>>
36639>>>>>>>>>//AB-IgnoreEnd
36639>>>>>>>>>
36639>>>>>>>>>Object sl007 is a dbModalPanelSub
36641>>>>>>>>>
36641>>>>>>>>>    //AB-StoreTopStart
36641>>>>>>>>>    Property String psModule Public ''
36643>>>>>>>>>    
36643>>>>>>>>>    //AB-StoreTopEnd
36643>>>>>>>>>
36643>>>>>>>>>    Set Label to "‰ ¤ã©œ ª    "
36644>>>>>>>>>    Set Size to 148 350
36645>>>>>>>>>    Set Location to 4 7
36646>>>>>>>>>    Set Exit_Application_Local_State to FALSE
36647>>>>>>>>>    Set Modal_State to FALSE
36648>>>>>>>>>
36648>>>>>>>>>    //AB-DDOStart
36648>>>>>>>>>
36648>>>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
36650>>>>>>>>>
36650>>>>>>>>>        //AB-StoreStart
36650>>>>>>>>>                                
36650>>>>>>>>>        Begin_Constraints
36652>>>>>>>>>            If (psModule(sl007(Self))<>'') Constrain Ctypkin.Ctypkin_Module eq (psModule(sl007(Self)))
36656>>>>>>>>>        End_Constraints
36659>>>>>>>>>        
36659>>>>>>>>>        
36659>>>>>>>>>        
36659>>>>>>>>>        
36659>>>>>>>>>        //AB-StoreEnd
36659>>>>>>>>>
36659>>>>>>>>>    End_Object    // Ctypkin_DD
36660>>>>>>>>>
36660>>>>>>>>>    Set Main_DD to (Ctypkin_DD(self))
36661>>>>>>>>>    Set Server to (Ctypkin_DD(self))
36662>>>>>>>>>
36662>>>>>>>>>    //AB-DDOEnd
36662>>>>>>>>>
36662>>>>>>>>>    Object oSelList is a dbListSub
36664>>>>>>>>>        Set Main_File to Ctypkin.File_Number
36665>>>>>>>>>        Set Size to 105 335
36666>>>>>>>>>        Set Location to 6 6
36667>>>>>>>>>
36667>>>>>>>>>        Begin_Row
36670>>>>>>>>>            Entry_Item Ctypkin.Ctypkin_code
36671>>>>>>>>>            Entry_Item Ctypkin.Ctypkin_descr
36672>>>>>>>>>        End_Row
36677>>>>>>>>>
36677>>>>>>>>>        Set Form_Width    item 0 to 71
36678>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª ‰ ¤ã©œàª"
36679>>>>>>>>>        
36679>>>>>>>>>        Set Form_Width    item 1 to 255
36680>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã ‰ ¤ã©œàª"
36681>>>>>>>>>        
36681>>>>>>>>>
36681>>>>>>>>>        //AB-StoreStart
36681>>>>>>>>>                    
36681>>>>>>>>>                    
36681>>>>>>>>>        Procedure Activate
36683>>>>>>>>>            Forward Send Activate
36685>>>>>>>>>            Send Beginning_Of_Data to oSelList True
36686>>>>>>>>>        End_Procedure
36687>>>>>>>>>        
36687>>>>>>>>>        
36687>>>>>>>>>        
36687>>>>>>>>>        
36687>>>>>>>>>        //AB-StoreEnd
36687>>>>>>>>>
36687>>>>>>>>>    End_Object    // oSelList
36688>>>>>>>>>
36688>>>>>>>>>    Object oOK_bn is a ButtonSub
36690>>>>>>>>>        Set Label to "&„§ ¢¦šã"
36691>>>>>>>>>        Set Location to 113 171
36692>>>>>>>>>
36692>>>>>>>>>        //AB-StoreStart
36692>>>>>>>>>        Procedure OnClick
36694>>>>>>>>>            Send OK To (oSelList(current_object))
36695>>>>>>>>>        End_Procedure
36696>>>>>>>>>        //AB-StoreEnd
36696>>>>>>>>>
36696>>>>>>>>>    End_Object    // oOK_bn
36697>>>>>>>>>
36697>>>>>>>>>    Object oCancel_bn is a ButtonSub
36699>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
36700>>>>>>>>>        Set Location to 113 226
36701>>>>>>>>>
36701>>>>>>>>>        //AB-StoreStart
36701>>>>>>>>>        Procedure OnClick
36703>>>>>>>>>            Send Cancel To (oSelList(current_object))
36704>>>>>>>>>        End_Procedure
36705>>>>>>>>>        //AB-StoreEnd
36705>>>>>>>>>
36705>>>>>>>>>    End_Object    // oCancel_bn
36706>>>>>>>>>
36706>>>>>>>>>    Object oSearch_bn is a ButtonSub
36708>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
36709>>>>>>>>>        Set Location to 113 281
36710>>>>>>>>>
36710>>>>>>>>>        //AB-StoreStart
36710>>>>>>>>>        Procedure OnClick
36712>>>>>>>>>            Send Search To (oSelList(current_object))
36713>>>>>>>>>        End_Procedure
36714>>>>>>>>>        //AB-StoreEnd
36714>>>>>>>>>
36714>>>>>>>>>    End_Object    // oSearch_bn
36715>>>>>>>>>
36715>>>>>>>>>
36715>>>>>>>>>    //AB-StoreStart
36715>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
36716>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
36717>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
36718>>>>>>>>>    
36718>>>>>>>>>    Procedure Activate Returns Integer
36720>>>>>>>>>        Integer rVal
36721>>>>>>>>>        Send Rebuild_Constraints to Ctypkin_DD
36722>>>>>>>>>        Forward Get Msg_Activate to rVal
36724>>>>>>>>>        Procedure_Return rVal
36725>>>>>>>>>    End_Procedure
36726>>>>>>>>>    
36726>>>>>>>>>    //AB-StoreEnd
36726>>>>>>>>>
36726>>>>>>>>>End_Object    // sl007
36727>>>>>>>>>
36727>>>>>>>>>//AB/ End_Object    // prj
36727>>>>>>>
36727>>>>>>>//DDB-Selection-pkg-End
36727>>>>>>>//DDB-FileEnd
36727>>>>>Use CLIENTS.DD
INCLUDING FILE: CLIENTS.DD
36727>>>>>>>//DDB-FileStart
36727>>>>>>>//DDB-HeaderStart
36727>>>>>>>
36727>>>>>>>// File Name : CLIENTS.DD
36727>>>>>>>// Class Name: Clients_DataDictionary
36727>>>>>>>// Revision  : 241
36727>>>>>>>// Version   : 2
36727>>>>>>>
36727>>>>>>>Use  Windows           // Basic Definitions
36727>>>>>>>Use  DataDict          // DataDictionary Class Definition
36727>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36727>>>>>>>
36727>>>>>>>Open Clients
36729>>>>>>>Open Cmoves
36731>>>>>>>Open Particle
INCLUDING FILE: PARTICLE.FD
36733>>>>>>>Open Cmovesa
36735>>>>>>>Open Cn
36737>>>>>>>Open Particll
INCLUDING FILE: PARTICLL.FD
36739>>>>>>>Open Clnbank
INCLUDING FILE: CLNBANK.FD
36741>>>>>>>Open Tpclient
INCLUDING FILE: TPCLIENT.FD
36743>>>>>>>Open Clorder
INCLUDING FILE: CLORDER.FD
36745>>>>>>>Open Clitem
INCLUDING FILE: CLITEM.FD
36747>>>>>>>Open Cities
36749>>>>>>>Open Areas
36751>>>>>>>Open Payresp
36753>>>>>>>Open Syscurxr
36755>>>>>>>Open Sysrecc
36757>>>>>>>Open Ptypparl
36759>>>>>>>Open Gmove
INCLUDING FILE: GMOVE.FD
36761>>>>>>>Open Sysrecg
36763>>>>>>>
36763>>>>>>>//DDB-HeaderEnd
36763>>>>>>>//DDB-ValidationStart
36763>>>>>>>
36763>>>>>>>Register_Object Clients_Client_Doy_VT
36763>>>>>>>Register_Object Clients_Client_Job_VT
36763>>>>>>>Register_Object Clients_Client_Categfpa_VT
36763>>>>>>>Register_Object Clients_Client_Catjob_VT1
36763>>>>>>>Register_Object Clients_Client_Idiot_VT
36763>>>>>>>Register_Object Clients_Feregios_VT
36763>>>>>>>
36763>>>>>>>Object Clients_Client_Doy_VT  is a CodeValidationTable
36765>>>>>>>    Set Type_Value        To "DOY"
36766>>>>>>>    Set Validate_State    To FALSE
36767>>>>>>>    Set Allow_Blank_State To TRUE
36768>>>>>>>    Set Table_Title       To "ƒ.Ž.“"
36769>>>>>>>    //DDB-ValidationCustomStart
36769>>>>>>>    //DDB-ValidationCustomEnd
36769>>>>>>>End_Object   // Clients_Client_Doy_VT
36770>>>>>>>
36770>>>>>>>Object Clients_Client_Job_VT  is a CodeValidationTable
36772>>>>>>>    Set Type_Value        To "JOB"
36773>>>>>>>    Set Validate_State    To FALSE
36774>>>>>>>    Set Allow_Blank_State To TRUE
36775>>>>>>>    Set Table_Title       To "„§˜ššâ¢£˜«˜"
36776>>>>>>>    //DDB-ValidationCustomStart
36776>>>>>>>    //DDB-ValidationCustomEnd
36776>>>>>>>End_Object   // Clients_Client_Job_VT
36777>>>>>>>
36777>>>>>>>Object Clients_Client_Categfpa_VT  is a CodeValidationTable
36779>>>>>>>    Set Type_Value        To "VAT_STATUS"
36780>>>>>>>    Set Validate_State    To FALSE
36781>>>>>>>    Set Allow_Blank_State To TRUE
36782>>>>>>>    //DDB-ValidationCustomStart
36782>>>>>>>    //DDB-ValidationCustomEnd
36782>>>>>>>End_Object   // Clients_Client_Categfpa_VT
36783>>>>>>>
36783>>>>>>>Object Clients_Client_Catjob_VT1  is a CodeValidationTable
36785>>>>>>>    Set Type_Value        To "JOB"
36786>>>>>>>    Set Validate_State    To FALSE
36787>>>>>>>    Set Allow_Blank_State To TRUE
36788>>>>>>>    //DDB-ValidationCustomStart
36788>>>>>>>    //DDB-ValidationCustomEnd
36788>>>>>>>End_Object   // Clients_Client_Catjob_VT1
36789>>>>>>>
36789>>>>>>>Object Clients_Client_Idiot_VT  is a CodeValidationTable
36791>>>>>>>    Set Type_Value        To "IDIOT"
36792>>>>>>>    Set Validate_State    To FALSE
36793>>>>>>>    Set Allow_Blank_State To TRUE
36794>>>>>>>    Set Table_Title       To "€¨®œå¦ ˆ› ¦«ã«à¤"
36795>>>>>>>    //DDB-ValidationCustomStart
36795>>>>>>>    //DDB-ValidationCustomEnd
36795>>>>>>>End_Object   // Clients_Client_Idiot_VT
36796>>>>>>>
36796>>>>>>>Object Clients_Feregios_VT  is a CodeValidationTable
36798>>>>>>>    Set Type_Value        To "FEREGIOS"
36799>>>>>>>    Set Allow_Blank_State To TRUE
36800>>>>>>>    Set Table_Title       To "ƒœå¡«œª ”œ¨œšš¬æ«ž«˜ª ”¦¨âà¤"
36801>>>>>>>    //DDB-ValidationCustomStart
36801>>>>>>>    //DDB-ValidationCustomEnd
36801>>>>>>>End_Object   // Clients_Feregios_VT
36802>>>>>>>//DDB-ValidationEnd
36802>>>>>>>//DDB-SelectionStart
36802>>>>>>>//DDB/ ExternalSelectionList sl100  sl100.SL
36802>>>>>>>Register_Object sl100
36802>>>>>>>//DDB-SelectionEnd
36802>>>>>>>Open Sysfile
36804>>>>>>>open year
36806>>>>>>>
36806>>>>>>>Class Clients_DataDictionary  is a DataDictionary_Sec
36807>>>>>>>
36807>>>>>>>    Procedure Construct_Object
36808>>>>>>>        Forward Send Construct_Object
36810>>>>>>>        Property Integer piMustNOTConstrain Public 0
36811>>>>>>>        Property Integer piCheckPlaf        Public 0
36812>>>>>>>        //------------------------------------------------
36812>>>>>>>        // Properties gia na kraththoun oi palies times
36812>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio
36812>>>>>>>        // einai 1     js 03/12/2007
36812>>>>>>>        //------------------------------------------------
36812>>>>>>>        Property Integer piCreateNew            Public  0
36813>>>>>>>        Property String  psAud_Old_Pelaths      Public ""
36814>>>>>>>        Property String  psAud_Old_PelathsN     Public ""
36815>>>>>>>        Property String  psAud_Old_AFM          Public ""
36816>>>>>>>        Property String  psAud_Old_DOY          Public ""
36817>>>>>>>        Property String  psAud_Old_DOYN         Public ""
36818>>>>>>>        Property Integer piAud_Old_HPAL         Public  0
36819>>>>>>>        Property Integer piAud_Old_HPSO         Public  0
36820>>>>>>>        Property String  psAud_Old_PartlRecr    Public ""
36821>>>>>>>        Property String  psAud_Old_PmsRecr      Public ""
36822>>>>>>>        //------------------------------------------------
36822>>>>>>>
36822>>>>>>>    End_Procedure
36823>>>>>>>
36823>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
36824>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
36826>>>>>>>        //------------------------------------------------
36826>>>>>>>        // Properties gia na kraththoun oi palies times
36826>>>>>>>        // ton pedion js 03/12/2007
36826>>>>>>>        //------------------------------------------------
36826>>>>>>>        Set psAud_Old_Pelaths      to Clients.Client_ID
36827>>>>>>>        Set psAud_Old_PelathsN     to Clients.Client_Name
36828>>>>>>>        Set psAud_Old_AFM          to Clients.Client_AFM
36829>>>>>>>        Set psAud_Old_DOY          to Clients.Client_Doy
36830>>>>>>>        Set psAud_Old_DOYN         to (gsfCode_Mast("DOY",Clients.Client_Doy))
36831>>>>>>>        Set piAud_Old_HPAL         to Clients.HPAL
36832>>>>>>>        Set piAud_Old_HPSO         to Clients.HPSO
36833>>>>>>>        Set psAud_Old_PartlRecr    to Clients.Client_Recr
36834>>>>>>>        Set psAud_Old_PmsRecr      to Clients.Client_Recr
36835>>>>>>>        //------------------------------------------------
36835>>>>>>>     End_Procedure   // New_Current_Record
36836>>>>>>>
36836>>>>>>>
36836>>>>>>>    // Backout:
36836>>>>>>>    Procedure Backout
36837>>>>>>>        Forward Send Backout
36839>>>>>>>        // Insert Code Here
36839>>>>>>>    End_Procedure   // Backout
36840>>>>>>>
36840>>>>>>>    Procedure Delete_Main_File
36841>>>>>>>        //---------------------------------------------
36841>>>>>>>        // Auditing / Katagrafh allagon
36841>>>>>>>        String  sUser sText sTime sMin sHour sSec
36842>>>>>>>        Date    dDate  Shmer
36842>>>>>>>        Integer iMin iHour iSec iLen
36842>>>>>>>        Sysdate dDate iHour iMin iSec
36846>>>>>>>        Move iHour  to sHour
36847>>>>>>>        Move iMin   to sMin
36848>>>>>>>        Move iSec   to sSec
36849>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
36853>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
36857>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
36861>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
36862>>>>>>>
36862>>>>>>>        // Auditing / Diagrafh
36862>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
36864>>>>>>>            Get fsLoginUserID to sUser
36865>>>>>>>            clear gmove
36866>>>>>>>            move syscurxr.company_code  to gmove.company_code
36867>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
36868>>>>>>>            move syscurxr.year_year     to gmove.year_year
36869>>>>>>>            move  2                     to gmove.gtypkin_code// Apo Clients
36870>>>>>>>            move ddate                  to gmove.garticl_hmnia
36871>>>>>>>            move suser                  to gmove.gplan_code
36872>>>>>>>            move Clients.Client_Recr    to gmove.garticl_recr
36873>>>>>>>            reread sysrecg
36877>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
36878>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
36879>>>>>>>            saverecord sysrecg
36880>>>>>>>            unlock
36881>>>>>>>>
36881>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
36882>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
36883>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs
36884>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
36885>>>>>>>
36885>>>>>>>            Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
36886>>>>>>>            Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
36887>>>>>>>            Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
36888>>>>>>>            Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy
36889>>>>>>>            Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
36890>>>>>>>            Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
36891>>>>>>>            Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
36892>>>>>>>
36892>>>>>>>
36892>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª œ¢á«ž"     to gmove.gmove_aitiol
36893>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
36894>>>>>>>            saverecord gmove
36895>>>>>>>        End
36895>>>>>>>>
36895>>>>>>>
36895>>>>>>>        Forward Send Delete_Main_File
36897>>>>>>>
36897>>>>>>>    End_Procedure
36898>>>>>>>
36898>>>>>>>
36898>>>>>>>    Procedure Update
36899>>>>>>>        Forward Send Update
36901>>>>>>>        // Insert Code Here
36901>>>>>>>        Move SysCurXR.Company_Code  to Clients.Company_Code
36902>>>>>>>        Move SysCurXR.Branch_Code   to Clients.Branch_Code
36903>>>>>>>        Move SysCurXR.Year_Year     to Clients.Year_Year
36904>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
36904>>>>>>>        Move (Clients.Xreosh-Clients.Pistosh)   to Clients.Ypoloipo
36905>>>>>>>        Move (Clients.Plafon-Clients.Ypoloipo)  to Clients.Overhead
36906>>>>>>>
36906>>>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
36906>>>>>>>
36906>>>>>>>        //betolink
36906>>>>>>>        Move SysCurXR.Beto_Site      to Clients.Client_SiteW
36907>>>>>>>        Move Clients.Client_Rec0     to Clients.Client_SN
36908>>>>>>>        Move Clients.Client_id       to Clients.Client_Repm
36909>>>>>>>        Move Clients.Company_Code    to Clients.CLIENT_COMPANY
36910>>>>>>>        Move Clients.Client_id       to Clients.Client_RepMatch
36911>>>>>>>     //   Move (gsfCode_Mast('JOB',Clients.Client_CatJob)) to Clients.Client_Job             
36911>>>>>>>     
36911>>>>>>>     
36911>>>>>>>        //---------------------------------------------
36911>>>>>>>        // Auditing / Katagrafh allagon
36911>>>>>>>        String  sUser sText sTime sMin sHour sSec
36912>>>>>>>        Date    dDate  Shmer 
36912>>>>>>>        Integer iMin iHour iSec iLen
36912>>>>>>>        Sysdate dDate iHour iMin iSec 
36916>>>>>>>        Move iHour  to sHour
36917>>>>>>>        Move iMin   to sMin
36918>>>>>>>        Move iSec   to sSec
36919>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
36923>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
36927>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
36931>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
36932>>>>>>>        
36932>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
36932>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
36934>>>>>>>            Get fsLoginUserID to sUser
36935>>>>>>>            If (piCreateNew(Self)=1) Begin
36937>>>>>>>                clear gmove
36938>>>>>>>                move syscurxr.company_code  to gmove.company_code
36939>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
36940>>>>>>>                move syscurxr.year_year     to gmove.year_year
36941>>>>>>>                move  2                     to gmove.gtypkin_code// Apo Clients
36942>>>>>>>                move ddate                  to gmove.garticl_hmnia
36943>>>>>>>                move suser                  to gmove.gplan_code
36944>>>>>>>                move Clients.Client_Recr    to gmove.garticl_recr
36945>>>>>>>                reread sysrecg
36949>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
36950>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
36951>>>>>>>                saverecord sysrecg
36952>>>>>>>                unlock
36953>>>>>>>>
36953>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
36954>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
36955>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
36956>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
36957>>>>>>>                Move Clients.Client_ID              to Gmove.Cur_ID
36958>>>>>>>                Move Clients.CLient_Name            to Gmove.Cur_Name
36959>>>>>>>                Move Clients.Client_Recr            to Gmove.Partl_Recr 
36960>>>>>>>                Move Clients.Client_Recr            to Gmove.Pms_Recr  
36961>>>>>>>                Move Clients.Client_AFM             to Gmove.Cur_AFM
36962>>>>>>>                Move Clients.Client_DOY             to Gmove.Cur_DOY
36963>>>>>>>                Move (gsfCode_Mast("DOY",Clients.Client_Doy)) to Gmove.Txt4
36964>>>>>>>                Move Clients.HPAL                   to Gmove.Prev_Stoxos1
36965>>>>>>>                Move Clients.HPSO                   to Gmove.Prev_Stoxos2
36966>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â¦¬ œ¢á«ž"       to Gmove.Gmove_Aitiol
36967>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs
36968>>>>>>>                saverecord gmove
36969>>>>>>>                Set piCreateNew to 0
36970>>>>>>>            End
36970>>>>>>>>
36970>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
36973>>>>>>>                Integer isChanged
36973>>>>>>>                Move 0 to isChanged
36974>>>>>>>                
36974>>>>>>>                     If (psAud_Old_Pelaths  (Self)<>Clients.Client_ID   ) Move 1 to isChanged
36977>>>>>>>                Else If (psAud_Old_PelathsN (Self)<>Clients.Client_Name ) Move 1 to isChanged
36981>>>>>>>                Else If (psAud_Old_AFM      (Self)<>Clients.Client_AFM  ) Move 1 to isChanged
36985>>>>>>>                Else If (psAud_Old_DOY      (Self)<>Clients.Client_DOY  ) Move 1 to isChanged
36989>>>>>>>                Else If (piAud_Old_HPAL     (Self)<>Clients.HPAL        ) Move 1 to isChanged
36993>>>>>>>                Else If (piAud_Old_HPSO     (Self)<>Clients.HPSO        ) Move 1 to isChanged
36997>>>>>>>                
36997>>>>>>>                If (isChanged>0) Begin  
36999>>>>>>>                    clear gmove
37000>>>>>>>                    move syscurxr.company_code  to gmove.company_code
37001>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
37002>>>>>>>                    move syscurxr.year_year     to gmove.year_year
37003>>>>>>>                    move  2                     to gmove.gtypkin_code// Apo Clients
37004>>>>>>>                    move ddate                  to gmove.garticl_hmnia
37005>>>>>>>                    move suser                  to gmove.gplan_code
37006>>>>>>>                    move Clients.Client_Recr    to gmove.garticl_recr
37007>>>>>>>                    reread sysrecg
37011>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
37012>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
37013>>>>>>>                    saverecord sysrecg
37014>>>>>>>                    unlock
37015>>>>>>>>
37015>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
37016>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
37017>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
37018>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
37019>>>>>>>                    Move Clients.Client_Recr            to Gmove.Partl_Recr 
37020>>>>>>>                    Move Clients.Client_Recr            to Gmove.Pms_Recr  
37021>>>>>>>                    //--
37021>>>>>>>                    Move Clients.Client_ID              to Gmove.Cur_ID
37022>>>>>>>                    Move Clients.CLient_Name            to Gmove.Cur_Name
37023>>>>>>>                    Move Clients.Client_AFM             to Gmove.Cur_AFM
37024>>>>>>>                    Move Clients.Client_DOY             to Gmove.Cur_DOY
37025>>>>>>>                    Move (gsfCode_Mast("DOY",Clients.Client_Doy)) to Gmove.Txt4
37026>>>>>>>                    Move Clients.HPAL                   to Gmove.Cur_Stoxos1
37027>>>>>>>                    Move Clients.HPSO                   to Gmove.Cur_Stoxos2
37028>>>>>>>                    //--
37028>>>>>>>                    Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
37029>>>>>>>                    Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
37030>>>>>>>                    Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
37031>>>>>>>                    Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy 
37032>>>>>>>                    Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
37033>>>>>>>                    Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
37034>>>>>>>                    Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
37035>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª œ¢á«ž"     to gmove.gmove_aitiol
37036>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
37037>>>>>>>                    saverecord gmove
37038>>>>>>>                    Set piCreateNew to 0
37039>>>>>>>                End
37039>>>>>>>>
37039>>>>>>>            End
37039>>>>>>>>
37039>>>>>>>        End
37039>>>>>>>>
37039>>>>>>>
37039>>>>>>>     
37039>>>>>>>    End_Procedure   // Update
37040>>>>>>>
37040>>>>>>>
37040>>>>>>>    Procedure Creating
37041>>>>>>>        date ddate iYes
37042>>>>>>>        Forward Send Creating
37044>>>>>>>        // Insert Code Here
37044>>>>>>>
37044>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Clients.Client_Rec0))))));                                    to Clients.Client_Recr
37045>>>>>>>        Move '1'                    to Clients.Client_Active
37046>>>>>>>        get fsgCode_With_Zeroes Clients.Client_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Clients.Client_ID
37047>>>>>>>        sysdate4 ddate
37048>>>>>>>        move ddate                  to Clients.Client_Hmnia    
37049>>>>>>>        Set piCreateNew to 1
37050>>>>>>>    End_Procedure   // Creating
37051>>>>>>>
37051>>>>>>>    Function Validate_Save  Returns Integer
37052>>>>>>>        Integer iReturnVal iCheck iYes
37053>>>>>>>        Forward Get Validate_Save  To iReturnVal
37055>>>>>>>        If (Not(iReturnVal)) Begin
37057>>>>>>>
37057>>>>>>>            If (clients.is_eksoter <> '1') begin
37059>>>>>>>                If (Clients.Is_Xondr='1') Begin
37061>>>>>>>                    If (Sysfile.Check_Afm=1) Begin
37063>>>>>>>                        Move (Check_AFM(Clients.Client_Afm)) to iCheck
37064>>>>>>>                        If (iCheck) Begin
37066>>>>>>>                                 If (iCheck=1) Move 4001 to iReturnVal
37069>>>>>>>                            Else If (iCheck=2) Move 4002 to iReturnVal
37073>>>>>>>                            Else If (iCheck=3) Move 4003 to iReturnVal
37077>>>>>>>                        End
37077>>>>>>>>
37077>>>>>>>                    End
37077>>>>>>>>
37077>>>>>>>                End
37077>>>>>>>>
37077>>>>>>>            End
37077>>>>>>>>
37077>>>>>>>
37077>>>>>>>            If (piCheckPlaf(Self)=1) Begin
37079>>>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Dap)>Clients.Plafon)) Begin
37081>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4000 Clients' to iYes
37082>>>>>>>                    If (iYes=MBR_NO) Error 4004 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž' //Move 4004 to iReturnVal
37085>>>>>>>                End
37085>>>>>>>>
37085>>>>>>>                Else If ((PayResp.Plafon<>0) And (PayResp.Plafon<=PayResp.Synolikh_Ofeilh)) Begin
37088>>>>>>>                    Get YesNo_Box 'Ž ¬§œçŸ¬¤¦ª §¢ž¨à£ãª ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž\nŒ˜ ©¬¤œ®å©à ©«ž¤ ›ž£ ¦¬¨šå˜ œšš¨˜­ãª §œ¢á«ž;' to iYes
37089>>>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
37092>>>>>>>                End
37092>>>>>>>>
37092>>>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Clients.Orio_Syn_Ofeilh)) Begin
37095>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4001 Clients' to iYes
37096>>>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
37099>>>>>>>                End
37099>>>>>>>>
37099>>>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (PayResp.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Payresp.Orio_Syn_Ofeilh)) Begin
37102>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4002 Clients' to iYes
37103>>>>>>>                    If (iYes=MBR_NO) Error 4006 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'   //Move 4006 to iReturnVal
37106>>>>>>>                End
37106>>>>>>>>
37106>>>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Parag)>Clients.Plafon)) Begin
37108>>>>>>>                    Send Info_Box '’˜ §¦©á «à¤ ž£œ¨ž©åà¤ §˜¨˜ššœ¢ é¤\n¬§œ¨™˜å¤¦¬¤ «¦ › ˜Ÿâ© £¦ ¬§æ¢¦ §¦\n™á©ž §¢˜­æ¤ «¦¬ §œ¢á«ž' '¨¦©¦®ã !!!'
37109>>>>>>>                End
37109>>>>>>>>
37109>>>>>>>            End
37109>>>>>>>>
37109>>>>>>>
37109>>>>>>>            If (iReturnVal) Begin
37111>>>>>>>                Send Operation_Not_Allowed iReturnVal
37112>>>>>>>            End
37112>>>>>>>>
37112>>>>>>>        End
37112>>>>>>>>
37112>>>>>>>        Function_Return iReturnVal
37113>>>>>>>    End_Function   // Validate_Save
37114>>>>>>>
37114>>>>>>>
37114>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
37115>>>>>>>        String lsError_Message
37116>>>>>>>
37116>>>>>>>        Case Begin
37116>>>>>>>            Case (iError_Num = 4001)
37118>>>>>>>                Move "DDC 100: Š˜¤Ÿ˜©£â¤¦ €”‹ œ¢á«ž" ;                    to lsError_Message
37119>>>>>>>              Case Break
37120>>>>>>>            Case (iError_Num = 4002)
37123>>>>>>>                Move "DDC 100: ’¦ €”‹ œ¢á«ž ›œ¤ œå¤˜  9 ¯ã­ ¦" ;                    to lsError_Message
37124>>>>>>>              Case Break
37125>>>>>>>            Case (iError_Num = 4003)
37128>>>>>>>                Move "DDC 100: €¡˜«á¢¢ž¢¦ª ®˜¨˜¡«ã¨˜ª ©«¦ €”‹ œ¢á«ž" ;                    to lsError_Message
37129>>>>>>>              Case Break
37130>>>>>>>            Case (iError_Num = 4004)
37133>>>>>>>                Move "DDC 100: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ §œ¢á«ž" ;                    to lsError_Message
37134>>>>>>>              Case Break
37135>>>>>>>            Case (iError_Num = 4005)
37138>>>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª" ;                    to lsError_Message
37139>>>>>>>              Case Break
37140>>>>>>>            Case (iError_Num = 4006)
37143>>>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª «¦¬ “§œ¬Ÿç¤¦¬" ;                    to lsError_Message
37144>>>>>>>              Case Break
37145>>>>>>>
37145>>>>>>>            Case Else
37145>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
37147>>>>>>>        Case End
37147>>>>>>>
37147>>>>>>>        Error iError_Num lsError_Message
37148>>>>>>>>
37148>>>>>>>    End_Procedure // operation_not_allowed
37149>>>>>>>
37149>>>>>>>
37149>>>>>>>    // Define_Fields:
37149>>>>>>>    // This procedure is used to set up all data-dictionary rules.
37149>>>>>>>
37149>>>>>>>    Procedure Define_Fields
37150>>>>>>>        Forward Send Define_Fields
37152>>>>>>>        //DDB-Generated-Code-Location
37152>>>>>>>        //DDB-DefineFieldStart
37152>>>>>>>
37152>>>>>>>        Set Main_File            To Clients.File_Number
37153>>>>>>>        Set Cascade_Delete_State To FALSE
37154>>>>>>>
37154>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
37155>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
37156>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
37157>>>>>>>
37157>>>>>>>        // Child (Client) file structure................
37157>>>>>>>        Send Add_Client_File  Cmoves.File_Number
37158>>>>>>>        Send Add_Client_File  Particle.File_Number
37159>>>>>>>        Send Add_Client_File  Cmovesa.File_Number
37160>>>>>>>        Send Add_Client_File  Cn.File_Number
37161>>>>>>>        Send Add_Client_File  Particll.File_Number
37162>>>>>>>        Send Add_Client_File  Clnbank.File_Number
37163>>>>>>>        Send Add_Client_File  Tpclient.File_Number
37164>>>>>>>        Send Add_Client_File  Clorder.File_Number
37165>>>>>>>        Send Add_Client_File  Clitem.File_Number
37166>>>>>>>
37166>>>>>>>        // Parent (Server) file structure...............
37166>>>>>>>        Send Add_Server_File  Cities.File_Number
37167>>>>>>>        Send Add_Server_File  Areas.File_Number
37168>>>>>>>        Send Add_Server_File  Payresp.File_Number
37169>>>>>>>
37169>>>>>>>        // External (System) file structure.............
37169>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
37170>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
37171>>>>>>>        Send Add_System_File  Ptypparl.File_Number  DD_LOCK_ON_ALL
37172>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
37173>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
37174>>>>>>>
37174>>>>>>>        Define_Auto_Increment  Sysrecc.Client_Rec0  To Clients.Client_Rec0
37177>>>>>>>
37177>>>>>>>        // Field-based properties.......................
37177>>>>>>>
37177>>>>>>>        // Clients.Company_Code
37177>>>>>>>
37177>>>>>>>        // Clients.Branch_Code
37177>>>>>>>
37177>>>>>>>        // Clients.Year_Year
37177>>>>>>>
37177>>>>>>>        // Clients.Custprom_Code
37177>>>>>>>
37177>>>>>>>        // Clients.Client_Id
37177>>>>>>>        Set Field_Options          Field Clients.Client_Id To DD_AUTOFIND    DD_NOPUT      
37178>>>>>>>        Set Field_Prompt_Object    Field Clients.Client_Id To (sl100(Self))
37179>>>>>>>        Set Key_Field_State        Field Clients.Client_Id To TRUE
37180>>>>>>>
37180>>>>>>>        // Clients.Client_Name
37180>>>>>>>        Set Field_Prompt_Object    Field Clients.Client_Name To (sl100(Self))
37181>>>>>>>
37181>>>>>>>        // Clients.Client_Afm
37181>>>>>>>        Set Field_Options          Field Clients.Client_Afm To DD_AUTOFIND   
37182>>>>>>>
37182>>>>>>>        // Clients.Client_Rec0
37182>>>>>>>        Set Field_Options          Field Clients.Client_Rec0 To DD_AUTOFIND   
37183>>>>>>>
37183>>>>>>>        // Clients.Custprom_Recr
37183>>>>>>>
37183>>>>>>>        // Clients.Client_Recr
37183>>>>>>>        Set Field_Options          Field Clients.Client_Recr To DD_AUTOFIND   
37184>>>>>>>
37184>>>>>>>        // Clients.Last_Xreosh
37184>>>>>>>
37184>>>>>>>        // Clients.Last_Pistosh
37184>>>>>>>
37184>>>>>>>        // Clients.Last_Order
37184>>>>>>>        Set Field_Class_Name       Field Clients.Last_Order To "dbComboFormSub"
37185>>>>>>>
37185>>>>>>>        // Clients.Client_Doy
37185>>>>>>>        Set Field_Value_Table      Field Clients.Client_Doy To (Clients_Client_Doy_VT(Self))
37186>>>>>>>
37186>>>>>>>        // Clients.Client_Address
37186>>>>>>>
37186>>>>>>>        // Clients.Client_City_Id
37186>>>>>>>
37186>>>>>>>        // Clients.Client_Area
37186>>>>>>>
37186>>>>>>>        // Clients.Client_Job
37186>>>>>>>        Set Field_Value_Table      Field Clients.Client_Job To (Clients_Client_Job_VT(Self))
37187>>>>>>>
37187>>>>>>>        // Clients.Client_Respons
37187>>>>>>>
37187>>>>>>>        // Clients.Client_Zipcode
37187>>>>>>>
37187>>>>>>>        // Clients.Client_Phone
37187>>>>>>>
37187>>>>>>>        // Clients.Client_Fax
37187>>>>>>>
37187>>>>>>>        // Clients.Client_Mobile
37187>>>>>>>
37187>>>>>>>        // Clients.Client_Aoh
37187>>>>>>>
37187>>>>>>>        // Clients.Client_Email
37187>>>>>>>
37187>>>>>>>        // Clients.Client_Class
37187>>>>>>>
37187>>>>>>>        // Clients.Client_Details
37187>>>>>>>
37187>>>>>>>        // Clients.Client_Sitew
37187>>>>>>>
37187>>>>>>>        // Clients.Client_Codem
37187>>>>>>>
37187>>>>>>>        // Clients.Client_Categfpa
37187>>>>>>>        Set Field_Value_Table      Field Clients.Client_Categfpa To (Clients_Client_Categfpa_VT(Self))
37188>>>>>>>
37188>>>>>>>        // Clients.Client_Fpa
37188>>>>>>>
37188>>>>>>>        // Clients.Client_Public
37188>>>>>>>
37188>>>>>>>        // Clients.Client_Sn
37188>>>>>>>
37188>>>>>>>        // Clients.Client_Repm
37188>>>>>>>
37188>>>>>>>        // Clients.Client_Active
37188>>>>>>>
37188>>>>>>>        // Clients.Client_Reported
37188>>>>>>>
37188>>>>>>>        // Clients.Client_Pelprom
37188>>>>>>>
37188>>>>>>>        // Clients.Client_Lastupd
37188>>>>>>>
37188>>>>>>>        // Clients.Client_Markexp
37188>>>>>>>
37188>>>>>>>        // Clients.Client_Catjob
37188>>>>>>>        Set Field_Value_Table      Field Clients.Client_Catjob To (Clients_Client_Catjob_VT1(Self))
37189>>>>>>>
37189>>>>>>>        // Clients.Is_Promhtheyths
37189>>>>>>>
37189>>>>>>>        // Clients.Xreosh
37189>>>>>>>
37189>>>>>>>        // Clients.Pistosh
37189>>>>>>>
37189>>>>>>>        // Clients.Ypoloipo
37189>>>>>>>
37189>>>>>>>        // Clients.Plafon
37189>>>>>>>
37189>>>>>>>        // Clients.Overhead
37189>>>>>>>
37189>>>>>>>        // Clients.Client_Company
37189>>>>>>>
37189>>>>>>>        // Clients.Client_Repmatch
37189>>>>>>>
37189>>>>>>>        // Clients.Client_Hmnia
37189>>>>>>>
37189>>>>>>>        // Clients.Client_Presp
37189>>>>>>>
37189>>>>>>>        // Clients.Client_Locked
37189>>>>>>>
37189>>>>>>>        // Clients.Synolikh_Ofeilh
37189>>>>>>>
37189>>>>>>>        // Clients.Client_Idiot
37189>>>>>>>        Set Field_Value_Table      Field Clients.Client_Idiot To (Clients_Client_Idiot_VT(Self))
37190>>>>>>>
37190>>>>>>>        // Clients.Client_Add_No
37190>>>>>>>
37190>>>>>>>        // Clients.Client_Nomos
37190>>>>>>>
37190>>>>>>>        // Clients.Client_Xora
37190>>>>>>>
37190>>>>>>>        // Clients.Polh_Recr
37190>>>>>>>
37190>>>>>>>        // Clients.Presp_Id
37190>>>>>>>
37190>>>>>>>        // Clients.Sum_Pct_Tpcl
37190>>>>>>>
37190>>>>>>>        // Clients.Is_Client
37190>>>>>>>
37190>>>>>>>        // Clients.Sysxetish
37190>>>>>>>
37190>>>>>>>        // Clients.Poso_Se_Apait
37190>>>>>>>
37190>>>>>>>        // Clients.Client_Glcode
37190>>>>>>>
37190>>>>>>>        // Clients.Is_Eksoter
37190>>>>>>>
37190>>>>>>>        // Clients.Is_Xondr
37190>>>>>>>
37190>>>>>>>        // Clients.Orio_Syn_Ofeilh
37190>>>>>>>
37190>>>>>>>        // Clients.Posa_Apo_Dap
37190>>>>>>>
37190>>>>>>>        // Clients.Client_Doybtm
37190>>>>>>>
37190>>>>>>>        // Clients.Posa_Apo_Parag
37190>>>>>>>
37190>>>>>>>        // Clients.Client_Ptyppar
37190>>>>>>>
37190>>>>>>>        // Clients.Client_Seira
37190>>>>>>>
37190>>>>>>>        // Clients.Hpso
37190>>>>>>>
37190>>>>>>>        // Clients.Hpal
37190>>>>>>>
37190>>>>>>>        // Clients.Feregios
37190>>>>>>>        Set Field_Value_Table      Field Clients.Feregios To (Clients_Feregios_VT(Self))
37191>>>>>>>
37191>>>>>>>        // Clients.Diakin
37191>>>>>>>
37191>>>>>>>        // Clients.Status
37191>>>>>>>
37191>>>>>>>        // Clients.Anal
37191>>>>>>>
37191>>>>>>>        // Clients.Endoomil
37191>>>>>>>
37191>>>>>>>        // Clients.Npdd
37191>>>>>>>
37191>>>>>>>        // Clients.Sap_Hmnia
37191>>>>>>>
37191>>>>>>>        //DDB-DefineFieldEnd
37191>>>>>>>    End_Procedure    // Define_Fields
37192>>>>>>>
37192>>>>>>>    // Field_Defaults:
37192>>>>>>>    // This procedure is used to establish default field values.
37192>>>>>>>
37192>>>>>>>    Procedure Field_Defaults
37193>>>>>>>        Forward Send Field_Defaults
37195>>>>>>>        //DDB-Generated-Code-Location
37195>>>>>>>        //DDB-FieldDefaultStart
37195>>>>>>>        Set Field_Changed_Value   Field Clients.Client_Doy To "0"
37196>>>>>>>        //DDB-FieldDefaultEnd
37196>>>>>>>    End_Procedure    // Field_Defaults
37197>>>>>>>
37197>>>>>>>End_Class    // Clients_DataDictionary
37198>>>>>>>//DDB-Selection-pkg-Start
37198>>>>>>>
37198>>>>>>>Use sl100.SL         // sl100
INCLUDING FILE: SL100.SL
37198>>>>>>>>>//AB/ Project SL100:PELATES
37198>>>>>>>>>//AB/     Object prj is a Lookup_Project
37198>>>>>>>>>//AB/         Set ProjectName to "SL100:PELATES"
37198>>>>>>>>>//AB/         Set ProjectFileName to "SL100.SL"
37198>>>>>>>>>
37198>>>>>>>>>// Project Object Structure
37198>>>>>>>>>//   sl100 is a dbModalPanelSub
37198>>>>>>>>>//     Clients_DD is a DataDictionary
37198>>>>>>>>>//     oSelList is a dbListSub
37198>>>>>>>>>//     oOK_bn is a ButtonSub
37198>>>>>>>>>//     oCancel_bn is a ButtonSub
37198>>>>>>>>>//     oSearch_bn is a ButtonSub
37198>>>>>>>>>
37198>>>>>>>>>// Register all objects
37198>>>>>>>>>Register_Object Clients_DD
37198>>>>>>>>>Register_Object oCancel_bn
37198>>>>>>>>>Register_Object oOK_bn
37198>>>>>>>>>Register_Object oSearch_bn
37198>>>>>>>>>Register_Object oSelList
37198>>>>>>>>>Register_Object sl100
37198>>>>>>>>>
37198>>>>>>>>>
37198>>>>>>>>>    //AB-IgnoreStart
37198>>>>>>>>>
37198>>>>>>>>>    Use DFAllEnt.pkg
37198>>>>>>>>>    Use dbList.Sub
37198>>>>>>>>>    Use Button.Sub
37198>>>>>>>>>
37198>>>>>>>>>
37198>>>>>>>>>    Use CLIENTS.DD
37198>>>>>>>>>    
37198>>>>>>>>>    //AB-IgnoreEnd
37198>>>>>>>>>
37198>>>>>>>>>    Object sl100 is a dbModalPanelSub
37200>>>>>>>>>
37200>>>>>>>>>        //AB-StoreTopStart
37200>>>>>>>>>                
37200>>>>>>>>>        Property String     FragmaClient        Public ''
37202>>>>>>>>>        Property String     psIsPromhtheyths    Public ''
37204>>>>>>>>>        Property Integer    piMustConstrain     Public  0
37206>>>>>>>>>        Property String     psModule            Public ''
37208>>>>>>>>>        
37208>>>>>>>>>        //AB-StoreTopEnd
37208>>>>>>>>>
37208>>>>>>>>>        Set Label to "(Xlate(Label(Self)))"
37209>>>>>>>>>        Set Size to 252 509
37210>>>>>>>>>        Set Location to 4 5
37211>>>>>>>>>
37211>>>>>>>>>        //AB-DDOStart
37211>>>>>>>>>
37211>>>>>>>>>        Object Clients_DD is a Clients_DataDictionary
37213>>>>>>>>>
37213>>>>>>>>>            //AB-StoreTopStart
37213>>>>>>>>>                                                        
37213>>>>>>>>>            //AB-StoreTopEnd
37213>>>>>>>>>
37213>>>>>>>>>
37213>>>>>>>>>            //AB-StoreStart
37213>>>>>>>>>                                                        
37213>>>>>>>>>            Begin_Constraints
37215>>>>>>>>>                     If (psModule(Self)='01') BEGIN
37217>>>>>>>>>                        Constrain Clients.is_Client        Eq '1'
37219>>>>>>>>>                     end
37219>>>>>>>>>>
37219>>>>>>>>>                     Else If (psModule(Self)='02') begin
37222>>>>>>>>>                        Constrain Clients.is_Promhtheyths  Eq '1'
37224>>>>>>>>>                     end
37224>>>>>>>>>>
37224>>>>>>>>>            End_Constraints
37227>>>>>>>>>            
37227>>>>>>>>>            
37227>>>>>>>>>            
37227>>>>>>>>>            
37227>>>>>>>>>            
37227>>>>>>>>>            //AB-StoreEnd
37227>>>>>>>>>
37227>>>>>>>>>        End_Object    // Clients_DD
37228>>>>>>>>>
37228>>>>>>>>>        Set Main_DD to (Clients_DD(self))
37229>>>>>>>>>        Set Server to (Clients_DD(self))
37230>>>>>>>>>
37230>>>>>>>>>        //AB-DDOEnd
37230>>>>>>>>>
37230>>>>>>>>>        Object oSelList is a dbListSub
37232>>>>>>>>>            Set Main_File to Clients.File_Number
37233>>>>>>>>>            Set Size to 204 496
37234>>>>>>>>>            Set Location to 7 5
37235>>>>>>>>>            Set Auto_Index_State to FALSE
37236>>>>>>>>>
37236>>>>>>>>>            Begin_Row
37239>>>>>>>>>                Entry_Item Clients.Client_id
37240>>>>>>>>>                Entry_Item Clients.Client_name
37241>>>>>>>>>                Entry_Item Clients.Client_afm
37242>>>>>>>>>                Entry_Item Clients.Last_xreosh
37243>>>>>>>>>                Entry_Item Clients.Last_pistosh
37244>>>>>>>>>                Entry_Item Clients.Client_codem
37245>>>>>>>>>                Entry_Item Clients.Is_client
37246>>>>>>>>>                Entry_Item Clients.Is_promhtheyths
37247>>>>>>>>>            End_Row
37252>>>>>>>>>
37252>>>>>>>>>            Set Form_Width    item 0 to 64
37253>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
37254>>>>>>>>>            
37254>>>>>>>>>            Set Form_Width    item 1 to 133
37255>>>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
37256>>>>>>>>>            
37256>>>>>>>>>            Set Form_Width    item 2 to 62
37257>>>>>>>>>            Set Header_Label  item 2 to "€”‹"
37258>>>>>>>>>            
37258>>>>>>>>>            Set Form_Width    item 3 to 60
37259>>>>>>>>>            Set Header_Label  item 3 to "’œ¢. •¨âà©ž"
37260>>>>>>>>>            
37260>>>>>>>>>            Set Form_Width    item 4 to 60
37261>>>>>>>>>            Set Header_Label  item 4 to "’œ¢. å©«à©ž"
37262>>>>>>>>>            
37262>>>>>>>>>            Set Form_Width    item 5 to 59
37263>>>>>>>>>            Set Header_Label  item 5 to "‰à›.‘ç¤›œ©žª"
37264>>>>>>>>>            
37264>>>>>>>>>            Set Form_Width    item 6 to 26
37265>>>>>>>>>            Set Header_Label  item 6 to "œ¢"
37266>>>>>>>>>            Set Column_Checkbox_State  item 6 to True
37267>>>>>>>>>            
37267>>>>>>>>>            Set Form_Width    item 7 to 26
37268>>>>>>>>>            Set Header_Label  item 7 to "¨¦£"
37269>>>>>>>>>            Set Column_Checkbox_State  item 7 to True
37270>>>>>>>>>            
37270>>>>>>>>>
37270>>>>>>>>>            //AB-StoreStart
37270>>>>>>>>>                                                                                
37270>>>>>>>>>            //Property String StoreFragmaClient   Public ''
37270>>>>>>>>>            //Property String StorePsModule       Public ''
37270>>>>>>>>>            
37270>>>>>>>>>            //Procedure Store_Defaults
37270>>>>>>>>>            //    Forward Send Store_Defaults
37270>>>>>>>>>            //    Set StoreFragmaClient   to (FragmaClient(Self))
37270>>>>>>>>>            //    Set StorePsModule       to (psModule    (Self))
37270>>>>>>>>>            //End_Procedure
37270>>>>>>>>>            
37270>>>>>>>>>            //Procedure ReStore_Defaults
37270>>>>>>>>>            //    Forward Send ReStore_Defaults
37270>>>>>>>>>            //    Set FragmaClient to (StoreFragmaClient(Self))
37270>>>>>>>>>            //    Set psModule     to (StorePsModule    (Self))
37270>>>>>>>>>            //End_Procedure
37270>>>>>>>>>            
37270>>>>>>>>>            Set Column_Option Item 6 to NoEnter True
37271>>>>>>>>>            Set Column_Option Item 7 to NoEnter True
37272>>>>>>>>>            
37272>>>>>>>>>            Procedure Activating
37274>>>>>>>>>                Forward Send Activating
37276>>>>>>>>>                Set Auto_Index_State to True
37277>>>>>>>>>            End_Procedure
37278>>>>>>>>>            
37278>>>>>>>>>            Procedure Activate
37280>>>>>>>>>                Send Rebuild_Constraints    to Clients_DD
37281>>>>>>>>>                If (FragmaClient(Self)<>'') Begin
37283>>>>>>>>>                    Clear Clients
37284>>>>>>>>>                    Move (FragmaClient(Self)) to Clients.Client_ID
37285>>>>>>>>>                    Find Eq Clients By Index.6
37286>>>>>>>>>>
37286>>>>>>>>>                    If (Found) Send Request_Find to Clients_DD Eq Clients.File_Number 6
37289>>>>>>>>>                End
37289>>>>>>>>>>
37289>>>>>>>>>                Forward Send Activate
37291>>>>>>>>>            End_procedure
37292>>>>>>>>>            
37292>>>>>>>>>            
37292>>>>>>>>>            
37292>>>>>>>>>            
37292>>>>>>>>>            //AB-StoreEnd
37292>>>>>>>>>
37292>>>>>>>>>        End_Object    // oSelList
37293>>>>>>>>>
37293>>>>>>>>>        Object oOK_bn is a ButtonSub
37295>>>>>>>>>            Set Label to "&„§ ¢¦šã"
37296>>>>>>>>>            Set Location to 218 341
37297>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
37298>>>>>>>>>
37298>>>>>>>>>            //AB-StoreStart
37298>>>>>>>>>            Procedure OnClick
37300>>>>>>>>>                Send OK To (oSelList(current_object))
37301>>>>>>>>>            End_Procedure
37302>>>>>>>>>            //AB-StoreEnd
37302>>>>>>>>>
37302>>>>>>>>>        End_Object    // oOK_bn
37303>>>>>>>>>
37303>>>>>>>>>        Object oCancel_bn is a ButtonSub
37305>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
37306>>>>>>>>>            Set Location to 218 396
37307>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
37308>>>>>>>>>
37308>>>>>>>>>            //AB-StoreStart
37308>>>>>>>>>            Procedure OnClick
37310>>>>>>>>>                Send Cancel To (oSelList(current_object))
37311>>>>>>>>>            End_Procedure
37312>>>>>>>>>            //AB-StoreEnd
37312>>>>>>>>>
37312>>>>>>>>>        End_Object    // oCancel_bn
37313>>>>>>>>>
37313>>>>>>>>>        Object oSearch_bn is a ButtonSub
37315>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
37316>>>>>>>>>            Set Location to 218 451
37317>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
37318>>>>>>>>>
37318>>>>>>>>>            //AB-StoreStart
37318>>>>>>>>>            Procedure OnClick
37320>>>>>>>>>                Send Search To (oSelList(current_object))
37321>>>>>>>>>            End_Procedure
37322>>>>>>>>>            //AB-StoreEnd
37322>>>>>>>>>
37322>>>>>>>>>        End_Object    // oSearch_bn
37323>>>>>>>>>
37323>>>>>>>>>
37323>>>>>>>>>        //AB-StoreStart
37323>>>>>>>>>                
37323>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
37324>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
37325>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
37326>>>>>>>>>        
37326>>>>>>>>>        Set Modal_State to True
37327>>>>>>>>>        Set Locate_Mode to Center_On_Screen
37328>>>>>>>>>        
37328>>>>>>>>>        
37328>>>>>>>>>        Procedure Activating Returns Integer
37330>>>>>>>>>            Integer rVal
37331>>>>>>>>>            Forward Get Msg_Activating to rVal
37333>>>>>>>>>                 if (psmodule(self)='01') set label of sl100 to '‰˜«á¢¦š¦ª œ¢˜«é¤'
37336>>>>>>>>>            else if (psmodule(self)='02') set label of sl100 to '‰˜«á¢¦š¦ª ¨¦£žŸœ¬«é¤'
37340>>>>>>>>>            Procedure_Return rVal
37341>>>>>>>>>        End_procedure
37342>>>>>>>>>        
37342>>>>>>>>>        
37342>>>>>>>>>        
37342>>>>>>>>>        
37342>>>>>>>>>        
37342>>>>>>>>>        
37342>>>>>>>>>        
37342>>>>>>>>>        
37342>>>>>>>>>        
37342>>>>>>>>>        //AB-StoreEnd
37342>>>>>>>>>
37342>>>>>>>>>    End_Object    // sl100
37343>>>>>>>>>
37343>>>>>>>>>//AB/     End_Object    // prj
37343>>>>>>>
37343>>>>>>>//DDB-Selection-pkg-End
37343>>>>>>>//DDB-FileEnd
37343>>>>>Use CMOVES.DD
INCLUDING FILE: CMOVES.DD
37343>>>>>>>//DDB-FileStart
37343>>>>>>>//DDB-HeaderStart
37343>>>>>>>
37343>>>>>>>// File Name : CMOVES.DD
37343>>>>>>>// Class Name: Cmoves_DataDictionary
37343>>>>>>>// Revision  : 149
37343>>>>>>>// Version   : 2
37343>>>>>>>
37343>>>>>>>Use  Windows           // Basic Definitions
37343>>>>>>>Use  DataDict          // DataDictionary Class Definition
37343>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37343>>>>>>>
37343>>>>>>>Open Cmoves
37345>>>>>>>Open Copen
INCLUDING FILE: COPEN.FD
37347>>>>>>>Open Ctypkin
37349>>>>>>>Open Clients
37351>>>>>>>Open Sysrecc
37353>>>>>>>Open Syscurxr
37355>>>>>>>
37355>>>>>>>//DDB-HeaderEnd
37355>>>>>>>//DDB-SelectionStart
37355>>>>>>>//DDB/ ExternalSelectionList sl006  sl006.SL
37355>>>>>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
37355>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
37355>>>>>>>Register_Object sl006
37355>>>>>>>Register_Object slNomism
37355>>>>>>>Register_Object sl041
37355>>>>>>>//DDB-SelectionEnd
37355>>>>>>> 
37355>>>>>>>Use Payresp.DD
INCLUDING FILE: PAYRESP.DD
37355>>>>>>>>>//DDB-FileStart
37355>>>>>>>>>//DDB-HeaderStart
37355>>>>>>>>>
37355>>>>>>>>>// File Name : PAYRESP.DD
37355>>>>>>>>>// Class Name: Payresp_DataDictionary
37355>>>>>>>>>// Revision  : 82
37355>>>>>>>>>// Version   : 2
37355>>>>>>>>>
37355>>>>>>>>>Use  Windows           // Basic Definitions
37355>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
37355>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37355>>>>>>>>>
37355>>>>>>>>>Open Payresp
37357>>>>>>>>>Open Prspbank
INCLUDING FILE: PRSPBANK.FD
37359>>>>>>>>>Open Tppresp
INCLUDING FILE: TPPRESP.FD
37361>>>>>>>>>Open Clients
37363>>>>>>>>>Open Sysrecc
37365>>>>>>>>>Open Gmove
37367>>>>>>>>>Open Sysrecg
37369>>>>>>>>>
37369>>>>>>>>>//DDB-HeaderEnd
37369>>>>>>>>>//DDB-ValidationStart
37369>>>>>>>>>
37369>>>>>>>>>Register_Object Payresp_Presp_Doy_VT
37369>>>>>>>>>Register_Object Payresp_Presp_Categfpa_VT
37369>>>>>>>>>Register_Object Payresp_Feregios_VT
37369>>>>>>>>>
37369>>>>>>>>>Object Payresp_Presp_Doy_VT  is a CodeValidationTable
37371>>>>>>>>>    Set Type_Value        To "DOY"
37372>>>>>>>>>    Set Allow_Blank_State To TRUE
37373>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
37374>>>>>>>>>    //DDB-ValidationCustomStart
37374>>>>>>>>>    //DDB-ValidationCustomEnd
37374>>>>>>>>>End_Object   // Payresp_Presp_Doy_VT
37375>>>>>>>>>
37375>>>>>>>>>Object Payresp_Presp_Categfpa_VT  is a CodeValidationTable
37377>>>>>>>>>    Set Type_Value        To "VAT_STATUS"
37378>>>>>>>>>    Set Validate_State    To FALSE
37379>>>>>>>>>    Set Allow_Blank_State To TRUE
37380>>>>>>>>>    //DDB-ValidationCustomStart
37380>>>>>>>>>    //DDB-ValidationCustomEnd
37380>>>>>>>>>End_Object   // Payresp_Presp_Categfpa_VT
37381>>>>>>>>>
37381>>>>>>>>>Object Payresp_Feregios_VT  is a CodeValidationTable
37383>>>>>>>>>    Set Type_Value        To "FEREGIOS"
37384>>>>>>>>>    Set Allow_Blank_State To TRUE
37385>>>>>>>>>    Set Table_Title       To "ƒœå¡«œª ”œ¨œšš¬æ«ž«˜ª ”¦¨âà¤"
37386>>>>>>>>>    //DDB-ValidationCustomStart
37386>>>>>>>>>    //DDB-ValidationCustomEnd
37386>>>>>>>>>End_Object   // Payresp_Feregios_VT
37387>>>>>>>>>//DDB-ValidationEnd
37387>>>>>>>>>//DDB-SelectionStart
37387>>>>>>>>>//DDB/ ExternalSelectionList sl111  sl111.SL
37387>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
37387>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
37387>>>>>>>>>Register_Object sl111
37387>>>>>>>>>Register_Object sl198
37387>>>>>>>>>Register_Object sl197
37387>>>>>>>>>//DDB-SelectionEnd
37387>>>>>>>>>
37387>>>>>>>>>Open Year
37389>>>>>>>>>
37389>>>>>>>>>Class Payresp_DataDictionary  is a DataDictionary_Sec
37390>>>>>>>>>
37390>>>>>>>>>    Procedure Construct_Object
37391>>>>>>>>>        Forward Send Construct_Object
37393>>>>>>>>>        Property Integer piCheckPlaf        Public 0
37394>>>>>>>>>        //------------------------------------------------
37394>>>>>>>>>        // Properties gia na kraththoun oi palies times
37394>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio
37394>>>>>>>>>        // einai 1     js 03/12/2007
37394>>>>>>>>>        //------------------------------------------------
37394>>>>>>>>>        Property Integer piCreateNew            Public  0
37395>>>>>>>>>        Property String  psAud_Old_Pelaths      Public ""
37396>>>>>>>>>        Property String  psAud_Old_PelathsN     Public ""
37397>>>>>>>>>        Property String  psAud_Old_AFM          Public ""
37398>>>>>>>>>        Property String  psAud_Old_DOY          Public ""
37399>>>>>>>>>        Property String  psAud_Old_DOYN         Public ""
37400>>>>>>>>>        Property Integer piAud_Old_HPAL         Public  0
37401>>>>>>>>>        Property Integer piAud_Old_HPSO         Public  0
37402>>>>>>>>>        Property String  psAud_Old_PartlRecr    Public ""
37403>>>>>>>>>        Property String  psAud_Old_PmsRecr      Public ""
37404>>>>>>>>>        //------------------------------------------------
37404>>>>>>>>>
37404>>>>>>>>>    End_procedure
37405>>>>>>>>>
37405>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
37406>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
37408>>>>>>>>>        //------------------------------------------------
37408>>>>>>>>>        // Properties gia na kraththoun oi palies times
37408>>>>>>>>>        // ton pedion js 03/12/2007
37408>>>>>>>>>        //------------------------------------------------
37408>>>>>>>>>        Set psAud_Old_Pelaths      to Payresp.Presp_ID
37409>>>>>>>>>        Set psAud_Old_PelathsN     to Payresp.Presp_Name
37410>>>>>>>>>        Set psAud_Old_AFM          to Payresp.Presp_AFM
37411>>>>>>>>>        Set psAud_Old_DOY          to Payresp.Presp_Doy
37412>>>>>>>>>        Set psAud_Old_DOYN         to (gsfCode_Mast("DOY",Payresp.Presp_Doy))
37413>>>>>>>>>        Set piAud_Old_HPAL         to Payresp.Stoxos_IPAL
37414>>>>>>>>>        Set piAud_Old_HPSO         to Payresp.Stoxos_IPSO
37415>>>>>>>>>        Set psAud_Old_PartlRecr    to Payresp.Presp_Recr
37416>>>>>>>>>        Set psAud_Old_PmsRecr      to Payresp.Presp_Recr
37417>>>>>>>>>        //------------------------------------------------
37417>>>>>>>>>     End_Procedure   // New_Current_Record
37418>>>>>>>>>
37418>>>>>>>>>    Procedure Delete_Main_File
37419>>>>>>>>>        //---------------------------------------------
37419>>>>>>>>>        // Auditing / Katagrafh allagon
37419>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
37420>>>>>>>>>        Date    dDate  Shmer
37420>>>>>>>>>        Integer iMin iHour iSec iLen
37420>>>>>>>>>        Sysdate dDate iHour iMin iSec
37424>>>>>>>>>        Move iHour  to sHour
37425>>>>>>>>>        Move iMin   to sMin
37426>>>>>>>>>        Move iSec   to sSec
37427>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
37431>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
37435>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
37439>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
37440>>>>>>>>>
37440>>>>>>>>>        // Auditing / Diagrafh
37440>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
37442>>>>>>>>>            Get fsLoginUserID to sUser
37443>>>>>>>>>            clear gmove
37444>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
37445>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
37446>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
37447>>>>>>>>>            move  3                     to gmove.gtypkin_code// Apo Clients
37448>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
37449>>>>>>>>>            move suser                  to gmove.gplan_code
37450>>>>>>>>>            move Payresp.Presp_Recr    to gmove.garticl_recr
37451>>>>>>>>>            reread sysrecg
37455>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
37456>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
37457>>>>>>>>>            saverecord sysrecg
37458>>>>>>>>>            unlock
37459>>>>>>>>>>
37459>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
37460>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
37461>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs
37462>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
37463>>>>>>>>>
37463>>>>>>>>>            Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
37464>>>>>>>>>            Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
37465>>>>>>>>>            Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
37466>>>>>>>>>            Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy
37467>>>>>>>>>            Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
37468>>>>>>>>>            Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
37469>>>>>>>>>            Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
37470>>>>>>>>>
37470>>>>>>>>>
37470>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª “§œ¬Ÿç¤¦¬ ¢ž¨à£é¤"     to gmove.gmove_aitiol
37471>>>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
37472>>>>>>>>>            saverecord gmove
37473>>>>>>>>>        End
37473>>>>>>>>>>
37473>>>>>>>>>        Forward Send Delete_Main_File
37475>>>>>>>>>
37475>>>>>>>>>    End_Procedure
37476>>>>>>>>>
37476>>>>>>>>>    Procedure Update
37477>>>>>>>>>        Forward Send Update
37479>>>>>>>>>        Move SysCurXR.Company_Code  to payresp.Company_Code
37480>>>>>>>>>        Move SysCurXR.Branch_Code   to payresp.Branch_Code
37481>>>>>>>>>        Move SysCurXR.Year_Year     to payresp.Year_Year
37482>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
37482>>>>>>>>>        Move (payresp.Xreosh-payresp.Pistosh)   to payresp.Ypoloipo
37483>>>>>>>>>        Move (payresp.Plafon-payresp.ypoloipo)  to payresp.Overhead
37484>>>>>>>>>
37484>>>>>>>>>        //betolink
37484>>>>>>>>>        Move SysCurXR.Beto_Site      to payresp.presp_SiteW
37485>>>>>>>>>        Move payresp.presp_Rec0      to payresp.presp_SN
37486>>>>>>>>>        Move payresp.presp_id        to payresp.presp_Repm
37487>>>>>>>>>
37487>>>>>>>>>        //---------------------------------------------
37487>>>>>>>>>        // Auditing / Katagrafh allagon
37487>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
37488>>>>>>>>>        Date    dDate  Shmer
37488>>>>>>>>>        Integer iMin iHour iSec iLen
37488>>>>>>>>>        Sysdate dDate iHour iMin iSec
37492>>>>>>>>>        Move iHour  to sHour
37493>>>>>>>>>        Move iMin   to sMin
37494>>>>>>>>>        Move iSec   to sSec
37495>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
37499>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
37503>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
37507>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
37508>>>>>>>>>
37508>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
37508>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
37510>>>>>>>>>            Get fsLoginUserID to sUser
37511>>>>>>>>>            If (piCreateNew(Self)=1) Begin
37513>>>>>>>>>                clear gmove
37514>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
37515>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
37516>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
37517>>>>>>>>>                move  3                     to gmove.gtypkin_code// Apo Clients
37518>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
37519>>>>>>>>>                move suser                  to gmove.gplan_code
37520>>>>>>>>>                move Payresp.Presp_Recr     to gmove.garticl_recr
37521>>>>>>>>>                reread sysrecg
37525>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
37526>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
37527>>>>>>>>>                saverecord sysrecg
37528>>>>>>>>>                unlock
37529>>>>>>>>>>
37529>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
37530>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
37531>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
37532>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
37533>>>>>>>>>                Move Payresp.Presp_ID               to Gmove.Cur_ID
37534>>>>>>>>>                Move Payresp.Presp_Name             to Gmove.Cur_Name
37535>>>>>>>>>                Move Payresp.Presp_Recr             to Gmove.Partl_Recr 
37536>>>>>>>>>                Move Payresp.Presp_Recr             to Gmove.Pms_Recr          
37537>>>>>>>>>                Move Payresp.Presp_AFM              to Gmove.Cur_AFM
37538>>>>>>>>>                Move Payresp.Presp_DOY              to Gmove.Cur_DOY
37539>>>>>>>>>                Move (gsfCode_Mast("DOY",Payresp.Presp_Doy)) to Gmove.Txt4
37540>>>>>>>>>                Move Payresp.Stoxos_IPAL            to Gmove.Prev_Stoxos1
37541>>>>>>>>>                Move Payresp.Stoxos_IPSO            to Gmove.Prev_Stoxos2
37542>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â¦¬ “§œ¬Ÿç¤¦¬ ¢ž¨à£é¤" to Gmove.Gmove_Aitiol
37543>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs
37544>>>>>>>>>                saverecord gmove
37545>>>>>>>>>                Set piCreateNew to 0
37546>>>>>>>>>            End
37546>>>>>>>>>>
37546>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
37549>>>>>>>>>                Integer isChanged
37549>>>>>>>>>                Move 0 to isChanged
37550>>>>>>>>>                
37550>>>>>>>>>                     If (psAud_Old_Pelaths  (Self)<>Payresp.Presp_ID   ) Move 1 to isChanged
37553>>>>>>>>>                Else If (psAud_Old_PelathsN (Self)<>Payresp.Presp_Name ) Move 1 to isChanged
37557>>>>>>>>>                Else If (psAud_Old_AFM      (Self)<>Payresp.Presp_AFM  ) Move 1 to isChanged
37561>>>>>>>>>                Else If (psAud_Old_DOY      (Self)<>Payresp.Presp_DOY  ) Move 1 to isChanged
37565>>>>>>>>>                Else If (piAud_Old_HPAL     (Self)<>Payresp.Stoxos_IPAL) Move 1 to isChanged
37569>>>>>>>>>                Else If (piAud_Old_HPSO     (Self)<>Payresp.Stoxos_IPSO) Move 1 to isChanged
37573>>>>>>>>>                
37573>>>>>>>>>                If (isChanged>0) Begin  
37575>>>>>>>>>                    clear gmove
37576>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
37577>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
37578>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
37579>>>>>>>>>                    move  3                     to gmove.gtypkin_code// Apo Clients
37580>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
37581>>>>>>>>>                    move suser                  to gmove.gplan_code
37582>>>>>>>>>                    move Payresp.Presp_Recr    to gmove.garticl_recr
37583>>>>>>>>>                    reread sysrecg
37587>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
37588>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
37589>>>>>>>>>                    saverecord sysrecg
37590>>>>>>>>>                    unlock
37591>>>>>>>>>>
37591>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
37592>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
37593>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
37594>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
37595>>>>>>>>>                    Move Payresp.Presp_Recr             to Gmove.Partl_Recr 
37596>>>>>>>>>                    Move Payresp.Presp_Recr             to Gmove.Pms_Recr          
37597>>>>>>>>>                    //--
37597>>>>>>>>>                    Move Payresp.Presp_ID               to Gmove.Cur_ID
37598>>>>>>>>>                    Move Payresp.Presp_Name             to Gmove.Cur_Name
37599>>>>>>>>>                    Move Payresp.Presp_AFM              to Gmove.Cur_AFM
37600>>>>>>>>>                    Move Payresp.Presp_DOY              to Gmove.Cur_DOY
37601>>>>>>>>>                    Move (gsfCode_Mast("DOY",Payresp.Presp_Doy)) to Gmove.Txt4
37602>>>>>>>>>                    Move Payresp.Stoxos_IPAL            to Gmove.Prev_Stoxos1
37603>>>>>>>>>                    Move Payresp.Stoxos_IPSO            to Gmove.Prev_Stoxos2
37604>>>>>>>>>                    //--
37604>>>>>>>>>                    Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
37605>>>>>>>>>                    Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
37606>>>>>>>>>                    Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
37607>>>>>>>>>                    Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy 
37608>>>>>>>>>                    Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
37609>>>>>>>>>                    Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
37610>>>>>>>>>                    Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
37611>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª “§œ¬Ÿç¤¦¬ ¢ž¨à£é¤"  to gmove.gmove_aitiol
37612>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
37613>>>>>>>>>                    saverecord gmove
37614>>>>>>>>>                    Set piCreateNew to 0
37615>>>>>>>>>                End
37615>>>>>>>>>>
37615>>>>>>>>>            End
37615>>>>>>>>>>
37615>>>>>>>>>        End
37615>>>>>>>>>>
37615>>>>>>>>>
37615>>>>>>>>>    End_Procedure   // Update
37616>>>>>>>>>
37616>>>>>>>>>     Procedure Creating
37617>>>>>>>>>        Forward Send Creating
37619>>>>>>>>>        // Insert Code Here
37619>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(payresp.presp_Rec0))))));                                    to payresp.presp_Recr
37620>>>>>>>>>        Move '1'                    to payresp.presp_Active
37621>>>>>>>>>        get fsgCode_With_Zeroes payresp.presp_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to payresp.presp_ID
37622>>>>>>>>>        clear year
37623>>>>>>>>>        move syscurxr.branch_code   to year.branch_code
37624>>>>>>>>>        move syscurxr.company_code  to year.company_code
37625>>>>>>>>>        move syscurxr.year_year     to YEAR.year_year
37626>>>>>>>>>        find eq year by index.1
37627>>>>>>>>>>
37627>>>>>>>>>        if (found=1) begin
37629>>>>>>>>>            move year.payresp_plafon to payresp.plafon
37630>>>>>>>>>            move year.payresp_ofeilh to payresp.orio_syn_ofeilh
37631>>>>>>>>>        end
37631>>>>>>>>>>
37631>>>>>>>>>        Set piCreateNew to 1
37632>>>>>>>>>    End_Procedure   // Creating
37633>>>>>>>>>
37633>>>>>>>>>   Function Validate_Save  Returns Integer
37634>>>>>>>>>        Integer iReturnVal iCheck iYes
37635>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
37637>>>>>>>>>        If (Not(iReturnVal)) Begin
37639>>>>>>>>>
37639>>>>>>>>>            If (Sysfile.Check_Afm=1) Begin
37641>>>>>>>>>                Move (Check_AFM(payresp.presp_Afm)) to iCheck
37642>>>>>>>>>                If (iCheck) Begin
37644>>>>>>>>>                         If (iCheck=1) Move 4001 to iReturnVal
37647>>>>>>>>>                    Else If (iCheck=2) Move 4002 to iReturnVal
37651>>>>>>>>>                    Else If (iCheck=3) Move 4003 to iReturnVal
37655>>>>>>>>>                End
37655>>>>>>>>>>
37655>>>>>>>>>            End
37655>>>>>>>>>>
37655>>>>>>>>>
37655>>>>>>>>>           If (piCheckPlaf(Self)=1) Begin
37657>>>>>>>>>                If ((PayResp.Plafon>0) And ((PayResp.Ypoloipo+PayResp.Posa_Apo_Dap)>PayResp.Plafon)) Begin
37659>>>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 5000 Payresp'  to iYes
37660>>>>>>>>>                        If (iYes=MBR_NO) Error 4004 'DDC111: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4004 to iReturnVal
37663>>>>>>>>>                End
37663>>>>>>>>>>
37663>>>>>>>>>                Else If ((PayResp.Orio_Syn_Ofeilh>0) And (PayResp.Synolikh_Ofeilh>PayResp.Orio_Syn_Ofeilh)) Begin
37666>>>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 5001 Payresp' to iYes
37667>>>>>>>>>                        If (iYes=MBR_NO) Error 4005 'DDC111: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
37670>>>>>>>>>                End
37670>>>>>>>>>>
37670>>>>>>>>>           End
37670>>>>>>>>>>
37670>>>>>>>>>        If (iReturnVal) Send Operation_Not_Allowed iReturnVal
37673>>>>>>>>>        End
37673>>>>>>>>>>
37673>>>>>>>>>        Function_Return iReturnVal
37674>>>>>>>>>    End_Function   // Validate_Save
37675>>>>>>>>>
37675>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
37676>>>>>>>>>        String lsError_Message
37677>>>>>>>>>        Case Begin
37677>>>>>>>>>            Case (iError_Num = 4001)
37679>>>>>>>>>                Move "DDC 100: Š˜¤Ÿ˜©£â¤¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤" to lsError_Message
37680>>>>>>>>>              Case Break
37681>>>>>>>>>            Case (iError_Num = 4002)
37684>>>>>>>>>                Move "DDC 100: ’¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤ ›œ¤ œå¤˜  9 ¯ã­ ¦" to lsError_Message
37685>>>>>>>>>              Case Break
37686>>>>>>>>>            Case (iError_Num = 4003)
37689>>>>>>>>>                Move "DDC 100: €¡˜«á¢¢ž¢¦ª ®˜¨˜¡«ã¨˜ª ©«¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤ " to lsError_Message
37690>>>>>>>>>              Case Break
37691>>>>>>>>>            Case (iError_Num = 4004)
37694>>>>>>>>>                Move "DDC 100: „š ¤œ ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç" to lsError_Message
37695>>>>>>>>>              Case Break
37696>>>>>>>>>            Case (iError_Num = 4005)
37699>>>>>>>>>                Move "DDC 100: „š ¤œ ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª" to lsError_Message
37700>>>>>>>>>              Case Break
37701>>>>>>>>>            Case Else
37701>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
37703>>>>>>>>>        Case End
37703>>>>>>>>>        Error iError_Num lsError_Message
37704>>>>>>>>>>
37704>>>>>>>>>    End_Procedure // operation_not_allowed
37705>>>>>>>>>
37705>>>>>>>>>
37705>>>>>>>>>
37705>>>>>>>>>    Procedure Define_Fields
37706>>>>>>>>>        Forward Send Define_Fields
37708>>>>>>>>>        //DDB-Generated-Code-Location
37708>>>>>>>>>        //DDB-DefineFieldStart
37708>>>>>>>>>
37708>>>>>>>>>        Set Main_File            To Payresp.File_Number
37709>>>>>>>>>        Set Cascade_Delete_State To FALSE
37710>>>>>>>>>
37710>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
37711>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
37712>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
37713>>>>>>>>>
37713>>>>>>>>>        // Child (Client) file structure................
37713>>>>>>>>>        Send Add_Client_File  Prspbank.File_Number
37714>>>>>>>>>        Send Add_Client_File  Tppresp.File_Number
37715>>>>>>>>>        Send Add_Client_File  Clients.File_Number
37716>>>>>>>>>
37716>>>>>>>>>        // External (System) file structure.............
37716>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
37717>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
37718>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
37719>>>>>>>>>
37719>>>>>>>>>        Define_Auto_Increment  Sysrecc.Payresp_Rec0  To Payresp.Presp_Rec0
37722>>>>>>>>>
37722>>>>>>>>>        // Field-based properties.......................
37722>>>>>>>>>
37722>>>>>>>>>        // Payresp.Company_Code
37722>>>>>>>>>
37722>>>>>>>>>        // Payresp.Branch_Code
37722>>>>>>>>>
37722>>>>>>>>>        // Payresp.Year_Year
37722>>>>>>>>>
37722>>>>>>>>>        // Payresp.Custprom_Code
37722>>>>>>>>>
37722>>>>>>>>>        // Payresp.Presp_Id
37722>>>>>>>>>        Set Field_Options          Field Payresp.Presp_Id To DD_AUTOFIND    DD_NOPUT      
37723>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Id To (sl111(Self))
37724>>>>>>>>>        Set Key_Field_State        Field Payresp.Presp_Id To TRUE
37725>>>>>>>>>
37725>>>>>>>>>        // Payresp.Presp_Name
37725>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Name To (sl111(Self))
37726>>>>>>>>>
37726>>>>>>>>>        // Payresp.Presp_Afm
37726>>>>>>>>>
37726>>>>>>>>>        // Payresp.Presp_Rec0
37726>>>>>>>>>
37726>>>>>>>>>        // Payresp.Custprom_Recr
37726>>>>>>>>>
37726>>>>>>>>>        // Payresp.Presp_Recr
37726>>>>>>>>>
37726>>>>>>>>>        // Payresp.Last_Xreosh
37726>>>>>>>>>
37726>>>>>>>>>        // Payresp.Last_Pistosh
37726>>>>>>>>>
37726>>>>>>>>>        // Payresp.Last_Order
37726>>>>>>>>>
37726>>>>>>>>>        // Payresp.Presp_Doy
37726>>>>>>>>>        Set Field_Value_Table      Field Payresp.Presp_Doy To (Payresp_Presp_Doy_VT(Self))
37727>>>>>>>>>
37727>>>>>>>>>        // Payresp.Presp_Address
37727>>>>>>>>>
37727>>>>>>>>>        // Payresp.Presp_City_Id
37727>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_City_Id To (sl198(Self))
37728>>>>>>>>>
37728>>>>>>>>>        // Payresp.Presp_Area
37728>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Area To (sl197(Self))
37729>>>>>>>>>
37729>>>>>>>>>        // Payresp.Presp_Job
37729>>>>>>>>>
37729>>>>>>>>>        // Payresp.Presp_Respons
37729>>>>>>>>>
37729>>>>>>>>>        // Payresp.Presp_Zipcode
37729>>>>>>>>>
37729>>>>>>>>>        // Payresp.Presp_Phone
37729>>>>>>>>>
37729>>>>>>>>>        // Payresp.Presp_Fax
37729>>>>>>>>>
37729>>>>>>>>>        // Payresp.Presp_Mobile
37729>>>>>>>>>
37729>>>>>>>>>        // Payresp.Presp_Aoh
37729>>>>>>>>>
37729>>>>>>>>>        // Payresp.Presp_Email
37729>>>>>>>>>
37729>>>>>>>>>        // Payresp.Presp_Class
37729>>>>>>>>>
37729>>>>>>>>>        // Payresp.Presp_Details
37729>>>>>>>>>
37729>>>>>>>>>        // Payresp.Presp_Sitew
37729>>>>>>>>>
37729>>>>>>>>>        // Payresp.Presp_Codem
37729>>>>>>>>>
37729>>>>>>>>>        // Payresp.Presp_Categfpa
37729>>>>>>>>>        Set Field_Value_Table      Field Payresp.Presp_Categfpa To (Payresp_Presp_Categfpa_VT(Self))
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Presp_Fpa
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Presp_Public
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Presp_Sn
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Presp_Repm
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Presp_Active
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Presp_Reported
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Presp_Pelprom
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Presp_Lastupd
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Presp_Markexp
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Presp_Catjob
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Is_Promhtheyths
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Xreosh
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Pistosh
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Ypoloipo
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Plafon
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Overhead
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Presp_Add_No
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Presp_Nomos
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Presp_Xora
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Polh_Recr
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Synolikh_Ofeilh
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Stoxos_Ipal
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Stoxos_Ipso
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Poso_Se_Apait
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Orio_Syn_Ofeilh
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Posa_Apo_Dap
37730>>>>>>>>>
37730>>>>>>>>>        // Payresp.Feregios
37730>>>>>>>>>        Set Field_Value_Table      Field Payresp.Feregios To (Payresp_Feregios_VT(Self))
37731>>>>>>>>>
37731>>>>>>>>>        //DDB-DefineFieldEnd
37731>>>>>>>>>    End_Procedure    // Define_Fields
37732>>>>>>>>>
37732>>>>>>>>>    // Field_Defaults:
37732>>>>>>>>>    // This procedure is used to establish default field values.
37732>>>>>>>>>
37732>>>>>>>>>    Procedure Field_Defaults
37733>>>>>>>>>        Forward Send Field_Defaults
37735>>>>>>>>>        //DDB-Generated-Code-Location
37735>>>>>>>>>        //DDB-FieldDefaultStart
37735>>>>>>>>>        Set Field_Changed_Value   Field Payresp.Presp_Doy To "0"
37736>>>>>>>>>        //DDB-FieldDefaultEnd
37736>>>>>>>>>    End_Procedure    // Field_Defaults
37737>>>>>>>>>
37737>>>>>>>>>End_Class    // Payresp_DataDictionary
37738>>>>>>>>>//DDB-Selection-pkg-Start
37738>>>>>>>>>
37738>>>>>>>>>Use sl111.SL         // sl111
INCLUDING FILE: SL111.SL
37738>>>>>>>>>>>//AB/ Project sl111
37738>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
37738>>>>>>>>>>>//AB/     Set ProjectName to "sl111"
37738>>>>>>>>>>>//AB/     Set ProjectFileName to "sl111.SL"
37738>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
37738>>>>>>>>>>>
37738>>>>>>>>>>>// Project Object Structure
37738>>>>>>>>>>>//   sl111 is a dbModalPanelSub
37738>>>>>>>>>>>//     Payresp_DD is a DataDictionary
37738>>>>>>>>>>>//     oSelList is a dbListSub
37738>>>>>>>>>>>//     oOK_bn is a ButtonSub
37738>>>>>>>>>>>//     oCancel_bn is a ButtonSub
37738>>>>>>>>>>>//     oSearch_bn is a ButtonSub
37738>>>>>>>>>>>
37738>>>>>>>>>>>// Register all objects
37738>>>>>>>>>>>Register_Object oCancel_bn
37738>>>>>>>>>>>Register_Object oOK_bn
37738>>>>>>>>>>>Register_Object oSearch_bn
37738>>>>>>>>>>>Register_Object oSelList
37738>>>>>>>>>>>Register_Object Payresp_DD
37738>>>>>>>>>>>Register_Object sl111
37738>>>>>>>>>>>
37738>>>>>>>>>>>
37738>>>>>>>>>>>//AB-IgnoreStart
37738>>>>>>>>>>>
37738>>>>>>>>>>>Use DFAllEnt.pkg
37738>>>>>>>>>>>Use dbList.Sub
37738>>>>>>>>>>>Use Button.Sub
37738>>>>>>>>>>>
37738>>>>>>>>>>>
37738>>>>>>>>>>>Use PAYRESP.DD
37738>>>>>>>>>>>
37738>>>>>>>>>>>//AB-IgnoreEnd
37738>>>>>>>>>>>
37738>>>>>>>>>>>Object sl111 is a dbModalPanelSub
37740>>>>>>>>>>>    Set Label to "“§œçŸ¬¤¦  ¢ž¨à£é¤ "
37741>>>>>>>>>>>    Set Size to 148 443
37742>>>>>>>>>>>    Set Location to 4 5
37743>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
37744>>>>>>>>>>>    Set Modal_State to FALSE
37745>>>>>>>>>>>
37745>>>>>>>>>>>    //AB-DDOStart
37745>>>>>>>>>>>
37745>>>>>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
37747>>>>>>>>>>>    End_Object    // Payresp_DD
37748>>>>>>>>>>>
37748>>>>>>>>>>>    Set Main_DD to (Payresp_DD(self))
37749>>>>>>>>>>>    Set Server to (Payresp_DD(self))
37750>>>>>>>>>>>
37750>>>>>>>>>>>    //AB-DDOEnd
37750>>>>>>>>>>>
37750>>>>>>>>>>>    Object oSelList is a dbListSub
37752>>>>>>>>>>>        Set Main_File to Payresp.File_Number
37753>>>>>>>>>>>        Set Size to 105 430
37754>>>>>>>>>>>        Set Location to 6 6
37755>>>>>>>>>>>
37755>>>>>>>>>>>        Begin_Row
37758>>>>>>>>>>>            Entry_Item Payresp.Presp_id
37759>>>>>>>>>>>            Entry_Item Payresp.Presp_name
37760>>>>>>>>>>>            Entry_Item Payresp.Presp_afm
37761>>>>>>>>>>>            Entry_Item Payresp.Presp_address
37762>>>>>>>>>>>            Entry_Item Payresp.Presp_phone
37763>>>>>>>>>>>        End_Row
37768>>>>>>>>>>>
37768>>>>>>>>>>>        Set Form_Width    item 0 to 60
37769>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
37770>>>>>>>>>>>        
37770>>>>>>>>>>>        Set Form_Width    item 1 to 106
37771>>>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
37772>>>>>>>>>>>        
37772>>>>>>>>>>>        Set Form_Width    item 2 to 60
37773>>>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
37774>>>>>>>>>>>        
37774>>>>>>>>>>>        Set Form_Width    item 3 to 135
37775>>>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
37776>>>>>>>>>>>        
37776>>>>>>>>>>>        Set Form_Width    item 4 to 60
37777>>>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
37778>>>>>>>>>>>        
37778>>>>>>>>>>>    End_Object    // oSelList
37779>>>>>>>>>>>
37779>>>>>>>>>>>    Object oOK_bn is a ButtonSub
37781>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
37782>>>>>>>>>>>        Set Location to 113 277
37783>>>>>>>>>>>
37783>>>>>>>>>>>        //AB-StoreStart
37783>>>>>>>>>>>        Procedure OnClick
37785>>>>>>>>>>>            Send OK To (oSelList(current_object))
37786>>>>>>>>>>>        End_Procedure
37787>>>>>>>>>>>        //AB-StoreEnd
37787>>>>>>>>>>>
37787>>>>>>>>>>>    End_Object    // oOK_bn
37788>>>>>>>>>>>
37788>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
37790>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
37791>>>>>>>>>>>        Set Location to 113 332
37792>>>>>>>>>>>
37792>>>>>>>>>>>        //AB-StoreStart
37792>>>>>>>>>>>        Procedure OnClick
37794>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
37795>>>>>>>>>>>        End_Procedure
37796>>>>>>>>>>>        //AB-StoreEnd
37796>>>>>>>>>>>
37796>>>>>>>>>>>    End_Object    // oCancel_bn
37797>>>>>>>>>>>
37797>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
37799>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
37800>>>>>>>>>>>        Set Location to 113 387
37801>>>>>>>>>>>
37801>>>>>>>>>>>        //AB-StoreStart
37801>>>>>>>>>>>        Procedure OnClick
37803>>>>>>>>>>>            Send Search To (oSelList(current_object))
37804>>>>>>>>>>>        End_Procedure
37805>>>>>>>>>>>        //AB-StoreEnd
37805>>>>>>>>>>>
37805>>>>>>>>>>>    End_Object    // oSearch_bn
37806>>>>>>>>>>>
37806>>>>>>>>>>>
37806>>>>>>>>>>>    //AB-StoreStart
37806>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
37807>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
37808>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
37809>>>>>>>>>>>    //AB-StoreEnd
37809>>>>>>>>>>>
37809>>>>>>>>>>>End_Object    // sl111
37810>>>>>>>>>>>
37810>>>>>>>>>>>//AB/ End_Object    // prj
37810>>>>>>>>>Use sl198.sl         // sl198
INCLUDING FILE: SL198.SL
37810>>>>>>>>>>>//AB/ Project sl198:cities
37810>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
37810>>>>>>>>>>>//AB/     Set ProjectName to "sl198:cities"
37810>>>>>>>>>>>//AB/     Set ProjectFileName to "sl198.SL"
37810>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
37810>>>>>>>>>>>
37810>>>>>>>>>>>// Project Object Structure
37810>>>>>>>>>>>//   sl198 is a dbModalPanelSub
37810>>>>>>>>>>>//     Cities_DD is a DataDictionary
37810>>>>>>>>>>>//     oSelList is a dbListSub
37810>>>>>>>>>>>//     oOK_bn is a ButtonSub
37810>>>>>>>>>>>//     oCancel_bn is a ButtonSub
37810>>>>>>>>>>>//     oSearch_bn is a ButtonSub
37810>>>>>>>>>>>
37810>>>>>>>>>>>// Register all objects
37810>>>>>>>>>>>Register_Object Cities_DD
37810>>>>>>>>>>>Register_Object oCancel_bn
37810>>>>>>>>>>>Register_Object oOK_bn
37810>>>>>>>>>>>Register_Object oSearch_bn
37810>>>>>>>>>>>Register_Object oSelList
37810>>>>>>>>>>>Register_Object sl198
37810>>>>>>>>>>>
37810>>>>>>>>>>>
37810>>>>>>>>>>>//AB-IgnoreStart
37810>>>>>>>>>>>
37810>>>>>>>>>>>Use DFAllEnt.pkg
37810>>>>>>>>>>>Use dbList.Sub
37810>>>>>>>>>>>Use Button.Sub
37810>>>>>>>>>>>
37810>>>>>>>>>>>
37810>>>>>>>>>>>Use CITIES.DD
INCLUDING FILE: CITIES.DD
37810>>>>>>>>>>>>>//DDB-FileStart
37810>>>>>>>>>>>>>//DDB-HeaderStart
37810>>>>>>>>>>>>>
37810>>>>>>>>>>>>>// File Name : CITIES.DD
37810>>>>>>>>>>>>>// Class Name: Cities_DataDictionary
37810>>>>>>>>>>>>>// Revision  : 14
37810>>>>>>>>>>>>>// Version   : 2
37810>>>>>>>>>>>>>
37810>>>>>>>>>>>>>Use  Windows           // Basic Definitions
37810>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
37810>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37810>>>>>>>>>>>>>
37810>>>>>>>>>>>>>Open Cities
37812>>>>>>>>>>>>>Open Clients
37814>>>>>>>>>>>>>Open Towns
37816>>>>>>>>>>>>>
37816>>>>>>>>>>>>>//DDB-HeaderEnd
37816>>>>>>>>>>>>>//DDB-SelectionStart
37816>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.SL
37816>>>>>>>>>>>>>Register_Object sl198
37816>>>>>>>>>>>>>//DDB-SelectionEnd
37816>>>>>>>>>>>>>
37816>>>>>>>>>>>>>Class Cities_DataDictionary  is a DataDictionary_Sec
37817>>>>>>>>>>>>>
37817>>>>>>>>>>>>>    // Define_Fields:
37817>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
37817>>>>>>>>>>>>>
37817>>>>>>>>>>>>>    Procedure Define_Fields
37818>>>>>>>>>>>>>        Forward Send Define_Fields
37820>>>>>>>>>>>>>        //DDB-Generated-Code-Location
37820>>>>>>>>>>>>>        //DDB-DefineFieldStart
37820>>>>>>>>>>>>>
37820>>>>>>>>>>>>>        Set Main_File            To Cities.File_Number
37821>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
37822>>>>>>>>>>>>>
37822>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
37823>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
37824>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
37825>>>>>>>>>>>>>
37825>>>>>>>>>>>>>        // Child (Client) file structure................
37825>>>>>>>>>>>>>        Send Add_Client_File  Clients.File_Number
37826>>>>>>>>>>>>>
37826>>>>>>>>>>>>>        // Parent (Server) file structure...............
37826>>>>>>>>>>>>>        Send Add_Server_File  Towns.File_Number
37827>>>>>>>>>>>>>
37827>>>>>>>>>>>>>        // Field-based properties.......................
37827>>>>>>>>>>>>>
37827>>>>>>>>>>>>>        // Cities.City_Id
37827>>>>>>>>>>>>>        Set Field_Options          Field Cities.City_Id To DD_AUTOFIND   
37828>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cities.City_Id To (sl198(Self))
37829>>>>>>>>>>>>>        Set Key_Field_State        Field Cities.City_Id To TRUE
37830>>>>>>>>>>>>>
37830>>>>>>>>>>>>>        // Cities.City_Descr
37830>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cities.City_Descr To (sl198(Self))
37831>>>>>>>>>>>>>
37831>>>>>>>>>>>>>        // Cities.Town_Id
37831>>>>>>>>>>>>>
37831>>>>>>>>>>>>>        //DDB-DefineFieldEnd
37831>>>>>>>>>>>>>    End_Procedure    // Define_Fields
37832>>>>>>>>>>>>>
37832>>>>>>>>>>>>>    // Field_Defaults:
37832>>>>>>>>>>>>>    // This procedure is used to establish default field values.
37832>>>>>>>>>>>>>
37832>>>>>>>>>>>>>    Procedure Field_Defaults
37833>>>>>>>>>>>>>        Forward Send Field_Defaults
37835>>>>>>>>>>>>>        //DDB-Generated-Code-Location
37835>>>>>>>>>>>>>        //DDB-FieldDefaultStart
37835>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
37835>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
37836>>>>>>>>>>>>>
37836>>>>>>>>>>>>>End_Class    // Cities_DataDictionary
37837>>>>>>>>>>>>>//DDB-Selection-pkg-Start
37837>>>>>>>>>>>>>
37837>>>>>>>>>>>>>Use sl198.SL         // sl198
37837>>>>>>>>>>>>>
37837>>>>>>>>>>>>>//DDB-Selection-pkg-End
37837>>>>>>>>>>>>>//DDB-FileEnd
37837>>>>>>>>>>>
37837>>>>>>>>>>>//AB-IgnoreEnd
37837>>>>>>>>>>>
37837>>>>>>>>>>>Object sl198 is a dbModalPanelSub
37839>>>>>>>>>>>    Set Label to "€¨®œå¦ æ¢œà¤"
37840>>>>>>>>>>>    Set Size to 148 297
37841>>>>>>>>>>>    Set Location to 4 5
37842>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
37843>>>>>>>>>>>    Set Modal_State to FALSE
37844>>>>>>>>>>>
37844>>>>>>>>>>>    //AB-DDOStart
37844>>>>>>>>>>>
37844>>>>>>>>>>>    Object Cities_DD is a Cities_DataDictionary
37846>>>>>>>>>>>
37846>>>>>>>>>>>        //AB-StoreStart
37846>>>>>>>>>>>                
37846>>>>>>>>>>>                
37846>>>>>>>>>>>        //AB-StoreEnd
37846>>>>>>>>>>>
37846>>>>>>>>>>>    End_Object    // Cities_DD
37847>>>>>>>>>>>
37847>>>>>>>>>>>    Set Main_DD to (Cities_DD(self))
37848>>>>>>>>>>>    Set Server to (Cities_DD(self))
37849>>>>>>>>>>>
37849>>>>>>>>>>>    //AB-DDOEnd
37849>>>>>>>>>>>
37849>>>>>>>>>>>    Object oSelList is a dbListSub
37851>>>>>>>>>>>        Set Main_File to Cities.File_Number
37852>>>>>>>>>>>        Set Size to 105 280
37853>>>>>>>>>>>        Set Location to 6 6
37854>>>>>>>>>>>
37854>>>>>>>>>>>        Begin_Row
37857>>>>>>>>>>>            Entry_Item Cities.City_id
37858>>>>>>>>>>>            Entry_Item Cities.City_descr
37859>>>>>>>>>>>        End_Row
37864>>>>>>>>>>>
37864>>>>>>>>>>>        Set Form_Width    item 0 to 50
37865>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
37866>>>>>>>>>>>        
37866>>>>>>>>>>>        Set Form_Width    item 1 to 221
37867>>>>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
37868>>>>>>>>>>>        
37868>>>>>>>>>>>
37868>>>>>>>>>>>        //AB-StoreStart
37868>>>>>>>>>>>        
37868>>>>>>>>>>>        Set Column_Option Item 0 to NoEnter True
37869>>>>>>>>>>>        
37869>>>>>>>>>>>        
37869>>>>>>>>>>>        
37869>>>>>>>>>>>        
37869>>>>>>>>>>>        
37869>>>>>>>>>>>        //AB-StoreEnd
37869>>>>>>>>>>>
37869>>>>>>>>>>>    End_Object    // oSelList
37870>>>>>>>>>>>
37870>>>>>>>>>>>    Object oOK_bn is a ButtonSub
37872>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
37873>>>>>>>>>>>        Set Location to 115 126
37874>>>>>>>>>>>
37874>>>>>>>>>>>        //AB-StoreStart
37874>>>>>>>>>>>        Procedure OnClick
37876>>>>>>>>>>>            Send OK To (oSelList(current_object))
37877>>>>>>>>>>>        End_Procedure
37878>>>>>>>>>>>        //AB-StoreEnd
37878>>>>>>>>>>>
37878>>>>>>>>>>>    End_Object    // oOK_bn
37879>>>>>>>>>>>
37879>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
37881>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
37882>>>>>>>>>>>        Set Location to 115 181
37883>>>>>>>>>>>
37883>>>>>>>>>>>        //AB-StoreStart
37883>>>>>>>>>>>        Procedure OnClick
37885>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
37886>>>>>>>>>>>        End_Procedure
37887>>>>>>>>>>>        //AB-StoreEnd
37887>>>>>>>>>>>
37887>>>>>>>>>>>    End_Object    // oCancel_bn
37888>>>>>>>>>>>
37888>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
37890>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
37891>>>>>>>>>>>        Set Location to 115 236
37892>>>>>>>>>>>
37892>>>>>>>>>>>        //AB-StoreStart
37892>>>>>>>>>>>        Procedure OnClick
37894>>>>>>>>>>>            Send Search To (oSelList(current_object))
37895>>>>>>>>>>>        End_Procedure
37896>>>>>>>>>>>        //AB-StoreEnd
37896>>>>>>>>>>>
37896>>>>>>>>>>>    End_Object    // oSearch_bn
37897>>>>>>>>>>>
37897>>>>>>>>>>>
37897>>>>>>>>>>>    //AB-StoreStart
37897>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
37898>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
37899>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
37900>>>>>>>>>>>    //AB-StoreEnd
37900>>>>>>>>>>>
37900>>>>>>>>>>>End_Object    // sl198
37901>>>>>>>>>>>
37901>>>>>>>>>>>//AB/ End_Object    // prj
37901>>>>>>>>>Use sl197.SL         // sl197
INCLUDING FILE: SL197.SL
37901>>>>>>>>>>>//AB/ Project sl197:areas
37901>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
37901>>>>>>>>>>>//AB/         Set ProjectName to "sl197:areas"
37901>>>>>>>>>>>//AB/         Set ProjectFileName to "sl197.SL"
37901>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
37901>>>>>>>>>>>
37901>>>>>>>>>>>// Project Object Structure
37901>>>>>>>>>>>//   sl197 is a dbModalPanelSub
37901>>>>>>>>>>>//     Areas_DD is a DataDictionary
37901>>>>>>>>>>>//     oSelList is a dbListSub
37901>>>>>>>>>>>//     oOK_bn is a ButtonSub
37901>>>>>>>>>>>//     oCancel_bn is a ButtonSub
37901>>>>>>>>>>>//     oSearch_bn is a ButtonSub
37901>>>>>>>>>>>
37901>>>>>>>>>>>// Register all objects
37901>>>>>>>>>>>Register_Object Areas_DD
37901>>>>>>>>>>>Register_Object oCancel_bn
37901>>>>>>>>>>>Register_Object oOK_bn
37901>>>>>>>>>>>Register_Object oSearch_bn
37901>>>>>>>>>>>Register_Object oSelList
37901>>>>>>>>>>>Register_Object sl197
37901>>>>>>>>>>>
37901>>>>>>>>>>>
37901>>>>>>>>>>>    //AB-IgnoreStart
37901>>>>>>>>>>>
37901>>>>>>>>>>>    Use DFAllEnt.pkg
37901>>>>>>>>>>>    Use dbList.Sub
37901>>>>>>>>>>>    Use Button.Sub
37901>>>>>>>>>>>
37901>>>>>>>>>>>
37901>>>>>>>>>>>    Use AREAS.DD
INCLUDING FILE: AREAS.DD
37901>>>>>>>>>>>>>//DDB-FileStart
37901>>>>>>>>>>>>>//DDB-HeaderStart
37901>>>>>>>>>>>>>
37901>>>>>>>>>>>>>// File Name : AREAS.DD
37901>>>>>>>>>>>>>// Class Name: Areas_DataDictionary
37901>>>>>>>>>>>>>// Revision  : 8
37901>>>>>>>>>>>>>// Version   : 2
37901>>>>>>>>>>>>>
37901>>>>>>>>>>>>>Use  Windows           // Basic Definitions
37901>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
37901>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37901>>>>>>>>>>>>>
37901>>>>>>>>>>>>>Open Areas
37903>>>>>>>>>>>>>Open Clients
37905>>>>>>>>>>>>>
37905>>>>>>>>>>>>>//DDB-HeaderEnd
37905>>>>>>>>>>>>>//DDB-SelectionStart
37905>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
37905>>>>>>>>>>>>>Register_Object sl197
37905>>>>>>>>>>>>>//DDB-SelectionEnd
37905>>>>>>>>>>>>>
37905>>>>>>>>>>>>>Class Areas_DataDictionary  is a DataDictionary_Sec
37906>>>>>>>>>>>>>
37906>>>>>>>>>>>>>    // Define_Fields:
37906>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
37906>>>>>>>>>>>>>
37906>>>>>>>>>>>>>    Procedure Define_Fields
37907>>>>>>>>>>>>>        Forward Send Define_Fields
37909>>>>>>>>>>>>>        //DDB-Generated-Code-Location
37909>>>>>>>>>>>>>        //DDB-DefineFieldStart
37909>>>>>>>>>>>>>
37909>>>>>>>>>>>>>        Set Main_File            To Areas.File_Number
37910>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
37911>>>>>>>>>>>>>
37911>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
37912>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
37913>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
37914>>>>>>>>>>>>>
37914>>>>>>>>>>>>>        // Child (Client) file structure................
37914>>>>>>>>>>>>>        Send Add_Client_File  Clients.File_Number
37915>>>>>>>>>>>>>
37915>>>>>>>>>>>>>        // Field-based properties.......................
37915>>>>>>>>>>>>>
37915>>>>>>>>>>>>>        // Areas.Area_Id
37915>>>>>>>>>>>>>        Set Field_Options          Field Areas.Area_Id To DD_AUTOFIND   
37916>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Areas.Area_Id To (sl197(Self))
37917>>>>>>>>>>>>>
37917>>>>>>>>>>>>>        // Areas.Area_Descr
37917>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Areas.Area_Descr To (sl197(Self))
37918>>>>>>>>>>>>>
37918>>>>>>>>>>>>>        // Areas.Area_Site
37918>>>>>>>>>>>>>
37918>>>>>>>>>>>>>        //DDB-DefineFieldEnd
37918>>>>>>>>>>>>>    End_Procedure    // Define_Fields
37919>>>>>>>>>>>>>
37919>>>>>>>>>>>>>    // Field_Defaults:
37919>>>>>>>>>>>>>    // This procedure is used to establish default field values.
37919>>>>>>>>>>>>>
37919>>>>>>>>>>>>>    Procedure Field_Defaults
37920>>>>>>>>>>>>>        Forward Send Field_Defaults
37922>>>>>>>>>>>>>        //DDB-Generated-Code-Location
37922>>>>>>>>>>>>>        //DDB-FieldDefaultStart
37922>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
37922>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
37923>>>>>>>>>>>>>
37923>>>>>>>>>>>>>End_Class    // Areas_DataDictionary
37924>>>>>>>>>>>>>//DDB-Selection-pkg-Start
37924>>>>>>>>>>>>>
37924>>>>>>>>>>>>>Use sl197.SL         // sl197
37924>>>>>>>>>>>>>
37924>>>>>>>>>>>>>//DDB-Selection-pkg-End
37924>>>>>>>>>>>>>//DDB-FileEnd
37924>>>>>>>>>>>    
37924>>>>>>>>>>>    //AB-IgnoreEnd
37924>>>>>>>>>>>
37924>>>>>>>>>>>    Object sl197 is a dbModalPanelSub
37926>>>>>>>>>>>
37926>>>>>>>>>>>        //AB-StoreTopStart
37926>>>>>>>>>>>                    
37926>>>>>>>>>>>        //AB-StoreTopEnd
37926>>>>>>>>>>>
37926>>>>>>>>>>>        Set Label to "€¨®œå¦ œ¨ ¦®é¤"
37927>>>>>>>>>>>        Set Size to 148 297
37928>>>>>>>>>>>        Set Location to 4 5
37929>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
37930>>>>>>>>>>>        Set Modal_State to FALSE
37931>>>>>>>>>>>
37931>>>>>>>>>>>        //AB-DDOStart
37931>>>>>>>>>>>
37931>>>>>>>>>>>        Object Areas_DD is a Areas_DataDictionary
37933>>>>>>>>>>>
37933>>>>>>>>>>>            //AB-StoreStart
37933>>>>>>>>>>>                                    
37933>>>>>>>>>>>            //AB-StoreEnd
37933>>>>>>>>>>>
37933>>>>>>>>>>>        End_Object    // Areas_DD
37934>>>>>>>>>>>
37934>>>>>>>>>>>        Set Main_DD to (Areas_DD(self))
37935>>>>>>>>>>>        Set Server to (Areas_DD(self))
37936>>>>>>>>>>>
37936>>>>>>>>>>>        //AB-DDOEnd
37936>>>>>>>>>>>
37936>>>>>>>>>>>        Object oSelList is a dbListSub
37938>>>>>>>>>>>            Set Main_File to Areas.File_Number
37939>>>>>>>>>>>            Set Ordering to 2
37940>>>>>>>>>>>            Set Size to 105 280
37941>>>>>>>>>>>            Set Location to 5 5
37942>>>>>>>>>>>            Set Export_Item_State to TRUE
37943>>>>>>>>>>>
37943>>>>>>>>>>>            Begin_Row
37946>>>>>>>>>>>                Entry_Item Areas.Area_id
37947>>>>>>>>>>>                Entry_Item Areas.Area_descr
37948>>>>>>>>>>>                Entry_Item Areas.Area_site
37949>>>>>>>>>>>            End_Row
37954>>>>>>>>>>>
37954>>>>>>>>>>>            Set Form_Width    item 0 to 45
37955>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
37956>>>>>>>>>>>            
37956>>>>>>>>>>>            Set Form_Width    item 1 to 192
37957>>>>>>>>>>>            Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
37958>>>>>>>>>>>            
37958>>>>>>>>>>>            Set Form_Width    item 2 to 35
37959>>>>>>>>>>>            Set Header_Label  item 2 to "’¦£â˜ª"
37960>>>>>>>>>>>            
37960>>>>>>>>>>>
37960>>>>>>>>>>>            //AB-StoreStart
37960>>>>>>>>>>>            
37960>>>>>>>>>>>            Set Column_Option Item 0 to NoEnter True
37961>>>>>>>>>>>            
37961>>>>>>>>>>>            
37961>>>>>>>>>>>            //AB-StoreEnd
37961>>>>>>>>>>>
37961>>>>>>>>>>>        End_Object    // oSelList
37962>>>>>>>>>>>
37962>>>>>>>>>>>        Object oOK_bn is a ButtonSub
37964>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
37965>>>>>>>>>>>            Set Location to 115 126
37966>>>>>>>>>>>
37966>>>>>>>>>>>            //AB-StoreStart
37966>>>>>>>>>>>            Procedure OnClick
37968>>>>>>>>>>>                Send OK To (oSelList(current_object))
37969>>>>>>>>>>>            End_Procedure
37970>>>>>>>>>>>            //AB-StoreEnd
37970>>>>>>>>>>>
37970>>>>>>>>>>>        End_Object    // oOK_bn
37971>>>>>>>>>>>
37971>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
37973>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
37974>>>>>>>>>>>            Set Location to 115 181
37975>>>>>>>>>>>
37975>>>>>>>>>>>            //AB-StoreStart
37975>>>>>>>>>>>            Procedure OnClick
37977>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
37978>>>>>>>>>>>            End_Procedure
37979>>>>>>>>>>>            //AB-StoreEnd
37979>>>>>>>>>>>
37979>>>>>>>>>>>        End_Object    // oCancel_bn
37980>>>>>>>>>>>
37980>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
37982>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
37983>>>>>>>>>>>            Set Location to 115 236
37984>>>>>>>>>>>
37984>>>>>>>>>>>            //AB-StoreStart
37984>>>>>>>>>>>            Procedure OnClick
37986>>>>>>>>>>>                Send Search To (oSelList(current_object))
37987>>>>>>>>>>>            End_Procedure
37988>>>>>>>>>>>            //AB-StoreEnd
37988>>>>>>>>>>>
37988>>>>>>>>>>>        End_Object    // oSearch_bn
37989>>>>>>>>>>>
37989>>>>>>>>>>>
37989>>>>>>>>>>>        //AB-StoreStart
37989>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
37990>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
37991>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
37992>>>>>>>>>>>        
37992>>>>>>>>>>>        
37992>>>>>>>>>>>        
37992>>>>>>>>>>>        
37992>>>>>>>>>>>        
37992>>>>>>>>>>>        //AB-StoreEnd
37992>>>>>>>>>>>
37992>>>>>>>>>>>    End_Object    // sl197
37993>>>>>>>>>>>
37993>>>>>>>>>>>//AB/     End_Object    // prj
37993>>>>>>>>>
37993>>>>>>>>>//DDB-Selection-pkg-End
37993>>>>>>>>>//DDB-FileEnd
37993>>>>>>>//Use PmsSxet.DD
37993>>>>>>>
37993>>>>>>>Class Cmoves_DataDictionary  is a DataDictionary
37994>>>>>>>
37994>>>>>>>    Procedure Construct_Object
37995>>>>>>>        Forward Send Construct_Object
37997>>>>>>>        Property Integer piFromBP           Public 0
37998>>>>>>>        Property Integer piNotMoveSyscurXr  Public 0   
37999>>>>>>>        Property Integer piFromSysxet       Public 0   
38000>>>>>>>        Property Integer piFromxrhsh        Public 0  //œ¤›œ ¥ž ¦«  œ¨®œ«˜  ˜§¦ £œ«˜­¦¨á ¬§¦¢¦å§à¤
38001>>>>>>>    End_Procedure
38002>>>>>>>
38002>>>>>>>    Function Validate_Save  Returns Integer
38003>>>>>>>        Integer iReturnVal iOpen_Items iCheck ifromxrhsh iYes
38004>>>>>>>        String sModule
38004>>>>>>>        get pifromxrhsh to ifromxrhsh
38005>>>>>>>        Forward Get Validate_Save  To iReturnVal
38007>>>>>>>        If (Not(iReturnVal)) Begin
38009>>>>>>>            if (cmoves.cmoves_recr='')  Send Operation_Not_Allowed 3263
38012>>>>>>>            Clear Branch
38013>>>>>>>            Move SyscurXr.Company_Code  to Branch.Company_Code
38014>>>>>>>            Move SyscurXr.Branch_Code   to Branch.Branch_Code
38015>>>>>>>            Find Eq Branch By Index.1
38016>>>>>>>>
38016>>>>>>>            If (Not(Found)) Move 6666 to iReturnVal
38019>>>>>>>            Else If ((Branch.Locked_Until<>'') And (Cmoves.Cmoves_Hmnia<=Branch.Locked_Until)) Move 6667 to iReturnVal
38023>>>>>>>            
38023>>>>>>>            If (Cmoves.Axia_Ypol_Sysx<0) Begin
38025>>>>>>>                Move 10101 to iReturnVal
38026>>>>>>>            End
38026>>>>>>>>
38026>>>>>>>            Else Begin
38027>>>>>>>                
38027>>>>>>>                Move Ctypkin.Check_Overhead to iCheck
38028>>>>>>>                If (iCheck) Begin
38030>>>>>>>                    If ((Clients.Plafon>0) And (Clients.Overhead<0) And (Sysfile.Over_Overhead<>'1')) Begin
38032>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 3000 Cmoves' to iYes
38033>>>>>>>                        If (iYes=MBR_NO) Move 11170 to iReturnVal
38036>>>>>>>                    End
38036>>>>>>>>
38036>>>>>>>                    Else If ((PayResp.Plafon>0) And (PayResp.Overhead<0) And (Sysfile.Over_Overhead<>'1')) Begin
38039>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 3001 Cmoves' to iYes
38040>>>>>>>                        If (iYes=MBR_NO) Move 11171 to iReturnVal
38043>>>>>>>                    End
38043>>>>>>>>
38043>>>>>>>                End
38043>>>>>>>>
38043>>>>>>>                
38043>>>>>>>                If (iReturnVal) Send Operation_Not_Allowed iReturnVal
38046>>>>>>>                
38046>>>>>>>                If ((Cmoves.Prn_Theor='1') And (piFromBP(Self)<>1)) Move 22278 to iReturnVal
38049>>>>>>>                Else If ((Clients.Client_Locked='1') And (piFromBP(Self)<>1)) Move 11172 to iReturnVal
38053>>>>>>>                
38053>>>>>>>                // ˜¤ œ¨®œ«˜  ˜§¦ £œ«˜­¦¨á ¬§¦¢¦å§à¤ £ž¤ «¦¤ ¡¦™œ ª ã ˜§¦ open items (©¬©®œ« ©œ ª)
38053>>>>>>>                Else If ((Cmoves.Cmoves_Hmnia<syscurxr.Year_Xrhshfrom and ifromxrhsh<>1 And (piFromSysxet(Self)<>1)) Or ;                         (Cmoves.Cmoves_Hmnia>Syscurxr.Year_Xrhshto and ifromxrhsh<>1 And (piFromSysxet(Self)<>1))) Move 22277 to iReturnVal
38057>>>>>>>                Else Begin
38058>>>>>>>                    If (Cmoves.Module_From='') Move 22250 to iReturnVal
38061>>>>>>>                    Else Begin
38062>>>>>>>                        If (piFromBP(Self)<>1) Begin // €¤ ›œ¤ §¨¦œ¨®œ«˜  ˜§¦ « ª 2 Business Process
38064>>>>>>>                            If (Cmoves.Module_From<>gs_Module_Code) Move 22288 to iReturnVal
38067>>>>>>>                            Else If (Cmoves.Recnum<>0) Begin // €¤ ›œ¤ ¡˜¤œ  create ¤œ˜ œšš¨˜­ž
38070>>>>>>>                                If (Cmoves.Barticl_Recr<>'') Move 22284 to iReturnVal
38073>>>>>>>                                Else If (Cmoves.Partl_Recr  <>'') Begin
38076>>>>>>>                                    If (Cmoves.Module_From='01') Move 22283 to iReturnVal
38079>>>>>>>                                    Else If (Cmoves.Module_From='02') Move 22282 to iReturnVal
38083>>>>>>>                                End
38083>>>>>>>>
38083>>>>>>>                            End
38083>>>>>>>>
38083>>>>>>>                        End
38083>>>>>>>>
38083>>>>>>>                    End
38083>>>>>>>>
38083>>>>>>>                End
38083>>>>>>>>
38083>>>>>>>            End
38083>>>>>>>>
38083>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
38086>>>>>>>        End
38086>>>>>>>>
38086>>>>>>>        Function_Return iReturnVal
38087>>>>>>>    End_Function   // Validate_Save
38088>>>>>>>
38088>>>>>>>    Function Validate_Delete  Returns Integer
38089>>>>>>>        Integer iReturnVal
38090>>>>>>>        String sModule
38090>>>>>>>        Forward Get Validate_Delete  To iReturnVal
38092>>>>>>>        If (Not(iReturnVal)) Begin
38094>>>>>>>
38094>>>>>>>            Clear Branch
38095>>>>>>>            Move SyscurXr.Company_Code  to Branch.Company_Code
38096>>>>>>>            Move SyscurXr.Branch_Code   to Branch.Branch_Code
38097>>>>>>>            Find Eq Branch By Index.1
38098>>>>>>>>
38098>>>>>>>            If (Not(Found)) Move 6668 to iReturnVal
38101>>>>>>>            Else If ((Branch.Locked_Until<>'') And (Cmoves.Cmoves_Hmnia<=Branch.Locked_Until)) Move 6669 to iReturnVal
38105>>>>>>>            
38105>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
38108>>>>>>>            
38108>>>>>>>            If (Cmoves.Prn_Theor='1') Move 22279 to iReturnVal
38111>>>>>>>            Else If (piFromBP(Self)<>1) Begin
38114>>>>>>>                If (Cmoves.Module_From<>gs_Module_Code) Move 22289 to iReturnVal
38117>>>>>>>                Else Begin
38118>>>>>>>                    If (Cmoves.Barticl_Recr<>'') Move 22287 to iReturnVal
38121>>>>>>>                    Else If (Cmoves.Partl_Recr  <>'') Begin
38124>>>>>>>                        If (Cmoves.Module_From='01') Move 22286 to iReturnVal
38127>>>>>>>                        Else If (Cmoves.Module_From='02') Move 22285 to iReturnVal
38131>>>>>>>                    End
38131>>>>>>>>
38131>>>>>>>                End
38131>>>>>>>>
38131>>>>>>>            End
38131>>>>>>>>
38131>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
38134>>>>>>>        End
38134>>>>>>>>
38134>>>>>>>        Function_Return iReturnVal
38135>>>>>>>    End_Function   // Validate_Delete
38136>>>>>>>
38136>>>>>>>    Procedure Save_Main_File
38137>>>>>>>        If (Operation_Origin<>Self) Begin
38139>>>>>>>            If Cmoves.Recnum Eq 0 Procedure_Return
38142>>>>>>>        End
38142>>>>>>>>
38142>>>>>>>        If (Cmoves.Cn_Code<>'') Begin
38144>>>>>>>            Clear Cn
38145>>>>>>>            Move Cmoves.Cn_Code to Cn.Cn_Code
38146>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
38147>>>>>>>>
38147>>>>>>>            Move Cn.Cn_Sls_ID      to Cmoves.Sls_ID
38148>>>>>>>            Move cn.Mhxanik_id     to Cmoves.Mhxanik_Id
38149>>>>>>>            Move Cn.CN_Cnt_ID      to Cmoves.Cnt_ID
38150>>>>>>>            Move Cn.Cn_Recr        to Cmoves.Cn_Recr
38151>>>>>>>        End
38151>>>>>>>>
38151>>>>>>>        Else Begin
38152>>>>>>>            Move ''     to Cmoves.Sls_ID
38153>>>>>>>            Move ''     to Cmoves.Cnt_ID
38154>>>>>>>            Move ''     to Cmoves.Cn_Recr
38155>>>>>>>            Move ''     to Cmoves.Mhxanik_id
38156>>>>>>>        End
38156>>>>>>>>
38156>>>>>>>        Forward Send Save_Main_File
38158>>>>>>>    End_Procedure   // Save_Main_File
38159>>>>>>>
38159>>>>>>>
38159>>>>>>>    Procedure Update
38160>>>>>>>        String sNomisma
38161>>>>>>>        Forward Send Update
38163>>>>>>>        
38163>>>>>>>        If (piNotMoveSyscurXr(Self)=0) Begin
38165>>>>>>>            Move SysCurXR.Company_Code      to Cmoves.Company_Code
38166>>>>>>>            Move SysCurXR.Branch_Code       to Cmoves.Branch_Code
38167>>>>>>>        End
38167>>>>>>>>
38167>>>>>>>        
38167>>>>>>>        //˜¤ šå¤œ«˜  £œ«˜­¦¨á ¬§¦¢¦å§à¤
38167>>>>>>>        if (pifromxrhsh(self)=1)            Move (SysCurXR.Year_Year+1) to Cmoves.Year_Year
38170>>>>>>>        else If (piNotMoveSyscurXr(Self)=0) Move SysCurXR.Year_Year     to Cmoves.Year_Year
38174>>>>>>>        
38174>>>>>>>        //Move Custprom.Custprom_Code to Cmoves.Custprom_Code
38174>>>>>>>        Move Clients.Client_ID          to Cmoves.Client_ID
38175>>>>>>>        Move Clients.Client_Name        to Cmoves.Client_Name
38176>>>>>>>        Move Ctypkin.Ctypkin_Descr      to Cmoves.Ctypkin_Descr
38177>>>>>>>
38177>>>>>>>        // js 28/03/2002 Gia na mhn allazei sta Copen me to Ctypkin tou CmovesA
38177>>>>>>>        If (Cmoves.Ctypkin_Code='') ;            Move Ctypkin.Ctypkin_Code   to Cmoves.Ctypkin_Code
38180>>>>>>>
38180>>>>>>>
38180>>>>>>>        Move payresp.presp_ID           to Cmoves.Presp_ID
38181>>>>>>>
38181>>>>>>>        ///an enhmeronei synolikh ofeilh pelath
38181>>>>>>>        if (Cmoves.enhm_ofeilh='1') begin
38183>>>>>>>            Add (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) to Clients.Synolikh_ofeilh
38184>>>>>>>            Add (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) to Payresp.Synolikh_ofeilh
38185>>>>>>>        end
38185>>>>>>>>
38185>>>>>>>
38185>>>>>>>        If (Cmoves.Enhm_Ypol_Pel='1') Begin
38187>>>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
38189>>>>>>>                Add Cmoves.Cmoves_x0 to Clients.Xreosh
38190>>>>>>>                Add Cmoves.Cmoves_x0 to PayResp.Xreosh
38191>>>>>>>            End
38191>>>>>>>>
38191>>>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
38194>>>>>>>                Add Cmoves.Cmoves_p0 to Clients.Pistosh
38195>>>>>>>                Add Cmoves.Cmoves_p0 to PayResp.Pistosh
38196>>>>>>>            End
38196>>>>>>>>
38196>>>>>>>            if ((clients.client_ptyppar='113') and (clients.client_public<>1)) begin
38198>>>>>>>                move 1 to clients.client_public  
38199>>>>>>>                Move '01/01/1753'   to Clients.SAP_Hmnia
38200>>>>>>>                move '' to clients.status
38201>>>>>>>            end     
38201>>>>>>>>
38201>>>>>>>        End
38201>>>>>>>>
38201>>>>>>>        If (Cmoves.Enhm_Hmnies_Pel='1') Begin
38203>>>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
38205>>>>>>>                Move Cmoves.Cmoves_Hmnia   to Clients.Last_Xreosh
38206>>>>>>>                Move Cmoves.Cmoves_Hmnia   to PayResp.Last_Xreosh
38207>>>>>>>            End
38207>>>>>>>>
38207>>>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
38210>>>>>>>                Move Cmoves.Cmoves_Hmnia   to Clients.Last_Pistosh
38211>>>>>>>                Move Cmoves.Cmoves_Hmnia   to PayResp.Last_Pistosh
38212>>>>>>>            End
38212>>>>>>>>
38212>>>>>>>            if ((clients.client_ptyppar='113') and (clients.client_public<>1)) begin 
38214>>>>>>>                move 1 to clients.client_public
38215>>>>>>>                move '' to clients.status  
38216>>>>>>>                Move '01/01/1753'   to Clients.SAP_Hmnia
38217>>>>>>>            end 
38217>>>>>>>>
38217>>>>>>>        End
38217>>>>>>>>
38217>>>>>>>
38217>>>>>>>             If ((Cmoves.Cmoves_M_Code='') And (Cmoves.Module_From  <>'')) Move Cmoves.Module_From     to Cmoves.Cmoves_M_Code
38220>>>>>>>        Else If ((Cmoves.Module_From  ='') And (Cmoves.Cmoves_M_Code<>'')) Move Cmoves.Cmoves_M_Code   to Cmoves.Module_From
38224>>>>>>>
38224>>>>>>>        If (Ctypkin.Open_Item='1') Move (Cmoves.Axia_Pros_Sysx-Cmoves.Axia_Sysxet) to Cmoves.Axia_Ypol_Sysx
38227>>>>>>>        Else Begin
38228>>>>>>>            Move 0 to Cmoves.Axia_Pros_Sysx
38229>>>>>>>            Move 0 to Cmoves.Axia_Sysxet
38230>>>>>>>            Move 0 to Cmoves.Axia_Ypol_Sysx
38231>>>>>>>        End
38231>>>>>>>>
38231>>>>>>>
38231>>>>>>>        // js 23/01/2002
38231>>>>>>>        // Enhmerosh Pediou Flag_Ypol to opoio antiprosopeyei
38231>>>>>>>        // to an h eggrafh exei diathesimo ypoloipo pros sysxetish
38231>>>>>>>        Move (Cmoves.Axia_Ypol_Sysx<>0) to Cmoves.Flag_Ypol
38232>>>>>>>
38232>>>>>>>        // js 23/01/2002
38232>>>>>>>        // Enhmerosh Pediou Flag_Open to opoio antiprosopeyei
38232>>>>>>>        // an einai xreosh=1, pistosh=2, arnhtikh xreosh=2 arnhtikh Pistosh=1
38232>>>>>>>        // gia na emfanizei ta antistrofa sto copen
38232>>>>>>>        If (Ctypkin.Open_Item='1') Begin
38234>>>>>>>            If ((Cmoves.Cmoves_X0<>0) And ((Cmoves.Cmoves_P0=0))) Begin
38236>>>>>>>                Move 1                          to Cmoves.Flag_Copen
38237>>>>>>>                If (Cmoves.Cmoves_X0<0) Move 2  to Cmoves.Flag_Copen
38240>>>>>>>            End
38240>>>>>>>>
38240>>>>>>>            Else If ((Cmoves.Cmoves_P0<>0) And ((Cmoves.Cmoves_X0=0))) Begin
38243>>>>>>>                Move 2                          to Cmoves.Flag_Copen
38244>>>>>>>                If (Cmoves.Cmoves_P0<0) Move 1  to Cmoves.Flag_Copen
38247>>>>>>>            End
38247>>>>>>>>
38247>>>>>>>            Else Move 0 to Cmoves.Flag_Copen
38249>>>>>>>        End
38249>>>>>>>>
38249>>>>>>>        Else Move 0 to Cmoves.Flag_Copen
38251>>>>>>>    End_Procedure   // Update
38252>>>>>>>
38252>>>>>>>    Procedure Backout
38253>>>>>>>        Forward Send Backout
38255>>>>>>>
38255>>>>>>>        if (Cmoves.enhm_ofeilh='1') begin
38257>>>>>>>            sub (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) from Clients.Synolikh_ofeilh
38258>>>>>>>            sub (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) from Payresp.Synolikh_ofeilh
38259>>>>>>>        end
38259>>>>>>>>
38259>>>>>>>
38259>>>>>>>//        if (Cmoves.enhm_ofeilh='2') begin
38259>>>>>>>//            sub ((Cmoves.Cmoves_x0-Cmoves.cmoves_p0)*-1) from Clients.Synolikh_ofeilh
38259>>>>>>>//            sub ((Cmoves.Cmoves_x0-Cmoves.cmoves_p0)*-1) from Payresp.Synolikh_ofeilh
38259>>>>>>>//        end
38259>>>>>>>
38259>>>>>>>        If (Cmoves.Enhm_Ypol_Pel='1') Begin
38261>>>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
38263>>>>>>>                Sub Cmoves.Cmoves_x0 From Clients.Xreosh
38264>>>>>>>                Sub Cmoves.Cmoves_x0 From PayResp.Xreosh
38265>>>>>>>            End
38265>>>>>>>>
38265>>>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
38268>>>>>>>                Sub Cmoves.Cmoves_p0 From Clients.Pistosh
38269>>>>>>>                Sub Cmoves.Cmoves_p0 From PayResp.Pistosh
38270>>>>>>>            End
38270>>>>>>>>
38270>>>>>>>        End
38270>>>>>>>>
38270>>>>>>>    End_Procedure
38271>>>>>>>
38271>>>>>>>    Procedure Creating
38272>>>>>>>        Forward Send Creating
38274>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Cmoves.Cmoves_Rec0)))))) to Cmoves.Cmoves_Recr
38275>>>>>>>
38275>>>>>>>        //If ((Cmoves.Module_From='' ) Or (piFromBP(Self)<>1)) Move gs_Module_Code to Cmoves.Module_From
38275>>>>>>>
38275>>>>>>>        If (Ctypkin.Open_Item ='1') Begin
38277>>>>>>>                 If (Cmoves.Cmoves_x0<>0) Move (Abs(Cmoves.Cmoves_x0)) to Cmoves.Axia_Pros_Sysx
38280>>>>>>>            Else If (Cmoves.Cmoves_p0<>0) Move (Abs(Cmoves.Cmoves_p0)) to Cmoves.Axia_Pros_Sysx
38284>>>>>>>        End
38284>>>>>>>>
38284>>>>>>>    End_Procedure   // Creating
38285>>>>>>>
38285>>>>>>>
38285>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
38286>>>>>>>        String lsError_Message
38287>>>>>>>
38287>>>>>>>        Case Begin
38287>>>>>>>            
38287>>>>>>>            Case (iError_Num = 3263)
38289>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6666 €›ç¤˜«ž ž œšš¨˜­ž!\n‰œ¤æ Cmoverecr!! Protem !!" to lsError_Message
38290>>>>>>>            Case Break
38291>>>>>>>            
38291>>>>>>>            Case (iError_Num = 6666)
38294>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6666 €›ç¤˜«ž ž œšš¨˜­ž!\nƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ ¬§¦¡˜«˜©«ž£á«à¤" to lsError_Message
38295>>>>>>>            Case Break
38296>>>>>>>
38296>>>>>>>            Case (iError_Num = 6667)
38299>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6667 €›ç¤˜«ž ž œšš¨˜­ž!\n†£/¤å˜ ¡å¤ž©žª §¨¦šœ¤â©«œ¨ž ž£/¤å˜ª ¡¢œ ›é£˜«¦ª" to lsError_Message
38300>>>>>>>            Case Break
38301>>>>>>>
38301>>>>>>>            Case (iError_Num = 6668)
38304>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6668 €›ç¤˜«ž ž › ˜š¨˜­ã!\nƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ ¬§¦¡˜«˜©«ž£á«à¤" to lsError_Message
38305>>>>>>>            Case Break
38306>>>>>>>
38306>>>>>>>            Case (iError_Num = 6669)
38309>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6669 €›ç¤˜«ž ž › ˜š¨˜­ã!\n†£/¤å˜ ¡å¤ž©žª §¨¦šœ¤â©«œ¨ž ž£/¤å˜ª ¡¢œ ›é£˜«¦ª" to lsError_Message
38310>>>>>>>            Case Break
38311>>>>>>>
38311>>>>>>>            Case (iError_Num = 22277)
38314>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n†£œ¨¦£ž¤åœª œ¡«æª ¦¨åà¤ ®¨ã©žª" to lsError_Message
38315>>>>>>>            Case Break
38316>>>>>>>
38316>>>>>>>            Case (iError_Num = 22278)
38319>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ã!\n\„®œ  «¬§àŸœ  Ÿœà¨ž£â¤¦" to lsError_Message
38320>>>>>>>            Case Break
38321>>>>>>>
38321>>>>>>>            Case (iError_Num = 22279)
38324>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\„®œ  «¬§àŸœ  Ÿœà¨ž£â¤¦" to lsError_Message
38325>>>>>>>            Case Break
38326>>>>>>>
38326>>>>>>>            Case (iError_Num = 11170)
38329>>>>>>>                Move "DDC 006:’¦ § ©«à« ¡æ æ¨ ¦ «¦¬ ­¦¨â˜ â®œ  œ¥˜¤«¢žŸœå" to lsError_Message
38330>>>>>>>            Case Break
38331>>>>>>>
38331>>>>>>>            Case (iError_Num = 11171)
38334>>>>>>>                Move "DDC 006:’¦ § ©«à« ¡æ æ¨ ¦ «¦¬ “§. ¢ž¨à£é¤ â®œ  œ¥˜¤«¢žŸœå" to lsError_Message
38335>>>>>>>            Case Break
38336>>>>>>>
38336>>>>>>>            Case (iError_Num = 11172)
38339>>>>>>>                Move "DDC 006:Ž ­¦¨â˜ª œå¤˜  ¡¢œ ›à£â¤¦ª ¢æšà § ©«à« ¡¦ç ¦¨å¦¬" to lsError_Message
38340>>>>>>>            Case Break
38341>>>>>>>
38341>>>>>>>            Case (iError_Num = 22288)
38344>>>>>>>                Clear Codemast
38345>>>>>>>                Move "MODULE" to Codemast.Type
38346>>>>>>>                Move Cmoves.Module_From to Codemast.Code
38347>>>>>>>                Find Eq Codemast by Index.1 //type+code
38348>>>>>>>>
38348>>>>>>>                Move ("DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n(† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
38349>>>>>>>            Case Break
38350>>>>>>>
38350>>>>>>>            Case (iError_Num = 22250)
38353>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n’¦ ¡ç¡¢à£˜ (Module) «žª œšš¨˜­ãª œå¤˜  ¡œ¤æ" to lsError_Message
38354>>>>>>>            Case Break
38355>>>>>>>
38355>>>>>>>            Case (iError_Num = 22284)
38358>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ «˜ €¥ æš¨˜­˜" to lsError_Message
38359>>>>>>>            Case Break
38360>>>>>>>            Case (iError_Num = 22283)
38363>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ « ª à¢ã©œ ª" to lsError_Message
38364>>>>>>>            Case Break
38365>>>>>>>            Case (iError_Num = 22282)
38368>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ « ª €š¦¨âª" to lsError_Message
38369>>>>>>>            Case Break
38370>>>>>>>
38370>>>>>>>            //˜§æ validate delete
38370>>>>>>>            Case (iError_Num = 22289)
38373>>>>>>>                Clear Codemast
38374>>>>>>>                Move "MODULE" to Codemast.Type
38375>>>>>>>                Move Cmoves.Module_From to Codemast.Code
38376>>>>>>>                Find Eq Codemast by Index.1 //type+code
38377>>>>>>>>
38377>>>>>>>                Move ("DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n(† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
38378>>>>>>>            Case Break
38379>>>>>>>
38379>>>>>>>            Case (iError_Num = 22287)
38382>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ «˜ €¥ æš¨˜­˜" to lsError_Message
38383>>>>>>>            Case Break
38384>>>>>>>            Case (iError_Num = 22286)
38387>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ « ª à¢ã©œ ª" to lsError_Message
38388>>>>>>>            Case Break
38389>>>>>>>            Case (iError_Num = 22285)
38392>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ « ª €š¦¨âª" to lsError_Message
38393>>>>>>>            Case Break
38394>>>>>>>
38394>>>>>>>            //â¢œš®¦  open items
38394>>>>>>>            Case (iError_Num = 10101)
38397>>>>>>>                Move ("DDC 006:€¡˜«á¢¢ž¢ž „šš¨˜­ã.\n\n"+;                "’¦ ©¬©®œ« ©£â¤¦ §¦©æ œå¤˜  £œš˜¢ç«œ¨¦\n˜§¦ «¦ ˜¨® ¡á › ˜Ÿâ© £¦ §¨¦ª ©¬©®â« ©ž");                to lsError_Message
38398>>>>>>>            Case Break
38399>>>>>>>
38399>>>>>>>            Case Else
38399>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
38401>>>>>>>        Case End
38401>>>>>>>
38401>>>>>>>        Error iError_Num lsError_Message
38402>>>>>>>>
38402>>>>>>>    End_Procedure // operation_not_allowed
38403>>>>>>>
38403>>>>>>>
38403>>>>>>>    // Define_Fields:
38403>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38403>>>>>>>
38403>>>>>>>    Procedure Define_Fields
38404>>>>>>>        Forward Send Define_Fields
38406>>>>>>>        //DDB-Generated-Code-Location
38406>>>>>>>        //DDB-DefineFieldStart
38406>>>>>>>
38406>>>>>>>        Set Main_File            To Cmoves.File_Number
38407>>>>>>>        Set Cascade_Delete_State To FALSE
38408>>>>>>>
38408>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38409>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38410>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38411>>>>>>>
38411>>>>>>>        // Child (Client) file structure................
38411>>>>>>>        Send Add_Client_File  Copen.File_Number
38412>>>>>>>
38412>>>>>>>        // Parent (Server) file structure...............
38412>>>>>>>        Send Add_Server_File  Ctypkin.File_Number
38413>>>>>>>        Send Add_Server_File  Clients.File_Number
38414>>>>>>>
38414>>>>>>>        // External (System) file structure.............
38414>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_NEW_SAVE_DELETE
38415>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
38416>>>>>>>
38416>>>>>>>        Define_Auto_Increment  Sysrecc.Cmoves_Rec0  To Cmoves.Cmoves_Rec0
38419>>>>>>>
38419>>>>>>>        // Field-based properties.......................
38419>>>>>>>
38419>>>>>>>        // Cmoves.Company_Code
38419>>>>>>>
38419>>>>>>>        // Cmoves.Branch_Code
38419>>>>>>>
38419>>>>>>>        // Cmoves.Year_Year
38419>>>>>>>
38419>>>>>>>        // Cmoves.Custprom_Code
38419>>>>>>>
38419>>>>>>>        // Cmoves.Client_Id
38419>>>>>>>
38419>>>>>>>        // Cmoves.Ctypkin_Code
38419>>>>>>>
38419>>>>>>>        // Cmoves.Cmoves_Recr
38419>>>>>>>
38419>>>>>>>        // Cmoves.Cmoves_Rec0
38419>>>>>>>        Set Field_Options          Field Cmoves.Cmoves_Rec0 To DD_AUTOFIND   
38420>>>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Rec0 To (sl006(Self))
38421>>>>>>>
38421>>>>>>>        // Cmoves.Cmoves_Hmnia
38421>>>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Hmnia To (sl006(Self))
38422>>>>>>>
38422>>>>>>>        // Cmoves.Ctypkin_Recr
38422>>>>>>>
38422>>>>>>>        // Cmoves.Cmoves_Par
38422>>>>>>>
38422>>>>>>>        // Cmoves.Partl_Recr
38422>>>>>>>        //DDB/ Comment_Short       Field Cmoves.Partl_Recr To "‘¬¤›œ©ž record £œ ¡ç¡¢à£˜ à¢ã©œà¤"
38422>>>>>>>
38422>>>>>>>        // Cmoves.Cmoves_Axia
38422>>>>>>>
38422>>>>>>>        // Cmoves.Cmoves_X0
38422>>>>>>>
38422>>>>>>>        // Cmoves.Cmoves_P0
38422>>>>>>>
38422>>>>>>>        // Cmoves.Cmoves_X00
38422>>>>>>>
38422>>>>>>>        // Cmoves.Cmoves_P00
38422>>>>>>>
38422>>>>>>>        // Cmoves.Cmoves_X1
38422>>>>>>>
38422>>>>>>>        // Cmoves.Cmoves_P1
38422>>>>>>>
38422>>>>>>>        // Cmoves.Cmoves_X2
38422>>>>>>>
38422>>>>>>>        // Cmoves.Cmoves_P2
38422>>>>>>>
38422>>>>>>>        // Cmoves.Cmoves_Dlixis
38422>>>>>>>
38422>>>>>>>        // Cmoves.Cmoves_A_Code
38422>>>>>>>
38422>>>>>>>        // Cmoves.Cmoves_Status_E
38422>>>>>>>
38422>>>>>>>        // Cmoves.Cmoves_Status_A
38422>>>>>>>
38422>>>>>>>        // Cmoves.Cmoves_S0
38422>>>>>>>
38422>>>>>>>        // Cmoves.Cmoves_Ys0
38422>>>>>>>
38422>>>>>>>        // Cmoves.Cmoves_S1
38422>>>>>>>
38422>>>>>>>        // Cmoves.Cmoves_Ys1
38422>>>>>>>
38422>>>>>>>        // Cmoves.Cmoves_S2
38422>>>>>>>
38422>>>>>>>        // Cmoves.Cmoves_Ys2
38422>>>>>>>
38422>>>>>>>        // Cmoves.Cmoves_Sc_Code2
38422>>>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Sc_Code2 To (slNomism(Self))
38423>>>>>>>
38423>>>>>>>        // Cmoves.Cmoves_Open
38423>>>>>>>
38423>>>>>>>        // Cmoves.Cmoves_Aopen
38423>>>>>>>
38423>>>>>>>        // Cmoves.Cmoves_M_Code
38423>>>>>>>
38423>>>>>>>        // Cmoves.Cmoves_Yn_Myf
38423>>>>>>>
38423>>>>>>>        // Cmoves.Cmoves_Myf_Axia
38423>>>>>>>
38423>>>>>>>        // Cmoves.Cmoves_Kk
38423>>>>>>>
38423>>>>>>>        // Cmoves.Cmoves_C_Code2
38423>>>>>>>
38423>>>>>>>        // Cmoves.Cn_Code
38423>>>>>>>        Set Field_Prompt_Object    Field Cmoves.Cn_Code To (sl041(Self))
38424>>>>>>>
38424>>>>>>>        // Cmoves.Client_Recr
38424>>>>>>>
38424>>>>>>>        // Cmoves.Barticl_Recr
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmoves_Qty
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmove_Totambd0
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmove_Discam0
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmove_Totamad0
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmove_Vatam0
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmove_Extra0
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmove_Totambd00
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmove_Discam00
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmove_Totamad00
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmove_Vatam00
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmove_Extra00
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmove_Totambd1
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmove_Discam1
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmove_Totamad1
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmove_Vatam1
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmove_Extra1
38424>>>>>>>
38424>>>>>>>        // Cmoves.Module_From
38424>>>>>>>
38424>>>>>>>        // Cmoves.Parast_Abrev
38424>>>>>>>
38424>>>>>>>        // Cmoves.Enhm_Ypol_Pel
38424>>>>>>>
38424>>>>>>>        // Cmoves.Enhm_Hmnies_Pel
38424>>>>>>>
38424>>>>>>>        // Cmoves.Sls_Id
38424>>>>>>>
38424>>>>>>>        // Cmoves.Presp_Id
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cnt_Id
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmoves_Open_Sx0
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmoves_Open_Sp0
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmoves_Open_Yx0
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmoves_Open_Yp0
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmoves_Open_Sx1
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmoves_Open_Sp1
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmoves_Open_Sx2
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmoves_Open_Sp2
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cmoves_Topen
38424>>>>>>>
38424>>>>>>>        // Cmoves.Cn_Recr
38424>>>>>>>
38424>>>>>>>        // Cmoves.Axia_Pros_Sysx
38424>>>>>>>
38424>>>>>>>        // Cmoves.Axia_Sysxet
38424>>>>>>>
38424>>>>>>>        // Cmoves.Axia_Ypol_Sysx
38424>>>>>>>
38424>>>>>>>        // Cmoves.Axia_Pros_Sys00
38424>>>>>>>
38424>>>>>>>        // Cmoves.Axia_Sysxet00
38424>>>>>>>
38424>>>>>>>        // Cmoves.Axia_Ypol_Sys00
38424>>>>>>>
38424>>>>>>>        // Cmoves.Axia_Pros_Sysr
38424>>>>>>>
38424>>>>>>>        // Cmoves.Axia_Sysxetr
38424>>>>>>>
38424>>>>>>>        // Cmoves.Axia_Ypol_Sysr
38424>>>>>>>
38424>>>>>>>        // Cmoves.Mhxanik_Id
38424>>>>>>>
38424>>>>>>>        // Cmoves.Prn_Theor
38424>>>>>>>
38424>>>>>>>        // Cmoves.Is_Closed
38424>>>>>>>
38424>>>>>>>        // Cmoves.Flag_Copen
38424>>>>>>>
38424>>>>>>>        // Cmoves.Flag_Ypol
38424>>>>>>>
38424>>>>>>>        // Cmoves.Ctypkin_Descr
38424>>>>>>>
38424>>>>>>>        // Cmoves.Client_Name
38424>>>>>>>
38424>>>>>>>        // Cmoves.Enhm_Ofeilh
38424>>>>>>>
38424>>>>>>>        // Cmoves.Sap_Hmnia
38424>>>>>>>
38424>>>>>>>        //DDB-DefineFieldEnd
38424>>>>>>>    End_Procedure    // Define_Fields
38425>>>>>>>
38425>>>>>>>    // Field_Defaults:
38425>>>>>>>    // This procedure is used to establish default field values.
38425>>>>>>>
38425>>>>>>>    Procedure Field_Defaults
38426>>>>>>>        Forward Send Field_Defaults
38428>>>>>>>        //DDB-Generated-Code-Location
38428>>>>>>>        //DDB-FieldDefaultStart
38428>>>>>>>        //DDB-FieldDefaultEnd
38428>>>>>>>    End_Procedure    // Field_Defaults
38429>>>>>>>
38429>>>>>>>End_Class    // Cmoves_DataDictionary
38430>>>>>>>//DDB-Selection-pkg-Start
38430>>>>>>>
38430>>>>>>>Use sl006.SL         // sl006
38430>>>>>>>Use slnomism.sl      // slNomism
INCLUDING FILE: SLNOMISM.SL
38430>>>>>>>>>//AB/ Project slNomism
38430>>>>>>>>>//AB/ Object prj is a Lookup_Project
38430>>>>>>>>>//AB/     Set ProjectName to "slNomism"
38430>>>>>>>>>//AB/     Set ProjectFileName to "slNomism.SL"
38430>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
38430>>>>>>>>>
38430>>>>>>>>>// Project Object Structure
38430>>>>>>>>>//   slNomism is a dbModalPanelSub
38430>>>>>>>>>//     Nomisma_DD is a DataDictionary
38430>>>>>>>>>//     oSelList is a dbListSub
38430>>>>>>>>>//     oOK_bn is a ButtonSub
38430>>>>>>>>>//     oSearch_bn is a ButtonSub
38430>>>>>>>>>
38430>>>>>>>>>// Register all objects
38430>>>>>>>>>Register_Object Nomisma_DD
38430>>>>>>>>>Register_Object oOK_bn
38430>>>>>>>>>Register_Object oSearch_bn
38430>>>>>>>>>Register_Object oSelList
38430>>>>>>>>>Register_Object slNomism
38430>>>>>>>>>
38430>>>>>>>>>
38430>>>>>>>>>//AB-IgnoreStart
38430>>>>>>>>>
38430>>>>>>>>>Use DFAllEnt.pkg
38430>>>>>>>>>Use dbList.Sub
38430>>>>>>>>>Use Button.Sub
38430>>>>>>>>>
38430>>>>>>>>>
38430>>>>>>>>>Use NOMISMA.DD
INCLUDING FILE: NOMISMA.DD
38430>>>>>>>>>>>//DDB-FileStart
38430>>>>>>>>>>>//DDB-HeaderStart
38430>>>>>>>>>>>
38430>>>>>>>>>>>// File Name : NOMISMA.DD
38430>>>>>>>>>>>// Class Name: Nomisma_DataDictionary
38430>>>>>>>>>>>// Revision  : 52
38430>>>>>>>>>>>// Version   : 2
38430>>>>>>>>>>>
38430>>>>>>>>>>>Use  Windows           // Basic Definitions
38430>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
38430>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38430>>>>>>>>>>>
38430>>>>>>>>>>>Open Nomisma
38432>>>>>>>>>>>Open Isotimia
INCLUDING FILE: ISOTIMIA.FD
38434>>>>>>>>>>>Open Particle
38436>>>>>>>>>>>
38436>>>>>>>>>>>//DDB-HeaderEnd
38436>>>>>>>>>>>//DDB-ValidationStart
38436>>>>>>>>>>>
38436>>>>>>>>>>>Register_Object Nomisma_Nomisma_Type_VT
38436>>>>>>>>>>>Register_Object Nomisma_Nomisma_Sign0_VT
38436>>>>>>>>>>>Register_Object Nomisma_Nomisma_Sign00_VT
38436>>>>>>>>>>>Register_Object Nomisma_Nomisma_Signr_VT
38436>>>>>>>>>>>
38436>>>>>>>>>>>Object Nomisma_Nomisma_Type_VT  is a DescriptionValidationTable
38438>>>>>>>>>>>
38438>>>>>>>>>>>    Procedure Fill_List
38440>>>>>>>>>>>        Forward Send Fill_List
38442>>>>>>>>>>>        Send Add_Table_Value  "1"  "Book1"
38443>>>>>>>>>>>        Send Add_Table_Value  "2"  "Book2"
38444>>>>>>>>>>>        Send Add_Table_Value  "3"  "Reporting"
38445>>>>>>>>>>>        Send Add_Table_Value  "0"  "Other"
38446>>>>>>>>>>>    End_Procedure    // Fill_List
38447>>>>>>>>>>>    //DDB-ValidationCustomStart
38447>>>>>>>>>>>    //DDB-ValidationCustomEnd
38447>>>>>>>>>>>End_Object   // Nomisma_Nomisma_Type_VT
38448>>>>>>>>>>>
38448>>>>>>>>>>>Object Nomisma_Nomisma_Sign0_VT  is a DescriptionValidationTable
38450>>>>>>>>>>>
38450>>>>>>>>>>>    Procedure Fill_List
38452>>>>>>>>>>>        Forward Send Fill_List
38454>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
38455>>>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
38456>>>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨œ¯ £¦"
38457>>>>>>>>>>>    End_Procedure    // Fill_List
38458>>>>>>>>>>>    //DDB-ValidationCustomStart
38458>>>>>>>>>>>    //DDB-ValidationCustomEnd
38458>>>>>>>>>>>End_Object   // Nomisma_Nomisma_Sign0_VT
38459>>>>>>>>>>>
38459>>>>>>>>>>>Object Nomisma_Nomisma_Sign00_VT  is a DescriptionValidationTable
38461>>>>>>>>>>>
38461>>>>>>>>>>>    Procedure Fill_List
38463>>>>>>>>>>>        Forward Send Fill_List
38465>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
38466>>>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
38467>>>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨â¯ £¦"
38468>>>>>>>>>>>    End_Procedure    // Fill_List
38469>>>>>>>>>>>    //DDB-ValidationCustomStart
38469>>>>>>>>>>>    //DDB-ValidationCustomEnd
38469>>>>>>>>>>>End_Object   // Nomisma_Nomisma_Sign00_VT
38470>>>>>>>>>>>
38470>>>>>>>>>>>Object Nomisma_Nomisma_Signr_VT  is a DescriptionValidationTable
38472>>>>>>>>>>>
38472>>>>>>>>>>>    Procedure Fill_List
38474>>>>>>>>>>>        Forward Send Fill_List
38476>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
38477>>>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
38478>>>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨â¯ £¦"
38479>>>>>>>>>>>    End_Procedure    // Fill_List
38480>>>>>>>>>>>    //DDB-ValidationCustomStart
38480>>>>>>>>>>>    //DDB-ValidationCustomEnd
38480>>>>>>>>>>>End_Object   // Nomisma_Nomisma_Signr_VT
38481>>>>>>>>>>>//DDB-ValidationEnd
38481>>>>>>>>>>>//DDB-SelectionStart
38481>>>>>>>>>>>//DDB/ ExternalSelectionList sl059  sl059.sl
38481>>>>>>>>>>>Register_Object sl059
38481>>>>>>>>>>>//DDB-SelectionEnd
38481>>>>>>>>>>>
38481>>>>>>>>>>>Class Nomisma_DataDictionary  is a DataDictionary_Sec
38482>>>>>>>>>>>
38482>>>>>>>>>>>    Procedure Construct_Object
38483>>>>>>>>>>>        Forward Send Construct_Object
38485>>>>>>>>>>>        Property String psOldCode Public ''
38486>>>>>>>>>>>    End_procedure
38487>>>>>>>>>>>
38487>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
38488>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
38490>>>>>>>>>>>        Set psOldCode to Nomisma.Nomisma_Code
38491>>>>>>>>>>>    End_Procedure   // New_Current_Record
38492>>>>>>>>>>>
38492>>>>>>>>>>>    Procedure Save_Main_File
38493>>>>>>>>>>>        If ((Operation_Origin<>Self) And;             (Nomisma.Recnum=0)) Procedure_Return
38496>>>>>>>>>>>        Forward Send Save_Main_File
38498>>>>>>>>>>>    End_Procedure   // Save_Main_File
38499>>>>>>>>>>>
38499>>>>>>>>>>>    Function Validate_Save  Returns Integer
38500>>>>>>>>>>>        Local Integer iReturnVal 
38501>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
38503>>>>>>>>>>>        If (Not(iReturnVal)) ;            Begin
38505>>>>>>>>>>>                     If  Nomisma.nomisma_Code eq ''                 Move 6220 to iReturnVal
38508>>>>>>>>>>>                Else If (Nomisma.Nomisma_Code <>(psOldCode(Self)) And ;                         (psOldCode(Self)<>''))  Move 6030 to iReturnVal
38512>>>>>>>>>>>                if iReturnVal Send Operation_Not_Allowed iReturnVal
38515>>>>>>>>>>>            End
38515>>>>>>>>>>>>
38515>>>>>>>>>>>        Function_Return iReturnVal
38516>>>>>>>>>>>    End_Function   // Validate_Save
38517>>>>>>>>>>>
38517>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
38518>>>>>>>>>>>             if iError_num eq 6220 error 6220 "Œ¦£ ©£˜«˜ => ‰à› ¡æª ¡œ¤æª "
38521>>>>>>>>>>>        Else if iError_num eq 6030 error 6030 "„§ ¢â¥«œ ¤æ£ ©£˜ ˜§¦ «ž¤ ¢å©«˜ £œ (F4)\nž §˜«ã©«œ §¨é«˜ F5 ©«¦ ž›ž ¬§á¨®¦¤\nà©«œ ¤˜ ¡˜Ÿ˜¨å©œ  ž ˜¨® ¡ã «¦¬ « £ã\n§¨å¤ œ§ ¢â¥œ«œ á¢¢¦"
38525>>>>>>>>>>>        //Else if iError_num eq 6030 error 6030 "ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ©«¦ ¡à› ¡æ ¤¦£å©£˜«¦ª"
38525>>>>>>>>>>>        else Forward Send Operation_Not_Allowed  iError_Num
38528>>>>>>>>>>>    End_Procedure   // Operation_Not_Allowed
38529>>>>>>>>>>>
38529>>>>>>>>>>>    Procedure Update
38530>>>>>>>>>>>        Forward Send Update
38532>>>>>>>>>>>        // Insert Code Here
38532>>>>>>>>>>>        SYSDATE NOMISMA.LUP
38533>>>>>>>>>>>    End_Procedure   // Update
38534>>>>>>>>>>>
38534>>>>>>>>>>>    Procedure Creating
38535>>>>>>>>>>>        Forward Send Creating
38537>>>>>>>>>>>        // Insert Code Here
38537>>>>>>>>>>>        SYSDATE NOMISMA.FUP
38538>>>>>>>>>>>    End_Procedure   // Creating
38539>>>>>>>>>>>
38539>>>>>>>>>>>    // Define_Fields:
38539>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38539>>>>>>>>>>>
38539>>>>>>>>>>>    Procedure Define_Fields
38540>>>>>>>>>>>        Forward Send Define_Fields
38542>>>>>>>>>>>        //DDB-Generated-Code-Location
38542>>>>>>>>>>>        //DDB-DefineFieldStart
38542>>>>>>>>>>>
38542>>>>>>>>>>>        Set Main_File            To Nomisma.File_Number
38543>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
38544>>>>>>>>>>>
38544>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38545>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38546>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38547>>>>>>>>>>>
38547>>>>>>>>>>>        // Child (Client) file structure................
38547>>>>>>>>>>>        Send Add_Client_File  Isotimia.File_Number
38548>>>>>>>>>>>        Send Add_Client_File  Particle.File_Number
38549>>>>>>>>>>>
38549>>>>>>>>>>>        // Field-based properties.......................
38549>>>>>>>>>>>
38549>>>>>>>>>>>        // Nomisma.Nomisma_Code
38549>>>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Code To DD_AUTOFIND    DD_CAPSLOCK   
38550>>>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Code To (sl059(Self))
38551>>>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Code To TRUE
38552>>>>>>>>>>>
38552>>>>>>>>>>>        // Nomisma.Nomisma_Descr
38552>>>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Descr To DD_CAPSLOCK   
38553>>>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Descr To (sl059(Self))
38554>>>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Descr To TRUE
38555>>>>>>>>>>>
38555>>>>>>>>>>>        // Nomisma.Nomisma_Short
38555>>>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Short To DD_CAPSLOCK   
38556>>>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Short To (sl059(Self))
38557>>>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Short To TRUE
38558>>>>>>>>>>>
38558>>>>>>>>>>>        // Nomisma.Dekadika
38558>>>>>>>>>>>
38558>>>>>>>>>>>        // Nomisma.Fup
38558>>>>>>>>>>>
38558>>>>>>>>>>>        // Nomisma.Lup
38558>>>>>>>>>>>
38558>>>>>>>>>>>        // Nomisma.Euro_Zone
38558>>>>>>>>>>>
38558>>>>>>>>>>>        // Nomisma.Einai_Drx
38558>>>>>>>>>>>
38558>>>>>>>>>>>        // Nomisma.Einai_Euro
38558>>>>>>>>>>>
38558>>>>>>>>>>>        // Nomisma.Monades
38558>>>>>>>>>>>
38558>>>>>>>>>>>        // Nomisma.Kl_Isot_Euro
38558>>>>>>>>>>>
38558>>>>>>>>>>>        // Nomisma.Nomisma_Type
38558>>>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Type To (Nomisma_Nomisma_Type_VT(Self))
38559>>>>>>>>>>>
38559>>>>>>>>>>>        // Nomisma.Nomisma_Sign0
38559>>>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Sign0 To (Nomisma_Nomisma_Sign0_VT(Self))
38560>>>>>>>>>>>
38560>>>>>>>>>>>        // Nomisma.Nomisma_Sign00
38560>>>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Sign00 To (Nomisma_Nomisma_Sign00_VT(Self))
38561>>>>>>>>>>>
38561>>>>>>>>>>>        // Nomisma.Nomisma_Signr
38561>>>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Signr To (Nomisma_Nomisma_Signr_VT(Self))
38562>>>>>>>>>>>
38562>>>>>>>>>>>        //DDB-DefineFieldEnd
38562>>>>>>>>>>>    End_Procedure    // Define_Fields
38563>>>>>>>>>>>
38563>>>>>>>>>>>    // Field_Defaults:
38563>>>>>>>>>>>    // This procedure is used to establish default field values.
38563>>>>>>>>>>>
38563>>>>>>>>>>>    Procedure Field_Defaults
38564>>>>>>>>>>>        Forward Send Field_Defaults
38566>>>>>>>>>>>        //DDB-Generated-Code-Location
38566>>>>>>>>>>>        //DDB-FieldDefaultStart
38566>>>>>>>>>>>        //DDB-FieldDefaultEnd
38566>>>>>>>>>>>    End_Procedure    // Field_Defaults
38567>>>>>>>>>>>
38567>>>>>>>>>>>End_Class    // Nomisma_DataDictionary
38568>>>>>>>>>>>//DDB-Selection-pkg-Start
38568>>>>>>>>>>>
38568>>>>>>>>>>>Use sl059.sl         // sl059
INCLUDING FILE: SL059.SL
38568>>>>>>>>>>>>>//AB/ Project sl059
38568>>>>>>>>>>>>>//AB/     Object prj is a LOOKUP_Project
38568>>>>>>>>>>>>>//AB/         Set ProjectName to "sl059"
38568>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl059.SL"
38568>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
38568>>>>>>>>>>>>>
38568>>>>>>>>>>>>>    //AB-IgnoreStart
38568>>>>>>>>>>>>>
38568>>>>>>>>>>>>>
38568>>>>>>>>>>>>>
38568>>>>>>>>>>>>>
38568>>>>>>>>>>>>>    Use NOMISMA.DD
38568>>>>>>>>>>>>>
38568>>>>>>>>>>>>>    //AB-IgnoreEnd
38568>>>>>>>>>>>>>
38568>>>>>>>>>>>>>    CD_Popup_Object sl059 is a dbModalPanelSub
38587>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
38588>>>>>>>>>>>>>        Set Modal_State to FALSE
38589>>>>>>>>>>>>>        Set Popup_State to FALSE
38590>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
38591>>>>>>>>>>>>>        set label to "Œ¦£å©£˜«˜" 
38592>>>>>>>>>>>>>        Set Size to 148 295
38593>>>>>>>>>>>>>        Set Location to 4 5
38594>>>>>>>>>>>>>
38594>>>>>>>>>>>>>        //AB-DDOStart
38594>>>>>>>>>>>>>
38594>>>>>>>>>>>>>        Object Nomisma_DD is a Nomisma_DataDictionary
38596>>>>>>>>>>>>>        End_Object    // Nomisma_DD
38597>>>>>>>>>>>>>
38597>>>>>>>>>>>>>        Set Main_DD to (Nomisma_DD(Current_Object))
38598>>>>>>>>>>>>>        Set Server to (Nomisma_DD(Current_Object))
38599>>>>>>>>>>>>>
38599>>>>>>>>>>>>>        //AB-DDOEnd
38599>>>>>>>>>>>>>
38599>>>>>>>>>>>>>        Object oSelList is a dbListSub
38601>>>>>>>>>>>>>            Set Main_File to Nomisma.File_Number
38602>>>>>>>>>>>>>            Set Size to 105 278
38603>>>>>>>>>>>>>            Set Location to 6 6
38604>>>>>>>>>>>>>
38604>>>>>>>>>>>>>            Begin_Row
38607>>>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_code
38608>>>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_descr
38609>>>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_short
38610>>>>>>>>>>>>>                Entry_Item Nomisma.Dekadika
38611>>>>>>>>>>>>>            End_Row
38616>>>>>>>>>>>>>
38616>>>>>>>>>>>>>            Set Form_Width    item 0 to 45
38617>>>>>>>>>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
38618>>>>>>>>>>>>>
38618>>>>>>>>>>>>>            Set Form_Width    item 1 to 115
38619>>>>>>>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
38620>>>>>>>>>>>>>
38620>>>>>>>>>>>>>            Set Form_Width    item 2 to 58
38621>>>>>>>>>>>>>            set header_label  item 2 to "‘ç¤«¦£ž" 
38622>>>>>>>>>>>>>
38622>>>>>>>>>>>>>            Set Form_Width    item 3 to 54
38623>>>>>>>>>>>>>            set header_label  item 3 to "ƒœ¡˜› ¡á" 
38624>>>>>>>>>>>>>
38624>>>>>>>>>>>>>        End_Object    // oSelList
38625>>>>>>>>>>>>>
38625>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
38627>>>>>>>>>>>>>            set label to "&„§ ¢¦šã" 
38628>>>>>>>>>>>>>            Set Location to 113 124
38629>>>>>>>>>>>>>
38629>>>>>>>>>>>>>            //AB-StoreStart
38629>>>>>>>>>>>>>            Procedure OnClick
38631>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
38632>>>>>>>>>>>>>            End_Procedure
38633>>>>>>>>>>>>>            //AB-StoreEnd
38633>>>>>>>>>>>>>
38633>>>>>>>>>>>>>        End_Object    // oOK_bn
38634>>>>>>>>>>>>>
38634>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
38636>>>>>>>>>>>>>            set label to "&€¡ç¨à©ž" 
38637>>>>>>>>>>>>>            Set Location to 113 179
38638>>>>>>>>>>>>>
38638>>>>>>>>>>>>>            //AB-StoreStart
38638>>>>>>>>>>>>>            Procedure OnClick
38640>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
38641>>>>>>>>>>>>>            End_Procedure
38642>>>>>>>>>>>>>            //AB-StoreEnd
38642>>>>>>>>>>>>>
38642>>>>>>>>>>>>>        End_Object    // oCancel_bn
38643>>>>>>>>>>>>>
38643>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
38645>>>>>>>>>>>>>            set label to "€&¤˜ã«ž©ž" 
38646>>>>>>>>>>>>>            Set Location to 113 234
38647>>>>>>>>>>>>>
38647>>>>>>>>>>>>>            //AB-StoreStart
38647>>>>>>>>>>>>>            Procedure OnClick
38649>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
38650>>>>>>>>>>>>>            End_Procedure
38651>>>>>>>>>>>>>            //AB-StoreEnd
38651>>>>>>>>>>>>>
38651>>>>>>>>>>>>>        End_Object    // oSearch_bn
38652>>>>>>>>>>>>>
38652>>>>>>>>>>>>>
38652>>>>>>>>>>>>>        //AB-StoreStart
38652>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
38653>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
38654>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
38655>>>>>>>>>>>>>        //AB-StoreEnd
38655>>>>>>>>>>>>>
38655>>>>>>>>>>>>>    CD_End_Object    // sl059
38657>>>>>>>>>>>>>>
38657>>>>>>>>>>>>>
38657>>>>>>>>>>>>>//AB/     End_Object    // prj
38657>>>>>>>>>>>
38657>>>>>>>>>>>//DDB-Selection-pkg-End
38657>>>>>>>>>>>//DDB-FileEnd
38657>>>>>>>>>
38657>>>>>>>>>//AB-IgnoreEnd
38657>>>>>>>>>
38657>>>>>>>>>Object slNomism is a dbModalPanelSub
38659>>>>>>>>>
38659>>>>>>>>>    //AB-StoreTopStart
38659>>>>>>>>>    
38659>>>>>>>>>    
38659>>>>>>>>>    
38659>>>>>>>>>    //AB-StoreTopEnd
38659>>>>>>>>>
38659>>>>>>>>>    Set Label to "Œ¦£å©£˜«˜"
38660>>>>>>>>>    Set Size to 175 397
38661>>>>>>>>>    Set Location to 5 7
38662>>>>>>>>>    Set Exit_Application_Local_State to FALSE
38663>>>>>>>>>    Set Modal_State to FALSE
38664>>>>>>>>>
38664>>>>>>>>>    //AB-DDOStart
38664>>>>>>>>>
38664>>>>>>>>>    Object Nomisma_DD is a Nomisma_DataDictionary
38666>>>>>>>>>    End_Object    // Nomisma_DD
38667>>>>>>>>>
38667>>>>>>>>>    Set Main_DD to (Nomisma_DD(self))
38668>>>>>>>>>    Set Server to (Nomisma_DD(self))
38669>>>>>>>>>
38669>>>>>>>>>    //AB-DDOEnd
38669>>>>>>>>>
38669>>>>>>>>>    Object oSelList is a dbListSub
38671>>>>>>>>>        Set Main_File to Nomisma.File_Number
38672>>>>>>>>>        Set Size to 130 382
38673>>>>>>>>>        Set Location to 6 6
38674>>>>>>>>>
38674>>>>>>>>>        Begin_Row
38677>>>>>>>>>            Entry_Item Nomisma.Nomisma_code
38678>>>>>>>>>            Entry_Item Nomisma.Nomisma_descr
38679>>>>>>>>>            Entry_Item Nomisma.Dekadika
38680>>>>>>>>>            Entry_Item Nomisma.Euro_zone
38681>>>>>>>>>            Entry_Item Nomisma.Einai_drx
38682>>>>>>>>>            Entry_Item Nomisma.Einai_euro
38683>>>>>>>>>        End_Row
38688>>>>>>>>>
38688>>>>>>>>>        Set Form_Width    item 0 to 49
38689>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
38690>>>>>>>>>        
38690>>>>>>>>>        Set Form_Width    item 1 to 115
38691>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
38692>>>>>>>>>        
38692>>>>>>>>>        Set Form_Width    item 2 to 47
38693>>>>>>>>>        Set Header_Label  item 2 to "ƒœ¡˜› ¡á"
38694>>>>>>>>>        
38694>>>>>>>>>        Set Form_Width    item 3 to 55
38695>>>>>>>>>        Set Header_Label  item 3 to "…é¤ž EURO"
38696>>>>>>>>>        Set Column_Checkbox_State  item 3 to True
38697>>>>>>>>>        
38697>>>>>>>>>        Set Form_Width    item 4 to 55
38698>>>>>>>>>        Set Header_Label  item 4 to "„å¤˜  ƒ•"
38699>>>>>>>>>        Set Column_Checkbox_State  item 4 to True
38700>>>>>>>>>        
38700>>>>>>>>>        Set Form_Width    item 5 to 55
38701>>>>>>>>>        Set Header_Label  item 5 to "„å¤˜  „¬¨é"
38702>>>>>>>>>        Set Column_Checkbox_State  item 5 to True
38703>>>>>>>>>        
38703>>>>>>>>>
38703>>>>>>>>>        //AB-StoreStart
38703>>>>>>>>>        
38703>>>>>>>>>        //AB-StoreEnd
38703>>>>>>>>>
38703>>>>>>>>>    End_Object    // oSelList
38704>>>>>>>>>
38704>>>>>>>>>    Object oOK_bn is a ButtonSub
38706>>>>>>>>>        Set Label to "&„§ ¢¦šã"
38707>>>>>>>>>        Set Location to 140 279
38708>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
38709>>>>>>>>>
38709>>>>>>>>>        //AB-StoreStart
38709>>>>>>>>>        Procedure OnClick
38711>>>>>>>>>            Send OK To (oSelList(current_object))
38712>>>>>>>>>        End_Procedure
38713>>>>>>>>>        //AB-StoreEnd
38713>>>>>>>>>
38713>>>>>>>>>    End_Object    // oOK_bn
38714>>>>>>>>>
38714>>>>>>>>>    Object oSearch_bn is a ButtonSub
38716>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
38717>>>>>>>>>        Set Location to 140 339
38718>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
38719>>>>>>>>>
38719>>>>>>>>>        //AB-StoreStart
38719>>>>>>>>>        
38719>>>>>>>>>        Procedure OnClick
38721>>>>>>>>>            Send Search To (oSelList(current_object))
38722>>>>>>>>>        End_Procedure
38723>>>>>>>>>        
38723>>>>>>>>>        
38723>>>>>>>>>        Set Visible_State to False
38724>>>>>>>>>        Set Enabled_State to False
38725>>>>>>>>>        //AB-StoreEnd
38725>>>>>>>>>
38725>>>>>>>>>    End_Object    // oSearch_bn
38726>>>>>>>>>
38726>>>>>>>>>
38726>>>>>>>>>    //AB-StoreStart
38726>>>>>>>>>    
38726>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
38727>>>>>>>>>    
38727>>>>>>>>>    On_Key Key_Alt+Key_s Send KeyAction To (oSearch_bn(current_object))
38728>>>>>>>>>    
38728>>>>>>>>>    
38728>>>>>>>>>    
38728>>>>>>>>>    
38728>>>>>>>>>    //AB-StoreEnd
38728>>>>>>>>>
38728>>>>>>>>>End_Object    // slNomism
38729>>>>>>>>>
38729>>>>>>>>>//AB/ End_Object    // prj
38729>>>>>>>Use sl041.SL         // sl041
INCLUDING FILE: SL041.SL
38729>>>>>>>>>//AB/ Project CN : sl041
38729>>>>>>>>>//AB/     Object prj is a Lookup_Project
38729>>>>>>>>>//AB/         Set ProjectName to "CN : sl041"
38729>>>>>>>>>//AB/         Set ProjectFileName to "sl041.SL"
38729>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
38729>>>>>>>>>
38729>>>>>>>>>// Project Object Structure
38729>>>>>>>>>//   sl041 is a dbModalPanelSub
38729>>>>>>>>>//     Clients_DD is a DataDictionary
38729>>>>>>>>>//     Cn_DD is a DataDictionary
38729>>>>>>>>>//     oSelList is a dbListSub
38729>>>>>>>>>//     oOK_bn is a ButtonSub
38729>>>>>>>>>//     oCancel_bn is a ButtonSub
38729>>>>>>>>>//     oSearch_bn is a ButtonSub
38729>>>>>>>>>
38729>>>>>>>>>// Register all objects
38729>>>>>>>>>Register_Object Clients_DD
38729>>>>>>>>>Register_Object Cn_DD
38729>>>>>>>>>Register_Object oCancel_bn
38729>>>>>>>>>Register_Object oOK_bn
38729>>>>>>>>>Register_Object oSearch_bn
38729>>>>>>>>>Register_Object oSelList
38729>>>>>>>>>Register_Object sl041
38729>>>>>>>>>
38729>>>>>>>>>
38729>>>>>>>>>    //AB-IgnoreStart
38729>>>>>>>>>
38729>>>>>>>>>    Use DFAllEnt.pkg
38729>>>>>>>>>    Use dbList.Sub
38729>>>>>>>>>    Use Button.Sub
38729>>>>>>>>>
38729>>>>>>>>>
38729>>>>>>>>>    Use CLIENTS.DD
38729>>>>>>>>>    Use CN.DD
INCLUDING FILE: CN.DD
38729>>>>>>>>>>>//DDB-FileStart
38729>>>>>>>>>>>//DDB-HeaderStart
38729>>>>>>>>>>>
38729>>>>>>>>>>>// File Name : CN.DD
38729>>>>>>>>>>>// Class Name: Cn_DataDictionary
38729>>>>>>>>>>>// Revision  : 99
38729>>>>>>>>>>>// Version   : 2
38729>>>>>>>>>>>
38729>>>>>>>>>>>Use  Windows           // Basic Definitions
38729>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
38729>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38729>>>>>>>>>>>
38729>>>>>>>>>>>Open Cn
38731>>>>>>>>>>>Open Cnzones
INCLUDING FILE: CNZONES.FD
38733>>>>>>>>>>>Open Tperga
INCLUDING FILE: TPERGA.FD
38735>>>>>>>>>>>Open Btnordh
INCLUDING FILE: BTNORDH.FD
38737>>>>>>>>>>>Open Dorderh
INCLUDING FILE: DORDERH.FD
38739>>>>>>>>>>>Open Clients
38741>>>>>>>>>>>Open Salesmen
38743>>>>>>>>>>>Open Mhxanik
38745>>>>>>>>>>>Open Constrct
38747>>>>>>>>>>>Open Sysrecc
38749>>>>>>>>>>>Open Syscurxr
38751>>>>>>>>>>>Open Gmove
38753>>>>>>>>>>>Open Sysrecg
38755>>>>>>>>>>>
38755>>>>>>>>>>>//DDB-HeaderEnd
38755>>>>>>>>>>>//DDB-ValidationStart
38755>>>>>>>>>>>
38755>>>>>>>>>>>Register_Object Cn_Cn_Categfpa_VT1
38755>>>>>>>>>>>Register_Object Cn_Tropos_Metaf_VT
38755>>>>>>>>>>>Register_Object Cn_Eidos_Cn_VT
38755>>>>>>>>>>>Register_Object Cn_Yesno_VT
38755>>>>>>>>>>>
38755>>>>>>>>>>>Object Cn_Cn_Categfpa_VT1  is a CodeValidationTable
38757>>>>>>>>>>>    Set Type_Value        To "VAT_STATUS"
38758>>>>>>>>>>>    Set Validate_State    To FALSE
38759>>>>>>>>>>>    Set Allow_Blank_State To TRUE
38760>>>>>>>>>>>    //DDB-ValidationCustomStart
38760>>>>>>>>>>>    //DDB-ValidationCustomEnd
38760>>>>>>>>>>>End_Object   // Cn_Cn_Categfpa_VT1
38761>>>>>>>>>>>
38761>>>>>>>>>>>Object Cn_Tropos_Metaf_VT  is a CodeValidationTable
38763>>>>>>>>>>>    Set Type_Value        To "FORTOSH"
38764>>>>>>>>>>>    Set Allow_Blank_State To TRUE
38765>>>>>>>>>>>    Set Table_Title       To "’¨æ§¦  ‹œ«˜­¦¨áª"
38766>>>>>>>>>>>    //DDB-ValidationCustomStart
38766>>>>>>>>>>>    //DDB-ValidationCustomEnd
38766>>>>>>>>>>>End_Object   // Cn_Tropos_Metaf_VT
38767>>>>>>>>>>>
38767>>>>>>>>>>>Object Cn_Eidos_Cn_VT  is a CodeValidationTable
38769>>>>>>>>>>>    Set Type_Value        To "EIDOSCN"
38770>>>>>>>>>>>    Set Allow_Blank_State To TRUE
38771>>>>>>>>>>>    Set Table_Title       To "„å›¦ª „¨š¦¬"
38772>>>>>>>>>>>    //DDB-ValidationCustomStart
38772>>>>>>>>>>>    //DDB-ValidationCustomEnd
38772>>>>>>>>>>>End_Object   // Cn_Eidos_Cn_VT
38773>>>>>>>>>>>
38773>>>>>>>>>>>Object Cn_Yesno_VT  is a CodeValidationTable
38775>>>>>>>>>>>    Set Type_Value        To "YESNO"
38776>>>>>>>>>>>    Set Allow_Blank_State To TRUE
38777>>>>>>>>>>>    //DDB-ValidationCustomStart
38777>>>>>>>>>>>    //DDB-ValidationCustomEnd
38777>>>>>>>>>>>End_Object   // Cn_Yesno_VT
38778>>>>>>>>>>>//DDB-ValidationEnd
38778>>>>>>>>>>>//DDB-SelectionStart
38778>>>>>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.sl
38778>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
38778>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
38778>>>>>>>>>>>Register_Object sl041
38778>>>>>>>>>>>Register_Object sl198
38778>>>>>>>>>>>Register_Object sl197
38778>>>>>>>>>>>//DDB-SelectionEnd
38778>>>>>>>>>>>
38778>>>>>>>>>>>Class Cn_DataDictionary  is a DataDictionary_Sec
38779>>>>>>>>>>>
38779>>>>>>>>>>>
38779>>>>>>>>>>>    Procedure Construct_Object
38780>>>>>>>>>>>        Forward Send Construct_Object
38782>>>>>>>>>>>        //------------------------------------------------
38782>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
38782>>>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
38782>>>>>>>>>>>        // einai 1     js 03/12/2007
38782>>>>>>>>>>>        //------------------------------------------------  
38782>>>>>>>>>>>        Property Integer piCreateNew            Public  0
38783>>>>>>>>>>>        Property String  psAud_Old_CN           Public ""
38784>>>>>>>>>>>        Property String  psAud_Old_CNAdd        Public ""
38785>>>>>>>>>>>        Property String  psAud_Old_Chem         Public ""
38786>>>>>>>>>>>        Property String  psAud_Old_CNRecr       Public ""
38787>>>>>>>>>>>        //------------------------------------------------
38787>>>>>>>>>>>
38787>>>>>>>>>>>    End_procedure
38788>>>>>>>>>>>
38788>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
38789>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
38791>>>>>>>>>>>        //------------------------------------------------
38791>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
38791>>>>>>>>>>>        // ton pedion js 03/12/2007
38791>>>>>>>>>>>        //------------------------------------------------
38791>>>>>>>>>>>        Set psAud_Old_CN           to CN.CN_Code
38792>>>>>>>>>>>        Set psAud_Old_CNAdd        to CN.CN_Descr
38793>>>>>>>>>>>        Set psAud_Old_Chem         to CN.CN_VTicket
38794>>>>>>>>>>>        Set psAud_Old_CNRecr       to CN.CN_Recr
38795>>>>>>>>>>>        //------------------------------------------------
38795>>>>>>>>>>>     End_Procedure   // New_Current_Record
38796>>>>>>>>>>>
38796>>>>>>>>>>>    Procedure Delete_Main_File
38797>>>>>>>>>>>        //---------------------------------------------
38797>>>>>>>>>>>        // Auditing / Katagrafh allagon
38797>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
38798>>>>>>>>>>>        Date    dDate  Shmer 
38798>>>>>>>>>>>        Integer iMin iHour iSec iLen
38798>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
38802>>>>>>>>>>>        Move iHour  to sHour
38803>>>>>>>>>>>        Move iMin   to sMin
38804>>>>>>>>>>>        Move iSec   to sSec
38805>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
38809>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
38813>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
38817>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
38818>>>>>>>>>>>        
38818>>>>>>>>>>>        // Auditing / Diagrafh 
38818>>>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
38820>>>>>>>>>>>            Get fsLoginUserID to sUser
38821>>>>>>>>>>>            clear gmove
38822>>>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
38823>>>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
38824>>>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
38825>>>>>>>>>>>            move  4                     to gmove.gtypkin_code// Apo Clients
38826>>>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
38827>>>>>>>>>>>            move suser                  to gmove.gplan_code
38828>>>>>>>>>>>            move CN.CN_Recr             to gmove.garticl_recr
38829>>>>>>>>>>>            reread sysrecg
38833>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
38834>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
38835>>>>>>>>>>>            saverecord sysrecg
38836>>>>>>>>>>>            unlock
38837>>>>>>>>>>>>
38837>>>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
38838>>>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
38839>>>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
38840>>>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
38841>>>>>>>>>>>            
38841>>>>>>>>>>>            Move CN.CN_Recr                     to Gmove.Partl_Recr          
38842>>>>>>>>>>>            Move CN.CN_Recr                     to Gmove.Pms_Recr          
38843>>>>>>>>>>>
38843>>>>>>>>>>>            Move (psAud_Old_CN    (Self))       to Gmove.Prev_CN
38844>>>>>>>>>>>            Move (psAud_Old_CNAdd (Self))       to Gmove.Prev_CN_Addr
38845>>>>>>>>>>>            Move (psAud_Old_Chem  (Self))       to Gmove.Prev_CN_Prosth
38846>>>>>>>>>>>
38846>>>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª ë¨š¦¬"      to gmove.gmove_aitiol
38847>>>>>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
38848>>>>>>>>>>>            saverecord gmove
38849>>>>>>>>>>>        End
38849>>>>>>>>>>>>
38849>>>>>>>>>>>        Forward Send Delete_Main_File
38851>>>>>>>>>>>
38851>>>>>>>>>>>    End_Procedure
38852>>>>>>>>>>>
38852>>>>>>>>>>>    Procedure Update
38853>>>>>>>>>>>        Forward Send Update
38855>>>>>>>>>>>        // Insert Code Here
38855>>>>>>>>>>>        Move SysCurXR.Company_Code  to CN.Company_Code
38856>>>>>>>>>>>        Move SysCurXR.Branch_Code   to CN.Branch_Code
38857>>>>>>>>>>>        Move SysCurXR.Year_Year     to CN.Year_Year
38858>>>>>>>>>>>        //Move Custprom.Custprom_Code to CN.Custprom_Code
38858>>>>>>>>>>>        Move Clients.Client_ID      to CN.Client_ID
38859>>>>>>>>>>>
38859>>>>>>>>>>>        Move SysCurXR.Beto_Site      to CN.Cn_SiteW
38860>>>>>>>>>>>        Move Cn.Cn_Rec0              to CN.Cn_SN
38861>>>>>>>>>>>        Move Cn.Client_id            to Cn.Cn_clientid
38862>>>>>>>>>>>        Move Cn.cn_code              to Cn.Cn_Repmatch
38863>>>>>>>>>>>        Move Cn.Cn_Code              to Cn.Constraction_ID
38864>>>>>>>>>>>        Move PayResp.Presp_ID        to Cn.Cn_Presp_ID
38865>>>>>>>>>>>        Move Salesmen.Sls_ID         to Cn.Cn_Sls_ID
38866>>>>>>>>>>>        Move Constrct.Cnt_ID         to Cn.Cn_Cnt_ID
38867>>>>>>>>>>>        Move mhxanik.mhx_id          to Cn.mhxanik_ID
38868>>>>>>>>>>>
38868>>>>>>>>>>>        //---------------------------------------------
38868>>>>>>>>>>>        // Auditing / Katagrafh allagon
38868>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
38869>>>>>>>>>>>        Date    dDate  Shmer 
38869>>>>>>>>>>>        Integer iMin iHour iSec iLen
38869>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
38873>>>>>>>>>>>        Move iHour  to sHour
38874>>>>>>>>>>>        Move iMin   to sMin
38875>>>>>>>>>>>        Move iSec   to sSec
38876>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
38880>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
38884>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
38888>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
38889>>>>>>>>>>>        
38889>>>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
38889>>>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
38891>>>>>>>>>>>            Get fsLoginUserID to sUser
38892>>>>>>>>>>>            If (piCreateNew(Self)=1) Begin
38894>>>>>>>>>>>                clear gmove
38895>>>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
38896>>>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
38897>>>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
38898>>>>>>>>>>>                move  4                     to gmove.gtypkin_code// Apo Clients
38899>>>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
38900>>>>>>>>>>>                move suser                  to gmove.gplan_code
38901>>>>>>>>>>>                move CN.CN_Recr             to gmove.garticl_recr
38902>>>>>>>>>>>                reread sysrecg
38906>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
38907>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
38908>>>>>>>>>>>                saverecord sysrecg
38909>>>>>>>>>>>                unlock
38910>>>>>>>>>>>>
38910>>>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
38911>>>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
38912>>>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
38913>>>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
38914>>>>>>>>>>>
38914>>>>>>>>>>>                Move CN.CN_Recr                 to Gmove.Partl_Recr          
38915>>>>>>>>>>>                Move CN.CN_Recr                 to Gmove.Pms_Recr          
38916>>>>>>>>>>>
38916>>>>>>>>>>>                Move CN.CN_Code                 to Gmove.Cur_CN
38917>>>>>>>>>>>                Move CN.CN_Descr                to Gmove.Cur_CN_Addr
38918>>>>>>>>>>>                Move CN.CN_VTicket              to Gmove.Cur_CN_Prosth
38919>>>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â¦¬ ë¨š¦¬"    to Gmove.Gmove_Aitiol
38920>>>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs  
38921>>>>>>>>>>>                saverecord gmove
38922>>>>>>>>>>>                Set piCreateNew to 0
38923>>>>>>>>>>>            End
38923>>>>>>>>>>>>
38923>>>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
38926>>>>>>>>>>>                Integer isChanged
38926>>>>>>>>>>>                Move 0 to isChanged
38927>>>>>>>>>>>                
38927>>>>>>>>>>>                     If (psAud_Old_CN   (Self)<>CN.CN_Code   ) Move 1 to isChanged
38930>>>>>>>>>>>                Else If (psAud_Old_CNAdd(Self)<>CN.CN_Descr  ) Move 1 to isChanged
38934>>>>>>>>>>>                Else If (psAud_Old_Chem (Self)<>CN.CN_VTicket) Move 1 to isChanged
38938>>>>>>>>>>>                
38938>>>>>>>>>>>                If (isChanged>0) Begin  
38940>>>>>>>>>>>                    clear gmove
38941>>>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
38942>>>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
38943>>>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
38944>>>>>>>>>>>                    move  4                     to gmove.gtypkin_code// Apo Clients
38945>>>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
38946>>>>>>>>>>>                    move suser                  to gmove.gplan_code
38947>>>>>>>>>>>                    move Payresp.Presp_Recr    to gmove.garticl_recr
38948>>>>>>>>>>>                    reread sysrecg
38952>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
38953>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
38954>>>>>>>>>>>                    saverecord sysrecg
38955>>>>>>>>>>>                    unlock
38956>>>>>>>>>>>>
38956>>>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
38957>>>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
38958>>>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
38959>>>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
38960>>>>>>>>>>>                    Move CN.CN_Recr                     to Gmove.Partl_Recr          
38961>>>>>>>>>>>                    Move CN.CN_Recr                     to Gmove.Pms_Recr          
38962>>>>>>>>>>>                    //--                                
38962>>>>>>>>>>>                    Move CN.CN_Code                     to Gmove.Cur_CN
38963>>>>>>>>>>>                    Move CN.CN_Descr                    to Gmove.Cur_CN_Addr
38964>>>>>>>>>>>                    Move CN.CN_VTicket                  to Gmove.Cur_CN_Prosth
38965>>>>>>>>>>>                    //--
38965>>>>>>>>>>>                    Move (psAud_Old_CN    (Self))       to Gmove.Prev_CN
38966>>>>>>>>>>>                    Move (psAud_Old_CNAdd (Self))       to Gmove.Prev_CN_Addr
38967>>>>>>>>>>>                    Move (psAud_Old_Chem  (Self))       to Gmove.Prev_CN_Prosth
38968>>>>>>>>>>>
38968>>>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª ë¨š¦¬"      to gmove.gmove_aitiol
38969>>>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
38970>>>>>>>>>>>                    saverecord gmove
38971>>>>>>>>>>>                    Set piCreateNew to 0
38972>>>>>>>>>>>                End
38972>>>>>>>>>>>>
38972>>>>>>>>>>>            End
38972>>>>>>>>>>>>
38972>>>>>>>>>>>        End
38972>>>>>>>>>>>>
38972>>>>>>>>>>>
38972>>>>>>>>>>>
38972>>>>>>>>>>>    End_Procedure   // Update
38973>>>>>>>>>>>
38973>>>>>>>>>>>     Procedure Creating
38974>>>>>>>>>>>        Forward Send Creating
38976>>>>>>>>>>>        // Insert Code Here
38976>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(CN.CN_Rec0)))))) to CN.CN_Recr
38977>>>>>>>>>>>        Get fsgCode_With_Zeroes CN.CN_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to CN.CN_Code
38978>>>>>>>>>>>        Set piCreateNew to 1
38979>>>>>>>>>>>    End_Procedure   // Creating
38980>>>>>>>>>>>
38980>>>>>>>>>>>
38980>>>>>>>>>>>
38980>>>>>>>>>>>    // Define_Fields:
38980>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38980>>>>>>>>>>>
38980>>>>>>>>>>>    Procedure Define_Fields
38981>>>>>>>>>>>        Forward Send Define_Fields
38983>>>>>>>>>>>        //DDB-Generated-Code-Location
38983>>>>>>>>>>>        //DDB-DefineFieldStart
38983>>>>>>>>>>>
38983>>>>>>>>>>>        Set Main_File            To Cn.File_Number
38984>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
38985>>>>>>>>>>>
38985>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38986>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38987>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38988>>>>>>>>>>>
38988>>>>>>>>>>>        // Child (Client) file structure................
38988>>>>>>>>>>>        Send Add_Client_File  Cnzones.File_Number
38989>>>>>>>>>>>        Send Add_Client_File  Tperga.File_Number
38990>>>>>>>>>>>        Send Add_Client_File  Btnordh.File_Number
38991>>>>>>>>>>>        Send Add_Client_File  Dorderh.File_Number
38992>>>>>>>>>>>
38992>>>>>>>>>>>        // Parent (Server) file structure...............
38992>>>>>>>>>>>        Send Add_Server_File  Clients.File_Number
38993>>>>>>>>>>>        Send Add_Server_File  Salesmen.File_Number
38994>>>>>>>>>>>        Send Add_Server_File  Mhxanik.File_Number
38995>>>>>>>>>>>        Send Add_Server_File  Constrct.File_Number
38996>>>>>>>>>>>
38996>>>>>>>>>>>        // External (System) file structure.............
38996>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
38997>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
38998>>>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
38999>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
39000>>>>>>>>>>>
39000>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Cn_Rec0  To Cn.Cn_Rec0
39003>>>>>>>>>>>
39003>>>>>>>>>>>        // Field-based properties.......................
39003>>>>>>>>>>>
39003>>>>>>>>>>>        // Cn.Company_Code
39003>>>>>>>>>>>
39003>>>>>>>>>>>        // Cn.Branch_Code
39003>>>>>>>>>>>
39003>>>>>>>>>>>        // Cn.Year_Year
39003>>>>>>>>>>>
39003>>>>>>>>>>>        // Cn.Custprom_Code
39003>>>>>>>>>>>
39003>>>>>>>>>>>        // Cn.Client_Id
39003>>>>>>>>>>>
39003>>>>>>>>>>>        // Cn.Cn_Code
39003>>>>>>>>>>>        Set Field_Options          Field Cn.Cn_Code To DD_AUTOFIND    DD_NOPUT      
39004>>>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Code To (sl041(Self))
39005>>>>>>>>>>>        Set Key_Field_State        Field Cn.Cn_Code To TRUE
39006>>>>>>>>>>>
39006>>>>>>>>>>>        // Cn.Client_Recr
39006>>>>>>>>>>>
39006>>>>>>>>>>>        // Cn.Cn_Rec0
39006>>>>>>>>>>>
39006>>>>>>>>>>>        // Cn.Cn_Recr
39006>>>>>>>>>>>
39006>>>>>>>>>>>        // Cn.Cn_Descr
39006>>>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Descr To (sl041(Self))
39007>>>>>>>>>>>
39007>>>>>>>>>>>        // Cn.Cn_Address
39007>>>>>>>>>>>
39007>>>>>>>>>>>        // Cn.Cn_Zipcode
39007>>>>>>>>>>>
39007>>>>>>>>>>>        // Cn.Cn_City
39007>>>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_City To (sl198(Self))
39008>>>>>>>>>>>
39008>>>>>>>>>>>        // Cn.Cn_Area
39008>>>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Area To (sl197(Self))
39009>>>>>>>>>>>
39009>>>>>>>>>>>        // Cn.Cn_License
39009>>>>>>>>>>>
39009>>>>>>>>>>>        // Cn.Cn_Responsible
39009>>>>>>>>>>>
39009>>>>>>>>>>>        // Cn.Cn_Cnt_Recr
39009>>>>>>>>>>>
39009>>>>>>>>>>>        // Cn.Cn_Cnt_Id
39009>>>>>>>>>>>
39009>>>>>>>>>>>        // Cn.Cn_Phone
39009>>>>>>>>>>>
39009>>>>>>>>>>>        // Cn.Cn_Zone
39009>>>>>>>>>>>
39009>>>>>>>>>>>        // Cn.Cn_Sls_Recr
39009>>>>>>>>>>>
39009>>>>>>>>>>>        // Cn.Cn_Sls_Id
39009>>>>>>>>>>>
39009>>>>>>>>>>>        // Cn.Cn_Details
39009>>>>>>>>>>>
39009>>>>>>>>>>>        // Cn.Cn_Distance
39009>>>>>>>>>>>
39009>>>>>>>>>>>        // Cn.Cn_Pump
39009>>>>>>>>>>>
39009>>>>>>>>>>>        // Cn.Cn_Pumplicense
39009>>>>>>>>>>>
39009>>>>>>>>>>>        // Cn.Cn_Totalstats
39009>>>>>>>>>>>
39009>>>>>>>>>>>        // Cn.Cn_Analstats
39009>>>>>>>>>>>
39009>>>>>>>>>>>        // Cn.Cn_Coated
39009>>>>>>>>>>>
39009>>>>>>>>>>>        // Cn.Cn_Sitew
39009>>>>>>>>>>>
39009>>>>>>>>>>>        // Cn.Cn_Clientmatch
39009>>>>>>>>>>>
39009>>>>>>>>>>>        // Cn.Cn_Codematch
39009>>>>>>>>>>>
39009>>>>>>>>>>>        // Cn.Cn_Pumpid
39009>>>>>>>>>>>
39009>>>>>>>>>>>        // Cn.Cn_Clientid
39009>>>>>>>>>>>
39009>>>>>>>>>>>        // Cn.Cn_Sn
39009>>>>>>>>>>>
39009>>>>>>>>>>>        // Cn.Cn_Repmatch
39009>>>>>>>>>>>
39009>>>>>>>>>>>        // Cn.Cn_Active
39009>>>>>>>>>>>        Set Field_Checkbox_Values  Field Cn.Cn_Active To "A"  "F"
39010>>>>>>>>>>>
39010>>>>>>>>>>>        // Cn.Cn_Reported
39010>>>>>>>>>>>
39010>>>>>>>>>>>        // Cn.Cn_Lastupdated
39010>>>>>>>>>>>
39010>>>>>>>>>>>        // Cn.Cn_Markexp
39010>>>>>>>>>>>
39010>>>>>>>>>>>        // Cn.Cn_Vdetails
39010>>>>>>>>>>>
39010>>>>>>>>>>>        // Cn.Cn_Vticket
39010>>>>>>>>>>>
39010>>>>>>>>>>>        // Cn.Constraction_Id
39010>>>>>>>>>>>
39010>>>>>>>>>>>        // Cn.Cn_Presp_Id
39010>>>>>>>>>>>
39010>>>>>>>>>>>        // Cn.Cn_Presp_Recr
39010>>>>>>>>>>>
39010>>>>>>>>>>>        // Cn.Cn_Add_No
39010>>>>>>>>>>>
39010>>>>>>>>>>>        // Cn.Cn_Nomos
39010>>>>>>>>>>>
39010>>>>>>>>>>>        // Cn.Cn_Xora
39010>>>>>>>>>>>
39010>>>>>>>>>>>        // Cn.Polh_Recr
39010>>>>>>>>>>>
39010>>>>>>>>>>>        // Cn.Lic_Number
39010>>>>>>>>>>>
39010>>>>>>>>>>>        // Cn.Lic_Date
39010>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Lic_Date To MASK_DATE_WINDOW
39011>>>>>>>>>>>
39011>>>>>>>>>>>        // Cn.Lic_Lixi
39011>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Lic_Lixi To MASK_DATE_WINDOW
39012>>>>>>>>>>>
39012>>>>>>>>>>>        // Cn.Lic_Auth
39012>>>>>>>>>>>
39012>>>>>>>>>>>        // Cn.Cn_Start_Date
39012>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Cn_Start_Date To MASK_DATE_WINDOW
39013>>>>>>>>>>>
39013>>>>>>>>>>>        // Cn.Cn_End_Date
39013>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Cn_End_Date To MASK_DATE_WINDOW
39014>>>>>>>>>>>
39014>>>>>>>>>>>        // Cn.Cn_Categfpa
39014>>>>>>>>>>>        Set Field_Value_Table      Field Cn.Cn_Categfpa To (Cn_Cn_Categfpa_VT1(Self))
39015>>>>>>>>>>>
39015>>>>>>>>>>>        // Cn.Cn_Tpay
39015>>>>>>>>>>>
39015>>>>>>>>>>>        // Cn.Mhxanik_Id
39015>>>>>>>>>>>
39015>>>>>>>>>>>        // Cn.Sum_Pct_Tper
39015>>>>>>>>>>>
39015>>>>>>>>>>>        // Cn.Cn_M3
39015>>>>>>>>>>>
39015>>>>>>>>>>>        // Cn.Aa_Deop
39015>>>>>>>>>>>
39015>>>>>>>>>>>        // Cn.Hm_Tel_Fortio
39015>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Hm_Tel_Fortio To MASK_DATE_WINDOW
39016>>>>>>>>>>>
39016>>>>>>>>>>>        // Cn.Tel_Fortio_No
39016>>>>>>>>>>>
39016>>>>>>>>>>>        // Cn.Tropos_Metaf
39016>>>>>>>>>>>        Set Field_Value_Table      Field Cn.Tropos_Metaf To (Cn_Tropos_Metaf_VT(Self))
39017>>>>>>>>>>>
39017>>>>>>>>>>>        // Cn.Eidos_Cn
39017>>>>>>>>>>>        Set Field_Value_Table      Field Cn.Eidos_Cn To (Cn_Eidos_Cn_VT(Self))
39018>>>>>>>>>>>
39018>>>>>>>>>>>        // Cn.Polhths_Constr
39018>>>>>>>>>>>
39018>>>>>>>>>>>        // Cn.Polhths_Mhx
39018>>>>>>>>>>>
39018>>>>>>>>>>>        // Cn.Hm_Prot_Fortio
39018>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Hm_Prot_Fortio To MASK_DATE_WINDOW
39019>>>>>>>>>>>
39019>>>>>>>>>>>        // Cn.Mesoskyklos
39019>>>>>>>>>>>
39019>>>>>>>>>>>        // Cn.Diodia
39019>>>>>>>>>>>
39019>>>>>>>>>>>        // Cn.Yesno
39019>>>>>>>>>>>        Set Field_Value_Table      Field Cn.Yesno To (Cn_Yesno_VT(Self))
39020>>>>>>>>>>>
39020>>>>>>>>>>>        // Cn.Dateeggy
39020>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Dateeggy To MASK_DATE_WINDOW
39021>>>>>>>>>>>
39021>>>>>>>>>>>        // Cn.Cn_Branch
39021>>>>>>>>>>>
39021>>>>>>>>>>>        // Cn.Cn_Exfd1
39021>>>>>>>>>>>
39021>>>>>>>>>>>        // Cn.Cn_Exfd2
39021>>>>>>>>>>>
39021>>>>>>>>>>>        // Cn.Cn_Exfd3
39021>>>>>>>>>>>
39021>>>>>>>>>>>        // Cn.Cn_Exfd4
39021>>>>>>>>>>>
39021>>>>>>>>>>>        // Cn.Cn_Exfd5
39021>>>>>>>>>>>
39021>>>>>>>>>>>        // Cn.Cn_Exfd6
39021>>>>>>>>>>>
39021>>>>>>>>>>>        //DDB-DefineFieldEnd
39021>>>>>>>>>>>    End_Procedure    // Define_Fields
39022>>>>>>>>>>>
39022>>>>>>>>>>>    // Field_Defaults:
39022>>>>>>>>>>>    // This procedure is used to establish default field values.
39022>>>>>>>>>>>          
39022>>>>>>>>>>>    Procedure Field_Defaults
39023>>>>>>>>>>>        Forward Send Field_Defaults
39025>>>>>>>>>>>        //DDB-Generated-Code-Location
39025>>>>>>>>>>>        //DDB-FieldDefaultStart
39025>>>>>>>>>>>        Set Field_Changed_Value   Field Cn.Cn_Active To "A"
39026>>>>>>>>>>>        //DDB-FieldDefaultEnd
39026>>>>>>>>>>>    End_Procedure    // Field_Defaults
39027>>>>>>>>>>>
39027>>>>>>>>>>>End_Class    // Cn_DataDictionary
39028>>>>>>>>>>>//DDB-Selection-pkg-Start
39028>>>>>>>>>>>
39028>>>>>>>>>>>Use sl041.sl         // sl041
39028>>>>>>>>>>>Use sl198.sl         // sl198
39028>>>>>>>>>>>Use sl197.SL         // sl197
39028>>>>>>>>>>>
39028>>>>>>>>>>>//DDB-Selection-pkg-End
39028>>>>>>>>>>>//DDB-FileEnd
39028>>>>>>>>>    
39028>>>>>>>>>    //AB-IgnoreEnd
39028>>>>>>>>>
39028>>>>>>>>>    Object sl041 is a dbModalPanelSub
39030>>>>>>>>>
39030>>>>>>>>>        //AB-StoreTopStart
39030>>>>>>>>>        Property String FragmaClient_ID Public ''
39032>>>>>>>>>        
39032>>>>>>>>>        //AB-StoreTopEnd
39032>>>>>>>>>
39032>>>>>>>>>        Set Label to "„§ ¢¦šã „¨šà¤"
39033>>>>>>>>>        Set Size to 249 500
39034>>>>>>>>>        Set Location to 2 6
39035>>>>>>>>>        Set Exit_Application_Local_State to FALSE
39036>>>>>>>>>        Set Modal_State to FALSE
39037>>>>>>>>>
39037>>>>>>>>>        //AB-DDOStart
39037>>>>>>>>>
39037>>>>>>>>>        Object Clients_DD is a Clients_DataDictionary
39039>>>>>>>>>
39039>>>>>>>>>            //AB-StoreStart
39039>>>>>>>>>                                                                                                                                                                                                                                                    
39039>>>>>>>>>                                                                                                                                                                                                                                                    
39039>>>>>>>>>                                                                                                                                                                                                                                                    
39039>>>>>>>>>            //AB-StoreEnd
39039>>>>>>>>>
39039>>>>>>>>>        End_Object    // Clients_DD
39040>>>>>>>>>
39040>>>>>>>>>        Object Cn_DD is a Cn_DataDictionary
39042>>>>>>>>>            Set DDO_Server to (Clients_DD(self))
39043>>>>>>>>>
39043>>>>>>>>>            //AB-StoreStart
39043>>>>>>>>>                                                        
39043>>>>>>>>>            Begin_Constraints
39045>>>>>>>>>                String sID
39046>>>>>>>>>                Get FragmaClient_ID to sID
39047>>>>>>>>>                If (sID<>'') begin
39049>>>>>>>>>                    set ordering to 4
39050>>>>>>>>>                    Constrain CN.Client_ID eq sID
39052>>>>>>>>>                end
39052>>>>>>>>>>
39052>>>>>>>>>                ELSE SET ORDERING TO -1
39054>>>>>>>>>            End_Constraints
39057>>>>>>>>>            
39057>>>>>>>>>            
39057>>>>>>>>>            
39057>>>>>>>>>            
39057>>>>>>>>>            
39057>>>>>>>>>            
39057>>>>>>>>>            
39057>>>>>>>>>            
39057>>>>>>>>>            
39057>>>>>>>>>            
39057>>>>>>>>>            
39057>>>>>>>>>            
39057>>>>>>>>>            
39057>>>>>>>>>            
39057>>>>>>>>>            
39057>>>>>>>>>            //AB-StoreEnd
39057>>>>>>>>>
39057>>>>>>>>>        End_Object    // Cn_DD
39058>>>>>>>>>
39058>>>>>>>>>        Set Main_DD to (Cn_DD(self))
39059>>>>>>>>>        Set Server to (Cn_DD(self))
39060>>>>>>>>>
39060>>>>>>>>>        //AB-DDOEnd
39060>>>>>>>>>
39060>>>>>>>>>        Object oSelList is a dbListSub
39062>>>>>>>>>            Set Main_File to Cn.File_Number
39063>>>>>>>>>            Set Ordering to 4
39064>>>>>>>>>            Set Size to 209 481
39065>>>>>>>>>            Set Location to 6 6
39066>>>>>>>>>            Set Auto_Index_State to FALSE
39067>>>>>>>>>
39067>>>>>>>>>            Begin_Row
39070>>>>>>>>>                Entry_Item Cn.Cn_code
39071>>>>>>>>>                Entry_Item Cn.Cn_descr
39072>>>>>>>>>                Entry_Item Cn.Client_id
39073>>>>>>>>>                Entry_Item Clients.Client_name
39074>>>>>>>>>                Entry_Item Cn.Cn_active
39075>>>>>>>>>            End_Row
39080>>>>>>>>>
39080>>>>>>>>>            Set Form_Width    item 0 to 62
39081>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª „¨š¦¬"
39082>>>>>>>>>            
39082>>>>>>>>>            Set Form_Width    item 1 to 185
39083>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã „¨š¦¬"
39084>>>>>>>>>            
39084>>>>>>>>>            Set Form_Width    item 2 to 60
39085>>>>>>>>>            Set Header_Label  item 2 to "‰à›.œ¢á«ž"
39086>>>>>>>>>            
39086>>>>>>>>>            Set Form_Width    item 3 to 123
39087>>>>>>>>>            Set Header_Label  item 3 to "„§à¤¬£å˜ œ¢á«ž"
39088>>>>>>>>>            
39088>>>>>>>>>            Set Form_Width    item 4 to 44
39089>>>>>>>>>            Set Header_Label  item 4 to "‘œ „¥â¢ ¥ž"
39090>>>>>>>>>            Set Column_Checkbox_State  item 4 to True
39091>>>>>>>>>            
39091>>>>>>>>>
39091>>>>>>>>>            //AB-StoreStart
39091>>>>>>>>>                                                        
39091>>>>>>>>>            Property String StoreFragmaClient_ID Public ''
39093>>>>>>>>>            
39093>>>>>>>>>            Procedure Store_Defaults
39095>>>>>>>>>                   Forward Send Store_Defaults
39097>>>>>>>>>                   Set StoreFragmaClient_ID to (FragmaClient_ID(Self))
39098>>>>>>>>>            End_Procedure
39099>>>>>>>>>            
39099>>>>>>>>>            Procedure ReStore_Defaults
39101>>>>>>>>>                   Forward Send ReStore_Defaults
39103>>>>>>>>>                   Set FragmaClient_ID to (StoreFragmaClient_ID(Self))
39104>>>>>>>>>            End_Procedure
39105>>>>>>>>>            
39105>>>>>>>>>            Procedure Activating Returns Integer
39107>>>>>>>>>                Integer rVal
39108>>>>>>>>>                Forward Get Msg_Activating to rVal
39110>>>>>>>>>                set auto_index_state to true
39111>>>>>>>>>                SET ORDERING TO -1
39112>>>>>>>>>                Procedure_Return rVal
39113>>>>>>>>>            End_Procedure
39114>>>>>>>>>            
39114>>>>>>>>>            
39114>>>>>>>>>            
39114>>>>>>>>>            
39114>>>>>>>>>            
39114>>>>>>>>>            
39114>>>>>>>>>            
39114>>>>>>>>>            
39114>>>>>>>>>            
39114>>>>>>>>>            
39114>>>>>>>>>            
39114>>>>>>>>>            
39114>>>>>>>>>            
39114>>>>>>>>>            
39114>>>>>>>>>            
39114>>>>>>>>>            
39114>>>>>>>>>            
39114>>>>>>>>>            
39114>>>>>>>>>            //AB-StoreEnd
39114>>>>>>>>>
39114>>>>>>>>>        End_Object    // oSelList
39115>>>>>>>>>
39115>>>>>>>>>        Object oOK_bn is a ButtonSub
39117>>>>>>>>>            Set Label to "&„§ ¢¦šã"
39118>>>>>>>>>            Set Location to 219 327
39119>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39120>>>>>>>>>
39120>>>>>>>>>            //AB-StoreStart
39120>>>>>>>>>            Procedure OnClick
39122>>>>>>>>>                Send OK To (oSelList(current_object))
39123>>>>>>>>>            End_Procedure
39124>>>>>>>>>            //AB-StoreEnd
39124>>>>>>>>>
39124>>>>>>>>>        End_Object    // oOK_bn
39125>>>>>>>>>
39125>>>>>>>>>        Object oCancel_bn is a ButtonSub
39127>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
39128>>>>>>>>>            Set Location to 219 383
39129>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39130>>>>>>>>>
39130>>>>>>>>>            //AB-StoreStart
39130>>>>>>>>>            Procedure OnClick
39132>>>>>>>>>                Send Cancel To (oSelList(current_object))
39133>>>>>>>>>            End_Procedure
39134>>>>>>>>>            //AB-StoreEnd
39134>>>>>>>>>
39134>>>>>>>>>        End_Object    // oCancel_bn
39135>>>>>>>>>
39135>>>>>>>>>        Object oSearch_bn is a ButtonSub
39137>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
39138>>>>>>>>>            Set Location to 219 437
39139>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39140>>>>>>>>>
39140>>>>>>>>>            //AB-StoreStart
39140>>>>>>>>>            Procedure OnClick
39142>>>>>>>>>                Send Search To (oSelList(current_object))
39143>>>>>>>>>            End_Procedure
39144>>>>>>>>>            //AB-StoreEnd
39144>>>>>>>>>
39144>>>>>>>>>        End_Object    // oSearch_bn
39145>>>>>>>>>
39145>>>>>>>>>
39145>>>>>>>>>        //AB-StoreStart
39145>>>>>>>>>        
39145>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39146>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39147>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39148>>>>>>>>>        
39148>>>>>>>>>        Set Modal_State to True
39149>>>>>>>>>        
39149>>>>>>>>>        Procedure Activating Returns Integer
39151>>>>>>>>>            Integer rVal
39152>>>>>>>>>            Forward Get Msg_Activating to rVal
39154>>>>>>>>>            Send Rebuild_Constraints to (CN_DD(Self))
39155>>>>>>>>>            Send Beginning_Of_Data to oSelList
39156>>>>>>>>>            Procedure_Return rVal
39157>>>>>>>>>        End_Procedure
39158>>>>>>>>>        
39158>>>>>>>>>        procedure page integer pagemode
39160>>>>>>>>>            forward send page pagemode
39162>>>>>>>>>            set location to 40,40
39163>>>>>>>>>        end_procedure
39164>>>>>>>>>        
39164>>>>>>>>>        
39164>>>>>>>>>        
39164>>>>>>>>>        
39164>>>>>>>>>        
39164>>>>>>>>>        
39164>>>>>>>>>        
39164>>>>>>>>>        
39164>>>>>>>>>        
39164>>>>>>>>>        
39164>>>>>>>>>        
39164>>>>>>>>>        
39164>>>>>>>>>        
39164>>>>>>>>>        
39164>>>>>>>>>        
39164>>>>>>>>>        
39164>>>>>>>>>        
39164>>>>>>>>>        
39164>>>>>>>>>        
39164>>>>>>>>>        //AB-StoreEnd
39164>>>>>>>>>
39164>>>>>>>>>    End_Object    // sl041
39165>>>>>>>>>
39165>>>>>>>>>//AB/     End_Object    // prj
39165>>>>>>>
39165>>>>>>>//DDB-Selection-pkg-End
39165>>>>>>>//DDB-FileEnd
39165>>>>>
39165>>>>>//AB-IgnoreEnd
39165>>>>>
39165>>>>>Object sl006 is a dbModalPanelSub
39167>>>>>
39167>>>>>    //AB-StoreTopStart
39167>>>>>                                        
39167>>>>>    Property String     psModule    Public ''
39169>>>>>    Property String     psClientID  Public ''
39171>>>>>    Property Date       pdApo       public ''
39173>>>>>    Property Date       pdEos       public ''
39175>>>>>    Property Integer    piXr_Or_Pi  public  0
39177>>>>>    Property Integer    piWhat      public  0
39179>>>>>    
39179>>>>>    //AB-StoreTopEnd
39179>>>>>
39179>>>>>    Set Label to "‰ ¤ã©œ ª ”¦¨âà¤"
39180>>>>>    Set Size to 270 519
39181>>>>>    Set Location to 5 7
39182>>>>>    Set Exit_Application_Local_State to FALSE
39183>>>>>    Set Modal_State to FALSE
39184>>>>>
39184>>>>>    //AB-DDOStart
39184>>>>>
39184>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
39186>>>>>    End_Object    // Ctypkin_DD
39187>>>>>
39187>>>>>    Object Clients_DD is a Clients_DataDictionary
39189>>>>>    End_Object    // Clients_DD
39190>>>>>
39190>>>>>    Object Cmoves_DD is a Cmoves_DataDictionary
39192>>>>>        Set DDO_Server to (Ctypkin_DD(self))
39193>>>>>        Set DDO_Server to (Clients_DD(self))
39194>>>>>
39194>>>>>        //AB-StoreStart
39194>>>>>        
39194>>>>>        Begin_Constraints
39196>>>>>        
39196>>>>>            Constrain Cmoves.Company_Code   Eq SyscurXr.Company_Code
39198>>>>>            Constrain Cmoves.Year_Year      Eq SyscurXr.Year_Year
39200>>>>>        
39200>>>>>            If (psClientID(Self)<>'')   Constrain Cmoves.Client_ID      Eq (psClientID(Self))
39204>>>>>            If (pdApo(Self)<>'')        Constrain Cmoves.Cmoves_Hmnia   Ge (pdApo(Self))
39208>>>>>            If (pdEos(Self)<>'')        Constrain Cmoves.Cmoves_Hmnia   Le (pdEos(Self))
39212>>>>>        
39212>>>>>            Constrain Cmoves.Module_From    Eq (psModule(Self))
39214>>>>>        
39214>>>>>                 If (piWhat(Self)=1) Constrain Cmoves.Flag_Ypol Eq 1
39218>>>>>            Else If (piWhat(Self)=2) Constrain Cmoves.Flag_Ypol Eq 0
39223>>>>>        
39223>>>>>        End_Constraints
39226>>>>>        
39226>>>>>        
39226>>>>>        
39226>>>>>        
39226>>>>>        
39226>>>>>        
39226>>>>>        
39226>>>>>        
39226>>>>>        
39226>>>>>        
39226>>>>>        
39226>>>>>        
39226>>>>>        
39226>>>>>        
39226>>>>>        
39226>>>>>        
39226>>>>>        
39226>>>>>        
39226>>>>>        
39226>>>>>        
39226>>>>>        
39226>>>>>        
39226>>>>>        
39226>>>>>        
39226>>>>>        
39226>>>>>        
39226>>>>>        //AB-StoreEnd
39226>>>>>
39226>>>>>    End_Object    // Cmoves_DD
39227>>>>>
39227>>>>>    Set Main_DD to (Cmoves_DD(self))
39228>>>>>    Set Server to (Cmoves_DD(self))
39229>>>>>
39229>>>>>    //AB-DDOEnd
39229>>>>>
39229>>>>>    Object oSelList is a dbListSub
39231>>>>>
39231>>>>>        //AB-StoreTopStart
39231>>>>>                                                                                                                                                                                                                                                                                                                            
39231>>>>>        //AB-StoreTopEnd
39231>>>>>
39231>>>>>        Set Main_File to Cmoves.File_Number
39232>>>>>        Set Ordering to 4
39233>>>>>        Set Size to 199 505
39234>>>>>        Set Location to 31 7
39235>>>>>        Set Auto_Index_State to FALSE
39236>>>>>
39236>>>>>        Begin_Row
39239>>>>>            Entry_Item Cmoves.Cmoves_hmnia
39240>>>>>            Entry_Item Cmoves.Cmoves_par
39241>>>>>            Entry_Item Ctypkin.Ctypkin_descr
39242>>>>>            Entry_Item Clients.Client_name
39243>>>>>            Entry_Item Cmoves.Cmoves_axia
39244>>>>>            Entry_Item Cmoves.Cmoves_sc_code2
39245>>>>>            Entry_Item Cmoves.Branch_code
39246>>>>>        End_Row
39251>>>>>
39251>>>>>        Set Form_Width    item 0 to 57
39252>>>>>        Set Header_Label  item 0 to "†£œ¨/¤å˜"
39253>>>>>        
39253>>>>>        Set Form_Width    item 1 to 121
39254>>>>>        Set Header_Label  item 1 to "€ « ¦¢¦šå˜"
39255>>>>>        
39255>>>>>        Set Form_Width    item 2 to 65
39256>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
39257>>>>>        
39257>>>>>        Set Form_Width    item 3 to 107
39258>>>>>        Set Header_Label  item 3 to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
39259>>>>>        
39259>>>>>        Set Form_Width    item 4 to 63
39260>>>>>        Set Header_Label  item 4 to " €¥å˜"
39261>>>>>        
39261>>>>>        Set Form_Width    item 5 to 42
39262>>>>>        Set Header_Label  item 5 to "Œæ£ ©£˜"
39263>>>>>        
39263>>>>>        Set Form_Width    item 6 to 45
39264>>>>>        Set Header_Label  item 6 to "“§¦¡/£˜"
39265>>>>>        
39265>>>>>
39265>>>>>        //AB-StoreStart
39265>>>>>                                                                                                                                                                                                                                                                                                                            
39265>>>>>        Procedure End_Construct_Object
39267>>>>>            String  sNom
39268>>>>>            Integer iDecs
39268>>>>>            Forward Send End_Construct_Object
39270>>>>>            Move SysCurxr.C_Code0 to sNom
39271>>>>>            Clear Nomisma
39272>>>>>            Move sNom to Nomisma.Nomisma_Code
39273>>>>>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
39274>>>>>>
39274>>>>>            If (Found=1)    Move Nomisma.Dekadika to iDecs
39277>>>>>            Else            Move 0 to iDecs
39279>>>>>        
39279>>>>>            // Ž¨ ¦¬£œ §àª ˜¤ «¦ ™˜© ¡æ ¤¦£ ©£˜ ®¨ã©žª ƒ„Œ œ®œ  ›œ¡˜› ¡á
39279>>>>>            // «æ«œ œ¥' ¦¨ ©£¦ç ™á¦¬£œ œ£œ ª 2
39279>>>>>            If (iDecs=0) Move 2 to iDecs
39282>>>>>            //
39282>>>>>        
39282>>>>>            Set Points          Item 4 to       iDecs
39283>>>>>            Set Numeric_Mask    Item 4 to 14    iDecs '*, '
39284>>>>>        End_Procedure
39285>>>>>        
39285>>>>>        
39285>>>>>        
39285>>>>>        
39285>>>>>        
39285>>>>>        //AB-StoreEnd
39285>>>>>
39285>>>>>    End_Object    // oSelList
39286>>>>>
39286>>>>>    Object oOK_bn is a ButtonSub
39288>>>>>        Set Label to "&„§ ¢¦šã"
39289>>>>>        Set Location to 236 350
39290>>>>>
39290>>>>>        //AB-StoreStart
39290>>>>>        Procedure OnClick
39292>>>>>            Send OK To (oSelList(current_object))
39293>>>>>        End_Procedure
39294>>>>>        //AB-StoreEnd
39294>>>>>
39294>>>>>    End_Object    // oOK_bn
39295>>>>>
39295>>>>>    Object oCancel_bn is a ButtonSub
39297>>>>>        Set Label to "&€¡ç¨à©ž"
39298>>>>>        Set Location to 236 404
39299>>>>>
39299>>>>>        //AB-StoreStart
39299>>>>>        Procedure OnClick
39301>>>>>            Send Cancel To (oSelList(current_object))
39302>>>>>        End_Procedure
39303>>>>>        //AB-StoreEnd
39303>>>>>
39303>>>>>    End_Object    // oCancel_bn
39304>>>>>
39304>>>>>    Object oSearch_bn is a ButtonSub
39306>>>>>        Set Label to "€&¤˜ã«ž©ž"
39307>>>>>        Set Location to 236 460
39308>>>>>
39308>>>>>        //AB-StoreStart
39308>>>>>        Procedure OnClick
39310>>>>>            Send Search To (oSelList(current_object))
39311>>>>>        End_Procedure
39312>>>>>        //AB-StoreEnd
39312>>>>>
39312>>>>>    End_Object    // oSearch_bn
39313>>>>>
39313>>>>>    Object Cmoves_Axia_Pros_Sysx is a dbFormSub
39315>>>>>        Entry_Item Cmoves.Axia_pros_sysx
39316>>>>>        Set Size to 13 54
39317>>>>>        Set Location to 236 24
39318>>>>>        Set Color to clBtnFace
39319>>>>>        Set Label_Col_Offset to 2
39320>>>>>        Set Label_Justification_Mode to jMode_Right
39321>>>>>        Set Enabled_State to FALSE
39322>>>>>        Set Item_Shadow_State Item 0 to TRUE
39323>>>>>        Set Shadow_State Item 0 to TRUE
39324>>>>>
39324>>>>>        //AB-StoreStart
39324>>>>>        Set points item 0 to 2
39325>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
39326>>>>>        
39326>>>>>        //AB-StoreEnd
39326>>>>>
39326>>>>>    End_Object    // Cmoves_Axia_Pros_Sysx
39327>>>>>
39327>>>>>    Object Cmoves_Axia_Sysxet is a dbFormSub
39329>>>>>        Entry_Item Cmoves.Axia_sysxet
39330>>>>>        Set Size to 13 54
39331>>>>>        Set Location to 236 140
39332>>>>>        Set Color to clBtnFace
39333>>>>>        Set Label_Col_Offset to 2
39334>>>>>        Set Label_Justification_Mode to jMode_Right
39335>>>>>        Set Enabled_State to FALSE
39336>>>>>        Set Item_Shadow_State Item 0 to TRUE
39337>>>>>        Set Shadow_State Item 0 to TRUE
39338>>>>>
39338>>>>>        //AB-StoreStart
39338>>>>>        Set points item 0 to 2
39339>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
39340>>>>>        
39340>>>>>        //AB-StoreEnd
39340>>>>>
39340>>>>>    End_Object    // Cmoves_Axia_Sysxet
39341>>>>>
39341>>>>>    Object Cmoves_Axia_Ypol_Sysx is a dbFormSub
39343>>>>>        Entry_Item Cmoves.Axia_ypol_sysx
39344>>>>>        Set Size to 13 54
39345>>>>>        Set Location to 236 248
39346>>>>>        Set Color to clBtnFace
39347>>>>>        Set Label_Col_Offset to 2
39348>>>>>        Set Label_Justification_Mode to jMode_Right
39349>>>>>        Set Enabled_State to FALSE
39350>>>>>        Set Item_Shadow_State Item 0 to TRUE
39351>>>>>        Set Shadow_State Item 0 to TRUE
39352>>>>>
39352>>>>>        //AB-StoreStart
39352>>>>>                                                                                                    
39352>>>>>        Set points item 0 to 2
39353>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
39354>>>>>        
39354>>>>>        //AB-StoreEnd
39354>>>>>
39354>>>>>    End_Object    // Cmoves_Axia_Ypol_Sysx
39355>>>>>
39355>>>>>    Object TextBoxSub1 is a TextBoxSub
39357>>>>>        Set Label to "€¥å˜"
39358>>>>>        Set Location to 238 7
39359>>>>>        Set Size to 10 15
39360>>>>>    End_Object    // TextBoxSub1
39361>>>>>
39361>>>>>    Object TextBoxSub2 is a TextBoxSub
39363>>>>>        Set Label to "‘¬©®œ« ©£â¤ž"
39364>>>>>        Set Location to 238 89
39365>>>>>        Set Size to 10 49
39366>>>>>    End_Object    // TextBoxSub2
39367>>>>>
39367>>>>>    Object TextBoxSub3 is a TextBoxSub
39369>>>>>        Set Label to "ƒ ˜Ÿâ© £ž"
39370>>>>>        Set Location to 238 210
39371>>>>>        Set Size to 10 35
39372>>>>>    End_Object    // TextBoxSub3
39373>>>>>
39373>>>>>    Object RadioGroupSub2 is a RadioGroupSub
39375>>>>>        Set Label to "„§ ¢¦šã ‰ ¤ã©œà¤"
39376>>>>>        Set Size to 24 497
39377>>>>>        Set Location to 3 9
39378>>>>>        Object Radio4 is a RadioSub
39380>>>>>            Set Label to "Ž¢œª"
39381>>>>>            Set Size to 10 37
39382>>>>>            Set Location to 10 97
39383>>>>>        End_Object    // Radio4
39384>>>>>
39384>>>>>        Object Radio5 is a RadioSub
39386>>>>>            Set Label to "‹œ ¬§æ¢¦ §¦ ©¬©®â« ©žª"
39387>>>>>            Set Size to 10 97
39388>>>>>            Set Location to 10 167
39389>>>>>        End_Object    // Radio5
39390>>>>>
39390>>>>>        Object Radio6 is a RadioSub
39392>>>>>            Set Label to "•à¨åª ¬§æ¢¦ §¦ ©¬©®â« ©žª"
39393>>>>>            Set Size to 10 111
39394>>>>>            Set Location to 10 278
39395>>>>>        End_Object    // Radio6
39396>>>>>
39396>>>>>
39396>>>>>        //AB-StoreStart
39396>>>>>                                                                                        
39396>>>>>        Procedure Notify_Select_State integer iToItem integer iFromItem
39398>>>>>            Set piWhat to iToItem
39399>>>>>            Send Rebuild_Constraints to Cmoves_DD
39400>>>>>            Send Beginning_Of_Data To oSelList True
39401>>>>>        End_Procedure
39402>>>>>        
39402>>>>>        Set Current_Radio to 1
39403>>>>>        
39403>>>>>        
39403>>>>>        
39403>>>>>        
39403>>>>>        //AB-StoreEnd
39403>>>>>
39403>>>>>    End_Object    // RadioGroupSub2
39404>>>>>
39404>>>>>
39404>>>>>    //AB-StoreStart
39404>>>>>                                        
39404>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39405>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39406>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39407>>>>>    
39407>>>>>    Set Modal_State to True
39408>>>>>    
39408>>>>>    Procedure Activate
39410>>>>>        String  sNom
39411>>>>>        Integer iDecs rVal
39411>>>>>        Set piWhat to 1
39412>>>>>        Set Current_Radio Of RadioGroupSub2 to 1
39413>>>>>        Forward Send Activate
39415>>>>>        Send Rebuild_Constraints        to Cmoves_DD
39416>>>>>        Send Beginning_Of_Data          to oSelList True
39417>>>>>    End_procedure
39418>>>>>    
39418>>>>>    
39418>>>>>    
39418>>>>>    
39418>>>>>    
39418>>>>>    
39418>>>>>    
39418>>>>>    
39418>>>>>    
39418>>>>>    
39418>>>>>    
39418>>>>>    
39418>>>>>    
39418>>>>>    
39418>>>>>    
39418>>>>>    
39418>>>>>    
39418>>>>>    
39418>>>>>    
39418>>>>>    
39418>>>>>    
39418>>>>>    
39418>>>>>    
39418>>>>>    
39418>>>>>    
39418>>>>>    
39418>>>>>    //AB-StoreEnd
39418>>>>>
39418>>>>>End_Object    // sl006
39419>>>>>
39419>>>>>//AB/ End_Object    // prj
39419>>>Use sl007.sl
39419>>>Use sl007r.sl
INCLUDING FILE: SL007R.SL
39419>>>>>//AB/ Project sl007r:Ctypkin lookup with RecR 1st Col
39419>>>>>//AB/     Object prj is a Lookup_Project
39419>>>>>//AB/         Set ProjectName to "sl007r:Ctypkin lookup with RecR 1st Col"
39419>>>>>//AB/         Set ProjectFileName to "sl007r.SL"
39419>>>>>//AB/         Set GenerateFileName to "NONAME"
39419>>>>>
39419>>>>>// Project Object Structure
39419>>>>>//   sl007r is a dbModalPanelSub
39419>>>>>//     Ctypkin_DD is a DataDictionary
39419>>>>>//     oSelList is a dbListSub
39419>>>>>//     oOK_bn is a ButtonSub
39419>>>>>//     oCancel_bn is a ButtonSub
39419>>>>>//     oSearch_bn is a ButtonSub
39419>>>>>
39419>>>>>// Register all objects
39419>>>>>Register_Object Ctypkin_DD
39419>>>>>Register_Object oCancel_bn
39419>>>>>Register_Object oOK_bn
39419>>>>>Register_Object oSearch_bn
39419>>>>>Register_Object oSelList
39419>>>>>Register_Object sl007r
39419>>>>>
39419>>>>>
39419>>>>>    //AB-IgnoreStart
39419>>>>>
39419>>>>>    Use DFAllEnt.pkg
39419>>>>>    Use dbList.Sub
39419>>>>>    Use Button.Sub
39419>>>>>
39419>>>>>
39419>>>>>    Use CTYPKIN.DD
39419>>>>>    
39419>>>>>    //AB-IgnoreEnd
39419>>>>>
39419>>>>>    CD_Popup_Object sl007r is a dbModalPanelSub
39438>>>>>        Set Label to "Ctypkin"
39439>>>>>        Set Size to 148 480
39440>>>>>        Set Location to 12 16
39441>>>>>        Set Exit_Application_Local_State to FALSE
39442>>>>>        Set Modal_State to FALSE
39443>>>>>
39443>>>>>        //AB-DDOStart
39443>>>>>
39443>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
39445>>>>>        End_Object    // Ctypkin_DD
39446>>>>>
39446>>>>>        Set Main_DD to (Ctypkin_DD(self))
39447>>>>>        Set Server to (Ctypkin_DD(self))
39448>>>>>
39448>>>>>        //AB-DDOEnd
39448>>>>>
39448>>>>>        Object oSelList is a dbListSub
39450>>>>>            Set Main_File to Ctypkin.File_Number
39451>>>>>            Set Size to 105 465
39452>>>>>            Set Location to 6 6
39453>>>>>
39453>>>>>            Begin_Row
39456>>>>>                Entry_Item Ctypkin.Ctypkin_recr
39457>>>>>                Entry_Item Ctypkin.Ctypkin_code
39458>>>>>                Entry_Item Ctypkin.Ctypkin_descr
39459>>>>>                Entry_Item Ctypkin.Ctypkin_anti
39460>>>>>            End_Row
39465>>>>>
39465>>>>>            Set Form_Width    item 0 to 72
39466>>>>>            Set Header_Label  item 0 to "RecR"
39467>>>>>            
39467>>>>>            Set Form_Width    item 1 to 58
39468>>>>>            Set Header_Label  item 1 to "Ctypkin code"
39469>>>>>            
39469>>>>>            Set Form_Width    item 2 to 209
39470>>>>>            Set Header_Label  item 2 to "Ctypkin descr"
39471>>>>>            
39471>>>>>            Set Form_Width    item 3 to 120
39472>>>>>            Set Header_Label  item 3 to "Ctypkin anti"
39473>>>>>            
39473>>>>>
39473>>>>>            //AB-StoreStart
39473>>>>>            
39473>>>>>            Set Column_Option Item 0 to Noenter True
39474>>>>>            
39474>>>>>            //AB-StoreEnd
39474>>>>>
39474>>>>>        End_Object    // oSelList
39475>>>>>
39475>>>>>        Object oOK_bn is a ButtonSub
39477>>>>>            set label to "&„§ ¢¦šã" 
39478>>>>>            Set Location to 114 312
39479>>>>>
39479>>>>>            //AB-StoreStart
39479>>>>>            Procedure OnClick
39481>>>>>                Send OK To (oSelList(current_object))
39482>>>>>            End_Procedure
39483>>>>>            //AB-StoreEnd
39483>>>>>
39483>>>>>        End_Object    // oOK_bn
39484>>>>>
39484>>>>>        Object oCancel_bn is a ButtonSub
39486>>>>>            set label to "&€¡ç¨à©ž" 
39487>>>>>            Set Location to 114 367
39488>>>>>
39488>>>>>            //AB-StoreStart
39488>>>>>            Procedure OnClick
39490>>>>>                Send Cancel To (oSelList(current_object))
39491>>>>>            End_Procedure
39492>>>>>            //AB-StoreEnd
39492>>>>>
39492>>>>>        End_Object    // oCancel_bn
39493>>>>>
39493>>>>>        Object oSearch_bn is a ButtonSub
39495>>>>>            set label to "€&¤˜ã«ž©ž" 
39496>>>>>            Set Location to 114 422
39497>>>>>
39497>>>>>            //AB-StoreStart
39497>>>>>            Procedure OnClick
39499>>>>>                Send Search To (oSelList(current_object))
39500>>>>>            End_Procedure
39501>>>>>            //AB-StoreEnd
39501>>>>>
39501>>>>>        End_Object    // oSearch_bn
39502>>>>>
39502>>>>>
39502>>>>>        //AB-StoreStart
39502>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39503>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39504>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39505>>>>>        //AB-StoreEnd
39505>>>>>
39505>>>>>    CD_End_Object    // sl007r
39507>>>>>>
39507>>>>>
39507>>>>>//AB/     End_Object    // prj
39507>>>Use sl012.sl
INCLUDING FILE: SL012.SL
39507>>>>>//AB/ Project sl012 : Ptyppar
39507>>>>>//AB/ Object prj is a Lookup_Project
39507>>>>>//AB/     Set ProjectName to "sl012 : Ptyppar"
39507>>>>>//AB/     Set ProjectFileName to "sl012.SL"
39507>>>>>//AB/     Set GenerateFileName to "NONAME"
39507>>>>>
39507>>>>>// Project Object Structure
39507>>>>>//   sl012 is a dbModalPanelSub
39507>>>>>//     Ctypkin_DD is a DataDictionary
39507>>>>>//     Wtypkin_DD is a DataDictionary
39507>>>>>//     Ptyppar_DD is a DataDictionary
39507>>>>>//     oSelList is a dbListSub
39507>>>>>//     oOK_bn is a ButtonSub
39507>>>>>//     oCancel_bn is a ButtonSub
39507>>>>>//     oSearch_bn is a ButtonSub
39507>>>>>
39507>>>>>// Register all objects
39507>>>>>Register_Object Ctypkin_DD
39507>>>>>Register_Object oCancel_bn
39507>>>>>Register_Object oOK_bn
39507>>>>>Register_Object oSearch_bn
39507>>>>>Register_Object oSelList
39507>>>>>Register_Object Ptyppar_DD
39507>>>>>Register_Object sl012
39507>>>>>Register_Object Wtypkin_DD
39507>>>>>
39507>>>>>
39507>>>>>//AB-IgnoreStart
39507>>>>>
39507>>>>>Use DFAllEnt.pkg
39507>>>>>Use dbList.Sub
39507>>>>>Use Button.Sub
39507>>>>>
39507>>>>>
39507>>>>>Use CTYPKIN.DD
39507>>>>>Use WTYPKIN.DD
INCLUDING FILE: WTYPKIN.DD
39507>>>>>>>//DDB-FileStart
39507>>>>>>>//DDB-HeaderStart
39507>>>>>>>
39507>>>>>>>// File Name : WTYPKIN.DD
39507>>>>>>>// Class Name: Wtypkin_DataDictionary
39507>>>>>>>// Revision  : 49
39507>>>>>>>// Version   : 2
39507>>>>>>>
39507>>>>>>>Use  Windows           // Basic Definitions
39507>>>>>>>Use  DataDict          // DataDictionary Class Definition
39507>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39507>>>>>>>
39507>>>>>>>Open Wtypkin
39509>>>>>>>Open Ptyppar
39511>>>>>>>Open Wcmoves
39513>>>>>>>Open Hmwtyp
INCLUDING FILE: HMWTYP.FD
39515>>>>>>>Open Wflagkin
INCLUDING FILE: WFLAGKIN.FD
39517>>>>>>>Open Sysrecw
39519>>>>>>>Open Syscurxr
39521>>>>>>>
39521>>>>>>>//DDB-HeaderEnd
39521>>>>>>>//DDB-ValidationStart
39521>>>>>>>
39521>>>>>>>Register_Object Wtypkin_Wtypkin_Module_VT
39521>>>>>>>
39521>>>>>>>Object Wtypkin_Wtypkin_Module_VT  is a CodeValidationTable
39523>>>>>>>    Set Type_Value        To "MODULE"
39524>>>>>>>    //DDB-ValidationCustomStart
39524>>>>>>>    //DDB-ValidationCustomEnd
39524>>>>>>>End_Object   // Wtypkin_Wtypkin_Module_VT
39525>>>>>>>//DDB-ValidationEnd
39525>>>>>>>//DDB-SelectionStart
39525>>>>>>>//DDB/ ExternalSelectionList sl029a  sl029a.SL
39525>>>>>>>Register_Object sl029a
39525>>>>>>>//DDB-SelectionEnd
39525>>>>>>>
39525>>>>>>>Class Wtypkin_DataDictionary  is a DataDictionary
39526>>>>>>>               
39526>>>>>>>    Procedure Construct_Object
39527>>>>>>>        Forward Send Construct_Object
39529>>>>>>>        Property Integer piMustNOTConstrain Public 0
39530>>>>>>>    End_Procedure
39531>>>>>>>
39531>>>>>>>    Procedure Save_Main_File
39532>>>>>>>        If (Operation_Origin<>Self) Begin
39534>>>>>>>            If Wtypkin.Recnum Eq 0 Procedure_Return
39537>>>>>>>        End
39537>>>>>>>>
39537>>>>>>>        Forward Send Save_Main_File
39539>>>>>>>    End_Procedure
39540>>>>>>>
39540>>>>>>>
39540>>>>>>>     Procedure Creating
39541>>>>>>>        Forward Send Creating
39543>>>>>>>        // Insert Code Here
39543>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wtypkin.Wtypkin_Rec0)))))) to Wtypkin.Wtypkin_Recr
39544>>>>>>>    End_Procedure   // Creating
39545>>>>>>>
39545>>>>>>>    // Define_Fields:
39545>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39545>>>>>>>
39545>>>>>>>    Procedure Define_Fields
39546>>>>>>>        Forward Send Define_Fields
39548>>>>>>>        //DDB-Generated-Code-Location
39548>>>>>>>        //DDB-DefineFieldStart
39548>>>>>>>
39548>>>>>>>        Set Main_File            To Wtypkin.File_Number
39549>>>>>>>        Set Cascade_Delete_State To FALSE
39550>>>>>>>
39550>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39551>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39552>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39553>>>>>>>
39553>>>>>>>        // Child (Client) file structure................
39553>>>>>>>        Send Add_Client_File  Ptyppar.File_Number
39554>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
39555>>>>>>>        Send Add_Client_File  Hmwtyp.File_Number
39556>>>>>>>        Send Add_Client_File  Wflagkin.File_Number
39557>>>>>>>
39557>>>>>>>        // External (System) file structure.............
39557>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
39558>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
39559>>>>>>>
39559>>>>>>>        Define_Auto_Increment  Sysrecw.Wtypkin_Rec0  To Wtypkin.Wtypkin_Rec0
39562>>>>>>>
39562>>>>>>>        // Field-based properties.......................
39562>>>>>>>
39562>>>>>>>        // Wtypkin.Company_Code
39562>>>>>>>
39562>>>>>>>        // Wtypkin.Branch_Code
39562>>>>>>>
39562>>>>>>>        // Wtypkin.Year_Year
39562>>>>>>>
39562>>>>>>>        // Wtypkin.Wtypkin_Code
39562>>>>>>>        Set Field_Options          Field Wtypkin.Wtypkin_Code To DD_AUTOFIND   
39563>>>>>>>        Set Field_Prompt_Object    Field Wtypkin.Wtypkin_Code To (sl029a(Self))
39564>>>>>>>        Set Key_Field_State        Field Wtypkin.Wtypkin_Code To TRUE
39565>>>>>>>
39565>>>>>>>        // Wtypkin.Wtypkin_Rec0
39565>>>>>>>        Set Field_Options          Field Wtypkin.Wtypkin_Rec0 To DD_AUTOFIND   
39566>>>>>>>
39566>>>>>>>        // Wtypkin.Wtypkin_Recr
39566>>>>>>>
39566>>>>>>>        // Wtypkin.Year_Recr
39566>>>>>>>
39566>>>>>>>        // Wtypkin.Wtypkin_Descr
39566>>>>>>>        Set Field_Prompt_Object    Field Wtypkin.Wtypkin_Descr To (sl029a(Self))
39567>>>>>>>
39567>>>>>>>        // Wtypkin.Wtypkin_Anti
39567>>>>>>>
39567>>>>>>>        // Wtypkin.Wtypkin_Module
39567>>>>>>>        Set Field_Value_Table      Field Wtypkin.Wtypkin_Module To (Wtypkin_Wtypkin_Module_VT(Self))
39568>>>>>>>
39568>>>>>>>        // Wtypkin.Max_Days_Sx_Par
39568>>>>>>>
39568>>>>>>>        //DDB-DefineFieldEnd
39568>>>>>>>    End_Procedure    // Define_Fields
39569>>>>>>>
39569>>>>>>>    // Field_Defaults:
39569>>>>>>>    // This procedure is used to establish default field values.
39569>>>>>>>
39569>>>>>>>    Procedure Field_Defaults
39570>>>>>>>        Forward Send Field_Defaults
39572>>>>>>>        //DDB-Generated-Code-Location
39572>>>>>>>        //DDB-FieldDefaultStart
39572>>>>>>>        //DDB-FieldDefaultEnd
39572>>>>>>>    End_Procedure    // Field_Defaults
39573>>>>>>>
39573>>>>>>>End_Class    // Wtypkin_DataDictionary
39574>>>>>>>//DDB-Selection-pkg-Start
39574>>>>>>>
39574>>>>>>>Use sl029a.SL        // sl029a
INCLUDING FILE: SL029A.SL
39574>>>>>>>>>//AB/ Project sl029a:wtypkin
39574>>>>>>>>>//AB/     Object prj is a Lookup_Project
39574>>>>>>>>>//AB/         Set ProjectName to "sl029a:wtypkin"
39574>>>>>>>>>//AB/         Set ProjectFileName to "sl029a.SL"
39574>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
39574>>>>>>>>>
39574>>>>>>>>>// Project Object Structure
39574>>>>>>>>>//   sl029a is a dbModalPanelSub
39574>>>>>>>>>//     Wtypkin_DD is a DataDictionary
39574>>>>>>>>>//     oSelList is a dbListSub
39574>>>>>>>>>//     oOK_bn is a ButtonSub
39574>>>>>>>>>//     oCancel_bn is a ButtonSub
39574>>>>>>>>>//     oSearch_bn is a ButtonSub
39574>>>>>>>>>
39574>>>>>>>>>// Register all objects
39574>>>>>>>>>Register_Object oCancel_bn
39574>>>>>>>>>Register_Object oOK_bn
39574>>>>>>>>>Register_Object oSearch_bn
39574>>>>>>>>>Register_Object oSelList
39574>>>>>>>>>Register_Object sl029a
39574>>>>>>>>>Register_Object Wtypkin_DD
39574>>>>>>>>>
39574>>>>>>>>>
39574>>>>>>>>>    //AB-IgnoreStart
39574>>>>>>>>>
39574>>>>>>>>>    Use DFAllEnt.pkg
39574>>>>>>>>>    Use dbList.Sub
39574>>>>>>>>>    Use Button.Sub
39574>>>>>>>>>
39574>>>>>>>>>
39574>>>>>>>>>    Use WTYPKIN.DD
39574>>>>>>>>>    
39574>>>>>>>>>    //AB-IgnoreEnd
39574>>>>>>>>>
39574>>>>>>>>>    Object sl029a is a dbModalPanelSub
39576>>>>>>>>>        set label to "Ž¨ ©£æª ‰ ¤ã©œà¤ €§¦Ÿã¡žª" 
39577>>>>>>>>>        Set Size to 148 297
39578>>>>>>>>>        Set Location to 4 5
39579>>>>>>>>>        Set Exit_Application_Local_State to FALSE
39580>>>>>>>>>        Set Modal_State to FALSE
39581>>>>>>>>>
39581>>>>>>>>>        //AB-DDOStart
39581>>>>>>>>>
39581>>>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
39583>>>>>>>>>        End_Object    // Wtypkin_DD
39584>>>>>>>>>
39584>>>>>>>>>        Set Main_DD to (Wtypkin_DD(self))
39585>>>>>>>>>        Set Server to (Wtypkin_DD(self))
39586>>>>>>>>>
39586>>>>>>>>>        //AB-DDOEnd
39586>>>>>>>>>
39586>>>>>>>>>        Object oSelList is a dbListSub
39588>>>>>>>>>            Set Main_File to Wtypkin.File_Number
39589>>>>>>>>>            Set Size to 105 280
39590>>>>>>>>>            Set Location to 6 6
39591>>>>>>>>>
39591>>>>>>>>>            Begin_Row
39594>>>>>>>>>                Entry_Item Wtypkin.Wtypkin_code
39595>>>>>>>>>                Entry_Item Wtypkin.Wtypkin_descr
39596>>>>>>>>>            End_Row
39601>>>>>>>>>
39601>>>>>>>>>            Set Form_Width    item 0 to 60
39602>>>>>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
39603>>>>>>>>>            
39603>>>>>>>>>            Set Form_Width    item 1 to 212
39604>>>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
39605>>>>>>>>>            
39605>>>>>>>>>        End_Object    // oSelList
39606>>>>>>>>>
39606>>>>>>>>>        Object oOK_bn is a ButtonSub
39608>>>>>>>>>            set label to "&„§ ¢¦šã" 
39609>>>>>>>>>            Set Location to 115 126
39610>>>>>>>>>
39610>>>>>>>>>            //AB-StoreStart
39610>>>>>>>>>            Procedure OnClick
39612>>>>>>>>>                Send OK To (oSelList(current_object))
39613>>>>>>>>>            End_Procedure
39614>>>>>>>>>            //AB-StoreEnd
39614>>>>>>>>>
39614>>>>>>>>>        End_Object    // oOK_bn
39615>>>>>>>>>
39615>>>>>>>>>        Object oCancel_bn is a ButtonSub
39617>>>>>>>>>            set label to "&€¡ç¨à©ž" 
39618>>>>>>>>>            Set Location to 115 181
39619>>>>>>>>>
39619>>>>>>>>>            //AB-StoreStart
39619>>>>>>>>>            Procedure OnClick
39621>>>>>>>>>                Send Cancel To (oSelList(current_object))
39622>>>>>>>>>            End_Procedure
39623>>>>>>>>>            //AB-StoreEnd
39623>>>>>>>>>
39623>>>>>>>>>        End_Object    // oCancel_bn
39624>>>>>>>>>
39624>>>>>>>>>        Object oSearch_bn is a ButtonSub
39626>>>>>>>>>            set label to "€&¤˜ã«ž©ž" 
39627>>>>>>>>>            Set Location to 115 236
39628>>>>>>>>>
39628>>>>>>>>>            //AB-StoreStart
39628>>>>>>>>>            Procedure OnClick
39630>>>>>>>>>                Send Search To (oSelList(current_object))
39631>>>>>>>>>            End_Procedure
39632>>>>>>>>>            //AB-StoreEnd
39632>>>>>>>>>
39632>>>>>>>>>        End_Object    // oSearch_bn
39633>>>>>>>>>
39633>>>>>>>>>
39633>>>>>>>>>        //AB-StoreStart
39633>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39634>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39635>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39636>>>>>>>>>        //AB-StoreEnd
39636>>>>>>>>>
39636>>>>>>>>>    End_Object    // sl029a
39637>>>>>>>>>
39637>>>>>>>>>//AB/     End_Object    // prj
39637>>>>>>>
39637>>>>>>>//DDB-Selection-pkg-End
39637>>>>>>>//DDB-FileEnd
39637>>>>>Use PTYPPAR.DD
INCLUDING FILE: PTYPPAR.DD
39637>>>>>>>//DDB-FileStart
39637>>>>>>>//DDB-HeaderStart
39637>>>>>>>
39637>>>>>>>// File Name : PTYPPAR.DD
39637>>>>>>>// Class Name: Ptyppar_DataDictionary
39637>>>>>>>// Revision  : 88
39637>>>>>>>// Version   : 2
39637>>>>>>>
39637>>>>>>>Use  Windows           // Basic Definitions
39637>>>>>>>Use  DataDict          // DataDictionary Class Definition
39637>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39637>>>>>>>
39637>>>>>>>Open Ptyppar
39639>>>>>>>Open Particle
39641>>>>>>>Open Pseira
INCLUDING FILE: PSEIRA.FD
39643>>>>>>>Open Ptypmet
INCLUDING FILE: PTYPMET.FD
39645>>>>>>>Open Ptypparh
INCLUDING FILE: PTYPPARH.FD
39647>>>>>>>Open Ctypkin
39649>>>>>>>Open Wtypkin
39651>>>>>>>Open Sysrecp
INCLUDING FILE: SYSRECP.FD
39653>>>>>>>Open Syscurxr
39655>>>>>>>
39655>>>>>>>//DDB-HeaderEnd
39655>>>>>>>//DDB-ValidationStart
39655>>>>>>>
39655>>>>>>>Register_Object Ptyppar_Year_Recr_VT
39655>>>>>>>Register_Object Ptyppar_Ptyppar_Is_What_VT
39655>>>>>>>Register_Object Ptyppar_Ptyppar_Module_VT
39655>>>>>>>Register_Object Ptyppar_Ti_Typonei_Pms_VT1
39655>>>>>>>
39655>>>>>>>Object Ptyppar_Year_Recr_VT  is a DescriptionValidationTable
39657>>>>>>>    Set Allow_Blank_State To TRUE
39658>>>>>>>
39658>>>>>>>    Procedure Fill_List
39660>>>>>>>        Forward Send Fill_List
39662>>>>>>>        Send Add_Table_Value  ""  "ƒœ¤ ‘¬££œ«â®œ "
39663>>>>>>>        Send Add_Table_Value  "1"  "¨¦©Ÿœ« ¡á"
39664>>>>>>>        Send Add_Table_Value  "2"  "€­˜ ¨œ« ¡á"
39665>>>>>>>    End_Procedure    // Fill_List
39666>>>>>>>    //DDB-ValidationCustomStart
39666>>>>>>>    //DDB-ValidationCustomEnd
39666>>>>>>>End_Object   // Ptyppar_Year_Recr_VT
39667>>>>>>>
39667>>>>>>>Object Ptyppar_Ptyppar_Is_What_VT  is a DescriptionValidationTable
39669>>>>>>>
39669>>>>>>>    Procedure Fill_List
39671>>>>>>>        Forward Send Fill_List
39673>>>>>>>        Send Add_Table_Value  "1"  "€š¦¨á"
39674>>>>>>>        Send Add_Table_Value  "2"  "é¢ž©ž"
39675>>>>>>>        Send Add_Table_Value  "3"  "€ŠŠŽ"
39676>>>>>>>    End_Procedure    // Fill_List
39677>>>>>>>    //DDB-ValidationCustomStart
39677>>>>>>>    //DDB-ValidationCustomEnd
39677>>>>>>>End_Object   // Ptyppar_Ptyppar_Is_What_VT
39678>>>>>>>
39678>>>>>>>Object Ptyppar_Ptyppar_Module_VT  is a CodeValidationTable
39680>>>>>>>    Set Type_Value        To "MODULE"
39681>>>>>>>    Set Allow_Blank_State To TRUE
39682>>>>>>>    //DDB-ValidationCustomStart
39682>>>>>>>    //DDB-ValidationCustomEnd
39682>>>>>>>End_Object   // Ptyppar_Ptyppar_Module_VT
39683>>>>>>>
39683>>>>>>>Object Ptyppar_Ti_Typonei_Pms_VT1  is a DescriptionValidationTable
39685>>>>>>>    Set Allow_Blank_State To TRUE
39686>>>>>>>
39686>>>>>>>    Procedure Fill_List
39688>>>>>>>        Forward Send Fill_List
39690>>>>>>>        Send Add_Table_Value  ""  "¦©æ«ž«œª ¡˜  €¥åœª"
39691>>>>>>>        Send Add_Table_Value  "1"  "¦©æ«ž«œª"
39692>>>>>>>        Send Add_Table_Value  "2"  "€¥åœª"
39693>>>>>>>    End_Procedure    // Fill_List
39694>>>>>>>    //DDB-ValidationCustomStart
39694>>>>>>>    //DDB-ValidationCustomEnd
39694>>>>>>>End_Object   // Ptyppar_Ti_Typonei_Pms_VT1
39695>>>>>>>//DDB-ValidationEnd
39695>>>>>>>//DDB-SelectionStart
39695>>>>>>>//DDB/ ExternalSelectionList sl012  sl012.SL
39695>>>>>>>Register_Object sl012
39695>>>>>>>//DDB-SelectionEnd
39695>>>>>>>
39695>>>>>>>Class Ptyppar_DataDictionary  is a DataDictionary_Sec
39696>>>>>>>
39696>>>>>>>    Procedure Construct_Object
39697>>>>>>>        Forward Send Construct_Object
39699>>>>>>>        Property Integer piMustNOTConstrain Public 0
39700>>>>>>>        Property Integer piOldCtypkin       Public 0
39701>>>>>>>        Property Integer piOldWtypkin       Public 0
39702>>>>>>>    End_Procedure
39703>>>>>>>
39703>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
39704>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
39706>>>>>>>        Set piOldCtypkin to Ctypkin.Ctypkin_Code
39707>>>>>>>        Set piOldWtypkin to Wtypkin.Wtypkin_Code
39708>>>>>>>    End_Procedure   // New_Current_Record
39709>>>>>>>
39709>>>>>>>    Procedure OnConstrain
39710>>>>>>>        If (piMustNotConstrain(Self)=0) Begin
39712>>>>>>>            Constrain Ptyppar.Company_Code  eq SysCurXR.Company_Code
39714>>>>>>>            Constrain Ptyppar.Branch_Code   eq SysCurXR.Branch_Code
39716>>>>>>>        End
39716>>>>>>>>
39716>>>>>>>    End_Procedure
39717>>>>>>>
39717>>>>>>>    Procedure Clear_Main_File
39718>>>>>>>        Forward Send Clear_Main_File
39720>>>>>>>        Set piOldCtypkin to 0
39721>>>>>>>        Set piOldWtypkin to 0
39722>>>>>>>    End_Procedure
39723>>>>>>>
39723>>>>>>>    Procedure Save_Main_File
39724>>>>>>>        Integer isAdmin iYes
39725>>>>>>>        String  sStr
39725>>>>>>>        Get fig_Is_Admin to isAdmin
39726>>>>>>>
39726>>>>>>>        If (Operation_Origin<>Self) Begin
39728>>>>>>>            If Ptyppar.Recnum Eq 0 Procedure_Return
39731>>>>>>>        End
39731>>>>>>>>
39731>>>>>>>
39731>>>>>>>        If (Operation_Origin=Self) Begin
39733>>>>>>>            If ((piOldCtypkin(Self)<>0) And (piOldCtypkin(Self)<>Ctypkin.Ctypkin_Code)) Begin
39735>>>>>>>                If (Not(isAdmin)) Error 1001 'ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ¡å¤ž©žª §œ¢á«ž'
39738>>>>>>>                Else Begin
39739>>>>>>>                    Move '' to sStr
39740>>>>>>>                    Append sStr '€¤ ˜¢¢á¥œ«œ ¡å¤ž©ž, £§¦¨œå ¤˜ œ§ž¨œá©œ  ã›ž ¡˜«˜®à¨ž£â¤˜ §˜¨˜©«˜« ¡á\n «˜ ¦§¦å˜ â®¦¬¤ ­« ˜®«œå £œ « ª §˜¢ âª ¡ ¤ã©œ ª §¦¬ «é¨˜ ˜¢¢áœ«œ\n„å©«œ ™â™˜ ¦  §àª Ÿâ¢œ«œ ¤˜ ©¬¤œ®å©à ?'
39741>>>>>>>                    Get YesNo_Box sStr to iYes
39742>>>>>>>                    If (iYes=MBR_NO) Error 1000 '€¡¬¨éŸž¡œ ž › ˜› ¡˜©å˜ ˜¢¢˜šãª ˜§¦ «¦¤ ®¨ã©«ž'
39745>>>>>>>                End
39745>>>>>>>>
39745>>>>>>>            End // If ((piOldCtypkin(Self)<>0) And (piOldCtypkin(Self)<>Ctypkin.Ctypkin_Code))
39745>>>>>>>>
39745>>>>>>>            If ((piOldWtypkin(Self)<>0) And (piOldWtypkin(Self)<>Wtypkin.Wtypkin_Code)) Begin
39747>>>>>>>                If (Not(isAdmin)) Error 1002 'ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ¡å¤ž©žª ˜§¦Ÿã¡žª'
39750>>>>>>>                Else Begin
39751>>>>>>>                    Move '' to sStr
39752>>>>>>>                    Append sStr '€¤ ˜¢¢á¥œ«œ ¡å¤ž©ž, £§¦¨œå ¤˜ œ§ž¨œá©œ  ã›ž ¡˜«˜®à¨ž£â¤˜ §˜¨˜©«˜« ¡á\n «˜ ¦§¦å˜ â®¦¬¤ ­« ˜®«œå £œ « ª §˜¢ âª ¡ ¤ã©œ ª §¦¬ «é¨˜ ˜¢¢áœ«œ\n„å©«œ ™â™˜ ¦  §àª Ÿâ¢œ«œ ¤˜ ©¬¤œ®å©à ?'
39753>>>>>>>                    Get YesNo_Box sStr to iYes
39754>>>>>>>                    If (iYes=MBR_NO) Error 1000 '€¡¬¨éŸž¡œ ž › ˜› ¡˜©å˜ ˜¢¢˜šãª ˜§¦ «¦¤ ®¨ã©«ž'
39757>>>>>>>                End
39757>>>>>>>>
39757>>>>>>>            End // ((piOldWtypkin(Self)<>0) And (piOldWtypkin(Self)<>Wtypkin.Wtypkin_Code))
39757>>>>>>>>
39757>>>>>>>        End // If (Operation_Origin=Self)
39757>>>>>>>>
39757>>>>>>>        Forward Send Save_Main_File
39759>>>>>>>    End_Procedure // Save_Main_File
39760>>>>>>>
39760>>>>>>>
39760>>>>>>>    Procedure Update
39761>>>>>>>        Forward Send Update
39763>>>>>>>        // Insert Code Here
39763>>>>>>>//        If (piMustNotConstrain(Self)=0) Begin
39763>>>>>>>            Move SysCurXR.Company_Code  to Ptyppar.Company_Code
39764>>>>>>>            Move SysCurXR.Branch_Code   to Ptyppar.Branch_Code
39765>>>>>>>//        end
39765>>>>>>>//        Move SysCurXR.Year_Year     to Ptyppar.Year_Year
39765>>>>>>>//        Move SysCurXR.Year_Recr     to Ptyppar.Year_Recr
39765>>>>>>>        Move Ctypkin.Ctypkin_Code   to Ptyppar.Ctypkin_Code
39766>>>>>>>        Move Wtypkin.Wtypkin_Code   to Ptyppar.Wtypkin_Code
39767>>>>>>>        if (ptyppar.sysxet_ptyppar='');            move '' to ptyppar.sysx_ptyp_recr
39770>>>>>>>    End_Procedure   // Update
39771>>>>>>>
39771>>>>>>>    Procedure Creating
39772>>>>>>>        Forward Send Creating
39774>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Ptyppar.Ptyppar_Rec0)))))) to Ptyppar.Ptyppar_Recr
39775>>>>>>>    End_Procedure   // Creating
39776>>>>>>>
39776>>>>>>>
39776>>>>>>>    // Define_Fields:
39776>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39776>>>>>>>    Procedure Define_Fields
39777>>>>>>>        Forward Send Define_Fields
39779>>>>>>>        //DDB-Generated-Code-Location
39779>>>>>>>        //DDB-DefineFieldStart
39779>>>>>>>
39779>>>>>>>        Set Main_File            To Ptyppar.File_Number
39780>>>>>>>        Set Cascade_Delete_State To FALSE
39781>>>>>>>
39781>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
39782>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
39783>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39784>>>>>>>
39784>>>>>>>        // Child (Client) file structure................
39784>>>>>>>        Send Add_Client_File  Particle.File_Number
39785>>>>>>>        Send Add_Client_File  Pseira.File_Number
39786>>>>>>>        Send Add_Client_File  Ptypmet.File_Number
39787>>>>>>>        Send Add_Client_File  Ptypparh.File_Number
39788>>>>>>>
39788>>>>>>>        // Parent (Server) file structure...............
39788>>>>>>>        Send Add_Server_File  Ctypkin.File_Number
39789>>>>>>>        Send Add_Server_File  Wtypkin.File_Number
39790>>>>>>>
39790>>>>>>>        // External (System) file structure.............
39790>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
39791>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
39792>>>>>>>
39792>>>>>>>        Define_Auto_Increment  Sysrecp.Ptyppar_Rec0  To Ptyppar.Ptyppar_Rec0
39795>>>>>>>
39795>>>>>>>        // Field-based properties.......................
39795>>>>>>>
39795>>>>>>>        // Ptyppar.Company_Code
39795>>>>>>>
39795>>>>>>>        // Ptyppar.Branch_Code
39795>>>>>>>
39795>>>>>>>        // Ptyppar.Year_Year
39795>>>>>>>
39795>>>>>>>        // Ptyppar.Ctypkin_Code
39795>>>>>>>
39795>>>>>>>        // Ptyppar.Wtypkin_Code
39795>>>>>>>
39795>>>>>>>        // Ptyppar.Year_Recr
39795>>>>>>>        Set Field_Value_Table      Field Ptyppar.Year_Recr To (Ptyppar_Year_Recr_VT(Self))
39796>>>>>>>
39796>>>>>>>        // Ptyppar.Ctypkin_Recr
39796>>>>>>>
39796>>>>>>>        // Ptyppar.Wtypkin_Recr
39796>>>>>>>
39796>>>>>>>        // Ptyppar.Ptyppar_Code
39796>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Code To DD_AUTOFIND
39797>>>>>>>        Set Field_Prompt_Object    Field Ptyppar.Ptyppar_Code To (sl012(Self))
39798>>>>>>>        Set Key_Field_State        Field Ptyppar.Ptyppar_Code To TRUE
39799>>>>>>>
39799>>>>>>>        // Ptyppar.Ptyppar_Rec0
39799>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Rec0 To DD_AUTOFIND
39800>>>>>>>
39800>>>>>>>        // Ptyppar.Ptyppar_Descr
39800>>>>>>>        Set Field_Prompt_Object    Field Ptyppar.Ptyppar_Descr To (sl012(Self))
39801>>>>>>>
39801>>>>>>>        // Ptyppar.Ptyppar_Recr
39801>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Recr To DD_AUTOFIND
39802>>>>>>>
39802>>>>>>>        // Ptyppar.Ptyppar_Is_What
39802>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ptyppar_Is_What To (Ptyppar_Ptyppar_Is_What_VT(Self))
39803>>>>>>>
39803>>>>>>>        // Ptyppar.Ptyppar_Module
39803>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ptyppar_Module To (Ptyppar_Ptyppar_Module_VT(Self))
39804>>>>>>>
39804>>>>>>>        // Ptyppar.Ptyppar_Abrev
39804>>>>>>>
39804>>>>>>>        // Ptyppar.Ftiaxnei_Tpay
39804>>>>>>>        Set Field_Class_Name       Field Ptyppar.Ftiaxnei_Tpay To "dbCheckBoxsub"
39805>>>>>>>
39805>>>>>>>        // Ptyppar.Ti_Typonei_Pms
39805>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ti_Typonei_Pms To (Ptyppar_Ti_Typonei_Pms_VT1(Self))
39806>>>>>>>
39806>>>>>>>        // Ptyppar.Einai_Paroxh_Yp
39806>>>>>>>        Set Field_Checkbox_Values  Field Ptyppar.Einai_Paroxh_Yp To "1"  "0"
39807>>>>>>>        Set Field_Class_Name       Field Ptyppar.Einai_Paroxh_Yp To "dbCheckBoxsub"
39808>>>>>>>
39808>>>>>>>        // Ptyppar.Gtypkin_Code
39808>>>>>>>
39808>>>>>>>        // Ptyppar.Sysxet_Ptyppar
39808>>>>>>>
39808>>>>>>>        // Ptyppar.Sysx_Ptyp_Recr
39808>>>>>>>
39808>>>>>>>        // Ptyppar.Check_Posa_Plaf
39808>>>>>>>
39808>>>>>>>        // Ptyppar.Singular
39808>>>>>>>
39808>>>>>>>        // Ptyppar.Sub
39808>>>>>>>
39808>>>>>>>        // Ptyppar.Constrain
39808>>>>>>>
39808>>>>>>>        // Ptyppar.Label
39808>>>>>>>
39808>>>>>>>        // Ptyppar.Label1
39808>>>>>>>
39808>>>>>>>        // Ptyppar.Sap
39808>>>>>>>
39808>>>>>>>        // Ptyppar.Is_Xondr
39808>>>>>>>
39808>>>>>>>        //DDB-DefineFieldEnd
39808>>>>>>>    End_Procedure    // Define_Fields
39809>>>>>>>
39809>>>>>>>    // Field_Defaults:
39809>>>>>>>    // This procedure is used to establish default field values.
39809>>>>>>>
39809>>>>>>>    Procedure Field_Defaults
39810>>>>>>>        Forward Send Field_Defaults
39812>>>>>>>        //DDB-Generated-Code-Location
39812>>>>>>>        //DDB-FieldDefaultStart
39812>>>>>>>        Set Field_Changed_Value   Field Ptyppar.Ftiaxnei_Tpay To "1"
39813>>>>>>>        Set Field_Changed_Value   Field Ptyppar.Einai_Paroxh_Yp To 0
39814>>>>>>>        //DDB-FieldDefaultEnd
39814>>>>>>>    End_Procedure    // Field_Defaults
39815>>>>>>>
39815>>>>>>>End_Class    // Ptyppar_DataDictionary
39816>>>>>>>//DDB-Selection-pkg-Start
39816>>>>>>>
39816>>>>>>>Use sl012.SL         // sl012
39816>>>>>>>
39816>>>>>>>//DDB-Selection-pkg-End
39816>>>>>>>//DDB-FileEnd
39816>>>>>
39816>>>>>//AB-IgnoreEnd
39816>>>>>
39816>>>>>Object sl012 is a dbModalPanelSub
39818>>>>>
39818>>>>>    //AB-StoreTopStart
39818>>>>>    Property String psModule Public ''
39820>>>>>    Property integer pifromclient Public 0
39822>>>>>    
39822>>>>>    //AB-StoreTopEnd
39822>>>>>
39822>>>>>    Set Label to "’ç§¦  §˜¨˜©«˜« ¡é¤"
39823>>>>>    Set Size to 203 490
39824>>>>>    Set Location to 4 4
39825>>>>>    Set Exit_Application_Local_State to FALSE
39826>>>>>    Set Modal_State to FALSE
39827>>>>>
39827>>>>>    //AB-DDOStart
39827>>>>>
39827>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
39829>>>>>    End_Object    // Ctypkin_DD
39830>>>>>
39830>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
39832>>>>>    End_Object    // Wtypkin_DD
39833>>>>>
39833>>>>>    Object Ptyppar_DD is a Ptyppar_DataDictionary
39835>>>>>        Set DDO_Server to (Ctypkin_DD(self))
39836>>>>>        Set DDO_Server to (Wtypkin_DD(self))
39837>>>>>
39837>>>>>        //AB-StoreStart
39837>>>>>        
39837>>>>>        Procedure OnConstrain
39839>>>>>            Forward Send OnConstrain
39841>>>>>            If (psModule(Self)<>'') Begin
39843>>>>>                Constrain Ptyppar.Ptyppar_Module eq (psModule(Self))
39845>>>>>            End
39845>>>>>>
39845>>>>>            If (pifromclient(self)=1) Begin
39847>>>>>                Constrain Ptyppar.constrain eq '1'
39849>>>>>            End
39849>>>>>>
39849>>>>>        End_Procedure
39850>>>>>        
39850>>>>>        
39850>>>>>        
39850>>>>>        
39850>>>>>        //AB-StoreEnd
39850>>>>>
39850>>>>>    End_Object    // Ptyppar_DD
39851>>>>>
39851>>>>>    Set Main_DD to (Ptyppar_DD(self))
39852>>>>>    Set Server to (Ptyppar_DD(self))
39853>>>>>
39853>>>>>    //AB-DDOEnd
39853>>>>>
39853>>>>>    Object oSelList is a dbListSub
39855>>>>>        Set Main_File to Ptyppar.File_Number
39856>>>>>        Set Size to 161 474
39857>>>>>        Set Location to 6 6
39858>>>>>
39858>>>>>        Begin_Row
39861>>>>>            Entry_Item Ptyppar.Ptyppar_code
39862>>>>>            Entry_Item Ptyppar.Ptyppar_descr
39863>>>>>            Entry_Item Ctypkin.Ctypkin_descr
39864>>>>>            Entry_Item Wtypkin.Wtypkin_descr
39865>>>>>        End_Row
39870>>>>>
39870>>>>>        Set Form_Width    item 0 to 77
39871>>>>>        Set Header_Label  item 0 to "‰à›. ˜¨˜©«˜« ¡¦ç"
39872>>>>>        
39872>>>>>        Set Form_Width    item 1 to 125
39873>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
39874>>>>>        
39874>>>>>        Set Form_Width    item 2 to 137
39875>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
39876>>>>>        
39876>>>>>        Set Form_Width    item 3 to 129
39877>>>>>        Set Header_Label  item 3 to "‰å¤ž©ž €§¦Ÿã¡žª"
39878>>>>>        
39878>>>>>
39878>>>>>        //AB-StoreStart
39878>>>>>        
39878>>>>>        Procedure Activate
39880>>>>>            Forward Send Activate
39882>>>>>            Send Rebuild_Constraints to Ptyppar_DD
39883>>>>>            Send Beginning_Of_Data to oSelList True
39884>>>>>        End_Procedure
39885>>>>>        
39885>>>>>        //AB-StoreEnd
39885>>>>>
39885>>>>>    End_Object    // oSelList
39886>>>>>
39886>>>>>    Object oOK_bn is a ButtonSub
39888>>>>>        Set Label to "&„§ ¢¦šã"
39889>>>>>        Set Location to 171 323
39890>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
39891>>>>>
39891>>>>>        //AB-StoreStart
39891>>>>>        Procedure OnClick
39893>>>>>            Send OK To (oSelList(current_object))
39894>>>>>        End_Procedure
39895>>>>>        //AB-StoreEnd
39895>>>>>
39895>>>>>    End_Object    // oOK_bn
39896>>>>>
39896>>>>>    Object oCancel_bn is a ButtonSub
39898>>>>>        Set Label to "&€¡ç¨à©ž"
39899>>>>>        Set Location to 171 377
39900>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
39901>>>>>
39901>>>>>        //AB-StoreStart
39901>>>>>        Procedure OnClick
39903>>>>>            Send Cancel To (oSelList(current_object))
39904>>>>>        End_Procedure
39905>>>>>        //AB-StoreEnd
39905>>>>>
39905>>>>>    End_Object    // oCancel_bn
39906>>>>>
39906>>>>>    Object oSearch_bn is a ButtonSub
39908>>>>>        Set Label to "€&¤˜ã«ž©ž"
39909>>>>>        Set Location to 171 433
39910>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
39911>>>>>
39911>>>>>        //AB-StoreStart
39911>>>>>        Procedure OnClick
39913>>>>>            Send Search To (oSelList(current_object))
39914>>>>>        End_Procedure
39915>>>>>        //AB-StoreEnd
39915>>>>>
39915>>>>>    End_Object    // oSearch_bn
39916>>>>>
39916>>>>>
39916>>>>>    //AB-StoreStart
39916>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39917>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39918>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39919>>>>>    
39919>>>>>    
39919>>>>>    //AB-StoreEnd
39919>>>>>
39919>>>>>End_Object    // sl012
39920>>>>>
39920>>>>>//AB/ End_Object    // prj
39920>>>Use sl013.sl
INCLUDING FILE: SL013.SL
39920>>>>>//AB/ Project sl013:SeiraP
39920>>>>>//AB/     Object prj is a Lookup_Project
39920>>>>>//AB/         Set ProjectName to "sl013:SeiraP"
39920>>>>>//AB/         Set ProjectFileName to "sl013.SL"
39920>>>>>//AB/         Set GenerateFileName to "NONAME"
39920>>>>>
39920>>>>>// Project Object Structure
39920>>>>>//   sl013 is a dbModalPanelSub
39920>>>>>//     Ctypkin_DD is a DataDictionary
39920>>>>>//     Wtypkin_DD is a DataDictionary
39920>>>>>//     Ptyppar_DD is a DataDictionary
39920>>>>>//     Pseira_DD is a DataDictionary
39920>>>>>//     oSelList is a dbListSub
39920>>>>>//     oOK_bn is a ButtonSub
39920>>>>>//     oCancel_bn is a ButtonSub
39920>>>>>//     oSearch_bn is a ButtonSub
39920>>>>>
39920>>>>>// Register all objects
39920>>>>>Register_Object Ctypkin_DD
39920>>>>>Register_Object oCancel_bn
39920>>>>>Register_Object oOK_bn
39920>>>>>Register_Object oSearch_bn
39920>>>>>Register_Object oSelList
39920>>>>>Register_Object Pseira_DD
39920>>>>>Register_Object Ptyppar_DD
39920>>>>>Register_Object sl013
39920>>>>>Register_Object Wtypkin_DD
39920>>>>>
39920>>>>>
39920>>>>>    //AB-IgnoreStart
39920>>>>>
39920>>>>>    Use DFAllEnt.pkg
39920>>>>>    Use dbList.Sub
39920>>>>>    Use Button.Sub
39920>>>>>
39920>>>>>
39920>>>>>    Use CTYPKIN.DD
39920>>>>>    Use WTYPKIN.DD
39920>>>>>    Use PTYPPAR.DD
39920>>>>>    Use PSEIRA.DD
INCLUDING FILE: PSEIRA.DD
39920>>>>>>>//DDB-FileStart
39920>>>>>>>//DDB-HeaderStart
39920>>>>>>>
39920>>>>>>>// File Name : PSEIRA.DD
39920>>>>>>>// Class Name: Pseira_DataDictionary
39920>>>>>>>// Revision  : 34
39920>>>>>>>// Version   : 2
39920>>>>>>>
39920>>>>>>>Use  Windows           // Basic Definitions
39920>>>>>>>Use  DataDict          // DataDictionary Class Definition
39920>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39920>>>>>>>
39920>>>>>>>Open Pseira
39922>>>>>>>Open Ptyppar
39924>>>>>>>Open Sysrecp
39926>>>>>>>Open Syscurxr
39928>>>>>>>
39928>>>>>>>//DDB-HeaderEnd
39928>>>>>>>//DDB-SelectionStart
39928>>>>>>>//DDB/ ExternalSelectionList sl013  sl013.SL
39928>>>>>>>Register_Object sl013
39928>>>>>>>//DDB-SelectionEnd
39928>>>>>>>
39928>>>>>>>Class Pseira_DataDictionary  is a DataDictionary
39929>>>>>>>
39929>>>>>>>    Procedure Save_Main_File
39930>>>>>>>        If (Operation_Origin<>Self) Begin
39932>>>>>>>            If Pseira.Recnum Eq 0 Procedure_Return
39935>>>>>>>        End
39935>>>>>>>>
39935>>>>>>>        Forward Send Save_Main_File
39937>>>>>>>    End_Procedure
39938>>>>>>>
39938>>>>>>>    Procedure Update
39939>>>>>>>        Forward Send Update
39941>>>>>>>        // Insert Code Here
39941>>>>>>>        Move SysCurXR.Company_Code  to Pseira.Company_Code
39942>>>>>>>        Move SysCurXR.Branch_Code   to Pseira.Branch_Code
39943>>>>>>>        Move SysCurXR.Year_Year     to Pseira.Year_Year
39944>>>>>>>        Move Ctypkin.Ctypkin_Code   to Pseira.Ctypkin_Code
39945>>>>>>>        Move Wtypkin.Wtypkin_Code   to Pseira.Wtypkin_Code
39946>>>>>>>        Move Ptyppar.Ptyppar_Code   to Pseira.Ptyppar_Code
39947>>>>>>>    End_Procedure   // Update
39948>>>>>>>
39948>>>>>>>
39948>>>>>>>     Procedure Creating
39949>>>>>>>        Forward Send Creating
39951>>>>>>>        // Insert Code Here
39951>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Pseira.Pseira_Rec0)))))) to Pseira.Pseira_Recr
39952>>>>>>>    End_Procedure   // Creating
39953>>>>>>>
39953>>>>>>>
39953>>>>>>>    // Define_Fields:
39953>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39953>>>>>>>
39953>>>>>>>    Procedure Define_Fields
39954>>>>>>>        Forward Send Define_Fields
39956>>>>>>>        //DDB-Generated-Code-Location
39956>>>>>>>        //DDB-DefineFieldStart
39956>>>>>>>
39956>>>>>>>        Set Main_File            To Pseira.File_Number
39957>>>>>>>        Set Cascade_Delete_State To FALSE
39958>>>>>>>
39958>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39959>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39960>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39961>>>>>>>
39961>>>>>>>        // Parent (Server) file structure...............
39961>>>>>>>        Send Add_Server_File  Ptyppar.File_Number
39962>>>>>>>
39962>>>>>>>        // External (System) file structure.............
39962>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
39963>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
39964>>>>>>>
39964>>>>>>>        Define_Auto_Increment  Sysrecp.Pseira_Rec0  To Pseira.Pseira_Rec0
39967>>>>>>>
39967>>>>>>>        // Field-based properties.......................
39967>>>>>>>
39967>>>>>>>        // Pseira.Company_Code
39967>>>>>>>
39967>>>>>>>        // Pseira.Branch_Code
39967>>>>>>>
39967>>>>>>>        // Pseira.Year_Year
39967>>>>>>>
39967>>>>>>>        // Pseira.Ctypkin_Code
39967>>>>>>>
39967>>>>>>>        // Pseira.Wtypkin_Code
39967>>>>>>>
39967>>>>>>>        // Pseira.Ptyppar_Code
39967>>>>>>>
39967>>>>>>>        // Pseira.Ptyppar_Recr
39967>>>>>>>
39967>>>>>>>        // Pseira.Pseira_Seira
39967>>>>>>>        Set Field_Options          Field Pseira.Pseira_Seira To DD_AUTOFIND   
39968>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Seira To (sl013(Self))
39969>>>>>>>
39969>>>>>>>        // Pseira.Pseira_Rec0
39969>>>>>>>        Set Field_Options          Field Pseira.Pseira_Rec0 To DD_AUTOFIND   
39970>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Rec0 To (sl013(Self))
39971>>>>>>>
39971>>>>>>>        // Pseira.Pseira_Recr
39971>>>>>>>        Set Field_Options          Field Pseira.Pseira_Recr To DD_AUTOFIND   
39972>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Recr To (sl013(Self))
39973>>>>>>>
39973>>>>>>>        // Pseira.Pseira_Printer
39973>>>>>>>
39973>>>>>>>        // Pseira.Pseira_Form
39973>>>>>>>
39973>>>>>>>        // Pseira.Pseira_Autonum
39973>>>>>>>
39973>>>>>>>        // Pseira.Autonum_Plus
39973>>>>>>>
39973>>>>>>>        // Pseira.Autonum_Minus
39973>>>>>>>
39973>>>>>>>        // Pseira.Auto_Plus_Last
39973>>>>>>>
39973>>>>>>>        //DDB-DefineFieldEnd
39973>>>>>>>    End_Procedure    // Define_Fields
39974>>>>>>>
39974>>>>>>>    // Field_Defaults:
39974>>>>>>>    // This procedure is used to establish default field values.
39974>>>>>>>
39974>>>>>>>    Procedure Field_Defaults
39975>>>>>>>        Forward Send Field_Defaults
39977>>>>>>>        //DDB-Generated-Code-Location
39977>>>>>>>        //DDB-FieldDefaultStart
39977>>>>>>>        //DDB-FieldDefaultEnd
39977>>>>>>>    End_Procedure    // Field_Defaults
39978>>>>>>>
39978>>>>>>>End_Class    // Pseira_DataDictionary
39979>>>>>>>//DDB-Selection-pkg-Start
39979>>>>>>>
39979>>>>>>>Use sl013.SL         // sl013
39979>>>>>>>
39979>>>>>>>//DDB-Selection-pkg-End
39979>>>>>>>//DDB-FileEnd
39979>>>>>    
39979>>>>>    //AB-IgnoreEnd
39979>>>>>
39979>>>>>    Object sl013 is a dbModalPanelSub
39981>>>>>
39981>>>>>        //AB-StoreTopStart
39981>>>>>        Property String FragmaPtyppar_Recr Public ''
39983>>>>>        
39983>>>>>        //AB-StoreTopEnd
39983>>>>>
39983>>>>>        Set Label to "‰˜«á¢¦š¦ª ‘œ ¨é¤"
39984>>>>>        Set Size to 148 214
39985>>>>>        Set Location to 1 7
39986>>>>>        Set Exit_Application_Local_State to FALSE
39987>>>>>        Set Modal_State to FALSE
39988>>>>>
39988>>>>>        //AB-DDOStart
39988>>>>>
39988>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
39990>>>>>        End_Object    // Ctypkin_DD
39991>>>>>
39991>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
39993>>>>>        End_Object    // Wtypkin_DD
39994>>>>>
39994>>>>>        Object Ptyppar_DD is a Ptyppar_DataDictionary
39996>>>>>            Set DDO_Server to (Ctypkin_DD(self))
39997>>>>>            Set DDO_Server to (Wtypkin_DD(self))
39998>>>>>        End_Object    // Ptyppar_DD
39999>>>>>
39999>>>>>        Object Pseira_DD is a Pseira_DataDictionary
40001>>>>>            Set DDO_Server to (Ptyppar_DD(self))
40002>>>>>
40002>>>>>            //AB-StoreStart
40002>>>>>            Procedure OnConstrain
40004>>>>>                String sID
40005>>>>>                Forward Send OnConstrain
40007>>>>>                Get FragmaPtyppar_Recr to sID
40008>>>>>                Move (trim(sID)) to sID
40009>>>>>                If (sID<>'') Constrain Pseira.Ptyppar_Recr eq sID
40013>>>>>            End_procedure
40014>>>>>            
40014>>>>>            //AB-StoreEnd
40014>>>>>
40014>>>>>        End_Object    // Pseira_DD
40015>>>>>
40015>>>>>        Set Main_DD to (Pseira_DD(self))
40016>>>>>        Set Server to (Pseira_DD(self))
40017>>>>>
40017>>>>>        //AB-DDOEnd
40017>>>>>
40017>>>>>        Object oSelList is a dbListSub
40019>>>>>            Set Main_File to Pseira.File_Number
40020>>>>>            Set Size to 105 197
40021>>>>>            Set Location to 6 6
40022>>>>>
40022>>>>>            Begin_Row
40025>>>>>                Entry_Item Pseira.Pseira_seira
40026>>>>>                Entry_Item Pseira.Pseira_printer
40027>>>>>                Entry_Item Pseira.Pseira_autonum
40028>>>>>            End_Row
40033>>>>>
40033>>>>>            Set Form_Width    item 0 to 40
40034>>>>>            Set Header_Label  item 0 to "‘œ ¨á"
40035>>>>>            
40035>>>>>            Set Form_Width    item 1 to 135
40036>>>>>            Set Header_Label  item 1 to "„¡«¬§à«ãª"
40037>>>>>            
40037>>>>>            Set Form_Width    item 2 to 16
40038>>>>>            Set Header_Label  item 2 to "Autonum"
40039>>>>>            Set Column_Checkbox_State  item 2 to True
40040>>>>>            
40040>>>>>
40040>>>>>            //AB-StoreStart
40040>>>>>                    
40040>>>>>            Property String StoreFragmaPtyppar_Recr Public ''
40042>>>>>            
40042>>>>>            Procedure Store_Defaults
40044>>>>>                   Forward Send Store_Defaults
40046>>>>>                   Set StoreFragmaPtyppar_Recr to (FragmaPtyppar_Recr(Self))
40047>>>>>            End_Procedure
40048>>>>>            
40048>>>>>            Procedure ReStore_Defaults
40050>>>>>                   Forward Send ReStore_Defaults
40052>>>>>                   Set FragmaPtyppar_Recr to (StoreFragmaPtyppar_Recr(Self))
40053>>>>>            End_Procedure
40054>>>>>            
40054>>>>>            Procedure Activating
40056>>>>>                Forward Send Activating
40058>>>>>                Send Rebuild_Constraints to (Pseira_DD(Self))
40059>>>>>            End_Procedure
40060>>>>>            
40060>>>>>            
40060>>>>>            //AB-StoreEnd
40060>>>>>
40060>>>>>        End_Object    // oSelList
40061>>>>>
40061>>>>>        Object oOK_bn is a ButtonSub
40063>>>>>            Set Label to "&„§ ¢¦šã"
40064>>>>>            Set Location to 114 42
40065>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
40066>>>>>
40066>>>>>            //AB-StoreStart
40066>>>>>            Procedure OnClick
40068>>>>>                Send OK To (oSelList(current_object))
40069>>>>>            End_Procedure
40070>>>>>            //AB-StoreEnd
40070>>>>>
40070>>>>>        End_Object    // oOK_bn
40071>>>>>
40071>>>>>        Object oCancel_bn is a ButtonSub
40073>>>>>            Set Label to "&€¡ç¨à©ž"
40074>>>>>            Set Location to 114 98
40075>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
40076>>>>>
40076>>>>>            //AB-StoreStart
40076>>>>>            Procedure OnClick
40078>>>>>                Send Cancel To (oSelList(current_object))
40079>>>>>            End_Procedure
40080>>>>>            //AB-StoreEnd
40080>>>>>
40080>>>>>        End_Object    // oCancel_bn
40081>>>>>
40081>>>>>        Object oSearch_bn is a ButtonSub
40083>>>>>            Set Label to "€&¤˜ã«ž©ž"
40084>>>>>            Set Location to 114 153
40085>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
40086>>>>>
40086>>>>>            //AB-StoreStart
40086>>>>>            Procedure OnClick
40088>>>>>                Send Search To (oSelList(current_object))
40089>>>>>            End_Procedure
40090>>>>>            //AB-StoreEnd
40090>>>>>
40090>>>>>        End_Object    // oSearch_bn
40091>>>>>
40091>>>>>
40091>>>>>        //AB-StoreStart
40091>>>>>            
40091>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
40092>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
40093>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
40094>>>>>        
40094>>>>>        
40094>>>>>        
40094>>>>>        
40094>>>>>        
40094>>>>>        
40094>>>>>        
40094>>>>>        
40094>>>>>        //AB-StoreEnd
40094>>>>>
40094>>>>>    End_Object    // sl013
40095>>>>>
40095>>>>>//AB/     End_Object    // prj
40095>>>Use sl013b.sl
INCLUDING FILE: SL013B.SL
40095>>>>>//AB/ Project sl013b : Pseira
40095>>>>>//AB/ Object prj is a Lookup_Project
40095>>>>>//AB/     Set ProjectName to "sl013b : Pseira"
40095>>>>>//AB/     Set ProjectFileName to "sl013b.SL"
40095>>>>>//AB/     Set GenerateFileName to "NONAME"
40095>>>>>
40095>>>>>// Project Object Structure
40095>>>>>//   sl013b is a dbModalPanelSub
40095>>>>>//     Ctypkin_DD is a DataDictionary
40095>>>>>//     Wtypkin_DD is a DataDictionary
40095>>>>>//     Ptyppar_DD is a DataDictionary
40095>>>>>//     Pseira_DD is a DataDictionary
40095>>>>>//     oSelList is a dbListSub
40095>>>>>//     oOK_bn is a ButtonSub
40095>>>>>//     oCancel_bn is a ButtonSub
40095>>>>>//     oSearch_bn is a ButtonSub
40095>>>>>
40095>>>>>// Register all objects
40095>>>>>Register_Object Ctypkin_DD
40095>>>>>Register_Object oCancel_bn
40095>>>>>Register_Object oOK_bn
40095>>>>>Register_Object oSearch_bn
40095>>>>>Register_Object oSelList
40095>>>>>Register_Object Pseira_DD
40095>>>>>Register_Object Ptyppar_DD
40095>>>>>Register_Object sl013b
40095>>>>>Register_Object Wtypkin_DD
40095>>>>>
40095>>>>>
40095>>>>>//AB-IgnoreStart
40095>>>>>
40095>>>>>Use DFAllEnt.pkg
40095>>>>>Use dbList.Sub
40095>>>>>Use Button.Sub
40095>>>>>
40095>>>>>
40095>>>>>Use CTYPKIN.DD
40095>>>>>Use WTYPKIN.DD
40095>>>>>Use PTYPPAR.DD
40095>>>>>Use PSEIRA.DD
40095>>>>>
40095>>>>>//AB-IgnoreEnd
40095>>>>>
40095>>>>>Object sl013b is a dbModalPanelSub
40097>>>>>    set label to "‘œ ¨œª §˜¨˜©«˜« ¡é¤ §é¢ž©žª" 
40098>>>>>    Set Size to 148 297
40099>>>>>    Set Location to 4 4
40100>>>>>    Set Exit_Application_Local_State to FALSE
40101>>>>>    Set Modal_State to FALSE
40102>>>>>
40102>>>>>    //AB-DDOStart
40102>>>>>
40102>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
40104>>>>>    End_Object    // Ctypkin_DD
40105>>>>>
40105>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
40107>>>>>    End_Object    // Wtypkin_DD
40108>>>>>
40108>>>>>    Object Ptyppar_DD is a Ptyppar_DataDictionary
40110>>>>>        Set DDO_Server to (Ctypkin_DD(self))
40111>>>>>        Set DDO_Server to (Wtypkin_DD(self))
40112>>>>>    End_Object    // Ptyppar_DD
40113>>>>>
40113>>>>>    Object Pseira_DD is a Pseira_DataDictionary
40115>>>>>        Set DDO_Server to (Ptyppar_DD(self))
40116>>>>>    End_Object    // Pseira_DD
40117>>>>>
40117>>>>>    Set Main_DD to (Pseira_DD(self))
40118>>>>>    Set Server to (Pseira_DD(self))
40119>>>>>
40119>>>>>    //AB-DDOEnd
40119>>>>>
40119>>>>>    Object oSelList is a dbListSub
40121>>>>>        Set Main_File to Pseira.File_Number
40122>>>>>        Set Size to 105 280
40123>>>>>        Set Location to 6 6
40124>>>>>
40124>>>>>        Begin_Row
40127>>>>>            Entry_Item Pseira.Pseira_seira
40128>>>>>        End_Row
40133>>>>>
40133>>>>>        Set Form_Width    item 0 to 270
40134>>>>>        set header_label  item 0 to "‘œ ¨˜" 
40135>>>>>        
40135>>>>>    End_Object    // oSelList
40136>>>>>
40136>>>>>    Object oOK_bn is a ButtonSub
40138>>>>>        set label to "&„§ ¢¦šã" 
40139>>>>>        Set Location to 115 126
40140>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
40141>>>>>
40141>>>>>        //AB-StoreStart
40141>>>>>        Procedure OnClick
40143>>>>>            Send OK To (oSelList(current_object))
40144>>>>>        End_Procedure
40145>>>>>        //AB-StoreEnd
40145>>>>>
40145>>>>>    End_Object    // oOK_bn
40146>>>>>
40146>>>>>    Object oCancel_bn is a ButtonSub
40148>>>>>        set label to "&€¡ç¨à©ž" 
40149>>>>>        Set Location to 115 181
40150>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
40151>>>>>
40151>>>>>        //AB-StoreStart
40151>>>>>        Procedure OnClick
40153>>>>>            Send Cancel To (oSelList(current_object))
40154>>>>>        End_Procedure
40155>>>>>        //AB-StoreEnd
40155>>>>>
40155>>>>>    End_Object    // oCancel_bn
40156>>>>>
40156>>>>>    Object oSearch_bn is a ButtonSub
40158>>>>>        set label to "€&¤˜ã«ž©ž" 
40159>>>>>        Set Location to 115 236
40160>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
40161>>>>>
40161>>>>>        //AB-StoreStart
40161>>>>>        Procedure OnClick
40163>>>>>            Send Search To (oSelList(current_object))
40164>>>>>        End_Procedure
40165>>>>>        //AB-StoreEnd
40165>>>>>
40165>>>>>    End_Object    // oSearch_bn
40166>>>>>
40166>>>>>
40166>>>>>    //AB-StoreStart
40166>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
40167>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
40168>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
40169>>>>>    //AB-StoreEnd
40169>>>>>
40169>>>>>End_Object    // sl013b
40170>>>>>
40170>>>>>//AB/ End_Object    // prj
40170>>>Use sl014.sl
INCLUDING FILE: SL014.SL
40170>>>>>//AB/ Project sl014:Particle Lookup
40170>>>>>//AB/ Object prj is a Lookup_Project
40170>>>>>//AB/     Set ProjectName to "sl014:Particle Lookup"
40170>>>>>//AB/     Set ProjectFileName to "sl014.SL"
40170>>>>>//AB/     Set GenerateFileName to "NONAME"
40170>>>>>
40170>>>>>// Project Object Structure
40170>>>>>//   sl014 is a dbModalPanelSub
40170>>>>>//     Ctypkin_DD is a DataDictionary
40170>>>>>//     Wtypkin_DD is a DataDictionary
40170>>>>>//     Ptyppar_DD is a DataDictionary
40170>>>>>//     Clients_DD is a DataDictionary
40170>>>>>//     Nomisma_DD is a DataDictionary
40170>>>>>//     Particle_DD is a DataDictionary
40170>>>>>//     oSelList is a dbListSub
40170>>>>>//     cSyDateForm1 is a cSyDateForm
40170>>>>>//     FormSub1 is a FormSub
40170>>>>>//     FormSub3 is a FormSub
40170>>>>>//     FormSub2 is a FormSub
40170>>>>>//     FormSub4 is a FormSub
40170>>>>>//     FormSub5 is a FormSub
40170>>>>>//     TextBoxSub1 is a TextBoxSub
40170>>>>>//     TextBoxSub2 is a TextBoxSub
40170>>>>>//     TextBoxSub3 is a TextBoxSub
40170>>>>>//     ButtonSub1 is a ButtonSub
40170>>>>>//     oOk_bn is a ButtonSub
40170>>>>>//     oSearch_bn is a ButtonSub
40170>>>>>//     TextBoxSub4 is a TextBoxSub
40170>>>>>
40170>>>>>// Register all objects
40170>>>>>Register_Object ButtonSub1
40170>>>>>Register_Object Clients_DD
40170>>>>>Register_Object Ctypkin_DD
40170>>>>>Register_Object cSyDateForm1
40170>>>>>Register_Object FormSub1
40170>>>>>Register_Object FormSub2
40170>>>>>Register_Object FormSub3
40170>>>>>Register_Object FormSub4
40170>>>>>Register_Object FormSub5
40170>>>>>Register_Object Nomisma_DD
40170>>>>>Register_Object oOk_bn
40170>>>>>Register_Object oSearch_bn
40170>>>>>Register_Object oSelList
40170>>>>>Register_Object Particle_DD
40170>>>>>Register_Object Ptyppar_DD
40170>>>>>Register_Object sl014
40170>>>>>Register_Object TextBoxSub1
40170>>>>>Register_Object TextBoxSub2
40170>>>>>Register_Object TextBoxSub3
40170>>>>>Register_Object TextBoxSub4
40170>>>>>Register_Object Wtypkin_DD
40170>>>>>
40170>>>>>
40170>>>>>
40170>>>>>//AB-StoreTopStart
40170>>>>>            
40170>>>>>Open PtypparL
40172>>>>>
40172>>>>>Use sl100.sl
40172>>>>>Use sl012.sl
40172>>>>>
40172>>>>>//AB-StoreTopEnd
40172>>>>>
40172>>>>>//AB-IgnoreStart
40172>>>>>
40172>>>>>Use DFAllEnt.pkg
40172>>>>>Use dbList.Sub
40172>>>>>Use cSyDateForm.Pkg
INCLUDING FILE: CSYDATEFORM.PKG
40172>>>>>>>Use cSyDateIntelliMix.pkg
INCLUDING FILE: CSYDATEINTELLIMIX.PKG
40172>>>>>>>>>Use cOutlook.Sl // Needed for date prompt.
INCLUDING FILE: COUTLOOK.SL
40172>>>>>>>>>>>//AB/ Project Calendar Outlook
40172>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
40172>>>>>>>>>>>//AB/         Set ProjectName to "Calendar Outlook"
40172>>>>>>>>>>>//AB/         Set ProjectFileName to "coutlook.sl"
40172>>>>>>>>>>>
40172>>>>>>>>>>>// Project Object Structure
40172>>>>>>>>>>>//   oCalendar is a BasicPanelSub
40172>>>>>>>>>>>//     Container3d1 is a Container3d
40172>>>>>>>>>>>//       Grid2 is a Grid
40172>>>>>>>>>>>//         cOutlookFloatingMenu is a FloatingPopupMenu
40172>>>>>>>>>>>//       Textbox2 is a Textbox
40172>>>>>>>>>>>//       Textbox3 is a Textbox
40172>>>>>>>>>>>//       Textbox4 is a Textbox
40172>>>>>>>>>>>//       Textbox5 is a Textbox
40172>>>>>>>>>>>//       Textbox6 is a Textbox
40172>>>>>>>>>>>//       Textbox7 is a Textbox
40172>>>>>>>>>>>//       Textbox8 is a Textbox
40172>>>>>>>>>>>//       LineControl1 is a LineControl
40172>>>>>>>>>>>//       Container3d2 is a Container3d
40172>>>>>>>>>>>//         oRght is a BitmapContainer
40172>>>>>>>>>>>//         oLeft is a BitmapContainer
40172>>>>>>>>>>>//         oMonth is a Textbox
40172>>>>>>>>>>>//           oSelectMonth is a FloatingPopupMenu
40172>>>>>>>>>>>//         oCalendarYear is a Textbox
40172>>>>>>>>>>>//         oSelectCalendarYear is a Form
40172>>>>>>>>>>>//     BitmapContainer3 is a BitmapContainer
40172>>>>>>>>>>>//     oToday is a Textbox
40172>>>>>>>>>>>//     oCloseCalendar_bn is a BitmapContainer
40172>>>>>>>>>>>//     Help_Container is a Container3d
40172>>>>>>>>>>>//       Help_Info is a Edit
40172>>>>>>>>>>>//         HelpFloatingMenu is a FloatingPopupMenu
40172>>>>>>>>>>>
40172>>>>>>>>>>>// Register all objects
40172>>>>>>>>>>>Register_Object BitmapContainer3
40172>>>>>>>>>>>Register_Object Container3d1
40172>>>>>>>>>>>Register_Object Container3d2
40172>>>>>>>>>>>Register_Object cOutlookFloatingMenu
40172>>>>>>>>>>>Register_Object Grid2
40172>>>>>>>>>>>Register_Object Help_Container
40172>>>>>>>>>>>Register_Object Help_Info
40172>>>>>>>>>>>Register_Object HelpFloatingMenu
40172>>>>>>>>>>>Register_Object LineControl1
40172>>>>>>>>>>>Register_Object oCalendar
40172>>>>>>>>>>>Register_Object oCalendarYear
40172>>>>>>>>>>>Register_Object oCloseCalendar_bn
40172>>>>>>>>>>>Register_Object oLeft
40172>>>>>>>>>>>Register_Object oMonth
40172>>>>>>>>>>>Register_Object oRght
40172>>>>>>>>>>>Register_Object oSelectCalendarYear
40172>>>>>>>>>>>Register_Object oSelectMonth
40172>>>>>>>>>>>Register_Object oToday
40172>>>>>>>>>>>Register_Object Textbox2
40172>>>>>>>>>>>Register_Object Textbox3
40172>>>>>>>>>>>Register_Object Textbox4
40172>>>>>>>>>>>Register_Object Textbox5
40172>>>>>>>>>>>Register_Object Textbox6
40172>>>>>>>>>>>Register_Object Textbox7
40172>>>>>>>>>>>Register_Object Textbox8
40172>>>>>>>>>>>
40172>>>>>>>>>>>
40172>>>>>>>>>>>
40172>>>>>>>>>>>    //AB-StoreTopStart
40172>>>>>>>>>>>    Use dates.utl
40172>>>>>>>>>>>
40172>>>>>>>>>>>
40172>>>>>>>>>>>    //AB-StoreTopEnd
40172>>>>>>>>>>>
40172>>>>>>>>>>>    //AB-IgnoreStart
40172>>>>>>>>>>>
40172>>>>>>>>>>>    Use Panel.Sub
40172>>>>>>>>>>>    Use DFAllEnt.pkg
40172>>>>>>>>>>>
40172>>>>>>>>>>>
40172>>>>>>>>>>>
40172>>>>>>>>>>>    //AB-IgnoreEnd
40172>>>>>>>>>>>
40172>>>>>>>>>>>    Object oCalendar is a BasicPanelSub
40174>>>>>>>>>>>        Set Border_Style to Border_Normal
40175>>>>>>>>>>>        Set Caption_Bar to FALSE
40176>>>>>>>>>>>        Set Label to "January, 2001"
40177>>>>>>>>>>>        Set Size to 98 123
40178>>>>>>>>>>>        Set Location to 10 22
40179>>>>>>>>>>>        Set Color to clWhite
40180>>>>>>>>>>>        Set Exit_Application_Local_State to TRUE
40181>>>>>>>>>>>        Set Popup_State to TRUE
40182>>>>>>>>>>>
40182>>>>>>>>>>>        //AB-DDOStart
40182>>>>>>>>>>>
40182>>>>>>>>>>>
40182>>>>>>>>>>>        //AB-DDOEnd
40182>>>>>>>>>>>
40182>>>>>>>>>>>        Object Container3d1 is a Container3d
40184>>>>>>>>>>>            Set Size to 88 135
40185>>>>>>>>>>>            Set Location to -2 -1
40186>>>>>>>>>>>            Set Color to clWhite
40187>>>>>>>>>>>            Set Border_Style to Border_None
40188>>>>>>>>>>>            Object Grid2 is a Grid
40190>>>>>>>>>>>
40190>>>>>>>>>>>                //AB-StoreTopStart
40190>>>>>>>>>>>                property date    p_current_date     0
40192>>>>>>>>>>>                property integer p_current_year     -1
40194>>>>>>>>>>>                property integer p_current_month    -1
40196>>>>>>>>>>>                property integer p_selected_day     -1
40198>>>>>>>>>>>                property integer pExportState       1
40200>>>>>>>>>>>                property integer invoking_object_id 0
40202>>>>>>>>>>>                Property integer piCurrentDayItem   -1
40204>>>>>>>>>>>
40204>>>>>>>>>>>                Set Border_Style To BORDER_NONE
40205>>>>>>>>>>>                Set header_visible_state To False
40206>>>>>>>>>>>                set select_mode to no_select
40207>>>>>>>>>>>                Set Gridline_mode To GRID_VISIBLE_NONE
40208>>>>>>>>>>>
40208>>>>>>>>>>>                on_key Key_F1 Send Help
40209>>>>>>>>>>>                on_key key_ctrl+key_pgup send prev_year
40210>>>>>>>>>>>                on_key key_ctrl+key_pgdn send next_year
40211>>>>>>>>>>>                on_key          key_pgup send prev_month
40212>>>>>>>>>>>                on_key          key_pgdn send next_month
40213>>>>>>>>>>>                on_key key_enter         send move_value_out
40214>>>>>>>>>>>                on_key key_ctrl+key_d    send go_today
40215>>>>>>>>>>>                on_key key_ctrl+key_y    send Change_Year
40216>>>>>>>>>>>
40216>>>>>>>>>>>                //AB-StoreTopEnd
40216>>>>>>>>>>>
40216>>>>>>>>>>>                Set Color to clWhite
40217>>>>>>>>>>>                Set CurrentCellColor to clWhite
40218>>>>>>>>>>>                Set CurrentCellTextColor to clWhite
40219>>>>>>>>>>>                Set Size to 61 145
40220>>>>>>>>>>>                Set Location to 30 1
40221>>>>>>>>>>>                Set Resize_Column_state to FALSE
40222>>>>>>>>>>>
40222>>>>>>>>>>>                Set Line_Width to 7 0
40223>>>>>>>>>>>
40223>>>>>>>>>>>                Set Form_Width    item 0 to 18
40224>>>>>>>>>>>                Set Header_Label  item 0 to "Mo"
40225>>>>>>>>>>>
40225>>>>>>>>>>>                Set Form_Width    item 1 to 18
40226>>>>>>>>>>>                Set Header_Label  item 1 to "Tu"
40227>>>>>>>>>>>
40227>>>>>>>>>>>                Set Form_Width    item 2 to 18
40228>>>>>>>>>>>                Set Header_Label  item 2 to "We"
40229>>>>>>>>>>>
40229>>>>>>>>>>>                Set Form_Width    item 3 to 18
40230>>>>>>>>>>>                Set Header_Label  item 3 to "Th"
40231>>>>>>>>>>>
40231>>>>>>>>>>>                Set Form_Width    item 4 to 18
40232>>>>>>>>>>>                Set Header_Label  item 4 to "Fr"
40233>>>>>>>>>>>
40233>>>>>>>>>>>                Set Form_Width    item 5 to 18
40234>>>>>>>>>>>                Set Header_Label  item 5 to "Sa"
40235>>>>>>>>>>>
40235>>>>>>>>>>>                Set Form_Width    item 6 to 18
40236>>>>>>>>>>>                Set Header_Label  item 6 to "Su"
40237>>>>>>>>>>>
40237>>>>>>>>>>>
40237>>>>>>>>>>>                //AB-StoreStart
40237>>>>>>>>>>>
40237>>>>>>>>>>>                Procedure Change_Year
40239>>>>>>>>>>>                    Send Mouse_Down to (oCalendarYear(Container3d2(Self)))
40240>>>>>>>>>>>                End_Procedure // Change_Year
40241>>>>>>>>>>>
40241>>>>>>>>>>>                procedure go_today
40243>>>>>>>>>>>                    Date date#
40244>>>>>>>>>>>                    sysdate4 date#
40245>>>>>>>>>>>                    set p_current_date to date#
40246>>>>>>>>>>>                    Send Update_Calendar
40247>>>>>>>>>>>                end_procedure
40248>>>>>>>>>>>
40248>>>>>>>>>>>                procedure next_month
40250>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
40251>>>>>>>>>>>                    Send Update_Calendar
40252>>>>>>>>>>>                end_procedure
40253>>>>>>>>>>>
40253>>>>>>>>>>>                procedure prev_month
40255>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
40256>>>>>>>>>>>                    Send Update_Calendar
40257>>>>>>>>>>>                end_procedure
40258>>>>>>>>>>>
40258>>>>>>>>>>>                procedure next_year
40260>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
40261>>>>>>>>>>>                    Send Update_Calendar
40262>>>>>>>>>>>                end_procedure
40263>>>>>>>>>>>
40263>>>>>>>>>>>                procedure prev_year
40265>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
40266>>>>>>>>>>>                    Send Update_Calendar
40267>>>>>>>>>>>                end_procedure
40268>>>>>>>>>>>
40268>>>>>>>>>>>                Procedure Activate
40270>>>>>>>>>>>                    Date date#
40271>>>>>>>>>>>                    Forward Send Activate
40273>>>>>>>>>>>                    Set current_item to (p_selected_day(Self))
40274>>>>>>>>>>>                End_Procedure
40275>>>>>>>>>>>
40275>>>>>>>>>>>                Procedure Update_Calendar
40277>>>>>>>>>>>                    Set Dynamic_Update_State To False
40278>>>>>>>>>>>                    send Fill_List
40279>>>>>>>>>>>                    Set Dynamic_Update_State To True
40280>>>>>>>>>>>                    // Send Update_Label
40280>>>>>>>>>>>                    Set current_item to (p_selected_day(Self))
40281>>>>>>>>>>>                    Send Date_Changing to (oCalendarYear(Container3d2(self)))
40282>>>>>>>>>>>                    Send Date_Changing to (oMonth(Container3d2(self)))
40283>>>>>>>>>>>                End_Procedure
40284>>>>>>>>>>>
40284>>>>>>>>>>>                Procedure Fill_List
40286>>>>>>>>>>>                    Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
40287>>>>>>>>>>>                    Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
40287>>>>>>>>>>>                    Date dToday
40287>>>>>>>>>>>                    Send Delete_Data
40288>>>>>>>>>>>
40288>>>>>>>>>>>                    Get p_current_date to date#
40289>>>>>>>>>>>
40289>>>>>>>>>>>                    SysDate4 dToday
40290>>>>>>>>>>>                    move (DateSegment(dToday,DS_DAY)) to cur_day#
40291>>>>>>>>>>>                    move (DateSegment(dToday,DS_MONTH)) to cur_month#
40292>>>>>>>>>>>                    move (DateSegment(dToday,DS_YEAR)) to cur_year#
40293>>>>>>>>>>>
40293>>>>>>>>>>>                    move (DateSegment(date#,DS_DAY)) to sel_day#
40294>>>>>>>>>>>                    move (DateSegment(date#,DS_MONTH)) to sel_month#
40295>>>>>>>>>>>                    move (DateSegment(date#,DS_YEAR)) to sel_year#
40296>>>>>>>>>>>                    Set p_current_month To sel_month#
40297>>>>>>>>>>>                    Set p_current_year To sel_year#
40298>>>>>>>>>>>
40298>>>>>>>>>>>                    move (FirstDayInMonth(date#)) to date#
40299>>>>>>>>>>>                    move (DateDayNumber(date#)-1) to first_item#
40300>>>>>>>>>>>                    move (LastDayInMonth(date#)-date#+first_item#) to last_item#
40301>>>>>>>>>>>                    move (DateIncrement(date#,DS_Month,-1)) To prevdate#
40302>>>>>>>>>>>                    move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
40303>>>>>>>>>>>
40303>>>>>>>>>>>                    If (first_item# > 0) Begin
40305>>>>>>>>>>>                        Move (first_item#-1) to day#
40306>>>>>>>>>>>                        For iFor from 0 to (first_item#-1)
40312>>>>>>>>>>>>
40312>>>>>>>>>>>                            Send Add_Item msg_move_value_out (prev_last#-day#)
40313>>>>>>>>>>>                            Set Entry_State Item iFor To False
40314>>>>>>>>>>>                            Set ItemTextColor Item iFor To clGray
40315>>>>>>>>>>>                            Decrement day#
40316>>>>>>>>>>>                        Loop
40317>>>>>>>>>>>>
40317>>>>>>>>>>>                    End
40317>>>>>>>>>>>>
40317>>>>>>>>>>>
40317>>>>>>>>>>>                    Move 1 To day#
40318>>>>>>>>>>>                    For iFor from first_item# to last_item#
40324>>>>>>>>>>>>
40324>>>>>>>>>>>                        Send Add_Item Msg_Move_Value_Out day#
40325>>>>>>>>>>>                        Set Entry_State Item iFor To False
40326>>>>>>>>>>>                        If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Begin
40328>>>>>>>>>>>                            Set Form_Bitmap Item iFor To "cdate.bmp"
40329>>>>>>>>>>>                            Set piCurrentDayItem to iFor
40330>>>>>>>>>>>                        End
40330>>>>>>>>>>>>
40330>>>>>>>>>>>                        If Day# eq sel_day# Set p_selected_day To iFor
40333>>>>>>>>>>>                        Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
40334>>>>>>>>>>>                        Set form_datatype item iFor To mask_numeric_window
40335>>>>>>>>>>>                        Set form_Mask item iFor To "## "
40336>>>>>>>>>>>                        Increment day#
40337>>>>>>>>>>>                    Loop
40338>>>>>>>>>>>>
40338>>>>>>>>>>>
40338>>>>>>>>>>>                    move (DateIncrement(date#,DS_Month,1)) To nextdate#
40339>>>>>>>>>>>                    move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
40340>>>>>>>>>>>
40340>>>>>>>>>>>                    If (last_item# < 41) Begin
40342>>>>>>>>>>>                        Move 1 to day#
40343>>>>>>>>>>>                        For iFor from (last_item#+1) to 41
40349>>>>>>>>>>>>
40349>>>>>>>>>>>                            Send Add_Item msg_move_value_out day#
40350>>>>>>>>>>>                            Set Entry_State Item iFor To False
40351>>>>>>>>>>>                            Set ItemTextColor Item iFor To clGray
40352>>>>>>>>>>>                            Increment day#
40353>>>>>>>>>>>                        Loop
40354>>>>>>>>>>>>
40354>>>>>>>>>>>                    End
40354>>>>>>>>>>>>
40354>>>>>>>>>>>
40354>>>>>>>>>>>                End_Procedure
40355>>>>>>>>>>>
40355>>>>>>>>>>>                Procedure Help
40357>>>>>>>>>>>                    //Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<Y> - select year.\n<Ctrl>+<PgUp>, <PgDn> - Select year.") ("Help on Calendar")
40357>>>>>>>>>>>                    Set Visible_State of Help_Container to True
40358>>>>>>>>>>>                    Set Enabled_State of Help_Container to True
40359>>>>>>>>>>>                    Send Activate to Help_Container
40360>>>>>>>>>>>                End_Procedure
40361>>>>>>>>>>>
40361>>>>>>>>>>>                procedure mouse_click integer window integer char_pos
40363>>>>>>>>>>>                    Send Move_Value_Out
40364>>>>>>>>>>>                    forward send mouse_click window char_pos
40366>>>>>>>>>>>                end_procedure
40367>>>>>>>>>>>
40367>>>>>>>>>>>                Procedure Move_Value_Out
40369>>>>>>>>>>>                    Integer iYear iMonth iDay iItm
40370>>>>>>>>>>>                    Date Date# next_date# prev_date#
40370>>>>>>>>>>>                    Get Current_Item To iItm
40371>>>>>>>>>>>                    If (pExportState(Self)) Begin
40373>>>>>>>>>>>                        Get Value Item iItm To iDay
40374>>>>>>>>>>>                        Get p_current_month to iMonth
40375>>>>>>>>>>>                        Get p_current_year  to iYear
40376>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
40377>>>>>>>>>>>
40377>>>>>>>>>>>                        If ((iItm>27)and(iDay<15)) Begin
40379>>>>>>>>>>>                            Move (DateCompose(1,iMonth,iYear)) To next_date#
40380>>>>>>>>>>>                            move (DateIncrement(next_date#,DS_Month,1)) To next_date#
40381>>>>>>>>>>>                            move (DateSegment(next_date#,DS_MONTH)) to iMonth
40382>>>>>>>>>>>                            move (DateSegment(next_date#,DS_YEAR)) to iYear
40383>>>>>>>>>>>                            move (DateCompose(iDay,iMonth,iYear)) to date#
40384>>>>>>>>>>>                        End
40384>>>>>>>>>>>>
40384>>>>>>>>>>>                        If ((iItm<7)and(iDay>20)) Begin
40386>>>>>>>>>>>                            Move (DateCompose(1,iMonth,iYear)) To prev_date#
40387>>>>>>>>>>>                            move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
40388>>>>>>>>>>>                            move (DateSegment(prev_date#,DS_MONTH)) to iMonth
40389>>>>>>>>>>>                            move (DateSegment(prev_date#,DS_YEAR)) to iYear
40390>>>>>>>>>>>                            move (DateCompose(iDay,iMonth,iYear)) to date#
40391>>>>>>>>>>>                        End
40391>>>>>>>>>>>>
40391>>>>>>>>>>>
40391>>>>>>>>>>>                        Send Export_Date date#
40392>>>>>>>>>>>                    End
40392>>>>>>>>>>>>
40392>>>>>>>>>>>                End_Procedure
40393>>>>>>>>>>>
40393>>>>>>>>>>>                Procedure Export_Date date date#
40395>>>>>>>>>>>                    local integer focus# dm# margin# datatype#
40396>>>>>>>>>>>                    get invoking_object_id to focus#
40397>>>>>>>>>>>
40397>>>>>>>>>>>                    if focus# gt desktop begin
40399>>>>>>>>>>>                         get delegation_mode of focus# to dm#
40400>>>>>>>>>>>                         set delegation_mode of focus# to no_delegate_or_error
40401>>>>>>>>>>>                         get form_margin of focus# item current to margin#
40402>>>>>>>>>>>                         get form_datatype of focus# item current to datatype#
40403>>>>>>>>>>>                         set delegation_mode of focus# to dm#
40404>>>>>>>>>>>                         if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
40407>>>>>>>>>>>                         else             set value of focus# item current to (Date4to2(date#))
40409>>>>>>>>>>>                         set item_changed_state of focus# item current to true
40410>>>>>>>>>>>                    end
40410>>>>>>>>>>>>
40410>>>>>>>>>>>                    Send Close_Calendar
40411>>>>>>>>>>>                End_Procedure
40412>>>>>>>>>>>
40412>>>>>>>>>>>                Object cOutlookFloatingMenu is a FloatingPopupMenu
40414>>>>>>>>>>>
40414>>>>>>>>>>>                    Procedure Close_Calendar
40416>>>>>>>>>>>                        Send Close_Calendar to (oCalendar(Self))
40417>>>>>>>>>>>                    End_Procedure // Close_Calendar
40418>>>>>>>>>>>
40418>>>>>>>>>>>                    Send Add_item msg_go_today         t.calendar.today
40419>>>>>>>>>>>                    Send Add_item msg_None             ""
40420>>>>>>>>>>>                    Send Add_Item msg_prev_year        t.calendar.PrevYear
40421>>>>>>>>>>>                    Send Add_Item msg_next_year        t.calendar.NextYear
40422>>>>>>>>>>>                    Send Add_Item msg_prev_month       t.calendar.PrevMonth
40423>>>>>>>>>>>                    Send Add_Item msg_next_month       t.calendar.NextMonth
40424>>>>>>>>>>>                    Send Add_item msg_None             ""
40425>>>>>>>>>>>                    Send Add_Item msg_move_value_out   t.calendar.Select
40426>>>>>>>>>>>                    Send Add_item msg_None             ""
40427>>>>>>>>>>>                    Send Add_item msg_Close_Calendar   t.calendar.Cancel
40428>>>>>>>>>>>                End_Object // cOutlookFloatingMenu
40429>>>>>>>>>>>
40429>>>>>>>>>>>                Set floating_menu_object to (cOutlookFloatingMenu(Self))
40430>>>>>>>>>>>
40430>>>>>>>>>>>                procedure item_change integer fromi integer toi returns integer
40432>>>>>>>>>>>                    Integer new_item liMonth
40433>>>>>>>>>>>                    Date    ldSysdate
40433>>>>>>>>>>>                    forward get msg_item_change fromi toi to new_item
40435>>>>>>>>>>>                    If (Focus(Desktop) = Self) Begin
40437>>>>>>>>>>>                        If (new_item >= 0) Begin
40439>>>>>>>>>>>                            Sysdate4 ldSysdate
40440>>>>>>>>>>>                            Move (TheMonthSegment(ldSysdate)) to liMonth
40441>>>>>>>>>>>                            If ((p_current_month(Self) = liMonth) and (piCurrentDayItem(Self) = fromi)) Set Form_Bitmap Item fromi to "Cdate.bmp"
40444>>>>>>>>>>>                            Else Set Form_Bitmap Item fromi to ""
40446>>>>>>>>>>>                            If (((p_current_month(Self) = liMonth) and (piCurrentDayItem(Self) <> new_item)) or;                                 (p_current_month(Self) <> liMonth)) Set Form_Bitmap Item new_item   to "Cdate1.bmp"
40449>>>>>>>>>>>                        End
40449>>>>>>>>>>>>
40449>>>>>>>>>>>                    End
40449>>>>>>>>>>>>
40449>>>>>>>>>>>                    procedure_return new_item
40450>>>>>>>>>>>                End_Procedure // Current_Item
40451>>>>>>>>>>>
40451>>>>>>>>>>>
40451>>>>>>>>>>>
40451>>>>>>>>>>>                //AB-StoreEnd
40451>>>>>>>>>>>
40451>>>>>>>>>>>            End_Object    // Grid2
40452>>>>>>>>>>>
40452>>>>>>>>>>>            Object Textbox2 is a Textbox
40454>>>>>>>>>>>                Set Label to "Mo"
40455>>>>>>>>>>>                Set Auto_Size_State to FALSE
40456>>>>>>>>>>>                Set Transparent_State to TRUE
40457>>>>>>>>>>>                Set Color to clWhite
40458>>>>>>>>>>>                Set TextColor to clNavy
40459>>>>>>>>>>>                Set Location to 19 4
40460>>>>>>>>>>>                Set Size to 10 15
40461>>>>>>>>>>>
40461>>>>>>>>>>>                //AB-StoreStart
40461>>>>>>>>>>>
40461>>>>>>>>>>>                Set Label To (left(t.calendar.Monday,2))
40462>>>>>>>>>>>                //AB-StoreEnd
40462>>>>>>>>>>>
40462>>>>>>>>>>>            End_Object    // Textbox2
40463>>>>>>>>>>>
40463>>>>>>>>>>>            Object Textbox3 is a Textbox
40465>>>>>>>>>>>                Set Label to "Tu"
40466>>>>>>>>>>>                Set Auto_Size_State to FALSE
40467>>>>>>>>>>>                Set Transparent_State to TRUE
40468>>>>>>>>>>>                Set Color to clWhite
40469>>>>>>>>>>>                Set TextColor to clNavy
40470>>>>>>>>>>>                Set Location to 19 22
40471>>>>>>>>>>>                Set Size to 10 12
40472>>>>>>>>>>>
40472>>>>>>>>>>>                //AB-StoreStart
40472>>>>>>>>>>>
40472>>>>>>>>>>>                Set Label To (left(t.calendar.Tuesday,2))
40473>>>>>>>>>>>                //AB-StoreEnd
40473>>>>>>>>>>>
40473>>>>>>>>>>>            End_Object    // Textbox3
40474>>>>>>>>>>>
40474>>>>>>>>>>>            Object Textbox4 is a Textbox
40476>>>>>>>>>>>                Set Label to "We"
40477>>>>>>>>>>>                Set Auto_Size_State to FALSE
40478>>>>>>>>>>>                Set Transparent_State to TRUE
40479>>>>>>>>>>>                Set Color to clWhite
40480>>>>>>>>>>>                Set TextColor to clNavy
40481>>>>>>>>>>>                Set Location to 19 39
40482>>>>>>>>>>>                Set Size to 10 15
40483>>>>>>>>>>>
40483>>>>>>>>>>>                //AB-StoreStart
40483>>>>>>>>>>>
40483>>>>>>>>>>>                Set Label To (left(t.calendar.Wednesday,2))
40484>>>>>>>>>>>                //AB-StoreEnd
40484>>>>>>>>>>>
40484>>>>>>>>>>>            End_Object    // Textbox4
40485>>>>>>>>>>>
40485>>>>>>>>>>>            Object Textbox5 is a Textbox
40487>>>>>>>>>>>                Set Label to "Th"
40488>>>>>>>>>>>                Set Auto_Size_State to FALSE
40489>>>>>>>>>>>                Set Transparent_State to TRUE
40490>>>>>>>>>>>                Set Color to clWhite
40491>>>>>>>>>>>                Set TextColor to clNavy
40492>>>>>>>>>>>                Set Location to 19 57
40493>>>>>>>>>>>                Set Size to 10 17
40494>>>>>>>>>>>
40494>>>>>>>>>>>                //AB-StoreStart
40494>>>>>>>>>>>
40494>>>>>>>>>>>                Set Label To (left(t.calendar.Thursday,2))
40495>>>>>>>>>>>                //AB-StoreEnd
40495>>>>>>>>>>>
40495>>>>>>>>>>>            End_Object    // Textbox5
40496>>>>>>>>>>>
40496>>>>>>>>>>>            Object Textbox6 is a Textbox
40498>>>>>>>>>>>                Set Label to "Fr"
40499>>>>>>>>>>>                Set Auto_Size_State to FALSE
40500>>>>>>>>>>>                Set Transparent_State to TRUE
40501>>>>>>>>>>>                Set Color to clWhite
40502>>>>>>>>>>>                Set TextColor to clNavy
40503>>>>>>>>>>>                Set Location to 19 76
40504>>>>>>>>>>>                Set Size to 10 17
40505>>>>>>>>>>>
40505>>>>>>>>>>>                //AB-StoreStart
40505>>>>>>>>>>>
40505>>>>>>>>>>>                Set Label To (left(t.calendar.Friday,2))
40506>>>>>>>>>>>                //AB-StoreEnd
40506>>>>>>>>>>>
40506>>>>>>>>>>>            End_Object    // Textbox6
40507>>>>>>>>>>>
40507>>>>>>>>>>>            Object Textbox7 is a Textbox
40509>>>>>>>>>>>                Set Label to "Sa"
40510>>>>>>>>>>>                Set Auto_Size_State to FALSE
40511>>>>>>>>>>>                Set Transparent_State to TRUE
40512>>>>>>>>>>>                Set Color to clWhite
40513>>>>>>>>>>>                Set TextColor to clNavy
40514>>>>>>>>>>>                Set Location to 19 91
40515>>>>>>>>>>>                Set Size to 10 18
40516>>>>>>>>>>>
40516>>>>>>>>>>>                //AB-StoreStart
40516>>>>>>>>>>>
40516>>>>>>>>>>>                Set Label To (left(t.calendar.Saturday,2))
40517>>>>>>>>>>>                //AB-StoreEnd
40517>>>>>>>>>>>
40517>>>>>>>>>>>            End_Object    // Textbox7
40518>>>>>>>>>>>
40518>>>>>>>>>>>            Object Textbox8 is a Textbox
40520>>>>>>>>>>>                Set Label to "Su"
40521>>>>>>>>>>>                Set Auto_Size_State to FALSE
40522>>>>>>>>>>>                Set Transparent_State to TRUE
40523>>>>>>>>>>>                Set Color to clWhite
40524>>>>>>>>>>>                Set TextColor to clNavy
40525>>>>>>>>>>>                Set Location to 19 109
40526>>>>>>>>>>>                Set Size to 10 17
40527>>>>>>>>>>>
40527>>>>>>>>>>>                //AB-StoreStart
40527>>>>>>>>>>>
40527>>>>>>>>>>>                Set Label To (left(t.calendar.Sunday,2))
40528>>>>>>>>>>>                //AB-StoreEnd
40528>>>>>>>>>>>
40528>>>>>>>>>>>            End_Object    // Textbox8
40529>>>>>>>>>>>
40529>>>>>>>>>>>            Object LineControl1 is a LineControl
40531>>>>>>>>>>>                Set Line_Style to lnSINGLE
40532>>>>>>>>>>>                Set Size to 1 116
40533>>>>>>>>>>>                Set Location to 28 4
40534>>>>>>>>>>>
40534>>>>>>>>>>>                //AB-StoreStart
40534>>>>>>>>>>>
40534>>>>>>>>>>>                //AB-StoreEnd
40534>>>>>>>>>>>
40534>>>>>>>>>>>            End_Object    // LineControl1
40535>>>>>>>>>>>
40535>>>>>>>>>>>            Object Container3d2 is a Container3d
40537>>>>>>>>>>>                Set Size to 18 131
40538>>>>>>>>>>>                Set Location to 1 1
40539>>>>>>>>>>>                Set Color to clNavy
40540>>>>>>>>>>>                Set Border_Style to Border_None
40541>>>>>>>>>>>                Object oRght is a BitmapContainer
40543>>>>>>>>>>>                    Set Size to 10 14
40544>>>>>>>>>>>                    Set Location to 4 105
40545>>>>>>>>>>>                    Set Bitmap to "rght.bmp"
40546>>>>>>>>>>>                    Set Border_Style to Border_None
40547>>>>>>>>>>>
40547>>>>>>>>>>>                    //AB-StoreStart
40547>>>>>>>>>>>                    Procedure Mouse_Down
40549>>>>>>>>>>>                        Send Next_Month to Grid2
40550>>>>>>>>>>>                    End_Procedure
40551>>>>>>>>>>>                    //AB-StoreEnd
40551>>>>>>>>>>>
40551>>>>>>>>>>>                End_Object    // oRght
40552>>>>>>>>>>>
40552>>>>>>>>>>>                Object oLeft is a BitmapContainer
40554>>>>>>>>>>>                    Set Size to 10 14
40555>>>>>>>>>>>                    Set Location to 4 3
40556>>>>>>>>>>>                    Set Bitmap to "lft.bmp"
40557>>>>>>>>>>>                    Set Border_Style to Border_None
40558>>>>>>>>>>>
40558>>>>>>>>>>>                    //AB-StoreStart
40558>>>>>>>>>>>                    Procedure Mouse_Down
40560>>>>>>>>>>>                        Send Prev_Month to Grid2
40561>>>>>>>>>>>                    End_Procedure
40562>>>>>>>>>>>                    //AB-StoreEnd
40562>>>>>>>>>>>
40562>>>>>>>>>>>                End_Object    // oLeft
40563>>>>>>>>>>>
40563>>>>>>>>>>>                Object oMonth is a Textbox
40565>>>>>>>>>>>
40565>>>>>>>>>>>                    //AB-StoreTopStart
40565>>>>>>>>>>>                    Property integer piSelected_Month public 0
40567>>>>>>>>>>>                    //AB-StoreTopEnd
40567>>>>>>>>>>>
40567>>>>>>>>>>>                    Set Label to "January"
40568>>>>>>>>>>>                    Set Auto_Size_State to FALSE
40569>>>>>>>>>>>                    Set Transparent_State to TRUE
40570>>>>>>>>>>>                    Set Color to clWhite
40571>>>>>>>>>>>                    Set TextColor to clWhite
40572>>>>>>>>>>>                    Set Location to 4 19
40573>>>>>>>>>>>                    Set Size to 10 46
40574>>>>>>>>>>>                    Set FontWeight to 800
40575>>>>>>>>>>>                    Set Justification_Mode to jMode_Center
40576>>>>>>>>>>>
40576>>>>>>>>>>>                    //AB-StoreStart
40576>>>>>>>>>>>
40576>>>>>>>>>>>                    Procedure Mouse_Down
40578>>>>>>>>>>>                        Integer iState
40579>>>>>>>>>>>                        Get Visible_State of oSelectCalendarYear to iState
40580>>>>>>>>>>>                        If (iState) Send OnKillFocus to oSelectCalendarYear
40583>>>>>>>>>>>                        Send Popup to oSelectMonth
40584>>>>>>>>>>>                    End_Procedure
40585>>>>>>>>>>>
40585>>>>>>>>>>>                    Procedure pSelectJan
40587>>>>>>>>>>>                        Set Label to t.calendar.january
40588>>>>>>>>>>>                        Set piSelected_Month to 1
40589>>>>>>>>>>>                        Send Adjust_Calendar
40590>>>>>>>>>>>                    End_Procedure
40591>>>>>>>>>>>                    Procedure pSelectFeb
40593>>>>>>>>>>>                        Set Label to t.calendar.february
40594>>>>>>>>>>>                        Set piSelected_Month to 2
40595>>>>>>>>>>>                        Send Adjust_Calendar
40596>>>>>>>>>>>                    End_Procedure
40597>>>>>>>>>>>                    Procedure pSelectMar
40599>>>>>>>>>>>                        Set Label to t.calendar.march
40600>>>>>>>>>>>                        Set piSelected_Month to 3
40601>>>>>>>>>>>                        Send Adjust_Calendar
40602>>>>>>>>>>>                    End_Procedure
40603>>>>>>>>>>>                    Procedure pSelectApr
40605>>>>>>>>>>>                        Set Label to t.calendar.april
40606>>>>>>>>>>>                        Set piSelected_Month to 4
40607>>>>>>>>>>>                        Send Adjust_Calendar
40608>>>>>>>>>>>                    End_Procedure
40609>>>>>>>>>>>                    Procedure pSelectMay
40611>>>>>>>>>>>                        Set Label to t.calendar.may
40612>>>>>>>>>>>                        Set piSelected_Month to 5
40613>>>>>>>>>>>                        Send Adjust_Calendar
40614>>>>>>>>>>>                    End_Procedure
40615>>>>>>>>>>>                    Procedure pSelectJun
40617>>>>>>>>>>>                        Set Label to t.calendar.june
40618>>>>>>>>>>>                        Set piSelected_Month to 6
40619>>>>>>>>>>>                        Send Adjust_Calendar
40620>>>>>>>>>>>                    End_Procedure
40621>>>>>>>>>>>                    Procedure pSelectJul
40623>>>>>>>>>>>                        Set Label to t.calendar.july
40624>>>>>>>>>>>                        Set piSelected_Month to 7
40625>>>>>>>>>>>                        Send Adjust_Calendar
40626>>>>>>>>>>>                    End_Procedure
40627>>>>>>>>>>>                    Procedure pSelectAug
40629>>>>>>>>>>>                        Set Label to t.calendar.august
40630>>>>>>>>>>>                        Set piSelected_Month to 8
40631>>>>>>>>>>>                        Send Adjust_Calendar
40632>>>>>>>>>>>                    End_Procedure
40633>>>>>>>>>>>                    Procedure pSelectSep
40635>>>>>>>>>>>                        Set Label to t.calendar.september
40636>>>>>>>>>>>                        Set piSelected_Month to 9
40637>>>>>>>>>>>                        Send Adjust_Calendar
40638>>>>>>>>>>>                    End_Procedure
40639>>>>>>>>>>>                    Procedure pSelectOct
40641>>>>>>>>>>>                        Set Label to t.calendar.october
40642>>>>>>>>>>>                        Set piSelected_Month to 10
40643>>>>>>>>>>>                        Send Adjust_Calendar
40644>>>>>>>>>>>                    End_Procedure
40645>>>>>>>>>>>                    Procedure pSelectNov
40647>>>>>>>>>>>                        Set Label to t.calendar.november
40648>>>>>>>>>>>                        Set piSelected_Month to 11
40649>>>>>>>>>>>                        Send Adjust_Calendar
40650>>>>>>>>>>>                    End_Procedure
40651>>>>>>>>>>>                    Procedure pSelectDec
40653>>>>>>>>>>>                        Set Label to t.calendar.december
40654>>>>>>>>>>>                        Set piSelected_Month to 12
40655>>>>>>>>>>>                        Send Adjust_Calendar
40656>>>>>>>>>>>                    End_Procedure
40657>>>>>>>>>>>
40657>>>>>>>>>>>                    Object oSelectMonth is a FloatingPopupMenu
40659>>>>>>>>>>>                        Send Add_Item msg_pSelectJan t.calendar.january
40660>>>>>>>>>>>                        Send Add_Item msg_pSelectFeb t.calendar.february
40661>>>>>>>>>>>                        Send Add_Item msg_pSelectMar t.calendar.march
40662>>>>>>>>>>>                        Send Add_Item msg_pSelectApr t.calendar.april
40663>>>>>>>>>>>                        Send Add_Item msg_pSelectMay t.calendar.may
40664>>>>>>>>>>>                        Send Add_Item msg_pSelectJun t.calendar.june
40665>>>>>>>>>>>                        Send Add_Item msg_pSelectJul t.calendar.july
40666>>>>>>>>>>>                        Send Add_Item msg_pSelectAug t.calendar.august
40667>>>>>>>>>>>                        Send Add_Item msg_pSelectSep t.calendar.september
40668>>>>>>>>>>>                        Send Add_Item msg_pSelectOct t.calendar.october
40669>>>>>>>>>>>                        Send Add_Item msg_pSelectNov t.calendar.november
40670>>>>>>>>>>>                        Send Add_Item msg_pSelectDec t.calendar.december
40671>>>>>>>>>>>                    End_Object
40672>>>>>>>>>>>
40672>>>>>>>>>>>                    Procedure Adjust_Calendar
40674>>>>>>>>>>>                        Date date#
40675>>>>>>>>>>>                        Integer iDay iMonth iYear iItm
40675>>>>>>>>>>>                        Set Visible_State to false
40676>>>>>>>>>>>                        Set Visible_State to true
40677>>>>>>>>>>>                        Get Current_Item of (Grid2(Container3D1(Self))) to iItm
40678>>>>>>>>>>>                        Get value of (Grid2(Container3D1(Self))) item iItm to iDay
40679>>>>>>>>>>>                        Get piSelected_Month to iMonth
40680>>>>>>>>>>>                        Get Label of oCalendarYear to iYear
40681>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
40682>>>>>>>>>>>                        Set p_current_date of (Grid2(Container3D1(Self))) to date#
40683>>>>>>>>>>>                        Send Update_Calendar to (Grid2(Container3D1(Self)))
40684>>>>>>>>>>>                    End_Procedure
40685>>>>>>>>>>>
40685>>>>>>>>>>>                    Procedure Activating
40687>>>>>>>>>>>                        Forward Send Activating
40689>>>>>>>>>>>                        Send Date_Changing
40690>>>>>>>>>>>                    End_Procedure
40691>>>>>>>>>>>
40691>>>>>>>>>>>                    Procedure Date_Changing
40693>>>>>>>>>>>                        Set Visible_State to false
40694>>>>>>>>>>>                        Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
40695>>>>>>>>>>>                        Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
40696>>>>>>>>>>>                        Set Visible_State to true
40697>>>>>>>>>>>                    End_Procedure
40698>>>>>>>>>>>
40698>>>>>>>>>>>
40698>>>>>>>>>>>
40698>>>>>>>>>>>                    //AB-StoreEnd
40698>>>>>>>>>>>
40698>>>>>>>>>>>                End_Object    // oMonth
40699>>>>>>>>>>>
40699>>>>>>>>>>>                Object oCalendarYear is a Textbox
40701>>>>>>>>>>>                    Set Label to "2001"
40702>>>>>>>>>>>                    Set Transparent_State to TRUE
40703>>>>>>>>>>>                    Set Color to clWhite
40704>>>>>>>>>>>                    Set TextColor to clWhite
40705>>>>>>>>>>>                    Set Location to 4 77
40706>>>>>>>>>>>                    Set Size to 10 18
40707>>>>>>>>>>>                    Set FontWeight to 800
40708>>>>>>>>>>>
40708>>>>>>>>>>>                    //AB-StoreStart
40708>>>>>>>>>>>
40708>>>>>>>>>>>                    Procedure Mouse_Down
40710>>>>>>>>>>>                        String sVal
40711>>>>>>>>>>>                        Get Label to sVal
40712>>>>>>>>>>>                        Set Value of oSelectCalendarYear item 0 to sVal
40713>>>>>>>>>>>                        Set Visible_State of oSelectCalendarYear to True
40714>>>>>>>>>>>                        Send Activate to (oSelectCalendarYear(Self))
40715>>>>>>>>>>>                    End_Procedure
40716>>>>>>>>>>>
40716>>>>>>>>>>>                    Procedure Activating
40718>>>>>>>>>>>                        Forward Send Activating
40720>>>>>>>>>>>                        Send Date_Changing
40721>>>>>>>>>>>                    End_Procedure
40722>>>>>>>>>>>
40722>>>>>>>>>>>                    Procedure Date_Changing
40724>>>>>>>>>>>                        Set Visible_State to false
40725>>>>>>>>>>>                        Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
40726>>>>>>>>>>>                        Set Visible_State to true
40727>>>>>>>>>>>                    End_Procedure
40728>>>>>>>>>>>
40728>>>>>>>>>>>                    //AB-StoreEnd
40728>>>>>>>>>>>
40728>>>>>>>>>>>                End_Object    // oCalendarYear
40729>>>>>>>>>>>
40729>>>>>>>>>>>                Object oSelectCalendarYear is a Form
40731>>>>>>>>>>>
40731>>>>>>>>>>>                    //AB-StoreTopStart
40731>>>>>>>>>>>                    Set Visible_State To False
40732>>>>>>>>>>>                    //AB-StoreTopEnd
40732>>>>>>>>>>>
40732>>>>>>>>>>>                    Set Size to 10 24
40733>>>>>>>>>>>                    Set Location to 4 75
40734>>>>>>>>>>>                    Set Color to clWhite
40735>>>>>>>>>>>                    Set TextColor to clNavy
40736>>>>>>>>>>>                    Set Form_Border Item 0 to Border_Normal
40737>>>>>>>>>>>
40737>>>>>>>>>>>                    //AB-StoreStart
40737>>>>>>>>>>>
40737>>>>>>>>>>>                    On_Key Key_Enter Send OnKillFocus
40738>>>>>>>>>>>                    On_Key Key_Escape Send OnKillFocus
40739>>>>>>>>>>>
40739>>>>>>>>>>>                    Procedure SetFontWeight
40741>>>>>>>>>>>                        Set Form_FontWeight item 0 to 800
40742>>>>>>>>>>>                    End_Procedure
40743>>>>>>>>>>>
40743>>>>>>>>>>>                    Procedure OnKillFocus
40745>>>>>>>>>>>                        String sVal
40746>>>>>>>>>>>                        Integer iMonth iDay iYear iItm
40746>>>>>>>>>>>                        Date date#
40746>>>>>>>>>>>                        Get Value item 0 to sVal
40747>>>>>>>>>>>                        Set Visible_State of oCalendarYear to false
40748>>>>>>>>>>>                        Set Label of oCalendarYear to sVal
40749>>>>>>>>>>>                        Set Visible_State of oCalendarYear to true
40750>>>>>>>>>>>                        Set Visible_State to false
40751>>>>>>>>>>>                        Get Current_Item of (Grid2(Container3D1(Self))) to iItm
40752>>>>>>>>>>>                        Get value of (Grid2(Container3D1(Self))) item iItm to iDay
40753>>>>>>>>>>>                        Get piSelected_Month of oMonth to iMonth
40754>>>>>>>>>>>                        Get Value item 0 to iYear
40755>>>>>>>>>>>                        If (iYear = 0) Move 2000 to iYear
40758>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
40759>>>>>>>>>>>                        Set p_current_date of (Grid2(Container3D1(Self))) to date#
40760>>>>>>>>>>>                        Send Update_Calendar to (Grid2(Container3D1(Self)))
40761>>>>>>>>>>>                        Send Activate        to (Grid2(Container3D1(Self)))
40762>>>>>>>>>>>                    End_Procedure
40763>>>>>>>>>>>
40763>>>>>>>>>>>                    Send SetFontWeight
40764>>>>>>>>>>>
40764>>>>>>>>>>>
40764>>>>>>>>>>>
40764>>>>>>>>>>>                    //AB-StoreEnd
40764>>>>>>>>>>>
40764>>>>>>>>>>>                End_Object    // oSelectCalendarYear
40765>>>>>>>>>>>
40765>>>>>>>>>>>
40765>>>>>>>>>>>                //AB-StoreStart
40765>>>>>>>>>>>
40765>>>>>>>>>>>                Procedure Mouse_Down
40767>>>>>>>>>>>                    Integer iState
40768>>>>>>>>>>>                    Get Visible_State of oSelectCalendarYear to iState
40769>>>>>>>>>>>                    If (iState) Send OnKillFocus to oSelectCalendarYear
40772>>>>>>>>>>>                End_Procedure
40773>>>>>>>>>>>
40773>>>>>>>>>>>
40773>>>>>>>>>>>                //AB-StoreEnd
40773>>>>>>>>>>>
40773>>>>>>>>>>>            End_Object    // Container3d2
40774>>>>>>>>>>>
40774>>>>>>>>>>>
40774>>>>>>>>>>>            //AB-StoreStart
40774>>>>>>>>>>>
40774>>>>>>>>>>>
40774>>>>>>>>>>>            //AB-StoreEnd
40774>>>>>>>>>>>
40774>>>>>>>>>>>        End_Object    // Container3d1
40775>>>>>>>>>>>
40775>>>>>>>>>>>        Object BitmapContainer3 is a BitmapContainer
40777>>>>>>>>>>>            Set Size to 9 19
40778>>>>>>>>>>>            Set Location to 88 3
40779>>>>>>>>>>>            Set Color to clWhite
40780>>>>>>>>>>>            Set Bitmap to "cdate.bmp"
40781>>>>>>>>>>>            Set Border_Style to Border_None
40782>>>>>>>>>>>
40782>>>>>>>>>>>            //AB-StoreStart
40782>>>>>>>>>>>            Procedure Mouse_Down
40784>>>>>>>>>>>                Send go_today to (Grid2(Container3d1(Self)))
40785>>>>>>>>>>>                Send Adjust_Label to oToday
40786>>>>>>>>>>>            End_Procedure
40787>>>>>>>>>>>            //AB-StoreEnd
40787>>>>>>>>>>>
40787>>>>>>>>>>>        End_Object    // BitmapContainer3
40788>>>>>>>>>>>
40788>>>>>>>>>>>        Object oToday is a Textbox
40790>>>>>>>>>>>            Set Label to "Today: 01.01.2001"
40791>>>>>>>>>>>            Set Auto_Size_State to FALSE
40792>>>>>>>>>>>            Set Color to clWhite
40793>>>>>>>>>>>            Set Location to 88 22
40794>>>>>>>>>>>            Set Size to 8 70
40795>>>>>>>>>>>            Set FontWeight to 800
40796>>>>>>>>>>>
40796>>>>>>>>>>>            //AB-StoreStart
40796>>>>>>>>>>>            Procedure Mouse_Down
40798>>>>>>>>>>>                Send go_today to (Grid2(Container3d1(Self)))
40799>>>>>>>>>>>                Send Adjust_Label
40800>>>>>>>>>>>            End_Procedure
40801>>>>>>>>>>>
40801>>>>>>>>>>>            Procedure Adjust_Label
40803>>>>>>>>>>>                date date#
40804>>>>>>>>>>>                SysDate4 date#
40805>>>>>>>>>>>                Set Visible_State To false
40806>>>>>>>>>>>                Set Label         to (t.calendar.today+": "+String(date#))
40807>>>>>>>>>>>                Set Visible_State To true
40808>>>>>>>>>>>            End_Procedure
40809>>>>>>>>>>>
40809>>>>>>>>>>>            Procedure Activating
40811>>>>>>>>>>>                Forward Send Activating
40813>>>>>>>>>>>                Send Adjust_Label
40814>>>>>>>>>>>            End_Procedure
40815>>>>>>>>>>>            //AB-StoreEnd
40815>>>>>>>>>>>
40815>>>>>>>>>>>        End_Object    // oToday
40816>>>>>>>>>>>
40816>>>>>>>>>>>        Object oCloseCalendar_bn is a BitmapContainer
40818>>>>>>>>>>>            Set Size to 9 10
40819>>>>>>>>>>>            Set Location to 88 112
40820>>>>>>>>>>>            Set Bitmap to "Cdate1.bmp"
40821>>>>>>>>>>>            Set Bitmap_Style to Bitmap_Center
40822>>>>>>>>>>>
40822>>>>>>>>>>>            //AB-StoreStart
40822>>>>>>>>>>>
40822>>>>>>>>>>>            Procedure Mouse_Up
40824>>>>>>>>>>>                Send Close_Calendar
40825>>>>>>>>>>>            End_Procedure // Mouse_Up
40826>>>>>>>>>>>
40826>>>>>>>>>>>
40826>>>>>>>>>>>
40826>>>>>>>>>>>
40826>>>>>>>>>>>            //AB-StoreEnd
40826>>>>>>>>>>>
40826>>>>>>>>>>>        End_Object    // oCloseCalendar_bn
40827>>>>>>>>>>>
40827>>>>>>>>>>>
40827>>>>>>>>>>>        //AB-StoreStart
40827>>>>>>>>>>>
40827>>>>>>>>>>>        Set Block_Mouse_State to True
40828>>>>>>>>>>>        Set Popup_State to True
40829>>>>>>>>>>>        Set Locate_Mode to Popup_Locate
40830>>>>>>>>>>>
40830>>>>>>>>>>>        procedure popup
40832>>>>>>>>>>>            local integer focus# icItm iYear iMonth
40833>>>>>>>>>>>            local date date#
40833>>>>>>>>>>>            move (focus(desktop)) to focus#
40834>>>>>>>>>>>            set invoking_object_id of (Grid2(Container3d1(self))) to focus#
40835>>>>>>>>>>>            get value of focus# item current to date#
40836>>>>>>>>>>>            ifnot (integer(date#)) sysdate date#
40839>>>>>>>>>>>            move (Date2to4(date#)) to date#
40840>>>>>>>>>>>            set p_current_date of (Grid2(Container3d1(self))) to date#
40841>>>>>>>>>>>            send fill_list to (Grid2(Container3d1(self)))
40842>>>>>>>>>>>            move (DateSegment(date#,DS_YEAR)) to iYear
40843>>>>>>>>>>>            move (DateSegment(date#,DS_MONTH)) to iMonth
40844>>>>>>>>>>>            Set Label To (MonthName(iMonth)+', '+String(iYear))
40845>>>>>>>>>>>            forward send popup
40847>>>>>>>>>>>        end_procedure
40848>>>>>>>>>>>
40848>>>>>>>>>>>        Procedure Close_Calendar
40850>>>>>>>>>>>            Send Close_Panel
40851>>>>>>>>>>>        End_Procedure // Close_Calendar
40852>>>>>>>>>>>
40852>>>>>>>>>>>        Object Help_Container is a Container3d
40854>>>>>>>>>>>            Set Location to 0 0
40855>>>>>>>>>>>            Set Size     to 98 122
40856>>>>>>>>>>>            Set Visible_State to False
40857>>>>>>>>>>>            Set Enabled_State to False
40858>>>>>>>>>>>            Set Border_Style to Border_None
40859>>>>>>>>>>>            Set TextColor to clNavy
40860>>>>>>>>>>>
40860>>>>>>>>>>>            Object Help_Info is an Edit
40862>>>>>>>>>>>                Set Location to 0 0
40863>>>>>>>>>>>                Set Size     to 98 122
40864>>>>>>>>>>>                Set read_only_state to true
40865>>>>>>>>>>>                Set Border_Style to Border_None
40866>>>>>>>>>>>                Set scroll_bar_visible_state to False
40867>>>>>>>>>>>                Set FontWeight to 800
40868>>>>>>>>>>>
40868>>>>>>>>>>>                Procedure ReadHelpComments
40870>>>>>>>>>>>                    String lsFile
40871>>>>>>>>>>>
40871>>>>>>>>>>>                    Get_File_Path "Calendar.txt" to lsFile
40872>>>>>>>>>>>                    If (lsFile <> "") Send read lsFile
40875>>>>>>>>>>>                End_Procedure // ReadHelpComments
40876>>>>>>>>>>>
40876>>>>>>>>>>>                Procedure SetComments
40878>>>>>>>>>>>                    Send append_text "Help on Calendar"
40879>>>>>>>>>>>                    Send Insert ""
40880>>>>>>>>>>>                    Send Insert ""
40881>>>>>>>>>>>                    Send append_text "1.<Up>,<Dn>,<Lft>,<Rgt>"
40882>>>>>>>>>>>                    Send Insert ""
40883>>>>>>>>>>>                    Send append_text "  - select date."
40884>>>>>>>>>>>                    Send Insert ""
40885>>>>>>>>>>>                    Send append_text "2.<PgUp>,<PgDn>"
40886>>>>>>>>>>>                    Send Insert ""
40887>>>>>>>>>>>                    Send append_text "  - select month."
40888>>>>>>>>>>>                    Send Insert ""
40889>>>>>>>>>>>                    Send append_text "3.<Ctrl>+<D>"
40890>>>>>>>>>>>                    Send Insert ""
40891>>>>>>>>>>>                    Send append_text "  - set current date."
40892>>>>>>>>>>>                    Send Insert ""
40893>>>>>>>>>>>                    Send append_text "4.<Ctrl>+<Y>"
40894>>>>>>>>>>>                    Send Insert ""
40895>>>>>>>>>>>                    Send append_text "  - Change year."
40896>>>>>>>>>>>                    Send Insert ""
40897>>>>>>>>>>>                    Send append_text "5.<Ctrl>+<PgUp>,<PgDn>"
40898>>>>>>>>>>>                    Send Insert ""
40899>>>>>>>>>>>                    Send append_text "  - Select year."
40900>>>>>>>>>>>                End_procedure // SetComments
40901>>>>>>>>>>>
40901>>>>>>>>>>>                //Send SetComments
40901>>>>>>>>>>>                Set Color     to clWhite
40902>>>>>>>>>>>                Set TextColor to clNavy
40903>>>>>>>>>>>
40903>>>>>>>>>>>                Procedure OnSetFocus
40905>>>>>>>>>>>                    Send ReadHelpComments
40906>>>>>>>>>>>                End_Procedure
40907>>>>>>>>>>>
40907>>>>>>>>>>>                Object HelpFloatingMenu is a FloatingPopupMenu
40909>>>>>>>>>>>
40909>>>>>>>>>>>                    Procedure Close_Help
40911>>>>>>>>>>>                        Send Close_Help to Help_Container
40912>>>>>>>>>>>                    End_Procedure // Close_Calendar
40913>>>>>>>>>>>
40913>>>>>>>>>>>                    Send Add_item msg_Close_Help   t.calendar.Ok
40914>>>>>>>>>>>                End_Object // cOutlookFloatingMenu
40915>>>>>>>>>>>
40915>>>>>>>>>>>                Procedure Mouse_Up2 Integer aiWindow Integer aiChar_Pos
40917>>>>>>>>>>>                    Send Popup to HelpFloatingMenu
40918>>>>>>>>>>>                End_Procedure // Mouse_Up2
40919>>>>>>>>>>>
40919>>>>>>>>>>>            End_Object
40920>>>>>>>>>>>
40920>>>>>>>>>>>            Procedure Close_Help
40922>>>>>>>>>>>                Send Delete_Data to Help_Info
40923>>>>>>>>>>>                Set Visible_State to False
40924>>>>>>>>>>>                Set Enabled_State to False
40925>>>>>>>>>>>                Send Activate to (Grid2(Container3D1(Self)))
40926>>>>>>>>>>>            End_Procedure // Close_Help
40927>>>>>>>>>>>
40927>>>>>>>>>>>            On_Key kCancel Send Close_Help
40928>>>>>>>>>>>            On_Key Key_F1  Send Close_Help
40929>>>>>>>>>>>            On_Key kEnter  Send Close_Help
40930>>>>>>>>>>>        End_Object // Help_Info
40931>>>>>>>>>>>
40931>>>>>>>>>>>        on_key kcancel           send Close_Calendar
40932>>>>>>>>>>>
40932>>>>>>>>>>>
40932>>>>>>>>>>>
40932>>>>>>>>>>>
40932>>>>>>>>>>>
40932>>>>>>>>>>>
40932>>>>>>>>>>>        //AB-StoreEnd
40932>>>>>>>>>>>
40932>>>>>>>>>>>    End_Object    // oCalendar
40933>>>>>>>>>>>
40933>>>>>>>>>>>
40933>>>>>>>>>>>    //AB-StoreStart
40933>>>>>>>>>>>
40933>>>>>>>>>>>    Procedure Request_Popup_cOutlookCalendar for BaseClass
40934>>>>>>>>>>>        Integer focus# type# dm#
40935>>>>>>>>>>>
40935>>>>>>>>>>>        move (focus(desktop)) to focus#
40936>>>>>>>>>>>        if focus# gt desktop begin
40938>>>>>>>>>>>          get delegation_mode of focus# to dm#
40939>>>>>>>>>>>          set delegation_mode of focus# to no_delegate_or_error
40940>>>>>>>>>>>          get form_datatype of focus# item current to type#
40941>>>>>>>>>>>          if (type#=date_window or type#=mask_date_window) send popup to oCalendar
40944>>>>>>>>>>>          set delegation_mode of focus# to dm#
40945>>>>>>>>>>>        end
40945>>>>>>>>>>>>
40945>>>>>>>>>>>    End_Procedure
40946>>>>>>>>>>>
40946>>>>>>>>>>>    On_Key Key_Ctrl+Key_F1 Send Request_Popup_cOutlookCalendar
40947>>>>>>>>>>>    On_Key Key_Ctrl+Key_H  Send Request_Popup_cOutlookCalendar
40948>>>>>>>>>>>
40948>>>>>>>>>>>
40948>>>>>>>>>>>    //AB-StoreEnd
40948>>>>>>>>>>>
40948>>>>>>>>>>>//AB/     End_Object    // prj
40948>>>>>>>>>Use Dates.Utl
40948>>>>>>>>>
40948>>>>>>>>>   Define cStatusHelp       for "F4 = Calendar. T = Today, B = Begin of month, E = End of month."
40948>>>>>>>>>   Define cDateToday        for "T"
40948>>>>>>>>>   Define cDateBeginOfMonth for "B"
40948>>>>>>>>>   Define cDateEndOfMonth   for "E"
40948>>>>>>>>>
40948>>>>>>>>>Class cSyIntelliSense_Date_Mixin is a Message
40949>>>>>>>>>   Procedure DoDefineIntelliSenseDateMixin
40950>>>>>>>>>      Property Date    pdOriginal_Value          Public 0
40951>>>>>>>>>      Property Integer pbIntelliSense_Date_State Public dfTrue
40952>>>>>>>>>      Property Integer pbEnableCalendarPrompt    Public dfTrue
40953>>>>>>>>>      On_Key KUpArrow         Send DoAddOneDay
40954>>>>>>>>>      On_Key KDownArrow       Send DoSubOneDay
40955>>>>>>>>>   End_Procedure // DoDefineIntelliSenseDateMixin
40956>>>>>>>>>
40956>>>>>>>>>   Procedure DoAddOneDay
40957>>>>>>>>>        Integer rVal
40958>>>>>>>>>        Date dHmnia
40958>>>>>>>>>
40958>>>>>>>>>        Get Value Item 0 to dHmnia
40959>>>>>>>>>        Add 1 to dHmnia
40960>>>>>>>>>        Set Value Item 0 to dHmnia
40961>>>>>>>>>    End_Procedure // Add_One_Day
40962>>>>>>>>>
40962>>>>>>>>>    Procedure DoSubOneDay
40963>>>>>>>>>        Integer rVal
40964>>>>>>>>>        Date dHmnia
40964>>>>>>>>>
40964>>>>>>>>>        Get Value Item 0 to dHmnia
40965>>>>>>>>>        Sub 1 to dHmnia
40966>>>>>>>>>        Set Value Item 0 to dHmnia
40967>>>>>>>>>    End_Procedure // Add_One_Day
40968>>>>>>>>>
40968>>>>>>>>>   // **WvA: Augmented to store the current date-value before any changes are made
40968>>>>>>>>>   Procedure Entering returns Integer
40969>>>>>>>>>      Integer iRetVal
40970>>>>>>>>>      Date    dOriginal
40970>>>>>>>>>      Forward Get Msg_Entering to iRetVal
40972>>>>>>>>>      If (iRetVal = 0) Begin
40974>>>>>>>>>         Send DoStoreOriginalDate
40975>>>>>>>>>      End
40975>>>>>>>>>>
40975>>>>>>>>>      Procedure_Return iRetVal
40976>>>>>>>>>   End_Procedure // Entering
40977>>>>>>>>>
40977>>>>>>>>>   //**WvA: This procedure is augmented to see if the user entered a 1 or 2 digit
40977>>>>>>>>>   //       value with the intention to only change the day-part of the current date.
40977>>>>>>>>>   Procedure Next
40978>>>>>>>>>      Send DoIntelliSenseDate
40979>>>>>>>>>      Forward Send Next
40981>>>>>>>>>   End_Procedure // Next
40982>>>>>>>>>
40982>>>>>>>>>   // **WvA: Store the current date-value before any changes are made
40982>>>>>>>>>   Procedure DoStoreOriginalDate
40983>>>>>>>>>      Date    dOriginal
40984>>>>>>>>>      //If (pbIntelliSense_Date_State(Self)) Begin
40984>>>>>>>>>         Get Value Item 0 to dOriginal
40985>>>>>>>>>         Set pdOriginal_Value to dOriginal
40986>>>>>>>>>      //End
40986>>>>>>>>>   End_Procedure // DoStoreOriginalDate
40987>>>>>>>>>
40987>>>>>>>>>   Procedure DoIntelliSenseDate
40988>>>>>>>>>      Integer iCurrent iStored iDaysOffSet iSep iDate_Format bChanged iYear
40989>>>>>>>>>      Date    dCurrent dOriginal
40989>>>>>>>>>      String  sStored  sCurrent sSep sMask
40989>>>>>>>>>
40989>>>>>>>>>      Get Item_Changed_State Item 0 to bChanged
40990>>>>>>>>>      Get pdOriginal_Value to dOriginal
40991>>>>>>>>>      If (pbIntelliSense_Date_State(Self) And (bChanged)) Begin
40993>>>>>>>>>         If (dOriginal Eq 0) Sysdate4 dOriginal
40996>>>>>>>>>
40996>>>>>>>>>         // We need the masked value, because the normal value is corrected by the runtime for
40996>>>>>>>>>         // USA dates.
40996>>>>>>>>>         Get Masked_Value Item 0 to sCurrent // getting a 2 digit entered date to a datavariable results in an error.
40997>>>>>>>>>         Move (Replaces(" ",sCurrent,"")) to sCurrent
40998>>>>>>>>>         Get_Attribute DF_DATE_SEPARATOR to iSep
41001>>>>>>>>>         Move (Character(iSep)) to sSep
41002>>>>>>>>>
41002>>>>>>>>>         // Although the sep value is "/" in the European date format, the mask seperator is "-".
41002>>>>>>>>>         Move (Replaces("-",sCurrent,sSep)) to sCurrent
41003>>>>>>>>>         Move (sSep+sSep) to sMask
41004>>>>>>>>>
41004>>>>>>>>>         // Now check if the user just entered a day or a day and a month.
41004>>>>>>>>>         // Something very special is going on here. We are interpreting a string, so the format
41004>>>>>>>>>         // will always be the same, even for USA or Military dates. "99//" where 9 can be any number
41004>>>>>>>>>         //If ( (length(sCurrent) > 2) And (Right(sCurrent,2) = sMask)  ) Begin
41004>>>>>>>>>         If ((length(sCurrent) <= 4) And (Right(sCurrent,2) = sMask)) Begin
41006>>>>>>>>>            Move (replace(sMask,sCurrent,"")) to sCurrent
41007>>>>>>>>>            Move sCurrent to iCurrent
41008>>>>>>>>>            If ((iCurrent >= 1) And (iCurrent <= 31)) Begin
41010>>>>>>>>>               Get_Attribute DF_DATE_FORMAT to iDate_Format
41013>>>>>>>>>               If (iDate_Format = DF_DATE_USA) Begin
41015>>>>>>>>>                  Move (Mid( String(dOriginal),2,4)) to iDaysOffSet
41016>>>>>>>>>               End
41016>>>>>>>>>>
41016>>>>>>>>>               Else If (iDate_Format = DF_DATE_EUROPEAN) Begin
41019>>>>>>>>>                  Move (Left( String(dOriginal),2 )) to iDaysOffSet
41020>>>>>>>>>               End
41020>>>>>>>>>>
41020>>>>>>>>>               Else If (iDate_Format = DF_DATE_MILITARY) Begin
41023>>>>>>>>>                  Move (Right( String(dOriginal),2 )) to iDaysOffSet
41024>>>>>>>>>               End
41024>>>>>>>>>>
41024>>>>>>>>>               Set Value Item 0 to (Date(dOriginal - iDaysOffSet + iCurrent))
41025>>>>>>>>>            End // Let the runtime handle the error if value not in the range 1..31
41025>>>>>>>>>>
41025>>>>>>>>>         End
41025>>>>>>>>>>
41025>>>>>>>>>         Else If ((length(sCurrent) > 4) And (Right(sCurrent,1) = sSep)) Begin
41028>>>>>>>>>            Get_Attribute DF_DATE_FORMAT to iDate_Format
41031>>>>>>>>>            If ((iDate_Format = DF_DATE_USA) Or (iDate_Format = DF_DATE_EUROPEAN)) Begin
41033>>>>>>>>>               Move (Right(dOriginal,4)) to iYear
41034>>>>>>>>>            End
41034>>>>>>>>>>
41034>>>>>>>>>            Else If (iDate_Format = DF_DATE_MILITARY) Begin
41037>>>>>>>>>               Move (Left(dOriginal,4))  to iYear
41038>>>>>>>>>            End
41038>>>>>>>>>>
41038>>>>>>>>>            Set Value Item 0 to (Date(sCurrent + String(iYear)))
41039>>>>>>>>>         End
41039>>>>>>>>>>
41039>>>>>>>>>      End
41039>>>>>>>>>>
41039>>>>>>>>>   End_Procedure // DoIntelliSenseDate
41040>>>>>>>>>
41040>>>>>>>>>   Procedure Key Integer iKey Returns Integer
41041>>>>>>>>>      Date dToday dTemp
41042>>>>>>>>>      Sysdate4 dToday
41043>>>>>>>>>
41043>>>>>>>>>      If ((Character(iKey) EQ cDateToday) OR (Character(iKey) EQ Lowercase(cDateToday))) Begin
41045>>>>>>>>>         Set Value to dToday
41046>>>>>>>>>      End
41046>>>>>>>>>>
41046>>>>>>>>>      Else If ((Character(iKey) EQ cDateBeginOfMonth) OR (Character(iKey) EQ Lowercase(cDateBeginOfMonth))) Begin
41049>>>>>>>>>         Get FirstDayInMonth dToday to dTemp
41050>>>>>>>>>         Set Value to dTemp
41051>>>>>>>>>      End
41051>>>>>>>>>>
41051>>>>>>>>>      Else If ((Character(iKey) EQ cDateEndOfMonth) OR (Character(iKey) EQ Lowercase(cDateEndOfMonth))) Begin
41054>>>>>>>>>         Get LastDayInMonth dToday to dTemp
41055>>>>>>>>>         Set Value to dTemp
41056>>>>>>>>>      End
41056>>>>>>>>>>
41056>>>>>>>>>      Else Forward Send Key iKey
41059>>>>>>>>>   End_procedure
41060>>>>>>>>>
41060>>>>>>>>>End_Class // cSyIntelliSense_Date_Mixin
41061>>>>>>>
41061>>>>>>>Class cSyDateForm Is A FormSub
41062>>>>>>>   Procedure Construct_Object
41063>>>>>>>      Forward Send Construct_Object
41065>>>>>>>
41065>>>>>>>      Set Prompt_Button_Mode   to PB_PromptOn
41066>>>>>>>      Set Form_Datatype Item 0 to Mask_Date_Window
41067>>>>>>>
41067>>>>>>>      Send DoDefineIntelliSenseDateMixin
41068>>>>>>>
41068>>>>>>>      On_Key kPrompt Send Prompt
41069>>>>>>>
41069>>>>>>>      Set Prompt_Object to (oCalendar(Self))
41070>>>>>>>      Set Status_Help   to cStatusHelp
41071>>>>>>>
41071>>>>>>>   End_Procedure // Construct_Object
41072>>>>>>>
41072>>>>>>>   Import_Class_Protocol cSyIntelliSense_Date_Mixin
41073>>>>>>>
41073>>>>>>>//   Function Form_Datatype Integer iItem Returns Integer
41073>>>>>>>//      Integer iDatatype
41073>>>>>>>//
41073>>>>>>>//      If (iItem = Current) Begin
41073>>>>>>>//         Get Current_Item to iItem
41073>>>>>>>//      End
41073>>>>>>>//
41073>>>>>>>//      Forward Get Form_Datatype Item iItem to iDataType
41073>>>>>>>//
41073>>>>>>>//      Function_Return iDatatype
41073>>>>>>>//   End_Function // Form_Datatype
41073>>>>>>>
41073>>>>>>>End_Class // cSyDateForm
41074>>>>>Use Form.Sub
41074>>>>>Use Txtbox.Sub
41074>>>>>Use Button.Sub
41074>>>>>
41074>>>>>
41074>>>>>Use CTYPKIN.DD
41074>>>>>Use WTYPKIN.DD
41074>>>>>Use PTYPPAR.DD
41074>>>>>Use CLIENTS.DD
41074>>>>>Use NOMISMA.DD
41074>>>>>Use PARTICLE.DD
INCLUDING FILE: PARTICLE.DD
41074>>>>>>>//DDB-FileStart
41074>>>>>>>//DDB-HeaderStart
41074>>>>>>>
41074>>>>>>>// File Name : PARTICLE.DD
41074>>>>>>>// Class Name: Particle_DataDictionary
41074>>>>>>>// Revision  : 266
41074>>>>>>>// Version   : 2
41074>>>>>>>
41074>>>>>>>Use  Windows           // Basic Definitions
41074>>>>>>>Use  DataDict          // DataDictionary Class Definition
41074>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41074>>>>>>>
41074>>>>>>>Open Particle
41076>>>>>>>Open Pmoves
41078>>>>>>>Open Tparticl
INCLUDING FILE: TPARTICL.FD
41080>>>>>>>Open Partlfpa
INCLUDING FILE: PARTLFPA.FD
41082>>>>>>>Open Pmovesl
41084>>>>>>>Open Psxetika
INCLUDING FILE: PSXETIKA.FD
41086>>>>>>>Open Clients
41088>>>>>>>Open Ptyppar
41090>>>>>>>Open Nomisma
41092>>>>>>>Open Sysrecp
41094>>>>>>>Open Syscurxr
41096>>>>>>>Open Pseira
41098>>>>>>>Open Cn
41100>>>>>>>Open Partlfpa
41102>>>>>>>Open Clorder
41104>>>>>>>Open Clorderd
INCLUDING FILE: CLORDERD.FD
41106>>>>>>>Open Ypoprosf
INCLUDING FILE: YPOPROSF.FD
41108>>>>>>>Open Psxetika
41110>>>>>>>Open Pmoves
41112>>>>>>>Open Gmove
41114>>>>>>>Open Sysrecg
41116>>>>>>>
41116>>>>>>>//DDB-HeaderEnd
41116>>>>>>>//DDB-ValidationStart
41116>>>>>>>
41116>>>>>>>Register_Object Particle_Tropos_Diakin_VT
41116>>>>>>>Register_Object Particle_Skopos_Diakin_VT
41116>>>>>>>Register_Object Particle_Tropos_Plhromhs_VT
41116>>>>>>>
41116>>>>>>>Object Particle_Tropos_Diakin_VT  is a CodeValidationTable
41118>>>>>>>    Set Type_Value        To "SEND_TERMS"
41119>>>>>>>    Set Allow_Blank_State To TRUE
41120>>>>>>>    //DDB-ValidationCustomStart
41120>>>>>>>    //DDB-ValidationCustomEnd
41120>>>>>>>End_Object   // Particle_Tropos_Diakin_VT
41121>>>>>>>
41121>>>>>>>Object Particle_Skopos_Diakin_VT  is a CodeValidationTable
41123>>>>>>>    Set Type_Value        To "SKOPOS"
41124>>>>>>>    Set Allow_Blank_State To TRUE
41125>>>>>>>    //DDB-ValidationCustomStart
41125>>>>>>>    //DDB-ValidationCustomEnd
41125>>>>>>>End_Object   // Particle_Skopos_Diakin_VT
41126>>>>>>>
41126>>>>>>>Object Particle_Tropos_Plhromhs_VT  is a CodeValidationTable
41128>>>>>>>    Set Type_Value        To "PAY_TERMS"
41129>>>>>>>    Set Validate_State    To FALSE
41130>>>>>>>    Set Allow_Blank_State To TRUE
41131>>>>>>>    //DDB-ValidationCustomStart
41131>>>>>>>    //DDB-ValidationCustomEnd
41131>>>>>>>End_Object   // Particle_Tropos_Plhromhs_VT
41132>>>>>>>//DDB-ValidationEnd
41132>>>>>>>//DDB-SelectionStart
41132>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
41132>>>>>>>//DDB/ ExternalSelectionList sl014  sl014.SL
41132>>>>>>>//DDB/ ExternalSelectionList sl054  sl054.SL
41132>>>>>>>//DDB/ ExternalSelectionList sl053  sl053.SL
41132>>>>>>>//DDB/ ExternalSelectionList sl064  sl064.SL
41132>>>>>>>Register_Object sl041
41132>>>>>>>Register_Object sl014
41132>>>>>>>Register_Object sl054
41132>>>>>>>Register_Object sl053
41132>>>>>>>Register_Object sl064
41132>>>>>>>//DDB-SelectionEnd
41132>>>>>>>
41132>>>>>>>//Object oValidateSeira is a FileValidationTable
41132>>>>>>>//    Set Table_Title         to "„§ ¢¦šã ‘œ ¨áª ˜¨˜©«˜« ¡¦ç"
41132>>>>>>>//    Set Main_File           to Pseira.File_Number
41132>>>>>>>//    Set Code_Field          to  8 //Pseira.Pseira_Seira
41132>>>>>>>//    Set Description_Field   to 11 //Pseira.Pseira_Printer
41132>>>>>>>//    Set Ordering            to  1
41132>>>>>>>//    Set Static_State to False
41132>>>>>>>//End_Object
41132>>>>>>>
41132>>>>>>>Open Cars
INCLUDING FILE: CARS.FD
41134>>>>>>>Open Drivers
INCLUDING FILE: DRIVERS.FD
41136>>>>>>>Open Pumps
INCLUDING FILE: PUMPS.FD
41138>>>>>>>Open SysCurXr
41140>>>>>>>
41140>>>>>>>Class Particle_DataDictionary  is a DataDictionary_Sec
41141>>>>>>>
41141>>>>>>>    Function fsVresCNDescr String asCNCode Returns String
41142>>>>>>>        String rVal
41143>>>>>>>        Clear CN
41144>>>>>>>        Move asCNCode            to Cn.Cn_Code
41145>>>>>>>        Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
41146>>>>>>>>
41146>>>>>>>        If (Found) Move (Trim(CN.CN_Descr)) to rVal
41149>>>>>>>        Else Move '' to rVal
41151>>>>>>>        Function_Return rVal
41152>>>>>>>    End_Function
41153>>>>>>>
41153>>>>>>>    Function fsVresAntliaDescr String asOxhmaCode Returns String
41154>>>>>>>        String rVal
41155>>>>>>>        Clear Pumps
41156>>>>>>>        Move SysCurXr.Company_Code  to Pumps.Pump_Company
41157>>>>>>>        Move asOxhmaCode            to Pumps.Pump_ID
41158>>>>>>>        Find Eq Pumps By Index.1 // Pump_Company + Pump_ID
41159>>>>>>>>
41159>>>>>>>        If (Found) Move (Trim(Pumps.Pump_Descr)) to rVal
41162>>>>>>>        Else Move '' to rVal
41164>>>>>>>        Function_Return rVal
41165>>>>>>>    End_Function
41166>>>>>>>
41166>>>>>>>    Function fsVresOxhmaDescr String asOxhmaCode Returns String
41167>>>>>>>        String rVal
41168>>>>>>>        Clear Cars
41169>>>>>>>        Move SysCurXr.Company_Code  to Cars.Car_Company
41170>>>>>>>        Move asOxhmaCode            to Cars.Car_ID
41171>>>>>>>        Find Eq Cars By Index.1 // Car_Company + Car_ID
41172>>>>>>>>
41172>>>>>>>
41172>>>>>>>        If (Found) Move (Trim(Cars.Car_License)) to rVal
41175>>>>>>>        Else Move '' to rVal
41177>>>>>>>        Function_Return rVal
41178>>>>>>>    End_Function
41179>>>>>>>
41179>>>>>>>    Function fsVresDriverCode String asOxhmaCode Returns String
41180>>>>>>>        String rVal
41181>>>>>>>        Clear Cars
41182>>>>>>>        Move SysCurXr.Company_Code  to Cars.Car_Company
41183>>>>>>>        Move asOxhmaCode            to Cars.Car_ID
41184>>>>>>>        Find Eq Cars By Index.1 // Car_Company + Car_ID
41185>>>>>>>>
41185>>>>>>>        If (Found)  Move (Trim(Cars.Car_DriverID)) to rVal
41188>>>>>>>        Else        Move '' to rVal
41190>>>>>>>        Function_Return rVal
41191>>>>>>>    End_Function
41192>>>>>>>
41192>>>>>>>    Function fsVresDriverDescr String asDriverCode Returns String
41193>>>>>>>        String rVal
41194>>>>>>>        Clear Drivers
41195>>>>>>>        Move SysCurXr.Company_Code  to Drivers.Driver_Company
41196>>>>>>>        Move asDriverCode           to Drivers.Driver_ID
41197>>>>>>>        Find Eq Drivers By Index.1 // Driver_Company + Driver_ID
41198>>>>>>>>
41198>>>>>>>        If (Found) Move (Trim(Drivers.Driver_Name)) to rVal
41201>>>>>>>        Else Move '' to rVal
41203>>>>>>>        Function_Return rVal
41204>>>>>>>    End_Function
41205>>>>>>>
41205>>>>>>>    Procedure Construct_Object
41206>>>>>>>        Forward Send Construct_Object
41208>>>>>>>        Property String     psOldCode       Public ''
41209>>>>>>>        Property Integer    piPmovesID      Public  0
41210>>>>>>>        Property String     psOldUserID     Public ''
41211>>>>>>>        Property Integer    piOldSelected   Public  0
41212>>>>>>>        Property Integer    piFromMetasx    Public  0 
41213>>>>>>>        Property Integer    PifromBhma1     Public  0 
41214>>>>>>>        //------------------------------------------------
41214>>>>>>>        // Properties gia na kraththoun oi palies times 
41214>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
41214>>>>>>>        // einai 1     js 03/12/2007
41214>>>>>>>        //------------------------------------------------  
41214>>>>>>>        Property Integer piCreateNew            Public  0
41215>>>>>>>        Property String  psAud_Old_Pelaths      Public ""
41216>>>>>>>        Property String  psAud_Old_PelathsN     Public ""
41217>>>>>>>        Property String  psAud_Old_Ergo         Public ""
41218>>>>>>>        Property String  psAud_Old_ErgoDescr    Public ""
41219>>>>>>>        Property String  psAud_Old_Zonh         Public ""
41220>>>>>>>        Property String  psAud_Old_Antlia       Public ""
41221>>>>>>>        Property String  psAud_Old_Oxhma        Public ""
41222>>>>>>>        Property String  psAud_Old_PartlRecr    Public ""
41223>>>>>>>        Property String  psAud_Old_PmsRecr      Public ""
41224>>>>>>>        Property String  psAud_Old_Module       Public ""
41225>>>>>>>        Property String  psAud_Old_Parast       Public ""
41226>>>>>>>        Property String  psAud_Old_Seira        Public ""
41227>>>>>>>        Property Date    pdAud_Old_Hmnia        Public ""  
41228>>>>>>>        Property Integer piAud_Old_No           Public  0     
41229>>>>>>>        Property String  psAud_Old_Ektyposh     Public "" 
41230>>>>>>>        Property Integer piAud_Old_Timol        Public  0
41231>>>>>>>        Property Date    pdAud_Old_SapHmnia     Public ""
41232>>>>>>>        //------------------------------------------------
41232>>>>>>>    End_procedure
41233>>>>>>> 
41233>>>>>>> 
41233>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
41234>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
41236>>>>>>>        Set psOldCode       to Particle.Nomisma_Code
41237>>>>>>>        Set psOldUserID     to Particle.Partl_ToposF
41238>>>>>>>        Set piOldSelected   to Particle.Partl_Selected
41239>>>>>>>        //------------------------------------------------
41239>>>>>>>        // Properties gia na kraththoun oi palies times 
41239>>>>>>>        // ton pedion js 03/12/2007
41239>>>>>>>        //------------------------------------------------
41239>>>>>>>        Set psAud_Old_Pelaths       to Particle.Client_ID
41240>>>>>>>        Set psAud_Old_PelathsN      to Clients.Client_Name
41241>>>>>>>        Set psAud_Old_Ergo          to Particle.CN_Code     
41242>>>>>>>        Set psAud_Old_ErgoDescr     to (fsVresCNDescr(Self,Particle.CN_Code))
41243>>>>>>>        Set psAud_Old_PartlRecr     to Particle.Partl_Recr 
41244>>>>>>>        Set psAud_Old_PmsRecr       to Particle.Partl_Recr 
41245>>>>>>>        Set psAud_Old_Module        to Particle.Partl_Module
41246>>>>>>>        Set psAud_Old_Zonh          to Particle.Zone_ID
41247>>>>>>>        Set psAud_Old_Antlia        to Particle.Antlia_code
41248>>>>>>>        Set psAud_Old_Oxhma         to Particle.Oxhma_code
41249>>>>>>>        Set psAud_Old_Parast        to Ptyppar.Ptyppar_Code
41250>>>>>>>        Set psAud_Old_Seira         to Particle.Pseira_Seira
41251>>>>>>>        Set pdAud_Old_Hmnia         to Particle.Partl_Hmnia
41252>>>>>>>        Set piAud_Old_No            to Particle.Partl_No    
41253>>>>>>>        Set psAud_Old_Ektyposh      to Particle.Partl_Ektyposh 
41254>>>>>>>        Set piAud_Old_Timol         to Particle.Partl_Timol
41255>>>>>>>        Set pdAud_Old_SapHmnia      to Particle.Sap_hmnia
41256>>>>>>>
41256>>>>>>>        
41256>>>>>>>        //------------------------------------------------
41256>>>>>>>     End_Procedure   // New_Current_Record
41257>>>>>>>
41257>>>>>>>    Procedure Shmera integer iField  Date dDate
41258>>>>>>>        Local Integer Changed
41259>>>>>>>        Get Field_Changed_State iField to Changed
41260>>>>>>>        If (Changed=0 AND dDate =0) Begin
41262>>>>>>>            SysDate4 dDate
41263>>>>>>>            Set Field_Default_Value iField to dDate
41264>>>>>>>        End
41264>>>>>>>>
41264>>>>>>>    End_Procedure   // Shmera
41265>>>>>>>
41265>>>>>>>    Procedure Shmera_Ora integer iField  Number nOra
41266>>>>>>>        Local Integer Changed
41267>>>>>>>        Date dDate
41267>>>>>>>        Number nHour nMin
41267>>>>>>>        Get Field_Changed_State iField to Changed
41268>>>>>>>        If (Changed=0 AND nOra =0) Begin
41270>>>>>>>            SysDate4 dDate nHour nMin
41273>>>>>>>            Set Field_Default_Value iField to (nHour+(nMin/100))
41274>>>>>>>        End
41274>>>>>>>>
41274>>>>>>>    End_Procedure   // Shmera
41275>>>>>>>
41275>>>>>>>    Procedure Shmera_Ora_String integer iField  String asOra
41276>>>>>>>        Local Integer Changed
41277>>>>>>>        Date dDate
41277>>>>>>>        Number nHour nMin nTotal
41277>>>>>>>        String sOra sMin
41277>>>>>>>        Get Field_Changed_State iField to Changed
41278>>>>>>>        If (Changed=0 AND asOra='') Begin
41280>>>>>>>            SysDate4 dDate nHour nMin
41283>>>>>>>            Move (nHour+(nMin/100)) to nTotal
41284>>>>>>>            Set Field_Default_Value iField to (fsConvert_Time_Number_To_String_With_Zeroes(nTotal))
41285>>>>>>>        End
41285>>>>>>>>
41285>>>>>>>    End_Procedure   // Shmera
41286>>>>>>>
41286>>>>>>>    Procedure Save_Main_File
41287>>>>>>>        String  sCodeApo sCodeEos sOldUserID sCurrentUserID
41288>>>>>>>        Integer iBreak iPmoves iSelected iOldSelected
41288>>>>>>>        Number  nPoso nPosoEuro nIsotimia nPosothtaKin
41288>>>>>>>        Date    dHmnia
41288>>>>>>>
41288>>>>>>>        If ((Operation_Origin<>Self) And ;            (Particle.Recnum=0)) Procedure_Return
41291>>>>>>>
41291>>>>>>>        If (Particle.Cn_Code<>'') Begin
41293>>>>>>>            Clear Cn
41294>>>>>>>            Move Particle.Cn_Code   to Cn.Cn_Code
41295>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
41296>>>>>>>>
41296>>>>>>>            If (Found) Begin
41298>>>>>>>                Move Cn.Cn_Sls_ID       to Particle.Sls_ID
41299>>>>>>>                Move Cn.CN_Cnt_ID       to Particle.Cnt_ID
41300>>>>>>>                Move Cn.CN_Recr         to Particle.CN_Recr
41301>>>>>>>            End
41301>>>>>>>>
41301>>>>>>>            Else Begin
41302>>>>>>>                Move ''                 to Particle.Sls_ID
41303>>>>>>>                Move ''                 to Particle.Cnt_ID
41304>>>>>>>                Move ''                 to Particle.CN_Recr
41305>>>>>>>            End
41305>>>>>>>>
41305>>>>>>>        End
41305>>>>>>>>
41305>>>>>>>        Else Begin
41306>>>>>>>            Move ''                 to Particle.Sls_ID
41307>>>>>>>            Move ''                 to Particle.Cnt_ID
41308>>>>>>>            Move ''                 to Particle.CN_Recr
41309>>>>>>>        End
41309>>>>>>>>
41309>>>>>>>
41309>>>>>>>        Move Pmoves.Recnum              to iPmoves
41310>>>>>>>
41310>>>>>>>        Move Particle.Partl_Selected    to iSelected
41311>>>>>>>        Get piOldSelected               to iOldSelected
41312>>>>>>>        Get fsLoginUserID               to sCurrentUserID
41313>>>>>>>        Get psOldUserID                 to sOldUserID
41314>>>>>>>
41314>>>>>>>        ///----- ???????????????  REM 28/12/2010 JS
41314>>>>>>>        //If (Particle.Partl_timol=0) Begin
41314>>>>>>>        //    If (sOldUserID='') Move sCurrentUserID to Particle.Partl_Toposf
41314>>>>>>>        //End
41314>>>>>>>        //Else Begin
41314>>>>>>>        //    Move '' to Particle.Partl_Toposf
41314>>>>>>>        //End
41314>>>>>>>        ///----- ???????????????
41314>>>>>>>
41314>>>>>>>        Move 0 to nPosothtaKin
41315>>>>>>>        If ((piFromMetasx(Self)) Or (iSelected<>iOldSelected))Begin
41317>>>>>>>            If ((Particle.Partl_Toposf=sCurrentUserID) Or (Particle.Partl_Toposf='')) Begin
41319>>>>>>>                If (iSelected) Begin
41321>>>>>>>                    Clear Pmoves
41322>>>>>>>                    Move Particle.Partl_Recr to Pmoves.Partl_Recr
41323>>>>>>>                    Find Gt Pmoves by index.3
41324>>>>>>>>
41324>>>>>>>                    While ((Found=1) And (Pmoves.Partl_Recr=Particle.Partl_Recr))
41328>>>>>>>                            Move Pmoves.PMS_QTY  To Pmoves.Qty_Kinhshs
41329>>>>>>>                            Add  Pmoves.pms_qty  To nPosothtaKin
41330>>>>>>>                        Move 1              to Pmoves.Pms_Selected
41331>>>>>>>                        Saverecord Pmoves
41332>>>>>>>                        Find Gt Pmoves by index.3
41333>>>>>>>>
41333>>>>>>>                    Loop
41334>>>>>>>>
41334>>>>>>>                    Move sCurrentUserID to Particle.Partl_Toposf
41335>>>>>>>                    Move nPosothtaKin   to Particle.Partl_Disctof
41336>>>>>>>                End
41336>>>>>>>>
41336>>>>>>>                Else Begin
41337>>>>>>>                    Clear Pmoves
41338>>>>>>>                    Move Particle.Partl_Recr to Pmoves.Partl_Recr
41339>>>>>>>                    Find Gt Pmoves by index.3
41340>>>>>>>>
41340>>>>>>>                    While ((Found=1) And (Pmoves.Partl_Recr=Particle.Partl_Recr))
41344>>>>>>>                        Move 0 to Pmoves.Qty_Kinhshs
41345>>>>>>>                        Move 0 to Pmoves.Pms_Selected
41346>>>>>>>                        Saverecord Pmoves
41347>>>>>>>                        Find Gt Pmoves by index.3
41348>>>>>>>>
41348>>>>>>>                    Loop
41349>>>>>>>>
41349>>>>>>>                    Move '' to Particle.Partl_Toposf
41350>>>>>>>                    Move  0 To Particle.Partl_Selected
41351>>>>>>>                End
41351>>>>>>>>
41351>>>>>>>
41351>>>>>>>            End
41351>>>>>>>>
41351>>>>>>>            Set piFromMetasx to 0
41352>>>>>>>        End
41352>>>>>>>>
41352>>>>>>>
41352>>>>>>>        Forward Send Save_Main_File
41354>>>>>>>
41354>>>>>>>    End_Procedure   // Save_Main_File
41355>>>>>>>
41355>>>>>>>
41355>>>>>>>    Procedure Calc_The_Totals
41356>>>>>>>        Number nPct nPoso nAxia nTmp
41357>>>>>>>
41357>>>>>>>        Move (Particle.Partl_AMDISCPMS  + ;              Particle.Partl_TotDiscPc)         to Particle.Partl_DiscAm
41358>>>>>>>
41358>>>>>>>        Move (Particle.Partl_TotAmBD    - ;              Particle.Partl_DiscAm)            to Particle.Partl_TotAmAd
41359>>>>>>>
41359>>>>>>>        Move (Particle.Partl_TotAmAd    + ;              Particle.Partl_Extra)             to Particle.Partl_GenAm
41360>>>>>>>
41360>>>>>>>        If ((Particle.Partl_Extra<>0) And (Particle.Partl_ExtraVatP<>0)) Begin
41362>>>>>>>            Move (Round(Particle.Partl_Extra        *;                        Particle.Partl_ExtraVatP    /;                  100))                         to Particle.Partl_ExtraVat
41363>>>>>>>        End
41363>>>>>>>>
41363>>>>>>>
41363>>>>>>>        If ((Particle.Partl_TotDiscPC<>0) And (Particle.Disc_Vat_Pct<>0)) Begin
41365>>>>>>>            Move (Round(Particle.Partl_TotDiscPC    *;                        Particle.Disc_Vat_Pct       /;                  100))                         to Particle.Disc_Vat_Poso
41366>>>>>>>        End
41366>>>>>>>>
41366>>>>>>>
41366>>>>>>>        ////////////////////////////////////////////////////////////////////////
41366>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
41366>>>>>>>        ////////////////////////////////////////////////////////////////////////
41366>>>>>>>        If (Sysfile.Fpa_On_Total=0) Begin
41368>>>>>>>            Move (Particle.Partl_Vatam-Particle.Disc_Vat_Poso+Particle.Partl_ExtraVat) ;                to Particle.Total_Vat_Poso
41369>>>>>>>        End
41369>>>>>>>>
41369>>>>>>>        Else Begin
41370>>>>>>>            If (Particle.Fpa_On_Total<>0) ;                Move (Particle.Fpa_On_Total-Particle.Disc_Vat_Poso+Particle.Partl_ExtraVat) ;                    to Particle.Total_Vat_Poso
41373>>>>>>>            Else ;                Move (Particle.Partl_Vatam-Particle.Disc_Vat_Poso+Particle.Partl_ExtraVat) ;                    to Particle.Total_Vat_Poso
41375>>>>>>>        End
41375>>>>>>>>
41375>>>>>>>        ////////////////////////////////////////////////////////////////////////
41375>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
41375>>>>>>>        ////////////////////////////////////////////////////////////////////////
41375>>>>>>>
41375>>>>>>>        Move (Particle.Partl_GenAm      + ;              Particle.Total_Vat_Poso ) to Particle.Partl_PayAm
41376>>>>>>>
41376>>>>>>>      //  If (Particle.PARTL_TOTTEM>0) Begin
41376>>>>>>>      //      Move (Particle.PARTL_TOTTEM-Particle.Timol_Qty) ;
41376>>>>>>>      //                                      to Particle.Timol_Ypol
41376>>>>>>>      //
41376>>>>>>>      //      Move (Particle.Timol_Ypol=0)    to Particle.Partl_Timol
41376>>>>>>>      //
41376>>>>>>>      //  End
41376>>>>>>>      //  Else Move 0 to Particle.Partl_Timol
41376>>>>>>>
41376>>>>>>>        Move Particle.Partl_TotAmAD  to nAxia
41377>>>>>>>        Move Particle.Parakrat_Pct   to nPct
41378>>>>>>>        Move (Round_Number(((nAxia*nPct)/100),2)) to nTmp
41379>>>>>>>        Move nTmp to Particle.Parakrat_Poso
41380>>>>>>>    End_Procedure
41381>>>>>>>
41381>>>>>>>    Procedure Find_The_Rate
41382>>>>>>>        String  sCode sWhat
41383>>>>>>>        Integer iRateID
41383>>>>>>>        Number nEuro nIsot nRate
41383>>>>>>>        Date dHmnia
41383>>>>>>>        Move Nomisma.Nomisma_Code                   to sCode
41384>>>>>>>        If (Trim(sCode)='') Move SysCurXr.C_Code0   to sCode
41387>>>>>>>        Move Particle.Partl_Hmnia       to dHmnia
41388>>>>>>>        Move Particle.Isotimia          to nIsot
41389>>>>>>>        If (nIsot=0) Begin
41391>>>>>>>            If (dHmnia='') Sysdate dHmnia
41394>>>>>>>            Move (Trim(sCode)) to sCode
41395>>>>>>>            Clear Isotimia
41396>>>>>>>            Move sCode      to Isotimia.Nomisma_Code
41397>>>>>>>            Move (dHmnia+1) to Isotimia.Isotimia_Hmnia
41398>>>>>>>            Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
41399>>>>>>>>
41399>>>>>>>            If (Nomisma.Einai_Drx) Move 1 to Particle.Isotimia
41402>>>>>>>            Else Begin
41403>>>>>>>                Case Begin
41403>>>>>>>                    case (isotimia.poia_metatrepei='€') // Agora
41405>>>>>>>                        Move Isotimia.Isotimia_Agora to Particle.Isotimia
41406>>>>>>>                        Case Break
41407>>>>>>>                    case (isotimia.poia_metatrepei='') // Polhsh
41410>>>>>>>                        Move Isotimia.Isotimia_Polhsh to Particle.Isotimia
41411>>>>>>>                        Case Break
41412>>>>>>>                    Case (Isotimia.Poia_Metatrepei='F') // Fixing
41415>>>>>>>                        Move Isotimia.Isotimia_Fixing to Particle.Isotimia
41416>>>>>>>                        Case Break
41417>>>>>>>                    Case (Isotimia.Poia_Metatrepei='P') // Private
41420>>>>>>>                        Move Isotimia.Isotimia_Privat to Particle.Isotimia
41421>>>>>>>                        Case Break
41422>>>>>>>                Case End
41422>>>>>>>            End
41422>>>>>>>>
41422>>>>>>>        End
41422>>>>>>>>
41422>>>>>>>        Else Begin
41423>>>>>>>            If (dHmnia='') Sysdate      dHmnia
41426>>>>>>>            Move (Trim(sCode))      to  sCode
41427>>>>>>>            Clear Nomisma
41428>>>>>>>            Move sCode              to Nomisma.Nomisma_Code
41429>>>>>>>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
41430>>>>>>>>
41430>>>>>>>            If (Nomisma.Einai_Drx) Move 1 to Particle.Isotimia
41433>>>>>>>        End
41433>>>>>>>>
41433>>>>>>>    End_Procedure
41434>>>>>>>
41434>>>>>>>    Procedure Update
41435>>>>>>>        String  sCodeApo sCodeEos
41436>>>>>>>        String  sCar sCarDescr sDriver sDriverDescr
41436>>>>>>>        Integer iBreak iPmovesID
41436>>>>>>>        Number  nPoso nPosoEuro nIsotimia
41436>>>>>>>        Date    dHmnia
41436>>>>>>>
41436>>>>>>>        Forward Send Update
41438>>>>>>>
41438>>>>>>>        Send Find_The_Rate
41439>>>>>>>
41439>>>>>>>        Move SysCurXR.Company_Code  to Particle.Company_Code
41440>>>>>>>        Move SysCurXR.Branch_Code   to Particle.Branch_Code
41441>>>>>>>        Move SysCurXR.Year_Year     to Particle.Year_Year
41442>>>>>>>        Move Ctypkin.Ctypkin_Code   to Particle.Ctypkin_Code
41443>>>>>>>        Move Wtypkin.Wtypkin_Code   to Particle.Wtypkin_Code
41444>>>>>>>        //Move Custprom.Custprom_Code to Particle.Custprom_Code
41444>>>>>>>        Move Clients.Client_ID      to Particle.Client_ID
41445>>>>>>>        Move Ptyppar.Ptyppar_Code   to Particle.Ptyppar_Code
41446>>>>>>>        Move Ptyppar.Ptyppar_Module to Particle.Partl_Module
41447>>>>>>>        move clients.client_markexp to particle.partl_euro
41448>>>>>>>        Move Payresp.Presp_ID       to Particle.Presp_ID
41449>>>>>>>
41449>>>>>>>        Send Calc_The_Totals
41450>>>>>>>
41450>>>>>>>        Move    Particle.Oxhma_Code             to sCar
41451>>>>>>>        Get     fsVresOxhmaDescr sCar           to Particle.Oxhma_Descr
41452>>>>>>>        Get     fsVresDriverCode sCar           to Particle.Odhgos_Code
41453>>>>>>>        Move    Particle.Odhgos_Code            to sDriver
41454>>>>>>>        Get     fsVresDriverDescr sDriver       to Particle.Odhgos_Name
41455>>>>>>>        Move    Particle.Antlia_Code            to sCar
41456>>>>>>>        Get     fsVresAntliaDescr sCar          to sCarDescr
41457>>>>>>>        Move    sCarDescr                       to Particle.Antlia_Descr
41458>>>>>>>
41458>>>>>>>
41458>>>>>>>        ////////////////////////////////////////////////////////////////////////
41458>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
41458>>>>>>>        ////////////////////////////////////////////////////////////////////////
41458>>>>>>>//        If (Particle.Partl_ExtraVat) Begin
41458>>>>>>>//            Clear PartlFpa
41458>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
41458>>>>>>>//            Move Particle.Partl_ExtraVatP   to PartlFpa.Fpa_Pososto
41458>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
41458>>>>>>>//            Add Particle.Partl_ExtraVat     to PartlFpa.PartlFpa_Poso
41458>>>>>>>//            Saverecord PartlFpa
41458>>>>>>>//        End
41458>>>>>>>
41458>>>>>>>//        If (Particle.Disc_Vat_Poso) Begin
41458>>>>>>>//            Clear PartlFpa
41458>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
41458>>>>>>>//            Move Particle.Disc_Vat_Pct      to PartlFpa.Fpa_Pososto
41458>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
41458>>>>>>>//            Add Particle.Disc_Vat_Poso      to PartlFpa.PartlFpa_Poso
41458>>>>>>>//            Saverecord PartlFpa
41458>>>>>>>//        End
41458>>>>>>>        ////////////////////////////////////////////////////////////////////////
41458>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
41458>>>>>>>        ////////////////////////////////////////////////////////////////////////
41458>>>>>>>
41458>>>>>>>        // 01/10/2001 Mphke edo anti gia thn creating gia na kalipsei to problhma
41458>>>>>>>        // pou proekeipte an gia kapoio logo den symplhrvnotan seira kai o arithmos
41458>>>>>>>        // emene 0 eprepe na sbhstoun OLA ta lines kai to idio to parastatiko gia na
41458>>>>>>>        // xanatrexei o kodikas elegxou seiras kai arithmou
41458>>>>>>>        // Tora trexei sthn Update (giati sthn Save_Main_File kanei validation
41458>>>>>>>        // PRIN kai kobei thn eggrafh epeidh o arithmos einai 0
41458>>>>>>>        If ( ((Operation_Origin=Self) Or                 ;             (Operation_Origin=(piPmovesID(Self)))) And  ;             (Particle.Partl_No=0)) Send Kathorise_Thn_Seira
41461>>>>>>>        // 01/10/2001
41461>>>>>>>
41461>>>>>>>
41461>>>>>>>        //---------------------------------------------
41461>>>>>>>        // Auditing / Katagrafh allagon
41461>>>>>>>        //OPERATION_MODE       OPERATION_ORIGIN
41461>>>>>>>            //MODE_WAITING  
41461>>>>>>>            //MODE_FINDING  
41461>>>>>>>            //MODE_CLEARING 
41461>>>>>>>            //MODE_CREATING 
41461>>>>>>>            //MODE_SAVING   
41461>>>>>>>            //MODE_DELETING 
41461>>>>>>>            //MODE_ABORTING 
41461>>>>>>>        String  sUser sText sTime sMin sHour sSec
41461>>>>>>>        Date    dDate  Shmer 
41461>>>>>>>        Integer iMin iHour iSec iLen
41461>>>>>>>        Sysdate dDate iHour iMin iSec 
41465>>>>>>>        Move iHour  to sHour
41466>>>>>>>        Move iMin   to sMin
41467>>>>>>>        Move iSec   to sSec
41468>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
41472>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
41476>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
41480>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
41481>>>>>>>        
41481>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
41481>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
41483>>>>>>>            Get fsLoginUserID to sUser
41484>>>>>>>            If (piCreateNew(Self)=1) Begin
41486>>>>>>>                clear gmove
41487>>>>>>>                move syscurxr.company_code  to gmove.company_code
41488>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
41489>>>>>>>                move syscurxr.year_year     to gmove.year_year
41490>>>>>>>                move  1                     to gmove.gtypkin_code// Apo Parastatika
41491>>>>>>>                move ddate                  to gmove.garticl_hmnia
41492>>>>>>>                move Particle.partl_no      to gmove.garticl_no
41493>>>>>>>                move Particle.CN_Code       to gmove.gplan_recr
41494>>>>>>>                move suser                  to gmove.gplan_code
41495>>>>>>>                move Particle.Partl_Recr    to gmove.garticl_recr
41496>>>>>>>                reread sysrecg
41500>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
41501>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
41502>>>>>>>                saverecord sysrecg
41503>>>>>>>                unlock
41504>>>>>>>>
41504>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                            to Gmove.Gmove_Recr
41505>>>>>>>                Move Particle.Partl_Module          to Gmove.Module
41506>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
41507>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
41508>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
41509>>>>>>>                Move Clients.Client_ID              to Gmove.Cur_ID
41510>>>>>>>                Move Clients.CLient_Name            to Gmove.Cur_Name
41511>>>>>>>                Move Particle.CN_Code               to Gmove.Cur_CN
41512>>>>>>>                Move (fsVresCNDescr(Self,Particle.CN_Code)) ;                                                    to gmove.Cur_CN_Addr 
41513>>>>>>>                Move Particle.Partl_Recr            to Gmove.Partl_Recr 
41514>>>>>>>                Move Particle.Partl_Recr            to Gmove.Pms_Recr  
41515>>>>>>>                Move Particle.Zone_ID               to Gmove.Cur_Zonh
41516>>>>>>>                Move Particle.Antlia_code           to Gmove.Cur_Antlia
41517>>>>>>>                Move Particle.Oxhma_code            to Gmove.Cur_Oxhma       
41518>>>>>>>                Move Ptyppar.Ptyppar_Code           to Gmove.Cur_Parast
41519>>>>>>>                Move Particle.Pseira_Seira          to Gmove.Cur_Seira
41520>>>>>>>                Move Particle.Partl_Hmnia           to Gmove.Cur_Hmnia
41521>>>>>>>                Move "ƒž£ ¦¬¨šå˜ §˜¨˜©«˜« ¡¦ç" to sText
41522>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs
41523>>>>>>>                move (trim(stext))          to gmove.gmove_aitiol
41524>>>>>>>                Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                    to Gmove.Txt1
41525>>>>>>>                saverecord gmove
41526>>>>>>>                Set piCreateNew to 0
41527>>>>>>>            End
41527>>>>>>>>
41527>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
41530>>>>>>>                Integer isChanged
41530>>>>>>>                Move 0 to isChanged
41531>>>>>>>                
41531>>>>>>>                     If ((Trim(psAud_Old_Pelaths (Self))<>Trim(Clients.Client_ID      ))   Or  (Trim(psAud_Old_Ergo    (Self))<>Trim(Particle.CN_Code    ))) Move 1 to isChanged    
41534>>>>>>>                Else If ((Trim(psAud_Old_Zonh    (Self))<>Trim(Particle.Zone_ID       ))   Or  (Trim(psAud_Old_Antlia  (Self))<>Trim(Particle.Antlia_code))) Move 1 to isChanged   
41538>>>>>>>                Else If ((Trim(psAud_Old_Oxhma   (Self))<>Trim(Particle.Oxhma_code    ))   Or  (Trim(psAud_Old_Parast  (Self))<>Trim(Ptyppar.Ptyppar_Code))) Move 1 to isChanged   
41542>>>>>>>                Else If ((Trim(psAud_Old_Seira   (Self))<>Trim(Particle.Pseira_Seira  ))   Or  (Trim(pdAud_Old_Hmnia   (Self))<>Particle.Partl_Hmnia      )) Move 1 to isChanged  
41546>>>>>>>                Else If  (piAud_Old_No           (Self) <>Particle.Partl_No)                                                                                 Move 1 to isChanged
41550>>>>>>>                Else If ((Trim(psAud_Old_Ektyposh(Self))<>Trim(Particle.Partl_Ektyposh))   Or  (piAud_Old_Timol(Self)<>Particle.Partl_Timol               )) Move 1 to isChanged  
41554>>>>>>>                Else If  (pdAud_Old_SapHmnia     (Self) <>Particle.Sap_hmnia) Move 1 to isChanged
41558>>>>>>>
41558>>>>>>>                If (isChanged>0) Begin  
41560>>>>>>>                    clear gmove
41561>>>>>>>                    move syscurxr.company_code  to gmove.company_code
41562>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
41563>>>>>>>                    move syscurxr.year_year     to gmove.year_year
41564>>>>>>>                    move  1                     to gmove.gtypkin_code// Apo Parastatika
41565>>>>>>>                    move ddate                  to gmove.garticl_hmnia
41566>>>>>>>                    move Particle.partl_no      to gmove.garticl_no
41567>>>>>>>                    move Particle.CN_Code       to gmove.gplan_recr
41568>>>>>>>                    move suser                  to gmove.gplan_code
41569>>>>>>>                    move Particle.Partl_Recr    to gmove.garticl_recr
41570>>>>>>>                    reread sysrecg
41574>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
41575>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
41576>>>>>>>                    saverecord sysrecg
41577>>>>>>>                    unlock
41578>>>>>>>>
41578>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
41579>>>>>>>                    Move Particle.Partl_Module          to Gmove.Module
41580>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
41581>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
41582>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
41583>>>>>>>                    //--
41583>>>>>>>                    Move Particle.Partl_Recr            to Gmove.Partl_Recr 
41584>>>>>>>                    Move Particle.Partl_Recr            to Gmove.Pms_Recr  
41585>>>>>>>                    //--
41585>>>>>>>                    Move (Trim(Clients.Client_ID    ))  to Gmove.Cur_ID
41586>>>>>>>                    Move (Trim(Clients.CLient_Name  ))  to Gmove.Cur_Name
41587>>>>>>>                    Move (Trim(Particle.CN_Code     ))  to Gmove.Cur_CN
41588>>>>>>>                    Move (fsVresCNDescr(Self,Particle.CN_Code)) ;                                                        to gmove.Cur_CN_Addr 
41589>>>>>>>                    Move (Trim(Particle.Zone_ID     ))  to Gmove.Cur_Zonh
41590>>>>>>>                    Move (Trim(Particle.Antlia_code ))  to Gmove.Cur_Antlia
41591>>>>>>>                    Move (Trim(Particle.Oxhma_code  ))  to Gmove.Cur_Oxhma       
41592>>>>>>>                    Move (Trim(Ptyppar.Ptyppar_Code ))  to Gmove.Cur_Parast
41593>>>>>>>                    Move (Trim(Particle.Pseira_Seira))  to Gmove.Cur_Seira
41594>>>>>>>                    Move       Particle.Partl_Hmnia     to Gmove.Cur_Hmnia
41595>>>>>>>                    Move       Particle.Partl_No        to Gmove.Cur_No     
41596>>>>>>>                    Move Particle.Sap_hmnia             to Gmove.Date1
41597>>>>>>>                    //--
41597>>>>>>>                    Move (Trim(psAud_Old_Pelaths (Self))) to Gmove.Prev_ID
41598>>>>>>>                    Move (Trim(psAud_Old_PelathsN(Self))) to Gmove.Prev_Name
41599>>>>>>>                    Move (Trim(psAud_Old_Ergo    (Self))) to Gmove.Prev_CN
41600>>>>>>>                    Move (fsVresCNDescr(Self,(psAud_Old_Ergo(Self)))) ;                                                          to gmove.Prev_CN_Addr 
41601>>>>>>>                    Move (Trim(psAud_Old_Zonh    (Self))) to Gmove.Prev_Zonh
41602>>>>>>>                    Move (Trim(psAud_Old_Antlia  (Self))) to Gmove.Prev_Antlia
41603>>>>>>>                    Move (Trim(psAud_Old_Oxhma   (Self))) to Gmove.Prev_Oxhma
41604>>>>>>>                    Move (Trim(psAud_Old_Parast  (Self))) to Gmove.Prev_Parast
41605>>>>>>>                    Move (Trim(psAud_Old_Seira   (Self))) to Gmove.Prev_Seira
41606>>>>>>>                    Move      (pdAud_Old_Hmnia   (Self )) to Gmove.Prev_Hmnia
41607>>>>>>>                    Move      (piAud_Old_No      (Self )) to Gmove.Prev_No
41608>>>>>>>                    Move (pdAud_Old_SapHmnia     (Self )) to gmove.Date2 
41609>>>>>>>                    
41609>>>>>>>                    //--  
41609>>>>>>>                    If ((Trim(psAud_Old_Ektyposh(Self))<>Trim(Particle.Partl_Ektyposh)) Or (piAud_Old_Timol(Self)<>Particle.Partl_Timol) Or ;                        (pdAud_Old_SapHmnia     (Self) <>Particle.Sap_hmnia)) Move "€¤¦ š£˜ ˜¨˜©«˜« ¡¦ç - BACK DOOR"    to sText 
41612>>>>>>>                    Else Move "ƒ æ¨Ÿà©ž ˜¨˜©«˜« ¡¦ç"               to sText 
41614>>>>>>>                    
41614>>>>>>>                    Move "E" to Gmove.Eidos_Metabolhs
41615>>>>>>>                    move (trim(stext))          to gmove.gmove_aitiol
41616>>>>>>>                    Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                        to Gmove.Txt1
41617>>>>>>>                    saverecord gmove
41618>>>>>>>                    Set piCreateNew to 0
41619>>>>>>>                End
41619>>>>>>>>
41619>>>>>>>            End
41619>>>>>>>>
41619>>>>>>>        End
41619>>>>>>>>
41619>>>>>>>
41619>>>>>>>
41619>>>>>>>    End_Procedure   // Update
41620>>>>>>>
41620>>>>>>>    Procedure Delete_Main_File
41621>>>>>>>        //---------------------------------------------
41621>>>>>>>        // Auditing / Katagrafh allagon
41621>>>>>>>        //OPERATION_MODE       OPERATION_ORIGIN
41621>>>>>>>            //MODE_WAITING  
41621>>>>>>>            //MODE_FINDING  
41621>>>>>>>            //MODE_CLEARING 
41621>>>>>>>            //MODE_CREATING 
41621>>>>>>>            //MODE_SAVING   
41621>>>>>>>            //MODE_DELETING 
41621>>>>>>>            //MODE_ABORTING 
41621>>>>>>>        String  sUser sText sTime sMin sHour sSec
41622>>>>>>>        Date    dDate  Shmer 
41622>>>>>>>        Integer iMin iHour iSec iLen
41622>>>>>>>        Sysdate dDate iHour iMin iSec 
41626>>>>>>>        Move iHour  to sHour
41627>>>>>>>        Move iMin   to sMin
41628>>>>>>>        Move iSec   to sSec
41629>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
41633>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
41637>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
41641>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
41642>>>>>>>        
41642>>>>>>>        // Auditing / Diagrafh 
41642>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
41644>>>>>>>            Get fsLoginUserID to sUser
41645>>>>>>>
41645>>>>>>>            clear gmove
41646>>>>>>>            move syscurxr.company_code  to gmove.company_code
41647>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
41648>>>>>>>            move syscurxr.year_year     to gmove.year_year
41649>>>>>>>            move  1                     to gmove.gtypkin_code// Apo Parastatika
41650>>>>>>>            move ddate                  to gmove.garticl_hmnia
41651>>>>>>>            move Particle.partl_no      to gmove.garticl_no
41652>>>>>>>            move Particle.CN_Code       to gmove.gplan_recr
41653>>>>>>>            move suser                  to gmove.gplan_code
41654>>>>>>>            move Particle.Partl_Recr    to gmove.garticl_recr
41655>>>>>>>            reread sysrecg
41659>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
41660>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
41661>>>>>>>            saverecord sysrecg
41662>>>>>>>            unlock
41663>>>>>>>>
41663>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                        to Gmove.Gmove_Recr
41664>>>>>>>
41664>>>>>>>            Move (psAud_Old_Module(Self))       to Gmove.Module
41665>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
41666>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
41667>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
41668>>>>>>>            Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
41669>>>>>>>            Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
41670>>>>>>>            Move (psAud_Old_Ergo     (Self))    to Gmove.Prev_CN
41671>>>>>>>            Move (fsVresCNDescr(Self,(psAud_Old_Ergo(Self)))) ;                                                to gmove.Prev_CN_Addr 
41672>>>>>>>            Move (psAud_Old_PartlRecr(Self))    to Gmove.Partl_Recr 
41673>>>>>>>            Move (psAud_Old_PmsRecr  (Self))    to Gmove.Pms_Recr  
41674>>>>>>>            Move (psAud_Old_Zonh     (Self))    to Gmove.Prev_Zonh
41675>>>>>>>            Move (psAud_Old_Antlia   (Self))    to Gmove.Prev_Antlia
41676>>>>>>>            Move (psAud_Old_Oxhma    (Self))    to Gmove.Prev_Oxhma
41677>>>>>>>            Move (psAud_Old_Parast   (Self))    to Gmove.Prev_Parast
41678>>>>>>>            Move (psAud_Old_Seira    (Self))    to Gmove.Prev_Seira
41679>>>>>>>            Move (pdAud_Old_Hmnia    (Self))    to Gmove.Prev_Hmnia
41680>>>>>>>            Move (piAud_Old_No       (Self))    to Gmove.Prev_No
41681>>>>>>>            Move (pdAud_Old_SapHmnia (Self ))   to gmove.Date2 
41682>>>>>>>            Move "ƒ ˜š¨˜­ã ˜¨˜©«˜« ¡¦ç" to sText
41683>>>>>>>            Move "D" to Gmove.Eidos_Metabolhs
41684>>>>>>>            move (trim(stext))          to gmove.gmove_aitiol
41685>>>>>>>            Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                to Gmove.Txt1
41686>>>>>>>            saverecord gmove
41687>>>>>>>        End
41687>>>>>>>>
41687>>>>>>>
41687>>>>>>>        Forward Send Delete_Main_File
41689>>>>>>>
41689>>>>>>>    End_Procedure
41690>>>>>>>
41690>>>>>>>    Procedure Backout
41691>>>>>>>        Forward Send Backout
41693>>>>>>>        Send Calc_The_Totals
41694>>>>>>>        ////////////////////////////////////////////////////////////////////////
41694>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
41694>>>>>>>        ////////////////////////////////////////////////////////////////////////
41694>>>>>>>//        If (Particle.Partl_ExtraVat) Begin
41694>>>>>>>//            Clear PartlFpa
41694>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
41694>>>>>>>//            Move Particle.Partl_ExtraVatP   to PartlFpa.Fpa_Pososto
41694>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
41694>>>>>>>//            Sub Particle.Partl_ExtraVat   From PartlFpa.PartlFpa_Poso
41694>>>>>>>//            Saverecord PartlFpa
41694>>>>>>>//            If (PartlFpa.PartlFpa_Poso=0) Delete PartlFpa
41694>>>>>>>//        End
41694>>>>>>>
41694>>>>>>>//        If (Particle.Disc_Vat_Poso) Begin
41694>>>>>>>//            Clear PartlFpa
41694>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
41694>>>>>>>//            Move Particle.Disc_Vat_Pct      to PartlFpa.Fpa_Pososto
41694>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
41694>>>>>>>//            Sub Particle.Disc_Vat_Poso    From PartlFpa.PartlFpa_Poso
41694>>>>>>>//            Saverecord PartlFpa
41694>>>>>>>//            If (PartlFpa.PartlFpa_Poso=0) Delete PartlFpa
41694>>>>>>>//        End
41694>>>>>>>        ////////////////////////////////////////////////////////////////////////
41694>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
41694>>>>>>>        ////////////////////////////////////////////////////////////////////////
41694>>>>>>>
41694>>>>>>>
41694>>>>>>>    End_Procedure
41695>>>>>>>
41695>>>>>>>    Procedure Kathorise_Thn_Seira
41696>>>>>>>        Integer iNextNo iSeiraRecnum iPtypparRecnum
41697>>>>>>>
41697>>>>>>>//       js 25/04/2002 Prosthikh gia na ypostirixei ektyposh promhtheyton
41697>>>>>>>        If (Ptyppar.Ptyppar_Is_What='2') Begin
41699>>>>>>>            Clear Pseira
41700>>>>>>>            Move SysCurXr.Company_Code  to Pseira.Company_Code
41701>>>>>>>            Move SysCurXr.Branch_Code   to Pseira.Branch_Code
41702>>>>>>>            //Move SysCurXr.Year_Year     to Pseira.Year_Year
41702>>>>>>>            //Move Ctypkin.Ctypkin_Code   to Pseira.Ctypkin_Code
41702>>>>>>>            //Move Wtypkin.Wtypkin_Code   to Pseira.Wtypkin_Code
41702>>>>>>>            Move Ptyppar.Ptyppar_Code   to Pseira.Ptyppar_Code
41703>>>>>>>            Move Particle.Pseira_Seira  to Pseira.Pseira_Seira
41704>>>>>>>            Find eq Pseira By Index.1 // Pseira:Index.1:Company_Code+Branch_Code+Year_Year+;
41705>>>>>>>>
41705>>>>>>>                                    //                Ctypkin_Code+Wtypkin_Code+Ptyppar_Code+Seira_Seira
41705>>>>>>>            If (Found=1) Begin
41707>>>>>>>                // €¤ ž ©œ ¨˜ œ ¤˜  autonum ¡˜  «¦ §˜¨˜©«˜« ¡¦ œ ¤˜  «¬§¦¬ 2 —Š†‘†
41707>>>>>>>                If ((Pseira.Pseira_Autonum  = 1)    And ;                    (Particle.Partl_No      = 0 )) Begin
41709>>>>>>>                    Move (Pseira.Autonum_Minus-1) to iNextNo
41710>>>>>>>                    Move (Pseira.Autonum_Minus-1) to Pseira.Autonum_Minus
41711>>>>>>>                    Saverecord Pseira
41712>>>>>>>                    Move iNextNo to Particle.Partl_No
41713>>>>>>>                End
41713>>>>>>>>
41713>>>>>>>            End
41713>>>>>>>>
41713>>>>>>>        End
41713>>>>>>>>
41713>>>>>>>        Else Begin
41714>>>>>>>//       js 25/04/2002 Prosthikh gia na ypostirixei ektyposh promhtheyton
41714>>>>>>>            If ((Ptyppar.Ptyppar_Is_What='1') And (Trim(Ptyppar.Sysxet_Ptyppar)<>'')) Begin
41716>>>>>>>                Move (Random(-10000000)-1) To Particle.Partl_No
41717>>>>>>>            End
41717>>>>>>>>
41717>>>>>>>        End
41717>>>>>>>>
41717>>>>>>>    End_Procedure
41718>>>>>>>
41718>>>>>>>    Procedure Creating
41719>>>>>>>        Integer iNextNo
41720>>>>>>>        String  sNo sSeira
41720>>>>>>>        Forward Send Creating
41722>>>>>>>        // Insert Code Here
41722>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                         (Trim(String(Particle.Partl_Rec0)))))) to Particle.Partl_Recr
41723>>>>>>>
41723>>>>>>>        If (Particle.Disc_Vat_Pct   =0) Move 21 to Particle.Disc_Vat_Pct
41726>>>>>>>        If (Particle.Partl_ExtraVatP=0) Move 21 to Particle.Partl_ExtraVatP
41729>>>>>>>
41729>>>>>>>        Move Clients.Ypoloipo to Particle.Prohg_Ypol
41730>>>>>>>
41730>>>>>>>        If ((Trim(Ptyppar.Ti_Typonei_Pms)<>'2') And (Trim(Particle.Cn_Code)<>'')) Begin
41732>>>>>>>            Clear Cn
41733>>>>>>>            Move Particle.Cn_Code   to Cn.Cn_Code
41734>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
41735>>>>>>>>
41735>>>>>>>            If (Found) Begin
41737>>>>>>>                Move Particle.Partl_No      to sNo
41738>>>>>>>                Move Particle.Pseira_Seira  to sSeira
41739>>>>>>>                Move (Trim(sNo))            to sNo
41740>>>>>>>                Move (Trim(sSeira))         to sSeira
41741>>>>>>>                if (cn.hm_prot_fortio='')   Move Particle.Partl_Hmnia   to Cn.Hm_prot_Fortio
41744>>>>>>>                Move Particle.Partl_Hmnia   to Cn.Hm_Tel_Fortio
41745>>>>>>>                Move (Trim(sSeira+' '+sNo)) to Cn.Tel_Fortio_No
41746>>>>>>>                Saverecord CN
41747>>>>>>>            End
41747>>>>>>>>
41747>>>>>>>        End 
41747>>>>>>>>
41747>>>>>>>        // sta deltia apostolhs bhma1 den theloyme na ginetai elegxos opos
41747>>>>>>>        // kai sta aytonoma deltia apostolhs
41747>>>>>>>        if (PifromBhma1(self)=0) begin
41749>>>>>>>            if (clients.client_ptyppar='100') begin
41751>>>>>>>                if (ptyppar.is_xondr<>'1');                    error 5716 '‘œ œ¢á«ž •¦¤›¨ ¡ãª ›œ¤ £§¦¨œåª ¤˜ ¡æ¯œ ª ˜¨˜©«˜« ¡æ Š ˜¤ ¡ãª !!' 
41754>>>>>>>            end
41754>>>>>>>>
41754>>>>>>>            else if (clients.client_ptyppar='113') begin 
41757>>>>>>>                if (ptyppar.is_xondr='1');                    error 5717 '‘œ œ¢á«ž Š ˜¤ ¡ãª ›œ¤ £§¦¨œåª ¤˜ ¡æ¯œ ª ˜¨˜©«˜« ¡æ •¦¤›¨ ¡ãª !!' 
41760>>>>>>>            end
41760>>>>>>>>
41760>>>>>>>        End
41760>>>>>>>>
41760>>>>>>>        
41760>>>>>>>        Set piCreateNew to 1
41761>>>>>>>    
41761>>>>>>>    End_Procedure   // Creating
41762>>>>>>>
41762>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
41763>>>>>>>        String sStr
41764>>>>>>>        Move '' to sStr
41765>>>>>>>        Append sStr "DDC 14: ’¦ §˜¨˜©«˜« ¡æ §œ¨ â®œ  œ¤˜ œå›¦ª «¦ ¦§¦å¦\n"
41766>>>>>>>        Append sStr "§˜¨¦¬© áœ  ¡å¤ž©ž §¨¦ª £œ«˜©®ž£˜« ©£æ ˜§¦ «¦¤ ®¨ã©«ž\n"
41767>>>>>>>        Append sStr Particle.Partl_Toposf ". ˜«ã©«œ F5 £œ«˜ «¦ Ž‰"
41769>>>>>>>
41769>>>>>>>             If (iError_Num = 1001) Error 1001 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ˜¨˜©«˜« ¡¦ç"
41772>>>>>>>        Else If (iError_Num = 1002) Error 1002 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ”¦¨â˜"
41776>>>>>>>        Else If (iError_Num = 1003) Error 1003 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã Œ¦£å©£˜«¦ª"
41780>>>>>>>        Else If (iError_Num = 1004) Error 1004 "DDC 14: †£œ¨¦£ž¤å˜ §˜¨˜©«˜« ¡¦ç ¡œ¤ã"
41784>>>>>>>        Else If (iError_Num = 1005) Error 1005 "DDC 14: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
41788>>>>>>>        Else If (iError_Num = 1006) Error 1006 "DDC 14: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
41792>>>>>>>        Else If (iError_Num = 1007) Error 1007 "DDC 14: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
41796>>>>>>>        Else If (iError_Num = 1008) Error 1008 "DDC 14: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
41800>>>>>>>        Else If (iError_Num = 1009) Error 1009 "DDC 14: ƒœ¤ œå¤˜  œ­ ¡«ã ž › ˜š¨˜­ã \n„®œ  ›ž£ ¦¬¨šžŸœå £œ«˜©®ž£˜« ©£â¤¦ §˜¨˜©«˜« ¡æ"
41804>>>>>>>        Else If (iError_Num = 1010) Error 1010 "DDC 14: † é¨˜ §¨â§œ  ¤˜ ›¦Ÿœå\n£œ 2 ¯ž­å˜ š ˜ «ž¤ é¨˜ ¡˜  2 š ˜ «˜ ¢œ§«á"
41808>>>>>>>        Else If (iError_Num = 1011) Error 1011 "DDC 14: †£œ¨¦£ž¤å˜ §¨¦šœ¤â©«œ¨ž «žª «œ¢œ¬«˜å˜ª œ¡«ç§à©žª"
41812>>>>>>>        Else If (iError_Num = 1012) Error 1012 sStr
41816>>>>>>>        Else If (iError_Num = 1055) Error 1055 "DDC 14: †£œ¨¦£ž¤åœª œ¡«æª ¦¨åà¤ ®¨ã©žª"
41820>>>>>>>        Else If (iError_Num = 1060) Error 1060 "DDC 14: ˜¨˜©«˜« ¡æ £œ«˜©®ž£˜« ©£â¤¦.\nƒœ¤ œ§ «¨â§œ«˜  ¦§¦ ˜›ã§¦«œ ˜¢¢˜šã ©«¦ ®œåà¤"
41824>>>>>>>        Else If (iError_Num = 1061) Error 1061 "DDC 14: ˜¨˜©«˜« ¡æ £œ«˜©®ž£˜« ©£â¤¦.\nƒœ¤ œ§ «¨â§œ«˜  ¤˜ › ˜š¨˜­œå"
41828>>>>>>>        Else If (iError_Num = 6040) Error 6040 "DDC 14: ƒœ¤ â®œ  §¨¦©› ¦¨ ©«œå ¡à› ¡æª ¤¦£å©£˜«¦ª"
41832>>>>>>>        Else If (iError_Num = 6050) Error 6050 "DDC 14: Ž œ¢á«žª ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž"
41836>>>>>>>        Else If (iError_Num = 6051) Error 6051 "DDC 14: ’¦ §˜¨˜©«˜« ¡æ ¡ ¤œå ˜¥åœª ˜¢¢á «¦ ©ç¤¦¢¦ «à¤ ˜¥ é¤ «¦¬ œå¤˜  £ž›œ¤ ¡æ"
41840>>>>>>>        Else If (iError_Num = 6060) Error 6060 "DDC 14: Ž “§œçŸ¬¤¦ª ¢ž¨à£é¤ ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž"
41844>>>>>>>        Else If (iError_Num = 1110) Error 1110 "DDC 14: †£/¤å˜ §˜¨˜©«˜« ¡¦ç <= †£/¤å˜ª ¡¢œ ©å£˜«¦ª\nƒœ¤ œ§ «¨â§œ«˜  ¡˜££å˜ «¨¦§¦§¦åž©ž ©«¦ §˜¨˜©«˜« ¡æ"
41848>>>>>>>        Else If (iError_Num = 1065) Error 1065 "DDC 14: Ž €¨ Ÿ£æª «¦¬ §˜¨˜©«˜« ¡¦ç \nƒ„Œ §¨â§œ  ¡˜  ›œ¤ £§¦¨œå ¤˜ œå¤˜  £ž›œ¤ ¡æª"
41852>>>>>>>        Else If (iError_Num = 1099) Error 1099 "DDC 14: ‰˜«žš¦¨å˜ œ¢á«ž › ˜­¦¨œ« ¡ã ¡˜«žš¦¨å˜ª ˜¨˜©«˜« ¡¦ç.\n„¢œš®¦ª ¡˜«žš¦¨å˜ª Š ˜¤ ¡ãª / •¦¤›¨ ¡ãª"
41856>>>>>>>        Else Forward Send Operation_Not_Allowed  iError_Num
41859>>>>>>>    End_Procedure   // Operation_Not_Allowed
41860>>>>>>>
41860>>>>>>>    Function Validate_Save Returns Integer
41861>>>>>>>        Number nqty
41862>>>>>>>        Integer iReturnVal iYes
41862>>>>>>>        String  sCurrentUserID sOldUserID
41862>>>>>>>
41862>>>>>>>        Forward Get Validate_Save  To iReturnVal
41864>>>>>>>
41864>>>>>>>        If (Not(iReturnVal)) Begin
41866>>>>>>>                 If (Ptyppar.Recnum      = 0)   Move 1001 to iReturnVal
41869>>>>>>>            Else If (Clients.Recnum      = 0)   Move 1002 to iReturnVal
41873>>>>>>>            Else If (Nomisma.Recnum      = 0)   Move 1003 to iReturnVal
41877>>>>>>>            Else If (Particle.Partl_Hmnia='')   Move 1004 to iReturnVal
41881>>>>>>>            Else If  Nomisma.nomisma_Code eq '' Move 6040 to iReturnVal
41885>>>>>>>          //  else if (clients.is_xondr ne ptyppar.is_xondr) move 1099 to iReturnVal
41885>>>>>>>            Else Begin
41886>>>>>>>//                If ((Clients.Plafon>0) And (Clients.OverHead<1) And (Sysfile.Over_OverHead<>'1')) Begin
41886>>>>>>>//                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
41886>>>>>>>//                    If (iYes=MBR_NO) Move 6050 to iReturnVal
41886>>>>>>>//                End
41886>>>>>>>//                Else If ((Clients.Plafon>0) And (PayResp.Plafon>0) And (PayResp.OverHead<1) And (Sysfile.Over_OverHead<>'1')) Begin
41886>>>>>>>//                    Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
41886>>>>>>>//                    If (iYes=MBR_NO) Move 6060 to iReturnVal
41886>>>>>>>//                End
41886>>>>>>>//                Else If ((PayResp.Plafon>0) And (PayResp.OverHead<1) And (Sysfile.Over_OverHead<>'1')) begin
41886>>>>>>>//                    Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
41886>>>>>>>//                    If (iYes=MBR_NO) Move 6060 to iReturnVal
41886>>>>>>>//                End
41886>>>>>>>
41886>>>>>>>                If ((Particle.Partl_Hmnia<SYSCURXR.YEAR_XRHSHFROM) Or ;                    (Particle.Partl_Hmnia>SYSCURXR.YEAR_XRHSHTO))     ;                                                Move 1055 to iReturnVal
41889>>>>>>>                Else Begin
41890>>>>>>>                    If (Particle.Partl_Timol=0) Begin
41892>>>>>>>                        Get fsLoginUserID to sCurrentUserID
41893>>>>>>>                        Get psOldUserID   to sOldUserID
41894>>>>>>>                        If (sOldUserID<>'') Begin
41896>>>>>>>                            If (sOldUserID<>sCurrentUserID) Move 1012 to iReturnVal
41899>>>>>>>                        End
41899>>>>>>>>
41899>>>>>>>                        //Else Move sCurrentUserID to Particle.Partl_Toposf
41899>>>>>>>                    End
41899>>>>>>>>
41899>>>>>>>                    //Else Move '' to Particle.Partl_Toposf
41899>>>>>>>                End
41899>>>>>>>>
41899>>>>>>>            End
41899>>>>>>>>
41899>>>>>>>/////////////////////////////////////////////////////////////////////////////
41899>>>>>>>// js 26/08/2002 Erothsh: Pos tha piaso ena parastatiko to opoio kinei
41899>>>>>>>//               axies alla katalhgei na exei geniko synolo 0 (an p.x.
41899>>>>>>>//               ginoun ekptoseis 100%.
41899>>>>>>>//               Apanthsh: To piano edo me ton oro oti den mporei na kopsei
41899>>>>>>>//               timologio m'ena eidos mono to opoio exei ekptosh 100%, opote
41899>>>>>>>//               ef'oson tha yparxoun pano apo ena eidos, to eidos me thn
41899>>>>>>>//               ekptosh prepei na kataxorithei san 2o kai meta.POTE proto
41899>>>>>>>//               giati etsi tha exei 0 to synolo tou parastatikou kai tha
41899>>>>>>>//               varesei to validation.
41899>>>>>>>
41899>>>>>>>// Rem giati sthn fash metasxhmatismou apo DAP se TIM den yparxoun times sto DAP
41899>>>>>>>// opote kai to TIM pou paragetai den exei times (Eno leme pos TIM xoris times den ginetai
41899>>>>>>>// Bebaia edo mporoume na elegxoume epipleon an to paragomeno erxetai apo metasxhmatismo
41899>>>>>>>// opote kai tha to afhname. NA TO DOUME.
41899>>>>>>>//            Else If ((Sysfile.Mhdeniko_Partl=0) And (Ptyppar.Ti_Typonei_Pms<>'1') And ;
41899>>>>>>>//                     (Particle.Partl_Payam=0)   And (Particle.Partl_NoOfLines>0)) ;
41899>>>>>>>//                    Move 6051 to iReturnVal
41899>>>>>>>
41899>>>>>>>/////////////////////////////////////////////////////////////////////////////
41899>>>>>>>
41899>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
41902>>>>>>>        End
41902>>>>>>>>
41902>>>>>>>        Function_Return iReturnVal
41903>>>>>>>    End_Function   // Validate_Save
41904>>>>>>>
41904>>>>>>>
41904>>>>>>>    Function Validate_Delete  Returns Integer
41905>>>>>>>        Integer iReturnVal
41906>>>>>>>        Forward Get Validate_Delete  To iReturnVal
41908>>>>>>>        If (Not(iReturnVal)) Begin
41910>>>>>>>            If (Particle.Partl_Timol = 1) Move 1009 to iReturnVal
41913>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                     Move 1110 to iReturnVal
41917>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
41920>>>>>>>        End
41920>>>>>>>>
41920>>>>>>>        Function_Return iReturnVal
41921>>>>>>>    End_Function   // Validate_Delete
41922>>>>>>>
41922>>>>>>>
41922>>>>>>>    Procedure Define_Fields
41923>>>>>>>        Forward Send Define_Fields
41925>>>>>>>        //DDB-Generated-Code-Location
41925>>>>>>>        //DDB-DefineFieldStart
41925>>>>>>>
41925>>>>>>>        Set Main_File            To Particle.File_Number
41926>>>>>>>
41926>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41927>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41928>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41929>>>>>>>
41929>>>>>>>        // Child (Client) file structure................
41929>>>>>>>        Send Add_Client_File  Pmoves.File_Number
41930>>>>>>>        Send Add_Client_File  Tparticl.File_Number
41931>>>>>>>        Send Add_Client_File  Partlfpa.File_Number
41932>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
41933>>>>>>>        Send Add_Client_File  Psxetika.File_Number
41934>>>>>>>
41934>>>>>>>        // Parent (Server) file structure...............
41934>>>>>>>        Send Add_Server_File  Clients.File_Number
41935>>>>>>>        Send Add_Server_File  Ptyppar.File_Number
41936>>>>>>>        Send Add_Server_File  Nomisma.File_Number
41937>>>>>>>
41937>>>>>>>        // External (System) file structure.............
41937>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_NEW_SAVE
41938>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
41939>>>>>>>        Send Add_System_File  Pseira.File_Number  DD_LOCK_ON_ALL
41940>>>>>>>        Send Add_System_File  Cn.File_Number  DD_LOCK_ON_ALL
41941>>>>>>>        Send Add_System_File  Partlfpa.File_Number  DD_LOCK_ON_ALL
41942>>>>>>>        Send Add_System_File  Clorder.File_Number  DD_LOCK_ON_ALL
41943>>>>>>>        Send Add_System_File  Clorderd.File_Number  DD_LOCK_ON_ALL
41944>>>>>>>        Send Add_System_File  Ypoprosf.File_Number  DD_LOCK_ON_ALL
41945>>>>>>>        Send Add_System_File  Psxetika.File_Number  DD_LOCK_ON_ALL
41946>>>>>>>        Send Add_System_File  Pmoves.File_Number  DD_LOCK_ON_ALL
41947>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
41948>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
41949>>>>>>>
41949>>>>>>>        Define_Auto_Increment  Sysrecp.Particle_Rec0  To Particle.Partl_Rec0
41952>>>>>>>
41952>>>>>>>        // Field-based properties.......................
41952>>>>>>>
41952>>>>>>>        // Particle.Company_Code
41952>>>>>>>
41952>>>>>>>        // Particle.Branch_Code
41952>>>>>>>
41952>>>>>>>        // Particle.Year_Year
41952>>>>>>>
41952>>>>>>>        // Particle.Ctypkin_Code
41952>>>>>>>
41952>>>>>>>        // Particle.Wtypkin_Code
41952>>>>>>>
41952>>>>>>>        // Particle.Ptyppar_Code
41952>>>>>>>
41952>>>>>>>        // Particle.Pseira_Seira
41952>>>>>>>
41952>>>>>>>        // Particle.Custprom_Code
41952>>>>>>>
41952>>>>>>>        // Particle.Client_Id
41952>>>>>>>
41952>>>>>>>        // Particle.Partl_No
41952>>>>>>>
41952>>>>>>>        // Particle.Cn_Recr
41952>>>>>>>        Set Field_Prompt_Object    Field Particle.Cn_Recr To (sl041(Self))
41953>>>>>>>
41953>>>>>>>        // Particle.Pseira_Recr
41953>>>>>>>
41953>>>>>>>        // Particle.Partl_Hmnia
41953>>>>>>>        Set Field_Entry_msg        Field Particle.Partl_Hmnia To Shmera
41954>>>>>>>        Set Field_Prompt_Object    Field Particle.Partl_Hmnia To (sl014(Self))
41955>>>>>>>
41955>>>>>>>        // Particle.Partl_Rec0
41955>>>>>>>        Set Field_Options          Field Particle.Partl_Rec0 To DD_AUTOFIND   
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Lastno
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Tdiakin
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Car
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Reldoc
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Toposf
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Toposa
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Troposa
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Tof
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Disctof
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Disccl
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Autodisc
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Time
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Totambd
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Amdiscpms
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Totdiscpc
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Discam
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Totamad
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Vatpct
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Vatam
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Genam
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Extra
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Extravatp
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Extravat
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Payam
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Befypol
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Currypol
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Tottem
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Det
41956>>>>>>>
41956>>>>>>>        // Particle.Partl_Recr
41956>>>>>>>        Set Field_Options          Field Particle.Partl_Recr To DD_AUTOFIND   
41957>>>>>>>        Set Field_Prompt_Object    Field Particle.Partl_Recr To (sl014(Self))
41958>>>>>>>
41958>>>>>>>        // Particle.Cn_Code
41958>>>>>>>        Set Field_Prompt_Object    Field Particle.Cn_Code To (sl041(Self))
41959>>>>>>>
41959>>>>>>>        // Particle.Client_Recr
41959>>>>>>>
41959>>>>>>>        // Particle.Ptyppar_Recr
41959>>>>>>>
41959>>>>>>>        // Particle.Partl_Ekleise
41959>>>>>>>
41959>>>>>>>        // Particle.Partl_Ekl_Recr
41959>>>>>>>
41959>>>>>>>        // Particle.Partl_Ektyposh
41959>>>>>>>
41959>>>>>>>        // Particle.Partl_Akyrosh
41959>>>>>>>
41959>>>>>>>        // Particle.Partl_Akyr_Recr
41959>>>>>>>
41959>>>>>>>        // Particle.Partl_Nooflines
41959>>>>>>>
41959>>>>>>>        // Particle.Cmoves_Recr
41959>>>>>>>
41959>>>>>>>        // Particle.Nomisma_Code
41959>>>>>>>
41959>>>>>>>        // Particle.Isotimia
41959>>>>>>>
41959>>>>>>>        // Particle.Wcmoves_Recr
41959>>>>>>>
41959>>>>>>>        // Particle.Partl_Module
41959>>>>>>>
41959>>>>>>>        // Particle.Partl_Timol
41959>>>>>>>        Set Field_Mask             Field Particle.Partl_Timol To "#"
41960>>>>>>>        Set Field_Mask_Type        Field Particle.Partl_Timol To MASK_NUMERIC_WINDOW
41961>>>>>>>
41961>>>>>>>        // Particle.Partl_Selected
41961>>>>>>>
41961>>>>>>>        // Particle.Partl_Tim_Recr
41961>>>>>>>
41961>>>>>>>        // Particle.Partl_Vsn
41961>>>>>>>
41961>>>>>>>        // Particle.Sls_Id
41961>>>>>>>
41961>>>>>>>        // Particle.Presp_Id
41961>>>>>>>
41961>>>>>>>        // Particle.Cnt_Id
41961>>>>>>>
41961>>>>>>>        // Particle.Topos_Apostolhs
41961>>>>>>>
41961>>>>>>>        // Particle.Tropos_Diakin
41961>>>>>>>        Set Field_Class_Name       Field Particle.Tropos_Diakin To "dbComboFormsub"
41962>>>>>>>        Set Field_Value_Table      Field Particle.Tropos_Diakin To (Particle_Tropos_Diakin_VT(Self))
41963>>>>>>>
41963>>>>>>>        // Particle.Ora_Apostolhs
41963>>>>>>>        Set Field_Entry_msg        Field Particle.Ora_Apostolhs To Shmera_Ora_String
41964>>>>>>>        Set Field_Mask             Field Particle.Ora_Apostolhs To "##:##"
41965>>>>>>>
41965>>>>>>>        // Particle.Skopos_Diakin
41965>>>>>>>        Set Field_Class_Name       Field Particle.Skopos_Diakin To "dbComboFormsub"
41966>>>>>>>        Set Field_Value_Table      Field Particle.Skopos_Diakin To (Particle_Skopos_Diakin_VT(Self))
41967>>>>>>>
41967>>>>>>>        // Particle.Tropos_Plhromhs
41967>>>>>>>        Set Field_Value_Table      Field Particle.Tropos_Plhromhs To (Particle_Tropos_Plhromhs_VT(Self))
41968>>>>>>>
41968>>>>>>>        // Particle.Odhgos_Code
41968>>>>>>>
41968>>>>>>>        // Particle.Odhgos_Name
41968>>>>>>>
41968>>>>>>>        // Particle.Oxhma_Code
41968>>>>>>>        Set Field_Prompt_Object    Field Particle.Oxhma_Code To (sl054(Self))
41969>>>>>>>
41969>>>>>>>        // Particle.Oxhma_Descr
41969>>>>>>>
41969>>>>>>>        // Particle.Antlia_Code
41969>>>>>>>        Set Field_Prompt_Object    Field Particle.Antlia_Code To (sl053(Self))
41970>>>>>>>
41970>>>>>>>        // Particle.Antlia_Descr
41970>>>>>>>
41970>>>>>>>        // Particle.Partl_Euro
41970>>>>>>>
41970>>>>>>>        // Particle.Disc_Vat_Pct
41970>>>>>>>
41970>>>>>>>        // Particle.Disc_Vat_Poso
41970>>>>>>>
41970>>>>>>>        // Particle.Total_Vat_Poso
41970>>>>>>>
41970>>>>>>>        // Particle.Exei_Sxetika
41970>>>>>>>
41970>>>>>>>        // Particle.Aitiol
41970>>>>>>>
41970>>>>>>>        // Particle.Max_Days_Date
41970>>>>>>>
41970>>>>>>>        // Particle.Timol_Qty
41970>>>>>>>
41970>>>>>>>        // Particle.Timol_Ypol
41970>>>>>>>
41970>>>>>>>        // Particle.Epilogh_Ekkrem
41970>>>>>>>
41970>>>>>>>        // Particle.No_Print_Module
41970>>>>>>>        //DDB/ Comment_Short       Field Particle.No_Print_Module To "Œ˜ £ž¤ «¬§é¤œ«˜  (˜§¦ ˜¢¢¦ ¡ç¡¢à£˜ §.®.§˜¨˜š ©œ ¨¦£)"
41970>>>>>>>
41970>>>>>>>        // Particle.Prohg_Ypol
41970>>>>>>>
41970>>>>>>>        // Particle.Trex_Ypol
41970>>>>>>>
41970>>>>>>>        // Particle.Parakrat_Pct
41970>>>>>>>
41970>>>>>>>        // Particle.Parakrat_Poso
41970>>>>>>>
41970>>>>>>>        // Particle.Cms_Parak_Recr
41970>>>>>>>
41970>>>>>>>        // Particle.Enhm_Logik
41970>>>>>>>
41970>>>>>>>        // Particle.Se_Logik
41970>>>>>>>
41970>>>>>>>        // Particle.Akyro
41970>>>>>>>
41970>>>>>>>        // Particle.Zone_Id
41970>>>>>>>        Set Field_Prompt_Object    Field Particle.Zone_Id To (sl064(Self))
41971>>>>>>>
41971>>>>>>>        // Particle.Fpa_On_Total
41971>>>>>>>
41971>>>>>>>        // Particle.Ss_Arithmos
41971>>>>>>>
41971>>>>>>>        // Particle.Sap_Hmnia
41971>>>>>>>        Set Field_Mask_Type        Field Particle.Sap_Hmnia To MASK_DATE_WINDOW
41972>>>>>>>
41972>>>>>>>        //DDB-DefineFieldEnd
41972>>>>>>>    End_Procedure    // Define_Fields
41973>>>>>>>
41973>>>>>>>    Procedure Field_Defaults
41974>>>>>>>        Forward Send Field_Defaults
41976>>>>>>>        //DDB-Generated-Code-Location
41976>>>>>>>        //DDB-FieldDefaultStart
41976>>>>>>>        //DDB-FieldDefaultEnd
41976>>>>>>>        Set Field_Changed_Value Field Particle.Nomisma_Code to SyscurXr.C_Code0
41977>>>>>>>    End_Procedure    // Field_Defaults
41978>>>>>>>
41978>>>>>>>End_Class    // Particle_DataDictionary
41979>>>>>>>//DDB-Selection-pkg-Start
41979>>>>>>>
41979>>>>>>>Use sl041.SL         // sl041
41979>>>>>>>Use sl014.SL         // sl014
41979>>>>>>>Use sl054.SL         // sl054
INCLUDING FILE: SL054.SL
41979>>>>>>>>>//AB/ Project sl054:cars
41979>>>>>>>>>//AB/ Object prj is a Lookup_Project
41979>>>>>>>>>//AB/     Set ProjectName to "sl054:cars"
41979>>>>>>>>>//AB/     Set ProjectFileName to "sl054.SL"
41979>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
41979>>>>>>>>>
41979>>>>>>>>>// Project Object Structure
41979>>>>>>>>>//   sl054 is a dbModalPanelSub
41979>>>>>>>>>//     Cars_DD is a DataDictionary
41979>>>>>>>>>//     oSelList is a dbListSub
41979>>>>>>>>>//     oOK_bn is a ButtonSub
41979>>>>>>>>>//     oCancel_bn is a ButtonSub
41979>>>>>>>>>//     oSearch_bn is a ButtonSub
41979>>>>>>>>>
41979>>>>>>>>>// Register all objects
41979>>>>>>>>>Register_Object Cars_DD
41979>>>>>>>>>Register_Object oCancel_bn
41979>>>>>>>>>Register_Object oOK_bn
41979>>>>>>>>>Register_Object oSearch_bn
41979>>>>>>>>>Register_Object oSelList
41979>>>>>>>>>Register_Object sl054
41979>>>>>>>>>
41979>>>>>>>>>
41979>>>>>>>>>//AB-IgnoreStart
41979>>>>>>>>>
41979>>>>>>>>>Use DFAllEnt.pkg
41979>>>>>>>>>Use dbList.Sub
41979>>>>>>>>>Use Button.Sub
41979>>>>>>>>>
41979>>>>>>>>>
41979>>>>>>>>>Use Cars.DD
INCLUDING FILE: CARS.DD
41979>>>>>>>>>>>//DDB-FileStart
41979>>>>>>>>>>>//DDB-HeaderStart
41979>>>>>>>>>>>
41979>>>>>>>>>>>// File Name : CARS.DD
41979>>>>>>>>>>>// Class Name: Cars_DataDictionary
41979>>>>>>>>>>>// Revision  : 16
41979>>>>>>>>>>>// Version   : 2
41979>>>>>>>>>>>
41979>>>>>>>>>>>Use  Windows           // Basic Definitions
41979>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41979>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41979>>>>>>>>>>>
41979>>>>>>>>>>>Open Cars
41981>>>>>>>>>>>Open Gmove
41983>>>>>>>>>>>Open Sysrecg
41985>>>>>>>>>>>
41985>>>>>>>>>>>//DDB-HeaderEnd
41985>>>>>>>>>>>//DDB-ValidationStart
41985>>>>>>>>>>>
41985>>>>>>>>>>>Register_Object Cars_Ctype_Id_VT
41985>>>>>>>>>>>
41985>>>>>>>>>>>Object Cars_Ctype_Id_VT  is a CodeValidationTable
41987>>>>>>>>>>>    Set Type_Value        To "PUMPSTYPE"
41988>>>>>>>>>>>    Set Validate_State    To FALSE
41989>>>>>>>>>>>    Set Allow_Blank_State To TRUE
41990>>>>>>>>>>>    //DDB-ValidationCustomStart
41990>>>>>>>>>>>    //DDB-ValidationCustomEnd
41990>>>>>>>>>>>End_Object   // Cars_Ctype_Id_VT
41991>>>>>>>>>>>//DDB-ValidationEnd
41991>>>>>>>>>>>//DDB-SelectionStart
41991>>>>>>>>>>>//DDB/ ExternalSelectionList sl054  sl054.SL
41991>>>>>>>>>>>Register_Object sl054
41991>>>>>>>>>>>//DDB-SelectionEnd
41991>>>>>>>>>>>
41991>>>>>>>>>>>Class Cars_DataDictionary  is a DataDictionary_Sec
41992>>>>>>>>>>>
41992>>>>>>>>>>>
41992>>>>>>>>>>>    Procedure Construct_Object
41993>>>>>>>>>>>        Forward Send Construct_Object
41995>>>>>>>>>>>        //------------------------------------------------
41995>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
41995>>>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
41995>>>>>>>>>>>        // einai 1     js 03/12/2007
41995>>>>>>>>>>>        //------------------------------------------------  
41995>>>>>>>>>>>        Property Integer piCreateNew            Public  0
41996>>>>>>>>>>>        Property Integer piAud_Old_Tare         Public  0
41997>>>>>>>>>>>        Property Number  pnAud_Old_Pagio        Public  0
41998>>>>>>>>>>>        Property String  psAud_Old_CarID        Public ""
41999>>>>>>>>>>>        Property String  psAud_Old_CarLicense   Public ""
42000>>>>>>>>>>>        //------------------------------------------------
42000>>>>>>>>>>>
42000>>>>>>>>>>>    End_procedure
42001>>>>>>>>>>>
42001>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
42002>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
42004>>>>>>>>>>>        //------------------------------------------------
42004>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
42004>>>>>>>>>>>        // ton pedion js 03/12/2007
42004>>>>>>>>>>>        //------------------------------------------------
42004>>>>>>>>>>>        Set piAud_Old_Tare          to Cars.Car_Tare
42005>>>>>>>>>>>        Set pnAud_Old_Pagio         to Cars.Pagio
42006>>>>>>>>>>>        Set psAud_Old_CarID         to Cars.Car_ID
42007>>>>>>>>>>>        Set psAud_Old_CarLicense    to Cars.Car_License
42008>>>>>>>>>>>        //------------------------------------------------
42008>>>>>>>>>>>     End_Procedure   // New_Current_Record
42009>>>>>>>>>>>
42009>>>>>>>>>>>    Procedure Delete_Main_File
42010>>>>>>>>>>>        //---------------------------------------------
42010>>>>>>>>>>>        // Auditing / Katagrafh allagon
42010>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
42011>>>>>>>>>>>        Date    dDate  Shmer 
42011>>>>>>>>>>>        Integer iMin iHour iSec iLen
42011>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
42015>>>>>>>>>>>        Move iHour  to sHour
42016>>>>>>>>>>>        Move iMin   to sMin
42017>>>>>>>>>>>        Move iSec   to sSec
42018>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
42022>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
42026>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
42030>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
42031>>>>>>>>>>>        
42031>>>>>>>>>>>        // Auditing / Diagrafh 
42031>>>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
42033>>>>>>>>>>>            Get fsLoginUserID to sUser
42034>>>>>>>>>>>            clear gmove
42035>>>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
42036>>>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
42037>>>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
42038>>>>>>>>>>>            move  5                     to gmove.gtypkin_code// Apo Clients
42039>>>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
42040>>>>>>>>>>>            move suser                  to gmove.gplan_code
42041>>>>>>>>>>>            move Cars.Car_ID            to gmove.garticl_recr
42042>>>>>>>>>>>            reread sysrecg
42046>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
42047>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
42048>>>>>>>>>>>            saverecord sysrecg
42049>>>>>>>>>>>            unlock
42050>>>>>>>>>>>>
42050>>>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
42051>>>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
42052>>>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
42053>>>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
42054>>>>>>>>>>>            
42054>>>>>>>>>>>            Move Cars.Car_ID                    to Gmove.Partl_Recr          
42055>>>>>>>>>>>            Move Cars.Car_ID                    to Gmove.Pms_Recr          
42056>>>>>>>>>>>
42056>>>>>>>>>>>            Move (piAud_Old_Tare      (Self))   to Gmove.Prev_Ox_Apobaro
42057>>>>>>>>>>>            Move (pnAud_Old_Pagio     (Self))   to Gmove.Prev_Stoxos1
42058>>>>>>>>>>>            Move (psAud_Old_CarID     (Self))   to Gmove.Prev_Oxhma
42059>>>>>>>>>>>            Move (psAud_Old_CarLicense(Self))   to Gmove.Prev_CN_Prosth
42060>>>>>>>>>>>
42060>>>>>>>>>>>
42060>>>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª Ž®ã£˜«¦ª"    to gmove.gmove_aitiol
42061>>>>>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
42062>>>>>>>>>>>            saverecord gmove
42063>>>>>>>>>>>        End
42063>>>>>>>>>>>>
42063>>>>>>>>>>>        Forward Send Delete_Main_File
42065>>>>>>>>>>>
42065>>>>>>>>>>>    End_Procedure
42066>>>>>>>>>>>
42066>>>>>>>>>>>     Procedure Creating
42067>>>>>>>>>>>        Forward Send Creating
42069>>>>>>>>>>>        Set piCreateNew to 1
42070>>>>>>>>>>>    End_Procedure   // Creating
42071>>>>>>>>>>>
42071>>>>>>>>>>>
42071>>>>>>>>>>>
42071>>>>>>>>>>>
42071>>>>>>>>>>>    // Update:
42071>>>>>>>>>>>    Procedure Update
42072>>>>>>>>>>>        Forward Send Update
42074>>>>>>>>>>>        move syscurxr.company_code  to cars.car_company
42075>>>>>>>>>>>        move syscurxr.beto_site     to cars.car_bsite
42076>>>>>>>>>>>        // Insert Code Here
42076>>>>>>>>>>>        
42076>>>>>>>>>>>        //---------------------------------------------
42076>>>>>>>>>>>        // Auditing / Katagrafh allagon
42076>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
42077>>>>>>>>>>>        Date    dDate  Shmer 
42077>>>>>>>>>>>        Integer iMin iHour iSec iLen
42077>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
42081>>>>>>>>>>>        Move iHour  to sHour
42082>>>>>>>>>>>        Move iMin   to sMin
42083>>>>>>>>>>>        Move iSec   to sSec
42084>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
42088>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
42092>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
42096>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
42097>>>>>>>>>>>        
42097>>>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
42097>>>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
42099>>>>>>>>>>>            Get fsLoginUserID to sUser
42100>>>>>>>>>>>            If (piCreateNew(Self)=1) Begin
42102>>>>>>>>>>>                clear gmove
42103>>>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
42104>>>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
42105>>>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
42106>>>>>>>>>>>                move  5                     to gmove.gtypkin_code// Apo Clients
42107>>>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
42108>>>>>>>>>>>                move suser                  to gmove.gplan_code
42109>>>>>>>>>>>                move Cars.Car_ID            to gmove.garticl_recr
42110>>>>>>>>>>>                reread sysrecg
42114>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
42115>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
42116>>>>>>>>>>>                saverecord sysrecg
42117>>>>>>>>>>>                unlock
42118>>>>>>>>>>>>
42118>>>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
42119>>>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
42120>>>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
42121>>>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
42122>>>>>>>>>>>
42122>>>>>>>>>>>                Move Cars.Car_ID            to Gmove.Partl_Recr          
42123>>>>>>>>>>>                Move Cars.Car_ID            to Gmove.Pms_Recr          
42124>>>>>>>>>>>
42124>>>>>>>>>>>                Move Cars.Car_Tare          to Gmove.Cur_Ox_Apobaro
42125>>>>>>>>>>>                Move Cars.Pagio             to Gmove.Cur_Stoxos1
42126>>>>>>>>>>>                Move Cars.Car_ID            to Gmove.Cur_Oxhma
42127>>>>>>>>>>>                Move Cars.Car_License       to Gmove.Cur_CN_Prosth
42128>>>>>>>>>>>                
42128>>>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â˜ª Ž®ã£˜«¦ª" to Gmove.Gmove_Aitiol
42129>>>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs  
42130>>>>>>>>>>>                saverecord gmove
42131>>>>>>>>>>>                Set piCreateNew to 0
42132>>>>>>>>>>>            End
42132>>>>>>>>>>>>
42132>>>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
42135>>>>>>>>>>>                Integer isChanged
42135>>>>>>>>>>>                Move 0 to isChanged
42136>>>>>>>>>>>                
42136>>>>>>>>>>>                     If (pnAud_Old_Pagio     (Self)<>Cars.Pagio        ) Move 1 to isChanged
42139>>>>>>>>>>>                Else If (piAud_Old_Tare      (Self)<>Cars.Car_Tare     ) Move 1 to isChanged
42143>>>>>>>>>>>                Else If (psAud_Old_CarID     (Self)<>Cars.Car_ID       ) Move 1 to isChanged
42147>>>>>>>>>>>                Else If (psAud_Old_CarLicense(Self)<>Cars.Car_License  ) Move 1 to isChanged
42151>>>>>>>>>>>                
42151>>>>>>>>>>>                If (isChanged>0) Begin  
42153>>>>>>>>>>>                    clear gmove
42154>>>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
42155>>>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
42156>>>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
42157>>>>>>>>>>>                    move  5                     to gmove.gtypkin_code// Apo Clients
42158>>>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
42159>>>>>>>>>>>                    move suser                  to gmove.gplan_code
42160>>>>>>>>>>>                    move Cars.Car_ID          to gmove.garticl_recr
42161>>>>>>>>>>>                    reread sysrecg
42165>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
42166>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
42167>>>>>>>>>>>                    saverecord sysrecg
42168>>>>>>>>>>>                    unlock
42169>>>>>>>>>>>>
42169>>>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
42170>>>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
42171>>>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
42172>>>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
42173>>>>>>>>>>>                    Move Cars.Car_ID                    to Gmove.Partl_Recr          
42174>>>>>>>>>>>                    Move Cars.Car_ID                    to Gmove.Pms_Recr          
42175>>>>>>>>>>>                    //--                                
42175>>>>>>>>>>>                    Move Cars.Car_Tare                  to Gmove.Cur_Ox_Apobaro
42176>>>>>>>>>>>                    Move Cars.Pagio                     to Gmove.Cur_Stoxos1
42177>>>>>>>>>>>                    Move Cars.Car_ID                    to Gmove.Cur_Oxhma
42178>>>>>>>>>>>                    Move Cars.Car_License               to Gmove.Cur_CN_Prosth
42179>>>>>>>>>>>                    //--
42179>>>>>>>>>>>                    Move (piAud_Old_Tare      (Self))   to Gmove.Prev_Ox_Apobaro    
42180>>>>>>>>>>>                    Move (pnAud_Old_Pagio     (Self))   to Gmove.Prev_Stoxos1       
42181>>>>>>>>>>>                    Move (psAud_Old_CarID     (Self))   to Gmove.Prev_Oxhma         
42182>>>>>>>>>>>                    Move (psAud_Old_CarLicense(Self))   to Gmove.Prev_CN_Prosth
42183>>>>>>>>>>>                                                         
42183>>>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª Ž®ã£˜«¦ª"   to gmove.gmove_aitiol
42184>>>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
42185>>>>>>>>>>>                    saverecord gmove
42186>>>>>>>>>>>                    Set piCreateNew to 0
42187>>>>>>>>>>>                End
42187>>>>>>>>>>>>
42187>>>>>>>>>>>            End
42187>>>>>>>>>>>>
42187>>>>>>>>>>>        End
42187>>>>>>>>>>>>
42187>>>>>>>>>>>        
42187>>>>>>>>>>>    End_Procedure   // Update
42188>>>>>>>>>>>
42188>>>>>>>>>>>
42188>>>>>>>>>>>    // Define_Fields:
42188>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
42188>>>>>>>>>>>
42188>>>>>>>>>>>    Procedure Define_Fields
42189>>>>>>>>>>>        Forward Send Define_Fields
42191>>>>>>>>>>>        //DDB-Generated-Code-Location
42191>>>>>>>>>>>        //DDB-DefineFieldStart
42191>>>>>>>>>>>
42191>>>>>>>>>>>        Set Main_File            To Cars.File_Number
42192>>>>>>>>>>>
42192>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
42193>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
42194>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
42195>>>>>>>>>>>
42195>>>>>>>>>>>        // External (System) file structure.............
42195>>>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
42196>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
42197>>>>>>>>>>>
42197>>>>>>>>>>>        // Field-based properties.......................
42197>>>>>>>>>>>
42197>>>>>>>>>>>        // Cars.Car_Recnum
42197>>>>>>>>>>>
42197>>>>>>>>>>>        // Cars.Car_Company
42197>>>>>>>>>>>
42197>>>>>>>>>>>        // Cars.Car_Id
42197>>>>>>>>>>>        Set Field_Options          Field Cars.Car_Id To DD_AUTOFIND   
42198>>>>>>>>>>>        Set Field_Prompt_Object    Field Cars.Car_Id To (sl054(Self))
42199>>>>>>>>>>>        Set Key_Field_State        Field Cars.Car_Id To TRUE
42200>>>>>>>>>>>
42200>>>>>>>>>>>        // Cars.Car_Descr
42200>>>>>>>>>>>        Set Field_Prompt_Object    Field Cars.Car_Descr To (sl054(Self))
42201>>>>>>>>>>>
42201>>>>>>>>>>>        // Cars.Car_License
42201>>>>>>>>>>>
42201>>>>>>>>>>>        // Cars.Car_Driverrecn
42201>>>>>>>>>>>
42201>>>>>>>>>>>        // Cars.Car_Details
42201>>>>>>>>>>>
42201>>>>>>>>>>>        // Cars.Car_Maxm3
42201>>>>>>>>>>>
42201>>>>>>>>>>>        // Cars.Car_Sitew
42201>>>>>>>>>>>
42201>>>>>>>>>>>        // Cars.Car_Tare
42201>>>>>>>>>>>
42201>>>>>>>>>>>        // Cars.Car_Codematch
42201>>>>>>>>>>>
42201>>>>>>>>>>>        // Cars.Car_Driverid
42201>>>>>>>>>>>
42201>>>>>>>>>>>        // Cars.Car_Sn
42201>>>>>>>>>>>
42201>>>>>>>>>>>        // Cars.Car_Lastupdated
42201>>>>>>>>>>>
42201>>>>>>>>>>>        // Cars.Car_Markexp
42201>>>>>>>>>>>
42201>>>>>>>>>>>        // Cars.Car_748tare1
42201>>>>>>>>>>>
42201>>>>>>>>>>>        // Cars.Car_748tare2
42201>>>>>>>>>>>
42201>>>>>>>>>>>        // Cars.Car_748sign
42201>>>>>>>>>>>
42201>>>>>>>>>>>        // Cars.Car_Bsite
42201>>>>>>>>>>>
42201>>>>>>>>>>>        // Cars.Ctype_Id
42201>>>>>>>>>>>        Set Field_Class_Name       Field Cars.Ctype_Id To "dbComboFormsub"
42202>>>>>>>>>>>        Set Field_Value_Table      Field Cars.Ctype_Id To (Cars_Ctype_Id_VT(Self))
42203>>>>>>>>>>>
42203>>>>>>>>>>>        // Cars.Pagio
42203>>>>>>>>>>>
42203>>>>>>>>>>>        // Cars.Parakrat
42203>>>>>>>>>>>
42203>>>>>>>>>>>        // Cars.Car_What
42203>>>>>>>>>>>
42203>>>>>>>>>>>        // Cars.Car_Lc
42203>>>>>>>>>>>
42203>>>>>>>>>>>        // Cars.Car_Ln
42203>>>>>>>>>>>
42203>>>>>>>>>>>        //DDB-DefineFieldEnd
42203>>>>>>>>>>>    End_Procedure    // Define_Fields
42204>>>>>>>>>>>
42204>>>>>>>>>>>    // Field_Defaults:
42204>>>>>>>>>>>    // This procedure is used to establish default field values.
42204>>>>>>>>>>>
42204>>>>>>>>>>>    Procedure Field_Defaults
42205>>>>>>>>>>>        Forward Send Field_Defaults
42207>>>>>>>>>>>        //DDB-Generated-Code-Location
42207>>>>>>>>>>>        //DDB-FieldDefaultStart
42207>>>>>>>>>>>        //DDB-FieldDefaultEnd
42207>>>>>>>>>>>    End_Procedure    // Field_Defaults
42208>>>>>>>>>>>
42208>>>>>>>>>>>End_Class    // Cars_DataDictionary
42209>>>>>>>>>>>//DDB-Selection-pkg-Start
42209>>>>>>>>>>>
42209>>>>>>>>>>>Use sl054.SL         // sl054
42209>>>>>>>>>>>
42209>>>>>>>>>>>//DDB-Selection-pkg-End
42209>>>>>>>>>>>//DDB-FileEnd
42209>>>>>>>>>
42209>>>>>>>>>//AB-IgnoreEnd
42209>>>>>>>>>
42209>>>>>>>>>Object sl054 is a dbModalPanelSub
42211>>>>>>>>>    Set Label to "€¨®œå¦ Ž®ž£á«à¤"
42212>>>>>>>>>    Set Size to 148 420
42213>>>>>>>>>    Set Location to 4 5
42214>>>>>>>>>    Set Exit_Application_Local_State to FALSE
42215>>>>>>>>>    Set Modal_State to FALSE
42216>>>>>>>>>
42216>>>>>>>>>    //AB-DDOStart
42216>>>>>>>>>
42216>>>>>>>>>    Object Cars_DD is a Cars_DataDictionary
42218>>>>>>>>>    End_Object    // Cars_DD
42219>>>>>>>>>
42219>>>>>>>>>    Set Main_DD to (Cars_DD(self))
42220>>>>>>>>>    Set Server to (Cars_DD(self))
42221>>>>>>>>>
42221>>>>>>>>>    //AB-DDOEnd
42221>>>>>>>>>
42221>>>>>>>>>    Object oSelList is a dbListSub
42223>>>>>>>>>        Set Main_File to Cars.File_Number
42224>>>>>>>>>        Set Size to 105 403
42225>>>>>>>>>        Set Location to 6 6
42226>>>>>>>>>
42226>>>>>>>>>        Begin_Row
42229>>>>>>>>>            Entry_Item Cars.Car_id
42230>>>>>>>>>            Entry_Item Cars.Car_descr
42231>>>>>>>>>            Entry_Item Cars.Car_license
42232>>>>>>>>>            Entry_Item Cars.Car_maxm3
42233>>>>>>>>>            Entry_Item Cars.Car_driverid
42234>>>>>>>>>        End_Row
42239>>>>>>>>>
42239>>>>>>>>>        Set Form_Width    item 0 to 80
42240>>>>>>>>>        Set Header_Label  item 0 to "‰à›.Ž®ã£˜«¦ª"
42241>>>>>>>>>        
42241>>>>>>>>>        Set Form_Width    item 1 to 120
42242>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
42243>>>>>>>>>        
42243>>>>>>>>>        Set Form_Width    item 2 to 80
42244>>>>>>>>>        Set Header_Label  item 2 to "€¨ Ÿ.‰¬¡¢¦­¦¨å˜ª"
42245>>>>>>>>>        
42245>>>>>>>>>        Set Form_Width    item 3 to 50
42246>>>>>>>>>        Set Header_Label  item 3 to "Max.m3"
42247>>>>>>>>>        
42247>>>>>>>>>        Set Form_Width    item 4 to 65
42248>>>>>>>>>        Set Header_Label  item 4 to "‰à›.Ž›žš¦ç"
42249>>>>>>>>>        
42249>>>>>>>>>    End_Object    // oSelList
42250>>>>>>>>>
42250>>>>>>>>>    Object oOK_bn is a ButtonSub
42252>>>>>>>>>        Set Label to "&„§ ¢¦šã"
42253>>>>>>>>>        Set Location to 114 249
42254>>>>>>>>>
42254>>>>>>>>>        //AB-StoreStart
42254>>>>>>>>>        Procedure OnClick
42256>>>>>>>>>            Send OK To (oSelList(current_object))
42257>>>>>>>>>        End_Procedure
42258>>>>>>>>>        //AB-StoreEnd
42258>>>>>>>>>
42258>>>>>>>>>    End_Object    // oOK_bn
42259>>>>>>>>>
42259>>>>>>>>>    Object oCancel_bn is a ButtonSub
42261>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
42262>>>>>>>>>        Set Location to 114 305
42263>>>>>>>>>
42263>>>>>>>>>        //AB-StoreStart
42263>>>>>>>>>        Procedure OnClick
42265>>>>>>>>>            Send Cancel To (oSelList(current_object))
42266>>>>>>>>>        End_Procedure
42267>>>>>>>>>        //AB-StoreEnd
42267>>>>>>>>>
42267>>>>>>>>>    End_Object    // oCancel_bn
42268>>>>>>>>>
42268>>>>>>>>>    Object oSearch_bn is a ButtonSub
42270>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
42271>>>>>>>>>        Set Location to 114 359
42272>>>>>>>>>
42272>>>>>>>>>        //AB-StoreStart
42272>>>>>>>>>        Procedure OnClick
42274>>>>>>>>>            Send Search To (oSelList(current_object))
42275>>>>>>>>>        End_Procedure
42276>>>>>>>>>        //AB-StoreEnd
42276>>>>>>>>>
42276>>>>>>>>>    End_Object    // oSearch_bn
42277>>>>>>>>>
42277>>>>>>>>>
42277>>>>>>>>>    //AB-StoreStart
42277>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
42278>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
42279>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
42280>>>>>>>>>    //AB-StoreEnd
42280>>>>>>>>>
42280>>>>>>>>>End_Object    // sl054
42281>>>>>>>>>
42281>>>>>>>>>//AB/ End_Object    // prj
42281>>>>>>>Use sl053.SL         // sl053
INCLUDING FILE: SL053.SL
42281>>>>>>>>>//AB/ Project sl053:pumps
42281>>>>>>>>>//AB/ Object prj is a Lookup_Project
42281>>>>>>>>>//AB/     Set ProjectName to "sl053:pumps"
42281>>>>>>>>>//AB/     Set ProjectFileName to "sl053.SL"
42281>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
42281>>>>>>>>>
42281>>>>>>>>>// Project Object Structure
42281>>>>>>>>>//   sl053 is a dbModalPanelSub
42281>>>>>>>>>//     Pumps_DD is a DataDictionary
42281>>>>>>>>>//     oSelList is a dbListSub
42281>>>>>>>>>//     oOK_bn is a ButtonSub
42281>>>>>>>>>//     oCancel_bn is a ButtonSub
42281>>>>>>>>>//     oSearch_bn is a ButtonSub
42281>>>>>>>>>
42281>>>>>>>>>// Register all objects
42281>>>>>>>>>Register_Object oCancel_bn
42281>>>>>>>>>Register_Object oOK_bn
42281>>>>>>>>>Register_Object oSearch_bn
42281>>>>>>>>>Register_Object oSelList
42281>>>>>>>>>Register_Object Pumps_DD
42281>>>>>>>>>Register_Object sl053
42281>>>>>>>>>
42281>>>>>>>>>
42281>>>>>>>>>//AB-IgnoreStart
42281>>>>>>>>>
42281>>>>>>>>>Use DFAllEnt.pkg
42281>>>>>>>>>Use dbList.Sub
42281>>>>>>>>>Use Button.Sub
42281>>>>>>>>>
42281>>>>>>>>>
42281>>>>>>>>>Use Pumps.DD
INCLUDING FILE: PUMPS.DD
42281>>>>>>>>>>>//DDB-FileStart
42281>>>>>>>>>>>//DDB-HeaderStart
42281>>>>>>>>>>>
42281>>>>>>>>>>>// File Name : PUMPS.DD
42281>>>>>>>>>>>// Class Name: Pumps_DataDictionary
42281>>>>>>>>>>>// Revision  : 18
42281>>>>>>>>>>>// Version   : 2
42281>>>>>>>>>>>
42281>>>>>>>>>>>Use  Windows           // Basic Definitions
42281>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
42281>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
42281>>>>>>>>>>>
42281>>>>>>>>>>>Open Pumps
42283>>>>>>>>>>>Open Gmove
42285>>>>>>>>>>>Open Sysrecg
42287>>>>>>>>>>>
42287>>>>>>>>>>>//DDB-HeaderEnd
42287>>>>>>>>>>>//DDB-ValidationStart
42287>>>>>>>>>>>
42287>>>>>>>>>>>Register_Object Pumps_Ctype_Id_VT
42287>>>>>>>>>>>
42287>>>>>>>>>>>Object Pumps_Ctype_Id_VT  is a CodeValidationTable
42289>>>>>>>>>>>    Set Type_Value        To "PUMPSTYPE"
42290>>>>>>>>>>>    Set Validate_State    To FALSE
42291>>>>>>>>>>>    Set Allow_Blank_State To TRUE
42292>>>>>>>>>>>    //DDB-ValidationCustomStart
42292>>>>>>>>>>>    //DDB-ValidationCustomEnd
42292>>>>>>>>>>>End_Object   // Pumps_Ctype_Id_VT
42293>>>>>>>>>>>//DDB-ValidationEnd
42293>>>>>>>>>>>//DDB-SelectionStart
42293>>>>>>>>>>>//DDB/ ExternalSelectionList sl053  sl053.SL
42293>>>>>>>>>>>Register_Object sl053
42293>>>>>>>>>>>//DDB-SelectionEnd
42293>>>>>>>>>>>
42293>>>>>>>>>>>Class Pumps_DataDictionary  is a DataDictionary_Sec
42294>>>>>>>>>>>
42294>>>>>>>>>>>    Procedure Construct_Object
42295>>>>>>>>>>>        Forward Send Construct_Object
42297>>>>>>>>>>>        //------------------------------------------------
42297>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
42297>>>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
42297>>>>>>>>>>>        // einai 1     js 03/12/2007
42297>>>>>>>>>>>        //------------------------------------------------  
42297>>>>>>>>>>>        Property Integer piCreateNew            Public  0
42298>>>>>>>>>>>        Property Number  pnAud_Old_M3           Public  0
42299>>>>>>>>>>>        Property Integer piAud_Old_Pagio        Public  0
42300>>>>>>>>>>>        Property String  psAud_Old_PumpID       Public ""
42301>>>>>>>>>>>        Property String  psAud_Old_License      Public ""
42302>>>>>>>>>>>        //------------------------------------------------
42302>>>>>>>>>>>
42302>>>>>>>>>>>    End_procedure
42303>>>>>>>>>>>
42303>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
42304>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
42306>>>>>>>>>>>        //------------------------------------------------
42306>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
42306>>>>>>>>>>>        // ton pedion js 03/12/2007
42306>>>>>>>>>>>        //------------------------------------------------
42306>>>>>>>>>>>        Set pnAud_Old_M3        to Pumps.PriceM3
42307>>>>>>>>>>>        Set piAud_Old_Pagio     to Pumps.PagioMin
42308>>>>>>>>>>>        Set psAud_Old_PumpID    to Pumps.Pump_ID
42309>>>>>>>>>>>        Set psAud_Old_License   to Pumps.Pump_License
42310>>>>>>>>>>>        //------------------------------------------------
42310>>>>>>>>>>>     End_Procedure   // New_Current_Record
42311>>>>>>>>>>>
42311>>>>>>>>>>>    Procedure Delete_Main_File
42312>>>>>>>>>>>        //---------------------------------------------
42312>>>>>>>>>>>        // Auditing / Katagrafh allagon
42312>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
42313>>>>>>>>>>>        Date    dDate  Shmer 
42313>>>>>>>>>>>        Integer iMin iHour iSec iLen
42313>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
42317>>>>>>>>>>>        Move iHour  to sHour
42318>>>>>>>>>>>        Move iMin   to sMin
42319>>>>>>>>>>>        Move iSec   to sSec
42320>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
42324>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
42328>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
42332>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
42333>>>>>>>>>>>        
42333>>>>>>>>>>>        // Auditing / Diagrafh 
42333>>>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
42335>>>>>>>>>>>            Get fsLoginUserID to sUser
42336>>>>>>>>>>>            clear gmove
42337>>>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
42338>>>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
42339>>>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
42340>>>>>>>>>>>            move  6                     to gmove.gtypkin_code// Apo Clients
42341>>>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
42342>>>>>>>>>>>            move suser                  to gmove.gplan_code
42343>>>>>>>>>>>            move Pumps.Pump_ID          to gmove.garticl_recr
42344>>>>>>>>>>>            reread sysrecg
42348>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
42349>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
42350>>>>>>>>>>>            saverecord sysrecg
42351>>>>>>>>>>>            unlock
42352>>>>>>>>>>>>
42352>>>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
42353>>>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
42354>>>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
42355>>>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
42356>>>>>>>>>>>            
42356>>>>>>>>>>>            Move Pumps.Pump_ID                  to Gmove.Partl_Recr          
42357>>>>>>>>>>>            Move Pumps.Pump_ID                  to Gmove.Pms_Recr          
42358>>>>>>>>>>>
42358>>>>>>>>>>>            Move (pnAud_Old_M3     (Self))      to Gmove.Prev_Ant_Min_M3
42359>>>>>>>>>>>            Move (piAud_Old_Pagio  (Self))      to Gmove.Prev_Stoxos1
42360>>>>>>>>>>>            Move (psAud_Old_License(Self))      to Gmove.Prev_CN_Prosth
42361>>>>>>>>>>>            Move (psAud_Old_PumpID (Self))      to Gmove.Prev_Antlia
42362>>>>>>>>>>>
42362>>>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª €¤«¢å˜ª"    to gmove.gmove_aitiol
42363>>>>>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
42364>>>>>>>>>>>            saverecord gmove
42365>>>>>>>>>>>        End
42365>>>>>>>>>>>>
42365>>>>>>>>>>>        Forward Send Delete_Main_File
42367>>>>>>>>>>>
42367>>>>>>>>>>>    End_Procedure
42368>>>>>>>>>>>
42368>>>>>>>>>>>     Procedure Creating
42369>>>>>>>>>>>        Forward Send Creating
42371>>>>>>>>>>>        Set piCreateNew to 1
42372>>>>>>>>>>>    End_Procedure   // Creating
42373>>>>>>>>>>>
42373>>>>>>>>>>>
42373>>>>>>>>>>>    // Update:
42373>>>>>>>>>>>    Procedure Update
42374>>>>>>>>>>>        Forward Send Update
42376>>>>>>>>>>>        Move SysCurXR.Company_Code  to Pumps.Pump_Company
42377>>>>>>>>>>>        Move SysCurXR.Beto_Site     to Pumps.Pump_SiteW
42378>>>>>>>>>>>
42378>>>>>>>>>>>
42378>>>>>>>>>>>        //---------------------------------------------
42378>>>>>>>>>>>        // Auditing / Katagrafh allagon
42378>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
42379>>>>>>>>>>>        Date    dDate  Shmer 
42379>>>>>>>>>>>        Integer iMin iHour iSec iLen
42379>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
42383>>>>>>>>>>>        Move iHour  to sHour
42384>>>>>>>>>>>        Move iMin   to sMin
42385>>>>>>>>>>>        Move iSec   to sSec
42386>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
42390>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
42394>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
42398>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
42399>>>>>>>>>>>        
42399>>>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
42399>>>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
42401>>>>>>>>>>>            Get fsLoginUserID to sUser
42402>>>>>>>>>>>            If (piCreateNew(Self)=1) Begin
42404>>>>>>>>>>>                clear gmove
42405>>>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
42406>>>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
42407>>>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
42408>>>>>>>>>>>                move  6                     to gmove.gtypkin_code// Apo Clients
42409>>>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
42410>>>>>>>>>>>                move suser                  to gmove.gplan_code
42411>>>>>>>>>>>                move Pumps.Pump_ID          to gmove.garticl_recr
42412>>>>>>>>>>>                reread sysrecg
42416>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
42417>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
42418>>>>>>>>>>>                saverecord sysrecg
42419>>>>>>>>>>>                unlock
42420>>>>>>>>>>>>
42420>>>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
42421>>>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
42422>>>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
42423>>>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
42424>>>>>>>>>>>
42424>>>>>>>>>>>                Move Pumps.Pump_ID         to Gmove.Partl_Recr          
42425>>>>>>>>>>>                Move Pumps.Pump_ID         to Gmove.Pms_Recr          
42426>>>>>>>>>>>
42426>>>>>>>>>>>                move Pumps.Pump_ID          to gmove.Cur_Antlia
42427>>>>>>>>>>>                Move Pumps.PriceM3          to Gmove.Cur_Stoxos1
42428>>>>>>>>>>>                Move Pumps.PagioMin         to Gmove.Cur_Ant_Min_M3
42429>>>>>>>>>>>                Move Pumps.Pump_License     to Gmove.Cur_CN_Prosth
42430>>>>>>>>>>>
42430>>>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â˜ª €¤«¢å˜ª" to Gmove.Gmove_Aitiol
42431>>>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs  
42432>>>>>>>>>>>                saverecord gmove
42433>>>>>>>>>>>                Set piCreateNew to 0
42434>>>>>>>>>>>            End
42434>>>>>>>>>>>>
42434>>>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
42437>>>>>>>>>>>                Integer isChanged
42437>>>>>>>>>>>                Move 0 to isChanged
42438>>>>>>>>>>>                
42438>>>>>>>>>>>                     If (pnAud_Old_M3      (Self)<>Pumps.PriceM3     ) Move 1 to isChanged
42441>>>>>>>>>>>                Else If (piAud_Old_Pagio   (Self)<>Pumps.PagioMin    ) Move 1 to isChanged
42445>>>>>>>>>>>                Else If (psAud_Old_PumpID  (Self)<>Pumps.Pump_ID     ) Move 1 to isChanged
42449>>>>>>>>>>>                Else If (psAud_Old_License (Self)<>Pumps.Pump_License) Move 1 to isChanged
42453>>>>>>>>>>>
42453>>>>>>>>>>>                If (isChanged>0) Begin  
42455>>>>>>>>>>>                    clear gmove
42456>>>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
42457>>>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
42458>>>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
42459>>>>>>>>>>>                    move  6                     to gmove.gtypkin_code// Apo Clients
42460>>>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
42461>>>>>>>>>>>                    move suser                  to gmove.gplan_code
42462>>>>>>>>>>>                    move Pumps.Pump_ID          to gmove.garticl_recr
42463>>>>>>>>>>>                    reread sysrecg
42467>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
42468>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
42469>>>>>>>>>>>                    saverecord sysrecg
42470>>>>>>>>>>>                    unlock
42471>>>>>>>>>>>>
42471>>>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
42472>>>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
42473>>>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
42474>>>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
42475>>>>>>>>>>>                    Move Pumps.Pump_ID                  to Gmove.Partl_Recr          
42476>>>>>>>>>>>                    Move Pumps.Pump_ID                  to Gmove.Pms_Recr          
42477>>>>>>>>>>>                    //--                                
42477>>>>>>>>>>>                    move Pumps.Pump_ID                  to gmove.Cur_Antlia
42478>>>>>>>>>>>                    Move Pumps.PriceM3                  to Gmove.Cur_Stoxos1
42479>>>>>>>>>>>                    Move Pumps.PagioMin                 to Gmove.Cur_Ant_Min_M3
42480>>>>>>>>>>>                    Move Pumps.Pump_License             to Gmove.Cur_CN_Prosth
42481>>>>>>>>>>>                    //--
42481>>>>>>>>>>>                    Move (pnAud_Old_M3     (Self))      to Gmove.Prev_Stoxos1      
42482>>>>>>>>>>>                    Move (piAud_Old_Pagio  (Self))      to Gmove.Prev_Ant_Min_M3   
42483>>>>>>>>>>>                    Move (psAud_Old_License(Self))      to Gmove.Prev_CN_Prosth
42484>>>>>>>>>>>                    Move (psAud_Old_PumpID (Self))      to Gmove.Prev_Antlia
42485>>>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª €¤«¢å˜ª"    to gmove.gmove_aitiol
42486>>>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
42487>>>>>>>>>>>                    saverecord gmove
42488>>>>>>>>>>>                    Set piCreateNew to 0
42489>>>>>>>>>>>                End
42489>>>>>>>>>>>>
42489>>>>>>>>>>>            End
42489>>>>>>>>>>>>
42489>>>>>>>>>>>        End
42489>>>>>>>>>>>>
42489>>>>>>>>>>>
42489>>>>>>>>>>>
42489>>>>>>>>>>>
42489>>>>>>>>>>>    End_Procedure   // Update
42490>>>>>>>>>>>
42490>>>>>>>>>>>
42490>>>>>>>>>>>    // Define_Fields:
42490>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
42490>>>>>>>>>>>
42490>>>>>>>>>>>    Procedure Define_Fields
42491>>>>>>>>>>>        Forward Send Define_Fields
42493>>>>>>>>>>>        //DDB-Generated-Code-Location
42493>>>>>>>>>>>        //DDB-DefineFieldStart
42493>>>>>>>>>>>
42493>>>>>>>>>>>        Set Main_File            To Pumps.File_Number
42494>>>>>>>>>>>
42494>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
42495>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
42496>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
42497>>>>>>>>>>>
42497>>>>>>>>>>>        // External (System) file structure.............
42497>>>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
42498>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
42499>>>>>>>>>>>
42499>>>>>>>>>>>        // Field-based properties.......................
42499>>>>>>>>>>>
42499>>>>>>>>>>>        // Pumps.Pump_Recnum
42499>>>>>>>>>>>
42499>>>>>>>>>>>        // Pumps.Pump_Company
42499>>>>>>>>>>>
42499>>>>>>>>>>>        // Pumps.Pump_Id
42499>>>>>>>>>>>        Set Field_Options          Field Pumps.Pump_Id To DD_AUTOFIND   
42500>>>>>>>>>>>        Set Field_Prompt_Object    Field Pumps.Pump_Id To (sl053(Self))
42501>>>>>>>>>>>        Set Key_Field_State        Field Pumps.Pump_Id To TRUE
42502>>>>>>>>>>>
42502>>>>>>>>>>>        // Pumps.Pump_Descr
42502>>>>>>>>>>>        Set Field_Prompt_Object    Field Pumps.Pump_Descr To (sl053(Self))
42503>>>>>>>>>>>
42503>>>>>>>>>>>        // Pumps.Pump_License
42503>>>>>>>>>>>
42503>>>>>>>>>>>        // Pumps.Pump_Mhkos
42503>>>>>>>>>>>
42503>>>>>>>>>>>        // Pumps.Pump_Mhkosch
42503>>>>>>>>>>>
42503>>>>>>>>>>>        // Pumps.Pump_Codematch
42503>>>>>>>>>>>
42503>>>>>>>>>>>        // Pumps.Pump_Sitew
42503>>>>>>>>>>>
42503>>>>>>>>>>>        // Pumps.Pump_Driver
42503>>>>>>>>>>>
42503>>>>>>>>>>>        // Pumps.Pump_Bsite
42503>>>>>>>>>>>
42503>>>>>>>>>>>        // Pumps.Ctype_Id
42503>>>>>>>>>>>        Set Field_Class_Name       Field Pumps.Ctype_Id To "dbComboFormsub"
42504>>>>>>>>>>>        Set Field_Value_Table      Field Pumps.Ctype_Id To (Pumps_Ctype_Id_VT(Self))
42505>>>>>>>>>>>
42505>>>>>>>>>>>        // Pumps.Pagiomin
42505>>>>>>>>>>>
42505>>>>>>>>>>>        // Pumps.Pricem3
42505>>>>>>>>>>>
42505>>>>>>>>>>>        // Pumps.Parakrat
42505>>>>>>>>>>>
42505>>>>>>>>>>>        // Pumps.Pump_What
42505>>>>>>>>>>>
42505>>>>>>>>>>>        // Pumps.Pump_Lc
42505>>>>>>>>>>>
42505>>>>>>>>>>>        // Pumps.Pump_Ln
42505>>>>>>>>>>>
42505>>>>>>>>>>>        //DDB-DefineFieldEnd
42505>>>>>>>>>>>    End_Procedure    // Define_Fields
42506>>>>>>>>>>>
42506>>>>>>>>>>>    // Field_Defaults:
42506>>>>>>>>>>>    // This procedure is used to establish default field values.
42506>>>>>>>>>>>
42506>>>>>>>>>>>    Procedure Field_Defaults
42507>>>>>>>>>>>        Forward Send Field_Defaults
42509>>>>>>>>>>>        //DDB-Generated-Code-Location
42509>>>>>>>>>>>        //DDB-FieldDefaultStart
42509>>>>>>>>>>>        //DDB-FieldDefaultEnd
42509>>>>>>>>>>>    End_Procedure    // Field_Defaults
42510>>>>>>>>>>>
42510>>>>>>>>>>>End_Class    // Pumps_DataDictionary
42511>>>>>>>>>>>//DDB-Selection-pkg-Start
42511>>>>>>>>>>>
42511>>>>>>>>>>>Use sl053.SL         // sl053
42511>>>>>>>>>>>
42511>>>>>>>>>>>//DDB-Selection-pkg-End
42511>>>>>>>>>>>//DDB-FileEnd
42511>>>>>>>>>
42511>>>>>>>>>//AB-IgnoreEnd
42511>>>>>>>>>
42511>>>>>>>>>Object sl053 is a dbModalPanelSub
42513>>>>>>>>>    Set Label to "€¨®œå¦ €¤«¢ é¤"
42514>>>>>>>>>    Set Size to 148 325
42515>>>>>>>>>    Set Location to 4 5
42516>>>>>>>>>    Set Exit_Application_Local_State to FALSE
42517>>>>>>>>>    Set Modal_State to FALSE
42518>>>>>>>>>
42518>>>>>>>>>    //AB-DDOStart
42518>>>>>>>>>
42518>>>>>>>>>    Object Pumps_DD is a Pumps_DataDictionary
42520>>>>>>>>>    End_Object    // Pumps_DD
42521>>>>>>>>>
42521>>>>>>>>>    Set Main_DD to (Pumps_DD(self))
42522>>>>>>>>>    Set Server to (Pumps_DD(self))
42523>>>>>>>>>
42523>>>>>>>>>    //AB-DDOEnd
42523>>>>>>>>>
42523>>>>>>>>>    Object oSelList is a dbListSub
42525>>>>>>>>>        Set Main_File to Pumps.File_Number
42526>>>>>>>>>        Set Size to 105 309
42527>>>>>>>>>        Set Location to 6 6
42528>>>>>>>>>
42528>>>>>>>>>        Begin_Row
42531>>>>>>>>>            Entry_Item Pumps.Pump_id
42532>>>>>>>>>            Entry_Item Pumps.Pump_descr
42533>>>>>>>>>            Entry_Item Pumps.Pump_license
42534>>>>>>>>>            Entry_Item Pumps.Pump_mhkos
42535>>>>>>>>>        End_Row
42540>>>>>>>>>
42540>>>>>>>>>        Set Form_Width    item 0 to 70
42541>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª €¤«¢å˜ª"
42542>>>>>>>>>        
42542>>>>>>>>>        Set Form_Width    item 1 to 120
42543>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
42544>>>>>>>>>        
42544>>>>>>>>>        Set Form_Width    item 2 to 65
42545>>>>>>>>>        Set Header_Label  item 2 to " ¤˜¡å›˜"
42546>>>>>>>>>        
42546>>>>>>>>>        Set Form_Width    item 3 to 46
42547>>>>>>>>>        Set Header_Label  item 3 to "‹ã¡¦ª"
42548>>>>>>>>>        
42548>>>>>>>>>    End_Object    // oSelList
42549>>>>>>>>>
42549>>>>>>>>>    Object oOK_bn is a ButtonSub
42551>>>>>>>>>        Set Label to "&„§ ¢¦šã"
42552>>>>>>>>>        Set Location to 114 157
42553>>>>>>>>>
42553>>>>>>>>>        //AB-StoreStart
42553>>>>>>>>>        Procedure OnClick
42555>>>>>>>>>            Send OK To (oSelList(current_object))
42556>>>>>>>>>        End_Procedure
42557>>>>>>>>>        //AB-StoreEnd
42557>>>>>>>>>
42557>>>>>>>>>    End_Object    // oOK_bn
42558>>>>>>>>>
42558>>>>>>>>>    Object oCancel_bn is a ButtonSub
42560>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
42561>>>>>>>>>        Set Location to 114 212
42562>>>>>>>>>
42562>>>>>>>>>        //AB-StoreStart
42562>>>>>>>>>        Procedure OnClick
42564>>>>>>>>>            Send Cancel To (oSelList(current_object))
42565>>>>>>>>>        End_Procedure
42566>>>>>>>>>        //AB-StoreEnd
42566>>>>>>>>>
42566>>>>>>>>>    End_Object    // oCancel_bn
42567>>>>>>>>>
42567>>>>>>>>>    Object oSearch_bn is a ButtonSub
42569>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
42570>>>>>>>>>        Set Location to 114 267
42571>>>>>>>>>
42571>>>>>>>>>        //AB-StoreStart
42571>>>>>>>>>        Procedure OnClick
42573>>>>>>>>>            Send Search To (oSelList(current_object))
42574>>>>>>>>>        End_Procedure
42575>>>>>>>>>        //AB-StoreEnd
42575>>>>>>>>>
42575>>>>>>>>>    End_Object    // oSearch_bn
42576>>>>>>>>>
42576>>>>>>>>>
42576>>>>>>>>>    //AB-StoreStart
42576>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
42577>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
42578>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
42579>>>>>>>>>    //AB-StoreEnd
42579>>>>>>>>>
42579>>>>>>>>>End_Object    // sl053
42580>>>>>>>>>
42580>>>>>>>>>//AB/ End_Object    // prj
42580>>>>>>>Use sl064.SL         // sl064
INCLUDING FILE: SL064.SL
42580>>>>>>>>>//AB/ Project sl064 : Zones
42580>>>>>>>>>//AB/ Object prj is a Lookup_Project
42580>>>>>>>>>//AB/     Set ProjectName to "sl064 : Zones"
42580>>>>>>>>>//AB/     Set ProjectFileName to "sl064.SL"
42580>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
42580>>>>>>>>>
42580>>>>>>>>>// Project Object Structure
42580>>>>>>>>>//   sl064 is a dbModalPanelSub
42580>>>>>>>>>//     Zones_DD is a DataDictionary
42580>>>>>>>>>//     oSelList is a dbListSub
42580>>>>>>>>>//     oOK_bn is a ButtonSub
42580>>>>>>>>>//     oCancel_bn is a ButtonSub
42580>>>>>>>>>//     oSearch_bn is a ButtonSub
42580>>>>>>>>>
42580>>>>>>>>>// Register all objects
42580>>>>>>>>>Register_Object oCancel_bn
42580>>>>>>>>>Register_Object oOK_bn
42580>>>>>>>>>Register_Object oSearch_bn
42580>>>>>>>>>Register_Object oSelList
42580>>>>>>>>>Register_Object sl064
42580>>>>>>>>>Register_Object Zones_DD
42580>>>>>>>>>
42580>>>>>>>>>
42580>>>>>>>>>//AB-IgnoreStart
42580>>>>>>>>>
42580>>>>>>>>>Use DFAllEnt.pkg
42580>>>>>>>>>Use dbList.Sub
42580>>>>>>>>>Use Button.Sub
42580>>>>>>>>>
42580>>>>>>>>>
42580>>>>>>>>>Use ZONES.DD
INCLUDING FILE: ZONES.DD
42580>>>>>>>>>>>//DDB-FileStart
42580>>>>>>>>>>>//DDB-HeaderStart
42580>>>>>>>>>>>
42580>>>>>>>>>>>// File Name : ZONES.DD
42580>>>>>>>>>>>// Class Name: Zones_DataDictionary
42580>>>>>>>>>>>// Revision  : 4
42580>>>>>>>>>>>// Version   : 2
42580>>>>>>>>>>>
42580>>>>>>>>>>>Use  Windows           // Basic Definitions
42580>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
42580>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
42580>>>>>>>>>>>
42580>>>>>>>>>>>Open Zones
INCLUDING FILE: ZONES.FD
42582>>>>>>>>>>>Open Brzones
42584>>>>>>>>>>>
42584>>>>>>>>>>>//DDB-HeaderEnd
42584>>>>>>>>>>>//DDB-SelectionStart
42584>>>>>>>>>>>//DDB/ ExternalSelectionList sl064  sl064.SL
42584>>>>>>>>>>>Register_Object sl064
42584>>>>>>>>>>>//DDB-SelectionEnd
42584>>>>>>>>>>>
42584>>>>>>>>>>>Class Zones_DataDictionary  is a DataDictionary_Sec
42585>>>>>>>>>>>
42585>>>>>>>>>>>    // Define_Fields:
42585>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
42585>>>>>>>>>>>
42585>>>>>>>>>>>    Procedure Define_Fields
42586>>>>>>>>>>>        Forward Send Define_Fields
42588>>>>>>>>>>>        //DDB-Generated-Code-Location
42588>>>>>>>>>>>        //DDB-DefineFieldStart
42588>>>>>>>>>>>
42588>>>>>>>>>>>        Set Main_File            To Zones.File_Number
42589>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
42590>>>>>>>>>>>
42590>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
42591>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
42592>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
42593>>>>>>>>>>>
42593>>>>>>>>>>>        // Child (Client) file structure................
42593>>>>>>>>>>>        Send Add_Client_File  Brzones.File_Number
42594>>>>>>>>>>>
42594>>>>>>>>>>>        // Field-based properties.......................
42594>>>>>>>>>>>
42594>>>>>>>>>>>        // Zones.Zone_Id
42594>>>>>>>>>>>        Set Field_Options          Field Zones.Zone_Id To DD_AUTOFIND   
42595>>>>>>>>>>>        Set Field_Prompt_Object    Field Zones.Zone_Id To (sl064(Self))
42596>>>>>>>>>>>        Set Key_Field_State        Field Zones.Zone_Id To TRUE
42597>>>>>>>>>>>
42597>>>>>>>>>>>        // Zones.Zone_Descr
42597>>>>>>>>>>>        Set Field_Prompt_Object    Field Zones.Zone_Descr To (sl064(Self))
42598>>>>>>>>>>>
42598>>>>>>>>>>>        //DDB-DefineFieldEnd
42598>>>>>>>>>>>    End_Procedure    // Define_Fields
42599>>>>>>>>>>>
42599>>>>>>>>>>>    // Field_Defaults:
42599>>>>>>>>>>>    // This procedure is used to establish default field values.
42599>>>>>>>>>>>
42599>>>>>>>>>>>    Procedure Field_Defaults
42600>>>>>>>>>>>        Forward Send Field_Defaults
42602>>>>>>>>>>>        //DDB-Generated-Code-Location
42602>>>>>>>>>>>        //DDB-FieldDefaultStart
42602>>>>>>>>>>>        //DDB-FieldDefaultEnd
42602>>>>>>>>>>>    End_Procedure    // Field_Defaults
42603>>>>>>>>>>>
42603>>>>>>>>>>>End_Class    // Zones_DataDictionary
42604>>>>>>>>>>>//DDB-Selection-pkg-Start
42604>>>>>>>>>>>
42604>>>>>>>>>>>Use sl064.SL         // sl064
42604>>>>>>>>>>>
42604>>>>>>>>>>>//DDB-Selection-pkg-End
42604>>>>>>>>>>>//DDB-FileEnd
42604>>>>>>>>>
42604>>>>>>>>>//AB-IgnoreEnd
42604>>>>>>>>>
42604>>>>>>>>>CD_Popup_Object sl064 is a dbModalPanelSub
42623>>>>>>>>>    Set Label to "…é¤œª"
42624>>>>>>>>>    Set Size to 148 297
42625>>>>>>>>>    Set Location to 4 5
42626>>>>>>>>>    Set Exit_Application_Local_State to FALSE
42627>>>>>>>>>    Set Modal_State to FALSE
42628>>>>>>>>>
42628>>>>>>>>>    //AB-DDOStart
42628>>>>>>>>>
42628>>>>>>>>>    Object Zones_DD is a Zones_DataDictionary
42630>>>>>>>>>    End_Object    // Zones_DD
42631>>>>>>>>>
42631>>>>>>>>>    Set Main_DD to (Zones_DD(self))
42632>>>>>>>>>    Set Server to (Zones_DD(self))
42633>>>>>>>>>
42633>>>>>>>>>    //AB-DDOEnd
42633>>>>>>>>>
42633>>>>>>>>>    Object oSelList is a dbListSub
42635>>>>>>>>>        Set Main_File to Zones.File_Number
42636>>>>>>>>>        Set Size to 105 280
42637>>>>>>>>>        Set Location to 6 6
42638>>>>>>>>>
42638>>>>>>>>>        Begin_Row
42641>>>>>>>>>            Entry_Item Zones.Zone_id
42642>>>>>>>>>            Entry_Item Zones.Zone_descr
42643>>>>>>>>>        End_Row
42648>>>>>>>>>
42648>>>>>>>>>        Set Form_Width    item 0 to 73
42649>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
42650>>>>>>>>>        
42650>>>>>>>>>        Set Form_Width    item 1 to 199
42651>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
42652>>>>>>>>>        
42652>>>>>>>>>    End_Object    // oSelList
42653>>>>>>>>>
42653>>>>>>>>>    Object oOK_bn is a ButtonSub
42655>>>>>>>>>        Set Label to "&„§ ¢¦šã"
42656>>>>>>>>>        Set Location to 115 126
42657>>>>>>>>>
42657>>>>>>>>>        //AB-StoreStart
42657>>>>>>>>>        Procedure OnClick
42659>>>>>>>>>            Send OK To (oSelList(current_object))
42660>>>>>>>>>        End_Procedure
42661>>>>>>>>>        //AB-StoreEnd
42661>>>>>>>>>
42661>>>>>>>>>    End_Object    // oOK_bn
42662>>>>>>>>>
42662>>>>>>>>>    Object oCancel_bn is a ButtonSub
42664>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
42665>>>>>>>>>        Set Location to 115 181
42666>>>>>>>>>
42666>>>>>>>>>        //AB-StoreStart
42666>>>>>>>>>        Procedure OnClick
42668>>>>>>>>>            Send Cancel To (oSelList(current_object))
42669>>>>>>>>>        End_Procedure
42670>>>>>>>>>        //AB-StoreEnd
42670>>>>>>>>>
42670>>>>>>>>>    End_Object    // oCancel_bn
42671>>>>>>>>>
42671>>>>>>>>>    Object oSearch_bn is a ButtonSub
42673>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
42674>>>>>>>>>        Set Location to 115 236
42675>>>>>>>>>
42675>>>>>>>>>        //AB-StoreStart
42675>>>>>>>>>        Procedure OnClick
42677>>>>>>>>>            Send Search To (oSelList(current_object))
42678>>>>>>>>>        End_Procedure
42679>>>>>>>>>        //AB-StoreEnd
42679>>>>>>>>>
42679>>>>>>>>>    End_Object    // oSearch_bn
42680>>>>>>>>>
42680>>>>>>>>>
42680>>>>>>>>>    //AB-StoreStart
42680>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
42681>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
42682>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
42683>>>>>>>>>    //AB-StoreEnd
42683>>>>>>>>>
42683>>>>>>>>>CD_End_Object    // sl064
42685>>>>>>>>>>
42685>>>>>>>>>
42685>>>>>>>>>//AB/ End_Object    // prj
42685>>>>>>>
42685>>>>>>>//DDB-Selection-pkg-End
42685>>>>>>>//DDB-FileEnd
42685>>>>>
42685>>>>>//AB-IgnoreEnd
42685>>>>>
42685>>>>>Object sl014 is a dbModalPanelSub
42687>>>>>
42687>>>>>    //AB-StoreTopStart
42687>>>>>                                
42687>>>>>    Property String psModule        Public ''
42689>>>>>    Property String psClient        Public ''
42691>>>>>    Property String psPtyppar       Public ''
42693>>>>>    Property String psCtypkin       Public ''
42695>>>>>    Property String psWtypkin       Public ''
42697>>>>>    Property String psPtypparRecr   Public ''
42699>>>>>    Property Integer Pino           Public 0
42701>>>>>    Property Date   pdHmnia         Public ''
42703>>>>>    
42703>>>>>    //AB-StoreTopEnd
42703>>>>>
42703>>>>>    Set Label to "˜¨˜©«˜« ¡á"
42704>>>>>    Set Size to 294 523
42705>>>>>    Set Location to 0 3
42706>>>>>    Set Color to 12363657
42707>>>>>    Set Exit_Application_Local_State to FALSE
42708>>>>>    Set Modal_State to FALSE
42709>>>>>
42709>>>>>    //AB-DDOStart
42709>>>>>
42709>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
42711>>>>>    End_Object    // Ctypkin_DD
42712>>>>>
42712>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
42714>>>>>    End_Object    // Wtypkin_DD
42715>>>>>
42715>>>>>    Object Ptyppar_DD is a Ptyppar_DataDictionary
42717>>>>>        Set DDO_Server to (Ctypkin_DD(self))
42718>>>>>        Set DDO_Server to (Wtypkin_DD(self))
42719>>>>>    End_Object    // Ptyppar_DD
42720>>>>>
42720>>>>>    Object Clients_DD is a Clients_DataDictionary
42722>>>>>    End_Object    // Clients_DD
42723>>>>>
42723>>>>>    Object Nomisma_DD is a Nomisma_DataDictionary
42725>>>>>    End_Object    // Nomisma_DD
42726>>>>>
42726>>>>>    Object Particle_DD is a Particle_DataDictionary
42728>>>>>        Set DDO_Server to (Clients_DD(self))
42729>>>>>        Set DDO_Server to (Ptyppar_DD(self))
42730>>>>>        Set DDO_Server to (Nomisma_DD(self))
42731>>>>>
42731>>>>>        //AB-StoreStart
42731>>>>>                                                        
42731>>>>>        Procedure OnConstrain
42733>>>>>            String  sPtyppar sWtypkin sCtypkin sClientID sPtypparRecr
42734>>>>>            Date    dHmnia
42734>>>>>            Integer Ino
42734>>>>>            Get psClient        to sClientID
42735>>>>>            Get psPtyppar       to sPtyppar
42736>>>>>            Get psPtypparRecr   to sPtypparRecr
42737>>>>>            Get psCtypkin       to sCtypkin
42738>>>>>            Get psWtypkin       to sWtypkin
42739>>>>>            Get Value Of cSyDateForm1 Item 0 to dHmnia
42740>>>>>            get Pino            to Ino
42741>>>>>            If (sClientID<>'') Begin
42743>>>>>                If (sPtypparRecr<>'') Begin
42745>>>>>                    Set Ordering to 1
42746>>>>>                    Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
42748>>>>>                    Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
42750>>>>>                    Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
42752>>>>>                    Constrain Particle.CustProm_Code    Eq ''
42754>>>>>                    Constrain Particle.Client_ID        Eq sClientID
42756>>>>>                    Constrain Particle.Ctypkin_Code     Eq sCtypkin
42758>>>>>                    Constrain Particle.Wtypkin_Code     Eq sWtypkin
42760>>>>>                    Constrain Particle.Ptyppar_Code     Eq sPtyppar
42762>>>>>                    If (dHmnia<>'') ;                        Constrain Particle.Partl_Hmnia  Eq dHmnia
42766>>>>>                    If (Ino<>0) ;                        Constrain Particle.Partl_no     Eq Ino
42770>>>>>                End
42770>>>>>>
42770>>>>>                Else Begin
42771>>>>>                    Set Ordering to 13
42772>>>>>                    Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
42774>>>>>                    Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
42776>>>>>                    Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
42778>>>>>                    Constrain Particle.Client_ID        Eq sClientID
42780>>>>>                    If (dHmnia<>'') ;                        Constrain Particle.Partl_Hmnia  Eq dHmnia
42784>>>>>                    If (Ino<>0) ;                        Constrain Particle.Partl_no     Eq Ino
42788>>>>>                End
42788>>>>>>
42788>>>>>            End
42788>>>>>>
42788>>>>>            Else If (sPtypparRecr<>'') Begin
42791>>>>>                Set Ordering to 12
42792>>>>>                Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
42794>>>>>                Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
42796>>>>>                Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
42798>>>>>                Constrain Particle.Partl_Module     Eq (psModule(Self))
42800>>>>>                Constrain Particle.Ptyppar_Recr     Eq sPtypparRecr
42802>>>>>                If (dHmnia<>'') ;                    Constrain Particle.Partl_Hmnia  Eq dHmnia
42806>>>>>                If (Ino<>0) ;                    Constrain Particle.Partl_no     Eq Ino
42810>>>>>            End
42810>>>>>>
42810>>>>>            Else  Begin
42811>>>>>                Set Ordering to 14
42812>>>>>                Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
42814>>>>>                Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
42816>>>>>                Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
42818>>>>>                Constrain Particle.Partl_Module     Eq (psModule(Self))
42820>>>>>                If (dHmnia<>'') ;                    Constrain Particle.Partl_Hmnia  Eq dHmnia
42824>>>>>                If (Ino<>0) ;                    Constrain Particle.Partl_no     Eq Ino
42828>>>>>            End
42828>>>>>>
42828>>>>>        
42828>>>>>        End_Procedure
42829>>>>>        
42829>>>>>        
42829>>>>>        
42829>>>>>        
42829>>>>>        
42829>>>>>        
42829>>>>>        
42829>>>>>        
42829>>>>>        
42829>>>>>        
42829>>>>>        
42829>>>>>        
42829>>>>>        
42829>>>>>        
42829>>>>>        
42829>>>>>        
42829>>>>>        
42829>>>>>        //AB-StoreEnd
42829>>>>>
42829>>>>>    End_Object    // Particle_DD
42830>>>>>
42830>>>>>    Set Main_DD to (Particle_DD(self))
42831>>>>>    Set Server to (Particle_DD(self))
42832>>>>>
42832>>>>>    //AB-DDOEnd
42832>>>>>
42832>>>>>    Object oSelList is a dbListSub
42834>>>>>        Set Main_File to Particle.File_Number
42835>>>>>        Set Size to 208 511
42836>>>>>        Set Location to 6 5
42837>>>>>        Set Auto_Index_State to FALSE
42838>>>>>
42838>>>>>        Begin_Row
42841>>>>>            Entry_Item Particle.Partl_hmnia
42842>>>>>            Entry_Item Ptyppar.Ptyppar_descr
42843>>>>>            Entry_Item Particle.Pseira_seira
42844>>>>>            Entry_Item Particle.Partl_no
42845>>>>>            Entry_Item Clients.Client_id
42846>>>>>            Entry_Item Clients.Client_name
42847>>>>>            Entry_Item Particle.Partl_payam
42848>>>>>            Entry_Item Particle.Partl_ekleise
42849>>>>>        End_Row
42854>>>>>
42854>>>>>        Set Form_Width    item 0 to 55
42855>>>>>        Set Header_Label  item 0 to "†£œ¨/¤å˜"
42856>>>>>        
42856>>>>>        Set Form_Width    item 1 to 100
42857>>>>>        Set Header_Label  item 1 to "˜¨˜©«˜« ¡æ"
42858>>>>>        
42858>>>>>        Set Form_Width    item 2 to 36
42859>>>>>        Set Header_Label  item 2 to "‘œ ¨á"
42860>>>>>        
42860>>>>>        Set Form_Width    item 3 to 55
42861>>>>>        Set Header_Label  item 3 to "€¨ Ÿ£æª"
42862>>>>>        
42862>>>>>        Set Form_Width    item 4 to 57
42863>>>>>        Set Header_Label  item 4 to "‰à› ¡æª"
42864>>>>>        
42864>>>>>        Set Form_Width    item 5 to 140
42865>>>>>        Set Header_Label  item 5 to "œ¢á«žª / ¨¦£žŸœ¬«ãª"
42866>>>>>        
42866>>>>>        Set Form_Width    item 6 to 48
42867>>>>>        Set Header_Label  item 6 to "€¥å˜"
42868>>>>>        
42868>>>>>        Set Form_Width    item 7 to 16
42869>>>>>        Set Header_Label  item 7 to "K"
42870>>>>>        Set Column_Checkbox_State  item 7 to True
42871>>>>>        
42871>>>>>
42871>>>>>        //AB-StoreStart
42871>>>>>        Set Column_Option       Item  1 to NoEnter  True
42872>>>>>        Procedure End_Construct_Object
42874>>>>>            Integer iDecimals
42875>>>>>            Forward Send End_Construct_Object
42877>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0   to    iDecimals
42878>>>>>            Set Points Item 6 to iDecimals
42879>>>>>            Set Numeric_Mask Item 6 to 14 iDecimals ' ,*'
42880>>>>>        End_Procedure
42881>>>>>        
42881>>>>>        
42881>>>>>        Procedure Activate
42883>>>>>            Send Keyaction to ButtonSub1
42884>>>>>            Forward Send Activate
42886>>>>>        End_procedure
42887>>>>>        
42887>>>>>        Procedure Activating
42889>>>>>            Forward Send Activating
42891>>>>>            Set Auto_Index_State to True
42892>>>>>        End_Procedure
42893>>>>>        
42893>>>>>        
42893>>>>>        
42893>>>>>        
42893>>>>>        //AB-StoreEnd
42893>>>>>
42893>>>>>    End_Object    // oSelList
42894>>>>>
42894>>>>>    Object cSyDateForm1 is a cSyDateForm
42896>>>>>        Set Size to 13 85
42897>>>>>        Set Location to 222 54
42898>>>>>        Set Label_Col_Offset to 2
42899>>>>>        Set Label_Justification_Mode to jMode_Right
42900>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
42901>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42902>>>>>
42902>>>>>        //AB-StoreStart
42902>>>>>                                                                                                        
42902>>>>>        Procedure Key Integer iKey
42904>>>>>            Integer iRetVal
42905>>>>>            Forward Send Key iKey
42907>>>>>            If (iKey=277) Begin
42909>>>>>                Send Clear_Me
42910>>>>>            End
42910>>>>>>
42910>>>>>        End_Procedure
42911>>>>>        
42911>>>>>        Procedure Clear_Me
42913>>>>>            Set Value Item 0 to ''
42914>>>>>            Send KeyAction to ButtonSub1
42915>>>>>        End_Procedure
42916>>>>>        
42916>>>>>        Procedure Exiting00000
42918>>>>>            Forward Send Exiting
42920>>>>>            Send KeyAction to ButtonSub1
42921>>>>>        End_procedure
42922>>>>>        
42922>>>>>        
42922>>>>>        
42922>>>>>        //AB-StoreEnd
42922>>>>>
42922>>>>>    End_Object    // cSyDateForm1
42923>>>>>
42923>>>>>    Object FormSub1 is a FormSub
42925>>>>>        Set Size to 13 85
42926>>>>>        Set Location to 236 54
42927>>>>>        Set Label_Col_Offset to 2
42928>>>>>        Set Prompt_Button_Mode to pb_PromptOn
42929>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42930>>>>>
42930>>>>>        //AB-StoreStart
42930>>>>>                                                                                                
42930>>>>>        Set Prompt_Object to (sl012(Self))
42931>>>>>        
42931>>>>>        Procedure Prompt
42933>>>>>            String sModule
42934>>>>>            Get psModule Of (sl012(Self)) to sModule
42935>>>>>            Set psModule Of (sl012(Self)) to (psModule(Self))
42936>>>>>            Forward Send Prompt
42938>>>>>            Set psModule Of (sl012(Self)) to sModule
42939>>>>>        End_Procedure
42940>>>>>        
42940>>>>>        Procedure OnChange
42942>>>>>            String s1
42943>>>>>            Get Value Item 0 to s1
42944>>>>>            Set Value Of FormSub3 Item 0 to (fsPtyppar(Self,s1))
42945>>>>>            Clear Ptypparl
42946>>>>>            Move Syscurxr.Company_Code  to ptypparl.Company_Code
42947>>>>>            Move Syscurxr.Branch_Code   to ptypparl.Branch_Code
42948>>>>>            Move s1                     to Ptypparl.Ptyppar_Code
42949>>>>>            Find Eq Ptypparl by index.1
42950>>>>>>
42950>>>>>            Set psPtyppar       to s1
42951>>>>>            Set psPtypparRecr   to Ptypparl.Ptyppar_Recr
42952>>>>>            Set psWtypkin       to PtypparL.Wtypkin_Code
42953>>>>>            Set psCtypkin       to PtypparL.Ctypkin_Code
42954>>>>>        End_Procedure
42955>>>>>        
42955>>>>>        
42955>>>>>        
42955>>>>>        
42955>>>>>        
42955>>>>>        
42955>>>>>        
42955>>>>>        //AB-StoreEnd
42955>>>>>
42955>>>>>    End_Object    // FormSub1
42956>>>>>
42956>>>>>    Object FormSub3 is a FormSub
42958>>>>>        Set Size to 13 195
42959>>>>>        Set Location to 236 145
42960>>>>>        Set Color to 12363657
42961>>>>>        Set Label_Col_Offset to 2
42962>>>>>        Set Enabled_State to FALSE
42963>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42964>>>>>        Set Item_Shadow_State Item 0 to TRUE
42965>>>>>        Set Shadow_State Item 0 to TRUE
42966>>>>>    End_Object    // FormSub3
42967>>>>>
42967>>>>>    Object FormSub2 is a FormSub
42969>>>>>        Set Size to 13 85
42970>>>>>        Set Location to 250 54
42971>>>>>        Set Label_Col_Offset to 2
42972>>>>>        Set Prompt_Button_Mode to pb_PromptOn
42973>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42974>>>>>
42974>>>>>        //AB-StoreStart
42974>>>>>                                                                                                
42974>>>>>        Set Prompt_Object to (sl100(Self))
42975>>>>>        
42975>>>>>        Procedure Prompt
42977>>>>>            String sModule
42978>>>>>            Get psModule Of (sl100(Self)) to sModule
42979>>>>>            Set psModule Of (sl100(Self)) to (psModule(Self))
42980>>>>>            Forward Send Prompt
42982>>>>>            Set psModule Of (sl100(Self)) to sModule
42983>>>>>        End_Procedure
42984>>>>>        
42984>>>>>        Procedure OnChange
42986>>>>>            String s1
42987>>>>>            Get Value Item 0 to s1
42988>>>>>            Set Value Of FormSub4 Item 0 to (fsClient(Self,s1))
42989>>>>>            Set psClient to s1
42990>>>>>        End_Procedure
42991>>>>>        
42991>>>>>        
42991>>>>>        
42991>>>>>        
42991>>>>>        
42991>>>>>        
42991>>>>>        
42991>>>>>        //AB-StoreEnd
42991>>>>>
42991>>>>>    End_Object    // FormSub2
42992>>>>>
42992>>>>>    Object FormSub4 is a FormSub
42994>>>>>        Set Size to 13 195
42995>>>>>        Set Location to 250 145
42996>>>>>        Set Color to 12363657
42997>>>>>        Set Label_Col_Offset to 2
42998>>>>>        Set Enabled_State to FALSE
42999>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43000>>>>>        Set Item_Shadow_State Item 0 to TRUE
43001>>>>>        Set Shadow_State Item 0 to TRUE
43002>>>>>    End_Object    // FormSub4
43003>>>>>
43003>>>>>    Object FormSub5 is a FormSub
43005>>>>>        Set Size to 13 85
43006>>>>>        Set Location to 263 54
43007>>>>>        Set Label_Col_Offset to 2
43008>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43009>>>>>
43009>>>>>        //AB-StoreStart
43009>>>>>        Procedure OnChange
43011>>>>>            integer ino
43012>>>>>            Get Value Item 0 to ino
43013>>>>>            Set pino to ino
43014>>>>>        End_Procedure
43015>>>>>        
43015>>>>>        
43015>>>>>        
43015>>>>>        
43015>>>>>        
43015>>>>>        
43015>>>>>        
43015>>>>>        
43015>>>>>        
43015>>>>>        
43015>>>>>        
43015>>>>>        //AB-StoreEnd
43015>>>>>
43015>>>>>    End_Object    // FormSub5
43016>>>>>
43016>>>>>    Object TextBoxSub1 is a TextBoxSub
43018>>>>>        Set Label to "†£œ¨/¤å˜"
43019>>>>>        Set Color to 12363657
43020>>>>>        Set Location to 222 5
43021>>>>>        Set Size to 10 35
43022>>>>>        Set TypeFace to "MS Sans Serif"
43023>>>>>    End_Object    // TextBoxSub1
43024>>>>>
43024>>>>>    Object TextBoxSub2 is a TextBoxSub
43026>>>>>        Set Label to "˜¨˜©«/¡æ"
43027>>>>>        Set Color to 12363657
43028>>>>>        Set Location to 237 4
43029>>>>>        Set Size to 10 41
43030>>>>>        Set TypeFace to "MS Sans Serif"
43031>>>>>    End_Object    // TextBoxSub2
43032>>>>>
43032>>>>>    Object TextBoxSub3 is a TextBoxSub
43034>>>>>        Set Label to "”¦¨â˜ª"
43035>>>>>        Set Color to 12363657
43036>>>>>        Set Location to 252 4
43037>>>>>        Set Size to 10 31
43038>>>>>        Set TypeFace to "MS Sans Serif"
43039>>>>>    End_Object    // TextBoxSub3
43040>>>>>
43040>>>>>    Object ButtonSub1 is a ButtonSub
43042>>>>>        Set Label to "œ¨ æ¨ ©œ"
43043>>>>>        Set Size to 13 50
43044>>>>>        Set Location to 252 355
43045>>>>>        Set Form_FontWeight Item 0 to 600
43046>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43047>>>>>
43047>>>>>        //AB-StoreStart
43047>>>>>                
43047>>>>>        Procedure OnClick
43049>>>>>            Send Rebuild_Constraints to Particle_DD
43050>>>>>            Send Beginning_Of_Data to oSelList True
43051>>>>>        End_Procedure // OnClick
43052>>>>>        
43052>>>>>        
43052>>>>>        
43052>>>>>        
43052>>>>>        
43052>>>>>        //AB-StoreEnd
43052>>>>>
43052>>>>>    End_Object    // ButtonSub1
43053>>>>>
43053>>>>>    Object oOk_bn is a ButtonSub
43055>>>>>
43055>>>>>        //AB-StoreTopStart
43055>>>>>                
43055>>>>>        //AB-StoreTopEnd
43055>>>>>
43055>>>>>        Set Label to "&„§ ¢¦šã"
43056>>>>>        Set Location to 252 412
43057>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43058>>>>>
43058>>>>>        //AB-StoreStart
43058>>>>>                
43058>>>>>        Procedure OnClick
43060>>>>>            Send OK To (oSelList(current_object))
43061>>>>>        End_Procedure
43062>>>>>        
43062>>>>>        //AB-StoreEnd
43062>>>>>
43062>>>>>    End_Object    // oOk_bn
43063>>>>>
43063>>>>>    Object oSearch_bn is a ButtonSub
43065>>>>>        Set Label to "€&¤˜ã«ž©ž"
43066>>>>>        Set Size to 13 50
43067>>>>>        Set Location to 252 466
43068>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43069>>>>>
43069>>>>>        //AB-StoreStart
43069>>>>>        Procedure OnClick
43071>>>>>            Send Search To (oSelList(current_object))
43072>>>>>        End_Procedure
43073>>>>>        //AB-StoreEnd
43073>>>>>
43073>>>>>    End_Object    // oSearch_bn
43074>>>>>
43074>>>>>    Object TextBoxSub4 is a TextBoxSub
43076>>>>>        Set Label to "€¨ Ÿ£æª"
43077>>>>>        Set Color to 12363657
43078>>>>>        Set Location to 265 4
43079>>>>>        Set Size to 10 31
43080>>>>>        Set TypeFace to "MS Sans Serif"
43081>>>>>    End_Object    // TextBoxSub4
43082>>>>>
43082>>>>>
43082>>>>>    //AB-StoreStart
43082>>>>>                                
43082>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
43083>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
43084>>>>>    
43084>>>>>    Set Locate_Mode to Center_On_Screen
43085>>>>>    Set Modal_State to True
43086>>>>>    
43086>>>>>    Procedure Request_Cancel
43088>>>>>        Set Value Of cSyDateForm1 Item 0 to ''
43089>>>>>        Send Clear to Particle_DD
43090>>>>>        Forward Send Request_Cancel
43092>>>>>    End_Procedure
43093>>>>>    
43093>>>>>    
43093>>>>>    
43093>>>>>    
43093>>>>>    
43093>>>>>    
43093>>>>>    
43093>>>>>    
43093>>>>>    
43093>>>>>    
43093>>>>>    
43093>>>>>    
43093>>>>>    
43093>>>>>    
43093>>>>>    
43093>>>>>    
43093>>>>>    
43093>>>>>    
43093>>>>>    
43093>>>>>    
43093>>>>>    //AB-StoreEnd
43093>>>>>
43093>>>>>End_Object    // sl014
43094>>>>>
43094>>>>>
43094>>>>>//AB-StoreStart
43094>>>>>            
43094>>>>>            
43094>>>>>//AB-StoreEnd
43094>>>>>
43094>>>>>//AB/ End_Object    // prj
43094>>>Use sl022.sl
43094>>>Use sl023.sl
43094>>>Use sl024.sl
INCLUDING FILE: SL024.SL
43094>>>>>//AB/ Project sl024:kathgories eidon
43094>>>>>//AB/ Object prj is a Lookup_Project
43094>>>>>//AB/     Set ProjectName to "sl024:kathgories eidon"
43094>>>>>//AB/     Set ProjectFileName to "sl024.SL"
43094>>>>>
43094>>>>>// Project Object Structure
43094>>>>>//   sl024 is a dbModalPanelSub
43094>>>>>//     Witemkat_DD is a DataDictionary
43094>>>>>//     oSelList is a dbListSub
43094>>>>>//     oOK_bn is a ButtonSub
43094>>>>>//     oCancel_bn is a ButtonSub
43094>>>>>//     oSearch_bn is a ButtonSub
43094>>>>>
43094>>>>>// Register all objects
43094>>>>>Register_Object oCancel_bn
43094>>>>>Register_Object oOK_bn
43094>>>>>Register_Object oSearch_bn
43094>>>>>Register_Object oSelList
43094>>>>>Register_Object sl024
43094>>>>>Register_Object Witemkat_DD
43094>>>>>
43094>>>>>
43094>>>>>//AB-IgnoreStart
43094>>>>>
43094>>>>>Use DFAllEnt.pkg
43094>>>>>Use dbList.Sub
43094>>>>>Use Button.Sub
43094>>>>>
43094>>>>>
43094>>>>>Use WITEMKAT.DD
INCLUDING FILE: WITEMKAT.DD
43094>>>>>>>//DDB-FileStart
43094>>>>>>>//DDB-HeaderStart
43094>>>>>>>
43094>>>>>>>// File Name : WITEMKAT.DD
43094>>>>>>>// Class Name: Witemkat_DataDictionary
43094>>>>>>>// Revision  : 26
43094>>>>>>>
43094>>>>>>>Use  Windows           // Basic Definitions
43094>>>>>>>Use  DataDict          // DataDictionary Class Definition
43094>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43094>>>>>>>
43094>>>>>>>Open Witemkat
43096>>>>>>>Open Item
INCLUDING FILE: ITEM.FD
43098>>>>>>>Open Sysrecw
43100>>>>>>>Open Syscurxr
43102>>>>>>>
43102>>>>>>>//DDB-HeaderEnd
43102>>>>>>>//DDB-SelectionStart
43102>>>>>>>//DDB/ ExternalSelectionList sl024  sl024.SL
43102>>>>>>>Register_Object sl024
43102>>>>>>>//DDB-SelectionEnd
43102>>>>>>>
43102>>>>>>>Class Witemkat_DataDictionary  is a DataDictionary
43103>>>>>>>
43103>>>>>>>     Procedure Creating
43104>>>>>>>        Forward Send Creating
43106>>>>>>>        // Insert Code Here
43106>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(WitemKat.WitemKat_Rec0)))))) to WitemKat.WitemKat_Recr
43107>>>>>>>    End_Procedure   // Creating
43108>>>>>>>   
43108>>>>>>>    Function Validate_Save  Returns Integer
43109>>>>>>>        Local Integer iReturnVal icheck
43110>>>>>>>        Forward Get Validate_Save  To iReturnVal
43112>>>>>>>        If (Not(iReturnVal)) Begin
43114>>>>>>>            // Insert Code Here
43114>>>>>>>//           if (witemkat.codegl <> '') begin
43114>>>>>>>//              Move (Check_log(witemkat.codegl)) to iCheck  
43114>>>>>>>//              if (icheck) Move 24001 to iReturnVal 
43114>>>>>>>//           end
43114>>>>>>>           If (iReturnVal) Send Operation_Not_Allowed iReturnVal
43117>>>>>>>        End
43117>>>>>>>>
43117>>>>>>>        Function_Return iReturnVal
43118>>>>>>>    End_Function   // Validate_Save
43119>>>>>>> 
43119>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
43120>>>>>>>        String lsError_Message
43121>>>>>>>        Case Begin
43121>>>>>>>            Case (iError_Num = 24001)
43123>>>>>>>                Move "DDC 24: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ¡˜«žš¦¨å˜ª œå›¦¬ª" to lsError_Message
43124>>>>>>>              Case Break
43125>>>>>>>            Case Else
43125>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
43127>>>>>>>        Case End
43127>>>>>>>        Error iError_Num lsError_Message
43128>>>>>>>>
43128>>>>>>>    End_Procedure // operation_not_allowed
43129>>>>>>>
43129>>>>>>>
43129>>>>>>>
43129>>>>>>>    // Define_Fields:
43129>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43129>>>>>>>
43129>>>>>>>    Procedure Define_Fields
43130>>>>>>>        Forward Send Define_Fields
43132>>>>>>>        //DDB-Generated-Code-Location
43132>>>>>>>        //DDB-DefineFieldStart
43132>>>>>>>
43132>>>>>>>        Set Main_File            To Witemkat.File_Number
43133>>>>>>>        Set Cascade_Delete_State To FALSE
43134>>>>>>>
43134>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
43135>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
43136>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43137>>>>>>>
43137>>>>>>>        // Child (Client) file structure................
43137>>>>>>>        Send Add_Client_File  Item.File_Number
43138>>>>>>>
43138>>>>>>>        // External (System) file structure.............
43138>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
43139>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
43140>>>>>>>
43140>>>>>>>        Define_Auto_Increment  Sysrecw.Witemkat_Rec0  To Witemkat.Witemkat_Rec0
43143>>>>>>>
43143>>>>>>>        // Field-based properties.......................
43143>>>>>>>
43143>>>>>>>        // Witemkat.Witemkat_Code  
43143>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Code   To DD_AUTOFIND   
43144>>>>>>>        Set Field_Prompt_Object    Field Witemkat.Witemkat_Code   To (sl024(Self))
43145>>>>>>>
43145>>>>>>>        // Witemkat.Witemkat_Rec0  
43145>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Rec0   To DD_AUTOFIND   
43146>>>>>>>
43146>>>>>>>        // Witemkat.Witemkat_Descr 
43146>>>>>>>        Set Field_Prompt_Object    Field Witemkat.Witemkat_Descr  To (sl024(Self))
43147>>>>>>>
43147>>>>>>>        // Witemkat.Witemkat_Recr  
43147>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Recr   To DD_AUTOFIND   
43148>>>>>>>
43148>>>>>>>        // Witemkat.Codeglpol      
43148>>>>>>>
43148>>>>>>>        // Witemkat.Codeglago      
43148>>>>>>>
43148>>>>>>>        //DDB-DefineFieldEnd
43148>>>>>>>    End_Procedure    // Define_Fields
43149>>>>>>>
43149>>>>>>>    // Field_Defaults:
43149>>>>>>>    // This procedure is used to establish default field values.
43149>>>>>>>
43149>>>>>>>    Procedure Field_Defaults
43150>>>>>>>        Forward Send Field_Defaults
43152>>>>>>>        //DDB-Generated-Code-Location
43152>>>>>>>        //DDB-FieldDefaultStart
43152>>>>>>>        //DDB-FieldDefaultEnd
43152>>>>>>>    End_Procedure    // Field_Defaults
43153>>>>>>>
43153>>>>>>>End_Class    // Witemkat_DataDictionary
43154>>>>>>>//DDB-Selection-pkg-Start
43154>>>>>>>Use sl024.SL         // sl024
43154>>>>>>>//DDB-Selection-pkg-End
43154>>>>>>>//DDB-FileEnd
43154>>>>>
43154>>>>>//AB-IgnoreEnd
43154>>>>>
43154>>>>>Object sl024 is a dbModalPanelSub
43156>>>>>    Set Label to "‰˜«žš¦¨åœª „ ›é¤"
43157>>>>>    Set Size to 217 375
43158>>>>>    Set Location to 4 5
43159>>>>>    Set Exit_Application_Local_State to FALSE
43160>>>>>    Set Modal_State to FALSE
43161>>>>>
43161>>>>>    //AB-DDOStart
43161>>>>>
43161>>>>>    Object Witemkat_DD is a Witemkat_DataDictionary
43163>>>>>    End_Object    // Witemkat_DD
43164>>>>>
43164>>>>>    Set Main_DD to (Witemkat_DD(self))
43165>>>>>    Set Server to (Witemkat_DD(self))
43166>>>>>
43166>>>>>    //AB-DDOEnd
43166>>>>>
43166>>>>>    Object oSelList is a dbListSub
43168>>>>>        Set Main_File to Witemkat.File_Number
43169>>>>>        Set Size to 175 357
43170>>>>>        Set Location to 6 6
43171>>>>>
43171>>>>>        Begin_Row
43174>>>>>            Entry_Item Witemkat.Witemkat_code
43175>>>>>            Entry_Item Witemkat.Witemkat_descr
43176>>>>>        End_Row
43181>>>>>
43181>>>>>        Set Form_Width    item 0 to 124
43182>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
43183>>>>>        
43183>>>>>        Set Form_Width    item 1 to 223
43184>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
43185>>>>>        
43185>>>>>    End_Object    // oSelList
43186>>>>>
43186>>>>>    Object oOK_bn is a ButtonSub
43188>>>>>        Set Label to "&„§ ¢¦šã"
43189>>>>>        Set Location to 186 210
43190>>>>>
43190>>>>>        //AB-StoreStart
43190>>>>>        Procedure OnClick
43192>>>>>            Send OK To (oSelList(current_object))
43193>>>>>        End_Procedure
43194>>>>>        //AB-StoreEnd
43194>>>>>
43194>>>>>    End_Object    // oOK_bn
43195>>>>>
43195>>>>>    Object oCancel_bn is a ButtonSub
43197>>>>>        Set Label to "&€¡ç¨à©ž"
43198>>>>>        Set Location to 186 265
43199>>>>>
43199>>>>>        //AB-StoreStart
43199>>>>>        Procedure OnClick
43201>>>>>            Send Cancel To (oSelList(current_object))
43202>>>>>        End_Procedure
43203>>>>>        //AB-StoreEnd
43203>>>>>
43203>>>>>    End_Object    // oCancel_bn
43204>>>>>
43204>>>>>    Object oSearch_bn is a ButtonSub
43206>>>>>        Set Label to "€&¤˜ã«ž©ž"
43207>>>>>        Set Location to 186 320
43208>>>>>
43208>>>>>        //AB-StoreStart
43208>>>>>        Procedure OnClick
43210>>>>>            Send Search To (oSelList(current_object))
43211>>>>>        End_Procedure
43212>>>>>        //AB-StoreEnd
43212>>>>>
43212>>>>>    End_Object    // oSearch_bn
43213>>>>>
43213>>>>>
43213>>>>>    //AB-StoreStart
43213>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
43214>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
43215>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
43216>>>>>    //AB-StoreEnd
43216>>>>>
43216>>>>>End_Object    // sl024
43217>>>>>
43217>>>>>//AB/ End_Object    // prj
43217>>>Use sl025.sl
INCLUDING FILE: SL025.SL
43217>>>>>//AB/ Project sl025
43217>>>>>//AB/ Object prj is a Lookup_Project
43217>>>>>//AB/     Set ProjectName to "sl025"
43217>>>>>//AB/     Set ProjectFileName to "sl025.SL"
43217>>>>>//AB/     Set GenerateFileName to "NONAME"
43217>>>>>
43217>>>>>// Project Object Structure
43217>>>>>//   sl025 is a dbModalPanelSub
43217>>>>>//     Units_DD is a DataDictionary
43217>>>>>//     oSelList is a dbListSub
43217>>>>>//     oOK_bn is a ButtonSub
43217>>>>>//     oCancel_bn is a ButtonSub
43217>>>>>//     oSearch_bn is a ButtonSub
43217>>>>>
43217>>>>>// Register all objects
43217>>>>>Register_Object oCancel_bn
43217>>>>>Register_Object oOK_bn
43217>>>>>Register_Object oSearch_bn
43217>>>>>Register_Object oSelList
43217>>>>>Register_Object sl025
43217>>>>>Register_Object Units_DD
43217>>>>>
43217>>>>>
43217>>>>>//AB-IgnoreStart
43217>>>>>
43217>>>>>Use DFAllEnt.pkg
43217>>>>>Use dbList.Sub
43217>>>>>Use Button.Sub
43217>>>>>
43217>>>>>
43217>>>>>Use UNITS.DD
INCLUDING FILE: UNITS.DD
43217>>>>>>>//DDB-FileStart
43217>>>>>>>//DDB-HeaderStart
43217>>>>>>>
43217>>>>>>>// File Name : UNITS.DD
43217>>>>>>>// Class Name: Units_DataDictionary
43217>>>>>>>// Revision  : 17
43217>>>>>>>// Version   : 2
43217>>>>>>>
43217>>>>>>>Use  Windows           // Basic Definitions
43217>>>>>>>Use  DataDict          // DataDictionary Class Definition
43217>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43217>>>>>>>
43217>>>>>>>Open Units
43219>>>>>>>Open Item
43221>>>>>>>Open Sysrecw
43223>>>>>>>Open Syscurxr
43225>>>>>>>
43225>>>>>>>//DDB-HeaderEnd
43225>>>>>>>//DDB-SelectionStart
43225>>>>>>>//DDB/ ExternalSelectionList sl025  sl025.SL
43225>>>>>>>Register_Object sl025
43225>>>>>>>//DDB-SelectionEnd
43225>>>>>>>
43225>>>>>>>Class Units_DataDictionary  is a DataDictionary
43226>>>>>>>
43226>>>>>>>    Procedure Save_Main_File
43227>>>>>>>        If (Operation_Origin<>Self) Begin
43229>>>>>>>            If Units.Recnum Eq 0 Procedure_Return
43232>>>>>>>        End
43232>>>>>>>>
43232>>>>>>>        Forward Send Save_Main_File
43234>>>>>>>    End_Procedure
43235>>>>>>>
43235>>>>>>>
43235>>>>>>>     Procedure Creating
43236>>>>>>>        Forward Send Creating
43238>>>>>>>        // Insert Code Here
43238>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Units.Units_Rec0)))))) to Units.Units_Recr
43239>>>>>>>    End_Procedure   // Creating
43240>>>>>>>
43240>>>>>>>
43240>>>>>>>
43240>>>>>>>    // Define_Fields:
43240>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43240>>>>>>>
43240>>>>>>>    Procedure Define_Fields
43241>>>>>>>        Forward Send Define_Fields
43243>>>>>>>        //DDB-Generated-Code-Location
43243>>>>>>>        //DDB-DefineFieldStart
43243>>>>>>>
43243>>>>>>>        Set Main_File            To Units.File_Number
43244>>>>>>>        Set Cascade_Delete_State To FALSE
43245>>>>>>>
43245>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
43246>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
43247>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43248>>>>>>>
43248>>>>>>>        // Child (Client) file structure................
43248>>>>>>>        Send Add_Client_File  Item.File_Number
43249>>>>>>>
43249>>>>>>>        // External (System) file structure.............
43249>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
43250>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
43251>>>>>>>
43251>>>>>>>        Define_Auto_Increment  Sysrecw.Units_Rec0  To Units.Units_Rec0
43254>>>>>>>
43254>>>>>>>        // Field-based properties.......................
43254>>>>>>>
43254>>>>>>>        // Units.Units_Code
43254>>>>>>>        Set Field_Options          Field Units.Units_Code To DD_AUTOFIND   
43255>>>>>>>        Set Field_Prompt_Object    Field Units.Units_Code To (sl025(Self))
43256>>>>>>>
43256>>>>>>>        // Units.Units_Rec0
43256>>>>>>>        Set Field_Options          Field Units.Units_Rec0 To DD_AUTOFIND   
43257>>>>>>>
43257>>>>>>>        // Units.Units_Descr
43257>>>>>>>        Set Field_Prompt_Object    Field Units.Units_Descr To (sl025(Self))
43258>>>>>>>
43258>>>>>>>        // Units.Units_Recr
43258>>>>>>>        Set Field_Options          Field Units.Units_Recr To DD_AUTOFIND   
43259>>>>>>>
43259>>>>>>>        //DDB-DefineFieldEnd
43259>>>>>>>    End_Procedure    // Define_Fields
43260>>>>>>>
43260>>>>>>>    // Field_Defaults:
43260>>>>>>>    // This procedure is used to establish default field values.
43260>>>>>>>
43260>>>>>>>    Procedure Field_Defaults
43261>>>>>>>        Forward Send Field_Defaults
43263>>>>>>>        //DDB-Generated-Code-Location
43263>>>>>>>        //DDB-FieldDefaultStart
43263>>>>>>>        //DDB-FieldDefaultEnd
43263>>>>>>>    End_Procedure    // Field_Defaults
43264>>>>>>>
43264>>>>>>>End_Class    // Units_DataDictionary
43265>>>>>>>//DDB-Selection-pkg-Start
43265>>>>>>>
43265>>>>>>>Use sl025.SL         // sl025
43265>>>>>>>
43265>>>>>>>//DDB-Selection-pkg-End
43265>>>>>>>//DDB-FileEnd
43265>>>>>
43265>>>>>//AB-IgnoreEnd
43265>>>>>
43265>>>>>Object sl025 is a dbModalPanelSub
43267>>>>>    set label to "‹¦¤á›œª ‹â«¨ž©žª" 
43268>>>>>    Set Size to 148 297
43269>>>>>    Set Location to 4 5
43270>>>>>    Set Exit_Application_Local_State to FALSE
43271>>>>>    Set Modal_State to FALSE
43272>>>>>
43272>>>>>    //AB-DDOStart
43272>>>>>
43272>>>>>    Object Units_DD is a Units_DataDictionary
43274>>>>>    End_Object    // Units_DD
43275>>>>>
43275>>>>>    Set Main_DD to (Units_DD(self))
43276>>>>>    Set Server to (Units_DD(self))
43277>>>>>
43277>>>>>    //AB-DDOEnd
43277>>>>>
43277>>>>>    Object oSelList is a dbListSub
43279>>>>>        set main_file to units.file_number 
43280>>>>>        Set Size to 105 280
43281>>>>>        Set Location to 6 6
43282>>>>>
43282>>>>>        Begin_Row
43285>>>>>            entry_item units.units_code 
43286>>>>>            entry_item units.units_descr 
43287>>>>>        End_Row
43292>>>>>
43292>>>>>        Set Form_Width    item 0 to 91
43293>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
43294>>>>>        
43294>>>>>        Set Form_Width    item 1 to 180
43295>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
43296>>>>>        
43296>>>>>    End_Object    // oSelList
43297>>>>>
43297>>>>>    Object oOK_bn is a ButtonSub
43299>>>>>        set label to "&„§ ¢¦šã" 
43300>>>>>        Set Location to 115 126
43301>>>>>
43301>>>>>        //AB-StoreStart
43301>>>>>        Procedure OnClick
43303>>>>>            Send OK To (oSelList(current_object))
43304>>>>>        End_Procedure
43305>>>>>        //AB-StoreEnd
43305>>>>>
43305>>>>>    End_Object    // oOK_bn
43306>>>>>
43306>>>>>    Object oCancel_bn is a ButtonSub
43308>>>>>        set label to "&€¡ç¨à©ž" 
43309>>>>>        Set Location to 115 181
43310>>>>>
43310>>>>>        //AB-StoreStart
43310>>>>>        Procedure OnClick
43312>>>>>            Send Cancel To (oSelList(current_object))
43313>>>>>        End_Procedure
43314>>>>>        //AB-StoreEnd
43314>>>>>
43314>>>>>    End_Object    // oCancel_bn
43315>>>>>
43315>>>>>    Object oSearch_bn is a ButtonSub
43317>>>>>        set label to "€&¤˜ã«ž©ž" 
43318>>>>>        Set Location to 115 236
43319>>>>>
43319>>>>>        //AB-StoreStart
43319>>>>>        Procedure OnClick
43321>>>>>            Send Search To (oSelList(current_object))
43322>>>>>        End_Procedure
43323>>>>>        //AB-StoreEnd
43323>>>>>
43323>>>>>    End_Object    // oSearch_bn
43324>>>>>
43324>>>>>
43324>>>>>    //AB-StoreStart
43324>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
43325>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
43326>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
43327>>>>>    //AB-StoreEnd
43327>>>>>
43327>>>>>End_Object    // sl025
43328>>>>>
43328>>>>>//AB/ End_Object    // prj
43328>>>Use sl026.sl
INCLUDING FILE: SL026.SL
43328>>>>>//AB/ Project sl026:Item
43328>>>>>//AB/     Object prj is a Lookup_Project
43328>>>>>//AB/         Set ProjectName to "sl026:Item"
43328>>>>>//AB/         Set ProjectFileName to "sl026.SL"
43328>>>>>//AB/         Set GenerateFileName to "NONAME"
43328>>>>>
43328>>>>>// Project Object Structure
43328>>>>>//   sl026 is a dbModalPanelSub
43328>>>>>//     Witemkat_DD is a DataDictionary
43328>>>>>//     Units_DD is a DataDictionary
43328>>>>>//     Item_DD is a DataDictionary
43328>>>>>//     oSelList is a dbListSub
43328>>>>>//     oOK_bn is a ButtonSub
43328>>>>>//     oCancel_bn is a ButtonSub
43328>>>>>//     oSearch_bn is a ButtonSub
43328>>>>>
43328>>>>>// Register all objects
43328>>>>>Register_Object Item_DD
43328>>>>>Register_Object oCancel_bn
43328>>>>>Register_Object oOK_bn
43328>>>>>Register_Object oSearch_bn
43328>>>>>Register_Object oSelList
43328>>>>>Register_Object sl026
43328>>>>>Register_Object Units_DD
43328>>>>>Register_Object Witemkat_DD
43328>>>>>
43328>>>>>
43328>>>>>    //AB-IgnoreStart
43328>>>>>
43328>>>>>    Use DFAllEnt.pkg
43328>>>>>    Use dbList.Sub
43328>>>>>    Use Button.Sub
43328>>>>>
43328>>>>>
43328>>>>>    Use WITEMKAT.DD
43328>>>>>    Use UNITS.DD
43328>>>>>    Use ITEM.DD
INCLUDING FILE: ITEM.DD
43328>>>>>>>//DDB-FileStart
43328>>>>>>>//DDB-HeaderStart
43328>>>>>>>
43328>>>>>>>// File Name : ITEM.DD
43328>>>>>>>// Class Name: Item_DataDictionary
43328>>>>>>>// Revision  : 63
43328>>>>>>>// Version   : 2
43328>>>>>>>
43328>>>>>>>Use  Windows           // Basic Definitions
43328>>>>>>>Use  DataDict          // DataDictionary Class Definition
43328>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43328>>>>>>>
43328>>>>>>>Open Item
43330>>>>>>>Open Witemx
43332>>>>>>>Open Witemcl
43334>>>>>>>Open Itemtehn
INCLUDING FILE: ITEMTEHN.FD
43336>>>>>>>Open Units
43338>>>>>>>Open Witemkat
43340>>>>>>>Open Fpa
INCLUDING FILE: FPA.FD
43342>>>>>>>Open Sysrecw
43344>>>>>>>Open Witemx
43346>>>>>>>
43346>>>>>>>//DDB-HeaderEnd
43346>>>>>>>//DDB-ValidationStart
43346>>>>>>>
43346>>>>>>>Register_Object Item_Item_Qual_VT
43346>>>>>>>Register_Object Item_Item_Analysh_VT
43346>>>>>>>
43346>>>>>>>Object Item_Item_Qual_VT  is a CodeValidationTable
43348>>>>>>>    Set Type_Value        To "QUAL"
43349>>>>>>>    Set Validate_State    To FALSE
43350>>>>>>>    Set Allow_Blank_State To TRUE
43351>>>>>>>    //DDB-ValidationCustomStart
43351>>>>>>>    //DDB-ValidationCustomEnd
43351>>>>>>>End_Object   // Item_Item_Qual_VT
43352>>>>>>>
43352>>>>>>>Object Item_Item_Analysh_VT  is a CodeValidationTable
43354>>>>>>>    Set Type_Value        To "ITEMANAL"
43355>>>>>>>    Set Table_Title       To "€¤á¢¬©ž „å›¦¬ª"
43356>>>>>>>    //DDB-ValidationCustomStart
43356>>>>>>>    //DDB-ValidationCustomEnd
43356>>>>>>>End_Object   // Item_Item_Analysh_VT
43357>>>>>>>//DDB-ValidationEnd
43357>>>>>>>//DDB-SelectionStart
43357>>>>>>>//DDB/ ExternalSelectionList SL22s  sl22s.sl
43357>>>>>>>//DDB/ ExternalSelectionList sl022  sl022.SL
43357>>>>>>>Register_Object SL22s
43357>>>>>>>Register_Object sl022
43357>>>>>>>//DDB-SelectionEnd
43357>>>>>>>
43357>>>>>>>Class Item_DataDictionary  is a DataDictionary
43358>>>>>>>
43358>>>>>>>    Procedure Update
43359>>>>>>>        Forward Send Update
43361>>>>>>>        Move Witemkat.Witemkat_Code to Item.Witemkat_Code
43362>>>>>>>        Move Units.Units_Code       to Item.Units_Code
43363>>>>>>>    End_Procedure   // Update
43364>>>>>>>
43364>>>>>>>    Procedure Creating
43365>>>>>>>        Date dHmnia
43366>>>>>>>        Forward Send Creating
43368>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                         (Trim(String(Item.Item_Rec0)))))) to Item.Item_Recr
43369>>>>>>>        
43369>>>>>>>        Clear Branch
43370>>>>>>>        Move SysCurXR.Company_Code    to Branch.Company_Code
43371>>>>>>>        Find Gt Branch By Index.1 
43372>>>>>>>>
43372>>>>>>>        While ((Found=1) And (Branch.Company_Code=SysCurXR.Company_Code))
43376>>>>>>>            Clear Witemx
43377>>>>>>>            Move SysCurXR.Company_Code      to Witemx.Company_Code
43378>>>>>>>            Move Branch.Branch_Code         to Witemx.Branch_Code
43379>>>>>>>            Move SysCurXR.Year_Year         to Witemx.Year_Year
43380>>>>>>>            Move SysCurXR.Year_Year         to Witemx.Witemx_YearDesc
43381>>>>>>>            Move SysCurXR.Year_Recr         to Witemx.Year_Recr
43382>>>>>>>            Move Witemkat.Witemkat_Code     to Witemx.Witemkat_Code
43383>>>>>>>            Move Units.Units_Code           to Witemx.Units_Code
43384>>>>>>>            Move Item.Item_Code             to Witemx.Item_Code
43385>>>>>>>            Move Item.Item_Code             to Witemx.Witemx_Code
43386>>>>>>>            Move Item.Item_Descr            to Witemx.Witemx_Descr
43387>>>>>>>            Move Item.Wapokat_Code          to Witemx.ITEM_APOKAT_COD
43388>>>>>>>            Move Item.link1                 to Witemx.link1
43389>>>>>>>            Move Item.link2                 to Witemx.link2
43390>>>>>>>            Move Item.Item_Recr             to Witemx.Item_Recr
43391>>>>>>>            Move (Sysrecw.Witemx_Rec0+1)    to Witemx.Witemx_Rec0
43392>>>>>>>            Move (Sysrecw.Witemx_Rec0+1)    to Sysrecw.Witemx_Rec0
43393>>>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                           (Trim(String(Witemx.Witemx_Rec0)))))) ;                                          to Witemx.Witemx_Recr
43394>>>>>>>            Saverecord Sysrecw
43395>>>>>>>            Saverecord Witemx
43396>>>>>>>            
43396>>>>>>>            Find Gt Branch By Index.1 
43397>>>>>>>>
43397>>>>>>>        Loop
43398>>>>>>>>
43398>>>>>>>    End_Procedure   // Creating
43399>>>>>>>
43399>>>>>>>
43399>>>>>>>    // Define_Fields:
43399>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43399>>>>>>>
43399>>>>>>>    Procedure Define_Fields
43400>>>>>>>        Forward Send Define_Fields
43402>>>>>>>        //DDB-Generated-Code-Location
43402>>>>>>>        //DDB-DefineFieldStart
43402>>>>>>>
43402>>>>>>>        Set Main_File            To Item.File_Number
43403>>>>>>>        Set Cascade_Delete_State To FALSE
43404>>>>>>>
43404>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
43405>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
43406>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43407>>>>>>>
43407>>>>>>>        // Child (Client) file structure................
43407>>>>>>>        Send Add_Client_File  Witemx.File_Number
43408>>>>>>>        Send Add_Client_File  Witemcl.File_Number
43409>>>>>>>        Send Add_Client_File  Itemtehn.File_Number
43410>>>>>>>
43410>>>>>>>        // Parent (Server) file structure...............
43410>>>>>>>        Send Add_Server_File  Units.File_Number
43411>>>>>>>        Send Add_Server_File  Witemkat.File_Number
43412>>>>>>>        Send Add_Server_File  Fpa.File_Number
43413>>>>>>>
43413>>>>>>>        // External (System) file structure.............
43413>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
43414>>>>>>>        Send Add_System_File  Witemx.File_Number  DD_LOCK_ON_ALL
43415>>>>>>>
43415>>>>>>>        Define_Auto_Increment  Sysrecw.Item_Rec0  To Item.Item_Rec0
43418>>>>>>>
43418>>>>>>>        // Field-based properties.......................
43418>>>>>>>
43418>>>>>>>        // Item.Units_Code
43418>>>>>>>
43418>>>>>>>        // Item.Units_Recr
43418>>>>>>>
43418>>>>>>>        // Item.Witemkat_Code
43418>>>>>>>
43418>>>>>>>        // Item.Witemkat_Recr
43418>>>>>>>
43418>>>>>>>        // Item.Item_Code
43418>>>>>>>        Set Field_Options          Field Item.Item_Code To DD_AUTOFIND   
43419>>>>>>>        Set Field_Prompt_Object    Field Item.Item_Code To (SL22s(Self))
43420>>>>>>>        Set Key_Field_State        Field Item.Item_Code To TRUE
43421>>>>>>>
43421>>>>>>>        // Item.Item_Rec0
43421>>>>>>>        Set Field_Options          Field Item.Item_Rec0 To DD_AUTOFIND   
43422>>>>>>>
43422>>>>>>>        // Item.Item_Descr
43422>>>>>>>        Set Field_Prompt_Object    Field Item.Item_Descr To (SL22s(Self))
43423>>>>>>>
43423>>>>>>>        // Item.Item_Recr
43423>>>>>>>        Set Field_Options          Field Item.Item_Recr To DD_AUTOFIND   
43424>>>>>>>
43424>>>>>>>        // Item.Fpa_Pososto
43424>>>>>>>        Set Key_Field_State        Field Item.Fpa_Pososto To TRUE
43425>>>>>>>
43425>>>>>>>        // Item.Item_Qual
43425>>>>>>>        Set Field_Value_Table      Field Item.Item_Qual To (Item_Item_Qual_VT(Self))
43426>>>>>>>
43426>>>>>>>        // Item.Wapokat_Code
43426>>>>>>>        Set Field_Prompt_Object    Field Item.Wapokat_Code To (sl022(Self))
43427>>>>>>>
43427>>>>>>>        // Item.Item_Analysh
43427>>>>>>>        Set Field_Class_Name       Field Item.Item_Analysh To "dbComboFormsub"
43428>>>>>>>        Set Field_Value_Table      Field Item.Item_Analysh To (Item_Item_Analysh_VT(Self))
43429>>>>>>>
43429>>>>>>>        // Item.Item_Orio
43429>>>>>>>
43429>>>>>>>        // Item.Codeglpol
43429>>>>>>>
43429>>>>>>>        // Item.Codeglago
43429>>>>>>>
43429>>>>>>>        // Item.Link1
43429>>>>>>>
43429>>>>>>>        // Item.Link2
43429>>>>>>>
43429>>>>>>>        // Item.Group
43429>>>>>>>
43429>>>>>>>        // Item.Sap
43429>>>>>>>
43429>>>>>>>        //DDB-DefineFieldEnd
43429>>>>>>>    End_Procedure    // Define_Fields
43430>>>>>>>
43430>>>>>>>    // Field_Defaults:
43430>>>>>>>    // This procedure is used to establish default field values.
43430>>>>>>>
43430>>>>>>>    Procedure Field_Defaults
43431>>>>>>>        Forward Send Field_Defaults
43433>>>>>>>        //DDB-Generated-Code-Location
43433>>>>>>>        //DDB-FieldDefaultStart
43433>>>>>>>        Set Field_Changed_Value   Field Item.Item_Analysh To "0"
43434>>>>>>>        //DDB-FieldDefaultEnd
43434>>>>>>>    End_Procedure    // Field_Defaults
43435>>>>>>>
43435>>>>>>>End_Class    // Item_DataDictionary
43436>>>>>>>//DDB-Selection-pkg-Start
43436>>>>>>>
43436>>>>>>>Use sl22s.sl         // SL22s
INCLUDING FILE: SL22S.SL
43436>>>>>>>>>//AB/ Project SL22s:ITEM
43436>>>>>>>>>//AB/ Object prj is a Lookup_Project
43436>>>>>>>>>//AB/     Set ProjectName to "SL22s:ITEM"
43436>>>>>>>>>//AB/     Set ProjectFileName to "sl22s.sl"
43436>>>>>>>>>
43436>>>>>>>>>// Project Object Structure
43436>>>>>>>>>//   SL22s is a dbModalPanel
43436>>>>>>>>>//     Witemkat_DD is a DataDictionary
43436>>>>>>>>>//     Units_DD is a DataDictionary
43436>>>>>>>>>//     Fpa_DD is a DataDictionary
43436>>>>>>>>>//     Item_DD is a DataDictionary
43436>>>>>>>>>//     oSelList is a dbListSub
43436>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
43436>>>>>>>>>//     ocode is a FormSub
43436>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
43436>>>>>>>>>//     operi is a FormSub
43436>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
43436>>>>>>>>>//       Radio1 is a RadioSub
43436>>>>>>>>>//       Radio2 is a RadioSub
43436>>>>>>>>>//     ButtonSub1 is a ButtonSub
43436>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
43436>>>>>>>>>//     ocodekat is a FormSub
43436>>>>>>>>>//     oOK_bn is a ButtonSub
43436>>>>>>>>>//     oCancel_bn is a ButtonSub
43436>>>>>>>>>//     oSearch_bn is a ButtonSub
43436>>>>>>>>>
43436>>>>>>>>>// Register all objects
43436>>>>>>>>>Register_Object ButtonSub1
43436>>>>>>>>>Register_Object Fpa_DD
43436>>>>>>>>>Register_Object Item_DD
43436>>>>>>>>>Register_Object oCancel_bn
43436>>>>>>>>>Register_Object ocode
43436>>>>>>>>>Register_Object ocodekat
43436>>>>>>>>>Register_Object oOK_bn
43436>>>>>>>>>Register_Object operi
43436>>>>>>>>>Register_Object oSearch_bn
43436>>>>>>>>>Register_Object oSelList
43436>>>>>>>>>Register_Object Radio1
43436>>>>>>>>>Register_Object Radio2
43436>>>>>>>>>Register_Object RadioGroupSub1
43436>>>>>>>>>Register_Object SL22s
43436>>>>>>>>>Register_Object TextBoxSub1
43436>>>>>>>>>Register_Object TextBoxSub2
43436>>>>>>>>>Register_Object TextBoxSub3
43436>>>>>>>>>Register_Object Units_DD
43436>>>>>>>>>Register_Object Witemkat_DD
43436>>>>>>>>>
43436>>>>>>>>>
43436>>>>>>>>>
43436>>>>>>>>>//AB-StoreTopStart
43436>>>>>>>>>                                
43436>>>>>>>>>                                
43436>>>>>>>>>//AB-StoreTopEnd
43436>>>>>>>>>
43436>>>>>>>>>//AB-IgnoreStart
43436>>>>>>>>>
43436>>>>>>>>>Use DFAllEnt.pkg
43436>>>>>>>>>Use dbList.Sub
43436>>>>>>>>>Use Txtbox.Sub
43436>>>>>>>>>Use Form.Sub
43436>>>>>>>>>Use Rgroup.Sub
43436>>>>>>>>>Use Radio.Sub
43436>>>>>>>>>Use Button.Sub
43436>>>>>>>>>
43436>>>>>>>>>
43436>>>>>>>>>Use WITEMKAT.DD
43436>>>>>>>>>Use UNITS.DD
43436>>>>>>>>>Use FPA.DD
INCLUDING FILE: FPA.DD
43436>>>>>>>>>>>//DDB-FileStart
43436>>>>>>>>>>>//DDB-HeaderStart
43436>>>>>>>>>>>
43436>>>>>>>>>>>// File Name : FPA.DD
43436>>>>>>>>>>>// Class Name: Fpa_DataDictionary
43436>>>>>>>>>>>// Revision  : 34
43436>>>>>>>>>>>// Version   : 2
43436>>>>>>>>>>>
43436>>>>>>>>>>>Use  Windows           // Basic Definitions
43436>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43436>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43436>>>>>>>>>>>
43436>>>>>>>>>>>Open Fpa
43438>>>>>>>>>>>Open Iteml
43440>>>>>>>>>>>Open Partlfpa
43442>>>>>>>>>>>Open Item
43444>>>>>>>>>>>
43444>>>>>>>>>>>//DDB-HeaderEnd
43444>>>>>>>>>>>//DDB-SelectionStart
43444>>>>>>>>>>>//DDB/ ExternalSelectionList Fpa  Fpa.SL
43444>>>>>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.SL
43444>>>>>>>>>>>Register_Object Fpa
43444>>>>>>>>>>>Register_Object sl150
43444>>>>>>>>>>>//DDB-SelectionEnd
43444>>>>>>>>>>>
43444>>>>>>>>>>>Class Fpa_DataDictionary  is a DataDictionary_Sec
43445>>>>>>>>>>> 
43445>>>>>>>>>>>    // Validate_Save:
43445>>>>>>>>>>> 
43445>>>>>>>>>>>    Function Validate_Save  Returns Integer
43446>>>>>>>>>>>        Local Integer iReturnVal icheck
43447>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
43449>>>>>>>>>>>        If (Not(iReturnVal)) Begin
43451>>>>>>>>>>>            // Insert Code Here
43451>>>>>>>>>>>         //  if (fpa.agora_codegl <> '') begin
43451>>>>>>>>>>>         //     Move (Check_log(fpa.agora_codegl)) to iCheck  
43451>>>>>>>>>>>         //     if (icheck) Move 104001 to iReturnVal 
43451>>>>>>>>>>>         //  end
43451>>>>>>>>>>>         //  if (fpa.polhsh_codegl <> '') begin
43451>>>>>>>>>>>         //     Move (Check_log(fpa.polhsh_codegl)) to iCheck  
43451>>>>>>>>>>>         //     if (icheck) Move 104002 to iReturnVal
43451>>>>>>>>>>>         //  end   
43451>>>>>>>>>>>         //  If (iReturnVal) Send Operation_Not_Allowed iReturnVal
43451>>>>>>>>>>>        End
43451>>>>>>>>>>>>
43451>>>>>>>>>>>        Function_Return iReturnVal
43452>>>>>>>>>>>    End_Function   // Validate_Save
43453>>>>>>>>>>> 
43453>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
43454>>>>>>>>>>>        String lsError_Message
43455>>>>>>>>>>>        Case Begin
43455>>>>>>>>>>>            Case (iError_Num = 104001)
43457>>>>>>>>>>>                Move "DDC 104: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ”..€ ˜š¦¨é¤" to lsError_Message
43458>>>>>>>>>>>              Case Break
43459>>>>>>>>>>>            Case (iError_Num = 104002)
43462>>>>>>>>>>>                Move "DDC 104: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ”..€ §à¢ã©œà¤" to lsError_Message
43463>>>>>>>>>>>              Case Break
43464>>>>>>>>>>>            Case Else
43464>>>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
43466>>>>>>>>>>>        Case End
43466>>>>>>>>>>>        Error iError_Num lsError_Message
43467>>>>>>>>>>>>
43467>>>>>>>>>>>    End_Procedure // operation_not_allowed
43468>>>>>>>>>>>
43468>>>>>>>>>>>    // Define_Fields:
43468>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43468>>>>>>>>>>>
43468>>>>>>>>>>>    Procedure Define_Fields
43469>>>>>>>>>>>        Forward Send Define_Fields
43471>>>>>>>>>>>        //DDB-Generated-Code-Location
43471>>>>>>>>>>>        //DDB-DefineFieldStart
43471>>>>>>>>>>>
43471>>>>>>>>>>>        Set Main_File            To Fpa.File_Number
43472>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
43473>>>>>>>>>>>
43473>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
43474>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
43475>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43476>>>>>>>>>>>
43476>>>>>>>>>>>        // Child (Client) file structure................
43476>>>>>>>>>>>        Send Add_Client_File  Iteml.File_Number
43477>>>>>>>>>>>        Send Add_Client_File  Partlfpa.File_Number
43478>>>>>>>>>>>        Send Add_Client_File  Item.File_Number
43479>>>>>>>>>>>
43479>>>>>>>>>>>        // Field-based properties.......................
43479>>>>>>>>>>>
43479>>>>>>>>>>>        // Fpa.Fpa_Pososto
43479>>>>>>>>>>>        Set Field_Options          Field Fpa.Fpa_Pososto To DD_AUTOFIND    DD_REQUIRED   
43480>>>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Fpa_Pososto To (Fpa(Self))
43481>>>>>>>>>>>        Set Key_Field_State        Field Fpa.Fpa_Pososto To TRUE
43482>>>>>>>>>>>
43482>>>>>>>>>>>        // Fpa.Fpa_Descr
43482>>>>>>>>>>>        Set Field_Options          Field Fpa.Fpa_Descr To DD_AUTOFIND   
43483>>>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Fpa_Descr To (Fpa(Self))
43484>>>>>>>>>>>
43484>>>>>>>>>>>        // Fpa.Agora_Codegl
43484>>>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Agora_Codegl To (sl150(Self))
43485>>>>>>>>>>>
43485>>>>>>>>>>>        // Fpa.Polhsh_Codegl
43485>>>>>>>>>>>
43485>>>>>>>>>>>        //DDB-DefineFieldEnd
43485>>>>>>>>>>>    End_Procedure    // Define_Fields
43486>>>>>>>>>>>
43486>>>>>>>>>>>    // Field_Defaults:
43486>>>>>>>>>>>    // This procedure is used to establish default field values.
43486>>>>>>>>>>>
43486>>>>>>>>>>>    Procedure Field_Defaults
43487>>>>>>>>>>>        Forward Send Field_Defaults
43489>>>>>>>>>>>        //DDB-Generated-Code-Location
43489>>>>>>>>>>>        //DDB-FieldDefaultStart
43489>>>>>>>>>>>        //DDB-FieldDefaultEnd
43489>>>>>>>>>>>    End_Procedure    // Field_Defaults
43490>>>>>>>>>>>
43490>>>>>>>>>>>End_Class    // Fpa_DataDictionary
43491>>>>>>>>>>>//DDB-Selection-pkg-Start
43491>>>>>>>>>>>
43491>>>>>>>>>>>Use Fpa.SL           // Fpa
INCLUDING FILE: FPA.SL
43491>>>>>>>>>>>>>//AB/ Project Fpa:Lookup
43491>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
43491>>>>>>>>>>>>>//AB/     Set ProjectName to "Fpa:Lookup"
43491>>>>>>>>>>>>>//AB/     Set ProjectFileName to "Fpa.SL"
43491>>>>>>>>>>>>>
43491>>>>>>>>>>>>>// Project Object Structure
43491>>>>>>>>>>>>>//   Fpa is a dbModalPanelSub
43491>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
43491>>>>>>>>>>>>>//     oSelList is a dbListSub
43491>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
43491>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
43491>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
43491>>>>>>>>>>>>>
43491>>>>>>>>>>>>>// Register all objects
43491>>>>>>>>>>>>>Register_Object Fpa
43491>>>>>>>>>>>>>Register_Object Fpa_DD
43491>>>>>>>>>>>>>Register_Object oCancel_bn
43491>>>>>>>>>>>>>Register_Object oOK_bn
43491>>>>>>>>>>>>>Register_Object oSearch_bn
43491>>>>>>>>>>>>>Register_Object oSelList
43491>>>>>>>>>>>>>
43491>>>>>>>>>>>>>
43491>>>>>>>>>>>>>//AB-IgnoreStart
43491>>>>>>>>>>>>>
43491>>>>>>>>>>>>>Use DFAllEnt.pkg
43491>>>>>>>>>>>>>Use dbList.Sub
43491>>>>>>>>>>>>>Use Button.Sub
43491>>>>>>>>>>>>>
43491>>>>>>>>>>>>>
43491>>>>>>>>>>>>>Use FPA.DD
43491>>>>>>>>>>>>>
43491>>>>>>>>>>>>>//AB-IgnoreEnd
43491>>>>>>>>>>>>>
43491>>>>>>>>>>>>>CD_Popup_Object Fpa is a dbModalPanelSub
43510>>>>>>>>>>>>>    set label to "¦©¦©«á ”..€." 
43511>>>>>>>>>>>>>    Set Size to 148 181
43512>>>>>>>>>>>>>    Set Location to 4 5
43513>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
43514>>>>>>>>>>>>>    Set Modal_State to FALSE
43515>>>>>>>>>>>>>
43515>>>>>>>>>>>>>    //AB-DDOStart
43515>>>>>>>>>>>>>
43515>>>>>>>>>>>>>    Object Fpa_DD is a Fpa_DataDictionary
43517>>>>>>>>>>>>>    End_Object    // Fpa_DD
43518>>>>>>>>>>>>>
43518>>>>>>>>>>>>>    Set Main_DD to (Fpa_DD(self))
43519>>>>>>>>>>>>>    Set Server to (Fpa_DD(self))
43520>>>>>>>>>>>>>
43520>>>>>>>>>>>>>    //AB-DDOEnd
43520>>>>>>>>>>>>>
43520>>>>>>>>>>>>>    Object oSelList is a dbListSub
43522>>>>>>>>>>>>>        Set Main_File to Fpa.File_Number
43523>>>>>>>>>>>>>        Set Size to 105 165
43524>>>>>>>>>>>>>        Set Location to 6 6
43525>>>>>>>>>>>>>
43525>>>>>>>>>>>>>        Begin_Row
43528>>>>>>>>>>>>>            Entry_Item Fpa.Fpa_pososto
43529>>>>>>>>>>>>>            Entry_Item Fpa.Fpa_descr
43530>>>>>>>>>>>>>        End_Row
43535>>>>>>>>>>>>>
43535>>>>>>>>>>>>>        Set Form_Width    item 0 to 66
43536>>>>>>>>>>>>>        set header_label  item 0 to "% ”€" 
43537>>>>>>>>>>>>>        
43537>>>>>>>>>>>>>        Set Form_Width    item 1 to 90
43538>>>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
43539>>>>>>>>>>>>>        
43539>>>>>>>>>>>>>    End_Object    // oSelList
43540>>>>>>>>>>>>>
43540>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
43542>>>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
43543>>>>>>>>>>>>>        Set Size to 14 46
43544>>>>>>>>>>>>>        Set Location to 113 26
43545>>>>>>>>>>>>>
43545>>>>>>>>>>>>>        //AB-StoreStart
43545>>>>>>>>>>>>>        Procedure OnClick
43547>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
43548>>>>>>>>>>>>>        End_Procedure
43549>>>>>>>>>>>>>        //AB-StoreEnd
43549>>>>>>>>>>>>>
43549>>>>>>>>>>>>>    End_Object    // oOK_bn
43550>>>>>>>>>>>>>
43550>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
43552>>>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
43553>>>>>>>>>>>>>        Set Size to 14 46
43554>>>>>>>>>>>>>        Set Location to 113 75
43555>>>>>>>>>>>>>
43555>>>>>>>>>>>>>        //AB-StoreStart
43555>>>>>>>>>>>>>        Procedure OnClick
43557>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
43558>>>>>>>>>>>>>        End_Procedure
43559>>>>>>>>>>>>>        //AB-StoreEnd
43559>>>>>>>>>>>>>
43559>>>>>>>>>>>>>    End_Object    // oCancel_bn
43560>>>>>>>>>>>>>
43560>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
43562>>>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
43563>>>>>>>>>>>>>        Set Size to 14 46
43564>>>>>>>>>>>>>        Set Location to 113 126
43565>>>>>>>>>>>>>
43565>>>>>>>>>>>>>        //AB-StoreStart
43565>>>>>>>>>>>>>        Procedure OnClick
43567>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
43568>>>>>>>>>>>>>        End_Procedure
43569>>>>>>>>>>>>>        //AB-StoreEnd
43569>>>>>>>>>>>>>
43569>>>>>>>>>>>>>    End_Object    // oSearch_bn
43570>>>>>>>>>>>>>
43570>>>>>>>>>>>>>
43570>>>>>>>>>>>>>    //AB-StoreStart
43570>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
43571>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
43572>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
43573>>>>>>>>>>>>>    //AB-StoreEnd
43573>>>>>>>>>>>>>
43573>>>>>>>>>>>>>CD_End_Object    // Fpa
43575>>>>>>>>>>>>>>
43575>>>>>>>>>>>>>
43575>>>>>>>>>>>>>//AB/ End_Object    // prj
43575>>>>>>>>>>>Use sl150.SL         // sl150
INCLUDING FILE: SL150.SL
43575>>>>>>>>>>>>>//AB/ Project sl150:GL Gplan
43575>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
43575>>>>>>>>>>>>>//AB/         Set ProjectName to "sl150:GL Gplan"
43575>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl150.SL"
43575>>>>>>>>>>>>>
43575>>>>>>>>>>>>>// Project Object Structure
43575>>>>>>>>>>>>>//   sl150 is a dbModalPanelSub
43575>>>>>>>>>>>>>//     Gplan_DD is a DataDictionary
43575>>>>>>>>>>>>>//     oSelList is a dbListSub
43575>>>>>>>>>>>>>//     oOK_bn is a Button
43575>>>>>>>>>>>>>//     oCancel_bn is a Button
43575>>>>>>>>>>>>>//     oSearch_bn is a Button
43575>>>>>>>>>>>>>
43575>>>>>>>>>>>>>// Register all objects
43575>>>>>>>>>>>>>Register_Object Gplan_DD
43575>>>>>>>>>>>>>Register_Object oCancel_bn
43575>>>>>>>>>>>>>Register_Object oOK_bn
43575>>>>>>>>>>>>>Register_Object oSearch_bn
43575>>>>>>>>>>>>>Register_Object oSelList
43575>>>>>>>>>>>>>Register_Object sl150
43575>>>>>>>>>>>>>
43575>>>>>>>>>>>>>
43575>>>>>>>>>>>>>    //AB-IgnoreStart
43575>>>>>>>>>>>>>
43575>>>>>>>>>>>>>    Use DFAllEnt.pkg
43575>>>>>>>>>>>>>    Use dbList.Sub
43575>>>>>>>>>>>>>
43575>>>>>>>>>>>>>
43575>>>>>>>>>>>>>    Use GPLAN.DD
INCLUDING FILE: GPLAN.DD
43575>>>>>>>>>>>>>>>//DDB-FileStart
43575>>>>>>>>>>>>>>>//DDB-HeaderStart
43575>>>>>>>>>>>>>>>
43575>>>>>>>>>>>>>>>// File Name : GPLAN.DD
43575>>>>>>>>>>>>>>>// Class Name: Gplan_DataDictionary
43575>>>>>>>>>>>>>>>// Revision  : 132
43575>>>>>>>>>>>>>>>// Version   : 2
43575>>>>>>>>>>>>>>>
43575>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
43575>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43575>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43575>>>>>>>>>>>>>>>
43575>>>>>>>>>>>>>>>Open Gplan
43577>>>>>>>>>>>>>>>Open Gmovea
INCLUDING FILE: GMOVEA.FD
43579>>>>>>>>>>>>>>>Open Gplanmod
INCLUDING FILE: GPLANMOD.FD
43581>>>>>>>>>>>>>>>Open Gmhnes
INCLUDING FILE: GMHNES.FD
43583>>>>>>>>>>>>>>>Open Gvatd
INCLUDING FILE: GVATD.FD
43585>>>>>>>>>>>>>>>Open Gpmoves
INCLUDING FILE: GPMOVES.FD
43587>>>>>>>>>>>>>>>Open Sysrecg
43589>>>>>>>>>>>>>>>Open Syscurgl
43591>>>>>>>>>>>>>>>
43591>>>>>>>>>>>>>>>//DDB-HeaderEnd
43591>>>>>>>>>>>>>>>//DDB-ValidationStart
43591>>>>>>>>>>>>>>>
43591>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_O_Code_VT
43591>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Yn_VT
43591>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Xpm_VT
43591>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Doy_VT
43591>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_J_Code_VT
43591>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_C_Code2_VT
43591>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_I_A_Code_VT2
43591>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Myf_Sum_VT
43591>>>>>>>>>>>>>>>
43591>>>>>>>>>>>>>>>Object Gplan_Gplan_O_Code_VT  is a CodeValidationTable
43593>>>>>>>>>>>>>>>    Set Type_Value        To "OMADA"
43594>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
43595>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43595>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43595>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_O_Code_VT
43596>>>>>>>>>>>>>>>
43596>>>>>>>>>>>>>>>Object Gplan_Gplan_Yn_VT  is a CodeValidationTable
43598>>>>>>>>>>>>>>>    Set Type_Value        To "YESNO"
43599>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43599>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43599>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Yn_VT
43600>>>>>>>>>>>>>>>
43600>>>>>>>>>>>>>>>Object Gplan_Gplan_Xpm_VT  is a DescriptionValidationTable
43602>>>>>>>>>>>>>>>
43602>>>>>>>>>>>>>>>    Procedure Fill_List
43604>>>>>>>>>>>>>>>        Forward Send Fill_List
43606>>>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "•¨œ¦ç£œ¤¦ª"
43607>>>>>>>>>>>>>>>        Send Add_Table_Value  "2"  " ©«¦ç£œ¤¦ª"
43608>>>>>>>>>>>>>>>        Send Add_Table_Value  "3"  "‹ ¡«æª"
43609>>>>>>>>>>>>>>>    End_Procedure    // Fill_List
43610>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43610>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43610>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Xpm_VT
43611>>>>>>>>>>>>>>>
43611>>>>>>>>>>>>>>>Object Gplan_Gplan_Doy_VT  is a CodeValidationTable
43613>>>>>>>>>>>>>>>    Set Type_Value        To "DOY"
43614>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
43615>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43615>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43615>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Doy_VT
43616>>>>>>>>>>>>>>>
43616>>>>>>>>>>>>>>>Object Gplan_Gplan_J_Code_VT  is a CodeValidationTable
43618>>>>>>>>>>>>>>>    Set Type_Value        To "JOB"
43619>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
43620>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43620>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43620>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_J_Code_VT
43621>>>>>>>>>>>>>>>
43621>>>>>>>>>>>>>>>Object Gplan_Gplan_C_Code2_VT  is a CodeValidationTable
43623>>>>>>>>>>>>>>>    Set Type_Value        To "CURRENCY"
43624>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
43625>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43625>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43625>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_C_Code2_VT
43626>>>>>>>>>>>>>>>
43626>>>>>>>>>>>>>>>Object Gplan_Gplan_I_A_Code_VT2  is a CodeValidationTable
43628>>>>>>>>>>>>>>>    Set Type_Value        To "AITIOL"
43629>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
43630>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43630>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43630>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_I_A_Code_VT2
43631>>>>>>>>>>>>>>>
43631>>>>>>>>>>>>>>>Object Gplan_Gplan_Myf_Sum_VT  is a CodeValidationTable
43633>>>>>>>>>>>>>>>    Set Type_Value        To "MYF"
43634>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43634>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43634>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Myf_Sum_VT
43635>>>>>>>>>>>>>>>//DDB-ValidationEnd
43635>>>>>>>>>>>>>>>//DDB-SelectionStart
43635>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.sl
43635>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList Gtypkin  Gtypkin.sl
43635>>>>>>>>>>>>>>>Register_Object sl150
43635>>>>>>>>>>>>>>>Register_Object Gtypkin
43635>>>>>>>>>>>>>>>//DDB-SelectionEnd
43635>>>>>>>>>>>>>>>Use arrays.Sub
43635>>>>>>>>>>>>>>>
43635>>>>>>>>>>>>>>>Use Gmovea.dd //®¨œ áœ«˜  ¦§à›ã§¦«œ, › æ«  œå¤˜  alias file ¡˜ 
INCLUDING FILE: GMOVEA.DD
43635>>>>>>>>>>>>>>>>>//DDB-FileStart
43635>>>>>>>>>>>>>>>>>//DDB-HeaderStart
43635>>>>>>>>>>>>>>>>>
43635>>>>>>>>>>>>>>>>>// File Name : GMOVEA.DD
43635>>>>>>>>>>>>>>>>>// Class Name: Gmovea_DataDictionary
43635>>>>>>>>>>>>>>>>>// Revision  : 17
43635>>>>>>>>>>>>>>>>>// Version   : 2
43635>>>>>>>>>>>>>>>>>
43635>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
43635>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43635>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43635>>>>>>>>>>>>>>>>>
43635>>>>>>>>>>>>>>>>>Open Gmovea
43637>>>>>>>>>>>>>>>>>Open Gopen
INCLUDING FILE: GOPEN.FD
43639>>>>>>>>>>>>>>>>>Open Garticl
INCLUDING FILE: GARTICL.FD
43641>>>>>>>>>>>>>>>>>Open Gplan
43643>>>>>>>>>>>>>>>>>
43643>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
43643>>>>>>>>>>>>>>>>>
43643>>>>>>>>>>>>>>>>>//open master file
43643>>>>>>>>>>>>>>>>>Open Gmove
43645>>>>>>>>>>>>>>>>>
43645>>>>>>>>>>>>>>>>>//define alias-master condition
43645>>>>>>>>>>>>>>>>>Set_Attribute DF_FILE_ALIAS of Gmovea.File_Number to DF_FILE_IS_ALIAS
43648>>>>>>>>>>>>>>>>>Set_Attribute DF_FILE_ALIAS of Gmove.File_Number  to DF_FILE_IS_MASTER
43651>>>>>>>>>>>>>>>>>
43651>>>>>>>>>>>>>>>>>//clear all relationships from the alias file
43651>>>>>>>>>>>>>>>>>Set_Relate Gmovea.Garticl_Recr to |FN0,0
43652>>>>>>>>>>>>>>>>>>
43652>>>>>>>>>>>>>>>>>Set_Relate Gmovea.Gplan_Recr   to |FN0,0
43653>>>>>>>>>>>>>>>>>>
43653>>>>>>>>>>>>>>>>>
43653>>>>>>>>>>>>>>>>>
43653>>>>>>>>>>>>>>>>>Class Gmovea_DataDictionary  is a DataDictionary_Sec
43654>>>>>>>>>>>>>>>>>
43654>>>>>>>>>>>>>>>>>
43654>>>>>>>>>>>>>>>>>      //private
43654>>>>>>>>>>>>>>>>>      //œ¤ž£œ¨é¤œ  «˜ 13 §œ›å˜ open item
43654>>>>>>>>>>>>>>>>>      //¡˜¢œå«˜  ˜§æ update
43654>>>>>>>>>>>>>>>>>      Procedure private.Do_Compute_Open_Itemsa
43655>>>>>>>>>>>>>>>>>                Case Begin
43655>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_X0 > 0) //˜«æ­ ¦ ®¨œà©« ¡æ record
43657>>>>>>>>>>>>>>>>>                          Move "+"                                                 to Gmovea.Gmove_Topen
43658>>>>>>>>>>>>>>>>>                          Move (     Gmovea.Gmove_X0  - Gmovea.Gmove_Open_Sx0) to Gmovea.Gmove_Open_Yx0
43659>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yp0
43660>>>>>>>>>>>>>>>>>                     Case Break
43661>>>>>>>>>>>>>>>>>
43661>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_X0 < 0) //¯œ¬«¦- ®¨œà©« ¡æ record
43664>>>>>>>>>>>>>>>>>                          Move "-"                                                 to Gmovea.Gmove_Topen
43665>>>>>>>>>>>>>>>>>                          Move ((Abs(Gmovea.Gmove_X0))- Gmovea.Gmove_Open_Sp0) to Gmovea.Gmove_Open_Yp0
43666>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yx0
43667>>>>>>>>>>>>>>>>>                     Case Break
43668>>>>>>>>>>>>>>>>>
43668>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_P0 > 0) //˜«æ­ ¦ § ©«à« ¡æ record
43671>>>>>>>>>>>>>>>>>                          Move "-"                                                 to Gmovea.Gmove_Topen
43672>>>>>>>>>>>>>>>>>                          Move (     Gmovea.Gmove_P0  - Gmovea.Gmove_Open_Sp0) to Gmovea.Gmove_Open_Yp0
43673>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yx0
43674>>>>>>>>>>>>>>>>>                     Case Break
43675>>>>>>>>>>>>>>>>>
43675>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_P0 < 0) //¯œç«¦- ®¨œà©« ¡æ record
43678>>>>>>>>>>>>>>>>>                          Move "+"                                                 to Gmovea.Gmove_Topen
43679>>>>>>>>>>>>>>>>>                          Move ((Abs(Gmovea.Gmove_P0))- Gmovea.Gmove_Open_Sx0) to Gmovea.Gmove_Open_Yx0
43680>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yp0
43681>>>>>>>>>>>>>>>>>                     Case Break
43682>>>>>>>>>>>>>>>>>                Case End
43682>>>>>>>>>>>>>>>>>      End_Procedure //private.do_compute_open_itemsa
43683>>>>>>>>>>>>>>>>>
43683>>>>>>>>>>>>>>>>>
43683>>>>>>>>>>>>>>>>>
43683>>>>>>>>>>>>>>>>>      //private
43683>>>>>>>>>>>>>>>>>      //œ¢âš®œ  «˜ 13 §œ›å˜ open item
43683>>>>>>>>>>>>>>>>>      //¡˜¢œå«˜  ˜§æ validate save
43683>>>>>>>>>>>>>>>>>      Function  private.fi_Validate_Open_Itemsa Returns Integer
43684>>>>>>>>>>>>>>>>>
43684>>>>>>>>>>>>>>>>>                 //1101+1102+1103+1104:â¢œš®¦  £ã ˜¨¤ž« ¡é¤ ¬§¦¢¦å§à¤ §¨¦ª ©¬©®â« ©ž ¡˜  ©¬©®œ« ©Ÿâ¤«à¤ §¦©é¤
43684>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 >= 0                       )) Function_Return 1101
43687>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 >= 0                       )) Function_Return 1102
43690>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 >= 0                       )) Function_Return 1103
43693>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 >= 0                       )) Function_Return 1104
43696>>>>>>>>>>>>>>>>>
43696>>>>>>>>>>>>>>>>>                 Case Begin
43696>>>>>>>>>>>>>>>>>                      //1105+1106+1107+1108:â¢œš®¦  š ˜ ˜«æ­ ¦ ®¨œà©« ¡æ record
43696>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_X0 > 0)
43698>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 <=      Gmovea.Gmove_X0  )) Function_Return 1105
43701>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 <=      Gmovea.Gmove_X0  )) Function_Return 1106
43704>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0  = 0                       )) Function_Return 1107
43707>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0  = 0                       )) Function_Return 1108
43710>>>>>>>>>>>>>>>>>                      Case Break
43711>>>>>>>>>>>>>>>>>                      //1109+1110+1111+1112:â¢œš®¦  š ˜ ¯œ¬«¦- ®¨œà©« ¡æ record
43711>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_X0 < 0)
43714>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0  = 0                       )) Function_Return 1109
43717>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0  = 0                       )) Function_Return 1110
43720>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 <= (Abs(Gmovea.Gmove_X0)))) Function_Return 1111
43723>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 <= (Abs(Gmovea.Gmove_X0)))) Function_Return 1112
43726>>>>>>>>>>>>>>>>>                      Case Break
43727>>>>>>>>>>>>>>>>>                      //1113+1114+1115+1116:â¢œš®¦  š ˜ ˜«æ­ ¦ § ©«à« ¡æ record
43727>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_P0 > 0)
43730>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0  = 0                       )) Function_Return 1113
43733>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0  = 0                       )) Function_Return 1114
43736>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 <=      Gmovea.Gmove_P0  )) Function_Return 1115
43739>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 <=      Gmovea.Gmove_P0  )) Function_Return 1116
43742>>>>>>>>>>>>>>>>>                      Case Break
43743>>>>>>>>>>>>>>>>>                      //1117+1118+1119+1120:â¢œš®¦  š ˜ ¯œç«¦- ®¨œà©« ¡æ record
43743>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_P0 < 0)
43746>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 <= (Abs(Gmovea.Gmove_P0)))) Function_Return 1117
43749>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 <= (Abs(Gmovea.Gmove_P0)))) Function_Return 1118
43752>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0  = 0                       )) Function_Return 1119
43755>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0  = 0                       )) Function_Return 1120
43758>>>>>>>>>>>>>>>>>                      Case Break
43759>>>>>>>>>>>>>>>>>                 Case End
43759>>>>>>>>>>>>>>>>>
43759>>>>>>>>>>>>>>>>>                 Function_Return 0 //æ¢˜ ok
43760>>>>>>>>>>>>>>>>>      End_Function //private.fi_validate_open_itemsa
43761>>>>>>>>>>>>>>>>>
43761>>>>>>>>>>>>>>>>>    Procedure Update
43762>>>>>>>>>>>>>>>>>          Send private.Do_Compute_Open_Itemsa
43763>>>>>>>>>>>>>>>>>    End_Procedure //update
43764>>>>>>>>>>>>>>>>>
43764>>>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
43765>>>>>>>>>>>>>>>>>              String lsError_Message
43766>>>>>>>>>>>>>>>>>              Case Begin
43766>>>>>>>>>>>>>>>>>                   //˜§æ validate save
43766>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1101)
43768>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ œå¤˜  ˜¨¤ž« ¡æ !");                        to lsError_Message
43769>>>>>>>>>>>>>>>>>                   Case Break
43770>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1102)
43773>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ œå¤˜  ˜¨¤ž« ¡æ !");                        to lsError_Message
43774>>>>>>>>>>>>>>>>>                   Case Break
43775>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1103)
43778>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª œå¤˜  ˜¨¤ž« ¡ã !");                        to lsError_Message
43779>>>>>>>>>>>>>>>>>                   Case Break
43780>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1104)
43783>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª œå¤˜  ˜¨¤ž« ¡ã !");                        to lsError_Message
43784>>>>>>>>>>>>>>>>>                   Case Break
43785>>>>>>>>>>>>>>>>>                   //---------------------------------------Ÿœ« ¡âª ®¨œé©œ ª-----------------
43785>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1105)
43788>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã ®¨âà©ž !");                        to lsError_Message
43789>>>>>>>>>>>>>>>>>                   Case Break
43790>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1106)
43793>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã ®¨âà©ž !");                        to lsError_Message
43794>>>>>>>>>>>>>>>>>                   Case Break
43795>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1107)
43798>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ !");                        to lsError_Message
43799>>>>>>>>>>>>>>>>>                   Case Break
43800>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1108)
43803>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
43804>>>>>>>>>>>>>>>>>                   Case Break
43805>>>>>>>>>>>>>>>>>                   //---------------------------------------˜¨¤ž« ¡âª ®¨œé©œ ª---------------
43805>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1109)
43808>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ!");                        to lsError_Message
43809>>>>>>>>>>>>>>>>>                   Case Break
43810>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1110)
43813>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
43814>>>>>>>>>>>>>>>>>                   Case Break
43815>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1111)
43818>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª ®¨âà©žª !");                        to lsError_Message
43819>>>>>>>>>>>>>>>>>                   Case Break
43820>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1112)
43823>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª ®¨âà©žª !");                        to lsError_Message
43824>>>>>>>>>>>>>>>>>                   Case Break
43825>>>>>>>>>>>>>>>>>                   //---------------------------------------Ÿœ« ¡âª § ©«é©œ ª----------------
43825>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1113)
43828>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ !");                        to lsError_Message
43829>>>>>>>>>>>>>>>>>                   Case Break
43830>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1114)
43833>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
43834>>>>>>>>>>>>>>>>>                   Case Break
43835>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1115)
43838>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã §å©«à©ž !");                        to lsError_Message
43839>>>>>>>>>>>>>>>>>                   Case Break
43840>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1116)
43843>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã §å©«à©ž !");                        to lsError_Message
43844>>>>>>>>>>>>>>>>>                   Case Break
43845>>>>>>>>>>>>>>>>>                   //---------------------------------------˜¨àž« ¡âª § ©«é©œ ª----------------
43845>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1117)
43848>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ!");                        to lsError_Message
43849>>>>>>>>>>>>>>>>>                   Case Break
43850>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1118)
43853>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
43854>>>>>>>>>>>>>>>>>                   Case Break
43855>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1119)
43858>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª §å©«à©žª !");                        to lsError_Message
43859>>>>>>>>>>>>>>>>>                   Case Break
43860>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1120) //soso ayto den xoraei display stin othoni !
43863>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª §å©«à©žª !");                        to lsError_Message
43864>>>>>>>>>>>>>>>>>                   Case Break
43865>>>>>>>>>>>>>>>>>
43865>>>>>>>>>>>>>>>>>
43865>>>>>>>>>>>>>>>>>                   //˜§æ validate delete
43865>>>>>>>>>>>>>>>>>                   Case (iError_Num = 2001)
43868>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n˜¨˜¡˜¢é ¡˜¢â©˜«œ «ž¤ Solution !");                        to lsError_Message
43869>>>>>>>>>>>>>>>>>                   Case Break
43870>>>>>>>>>>>>>>>>>
43870>>>>>>>>>>>>>>>>>                   Case Else
43870>>>>>>>>>>>>>>>>>                        Forward Send Operation_Not_Allowed iError_Num
43872>>>>>>>>>>>>>>>>>              Case End
43872>>>>>>>>>>>>>>>>>
43872>>>>>>>>>>>>>>>>>              Error iError_Num lsError_Message
43873>>>>>>>>>>>>>>>>>>
43873>>>>>>>>>>>>>>>>>    End_Procedure   //operation_not_allowed
43874>>>>>>>>>>>>>>>>>
43874>>>>>>>>>>>>>>>>>
43874>>>>>>>>>>>>>>>>>    Function Validate_Save Returns Integer
43875>>>>>>>>>>>>>>>>>             Integer iReturnVal liOpen_Itemsa
43876>>>>>>>>>>>>>>>>>             Forward Get Validate_Save to iReturnVal
43878>>>>>>>>>>>>>>>>>
43878>>>>>>>>>>>>>>>>>             If (Not(iReturnVal));             Begin
43880>>>>>>>>>>>>>>>>>             //1101-1120:â¢œš®¦  open item
43880>>>>>>>>>>>>>>>>>              Move (private.fi_Validate_Open_Itemsa(Self)) to liOpen_Itemsa
43881>>>>>>>>>>>>>>>>>              If (liOpen_Itemsa <> 0) Send Operation_Not_Allowed liOpen_Itemsa
43884>>>>>>>>>>>>>>>>>             End //«â¢¦ª ¡é› ¡˜ validation
43884>>>>>>>>>>>>>>>>>>
43884>>>>>>>>>>>>>>>>>
43884>>>>>>>>>>>>>>>>>
43884>>>>>>>>>>>>>>>>>             Function_Return iReturnVal
43885>>>>>>>>>>>>>>>>>    End_Function //validate_save
43886>>>>>>>>>>>>>>>>>
43886>>>>>>>>>>>>>>>>>
43886>>>>>>>>>>>>>>>>>    //2001:«¦ alias Gmovea ›â¤ œ§ «¨â§œ  ‰ € ‹ ˆ €   › ˜š¨˜­ã
43886>>>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
43887>>>>>>>>>>>>>>>>>             Send Operation_Not_Allowed 2001 //¢áŸ¦ª «¦¬ ¡é› ¡˜ !!!
43888>>>>>>>>>>>>>>>>>    End_Function //validate_delete
43889>>>>>>>>>>>>>>>>>
43889>>>>>>>>>>>>>>>>>
43889>>>>>>>>>>>>>>>>>    // Define_Fields:
43889>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43889>>>>>>>>>>>>>>>>>
43889>>>>>>>>>>>>>>>>>    Procedure Define_Fields
43890>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
43892>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43892>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
43892>>>>>>>>>>>>>>>>>
43892>>>>>>>>>>>>>>>>>        Set Main_File            To Gmovea.File_Number
43893>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
43894>>>>>>>>>>>>>>>>>
43894>>>>>>>>>>>>>>>>>
43894>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
43894>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gopen.File_Number
43895>>>>>>>>>>>>>>>>>
43895>>>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
43895>>>>>>>>>>>>>>>>>        Send Add_Server_File  Garticl.File_Number
43896>>>>>>>>>>>>>>>>>        Send Add_Server_File  Gplan.File_Number
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Field-based properties.......................
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Company_Code
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Branch_Code
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Year_Year
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Code
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Garticl_Hmnia
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Garticl_No
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Garticl_Recr
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Recr
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Rec0
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Code
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aitiol
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X0
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P0
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X0k
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P0k
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X00
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P00
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X00k
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P00k
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X1
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P1
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X2
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P2
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X2k
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P2k
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Xr
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Pr
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Xrk
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Prk
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Dlixis
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_A_Code
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gthhmgio_Code
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aa
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx0
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp0
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx0
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp0
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx1
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp1
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx1
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp1
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx2
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp2
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx2
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp2
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Sc_Code2
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aopen
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Topen
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Kk
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gthhmgio_Period
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Yn_Myfp
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Yn_Myfa
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Myf_Sump
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Myf_Suma
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag01
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag02
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag03
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag04
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag05
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag06
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag07
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag08
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag09
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag10
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag11
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag12
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag13
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag14
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag15
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag16
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag17
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag18
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag19
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag20
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Year_Recr
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Recr
43897>>>>>>>>>>>>>>>>>
43897>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
43897>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
43898>>>>>>>>>>>>>>>>>
43898>>>>>>>>>>>>>>>>>    // Field_Defaults:
43898>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
43898>>>>>>>>>>>>>>>>>
43898>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
43899>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
43901>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43901>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
43901>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
43901>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
43902>>>>>>>>>>>>>>>>>End_Class    // Gmovea_DataDictionary
43903>>>>>>>>>>>>>>>>>//DDB-FileEnd
43903>>>>>>>>>>>>>>>              //©«ž¤ begin_transaction §¨¦¡˜¢œå deadlock
43903>>>>>>>>>>>>>>>
43903>>>>>>>>>>>>>>>Class Gplan_DataDictionary  is a DataDictionary_Sec
43904>>>>>>>>>>>>>>>
43904>>>>>>>>>>>>>>>    Procedure Construct_Object
43905>>>>>>>>>>>>>>>        Forward Send Construct_Object
43907>>>>>>>>>>>>>>>        Object oarrayGplan_Aux is a cPinakas
43909>>>>>>>>>>>>>>>        End_Object
43910>>>>>>>>>>>>>>>        Property Integer    pioarray_Gplan_Aux (oarrayGplan_Aux(self))
43911>>>>>>>>>>>>>>>        Property String     psValidChars ""
43912>>>>>>>>>>>>>>>        Property Integer    piMustNOTConstrain Public 0 
43913>>>>>>>>>>>>>>>        Property String     psBranch 
43914>>>>>>>>>>>>>>>    End_Procedure   // Construct_Object
43915>>>>>>>>>>>>>>>
43915>>>>>>>>>>>>>>>    Procedure OnConstrain
43916>>>>>>>>>>>>>>>        Forward Send OnConstrain
43918>>>>>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
43920>>>>>>>>>>>>>>>        End
43920>>>>>>>>>>>>>>>>
43920>>>>>>>>>>>>>>>        Else Begin
43921>>>>>>>>>>>>>>>            Constrain Gplan.Company_Code  eq SysCurGL.Company_Code
43923>>>>>>>>>>>>>>>            Constrain Gplan.Branch_Code   eq SysCurGL.Branch_Code
43925>>>>>>>>>>>>>>>        End
43925>>>>>>>>>>>>>>>>
43925>>>>>>>>>>>>>>>    End_Procedure
43926>>>>>>>>>>>>>>>
43926>>>>>>>>>>>>>>>    Procedure Update
43927>>>>>>>>>>>>>>>        Forward Send Update
43929>>>>>>>>>>>>>>>        // Insert Code Here
43929>>>>>>>>>>>>>>>        Move SysCurGL.Company_Code  to Gplan.Company_Code
43930>>>>>>>>>>>>>>>        Move SysCurGL.Branch_Code   to Gplan.Branch_Code
43931>>>>>>>>>>>>>>>        Move SysCurGL.Year_Year     to Gplan.Year_Year
43932>>>>>>>>>>>>>>>        Move SysCurGL.Year_Recr     to Gplan.Year_Recr
43933>>>>>>>>>>>>>>>    End_Procedure   // Update
43934>>>>>>>>>>>>>>>
43934>>>>>>>>>>>>>>>    Procedure Creating
43935>>>>>>>>>>>>>>>        Forward Send Creating
43937>>>>>>>>>>>>>>>        // Insert Code Here
43937>>>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gplan.Gplan_Rec0)))))) to Gplan.Gplan_Recr
43938>>>>>>>>>>>>>>>    End_Procedure   // Creating
43939>>>>>>>>>>>>>>>
43939>>>>>>>>>>>>>>>
43939>>>>>>>>>>>>>>>//////////////////////////////////////
43939>>>>>>>>>>>>>>>//////////////////////////////////////
43939>>>>>>>>>>>>>>>
43939>>>>>>>>>>>>>>>    Function fiCheckValidChars String asGplanCode String asValChars Returns Integer
43940>>>>>>>>>>>>>>>        String lsChar
43941>>>>>>>>>>>>>>>        Integer liLen liCharPos rVal
43941>>>>>>>>>>>>>>>        If (asGplanCode <> "") Begin
43943>>>>>>>>>>>>>>>            Move (Trim(asGplanCode)) to asGplanCode
43944>>>>>>>>>>>>>>>            Move (Length(asGplanCode)) to liLen
43945>>>>>>>>>>>>>>>            For liCharPos From 1 to liLen
43951>>>>>>>>>>>>>>>>
43951>>>>>>>>>>>>>>>               Move (Mid(asGplanCode,1,liCharPos)) to lsChar
43952>>>>>>>>>>>>>>>               If (Not(asValChars contains lsChar)) Begin
43954>>>>>>>>>>>>>>>                    Set psValidChars to asValChars
43955>>>>>>>>>>>>>>>                    Function_Return 1001
43956>>>>>>>>>>>>>>>               End
43956>>>>>>>>>>>>>>>>
43956>>>>>>>>>>>>>>>            Loop
43957>>>>>>>>>>>>>>>>
43957>>>>>>>>>>>>>>>        End
43957>>>>>>>>>>>>>>>>
43957>>>>>>>>>>>>>>>        Function_Return rVal
43958>>>>>>>>>>>>>>>    End_Function // fiCheckValidChars
43959>>>>>>>>>>>>>>>
43959>>>>>>>>>>>>>>>    // private_Do_Restore_Fields:
43959>>>>>>>>>>>>>>>    Procedure private_Do_Restore_Fields for Gplan_DataDictionary
43960>>>>>>>>>>>>>>>        // Insert Code Here
43960>>>>>>>>>>>>>>>        Local Integer lioarray_Gplan_Aux##
43961>>>>>>>>>>>>>>>        Local Integer liFile##
43961>>>>>>>>>>>>>>>        Local Integer liField_Count##
43961>>>>>>>>>>>>>>>        Local Integer liField_Type##
43961>>>>>>>>>>>>>>>        Local Integer liField##
43961>>>>>>>>>>>>>>>
43961>>>>>>>>>>>>>>>        Get pioarray_Gplan_Aux to lioarray_Gplan_Aux##
43962>>>>>>>>>>>>>>>        Get Main_File to liFile##
43963>>>>>>>>>>>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of liFile## to liField_Count##
43966>>>>>>>>>>>>>>>
43966>>>>>>>>>>>>>>>
43966>>>>>>>>>>>>>>>        For liField## from 0 to (liField_Count##-1)
43972>>>>>>>>>>>>>>>>
43972>>>>>>>>>>>>>>>            //Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
43972>>>>>>>>>>>>>>>            move liField## to Fieldindex
43973>>>>>>>>>>>>>>>            Get Array_Value of lioarray_Gplan_Aux## Item (liField##+1) to Gplan.Company_Code&
43974>>>>>>>>>>>>>>>        Loop
43975>>>>>>>>>>>>>>>>
43975>>>>>>>>>>>>>>>        Send Delete_Data to lioarray_Gplan_Aux##
43976>>>>>>>>>>>>>>>    End_Procedure   // private_Do_Restore_Fields
43977>>>>>>>>>>>>>>>
43977>>>>>>>>>>>>>>>    // private_Do_Keep_Fields:
43977>>>>>>>>>>>>>>>
43977>>>>>>>>>>>>>>>    Procedure private_Do_Keep_Fields for Gplan_DataDictionary
43978>>>>>>>>>>>>>>>        // Insert Code Here
43978>>>>>>>>>>>>>>>        Local Integer lioarray_Gplan_Aux##
43979>>>>>>>>>>>>>>>        Local Integer liFile##
43979>>>>>>>>>>>>>>>        Local Integer liField_Count##
43979>>>>>>>>>>>>>>>        Local Integer liField_Type##
43979>>>>>>>>>>>>>>>        Local Integer liField##
43979>>>>>>>>>>>>>>>
43979>>>>>>>>>>>>>>>        Get pioarray_Gplan_Aux to lioarray_Gplan_Aux##
43980>>>>>>>>>>>>>>>        Get Main_File to liFile##
43981>>>>>>>>>>>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of liFile## to liField_Count##
43984>>>>>>>>>>>>>>>
43984>>>>>>>>>>>>>>>        Send Delete_Data to lioarray_Gplan_Aux##
43985>>>>>>>>>>>>>>>        Send Add_Item to lioarray_Gplan_Aux## 0 //sos.sos
43986>>>>>>>>>>>>>>>
43986>>>>>>>>>>>>>>>        For liField## from 0 to (liField_Count##-1)
43992>>>>>>>>>>>>>>>>
43992>>>>>>>>>>>>>>>            //Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
43992>>>>>>>>>>>>>>>            move liField## to Fieldindex
43993>>>>>>>>>>>>>>>            Send Add_Item to lioarray_Gplan_Aux## Gplan.Company_Code&
43994>>>>>>>>>>>>>>>        Loop
43995>>>>>>>>>>>>>>>>
43995>>>>>>>>>>>>>>>    End_Procedure   // private_Do_Keep_Fields
43996>>>>>>>>>>>>>>>
43996>>>>>>>>>>>>>>>    // Request_Save:
43996>>>>>>>>>>>>>>>
43996>>>>>>>>>>>>>>>
43996>>>>>>>>>>>>>>>
43996>>>>>>>>>>>>>>>//-----------------------------------------------------------------------------
43996>>>>>>>>>>>>>>>    FUNCTION Compute_Bathmos for Gplan_DataDictionary STRING KODIKOS## RETURNS INTEGER
43997>>>>>>>>>>>>>>>             LOCAL INTEGER BATHMOS##
43998>>>>>>>>>>>>>>>             REPEAT
43998>>>>>>>>>>>>>>>>
43998>>>>>>>>>>>>>>>                   REPLACE "." IN KODIKOS## WITH ""
44000>>>>>>>>>>>>>>>                   [FOUND] INCREMENT BATHMOS##
44001>>>>>>>>>>>>>>>             UNTIL (FINDERR=1)
44003>>>>>>>>>>>>>>>             FUNCTION_RETURN (BATHMOS##+1)
44004>>>>>>>>>>>>>>>    END_FUNCTION //compute_bathmos
44005>>>>>>>>>>>>>>>
44005>>>>>>>>>>>>>>>    FUNCTION Find_Previous for Gplan_DataDictionary STRING LS_CODE1## RETURNS STRING
44006>>>>>>>>>>>>>>>        LOCAL STRING LS_TEMP_CODE1## LS_TEMP_CODE2##
44007>>>>>>>>>>>>>>>        LOCAL INTEGER LI_COUNTER##
44007>>>>>>>>>>>>>>>
44007>>>>>>>>>>>>>>>        FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_CODE1##))
44013>>>>>>>>>>>>>>>>
44013>>>>>>>>>>>>>>>             INSERT (MID(LS_CODE1##,1,LI_COUNTER##)) IN LS_TEMP_CODE1## AT 1
44015>>>>>>>>>>>>>>>        LOOP
44016>>>>>>>>>>>>>>>>
44016>>>>>>>>>>>>>>>        MOVE (RIGHT(LS_TEMP_CODE1##,(LENGTH(LS_TEMP_CODE1##)-(POS(".",LS_TEMP_CODE1##))))) ;             TO LS_TEMP_CODE1##
44017>>>>>>>>>>>>>>>        FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_TEMP_CODE1##))
44023>>>>>>>>>>>>>>>>
44023>>>>>>>>>>>>>>>            INSERT (MID(LS_TEMP_CODE1##,1,LI_COUNTER##)) IN LS_TEMP_CODE2## AT 1
44025>>>>>>>>>>>>>>>        LOOP
44026>>>>>>>>>>>>>>>>
44026>>>>>>>>>>>>>>>        FUNCTION_RETURN LS_TEMP_CODE2##
44027>>>>>>>>>>>>>>>    END_FUNCTION
44028>>>>>>>>>>>>>>>
44028>>>>>>>>>>>>>>>    FUNCTION fiCheck_Format STRING  LS_CODE1##;                            STRING  LS_MASK##;                            INTEGER LI_BATHMOS##;                            RETURNS INTEGER
44029>>>>>>>>>>>>>>>             String  LS_TEMP_CODE1## LS_TEMP_CODE2## LS_MASK2##
44030>>>>>>>>>>>>>>>             Integer LI_COUNTER## LI_BATHMOS1##
44030>>>>>>>>>>>>>>>             Move (Trim(ls_Code1##)) to ls_Code1##
44031>>>>>>>>>>>>>>>             Move (Trim(ls_Mask##))  to ls_Mask##
44032>>>>>>>>>>>>>>>             FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_MASK##))
44038>>>>>>>>>>>>>>>>
44038>>>>>>>>>>>>>>>                  IF ((MID(LS_MASK##,1,LI_COUNTER##)) = ".") INCREMENT LI_BATHMOS1##
44041>>>>>>>>>>>>>>>                  IF (LI_BATHMOS1## < LI_BATHMOS##) ;                  INSERT (MID(LS_MASK##,1,LI_COUNTER##)) IN LS_MASK2## AT LI_COUNTER##
44045>>>>>>>>>>>>>>>             LOOP
44046>>>>>>>>>>>>>>>>
44046>>>>>>>>>>>>>>>             IF (;                  (LENGTH(LS_CODE1##)) <> (LENGTH(LS_MASK2##));                ) FUNCTION_RETURN 1000
44049>>>>>>>>>>>>>>>             FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_MASK2##))
44055>>>>>>>>>>>>>>>>
44055>>>>>>>>>>>>>>>                  IF (;                      ((MID(LS_MASK2##,1,LI_COUNTER##)) = ".") AND;                      ((MID(LS_CODE1##,1,LI_COUNTER##)) <> ".");                     ) FUNCTION_RETURN 1000
44058>>>>>>>>>>>>>>>             LOOP
44059>>>>>>>>>>>>>>>>
44059>>>>>>>>>>>>>>>             FUNCTION_RETURN 0
44060>>>>>>>>>>>>>>>    END_FUNCTION //fiCHECK_FORMAT
44061>>>>>>>>>>>>>>>
44061>>>>>>>>>>>>>>>    Function fiBackward_Check for Gplan_DataDictionary String LsGplanCode_Back integer liBathmos Returns Integer
44062>>>>>>>>>>>>>>>        Integer liGplan_Yn_Last
44063>>>>>>>>>>>>>>>        Number liGplanRecnum
44063>>>>>>>>>>>>>>>        String LsSearch_CodePrevious
44063>>>>>>>>>>>>>>>
44063>>>>>>>>>>>>>>>        if (liBathmos > 1) begin
44065>>>>>>>>>>>>>>>
44065>>>>>>>>>>>>>>>            move (Current_Record(Self)) to liGplanRecnum
44066>>>>>>>>>>>>>>>            move gplan.Gplan_Yn_Last to liGplan_Yn_Last
44067>>>>>>>>>>>>>>>            Send private_Do_Keep_Fields
44068>>>>>>>>>>>>>>>
44068>>>>>>>>>>>>>>>            Move (Find_Previous(self,lsGplanCode_Back)) to lsSearch_CodePrevious
44069>>>>>>>>>>>>>>>
44069>>>>>>>>>>>>>>>            clear Gplan
44070>>>>>>>>>>>>>>>            move gs_Selected_Company_Code  to Gplan.Company_Code
44071>>>>>>>>>>>>>>>            move gs_Selected_Branch_Code   to Gplan.Branch_Code
44072>>>>>>>>>>>>>>>            move gi_Selected_Year          to Gplan.Year_Year
44073>>>>>>>>>>>>>>>            move lsSearch_CodePrevious     to Gplan.Gplan_Code
44074>>>>>>>>>>>>>>>            Find eq Gplan by index.1 // pkid
44075>>>>>>>>>>>>>>>>
44075>>>>>>>>>>>>>>>            If (Found = 0) begin
44077>>>>>>>>>>>>>>>                clear gplan
44078>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
44079>>>>>>>>>>>>>>>                find eq gplan.recnum
44080>>>>>>>>>>>>>>>>
44080>>>>>>>>>>>>>>>                Send private_Do_Restore_Fields
44081>>>>>>>>>>>>>>>                Function_return  7001 //return to fiValidate
44082>>>>>>>>>>>>>>>            end
44082>>>>>>>>>>>>>>>>
44082>>>>>>>>>>>>>>>            else begin
44083>>>>>>>>>>>>>>>               // The  previous logar marked last  and current greater bathmos
44083>>>>>>>>>>>>>>>               if   (Gplan.Gplan_yn_Last = 1) begin
44085>>>>>>>>>>>>>>>                   Send private_Do_Restore_Fields
44086>>>>>>>>>>>>>>>                   Function_return 7003
44087>>>>>>>>>>>>>>>               end
44087>>>>>>>>>>>>>>>>
44087>>>>>>>>>>>>>>>               clear gplan
44088>>>>>>>>>>>>>>>               move liGplanRecnum to gplan.recnum
44089>>>>>>>>>>>>>>>               find eq gplan.recnum
44090>>>>>>>>>>>>>>>>
44090>>>>>>>>>>>>>>>               Send private_Do_Restore_Fields
44091>>>>>>>>>>>>>>>               function_Return 0 //ok
44092>>>>>>>>>>>>>>>            end
44092>>>>>>>>>>>>>>>>
44092>>>>>>>>>>>>>>>        end
44092>>>>>>>>>>>>>>>>
44092>>>>>>>>>>>>>>>        Function_Return 0
44093>>>>>>>>>>>>>>>    End_Function  // fiBackward_Check
44094>>>>>>>>>>>>>>>    //-----------------------------------------------------------------------------
44094>>>>>>>>>>>>>>>
44094>>>>>>>>>>>>>>>
44094>>>>>>>>>>>>>>>    //-----------------------------------------------------------------------------
44094>>>>>>>>>>>>>>>    FUNCTION fiForward_Check for Gplan_DataDictionary STRING LS_GplanCode integer liMode Returns Integer
44095>>>>>>>>>>>>>>>        String lsNext_Anoep
44096>>>>>>>>>>>>>>>        Integer liGplan_Yn_Last
44096>>>>>>>>>>>>>>>        Number liGplanRecnum
44096>>>>>>>>>>>>>>>
44096>>>>>>>>>>>>>>>
44096>>>>>>>>>>>>>>>        //move gplan.recnum to liGplanRecnum
44096>>>>>>>>>>>>>>>        move (Current_Record(Self)) to liGplanRecnum
44097>>>>>>>>>>>>>>>        move gplan.Gplan_Code to lsNext_Anoep
44098>>>>>>>>>>>>>>>        move gplan.Gplan_Yn_Last to liGplan_Yn_Last
44099>>>>>>>>>>>>>>>        Send private_Do_Keep_Fields
44100>>>>>>>>>>>>>>>
44100>>>>>>>>>>>>>>>        if (liGplan_Yn_Last = 1)  begin
44102>>>>>>>>>>>>>>>            find gt gplan by index.1
44103>>>>>>>>>>>>>>>>
44103>>>>>>>>>>>>>>>            if (found = 0) begin
44105>>>>>>>>>>>>>>>                clear gplan
44106>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
44107>>>>>>>>>>>>>>>                find eq gplan.recnum
44108>>>>>>>>>>>>>>>>
44108>>>>>>>>>>>>>>>                Send private_Do_Restore_Fields
44109>>>>>>>>>>>>>>>            end
44109>>>>>>>>>>>>>>>>
44109>>>>>>>>>>>>>>>            else begin
44110>>>>>>>>>>>>>>>                // The Current and the previous logar marked last
44110>>>>>>>>>>>>>>>                if (Gplan.Gplan_Anoep = lsNext_Anoep) begin
44112>>>>>>>>>>>>>>>                    clear gplan
44113>>>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
44114>>>>>>>>>>>>>>>                    find eq gplan.recnum
44115>>>>>>>>>>>>>>>>
44115>>>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
44116>>>>>>>>>>>>>>>                    Function_return 7004
44117>>>>>>>>>>>>>>>                end
44117>>>>>>>>>>>>>>>>
44117>>>>>>>>>>>>>>>                else begin
44118>>>>>>>>>>>>>>>                    clear gplan
44119>>>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
44120>>>>>>>>>>>>>>>                    find eq gplan.recnum
44121>>>>>>>>>>>>>>>>
44121>>>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
44122>>>>>>>>>>>>>>>                end
44122>>>>>>>>>>>>>>>>
44122>>>>>>>>>>>>>>>            end
44122>>>>>>>>>>>>>>>>
44122>>>>>>>>>>>>>>>        end
44122>>>>>>>>>>>>>>>>
44122>>>>>>>>>>>>>>>
44122>>>>>>>>>>>>>>>        if (liMode = 1) begin
44124>>>>>>>>>>>>>>>            find gt gplan by index.1
44125>>>>>>>>>>>>>>>>
44125>>>>>>>>>>>>>>>            if (Found = 0) begin
44127>>>>>>>>>>>>>>>                clear gplan
44128>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
44129>>>>>>>>>>>>>>>                find eq gplan.recnum
44130>>>>>>>>>>>>>>>>
44130>>>>>>>>>>>>>>>                Send private_Do_Restore_Fields
44131>>>>>>>>>>>>>>>            end
44131>>>>>>>>>>>>>>>>
44131>>>>>>>>>>>>>>>            else begin
44132>>>>>>>>>>>>>>>                if (Gplan.Gplan_Anoep = lsNext_Anoep) begin
44134>>>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
44135>>>>>>>>>>>>>>>                    find eq gplan.recnum
44136>>>>>>>>>>>>>>>>
44136>>>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
44137>>>>>>>>>>>>>>>                    Function_return 7010 //called from validate delete
44138>>>>>>>>>>>>>>>                end
44138>>>>>>>>>>>>>>>>
44138>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
44139>>>>>>>>>>>>>>>                find eq gplan.recnum
44140>>>>>>>>>>>>>>>>
44140>>>>>>>>>>>>>>>                //Send private_Do_Restore_Fields
44140>>>>>>>>>>>>>>>            end
44140>>>>>>>>>>>>>>>>
44140>>>>>>>>>>>>>>>        end
44140>>>>>>>>>>>>>>>>
44140>>>>>>>>>>>>>>>        Function_return 0
44141>>>>>>>>>>>>>>>    End_Function // fiForward_Check
44142>>>>>>>>>>>>>>>
44142>>>>>>>>>>>>>>>
44142>>>>>>>>>>>>>>>    Function private_Man_Gplan_Code for Gplan_DataDictionary integer liField## String lsGplan_Code integer liModeGplan Returns Integer
44143>>>>>>>>>>>>>>>
44143>>>>>>>>>>>>>>>        // Insert Code Here
44143>>>>>>>>>>>>>>>        Integer liCounter liPosition liLength liBathmos liRetVal
44144>>>>>>>>>>>>>>>        string lsMask lsCkeckChar lsSearchCode
44144>>>>>>>>>>>>>>>
44144>>>>>>>>>>>>>>>        Trim lsGplan_code to lsGplan_code
44145>>>>>>>>>>>>>>>>
44145>>>>>>>>>>>>>>>        Move lsGplan_Code to lsSearchCode
44146>>>>>>>>>>>>>>>    Search_Again:
44146>>>>>>>>>>>>>>>        clear Gformat
INCLUDING FILE: GFORMAT.FD
44147>>>>>>>>>>>>>>>        move SysCurGL.Company_Code  to Gformat.Company_Code
44148>>>>>>>>>>>>>>>        move SysCurGL.Branch_Code   to Gformat.Branch_Code
44149>>>>>>>>>>>>>>>        move SysCurGL.Year_Year     to Gformat.Year_Year
44150>>>>>>>>>>>>>>>        move lsSearchCode           to Gformat.Gformat_Code
44151>>>>>>>>>>>>>>>        Find eq Gformat by index.1
44152>>>>>>>>>>>>>>>>
44152>>>>>>>>>>>>>>>
44152>>>>>>>>>>>>>>>        if (Found = 1) begin
44154>>>>>>>>>>>>>>>            Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
44155>>>>>>>>>>>>>>>            Move (fiCheck_Format(self,lsGplan_Code,gformat.gformat_mask,liBathmos)) to liRetVal
44156>>>>>>>>>>>>>>>            if (liRetVal = 0) begin
44158>>>>>>>>>>>>>>>                Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
44159>>>>>>>>>>>>>>>                if (liModeGplan = 0) Begin
44161>>>>>>>>>>>>>>>                    if (Not(Current_Record(self))) begin
44163>>>>>>>>>>>>>>>                        set field_default_value field Gplan.gplan_Bathmos to libathmos //from deo
44164>>>>>>>>>>>>>>>                    end
44164>>>>>>>>>>>>>>>>
44164>>>>>>>>>>>>>>>                end
44164>>>>>>>>>>>>>>>>
44164>>>>>>>>>>>>>>>                if (libathmos > 1) begin
44166>>>>>>>>>>>>>>>                    Move (Find_Previous(self,lsGplan_Code)) to lsSearchCode
44167>>>>>>>>>>>>>>>                    if (liModeGplan = 0) Begin
44169>>>>>>>>>>>>>>>                        if (Not(Current_Record(self))) begin
44171>>>>>>>>>>>>>>>                            set field_default_value field Gplan.gplan_Anoep to lsSearchCode //from Deo
44172>>>>>>>>>>>>>>>                        End
44172>>>>>>>>>>>>>>>>
44172>>>>>>>>>>>>>>>                    End
44172>>>>>>>>>>>>>>>>
44172>>>>>>>>>>>>>>>                end
44172>>>>>>>>>>>>>>>>
44172>>>>>>>>>>>>>>>            function_return 0
44173>>>>>>>>>>>>>>>            end
44173>>>>>>>>>>>>>>>>
44173>>>>>>>>>>>>>>>            else begin
44174>>>>>>>>>>>>>>>                function_return 127
44175>>>>>>>>>>>>>>>            end
44175>>>>>>>>>>>>>>>>
44175>>>>>>>>>>>>>>>        end
44175>>>>>>>>>>>>>>>>
44175>>>>>>>>>>>>>>>        else begin
44176>>>>>>>>>>>>>>>            Move (Compute_Bathmos(self,lsSearchCode)) to liBathmos
44177>>>>>>>>>>>>>>>            if ((liBathmos-1) <> 0) begin
44179>>>>>>>>>>>>>>>                Move (Find_Previous(self,lsSearchCode)) to lsSearchCode
44180>>>>>>>>>>>>>>>                Goto Search_Again
44181>>>>>>>>>>>>>>>>
44181>>>>>>>>>>>>>>>            end
44181>>>>>>>>>>>>>>>>
44181>>>>>>>>>>>>>>>            else begin
44182>>>>>>>>>>>>>>>                clear Gformat
44183>>>>>>>>>>>>>>>                move SysCurGL.Company_Code  to Gformat.Company_Code
44184>>>>>>>>>>>>>>>                move SysCurGL.Branch_Code   to Gformat.Branch_Code
44185>>>>>>>>>>>>>>>                move SysCurGL.Year_Year     to Gformat.Year_Year
44186>>>>>>>>>>>>>>>                move "@@"                   to Gformat.Gformat_Code
44187>>>>>>>>>>>>>>>                Find eq Gformat by index.1 // pkid
44188>>>>>>>>>>>>>>>>
44188>>>>>>>>>>>>>>>//* to be a function
44188>>>>>>>>>>>>>>>                Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
44189>>>>>>>>>>>>>>>                Move (fiCheck_Format(self,lsGplan_Code,gformat.gformat_mask,liBathmos)) to liRetVal
44190>>>>>>>>>>>>>>>                if (liRetVal = 0) begin
44192>>>>>>>>>>>>>>>                    Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
44193>>>>>>>>>>>>>>>                    if (liModeGplan = 0) Begin
44195>>>>>>>>>>>>>>>                        if (Not(Current_Record(self))) begin
44197>>>>>>>>>>>>>>>                            set field_default_value field Gplan.gplan_Bathmos to libathmos //from Deo
44198>>>>>>>>>>>>>>>                        end
44198>>>>>>>>>>>>>>>>
44198>>>>>>>>>>>>>>>                    end
44198>>>>>>>>>>>>>>>>
44198>>>>>>>>>>>>>>>                    if (libathmos > 1) begin
44200>>>>>>>>>>>>>>>                        Move (Find_Previous(self,lsGplan_Code)) to lsSearchCode
44201>>>>>>>>>>>>>>>                        if (liModeGplan = 0) Begin
44203>>>>>>>>>>>>>>>                            if (Not(Current_Record(self))) begin
44205>>>>>>>>>>>>>>>                                set field_default_value field Gplan.gplan_Anoep to lsSearchCode //from Deo
44206>>>>>>>>>>>>>>>                            end
44206>>>>>>>>>>>>>>>>
44206>>>>>>>>>>>>>>>                        end
44206>>>>>>>>>>>>>>>>
44206>>>>>>>>>>>>>>>                    end
44206>>>>>>>>>>>>>>>>
44206>>>>>>>>>>>>>>>                function_return 0
44207>>>>>>>>>>>>>>>                end
44207>>>>>>>>>>>>>>>>
44207>>>>>>>>>>>>>>>                else begin
44208>>>>>>>>>>>>>>>                    function_return 127
44209>>>>>>>>>>>>>>>                end
44209>>>>>>>>>>>>>>>>
44209>>>>>>>>>>>>>>>
44209>>>>>>>>>>>>>>>                //* emd to be a function
44209>>>>>>>>>>>>>>>                function_return 0
44210>>>>>>>>>>>>>>>            end
44210>>>>>>>>>>>>>>>>
44210>>>>>>>>>>>>>>>        end
44210>>>>>>>>>>>>>>>>
44210>>>>>>>>>>>>>>>        Function_return 0    //ok
44211>>>>>>>>>>>>>>>    End_Function   // private_Man_Gplan_Code
44212>>>>>>>>>>>>>>>
44212>>>>>>>>>>>>>>>
44212>>>>>>>>>>>>>>>
44212>>>>>>>>>>>>>>>    // fiValidateGplanFields:
44212>>>>>>>>>>>>>>>
44212>>>>>>>>>>>>>>>    Function fiValidateGplanFields for Gplan_DataDictionary integer liField string lsFieldvalue Returns Integer
44213>>>>>>>>>>>>>>>        String  sName lsAnoep lsGplan_Code
44214>>>>>>>>>>>>>>>        Integer iMainFile liGplanRecnum liReturnVal liReturnValb liBathmos1
44214>>>>>>>>>>>>>>>        String lsValidChar lsDelimiter
44214>>>>>>>>>>>>>>>
44214>>>>>>>>>>>>>>>        Get Main_File to iMainFile
44215>>>>>>>>>>>>>>>        Get_Attribute DF_FIELD_NAME of iMainFile liField to sName
44218>>>>>>>>>>>>>>>
44218>>>>>>>>>>>>>>>        If (sName = 'GPLAN_CODE') Begin
44220>>>>>>>>>>>>>>>            move (trim(lsFieldvalue)) to lsFieldvalue //from deo
44221>>>>>>>>>>>>>>>            if (lsFieldvalue <>  "") begin //new
44223>>>>>>>>>>>>>>>                Move SyscurGL.Year_Valid_Char to lsValidChar
44224>>>>>>>>>>>>>>>                Move SyscurGL.Year_Delimiter  to lsDelimiter
44225>>>>>>>>>>>>>>>                Move (fiCheckValidChars(Self,lsFieldvalue,((Trim(lsValidChar))+(Trim(lsDelimiter))))) to liReturnVal
44226>>>>>>>>>>>>>>>                if (liReturnVal = '1001') begin
44228>>>>>>>>>>>>>>>                               error liReturnVal ("‹ž ˜§¦›œ¡«æª ®˜¨˜¡«ã¨˜ª š ˜ ¡à› ¡æ Š.‘ !\n\n€§¦›œ¡«¦å ®˜¨˜¡«ã¨œª : '" + (psValidChars(Self)) + "'")
44229>>>>>>>>>>>>>>>>
44229>>>>>>>>>>>>>>>                               Function_Return liReturnVal
44230>>>>>>>>>>>>>>>                            end
44230>>>>>>>>>>>>>>>>
44230>>>>>>>>>>>>>>>
44230>>>>>>>>>>>>>>>                Move (private_Man_Gplan_Code(self,liField,lsFieldvalue,0)) to liReturnVal
44231>>>>>>>>>>>>>>>                if (lireturnval <> 0) begin
44233>>>>>>>>>>>>>>>                                        error 127 ("ŠáŸ¦ª £¦¨­ã ¡à› ¡¦ç !\n\n"+Gplan.Gplan_Code)
44234>>>>>>>>>>>>>>>>
44234>>>>>>>>>>>>>>>                                        function_return 127
44235>>>>>>>>>>>>>>>                                      end
44235>>>>>>>>>>>>>>>>
44235>>>>>>>>>>>>>>>
44235>>>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_Code to lsGplan_Code
44236>>>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_Bathmos to liBathmos1
44237>>>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_anoep to lsAnoep
44238>>>>>>>>>>>>>>>                Move (fiBackward_Check(self,lsGplan_Code,liBathmos1)) to liReturnValb
44239>>>>>>>>>>>>>>>                if (liReturnValb = '7001') begin
44241>>>>>>>>>>>>>>>                                               error 7001 "ƒœ¤ ¬§á¨®œ  ¦ §œ¨ ¢ž§« ¡æª ™˜Ÿ£æª !"
44242>>>>>>>>>>>>>>>>
44242>>>>>>>>>>>>>>>                                               Function_Return 8001
44243>>>>>>>>>>>>>>>                                            end
44243>>>>>>>>>>>>>>>>
44243>>>>>>>>>>>>>>>                if (liReturnValb = '7002') begin
44245>>>>>>>>>>>>>>>                                               error 7002 "“§á¨®œ  ¡à› ¡æª «œ¢œ¬«˜å¦¬ ™˜Ÿ£¦ç !"
44246>>>>>>>>>>>>>>>>
44246>>>>>>>>>>>>>>>                                               Function_Return 8002
44247>>>>>>>>>>>>>>>                                          end
44247>>>>>>>>>>>>>>>>
44247>>>>>>>>>>>>>>>                if (liReturnValb = '7003') begin
44249>>>>>>>>>>>>>>>                                               error 7003 "Ž §¨¦žš¦ç£œ¤¦ª œå¤˜  «œ¢œ¬«˜å¦¬ ™˜Ÿ£¦ç !"
44250>>>>>>>>>>>>>>>>
44250>>>>>>>>>>>>>>>                                               Function_Return 8003
44251>>>>>>>>>>>>>>>                                          end
44251>>>>>>>>>>>>>>>>
44251>>>>>>>>>>>>>>>
44251>>>>>>>>>>>>>>>                Move (fiForward_Check(self,lsGplan_Code,0)) to liReturnValb
44252>>>>>>>>>>>>>>>                if (liReturnValb = '7004') begin
44254>>>>>>>>>>>>>>>                                               error 7004 "“§á¨®œ  ¦ ˜¤é«œ¨¦ª ™˜Ÿ£æª !"
44255>>>>>>>>>>>>>>>>
44255>>>>>>>>>>>>>>>                                               Function_Return 8004
44256>>>>>>>>>>>>>>>                                            end
44256>>>>>>>>>>>>>>>>
44256>>>>>>>>>>>>>>>
44256>>>>>>>>>>>>>>>            end
44256>>>>>>>>>>>>>>>>
44256>>>>>>>>>>>>>>>            else Function_Return 0  //exit function ok!!!
44258>>>>>>>>>>>>>>>         end
44258>>>>>>>>>>>>>>>>
44258>>>>>>>>>>>>>>>         function_return 0
44259>>>>>>>>>>>>>>>    End_Function   // fiValidateGplanFields
44260>>>>>>>>>>>>>>>
44260>>>>>>>>>>>>>>>
44260>>>>>>>>>>>>>>>//-----------------------------------------------Save Operation ----------------------------------------------------
44260>>>>>>>>>>>>>>>
44260>>>>>>>>>>>>>>>
44260>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
44261>>>>>>>>>>>>>>>        //Forward Send Operation_Not_Allowed  iError_Num
44261>>>>>>>>>>>>>>>        // Insert Code Here
44261>>>>>>>>>>>>>>>                 if iError_num eq 127  error 127 ((Trim(Gplan.Gplan_Code))+" Wrong Format !!!! \n\n")
44264>>>>>>>>>>>>>>>            Else if iError_num eq 128  error 128 ("Not a valid Data Entry.  Account is Missing !!!!\n\n"+Gplan.Gplan_Code)
44268>>>>>>>>>>>>>>>            Else if iError_num eq 129  error 129 ("Not a valid Data Entry.  Bathmos is Missing !!!!\n\n"+Gplan.Gplan_Code)
44272>>>>>>>>>>>>>>>            Else if iError_num eq 130  error 130 ("Not a valid Data Entry.  Previews Account is Missing !!!!\n\n"+Gplan.Gplan_Code)
44276>>>>>>>>>>>>>>>            Else if iError_num eq 1100  error 1100 "DDC:150 - ‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
44280>>>>>>>>>>>>>>>            Else if iError_num eq 2100  error 2100 "DDC:150 - ‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
44284>>>>>>>>>>>>>>>            Else if iError_num eq 7001 error 8001 ("Anoep Does not Exist !!!!\n\n"+Gplan.Gplan_Code)
44288>>>>>>>>>>>>>>>            Else if iError_num eq 7002 error 8002 ("Last Exists\n\n!!!! "+Gplan.Gplan_Code)
44292>>>>>>>>>>>>>>>            Else if iError_num eq 7003 error 8003 ("Previous batmos is last  !!!!\n\n"+Gplan.Gplan_Code)
44296>>>>>>>>>>>>>>>            Else if iError_num eq 7004 error 8004 ("Greater bathmos exists  !!!!\n\n"+Gplan.Gplan_Code)
44300>>>>>>>>>>>>>>>            Else if iError_num eq 7010 error 7010 ("Greater bathmos exists  !!!!\n\n"+Gplan.Gplan_Code)
44304>>>>>>>>>>>>>>>            Else if (iError_num = 1001) error 1001 ("‹ž ˜§¦›œ¡«æª ®˜¨˜¡«ã¨˜ª š ˜ ¡à› ¡æ Š.‘ !\n\n€§¦›œ¡«¦å ®˜¨˜¡«ã¨œª : '" + (psValidChars(Self)) + "'")
44308>>>>>>>>>>>>>>>            Else Forward Send Operation_Not_Allowed  iError_Num
44311>>>>>>>>>>>>>>>    End_Procedure
44312>>>>>>>>>>>>>>>
44312>>>>>>>>>>>>>>>
44312>>>>>>>>>>>>>>>    Procedure Clear_From_Bpo
44313>>>>>>>>>>>>>>>        Clear Gplan
44314>>>>>>>>>>>>>>>    End_Procedure
44315>>>>>>>>>>>>>>>
44315>>>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
44316>>>>>>>>>>>>>>>        Local Integer iReturnVal iField##
44317>>>>>>>>>>>>>>>        locaL string lsVal##
44317>>>>>>>>>>>>>>>
44317>>>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
44319>>>>>>>>>>>>>>>
44319>>>>>>>>>>>>>>>
44319>>>>>>>>>>>>>>>        If (Not(iReturnVal))Begin
44321>>>>>>>>>>>>>>>        //    If (Not(Current_Record(Self))) Move (fiCheckValidChars(Self,Gplan.Gplan_Code,((Trim(Year.Year_Valid_Char))+(Trim(Year.Year_Delimiter))))) to iReturnVal
44321>>>>>>>>>>>>>>>        //    If (iReturnVal) Send Operation_Not_Allowed iReturnVal
44321>>>>>>>>>>>>>>>            If (Gplan.Gplan_Code    = "") Send Operation_Not_Allowed 128
44324>>>>>>>>>>>>>>>            If (Gplan.Gplan_Bathmos = 0 ) Send Operation_Not_Allowed 129
44327>>>>>>>>>>>>>>>            If (;                 (Gplan.Gplan_Bathmos <> 1) and;                 (Gplan.Gplan_Anoep = "");               ) Send Operation_Not_Allowed 130
44330>>>>>>>>>>>>>>>            For iField## from 4 to 4   // Field number for Starting and Ending pp's ???????
44336>>>>>>>>>>>>>>>>
44336>>>>>>>>>>>>>>>
44336>>>>>>>>>>>>>>>                Move (private_Man_Gplan_Code(self,iField##,Gplan.Gplan_Code,1))     to iReturnVal
44337>>>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
44340>>>>>>>>>>>>>>>
44340>>>>>>>>>>>>>>>                Move (fiBACKWARD_CHECK(self,Gplan.Gplan_Code,Gplan.Gplan_Bathmos)) to iReturnVal
44341>>>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
44344>>>>>>>>>>>>>>>
44344>>>>>>>>>>>>>>>                Move (fiFORWARD_CHECK(self,Gplan.Gplan_Code,0))                     to iReturnVal
44345>>>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
44348>>>>>>>>>>>>>>>
44348>>>>>>>>>>>>>>>            Loop
44349>>>>>>>>>>>>>>>>
44349>>>>>>>>>>>>>>>              //1100:cby = globals
44349>>>>>>>>>>>>>>>              If ( ;                   (Not(Gplan.Company_Code = SysCurGL.Company_Code)) or;                   (Not(Gplan.Branch_Code  = SysCurGL.Branch_Code )) ;                  ) Send Operation_Not_Allowed 1100
44352>>>>>>>>>>>>>>>        End
44352>>>>>>>>>>>>>>>>
44352>>>>>>>>>>>>>>>        Function_Return iReturnVal
44353>>>>>>>>>>>>>>>    End_Function
44354>>>>>>>>>>>>>>>
44354>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
44355>>>>>>>>>>>>>>>        Local Integer iReturnVal liReturnValb##
44356>>>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
44358>>>>>>>>>>>>>>>
44358>>>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
44360>>>>>>>>>>>>>>>            // Insert Code Here
44360>>>>>>>>>>>>>>>               Move (fiFORWARD_CHECK(Self,Gplan.Gplan_Code,1)) to liReturnValb##
44361>>>>>>>>>>>>>>>               If (liReturnValb##>1) Send Operation_Not_Allowed liReturnValb##
44364>>>>>>>>>>>>>>>              //2100:cby = globals
44364>>>>>>>>>>>>>>>              If ( ;                   (Not(Gplan.Company_Code = SysCurGL.Company_Code)) or;                   (Not(Gplan.Branch_Code  = SysCurGL.Branch_Code )) ;                  ) Send Operation_Not_Allowed 2100
44367>>>>>>>>>>>>>>>        End
44367>>>>>>>>>>>>>>>>
44367>>>>>>>>>>>>>>>
44367>>>>>>>>>>>>>>>        Function_Return iReturnVal
44368>>>>>>>>>>>>>>>    End_Function
44369>>>>>>>>>>>>>>>
44369>>>>>>>>>>>>>>>
44369>>>>>>>>>>>>>>>//    Procedure Update
44369>>>>>>>>>>>>>>>//        Forward Send Update
44369>>>>>>>>>>>>>>>//        // Insert Code Here
44369>>>>>>>>>>>>>>>//        Move Company.Company_Code  to Gplan.Company_Code
44369>>>>>>>>>>>>>>>//        Move Branch.Branch_Code    to Gplan.Branch_Code
44369>>>>>>>>>>>>>>>//        Move Year.Year_Year        to Gplan.Year_Year
44369>>>>>>>>>>>>>>>//        Add 1 to Year.Year_NumGplan //˜¨ Ÿ£æª ¢¦š˜¨ ˜©£é¤ «žª ®¨ã©žª
44369>>>>>>>>>>>>>>>//    End_Procedure   // Update
44369>>>>>>>>>>>>>>>
44369>>>>>>>>>>>>>>>//    Procedure Backout
44369>>>>>>>>>>>>>>>//        Forward Send Backout
44369>>>>>>>>>>>>>>>//        Sub 1 from Year.Year_NumGplan //˜¨ Ÿ£æª ¢¦š˜¨ ˜©£é¤ «žª ®¨ã©žª
44369>>>>>>>>>>>>>>>//    End_Procedure //deleting
44369>>>>>>>>>>>>>>>
44369>>>>>>>>>>>>>>>
44369>>>>>>>>>>>>>>>
44369>>>>>>>>>>>>>>>    // Define_Fields:
44369>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44369>>>>>>>>>>>>>>>
44369>>>>>>>>>>>>>>>    Procedure Define_Fields
44370>>>>>>>>>>>>>>>        Forward Send Define_Fields
44372>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44372>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
44372>>>>>>>>>>>>>>>
44372>>>>>>>>>>>>>>>        Set Main_File            To Gplan.File_Number
44373>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
44374>>>>>>>>>>>>>>>
44374>>>>>>>>>>>>>>>
44374>>>>>>>>>>>>>>>        // Child (Client) file structure................
44374>>>>>>>>>>>>>>>        Send Add_Client_File  Gmovea.File_Number
44375>>>>>>>>>>>>>>>        Send Add_Client_File  Gplanmod.File_Number
44376>>>>>>>>>>>>>>>        Send Add_Client_File  Gmhnes.File_Number
44377>>>>>>>>>>>>>>>        Send Add_Client_File  Gvatd.File_Number
44378>>>>>>>>>>>>>>>        Send Add_Client_File  Gpmoves.File_Number
44379>>>>>>>>>>>>>>>
44379>>>>>>>>>>>>>>>        // External (System) file structure.............
44379>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
44380>>>>>>>>>>>>>>>        Send Add_System_File  Syscurgl.File_Number  DD_LOCK_ON_ALL
44381>>>>>>>>>>>>>>>
44381>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gplan_Rec0  To Gplan.Gplan_Rec0
44384>>>>>>>>>>>>>>>
44384>>>>>>>>>>>>>>>        // Field-based properties.......................
44384>>>>>>>>>>>>>>>
44384>>>>>>>>>>>>>>>        // Gplan.Company_Code
44384>>>>>>>>>>>>>>>
44384>>>>>>>>>>>>>>>        // Gplan.Branch_Code
44384>>>>>>>>>>>>>>>
44384>>>>>>>>>>>>>>>        // Gplan.Year_Year
44384>>>>>>>>>>>>>>>
44384>>>>>>>>>>>>>>>        // Gplan.Gplan_Code
44384>>>>>>>>>>>>>>>        Set Field_Exit_msg         Field Gplan.Gplan_Code To get_fiValidateGplanFields
44385>>>>>>>>>>>>>>>        Set Field_Options          Field Gplan.Gplan_Code To DD_AUTOFIND    DD_REQUIRED   
44386>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Code To (sl150(Self))
44387>>>>>>>>>>>>>>>
44387>>>>>>>>>>>>>>>        // Gplan.Gplan_Rec0
44387>>>>>>>>>>>>>>>
44387>>>>>>>>>>>>>>>        // Gplan.Year_Recr
44387>>>>>>>>>>>>>>>
44387>>>>>>>>>>>>>>>        // Gplan.Gplan_Descr1
44387>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Descr1 To (sl150(Self))
44388>>>>>>>>>>>>>>>
44388>>>>>>>>>>>>>>>        // Gplan.Gplan_Descr2
44388>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Descr2 To (sl150(Self))
44389>>>>>>>>>>>>>>>
44389>>>>>>>>>>>>>>>        // Gplan.Gplan_Bathmos
44389>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Bathmos To "Calulated"
44389>>>>>>>>>>>>>>>
44389>>>>>>>>>>>>>>>        // Gplan.Gplan_Anoep
44389>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Anoep To "Calulated"
44389>>>>>>>>>>>>>>>
44389>>>>>>>>>>>>>>>        // Gplan.Gplan_O_Code
44389>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_O_Code To "dbComboFormSub"
44390>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_O_Code To (Gplan_Gplan_O_Code_VT(Self))
44391>>>>>>>>>>>>>>>
44391>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Xfer
44391>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Xfer To "dbComboFormSub"
44392>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Xfer To (Gplan_Gplan_Yn_VT(Self))
44393>>>>>>>>>>>>>>>
44393>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Last
44393>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Last To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1013)"
44393>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Last To "dbComboFormSub"
44394>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Last To (Gplan_Gplan_Yn_VT(Self))
44395>>>>>>>>>>>>>>>
44395>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Kin
44395>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Kin To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1014)"
44395>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Kin To "dbComboFormSub"
44396>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Kin To (Gplan_Gplan_Yn_VT(Self))
44397>>>>>>>>>>>>>>>
44397>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Kk
44397>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Kk To "dbComboFormSub"
44398>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Kk To (Gplan_Gplan_Yn_VT(Self))
44399>>>>>>>>>>>>>>>
44399>>>>>>>>>>>>>>>        // Gplan.Gplan_Xpm
44399>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Xpm To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1015+1016)"
44399>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Xpm To "dbComboFormSub"
44400>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Xpm To (Gplan_Gplan_Xpm_VT(Self))
44401>>>>>>>>>>>>>>>
44401>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Xy
44401>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Xy To "•¨ž© £¦§¦ œå«˜  ©«ž¤ private.trexe «¦¬ Gmove (1017)"
44401>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Xy To "dbComboFormSub"
44402>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Xy To (Gplan_Gplan_Yn_VT(Self))
44403>>>>>>>>>>>>>>>
44403>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Py
44403>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Py To "•¨ž© £¦§¦ œå«˜  ©«ž¤ private.trexe «¦¬ Gmove (1018)"
44403>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Py To "dbComboFormSub"
44404>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Py To (Gplan_Gplan_Yn_VT(Self))
44405>>>>>>>>>>>>>>>
44405>>>>>>>>>>>>>>>        // Gplan.Gplan_Fpaent
44405>>>>>>>>>>>>>>>
44405>>>>>>>>>>>>>>>        // Gplan.Gplan_Fpaent_Yn
44405>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Fpaent_Yn To (Gplan_Gplan_Yn_VT(Self))
44406>>>>>>>>>>>>>>>
44406>>>>>>>>>>>>>>>        // Gplan.Gplan_Afm
44406>>>>>>>>>>>>>>>
44406>>>>>>>>>>>>>>>        // Gplan.Gplan_Addr
44406>>>>>>>>>>>>>>>
44406>>>>>>>>>>>>>>>        // Gplan.Gplan_Tk
44406>>>>>>>>>>>>>>>
44406>>>>>>>>>>>>>>>        // Gplan.Gplan_Poli
44406>>>>>>>>>>>>>>>
44406>>>>>>>>>>>>>>>        // Gplan.Gplan_Doy
44406>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Doy To "dbComboFormSub"
44407>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Doy To (Gplan_Gplan_Doy_VT(Self))
44408>>>>>>>>>>>>>>>
44408>>>>>>>>>>>>>>>        // Gplan.Gplan_J_Code
44408>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_J_Code To "dbComboFormSub"
44409>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_J_Code To (Gplan_Gplan_J_Code_VT(Self))
44410>>>>>>>>>>>>>>>
44410>>>>>>>>>>>>>>>        // Gplan.Gplan_C_Code2
44410>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_C_Code2 To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1019)"
44410>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_C_Code2 To "dbComboFormSub"
44411>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_C_Code2 To (Gplan_Gplan_C_Code2_VT(Self))
44412>>>>>>>>>>>>>>>
44412>>>>>>>>>>>>>>>        // Gplan.Gplan_Tel
44412>>>>>>>>>>>>>>>
44412>>>>>>>>>>>>>>>        // Gplan.Gplan_Email
44412>>>>>>>>>>>>>>>
44412>>>>>>>>>>>>>>>        // Gplan.Gplan_Resp
44412>>>>>>>>>>>>>>>
44412>>>>>>>>>>>>>>>        // Gplan.Gplan_Bitmap
44412>>>>>>>>>>>>>>>
44412>>>>>>>>>>>>>>>        // Gplan.Gplan_Rep_Code
44412>>>>>>>>>>>>>>>
44412>>>>>>>>>>>>>>>        // Gplan.Gplan_Rep_Pct
44412>>>>>>>>>>>>>>>
44412>>>>>>>>>>>>>>>        // Gplan.Gplan_I_Xy_Code
44412>>>>>>>>>>>>>>>
44412>>>>>>>>>>>>>>>        // Gplan.Gplan_I_Py_Code
44412>>>>>>>>>>>>>>>
44412>>>>>>>>>>>>>>>        // Gplan.Gplan_I_Ctypkin
44412>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_I_Ctypkin To (Gtypkin(Self))
44413>>>>>>>>>>>>>>>
44413>>>>>>>>>>>>>>>        // Gplan.Gplan_I_A_Code
44413>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_I_A_Code To "dbComboFormSub"
44414>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_I_A_Code To (Gplan_Gplan_I_A_Code_VT2(Self))
44415>>>>>>>>>>>>>>>
44415>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Myfp
44415>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Myfp To "dbComboFormSub"
44416>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Myfp To (Gplan_Gplan_Yn_VT(Self))
44417>>>>>>>>>>>>>>>
44417>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Myfa
44417>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Myfa To "dbComboFormSub"
44418>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Myfa To (Gplan_Gplan_Yn_VT(Self))
44419>>>>>>>>>>>>>>>
44419>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfnump
44419>>>>>>>>>>>>>>>
44419>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfvalp
44419>>>>>>>>>>>>>>>
44419>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfnuma
44419>>>>>>>>>>>>>>>
44419>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfvala
44419>>>>>>>>>>>>>>>
44419>>>>>>>>>>>>>>>        // Gplan.Gplan_Myf_Sump
44419>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Myf_Sump To "‰˜Ÿ¦¨åœ  œá¤ ¦  ®¨œé©œ ª/§ ©«é©œ ª Ÿ˜ ˜Ÿ¨¦ ©«¦ç¤ ©«ž¤ ‹“”"
44419>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Myf_Sump To "dbComboFormSub"
44420>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Myf_Sump To (Gplan_Gplan_Myf_Sum_VT(Self))
44421>>>>>>>>>>>>>>>
44421>>>>>>>>>>>>>>>        // Gplan.Gplan_Myf_Suma
44421>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Myf_Suma To "dbComboFormSub"
44422>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Myf_Suma To (Gplan_Gplan_Myf_Sum_VT(Self))
44423>>>>>>>>>>>>>>>
44423>>>>>>>>>>>>>>>        // Gplan.Gplan_Sx0
44423>>>>>>>>>>>>>>>
44423>>>>>>>>>>>>>>>        // Gplan.Gplan_Sp0
44423>>>>>>>>>>>>>>>
44423>>>>>>>>>>>>>>>        // Gplan.Gplan_Sx00
44423>>>>>>>>>>>>>>>
44423>>>>>>>>>>>>>>>        // Gplan.Gplan_Sp00
44423>>>>>>>>>>>>>>>
44423>>>>>>>>>>>>>>>        // Gplan.Gplan_Sxr
44423>>>>>>>>>>>>>>>
44423>>>>>>>>>>>>>>>        // Gplan.Gplan_Spr
44423>>>>>>>>>>>>>>>
44423>>>>>>>>>>>>>>>        // Gplan.Gplan_Sx2
44423>>>>>>>>>>>>>>>
44423>>>>>>>>>>>>>>>        // Gplan.Gplan_Sp2
44423>>>>>>>>>>>>>>>
44423>>>>>>>>>>>>>>>        // Gplan.Gplan_Gmhnnorec
44423>>>>>>>>>>>>>>>
44423>>>>>>>>>>>>>>>        // Gplan.Gplan_Recr
44423>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Recr To (sl150(Self))
44424>>>>>>>>>>>>>>>
44424>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
44424>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
44425>>>>>>>>>>>>>>>
44425>>>>>>>>>>>>>>>    // Field_Defaults:
44425>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
44425>>>>>>>>>>>>>>>
44425>>>>>>>>>>>>>>>    Procedure Field_Defaults
44426>>>>>>>>>>>>>>>        Forward Send Field_Defaults
44428>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44428>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
44428>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Xfer To 0
44429>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Last To 0
44430>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Kin To 1
44431>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Kk To 0
44432>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Xpm To 3
44433>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Xy To 1
44434>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Py To 1
44435>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Fpaent_Yn To 0
44436>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Rep_Pct To 100
44437>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Myfp To 0
44438>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Myfa To 0
44439>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
44439>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
44440>>>>>>>>>>>>>>>End_Class    // Gplan_DataDictionary
44441>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
44441>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>Use sl150.sl         // sl150
44441>>>>>>>>>>>>>>>Use Gtypkin.sl       // Gtypkin
INCLUDING FILE: GTYPKIN.SL
44441>>>>>>>>>>>>>>>>>//AB/ Project gtypkin:Gtypkin
44441>>>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
44441>>>>>>>>>>>>>>>>>//AB/         Set ProjectName to "gtypkin:Gtypkin"
44441>>>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "gtypkin.SL"
44441>>>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>>>// Project Object Structure
44441>>>>>>>>>>>>>>>>>//   gtypkin is a dbModalPanel
44441>>>>>>>>>>>>>>>>>//     Gthhmgio_DD is a DataDictionary
44441>>>>>>>>>>>>>>>>>//     Gtypkin_DD is a DataDictionary
44441>>>>>>>>>>>>>>>>>//     oSelList is a dbList
44441>>>>>>>>>>>>>>>>>//     oOK_bn is a Button
44441>>>>>>>>>>>>>>>>>//     oCancel_bn is a Button
44441>>>>>>>>>>>>>>>>>//     oSearch_bn is a Button
44441>>>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>>>// Register all objects
44441>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_DD
44441>>>>>>>>>>>>>>>>>Register_Object Gtypkin_DD
44441>>>>>>>>>>>>>>>>>Register_Object gtypkin
44441>>>>>>>>>>>>>>>>>Register_Object oCancel_bn
44441>>>>>>>>>>>>>>>>>Register_Object oOK_bn
44441>>>>>>>>>>>>>>>>>Register_Object oSearch_bn
44441>>>>>>>>>>>>>>>>>Register_Object oSelList
44441>>>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>>>    //AB-IgnoreStart
44441>>>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
44441>>>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>>>    Use GTHHMGIO.DD
INCLUDING FILE: GTHHMGIO.DD
44441>>>>>>>>>>>>>>>>>>>//DDB-FileStart
44441>>>>>>>>>>>>>>>>>>>//DDB-HeaderStart
44441>>>>>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>>>>>// File Name : GTHHMGIO.DD
44441>>>>>>>>>>>>>>>>>>>// Class Name: Gthhmgio_DataDictionary
44441>>>>>>>>>>>>>>>>>>>// Revision  : 33
44441>>>>>>>>>>>>>>>>>>>// Version   : 2
44441>>>>>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
44441>>>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
44441>>>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
44441>>>>>>>>>>>>>>>>>>>
44441>>>>>>>>>>>>>>>>>>>Open Gthhmgio
INCLUDING FILE: GTHHMGIO.FD
44443>>>>>>>>>>>>>>>>>>>Open Gtypkin
44445>>>>>>>>>>>>>>>>>>>Open Gthaa
INCLUDING FILE: GTHAA.FD
44447>>>>>>>>>>>>>>>>>>>Open Sysrecg
44449>>>>>>>>>>>>>>>>>>>
44449>>>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
44449>>>>>>>>>>>>>>>>>>>//DDB-ValidationStart
44449>>>>>>>>>>>>>>>>>>>
44449>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_Gthhmgio_Period_VT
44449>>>>>>>>>>>>>>>>>>>
44449>>>>>>>>>>>>>>>>>>>Object Gthhmgio_Gthhmgio_Period_VT  is a CodeValidationTable
44451>>>>>>>>>>>>>>>>>>>    Set Type_Value        To "PERIOD"
44452>>>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
44452>>>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
44452>>>>>>>>>>>>>>>>>>>End_Object   // Gthhmgio_Gthhmgio_Period_VT
44453>>>>>>>>>>>>>>>>>>>//DDB-ValidationEnd
44453>>>>>>>>>>>>>>>>>>>//DDB-SelectionStart
44453>>>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList Gthhmgio  Gthhmgio.SL
44453>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio
44453>>>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
44453>>>>>>>>>>>>>>>>>>>
44453>>>>>>>>>>>>>>>>>>>Class Gthhmgio_DataDictionary  is a DataDictionary_Sec
44454>>>>>>>>>>>>>>>>>>>
44454>>>>>>>>>>>>>>>>>>>
44454>>>>>>>>>>>>>>>>>>>    // Define_Fields:
44454>>>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44454>>>>>>>>>>>>>>>>>>>
44454>>>>>>>>>>>>>>>>>>>    Procedure Define_Fields
44455>>>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
44457>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44457>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
44457>>>>>>>>>>>>>>>>>>>
44457>>>>>>>>>>>>>>>>>>>        Set Main_File            To Gthhmgio.File_Number
44458>>>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
44459>>>>>>>>>>>>>>>>>>>
44459>>>>>>>>>>>>>>>>>>>
44459>>>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
44459>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gtypkin.File_Number
44460>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gthaa.File_Number
44461>>>>>>>>>>>>>>>>>>>
44461>>>>>>>>>>>>>>>>>>>        // External (System) file structure.............
44461>>>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
44462>>>>>>>>>>>>>>>>>>>
44462>>>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gthhmgio_Rec0  To Gthhmgio.Gthhmgio_Rec0
44465>>>>>>>>>>>>>>>>>>>
44465>>>>>>>>>>>>>>>>>>>        // Field-based properties.......................
44465>>>>>>>>>>>>>>>>>>>
44465>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Code
44465>>>>>>>>>>>>>>>>>>>        Set Field_Options          Field Gthhmgio.Gthhmgio_Code To DD_AUTOFIND   
44466>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gthhmgio.Gthhmgio_Code To (Gthhmgio(Self))
44467>>>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Gthhmgio.Gthhmgio_Code To TRUE
44468>>>>>>>>>>>>>>>>>>>
44468>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Rec0
44468>>>>>>>>>>>>>>>>>>>
44468>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Descr
44468>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gthhmgio.Gthhmgio_Descr To (Gthhmgio(Self))
44469>>>>>>>>>>>>>>>>>>>
44469>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Period
44469>>>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gthhmgio.Gthhmgio_Period To (Gthhmgio_Gthhmgio_Period_VT(Self))
44470>>>>>>>>>>>>>>>>>>>
44470>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Recr
44470>>>>>>>>>>>>>>>>>>>        Set Field_Options          Field Gthhmgio.Gthhmgio_Recr To DD_AUTOFIND   
44471>>>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Gthhmgio.Gthhmgio_Recr To TRUE
44472>>>>>>>>>>>>>>>>>>>
44472>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
44472>>>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
44473>>>>>>>>>>>>>>>>>>>
44473>>>>>>>>>>>>>>>>>>>    // Field_Defaults:
44473>>>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
44473>>>>>>>>>>>>>>>>>>>
44473>>>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
44474>>>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
44476>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44476>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
44476>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
44476>>>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
44477>>>>>>>>>>>>>>>>>>>End_Class    // Gthhmgio_DataDictionary
44478>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
44478>>>>>>>>>>>>>>>>>>>
44478>>>>>>>>>>>>>>>>>>>Use Gthhmgio.SL      // Gthhmgio
INCLUDING FILE: GTHHMGIO.SL
44478>>>>>>>>>>>>>>>>>>>>>//AB/ Project Gthhmgio:Gthhmgio
44478>>>>>>>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
44478>>>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectName to "Gthhmgio:Gthhmgio"
44478>>>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "Gthhmgio.SL"
44478>>>>>>>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
44478>>>>>>>>>>>>>>>>>>>>>
44478>>>>>>>>>>>>>>>>>>>>>// Project Object Structure
44478>>>>>>>>>>>>>>>>>>>>>//   Gthhmgio is a dbModalPanel
44478>>>>>>>>>>>>>>>>>>>>>//     Gthhmgio_DD is a DataDictionary
44478>>>>>>>>>>>>>>>>>>>>>//     oSelList is a dbList
44478>>>>>>>>>>>>>>>>>>>>>//     oOK_bn is a Button
44478>>>>>>>>>>>>>>>>>>>>>//     oCancel_bn is a Button
44478>>>>>>>>>>>>>>>>>>>>>//     oSearch_bn is a Button
44478>>>>>>>>>>>>>>>>>>>>>
44478>>>>>>>>>>>>>>>>>>>>>// Register all objects
44478>>>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_DD
44478>>>>>>>>>>>>>>>>>>>>>Register_Object oCancel_bn
44478>>>>>>>>>>>>>>>>>>>>>Register_Object oOK_bn
44478>>>>>>>>>>>>>>>>>>>>>Register_Object oSearch_bn
44478>>>>>>>>>>>>>>>>>>>>>Register_Object oSelList
44478>>>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio
44478>>>>>>>>>>>>>>>>>>>>>
44478>>>>>>>>>>>>>>>>>>>>>
44478>>>>>>>>>>>>>>>>>>>>>    //AB-IgnoreStart
44478>>>>>>>>>>>>>>>>>>>>>
44478>>>>>>>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
44478>>>>>>>>>>>>>>>>>>>>>
44478>>>>>>>>>>>>>>>>>>>>>
44478>>>>>>>>>>>>>>>>>>>>>    Use GTHHMGIO.DD
44478>>>>>>>>>>>>>>>>>>>>>
44478>>>>>>>>>>>>>>>>>>>>>    //AB-IgnoreEnd
44478>>>>>>>>>>>>>>>>>>>>>
44478>>>>>>>>>>>>>>>>>>>>>    CD_Popup_Object Gthhmgio is a dbModalPanel
44497>>>>>>>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
44498>>>>>>>>>>>>>>>>>>>>>        Set Label to "Šå©«˜ †£œ¨¦¢¦šåà¤"
44499>>>>>>>>>>>>>>>>>>>>>        Set Size to 148 297
44500>>>>>>>>>>>>>>>>>>>>>        Set Location to 4 5
44501>>>>>>>>>>>>>>>>>>>>>
44501>>>>>>>>>>>>>>>>>>>>>        //AB-DDOStart
44501>>>>>>>>>>>>>>>>>>>>>
44501>>>>>>>>>>>>>>>>>>>>>        Object Gthhmgio_DD is a Gthhmgio_DataDictionary
44503>>>>>>>>>>>>>>>>>>>>>        End_Object    // Gthhmgio_DD
44504>>>>>>>>>>>>>>>>>>>>>
44504>>>>>>>>>>>>>>>>>>>>>        Set Main_DD to (Gthhmgio_DD(self))
44505>>>>>>>>>>>>>>>>>>>>>        Set Server to (Gthhmgio_DD(self))
44506>>>>>>>>>>>>>>>>>>>>>
44506>>>>>>>>>>>>>>>>>>>>>        //AB-DDOEnd
44506>>>>>>>>>>>>>>>>>>>>>
44506>>>>>>>>>>>>>>>>>>>>>        Object oSelList is a dbList
44508>>>>>>>>>>>>>>>>>>>>>            Set Main_File to Gthhmgio.File_Number
44509>>>>>>>>>>>>>>>>>>>>>            Set Size to 105 280
44510>>>>>>>>>>>>>>>>>>>>>            Set Location to 6 6
44511>>>>>>>>>>>>>>>>>>>>>
44511>>>>>>>>>>>>>>>>>>>>>            Begin_Row
44514>>>>>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_code
44515>>>>>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_descr
44516>>>>>>>>>>>>>>>>>>>>>            End_Row
44521>>>>>>>>>>>>>>>>>>>>>
44521>>>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 52
44522>>>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
44523>>>>>>>>>>>>>>>>>>>>>
44523>>>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 220
44524>>>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
44525>>>>>>>>>>>>>>>>>>>>>
44525>>>>>>>>>>>>>>>>>>>>>        End_Object    // oSelList
44526>>>>>>>>>>>>>>>>>>>>>
44526>>>>>>>>>>>>>>>>>>>>>        Object oOK_bn is a Button
44528>>>>>>>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
44529>>>>>>>>>>>>>>>>>>>>>            Set Location to 111 127
44530>>>>>>>>>>>>>>>>>>>>>
44530>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
44530>>>>>>>>>>>>>>>>>>>>>            Procedure OnClick
44532>>>>>>>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
44533>>>>>>>>>>>>>>>>>>>>>            End_Procedure
44534>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
44534>>>>>>>>>>>>>>>>>>>>>
44534>>>>>>>>>>>>>>>>>>>>>        End_Object    // oOK_bn
44535>>>>>>>>>>>>>>>>>>>>>
44535>>>>>>>>>>>>>>>>>>>>>        Object oCancel_bn is a Button
44537>>>>>>>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
44538>>>>>>>>>>>>>>>>>>>>>            Set Location to 111 181
44539>>>>>>>>>>>>>>>>>>>>>
44539>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
44539>>>>>>>>>>>>>>>>>>>>>            Procedure OnClick
44541>>>>>>>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
44542>>>>>>>>>>>>>>>>>>>>>            End_Procedure
44543>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
44543>>>>>>>>>>>>>>>>>>>>>
44543>>>>>>>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
44544>>>>>>>>>>>>>>>>>>>>>
44544>>>>>>>>>>>>>>>>>>>>>        Object oSearch_bn is a Button
44546>>>>>>>>>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
44547>>>>>>>>>>>>>>>>>>>>>            Set Location to 111 237
44548>>>>>>>>>>>>>>>>>>>>>
44548>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
44548>>>>>>>>>>>>>>>>>>>>>            Procedure OnClick
44550>>>>>>>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
44551>>>>>>>>>>>>>>>>>>>>>            End_Procedure
44552>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
44552>>>>>>>>>>>>>>>>>>>>>
44552>>>>>>>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
44553>>>>>>>>>>>>>>>>>>>>>
44553>>>>>>>>>>>>>>>>>>>>>
44553>>>>>>>>>>>>>>>>>>>>>        //AB-StoreStart
44553>>>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
44554>>>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
44555>>>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
44556>>>>>>>>>>>>>>>>>>>>>        //AB-StoreEnd
44556>>>>>>>>>>>>>>>>>>>>>
44556>>>>>>>>>>>>>>>>>>>>>    CD_End_Object    // Gthhmgio
44558>>>>>>>>>>>>>>>>>>>>>>
44558>>>>>>>>>>>>>>>>>>>>>
44558>>>>>>>>>>>>>>>>>>>>>//AB/     End_Object    // prj
44558>>>>>>>>>>>>>>>>>>>
44558>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
44558>>>>>>>>>>>>>>>>>>>//DDB-FileEnd
44558>>>>>>>>>>>>>>>>>    Use GTYPKIN.DD
INCLUDING FILE: GTYPKIN.DD
44558>>>>>>>>>>>>>>>>>>>//DDB-FileStart
44558>>>>>>>>>>>>>>>>>>>//DDB-HeaderStart
44558>>>>>>>>>>>>>>>>>>>
44558>>>>>>>>>>>>>>>>>>>// File Name : GTYPKIN.DD
44558>>>>>>>>>>>>>>>>>>>// Class Name: Gtypkin_DataDictionary
44558>>>>>>>>>>>>>>>>>>>// Revision  : 45
44558>>>>>>>>>>>>>>>>>>>// Version   : 2
44558>>>>>>>>>>>>>>>>>>>
44558>>>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
44558>>>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
44558>>>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
44558>>>>>>>>>>>>>>>>>>>
44558>>>>>>>>>>>>>>>>>>>Open Gtypkin
44560>>>>>>>>>>>>>>>>>>>Open Garticl
44562>>>>>>>>>>>>>>>>>>>Open Gflagkin
INCLUDING FILE: GFLAGKIN.FD
44564>>>>>>>>>>>>>>>>>>>Open Gparticl
INCLUDING FILE: GPARTICL.FD
44566>>>>>>>>>>>>>>>>>>>Open Gthhmgio
44568>>>>>>>>>>>>>>>>>>>Open Sysrecg
44570>>>>>>>>>>>>>>>>>>>
44570>>>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
44570>>>>>>>>>>>>>>>>>>>//DDB-SelectionStart
44570>>>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList gtypkin  gtypkin.SL
44570>>>>>>>>>>>>>>>>>>>Register_Object gtypkin
44570>>>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
44570>>>>>>>>>>>>>>>>>>>Open SysCurGL
44572>>>>>>>>>>>>>>>>>>>
44572>>>>>>>>>>>>>>>>>>>Class Gtypkin_DataDictionary  is a DataDictionary_Sec
44573>>>>>>>>>>>>>>>>>>>
44573>>>>>>>>>>>>>>>>>>>    Procedure Entry_Order_Date  Integer iField  Date dDate
44574>>>>>>>>>>>>>>>>>>>         // Add a default date if the field is blank
44574>>>>>>>>>>>>>>>>>>>         Integer Changed
44575>>>>>>>>>>>>>>>>>>>         Get Field_Changed_State iField to Changed
44576>>>>>>>>>>>>>>>>>>>         If (Changed=0 AND dDate =0) Begin
44578>>>>>>>>>>>>>>>>>>>             SysDate4 dDate
44579>>>>>>>>>>>>>>>>>>>             Set Field_Default_Value iField to dDate
44580>>>>>>>>>>>>>>>>>>>         End
44580>>>>>>>>>>>>>>>>>>>>
44580>>>>>>>>>>>>>>>>>>>    End_Procedure
44581>>>>>>>>>>>>>>>>>>>
44581>>>>>>>>>>>>>>>>>>>    Procedure Construct_Object
44582>>>>>>>>>>>>>>>>>>>        Forward Send Construct_Object
44584>>>>>>>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
44585>>>>>>>>>>>>>>>>>>>        Property Date    pdDefault_Hmnia    Public 0
44586>>>>>>>>>>>>>>>>>>>        Property Integer piRate             Public 0
44587>>>>>>>>>>>>>>>>>>>        Property Integer piGthhmgio_dd      Public 0
44588>>>>>>>>>>>>>>>>>>>    End_Procedure   // Construct_Object
44589>>>>>>>>>>>>>>>>>>>
44589>>>>>>>>>>>>>>>>>>>//    Procedure OnConstrain
44589>>>>>>>>>>>>>>>>>>>//        Forward Send OnConstrain
44589>>>>>>>>>>>>>>>>>>>//        If (piMustNOTConstrain(Self)) Begin
44589>>>>>>>>>>>>>>>>>>>//        End
44589>>>>>>>>>>>>>>>>>>>//        Else Begin
44589>>>>>>>>>>>>>>>>>>>//            Constrain Gtypkin.Company_Code  eq SysCurGL.Company_Code
44589>>>>>>>>>>>>>>>>>>>//            Constrain Gtypkin.Branch_Code   eq SysCurGL.Branch_Code
44589>>>>>>>>>>>>>>>>>>>//            Constrain Gtypkin.Year_Year     eq SysCurGL.Year_Year
44589>>>>>>>>>>>>>>>>>>>//        End
44589>>>>>>>>>>>>>>>>>>>//    End_Procedure
44589>>>>>>>>>>>>>>>>>>>
44589>>>>>>>>>>>>>>>>>>>    Procedure Update
44590>>>>>>>>>>>>>>>>>>>        Forward Send Update
44592>>>>>>>>>>>>>>>>>>>        // Insert Code Here
44592>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Company_Code  to Gtypkin.Company_Code
44593>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Branch_Code   to Gtypkin.Branch_Code
44594>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Year_Year     to Gtypkin.Year_Year
44595>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Year_Recr     to Gtypkin.Year_Recr
44596>>>>>>>>>>>>>>>>>>>        Move Gthhmgio.Gthhmgio_Code to Gtypkin.Gthhmgio_Code
44597>>>>>>>>>>>>>>>>>>>    End_Procedure   // Update
44598>>>>>>>>>>>>>>>>>>>
44598>>>>>>>>>>>>>>>>>>>    Procedure Creating
44599>>>>>>>>>>>>>>>>>>>        Forward Send Creating
44601>>>>>>>>>>>>>>>>>>>        // Insert Code Here
44601>>>>>>>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gtypkin.Gtypkin_Rec0)))))) to Gtypkin.Gtypkin_Recr
44602>>>>>>>>>>>>>>>>>>>    End_Procedure   // Creating
44603>>>>>>>>>>>>>>>>>>>
44603>>>>>>>>>>>>>>>>>>>
44603>>>>>>>>>>>>>>>>>>>
44603>>>>>>>>>>>>>>>>>>>//----------------------------------------------------------------------------
44603>>>>>>>>>>>>>>>>>>>
44603>>>>>>>>>>>>>>>>>>>//    Procedure Creating
44603>>>>>>>>>>>>>>>>>>>//              Forward Send Creating
44603>>>>>>>>>>>>>>>>>>>//              Add 1 to Year.Year_NumGtypkin //˜¨ Ÿ£æª «ç§à¤ ¡ ¤ã©œà¤ «žª ®¨ã©žª
44603>>>>>>>>>>>>>>>>>>>//    End_Procedure //creating
44603>>>>>>>>>>>>>>>>>>>//    Procedure Deleting
44603>>>>>>>>>>>>>>>>>>>//              Forward Send Deleting
44603>>>>>>>>>>>>>>>>>>>//              Sub 1 from Year.Year_NumGtypkin //˜¨ Ÿ£æª «ç§à¤ ¡ ¤ã©œà¤ «žª ®¨ã©žª
44603>>>>>>>>>>>>>>>>>>>//    End_Procedure //deleting
44603>>>>>>>>>>>>>>>>>>>
44603>>>>>>>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
44604>>>>>>>>>>>>>>>>>>>        Integer iReturnVal
44605>>>>>>>>>>>>>>>>>>>        Forward Get Validate_Save To iReturnVal
44607>>>>>>>>>>>>>>>>>>>//        If (Not(iReturnVal)) Begin
44607>>>>>>>>>>>>>>>>>>>//            //1100:cby = globals
44607>>>>>>>>>>>>>>>>>>>//            If ( ;
44607>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Company_Code = SysCurGL.Company_Code)) or;
44607>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Branch_Code  = SysCurGL.Branch_Code )) or;
44607>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Year_Year    = SysCurGL.Year_Year   ));
44607>>>>>>>>>>>>>>>>>>>//                ) Send Operation_Not_Allowed 1100
44607>>>>>>>>>>>>>>>>>>>//        End
44607>>>>>>>>>>>>>>>>>>>        Function_Return iReturnVal
44608>>>>>>>>>>>>>>>>>>>    End_Function   //validate_save
44609>>>>>>>>>>>>>>>>>>>
44609>>>>>>>>>>>>>>>>>>>
44609>>>>>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
44610>>>>>>>>>>>>>>>>>>>        Integer iReturnVal
44611>>>>>>>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
44613>>>>>>>>>>>>>>>>>>>//        If (Not(iReturnVal)) Begin
44613>>>>>>>>>>>>>>>>>>>//            //2100:cby = globals
44613>>>>>>>>>>>>>>>>>>>//            If ( ;
44613>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Company_Code = SysCurGL.Company_Code)) or;
44613>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Branch_Code  = SysCurGL.Branch_Code )) or;
44613>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Year_Year    = SysCurGL.Year_Year   ));
44613>>>>>>>>>>>>>>>>>>>//                ) Send Operation_Not_Allowed 2100
44613>>>>>>>>>>>>>>>>>>>//        End
44613>>>>>>>>>>>>>>>>>>>        Function_Return iReturnVal
44614>>>>>>>>>>>>>>>>>>>    End_Function   // validate_delete
44615>>>>>>>>>>>>>>>>>>>
44615>>>>>>>>>>>>>>>>>>>
44615>>>>>>>>>>>>>>>>>>>
44615>>>>>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
44616>>>>>>>>>>>>>>>>>>>              Case Begin
44616>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1100)
44618>>>>>>>>>>>>>>>>>>>                        Error 1100 "DDC 151:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
44619>>>>>>>>>>>>>>>>>>>>
44619>>>>>>>>>>>>>>>>>>>                        Case Break
44620>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 2100)
44623>>>>>>>>>>>>>>>>>>>                        Error 2100 "DDC 151:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
44624>>>>>>>>>>>>>>>>>>>>
44624>>>>>>>>>>>>>>>>>>>                        Case Break
44625>>>>>>>>>>>>>>>>>>>                   Case Else
44625>>>>>>>>>>>>>>>>>>>                        Forward Send Operation_Not_Allowed  iError_Num
44627>>>>>>>>>>>>>>>>>>>              Case End
44627>>>>>>>>>>>>>>>>>>>    End_Procedure   //operation_not_allowed
44628>>>>>>>>>>>>>>>>>>>
44628>>>>>>>>>>>>>>>>>>>
44628>>>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
44629>>>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
44631>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44631>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
44631>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
44631>>>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
44632>>>>>>>>>>>>>>>>>>>
44632>>>>>>>>>>>>>>>>>>>
44632>>>>>>>>>>>>>>>>>>>
44632>>>>>>>>>>>>>>>>>>>    // Define_Fields:
44632>>>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44632>>>>>>>>>>>>>>>>>>>
44632>>>>>>>>>>>>>>>>>>>    Procedure Define_Fields
44633>>>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
44635>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44635>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
44635>>>>>>>>>>>>>>>>>>>
44635>>>>>>>>>>>>>>>>>>>        Set Main_File            To Gtypkin.File_Number
44636>>>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
44637>>>>>>>>>>>>>>>>>>>
44637>>>>>>>>>>>>>>>>>>>
44637>>>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
44637>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Garticl.File_Number
44638>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gflagkin.File_Number
44639>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gparticl.File_Number
44640>>>>>>>>>>>>>>>>>>>
44640>>>>>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
44640>>>>>>>>>>>>>>>>>>>        Send Add_Server_File  Gthhmgio.File_Number
44641>>>>>>>>>>>>>>>>>>>
44641>>>>>>>>>>>>>>>>>>>        // External (System) file structure.............
44641>>>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
44642>>>>>>>>>>>>>>>>>>>
44642>>>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gtypkin_Rec0  To Gtypkin.Gtypkin_Rec0
44645>>>>>>>>>>>>>>>>>>>
44645>>>>>>>>>>>>>>>>>>>        // Field-based properties.......................
44645>>>>>>>>>>>>>>>>>>>
44645>>>>>>>>>>>>>>>>>>>        // Gtypkin.Company_Code
44645>>>>>>>>>>>>>>>>>>>
44645>>>>>>>>>>>>>>>>>>>        // Gtypkin.Branch_Code
44645>>>>>>>>>>>>>>>>>>>
44645>>>>>>>>>>>>>>>>>>>        // Gtypkin.Year_Year
44645>>>>>>>>>>>>>>>>>>>
44645>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Code
44645>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gtypkin.Gtypkin_Code To (gtypkin(Self))
44646>>>>>>>>>>>>>>>>>>>
44646>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Rec0
44646>>>>>>>>>>>>>>>>>>>
44646>>>>>>>>>>>>>>>>>>>        // Gtypkin.Year_Recr
44646>>>>>>>>>>>>>>>>>>>
44646>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gthhmgio_Code
44646>>>>>>>>>>>>>>>>>>>
44646>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gthhmgio_Recr
44646>>>>>>>>>>>>>>>>>>>
44646>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Descr
44646>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gtypkin.Gtypkin_Descr To (gtypkin(Self))
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Anti
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Printer
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Form
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_L_No
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_L_Hmnia
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Seira
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Abr
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag01
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag02
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag03
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag04
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag05
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag06
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag07
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag08
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag09
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag10
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag11
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag12
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag13
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag14
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag15
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag16
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag17
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag18
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag19
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag20
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Recr
44647>>>>>>>>>>>>>>>>>>>
44647>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
44647>>>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
44648>>>>>>>>>>>>>>>>>>>End_Class    // Gtypkin_DataDictionary
44649>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
44649>>>>>>>>>>>>>>>>>>>
44649>>>>>>>>>>>>>>>>>>>Use gtypkin.SL       // gtypkin
44649>>>>>>>>>>>>>>>>>>>
44649>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
44649>>>>>>>>>>>>>>>>>>>//DDB-FileEnd
44649>>>>>>>>>>>>>>>>>    
44649>>>>>>>>>>>>>>>>>    //AB-IgnoreEnd
44649>>>>>>>>>>>>>>>>>
44649>>>>>>>>>>>>>>>>>    CD_Popup_Object gtypkin is a dbModalPanel
44668>>>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
44669>>>>>>>>>>>>>>>>>        Set Label to "Šå©«˜ ‰ ¤ã©œà¤"
44670>>>>>>>>>>>>>>>>>        Set Size to 171 467
44671>>>>>>>>>>>>>>>>>        Set Location to 4 5
44672>>>>>>>>>>>>>>>>>
44672>>>>>>>>>>>>>>>>>        //AB-DDOStart
44672>>>>>>>>>>>>>>>>>
44672>>>>>>>>>>>>>>>>>        Object Gthhmgio_DD is a Gthhmgio_DataDictionary
44674>>>>>>>>>>>>>>>>>        End_Object    // Gthhmgio_DD
44675>>>>>>>>>>>>>>>>>
44675>>>>>>>>>>>>>>>>>        Object Gtypkin_DD is a Gtypkin_DataDictionary
44677>>>>>>>>>>>>>>>>>            Set DDO_Server to (Gthhmgio_DD(self))
44678>>>>>>>>>>>>>>>>>        End_Object    // Gtypkin_DD
44679>>>>>>>>>>>>>>>>>
44679>>>>>>>>>>>>>>>>>        Set Main_DD to (Gtypkin_DD(self))
44680>>>>>>>>>>>>>>>>>        Set Server to (Gtypkin_DD(self))
44681>>>>>>>>>>>>>>>>>
44681>>>>>>>>>>>>>>>>>        //AB-DDOEnd
44681>>>>>>>>>>>>>>>>>
44681>>>>>>>>>>>>>>>>>        Object oSelList is a dbList
44683>>>>>>>>>>>>>>>>>            Set Main_File to Gtypkin.File_Number
44684>>>>>>>>>>>>>>>>>            Set Size to 132 450
44685>>>>>>>>>>>>>>>>>            Set Location to 6 6
44686>>>>>>>>>>>>>>>>>
44686>>>>>>>>>>>>>>>>>            Begin_Row
44689>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_code
44690>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_descr
44691>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_abr
44692>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_seira
44693>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_code
44694>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_descr
44695>>>>>>>>>>>>>>>>>            End_Row
44700>>>>>>>>>>>>>>>>>
44700>>>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 40
44701>>>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
44702>>>>>>>>>>>>>>>>>            
44702>>>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 150
44703>>>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
44704>>>>>>>>>>>>>>>>>            
44704>>>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 68
44705>>>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "‘¬¤«¦£¦š¨˜­å˜"
44706>>>>>>>>>>>>>>>>>            
44706>>>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 30
44707>>>>>>>>>>>>>>>>>            Set Header_Label  item 3 to "‘œ ¨á"
44708>>>>>>>>>>>>>>>>>            
44708>>>>>>>>>>>>>>>>>            Set Form_Width    item 4 to 55
44709>>>>>>>>>>>>>>>>>            Set Header_Label  item 4 to "‰à› ¡æª †£/š ¦¬"
44710>>>>>>>>>>>>>>>>>            
44710>>>>>>>>>>>>>>>>>            Set Form_Width    item 5 to 99
44711>>>>>>>>>>>>>>>>>            Set Header_Label  item 5 to "œ¨ š¨˜­ã †£/šå¦¬"
44712>>>>>>>>>>>>>>>>>            
44712>>>>>>>>>>>>>>>>>        End_Object    // oSelList
44713>>>>>>>>>>>>>>>>>
44713>>>>>>>>>>>>>>>>>        Object oOK_bn is a Button
44715>>>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
44716>>>>>>>>>>>>>>>>>            Set Location to 140 298
44717>>>>>>>>>>>>>>>>>
44717>>>>>>>>>>>>>>>>>            //AB-StoreStart
44717>>>>>>>>>>>>>>>>>            Procedure OnClick
44719>>>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
44720>>>>>>>>>>>>>>>>>            End_Procedure
44721>>>>>>>>>>>>>>>>>            //AB-StoreEnd
44721>>>>>>>>>>>>>>>>>
44721>>>>>>>>>>>>>>>>>        End_Object    // oOK_bn
44722>>>>>>>>>>>>>>>>>
44722>>>>>>>>>>>>>>>>>        Object oCancel_bn is a Button
44724>>>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
44725>>>>>>>>>>>>>>>>>            Set Location to 140 353
44726>>>>>>>>>>>>>>>>>
44726>>>>>>>>>>>>>>>>>            //AB-StoreStart
44726>>>>>>>>>>>>>>>>>            Procedure OnClick
44728>>>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
44729>>>>>>>>>>>>>>>>>            End_Procedure
44730>>>>>>>>>>>>>>>>>            //AB-StoreEnd
44730>>>>>>>>>>>>>>>>>
44730>>>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
44731>>>>>>>>>>>>>>>>>
44731>>>>>>>>>>>>>>>>>        Object oSearch_bn is a Button
44733>>>>>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
44734>>>>>>>>>>>>>>>>>            Set Location to 140 408
44735>>>>>>>>>>>>>>>>>
44735>>>>>>>>>>>>>>>>>            //AB-StoreStart
44735>>>>>>>>>>>>>>>>>            Procedure OnClick
44737>>>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
44738>>>>>>>>>>>>>>>>>            End_Procedure
44739>>>>>>>>>>>>>>>>>            //AB-StoreEnd
44739>>>>>>>>>>>>>>>>>
44739>>>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
44740>>>>>>>>>>>>>>>>>
44740>>>>>>>>>>>>>>>>>
44740>>>>>>>>>>>>>>>>>        //AB-StoreStart
44740>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
44741>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
44742>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
44743>>>>>>>>>>>>>>>>>        //AB-StoreEnd
44743>>>>>>>>>>>>>>>>>
44743>>>>>>>>>>>>>>>>>    CD_End_Object    // gtypkin
44745>>>>>>>>>>>>>>>>>>
44745>>>>>>>>>>>>>>>>>
44745>>>>>>>>>>>>>>>>>//AB/     End_Object    // prj
44745>>>>>>>>>>>>>>>
44745>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
44745>>>>>>>>>>>>>>>//DDB-FileEnd
44745>>>>>>>>>>>>>    
44745>>>>>>>>>>>>>    //AB-IgnoreEnd
44745>>>>>>>>>>>>>
44745>>>>>>>>>>>>>    CD_Popup_Object sl150 is a dbModalPanelSub
44764>>>>>>>>>>>>>
44764>>>>>>>>>>>>>        //AB-StoreTopStart
44764>>>>>>>>>>>>>        Property Integer piFragmaLast -1
44766>>>>>>>>>>>>>        Property String  psFragmaFromCode ""
44768>>>>>>>>>>>>>        Property String  psFragmaToCode ""
44770>>>>>>>>>>>>>        
44770>>>>>>>>>>>>>        //AB-StoreTopEnd
44770>>>>>>>>>>>>>
44770>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
44771>>>>>>>>>>>>>        Set Label to "Šå©«˜ Š¦š˜¨ ˜©£é¤"
44772>>>>>>>>>>>>>        Set Size to 204 393
44773>>>>>>>>>>>>>        Set Location to 5 16
44774>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
44775>>>>>>>>>>>>>        Set Modal_State to FALSE
44776>>>>>>>>>>>>>
44776>>>>>>>>>>>>>        //AB-DDOStart
44776>>>>>>>>>>>>>
44776>>>>>>>>>>>>>        Object Gplan_DD is a Gplan_DataDictionary
44778>>>>>>>>>>>>>
44778>>>>>>>>>>>>>            //AB-StoreStart
44778>>>>>>>>>>>>>                        
44778>>>>>>>>>>>>>            Procedure OnConstrain
44780>>>>>>>>>>>>>                Integer liFragmaLast
44781>>>>>>>>>>>>>                String lsFragmaFromCode lsFragmaToCode
44781>>>>>>>>>>>>>                Get piFragmaLast     to liFragmaLast
44782>>>>>>>>>>>>>                Get psFragmaFromCode to lsFragmaFromCode
44783>>>>>>>>>>>>>                Get psFragmaToCode   to lsFragmaToCode
44784>>>>>>>>>>>>>                If (liFragmaLast <> -1)     Constrain Gplan.Gplan_Yn_Last eq liFragmaLast
44788>>>>>>>>>>>>>                If (lsFragmaFromCode <> "") Constrain Gplan.Gplan_Code    ge lsFragmaFromCode
44792>>>>>>>>>>>>>                If (lsFragmaToCode <> "")   Constrain Gplan.Gplan_Code    le lsFragmaToCode
44796>>>>>>>>>>>>>            End_Procedure // OnConstrain
44797>>>>>>>>>>>>>            
44797>>>>>>>>>>>>>            
44797>>>>>>>>>>>>>            //AB-StoreEnd
44797>>>>>>>>>>>>>
44797>>>>>>>>>>>>>        End_Object    // Gplan_DD
44798>>>>>>>>>>>>>
44798>>>>>>>>>>>>>        Set Main_DD to (Gplan_DD(self))
44799>>>>>>>>>>>>>        Set Server to (Gplan_DD(self))
44800>>>>>>>>>>>>>
44800>>>>>>>>>>>>>        //AB-DDOEnd
44800>>>>>>>>>>>>>
44800>>>>>>>>>>>>>        Object oSelList is a dbListSub
44802>>>>>>>>>>>>>            Set Main_File to Gplan.File_Number
44803>>>>>>>>>>>>>            Set Ordering to 3
44804>>>>>>>>>>>>>            Set Size to 164 378
44805>>>>>>>>>>>>>            Set Location to 4 6
44806>>>>>>>>>>>>>
44806>>>>>>>>>>>>>            Begin_Row
44809>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_code
44810>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_descr1
44811>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_bathmos
44812>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_yn_last
44813>>>>>>>>>>>>>            End_Row
44818>>>>>>>>>>>>>
44818>>>>>>>>>>>>>            Set Form_Width    item 0 to 105
44819>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
44820>>>>>>>>>>>>>            
44820>>>>>>>>>>>>>            Set Form_Width    item 1 to 212
44821>>>>>>>>>>>>>            Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
44822>>>>>>>>>>>>>            
44822>>>>>>>>>>>>>            Set Form_Width    item 2 to 34
44823>>>>>>>>>>>>>            Set Header_Label  item 2 to "˜Ÿ£æª"
44824>>>>>>>>>>>>>            
44824>>>>>>>>>>>>>            Set Form_Width    item 3 to 19
44825>>>>>>>>>>>>>            Set Header_Label  item 3 to " ’"
44826>>>>>>>>>>>>>            Set Column_Checkbox_State  item 3 to True
44827>>>>>>>>>>>>>            
44827>>>>>>>>>>>>>
44827>>>>>>>>>>>>>            //AB-StoreStart
44827>>>>>>>>>>>>>                        
44827>>>>>>>>>>>>>            Property String piStoredFragmaLast -1
44829>>>>>>>>>>>>>            Property String psStoredFragmaFromCode ""
44831>>>>>>>>>>>>>            Property String psStoredFragmaToCode ""
44833>>>>>>>>>>>>>            
44833>>>>>>>>>>>>>            Procedure Store_Defaults
44835>>>>>>>>>>>>>                forward send Store_Defaults
44837>>>>>>>>>>>>>                Set piStoredFragmaLast     to (piFragmaLast(Self))
44838>>>>>>>>>>>>>                Set psStoredFragmaFromCode to (psFragmaFromCode(Self))
44839>>>>>>>>>>>>>                Set psStoredFragmaToCode   to (psFragmaToCode(Self))
44840>>>>>>>>>>>>>            end_Procedure // Store_Defaults
44841>>>>>>>>>>>>>            
44841>>>>>>>>>>>>>            Procedure Restore_Defaults
44843>>>>>>>>>>>>>                forward send Restore_Defaults
44845>>>>>>>>>>>>>                Set piFragmaLast     to (piStoredFragmaLast(self))
44846>>>>>>>>>>>>>                Set psFragmaFromCode to (psStoredFragmaFromCode(self))
44847>>>>>>>>>>>>>                Set psFragmaToCode   to (psStoredFragmaToCode(self))
44848>>>>>>>>>>>>>            end_Procedure // Restore_Defaults
44849>>>>>>>>>>>>>            
44849>>>>>>>>>>>>>            Procedure Activating
44851>>>>>>>>>>>>>                Forward Send Activating
44853>>>>>>>>>>>>>                Send Rebuild_Constraints to (Gplan_DD(self))
44854>>>>>>>>>>>>>            End_Procedure // Activating
44855>>>>>>>>>>>>>            
44855>>>>>>>>>>>>>            
44855>>>>>>>>>>>>>            
44855>>>>>>>>>>>>>            
44855>>>>>>>>>>>>>            //AB-StoreEnd
44855>>>>>>>>>>>>>
44855>>>>>>>>>>>>>        End_Object    // oSelList
44856>>>>>>>>>>>>>
44856>>>>>>>>>>>>>        Object oOK_bn is a Button
44858>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
44859>>>>>>>>>>>>>            Set Location to 170 226
44860>>>>>>>>>>>>>
44860>>>>>>>>>>>>>            //AB-StoreStart
44860>>>>>>>>>>>>>            Procedure OnClick
44862>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
44863>>>>>>>>>>>>>            End_Procedure
44864>>>>>>>>>>>>>            //AB-StoreEnd
44864>>>>>>>>>>>>>
44864>>>>>>>>>>>>>        End_Object    // oOK_bn
44865>>>>>>>>>>>>>
44865>>>>>>>>>>>>>        Object oCancel_bn is a Button
44867>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
44868>>>>>>>>>>>>>            Set Location to 170 279
44869>>>>>>>>>>>>>
44869>>>>>>>>>>>>>            //AB-StoreStart
44869>>>>>>>>>>>>>            Procedure OnClick
44871>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
44872>>>>>>>>>>>>>            End_Procedure
44873>>>>>>>>>>>>>            //AB-StoreEnd
44873>>>>>>>>>>>>>
44873>>>>>>>>>>>>>        End_Object    // oCancel_bn
44874>>>>>>>>>>>>>
44874>>>>>>>>>>>>>        Object oSearch_bn is a Button
44876>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
44877>>>>>>>>>>>>>            Set Location to 170 334
44878>>>>>>>>>>>>>
44878>>>>>>>>>>>>>            //AB-StoreStart
44878>>>>>>>>>>>>>            Procedure OnClick
44880>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
44881>>>>>>>>>>>>>            End_Procedure
44882>>>>>>>>>>>>>            //AB-StoreEnd
44882>>>>>>>>>>>>>
44882>>>>>>>>>>>>>        End_Object    // oSearch_bn
44883>>>>>>>>>>>>>
44883>>>>>>>>>>>>>
44883>>>>>>>>>>>>>        //AB-StoreStart
44883>>>>>>>>>>>>>                
44883>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
44884>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
44885>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
44886>>>>>>>>>>>>>        
44886>>>>>>>>>>>>>        
44886>>>>>>>>>>>>>        
44886>>>>>>>>>>>>>        //AB-StoreEnd
44886>>>>>>>>>>>>>
44886>>>>>>>>>>>>>    CD_End_Object    // sl150
44888>>>>>>>>>>>>>>
44888>>>>>>>>>>>>>
44888>>>>>>>>>>>>>//AB/     End_Object    // prj
44888>>>>>>>>>>>
44888>>>>>>>>>>>//DDB-Selection-pkg-End
44888>>>>>>>>>>>//DDB-FileEnd
44888>>>>>>>>>Use ITEM.DD
44888>>>>>>>>>
44888>>>>>>>>>//AB-IgnoreEnd
44888>>>>>>>>>
44888>>>>>>>>>CD_Popup_Object SL22s is a dbModalPanel
44907>>>>>>>>>
44907>>>>>>>>>    //AB-StoreTopStart
44907>>>>>>>>>    Property String     pscode                  ''
44909>>>>>>>>>    Property String     psperi                  ''
44911>>>>>>>>>    Property Integer    piContains_Or_Starts     0
44913>>>>>>>>>    Property String     pscodekat               ''
44915>>>>>>>>>    
44915>>>>>>>>>    //AB-StoreTopEnd
44915>>>>>>>>>
44915>>>>>>>>>    Set Minimize_Icon to FALSE
44916>>>>>>>>>    Set Label to "€¨®œå¦ „ ›é¤"
44917>>>>>>>>>    Set Size to 270 484
44918>>>>>>>>>    Set Location to 5 7
44919>>>>>>>>>
44919>>>>>>>>>    //AB-DDOStart
44919>>>>>>>>>
44919>>>>>>>>>    Object Witemkat_DD is a Witemkat_DataDictionary
44921>>>>>>>>>    End_Object    // Witemkat_DD
44922>>>>>>>>>
44922>>>>>>>>>    Object Units_DD is a Units_DataDictionary
44924>>>>>>>>>    End_Object    // Units_DD
44925>>>>>>>>>
44925>>>>>>>>>    Object Fpa_DD is a Fpa_DataDictionary
44927>>>>>>>>>    End_Object    // Fpa_DD
44928>>>>>>>>>
44928>>>>>>>>>    Object Item_DD is a Item_DataDictionary
44930>>>>>>>>>
44930>>>>>>>>>        //AB-StoreTopStart
44930>>>>>>>>>        Function fiPeriexei Returns Integer
44932>>>>>>>>>                   String lsperi lscode  lscodekat
44933>>>>>>>>>                   Integer rVal liContains_Or_Starts
44933>>>>>>>>>                   Move 0 to rVal
44934>>>>>>>>>                   Get piContains_Or_Starts to liContains_Or_Starts
44935>>>>>>>>>                   Get psperi to lsperi
44936>>>>>>>>>                   Get pscode to lscode
44937>>>>>>>>>                   Get pscodekat to lscodekat
44938>>>>>>>>>                   Move (Trim(lsperi)) to lsperi
44939>>>>>>>>>                   Move (Trim(lscode)) to lscode
44940>>>>>>>>>              //     Move (Trim(lscodekat)) to lscodekat
44940>>>>>>>>>                   If (liContains_Or_Starts=0) Begin
44942>>>>>>>>>                       If ((Trim(item.item_descr)) Contains lsperi) Begin
44944>>>>>>>>>                           If ((Trim(item.item_code)) Contains lscode) Move 1 to rVal
44947>>>>>>>>>                       End
44947>>>>>>>>>>
44947>>>>>>>>>        
44947>>>>>>>>>                   End
44947>>>>>>>>>>
44947>>>>>>>>>                   Else Begin
44948>>>>>>>>>                       If (Left(item.item_descr,(Length(lsperi)))=lsperi) Begin
44950>>>>>>>>>                           If (Left(item.item_code,(Length(lscode)))=lscode) Move 1 to rVal
44953>>>>>>>>>                       End
44953>>>>>>>>>>
44953>>>>>>>>>        
44953>>>>>>>>>                   End
44953>>>>>>>>>>
44953>>>>>>>>>                   Function_Return rVal
44954>>>>>>>>>               End_Function
44955>>>>>>>>>        
44955>>>>>>>>>               Function fiArxizeiperi Returns Integer
44957>>>>>>>>>                   String lsperi
44958>>>>>>>>>                   Get psperi to lsperi
44959>>>>>>>>>                   Move (Trim(lsperi)) to lsperi
44960>>>>>>>>>                   Function_Return (Left(item.item_descr,(Length(lsperi)))=lsperi)
44961>>>>>>>>>               End_Function
44962>>>>>>>>>        
44962>>>>>>>>>               Function fiArxizeicode Returns Integer
44964>>>>>>>>>                   String lscode lscodekat
44965>>>>>>>>>                   Get pscode to lscode
44966>>>>>>>>>                   Move (Trim(lscode)) to lscode
44967>>>>>>>>>                   Function_Return (Left(item.item_code,(Length(lscode)))=lscode)
44968>>>>>>>>>               End_Function
44969>>>>>>>>>        
44969>>>>>>>>>        //AB-StoreTopEnd
44969>>>>>>>>>
44969>>>>>>>>>        Set DDO_Server to (Units_DD(self))
44970>>>>>>>>>        Set DDO_Server to (Witemkat_DD(self))
44971>>>>>>>>>        Set DDO_Server to (Fpa_DD(self))
44972>>>>>>>>>
44972>>>>>>>>>        //AB-StoreStart
44972>>>>>>>>>        
44972>>>>>>>>>        
44972>>>>>>>>>        
44972>>>>>>>>>        Begin_Constraints
44974>>>>>>>>>           String lsperi lscode lsvalue lstype lscodekat
44975>>>>>>>>>           Integer liContains_Or_Starts
44975>>>>>>>>>         //  Get FragmaItem  to lsValue
44975>>>>>>>>>        
44975>>>>>>>>>               Get psperi  to lsperi
44976>>>>>>>>>               Get pscode  to lscode
44977>>>>>>>>>               Get pscodekat  to lscodekat
44978>>>>>>>>>               Get piContains_Or_Starts to liContains_Or_Starts
44979>>>>>>>>>               Move (Trim(lsperi)) to lsperi
44980>>>>>>>>>               Move (Trim(lscode)) to lscode
44981>>>>>>>>>               Move (Trim(lscodekat)) to lscodekat
44982>>>>>>>>>               If ((lsperi<>'') and (lscode<>'')) begin
44984>>>>>>>>>                    set ordering to 5
44985>>>>>>>>>                    Constrain item as (fiPeriexei(Self)=1)
44986>>>>>>>>>               end
44986>>>>>>>>>>
44986>>>>>>>>>               Else Begin
44987>>>>>>>>>                  If (liContains_Or_Starts=0) Begin
44989>>>>>>>>>                    If (lsperi<>'') begin
44991>>>>>>>>>                        set ordering to 3
44992>>>>>>>>>                        Constrain item.item_descr Contains lsperi
44994>>>>>>>>>                    end
44994>>>>>>>>>>
44994>>>>>>>>>                    Else If (lscode<>'') begin
44997>>>>>>>>>                        set ordering to 5
44998>>>>>>>>>                        Constrain item.item_code Contains lscode
45000>>>>>>>>>                    end
45000>>>>>>>>>>
45000>>>>>>>>>                  End
45000>>>>>>>>>>
45000>>>>>>>>>                  Else Begin
45001>>>>>>>>>                       If (lsperi<>'') begin
45003>>>>>>>>>                            set ordering to 3
45004>>>>>>>>>                            Constrain item as (fiArxizeiperi(Self)=1) //item.item_descr
45005>>>>>>>>>                       end
45005>>>>>>>>>>
45005>>>>>>>>>                       Else If (lscode<>'') begin
45008>>>>>>>>>                            set ordering to 5
45009>>>>>>>>>                            Constrain item as (fiArxizeicode(Self)=1) //item.item_code
45010>>>>>>>>>                       end
45010>>>>>>>>>>
45010>>>>>>>>>                  End
45010>>>>>>>>>>
45010>>>>>>>>>               End
45010>>>>>>>>>>
45010>>>>>>>>>               If (lscodekat<>'') Constrain item.witemkat_code Contains lscodekat
45014>>>>>>>>>               Constrain item.item_orio eq 0
45016>>>>>>>>>        End_Constraints
45019>>>>>>>>>        
45019>>>>>>>>>        
45019>>>>>>>>>        
45019>>>>>>>>>        
45019>>>>>>>>>        
45019>>>>>>>>>        //AB-StoreEnd
45019>>>>>>>>>
45019>>>>>>>>>    End_Object    // Item_DD
45020>>>>>>>>>
45020>>>>>>>>>    Set Main_DD to (Item_DD(self))
45021>>>>>>>>>    Set Server to (Item_DD(self))
45022>>>>>>>>>
45022>>>>>>>>>    //AB-DDOEnd
45022>>>>>>>>>
45022>>>>>>>>>    Object oSelList is a dbListSub
45024>>>>>>>>>        Set Main_File to Item.File_Number
45025>>>>>>>>>        Set Ordering to 5
45026>>>>>>>>>        Set Size to 190 475
45027>>>>>>>>>        Set Location to -1 2
45028>>>>>>>>>        Set Color to 14280447
45029>>>>>>>>>        Set CurrentRowColor to 11783679
45030>>>>>>>>>        Set CurrentCellColor to 11783679
45031>>>>>>>>>        Set Auto_Index_State to FALSE
45032>>>>>>>>>
45032>>>>>>>>>        Begin_Row
45035>>>>>>>>>            Entry_Item Item.Item_code
45036>>>>>>>>>            Entry_Item Item.Item_descr
45037>>>>>>>>>            Entry_Item Item.Witemkat_code
45038>>>>>>>>>            Entry_Item Witemkat.Witemkat_descr
45039>>>>>>>>>            Entry_Item Item.Item_qual
45040>>>>>>>>>            Entry_Item Fpa.Fpa_pososto
45041>>>>>>>>>        End_Row
45046>>>>>>>>>
45046>>>>>>>>>        Set Form_Width    item 0 to 60
45047>>>>>>>>>        Set Header_Label  item 0 to "‰à›. „å›¦¬ª"
45048>>>>>>>>>        
45048>>>>>>>>>        Set Form_Width    item 1 to 140
45049>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
45050>>>>>>>>>        
45050>>>>>>>>>        Set Form_Width    item 2 to 70
45051>>>>>>>>>        Set Header_Label  item 2 to "‰à›. ‰˜«žš¦¨å˜ª"
45052>>>>>>>>>        
45052>>>>>>>>>        Set Form_Width    item 3 to 88
45053>>>>>>>>>        Set Header_Label  item 3 to "œ¨ š¨˜­ã ‰˜«žš."
45054>>>>>>>>>        
45054>>>>>>>>>        Set Form_Width    item 4 to 64
45055>>>>>>>>>        Set Header_Label  item 4 to "¦ æ«ž«˜"
45056>>>>>>>>>        
45056>>>>>>>>>        Set Form_Width    item 5 to 45
45057>>>>>>>>>        Set Header_Label  item 5 to "‰˜«.”..€"
45058>>>>>>>>>        
45058>>>>>>>>>
45058>>>>>>>>>        //AB-StoreStart
45058>>>>>>>>>                    
45058>>>>>>>>>        Property String Store_Fragma_Items public ""
45060>>>>>>>>>        
45060>>>>>>>>>        set export_item_state to true
45061>>>>>>>>>        
45061>>>>>>>>>        Procedure Activating
45063>>>>>>>>>           Forward send Activating
45065>>>>>>>>>           Send Rebuild_Constraints to (Item_DD(Self))
45066>>>>>>>>>        End_Procedure
45067>>>>>>>>>        
45067>>>>>>>>>        Function Child_Exiting Integer iWhere Returns Integer
45069>>>>>>>>>            local integer Rval
45070>>>>>>>>>            Forward get Child_Exiting iWhere  to Rval
45072>>>>>>>>>            set value of (ocode   (self))   to ''
45073>>>>>>>>>            set value of (operi   (self))   to ''
45074>>>>>>>>>            set value of (ocodekat(self))   to ''
45075>>>>>>>>>            set psperi                      to ''
45076>>>>>>>>>            set pscode                      to ''
45077>>>>>>>>>            set pscodekat                   to ''
45078>>>>>>>>>            function_return Rval // if non-zero do not enter
45079>>>>>>>>>        End_function
45080>>>>>>>>>        
45080>>>>>>>>>        
45080>>>>>>>>>        
45080>>>>>>>>>        
45080>>>>>>>>>        
45080>>>>>>>>>        
45080>>>>>>>>>        
45080>>>>>>>>>        
45080>>>>>>>>>        
45080>>>>>>>>>        
45080>>>>>>>>>        
45080>>>>>>>>>        
45080>>>>>>>>>        
45080>>>>>>>>>        
45080>>>>>>>>>        
45080>>>>>>>>>        
45080>>>>>>>>>        
45080>>>>>>>>>        
45080>>>>>>>>>        
45080>>>>>>>>>        
45080>>>>>>>>>        //AB-StoreEnd
45080>>>>>>>>>
45080>>>>>>>>>    End_Object    // oSelList
45081>>>>>>>>>
45081>>>>>>>>>    Object TextBoxSub1 is a TextBoxSub
45083>>>>>>>>>        Set Label to "‘á¨à©ž ‰à› ¡¦ç ‚ á"
45084>>>>>>>>>        Set Auto_Size_State to FALSE
45085>>>>>>>>>        Set Location to 192 6
45086>>>>>>>>>        Set Size to 13 78
45087>>>>>>>>>        Set TypeFace to "MS Sans Serif"
45088>>>>>>>>>    End_Object    // TextBoxSub1
45089>>>>>>>>>
45089>>>>>>>>>    Object ocode is a FormSub
45091>>>>>>>>>        Set Size to 13 197
45092>>>>>>>>>        Set Location to 192 79
45093>>>>>>>>>        Set Label_Col_Offset to 2
45094>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45095>>>>>>>>>
45095>>>>>>>>>        //AB-StoreStart
45095>>>>>>>>>                                                        
45095>>>>>>>>>        Procedure OnKILLFOCUS
45097>>>>>>>>>            Send KeyAction to ButtonSub1
45098>>>>>>>>>        End_Procedure
45099>>>>>>>>>        
45099>>>>>>>>>        
45099>>>>>>>>>        
45099>>>>>>>>>        
45099>>>>>>>>>        //AB-StoreEnd
45099>>>>>>>>>
45099>>>>>>>>>    End_Object    // ocode
45100>>>>>>>>>
45100>>>>>>>>>    Object TextBoxSub2 is a TextBoxSub
45102>>>>>>>>>        Set Label to "‘á¨à©ž œ¨ š¨˜­ãª "
45103>>>>>>>>>        Set Auto_Size_State to FALSE
45104>>>>>>>>>        Set Location to 207 6
45105>>>>>>>>>        Set Size to 13 83
45106>>>>>>>>>        Set TypeFace to "MS Sans Serif"
45107>>>>>>>>>    End_Object    // TextBoxSub2
45108>>>>>>>>>
45108>>>>>>>>>    Object operi is a FormSub
45110>>>>>>>>>        Set Size to 13 197
45111>>>>>>>>>        Set Location to 207 79
45112>>>>>>>>>        Set Label_Col_Offset to 2
45113>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45114>>>>>>>>>
45114>>>>>>>>>        //AB-StoreStart
45114>>>>>>>>>                                                        
45114>>>>>>>>>        Procedure OnKILLFOCUS
45116>>>>>>>>>            Send KeyAction to ButtonSub1
45117>>>>>>>>>        End_Procedure
45118>>>>>>>>>        
45118>>>>>>>>>        
45118>>>>>>>>>        
45118>>>>>>>>>        
45118>>>>>>>>>        //AB-StoreEnd
45118>>>>>>>>>
45118>>>>>>>>>    End_Object    // operi
45119>>>>>>>>>
45119>>>>>>>>>    Object RadioGroupSub1 is a RadioGroupSub
45121>>>>>>>>>        Set Size to 32 77
45122>>>>>>>>>        Set Location to 193 277
45123>>>>>>>>>        Object Radio1 is a RadioSub
45125>>>>>>>>>            Set Label to "œ¨ â®œ«˜ "
45126>>>>>>>>>            Set Size to 10 53
45127>>>>>>>>>            Set Location to 7 5
45128>>>>>>>>>        End_Object    // Radio1
45129>>>>>>>>>
45129>>>>>>>>>        Object Radio2 is a RadioSub
45131>>>>>>>>>            Set Label to "€¨®åœ  €§æ"
45132>>>>>>>>>            Set Size to 10 51
45133>>>>>>>>>            Set Location to 21 5
45134>>>>>>>>>        End_Object    // Radio2
45135>>>>>>>>>
45135>>>>>>>>>
45135>>>>>>>>>        //AB-StoreStart
45135>>>>>>>>>                                                        
45135>>>>>>>>>        Procedure Notify_Select_State integer iToItem integer iFromItem
45137>>>>>>>>>            Set piContains_Or_Starts to iToItem
45138>>>>>>>>>            Send KeyAction to ButtonSub1
45139>>>>>>>>>        End_Procedure
45140>>>>>>>>>        
45140>>>>>>>>>        
45140>>>>>>>>>        
45140>>>>>>>>>        
45140>>>>>>>>>        //AB-StoreEnd
45140>>>>>>>>>
45140>>>>>>>>>    End_Object    // RadioGroupSub1
45141>>>>>>>>>
45141>>>>>>>>>    Object ButtonSub1 is a ButtonSub
45143>>>>>>>>>        Set Label to "Search"
45144>>>>>>>>>        Set Size to 28 37
45145>>>>>>>>>        Set Location to 198 357
45146>>>>>>>>>        Set Form_FontWeight Item 0 to 800
45147>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45148>>>>>>>>>
45148>>>>>>>>>        //AB-StoreStart
45148>>>>>>>>>                                                                                                        
45148>>>>>>>>>        Set Visible_State to False
45149>>>>>>>>>        
45149>>>>>>>>>        Procedure OnClick
45151>>>>>>>>>            Forward Send OnClick
45153>>>>>>>>>            Set pscode  to (Value(ocode(Self),0))
45154>>>>>>>>>            Set psperi  to (Value(operi(Self),0))
45155>>>>>>>>>            Set pscodekat  to (Value(ocodekat(Self),0))
45156>>>>>>>>>            send Rebuild_Constraints    to (item_DD(Self))
45157>>>>>>>>>            Send Beginning_Of_Data      to oSelList True
45158>>>>>>>>>        End_Procedure // OnClick
45159>>>>>>>>>        
45159>>>>>>>>>        
45159>>>>>>>>>        
45159>>>>>>>>>        
45159>>>>>>>>>        
45159>>>>>>>>>        
45159>>>>>>>>>        
45159>>>>>>>>>        
45159>>>>>>>>>        
45159>>>>>>>>>        
45159>>>>>>>>>        
45159>>>>>>>>>        
45159>>>>>>>>>        
45159>>>>>>>>>        //AB-StoreEnd
45159>>>>>>>>>
45159>>>>>>>>>    End_Object    // ButtonSub1
45160>>>>>>>>>
45160>>>>>>>>>    Object TextBoxSub3 is a TextBoxSub
45162>>>>>>>>>        Set Label to "‰à›.‰˜«žš¦¨å˜ª ‚ á"
45163>>>>>>>>>        Set Auto_Size_State to FALSE
45164>>>>>>>>>        Set Location to 221 5
45165>>>>>>>>>        Set Size to 13 78
45166>>>>>>>>>        Set TypeFace to "MS Sans Serif"
45167>>>>>>>>>    End_Object    // TextBoxSub3
45168>>>>>>>>>
45168>>>>>>>>>    Object ocodekat is a FormSub
45170>>>>>>>>>        Set Size to 13 197
45171>>>>>>>>>        Set Location to 221 78
45172>>>>>>>>>        Set Label_Col_Offset to 2
45173>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45174>>>>>>>>>
45174>>>>>>>>>        //AB-StoreStart
45174>>>>>>>>>                                                        
45174>>>>>>>>>        Procedure OnKILLFOCUS
45176>>>>>>>>>           Send KeyAction to ButtonSub1
45177>>>>>>>>>        End_Procedure
45178>>>>>>>>>        
45178>>>>>>>>>        
45178>>>>>>>>>        
45178>>>>>>>>>        //AB-StoreEnd
45178>>>>>>>>>
45178>>>>>>>>>    End_Object    // ocodekat
45179>>>>>>>>>
45179>>>>>>>>>    Object oOK_bn is a ButtonSub
45181>>>>>>>>>        Set Label to "&„§ ¢¦šã"
45182>>>>>>>>>        Set Location to 237 316
45183>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45184>>>>>>>>>
45184>>>>>>>>>        //AB-StoreStart
45184>>>>>>>>>        Procedure OnClick
45186>>>>>>>>>            Send OK To (oSelList(current_object))
45187>>>>>>>>>        End_Procedure
45188>>>>>>>>>        //AB-StoreEnd
45188>>>>>>>>>
45188>>>>>>>>>    End_Object    // oOK_bn
45189>>>>>>>>>
45189>>>>>>>>>    Object oCancel_bn is a ButtonSub
45191>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
45192>>>>>>>>>        Set Location to 237 371
45193>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45194>>>>>>>>>
45194>>>>>>>>>        //AB-StoreStart
45194>>>>>>>>>        Procedure OnClick
45196>>>>>>>>>            Send Cancel To (oSelList(current_object))
45197>>>>>>>>>        End_Procedure
45198>>>>>>>>>        //AB-StoreEnd
45198>>>>>>>>>
45198>>>>>>>>>    End_Object    // oCancel_bn
45199>>>>>>>>>
45199>>>>>>>>>    Object oSearch_bn is a ButtonSub
45201>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
45202>>>>>>>>>        Set Location to 237 426
45203>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45204>>>>>>>>>
45204>>>>>>>>>        //AB-StoreStart
45204>>>>>>>>>        Procedure OnClick
45206>>>>>>>>>            Send Search To (oSelList(current_object))
45207>>>>>>>>>        End_Procedure
45208>>>>>>>>>        //AB-StoreEnd
45208>>>>>>>>>
45208>>>>>>>>>    End_Object    // oSearch_bn
45209>>>>>>>>>
45209>>>>>>>>>
45209>>>>>>>>>    //AB-StoreStart
45209>>>>>>>>>                    
45209>>>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
45210>>>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
45211>>>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
45212>>>>>>>>>    
45212>>>>>>>>>    Set Locate_Mode to Center_On_Screen
45213>>>>>>>>>    
45213>>>>>>>>>    
45213>>>>>>>>>    
45213>>>>>>>>>    
45213>>>>>>>>>    
45213>>>>>>>>>    
45213>>>>>>>>>    
45213>>>>>>>>>    
45213>>>>>>>>>    
45213>>>>>>>>>    
45213>>>>>>>>>    
45213>>>>>>>>>    
45213>>>>>>>>>    //AB-StoreEnd
45213>>>>>>>>>
45213>>>>>>>>>CD_End_Object    // SL22s
45215>>>>>>>>>>
45215>>>>>>>>>
45215>>>>>>>>>
45215>>>>>>>>>//AB-StoreStart
45215>>>>>>>>>                                
45215>>>>>>>>>                                
45215>>>>>>>>>                                
45215>>>>>>>>>                                
45215>>>>>>>>>                                
45215>>>>>>>>>                                
45215>>>>>>>>>                                
45215>>>>>>>>>                                
45215>>>>>>>>>                                
45215>>>>>>>>>                                
45215>>>>>>>>>//AB-StoreEnd
45215>>>>>>>>>
45215>>>>>>>>>//AB/ End_Object    // prj
45215>>>>>>>Use sl022.SL         // sl022
45215>>>>>>>
45215>>>>>>>//DDB-Selection-pkg-End
45215>>>>>>>//DDB-FileEnd
45215>>>>>    
45215>>>>>    //AB-IgnoreEnd
45215>>>>>
45215>>>>>    Object sl026 is a dbModalPanelSub
45217>>>>>        set label to "€¨®œå¦ „ ›é¤" 
45218>>>>>        Set Size to 148 297
45219>>>>>        Set Location to 2 15
45220>>>>>        Set Exit_Application_Local_State to FALSE
45221>>>>>        Set Modal_State to FALSE
45222>>>>>
45222>>>>>        //AB-DDOStart
45222>>>>>
45222>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
45224>>>>>        End_Object    // Witemkat_DD
45225>>>>>
45225>>>>>        Object Units_DD is a Units_DataDictionary
45227>>>>>        End_Object    // Units_DD
45228>>>>>
45228>>>>>        Object Item_DD is a Item_DataDictionary
45230>>>>>            Set DDO_Server to (Units_DD(self))
45231>>>>>            Set DDO_Server to (Witemkat_DD(self))
45232>>>>>        End_Object    // Item_DD
45233>>>>>
45233>>>>>        Set Main_DD to (Item_DD(self))
45234>>>>>        Set Server to (Item_DD(self))
45235>>>>>
45235>>>>>        //AB-DDOEnd
45235>>>>>
45235>>>>>        Object oSelList is a dbListSub
45237>>>>>            Set Main_File to Item.File_Number
45238>>>>>            Set Server to (Units_DD(self))
45239>>>>>            Set Size to 105 280
45240>>>>>            Set Location to 6 6
45241>>>>>
45241>>>>>            Begin_Row
45244>>>>>                Entry_Item Item.Item_code
45245>>>>>                Entry_Item Item.Item_descr
45246>>>>>                Entry_Item Item.Witemkat_code
45247>>>>>                entry_item units.units_descr 
45248>>>>>            End_Row
45253>>>>>
45253>>>>>            Set Form_Width    item 0 to 60
45254>>>>>            set header_label  item 0 to "„ ›¦ª" 
45255>>>>>            
45255>>>>>            Set Form_Width    item 1 to 89
45256>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
45257>>>>>            
45257>>>>>            Set Form_Width    item 2 to 44
45258>>>>>            set header_label  item 2 to "‰˜«žš¦¨å˜   :" 
45259>>>>>            
45259>>>>>            Set Form_Width    item 3 to 79
45260>>>>>            set header_label  item 3 to "‹¦¤.‹â«¨ž©žª" 
45261>>>>>            
45261>>>>>        End_Object    // oSelList
45262>>>>>
45262>>>>>        Object oOK_bn is a ButtonSub
45264>>>>>            set label to "&„§ ¢¦šã" 
45265>>>>>            Set Location to 115 126
45266>>>>>
45266>>>>>            //AB-StoreStart
45266>>>>>            Procedure OnClick
45268>>>>>                Send OK To (oSelList(current_object))
45269>>>>>            End_Procedure
45270>>>>>            //AB-StoreEnd
45270>>>>>
45270>>>>>        End_Object    // oOK_bn
45271>>>>>
45271>>>>>        Object oCancel_bn is a ButtonSub
45273>>>>>            set label to "&€¡ç¨à©ž" 
45274>>>>>            Set Location to 115 181
45275>>>>>
45275>>>>>            //AB-StoreStart
45275>>>>>            Procedure OnClick
45277>>>>>                Send Cancel To (oSelList(current_object))
45278>>>>>            End_Procedure
45279>>>>>            //AB-StoreEnd
45279>>>>>
45279>>>>>        End_Object    // oCancel_bn
45280>>>>>
45280>>>>>        Object oSearch_bn is a ButtonSub
45282>>>>>            set label to "€&¤˜ã«ž©ž" 
45283>>>>>            Set Location to 115 236
45284>>>>>
45284>>>>>            //AB-StoreStart
45284>>>>>            Procedure OnClick
45286>>>>>                Send Search To (oSelList(current_object))
45287>>>>>            End_Procedure
45288>>>>>            //AB-StoreEnd
45288>>>>>
45288>>>>>        End_Object    // oSearch_bn
45289>>>>>
45289>>>>>
45289>>>>>        //AB-StoreStart
45289>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
45290>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
45291>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
45292>>>>>        //AB-StoreEnd
45292>>>>>
45292>>>>>    End_Object    // sl026
45293>>>>>
45293>>>>>//AB/     End_Object    // prj
45293>>>Use sl026a.sl
INCLUDING FILE: SL026A.SL
45293>>>>>//AB/ Project sl026a:item
45293>>>>>//AB/ Object prj is a Lookup_Project
45293>>>>>//AB/     Set ProjectName to "sl026a:item"
45293>>>>>//AB/     Set ProjectFileName to "sl026a.SL"
45293>>>>>//AB/     Set GenerateFileName to "NONAME"
45293>>>>>
45293>>>>>// Project Object Structure
45293>>>>>//   sl026a is a dbModalPanelSub
45293>>>>>//     Witemkat_DD is a DataDictionary
45293>>>>>//     Units_DD is a DataDictionary
45293>>>>>//     Fpa_DD is a DataDictionary
45293>>>>>//     Item_DD is a DataDictionary
45293>>>>>//     oSelList is a dbListSub
45293>>>>>//     oOK_bn is a ButtonSub
45293>>>>>//     oCancel_bn is a ButtonSub
45293>>>>>//     oSearch_bn is a ButtonSub
45293>>>>>
45293>>>>>// Register all objects
45293>>>>>Register_Object Fpa_DD
45293>>>>>Register_Object Item_DD
45293>>>>>Register_Object oCancel_bn
45293>>>>>Register_Object oOK_bn
45293>>>>>Register_Object oSearch_bn
45293>>>>>Register_Object oSelList
45293>>>>>Register_Object sl026a
45293>>>>>Register_Object Units_DD
45293>>>>>Register_Object Witemkat_DD
45293>>>>>
45293>>>>>
45293>>>>>//AB-IgnoreStart
45293>>>>>
45293>>>>>Use DFAllEnt.pkg
45293>>>>>Use dbList.Sub
45293>>>>>Use Button.Sub
45293>>>>>
45293>>>>>
45293>>>>>Use WITEMKAT.DD
45293>>>>>Use UNITS.DD
45293>>>>>Use FPA.DD
45293>>>>>Use ITEM.DD
45293>>>>>
45293>>>>>//AB-IgnoreEnd
45293>>>>>
45293>>>>>Object sl026a is a dbModalPanelSub
45295>>>>>    set label to "„å›ž" 
45296>>>>>    Set Size to 148 372
45297>>>>>    Set Location to 4 5
45298>>>>>    Set Exit_Application_Local_State to FALSE
45299>>>>>    Set Modal_State to FALSE
45300>>>>>
45300>>>>>    //AB-DDOStart
45300>>>>>
45300>>>>>    Object Witemkat_DD is a Witemkat_DataDictionary
45302>>>>>    End_Object    // Witemkat_DD
45303>>>>>
45303>>>>>    Object Units_DD is a Units_DataDictionary
45305>>>>>    End_Object    // Units_DD
45306>>>>>
45306>>>>>    Object Fpa_DD is a Fpa_DataDictionary
45308>>>>>    End_Object    // Fpa_DD
45309>>>>>
45309>>>>>    Object Item_DD is a Item_DataDictionary
45311>>>>>        Set DDO_Server to (Units_DD(self))
45312>>>>>        Set DDO_Server to (Witemkat_DD(self))
45313>>>>>        Set DDO_Server to (Fpa_DD(self))
45314>>>>>    End_Object    // Item_DD
45315>>>>>
45315>>>>>    Set Main_DD to (Item_DD(self))
45316>>>>>    Set Server to (Item_DD(self))
45317>>>>>
45317>>>>>    //AB-DDOEnd
45317>>>>>
45317>>>>>    Object oSelList is a dbListSub
45319>>>>>        Set Main_File to Item.File_Number
45320>>>>>        Set Size to 105 359
45321>>>>>        Set Location to 6 6
45322>>>>>
45322>>>>>        Begin_Row
45325>>>>>            Entry_Item Item.Item_code
45326>>>>>            Entry_Item Item.Item_descr
45327>>>>>            Entry_Item Fpa.Fpa_pososto
45328>>>>>            Entry_Item Item.Item_qual
45329>>>>>        End_Row
45334>>>>>
45334>>>>>        Set Form_Width    item 0 to 70
45335>>>>>        set header_label  item 0 to "‰à› ¡æª „ ›¦¬ª" 
45336>>>>>        
45336>>>>>        Set Form_Width    item 1 to 160
45337>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
45338>>>>>        
45338>>>>>        Set Form_Width    item 2 to 59
45339>>>>>        set header_label  item 2 to "% ”€" 
45340>>>>>        
45340>>>>>        Set Form_Width    item 3 to 62
45341>>>>>        set header_label  item 3 to "¦ æ«ž«˜" 
45342>>>>>        
45342>>>>>    End_Object    // oSelList
45343>>>>>
45343>>>>>    Object oOK_bn is a ButtonSub
45345>>>>>        set label to "&„§ ¢¦šã" 
45346>>>>>        Set Location to 114 207
45347>>>>>
45347>>>>>        //AB-StoreStart
45347>>>>>        Procedure OnClick
45349>>>>>            Send OK To (oSelList(current_object))
45350>>>>>        End_Procedure
45351>>>>>        //AB-StoreEnd
45351>>>>>
45351>>>>>    End_Object    // oOK_bn
45352>>>>>
45352>>>>>    Object oCancel_bn is a ButtonSub
45354>>>>>        set label to "&€¡ç¨à©ž" 
45355>>>>>        Set Location to 114 261
45356>>>>>
45356>>>>>        //AB-StoreStart
45356>>>>>        Procedure OnClick
45358>>>>>            Send Cancel To (oSelList(current_object))
45359>>>>>        End_Procedure
45360>>>>>        //AB-StoreEnd
45360>>>>>
45360>>>>>    End_Object    // oCancel_bn
45361>>>>>
45361>>>>>    Object oSearch_bn is a ButtonSub
45363>>>>>        set label to "€&¤˜ã«ž©ž" 
45364>>>>>        Set Location to 114 317
45365>>>>>
45365>>>>>        //AB-StoreStart
45365>>>>>        Procedure OnClick
45367>>>>>            Send Search To (oSelList(current_object))
45368>>>>>        End_Procedure
45369>>>>>        //AB-StoreEnd
45369>>>>>
45369>>>>>    End_Object    // oSearch_bn
45370>>>>>
45370>>>>>
45370>>>>>    //AB-StoreStart
45370>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
45371>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
45372>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
45373>>>>>    //AB-StoreEnd
45373>>>>>
45373>>>>>End_Object    // sl026a
45374>>>>>
45374>>>>>//AB/ End_Object    // prj
45374>>>Use sl029.sl
INCLUDING FILE: SL029.SL
45374>>>>>//AB/ Project Wtypkin : sl029
45374>>>>>//AB/ Object prj is a Lookup_Project
45374>>>>>//AB/     Set ProjectName to "Wtypkin : sl029"
45374>>>>>//AB/     Set ProjectFileName to "sl029.SL"
45374>>>>>
45374>>>>>// Project Object Structure
45374>>>>>//   sl029 is a dbModalPanelSub
45374>>>>>//     Wtypkin_DD is a DataDictionary
45374>>>>>//     oSelList is a dbListSub
45374>>>>>//     oOK_bn is a ButtonSub
45374>>>>>//     oCancel_bn is a ButtonSub
45374>>>>>//     oSearch_bn is a ButtonSub
45374>>>>>
45374>>>>>// Register all objects
45374>>>>>Register_Object oCancel_bn
45374>>>>>Register_Object oOK_bn
45374>>>>>Register_Object oSearch_bn
45374>>>>>Register_Object oSelList
45374>>>>>Register_Object sl029
45374>>>>>Register_Object Wtypkin_DD
45374>>>>>
45374>>>>>
45374>>>>>//AB-IgnoreStart
45374>>>>>
45374>>>>>Use DFAllEnt.pkg
45374>>>>>Use dbList.Sub
45374>>>>>Use Button.Sub
45374>>>>>
45374>>>>>
45374>>>>>Use WTYPKIN.DD
45374>>>>>
45374>>>>>//AB-IgnoreEnd
45374>>>>>
45374>>>>>CD_Popup_Object sl029 is a dbModalPanelSub
45393>>>>>    set label to "‰ ¤ã©œ ª €§¦Ÿã¡žª" 
45394>>>>>    Set Size to 148 480
45395>>>>>    Set Location to 12 16
45396>>>>>    Set Exit_Application_Local_State to FALSE
45397>>>>>    Set Modal_State to FALSE
45398>>>>>
45398>>>>>    //AB-DDOStart
45398>>>>>
45398>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
45400>>>>>    End_Object    // Wtypkin_DD
45401>>>>>
45401>>>>>    Set Main_DD to (Wtypkin_DD(self))
45402>>>>>    Set Server to (Wtypkin_DD(self))
45403>>>>>
45403>>>>>    //AB-DDOEnd
45403>>>>>
45403>>>>>    Object oSelList is a dbListSub
45405>>>>>        Set Main_File to Wtypkin.File_Number
45406>>>>>        Set Size to 105 465
45407>>>>>        Set Location to 6 6
45408>>>>>
45408>>>>>        Begin_Row
45411>>>>>            Entry_Item Wtypkin.Wtypkin_code
45412>>>>>            Entry_Item Wtypkin.Wtypkin_descr
45413>>>>>            Entry_Item Wtypkin.Wtypkin_anti
45414>>>>>        End_Row
45419>>>>>
45419>>>>>        Set Form_Width    item 0 to 43
45420>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
45421>>>>>        
45421>>>>>        Set Form_Width    item 1 to 293
45422>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã ‰å¤ž©žª" 
45423>>>>>        
45423>>>>>        Set Form_Width    item 2 to 120
45424>>>>>        set header_label  item 2 to "„¤›œ ¥ž" 
45425>>>>>        
45425>>>>>    End_Object    // oSelList
45426>>>>>
45426>>>>>    Object oOK_bn is a ButtonSub
45428>>>>>        set label to "&„§ ¢¦šã" 
45429>>>>>        Set Location to 114 312
45430>>>>>
45430>>>>>        //AB-StoreStart
45430>>>>>        Procedure OnClick
45432>>>>>            Send OK To (oSelList(current_object))
45433>>>>>        End_Procedure
45434>>>>>        //AB-StoreEnd
45434>>>>>
45434>>>>>    End_Object    // oOK_bn
45435>>>>>
45435>>>>>    Object oCancel_bn is a ButtonSub
45437>>>>>        set label to "&€¡ç¨à©ž" 
45438>>>>>        Set Location to 114 367
45439>>>>>
45439>>>>>        //AB-StoreStart
45439>>>>>        Procedure OnClick
45441>>>>>            Send Cancel To (oSelList(current_object))
45442>>>>>        End_Procedure
45443>>>>>        //AB-StoreEnd
45443>>>>>
45443>>>>>    End_Object    // oCancel_bn
45444>>>>>
45444>>>>>    Object oSearch_bn is a ButtonSub
45446>>>>>        set label to "€&¤˜ã«ž©ž" 
45447>>>>>        Set Location to 114 422
45448>>>>>
45448>>>>>        //AB-StoreStart
45448>>>>>        Procedure OnClick
45450>>>>>            Send Search To (oSelList(current_object))
45451>>>>>        End_Procedure
45452>>>>>        //AB-StoreEnd
45452>>>>>
45452>>>>>    End_Object    // oSearch_bn
45453>>>>>
45453>>>>>
45453>>>>>    //AB-StoreStart
45453>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
45454>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
45455>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
45456>>>>>    //AB-StoreEnd
45456>>>>>
45456>>>>>CD_End_Object    // sl029
45458>>>>>>
45458>>>>>
45458>>>>>//AB/ End_Object    // prj
45458>>>Use sl029a.sl
45458>>>Use sl031.sl
INCLUDING FILE: SL031.SL
45458>>>>>//AB/ Project SL031:BTYPKIN
45458>>>>>//AB/ Object prj is a Lookup_Project
45458>>>>>//AB/     Set ProjectName to "SL031:BTYPKIN"
45458>>>>>//AB/     Set ProjectFileName to "SL031.SL"
45458>>>>>
45458>>>>>// Project Object Structure
45458>>>>>//   SL031 is a dbModalPanelSub
45458>>>>>//     Btypkin_DD is a DataDictionary
45458>>>>>//     oSelList is a dbListSub
45458>>>>>//     oOK_bn is a ButtonSub
45458>>>>>//     oCancel_bn is a ButtonSub
45458>>>>>//     oSearch_bn is a ButtonSub
45458>>>>>
45458>>>>>// Register all objects
45458>>>>>Register_Object Btypkin_DD
45458>>>>>Register_Object oCancel_bn
45458>>>>>Register_Object oOK_bn
45458>>>>>Register_Object oSearch_bn
45458>>>>>Register_Object oSelList
45458>>>>>Register_Object SL031
45458>>>>>
45458>>>>>
45458>>>>>//AB-IgnoreStart
45458>>>>>
45458>>>>>Use DFAllEnt.pkg
45458>>>>>Use dbList.Sub
45458>>>>>Use Button.Sub
45458>>>>>
45458>>>>>
45458>>>>>Use BTYPKIN.DD
INCLUDING FILE: BTYPKIN.DD
45458>>>>>>>//DDB-FileStart
45458>>>>>>>//DDB-HeaderStart
45458>>>>>>>
45458>>>>>>>// File Name : BTYPKIN.DD
45458>>>>>>>// Class Name: Btypkin_DataDictionary
45458>>>>>>>// Revision  : 114
45458>>>>>>>// Version   : 2
45458>>>>>>>
45458>>>>>>>Use  Windows           // Basic Definitions
45458>>>>>>>Use  DataDict          // DataDictionary Class Definition
45458>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
45458>>>>>>>
45458>>>>>>>Open Btypkin
45460>>>>>>>Open Bflagkin
INCLUDING FILE: BFLAGKIN.FD
45462>>>>>>>Open Bkinkat
INCLUDING FILE: BKINKAT.FD
45464>>>>>>>Open Barticl
INCLUDING FILE: BARTICL.FD
45466>>>>>>>Open Sysrecb
INCLUDING FILE: SYSRECB.FD
45468>>>>>>>
45468>>>>>>>//DDB-HeaderEnd
45468>>>>>>>//DDB-ValidationStart
45468>>>>>>>
45468>>>>>>>//DDB/ ExternalValidationTable Bfile_VT  Baxio.pkg
45468>>>>>>>
45468>>>>>>>Register_Object Bfile_VT
45468>>>>>>>Register_Object Btypkin_Btypkin_Anti_Xp_VT
45468>>>>>>>Use Baxio.pkg        // Bfile_VT
INCLUDING FILE: BAXIO.PKG
45468>>>>>>>>>// **************************************************************************
45468>>>>>>>>>// *Code Style   : Object                                                   *
45468>>>>>>>>>// *Name         : Baxio.vts                                                *
45468>>>>>>>>>// *Revision     : 1                                                        *
45468>>>>>>>>>// *Main File    :                                                          *
45468>>>>>>>>>// *Location     : \Home.Win\Easyware\ED\Appsrc                             *
45468>>>>>>>>>// *Creation Date: 01/09/99                                                 *
45468>>>>>>>>>// *Last Update  :                                                          *
45468>>>>>>>>>// *Author       : JA                                                       *
45468>>>>>>>>>// *Includes     :                                                          *
45468>>>>>>>>>// *Comments     : œ¨ â®œ  æ¢˜ «˜ static validation tables «¦¬             *
45468>>>>>>>>>// *             : module «à¤ ˜¥ ¦š¨á­à¤.                                   *
45468>>>>>>>>>// *             :                                                          *
45468>>>>>>>>>// *             :                                                          *
45468>>>>>>>>>// *Returns      :                                                          *
45468>>>>>>>>>// *             :                                                          *
45468>>>>>>>>>// *‰nown bugs   :                                                          *
45468>>>>>>>>>// *             :                                                          *
45468>>>>>>>>>// *Improvements :                                                          *
45468>>>>>>>>>// *             :                                                          *
45468>>>>>>>>>// *             :                                                          *
45468>>>>>>>>>// **************************************************************************
45468>>>>>>>>>// *                        A N A L Y S I S                                 *
45468>>>>>>>>>// **************************************************************************
45468>>>>>>>>>// *                                                                        *
45468>>>>>>>>>// **************************************************************************
45468>>>>>>>>>
45468>>>>>>>>>
45468>>>>>>>>>//Set Allow_Blank_State To TRUE
45468>>>>>>>>>
45468>>>>>>>>>//used by: 1. baxiokat.baxiokat_type
45468>>>>>>>>>Object Baxiokat_Type_VT  is a DescriptionValidationTable
45470>>>>>>>>>       set table_title to "„å›¦ª €¥ ¦š¨á­¦¬"
45471>>>>>>>>>       Procedure Fill_List
45473>>>>>>>>>                 Forward Send Fill_List
45475>>>>>>>>>                 Send Add_Table_Value  "1"  "„ ©§¨˜¡«â¦"
45476>>>>>>>>>                 send add_table_value  "2"  "¢ž¨à«â¦"
45477>>>>>>>>>       End_Procedure //fill_list
45478>>>>>>>>>End_Object   //Baxiokat_Type_VT
45479>>>>>>>>>
45479>>>>>>>>>
45479>>>>>>>>>//¡˜«˜©«á©œ ª ˜¥ ¦š¨á­à¤
45479>>>>>>>>>//used by: 1. bkinkat.baxio_stat_from :¡˜«á©«˜©ž ˜§æ
45479>>>>>>>>>//         2. bkinkat.baxio_stat_to   :¡˜«á©«˜©ž ©â
45479>>>>>>>>>//         3. baxio.baxio_status      :¡˜«á©«˜©ž
45479>>>>>>>>>//â¤˜ ˜¥ æš¨˜­¦ œå¤˜  § Ÿ˜¤æ ¤˜ ™¨œŸœå ©« ª §˜¨˜¡á«à 3 ¡˜«˜©«á©œ ª:
45479>>>>>>>>>Object Baxio_Status_VT  is a DescriptionValidationTable
45481>>>>>>>>>       set table_title to "‰˜«˜©«á©œ ª €¥ ¦š¨á­à¤"
45482>>>>>>>>>       Procedure Fill_List
45484>>>>>>>>>                 Forward Send Fill_List
45486>>>>>>>>>                 Send Add_Table_Value  "1"  "„¡¡¨œ£âª"
45487>>>>>>>>>                 Send Add_Table_Value  "2"  "„¥¦­¢ž£â¤¦"
45488>>>>>>>>>                 Send Add_Table_Value  "3"  "ƒ ˜£˜¨«¬¨ž£â¤¦"
45489>>>>>>>>>                 Send Add_Table_Value  "4"  "’˜£œå¦"
45490>>>>>>>>>                 Send Add_Table_Value  "5"  "ƒœ©£œ¬£â¤¦"
45491>>>>>>>>>
45491>>>>>>>>>       End_Procedure // fill_list
45492>>>>>>>>>End_Object   //Baxio_Status_VT1
45493>>>>>>>>>
45493>>>>>>>>>
45493>>>>>>>>>
45493>>>>>>>>>//used by: 1. btypkin.btypkin_anti1
45493>>>>>>>>>//         2. btypkin.btypkin_anti2
45493>>>>>>>>>//         3. baxio.baxio_file_in
45493>>>>>>>>>//         4. baxio.baxio_file_out
45493>>>>>>>>>//         5. baxio.baxio_lfile
45493>>>>>>>>>Object Bfile_VT  is a DescriptionValidationTable
45495>>>>>>>>>       set table_title to "‘¬¤˜¢¢˜©æ£œ¤¦ª/˜¨˜¢ã§«žª ˜§æ"
45496>>>>>>>>>       Procedure Fill_List
45498>>>>>>>>>                 Forward Send Fill_List
45500>>>>>>>>>                 Send Add_Table_Value  "-1" "ƒœ¤ “§á¨®œ "
45501>>>>>>>>>                 Send Add_Table_Value  "0"  "Data Entry"
45502>>>>>>>>>                 Send Add_Table_Value  "1"  "Š¦š˜¨ ˜©£é¤ ‚Š"
45503>>>>>>>>>                 send add_table_value  "2"  "”¦¨â˜ª"
45504>>>>>>>>>                 Send Add_Table_Value  "3"  "¨¦£žŸœ¬«é¤"
45505>>>>>>>>>                 Send Add_Table_Value  "5"  "Ž ‘¬¤˜¢¢˜©æ£œ¤¦ª"
45506>>>>>>>>>                 Send Add_Table_Value  "6"  "’œ¢.˜¨˜¢ã§«žª"
45507>>>>>>>>>       End_Procedure // fill_list
45508>>>>>>>>>End_Object   // Btypkin_Btypkin_Anti_VT
45509>>>>>>>>>
45509>>>>>>>
45509>>>>>>>Object Btypkin_Btypkin_Anti_Xp_VT  is a DescriptionValidationTable
45511>>>>>>>
45511>>>>>>>    Procedure Fill_List
45513>>>>>>>        Forward Send Fill_List
45515>>>>>>>        Send Add_Table_Value  "1"  "•¨œé¤œ«˜ "
45516>>>>>>>        Send Add_Table_Value  "2"  " ©«é¤œ«˜ "
45517>>>>>>>    End_Procedure    // Fill_List
45518>>>>>>>    //DDB-ValidationCustomStart
45518>>>>>>>    //DDB-ValidationCustomEnd
45518>>>>>>>End_Object   // Btypkin_Btypkin_Anti_Xp_VT
45519>>>>>>>//DDB-ValidationEnd
45519>>>>>>>//DDB-SelectionStart
45519>>>>>>>//DDB/ ExternalSelectionList SL031  SL031.SL
45519>>>>>>>//DDB/ ExternalSelectionList sl007  sl007.SL
45519>>>>>>>//DDB/ ExternalSelectionList sl007r  sl007r.SL
45519>>>>>>>Register_Object SL031
45519>>>>>>>Register_Object sl007
45519>>>>>>>Register_Object sl007r
45519>>>>>>>//DDB-SelectionEnd
45519>>>>>>>
45519>>>>>>>// JSJSJSJS 24/01/2001 Register_Object SL056 //¢å©«˜ gplan
45519>>>>>>>//Register_Object SL056 //¢å©«˜ vendor
45519>>>>>>>
45519>>>>>>>
45519>>>>>>>Open SysCurXr
45521>>>>>>>
45521>>>>>>>Open Barticl //©œ«á¨œ  prompt objects
45523>>>>>>>// JSJSJSJS 24/01/2001 Open Gtypkin //™¨å©¡œ  rec0 ©«ž¤ update, externalyy updated, lock on save
45523>>>>>>>//Open Ctypkin //™¨å©¡œ  rec0 ©«ž¤ update, externalyy updated, lock on save
45523>>>>>>>//Open Vtypkin //™¨å©¡œ  rec0 ©«ž¤ update, externalyy updated, lock on save
45523>>>>>>>
45523>>>>>>>
45523>>>>>>>// JSJSJSJS 24/01/2001 Use SL056.SL //¢å©«˜ gplan
45523>>>>>>>//Use SL102.SL //¢å©«˜ customer
45523>>>>>>>//Use SL???.SL //¢å©«˜ vendor
45523>>>>>>>Use sl100.sl // Clients selection list
45523>>>>>>>
45523>>>>>>>//*********************************************************************************
45523>>>>>>>//*          A N A L Y S I S                                                      *
45523>>>>>>>//*********************************************************************************
45523>>>>>>>//† ¡áŸœ ¡å¤ž©ž ˜¥ ¦š¨á­à¤ ˜§¦«œ¢œå £å˜ ©¬¤˜¢¢˜šã.
45523>>>>>>>//„§¦£â¤àª ¦¨åœ«˜  £¦¤¦©ã£˜¤«˜ â¤˜ª ©¬¤˜¢¢˜©æ£œ¤¦ª
45523>>>>>>>
45523>>>>>>>//’é¨˜, ¦  › á­¦¨¦  «ç§¦  ©¬¤˜¢¢˜©¦£â¤à¤ §¦¬ ¬§¦©«ž¨åœ  «¦ ©ç©«ž£˜ ©ã£œ¨˜, œå¤˜ 
45523>>>>>>>//¦  œ¥ãª : 1  "Š¦š˜¨ ˜©£æª ‚Š : contsrained ¢å©«˜ gplan apo-eos Btypkin.Gplan_Code_Apo
45523>>>>>>>//                                                               Btypkin.Gplan_Code_Apo
45523>>>>>>>//                               ©«ž¤ §œ¨å§«à©ž ˜¬«ã, ¦ ¢¦š˜¨ ˜©£æª §¦¬ Ÿ˜ œ§ ¢œšœå
45523>>>>>>>//                               ©«¦ barticl, Ÿ˜ "­áœ " «ž¤ ®¨âà©ž/§å©«à©ž §¦¬ â®¦¬£œ
45523>>>>>>>//                               ›ž¢é©œ  ©«¦ §œ›å¦ Btypkin.Btypkin_Anti_Xp.
45523>>>>>>>//          2  "œ¢á«žª        : ¢å©«˜ customer
45523>>>>>>>//          3  "¨¦£žŸœ¬«ãª    : ¢å©«˜ vendor
45523>>>>>>>//          4  "Š¦ §¦å         : œá¤ «¦ modula ˜¥ ¦š¨á­à¤ §¦¬¢žŸœå ˜¬«æ¤¦£˜,
45523>>>>>>>//                               «æ«œ «¦¤ ©¬¤˜¢¢˜©æ£œ¤¦ ˜§¢éª «¦¤ §¢ž¡«¨¦¢¦š¦ç£œ.
45523>>>>>>>
45523>>>>>>>//† ©¬¤˜¢¢˜šã šå¤œ«˜  £œ ˜¥ æš¨˜­˜, á¨˜ §¨â§œ  ¤˜ š¤à¨å¦¬£œ œá¤ Ÿ˜ › ˜¡ ¤ã©¦¬£œ
45523>>>>>>>//£æ¤¦¤ 1 «ç§¦ ˜¥ ¦š¨á­à¤, ã §¦¢¢¦çª (§œ›å¦ Btypkin.Baxiokat_Code).
45523>>>>>>>//„á¤ ˜¬«æ œå¤˜  0, «æ«œ ©«¦ grid «¦¬ bmove ¦ user £˜ª ›ž¢é¤œ  baxiokat,
45523>>>>>>>//˜¢¢¦ éª «¦ §œ›å¦ œå¤˜  ¡¢œ ›à£â¤¦.
45523>>>>>>>
45523>>>>>>>Class Btypkin_DataDictionary  is a DataDictionary_Sec
45524>>>>>>>
45524>>>>>>>    Procedure Construct_Object
45525>>>>>>>              Forward Send Construct_Object
45527>>>>>>>
45527>>>>>>>              //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
45527>>>>>>>              //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
45527>>>>>>>              //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
45527>>>>>>>              //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
45527>>>>>>>              Property Integer piBarticl_dd  0
45528>>>>>>>              Property Integer piBmove_dd    0
45529>>>>>>>              Property Integer piBaxio_dd    0
45530>>>>>>>              Property Integer piBaxiokat_dd 0
45531>>>>>>>              Property Integer piMustNOTConstrain Public 0
45532>>>>>>>    End_Procedure   //construct_object
45533>>>>>>>
45533>>>>>>>//      //private
45533>>>>>>>//      //¡˜¢œå«˜  ˜§¦ «ž¤ private.Exit_Btypkin_Code
45533>>>>>>>//      Procedure private.Set_Prompt_Objects_of_all_Connected_DEOs Integer liPrompt_Object_id ;
45533>>>>>>>//                                                                 Integer liField            ;
45533>>>>>>>//                                                                 Integer iMustConstrain     ;
45533>>>>>>>//                                                                 String  sPelProm
45533>>>>>>>//                Integer iMax iCount iDEO liTemp liBarticl_dd iPelListID
45533>>>>>>>
45533>>>>>>>//                Move (sl100(Self)) to iPelListID
45533>>>>>>>//             //   den exei nohma giati den kanoyn tipota sthn lista
45533>>>>>>>//             //   If (iPelListID) Set piMustConstrain     Of iPelListID to 0
45533>>>>>>>//             //   If (iPelListID) Set psIsPromhtheyths    Of iPelListID to ''
45533>>>>>>>
45533>>>>>>>//                Get piBarticl_dd to liBarticl_dd
45533>>>>>>>//                If (liBarticl_dd <> 0);
45533>>>>>>>//                Begin //œá¤ æ¤«àª ¬§á¨®œ  client ddo £œ main file «¦ barticl
45533>>>>>>>//                     Get Data_Set_User_Interface_Count of liBarticl_dd to iMax
45533>>>>>>>//                     Decrement iMax
45533>>>>>>>//                     For iCount from 0 to iMax
45533>>>>>>>//                         Move (Data_Set_User_Interface(liBarticl_dd ,iCount)) to iDEO
45533>>>>>>>//                         Get Data_Field of iDEO Item 0 to liTemp
45533>>>>>>>//                         If (liTemp = liField);
45533>>>>>>>//                         Begin //œá¤ ™¨ž¡˜ deo (dfform?) §¦¬ ˜¤˜­â¨œ«˜  ©«¦ §œ›å¦ ©¬¤˜¢¢˜©æ£œ¤¦ª
45533>>>>>>>//                            If (liPrompt_Object_id <> 0);
45533>>>>>>>//                               Begin
45533>>>>>>>//                                  Set Prompt_Object      of iDEO to liPrompt_Object_id
45533>>>>>>>//                                  Set Prompt_Button_Mode of iDEO to PB_promptOn
45533>>>>>>>//                                  If (iMustConstrain) Begin
45533>>>>>>>//                                  //   den exei nohma giati den kanoyn tipota sthn lista
45533>>>>>>>//                                  //  If (liPrompt_Object_id) Set piMustConstrain     Of liPrompt_Object_id to iMustConstrain
45533>>>>>>>//                                  //  If (liPrompt_Object_id) Set psIsPromhtheyths    Of liPrompt_Object_id to sPelProm
45533>>>>>>>//                                  End
45533>>>>>>>//                            End
45533>>>>>>>//                            Else Begin
45533>>>>>>>//                                Set Prompt_Object      of iDEO to 0
45533>>>>>>>//                                Set Prompt_Button_Mode of iDEO to PB_promptOff
45533>>>>>>>//                            End
45533>>>>>>>//                         End
45533>>>>>>>//                     Loop
45533>>>>>>>//                End
45533>>>>>>>//      End_Procedure //private.set_prompt_objects_of_all_connected_dEOS
45533>>>>>>>
45533>>>>>>>
45533>>>>>>>//    //private
45533>>>>>>>//    //¡˜¢œå«˜  ˜§æ: iexit «¦¬ btypkin_code
45533>>>>>>>//    //¡˜¢œå    «ã¤: private.Set_Prompt_Objects_of_all_Connected_DEOS
45533>>>>>>>//    //©œ«á¨œ      : «á prompt objects š ˜ «¦ barticl_anti, ˜¤á¢¦š˜ £œ «¦ btypkin_anti.
45533>>>>>>>//    Procedure private.Exit_Btypkin_Code Integer liField Integer liBtypkin_Code
45533>>>>>>>//              Integer liBtypkin_Anti1 liBaxiokat_Num liBtypkin_Anti2
45533>>>>>>>//              Integer liBaxiokat_dd liBarticl_dd
45533>>>>>>>//              String lsBarticlCode1
45533>>>>>>>
45533>>>>>>>//            // btypkin_anti
45533>>>>>>>//            // "-1" "ƒâ¤ “§á¨®œ "
45533>>>>>>>//            // "0"  "Data Entry"
45533>>>>>>>//            // "1"  "Š¦š˜¨ ˜©£é¤ ‚Š"
45533>>>>>>>//            // "2"  "”¦¨â˜ª"
45533>>>>>>>//            // "3"  "¨¦£žŸœ¬«é¤"
45533>>>>>>>//            // "5"  "Ž ‘¬¤˜¢¢˜©æ£œ¤¦ª"
45533>>>>>>>//            // "6"  "’œ¢.˜¨˜¢ã§«žª"
45533>>>>>>>
45533>>>>>>>
45533>>>>>>>
45533>>>>>>>//              Get Field_Current_Value Field Btypkin.Btypkin_Anti1 to liBtypkin_Anti1
45533>>>>>>>//              Get Field_Current_Value Field Btypkin.Btypkin_Anti2 to liBtypkin_Anti2
45533>>>>>>>//              Case Begin
45533>>>>>>>//                   Case (liBtypkin_Anti1 = 1) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ š¢
45533>>>>>>>//                         Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0 Field Barticl.Barticl_Code1 0 ''
45533>>>>>>>//                   Case Break
45533>>>>>>>
45533>>>>>>>//                   Case (liBtypkin_Anti1 = 2) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §œ¢á«œª
45533>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code1 1 ''
45533>>>>>>>//                   Case Break
45533>>>>>>>
45533>>>>>>>//                   Case (liBtypkin_Anti1 = 3) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §¨¦£žŸœ¬«âª=> ¢ ©«˜ §œ¢˜«à¤
45533>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code1 1 '1'
45533>>>>>>>//                   Case Break
45533>>>>>>>
45533>>>>>>>//                   Case Else //=4 ¢¦ §¦å:©¬¤˜¢¢˜©æ£œ¤¦ª £œ user manual data entry
45533>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0  Field Barticl.Barticl_Code1 0 ''
45533>>>>>>>//                   Case Break
45533>>>>>>>//              Case End
45533>>>>>>>
45533>>>>>>>//              Case Begin
45533>>>>>>>//                   Case (liBtypkin_Anti2 = 1) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ š¢
45533>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0 Field Barticl.Barticl_Code2 0 ''
45533>>>>>>>//                   Case Break
45533>>>>>>>
45533>>>>>>>//                   Case (liBtypkin_Anti2 = 2) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §œ¢á«œª
45533>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code2 1 ''
45533>>>>>>>//                   Case Break
45533>>>>>>>
45533>>>>>>>//                   Case (liBtypkin_Anti2 = 3) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §¨¦£žŸœ¬«âª=> Š ©«˜ œ¢˜«é¤
45533>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code2 1 '1'
45533>>>>>>>//                   Case Break
45533>>>>>>>
45533>>>>>>>//                   Case Else //=4 ¢¦ §¦å:©¬¤˜¢¢˜©æ£œ¤¦ª £œ user manual data entry
45533>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0  Field Barticl.Barticl_Code2 0 ''
45533>>>>>>>//                   Case Break
45533>>>>>>>//              Case End
45533>>>>>>>//    End_Procedure //private.exit_btypkin_code
45533>>>>>>>
45533>>>>>>>//    // New_Current_Record:
45533>>>>>>>
45533>>>>>>>//    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
45533>>>>>>>//        Integer liBtypkinCodeFldNum
45533>>>>>>>//        Forward Send New_Current_Record  iOldRec iNewRec
45533>>>>>>>//        Get_FieldNumber Btypkin.Btypkin_Code to liBtypkinCodeFldNum
45533>>>>>>>//        Send private.Exit_Btypkin_Code liBtypkinCodeFldNum Btypkin.Btypkin_Code
45533>>>>>>>//        // Insert Code Here
45533>>>>>>>//    End_Procedure   // New_Current_Record
45533>>>>>>>
45533>>>>>>>
45533>>>>>>>    //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
45533>>>>>>>    //™) ˜¤áš¤à©ž properties
45533>>>>>>>    //š) › ˜®œå¨ ©ž calculated §œ›åà¤
45533>>>>>>>    //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
45533>>>>>>>    //œ) œ¤ž£â¨à©ž properties after
45533>>>>>>>    Procedure Update
45534>>>>>>>
45534>>>>>>>              Forward Send Update
45536>>>>>>>
45536>>>>>>>              //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
45536>>>>>>>                Move SysCurXR.Company_Code  to Btypkin.Company_Code
45537>>>>>>>                Move SysCurXR.Branch_Code   to Btypkin.Branch_Code
45538>>>>>>>                Move SysCurXR.Year_Year     to Btypkin.Year_Year
45539>>>>>>>                Move SysCurXR.Year_Recr     to Btypkin.Year_Recr
45540>>>>>>>
45540>>>>>>>              //™) ˜¤áš¤à©ž properties
45540>>>>>>>
45540>>>>>>>              //š) › ˜®œå¨ ©ž calculated §œ›åà¤
45540>>>>>>>              //š.1:Gplan_Code_Apo1 (conditional)
45540>>>>>>>              //š.2:Gplan_Code_Eos1 (conditional)
45540>>>>>>>              If (Btypkin.Btypkin_Anti1 <> 1);              Begin //æ®  ˜§¦ šœ¤ ¡ã ¢¦š ©« ¡ã
45542>>>>>>>             // gts 02/12/04 oxi gia titana
45542>>>>>>>             //      Move "" to Btypkin.Gplan_Code_Apo1
45542>>>>>>>             //      Move "" to Btypkin.Gplan_Code_Eos1
45542>>>>>>>              End
45542>>>>>>>>
45542>>>>>>>
45542>>>>>>>              //š.3:Gplan_Code_Apo2 (conditional)
45542>>>>>>>              //š.4:Gplan_Code_Eos2 (conditional)
45542>>>>>>>              If (Btypkin.Btypkin_Anti2 <> 1);              Begin //æ®  ˜§¦ šœ¤ ¡ã ¢¦š ©« ¡ã
45544>>>>>>>                   Move "" to Btypkin.Gplan_Code_Apo2
45545>>>>>>>                   Move "" to Btypkin.Gplan_Code_Eos2
45546>>>>>>>              End
45546>>>>>>>>
45546>>>>>>>
45546>>>>>>>              //š.3:gtypkin_rec0 (conditional)
45546>>>>>>>              Case Begin
45546>>>>>>>                   Case (Btypkin.Gtypkin_Code <> 0) //œ¤ž£œ¨é¤œ  šœ¤ ¡ã ¢¦š ©« ¡ã
45548>>>>>>>//jsjsjs 24/01/2001
45548>>>>>>>//                         Clear Gtypkin
45548>>>>>>>//                         Move Btypkin.Company_Code to Gtypkin.Company_Code
45548>>>>>>>//                         Move Btypkin.Branch_Code  to Gtypkin.Branch_Code
45548>>>>>>>//                         Move Btypkin.Year_Year    to Gtypkin.Year_Year
45548>>>>>>>//                         Move Btypkin.Gtypkin_Code to Gtypkin.Gtypkin_Code
45548>>>>>>>//                         Find Eq Gtypkin by Index.1 //company_code+branch_code+year_year+gtypkin_code
45548>>>>>>>//                         If (Found = 1) Move Gtypkin.Gtypkin_Rec0 to Btypkin.Gtypkin_Rec0
45548>>>>>>>//                         Else           Send Operation_Not_Allowed 3001 //›â¤ ™¨âŸž¡œ «¦ gtypkin_rec0, please reindex
45548>>>>>>>//jsjsjs 24/01/2001
45548>>>>>>>                   Case Break
45549>>>>>>>                   Case Else                        //›â¤ œ¤ž£œ¨é¤œ  šœ¤ ¡ã ¢¦š ©« ¡ã
45549>>>>>>>                         Move 0 to Btypkin.Gtypkin_Rec0
45550>>>>>>>              Case End
45550>>>>>>>
45550>>>>>>>              //š.4:ctypkin_rec0 (conditional)
45550>>>>>>>              Case Begin
45550>>>>>>>                   Case (Btypkin.Ctypkin_Code <> 0) //œ¤ž£œ¨é¤œ  §œ¢á«œª
45552>>>>>>>                         Clear Ctypkin
45553>>>>>>>                         Move Btypkin.Company_Code to Ctypkin.Company_Code
45554>>>>>>>                         Move Btypkin.Branch_Code  to Ctypkin.Branch_Code
45555>>>>>>>                         Move Btypkin.Year_Year    to Ctypkin.Year_Year
45556>>>>>>>                         Move Btypkin.Ctypkin_Code to Ctypkin.Ctypkin_Code
45557>>>>>>>                         Find Eq Ctypkin by Index.1 //company_code+branch_code+year_year+Ctypkin_code
45558>>>>>>>>
45558>>>>>>>                         If (Found = 1) Begin
45560>>>>>>>                            Move Ctypkin.Ctypkin_Rec0 to Btypkin.Ctypkin_Rec0
45561>>>>>>>                            Move Ctypkin.Ctypkin_Recr to Btypkin.Ctypkin_Recr
45562>>>>>>>                         End
45562>>>>>>>>
45562>>>>>>>                         Else           Send Operation_Not_Allowed 3002 //›â¤ ™¨âŸž¡œ «¦ Ctypkin_rec0, please reindex
45564>>>>>>>                   Case Break
45565>>>>>>>                   Case Else                        //›â¤ œ¤ž£œ¨é¤œ  §œ¢á«œª
45565>>>>>>>                         Move  0 to Btypkin.Ctypkin_Rec0
45566>>>>>>>                         Move '' to Btypkin.Ctypkin_Recr
45567>>>>>>>              Case End
45567>>>>>>>
45567>>>>>>>              //š.5:vtypkin_rec0 (conditional)
45567>>>>>>>              Case Begin
45567>>>>>>>                   Case (Btypkin.Vtypkin_Code <> 0) //œ¤ž£œ¨é¤œ  §¨¦£žŸœ¬«âª
45569>>>>>>>                         //Clear Vtypkin
45569>>>>>>>                         //Move Btypkin.Company_Code to Vtypkin.Company_Code
45569>>>>>>>                         //Move Btypkin.Branch_Code  to Vtypkin.Branch_Code
45569>>>>>>>                         //Move Btypkin.Year_Year    to Vtypkin.Year_Year
45569>>>>>>>                         //Move Btypkin.Vtypkin_Code to Vtypkin.Vtypkin_Code
45569>>>>>>>                         //Find Eq Vtypkin by Index.1 //company_code+branch_code+year_year+Vtypkin_code
45569>>>>>>>                         //If (Found = 1) Move Vtypkin.Vtypkin_Rec0 to Btypkin.Vtypkin_Rec0
45569>>>>>>>                         //Else           Send Operation_Not_Allowed 3003 //›â¤ ™¨âŸž¡œ «¦ Vtypkin_rec0, please reindex
45569>>>>>>>                   Case Break
45570>>>>>>>                   Case Else                        //›â¤ œ¤ž£œ¨é¤œ  §¨¦£žŸœ¬«âª
45570>>>>>>>                         Move 0 to Btypkin.Vtypkin_Rec0
45571>>>>>>>              Case End
45571>>>>>>>
45571>>>>>>>              //š.6:btypkin_l_hmnia (conditional)
45571>>>>>>>              If (Btypkin.Btypkin_L_No = 0) Move 0 to Btypkin.Btypkin_L_Hmnia
45574>>>>>>>
45574>>>>>>>
45574>>>>>>>              //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
45574>>>>>>>
45574>>>>>>>              //œ) œ¤ž£â¨à©ž properties after
45574>>>>>>>    End_Procedure //update
45575>>>>>>>
45575>>>>>>>    Procedure Creating
45576>>>>>>>              Forward Send Creating
45578>>>>>>>              //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBtypkin //˜¨ Ÿ£æª á¨Ÿ¨à¤ «žª ®¨ã©žª
45578>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Btypkin.Btypkin_Rec0)))))) to Btypkin.Btypkin_Recr
45579>>>>>>>    End_Procedure //creating
45580>>>>>>>
45580>>>>>>>//    Procedure OnConstrain
45580>>>>>>>//        Set piMustNOTConstrain to True
45580>>>>>>>        
45580>>>>>>>//        If (piMustNOTConstrain(Self)) Begin
45580>>>>>>>//        End
45580>>>>>>>//        Else Begin
45580>>>>>>>//            Constrain Btypkin.Company_Code  eq SysCurXR.Company_Code
45580>>>>>>>//            Constrain Btypkin.Branch_Code   eq SysCurXR.Branch_Code
45580>>>>>>>//            Constrain Btypkin.Year_Year     eq SysCurXR.Year_Year
45580>>>>>>>//        End
45580>>>>>>>//    End_Procedure
45580>>>>>>>
45580>>>>>>>
45580>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
45581>>>>>>>              String lsError_Message
45582>>>>>>>              Case Begin
45582>>>>>>>                   //˜§æ validate save
45582>>>>>>>                   Case (iError_Num = 1001)
45584>>>>>>>                        //Move ("DDC 141:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† «¨¦§¦§¦åž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");
45584>>>>>>>                        //to lsError_Message
45584>>>>>>>                   Case Break
45585>>>>>>>                   Case (iError_Num = 1100)
45588>>>>>>>                        Move "DDC 141:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
45589>>>>>>>                        Case Break
45590>>>>>>>
45590>>>>>>>                   //˜§æ validate delete
45590>>>>>>>                   Case (iError_Num = 2001)
45593>>>>>>>                        //Clear Codemast
45593>>>>>>>                        //Move ("DDC 141:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n† › ˜š¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");
45593>>>>>>>                        //to lsError_Message
45593>>>>>>>                   Case Break
45594>>>>>>>                   Case (iError_Num = 2100)
45597>>>>>>>                        Move "DDC 141:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
45598>>>>>>>                        Case Break
45599>>>>>>>
45599>>>>>>>                   //˜§æ update
45599>>>>>>>                   Case (iError_Num = 3001)
45602>>>>>>>                        Move ("DDC 141:ƒâ¤ ™¨âŸž¡œ ž ˜¤«å©«¦ ®ž ¡å¤ž©ž «žª ‚œ¤ ¡ãª Š¦š ©« ¡ãª !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
45603>>>>>>>                   Case Break
45604>>>>>>>                   Case (iError_Num = 3002)
45607>>>>>>>                        Move ("DDC 141:ƒâ¤ ™¨âŸž¡œ ž ˜¤«å©«¦ ®ž ¡å¤ž©ž «é¤ œ¢˜«é¤ !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
45608>>>>>>>                   Case Break
45609>>>>>>>                   Case (iError_Num = 3003)
45612>>>>>>>                        Move ("DDC 141:ƒâ¤ ™¨âŸž¡œ ž ˜¤«å©«¦ ®ž ¡å¤ž©ž «é¤ ¨¦£žŸœ¬«é¤ !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
45613>>>>>>>                   Case Break
45614>>>>>>>
45614>>>>>>>
45614>>>>>>>
45614>>>>>>>                   Case Else
45614>>>>>>>                        Forward Send Operation_Not_Allowed iError_Num
45616>>>>>>>              Case End
45616>>>>>>>
45616>>>>>>>              Error iError_Num lsError_Message
45617>>>>>>>>
45617>>>>>>>    End_Procedure // operation_not_allowed
45618>>>>>>>
45618>>>>>>>
45618>>>>>>>//    //1001:
45618>>>>>>>//    //˜§˜š¦¨œçœ«˜  «¦ btypkin ¤˜ ˜¢¢áœ  parent year
45618>>>>>>>//    Function Validate_Save Returns Integer
45618>>>>>>>//             Integer iReturnVal
45618>>>>>>>
45618>>>>>>>//             Forward Get Validate_Save to iReturnVal
45618>>>>>>>
45618>>>>>>>//             If (Not(iReturnVal));
45618>>>>>>>//             Begin
45618>>>>>>>//                  //1100:cby = globals
45618>>>>>>>//                  If ( ;
45618>>>>>>>//                      (Not(Btypkin.Company_Code = SysCurXR.Company_Code))or ;
45618>>>>>>>//                      (Not(Btypkin.Branch_Code  = SysCurXR.Branch_Code)) or ;
45618>>>>>>>//                      (Not(Btypkin.Year_Year    = SysCurXR.Year_Year))      ;
45618>>>>>>>//                      )                                                   Send Operation_Not_Allowed 1100
45618>>>>>>>//             End //«â¢¦ª ¡é› ¡˜ validation
45618>>>>>>>//             Function_Return iReturnVal
45618>>>>>>>//    End_Function   // validate_save
45618>>>>>>>
45618>>>>>>>
45618>>>>>>>//    //2001:
45618>>>>>>>//    Function Validate_Delete  Returns Integer
45618>>>>>>>//             Integer iReturnVal
45618>>>>>>>//             Forward Get Validate_Delete  To iReturnVal
45618>>>>>>>//             If (Not(iReturnVal));
45618>>>>>>>//             Begin
45618>>>>>>>
45618>>>>>>>//                  //2100:cby = globals
45618>>>>>>>//                  If ( ;
45618>>>>>>>//                      (Not(Btypkin.Company_Code = SysCurXR.Company_Code))or ;
45618>>>>>>>//                      (Not(Btypkin.Branch_Code  = SysCurXR.Branch_Code)) or ;
45618>>>>>>>//                      (Not(Btypkin.Year_Year    = SysCurXR.Year_Year))      ;
45618>>>>>>>//                      )                                                   Send Operation_Not_Allowed 2100
45618>>>>>>>//             End //«â¢¦ª ¡é› ¡˜ validation
45618>>>>>>>//             Function_Return iReturnVal
45618>>>>>>>//    End_Function   // Validate_Delete
45618>>>>>>>
45618>>>>>>>
45618>>>>>>>    Procedure Define_Fields
45619>>>>>>>        Forward Send Define_Fields
45621>>>>>>>        //DDB-Generated-Code-Location
45621>>>>>>>        //DDB-DefineFieldStart
45621>>>>>>>
45621>>>>>>>        Set Main_File            To Btypkin.File_Number
45622>>>>>>>        Set Cascade_Delete_State To FALSE
45623>>>>>>>
45623>>>>>>>
45623>>>>>>>        // Child (Client) file structure................
45623>>>>>>>        Send Add_Client_File  Bflagkin.File_Number
45624>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
45625>>>>>>>        Send Add_Client_File  Barticl.File_Number
45626>>>>>>>
45626>>>>>>>        // External (System) file structure.............
45626>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
45627>>>>>>>
45627>>>>>>>        Define_Auto_Increment  Sysrecb.Btypkin_Rec0  To Btypkin.Btypkin_Rec0
45630>>>>>>>
45630>>>>>>>        // Field-based properties.......................
45630>>>>>>>
45630>>>>>>>        // Btypkin.Company_Code
45630>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Company_Code To "„¤ž£œ¨é¤œ«˜  ©«ž¤ update"
45630>>>>>>>
45630>>>>>>>        // Btypkin.Branch_Code
45630>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Branch_Code To "„¤ž£œ¨é¤œ«˜  ©«ž¤ update"
45630>>>>>>>
45630>>>>>>>        // Btypkin.Year_Year
45630>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Year_Year To "„¤ž£œ¨é¤œ«˜  ©«ž¤ update"
45630>>>>>>>
45630>>>>>>>        // Btypkin.Btypkin_Code
45630>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Code To (SL031(Self))
45631>>>>>>>
45631>>>>>>>        // Btypkin.Btypkin_Rec0
45631>>>>>>>
45631>>>>>>>        // Btypkin.Btypkin_Recr
45631>>>>>>>
45631>>>>>>>        // Btypkin.Year_Recr
45631>>>>>>>
45631>>>>>>>        // Btypkin.Btypkin_Descr
45631>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Descr To (SL031(Self))
45632>>>>>>>
45632>>>>>>>        // Btypkin.Gtypkin_Code
45632>>>>>>>
45632>>>>>>>        // Btypkin.Ctypkin_Code
45632>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Ctypkin_Code To (sl007(Self))
45633>>>>>>>
45633>>>>>>>        // Btypkin.Vtypkin_Code
45633>>>>>>>
45633>>>>>>>        // Btypkin.Gtypkin_Rec0
45633>>>>>>>
45633>>>>>>>        // Btypkin.Ctypkin_Rec0
45633>>>>>>>
45633>>>>>>>        // Btypkin.Vtypkin_Rec0
45633>>>>>>>
45633>>>>>>>        // Btypkin.Btypkin_Anti1
45633>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti1 To (Bfile_VT(Self))
45634>>>>>>>
45634>>>>>>>        // Btypkin.Gplan_Code_Apo1
45634>>>>>>>
45634>>>>>>>        // Btypkin.Gplan_Code_Eos1
45634>>>>>>>
45634>>>>>>>        // Btypkin.Btypkin_Anti2
45634>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti2 To (Bfile_VT(Self))
45635>>>>>>>
45635>>>>>>>        // Btypkin.Gplan_Code_Apo2
45635>>>>>>>
45635>>>>>>>        // Btypkin.Gplan_Code_Eos2
45635>>>>>>>
45635>>>>>>>        // Btypkin.Bflagkin_Num
45635>>>>>>>
45635>>>>>>>        // Btypkin.Bkinkat_Num
45635>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Bkinkat_Num To "“§¦¢¦šåœ«˜  ©«ž¤ update «¦¬ bkinkat."
45635>>>>>>>
45635>>>>>>>        // Btypkin.Btypkin_Anti_Xp
45635>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti_Xp To (Btypkin_Btypkin_Anti_Xp_VT(Self))
45636>>>>>>>
45636>>>>>>>        // Btypkin.Btypkin_Printer
45636>>>>>>>
45636>>>>>>>        // Btypkin.Btypkin_Pdescr
45636>>>>>>>
45636>>>>>>>        // Btypkin.Btypkin_Form
45636>>>>>>>
45636>>>>>>>        // Btypkin.Btypkin_L_No
45636>>>>>>>
45636>>>>>>>        // Btypkin.Btypkin_L_Hmnia
45636>>>>>>>        Set Field_Mask_Type        Field Btypkin.Btypkin_L_Hmnia To MASK_DATE_WINDOW
45637>>>>>>>
45637>>>>>>>        // Btypkin.Btypkin_Seira
45637>>>>>>>
45637>>>>>>>        // Btypkin.Btypkin_Abr
45637>>>>>>>
45637>>>>>>>        // Btypkin.Btypkin_Flag01
45637>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Btypkin_Flag01 To "“§¦¢¦šåœ«˜  ©«ž¤ update/backout «¦¬ bflagkin."
45637>>>>>>>
45637>>>>>>>        // Btypkin.Btypkin_Flag02
45637>>>>>>>
45637>>>>>>>        // Btypkin.Btypkin_Flag03
45637>>>>>>>
45637>>>>>>>        // Btypkin.Btypkin_Flag04
45637>>>>>>>
45637>>>>>>>        // Btypkin.Btypkin_Flag05
45637>>>>>>>        Set Field_Checkbox_Values  Field Btypkin.Btypkin_Flag05 To "1"  "0"
45638>>>>>>>
45638>>>>>>>        // Btypkin.Btypkin_Flag06
45638>>>>>>>
45638>>>>>>>        // Btypkin.Btypkin_Flag07
45638>>>>>>>
45638>>>>>>>        // Btypkin.Btypkin_Flag08
45638>>>>>>>
45638>>>>>>>        // Btypkin.Btypkin_Flag09
45638>>>>>>>
45638>>>>>>>        // Btypkin.Btypkin_Flag10
45638>>>>>>>
45638>>>>>>>        // Btypkin.Btypkin_Flag11
45638>>>>>>>
45638>>>>>>>        // Btypkin.Btypkin_Flag12
45638>>>>>>>
45638>>>>>>>        // Btypkin.Btypkin_Flag13
45638>>>>>>>
45638>>>>>>>        // Btypkin.Btypkin_Flag14
45638>>>>>>>
45638>>>>>>>        // Btypkin.Btypkin_Flag15
45638>>>>>>>
45638>>>>>>>        // Btypkin.Btypkin_Flag16
45638>>>>>>>
45638>>>>>>>        // Btypkin.Btypkin_Flag17
45638>>>>>>>
45638>>>>>>>        // Btypkin.Btypkin_Flag18
45638>>>>>>>
45638>>>>>>>        // Btypkin.Btypkin_Flag19
45638>>>>>>>
45638>>>>>>>        // Btypkin.Btypkin_Flag20
45638>>>>>>>
45638>>>>>>>        // Btypkin.Btypkin_Sign
45638>>>>>>>        Set Field_Checkbox_Values  Field Btypkin.Btypkin_Sign To "1"  "-1"
45639>>>>>>>
45639>>>>>>>        // Btypkin.Ctypkin_Recr
45639>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Ctypkin_Recr To (sl007r(Self))
45640>>>>>>>
45640>>>>>>>        // Btypkin.Label
45640>>>>>>>
45640>>>>>>>        // Btypkin.Locked
45640>>>>>>>
45640>>>>>>>        // Btypkin.Locked_Date
45640>>>>>>>        Set Field_Mask_Type        Field Btypkin.Locked_Date To MASK_DATE_WINDOW
45641>>>>>>>
45641>>>>>>>        //DDB-DefineFieldEnd
45641>>>>>>>
45641>>>>>>>        Set Main_File            To Btypkin.File_Number
45642>>>>>>>        Set Cascade_Delete_State To FALSE
45643>>>>>>>
45643>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
45644>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
45645>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
45646>>>>>>>
45646>>>>>>>        // Child (Client) file structure................
45646>>>>>>>        Send Add_Client_File  Bflagkin.File_Number
45647>>>>>>>        Send Add_Client_File  Barticl.File_Number
45648>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
45649>>>>>>>
45649>>>>>>>        // External (System) file structure.............
45649>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
45650>>>>>>>        //Send Add_System_File  Gtypkin.File_Number  DD_LOCK_ON_SAVE
45650>>>>>>>
45650>>>>>>>        Define_Auto_Increment  Sysrecb.Btypkin_Rec0  To Btypkin.Btypkin_Rec0
45653>>>>>>>
45653>>>>>>>        // Field-based properties.......................
45653>>>>>>>
45653>>>>>>>        // Btypkin.Company_Code
45653>>>>>>>
45653>>>>>>>        // Btypkin.Branch_Code
45653>>>>>>>
45653>>>>>>>        // Btypkin.Year_Year
45653>>>>>>>
45653>>>>>>>        // Btypkin.Btypkin_Code
45653>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Code     To "‰à› ¡æª ‰å¤ž©žª"
45654>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Code     To "‰å¤ž©ž"
45655>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Code     To DD_AUTOFIND    DD_REQUIRED
45656>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Code     To (sl031(Self))
45657>>>>>>>        Set Key_Field_State        Field Btypkin.Btypkin_Code     To TRUE
45658>>>>>>>
45658>>>>>>>        // Btypkin.Btypkin_Rec0
45658>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Rec0     To DD_AUTOFIND    DD_NOPUT       DD_REQUIRED
45659>>>>>>>        Set Key_Field_State        Field Btypkin.Btypkin_Rec0     To TRUE
45660>>>>>>>
45660>>>>>>>        // Btypkin.Year_Rec0
45660>>>>>>>
45660>>>>>>>        // Btypkin.Btypkin_Descr
45660>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Descr    To "œ¨ š¨˜­ã ‰å¤ž©žª"
45661>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Descr    To "œ¨ š¨˜­ã"
45662>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Descr    To (sl031(Self))
45663>>>>>>>
45663>>>>>>>        // Btypkin.Gtypkin_Code
45663>>>>>>>        Set Field_Label_Long       Field Btypkin.Gtypkin_Code     To "‰å¤ž©ž ‚Š"
45664>>>>>>>        Set Field_Label_Short      Field Btypkin.Gtypkin_Code     To "‰å¤ž©ž ‚Š"
45665>>>>>>>        //Set Field_Prompt_Object    Field Btypkin.Gtypkin_Code     To (SL055(Self))
45665>>>>>>>
45665>>>>>>>        // Btypkin.Ctypkin_Code
45665>>>>>>>        Set Field_Label_Long       Field Btypkin.Ctypkin_Code     To "‰å¤ž©ž œ¢˜«é¤"
45666>>>>>>>        Set Field_Label_Short      Field Btypkin.Ctypkin_Code     To "‰å¤ž©ž œ¢˜«é¤"
45667>>>>>>>
45667>>>>>>>        // Btypkin.Vtypkin_Code
45667>>>>>>>        Set Field_Label_Long       Field Btypkin.Vtypkin_Code     To "‰å¤ž©ž ¨¦£žŸœ¬«é¤"
45668>>>>>>>        Set Field_Label_Short      Field Btypkin.Vtypkin_Code     To "‰å¤ž©ž ¨¦£žŸœ¬«é¤"
45669>>>>>>>
45669>>>>>>>        // Btypkin.Gtypkin_Rec0
45669>>>>>>>        Set Field_Options          Field Btypkin.Gtypkin_Rec0     To DD_DISPLAYONLY
45670>>>>>>>
45670>>>>>>>        // Btypkin.Ctypkin_Rec0
45670>>>>>>>        Set Field_Options          Field Btypkin.Ctypkin_Rec0     To DD_DISPLAYONLY
45671>>>>>>>
45671>>>>>>>        // Btypkin.Vtypkin_Rec0
45671>>>>>>>        Set Field_Options          Field Btypkin.Vtypkin_Rec0     To DD_DISPLAYONLY
45672>>>>>>>
45672>>>>>>>        // Btypkin.Btypkin_Anti1
45672>>>>>>>        Set Field_Class_Name       Field Btypkin.Btypkin_Anti1    To "dbComboForm_EZ"
45673>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Anti1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª ˜§¦ ˜¨®œå¦:"
45674>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Anti1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª"
45675>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti1    To (Bfile_VT(Self))
45676>>>>>>>
45676>>>>>>>        // Btypkin.Gplan_Code_Apo1
45676>>>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Apo1  To "€§¦ ‰à› ¡æ ‚Š"
45677>>>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Apo1  To "€§¦ ‰à› ¡æ ‚Š"
45678>>>>>>>
45678>>>>>>>        // Btypkin.Gplan_Code_Eos1
45678>>>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Eos1  To "„àª ‰à› ¡æ ‚Š"
45679>>>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Eos1  To "„àª ‰à› ¡æ ‚Š"
45680>>>>>>>
45680>>>>>>>        // Btypkin.Btypkin_Anti2
45680>>>>>>>        Set Field_Class_Name       Field Btypkin.Btypkin_Anti2    To "dbComboForm_EZ"
45681>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Anti2    To "˜¨˜¢ã§«žª ˜§¦ ˜¨®œå¦:"
45682>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Anti2    To "˜¨˜¢ã§«žª"
45683>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti2    To (Bfile_VT(Self))
45684>>>>>>>
45684>>>>>>>        // Btypkin.Gplan_Code_Apo2
45684>>>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Apo2  To "€§¦ ‰à› ¡æ ‚Š"
45685>>>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Apo2  To "€§¦ ‰à› ¡æ ‚Š"
45686>>>>>>>
45686>>>>>>>        // Btypkin.Gplan_Code_Eos2
45686>>>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Eos2  To "„àª ‰à› ¡æ ‚Š"
45687>>>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Eos2  To "„àª ‰à› ¡æ ‚Š"
45688>>>>>>>
45688>>>>>>>        // Btypkin.Bflagkin_Num
45688>>>>>>>        Set Field_Label_Long       Field Btypkin.Bflagkin_Num     To "¢ãŸ¦ª Flags"
45689>>>>>>>        Set Field_Label_Short      Field Btypkin.Bflagkin_Num     To "¢ãŸ¦ª Flags"
45690>>>>>>>        Set Field_Options          Field Btypkin.Bflagkin_Num     To DD_DISPLAYONLY
45691>>>>>>>
45691>>>>>>>        // Btypkin.Bkinkat_Num
45691>>>>>>>        Set Field_Label_Long       Field Btypkin.Bkinkat_Num      To "¢ãŸ¦ª ‰˜«žš¦¨ é¤ €¥ é¤"
45692>>>>>>>        Set Field_Label_Short      Field Btypkin.Bkinkat_Num      To "¢ãŸ¦ª ‰˜«.€¥ é¤"
45693>>>>>>>        Set Field_Options          Field Btypkin.Bkinkat_Num      To DD_DISPLAYONLY
45694>>>>>>>
45694>>>>>>>        // Btypkin.Btypkin_Anti_Xp
45694>>>>>>>        Set Field_Class_Name       Field Btypkin.Btypkin_Anti_Xp  To "dbComboForm_EZ"
45695>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Anti_Xp  To "Ž ©¬¤˜¢¢˜©æ£œ¤¦ª:"
45696>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Anti_Xp  To "• ‘¬¤˜¢¢˜©¦£â¤¦¬"
45697>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti_Xp  To (Btypkin_Btypkin_Anti_Xp_VT(Self))
45698>>>>>>>
45698>>>>>>>        // Btypkin.Btypkin_Printer
45698>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Printer  To "ƒ œçŸ¬¤©ž „¡«¬§à«ã"
45699>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Printer  To "„¡«¬§à«ãª"
45700>>>>>>>
45700>>>>>>>        // Btypkin.Btypkin_Pdescr
45700>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Pdescr   To "’å«¢¦ª „¡«ç§à©žª"
45701>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Pdescr   To "’å«¢¦ª „¡«ç§à©žª"
45702>>>>>>>
45702>>>>>>>        // Btypkin.Btypkin_Form
45702>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Form     To "”æ¨£˜ „¡«ç§à©žª"
45703>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Form     To "”æ¨£˜"
45704>>>>>>>
45704>>>>>>>        // Btypkin.Btypkin_L_No
45704>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_L_No     To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª"
45705>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_L_No     To "’œ¢.€¨."
45706>>>>>>>        //Set Field_Options          Field Btypkin.Btypkin_L_No     To DD_DISPLAYONLY
45706>>>>>>>
45706>>>>>>>        // Btypkin.Btypkin_L_Hmnia
45706>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_L_Hmnia  To "’œ¢œ¬«˜å˜ †£/¤å˜"
45707>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_L_Hmnia  To "’œ¢.†£/¤å˜"
45708>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_L_Hmnia  To DD_DISPLAYONLY
45709>>>>>>>
45709>>>>>>>        // Btypkin.Btypkin_Seira
45709>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Seira    To "‘œ ¨á"
45710>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Seira    To "‘œ ¨á"
45711>>>>>>>
45711>>>>>>>        // Btypkin.Btypkin_Abr
45711>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Abr      To "‘¬¤«¦£¦š¨˜­å˜"
45712>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Abr      To "‘¬¤«/­å˜"
45713>>>>>>>
45713>>>>>>>        // Btypkin.Btypkin_Flag01
45713>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag01   To DD_DISPLAYONLY
45714>>>>>>>
45714>>>>>>>        // Btypkin.Btypkin_Flag02
45714>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag02   To DD_DISPLAYONLY
45715>>>>>>>
45715>>>>>>>        // Btypkin.Btypkin_Flag03
45715>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag03   To DD_DISPLAYONLY
45716>>>>>>>
45716>>>>>>>        // Btypkin.Btypkin_Flag04
45716>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag04   To DD_DISPLAYONLY
45717>>>>>>>
45717>>>>>>>        // Btypkin.Btypkin_Flag05
45717>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag05   To DD_DISPLAYONLY
45718>>>>>>>
45718>>>>>>>        // Btypkin.Btypkin_Flag06
45718>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag06   To DD_DISPLAYONLY
45719>>>>>>>
45719>>>>>>>        // Btypkin.Btypkin_Flag07
45719>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag07   To DD_DISPLAYONLY
45720>>>>>>>
45720>>>>>>>        // Btypkin.Btypkin_Flag08
45720>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag08   To DD_DISPLAYONLY
45721>>>>>>>
45721>>>>>>>        // Btypkin.Btypkin_Flag09
45721>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag09   To DD_DISPLAYONLY
45722>>>>>>>
45722>>>>>>>        // Btypkin.Btypkin_Flag10
45722>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag10   To DD_DISPLAYONLY
45723>>>>>>>
45723>>>>>>>        // Btypkin.Btypkin_Flag11
45723>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag11   To DD_DISPLAYONLY
45724>>>>>>>
45724>>>>>>>        // Btypkin.Btypkin_Flag12
45724>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag12   To DD_DISPLAYONLY
45725>>>>>>>
45725>>>>>>>        // Btypkin.Btypkin_Flag13
45725>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag13   To DD_DISPLAYONLY
45726>>>>>>>
45726>>>>>>>        // Btypkin.Btypkin_Flag14
45726>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag14   To DD_DISPLAYONLY
45727>>>>>>>
45727>>>>>>>        // Btypkin.Btypkin_Flag15
45727>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag15   To DD_DISPLAYONLY
45728>>>>>>>
45728>>>>>>>        // Btypkin.Btypkin_Flag16
45728>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag16   To DD_DISPLAYONLY
45729>>>>>>>
45729>>>>>>>        // Btypkin.Btypkin_Flag17
45729>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag17   To DD_DISPLAYONLY
45730>>>>>>>
45730>>>>>>>        // Btypkin.Btypkin_Flag18
45730>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag18   To DD_DISPLAYONLY
45731>>>>>>>
45731>>>>>>>        // Btypkin.Btypkin_Flag19
45731>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag19   To DD_DISPLAYONLY
45732>>>>>>>
45732>>>>>>>        // Btypkin.Btypkin_Flag20
45732>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag20   To DD_DISPLAYONLY
45733>>>>>>>
45733>>>>>>>    End_Procedure    // Define_Fields
45734>>>>>>>
45734>>>>>>>
45734>>>>>>>
45734>>>>>>>    // Field_Defaults:
45734>>>>>>>    // This procedure is used to establish default field values.
45734>>>>>>>
45734>>>>>>>    Procedure Field_Defaults
45735>>>>>>>        Forward Send Field_Defaults
45737>>>>>>>        //DDB-Generated-Code-Location
45737>>>>>>>        //DDB-FieldDefaultStart
45737>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Anti1 To 0
45738>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Anti2 To 0
45739>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Anti_Xp To 1
45740>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Flag05 To 0
45741>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Sign To 1
45742>>>>>>>        //DDB-FieldDefaultEnd
45742>>>>>>>    End_Procedure    // Field_Defaults
45743>>>>>>>End_Class    // Btypkin_DataDictionary
45744>>>>>>>//DDB-Selection-pkg-Start
45744>>>>>>>
45744>>>>>>>Use SL031.SL         // SL031
45744>>>>>>>Use sl007.SL         // sl007
45744>>>>>>>Use sl007r.SL        // sl007r
45744>>>>>>>
45744>>>>>>>//DDB-Selection-pkg-End
45744>>>>>>>//DDB-FileEnd
45744>>>>>
45744>>>>>//AB-IgnoreEnd
45744>>>>>
45744>>>>>CD_Popup_Object SL031 is a dbModalPanelSub
45763>>>>>    Set Label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤"
45764>>>>>    Set Size to 213 506
45765>>>>>    Set Location to 4 5
45766>>>>>    Set Exit_Application_Local_State to FALSE
45767>>>>>    Set Modal_State to FALSE
45768>>>>>
45768>>>>>    //AB-DDOStart
45768>>>>>
45768>>>>>    Object Btypkin_DD is a Btypkin_DataDictionary
45770>>>>>    End_Object    // Btypkin_DD
45771>>>>>
45771>>>>>    Set Main_DD to (Btypkin_DD(self))
45772>>>>>    Set Server to (Btypkin_DD(self))
45773>>>>>
45773>>>>>    //AB-DDOEnd
45773>>>>>
45773>>>>>    Object oSelList is a dbListSub
45775>>>>>        Set Main_File to Btypkin.File_Number
45776>>>>>        Set Size to 173 491
45777>>>>>        Set Location to 3 6
45778>>>>>
45778>>>>>        Begin_Row
45781>>>>>            Entry_Item Btypkin.Btypkin_code
45782>>>>>            Entry_Item Btypkin.Btypkin_descr
45783>>>>>            Entry_Item Btypkin.Gtypkin_code
45784>>>>>            Entry_Item Btypkin.Ctypkin_code
45785>>>>>            Entry_Item Btypkin.Vtypkin_code
45786>>>>>            Entry_Item Btypkin.Btypkin_anti_xp
45787>>>>>            Entry_Item Btypkin.Locked
45788>>>>>        End_Row
45793>>>>>
45793>>>>>        Set Form_Width    item 0 to 39
45794>>>>>        Set Header_Label  item 0 to "‰å¤ž©ž"
45795>>>>>        
45795>>>>>        Set Form_Width    item 1 to 172
45796>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
45797>>>>>        
45797>>>>>        Set Form_Width    item 2 to 46
45798>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž ‚Š"
45799>>>>>        
45799>>>>>        Set Form_Width    item 3 to 70
45800>>>>>        Set Header_Label  item 3 to "‰å¤ž©ž œ¢˜«é¤        "
45801>>>>>        
45801>>>>>        Set Form_Width    item 4 to 53
45802>>>>>        Set Header_Label  item 4 to "‰å¤ž©ž ¨¦£."
45803>>>>>        
45803>>>>>        Set Form_Width    item 5 to 64
45804>>>>>        Set Header_Label  item 5 to "• ‘¬¤˜¢¢˜©¦£."
45805>>>>>        
45805>>>>>        Set Form_Width    item 6 to 42
45806>>>>>        Set Header_Label  item 6 to "‰¢œ ›à£â¤ž"
45807>>>>>        Set Column_Checkbox_State  item 6 to True
45808>>>>>        
45808>>>>>    End_Object    // oSelList
45809>>>>>
45809>>>>>    Object oOK_bn is a ButtonSub
45811>>>>>        Set Label to "&„§ ¢¦šã"
45812>>>>>        Set Location to 177 337
45813>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45814>>>>>
45814>>>>>        //AB-StoreStart
45814>>>>>        Procedure OnClick
45816>>>>>            Send OK To oSelList
45817>>>>>        End_Procedure
45818>>>>>        //AB-StoreEnd
45818>>>>>
45818>>>>>    End_Object    // oOK_bn
45819>>>>>
45819>>>>>    Object oCancel_bn is a ButtonSub
45821>>>>>        Set Label to "&€¡ç¨à©ž"
45822>>>>>        Set Location to 177 393
45823>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45824>>>>>
45824>>>>>        //AB-StoreStart
45824>>>>>        Procedure OnClick
45826>>>>>            Send Cancel To oSelList
45827>>>>>        End_Procedure
45828>>>>>        //AB-StoreEnd
45828>>>>>
45828>>>>>    End_Object    // oCancel_bn
45829>>>>>
45829>>>>>    Object oSearch_bn is a ButtonSub
45831>>>>>        Set Label to "€&¤˜ã«ž©ž"
45832>>>>>        Set Location to 177 447
45833>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45834>>>>>
45834>>>>>        //AB-StoreStart
45834>>>>>        Procedure OnClick
45836>>>>>            Send Search To oSelList
45837>>>>>        End_Procedure
45838>>>>>        //AB-StoreEnd
45838>>>>>
45838>>>>>    End_Object    // oSearch_bn
45839>>>>>
45839>>>>>
45839>>>>>    //AB-StoreStart
45839>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
45840>>>>>    On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
45841>>>>>    On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
45842>>>>>    
45842>>>>>    //AB-StoreEnd
45842>>>>>
45842>>>>>CD_End_Object    // SL031
45844>>>>>>
45844>>>>>
45844>>>>>//AB/ End_Object    // prj
45844>>>Use sl031r.sl
INCLUDING FILE: SL031R.SL
45844>>>>>//AB/ Project sl031r:Btypkin with recr 1st col
45844>>>>>//AB/     Object prj is a Lookup_Project
45844>>>>>//AB/         Set ProjectName to "sl031r:Btypkin with recr 1st col"
45844>>>>>//AB/         Set ProjectFileName to "sl031r.SL"
45844>>>>>//AB/         Set GenerateFileName to "NONAME"
45844>>>>>
45844>>>>>// Project Object Structure
45844>>>>>//   SL031r is a dbModalPanelSub
45844>>>>>//     Btypkin_DD is a DataDictionary
45844>>>>>//     oSelList is a dbListSub
45844>>>>>//     oOK_bn is a ButtonSub
45844>>>>>//     oCancel_bn is a ButtonSub
45844>>>>>//     oSearch_bn is a ButtonSub
45844>>>>>
45844>>>>>// Register all objects
45844>>>>>Register_Object Btypkin_DD
45844>>>>>Register_Object oCancel_bn
45844>>>>>Register_Object oOK_bn
45844>>>>>Register_Object oSearch_bn
45844>>>>>Register_Object oSelList
45844>>>>>Register_Object SL031r
45844>>>>>
45844>>>>>
45844>>>>>    //AB-IgnoreStart
45844>>>>>
45844>>>>>    Use DFAllEnt.pkg
45844>>>>>    Use dbList.Sub
45844>>>>>    Use Button.Sub
45844>>>>>
45844>>>>>
45844>>>>>    Use BTYPKIN.DD
45844>>>>>    
45844>>>>>    //AB-IgnoreEnd
45844>>>>>
45844>>>>>    CD_Popup_Object SL031r is a dbModalPanelSub
45863>>>>>        set label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤" 
45864>>>>>        Set Size to 213 362
45865>>>>>        Set Location to 4 5
45866>>>>>        Set Exit_Application_Local_State to FALSE
45867>>>>>        Set Modal_State to FALSE
45868>>>>>
45868>>>>>        //AB-DDOStart
45868>>>>>
45868>>>>>        Object Btypkin_DD is a Btypkin_DataDictionary
45870>>>>>        End_Object    // Btypkin_DD
45871>>>>>
45871>>>>>        Set Main_DD to (Btypkin_DD(self))
45872>>>>>        Set Server to (Btypkin_DD(self))
45873>>>>>
45873>>>>>        //AB-DDOEnd
45873>>>>>
45873>>>>>        Object oSelList is a dbListSub
45875>>>>>            Set Main_File to Btypkin.File_Number
45876>>>>>            Set Size to 173 347
45877>>>>>            Set Location to 2 6
45878>>>>>
45878>>>>>            Begin_Row
45881>>>>>                Entry_Item Btypkin.Btypkin_recr
45882>>>>>                Entry_Item Btypkin.Btypkin_code
45883>>>>>                Entry_Item Btypkin.Btypkin_descr
45884>>>>>                Entry_Item Btypkin.Gtypkin_code
45885>>>>>                Entry_Item Btypkin.Ctypkin_code
45886>>>>>                Entry_Item Btypkin.Vtypkin_code
45887>>>>>                Entry_Item Btypkin.Btypkin_anti_xp
45888>>>>>            End_Row
45893>>>>>
45893>>>>>            Set Form_Width    item 0 to 58
45894>>>>>            Set Header_Label  item 0 to "Btypkin recr"
45895>>>>>            
45895>>>>>            Set Form_Width    item 1 to 36
45896>>>>>            set header_label  item 1 to "‰å¤ž©ž" 
45897>>>>>            
45897>>>>>            Set Form_Width    item 2 to 86
45898>>>>>            set header_label  item 2 to "œ¨ š¨˜­ã" 
45899>>>>>            
45899>>>>>            Set Form_Width    item 3 to 36
45900>>>>>            set header_label  item 3 to "‰å¤ž©ž ‚Š" 
45901>>>>>            
45901>>>>>            Set Form_Width    item 4 to 36
45902>>>>>            set header_label  item 4 to "‰ ¤ã©œ ª œ¢˜«é¤        " 
45903>>>>>            
45903>>>>>            Set Form_Width    item 5 to 36
45904>>>>>            set header_label  item 5 to "‰å¤ž©ž ¨¦£žŸœ¬«é¤" 
45905>>>>>            
45905>>>>>            Set Form_Width    item 6 to 53
45906>>>>>            set header_label  item 6 to "• ‘¬¤˜¢¢˜©¦£â¤¦¬" 
45907>>>>>            
45907>>>>>
45907>>>>>            //AB-StoreStart
45907>>>>>            Set Column_Option Item 0 to NoEnter True
45908>>>>>            
45908>>>>>            //AB-StoreEnd
45908>>>>>
45908>>>>>        End_Object    // oSelList
45909>>>>>
45909>>>>>        Object oOK_bn is a ButtonSub
45911>>>>>            set label to "&„§ ¢¦šã" 
45912>>>>>            Set Location to 178 194
45913>>>>>
45913>>>>>            //AB-StoreStart
45913>>>>>            Procedure OnClick
45915>>>>>                Send OK To oSelList
45916>>>>>            End_Procedure
45917>>>>>            //AB-StoreEnd
45917>>>>>
45917>>>>>        End_Object    // oOK_bn
45918>>>>>
45918>>>>>        Object oCancel_bn is a ButtonSub
45920>>>>>            set label to "&€¡ç¨à©ž" 
45921>>>>>            Set Location to 178 249
45922>>>>>
45922>>>>>            //AB-StoreStart
45922>>>>>            Procedure OnClick
45924>>>>>                Send Cancel To oSelList
45925>>>>>            End_Procedure
45926>>>>>            //AB-StoreEnd
45926>>>>>
45926>>>>>        End_Object    // oCancel_bn
45927>>>>>
45927>>>>>        Object oSearch_bn is a ButtonSub
45929>>>>>            set label to "€&¤˜ã«ž©ž" 
45930>>>>>            Set Location to 178 304
45931>>>>>
45931>>>>>            //AB-StoreStart
45931>>>>>            Procedure OnClick
45933>>>>>                Send Search To oSelList
45934>>>>>            End_Procedure
45935>>>>>            //AB-StoreEnd
45935>>>>>
45935>>>>>        End_Object    // oSearch_bn
45936>>>>>
45936>>>>>
45936>>>>>        //AB-StoreStart
45936>>>>>        On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
45937>>>>>        On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
45938>>>>>        On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
45939>>>>>        
45939>>>>>        //AB-StoreEnd
45939>>>>>
45939>>>>>    CD_End_Object    // SL031r
45941>>>>>>
45941>>>>>
45941>>>>>//AB/     End_Object    // prj
45941>>>Use sl033.sl
INCLUDING FILE: SL033.SL
45941>>>>>//AB/ Project SL033:BKINKAT
45941>>>>>//AB/ Object prj is a Lookup_Project
45941>>>>>//AB/     Set ProjectName to "SL033:BKINKAT"
45941>>>>>//AB/     Set ProjectFileName to "sl033.SL"
45941>>>>>
45941>>>>>// Project Object Structure
45941>>>>>//   sl033 is a dbModalPanelSub
45941>>>>>//     Company_DD is a DataDictionary
45941>>>>>//     Branch_DD is a DataDictionary
45941>>>>>//     Year_DD is a DataDictionary
45941>>>>>//     Btypkin_DD is a DataDictionary
45941>>>>>//     Baxiokat_DD is a DataDictionary
45941>>>>>//     Bkinkat_DD is a DataDictionary
45941>>>>>//     oSelList is a dbListSub
45941>>>>>//     oOK_bn is a ButtonSub
45941>>>>>//     oCancel_bn is a ButtonSub
45941>>>>>//     oSearch_bn is a ButtonSub
45941>>>>>
45941>>>>>// Register all objects
45941>>>>>Register_Object Baxiokat_DD
45941>>>>>Register_Object Bkinkat_DD
45941>>>>>Register_Object Branch_DD
45941>>>>>Register_Object Btypkin_DD
45941>>>>>Register_Object Company_DD
45941>>>>>Register_Object oCancel_bn
45941>>>>>Register_Object oOK_bn
45941>>>>>Register_Object oSearch_bn
45941>>>>>Register_Object oSelList
45941>>>>>Register_Object sl033
45941>>>>>Register_Object Year_DD
45941>>>>>
45941>>>>>
45941>>>>>//AB-IgnoreStart
45941>>>>>
45941>>>>>Use DFAllEnt.pkg
45941>>>>>Use dbList.Sub
45941>>>>>Use Button.Sub
45941>>>>>
45941>>>>>
45941>>>>>Use COMPANY.DD
45941>>>>>Use BRANCH.DD
45941>>>>>Use YEAR.DD
45941>>>>>Use BTYPKIN.DD
45941>>>>>Use BAXIOKAT.DD
INCLUDING FILE: BAXIOKAT.DD
45941>>>>>>>//DDB-FileStart
45941>>>>>>>//DDB-HeaderStart
45941>>>>>>>
45941>>>>>>>// File Name : BAXIOKAT.DD
45941>>>>>>>// Class Name: Baxiokat_DataDictionary
45941>>>>>>>// Revision  : 45
45941>>>>>>>// Version   : 2
45941>>>>>>>
45941>>>>>>>Use  Windows           // Basic Definitions
45941>>>>>>>Use  DataDict          // DataDictionary Class Definition
45941>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
45941>>>>>>>
45941>>>>>>>Open Baxiokat
INCLUDING FILE: BAXIOKAT.FD
45943>>>>>>>Open Baxio
INCLUDING FILE: BAXIO.FD
45945>>>>>>>Open Bkinkat
45947>>>>>>>Open Tpclient
45949>>>>>>>Open Tperga
45951>>>>>>>Open Tparticl
45953>>>>>>>Open Sysrecb
45955>>>>>>>
45955>>>>>>>//DDB-HeaderEnd
45955>>>>>>>//DDB-ValidationStart
45955>>>>>>>
45955>>>>>>>//DDB/ ExternalValidationTable Baxiokat_Type_VT  BAXIO.PKG
45955>>>>>>>
45955>>>>>>>Register_Object Baxiokat_Type_VT
45955>>>>>>>Register_Object Baxiokat_Baxiokat_Yn5390_VT
45955>>>>>>>Register_Object Baxiokat_Baxiokat_Bank_VT
45955>>>>>>>Register_Object Baxiokat_Baxiokat_Formul_VT
45955>>>>>>>Use BAXIO.PKG        // Baxiokat_Type_VT
45955>>>>>>>
45955>>>>>>>Object Baxiokat_Baxiokat_Yn5390_VT  is a DescriptionValidationTable
45957>>>>>>>
45957>>>>>>>    Procedure Fill_List
45959>>>>>>>        Forward Send Fill_List
45961>>>>>>>        Send Add_Table_Value  "0"  "Ž® "
45962>>>>>>>        Send Add_Table_Value  "1"  "Œ˜ "
45963>>>>>>>    End_Procedure    // Fill_List
45964>>>>>>>    //DDB-ValidationCustomStart
45964>>>>>>>    //DDB-ValidationCustomEnd
45964>>>>>>>End_Object   // Baxiokat_Baxiokat_Yn5390_VT
45965>>>>>>>
45965>>>>>>>Object Baxiokat_Baxiokat_Bank_VT  is a CodeValidationTable
45967>>>>>>>    Set Type_Value        To "BANK"
45968>>>>>>>    Set Allow_Blank_State To TRUE
45969>>>>>>>    //DDB-ValidationCustomStart
45969>>>>>>>    //DDB-ValidationCustomEnd
45969>>>>>>>End_Object   // Baxiokat_Baxiokat_Bank_VT
45970>>>>>>>
45970>>>>>>>Object Baxiokat_Baxiokat_Formul_VT  is a DescriptionValidationTable
45972>>>>>>>    Set Allow_Blank_State To TRUE
45973>>>>>>>
45973>>>>>>>    Procedure Fill_List
45975>>>>>>>        Forward Send Fill_List
45977>>>>>>>        Send Add_Table_Value  "0"  ""
45978>>>>>>>        Send Add_Table_Value  "1"  "’ç§¦ª 1"
45979>>>>>>>        Send Add_Table_Value  "2"  "’ç§¦ª 2"
45980>>>>>>>    End_Procedure    // Fill_List
45981>>>>>>>    //DDB-ValidationCustomStart
45981>>>>>>>    //DDB-ValidationCustomEnd
45981>>>>>>>End_Object   // Baxiokat_Baxiokat_Formul_VT
45982>>>>>>>//DDB-ValidationEnd
45982>>>>>>>//DDB-SelectionStart
45982>>>>>>>//DDB/ ExternalSelectionList SL034  SL034.SL
45982>>>>>>>Register_Object SL034
45982>>>>>>>//DDB-SelectionEnd
45982>>>>>>>
45982>>>>>>>Open Syscurxr
45984>>>>>>>Open Btypkin
45986>>>>>>>Open Bkinkat
45988>>>>>>>
45988>>>>>>>
45988>>>>>>>// Apo Baxio_DD
45988>>>>>>>Register_Function private.Default_Axio_C_Code2 Returns String
45988>>>>>>>//
45988>>>>>>>
45988>>>>>>>Class Baxiokat_DataDictionary  is a DataDictionary_Sec
45989>>>>>>>
45989>>>>>>>     Procedure Creating
45990>>>>>>>        Forward Send Creating
45992>>>>>>>        // Insert Code Here
45992>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Baxiokat.Baxiokat_Rec0)))))) to Baxiokat.Baxiokat_Recr
45993>>>>>>>    End_Procedure   // Creating
45994>>>>>>>
45994>>>>>>>     Procedure Construct_Object
45995>>>>>>>               Forward Send Construct_Object
45997>>>>>>>
45997>>>>>>>               //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
45997>>>>>>>               //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
45997>>>>>>>               //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
45997>>>>>>>               //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
45997>>>>>>>               Property Integer piBarticl_dd  0
45998>>>>>>>               Property Integer piBmove_dd    0
45999>>>>>>>               Property Integer piBaxio_dd    0
46000>>>>>>>               Property Integer piBtypkin_dd 0
46001>>>>>>>     End_Procedure   //construct_object
46002>>>>>>>
46002>>>>>>>
46002>>>>>>>     //private
46002>>>>>>>     //¡˜¢œå«˜  ˜§æ: iexit «¦¬ baxiokat_code
46002>>>>>>>     //©œ«á¨œ      : «ž¤ default « £ã «¦¬ baxio_c_code2, ˜¤á¢¦š˜ £œ «¦ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
46002>>>>>>>     Procedure private.Exit_Baxiokat_Code Integer liField Integer liBaxiokat_Code
46003>>>>>>>               String lsBaxio_C_Code_2
46004>>>>>>>        PROCEDURE_RETURN
46005>>>>>>>//jsjsjs 24/01/2001
46005>>>>>>>//               Get File_Field_Current_Value File_Field Year.Year_C_Code0 to lsBaxio_C_Code_2
46005>>>>>>>
46005>>>>>>>//               Set Field_Changed_Value of (piBaxio_dd(Self)) Field Baxio.Baxio_C_Code2 to  lsBaxio_C_Code_2 //(private.Default_Axio_C_Code2((piBAxio_dd(Self))))
46005>>>>>>>//jsjsjs 24/01/2001
46005>>>>>>>     End_Procedure //private.exit_baxiokat_code
46006>>>>>>>
46006>>>>>>>
46006>>>>>>>    //private
46006>>>>>>>    //¡˜¢œå«˜  ˜§æ:
46006>>>>>>>    //©œ«á¨œ : «ž¤ default value to baxiokat_code, ˜¤á¢¦š˜ £œ «¦ btypkin.baxiokat_num
46006>>>>>>>    Procedure private.Entry_Baxiokat_Code Integer liField Integer liBaxiokat_Code
46007>>>>>>>              Integer liBtypkin_dd liBkinkat_Num liBtypkin_Rec0
46008>>>>>>>
46008>>>>>>>        PROCEDURE_RETURN
46009>>>>>>>
46009>>>>>>>
46009>>>>>>>    End_Procedure //private.entry_gtypkin_code
46010>>>>>>>
46010>>>>>>>
46010>>>>>>>
46010>>>>>>>
46010>>>>>>>    Procedure Update
46011>>>>>>>          Forward Send Update
46013>>>>>>>          If (Baxiokat.Baxiokat_Yn5390 = 0);          Begin //œá¤ ›â¤ œå¤˜  £ž®˜¤¦š¨˜­ž£â¤œª œ§ «˜šâª, £ž›â¤ ©œ æ¢˜ «˜ ©®œ« ¡á §œ›å˜
46015>>>>>>>               Move "" to Baxiokat.Baxiokat_Bank
46016>>>>>>>               Move "" to Baxiokat.Baxiokat_Lno
46017>>>>>>>               Move 0  to Baxiokat.Baxiokat_Formul
46018>>>>>>>          End
46018>>>>>>>>
46018>>>>>>>    End_Procedure
46019>>>>>>>
46019>>>>>>>
46019>>>>>>>    Procedure Define_Fields
46020>>>>>>>        Forward Send Define_Fields
46022>>>>>>>        //DDB-Generated-Code-Location
46022>>>>>>>        //DDB-DefineFieldStart
46022>>>>>>>
46022>>>>>>>        Set Main_File            To Baxiokat.File_Number
46023>>>>>>>        Set Cascade_Delete_State To FALSE
46024>>>>>>>
46024>>>>>>>
46024>>>>>>>        // Child (Client) file structure................
46024>>>>>>>        Send Add_Client_File  Baxio.File_Number
46025>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
46026>>>>>>>        Send Add_Client_File  Tpclient.File_Number
46027>>>>>>>        Send Add_Client_File  Tperga.File_Number
46028>>>>>>>        Send Add_Client_File  Tparticl.File_Number
46029>>>>>>>
46029>>>>>>>        // External (System) file structure.............
46029>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
46030>>>>>>>
46030>>>>>>>        Define_Auto_Increment  Sysrecb.Baxiokat_Rec0  To Baxiokat.Baxiokat_Rec0
46033>>>>>>>
46033>>>>>>>        // Field-based properties.......................
46033>>>>>>>
46033>>>>>>>        // Baxiokat.Baxiokat_Code
46033>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Code To (SL034(Self))
46034>>>>>>>
46034>>>>>>>        // Baxiokat.Baxiokat_Descr
46034>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Descr To (SL034(Self))
46035>>>>>>>
46035>>>>>>>        // Baxiokat.Baxiokat_Rec0
46035>>>>>>>
46035>>>>>>>        // Baxiokat.Baxiokat_Recr
46035>>>>>>>
46035>>>>>>>        // Baxiokat.Baxiokat_Type
46035>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Type To (Baxiokat_Type_VT(Self))
46036>>>>>>>
46036>>>>>>>        // Baxiokat.Baxio_Lcode
46036>>>>>>>        //DDB/ Comment_Short       Field Baxiokat.Baxio_Lcode To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ creating/deleting «¦¬ baxio)"
46036>>>>>>>
46036>>>>>>>        // Baxiokat.Baxiokat_Yn5390
46036>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Yn5390 To (Baxiokat_Baxiokat_Yn5390_VT(Self))
46037>>>>>>>
46037>>>>>>>        // Baxiokat.Baxiokat_Bank
46037>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Bank To (Baxiokat_Baxiokat_Bank_VT(Self))
46038>>>>>>>
46038>>>>>>>        // Baxiokat.Baxiokat_Lno
46038>>>>>>>
46038>>>>>>>        // Baxiokat.Baxiokat_Formul
46038>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Formul To (Baxiokat_Baxiokat_Formul_VT(Self))
46039>>>>>>>
46039>>>>>>>        //DDB-DefineFieldEnd
46039>>>>>>>
46039>>>>>>>        Set Main_File            To Baxiokat.File_Number
46040>>>>>>>        Set Cascade_Delete_State To FALSE
46041>>>>>>>
46041>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
46042>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
46043>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
46044>>>>>>>
46044>>>>>>>        // Child (Client) file structure................
46044>>>>>>>        Send Add_Client_File  Baxio.File_Number
46045>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
46046>>>>>>>
46046>>>>>>>        // External (System) file structure.............
46046>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
46047>>>>>>>
46047>>>>>>>        Define_Auto_Increment  Sysrecb.Baxiokat_Rec0  To Baxiokat.Baxiokat_Rec0
46050>>>>>>>
46050>>>>>>>        // Field-based properties.......................
46050>>>>>>>
46050>>>>>>>        // Baxiokat.Baxiokat_Code
46050>>>>>>>        Set Field_Entry_msg        Field Baxiokat.Baxiokat_Code   To private.Entry_Baxiokat_Code
46051>>>>>>>        Set Field_Exit_msg         Field Baxiokat.Baxiokat_Code   To private.Exit_Baxiokat_Code
46052>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Code   To "‰à› ¡æª „å›¦¬ª €¥ ¦š¨á­¦¬"
46053>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Code   To "„å›¦ª"
46054>>>>>>>        Set Field_Options          Field Baxiokat.Baxiokat_Code   To DD_AUTOFIND    DD_REQUIRED
46055>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Code   To (SL034(Self))
46056>>>>>>>        Set Key_Field_State        Field Baxiokat.Baxiokat_Code   To TRUE
46057>>>>>>>
46057>>>>>>>        // Baxiokat.Baxiokat_Descr
46057>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Descr  To "œ¨ š¨˜­ã „å›¦¬ª €¥ ¦š¨á­¦¬"
46058>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Descr  To "œ¨ š¨˜­ã"
46059>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Descr  To (SL034(Self))
46060>>>>>>>
46060>>>>>>>        // Baxiokat.Baxiokat_Rec0
46060>>>>>>>        Set Field_Options          Field Baxiokat.Baxiokat_Rec0   To DD_AUTOFIND    DD_REQUIRED
46061>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Rec0   To (SL034(Self))
46062>>>>>>>        Set Key_Field_State        Field Baxiokat.Baxiokat_Rec0   To TRUE
46063>>>>>>>
46063>>>>>>>        // Baxiokat.Baxiokat_Type
46063>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Type   To "dbComboForm_EZ"
46064>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Type   To "„ ©§¨˜¡«â¦/¢ž¨à«â¦"
46065>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Type   To "„ ©./¢ã¨."
46066>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Type   To (Baxiokat_Type_VT(Self))
46067>>>>>>>
46067>>>>>>>        // Baxiokat.Baxio_Lcode
46067>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxio_Lcode     To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª €¥ ¦šá­¦¬"
46068>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxio_Lcode     To "’œ¢.€¨ Ÿ£æª"
46069>>>>>>>        //Set Field_Options          Field Baxiokat.Baxio_Lcode     To DD_DISPLAYONLY
46069>>>>>>>
46069>>>>>>>        // Baxiokat.Baxiokat_Yn5390
46069>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Yn5390 To "dbComboForm_EZ"
46070>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Yn5390 To "‹ž®˜¤¦š¨˜­ž£â¤œª „§ «˜šâª ?"
46071>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Yn5390 To "‹ž®/¡âª „§ «˜šâª"
46072>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Yn5390 To (Baxiokat_Baxiokat_Yn5390_VT(Self))
46073>>>>>>>
46073>>>>>>>        // Baxiokat.Baxiokat_Bank
46073>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Bank   To "dbComboForm_EZ"
46074>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Bank   To "’¨á§œ˜"
46075>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Bank   To "’¨á§œ˜"
46076>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Bank   To (Baxiokat_Baxiokat_Bank_VT(Self))
46077>>>>>>>
46077>>>>>>>        // Baxiokat.Baxiokat_Lno
46077>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Lno    To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª"
46078>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Lno    To "’œ¢.€¨ Ÿ£æª"
46079>>>>>>>
46079>>>>>>>        // Baxiokat.Baxiokat_Formul
46079>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Formul To "dbComboForm_EZ"
46080>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Formul To "€¢šæ¨ Ÿ£¦ª Check Digit"
46081>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Formul To "Check Digit"
46082>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Formul To (Baxiokat_Baxiokat_Formul_VT(Self))
46083>>>>>>>
46083>>>>>>>    End_Procedure    // Define_Fields
46084>>>>>>>
46084>>>>>>>
46084>>>>>>>    Procedure Field_Defaults
46085>>>>>>>        Forward Send Field_Defaults
46087>>>>>>>        //DDB-Generated-Code-Location
46087>>>>>>>        //DDB-FieldDefaultStart
46087>>>>>>>        //DDB-FieldDefaultEnd
46087>>>>>>>        Set Field_Changed_Value   Field Baxiokat.Baxiokat_Yn5390 To 0
46088>>>>>>>    End_Procedure    // Field_Defaults
46089>>>>>>>
46089>>>>>>>End_Class    // Baxiokat_DataDictionary
46090>>>>>>>//DDB-Selection-pkg-Start
46090>>>>>>>
46090>>>>>>>Use SL034.SL         // SL034
INCLUDING FILE: SL034.SL
46090>>>>>>>>>//AB/ Project SL034:BAXIOKAT
46090>>>>>>>>>//AB/ Object prj is a Lookup_Project
46090>>>>>>>>>//AB/     Set ProjectName to "SL034:BAXIOKAT"
46090>>>>>>>>>//AB/     Set ProjectFileName to "SL034.SL"
46090>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
46090>>>>>>>>>
46090>>>>>>>>>// Project Object Structure
46090>>>>>>>>>//   SL034 is a dbModalPanelSub
46090>>>>>>>>>//     Baxiokat_DD is a DataDictionary
46090>>>>>>>>>//     oSelList is a dbListSub
46090>>>>>>>>>//     oOK_bn is a ButtonSub
46090>>>>>>>>>//     oCancel_bn is a ButtonSub
46090>>>>>>>>>//     oSearch_bn is a ButtonSub
46090>>>>>>>>>
46090>>>>>>>>>// Register all objects
46090>>>>>>>>>Register_Object Baxiokat_DD
46090>>>>>>>>>Register_Object oCancel_bn
46090>>>>>>>>>Register_Object oOK_bn
46090>>>>>>>>>Register_Object oSearch_bn
46090>>>>>>>>>Register_Object oSelList
46090>>>>>>>>>Register_Object SL034
46090>>>>>>>>>
46090>>>>>>>>>
46090>>>>>>>>>//AB-IgnoreStart
46090>>>>>>>>>
46090>>>>>>>>>Use DFAllEnt.pkg
46090>>>>>>>>>Use dbList.Sub
46090>>>>>>>>>Use Button.Sub
46090>>>>>>>>>
46090>>>>>>>>>
46090>>>>>>>>>Use BAXIOKAT.DD
46090>>>>>>>>>
46090>>>>>>>>>//AB-IgnoreEnd
46090>>>>>>>>>
46090>>>>>>>>>CD_Popup_Object SL034 is a dbModalPanelSub
46109>>>>>>>>>    set label to "‰˜«žš¦¨åœª €¥ ¦š¨á­à¤" 
46110>>>>>>>>>    Set Size to 206 347
46111>>>>>>>>>    Set Location to 4 5
46112>>>>>>>>>    Set Exit_Application_Local_State to FALSE
46113>>>>>>>>>    Set Modal_State to FALSE
46114>>>>>>>>>
46114>>>>>>>>>    //AB-DDOStart
46114>>>>>>>>>
46114>>>>>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
46116>>>>>>>>>    End_Object    // Baxiokat_DD
46117>>>>>>>>>
46117>>>>>>>>>    Set Main_DD to (Baxiokat_DD(self))
46118>>>>>>>>>    Set Server to (Baxiokat_DD(self))
46119>>>>>>>>>
46119>>>>>>>>>    //AB-DDOEnd
46119>>>>>>>>>
46119>>>>>>>>>    Object oSelList is a dbListSub
46121>>>>>>>>>        Set Main_File to Baxiokat.File_Number
46122>>>>>>>>>        Set Size to 164 335
46123>>>>>>>>>        Set Location to 5 4
46124>>>>>>>>>
46124>>>>>>>>>        Begin_Row
46127>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_code
46128>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_descr
46129>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_type
46130>>>>>>>>>            Entry_Item (Export_Code_Description(Self,2,Baxiokat.Baxiokat_type))
46131>>>>>>>>>        End_Row
46136>>>>>>>>>
46136>>>>>>>>>        Set Form_Width    item 0 to 55
46137>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
46138>>>>>>>>>
46138>>>>>>>>>        Set Form_Width    item 1 to 172
46139>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
46140>>>>>>>>>
46140>>>>>>>>>        Set Form_Width    item 2 to 16
46141>>>>>>>>>        set header_label  item 2 to "’ç§¦ª" 
46142>>>>>>>>>
46142>>>>>>>>>        Set Form_Width    item 3 to 83
46143>>>>>>>>>        set header_label  item 3 to "„ ©./¢ž¨." 
46144>>>>>>>>>
46144>>>>>>>>>    End_Object    // oSelList
46145>>>>>>>>>
46145>>>>>>>>>    Object oOK_bn is a ButtonSub
46147>>>>>>>>>        set label to "&„§ ¢¦šã" 
46148>>>>>>>>>        Set Location to 172 180
46149>>>>>>>>>
46149>>>>>>>>>        //AB-StoreStart
46149>>>>>>>>>        Procedure OnClick
46151>>>>>>>>>            Send OK To oSelList
46152>>>>>>>>>        End_Procedure
46153>>>>>>>>>        //AB-StoreEnd
46153>>>>>>>>>
46153>>>>>>>>>    End_Object    // oOK_bn
46154>>>>>>>>>
46154>>>>>>>>>    Object oCancel_bn is a ButtonSub
46156>>>>>>>>>        set label to "&€¡ç¨à©ž" 
46157>>>>>>>>>        Set Location to 172 234
46158>>>>>>>>>
46158>>>>>>>>>        //AB-StoreStart
46158>>>>>>>>>        Procedure OnClick
46160>>>>>>>>>            Send Cancel To oSelList
46161>>>>>>>>>        End_Procedure
46162>>>>>>>>>        //AB-StoreEnd
46162>>>>>>>>>
46162>>>>>>>>>    End_Object    // oCancel_bn
46163>>>>>>>>>
46163>>>>>>>>>    Object oSearch_bn is a ButtonSub
46165>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
46166>>>>>>>>>        Set Location to 172 289
46167>>>>>>>>>
46167>>>>>>>>>        //AB-StoreStart
46167>>>>>>>>>        Procedure OnClick
46169>>>>>>>>>            Send Search To oSelList
46170>>>>>>>>>        End_Procedure
46171>>>>>>>>>        //AB-StoreEnd
46171>>>>>>>>>
46171>>>>>>>>>    End_Object    // oSearch_bn
46172>>>>>>>>>
46172>>>>>>>>>
46172>>>>>>>>>    //AB-StoreStart
46172>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
46173>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
46174>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
46175>>>>>>>>>    //AB-StoreEnd
46175>>>>>>>>>
46175>>>>>>>>>CD_End_Object    // SL034
46177>>>>>>>>>>
46177>>>>>>>>>
46177>>>>>>>>>//AB/ End_Object    // prj
46177>>>>>>>
46177>>>>>>>//DDB-Selection-pkg-End
46177>>>>>>>//DDB-FileEnd
46177>>>>>Use BKINKAT.DD
INCLUDING FILE: BKINKAT.DD
46177>>>>>>>//DDB-FileStart
46177>>>>>>>//DDB-HeaderStart
46177>>>>>>>
46177>>>>>>>// File Name : BKINKAT.DD
46177>>>>>>>// Class Name: Bkinkat_DataDictionary
46177>>>>>>>// Revision  : 39
46177>>>>>>>// Version   : 2
46177>>>>>>>
46177>>>>>>>Use  Windows           // Basic Definitions
46177>>>>>>>Use  DataDict          // DataDictionary Class Definition
46177>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46177>>>>>>>
46177>>>>>>>Open Bkinkat
46179>>>>>>>Open Bkinkath
INCLUDING FILE: BKINKATH.FD
46181>>>>>>>Open Baxiokat
46183>>>>>>>Open Btypkin
46185>>>>>>>Open Sysrecb
46187>>>>>>>Open Bmove
INCLUDING FILE: BMOVE.FD
46189>>>>>>>
46189>>>>>>>//DDB-HeaderEnd
46189>>>>>>>//DDB-ValidationStart
46189>>>>>>>
46189>>>>>>>//DDB/ ExternalValidationTable Baxio_Status_VT  Baxio.Pkg
46189>>>>>>>
46189>>>>>>>Register_Object Bkinkat_Bkinkat_Yn_New_VT
46189>>>>>>>Register_Object Baxio_Status_VT
46189>>>>>>>Register_Object Bkinkat_Baxio_Place_VT
46189>>>>>>>Use Baxio.Pkg        // Baxio_Status_VT
46189>>>>>>>
46189>>>>>>>Object Bkinkat_Bkinkat_Yn_New_VT  is a DescriptionValidationTable
46191>>>>>>>
46191>>>>>>>    Procedure Fill_List
46193>>>>>>>        Forward Send Fill_List
46195>>>>>>>        Send Add_Table_Value  "0"  "Ž® "
46196>>>>>>>        Send Add_Table_Value  "1"  "Œ˜ "
46197>>>>>>>    End_Procedure    // Fill_List
46198>>>>>>>    //DDB-ValidationCustomStart
46198>>>>>>>    //DDB-ValidationCustomEnd
46198>>>>>>>End_Object   // Bkinkat_Bkinkat_Yn_New_VT
46199>>>>>>>
46199>>>>>>>Object Bkinkat_Baxio_Place_VT  is a CodeValidationTable
46201>>>>>>>    Set Type_Value        To "BAXIOPLACE"
46202>>>>>>>    Set Allow_Blank_State To TRUE
46203>>>>>>>    //DDB-ValidationCustomStart
46203>>>>>>>    //DDB-ValidationCustomEnd
46203>>>>>>>End_Object   // Bkinkat_Baxio_Place_VT
46204>>>>>>>//DDB-ValidationEnd
46204>>>>>>>Open SysCurXr
46206>>>>>>>
46206>>>>>>>Class Bkinkat_DataDictionary  is a DataDictionary_Sec
46207>>>>>>>
46207>>>>>>>    // Creating:
46207>>>>>>>
46207>>>>>>>    Procedure Creating
46208>>>>>>>        Forward Send Creating
46210>>>>>>>        // Insert Code Here
46210>>>>>>>        Move (Append('',((Trim(SysCurXr.Branch_Site))+;                         (Trim(String(Bkinkat.Bkinkat_Rec0)))))) to Bkinkat.Bkinkat_Recr
46211>>>>>>>    End_Procedure   // Creating
46212>>>>>>>
46212>>>>>>>      //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
46212>>>>>>>      //™) ˜¤áš¤à©ž properties
46212>>>>>>>      //š) › ˜®œå¨ ©ž calculated §œ›åà¤
46212>>>>>>>      //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
46212>>>>>>>      //œ) œ¤ž£â¨à©ž properties after
46212>>>>>>>      Procedure Update
46213>>>>>>>                Forward Send Update
46215>>>>>>>
46215>>>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
46215>>>>>>>                Move Syscurxr.Company_Code  to Bkinkat.Company_Code
46216>>>>>>>                Move Syscurxr.Branch_Code   to Bkinkat.Branch_Code
46217>>>>>>>                Move Syscurxr.Year_Year     to Bkinkat.Year_Year
46218>>>>>>>                Move Btypkin.Btypkin_Code   to Bkinkat.Btypkin_Code
46219>>>>>>>                Move Baxiokat.Baxiokat_Code to Bkinkat.Baxiokat_Code
46220>>>>>>>
46220>>>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
46220>>>>>>>                //š.1:baxio_stat_from + baxio_plac_from:
46220>>>>>>>                //    æ«˜¤ ›ž£ ¦¬¨š¦ç£œ ¤â¦ ˜¥ æš¨˜­¦,
46220>>>>>>>                //    §¨¦­˜¤éª "â¨®œ«˜ " ˜§¦ «¦ §¦¬Ÿœ¤á !
46220>>>>>>>                //    ¡˜  â®œ  ¡˜«á©«˜©ž 1
46220>>>>>>>                If (Bkinkat.Bkinkat_Yn_New = 1);                Begin
46222>>>>>>>                     Move 1 to Bkinkat.Baxio_Stat_From //¡˜«á©«˜ž ˜§æ = œ¡¡¨œ£âª
46223>>>>>>>                     Move 0 to Bkinkat.Baxio_Plac_From //¤â¦ ˜¥ æš¨˜­¦
46224>>>>>>>                End
46224>>>>>>>>
46224>>>>>>>                Else;                Begin //©«ã¤ ˜¤«åŸœ«ž §œ¨å§«à©ž, §¨â§œ  «˜ 2 §œ›å˜ ¤˜ œå¤˜  > 0
46225>>>>>>>                     //If (Not(Bkinkat.Baxio_Stat_From > 0)) Send Operation_Not_Allowed 3001 //¡˜«á©«˜ž ˜§æ = œ¡¡¨œ£âª
46225>>>>>>>                     If (Not(Bkinkat.Baxio_Plac_From > 0)) Send Operation_Not_Allowed 3001 //«¦ ¬§á¨®¦¤ ˜¥ æš¨˜­¦ §¨â§œ  ¡á§¦¬ ¤˜ ™¨å©¡œ«˜ 
46228>>>>>>>                End
46228>>>>>>>>
46228>>>>>>>
46228>>>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ btypkin
46228>>>>>>>                Add 1 to   Btypkin.Bkinkat_Num
46229>>>>>>>
46229>>>>>>>                //Move BkinKat.BkinKat_Rec0   to BkinKat.BkinKat_code
46229>>>>>>>      End_Procedure   //update
46230>>>>>>>
46230>>>>>>>
46230>>>>>>>      Procedure Backout
46231>>>>>>>                Forward Send Backout
46233>>>>>>>
46233>>>>>>>                //œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ Btypkin
46233>>>>>>>                Sub 1 from Btypkin.Bkinkat_Num
46234>>>>>>>      End_Procedure   //backout
46235>>>>>>>
46235>>>>>>>
46235>>>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
46236>>>>>>>                String lsError_Message
46237>>>>>>>                Case Begin
46237>>>>>>>                     //˜§æ validate save
46237>>>>>>>                     Case (iError_Num = 1001)
46239>>>>>>>                     Case Break
46240>>>>>>>                     //˜§æ update
46240>>>>>>>                     Case (iError_Num = 3001)
46243>>>>>>>                          Move ("DDC 146:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ¬§á¨®¦¤ ˜¥ æš¨˜­¦ §¨â§œ  ¡á§¦¬ ¤˜ ™¨å©¡œ«˜  !");                          to lsError_Message
46244>>>>>>>                     Case Break
46245>>>>>>>
46245>>>>>>>                     Case Else
46245>>>>>>>                          Forward Send Operation_Not_Allowed iError_Num
46247>>>>>>>                Case End
46247>>>>>>>
46247>>>>>>>                Error iError_Num lsError_Message
46248>>>>>>>>
46248>>>>>>>      End_Procedure // operation_not_allowed
46249>>>>>>>
46249>>>>>>>
46249>>>>>>>//----------------------------------------------------------------------------
46249>>>>>>>    Procedure Define_Fields
46250>>>>>>>        Forward Send Define_Fields
46252>>>>>>>        //DDB-Generated-Code-Location
46252>>>>>>>        //DDB-DefineFieldStart
46252>>>>>>>
46252>>>>>>>        Set Main_File            To Bkinkat.File_Number
46253>>>>>>>        Set Cascade_Delete_State To FALSE
46254>>>>>>>
46254>>>>>>>
46254>>>>>>>        // Child (Client) file structure................
46254>>>>>>>        Send Add_Client_File  Bkinkath.File_Number
46255>>>>>>>
46255>>>>>>>        // Parent (Server) file structure...............
46255>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
46256>>>>>>>        Send Add_Server_File  Btypkin.File_Number
46257>>>>>>>
46257>>>>>>>        // External (System) file structure.............
46257>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
46258>>>>>>>        Send Add_System_File  Bmove.File_Number  DD_LOCK_ON_ALL
46259>>>>>>>
46259>>>>>>>        Define_Auto_Increment  Sysrecb.Bkinkat_Rec0  To Bkinkat.Bkinkat_Rec0
46262>>>>>>>
46262>>>>>>>        // Field-based properties.......................
46262>>>>>>>
46262>>>>>>>        // Bkinkat.Company_Code
46262>>>>>>>
46262>>>>>>>        // Bkinkat.Branch_Code
46262>>>>>>>
46262>>>>>>>        // Bkinkat.Year_Year
46262>>>>>>>
46262>>>>>>>        // Bkinkat.Btypkin_Code
46262>>>>>>>
46262>>>>>>>        // Bkinkat.Baxiokat_Code
46262>>>>>>>
46262>>>>>>>        // Bkinkat.Bkinkat_Code
46262>>>>>>>
46262>>>>>>>        // Bkinkat.Bkinkat_Rec0
46262>>>>>>>
46262>>>>>>>        // Bkinkat.Bkinkat_Recr
46262>>>>>>>
46262>>>>>>>        // Bkinkat.Btypkin_Recr
46262>>>>>>>
46262>>>>>>>        // Bkinkat.Baxiokat_Recr
46262>>>>>>>
46262>>>>>>>        // Bkinkat.Bkinkat_Yn_New
46262>>>>>>>        Set Field_Value_Table      Field Bkinkat.Bkinkat_Yn_New To (Bkinkat_Bkinkat_Yn_New_VT(Self))
46263>>>>>>>
46263>>>>>>>        // Bkinkat.Baxio_Stat_From
46263>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Stat_From To (Baxio_Status_VT(Self))
46264>>>>>>>
46264>>>>>>>        // Bkinkat.Baxio_Stat_To
46264>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Stat_To To (Baxio_Status_VT(Self))
46265>>>>>>>
46265>>>>>>>        // Bkinkat.Baxio_Plac_From
46265>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Plac_From To (Bkinkat_Baxio_Place_VT(Self))
46266>>>>>>>
46266>>>>>>>        // Bkinkat.Baxio_Plac_To
46266>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Plac_To To (Bkinkat_Baxio_Place_VT(Self))
46267>>>>>>>
46267>>>>>>>        // Bkinkat.Bkinkat_Gplncod
46267>>>>>>>
46267>>>>>>>        //DDB-DefineFieldEnd
46267>>>>>>>
46267>>>>>>>        Set Main_File            To Bkinkat.File_Number
46268>>>>>>>        Set Cascade_Delete_State To FALSE
46269>>>>>>>
46269>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
46270>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
46271>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
46272>>>>>>>
46272>>>>>>>        // Parent (Server) file structure...............
46272>>>>>>>        Send Add_Server_File  Btypkin.File_Number
46273>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
46274>>>>>>>
46274>>>>>>>        // External (System) file structure.............
46274>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
46275>>>>>>>
46275>>>>>>>        Define_Auto_Increment  Sysrecb.Bkinkat_Rec0  To Bkinkat.Bkinkat_Rec0
46278>>>>>>>
46278>>>>>>>        // Field-based properties.......................
46278>>>>>>>
46278>>>>>>>        // Bkinkat.Btypkin_Code
46278>>>>>>>        Set Key_Field_State        Field Bkinkat.Btypkin_Code     To TRUE
46279>>>>>>>
46279>>>>>>>        // Bkinkat.Baxiokat_Code
46279>>>>>>>        Set Field_Options          Field Bkinkat.Baxiokat_Code    To DD_AUTOFIND
46280>>>>>>>        Set Key_Field_State        Field Bkinkat.Baxiokat_Code    To TRUE
46281>>>>>>>
46281>>>>>>>        // Bkinkat.Bkinkat_Rec0
46281>>>>>>>        Set Field_Options          Field Bkinkat.Bkinkat_Rec0     To DD_NOPUT
46282>>>>>>>
46282>>>>>>>        // Bkinkat.Btypkin_Rec0
46282>>>>>>>        //Set Field_Options          Field Bkinkat.Btypkin_Rec0     To DD_NOPUT
46282>>>>>>>
46282>>>>>>>        // Bkinkat.Baxiokat_Rec0
46282>>>>>>>        //Set Field_Options          Field Bkinkat.Baxiokat_Rec0    To DD_NOPUT
46282>>>>>>>
46282>>>>>>>        // Bkinkat.Bkinkat_Yn_New
46282>>>>>>>        Set Field_Class_Name       Field Bkinkat.Bkinkat_Yn_New   To "dbComboForm_EZ"
46283>>>>>>>        Set Field_Label_Long       Field Bkinkat.Bkinkat_Yn_New   To "Œâ¦ €¥ æš¨˜­¦ ?"
46284>>>>>>>        Set Field_Label_Short      Field Bkinkat.Bkinkat_Yn_New   To "Œâ¦ ?"
46285>>>>>>>        Set Field_Value_Table      Field Bkinkat.Bkinkat_Yn_New   To (Bkinkat_Bkinkat_Yn_New_VT(Self))
46286>>>>>>>
46286>>>>>>>        // Bkinkat.Baxio_Stat_From
46286>>>>>>>        Set Field_Class_Name       Field Bkinkat.Baxio_Stat_From  To "dbComboForm_EZ"
46287>>>>>>>        Set Field_Label_Long       Field Bkinkat.Baxio_Stat_From  To "‰˜«á©«˜©ž €§æ"
46288>>>>>>>        Set Field_Label_Short      Field Bkinkat.Baxio_Stat_From  To "‰˜«á©«˜©ž €§æ"
46289>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Stat_From  To (Baxio_Status_VT(Self))
46290>>>>>>>
46290>>>>>>>        // Bkinkat.Baxio_Stat_To
46290>>>>>>>        Set Field_Class_Name       Field Bkinkat.Baxio_Stat_To    To "dbComboForm_EZ"
46291>>>>>>>        Set Field_Label_Long       Field Bkinkat.Baxio_Stat_To    To "‰˜«á©«˜©ž ‘â"
46292>>>>>>>        Set Field_Label_Short      Field Bkinkat.Baxio_Stat_To    To "‰˜«á©«˜©ž ‘â"
46293>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Stat_To    To (Baxio_Status_VT(Self))
46294>>>>>>>
46294>>>>>>>        // Bkinkat.Baxio_Plac_From
46294>>>>>>>        Set Field_Class_Name       Field Bkinkat.Baxio_Plac_From  To "dbComboForm_EZ"
46295>>>>>>>        Set Field_Label_Long       Field Bkinkat.Baxio_Plac_From  To "„¬¨å¡œ«¦ ©â"
46296>>>>>>>        Set Field_Label_Short      Field Bkinkat.Baxio_Plac_From  To "„¬¨å¡œ«¦ ©â"
46297>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Plac_From  To (Bkinkat_Baxio_Place_VT(Self))
46298>>>>>>>
46298>>>>>>>        // Bkinkat.Baxio_Plac_To
46298>>>>>>>        Set Field_Class_Name       Field Bkinkat.Baxio_Plac_To    To "dbComboForm_EZ"
46299>>>>>>>        Set Field_Label_Long       Field Bkinkat.Baxio_Plac_To    To "áœ  ‘â"
46300>>>>>>>        Set Field_Label_Short      Field Bkinkat.Baxio_Plac_To    To "áœ  ‘â"
46301>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Plac_To    To (Bkinkat_Baxio_Place_VT(Self))
46302>>>>>>>
46302>>>>>>>        // Bkinkat.Bkinkat_Gplncod
46302>>>>>>>        Set Field_Label_Long       Field Bkinkat.Bkinkat_Gplncod  To "‰à› ¡æª ‚Š"
46303>>>>>>>        Set Field_Label_Short      Field Bkinkat.Bkinkat_Gplncod  To "‰à› ¡æª ‚Š"
46304>>>>>>>        //Set Field_Prompt_Object    Field Bkinkat.Bkinkat_Gplncod  To (SL056(Self))
46304>>>>>>>
46304>>>>>>>    End_Procedure    // Define_Fields
46305>>>>>>>
46305>>>>>>>
46305>>>>>>>    Procedure Field_Defaults
46306>>>>>>>        Forward Send Field_Defaults
46308>>>>>>>        //DDB-Generated-Code-Location
46308>>>>>>>        //DDB-FieldDefaultStart
46308>>>>>>>        //DDB-FieldDefaultEnd
46308>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Bkinkat_Yn_New   To 0
46309>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Baxio_Stat_From  To "1"
46310>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Baxio_Stat_To    To "1"
46311>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Baxio_Plac_From  To "1"
46312>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Baxio_Plac_To    To "1"
46313>>>>>>>    End_Procedure    // Field_Defaults
46314>>>>>>>
46314>>>>>>>End_Class    // Bkinkat_DataDictionary
46315>>>>>>>//DDB-FileEnd
46315>>>>>
46315>>>>>//AB-IgnoreEnd
46315>>>>>
46315>>>>>CD_Popup_Object sl033 is a dbModalPanelSub
46334>>>>>
46334>>>>>    //AB-StoreTopStart
46334>>>>>    Property Integer piFragmaBtypkinCode 0
46336>>>>>    
46336>>>>>    
46336>>>>>    
46336>>>>>    //AB-StoreTopEnd
46336>>>>>
46336>>>>>    Set Label to "‰˜«žš¦¨åœª ˜¥ ¦š¨á­à¤ š ˜ « ª ¡ ¤ã©œ ª"
46337>>>>>    Set Size to 206 362
46338>>>>>    Set Location to 4 5
46339>>>>>    Set Exit_Application_Local_State to FALSE
46340>>>>>    Set Modal_State to FALSE
46341>>>>>
46341>>>>>    //AB-DDOStart
46341>>>>>
46341>>>>>    Object Company_DD is a Company_DataDictionary
46343>>>>>    End_Object    // Company_DD
46344>>>>>
46344>>>>>    Object Branch_DD is a Branch_DataDictionary
46346>>>>>        Set DDO_Server to (Company_DD(self))
46347>>>>>    End_Object    // Branch_DD
46348>>>>>
46348>>>>>    Object Year_DD is a Year_DataDictionary
46350>>>>>        Set DDO_Server to (Branch_DD(self))
46351>>>>>    End_Object    // Year_DD
46352>>>>>
46352>>>>>    Object Btypkin_DD is a Btypkin_DataDictionary
46354>>>>>        Set DDO_Server to (Year_DD(self))
46355>>>>>    End_Object    // Btypkin_DD
46356>>>>>
46356>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
46358>>>>>    End_Object    // Baxiokat_DD
46359>>>>>
46359>>>>>    Object Bkinkat_DD is a Bkinkat_DataDictionary
46361>>>>>        Set DDO_Server to (Btypkin_DD(self))
46362>>>>>        Set DDO_Server to (Baxiokat_DD(self))
46363>>>>>
46363>>>>>        //AB-StoreStart
46363>>>>>                                
46363>>>>>        Procedure OnConstrain
46365>>>>>            Integer liBtypkinCode
46366>>>>>        
46366>>>>>            Get piFragmaBtypkinCode to liBtypkinCode
46367>>>>>            If (liBtypkinCode <> 0) Constrain Bkinkat.Btypkin_Code eq liBtypkinCode
46371>>>>>        End_Procedure // OnConstrain
46372>>>>>        
46372>>>>>        //AB-StoreEnd
46372>>>>>
46372>>>>>    End_Object    // Bkinkat_DD
46373>>>>>
46373>>>>>    Set Main_DD to (Bkinkat_DD(self))
46374>>>>>    Set Server to (Bkinkat_DD(self))
46375>>>>>
46375>>>>>    //AB-DDOEnd
46375>>>>>
46375>>>>>    Object oSelList is a dbListSub
46377>>>>>        Set Main_File to Bkinkat.File_Number
46378>>>>>        Set Size to 164 350
46379>>>>>        Set Location to 5 4
46380>>>>>
46380>>>>>        Begin_Row
46383>>>>>            Entry_Item Baxiokat.Baxiokat_code
46384>>>>>            Entry_Item Baxiokat.Baxiokat_descr
46385>>>>>            Entry_Item Baxiokat.Baxiokat_type
46386>>>>>            Entry_Item (Export_Code_Description(Self,2,Baxiokat.Baxiokat_type))
46387>>>>>        End_Row
46392>>>>>
46392>>>>>        Set Form_Width    item 0 to 36
46393>>>>>        Set Header_Label  item 0 to "„ ›¦ª"
46394>>>>>        
46394>>>>>        Set Form_Width    item 1 to 194
46395>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
46396>>>>>        
46396>>>>>        Set Form_Width    item 2 to 29
46397>>>>>        Set Header_Label  item 2 to "„ ©./¢ž¨."
46398>>>>>        
46398>>>>>        Set Form_Width    item 3 to 83
46399>>>>>        Set Header_Label  item 3 to "„ ©./¢ž¨."
46400>>>>>        
46400>>>>>
46400>>>>>        //AB-StoreStart
46400>>>>>                                
46400>>>>>        Property Integer piStoreFragmaBtypkinCode 0
46402>>>>>        
46402>>>>>        
46402>>>>>        Procedure Store_Defaults
46404>>>>>           Forward Send Store_Defaults
46406>>>>>           Set piStoreFragmaBtypkinCode to (piFragmaBtypkinCode(Self))
46407>>>>>        End_Procedure
46408>>>>>        
46408>>>>>        Procedure ReStore_Defaults
46410>>>>>           Forward Send ReStore_Defaults
46412>>>>>           Set piFragmaBtypkinCode to (piStoreFragmaBtypkinCode(Self))
46413>>>>>        End_Procedure
46414>>>>>        
46414>>>>>        Procedure Activating
46416>>>>>           Forward Send Activating
46418>>>>>           Send Rebuild_Constraints to Bkinkat_DD
46419>>>>>        End_Procedure
46420>>>>>        
46420>>>>>        
46420>>>>>        //AB-StoreEnd
46420>>>>>
46420>>>>>    End_Object    // oSelList
46421>>>>>
46421>>>>>    Object oOK_bn is a ButtonSub
46423>>>>>        Set Label to "&„§ ¢¦šã"
46424>>>>>        Set Location to 172 195
46425>>>>>
46425>>>>>        //AB-StoreStart
46425>>>>>        Procedure OnClick
46427>>>>>            Send OK To (oSelList(current_object))
46428>>>>>        End_Procedure
46429>>>>>        //AB-StoreEnd
46429>>>>>
46429>>>>>    End_Object    // oOK_bn
46430>>>>>
46430>>>>>    Object oCancel_bn is a ButtonSub
46432>>>>>        Set Label to "&€¡ç¨à©ž"
46433>>>>>        Set Location to 172 250
46434>>>>>
46434>>>>>        //AB-StoreStart
46434>>>>>        Procedure OnClick
46436>>>>>            Send Cancel To (oSelList(current_object))
46437>>>>>        End_Procedure
46438>>>>>        //AB-StoreEnd
46438>>>>>
46438>>>>>    End_Object    // oCancel_bn
46439>>>>>
46439>>>>>    Object oSearch_bn is a ButtonSub
46441>>>>>        Set Label to "€&¤˜ã«ž©ž"
46442>>>>>        Set Location to 172 304
46443>>>>>
46443>>>>>        //AB-StoreStart
46443>>>>>        Procedure OnClick
46445>>>>>            Send Search To (oSelList(current_object))
46446>>>>>        End_Procedure
46447>>>>>        //AB-StoreEnd
46447>>>>>
46447>>>>>    End_Object    // oSearch_bn
46448>>>>>
46448>>>>>
46448>>>>>    //AB-StoreStart
46448>>>>>    
46448>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
46449>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
46450>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
46451>>>>>    
46451>>>>>    
46451>>>>>    
46451>>>>>    
46451>>>>>    //AB-StoreEnd
46451>>>>>
46451>>>>>CD_End_Object    // sl033
46453>>>>>>
46453>>>>>
46453>>>>>//AB/ End_Object    // prj
46453>>>Use sl034.sl
46453>>>Use sl036.sl
INCLUDING FILE: SL036.SL
46453>>>>>//AB/ Project SL036:BARTICL
46453>>>>>//AB/     Object prj is a Lookup_Project
46453>>>>>//AB/         Set ProjectName to "SL036:BARTICL"
46453>>>>>//AB/         Set ProjectFileName to "SL036.SL"
46453>>>>>
46453>>>>>// Project Object Structure
46453>>>>>//   SL036 is a dbModalPanelSub
46453>>>>>//     Btypkin_DD is a DataDictionary
46453>>>>>//     Barticl_DD is a DataDictionary
46453>>>>>//     oSelList is a dbListSub
46453>>>>>//     oOK_bn is a ButtonSub
46453>>>>>//     oCancel_bn is a ButtonSub
46453>>>>>//     oSearch_bn is a ButtonSub
46453>>>>>
46453>>>>>// Register all objects
46453>>>>>Register_Object Barticl_DD
46453>>>>>Register_Object Btypkin_DD
46453>>>>>Register_Object oCancel_bn
46453>>>>>Register_Object oOK_bn
46453>>>>>Register_Object oSearch_bn
46453>>>>>Register_Object oSelList
46453>>>>>Register_Object SL036
46453>>>>>
46453>>>>>
46453>>>>>    //AB-IgnoreStart
46453>>>>>
46453>>>>>    Use DFAllEnt.pkg
46453>>>>>    Use dbList.Sub
46453>>>>>    Use Button.Sub
46453>>>>>
46453>>>>>
46453>>>>>    Use BTYPKIN.DD
46453>>>>>    Use BARTICL.DD
INCLUDING FILE: BARTICL.DD
46453>>>>>>>//DDB-FileStart
46453>>>>>>>//DDB-HeaderStart
46453>>>>>>>
46453>>>>>>>// File Name : BARTICL.DD
46453>>>>>>>// Class Name: Barticl_DataDictionary
46453>>>>>>>// Revision  : 94
46453>>>>>>>// Version   : 2
46453>>>>>>>
46453>>>>>>>Use  Windows           // Basic Definitions
46453>>>>>>>Use  DataDict          // DataDictionary Class Definition
46453>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46453>>>>>>>
46453>>>>>>>Open Barticl
46455>>>>>>>Open Bmove
46457>>>>>>>Open Bsum
INCLUDING FILE: BSUM.FD
46459>>>>>>>Open Btypkin
46461>>>>>>>Open Sysrecb
46463>>>>>>>Open Cn
46465>>>>>>>
46465>>>>>>>//DDB-HeaderEnd
46465>>>>>>>//DDB-ValidationStart
46465>>>>>>>
46465>>>>>>>Register_Object Barticl_Barticl_M_Code_VT
46465>>>>>>>
46465>>>>>>>Object Barticl_Barticl_M_Code_VT  is a CodeValidationTable
46467>>>>>>>    Set Type_Value        To "MODULE"
46468>>>>>>>    Set Allow_Blank_State To TRUE
46469>>>>>>>    //DDB-ValidationCustomStart
46469>>>>>>>    //DDB-ValidationCustomEnd
46469>>>>>>>End_Object   // Barticl_Barticl_M_Code_VT
46470>>>>>>>//DDB-ValidationEnd
46470>>>>>>>//DDB-SelectionStart
46470>>>>>>>//DDB/ ExternalSelectionList Barticl  Barticl.SL
46470>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
46470>>>>>>>Register_Object Barticl
46470>>>>>>>Register_Object sl041
46470>>>>>>>//DDB-SelectionEnd
46470>>>>>>>
46470>>>>>>>Class Barticl_DataDictionary  is a DataDictionary_Sec
46471>>>>>>>
46471>>>>>>>    Procedure Shmera integer iField  Date dDate
46472>>>>>>>        Local Integer Changed
46473>>>>>>>        Get Field_Changed_State iField to Changed
46474>>>>>>>        If (Changed=0 AND dDate =0) Begin
46476>>>>>>>            SysDate4 dDate
46477>>>>>>>            Set Field_Default_Value iField to dDate
46478>>>>>>>        End
46478>>>>>>>>
46478>>>>>>>    End_Procedure   // Shmera
46479>>>>>>>
46479>>>>>>>    Procedure Save_Main_File
46480>>>>>>>        If (Barticl.Cn_Code<>'') Begin  
46482>>>>>>>            Clear Cn   
46483>>>>>>>            Move Barticl.Cn_Code to Cn.Cn_Code
46484>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code  
46485>>>>>>>>
46485>>>>>>>            Move Cn.Cn_Sls_ID     to Barticl.Sls_ID
46486>>>>>>>            Move Cn.Cn_Presp_ID   to Barticl.Presp_ID
46487>>>>>>>            Move Cn.CN_Cnt_ID     to Barticl.Cnt_ID
46488>>>>>>>        End
46488>>>>>>>>
46488>>>>>>>        Forward Send Save_Main_File
46490>>>>>>>    End_Procedure   // Save_Main_File
46491>>>>>>>
46491>>>>>>>      Procedure private.Initialize_Properties
46492>>>>>>>                 //£ž›œ¤ ©£æª §˜¢˜ é¤
46492>>>>>>>                 Set psB_Btypkin_Recr    to ''
46493>>>>>>>                 Set pdB_Barticl_Hmnia   to 0
46494>>>>>>>                 Set piB_Barticl_No      to 0
46495>>>>>>>                 Set psB_Barticl_Code1   to ""
46496>>>>>>>
46496>>>>>>>                 Set pdB_Garticl_Hmnia   to 0  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
46497>>>>>>>                 Set piB_Garticl_No      to 0
46498>>>>>>>                 Set psB_Garticl_Aitiol  to ""
46499>>>>>>>
46499>>>>>>>                 //£ž›œ¤ ©£æª ¤âà¤
46499>>>>>>>                 Set psA_Btypkin_Recr    to ''
46500>>>>>>>                 Set pdA_Barticl_Hmnia   to 0
46501>>>>>>>                 Set piA_Barticl_No      to 0
46502>>>>>>>                 Set psA_Barticl_Code1   to ""
46503>>>>>>>
46503>>>>>>>                 Set pdA_Garticl_Hmnia   to 0  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
46504>>>>>>>                 Set piA_Garticl_No      to 0
46505>>>>>>>                 Set psA_Garticl_Aitiol  to ""
46506>>>>>>>
46506>>>>>>>                 Set psB_Gplan_Code to ""
46507>>>>>>>                 Set psA_Gplan_Code to ""
46508>>>>>>>
46508>>>>>>>      End_Procedure //private.Initialize_Properties
46509>>>>>>>
46509>>>>>>>
46509>>>>>>>      Procedure Construct_Object
46510>>>>>>>                Forward Send Construct_Object
46512>>>>>>>
46512>>>>>>>                Property String  psA_Btypkin_Recr     ''
46513>>>>>>>                Property Date    pdA_Barticl_Hmnia    0
46514>>>>>>>                Property Integer piA_Barticl_No       0
46515>>>>>>>                Property String  psB_Barticl_Code1    ""
46516>>>>>>>
46516>>>>>>>                Property String  psB_Btypkin_Recr     ''
46517>>>>>>>                Property Date    pdB_Barticl_Hmnia    0
46518>>>>>>>                Property Integer piB_Barticl_No       0
46519>>>>>>>                Property String  psA_Barticl_Code1    ""
46520>>>>>>>
46520>>>>>>>                Property Date    pdA_Garticl_Hmnia    0 //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
46521>>>>>>>                Property Integer piA_Garticl_No       0
46522>>>>>>>                Property String  psA_Garticl_Aitiol   ''
46523>>>>>>>
46523>>>>>>>                Property Date    pdB_Garticl_Hmnia    0 //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
46524>>>>>>>                Property Integer piB_Garticl_No       0
46525>>>>>>>                Property String  psB_Garticl_Aitiol   ''
46526>>>>>>>
46526>>>>>>>
46526>>>>>>>                Property Integer piBaxio_dd           0 //object id «¦¬ ddo server š ˜ «¦ baxio
46527>>>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
46527>>>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ ???
46527>>>>>>>                Property Integer piBaxiokat_dd        0 //object id «¦¬ ddo server š ˜ «¦ baxio
46528>>>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
46528>>>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ ???
46528>>>>>>>                Property Integer piBmove_dd           0 //object id «¦¬ ddo server š ˜ «¦ bmove
46529>>>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
46529>>>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ cascade update
46529>>>>>>>                Property Integer piBtypkin_dd         0 //object id «¦¬ ddo server š ˜ «¦ btypkin
46530>>>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
46530>>>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ cascade update
46530>>>>>>>
46530>>>>>>>                Property String  psB_Gplan_Code
46531>>>>>>>                Property String  psA_Gplan_Code
46532>>>>>>>
46532>>>>>>>
46532>>>>>>>                Property Integer piCreated_Barticl 0 //©œ«á¨œ«˜  ©«ž¤ creating,
46533>>>>>>>                                                     //®¨ž© £¦§¦ œå«˜  ©«ž¤ update+validate_save ¡˜ 
46533>>>>>>>                                                     //£ž›œ¤åœ«˜  ©«ž¤ request_save «¦¬ bmove
46533>>>>>>>
46533>>>>>>>                Property  Integer piDo_GL_Maintainance       0 //object id «žª business process
46534>>>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «ã¤ šœ¤ ¡ã ¢¦š ©« ¡ã
46534>>>>>>>                Property  Integer piDo_CUSTOMER_Maintainance 0 //object id «žª business process
46535>>>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §œ¢á«œª
46535>>>>>>>                Property  Integer piDo_VENDOR_Maintainance   0 //object id «žª business process
46536>>>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §¨¦£žŸœ¬«âª
46536>>>>>>>      End_Procedure   //construct_object
46537>>>>>>>
46537>>>>>>>      Procedure Update
46538>>>>>>>                Integer liBAxio_dd liBaxiokat_dd
46539>>>>>>>                Forward Send Update
46541>>>>>>>
46541>>>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
46541>>>>>>>                Move Syscurxr.Company_Code  to Barticl.Company_Code
46542>>>>>>>                Move Syscurxr.Branch_Code   to Barticl.Branch_Code
46543>>>>>>>                Move Syscurxr.Year_Year     to Barticl.Year_Year
46544>>>>>>>                Move Btypkin.Btypkin_Code   to Barticl.Btypkin_Code
46545>>>>>>>
46545>>>>>>>
46545>>>>>>>                //™) ˜¤áš¤à©ž properties
46545>>>>>>>                Get piBaxio_dd    to liBaxio_dd    //«¦ ddo §¦¬ "©œ¨™å¨œ " «¦ baxio
46546>>>>>>>                Get piBaxiokat_dd to liBaxiokat_dd //«¦ ddo §¦¬ "©œ¨™å¨œ " «¦ baxiokat
46547>>>>>>>
46547>>>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
46547>>>>>>>                //š.1:btypkin.btypkin_L_Hmnia //«œ¢œ¬«˜å˜ ž£œ¨¦£ž¤å˜
46547>>>>>>>                 Move (Barticl.Barticl_Hmnia Max Btypkin.Btypkin_L_Hmnia) to Btypkin.Btypkin_L_Hmnia
46548>>>>>>>
46548>>>>>>>                Case Begin
46548>>>>>>>                    Case (Btypkin.Btypkin_Anti2 = 5) //§˜¨˜¢ã§«žª œå¤˜  ¦ å› ¦ª ¦ ©¬¤˜¢¢˜©æ£œ¤¦ª
46550>>>>>>>                        Move Barticl.Barticl_Code1 to Barticl.Barticl_Code2
46551>>>>>>>                        Move Barticl.Barticl_Epon1 to Barticl.Barticl_Epon2
46552>>>>>>>                      Case Break
46553>>>>>>>                    Case (Btypkin.Btypkin_Anti2 = (-1)) //›â¤ ¬§á¨®œ  §˜¨˜¢ã§«žª
46556>>>>>>>                        Move ""                    to Barticl.Barticl_Code2
46557>>>>>>>                        Move ""                    to Barticl.Barticl_Epon2
46558>>>>>>>                      Case Break
46559>>>>>>>                Case End
46559>>>>>>>
46559>>>>>>>
46559>>>>>>>                Case Begin
46559>>>>>>>                    Case ((Btypkin.Btypkin_Anti1=2) Or (Btypkin.Btypkin_Anti1=3))
46561>>>>>>>                        Clear Clients
46562>>>>>>>                        Move Barticl.Barticl_Code1 to Clients.Client_ID
46563>>>>>>>                        Find Eq Clients by Index.6 //Client_ID
46564>>>>>>>>
46564>>>>>>>                        If (Found = 1) Move Clients.Client_Recr to Barticl.Client_Mrecr
46567>>>>>>>                        Else Send Operation_Not_Allowed 3002 //›â¤ ™¨âŸž¡œ «¦ Master Customer_rec0, please reindex
46569>>>>>>>                      Case Break
46570>>>>>>>                Case End
46570>>>>>>>
46570>>>>>>>                If (Btypkin.Gtypkin_Code <> 0);                Begin //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã, ®¨œ á¦£˜  ¦§à›ã§¦«œ
46572>>>>>>>                      //master gplan rec0
46572>>>>>>>                      Case Begin
46572>>>>>>>                           Case (Btypkin.Btypkin_Anti1 = 1) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ š¢
46574>>>>>>>//jsjsjs 24/01/2001
46574>>>>>>>//                                Clear Gplan
46574>>>>>>>//                                Move Barticl.Company_Code  to Gplan.Company_Code
46574>>>>>>>//                                Move Barticl.Branch_Code   to Gplan.Branch_Code
46574>>>>>>>//                                Move Barticl.Year_Year     to Gplan.Year_Year
46574>>>>>>>//                                Move Barticl.Barticl_Code1 to Gplan.Gplan_Code
46574>>>>>>>//                                Find Eq Gplan by Index.1 //company_code+branch_code+year_year+Gplan_code
46574>>>>>>>//                                If (Found = 1) Move Gplan.Gplan_Rec0 to Barticl.Gplan_Mrec0
46574>>>>>>>//                                Else           Send Operation_Not_Allowed 3001 //›â¤ ™¨âŸž¡œ «¦ Master Gplan_rec0
46574>>>>>>>//jsjsjs 24/01/2001
46574>>>>>>>                           Case Break
46575>>>>>>>                           Case Else                        //=4 ¢¦ §¦å:©¬¤˜¢¢˜©æ£œ¤¦ª £œ user manual data entry
46575>>>>>>>                                Move 0 to Barticl.Gplan_Mrec0
46576>>>>>>>                      Case End
46576>>>>>>>                End   //please check the logic
46576>>>>>>>>
46576>>>>>>>
46576>>>>>>>
46576>>>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
46576>>>>>>>
46576>>>>>>>                //œ) œ¤ž£â¨à©ž properties after (˜§æ parent buffers!)
46576>>>>>>>                Set psA_Btypkin_Recr    to Btypkin.Btypkin_Recr
46577>>>>>>>                Set pdA_Barticl_Hmnia   to Barticl.Barticl_Hmnia
46578>>>>>>>                Set piA_Barticl_No      to Barticl.Barticl_No
46579>>>>>>>                Set psA_Barticl_Code1   to Barticl.Barticl_Code1
46580>>>>>>>
46580>>>>>>>                Set pdA_Garticl_Hmnia   to Barticl.Barticl_Hmnia  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
46581>>>>>>>                Set piA_Garticl_No      to Barticl.Barticl_No
46582>>>>>>>                Set psA_Garticl_Aitiol  to Barticl.Barticl_Aitiol
46583>>>>>>>
46583>>>>>>>      End_Procedure   //update
46584>>>>>>>
46584>>>>>>>
46584>>>>>>>      Procedure Backout
46585>>>>>>>                Forward Send Backout
46587>>>>>>>
46587>>>>>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
46587>>>>>>>                Set psB_Btypkin_Recr    to Barticl.Btypkin_Recr
46588>>>>>>>                Set pdB_Barticl_Hmnia   to Barticl.Barticl_Hmnia
46589>>>>>>>                Set piB_Barticl_No      to Barticl.Barticl_No
46590>>>>>>>                Set psB_Barticl_Code1   to Barticl.Barticl_Code1
46591>>>>>>>
46591>>>>>>>                Set pdB_Garticl_Hmnia   to Barticl.Barticl_Hmnia  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
46592>>>>>>>                Set piB_Garticl_No      to Barticl.Barticl_No
46593>>>>>>>                Set psB_Garticl_Aitiol  to Barticl.Barticl_Aitiol
46594>>>>>>>      End_Procedure   // backout
46595>>>>>>>
46595>>>>>>>
46595>>>>>>>      Procedure Creating 
46596>>>>>>>                string sstr
46597>>>>>>>                Forward Send Creating
46599>>>>>>>
46599>>>>>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBarticl //˜¨ Ÿ£æª á¨Ÿ¨à¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
46599>>>>>>>
46599>>>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                            (Trim(String(Barticl.Barticl_Rec0)))))) to Barticl.Barticl_Recr
46600>>>>>>>
46600>>>>>>>                If (Barticl.Barticl_M_Code='') Move gs_Module_Code to Barticl.Barticl_M_Code
46603>>>>>>>
46603>>>>>>>                //************************************************************************
46603>>>>>>>                //flag 5:˜¬«æ£˜«ž ˜¨åŸ£ž©ž                                               *
46603>>>>>>>                //************************************************************************
46603>>>>>>>                If (Btypkin.Btypkin_Flag05 = TRUE);                     Begin //«¦ á¨Ÿ¨¦ â®œ  ˜¬«æ£˜«ž ˜¨åŸ£ž©ž
46605>>>>>>>                      Add 1 to Btypkin.Btypkin_L_No
46606>>>>>>>                      Move Btypkin.Btypkin_L_No  to Barticl.Barticl_No
46607>>>>>>>                     End
46607>>>>>>>>
46607>>>>>>>                Else Begin //«¦ á¨Ÿ¨¦ â®œ  ®œ ¨¦¡å¤ž«ž ˜¨åŸ£ž©ž
46608>>>>>>>                     End
46608>>>>>>>>
46608>>>>>>>                if ((btypkin.locked=1) and (barticl.barticl_hmnia ge btypkin.locked_date)) error 1966 '† ¡å¤ž©ž œå¤˜  ¡¢œ ›à£â¤ž' 
46611>>>>>>>                move '€¨.€„' To sstr 
46612>>>>>>>                Move (Append(sstr,(' '+(string(barticl.pae_arithm))+' - '+(string(Barticl.pae_hmnia))))) to sstr
46613>>>>>>>                move sstr to barticl.barticl_aitiol 
46614>>>>>>>                move 1 to barticl.ekkremes
46615>>>>>>>                
46615>>>>>>>                
46615>>>>>>>                Set piCreated_Barticl to TRUE
46616>>>>>>>      End_Procedure //creating
46617>>>>>>>
46617>>>>>>>
46617>>>>>>>      Procedure Deleting
46618>>>>>>>                Forward Send Deleting
46620>>>>>>>
46620>>>>>>>                //jsjsjs 24/01/2001 Sub 1 from Year.Year_NumBarticl //˜¨ Ÿ£æª á¨Ÿ¨à¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
46620>>>>>>>                If (Btypkin.Btypkin_L_No = Barticl.Barticl_No);                Begin //œá¤ › ˜š¨á­à «¦¤ «œ¢œ¬«˜å¦ ˜¨ Ÿ£æª !!! sos pleas check the logic!
46622>>>>>>>                  Sub 1 from Btypkin.Btypkin_L_No
46623>>>>>>>                  // js 05/09/2002
46623>>>>>>>                  Saverecord Btypkin
46624>>>>>>>                End
46624>>>>>>>>
46624>>>>>>>      End_Procedure //deleting
46625>>>>>>>
46625>>>>>>>
46625>>>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
46626>>>>>>>                String lsError_Message
46627>>>>>>>                Case Begin
46627>>>>>>>                     //˜§æ validate save
46627>>>>>>>                     Case (iError_Num = 1001)
46629>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž †£œ¨¦£ž¤å˜ !\n\n‹ ¡¨æ«œ¨ž «žª œ¤á¨¥œàª ®¨ã©œàª ("+;                          (String(SysCurXr.Year_XrhshFrom))+")") to lsError_Message
46630>>>>>>>                     Case Break
46631>>>>>>>                     Case (iError_Num = 1002)
46634>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž †£œ¨¦£ž¤å˜ !\n\n‹œš˜¢ç«œ¨ž «žª ¢ã¥œàª ®¨ã©œàª ("+;                          (String(SysCurXr.Year_XrhshTo))+")") to lsError_Message
46635>>>>>>>                     Case Break
46636>>>>>>>                     Case (iError_Num = 1003)
46639>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "ƒâ¤ œ§ «¨â§œ«˜  ˜¢˜šã «ç§¦¬ ¡å¤ž©žª!");                          to lsError_Message
46640>>>>>>>                     Case Break
46641>>>>>>>                     Case (iError_Num = 1004)
46644>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n† ž£œ¨¦£ž¤å˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ «¦ á¨Ÿ¨¦!");                          to lsError_Message
46645>>>>>>>                     Case Break
46646>>>>>>>                     Case (iError_Num = 1005)
46649>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\nŽ ˜¨ Ÿ£æª «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ «¦ á¨Ÿ¨¦!");                          to lsError_Message
46650>>>>>>>                     Case Break
46651>>>>>>>                     Case (iError_Num = 1006)
46654>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n† ˜ « ¦¢¦šå˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ «¦ á¨Ÿ¨¦!");                          to lsError_Message
46655>>>>>>>                     Case Break
46656>>>>>>>                     Case (iError_Num = 1007)
46659>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n‹ž›œ¤ ¡æª ˜¨ Ÿ£æª §˜¨˜©«˜« ¡¦ç !");                          to lsError_Message
46660>>>>>>>                     Case Break
46661>>>>>>>                     Case (iError_Num = 1008)
46664>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "ƒâ¤ œ§ «¨â§œ«˜  ˜¢˜šã ©¬¤˜¢¢˜©¦£â¤¦¬!");                          to lsError_Message
46665>>>>>>>                     Case Break
46666>>>>>>>                     Case (iError_Num = 1009)
46669>>>>>>>                          Clear Codemast
46670>>>>>>>                          Move "MODULE" to Codemast.Type
46671>>>>>>>                          Move Barticl.Barticl_M_Code to Codemast.Code
46672>>>>>>>                          Find Eq Codemast by Index.1 //type+code
46673>>>>>>>>
46673>>>>>>>                          Move ("DDC 036:€›ç¤˜«ž ž „šš¨˜­ã\n\n(’¦ á¨Ÿ¨¦ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§æ "+;                          (Trim(Codemast.Description))+" )") to lsError_Message
46674>>>>>>>                     Case Break
46675>>>>>>>                     Case (iError_Num = 1011)
46678>>>>>>>                          Move ("DDC 036:€›ç¤˜«ž ž „šš¨˜­ã\n\n(ƒœ¤ â®œ  ¦¨ ©Ÿœå «¦ ¡ç¡¢à£˜!)");                          to lsError_Message
46679>>>>>>>                     Case Break
46680>>>>>>>                     Case (iError_Num = 1100)
46683>>>>>>>                          Move "DDC 036:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
46684>>>>>>>                          Case Break
46685>>>>>>>                     
46685>>>>>>>                     Case (iError_Num = 2100)
46688>>>>>>>                          Move "DDC 036:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
46689>>>>>>>                          Case Break
46690>>>>>>>
46690>>>>>>>                   //˜§æ update
46690>>>>>>>                   Case (iError_Num = 3001)
46693>>>>>>>                        Move ("DDC 036:ƒâ¤ ™¨âŸž¡œ ¦ ¡à› ¡æª "+ (Trim(Barticl.Barticl_Code1)) + " ©«ã ‚œ¤ ¡ã Š¦š ©« ¡ã !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
46694>>>>>>>                   Case Break
46695>>>>>>>                   Case (iError_Num = 3002)
46698>>>>>>>                        Move ("DDC 036:ƒâ¤ ™¨âŸž¡œ ¦ ¡à› ¡æª "+ (Trim(Barticl.Barticl_Code1)) + " ©«ã ‚œ¤ ¡ã Š¦š ©« ¡ã š ˜ «¦¤ œ¢á«ž !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
46699>>>>>>>                   Case Break
46700>>>>>>>                   Case (iError_Num = 3003)
46703>>>>>>>                        Move ("DDC 036:ƒâ¤ ™¨âŸž¡œ ¦ ¡à› ¡æª "+ (Trim(Barticl.Barticl_Code1)) + " ©«ã ‚œ¤ ¡ã Š¦š ©« ¡ã š ˜ «¦¤ ¨¦£žŸœ¬«ã !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
46704>>>>>>>                   Case Break
46705>>>>>>>
46705>>>>>>>                   Case (iError_Num = 1330)
46708>>>>>>>                          Move "DDC 036: €¨ Ÿ£æª .€.„. £ž›œ¤ ¡æª ã †£œ¨/¤å˜ .€.„. ¡œ¤ã" to lsError_Message
46709>>>>>>>                   Case Break
46710>>>>>>>
46710>>>>>>>                   Case (iError_Num = 1331)
46713>>>>>>>                          Move "DDC 036: †£œ¨/¤å˜ .€.„. ›œ¤ £§¦¨œå ¤˜ œå¤˜  > ©ã£œ¨˜" to lsError_Message
46714>>>>>>>                   Case Break
46715>>>>>>>
46715>>>>>>>                   Case (iError_Num = 1332)
46718>>>>>>>                          Move "DDC 036: †£œ¨/¤å˜ §˜¨˜©«˜« ¡¦ç ›œ¤ £§¦¨œå ¤˜ œå¤˜  > ©ã£œ¨˜" to lsError_Message
46719>>>>>>>                   Case Break
46720>>>>>>>
46720>>>>>>>                     Case Else
46720>>>>>>>                          Forward Send Operation_Not_Allowed iError_Num
46722>>>>>>>                Case End
46722>>>>>>>
46722>>>>>>>                Error iError_Num lsError_Message
46723>>>>>>>>
46723>>>>>>>      End_Procedure // operation_not_allowed
46724>>>>>>>
46724>>>>>>>      Function Validate_Save Returns Integer
46725>>>>>>>               Integer iReturnVal  
46726>>>>>>>               Date dShmera
46726>>>>>>>               Sysdate dShmera
46727>>>>>>>
46727>>>>>>>               Forward Get Validate_Save to iReturnVal
46729>>>>>>>               //Set piCreated_Barticl to 0
46729>>>>>>>
46729>>>>>>>               If (Not(iReturnVal));               Begin
46731>>>>>>>                //1001+1002:â¢œš®¦  ž£œ¨¦£ž¤å˜ª
46731>>>>>>>                If (Not(Barticl.Barticl_Hmnia >= SysCurXr.Year_XrhshFrom )) Send Operation_Not_Allowed 1001
46734>>>>>>>                If (Not(Barticl.Barticl_Hmnia <= SysCurXr.Year_XrhshTo   )) Send Operation_Not_Allowed 1002
46737>>>>>>>
46737>>>>>>>                //1007:â¢œš®¦ª ˜¨ Ÿ£¦ç §˜¨˜©«˜« ¡¦ç
46737>>>>>>>                If (Not(Barticl.Barticl_No     >  0                  )) Send Operation_Not_Allowed 1007
46740>>>>>>>                
46740>>>>>>>                
46740>>>>>>>                //1011:â¢œš®¦ª £ã ¡œ¤¦ç module œšš¨˜­ãª
46740>>>>>>>                If (Trim(Barticl.Barticl_M_Code)="")       Send Operation_Not_Allowed 1011
46743>>>>>>>                //---------«â¢¦ª œ¢âš®à¤ create & edit barticl record----------------------
46743>>>>>>>
46743>>>>>>>                //---------â¢œš®¦  create barticl record----------------------
46743>>>>>>>                //sososo £ž§àª §¨œ§œ  ¤˜ §˜ ¥à £œ «ž¤ current record ????
46743>>>>>>>                If (Barticl.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ record
46745>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ barticl record
46745>>>>>>>>
46745>>>>>>>
46745>>>>>>>                //---------â¢œš®¦  editing existing barticl records-------------------
46745>>>>>>>                Else;                Begin //edit an existing record
46746>>>>>>>                      //1003:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent btypkin record
46746>>>>>>>                      If (Not;                          ((psB_Btypkin_Recr(Self)) = Btypkin.Btypkin_Recr);                         )                                              Send Operation_Not_Allowed 1003
46749>>>>>>>                      //1004:«¨¦§¦§¦åž©ž (edit) barticl_hmnia £æ¤¦¤ ˜§æ barticl_dd
46749>>>>>>>                      If (;                           ((pdB_Barticl_Hmnia(Self))     <> Barticl.Barticl_Hmnia) and;                           ((Main_File(OPERATION_ORIGIN)) <> Barticl.File_Number);                         )                                              Send Operation_Not_Allowed 1004
46752>>>>>>>                      //1005:«¨¦§¦§¦åž©ž (edit) barticl_no £æ¤¦¤ ˜§æ barticl_dd
46752>>>>>>>                      If (;                           ((piB_Barticl_No   (Self))     <> Barticl.Barticl_No) and;                           ((Main_File(OPERATION_ORIGIN)) <> Barticl.File_Number);                         )                                              Send Operation_Not_Allowed 1005
46755>>>>>>>
46755>>>>>>>
46755>>>>>>>                      //1006:«¨¦§¦§¦åž©ž (edit) barticl_aitiol £æ¤¦¤ ˜§æ barticl_dd
46755>>>>>>>                      If (;                           ((psB_Garticl_Aitiol(Self))    <> Barticl.Barticl_Aitiol) and;                           ((Main_File(OPERATION_ORIGIN)) <> Barticl.File_Number) ;                         )                                              Send Operation_Not_Allowed 1006
46758>>>>>>>
46758>>>>>>>
46758>>>>>>>
46758>>>>>>>                      //1008:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã barticl_code1 (©¬¤˜¢¢˜©¦£â¤¦¬)
46758>>>>>>>                      If (Not;                          ((psB_Barticl_Code1(Self)) = Barticl.Barticl_Code1);                         )                                              Send Operation_Not_Allowed 1008
46761>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing barticl record
46761>>>>>>>>
46761>>>>>>>                If ( ;                    (Not(Barticl.Company_Code = Syscurxr.Company_Code)) or;                    (Not(Barticl.Branch_Code  = Syscurxr.Branch_Code )) or;                    (Not(Barticl.Year_Year    = Syscurxr.Year_Year   ));                    )                                                   Send Operation_Not_Allowed 1100
46764>>>>>>>
46764>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation         
46764>>>>>>>>
46764>>>>>>>               
46764>>>>>>>                If (sysfile.serial_number='1') Begin
46766>>>>>>>                    If ((Barticl.PAE_Arithm=0) Or (Barticl.PAE_Hmnia=""))   Send Operation_Not_Allowed 1330
46769>>>>>>>                    If (Barticl.PAE_Hmnia>dShmera)                          Send Operation_Not_Allowed 1331
46772>>>>>>>                End
46772>>>>>>>>
46772>>>>>>>
46772>>>>>>>                If (Barticl.Barticl_Hmnia>dShmera)                          Send Operation_Not_Allowed 1332
46775>>>>>>>               
46775>>>>>>>               Function_Return iReturnVal
46776>>>>>>>      End_Function   // validate_save
46777>>>>>>>
46777>>>>>>>
46777>>>>>>>      Function Validate_Delete  Returns Integer
46778>>>>>>>               Integer iReturnVal
46779>>>>>>>               Forward Get Validate_Delete  To iReturnVal
46781>>>>>>>               If (Not(iReturnVal));               Begin
46783>>>>>>>                    If ( ;                        (Not(Barticl.Company_Code = Syscurxr.Company_Code)) or;                        (Not(Barticl.Branch_Code  = Syscurxr.Branch_Code )) or;                        (Not(Barticl.Year_Year    = Syscurxr.Year_Year   ));                        )                                                   Send Operation_Not_Allowed 2100
46786>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
46786>>>>>>>>
46786>>>>>>>               Function_Return iReturnVal
46787>>>>>>>      End_Function   // Validate_Delete
46788>>>>>>>
46788>>>>>>>
46788>>>>>>>
46788>>>>>>>      Procedure Request_Save
46789>>>>>>>               Integer liGarticl_Rec0 liCmove_Rec0 liVmove_Rec0 iErrorObj
46790>>>>>>>
46790>>>>>>>               Send private.Initialize_Properties //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties
46791>>>>>>>
46791>>>>>>>               //ž cascade update «¨â®œ  £æ¤¦¤ ©œ existing barticl records
46791>>>>>>>               //æ«˜¤ ›ž£ ¦¬¨šé ¤â¦ record, «æ«œ ›â¤ ®¨œ á¦£˜  «å§¦«˜
46791>>>>>>>               If ((Current_Record(Self)) = 0) Begin
46793>>>>>>>                    Forward Send Request_Save
46795>>>>>>>                    Send private.Initialize_Properties //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties
46796>>>>>>>                    Procedure_Return
46797>>>>>>>               End
46797>>>>>>>>
46797>>>>>>>
46797>>>>>>>               //æ«˜¤ ¡á¤à edit existing record, §¨â§œ  ¤˜ «¨â®à «ž¤ cascade update
46797>>>>>>>               //š ˜ ¤˜ â¤ž£œ¨é©à (œá¤ ­¬© ¡á ®¨œ áœ«˜ ) «˜ child bmoves
46797>>>>>>>               //£œ « ª ˜¢¢˜šâª «à¤ 3 foreign §œ›åà¤ «¦¬ barticl
46797>>>>>>>               //(btypkin_code+barticl_hmnia+barticl_no)
46797>>>>>>>               //§¨æª «¦ §˜¨æ¤ ›â¤ œ§ «¨â§œ«˜  ˜¢¢˜šã «¦¬ btypkin.
46797>>>>>>>
46797>>>>>>>               BEGIN_TRANSACTION
46798>>>>>>>               Move Error_Object_ID to iErrorObj
46799>>>>>>>               Forward Send Request_Save
46801>>>>>>>
46801>>>>>>>               //˜¤áš¤à©ž rec0's «à¤ ˜¤«å©«¦ ®à¤ articl's «à¤ ¢¦ §é¤ modules
46801>>>>>>>               Get Field_Current_Value Field Barticl.Garticl_Rec0 to liGarticl_Rec0
46802>>>>>>>               Get Field_Current_Value Field Barticl.Carticl_Rec0 to liCmove_Rec0
46803>>>>>>>               Get Field_Current_Value Field Barticl.Varticl_Rec0 to liVmove_Rec0
46804>>>>>>>
46804>>>>>>>               Send private.Transaction_Cascade_Update_Bmove //cascade œ¤ž£â¨à©ž bmove
46805>>>>>>>
46805>>>>>>>               END_TRANSACTION
46806>>>>>>>               Move iErrorObj to Error_Object_ID
46807>>>>>>>               Send private.Initialize_Properties //£ž›œ¤ ©£æª properties š ˜ œ§æ£œ¤ž ¡å¤ž©ž
46808>>>>>>>
46808>>>>>>>               //œ§˜¤˜­¦¨á «¦¬ system indicator err
46808>>>>>>>               Indicate Err False
46809>>>>>>>     End_Procedure   // request_save
46810>>>>>>>
46810>>>>>>>
46810>>>>>>>     //ž ¨¦¬«å¤˜ ˜¬«ã ˜¤˜¢˜£™á¤œ  ¤˜ ¡á¤œ  cascade update ©«¦ bmove
46810>>>>>>>     //¡˜¢œå«˜  ˜§æ «ã¤ request save, £â©˜ ˜§æ transaction, £æ¤¦¤ š ˜ existing barticl records.
46810>>>>>>>     //œ§ ©«¨â­œ  ¢áŸž :
46810>>>>>>>     Procedure private.Transaction_Cascade_Update_Bmove
46811>>>>>>>               Integer liBmove_dd
46812>>>>>>>
46812>>>>>>>               //§˜¢˜ âª ¡˜  ¤âœª « £âª «¦¬ barticl
46812>>>>>>>               String   lsB_Btypkin_Recr     lsA_Btypkin_Recr
46812>>>>>>>               Date     ldB_Barticl_Hmnia    ldA_Barticl_Hmnia
46812>>>>>>>               Integer  liB_Barticl_No       liA_Barticl_No
46812>>>>>>>
46812>>>>>>>               //˜¤áš¤à©ž §˜¢˜ é¤ « £é¤ barticl
46812>>>>>>>               Get psB_Btypkin_Recr    to lsB_Btypkin_Recr
46813>>>>>>>               Get pdB_Barticl_Hmnia   to ldB_Barticl_Hmnia
46814>>>>>>>               Get piB_Barticl_No      to liB_Barticl_No
46815>>>>>>>
46815>>>>>>>               //˜¤áš¤à©ž ¤âà¤ « £é¤ barticl
46815>>>>>>>               Get psA_Btypkin_Recr    to lsA_Btypkin_Recr
46816>>>>>>>               Get pdA_Barticl_Hmnia   to ldA_Barticl_Hmnia
46817>>>>>>>               Get piA_Barticl_No      to liA_Barticl_No
46818>>>>>>>
46818>>>>>>>               //œá¤ æ¢œª ¦  « £âª before+after œå¤˜  å©œª,
46818>>>>>>>               //«æ«œ ›â¤ £§˜å¤à ¡˜Ÿæ¢¦¬ ©«¦¤ ¡æ§¦ ¤˜ «¨â¥à,
46818>>>>>>>               //˜¢¢á ­œçšà ...«¨â®¦¤«˜ª!
46818>>>>>>>               If (;                    (lsB_Btypkin_Recr   = lsA_Btypkin_Recr   ) and;                    (ldB_Barticl_Hmnia  = ldA_Barticl_Hmnia  ) and;                    (liB_Barticl_No     = liA_Barticl_No     )    ;                   ) Begin
46820>>>>>>>                      Procedure_Return
46821>>>>>>>                     End
46821>>>>>>>>
46821>>>>>>>
46821>>>>>>>
46821>>>>>>>               //**************************************************************************
46821>>>>>>>               //02.rebuild constraints, ¢æšà «à¤ ¡¢á©œà¤
46821>>>>>>>               //**************************************************************************
46821>>>>>>>               Get piBmove_dd           to liBmove_dd
46822>>>>>>>               Send Rebuild_Constraints to (piBtypkin_dd(Self))
46823>>>>>>>               Send Rebuild_Constraints to Self
46824>>>>>>>               Send Rebuild_Constraints to (piBaxio_dd  (Self))
46825>>>>>>>               Send Rebuild_Constraints to liBmove_dd
46826>>>>>>>
46826>>>>>>>               //**************************************************************************
46826>>>>>>>               //03.©á¨à©ž Bmove
46826>>>>>>>               //**************************************************************************
46826>>>>>>>               Send Clear to liBmove_dd
46827>>>>>>>               Send Find to liBmove_dd FIRST_RECORD 3 //barticl_recr+bmove_rec0
46828>>>>>>>               While (Found=1)
46832>>>>>>>                      Send Request_Save to liBmove_dd
46833>>>>>>>                      Send Find to liBmove_dd NEXT_RECORD 3 //Barticl_recr+Bmove_rec0
46834>>>>>>>               Loop
46835>>>>>>>>
46835>>>>>>>               Send Find to liBmove_dd FIRST_RECORD 3 //barticl_rec0+bmove_rec0
46836>>>>>>>               //send check_arthro_for_ypol (› æ«  £§¦¨œå ¤˜ ˜¢¢á¥œ   ©¦« £å˜ !)
46836>>>>>>>     End_Procedure //private.transaction_cascade_update_bmove
46837>>>>>>>
46837>>>>>>>
46837>>>>>>>
46837>>>>>>>     //ž ¨¦¬«å¤˜ ˜¬«ã ˜¤˜¢˜£™á¤œ  ¤˜ œ¤ž£œ¨é©œ  æ©˜ ˜§¦ «˜ ¬§æ¢¦ §˜ 3 modules «¦¬ ©¬©«ã£˜«¦ª
46837>>>>>>>     //§¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤.
46837>>>>>>>     //¡˜¢œå«˜  ˜§æ «åª request save & delete, £â©˜ ˜§æ transaction.
46837>>>>>>>     //œ§ ©«¨â­œ  ¢áŸž :
46837>>>>>>>     Procedure private.Transaction_Update_Other_Modules Integer liGarticl_Rec0;                                                        Integer liCmove_Rec0;                                                        Integer liVmove_Rec0;                                                        Integer liMode
46838>>>>>>>
46838>>>>>>>               Integer liDo_GL_Maintainance liDo_CUSTOMER_Maintainance liDo_VENDOR_Maintainance
46839>>>>>>>               Integer liMust_Update_GL     liMust_Update_CUSTOMER     liMust_Update_VENDOR
46839>>>>>>>
46839>>>>>>>               //4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
46839>>>>>>>               Integer liFlag02 liFlag03 liFlag04 liFlag05
46839>>>>>>>
46839>>>>>>>               //œç¨œ©ž «à¤ ¢¦ §é¤ modules §¦¬ §¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤
46839>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Gtypkin_Rec0   to liMust_Update_GL
46840>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Ctypkin_Rec0   to liMust_Update_CUSTOMER
46841>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Vtypkin_Rec0   to liMust_Update_VENDOR
46842>>>>>>>
46842>>>>>>>               //˜¤áš¤à©ž «à¤ 4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
46842>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag02 to liFlag02
46843>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag03 to liFlag03
46844>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag04 to liFlag04
46845>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag05 to liFlag05
46846>>>>>>>
46846>>>>>>>     End_Procedure //private.transaction_update_other_modules
46847>>>>>>>
46847>>>>>>>
46847>>>>>>>    Procedure Define_Fields
46848>>>>>>>        Forward Send Define_Fields
46850>>>>>>>        //DDB-Generated-Code-Location
46850>>>>>>>        //DDB-DefineFieldStart
46850>>>>>>>
46850>>>>>>>        Set Main_File            To Barticl.File_Number
46851>>>>>>>        Set Cascade_Delete_State To FALSE
46852>>>>>>>
46852>>>>>>>
46852>>>>>>>        // Child (Client) file structure................
46852>>>>>>>        Send Add_Client_File  Bmove.File_Number
46853>>>>>>>        Send Add_Client_File  Bsum.File_Number
46854>>>>>>>
46854>>>>>>>        // Parent (Server) file structure...............
46854>>>>>>>        Send Add_Server_File  Btypkin.File_Number
46855>>>>>>>
46855>>>>>>>        // External (System) file structure.............
46855>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
46856>>>>>>>        Send Add_System_File  Cn.File_Number  DD_LOCK_ON_ALL
46857>>>>>>>
46857>>>>>>>        Define_Auto_Increment  Sysrecb.Barticl_Rec0  To Barticl.Barticl_Rec0
46860>>>>>>>
46860>>>>>>>        // Field-based properties.......................
46860>>>>>>>
46860>>>>>>>        // Barticl.Company_Code
46860>>>>>>>
46860>>>>>>>        // Barticl.Branch_Code
46860>>>>>>>
46860>>>>>>>        // Barticl.Year_Year
46860>>>>>>>
46860>>>>>>>        // Barticl.Btypkin_Code
46860>>>>>>>
46860>>>>>>>        // Barticl.Barticl_Hmnia
46860>>>>>>>        Set Field_Entry_msg        Field Barticl.Barticl_Hmnia To Shmera
46861>>>>>>>        Set Field_Mask_Type        Field Barticl.Barticl_Hmnia To MASK_DATE_WINDOW
46862>>>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_Hmnia To (Barticl(Self))
46863>>>>>>>
46863>>>>>>>        // Barticl.Barticl_No
46863>>>>>>>
46863>>>>>>>        // Barticl.Barticl_Rec0
46863>>>>>>>
46863>>>>>>>        // Barticl.Barticl_Recr
46863>>>>>>>
46863>>>>>>>        // Barticl.Btypkin_Recr
46863>>>>>>>
46863>>>>>>>        // Barticl.Barticl_Code1
46863>>>>>>>
46863>>>>>>>        // Barticl.Barticl_Epon1
46863>>>>>>>
46863>>>>>>>        // Barticl.Barticl_Code2
46863>>>>>>>
46863>>>>>>>        // Barticl.Barticl_Epon2
46863>>>>>>>
46863>>>>>>>        // Barticl.Barticl_Aitiol
46863>>>>>>>
46863>>>>>>>        // Barticl.Barticl_Sv2
46863>>>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Sv2 To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
46863>>>>>>>
46863>>>>>>>        // Barticl.Barticl_Sv0
46863>>>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Sv0 To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
46863>>>>>>>
46863>>>>>>>        // Barticl.Barticl_Sv00
46863>>>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Sv00 To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
46863>>>>>>>
46863>>>>>>>        // Barticl.Barticl_Svr
46863>>>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Svr To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
46863>>>>>>>
46863>>>>>>>        // Barticl.Barticl_Lines
46863>>>>>>>
46863>>>>>>>        // Barticl.Barticl_Bmovela
46863>>>>>>>
46863>>>>>>>        // Barticl.Barticl_M_Code
46863>>>>>>>        Set Field_Value_Table      Field Barticl.Barticl_M_Code To (Barticl_Barticl_M_Code_VT(Self))
46864>>>>>>>
46864>>>>>>>        // Barticl.Garticl_Rec0
46864>>>>>>>
46864>>>>>>>        // Barticl.Carticl_Rec0
46864>>>>>>>
46864>>>>>>>        // Barticl.Varticl_Rec0
46864>>>>>>>
46864>>>>>>>        // Barticl.Gmove_Mrec0
46864>>>>>>>
46864>>>>>>>        // Barticl.Gplan_Mrec0
46864>>>>>>>
46864>>>>>>>        // Barticl.Client_Mrecr
46864>>>>>>>
46864>>>>>>>        // Barticl.Barticl_Ekleise
46864>>>>>>>
46864>>>>>>>        // Barticl.Cmoves_Recr
46864>>>>>>>
46864>>>>>>>        // Barticl.Isotimia
46864>>>>>>>
46864>>>>>>>        // Barticl.Cn_Code
46864>>>>>>>        Set Field_Prompt_Object    Field Barticl.Cn_Code To (sl041(Self))
46865>>>>>>>
46865>>>>>>>        // Barticl.Cn_Descr
46865>>>>>>>
46865>>>>>>>        // Barticl.Cn_Recr
46865>>>>>>>
46865>>>>>>>        // Barticl.Sls_Id
46865>>>>>>>
46865>>>>>>>        // Barticl.Cnt_Id
46865>>>>>>>
46865>>>>>>>        // Barticl.Presp_Id
46865>>>>>>>
46865>>>>>>>        // Barticl.Se_Logik
46865>>>>>>>
46865>>>>>>>        // Barticl.Sxolia1
46865>>>>>>>
46865>>>>>>>        // Barticl.Sxolia2
46865>>>>>>>
46865>>>>>>>        // Barticl.Partl_Akyr_Recr
46865>>>>>>>
46865>>>>>>>        // Barticl.Ekkremes
46865>>>>>>>
46865>>>>>>>        // Barticl.Arith_Orist
46865>>>>>>>
46865>>>>>>>        // Barticl.Hmnia_Orist
46865>>>>>>>
46865>>>>>>>        // Barticl.Pae_Arithm
46865>>>>>>>
46865>>>>>>>        // Barticl.Pae_Hmnia
46865>>>>>>>
46865>>>>>>>        //DDB-DefineFieldEnd
46865>>>>>>>
46865>>>>>>>//        Set Main_File            To Barticl.File_Number
46865>>>>>>>
46865>>>>>>>//        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
46865>>>>>>>//        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
46865>>>>>>>//        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
46865>>>>>>>
46865>>>>>>>//        // Child (Client) file structure................
46865>>>>>>>//        Send Add_Client_File  Bsum.File_Number
46865>>>>>>>//        Send Add_Client_File  Bmove.File_Number
46865>>>>>>>
46865>>>>>>>//        // Parent (Server) file structure...............
46865>>>>>>>//        Send Add_Server_File  Btypkin.File_Number
46865>>>>>>>
46865>>>>>>>//        // External (System) file structure.............
46865>>>>>>>//        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
46865>>>>>>>//        //Send Add_System_File  Gplan.File_Number  DD_LOCK_ON_SAVE
46865>>>>>>>
46865>>>>>>>//        Define_Auto_Increment  Sysrecb.Barticl_Rec0  To Barticl.Barticl_Rec0
46865>>>>>>>
46865>>>>>>>        // Field-based properties.......................
46865>>>>>>>
46865>>>>>>>        // Barticl.Company_Code
46865>>>>>>>
46865>>>>>>>        // Barticl.Branch_Code
46865>>>>>>>
46865>>>>>>>        // Barticl.Year_Year
46865>>>>>>>
46865>>>>>>>        // Barticl.Btypkin_Code
46865>>>>>>>
46865>>>>>>>        // Barticl.Barticl_Hmnia
46865>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Hmnia    To "†£/¤å˜"
46866>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Hmnia    To "†£/¤å˜"
46867>>>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_Hmnia    To (Barticl(Self))
46868>>>>>>>
46868>>>>>>>        // Barticl.Barticl_No
46868>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_No       To "€¨ Ÿ£æª"
46869>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_No       To "€¨ Ÿ£æª"
46870>>>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_No       To (Barticl(Self))
46871>>>>>>>
46871>>>>>>>        // Barticl.Barticl_Rec0
46871>>>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_Rec0     To (Barticl(Self))
46872>>>>>>>        Set Key_Field_State        Field Barticl.Barticl_Rec0     To TRUE
46873>>>>>>>
46873>>>>>>>        // Barticl.Btypkin_Rec0
46873>>>>>>>
46873>>>>>>>        // Barticl.Barticl_Code1
46873>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Code1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª"
46874>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Code1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª"
46875>>>>>>>
46875>>>>>>>        // Barticl.Barticl_Epon1
46875>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Epon1    To "„§à¤¬£å˜"
46876>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Epon1    To "„§à¤¬£å˜"
46877>>>>>>>
46877>>>>>>>        // Barticl.Barticl_Code2
46877>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Code2    To "˜¨˜¢ã§«žª"
46878>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Code2    To "˜¨˜¢ã§«žª"
46879>>>>>>>
46879>>>>>>>        // Barticl.Barticl_Epon2
46879>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Epon2    To "„§à¤¬£å˜"
46880>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Epon2    To "„§à¤¬£å˜"
46881>>>>>>>
46881>>>>>>>        // Barticl.Barticl_Aitiol
46881>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Aitiol   To "€ « ¦¢¦šå˜"
46882>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Aitiol   To "€ « ¦¢¦šå˜"
46883>>>>>>>
46883>>>>>>>        // Barticl.Barticl_Sv2
46883>>>>>>>        Set Field_Options          Field Barticl.Barticl_Sv2      To DD_DISPLAYONLY
46884>>>>>>>
46884>>>>>>>        // Barticl.Barticl_Sv0
46884>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Sv0      To "‘ç¤¦¢˜ €¥ é¤ ‘œ ‰ç¨ ¦ Œæ£ ©£˜ •¨ã©žª"
46885>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Sv0      To "‘ç¤¦¢˜"
46886>>>>>>>        Set Field_Options          Field Barticl.Barticl_Sv0      To DD_DISPLAYONLY
46887>>>>>>>
46887>>>>>>>        // Barticl.Barticl_Sv00
46887>>>>>>>        Set Field_Options          Field Barticl.Barticl_Sv00     To DD_DISPLAYONLY
46888>>>>>>>
46888>>>>>>>        // Barticl.Barticl_Svr
46888>>>>>>>        Set Field_Options          Field Barticl.Barticl_Svr      To DD_DISPLAYONLY
46889>>>>>>>
46889>>>>>>>        // Barticl.Barticl_Lines
46889>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Lines    To "’œ£á® ˜"
46890>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Lines    To "’œ£á® ˜"
46891>>>>>>>        Set Field_Options          Field Barticl.Barticl_Lines    To DD_DISPLAYONLY
46892>>>>>>>
46892>>>>>>>        // Barticl.Barticl_Bmovela
46892>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Bmovela  To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª ‚¨˜££ãª"
46893>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Bmovela  To "’œ¢. €¨.‚¨˜££ãª"
46894>>>>>>>        Set Field_Options          Field Barticl.Barticl_Bmovela  To DD_DISPLAYONLY
46895>>>>>>>
46895>>>>>>>        // Barticl.Barticl_M_Code
46895>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_M_Code   To "Module „šš¨˜­ãª"
46896>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_M_Code   To "Module „šš¨˜­ãª"
46897>>>>>>>        Set Field_Options          Field Barticl.Barticl_M_Code   To DD_DISPLAYONLY
46898>>>>>>>        Set Field_Value_Table      Field Barticl.Barticl_M_Code   To (Barticl_Barticl_M_Code_VT(Self))
46899>>>>>>>
46899>>>>>>>        // Barticl.Garticl_Rec0
46899>>>>>>>        Set Field_Options          Field Barticl.Garticl_Rec0     To DD_DISPLAYONLY
46900>>>>>>>
46900>>>>>>>        // Barticl.Carticl_Rec0
46900>>>>>>>        Set Field_Options          Field Barticl.Carticl_Rec0     To DD_DISPLAYONLY
46901>>>>>>>
46901>>>>>>>        // Barticl.Varticl_Rec0
46901>>>>>>>        Set Field_Options          Field Barticl.Varticl_Rec0     To DD_DISPLAYONLY
46902>>>>>>>
46902>>>>>>>        // Barticl.Gmove_Mrec0
46902>>>>>>>        Set Field_Options          Field Barticl.Gmove_Mrec0      To DD_DISPLAYONLY
46903>>>>>>>
46903>>>>>>>        // Barticl.Gplan_Mrec0
46903>>>>>>>        Set Field_Options          Field Barticl.Gplan_Mrec0      To DD_DISPLAYONLY
46904>>>>>>>
46904>>>>>>>    End_Procedure    // Define_Fields
46905>>>>>>>
46905>>>>>>>
46905>>>>>>>    Procedure Field_Defaults
46906>>>>>>>        Forward Send Field_Defaults
46908>>>>>>>        //DDB-Generated-Code-Location
46908>>>>>>>        //DDB-FieldDefaultStart
46908>>>>>>>        Set Field_Changed_Value   Field Barticl.Ekkremes To 1
46909>>>>>>>        //DDB-FieldDefaultEnd
46909>>>>>>>    End_Procedure    // Field_Defaults
46910>>>>>>>
46910>>>>>>>End_Class    // Barticl_DataDictionary
46911>>>>>>>//DDB-Selection-pkg-Start
46911>>>>>>>
46911>>>>>>>Use Barticl.SL       // Barticl
INCLUDING FILE: BARTICL.SL
46911>>>>>>>>>//AB/ Project Barticl:Lookup
46911>>>>>>>>>//AB/ Object prj is a Lookup_Project
46911>>>>>>>>>//AB/     Set ProjectName to "Barticl:Lookup"
46911>>>>>>>>>//AB/     Set ProjectFileName to "Barticl.SL"
46911>>>>>>>>>
46911>>>>>>>>>// Project Object Structure
46911>>>>>>>>>//   Barticl is a dbModalPanelSub
46911>>>>>>>>>//     Btypkin_DD2 is a Btypkin_DataDictionary
46911>>>>>>>>>//     Btypkin_DD is a DataDictionary
46911>>>>>>>>>//     Barticl_DD is a DataDictionary
46911>>>>>>>>>//     Country_DD is a DataDictionary
46911>>>>>>>>>//     Towns_DD is a DataDictionary
46911>>>>>>>>>//     Cities_DD is a DataDictionary
46911>>>>>>>>>//     Areas_DD is a DataDictionary
46911>>>>>>>>>//     Payresp_DD is a DataDictionary
46911>>>>>>>>>//     Clients_DD is a DataDictionary
46911>>>>>>>>>//     oSelList is a dbListSub
46911>>>>>>>>>//     Btypkin_Btypkin_Code is a dbFormSub
46911>>>>>>>>>//     Btypkin_Btypkin_Descr is a dbFormSub
46911>>>>>>>>>//     Clients_Client_Name is a dbFormSub
46911>>>>>>>>>//     cSyDateForm1 is a cSyDateForm
46911>>>>>>>>>//     chkOpen is a CheckBoxSub
46911>>>>>>>>>//     ButtonSub1 is a ButtonSub
46911>>>>>>>>>//     oOK_bn is a ButtonSub
46911>>>>>>>>>//     oCancel_bn is a ButtonSub
46911>>>>>>>>>
46911>>>>>>>>>// Register all objects
46911>>>>>>>>>Register_Object Areas_DD
46911>>>>>>>>>Register_Object Barticl
46911>>>>>>>>>Register_Object Barticl_DD
46911>>>>>>>>>Register_Object Btypkin_Btypkin_Code
46911>>>>>>>>>Register_Object Btypkin_Btypkin_Descr
46911>>>>>>>>>Register_Object Btypkin_DD
46911>>>>>>>>>Register_Object Btypkin_DD2
46911>>>>>>>>>Register_Object ButtonSub1
46911>>>>>>>>>Register_Object Cities_DD
46911>>>>>>>>>Register_Object Clients_Client_Name
46911>>>>>>>>>Register_Object Clients_DD
46911>>>>>>>>>Register_Object Country_DD
46911>>>>>>>>>Register_Object chkOpen
46911>>>>>>>>>Register_Object cSyDateForm1
46911>>>>>>>>>Register_Object oCancel_bn
46911>>>>>>>>>Register_Object oOK_bn
46911>>>>>>>>>Register_Object oSelList
46911>>>>>>>>>Register_Object Payresp_DD
46911>>>>>>>>>Register_Object Towns_DD
46911>>>>>>>>>
46911>>>>>>>>>
46911>>>>>>>>>//AB-IgnoreStart
46911>>>>>>>>>
46911>>>>>>>>>Use DFAllEnt.pkg
46911>>>>>>>>>Use dbList.Sub
46911>>>>>>>>>Use dbForm.Sub
46911>>>>>>>>>Use cSyDateForm.Pkg
46911>>>>>>>>>Use Chkbox.Sub
46911>>>>>>>>>Use Button.Sub
46911>>>>>>>>>
46911>>>>>>>>>
46911>>>>>>>>>Use BTYPKIN.DD
46911>>>>>>>>>Use BARTICL.DD
46911>>>>>>>>>Use COUNTRY.DD
INCLUDING FILE: COUNTRY.DD
46911>>>>>>>>>>>//DDB-FileStart
46911>>>>>>>>>>>//DDB-HeaderStart
46911>>>>>>>>>>>
46911>>>>>>>>>>>// File Name : COUNTRY.DD
46911>>>>>>>>>>>// Class Name: Country_DataDictionary
46911>>>>>>>>>>>// Revision  : 3
46911>>>>>>>>>>>// Version   : 2
46911>>>>>>>>>>>
46911>>>>>>>>>>>Use  Windows           // Basic Definitions
46911>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
46911>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46911>>>>>>>>>>>
46911>>>>>>>>>>>Open Country
46913>>>>>>>>>>>Open Towns
46915>>>>>>>>>>>
46915>>>>>>>>>>>//DDB-HeaderEnd
46915>>>>>>>>>>>//DDB-SelectionStart
46915>>>>>>>>>>>//DDB/ ExternalSelectionList sl058  sl058.SL
46915>>>>>>>>>>>Register_Object sl058
46915>>>>>>>>>>>//DDB-SelectionEnd
46915>>>>>>>>>>>
46915>>>>>>>>>>>Class Country_DataDictionary  is a DataDictionary_Sec
46916>>>>>>>>>>>
46916>>>>>>>>>>>    // Define_Fields:
46916>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
46916>>>>>>>>>>>
46916>>>>>>>>>>>    Procedure Define_Fields
46917>>>>>>>>>>>        Forward Send Define_Fields
46919>>>>>>>>>>>        //DDB-Generated-Code-Location
46919>>>>>>>>>>>        //DDB-DefineFieldStart
46919>>>>>>>>>>>
46919>>>>>>>>>>>        Set Main_File            To Country.File_Number
46920>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
46921>>>>>>>>>>>
46921>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
46922>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
46923>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
46924>>>>>>>>>>>
46924>>>>>>>>>>>        // Child (Client) file structure................
46924>>>>>>>>>>>        Send Add_Client_File  Towns.File_Number
46925>>>>>>>>>>>
46925>>>>>>>>>>>        // Field-based properties.......................
46925>>>>>>>>>>>
46925>>>>>>>>>>>        // Country.Country_Id
46925>>>>>>>>>>>        Set Field_Options          Field Country.Country_Id To DD_AUTOFIND   
46926>>>>>>>>>>>        Set Field_Prompt_Object    Field Country.Country_Id To (sl058(Self))
46927>>>>>>>>>>>
46927>>>>>>>>>>>        // Country.Country_Descr
46927>>>>>>>>>>>        Set Field_Prompt_Object    Field Country.Country_Descr To (sl058(Self))
46928>>>>>>>>>>>
46928>>>>>>>>>>>        //DDB-DefineFieldEnd
46928>>>>>>>>>>>    End_Procedure    // Define_Fields
46929>>>>>>>>>>>
46929>>>>>>>>>>>    // Field_Defaults:
46929>>>>>>>>>>>    // This procedure is used to establish default field values.
46929>>>>>>>>>>>
46929>>>>>>>>>>>    Procedure Field_Defaults
46930>>>>>>>>>>>        Forward Send Field_Defaults
46932>>>>>>>>>>>        //DDB-Generated-Code-Location
46932>>>>>>>>>>>        //DDB-FieldDefaultStart
46932>>>>>>>>>>>        //DDB-FieldDefaultEnd
46932>>>>>>>>>>>    End_Procedure    // Field_Defaults
46933>>>>>>>>>>>
46933>>>>>>>>>>>End_Class    // Country_DataDictionary
46934>>>>>>>>>>>//DDB-Selection-pkg-Start
46934>>>>>>>>>>>
46934>>>>>>>>>>>Use sl058.SL         // sl058
INCLUDING FILE: SL058.SL
46934>>>>>>>>>>>>>//AB/ Project sl058 : Countries - Xores
46934>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
46934>>>>>>>>>>>>>//AB/         Set ProjectName to "sl058 : Countries - Xores"
46934>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl058.SL"
46934>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
46934>>>>>>>>>>>>>
46934>>>>>>>>>>>>>// Project Object Structure
46934>>>>>>>>>>>>>//   sl058 is a dbModalPanelSub
46934>>>>>>>>>>>>>//     Country_DD is a DataDictionary
46934>>>>>>>>>>>>>//     oSelList is a dbListSub
46934>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
46934>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
46934>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
46934>>>>>>>>>>>>>
46934>>>>>>>>>>>>>// Register all objects
46934>>>>>>>>>>>>>Register_Object Country_DD
46934>>>>>>>>>>>>>Register_Object oCancel_bn
46934>>>>>>>>>>>>>Register_Object oOK_bn
46934>>>>>>>>>>>>>Register_Object oSearch_bn
46934>>>>>>>>>>>>>Register_Object oSelList
46934>>>>>>>>>>>>>Register_Object sl058
46934>>>>>>>>>>>>>
46934>>>>>>>>>>>>>
46934>>>>>>>>>>>>>    //AB-IgnoreStart
46934>>>>>>>>>>>>>
46934>>>>>>>>>>>>>    Use DFAllEnt.pkg
46934>>>>>>>>>>>>>    Use dbList.Sub
46934>>>>>>>>>>>>>    Use Button.Sub
46934>>>>>>>>>>>>>
46934>>>>>>>>>>>>>
46934>>>>>>>>>>>>>    Use Country.DD
46934>>>>>>>>>>>>>    
46934>>>>>>>>>>>>>    //AB-IgnoreEnd
46934>>>>>>>>>>>>>
46934>>>>>>>>>>>>>    Object sl058 is a dbModalPanelSub
46936>>>>>>>>>>>>>        Set Label to "•é¨œª"
46937>>>>>>>>>>>>>        Set Size to 148 297
46938>>>>>>>>>>>>>        Set Location to 6 10
46939>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
46940>>>>>>>>>>>>>        Set Modal_State to FALSE
46941>>>>>>>>>>>>>
46941>>>>>>>>>>>>>        //AB-DDOStart
46941>>>>>>>>>>>>>
46941>>>>>>>>>>>>>        Object Country_DD is a Country_DataDictionary
46943>>>>>>>>>>>>>        End_Object    // Country_DD
46944>>>>>>>>>>>>>
46944>>>>>>>>>>>>>        Set Main_DD to (Country_DD(self))
46945>>>>>>>>>>>>>        Set Server to (Country_DD(self))
46946>>>>>>>>>>>>>
46946>>>>>>>>>>>>>        //AB-DDOEnd
46946>>>>>>>>>>>>>
46946>>>>>>>>>>>>>        Object oSelList is a dbListSub
46948>>>>>>>>>>>>>            Set Main_File to Country.File_Number
46949>>>>>>>>>>>>>            Set Size to 105 280
46950>>>>>>>>>>>>>            Set Location to 6 6
46951>>>>>>>>>>>>>
46951>>>>>>>>>>>>>            Begin_Row
46954>>>>>>>>>>>>>                Entry_Item Country.Country_id
46955>>>>>>>>>>>>>                Entry_Item Country.Country_descr
46956>>>>>>>>>>>>>            End_Row
46961>>>>>>>>>>>>>
46961>>>>>>>>>>>>>            Set Form_Width    item 0 to 87
46962>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à›"
46963>>>>>>>>>>>>>            
46963>>>>>>>>>>>>>            Set Form_Width    item 1 to 183
46964>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
46965>>>>>>>>>>>>>            
46965>>>>>>>>>>>>>        End_Object    // oSelList
46966>>>>>>>>>>>>>
46966>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
46968>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
46969>>>>>>>>>>>>>            Set Location to 115 126
46970>>>>>>>>>>>>>
46970>>>>>>>>>>>>>            //AB-StoreStart
46970>>>>>>>>>>>>>            Procedure OnClick
46972>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
46973>>>>>>>>>>>>>            End_Procedure
46974>>>>>>>>>>>>>            //AB-StoreEnd
46974>>>>>>>>>>>>>
46974>>>>>>>>>>>>>        End_Object    // oOK_bn
46975>>>>>>>>>>>>>
46975>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
46977>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
46978>>>>>>>>>>>>>            Set Location to 115 181
46979>>>>>>>>>>>>>
46979>>>>>>>>>>>>>            //AB-StoreStart
46979>>>>>>>>>>>>>            Procedure OnClick
46981>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
46982>>>>>>>>>>>>>            End_Procedure
46983>>>>>>>>>>>>>            //AB-StoreEnd
46983>>>>>>>>>>>>>
46983>>>>>>>>>>>>>        End_Object    // oCancel_bn
46984>>>>>>>>>>>>>
46984>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
46986>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
46987>>>>>>>>>>>>>            Set Location to 115 236
46988>>>>>>>>>>>>>
46988>>>>>>>>>>>>>            //AB-StoreStart
46988>>>>>>>>>>>>>            Procedure OnClick
46990>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
46991>>>>>>>>>>>>>            End_Procedure
46992>>>>>>>>>>>>>            //AB-StoreEnd
46992>>>>>>>>>>>>>
46992>>>>>>>>>>>>>        End_Object    // oSearch_bn
46993>>>>>>>>>>>>>
46993>>>>>>>>>>>>>
46993>>>>>>>>>>>>>        //AB-StoreStart
46993>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
46994>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
46995>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
46996>>>>>>>>>>>>>        //AB-StoreEnd
46996>>>>>>>>>>>>>
46996>>>>>>>>>>>>>    End_Object    // sl058
46997>>>>>>>>>>>>>
46997>>>>>>>>>>>>>//AB/     End_Object    // prj
46997>>>>>>>>>>>
46997>>>>>>>>>>>//DDB-Selection-pkg-End
46997>>>>>>>>>>>//DDB-FileEnd
46997>>>>>>>>>Use TOWNS.DD
INCLUDING FILE: TOWNS.DD
46997>>>>>>>>>>>//DDB-FileStart
46997>>>>>>>>>>>//DDB-HeaderStart
46997>>>>>>>>>>>
46997>>>>>>>>>>>// File Name : TOWNS.DD
46997>>>>>>>>>>>// Class Name: Towns_DataDictionary
46997>>>>>>>>>>>// Revision  : 8
46997>>>>>>>>>>>// Version   : 2
46997>>>>>>>>>>>
46997>>>>>>>>>>>Use  Windows           // Basic Definitions
46997>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
46997>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46997>>>>>>>>>>>
46997>>>>>>>>>>>Open Towns
46999>>>>>>>>>>>Open Cities
47001>>>>>>>>>>>Open Country
47003>>>>>>>>>>>
47003>>>>>>>>>>>//DDB-HeaderEnd
47003>>>>>>>>>>>//DDB-SelectionStart
47003>>>>>>>>>>>//DDB/ ExternalSelectionList sl057  sl057.SL
47003>>>>>>>>>>>Register_Object sl057
47003>>>>>>>>>>>//DDB-SelectionEnd
47003>>>>>>>>>>>
47003>>>>>>>>>>>Class Towns_DataDictionary  is a DataDictionary_Sec
47004>>>>>>>>>>>
47004>>>>>>>>>>>    Procedure Save_Main_File
47005>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
47007>>>>>>>>>>>            If Towns.Recnum Eq 0 Procedure_Return
47010>>>>>>>>>>>        End
47010>>>>>>>>>>>>
47010>>>>>>>>>>>        Forward Send Save_Main_File
47012>>>>>>>>>>>    End_Procedure
47013>>>>>>>>>>>
47013>>>>>>>>>>>
47013>>>>>>>>>>>    // Define_Fields:
47013>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
47013>>>>>>>>>>>
47013>>>>>>>>>>>    Procedure Define_Fields
47014>>>>>>>>>>>        Forward Send Define_Fields
47016>>>>>>>>>>>        //DDB-Generated-Code-Location
47016>>>>>>>>>>>        //DDB-DefineFieldStart
47016>>>>>>>>>>>
47016>>>>>>>>>>>        Set Main_File            To Towns.File_Number
47017>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
47018>>>>>>>>>>>
47018>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   to DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
47019>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD to DD_NOPUT       DD_FINDREQ    
47020>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    to DD_DISPLAYONLY
47021>>>>>>>>>>>
47021>>>>>>>>>>>        // Child (Client) file structure................
47021>>>>>>>>>>>        Send Add_Client_File  Cities.File_Number
47022>>>>>>>>>>>
47022>>>>>>>>>>>        // Parent (Server) file structure...............
47022>>>>>>>>>>>        Send Add_Server_File  Country.File_Number
47023>>>>>>>>>>>
47023>>>>>>>>>>>        // Field-based properties.......................
47023>>>>>>>>>>>
47023>>>>>>>>>>>        // Towns.Country_Id
47023>>>>>>>>>>>        Set Key_Field_State        Field Towns.Country_Id To TRUE
47024>>>>>>>>>>>
47024>>>>>>>>>>>        // Towns.Town_Id
47024>>>>>>>>>>>        Set Field_Options          Field Towns.Town_Id To DD_AUTOFIND   
47025>>>>>>>>>>>        Set Field_Prompt_Object    Field Towns.Town_Id To (sl057(Self))
47026>>>>>>>>>>>
47026>>>>>>>>>>>        // Towns.Town_Descr
47026>>>>>>>>>>>        Set Field_Prompt_Object    Field Towns.Town_Descr To (sl057(Self))
47027>>>>>>>>>>>
47027>>>>>>>>>>>        //DDB-DefineFieldEnd
47027>>>>>>>>>>>    End_Procedure    // Define_Fields
47028>>>>>>>>>>>
47028>>>>>>>>>>>    // Field_Defaults:
47028>>>>>>>>>>>    // This procedure is used to establish default field values.
47028>>>>>>>>>>>
47028>>>>>>>>>>>    Procedure Field_Defaults
47029>>>>>>>>>>>        Forward Send Field_Defaults
47031>>>>>>>>>>>        //DDB-Generated-Code-Location
47031>>>>>>>>>>>        //DDB-FieldDefaultStart
47031>>>>>>>>>>>        //DDB-FieldDefaultEnd
47031>>>>>>>>>>>    End_Procedure    // Field_Defaults
47032>>>>>>>>>>>
47032>>>>>>>>>>>End_Class    // Towns_DataDictionary
47033>>>>>>>>>>>//DDB-Selection-pkg-Start
47033>>>>>>>>>>>
47033>>>>>>>>>>>Use sl057.SL         // sl057
INCLUDING FILE: SL057.SL
47033>>>>>>>>>>>>>//AB/ Project sl057 : Towns -Nomoi - Eyr Perioxes
47033>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
47033>>>>>>>>>>>>>//AB/         Set ProjectName to "sl057 : Towns -Nomoi - Eyr Perioxes"
47033>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl057.SL"
47033>>>>>>>>>>>>>
47033>>>>>>>>>>>>>// Project Object Structure
47033>>>>>>>>>>>>>//   sl057 is a dbModalPanelSub
47033>>>>>>>>>>>>>//     Country_DD is a DataDictionary
47033>>>>>>>>>>>>>//     Towns_DD is a DataDictionary
47033>>>>>>>>>>>>>//     oSelList is a dbListSub
47033>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
47033>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
47033>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
47033>>>>>>>>>>>>>
47033>>>>>>>>>>>>>// Register all objects
47033>>>>>>>>>>>>>Register_Object Country_DD
47033>>>>>>>>>>>>>Register_Object oCancel_bn
47033>>>>>>>>>>>>>Register_Object oOK_bn
47033>>>>>>>>>>>>>Register_Object oSearch_bn
47033>>>>>>>>>>>>>Register_Object oSelList
47033>>>>>>>>>>>>>Register_Object sl057
47033>>>>>>>>>>>>>Register_Object Towns_DD
47033>>>>>>>>>>>>>
47033>>>>>>>>>>>>>
47033>>>>>>>>>>>>>    //AB-IgnoreStart
47033>>>>>>>>>>>>>
47033>>>>>>>>>>>>>    Use DFAllEnt.pkg
47033>>>>>>>>>>>>>    Use dbList.Sub
47033>>>>>>>>>>>>>    Use Button.Sub
47033>>>>>>>>>>>>>
47033>>>>>>>>>>>>>
47033>>>>>>>>>>>>>    Use COUNTRY.DD
47033>>>>>>>>>>>>>    Use TOWNS.DD
47033>>>>>>>>>>>>>    
47033>>>>>>>>>>>>>    //AB-IgnoreEnd
47033>>>>>>>>>>>>>
47033>>>>>>>>>>>>>    Object sl057 is a dbModalPanelSub
47035>>>>>>>>>>>>>        Set Label to "Œ¦£¦å - „¬¨ç«œ¨œª §œ¨ ¦®âª"
47036>>>>>>>>>>>>>        Set Size to 148 297
47037>>>>>>>>>>>>>        Set Location to 6 10
47038>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
47039>>>>>>>>>>>>>        Set Modal_State to FALSE
47040>>>>>>>>>>>>>
47040>>>>>>>>>>>>>        //AB-DDOStart
47040>>>>>>>>>>>>>
47040>>>>>>>>>>>>>        Object Country_DD is a Country_DataDictionary
47042>>>>>>>>>>>>>        End_Object    // Country_DD
47043>>>>>>>>>>>>>
47043>>>>>>>>>>>>>        Object Towns_DD is a Towns_DataDictionary
47045>>>>>>>>>>>>>            Set DDO_Server to (Country_DD(self))
47046>>>>>>>>>>>>>        End_Object    // Towns_DD
47047>>>>>>>>>>>>>
47047>>>>>>>>>>>>>        Set Main_DD to (Towns_DD(self))
47048>>>>>>>>>>>>>        Set Server to (Towns_DD(self))
47049>>>>>>>>>>>>>
47049>>>>>>>>>>>>>        //AB-DDOEnd
47049>>>>>>>>>>>>>
47049>>>>>>>>>>>>>        Object oSelList is a dbListSub
47051>>>>>>>>>>>>>            Set Main_File to Towns.File_Number
47052>>>>>>>>>>>>>            Set Size to 105 280
47053>>>>>>>>>>>>>            Set Location to 6 6
47054>>>>>>>>>>>>>
47054>>>>>>>>>>>>>            Begin_Row
47057>>>>>>>>>>>>>                Entry_Item Towns.Town_id
47058>>>>>>>>>>>>>                Entry_Item Towns.Town_descr
47059>>>>>>>>>>>>>                Entry_Item Country.Country_descr
47060>>>>>>>>>>>>>            End_Row
47065>>>>>>>>>>>>>
47065>>>>>>>>>>>>>            Set Form_Width    item 0 to 43
47066>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à›"
47067>>>>>>>>>>>>>            
47067>>>>>>>>>>>>>            Set Form_Width    item 1 to 137
47068>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
47069>>>>>>>>>>>>>            
47069>>>>>>>>>>>>>            Set Form_Width    item 2 to 94
47070>>>>>>>>>>>>>            Set Header_Label  item 2 to "•é¨˜"
47071>>>>>>>>>>>>>            
47071>>>>>>>>>>>>>        End_Object    // oSelList
47072>>>>>>>>>>>>>
47072>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
47074>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
47075>>>>>>>>>>>>>            Set Location to 115 126
47076>>>>>>>>>>>>>
47076>>>>>>>>>>>>>            //AB-StoreStart
47076>>>>>>>>>>>>>            Procedure OnClick
47078>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
47079>>>>>>>>>>>>>            End_Procedure
47080>>>>>>>>>>>>>            //AB-StoreEnd
47080>>>>>>>>>>>>>
47080>>>>>>>>>>>>>        End_Object    // oOK_bn
47081>>>>>>>>>>>>>
47081>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
47083>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
47084>>>>>>>>>>>>>            Set Location to 115 181
47085>>>>>>>>>>>>>
47085>>>>>>>>>>>>>            //AB-StoreStart
47085>>>>>>>>>>>>>            Procedure OnClick
47087>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
47088>>>>>>>>>>>>>            End_Procedure
47089>>>>>>>>>>>>>            //AB-StoreEnd
47089>>>>>>>>>>>>>
47089>>>>>>>>>>>>>        End_Object    // oCancel_bn
47090>>>>>>>>>>>>>
47090>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
47092>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
47093>>>>>>>>>>>>>            Set Location to 115 236
47094>>>>>>>>>>>>>
47094>>>>>>>>>>>>>            //AB-StoreStart
47094>>>>>>>>>>>>>            Procedure OnClick
47096>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
47097>>>>>>>>>>>>>            End_Procedure
47098>>>>>>>>>>>>>            //AB-StoreEnd
47098>>>>>>>>>>>>>
47098>>>>>>>>>>>>>        End_Object    // oSearch_bn
47099>>>>>>>>>>>>>
47099>>>>>>>>>>>>>
47099>>>>>>>>>>>>>        //AB-StoreStart
47099>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
47100>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
47101>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
47102>>>>>>>>>>>>>        //AB-StoreEnd
47102>>>>>>>>>>>>>
47102>>>>>>>>>>>>>    End_Object    // sl057
47103>>>>>>>>>>>>>
47103>>>>>>>>>>>>>//AB/     End_Object    // prj
47103>>>>>>>>>>>
47103>>>>>>>>>>>//DDB-Selection-pkg-End
47103>>>>>>>>>>>//DDB-FileEnd
47103>>>>>>>>>Use CITIES.DD
47103>>>>>>>>>Use AREAS.DD
47103>>>>>>>>>Use PAYRESP.DD
47103>>>>>>>>>Use CLIENTS.DD
47103>>>>>>>>>
47103>>>>>>>>>//AB-IgnoreEnd
47103>>>>>>>>>
47103>>>>>>>>>Object Barticl is a dbModalPanelSub
47105>>>>>>>>>
47105>>>>>>>>>    //AB-StoreTopStart
47105>>>>>>>>>                    
47105>>>>>>>>>    Property Integer    piWhat              Public  0
47107>>>>>>>>>    Property Integer    FragmaTypkinCode    Public  0
47109>>>>>>>>>    Property Integer    piIsOpen            Public  0
47111>>>>>>>>>    Property String     FragmaClientID      Public ''
47113>>>>>>>>>    Property String     FragmaClientEpon    Public ''
47115>>>>>>>>>    Property Date       FragmaHmnia         Public ''
47117>>>>>>>>>    
47117>>>>>>>>>    Object Btypkin_DD2 is a Btypkin_DataDictionary
47119>>>>>>>>>    End_Object
47120>>>>>>>>>    
47120>>>>>>>>>    
47120>>>>>>>>>    //AB-StoreTopEnd
47120>>>>>>>>>
47120>>>>>>>>>    Set Label to "‰ ¤ã©œ ª €¥ ¦š¨á­à¤"
47121>>>>>>>>>    Set Size to 289 519
47122>>>>>>>>>    Set Location to 2 5
47123>>>>>>>>>    Set Exit_Application_Local_State to FALSE
47124>>>>>>>>>    Set Modal_State to FALSE
47125>>>>>>>>>
47125>>>>>>>>>    //AB-DDOStart
47125>>>>>>>>>
47125>>>>>>>>>    Object Btypkin_DD is a Btypkin_DataDictionary
47127>>>>>>>>>    End_Object    // Btypkin_DD
47128>>>>>>>>>
47128>>>>>>>>>    Object Barticl_DD is a Barticl_DataDictionary
47130>>>>>>>>>        Set DDO_Server to (Btypkin_DD(self))
47131>>>>>>>>>
47131>>>>>>>>>        //AB-StoreStart
47131>>>>>>>>>                                                
47131>>>>>>>>>        Begin_Constraints
47133>>>>>>>>>            Integer iTypkinCode iWhat isOpen
47134>>>>>>>>>            String  sClientID sClientEpon
47134>>>>>>>>>            Date    dHmnia
47134>>>>>>>>>        
47134>>>>>>>>>            Get FragmaTypkinCode    to iTypkinCode
47135>>>>>>>>>            Get FragmaClientID      to sClientID
47136>>>>>>>>>            Get FragmaClientEpon    to sClientEpon
47137>>>>>>>>>            Get FragmaHmnia         to dHmnia
47138>>>>>>>>>            Get piIsOpen            to isOpen
47139>>>>>>>>>        
47139>>>>>>>>>            If (iTypkinCode<>'') Begin
47141>>>>>>>>>                If (sClientID<>'') Begin
47143>>>>>>>>>                    Set Ordering Of Barticl_DD to 8
47144>>>>>>>>>                    // Comp+Br+Year+Btypkin_Code+Epon1+Hmnia+Recnum
47144>>>>>>>>>                    Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
47146>>>>>>>>>                    Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
47148>>>>>>>>>                    Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
47150>>>>>>>>>                    Constrain Barticl.Btypkin_Code  Eq iTypkinCode
47152>>>>>>>>>                    Constrain Barticl.Barticl_Epon1 Eq sClientEpon
47154>>>>>>>>>                    If (dHmnia<>'') Constrain Barticl.Barticl_Hmnia Eq dHmnia
47158>>>>>>>>>                End
47158>>>>>>>>>>
47158>>>>>>>>>                Else Begin
47159>>>>>>>>>                    Set Ordering Of Barticl_DD to 11
47160>>>>>>>>>                    // Comp+Br+Year+Btypkin_Code+Hmnia+Epon1+Recnum
47160>>>>>>>>>                    Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
47162>>>>>>>>>                    Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
47164>>>>>>>>>                    Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
47166>>>>>>>>>                    Constrain Barticl.Btypkin_Code  Eq iTypkinCode
47168>>>>>>>>>                    If (dHmnia<>'') Constrain Barticl.Barticl_Hmnia Eq dHmnia
47172>>>>>>>>>                End
47172>>>>>>>>>>
47172>>>>>>>>>            End
47172>>>>>>>>>>
47172>>>>>>>>>            Else If (dHmnia<>'') Begin
47175>>>>>>>>>                Set Ordering Of Barticl_DD to 9
47176>>>>>>>>>                // Comp+Br+Year+Hmnia+Epon1+Recnum
47176>>>>>>>>>                Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
47178>>>>>>>>>                Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
47180>>>>>>>>>                Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
47182>>>>>>>>>                Constrain Barticl.Barticl_Hmnia Eq dHmnia
47184>>>>>>>>>                If (sClientID<>'') Constrain Barticl.Barticl_Epon1 Eq sClientEpon
47188>>>>>>>>>            End
47188>>>>>>>>>>
47188>>>>>>>>>            Else If (sClientID<>'') Begin
47191>>>>>>>>>                Set Ordering Of Barticl_DD to 8
47192>>>>>>>>>                // Comp+Br+Year+Epon1+Hmnia+Recnum
47192>>>>>>>>>                Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
47194>>>>>>>>>                Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
47196>>>>>>>>>                Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
47198>>>>>>>>>                Constrain Barticl.Barticl_Epon1 Eq sClientEpon
47200>>>>>>>>>            End
47200>>>>>>>>>>
47200>>>>>>>>>            Else Begin
47201>>>>>>>>>                Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
47203>>>>>>>>>                Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
47205>>>>>>>>>                Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
47207>>>>>>>>>            End
47207>>>>>>>>>>
47207>>>>>>>>>            If (isOpen) Constrain Barticl.Barticl_Ekleise NE '1'
47211>>>>>>>>>        End_Constraints
47214>>>>>>>>>        
47214>>>>>>>>>        
47214>>>>>>>>>        
47214>>>>>>>>>        
47214>>>>>>>>>        
47214>>>>>>>>>        
47214>>>>>>>>>        
47214>>>>>>>>>        
47214>>>>>>>>>        
47214>>>>>>>>>        
47214>>>>>>>>>        
47214>>>>>>>>>        
47214>>>>>>>>>        
47214>>>>>>>>>        
47214>>>>>>>>>        //AB-StoreEnd
47214>>>>>>>>>
47214>>>>>>>>>    End_Object    // Barticl_DD
47215>>>>>>>>>
47215>>>>>>>>>    Object Country_DD is a Country_DataDictionary
47217>>>>>>>>>    End_Object    // Country_DD
47218>>>>>>>>>
47218>>>>>>>>>    Object Towns_DD is a Towns_DataDictionary
47220>>>>>>>>>        Set DDO_Server to (Country_DD(self))
47221>>>>>>>>>    End_Object    // Towns_DD
47222>>>>>>>>>
47222>>>>>>>>>    Object Cities_DD is a Cities_DataDictionary
47224>>>>>>>>>        Set DDO_Server to (Towns_DD(self))
47225>>>>>>>>>    End_Object    // Cities_DD
47226>>>>>>>>>
47226>>>>>>>>>    Object Areas_DD is a Areas_DataDictionary
47228>>>>>>>>>    End_Object    // Areas_DD
47229>>>>>>>>>
47229>>>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
47231>>>>>>>>>    End_Object    // Payresp_DD
47232>>>>>>>>>
47232>>>>>>>>>    Object Clients_DD is a Clients_DataDictionary
47234>>>>>>>>>        Set DDO_Server to (Cities_DD(self))
47235>>>>>>>>>        Set DDO_Server to (Areas_DD(self))
47236>>>>>>>>>        Set DDO_Server to (Payresp_DD(self))
47237>>>>>>>>>    End_Object    // Clients_DD
47238>>>>>>>>>
47238>>>>>>>>>    Set Main_DD to (Barticl_DD(self))
47239>>>>>>>>>    Set Server to (Barticl_DD(self))
47240>>>>>>>>>
47240>>>>>>>>>    //AB-DDOEnd
47240>>>>>>>>>
47240>>>>>>>>>    Object oSelList is a dbListSub
47242>>>>>>>>>        Set Main_File to Barticl.File_Number
47243>>>>>>>>>        Set Size to 219 505
47244>>>>>>>>>        Set Location to 6 6
47245>>>>>>>>>
47245>>>>>>>>>        Begin_Row
47248>>>>>>>>>            Entry_Item Barticl.Barticl_no
47249>>>>>>>>>            Entry_Item Barticl.Arith_orist
47250>>>>>>>>>            Entry_Item Barticl.Barticl_hmnia
47251>>>>>>>>>            Entry_Item Btypkin.Btypkin_code
47252>>>>>>>>>            Entry_Item Btypkin.Btypkin_descr
47253>>>>>>>>>            Entry_Item Barticl.Barticl_code1
47254>>>>>>>>>            Entry_Item Barticl.Barticl_epon1
47255>>>>>>>>>            Entry_Item Barticl.Barticl_sv0
47256>>>>>>>>>            Entry_Item Barticl.Barticl_ekleise
47257>>>>>>>>>            Entry_Item Barticl.Isotimia
47258>>>>>>>>>        End_Row
47263>>>>>>>>>
47263>>>>>>>>>        Set Form_Width    item 0 to 47
47264>>>>>>>>>        Set Header_Label  item 0 to "€¨ Ÿ£æª"
47265>>>>>>>>>        
47265>>>>>>>>>        Set Form_Width    item 1 to 47
47266>>>>>>>>>        Set Header_Label  item 1 to "Ž¨ ©«.˜¨ Ÿ."
47267>>>>>>>>>        
47267>>>>>>>>>        Set Form_Width    item 2 to 48
47268>>>>>>>>>        Set Header_Label  item 2 to "†£œ¨/¤å˜"
47269>>>>>>>>>        
47269>>>>>>>>>        Set Form_Width    item 3 to 39
47270>>>>>>>>>        Set Header_Label  item 3 to "‰å¤ž©ž"
47271>>>>>>>>>        
47271>>>>>>>>>        Set Form_Width    item 4 to 80
47272>>>>>>>>>        Set Header_Label  item 4 to "œ¨ š¨˜­ã"
47273>>>>>>>>>        
47273>>>>>>>>>        Set Form_Width    item 5 to 55
47274>>>>>>>>>        Set Header_Label  item 5 to "‘¬¤˜¢/¤¦ª"
47275>>>>>>>>>        
47275>>>>>>>>>        Set Form_Width    item 6 to 96
47276>>>>>>>>>        Set Header_Label  item 6 to "„§à¤¬£å˜"
47277>>>>>>>>>        
47277>>>>>>>>>        Set Form_Width    item 7 to 50
47278>>>>>>>>>        Set Header_Label  item 7 to "¦©æ"
47279>>>>>>>>>        
47279>>>>>>>>>        Set Form_Width    item 8 to 16
47280>>>>>>>>>        Set Header_Label  item 8 to "‰"
47281>>>>>>>>>        Set Column_Checkbox_State  item 8 to True
47282>>>>>>>>>        
47282>>>>>>>>>        Set Form_Width    item 9 to 22
47283>>>>>>>>>        Set Header_Label  item 9 to "„¡«."
47284>>>>>>>>>        Set Column_Checkbox_State  item 9 to True
47285>>>>>>>>>        
47285>>>>>>>>>
47285>>>>>>>>>        //AB-StoreStart
47285>>>>>>>>>        
47285>>>>>>>>>        //Property Integer StoreFragmaTypkinCode  Public 0
47285>>>>>>>>>        //Property String  StoreFragmaClientID    Public ''
47285>>>>>>>>>        //Property String  StoreFragmaClientEpon  Public ''
47285>>>>>>>>>        //Property Date    StoreFragmaHmnia       Public ''
47285>>>>>>>>>        
47285>>>>>>>>>        Procedure End_Construct_Object
47287>>>>>>>>>            Integer iDecimals
47288>>>>>>>>>            Forward Send End_Construct_Object
47290>>>>>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0   to    iDecimals
47291>>>>>>>>>            Set Points Item 7 to iDecimals
47292>>>>>>>>>            Set Numeric_Mask Item 7 to 14 iDecimals ' ,*'
47293>>>>>>>>>        End_Procedure
47294>>>>>>>>>        
47294>>>>>>>>>        //Procedure Store_Defaults
47294>>>>>>>>>        //       Forward Send Store_Defaults
47294>>>>>>>>>        //       Set StoreFragmaTypkinCode    to (FragmaTypkinCode(Self))
47294>>>>>>>>>        //       Set StoreFragmaClientID      to (FragmaClientID  (Self))
47294>>>>>>>>>        //       Set StoreFragmaClientEpon    to (FragmaClientEpon(Self))
47294>>>>>>>>>        //       Set StoreFragmaHmnia         to (FragmaHmnia     (Self))
47294>>>>>>>>>        //End_Procedure
47294>>>>>>>>>        
47294>>>>>>>>>        //Procedure ReStore_Defaults
47294>>>>>>>>>        //       Forward Send ReStore_Defaults
47294>>>>>>>>>        //       Set FragmaTypkinCode to (StoreFragmaTypkinCode(Self))
47294>>>>>>>>>        //       Set FragmaClientID   to (StoreFragmaClientID  (Self))
47294>>>>>>>>>        //       Set FragmaClientEpon to (StoreFragmaClientEpon(Self))
47294>>>>>>>>>        //       Set FragmaHmnia      to (StoreFragmaHmnia     (Self))
47294>>>>>>>>>        //End_Procedure
47294>>>>>>>>>        
47294>>>>>>>>>        Procedure Activate
47296>>>>>>>>>            Send Keyaction to ButtonSub1
47297>>>>>>>>>            Forward Send Activate
47299>>>>>>>>>        End_procedure
47300>>>>>>>>>        
47300>>>>>>>>>        Procedure Activating
47302>>>>>>>>>            Forward Send Activating
47304>>>>>>>>>            Set Auto_Index_State to True
47305>>>>>>>>>        End_Procedure
47306>>>>>>>>>        
47306>>>>>>>>>        
47306>>>>>>>>>        //AB-StoreEnd
47306>>>>>>>>>
47306>>>>>>>>>    End_Object    // oSelList
47307>>>>>>>>>
47307>>>>>>>>>    Object Btypkin_Btypkin_Code is a dbFormSub
47309>>>>>>>>>        Entry_Item Btypkin.Btypkin_code
47310>>>>>>>>>        Set Label to "’ç§¦ª ‰å¤ž©žª"
47311>>>>>>>>>        Set Size to 13 49
47312>>>>>>>>>        Set Location to 229 84
47313>>>>>>>>>        Set Label_Col_Offset to 5
47314>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
47315>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
47316>>>>>>>>>
47316>>>>>>>>>        //AB-StoreStart
47316>>>>>>>>>                                                                                                                        
47316>>>>>>>>>        Set Server to (Btypkin_DD2(Self))
47317>>>>>>>>>        
47317>>>>>>>>>        Procedure Key Integer iKey
47319>>>>>>>>>            Integer iRetVal
47320>>>>>>>>>            Forward Send Key iKey
47322>>>>>>>>>            If (iKey=277) Send Clear to Btypkin_DD2
47325>>>>>>>>>        End_Procedure
47326>>>>>>>>>        
47326>>>>>>>>>        
47326>>>>>>>>>        //AB-StoreEnd
47326>>>>>>>>>
47326>>>>>>>>>    End_Object    // Btypkin_Btypkin_Code
47327>>>>>>>>>
47327>>>>>>>>>    Object Btypkin_Btypkin_Descr is a dbFormSub
47329>>>>>>>>>        Entry_Item Btypkin.Btypkin_descr
47330>>>>>>>>>        Set Size to 13 133
47331>>>>>>>>>        Set Location to 229 139
47332>>>>>>>>>        Set Color to clBtnFace
47333>>>>>>>>>        Set Label_Col_Offset to 2
47334>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
47335>>>>>>>>>        Set Enabled_State to FALSE
47336>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
47337>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
47338>>>>>>>>>        Set Shadow_State Item 0 to TRUE
47339>>>>>>>>>
47339>>>>>>>>>        //AB-StoreStart
47339>>>>>>>>>        Set Server to (Btypkin_DD2(Self))
47340>>>>>>>>>        
47340>>>>>>>>>        //AB-StoreEnd
47340>>>>>>>>>
47340>>>>>>>>>    End_Object    // Btypkin_Btypkin_Descr
47341>>>>>>>>>
47341>>>>>>>>>    Object Clients_Client_Name is a dbFormSub
47343>>>>>>>>>        Entry_Item Clients.Client_name
47344>>>>>>>>>        Set Server to (Clients_DD(self))
47345>>>>>>>>>        Set Label to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
47346>>>>>>>>>        Set Size to 13 188
47347>>>>>>>>>        Set Location to 244 84
47348>>>>>>>>>        Set Label_Col_Offset to 5
47349>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
47350>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
47351>>>>>>>>>
47351>>>>>>>>>        //AB-StoreStart
47351>>>>>>>>>                                                                                                                        
47351>>>>>>>>>        Procedure Key Integer iKey
47353>>>>>>>>>            Integer iRetVal
47354>>>>>>>>>            Forward Send Key iKey
47356>>>>>>>>>            If (iKey=277) Send Clear to Clients_DD
47359>>>>>>>>>        End_Procedure
47360>>>>>>>>>        
47360>>>>>>>>>        //AB-StoreEnd
47360>>>>>>>>>
47360>>>>>>>>>    End_Object    // Clients_Client_Name
47361>>>>>>>>>
47361>>>>>>>>>    Object cSyDateForm1 is a cSyDateForm
47363>>>>>>>>>        Set Label to "†£œ¨¦£ž¤å˜"
47364>>>>>>>>>        Set Size to 13 66
47365>>>>>>>>>        Set Location to 258 84
47366>>>>>>>>>        Set Label_Col_Offset to 5
47367>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
47368>>>>>>>>>        Set Form_Mask Item 0 to "dd/MM/yyyy"
47369>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
47370>>>>>>>>>
47370>>>>>>>>>        //AB-StoreStart
47370>>>>>>>>>                                                                                                                        
47370>>>>>>>>>        On_Key KClear Send ClearMe
47371>>>>>>>>>        
47371>>>>>>>>>        Procedure ClearMe
47373>>>>>>>>>            Set Value Item 0 to ''
47374>>>>>>>>>        End_Procedure
47375>>>>>>>>>        
47375>>>>>>>>>        //AB-StoreEnd
47375>>>>>>>>>
47375>>>>>>>>>    End_Object    // cSyDateForm1
47376>>>>>>>>>
47376>>>>>>>>>    Object chkOpen is a CheckBoxSub
47378>>>>>>>>>        Set Label to "‹æ¤¦ ˜¤¦ ®«á"
47379>>>>>>>>>        Set Size to 10 62
47380>>>>>>>>>        Set Location to 260 156
47381>>>>>>>>>    End_Object    // chkOpen
47382>>>>>>>>>
47382>>>>>>>>>    Object ButtonSub1 is a ButtonSub
47384>>>>>>>>>        Set Label to "œ¨ æ¨ ©œ"
47385>>>>>>>>>        Set Size to 13 52
47386>>>>>>>>>        Set Location to 258 219
47387>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
47388>>>>>>>>>
47388>>>>>>>>>        //AB-StoreStart
47388>>>>>>>>>                                                        
47388>>>>>>>>>        Procedure OnClick
47390>>>>>>>>>            String  sEpon sID
47391>>>>>>>>>            Integer iTypkin isOpen
47391>>>>>>>>>            Date    dHmnia
47391>>>>>>>>>        
47391>>>>>>>>>            Get Value Of cSyDateForm1 Item 0                                  to dHmnia
47392>>>>>>>>>            Get Field_Current_Value Of Clients_DD  Field Clients.Client_ID    to sID
47393>>>>>>>>>            Get Field_Current_Value Of Clients_DD  Field Clients.Client_Name  to sEpon
47394>>>>>>>>>            Get Field_Current_Value Of Btypkin_DD2 Field Btypkin.Btypkin_Code to iTypkin
47395>>>>>>>>>        
47395>>>>>>>>>            Get Checked_State Of chkOpen to isOpen
47396>>>>>>>>>        
47396>>>>>>>>>            Set FragmaTypkinCode    to iTypkin
47397>>>>>>>>>            Set FragmaClientID      to sID
47398>>>>>>>>>            Set FragmaClientEpon    to sEpon
47399>>>>>>>>>            Set FragmaHmnia         to dHmnia
47400>>>>>>>>>            Set piIsOpen            to isOpen
47401>>>>>>>>>        
47401>>>>>>>>>            Send Rebuild_Constraints    to Barticl_DD
47402>>>>>>>>>            Send Beginning_Of_Data      to oSelList True
47403>>>>>>>>>        End_Procedure // OnClick
47404>>>>>>>>>        
47404>>>>>>>>>        
47404>>>>>>>>>        
47404>>>>>>>>>        //AB-StoreEnd
47404>>>>>>>>>
47404>>>>>>>>>    End_Object    // ButtonSub1
47405>>>>>>>>>
47405>>>>>>>>>    Object oOK_bn is a ButtonSub
47407>>>>>>>>>        Set Label to "&„§ ¢¦šã"
47408>>>>>>>>>        Set Size to 13 50
47409>>>>>>>>>        Set Location to 258 406
47410>>>>>>>>>        Set Focus_Mode to Pointer_Only
47411>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
47412>>>>>>>>>
47412>>>>>>>>>        //AB-StoreStart
47412>>>>>>>>>        Procedure OnClick
47414>>>>>>>>>            Send OK To (oSelList(current_object))
47415>>>>>>>>>        End_Procedure
47416>>>>>>>>>        //AB-StoreEnd
47416>>>>>>>>>
47416>>>>>>>>>    End_Object    // oOK_bn
47417>>>>>>>>>
47417>>>>>>>>>    Object oCancel_bn is a ButtonSub
47419>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
47420>>>>>>>>>        Set Size to 13 50
47421>>>>>>>>>        Set Location to 258 461
47422>>>>>>>>>        Set Focus_Mode to Pointer_Only
47423>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
47424>>>>>>>>>
47424>>>>>>>>>        //AB-StoreStart
47424>>>>>>>>>        Procedure OnClick
47426>>>>>>>>>            Send Cancel To (oSelList(current_object))
47427>>>>>>>>>        End_Procedure
47428>>>>>>>>>        //AB-StoreEnd
47428>>>>>>>>>
47428>>>>>>>>>    End_Object    // oCancel_bn
47429>>>>>>>>>
47429>>>>>>>>>
47429>>>>>>>>>    //AB-StoreStart
47429>>>>>>>>>                    
47429>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
47430>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
47431>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
47432>>>>>>>>>    
47432>>>>>>>>>    Set Modal_State to True
47433>>>>>>>>>    
47433>>>>>>>>>    Procedure Activate
47435>>>>>>>>>        If (FragmaTypkinCode(Self)<>0) Begin
47437>>>>>>>>>            Send Clear to Btypkin_DD2
47438>>>>>>>>>            Move (FragmaTypkinCode(Self)) to Btypkin.Btypkin_Code
47439>>>>>>>>>            Send Find to Btypkin_DD2 Eq 1
47440>>>>>>>>>        End
47440>>>>>>>>>>
47440>>>>>>>>>        Else Send Clear to Btypkin_DD2
47442>>>>>>>>>        If (FragmaClientID(Self)<>'') Begin
47444>>>>>>>>>            Send Clear to Clients_DD
47445>>>>>>>>>            Move (FragmaClientID(Self)) to Clients.Client_ID
47446>>>>>>>>>            Send Find to Clients_DD Eq 6
47447>>>>>>>>>        End
47447>>>>>>>>>>
47447>>>>>>>>>        Else Send Clear to Clients_DD
47449>>>>>>>>>        If (FragmaHmnia(Self)<>'') Set Value Of cSyDateForm1 Item 0 to (FragmaHmnia(Self))
47452>>>>>>>>>        Else                       Set Value Of cSyDateForm1 Item 0 to ''
47454>>>>>>>>>        Forward Send Activate
47456>>>>>>>>>    End_Procedure
47457>>>>>>>>>    
47457>>>>>>>>>    //AB-StoreEnd
47457>>>>>>>>>
47457>>>>>>>>>End_Object    // Barticl
47458>>>>>>>>>
47458>>>>>>>>>//AB/ End_Object    // prj
47458>>>>>>>Use sl041.SL         // sl041
47458>>>>>>>
47458>>>>>>>//DDB-Selection-pkg-End
47458>>>>>>>//DDB-FileEnd
47458>>>>>    
47458>>>>>    //AB-IgnoreEnd
47458>>>>>
47458>>>>>    Object SL036 is a dbModalPanelSub
47460>>>>>
47460>>>>>        //AB-StoreTopStart
47460>>>>>        Property String     psClientID      Public ''
47462>>>>>        Property String     psEponymo       Public ''
47464>>>>>        Property Date       pdHmnia         Public ''
47466>>>>>        Property Integer    piTypkinCode    Public  0
47468>>>>>        
47468>>>>>        
47468>>>>>        //AB-StoreTopEnd
47468>>>>>
47468>>>>>        Set Label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤"
47469>>>>>        Set Size to 288 522
47470>>>>>        Set Location to 6 3
47471>>>>>        Set Exit_Application_Local_State to FALSE
47472>>>>>        Set Modal_State to FALSE
47473>>>>>
47473>>>>>        //AB-DDOStart
47473>>>>>
47473>>>>>        Object Btypkin_DD is a Btypkin_DataDictionary
47475>>>>>        End_Object    // Btypkin_DD
47476>>>>>
47476>>>>>        Object Barticl_DD is a Barticl_DataDictionary
47478>>>>>            Set DDO_Server to (Btypkin_DD(self))
47479>>>>>
47479>>>>>            //AB-StoreStart
47479>>>>>                                            
47479>>>>>            Begin_Constraints
47481>>>>>                String  sClientID
47482>>>>>                Date    dHmnia
47482>>>>>                Integer iTypkinCode
47482>>>>>            
47482>>>>>                Get piTypkinCode    to iTypkinCode
47483>>>>>                Get psClientID      to sClientID
47484>>>>>                Get pdHmnia         to dHmnia
47485>>>>>            
47485>>>>>                Constrain Barticl.Company_Code  Eq Syscurxr.Company_Code
47487>>>>>                Constrain Barticl.Branch_Code   Eq Syscurxr.Branch_Code
47489>>>>>                Constrain Barticl.Year_Year     Eq Syscurxr.Year_Year
47491>>>>>            
47491>>>>>                If (sClientID  <> 0) Begin
47493>>>>>                    If (iTypkinCode<> 0) Begin
47495>>>>>                        Set Ordering to 8
47496>>>>>                        Constrain Barticl.Btypkin_Code  Eq iTypkinCode
47498>>>>>                        Constrain Barticl.Barticl_Code1 Eq sClientID
47500>>>>>                    End
47500>>>>>>
47500>>>>>                    Else Begin
47501>>>>>                        Set Ordering to 10
47502>>>>>                        Constrain Barticl.Barticl_Code1 Eq sClientID
47504>>>>>                    End
47504>>>>>>
47504>>>>>                End
47504>>>>>>
47504>>>>>                Else If (dHmnia     <>'') Begin
47507>>>>>                    Set Ordering to 9
47508>>>>>                    Constrain Barticl.Barticl_Hmnia Eq dHmnia
47510>>>>>                End
47510>>>>>>
47510>>>>>                Else If (iTypkinCode<> 0) Begin
47513>>>>>                    Set Ordering to 1
47514>>>>>                    Constrain Barticl.Btypkin_Code  Eq iTypkinCode
47516>>>>>                End
47516>>>>>>
47516>>>>>            End_Constraints
47519>>>>>            
47519>>>>>            //AB-StoreEnd
47519>>>>>
47519>>>>>        End_Object    // Barticl_DD
47520>>>>>
47520>>>>>        Set Main_DD to (Barticl_DD(self))
47521>>>>>        Set Server to (Barticl_DD(self))
47522>>>>>
47522>>>>>        //AB-DDOEnd
47522>>>>>
47522>>>>>        Object oSelList is a dbListSub
47524>>>>>            Set Main_File to Barticl.File_Number
47525>>>>>            Set Server to (Btypkin_DD(self))
47526>>>>>            Set Size to 238 508
47527>>>>>            Set Location to 4 5
47528>>>>>
47528>>>>>            Begin_Row
47531>>>>>                Entry_Item Barticl.Barticl_no
47532>>>>>                Entry_Item Barticl.Arith_orist
47533>>>>>                Entry_Item Barticl.Barticl_hmnia
47534>>>>>                Entry_Item Btypkin.Btypkin_code
47535>>>>>                Entry_Item Btypkin.Btypkin_descr
47536>>>>>                Entry_Item Barticl.Barticl_epon1
47537>>>>>                Entry_Item Barticl.Barticl_sv0
47538>>>>>            End_Row
47543>>>>>
47543>>>>>            Set Form_Width    item 0 to 60
47544>>>>>            Set Header_Label  item 0 to "€¨ Ÿ£æª"
47545>>>>>            
47545>>>>>            Set Form_Width    item 1 to 60
47546>>>>>            Set Header_Label  item 1 to "Ž¨ ©«.˜¨ Ÿ."
47547>>>>>            
47547>>>>>            Set Form_Width    item 2 to 57
47548>>>>>            Set Header_Label  item 2 to "†£œ¨¦£ž¤å˜"
47549>>>>>            
47549>>>>>            Set Form_Width    item 3 to 41
47550>>>>>            Set Header_Label  item 3 to "‰å¤ž©ž"
47551>>>>>            
47551>>>>>            Set Form_Width    item 4 to 140
47552>>>>>            Set Header_Label  item 4 to "œ¨ š¨˜­ã"
47553>>>>>            
47553>>>>>            Set Form_Width    item 5 to 90
47554>>>>>            Set Header_Label  item 5 to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
47555>>>>>            
47555>>>>>            Set Form_Width    item 6 to 54
47556>>>>>            Set Header_Label  item 6 to "¦©æ"
47557>>>>>            
47557>>>>>
47557>>>>>            //AB-StoreStart
47557>>>>>            
47557>>>>>            Set Numeric_mask Item 6 to 14 0 ' ,*'
47558>>>>>            
47558>>>>>            Procedure Activating
47560>>>>>                Send Rebuild_Constraints    to Barticl_DD
47561>>>>>                Send Beginning_Of_Data      to oSelList True
47562>>>>>                Forward Send Activating
47564>>>>>            End_Procedure
47565>>>>>            
47565>>>>>            
47565>>>>>            
47565>>>>>            
47565>>>>>            
47565>>>>>            
47565>>>>>            
47565>>>>>            //AB-StoreEnd
47565>>>>>
47565>>>>>        End_Object    // oSelList
47566>>>>>
47566>>>>>        Object oOK_bn is a ButtonSub
47568>>>>>            Set Label to "&„§ ¢¦šã"
47569>>>>>            Set Location to 255 354
47570>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
47571>>>>>
47571>>>>>            //AB-StoreStart
47571>>>>>            Procedure OnClick
47573>>>>>                Send OK To oSelList
47574>>>>>            End_Procedure
47575>>>>>            //AB-StoreEnd
47575>>>>>
47575>>>>>        End_Object    // oOK_bn
47576>>>>>
47576>>>>>        Object oCancel_bn is a ButtonSub
47578>>>>>            Set Label to "&€¡ç¨à©ž"
47579>>>>>            Set Location to 255 410
47580>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
47581>>>>>
47581>>>>>            //AB-StoreStart
47581>>>>>            Procedure OnClick
47583>>>>>                Send Cancel To oSelList
47584>>>>>            End_Procedure
47585>>>>>            //AB-StoreEnd
47585>>>>>
47585>>>>>        End_Object    // oCancel_bn
47586>>>>>
47586>>>>>        Object oSearch_bn is a ButtonSub
47588>>>>>            Set Label to "€&¤˜ã«ž©ž"
47589>>>>>            Set Location to 255 464
47590>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
47591>>>>>
47591>>>>>            //AB-StoreStart
47591>>>>>            Procedure OnClick
47593>>>>>                Send Search To oSelList
47594>>>>>            End_Procedure
47595>>>>>            //AB-StoreEnd
47595>>>>>
47595>>>>>        End_Object    // oSearch_bn
47596>>>>>
47596>>>>>
47596>>>>>        //AB-StoreStart
47596>>>>>        On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
47597>>>>>        On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
47598>>>>>        On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
47599>>>>>        
47599>>>>>        
47599>>>>>        
47599>>>>>        
47599>>>>>        
47599>>>>>        
47599>>>>>        
47599>>>>>        
47599>>>>>        //AB-StoreEnd
47599>>>>>
47599>>>>>    End_Object    // SL036
47600>>>>>
47600>>>>>//AB/     End_Object    // prj
47600>>>Use sl036r.sl
INCLUDING FILE: SL036R.SL
47600>>>>>//AB/ Project sl036r:Barticle with recr 1st col
47600>>>>>//AB/     Object prj is a Lookup_Project
47600>>>>>//AB/         Set ProjectName to "sl036r:Barticle with recr 1st col"
47600>>>>>//AB/         Set ProjectFileName to "sl036r.SL"
47600>>>>>//AB/         Set GenerateFileName to "NONAME"
47600>>>>>
47600>>>>>// Project Object Structure
47600>>>>>//   sl036r is a dbModalPanelSub
47600>>>>>//     Btypkin_DD is a DataDictionary
47600>>>>>//     Barticl_DD is a DataDictionary
47600>>>>>//     oSelList is a dbListSub
47600>>>>>//     oOK_bn is a ButtonSub
47600>>>>>//     oCancel_bn is a ButtonSub
47600>>>>>//     oSearch_bn is a ButtonSub
47600>>>>>
47600>>>>>// Register all objects
47600>>>>>Register_Object Barticl_DD
47600>>>>>Register_Object Btypkin_DD
47600>>>>>Register_Object oCancel_bn
47600>>>>>Register_Object oOK_bn
47600>>>>>Register_Object oSearch_bn
47600>>>>>Register_Object oSelList
47600>>>>>Register_Object sl036r
47600>>>>>
47600>>>>>
47600>>>>>    //AB-IgnoreStart
47600>>>>>
47600>>>>>    Use DFAllEnt.pkg
47600>>>>>    Use dbList.Sub
47600>>>>>    Use Button.Sub
47600>>>>>
47600>>>>>
47600>>>>>    Use BTYPKIN.DD
47600>>>>>    Use BARTICL.DD
47600>>>>>    
47600>>>>>    //AB-IgnoreEnd
47600>>>>>
47600>>>>>    CD_Popup_Object sl036r is a dbModalPanelSub
47619>>>>>        set label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤" 
47620>>>>>        Set Size to 148 440
47621>>>>>        Set Location to 4 5
47622>>>>>        Set Exit_Application_Local_State to FALSE
47623>>>>>        Set Modal_State to FALSE
47624>>>>>
47624>>>>>        //AB-DDOStart
47624>>>>>
47624>>>>>        Object Btypkin_DD is a Btypkin_DataDictionary
47626>>>>>        End_Object    // Btypkin_DD
47627>>>>>
47627>>>>>        Object Barticl_DD is a Barticl_DataDictionary
47629>>>>>            Set DDO_Server to (Btypkin_DD(self))
47630>>>>>        End_Object    // Barticl_DD
47631>>>>>
47631>>>>>        Set Main_DD to (Barticl_DD(self))
47632>>>>>        Set Server to (Barticl_DD(self))
47633>>>>>
47633>>>>>        //AB-DDOEnd
47633>>>>>
47633>>>>>        Object oSelList is a dbListSub
47635>>>>>            Set Main_File to Barticl.File_Number
47636>>>>>            Set Server to (Btypkin_DD(self))
47637>>>>>            Set Size to 105 424
47638>>>>>            Set Location to 6 6
47639>>>>>
47639>>>>>            Begin_Row
47642>>>>>                Entry_Item Barticl.Barticl_recr
47643>>>>>                Entry_Item Barticl.Barticl_no
47644>>>>>                Entry_Item Barticl.Barticl_hmnia
47645>>>>>                Entry_Item Btypkin.Btypkin_code
47646>>>>>                Entry_Item Btypkin.Btypkin_descr
47647>>>>>            End_Row
47652>>>>>
47652>>>>>            Set Form_Width    item 0 to 56
47653>>>>>            Set Header_Label  item 0 to "Barticl recr"
47654>>>>>            
47654>>>>>            Set Form_Width    item 1 to 84
47655>>>>>            set header_label  item 1 to "€¨ Ÿ£æª" 
47656>>>>>            
47656>>>>>            Set Form_Width    item 2 to 60
47657>>>>>            set header_label  item 2 to "†£œ¨¦£ž¤å˜" 
47658>>>>>            
47658>>>>>            Set Form_Width    item 3 to 38
47659>>>>>            set header_label  item 3 to "‰å¤ž©ž" 
47660>>>>>            
47660>>>>>            Set Form_Width    item 4 to 179
47661>>>>>            set header_label  item 4 to "œ¨ š¨˜­ã" 
47662>>>>>            
47662>>>>>
47662>>>>>            //AB-StoreStart
47662>>>>>            Set Column_Option Item 0 to NoEnter True
47663>>>>>            
47663>>>>>            //AB-StoreEnd
47663>>>>>
47663>>>>>        End_Object    // oSelList
47664>>>>>
47664>>>>>        Object oOK_bn is a ButtonSub
47666>>>>>            set label to "&„§ ¢¦šã" 
47667>>>>>            Set Location to 114 271
47668>>>>>
47668>>>>>            //AB-StoreStart
47668>>>>>            Procedure OnClick
47670>>>>>                Send OK To oSelList
47671>>>>>            End_Procedure
47672>>>>>            //AB-StoreEnd
47672>>>>>
47672>>>>>        End_Object    // oOK_bn
47673>>>>>
47673>>>>>        Object oCancel_bn is a ButtonSub
47675>>>>>            set label to "&€¡ç¨à©ž" 
47676>>>>>            Set Location to 114 327
47677>>>>>
47677>>>>>            //AB-StoreStart
47677>>>>>            Procedure OnClick
47679>>>>>                Send Cancel To oSelList
47680>>>>>            End_Procedure
47681>>>>>            //AB-StoreEnd
47681>>>>>
47681>>>>>        End_Object    // oCancel_bn
47682>>>>>
47682>>>>>        Object oSearch_bn is a ButtonSub
47684>>>>>            set label to "€&¤˜ã«ž©ž" 
47685>>>>>            Set Location to 114 381
47686>>>>>
47686>>>>>            //AB-StoreStart
47686>>>>>            Procedure OnClick
47688>>>>>                Send Search To oSelList
47689>>>>>            End_Procedure
47690>>>>>            //AB-StoreEnd
47690>>>>>
47690>>>>>        End_Object    // oSearch_bn
47691>>>>>
47691>>>>>
47691>>>>>        //AB-StoreStart
47691>>>>>        On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
47692>>>>>        On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
47693>>>>>        On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
47694>>>>>        
47694>>>>>        //AB-StoreEnd
47694>>>>>
47694>>>>>    CD_End_Object    // sl036r
47696>>>>>>
47696>>>>>
47696>>>>>//AB/     End_Object    // prj
47696>>>Use sl037.sl
INCLUDING FILE: SL037.SL
47696>>>>>//AB/ Project SL037:BAXIO
47696>>>>>//AB/ Object prj is a Lookup_Project
47696>>>>>//AB/     Set ProjectName to "SL037:BAXIO"
47696>>>>>//AB/     Set ProjectFileName to "SL037.SL"
47696>>>>>
47696>>>>>// Project Object Structure
47696>>>>>//   SL037 is a dbModalPanelSub
47696>>>>>//     Baxiokat_DD is a DataDictionary
47696>>>>>//     Baxio_DD is a DataDictionary
47696>>>>>//     oSelList is a dbListSub
47696>>>>>//     TextBoxSub1 is a TextBoxSub
47696>>>>>//     cSyDateForm1 is a cSyDateForm
47696>>>>>//     TextBoxSub2 is a TextBoxSub
47696>>>>>//     cSyDateForm2 is a cSyDateForm
47696>>>>>//     TextBoxSub4 is a TextBoxSub
47696>>>>>//     TextBoxSub5 is a TextBoxSub
47696>>>>>//     FormSub1 is a FormSub
47696>>>>>//     FormSub2 is a FormSub
47696>>>>>//     FormSub3 is a FormSub
47696>>>>>//     FormSub4 is a FormSub
47696>>>>>//     ButtonSub1 is a ButtonSub
47696>>>>>//     oOK_bn is a ButtonSub
47696>>>>>
47696>>>>>// Register all objects
47696>>>>>Register_Object Baxio_DD
47696>>>>>Register_Object Baxiokat_DD
47696>>>>>Register_Object ButtonSub1
47696>>>>>Register_Object cSyDateForm1
47696>>>>>Register_Object cSyDateForm2
47696>>>>>Register_Object FormSub1
47696>>>>>Register_Object FormSub2
47696>>>>>Register_Object FormSub3
47696>>>>>Register_Object FormSub4
47696>>>>>Register_Object oOK_bn
47696>>>>>Register_Object oSelList
47696>>>>>Register_Object SL037
47696>>>>>Register_Object TextBoxSub1
47696>>>>>Register_Object TextBoxSub2
47696>>>>>Register_Object TextBoxSub4
47696>>>>>Register_Object TextBoxSub5
47696>>>>>
47696>>>>>
47696>>>>>
47696>>>>>//AB-StoreTopStart
47696>>>>>    
47696>>>>>Use sl100.sl
47696>>>>>
47696>>>>>
47696>>>>>//AB-StoreTopEnd
47696>>>>>
47696>>>>>//AB-IgnoreStart
47696>>>>>
47696>>>>>Use DFAllEnt.pkg
47696>>>>>Use dbList.Sub
47696>>>>>Use Txtbox.Sub
47696>>>>>Use cSyDateForm.Pkg
47696>>>>>Use Form.Sub
47696>>>>>Use Button.Sub
47696>>>>>
47696>>>>>
47696>>>>>Use BAXIOKAT.DD
47696>>>>>Use BAXIO.DD
INCLUDING FILE: BAXIO.DD
47696>>>>>>>//DDB-FileStart
47696>>>>>>>//DDB-HeaderStart
47696>>>>>>>
47696>>>>>>>// File Name : BAXIO.DD
47696>>>>>>>// Class Name: Baxio_DataDictionary
47696>>>>>>>// Revision  : 112
47696>>>>>>>// Version   : 2
47696>>>>>>>
47696>>>>>>>Use  Windows           // Basic Definitions
47696>>>>>>>Use  DataDict          // DataDictionary Class Definition
47696>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
47696>>>>>>>
47696>>>>>>>Open Baxio
47698>>>>>>>Open Bmove
47700>>>>>>>Open Baxiokat
47702>>>>>>>Open Sysrecb
47704>>>>>>>
47704>>>>>>>//DDB-HeaderEnd
47704>>>>>>>//DDB-ValidationStart
47704>>>>>>>
47704>>>>>>>//DDB/ ExternalValidationTable Baxio_Status_VT  Baxio.pkg
47704>>>>>>>//DDB/ ExternalValidationTable Bfile_VT  Baxio.pkg
47704>>>>>>>
47704>>>>>>>Register_Object Baxio_Status_VT
47704>>>>>>>Register_Object Baxio_Baxio_Place_VT
47704>>>>>>>Register_Object Bfile_VT
47704>>>>>>>Register_Object Baxio_Baxio_Bank_VT
47704>>>>>>>Register_Object Baxio_Baxio_Banka_VT
47704>>>>>>>Register_Object Baxio_Baxio_From_VT
47704>>>>>>>Register_Object Baxio_Baxio_Topos_VT1
47704>>>>>>>Use Baxio.pkg        // Baxio_Status_VT, Bfile_VT
47704>>>>>>>
47704>>>>>>>Object Baxio_Baxio_Place_VT  is a CodeValidationTable
47706>>>>>>>    Set Type_Value        To "BAXIOPLACE"
47707>>>>>>>    //DDB-ValidationCustomStart
47707>>>>>>>    //DDB-ValidationCustomEnd
47707>>>>>>>End_Object   // Baxio_Baxio_Place_VT
47708>>>>>>>
47708>>>>>>>Object Baxio_Baxio_Bank_VT  is a CodeValidationTable
47710>>>>>>>    Set Type_Value        To "BANK"
47711>>>>>>>    Set Allow_Blank_State To TRUE
47712>>>>>>>    //DDB-ValidationCustomStart
47712>>>>>>>    //DDB-ValidationCustomEnd
47712>>>>>>>End_Object   // Baxio_Baxio_Bank_VT
47713>>>>>>>
47713>>>>>>>Object Baxio_Baxio_Banka_VT  is a CodeValidationTable
47715>>>>>>>    Set Type_Value        To "BANK"
47716>>>>>>>    Set Allow_Blank_State To TRUE
47717>>>>>>>    //DDB-ValidationCustomStart
47717>>>>>>>    //DDB-ValidationCustomEnd
47717>>>>>>>End_Object   // Baxio_Baxio_Banka_VT
47718>>>>>>>
47718>>>>>>>Object Baxio_Baxio_From_VT  is a DescriptionValidationTable
47720>>>>>>>    Set Allow_Blank_State To TRUE
47721>>>>>>>    Set Table_Title       To "€¥ æš¨˜­¦  ›å¦¬ / «¨å«¦¬"
47722>>>>>>>
47722>>>>>>>    Procedure Fill_List
47724>>>>>>>        Forward Send Fill_List
47726>>>>>>>        Send Add_Table_Value  "0"  "ˆ›å¦¬"
47727>>>>>>>        Send Add_Table_Value  "1"  "’¨å«¦¬"
47728>>>>>>>    End_Procedure    // Fill_List
47729>>>>>>>    //DDB-ValidationCustomStart
47729>>>>>>>    //DDB-ValidationCustomEnd
47729>>>>>>>End_Object   // Baxio_Baxio_From_VT
47730>>>>>>>
47730>>>>>>>Object Baxio_Baxio_Topos_VT1  is a DescriptionValidationTable
47732>>>>>>>    Set Allow_Blank_State To TRUE
47733>>>>>>>    Set Table_Title       To "€¥ æš¨˜­¦ €«« ¡ãª / „§˜¨®å˜ª"
47734>>>>>>>
47734>>>>>>>    Procedure Fill_List
47736>>>>>>>        Forward Send Fill_List
47738>>>>>>>        Send Add_Table_Value  "0"  "€«« ¡ãª"
47739>>>>>>>        Send Add_Table_Value  "1"  "„§˜¨®å˜ª"
47740>>>>>>>    End_Procedure    // Fill_List
47741>>>>>>>    //DDB-ValidationCustomStart
47741>>>>>>>    //DDB-ValidationCustomEnd
47741>>>>>>>End_Object   // Baxio_Baxio_Topos_VT1
47742>>>>>>>//DDB-ValidationEnd
47742>>>>>>>//DDB-SelectionStart
47742>>>>>>>//DDB/ ExternalSelectionList SL037  SL037.SL
47742>>>>>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
47742>>>>>>>Register_Object SL037
47742>>>>>>>Register_Object slNomism
47742>>>>>>>//DDB-SelectionEnd
47742>>>>>>>
47742>>>>>>>Class Baxio_DataDictionary  is a DataDictionary_Sec
47743>>>>>>>
47743>>>>>>>      Procedure Construct_Object
47744>>>>>>>                Forward Send Construct_Object
47746>>>>>>>
47746>>>>>>>                //btypkin related properties:
47746>>>>>>>                //œ¤ž£œ¨é¤¦¤«˜  ©«ã¤: update «¦¬ bmove,
47746>>>>>>>                //£ž›œ¤å¦¤«˜   ©«ž¤: request save & delete «¦¬ bmove.
47746>>>>>>>                Property Integer piBtypkin_Flag03 0
47747>>>>>>>                Property Integer piBtypkin_Flag04 0
47748>>>>>>>                Property Integer pifromxrhsh      0
47749>>>>>>>
47749>>>>>>>                //baxio related properties:
47749>>>>>>>                //œ¤ž£œ¨é¤œ«˜     ©«ž¤: creating,
47749>>>>>>>                //®¨ž© £¦§¦ œå«˜  ©«ž¤: update «¦¬ bmove š ˜ ¤˜ œ¤œ¨š¦§¦ ã©œ  «ž¤ private.created_baxio «¦¬ bmove,
47749>>>>>>>                //£ž›œ¤åœ«˜      ©«ž¤: request save & delete «¦¬ bmove.
47749>>>>>>>                Property Integer piCreated_Baxio  0
47750>>>>>>>
47750>>>>>>>                //œ¤ž£œ¨é¤¦¤«˜     ©«ž¤: backout,
47750>>>>>>>                //®¨ž© £¦§¦ ¦ç¤«˜  ©«ž¤: validate_save š ˜ «¦¤ â¢œš®¦ editing «¦¬ baxio,
47750>>>>>>>                //£ž›œ¤å¦¤«˜      ©«ž¤: request save & delete «¦¬ bmove.
47750>>>>>>>                Property Number  pnB_Baxio_V2      0
47751>>>>>>>                Property Number  pnB_Baxio_V0      0
47752>>>>>>>                Property Number  pnB_Baxio_V00     0
47753>>>>>>>                Property Number  pnB_Baxio_Vr      0
47754>>>>>>>                Property String  psB_Baxio_C_Code2 ""
47755>>>>>>>                Property Integer piB_Baxio_Status  0
47756>>>>>>>                Property Integer piB_Baxio_Place   0
47757>>>>>>>
47757>>>>>>>                //properties š ˜ œ¢âš®¦¬ª ˜¢˜ššãª parent records:
47757>>>>>>>                //œ¤ž£œ¨é¤¦¤«˜     ©«ž¤:backout,
47757>>>>>>>                //®¨ž© £¦§¦ ¦ç¤«˜  ©«ž¤: validate_save š ˜ «¦¤ â¢œš®¦ editing «à¤ §œ›åà¤,
47757>>>>>>>                //£ž›œ¤å¦¤«˜      ©«ž¤: request save & delete «¦¬ bmove.
47757>>>>>>>                Property Integer piB_Baxiokat_Code 0
47758>>>>>>>                Property Integer piB_Year_Year     0
47759>>>>>>>                Property Integer piMustNOTConstrain Public 0
47760>>>>>>>      End_Procedure //construct_object
47761>>>>>>>
47761>>>>>>>
47761>>>>>>>
47761>>>>>>>//    Function fngConvertPoso_Baxio String asNomismaCodeApo ;
47761>>>>>>>//                            Number anPoso           ;
47761>>>>>>>//                            String asNomismaCodeSe  ;
47761>>>>>>>//                            Date   adHmnia          ;
47761>>>>>>>//                            Number nIsotimia  Returns Number
47761>>>>>>>
47761>>>>>>>//        Number rVal nApo_Euro_Isot nSe_Euro_Isot
47761>>>>>>>//        Integer iApo_Einai_Euro_Zone iApo_Einai_DRX iApo_Einai_Euro iDekadika_Apo
47761>>>>>>>//        Integer iSe_Einai_Euro_Zone  iSe_Einai_DRX  iSe_Einai_Euro  iDekadika_Se
47761>>>>>>>
47761>>>>>>>//        If (asNomismaCodeApo=asNomismaCodeSe) Function_Return anPoso
47761>>>>>>>
47761>>>>>>>//        Clear Nomisma
47761>>>>>>>//        Move (Trim(asNomismaCodeApo)) to Nomisma.Nomisma_Code
47761>>>>>>>//        Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
47761>>>>>>>//        Move Nomisma.Euro_Zone      to iApo_Einai_Euro_Zone
47761>>>>>>>//        Move Nomisma.Einai_DRX      to iApo_Einai_DRX
47761>>>>>>>//        Move Nomisma.Einai_EURO     to iApo_Einai_Euro
47761>>>>>>>//        Move Nomisma.KL_ISOT_EURO   to nApo_Euro_Isot
47761>>>>>>>//        Move Nomisma.Dekadika       to iDekadika_Apo
47761>>>>>>>
47761>>>>>>>//        Clear Nomisma
47761>>>>>>>//        Move (Trim(asNomismaCodeSe)) to Nomisma.Nomisma_Code
47761>>>>>>>//        Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
47761>>>>>>>//        Move Nomisma.Euro_Zone      to iSe_Einai_Euro_Zone
47761>>>>>>>//        Move Nomisma.Einai_DRX      to iSe_Einai_DRX
47761>>>>>>>//        Move Nomisma.Einai_EURO     to iSe_Einai_Euro
47761>>>>>>>//        Move Nomisma.KL_ISOT_EURO   to nSe_Euro_Isot
47761>>>>>>>//        Move Nomisma.Dekadika       to iDekadika_Se
47761>>>>>>>
47761>>>>>>>//        //05a. ??ÿ??? ? --> ??? 
47761>>>>>>>//        Calc (anPoso/nApo_Euro_Isot) to rVal
47761>>>>>>>//        Move (Round_Number(rVal,6)) to rVal
47761>>>>>>>//        //05b. ???         --> ??ÿ??? ?™ *
47761>>>>>>>//        Calc (rVal*nSe_Euro_Isot) to rVal
47761>>>>>>>//        Move (Round_Number(rVal,iDekadika_Se)) to rVal
47761>>>>>>>//        Function_Return rVal
47761>>>>>>>//    End_Function
47761>>>>>>>
47761>>>>>>>
47761>>>>>>>
47761>>>>>>>      //¡˜Ÿ¦¨åœ  «ž¤ default « £ã «¦¬ ¤¦£å©£˜«¦ª ˜¤á¢¦š˜ £œ «¦ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
47761>>>>>>>      Function Default_Axio_C_Code2 Returns String
47762>>>>>>>               String lsBaxio_C_Code_2
47763>>>>>>>               //Get File_Field_Current_Value File_Field SyscurXr.C_Code0 to lsBaxio_C_Code_2
47763>>>>>>>               Move SyscurXr.C_Code0 to lsBaxio_C_Code_2
47764>>>>>>>               Function_Return (Trim(lsBaxio_C_Code_2))
47765>>>>>>>      End_Function //default_axio_c_code2
47766>>>>>>>
47766>>>>>>>
47766>>>>>>>      // js 09/02/2002 den yparxei enhmerosh ton nomismatvn xrhshs
47766>>>>>>>      Procedure Convert_Axio_Values
47767>>>>>>>
47767>>>>>>>                Integer liBtypkin_Flag03 liBtypkin_Flag04
47768>>>>>>>
47768>>>>>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_Code0    ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_Rate0       to Baxio.Baxio_V0
47769>>>>>>>
47769>>>>>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_Code00   ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_Rate00      to Baxio.Baxio_V00
47770>>>>>>>
47770>>>>>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_CodeR    ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_RateR       to Baxio.Baxio_VR
47771>>>>>>>
47771>>>>>>>
47771>>>>>>>//                Move (fngConvertPoso_Baxio(Self,Baxio.Baxio_C_Code2,   ;
47771>>>>>>>//                                     Baxio.Baxio_V2,        ;
47771>>>>>>>//                                     SyscurXr.C_Code0,      ;
47771>>>>>>>//                                     Baxio.Baxio_HmniaE,    ;
47771>>>>>>>//                                     Baxio.Baxio_Rate0)     ;
47771>>>>>>>//                                    ) to Baxio.Baxio_V0
47771>>>>>>>//                If (liBtypkin_Flag03 = TRUE);
47771>>>>>>>//                     Begin
47771>>>>>>>//                      //˜¥å˜ 2-->00
47771>>>>>>>//                      Move (fngConvertPoso_Baxio(Self, Baxio.Baxio_C_Code2, ;
47771>>>>>>>//                                            Baxio.Baxio_V2,      ;
47771>>>>>>>//                                            SyscurXr.C_Code00,   ;
47771>>>>>>>//                                            Baxio.Baxio_HmniaE,  ;
47771>>>>>>>//                                            Baxio.Baxio_Rate00)  ;
47771>>>>>>>//                                          ) to Baxio.Baxio_V00
47771>>>>>>>//                     End
47771>>>>>>>//                Else Begin
47771>>>>>>>//                      Move 0            to Baxio.Baxio_V00
47771>>>>>>>//                     End
47771>>>>>>>//                If (liBtypkin_Flag04 = TRUE);
47771>>>>>>>//                     Begin
47771>>>>>>>//                      //˜¥å˜ 2-->r
47771>>>>>>>//                      Move (fngConvertPoso_Baxio(Self,Baxio.Baxio_C_Code2, ;
47771>>>>>>>//                                       Baxio.Baxio_V2,      ;
47771>>>>>>>//                                       SyscurXr.C_CodeR,    ;
47771>>>>>>>//                                       Baxio.Baxio_HmniaE,  ;
47771>>>>>>>//                                       Baxio.Baxio_RateR)   ;
47771>>>>>>>//                                      ) to Baxio.Baxio_VR
47771>>>>>>>//                     End
47771>>>>>>>//                Else Begin
47771>>>>>>>//                      Move 0            to Baxio.Baxio_VR
47771>>>>>>>//                     End
47771>>>>>>>      End_Procedure
47772>>>>>>>
47772>>>>>>>
47772>>>>>>>
47772>>>>>>>      Procedure Constrain
47773>>>>>>>                Forward Send Constrain
47775>>>>>>>                If (piMustNOTConstrain(Self)=1) Begin
47777>>>>>>>                End 
47777>>>>>>>>
47777>>>>>>>                else If (piMustNOTConstrain(Self)=2) Begin 
47780>>>>>>>                    Constrain Baxio.Company_Code Eq Syscurxr.Company_Code
47782>>>>>>>                    Constrain Baxio.Branch_Code  Eq Syscurxr.Branch_Code
47784>>>>>>>                end    
47784>>>>>>>>
47784>>>>>>>                Else Begin
47785>>>>>>>                    Constrain Baxio.Company_Code Eq Syscurxr.Company_Code
47787>>>>>>>                    Constrain Baxio.Branch_Code  Eq Syscurxr.Branch_Code
47789>>>>>>>                    Constrain Baxio.Year_Year    Eq Syscurxr.Year_Year
47791>>>>>>>                End
47791>>>>>>>>
47791>>>>>>>      End_Procedure   //constrain
47792>>>>>>>
47792>>>>>>>
47792>>>>>>>      //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
47792>>>>>>>      //™) ˜¤áš¤à©ž properties
47792>>>>>>>      //š) › ˜®œå¨ ©ž calculated §œ›åà¤
47792>>>>>>>      //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
47792>>>>>>>      //œ) œ¤ž£â¨à©ž properties after
47792>>>>>>>      Procedure Update
47793>>>>>>>                Forward Send Update
47795>>>>>>>                
47795>>>>>>>                If (Baxio.Baxio_C_Code2='') Move SyscurXr.C_Code0 to Baxio.Baxio_C_Code2
47798>>>>>>>                
47798>>>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
47798>>>>>>>                Move Syscurxr.Company_Code  to Baxio.Company_Code
47799>>>>>>>                Move Syscurxr.Branch_Code   to Baxio.Branch_Code
47800>>>>>>>                Move Syscurxr.Year_Year     to Baxio.Year_Year
47801>>>>>>>                Move Syscurxr.Year_Recr     to Baxio.Year_Recr
47802>>>>>>>                Move Baxiokat.Baxiokat_Code to Baxio.Baxiokat_Code
47803>>>>>>>
47803>>>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
47803>>>>>>>                //š01:œ¥ ¦¨ ©£¦ç, «˜ §¢ž¨à«â˜ ›â¤ â®¦¬¤ ©«¦ ®œå˜ §˜¨˜¢¢˜™ãª
47803>>>>>>>                If (Baxiokat.Baxiokat_Type = 2);                Begin //˜¥ æš¨˜­˜ §¢ž¨à«â˜
47805>>>>>>>                     Move "" to Baxio.Baxio_Code_In
47806>>>>>>>                     Move "" to Baxio.Baxio_Epon_In
47807>>>>>>>                     Move 0  to Baxio.Baxio_Fpar_In
47808>>>>>>>                End
47808>>>>>>>>
47808>>>>>>>                //š02:yyyy + mm + dd ¢ã¥žª š ˜ «˜ reports
47808>>>>>>>                Move (TheYearSegment (Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_YYYY
47809>>>>>>>                Move (TheMonthSegment(Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_MM
47810>>>>>>>                Move (TheDaySegment  (Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_DD
47811>>>>>>>
47811>>>>>>>                //š03:§¨é«¦ª & «œ¢œ¬«˜å¦ª §˜¨˜¢ã§«žª
47811>>>>>>>                If (Baxio.Baxio_Lcode = "");                Begin
47813>>>>>>>                     Move (-1) to Baxio.Baxio_File_Out
47814>>>>>>>                     Move ""   to Baxio.Baxio_Code_Out
47815>>>>>>>                     Move ""   to Baxio.Baxio_Epon_Out
47816>>>>>>>                     Move ""   to Baxio.Baxio_Fpar_Out
47817>>>>>>>
47817>>>>>>>                     Move (-1) to Baxio.Baxio_Lfile
47818>>>>>>>                     Move ""   to Baxio.Baxio_Lepon
47819>>>>>>>                     Move ""   to Baxio.Baxio_Lpar
47820>>>>>>>                End
47820>>>>>>>>
47820>>>>>>>      End_Procedure //update
47821>>>>>>>
47821>>>>>>>
47821>>>>>>>      Procedure Backout
47822>>>>>>>                Forward Send Backout
47824>>>>>>>
47824>>>>>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
47824>>>>>>>                Set pnB_Baxio_V2      to Baxio.Baxio_V2
47825>>>>>>>                Set pnB_Baxio_V0      to Baxio.Baxio_V0
47826>>>>>>>                Set pnB_Baxio_V00     to Baxio.Baxio_V00
47827>>>>>>>                Set pnB_Baxio_Vr      to Baxio.Baxio_Vr
47828>>>>>>>                Set psB_Baxio_C_Code2 to Baxio.Baxio_C_Code2
47829>>>>>>>                Set piB_Baxio_Status  to Baxio.Baxio_Status
47830>>>>>>>                Set piB_Baxio_Place   to Baxio.Baxio_Place
47831>>>>>>>                Set piB_Baxiokat_Code to Baxio.Baxiokat_Code    //š ˜ â¢œš®¦ ˜¢˜ššãª parent
47832>>>>>>>                Set piB_Year_Year     to Baxio.Year_Year        //š ˜ â¢œš®¦ ˜¢˜ššãª parent
47833>>>>>>>      End_Procedure //backout
47834>>>>>>>
47834>>>>>>>
47834>>>>>>>      Procedure New_Current_Record Integer liOld_Record Integer liNew_Record
47835>>>>>>>                Forward Send New_Current_Record liOld_Record liNew_Record
47837>>>>>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
47837>>>>>>>                Set pnB_Baxio_V2      to Baxio.Baxio_V2
47838>>>>>>>                Set pnB_Baxio_V0      to Baxio.Baxio_V0
47839>>>>>>>                Set pnB_Baxio_V00     to Baxio.Baxio_V00
47840>>>>>>>                Set pnB_Baxio_Vr      to Baxio.Baxio_Vr
47841>>>>>>>                Set psB_Baxio_C_Code2 to Baxio.Baxio_C_Code2
47842>>>>>>>                Set piB_Baxio_Status  to Baxio.Baxio_Status
47843>>>>>>>                Set piB_Baxiokat_Code to Baxio.Baxiokat_Code    //š ˜ â¢œš®¦ ˜¢˜ššãª parent
47844>>>>>>>                Set piB_Year_Year     to Baxio.Year_Year        //š ˜ â¢œš®¦ ˜¢˜ššãª parent
47845>>>>>>>      End_Procedure //new_current_record
47846>>>>>>>
47846>>>>>>>
47846>>>>>>>      Procedure Creating
47847>>>>>>>                Forward Send Creating
47849>>>>>>>
47849>>>>>>>                //˜¨ Ÿ£æª ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
47849>>>>>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBaxio
47849>>>>>>>
47849>>>>>>>                //«œ¢œ¬«˜å¦ª ¡à› ¡æª ˜¨ Ÿ£æª ˜¥ ¦š¨á­¦¬
47849>>>>>>>                Add 1 to Baxiokat.Baxio_Lcode
47850>>>>>>>                Move Baxiokat.Baxio_Lcode to Baxio.Baxio_Code
47851>>>>>>>
47851>>>>>>>                //«¦ property ˜¬«æ œ¤œ¨š¦§¦ œå «ž¤ private.created_baxio
47851>>>>>>>                //£â©à «žª update ©«¦ bmove
47851>>>>>>>                Set piCreated_Baxio to TRUE
47852>>>>>>>
47852>>>>>>>//
47852>>>>>>>//                Move SysCurXr.C_Code0 to Baxio.Baxio_C_Code2
47852>>>>>>>
47852>>>>>>>                Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                 (Trim(String(Baxio.Baxio_Rec0)))))) to Baxio.Baxio_Recr
47853>>>>>>>
47853>>>>>>>      End_Procedure //creating
47854>>>>>>>
47854>>>>>>>
47854>>>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
47855>>>>>>>                String lsError_Message
47856>>>>>>>                Case Begin
47856>>>>>>>                     //˜§æ validate save
47856>>>>>>>                     Case (iError_Num = 1001)
47858>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  ¦§à©›ã§¦«œ ž£œ¨¦£ž¤å˜ ¢ã¥œàª!");                          to lsError_Message
47859>>>>>>>                     Case Break
47860>>>>>>>                     Case (iError_Num = 1002)
47863>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
47864>>>>>>>                     Case Break
47865>>>>>>>                     Case (iError_Num = 1003)
47868>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  ¦§à©›ã§¦«œ ¤æ£ ©£˜!");                          to lsError_Message
47869>>>>>>>                     Case Break
47870>>>>>>>                     Case (iError_Num = 1004)
47873>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
47874>>>>>>>                     Case Break
47875>>>>>>>                     Case (iError_Num = 1005)
47878>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
47879>>>>>>>                     Case Break
47880>>>>>>>                     Case (iError_Num = 1006)
47883>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ Reporting).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
47884>>>>>>>                     Case Break
47885>>>>>>>
47885>>>>>>>                     Case (iError_Num = 1007)
47888>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\nŒâ˜ €¥ æš¨˜­˜ ›ž£ ¦¬¨š¦ç¤«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
47889>>>>>>>                     Case Break
47890>>>>>>>                     Case (iError_Num = 1008)
47893>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ¤æ£ ©£˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
47894>>>>>>>                     Case Break
47895>>>>>>>                     Case (iError_Num = 1009)
47898>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
47899>>>>>>>                     Case Break
47900>>>>>>>                     Case (iError_Num = 1010)
47903>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©žª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
47904>>>>>>>                     Case Break
47905>>>>>>>                     Case (iError_Num = 1011)
47908>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜ •¨ã©žª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
47909>>>>>>>                     Case Break
47910>>>>>>>                     Case (iError_Num = 1012)
47913>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (Œæ£ ©£˜ Reporting) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
47914>>>>>>>                     Case Break
47915>>>>>>>                     Case (iError_Num = 1013)
47918>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ˜¥ æš¨˜­¦ â®œ  œ¥¦­¢žŸœå !");                          to lsError_Message
47919>>>>>>>                     Case Break
47920>>>>>>>
47920>>>>>>>                     Case (iError_Num = 1014)
47923>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ ›â¤ œ§ «¨â§œ«˜  ¤˜ ˜¢¢á¥œ  ¡˜«žš¦¨å˜!");                          to lsError_Message
47924>>>>>>>                     Case Break
47925>>>>>>>                     Case (iError_Num = 1015)
47928>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ ›â¤ œ§ «¨â§œ«˜  ¤˜ ˜¢¢á¥œ  ®¨ã©ž!");                          to lsError_Message
47929>>>>>>>                     Case Break
47930>>>>>>>                     Case (iError_Num = 1100)
47933>>>>>>>                          Move "DDC 037:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
47934>>>>>>>                          Case Break
47935>>>>>>>
47935>>>>>>>                     //˜§æ validate delete
47935>>>>>>>                     Case (iError_Num = 2007)
47938>>>>>>>                          Move ("DDC 037:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n’¦ €¥ æš¨˜­¦ › ˜š¨á­œ«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
47939>>>>>>>                     Case Break
47940>>>>>>>                     Case (iError_Num = 2100)
47943>>>>>>>                          Move "DDC 037:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
47944>>>>>>>                          Case Break
47945>>>>>>>
47945>>>>>>>                     Case Else
47945>>>>>>>                          Forward Send Operation_Not_Allowed iError_Num
47947>>>>>>>                Case End
47947>>>>>>>
47947>>>>>>>                Error iError_Num lsError_Message
47948>>>>>>>>
47948>>>>>>>      End_Procedure // operation_not_allowed
47949>>>>>>>
47949>>>>>>>      //1001:baxio_hmnial > 0
47949>>>>>>>      //1002:baxio_v2 > 0            (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ œšš¨˜­ãª
47949>>>>>>>      //1003:baxio_c_code2 <> ""     (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ £ã¤ â®œ  ¤æ£ ©£˜)
47949>>>>>>>
47949>>>>>>>      //1004:baxio_v0 > 0            (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©žª
47949>>>>>>>      //1005:baxio_v00 > 0 if flag 3 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©žª
47949>>>>>>>      //1006:baxio_vr > 0  of flag 4 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ reporting
47949>>>>>>>
47949>>>>>>>
47949>>>>>>>      //1007:›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬ œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ «¦ bmove_dd, ›ž¢˜›ã §¨â§œ 
47949>>>>>>>      //       If (baxio.recnum=0) then operation_origin must be = bmove_dd
47949>>>>>>>      //1008:«¨¦§¦§¦åž©ž (edit) baxio_c_code2 £æ¤¦¤ ˜§æ bmove_dd
47949>>>>>>>      //1009:«¨¦§¦§¦åž©ž (edit) baxio_v2      £æ¤¦¤ ˜§æ bmove_dd
47949>>>>>>>      //1010:«¨¦§¦§¦åž©ž (edit) baxio_v0      £æ¤¦¤ ˜§æ bmove_dd
47949>>>>>>>      //1011:«¨¦§¦§¦åž©ž (edit) baxio_v00     £æ¤¦¤ ˜§æ bmove_dd
47949>>>>>>>      //1012:«¨¦§¦§¦åž©ž (edit) baxio_vr      £æ¤¦¤ ˜§æ bmove_dd
47949>>>>>>>
47949>>>>>>>      //1013:œá¤ «¦ status œå¤˜  œ¥¦­¢ž£â¤¦, ˜§˜š¦¨œçœ¦¤«˜  æ¢˜ «˜ §œ¨˜ «â¨à edits
47949>>>>>>>
47949>>>>>>>      //1014:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent baxiokat record
47949>>>>>>>      //1015:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent year     record
47949>>>>>>>      Function Validate_Save Returns Integer
47950>>>>>>>               Integer iReturnVal
47951>>>>>>>
47951>>>>>>>               Forward Get Validate_Save to iReturnVal
47953>>>>>>>
47953>>>>>>>               If (Not(iReturnVal));               Begin
47955>>>>>>>
47955>>>>>>>                //---------â¢œš®¦  ›ž£ ¦¬¨šå˜ª ¤â¦¬ baxio record----------------------
47955>>>>>>>                //sososo £ž§àª §¨œ§œ  ¤˜ §˜ ¥à £œ «ž¤ current record ????
47955>>>>>>>                If (Baxio.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ record
47957>>>>>>>                      //1007:â¢œš®¦ª ›ž£ ¦¬¨šå˜ª ¤â¦¬ ˜¥ ¦š¨á­¦¬ ˜§¦ «¦ baxio_dd
47957>>>>>>>
47957>>>>>>>                      If (pifromxrhsh(Self)=0) Begin
47959>>>>>>>                        If (Not((Main_File(OPERATION_ORIGIN)) =  Bmove.File_Number)) Send Operation_Not_Allowed 1007
47962>>>>>>>                      End
47962>>>>>>>>
47962>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ baxio record
47962>>>>>>>>
47962>>>>>>>
47962>>>>>>>
47962>>>>>>>                //---------â¢œš®¦  editing existing baxio records---------------------
47962>>>>>>>                Else;                Begin //edit an existing record
47963>>>>>>>                      //1008:«¨¦§¦§¦åž©ž (edit) baxio_c_code2 £æ¤¦¤ ˜§æ bmove_dd
47963>>>>>>>
47963>>>>>>>                      If (pifromxrhsh(Self)=0) Begin
47965>>>>>>>
47965>>>>>>>                        If (;                            ((psB_Baxio_C_Code2(Self))     <> Baxio.Baxio_C_Code2) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1008
47968>>>>>>>                        //1009:«¨¦§¦§¦åž©ž (edit) baxio_v2 £æ¤¦¤ ˜§æ bmove_dd
47968>>>>>>>                        If (;                            ((pnB_Baxio_V2(Self))          <> Baxio.Baxio_V2      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1009
47971>>>>>>>                        //1010:«¨¦§¦§¦åž©ž (edit) baxio_v0 £æ¤¦¤ ˜§æ bmove_dd
47971>>>>>>>                        If (;                            ((pnB_Baxio_V0(Self))          <> Baxio.Baxio_V0      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1010
47974>>>>>>>                        //1011:«¨¦§¦§¦åž©ž (edit) baxio_v00 £æ¤¦¤ ˜§æ bmove_dd
47974>>>>>>>                        If (;                            ((pnB_Baxio_V00(Self))         <> Baxio.Baxio_V00     ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1011
47977>>>>>>>                        //1012:«¨¦§¦§¦åž©ž (edit) baxio_vr £æ¤¦¤ ˜§æ bmove_dd
47977>>>>>>>                        If (;                            ((pnB_Baxio_Vr(Self))          <> Baxio.Baxio_Vr      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1012
47980>>>>>>>
47980>>>>>>>                      End
47980>>>>>>>>
47980>>>>>>>                        // Egine rem 20/12/2001 giati an orisoume sta metrhta gia paradeigma
47980>>>>>>>                        // oti to status SE einai exoflhmeno, tote xtypaei to validation sto
47980>>>>>>>                        // kleisimo toy barticle. Alloste den vlepoume giati den mporei na
47980>>>>>>>                        // anoigokleisei
47980>>>>>>>//                      //1013:œá¤ «¦ status œå¤˜  œ¥¦­¢ž£â¤¦, ˜§˜š¦¨œç¦¤«˜  æ¢˜ «˜ §œ¨˜ «â¨à edits ˜§¦ «¦ bmove
47980>>>>>>>//                      If (;
47980>>>>>>>//                           ((piB_Baxio_Status(Self))      = 2                    ) and;
47980>>>>>>>//                           ((Main_File(OPERATION_ORIGIN)) =  Bmove.File_Number);
47980>>>>>>>//                         )                                                       Send Operation_Not_Allowed 1013
47980>>>>>>>
47980>>>>>>>                      If (pifromxrhsh(Self)=0) Begin
47982>>>>>>>                        //1014:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent baxiokat record
47982>>>>>>>                        If (Not;                            ((piB_Baxiokat_Code(Self)) =  Baxiokat.Baxiokat_Code);                            )                                                       Send Operation_Not_Allowed 1014
47985>>>>>>>
47985>>>>>>>                        //1015:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent year record
47985>>>>>>>                        If (Not;                            ((piB_Year_Year    (Self)) =  SysCurXr.Year_Year        );                            )                                                       Send Operation_Not_Allowed 1015
47988>>>>>>>                      End
47988>>>>>>>>
47988>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing baxio records
47988>>>>>>>>
47988>>>>>>>
47988>>>>>>>                //¢¦§¦å â¢œš®¦ 
47988>>>>>>>                //1001:baxio_hmnial > 0
47988>>>>>>>                If (Not(Baxio.Baxio_Hmnial > 0 ))   Send Operation_Not_Allowed 1001
47991>>>>>>>                //1002:baxio_v2 > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ œšš¨˜­ãª
47991>>>>>>>                If (Not(Baxio.Baxio_V2 > 0))         Send Operation_Not_Allowed 1002
47994>>>>>>>                //1003:baxio_c_code2 <> ""
47994>>>>>>>                If (Not(Baxio.Baxio_C_Code2 <>""))    Send Operation_Not_Allowed 1003
47997>>>>>>>                //1004:baxio_v0 > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
47997>>>>>>>//--------------If (Not(Baxio.Baxio_V0 > 0))         Send Operation_Not_Allowed 1004
47997>>>>>>>                //1005:baxio_v00> 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©œàª
47997>>>>>>>//--------------If (Not(Baxio.Baxio_V00> 0))         Send Operation_Not_Allowed 1005
47997>>>>>>>                //1006:baxio_vr > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ reporting
47997>>>>>>>//--------------If (Not(Baxio.Baxio_VR > 0))         Send Operation_Not_Allowed 1006
47997>>>>>>>                //1100:cby = globals
47997>>>>>>>
47997>>>>>>>                If (pifromxrhsh(Self)=0) Begin
47999>>>>>>>
47999>>>>>>>                    If ( ;                        (Not(Baxio.Company_Code = SyscurXr.Company_Code)) or;                        (Not(Baxio.Branch_Code  = SyscurXr.Branch_Code )) or;                        (Not(Baxio.Year_Year    = SyscurXr.Year_Year   ));                        )                                                   Send Operation_Not_Allowed 1100
48002>>>>>>>
48002>>>>>>>               End
48002>>>>>>>>
48002>>>>>>>
48002>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
48002>>>>>>>>
48002>>>>>>>               Function_Return iReturnVal
48003>>>>>>>      End_Function //validate_save
48004>>>>>>>
48004>>>>>>>
48004>>>>>>>      //2007:ž › ˜š¨˜­ã ˜¥ ¦š¨á­¦¬ œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ «¦ bmove_dd
48004>>>>>>>      Function Validate_Delete  Returns Integer
48005>>>>>>>               Integer iReturnVal
48006>>>>>>>               Forward Get Validate_Delete  To iReturnVal
48008>>>>>>>               If (Not(iReturnVal));               Begin
48010>>>>>>>
48010>>>>>>>                  //2007:â¢œš®¦ª › ˜š¨˜­ãª ˜¥ ¦š¨á­¦¬ (£æ¤¦¤ ˜§¦ bmove_dd)
48010>>>>>>>                  If ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number)          Send Operation_Not_Allowed 2007
48013>>>>>>>
48013>>>>>>>                  //2100:cby = globals
48013>>>>>>>                  If ( ;                      (Not(Baxio.Company_Code = Syscurxr.Company_Code)) or;                      (Not(Baxio.Branch_Code  = Syscurxr.Branch_Code )) or;                      (Not(Baxio.Year_Year    = Syscurxr.Year_Year        ));                      )                                                   Send Operation_Not_Allowed 2100
48016>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
48016>>>>>>>>
48016>>>>>>>               Function_Return iReturnVal
48017>>>>>>>      End_Function //validate_delete
48018>>>>>>>
48018>>>>>>>
48018>>>>>>>//------------------------------------------------------------------
48018>>>>>>>    Procedure Define_Fields
48019>>>>>>>        Forward Send Define_Fields
48021>>>>>>>        //DDB-Generated-Code-Location
48021>>>>>>>        //DDB-DefineFieldStart
48021>>>>>>>
48021>>>>>>>        Set Main_File            To Baxio.File_Number
48022>>>>>>>        Set Cascade_Delete_State To FALSE
48023>>>>>>>
48023>>>>>>>
48023>>>>>>>        // Child (Client) file structure................
48023>>>>>>>        Send Add_Client_File  Bmove.File_Number
48024>>>>>>>
48024>>>>>>>        // Parent (Server) file structure...............
48024>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
48025>>>>>>>
48025>>>>>>>        // External (System) file structure.............
48025>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
48026>>>>>>>
48026>>>>>>>        Define_Auto_Increment  Sysrecb.Baxio_Rec0  To Baxio.Baxio_Rec0
48029>>>>>>>
48029>>>>>>>        // Field-based properties.......................
48029>>>>>>>
48029>>>>>>>        // Baxio.Company_Code
48029>>>>>>>
48029>>>>>>>        // Baxio.Branch_Code
48029>>>>>>>
48029>>>>>>>        // Baxio.Year_Year
48029>>>>>>>
48029>>>>>>>        // Baxio.Baxiokat_Code
48029>>>>>>>
48029>>>>>>>        // Baxio.Baxio_Code
48029>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Code To (SL037(Self))
48030>>>>>>>
48030>>>>>>>        // Baxio.Baxio_Rec0
48030>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Rec0 To (SL037(Self))
48031>>>>>>>
48031>>>>>>>        // Baxio.Year_Recr
48031>>>>>>>
48031>>>>>>>        // Baxio.Baxiokat_Recr
48031>>>>>>>
48031>>>>>>>        // Baxio.Baxio_Recr
48031>>>>>>>
48031>>>>>>>        // Baxio.Baxio_Status
48031>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Status To (Baxio_Status_VT(Self))
48032>>>>>>>
48032>>>>>>>        // Baxio.Baxio_Place
48032>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Place To (Baxio_Baxio_Place_VT(Self))
48033>>>>>>>
48033>>>>>>>        // Baxio.Baxio_File_In
48033>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_In To (Bfile_VT(Self))
48034>>>>>>>
48034>>>>>>>        // Baxio.Baxio_Code_In
48034>>>>>>>        //DDB/ Comment_Short       Field Baxio.Baxio_Code_In To "To BIAXIOKAT_FILE ¡˜Ÿ¦¨åœ  «ž¤ ©®œ« ¡ã ¢å©«˜"
48034>>>>>>>
48034>>>>>>>        // Baxio.Baxio_Epon_In
48034>>>>>>>
48034>>>>>>>        // Baxio.Baxio_Fpar_In
48034>>>>>>>
48034>>>>>>>        // Baxio.Baxio_File_Out
48034>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_Out To (Bfile_VT(Self))
48035>>>>>>>
48035>>>>>>>        // Baxio.Baxio_Code_Out
48035>>>>>>>
48035>>>>>>>        // Baxio.Baxio_Epon_Out
48035>>>>>>>
48035>>>>>>>        // Baxio.Baxio_Fpar_Out
48035>>>>>>>
48035>>>>>>>        // Baxio.Baxio_Lfile
48035>>>>>>>
48035>>>>>>>        // Baxio.Baxio_Lcode
48035>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Lcode To (Bfile_VT(Self))
48036>>>>>>>
48036>>>>>>>        // Baxio.Baxio_Lepon
48036>>>>>>>
48036>>>>>>>        // Baxio.Baxio_Lpar
48036>>>>>>>
48036>>>>>>>        // Baxio.Baxio_Bank00000
48036>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Bank00000 To (Baxio_Baxio_Bank_VT(Self))
48037>>>>>>>
48037>>>>>>>        // Baxio.Baxio_Hmniae
48037>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniae To (SL037(Self))
48038>>>>>>>
48038>>>>>>>        // Baxio.Baxio_Hmniap000
48038>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniap000 To (SL037(Self))
48039>>>>>>>
48039>>>>>>>        // Baxio.Baxio_Hmnial
48039>>>>>>>        //DDB/ Comment_Short       Field Baxio.Baxio_Hmnial To "†£/¤å˜ Šã¥žª:"
48039>>>>>>>
48039>>>>>>>        // Baxio.Baxio_Ekdoths
48039>>>>>>>
48039>>>>>>>        // Baxio.Baxio_Ekdothse
48039>>>>>>>
48039>>>>>>>        // Baxio.Baxio_Sediatagh
48039>>>>>>>
48039>>>>>>>        // Baxio.Baxio_Sdiataghe
48039>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Sdiataghe To (SL037(Self))
48040>>>>>>>
48040>>>>>>>        // Baxio.Baxio_Banka
48040>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Banka To (Baxio_Baxio_Banka_VT(Self))
48041>>>>>>>
48041>>>>>>>        // Baxio.Baxio_Opistho
48041>>>>>>>
48041>>>>>>>        // Baxio.Baxio_No
48041>>>>>>>
48041>>>>>>>        // Baxio.Baxio_V2
48041>>>>>>>
48041>>>>>>>        // Baxio.Baxio_V0
48041>>>>>>>
48041>>>>>>>        // Baxio.Baxio_V00
48041>>>>>>>
48041>>>>>>>        // Baxio.Baxio_Vr
48041>>>>>>>
48041>>>>>>>        // Baxio.Baxio_Rate0
48041>>>>>>>
48041>>>>>>>        // Baxio.Baxio_Rate00
48041>>>>>>>
48041>>>>>>>        // Baxio.Baxio_Rater
48041>>>>>>>
48041>>>>>>>        // Baxio.Baxio_C_Code2
48041>>>>>>>        Set Field_Entry_msg        Field Baxio.Baxio_C_Code2 To get_Default_Axio_C_Code2
48042>>>>>>>        Set Field_Options          Field Baxio.Baxio_C_Code2 To DD_CAPSLOCK   
48043>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_C_Code2 To (slNomism(Self))
48044>>>>>>>
48044>>>>>>>        // Baxio.Baxio_Lixi_Yyyy
48044>>>>>>>
48044>>>>>>>        // Baxio.Baxio_Lixi_Mm
48044>>>>>>>
48044>>>>>>>        // Baxio.Baxio_Lixi_Dd
48044>>>>>>>
48044>>>>>>>        // Baxio.Baxio_Bmove_Laa
48044>>>>>>>
48044>>>>>>>        // Baxio.Baxio_Desm
48044>>>>>>>
48044>>>>>>>        // Baxio.Baxio_From
48044>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_From To (Baxio_Baxio_From_VT(Self))
48045>>>>>>>
48045>>>>>>>        // Baxio.Baxio_Topos
48045>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Topos To (Baxio_Baxio_Topos_VT1(Self))
48046>>>>>>>
48046>>>>>>>        //DDB-DefineFieldEnd
48046>>>>>>>
48046>>>>>>>        Set Main_File            To Baxio.File_Number
48047>>>>>>>        Set Cascade_Delete_State To FALSE
48048>>>>>>>
48048>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
48049>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
48050>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48051>>>>>>>
48051>>>>>>>        // Child (Client) file structure................
48051>>>>>>>        Send Add_Client_File  Bmove.File_Number
48052>>>>>>>
48052>>>>>>>        // Parent (Server) file structure...............
48052>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
48053>>>>>>>
48053>>>>>>>        // External (System) file structure.............
48053>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
48054>>>>>>>
48054>>>>>>>        Define_Auto_Increment  Sysrecb.Baxio_Rec0  To Baxio.Baxio_Rec0
48057>>>>>>>
48057>>>>>>>        // Field-based properties.......................
48057>>>>>>>
48057>>>>>>>        // Baxio.Company_Code
48057>>>>>>>
48057>>>>>>>        // Baxio.Branch_Code
48057>>>>>>>
48057>>>>>>>        // Baxio.Year_Year
48057>>>>>>>
48057>>>>>>>        // Baxio.Baxiokat_Code
48057>>>>>>>
48057>>>>>>>        // Baxio.Baxio_Code
48057>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Code         To "‰à› ¡æª €¥ ¦š¨á­¦¬"
48058>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Code         To "‰à› ¡æª"
48059>>>>>>>        Set Field_Options          Field Baxio.Baxio_Code         To DD_AUTOFIND    DD_NOPUT
48060>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Code         To (sl037(Self))
48061>>>>>>>        Set Key_Field_State        Field Baxio.Baxio_Code         To TRUE
48062>>>>>>>
48062>>>>>>>        // Baxio.Baxio_Rec0
48062>>>>>>>        Set Field_Options          Field Baxio.Baxio_Rec0         To DD_AUTOFIND    DD_REQUIRED
48063>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Rec0         To (sl037(Self))
48064>>>>>>>        Set Key_Field_State        Field Baxio.Baxio_Rec0         To TRUE
48065>>>>>>>
48065>>>>>>>        // Baxio.Year_Rec0
48065>>>>>>>
48065>>>>>>>        // Baxio.Baxiokat_Rec0
48065>>>>>>>
48065>>>>>>>        // Baxio.Baxio_Status
48065>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Status       To "dbComboForm_EZ"
48066>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Status       To "‰˜«á©«˜©ž"
48067>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Status       To "‰˜«á©«˜©ž"
48068>>>>>>>        Set Field_Options  Field Baxio.Baxio_Status  To DD_DISPLAYONLY
48069>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Status       To (Baxio_Status_VT(Self))
48070>>>>>>>
48070>>>>>>>        // Baxio.Baxio_Place
48070>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Place        To "dbComboForm_EZ"
48071>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Place        To "„¬¨å©¡œ«˜ "
48072>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Place        To "„¬¨å©¡œ«˜ "
48073>>>>>>>        Set Field_Options          Field Baxio.Baxio_Place        To DD_DISPLAYONLY
48074>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Place        To (Baxio_Baxio_Place_VT(Self))
48075>>>>>>>
48075>>>>>>>        // Baxio.Baxio_File_In
48075>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_In      To (Bfile_VT(Self))
48076>>>>>>>
48076>>>>>>>        // Baxio.Baxio_Code_In
48076>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Code_In      To "˜¨œ¢ã­Ÿž €§æ"
48077>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Code_In      To "˜¨œ¢ã­Ÿž €§æ"
48078>>>>>>>        Set Field_Options          Field Baxio.Baxio_Code_In      To DD_DISPLAYONLY
48079>>>>>>>
48079>>>>>>>        // Baxio.Baxio_Epon_In
48079>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Epon_In      To "„§à¤¬£å˜"
48080>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Epon_In      To "„§à¤¬£å˜"
48081>>>>>>>        Set Field_Options          Field Baxio.Baxio_Epon_In      To DD_DISPLAYONLY
48082>>>>>>>
48082>>>>>>>        // Baxio.Baxio_Fpar_In
48082>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Fpar_In      To "˜¨/¡æ ˜¨˜¢˜™ãª"
48083>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Fpar_In      To "˜¨/¡æ ˜¨˜¢."
48084>>>>>>>        Set Field_Options          Field Baxio.Baxio_Fpar_In      To DD_DISPLAYONLY
48085>>>>>>>
48085>>>>>>>        // Baxio.Baxio_File_Out
48085>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_Out     To (Bfile_VT(Self))
48086>>>>>>>
48086>>>>>>>        // Baxio.Baxio_Code_Out
48086>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Code_Out     To "¨é«¦ª ˜¨˜¢ã§«žª"
48087>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Code_Out     To "¨é«¦ª ˜¨˜¢ã§«žª"
48088>>>>>>>        Set Field_Options          Field Baxio.Baxio_Code_Out     To DD_DISPLAYONLY
48089>>>>>>>
48089>>>>>>>        // Baxio.Baxio_Epon_Out
48089>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Epon_Out     To "„§à¤¬£å˜"
48090>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Epon_Out     To "„§à¤¬£å˜"
48091>>>>>>>        Set Field_Options          Field Baxio.Baxio_Epon_Out     To DD_DISPLAYONLY
48092>>>>>>>
48092>>>>>>>        // Baxio.Baxio_Fpar_Out
48092>>>>>>>        Set Field_Options          Field Baxio.Baxio_Fpar_Out     To DD_DISPLAYONLY
48093>>>>>>>
48093>>>>>>>        // Baxio.Baxio_Lfile
48093>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Lfile        To (Bfile_VT(Self))
48094>>>>>>>
48094>>>>>>>        // Baxio.Baxio_Lcode
48094>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Lcode        To "’œ¢œ¬«˜å¦ª ˜¨˜¢ã§«žª"
48095>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Lcode        To "’œ¢.˜¨˜¢ã§«žª"
48096>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lcode        To DD_DISPLAYONLY
48097>>>>>>>
48097>>>>>>>        // Baxio.Baxio_Lepon
48097>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lepon        To DD_DISPLAYONLY
48098>>>>>>>
48098>>>>>>>        // Baxio.Baxio_Lpar
48098>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Lpar         To "˜¨/¡æ ˜¨á›¦©žª"
48099>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Lpar         To "˜¨/¡æ ˜¨á›¦©žª"
48100>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lpar         To DD_DISPLAYONLY
48101>>>>>>>
48101>>>>>>>        // Baxio.Baxio_Bank00000
48101>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Bank00000    To "dbComboForm_EZ"
48102>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Bank00000    To (Baxio_Baxio_Bank_VT(Self))
48103>>>>>>>
48103>>>>>>>        // Baxio.Baxio_Hmniae
48103>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmniae       To "dbSpinForm_EZ"
48104>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmniae       To "†£/¤å˜ „¡›¦©žª"
48105>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmniae       To "†£/¤å˜ „¡›¦©žª"
48106>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniae       To (sl037(Self))
48107>>>>>>>
48107>>>>>>>        // Baxio.Baxio_Hmniap000
48107>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmniap000    To "dbSpinForm_EZ"
48108>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmniap000    To "†£/¤å˜ ˜¨˜¢˜™ãª"
48109>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmniap000    To "†£/¤å˜ ˜¨˜¢˜™ãª"
48110>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniap000    To (sl037(Self))
48111>>>>>>>
48111>>>>>>>        // Baxio.Baxio_Hmnial
48111>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmnial       To "dbSpinForm_EZ"
48112>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmnial       To "†£/¤å˜ Šã¥žª"
48113>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmnial       To "†£/¤å˜ Šã¥žª"
48114>>>>>>>        Set Field_Options          Field Baxio.Baxio_Hmnial       To DD_REQUIRED
48115>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmnial       To (sl037(Self))
48116>>>>>>>
48116>>>>>>>        // Baxio.Baxio_Ekdoths
48116>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Ekdoths      To "€¨® ¡æª „¡›æ«žª"
48117>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Ekdoths      To "€¨®.„¡›æ«žª"
48118>>>>>>>
48118>>>>>>>        // Baxio.Baxio_Ekdothse
48118>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Ekdothse     To "„§à¤¬£å˜ €¨® ¡¦ç „¡›æ«ž"
48119>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Ekdothse     To "„§à¤¬£å˜"
48120>>>>>>>
48120>>>>>>>        // Baxio.Baxio_Sediatagh
48120>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Sediatagh    To "‘œ ƒ ˜«˜šã"
48121>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Sediatagh    To "‘œ ƒ ˜«˜šã"
48122>>>>>>>
48122>>>>>>>        // Baxio.Baxio_Sdiataghe
48122>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Sdiataghe    To "„§à¤¬£å˜ €¨® ¡¦ç ƒ ¡˜ ¦ç®¦¬"
48123>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Sdiataghe    To "„§à¤¬£å˜"
48124>>>>>>>
48124>>>>>>>        // Baxio.Baxio_Banka
48124>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Banka        To "dbComboForm_EZ"
48125>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Banka        To "’¨á§œ˜"
48126>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Banka        To "’¨á§œ˜"
48127>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Banka        To (Baxio_Baxio_Banka_VT(Self))
48128>>>>>>>
48128>>>>>>>        // Baxio.Baxio_Opistho
48128>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Opistho      To "Š¦ §¦å Ž§ ©Ÿ¦š¨á­¦ "
48129>>>>>>>
48129>>>>>>>        // Baxio.Baxio_No
48129>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_No           To "€¨ Ÿ£æª"
48130>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_No           To "€¨ Ÿ£æª"
48131>>>>>>>
48131>>>>>>>        // Baxio.Baxio_V2
48131>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_V2           To "¦©æ"
48132>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_V2           To "¦©æ"
48133>>>>>>>        Set Field_Options          Field Baxio.Baxio_V2           To DD_REQUIRED
48134>>>>>>>
48134>>>>>>>        // Baxio.Baxio_V0
48134>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_V0           To "¦©æ ‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª"
48135>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_V0           To "¦©æ(‰¬¨. Œæ£.•¨.)"
48136>>>>>>>
48136>>>>>>>        // Baxio.Baxio_V00
48136>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_V00          To "¦©æ ƒœ¬«œ¨œç¦¤  Œæ£ ©£˜ •¨ã©œàª"
48137>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_V00          To "¦©æ(ƒœ¬«. Œæ£.•¨.)"
48138>>>>>>>
48138>>>>>>>        // Baxio.Baxio_Vr
48138>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Vr           To "¦©æ Œæ£ ©£˜ Reporting"
48139>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Vr           To "¦©æ( Œæ£.Rep.)"
48140>>>>>>>
48140>>>>>>>        // Baxio.Baxio_Rate0
48140>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Rate0        To "Rate 1"
48141>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Rate0        To "Rate 1"
48142>>>>>>>
48142>>>>>>>        // Baxio.Baxio_Rate00
48142>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Rate00       To "Rate 2"
48143>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Rate00       To "Rate 2"
48144>>>>>>>
48144>>>>>>>        // Baxio.Baxio_Rater
48144>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Rater        To "Rate 3"
48145>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Rater        To "Rate 3"
48146>>>>>>>
48146>>>>>>>        // Baxio.Baxio_C_Code2
48146>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_C_Code2      To "dbComboForm_EZ"
48147>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_C_Code2      To "Œæ£ ©£˜"
48148>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_C_Code2      To "Œæ£ ©£˜"
48149>>>>>>>        Set Field_Options          Field Baxio.Baxio_C_Code2      To DD_REQUIRED
48150>>>>>>>
48150>>>>>>>        // Baxio.Baxio_Lixi_Yyyy
48150>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Yyyy    To DD_DISPLAYONLY
48151>>>>>>>
48151>>>>>>>        // Baxio.Baxio_Lixi_Mm
48151>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Mm      To DD_DISPLAYONLY
48152>>>>>>>
48152>>>>>>>        // Baxio.Baxio_Lixi_Dd
48152>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Dd      To DD_DISPLAYONLY
48153>>>>>>>
48153>>>>>>>        // Baxio.Baxio_Bmove_Laa
48153>>>>>>>        Set Field_Options          Field Baxio.Baxio_Bmove_Laa    To DD_DISPLAYONLY
48154>>>>>>>
48154>>>>>>>    End_Procedure    // Define_Fields
48155>>>>>>>
48155>>>>>>>
48155>>>>>>>    Procedure Field_Defaults
48156>>>>>>>        Forward Send Field_Defaults
48158>>>>>>>        //DDB-Generated-Code-Location
48158>>>>>>>        //DDB-FieldDefaultStart
48158>>>>>>>        Set Field_Changed_Value   Field Baxio.Baxio_Status To 1
48159>>>>>>>        Set Field_Changed_Value   Field Baxio.Baxio_Place To 1
48160>>>>>>>        //DDB-FieldDefaultEnd
48160>>>>>>>    End_Procedure    // Field_Defaults
48161>>>>>>>
48161>>>>>>>End_Class    // Baxio_DataDictionary
48162>>>>>>>//DDB-Selection-pkg-Start
48162>>>>>>>
48162>>>>>>>Use SL037.SL         // SL037
48162>>>>>>>Use slnomism.sl      // slNomism
48162>>>>>>>
48162>>>>>>>//DDB-Selection-pkg-End
48162>>>>>>>//DDB-FileEnd
48162>>>>>
48162>>>>>//AB-IgnoreEnd
48162>>>>>
48162>>>>>Object SL037 is a dbModalPanelSub
48164>>>>>
48164>>>>>    //AB-StoreTopStart
48164>>>>>                        
48164>>>>>    Property Integer piFragmaBaxiokatRec0 Public  0
48166>>>>>    Property Integer piFragmaBaxiokatCode Public  0
48168>>>>>    Property Integer piFragmaBaxioStatus  Public  0
48170>>>>>    Property Integer piFragmaBaxioPlace   Public  0
48172>>>>>    Property string  psfragmaclient       Public ''
48174>>>>>    Property String  psFragmaBaxioStatus  Public ''
48176>>>>>    Property String  psEkdoths            Public ''
48178>>>>>    Property String  psApodekths          Public ''
48180>>>>>    Property Date pdApo                   Public ''
48182>>>>>    Property Date pdEos                   Public ''
48184>>>>>    
48184>>>>>    //AB-StoreTopEnd
48184>>>>>
48184>>>>>    Set Label to "‰˜«á¢¦š¦ª €¥ ¦š¨á­à¤"
48185>>>>>    Set Size to 287 527
48186>>>>>    Set Location to 2 3
48187>>>>>    Set Exit_Application_Local_State to FALSE
48188>>>>>    Set Modal_State to FALSE
48189>>>>>
48189>>>>>    //AB-DDOStart
48189>>>>>
48189>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
48191>>>>>    End_Object    // Baxiokat_DD
48192>>>>>
48192>>>>>    Object Baxio_DD is a Baxio_DataDictionary
48194>>>>>        Set DDO_Server to (Baxiokat_DD(self))
48195>>>>>
48195>>>>>        //AB-StoreStart
48195>>>>>                                                    
48195>>>>>        Function fiIsOK Returns Integer
48197>>>>>            String lsBaxioStatus sclient
48198>>>>>            Get psFragmaBaxioStatus  to lsBaxioStatus
48199>>>>>            Get psfragmaclient       to sclient
48200>>>>>            If (Trim(sClient)='') Begin
48202>>>>>                If (lsBaxioStatus Contains Baxio.Baxio_Status) Function_Return 1
48205>>>>>            End
48205>>>>>>
48205>>>>>            Else Begin
48206>>>>>                If (baxio.baxio_desm Eq sClient And lsBaxioStatus Contains Baxio.Baxio_Status) Function_Return 1
48209>>>>>            End
48209>>>>>>
48209>>>>>            Function_Return 0
48210>>>>>        End_Function
48211>>>>>        
48211>>>>>        Procedure OnConstrain
48213>>>>>        
48213>>>>>            Integer liBaxiokatCode liBaxioStatus liBaxioPlace
48214>>>>>            string  sclient lsBaxioStatus sApodekths sEkdoths
48214>>>>>            Date    dApo dEos
48214>>>>>        
48214>>>>>            Forward Send OnConstrain
48216>>>>>        
48216>>>>>            Get piFragmaBaxiokatCode    to liBaxiokatCode
48217>>>>>            Get psFragmaBaxioStatus     to lsBaxioStatus
48218>>>>>            Get piFragmaBaxioPlace      to liBaxioPlace
48219>>>>>        
48219>>>>>            Get psApodekths             to sApodekths
48220>>>>>            Get psEkdoths               to sEkdoths
48221>>>>>            Get pdApo                   to dApo
48222>>>>>            Get pdEos                   to dEos
48223>>>>>        
48223>>>>>            If (liBaxioKatCode <> 0) Begin
48225>>>>>                Constrain Baxio.Baxiokat_Code eq liBaxiokatCode
48227>>>>>                If (liBaxioPlace  <> 0)  Constrain Baxio.Baxio_Place eq liBaxioPlace
48231>>>>>                If (lsBaxioStatus <> '') Constrain Baxio as (fiIsOK(Self)=1)
48234>>>>>            End
48234>>>>>>
48234>>>>>        
48234>>>>>            If (sApodekths  <>'') Constrain Baxio.Baxio_Code_Out    Eq sApodekths
48238>>>>>            If (sEkdoths    <>'') Constrain Baxio.Baxio_Code_In     Eq sEkdoths
48242>>>>>            If (dApo        <>'') Constrain Baxio.Baxio_HmniaL      Ge dApo
48246>>>>>            If (dEos        <>'') Constrain Baxio.Baxio_HmniaL      Le dEos
48250>>>>>        
48250>>>>>        End_Procedure // OnConstrain
48251>>>>>        
48251>>>>>        
48251>>>>>        
48251>>>>>        
48251>>>>>        
48251>>>>>        
48251>>>>>        
48251>>>>>        
48251>>>>>        
48251>>>>>        
48251>>>>>        
48251>>>>>        
48251>>>>>        
48251>>>>>        //AB-StoreEnd
48251>>>>>
48251>>>>>    End_Object    // Baxio_DD
48252>>>>>
48252>>>>>    Set Main_DD to (Baxio_DD(self))
48253>>>>>    Set Server to (Baxio_DD(self))
48254>>>>>
48254>>>>>    //AB-DDOEnd
48254>>>>>
48254>>>>>    Object oSelList is a dbListSub
48256>>>>>        Set Main_File to Baxio.File_Number
48257>>>>>        Set Size to 228 514
48258>>>>>        Set Location to 4 6
48259>>>>>
48259>>>>>        Begin_Row
48262>>>>>            Entry_Item Baxio.Baxio_code
48263>>>>>            Entry_Item Baxio.Baxio_epon_in
48264>>>>>            Entry_Item Baxio.Baxio_epon_out
48265>>>>>            Entry_Item Baxiokat.Baxiokat_descr
48266>>>>>            Entry_Item Baxio.Baxio_hmnial
48267>>>>>            Entry_Item Baxio.Baxio_v2
48268>>>>>            Entry_Item Baxio.Baxio_banka
48269>>>>>            Entry_Item (Export_Code_Description(Self,6,Baxio.Baxio_banka))
48270>>>>>            Entry_Item Baxio.Baxio_no
48271>>>>>        End_Row
48276>>>>>
48276>>>>>        Set Form_Width    item 0 to 41
48277>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
48278>>>>>        
48278>>>>>        Set Form_Width    item 1 to 98
48279>>>>>        Set Header_Label  item 1 to "„¡›æ«žª"
48280>>>>>        
48280>>>>>        Set Form_Width    item 2 to 94
48281>>>>>        Set Header_Label  item 2 to "€§¦›â¡«žª"
48282>>>>>        
48282>>>>>        Set Form_Width    item 3 to 75
48283>>>>>        Set Header_Label  item 3 to "œ¨ š¨˜­ã"
48284>>>>>        
48284>>>>>        Set Form_Width    item 4 to 47
48285>>>>>        Set Header_Label  item 4 to "Šã¥ž"
48286>>>>>        
48286>>>>>        Set Form_Width    item 5 to 48
48287>>>>>        Set Header_Label  item 5 to "¦©æ"
48288>>>>>        
48288>>>>>        Set Form_Width    item 6 to 12
48289>>>>>        Set Header_Label  item 6 to "‰à› ¡æª ’¨á§œ˜"
48290>>>>>        
48290>>>>>        Set Form_Width    item 7 to 42
48291>>>>>        Set Header_Label  item 7 to "’¨á§œ˜"
48292>>>>>        
48292>>>>>        Set Form_Width    item 8 to 53
48293>>>>>        Set Header_Label  item 8 to "€¨ Ÿ£æª"
48294>>>>>        
48294>>>>>
48294>>>>>        //AB-StoreStart
48294>>>>>                
48294>>>>>        Property Integer piStoreFragmaBaxiokatRec0 Public 0
48296>>>>>        Property Integer piStoreFragmaBaxiokatCode Public 0
48298>>>>>        Property Integer piStoreFragmaBaxioStatus  Public 0
48300>>>>>        Property Integer piStoreFragmaBaxioPlace   Public 0
48302>>>>>        Property String  psStoreFragmaBaxioStatus  Public ''
48304>>>>>        
48304>>>>>        Procedure Store_Defaults
48306>>>>>            Forward Send Store_Defaults
48308>>>>>            Set piStoreFragmaBaxiokatRec0 to (piFragmaBaxiokatRec0(Self))
48309>>>>>            Set piStoreFragmaBaxiokatCode to (piFragmaBaxiokatCode(Self))
48310>>>>>            Set piStoreFragmaBaxioStatus  to (piFragmaBaxioStatus(Self))
48311>>>>>            Set piStoreFragmaBaxioPlace   to (piFragmaBaxioPlace(Self))
48312>>>>>            Set psStoreFragmaBaxioStatus  to (psFragmaBaxioStatus(Self))
48313>>>>>        End_Procedure // Store_Defaults
48314>>>>>        
48314>>>>>        Procedure Restore_Defaults
48316>>>>>            Forward Send Restore_Defaults
48318>>>>>            Set piFragmaBaxiokatRec0 to (piStoreFragmaBaxiokatRec0(Self))
48319>>>>>            Set piFragmaBaxiokatCode to (piStoreFragmaBaxiokatCode(Self))
48320>>>>>            Set piFragmaBaxioStatus  to (piStoreFragmaBaxioStatus(Self))
48321>>>>>            Set piFragmaBaxioPlace   to (piStoreFragmaBaxioPlace(Self))
48322>>>>>            Set psFragmaBaxioStatus  to (psStoreFragmaBaxioStatus(Self))
48323>>>>>        End_Procedure // Restore_Defaults
48324>>>>>        
48324>>>>>        Procedure Activating
48326>>>>>            Forward Send Activating
48328>>>>>         //   Set Auto_Index_State        to True
48328>>>>>            Send Rebuild_Constraints    to Baxio_DD
48329>>>>>        End_Procedure
48330>>>>>        
48330>>>>>        Procedure End_Construct_Object
48332>>>>>            Integer iDecs
48333>>>>>            Forward Send End_Construct_Object
48335>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    iDecs
48336>>>>>            Set Points Item 5 to iDecs
48337>>>>>            Set Numeric_Mask Item 5 to 10 iDecs ' ,*'
48338>>>>>        End_Procedure
48339>>>>>        
48339>>>>>        
48339>>>>>        
48339>>>>>        
48339>>>>>        
48339>>>>>        
48339>>>>>        
48339>>>>>        
48339>>>>>        
48339>>>>>        
48339>>>>>        
48339>>>>>        //AB-StoreEnd
48339>>>>>
48339>>>>>    End_Object    // oSelList
48340>>>>>
48340>>>>>    Object TextBoxSub1 is a TextBoxSub
48342>>>>>        Set Label to "Šã¥ž ˜§¦"
48343>>>>>        Set Location to 241 7
48344>>>>>        Set Size to 10 35
48345>>>>>        Set TypeFace to "MS Sans Serif"
48346>>>>>    End_Object    // TextBoxSub1
48347>>>>>
48347>>>>>    Object cSyDateForm1 is a cSyDateForm
48349>>>>>        Set Size to 13 66
48350>>>>>        Set Location to 240 45
48351>>>>>        Set Label_Col_Offset to 2
48352>>>>>        Set Label_Justification_Mode to jMode_Right
48353>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
48354>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48355>>>>>
48355>>>>>        //AB-StoreStart
48355>>>>>                                                    
48355>>>>>        Procedure Key Integer iKey
48357>>>>>            Integer iRetVal
48358>>>>>            Forward Send Key iKey
48360>>>>>            If (iKey=277) Begin
48362>>>>>                Set Value Item 0 to ''
48363>>>>>                //Send KeyAction to ButtonSub1
48363>>>>>            End
48363>>>>>>
48363>>>>>        End_Procedure
48364>>>>>        
48364>>>>>        
48364>>>>>        //AB-StoreEnd
48364>>>>>
48364>>>>>    End_Object    // cSyDateForm1
48365>>>>>
48365>>>>>    Object TextBoxSub2 is a TextBoxSub
48367>>>>>        Set Label to "Šã¥ž œàª"
48368>>>>>        Set Location to 258 7
48369>>>>>        Set Size to 10 35
48370>>>>>        Set TypeFace to "MS Sans Serif"
48371>>>>>    End_Object    // TextBoxSub2
48372>>>>>
48372>>>>>    Object cSyDateForm2 is a cSyDateForm
48374>>>>>        Set Size to 13 66
48375>>>>>        Set Location to 256 45
48376>>>>>        Set Label_Col_Offset to 2
48377>>>>>        Set Label_Justification_Mode to jMode_Right
48378>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
48379>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48380>>>>>
48380>>>>>        //AB-StoreStart
48380>>>>>                                                    
48380>>>>>        Procedure Key Integer iKey
48382>>>>>            Integer iRetVal
48383>>>>>            Forward Send Key iKey
48385>>>>>            If (iKey=277) Begin
48387>>>>>                Set Value Item 0 to ''
48388>>>>>                //Send KeyAction to ButtonSub1
48388>>>>>            End
48388>>>>>>
48388>>>>>        End_Procedure
48389>>>>>        
48389>>>>>        
48389>>>>>        //AB-StoreEnd
48389>>>>>
48389>>>>>    End_Object    // cSyDateForm2
48390>>>>>
48390>>>>>    Object TextBoxSub4 is a TextBoxSub
48392>>>>>        Set Label to "„¡›æ«žª"
48393>>>>>        Set Location to 241 118
48394>>>>>        Set Size to 10 33
48395>>>>>        Set TypeFace to "MS Sans Serif"
48396>>>>>    End_Object    // TextBoxSub4
48397>>>>>
48397>>>>>    Object TextBoxSub5 is a TextBoxSub
48399>>>>>        Set Label to "€§¦›â¡«žª"
48400>>>>>        Set Location to 258 118
48401>>>>>        Set Size to 10 39
48402>>>>>        Set TypeFace to "MS Sans Serif"
48403>>>>>    End_Object    // TextBoxSub5
48404>>>>>
48404>>>>>    Object FormSub1 is a FormSub
48406>>>>>        Set Size to 13 77
48407>>>>>        Set Location to 240 159
48408>>>>>        Set Label_Col_Offset to 2
48409>>>>>        Set Prompt_Button_Mode to pb_PromptOn
48410>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48411>>>>>
48411>>>>>        //AB-StoreStart
48411>>>>>                                                    
48411>>>>>        Set Prompt_Object to (sl100(Self))
48412>>>>>        
48412>>>>>        Procedure OnChange
48414>>>>>            String s1
48415>>>>>            Get Value Item 0 to s1
48416>>>>>            Set Value Of FormSub2 Item 0 to (fsClient(Self,s1))
48417>>>>>            Set psEkdoths to s1
48418>>>>>        End_Procedure
48419>>>>>        
48419>>>>>        
48419>>>>>        
48419>>>>>        
48419>>>>>        
48419>>>>>        
48419>>>>>        
48419>>>>>        //AB-StoreEnd
48419>>>>>
48419>>>>>    End_Object    // FormSub1
48420>>>>>
48420>>>>>    Object FormSub2 is a FormSub
48422>>>>>        Set Size to 13 187
48423>>>>>        Set Location to 240 240
48424>>>>>        Set Color to clBtnFace
48425>>>>>        Set Label_Col_Offset to 2
48426>>>>>        Set Enabled_State to FALSE
48427>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48428>>>>>        Set Item_Shadow_State Item 0 to TRUE
48429>>>>>        Set Shadow_State Item 0 to TRUE
48430>>>>>    End_Object    // FormSub2
48431>>>>>
48431>>>>>    Object FormSub3 is a FormSub
48433>>>>>        Set Size to 13 77
48434>>>>>        Set Location to 256 159
48435>>>>>        Set Label_Col_Offset to 2
48436>>>>>        Set Prompt_Button_Mode to pb_PromptOn
48437>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48438>>>>>
48438>>>>>        //AB-StoreStart
48438>>>>>                                                    
48438>>>>>        Set Prompt_Object to (sl100(Self))
48439>>>>>        
48439>>>>>        Procedure OnChange
48441>>>>>            String s1
48442>>>>>            Get Value Item 0 to s1
48443>>>>>            Set Value Of FormSub4 Item 0 to (fsClient(Self,s1))
48444>>>>>            Set psApodekths to s1
48445>>>>>        End_Procedure
48446>>>>>        
48446>>>>>        
48446>>>>>        
48446>>>>>        
48446>>>>>        
48446>>>>>        
48446>>>>>        
48446>>>>>        //AB-StoreEnd
48446>>>>>
48446>>>>>    End_Object    // FormSub3
48447>>>>>
48447>>>>>    Object FormSub4 is a FormSub
48449>>>>>        Set Size to 13 187
48450>>>>>        Set Location to 256 240
48451>>>>>        Set Color to clBtnFace
48452>>>>>        Set Label_Col_Offset to 2
48453>>>>>        Set Enabled_State to FALSE
48454>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48455>>>>>        Set Item_Shadow_State Item 0 to TRUE
48456>>>>>        Set Shadow_State Item 0 to TRUE
48457>>>>>    End_Object    // FormSub4
48458>>>>>
48458>>>>>    Object ButtonSub1 is a ButtonSub
48460>>>>>        Set Label to "œ¨ æ¨ ©œ"
48461>>>>>        Set Size to 14 43
48462>>>>>        Set Location to 256 430
48463>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48464>>>>>
48464>>>>>        //AB-StoreStart
48464>>>>>                                                    
48464>>>>>        Procedure OnClick
48466>>>>>            Date dApo dEos
48467>>>>>            Get Value Of cSyDateForm1 Item 0 to dApo
48468>>>>>            Get Value Of cSyDateForm2 Item 0 to dEos
48469>>>>>            Set pdApo to dApo
48470>>>>>            Set pdEos to dEos
48471>>>>>            Send Rebuild_Constraints to Baxio_DD
48472>>>>>            Send Beginning_Of_Data to oSelList True
48473>>>>>        End_Procedure // OnClick
48474>>>>>        
48474>>>>>        
48474>>>>>        
48474>>>>>        
48474>>>>>        
48474>>>>>        
48474>>>>>        
48474>>>>>        
48474>>>>>        
48474>>>>>        
48474>>>>>        
48474>>>>>        
48474>>>>>        
48474>>>>>        //AB-StoreEnd
48474>>>>>
48474>>>>>    End_Object    // ButtonSub1
48475>>>>>
48475>>>>>    Object oOK_bn is a ButtonSub
48477>>>>>        Set Label to "&„§ ¢¦šã"
48478>>>>>        Set Size to 14 43
48479>>>>>        Set Location to 256 478
48480>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48481>>>>>
48481>>>>>        //AB-StoreStart
48481>>>>>        Procedure OnClick
48483>>>>>            Send OK To oSelList
48484>>>>>        End_Procedure
48485>>>>>        //AB-StoreEnd
48485>>>>>
48485>>>>>    End_Object    // oOK_bn
48486>>>>>
48486>>>>>
48486>>>>>    //AB-StoreStart
48486>>>>>                        
48486>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
48487>>>>>    
48487>>>>>    Procedure Request_Cancel
48489>>>>>        Set Value Of cSyDateForm1 Item 0 to ''
48490>>>>>        Set Value Of cSyDateForm2 Item 0 to ''
48491>>>>>        Set Value Of FormSub1     Item 0 to ''
48492>>>>>        Set Value Of FormSub2     Item 0 to ''
48493>>>>>        Forward Send Request_Cancel
48495>>>>>    End_Procedure
48496>>>>>    
48496>>>>>    
48496>>>>>    
48496>>>>>    
48496>>>>>    
48496>>>>>    //AB-StoreEnd
48496>>>>>
48496>>>>>End_Object    // SL037
48497>>>>>
48497>>>>>
48497>>>>>//AB-StoreStart
48497>>>>>    
48497>>>>>//AB-StoreEnd
48497>>>>>
48497>>>>>//AB/ End_Object    // prj
48497>>>Use sl041.sl
48497>>>Use sl045.sl
INCLUDING FILE: SL045.SL
48497>>>>>//AB/ Project sl045: Wcmoves lookup
48497>>>>>//AB/     Object prj is a Lookup_Project
48497>>>>>//AB/         Set ProjectName to "sl045: Wcmoves lookup"
48497>>>>>//AB/         Set ProjectFileName to "sl045.SL"
48497>>>>>//AB/         Set GenerateFileName to "NONAME"
48497>>>>>
48497>>>>>// Project Object Structure
48497>>>>>//   sl045 is a dbModalPanelSub
48497>>>>>//     Wcmoves_DD is a DataDictionary
48497>>>>>//     oSelList is a dbListSub
48497>>>>>//     cSyDateForm1 is a cSyDateForm
48497>>>>>//     FormSub1 is a FormSub
48497>>>>>//     FormSub3 is a FormSub
48497>>>>>//     oOK_bn is a ButtonSub
48497>>>>>//     oSearch_bn is a ButtonSub
48497>>>>>//     ButtonSub1 is a ButtonSub
48497>>>>>//     TextBoxSub1 is a TextBoxSub
48497>>>>>//     TextBoxSub2 is a TextBoxSub
48497>>>>>
48497>>>>>// Register all objects
48497>>>>>Register_Object ButtonSub1
48497>>>>>Register_Object cSyDateForm1
48497>>>>>Register_Object FormSub1
48497>>>>>Register_Object FormSub3
48497>>>>>Register_Object oOK_bn
48497>>>>>Register_Object oSearch_bn
48497>>>>>Register_Object oSelList
48497>>>>>Register_Object sl045
48497>>>>>Register_Object TextBoxSub1
48497>>>>>Register_Object TextBoxSub2
48497>>>>>Register_Object Wcmoves_DD
48497>>>>>
48497>>>>>
48497>>>>>
48497>>>>>    //AB-StoreTopStart
48497>>>>>    use sl22s.sl
48497>>>>>    
48497>>>>>    //AB-StoreTopEnd
48497>>>>>
48497>>>>>    //AB-IgnoreStart
48497>>>>>
48497>>>>>    Use DFAllEnt.pkg
48497>>>>>    Use dbList.Sub
48497>>>>>    Use cSyDateForm.Pkg
48497>>>>>    Use Form.Sub
48497>>>>>    Use Button.Sub
48497>>>>>    Use Txtbox.Sub
48497>>>>>
48497>>>>>
48497>>>>>    Use WCMOVES.DD
INCLUDING FILE: WCMOVES.DD
48497>>>>>>>//DDB-FileStart
48497>>>>>>>//DDB-HeaderStart
48497>>>>>>>
48497>>>>>>>// File Name : WCMOVES.DD
48497>>>>>>>// Class Name: Wcmoves_DataDictionary
48497>>>>>>>// Revision  : 72
48497>>>>>>>// Version   : 2
48497>>>>>>>
48497>>>>>>>Use  Windows           // Basic Definitions
48497>>>>>>>Use  DataDict          // DataDictionary Class Definition
48497>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48497>>>>>>>
48497>>>>>>>Open Wcmoves
48499>>>>>>>Open Wtypkin
48501>>>>>>>Open Wax
48503>>>>>>>Open Witemx
48505>>>>>>>Open Sysrecw
48507>>>>>>>Open Wam
48509>>>>>>>
48509>>>>>>>//DDB-HeaderEnd
48509>>>>>>>//DDB-SelectionStart
48509>>>>>>>//DDB/ ExternalSelectionList sl045  sl045.SL
48509>>>>>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
48509>>>>>>>Register_Object sl045
48509>>>>>>>Register_Object slNomism
48509>>>>>>>//DDB-SelectionEnd
48509>>>>>>>
48509>>>>>>>Class Wcmoves_DataDictionary  is a DataDictionary_Sec
48510>>>>>>>
48510>>>>>>>   Procedure Construct_Object
48511>>>>>>>        Forward Send Construct_Object
48513>>>>>>>        Property Integer piFromxrhsh Public 0 //œ¤›œ ¥ž ¦«  œ¨®œ«˜  ˜§¦ €§¦š¨˜­ã ˜§¦Ÿã¡žª
48514>>>>>>>    End_Procedure
48515>>>>>>>
48515>>>>>>>    Function Validate_Save  Returns Integer
48516>>>>>>>        Integer iReturnVal iOpen_Items ifromxrhsh
48517>>>>>>>        String sModule
48517>>>>>>>        get pifromxrhsh to ifromxrhsh
48518>>>>>>>        Forward Get Validate_Save  To iReturnVal
48520>>>>>>>        If (Not(iReturnVal)) Begin
48522>>>>>>>            Clear Branch
48523>>>>>>>            Move SyscurXr.Company_Code  to Branch.Company_Code
48524>>>>>>>            Move SyscurXr.Branch_Code   to Branch.Branch_Code
48525>>>>>>>            Find Eq Branch By Index.1
48526>>>>>>>>
48526>>>>>>>            If (Not(Found)) Send Operation_Not_Allowed 6666
48529>>>>>>>            Else If ((Branch.Locked_Until<>'') And (WCmoves.WCmove_Hmnia<=Branch.Locked_Until)) Send Operation_Not_Allowed 6667
48533>>>>>>>
48533>>>>>>>            If (WCmoves.Prn_Theor='1') Move 8878 to iReturnVal
48536>>>>>>>            // ˜§¦ ˜§¦š¨˜­ã
48536>>>>>>>            Else If ((WCmoves.WCmove_Hmnia<SYSCURXR.YEAR_XRHSHFROM and ifromxrhsh<>1) Or ;                     (WCmoves.WCmove_Hmnia>SYSCURXR.YEAR_XRHSHTO and ifromxrhsh<>1))     ;                    Move 8877 to iReturnVal
48540>>>>>>>            Else If ((WCmoves.WCmove_QTY =0) And (WCmoves.Unit_Price=0)) Move 8833 to iReturnVal
48544>>>>>>>//                     (WCmoves.WCmove_Axia=0))    ;
48544>>>>>>>// js Allagh 26/08/2002 Gia na mporei na yparxei kinhsh Wcmoves
48544>>>>>>>//    me synolikh axia 0 (na exei timh monados alla p.x. ekptosh 100%)
48544>>>>>>>//    s' ena timologio polhshs.
48544>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
48547>>>>>>>        End
48547>>>>>>>>
48547>>>>>>>        Function_Return iReturnVal
48548>>>>>>>    End_Function   // Validate_Save
48549>>>>>>>
48549>>>>>>>    Function Validate_Delete  Returns Integer
48550>>>>>>>        Integer iReturnVal
48551>>>>>>>        String sModule
48551>>>>>>>        Forward Get Validate_Delete  To iReturnVal
48553>>>>>>>        If (Not(iReturnVal)) Begin
48555>>>>>>>
48555>>>>>>>            Clear Branch
48556>>>>>>>            Move SyscurXr.Company_Code  to Branch.Company_Code
48557>>>>>>>            Move SyscurXr.Branch_Code   to Branch.Branch_Code
48558>>>>>>>            Find Eq Branch By Index.1
48559>>>>>>>>
48559>>>>>>>            If (Not(Found)) Send Operation_Not_Allowed 6668
48562>>>>>>>            Else If ((Branch.Locked_Until<>'') And (WCmoves.WCmove_Hmnia<=Branch.Locked_Until)) Send Operation_Not_Allowed 6669
48566>>>>>>>
48566>>>>>>>            If (WCmoves.Prn_Theor='1') Move 8879 to iReturnVal
48569>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
48572>>>>>>>        End
48572>>>>>>>>
48572>>>>>>>        Function_Return iReturnVal
48573>>>>>>>    End_Function   // Validate_Delete
48574>>>>>>>
48574>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
48575>>>>>>>        String lsError_Message
48576>>>>>>>        Case Begin
48576>>>>>>>
48576>>>>>>>            Case (iError_Num = 6666)
48578>>>>>>>                Move "DDC 045: ‘­á¢£˜ 6666 €›ç¤˜«ž ž œšš¨˜­ž!\nƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ ¬§¦¡˜«˜©«ž£á«à¤" to lsError_Message
48579>>>>>>>            Case Break
48580>>>>>>>
48580>>>>>>>            Case (iError_Num = 6667)
48583>>>>>>>                Move "DDC 045: ‘­á¢£˜ 6667 €›ç¤˜«ž ž œšš¨˜­ž!\n†£/¤å˜ ¡å¤ž©žª §¨¦šœ¤â©«œ¨ž ž£/¤å˜ª ¡¢œ ›é£˜«¦ª" to lsError_Message
48584>>>>>>>            Case Break
48585>>>>>>>
48585>>>>>>>            Case (iError_Num = 6668)
48588>>>>>>>                Move "DDC 045: ‘­á¢£˜ 6668 €›ç¤˜«ž ž › ˜š¨˜­ã!\nƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ ¬§¦¡˜«˜©«ž£á«à¤" to lsError_Message
48589>>>>>>>            Case Break
48590>>>>>>>
48590>>>>>>>            Case (iError_Num = 6669)
48593>>>>>>>                Move "DDC 045: ‘­á¢£˜ 6669 €›ç¤˜«ž ž › ˜š¨˜­ã!\n†£/¤å˜ ¡å¤ž©žª §¨¦šœ¤â©«œ¨ž ž£/¤å˜ª ¡¢œ ›é£˜«¦ª" to lsError_Message
48594>>>>>>>            Case Break
48595>>>>>>>
48595>>>>>>>
48595>>>>>>>            Case (iError_Num = 8833)
48598>>>>>>>                Move "DDC 045:€›ç¤˜«ž ž œšš¨˜­ã!\n˜¥å˜ ¡˜  §¦©æ«ž«˜ œå¤˜  0" to lsError_Message
48599>>>>>>>            Case Break
48600>>>>>>>            Case (iError_Num = 8844)
48603>>>>>>>                Move "DDC 045: ’¦ ¬§æ¢¦ §¦ §¦©æ«ž«˜ª ˜§¦Ÿã¡žª §¨¦¡ç§«œ  ˜¨¤ž« ¡æ \n† «¨â®¦¬©˜ ¡å¤ž©ž ƒ„Œ Ÿ˜ ¡˜«˜®à¨žŸœå" to lsError_Message
48604>>>>>>>            Case Break
48605>>>>>>>            Case (iError_Num = 8877)
48608>>>>>>>                Move "DDC 045:€›ç¤˜«ž ž œšš¨˜­ž!\n\n†£œ¨¦£ž¤åœª œ¡«æª ¦¨åà¤ ®¨ã©žª" to lsError_Message
48609>>>>>>>            Case Break
48610>>>>>>>            Case (iError_Num = 8878)
48613>>>>>>>                Move "DDC 045:€›ç¤˜«ž ž œšš¨˜­ã!\n\„®œ  «¬§àŸœ  Ÿœà¨ž£â¤¦" to lsError_Message
48614>>>>>>>            Case Break
48615>>>>>>>            Case (iError_Num = 8879)
48618>>>>>>>                Move "DDC 045:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\„®œ  «¬§àŸœ  Ÿœà¨ž£â¤¦" to lsError_Message
48619>>>>>>>            Case Break
48620>>>>>>>            Case Else
48620>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
48622>>>>>>>        Case End
48622>>>>>>>        Error iError_Num lsError_Message
48623>>>>>>>>
48623>>>>>>>    End_Procedure // operation_not_allowed
48624>>>>>>>
48624>>>>>>>    Procedure Save_Main_File
48625>>>>>>>        If (Operation_Origin<>Self) Begin
48627>>>>>>>            If Wcmoves.Recnum Eq 0 Procedure_Return
48630>>>>>>>        End
48630>>>>>>>>
48630>>>>>>>        If (WCmoves.Cn_Code<>'') Begin
48632>>>>>>>            Clear Cn
48633>>>>>>>            Move WCmoves.Cn_Code    to Cn.Cn_Code
48634>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
48635>>>>>>>>
48635>>>>>>>            Move Cn.Cn_Sls_ID       to WCmoves.Sls_ID
48636>>>>>>>            Move Cn.CN_Cnt_ID       to WCmoves.Cnt_ID
48637>>>>>>>            Move Cn.Cn_Recr         to WCmoves.Cn_Recr
48638>>>>>>>            Move Cn.mhxanik_id      to Wcmoves.mhxanik_ID
48639>>>>>>>        End
48639>>>>>>>>
48639>>>>>>>        Else Begin
48640>>>>>>>            Move ''     to WCmoves.Sls_ID
48641>>>>>>>            Move ''     to WCmoves.Cnt_ID
48642>>>>>>>            Move ''     to WCmoves.Cn_Recr
48643>>>>>>>            Move ''     to Wcmoves.Mhxanik_ID
48644>>>>>>>        End
48644>>>>>>>>
48644>>>>>>>
48644>>>>>>>        Forward Send Save_Main_File
48646>>>>>>>    End_Procedure   // Save_Main_File
48647>>>>>>>
48647>>>>>>>    Procedure Enhm_Wam Number anQtyEisa Number anQtyExa Number anXre Number anPis Integer iSign
48648>>>>>>>        Integer isFound ifromxrhsh
48649>>>>>>>        get pifromxrhsh to ifromxrhsh
48650>>>>>>>        Move 0 to isFound
48651>>>>>>>
48651>>>>>>>        // 02/10/2001 js
48651>>>>>>>        // Klhsh apo Backout kai Update
48651>>>>>>>        Clear Wam
48652>>>>>>>        Move SysCurXR.Company_Code  to Wam.Company_Code
48653>>>>>>>        Move SysCurXR.Branch_Code   to Wam.Branch_Code
48654>>>>>>>        // ¡ ¤ã©œ ª ˜§¦š¨˜­ãª ¤˜ œ¤ž£œ¨é©¦¬¤ ˜§æŸœ£˜ ¤â˜ª ®¨ã©žª
48654>>>>>>>        if (ifromxrhsh=1) move (syscurxr.year_year+1) to wam.year_year
48657>>>>>>>        else              Move SysCurXR.Year_Year     to Wam.Year_Year
48659>>>>>>>        Move Wapokat.Wapokat_Code   to Wam.Wapokat_Code
48660>>>>>>>        Move Wapomast.Wapomast_Code to Wam.Wapomast_Code
48661>>>>>>>        Move Wax.Wax_Code           to Wam.Wax_Code
48662>>>>>>>        Move Witemkat.Witemkat_Code to Wam.Witemkat_Code
48663>>>>>>>        Move Units.Units_Code       to Wam.Units_Code
48664>>>>>>>        Move Item.Item_Code         to Wam.Item_Code
48665>>>>>>>        Move Witemx.Witemx_Code     to Wam.Witemx_Code
48666>>>>>>>        Find Eq Wam By Index.1
48667>>>>>>>>
48667>>>>>>>        If (Not(Found)) Begin
48669>>>>>>>            Move (SysrecW.Wam_Rec0+1)   to Wam.Wam_Rec0
48670>>>>>>>            Move (SysrecW.Wam_Rec0+1)   to SysrecW.Wam_Rec0
48671>>>>>>>            Saverecord SysrecW
48672>>>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                             (Trim(String(Wam.Wam_Rec0)))))) to Wam.Wam_Recr
48673>>>>>>>            Move Witemx.Witemx_Recr to Wam.Witemx_Recr
48674>>>>>>>            Move Wax.Wax_Recr       to Wam.Wax_Recr
48675>>>>>>>        End
48675>>>>>>>>
48675>>>>>>>        Add (anQtyEisa*iSign)       to Wam.Wam_qty_Eisa
48676>>>>>>>        Add (anQtyExa *iSign)       to Wam.Wam_qty_Exa
48677>>>>>>>        Add (anXre    *iSign)       to Wam.Wam_Amt_Eisa
48678>>>>>>>        Add (anPis    *iSign)       to Wam.Wam_Amt_Exa
48679>>>>>>>
48679>>>>>>>        Move (Wam.Wam_Qty_Eisa-Wam.Wam_Qty_Exa) to Wam.Wam_Qty_Apoth
48680>>>>>>>        Move (Wam.Wam_Amt_Eisa-Wam.Wam_Amt_Exa) to Wam.Wam_Amt_Apoth
48681>>>>>>>
48681>>>>>>>        Saverecord Wam
48682>>>>>>>
48682>>>>>>>        If (Sysfile.Chk_Apothema='1') Begin
48684>>>>>>>            If ((Wam.Wam_qty_Exa  >Wam.Wam_qty_Eisa) Or ;                (Wam.Wam_Qty_Apoth<0)) Send Operation_Not_Allowed 8844
48687>>>>>>>        End
48687>>>>>>>>
48687>>>>>>>        // 02/10/2001 js
48687>>>>>>>    End_Procedure
48688>>>>>>>
48688>>>>>>>    // Update:
48688>>>>>>>    Procedure Update
48689>>>>>>>        integer ifromxrhsh
48690>>>>>>>        Number nx np nqtyx nqtyp
48690>>>>>>>        Forward Send Update
48692>>>>>>>        get pifromxrhsh to ifromxrhsh
48693>>>>>>>        // Insert Code Here
48693>>>>>>>        Move SysCurXR.Company_Code  to WCmoves.Company_Code
48694>>>>>>>        Move SysCurXR.Branch_Code   to WCmoves.Branch_Code
48695>>>>>>>        // ¤˜ š¨á¯œ  ˜§¦š¨˜­ã ©«¦ œ«¦ª + 1
48695>>>>>>>        if (ifromxrhsh=1) move (syscurxr.year_year+1) to wcmoves.year_year
48698>>>>>>>        else              Move SysCurXR.Year_Year     to Wcmoves.Year_Year
48700>>>>>>>       // Move SysCurXR.Year_Year     to WCmoves.Year_Year
48700>>>>>>>        Move Wtypkin.Wtypkin_Code   to WCmoves.Wtypkin_Code
48701>>>>>>>        Move Wapokat.Wapokat_Code   to WCmoves.Wapokat_Code
48702>>>>>>>        Move Wapomast.Wapomast_Code to WCmoves.Wapomast_Code
48703>>>>>>>        Move Wax.Wax_Code           to WCmoves.Wax_Code
48704>>>>>>>        Move Witemkat.Witemkat_Code to WCmoves.Witemkat_Code
48705>>>>>>>        Move Units.Units_Code       to WCmoves.Units_Code
48706>>>>>>>        Move Item.Item_Code         to WCmoves.Item_Code
48707>>>>>>>        Move Witemx.Witemx_Code     to WCmoves.Witemx_Code
48708>>>>>>>
48708>>>>>>>
48708>>>>>>>        Move 0 to nx
48709>>>>>>>        Move 0 to np
48710>>>>>>>        Move 0 to nqtyx
48711>>>>>>>        Move 0 to nqtyp
48712>>>>>>>
48712>>>>>>>        // js 13/02/2002
48712>>>>>>>        // An ta extra pedia timon den exoun timh tote to wcmoves enhmeronei me axies
48712>>>>>>>        If (Wcmoves.Wcmov_Axia=0) Begin
48714>>>>>>>                 If (Wcmoves.Wcmove_X0<>0)  Move Wcmoves.Wcmov_Totamad0 to nx
48717>>>>>>>            Else If (Wcmoves.Wcmove_P0<>0)  Move Wcmoves.Wcmov_Totamad0 to np
48721>>>>>>>        End
48721>>>>>>>>
48721>>>>>>>        // An ta extra pedia posothton den exoun timh tote to wcmoves enhmeronei me posothtes
48721>>>>>>>        If ((Wcmoves.Sx_Posothta_Eis=0) And (Wcmoves.Sx_Posothta_Ex=0)) Begin
48723>>>>>>>                 If (Wcmoves.Wcmove_Qty_Eisa<>0) Move Wcmoves.Wcmove_Qty_Eisa   to nqtyx
48726>>>>>>>            Else If (Wcmoves.Wcmove_Qty_Exa <>0) Move Wcmoves.Wcmove_Qty_Exa    to nqtyp
48730>>>>>>>        End
48730>>>>>>>>
48730>>>>>>>
48730>>>>>>>        Add nqtyx   to witemx.qty_xre
48731>>>>>>>        Add nqtyp   to witemx.qty_pis
48732>>>>>>>        Add nx      to witemx.axia_xre
48733>>>>>>>        Add np      to witemx.axia_pis
48734>>>>>>>
48734>>>>>>>        // 02/10/2001 Enhmerosh arxeiou WAM
48734>>>>>>>        Send Enhm_Wam   nqtyx   ;                        nqtyp   ;                        nx      ;                        np      ;                        1
48735>>>>>>>
48735>>>>>>>        If (Wcmoves.Wcmove_SC_Code2='') ;             Move SyscurXr.C_Code0 to Wcmoves.Wcmove_SC_Code2
48738>>>>>>>
48738>>>>>>>
48738>>>>>>>    End_Procedure   // Update
48739>>>>>>>
48739>>>>>>>     // Backout:
48739>>>>>>>    Procedure Backout
48740>>>>>>>        Number nx np nqtyx nqtyp
48741>>>>>>>        Forward Send Backout
48743>>>>>>>
48743>>>>>>>        Move 0 to nx
48744>>>>>>>        Move 0 to np
48745>>>>>>>        Move 0 to nqtyx
48746>>>>>>>        Move 0 to nqtyp
48747>>>>>>>
48747>>>>>>>        // js 13/02/2002
48747>>>>>>>        // An ta extra pedia timon den exoun timh tote to wcmoves enhmeronei me axies
48747>>>>>>>        If (Wcmoves.Wcmov_Axia=0) Begin
48749>>>>>>>                 If (Wcmoves.Wcmove_X0<>0)  Move Wcmoves.Wcmov_Totamad0 to nx
48752>>>>>>>            Else If (Wcmoves.Wcmove_P0<>0)  Move Wcmoves.Wcmov_Totamad0 to np
48756>>>>>>>        End
48756>>>>>>>>
48756>>>>>>>        // An ta extra pedia posothton den exoun timh tote to wcmoves enhmeronei me posothtes
48756>>>>>>>        If ((Wcmoves.Sx_Posothta_Eis=0) And (Wcmoves.Sx_Posothta_Ex=0)) Begin
48758>>>>>>>                 If (Wcmoves.Wcmove_Qty_Eisa<>0) Move Wcmoves.Wcmove_Qty_Eisa   to nqtyx
48761>>>>>>>            Else If (Wcmoves.Wcmove_Qty_Exa <>0) Move Wcmoves.Wcmove_Qty_Exa    to nqtyp
48765>>>>>>>        End
48765>>>>>>>>
48765>>>>>>>
48765>>>>>>>        Sub nqtyx  From witemx.qty_xre
48766>>>>>>>        Sub nqtyp  From witemx.qty_pis
48767>>>>>>>        Sub nx     From witemx.axia_xre
48768>>>>>>>        Sub np     From witemx.axia_pis
48769>>>>>>>
48769>>>>>>>        // 02/10/2001 Enhmerosh arxeiou WAM
48769>>>>>>>        Send Enhm_Wam   nqtyx   ;                        nqtyp   ;                        nx      ;                        np      ;                        -1
48770>>>>>>>    End_Procedure   // Backout
48771>>>>>>>
48771>>>>>>>
48771>>>>>>>    // Creating:
48771>>>>>>>     Procedure Creating
48772>>>>>>>        Forward Send Creating
48774>>>>>>>        // Insert Code Here
48774>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wcmoves.Wcmove_Rec0)))))) to Wcmoves.Wcmove_Recr
48775>>>>>>>        If (Wcmoves.Wcmove_SC_Code2='') Move SyscurXr.C_Code0 to Wcmoves.Wcmove_SC_Code2
48778>>>>>>>    End_Procedure   // Creating
48779>>>>>>>
48779>>>>>>>    // Define_Fields:
48779>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48779>>>>>>>
48779>>>>>>>   Procedure Entry_wcmoves_date Integer iField Date dDate
48780>>>>>>>         Local Integer Changed
48781>>>>>>>         Get Field_Changed_State iField to Changed
48782>>>>>>>         If ( Changed=0 AND dDate = 0) Begin
48784>>>>>>>           SysDate4 dDate
48785>>>>>>>           Set Field_Default_Value iField to dDate
48786>>>>>>>         End
48786>>>>>>>>
48786>>>>>>>   End_Procedure
48787>>>>>>>
48787>>>>>>>
48787>>>>>>>    Procedure Define_Fields
48788>>>>>>>        Forward Send Define_Fields
48790>>>>>>>        //DDB-Generated-Code-Location
48790>>>>>>>        //DDB-DefineFieldStart
48790>>>>>>>
48790>>>>>>>        Set Main_File            To Wcmoves.File_Number
48791>>>>>>>        Set Cascade_Delete_State To FALSE
48792>>>>>>>
48792>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48793>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48794>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48795>>>>>>>
48795>>>>>>>        // Parent (Server) file structure...............
48795>>>>>>>        Send Add_Server_File  Wtypkin.File_Number
48796>>>>>>>        Send Add_Server_File  Wax.File_Number
48797>>>>>>>        Send Add_Server_File  Witemx.File_Number
48798>>>>>>>
48798>>>>>>>        // External (System) file structure.............
48798>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
48799>>>>>>>        Send Add_System_File  Wam.File_Number  DD_LOCK_ON_ALL
48800>>>>>>>
48800>>>>>>>        Define_Auto_Increment  Sysrecw.Wcmoves_Rec0  To Wcmoves.Wcmove_Rec0
48803>>>>>>>
48803>>>>>>>        // Field-based properties.......................
48803>>>>>>>
48803>>>>>>>        // Wcmoves.Company_Code
48803>>>>>>>
48803>>>>>>>        // Wcmoves.Branch_Code
48803>>>>>>>
48803>>>>>>>        // Wcmoves.Year_Year
48803>>>>>>>
48803>>>>>>>        // Wcmoves.Wtypkin_Code
48803>>>>>>>
48803>>>>>>>        // Wcmoves.Wapokat_Code
48803>>>>>>>
48803>>>>>>>        // Wcmoves.Wapomast_Code
48803>>>>>>>
48803>>>>>>>        // Wcmoves.Wax_Code
48803>>>>>>>
48803>>>>>>>        // Wcmoves.Witemkat_Code
48803>>>>>>>
48803>>>>>>>        // Wcmoves.Units_Code
48803>>>>>>>
48803>>>>>>>        // Wcmoves.Item_Code
48803>>>>>>>
48803>>>>>>>        // Wcmoves.Witemx_Code
48803>>>>>>>
48803>>>>>>>        // Wcmoves.Wcmove_Recr
48803>>>>>>>
48803>>>>>>>        // Wcmoves.Wcmove_Rec0
48803>>>>>>>
48803>>>>>>>        // Wcmoves.Wcmove_Hmnia
48803>>>>>>>        Set Field_Entry_msg        Field Wcmoves.Wcmove_Hmnia To Entry_wcmoves_date
48804>>>>>>>        Set Field_Mask_Type        Field Wcmoves.Wcmove_Hmnia To MASK_DATE_WINDOW
48805>>>>>>>        Set Field_Prompt_Object    Field Wcmoves.Wcmove_Hmnia To (sl045(Self))
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Wtypkin_Recr
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Wax_Recr
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Witemx_Recr
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Wcmove_Par
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Partl_Recr
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Wcmove_Axia
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Wcmove_X0
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Wcmove_P0
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Wcmove_X00
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Wcmove_P00
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Wcmove_X1
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Wcmove_P1
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Wcmove_X2
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Wcmove_P2
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Wcmove_Dlixis
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Wcmove_A_Code
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Wcmove_Status_E
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Wcmove_Status_A
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Wcmove_S0
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Wcmove_Ys0
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Wcmove_S1
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Wcmove_Ys1
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Wcmove_S2
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Wcmove_Ys2
48806>>>>>>>
48806>>>>>>>        // Wcmoves.Wcmove_Sc_Code2
48806>>>>>>>        Set Field_Prompt_Object    Field Wcmoves.Wcmove_Sc_Code2 To (slNomism(Self))
48807>>>>>>>
48807>>>>>>>        // Wcmoves.Wcmove_Open
48807>>>>>>>
48807>>>>>>>        // Wcmoves.Wcmove_Aopen
48807>>>>>>>
48807>>>>>>>        // Wcmoves.Wcmove_Yn_Myf
48807>>>>>>>
48807>>>>>>>        // Wcmoves.Wcmove_Myf_Axia
48807>>>>>>>
48807>>>>>>>        // Wcmoves.Wcmove_Kk
48807>>>>>>>
48807>>>>>>>        // Wcmoves.Wcmove_C_Code2
48807>>>>>>>        Set Field_Prompt_Object    Field Wcmoves.Wcmove_C_Code2 To (slNomism(Self))
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Client_Recr
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Cn_Code
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmove_Qty
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmov_Totambd0
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmov_Discam0
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmov_Totamad0
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmov_Vatam0
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmov_Extra0
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmov_Totambd00
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmov_Discam00
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmov_Totamad00
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmov_Vatam00
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmov_Extra00
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmov_Totambd1
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmov_Discam1
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmov_Totamad1
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmov_Vatam1
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmov_Extra1
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmove_Qty_Exa
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmove_Qty_Eisa
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Client_Id
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Module_From
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Unit_Price0
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Unit_Price00
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Unit_Pricer
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Cn_Recr
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Sls_Id
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Cnt_Id
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Presp_Id
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Mhxanik_Id
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Prn_Theor
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Extra_Axia
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Extra_Axia0
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Extra_Axia00
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Extra_Axiar
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Disc_Axia
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Disc_Axia0
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Disc_Axia00
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Disc_Axiar
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Unit_Price
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Particle_Recr
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Sx_Posothta_Eis
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Sx_Posothta_Ex
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmov_Axia
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmov_X0
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmov_X00
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmov_X1
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmov_X2
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmov_P0
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmov_P00
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmov_P1
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmov_P2
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Unit_Pric0
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Unit_Pric00
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Unit_Pricr
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmo_Totambd0
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmo_Totambd00
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmo_Totambd1
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmo_Discam0
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmo_Discam00
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmo_Discam1
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmo_Totamad0
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmo_Totamad00
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmo_Totamad1
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmo_Vatam0
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmo_Vatam00
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmo_Vatam1
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmo_Extra0
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmo_Extra00
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Wcmo_Extra1
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Sap_Hmnia
48808>>>>>>>
48808>>>>>>>        // Wcmoves.Texnikh
48808>>>>>>>
48808>>>>>>>        //DDB-DefineFieldEnd
48808>>>>>>>    End_Procedure    // Define_Fields
48809>>>>>>>
48809>>>>>>>    // Field_Defaults:
48809>>>>>>>    // This procedure is used to establish default field values.
48809>>>>>>>
48809>>>>>>>    Procedure Field_Defaults
48810>>>>>>>        Forward Send Field_Defaults
48812>>>>>>>        //DDB-Generated-Code-Location
48812>>>>>>>        //DDB-FieldDefaultStart
48812>>>>>>>        //DDB-FieldDefaultEnd
48812>>>>>>>    End_Procedure    // Field_Defaults
48813>>>>>>>
48813>>>>>>>
48813>>>>>>>
48813>>>>>>>End_Class    // Wcmoves_DataDictionary
48814>>>>>>>//DDB-Selection-pkg-Start
48814>>>>>>>
48814>>>>>>>Use sl045.SL         // sl045
48814>>>>>>>Use slnomism.sl      // slNomism
48814>>>>>>>
48814>>>>>>>//DDB-Selection-pkg-End
48814>>>>>>>//DDB-FileEnd
48814>>>>>    
48814>>>>>    //AB-IgnoreEnd
48814>>>>>
48814>>>>>    Object sl045 is a dbModalPanelSub
48816>>>>>
48816>>>>>        //AB-StoreTopStart
48816>>>>>        Property String psModule    Public ''
48818>>>>>        Property String psItemxCode Public ''
48820>>>>>        Property date   pddate      Public ''
48822>>>>>        //AB-StoreTopEnd
48822>>>>>
48822>>>>>        Set Label to "‰ ¤ã©œ ª €§¦Ÿã¡žª"
48823>>>>>        Set Size to 279 515
48824>>>>>        Set Location to 0 4
48825>>>>>        Set Exit_Application_Local_State to FALSE
48826>>>>>        Set Modal_State to FALSE
48827>>>>>
48827>>>>>        //AB-DDOStart
48827>>>>>
48827>>>>>        Object Wcmoves_DD is a Wcmoves_DataDictionary
48829>>>>>
48829>>>>>            //AB-StoreStart
48829>>>>>                        
48829>>>>>            Begin_Constraints
48831>>>>>                Constrain wcmoves.company_code  eq syscurxr.company_code
48833>>>>>                Constrain wcmoves.branch_code   eq syscurxr.branch_code
48835>>>>>                Constrain wcmoves.year_year     eq syscurxr.year_year
48837>>>>>                If (psItemxCode(Self)<>'') Begin
48839>>>>>                    Set Ordering to 15
48840>>>>>                    Constrain WCmoves.Witemx_Code Eq (Trim(psItemxCode(Self)))
48842>>>>>                    if (pddate(self)<>'') constrain wcmoves.wcmove_hmnia eq (pddate(self))
48846>>>>>                End
48846>>>>>>
48846>>>>>                Else begin
48847>>>>>                    Set Ordering to 3
48848>>>>>                    if (pddate(self)<>'') constrain wcmoves.wcmove_hmnia eq (pddate(self))
48852>>>>>                End
48852>>>>>>
48852>>>>>            End_Constraints
48855>>>>>            
48855>>>>>            
48855>>>>>            
48855>>>>>            
48855>>>>>            
48855>>>>>            
48855>>>>>            
48855>>>>>            
48855>>>>>            
48855>>>>>            
48855>>>>>            
48855>>>>>            
48855>>>>>            
48855>>>>>            
48855>>>>>            
48855>>>>>            
48855>>>>>            //AB-StoreEnd
48855>>>>>
48855>>>>>        End_Object    // Wcmoves_DD
48856>>>>>
48856>>>>>        Set Main_DD to (Wcmoves_DD(self))
48857>>>>>        Set Server to (Wcmoves_DD(self))
48858>>>>>
48858>>>>>        //AB-DDOEnd
48858>>>>>
48858>>>>>        Object oSelList is a dbListSub
48860>>>>>            Set Main_File to Wcmoves.File_Number
48861>>>>>            Set Size to 229 501
48862>>>>>            Set Location to 2 7
48863>>>>>            Set Auto_Index_State to FALSE
48864>>>>>
48864>>>>>            Begin_Row
48867>>>>>                Entry_Item Wcmoves.Witemx_code
48868>>>>>                Entry_Item (fswax(self,wcmoves.wax_recr))
48869>>>>>                Entry_Item (fswtypkin(self,wcmoves.wtypkin_code))
48870>>>>>                Entry_Item Wcmoves.Wcmove_hmnia
48871>>>>>                Entry_Item Wcmoves.Wcmove_par
48872>>>>>                Entry_Item Wcmoves.Wcmove_axia
48873>>>>>                Entry_Item Wcmoves.Wcmove_qty
48874>>>>>                Entry_Item Wcmoves.Wcmove_sc_code2
48875>>>>>                Entry_Item Wcmoves.Module_from
48876>>>>>            End_Row
48881>>>>>
48881>>>>>            Set Form_Width    item 0 to 85
48882>>>>>            Set Header_Label  item 0 to "„å›¦ª"
48883>>>>>            
48883>>>>>            Set Form_Width    item 1 to 50
48884>>>>>            Set Header_Label  item 1 to "€§¦Ÿã¡ž "
48885>>>>>            
48885>>>>>            Set Form_Width    item 2 to 80
48886>>>>>            Set Header_Label  item 2 to "‰å¤ž©ž"
48887>>>>>            
48887>>>>>            Set Form_Width    item 3 to 51
48888>>>>>            Set Header_Label  item 3 to "†£œ¨/¤å˜"
48889>>>>>            
48889>>>>>            Set Form_Width    item 4 to 65
48890>>>>>            Set Header_Label  item 4 to "€ « ¦¢¦šå˜"
48891>>>>>            
48891>>>>>            Set Form_Width    item 5 to 60
48892>>>>>            Set Header_Label  item 5 to " €¥å˜"
48893>>>>>            
48893>>>>>            Set Form_Width    item 6 to 51
48894>>>>>            Set Header_Label  item 6 to "¦©æ«ž«˜"
48895>>>>>            
48895>>>>>            Set Form_Width    item 7 to 26
48896>>>>>            Set Header_Label  item 7 to "Œ¦£"
48897>>>>>            
48897>>>>>            Set Form_Width    item 8 to 27
48898>>>>>            Set Header_Label  item 8 to "‰ç¡¢"
48899>>>>>            
48899>>>>>
48899>>>>>            //AB-StoreStart
48899>>>>>                                    
48899>>>>>            Procedure End_Construct_Object
48901>>>>>                String  sNom
48902>>>>>                Integer iDecs
48902>>>>>                Forward Send End_Construct_Object
48904>>>>>                Move SysCurxr.C_Code0 to sNom
48905>>>>>                Clear Nomisma
48906>>>>>                Move sNom to Nomisma.Nomisma_Code
48907>>>>>                Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
48908>>>>>>
48908>>>>>                If (Found=1)    Move Nomisma.Dekadika to iDecs
48911>>>>>                Else            Move 0 to iDecs
48913>>>>>                // ˜¨˜›¦®ã: ˜¤ «¦ ™˜© ¡æ ¤¦£ ©£˜ ®¨ã©žª ƒ„Œ œ®œ  ›œ¡˜› ¡á
48913>>>>>                // «æ«œ œ¥' ¦¨ ©£¦ç ™á¦¬£œ œ£œ ª 2
48913>>>>>                If (iDecs=0) Move 2 to iDecs
48916>>>>>                Set Points          Item 5 to       iDecs
48917>>>>>                Set Numeric_Mask    Item 5 to 14    iDecs '*, '
48918>>>>>                Set Points          Item 6 to       2 // ¦©æ«ž«˜
48919>>>>>            End_Procedure
48920>>>>>            
48920>>>>>            Procedure Activate
48922>>>>>                Send Keyaction to ButtonSub1
48923>>>>>                Forward Send Activate
48925>>>>>            End_procedure
48926>>>>>            
48926>>>>>            
48926>>>>>            
48926>>>>>            
48926>>>>>            
48926>>>>>            
48926>>>>>            
48926>>>>>            
48926>>>>>            
48926>>>>>            
48926>>>>>            
48926>>>>>            
48926>>>>>            
48926>>>>>            
48926>>>>>            
48926>>>>>            
48926>>>>>            
48926>>>>>            
48926>>>>>            
48926>>>>>            //AB-StoreEnd
48926>>>>>
48926>>>>>        End_Object    // oSelList
48927>>>>>
48927>>>>>        Object cSyDateForm1 is a cSyDateForm
48929>>>>>            Set Size to 13 75
48930>>>>>            Set Location to 236 51
48931>>>>>            Set Label_Col_Offset to 2
48932>>>>>            Set Label_Justification_Mode to jMode_Right
48933>>>>>            Set Form_Mask Item 0 to "d/M/yyyy"
48934>>>>>
48934>>>>>            //AB-StoreStart
48934>>>>>                                            
48934>>>>>            Procedure Key Integer iKey
48936>>>>>                Integer iRetVal
48937>>>>>                Forward Send Key iKey
48939>>>>>                If (iKey=277) Begin
48941>>>>>                    Send Clear_Me
48942>>>>>                End
48942>>>>>>
48942>>>>>            End_Procedure
48943>>>>>            
48943>>>>>            Procedure Clear_Me
48945>>>>>                Set Value Item 0 to ''
48946>>>>>                Send KeyAction to ButtonSub1
48947>>>>>            End_Procedure
48948>>>>>            
48948>>>>>            Procedure onchange
48950>>>>>                date ddate
48951>>>>>                get value item 0 to ddate
48952>>>>>                set pddate to ddate
48953>>>>>            
48953>>>>>            end_procedure
48954>>>>>            
48954>>>>>            
48954>>>>>            
48954>>>>>            
48954>>>>>            
48954>>>>>            
48954>>>>>            
48954>>>>>            
48954>>>>>            
48954>>>>>            //AB-StoreEnd
48954>>>>>
48954>>>>>        End_Object    // cSyDateForm1
48955>>>>>
48955>>>>>        Object FormSub1 is a FormSub
48957>>>>>            Set Size to 13 75
48958>>>>>            Set Location to 250 51
48959>>>>>            Set Label_Col_Offset to 2
48960>>>>>            Set Prompt_Button_Mode to pb_PromptOn
48961>>>>>
48961>>>>>            //AB-StoreStart
48961>>>>>                                                                                            
48961>>>>>            Set Prompt_Object to (sl22s(Self))
48962>>>>>            
48962>>>>>            
48962>>>>>            Procedure OnChange
48964>>>>>                String sitem
48965>>>>>                Get Value Item 0 to sitem
48966>>>>>                set psitemxcode to sitem
48967>>>>>                Set Value Of FormSub3 Item 0 to (fsitem(Self,sitem))
48968>>>>>            End_Procedure
48969>>>>>            
48969>>>>>            Procedure Key Integer iKey
48971>>>>>                Integer iRetVal
48972>>>>>                Forward Send Key iKey
48974>>>>>                If (iKey=277) Begin
48976>>>>>                    Send Clear_item
48977>>>>>                End
48977>>>>>>
48977>>>>>            End_Procedure
48978>>>>>            
48978>>>>>            Procedure Clear_item
48980>>>>>                Set Value Item 0 to ''
48981>>>>>                Send KeyAction to ButtonSub1
48982>>>>>            End_Procedure
48983>>>>>            
48983>>>>>            
48983>>>>>            
48983>>>>>            
48983>>>>>            
48983>>>>>            
48983>>>>>            
48983>>>>>            
48983>>>>>            
48983>>>>>            //AB-StoreEnd
48983>>>>>
48983>>>>>        End_Object    // FormSub1
48984>>>>>
48984>>>>>        Object FormSub3 is a FormSub
48986>>>>>            Set Size to 13 195
48987>>>>>            Set Location to 250 132
48988>>>>>            Set Color to clBtnFace
48989>>>>>            Set Label_Col_Offset to 2
48990>>>>>            Set Enabled_State to FALSE
48991>>>>>            Set Item_Shadow_State Item 0 to TRUE
48992>>>>>            Set Shadow_State Item 0 to TRUE
48993>>>>>        End_Object    // FormSub3
48994>>>>>
48994>>>>>        Object oOK_bn is a ButtonSub
48996>>>>>            Set Label to "&„§ ¢¦šã"
48997>>>>>            Set Location to 248 397
48998>>>>>
48998>>>>>            //AB-StoreStart
48998>>>>>            Procedure OnClick
49000>>>>>                Send OK To (oSelList(current_object))
49001>>>>>            End_Procedure
49002>>>>>            //AB-StoreEnd
49002>>>>>
49002>>>>>        End_Object    // oOK_bn
49003>>>>>
49003>>>>>        Object oSearch_bn is a ButtonSub
49005>>>>>            Set Label to "€&¤˜ã«ž©ž"
49006>>>>>            Set Location to 248 457
49007>>>>>
49007>>>>>            //AB-StoreStart
49007>>>>>            Procedure OnClick
49009>>>>>                Send Search To (oSelList(current_object))
49010>>>>>            End_Procedure
49011>>>>>            //AB-StoreEnd
49011>>>>>
49011>>>>>        End_Object    // oSearch_bn
49012>>>>>
49012>>>>>        Object ButtonSub1 is a ButtonSub
49014>>>>>            Set Label to "œ¨ æ¨ ©œ"
49015>>>>>            Set Size to 13 50
49016>>>>>            Set Location to 249 337
49017>>>>>            Set Form_FontWeight Item 0 to 600
49018>>>>>
49018>>>>>            //AB-StoreStart
49018>>>>>                                                                                                        
49018>>>>>            Procedure OnClick
49020>>>>>                Send Rebuild_Constraints to Wcmoves_DD
49021>>>>>                Send Beginning_Of_Data to oSelList True
49022>>>>>            End_Procedure // OnClick
49023>>>>>            
49023>>>>>            
49023>>>>>            
49023>>>>>            //AB-StoreEnd
49023>>>>>
49023>>>>>        End_Object    // ButtonSub1
49024>>>>>
49024>>>>>        Object TextBoxSub1 is a TextBoxSub
49026>>>>>            Set Label to "†£/¤å˜"
49027>>>>>            Set Location to 239 5
49028>>>>>            Set Size to 10 31
49029>>>>>        End_Object    // TextBoxSub1
49030>>>>>
49030>>>>>        Object TextBoxSub2 is a TextBoxSub
49032>>>>>            Set Label to "„å›¦ª"
49033>>>>>            Set Location to 251 5
49034>>>>>            Set Size to 12 21
49035>>>>>        End_Object    // TextBoxSub2
49036>>>>>
49036>>>>>
49036>>>>>        //AB-StoreStart
49036>>>>>                        
49036>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49037>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49038>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49039>>>>>        
49039>>>>>        Set Locate_Mode to Center_On_Screen
49040>>>>>        Set Modal_State to True
49041>>>>>        
49041>>>>>        Procedure Activate
49043>>>>>            Forward send Activate
49045>>>>>        End_Procedure
49046>>>>>        
49046>>>>>        Procedure Request_Cancel
49048>>>>>            Set Value Of cSyDateForm1 Item 0 to ''
49049>>>>>            set value of formsub1     item 0 to ''
49050>>>>>            set value of formsub3     item 0 to ''
49051>>>>>            Send Clear to wcmoves_dd
49052>>>>>            Forward Send Request_Cancel
49054>>>>>        End_Procedure
49055>>>>>        
49055>>>>>        
49055>>>>>        
49055>>>>>        
49055>>>>>        
49055>>>>>        
49055>>>>>        
49055>>>>>        
49055>>>>>        
49055>>>>>        
49055>>>>>        
49055>>>>>        //AB-StoreEnd
49055>>>>>
49055>>>>>    End_Object    // sl045
49056>>>>>
49056>>>>>
49056>>>>>    //AB-StoreStart
49056>>>>>                        
49056>>>>>                        
49056>>>>>                        
49056>>>>>    //AB-StoreEnd
49056>>>>>
49056>>>>>//AB/     End_Object    // prj
49056>>>use sl052.sl
INCLUDING FILE: SL052.SL
49056>>>>>//AB/ Project sl052:drivers
49056>>>>>//AB/ Object prj is a Lookup_Project
49056>>>>>//AB/     Set ProjectName to "sl052:drivers"
49056>>>>>//AB/     Set ProjectFileName to "sl052.SL"
49056>>>>>//AB/     Set GenerateFileName to "NONAME"
49056>>>>>
49056>>>>>// Project Object Structure
49056>>>>>//   sl052 is a dbModalPanelSub
49056>>>>>//     Drivers_DD is a DataDictionary
49056>>>>>//     oSelList is a dbListSub
49056>>>>>//     oOK_bn is a ButtonSub
49056>>>>>//     oCancel_bn is a ButtonSub
49056>>>>>//     oSearch_bn is a ButtonSub
49056>>>>>
49056>>>>>// Register all objects
49056>>>>>Register_Object Drivers_DD
49056>>>>>Register_Object oCancel_bn
49056>>>>>Register_Object oOK_bn
49056>>>>>Register_Object oSearch_bn
49056>>>>>Register_Object oSelList
49056>>>>>Register_Object sl052
49056>>>>>
49056>>>>>
49056>>>>>//AB-IgnoreStart
49056>>>>>
49056>>>>>Use DFAllEnt.pkg
49056>>>>>Use dbList.Sub
49056>>>>>Use Button.Sub
49056>>>>>
49056>>>>>
49056>>>>>Use DRIVERS.DD
INCLUDING FILE: DRIVERS.DD
49056>>>>>>>//DDB-FileStart
49056>>>>>>>//DDB-HeaderStart
49056>>>>>>>
49056>>>>>>>// File Name : DRIVERS.DD
49056>>>>>>>// Class Name: Drivers_DataDictionary
49056>>>>>>>// Revision  : 18
49056>>>>>>>// Version   : 2
49056>>>>>>>
49056>>>>>>>Use  Windows           // Basic Definitions
49056>>>>>>>Use  DataDict          // DataDictionary Class Definition
49056>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49056>>>>>>>
49056>>>>>>>Open Drivers
49058>>>>>>>Open Sysrecc
49060>>>>>>>
49060>>>>>>>//DDB-HeaderEnd
49060>>>>>>>//DDB-ValidationStart
49060>>>>>>>
49060>>>>>>>Register_Object Drivers_Driver_Doy_VT
49060>>>>>>>
49060>>>>>>>Object Drivers_Driver_Doy_VT  is a CodeValidationTable
49062>>>>>>>    Set Type_Value        To "DOY"
49063>>>>>>>    Set Validate_State    To FALSE
49064>>>>>>>    Set Allow_Blank_State To TRUE
49065>>>>>>>    //DDB-ValidationCustomStart
49065>>>>>>>    //DDB-ValidationCustomEnd
49065>>>>>>>End_Object   // Drivers_Driver_Doy_VT
49066>>>>>>>//DDB-ValidationEnd
49066>>>>>>>//DDB-SelectionStart
49066>>>>>>>//DDB/ ExternalSelectionList sl052  sl052.SL
49066>>>>>>>Register_Object sl052
49066>>>>>>>//DDB-SelectionEnd
49066>>>>>>>
49066>>>>>>>Class Drivers_DataDictionary  is a DataDictionary_Sec
49067>>>>>>>
49067>>>>>>>    // Define_Fields:
49067>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49067>>>>>>>
49067>>>>>>>    Procedure Update
49068>>>>>>>        Forward Send Update
49070>>>>>>>        // Insert Code Here
49070>>>>>>>        Move SysCurXR.Company_Code  to drivers.driver_company
49071>>>>>>>
49071>>>>>>>        //betolink
49071>>>>>>>        Move SysCurXR.Beto_Site     to drivers.driver_SiteW
49072>>>>>>>        Move drivers.drivers_Rec0   to drivers.driver_SN
49073>>>>>>>        Move drivers.driver_id      to drivers.driver_repmatch
49074>>>>>>>
49074>>>>>>>    End_Procedure   // Update
49075>>>>>>>
49075>>>>>>>     Procedure Creating
49076>>>>>>>        Forward Send Creating
49078>>>>>>>        date ddate
49079>>>>>>>        sysdate4 ddate
49080>>>>>>>        // Insert Code Here
49080>>>>>>>        Get fsgCode_With_Zeroes drivers.drivers_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to drivers.driver_ID
49081>>>>>>>        move ddate to drivers.driver_hmnia
49082>>>>>>>    End_Procedure   // Creating
49083>>>>>>>
49083>>>>>>>
49083>>>>>>>
49083>>>>>>>
49083>>>>>>>    Procedure Define_Fields
49084>>>>>>>        Forward Send Define_Fields
49086>>>>>>>        //DDB-Generated-Code-Location
49086>>>>>>>        //DDB-DefineFieldStart
49086>>>>>>>
49086>>>>>>>        Set Main_File            To Drivers.File_Number
49087>>>>>>>        Set Cascade_Delete_State To FALSE
49088>>>>>>>
49088>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49089>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49090>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49091>>>>>>>
49091>>>>>>>        // External (System) file structure.............
49091>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
49092>>>>>>>
49092>>>>>>>        Define_Auto_Increment  Sysrecc.Drivers_Rec0  To Drivers.Drivers_Rec0
49095>>>>>>>
49095>>>>>>>        // Field-based properties.......................
49095>>>>>>>
49095>>>>>>>        // Drivers.Driver_Recnum
49095>>>>>>>
49095>>>>>>>        // Drivers.Driver_Company
49095>>>>>>>
49095>>>>>>>        // Drivers.Driver_Id
49095>>>>>>>        Set Field_Options          Field Drivers.Driver_Id To DD_AUTOFIND   
49096>>>>>>>        Set Field_Prompt_Object    Field Drivers.Driver_Id To (sl052(Self))
49097>>>>>>>        Set Key_Field_State        Field Drivers.Driver_Id To TRUE
49098>>>>>>>
49098>>>>>>>        // Drivers.Driver_Name
49098>>>>>>>        Set Field_Prompt_Object    Field Drivers.Driver_Name To (sl052(Self))
49099>>>>>>>
49099>>>>>>>        // Drivers.Driver_Doy
49099>>>>>>>        Set Field_Value_Table      Field Drivers.Driver_Doy To (Drivers_Driver_Doy_VT(Self))
49100>>>>>>>
49100>>>>>>>        // Drivers.Driver_Afm
49100>>>>>>>
49100>>>>>>>        // Drivers.Driver_Address
49100>>>>>>>
49100>>>>>>>        // Drivers.Driver_Zipcode
49100>>>>>>>
49100>>>>>>>        // Drivers.Driver_City
49100>>>>>>>
49100>>>>>>>        // Drivers.Driver_Area
49100>>>>>>>
49100>>>>>>>        // Drivers.Driver_Phone
49100>>>>>>>
49100>>>>>>>        // Drivers.Driver_Fax
49100>>>>>>>
49100>>>>>>>        // Drivers.Driver_Mobile
49100>>>>>>>
49100>>>>>>>        // Drivers.Driver_Aoh
49100>>>>>>>
49100>>>>>>>        // Drivers.Driver_Details
49100>>>>>>>
49100>>>>>>>        // Drivers.Driver_Sitew
49100>>>>>>>
49100>>>>>>>        // Drivers.Driver_Sn
49100>>>>>>>
49100>>>>>>>        // Drivers.Driver_Codem
49100>>>>>>>
49100>>>>>>>        // Drivers.Driver_Repmatch
49100>>>>>>>
49100>>>>>>>        // Drivers.Driver_Hmnia
49100>>>>>>>        Set Field_Mask_Type        Field Drivers.Driver_Hmnia To MASK_DATE_WINDOW
49101>>>>>>>
49101>>>>>>>        // Drivers.Drivers_Rec0
49101>>>>>>>
49101>>>>>>>        // Drivers.Driver_Add_No
49101>>>>>>>
49101>>>>>>>        // Drivers.Driver_Nomos
49101>>>>>>>
49101>>>>>>>        // Drivers.Driver_Xora
49101>>>>>>>
49101>>>>>>>        // Drivers.Polh_Recr
49101>>>>>>>
49101>>>>>>>        //DDB-DefineFieldEnd
49101>>>>>>>    End_Procedure    // Define_Fields
49102>>>>>>>
49102>>>>>>>    // Field_Defaults:
49102>>>>>>>    // This procedure is used to establish default field values.
49102>>>>>>>
49102>>>>>>>    Procedure Field_Defaults
49103>>>>>>>        Forward Send Field_Defaults
49105>>>>>>>        //DDB-Generated-Code-Location
49105>>>>>>>        //DDB-FieldDefaultStart
49105>>>>>>>        //DDB-FieldDefaultEnd
49105>>>>>>>    End_Procedure    // Field_Defaults
49106>>>>>>>
49106>>>>>>>End_Class    // Drivers_DataDictionary
49107>>>>>>>//DDB-Selection-pkg-Start
49107>>>>>>>
49107>>>>>>>Use sl052.SL         // sl052
49107>>>>>>>
49107>>>>>>>//DDB-Selection-pkg-End
49107>>>>>>>//DDB-FileEnd
49107>>>>>
49107>>>>>//AB-IgnoreEnd
49107>>>>>
49107>>>>>Object sl052 is a dbModalPanelSub
49109>>>>>    Set Label to "€¨®œå¦ Ž›žšé¤ "
49110>>>>>    Set Size to 148 371
49111>>>>>    Set Location to 4 5
49112>>>>>    Set Exit_Application_Local_State to FALSE
49113>>>>>    Set Modal_State to FALSE
49114>>>>>
49114>>>>>    //AB-DDOStart
49114>>>>>
49114>>>>>    Object Drivers_DD is a Drivers_DataDictionary
49116>>>>>    End_Object    // Drivers_DD
49117>>>>>
49117>>>>>    Set Main_DD to (Drivers_DD(self))
49118>>>>>    Set Server to (Drivers_DD(self))
49119>>>>>
49119>>>>>    //AB-DDOEnd
49119>>>>>
49119>>>>>    Object oSelList is a dbListSub
49121>>>>>        Set Main_File to Drivers.File_Number
49122>>>>>        Set Size to 105 354
49123>>>>>        Set Location to 6 6
49124>>>>>
49124>>>>>        Begin_Row
49127>>>>>            Entry_Item Drivers.Driver_id
49128>>>>>            Entry_Item Drivers.Driver_name
49129>>>>>            Entry_Item Drivers.Driver_afm
49130>>>>>            Entry_Item Drivers.Driver_city
49131>>>>>            Entry_Item Drivers.Driver_phone
49132>>>>>        End_Row
49137>>>>>
49137>>>>>        Set Form_Width    item 0 to 70
49138>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
49139>>>>>        
49139>>>>>        Set Form_Width    item 1 to 100
49140>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
49141>>>>>        
49141>>>>>        Set Form_Width    item 2 to 50
49142>>>>>        Set Header_Label  item 2 to "€.”.‹"
49143>>>>>        
49143>>>>>        Set Form_Width    item 3 to 76
49144>>>>>        Set Header_Label  item 3 to "æ¢ž"
49145>>>>>        
49145>>>>>        Set Form_Width    item 4 to 50
49146>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
49147>>>>>        
49147>>>>>    End_Object    // oSelList
49148>>>>>
49148>>>>>    Object oOK_bn is a ButtonSub
49150>>>>>        Set Label to "&„§ ¢¦šã"
49151>>>>>        Set Location to 114 201
49152>>>>>
49152>>>>>        //AB-StoreStart
49152>>>>>        Procedure OnClick
49154>>>>>            Send OK To (oSelList(current_object))
49155>>>>>        End_Procedure
49156>>>>>        //AB-StoreEnd
49156>>>>>
49156>>>>>    End_Object    // oOK_bn
49157>>>>>
49157>>>>>    Object oCancel_bn is a ButtonSub
49159>>>>>        Set Label to "&€¡ç¨à©ž"
49160>>>>>        Set Location to 114 255
49161>>>>>
49161>>>>>        //AB-StoreStart
49161>>>>>        Procedure OnClick
49163>>>>>            Send Cancel To (oSelList(current_object))
49164>>>>>        End_Procedure
49165>>>>>        //AB-StoreEnd
49165>>>>>
49165>>>>>    End_Object    // oCancel_bn
49166>>>>>
49166>>>>>    Object oSearch_bn is a ButtonSub
49168>>>>>        Set Label to "€&¤˜ã«ž©ž"
49169>>>>>        Set Location to 114 311
49170>>>>>
49170>>>>>        //AB-StoreStart
49170>>>>>        Procedure OnClick
49172>>>>>            Send Search To (oSelList(current_object))
49173>>>>>        End_Procedure
49174>>>>>        //AB-StoreEnd
49174>>>>>
49174>>>>>    End_Object    // oSearch_bn
49175>>>>>
49175>>>>>
49175>>>>>    //AB-StoreStart
49175>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49176>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49177>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49178>>>>>    //AB-StoreEnd
49178>>>>>
49178>>>>>End_Object    // sl052
49179>>>>>
49179>>>>>//AB/ End_Object    // prj
49179>>>Use sl057.sl
49179>>>Use sl058.sl
49179>>>Use sl059.sl
49179>>>Use sl060.sl
INCLUDING FILE: SL060.SL
49179>>>>>//AB/ Project sl060
49179>>>>>//AB/     Object prj is a LOOKUP_Project
49179>>>>>//AB/         Set ProjectName to "sl060"
49179>>>>>//AB/         Set ProjectFileName to "sl060.SL"
49179>>>>>//AB/         Set GenerateFileName to "NONAME"
49179>>>>>
49179>>>>>    //AB-IgnoreStart
49179>>>>>
49179>>>>>
49179>>>>>
49179>>>>>
49179>>>>>    Use ISOTIMIA.DD
INCLUDING FILE: ISOTIMIA.DD
49179>>>>>>>//DDB-FileStart
49179>>>>>>>//DDB-HeaderStart
49179>>>>>>>
49179>>>>>>>// File Name : ISOTIMIA.DD
49179>>>>>>>// Class Name: Isotimia_DataDictionary
49179>>>>>>>// Revision  : 18
49179>>>>>>>// Version   : 2
49179>>>>>>>
49179>>>>>>>Use  Windows           // Basic Definitions
49179>>>>>>>Use  DataDict          // DataDictionary Class Definition
49179>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49179>>>>>>>
49179>>>>>>>Open Isotimia
49181>>>>>>>Open Nomisma
49183>>>>>>>
49183>>>>>>>//DDB-HeaderEnd
49183>>>>>>>//DDB-ValidationStart
49183>>>>>>>
49183>>>>>>>Register_Object Isotimia_Poia_Metatrepei_VT
49183>>>>>>>
49183>>>>>>>Object Isotimia_Poia_Metatrepei_VT  is a DescriptionValidationTable
49185>>>>>>>    Set Allow_Blank_State To TRUE
49186>>>>>>>
49186>>>>>>>    Procedure Fill_List
49188>>>>>>>        Forward Send Fill_List
49190>>>>>>>        Send Add_Table_Value  "€"  "€‚Ž€"
49191>>>>>>>        Send Add_Table_Value  ""  "—Š†‘†"
49192>>>>>>>        Send Add_Table_Value  "F"  "FIXING"
49193>>>>>>>        Send Add_Table_Value  "P"  "PRIVATE"
49194>>>>>>>    End_Procedure    // Fill_List
49195>>>>>>>    //DDB-ValidationCustomStart
49195>>>>>>>    //DDB-ValidationCustomEnd
49195>>>>>>>End_Object   // Isotimia_Poia_Metatrepei_VT
49196>>>>>>>//DDB-ValidationEnd
49196>>>>>>>//DDB-SelectionStart
49196>>>>>>>//DDB/ ExternalSelectionList sl060  sl060.sl
49196>>>>>>>Register_Object sl060
49196>>>>>>>//DDB-SelectionEnd
49196>>>>>>>
49196>>>>>>>Class Isotimia_DataDictionary  is a DataDictionary_Sec
49197>>>>>>>
49197>>>>>>>
49197>>>>>>>    Function Validate_Save  Returns Integer
49198>>>>>>>        Local Integer iReturnVal
49199>>>>>>>        Forward Get Validate_Save  To iReturnVal
49201>>>>>>>        If (Not(iReturnVal)) ;            Begin
49203>>>>>>>                If Isotimia.isotimia_Hmnia eq ''  move 635 to iReturnVal
49206>>>>>>>                if iReturnVal Send Operation_Not_Allowed iReturnVal
49209>>>>>>>            End
49209>>>>>>>>
49209>>>>>>>        Function_Return iReturnVal
49210>>>>>>>    End_Function   // Validate_Save
49211>>>>>>>
49211>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
49212>>>>>>>        if iError_num eq 635 error 635 "ˆ©¦« £åœª => †£œ¨¦£ž¤å˜ ¡œ¤ã "
49215>>>>>>>        else Forward Send Operation_Not_Allowed  iError_Num
49218>>>>>>>    End_Procedure   // Operation_Not_Allowed
49219>>>>>>>
49219>>>>>>>
49219>>>>>>>
49219>>>>>>>    // Creating:
49219>>>>>>>    // This message is sent each time a new record is created in the
49219>>>>>>>    // main file. You should use this to assign field values that
49219>>>>>>>    // apply to the creation of a new record (i.e. assigning a unique ID
49219>>>>>>>    // from a system_file field). Creating is invoked while the database
49219>>>>>>>    // is locked.
49219>>>>>>>
49219>>>>>>>    Procedure Creating
49220>>>>>>>        Forward Send Creating
49222>>>>>>>        // Insert Code Here
49222>>>>>>>        SYSDATE ISOTIMIA.FUP
49223>>>>>>>        Move Nomisma.Kl_Isot_Euro to Isotimia.Isotimia_Euro
49224>>>>>>>    End_Procedure   // Creating
49225>>>>>>>
49225>>>>>>>
49225>>>>>>>    // Update:
49225>>>>>>>    // Use this message to effect changes in related-to files. The
49225>>>>>>>    // Backout message should be designed to reverse the effects of this
49225>>>>>>>    // message. It is invoked while the database is locked.
49225>>>>>>>
49225>>>>>>>    Procedure Update
49226>>>>>>>        Forward Send Update
49228>>>>>>>        // Insert Code Here
49228>>>>>>>        MOVE NOMISMA.NOMISMA_DESCR  TO ISOTIMIA.NOMISMA_DESCR
49229>>>>>>>        MOVE NOMISMA.NOMISMA_SHORT  TO ISOTIMIA.NOMISMA_SHORT
49230>>>>>>>        MOVE NOMISMA.DEKADIKA       TO ISOTIMIA.DEKADIKA
49231>>>>>>>        SYSDATE ISOTIMIA.LUP
49232>>>>>>>    End_Procedure   // Update
49233>>>>>>>
49233>>>>>>>
49233>>>>>>>
49233>>>>>>>
49233>>>>>>>    // Define_Fields:
49233>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49233>>>>>>>
49233>>>>>>>    Procedure Define_Fields
49234>>>>>>>        Forward Send Define_Fields
49236>>>>>>>        //DDB-Generated-Code-Location
49236>>>>>>>        //DDB-DefineFieldStart
49236>>>>>>>
49236>>>>>>>        Set Main_File            To Isotimia.File_Number
49237>>>>>>>        Set Cascade_Delete_State To FALSE
49238>>>>>>>
49238>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49239>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49240>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49241>>>>>>>
49241>>>>>>>        // Parent (Server) file structure...............
49241>>>>>>>        Send Add_Server_File  Nomisma.File_Number
49242>>>>>>>
49242>>>>>>>        // Field-based properties.......................
49242>>>>>>>
49242>>>>>>>        // Isotimia.Nomisma_Code
49242>>>>>>>
49242>>>>>>>        // Isotimia.Isotimia_Hmnia
49242>>>>>>>        Set Field_Prompt_Object    Field Isotimia.Isotimia_Hmnia To (sl060(Self))
49243>>>>>>>
49243>>>>>>>        // Isotimia.Isotimia_Agora
49243>>>>>>>
49243>>>>>>>        // Isotimia.Isotimia_Polhsh
49243>>>>>>>
49243>>>>>>>        // Isotimia.Isotimia_Fixing
49243>>>>>>>
49243>>>>>>>        // Isotimia.Isotimia_Privat
49243>>>>>>>
49243>>>>>>>        // Isotimia.Nomisma_Descr
49243>>>>>>>
49243>>>>>>>        // Isotimia.Nomisma_Short
49243>>>>>>>
49243>>>>>>>        // Isotimia.Fup
49243>>>>>>>
49243>>>>>>>        // Isotimia.Lup
49243>>>>>>>
49243>>>>>>>        // Isotimia.Sxolia
49243>>>>>>>
49243>>>>>>>        // Isotimia.Dekadika
49243>>>>>>>
49243>>>>>>>        // Isotimia.Isotimia_Euro
49243>>>>>>>
49243>>>>>>>        // Isotimia.Poia_Metatrepei
49243>>>>>>>        Set Field_Value_Table      Field Isotimia.Poia_Metatrepei To (Isotimia_Poia_Metatrepei_VT(Self))
49244>>>>>>>
49244>>>>>>>        //DDB-DefineFieldEnd
49244>>>>>>>    End_Procedure    // Define_Fields
49245>>>>>>>
49245>>>>>>>    // Field_Defaults:
49245>>>>>>>    // This procedure is used to establish default field values.
49245>>>>>>>
49245>>>>>>>    Procedure Field_Defaults
49246>>>>>>>        Forward Send Field_Defaults
49248>>>>>>>        //DDB-Generated-Code-Location
49248>>>>>>>        //DDB-FieldDefaultStart
49248>>>>>>>        //DDB-FieldDefaultEnd
49248>>>>>>>    End_Procedure    // Field_Defaults
49249>>>>>>>
49249>>>>>>>End_Class    // Isotimia_DataDictionary
49250>>>>>>>//DDB-Selection-pkg-Start
49250>>>>>>>
49250>>>>>>>Use sl060.sl         // sl060
49250>>>>>>>
49250>>>>>>>//DDB-Selection-pkg-End
49250>>>>>>>//DDB-FileEnd
49250>>>>>
49250>>>>>    //AB-IgnoreEnd
49250>>>>>
49250>>>>>    CD_Popup_Object sl060 is a dbModalPanelSub
49269>>>>>
49269>>>>>        //AB-StoreTopStart
49269>>>>>        Property Integer Fragmasl060 Public 0
49271>>>>>
49271>>>>>        //AB-StoreTopEnd
49271>>>>>
49271>>>>>        Set Minimize_Icon to FALSE
49272>>>>>        set label to "ˆ©¦« £åœª" 
49273>>>>>        Set Size to 148 353
49274>>>>>        Set Location to 4 5
49275>>>>>
49275>>>>>        //AB-DDOStart
49275>>>>>
49275>>>>>        Object Isotimia_DD is a Isotimia_DataDictionary
49277>>>>>
49277>>>>>            //AB-StoreTopStart
49277>>>>>
49277>>>>>            //AB-StoreTopEnd
49277>>>>>
49277>>>>>
49277>>>>>            //AB-StoreStart
49277>>>>>            Begin_Constraints
49279>>>>>                Local Integer liNomisma
49280>>>>>                Get Fragmasl060 to liNomisma
49281>>>>>                If liNomisma ne 0 Constrain Isotimia.Nomisma_Code eq liNomisma
49285>>>>>            End_Constraints
49288>>>>>            //AB-StoreEnd
49288>>>>>
49288>>>>>        End_Object    // Isotimia_DD
49289>>>>>
49289>>>>>        Set Main_DD to (Isotimia_DD(Current_Object))
49290>>>>>        Set Server to (Isotimia_DD(Current_Object))
49291>>>>>
49291>>>>>        //AB-DDOEnd
49291>>>>>
49291>>>>>        Object oSelList is a dbListSub
49293>>>>>
49293>>>>>            //AB-StoreTopStart
49293>>>>>
49293>>>>>            //AB-StoreTopEnd
49293>>>>>
49293>>>>>            Set Main_File to Isotimia.File_Number
49294>>>>>            Set Size to 105 337
49295>>>>>            Set Location to 6 6
49296>>>>>
49296>>>>>            Begin_Row
49299>>>>>                Entry_Item Isotimia.Isotimia_hmnia
49300>>>>>                Entry_Item Isotimia.Isotimia_agora
49301>>>>>                Entry_Item Isotimia.Isotimia_polhsh
49302>>>>>                Entry_Item Isotimia.Isotimia_fixing
49303>>>>>                Entry_Item Isotimia.Isotimia_privat
49304>>>>>            End_Row
49309>>>>>
49309>>>>>            Set Form_Width    item 0 to 53
49310>>>>>            set header_label  item 0 to "†£œ¨¦£ž¤å˜" 
49311>>>>>
49311>>>>>            Set Form_Width    item 1 to 66
49312>>>>>            set header_label  item 1 to "€š¦¨á" 
49313>>>>>
49313>>>>>            Set Form_Width    item 2 to 71
49314>>>>>            set header_label  item 2 to "é¢ž©ž" 
49315>>>>>
49315>>>>>            Set Form_Width    item 3 to 70
49316>>>>>            Set Header_Label  item 3 to "Fixing"
49317>>>>>
49317>>>>>            Set Form_Width    item 4 to 70
49318>>>>>            set header_label  item 4 to "¨¦©à§ ¡ã" 
49319>>>>>
49319>>>>>
49319>>>>>            //AB-StoreStart
49319>>>>>            Property Integer StoreFragmasl060 Public 0
49321>>>>>
49321>>>>>
49321>>>>>            Procedure Store_Defaults
49323>>>>>                   Forward Send Store_Defaults
49325>>>>>                   Set StoreFragmasl060 to (Fragmasl060(Self))
49326>>>>>            End_Procedure
49327>>>>>
49327>>>>>            Procedure ReStore_Defaults
49329>>>>>                   Forward Send ReStore_Defaults
49331>>>>>                   Set Fragmasl060 to (StoreFragmasl060(Self))
49332>>>>>            End_Procedure
49333>>>>>
49333>>>>>            Procedure Activating
49335>>>>>               Forward Send Activating
49337>>>>>               Send Rebuild_Constraints to (Isotimia_DD(Self))
49338>>>>>            End_Procedure
49339>>>>>
49339>>>>>            //AB-StoreEnd
49339>>>>>
49339>>>>>        End_Object    // oSelList
49340>>>>>
49340>>>>>        Object oOK_bn is a ButtonSub
49342>>>>>            set label to "&„§ ¢¦šã" 
49343>>>>>            Set Location to 115 183
49344>>>>>
49344>>>>>            //AB-StoreStart
49344>>>>>            Procedure OnClick
49346>>>>>                Send OK To (oSelList(current_object))
49347>>>>>            End_Procedure
49348>>>>>            //AB-StoreEnd
49348>>>>>
49348>>>>>        End_Object    // oOK_bn
49349>>>>>
49349>>>>>        Object oCancel_bn is a ButtonSub
49351>>>>>            set label to "&€¡ç¨à©ž" 
49352>>>>>            Set Location to 115 238
49353>>>>>
49353>>>>>            //AB-StoreStart
49353>>>>>            Procedure OnClick
49355>>>>>                Send Cancel To (oSelList(current_object))
49356>>>>>            End_Procedure
49357>>>>>            //AB-StoreEnd
49357>>>>>
49357>>>>>        End_Object    // oCancel_bn
49358>>>>>
49358>>>>>        Object oSearch_bn is a ButtonSub
49360>>>>>            set label to "€&¤˜ã«ž©ž" 
49361>>>>>            Set Location to 115 293
49362>>>>>
49362>>>>>            //AB-StoreStart
49362>>>>>            Procedure OnClick
49364>>>>>                Send Search To (oSelList(current_object))
49365>>>>>            End_Procedure
49366>>>>>            //AB-StoreEnd
49366>>>>>
49366>>>>>        End_Object    // oSearch_bn
49367>>>>>
49367>>>>>
49367>>>>>        //AB-StoreStart
49367>>>>>
49367>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49368>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49369>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49370>>>>>        //AB-StoreEnd
49370>>>>>
49370>>>>>    CD_End_Object    // sl060
49372>>>>>>
49372>>>>>
49372>>>>>//AB/     End_Object    // prj
49372>>>Use sl94_1.sl
INCLUDING FILE: SL94_1.SL
49372>>>>>//AB/ Project sl94_1:paraggelies Prom
49372>>>>>//AB/ Object prj is a Lookup_Project
49372>>>>>//AB/     Set ProjectName to "sl94_1:paraggelies Prom"
49372>>>>>//AB/     Set ProjectFileName to "sl94_1.SL"
49372>>>>>
49372>>>>>// Project Object Structure
49372>>>>>//   sl94_1 is a dbModalPanelSub
49372>>>>>//     Country_DD is a DataDictionary
49372>>>>>//     Towns_DD is a DataDictionary
49372>>>>>//     Cities_DD is a DataDictionary
49372>>>>>//     Payresp_DD is a DataDictionary
49372>>>>>//     Areas_DD is a DataDictionary
49372>>>>>//     Clients_DD is a DataDictionary
49372>>>>>//     Clorder_DD is a DataDictionary
49372>>>>>//     oSelList is a dbListSub
49372>>>>>//     oOK_bn is a ButtonSub
49372>>>>>//     oCancel_bn is a ButtonSub
49372>>>>>//     oSearch_bn is a ButtonSub
49372>>>>>
49372>>>>>// Register all objects
49372>>>>>Register_Object Areas_DD
49372>>>>>Register_Object Cities_DD
49372>>>>>Register_Object Clients_DD
49372>>>>>Register_Object Clorder_DD
49372>>>>>Register_Object Country_DD
49372>>>>>Register_Object oCancel_bn
49372>>>>>Register_Object oOK_bn
49372>>>>>Register_Object oSearch_bn
49372>>>>>Register_Object oSelList
49372>>>>>Register_Object Payresp_DD
49372>>>>>Register_Object sl94_1
49372>>>>>Register_Object Towns_DD
49372>>>>>
49372>>>>>
49372>>>>>
49372>>>>>//AB-StoreTopStart
49372>>>>>open nomisma
49374>>>>>//AB-StoreTopEnd
49374>>>>>
49374>>>>>//AB-IgnoreStart
49374>>>>>
49374>>>>>Use DFAllEnt.pkg
49374>>>>>Use dbList.Sub
49374>>>>>Use Button.Sub
49374>>>>>
49374>>>>>
49374>>>>>Use COUNTRY.DD
49374>>>>>Use TOWNS.DD
49374>>>>>Use CITIES.DD
49374>>>>>Use PAYRESP.DD
49374>>>>>Use AREAS.DD
49374>>>>>Use CLIENTS.DD
49374>>>>>Use CLORDER.DD
INCLUDING FILE: CLORDER.DD
49374>>>>>>>//DDB-FileStart
49374>>>>>>>//DDB-HeaderStart
49374>>>>>>>
49374>>>>>>>// File Name : CLORDER.DD
49374>>>>>>>// Class Name: Clorder_DataDictionary
49374>>>>>>>// Revision  : 34
49374>>>>>>>// Version   : 2
49374>>>>>>>
49374>>>>>>>Use  Windows           // Basic Definitions
49374>>>>>>>Use  DataDict          // DataDictionary Class Definition
49374>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49374>>>>>>>
49374>>>>>>>Open Clorder
49376>>>>>>>Open Clorderd
49378>>>>>>>Open Clients
49380>>>>>>>Open Sysrecc
49382>>>>>>>Open Codetype
INCLUDING FILE: CODETYPE.FD
49384>>>>>>>
49384>>>>>>>//DDB-HeaderEnd
49384>>>>>>>//DDB-ValidationStart
49384>>>>>>>
49384>>>>>>>Register_Object Clorder_Tropos_VT
49384>>>>>>>Register_Object Clorder_How_Pay_VT
49384>>>>>>>
49384>>>>>>>Object Clorder_Tropos_VT  is a CodeValidationTable
49386>>>>>>>    Set Type_Value        To "SEND_TERMS"
49387>>>>>>>    Set Validate_State    To FALSE
49388>>>>>>>    Set Allow_Blank_State To TRUE
49389>>>>>>>    Set Table_Title       To "’¨æ§¦  ˜¨á›¦©žª"
49390>>>>>>>    //DDB-ValidationCustomStart
49390>>>>>>>    //DDB-ValidationCustomEnd
49390>>>>>>>End_Object   // Clorder_Tropos_VT
49391>>>>>>>
49391>>>>>>>Object Clorder_How_Pay_VT  is a CodeValidationTable
49393>>>>>>>    Set Type_Value        To "PAY_TERMS"
49394>>>>>>>    Set Validate_State    To FALSE
49395>>>>>>>    Set Allow_Blank_State To TRUE
49396>>>>>>>    Set Table_Title       To "’¨æ§¦  ¢ž¨à£ãª"
49397>>>>>>>    //DDB-ValidationCustomStart
49397>>>>>>>    //DDB-ValidationCustomEnd
49397>>>>>>>End_Object   // Clorder_How_Pay_VT
49398>>>>>>>//DDB-ValidationEnd
49398>>>>>>>//DDB-SelectionStart
49398>>>>>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
49398>>>>>>>Register_Object slNomism
49398>>>>>>>//DDB-SelectionEnd
49398>>>>>>>  
49398>>>>>>>Class Clorder_DataDictionary  is a DataDictionary_Sec
49399>>>>>>>
49399>>>>>>>    // Define_Fields:
49399>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49399>>>>>>>
49399>>>>>>>    Procedure Define_Fields
49400>>>>>>>        Forward Send Define_Fields
49402>>>>>>>        //DDB-Generated-Code-Location
49402>>>>>>>        //DDB-DefineFieldStart
49402>>>>>>>
49402>>>>>>>        Set Main_File            To Clorder.File_Number
49403>>>>>>>        Set Cascade_Delete_State To FALSE
49404>>>>>>>
49404>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49405>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49406>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49407>>>>>>>
49407>>>>>>>        // Child (Client) file structure................
49407>>>>>>>        Send Add_Client_File  Clorderd.File_Number
49408>>>>>>>
49408>>>>>>>        // Parent (Server) file structure...............
49408>>>>>>>        Send Add_Server_File  Clients.File_Number
49409>>>>>>>
49409>>>>>>>        // External (System) file structure.............
49409>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
49410>>>>>>>        Send Add_System_File  Codetype.File_Number  DD_LOCK_ON_ALL
49411>>>>>>>
49411>>>>>>>        // Field-based properties.......................
49411>>>>>>>
49411>>>>>>>        // Clorder.Company_Code
49411>>>>>>>
49411>>>>>>>        // Clorder.Branch_Code
49411>>>>>>>
49411>>>>>>>        // Clorder.Year_Year
49411>>>>>>>
49411>>>>>>>        // Clorder.Aapar
49411>>>>>>>
49411>>>>>>>        // Clorder.Clients_Code
49411>>>>>>>
49411>>>>>>>        // Clorder.Armod
49411>>>>>>>
49411>>>>>>>        // Clorder.Order1_Recr
49411>>>>>>>
49411>>>>>>>        // Clorder.Rec0
49411>>>>>>>
49411>>>>>>>        // Clorder.Recr
49411>>>>>>>
49411>>>>>>>        // Clorder.Our_Date
49411>>>>>>>        Set Field_Mask_Type        Field Clorder.Our_Date To MASK_DATE_WINDOW
49412>>>>>>>
49412>>>>>>>        // Clorder.Rial_Date
49412>>>>>>>        Set Field_Mask_Type        Field Clorder.Rial_Date To MASK_DATE_WINDOW
49413>>>>>>>
49413>>>>>>>        // Clorder.Qty
49413>>>>>>>
49413>>>>>>>        // Clorder.Unitprice
49413>>>>>>>
49413>>>>>>>        // Clorder.Disc
49413>>>>>>>
49413>>>>>>>        // Clorder.Fpa
49413>>>>>>>
49413>>>>>>>        // Clorder.Net
49413>>>>>>>
49413>>>>>>>        // Clorder.Extra
49413>>>>>>>
49413>>>>>>>        // Clorder.Total
49413>>>>>>>
49413>>>>>>>        // Clorder.Aaparprom
49413>>>>>>>
49413>>>>>>>        // Clorder.Tropos
49413>>>>>>>        Set Field_Value_Table      Field Clorder.Tropos To (Clorder_Tropos_VT(Self))
49414>>>>>>>
49414>>>>>>>        // Clorder.Date
49414>>>>>>>        Set Field_Entry_msg        Field Clorder.Date To Entry_clorder_date
49415>>>>>>>        Set Field_Mask_Type        Field Clorder.Date To MASK_DATE_WINDOW
49416>>>>>>>
49416>>>>>>>        // Clorder.How_Pay
49416>>>>>>>        Set Field_Value_Table      Field Clorder.How_Pay To (Clorder_How_Pay_VT(Self))
49417>>>>>>>
49417>>>>>>>        // Clorder.Finish
49417>>>>>>>        Set Field_Mask             Field Clorder.Finish To "#"
49418>>>>>>>        Set Field_Mask_Type        Field Clorder.Finish To MASK_NUMERIC_WINDOW
49419>>>>>>>
49419>>>>>>>        // Clorder.Okey
49419>>>>>>>        Set Field_Mask             Field Clorder.Okey To "#"
49420>>>>>>>        Set Field_Mask_Type        Field Clorder.Okey To MASK_NUMERIC_WINDOW
49421>>>>>>>
49421>>>>>>>        // Clorder.Akyrh
49421>>>>>>>        Set Field_Mask             Field Clorder.Akyrh To "#"
49422>>>>>>>        Set Field_Mask_Type        Field Clorder.Akyrh To MASK_NUMERIC_WINDOW
49423>>>>>>>
49423>>>>>>>        // Clorder.Sxolia
49423>>>>>>>
49423>>>>>>>        // Clorder.Posodtl
49423>>>>>>>
49423>>>>>>>        // Clorder.Qtydtl
49423>>>>>>>
49423>>>>>>>        // Clorder.Nomisma
49423>>>>>>>        Set Field_Prompt_Object    Field Clorder.Nomisma To (slNomism(Self))
49424>>>>>>>
49424>>>>>>>        // Clorder.Module
49424>>>>>>>
49424>>>>>>>        // Clorder.Codetype
49424>>>>>>>
49424>>>>>>>        //DDB-DefineFieldEnd
49424>>>>>>>    End_Procedure    // Define_Fields
49425>>>>>>>
49425>>>>>>>     Procedure Update
49426>>>>>>>        Forward Send Update
49428>>>>>>>        move syscurxr.company_code to clorder.company_code
49429>>>>>>>        move syscurxr.branch_code  to clorder.branch_code
49430>>>>>>>        move syscurxr.year_year    to clorder.year_year
49431>>>>>>>        MOVE CODETYPE.TYPE         to clorder.codetype
49432>>>>>>>        // Insert Code Here
49432>>>>>>>    End_Procedure   // Update
49433>>>>>>>
49433>>>>>>>
49433>>>>>>>
49433>>>>>>>
49433>>>>>>>    Procedure Creating
49434>>>>>>>        if (clorder.module <> '01') move '02' to clorder.module
49437>>>>>>>        if (clorder.module = '01') begin
49439>>>>>>>           move (sysrecc.clorderc_rec0 + 1) to clorder.rec0
49440>>>>>>>           move clorder.rec0 to sysrecc.clorderc_rec0
49441>>>>>>>           saverecord sysrecc
49442>>>>>>>        end
49442>>>>>>>>
49442>>>>>>>        else begin
49443>>>>>>>           move (sysrecc.clorder_rec0 + 1) to clorder.rec0
49444>>>>>>>           move clorder.rec0 to sysrecc.clorder_rec0
49445>>>>>>>           saverecord sysrecc
49446>>>>>>>        end
49446>>>>>>>>
49446>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                         (Trim(String(clorder.rec0)))))) to clorder.recr
49447>>>>>>>        Move clorder.recr to clorder.aapar
49448>>>>>>>        move clorder.date to clients.last_order
49449>>>>>>>    End_Procedure   //
49450>>>>>>>    // Field_Defaults:
49450>>>>>>>    // This procedure is used to establish default field values.
49450>>>>>>>
49450>>>>>>>     Procedure Entry_clorder_date Integer iField Date dDate
49451>>>>>>>         Local Integer Changed
49452>>>>>>>         Get Field_Changed_State iField to Changed
49453>>>>>>>         If ( Changed=0 AND dDate = 0) Begin
49455>>>>>>>           SysDate4 dDate
49456>>>>>>>           Set Field_Default_Value iField to dDate
49457>>>>>>>         End
49457>>>>>>>>
49457>>>>>>>    End_Procedure
49458>>>>>>>
49458>>>>>>>
49458>>>>>>>    Procedure Field_Defaults
49459>>>>>>>        Forward Send Field_Defaults
49461>>>>>>>        //DDB-Generated-Code-Location
49461>>>>>>>        //DDB-FieldDefaultStart
49461>>>>>>>        //DDB-FieldDefaultEnd
49461>>>>>>>    End_Procedure    // Field_Defaults
49462>>>>>>>
49462>>>>>>>End_Class    // Clorder_DataDictionary
49463>>>>>>>//DDB-Selection-pkg-Start
49463>>>>>>>
49463>>>>>>>Use slnomism.sl      // slNomism
49463>>>>>>>
49463>>>>>>>//DDB-Selection-pkg-End
49463>>>>>>>//DDB-FileEnd
49463>>>>>
49463>>>>>//AB-IgnoreEnd
49463>>>>>
49463>>>>>Object sl94_1 is a dbModalPanelSub
49465>>>>>
49465>>>>>    //AB-StoreTopStart
49465>>>>>    
49465>>>>>    property string psmodule public ''
49467>>>>>    property string psclient public ''
49469>>>>>    
49469>>>>>    //AB-StoreTopEnd
49469>>>>>
49469>>>>>    Set Label to "˜¨˜ššœ¢åœª €¤á ¨¦£žŸœ¬«ã"
49470>>>>>    Set Size to 239 506
49471>>>>>    Set Location to 4 5
49472>>>>>    Set Exit_Application_Local_State to FALSE
49473>>>>>    Set Modal_State to FALSE
49474>>>>>
49474>>>>>    //AB-DDOStart
49474>>>>>
49474>>>>>    Object Country_DD is a Country_DataDictionary
49476>>>>>    End_Object    // Country_DD
49477>>>>>
49477>>>>>    Object Towns_DD is a Towns_DataDictionary
49479>>>>>        Set DDO_Server to (Country_DD(self))
49480>>>>>    End_Object    // Towns_DD
49481>>>>>
49481>>>>>    Object Cities_DD is a Cities_DataDictionary
49483>>>>>        Set DDO_Server to (Towns_DD(self))
49484>>>>>    End_Object    // Cities_DD
49485>>>>>
49485>>>>>    Object Payresp_DD is a Payresp_DataDictionary
49487>>>>>    End_Object    // Payresp_DD
49488>>>>>
49488>>>>>    Object Areas_DD is a Areas_DataDictionary
49490>>>>>    End_Object    // Areas_DD
49491>>>>>
49491>>>>>    Object Clients_DD is a Clients_DataDictionary
49493>>>>>        Set DDO_Server to (Cities_DD(self))
49494>>>>>        Set DDO_Server to (Payresp_DD(self))
49495>>>>>        Set DDO_Server to (Areas_DD(self))
49496>>>>>    End_Object    // Clients_DD
49497>>>>>
49497>>>>>    Object Clorder_DD is a Clorder_DataDictionary
49499>>>>>        Set DDO_Server to (Clients_DD(self))
49500>>>>>
49500>>>>>        //AB-StoreStart
49500>>>>>        Procedure OnConstrain
49502>>>>>            Constrain clorder.company_code  eq SysCurXR.Company_Code
49504>>>>>            Constrain clorder.Branch_Code   eq SysCurXR.Branch_Code
49506>>>>>            Constrain clorder.Year_Year     eq SysCurXR.Year_Year
49508>>>>>        
49508>>>>>            If (psModule(Self)<>'') Begin
49510>>>>>                Constrain clorder.Module eq (psModule(Self))
49512>>>>>            End
49512>>>>>>
49512>>>>>            If (psclient(Self)<>'') Begin
49514>>>>>                Constrain clorder.clients_code eq (psclient(Self))
49516>>>>>            End
49516>>>>>>
49516>>>>>        End_Procedure
49517>>>>>        
49517>>>>>        
49517>>>>>        
49517>>>>>        
49517>>>>>        
49517>>>>>        
49517>>>>>        
49517>>>>>        
49517>>>>>        
49517>>>>>        
49517>>>>>        
49517>>>>>        
49517>>>>>        
49517>>>>>        
49517>>>>>        
49517>>>>>        
49517>>>>>        
49517>>>>>        //AB-StoreEnd
49517>>>>>
49517>>>>>    End_Object    // Clorder_DD
49518>>>>>
49518>>>>>    Set Main_DD to (Clorder_DD(self))
49519>>>>>    Set Server to (Clorder_DD(self))
49520>>>>>
49520>>>>>    //AB-DDOEnd
49520>>>>>
49520>>>>>    Object oSelList is a dbListSub
49522>>>>>        Set Main_File to Clorder.File_Number
49523>>>>>        Set Ordering to 1
49524>>>>>        Set Size to 199 493
49525>>>>>        Set Location to 6 6
49526>>>>>        Set Color to 14280447
49527>>>>>        Set CurrentRowColor to 11783679
49528>>>>>        Set CurrentCellColor to 11783679
49529>>>>>
49529>>>>>        Begin_Row
49532>>>>>            Entry_Item Clorder.Aapar
49533>>>>>            Entry_Item Clients.Client_name
49534>>>>>            Entry_Item Clorder.Date
49535>>>>>            Entry_Item Clorder.Armod
49536>>>>>            Entry_Item Clorder.Nomisma
49537>>>>>            Entry_Item Clorder.Total
49538>>>>>            Entry_Item Clorder.Finish
49539>>>>>            Entry_Item Clorder.Okey
49540>>>>>            Entry_Item Clorder.Akyrh
49541>>>>>            Entry_Item Clorder.Rial_date
49542>>>>>        End_Row
49547>>>>>
49547>>>>>        Set Form_Width    item 0 to 52
49548>>>>>        Set Header_Label  item 0 to "€/˜ ˜¨˜šš."
49549>>>>>        
49549>>>>>        Set Form_Width    item 1 to 87
49550>>>>>        Set Header_Label  item 1 to ""
49551>>>>>        
49551>>>>>        Set Form_Width    item 2 to 45
49552>>>>>        Set Header_Label  item 2 to "†£/¤å˜ "
49553>>>>>        
49553>>>>>        Set Form_Width    item 3 to 82
49554>>>>>        Set Header_Label  item 3 to "“§œçŸ¬¤¦ª ‘ç¤«˜¥žª"
49555>>>>>        
49555>>>>>        Set Form_Width    item 4 to 30
49556>>>>>        Set Header_Label  item 4 to "Œæ£"
49557>>>>>        
49557>>>>>        Set Form_Width    item 5 to 69
49558>>>>>        Set Header_Label  item 5 to "‘ç¤.˜¨˜ššœ¢å˜ª"
49559>>>>>        
49559>>>>>        Set Form_Width    item 6 to 17
49560>>>>>        Set Header_Label  item 6 to "Ž‰"
49561>>>>>        Set Column_Checkbox_State  item 6 to True
49562>>>>>        
49562>>>>>        Set Form_Width    item 7 to 33
49563>>>>>        Set Header_Label  item 7 to "„§ ™œ™."
49564>>>>>        Set Column_Checkbox_State  item 7 to True
49565>>>>>        
49565>>>>>        Set Form_Width    item 8 to 30
49566>>>>>        Set Header_Label  item 8 to "€¡¬¨ž"
49567>>>>>        Set Column_Checkbox_State  item 8 to True
49568>>>>>        
49568>>>>>        Set Form_Width    item 9 to 43
49569>>>>>        Set Header_Label  item 9 to "œ¨˜ àŸ."
49570>>>>>        
49570>>>>>
49570>>>>>        //AB-StoreStart
49570>>>>>        Set Points          Item 5 to       2
49571>>>>>        Set Numeric_Mask    Item 5 to 14    2 ' ,*'
49572>>>>>        set ordering to 1
49573>>>>>        Property String Store_Fragma_prom public ""
49575>>>>>        //
49575>>>>>        Procedure Store_Defaults
49577>>>>>           forward send Store_Defaults
49579>>>>>           Set Store_Fragma_prom to (psclient(Self))
49580>>>>>        end_Procedure
49581>>>>>        //
49581>>>>>        Procedure Restore_Defaults
49583>>>>>            forward send Restore_Defaults
49585>>>>>            Set psclient to (Store_Fragma_prom(Self))
49586>>>>>        end_Procedure
49587>>>>>        //
49587>>>>>        
49587>>>>>        
49587>>>>>        
49587>>>>>        Procedure Activating Returns Integer
49589>>>>>            Integer rVal
49590>>>>>            Forward Get Msg_Activating to rVal
49592>>>>>                 if (psmodule(self)='01') set label of sl100 to '‰˜«á¢¦š¦ª œ¢˜«é¤'
49595>>>>>            else if (psmodule(self)='02') set label of sl100 to '‰˜«á¢¦š¦ª ¨¦£žŸœ¬«é¤'
49599>>>>>            Send Rebuild_Constraints to Clorder_DD
49600>>>>>          //  Send Beginning_Of_Data to oSelList True
49600>>>>>            Procedure_Return rVal
49601>>>>>        End_procedure
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        
49602>>>>>        //AB-StoreEnd
49602>>>>>
49602>>>>>    End_Object    // oSelList
49603>>>>>
49603>>>>>    Object oOK_bn is a ButtonSub
49605>>>>>        Set Label to "€§¦›¦®ã"
49606>>>>>        Set Location to 209 334
49607>>>>>
49607>>>>>        //AB-StoreStart
49607>>>>>        Procedure OnClick
49609>>>>>            Send OK To (oSelList(current_object))
49610>>>>>        End_Procedure
49611>>>>>        //AB-StoreEnd
49611>>>>>
49611>>>>>    End_Object    // oOK_bn
49612>>>>>
49612>>>>>    Object oCancel_bn is a ButtonSub
49614>>>>>        Set Label to "€¡ç¨à©ž"
49615>>>>>        Set Location to 209 388
49616>>>>>
49616>>>>>        //AB-StoreStart
49616>>>>>        Procedure OnClick
49618>>>>>            Send Cancel To (oSelList(current_object))
49619>>>>>        End_Procedure
49620>>>>>        //AB-StoreEnd
49620>>>>>
49620>>>>>    End_Object    // oCancel_bn
49621>>>>>
49621>>>>>    Object oSearch_bn is a ButtonSub
49623>>>>>        Set Label to "€¤˜ã«ž©ž"
49624>>>>>        Set Location to 209 444
49625>>>>>
49625>>>>>        //AB-StoreStart
49625>>>>>        Procedure OnClick
49627>>>>>            Send Search To (oSelList(current_object))
49628>>>>>        End_Procedure
49629>>>>>        //AB-StoreEnd
49629>>>>>
49629>>>>>    End_Object    // oSearch_bn
49630>>>>>
49630>>>>>
49630>>>>>    //AB-StoreStart
49630>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49631>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49632>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49633>>>>>    
49633>>>>>    Set Locate_Mode to Center_On_Screen
49634>>>>>    
49634>>>>>    Procedure Activating returns integer
49636>>>>>        string smodule
49637>>>>>        integer rval
49637>>>>>        get psmodule to smodule
49638>>>>>        if (sModule='01') set header_label  of (osellist(self)) item 1 to 'œ¢á«žª'
49641>>>>>        else              set header_label  of (osellist(self)) item 1 to '¨¦£žŸœ¬«ãª'
49643>>>>>        if (sModule='01') set label of sl94_1 to '˜¨˜ššœ¢åœª / œ¢á«ž'
49646>>>>>        else              set label of sl94_1 to '˜¨˜ššœ¢åœª / ¨¦£žŸœ¬«ã'
49648>>>>>        Send Rebuild_Constraints to clorder_DD
49649>>>>>        Send Beginning_Of_Data to oSelList True
49650>>>>>        Procedure_Return rVal
49651>>>>>    
49651>>>>>    End_Procedure
49652>>>>>    
49652>>>>>    
49652>>>>>    
49652>>>>>    
49652>>>>>    
49652>>>>>    
49652>>>>>    
49652>>>>>    
49652>>>>>    
49652>>>>>    
49652>>>>>    
49652>>>>>    
49652>>>>>    
49652>>>>>    
49652>>>>>    
49652>>>>>    
49652>>>>>    
49652>>>>>    //AB-StoreEnd
49652>>>>>
49652>>>>>End_Object    // sl94_1
49653>>>>>
49653>>>>>
49653>>>>>//AB-StoreStart
49653>>>>>                            
49653>>>>>                            
49653>>>>>                            
49653>>>>>//AB-StoreEnd
49653>>>>>
49653>>>>>//AB/ End_Object    // prj
49653>>>Use sl100.sl
49653>>>use sl108.sl
INCLUDING FILE: SL108.SL
49653>>>>>//AB/ Project sl108:polhtes
49653>>>>>//AB/ Object prj is a Lookup_Project
49653>>>>>//AB/     Set ProjectName to "sl108:polhtes"
49653>>>>>//AB/     Set ProjectFileName to "sl108.SL"
49653>>>>>//AB/     Set GenerateFileName to "NONAME"
49653>>>>>
49653>>>>>// Project Object Structure
49653>>>>>//   sl108 is a dbModalPanelSub
49653>>>>>//     Salesmen_DD is a DataDictionary
49653>>>>>//     oSelList is a dbListSub
49653>>>>>//     oOK_bn is a ButtonSub
49653>>>>>//     oCancel_bn is a ButtonSub
49653>>>>>//     oSearch_bn is a ButtonSub
49653>>>>>
49653>>>>>// Register all objects
49653>>>>>Register_Object oCancel_bn
49653>>>>>Register_Object oOK_bn
49653>>>>>Register_Object oSearch_bn
49653>>>>>Register_Object oSelList
49653>>>>>Register_Object Salesmen_DD
49653>>>>>Register_Object sl108
49653>>>>>
49653>>>>>
49653>>>>>//AB-IgnoreStart
49653>>>>>
49653>>>>>Use DFAllEnt.pkg
49653>>>>>Use dbList.Sub
49653>>>>>Use Button.Sub
49653>>>>>
49653>>>>>
49653>>>>>Use SALESMEN.DD
INCLUDING FILE: SALESMEN.DD
49653>>>>>>>//DDB-FileStart
49653>>>>>>>//DDB-HeaderStart
49653>>>>>>>
49653>>>>>>>// File Name : SALESMEN.DD
49653>>>>>>>// Class Name: Salesmen_DataDictionary
49653>>>>>>>// Revision  : 57
49653>>>>>>>// Version   : 2
49653>>>>>>>
49653>>>>>>>Use  Windows           // Basic Definitions
49653>>>>>>>Use  DataDict          // DataDictionary Class Definition
49653>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49653>>>>>>>
49653>>>>>>>Open Salesmen
49655>>>>>>>Open Cn
49657>>>>>>>Open Sysrecc
49659>>>>>>>
49659>>>>>>>//DDB-HeaderEnd
49659>>>>>>>//DDB-ValidationStart
49659>>>>>>>
49659>>>>>>>Register_Object Salesmen_Sls_Doy_VT
49659>>>>>>>
49659>>>>>>>Object Salesmen_Sls_Doy_VT  is a CodeValidationTable
49661>>>>>>>    Set Type_Value        To "DOY"
49662>>>>>>>    Set Allow_Blank_State To TRUE
49663>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
49664>>>>>>>    //DDB-ValidationCustomStart
49664>>>>>>>    //DDB-ValidationCustomEnd
49664>>>>>>>End_Object   // Salesmen_Sls_Doy_VT
49665>>>>>>>//DDB-ValidationEnd
49665>>>>>>>//DDB-SelectionStart
49665>>>>>>>//DDB/ ExternalSelectionList sl108  sl108.sl
49665>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
49665>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
49665>>>>>>>Register_Object sl108
49665>>>>>>>Register_Object sl198
49665>>>>>>>Register_Object sl197
49665>>>>>>>//DDB-SelectionEnd
49665>>>>>>>
49665>>>>>>>Class Salesmen_DataDictionary  is a DataDictionary_Sec
49666>>>>>>> 
49666>>>>>>>    // Save_Main_File:
49666>>>>>>> 
49666>>>>>>>    Procedure Save_Main_File
49667>>>>>>>        If ((Operation_Origin<>Self) And (Salesmen.Sls_ID='')) Procedure_Return
49670>>>>>>>        Forward Send Save_Main_File
49672>>>>>>>    End_Procedure   // Save_Main_File
49673>>>>>>> 
49673>>>>>>>    // Define_Fields:
49673>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49673>>>>>>>     Procedure Update
49674>>>>>>>        Forward Send Update
49676>>>>>>>        // Insert Code Here
49676>>>>>>>        Move SysCurXR.Company_Code  to salesmen.Company_Code
49677>>>>>>>        Move SysCurXR.Branch_Code   to salesmen.Branch_Code
49678>>>>>>>        Move SysCurXR.Year_Year     to salesmen.Year_Year
49679>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
49679>>>>>>>        Move (salesmen.Xreosh-salesmen.Pistosh)   to salesmen.Ypoloipo
49680>>>>>>>        Move (salesmen.Plafon-salesmen.ypoloipo)  to salesmen.Overhead
49681>>>>>>>
49681>>>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
49681>>>>>>>
49681>>>>>>>        //betolink
49681>>>>>>>        Move SysCurXR.Beto_Site      to salesmen.sls_SiteW
49682>>>>>>>        Move salesmen.sls_Rec0       to salesmen.sls_SN
49683>>>>>>>        Move salesmen.sls_id         to salesmen.sls_Repm
49684>>>>>>>
49684>>>>>>>    End_Procedure   // Update
49685>>>>>>>
49685>>>>>>>     Procedure Creating
49686>>>>>>>        Forward Send Creating
49688>>>>>>>        // Insert Code Here
49688>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(salesmen.sls_Rec0))))));                                    to salesmen.sls_Recr
49689>>>>>>>        Move '1'                    to salesmen.sls_Active
49690>>>>>>>        get fsgCode_With_Zeroes salesmen.sls_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to salesmen.sls_ID
49691>>>>>>>    End_Procedure   // Creating
49692>>>>>>>
49692>>>>>>>    Procedure Define_Fields
49693>>>>>>>        Forward Send Define_Fields
49695>>>>>>>        //DDB-Generated-Code-Location
49695>>>>>>>        //DDB-DefineFieldStart
49695>>>>>>>
49695>>>>>>>        Set Main_File            To Salesmen.File_Number
49696>>>>>>>        Set Cascade_Delete_State To FALSE
49697>>>>>>>
49697>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49698>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49699>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49700>>>>>>>
49700>>>>>>>        // Child (Client) file structure................
49700>>>>>>>        Send Add_Client_File  Cn.File_Number
49701>>>>>>>
49701>>>>>>>        // External (System) file structure.............
49701>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
49702>>>>>>>
49702>>>>>>>        Define_Auto_Increment  Sysrecc.Salesmen_Rec0  To Salesmen.Sls_Rec0
49705>>>>>>>
49705>>>>>>>        // Field-based properties.......................
49705>>>>>>>
49705>>>>>>>        // Salesmen.Company_Code
49705>>>>>>>
49705>>>>>>>        // Salesmen.Branch_Code
49705>>>>>>>
49705>>>>>>>        // Salesmen.Year_Year
49705>>>>>>>
49705>>>>>>>        // Salesmen.Sls_Id
49705>>>>>>>        Set Field_Options          Field Salesmen.Sls_Id To DD_AUTOFIND    DD_FINDREQ    
49706>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Id To (sl108(Self))
49707>>>>>>>        Set Key_Field_State        Field Salesmen.Sls_Id To TRUE
49708>>>>>>>
49708>>>>>>>        // Salesmen.Sls_Name
49708>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Name To (sl108(Self))
49709>>>>>>>
49709>>>>>>>        // Salesmen.Sls_Afm
49709>>>>>>>
49709>>>>>>>        // Salesmen.Sls_Rec0
49709>>>>>>>
49709>>>>>>>        // Salesmen.Sls_Recr
49709>>>>>>>
49709>>>>>>>        // Salesmen.Last_Xreosh
49709>>>>>>>
49709>>>>>>>        // Salesmen.Last_Pistosh
49709>>>>>>>
49709>>>>>>>        // Salesmen.Last_Order
49709>>>>>>>
49709>>>>>>>        // Salesmen.Sls_Doy
49709>>>>>>>        Set Field_Value_Table      Field Salesmen.Sls_Doy To (Salesmen_Sls_Doy_VT(Self))
49710>>>>>>>
49710>>>>>>>        // Salesmen.Sls_Address
49710>>>>>>>
49710>>>>>>>        // Salesmen.Sls_City
49710>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_City To (sl198(Self))
49711>>>>>>>
49711>>>>>>>        // Salesmen.Sls_Area
49711>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Area To (sl197(Self))
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Job
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Respons
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Zipcode
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Phone
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Fax
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Mobile
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Aoh
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Email
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Class
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Details
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Sitew
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Codem
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Categfpa
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Fpa
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Public
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Sn
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Repm
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Active
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Reported
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Lastupd
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Markexp
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Catjob
49712>>>>>>>
49712>>>>>>>        // Salesmen.Xreosh
49712>>>>>>>
49712>>>>>>>        // Salesmen.Pistosh
49712>>>>>>>
49712>>>>>>>        // Salesmen.Ypoloipo
49712>>>>>>>
49712>>>>>>>        // Salesmen.Plafon
49712>>>>>>>
49712>>>>>>>        // Salesmen.Overhead
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Add_No
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Nomos
49712>>>>>>>
49712>>>>>>>        // Salesmen.Sls_Xora
49712>>>>>>>
49712>>>>>>>        // Salesmen.Polh_Recr
49712>>>>>>>
49712>>>>>>>        //DDB-DefineFieldEnd
49712>>>>>>>    End_Procedure    // Define_Fields
49713>>>>>>>
49713>>>>>>>    // Field_Defaults:
49713>>>>>>>    // This procedure is used to establish default field values.
49713>>>>>>>
49713>>>>>>>    Procedure Field_Defaults
49714>>>>>>>        Forward Send Field_Defaults
49716>>>>>>>        //DDB-Generated-Code-Location
49716>>>>>>>        //DDB-FieldDefaultStart
49716>>>>>>>        Set Field_Changed_Value   Field Salesmen.Sls_Doy To "0"
49717>>>>>>>        //DDB-FieldDefaultEnd
49717>>>>>>>    End_Procedure    // Field_Defaults
49718>>>>>>>
49718>>>>>>>End_Class    // Salesmen_DataDictionary
49719>>>>>>>//DDB-Selection-pkg-Start
49719>>>>>>>
49719>>>>>>>Use sl108.sl         // sl108
49719>>>>>>>Use sl198.sl         // sl198
49719>>>>>>>Use sl197.SL         // sl197
49719>>>>>>>
49719>>>>>>>//DDB-Selection-pkg-End
49719>>>>>>>//DDB-FileEnd
49719>>>>>
49719>>>>>//AB-IgnoreEnd
49719>>>>>
49719>>>>>Object sl108 is a dbModalPanelSub
49721>>>>>    Set Label to "‹ž«¨é¦ à¢ž«é¤"
49722>>>>>    Set Size to 148 421
49723>>>>>    Set Location to 4 5
49724>>>>>    Set Exit_Application_Local_State to FALSE
49725>>>>>    Set Modal_State to FALSE
49726>>>>>
49726>>>>>    //AB-DDOStart
49726>>>>>
49726>>>>>    Object Salesmen_DD is a Salesmen_DataDictionary
49728>>>>>    End_Object    // Salesmen_DD
49729>>>>>
49729>>>>>    Set Main_DD to (Salesmen_DD(self))
49730>>>>>    Set Server to (Salesmen_DD(self))
49731>>>>>
49731>>>>>    //AB-DDOEnd
49731>>>>>
49731>>>>>    Object oSelList is a dbListSub
49733>>>>>        Set Main_File to Salesmen.File_Number
49734>>>>>        Set Size to 105 408
49735>>>>>        Set Location to 6 6
49736>>>>>
49736>>>>>        Begin_Row
49739>>>>>            Entry_Item Salesmen.Sls_id
49740>>>>>            Entry_Item Salesmen.Sls_name
49741>>>>>            Entry_Item Salesmen.Sls_afm
49742>>>>>            Entry_Item Salesmen.Sls_address
49743>>>>>            Entry_Item Salesmen.Sls_phone
49744>>>>>        End_Row
49749>>>>>
49749>>>>>        Set Form_Width    item 0 to 60
49750>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
49751>>>>>        
49751>>>>>        Set Form_Width    item 1 to 100
49752>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
49753>>>>>        
49753>>>>>        Set Form_Width    item 2 to 60
49754>>>>>        Set Header_Label  item 2 to "€.”.‹"
49755>>>>>        
49755>>>>>        Set Form_Width    item 3 to 125
49756>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
49757>>>>>        
49757>>>>>        Set Form_Width    item 4 to 54
49758>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
49759>>>>>        
49759>>>>>    End_Object    // oSelList
49760>>>>>
49760>>>>>    Object oOK_bn is a ButtonSub
49762>>>>>        Set Label to "&„§ ¢¦šã"
49763>>>>>        Set Location to 117 255
49764>>>>>
49764>>>>>        //AB-StoreStart
49764>>>>>        Procedure OnClick
49766>>>>>            Send OK To (oSelList(current_object))
49767>>>>>        End_Procedure
49768>>>>>        //AB-StoreEnd
49768>>>>>
49768>>>>>    End_Object    // oOK_bn
49769>>>>>
49769>>>>>    Object oCancel_bn is a ButtonSub
49771>>>>>        Set Label to "&€¡ç¨à©ž"
49772>>>>>        Set Location to 117 310
49773>>>>>
49773>>>>>        //AB-StoreStart
49773>>>>>        Procedure OnClick
49775>>>>>            Send Cancel To (oSelList(current_object))
49776>>>>>        End_Procedure
49777>>>>>        //AB-StoreEnd
49777>>>>>
49777>>>>>    End_Object    // oCancel_bn
49778>>>>>
49778>>>>>    Object oSearch_bn is a ButtonSub
49780>>>>>        Set Label to "€&¤˜ã«ž©ž"
49781>>>>>        Set Location to 117 365
49782>>>>>
49782>>>>>        //AB-StoreStart
49782>>>>>        Procedure OnClick
49784>>>>>            Send Search To (oSelList(current_object))
49785>>>>>        End_Procedure
49786>>>>>        //AB-StoreEnd
49786>>>>>
49786>>>>>    End_Object    // oSearch_bn
49787>>>>>
49787>>>>>
49787>>>>>    //AB-StoreStart
49787>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49788>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49789>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49790>>>>>    //AB-StoreEnd
49790>>>>>
49790>>>>>End_Object    // sl108
49791>>>>>
49791>>>>>//AB/ End_Object    // prj
49791>>>use sl182.sl
INCLUDING FILE: SL182.SL
49791>>>>>//AB/ Project sl182:diakiniseis eidon
49791>>>>>//AB/ Object prj is a Lookup_Project
49791>>>>>//AB/     Set ProjectName to "sl182:diakiniseis eidon"
49791>>>>>//AB/     Set ProjectFileName to "sl182.SL"
49791>>>>>//AB/     Set GenerateFileName to "NONAME"
49791>>>>>
49791>>>>>// Project Object Structure
49791>>>>>//   sl182 is a dbModalPanelSub
49791>>>>>//     Witemxtr_DD is a DataDictionary
49791>>>>>//     Witemxtd_DD is a DataDictionary
49791>>>>>//     oSelList is a dbListSub
49791>>>>>//     oOK_bn is a ButtonSub
49791>>>>>//     oCancel_bn is a ButtonSub
49791>>>>>//     oSearch_bn is a ButtonSub
49791>>>>>
49791>>>>>// Register all objects
49791>>>>>Register_Object oCancel_bn
49791>>>>>Register_Object oOK_bn
49791>>>>>Register_Object oSearch_bn
49791>>>>>Register_Object oSelList
49791>>>>>Register_Object sl182
49791>>>>>Register_Object Witemxtd_DD
49791>>>>>Register_Object Witemxtr_DD
49791>>>>>
49791>>>>>
49791>>>>>
49791>>>>>//AB-StoreTopStart
49791>>>>>open wax
49793>>>>>//AB-StoreTopEnd
49793>>>>>
49793>>>>>//AB-IgnoreStart
49793>>>>>
49793>>>>>Use DFAllEnt.pkg
49793>>>>>Use dbList.Sub
49793>>>>>Use Button.Sub
49793>>>>>
49793>>>>>
49793>>>>>Use WITEMXTR.DD
INCLUDING FILE: WITEMXTR.DD
49793>>>>>>>//DDB-FileStart
49793>>>>>>>//DDB-HeaderStart
49793>>>>>>>
49793>>>>>>>// File Name : WITEMXTR.DD
49793>>>>>>>// Class Name: Witemxtr_DataDictionary
49793>>>>>>>// Revision  : 38
49793>>>>>>>// Version   : 2
49793>>>>>>>
49793>>>>>>>Use  Windows           // Basic Definitions
49793>>>>>>>Use  DataDict          // DataDictionary Class Definition
49793>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49793>>>>>>>
49793>>>>>>>Open Witemxtr
INCLUDING FILE: WITEMXTR.FD
49795>>>>>>>Open Witemxtd
INCLUDING FILE: WITEMXTD.FD
49797>>>>>>>Open Sysrecw
49799>>>>>>>Open Branch
49801>>>>>>>Open Year
49803>>>>>>>
49803>>>>>>>//DDB-HeaderEnd
49803>>>>>>>//DDB-SelectionStart
49803>>>>>>>//DDB/ ExternalSelectionList sl182  sl182.SL
49803>>>>>>>//DDB/ ExternalSelectionList sl029a  sl029a.sl
49803>>>>>>>Register_Object sl182
49803>>>>>>>Register_Object sl029a
49803>>>>>>>//DDB-SelectionEnd
49803>>>>>>>
49803>>>>>>>Class Witemxtr_DataDictionary  is a DataDictionary_sec
49804>>>>>>>
49804>>>>>>>    // Define_Fields:
49804>>>>>>>    // This procedure is used to set up all data-dictionary rules. 
49804>>>>>>>    
49804>>>>>>>    Procedure Construct_Object
49805>>>>>>>        Forward Send Construct_Object
49807>>>>>>>        Property Integer piMustNOTConstrain Public 0
49808>>>>>>>    End_Procedure //construct_object
49809>>>>>>>
49809>>>>>>>    Procedure OnConstrain
49810>>>>>>>        Forward Send OnConstrain
49812>>>>>>>        Constrain Witemxtr.Company_Code  eq SysCurXR.Company_Code
49814>>>>>>>        Constrain Witemxtr.Branch_Code   eq SysCurXR.Branch_Code
49816>>>>>>>        Constrain Witemxtr.Year_Year     eq SysCurXR.Year_Year
49818>>>>>>>    End_Procedure
49819>>>>>>>
49819>>>>>>>    // Update:
49819>>>>>>>    Procedure Update
49820>>>>>>>        Forward Send Update
49822>>>>>>>        // Insert Code Here
49822>>>>>>>        Move SysCurXR.Company_Code  to Witemxtr.Company_Code
49823>>>>>>>        Move SysCurXR.Branch_Code   to Witemxtr.Branch_Code
49824>>>>>>>        Move SysCurXR.Year_Year     to Witemxtr.Year_Year
49825>>>>>>>    End_Procedure   // Update
49826>>>>>>>
49826>>>>>>>    Procedure Creating
49827>>>>>>>        Forward Send Creating 
49829>>>>>>>        integer idecs iYearRecnum iBranchRecnum
49830>>>>>>>        string srecr sentolh sAxia
49830>>>>>>>        if ((witemxtr.hmnia < syscurxr.year_xrhshfrom) or (witemxtr.hmnia > syscurxr.year_xrhshto));            error 3009 '†£œ¨¦£ž¤å˜ œ¡«æª ¦¨åà¤ ®¨ã©žª' 
49833>>>>>>>        
49833>>>>>>>        Move Year.Recnum    to iYearRecnum
49834>>>>>>>        Move Branch.Recnum  to iBranchRecnum
49835>>>>>>>        
49835>>>>>>>        Clear Year
49836>>>>>>>        move syscurxr.company_code  to Year.company_code
49837>>>>>>>        move syscurxr.branch_code   to Year.branch_code
49838>>>>>>>        move syscurxr.Year_Year     to Year.Year_Year
49839>>>>>>>        Find Eq Year By Index.1
49840>>>>>>>>
49840>>>>>>>        If (Not(Found)) Error 3001 'Witemxtr Creating - Year not found'
49843>>>>>>>        Move (Year.Year_NumBtypkin + 1) to Witemxtr.Axia
49844>>>>>>>        move (Year.Year_NumBtypkin + 1) to Year.Year_NumBtypkin
49845>>>>>>>        saverecord Year  
49846>>>>>>>        
49846>>>>>>>        clear branch
49847>>>>>>>        move syscurxr.company_code to branch.company_code
49848>>>>>>>        move syscurxr.branch_code  to branch.branch_code
49849>>>>>>>        find eq branch by index.1 
49850>>>>>>>>
49850>>>>>>>        If (Not(Found)) Error 3002 'Witemxtr Creating - Branch not found'
49853>>>>>>>        move (branch.entolh + 1) to branch.entolh
49854>>>>>>>        saverecord branch  
49855>>>>>>>        move branch.entolh to sentolh
49856>>>>>>>        move 5 to idecs
49857>>>>>>>        get fsgCode_n_Zeroes sentolh idecs to srecr
49858>>>>>>>        Get fsgCode_n_Zeroes (Integer(Witemxtr.Axia)) idecs to sAxia
49859>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(srecr)))))) to Witemxtr.Recr
49860>>>>>>>        Move (append('','„¤›¦› ˜¡.œ ›é¤ €¨.§˜¨˜©«. ' +(Trim(SysCurXR.Branch_Site)+Trim(sAxia)))) to witemxtr.descr 
49861>>>>>>>        move saxia to witemxtr.code
49862>>>>>>>        
49862>>>>>>>        If (iYearRecnum) Begin
49864>>>>>>>            Clear Year
49865>>>>>>>            Move iYearRecnum to Year.Recnum
49866>>>>>>>            Find Eq Year.Recnum
49867>>>>>>>>
49867>>>>>>>        End
49867>>>>>>>>
49867>>>>>>>        
49867>>>>>>>        If (iBranchRecnum) Begin
49869>>>>>>>            Clear Branch
49870>>>>>>>            Move iBranchRecnum to Branch.Recnum
49871>>>>>>>            Find Eq Branch.Recnum
49872>>>>>>>>
49872>>>>>>>        End
49872>>>>>>>>
49872>>>>>>>        
49872>>>>>>>    End_Procedure   // Creating    
49873>>>>>>>     
49873>>>>>>>    Procedure Shmera integer iField  Date dDate
49874>>>>>>>        Local Integer Changed
49875>>>>>>>        Get Field_Changed_State iField to Changed
49876>>>>>>>        If (Changed=0 AND dDate =0) Begin
49878>>>>>>>            SysDate4 dDate
49879>>>>>>>            Set Field_Default_Value iField to dDate
49880>>>>>>>        End
49880>>>>>>>>
49880>>>>>>>    End_Procedure   // Shmera
49881>>>>>>>
49881>>>>>>>    // Define_Fields:
49881>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49881>>>>>>>
49881>>>>>>>    Procedure Define_Fields
49882>>>>>>>        Forward Send Define_Fields
49884>>>>>>>        //DDB-Generated-Code-Location
49884>>>>>>>        //DDB-DefineFieldStart
49884>>>>>>>
49884>>>>>>>        Set Main_File            To Witemxtr.File_Number
49885>>>>>>>        Set Cascade_Delete_State To FALSE
49886>>>>>>>
49886>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49887>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49888>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49889>>>>>>>
49889>>>>>>>        // Child (Client) file structure................
49889>>>>>>>        Send Add_Client_File  Witemxtd.File_Number
49890>>>>>>>
49890>>>>>>>        // External (System) file structure.............
49890>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
49891>>>>>>>        Send Add_System_File  Branch.File_Number  DD_LOCK_ON_ALL
49892>>>>>>>        Send Add_System_File  Year.File_Number  DD_LOCK_ON_ALL
49893>>>>>>>
49893>>>>>>>        Define_Auto_Increment  Sysrecw.Witemxtr_Rec0  To Witemxtr.Rec0
49896>>>>>>>
49896>>>>>>>        // Field-based properties.......................
49896>>>>>>>
49896>>>>>>>        // Witemxtr.Company_Code
49896>>>>>>>
49896>>>>>>>        // Witemxtr.Branch_Code
49896>>>>>>>
49896>>>>>>>        // Witemxtr.Year_Year
49896>>>>>>>
49896>>>>>>>        // Witemxtr.Code
49896>>>>>>>
49896>>>>>>>        // Witemxtr.Recr
49896>>>>>>>
49896>>>>>>>        // Witemxtr.Rec0
49896>>>>>>>
49896>>>>>>>        // Witemxtr.Hmnia
49896>>>>>>>        Set Field_Entry_msg        Field Witemxtr.Hmnia To Shmera
49897>>>>>>>        Set Field_Mask_Type        Field Witemxtr.Hmnia To MASK_DATE_WINDOW
49898>>>>>>>        Set Field_Prompt_Object    Field Witemxtr.Hmnia To (sl182(Self))
49899>>>>>>>
49899>>>>>>>        // Witemxtr.Descr
49899>>>>>>>
49899>>>>>>>        // Witemxtr.Wax_From
49899>>>>>>>
49899>>>>>>>        // Witemxtr.Wax_To
49899>>>>>>>
49899>>>>>>>        // Witemxtr.Ekleise
49899>>>>>>>
49899>>>>>>>        // Witemxtr.Qty
49899>>>>>>>
49899>>>>>>>        // Witemxtr.Fpa
49899>>>>>>>
49899>>>>>>>        // Witemxtr.Axia
49899>>>>>>>
49899>>>>>>>        // Witemxtr.Total
49899>>>>>>>
49899>>>>>>>        // Witemxtr.Wtypkin_From
49899>>>>>>>        Set Field_Prompt_Object    Field Witemxtr.Wtypkin_From To (sl029a(Self))
49900>>>>>>>
49900>>>>>>>        // Witemxtr.Wtypkin_To
49900>>>>>>>        Set Field_Prompt_Object    Field Witemxtr.Wtypkin_To To (sl029a(Self))
49901>>>>>>>
49901>>>>>>>        // Witemxtr.From_No
49901>>>>>>>
49901>>>>>>>        // Witemxtr.To_No
49901>>>>>>>
49901>>>>>>>        // Witemxtr.Particle_Recr
49901>>>>>>>
49901>>>>>>>        // Witemxtr.Sap_Hmnia
49901>>>>>>>
49901>>>>>>>        //DDB-DefineFieldEnd
49901>>>>>>>    End_Procedure    // Define_Fields
49902>>>>>>>
49902>>>>>>>    // Field_Defaults:
49902>>>>>>>    // This procedure is used to establish default field values.
49902>>>>>>>
49902>>>>>>>    Procedure Field_Defaults
49903>>>>>>>        Forward Send Field_Defaults
49905>>>>>>>        //DDB-Generated-Code-Location
49905>>>>>>>        //DDB-FieldDefaultStart
49905>>>>>>>        Set Field_Changed_Value   Field Witemxtr.From_No To "1"
49906>>>>>>>        //DDB-FieldDefaultEnd
49906>>>>>>>    End_Procedure    // Field_Defaults
49907>>>>>>>
49907>>>>>>>End_Class    // Witemxtr_DataDictionary
49908>>>>>>>//DDB-Selection-pkg-Start
49908>>>>>>>
49908>>>>>>>Use sl182.SL         // sl182
49908>>>>>>>Use sl029a.sl        // sl029a
49908>>>>>>>
49908>>>>>>>//DDB-Selection-pkg-End
49908>>>>>>>//DDB-FileEnd
49908>>>>>Use WITEMXTD.DD
INCLUDING FILE: WITEMXTD.DD
49908>>>>>>>//DDB-FileStart
49908>>>>>>>//DDB-HeaderStart
49908>>>>>>>
49908>>>>>>>// File Name : WITEMXTD.DD
49908>>>>>>>// Class Name: Witemxtd_DataDictionary
49908>>>>>>>// Revision  : 15
49908>>>>>>>// Version   : 2
49908>>>>>>>
49908>>>>>>>Use  Windows           // Basic Definitions
49908>>>>>>>Use  DataDict          // DataDictionary Class Definition
49908>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49908>>>>>>>
49908>>>>>>>Open Witemxtd
49910>>>>>>>Open Witemxtr
49912>>>>>>>Open Sysrecw
49914>>>>>>>
49914>>>>>>>//DDB-HeaderEnd
49914>>>>>>>//DDB-SelectionStart
49914>>>>>>>//DDB/ ExternalSelectionList SL17  sl17.SL
49914>>>>>>>//DDB/ ExternalSelectionList Wax  wax.sl
49914>>>>>>>Register_Object SL17
49914>>>>>>>Register_Object Wax
49914>>>>>>>//DDB-SelectionEnd
49914>>>>>>>
49914>>>>>>>Class Witemxtd_DataDictionary  is a DataDictionary_sec
49915>>>>>>>
49915>>>>>>>    // Define_Fields:
49915>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49915>>>>>>>   procedure creating 
49916>>>>>>>        Forward Send Creating
49918>>>>>>>        // Insert Code Here
49918>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Witemxtd.Rec0)))))) to Witemxtd.Recr
49919>>>>>>>    End_Procedure   // Creating
49920>>>>>>>    
49920>>>>>>>     Procedure Backout
49921>>>>>>>        Forward Send Backout
49923>>>>>>>
49923>>>>>>>        // Insert Code Here
49923>>>>>>>        sub witemxtd.qty_from       from witemxtr.qty
49924>>>>>>>        
49924>>>>>>>    End_Procedure   // Backout
49925>>>>>>>
49925>>>>>>>
49925>>>>>>>
49925>>>>>>>    Procedure Update
49926>>>>>>>        Forward Send Update
49928>>>>>>>        Add witemxtd.qty_from     to witemxtr.qty
49929>>>>>>>    End_Procedure   // Update
49930>>>>>>>    
49930>>>>>>>    
49930>>>>>>>    
49930>>>>>>>    Procedure Define_Fields
49931>>>>>>>        Forward Send Define_Fields
49933>>>>>>>        //DDB-Generated-Code-Location
49933>>>>>>>        //DDB-DefineFieldStart
49933>>>>>>>
49933>>>>>>>        Set Main_File            To Witemxtd.File_Number
49934>>>>>>>
49934>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49935>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49936>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49937>>>>>>>
49937>>>>>>>        // Parent (Server) file structure...............
49937>>>>>>>        Send Add_Server_File  Witemxtr.File_Number
49938>>>>>>>
49938>>>>>>>        // External (System) file structure.............
49938>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
49939>>>>>>>
49939>>>>>>>        Define_Auto_Increment  Sysrecw.Witemxtd_Rec0  To Witemxtd.Rec0
49942>>>>>>>
49942>>>>>>>        // Field-based properties.......................
49942>>>>>>>
49942>>>>>>>        // Witemxtd.Witemxtr_Recr
49942>>>>>>>
49942>>>>>>>        // Witemxtd.Recr
49942>>>>>>>
49942>>>>>>>        // Witemxtd.Rec0
49942>>>>>>>
49942>>>>>>>        // Witemxtd.Witemx_Code
49942>>>>>>>        Set Field_Prompt_Object    Field Witemxtd.Witemx_Code To (SL17(Self))
49943>>>>>>>
49943>>>>>>>        // Witemxtd.Qty_From
49943>>>>>>>
49943>>>>>>>        // Witemxtd.Unitprice_From
49943>>>>>>>
49943>>>>>>>        // Witemxtd.Fpa_From
49943>>>>>>>
49943>>>>>>>        // Witemxtd.Pcfpa_From
49943>>>>>>>
49943>>>>>>>        // Witemxtd.Axia_From
49943>>>>>>>
49943>>>>>>>        // Witemxtd.Total_From
49943>>>>>>>
49943>>>>>>>        // Witemxtd.Wcmoves_Recr
49943>>>>>>>
49943>>>>>>>        // Witemxtd.Wax_From
49943>>>>>>>        Set Field_Prompt_Object    Field Witemxtd.Wax_From To (Wax(Self))
49944>>>>>>>
49944>>>>>>>        // Witemxtd.Wax_To
49944>>>>>>>        Set Field_Prompt_Object    Field Witemxtd.Wax_To To (Wax(Self))
49945>>>>>>>
49945>>>>>>>        // Witemxtd.Texnikh
49945>>>>>>>
49945>>>>>>>        //DDB-DefineFieldEnd
49945>>>>>>>    End_Procedure    // Define_Fields
49946>>>>>>>
49946>>>>>>>    // Field_Defaults:
49946>>>>>>>    // This procedure is used to establish default field values.
49946>>>>>>>
49946>>>>>>>    Procedure Field_Defaults
49947>>>>>>>        Forward Send Field_Defaults
49949>>>>>>>        //DDB-Generated-Code-Location
49949>>>>>>>        //DDB-FieldDefaultStart
49949>>>>>>>        //DDB-FieldDefaultEnd
49949>>>>>>>    End_Procedure    // Field_Defaults
49950>>>>>>>
49950>>>>>>>End_Class    // Witemxtd_DataDictionary
49951>>>>>>>//DDB-Selection-pkg-Start
49951>>>>>>>
49951>>>>>>>Use sl17.SL          // SL17
INCLUDING FILE: SL17.SL
49951>>>>>>>>>//AB/ Project SL17:witemx
49951>>>>>>>>>//AB/     Object prj is a Lookup_Project
49951>>>>>>>>>//AB/         Set ProjectName to "SL17:witemx"
49951>>>>>>>>>//AB/         Set ProjectFileName to "sl17.SL"
49951>>>>>>>>>
49951>>>>>>>>>// Project Object Structure
49951>>>>>>>>>//   SL17 is a dbModalPanelSub
49951>>>>>>>>>//     Units_DD is a DataDictionary
49951>>>>>>>>>//     Witemkat_DD is a DataDictionary
49951>>>>>>>>>//     Fpa_DD is a DataDictionary
49951>>>>>>>>>//     Item_DD is a DataDictionary
49951>>>>>>>>>//     Witemx_DD is a DataDictionary
49951>>>>>>>>>//     oSelList is a dbListSub
49951>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
49951>>>>>>>>>//     ocode is a FormSub
49951>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
49951>>>>>>>>>//     operi is a FormSub
49951>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
49951>>>>>>>>>//       Radio1 is a RadioSub
49951>>>>>>>>>//       Radio2 is a RadioSub
49951>>>>>>>>>//     ButtonSub1 is a ButtonSub
49951>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
49951>>>>>>>>>//     ocodekat is a FormSub
49951>>>>>>>>>//     oOK_bn is a ButtonSub
49951>>>>>>>>>//     oCancel_bn is a ButtonSub
49951>>>>>>>>>//     oSearch_bn is a ButtonSub
49951>>>>>>>>>//     btnwitemcl is a ButtonSub
49951>>>>>>>>>
49951>>>>>>>>>// Register all objects
49951>>>>>>>>>Register_Object ButtonSub1
49951>>>>>>>>>Register_Object btnwitemcl
49951>>>>>>>>>Register_Object Fpa_DD
49951>>>>>>>>>Register_Object Item_DD
49951>>>>>>>>>Register_Object oCancel_bn
49951>>>>>>>>>Register_Object ocode
49951>>>>>>>>>Register_Object ocodekat
49951>>>>>>>>>Register_Object oOK_bn
49951>>>>>>>>>Register_Object operi
49951>>>>>>>>>Register_Object oSearch_bn
49951>>>>>>>>>Register_Object oSelList
49951>>>>>>>>>Register_Object Radio1
49951>>>>>>>>>Register_Object Radio2
49951>>>>>>>>>Register_Object RadioGroupSub1
49951>>>>>>>>>Register_Object SL17
49951>>>>>>>>>Register_Object TextBoxSub1
49951>>>>>>>>>Register_Object TextBoxSub2
49951>>>>>>>>>Register_Object TextBoxSub3
49951>>>>>>>>>Register_Object Units_DD
49951>>>>>>>>>Register_Object Witemkat_DD
49951>>>>>>>>>Register_Object Witemx_DD
49951>>>>>>>>>
49951>>>>>>>>>
49951>>>>>>>>>
49951>>>>>>>>>    //AB-StoreTopStart
49951>>>>>>>>>    use dg186.dg
INCLUDING FILE: DG186.DG
49951>>>>>>>>>>>//AB/ Project dg186
49951>>>>>>>>>>>//AB/     Object prj is a Dialog_Project
49951>>>>>>>>>>>//AB/         Set ProjectName to "dg186"
49951>>>>>>>>>>>//AB/         Set ProjectFileName to "dg186.DG"
49951>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
49951>>>>>>>>>>>
49951>>>>>>>>>>>// Project Object Structure
49951>>>>>>>>>>>//   dg186 is a dbModalPanelSub
49951>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
49951>>>>>>>>>>>//     Units_DD is a DataDictionary
49951>>>>>>>>>>>//     Fpa_DD is a DataDictionary
49951>>>>>>>>>>>//     Item_DD is a DataDictionary
49951>>>>>>>>>>>//     Witemcl_DD is a DataDictionary
49951>>>>>>>>>>>//     The_Table is a dbGrid
49951>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
49951>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
49951>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
49951>>>>>>>>>>>//     ocode is a FormSub
49951>>>>>>>>>>>//     operi is a FormSub
49951>>>>>>>>>>>//     ocodeprom is a FormSub
49951>>>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
49951>>>>>>>>>>>//       Radio1 is a RadioSub
49951>>>>>>>>>>>//       Radio2 is a RadioSub
49951>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
49951>>>>>>>>>>>//     btnwitemcl is a ButtonSub
49951>>>>>>>>>>>
49951>>>>>>>>>>>// Register all objects
49951>>>>>>>>>>>Register_Object ButtonSub1
49951>>>>>>>>>>>Register_Object btnwitemcl
49951>>>>>>>>>>>Register_Object dg186
49951>>>>>>>>>>>Register_Object Fpa_DD
49951>>>>>>>>>>>Register_Object Item_DD
49951>>>>>>>>>>>Register_Object ocode
49951>>>>>>>>>>>Register_Object ocodeprom
49951>>>>>>>>>>>Register_Object operi
49951>>>>>>>>>>>Register_Object Radio1
49951>>>>>>>>>>>Register_Object Radio2
49951>>>>>>>>>>>Register_Object RadioGroupSub1
49951>>>>>>>>>>>Register_Object TextBoxSub1
49951>>>>>>>>>>>Register_Object TextBoxSub2
49951>>>>>>>>>>>Register_Object TextBoxSub3
49951>>>>>>>>>>>Register_Object The_Table
49951>>>>>>>>>>>Register_Object Units_DD
49951>>>>>>>>>>>Register_Object Witemcl_DD
49951>>>>>>>>>>>Register_Object Witemkat_DD
49951>>>>>>>>>>>
49951>>>>>>>>>>>
49951>>>>>>>>>>>
49951>>>>>>>>>>>    //AB-StoreTopStart
49951>>>>>>>>>>>    open clients
49953>>>>>>>>>>>    use sl17.sl
49953>>>>>>>>>>>    //AB-StoreTopEnd
49953>>>>>>>>>>>
49953>>>>>>>>>>>    //AB-IgnoreStart
49953>>>>>>>>>>>
49953>>>>>>>>>>>    Use DFAllEnt.pkg
49953>>>>>>>>>>>    Use Txtbox.Sub
49953>>>>>>>>>>>    Use Form.Sub
49953>>>>>>>>>>>    Use Rgroup.Sub
49953>>>>>>>>>>>    Use Radio.Sub
49953>>>>>>>>>>>    Use Button.Sub
49953>>>>>>>>>>>
49953>>>>>>>>>>>
49953>>>>>>>>>>>    Use WITEMKAT.DD
49953>>>>>>>>>>>    Use UNITS.DD
49953>>>>>>>>>>>    Use FPA.DD
49953>>>>>>>>>>>    Use ITEM.DD
49953>>>>>>>>>>>    Use WITEMCL.DD
INCLUDING FILE: WITEMCL.DD
49953>>>>>>>>>>>>>//DDB-FileStart
49953>>>>>>>>>>>>>//DDB-HeaderStart
49953>>>>>>>>>>>>>
49953>>>>>>>>>>>>>// File Name : WITEMCL.DD
49953>>>>>>>>>>>>>// Class Name: Witemcl_DataDictionary
49953>>>>>>>>>>>>>// Revision  : 16
49953>>>>>>>>>>>>>// Version   : 2
49953>>>>>>>>>>>>>
49953>>>>>>>>>>>>>Use  Windows           // Basic Definitions
49953>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
49953>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49953>>>>>>>>>>>>>
49953>>>>>>>>>>>>>Open Witemcl
49955>>>>>>>>>>>>>Open Witemcld
49957>>>>>>>>>>>>>Open Item
49959>>>>>>>>>>>>>Open Sysrecw
49961>>>>>>>>>>>>>
49961>>>>>>>>>>>>>//DDB-HeaderEnd
49961>>>>>>>>>>>>>//DDB-SelectionStart
49961>>>>>>>>>>>>>//DDB/ ExternalSelectionList SL100  sl100.sl
49961>>>>>>>>>>>>>Register_Object SL100
49961>>>>>>>>>>>>>//DDB-SelectionEnd
49961>>>>>>>>>>>>>
49961>>>>>>>>>>>>>Class Witemcl_DataDictionary  is a DataDictionary_Sec
49962>>>>>>>>>>>>> 
49962>>>>>>>>>>>>>    // Update:
49962>>>>>>>>>>>>> 
49962>>>>>>>>>>>>>    Procedure Update
49963>>>>>>>>>>>>>        Forward Send Update  
49965>>>>>>>>>>>>>        move item.item_descr to witemcl.item_descr
49966>>>>>>>>>>>>>    End_Procedure   // Update
49967>>>>>>>>>>>>> 
49967>>>>>>>>>>>>>
49967>>>>>>>>>>>>>    // Define_Fields:
49967>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49967>>>>>>>>>>>>>
49967>>>>>>>>>>>>>    Procedure Define_Fields
49968>>>>>>>>>>>>>        Forward Send Define_Fields
49970>>>>>>>>>>>>>        //DDB-Generated-Code-Location
49970>>>>>>>>>>>>>        //DDB-DefineFieldStart
49970>>>>>>>>>>>>>
49970>>>>>>>>>>>>>        Set Main_File            To Witemcl.File_Number
49971>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
49972>>>>>>>>>>>>>
49972>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49973>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49974>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49975>>>>>>>>>>>>>
49975>>>>>>>>>>>>>        // Child (Client) file structure................
49975>>>>>>>>>>>>>        Send Add_Client_File  Witemcld.File_Number
49976>>>>>>>>>>>>>
49976>>>>>>>>>>>>>        // Parent (Server) file structure...............
49976>>>>>>>>>>>>>        Send Add_Server_File  Item.File_Number
49977>>>>>>>>>>>>>
49977>>>>>>>>>>>>>        // External (System) file structure.............
49977>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
49978>>>>>>>>>>>>>
49978>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Witemcl_Rec0  To Witemcl.Rec0
49981>>>>>>>>>>>>>
49981>>>>>>>>>>>>>        // Field-based properties.......................
49981>>>>>>>>>>>>>
49981>>>>>>>>>>>>>        // Witemcl.Item_Code
49981>>>>>>>>>>>>>
49981>>>>>>>>>>>>>        // Witemcl.Client_Code
49981>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemcl.Client_Code To (SL100(Self))
49982>>>>>>>>>>>>>
49982>>>>>>>>>>>>>        // Witemcl.Client_Itemcode
49982>>>>>>>>>>>>>
49982>>>>>>>>>>>>>        // Witemcl.Client_Date
49982>>>>>>>>>>>>>        Set Field_Mask_Type        Field Witemcl.Client_Date To MASK_DATE_WINDOW
49983>>>>>>>>>>>>>
49983>>>>>>>>>>>>>        // Witemcl.Client_Price
49983>>>>>>>>>>>>>        Set Field_Mask_Type        Field Witemcl.Client_Price To MASK_NUMERIC_WINDOW
49984>>>>>>>>>>>>>
49984>>>>>>>>>>>>>        // Witemcl.Item_Descr
49984>>>>>>>>>>>>>
49984>>>>>>>>>>>>>        // Witemcl.Rec0
49984>>>>>>>>>>>>>
49984>>>>>>>>>>>>>        // Witemcl.Is_Client
49984>>>>>>>>>>>>>
49984>>>>>>>>>>>>>        //DDB-DefineFieldEnd
49984>>>>>>>>>>>>>    End_Procedure    // Define_Fields
49985>>>>>>>>>>>>>
49985>>>>>>>>>>>>>    // Field_Defaults:
49985>>>>>>>>>>>>>    // This procedure is used to establish default field values.
49985>>>>>>>>>>>>>
49985>>>>>>>>>>>>>    Procedure Field_Defaults
49986>>>>>>>>>>>>>        Forward Send Field_Defaults
49988>>>>>>>>>>>>>        //DDB-Generated-Code-Location
49988>>>>>>>>>>>>>        //DDB-FieldDefaultStart
49988>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
49988>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
49989>>>>>>>>>>>>>
49989>>>>>>>>>>>>>End_Class    // Witemcl_DataDictionary
49990>>>>>>>>>>>>>//DDB-Selection-pkg-Start
49990>>>>>>>>>>>>>
49990>>>>>>>>>>>>>Use sl100.sl         // SL100
49990>>>>>>>>>>>>>
49990>>>>>>>>>>>>>//DDB-Selection-pkg-End
49990>>>>>>>>>>>>>//DDB-FileEnd
49990>>>>>>>>>>>    
49990>>>>>>>>>>>    //AB-IgnoreEnd
49990>>>>>>>>>>>
49990>>>>>>>>>>>    Object dg186 is a dbModalPanelSub
49992>>>>>>>>>>>
49992>>>>>>>>>>>        //AB-StoreTopStart
49992>>>>>>>>>>>        Function fsclient string code Returns string
49994>>>>>>>>>>>            string name
49995>>>>>>>>>>>            clear clients
49996>>>>>>>>>>>            move code to clients.client_id
49997>>>>>>>>>>>            find eq clients by index.6
49998>>>>>>>>>>>>
49998>>>>>>>>>>>            move clients.client_name to name
49999>>>>>>>>>>>            function_return name
50000>>>>>>>>>>>        end_Function
50001>>>>>>>>>>>        
50001>>>>>>>>>>>        Property String     pscode                  ''
50003>>>>>>>>>>>        Property String     psperi                  ''
50005>>>>>>>>>>>        Property Integer    piContains_Or_Starts     0
50007>>>>>>>>>>>        Property String     pscodeprom              ''
50009>>>>>>>>>>>        
50009>>>>>>>>>>>        
50009>>>>>>>>>>>        //AB-StoreTopEnd
50009>>>>>>>>>>>
50009>>>>>>>>>>>        Set Label to "‘¬©®œ«å©œ ª „ ›é¤ €§¦Ÿã¡žª"
50010>>>>>>>>>>>        Set Size to 289 527
50011>>>>>>>>>>>        Set Location to 0 2
50012>>>>>>>>>>>
50012>>>>>>>>>>>        //AB-DDOStart
50012>>>>>>>>>>>
50012>>>>>>>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
50014>>>>>>>>>>>        End_Object    // Witemkat_DD
50015>>>>>>>>>>>
50015>>>>>>>>>>>        Object Units_DD is a Units_DataDictionary
50017>>>>>>>>>>>        End_Object    // Units_DD
50018>>>>>>>>>>>
50018>>>>>>>>>>>        Object Fpa_DD is a Fpa_DataDictionary
50020>>>>>>>>>>>        End_Object    // Fpa_DD
50021>>>>>>>>>>>
50021>>>>>>>>>>>        Object Item_DD is a Item_DataDictionary
50023>>>>>>>>>>>            Set DDO_Server to (Units_DD(self))
50024>>>>>>>>>>>            Set DDO_Server to (Witemkat_DD(self))
50025>>>>>>>>>>>            Set DDO_Server to (Fpa_DD(self))
50026>>>>>>>>>>>        End_Object    // Item_DD
50027>>>>>>>>>>>
50027>>>>>>>>>>>        Object Witemcl_DD is a Witemcl_DataDictionary
50029>>>>>>>>>>>
50029>>>>>>>>>>>            //AB-StoreTopStart
50029>>>>>>>>>>>            Function fiPeriexei Returns Integer
50031>>>>>>>>>>>                       String lsperi lscode  lscodeprom
50032>>>>>>>>>>>                       Integer rVal liContains_Or_Starts
50032>>>>>>>>>>>                       Move 0 to rVal
50033>>>>>>>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
50034>>>>>>>>>>>                       Get psperi to lsperi
50035>>>>>>>>>>>                       Get pscode to lscode
50036>>>>>>>>>>>                       Get pscodeprom to lscodeprom
50037>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
50038>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
50039>>>>>>>>>>>                  //     Move (Trim(lscodekat)) to lscodekat
50039>>>>>>>>>>>                       If (liContains_Or_Starts=0) Begin
50041>>>>>>>>>>>                           If ((Trim(witemcl.item_descr)) Contains lsperi) Begin
50043>>>>>>>>>>>                               If ((Trim(witemcl.item_code)) Contains lscode) Move 1 to rVal
50046>>>>>>>>>>>                           End
50046>>>>>>>>>>>>
50046>>>>>>>>>>>            
50046>>>>>>>>>>>                       End
50046>>>>>>>>>>>>
50046>>>>>>>>>>>                       Else Begin
50047>>>>>>>>>>>                           If (Left(witemcl.item_descr,(Length(lsperi)))=lsperi) Begin
50049>>>>>>>>>>>                               If (Left(witemcl.item_code,(Length(lscode)))=lscode) Move 1 to rVal
50052>>>>>>>>>>>                           End
50052>>>>>>>>>>>>
50052>>>>>>>>>>>            
50052>>>>>>>>>>>                       End
50052>>>>>>>>>>>>
50052>>>>>>>>>>>                       Function_Return rVal
50053>>>>>>>>>>>                   End_Function
50054>>>>>>>>>>>            
50054>>>>>>>>>>>                   Function fiArxizeiperi Returns Integer
50056>>>>>>>>>>>                       String lsperi
50057>>>>>>>>>>>                       Get psperi to lsperi
50058>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
50059>>>>>>>>>>>                       Function_Return (Left(witemcl.item_descr,(Length(lsperi)))=lsperi)
50060>>>>>>>>>>>                   End_Function
50061>>>>>>>>>>>            
50061>>>>>>>>>>>                   Function fiArxizeicode Returns Integer
50063>>>>>>>>>>>                       String lscode lscodeprom
50064>>>>>>>>>>>                       Get pscode to lscode
50065>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
50066>>>>>>>>>>>                       Function_Return (Left(witemcl.item_code,(Length(lscode)))=lscode)
50067>>>>>>>>>>>                   End_Function
50068>>>>>>>>>>>            
50068>>>>>>>>>>>            //AB-StoreTopEnd
50068>>>>>>>>>>>
50068>>>>>>>>>>>            Set DDO_Server to (Item_DD(self))
50069>>>>>>>>>>>
50069>>>>>>>>>>>            //AB-StoreStart
50069>>>>>>>>>>>                                                                
50069>>>>>>>>>>>                                                                
50069>>>>>>>>>>>            Begin_Constraints
50071>>>>>>>>>>>               String lsperi lscode lsvalue lstype lscodeprom
50072>>>>>>>>>>>               Integer liContains_Or_Starts
50072>>>>>>>>>>>                   Get psperi  to lsperi
50073>>>>>>>>>>>                   Get pscode  to lscode
50074>>>>>>>>>>>                   Get pscodeprom  to lscodeprom
50075>>>>>>>>>>>                   Get piContains_Or_Starts to liContains_Or_Starts
50076>>>>>>>>>>>                   Move (Trim(lsperi)) to lsperi
50077>>>>>>>>>>>                   Move (Trim(lscode)) to lscode
50078>>>>>>>>>>>                   Move (Trim(lscodeprom)) to lscodeprom
50079>>>>>>>>>>>                   If ((lsperi<>'') and ;                      (lscode<>'')) Constrain witemcl as (fiPeriexei(Self)=1)
50082>>>>>>>>>>>                   Else Begin
50083>>>>>>>>>>>                      If (liContains_Or_Starts=0) Begin
50085>>>>>>>>>>>                      If (lsperi<>'') Constrain witemcl.item_descr Contains lsperi
50089>>>>>>>>>>>                      Else If (lscode<>'') Constrain witemcl.item_code Contains lscode
50094>>>>>>>>>>>                      End
50094>>>>>>>>>>>>
50094>>>>>>>>>>>                   Else Begin
50095>>>>>>>>>>>                       If (lsperi<>'') Constrain witemcl as (fiArxizeiperi(Self)=1) //witemcl.item_descr
50098>>>>>>>>>>>                       Else If (lscode<>'') Constrain witemcl as (fiArxizeicode(Self)=1) //witemcl.item_code
50102>>>>>>>>>>>                       End
50102>>>>>>>>>>>>
50102>>>>>>>>>>>                   End
50102>>>>>>>>>>>>
50102>>>>>>>>>>>                   If (lscodeprom<>'') Constrain witemcl.client_itemcode Contains lscodeprom
50106>>>>>>>>>>>            
50106>>>>>>>>>>>            End_Constraints
50109>>>>>>>>>>>            
50109>>>>>>>>>>>            
50109>>>>>>>>>>>            //AB-StoreEnd
50109>>>>>>>>>>>
50109>>>>>>>>>>>        End_Object    // Witemcl_DD
50110>>>>>>>>>>>
50110>>>>>>>>>>>        Set Main_DD to (Witemcl_DD(self))
50111>>>>>>>>>>>        Set Server to (Witemcl_DD(self))
50112>>>>>>>>>>>
50112>>>>>>>>>>>        //AB-DDOEnd
50112>>>>>>>>>>>
50112>>>>>>>>>>>        Object The_Table is a dbGrid
50114>>>>>>>>>>>            Set Main_File to Witemcl.File_Number
50115>>>>>>>>>>>            Set Size to 201 519
50116>>>>>>>>>>>            Set Location to 3 2
50117>>>>>>>>>>>            Set Color to 14280447
50118>>>>>>>>>>>            Set CurrentRowColor to 11783679
50119>>>>>>>>>>>            Set CurrentCellColor to 11783679
50120>>>>>>>>>>>            Set Wrap_State to TRUE
50121>>>>>>>>>>>
50121>>>>>>>>>>>            Begin_Row
50124>>>>>>>>>>>                Entry_Item Witemcl.Item_code
50125>>>>>>>>>>>                Entry_Item Witemcl.Client_itemcode
50126>>>>>>>>>>>                Entry_Item Witemcl.Item_descr
50127>>>>>>>>>>>                Entry_Item Witemcl.Client_code
50128>>>>>>>>>>>                Entry_Item (fsclient(self,witemcl.client_code))
50129>>>>>>>>>>>            End_Row
50134>>>>>>>>>>>
50134>>>>>>>>>>>            Set Form_Width    item 0 to 100
50135>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª „å›¦¬ª"
50136>>>>>>>>>>>            
50136>>>>>>>>>>>            Set Form_Width    item 1 to 100
50137>>>>>>>>>>>            Set Header_Label  item 1 to "„å›¦ª ¨¦£žŸœ¬«ã"
50138>>>>>>>>>>>            
50138>>>>>>>>>>>            Set Form_Width    item 2 to 200
50139>>>>>>>>>>>            Set Header_Label  item 2 to "œ¨ š¨˜­ã „å›¦¬ª"
50140>>>>>>>>>>>            
50140>>>>>>>>>>>            Set Form_Width    item 3 to 0
50141>>>>>>>>>>>            Set Header_Label  item 3 to ""
50142>>>>>>>>>>>            
50142>>>>>>>>>>>            Set Form_Width    item 4 to 111
50143>>>>>>>>>>>            Set Header_Label  item 4 to "¨¦£žŸœ¬«ãª"
50144>>>>>>>>>>>            
50144>>>>>>>>>>>
50144>>>>>>>>>>>            //AB-StoreStart
50144>>>>>>>>>>>            Set Column_Option Item 3 to NoEnter True
50145>>>>>>>>>>>            //set read_only_state to true
50145>>>>>>>>>>>            set no_create_state to true
50146>>>>>>>>>>>            set no_delete_state to true
50147>>>>>>>>>>>            //AB-StoreEnd
50147>>>>>>>>>>>
50147>>>>>>>>>>>        End_Object    // The_Table
50148>>>>>>>>>>>
50148>>>>>>>>>>>        Object TextBoxSub1 is a TextBoxSub
50150>>>>>>>>>>>            Set Label to "‘á¨à©ž ‰à› ¡¦ç ‚ á"
50151>>>>>>>>>>>            Set Auto_Size_State to FALSE
50152>>>>>>>>>>>            Set Location to 208 5
50153>>>>>>>>>>>            Set Size to 13 78
50154>>>>>>>>>>>        End_Object    // TextBoxSub1
50155>>>>>>>>>>>
50155>>>>>>>>>>>        Object TextBoxSub2 is a TextBoxSub
50157>>>>>>>>>>>            Set Label to "‘á¨à©ž œ¨ š¨˜­ãª "
50158>>>>>>>>>>>            Set Auto_Size_State to FALSE
50159>>>>>>>>>>>            Set Location to 223 5
50160>>>>>>>>>>>            Set Size to 13 83
50161>>>>>>>>>>>        End_Object    // TextBoxSub2
50162>>>>>>>>>>>
50162>>>>>>>>>>>        Object TextBoxSub3 is a TextBoxSub
50164>>>>>>>>>>>            Set Label to "„å›¦ª ¨¦£žŸœ¬«ã ‚ á"
50165>>>>>>>>>>>            Set Auto_Size_State to FALSE
50166>>>>>>>>>>>            Set Location to 237 5
50167>>>>>>>>>>>            Set Size to 13 78
50168>>>>>>>>>>>        End_Object    // TextBoxSub3
50169>>>>>>>>>>>
50169>>>>>>>>>>>        Object ocode is a FormSub
50171>>>>>>>>>>>            Set Size to 13 197
50172>>>>>>>>>>>            Set Location to 209 91
50173>>>>>>>>>>>            Set Label_Col_Offset to 2
50174>>>>>>>>>>>
50174>>>>>>>>>>>            //AB-StoreStart
50174>>>>>>>>>>>                                                                                                                                                                                                    
50174>>>>>>>>>>>            Procedure OnKILLFOCUS
50176>>>>>>>>>>>               Send KeyAction to ButtonSub1
50177>>>>>>>>>>>            End_Procedure
50178>>>>>>>>>>>            
50178>>>>>>>>>>>            
50178>>>>>>>>>>>            
50178>>>>>>>>>>>            
50178>>>>>>>>>>>            //AB-StoreEnd
50178>>>>>>>>>>>
50178>>>>>>>>>>>        End_Object    // ocode
50179>>>>>>>>>>>
50179>>>>>>>>>>>        Object operi is a FormSub
50181>>>>>>>>>>>            Set Size to 13 197
50182>>>>>>>>>>>            Set Location to 223 91
50183>>>>>>>>>>>            Set Label_Col_Offset to 2
50184>>>>>>>>>>>
50184>>>>>>>>>>>            //AB-StoreStart
50184>>>>>>>>>>>                                                                                                                                                                                                    
50184>>>>>>>>>>>            Procedure OnKILLFOCUS
50186>>>>>>>>>>>              Send KeyAction to ButtonSub1
50187>>>>>>>>>>>            End_Procedure
50188>>>>>>>>>>>            
50188>>>>>>>>>>>            
50188>>>>>>>>>>>            
50188>>>>>>>>>>>            
50188>>>>>>>>>>>            //AB-StoreEnd
50188>>>>>>>>>>>
50188>>>>>>>>>>>        End_Object    // operi
50189>>>>>>>>>>>
50189>>>>>>>>>>>        Object ocodeprom is a FormSub
50191>>>>>>>>>>>            Set Size to 13 197
50192>>>>>>>>>>>            Set Location to 238 91
50193>>>>>>>>>>>            Set Label_Col_Offset to 2
50194>>>>>>>>>>>
50194>>>>>>>>>>>            //AB-StoreStart
50194>>>>>>>>>>>                                                                                                                                                                                                    
50194>>>>>>>>>>>            Procedure OnKILLFOCUS
50196>>>>>>>>>>>                Send KeyAction to ButtonSub1
50197>>>>>>>>>>>            End_Procedure
50198>>>>>>>>>>>            
50198>>>>>>>>>>>            
50198>>>>>>>>>>>            
50198>>>>>>>>>>>            //AB-StoreEnd
50198>>>>>>>>>>>
50198>>>>>>>>>>>        End_Object    // ocodeprom
50199>>>>>>>>>>>
50199>>>>>>>>>>>        Object RadioGroupSub1 is a RadioGroupSub
50201>>>>>>>>>>>            Set Size to 32 77
50202>>>>>>>>>>>            Set Location to 209 296
50203>>>>>>>>>>>            Object Radio1 is a RadioSub
50205>>>>>>>>>>>                Set Label to "œ¨ â®œ«˜ "
50206>>>>>>>>>>>                Set Size to 10 53
50207>>>>>>>>>>>                Set Location to 7 5
50208>>>>>>>>>>>            End_Object    // Radio1
50209>>>>>>>>>>>
50209>>>>>>>>>>>            Object Radio2 is a RadioSub
50211>>>>>>>>>>>                Set Label to "€¨®åœ  €§æ"
50212>>>>>>>>>>>                Set Size to 10 51
50213>>>>>>>>>>>                Set Location to 21 5
50214>>>>>>>>>>>            End_Object    // Radio2
50215>>>>>>>>>>>
50215>>>>>>>>>>>
50215>>>>>>>>>>>            //AB-StoreStart
50215>>>>>>>>>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
50215>>>>>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
50217>>>>>>>>>>>                //iToItem=0 => Contains, =1 => Starts with
50217>>>>>>>>>>>                Set piContains_Or_Starts to iToItem
50218>>>>>>>>>>>                Send KeyAction to ButtonSub1
50219>>>>>>>>>>>            End_Procedure
50220>>>>>>>>>>>            
50220>>>>>>>>>>>            // If you set Current_radio you must set this after the
50220>>>>>>>>>>>            // radio objects have been created AND after Notify_select_State has been
50220>>>>>>>>>>>            // created. i.e. Set in bottom-code at end!!
50220>>>>>>>>>>>            //Set Current_Radio to 0
50220>>>>>>>>>>>            
50220>>>>>>>>>>>            
50220>>>>>>>>>>>            //AB-StoreEnd
50220>>>>>>>>>>>
50220>>>>>>>>>>>        End_Object    // RadioGroupSub1
50221>>>>>>>>>>>
50221>>>>>>>>>>>        Object ButtonSub1 is a ButtonSub
50223>>>>>>>>>>>            Set Label to "Search"
50224>>>>>>>>>>>            Set Size to 28 37
50225>>>>>>>>>>>            Set Location to 210 413
50226>>>>>>>>>>>            Set Form_FontWeight Item 0 to 800
50227>>>>>>>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
50228>>>>>>>>>>>
50228>>>>>>>>>>>            //AB-StoreStart
50228>>>>>>>>>>>                                        
50228>>>>>>>>>>>            Set Visible_State to False
50229>>>>>>>>>>>            
50229>>>>>>>>>>>            Procedure OnClick
50231>>>>>>>>>>>                Forward Send OnClick
50233>>>>>>>>>>>                Set pscode  to (Value(ocode(Self),0))
50234>>>>>>>>>>>                Set psperi  to (Value(operi(Self),0))
50235>>>>>>>>>>>                Set pscodeprom  to (Value(ocodeprom(Self),0))
50236>>>>>>>>>>>                send Rebuild_Constraints    to (witemcl_DD(Self))
50237>>>>>>>>>>>                Send Beginning_Of_Data      to the_table
50238>>>>>>>>>>>            End_Procedure // OnClick
50239>>>>>>>>>>>            
50239>>>>>>>>>>>            
50239>>>>>>>>>>>            
50239>>>>>>>>>>>            
50239>>>>>>>>>>>            
50239>>>>>>>>>>>            
50239>>>>>>>>>>>            
50239>>>>>>>>>>>            
50239>>>>>>>>>>>            
50239>>>>>>>>>>>            
50239>>>>>>>>>>>            
50239>>>>>>>>>>>            
50239>>>>>>>>>>>            
50239>>>>>>>>>>>            
50239>>>>>>>>>>>            
50239>>>>>>>>>>>            //AB-StoreEnd
50239>>>>>>>>>>>
50239>>>>>>>>>>>        End_Object    // ButtonSub1
50240>>>>>>>>>>>
50240>>>>>>>>>>>        Object btnwitemcl is a ButtonSub
50242>>>>>>>>>>>
50242>>>>>>>>>>>            //AB-StoreTopStart
50242>>>>>>>>>>>                                                                                    
50242>>>>>>>>>>>            //AB-StoreTopEnd
50242>>>>>>>>>>>
50242>>>>>>>>>>>            Set Label to "ButtonSub1"
50243>>>>>>>>>>>            Set Bitmap to "Filesys3.bmp"
50244>>>>>>>>>>>            Set Size to 22 25
50245>>>>>>>>>>>            Set Location to 214 482
50246>>>>>>>>>>>            Set Focus_Mode to Pointer_Only
50247>>>>>>>>>>>
50247>>>>>>>>>>>            //AB-StoreStart
50247>>>>>>>>>>>                                                                                    
50247>>>>>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ œ¬¨œ«ã¨ ¦ „ ›é¤"
50248>>>>>>>>>>>            
50248>>>>>>>>>>>            Procedure OnClick
50250>>>>>>>>>>>                String  scode speri
50251>>>>>>>>>>>                Get value of (ocode(self)) to scode
50252>>>>>>>>>>>                Get value of (operi(self)) to speri
50253>>>>>>>>>>>                set pscode of (sl17(self)) to scode
50254>>>>>>>>>>>                set psperi of (sl17(self)) to speri
50255>>>>>>>>>>>                send request_cancel to dg186
50256>>>>>>>>>>>            End_Procedure // OnClick
50257>>>>>>>>>>>            
50257>>>>>>>>>>>            
50257>>>>>>>>>>>            
50257>>>>>>>>>>>            
50257>>>>>>>>>>>            
50257>>>>>>>>>>>            
50257>>>>>>>>>>>            
50257>>>>>>>>>>>            
50257>>>>>>>>>>>            
50257>>>>>>>>>>>            
50257>>>>>>>>>>>            
50257>>>>>>>>>>>            
50257>>>>>>>>>>>            
50257>>>>>>>>>>>            
50257>>>>>>>>>>>            
50257>>>>>>>>>>>            
50257>>>>>>>>>>>            
50257>>>>>>>>>>>            
50257>>>>>>>>>>>            
50257>>>>>>>>>>>            
50257>>>>>>>>>>>            
50257>>>>>>>>>>>            //AB-StoreEnd
50257>>>>>>>>>>>
50257>>>>>>>>>>>        End_Object    // btnwitemcl
50258>>>>>>>>>>>
50258>>>>>>>>>>>
50258>>>>>>>>>>>        //AB-StoreStart
50258>>>>>>>>>>>        Procedure Activating
50260>>>>>>>>>>>           integer rval
50261>>>>>>>>>>>           set value of (ocode(self)) to (pscode(self))
50262>>>>>>>>>>>           set value of (operi(self)) to (psperi(self))
50263>>>>>>>>>>>           Send Rebuild_Constraints to (witemcl_DD(Self))
50264>>>>>>>>>>>           Forward send Activating
50266>>>>>>>>>>>        
50266>>>>>>>>>>>        End_Procedure
50267>>>>>>>>>>>        
50267>>>>>>>>>>>        
50267>>>>>>>>>>>        
50267>>>>>>>>>>>        
50267>>>>>>>>>>>        
50267>>>>>>>>>>>        
50267>>>>>>>>>>>        //AB-StoreEnd
50267>>>>>>>>>>>
50267>>>>>>>>>>>    End_Object    // dg186
50268>>>>>>>>>>>
50268>>>>>>>>>>>
50268>>>>>>>>>>>    //AB-StoreStart
50268>>>>>>>>>>>        
50268>>>>>>>>>>>    //AB-StoreEnd
50268>>>>>>>>>>>
50268>>>>>>>>>>>//AB/     End_Object    // prj
50268>>>>>>>>>    //AB-StoreTopEnd
50268>>>>>>>>>
50268>>>>>>>>>    //AB-IgnoreStart
50268>>>>>>>>>
50268>>>>>>>>>    Use DFAllEnt.pkg
50268>>>>>>>>>    Use dbList.Sub
50268>>>>>>>>>    Use Txtbox.Sub
50268>>>>>>>>>    Use Form.Sub
50268>>>>>>>>>    Use Rgroup.Sub
50268>>>>>>>>>    Use Radio.Sub
50268>>>>>>>>>    Use Button.Sub
50268>>>>>>>>>
50268>>>>>>>>>
50268>>>>>>>>>    Use UNITS.DD
50268>>>>>>>>>    Use WITEMKAT.DD
50268>>>>>>>>>    Use FPA.DD
50268>>>>>>>>>    Use ITEM.DD
50268>>>>>>>>>    Use WITEMX.DD
INCLUDING FILE: WITEMX.DD
50268>>>>>>>>>>>//DDB-FileStart
50268>>>>>>>>>>>//DDB-HeaderStart
50268>>>>>>>>>>>
50268>>>>>>>>>>>// File Name : WITEMX.DD
50268>>>>>>>>>>>// Class Name: Witemx_DataDictionary
50268>>>>>>>>>>>// Revision  : 78
50268>>>>>>>>>>>// Version   : 2
50268>>>>>>>>>>>
50268>>>>>>>>>>>Use  Windows           // Basic Definitions
50268>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
50268>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
50268>>>>>>>>>>>
50268>>>>>>>>>>>Open Witemx
50270>>>>>>>>>>>Open Witemxt
50272>>>>>>>>>>>Open Pmoves
50274>>>>>>>>>>>Open Wam
50276>>>>>>>>>>>Open Pmovesl
50278>>>>>>>>>>>Open Witemxen
INCLUDING FILE: WITEMXEN.FD
50280>>>>>>>>>>>Open Camovedd
INCLUDING FILE: CAMOVEDD.FD
50282>>>>>>>>>>>Open Wcmoves
50284>>>>>>>>>>>Open Item
50286>>>>>>>>>>>Open Sysrecw
50288>>>>>>>>>>>Open Syscurxr
50290>>>>>>>>>>>
50290>>>>>>>>>>>//DDB-HeaderEnd
50290>>>>>>>>>>>//DDB-SelectionStart
50290>>>>>>>>>>>//DDB/ ExternalSelectionList SL22s  sl22s.SL
50290>>>>>>>>>>>Register_Object SL22s
50290>>>>>>>>>>>//DDB-SelectionEnd
50290>>>>>>>>>>>
50290>>>>>>>>>>>Class Witemx_DataDictionary  is a DataDictionary
50291>>>>>>>>>>>
50291>>>>>>>>>>>    Procedure Construct_Object
50292>>>>>>>>>>>        Forward Send Construct_Object
50294>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
50295>>>>>>>>>>>    End_Procedure //construct_object
50296>>>>>>>>>>>
50296>>>>>>>>>>>    Procedure OnConstrain
50297>>>>>>>>>>>        Forward Send OnConstrain
50299>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
50301>>>>>>>>>>>        End
50301>>>>>>>>>>>>
50301>>>>>>>>>>>        Else Begin
50302>>>>>>>>>>>            Constrain Witemx.Company_Code  eq SysCurXR.Company_Code
50304>>>>>>>>>>>            Constrain Witemx.Branch_Code   eq SysCurXR.Branch_Code
50306>>>>>>>>>>>            Constrain Witemx.Year_Year     eq SysCurXR.Year_Year
50308>>>>>>>>>>>        End
50308>>>>>>>>>>>>
50308>>>>>>>>>>>    End_Procedure
50309>>>>>>>>>>>
50309>>>>>>>>>>>    Procedure Save_Main_File
50310>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
50312>>>>>>>>>>>            If Witemx.Recnum Eq 0 Procedure_Return
50315>>>>>>>>>>>        End
50315>>>>>>>>>>>>
50315>>>>>>>>>>>        Forward Send Save_Main_File
50317>>>>>>>>>>>    End_Procedure
50318>>>>>>>>>>>
50318>>>>>>>>>>>    // Update:
50318>>>>>>>>>>>    Procedure Update
50319>>>>>>>>>>>        Forward Send Update
50321>>>>>>>>>>>        // Insert Code Here
50321>>>>>>>>>>>        Move SysCurXR.Company_Code  to Witemx.Company_Code
50322>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Witemx.Branch_Code
50323>>>>>>>>>>>        Move SysCurXR.Year_Year     to Witemx.Year_Year
50324>>>>>>>>>>>        Move SysCurXR.Year_Recr     to Witemx.Year_Recr
50325>>>>>>>>>>>        Move Witemkat.Witemkat_Code to Witemx.Witemkat_Code
50326>>>>>>>>>>>        Move Units.Units_Code       to Witemx.Units_Code
50327>>>>>>>>>>>        Move Item.Item_Code         to Witemx.Item_Code
50328>>>>>>>>>>>        Move Item.Item_Code         to Witemx.Witemx_Code
50329>>>>>>>>>>>        Move Item.Item_Descr        to Witemx.Witemx_Descr
50330>>>>>>>>>>>        Move Item.Wapokat_Code      to Witemx.ITEM_APOKAT_COD 
50331>>>>>>>>>>>        Move Item.link1             to witemx.link1
50332>>>>>>>>>>>        move Item.link2             to witemx.link2
50333>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Xre/Witemx.Qty_Xre),4))  to Witemx.Mesosta_Xre
50334>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Pis/Witemx.Qty_Pis),4))  to Witemx.Mesosta_Pis
50335>>>>>>>>>>>    End_Procedure   // Update
50336>>>>>>>>>>>
50336>>>>>>>>>>>
50336>>>>>>>>>>>    Procedure Backout
50337>>>>>>>>>>>        Forward Send Backout
50339>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Xre/Witemx.Qty_Xre),4))  to Witemx.Mesosta_Xre
50340>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Pis/Witemx.Qty_Pis),4))  to Witemx.Mesosta_Pis
50341>>>>>>>>>>>    End_Procedure   // Update
50342>>>>>>>>>>>
50342>>>>>>>>>>>    Procedure Creating
50343>>>>>>>>>>>        Forward Send Creating
50345>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                       (Trim(String(Witemx.Witemx_Rec0)))))) to Witemx.Witemx_Recr
50346>>>>>>>>>>>    End_Procedure   // Creating
50347>>>>>>>>>>>
50347>>>>>>>>>>>
50347>>>>>>>>>>>
50347>>>>>>>>>>>    // Define_Fields:
50347>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
50347>>>>>>>>>>>
50347>>>>>>>>>>>    Procedure Define_Fields
50348>>>>>>>>>>>        Forward Send Define_Fields
50350>>>>>>>>>>>        //DDB-Generated-Code-Location
50350>>>>>>>>>>>        //DDB-DefineFieldStart
50350>>>>>>>>>>>
50350>>>>>>>>>>>        Set Main_File            To Witemx.File_Number
50351>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
50352>>>>>>>>>>>
50352>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
50353>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
50354>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
50355>>>>>>>>>>>
50355>>>>>>>>>>>        // Child (Client) file structure................
50355>>>>>>>>>>>        Send Add_Client_File  Witemxt.File_Number
50356>>>>>>>>>>>        Send Add_Client_File  Pmoves.File_Number
50357>>>>>>>>>>>        Send Add_Client_File  Wam.File_Number
50358>>>>>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
50359>>>>>>>>>>>        Send Add_Client_File  Witemxen.File_Number
50360>>>>>>>>>>>        Send Add_Client_File  Camovedd.File_Number
50361>>>>>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
50362>>>>>>>>>>>
50362>>>>>>>>>>>        // Parent (Server) file structure...............
50362>>>>>>>>>>>        Send Add_Server_File  Item.File_Number
50363>>>>>>>>>>>
50363>>>>>>>>>>>        // External (System) file structure.............
50363>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
50364>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
50365>>>>>>>>>>>
50365>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Witemx_Rec0  To Witemx.Witemx_Rec0
50368>>>>>>>>>>>
50368>>>>>>>>>>>        // Field-based properties.......................
50368>>>>>>>>>>>
50368>>>>>>>>>>>        // Witemx.Company_Code
50368>>>>>>>>>>>
50368>>>>>>>>>>>        // Witemx.Branch_Code
50368>>>>>>>>>>>
50368>>>>>>>>>>>        // Witemx.Year_Year
50368>>>>>>>>>>>
50368>>>>>>>>>>>        // Witemx.Units_Code
50368>>>>>>>>>>>
50368>>>>>>>>>>>        // Witemx.Witemkat_Code
50368>>>>>>>>>>>
50368>>>>>>>>>>>        // Witemx.Item_Code
50368>>>>>>>>>>>
50368>>>>>>>>>>>        // Witemx.Witemx_Code
50368>>>>>>>>>>>        Set Field_Options          Field Witemx.Witemx_Code To DD_AUTOFIND   
50369>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Code To (SL22s(Self))
50370>>>>>>>>>>>        Set Key_Field_State        Field Witemx.Witemx_Code To TRUE
50371>>>>>>>>>>>
50371>>>>>>>>>>>        // Witemx.Witemx_Recr
50371>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Recr To (SL22s(Self))
50372>>>>>>>>>>>
50372>>>>>>>>>>>        // Witemx.Year_Recr
50372>>>>>>>>>>>
50372>>>>>>>>>>>        // Witemx.Item_Recr
50372>>>>>>>>>>>
50372>>>>>>>>>>>        // Witemx.Witemx_Descr
50372>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Descr To (SL22s(Self))
50373>>>>>>>>>>>
50373>>>>>>>>>>>        // Witemx.Witemx_Rec0
50373>>>>>>>>>>>
50373>>>>>>>>>>>        // Witemx.Witemx_Yeardesc
50373>>>>>>>>>>>
50373>>>>>>>>>>>        // Witemx.Item_Apokat_Cod
50373>>>>>>>>>>>
50373>>>>>>>>>>>        // Witemx.Qty_Xre
50373>>>>>>>>>>>
50373>>>>>>>>>>>        // Witemx.Qty_Pis
50373>>>>>>>>>>>
50373>>>>>>>>>>>        // Witemx.Axia_Xre
50373>>>>>>>>>>>
50373>>>>>>>>>>>        // Witemx.Axia_Pis
50373>>>>>>>>>>>
50373>>>>>>>>>>>        // Witemx.Mesosta_Xre
50373>>>>>>>>>>>
50373>>>>>>>>>>>        // Witemx.Mesosta_Pis
50373>>>>>>>>>>>
50373>>>>>>>>>>>        // Witemx.Link1
50373>>>>>>>>>>>
50373>>>>>>>>>>>        // Witemx.Link2
50373>>>>>>>>>>>
50373>>>>>>>>>>>        //DDB-DefineFieldEnd
50373>>>>>>>>>>>    End_Procedure    // Define_Fields
50374>>>>>>>>>>>
50374>>>>>>>>>>>    // Field_Defaults:
50374>>>>>>>>>>>    // This procedure is used to establish default field values.
50374>>>>>>>>>>>
50374>>>>>>>>>>>    Procedure Field_Defaults
50375>>>>>>>>>>>        Forward Send Field_Defaults
50377>>>>>>>>>>>        //DDB-Generated-Code-Location
50377>>>>>>>>>>>        //DDB-FieldDefaultStart
50377>>>>>>>>>>>        //DDB-FieldDefaultEnd
50377>>>>>>>>>>>    End_Procedure    // Field_Defaults
50378>>>>>>>>>>>
50378>>>>>>>>>>>End_Class    // Witemx_DataDictionary
50379>>>>>>>>>>>//DDB-Selection-pkg-Start
50379>>>>>>>>>>>
50379>>>>>>>>>>>Use sl22s.SL         // SL22s
50379>>>>>>>>>>>
50379>>>>>>>>>>>//DDB-Selection-pkg-End
50379>>>>>>>>>>>//DDB-FileEnd
50379>>>>>>>>>    
50379>>>>>>>>>    //AB-IgnoreEnd
50379>>>>>>>>>
50379>>>>>>>>>    Object SL17 is a dbModalPanelSub
50381>>>>>>>>>
50381>>>>>>>>>        //AB-StoreTopStart
50381>>>>>>>>>                
50381>>>>>>>>>        Property String     pscode                  ''
50383>>>>>>>>>        Property String     psperi                  ''
50385>>>>>>>>>        Property Integer    piContains_Or_Starts     0
50387>>>>>>>>>        Property String     pscodekat               ''
50389>>>>>>>>>        
50389>>>>>>>>>        //AB-StoreTopEnd
50389>>>>>>>>>
50389>>>>>>>>>        Set Minimize_Icon to FALSE
50390>>>>>>>>>        Set Label to "„¬¨œ«ã¨ ¦ €¨®œå¦¬ „ ›é¤"
50391>>>>>>>>>        Set Size to 266 484
50392>>>>>>>>>        Set Location to 9 14
50393>>>>>>>>>        Set Exit_Application_Local_State to FALSE
50394>>>>>>>>>        Set Modal_State to FALSE
50395>>>>>>>>>
50395>>>>>>>>>        //AB-DDOStart
50395>>>>>>>>>
50395>>>>>>>>>        Object Units_DD is a Units_DataDictionary
50397>>>>>>>>>        End_Object    // Units_DD
50398>>>>>>>>>
50398>>>>>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
50400>>>>>>>>>        End_Object    // Witemkat_DD
50401>>>>>>>>>
50401>>>>>>>>>        Object Fpa_DD is a Fpa_DataDictionary
50403>>>>>>>>>        End_Object    // Fpa_DD
50404>>>>>>>>>
50404>>>>>>>>>        Object Item_DD is a Item_DataDictionary
50406>>>>>>>>>
50406>>>>>>>>>            //AB-StoreTopStart
50406>>>>>>>>>                                                                                                    
50406>>>>>>>>>                                                                                                    
50406>>>>>>>>>            //AB-StoreTopEnd
50406>>>>>>>>>
50406>>>>>>>>>            Set DDO_Server to (Units_DD(self))
50407>>>>>>>>>            Set DDO_Server to (Witemkat_DD(self))
50408>>>>>>>>>            Set DDO_Server to (Fpa_DD(self))
50409>>>>>>>>>
50409>>>>>>>>>            //AB-StoreStart
50409>>>>>>>>>                                                                                                    
50409>>>>>>>>>                                                                                                    
50409>>>>>>>>>                                                                                                    
50409>>>>>>>>>                                                                                                    
50409>>>>>>>>>                                                                                                    
50409>>>>>>>>>                                                                                                    
50409>>>>>>>>>                                                                                                    
50409>>>>>>>>>                                                                                                    
50409>>>>>>>>>            //AB-StoreEnd
50409>>>>>>>>>
50409>>>>>>>>>        End_Object    // Item_DD
50410>>>>>>>>>
50410>>>>>>>>>        Object Witemx_DD is a Witemx_DataDictionary
50412>>>>>>>>>
50412>>>>>>>>>            //AB-StoreTopStart
50412>>>>>>>>>            Function fiPeriexei Returns Integer
50414>>>>>>>>>                       String lsperi lscode  lscodekat
50415>>>>>>>>>                       Integer rVal liContains_Or_Starts
50415>>>>>>>>>                       Move 0 to rVal
50416>>>>>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
50417>>>>>>>>>                       Get psperi to lsperi
50418>>>>>>>>>                       Get pscode to lscode
50419>>>>>>>>>                       Get pscodekat to lscodekat
50420>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
50421>>>>>>>>>                       Move (Trim(lscode)) to lscode
50422>>>>>>>>>                       If (liContains_Or_Starts=0) Begin
50424>>>>>>>>>                           If ((Trim(witemx.witemx_descr)) Contains lsperi) Begin
50426>>>>>>>>>                               If ((Trim(witemx.witemx_code)) Contains lscode) Move 1 to rVal
50429>>>>>>>>>                           End
50429>>>>>>>>>>
50429>>>>>>>>>                       End
50429>>>>>>>>>>
50429>>>>>>>>>                       Else Begin
50430>>>>>>>>>                           If (Left(witemx.witemx_descr,(Length(lsperi)))=lsperi) Begin
50432>>>>>>>>>                               If (Left(witemx.witemx_code,(Length(lscode)))=lscode) Move 1 to rVal
50435>>>>>>>>>                           End
50435>>>>>>>>>>
50435>>>>>>>>>                       End
50435>>>>>>>>>>
50435>>>>>>>>>                       Function_Return rVal
50436>>>>>>>>>                   End_Function
50437>>>>>>>>>            
50437>>>>>>>>>                   Function fiArxizeiperi Returns Integer
50439>>>>>>>>>                       String lsperi
50440>>>>>>>>>                       Get psperi to lsperi
50441>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
50442>>>>>>>>>                       Function_Return (Left(witemx.witemx_descr,(Length(lsperi)))=lsperi)
50443>>>>>>>>>                   End_Function
50444>>>>>>>>>            
50444>>>>>>>>>                   Function fiArxizeicode Returns Integer
50446>>>>>>>>>                       String lscode lscodekat
50447>>>>>>>>>                       Get pscode to lscode
50448>>>>>>>>>                       Move (Trim(lscode)) to lscode
50449>>>>>>>>>                       Function_Return (Left(witemx.witemx_code,(Length(lscode)))=lscode)
50450>>>>>>>>>                   End_Function
50451>>>>>>>>>            //AB-StoreTopEnd
50451>>>>>>>>>
50451>>>>>>>>>            Set DDO_Server to (Item_DD(self))
50452>>>>>>>>>
50452>>>>>>>>>            //AB-StoreStart
50452>>>>>>>>>                                                                                
50452>>>>>>>>>            Begin_Constraints
50454>>>>>>>>>               String lsperi lscode lsvalue lstype lscodekat
50455>>>>>>>>>               Integer liContains_Or_Starts
50455>>>>>>>>>               Get psperi               to lsperi
50456>>>>>>>>>               Get pscode               to lscode
50457>>>>>>>>>               Get pscodekat            to lscodekat
50458>>>>>>>>>               Get piContains_Or_Starts to liContains_Or_Starts
50459>>>>>>>>>               Move (Trim(lsperi))      to lsperi
50460>>>>>>>>>               Move (Trim(lscode))      to lscode
50461>>>>>>>>>               Move (Trim(lscodekat))   to lscodekat
50462>>>>>>>>>               Set Ordering to 4
50463>>>>>>>>>               If ((lsperi<>'') and (lscode<>'')) Begin
50465>>>>>>>>>                    Set Ordering to 4
50466>>>>>>>>>                    Constrain witemx as (fiPeriexei(Self)=1)
50467>>>>>>>>>               End
50467>>>>>>>>>>
50467>>>>>>>>>               Else Begin
50468>>>>>>>>>                  If (liContains_Or_Starts=0) Begin
50470>>>>>>>>>                        If (lsperi<>'') Begin
50472>>>>>>>>>                            Set Ordering to 3
50473>>>>>>>>>                            Constrain witemx.witemx_descr Contains lsperi
50475>>>>>>>>>                        End
50475>>>>>>>>>>
50475>>>>>>>>>                        Else If (lscode<>'') Begin
50478>>>>>>>>>                            Set Ordering to 4
50479>>>>>>>>>                            Constrain witemx.witemx_code Contains lscode
50481>>>>>>>>>                        End
50481>>>>>>>>>>
50481>>>>>>>>>                  End
50481>>>>>>>>>>
50481>>>>>>>>>                  Else Begin
50482>>>>>>>>>                        If (lsperi<>'') Begin
50484>>>>>>>>>                            Set Ordering to 3
50485>>>>>>>>>                            Constrain witemx as (fiArxizeiperi(Self)=1) //witemx.witemx_descr
50486>>>>>>>>>                        End
50486>>>>>>>>>>
50486>>>>>>>>>                        Else If (lscode<>'') Begin
50489>>>>>>>>>                            Set Ordering to 4
50490>>>>>>>>>                            Constrain witemx as (fiArxizeicode(Self)=1) //witemx.witemx_code
50491>>>>>>>>>                        End
50491>>>>>>>>>>
50491>>>>>>>>>                  End
50491>>>>>>>>>>
50491>>>>>>>>>                  If (lscodekat<>'') Begin
50493>>>>>>>>>                        Constrain witemx.witemkat_code Contains lscodekat
50495>>>>>>>>>                  End
50495>>>>>>>>>>
50495>>>>>>>>>               End
50495>>>>>>>>>>
50495>>>>>>>>>            End_Constraints
50498>>>>>>>>>            
50498>>>>>>>>>            
50498>>>>>>>>>            //AB-StoreEnd
50498>>>>>>>>>
50498>>>>>>>>>        End_Object    // Witemx_DD
50499>>>>>>>>>
50499>>>>>>>>>        Set Main_DD to (Witemx_DD(self))
50500>>>>>>>>>        Set Server to (Witemx_DD(self))
50501>>>>>>>>>
50501>>>>>>>>>        //AB-DDOEnd
50501>>>>>>>>>
50501>>>>>>>>>        Object oSelList is a dbListSub
50503>>>>>>>>>            Set Main_File to Witemx.File_Number
50504>>>>>>>>>            Set Ordering to 5
50505>>>>>>>>>            Set Size to 190 475
50506>>>>>>>>>            Set Location to 1 1
50507>>>>>>>>>            Set Color to 14280447
50508>>>>>>>>>            Set CurrentRowColor to 11783679
50509>>>>>>>>>            Set CurrentCellColor to 11783679
50510>>>>>>>>>            Set Auto_Index_State to FALSE
50511>>>>>>>>>
50511>>>>>>>>>            Begin_Row
50514>>>>>>>>>                Entry_Item Witemx.Witemx_code
50515>>>>>>>>>                Entry_Item Witemx.Witemx_descr
50516>>>>>>>>>                Entry_Item Witemx.Witemkat_code
50517>>>>>>>>>                Entry_Item Witemkat.Witemkat_descr
50518>>>>>>>>>                Entry_Item Item.Item_qual
50519>>>>>>>>>                Entry_Item Fpa.Fpa_pososto
50520>>>>>>>>>            End_Row
50525>>>>>>>>>
50525>>>>>>>>>            Set Form_Width    item 0 to 60
50526>>>>>>>>>            Set Header_Label  item 0 to "‰à›. „å›¦¬ª"
50527>>>>>>>>>            
50527>>>>>>>>>            Set Form_Width    item 1 to 140
50528>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
50529>>>>>>>>>            
50529>>>>>>>>>            Set Form_Width    item 2 to 70
50530>>>>>>>>>            Set Header_Label  item 2 to "‰à›. ‰˜«žš¦¨å˜ª"
50531>>>>>>>>>            
50531>>>>>>>>>            Set Form_Width    item 3 to 88
50532>>>>>>>>>            Set Header_Label  item 3 to "œ¨ š¨˜­ã ‰˜«žš."
50533>>>>>>>>>            
50533>>>>>>>>>            Set Form_Width    item 4 to 64
50534>>>>>>>>>            Set Header_Label  item 4 to "¦ æ«ž«˜"
50535>>>>>>>>>            
50535>>>>>>>>>            Set Form_Width    item 5 to 45
50536>>>>>>>>>            Set Header_Label  item 5 to "‰˜«.”..€"
50537>>>>>>>>>            
50537>>>>>>>>>
50537>>>>>>>>>            //AB-StoreStart
50537>>>>>>>>>            Property String Store_Fragma_Items public ""
50539>>>>>>>>>            set export_item_state to true
50540>>>>>>>>>            
50540>>>>>>>>>            Procedure End_Construct_Object
50542>>>>>>>>>                Forward Send End_Construct_Object
50544>>>>>>>>>                Set Color               to 14280447
50545>>>>>>>>>                Set CurrentRowColor     to 11783679
50546>>>>>>>>>                Set CurrentCellColor    to 11783679
50547>>>>>>>>>            End_Procedure
50548>>>>>>>>>            
50548>>>>>>>>>            Procedure Activating Returns Integer
50550>>>>>>>>>                Integer rVal
50551>>>>>>>>>                Forward Get Msg_Activating to rVal
50553>>>>>>>>>                set auto_index_state to true
50554>>>>>>>>>                Procedure_Return rVal
50555>>>>>>>>>            End_Procedure
50556>>>>>>>>>            
50556>>>>>>>>>            procedure move_value_out
50558>>>>>>>>>                forward send move_value_out
50560>>>>>>>>>                set value of (ocode(self)) to ''
50561>>>>>>>>>                set value of (operi(self)) to ''
50562>>>>>>>>>                set value of (ocodekat(self)) to ''
50563>>>>>>>>>                set psperi to ''
50564>>>>>>>>>                set pscode to ''
50565>>>>>>>>>                set pscodekat to ''
50566>>>>>>>>>            end_procedure
50567>>>>>>>>>            
50567>>>>>>>>>            
50567>>>>>>>>>            
50567>>>>>>>>>            
50567>>>>>>>>>            
50567>>>>>>>>>            
50567>>>>>>>>>            
50567>>>>>>>>>            
50567>>>>>>>>>            
50567>>>>>>>>>            //AB-StoreEnd
50567>>>>>>>>>
50567>>>>>>>>>        End_Object    // oSelList
50568>>>>>>>>>
50568>>>>>>>>>        Object TextBoxSub1 is a TextBoxSub
50570>>>>>>>>>            Set Label to "‘á¨à©ž ¡à› ¡¦ç š ˜"
50571>>>>>>>>>            Set Auto_Size_State to FALSE
50572>>>>>>>>>            Set Location to 192 6
50573>>>>>>>>>            Set Size to 13 69
50574>>>>>>>>>        End_Object    // TextBoxSub1
50575>>>>>>>>>
50575>>>>>>>>>        Object ocode is a FormSub
50577>>>>>>>>>            Set Size to 13 197
50578>>>>>>>>>            Set Location to 192 79
50579>>>>>>>>>            Set Label_Col_Offset to 2
50580>>>>>>>>>
50580>>>>>>>>>            //AB-StoreStart
50580>>>>>>>>>            
50580>>>>>>>>>            
50580>>>>>>>>>            
50580>>>>>>>>>            
50580>>>>>>>>>            
50580>>>>>>>>>            
50580>>>>>>>>>            
50580>>>>>>>>>            
50580>>>>>>>>>            //AB-StoreEnd
50580>>>>>>>>>
50580>>>>>>>>>        End_Object    // ocode
50581>>>>>>>>>
50581>>>>>>>>>        Object TextBoxSub2 is a TextBoxSub
50583>>>>>>>>>            Set Label to "‘á¨à©ž §œ¨ š¨˜­ãª "
50584>>>>>>>>>            Set Auto_Size_State to FALSE
50585>>>>>>>>>            Set Location to 207 6
50586>>>>>>>>>            Set Size to 13 71
50587>>>>>>>>>        End_Object    // TextBoxSub2
50588>>>>>>>>>
50588>>>>>>>>>        Object operi is a FormSub
50590>>>>>>>>>            Set Size to 13 197
50591>>>>>>>>>            Set Location to 207 79
50592>>>>>>>>>            Set Label_Col_Offset to 2
50593>>>>>>>>>
50593>>>>>>>>>            //AB-StoreStart
50593>>>>>>>>>            
50593>>>>>>>>>            
50593>>>>>>>>>            
50593>>>>>>>>>            
50593>>>>>>>>>            
50593>>>>>>>>>            
50593>>>>>>>>>            
50593>>>>>>>>>            //AB-StoreEnd
50593>>>>>>>>>
50593>>>>>>>>>        End_Object    // operi
50594>>>>>>>>>
50594>>>>>>>>>        Object RadioGroupSub1 is a RadioGroupSub
50596>>>>>>>>>            Set Size to 32 77
50597>>>>>>>>>            Set Location to 191 279
50598>>>>>>>>>            Object Radio1 is a RadioSub
50600>>>>>>>>>                Set Label to "œ¨ â®œ«˜ "
50601>>>>>>>>>                Set Size to 10 53
50602>>>>>>>>>                Set Location to 7 5
50603>>>>>>>>>            End_Object    // Radio1
50604>>>>>>>>>
50604>>>>>>>>>            Object Radio2 is a RadioSub
50606>>>>>>>>>                Set Label to "€¨®åœ  €§¦"
50607>>>>>>>>>                Set Size to 10 52
50608>>>>>>>>>                Set Location to 21 5
50609>>>>>>>>>            End_Object    // Radio2
50610>>>>>>>>>
50610>>>>>>>>>
50610>>>>>>>>>            //AB-StoreStart
50610>>>>>>>>>            
50610>>>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
50612>>>>>>>>>                Set piContains_Or_Starts to iToItem
50613>>>>>>>>>            End_Procedure
50614>>>>>>>>>            
50614>>>>>>>>>            
50614>>>>>>>>>            
50614>>>>>>>>>            
50614>>>>>>>>>            
50614>>>>>>>>>            //AB-StoreEnd
50614>>>>>>>>>
50614>>>>>>>>>        End_Object    // RadioGroupSub1
50615>>>>>>>>>
50615>>>>>>>>>        Object ButtonSub1 is a ButtonSub
50617>>>>>>>>>            Set Label to "œ¨ æ¨ ©œ"
50618>>>>>>>>>            Set Size to 15 197
50619>>>>>>>>>            Set Location to 236 79
50620>>>>>>>>>            Set Form_FontWeight Item 0 to 800
50621>>>>>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
50622>>>>>>>>>
50622>>>>>>>>>            //AB-StoreStart
50622>>>>>>>>>            
50622>>>>>>>>>            Procedure OnClick
50624>>>>>>>>>                Forward Send OnClick
50626>>>>>>>>>                Set pscode      to (Value(ocode(Self),0))
50627>>>>>>>>>                Set psperi      to (Value(operi(Self),0))
50628>>>>>>>>>                Set pscodekat   to (Value(ocodekat(Self),0))
50629>>>>>>>>>                send Rebuild_Constraints    to (witemx_DD(Self))
50630>>>>>>>>>                Send Beginning_Of_Data      to oSelList True
50631>>>>>>>>>            End_Procedure // OnClick
50632>>>>>>>>>            
50632>>>>>>>>>            
50632>>>>>>>>>            //AB-StoreEnd
50632>>>>>>>>>
50632>>>>>>>>>        End_Object    // ButtonSub1
50633>>>>>>>>>
50633>>>>>>>>>        Object TextBoxSub3 is a TextBoxSub
50635>>>>>>>>>            Set Label to "‰à›. ¡˜«žš¦¨å˜ª š ˜"
50636>>>>>>>>>            Set Auto_Size_State to FALSE
50637>>>>>>>>>            Set Location to 221 5
50638>>>>>>>>>            Set Size to 13 70
50639>>>>>>>>>        End_Object    // TextBoxSub3
50640>>>>>>>>>
50640>>>>>>>>>        Object ocodekat is a FormSub
50642>>>>>>>>>            Set Size to 13 197
50643>>>>>>>>>            Set Location to 221 79
50644>>>>>>>>>            Set Label_Col_Offset to 2
50645>>>>>>>>>
50645>>>>>>>>>            //AB-StoreStart
50645>>>>>>>>>            
50645>>>>>>>>>            
50645>>>>>>>>>            
50645>>>>>>>>>            
50645>>>>>>>>>            
50645>>>>>>>>>            
50645>>>>>>>>>            
50645>>>>>>>>>            //AB-StoreEnd
50645>>>>>>>>>
50645>>>>>>>>>        End_Object    // ocodekat
50646>>>>>>>>>
50646>>>>>>>>>        Object oOK_bn is a ButtonSub
50648>>>>>>>>>            Set Label to "&„§ ¢¦šã"
50649>>>>>>>>>            Set Location to 232 318
50650>>>>>>>>>
50650>>>>>>>>>            //AB-StoreStart
50650>>>>>>>>>            Procedure OnClick
50652>>>>>>>>>                Send OK To (oSelList(current_object))
50653>>>>>>>>>            End_Procedure
50654>>>>>>>>>            //AB-StoreEnd
50654>>>>>>>>>
50654>>>>>>>>>        End_Object    // oOK_bn
50655>>>>>>>>>
50655>>>>>>>>>        Object oCancel_bn is a ButtonSub
50657>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
50658>>>>>>>>>            Set Location to 232 373
50659>>>>>>>>>
50659>>>>>>>>>            //AB-StoreStart
50659>>>>>>>>>            Procedure OnClick
50661>>>>>>>>>                Send Cancel To (oSelList(current_object))
50662>>>>>>>>>            End_Procedure
50663>>>>>>>>>            //AB-StoreEnd
50663>>>>>>>>>
50663>>>>>>>>>        End_Object    // oCancel_bn
50664>>>>>>>>>
50664>>>>>>>>>        Object oSearch_bn is a ButtonSub
50666>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
50667>>>>>>>>>            Set Location to 232 428
50668>>>>>>>>>
50668>>>>>>>>>            //AB-StoreStart
50668>>>>>>>>>            Procedure OnClick
50670>>>>>>>>>                Send Search To (oSelList(current_object))
50671>>>>>>>>>            End_Procedure
50672>>>>>>>>>            //AB-StoreEnd
50672>>>>>>>>>
50672>>>>>>>>>        End_Object    // oSearch_bn
50673>>>>>>>>>
50673>>>>>>>>>        Object btnwitemcl is a ButtonSub
50675>>>>>>>>>
50675>>>>>>>>>            //AB-StoreTopStart
50675>>>>>>>>>            
50675>>>>>>>>>            //AB-StoreTopEnd
50675>>>>>>>>>
50675>>>>>>>>>            Set Label to "ButtonSub1"
50676>>>>>>>>>            Set Bitmap to "Filesys3.bmp"
50677>>>>>>>>>            Set Size to 22 25
50678>>>>>>>>>            Set Location to 196 443
50679>>>>>>>>>            Set Focus_Mode to Pointer_Only
50680>>>>>>>>>
50680>>>>>>>>>            //AB-StoreStart
50680>>>>>>>>>            
50680>>>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ œ¬¨œ«ã¨ ¦ „ ›é¤ / ¨¦£žŸœ¬«ã"
50681>>>>>>>>>            
50681>>>>>>>>>            Procedure OnClick
50683>>>>>>>>>                String  scode speri
50684>>>>>>>>>                Get value of (ocode(self)) to scode
50685>>>>>>>>>                Get value of (operi(self)) to speri
50686>>>>>>>>>                set pscode of (dg186(self)) to scode
50687>>>>>>>>>                set psperi of (dg186(self)) to speri
50688>>>>>>>>>               Send popup_modal to (dg186(self))
50689>>>>>>>>>            End_Procedure // OnClick
50690>>>>>>>>>            
50690>>>>>>>>>            
50690>>>>>>>>>            
50690>>>>>>>>>            
50690>>>>>>>>>            
50690>>>>>>>>>            
50690>>>>>>>>>            
50690>>>>>>>>>            
50690>>>>>>>>>            
50690>>>>>>>>>            
50690>>>>>>>>>            
50690>>>>>>>>>            
50690>>>>>>>>>            
50690>>>>>>>>>            
50690>>>>>>>>>            
50690>>>>>>>>>            
50690>>>>>>>>>            
50690>>>>>>>>>            
50690>>>>>>>>>            
50690>>>>>>>>>            
50690>>>>>>>>>            
50690>>>>>>>>>            
50690>>>>>>>>>            
50690>>>>>>>>>            //AB-StoreEnd
50690>>>>>>>>>
50690>>>>>>>>>        End_Object    // btnwitemcl
50691>>>>>>>>>
50691>>>>>>>>>
50691>>>>>>>>>        //AB-StoreStart
50691>>>>>>>>>                
50691>>>>>>>>>        Set Locate_Mode to Center_On_Screen
50692>>>>>>>>>        
50692>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
50693>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
50694>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
50695>>>>>>>>>        
50695>>>>>>>>>        Procedure Activate
50697>>>>>>>>>            Send Rebuild_Constraints    to Witemx_DD
50698>>>>>>>>>            Send Beginning_Of_Data      to oSelList True
50699>>>>>>>>>            Forward Send Activate
50701>>>>>>>>>        End_Procedure
50702>>>>>>>>>        
50702>>>>>>>>>        procedure request_cancel
50704>>>>>>>>>            forward send request_cancel
50706>>>>>>>>>            set value of (ocode(self)) to ''
50707>>>>>>>>>            set value of (operi(self)) to ''
50708>>>>>>>>>            set value of (ocodekat(self)) to ''
50709>>>>>>>>>            Set psperi  to ''
50710>>>>>>>>>            Set pscode  to ''
50711>>>>>>>>>            Set pscodekat TO ''
50712>>>>>>>>>        end_procedure
50713>>>>>>>>>        
50713>>>>>>>>>        
50713>>>>>>>>>        
50713>>>>>>>>>        
50713>>>>>>>>>        
50713>>>>>>>>>        
50713>>>>>>>>>        
50713>>>>>>>>>        
50713>>>>>>>>>        
50713>>>>>>>>>        //AB-StoreEnd
50713>>>>>>>>>
50713>>>>>>>>>    End_Object    // SL17
50714>>>>>>>>>
50714>>>>>>>>>
50714>>>>>>>>>    //AB-StoreStart
50714>>>>>>>>>    
50714>>>>>>>>>    
50714>>>>>>>>>    
50714>>>>>>>>>    
50714>>>>>>>>>    
50714>>>>>>>>>    
50714>>>>>>>>>    
50714>>>>>>>>>    
50714>>>>>>>>>    
50714>>>>>>>>>    
50714>>>>>>>>>    
50714>>>>>>>>>    
50714>>>>>>>>>    //AB-StoreEnd
50714>>>>>>>>>
50714>>>>>>>>>//AB/     End_Object    // prj
50714>>>>>>>Use wax.sl           // Wax
50714>>>>>>>
50714>>>>>>>//DDB-Selection-pkg-End
50714>>>>>>>//DDB-FileEnd
50714>>>>>
50714>>>>>//AB-IgnoreEnd
50714>>>>>
50714>>>>>Object sl182 is a dbModalPanelSub
50716>>>>>
50716>>>>>    //AB-StoreTopStart
50716>>>>>                    
50716>>>>>    //AB-StoreTopEnd
50716>>>>>
50716>>>>>    Set Label to "ƒœ¢«å˜ „©à«œ¨ ¡ãª ƒ ˜¡å¤ž©žª „ ›é¤"
50717>>>>>    Set Size to 262 331
50718>>>>>    Set Location to 5 72
50719>>>>>    Set Exit_Application_Local_State to FALSE
50720>>>>>    Set Modal_State to FALSE
50721>>>>>
50721>>>>>    //AB-DDOStart
50721>>>>>
50721>>>>>    Object Witemxtr_DD is a Witemxtr_DataDictionary
50723>>>>>    End_Object    // Witemxtr_DD
50724>>>>>
50724>>>>>    Object Witemxtd_DD is a Witemxtd_DataDictionary
50726>>>>>        Set DDO_Server to (Witemxtr_DD(self))
50727>>>>>        Set Constrain_File to Witemxtr.File_Number
50728>>>>>    End_Object    // Witemxtd_DD
50729>>>>>
50729>>>>>    Set Main_DD to (Witemxtr_DD(self))
50730>>>>>    Set Server to (Witemxtr_DD(self))
50731>>>>>
50731>>>>>    //AB-DDOEnd
50731>>>>>
50731>>>>>    Object oSelList is a dbListSub
50733>>>>>        Set Main_File to Witemxtr.File_Number
50734>>>>>        Set Size to 220 311
50735>>>>>        Set Location to 6 6
50736>>>>>
50736>>>>>        Begin_Row
50739>>>>>            Entry_Item Witemxtr.Hmnia
50740>>>>>            Entry_Item Witemxtr.Descr
50741>>>>>            Entry_Item Witemxtr.Qty
50742>>>>>            Entry_Item Witemxtr.Ekleise
50743>>>>>        End_Row
50748>>>>>
50748>>>>>        Set Form_Width    item 0 to 48
50749>>>>>        Set Header_Label  item 0 to "†£/¤å˜"
50750>>>>>        
50750>>>>>        Set Form_Width    item 1 to 200
50751>>>>>        Set Header_Label  item 1 to "˜¨˜©«˜« ¡æ"
50752>>>>>        
50752>>>>>        Set Form_Width    item 2 to 35
50753>>>>>        Set Header_Label  item 2 to "¦©¦«."
50754>>>>>        
50754>>>>>        Set Form_Width    item 3 to 20
50755>>>>>        Set Header_Label  item 3 to "Ž‰"
50756>>>>>        Set Column_Checkbox_State  item 3 to True
50757>>>>>        
50757>>>>>
50757>>>>>        //AB-StoreStart
50757>>>>>        
50757>>>>>        Procedure End_Construct_Object
50759>>>>>            String  sNom
50760>>>>>            Integer iDecs
50760>>>>>            Forward Send End_Construct_Object
50762>>>>>            Move SysCurxr.C_Code0 to sNom
50763>>>>>            Clear Nomisma
50764>>>>>            Move sNom to Nomisma.Nomisma_Code
50765>>>>>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
50766>>>>>>
50766>>>>>            If (Found=1)    Move Nomisma.Dekadika to iDecs
50769>>>>>            Else            Move 0 to iDecs
50771>>>>>        
50771>>>>>            // Ž¨ ¦¬£œ §àª ˜¤ «¦ ™˜© ¡æ ¤¦£ ©£˜ ®¨ã©žª ƒ„Œ œ®œ  ›œ¡˜› ¡á
50771>>>>>            // «æ«œ œ¥' ¦¨ ©£¦ç ™á¦¬£œ œ£œ ª 2
50771>>>>>            If (iDecs=0) Move 2 to iDecs
50774>>>>>            //
50774>>>>>            Set Points          Item 2 to      2
50775>>>>>        
50775>>>>>        End_Procedure
50776>>>>>        
50776>>>>>        
50776>>>>>        
50776>>>>>        
50776>>>>>        
50776>>>>>        
50776>>>>>        
50776>>>>>        
50776>>>>>        
50776>>>>>        //AB-StoreEnd
50776>>>>>
50776>>>>>    End_Object    // oSelList
50777>>>>>
50777>>>>>    Object oOK_bn is a ButtonSub
50779>>>>>        Set Label to "&„§ ¢¦šã"
50780>>>>>        Set Location to 230 158
50781>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
50782>>>>>
50782>>>>>        //AB-StoreStart
50782>>>>>        Procedure OnClick
50784>>>>>            Send OK To (oSelList(current_object))
50785>>>>>        End_Procedure
50786>>>>>        //AB-StoreEnd
50786>>>>>
50786>>>>>    End_Object    // oOK_bn
50787>>>>>
50787>>>>>    Object oCancel_bn is a ButtonSub
50789>>>>>        Set Label to "&€¡ç¨à©ž"
50790>>>>>        Set Location to 230 214
50791>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
50792>>>>>
50792>>>>>        //AB-StoreStart
50792>>>>>        Procedure OnClick
50794>>>>>            Send Cancel To (oSelList(current_object))
50795>>>>>        End_Procedure
50796>>>>>        //AB-StoreEnd
50796>>>>>
50796>>>>>    End_Object    // oCancel_bn
50797>>>>>
50797>>>>>    Object oSearch_bn is a ButtonSub
50799>>>>>        Set Label to "€&¤˜ã«ž©ž..."
50800>>>>>        Set Location to 230 268
50801>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
50802>>>>>
50802>>>>>        //AB-StoreStart
50802>>>>>        Procedure OnClick
50804>>>>>            Send Search To (oSelList(current_object))
50805>>>>>        End_Procedure
50806>>>>>        //AB-StoreEnd
50806>>>>>
50806>>>>>    End_Object    // oSearch_bn
50807>>>>>
50807>>>>>
50807>>>>>    //AB-StoreStart
50807>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
50808>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
50809>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
50810>>>>>    
50810>>>>>    
50810>>>>>    
50810>>>>>    
50810>>>>>    
50810>>>>>    
50810>>>>>    //AB-StoreEnd
50810>>>>>
50810>>>>>End_Object    // sl182
50811>>>>>
50811>>>>>
50811>>>>>//AB-StoreStart
50811>>>>>                                    
50811>>>>>//AB-StoreEnd
50811>>>>>
50811>>>>>//AB/ End_Object    // prj
50811>>>Use sl186a.sl
INCLUDING FILE: SL186A.SL
50811>>>>>//AB/ Project sl186a:item-clients
50811>>>>>//AB/ Object prj is a Lookup_Project
50811>>>>>//AB/     Set ProjectName to "sl186a:item-clients"
50811>>>>>//AB/     Set ProjectFileName to "sl186a.SL"
50811>>>>>//AB/     Set GenerateFileName to "NONAME"
50811>>>>>
50811>>>>>// Project Object Structure
50811>>>>>//   sl186a is a dbModalPanelSub
50811>>>>>//     clients_dd2 is a clients_DataDictionary
50811>>>>>//     Witemkat_DD is a DataDictionary
50811>>>>>//     Units_DD is a DataDictionary
50811>>>>>//     Fpa_DD is a DataDictionary
50811>>>>>//     Item_DD is a DataDictionary
50811>>>>>//     Witemcl_DD is a DataDictionary
50811>>>>>//     oSelList is a dblist
50811>>>>>//     oOK_bn is a ButtonSub
50811>>>>>//     oCancel_bn is a ButtonSub
50811>>>>>//     oSearch_bn is a ButtonSub
50811>>>>>
50811>>>>>// Register all objects
50811>>>>>Register_Object clients_dd2
50811>>>>>Register_Object Fpa_DD
50811>>>>>Register_Object Item_DD
50811>>>>>Register_Object oCancel_bn
50811>>>>>Register_Object oOK_bn
50811>>>>>Register_Object oSearch_bn
50811>>>>>Register_Object oSelList
50811>>>>>Register_Object sl186a
50811>>>>>Register_Object Units_DD
50811>>>>>Register_Object Witemcl_DD
50811>>>>>Register_Object Witemkat_DD
50811>>>>>
50811>>>>>
50811>>>>>
50811>>>>>//AB-StoreTopStart
50811>>>>>open clients
50813>>>>>
50813>>>>>//AB-StoreTopEnd
50813>>>>>
50813>>>>>//AB-IgnoreStart
50813>>>>>
50813>>>>>Use DFAllEnt.pkg
50813>>>>>Use dbList.Sub
50813>>>>>Use Button.Sub
50813>>>>>
50813>>>>>
50813>>>>>Use WITEMKAT.DD
50813>>>>>Use UNITS.DD
50813>>>>>Use FPA.DD
50813>>>>>Use ITEM.DD
50813>>>>>Use WITEMCL.DD
50813>>>>>
50813>>>>>//AB-IgnoreEnd
50813>>>>>
50813>>>>>Object sl186a is a dbModalPanelSub
50815>>>>>
50815>>>>>    //AB-StoreTopStart
50815>>>>>
50815>>>>>    Property String Fragmaprom Public ""
50817>>>>>
50817>>>>>    object clients_dd2 is a clients_DataDictionary
50819>>>>>    end_object
50820>>>>>
50820>>>>>    Function fnclient String asCode Returns string
50822>>>>>        String sDescr
50823>>>>>        send clear to clients_dd2
50824>>>>>        move asCode to clients.client_id
50825>>>>>        send find to clients_dd2 eq 6
50826>>>>>        get field_current_value of clients_dd2 field clients.client_name to sDescr
50827>>>>>        function_return sDescr
50828>>>>>    end_Function
50829>>>>>
50829>>>>>    //AB-StoreTopEnd
50829>>>>>
50829>>>>>    Set Label to "„å›ž €¤á ¨¦£žŸœ¬«ã"
50830>>>>>    Set Size to 254 495
50831>>>>>    Set Location to 5 5
50832>>>>>    Set Exit_Application_Local_State to FALSE
50833>>>>>    Set Modal_State to FALSE
50834>>>>>
50834>>>>>    //AB-DDOStart
50834>>>>>
50834>>>>>    Object Witemkat_DD is a Witemkat_DataDictionary
50836>>>>>    End_Object    // Witemkat_DD
50837>>>>>
50837>>>>>    Object Units_DD is a Units_DataDictionary
50839>>>>>    End_Object    // Units_DD
50840>>>>>
50840>>>>>    Object Fpa_DD is a Fpa_DataDictionary
50842>>>>>    End_Object    // Fpa_DD
50843>>>>>
50843>>>>>    Object Item_DD is a Item_DataDictionary
50845>>>>>        Set DDO_Server to (Units_DD(self))
50846>>>>>        Set DDO_Server to (Witemkat_DD(self))
50847>>>>>        Set DDO_Server to (Fpa_DD(self))
50848>>>>>    End_Object    // Item_DD
50849>>>>>
50849>>>>>    Object Witemcl_DD is a Witemcl_DataDictionary
50851>>>>>        Set DDO_Server to (Item_DD(self))
50852>>>>>
50852>>>>>        //AB-StoreStart
50852>>>>>
50852>>>>>        Begin_Constraints
50854>>>>>            If (fragmaprom(Self)<>'') Begin
50856>>>>>                Constrain witemcl.client_code eq (fragmaprom(Self))
50858>>>>>            End
50858>>>>>>
50858>>>>>        End_Constraints
50861>>>>>
50861>>>>>
50861>>>>>        //AB-StoreEnd
50861>>>>>
50861>>>>>    End_Object    // Witemcl_DD
50862>>>>>
50862>>>>>    Set Main_DD to (Witemcl_DD(self))
50863>>>>>    Set Server to (Witemcl_DD(self))
50864>>>>>
50864>>>>>    //AB-DDOEnd
50864>>>>>
50864>>>>>    Object oSelList is a dblist
50866>>>>>        Set Main_File to Witemcl.File_Number
50867>>>>>        Set Ordering to 2
50868>>>>>        Set Size to 212 480
50869>>>>>        Set Location to 6 6
50870>>>>>        Set Color to 14280447
50871>>>>>        Set CurrentRowColor to 11783679
50872>>>>>        Set CurrentCellColor to 11783679
50873>>>>>
50873>>>>>        Begin_Row
50876>>>>>            Entry_Item Item.Item_code
50877>>>>>            Entry_Item Item.Item_descr
50878>>>>>            Entry_Item Witemcl.Client_code
50879>>>>>            Entry_Item (Fnclient(self,witemcl.client_code))
50880>>>>>            Entry_Item Witemcl.Client_itemcode
50881>>>>>            Entry_Item Witemcl.Client_date
50882>>>>>            Entry_Item Witemcl.Client_price
50883>>>>>        End_Row
50888>>>>>
50888>>>>>        Set Form_Width    item 0 to 61
50889>>>>>        Set Header_Label  item 0 to "‰à›.„å›¦¬ª"
50890>>>>>
50890>>>>>        Set Form_Width    item 1 to 90
50891>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã „å›¦¬ª"
50892>>>>>
50892>>>>>        Set Form_Width    item 2 to 55
50893>>>>>        Set Header_Label  item 2 to "‰à›.”¦¨â˜"
50894>>>>>
50894>>>>>        Set Form_Width    item 3 to 96
50895>>>>>        Set Header_Label  item 3 to "„§à¤¬£å˜ ”¦¨â˜"
50896>>>>>
50896>>>>>        Set Form_Width    item 4 to 60
50897>>>>>        Set Header_Label  item 4 to "„å›¦ª ¨¦£žŸ."
50898>>>>>
50898>>>>>        Set Form_Width    item 5 to 60
50899>>>>>        Set Header_Label  item 5 to "’'†£/¤å˜ „ ©˜š."
50900>>>>>
50900>>>>>        Set Form_Width    item 6 to 52
50901>>>>>        Set Header_Label  item 6 to "’'’ £ã „ ©˜š."
50902>>>>>
50902>>>>>
50902>>>>>        //AB-StoreStart
50902>>>>>
50902>>>>>        Property String Store_Fragma_prom public ""
50904>>>>>
50904>>>>>        Procedure Store_Defaults
50906>>>>>           forward send Store_Defaults
50908>>>>>           Set Store_Fragma_prom to (Fragmaprom(Self))
50909>>>>>        end_Procedure
50910>>>>>
50910>>>>>        Procedure Restore_Defaults
50912>>>>>            forward send Restore_Defaults
50914>>>>>            Set Fragmaprom to (Store_Fragma_prom(Self))
50915>>>>>        end_Procedure
50916>>>>>
50916>>>>>        Procedure Activating
50918>>>>>            Forward Send Activating
50920>>>>>            Send Rebuild_Constraints to WitemCl_DD
50921>>>>>        End_Procedure
50922>>>>>
50922>>>>>        Procedure End_Construct_Object
50924>>>>>            Integer iDecimals
50925>>>>>            Forward Send End_Construct_Object
50927>>>>>            Get fiDekadika_Nomismatos  SysCurXr.C_Code0  to    iDecimals
50928>>>>>            Set Points          Item 6 to       iDecimals
50929>>>>>            Set Numeric_Mask    Item 6 to 14    iDecimals '*, '
50930>>>>>        End_Procedure
50931>>>>>
50931>>>>>
50931>>>>>
50931>>>>>
50931>>>>>
50931>>>>>
50931>>>>>
50931>>>>>        //AB-StoreEnd
50931>>>>>
50931>>>>>    End_Object    // oSelList
50932>>>>>
50932>>>>>    Object oOK_bn is a ButtonSub
50934>>>>>        Set Label to "&„§ ¢¦šã"
50935>>>>>        Set Location to 222 326
50936>>>>>
50936>>>>>        //AB-StoreStart
50936>>>>>        Procedure OnClick
50938>>>>>            Send OK To (oSelList(current_object))
50939>>>>>        End_Procedure
50940>>>>>        //AB-StoreEnd
50940>>>>>
50940>>>>>    End_Object    // oOK_bn
50941>>>>>
50941>>>>>    Object oCancel_bn is a ButtonSub
50943>>>>>        Set Label to "&€¡ç¨à©ž"
50944>>>>>        Set Location to 222 381
50945>>>>>
50945>>>>>        //AB-StoreStart
50945>>>>>        Procedure OnClick
50947>>>>>            Send Cancel To (oSelList(current_object))
50948>>>>>        End_Procedure
50949>>>>>        //AB-StoreEnd
50949>>>>>
50949>>>>>    End_Object    // oCancel_bn
50950>>>>>
50950>>>>>    Object oSearch_bn is a ButtonSub
50952>>>>>        Set Label to "€&¤˜ã«ž©ž..."
50953>>>>>        Set Location to 222 436
50954>>>>>
50954>>>>>        //AB-StoreStart
50954>>>>>        Procedure OnClick
50956>>>>>            Send Search To (oSelList(current_object))
50957>>>>>        End_Procedure
50958>>>>>        //AB-StoreEnd
50958>>>>>
50958>>>>>    End_Object    // oSearch_bn
50959>>>>>
50959>>>>>
50959>>>>>    //AB-StoreStart
50959>>>>>
50959>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
50960>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
50961>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
50962>>>>>    procedure page integer pagemode
50964>>>>>        forward send page pagemode
50966>>>>>        set location to 40,40
50967>>>>>    end_procedure
50968>>>>>
50968>>>>>
50968>>>>>
50968>>>>>
50968>>>>>
50968>>>>>
50968>>>>>
50968>>>>>
50968>>>>>
50968>>>>>
50968>>>>>
50968>>>>>
50968>>>>>
50968>>>>>    //AB-StoreEnd
50968>>>>>
50968>>>>>End_Object    // sl186a
50969>>>>>
50969>>>>>
50969>>>>>//AB-StoreStart
50969>>>>>
50969>>>>>
50969>>>>>
50969>>>>>
50969>>>>>//AB-StoreEnd
50969>>>>>
50969>>>>>//AB/ End_Object    // prj
50969>>>Use sl185.sl
INCLUDING FILE: SL185.SL
50969>>>>>//AB/ Project sl185:entoles paragoghs
50969>>>>>//AB/ Object prj is a Lookup_Project
50969>>>>>//AB/     Set ProjectName to "sl185:entoles paragoghs"
50969>>>>>//AB/     Set ProjectFileName to "sl185.SL"
50969>>>>>//AB/     Set GenerateFileName to "NONAME"
50969>>>>>
50969>>>>>// Project Object Structure
50969>>>>>//   sl185 is a dbModalPanelSub
50969>>>>>//     Units_DD is a DataDictionary
50969>>>>>//     Witemkat_DD is a DataDictionary
50969>>>>>//     Fpa_DD is a DataDictionary
50969>>>>>//     Item_DD is a DataDictionary
50969>>>>>//     Witemx_DD is a DataDictionary
50969>>>>>//     Witemxen_DD is a DataDictionary
50969>>>>>//     oSelList is a dbListSub
50969>>>>>//     oOK_bn is a ButtonSub
50969>>>>>//     oCancel_bn is a ButtonSub
50969>>>>>//     oSearch_bn is a ButtonSub
50969>>>>>
50969>>>>>// Register all objects
50969>>>>>Register_Object Fpa_DD
50969>>>>>Register_Object Item_DD
50969>>>>>Register_Object oCancel_bn
50969>>>>>Register_Object oOK_bn
50969>>>>>Register_Object oSearch_bn
50969>>>>>Register_Object oSelList
50969>>>>>Register_Object sl185
50969>>>>>Register_Object Units_DD
50969>>>>>Register_Object Witemkat_DD
50969>>>>>Register_Object Witemx_DD
50969>>>>>Register_Object Witemxen_DD
50969>>>>>
50969>>>>>
50969>>>>>//AB-IgnoreStart
50969>>>>>
50969>>>>>Use DFAllEnt.pkg
50969>>>>>Use dbList.Sub
50969>>>>>Use Button.Sub
50969>>>>>
50969>>>>>
50969>>>>>Use UNITS.DD
50969>>>>>Use WITEMKAT.DD
50969>>>>>Use FPA.DD
50969>>>>>Use ITEM.DD
50969>>>>>Use WITEMX.DD
50969>>>>>Use WITEMXEN.DD
INCLUDING FILE: WITEMXEN.DD
50969>>>>>>>//DDB-FileStart
50969>>>>>>>//DDB-HeaderStart
50969>>>>>>>
50969>>>>>>>// File Name : WITEMXEN.DD
50969>>>>>>>// Class Name: Witemxen_DataDictionary
50969>>>>>>>// Revision  : 30
50969>>>>>>>// Version   : 2
50969>>>>>>>
50969>>>>>>>Use  Windows           // Basic Definitions
50969>>>>>>>Use  DataDict          // DataDictionary Class Definition
50969>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
50969>>>>>>>
50969>>>>>>>Open Witemxen
50971>>>>>>>Open Witemxed
INCLUDING FILE: WITEMXED.FD
50973>>>>>>>Open Witemx
50975>>>>>>>Open Sysrecw
50977>>>>>>>Open Branch
50979>>>>>>>
50979>>>>>>>//DDB-HeaderEnd
50979>>>>>>>//DDB-ValidationStart
50979>>>>>>>
50979>>>>>>>Register_Object Witemxen_Status_VT
50979>>>>>>>
50979>>>>>>>Object Witemxen_Status_VT  is a DescriptionValidationTable
50981>>>>>>>    Set Table_Title       To "‰˜«žš¦¨å˜ „¤«¦¢ãª"
50982>>>>>>>
50982>>>>>>>    Procedure Fill_List
50984>>>>>>>        Forward Send Fill_List
50986>>>>>>>        Send Add_Table_Value  "1"  "¨æª ‘ç¤Ÿœ©ž"
50987>>>>>>>        Send Add_Table_Value  "2"  "¨æª €§¦©ç¤Ÿœ©ž"
50988>>>>>>>    End_Procedure    // Fill_List
50989>>>>>>>    //DDB-ValidationCustomStart
50989>>>>>>>    //DDB-ValidationCustomEnd
50989>>>>>>>End_Object   // Witemxen_Status_VT
50990>>>>>>>//DDB-ValidationEnd
50990>>>>>>>//DDB-SelectionStart
50990>>>>>>>//DDB/ ExternalSelectionList sl185  sl185.SL
50990>>>>>>>//DDB/ ExternalSelectionList Wax  wax.sl
50990>>>>>>>//DDB/ ExternalSelectionList sl029a  sl029a.sl
50990>>>>>>>Register_Object sl185
50990>>>>>>>Register_Object Wax
50990>>>>>>>Register_Object sl029a
50990>>>>>>>//DDB-SelectionEnd
50990>>>>>>>
50990>>>>>>>Class Witemxen_DataDictionary  is a DataDictionary_Sec
50991>>>>>>>    Procedure Construct_Object
50992>>>>>>>        Forward Send Construct_Object
50994>>>>>>>        Property Integer piMustNOTConstrain Public 0
50995>>>>>>>    End_Procedure //construct_object
50996>>>>>>>
50996>>>>>>>    Procedure OnConstrain
50997>>>>>>>        Forward Send OnConstrain
50999>>>>>>>        Constrain Witemxen.Company_Code  eq SysCurXR.Company_Code
51001>>>>>>>        Constrain Witemxen.Branch_Code   eq SysCurXR.Branch_Code
51003>>>>>>>       Constrain Witemxen.Year_Year     eq SysCurXR.Year_Year
51005>>>>>>>    End_Procedure
51006>>>>>>>
51006>>>>>>>    // Update:
51006>>>>>>>    Procedure Update
51007>>>>>>>        Forward Send Update
51009>>>>>>>        // Insert Code Here
51009>>>>>>>        Move SysCurXR.Company_Code  to Witemxen.Company_Code
51010>>>>>>>        Move SysCurXR.Branch_Code   to Witemxen.Branch_Code
51011>>>>>>>        Move SysCurXR.Year_Year     to Witemxen.Year_Year
51012>>>>>>>        Move witemx.witemx_Code     to Witemxen.Witemxen_Code
51013>>>>>>>        Move witemx.witemx_Descr    to Witemxen.Witemxen_Descr
51014>>>>>>>
51014>>>>>>>    End_Procedure   // Update
51015>>>>>>>
51015>>>>>>>  
51015>>>>>>>    Procedure Creating
51016>>>>>>>        Forward Send Creating 
51018>>>>>>>        integer idecs 
51019>>>>>>>        string srecr sentolh
51019>>>>>>>        clear branch
51020>>>>>>>        move syscurxr.company_code to branch.company_code
51021>>>>>>>        move syscurxr.branch_code  to branch.branch_code
51022>>>>>>>        find eq branch by index.1 
51023>>>>>>>>
51023>>>>>>>        move (branch.paragogh + 1) to branch.paragogh
51024>>>>>>>        saverecord branch  
51025>>>>>>>        move branch.paragogh to sentolh
51026>>>>>>>        move 5 to idecs
51027>>>>>>>        get fsgCode_n_Zeroes sentolh idecs to srecr
51028>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(srecr)))))) to Witemxen.witemxen_Recr
51029>>>>>>>    End_Procedure   // Creating
51030>>>>>>>     
51030>>>>>>>    Procedure Shmera integer iField  Date dDate
51031>>>>>>>        Local Integer Changed
51032>>>>>>>        Get Field_Changed_State iField to Changed
51033>>>>>>>        If (Changed=0 AND dDate =0) Begin
51035>>>>>>>            SysDate4 dDate
51036>>>>>>>            Set Field_Default_Value iField to dDate
51037>>>>>>>        End
51037>>>>>>>>
51037>>>>>>>    End_Procedure   // Shmera
51038>>>>>>>
51038>>>>>>>    // Define_Fields:
51038>>>>>>>    // This procedure is used to set up all data-dictionary rules.
51038>>>>>>>
51038>>>>>>>    Procedure Define_Fields
51039>>>>>>>        Forward Send Define_Fields
51041>>>>>>>        //DDB-Generated-Code-Location
51041>>>>>>>        //DDB-DefineFieldStart
51041>>>>>>>
51041>>>>>>>        Set Main_File            To Witemxen.File_Number
51042>>>>>>>        Set Cascade_Delete_State To FALSE
51043>>>>>>>
51043>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51044>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51045>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51046>>>>>>>
51046>>>>>>>        // Child (Client) file structure................
51046>>>>>>>        Send Add_Client_File  Witemxed.File_Number
51047>>>>>>>
51047>>>>>>>        // Parent (Server) file structure...............
51047>>>>>>>        Send Add_Server_File  Witemx.File_Number
51048>>>>>>>
51048>>>>>>>        // External (System) file structure.............
51048>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
51049>>>>>>>        Send Add_System_File  Branch.File_Number  DD_LOCK_ON_ALL
51050>>>>>>>
51050>>>>>>>        Define_Auto_Increment  Sysrecw.Witemxen_Rec0  To Witemxen.Witemxen_Rec0
51053>>>>>>>
51053>>>>>>>        // Field-based properties.......................
51053>>>>>>>
51053>>>>>>>        // Witemxen.Company_Code
51053>>>>>>>
51053>>>>>>>        // Witemxen.Branch_Code
51053>>>>>>>
51053>>>>>>>        // Witemxen.Year_Year
51053>>>>>>>
51053>>>>>>>        // Witemxen.Witemxen_Code
51053>>>>>>>
51053>>>>>>>        // Witemxen.Witemxen_Recr
51053>>>>>>>
51053>>>>>>>        // Witemxen.Witemx_Recr
51053>>>>>>>
51053>>>>>>>        // Witemxen.Witemxen_Rec0
51053>>>>>>>
51053>>>>>>>        // Witemxen.Witemxen_Hmnia
51053>>>>>>>        Set Field_Entry_msg        Field Witemxen.Witemxen_Hmnia To Shmera
51054>>>>>>>        Set Field_Mask_Type        Field Witemxen.Witemxen_Hmnia To MASK_DATE_WINDOW
51055>>>>>>>        Set Field_Prompt_Object    Field Witemxen.Witemxen_Hmnia To (sl185(Self))
51056>>>>>>>
51056>>>>>>>        // Witemxen.Witemxen_Descr
51056>>>>>>>
51056>>>>>>>        // Witemxen.Qty
51056>>>>>>>
51056>>>>>>>        // Witemxen.Wax_Recr
51056>>>>>>>        Set Field_Prompt_Object    Field Witemxen.Wax_Recr To (Wax(Self))
51057>>>>>>>
51057>>>>>>>        // Witemxen.Waxd_Recr
51057>>>>>>>        Set Field_Prompt_Object    Field Witemxen.Waxd_Recr To (Wax(Self))
51058>>>>>>>
51058>>>>>>>        // Witemxen.Wtypkin_Code
51058>>>>>>>        Set Field_Prompt_Object    Field Witemxen.Wtypkin_Code To (sl029a(Self))
51059>>>>>>>
51059>>>>>>>        // Witemxen.Wtypkind_Code
51059>>>>>>>        Set Field_Prompt_Object    Field Witemxen.Wtypkind_Code To (sl029a(Self))
51060>>>>>>>
51060>>>>>>>        // Witemxen.Status
51060>>>>>>>        Set Field_Class_Name       Field Witemxen.Status To "dbComboFormsub"
51061>>>>>>>        Set Field_Mask             Field Witemxen.Status To "#"
51062>>>>>>>        Set Field_Mask_Type        Field Witemxen.Status To MASK_NUMERIC_WINDOW
51063>>>>>>>        Set Field_Value_Table      Field Witemxen.Status To (Witemxen_Status_VT(Self))
51064>>>>>>>
51064>>>>>>>        // Witemxen.Ekleise
51064>>>>>>>
51064>>>>>>>        // Witemxen.Wcmoves_Recr
51064>>>>>>>
51064>>>>>>>        //DDB-DefineFieldEnd
51064>>>>>>>    End_Procedure    // Define_Fields
51065>>>>>>>
51065>>>>>>>    // Field_Defaults:
51065>>>>>>>    // This procedure is used to establish default field values.
51065>>>>>>>
51065>>>>>>>    Procedure Field_Defaults
51066>>>>>>>        Forward Send Field_Defaults
51068>>>>>>>        //DDB-Generated-Code-Location
51068>>>>>>>        //DDB-FieldDefaultStart
51068>>>>>>>        //DDB-FieldDefaultEnd
51068>>>>>>>    End_Procedure    // Field_Defaults
51069>>>>>>>
51069>>>>>>>End_Class    // Witemxen_DataDictionary
51070>>>>>>>//DDB-Selection-pkg-Start
51070>>>>>>>
51070>>>>>>>Use sl185.SL         // sl185
51070>>>>>>>Use wax.sl           // Wax
51070>>>>>>>Use sl029a.sl        // sl029a
51070>>>>>>>
51070>>>>>>>//DDB-Selection-pkg-End
51070>>>>>>>//DDB-FileEnd
51070>>>>>
51070>>>>>//AB-IgnoreEnd
51070>>>>>
51070>>>>>Object sl185 is a dbModalPanelSub
51072>>>>>
51072>>>>>    //AB-StoreTopStart
51072>>>>>    Function fnwhat integer code Returns string
51074>>>>>        string name
51075>>>>>        integer what
51075>>>>>        move code to what
51076>>>>>        if (what = 1);           move '¨æª ‘ç¤Ÿœ©ž' to name
51079>>>>>        else;           move '¨æª €§¦©ç¤Ÿœ©ž' to name
51081>>>>>        function_return name
51082>>>>>    end_Function
51083>>>>>    //AB-StoreTopEnd
51083>>>>>
51083>>>>>    Set Label to "„¬¨œ«ã¨ ¦ „¤«¦¢é¤ ˜¨˜šàšãª"
51084>>>>>    Set Size to 148 477
51085>>>>>    Set Location to 4 5
51086>>>>>    Set Exit_Application_Local_State to FALSE
51087>>>>>    Set Modal_State to FALSE
51088>>>>>
51088>>>>>    //AB-DDOStart
51088>>>>>
51088>>>>>    Object Units_DD is a Units_DataDictionary
51090>>>>>    End_Object    // Units_DD
51091>>>>>
51091>>>>>    Object Witemkat_DD is a Witemkat_DataDictionary
51093>>>>>    End_Object    // Witemkat_DD
51094>>>>>
51094>>>>>    Object Fpa_DD is a Fpa_DataDictionary
51096>>>>>    End_Object    // Fpa_DD
51097>>>>>
51097>>>>>    Object Item_DD is a Item_DataDictionary
51099>>>>>        Set DDO_Server to (Units_DD(self))
51100>>>>>        Set DDO_Server to (Witemkat_DD(self))
51101>>>>>        Set DDO_Server to (Fpa_DD(self))
51102>>>>>    End_Object    // Item_DD
51103>>>>>
51103>>>>>    Object Witemx_DD is a Witemx_DataDictionary
51105>>>>>        Set DDO_Server to (Item_DD(self))
51106>>>>>    End_Object    // Witemx_DD
51107>>>>>
51107>>>>>    Object Witemxen_DD is a Witemxen_DataDictionary
51109>>>>>        Set DDO_Server to (Witemx_DD(self))
51110>>>>>    End_Object    // Witemxen_DD
51111>>>>>
51111>>>>>    Set Main_DD to (Witemxen_DD(self))
51112>>>>>    Set Server to (Witemxen_DD(self))
51113>>>>>
51113>>>>>    //AB-DDOEnd
51113>>>>>
51113>>>>>    Object oSelList is a dbListSub
51115>>>>>        Set Main_File to Witemxen.File_Number
51116>>>>>        Set Server to (Witemx_DD(self))
51117>>>>>        Set Ordering to 3
51118>>>>>        Set Size to 105 460
51119>>>>>        Set Location to 6 6
51120>>>>>
51120>>>>>        Begin_Row
51123>>>>>            Entry_Item Witemxen.Witemxen_hmnia
51124>>>>>            Entry_Item Witemxen.Witemxen_recr
51125>>>>>            Entry_Item Witemxen.Witemxen_code
51126>>>>>            Entry_Item Witemx.Witemx_descr
51127>>>>>            Entry_Item (Fnwhat(self,witemxen.status))
51128>>>>>            Entry_Item Witemxen.Qty
51129>>>>>        End_Row
51134>>>>>
51134>>>>>        Set Form_Width    item 0 to 65
51135>>>>>        Set Header_Label  item 0 to "†£/¤å˜ „¤«¦¢é¤"
51136>>>>>        
51136>>>>>        Set Form_Width    item 1 to 56
51137>>>>>        Set Header_Label  item 1 to "€/˜ „¤«¦¢ãª"
51138>>>>>        
51138>>>>>        Set Form_Width    item 2 to 80
51139>>>>>        Set Header_Label  item 2 to "‰à› ¡æª „å›¦¬ª"
51140>>>>>        
51140>>>>>        Set Form_Width    item 3 to 120
51141>>>>>        Set Header_Label  item 3 to "œ¨ š¨˜­ã „å›¦¬ª"
51142>>>>>        
51142>>>>>        Set Form_Width    item 4 to 85
51143>>>>>        Set Header_Label  item 4 to "‰˜«žš¦¨å˜ „¤«¦¢ãª"
51144>>>>>        
51144>>>>>        Set Form_Width    item 5 to 46
51145>>>>>        Set Header_Label  item 5 to "¦©æ«ž«˜"
51146>>>>>        
51146>>>>>
51146>>>>>        //AB-StoreStart
51146>>>>>        set points of osellist item 5 to 1
51147>>>>>        
51147>>>>>        //AB-StoreEnd
51147>>>>>
51147>>>>>    End_Object    // oSelList
51148>>>>>
51148>>>>>    Object oOK_bn is a ButtonSub
51150>>>>>        Set Label to "&„§ ¢¦šã"
51151>>>>>        Set Location to 115 308
51152>>>>>
51152>>>>>        //AB-StoreStart
51152>>>>>        Procedure OnClick
51154>>>>>            Send OK To (oSelList(current_object))
51155>>>>>        End_Procedure
51156>>>>>        //AB-StoreEnd
51156>>>>>
51156>>>>>    End_Object    // oOK_bn
51157>>>>>
51157>>>>>    Object oCancel_bn is a ButtonSub
51159>>>>>        Set Label to "&€¡ç¨à©ž"
51160>>>>>        Set Location to 115 362
51161>>>>>
51161>>>>>        //AB-StoreStart
51161>>>>>        Procedure OnClick
51163>>>>>            Send Cancel To (oSelList(current_object))
51164>>>>>        End_Procedure
51165>>>>>        //AB-StoreEnd
51165>>>>>
51165>>>>>    End_Object    // oCancel_bn
51166>>>>>
51166>>>>>    Object oSearch_bn is a ButtonSub
51168>>>>>        Set Label to "€&¤˜ã«ž©ž..."
51169>>>>>        Set Location to 114 417
51170>>>>>
51170>>>>>        //AB-StoreStart
51170>>>>>        Procedure OnClick
51172>>>>>            Send Search To (oSelList(current_object))
51173>>>>>        End_Procedure
51174>>>>>        //AB-StoreEnd
51174>>>>>
51174>>>>>    End_Object    // oSearch_bn
51175>>>>>
51175>>>>>
51175>>>>>    //AB-StoreStart
51175>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
51176>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
51177>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
51178>>>>>    
51178>>>>>    //AB-StoreEnd
51178>>>>>
51178>>>>>End_Object    // sl185
51179>>>>>
51179>>>>>//AB/ End_Object    // prj
51179>>>Use sl22.sl
INCLUDING FILE: SL22.SL
51179>>>>>//AB/ Project sl22:kathgories apothkon
51179>>>>>//AB/     Object prj is a Lookup_Project
51179>>>>>//AB/         Set ProjectName to "sl22:kathgories apothkon"
51179>>>>>//AB/         Set ProjectFileName to "sl22.SL"
51179>>>>>//AB/         Set GenerateFileName to "NONAME"
51179>>>>>
51179>>>>>// Project Object Structure
51179>>>>>//   sl22 is a dbModalPanelSub
51179>>>>>//     Wapokat_DD is a DataDictionary
51179>>>>>//     oSelList is a dbListSub
51179>>>>>//     oOK_bn is a ButtonSub
51179>>>>>//     oCancel_bn is a ButtonSub
51179>>>>>//     oSearch_bn is a ButtonSub
51179>>>>>
51179>>>>>// Register all objects
51179>>>>>Register_Object oCancel_bn
51179>>>>>Register_Object oOK_bn
51179>>>>>Register_Object oSearch_bn
51179>>>>>Register_Object oSelList
51179>>>>>Register_Object sl22
51179>>>>>Register_Object Wapokat_DD
51179>>>>>
51179>>>>>
51179>>>>>    //AB-IgnoreStart
51179>>>>>
51179>>>>>    Use DFAllEnt.pkg
51179>>>>>    Use dbList.Sub
51179>>>>>    Use Button.Sub
51179>>>>>
51179>>>>>
51179>>>>>    Use WAPOKAT.DD
51179>>>>>    
51179>>>>>    //AB-IgnoreEnd
51179>>>>>
51179>>>>>    Object sl22 is a dbModalPanelSub
51181>>>>>        set label to "‰˜«žš¦¨åœª €§¦Ÿž¡é¤" 
51182>>>>>        Set Size to 148 297
51183>>>>>        Set Location to 4 5
51184>>>>>        Set Exit_Application_Local_State to FALSE
51185>>>>>        Set Modal_State to FALSE
51186>>>>>
51186>>>>>        //AB-DDOStart
51186>>>>>
51186>>>>>        Object Wapokat_DD is a Wapokat_DataDictionary
51188>>>>>        End_Object    // Wapokat_DD
51189>>>>>
51189>>>>>        Set Main_DD to (Wapokat_DD(self))
51190>>>>>        Set Server to (Wapokat_DD(self))
51191>>>>>
51191>>>>>        //AB-DDOEnd
51191>>>>>
51191>>>>>        Object oSelList is a dbListSub
51193>>>>>            Set Main_File to Wapokat.File_Number
51194>>>>>            Set Size to 105 280
51195>>>>>            Set Location to 6 6
51196>>>>>
51196>>>>>            Begin_Row
51199>>>>>                Entry_Item Wapokat.Wapokat_code
51200>>>>>                Entry_Item Wapokat.Wapokat_descr
51201>>>>>            End_Row
51206>>>>>
51206>>>>>            Set Form_Width    item 0 to 80
51207>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
51208>>>>>            
51208>>>>>            Set Form_Width    item 1 to 191
51209>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
51210>>>>>            
51210>>>>>        End_Object    // oSelList
51211>>>>>
51211>>>>>        Object oOK_bn is a ButtonSub
51213>>>>>            set label to "&„§ ¢¦šã" 
51214>>>>>            Set Location to 115 126
51215>>>>>
51215>>>>>            //AB-StoreStart
51215>>>>>            Procedure OnClick
51217>>>>>                Send OK To (oSelList(current_object))
51218>>>>>            End_Procedure
51219>>>>>            //AB-StoreEnd
51219>>>>>
51219>>>>>        End_Object    // oOK_bn
51220>>>>>
51220>>>>>        Object oCancel_bn is a ButtonSub
51222>>>>>            set label to "&€¡ç¨à©ž" 
51223>>>>>            Set Location to 115 181
51224>>>>>
51224>>>>>            //AB-StoreStart
51224>>>>>            Procedure OnClick
51226>>>>>                Send Cancel To (oSelList(current_object))
51227>>>>>            End_Procedure
51228>>>>>            //AB-StoreEnd
51228>>>>>
51228>>>>>        End_Object    // oCancel_bn
51229>>>>>
51229>>>>>        Object oSearch_bn is a ButtonSub
51231>>>>>            set label to "€&¤˜ã«ž©ž" 
51232>>>>>            Set Location to 115 236
51233>>>>>
51233>>>>>            //AB-StoreStart
51233>>>>>            Procedure OnClick
51235>>>>>                Send Search To (oSelList(current_object))
51236>>>>>            End_Procedure
51237>>>>>            //AB-StoreEnd
51237>>>>>
51237>>>>>        End_Object    // oSearch_bn
51238>>>>>
51238>>>>>
51238>>>>>        //AB-StoreStart
51238>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
51239>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
51240>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
51241>>>>>        //AB-StoreEnd
51241>>>>>
51241>>>>>    End_Object    // sl22
51242>>>>>
51242>>>>>//AB/     End_Object    // prj
51242>>>Use sl23.sl
INCLUDING FILE: SL23.SL
51242>>>>>//AB/ Project sl23: apothkes
51242>>>>>//AB/     Object prj is a Lookup_Project
51242>>>>>//AB/         Set ProjectName to "sl23: apothkes"
51242>>>>>//AB/         Set ProjectFileName to "sl23.SL"
51242>>>>>//AB/         Set GenerateFileName to "NONAME"
51242>>>>>
51242>>>>>// Project Object Structure
51242>>>>>//   sl23 is a dbModalPanelSub
51242>>>>>//     Wapokat_DD is a DataDictionary
51242>>>>>//     Wapomast_DD is a DataDictionary
51242>>>>>//     oSelList is a dbListSub
51242>>>>>//     oOK_bn is a ButtonSub
51242>>>>>//     oCancel_bn is a ButtonSub
51242>>>>>//     oSearch_bn is a ButtonSub
51242>>>>>
51242>>>>>// Register all objects
51242>>>>>Register_Object oCancel_bn
51242>>>>>Register_Object oOK_bn
51242>>>>>Register_Object oSearch_bn
51242>>>>>Register_Object oSelList
51242>>>>>Register_Object sl23
51242>>>>>Register_Object Wapokat_DD
51242>>>>>Register_Object Wapomast_DD
51242>>>>>
51242>>>>>
51242>>>>>    //AB-IgnoreStart
51242>>>>>
51242>>>>>    Use DFAllEnt.pkg
51242>>>>>    Use dbList.Sub
51242>>>>>    Use Button.Sub
51242>>>>>
51242>>>>>
51242>>>>>    Use WAPOKAT.DD
51242>>>>>    Use WAPOMAST.DD
51242>>>>>    
51242>>>>>    //AB-IgnoreEnd
51242>>>>>
51242>>>>>    Object sl23 is a dbModalPanelSub
51244>>>>>        set label to "€§¦Ÿã¡œª" 
51245>>>>>        Set Size to 148 285
51246>>>>>        Set Location to 4 5
51247>>>>>        Set Exit_Application_Local_State to FALSE
51248>>>>>        Set Modal_State to FALSE
51249>>>>>
51249>>>>>        //AB-DDOStart
51249>>>>>
51249>>>>>        Object Wapokat_DD is a Wapokat_DataDictionary
51251>>>>>        End_Object    // Wapokat_DD
51252>>>>>
51252>>>>>        Object Wapomast_DD is a Wapomast_DataDictionary
51254>>>>>            Set DDO_Server to (Wapokat_DD(self))
51255>>>>>        End_Object    // Wapomast_DD
51256>>>>>
51256>>>>>        Set Main_DD to (Wapomast_DD(self))
51257>>>>>        Set Server to (Wapomast_DD(self))
51258>>>>>
51258>>>>>        //AB-DDOEnd
51258>>>>>
51258>>>>>        Object oSelList is a dbListSub
51260>>>>>            Set Main_File to Wapomast.File_Number
51261>>>>>            Set Size to 105 269
51262>>>>>            Set Location to 6 6
51263>>>>>
51263>>>>>            Begin_Row
51266>>>>>                Entry_Item Wapomast.Wapomast_code
51267>>>>>                Entry_Item Wapomast.Wapomast_descr
51268>>>>>            End_Row
51273>>>>>
51273>>>>>            Set Form_Width    item 0 to 80
51274>>>>>            set header_label  item 0 to "€§¦Ÿã¡œª" 
51275>>>>>            
51275>>>>>            Set Form_Width    item 1 to 180
51276>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
51277>>>>>            
51277>>>>>        End_Object    // oSelList
51278>>>>>
51278>>>>>        Object oOK_bn is a ButtonSub
51280>>>>>            set label to "&„§ ¢¦šã" 
51281>>>>>            Set Location to 113 115
51282>>>>>
51282>>>>>            //AB-StoreStart
51282>>>>>            Procedure OnClick
51284>>>>>                Send OK To (oSelList(current_object))
51285>>>>>            End_Procedure
51286>>>>>            //AB-StoreEnd
51286>>>>>
51286>>>>>        End_Object    // oOK_bn
51287>>>>>
51287>>>>>        Object oCancel_bn is a ButtonSub
51289>>>>>            set label to "&€¡ç¨à©ž" 
51290>>>>>            Set Location to 113 170
51291>>>>>
51291>>>>>            //AB-StoreStart
51291>>>>>            Procedure OnClick
51293>>>>>                Send Cancel To (oSelList(current_object))
51294>>>>>            End_Procedure
51295>>>>>            //AB-StoreEnd
51295>>>>>
51295>>>>>        End_Object    // oCancel_bn
51296>>>>>
51296>>>>>        Object oSearch_bn is a ButtonSub
51298>>>>>            set label to "€&¤˜ã«ž©ž" 
51299>>>>>            Set Location to 113 225
51300>>>>>
51300>>>>>            //AB-StoreStart
51300>>>>>            Procedure OnClick
51302>>>>>                Send Search To (oSelList(current_object))
51303>>>>>            End_Procedure
51304>>>>>            //AB-StoreEnd
51304>>>>>
51304>>>>>        End_Object    // oSearch_bn
51305>>>>>
51305>>>>>
51305>>>>>        //AB-StoreStart
51305>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
51306>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
51307>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
51308>>>>>        //AB-StoreEnd
51308>>>>>
51308>>>>>    End_Object    // sl23
51309>>>>>
51309>>>>>//AB/     End_Object    // prj
51309>>>Use slNomism.sl
51309>>>Use CodeType.sl
INCLUDING FILE: CODETYPE.SL
51309>>>>>//AB/ Project CodeType LookUp
51309>>>>>//AB/     Object prj is a LOOKUP_Project
51309>>>>>//AB/         Set ProjectName to "CodeType LookUp"
51309>>>>>//AB/         Set ProjectFileName to "Codetype.sl"
51309>>>>>
51309>>>>>    //AB-IgnoreStart
51309>>>>>
51309>>>>>    USE AllentSc
51309>>>>>
51309>>>>>
51309>>>>>    Use CODETYPE.DD
INCLUDING FILE: CODETYPE.DD
51309>>>>>>>//DDB-FileStart
51309>>>>>>>//DDB-HeaderStart
51309>>>>>>>
51309>>>>>>>// File Name : CODETYPE.DD
51309>>>>>>>// Class Name: Codetype_DataDictionary
51309>>>>>>>// Revision  : 4
51309>>>>>>>// Version   : 2
51309>>>>>>>
51309>>>>>>>Use  Windows           // Basic Definitions
51309>>>>>>>Use  DataDict          // DataDictionary Class Definition
51309>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51309>>>>>>>
51309>>>>>>>Open Codetype
51311>>>>>>>Open Codemast
51313>>>>>>>
51313>>>>>>>//DDB-HeaderEnd
51313>>>>>>>//DDB-SelectionStart
51313>>>>>>>//DDB/ ExternalSelectionList CodeType_SL  codetype.sl
51313>>>>>>>Register_Object CodeType_SL
51313>>>>>>>//DDB-SelectionEnd
51313>>>>>>>
51313>>>>>>>Class Codetype_DataDictionary is a DataDictionary
51314>>>>>>>
51314>>>>>>>    // Disallow blank keys
51314>>>>>>>    Function Validate_Save Returns Integer
51315>>>>>>>        If CodeType.Type eq '' Begin
51317>>>>>>>            Error 300 '‰œ¤âª « £âª ›œ¤ œ§ «¨â§¦¤˜« .'
51318>>>>>>>>
51318>>>>>>>            Function_Return 1
51319>>>>>>>        End
51319>>>>>>>>
51319>>>>>>>    End_Function // Validate_Save
51320>>>>>>>
51320>>>>>>>    // Define_Fields:
51320>>>>>>>    // This procedure is used to set up all data-dictionary rules.
51320>>>>>>>
51320>>>>>>>    Procedure Define_Fields
51321>>>>>>>        Forward Send Define_Fields
51323>>>>>>>        //DDB-Generated-Code-Location
51323>>>>>>>        //DDB-DefineFieldStart
51323>>>>>>>
51323>>>>>>>        Set Main_File            To Codetype.File_Number
51324>>>>>>>        Set Cascade_Delete_State To FALSE
51325>>>>>>>
51325>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51326>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51327>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51328>>>>>>>
51328>>>>>>>        // Child (Client) file structure................
51328>>>>>>>        Send Add_Client_File  Codemast.File_Number
51329>>>>>>>
51329>>>>>>>        // Field-based properties.......................
51329>>>>>>>
51329>>>>>>>        // Codetype.Type
51329>>>>>>>        Set Field_Options          Field Codetype.Type To DD_AUTOFIND    DD_REQUIRED    DD_CAPSLOCK   
51330>>>>>>>        Set Field_Prompt_Object    Field Codetype.Type To (CodeType_SL(Self))
51331>>>>>>>        Set Key_Field_State        Field Codetype.Type To TRUE
51332>>>>>>>
51332>>>>>>>        // Codetype.Description
51332>>>>>>>        Set Field_Prompt_Object    Field Codetype.Description To (CodeType_SL(Self))
51333>>>>>>>
51333>>>>>>>        // Codetype.Comment
51333>>>>>>>        Set Status_Help            Field Codetype.Comment To "‹å˜ ˜¤˜¢¬« ¡æ«œ¨ž §œ¨ š¨˜­ã «žª ¡˜«žš¦¨å˜ª «¦¬ ¡à› ¡¦ç."
51334>>>>>>>
51334>>>>>>>        //DDB-DefineFieldEnd
51334>>>>>>>    End_Procedure    // Define_Fields
51335>>>>>>>
51335>>>>>>>    // Field_Defaults:
51335>>>>>>>    // This procedure is used to establish default field values.
51335>>>>>>>
51335>>>>>>>    Procedure Field_Defaults
51336>>>>>>>        Forward Send Field_Defaults
51338>>>>>>>        //DDB-Generated-Code-Location
51338>>>>>>>        //DDB-FieldDefaultStart
51338>>>>>>>        //DDB-FieldDefaultEnd
51338>>>>>>>    End_Procedure    // Field_Defaults
51339>>>>>>>End_Class    //  Codetype_DataDictionary
51340>>>>>>>//DDB-Selection-pkg-Start
51340>>>>>>>
51340>>>>>>>Use codetype.sl      // CodeType_SL
51340>>>>>>>
51340>>>>>>>//DDB-Selection-pkg-End
51340>>>>>>>//DDB-FileEnd
51340>>>>>
51340>>>>>    //AB-IgnoreEnd
51340>>>>>
51340>>>>>    CD_Popup_Object CodeType_SL is a dbModalPanelSub
51359>>>>>        Set Minimize_Icon to FALSE
51360>>>>>        set label to "€¨®œå¦ CODETYPE" 
51361>>>>>        Set Size to 151 264
51362>>>>>        Set Location to 5 5
51363>>>>>
51363>>>>>        //AB-DDOStart
51363>>>>>
51363>>>>>        Object Codetype_DD is a Codetype_DataDictionary
51365>>>>>        End_Object    // Codetype_DD
51366>>>>>
51366>>>>>        Set Main_DD to (Codetype_DD(Current_Object))
51367>>>>>        Set Server to (Codetype_DD(Current_Object))
51368>>>>>
51368>>>>>        //AB-DDOEnd
51368>>>>>
51368>>>>>        Object oSelList is a dbListSub
51370>>>>>            Set Main_File to Codetype.File_Number
51371>>>>>            Set Size to 105 247
51372>>>>>            Set Location to 6 6
51373>>>>>
51373>>>>>            Begin_Row
51376>>>>>                Entry_Item Codetype.Type
51377>>>>>                Entry_Item Codetype.Description
51378>>>>>            End_Row
51383>>>>>
51383>>>>>            Set Form_Width    item 0 to 60
51384>>>>>            set header_label  item 0 to "’ç§¦ª" 
51385>>>>>
51385>>>>>            Set Form_Width    item 1 to 180
51386>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
51387>>>>>
51387>>>>>        End_Object    // oSelList
51388>>>>>
51388>>>>>        Object oOK_bn is a ButtonSub
51390>>>>>            Set Default_State to TRUE
51391>>>>>            set label to "&„§ ¢¦šã" 
51392>>>>>            Set Location to 115 93
51393>>>>>
51393>>>>>            //AB-StoreStart
51393>>>>>            Procedure OnClick
51395>>>>>                Send OK To (oSelList(current_object))
51396>>>>>            End_Procedure
51397>>>>>            //AB-StoreEnd
51397>>>>>
51397>>>>>        End_Object    // oOK_bn
51398>>>>>
51398>>>>>        Object oCancel_bn is a ButtonSub
51400>>>>>            set label to "&€¡ç¨à©ž" 
51401>>>>>            Set Location to 115 148
51402>>>>>
51402>>>>>            //AB-StoreStart
51402>>>>>            Procedure OnClick
51404>>>>>                Send Cancel To (oSelList(current_object))
51405>>>>>            End_Procedure
51406>>>>>            //AB-StoreEnd
51406>>>>>
51406>>>>>        End_Object    // oCancel_bn
51407>>>>>
51407>>>>>        Object oSearch_bn is a ButtonSub
51409>>>>>            set label to "€&¤˜ã«ž©ž" 
51410>>>>>            Set Location to 115 203
51411>>>>>
51411>>>>>            //AB-StoreStart
51411>>>>>            Procedure OnClick
51413>>>>>                Send Search To (oSelList(current_object))
51414>>>>>            End_Procedure
51415>>>>>            //AB-StoreEnd
51415>>>>>
51415>>>>>        End_Object    // oSearch_bn
51416>>>>>
51416>>>>>
51416>>>>>        //AB-StoreStart
51416>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
51417>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
51418>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
51419>>>>>        //AB-StoreEnd
51419>>>>>
51419>>>>>    CD_End_Object    // CodeType_SL
51421>>>>>>
51421>>>>>
51421>>>>>//AB/     End_Object    // prj
51421>>>Use Fpa.sl
51421>>>Use Hmgio.sl
INCLUDING FILE: HMGIO.SL
51421>>>>>//AB/ Project Hmgio:Lookup
51421>>>>>//AB/ Object prj is a Lookup_Project
51421>>>>>//AB/     Set ProjectName to "Hmgio:Lookup"
51421>>>>>//AB/     Set ProjectFileName to "Hmgio.SL"
51421>>>>>//AB/     Set GenerateFileName to "NONAME"
51421>>>>>
51421>>>>>// Project Object Structure
51421>>>>>//   Hmgio is a dbModalPanelSub
51421>>>>>//     Hmgio_DD is a DataDictionary
51421>>>>>//     oSelList is a dbListSub
51421>>>>>//     oOK_bn is a ButtonSub
51421>>>>>//     oCancel_bn is a ButtonSub
51421>>>>>//     oSearch_bn is a ButtonSub
51421>>>>>
51421>>>>>// Register all objects
51421>>>>>Register_Object Hmgio
51421>>>>>Register_Object Hmgio_DD
51421>>>>>Register_Object oCancel_bn
51421>>>>>Register_Object oOK_bn
51421>>>>>Register_Object oSearch_bn
51421>>>>>Register_Object oSelList
51421>>>>>
51421>>>>>
51421>>>>>//AB-IgnoreStart
51421>>>>>
51421>>>>>Use DFAllEnt.pkg
51421>>>>>Use dbList.Sub
51421>>>>>Use Button.Sub
51421>>>>>
51421>>>>>
51421>>>>>Use HMGIO.DD
INCLUDING FILE: HMGIO.DD
51421>>>>>>>//DDB-FileStart
51421>>>>>>>//DDB-HeaderStart
51421>>>>>>>
51421>>>>>>>// File Name : HMGIO.DD
51421>>>>>>>// Class Name: Hmgio_DataDictionary
51421>>>>>>>// Revision  : 8
51421>>>>>>>// Version   : 2
51421>>>>>>>
51421>>>>>>>Use  Windows           // Basic Definitions
51421>>>>>>>Use  DataDict          // DataDictionary Class Definition
51421>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51421>>>>>>>
51421>>>>>>>Open Hmgio
INCLUDING FILE: HMGIO.FD
51423>>>>>>>Open Hmctyp
51425>>>>>>>Open Sysrecc
51427>>>>>>>
51427>>>>>>>//DDB-HeaderEnd
51427>>>>>>>//DDB-ValidationStart
51427>>>>>>>
51427>>>>>>>Register_Object Hmgio_Hmgio_Module_VT
51427>>>>>>>
51427>>>>>>>Object Hmgio_Hmgio_Module_VT  is a CodeValidationTable
51429>>>>>>>    Set Type_Value        To "MODULE"
51430>>>>>>>    Set Validate_State    To FALSE
51431>>>>>>>    Set Allow_Blank_State To TRUE
51432>>>>>>>    //DDB-ValidationCustomStart
51432>>>>>>>    //DDB-ValidationCustomEnd
51432>>>>>>>End_Object   // Hmgio_Hmgio_Module_VT
51433>>>>>>>//DDB-ValidationEnd
51433>>>>>>>//DDB-SelectionStart
51433>>>>>>>//DDB/ ExternalSelectionList Hmgio  Hmgio.SL
51433>>>>>>>Register_Object Hmgio
51433>>>>>>>//DDB-SelectionEnd
51433>>>>>>>
51433>>>>>>>Class Hmgio_DataDictionary  is a DataDictionary_Sec
51434>>>>>>>
51434>>>>>>>    // Define_Fields:
51434>>>>>>>    // This procedure is used to set up all data-dictionary rules.
51434>>>>>>>
51434>>>>>>>    Procedure Define_Fields
51435>>>>>>>        Forward Send Define_Fields
51437>>>>>>>        //DDB-Generated-Code-Location
51437>>>>>>>        //DDB-DefineFieldStart
51437>>>>>>>
51437>>>>>>>        Set Main_File            To Hmgio.File_Number
51438>>>>>>>        Set Cascade_Delete_State To FALSE
51439>>>>>>>
51439>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51440>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51441>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51442>>>>>>>
51442>>>>>>>        // Child (Client) file structure................
51442>>>>>>>        Send Add_Client_File  Hmctyp.File_Number
51443>>>>>>>
51443>>>>>>>        // External (System) file structure.............
51443>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
51444>>>>>>>
51444>>>>>>>        Define_Auto_Increment  Sysrecc.Hmgio_Code  To Hmgio.Hmgio_Code
51447>>>>>>>
51447>>>>>>>        // Field-based properties.......................
51447>>>>>>>
51447>>>>>>>        // Hmgio.Hmgio_Code
51447>>>>>>>        Set Field_Options          Field Hmgio.Hmgio_Code To DD_AUTOFIND   
51448>>>>>>>        Set Field_Prompt_Object    Field Hmgio.Hmgio_Code To (Hmgio(Self))
51449>>>>>>>        Set Key_Field_State        Field Hmgio.Hmgio_Code To TRUE
51450>>>>>>>
51450>>>>>>>        // Hmgio.Hmgio_Descr
51450>>>>>>>        Set Field_Prompt_Object    Field Hmgio.Hmgio_Descr To (Hmgio(Self))
51451>>>>>>>
51451>>>>>>>        // Hmgio.Hmgio_Module
51451>>>>>>>        Set Field_Value_Table      Field Hmgio.Hmgio_Module To (Hmgio_Hmgio_Module_VT(Self))
51452>>>>>>>
51452>>>>>>>        //DDB-DefineFieldEnd
51452>>>>>>>    End_Procedure    // Define_Fields
51453>>>>>>>
51453>>>>>>>    // Field_Defaults:
51453>>>>>>>    // This procedure is used to establish default field values.
51453>>>>>>>
51453>>>>>>>    Procedure Field_Defaults
51454>>>>>>>        Forward Send Field_Defaults
51456>>>>>>>        //DDB-Generated-Code-Location
51456>>>>>>>        //DDB-FieldDefaultStart
51456>>>>>>>        //DDB-FieldDefaultEnd
51456>>>>>>>    End_Procedure    // Field_Defaults
51457>>>>>>>
51457>>>>>>>End_Class    // Hmgio_DataDictionary
51458>>>>>>>//DDB-Selection-pkg-Start
51458>>>>>>>
51458>>>>>>>Use Hmgio.SL         // Hmgio
51458>>>>>>>
51458>>>>>>>//DDB-Selection-pkg-End
51458>>>>>>>//DDB-FileEnd
51458>>>>>
51458>>>>>//AB-IgnoreEnd
51458>>>>>
51458>>>>>Object Hmgio is a dbModalPanelSub
51460>>>>>
51460>>>>>    //AB-StoreTopStart
51460>>>>>    Property String psModule Public ''
51462>>>>>    
51462>>>>>    //AB-StoreTopEnd
51462>>>>>
51462>>>>>    Set Label to "†£œ¨¦¢æš ˜"
51463>>>>>    Set Size to 200 297
51464>>>>>    Set Location to 4 5
51465>>>>>    Set Exit_Application_Local_State to FALSE
51466>>>>>    Set Modal_State to FALSE
51467>>>>>
51467>>>>>    //AB-DDOStart
51467>>>>>
51467>>>>>    Object Hmgio_DD is a Hmgio_DataDictionary
51469>>>>>
51469>>>>>        //AB-StoreStart
51469>>>>>        Function fiEggrafh_OK Returns Integer
51471>>>>>            Integer rVal
51472>>>>>            String sModule
51472>>>>>            Get psModule to sModule
51473>>>>>            If ((hmgio.Hmgio_Module=smodule) Or (hmgio.Hmgio_Module='04')) Move 1 to rVal
51476>>>>>            Function_Return rVal
51477>>>>>        End_Function
51478>>>>>        
51478>>>>>        Begin_Constraints
51480>>>>>             Constrain hmgio as (fiEggrafh_OK(Self)=1)
51481>>>>>        End_Constraints
51484>>>>>        
51484>>>>>        
51484>>>>>        
51484>>>>>        
51484>>>>>        
51484>>>>>        //AB-StoreEnd
51484>>>>>
51484>>>>>    End_Object    // Hmgio_DD
51485>>>>>
51485>>>>>    Set Main_DD to (Hmgio_DD(self))
51486>>>>>    Set Server to (Hmgio_DD(self))
51487>>>>>
51487>>>>>    //AB-DDOEnd
51487>>>>>
51487>>>>>    Object oSelList is a dbListSub
51489>>>>>        Set Main_File to Hmgio.File_Number
51490>>>>>        Set Size to 161 280
51491>>>>>        Set Location to 6 6
51492>>>>>        Set Auto_Index_State to FALSE
51493>>>>>
51493>>>>>        Begin_Row
51496>>>>>            Entry_Item Hmgio.Hmgio_code
51497>>>>>            Entry_Item Hmgio.Hmgio_descr
51498>>>>>        End_Row
51503>>>>>
51503>>>>>        Set Form_Width    item 0 to 84
51504>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
51505>>>>>        
51505>>>>>        Set Form_Width    item 1 to 188
51506>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
51507>>>>>        
51507>>>>>
51507>>>>>        //AB-StoreStart
51507>>>>>                                    
51507>>>>>        Procedure Activate
51509>>>>>            Forward Send Activate
51511>>>>>            Send Rebuild_Constraints to Hmgio_DD
51512>>>>>            Send Beginning_Of_Data to oSelList True
51513>>>>>        End_Procedure
51514>>>>>        
51514>>>>>        //AB-StoreEnd
51514>>>>>
51514>>>>>    End_Object    // oSelList
51515>>>>>
51515>>>>>    Object oOK_bn is a ButtonSub
51517>>>>>        Set Label to "&„§ ¢¦šã"
51518>>>>>        Set Location to 169 131
51519>>>>>
51519>>>>>        //AB-StoreStart
51519>>>>>        Procedure OnClick
51521>>>>>            Send OK To (oSelList(current_object))
51522>>>>>        End_Procedure
51523>>>>>        //AB-StoreEnd
51523>>>>>
51523>>>>>    End_Object    // oOK_bn
51524>>>>>
51524>>>>>    Object oCancel_bn is a ButtonSub
51526>>>>>        Set Label to "&€¡ç¨à©ž"
51527>>>>>        Set Location to 169 185
51528>>>>>
51528>>>>>        //AB-StoreStart
51528>>>>>        Procedure OnClick
51530>>>>>            Send Cancel To (oSelList(current_object))
51531>>>>>        End_Procedure
51532>>>>>        //AB-StoreEnd
51532>>>>>
51532>>>>>    End_Object    // oCancel_bn
51533>>>>>
51533>>>>>    Object oSearch_bn is a ButtonSub
51535>>>>>        Set Label to "€&¤˜ã«ž©ž"
51536>>>>>        Set Location to 169 241
51537>>>>>
51537>>>>>        //AB-StoreStart
51537>>>>>        Procedure OnClick
51539>>>>>            Send Search To (oSelList(current_object))
51540>>>>>        End_Procedure
51541>>>>>        //AB-StoreEnd
51541>>>>>
51541>>>>>    End_Object    // oSearch_bn
51542>>>>>
51542>>>>>
51542>>>>>    //AB-StoreStart
51542>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
51543>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
51544>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
51545>>>>>    
51545>>>>>    //AB-StoreEnd
51545>>>>>
51545>>>>>End_Object    // Hmgio
51546>>>>>
51546>>>>>//AB/ End_Object    // prj
51546>>>Use Hmgiow.sl
INCLUDING FILE: HMGIOW.SL
51546>>>>>//AB/ Project HmgioW:Lookup
51546>>>>>//AB/     Object prj is a Lookup_Project
51546>>>>>//AB/         Set ProjectName to "HmgioW:Lookup"
51546>>>>>//AB/         Set ProjectFileName to "HmgioW.SL"
51546>>>>>//AB/         Set GenerateFileName to "NONAME"
51546>>>>>
51546>>>>>// Project Object Structure
51546>>>>>//   HmgioW is a dbModalPanelSub
51546>>>>>//     Hmgiow_DD is a DataDictionary
51546>>>>>//     oSelList is a dbListSub
51546>>>>>//     oOK_bn is a ButtonSub
51546>>>>>//     oCancel_bn is a ButtonSub
51546>>>>>//     oSearch_bn is a ButtonSub
51546>>>>>
51546>>>>>// Register all objects
51546>>>>>Register_Object HmgioW
51546>>>>>Register_Object Hmgiow_DD
51546>>>>>Register_Object oCancel_bn
51546>>>>>Register_Object oOK_bn
51546>>>>>Register_Object oSearch_bn
51546>>>>>Register_Object oSelList
51546>>>>>
51546>>>>>
51546>>>>>    //AB-IgnoreStart
51546>>>>>
51546>>>>>    Use DFAllEnt.pkg
51546>>>>>    Use dbList.Sub
51546>>>>>    Use Button.Sub
51546>>>>>
51546>>>>>
51546>>>>>    Use HMGIOW.DD
INCLUDING FILE: HMGIOW.DD
51546>>>>>>>//DDB-FileStart
51546>>>>>>>//DDB-HeaderStart
51546>>>>>>>
51546>>>>>>>// File Name : HMGIOW.DD
51546>>>>>>>// Class Name: Hmgiow_DataDictionary
51546>>>>>>>// Revision  : 3
51546>>>>>>>// Version   : 2
51546>>>>>>>
51546>>>>>>>Use  Windows           // Basic Definitions
51546>>>>>>>Use  DataDict          // DataDictionary Class Definition
51546>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51546>>>>>>>
51546>>>>>>>Open Hmgiow
INCLUDING FILE: HMGIOW.FD
51548>>>>>>>Open Hmwtyp
51550>>>>>>>Open Sysrecw
51552>>>>>>>
51552>>>>>>>//DDB-HeaderEnd
51552>>>>>>>//DDB-ValidationStart
51552>>>>>>>
51552>>>>>>>Register_Object Hmgiow_Hmgiow_Module_VT
51552>>>>>>>
51552>>>>>>>Object Hmgiow_Hmgiow_Module_VT  is a CodeValidationTable
51554>>>>>>>    Set Type_Value        To "MODULE"
51555>>>>>>>    //DDB-ValidationCustomStart
51555>>>>>>>    //DDB-ValidationCustomEnd
51555>>>>>>>End_Object   // Hmgiow_Hmgiow_Module_VT
51556>>>>>>>//DDB-ValidationEnd
51556>>>>>>>//DDB-SelectionStart
51556>>>>>>>//DDB/ ExternalSelectionList HmgioW  HmgioW.SL
51556>>>>>>>Register_Object HmgioW
51556>>>>>>>//DDB-SelectionEnd
51556>>>>>>>
51556>>>>>>>Class Hmgiow_DataDictionary  is a DataDictionary_Sec
51557>>>>>>>
51557>>>>>>>    // Define_Fields:
51557>>>>>>>    // This procedure is used to set up all data-dictionary rules.
51557>>>>>>>
51557>>>>>>>    Procedure Define_Fields
51558>>>>>>>        Forward Send Define_Fields
51560>>>>>>>        //DDB-Generated-Code-Location
51560>>>>>>>        //DDB-DefineFieldStart
51560>>>>>>>
51560>>>>>>>        Set Main_File            To Hmgiow.File_Number
51561>>>>>>>        Set Cascade_Delete_State To FALSE
51562>>>>>>>
51562>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
51563>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
51564>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51565>>>>>>>
51565>>>>>>>        // Child (Client) file structure................
51565>>>>>>>        Send Add_Client_File  Hmwtyp.File_Number
51566>>>>>>>
51566>>>>>>>        // External (System) file structure.............
51566>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
51567>>>>>>>
51567>>>>>>>        Define_Auto_Increment  Sysrecw.Hmgiow_Code  To Hmgiow.Hmgiow_Code
51570>>>>>>>
51570>>>>>>>        // Field-based properties.......................
51570>>>>>>>
51570>>>>>>>        // Hmgiow.Hmgiow_Code
51570>>>>>>>        Set Field_Options          Field Hmgiow.Hmgiow_Code To DD_AUTOFIND
51571>>>>>>>        Set Field_Prompt_Object    Field Hmgiow.Hmgiow_Code To (HmgioW(Self))
51572>>>>>>>
51572>>>>>>>        // Hmgiow.Hmgiow_Descr
51572>>>>>>>        Set Field_Options          Field Hmgiow.Hmgiow_Descr To DD_AUTOFIND
51573>>>>>>>        Set Field_Prompt_Object    Field Hmgiow.Hmgiow_Descr To (HmgioW(Self))
51574>>>>>>>
51574>>>>>>>        // Hmgiow.Hmgiow_Module
51574>>>>>>>        Set Field_Value_Table      Field Hmgiow.Hmgiow_Module To (Hmgiow_Hmgiow_Module_VT(Self))
51575>>>>>>>
51575>>>>>>>        //DDB-DefineFieldEnd
51575>>>>>>>    End_Procedure    // Define_Fields
51576>>>>>>>
51576>>>>>>>    // Field_Defaults:
51576>>>>>>>    // This procedure is used to establish default field values.
51576>>>>>>>
51576>>>>>>>    Procedure Field_Defaults
51577>>>>>>>        Forward Send Field_Defaults
51579>>>>>>>        //DDB-Generated-Code-Location
51579>>>>>>>        //DDB-FieldDefaultStart
51579>>>>>>>        //DDB-FieldDefaultEnd
51579>>>>>>>    End_Procedure    // Field_Defaults
51580>>>>>>>
51580>>>>>>>End_Class    // Hmgiow_DataDictionary
51581>>>>>>>//DDB-Selection-pkg-Start
51581>>>>>>>
51581>>>>>>>Use HmgioW.SL        // HmgioW
51581>>>>>>>
51581>>>>>>>//DDB-Selection-pkg-End
51581>>>>>>>//DDB-FileEnd
51581>>>>>    
51581>>>>>    //AB-IgnoreEnd
51581>>>>>
51581>>>>>    CD_Popup_Object HmgioW is a dbModalPanelSub
51600>>>>>
51600>>>>>        //AB-StoreTopStart
51600>>>>>        Property String psModule Public ''
51602>>>>>        
51602>>>>>        //AB-StoreTopEnd
51602>>>>>
51602>>>>>        set label to "†£œ¨¦¢æš ˜ €§¦Ÿã¡žª" 
51603>>>>>        Set Size to 148 297
51604>>>>>        Set Location to 5 9
51605>>>>>        Set Exit_Application_Local_State to FALSE
51606>>>>>        Set Modal_State to FALSE
51607>>>>>
51607>>>>>        //AB-DDOStart
51607>>>>>
51607>>>>>        Object Hmgiow_DD is a Hmgiow_DataDictionary
51609>>>>>        End_Object    // Hmgiow_DD
51610>>>>>
51610>>>>>        Set Main_DD to (Hmgiow_DD(self))
51611>>>>>        Set Server to (Hmgiow_DD(self))
51612>>>>>
51612>>>>>        //AB-DDOEnd
51612>>>>>
51612>>>>>        Object oSelList is a dbListSub
51614>>>>>            Set Main_File to Hmgiow.File_Number
51615>>>>>            Set Size to 105 280
51616>>>>>            Set Location to 6 6
51617>>>>>
51617>>>>>            Begin_Row
51620>>>>>                Entry_Item Hmgiow.Hmgiow_code
51621>>>>>                Entry_Item Hmgiow.Hmgiow_descr
51622>>>>>            End_Row
51627>>>>>
51627>>>>>            Set Form_Width    item 0 to 48
51628>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
51629>>>>>            
51629>>>>>            Set Form_Width    item 1 to 225
51630>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
51631>>>>>            
51631>>>>>        End_Object    // oSelList
51632>>>>>
51632>>>>>        Object oOK_bn is a ButtonSub
51634>>>>>            set label to "&„§ ¢¦šã" 
51635>>>>>            Set Location to 115 126
51636>>>>>
51636>>>>>            //AB-StoreStart
51636>>>>>            Procedure OnClick
51638>>>>>                Send OK To (oSelList(current_object))
51639>>>>>            End_Procedure
51640>>>>>            //AB-StoreEnd
51640>>>>>
51640>>>>>        End_Object    // oOK_bn
51641>>>>>
51641>>>>>        Object oCancel_bn is a ButtonSub
51643>>>>>            set label to "&€¡ç¨à©ž" 
51644>>>>>            Set Location to 115 181
51645>>>>>
51645>>>>>            //AB-StoreStart
51645>>>>>            Procedure OnClick
51647>>>>>                Send Cancel To (oSelList(current_object))
51648>>>>>            End_Procedure
51649>>>>>            //AB-StoreEnd
51649>>>>>
51649>>>>>        End_Object    // oCancel_bn
51650>>>>>
51650>>>>>        Object oSearch_bn is a ButtonSub
51652>>>>>            set label to "€&¤˜ã«ž©ž" 
51653>>>>>            Set Location to 115 236
51654>>>>>
51654>>>>>            //AB-StoreStart
51654>>>>>            Procedure OnClick
51656>>>>>                Send Search To (oSelList(current_object))
51657>>>>>            End_Procedure
51658>>>>>            //AB-StoreEnd
51658>>>>>
51658>>>>>        End_Object    // oSearch_bn
51659>>>>>
51659>>>>>
51659>>>>>        //AB-StoreStart
51659>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
51660>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
51661>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
51662>>>>>        
51662>>>>>        //AB-StoreEnd
51662>>>>>
51662>>>>>    CD_End_Object    // HmgioW
51664>>>>>>
51664>>>>>
51664>>>>>//AB/     End_Object    // prj
51664>>>Use Witemx.sl
INCLUDING FILE: WITEMX.SL
51664>>>>>//AB/ Project Witemx:Lookup Eidon Apothikhs
51664>>>>>//AB/     Object prj is a Lookup_Project
51664>>>>>//AB/         Set ProjectName to "Witemx:Lookup Eidon Apothikhs"
51664>>>>>//AB/         Set ProjectFileName to "Witemx.SL"
51664>>>>>//AB/         Set GenerateFileName to "NONAME"
51664>>>>>
51664>>>>>// Project Object Structure
51664>>>>>//   Witemx is a dbModalPanelSub
51664>>>>>//     Units_DD is a DataDictionary
51664>>>>>//     Witemkat_DD is a DataDictionary
51664>>>>>//     Item_DD is a DataDictionary
51664>>>>>//     Witemx_DD is a DataDictionary
51664>>>>>//     oSelList is a dbListSub
51664>>>>>//     oOK_bn is a ButtonSub
51664>>>>>//     oCancel_bn is a ButtonSub
51664>>>>>//     oSearch_bn is a ButtonSub
51664>>>>>
51664>>>>>// Register all objects
51664>>>>>Register_Object Item_DD
51664>>>>>Register_Object oCancel_bn
51664>>>>>Register_Object oOK_bn
51664>>>>>Register_Object oSearch_bn
51664>>>>>Register_Object oSelList
51664>>>>>Register_Object Units_DD
51664>>>>>Register_Object Witemkat_DD
51664>>>>>Register_Object Witemx
51664>>>>>Register_Object Witemx_DD
51664>>>>>
51664>>>>>
51664>>>>>    //AB-IgnoreStart
51664>>>>>
51664>>>>>    Use DFAllEnt.pkg
51664>>>>>    Use dbList.Sub
51664>>>>>    Use Button.Sub
51664>>>>>
51664>>>>>
51664>>>>>    Use UNITS.DD
51664>>>>>    Use WITEMKAT.DD
51664>>>>>    Use ITEM.DD
51664>>>>>    Use WITEMX.DD
51664>>>>>    
51664>>>>>    //AB-IgnoreEnd
51664>>>>>
51664>>>>>    CD_Popup_Object Witemx is a dbModalPanelSub
51683>>>>>        set label to "„ ›ž / Witemx" 
51684>>>>>        Set Size to 148 503
51685>>>>>        Set Location to 4 5
51686>>>>>        Set Exit_Application_Local_State to FALSE
51687>>>>>        Set Modal_State to FALSE
51688>>>>>
51688>>>>>        //AB-DDOStart
51688>>>>>
51688>>>>>        Object Units_DD is a Units_DataDictionary
51690>>>>>        End_Object    // Units_DD
51691>>>>>
51691>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
51693>>>>>        End_Object    // Witemkat_DD
51694>>>>>
51694>>>>>        Object Item_DD is a Item_DataDictionary
51696>>>>>            Set DDO_Server to (Units_DD(self))
51697>>>>>            Set DDO_Server to (Witemkat_DD(self))
51698>>>>>        End_Object    // Item_DD
51699>>>>>
51699>>>>>        Object Witemx_DD is a Witemx_DataDictionary
51701>>>>>            Set DDO_Server to (Item_DD(self))
51702>>>>>        End_Object    // Witemx_DD
51703>>>>>
51703>>>>>        Set Main_DD to (Witemx_DD(self))
51704>>>>>        Set Server to (Witemx_DD(self))
51705>>>>>
51705>>>>>        //AB-DDOEnd
51705>>>>>
51705>>>>>        Object oSelList is a dbListSub
51707>>>>>            Set Main_File to Witemx.File_Number
51708>>>>>            Set Size to 105 488
51709>>>>>            Set Location to 6 6
51710>>>>>
51710>>>>>            Begin_Row
51713>>>>>                Entry_Item Witemx.Witemx_recr
51714>>>>>                Entry_Item Witemx.Witemx_code
51715>>>>>                Entry_Item Witemx.Witemx_descr
51716>>>>>                entry_item units.units_descr 
51717>>>>>                Entry_Item Witemkat.Witemkat_descr
51718>>>>>                Entry_Item Item.Item_descr
51719>>>>>            End_Row
51724>>>>>
51724>>>>>            Set Form_Width    item 0 to 43
51725>>>>>            Set Header_Label  item 0 to "Recr"
51726>>>>>            
51726>>>>>            Set Form_Width    item 1 to 43
51727>>>>>            set header_label  item 1 to "‰à› ¡¦ª" 
51728>>>>>            
51728>>>>>            Set Form_Width    item 2 to 176
51729>>>>>            set header_label  item 2 to "œ¨ š¨˜­ã" 
51730>>>>>            
51730>>>>>            Set Form_Width    item 3 to 46
51731>>>>>            set header_label  item 3 to "‹/‹" 
51732>>>>>            
51732>>>>>            Set Form_Width    item 4 to 104
51733>>>>>            set header_label  item 4 to "‰˜«žš¦¨å˜   :" 
51734>>>>>            
51734>>>>>            Set Form_Width    item 5 to 69
51735>>>>>            set header_label  item 5 to "„ ›¦ª" 
51736>>>>>            
51736>>>>>        End_Object    // oSelList
51737>>>>>
51737>>>>>        Object oOK_bn is a ButtonSub
51739>>>>>            set label to "&„§ ¢¦šã" 
51740>>>>>            Set Location to 113 335
51741>>>>>
51741>>>>>            //AB-StoreStart
51741>>>>>            Procedure OnClick
51743>>>>>                Send OK To (oSelList(current_object))
51744>>>>>            End_Procedure
51745>>>>>            //AB-StoreEnd
51745>>>>>
51745>>>>>        End_Object    // oOK_bn
51746>>>>>
51746>>>>>        Object oCancel_bn is a ButtonSub
51748>>>>>            set label to "&€¡ç¨à©ž" 
51749>>>>>            Set Location to 113 390
51750>>>>>
51750>>>>>            //AB-StoreStart
51750>>>>>            Procedure OnClick
51752>>>>>                Send Cancel To (oSelList(current_object))
51753>>>>>            End_Procedure
51754>>>>>            //AB-StoreEnd
51754>>>>>
51754>>>>>        End_Object    // oCancel_bn
51755>>>>>
51755>>>>>        Object oSearch_bn is a ButtonSub
51757>>>>>            set label to "€&¤˜ã«ž©ž" 
51758>>>>>            Set Location to 113 445
51759>>>>>
51759>>>>>            //AB-StoreStart
51759>>>>>            Procedure OnClick
51761>>>>>                Send Search To (oSelList(current_object))
51762>>>>>            End_Procedure
51763>>>>>            //AB-StoreEnd
51763>>>>>
51763>>>>>        End_Object    // oSearch_bn
51764>>>>>
51764>>>>>
51764>>>>>        //AB-StoreStart
51764>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
51765>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
51766>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
51767>>>>>        //AB-StoreEnd
51767>>>>>
51767>>>>>    CD_End_Object    // Witemx
51769>>>>>>
51769>>>>>
51769>>>>>//AB/     End_Object    // prj
51769>>>Use Cities.sl
INCLUDING FILE: CITIES.SL
51769>>>>>//AB/ Project Cities:lookup
51769>>>>>//AB/ Object prj is a Lookup_Project
51769>>>>>//AB/     Set ProjectName to "Cities:lookup"
51769>>>>>//AB/     Set ProjectFileName to "Cities.SL"
51769>>>>>//AB/     Set GenerateFileName to "NONAME"
51769>>>>>
51769>>>>>// Project Object Structure
51769>>>>>//   Cities is a dbModalPanelSub
51769>>>>>//     Cities_DD is a DataDictionary
51769>>>>>//     oSelList is a dbListSub
51769>>>>>//     oOK_bn is a ButtonSub
51769>>>>>//     oCancel_bn is a ButtonSub
51769>>>>>//     oSearch_bn is a ButtonSub
51769>>>>>
51769>>>>>// Register all objects
51769>>>>>Register_Object Cities
51769>>>>>Register_Object Cities_DD
51769>>>>>Register_Object oCancel_bn
51769>>>>>Register_Object oOK_bn
51769>>>>>Register_Object oSearch_bn
51769>>>>>Register_Object oSelList
51769>>>>>
51769>>>>>
51769>>>>>//AB-IgnoreStart
51769>>>>>
51769>>>>>Use DFAllEnt.pkg
51769>>>>>Use dbList.Sub
51769>>>>>Use Button.Sub
51769>>>>>
51769>>>>>
51769>>>>>Use CITIES.DD
51769>>>>>
51769>>>>>//AB-IgnoreEnd
51769>>>>>
51769>>>>>CD_Popup_Object Cities is a dbModalPanelSub
51788>>>>>    Set Label to "Cities"
51789>>>>>    Set Size to 148 297
51790>>>>>    Set Location to 4 5
51791>>>>>    Set Exit_Application_Local_State to FALSE
51792>>>>>    Set Modal_State to FALSE
51793>>>>>
51793>>>>>    //AB-DDOStart
51793>>>>>
51793>>>>>    Object Cities_DD is a Cities_DataDictionary
51795>>>>>    End_Object    // Cities_DD
51796>>>>>
51796>>>>>    Set Main_DD to (Cities_DD(self))
51797>>>>>    Set Server to (Cities_DD(self))
51798>>>>>
51798>>>>>    //AB-DDOEnd
51798>>>>>
51798>>>>>    Object oSelList is a dbListSub
51800>>>>>        Set Main_File to Cities.File_Number
51801>>>>>        Set Size to 105 280
51802>>>>>        Set Location to 6 6
51803>>>>>
51803>>>>>        Begin_Row
51806>>>>>            Entry_Item Cities.City_id
51807>>>>>            Entry_Item Cities.City_descr
51808>>>>>        End_Row
51813>>>>>
51813>>>>>        Set Form_Width    item 0 to 52
51814>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
51815>>>>>        
51815>>>>>        Set Form_Width    item 1 to 221
51816>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
51817>>>>>        
51817>>>>>    End_Object    // oSelList
51818>>>>>
51818>>>>>    Object oOK_bn is a ButtonSub
51820>>>>>        set label to "&„§ ¢¦šã" 
51821>>>>>        Set Location to 115 126
51822>>>>>
51822>>>>>        //AB-StoreStart
51822>>>>>        Procedure OnClick
51824>>>>>            Send OK To (oSelList(current_object))
51825>>>>>        End_Procedure
51826>>>>>        //AB-StoreEnd
51826>>>>>
51826>>>>>    End_Object    // oOK_bn
51827>>>>>
51827>>>>>    Object oCancel_bn is a ButtonSub
51829>>>>>        set label to "&€¡ç¨à©ž" 
51830>>>>>        Set Location to 115 181
51831>>>>>
51831>>>>>        //AB-StoreStart
51831>>>>>        Procedure OnClick
51833>>>>>            Send Cancel To (oSelList(current_object))
51834>>>>>        End_Procedure
51835>>>>>        //AB-StoreEnd
51835>>>>>
51835>>>>>    End_Object    // oCancel_bn
51836>>>>>
51836>>>>>    Object oSearch_bn is a ButtonSub
51838>>>>>        set label to "€&¤˜ã«ž©ž" 
51839>>>>>        Set Location to 115 236
51840>>>>>
51840>>>>>        //AB-StoreStart
51840>>>>>        Procedure OnClick
51842>>>>>            Send Search To (oSelList(current_object))
51843>>>>>        End_Procedure
51844>>>>>        //AB-StoreEnd
51844>>>>>
51844>>>>>    End_Object    // oSearch_bn
51845>>>>>
51845>>>>>
51845>>>>>    //AB-StoreStart
51845>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
51846>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
51847>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
51848>>>>>    //AB-StoreEnd
51848>>>>>
51848>>>>>CD_End_Object    // Cities
51850>>>>>>
51850>>>>>
51850>>>>>//AB/ End_Object    // prj
51850>>>Use constrCn.sl
INCLUDING FILE: CONSTRCN.SL
51850>>>>>//AB/ Project CONSTRCN:LOOKUP
51850>>>>>//AB/ Object prj is a Lookup_Project
51850>>>>>//AB/     Set ProjectName to "CONSTRCN:LOOKUP"
51850>>>>>//AB/     Set ProjectFileName to "CONSTRCN.SL"
51850>>>>>
51850>>>>>// Project Object Structure
51850>>>>>//   CONSTRCN is a dbModalPanelSub
51850>>>>>//     Constrct_DD is a DataDictionary
51850>>>>>//     oSelList is a dbListSub
51850>>>>>//     oOK_bn is a ButtonSub
51850>>>>>//     oCancel_bn is a ButtonSub
51850>>>>>//     oSearch_bn is a ButtonSub
51850>>>>>
51850>>>>>// Register all objects
51850>>>>>Register_Object CONSTRCN
51850>>>>>Register_Object Constrct_DD
51850>>>>>Register_Object oCancel_bn
51850>>>>>Register_Object oOK_bn
51850>>>>>Register_Object oSearch_bn
51850>>>>>Register_Object oSelList
51850>>>>>
51850>>>>>
51850>>>>>//AB-IgnoreStart
51850>>>>>
51850>>>>>Use DFAllEnt.pkg
51850>>>>>Use dbList.Sub
51850>>>>>Use Button.Sub
51850>>>>>
51850>>>>>
51850>>>>>Use CONSTRCT.DD
INCLUDING FILE: CONSTRCT.DD
51850>>>>>>>//DDB-FileStart
51850>>>>>>>//DDB-HeaderStart
51850>>>>>>>
51850>>>>>>>// File Name : CONSTRCT.DD
51850>>>>>>>// Class Name: Constrct_DataDictionary
51850>>>>>>>// Revision  : 49
51850>>>>>>>// Version   : 2
51850>>>>>>>
51850>>>>>>>Use  Windows           // Basic Definitions
51850>>>>>>>Use  DataDict          // DataDictionary Class Definition
51850>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51850>>>>>>>
51850>>>>>>>Open Constrct
51852>>>>>>>Open Cn
51854>>>>>>>Open Sysrecc
51856>>>>>>>
51856>>>>>>>//DDB-HeaderEnd
51856>>>>>>>//DDB-ValidationStart
51856>>>>>>>
51856>>>>>>>Register_Object Constrct_Cnt_Doy_VT1
51856>>>>>>>
51856>>>>>>>Object Constrct_Cnt_Doy_VT1  is a CodeValidationTable
51858>>>>>>>    Set Type_Value        To "DOY"
51859>>>>>>>    Set Allow_Blank_State To TRUE
51860>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
51861>>>>>>>    //DDB-ValidationCustomStart
51861>>>>>>>    //DDB-ValidationCustomEnd
51861>>>>>>>End_Object   // Constrct_Cnt_Doy_VT1
51862>>>>>>>//DDB-ValidationEnd
51862>>>>>>>//DDB-SelectionStart
51862>>>>>>>//DDB/ ExternalSelectionList sl109  sl109.SL
51862>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
51862>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
51862>>>>>>>Register_Object sl109
51862>>>>>>>Register_Object sl198
51862>>>>>>>Register_Object sl197
51862>>>>>>>//DDB-SelectionEnd
51862>>>>>>>
51862>>>>>>>Class Constrct_DataDictionary  is a DataDictionary_Sec
51863>>>>>>>    Procedure Update
51864>>>>>>>        Forward Send Update
51866>>>>>>>        // Insert Code Here
51866>>>>>>>        Move SysCurXR.Company_Code  to constrct.Company_Code
51867>>>>>>>        Move SysCurXR.Branch_Code   to constrct.Branch_Code
51868>>>>>>>        Move SysCurXR.Year_Year     to constrct.Year_Year
51869>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
51869>>>>>>>        Move (constrct.Xreosh-Constrct.Pistosh)   to Constrct.Ypoloipo
51870>>>>>>>        Move (constrct.Plafon-Constrct.Ypoloipo)  to Constrct.Overhead
51871>>>>>>>
51871>>>>>>>        //betolink
51871>>>>>>>        Move SysCurXR.Beto_Site      to Constrct.cnt_SiteW
51872>>>>>>>        Move Constrct.cnt_Rec0        to Constrct.cnt_SN
51873>>>>>>>        Move Constrct.cnt_id          to constrct.cnt_Repm
51874>>>>>>>
51874>>>>>>>    End_Procedure   // Update
51875>>>>>>>
51875>>>>>>>     Procedure Creating
51876>>>>>>>        Forward Send Creating
51878>>>>>>>        // Insert Code Here
51878>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Constrct.cnt_Rec0))))));                                    to Constrct.Cnt_Recr
51879>>>>>>>        Move '1'                    to Constrct.Cnt_Active
51880>>>>>>>        Get fsgCode_With_Zeroes Constrct.Cnt_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Constrct.cnt_ID
51881>>>>>>>    End_Procedure   // Creating
51882>>>>>>>
51882>>>>>>>
51882>>>>>>>    Procedure Define_Fields
51883>>>>>>>        Forward Send Define_Fields
51885>>>>>>>        //DDB-Generated-Code-Location
51885>>>>>>>        //DDB-DefineFieldStart
51885>>>>>>>
51885>>>>>>>        Set Main_File            To Constrct.File_Number
51886>>>>>>>        Set Cascade_Delete_State To FALSE
51887>>>>>>>
51887>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51888>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51889>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51890>>>>>>>
51890>>>>>>>        // Child (Client) file structure................
51890>>>>>>>        Send Add_Client_File  Cn.File_Number
51891>>>>>>>
51891>>>>>>>        // External (System) file structure.............
51891>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
51892>>>>>>>
51892>>>>>>>        Define_Auto_Increment  Sysrecc.Constrct_Rec0  To Constrct.Cnt_Rec0
51895>>>>>>>
51895>>>>>>>        // Field-based properties.......................
51895>>>>>>>
51895>>>>>>>        // Constrct.Company_Code
51895>>>>>>>
51895>>>>>>>        // Constrct.Branch_Code
51895>>>>>>>
51895>>>>>>>        // Constrct.Year_Year
51895>>>>>>>
51895>>>>>>>        // Constrct.Cnt_Id
51895>>>>>>>        Set Field_Options          Field Constrct.Cnt_Id To DD_AUTOFIND    DD_NOPUT      
51896>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Id To (sl109(Self))
51897>>>>>>>        Set Key_Field_State        Field Constrct.Cnt_Id To TRUE
51898>>>>>>>
51898>>>>>>>        // Constrct.Cnt_Name
51898>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Name To (sl109(Self))
51899>>>>>>>
51899>>>>>>>        // Constrct.Cnt_Afm
51899>>>>>>>
51899>>>>>>>        // Constrct.Cnt_Rec0
51899>>>>>>>
51899>>>>>>>        // Constrct.Cnt_Recr
51899>>>>>>>
51899>>>>>>>        // Constrct.Last_Xreosh
51899>>>>>>>
51899>>>>>>>        // Constrct.Last_Pistosh
51899>>>>>>>
51899>>>>>>>        // Constrct.Last_Order
51899>>>>>>>
51899>>>>>>>        // Constrct.Cnt_Doy
51899>>>>>>>        Set Field_Value_Table      Field Constrct.Cnt_Doy To (Constrct_Cnt_Doy_VT1(Self))
51900>>>>>>>
51900>>>>>>>        // Constrct.Cnt_Address
51900>>>>>>>
51900>>>>>>>        // Constrct.Cnt_City
51900>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_City To (sl198(Self))
51901>>>>>>>
51901>>>>>>>        // Constrct.Cnt_Area
51901>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Area To (sl197(Self))
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Job
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Respons
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Zipcode
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Phone
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Fax
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Mobile
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Aoh
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Email
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Class
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Details
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Sitew
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Codem
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Categfpa
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Fpa
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Public
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Sn
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Repm
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Active
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Reported
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Pelprom
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Lastupdated
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Markexp
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Catjob
51902>>>>>>>
51902>>>>>>>        // Constrct.Xreosh
51902>>>>>>>
51902>>>>>>>        // Constrct.Pistosh
51902>>>>>>>
51902>>>>>>>        // Constrct.Ypoloipo
51902>>>>>>>
51902>>>>>>>        // Constrct.Plafon
51902>>>>>>>
51902>>>>>>>        // Constrct.Overhead
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Add_No
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Nomos
51902>>>>>>>
51902>>>>>>>        // Constrct.Cnt_Xora
51902>>>>>>>
51902>>>>>>>        // Constrct.Polh_Recr
51902>>>>>>>
51902>>>>>>>        //DDB-DefineFieldEnd
51902>>>>>>>    End_Procedure    // Define_Fields
51903>>>>>>>
51903>>>>>>>    // Field_Defaults:
51903>>>>>>>    // This procedure is used to establish default field values.
51903>>>>>>>
51903>>>>>>>    Procedure Field_Defaults
51904>>>>>>>        Forward Send Field_Defaults
51906>>>>>>>        //DDB-Generated-Code-Location
51906>>>>>>>        //DDB-FieldDefaultStart
51906>>>>>>>        Set Field_Changed_Value   Field Constrct.Cnt_Doy To "0"
51907>>>>>>>        //DDB-FieldDefaultEnd
51907>>>>>>>    End_Procedure    // Field_Defaults
51908>>>>>>>
51908>>>>>>>End_Class    // Constrct_DataDictionary
51909>>>>>>>//DDB-Selection-pkg-Start
51909>>>>>>>
51909>>>>>>>Use sl109.SL         // sl109
INCLUDING FILE: SL109.SL
51909>>>>>>>>>//AB/ Project sl109
51909>>>>>>>>>//AB/ Object prj is a Lookup_Project
51909>>>>>>>>>//AB/     Set ProjectName to "sl109"
51909>>>>>>>>>//AB/     Set ProjectFileName to "sl109.SL"
51909>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
51909>>>>>>>>>
51909>>>>>>>>>// Project Object Structure
51909>>>>>>>>>//   sl109 is a dbModalPanelSub
51909>>>>>>>>>//     Constrct_DD is a DataDictionary
51909>>>>>>>>>//     oSelList is a dbListSub
51909>>>>>>>>>//     oOK_bn is a ButtonSub
51909>>>>>>>>>//     oCancel_bn is a ButtonSub
51909>>>>>>>>>//     oSearch_bn is a ButtonSub
51909>>>>>>>>>
51909>>>>>>>>>// Register all objects
51909>>>>>>>>>Register_Object Constrct_DD
51909>>>>>>>>>Register_Object oCancel_bn
51909>>>>>>>>>Register_Object oOK_bn
51909>>>>>>>>>Register_Object oSearch_bn
51909>>>>>>>>>Register_Object oSelList
51909>>>>>>>>>Register_Object sl109
51909>>>>>>>>>
51909>>>>>>>>>
51909>>>>>>>>>//AB-IgnoreStart
51909>>>>>>>>>
51909>>>>>>>>>Use DFAllEnt.pkg
51909>>>>>>>>>Use dbList.Sub
51909>>>>>>>>>Use Button.Sub
51909>>>>>>>>>
51909>>>>>>>>>
51909>>>>>>>>>Use CONSTRCT.DD
51909>>>>>>>>>
51909>>>>>>>>>//AB-IgnoreEnd
51909>>>>>>>>>
51909>>>>>>>>>Object sl109 is a dbModalPanelSub
51911>>>>>>>>>    Set Label to "„¨š¦¢á™¦  "
51912>>>>>>>>>    Set Size to 148 427
51913>>>>>>>>>    Set Location to 4 5
51914>>>>>>>>>    Set Exit_Application_Local_State to FALSE
51915>>>>>>>>>    Set Modal_State to FALSE
51916>>>>>>>>>
51916>>>>>>>>>    //AB-DDOStart
51916>>>>>>>>>
51916>>>>>>>>>    Object Constrct_DD is a Constrct_DataDictionary
51918>>>>>>>>>    End_Object    // Constrct_DD
51919>>>>>>>>>
51919>>>>>>>>>    Set Main_DD to (Constrct_DD(self))
51920>>>>>>>>>    Set Server to (Constrct_DD(self))
51921>>>>>>>>>
51921>>>>>>>>>    //AB-DDOEnd
51921>>>>>>>>>
51921>>>>>>>>>    Object oSelList is a dbListSub
51923>>>>>>>>>        Set Main_File to Constrct.File_Number
51924>>>>>>>>>        Set Size to 105 415
51925>>>>>>>>>        Set Location to 6 6
51926>>>>>>>>>
51926>>>>>>>>>        Begin_Row
51929>>>>>>>>>            Entry_Item Constrct.Cnt_id
51930>>>>>>>>>            Entry_Item Constrct.Cnt_name
51931>>>>>>>>>            Entry_Item Constrct.Cnt_afm
51932>>>>>>>>>            Entry_Item Constrct.Cnt_address
51933>>>>>>>>>            Entry_Item Constrct.Cnt_phone
51934>>>>>>>>>        End_Row
51939>>>>>>>>>
51939>>>>>>>>>        Set Form_Width    item 0 to 70
51940>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
51941>>>>>>>>>        
51941>>>>>>>>>        Set Form_Width    item 1 to 100
51942>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
51943>>>>>>>>>        
51943>>>>>>>>>        Set Form_Width    item 2 to 50
51944>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
51945>>>>>>>>>        
51945>>>>>>>>>        Set Form_Width    item 3 to 135
51946>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
51947>>>>>>>>>        
51947>>>>>>>>>        Set Form_Width    item 4 to 52
51948>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
51949>>>>>>>>>        
51949>>>>>>>>>    End_Object    // oSelList
51950>>>>>>>>>
51950>>>>>>>>>    Object oOK_bn is a ButtonSub
51952>>>>>>>>>        Set Label to "&„§ ¢¦šã"
51953>>>>>>>>>        Set Location to 116 261
51954>>>>>>>>>
51954>>>>>>>>>        //AB-StoreStart
51954>>>>>>>>>        Procedure OnClick
51956>>>>>>>>>            Send OK To (oSelList(current_object))
51957>>>>>>>>>        End_Procedure
51958>>>>>>>>>        //AB-StoreEnd
51958>>>>>>>>>
51958>>>>>>>>>    End_Object    // oOK_bn
51959>>>>>>>>>
51959>>>>>>>>>    Object oCancel_bn is a ButtonSub
51961>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
51962>>>>>>>>>        Set Location to 116 315
51963>>>>>>>>>
51963>>>>>>>>>        //AB-StoreStart
51963>>>>>>>>>        Procedure OnClick
51965>>>>>>>>>            Send Cancel To (oSelList(current_object))
51966>>>>>>>>>        End_Procedure
51967>>>>>>>>>        //AB-StoreEnd
51967>>>>>>>>>
51967>>>>>>>>>    End_Object    // oCancel_bn
51968>>>>>>>>>
51968>>>>>>>>>    Object oSearch_bn is a ButtonSub
51970>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
51971>>>>>>>>>        Set Location to 116 371
51972>>>>>>>>>
51972>>>>>>>>>        //AB-StoreStart
51972>>>>>>>>>        Procedure OnClick
51974>>>>>>>>>            Send Search To (oSelList(current_object))
51975>>>>>>>>>        End_Procedure
51976>>>>>>>>>        //AB-StoreEnd
51976>>>>>>>>>
51976>>>>>>>>>    End_Object    // oSearch_bn
51977>>>>>>>>>
51977>>>>>>>>>
51977>>>>>>>>>    //AB-StoreStart
51977>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
51978>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
51979>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
51980>>>>>>>>>    //AB-StoreEnd
51980>>>>>>>>>
51980>>>>>>>>>End_Object    // sl109
51981>>>>>>>>>
51981>>>>>>>>>//AB/ End_Object    // prj
51981>>>>>>>Use sl198.sl         // sl198
51981>>>>>>>Use sl197.SL         // sl197
51981>>>>>>>
51981>>>>>>>//DDB-Selection-pkg-End
51981>>>>>>>//DDB-FileEnd
51981>>>>>
51981>>>>>//AB-IgnoreEnd
51981>>>>>
51981>>>>>CD_Popup_Object CONSTRCN is a dbModalPanelSub
52000>>>>>    Set Label to "Constructors"
52001>>>>>    Set Size to 148 423
52002>>>>>    Set Location to 6 6
52003>>>>>    Set Exit_Application_Local_State to FALSE
52004>>>>>    Set Modal_State to FALSE
52005>>>>>
52005>>>>>    //AB-DDOStart
52005>>>>>
52005>>>>>    Object Constrct_DD is a Constrct_DataDictionary
52007>>>>>    End_Object    // Constrct_DD
52008>>>>>
52008>>>>>    Set Main_DD to (Constrct_DD(self))
52009>>>>>    Set Server to (Constrct_DD(self))
52010>>>>>
52010>>>>>    //AB-DDOEnd
52010>>>>>
52010>>>>>    Object oSelList is a dbListSub
52012>>>>>        Set Main_File to Constrct.File_Number
52013>>>>>        Set Size to 105 406
52014>>>>>        Set Location to 6 6
52015>>>>>
52015>>>>>        Begin_Row
52018>>>>>            Entry_Item Constrct.Cnt_id
52019>>>>>            Entry_Item Constrct.Cnt_name
52020>>>>>            Entry_Item Constrct.Cnt_phone
52021>>>>>        End_Row
52026>>>>>
52026>>>>>        Set Form_Width    item 0 to 59
52027>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
52028>>>>>        
52028>>>>>        Set Form_Width    item 1 to 189
52029>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
52030>>>>>        
52030>>>>>        Set Form_Width    item 2 to 151
52031>>>>>        Set Header_Label  item 2 to "’ž¢â­à¤˜"
52032>>>>>        
52032>>>>>    End_Object    // oSelList
52033>>>>>
52033>>>>>    Object oOK_bn is a ButtonSub
52035>>>>>        Set Label to "&„§ ¢¦šã"
52036>>>>>        Set Location to 114 253
52037>>>>>
52037>>>>>        //AB-StoreStart
52037>>>>>        Procedure OnClick
52039>>>>>            Send OK To (oSelList(current_object))
52040>>>>>        End_Procedure
52041>>>>>        //AB-StoreEnd
52041>>>>>
52041>>>>>    End_Object    // oOK_bn
52042>>>>>
52042>>>>>    Object oCancel_bn is a ButtonSub
52044>>>>>        Set Label to "&€¡ç¨à©ž"
52045>>>>>        Set Location to 114 307
52046>>>>>
52046>>>>>        //AB-StoreStart
52046>>>>>        Procedure OnClick
52048>>>>>            Send Cancel To (oSelList(current_object))
52049>>>>>        End_Procedure
52050>>>>>        //AB-StoreEnd
52050>>>>>
52050>>>>>    End_Object    // oCancel_bn
52051>>>>>
52051>>>>>    Object oSearch_bn is a ButtonSub
52053>>>>>        Set Label to "€&¤˜ã«ž©ž"
52054>>>>>        Set Location to 114 363
52055>>>>>
52055>>>>>        //AB-StoreStart
52055>>>>>        Procedure OnClick
52057>>>>>            Send Search To (oSelList(current_object))
52058>>>>>        End_Procedure
52059>>>>>        //AB-StoreEnd
52059>>>>>
52059>>>>>    End_Object    // oSearch_bn
52060>>>>>
52060>>>>>
52060>>>>>    //AB-StoreStart
52060>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
52061>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
52062>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
52063>>>>>    //AB-StoreEnd
52063>>>>>
52063>>>>>CD_End_Object    // CONSTRCN
52065>>>>>>
52065>>>>>
52065>>>>>//AB/ End_Object    // prj
52065>>>
52065>>>
52065>        
52065>        Use bpMakeSx.dg
INCLUDING FILE: BPMAKESX.DG
52065>>>//AB/ Project bpMakeSx
52065>>>//AB/     Object prj is a Dialog_Project
52065>>>//AB/         Set ProjectName to "bpMakeSx"
52065>>>//AB/         Set ProjectFileName to "bpMakeSx.DG"
52065>>>//AB/         Set GenerateFileName to "NONAME"
52065>>>
52065>>>// Project Object Structure
52065>>>//   bpMakeSx is a BusinessProcessSub
52065>>>//     Ctypkin_DD is a DataDictionary
52065>>>//     Wtypkin_DD is a DataDictionary
52065>>>//     Ptyppar_DD is a DataDictionary
52065>>>//     Country_DD is a DataDictionary
52065>>>//     Towns_DD is a DataDictionary
52065>>>//     Cities_DD is a DataDictionary
52065>>>//     Areas_DD is a DataDictionary
52065>>>//     Payresp_DD is a DataDictionary
52065>>>//     Clients_DD is a DataDictionary
52065>>>//     Nomisma_DD is a DataDictionary
52065>>>//     Particle_DD is a DataDictionary
52065>>>//     Wapokat_DD is a DataDictionary
52065>>>//     Wapomast_DD is a DataDictionary
52065>>>//     Wax_DD is a DataDictionary
52065>>>//     Units_DD is a DataDictionary
52065>>>//     Witemkat_DD is a DataDictionary
52065>>>//     Fpa_DD is a DataDictionary
52065>>>//     Item_DD is a DataDictionary
52065>>>//     Witemx_DD is a DataDictionary
52065>>>//     Pmoves_DD is a DataDictionary
52065>>>//     Pmssxet_DD is a DataDictionary
52065>>>//     Psxetika_DD is a DataDictionary
52065>>>
52065>>>// Register all objects
52065>>>Register_Object Areas_DD
52065>>>Register_Object bpMakeSx
52065>>>Register_Object Cities_DD
52065>>>Register_Object Clients_DD
52065>>>Register_Object Country_DD
52065>>>Register_Object Ctypkin_DD
52065>>>Register_Object Fpa_DD
52065>>>Register_Object Item_DD
52065>>>Register_Object Nomisma_DD
52065>>>Register_Object Particle_DD
52065>>>Register_Object Payresp_DD
52065>>>Register_Object Pmoves_DD
52065>>>Register_Object Pmssxet_DD
52065>>>Register_Object Psxetika_DD
52065>>>Register_Object Ptyppar_DD
52065>>>Register_Object Towns_DD
52065>>>Register_Object Units_DD
52065>>>Register_Object Wapokat_DD
52065>>>Register_Object Wapomast_DD
52065>>>Register_Object Wax_DD
52065>>>Register_Object Witemkat_DD
52065>>>Register_Object Witemx_DD
52065>>>Register_Object Wtypkin_DD
52065>>>
52065>>>
52065>>>
52065>>>    //AB-StoreTopStart
52065>>>
52065>>>
52065>>>    //AB-StoreTopEnd
52065>>>
52065>>>    //AB-IgnoreStart
52065>>>
52065>>>    Use Bproces.Sub
52065>>>    Use DFAllEnt.pkg
52065>>>
52065>>>
52065>>>    Use CTYPKIN.DD
52065>>>    Use WTYPKIN.DD
52065>>>    Use PTYPPAR.DD
52065>>>    Use COUNTRY.DD
52065>>>    Use TOWNS.DD
52065>>>    Use CITIES.DD
52065>>>    Use AREAS.DD
52065>>>    Use PAYRESP.DD
52065>>>    Use CLIENTS.DD
52065>>>    Use NOMISMA.DD
52065>>>    Use PARTICLE.DD
52065>>>    Use PSXETIKA.DD
INCLUDING FILE: PSXETIKA.DD
52065>>>>>//DDB-FileStart
52065>>>>>//DDB-HeaderStart
52065>>>>>
52065>>>>>// File Name : PSXETIKA.DD
52065>>>>>// Class Name: Psxetika_DataDictionary
52065>>>>>// Revision  : 14
52065>>>>>// Version   : 2
52065>>>>>
52065>>>>>Use  Windows           // Basic Definitions
52065>>>>>Use  DataDict          // DataDictionary Class Definition
52065>>>>>Use  DDvalTbl          // Validation Table Class Definitions
52065>>>>>
52065>>>>>Open Psxetika
52067>>>>>Open Particle
52069>>>>>Open Sysrecp
52071>>>>>
52071>>>>>//DDB-HeaderEnd
52071>>>>>
52071>>>>>Class Psxetika_DataDictionary  is a DataDictionary_Sec
52072>>>>>
52072>>>>>    Procedure Creating
52073>>>>>        Integer iNextNo
52074>>>>>        Forward Send Creating
52076>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Psxetika.Psxetika_Rec0)))))) to Psxetika.Psxetika_Recr
52077>>>>>    End_Procedure   // Creating
52078>>>>>
52078>>>>>    Procedure Update
52079>>>>>        Forward Send Update
52081>>>>>        Move SysCurXR.Company_Code  to Psxetika.Company_Code
52082>>>>>        Move SysCurXR.Branch_Code   to Psxetika.Branch_Code
52083>>>>>        Move SysCurXR.Year_Year     to Psxetika.Year_Year
52084>>>>>        Move Clients.Client_ID      to Psxetika.Client_ID
52085>>>>>        Move Ctypkin.Ctypkin_Code   to Psxetika.Ctypkin_Code
52086>>>>>        Move Wtypkin.Wtypkin_Code   to Psxetika.Wtypkin_Code
52087>>>>>        Move Ptyppar.Ptyppar_Code   to Psxetika.Ptyppar_Code
52088>>>>>        Move Particle.Partl_Hmnia   to Psxetika.Partl_Hmnia
52089>>>>>        Move Particle.Pseira_Seira  to Psxetika.Pseira_Seira
52090>>>>>        Move Particle.Partl_No      to Psxetika.Partl_No
52091>>>>>    End_Procedure   // Update
52092>>>>>
52092>>>>>//    gts 08-06-06 mallon den xriazete
52092>>>>>//    Procedure Request_Save
52092>>>>>//        Number  nQty
52092>>>>>//        String  sParticleRecr sPsxetikaRecr
52092>>>>>//
52092>>>>>//        Forward Send Request_Save
52092>>>>>//
52092>>>>>//        Get File_Field_Current_Value File_Field Particle.Partl_Recr     to sParticleRecr
52092>>>>>//        Get File_Field_Current_Value File_Field Psxetika.Psx_Partl_Recr to sPsxetikaRecr
52092>>>>>//        If ((Trim(sParticleRecr)<>'') And (Trim(sPsxetikaRecr)<>'')) Begin
52092>>>>>//            Get File_Field_Current_Value File_Field Psxetika.Pms_Sx_Qty to nQty
52092>>>>>//            If (nQty=0) Begin
52092>>>>>//                // An h posothta pou menei apo to athroisma posothtas ton Pmoves Sxetika
52092>>>>>//                // Mhdenisei, ayto shmainei pos den yparxoun alla Pmoves Sxetika, ara
52092>>>>>//                // prepei na diagrafei ayto to Psxetika record kai to antistrofo tou.
52092>>>>>//                Delete Psxetika
52092>>>>>//                Clear Psxetika
52092>>>>>//                Move sPsxetikaRecr  to Psxetika.Partl_Recr
52092>>>>>//                Move sParticleRecr  to Psxetika.Psx_Partl_Recr
52092>>>>>//                Find Eq Psxetika by Index.4
52092>>>>>//                If (Found) Delete Psxetika
52092>>>>>//            End
52092>>>>>//        End
52092>>>>>//    End_Procedure
52092>>>>>
52092>>>>>
52092>>>>>    // Define_Fields:
52092>>>>>    // This procedure is used to set up all data-dictionary rules.
52092>>>>>
52092>>>>>    Procedure Define_Fields
52093>>>>>        Forward Send Define_Fields
52095>>>>>        //DDB-Generated-Code-Location
52095>>>>>        //DDB-DefineFieldStart
52095>>>>>
52095>>>>>        Set Main_File            To Psxetika.File_Number
52096>>>>>
52096>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
52097>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
52098>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
52099>>>>>
52099>>>>>        // Parent (Server) file structure...............
52099>>>>>        Send Add_Server_File  Particle.File_Number
52100>>>>>
52100>>>>>        // External (System) file structure.............
52100>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
52101>>>>>
52101>>>>>        Define_Auto_Increment  Sysrecp.Psxetika_Rec0  To Psxetika.Psxetika_Rec0
52104>>>>>
52104>>>>>        // Field-based properties.......................
52104>>>>>
52104>>>>>        // Psxetika.Company_Code
52104>>>>>
52104>>>>>        // Psxetika.Branch_Code
52104>>>>>
52104>>>>>        // Psxetika.Year_Year
52104>>>>>
52104>>>>>        // Psxetika.Ctypkin_Code
52104>>>>>
52104>>>>>        // Psxetika.Wtypkin_Code
52104>>>>>
52104>>>>>        // Psxetika.Ptyppar_Code
52104>>>>>
52104>>>>>        // Psxetika.Pseira_Seira
52104>>>>>
52104>>>>>        // Psxetika.Custprom_Code
52104>>>>>
52104>>>>>        // Psxetika.Client_Id
52104>>>>>
52104>>>>>        // Psxetika.Partl_No
52104>>>>>
52104>>>>>        // Psxetika.Partl_Hmnia
52104>>>>>
52104>>>>>        // Psxetika.Partl_Recr
52104>>>>>
52104>>>>>        // Psxetika.Psx_Partl_Recr
52104>>>>>
52104>>>>>        // Psxetika.Psxetika_Recr
52104>>>>>
52104>>>>>        // Psxetika.Psxetika_Rec0
52104>>>>>
52104>>>>>        // Psxetika.Sx_Company_Code
52104>>>>>
52104>>>>>        // Psxetika.Sx_Branch_Code
52104>>>>>
52104>>>>>        // Psxetika.Sx_Year_Year
52104>>>>>
52104>>>>>        // Psxetika.Sx_Ctypkin_Code
52104>>>>>
52104>>>>>        // Psxetika.Sx_Wtypkin_Code
52104>>>>>
52104>>>>>        // Psxetika.Sx_Ptyppar_Code
52104>>>>>
52104>>>>>        // Psxetika.Sx_Pseira_Seira
52104>>>>>
52104>>>>>        // Psxetika.Sx_Custpromcode
52104>>>>>
52104>>>>>        // Psxetika.Sx_Client_Id
52104>>>>>
52104>>>>>        // Psxetika.Sx_Partl_No
52104>>>>>
52104>>>>>        // Psxetika.Sx_Partl_Hmnia
52104>>>>>
52104>>>>>        // Psxetika.Sx_Ctypkin_Desc
52104>>>>>
52104>>>>>        // Psxetika.Sx_Wtypkin_Desc
52104>>>>>
52104>>>>>        // Psxetika.Sx_Ptyppar_Desc
52104>>>>>
52104>>>>>        // Psxetika.Sx_Custpromdesc
52104>>>>>
52104>>>>>        // Psxetika.Sx_Client_Desc
52104>>>>>
52104>>>>>        // Psxetika.Pms_Sx_Qty
52104>>>>>
52104>>>>>        //DDB-DefineFieldEnd
52104>>>>>    End_Procedure    // Define_Fields
52105>>>>>
52105>>>>>    // Field_Defaults:
52105>>>>>    // This procedure is used to establish default field values.
52105>>>>>
52105>>>>>    Procedure Field_Defaults
52106>>>>>        Forward Send Field_Defaults
52108>>>>>        //DDB-Generated-Code-Location
52108>>>>>        //DDB-FieldDefaultStart
52108>>>>>        //DDB-FieldDefaultEnd
52108>>>>>    End_Procedure    // Field_Defaults
52109>>>>>
52109>>>>>End_Class    // Psxetika_DataDictionary
52110>>>>>//DDB-FileEnd
52110>>>
52110>>>    //AB-IgnoreEnd
52110>>>
52110>>>    Object bpMakeSx is a BusinessProcessSub
52112>>>
52112>>>        //AB-StoreTopStart
52112>>>
52112>>>        Property String     psParticleRecr  Public ''
52114>>>        Property String     psSxPartlRecr   Public ''
52116>>>        Property Integer    piLathos        Public  0
52118>>>        Property Number     pnQty           Public  0
52120>>>
52120>>>        Set Status_Panel_State to False
52121>>>        //Set Allow_Cancel_State  to True
52121>>>        Set Display_Error_State to True
52122>>>        //Set Process_Title to "               "
52122>>>        //Set Status_Log_id to (status_log(Self)) //Use statlog.pkg
52122>>>        //Set Status_log_state to True
52122>>>
52122>>>        Use MyArray.dg
INCLUDING FILE: MYARRAY.DG
52122>>>>>//AB/ Project MyArray
52122>>>>>//AB/     Object prj is a Dialog_Project
52122>>>>>//AB/         Set ProjectName to "MyArray"
52122>>>>>//AB/         Set ProjectFileName to "MyArray.DG"
52122>>>>>//AB/         Set GenerateFileName to "NONAME"
52122>>>>>
52122>>>>>// Project Object Structure
52122>>>>>//   Psx_Array is a BusinessProcessSub
52122>>>>>//     Ctypkin_DD2 is a Ctypkin_DataDictionary
52122>>>>>//     Wtypkin_DD2 is a Wtypkin_DataDictionary
52122>>>>>//     Ptyppar_DD2 is a Ptyppar_DataDictionary
52122>>>>>//     Country_DD2 is a Country_DataDictionary
52122>>>>>//     Towns_DD2 is a Towns_DataDictionary
52122>>>>>//     Cities_DD2 is a Cities_DataDictionary
52122>>>>>//     Areas_DD2 is a Areas_DataDictionary
52122>>>>>//     Payresp_DD2 is a Payresp_DataDictionary
52122>>>>>//     Clients_DD2 is a Clients_DataDictionary
52122>>>>>//     Nomisma_DD2 is a Nomisma_DataDictionary
52122>>>>>//     Particle_DD2 is a Particle_DataDictionary
52122>>>>>//     Ctypkin_DD is a Ctypkin_DataDictionary
52122>>>>>//     Wtypkin_DD is a Wtypkin_DataDictionary
52122>>>>>//     Ptyppar_DD is a Ptyppar_DataDictionary
52122>>>>>//     Country_DD is a Country_DataDictionary
52122>>>>>//     Towns_DD is a Towns_DataDictionary
52122>>>>>//     Cities_DD is a Cities_DataDictionary
52122>>>>>//     Areas_DD is a Areas_DataDictionary
52122>>>>>//     Payresp_DD is a Payresp_DataDictionary
52122>>>>>//     Clients_DD is a Clients_DataDictionary
52122>>>>>//     Nomisma_DD is a Nomisma_DataDictionary
52122>>>>>//     Particle_DD is a Particle_DataDictionary
52122>>>>>//     Psxetika_DD is a Psxetika_DataDictionary
52122>>>>>
52122>>>>>// Register all objects
52122>>>>>Register_Object Areas_DD
52122>>>>>Register_Object Areas_DD2
52122>>>>>Register_Object Cities_DD
52122>>>>>Register_Object Cities_DD2
52122>>>>>Register_Object Clients_DD
52122>>>>>Register_Object Clients_DD2
52122>>>>>Register_Object Country_DD
52122>>>>>Register_Object Country_DD2
52122>>>>>Register_Object Ctypkin_DD
52122>>>>>Register_Object Ctypkin_DD2
52122>>>>>Register_Object Nomisma_DD
52122>>>>>Register_Object Nomisma_DD2
52122>>>>>Register_Object Particle_DD
52122>>>>>Register_Object Particle_DD2
52122>>>>>Register_Object Payresp_DD
52122>>>>>Register_Object Payresp_DD2
52122>>>>>Register_Object Psx_Array
52122>>>>>Register_Object Psxetika_DD
52122>>>>>Register_Object Ptyppar_DD
52122>>>>>Register_Object Ptyppar_DD2
52122>>>>>Register_Object Towns_DD
52122>>>>>Register_Object Towns_DD2
52122>>>>>Register_Object Wtypkin_DD
52122>>>>>Register_Object Wtypkin_DD2
52122>>>>>
52122>>>>>
52122>>>>>
52122>>>>>    //AB-StoreTopStart
52122>>>>>
52122>>>>>    Use CTYPKIN.DD
52122>>>>>    Use WTYPKIN.DD
52122>>>>>    Use PTYPPAR.DD
52122>>>>>    Use PSEIRA.DD
52122>>>>>    Use NOMISMA.DD
52122>>>>>    Use COUNTRY.DD
52122>>>>>    Use TOWNS.DD
52122>>>>>    Use CITIES.DD
52122>>>>>    Use PAYRESP.DD
52122>>>>>    Use AREAS.DD
52122>>>>>    Use CLIENTS.DD
52122>>>>>    Use PARTICLE.DD
52122>>>>>    Use WAPOKAT.DD
52122>>>>>    Use WAPOMAST.DD
52122>>>>>    Use WAX.DD
52122>>>>>    Use UNITS.DD
52122>>>>>    Use WITEMKAT.DD
52122>>>>>    Use FPA.DD
52122>>>>>    Use ITEM.DD
52122>>>>>    Use WITEMX.DD
52122>>>>>    Use PMOVES.DD
INCLUDING FILE: PMOVES.DD
52122>>>>>>>//DDB-FileStart
52122>>>>>>>//DDB-HeaderStart
52122>>>>>>>
52122>>>>>>>// File Name : PMOVES.DD
52122>>>>>>>// Class Name: Pmoves_DataDictionary
52122>>>>>>>// Revision  : 162
52122>>>>>>>// Version   : 2
52122>>>>>>>
52122>>>>>>>Use  Windows           // Basic Definitions
52122>>>>>>>Use  DataDict          // DataDictionary Class Definition
52122>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
52122>>>>>>>
52122>>>>>>>Open Pmoves
52124>>>>>>>Open Pmsdtl
INCLUDING FILE: PMSDTL.FD
52126>>>>>>>Open Wax
52128>>>>>>>Open Witemx
52130>>>>>>>Open Particle
52132>>>>>>>Open Sysrecp
52134>>>>>>>Open Syscurxr
52136>>>>>>>Open Partlfpa
52138>>>>>>>Open Clorder
52140>>>>>>>Open Clorderd
52142>>>>>>>Open Btnemp
INCLUDING FILE: BTNEMP.FD
52144>>>>>>>Open Gmove
52146>>>>>>>Open Sysrecg
52148>>>>>>>
52148>>>>>>>//DDB-HeaderEnd
52148>>>>>>>Open Fpa
52150>>>>>>>Open PartlFpa
52152>>>>>>>Open Item
52154>>>>>>>Open Wtypkin
52156>>>>>>>Open Witemkat
52158>>>>>>>Open Wapomast
52160>>>>>>>Open Wapokat
52162>>>>>>>Open Payresp
52164>>>>>>>
52164>>>>>>>Class Pmoves_DataDictionary  is a DataDictionary_Sec
52165>>>>>>>
52165>>>>>>>
52165>>>>>>>    Procedure Construct_Object
52166>>>>>>>        Forward Send Construct_Object
52168>>>>>>>        Property Number  pnoQty         Public  0
52169>>>>>>>        Property integer pifromclorder  Public  0
52170>>>>>>>        Property Integer piCheckZeroFpa Public  0
52171>>>>>>>        Property Integer piPmsSxetID    Public  0
52172>>>>>>>        Property integer piFromMetasx   Public  0
52173>>>>>>>        Property String  psOldItem      Public ''
52174>>>>>>>        //------------------------------------------------
52174>>>>>>>        // Properties gia na kraththoun oi palies times
52174>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio
52174>>>>>>>        // einai 1     js 03/12/2007
52174>>>>>>>        //------------------------------------------------
52174>>>>>>>        Property Integer piCreateNew            Public  0
52175>>>>>>>        Property String  psAud_Old_Pelaths      Public ""
52176>>>>>>>        Property String  psAud_Old_PelathsN     Public ""
52177>>>>>>>        Property String  psAud_Old_Ergo         Public ""
52178>>>>>>>        Property String  psAud_Old_Poiothta     Public ""
52179>>>>>>>        Property String  psAud_Old_Eidos        Public ""
52180>>>>>>>
52180>>>>>>>        Property String  psAud_Old_Zonh         Public ""
52181>>>>>>>        Property String  psAud_Old_Antlia       Public ""
52182>>>>>>>        Property String  psAud_Old_Oxhma        Public ""
52183>>>>>>>
52183>>>>>>>        Property Number  pnAud_Old_Qty          Public  0
52184>>>>>>>        Property Number  pnAud_Old_Timh         Public  0
52185>>>>>>>        Property String  psAud_Old_PartlRecr    Public ""
52186>>>>>>>        Property String  psAud_Old_PmsRecr      Public ""
52187>>>>>>>        Property String  psAud_Old_Module       Public ""
52188>>>>>>>        Property String  psAud_Old_Parast       Public ""
52189>>>>>>>        Property String  psAud_Old_Seira        Public ""
52190>>>>>>>        Property Date    pdAud_Old_Hmnia        Public ""
52191>>>>>>>        Property Integer piAud_Old_No           Public  0
52192>>>>>>>        //------------------------------------------------
52192>>>>>>>    End_Procedure
52193>>>>>>>
52193>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
52194>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
52196>>>>>>>        Set pnoQty      to Pmoves.Pms_Qty
52197>>>>>>>        Set psOldItem   to Item.Item_Code
52198>>>>>>>        //------------------------------------------------
52198>>>>>>>        // Properties gia na kraththoun oi palies times
52198>>>>>>>        // ton pedion js 03/12/2007
52198>>>>>>>        //------------------------------------------------
52198>>>>>>>        Set psAud_Old_Pelaths       to Pmoves.Client_ID
52199>>>>>>>        Set psAud_Old_PelathsN      to Clients.Client_Name
52200>>>>>>>        Set psAud_Old_Ergo          to Pmoves.CN_Code
52201>>>>>>>        Set psAud_Old_Eidos         to Pmoves.Witemx_Code
52202>>>>>>>        Set psAud_Old_Poiothta      to Item.Item_Qual
52203>>>>>>>        Set pnAud_Old_Qty           to Pmoves.Pms_Qty
52204>>>>>>>        Set pnAud_Old_Timh          to Pmoves.Pms_UnitPrice
52205>>>>>>>        Set psAud_Old_PartlRecr     to Pmoves.Partl_Recr
52206>>>>>>>        Set psAud_Old_PmsRecr       to Pmoves.Pms_Recr
52207>>>>>>>        Set psAud_Old_Module        to Particle.Partl_Module
52208>>>>>>>        Set psAud_Old_Zonh          to Pmoves.Zone
52209>>>>>>>        Set psAud_Old_Antlia        to Pmoves.Pump_ID
52210>>>>>>>        Set psAud_Old_Oxhma         to Pmoves.Car_ID
52211>>>>>>>        Set psAud_Old_Parast        to Ptyppar.Ptyppar_Code
52212>>>>>>>        Set psAud_Old_Seira         to Particle.Pseira_Seira
52213>>>>>>>        Set pdAud_Old_Hmnia         to Particle.Partl_Hmnia
52214>>>>>>>        Set piAud_Old_No            to Particle.Partl_No
52215>>>>>>>        //------------------------------------------------
52215>>>>>>>    End_Procedure   // New_Current_Record
52216>>>>>>>
52216>>>>>>>
52216>>>>>>>    // Delete_Main_File:
52216>>>>>>>    Procedure Delete_Main_File
52217>>>>>>>        clear btnemp
52218>>>>>>>        move pmoves.pms_recr to btnemp.pms_recr
52219>>>>>>>        find ge btnemp by index.11
52220>>>>>>>>
52220>>>>>>>        if ((found=1) and (pmoves.pms_recr=btnemp.pms_recr)) begin
52222>>>>>>>           move 0 to btnemp.pms_recr
52223>>>>>>>           saverecord btnemp
52224>>>>>>>        end
52224>>>>>>>>
52224>>>>>>>
52224>>>>>>>        //---------------------------------------------
52224>>>>>>>        // Auditing / Katagrafh allagon
52224>>>>>>>        //OPERATION_MODE       OPERATION_ORIGIN
52224>>>>>>>            //MODE_WAITING
52224>>>>>>>            //MODE_FINDING
52224>>>>>>>            //MODE_CLEARING
52224>>>>>>>            //MODE_CREATING
52224>>>>>>>            //MODE_SAVING
52224>>>>>>>            //MODE_DELETING
52224>>>>>>>            //MODE_ABORTING
52224>>>>>>>        String  sUser sText sTime sMin sHour sSec
52225>>>>>>>        Date    dDate  Shmer
52225>>>>>>>        Integer iMin iHour iSec iLen
52225>>>>>>>        Sysdate dDate iHour iMin iSec
52229>>>>>>>        Move iHour  to sHour
52230>>>>>>>        Move iMin   to sMin
52231>>>>>>>        Move iSec   to sSec
52232>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
52236>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
52240>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
52244>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
52245>>>>>>>
52245>>>>>>>        // Auditing / Diagrafh - Diorthosh
52245>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING)) Begin
52247>>>>>>>            Get fsLoginUserID to sUser
52248>>>>>>>
52248>>>>>>>            clear gmove
52249>>>>>>>            move syscurxr.company_code  to gmove.company_code
52250>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
52251>>>>>>>            move syscurxr.year_year     to gmove.year_year
52252>>>>>>>            move  1                     to gmove.gtypkin_code// Apo Parastatika
52253>>>>>>>            move ddate                  to gmove.garticl_hmnia
52254>>>>>>>            move pmoves.partl_no        to gmove.garticl_no
52255>>>>>>>            move Particle.CN_Code       to gmove.gplan_recr
52256>>>>>>>            move suser                  to gmove.gplan_code
52257>>>>>>>            move pmoves.pms_recr        to gmove.garticl_recr
52258>>>>>>>            reread sysrecg
52262>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
52263>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
52264>>>>>>>            saverecord sysrecg
52265>>>>>>>            unlock
52266>>>>>>>>
52266>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                        to Gmove.Gmove_Recr
52267>>>>>>>
52267>>>>>>>            Move (psAud_Old_Module(Self))       to Gmove.Module
52268>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
52269>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs
52270>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
52271>>>>>>>            Move (psAud_Old_Pelaths (Self))     to Gmove.Prev_ID
52272>>>>>>>            Move (psAud_Old_PelathsN(Self))     to Gmove.Prev_Name
52273>>>>>>>            Move (psAud_Old_Ergo     (Self))    to Gmove.Prev_CN
52274>>>>>>>            Move (psAud_Old_Eidos    (Self))    to Gmove.Prev_Item
52275>>>>>>>            Move (psAud_Old_Poiothta (Self))    to Gmove.Prev_Qual
52276>>>>>>>            Move (pnAud_Old_Qty      (Self))    to Gmove.Prev_M3
52277>>>>>>>            Move (pnAud_Old_Timh     (Self))    to Gmove.Prev_UnitPrice
52278>>>>>>>            Move (psAud_Old_PartlRecr(Self))    to Gmove.Partl_Recr
52279>>>>>>>            Move (psAud_Old_PmsRecr  (Self))    to Gmove.Pms_Recr
52280>>>>>>>            Move (psAud_Old_Zonh     (Self))    to Gmove.Prev_Zonh
52281>>>>>>>            Move (psAud_Old_Antlia   (Self))    to Gmove.Prev_Antlia
52282>>>>>>>            Move (psAud_Old_Oxhma    (Self))    to Gmove.Prev_Oxhma
52283>>>>>>>            Move (psAud_Old_Parast   (Self))    to Gmove.Prev_Parast
52284>>>>>>>            Move (psAud_Old_Seira    (Self))    to Gmove.Prev_Seira
52285>>>>>>>            Move (pdAud_Old_Hmnia    (Self))    to Gmove.Prev_Hmnia
52286>>>>>>>            Move (piAud_Old_No       (Self))    to Gmove.Prev_No
52287>>>>>>>            Move "ƒ ˜š¨˜­ã š¨˜££ãª  ˜¨˜©«˜« ¡¦ç)" to sText
52288>>>>>>>            Move "D" to Gmove.Eidos_Metabolhs
52289>>>>>>>            move (trim(stext))          to gmove.gmove_aitiol
52290>>>>>>>            Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                to Gmove.Txt1
52291>>>>>>>            saverecord gmove
52292>>>>>>>        End
52292>>>>>>>>
52292>>>>>>>
52292>>>>>>>        Forward Send Delete_Main_File
52294>>>>>>>        // Insert Code Here
52294>>>>>>>    End_Procedure   // Delete_Main_File
52295>>>>>>>
52295>>>>>>>
52295>>>>>>>    Procedure Save_Main_File
52296>>>>>>>        Integer iYes
52297>>>>>>>        If (Operation_Origin<>Self) Begin
52299>>>>>>>            If Pmoves.Recnum Eq 0 Procedure_Return
52302>>>>>>>        End
52302>>>>>>>>
52302>>>>>>>
52302>>>>>>>        If ((Operation_Origin=Self) And (piCheckZeroFpa(Self))) Begin
52304>>>>>>>            // Elegxos FPA
52304>>>>>>>            // An typonei otidhpote ektos apo 1 (mono Posothtes)
52304>>>>>>>            If ((Ptyppar.Ti_Typonei_Pms<>'1')   And ;                (Pmoves.Pms_Vatam=0)            And ;                (Operation_Mode<>MODE_DELETING)) Begin
52306>>>>>>>                Move (YesNo_Box("¦©æ ”€ £ž›œ¤ ¡æ. Œ˜ ©¬¤œ®å©à ;", ;                                     "¨¦©¦®ã",  MB_DEFBUTTON2) ) to iYes
52307>>>>>>>                If (iYes=MBR_NO)  Send Operation_Not_Allowed 8000
52310>>>>>>>            End
52310>>>>>>>>
52310>>>>>>>        End
52310>>>>>>>>
52310>>>>>>>        Forward Send Save_Main_File
52312>>>>>>>    End_Procedure
52313>>>>>>>
52313>>>>>>>    Function fnTeleytaiaTimh Returns Number
52314>>>>>>>        Number  rVal nQty
52315>>>>>>>        String  sClientID sWitemxCode
52315>>>>>>>        Date    dHmnia
52315>>>>>>>        String  sWhat sRecr sClientCode sItemCode sCN
52315>>>>>>>
52315>>>>>>>        Get File_Field_Current_Value File_Field Ptyppar.Ptyppar_Is_What to sWhat
52316>>>>>>>        If (Trim(sWhat)='1') Begin
52318>>>>>>>            // 1=€š¦¨œª
52318>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Recr      to sRecr
52319>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Qty          to nQty
52320>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Hmnia    to dHmnia
52321>>>>>>>            Get File_Field_Current_Value File_Field Item.Item_Code          to sItemCode
52322>>>>>>>            Get File_Field_Current_Value File_Field Clients.Client_ID       to sClientCode
52323>>>>>>>            // Sto arxeio Globals.inc
52323>>>>>>>            Get fnTeleytaiaTimhAgoras sClientCode sItemCode dHmnia nQty to rVal
52324>>>>>>>        End
52324>>>>>>>>
52324>>>>>>>        Else If (Trim(sWhat)='2') Begin
52327>>>>>>>            // 2=à¢ã©œ ª
52327>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Qty          to nQty
52328>>>>>>>            Get File_Field_Current_Value File_Field Item.Item_Code          to sItemCode
52329>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Hmnia    to dHmnia
52330>>>>>>>            Get File_Field_Current_Value File_Field Particle.Cn_Code        to sCN
52331>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Recr      to sRecr
52332>>>>>>>            Get File_Field_Current_Value File_Field Clients.Client_ID       to sClientID
52333>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Code      to sWitemxCode
52334>>>>>>>            // Sto arxeio Globals.inc
52334>>>>>>>            Get fnTeleytaiaTimhPolhshs sRecr sClientID sWitemxCode dHmnia sItemCode nQty sCN to rVal
52335>>>>>>>        End
52335>>>>>>>>
52335>>>>>>>        Function_Return rVal
52336>>>>>>>    End_Function
52337>>>>>>>
52337>>>>>>>    Procedure Creating
52338>>>>>>>        Forward Send Creating
52340>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Pmoves.Pms_Rec0)))))) to Pmoves.Pms_Recr
52341>>>>>>>        Set piCreateNew to 1
52342>>>>>>>    End_Procedure   // Creating
52343>>>>>>>
52343>>>>>>>    Procedure Update
52344>>>>>>>        Integer iDecimals
52345>>>>>>>        Number  nInt nFpaOnTotal
52345>>>>>>>        String  sCurrentUser
52345>>>>>>>
52345>>>>>>>        Forward Send Update
52347>>>>>>>
52347>>>>>>>        Move SysCurXR.Company_Code                          to Pmoves.Company_Code
52348>>>>>>>        Move SysCurXR.Branch_Code                           to Pmoves.Branch_Code
52349>>>>>>>        Move SysCurXR.Year_Year                             to Pmoves.Year_Year
52350>>>>>>>        Move Ctypkin.Ctypkin_Code                           to Pmoves.Ctypkin_Code
52351>>>>>>>        Move Wtypkin.Wtypkin_Code                           to Pmoves.Wtypkin_Code
52352>>>>>>>
52352>>>>>>>        Move Witemkat.Witemkat_Code                         to Pmoves.Witemkat_Code
52353>>>>>>>        Move Item.Item_Code                                 to Pmoves.Item_Code
52354>>>>>>>        Move Witemx.Witemx_Code                             to Pmoves.Witemx_Code
52355>>>>>>>        Move Wapokat.Wapokat_Code                           to Pmoves.Wapokat_Code
52356>>>>>>>        Move Wapomast.Wapomast_Code                         to Pmoves.Wapomast_Code
52357>>>>>>>        Move Wax.Wax_Code                                   to Pmoves.Wax_Code
52358>>>>>>>
52358>>>>>>>        //Move Custprom.Custprom_Code                         to Pmoves.Custprom_Code
52358>>>>>>>        Move Clients.Client_ID                              to Pmoves.Client_ID
52359>>>>>>>        Move Ptyppar.Ptyppar_Code                           to Pmoves.Ptyppar_Code
52360>>>>>>>        Move Ptyppar.TI_TYPONEI_PMS                         to Pmoves.TI_TYPONEI_PMS
52361>>>>>>>        Move Particle.PSeira_Seira                          to Pmoves.Pseira_Seira
52362>>>>>>>
52362>>>>>>>        Move Nomisma.Nomisma_Code                           to Pmoves.Pms_Sc_Code2
52363>>>>>>>        Move Nomisma.Dekadika                               To iDecimals
52364>>>>>>>
52364>>>>>>>
52364>>>>>>>        Move Particle.Partl_No                              to Pmoves.Partl_No
52365>>>>>>>        Move Particle.Partl_Hmnia                           to Pmoves.Partl_Hmnia
52366>>>>>>>        Move Particle.Partl_Module                          to Pmoves.Pms_Module
52367>>>>>>>        Move Particle.Partl_Rec0                            to Pmoves.Partl_Rec0
52368>>>>>>>        Move Particle.Presp_ID                              to Pmoves.Presp_ID
52369>>>>>>>        if (particle.partl_euro<>1) begin
52371>>>>>>>            Move Particle.CN_Code                           to Pmoves.CN_Code
52372>>>>>>>            Move Particle.Sls_ID                            to Pmoves.Sls_ID
52373>>>>>>>
52373>>>>>>>            Move Particle.Cnt_ID                            to Pmoves.Cnt_ID
52374>>>>>>>        end
52374>>>>>>>>
52374>>>>>>>        Move Item.Units_Code                                to Pmoves.Pms_UnitCode
52375>>>>>>>        move witemx.witemx_descr                            to pmoves.witemx_descr
52376>>>>>>>        move ptyppar.ptyppar_descr                          to pmoves.ptyppar_descr
52377>>>>>>>        move clients.client_name                            to pmoves.client_name
52378>>>>>>>
52378>>>>>>>        if (Trim(pmoves.pump_id)='') ;            move particle.antlia_code                       to pmoves.pump_id
52381>>>>>>>        If (Trim(pmoves.car_id)='') ;            move particle.oxhma_code                        to pmoves.car_id
52384>>>>>>>        If (Trim(pmoves.zone)='') ;            move particle.zone_id                           to pmoves.zone
52387>>>>>>>
52387>>>>>>>      //  if (particle.zone_id='') move pmoves.zone           to particle.zone_id
52387>>>>>>>      //  else move particle.Zone_ID                          to pmoves.Zone
52387>>>>>>>
52387>>>>>>>//        Move (Pmoves.Pms_Qty-Pmoves.Timol_Qty)              to Pmoves.Timol_Ypol
52387>>>>>>>
52387>>>>>>>        Move (Pmoves.Qty_Kinhshs>0)                         to Pmoves.pms_Selected
52388>>>>>>>
52388>>>>>>>        Move (Round_Number((Pmoves.Pms_Qty*Pmoves.Pms_UnitPrice),iDecimals))    ;                                                            to Pmoves.Pms_Ambd
52389>>>>>>>
52389>>>>>>>        If (Pmoves.Pms_PctDisc<>0) ;            Move (Round_Number((Pmoves.Pms_Ambd*Pmoves.Pms_PctDisc/100),iDecimals)) ;                                                            to Pmoves.Pms_Discam
52392>>>>>>>        Else ;            Move (Round_Number( ((Pmoves.Pms_Discam/Pmoves.Pms_Ambd)*100),iDecimals)) ;                                                            to Pmoves.Pms_PctDisc
52394>>>>>>>
52394>>>>>>>        Move (Pmoves.Pms_Ambd-Pmoves.Pms_Discam)            to Pmoves.Pms_Amaftdisc
52395>>>>>>>
52395>>>>>>>        Move (Round_Number((Pmoves.Pms_Amaftdisc*Pmoves.Pms_Vatpct/100),iDecimals));                                                            to Pmoves.Pms_Vatam
52396>>>>>>>        Move (Pmoves.Pms_Amaftdisc+Pmoves.Pms_Vatam)        to Pmoves.Pms_Payable
52397>>>>>>>        Move Pmoves.Pms_Payable                             to Pmoves.Pms_Axia
52398>>>>>>>
52398>>>>>>>        Add Pmoves.Pms_Qty                                  to Particle.Partl_TotTem
52399>>>>>>>//        Add Pmoves.Timol_Qty                                to Particle.Timol_Qty
52399>>>>>>>
52399>>>>>>>        Add Pmoves.Pms_Ambd                                 to Particle.Partl_TotAmBD
52400>>>>>>>        Add Pmoves.Pms_DiscAm                               to Particle.Partl_AMDISCPMS
52401>>>>>>>        Add Pmoves.Pms_Amaftdisc                            to Particle.Partl_TotAmAd
52402>>>>>>>        Add 1                                               to Particle.Partl_NoOfLines
52403>>>>>>>
52403>>>>>>>        // An einai parastatiko polhshs kai to ptyppar einai flagarismeno oti
52403>>>>>>>        // prepei na enhmerosh to pedio Clients.Posa_apo_dap
52403>>>>>>>        // tote theoroume oti ypoxreotika prepei na vroume timh apo
52403>>>>>>>        // function timokatalogon kai na thn krathsoume sto pedio
52403>>>>>>>        // Pmoves.Posa_apo_dap
52403>>>>>>>        If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
52405>>>>>>>            // An to pedio Particle.Partl_Vsn einai 0 tote shmainei
52405>>>>>>>            // oti den einai parastatiko metasxhmatismeno (px D.AP) ara
52405>>>>>>>            // h update prepei na prosthesei sto antistoixo pedio client
52405>>>>>>>            // An omos einai metasxhmatismeno (px apo D.AP tora einai
52405>>>>>>>            // Timologio) tote  prepei h update na afairesei apo to pedio
52405>>>>>>>            // tou client dioti to arxiko D.AP eixe prosthesei.
52405>>>>>>>
52405>>>>>>>            Move (Round_Number(Pmoves.Pms_Payable,2)) to Pmoves.Posa_Apo_Dap
52406>>>>>>>
52406>>>>>>>            If (Particle.Partl_Vsn=0) Begin
52408>>>>>>>                Add Pmoves.Posa_Apo_Dap to Clients.Posa_Apo_Dap
52409>>>>>>>                Add Pmoves.Posa_Apo_Dap to Payresp.Posa_Apo_Dap
52410>>>>>>>            End
52410>>>>>>>>
52410>>>>>>>            Else Begin
52411>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Clients.Posa_Apo_Dap
52412>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Payresp.Posa_Apo_Dap
52413>>>>>>>            End
52413>>>>>>>>
52413>>>>>>>        End
52413>>>>>>>>
52413>>>>>>>
52413>>>>>>>        //Add Pmoves.Qty_Kinhshs  to Particle.Partl_Disctof
52413>>>>>>>
52413>>>>>>>
52413>>>>>>>        ////////////////////////////////////////////////////////////////////////
52413>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
52413>>>>>>>        ////////////////////////////////////////////////////////////////////////
52413>>>>>>>        Add Pmoves.Pms_Vatam            to Particle.Partl_Vatam
52414>>>>>>>
52414>>>>>>>        Clear PartlFpa
52415>>>>>>>        Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
52416>>>>>>>        Move Pmoves.Pms_VatPct          to PartlFpa.Fpa_Pososto
52417>>>>>>>        Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
52418>>>>>>>>
52418>>>>>>>        Add Pmoves.Pms_Vatam            to PartlFpa.PartlFpa_Poso
52419>>>>>>>        Add Pmoves.Pms_Amaftdisc        to PartlFpa.Poso_Pro_Fpa
52420>>>>>>>        Saverecord PartlFpa
52421>>>>>>>
52421>>>>>>>        Move 0 to nFpaOnTotal
52422>>>>>>>        Clear PartlFpa
52423>>>>>>>        Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
52424>>>>>>>        Find Gt PartlFpa By Index.1
52425>>>>>>>>
52425>>>>>>>        While ((Found=1) And (PartlFpa.Partl_Recr=Particle.Partl_Recr))
52429>>>>>>>            Move (Round_Number(((PartlFpa.Fpa_Pososto*PartlFpa.Poso_Pro_Fpa)/100),2)) to PartlFpa.POSO_FPA
52430>>>>>>>            Move (PartlFpa.Poso_Pro_Fpa+PartlFpa.POSO_FPA) to PartlFpa.POSO_ME_FPA
52431>>>>>>>            Saverecord PartlFpa
52432>>>>>>>            Add PartlFpa.POSO_FPA to nFpaOnTotal
52433>>>>>>>            Find Gt PartlFpa By Index.1
52434>>>>>>>>
52434>>>>>>>        Loop
52435>>>>>>>>
52435>>>>>>>
52435>>>>>>>        Move nFpaOnTotal to Particle.Fpa_On_Total
52436>>>>>>>
52436>>>>>>>
52436>>>>>>>        //---------------------------------------------
52436>>>>>>>        // Auditing / Katagrafh allagon
52436>>>>>>>        //OPERATION_MODE       OPERATION_ORIGIN
52436>>>>>>>            //MODE_WAITING
52436>>>>>>>            //MODE_FINDING
52436>>>>>>>            //MODE_CLEARING
52436>>>>>>>            //MODE_CREATING
52436>>>>>>>            //MODE_SAVING
52436>>>>>>>            //MODE_DELETING
52436>>>>>>>            //MODE_ABORTING
52436>>>>>>>        String  sUser sText sTime sMin sHour sSec
52436>>>>>>>        Date    dDate  Shmer
52436>>>>>>>        Integer iMin iHour iSec iLen
52436>>>>>>>        Sysdate dDate iHour iMin iSec
52440>>>>>>>        Move iHour  to sHour
52441>>>>>>>        Move iMin   to sMin
52442>>>>>>>        Move iSec   to sSec
52443>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
52447>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
52451>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
52455>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
52456>>>>>>>
52456>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
52456>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
52458>>>>>>>            Get fsLoginUserID to sUser
52459>>>>>>>            If (piCreateNew(Self)=1) Begin
52461>>>>>>>                clear gmove
52462>>>>>>>                move syscurxr.company_code  to gmove.company_code
52463>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
52464>>>>>>>                move syscurxr.year_year     to gmove.year_year
52465>>>>>>>                move  1                     to gmove.gtypkin_code// Apo Parastatika
52466>>>>>>>                move ddate                  to gmove.garticl_hmnia
52467>>>>>>>                move pmoves.partl_no        to gmove.garticl_no
52468>>>>>>>                move Particle.CN_Code       to gmove.gplan_recr
52469>>>>>>>                move suser                  to gmove.gplan_code
52470>>>>>>>                move pmoves.pms_recr        to gmove.garticl_recr
52471>>>>>>>                reread sysrecg
52475>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
52476>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
52477>>>>>>>                saverecord sysrecg
52478>>>>>>>                unlock
52479>>>>>>>>
52479>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                            to Gmove.Gmove_Recr
52480>>>>>>>                Move Particle.Partl_Module          to Gmove.Module
52481>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
52482>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs
52483>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
52484>>>>>>>                Move Clients.Client_ID              to Gmove.Cur_ID
52485>>>>>>>                Move Clients.CLient_Name            to Gmove.Cur_Name
52486>>>>>>>                Move Particle.CN_Code               to Gmove.Cur_CN
52487>>>>>>>                Move Item.Item_Code                 to Gmove.Cur_Item
52488>>>>>>>                Move Item.Item_Qual                 to Gmove.Cur_Qual
52489>>>>>>>                Move Pmoves.Pms_Qty                 to Gmove.Cur_M3
52490>>>>>>>                Move Pmoves.Pms_UnitPrice           to Gmove.Cur_UnitPrice
52491>>>>>>>                Move Particle.Partl_Recr            to Gmove.Partl_Recr
52492>>>>>>>                Move Pmoves.Pms_Recr                to Gmove.Pms_Recr
52493>>>>>>>
52493>>>>>>>                Move Pmoves.Zone                    to Gmove.Cur_Zonh
52494>>>>>>>                Move Pmoves.Pump_ID                 to Gmove.Cur_Antlia
52495>>>>>>>                Move Pmoves.Car_ID                  to Gmove.Cur_Oxhma
52496>>>>>>>
52496>>>>>>>                Move Ptyppar.Ptyppar_Code           to Gmove.Cur_Parast
52497>>>>>>>                Move Particle.Pseira_Seira          to Gmove.Cur_Seira
52498>>>>>>>                Move Particle.Partl_Hmnia           to Gmove.Cur_Hmnia
52499>>>>>>>                Move "ƒž£ ¦¬¨šå˜ š¨˜££ãª §˜¨˜©«˜« ¡¦ç)" to sText
52500>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs
52501>>>>>>>                move (trim(stext))          to gmove.gmove_aitiol
52502>>>>>>>                Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                    to Gmove.Txt1
52503>>>>>>>                saverecord gmove
52504>>>>>>>                Set piCreateNew to 0
52505>>>>>>>            End
52505>>>>>>>>
52505>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1)) Begin
52508>>>>>>>                Integer isChanged
52508>>>>>>>                Move 0 to isChanged
52509>>>>>>>
52509>>>>>>>                     If ((Trim(psAud_Old_Pelaths(Self))<>Trim(Clients.Client_ID    ))   Or  (Trim(psAud_Old_Ergo    (Self))<>Trim(Pmoves.CN_Code      ))) Move 1 to isChanged
52512>>>>>>>                Else If ((Trim(psAud_Old_Eidos  (Self))<>Trim(Item.Item_Code       ))   Or  (Trim(psAud_Old_Poiothta(Self))<>Trim(Item.Item_Qual      ))) Move 1 to isChanged
52516>>>>>>>                Else If ((pnAud_Old_Qty         (Self) <>Pmoves.Pms_Qty             )   Or  (pnAud_Old_Timh         (Self) <>Pmoves.Pms_UnitPrice      )) Move 1 to isChanged
52520>>>>>>>                Else If ((Trim(psAud_Old_Zonh   (Self))<>Trim(Pmoves.Zone          ))   Or  (Trim(psAud_Old_Antlia  (Self))<>Trim(Pmoves.Pump_ID      ))) Move 1 to isChanged
52524>>>>>>>                Else If ((Trim(psAud_Old_Oxhma  (Self))<>Trim(Pmoves.Car_ID        ))   Or  (Trim(psAud_Old_Parast  (Self))<>Trim(Ptyppar.Ptyppar_Code))) Move 1 to isChanged
52528>>>>>>>                Else If ((Trim(psAud_Old_Seira  (Self))<>Trim(Particle.Pseira_Seira))   Or  (Trim(pdAud_Old_Hmnia   (Self))<>Particle.Partl_Hmnia      )) Move 1 to isChanged
52532>>>>>>>                Else If  (piAud_Old_No          (Self) <>Particle.Partl_No)                                                                               Move 1 to isChanged
52536>>>>>>>
52536>>>>>>>                If (isChanged>0) Begin
52538>>>>>>>                    clear gmove
52539>>>>>>>                    move syscurxr.company_code  to gmove.company_code
52540>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
52541>>>>>>>                    move syscurxr.year_year     to gmove.year_year
52542>>>>>>>                    move  1                     to gmove.gtypkin_code// Apo Parastatika
52543>>>>>>>                    move ddate                  to gmove.garticl_hmnia
52544>>>>>>>                    move pmoves.partl_no        to gmove.garticl_no
52545>>>>>>>                    move Particle.CN_Code       to gmove.gplan_recr
52546>>>>>>>                    move suser                  to gmove.gplan_code
52547>>>>>>>                    move pmoves.pms_recr        to gmove.garticl_recr
52548>>>>>>>                    reread sysrecg
52552>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
52553>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
52554>>>>>>>                    saverecord sysrecg
52555>>>>>>>                    unlock
52556>>>>>>>>
52556>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
52557>>>>>>>                    Move Particle.Partl_Module          to Gmove.Module
52558>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
52559>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs
52560>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
52561>>>>>>>                    //--
52561>>>>>>>                    Move Particle.Partl_Recr            to Gmove.Partl_Recr
52562>>>>>>>                    Move Pmoves.Pms_Recr                to Gmove.Pms_Recr
52563>>>>>>>                    //--
52563>>>>>>>                    Move (Trim(Clients.Client_ID    ))  to Gmove.Cur_ID
52564>>>>>>>                    Move (Trim(Clients.CLient_Name  ))  to Gmove.Cur_Name
52565>>>>>>>                    Move (Trim(Particle.CN_Code     ))  to Gmove.Cur_CN
52566>>>>>>>                    Move (Trim(Item.Item_Code       ))  to Gmove.Cur_Item
52567>>>>>>>                    Move (Trim(Item.Item_Qual       ))  to Gmove.Cur_Qual
52568>>>>>>>                    Move       Pmoves.Pms_Qty           to Gmove.Cur_M3
52569>>>>>>>                    Move       Pmoves.Pms_UnitPrice     to Gmove.Cur_UnitPrice
52570>>>>>>>
52570>>>>>>>                    Move (Trim(Pmoves.Zone          ))  to Gmove.Cur_Zonh
52571>>>>>>>                    Move (Trim(Pmoves.Pump_ID       ))  to Gmove.Cur_Antlia
52572>>>>>>>                    Move (Trim(Pmoves.Car_ID        ))  to Gmove.Cur_Oxhma
52573>>>>>>>
52573>>>>>>>                    Move (Trim(Ptyppar.Ptyppar_Code ))  to Gmove.Cur_Parast
52574>>>>>>>                    Move (Trim(Particle.Pseira_Seira))  to Gmove.Cur_Seira
52575>>>>>>>                    Move       Particle.Partl_Hmnia     to Gmove.Cur_Hmnia
52576>>>>>>>                    Move       Particle.Partl_No        to Gmove.Cur_No
52577>>>>>>>                    //--
52577>>>>>>>                    Move (Trim(psAud_Old_Pelaths (Self))) to Gmove.Prev_ID
52578>>>>>>>                    Move (Trim(psAud_Old_PelathsN(Self))) to Gmove.Prev_Name
52579>>>>>>>                    Move (Trim(psAud_Old_Ergo    (Self))) to Gmove.Prev_CN
52580>>>>>>>                    Move (Trim(psAud_Old_Eidos   (Self))) to Gmove.Prev_Item
52581>>>>>>>                    Move (Trim(psAud_Old_Poiothta(Self))) to Gmove.Prev_Qual
52582>>>>>>>                    Move      (pnAud_Old_Qty     (Self )) to Gmove.Prev_M3
52583>>>>>>>                    Move      (pnAud_Old_Timh    (Self )) to Gmove.Prev_UnitPrice
52584>>>>>>>                    Move (Trim(psAud_Old_Zonh    (Self))) to Gmove.Prev_Zonh
52585>>>>>>>                    Move (Trim(psAud_Old_Antlia  (Self))) to Gmove.Prev_Antlia
52586>>>>>>>                    Move (Trim(psAud_Old_Oxhma   (Self))) to Gmove.Prev_Oxhma
52587>>>>>>>                    Move (Trim(psAud_Old_Parast  (Self))) to Gmove.Prev_Parast
52588>>>>>>>                    Move (Trim(psAud_Old_Seira   (Self))) to Gmove.Prev_Seira
52589>>>>>>>                    Move      (pdAud_Old_Hmnia   (Self )) to Gmove.Prev_Hmnia
52590>>>>>>>                    Move      (piAud_Old_No      (Self )) to Gmove.Prev_No
52591>>>>>>>                    //--
52591>>>>>>>                    Move "ƒ æ¨Ÿà©ž š¨˜££ãª ˜¨˜©«˜« ¡¦ç)" to sText
52592>>>>>>>                    Move "E" to Gmove.Eidos_Metabolhs
52593>>>>>>>                    move (trim(stext))          to gmove.gmove_aitiol
52594>>>>>>>                    Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                        to Gmove.Txt1
52595>>>>>>>                    saverecord gmove
52596>>>>>>>                    Set piCreateNew to 0
52597>>>>>>>                End
52597>>>>>>>>
52597>>>>>>>            End
52597>>>>>>>>
52597>>>>>>>        End
52597>>>>>>>>
52597>>>>>>>    End_Procedure   // Update
52598>>>>>>>
52598>>>>>>>    // Backout:
52598>>>>>>>    Procedure Backout
52599>>>>>>>        Number nFpaOnTotal
52600>>>>>>>        Forward Send Backout
52602>>>>>>>
52602>>>>>>>        Sub Pmoves.Pms_Qty        From Particle.Partl_TotTem
52603>>>>>>>//        Sub Pmoves.Timol_Qty      From Particle.Timol_Qty
52603>>>>>>>        Sub Pmoves.Pms_Ambd       From Particle.Partl_TotAmBD
52604>>>>>>>        Sub Pmoves.Pms_DiscAm     From Particle.Partl_AMDISCPMS
52605>>>>>>>        Sub Pmoves.Pms_Amaftdisc  From Particle.Partl_TotAmAd
52606>>>>>>>        Sub 1                     From Particle.Partl_NoOfLines
52607>>>>>>>
52607>>>>>>>        // An einai parastatiko polhshs kai to ptyppar einai flagarismeno oti
52607>>>>>>>        // prepei na enhmerosh to pedio Clients.Posa_apo_dap
52607>>>>>>>        // tote theoroume oti ypoxreotika prepei na vroume timh sto pedio
52607>>>>>>>        // Pmoves.Posa_apo_dap
52607>>>>>>>        If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
52609>>>>>>>            // An to pedio Particle.Partl_Vsn einai 0 tote shmainei
52609>>>>>>>            // oti den einai parastatiko metasxhmatismeno (px D.AP) ara
52609>>>>>>>            // h backout prepei na afairesei apo antistoixo pedio client
52609>>>>>>>            // An omos einai metasxhmatismeno (px apo D.AP tora einai
52609>>>>>>>            // Timologio) tote  prepei h backout na prosthesi sto pedio
52609>>>>>>>            // tou client dioti to arxiko D.AP eixe afairethei.
52609>>>>>>>            If (Particle.Partl_Vsn=0) Begin
52611>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Clients.Posa_Apo_Dap
52612>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Payresp.Posa_Apo_Dap
52613>>>>>>>            End
52613>>>>>>>>
52613>>>>>>>            Else Begin
52614>>>>>>>                Add Pmoves.Posa_Apo_Dap to Clients.Posa_Apo_Dap
52615>>>>>>>                Add Pmoves.Posa_Apo_Dap to Payresp.Posa_Apo_Dap
52616>>>>>>>            End
52616>>>>>>>>
52616>>>>>>>        End
52616>>>>>>>>
52616>>>>>>>
52616>>>>>>>        //Sub Pmoves.Qty_Kinhshs From Particle.Partl_Disctof
52616>>>>>>>
52616>>>>>>>        ////////////////////////////////////////////////////////////////////////
52616>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
52616>>>>>>>        ////////////////////////////////////////////////////////////////////////
52616>>>>>>>        Sub Pmoves.Pms_Vatam      From Particle.Partl_Vatam
52617>>>>>>>
52617>>>>>>>        Clear PartlFpa
52618>>>>>>>        Move Particle.Partl_Recr    to PartlFpa.Partl_Recr
52619>>>>>>>        Move Pmoves.Pms_VatPct      to PartlFpa.Fpa_Pososto
52620>>>>>>>        Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
52621>>>>>>>>
52621>>>>>>>        Sub Pmoves.Pms_Vatam      From PartlFpa.PartlFpa_Poso
52622>>>>>>>        Sub Pmoves.Pms_Amaftdisc  From PartlFpa.Poso_Pro_Fpa
52623>>>>>>>        Saverecord PartlFpa
52624>>>>>>>
52624>>>>>>>        Move 0 to nFpaOnTotal
52625>>>>>>>        Clear PartlFpa
52626>>>>>>>        Move Particle.Partl_Recr  to PartlFpa.Partl_Recr
52627>>>>>>>        Find Gt PartlFpa By Index.1
52628>>>>>>>>
52628>>>>>>>        While ((Found=1) And (PartlFpa.Partl_Recr=Particle.Partl_Recr))
52632>>>>>>>            Move (Round_Number(((PartlFpa.Fpa_Pososto*PartlFpa.Poso_Pro_Fpa)/100),2)) to PartlFpa.POSO_FPA
52633>>>>>>>            Move (PartlFpa.Poso_Pro_Fpa+PartlFpa.POSO_FPA) to PartlFpa.POSO_ME_FPA
52634>>>>>>>            Saverecord PartlFpa
52635>>>>>>>            Add PartlFpa.POSO_FPA to nFpaOnTotal
52636>>>>>>>            Find Gt PartlFpa By Index.1
52637>>>>>>>>
52637>>>>>>>        Loop
52638>>>>>>>>
52638>>>>>>>
52638>>>>>>>        Move nFpaOnTotal to Particle.Fpa_On_Total
52639>>>>>>>
52639>>>>>>>    End_Procedure   // Backout
52640>>>>>>>
52640>>>>>>>
52640>>>>>>>
52640>>>>>>>
52640>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
52641>>>>>>>             If (iError_Num = 1001) Error 1001 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Wax"
52644>>>>>>>        Else If (iError_Num = 1002) Error 1002 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Witemx"
52648>>>>>>>        Else If (iError_Num = 1003) Error 1003 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Particle"
52652>>>>>>>        Else If (iError_Num = 1004) Error 1004 "DDC 18: ¦©æ«ž«˜ „å›¦¬ª ‹ž›œ¤ ¡ã\nƒ ˜š¨á¯«œ ˜¤ Ÿâ¢œ«œ, «ž š¨˜££ã «¦¬ œå›¦¬ª"
52656>>>>>>>        Else If (iError_Num = 1005) Error 1005 "DDC 18: ¦©æ §¨¦ „¡§«à©žª ‹ž›œ¤ ¡æ"
52660>>>>>>>        Else If (iError_Num = 1006) Error 1006 "DDC 18: ¦©æ §¨¦ ”€ ‹ž›œ¤ ¡æ"
52664>>>>>>>        Else If (iError_Num = 1007) Error 1007 "DDC 18: ¦©æ ¢ž¨à«â¦ „å›¦¬ª ‹ž›œ¤ ¡æ"
52668>>>>>>>        Else If (iError_Num = 1009) Error 1009 "DDC 18: ƒœ¤ œå¤˜  œ­ ¡«ã ž › ˜š¨˜­ã \n„®œ  ›ž£ ¦¬¨šžŸœå £œ«˜©®ž£˜« ©£â¤¦ §˜¨˜©«˜« ¡æ"
52672>>>>>>>        Else If (iError_Num = 1010) Error 1010 "DDC 18: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ §œ¢á«ž"
52676>>>>>>>        Else If (iError_Num = 1011) Error 1011 "DDC 18: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ ¬§. §¢ž¨à£ãª"
52680>>>>>>>        Else If (iError_Num = 1012) Error 1012 "DDC 18: ’¦ œå›¦ª ˜¬«æ §¨¦ã¢Ÿœ ˜§¦ £œ«˜©®ž£˜« ©£æ ¡˜  ›œ¤ › ˜š¨á­œ«˜ .\nƒ ˜š¨á¯«œ «¦ §˜¨˜©«˜« ¡æ ¡˜  ¥˜¤˜£œ«˜©®ž£˜«å©«œ «¦ ˜¨® ¡æ."
52684>>>>>>>        Else If (iError_Num = 1013) Error 1013 "DDC 18: ’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\n‰ ¤ãŸž¡œ §¦©æ«ž«˜ > ˜§¦ «ž › ˜Ÿâ© £ž"
52688>>>>>>>        Else If (iError_Num = 1111) Error 1111 "DDC 18: ƒœ¤ â®œ  ¡˜«˜®à¨žŸœå ©«¦ ©ç©«ž£˜ «â«¦ ¦ §¦©¦©«æ ”€"
52692>>>>>>>        Else If (iError_Num = 1105) Error 1105 "DDC 18: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
52696>>>>>>>        Else If (iError_Num = 1106) Error 1106 "DDC 18: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
52700>>>>>>>        Else If (iError_Num = 1107) Error 1107 "DDC 18: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
52704>>>>>>>        Else If (iError_Num = 1108) Error 1108 "DDC 18: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
52708>>>>>>>        Else If (iError_Num = 1110) Error 1110 "DDC 18: †£/¤å˜ §˜¨˜©«˜« ¡¦ç <= †£/¤å˜ª ¡¢œ ©å£˜«¦ª\nƒœ¤ œ§ «¨â§œ«˜  ¡˜££å˜ «¨¦§¦§¦åž©ž ©«¦ §˜¨˜©«˜« ¡æ"
52712>>>>>>>        Else If (iError_Num = 6001) Error 6001 "DDC 18: ƒœ¤ §¨¦¡ç§«œ  §¦©¦ ˜§¦ « £¦¡˜«á¢¦š¦"
52716>>>>>>>        Else If (iError_Num = 7000) Error 7000 "DDC 18: ¨¦â¨®œ«˜  ˜§¦ ˜¨˜ššœ¢å˜. † š¨˜££ã ˜¬«ã £æ¤¦ › ˜š¨á­œ«˜ "
52720>>>>>>>        Else If (iError_Num = 7001) Error 7001 "DDC 18: ’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ."
52724>>>>>>>        Else If (iError_Num = 7005) Error 7005 "DDC 18: † §¦©æ«ž«˜ ›œ¤ «¨¦§¦§¦ œå«˜  š ˜«  §¨¦ã¢Ÿœ ˜§¦ £œ«˜©®ž£˜« ©£æ.\nƒ ˜š¨á¯«œ «¦ §˜¨˜©«˜« ¡æ ¡˜  ¥˜¤˜£œ«˜©®ž£˜«å©«œ «¦ ˜¨® ¡æ."
52728>>>>>>>        Else If (iError_Num = 8000) Error 8000 "DDC 18: €¡¬¨éŸž¡œ ž ¡˜«˜®é¨ž©ž «¦¬ œå›¦¬ª ˜§¦ «¦¤ ®¨ã©«ž\n‹œ«˜ «¦ Ž‰, §˜«ã©«œ F5"
52732>>>>>>>        Else If (iError_Num = 8001) Error 8001 "DDC 18: ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã œå›¦¬ª\n‹œ«˜ «¦ Ž‰, §˜«ã©«œ F5"
52736>>>>>>>        Else If (iError_Num = 6655) Error 6655 "DDC 18: ¨¦¡ç§«œ  ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž > ˜¨® ¡ãª §¦©æ«ž«˜ª"
52740>>>>>>>        Else Forward Send Operation_Not_Allowed  iError_Num
52743>>>>>>>    End_Procedure   // Operation_Not_Allowed
52744>>>>>>>
52744>>>>>>>    Function Validate_Save  Returns Integer
52745>>>>>>>        Integer iReturnVal iFpaRecnum iYes
52746>>>>>>>        Number  nInt nqty nQtyKin
52746>>>>>>>        String  sUserID sOldUserID sOldItem
52746>>>>>>>
52746>>>>>>>        Forward Get Validate_Save  To iReturnVal
52748>>>>>>>
52748>>>>>>>        If (Not(iReturnVal)) Begin
52750>>>>>>>
52750>>>>>>>//////////////////////////////////////////////////////////////////////////////////////
52750>>>>>>>        // Egine rem o kodikas pou elegxei to pososto fpa giati sto shmeio ayto
52750>>>>>>>        // dhmiourgouse parenergeia an o xrhsths allaze to pososto fpa pou erxotan
52750>>>>>>>        // apo to eidos, tote allaze kai sto record tou eidous
52750>>>>>>>
52750>>>>>>>//            If (Pmoves.Pms_VatPct) Begin
52750>>>>>>>//                Move Fpa.Recnum to iFpaRecnum
52750>>>>>>>//                Clear Fpa
52750>>>>>>>//                Move Pmoves.Pms_VatPct      to Fpa.Fpa_Pososto
52750>>>>>>>//                Find eq Fpa By Index.1 // Fpa:Index.1:Fpa_Pososto
52750>>>>>>>//                If (Not(Found)) Move 1111 to iReturnVal
52750>>>>>>>//                If (iFpaRecnum) Begin
52750>>>>>>>//                    Clear Fpa
52750>>>>>>>//                    Move iFpaRecnum to Fpa.Recnum
52750>>>>>>>//                    Find Eq Fpa.Recnum
52750>>>>>>>//                End
52750>>>>>>>//            End
52750>>>>>>>//////////////////////////////////////////////////////////////////////////////////////
52750>>>>>>>
52750>>>>>>>                 If (Wax.Recnum          =0) Move 1001 to iReturnVal
52753>>>>>>>            Else If (Witemx.Recnum       =0) Move 1002 to iReturnVal
52757>>>>>>>            Else If (Particle.Recnum     =0) Move 1003 to iReturnVal
52761>>>>>>>            Else If (Pmoves.Pms_Qty      =0) Move 1004 to iReturnVal
52765>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                     Move 1110 to iReturnVal
52769>>>>>>>            Else Begin
52770>>>>>>>                //If (Pmoves.Timol_Ypol<0)                        Move 7001 to iReturnVal
52770>>>>>>>//////                GTS 09-06-06
52770>>>>>>>//                If (Pmoves.Qty_Kinhshs>Pmoves.Timol_Ypol)  Move 1013 to iReturnVal
52770>>>>>>>//                Else If (Pmoves.Timol_Ypol>Pmoves.Pms_Qty)      Move 6655 to iReturnVal
52770>>>>>>>                // SOS SOS SOS 24/10/2002 ¨¦©¦¨ ¤˜ Off š ˜«  ®«¬§˜œ  ©« ª ˜¤«¢ œª
52770>>>>>>>
52770>>>>>>>//                Else If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
52770>>>>>>>//                    If (Pmoves.Posa_Apo_Dap=0) Begin
52770>>>>>>>//                        Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
52770>>>>>>>//                        If (iYes=MBR_NO) Move 6001 to iReturnVal
52770>>>>>>>//                    End
52770>>>>>>>//                End
52770>>>>>>>//                Else If ((Clients.Plafon>0) And ;
52770>>>>>>>//                    ((Clients.Ypoloipo+Pmoves.Posa_Apo_Dap)>Clients.Plafon) And ;
52770>>>>>>>//                    (Ptyppar.Check_Posa_Plaf='1')) Begin
52770>>>>>>>//                        Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
52770>>>>>>>//                        If (iYes=MBR_NO) Move 1010 to iReturnVal
52770>>>>>>>//                End
52770>>>>>>>//                Else If ((PayResp.Plafon>0) And ;
52770>>>>>>>//                        ((PayResp.Ypoloipo+Pmoves.Posa_Apo_Dap)>PayResp.Plafon) And ;
52770>>>>>>>//                         (Ptyppar.Check_Posa_Plaf='1')) Begin
52770>>>>>>>//                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
52770>>>>>>>//                        If (iYes=MBR_NO) Move 1011 to iReturnVal
52770>>>>>>>//                End
52770>>>>>>>                If ((pmoves.clorderd_recr <> '') and (pifromclorder(self)<>1)) begin //?? Pmoves ???ÿ????š???? ? ???????êœ??
52772>>>>>>>                    get pnoqty to nqty
52773>>>>>>>                    if (nqty <> pmoves.pms_qty)                 Move 7000 to iReturnVal
52776>>>>>>>                End
52776>>>>>>>>
52776>>>>>>>
52776>>>>>>>                Else If ((Pmoves.Qty_Ypol=1) And (piFromMetasx(Self)=0)) begin
52779>>>>>>>                    // js 28/08/2002
52779>>>>>>>                    // To pedio Qty_Ypol xrhsimopoihtai gia na flagarei an ena Pmove
52779>>>>>>>                    // exei proelthei apo metasxhmatismo (Eite sygkentrotika, eite analytika)
52779>>>>>>>                    // To xrhsimopoihsame ayto gia na mhn anoixtei neo pedio.
52779>>>>>>>                    // An loipon exei proelthei apo metasxhmatismo DEN epitrepetai tropopoihsh
52779>>>>>>>                    // ths posothtas tou ap' eutheias alla mono meso ths posothtas mias
52779>>>>>>>                    // sygkekrimenhs eggrafhs tou arxeiou PmsSxet
52779>>>>>>>                    If (Operation_Origin=Self) Begin
52781>>>>>>>                        get pnoqty to nqty
52782>>>>>>>                        if (nqty <> pmoves.pms_qty)             Move 7005 to iReturnVal
52785>>>>>>>
52785>>>>>>>                        // js 22/12/2003
52785>>>>>>>                        // Epishs DEN epitrepetai allagh eidous
52785>>>>>>>                        // Pianoume to bug pou se metasxhmatismeno parastatiko
52785>>>>>>>                        // mporouse na allaxei to eidos me F7/F8
52785>>>>>>>                        Get psOldItem to sOldItem
52786>>>>>>>                        If (Item.Item_Code<>sOldItem) Move 8001 to iReturnVal
52789>>>>>>>                    End
52789>>>>>>>>
52789>>>>>>>                End
52789>>>>>>>>
52789>>>>>>>            End
52789>>>>>>>>
52789>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
52792>>>>>>>        End
52792>>>>>>>>
52792>>>>>>>        Function_Return iReturnVal
52793>>>>>>>    End_Function   // Validate_Save
52794>>>>>>>
52794>>>>>>>    Function Validate_Delete  Returns Integer
52795>>>>>>>        Integer iReturnVal
52796>>>>>>>        Forward Get Validate_Delete  To iReturnVal
52798>>>>>>>        If (Not(iReturnVal)) Begin
52800>>>>>>>            If (Particle.Partl_Timol=1) Move 1009 to iReturnVal
52803>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                Move 1110 to iReturnVal
52807>>>>>>>            Else If ((pmoves.qty_ypol=1) And (Operation_Origin=Self)) Move 1012 to iReturnVal
52811>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
52814>>>>>>>        End
52814>>>>>>>>
52814>>>>>>>        Function_Return iReturnVal
52815>>>>>>>    End_Function   // Validate_Delete
52816>>>>>>>
52816>>>>>>>    Procedure Set_UnitPrice integer iField  Number nNum
52817>>>>>>>        Local Integer   Changed
52818>>>>>>>        Local Number    nInt
52818>>>>>>>        Get Field_Changed_State iField to Changed
52819>>>>>>>        If (Changed=0 AND nNum=0) Begin
52821>>>>>>>            Get fnTeleytaiaTimh to nInt
52822>>>>>>>            Set Field_Default_Value iField to nInt
52823>>>>>>>        End
52823>>>>>>>>
52823>>>>>>>    End_Procedure   // Shmera
52824>>>>>>>
52824>>>>>>>    Procedure Set_Discount integer iField  Number nNum
52825>>>>>>>        Local Integer Changed
52826>>>>>>>        Local Number nInt
52826>>>>>>>        Get Field_Changed_State iField to Changed
52827>>>>>>>        If (Changed=0 AND nNum=0) Begin
52829>>>>>>>            Get fnTeleytaiaTimh to nInt
52830>>>>>>>            If (nInt<0) Begin
52832>>>>>>>                Move (nInt*(-1)) to nInt
52833>>>>>>>                Set Field_Default_Value iField to nInt
52834>>>>>>>            End
52834>>>>>>>>
52834>>>>>>>        End
52834>>>>>>>>
52834>>>>>>>    End_Procedure   // Shmera
52835>>>>>>>
52835>>>>>>>    Procedure Set_FPA integer iField  Number nNum
52836>>>>>>>        Local Integer Changed
52837>>>>>>>        Local Number nInt
52837>>>>>>>        Get Field_Changed_State iField to Changed
52838>>>>>>>        If (Changed=0 AND nNum=0) Begin
52840>>>>>>>            Move Item.Fpa_Pososto to nInt
52841>>>>>>>            Set Field_Default_Value iField to nInt
52842>>>>>>>        End
52842>>>>>>>>
52842>>>>>>>    End_Procedure   // Shmera
52843>>>>>>>
52843>>>>>>>    // Define_Fields:
52843>>>>>>>    // This procedure is used to set up all data-dictionary rules.
52843>>>>>>>
52843>>>>>>>    Procedure Define_Fields
52844>>>>>>>        Forward Send Define_Fields
52846>>>>>>>        //DDB-Generated-Code-Location
52846>>>>>>>        //DDB-DefineFieldStart
52846>>>>>>>
52846>>>>>>>        Set Main_File            To Pmoves.File_Number
52847>>>>>>>
52847>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
52848>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
52849>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
52850>>>>>>>
52850>>>>>>>        // Child (Client) file structure................
52850>>>>>>>        Send Add_Client_File  Pmsdtl.File_Number
52851>>>>>>>
52851>>>>>>>        // Parent (Server) file structure...............
52851>>>>>>>        Send Add_Server_File  Wax.File_Number
52852>>>>>>>        Send Add_Server_File  Witemx.File_Number
52853>>>>>>>        Send Add_Server_File  Particle.File_Number
52854>>>>>>>
52854>>>>>>>        // External (System) file structure.............
52854>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_NEW_SAVE
52855>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
52856>>>>>>>        Send Add_System_File  Partlfpa.File_Number  DD_LOCK_ON_ALL
52857>>>>>>>        Send Add_System_File  Clorder.File_Number  DD_LOCK_ON_ALL
52858>>>>>>>        Send Add_System_File  Clorderd.File_Number  DD_LOCK_ON_ALL
52859>>>>>>>        Send Add_System_File  Btnemp.File_Number  DD_LOCK_ON_ALL
52860>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
52861>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
52862>>>>>>>
52862>>>>>>>        Define_Auto_Increment  Sysrecp.Pmoves_Rec0  To Pmoves.Pms_Rec0
52865>>>>>>>
52865>>>>>>>        // Field-based properties.......................
52865>>>>>>>
52865>>>>>>>        // Pmoves.Company_Code
52865>>>>>>>
52865>>>>>>>        // Pmoves.Branch_Code
52865>>>>>>>
52865>>>>>>>        // Pmoves.Year_Year
52865>>>>>>>
52865>>>>>>>        // Pmoves.Ctypkin_Code
52865>>>>>>>
52865>>>>>>>        // Pmoves.Wtypkin_Code
52865>>>>>>>
52865>>>>>>>        // Pmoves.Custprom_Code
52865>>>>>>>
52865>>>>>>>        // Pmoves.Client_Id
52865>>>>>>>
52865>>>>>>>        // Pmoves.Cn_Code
52865>>>>>>>
52865>>>>>>>        // Pmoves.Ptyppar_Code
52865>>>>>>>
52865>>>>>>>        // Pmoves.Partl_Hmnia
52865>>>>>>>
52865>>>>>>>        // Pmoves.Pseira_Seira
52865>>>>>>>
52865>>>>>>>        // Pmoves.Partl_No
52865>>>>>>>
52865>>>>>>>        // Pmoves.Partl_Rec0
52865>>>>>>>
52865>>>>>>>        // Pmoves.Witemkat_Code
52865>>>>>>>
52865>>>>>>>        // Pmoves.Units_Code
52865>>>>>>>
52865>>>>>>>        // Pmoves.Item_Code
52865>>>>>>>
52865>>>>>>>        // Pmoves.Witemx_Code
52865>>>>>>>
52865>>>>>>>        // Pmoves.Wapokat_Code
52865>>>>>>>
52865>>>>>>>        // Pmoves.Wapomast_Code
52865>>>>>>>
52865>>>>>>>        // Pmoves.Wax_Code
52865>>>>>>>
52865>>>>>>>        // Pmoves.Wax_Recr
52865>>>>>>>
52865>>>>>>>        // Pmoves.Witemx_Recr
52865>>>>>>>
52865>>>>>>>        // Pmoves.Partl_Recr
52865>>>>>>>
52865>>>>>>>        // Pmoves.Pms_Rec0
52865>>>>>>>        Set Field_Options          Field Pmoves.Pms_Rec0 To DD_AUTOFIND
52866>>>>>>>
52866>>>>>>>        // Pmoves.Pms_No
52866>>>>>>>
52866>>>>>>>        // Pmoves.Pms_Recr
52866>>>>>>>
52866>>>>>>>        // Pmoves.Pms_Unitcode
52866>>>>>>>
52866>>>>>>>        // Pmoves.Pms_Qty
52866>>>>>>>
52866>>>>>>>        // Pmoves.Pms_Unitprice
52866>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Unitprice To Set_UnitPrice
52867>>>>>>>
52867>>>>>>>        // Pmoves.Pms_Ambd
52867>>>>>>>
52867>>>>>>>        // Pmoves.Pms_Pctdisc
52867>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Pctdisc To Set_Discount
52868>>>>>>>
52868>>>>>>>        // Pmoves.Pms_Discam
52868>>>>>>>
52868>>>>>>>        // Pmoves.Pms_Amaftdisc
52868>>>>>>>
52868>>>>>>>        // Pmoves.Pms_Vatpct
52868>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Vatpct To Set_FPA
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_Vatam
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_Exrampct
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_Exdet
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_Payable
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_Axia
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_X0
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_P0
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_X00
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_P00
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_X1
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_P1
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_X2
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_P2
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_Dlixis
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_A_Code
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_Status_E
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_Status_A
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_S0
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_Ys0
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_S1
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_Ys1
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_S2
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_Ys2
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_Sc_Code2
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_Open
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_Aopen
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_M_Code
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_Yn_Myf
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_Myf_Axia
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_Kk
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_C_Code2
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_Cn_Code
52869>>>>>>>
52869>>>>>>>        // Pmoves.Wcmoves_Recr
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_Module
52869>>>>>>>
52869>>>>>>>        // Pmoves.Btnl2_Recr
52869>>>>>>>
52869>>>>>>>        // Pmoves.Btnemp_Recr
52869>>>>>>>
52869>>>>>>>        // Pmoves.Btarticle_Recr
52869>>>>>>>
52869>>>>>>>        // Pmoves.Sls_Id
52869>>>>>>>
52869>>>>>>>        // Pmoves.Presp_Id
52869>>>>>>>
52869>>>>>>>        // Pmoves.Cnt_Id
52869>>>>>>>
52869>>>>>>>        // Pmoves.Mhxanik_Id
52869>>>>>>>
52869>>>>>>>        // Pmoves.Extra_Epimer
52869>>>>>>>
52869>>>>>>>        // Pmoves.Ekpt_Epimer
52869>>>>>>>
52869>>>>>>>        // Pmoves.Clorderd_Recr
52869>>>>>>>
52869>>>>>>>        // Pmoves.Witemx_Descr
52869>>>>>>>
52869>>>>>>>        // Pmoves.Ptyppar_Descr
52869>>>>>>>
52869>>>>>>>        // Pmoves.Ti_Typonei_Pms
52869>>>>>>>
52869>>>>>>>        // Pmoves.Timol_Qty
52869>>>>>>>
52869>>>>>>>        // Pmoves.Timol_Ypol
52869>>>>>>>
52869>>>>>>>        // Pmoves.Posa_Apo_Dap
52869>>>>>>>
52869>>>>>>>        // Pmoves.Qty_Ypol
52869>>>>>>>
52869>>>>>>>        // Pmoves.Pms_Selected
52869>>>>>>>        Set Field_Class_Name       Field Pmoves.Pms_Selected To "dbCheckBoxsub"
52870>>>>>>>
52870>>>>>>>        // Pmoves.Qty_Kinhshs
52870>>>>>>>
52870>>>>>>>        // Pmoves.Sx_Parast
52870>>>>>>>
52870>>>>>>>        // Pmoves.Sx_Hmnia
52870>>>>>>>
52870>>>>>>>        // Pmoves.Sx_Seira
52870>>>>>>>
52870>>>>>>>        // Pmoves.Sx_Arithmos
52870>>>>>>>
52870>>>>>>>        // Pmoves.Pump_Id
52870>>>>>>>
52870>>>>>>>        // Pmoves.Car_Id
52870>>>>>>>
52870>>>>>>>        // Pmoves.Item_Ypot
52870>>>>>>>
52870>>>>>>>        // Pmoves.Qty_Return
52870>>>>>>>
52870>>>>>>>        // Pmoves.Client_Name
52870>>>>>>>
52870>>>>>>>        // Pmoves.Zone
52870>>>>>>>
52870>>>>>>>        //DDB-DefineFieldEnd
52870>>>>>>>    End_Procedure    // Define_Fields
52871>>>>>>>
52871>>>>>>>    // Field_Defaults:
52871>>>>>>>    // This procedure is used to establish default field values.
52871>>>>>>>
52871>>>>>>>    Procedure Field_Defaults
52872>>>>>>>        Forward Send Field_Defaults
52874>>>>>>>        //DDB-Generated-Code-Location
52874>>>>>>>        //DDB-FieldDefaultStart
52874>>>>>>>        //DDB-FieldDefaultEnd
52874>>>>>>>        //Set Field_Changed_Value Field Pmoves.Pms_VatPct to Item.Fpa_Pososto
52874>>>>>>>    End_Procedure    // Field_Defaults
52875>>>>>>>
52875>>>>>>>End_Class    // Pmoves_DataDictionary
52876>>>>>>>//DDB-FileEnd
52876>>>>>    Use PmsDtl.DD
INCLUDING FILE: PMSDTL.DD
52876>>>>>>>//DDB-FileStart
52876>>>>>>>//DDB-HeaderStart
52876>>>>>>>
52876>>>>>>>// File Name : PmsDtl.DD
52876>>>>>>>// Class Name: Pmsdtl_DataDictionary
52876>>>>>>>// Revision  : 0
52876>>>>>>>// Version   : 2
52876>>>>>>>
52876>>>>>>>Use  Windows           // Basic Definitions
52876>>>>>>>Use  DataDict          // DataDictionary Class Definition
52876>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
52876>>>>>>>
52876>>>>>>>Open Pmsdtl
52878>>>>>>>Open Pmoves
52880>>>>>>>
52880>>>>>>>//DDB-HeaderEnd
52880>>>>>>>
52880>>>>>>>Class Pmsdtl_DataDictionary  is a DataDictionary_Sec
52881>>>>>>>
52881>>>>>>>    // Define_Fields:
52881>>>>>>>    // This procedure is used to set up all data-dictionary rules.
52881>>>>>>>
52881>>>>>>>    Procedure Define_Fields
52882>>>>>>>        Forward Send Define_Fields
52884>>>>>>>        //DDB-Generated-Code-Location
52884>>>>>>>        //DDB-DefineFieldStart
52884>>>>>>>
52884>>>>>>>        Set Main_File            To Pmsdtl.File_Number
52885>>>>>>>
52885>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
52886>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
52887>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
52888>>>>>>>
52888>>>>>>>        // Parent (Server) file structure...............
52888>>>>>>>        Send Add_Server_File  Pmoves.File_Number
52889>>>>>>>
52889>>>>>>>        // Field-based properties.......................
52889>>>>>>>
52889>>>>>>>        // Pmsdtl.Pms_Recr
52889>>>>>>>        Set Field_Options          Field Pmsdtl.Pms_Recr To DD_AUTOFIND   
52890>>>>>>>        Set Key_Field_State        Field Pmsdtl.Pms_Recr To TRUE
52891>>>>>>>
52891>>>>>>>        // Pmsdtl.Line1
52891>>>>>>>
52891>>>>>>>        // Pmsdtl.Line2
52891>>>>>>>
52891>>>>>>>        // Pmsdtl.Line3
52891>>>>>>>
52891>>>>>>>        // Pmsdtl.Line4
52891>>>>>>>
52891>>>>>>>        // Pmsdtl.Line5
52891>>>>>>>
52891>>>>>>>        //DDB-DefineFieldEnd
52891>>>>>>>    End_Procedure    // Define_Fields
52892>>>>>>>
52892>>>>>>>    // Field_Defaults:
52892>>>>>>>    // This procedure is used to establish default field values.
52892>>>>>>>
52892>>>>>>>    Procedure Field_Defaults
52893>>>>>>>        Forward Send Field_Defaults
52895>>>>>>>        //DDB-Generated-Code-Location
52895>>>>>>>        //DDB-FieldDefaultStart
52895>>>>>>>        //DDB-FieldDefaultEnd
52895>>>>>>>    End_Procedure    // Field_Defaults
52896>>>>>>>
52896>>>>>>>End_Class    // Pmsdtl_DataDictionary
52897>>>>>>>//DDB-FileEnd
52897>>>>>    Use BAXIOKAT.DD
52897>>>>>    Use SYSCURXR.DD
INCLUDING FILE: SYSCURXR.DD
52897>>>>>>>//DDB-FileStart
52897>>>>>>>//DDB-HeaderStart
52897>>>>>>>
52897>>>>>>>// File Name : SYSCURXR.DD
52897>>>>>>>// Class Name: Syscurxr_DataDictionary
52897>>>>>>>// Revision  : 8
52897>>>>>>>// Version   : 2
52897>>>>>>>
52897>>>>>>>Use  Windows           // Basic Definitions
52897>>>>>>>Use  DataDict          // DataDictionary Class Definition
52897>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
52897>>>>>>>
52897>>>>>>>Open Syscurxr
52899>>>>>>>
52899>>>>>>>//DDB-HeaderEnd
52899>>>>>>>
52899>>>>>>>Class Syscurxr_DataDictionary  is a DataDictionary_Sec
52900>>>>>>>
52900>>>>>>>    // Define_Fields:
52900>>>>>>>    // This procedure is used to set up all data-dictionary rules.
52900>>>>>>>
52900>>>>>>>    Procedure Define_Fields
52901>>>>>>>        Forward Send Define_Fields
52903>>>>>>>        //DDB-Generated-Code-Location
52903>>>>>>>        //DDB-DefineFieldStart
52903>>>>>>>
52903>>>>>>>        Set Main_File            To Syscurxr.File_Number
52904>>>>>>>
52904>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
52905>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
52906>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
52907>>>>>>>
52907>>>>>>>        // Field-based properties.......................
52907>>>>>>>
52907>>>>>>>        // Syscurxr.Company_Code
52907>>>>>>>
52907>>>>>>>        // Syscurxr.Branch_Code
52907>>>>>>>
52907>>>>>>>        // Syscurxr.Year_Year
52907>>>>>>>
52907>>>>>>>        // Syscurxr.Branch_Site
52907>>>>>>>
52907>>>>>>>        // Syscurxr.Year_Recr
52907>>>>>>>
52907>>>>>>>        // Syscurxr.Company_Name
52907>>>>>>>
52907>>>>>>>        // Syscurxr.Branch_Name
52907>>>>>>>
52907>>>>>>>        // Syscurxr.Year_Descr
52907>>>>>>>
52907>>>>>>>        // Syscurxr.C_Code0
52907>>>>>>>
52907>>>>>>>        // Syscurxr.C_Code00
52907>>>>>>>
52907>>>>>>>        // Syscurxr.C_Coder
52907>>>>>>>
52907>>>>>>>        // Syscurxr.Year_Xrhshfrom
52907>>>>>>>
52907>>>>>>>        // Syscurxr.Year_Xrhshto
52907>>>>>>>
52907>>>>>>>        // Syscurxr.Beto_Site
52907>>>>>>>
52907>>>>>>>        // Syscurxr.Euro_Code
52907>>>>>>>
52907>>>>>>>        //DDB-DefineFieldEnd
52907>>>>>>>    End_Procedure    // Define_Fields
52908>>>>>>>
52908>>>>>>>    // Field_Defaults:
52908>>>>>>>    // This procedure is used to establish default field values.
52908>>>>>>>
52908>>>>>>>    Procedure Field_Defaults
52909>>>>>>>        Forward Send Field_Defaults
52911>>>>>>>        //DDB-Generated-Code-Location
52911>>>>>>>        //DDB-FieldDefaultStart
52911>>>>>>>        //DDB-FieldDefaultEnd
52911>>>>>>>    End_Procedure    // Field_Defaults
52912>>>>>>>
52912>>>>>>>End_Class    // Syscurxr_DataDictionary
52913>>>>>>>//DDB-FileEnd
52913>>>>>    Use PMSSXET.DD
INCLUDING FILE: PMSSXET.DD
52913>>>>>>>//DDB-FileStart
52913>>>>>>>//DDB-HeaderStart
52913>>>>>>>
52913>>>>>>>// File Name : PMSSXET.DD
52913>>>>>>>// Class Name: PmsSxet_DataDictionary
52913>>>>>>>// Revision  : 27
52913>>>>>>>// Version   : 2
52913>>>>>>>
52913>>>>>>>Use  Windows           // Basic Definitions
52913>>>>>>>Use  DataDict          // DataDictionary Class Definition
52913>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
52913>>>>>>>
52913>>>>>>>Open Pmssxet
INCLUDING FILE: PMSSXET.FD
52915>>>>>>>
52915>>>>>>>//DDB-HeaderEnd
52915>>>>>>>
52915>>>>>>>Use bpEnYpol.dg
INCLUDING FILE: BPENYPOL.DG
52915>>>>>>>>>//AB/ Project bpEnYpol
52915>>>>>>>>>//AB/ Object prj is a Dialog_Project
52915>>>>>>>>>//AB/     Set ProjectName to "bpEnYpol"
52915>>>>>>>>>//AB/     Set ProjectFileName to "bpEnYpol.DG"
52915>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
52915>>>>>>>>>
52915>>>>>>>>>// Project Object Structure
52915>>>>>>>>>//   bpEnYpol is a BusinessProcessSub
52915>>>>>>>>>
52915>>>>>>>>>// Register all objects
52915>>>>>>>>>Register_Object bpEnYpol
52915>>>>>>>>>
52915>>>>>>>>>
52915>>>>>>>>>//AB-IgnoreStart
52915>>>>>>>>>
52915>>>>>>>>>Use Bproces.Sub
52915>>>>>>>>>
52915>>>>>>>>>
52915>>>>>>>>>//AB-IgnoreEnd
52915>>>>>>>>>
52915>>>>>>>>>Object bpEnYpol is a BusinessProcessSub
52917>>>>>>>>>
52917>>>>>>>>>    //AB-StoreTopStart
52917>>>>>>>>>
52917>>>>>>>>>    Open Pmoves
52919>>>>>>>>>    Open Psxetika
52921>>>>>>>>>
52921>>>>>>>>>    Set Status_Panel_State to False
52922>>>>>>>>>    //Set Allow_Cancel_State  to True
52922>>>>>>>>>    Set Display_Error_State to True
52923>>>>>>>>>    //Set Process_Title to "               "
52923>>>>>>>>>    //Set Status_Log_id to (status_log(Self)) //Use statlog.pkg
52923>>>>>>>>>    //Set Status_log_state to True
52923>>>>>>>>>
52923>>>>>>>>>    Property Integer    piFromAkyrosh       Public  0
52925>>>>>>>>>    Property Integer    piLathos            Public  0
52927>>>>>>>>>    Property Number     pnQty               Public  0
52929>>>>>>>>>    Property Integer    piCurrentPartl      Public  0
52931>>>>>>>>>    Property Integer    piCurrentPmoves     Public  0
52933>>>>>>>>>    Property Integer    piCurrentPmsSxet    Public  0
52935>>>>>>>>>    Property String     psRecr              Public ''
52937>>>>>>>>>
52937>>>>>>>>>
52937>>>>>>>>>    //AB-StoreTopEnd
52937>>>>>>>>>
52937>>>>>>>>>    Set Size to 60 100
52938>>>>>>>>>    Set Location to 4 5
52939>>>>>>>>>
52939>>>>>>>>>    //AB-DDOStart
52939>>>>>>>>>
52939>>>>>>>>>
52939>>>>>>>>>    //AB-DDOEnd
52939>>>>>>>>>
52939>>>>>>>>>
52939>>>>>>>>>    //AB-StoreStart
52939>>>>>>>>>
52939>>>>>>>>>    Function fiUpdate_Pmoves_Qty String asRecr Number anQty Integer aiDoNotOpen Returns Integer
52941>>>>>>>>>        Clear Pmoves
52942>>>>>>>>>        Move asRecr to Pmoves.Pms_Recr
52943>>>>>>>>>        Find Eq Pmoves by index.2
52944>>>>>>>>>>
52944>>>>>>>>>        If (Found) Begin
52946>>>>>>>>>            If ((Pmoves.Timol_Qty+anQty) > Pmoves.Pms_Qty)      Function_Return 40001
52949>>>>>>>>>            Else Begin
52950>>>>>>>>>                Add anQty to Pmoves.Timol_Qty
52951>>>>>>>>>                Move (Pmoves.Pms_Qty-Pmoves.Timol_Qty) to Pmoves.Timol_Ypol
52952>>>>>>>>>                If (Pmoves.Timol_Ypol>Pmoves.Pms_Qty)  Function_Return 40003
52955>>>>>>>>>                Saverecord Pmoves
52956>>>>>>>>>
52956>>>>>>>>>                Clear Particle
52957>>>>>>>>>                Move Pmoves.Partl_Recr to Particle.Partl_Recr
52958>>>>>>>>>                Find Eq Particle by Index.2
52959>>>>>>>>>>
52959>>>>>>>>>                If (Found) Begin
52961>>>>>>>>>                   // Reread
52961>>>>>>>>>                    Add anQty to Particle.Timol_Qty
52962>>>>>>>>>                    If (Particle.Partl_TotTem>0) Begin
52964>>>>>>>>>                        Move (Particle.Partl_TotTem-Particle.Timol_Qty)     to Particle.Timol_Ypol
52965>>>>>>>>>
52965>>>>>>>>>                        If (aiDoNotOpen=1)  Move 1                          to Particle.Partl_Timol
52968>>>>>>>>>                        Else                Move (Particle.Timol_Ypol=0 )   to Particle.Partl_Timol
52970>>>>>>>>>
52970>>>>>>>>>                    End
52970>>>>>>>>>>
52970>>>>>>>>>                    Else Move 0 to Particle.Partl_Timol
52972>>>>>>>>>                    Saverecord Particle
52973>>>>>>>>>                   // Unlock
52973>>>>>>>>>                End
52973>>>>>>>>>>
52973>>>>>>>>>                Else Function_Return 40002
52975>>>>>>>>>            End
52975>>>>>>>>>>
52975>>>>>>>>>        End
52975>>>>>>>>>>
52975>>>>>>>>>        Else Function_Return 40000
52977>>>>>>>>>        Function_Return 0
52978>>>>>>>>>    End_Function
52979>>>>>>>>>
52979>>>>>>>>>    Procedure OnProcess
52981>>>>>>>>>        Integer iLathos iSub iAkyro
52982>>>>>>>>>        String  sCurr sRecr sPmoveRecr sParticleRecr
52982>>>>>>>>>        Number  nQty nQty2
52982>>>>>>>>>
52982>>>>>>>>>        Set piLathos        to 0
52983>>>>>>>>>        Get pnQty           to nQty2
52984>>>>>>>>>        Get psRecr          to sRecr
52985>>>>>>>>>        Get piFromAkyrosh   to iAkyro
52986>>>>>>>>>
52986>>>>>>>>>        // An h posothta einai setarismenh thetika shmainei pos klhthike
52986>>>>>>>>>        // apo thn Update tou PmsSxet, allios an erthei arnhtikh apo thn Backout
52986>>>>>>>>>        // Prepei na to xeroume gia thn periptosh tou akyrotikou, opou tha trexei
52986>>>>>>>>>        // apanota h function kai tha antistrpsei to proshmo ths posothtas.
52986>>>>>>>>>        Move (nQty2<0)   to iSub
52987>>>>>>>>>
52987>>>>>>>>>
52987>>>>>>>>>        Get fiUpdate_Pmoves_Qty sRecr nQty2 0 to iLathos
52988>>>>>>>>>
52988>>>>>>>>>        If (iLathos) Begin
52990>>>>>>>>>            Set piLathos to iLathos
52991>>>>>>>>>            Procedure_Return
52992>>>>>>>>>        End
52992>>>>>>>>>>
52992>>>>>>>>>
52992>>>>>>>>>
52992>>>>>>>>>        // js 30/08/2002 Enhmerosh ena bhma pio piso sthn periptosh pou
52992>>>>>>>>>        // h enhmerosh ton pmoves apo backout kai update tou PmsSxet,
52992>>>>>>>>>        // afora Akyrotiko. (DAP --> TIM --> AKYROTIKO). Erxomaste dhladh edo apo
52992>>>>>>>>>        // AKYROTIKO na enhmerosoume tis posothtes tou TIMOLOGIOU.
52992>>>>>>>>>        // Sthn periptosh ayth prepei na kanoume ta exhs:
52992>>>>>>>>>        // 1. Eyresh ton sxetikon tou trxontos pmove TIMOLOGIOU
52992>>>>>>>>>        // 2. Antistrofh tou proshmou ths posothtas tous
52992>>>>>>>>>        // 3. Eyresh tou arxikou Pmoves (DAP) kai enhmerosh posothtas kinhshs
52992>>>>>>>>>
52992>>>>>>>>>        If (iAkyro) Begin
52994>>>>>>>>>            Clear Pmoves
52995>>>>>>>>>            Move sRecr to Pmoves.Pms_Recr
52996>>>>>>>>>            Find Eq Pmoves by index.2
52997>>>>>>>>>>
52997>>>>>>>>>            If (Found) Begin
52999>>>>>>>>>                Clear PmsSxet
53000>>>>>>>>>                Move sRecr to PmsSxet.Pms_Recr
53001>>>>>>>>>                Find Gt PmsSxet by Index.1
53002>>>>>>>>>>
53002>>>>>>>>>                While ((Found=1) And (PmsSxet.Pms_Recr=sRecr))
53006>>>>>>>>>                    Move PmsSxet.Sxetiko_Recr   to sCurr
53007>>>>>>>>>                    Move PmsSxet.Posothta       to nQty
53008>>>>>>>>>                    If (iSub) Begin
53010>>>>>>>>>                        // An Exei erthei apo Backout tou PmsSxet (to gnorizoume apo thn posothta
53010>>>>>>>>>                        // h opoia sto property einai arnhtikh) tote gyrname thn posothta tou
53010>>>>>>>>>                        // PmsSxet thetikh (Ousiastika thn afhnoume opos einai dhladh).
53010>>>>>>>>>                    End
53010>>>>>>>>>>
53010>>>>>>>>>                    Else Begin
53011>>>>>>>>>                        // An Exei erthei apo Update tou PmsSxet (to gnorizoume apo thn posothta
53011>>>>>>>>>                        // h opoia sto property einai thetikh) tote gyrname thn posothta tou
53011>>>>>>>>>                        // PmsSxet arnhtikh.
53011>>>>>>>>>                        Move (nQty*(-1)) to nQty
53012>>>>>>>>>                    End
53012>>>>>>>>>>
53012>>>>>>>>>
53012>>>>>>>>>                    //Get fiUpdate_Pmoves_Qty sCurr nQty 1 to iLathos
53012>>>>>>>>>                    // 07/01/2003 //
53012>>>>>>>>>                    Get fiUpdate_Pmoves_Qty sCurr nQty 0 to iLathos
53013>>>>>>>>>
53013>>>>>>>>>                    If (iLathos) Begin
53015>>>>>>>>>                        Set piLathos to (iLathos+3)
53016>>>>>>>>>                        // An Gyrisei Pmoves Not Found      (40000) To kanoume 40003
53016>>>>>>>>>                        // An Gyrisei problhma sto ypoloipo (40001) To kanoume 40004
53016>>>>>>>>>                        // An Gyrisei problhma sto particle (40002) To kanoume 40005
53016>>>>>>>>>                        // An Gyrisei problhma sto particle (40003) To kanoume 40006
53016>>>>>>>>>                        Procedure_Return
53017>>>>>>>>>                    End
53017>>>>>>>>>>
53017>>>>>>>>>
53017>>>>>>>>>                    Clear PmsSxet
53018>>>>>>>>>                    Move sRecr      to PmsSxet.Pms_Recr
53019>>>>>>>>>                    Move sCurr      to PmsSxet.Sxetiko_Recr
53020>>>>>>>>>                    Find Eq PmsSxet by Index.1
53021>>>>>>>>>>
53021>>>>>>>>>                    Find Gt PmsSxet by Index.1
53022>>>>>>>>>>
53022>>>>>>>>>                Loop
53023>>>>>>>>>>
53023>>>>>>>>>            End
53023>>>>>>>>>>
53023>>>>>>>>>            Else Set piLathos to 40007
53025>>>>>>>>>        End
53025>>>>>>>>>>
53025>>>>>>>>>
53025>>>>>>>>>        If (piLathos(Self)<>0) Procedure_Return
53028>>>>>>>>>
53028>>>>>>>>>    End_Procedure
53029>>>>>>>>>
53029>>>>>>>>>    Procedure OnError integer error_info string errMsg
53031>>>>>>>>>    End_Procedure
53032>>>>>>>>>
53032>>>>>>>>>    Procedure Start_Process
53034>>>>>>>>>        Forward Send Start_Process
53036>>>>>>>>>    End_Procedure
53037>>>>>>>>>
53037>>>>>>>>>    Procedure End_Process
53039>>>>>>>>>        Forward Send End_Process
53041>>>>>>>>>        If (piCurrentPartl(Self)) Begin
53043>>>>>>>>>            Clear Particle
53044>>>>>>>>>            Move (piCurrentPartl(Self)) to Particle.Recnum
53045>>>>>>>>>            Find Eq Particle.Recnum
53046>>>>>>>>>>
53046>>>>>>>>>        End
53046>>>>>>>>>>
53046>>>>>>>>>        If (piCurrentPmoves(Self)) Begin
53048>>>>>>>>>            Clear Pmoves
53049>>>>>>>>>            Move (piCurrentPmoves(Self)) to Pmoves.Recnum
53050>>>>>>>>>            Find Eq Pmoves.Recnum
53051>>>>>>>>>>
53051>>>>>>>>>        End
53051>>>>>>>>>>
53051>>>>>>>>>        If (piCurrentPmsSxet(Self)<>0) Begin
53053>>>>>>>>>            Clear PmsSxet
53054>>>>>>>>>            Move (piCurrentPmsSxet(Self)) to PmsSxet.Recnum
53055>>>>>>>>>            Find Eq PmsSxet.Recnum
53056>>>>>>>>>>
53056>>>>>>>>>        End
53056>>>>>>>>>>
53056>>>>>>>>>    End_Procedure
53057>>>>>>>>>
53057>>>>>>>>>    //AB-StoreEnd
53057>>>>>>>>>
53057>>>>>>>>>End_Object    // bpEnYpol
53058>>>>>>>>>
53058>>>>>>>>>//AB/ End_Object    // prj
53058>>>>>>>Use MyArray.dg
53058>>>>>>>//Use bpMakeSx.dg
53058>>>>>>>
53058>>>>>>>Class PmsSxet_DataDictionary  is a DataDictionary_Sec
53059>>>>>>>
53059>>>>>>>    Procedure Construct_Object
53060>>>>>>>        Forward Send Construct_Object
53062>>>>>>>        Property Integer piFromCreate   Public 0
53063>>>>>>>    End_Procedure
53064>>>>>>>
53064>>>>>>>    Procedure Creating
53065>>>>>>>        Forward Send Creating
53067>>>>>>>        Set piFromCreate to 1
53068>>>>>>>    End_Procedure
53069>>>>>>>
53069>>>>>>>    Procedure Update
53070>>>>>>>        String  sRecr1 sRecr2 sPmsSxet
53071>>>>>>>        Number  nQty
53071>>>>>>>        Integer iLathos iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
53071>>>>>>>
53071>>>>>>>        Forward Send Update
53073>>>>>>>
53073>>>>>>>        Move (Trim(Particle.Partl_LastNo)='1')  to iAkyro
53074>>>>>>>        Move Particle.Partl_Recr                to sRecr1
53075>>>>>>>        Move Pmoves.Recnum                      to iCurrentPmoves
53076>>>>>>>        Move PmsSxet.Recnum                     to iCurrentPmsSxet
53077>>>>>>>        Move PmsSxet.Arx_Partl_Recr             to sRecr2
53078>>>>>>>        Move PmsSxet.Posothta                   to nQty
53079>>>>>>>        Move Particle.Recnum                    to iCurrentPartl
53080>>>>>>>
53080>>>>>>>
53080>>>>>>>        If (piFromCreate(Self)<>1) Begin
53082>>>>>>>            Add nQty to Pmoves.Pms_Qty
53083>>>>>>>            Saverecord Pmoves
53084>>>>>>>
53084>>>>>>>            Set pnQty               Of bpEnYpol to nQty
53085>>>>>>>            Set psRecr              Of bpEnYpol to PmsSxet.Sxetiko_Recr
53086>>>>>>>            Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
53087>>>>>>>            Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
53088>>>>>>>            Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
53089>>>>>>>            Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
53090>>>>>>>            Send DoProcess          to bpEnYpol
53091>>>>>>>
53091>>>>>>>            Get piLathos            Of bpEnYpol to iLathos
53092>>>>>>>
53092>>>>>>>                 If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
53095>>>>>>>            Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
53099>>>>>>>            Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
53103>>>>>>>            Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
53107>>>>>>>            Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
53111>>>>>>>            Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
53115>>>>>>>            Else If (iLathos=40006) Error 8006 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
53119>>>>>>>
53119>>>>>>>        End
53119>>>>>>>>
53119>>>>>>>
53119>>>>>>>        // Epanafora posothtas giati afou trexei h backout me timh px 3 eno h update exei timh 4
53119>>>>>>>        // sthn epanatopothethsh ths bpenypol xanavriskei to current pmssxet record
53119>>>>>>>        // kai xanei thn posothta thn kainourgia opote epanerxetai me thn posothta ths
53119>>>>>>>        // backout pou einai 3.
53119>>>>>>>        Move nQty to PmsSxet.Posothta
53120>>>>>>>
53120>>>>>>>
53120>>>>>>>        Clear Psxetika
53121>>>>>>>        Move sRecr1 to Psxetika.Partl_Recr
53122>>>>>>>        Move sRecr2 to Psxetika.Psx_Partl_Recr
53123>>>>>>>        Find Eq Psxetika by index.4
53124>>>>>>>>
53124>>>>>>>        If (Found) Begin
53126>>>>>>>            Add nQty to Psxetika.Pms_Sx_Qty
53127>>>>>>>            Saverecord Psxetika
53128>>>>>>>        End
53128>>>>>>>>
53128>>>>>>>
53128>>>>>>>        Clear Psxetika
53129>>>>>>>        Move sRecr2 to Psxetika.Partl_Recr
53130>>>>>>>        Move sRecr1 to Psxetika.Psx_Partl_Recr
53131>>>>>>>        Find Eq Psxetika by index.4
53132>>>>>>>>
53132>>>>>>>        If (Found) Begin
53134>>>>>>>            Add nQty to Psxetika.Pms_Sx_Qty
53135>>>>>>>            Saverecord Psxetika
53136>>>>>>>        End
53136>>>>>>>>
53136>>>>>>>    End_Procedure
53137>>>>>>>
53137>>>>>>>    Procedure Backout
53138>>>>>>>        String  sRecr1 sRecr2 sPmsSxet
53139>>>>>>>        Number  nQty
53139>>>>>>>        Integer iLathos iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
53139>>>>>>>
53139>>>>>>>        Move (Trim(Particle.Partl_LastNo)='1')  to iAkyro
53140>>>>>>>        Move Particle.Partl_Recr                to sRecr1
53141>>>>>>>        Move Pmoves.Recnum                      to iCurrentPmoves
53142>>>>>>>        Move PmsSxet.Recnum                     to iCurrentPmsSxet
53143>>>>>>>        Move PmsSxet.Arx_Partl_Recr             to sRecr2
53144>>>>>>>        Move PmsSxet.Posothta                   to nQty
53145>>>>>>>        Move Particle.Recnum                    to iCurrentPartl
53146>>>>>>>
53146>>>>>>>        Forward Send Backout
53148>>>>>>>
53148>>>>>>>        Set pnQty               Of bpEnYpol to (nQty*(-1))
53149>>>>>>>        Set psRecr              Of bpEnYpol to PmsSxet.Sxetiko_Recr
53150>>>>>>>        Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
53151>>>>>>>        Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
53152>>>>>>>        Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
53153>>>>>>>        Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
53154>>>>>>>        Send DoProcess          to bpEnYpol
53155>>>>>>>
53155>>>>>>>        Get piLathos            Of bpEnYpol to iLathos
53156>>>>>>>
53156>>>>>>>             If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
53159>>>>>>>        Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nBackout PmsSxet'
53163>>>>>>>        Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nBackout PmsSxet'
53167>>>>>>>        Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
53171>>>>>>>        Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nBackout PmsSxet'
53175>>>>>>>        Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nBackout PmsSxet'
53179>>>>>>>        Else If (iLathos=40006) Error 8006 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  > ˜¨® ¡ã §¦©æ«ž«˜.\nBackout PmsSxet'
53183>>>>>>>        Else If (iLathos=40007) Error 8007 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
53187>>>>>>>
53187>>>>>>>        Clear Psxetika
53188>>>>>>>        Move sRecr1 to Psxetika.Partl_Recr
53189>>>>>>>        Move sRecr2 to Psxetika.Psx_Partl_Recr
53190>>>>>>>        Find Eq Psxetika by index.4
53191>>>>>>>>
53191>>>>>>>        If (Found) Begin
53193>>>>>>>            Sub nQty from Psxetika.Pms_Sx_Qty
53194>>>>>>>            Saverecord Psxetika
53195>>>>>>>        End
53195>>>>>>>>
53195>>>>>>>
53195>>>>>>>        Clear Psxetika
53196>>>>>>>        Move sRecr2 to Psxetika.Partl_Recr
53197>>>>>>>        Move sRecr1 to Psxetika.Psx_Partl_Recr
53198>>>>>>>        Find Eq Psxetika by index.4
53199>>>>>>>>
53199>>>>>>>        If (Found) Begin
53201>>>>>>>            Sub nQty from Psxetika.Pms_Sx_Qty
53202>>>>>>>            Saverecord Psxetika
53203>>>>>>>        End
53203>>>>>>>>
53203>>>>>>>    End_Procedure
53204>>>>>>>
53204>>>>>>>    Procedure Request_Save
53205>>>>>>>        Integer iInt iLathos iMustDelete iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
53206>>>>>>>        String  sParticleRecr sPmsSxetRecr sPmovesRecr sArxPartlRecr sRecr1 sRecr2 sPmsSxet
53206>>>>>>>        Number  nQty
53206>>>>>>>
53206>>>>>>>        Set piFromCreate to 0
53207>>>>>>>
53207>>>>>>>        Forward Send Request_Save
53209>>>>>>>
53209>>>>>>>        If (piFromCreate(Self)=1) Begin
53211>>>>>>>            Set piFromCreate                                                to 0
53212>>>>>>>
53212>>>>>>>            Get File_Field_Current_Value File_Field Particle.Recnum         to iCurrentPartl
53213>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Recr     to sParticleRecr
53214>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Recr         to sPmovesRecr
53215>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Recnum           to iCurrentPmoves
53216>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Recnum          to iCurrentPmsSxet
53217>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Sxetiko_Recr    to sPmsSxetRecr
53218>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Arx_Partl_Recr  to sArxPartlRecr
53219>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Posothta        to nQty
53220>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_LastNo   to iAkyro
53221>>>>>>>            Move (iAkyro=1)                                                 to iAkyro
53222>>>>>>>
53222>>>>>>>            Set pnQty               Of bpEnYpol to nQty
53223>>>>>>>            Set psRecr              Of bpEnYpol to sPmsSxetRecr
53224>>>>>>>            Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
53225>>>>>>>            Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
53226>>>>>>>            Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
53227>>>>>>>            Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
53228>>>>>>>            Send DoProcess          to bpEnYpol
53229>>>>>>>            Get piLathos            Of bpEnYpol to iLathos
53230>>>>>>>
53230>>>>>>>                 If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
53233>>>>>>>            Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
53237>>>>>>>            Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
53241>>>>>>>            Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
53245>>>>>>>            Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
53249>>>>>>>            Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
53253>>>>>>>            Else If (iLathos=40006) Error 8006 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  > ˜¨® ¡ã §¦©æ«ž«˜.\nUpdate PmsSxet'
53257>>>>>>>            Else If (iLathos=40007) Error 8007 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
53261>>>>>>>
53261>>>>>>>            Set psParticleRecr0     Of Psx_Array to sParticleRecr
53262>>>>>>>            Set psPsxetikaRecr0     Of Psx_Array to sArxPartlRecr
53263>>>>>>>            Set pnPosothta          Of Psx_Array to nQty
53264>>>>>>>            Send Make_The_Record    Of Psx_Array
53265>>>>>>>
53265>>>>>>>            // Xana vres tis eggrafes
53265>>>>>>>            Clear Particle
53266>>>>>>>            Move sParticleRecr  to Particle.Partl_Recr
53267>>>>>>>            Find Eq Particle by index.2
53268>>>>>>>>
53268>>>>>>>
53268>>>>>>>            Clear Pmoves
53269>>>>>>>            Move sPmovesRecr    to Pmoves.Pms_Recr
53270>>>>>>>            Find Eq Pmoves by index.2
53271>>>>>>>>
53271>>>>>>>
53271>>>>>>>            Clear PmsSxet
53272>>>>>>>            Move sPmovesRecr    to PmsSxet.Pms_Recr
53273>>>>>>>            Move sPmsSxetRecr   to PmsSxet.Sxetiko_Recr
53274>>>>>>>            Find Eq PmsSxet by Index.1
53275>>>>>>>>
53275>>>>>>>
53275>>>>>>>        End
53275>>>>>>>>
53275>>>>>>>    End_Procedure
53276>>>>>>>
53276>>>>>>>
53276>>>>>>>    Procedure Define_Fields
53277>>>>>>>        Forward Send Define_Fields
53279>>>>>>>        //DDB-Generated-Code-Location
53279>>>>>>>        //DDB-DefineFieldStart
53279>>>>>>>
53279>>>>>>>        Set Main_File            To Pmssxet.File_Number
53280>>>>>>>
53280>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
53281>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
53282>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53283>>>>>>>
53283>>>>>>>
53283>>>>>>>        // Field-based properties.......................
53283>>>>>>>
53283>>>>>>>        // Pmssxet.Pms_Recr
53283>>>>>>>
53283>>>>>>>        // Pmssxet.Sxetiko_Recr
53283>>>>>>>
53283>>>>>>>        // Pmssxet.Posothta
53283>>>>>>>
53283>>>>>>>        // Pmssxet.Arx_Partl_Recr
53283>>>>>>>
53283>>>>>>>        // Pmssxet.Sx_Parast
53283>>>>>>>
53283>>>>>>>        // Pmssxet.Sx_Hmnia
53283>>>>>>>
53283>>>>>>>        // Pmssxet.Sx_Foreas
53283>>>>>>>
53283>>>>>>>        // Pmssxet.Sx_Arithmos
53283>>>>>>>
53283>>>>>>>        // Pmssxet.Sx_Seira
53283>>>>>>>
53283>>>>>>>        // Pmssxet.Sx_Posothta
53283>>>>>>>
53283>>>>>>>        //DDB-DefineFieldEnd
53283>>>>>>>    End_Procedure    // Define_Fields
53284>>>>>>>
53284>>>>>>>    Procedure Field_Defaults
53285>>>>>>>        Forward Send Field_Defaults
53287>>>>>>>        //DDB-Generated-Code-Location
53287>>>>>>>        //DDB-FieldDefaultStart
53287>>>>>>>        //DDB-FieldDefaultEnd
53287>>>>>>>    End_Procedure    // Field_Defaults
53288>>>>>>>
53288>>>>>>>End_Class    // Pmssxet_DataDictionary
53289>>>>>>>//DDB-FileEnd
53289>>>>>    Use SALESMEN.DD
53289>>>>>    Use CONSTRCT.DD
53289>>>>>    Use CN.DD
53289>>>>>    Use PSXETIKA.DD
53289>>>>>    Use TPARTICL.DD
INCLUDING FILE: TPARTICL.DD
53289>>>>>>>//DDB-FileStart
53289>>>>>>>//DDB-HeaderStart
53289>>>>>>>
53289>>>>>>>// File Name : TPARTICL.DD
53289>>>>>>>// Class Name: Tparticl_DataDictionary
53289>>>>>>>// Revision  : 28
53289>>>>>>>// Version   : 2
53289>>>>>>>
53289>>>>>>>Use  Windows           // Basic Definitions
53289>>>>>>>Use  DataDict          // DataDictionary Class Definition
53289>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
53289>>>>>>>
53289>>>>>>>Open Tparticl
53291>>>>>>>Open Particle
53293>>>>>>>Open Baxiokat
53295>>>>>>>Open Sysrecc
53297>>>>>>>
53297>>>>>>>//DDB-HeaderEnd
53297>>>>>>>//DDB-ValidationStart
53297>>>>>>>
53297>>>>>>>Register_Object Mera_Tou_Mhna_VT
53297>>>>>>>
53297>>>>>>>Object Mera_Tou_Mhna_VT  is a CodeValidationTable
53299>>>>>>>    Set Type_Value        To "HMERES"
53300>>>>>>>    Set Allow_Blank_State To TRUE
53301>>>>>>>    //DDB-ValidationCustomStart
53301>>>>>>>    //DDB-ValidationCustomEnd
53301>>>>>>>End_Object   // Mera_Tou_Mhna_VT
53302>>>>>>>//DDB-ValidationEnd
53302>>>>>>>
53302>>>>>>>Class Tparticl_DataDictionary  is a DataDictionary_Sec
53303>>>>>>>
53303>>>>>>>    Procedure Construct_Object
53304>>>>>>>        Forward Send Construct_Object
53306>>>>>>>        Property Integer piParticleID Public 0
53307>>>>>>>        Property Integer piBaxiokatID Public 0
53308>>>>>>>    End_Procedure
53309>>>>>>>
53309>>>>>>>    Procedure End_Construct_Object
53310>>>>>>>        Integer iID
53311>>>>>>>        Forward Send End_Construct_Object
53313>>>>>>>        Move (Find_Server_DDO(Self,Particle.File_Number )) to iID
53314>>>>>>>        Set piParticleID to iID
53315>>>>>>>        Move (Find_Server_DDO(Self,Baxiokat.File_Number )) to iID
53316>>>>>>>        Set piBaxiokatID to iID
53317>>>>>>>    End_Procedure
53318>>>>>>>
53318>>>>>>>    Procedure Calc_All_The_Fields
53319>>>>>>>        Number  nSynolo nPoso nPososto naxia
53320>>>>>>>        Date    dHmniaPlhromhs dHmniaParalabhs dHmniaTimologiou
53320>>>>>>>        Date    dProkeiptei dProsDate dAddDate dStartDate dEndDate
53320>>>>>>>        Integer iMeresXaritos iMeratouMhna iMeresParalabhs iID iInt iAdd
53320>>>>>>>        Integer iMeresPlhroteo iCode iXhmero iMhnasTimologiou  iMet
53320>>>>>>>
53320>>>>>>>        Get piBaxiokatID                                                to iID
53321>>>>>>>        Get Field_Current_Value Of iID Field Baxiokat.Baxiokat_Code     to iCode
53322>>>>>>>
53322>>>>>>>
53322>>>>>>>        Get piParticleID                                                to iID
53323>>>>>>>        Get Field_Current_Value Of iID Field Particle.Partl_Payam       to nSynolo
53324>>>>>>>        Get Field_Current_Value Of iID Field Particle.Partl_Hmnia       to dHmniaTimologiou
53325>>>>>>>        Get Field_Current_Value        Field TParticl.Pct_Epi_Synolou   to nPososto
53326>>>>>>>        Get Field_Current_Value        Field TParticl.Paralabh_Meres    to iMeresParalabhs
53327>>>>>>>        Get Field_Current_Value        Field TParticl.Xarhtos_Meres     to iMeresXaritos
53328>>>>>>>        Get Field_Current_Value        Field TParticl.Plhroteo_Meres    to iMeresPlhroteo
53329>>>>>>>
53329>>>>>>>        //////////////////////////////////////////////////////////////////////////
53329>>>>>>>        /////        10 (x)     -      10 (y)         /          30 (z)      /////
53329>>>>>>>        /////  iMeresParalabhs    iMeresXaritos              iMeresPlhroteo  /////
53329>>>>>>>        //////////////////////////////////////////////////////////////////////////
53329>>>>>>>
53329>>>>>>>        //  1. Kathorise thn 1h tou mhna, hmeromhniaka
53329>>>>>>>        Move ('01'+'/'+(String(TheMonthSegment(dHmniaTimologiou)))+'/'+;                       (String(TheYearSegment(dHmniaTimologiou)))) to dStartDate
53330>>>>>>>
53330>>>>>>>//        //  2. Vres thn Hmeromhnia paralabhs (Teleytaia hmera tou epomenou y hmerou
53330>>>>>>>//        //     sthn opoia meta tha prosthesoume tis hmeres paralabhs (x) )
53330>>>>>>>//        Move dStartDate to dHmniaParalabhs
53330>>>>>>>//        While (dHmniaParalabhs<(dHmniaTimologiou+iMeresXaritos))
53330>>>>>>>//            Add iMeresXaritos to dHmniaParalabhs
53330>>>>>>>//        Loop
53330>>>>>>>//        Add iMeresParalabhs to dHmniaParalabhs
53330>>>>>>>
53330>>>>>>>//        //  3. Vres thn Hmeromhnia Lhxhs ths epitaghs  (Teleytaia hmera tou trxontos y hmerou
53330>>>>>>>//        //     sthn opoia meta tha prosthesoume tis hmeres plhroteo (z) )
53330>>>>>>>//        Move dStartDate to dHmniaPlhromhs
53330>>>>>>>//        While (dHmniaPlhromhs<dHmniaTimologiou)
53330>>>>>>>//            Add iMeresXaritos to dHmniaPlhromhs
53330>>>>>>>//        Loop
53330>>>>>>>//        Add iMeresPlhroteo  to dHmniaPlhromhs
53330>>>>>>>
53330>>>>>>>        //  2. Vres thn Hmeromhnia  ths teleytaias hmera tou trexontos y hmerou
53330>>>>>>>        Move dStartDate to dHmniaParalabhs
53331>>>>>>>        If (iMeresXaritos<>0) Begin
53333>>>>>>>            While (dHmniaParalabhs<dHmniaTimologiou)
53337>>>>>>>                Add iMeresXaritos   to dHmniaParalabhs
53338>>>>>>>            Loop
53339>>>>>>>>
53339>>>>>>>        End
53339>>>>>>>>
53339>>>>>>>        Move dHmniaParalabhs    to dHmniaPlhromhs
53340>>>>>>>
53340>>>>>>>        Add (iMeresParalabhs-1) to dHmniaParalabhs
53341>>>>>>>        Add (iMeresPlhroteo-1)  to dHmniaPlhromhs
53342>>>>>>>
53342>>>>>>>        // Ypologise prota to poso bash posostou se sxesh me synolo parastatikou
53342>>>>>>>        Move (Round_number((nSynolo*nPososto/100),2))   to naxia
53343>>>>>>>
53343>>>>>>>        Set Field_Changed_Value Field TParticl.Poso     to naxia
53344>>>>>>>        Set Field_Changed_Value Field TParticl.Paralabh to dHmniaParalabhs
53345>>>>>>>        Set Field_Changed_Value Field TParticl.Exoflhsh to dHmniaPlhromhs
53346>>>>>>>
53346>>>>>>>    End_Procedure
53347>>>>>>>
53347>>>>>>>
53347>>>>>>>    Procedure Creating
53348>>>>>>>        Forward Send Creating
53350>>>>>>>        // Insert Code Here
53350>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Tparticl.Tparticl_Rec0))))));                                    to Tparticl.Tparticl_Recr
53351>>>>>>>    End_Procedure   // Creating
53352>>>>>>>
53352>>>>>>>
53352>>>>>>>    Procedure Save_Main_File
53353>>>>>>>        If (tparticl.isok <> '1') move ' ' to tparticl.isok
53356>>>>>>>        If (Operation_Origin<>Self) Begin
53358>>>>>>>            If tparticl.Recnum Eq 0 Procedure_Return
53361>>>>>>>        End
53361>>>>>>>>
53361>>>>>>>      Forward Send Save_Main_File
53363>>>>>>>    End_Procedure   // Save_Main_File
53364>>>>>>>
53364>>>>>>>
53364>>>>>>>    // Define_Fields:
53364>>>>>>>    // This procedure is used to set up all data-dictionary rules.
53364>>>>>>>
53364>>>>>>>    Procedure Define_Fields
53365>>>>>>>        Forward Send Define_Fields
53367>>>>>>>        //DDB-Generated-Code-Location
53367>>>>>>>        //DDB-DefineFieldStart
53367>>>>>>>
53367>>>>>>>        Set Main_File            To Tparticl.File_Number
53368>>>>>>>        Set Cascade_Delete_State To FALSE
53369>>>>>>>
53369>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
53370>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
53371>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53372>>>>>>>
53372>>>>>>>        // Parent (Server) file structure...............
53372>>>>>>>        Send Add_Server_File  Particle.File_Number
53373>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
53374>>>>>>>
53374>>>>>>>        // External (System) file structure.............
53374>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
53375>>>>>>>
53375>>>>>>>        Define_Auto_Increment  Sysrecc.Tparticl_Rec0  To Tparticl.Tparticl_Rec0
53378>>>>>>>
53378>>>>>>>        // Field-based properties.......................
53378>>>>>>>
53378>>>>>>>        // Tparticl.Partl_Recr
53378>>>>>>>
53378>>>>>>>        // Tparticl.Baxiokat_Code
53378>>>>>>>        Set Field_Exit_msg         Field Tparticl.Baxiokat_Code To Calc_All_The_Fields
53379>>>>>>>
53379>>>>>>>        // Tparticl.Pct_Epi_Synolou
53379>>>>>>>        Set Field_Exit_msg         Field Tparticl.Pct_Epi_Synolou To Calc_All_The_Fields
53380>>>>>>>
53380>>>>>>>        // Tparticl.Paralabh_Meres
53380>>>>>>>        Set Field_Exit_msg         Field Tparticl.Paralabh_Meres To Calc_All_The_Fields
53381>>>>>>>
53381>>>>>>>        // Tparticl.Xarhtos_Meres
53381>>>>>>>        Set Field_Exit_msg         Field Tparticl.Xarhtos_Meres To Calc_All_The_Fields
53382>>>>>>>
53382>>>>>>>        // Tparticl.Plhroteo_Meres
53382>>>>>>>        Set Field_Exit_msg         Field Tparticl.Plhroteo_Meres To Calc_All_The_Fields
53383>>>>>>>
53383>>>>>>>        // Tparticl.Tparticl_Rec0
53383>>>>>>>
53383>>>>>>>        // Tparticl.Tparticl_Recr
53383>>>>>>>
53383>>>>>>>        // Tparticl.Mera_Tou_Mhna
53383>>>>>>>        Set Field_Exit_msg         Field Tparticl.Mera_Tou_Mhna To Calc_All_The_Fields
53384>>>>>>>        Set Field_Value_Table      Field Tparticl.Mera_Tou_Mhna To (Mera_Tou_Mhna_VT(Self))
53385>>>>>>>
53385>>>>>>>        // Tparticl.Poso
53385>>>>>>>
53385>>>>>>>        // Tparticl.Paralabh
53385>>>>>>>
53385>>>>>>>        // Tparticl.Exoflhsh
53385>>>>>>>
53385>>>>>>>        // Tparticl.Isok
53385>>>>>>>
53385>>>>>>>        //DDB-DefineFieldEnd
53385>>>>>>>    End_Procedure    // Define_Fields
53386>>>>>>>
53386>>>>>>>    // Field_Defaults:
53386>>>>>>>    // This procedure is used to establish default field values.
53386>>>>>>>
53386>>>>>>>    Procedure Field_Defaults
53387>>>>>>>        Forward Send Field_Defaults
53389>>>>>>>        //DDB-Generated-Code-Location
53389>>>>>>>        //DDB-FieldDefaultStart
53389>>>>>>>        //DDB-FieldDefaultEnd
53389>>>>>>>    End_Procedure    // Field_Defaults
53390>>>>>>>
53390>>>>>>>End_Class    // Tparticl_DataDictionary
53391>>>>>>>//DDB-FileEnd
53391>>>>>    Use PARTLFPA.DD
INCLUDING FILE: PARTLFPA.DD
53391>>>>>>>//DDB-FileStart
53391>>>>>>>//DDB-HeaderStart
53391>>>>>>>
53391>>>>>>>// File Name : PARTLFPA.DD
53391>>>>>>>// Class Name: Partlfpa_DataDictionary
53391>>>>>>>// Revision  : 7
53391>>>>>>>// Version   : 2
53391>>>>>>>
53391>>>>>>>Use  Windows           // Basic Definitions
53391>>>>>>>Use  DataDict          // DataDictionary Class Definition
53391>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
53391>>>>>>>
53391>>>>>>>Open Partlfpa
53393>>>>>>>Open Particle
53395>>>>>>>Open Fpa
53397>>>>>>>
53397>>>>>>>//DDB-HeaderEnd
53397>>>>>>> 
53397>>>>>>>Class Partlfpa_DataDictionary  is a DataDictionary_Sec
53398>>>>>>>
53398>>>>>>>
53398>>>>>>>    // Define_Fields:
53398>>>>>>>    // This procedure is used to set up all data-dictionary rules.
53398>>>>>>>
53398>>>>>>>    Procedure Define_Fields
53399>>>>>>>        Forward Send Define_Fields
53401>>>>>>>        //DDB-Generated-Code-Location
53401>>>>>>>        //DDB-DefineFieldStart
53401>>>>>>>
53401>>>>>>>        Set Main_File            To Partlfpa.File_Number
53402>>>>>>>
53402>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
53403>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
53404>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53405>>>>>>>
53405>>>>>>>        // Parent (Server) file structure...............
53405>>>>>>>        Send Add_Server_File  Particle.File_Number
53406>>>>>>>        Send Add_Server_File  Fpa.File_Number
53407>>>>>>>
53407>>>>>>>        // Field-based properties.......................
53407>>>>>>>
53407>>>>>>>        // Partlfpa.Partl_Recr
53407>>>>>>>
53407>>>>>>>        // Partlfpa.Fpa_Pososto
53407>>>>>>>
53407>>>>>>>        // Partlfpa.Partlfpa_Poso
53407>>>>>>>
53407>>>>>>>        // Partlfpa.Poso_Pro_Ekpt
53407>>>>>>>
53407>>>>>>>        // Partlfpa.Poso_Ekpt
53407>>>>>>>
53407>>>>>>>        // Partlfpa.Poso_Pro_Fpa
53407>>>>>>>
53407>>>>>>>        // Partlfpa.Poso_Fpa
53407>>>>>>>
53407>>>>>>>        // Partlfpa.Poso_Me_Fpa
53407>>>>>>>
53407>>>>>>>        //DDB-DefineFieldEnd
53407>>>>>>>    End_Procedure    // Define_Fields
53408>>>>>>>
53408>>>>>>>    // Field_Defaults:
53408>>>>>>>    // This procedure is used to establish default field values.
53408>>>>>>>
53408>>>>>>>    Procedure Field_Defaults
53409>>>>>>>        Forward Send Field_Defaults
53411>>>>>>>        //DDB-Generated-Code-Location
53411>>>>>>>        //DDB-FieldDefaultStart
53411>>>>>>>        //DDB-FieldDefaultEnd
53411>>>>>>>    End_Procedure    // Field_Defaults
53412>>>>>>>
53412>>>>>>>End_Class    // Partlfpa_DataDictionary
53413>>>>>>>//DDB-FileEnd
53413>>>>>
53413>>>>>    //AB-StoreTopEnd
53413>>>>>
53413>>>>>    //AB-IgnoreStart
53413>>>>>
53413>>>>>    Use Bproces.Sub
53413>>>>>
53413>>>>>
53413>>>>>    //AB-IgnoreEnd
53413>>>>>
53413>>>>>    Object Psx_Array is a BusinessProcessSub
53415>>>>>
53415>>>>>        //AB-StoreTopStart
53415>>>>>
53415>>>>>        Property    String  psParticleRecr0 Public ''
53417>>>>>        Property    String  psPsxetikaRecr0 Public ''
53419>>>>>        Property    String  psClient_Desc   Public ''
53421>>>>>        Property    String  psPtyppar_Desc  Public ''
53423>>>>>        Property    String  psSeira_Seira   Public ''
53425>>>>>        Property    Date    pdPartl_Hmnia   Public ''
53427>>>>>        Property    Integer piPartl_No      Public  0
53429>>>>>        Property    Number  pnPosothta      Public  0
53431>>>>>
53431>>>>>        Object Ctypkin_DD2 is a Ctypkin_DataDictionary
53433>>>>>        End_Object    // Ctypkin_DD2
53434>>>>>
53434>>>>>        Object Wtypkin_DD2 is a Wtypkin_DataDictionary
53436>>>>>        End_Object    // Wtypkin_DD2
53437>>>>>
53437>>>>>        Object Ptyppar_DD2 is a Ptyppar_DataDictionary
53439>>>>>            Set DDO_Server to (Ctypkin_DD2(self))
53440>>>>>            Set DDO_Server to (Wtypkin_DD2(self))
53441>>>>>        End_Object    // Ptyppar_DD2
53442>>>>>
53442>>>>>        Object Country_DD2 is a Country_DataDictionary
53444>>>>>        End_Object    // Country_DD2
53445>>>>>
53445>>>>>        Object Towns_DD2 is a Towns_DataDictionary
53447>>>>>            Set DDO_Server to (Country_DD2(self))
53448>>>>>        End_Object    // Towns_DD2
53449>>>>>
53449>>>>>        Object Cities_DD2 is a Cities_DataDictionary
53451>>>>>            Set DDO_Server to (Towns_DD2(self))
53452>>>>>        End_Object    // Cities_DD2
53453>>>>>
53453>>>>>        Object Areas_DD2 is a Areas_DataDictionary
53455>>>>>        End_Object    // Areas_DD2
53456>>>>>
53456>>>>>        Object Payresp_DD2 is a Payresp_DataDictionary
53458>>>>>        End_Object    // Payresp_DD2
53459>>>>>
53459>>>>>        Object Clients_DD2 is a Clients_DataDictionary
53461>>>>>            Set DDO_Server to (Cities_DD2(self))
53462>>>>>            Set DDO_Server to (Areas_DD2(self))
53463>>>>>            Set DDO_Server to (Payresp_DD2(self))
53464>>>>>        End_Object    // Clients_DD2
53465>>>>>
53465>>>>>        Object Nomisma_DD2 is a Nomisma_DataDictionary
53467>>>>>        End_Object    // Nomisma_DD2
53468>>>>>
53468>>>>>        Object Particle_DD2 is a Particle_DataDictionary
53470>>>>>            Set DDO_Server to (Clients_DD2(self))
53471>>>>>            Set DDO_Server to (Ptyppar_DD2(self))
53472>>>>>            Set DDO_Server to (Nomisma_DD2(self))
53473>>>>>        End_Object    // Particle_DD2
53474>>>>>
53474>>>>>
53474>>>>>        /////////////////////////////////////////////
53474>>>>>
53474>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
53476>>>>>        End_Object    // Ctypkin_DD
53477>>>>>
53477>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
53479>>>>>        End_Object    // Wtypkin_DD
53480>>>>>
53480>>>>>        Object Ptyppar_DD is a Ptyppar_DataDictionary
53482>>>>>            Set DDO_Server to (Ctypkin_DD(self))
53483>>>>>            Set DDO_Server to (Wtypkin_DD(self))
53484>>>>>        End_Object    // Ptyppar_DD
53485>>>>>
53485>>>>>        Object Country_DD is a Country_DataDictionary
53487>>>>>        End_Object    // Country_DD
53488>>>>>
53488>>>>>        Object Towns_DD is a Towns_DataDictionary
53490>>>>>            Set DDO_Server to (Country_DD(self))
53491>>>>>        End_Object    // Towns_DD
53492>>>>>
53492>>>>>        Object Cities_DD is a Cities_DataDictionary
53494>>>>>            Set DDO_Server to (Towns_DD(self))
53495>>>>>        End_Object    // Cities_DD
53496>>>>>
53496>>>>>        Object Areas_DD is a Areas_DataDictionary
53498>>>>>        End_Object    // Areas_DD
53499>>>>>
53499>>>>>        Object Payresp_DD is a Payresp_DataDictionary
53501>>>>>        End_Object    // Payresp_DD
53502>>>>>
53502>>>>>        Object Clients_DD is a Clients_DataDictionary
53504>>>>>            Set DDO_Server to (Cities_DD(self))
53505>>>>>            Set DDO_Server to (Areas_DD(self))
53506>>>>>            Set DDO_Server to (Payresp_DD(self))
53507>>>>>        End_Object    // Clients_DD
53508>>>>>
53508>>>>>        Object Nomisma_DD is a Nomisma_DataDictionary
53510>>>>>        End_Object    // Nomisma_DD
53511>>>>>
53511>>>>>        Object Particle_DD is a Particle_DataDictionary
53513>>>>>            Set DDO_Server to (Clients_DD(self))
53514>>>>>            Set DDO_Server to (Ptyppar_DD(self))
53515>>>>>            Set DDO_Server to (Nomisma_DD(self))
53516>>>>>        End_Object    // Particle_DD
53517>>>>>
53517>>>>>        Object Psxetika_DD is a Psxetika_DataDictionary
53519>>>>>            Set DDO_Server      to (Particle_DD(self))
53520>>>>>            Set Constrain_File  to Particle.File_Number
53521>>>>>        End_Object
53522>>>>>
53522>>>>>
53522>>>>>        //AB-StoreTopEnd
53522>>>>>
53522>>>>>        Set Size to 60 100
53523>>>>>
53523>>>>>        //AB-DDOStart
53523>>>>>
53523>>>>>
53523>>>>>        //AB-DDOEnd
53523>>>>>
53523>>>>>
53523>>>>>        //AB-StoreStart
53523>>>>>
53523>>>>>        Procedure Find_Sxetika_Data String asParentRecr
53525>>>>>            String  sClient_Desc sPtyppar_Desc sPseira_Seira
53526>>>>>            Date    dPartl_Hmnia
53526>>>>>            Integer iPartl_No
53526>>>>>
53526>>>>>            Send Clear          to Particle_DD2
53527>>>>>            Move asParentRecr   to Particle.Partl_Recr
53528>>>>>            Send Find           to Particle_DD2 Eq 2
53529>>>>>
53529>>>>>            Get Field_Current_Value Of Clients_DD2  Field Clients.Client_Name   to sClient_Desc
53530>>>>>            Get Field_Current_Value Of Ptyppar_DD2  Field Ptyppar.Ptyppar_Descr to sPtyppar_Desc
53531>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Pseira_Seira to sPseira_Seira
53532>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Partl_Hmnia  to dPartl_Hmnia
53533>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Partl_No     to iPartl_No
53534>>>>>
53534>>>>>            Set psPtyppar_Desc      to sPtyppar_Desc
53535>>>>>            Set psClient_Desc       to sClient_Desc
53536>>>>>            Set psSeira_Seira       to sPseira_Seira
53537>>>>>            Set pdPartl_Hmnia       to dPartl_Hmnia
53538>>>>>            Set piPartl_No          to iPartl_No
53539>>>>>        End_Procedure
53540>>>>>
53540>>>>>
53540>>>>>        Procedure Make_The_Record
53542>>>>>
53542>>>>>            Set psPtyppar_Desc      to ''
53543>>>>>            Set psClient_Desc       to ''
53544>>>>>            Set psSeira_Seira       to ''
53545>>>>>            Set pdPartl_Hmnia       to ''
53546>>>>>            Set piPartl_No          to 0
53547>>>>>
53547>>>>>            Clear Psxetika
53548>>>>>            Move (psParticleRecr0(Self)) to Psxetika.Partl_Recr
53549>>>>>            Move (psPsxetikaRecr0(Self)) to Psxetika.Psx_Partl_Recr
53550>>>>>            Find Eq Psxetika by index.4
53551>>>>>>
53551>>>>>
53551>>>>>            If (Not(Found)) Begin
53553>>>>>
53553>>>>>                Send Find_Sxetika_Data (psPsxetikaRecr0(Self))
53554>>>>>
53554>>>>>                Send Clear to Particle_DD
53555>>>>>                Send Clear to Psxetika_DD
53556>>>>>
53556>>>>>                // Vres ton mpampa
53556>>>>>                Move (psParticleRecr0(Self)) to Particle.Partl_Recr
53557>>>>>                Send Find to Particle_DD Eq 2
53558>>>>>
53558>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Psx_Partl_Recr    ;                                                to (psPsxetikaRecr0(Self))
53559>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Client_Desc    ;                                                to (psClient_Desc(Self))
53560>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Ptyppar_Desc   ;                                                to (psPtyppar_Desc(Self))
53561>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_Hmnia    ;                                                to (pdPartl_Hmnia(Self))
53562>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_No       ;                                                to (piPartl_No(Self))
53563>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.SX_Pseira_Seira   ;                                                to (psSeira_Seira(Self))
53564>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Pms_Sx_Qty        ;                                                to (pnPosothta(Self))
53565>>>>>
53565>>>>>                Send Request_Save               to Psxetika_DD
53566>>>>>
53566>>>>>
53566>>>>>                // Make also 2nd Record
53566>>>>>                Clear Psxetika
53567>>>>>                Move (psPsxetikaRecr0(Self)) to Psxetika.Partl_Recr
53568>>>>>                Move (psParticleRecr0(Self)) to Psxetika.Psx_Partl_Recr
53569>>>>>                Find Eq Psxetika by index.4
53570>>>>>>
53570>>>>>
53570>>>>>                If (Not(Found)) Begin
53572>>>>>
53572>>>>>                    Send Find_Sxetika_Data (psParticleRecr0(Self))
53573>>>>>
53573>>>>>                    Send Clear to Particle_DD
53574>>>>>                    Send Clear to Psxetika_DD
53575>>>>>
53575>>>>>                    Move (psPsxetikaRecr0(Self)) to Particle.Partl_Recr
53576>>>>>                    Send Find to Particle_DD Eq 2
53577>>>>>
53577>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Psx_Partl_Recr    ;                                                    to (psParticleRecr0(Self))
53578>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Client_Desc    ;                                                    to (psClient_Desc(Self))
53579>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Ptyppar_Desc   ;                                                    to (psPtyppar_Desc(Self))
53580>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_Hmnia    ;                                                    to (pdPartl_Hmnia(Self))
53581>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_No       ;                                                    to (piPartl_No(Self))
53582>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.SX_Pseira_Seira   ;                                                    to (psSeira_Seira(Self))
53583>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Pms_Sx_Qty        ;                                                    to (pnPosothta(Self))
53584>>>>>                    Send Request_Save               to Psxetika_DD
53585>>>>>                End
53585>>>>>>
53585>>>>>            End
53585>>>>>>
53585>>>>>        End_Procedure
53586>>>>>
53586>>>>>        //AB-StoreEnd
53586>>>>>
53586>>>>>    End_Object    // Psx_Array
53587>>>>>
53587>>>>>
53587>>>>>    //AB-StoreStart
53587>>>>>
53587>>>>>    //AB-StoreEnd
53587>>>>>
53587>>>>>//AB/     End_Object    // prj
53587>>>
53587>>>        //AB-StoreTopEnd
53587>>>
53587>>>        Set Size to 60 100
53588>>>        Set Location to 18 17
53589>>>
53589>>>        //AB-DDOStart
53589>>>
53589>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
53591>>>        End_Object    // Ctypkin_DD
53592>>>
53592>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
53594>>>        End_Object    // Wtypkin_DD
53595>>>
53595>>>        Object Ptyppar_DD is a Ptyppar_DataDictionary
53597>>>            Set DDO_Server to (Ctypkin_DD(self))
53598>>>            Set DDO_Server to (Wtypkin_DD(self))
53599>>>        End_Object    // Ptyppar_DD
53600>>>
53600>>>        Object Country_DD is a Country_DataDictionary
53602>>>        End_Object    // Country_DD
53603>>>
53603>>>        Object Towns_DD is a Towns_DataDictionary
53605>>>            Set DDO_Server to (Country_DD(self))
53606>>>        End_Object    // Towns_DD
53607>>>
53607>>>        Object Cities_DD is a Cities_DataDictionary
53609>>>            Set DDO_Server to (Towns_DD(self))
53610>>>        End_Object    // Cities_DD
53611>>>
53611>>>        Object Areas_DD is a Areas_DataDictionary
53613>>>        End_Object    // Areas_DD
53614>>>
53614>>>        Object Payresp_DD is a Payresp_DataDictionary
53616>>>        End_Object    // Payresp_DD
53617>>>
53617>>>        Object Clients_DD is a Clients_DataDictionary
53619>>>            Set DDO_Server to (Cities_DD(self))
53620>>>            Set DDO_Server to (Areas_DD(self))
53621>>>            Set DDO_Server to (Payresp_DD(self))
53622>>>        End_Object    // Clients_DD
53623>>>
53623>>>        Object Nomisma_DD is a Nomisma_DataDictionary
53625>>>        End_Object    // Nomisma_DD
53626>>>
53626>>>        Object Particle_DD is a Particle_DataDictionary
53628>>>            Set DDO_Server to (Clients_DD(self))
53629>>>            Set DDO_Server to (Ptyppar_DD(self))
53630>>>            Set DDO_Server to (Nomisma_DD(self))
53631>>>        End_Object    // Particle_DD
53632>>>
53632>>>        Object Psxetika_DD is a Psxetika_DataDictionary
53634>>>            Set DDO_Server to (Particle_DD(self))
53635>>>        End_Object    // Psxetika_DD
53636>>>
53636>>>
53636>>>        //AB-DDOEnd
53636>>>
53636>>>
53636>>>        //AB-StoreStart
53636>>>
53636>>>        Procedure OnProcess
53638>>>            String  sParticleRecr sSxPartlRecr
53639>>>            Number  nQty nQty1
53639>>>            Get psParticleRecr  to sParticleRecr
53640>>>            Get psSxPartlRecr   to sSxPartlRecr
53641>>>            Get pnQty           to nQty
53642>>>
53642>>>            If ((sParticleRecr<>'') And (sSxPartlRecr<>'') And (nQty<>0)) Begin
53644>>>                Send Clear          to Psxetika_DD
53645>>>                Move sParticleRecr  to Psxetika.Partl_Recr
53646>>>                Move sSxPartlRecr   to Psxetika.Psx_Partl_Recr
53647>>>                Send Request_Find   to Psxetika_DD Eq Psxetika.File_Number 4
53648>>>                If (Found) Begin
53650>>>                    Get Field_Current_Value Of Psxetika_DD Field Psxetika.Pms_Sx_Qty to nQty1
53651>>>                    Add nQty to nQty1
53652>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Pms_Sx_Qty to nQty1
53653>>>                    Send Request_Save to Psxetika_DD
53654>>>                End
53654>>>>
53654>>>            End
53654>>>>
53654>>>
53654>>>        End_Procedure
53655>>>
53655>>>        Procedure OnError integer error_info string errMsg
53657>>>        End_Procedure
53658>>>
53658>>>        Procedure Start_Process
53660>>>            Forward Send Start_Process
53662>>>        End_Procedure
53663>>>
53663>>>        Procedure End_Process
53665>>>            Forward Send End_Process
53667>>>
53667>>>        End_Procedure
53668>>>
53668>>>        //AB-StoreEnd
53668>>>
53668>>>    End_Object    // bpMakeSx
53669>>>
53669>>>
53669>>>    //AB-StoreStart
53669>>>
53669>>>
53669>>>
53669>>>
53669>>>
53669>>>
53669>>>    //AB-StoreEnd
53669>>>
53669>>>//AB/     End_Object    // prj
53669>        
53669>        Open Nomisma
53671>        Open Isotimia
53673>        
53673>        
53673>        
53673>        Function fngConvertPoso Global String asNomismaCodeApo Number anPoso ;                                       String asNomismaCodeSe  Date   adHmnia;                                       Number nIsotimia  Returns Number
53674>        
53674>            Number rVal nApo_Euro_Isot nSe_Euro_Isot
53675>            Integer iApo_Einai_Euro_Zone iApo_Einai_DRX iApo_Einai_Euro iDekadika_Apo
53675>            Integer iSe_Einai_Euro_Zone  iSe_Einai_DRX  iSe_Einai_Euro  iDekadika_Se
53675>            String  sCode
53675>        
53675>            If (asNomismaCodeApo=asNomismaCodeSe) Function_Return anPoso
53678>        
53678>            Clear Nomisma
53679>            Move (Trim(asNomismaCodeApo)) to Nomisma.Nomisma_Code
53680>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
53681>            Move Nomisma.Euro_Zone      to iApo_Einai_Euro_Zone
53682>            Move Nomisma.Einai_DRX      to iApo_Einai_DRX
53683>            Move Nomisma.Einai_EURO     to iApo_Einai_Euro
53684>            Move Nomisma.KL_ISOT_EURO   to nApo_Euro_Isot
53685>            Move Nomisma.Dekadika       to iDekadika_Apo
53686>            // 1. An to nomisma APO den einai ths zonhs euro prepei na vrethei h isotimia tou
53686>            If ((NOT(iApo_Einai_Euro_Zone)) And (nApo_Euro_Isot=0))  Begin
53688>                If (adHmnia='') Sysdate            adHmnia
53691>                Move (Trim(asNomismaCodeApo))   to sCode
53692>                Clear Isotimia
53693>                Move sCode                      to Isotimia.Nomisma_Code
53694>                Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
53695>                Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
53696>                Move Isotimia.Isotimia_Euro     to nApo_Euro_Isot
53697>            End
53697>        
53697>            Clear Nomisma
53698>            Move (Trim(asNomismaCodeSe)) to Nomisma.Nomisma_Code
53699>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
53700>            Move Nomisma.Euro_Zone      to iSe_Einai_Euro_Zone
53701>            Move Nomisma.Einai_DRX      to iSe_Einai_DRX
53702>            Move Nomisma.Einai_EURO     to iSe_Einai_Euro
53703>            Move Nomisma.KL_ISOT_EURO   to nSe_Euro_Isot
53704>            Move Nomisma.Dekadika       to iDekadika_Se
53705>            // 2. An to nomisma SE den einai ths zonhs euro prepei na vrethei h isotimia tou
53705>            If ((NOT(iSe_Einai_Euro_Zone)) And (nSe_Euro_Isot=0)) Begin
53707>                If (adHmnia='') Sysdate            adHmnia
53710>                Move (Trim(asNomismaCodeSe))    to sCode
53711>                Clear Isotimia
53712>                Move sCode                      to Isotimia.Nomisma_Code
53713>                Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
53714>                Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
53715>                Move Isotimia.Isotimia_Euro     to nSe_Euro_Isot
53716>            End
53716>        
53716>            Calc (anPoso/nApo_Euro_Isot) to rVal
53717>            Move (Round_Number(rVal,6)) to rVal
53718>            Calc (rVal*nSe_Euro_Isot) to rVal
53719>            Move (Round_Number(rVal,iDekadika_Se)) to rVal
53720>        
53720>            Function_Return rVal
53721>        End_Function
53722>        
53722>        
53722>        //AB-ClientStoreTopEnd
53722>
53722>        //  Include all views
53722>        Use ChkClnt.VW                                                                      
INCLUDING FILE: CHKCLNT.VW
53722>>>//AB/ Project ChkClnt
53722>>>//AB/     Object prj is a View_Project
53722>>>//AB/         Set ProjectName to "ChkClnt"
53722>>>//AB/         Set ProjectFileName to "ChkClnt.VW"
53722>>>//AB/         Set GenerateFileName to "NONAME"
53722>>>
53722>>>// Project Object Structure
53722>>>//   ChkClnt is a dbViewSubs
53722>>>//     oOpenFile is a OpenDialog
53722>>>//     frmFileName is a FormSub
53722>>>//     TextBoxSub1 is a TextBoxSub
53722>>>//     ButtonSub1 is a ButtonSub
53722>>>//     ChkEnhmerosh is a CheckBoxSub
53722>>>
53722>>>// Register all objects
53722>>>Register_Object ButtonSub1
53722>>>Register_Object ChkClnt
53722>>>Register_Object ChkEnhmerosh
53722>>>Register_Object frmFileName
53722>>>Register_Object oOpenFile
53722>>>Register_Object TextBoxSub1
53722>>>
53722>>>
53722>>>//AB/     AppBuild VIEW
53722>>>
53722>>>
53722>>>    //AB-StoreTopStart
53722>>>            
53722>>>    Open Clients
53724>>>    
53724>>>    //AB-StoreTopEnd
53724>>>
53724>>>    //AB-IgnoreStart
53724>>>
53724>>>    Use dbViews.Sub
INCLUDING FILE: DBVIEWS.SUB
53724>>>>>Open Oth 
53726>>>>>Open GrpAct
INCLUDING FILE: GRPACT.FD
53728>>>>>Open GrpAct0
INCLUDING FILE: GRPACT0.FD
53730>>>>>
53730>>>>>Class DbviewSubs Is A DbviewSub
53731>>>>>
53731>>>>>    Procedure Construct_Object
53732>>>>>        Integer iPos iCount
53733>>>>>        Forward Send Construct_Object
53735>>>>>
53735>>>>>        Property String     psMyViewName        Public ''
53736>>>>>        Property Integer    piMyViewID          Public  0
53737>>>>>        Property Integer    piDoNotActivateView Public  0
53738>>>>>
53738>>>>>        Get Name            to gsViewName
53739>>>>>        Get Object_ID       to giViewID
53740>>>>>
53740>>>>>        Move 0 to iPos
53741>>>>>        For iCount From 1 to (Length(gsViewName))
53747>>>>>>
53747>>>>>            If (Mid(gsViewName,1,iCount)='.') Move iCount to iPos
53750>>>>>        Loop
53751>>>>>>
53751>>>>>        Move (Right(gsViewName,(Length(gsViewName)-iPos))) to gsViewName
53752>>>>>        Move (Trim(gsViewName)) to gsViewName
53753>>>>>
53753>>>>>        Set psMyViewName    to (Trim(gsViewName))
53754>>>>>        Set piMyViewID      to giViewID
53755>>>>>
53755>>>>>    End_Procedure
53756>>>>>
53756>>>>>    Procedure End_Construct_Object
53757>>>>>        Integer iFileNumber iFieldNumber iUser iColor iLimit iBase iCurr iCol iDeo iPos
53758>>>>>        Integer iObj iPrototype iColumn iItem iInt iFieldStatus iCurCol iCount
53758>>>>>        String  sFileName sFieldName sUser sRecr sStr sDbFormName sViewLabel sDeo svn
53758>>>>>
53758>>>>>        Forward Send End_Construct_Object
53760>>>>>
53760>>>>>        Get psMyViewName        to gsViewName
53761>>>>>        Get piMyViewID          to giViewID
53762>>>>>        Get Label Of giViewID   to sViewLabel
53763>>>>>        Move (Trim(sViewLabel)) to sViewLabel
53764>>>>>
53764>>>>>        Clear Oth
53765>>>>>        Move gsViewName to Oth.View_Name
53766>>>>>        Find eq Oth By Index.2 // Oth:Index.2:View_Name
53767>>>>>>
53767>>>>>        If (Not(Found)) Begin
53769>>>>>            Move sViewLabel to Oth.View_Label
53770>>>>>            Move giViewID   to Oth.View_ID
53771>>>>>            Saverecord Oth
53772>>>>>        End
53772>>>>>>
53772>>>>>
53772>>>>>//        Set piDoNotActivateView to 0
53772>>>>>//        Send DisableActivateView
53772>>>>>
53772>>>>>    End_Procedure //End_Construct_Object
53773>>>>>
53773>>>>>    Procedure Activate_View Returns Integer
53774>>>>>        String  lsLogin
53775>>>>>        String sLektiko
53775>>>>>        Integer liUser iGroup rVal
53775>>>>>        Set piDoNotActivateView to 0
53776>>>>>        Send DisableActivateView
53777>>>>>        If (piDoNotActivateView(Self)=0) Forward get Msg_Activate_View to rVal
53781>>>>>        Else Move -1 to rVal
53783>>>>>        Procedure_Return rVal
53784>>>>>    End_procedure
53785>>>>>
53785>>>>>
53785>>>>>    Procedure DisableActivateView
53786>>>>>        String  lsLogin
53787>>>>>        String sLektiko
53787>>>>>        Integer liUser iGroup rVal
53787>>>>>
53787>>>>>        Move (fsLoginUserID())      to lsLogin
53788>>>>>        Clear Users
53789>>>>>        Move lsLogin    to Users.Login_ID
53790>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
53791>>>>>>
53791>>>>>        If (Found=1)  Begin
53793>>>>>            Move Users.User_ID  to liUser
53794>>>>>            Move Users.Grp_ID   to iGroup
53795>>>>>        End
53795>>>>>>
53795>>>>>        
53795>>>>>        Clear GrpAct
53796>>>>>        Move liUser                 to GrpAct.User_ID
53797>>>>>        Move (psMyViewName(Self))   to GrpAct.View_Name
53798>>>>>        Find Eq GrpAct By Index.1
53799>>>>>>
53799>>>>>        If (Found) Begin
53801>>>>>            If (GrpAct.Allow=0) Begin
53803>>>>>                Set piDoNotActivateView to 1
53804>>>>>                Move "€¤œ§˜¨¡ã › ˜¡ é£˜«˜ •¨ã©«ž š ˜ œ¤œ¨š¦§¦åž©ž «¦¬ §˜¨˜Ÿç¨¦¬\n„§ ¡¦ ¤à¤ã©«œ £œ «¦¤ ƒ ˜®œ ¨ ©«ã «¦¬ ©¬©«ã£˜«¦ª" to sLektiko
53805>>>>>                Send Stop_Box sLektiko "Error 30001"
53806>>>>>                Procedure_Return -1
53807>>>>>            End
53807>>>>>>
53807>>>>>        End
53807>>>>>>
53807>>>>>
53807>>>>>        Clear GrpAct0
53808>>>>>        Move iGroup                 to GrpAct0.Group_ID
53809>>>>>        Move (psMyViewName(Self))   to GrpAct0.View_Name
53810>>>>>        Find Eq GrpAct0 By Index.1
53811>>>>>>
53811>>>>>        If ((Found) And (GrpAct0.Allow=0)) Begin
53813>>>>>            Set piDoNotActivateView to 1
53814>>>>>            Move "€¤œ§˜¨¡ã › ˜¡ é£˜«˜ Ž£á›˜ª š ˜ œ¤œ¨š¦§¦åž©ž «¦¬ §˜¨˜Ÿç¨¦¬\n„§ ¡¦ ¤à¤ã©«œ £œ «¦¤ ƒ ˜®œ ¨ ©«ã «¦¬ ©¬©«ã£˜«¦ª" to sLektiko
53815>>>>>            Send Stop_Box sLektiko "Error 30002"
53816>>>>>            Procedure_Return -1
53817>>>>>        End
53817>>>>>>
53817>>>>>    End_procedure
53818>>>>>
53818>>>>>
53818>>>>>End_Class //dbviewSubs
53819>>>>>
53819>>>>>
53819>>>    Use DFAllEnt.pkg
53819>>>    Use Form.Sub
53819>>>    Use Txtbox.Sub
53819>>>    Use Button.Sub
53819>>>    Use Chkbox.Sub
53819>>>
53819>>>    //AB-IgnoreEnd
53819>>>
53819>>>    ACTIVATE_VIEW Activate_ChkClnt FOR ChkClnt
53823>>>
53823>>>    Object ChkClnt is a dbViewSubs
53825>>>
53825>>>        //AB-StoreTopStart
53825>>>                            
53825>>>        Property Integer    piCount                 Public  0
53827>>>        
53827>>>        Set Verify_Exit_Msg         to Get_No_Confirmation
53828>>>        Set Verify_Save_Msg         to Get_No_Confirmation
53829>>>        Set Verify_Data_Loss_Msg    to Get_No_Confirmation
53830>>>        
53830>>>        
53830>>>        //AB-StoreTopEnd
53830>>>
53830>>>        Set Label to "„¢œš®¦ª œ¢˜«¦¢¦šå¦¬ š ˜ «¦ Status «¦¬ª ©«¦ SAP"
53831>>>        Set Size to 74 399
53832>>>        Set Location to 9 7
53833>>>
53833>>>        //AB-DDOStart
53833>>>
53833>>>
53833>>>        //AB-DDOEnd
53833>>>
53833>>>        Object oOpenFile is a OpenDialog
53835>>>            Set Location to 1 336
53836>>>
53836>>>            //AB-StoreStart
53836>>>            Set Filter_String   to 'Text Files|*.txt;*.csv|All Files|*.*'
53837>>>            Set Initial_Folder  to 'C:\VDF6\Develop\Empor'
53838>>>            Set Filter_Index    to 1
53839>>>            
53839>>>            
53839>>>            //AB-StoreEnd
53839>>>
53839>>>        End_Object    // oOpenFile
53840>>>
53840>>>        Object frmFileName is a FormSub
53842>>>            Set Size to 13 321
53843>>>            Set Location to 6 63
53844>>>            Set Label_Col_Offset to 2
53845>>>            Set Label_Justification_Mode to jMode_Right
53846>>>            Set Prompt_Button_Mode to pb_PromptOn
53847>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
53848>>>
53848>>>            //AB-StoreStart
53848>>>                                                                                    
53848>>>            Procedure Prompt
53850>>>                String  sFileName
53851>>>                Integer bOpen
53851>>>                Get Show_Dialog of oOpenFile To bOpen
53852>>>                If bOpen Begin
53854>>>                    Get File_Name of oOpenFile to sFileName
53855>>>                    If (Trim(sFileName)<>'') Set Value Item 0 to sFileName
53858>>>                End
53858>>>>
53858>>>            End_Procedure
53859>>>            
53859>>>            
53859>>>            //AB-StoreEnd
53859>>>
53859>>>        End_Object    // frmFileName
53860>>>
53860>>>        Object TextBoxSub1 is a TextBoxSub
53862>>>            Set Label to "„§ ¢¦šã ˜¨®œå¦¬"
53863>>>            Set Location to 7 5
53864>>>            Set Size to 10 55
53865>>>            Set TypeFace to "MS Sans Serif"
53866>>>        End_Object    // TextBoxSub1
53867>>>
53867>>>        Object ButtonSub1 is a ButtonSub
53869>>>            Set Label to "„¢œš®¦ª"
53870>>>            Set Size to 14 321
53871>>>            Set Location to 40 63
53872>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
53873>>>
53873>>>            //AB-StoreStart
53873>>>            
53873>>>            Procedure OnClick
53875>>>                Integer iFileRetreived iMetr iRecnum isFound iStat
53876>>>                Integer iID iMet iFileExists isChecked
53876>>>                String  sFile sClient sLabel sLine
53876>>>                Date dHmnia
53876>>>                Sysdate dHmnia
53877>>>            
53877>>>                Get Label to sLabel
53878>>>                Get Checked_State Of chkEnhmerosh to isChecked
53879>>>            
53879>>>                Get Value Of frmFileName Item 0 to sFile
53880>>>                Move (Trim(sFile))              to sFile
53881>>>            
53881>>>                If (sFile='') Begin
53883>>>                    Send Stop_Box 'ƒœ¤ œ§ ¢â¥˜«œ ˜¨®œå¦' '¢ž¨¦­¦¨å˜'
53884>>>                    Procedure_Return
53885>>>                End
53885>>>>
53885>>>            
53885>>>                Get Get_File_Exists sFile       to iFileExists
53886>>>                If (NOT(iFileExists)) Begin
53888>>>                    Send Stop_Box "ƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦" '¢ž¨¦­¦¨å˜'
53889>>>                    Procedure_Return
53890>>>                End
53890>>>>
53890>>>            
53890>>>                Direct_Output Channel 8 "C:\VDF6\Develop\Empor\Protem_Clients.txt"
53892>>>            
53892>>>                Direct_Input Channel 9 sFile
53894>>>                Move 0 to iMetr
53895>>>                Read    Channel 9 sLine
53897>>>                Readln  Channel 9
53899>>>                If (Seqeof) Begin
53901>>>                    Send Info_Box '’¦ ˜¨®œå¦ œå¤˜  á›œ ¦' '¢ž¨¦­¦¨å˜'
53902>>>                    Procedure_Return
53903>>>                End
53903>>>>
53903>>>            
53903>>>                While (NOT(Seqeof))
53907>>>                    Add 1 to iMet
53908>>>                    Move (Trim(Left(sLine,10)))  to sClient
53909>>>                    Move (Insert(".",sClient,3)) to sClient
53910>>>                    Move (Insert(".",sClient,6)) to sClient
53911>>>                    Move (Trim(sClient))         to sClient
53912>>>            
53912>>>                    // SOS REMOVE ME AFTER TESTING
53912>>>                    //If (Length(sClient)=12) Move (Replace("Z1.0",sClient,"Z1.")) to sClient
53912>>>                    // SOS REMOVE ME AFTER TESTING
53912>>>            
53912>>>                    // Tora exoume ton kodika se morfh 01.A1.010744
53912>>>                    // Alla ta excel einai me kodiko pelath SAP o opoios exei
53912>>>                    // 6 psifia kai oxi 5 pou dinoume emeis, opote prepei na fygei to proto 0
53912>>>                    String s6prota s7prota
53912>>>                    Move (Left(sClient,6)) to s6prota
53913>>>                    Move (Left(sClient,7)) to s7prota
53914>>>                    Move (Replace(s7prota,sClient,s6Prota)) to sClient
53915>>>            
53915>>>                    //Showln sClient
53915>>>            
53915>>>            
53915>>>                    Clear Clients
53916>>>                    Move (Trim(sClient)) to Clients.Client_ID
53917>>>                    Find Eq Clients By Index.6
53918>>>>
53918>>>                    If (Not(Found)) Begin
53920>>>                        Write   Channel 8 (Trim(sClient)) "   Not Found in Clients File"
53923>>>                        Writeln Channel 8
53925>>>                    End
53925>>>>
53925>>>                    Else Begin
53926>>>                        String sLab
53926>>>                        Set Label to (Trim(sClient)+"  "+Trim(Clients.Client_Name))
53927>>>                        Move "" to sLab
53928>>>                             If (Trim(Clients.Status)= "") Move "** Status Keno => New      Client NOT exported " to sLab
53931>>>                        Else If (Trim(Clients.Status)="1") Move "** Status 1    => Modified Client NOT exported " to sLab
53935>>>                        Else If (Trim(Clients.Status)="2") Move "   Status 2    => New      Client     exported " to sLab
53939>>>                        Else If (Trim(Clients.Status)="3") Move "   Status 3    => Modified Client     exported " to sLab
53943>>>                        Write   Channel 8 (Trim(sClient)) "  " (pad(sLab,50)) "  Hmnia=" (Trim(Clients.Client_Hmnia)) "  LastUpd=" (Trim(Clients.Client_LastUpd)) "  SapHmnia=" (Trim(Clients.Sap_Hmnia))
53953>>>                        Writeln Channel 8
53955>>>                        If ((isChecked) And ((Clients.Status="") Or (Clients.Status="1"))) Begin
53957>>>                            Reread Clients
53961>>>                            Move 2      to Clients.Status
53962>>>                            Move dHmnia to Clients.Sap_Hmnia
53963>>>                            Saverecord Clients
53964>>>                        End
53964>>>>
53964>>>                    End
53964>>>>
53964>>>            
53964>>>            
53964>>>                    Read    Channel 9 sLine
53966>>>                    Readln  Channel 9
53968>>>                Loop
53969>>>>
53969>>>                Close_Output Channel 8
53971>>>                Close_Input  Channel 9
53973>>>                Send Info_Box '† ¢ã¯ž §˜¨˜©«˜« ¡é¤ ¦¢¦¡¢ž¨éŸž¡œ' '¢ž¨¦­¦¨å˜'
53974>>>                Set Label to sLabel
53975>>>            End_Procedure // OnClick
53976>>>            
53976>>>            //            Keno=Neos / 1=Modified / 2=Create with exagogh / 3=Modified with exagogh
53976>>>            
53976>>>            
53976>>>            
53976>>>            
53976>>>            
53976>>>            
53976>>>            
53976>>>            
53976>>>            
53976>>>            
53976>>>            //AB-StoreEnd
53976>>>
53976>>>        End_Object    // ButtonSub1
53977>>>
53977>>>        Object ChkEnhmerosh is a CheckBoxSub
53979>>>
53979>>>            //AB-StoreTopStart
53979>>>                                
53979>>>                                
53979>>>            //AB-StoreTopEnd
53979>>>
53979>>>            Set Label to "‹œ œ¤ž£â¨à©ž «¦¬ Status ©«¦ ˜¨®œå¦ Clients"
53980>>>            Set Size to 10 167
53981>>>            Set Location to 25 63
53982>>>
53982>>>            //AB-StoreStart
53982>>>                                
53982>>>            Set Checked_State to False
53983>>>            Set Enabled_State to False
53984>>>            Set Visible_State to False
53985>>>            
53985>>>            
53985>>>            //AB-StoreEnd
53985>>>
53985>>>        End_Object    // ChkEnhmerosh
53986>>>
53986>>>
53986>>>        //AB-StoreStart
53986>>>                            
53986>>>                            
53986>>>                            
53986>>>                            
53986>>>                            
53986>>>                            
53986>>>                            
53986>>>        //AB-StoreEnd
53986>>>
53986>>>    End_Object    // ChkClnt
53987>>>
53987>>>
53987>>>    //AB-StoreStart
53987>>>            
53987>>>            
53987>>>            
53987>>>    //AB-StoreEnd
53987>>>
53987>>>//AB/     End_Object    // prj
53987>
53987>        //AB-ClientStoreStart
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        
53987>        //AB-ClientStoreEnd
53987>
53987>
53987>    End_Object  // Client_Area
53988>    
53988>    On_Key Key_Ctrl+Key_1 Send Activate_ChkClnt To Client_Area
53989>    
53989>    Use DFStdSbr.pkg //  Status-Bar object.
INCLUDING FILE: DFSTDSBR.PKG
53989>>>// 07/23/96 JJT - New Class names
53989>>>// Very prototype global status bar
53989>>>//
53989>>>Use dfMainSt.pkg
INCLUDING FILE: DFMAINST.PKG
53989>>>>>// 07/23/96 JJT - New Class names
53989>>>>>Use dfAstbar.pkg
53989>>>>>
53989>>>>>Class StatusBar is a AppStatusBar
53990>>>>>
53990>>>>>    Procedure Construct_Object
53991>>>>>       Forward Send Construct_Object
53993>>>>>       //
53993>>>>>       Send Add_Item 350  ''     // micro-help
53994>>>>>       Send Add_Item  40  'View:'
53995>>>>>       Set Item_Display_Style To sbNORMAL
53996>>>>>       Send Add_Item 200  ''     // view name
53997>>>>>       Send Add_Item   0  ''     // spring 'normal' to end
53998>>>>>       Set Item_Display_Style To sbNORMAL
53999>>>>>    End_Procedure // Construct_Object
54000>>>>>
54000>>>>>    Procedure Show_View_Name String sName
54001>>>>>        Set Value item 2 to sName
54002>>>>>    End_Procedure
54003>>>>>
54003>>>>>End_Class
54004>>>
54004>>>Object Status_Bar is a StatusBar
54006>>>End_Object
54007>
54007>    //AB-PanelStoreStart
54007>    Use StdAbout.pkg // Standard "About" package.
INCLUDING FILE: STDABOUT.PKG
54007>>>//************************************************************************
54007>>>// Confidential Trade Secret.
54007>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
54007>>>// as an unpublished work.  All rights reserved.
54007>>>// DataFlex is a registered trademark of Data Access Corporation.
54007>>>//
54007>>>//************************************************************************
54007>>>//************************************************************************
54007>>>//
54007>>>// $File name  : StdAbout.pkg
54007>>>// $File title : Standard about object package for VDF
54007>>>// Notice      :
54007>>>// $Author(s)  : John Tuohy
54007>>>//
54007>>>// $Rev History
54007>>>//
54007>>>// JT 06/27/97   File created
54007>>>//************************************************************************
54007>>>
54007>>>// This provides a quick and simple way to create an about package for a program.
54007>>>// You need to create a message inside you client area called Activate_About.
54007>>>// Within this message you should send the message DoAbout passing needed
54007>>>// string information.
54007>>>//
54007>>>//       Procedure Activate_About
54007>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
54007>>>//       End_Procedure
54007>>>//    where: sTitle =     Name of application. If none provided, uses caption
54007>>>//                        bar title
54007>>>//           sVersion   = Version Line. If none provided, will be blank
54007>>>//           sCopyRight = Copyright Line. If none provided, will be blank
54007>>>//           sAuthor    = Author name, blank if none provided
54007>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
54007>>>//                        is used.
54007>>>// It is expected that you will place this in your own object package. For
54007>>>// example an order about package may look like this:
54007>>>//
54007>>>//   // OrderAbout.pkg
54007>>>//   Use StdAbout.pkg
54007>>>//   Procedure Activate_About
54007>>>//      Local String sTitle sCopyright sVersion sAuthor
54007>>>//      Move "My Order Entry System" to sTitle
54007>>>//      Move "Version 2.1" to sVersion
54007>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
54007>>>//      Move "John Smith"  to sAuthor
54007>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
54007>>>//   end_procedure
54007>>>//   // end of file.
54007>>>
54007>>>Use DfAbout.pkg
INCLUDING FILE: DFABOUT.PKG
54007>>>>>//************************************************************************
54007>>>>>// Confidential Trade Secret.
54007>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
54007>>>>>// as an unpublished work.  All rights reserved.
54007>>>>>// DataFlex is a registered trademark of Data Access Corporation.
54007>>>>>//
54007>>>>>//************************************************************************
54007>>>>>//************************************************************************
54007>>>>>//
54007>>>>>// $File name  : DfAbout.pkg
54007>>>>>// $File title : About class support
54007>>>>>// Notice      :
54007>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
54007>>>>>//
54007>>>>>// $Rev History
54007>>>>>//
54007>>>>>// JJT 11/5/98    Added version information
54007>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
54007>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
54007>>>>>//                workspace package.
54007>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
54007>>>>>//                class can create this object.
54007>>>>>//                Cleaned up the interface (used correct classes and messages)
54007>>>>>//                Added workspace reporting support to sys-info.
54007>>>>>//                Turned off wrapping in the sys-info editor.
54007>>>>>// KR  ??/??/96   File created
54007>>>>>//************************************************************************
54007>>>>>Use windows.pkg
54007>>>>>Use DFbitmap.pkg
54007>>>>>
54007>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
54008>>>>>
54008>>>>>//****************************************************************************
54008>>>>>// $Module type: FUNCTION
54008>>>>>// $Module name: Network_User_Name
54008>>>>>// $Author     : AK/VOO/KCR
54008>>>>>// Created     : 24-09-96 @ 19:17
54008>>>>>//
54008>>>>>// Description
54008>>>>>//    This function reads the current username of windows and returns that
54008>>>>>//    name or an text unknown user
54008>>>>>//
54008>>>>>// $Rev History
54008>>>>>//    24-09-96  Module header created
54008>>>>>//****************************************************************************
54008>>>>>Function Network_User_Name Returns String
54010>>>>>    Local String sName sLength
54011>>>>>    Local Pointer lpName_Addr lpLength_Addr
54011>>>>>    Local Integer iRetval
54011>>>>>
54011>>>>>    Movestr (Repeat (Character (0), 255)) To sName
54012>>>>>>
54012>>>>>    GetAddress Of sName To lpName_Addr
54013>>>>>    Movestr (DwordToBytes (255)) To sLength
54014>>>>>>
54014>>>>>    GetAddress Of sLength To lpLength_Addr
54015>>>>>
54015>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
54016>>>>>>
54016>>>>>
54016>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
54019>>>>>    Else Function_Return "User Unknown"
54021>>>>>End_Function // Network_User_Name
54022>>>>>
54022>>>>>Type MEMORYSTATUS
54022>>>>>   Field MEMORYSTATUS.dwLength         As Dword // sizeof(MEMORYSTATUS)
54022>>>>>   Field MEMORYSTATUS.dwMemoryLoad     As Dword // percent of memory in use
54022>>>>>   Field MEMORYSTATUS.dwTotalPhys      As Dword // bytes of physical memory
54022>>>>>   Field MEMORYSTATUS.dwAvailPhys      As Dword // free physical memory bytes
54022>>>>>   Field MEMORYSTATUS.dwTotalPageFile  As Dword // bytes of paging file
54022>>>>>   Field MEMORYSTATUS.dwAvailPageFile  As Dword // free bytes of paging file
54022>>>>>   Field MEMORYSTATUS.dwTotalVirtual   As Dword // user bytes of address space
54022>>>>>   Field MEMORYSTATUS.dwAvailVirtual   As Dword // free user bytes
54022>>>>>End_Type // MEMORYSTATUS
54022>>>>>
54022>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
54023>>>>>
54023>>>>>// If a global workspace object exists it will use this variable to store
54023>>>>>// its object id.
54023>>>>>
54023>>>>>Class SysinfoDisplay Is An Edit
54024>>>>>    Procedure Construct_Object
54025>>>>>        forward send construct_object
54027>>>>>
54027>>>>>        Set Location To 6 6
54028>>>>>        Set Size To 110 255
54029>>>>>        Set Read_Only_State To True
54030>>>>>        Set wrap_state to False
54031>>>>>    end_Procedure
54032>>>>>
54032>>>>>    //****************************************************************************
54032>>>>>    // $Module type: PROCEDURE
54032>>>>>    // $Module name: Add_Line
54032>>>>>    // $Author     : VOO
54032>>>>>    // Created     : 06-10-96 @ 15:23
54032>>>>>    //
54032>>>>>    // Description
54032>>>>>    //    This method will add a line to this edit object, it should go simpler
54032>>>>>    //    but it seems to be done this way.
54032>>>>>    //
54032>>>>>    // $Rev History
54032>>>>>    //    06-10-96  Module header created
54032>>>>>    //****************************************************************************
54032>>>>>    Procedure Add_Line String sVal
54033>>>>>        Local Integer iLine
54034>>>>>
54034>>>>>        Moveint (Line_Count (Current_Object)) To iLine
54035>>>>>>
54035>>>>>        If (iLine = 1 And Changed_State (Current_Object) = False) Moveint 0 To iLine
54038>>>>>        Set Value Item iLine To sVal
54039>>>>>    End_Procedure // Add_Line
54040>>>>>
54040>>>>>    //****************************************************************************
54040>>>>>    // $Module type: PROCEDURE
54040>>>>>    // $Module name: Show_Current_Directory
54040>>>>>    // $Author     : VOO
54040>>>>>    // Created     : 06-10-96 @ 15:24
54040>>>>>    //
54040>>>>>    // Description
54040>>>>>    //    This method will show the name of the current directory in the system
54040>>>>>    //    information box
54040>>>>>    //
54040>>>>>    // $Rev History
54040>>>>>    //    06-10-96  Module header created
54040>>>>>    //****************************************************************************
54040>>>>>    Procedure Show_Current_Directory
54041>>>>>        Local String sDir
54042>>>>>
54042>>>>>        Get_Current_Directory To sDir
54043>>>>>        Send Add_Line ("Current Directory: " + sDir)
54044>>>>>    End_Procedure // Show_Current_Directory
54045>>>>>
54045>>>>>    Procedure Show_Windows_Directory
54046>>>>>        Local String sWindir
54047>>>>>
54047>>>>>        Get_Windows_Directory To sWindir
54048>>>>>        Send Add_Line ("Windows Directory: " * sWindir)
54049>>>>>    End_Procedure // Show_Windows_Directory
54050>>>>>
54050>>>>>    Procedure Show_Current_User
54051>>>>>        Send Add_Line ("Network User Name: " * Network_User_Name (Current_Object))
54052>>>>>    End_Procedure // Show_Current_User
54053>>>>>
54053>>>>>    Procedure Show_Number_Format
54054>>>>>        Local Integer iFormat
54055>>>>>
54055>>>>>        Get_Attribute Df_Thousands_Separator To iFormat
54058>>>>>        Send Add_Line ('Thousands Separator: "' - Character (iFormat) - '" (' - String (iFormat) - ')')
54059>>>>>        Get_Number_Format To iFormat
54060>>>>>        Send Add_Line ('Decimal Separator: "' - If (iFormat = 0, '.', ',') - '"')
54061>>>>>    End_Procedure // Show_Number_Format
54062>>>>>
54062>>>>>    Procedure Show_Filelist_Name
54063>>>>>        Local String sFilename
54064>>>>>
54064>>>>>        Get_Attribute Df_Filelist_Name To sFilename
54067>>>>>        Send Add_Line ("Current Filelist: " * sFilename)
54068>>>>>    End_Procedure // Show_Filelist_Name
54069>>>>>
54069>>>>>    Procedure Show_Lock_Delay
54070>>>>>        Local Integer iLockdelay
54071>>>>>
54071>>>>>        Get_Attribute Df_Lock_Delay To iLockdelay
54074>>>>>        Send Add_Line ("Database Locking Delay: " * String (iLockdelay) * "Milliseconds")
54075>>>>>    End_Procedure // Show_Lock_Delay
54076>>>>>
54076>>>>>    Procedure Show_Lock_Timeout
54077>>>>>        Local Integer iLockTimeout
54078>>>>>
54078>>>>>        Get_Attribute Df_Lock_Timeout To iLockTimeout
54081>>>>>        Send Add_Line ("Database Locking Timeout: " * String (iLockTimeout) * "Milliseconds")
54082>>>>>    End_Procedure // Show_Lock_Timeout
54083>>>>>
54083>>>>>    Procedure Show_Screen_Size
54084>>>>>        Local Integer iYscreensize iXscreensize
54085>>>>>
54085>>>>>        Moveint (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
54086>>>>>>
54086>>>>>        Moveint (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
54087>>>>>>
54087>>>>>
54087>>>>>        Send Add_Line ("Video Resolution: " * String (iXscreensize) * "by" * String (iYscreensize))
54088>>>>>    End_Procedure // Show_Screen_Size
54089>>>>>
54089>>>>>    Procedure Show_Page_Size
54090>>>>>        Send Add_Line ("Page End: " * String (Pageend) * "Form Feed: " * String (Pagefeed))
54091>>>>>    End_procedure
54092>>>>>
54092>>>>>    Procedure Show_Date
54093>>>>>        Local Date dToday
54094>>>>>
54094>>>>>        Sysdate4 dToday
54095>>>>>        Send Add_Line ("Current System Date: " * String (dToday))
54096>>>>>    End_procedure // Show_Date
54097>>>>>
54097>>>>>    Procedure Show_Date_Format
54098>>>>>        Local Integer iDateFormat
54099>>>>>        Local String sDateFormat
54099>>>>>
54099>>>>>        Get_Attribute Df_Date_Format To iDateFormat
54102>>>>>        if iDateFormat Eq DF_DATE_USA ;            Movestr "USA" To sDateFormat
54105>>>>>        else if iDateformat Eq DF_DATE_EUROPEAN ;            Movestr "European" To sDateFormat
54109>>>>>        else if iDateformat Eq DF_DATE_MILITARY ;            Movestr "Military" To sDateFormat
54113>>>>>        else ;            Movestr "Unknown Date Type" To sDateFormat
54115>>>>>        Send Add_Line ("Date Format: " * sDateformat)
54116>>>>>    End_Procedure // Show_Date_Format
54117>>>>>
54117>>>>>    Procedure Show_Memavail
54118>>>>>        Local Integer iMem
54119>>>>>
54119>>>>>        Memory iMem
54120>>>>>>
54120>>>>>        Send Add_Line ("Available Memory: " * String (iMem))
54121>>>>>    End_Procedure // Show_Memavail
54122>>>>>
54122>>>>>    Procedure Show_Systemresources
54123>>>>>        Local String sMemoryStatus
54124>>>>>        Local Pointer lpsMemoryStatus
54124>>>>>        Local Integer iVoid
54124>>>>>        Local Dword dwMemoryLoad dwTotalPhys dwAvailPhys dwTotalPageFile dwAvailPageFile dwTotalVirtual dwAvailVirtual
54124>>>>>
54124>>>>>        ZeroType MEMORYSTATUS To sMemoryStatus
54125>>>>>        GetAddress Of sMemoryStatus To lpsMemoryStatus
54126>>>>>
54126>>>>>        Moveint (GlobalMemoryStatus (lpsMemoryStatus)) To iVoid
54127>>>>>>
54127>>>>>
54127>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwMemoryLoad    To dwMemoryLoad
54128>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPhys     To dwTotalPhys
54129>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPhys     To dwAvailPhys
54130>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPageFile To dwTotalPageFile
54131>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPageFile To dwAvailPageFile
54132>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalVirtual  To dwTotalVirtual
54133>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailVirtual  To dwAvailVirtual
54134>>>>>
54134>>>>>        Send Add_Line ("Current memory utilization:" * String (dwMemoryLoad))
54135>>>>>        Send Add_Line ("Percentage available physical memory:" * String (dwAvailPhys / dwTotalPhys * 100.0) - "%")
54136>>>>>        Send Add_Line ("Percentage available pagefile space:" * String (dwAvailPageFile / dwTotalPageFile * 100.0) - "%")
54137>>>>>        Send Add_Line ("Percentage available virtual memory:" * String (dwAvailVirtual / dwTotalVirtual * 100.0) - "%")
54138>>>>>    End_Procedure // Show_Systemresources
54139>>>>>
54139>>>>>    Procedure Show_Registration
54140>>>>>        Local String sRegName
54141>>>>>        Local Integer iSN
54141>>>>>        Registration sRegName iSN
54142>>>>>>
54142>>>>>
54142>>>>>        Send Add_Line ("Serial# : " + (String(iSN)))
54143>>>>>        Send Add_Line ("Reg Name: " + sRegName)
54144>>>>>
54144>>>>>    End_Procedure // Show_Current_Directory
54145>>>>>
54145>>>>>
54145>>>>>
54145>>>>>    //****************************************************************************
54145>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
54145>>>>>    // to the workspace object passing the an object and message to send back
54145>>>>>    // to this object. It is expected that the workspace object will send this
54145>>>>>    // message for every line of information it wants displayed (passing the
54145>>>>>    // information to be displayed
54145>>>>>    //****************************************************************************
54145>>>>>    register_procedure EnumerateWorkspaceData integer hObjId integer hmMessId
54145>>>>>    Procedure Show_WorkspaceInformation
54146>>>>>        If ghoWorkspace ;            Send EnumerateWorkspaceData to ghoWorkspace Current_object Msg_add_Line
54149>>>>>    End_Procedure
54150>>>>>
54150>>>>>    Function VersionStr integer iVer integer iRev integer iBld Returns string
54151>>>>>        Function_Return (string(iVer)-"."-string(iRev)-"."-string(iBld))
54152>>>>>    End_Function
54153>>>>>
54153>>>>>    Procedure Show_Versions
54154>>>>>        local integer iVersion iRevision iBuild
54155>>>>>        Version_information iVersion iRevision iBuild
54157>>>>>        Send Add_Line ("Runtime Version:" * VersionStr(self,iVersion,iRevision,iBuild) )
54158>>>>>        Send Add_Line ("Package Version:" * VersionStr(self,PKG_VERSION, PKG_REVISION, PKG_BUILD) )
54159>>>>>        Send Add_Line ("FMAC Version:"    * VersionStr(self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) )
54160>>>>>    End_Procedure
54161>>>>>
54161>>>>>
54161>>>>>    //***
54161>>>>>    //*** BW
54161>>>>>    //*** Procedure: Show_Drivers
54161>>>>>    //*** Purpose  : Show loaed database drivers
54161>>>>>    //***
54161>>>>>
54161>>>>>    Procedure Show_Drivers
54162>>>>>        Local String  Current_drvr
54163>>>>>        Local String  Loadeddrvrs
54163>>>>>        Local Integer Number_of_drvrs
54163>>>>>        Local Integer Count
54163>>>>>
54163>>>>>        Move "" To Loadeddrvrs
54164>>>>>        Get_attribute DF_NUMBER_DRIVERS To Number_of_drvrs
54167>>>>>        For Count From 1 To Number_of_drvrs
54173>>>>>>
54173>>>>>            Get_attribute DF_DRIVER_NAME Of Count To Current_drvr
54176>>>>>            If (Loadeddrvrs <> "") ;                Move (Append(Loadeddrvrs, ", ")) To Loadeddrvrs
54179>>>>>            Move (Append(Loadeddrvrs, Current_drvr)) To Loadeddrvrs
54180>>>>>        Loop
54181>>>>>>
54181>>>>>        Send Add_Line ("Database driver(s):" * Loadeddrvrs)
54182>>>>>    End_Procedure // Show_Drivers
54183>>>>>
54183>>>>>    //****************************************************************************
54183>>>>>    // $Module type: PROCEDURE
54183>>>>>    // $Module name: Add_Focus
54183>>>>>    // $Author     : VOO
54183>>>>>    // Created     : 24-09-96 @ 19:43
54183>>>>>    //
54183>>>>>    // Description
54183>>>>>    //    During activation we will remove the old information and add the newly
54183>>>>>    //    found systeminformation
54183>>>>>    //
54183>>>>>    // $Rev History
54183>>>>>    //    24-09-96  Module header created
54183>>>>>    //****************************************************************************
54183>>>>>    Procedure Add_Focus Integer hoRoot
54184>>>>>        Forward Send Add_Focus hoRoot
54186>>>>>
54186>>>>>        Send Delete_Data
54187>>>>>        Set Changed_State To False
54188>>>>>        Set Read_Only_State To True
54189>>>>>        Send Show_WorkSpaceInformation // added to show WS info
54190>>>>>        SEnd Show_Drivers
54191>>>>>        Send Show_Current_User
54192>>>>>        Send Show_Windows_Directory
54193>>>>>        Send Show_Current_Directory
54194>>>>>        Send Show_Filelist_Name
54195>>>>>        Send Show_Versions
54196>>>>>        Send Show_Memavail
54197>>>>>        Send Show_Screen_Size
54198>>>>>        Send Show_Page_Size
54199>>>>>        Send Show_Number_Format
54200>>>>>        Send Show_Date_Format
54201>>>>>        Send Show_Lock_Delay
54202>>>>>        Send Show_Lock_Timeout
54203>>>>>        Send Show_Date
54204>>>>>        Send Show_Systemresources
54205>>>>>        Send Show_Registration
54206>>>>>    End_Procedure // Show_All_Info
54207>>>>>
54207>>>>>End_Class // SysinfoDisplay
54208>>>>>
54208>>>>>
54208>>>>>//****************************************************************************
54208>>>>>// $Module type: OBJECT
54208>>>>>// $Module name: Sysinfo_Dialog
54208>>>>>// $Author     : VOO
54208>>>>>// Created     : 24-09-96 @ 18:47
54208>>>>>//
54208>>>>>// Description
54208>>>>>//    This object shows the systeminformation on the screen
54208>>>>>//
54208>>>>>// $Rev History
54208>>>>>//    24-09-96  Module header created
54208>>>>>//****************************************************************************
54208>>>>>Class SysInfoDialog Is A ModalPanel
54209>>>>>    Procedure Construct_Object
54210>>>>>        forward send construct_object
54212>>>>>
54212>>>>>        Set Caption_Bar To True
54213>>>>>        Set Sysmenu_Icon To True
54214>>>>>        Set Label To "System Information"
54215>>>>>        Set Size To 152 270
54216>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
54217>>>>>        Set Minimize_Icon To False
54218>>>>>        Set Maximize_Icon To False
54219>>>>>        Set Border_Style To Border_Dialog
54220>>>>>
54220>>>>>        Object Sysinfo_Display Is A SysInfoDisplay
54222>>>>>        End_Object
54223>>>>>
54223>>>>>        Object Close_Button Is A Button
54225>>>>>            Set Label to "&Close"
54226>>>>>            Set Location To 120 212
54227>>>>>            Set Message item 0 to msg_Close_Panel
54228>>>>>            Set default_action_button to current_object
54229>>>>>        End_Object // Close_Button
54230>>>>>
54230>>>>>        On_Key Kcancel       Send Close_Panel
54231>>>>>        On_Key Key_Alt+Key_C Send Close_Panel
54232>>>>>    End_procedure
54233>>>>>
54233>>>>>End_Class // SysinfoDialog
54234>>>>>
54234>>>>>// Purpose:
54234>>>>>//
54234>>>>>// Ken Ross 12/17/96 5:16PM
54234>>>>>//
54234>>>>>Class AboutDialog Is A ModalPanel
54235>>>>>
54235>>>>>    Procedure construct_object
54236>>>>>        String sVdfRootDir
54237>>>>>        forward send construct_object
54239>>>>>        Set Label to "About..."
54240>>>>>        Set Size to 100 217
54241>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
54242>>>>>
54242>>>>>        Object SysInfo_Dialog is a SysInfoDialog
54244>>>>>        End_Object
54245>>>>>
54245>>>>>        Object oBox is a Container3d
54247>>>>>            Set Border_Style to Border_StaticEdge
54248>>>>>            Set Size to 63 202
54249>>>>>            Set Location to 4 5
54250>>>>>
54250>>>>>            Object AboutGraphic is a BitmapContainer
54252>>>>>                Set Border_Style to Border_None
54253>>>>>                Set Bitmap_Style to Bitmap_Center
54254>>>>>                Set Size to 48 48
54255>>>>>                Set Location to 7 2
54256>>>>>            End_Object    // AboutGraphic
54257>>>>>
54257>>>>>            Object ProductName is a TextBox
54259>>>>>                Set label to "ProductName"
54260>>>>>                Set Size to 10 45
54261>>>>>                Set Location to 8 53
54262>>>>>            End_Object    // ProductName
54263>>>>>
54263>>>>>            Object Version is a TextBox
54265>>>>>                Set label to "Version"
54266>>>>>                Set Size to 10 25
54267>>>>>                Set Location to 21 53
54268>>>>>            End_Object    // Version
54269>>>>>
54269>>>>>            Object Copyright is a TextBox
54271>>>>>                Set label to "Copyright"
54272>>>>>                Set Size to 10 31
54273>>>>>                Set Location to 34 53
54274>>>>>            End_Object    // Copyright
54275>>>>>
54275>>>>>            Object Author is a TextBox
54277>>>>>                Set label to "Author"
54278>>>>>                Set Size to 10 22
54279>>>>>                Set Location to 46 53
54280>>>>>            End_Object    // Author
54281>>>>>
54281>>>>>        End_Object    // oBox
54282>>>>>
54282>>>>>        Object OK_bn is a Button
54284>>>>>            On_Item "&OK" Send Close_Panel
54285>>>>>            Set Size to 14 50
54286>>>>>            Set Location to 71 157
54287>>>>>        End_Object    // OK_bn
54288>>>>>
54288>>>>>        Object SysInfo_bn is a Button
54290>>>>>            On_Item "&System Info" Send Show_Sysinfo
54291>>>>>            Set Size to 14 50
54292>>>>>            Set Location to 71 101
54293>>>>>        End_Object    // SysInfo_bn
54294>>>>>
54294>>>>>        On_Key Kcancel Send KeyAction to (Ok_bn(Current_Object))
54295>>>>>        On_Key Key_Alt+Key_O Send KeyAction to (Ok_bn(Current_Object))
54296>>>>>        On_Key Key_Alt+Key_S Send KeyAction to (SysInfo_bn(Current_Object))
54297>>>>>
54297>>>>>        Get_Profile_String "Defaults" "VdfRootDir" To sVdfRootDir
54300>>>>>        Set logo to (sVdfRootDir +"\Bitmaps\DacAbout.bmp")  // square bitmaps of 42x42 work best
54301>>>>>
54301>>>>>    End_Procedure
54302>>>>>
54302>>>>>    Procedure set productname string sval
54303>>>>>        set label of (productname(oBox(current_object))) to sval
54304>>>>>    End_Procedure
54305>>>>>
54305>>>>>    Procedure set version string sval
54306>>>>>        set label of (version(oBox(current_object))) to sval
54307>>>>>    End_Procedure
54308>>>>>
54308>>>>>    Procedure set copyright string sval
54309>>>>>        set label of (copyright(oBox(current_object))) to sval
54310>>>>>    End_Procedure
54311>>>>>
54311>>>>>    Procedure set author string sval
54312>>>>>        set label of (author(oBox(current_object))) to sval
54313>>>>>    End_Procedure
54314>>>>>
54314>>>>>    // square bitmaps of 42x42 work best
54314>>>>>    //
54314>>>>>    Procedure set logo string sval
54315>>>>>        set bitmap of (aboutgraphic(oBox(current_object))) to sval
54316>>>>>    End_Procedure
54317>>>>>
54317>>>>>    Procedure Show_Sysinfo
54318>>>>>        Send Popup_Modal To (Sysinfo_Dialog(Current_Object))
54319>>>>>    End_Procedure // Show_Sysinfo
54320>>>>>
54320>>>>>End_Class
54321>>>>>
54321>>>>>
54321>>>>>//Object About_Dialog is an AboutDialog
54321>>>>>//    set productname to "Visual DataFlex"
54321>>>>>//    set version to "version 4.0"
54321>>>>>//    set copyright to "Copyright 1997 Data Access Corporation"
54321>>>>>//    set author to ""
54321>>>>>//    set logo to "ablogo.bmp"  // square bitmaps of 42x42 work best
54321>>>>>//End_Object
54321>>>>>
54321>>>>>//Procedure Activate_About
54321>>>>>//   Send Popup_Modal To (About_Dialog (Current_Object))
54321>>>>>//End_Procedure
54321>>>
54321>>>// *************************************************************************
54321>>>//  Public message. This is the default message. It is expected that you will
54321>>>//   create your own message to override this
54321>>>// *************************************************************************
54321>>>
54321>>>Procedure Activate_About
54323>>>   Send DoAbout "" "" "" "" "" ""
54324>>>End_Procedure
54325>>>
54325>>>// *************************************************************************
54325>>>//  Public message. It is expected that you will send this message (most
54325>>>//  likely from Activate_About. This creates an about object, activates it
54325>>>//  and destroys it when done. It is not exepected that you will augment this.
54325>>>// *************************************************************************
54325>>>
54325>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
54327>>>        Local integer hoObj hoMain
54328>>>
54328>>>        // create object
54328>>>        Object About is an AboutDialog
54330>>>            // if no title passed use the label of the main panel
54330>>>            // (if a main panel exists).
54330>>>            if sTitle     eq '' Begin
54332>>>                Get Main_Window to hoMain
54333>>>                if hoMain Get Label of hoMain to sTitle
54336>>>            end
54336>>>>
54336>>>            set productname to sTitle
54337>>>            set version     to sVersion
54338>>>            set copyright   to sCopyRight
54339>>>            set author      to sAuthor
54340>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
54343>>>            Move Current_Object to hoObj // object Id
54344>>>        End_Object
54345>>>        Send Popup to hoObj    // popup the about object
54346>>>        Send Request_Destroy_Object to hoObj // when done, it will be destroyed
54347>>>End_procedure
54348>    
54348>    
54348>    
54348>    
54348>    
54348>    //AB-PanelStoreEnd
54348>
54348>
54348>End_Object
54349>
54349>
54349>//AB-StoreStart
54349>
54349>Start_UI
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>
54350>//AB-StoreEnd
54350>
54350>
Summary
Memory Available: 2147483647
Total Errors   : 0
Total Symbols  : 27730
Total Resources: 0
Total Commands : 54349
Total Windows  : 1
Total Pages    : 1
Static Data    : 382455
Message area   : 313103
Total Blocks   : 17672
