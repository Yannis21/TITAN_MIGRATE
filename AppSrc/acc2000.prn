Compiling Program: C:\Vdf6\Develop\Empor\AppSrc\acc2000.src
Memory Available: 2147483647
1>Use AllEntSc
Using pre-compiled package ALLENTSC
INCLUDING FILE: ALLENTSC.PKI
30262>
30262>Register_Object Client_Area
30262>
30262>//AB-StoreTopStart
30262>Use Workspc.pkg
30262>
30262>//  Set date attributes as needed
30262>Set_Date_Attribute sysdate4_State to (TRUE)
30263>Set_Date_Attribute Date4_State    to (TRUE)
30264>Set_Date_Attribute epoch_value    to 30
30265>
30265>Object ProgramWorkspace is a WorkspaceSub
30267>    Set WorkspaceName to CURRENT$WORKSPACE
30268>//    Set ModuleName    to 'ProgramName' // Special module name.
30268>//    Set HelpName      to 'HelpName.hlp'// Please provide the name of your Windows help file.
30268>    Set kEnter_Next_State to True
30269>End_Object
30270>
30270>Open Users
INCLUDING FILE: USERS.FD
30272>Use CheckLog.pkg
INCLUDING FILE: CHECKLOG.PKG
30272>>>open syscurgl
INCLUDING FILE: SYSCURGL.FD
30274>>>open syscurxr
INCLUDING FILE: SYSCURXR.FD
30276>>>open gplan
INCLUDING FILE: GPLAN.FD
30278>>>open iteml
INCLUDING FILE: ITEML.FD
30280>>>open cn
INCLUDING FILE: CN.FD
30282>>>open payresp
INCLUDING FILE: PAYRESP.FD
30284>>>open salesmen
INCLUDING FILE: SALESMEN.FD
30286>>>open mhxanik
INCLUDING FILE: MHXANIK.FD
30288>>>open constrct
INCLUDING FILE: CONSTRCT.FD
30290>>>open clients
INCLUDING FILE: CLIENTS.FD
30292>>>open wtypkin
INCLUDING FILE: WTYPKIN.FD
30294>>>open wax
INCLUDING FILE: WAX.FD
30296>>>Function Check_log Global String slog Returns Integer
30297>>>    clear gplan
30298>>>    move syscurxr.company_code to gplan.company_code
30299>>>    move syscurxr.branch_code  to gplan.branch_code
30300>>>    move syscurxr.year_year    to gplan.year_year
30301>>>    move slog                  to gplan.gplan_code
30302>>>    find eq gplan by index.1
30303>>>>
30303>>>    if (found=1) function_return 0
30306>>>    else         function_return 1
30308>>>
30308>>>End_Function
30309>>>
30309>>>Function Check_last Global String slog Returns Integer
30310>>>    clear gplan
30311>>>    move syscurxr.company_code to gplan.company_code
30312>>>    move syscurxr.branch_code  to gplan.branch_code
30313>>>    move syscurxr.year_year    to gplan.year_year
30314>>>    move slog                  to gplan.gplan_code
30315>>>    find eq gplan by index.1
30316>>>>
30316>>>    if ((found=1) and (Gplan.Gplan_Yn_Last = 1)) Function_Return 0
30319>>>    else                                         Function_return 1
30321>>>
30321>>>End_Function
30322>>>
30322>>>Function fsgplandescr String slog Returns string
30323>>>    clear gplan
30324>>>    move syscurgl.company_code to gplan.company_code
30325>>>    move syscurgl.branch_code  to gplan.branch_code
30326>>>    move syscurgl.year_year    to gplan.year_year
30327>>>    move slog                  to gplan.gplan_code
30328>>>    find eq gplan by index.1
30329>>>>
30329>>>    if (found=1) function_return gplan.gplan_descr1
30332>>>    else         function_return ''
30334>>>
30334>>>End_Function
30335>>>
30335>>>Function fsclient string code Returns string
30336>>>    string name
30337>>>    clear clients
30338>>>    move code to clients.client_id
30339>>>    find eq clients by index.6
30340>>>>
30340>>>    if (found) move clients.client_name to name
30343>>>    else       move '' to name
30345>>>    function_return name
30346>>>end_Function
30347>>>
30347>>>Function fspayresp string code Returns string
30348>>>    string name
30349>>>    clear payresp
30350>>>    move code to payresp.presp_id
30351>>>    find eq payresp by index.7
30352>>>>
30352>>>    if (found) move payresp.presp_name to name
30355>>>    else       move '' to name
30357>>>    function_return name
30358>>>end_Function
30359>>>
30359>>>Function fssalesmen string code Returns string
30360>>>    string name
30361>>>    clear salesmen
30362>>>    move code to salesmen.sls_id
30363>>>    find eq salesmen by index.4
30364>>>>
30364>>>    if (found) move salesmen.sls_name to name
30367>>>    else       move '' to name
30369>>>    function_return name
30370>>>end_Function
30371>>>
30371>>>Function fsconstrct string code Returns string
30372>>>    string name
30373>>>    clear constrct
30374>>>    move code to constrct.cnt_id
30375>>>    find eq constrct by index.5
30376>>>>
30376>>>    if (found) move constrct.cnt_name to name
30379>>>    else       move '' to name
30381>>>    function_return name
30382>>>end_Function
30383>>>
30383>>>Function fsmhxanik string code Returns string
30384>>>    string name
30385>>>    clear mhxanik
30386>>>    move code to mhxanik.mhx_id
30387>>>    find eq mhxanik by index.4
30388>>>>
30388>>>    if (found) move mhxanik.mhx_name to name
30391>>>    else       move '' to name
30393>>>    function_return name
30394>>>end_Function
30395>>>
30395>>>
30395>>>Function fsptyppar string code Returns string
30396>>>    string sdescr
30397>>>    clear ptypparl
INCLUDING FILE: PTYPPARL.FD
30398>>>    move syscurxr.company_code to ptypparl.company_code
30399>>>    move syscurxr.branch_code  to ptypparl.branch_code
30400>>> //   move syscurxr.year_year    to ptypparl.year_year
30400>>>    move code                  to ptypparl.ptyppar_code
30401>>>    find eq ptypparl by index.1
30402>>>>
30402>>>    move ptypparl.ptyppar_descr to sdescr
30403>>>    function_return sdescr
30404>>>end_Function
30405>>>
30405>>>Function fsgplan string code Returns string
30406>>>    string sdescr
30407>>>    clear gplan
30408>>>    move syscurxr.company_code to gplan.company_code
30409>>>    move syscurxr.branch_code  to gplan.branch_code
30410>>>    move syscurxr.year_year    to gplan.year_year
30411>>>    move code                  to gplan.gplan_code
30412>>>    find eq gplan by index.1
30413>>>>
30413>>>    move gplan.gplan_descr1    to sdescr
30414>>>    function_return sdescr
30415>>>end_Function
30416>>>
30416>>>Function fsitem string scode Returns string
30417>>>    clear iteml
30418>>>    move scode to iteml.item_code
30419>>>    find eq iteml by index.5
30420>>>>
30420>>>    function_return iteml.item_descr
30421>>>end_Function
30422>>>
30422>>>Function fswax string srecr Returns string
30423>>>    clear wax
30424>>>    move srecr to wax.wax_recr
30425>>>    find eq wax by index.2
30426>>>>
30426>>>    function_return wax.wax_descr
30427>>>end_Function
30428>>>
30428>>>
30428>>>Function fswitemx string code Returns string
30429>>>    string name
30430>>>    clear witemx
INCLUDING FILE: WITEMX.FD
30431>>>    move syscurxr.company_code to witemx.company_code
30432>>>    move syscurxr.branch_code  to witemx.branch_code
30433>>>    move syscurxr.year_year    to witemx.year_year
30434>>>    move code to witemx.witemx_code
30435>>>    find eq witemx by index.5
30436>>>>
30436>>>    move witemx.witemx_descr to name
30437>>>    function_return name
30438>>>end_Function
30439>>>
30439>>>Function fsCNDescr String asItem Returns String
30440>>>    Clear CN
30441>>>    move asItem to CN.CN_Code
30442>>>    Find Eq CN by Index.5
30443>>>>
30443>>>    Function_Return CN.CN_Descr
30444>>>End_Function
30445>>>
30445>>>Function fswtypkin String askin Returns String
30446>>>    Clear Wtypkin
30447>>>    move askin to Wtypkin.wtypkin_code
30448>>>    Find Eq wtypkin by Index.1
30449>>>>
30449>>>    Function_Return Wtypkin.wtypkin_descr
30450>>>End_Function
30451>>>
30451>>>Function FindGtypkinDescr Integer aiCode Returns String
30452>>>    String lsDescr
30453>>>    Clear Gtypkin
INCLUDING FILE: GTYPKIN.FD
30454>>>    Move syscurxr.company_code    to Gtypkin.Company_Code
30455>>>    Move syscurxr.Branch_Code     to Gtypkin.Branch_Code
30456>>>    Move syscurxr.Year_year       to Gtypkin.Year_Year
30457>>>    Move aiCode                   to Gtypkin.Gtypkin_Code
30458>>>    Find eq Gtypkin by Index.1
30459>>>>
30459>>>    [Found] Move Gtypkin.Gtypkin_Descr to lsDescr
30460>>>    Function_Return lsDescr
30461>>>End_Function // FindGtypkinDescr
30462>>>
30462>>>Function FindBtypkinDescr Integer aiCode Returns String
30463>>>    String lsDescr
30464>>>    Clear Btypkin
INCLUDING FILE: BTYPKIN.FD
30465>>>    Move syscurxr.company_code    to Btypkin.Company_Code
30466>>>    Move syscurxr.Branch_Code     to Btypkin.Branch_Code
30467>>>    Move syscurxr.Year_year       to Btypkin.Year_Year
30468>>>    Move aiCode                   to Btypkin.btypkin_Code
30469>>>    Find eq Btypkin by Index.1
30470>>>>
30470>>>    [Found] Move Btypkin.Btypkin_Descr to lsDescr
30471>>>    Function_Return lsDescr
30472>>>End_Function // FindGtypkinDescr
30473>>>
30473>>>
30473>Use WinQlSQL.Sub
INCLUDING FILE: WINQLSQL.SUB
30473>>>Use CrystalReport.pkg
30473>>>
30473>>>
30473>>>
30473>>>Type PEWindowOptions
30473>>>  Field PEWindowOptions.StructSize As Word
30473>>>  Field PEWindowOptions.hasGroupTree As Word
30473>>>  Field PEWindowOptions.canDrillDown As Word
30473>>>  Field PEWindowOptions.hasNavigationControls As Word
30473>>>  Field PEWindowOptions.hasCancelButton As Word
30473>>>  Field PEWindowOptions.hasPrintButton As Word
30473>>>  Field PEWindowOptions.hasExportButton As Word
30473>>>  Field PEWindowOptions.hasZoomControl As Word
30473>>>  Field PEWindowOptions.hasCloseButton As Word
30473>>>  Field PEWindowOptions.hasProgressControls As Word
30473>>>  Field PEWindowOptions.hasSearchButton As Word
30473>>>  Field PEWindowOptions.hasPrintSetupButton As Word
30473>>>  Field PEWindowOptions.hasRefreshButton As Word
30473>>>End_Type // PEWindowOptions
30473>>>
30473>>>External_Function32 PESetWindowOptions "PESetWindowOptions" CRPE32.DLL ;  Integer printJob pointer Options Returns Integer
30474>>>
30474>>>Class CrystalReportSubSQL Is A CrystalReport
30475>>>
30475>>>    Procedure Construct_Object
30476>>>        Forward send Construct_Object
30478>>>        // Everything on except hasGroupTree by default
30478>>>        property integer hasGroupTree 0
30479>>>        property integer canDrillDown 1
30480>>>        property integer hasNavigationControls 1
30481>>>        property integer hasCancelButton 1
30482>>>        property integer hasPrintButton 1
30483>>>        property integer hasExportButton 1
30484>>>        property integer hasZoomControl 1
30485>>>        property integer hasCloseButton 1
30486>>>        property integer hasProgressControls 1
30487>>>        property integer hasSearchButton 1
30488>>>        property integer hasPrintSetupButton 1
30489>>>        property integer hasRefreshButton 1
30490>>>
30490>>>        Set WindowStyle To (WS_MAXIMIZE iOr WS_OVERLAPPEDWINDOW)
30491>>>    End_Procedure // Construct_Object
30492>>>
30492>>>    Procedure OutputToWindow String sTitle Integer iLeft Integer iTop Integer iWidth Integer iHeight Integer iStyle Handle hParent
30493>>>        Integer iPrintJob iResult
30494>>>        String sPEWindowOptions
30494>>>        Pointer pPeWindowOptions
30494>>>
30494>>>        Get PrintJob To iPrintJob
30495>>>        FillType PEWindowOptions with 0     to sPEWindowOptions
30496>>>        put PEWindowOptions_Size            to sPEWindowOptions at PEWindowOptions.StructSize
30497>>>        put (hasGroupTree(self))            to sPEWindowOptions at PEWindowOptions.hasGroupTree
30498>>>        put (canDrillDown(self))            to sPEWindowOptions at PEWindowOptions.canDrillDown
30499>>>        put (hasNavigationControls(self))   to sPEWindowOptions at PEWindowOptions.hasNavigationControls
30500>>>        put (hasCancelButton(self))         to sPEWindowOptions at PEWindowOptions.hasCancelButton
30501>>>        put (hasPrintButton(self))          to sPEWindowOptions at PEWindowOptions.hasPrintButton
30502>>>        put (hasExportButton(self))         to sPEWindowOptions at PEWindowOptions.hasExportButton
30503>>>        put (hasZoomControl(self))          to sPEWindowOptions at PEWindowOptions.hasZoomControl
30504>>>        put (hasCloseButton(self))          to sPEWindowOptions at PEWindowOptions.hasCloseButton
30505>>>        put (hasProgressControls(self))     to sPEWindowOptions at PEWindowOptions.hasProgressControls
30506>>>        put (hasSearchButton(self))         to sPEWindowOptions at PEWindowOptions.hasSearchButton
30507>>>        put (hasPrintSetupButton(self))     to sPEWindowOptions at PEWindowOptions.hasPrintSetupButton
30508>>>        put (hasRefreshButton(self))        to sPEWindowOptions at PEWindowOptions.hasrefreshButton
30509>>>        GetAddress of sPEWindowOptions      to pPEWindowOptions
30510>>>        Move (PESetWindowOptions(iPrintJob, pPEWindowOptions)) to iResult
30511>>>        Forward Send OutputToWindow sTitle iLeft iTop iWidth iHeight iStyle hParent
30513>>>    End_Procedure // OutputToWindow
30514>>>
30514>>>    Procedure Set TmpFileDir String aDir
30515>>>        String lsCurrWspc lsDir
30516>>>
30516>>>        If (ghoWorkSpace <> 0) Begin
30518>>>            Get WorkSpaceName of ghoWorkSpace to lsCurrWspc
30519>>>            Insert "WorkSpaces\" in lsCurrWspc at 1
30521>>>            Get_Profile_String lsCurrWspc aDir to lsDir
30524>>>            Set Report_Data_Path to lsDir
30525>>>        End
30525>>>>
30525>>>    End_Procedure
30526>>>
30526>>>    Procedure DoWinQLReport
30527>>>        // This can be used when reports must be able to run in different data directories
30527>>>        Set TmpFileDir to "TmpFileDir"
30528>>>        Forward Send DoWinQLReport
30530>>>    End_Procedure
30531>>>
30531>>>    // This hook procedure is called after the print job has been opened.
30531>>>    Procedure OnInitializeReport
30532>>>        Integer iTables iMax iCount iType
30533>>>        String  sLocation sLocation2 sPath DirSep
30533>>>        String  sNewPath sNewLocation sDataPath sMyLocation
30533>>>        Forward Send OnInitializeReport
30535>>>            Move (Sysconf(SYSCONF_DIR_SEPARATOR)) To DirSep
30536>>>            Get NTables To iMax
30537>>>            Decrement iMax
30538>>>            Get Report_Data_Path                                    To sPath
30539>>>            If Not (Right(sPath,1)) Eq DirSep Move (sPath-DirSep)   To sPath
30542>>>            For iCount From 0 To iMax
30548>>>>
30548>>>                //Get NthTableLocation iCount         To sLocation
30548>>>                //Get Report_Base_File_Name sLocation To sLocation2
30548>>>                //Set NthTableLocation iCount         To (sPath-sLocation2)
30548>>>                //Get NthTableDBType           iCount to iType
30548>>>                //Showln '--------------------------------------------------------'
30548>>>                //Showln iCount
30548>>>                //Showln sLocation
30548>>>                //Showln sPath
30548>>>                //Showln sLocation2
30548>>>                //Showln iType
30548>>>
30548>>>                //If (Trim(LowerCase(sLocation2))='btnemp.dat') Begin
30548>>>                  //Set Report_Data_Path to ''
30548>>>                  //Get NthTableDBType              iCount to iType
30548>>>                  Set nthTableLogOnServerName     iCount to 'SMSNT' 0
30549>>>                  Set nthTableLogOnDataBaseName   iCount to 'SMS'   0
30550>>>                    //Set nthTableLogOnUserID         iCount to 'dbo'     0
30550>>>                    //Set nthTableLogOnPassword       iCount to '123'     0
30550>>>                  //Set NthTableLocation            iCount To "BTNEMP"
30550>>>                    //Set NthTableLocation iCount To (sPath-sLocation2)
30550>>>                  //Get NthTableLocation iCount                 To sMyLocation
30550>>>                  //Move (Replace(sLocation,sMyLocation,''))    To sMyLocation
30550>>>                  //Showln sMyLocation
30550>>>                  //Set NthTableLocation            iCount To sMyLocation
30550>>>                //End
30550>>>
30550>>>            Loop // For iCount From 0 To iMax
30551>>>>
30551>>>    End_Procedure // OnInitializeReport
30552>>>
30552>>>    // This hook procedure is called just before a print job is closed.
30552>>>    Procedure OnDeInitializeReport
30553>>>        Forward Send OnDEInitializeReport
30555>>>    End_Procedure // OnDeInitializeReport
30556>>>
30556>>>    // This hook procedure is called just before a the print job is started.
30556>>>    Procedure OnStartPrinting
30557>>>        Forward Send OnStartPrinting
30559>>>    End_Procedure // OnStartPrinting
30560>>>
30560>>>    // This hook procedure is called just after a print job has finished.
30560>>>    Procedure OnStopPrinting
30561>>>        Forward Send OnStopPrinting
30563>>>    End_Procedure // OnStopPrinting
30564>>>
30564>>>
30564>>>End_Class // CrystalReportSubSQL
30565>>>
30565>Use Calendar.sl
INCLUDING FILE: CALENDAR.SL
30565>>>//AB/ Project Calendar
30565>>>//AB/ Object prj is a Lookup_Project
30565>>>//AB/     Set ProjectName to "Calendar"
30565>>>//AB/     Set ProjectFileName to "Calendar.sl"
30565>>>
30565>>>// Project Object Structure
30565>>>//   oCalendar is a dbModalPanel
30565>>>//     Container3d1 is a Container3d
30565>>>//       Grid2 is a Grid
30565>>>//       Textbox2 is a Textbox
30565>>>//       Textbox3 is a Textbox
30565>>>//       Textbox4 is a Textbox
30565>>>//       Textbox5 is a Textbox
30565>>>//       Textbox6 is a Textbox
30565>>>//       Textbox7 is a Textbox
30565>>>//       Textbox8 is a Textbox
30565>>>//       LineControl1 is a LineControl
30565>>>//       Container3d2 is a Container3d
30565>>>//         oRght is a BitmapContainer
30565>>>//         oLeft is a BitmapContainer
30565>>>//         oMonth is a Textbox
30565>>>//           oSelectMonth is a FloatingPopupMenu
30565>>>//         oYear is a Textbox
30565>>>//         oSelectYear is a Form
30565>>>//     BitmapContainer3 is a BitmapContainer
30565>>>//     oToday is a Textbox
30565>>>
30565>>>// Register all objects
30565>>>Register_Object BitmapContainer3
30565>>>Register_Object Container3d1
30565>>>Register_Object Container3d2
30565>>>Register_Object Grid2
30565>>>Register_Object LineControl1
30565>>>Register_Object oCalendar
30565>>>Register_Object oLeft
30565>>>Register_Object oMonth
30565>>>Register_Object oRght
30565>>>Register_Object oSelectMonth
30565>>>Register_Object oSelectYear
30565>>>Register_Object oToday
30565>>>Register_Object oYear
30565>>>Register_Object Textbox2
30565>>>Register_Object Textbox3
30565>>>Register_Object Textbox4
30565>>>Register_Object Textbox5
30565>>>Register_Object Textbox6
30565>>>Register_Object Textbox7
30565>>>Register_Object Textbox8
30565>>>
30565>>>
30565>>>
30565>>>//AB-StoreTopStart
30565>>>Use dates.utl
INCLUDING FILE: DATES.UTL
30565>>>>>// **********************************************************************
30565>>>>>// Use Dates.utl    // Date manipulation for VDF and DF3.1
30565>>>>>//
30565>>>>>// by Sture Andersen (sa1@vd.dk)
30565>>>>>//
30565>>>>>// The file contains a number of global functions for manipulating
30565>>>>>// dates. The package may be used with DataFlex 3.1 and Visual DataFlex.
30565>>>>>// This package is public domain.
30565>>>>>//
30565>>>>>// The package file is accompanied by a Word document (dfutil.doc)
30565>>>>>// listing the functions and their use.
30565>>>>>//
30565>>>>>//
30565>>>>>// Create: Fri  06-06-1997 - Merger of s_utl020, 021, 022, 023, 024, 025.
30565>>>>>// Update: Thu  26-06-1997 - Fixes for strange behavior when date4_state is set.
30565>>>>>//                         - Addition of popup_calendar to VDF.
30565>>>>>//         Sun  29-06-1997 - Character mode popup calender.
30565>>>>>//         Fri  04-07-1997 - Function WeekToDate added.
30565>>>>>//         Thu  10-07-1997 - Fixes.
30565>>>>>//         Mon  11-08-1997 - WeekToDate fixed.
30565>>>>>//         Sun  24-08-1997 - Character mode popup calender finished.
30565>>>>>//         Mon  15-12-1997 - Procedure Request_Popup_Calendar added.
30565>>>>>//         Mon  29-12-1997 - Procedures ItemYear2to4, ItemDate2to4 and
30565>>>>>//                           ItemSysdate added.
30565>>>>>//         Mon  29-12-1997 - Procedures FieldYear2to4, FieldDate2to4 and
30565>>>>>//                           FieldSysdate added.
30565>>>>>//         Sun  01-02-1998 - Functions Module_Compile_Date and
30565>>>>>//                           Module_Compile_Time added.
30565>>>>>//         Wed  25-02-1998 - Request_Popup in calendar object now only
30565>>>>>//                           responds if entry_state of the calling object
30565>>>>>//                           is true (VDF version). (No apparent effect)
30565>>>>>//         Sat  28-03-1998 - Added the following functions:
30565>>>>>//                             TS_SysTime      TS_ExtractDate
30565>>>>>//                             TS_ExtractTime  TS_ConvertToString
30565>>>>>//         Tue  26-05-1998 - Procedure TS_UI_Update added
30565>>>>>//         Sat  01-08-1998 - mask_date_window taken into account
30565>>>>>//         Mon  10-08-1998 - Functions Module_Start_Date and
30565>>>>>//                           Module_Start_Time added.
30565>>>>>//         Wed  02-09-1998 - Parameter for Module_Start_Date removed
30565>>>>>//         Mon  12-10-1998 - Portuguese added
30565>>>>>//         Wed  04-11-1998 - TS_TimeEstimator class added
30565>>>>>//         Tue  29-12-1998 - Function DateAsString added
30565>>>>>//         Wed  13-01-1999 - Function DateWeekNumber changed according to
30565>>>>>//                           Kjetil Johanson
30565>>>>>//         Mon  18-01-1999 - Function DateWeekNumber changed according to
30565>>>>>//                           Kjetil Johanson (again)
30565>>>>>//         Tue  19-01-1999 - Changed procedure names in TS_TimeEstimator
30565>>>>>//                           class (Continue->TS_Continue and Pause->
30565>>>>>//                           TS_Pause)
30565>>>>>//         Thu  21-01-1999 - Procedures DateFormatAsString and DateFormatName
30565>>>>>//                           added.
30565>>>>>//                         - Procedures DateCurrentSeparator and
30565>>>>>//                           DateCurrentFormat added.
30565>>>>>//         Tue  13-04-1999 - Julian constants added: Jan1st1900, Jan1st2000
30565>>>>>//                           Jan1st1000 and Jan1st100
30565>>>>>//         Mon  26-04-1999 - Changed procedure FieldYear2to4 and ItemYear2to4
30565>>>>>//                           to trap 3 digit years.
30565>>>>>//         Wed  27-04-1999 - Changed Dutch abbriviated day names (to 2 characters)
30565>>>>>//         Sun  02-05-1999 - Added function TS_Compose2
30565>>>>>//                         - Fixed error in TS_ConvertToString
30565>>>>>//         Tue  01-06-1999 - Added procedure popup_no_export to calendar.
30565>>>>>//         Thu  15-06-1999 - Fixed Date4to2 function and exporting dates
30565>>>>>//                           from the calendar to forms with no form_margin.
30565>>>>>//         Tue  07-09-1999 - Added function DateAsText
30565>>>>>//         Wed  27-10-1999 - Temporary fix for Module_Compile_Date function
30565>>>>>//                           in combination with y2k.
30565>>>>>//         Wed  19-12-1999 - Function StringToDate added.
30565>>>>>//                         - Existing function DateAsString renamed to
30565>>>>>//                           DateToString.
30565>>>>>//         Mon  03-01-2000 - Fix for VDF4. Popup calendar on empty date field
30565>>>>>//                           would result in seeding the calendar on year 100.
30565>>>>>//                           This error was caused by the fact that VDF 4
30565>>>>>//                           ignores SYSDATE4_STATE such that the sysdate
30565>>>>>//                           command returns 03-01-100
30565>>>>>//         Wed  01-02-2000 - Define instead of #REPLACE
30565>>>>>//         Wed  23-08-2000 - Function TS_Module_Compile_Time added
30565>>>>>//
30565>>>>>// NOTE:  There is language dependent string constants in this file.
30565>>>>>//        Currently there are sections for dutch, english, danish, swedish,
30565>>>>>//        norwegian, spanish, german and portuguese
30565>>>>>//
30565>>>>>//        These sections may be identified by searching the symbol LNG_DEFAULT
30565>>>>>//
30565>>>>>// ***********************************************************************
30565>>>>>
30565>>>>>Use ui
30565>>>>>Use Language    // Set default languange if not set by compiler command line
INCLUDING FILE: LANGUAGE.PKG
30565>>>>>>>// Use Language     // Default language setup
30565>>>>>>>// Sets default languange if not set by compiler command line
30565>>>>>>>
30565>>>>>>>define lng_dutch      for 131
30565>>>>>>>define lng_french     for 133 // NOT TRANSLATED. DO NOT SELECT!
30565>>>>>>>define lng_spanish    for 134
30565>>>>>>>define lng_italian    for 139 // NOT TRANSLATED. DO NOT SELECT!
30565>>>>>>>define lng_english    for 144
30565>>>>>>>define lng_danish     for 145
30565>>>>>>>define lng_swedish    for 146
30565>>>>>>>define lng_norwegian  for 147
30565>>>>>>>define lng_Greek    for 148
30565>>>>>>>define lng_german     for 149
30565>>>>>>>define lng_portuguese for 155
30565>>>>>>>define lng_papiamentu for 199 // NOT TRANSLATED. DO NOT SELECT!
30565>>>>>>>
30565>>>>>>>
30565>>>>>>>define lng_default for !@
30565>>>>>>>
30565>>>>>>>  define _LANGUAGE_ for $ENGLISH$
30565>>>>>>>
#REM LANGUAGE SET BY LANGUAGE.PKG: $ENGLISH$
30565>>>>>Use Seq_Chnl    // Defines global sequential device management operations (DAC)
30565>>>>>Use Macros.utl  // Various macros (DESKTOP_SECTION)
INCLUDING FILE: MACROS.UTL
30565>>>>>>>// Use Macros.utl   // Various macros (FOR_EX...)
30565>>>>>>>
30565>>>>>>>//  FOR_EX (extended FOR command)
30565>>>>>>>//  -----------------------------
30565>>>>>>>//> The FOR_EX command is exactly like the standard FOR command except
30565>>>>>>>//> that it will allow you to use keyword "DOWN_TO" instead of "TO" if
30565>>>>>>>//> you need to do a decremental loop.
30565>>>>>>>
30565>>>>>>>
30565>>>>>>>//  DESKTOP_SECTION
30565>>>>>>>//  ---------------
30565>>>>>>>//> The DESKTOP_SECTION/END_DESKTOP_SECTION commands will make a sequence of
30565>>>>>>>//> code compile (or rather instantiate) as if it was situated on the DESKTOP
30565>>>>>>>//> even when it isn't. DESKTOP_SECTION's may not be nested.
30565>>>>>>>
30565>>>>>>>
30565>>>>>>>
30565>>>>>
30565>>>>>// Switches
30565>>>>>
30565>>>>>define DATES_INCLUDE_POPUP for 1   // If set to 0 the popup calendar will not be included
30565>>>>>define DATES_DF31B_EPOCH   for 40  // DF3.1b didn't have an epoch setting. Therefore this symbol defines the epoch value for that version.
30565>>>>>
30565>>>>> define t.calendar.year           for "Year"
30565>>>>> define t.calendar.month          for "Month"
30565>>>>> define t.calendar.day            for "Day"
30565>>>>> define t.calendar.week           for "Wk."
30565>>>>> define t.calendar.calendar_popup for "Calendar Popup"
30565>>>>> define t.calendar.Monday         for "Monday"
30565>>>>> define t.calendar.Tuesday        for "Tuesday"
30565>>>>> define t.calendar.Wednesday      for "Wednesday"
30565>>>>> define t.calendar.Thursday       for "Thursday"
30565>>>>> define t.calendar.Friday         for "Friday"
30565>>>>> define t.calendar.Saturday       for "Saturday"
30565>>>>> define t.calendar.Sunday         for "Sunday"
30565>>>>> define t.calendar.January        for "January"
30565>>>>> define t.calendar.February       for "February"
30565>>>>> define t.calendar.March          for "March"
30565>>>>> define t.calendar.April          for "April"
30565>>>>> define t.calendar.May            for "May"
30565>>>>> define t.calendar.June           for "June"
30565>>>>> define t.calendar.July           for "July"
30565>>>>> define t.calendar.August         for "August"
30565>>>>> define t.calendar.September      for "September"
30565>>>>> define t.calendar.October        for "October"
30565>>>>> define t.calendar.November       for "November"
30565>>>>> define t.calendar.December       for "December"
30565>>>>> define t.calendar.ok             for "OK"
30565>>>>> define t.calendar.Cancel         for "Cancel"
30565>>>>> define t.calendar.Activate       for "Activate popup calendar (Ctrl+D)"
30565>>>>>
30565>>>>>define LargestPossibleDate for 913490 // December 31st 2500
30565>>>>>define Jan1st1900          for 693975
30565>>>>>define Jan1st2000          for 730500
30565>>>>>define Jan1st1000          for 365250
30565>>>>>define Jan1st105           for 38352
30565>>>>>define Jan1st100           for 36525
30565>>>>>
30565>>>>>enumeration_list // Date Segments
30565>>>>>  define DS_DAY
30565>>>>>  define DS_WEEK
30565>>>>>  define DS_MONTH
30565>>>>>  define DS_YEAR
30565>>>>>end_enumeration_list
30565>>>>>
30565>>>>>integer Dates$Year Dates$Month Dates$Day // internal use
30565>>>>>
30565>>>>>procedure DateDecompose global date date# //very internal!!
30566>>>>>  local integer pos1# pos2# format#
30567>>>>>  local string str# sep#
30567>>>>>  get_attribute DF_DATE_FORMAT to format#
30570>>>>>  get_attribute DF_DATE_SEPARATOR to pos1# // overload
30573>>>>>  character pos1# to sep#                  // end overload
30574>>>>>>
30574>>>>>  move date# to str#
30575>>>>>  replace sep# in str# with "$"
30577>>>>>  move strmark to pos1#
30578>>>>>  if [found] begin
30580>>>>>    replace sep# in str# with "$"
30582>>>>>    move strmark to pos2#
30583>>>>>  end
30583>>>>>>
30583>>>>>  else begin
30584>>>>>    move 0 to Dates$Year
30585>>>>>    move 0 to Dates$Month
30586>>>>>    move 0 to Dates$Day
30587>>>>>  end
30587>>>>>>
30587>>>>>  [ found] begin
30589>>>>>>
30589>>>>>    if format# eq DF_DATE_EUROPEAN ;          left str# to Dates$Day    (pos1#-1)
30593>>>>>    if format# eq DF_DATE_USA begin
30595>>>>>          mid  str# to Dates$Day    (pos2#-pos1#-1) (pos1#+1)
30598>>>>>>
30598>>>>>          left str# to Dates$Month  (pos1#-1)
30600>>>>>>
30600>>>>>    end
30600>>>>>>
30600>>>>>    else  mid  str# to Dates$Month  (pos2#-pos1#-1) (pos1#+1)
30604>>>>>
30604>>>>>    if format# eq DF_DATE_MILITARY begin
30606>>>>>          mid  str# to Dates$Day  2 (pos2#+1)
30609>>>>>>
30609>>>>>          left str# to Dates$Year   (pos1#-1)
30611>>>>>>
30611>>>>>    end
30611>>>>>>
30611>>>>>    else  mid  str# to Dates$Year 4 (pos2#+1)
30615>>>>>  end
30615>>>>>>
30615>>>>>end_procedure
30616>>>>>
30616>>>>>function DateCompose global integer day# integer month# integer year# returns date
30617>>>>>  local integer format#
30618>>>>>  local date date#
30618>>>>>  local string sep#
30618>>>>>  ifnot (day#*month#*year#) function_return 0
30621>>>>>  get_attribute DF_DATE_SEPARATOR to format# // overload
30624>>>>>  character format# to sep#                  // end overload
30625>>>>>>
30625>>>>>  get_attribute DF_DATE_FORMAT to format#
30628>>>>>  if day# gt 28 begin
30630>>>>>    if format# eq DF_DATE_EUROPEAN move (date(string(day#)+sep#+string(month#)+sep#+string(year#))) to date# // DMY
30633>>>>>    if format# eq DF_DATE_USA      move (date(string(month#)+sep#+string(day#)+sep#+string(year#))) to date# // MDY
30636>>>>>    if format# eq DF_DATE_MILITARY move (date(string(year#)+sep#+string(month#)+sep#+string(day#))) to date# // YMD
30639>>>>>    send DateDecompose date#
30640>>>>>    if Dates$Month ne month# move (day#-Dates$Day) to day#
30643>>>>>  end
30643>>>>>>
30643>>>>>  if format# eq DF_DATE_EUROPEAN function_return (date(string(day#)+sep#+string(month#)+sep#+string(year#))) // DMY
30646>>>>>  if format# eq DF_DATE_USA function_return (date(string(month#)+sep#+string(day#)+sep#+string(year#))) // MDY
30649>>>>>  function_return (date(string(year#)+sep#+string(month#)+sep#+string(day#))) // YMD
30650>>>>>end_function
30651>>>>>
30651>>>>>function DateFormatName global integer format# returns string
30652>>>>>  if format# eq DF_DATE_EUROPEAN function_return "European"
30655>>>>>  if format# eq DF_DATE_USA      function_return "United States"
30658>>>>>  if format# eq DF_DATE_MILITARY function_return "Military"
30661>>>>>end_function
30662>>>>>
30662>>>>>function DateCurrentSeparator global returns string
30663>>>>>  local integer rval#
30664>>>>>  get_attribute DF_DATE_SEPARATOR to rval#
30667>>>>>  function_return (character(rval#))
30668>>>>>end_function
30669>>>>>
30669>>>>>function DateCurrentFormat global returns integer
30670>>>>>  local integer rval#
30671>>>>>  get_attribute DF_DATE_FORMAT to rval#
30674>>>>>  function_return rval#
30675>>>>>end_function
30676>>>>>
30676>>>>>function DateFormatAsString global integer format# integer long# string sep# returns string
30677>>>>>  local string rval# letter#
30678>>>>>  if format# eq DF_DATE_EUROPEAN move "3342241111" to rval#
30681>>>>>  if format# eq DF_DATE_USA      move "2243341111" to rval#
30684>>>>>  if format# eq DF_DATE_MILITARY move "1111422433" to rval#
30687>>>>>  left t.calendar.year to letter# 1
30689>>>>>>
30689>>>>>  replace "1" in rval# with letter#
30691>>>>>  replace "1" in rval# with letter#
30693>>>>>  ifnot long# move "" to letter#
30696>>>>>  move (replaces("1",rval#,letter#)) to rval#
30697>>>>>  move (replaces("2",rval#,left(t.calendar.month,1))) to rval#
30698>>>>>  move (replaces("3",rval#,left(t.calendar.day,1))) to rval#
30699>>>>>  if sep# eq "" begin
30701>>>>>    get_attribute DF_DATE_SEPARATOR to format#
30704>>>>>    character format# to sep#
30705>>>>>>
30705>>>>>  end
30705>>>>>>
30705>>>>>  move (replaces("4",rval#,sep#)) to rval#
30706>>>>>  function_return rval#
30707>>>>>end_function
30708>>>>>
30708>>>>>function StringToDate global string date# integer format# integer four_digit_year# string sep# returns date
30709>>>>>  local integer sep_len# day# month# year#
30710>>>>>  move (length(sep#)) to sep_len#
30711>>>>>  if four_digit_year# move 4 to four_digit_year#
30714>>>>>  else move 2 to four_digit_year#
30716>>>>>  if format# eq DF_DATE_EUROPEAN begin // DMY
30718>>>>>    move (mid(date#,2,1)) to day#
30719>>>>>    move (mid(date#,2,3+sep_len#)) to month#
30720>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
30721>>>>>  end
30721>>>>>>
30721>>>>>  if format# eq DF_DATE_USA begin // MDY
30723>>>>>    move (mid(date#,2,1)) to month#
30724>>>>>    move (mid(date#,2,3+sep_len#)) to year#
30725>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
30726>>>>>  end
30726>>>>>>
30726>>>>>  if format# eq DF_DATE_MILITARY begin // YMD
30728>>>>>    move (mid(date#,four_digit_year#,1)) to year#
30729>>>>>    move (mid(date#,2,1+four_digit_year#+sep_len#)) to month#
30730>>>>>    move (mid(date#,2,3+four_digit_year#+sep_len#+sep_len#)) to day#
30731>>>>>  end
30731>>>>>>
30731>>>>>  function_return (DateCompose(day#,month#,year#))
30732>>>>>end_function
30733>>>>>
30733>>>>>function DateToString global date date# integer format# integer four_digit_year# string sep# returns string
30734>>>>>  local string rval# day# month# year#
30735>>>>>  get Date2to4 date# to date#
30736>>>>>  if (integer(date#)) begin
30738>>>>>    send DateDecompose date#
30739>>>>>    move Dates$Day to day#
30740>>>>>    if Dates$Day lt 10 insert "0" in day# at 1
30744>>>>>    move Dates$Month to month#
30745>>>>>    if Dates$Month lt 10 insert "0" in month# at 1
30749>>>>>    move Dates$Year to year#
30750>>>>>    ifnot four_digit_year# move (right(year#,2)) to year#
30753>>>>>    if format# eq DF_DATE_EUROPEAN move (day#+sep#+month#+sep#+year#) to rval# // DMY
30756>>>>>    if format# eq DF_DATE_USA      move (month#+sep#+day#+sep#+year#) to rval# // MDY
30759>>>>>    if format# eq DF_DATE_MILITARY move (year#+sep#+month#+sep#+day#) to rval# // YMD
30762>>>>>  end
30762>>>>>>
30762>>>>>  function_return rval#
30763>>>>>end_function
30764>>>>>
30764>>>>>// Function DateAsString is only here for compatibility with earlier versions.
30764>>>>>// Use function DateToString instead.
30764>>>>>function DateAsString global date date# integer format# integer four_digit_year# string sep# returns string
30765>>>>>  function_return (DateToString(date#,format#,four_digit_year#,sep#))
30766>>>>>end_function
30767>>>>>
30767>>>>>function DateIncrement global date date# integer segment# integer amount# returns date
30768>>>>>  if (date#=0) function_return 0
30771>>>>>  if segment# eq DS_WEEK function_return (date#+(amount#*7)) //weeks
30774>>>>>  if (segment#<>DS_DAY) begin // months or years
30776>>>>>    send DateDecompose date#
30777>>>>>    if segment# eq DS_MONTH begin //months
30779>>>>>      move (Dates$Month+amount#) to Dates$Month
30780>>>>>      if amount# ge 0 function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-1)/12)*12),Dates$Year+((Dates$Month-1)/12)))
30783>>>>>      function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-12)/12)*12),Dates$Year+((Dates$Month-12)/12)))
30784>>>>>    end //years:
30784>>>>>>
30784>>>>>    if segment# eq DS_YEAR function_return (DateCompose(Dates$Day,Dates$Month,Dates$Year+amount#))
30787>>>>>  end
30787>>>>>>
30787>>>>>  else function_return (date#+amount#) //days
30789>>>>>end_function
30790>>>>>
30790>>>>>function DateSegment global date date# integer segment# returns integer
30791>>>>>  send DateDecompose date#
30792>>>>>  if segment# eq DS_DAY   function_return Dates$Day
30795>>>>>  if segment# eq DS_MONTH function_return Dates$Month
30798>>>>>  if segment# eq DS_YEAR  function_return Dates$Year
30801>>>>>end_function
30802>>>>>
30802>>>>>function DateToInteger global date date# returns integer
30803>>>>>  send DateDecompose date#
30804>>>>>  function_return (Dates$Year*100+Dates$Month*100+Dates$Day)
30805>>>>>end_function
30806>>>>>
30806>>>>>function FirstDayInMonth global date date# returns date
30807>>>>>  local integer month# year#
30808>>>>>  move (DateSegment(date#,DS_MONTH)) to month#
30809>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
30810>>>>>  function_return (DateCompose(1,month#,year#))
30811>>>>>end_function
30812>>>>>
30812>>>>>function LastDayInMonth global date date# returns date
30813>>>>>  move (DateIncrement(date#,DS_MONTH,1)) to date#
30814>>>>>  function_return (FirstDayInMonth(date#)-1)
30815>>>>>end_function
30816>>>>>
30816>>>>>function FirstDayInYear global date date# returns date
30817>>>>>  local integer year#
30818>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
30819>>>>>  function_return (DateCompose(1,1,year#))
30820>>>>>end_function
30821>>>>>
30821>>>>>function LastDayInYear global date date# returns date
30822>>>>>  move (DateIncrement(date#,DS_YEAR,1)) to date#
30823>>>>>  function_return (FirstDayInYear(date#)-1)
30824>>>>>end_function
30825>>>>>
30825>>>>>// Prior to 18/1-99 version of DateWeekNumber
30825>>>>>//function DateWeekNumber global date date# returns integer
30825>>>>>//  local integer week# first_wd# day_of_year# year#
30825>>>>>//  if (date#=0) function_return 0
30825>>>>>//  get Date2to4 date# to date#
30825>>>>>//  move (DateSegment(date#,DS_YEAR)) to year#
30825>>>>>//  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
30825>>>>>//  move (date#-FirstDayInYear(date#)) to day_of_year#
30825>>>>>//  move (day_of_year#-1-7+first_wd#) to day_of_year#
30825>>>>>//  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
30825>>>>>//  else move 0 to week#
30825>>>>>//  if first_wd# le 4 increment week#
30825>>>>>//  if week# gt 52 begin
30825>>>>>//    move 1 to week#
30825>>>>>//    if first_wd# eq 4 move 53 to week#
30825>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
30825>>>>>//  end
30825>>>>>//  if week# eq 0 begin
30825>>>>>//    //get DateWeekNumber (DateIncrement(date#,DS_YEAR,-1)) to first_wd# // Original line
30825>>>>>//    get DateDayNumber  (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#ÿ // changed line
30825>>>>>//    move 52 to week#
30825>>>>>//    if first_wd# eq 4 move 53 to week#
30825>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
30825>>>>>//  end
30825>>>>>//  function_return week#
30825>>>>>//end_function
30825>>>>>
30825>>>>>function DateWeekNumber global date date# returns integer
30826>>>>>  local integer week# first_wd# day_of_year# year# wd#
30827>>>>>  if (date#=0) function_return 0
30830>>>>>  get Date2to4 date# to date#
30831>>>>>  // Leap-year test for actual or previous year
30831>>>>>  // Year# only used for selection between 52 and
30831>>>>>  // Therefore get year# from the first day of actual week
30831>>>>>  get DateDayNumber date# to wd#
30832>>>>>  move (DateSegment(date#-wd#+1,DS_YEAR)) to year#
30833>>>>>
30833>>>>>  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
30834>>>>>  move (date#-FirstDayInYear(date#)) to day_of_year#
30835>>>>>  move (day_of_year#-1-7+first_wd#) to day_of_year#
30836>>>>>  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
30839>>>>>  else move 0 to week#
30841>>>>>  if first_wd# le 4 increment week#
30844>>>>>  if week# gt 52 begin
30846>>>>>    move 1 to week#
30847>>>>>    if first_wd# eq 4 move 53 to week#
30850>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
30857>>>>>  end
30857>>>>>>
30857>>>>>  if week# eq 0 begin
30859>>>>>    // Week 52 or 53
30859>>>>>    get DateDayNumber (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#
30860>>>>>    move 52 to week#
30861>>>>>    if first_wd# eq 4 move 53 to week#
30864>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
30871>>>>>  end
30871>>>>>>
30871>>>>>  function_return week#
30872>>>>>end_function
30873>>>>>
30873>>>>>function DayName global integer int# returns string
30874>>>>>  if int# eq 1 function_return t.calendar.Monday
30877>>>>>  if int# eq 2 function_return t.calendar.Tuesday
30880>>>>>  if int# eq 3 function_return t.calendar.Wednesday
30883>>>>>  if int# eq 4 function_return t.calendar.Thursday
30886>>>>>  if int# eq 5 function_return t.calendar.Friday
30889>>>>>  if int# eq 6 function_return t.calendar.Saturday
30892>>>>>  if int# eq 7 function_return t.calendar.Sunday
30895>>>>>  function_return ""
30896>>>>>end_function
30897>>>>>
30897>>>>>function DateDayNumber global date date# returns integer
30898>>>>>  local integer rval# // 1=Monday, ... , 7=Sunday
30899>>>>>  get Date2to4 date# to date#
30900>>>>>  move date# to rval#
30901>>>>>  if rval# begin
30903>>>>>    if rval# gt 693975 move (rval#-2) to rval#
30906>>>>>    move (rval#-((rval#/7)*7)) to rval#
30907>>>>>    if rval# eq 0 move 7 to rval#
30910>>>>>  end
30910>>>>>>
30910>>>>>  function_return rval#
30911>>>>>end_function
30912>>>>>
30912>>>>>function DateDayName global date date# returns string
30913>>>>>  function_return (DayName(DateDayNumber(date#)))
30914>>>>>end_function
30915>>>>>
30915>>>>>function YearMaxWeek global integer year# returns integer
30916>>>>>  local integer wk1# wk2#
30917>>>>>  get DateWeekNumber (DateCompose(31,12,year#)) to wk1#
30918>>>>>  get DateWeekNumber (DateCompose(24,12,year#)) to wk2#
30919>>>>>  function_return (wk1# max wk2#)
30920>>>>>end_function
30921>>>>>
30921>>>>>function WeekToDate global integer year# integer week# returns date
30922>>>>>  local date date#
30923>>>>>  move (DateCompose(1,1,year#)) to date#
30924>>>>>  if (DateWeekNumber(date#)) ne 1 move (date#+7) to date# // week 52 or 53
30927>>>>>  move (date#-DateDayNumber(date#)+1) to date# // Now it's a Monday
30928>>>>>  function_return (week#-1*7+date#)
30929>>>>>end_function
30930>>>>>
30930>>>>>function MonthName global integer int# returns string
30931>>>>>  if int# eq  1 function_return t.calendar.January
30934>>>>>  if int# eq  2 function_return t.calendar.February
30937>>>>>  if int# eq  3 function_return t.calendar.March
30940>>>>>  if int# eq  4 function_return t.calendar.April
30943>>>>>  if int# eq  5 function_return t.calendar.May
30946>>>>>  if int# eq  6 function_return t.calendar.June
30949>>>>>  if int# eq  7 function_return t.calendar.July
30952>>>>>  if int# eq  8 function_return t.calendar.August
30955>>>>>  if int# eq  9 function_return t.calendar.September
30958>>>>>  if int# eq 10 function_return t.calendar.October
30961>>>>>  if int# eq 11 function_return t.calendar.November
30964>>>>>  if int# eq 12 function_return t.calendar.December
30967>>>>>  function_return ""
30968>>>>>end_function
30969>>>>>
30969>>>>>function DateMonthName global date date# returns string
30970>>>>>  function_return (MonthName(DateSegment(date#,DS_MONTH)))
30971>>>>>end_function
30972>>>>>
30972>>>>>function DateAsText global date date# string format# returns string
30973>>>>>  if date# eq 0 function_return ""
30976>>>>>  move (replace("#DN",format#,DateDayName(date#)))                  to format#
30977>>>>>  move (replace("#MN",format#,DateMonthName(date#)))                to format#
30978>>>>>  move (replace("#D" ,format#,string(DateSegment(date#,DS_DAY))))   to format#
30979>>>>>  move (replace("#Y" ,format#,string(DateSegment(date#,DS_YEAR))))  to format#
30980>>>>>  move (replace("#M" ,format#,string(DateSegment(date#,DS_MONTH)))) to format#
30981>>>>>  function_return format#
30982>>>>>end_function
30983>>>>>
30983>>>>>function Year2to4 global integer year# returns integer
30984>>>>>  local integer epoch_value#
30985>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
30986>>>>>  if year# lt 100 begin
30988>>>>>    if year# gt epoch_value# function_return (year#+1900)
30991>>>>>    function_return (year#+2000)
30992>>>>>  end
30992>>>>>>
30992>>>>>  function_return year# // No conversion done!
30993>>>>>end_function
30994>>>>>
30994>>>>>function Date2to4 global date date# returns date
30995>>>>>  local integer epoch_value#
30996>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
30997>>>>>  if date# gt 0 begin // Only if there is a date to convert
30999>>>>>    if (DateSegment(date#,DS_YEAR)) lt 105 begin
31001>>>>>      if Dates$Year gt epoch_value# function_return (DateIncrement(date#,DS_YEAR,1900))
31004>>>>>      function_return (DateIncrement(date#,DS_YEAR,2000))
31005>>>>>    end
31005>>>>>>
31005>>>>>    function_return date# // No conversion done!
31006>>>>>  end
31006>>>>>>
31006>>>>>end_function
31007>>>>>
31007>>>>>function Date4to2 global date date# returns date
31008>>>>>  local integer epoch_value# year#
31009>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31010>>>>>  if date# gt 0 begin // Only if there is a date to convert
31012>>>>>    move (DateSegment(date#,DS_YEAR)) to year#
31013>>>>>    if year# ge 100 begin // Only then conversion is needed!
31015>>>>>      if (year#>=(1900+epoch_value#) and year#<(2000+epoch_value#)) begin
31017>>>>>        if year# lt 2000 function_return (DateIncrement(date#,DS_YEAR,-1900))
31020>>>>>        else             function_return (DateIncrement(date#,DS_YEAR,-2000))
31022>>>>>      end
31022>>>>>>
31022>>>>>      else error 301 "Date is out of epoch range"
31024>>>>>    end
31024>>>>>>
31024>>>>>  end
31024>>>>>>
31024>>>>>  function_return date# // No conversion done!
31025>>>>>end_function
31026>>>>>
31026>>>>>function dSysDate global returns date
31027>>>>>  local date date#
31028>>>>>  sysdate4 date#
31029>>>>>  function_return date#
31030>>>>>end_function
31031>>>>>
31031>>>>>function iSysYear global returns integer
31032>>>>>  local date date#
31033>>>>>  sysdate4 date#
31034>>>>>  function_return (DateSegment(date#,DS_YEAR))
31035>>>>>end_function
31036>>>>>
31036>>>>>procedure ItemSysdate for desktop integer itm#
31037>>>>>  local date date#
31038>>>>>  get value item itm# to date#
31039>>>>>  if date# eq 0 begin
31041>>>>>    sysdate4 date#
31042>>>>>    set changed_value item itm# to date#
31043>>>>>  end
31043>>>>>>
31043>>>>>end_procedure
31044>>>>>
31044>>>>>procedure ItemDate2to4 for desktop integer itm#
31045>>>>>  local integer year#
31046>>>>>  local date date# new_date#
31046>>>>>  get value item itm# to date#
31047>>>>>
31047>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31048>>>>>  if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31051>>>>>  else move date# to new_date#
31053>>>>>
31053>>>>>  move (Date2to4(new_date#)) to new_date#
31054>>>>>  move (DateSegment(new_date#,3)) to year#
31055>>>>>  if (year#>99 and year#<1000) begin
31057>>>>>    error 15 // Illegal entry in this window
31058>>>>>>
31058>>>>>    procedure_return 1
31059>>>>>  end
31059>>>>>>
31059>>>>>  if new_date# ne date# set value item itm# to new_date#
31062>>>>>end_procedure
31063>>>>>
31063>>>>>procedure ItemYear2to4 for desktop integer itm#
31064>>>>>  local integer year# new_year#
31065>>>>>  get value item itm# to year#
31066>>>>>  if (year#>99 and year#<1000) begin
31068>>>>>    error 15 // Illegal entry in this window
31069>>>>>>
31069>>>>>    procedure_return 1
31070>>>>>  end
31070>>>>>>
31070>>>>>  move (Year2to4(year#)) to new_year#
31071>>>>>  if new_year# ne year# set value item itm# to new_year#
31074>>>>>end_procedure
31075>>>>>
31075>>>>> procedure FieldSysdate for DataDictionary integer fld#
31076>>>>>   local date date#
31077>>>>>   get field_current_value fld# to date#
31078>>>>>   if date# eq 0 begin
31080>>>>>     sysdate4 date#
31081>>>>>     set field_changed_value fld# to date#
31082>>>>>   end
31082>>>>>>
31082>>>>> end_procedure
31083>>>>>
31083>>>>> procedure FieldDate2to4 for DataDictionary integer fld#
31084>>>>>   local integer year#
31085>>>>>   local date date# new_date#
31085>>>>>   get field_current_value fld# to date#
31086>>>>>
31086>>>>>   move (DateSegment(date#,DS_YEAR)) to year#
31087>>>>>   if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31090>>>>>   else move date# to new_date#
31092>>>>>
31092>>>>>   move (Date2to4(new_date#)) to new_date#
31093>>>>>   move (DateSegment(new_date#,3)) to year#
31094>>>>>   if (year#>99 and year# <=999) begin
31096>>>>>     error 15 // Illegal entry in this window
31097>>>>>>
31097>>>>>     procedure_return 1
31098>>>>>   end
31098>>>>>>
31098>>>>>   if new_date# ne date# set field_changed_value fld# to new_date#
31101>>>>> end_procedure
31102>>>>>
31102>>>>> procedure FieldYear2to4 for DataDictionary integer fld#
31103>>>>>   local integer year# new_year# changed#
31104>>>>>   get field_current_value fld# to year#
31105>>>>>   get field_changed_state fld# to changed#
31106>>>>>   if changed# begin
31108>>>>>     if (year#>99 and year#<1000) begin
31110>>>>>       error 15 // Illegal entry in this window
31111>>>>>>
31111>>>>>       procedure_return 1
31112>>>>>     end
31112>>>>>>
31112>>>>>     move (Year2to4(year#)) to new_year#
31113>>>>>     if new_year# ne year# set field_changed_value fld# to new_year#
31116>>>>>   end
31116>>>>>>
31116>>>>> end_procedure
31117>>>>>
31117>>>>> function SysDate global returns date
31118>>>>>   function_return (dSysDate())
31119>>>>> end_function
31120>>>>>
31120>>>>>function sSysTime global returns string
31121>>>>>  local integer h# m# s#
31122>>>>>  sysdate4 h# h# m# s#
31126>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31127>>>>>end_function
31128>>>>>
31128>>>>>function TS_SysTime global returns number
31129>>>>>  local integer d# h# m# s#
31130>>>>>  sysdate4 d# h# m# s#
31134>>>>>  function_return (d#*24.0+h#*60+m#*60+s#)
31135>>>>>end_function
31136>>>>>
31136>>>>>//> This function returns a TS value composed from the date and time
31136>>>>>//> passed to it. Note that the time variable must be of the format
31136>>>>>//> "hh:mm:ss".
31136>>>>>function TS_Compose global date date# string time# returns number
31137>>>>>  local integer h# m# s#
31138>>>>>  left time# to h# 2
31140>>>>>>
31140>>>>>  mid time# to m# 2 4
31143>>>>>>
31143>>>>>  mid time# to s# 2 7
31146>>>>>>
31146>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31147>>>>>end_function
31148>>>>>
31148>>>>>function TS_Compose2 global date date# integer h# integer m# integer s# returns number
31149>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31150>>>>>end_function
31151>>>>>
31151>>>>>function TS_ExtractDate global number time# returns date
31152>>>>>  function_return (time#/86400) // 86400=24*60*60
31153>>>>>end_function
31154>>>>>
31154>>>>>function TS_ExtractTime global number time# returns string
31155>>>>>  local integer h# m# s#
31156>>>>>  move (time#-(86400.0*integer(TS_ExtractDate(time#)))) to s#
31157>>>>>  move (s#/3600) to h#
31158>>>>>  move (s#-(h#*3600)) to s#
31159>>>>>  move (s#/60) to m#
31160>>>>>  move (s#-(m#*60)) to s#
31161>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31162>>>>>end_function
31163>>>>>
31163>>>>>function TS_ConvertToString global number time# returns string
31164>>>>>  local date d#
31165>>>>>  move (TS_ExtractDate(time#)) to d#
31166>>>>>  if (integer(d#)) function_return (string(d#)+" "+TS_ExtractTime(time#))
31169>>>>>  else function_return (TS_ExtractTime(time#))
31171>>>>>end_function
31172>>>>>
31172>>>>>function TS_ConvertToStringNoDate global number ts# returns string
31173>>>>>  local integer h# m#
31174>>>>>  move (ts#/3600) to h#
31175>>>>>  move (ts#-(h#*3600)) to ts#
31176>>>>>  move (ts#/60) to m#
31177>>>>>  move (ts#-(m#*60)) to ts#
31178>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(ts#<10,"0","")+string(ts#))
31179>>>>>end_function
31180>>>>>
31180>>>>>// This procedure is used when a TS-variable must be displayed on screen.
31180>>>>>procedure TS_UI_Update global number TS# integer obj1# integer itm1# integer tmp_obj2# integer tmp_itm2#
31181>>>>>  local integer obj2# itm2#
31182>>>>>  if num_arguments gt 3 begin
31184>>>>>    move tmp_obj2# to obj2#
31185>>>>>    move tmp_itm2# to itm2#
31186>>>>>  end
31186>>>>>>
31186>>>>>  else begin
31187>>>>>    move obj1# to obj2#
31188>>>>>    move (itm1#+1) to itm2#
31189>>>>>  end
31189>>>>>>
31189>>>>>  set value of obj1# item itm1# to (TS_ExtractDate(TS#))
31190>>>>>  set value of obj2# item itm2# to (TS_ExtractTime(TS#))
31191>>>>>end_procedure
31192>>>>>
31192>>>>>class TS_TimeEstimator is an array
31193>>>>>  procedure construct_object
31194>>>>>    forward send construct_object
31196>>>>>    set delegation_mode to delegate_to_parent
31197>>>>>    property number  pnTotal   public 0 // Seconds needed to run the loop.
31198>>>>>    property number  pnElapsed public 0 // Seconds elapsed so far.
31199>>>>>    property number  pnLeft    public 0 // Number of seconds left
31200>>>>>    property number  pnStart   public 0
31201>>>>>    property number  pnPause   public 0
31202>>>>>    property number  pnPercent public 0
31203>>>>>    property integer piMin     public 0
31204>>>>>    property integer piMax     public 0
31205>>>>>  end_procedure
31206>>>>>
31206>>>>>  procedure TS_Start integer min# integer max#
31207>>>>>    set piMin to min#
31208>>>>>    set piMax to max#
31209>>>>>    set pnStart to (TS_SysTime())
31210>>>>>    set pnElapsed to 0
31211>>>>>    set pnPercent to 0
31212>>>>>  end_procedure
31213>>>>>
31213>>>>>  procedure TS_Calculate integer pos#
31214>>>>>    local integer min# max#
31215>>>>>    get piMin to min#
31216>>>>>    get piMax to max#
31217>>>>>    set pnElapsed to (TS_SysTime()-pnStart(current_object))
31218>>>>>    set pnTotal   to (pnElapsed(current_object)*(max#-min#)/number(pos#-min#))
31219>>>>>    set pnLeft    to (pnTotal(current_object)-pnElapsed(current_object))
31220>>>>>    set pnPercent to (100.0*(pos#-min#)/(max#-min#))
31221>>>>>  end_procedure
31222>>>>>
31222>>>>>  procedure TS_Pause
31223>>>>>    set pnPause to (TS_SysTime())
31224>>>>>  end_procedure
31225>>>>>
31225>>>>>  procedure TS_Continue
31226>>>>>    set pnStart to (pnStart(current_object)+TS_SysTime()-pnPause(current_object))
31227>>>>>  end_procedure
31228>>>>>end_class
31229>>>>>
31229>>>>>function TS_Module_Compile_Time global string path# returns number
31230>>>>>  local integer pos# day# month# year# seqeof# ch#
31231>>>>>  local string date# str# time#
31231>>>>>  move path# to str#
31232>>>>>  if str# ne "" begin
31234>>>>>    get Seq_New_Channel to ch#   // This method and Seq_Release_Channel are
31235>>>>>    send Seq_Release_Channel ch# // We only need it for a second
31236>>>>>      direct_input channel ch# (trim(str#)+".vd6") // VDF 6
31238>>>>>      [seqeof] direct_input channel ch# (trim(str#)+".vd5") // VDF 5
31240>>>>>    [ seqeof] move 1 to seqeof#
31241>>>>>    [~seqeof] move 0 to seqeof#
31242>>>>>    [~seqeof] readln str#
31243>>>>>    close_input channel ch#
31245>>>>>  end
31245>>>>>>
31245>>>>>  if seqeof# function_return 0
31248>>>>>  pos "," in str# to pos#
31250>>>>>>
31250>>>>>  move (mid(str#,18,pos#+2)) to str#
31251>>>>>  move (integer(mid(str#,2,4))) to day#
31252>>>>>  move (integer(mid(str#,2,1))) to month#
31253>>>>>  move (integer(mid(str#,2,7))) to year#
31254>>>>>  if year# eq 10 begin
31256>>>>>    move (integer(mid(str#,3,7))+1900) to year#
31257>>>>>    move (mid(str#,8,11)) to str#
31258>>>>>  end
31258>>>>>>
31258>>>>>  else move (mid(str#,8,10)) to str#
31260>>>>>  move (DateCompose(day#,month#,year#)) to date#
31261>>>>>  move (Date2to4(date#)) to date#
31262>>>>>  pos ":" in str# to pos#
31264>>>>>>
31264>>>>>  function_return (TS_Compose(date#,mid(str#,8,pos#-2)))
31265>>>>>end_function
31266>>>>>
31266>>>>>string Dates$Module_Compile_Time
31266>>>>>move "" to Dates$Module_Compile_Time
31267>>>>>
31267>>>>>function Module_Compile_Date global returns date
31268>>>>>  local number ts#
31269>>>>>  local string str#
31269>>>>>  get module_name to str# // 'module_name' is most likely the name of the .flx file.
31270>>>>>  get TS_Module_Compile_Time str# to ts#
31271>>>>>  move (TS_ExtractTime(ts#)) to Dates$Module_Compile_Time
31272>>>>>  function_return (TS_ExtractDate(ts#))
31273>>>>>end_function
31274>>>>>
31274>>>>>function Module_Compile_Time global returns string
31275>>>>>  local date grb#
31276>>>>>  // Module_Compile_Date must be called before this one!
31276>>>>>  if Dates$Module_Compile_Time eq "" move (Module_Compile_Date()) to grb#
31279>>>>>  function_return Dates$Module_Compile_Time
31280>>>>>end_function
31281>>>>>
31281>>>>>date   Dates$ModuleStartDate
31281>>>>>string Dates$ModuleStartTime 8
31281>>>>>move (dSysDate()) to Dates$ModuleStartDate
31282>>>>>move (sSysTime()) to Dates$ModuleStartTime
31283>>>>>
31283>>>>>function Module_Start_Date global returns date
31284>>>>>  function_return Dates$ModuleStartDate
31285>>>>>end_function
31286>>>>>
31286>>>>>function Module_Start_Time global returns string
31287>>>>>  function_return Dates$ModuleStartTime
31288>>>>>end_function
31289>>>>>
31289>>>>> register_procedure NotifyPopupCalendarChange date date#
31289>>>>> register_procedure NotifyPopupCalendarSelect date date#
31289>>>>>  use dfAllent
31289>>>>>  class calendar.textbox is a textbox
31290>>>>>    procedure construct_object
31291>>>>>      forward send construct_object
31293>>>>>      Set Auto_Size_State To False
31294>>>>>      Set Justification_Mode To (jMode_vCenter+jMode_Center)
31295>>>>>    end_procedure
31296>>>>>  end_class
31297>>>>>
31297>>>>>  register_object btn1
31297>>>>>  register_object btn6
31297>>>>>
31297>>>>>  class calendar.button is a button
31298>>>>>
31298>>>>>    procedure construct_object
31299>>>>>      forward send construct_object
31301>>>>>      set size to 15 18
31302>>>>>      on_key kleftarrow   send prev_day
31303>>>>>      on_key krightarrow  send next_day
31304>>>>>      on_key kuparrow     send prev_week
31305>>>>>      on_key kdownarrow   send next_week
31306>>>>>      property date p_assigned_date public 0
31307>>>>>    end_procedure
31308>>>>>
31308>>>>>    procedure switch // This makes all 42 buttons act as if they are one focus
31309>>>>>      send activate to (btn1(current_object))
31310>>>>>    end_procedure
31311>>>>>    procedure switch_back
31312>>>>>      send activate to (btn6(current_object))
31313>>>>>    end_procedure
31314>>>>>
31314>>>>>    procedure mouse_down
31315>>>>>      local integer current_object#
31316>>>>>      forward send mouse_down
31318>>>>>      move current_object to current_object#
31319>>>>>      delegate set p_current_date to (p_assigned_date(current_object#))
31321>>>>>    end_procedure
31322>>>>>  end_class
31323>>>>>
31323>>>>>  desktop_section
31329>>>>>    object popup_calendar is a ModalPanel
31331>>>>>      set size to 160 250
31332>>>>>      property date    p_current_date  public 0
31334>>>>>      property integer p_current_year  public -1
31336>>>>>      property integer p_current_month public -1
31338>>>>>      property integer pExportState    public 1
31340>>>>>
31340>>>>>      on_key key_ctrl+key_pgup send prev_year
31341>>>>>      on_key key_ctrl+key_pgdn send next_year
31342>>>>>      on_key          key_pgup send prev_month
31343>>>>>      on_key          key_pgdn send next_month
31344>>>>>      on_key key_ctrl+key_d    send go_today
31345>>>>>      on_key kcancel           send cancel
31346>>>>>
31346>>>>>      object cont3d is a container3d
31348>>>>>        set location to 5 5
31349>>>>>        set size to 120 237
31350>>>>>        object textbox_year is a calendar.textbox
31352>>>>>          set location to 5 5
31353>>>>>          set size to 15 30
31354>>>>>          set border_style to border_staticedge
31355>>>>>          procedure display
31357>>>>>            set value to (p_current_year(current_object))
31358>>>>>          end_procedure
31359>>>>>        end_object
31360>>>>>        object dayname_header is a container3d
31362>>>>>          set location to 5 39
31363>>>>>          set size to 15 126
31364>>>>>          set border_style to border_staticedge
31365>>>>>          procedure initialize
31367>>>>>            local integer itm#
31368>>>>>            for itm# from 0 to 6
31374>>>>>>
31374>>>>>              object txt is a calendar.textbox
31376>>>>>                set size to 12 17
31377>>>>>                set location to 0 (itm#*17.6+1)
31378>>>>>                 set value to (left(DayName(itm#+1),3))
31379>>>>>              end_object
31380>>>>>            loop
31381>>>>>>
31381>>>>>          end_procedure
31382>>>>>          send initialize
31383>>>>>        end_object
31384>>>>>        object weeknumber_header is a container3d
31386>>>>>          set location to 24 5
31387>>>>>          set size     to 89 30
31388>>>>>          set border_style to border_staticedge
31389>>>>>          object obj_id_array is an array
31391>>>>>          end_object
31392>>>>>          procedure initialize
31394>>>>>            local integer itm# obj#
31395>>>>>            move (obj_id_array(current_object)) to obj#
31396>>>>>            for itm# from 0 to 5
31402>>>>>>
31402>>>>>              object txt is a textbox
31404>>>>>                set size to 15 30
31405>>>>>                set location to (itm#*15+1) 1
31406>>>>>                set value of obj# item (item_count(obj#)) to current_object
31407>>>>>              end_object
31408>>>>>            loop
31409>>>>>>
31409>>>>>          end_procedure
31410>>>>>          procedure display
31412>>>>>            local integer itm# obj#
31413>>>>>            local date date# last_date#
31413>>>>>            move (obj_id_array(current_object)) to obj#
31414>>>>>            get p_current_date to date#
31415>>>>>            move (FirstDayInMonth(date#)) to date#
31416>>>>>            move (LastDayInMonth(date#)) to last_date#
31417>>>>>            move (date#-DateDayNumber(date#)+1) to date#
31418>>>>>            for itm# from 0 to 5
31424>>>>>>
31424>>>>>              if (itm#*7+date#) le last_date# ;                set value of (integer(value(obj#,itm#))) to (t.calendar.week*string(DateWeekNumber(itm#*7+date#)))
31427>>>>>              else set value of (integer(value(obj#,itm#))) to ""
31429>>>>>            loop
31430>>>>>>
31430>>>>>          end_procedure
31431>>>>>          send initialize
31432>>>>>        end_object
31433>>>>>        object days_grid is a container3d
31435>>>>>          set location to 23 39
31436>>>>>          set size     to 100 127
31437>>>>>          set border_style to border_none
31438>>>>>          object btn_array is an array
31440>>>>>          end_object
31441>>>>>          procedure initialize
31443>>>>>            local integer row# col# button_array#
31444>>>>>            move (btn_array(current_object)) to button_array#
31445>>>>>            for row# from 0 to 5
31451>>>>>>
31451>>>>>              for col# from 0 to 6
31457>>>>>>
31457>>>>>                object btn is a calendar.button
31459>>>>>                  set location to (row#*15) (col#*18)
31460>>>>>                  set value of button_array# item (item_count(button_array#)) to current_object
31461>>>>>                  on_item "" send move_value_out_ok
31462>>>>>                end_object
31463>>>>>              loop
31464>>>>>>
31464>>>>>            loop
31465>>>>>>
31465>>>>>          end_procedure
31466>>>>>          send initialize
31467>>>>>
31467>>>>>          procedure display.iii integer itm# integer day# integer activate#
31469>>>>>            local integer obj# current_day#
31470>>>>>            move (integer(value(btn_array(current_object),itm#))) to obj#
31471>>>>>            move (DateSegment(p_current_date(current_object),DS_DAY)) to current_day#
31472>>>>>            if activate# begin
31474>>>>>              if day# eq current_day# send activate to obj#
31477>>>>>            end
31477>>>>>>
31477>>>>>            else begin
31478>>>>>              if day# begin
31480>>>>>                set value of obj# to day#
31481>>>>>                set visible_state of obj# to true
31482>>>>>                set p_assigned_date of obj# to (DateCompose(day#,p_current_month(current_object),p_current_year(current_object)))
31483>>>>>              end
31483>>>>>>
31483>>>>>              else set visible_state of obj# to false
31485>>>>>            end
31485>>>>>>
31485>>>>>          end_procedure
31486>>>>>
31486>>>>>          procedure display integer activate#
31488>>>>>            local integer first_item# last_item# itm# day# date#
31489>>>>>            get p_current_date to date#
31490>>>>>            move (FirstDayInMonth(date#)) to date#
31491>>>>>            move (DateDayNumber(date#)-1) to first_item#
31492>>>>>            move (LastDayInMonth(date#)-date#+first_item#) to last_item#
31493>>>>>            ifnot activate# begin
31495>>>>>              for itm# from 0 to (first_item#-1)
31501>>>>>>
31501>>>>>                send display.iii itm# 0 0
31502>>>>>              loop
31503>>>>>>
31503>>>>>            end
31503>>>>>>
31503>>>>>            move 1 to day#
31504>>>>>            for itm# from first_item# to last_item#
31510>>>>>>
31510>>>>>              send display.iii itm# day# activate#
31511>>>>>              increment day#
31512>>>>>            loop
31513>>>>>>
31513>>>>>            ifnot activate# begin
31515>>>>>              for itm# from (last_item#+1) to 41
31521>>>>>>
31521>>>>>                send display.iii itm# 0 0
31522>>>>>              loop
31523>>>>>>
31523>>>>>            end
31523>>>>>>
31523>>>>>          end_procedure
31524>>>>>        end_object
31525>>>>>        object txt_month is a calendar.textbox
31527>>>>>          set size to 12 27
31528>>>>>          set location to 25 185
31529>>>>>          set value to t.calendar.month
31530>>>>>        end_object
31531>>>>>        object btn1 is a button
31533>>>>>          set size to 12 12
31534>>>>>          set location to 40 185
31535>>>>>          on_item "" send prev_month
31536>>>>>          set bitmap to "prev.bmp"
31537>>>>>          procedure switch_back
31539>>>>>            send display_main
31540>>>>>          end_procedure
31541>>>>>        end_object
31542>>>>>        object btn2 is a button
31544>>>>>          set size to 12 12
31545>>>>>          set location to 40 200
31546>>>>>          on_item "" send next_month
31547>>>>>          set bitmap to "next.bmp"
31548>>>>>        end_object
31549>>>>>        object txt_year is a calendar.textbox
31551>>>>>          set size to 12 27
31552>>>>>          set location to 70 185
31553>>>>>          set value to t.calendar.year
31554>>>>>        end_object
31555>>>>>        object btn3 is a button
31557>>>>>          set size to 12 12
31558>>>>>          set location to 85 185
31559>>>>>          on_item "" send prev_year
31560>>>>>          set bitmap to "prev.bmp"
31561>>>>>        end_object
31562>>>>>        object btn4 is a button
31564>>>>>          set size to 12 12
31565>>>>>          set location to 85 200
31566>>>>>          on_item "" send next_year
31567>>>>>          set bitmap to "next.bmp"
31568>>>>>        end_object
31569>>>>>      end_object
31570>>>>>      object btn5 is a button
31572>>>>>        set size to 14 60
31573>>>>>        set location to 129 115
31574>>>>>        on_item t.calendar.ok send move_value_out_ok
31575>>>>>      end_object
31576>>>>>      object btn6 is a button
31578>>>>>        set size to 14 60
31579>>>>>        set location to 129 182
31580>>>>>        on_item t.calendar.cancel send cancel
31581>>>>>        procedure switch
31583>>>>>          send display_main
31584>>>>>        end_procedure
31585>>>>>      end_object
31586>>>>>      procedure next_year
31588>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
31589>>>>>        send display_main
31590>>>>>      end_procedure
31591>>>>>      procedure prev_year
31593>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
31594>>>>>        send display_main
31595>>>>>      end_procedure
31596>>>>>      procedure next_month
31598>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
31599>>>>>        send display_main
31600>>>>>      end_procedure
31601>>>>>      procedure prev_month
31603>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
31604>>>>>        send display_main
31605>>>>>      end_procedure
31606>>>>>      procedure next_week
31608>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,1))
31609>>>>>        send display_main
31610>>>>>      end_procedure
31611>>>>>      procedure prev_week
31613>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,-1))
31614>>>>>        send display_main
31615>>>>>      end_procedure
31616>>>>>      procedure next_day
31618>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,1))
31619>>>>>        send display_main
31620>>>>>      end_procedure
31621>>>>>      procedure prev_day
31623>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,-1))
31624>>>>>        send display_main
31625>>>>>      end_procedure
31626>>>>>      procedure go_today
31628>>>>>        local date date#
31629>>>>>        sysdate4 date#
31630>>>>>        set p_current_date to date#
31631>>>>>        send display_main
31632>>>>>      end_procedure
31633>>>>>      property integer invoking_object_id public 0
31635>>>>>      procedure OnChange date date#
31637>>>>>        local integer focus# dm#
31638>>>>>        get invoking_object_id to focus#
31639>>>>>        if focus# gt desktop begin
31641>>>>>          get delegation_mode of focus# to dm#
31642>>>>>          set delegation_mode of focus# to no_delegate_or_error
31643>>>>>          send NotifyPopupCalendarChange to focus# date#
31644>>>>>          set delegation_mode of focus# to dm#
31645>>>>>        end
31645>>>>>>
31645>>>>>      end_procedure
31646>>>>>      procedure display
31648>>>>>        local integer date# month# year#
31649>>>>>        get p_current_date to date#
31650>>>>>        send OnChange date#
31651>>>>>        move (DateSegment(date#,DS_YEAR)) to year#
31652>>>>>        move (DateSegment(date#,DS_MONTH)) to month#
31653>>>>>        if (p_current_year(current_object)<>year# or p_current_month(current_object)<>month#) begin
31655>>>>>          set p_current_year to year#
31656>>>>>          set p_current_month to month#
31657>>>>>          set value to (t.calendar.calendar_popup+", "+MonthName(month#))
31658>>>>>          send display to (textbox_year(cont3d(current_object)))
31659>>>>>          send display to (weeknumber_header(cont3d(current_object)))
31660>>>>>          send display to (days_grid(cont3d(current_object))) 0
31661>>>>>        end
31661>>>>>>
31661>>>>>      end_procedure
31662>>>>>      procedure display_main
31664>>>>>        send display
31665>>>>>        send display to (days_grid(cont3d(current_object))) 1
31666>>>>>      end_procedure
31667>>>>>      procedure popup_no_export
31669>>>>>        set pExportState to false
31670>>>>>        send popup
31671>>>>>        set pExportState to true
31672>>>>>      end_procedure
31673>>>>>
31673>>>>>      procedure popup_group
31675>>>>>        local integer focus#
31676>>>>>        local date date#
31676>>>>>        move (focus(desktop)) to focus#
31677>>>>>        set invoking_object_id to focus#
31678>>>>>        get value of focus# item current to date#
31679>>>>>        ifnot (integer(date#)) move (dSysdate()) to date#
31682>>>>>        move (Date2to4(date#)) to date#
31683>>>>>        set p_current_date to date#
31684>>>>>        send display
31685>>>>>        forward send popup_group
31687>>>>>        send display to (days_grid(cont3d(current_object))) 1
31688>>>>>      end_procedure
31689>>>>>
31689>>>>>      procedure move_value_out
31691>>>>>        local integer focus# dm# margin# datatype#
31692>>>>>        if (pExportState(current_object)) begin
31694>>>>>          get invoking_object_id to focus#
31695>>>>>          if focus# gt desktop begin
31697>>>>>            get delegation_mode of focus# to dm#
31698>>>>>            set delegation_mode of focus# to no_delegate_or_error
31699>>>>>            send NotifyPopupCalendarSelect to focus# (p_current_date(current_object))
31700>>>>>            get form_margin of focus# item current to margin#
31701>>>>>            get form_datatype of focus# item current to datatype#
31702>>>>>            set delegation_mode of focus# to dm#
31703>>>>>            if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to (p_current_date(current_object))
31706>>>>>            else             set value of focus# item current to (Date4to2(p_current_date(current_object)))
31708>>>>>            set item_changed_state of focus# item current to true
31709>>>>>          end
31709>>>>>>
31709>>>>>        end
31709>>>>>>
31709>>>>>      end_procedure
31710>>>>>
31710>>>>>      procedure move_value_out_ok
31712>>>>>        send move_value_out
31713>>>>>        send deactivate
31714>>>>>      end_procedure
31715>>>>>
31715>>>>>      procedure request_popup
31717>>>>>        local integer focus# type# dm#
31718>>>>>        move (focus(desktop)) to focus#
31719>>>>>        if focus# gt desktop begin
31721>>>>>          get delegation_mode of focus# to dm#
31722>>>>>          set delegation_mode of focus# to no_delegate_or_error
31723>>>>>          get form_datatype of focus# item current to type#
31724>>>>>          if (type#=date_window or type#=mask_date_window) send popup
31727>>>>>          set delegation_mode of focus# to dm#
31728>>>>>        end
31728>>>>>>
31728>>>>>      end_procedure
31729>>>>>    end_object
31730>>>>>  end_desktop_section
31732>>>>>  // If the procedure below was not defined "for BaseClass" its symbolic
31732>>>>>  // substitute would become negative (because located on the desktop). This
31732>>>>>  // would result in the toolbar object not being able to handle it. Therefore:
31732>>>>>  procedure request_popup_calendar for BaseClass
31733>>>>>    send request_popup to (popup_calendar(current_object))
31734>>>>>  end_procedure
31735>>>>>  procedure popup_calendar_no_export
31736>>>>>    send popup_no_export to (popup_calendar(current_object))
31737>>>>>  end_procedure
31738>>>>>  register_procedure Add_Toolbar_Button_Bitmap string bmp# string Tip# string StHlp# integer msg# integer obj#
31738>>>>>  procedure Add_Calendar_tbButton integer oTb#
31739>>>>>    send Add_Toolbar_Button_Bitmap to oTb# "DfCalend.bmp" t.calendar.calendar_popup t.calendar.Activate msg_request_popup_calendar
31740>>>>>  end_procedure
31741>>>>> function s.calendar returns integer // Backwards compatible!!
31742>>>>>   function_return (popup_calendar(current_object))
31743>>>>> end_function
31744>>>>>
31744>>>>>// Karl,
31744>>>>>// Structure is as follows,
31744>>>>>//
31744>>>>>// //put this code in the top portion of the view code or in the program
31744>>>>>// code.
31744>>>>>//
31744>>>>>// Type SystemTime
31744>>>>>//   field SystemTime.iYear As Word
31744>>>>>//   field SystemTime.iMonth As Word
31744>>>>>//   field SystemTime.iDayOfWeek As Word
31744>>>>>//   field SystemTime.iDay As Word
31744>>>>>//   field SystemTime.iHour As Word
31744>>>>>//   field SystemTime.iMinute As Word
31744>>>>>//   field SystemTime.iSecond As Word
31744>>>>>//   field SystemTime.iMilliseconds As Word
31744>>>>>// End_Type
31744>>>>>//
31744>>>>>// external_function GetSystemTime "GetSystemTime" kernel32.dll Pointer lpGST Returns VOID_TYPE
31744>>>>>//
31744>>>>>// //put this code in an onClick or wherever
31744>>>>>// procedure onclick
31744>>>>>//   local integer iRetVal
31744>>>>>//   local string TimeData
31744>>>>>//   local pointer GST
31744>>>>>//
31744>>>>>//   ZeroType SystemTime to TimeData
31744>>>>>//   getAddress from TimeData to GST
31744>>>>>//
31744>>>>>//   move (GetSystemTime(GST)) to iRetVal
31744>>>>>// end_procedure
31744>>>>>//
31744>>>>>// To extract the data from the Structure after calling the function use
31744>>>>>// the getbuff command as follows:
31744>>>>>//
31744>>>>>// getbuff from TimeData as SystemTime.IVAL to var
31744>>>>>//
31744>>>>>// where IVAL is one of the vars such as iYear or iDay, etc.
31744>>>>>//
31744>>>>>// OLIVER NELSON
31744>>>>>//
31744>>>>>//
31744>>>
31744>>>//AB-StoreTopEnd
31744>>>
31744>>>//AB-IgnoreStart
31744>>>
31744>>>Use DFAllEnt.pkg
31744>>>
31744>>>
31744>>>//AB-IgnoreEnd
31744>>>
31744>>>CD_Popup_Object oCalendar is a dbModalPanel
31763>>>
31763>>>    //AB-StoreTopStart
31763>>>    on_key kcancel           send cancel
31764>>>    //AB-StoreTopEnd
31764>>>
31764>>>    Set Border_Style to Border_Normal
31765>>>    Set Caption_Bar to FALSE
31766>>>    Set Label to "­¢ àì, 2001"
31767>>>    Set Size to 98 123
31768>>>    Set Location to 10 22
31769>>>    Set Color to clWhite
31770>>>
31770>>>    //AB-DDOStart
31770>>>
31770>>>
31770>>>    //AB-DDOEnd
31770>>>
31770>>>    Object Container3d1 is a Container3d
31772>>>        Set Size to 88 135
31773>>>        Set Location to -2 -1
31774>>>        Set Color to clWhite
31775>>>        Set Border_Style to Border_None
31776>>>        Object Grid2 is a Grid
31778>>>
31778>>>            //AB-StoreTopStart
31778>>>            property date    p_current_date     public 0
31780>>>            property integer p_current_year     public -1
31782>>>            property integer p_current_month    public -1
31784>>>            property integer p_selected_day     public -1
31786>>>            property integer pExportState       public 1
31788>>>            property integer invoking_object_id public 0
31790>>>            
31790>>>            Set Border_Style To BORDER_NONE
31791>>>            Set header_visible_state To False
31792>>>            set select_mode to no_select
31793>>>            Set Gridline_mode To GRID_VISIBLE_NONE
31794>>>            
31794>>>            on_key Key_F1 Send Help
31795>>>            on_key key_ctrl+key_pgup send prev_year
31796>>>            on_key key_ctrl+key_pgdn send next_year
31797>>>            on_key          key_pgup send prev_month
31798>>>            on_key          key_pgdn send next_month
31799>>>            on_key key_enter         send move_value_out
31800>>>            on_key key_ctrl+key_d    send go_today
31801>>>            
31801>>>            //AB-StoreTopEnd
31801>>>
31801>>>            Set Color to clWhite
31802>>>            Set CurrentCellColor to clWhite
31803>>>            Set CurrentCellTextColor to clWhite
31804>>>            Set Size to 61 145
31805>>>            Set Location to 30 1
31806>>>            Set Resize_Column_state to FALSE
31807>>>
31807>>>            Set Line_Width to 7 0
31808>>>
31808>>>            Set Form_Width    item 0 to 18
31809>>>            Set Header_Label  item 0 to "­"
31810>>>            
31810>>>            Set Form_Width    item 1 to 18
31811>>>            Set Header_Label  item 1 to "â"
31812>>>            
31812>>>            Set Form_Width    item 2 to 18
31813>>>            Set Header_Label  item 2 to "à"
31814>>>            
31814>>>            Set Form_Width    item 3 to 18
31815>>>            Set Header_Label  item 3 to "â"
31816>>>            
31816>>>            Set Form_Width    item 4 to 18
31817>>>            Set Header_Label  item 4 to "â"
31818>>>            
31818>>>            Set Form_Width    item 5 to 18
31819>>>            Set Header_Label  item 5 to "¡"
31820>>>            
31820>>>            Set Form_Width    item 6 to 18
31821>>>            Set Header_Label  item 6 to "á"
31822>>>            
31822>>>
31822>>>            //AB-StoreStart
31822>>>            
31822>>>            procedure go_today
31824>>>                Date date#
31825>>>                sysdate4 date#
31826>>>                set p_current_date to date#
31827>>>                Send Update_Calendar
31828>>>            end_procedure
31829>>>            
31829>>>            procedure next_month
31831>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
31832>>>                Send Update_Calendar
31833>>>            end_procedure
31834>>>            
31834>>>            procedure prev_month
31836>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
31837>>>                Send Update_Calendar
31838>>>            end_procedure
31839>>>            
31839>>>            procedure next_year
31841>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
31842>>>                Send Update_Calendar
31843>>>            end_procedure
31844>>>            
31844>>>            procedure prev_year
31846>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
31847>>>                Send Update_Calendar
31848>>>            end_procedure
31849>>>            
31849>>>            Procedure Activate
31851>>>                Date date#
31852>>>                Forward Send Activate
31854>>>                Set current_item to (p_selected_day(Self))
31855>>>            End_Procedure
31856>>>            
31856>>>            Procedure Update_Calendar
31858>>>                Set Dynamic_Update_State To False
31859>>>                send Fill_List
31860>>>                Set Dynamic_Update_State To True
31861>>>                // Send Update_Label
31861>>>                Set current_item to (p_selected_day(Self))
31862>>>                Send Date_Changing to (oYear(Container3d2(self)))
31863>>>                Send Date_Changing to (oMonth(Container3d2(self)))
31864>>>            End_Procedure
31865>>>            
31865>>>            Procedure Fill_List
31867>>>                Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
31868>>>                Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
31868>>>                Date dToday
31868>>>                Send Delete_Data
31869>>>            
31869>>>                Get p_current_date to date#
31870>>>            
31870>>>                SysDate4 dToday
31871>>>                move (DateSegment(dToday,DS_DAY)) to cur_day#
31872>>>                move (DateSegment(dToday,DS_MONTH)) to cur_month#
31873>>>                move (DateSegment(dToday,DS_YEAR)) to cur_year#
31874>>>            
31874>>>                move (DateSegment(date#,DS_DAY)) to sel_day#
31875>>>                move (DateSegment(date#,DS_MONTH)) to sel_month#
31876>>>                move (DateSegment(date#,DS_YEAR)) to sel_year#
31877>>>                Set p_current_month To sel_month#
31878>>>                Set p_current_year To sel_year#
31879>>>            
31879>>>                move (FirstDayInMonth(date#)) to date#
31880>>>                move (DateDayNumber(date#)-1) to first_item#
31881>>>                move (LastDayInMonth(date#)-date#+first_item#) to last_item#
31882>>>                move (DateIncrement(date#,DS_Month,-1)) To prevdate#
31883>>>                move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
31884>>>            
31884>>>                If (first_item# > 0) Begin
31886>>>                    Move (first_item#-1) to day#
31887>>>                    For iFor from 0 to (first_item#-1)
31893>>>>
31893>>>                        Send Add_Item msg_move_value_out (prev_last#-day#)
31894>>>                        Set Entry_State Item iFor To False
31895>>>                        Set ItemTextColor Item iFor To clGray
31896>>>                        Decrement day#
31897>>>                    Loop
31898>>>>
31898>>>                End
31898>>>>
31898>>>            
31898>>>                Move 1 To day#
31899>>>                For iFor from first_item# to last_item#
31905>>>>
31905>>>                    Send Add_Item Msg_Move_Value_Out day#
31906>>>                    Set Entry_State Item iFor To False
31907>>>                    If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Set Form_Bitmap Item iFor To "cdate.bmp"
31910>>>                    If Day# eq sel_day# Set p_selected_day To iFor
31913>>>                    Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
31914>>>                    Set form_datatype item iFor To mask_numeric_window
31915>>>                    Set form_Mask item iFor To "## "
31916>>>                    Increment day#
31917>>>                Loop
31918>>>>
31918>>>            
31918>>>                move (DateIncrement(date#,DS_Month,1)) To nextdate#
31919>>>                move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
31920>>>            
31920>>>                If (last_item# < 41) Begin
31922>>>                    Move 1 to day#
31923>>>                    For iFor from (last_item#+1) to 41
31929>>>>
31929>>>                        Send Add_Item msg_move_value_out day#
31930>>>                        Set Entry_State Item iFor To False
31931>>>                        Set ItemTextColor Item iFor To clGray
31932>>>                        Increment day#
31933>>>                    Loop
31934>>>>
31934>>>                End
31934>>>>
31934>>>            
31934>>>            End_Procedure
31935>>>            
31935>>>            Procedure Help
31937>>>                Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<PgUp>, <PgDn> - Select year.\n\n(c) 2001, SCR. Special thanks to Sture Andersen.") ("Help on Calendar")
31938>>>            End_Procedure
31939>>>            
31939>>>            procedure mouse_click integer window integer char_pos
31941>>>                Send Move_Value_Out
31942>>>                forward send mouse_click window char_pos
31944>>>            end_procedure
31945>>>            
31945>>>            Procedure Move_Value_Out
31947>>>                Integer iYear iMonth iDay iItm
31948>>>                Date Date# next_date# prev_date#
31948>>>                Get Current_Item To iItm
31949>>>                If (pExportState(Self)) Begin
31951>>>                    Get Value Item iItm To iDay
31952>>>                    Get p_current_month to iMonth
31953>>>                    Get p_current_year  to iYear
31954>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
31955>>>            
31955>>>                    If ((iItm>27)and(iDay<15)) Begin
31957>>>                        Move (DateCompose(1,iMonth,iYear)) To next_date#
31958>>>                        move (DateIncrement(next_date#,DS_Month,1)) To next_date#
31959>>>                        move (DateSegment(next_date#,DS_MONTH)) to iMonth
31960>>>                        move (DateSegment(next_date#,DS_YEAR)) to iYear
31961>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
31962>>>                    End
31962>>>>
31962>>>                    If ((iItm<7)and(iDay>20)) Begin
31964>>>                        Move (DateCompose(1,iMonth,iYear)) To prev_date#
31965>>>                        move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
31966>>>                        move (DateSegment(prev_date#,DS_MONTH)) to iMonth
31967>>>                        move (DateSegment(prev_date#,DS_YEAR)) to iYear
31968>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
31969>>>                    End
31969>>>>
31969>>>            
31969>>>                    Send Export_Date date#
31970>>>                End
31970>>>>
31970>>>            End_Procedure
31971>>>            
31971>>>            Procedure Export_Date date date#
31973>>>                local integer focus# dm# margin# datatype#
31974>>>                get invoking_object_id to focus#
31975>>>            
31975>>>                if focus# gt desktop begin
31977>>>                     get delegation_mode of focus# to dm#
31978>>>                     set delegation_mode of focus# to no_delegate_or_error
31979>>>                     get form_margin of focus# item current to margin#
31980>>>                     get form_datatype of focus# item current to datatype#
31981>>>                     set delegation_mode of focus# to dm#
31982>>>                     if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
31985>>>                     else             set value of focus# item current to (Date4to2(date#))
31987>>>                     set item_changed_state of focus# item current to true
31988>>>                end
31988>>>>
31988>>>                Send Close_Calendar
31989>>>            End_Procedure
31990>>>            //AB-StoreEnd
31990>>>
31990>>>        End_Object    // Grid2
31991>>>
31991>>>        Object Textbox2 is a Textbox
31993>>>            Set Label to "­"
31994>>>            Set Auto_Size_State to FALSE
31995>>>            Set Transparent_State to TRUE
31996>>>            Set Color to clWhite
31997>>>            Set TextColor to clNavy
31998>>>            Set Location to 19 4
31999>>>            Set Size to 10 15
32000>>>
32000>>>            //AB-StoreStart
32000>>>                                        
32000>>>            Set Label To (left(t.calendar.Monday,2))
32001>>>            //AB-StoreEnd
32001>>>
32001>>>        End_Object    // Textbox2
32002>>>
32002>>>        Object Textbox3 is a Textbox
32004>>>            Set Label to "â"
32005>>>            Set Auto_Size_State to FALSE
32006>>>            Set Transparent_State to TRUE
32007>>>            Set Color to clWhite
32008>>>            Set TextColor to clNavy
32009>>>            Set Location to 19 22
32010>>>            Set Size to 10 12
32011>>>
32011>>>            //AB-StoreStart
32011>>>                                        
32011>>>            Set Label To (left(t.calendar.Tuesday,2))
32012>>>            //AB-StoreEnd
32012>>>
32012>>>        End_Object    // Textbox3
32013>>>
32013>>>        Object Textbox4 is a Textbox
32015>>>            Set Label to "à"
32016>>>            Set Auto_Size_State to FALSE
32017>>>            Set Transparent_State to TRUE
32018>>>            Set Color to clWhite
32019>>>            Set TextColor to clNavy
32020>>>            Set Location to 19 39
32021>>>            Set Size to 10 15
32022>>>
32022>>>            //AB-StoreStart
32022>>>                                        
32022>>>            Set Label To (left(t.calendar.Wednesday,2))
32023>>>            //AB-StoreEnd
32023>>>
32023>>>        End_Object    // Textbox4
32024>>>
32024>>>        Object Textbox5 is a Textbox
32026>>>            Set Label to "â"
32027>>>            Set Auto_Size_State to FALSE
32028>>>            Set Transparent_State to TRUE
32029>>>            Set Color to clWhite
32030>>>            Set TextColor to clNavy
32031>>>            Set Location to 19 57
32032>>>            Set Size to 10 17
32033>>>
32033>>>            //AB-StoreStart
32033>>>                                        
32033>>>            Set Label To (left(t.calendar.Thursday,2))
32034>>>            //AB-StoreEnd
32034>>>
32034>>>        End_Object    // Textbox5
32035>>>
32035>>>        Object Textbox6 is a Textbox
32037>>>            Set Label to "â"
32038>>>            Set Auto_Size_State to FALSE
32039>>>            Set Transparent_State to TRUE
32040>>>            Set Color to clWhite
32041>>>            Set TextColor to clNavy
32042>>>            Set Location to 19 76
32043>>>            Set Size to 10 17
32044>>>
32044>>>            //AB-StoreStart
32044>>>                                        
32044>>>            Set Label To (left(t.calendar.Friday,2))
32045>>>            //AB-StoreEnd
32045>>>
32045>>>        End_Object    // Textbox6
32046>>>
32046>>>        Object Textbox7 is a Textbox
32048>>>            Set Label to "¡"
32049>>>            Set Auto_Size_State to FALSE
32050>>>            Set Transparent_State to TRUE
32051>>>            Set Color to clWhite
32052>>>            Set TextColor to clNavy
32053>>>            Set Location to 19 91
32054>>>            Set Size to 10 18
32055>>>
32055>>>            //AB-StoreStart
32055>>>                                        
32055>>>            Set Label To (left(t.calendar.Saturday,2))
32056>>>            //AB-StoreEnd
32056>>>
32056>>>        End_Object    // Textbox7
32057>>>
32057>>>        Object Textbox8 is a Textbox
32059>>>            Set Label to "á"
32060>>>            Set Auto_Size_State to FALSE
32061>>>            Set Transparent_State to TRUE
32062>>>            Set Color to clWhite
32063>>>            Set TextColor to clNavy
32064>>>            Set Location to 19 109
32065>>>            Set Size to 10 17
32066>>>
32066>>>            //AB-StoreStart
32066>>>                                        
32066>>>            Set Label To (left(t.calendar.Sunday,2))
32067>>>            //AB-StoreEnd
32067>>>
32067>>>        End_Object    // Textbox8
32068>>>
32068>>>        Object LineControl1 is a LineControl
32070>>>            Set Line_Style to lnSINGLE
32071>>>            Set Size to 1 116
32072>>>            Set Location to 28 4
32073>>>
32073>>>            //AB-StoreStart
32073>>>                                        
32073>>>            //AB-StoreEnd
32073>>>
32073>>>        End_Object    // LineControl1
32074>>>
32074>>>        Object Container3d2 is a Container3d
32076>>>            Set Size to 18 131
32077>>>            Set Location to 1 1
32078>>>            Set Color to clNavy
32079>>>            Set Border_Style to Border_None
32080>>>            Object oRght is a BitmapContainer
32082>>>                Set Size to 10 14
32083>>>                Set Location to 4 105
32084>>>                Set Bitmap to "rght.bmp"
32085>>>                Set Border_Style to Border_None
32086>>>
32086>>>                //AB-StoreStart
32086>>>                Procedure Mouse_Down
32088>>>                    Send Next_Month to Grid2
32089>>>                End_Procedure
32090>>>                //AB-StoreEnd
32090>>>
32090>>>            End_Object    // oRght
32091>>>
32091>>>            Object oLeft is a BitmapContainer
32093>>>                Set Size to 10 14
32094>>>                Set Location to 4 3
32095>>>                Set Bitmap to "lft.bmp"
32096>>>                Set Border_Style to Border_None
32097>>>
32097>>>                //AB-StoreStart
32097>>>                Procedure Mouse_Down
32099>>>                    Send Prev_Month to Grid2
32100>>>                End_Procedure
32101>>>                //AB-StoreEnd
32101>>>
32101>>>            End_Object    // oLeft
32102>>>
32102>>>            Object oMonth is a Textbox
32104>>>
32104>>>                //AB-StoreTopStart
32104>>>                Property integer piSelected_Month public 0
32106>>>                //AB-StoreTopEnd
32106>>>
32106>>>                Set Label to "January"
32107>>>                Set Auto_Size_State to FALSE
32108>>>                Set Transparent_State to TRUE
32109>>>                Set Color to clWhite
32110>>>                Set TextColor to clWhite
32111>>>                Set Location to 4 23
32112>>>                Set Size to 10 43
32113>>>                Set FontWeight to 800
32114>>>                Set Justification_Mode to jMode_Center
32115>>>
32115>>>                //AB-StoreStart
32115>>>                                    
32115>>>                Procedure Mouse_Down
32117>>>                    Integer iState
32118>>>                    Get Visible_State of oSelectYear to iState
32119>>>                    If (iState) Send OnKillFocus to oSelectYear
32122>>>                    Send Popup to oSelectMonth
32123>>>                End_Procedure
32124>>>                
32124>>>                Procedure pSelectJan
32126>>>                    Set Label to t.calendar.january
32127>>>                    Set piSelected_Month to 1
32128>>>                    Send Adjust_Calendar
32129>>>                End_Procedure
32130>>>                Procedure pSelectFeb
32132>>>                    Set Label to t.calendar.february
32133>>>                    Set piSelected_Month to 2
32134>>>                    Send Adjust_Calendar
32135>>>                End_Procedure
32136>>>                Procedure pSelectMar
32138>>>                    Set Label to t.calendar.march
32139>>>                    Set piSelected_Month to 3
32140>>>                    Send Adjust_Calendar
32141>>>                End_Procedure
32142>>>                Procedure pSelectApr
32144>>>                    Set Label to t.calendar.april
32145>>>                    Set piSelected_Month to 4
32146>>>                    Send Adjust_Calendar
32147>>>                End_Procedure
32148>>>                Procedure pSelectMay
32150>>>                    Set Label to t.calendar.may
32151>>>                    Set piSelected_Month to 5
32152>>>                    Send Adjust_Calendar
32153>>>                End_Procedure
32154>>>                Procedure pSelectJun
32156>>>                    Set Label to t.calendar.june
32157>>>                    Set piSelected_Month to 6
32158>>>                    Send Adjust_Calendar
32159>>>                End_Procedure
32160>>>                Procedure pSelectJul
32162>>>                    Set Label to t.calendar.july
32163>>>                    Set piSelected_Month to 7
32164>>>                    Send Adjust_Calendar
32165>>>                End_Procedure
32166>>>                Procedure pSelectAug
32168>>>                    Set Label to t.calendar.august
32169>>>                    Set piSelected_Month to 8
32170>>>                    Send Adjust_Calendar
32171>>>                End_Procedure
32172>>>                Procedure pSelectSep
32174>>>                    Set Label to t.calendar.september
32175>>>                    Set piSelected_Month to 9
32176>>>                    Send Adjust_Calendar
32177>>>                End_Procedure
32178>>>                Procedure pSelectOct
32180>>>                    Set Label to t.calendar.october
32181>>>                    Set piSelected_Month to 10
32182>>>                    Send Adjust_Calendar
32183>>>                End_Procedure
32184>>>                Procedure pSelectNov
32186>>>                    Set Label to t.calendar.november
32187>>>                    Set piSelected_Month to 11
32188>>>                    Send Adjust_Calendar
32189>>>                End_Procedure
32190>>>                Procedure pSelectDec
32192>>>                    Set Label to t.calendar.december
32193>>>                    Set piSelected_Month to 12
32194>>>                    Send Adjust_Calendar
32195>>>                End_Procedure
32196>>>                
32196>>>                Object oSelectMonth is a FloatingPopupMenu
32198>>>                    Send Add_Item msg_pSelectJan t.calendar.january
32199>>>                    Send Add_Item msg_pSelectFeb t.calendar.february
32200>>>                    Send Add_Item msg_pSelectMar t.calendar.march
32201>>>                    Send Add_Item msg_pSelectApr t.calendar.april
32202>>>                    Send Add_Item msg_pSelectMay t.calendar.may
32203>>>                    Send Add_Item msg_pSelectJun t.calendar.june
32204>>>                    Send Add_Item msg_pSelectJul t.calendar.july
32205>>>                    Send Add_Item msg_pSelectAug t.calendar.august
32206>>>                    Send Add_Item msg_pSelectSep t.calendar.september
32207>>>                    Send Add_Item msg_pSelectOct t.calendar.october
32208>>>                    Send Add_Item msg_pSelectNov t.calendar.november
32209>>>                    Send Add_Item msg_pSelectDec t.calendar.december
32210>>>                End_Object
32211>>>                
32211>>>                Procedure Adjust_Calendar
32213>>>                    Date date#
32214>>>                    Integer iDay iMonth iYear iItm
32214>>>                    Set Visible_State to false
32215>>>                    Set Visible_State to true
32216>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32217>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32218>>>                    Get piSelected_Month to iMonth
32219>>>                    Get Label of oYear to iYear
32220>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32221>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32222>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32223>>>                End_Procedure
32224>>>                
32224>>>                Procedure Activating
32226>>>                    Forward Send Activating
32228>>>                    Send Date_Changing
32229>>>                End_Procedure
32230>>>                
32230>>>                Procedure Date_Changing
32232>>>                    Set Visible_State to false
32233>>>                    Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
32234>>>                    Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
32235>>>                    Set Visible_State to true
32236>>>                End_Procedure
32237>>>                
32237>>>                
32237>>>                //AB-StoreEnd
32237>>>
32237>>>            End_Object    // oMonth
32238>>>
32238>>>            Object oYear is a Textbox
32240>>>                Set Label to "2001"
32241>>>                Set Transparent_State to TRUE
32242>>>                Set Color to clWhite
32243>>>                Set TextColor to clWhite
32244>>>                Set Location to 4 77
32245>>>                Set Size to 10 18
32246>>>                Set FontWeight to 800
32247>>>
32247>>>                //AB-StoreStart
32247>>>                                                    
32247>>>                Procedure Mouse_Down
32249>>>                    String sVal
32250>>>                    Get Label to sVal
32251>>>                    Set Value of oSelectYear item 0 to sVal
32252>>>                    Set Visible_State of oSelectYear to True
32253>>>                    Send Activate to (oSelectYear(Self))
32254>>>                End_Procedure
32255>>>                
32255>>>                Procedure Activating
32257>>>                    Forward Send Activating
32259>>>                    Send Date_Changing
32260>>>                End_Procedure
32261>>>                
32261>>>                Procedure Date_Changing
32263>>>                    Set Visible_State to false
32264>>>                    Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
32265>>>                    Set Visible_State to true
32266>>>                End_Procedure
32267>>>                //AB-StoreEnd
32267>>>
32267>>>            End_Object    // oYear
32268>>>
32268>>>            Object oSelectYear is a Form
32270>>>
32270>>>                //AB-StoreTopStart
32270>>>                Set Visible_State To False
32271>>>                //AB-StoreTopEnd
32271>>>
32271>>>                Set Size to 10 24
32272>>>                Set Location to 4 75
32273>>>                Set Color to clWhite
32274>>>                Set TextColor to clNavy
32275>>>                Set Form_Border Item 0 to Border_Normal
32276>>>
32276>>>                //AB-StoreStart
32276>>>                                                    
32276>>>                On_Key Key_Enter Send OnKillFocus
32277>>>                On_Key Key_Escape Send OnKillFocus
32278>>>                
32278>>>                Procedure SetFontWeight
32280>>>                    Set Form_FontWeight item 0 to 800
32281>>>                End_Procedure
32282>>>                
32282>>>                Procedure OnKillFocus
32284>>>                    String sVal
32285>>>                    Integer iMonth iDay iYear iItm
32285>>>                    Date date#
32285>>>                    Get Value item 0 to sVal
32286>>>                    Set Visible_State of oYear to false
32287>>>                    Set Label of oYear to sVal
32288>>>                    Set Visible_State of oYear to true
32289>>>                    Set Visible_State to false
32290>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32291>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32292>>>                    Get piSelected_Month of oMonth to iMonth
32293>>>                    Get Value item 0 to iYear
32294>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32295>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32296>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32297>>>                End_Procedure
32298>>>                
32298>>>                Send SetFontWeight
32299>>>                //AB-StoreEnd
32299>>>
32299>>>            End_Object    // oSelectYear
32300>>>
32300>>>
32300>>>            //AB-StoreStart
32300>>>                            
32300>>>            Procedure Mouse_Down
32302>>>                Integer iState
32303>>>                Get Visible_State of oSelectYear to iState
32304>>>                If (iState) Send OnKillFocus to oSelectYear
32307>>>            End_Procedure
32308>>>            
32308>>>            //AB-StoreEnd
32308>>>
32308>>>        End_Object    // Container3d2
32309>>>
32309>>>
32309>>>        //AB-StoreStart
32309>>>                            
32309>>>        //AB-StoreEnd
32309>>>
32309>>>    End_Object    // Container3d1
32310>>>
32310>>>    Object BitmapContainer3 is a BitmapContainer
32312>>>        Set Size to 9 19
32313>>>        Set Location to 88 3
32314>>>        Set Color to clWhite
32315>>>        Set Bitmap to "cdate.bmp"
32316>>>        Set Border_Style to Border_None
32317>>>
32317>>>        //AB-StoreStart
32317>>>        Procedure Mouse_Down
32319>>>            Send go_today to (Grid2(Container3d1(Self)))
32320>>>            Send Adjust_Label to oToday
32321>>>        End_Procedure
32322>>>        //AB-StoreEnd
32322>>>
32322>>>    End_Object    // BitmapContainer3
32323>>>
32323>>>    Object oToday is a Textbox
32325>>>        Set Label to "Today: 01.01.2001"
32326>>>        Set Auto_Size_State to FALSE
32327>>>        Set Color to clWhite
32328>>>        Set Location to 88 22
32329>>>        Set Size to 8 73
32330>>>        Set FontWeight to 800
32331>>>
32331>>>        //AB-StoreStart
32331>>>        Procedure Mouse_Down
32333>>>            Send go_today to (Grid2(Container3d1(Self)))
32334>>>            Send Adjust_Label
32335>>>        End_Procedure
32336>>>        
32336>>>        Procedure Adjust_Label
32338>>>            date date#
32339>>>            SysDate4 date#
32340>>>            Set Visible_State To false
32341>>>            Set Label         to (t.calendar.today+": "+String(date#))
32342>>>            Set Visible_State To true
32343>>>        End_Procedure
32344>>>        
32344>>>        Procedure Activating
32346>>>            Forward Send Activating
32348>>>            Send Adjust_Label
32349>>>        End_Procedure
32350>>>        //AB-StoreEnd
32350>>>
32350>>>    End_Object    // oToday
32351>>>
32351>>>
32351>>>    //AB-StoreStart
32351>>>                
32351>>>    procedure popup
32353>>>        local integer focus# icItm iYear iMonth
32354>>>        local date date#
32354>>>        move (focus(desktop)) to focus#
32355>>>        set invoking_object_id of (Grid2(Container3d1(self))) to focus#
32356>>>        get value of focus# item current to date#
32357>>>        ifnot (integer(date#)) sysdate date#
32360>>>        move (Date2to4(date#)) to date#
32361>>>        set p_current_date of (Grid2(Container3d1(self))) to date#
32362>>>        send fill_list to (Grid2(Container3d1(self)))
32363>>>        move (DateSegment(date#,DS_YEAR)) to iYear
32364>>>        move (DateSegment(date#,DS_MONTH)) to iMonth
32365>>>        Set Label To (MonthName(iMonth)+', '+String(iYear))
32366>>>        forward send popup
32368>>>    end_procedure
32369>>>    
32369>>>    Procedure Close_Calendar
32371>>>        Send Exit
32372>>>    End_Procedure
32373>>>    //AB-StoreEnd
32373>>>
32373>>>CD_End_Object    // oCalendar
32375>>>>
32375>>>
32375>>>
32375>>>//AB-StoreStart
32375>>>    
32375>>>    
32375>>>//AB-StoreEnd
32375>>>
32375>>>//AB/ End_Object    // prj
32375>// General Functions-Procedures and Variables
32375>Use Globals.Inc
INCLUDING FILE: GLOBALS.INC
32375>>>
32375>>>        String  gs_Selected_Company_Code
32375>>>        String  gs_Selected_Branch_Code
32375>>>        Integer gi_Selected_Year
32375>>>        String gs_Selected_Year_Recr
32375>>>        String  gs_Module_Code
32375>>>
32375>>>
32375>>>//Open Currency
32375>>>//Function CurrDigits Global String asCurr Returns Integer
32375>>>//    Integer liDecX
32375>>>//    Clear Currency
32375>>>//    move asCurr to Currency.Currency_C_Code
32375>>>//    Find Eq Currency By Index.1
32375>>>//    move Currency.Currency_Dec to liDecX
32375>>>//    Function_Return liDecX
32375>>>//End_Function // CurrDigits
32375>>>
32375>>>Open Nomisma
INCLUDING FILE: NOMISMA.FD
32377>>>Open SysCurXr
32379>>>
32379>>>Function fiDekadika_Nomismatos Global String asNomisma Returns Integer
32380>>>    Move (Trim(asNomisma)) to asNomisma
32381>>>    Clear Nomisma
32382>>>    If ( asNomisma<>'' ) Move asNomisma         to Nomisma.Nomisma_Code
32385>>>    Else                 Move SysCurXr.C_Code0  to Nomisma.Nomisma_Code
32387>>>    Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
32388>>>>
32388>>>    Function_Return Nomisma.Dekadika
32389>>>End_Function //
32390>>>
32390>>>Function fsgCode_W_Zeroes Global Integer aiCode Integer aiPlaces Returns String
32391>>>    String rVal
32392>>>    Integer iLength iInt
32392>>>    Move aiCode to rVal
32393>>>    Move (trim(rVal)) to rVal
32394>>>    For iInt From 1 to (aiPlaces-(Length(rVal)))
32400>>>>
32400>>>        Move (Insert('0',rVal,1)) to rVal
32401>>>    Loop
32402>>>>
32402>>>    Function_Return rVal
32403>>>End_Function
32404>>>
32404>>>Function fsgCode_n_Zeroes Global number aiCode Integer aiPlaces Returns String
32405>>>    String rVal
32406>>>    Integer iLength iInt ipos
32406>>>    Move aiCode to rVal
32407>>>    Move (trim(rVal)) to rVal
32408>>>    MOVE (aiPlaces-(Length(rVal))) to ipos
32409>>>    For iInt From 1 to ipos
32415>>>>
32415>>>        Move (Insert('0',rVal,1)) to rVal
32416>>>    Loop
32417>>>>
32417>>>    Function_Return rVal
32418>>>End_Function
32419>>>
32419>>>
32419>>>Open Year
INCLUDING FILE: YEAR.FD
32421>>>Procedure EnumDDsForRebuildConstrain for DataDictionary integer aiMsg integer ahId
32422>>>    Send aiMsg to Self
32423>>>End_Procedure
32424>>>
32424>>>Procedure DoRefindYear for baseclass Integer aiPanel Integer aiYearDD
32425>>>    Integer liChanged
32426>>>
32426>>>    If ((aiYearDD = 0) or (Main_File(aiYearDD)<>Year.File_Number)) ;        Procedure_Return (Message_Box("Invalid Year_DD","Developer's Warning",MB_OK,MB_ICONWARNING))
32429>>>    If (Not(Current_Record(aiYearDD))) Begin
32431>>>        Get Should_Save of aiPanel to liChanged
32432>>>        Send Clear to aiYearDD
32433>>>        Move gs_Selected_Company_Code to Year.Company_Code
32434>>>        Move gs_Selected_Branch_Code  to Year.Branch_Code
32435>>>        Move gi_Selected_Year         to Year.Year_Year
32436>>>        Send Find to aiYearDD Eq 1 //Year.Index.1 - company_code+ranch_code+year_year
32437>>>        If (Not(liChanged)) Set Changed_State of aiPanel to False
32440>>>    End
32440>>>>
32440>>>End_Procedure
32441>>>
32441>>>Procedure RebuildConstrainIfYearChanged for baseclass Integer aiPanel String asCurrentYearRecr Integer aiYearDDId
32442>>>    Integer liSrvr
32443>>>    String  lsCurrentYearRecr
32443>>>
32443>>>    If (asCurrentYearRecr <> gs_Selected_Year_Recr) Begin
32445>>>        Broadcast Send EnumDDsForRebuildConstrain to aiPanel msg_Rebuild_Constraints Self
32447>>>    End
32447>>>>
32447>>>    Send DoRefindYear aiPanel aiYearDDId //(Year_DD(Self))
32448>>>    Get Server of aiPanel to liSrvr
32449>>>    // Respects Default values
32449>>>    If (liSrvr) If (Not(Current_Record(liSrvr))) Send Request_Clear to aiPanel
32454>>>End_Procedure
32455>>>
32455>>>//                                       ¦ View            Property «¦¬ View             ¦ Year DDO «¦¬ View
32455>>>//                                                          Holds the current year rec0
32455>>>// ¢ã© : Send RbldConstrIfYearChanged (Gplan_Test(Self))  (psCurrentYearRecr(Self))     (Year_DD(Self))
32455>>>
32455>>>
32455>>>Function fiRefindYear Global Returns Integer
32456>>>    Clear Year
32457>>>    Move gs_Selected_Company_Code to Year.Company_Code
32458>>>    Move gs_Selected_Branch_Code  to Year.Branch_Code
32459>>>    Move gi_Selected_Year         to Year.Year_Year
32460>>>    Find eq Year by Index.1 //company_code+ranch_code+year_year
32461>>>>
32461>>>    Function_Return (Found = 0)
32462>>>End_Function //fiRefindYear
32463>>>
32463>>>Procedure DoRunApplication for Baseclass String sAppName
32464>>>    string sRuntime  lsStr
32465>>>
32465>>>    Append lsStr 'C:\Dns.bat ' sAppName
32467>>>    RunProgram Wait  lsStr
32468>>>
32468>>>//    get_profile_string "defaults" "VDFBinDir" to sRuntime
32468>>>//    append sRuntime "\dfrun " sAppName
32468>>>    Append sRuntime 'C:\Program Files\Accessories\WORDPAD.EXE ' sAppName
32470>>>    runprogram background sRuntime
32471>>>End_procedure // DoRunApplication
32472>>>
32472>>>// Run the Editor
32472>>>Procedure DoRunEditor for Baseclass String asFile
32473>>>    string sRunPath lsWspcName
32474>>>    Move (WorkspaceName(ProgramWorkspace(Self))) to lsWspcName
32475>>>    get_profile_string ("workspaces\"+lsWspcName) "programpath" to sRunPath
32478>>>    //append sRunPath "\Editor "  asFile //// js 15/03/2002 " " lsWspcName
32478>>>    Move (Replace('.',asFile,'')) to asFile
32479>>>    append sRunPath asFile //// js 15/03/2002 " " lsWspcName
32480>>>    send DoRunApplication sRunPath
32481>>>End_Procedure // DoRunEditor
32482>>>
32482>>>//--------------------------------------
32482>>>
32482>>>//start of global functions and procedures
32482>>>
32482>>>
32482>>>//®¨© £¦§¦ å«  §æ: ) gmoves.dd    :private.update_gmhnes_ghmnies
32482>>>Function gsfFind_Previous Global String lsCode;                                 String lsDelimiter;                                 Returns String
32483>>>         String  lsTemp_Code1 lsTemp_Code2
32484>>>         Integer liCounter
32484>>>
32484>>>         //1.­å¨© ¡¤é¤
32484>>>         Move (Trim(lsCode)) to lsCode                                  //§® 30.12.345
32485>>>
32485>>>         //2.¤« ©«¨¦­ã
32485>>>         For liCounter From 1 to (Length(lsCode))
32491>>>>
32491>>>             Move (Insert(;                           (Mid(lsCode,1,liCounter)),;                           lsTemp_Code1,;                           1;                         )) to lsTemp_Code1                             //§® 543.21.03
32492>>>         Loop
32493>>>>
32493>>>
32493>>>         //3.­å¨© ¡¤é¤ (â¤ ®¨ á« , safety only)
32493>>>         Move (Trim(lsTemp_Code1)) to lsTemp_Code1
32494>>>
32494>>>         //4.§å¨¤à £æ¤¦ «¦ ¥ æ £â¨¦ª «¦¬ ¤«å©«¨¦­¦¬, £«á «¦ §¨é«¦ delimiter
32494>>>         Move (Right(;                      lsTemp_Code1,;                      ((Length(lsTemp_Code1))-((Pos(lsDelimiter,lsTemp_Code1))));                    )) to lsTemp_Code1                                  // §® 21.03
32495>>>
32495>>>         //5.¥¤á ¤« ©«¨¦­ã «¦¬ ¤«å©«¨¦­¦¬
32495>>>         For liCounter from 1 to (Length(lsTemp_Code1))
32501>>>>
32501>>>             Move (Insert(;                           (Mid(lsTemp_Code1,1,liCounter)),;                           lsTemp_Code2,;                           1;                         )) to lsTemp_Code2                             //§® 30.12
32502>>>         Loop
32503>>>>
32503>>>
32503>>>         Function_Return (Trim(lsTemp_Code2))
32504>>>End_Function //gsffind_previous
32505>>>
32505>>>
32505>>>Function gifSystem_Check Returns Integer
32506>>>         Integer liF_Gtypkins liF_Garicls liF_Gmoves liF_Gplans liF_Gmhnes liF_Ghmnies
32507>>>         Integer liS_Gtypkins liS_Garicls liS_Gmoves liS_Gplans liS_Gmhnes liS_Ghmnies
32507>>>//       Clear Company
32507>>>//       Find Gt Company.Recnum
32507>>>//       While (Found = 1)
32507>>>//             Add Company.Company_NumGtypkin to liS_Gtypkins § ¤é© ©«¦ sysfile ¤ « ¡¨«áà ¬«á
32507>>>//             Add Company.Company_NumGarticl to liS_Garticls
32507>>>//             Add Company.Company_NumGmoves  to liS_Gmoves
32507>>>//             //d Company.Company_NumGtypkin to liS_Gtypkins
32507>>>//             Add Company.Company_NumGplan   to liS_GPlans
32507>>>//             Add Company.Company_NumGmhnes  to liS_Gmhnes
32507>>>//             Add Company.Company_NumGhmnies to liS_Ghmnies
32507>>>//             Find Gt Company.Recnum
32507>>>//       Loop
32507>>>//
32507>>>//       Get_Attribute {attribute} [of {file-handle} ;
32507>>>//                        [{field-num} | {index-num} [{segment-num}]]] ;
32507>>>//                        To {variable}
32507>>>//
32507>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
32507>>>//       Get_Attribute DF_FILE_RECORDS_USED of Garticl.File_Number to liF_Garticls
32507>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmoves.File_Number  to liF_Gmoves
32507>>>//       //t_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
32507>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gplan.File_Number   to liF_Gplans
32507>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmhnes.File_Number  to liF_Gmhnes
32507>>>//       Get_Attribute DF_FILE_RECORDS_USED of Ghmnies.File_Number to liF_Ghmnies
32507>>>//
32507>>>
32507>>>//       //â¢®¦ª DF_FILE_MAX_RECORDS+ £ records used
32507>>>
32507>>>//       //â¢®¦ª last rec0 = sysrec rec0
32507>>>
32507>>>    Function_Return 0
32508>>>End_Function //gifSystem_Check
32509>>>
32509>>>/////////////////////////////////////////////////////////////////
32509>>>//  §  Numeric £«¢«¦¬ £ã¡¦¬ª, £  ®à¨åª ¡ ¡á  JS
32509>>>Function Sfi_All_Numbers Global Number anValue Integer aiLengthAkeraios Integer aiLengthDekadika Returns String
32510>>>
32510>>>    String  lsRetval lsValue lsAkeraios lsDekadika
32511>>>    Integer liInt liInteger iTimes iStart
32511>>>    Number  lnDecimals
32511>>>
32511>>>    Move (Integer(anValue))                                         to liInteger
32512>>>    Move (Round(AnValue-(Integer(anValue))*(10^aiLengthDekadika)))  to lnDecimals
32513>>>
32513>>>    Move liInteger              to lsAkeraios
32514>>>    Move lnDecimals             to lsDekadika
32515>>>    Move (Trim(lsAkeraios))     to lsAkeraios
32516>>>    Move (Trim(lsDekadika))     to lsDekadika
32517>>>
32517>>>    Move (Length(lsAkeraios)) to iStart
32518>>>    For iTimes From iStart to (aiLengthAkeraios-1)
32524>>>>
32524>>>        Insert "0" in lsAkeraios at 1
32526>>>    Loop
32527>>>>
32527>>>    Move (Trim(lsAkeraios)) to lsAkeraios
32528>>>
32528>>>    Move (Length(lsDekadika)) to iStart
32529>>>    For iTimes From iStart to (aiLengthDekadika-1)
32535>>>>
32535>>>        Move (Append(lsDekadika,"0")) to lsDekadika
32536>>>    Loop
32537>>>>
32537>>>    Move (Trim(lsDekadika)) to lsDekadika
32538>>>
32538>>>    If (aiLengthDekadika=0) Move '' to lsDekadika
32541>>>    Move '' to lsRetVal
32542>>>    Move (Pad((lsAkeraios-lsDekadika),(aiLengthAkeraios+aiLengthDekadika))) to lsRetval
32543>>>    Function_Return lsRetval
32544>>>End_Function //sfi_All_Numbers    §  Numeric £«¢«¦¬ £ã¡¦¬ª
32545>>>              //                 £  ®à¨åª ¡ ¡á (JS)
32545>>>
32545>>>Open Codemast
32547>>>
32547>>>
32547>>>Function gsfCode_Mast Global String lsType String lsValue Returns String
32548>>>         Clear Codemast
32549>>>         Move lsType  to Codemast.Type
32550>>>         Move lsValue to Codemast.Code
32551>>>         Find Eq Codemast by Index.1 //type+code
32552>>>>
32552>>>         Function_Return Codemast.Description
32553>>>End_Function //code_mast
32554>>>
32554>>>
32554>>>Open Branch
INCLUDING FILE: BRANCH.FD
32556>>>Function fsgCode_With_Zeroes Global Integer aiCode    ;                                    Integer aiPlaces  ;                                    String asCompany  ;                                    String asBranch   ;                               Returns String
32557>>>    String rVal
32558>>>    Integer iInt
32558>>>    Clear Branch
32559>>>    Move asCompany  to Branch.Company_Code
32560>>>    Move asBranch   to Branch.Branch_Code
32561>>>    Find Eq Branch by Index.1
32562>>>>
32562>>>    If (Trim(Branch.Tomeas_Code)<>'') Move (Trim(Branch.Tomeas_Code)) to asBranch
ERROR: 54 Invalid symbol in expression BRANCH.TOMEAS_CODE ON LINE: 282 (32562) OF FILE: C:\Vdf6\Develop\Empor\AppSrc\GLOBALS.INC
32565>>>    Move (Trim(asCompany))  to asCompany
32566>>>    Move (Trim(asBranch))   to asBranch
32567>>>    If (Length(asCompany)=1) Insert '0' In asCompany At 1
32571>>>    If (Length(asBranch) =1) Insert '0' In asBranch  At 1
32575>>>    Move ''                                           to rVal
32576>>>    Move (Sfi_All_Numbers(aiCode,aiPlaces,0))         to rVal
32577>>>    Move (Append((asCompany+'.'+asBranch+'.'),rVal))  to rVal
32578>>>    Move (Trim(rVal))                                 to rVal
32579>>>    Function_Return rVal
32580>>>End_Function
32581>>>
32581>>>Function fsgStripCodeFromID Global String asID Returns Integer
32582>>>      Integer iLen iPos iInt
32583>>>      If (Trim(asID)='') Function_Return 0
32586>>>      Move (Trim  (asID)) to asID
32587>>>      Move (Length(asID)) to iLen
32588>>>      For iInt From 1     to iLen
32594>>>>
32594>>>          If (Mid(asID,1,iInt)='.') Move iInt to iPos
32597>>>      Loop
32598>>>>
32598>>>      Function_Return (Right(asID,(iLen-iPos)))
32599>>>End_Function
32600>>>
32600>>>Function fsCityDescr Global Integer aiCityID Returns String
32601>>>    String rVal
32602>>>    Open Cities
INCLUDING FILE: CITIES.FD
32604>>>    Clear Cities
32605>>>    Move aiCityID to Cities.City_ID
32606>>>    Find Eq Cities By Index.1
32607>>>>
32607>>>    If (Found=1) Move Cities.City_descr to rVal
32610>>>    Else         Move '' to rVal
32612>>>    Function_Return rVal
32613>>>End_Function
32614>>>
32614>>>Function fiTownIDFromCity Global Integer aiCityID Returns Integer
32615>>>    Open Cities
32617>>>    Clear Cities
32618>>>    Move aiCityID to Cities.City_ID
32619>>>    Find Eq Cities By Index.1
32620>>>>
32620>>>    Function_Return Cities.Town_ID
32621>>>End_Function
32622>>>
32622>>>Function fiCountryIDFromTown Global Integer aiTownID Returns Integer
32623>>>    Open Towns
INCLUDING FILE: TOWNS.FD
32625>>>    Clear Towns
32626>>>    Move aiTownID to Towns.Town_ID
32627>>>    Find Eq Towns By Index.1
32628>>>>
32628>>>    Function_Return Towns.Country_ID
32629>>>End_Function
32630>>>
32630>>>Function fsTownDescr Global Integer aiTownID Returns String
32631>>>    String rVal
32632>>>    Open Towns
32634>>>    Clear Towns
32635>>>    Move aiTownID to Towns.Town_ID
32636>>>    Find Eq Towns By Index.1
32637>>>>
32637>>>    If (Found=1) Move Towns.Town_descr to rVal
32640>>>    Else         Move '' to rVal
32642>>>    Function_Return rVal
32643>>>End_Function
32644>>>
32644>>>Function fsCountryDescr Global Integer aiCountryID Returns String
32645>>>    String rVal
32646>>>    Open Country
INCLUDING FILE: COUNTRY.FD
32648>>>    Clear Country
32649>>>    Move aiCountryID to Country.Country_ID
32650>>>    Find Eq Country By Index.1
32651>>>>
32651>>>    If (Found=1) Move Country.Country_descr to rVal
32654>>>    Else         Move '' to rVal
32656>>>    Function_Return rVal
32657>>>End_Function
32658>>>
32658>>>Function fsAreaDescr Global Integer aiAreaID Returns String
32659>>>    String rVal
32660>>>    Open Areas
INCLUDING FILE: AREAS.FD
32662>>>    Clear Areas
32663>>>    Move aiAreaID to Areas.Area_ID
32664>>>    Find Eq Areas By Index.1
32665>>>>
32665>>>    If (Found=1) Move Areas.Area_descr to rVal
32668>>>    Else         Move '' to rVal
32670>>>    Function_Return rVal
32671>>>End_Function
32672>>>
32672>>>Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
32673>>>    Local String rVal lsTmp lsOO lsLL
32674>>>    Local Number lnOO lnLL
32674>>>
32674>>>    Move '' to lsOO
32675>>>    Move '' to lsLL
32676>>>    Move '' to rVal
32677>>>
32677>>>    Move (Integer(anTime))                              to lnOO
32678>>>
32678>>>    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
32679>>>
32679>>>    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
32682>>>    Else         Move (String(lnOO))                    to lsOO
32684>>>    Move (Trim(lsOO))                                   to lsOO
32685>>>
32685>>>    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
32688>>>    Else         Move (String(lnLL))                    to lsLL
32690>>>    Move (Trim(lsLL))                                   to lsLL
32691>>>
32691>>>    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
32692>>>
32692>>>    Move (Trim(rVal)) to rVal
32693>>>
32693>>>    Function_Return rVal
32694>>>End_Function
32695>>>
32695>>>Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
32696>>>    Local Number rVal nOres nLepta
32697>>>    Move (Integer(aiMinutes/60))    to nOres
32698>>>    Move (    Mod(aiMinutes,60))    to nLepta
32699>>>    Move (nOres+(nLepta/100))       to rVal
32700>>>    Function_Return rVal
32701>>>End_Function
32702>>>
32702>>>Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
32703>>>    Local Integer rVal
32704>>>    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
32705>>>    Function_Return rVal
32706>>>End_Function
32707>>>
32707>>>Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;                                                                    Number anEndTime    ;                                                                    Returns Integer
32708>>>    Local Integer rVal iMinStart iMinEnd
32709>>>
32709>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
32712>>>
32712>>>    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
32713>>>    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
32714>>>    Move (iMinEnd-iMinStart)                                                     to rVal
32715>>>    Function_Return rVal
32716>>>End_Function
32717>>>
32717>>>
32717>>>Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;                                                                Number anEndTime    ;                                                                Returns Number
32718>>>    Local Integer iTmp
32719>>>    Local Number  rVal
32719>>>
32719>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
32722>>>
32722>>>    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
32723>>>    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
32724>>>    Function_Return rVal
32725>>>End_Function
32726>>>
32726>>>
32726>>>
32726>>>Open WitemCL
INCLUDING FILE: WITEMCL.FD
32728>>>Open WitemCld
INCLUDING FILE: WITEMCLD.FD
32730>>>Open WitemxT
INCLUDING FILE: WITEMXT.FD
32732>>>
32732>>>Function fnTeleytaiaTimhAgoras String asPromCode String asItemCode  ;                               Date   adHmnia    Number anQty       ;                               Returns Number
32733>>>  Integer iExodos
32734>>>  Number nPoso nPct
32734>>>  Move 0 to nPoso
32735>>>  Move 0 to nPct
32736>>>  Move 0 to iExodos
32737>>>
32737>>>  Move (Trim(asItemCode)) to asItemCode
32738>>>  Move (Trim(asPromCode)) to asPromCode
32739>>>
32739>>>  // 1.Anazhthsh sto arxeio Witemcld
32739>>>  Clear Witemcld
32740>>>  Move asItemCode to Witemcld.Item_Code
32741>>>  Move asPromCode to Witemcld.Client_Code
32742>>>  Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
32743>>>>
32743>>>  While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;                       (Witemcld.Client_Code= asPromCode) And ;                       (iExodos=0))
32747>>>      If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
32749>>>          Move 1 to iExodos
32750>>>               If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
32753>>>          Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
32757>>>      End
32757>>>>
32757>>>      Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
32758>>>>
32758>>>  Loop
32759>>>>
32759>>>  If (iExodos) Begin
32761>>>      If (nPoso) Function_Return nPoso
32764>>>      Else Function_Return nPct
32766>>>  End
32766>>>>
32766>>>
32766>>>  // 2.Anazhthsh sto arxeio Witemcl
32766>>>  Clear WitemCL
32767>>>  Move (Trim(asPromCode)) to WitemCL.Client_Code
32768>>>  Move (Trim(asItemCode)) to WitemCL.Item_Code
32769>>>  Find Eq WitemCL By Index.1
32770>>>>
32770>>>  If (Found=1) Function_Return WitemCL.Client_Price
32773>>>
32773>>>  Function_Return 0
32774>>>End_Function
32775>>>
32775>>>Open BtnOrdd
INCLUDING FILE: BTNORDD.FD
32777>>>Function fnTeleytaiaTimhPolhshs String asWitemxRecr String asClientID ;                                String asWitemxCode Date   adHmnia    ;                                String asItemCode   Number anQty      ;                                String asCNCode     Returns Number
32778>>>
32778>>>  Integer iExodos iCheckDeop
32779>>>  Number nPoso nPct
32779>>>
32779>>>  Move (Num_Arguments=7) to iCheckDeop
32780>>>
32780>>>  Move 0 to nPoso
32781>>>  Move 0 to nPct
32782>>>  Move 0 to iExodos
32783>>>
32783>>>  Move (Trim(asItemCode))                 to asItemCode
32784>>>  Move (Trim(asClientID))                 to asClientID
32785>>>  Move (Trim(asWitemxRecr))               to asWitemxRecr
32786>>>  Move (Trim(asWitemxCode))               to asWitemxCode
32787>>>  If (iCheckDeop) Move (Trim(asCNCode))   to asCNCode
32790>>>
32790>>>  // 1. Anazhthsh apo DEOP ef' oson yparxei kodikos ergou
32790>>>  If (iCheckDeop) Begin
32792>>>      Clear btnordd
32793>>>      Move asClientID   to btnordd.vclient_id
ERROR: 4345 Type check error BTNORDD.VCLIENT_ID, BTNORDD.VCLIENT_ID, BTN ON LINE: 505 (32793) OF FILE: C:\Vdf6\Develop\Empor\AppSrc\GLOBALS.INC
ERROR: 4328 Undefined symbol in argument BTNORDD.VCLIENT_ID ON LINE: 505 (32793) OF FILE: C:\Vdf6\Develop\Empor\AppSrc\GLOBALS.INC
32794>>>      Move asCNCode     to btnordd.vcn_code
ERROR: 4345 Type check error BTNORDD.VCN_CODE, BTNORDD.VCN_CODE, BTNORDD.VCN_CODE, BTNORDD ON LINE: 506 (32794) OF FILE: C:\Vdf6\Develop\Empor\AppSrc\GLOBALS.INC
ERROR: 4328 Undefined symbol in argument BTNORDD.VCN_CODE ON LINE: 506 (32794) OF FILE: C:\Vdf6\Develop\Empor\AppSrc\GLOBALS.INC
32795>>>      Move asWitemxCode to btnordd.vitem
32796>>>      Move 0            to btnordd.vactive
ERROR: 4345 Type check error BTNORDD.VACTIVE, BTNORDD.VACTIVE, BTNORDD.VACTIVE, BTNORDD.VACTIVE, BTNORDD.VA ON LINE: 508 (32796) OF FILE: C:\Vdf6\Develop\Empor\AppSrc\GLOBALS.INC
ERROR: 4328 Undefined symbol in argument BTNORDD.VACTIVE ON LINE: 508 (32796) OF FILE: C:\Vdf6\Develop\Empor\AppSrc\GLOBALS.INC
32797>>>      Move adHmnia      to btnordd.arxh_date
ERROR: 4345 Type check error BTNORDD.ARXH_DATE, BTNORDD.ARXH_DATE, BTNORDD.ARXH_DATE, BTNORDD.ARXH_DATE, BTNORDD.ARXH_DATE, BT ON LINE: 509 (32797) OF FILE: C:\Vdf6\Develop\Empor\AppSrc\GLOBALS.INC
ERROR: 4328 Undefined symbol in argument BTNORDD.ARXH_DATE ON LINE: 509 (32797) OF FILE: C:\Vdf6\Develop\Empor\AppSrc\GLOBALS.INC
32798>>>      Find LE btnordd by index.4//client_id+cn_code+item+arxh_date
32799>>>>
32799>>>      If ((found=1) and (asWitemxCode=btnordd.vitem)    and (adHmnia>=btnordd.arxh_date) ;                    and (adHmnia<=btnordd.deop_date)    and (btnordd.vactive=0)          ;                    and (asCNCode=btnordd.vcn_code)) begin
ERROR: 54 Invalid symbol in expression BTNORDD.ARXH_DATE ON LINE: 513 (32799) OF FILE: C:\Vdf6\Develop\Empor\AppSrc\GLOBALS.INC
32801>>>          move btnordd.vprice to nPoso
32802>>>          If (nPoso) Function_Return nPoso
32805>>>      End
32805>>>>
32805>>>  End
32805>>>>
32805>>>
32805>>>  // 2.Anazhthsh sto arxeio Witemcld (Timokatalogos Pelath/Eidous)
32805>>>  Clear Witemcld
32806>>>  Move asItemCode to Witemcld.Item_Code
32807>>>  Move asClientID to Witemcld.Client_Code
32808>>>  Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
32809>>>>
32809>>>  While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;                       (Witemcld.Client_Code= asClientID) And ;                       (iExodos=0))
32813>>>      If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
32815>>>          Move 1 to iExodos
32816>>>               If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
32819>>>          Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
32823>>>      End
32823>>>>
32823>>>      Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
32824>>>>
32824>>>  Loop
32825>>>>
32825>>>  If (iExodos) Begin
32827>>>      If (nPoso) Function_Return nPoso
32830>>>      Else Function_Return nPct
32832>>>  End
32832>>>>
32832>>>
32832>>>
32832>>>  // 3.Anazhthsh sto arxeio Witemxt (Timokatalogos Eidous)
32832>>>  Clear Witemxt
32833>>>  Move SysCurXr.Company_Code  to Witemxt.Company_Code
32834>>>  Move SysCurXr.Branch_Code   to Witemxt.Branch_Code
32835>>>  Move SysCurXr.Year_Year     to Witemxt.Year_Year
32836>>>  Move asWitemxRecr           to Witemxt.Witemx_Recr
32837>>>  Find Gt Witemxt By Index.1 // Witemxt:Index.1
32838>>>>
32838>>>  While ((Found=1) And (Witemxt.Company_Code = SysCurXr.Company_Code) And ;                       (Witemxt.Branch_Code  = SysCurXr.Branch_Code ) And ;                       (Witemxt.Year_Year    = SysCurXr.Year_Year   ) And ;                       (Witemxt.Witemx_Recr  = asWitemxRecr         ) And ;                       (iExodos=0))
32842>>>      If ((adHmnia>=Witemxt.Value_Date) And (anQty<=Witemxt.Qty)) Begin
32844>>>          Move 1 to iExodos
32845>>>               If (Witemxt.Axia0 <>0) Move  Witemxt.Axia0         to nPoso
32848>>>          Else If (Witemxt.PcDisc<>0) Move (Witemxt.PcDisc*(-1))  to nPct
32852>>>      End
32852>>>>
32852>>>      Find Gt Witemxt By Index.1 // Witemxt:Index.1
32853>>>>
32853>>>  Loop
32854>>>>
32854>>>  If (iExodos) Begin
32856>>>      If (nPoso) Function_Return nPoso
32859>>>      Else Function_Return nPct
32861>>>  End
32861>>>>
32861>>>
32861>>>
32861>>>  // 4.Anazhthsh sto arxeio Witemcl (Teleytaia Timh Agoras)
32861>>>  Clear WitemCL
32862>>>  Move (Trim(asClientID)) to WitemCL.Client_Code
32863>>>  Move (Trim(asItemCode)) to WitemCL.Item_Code
32864>>>  Find Eq WitemCL By Index.1
32865>>>>
32865>>>  If (Found=1) Function_Return WitemCL.Client_Price
32868>>>
32868>>>  Function_Return 0
32869>>>End_Function
32870>>>
32870>>>Function fsStripTextFieldFromEnter Global String asStr Returns String
32871>>>    String sEnter
32872>>>    Move '' to sEnter
32873>>>    Move (Trim(asStr)) to asStr
32874>>>    Append sEnter (Character(13)) (Character(10))
32876>>>    Move (Replaces(sEnter,asStr,' ')) to asStr
32877>>>    Function_return (Trim(asStr))
32878>>>End_function
32879>>>
32879>>>
32879>>>//end   of global functions and procedures
32879>>>Use Wait.DG
INCLUDING FILE: WAIT.DG
32879>>>>>USE AllEntSc
32879>>>>>
32879>>>>>//AB-IgnoreEnd
32879>>>>>
32879>>>>>
32879>>>>>//AB-IgnoreEnd
32879>>>>>
32879>>>>>Object Wait is a ModalPanelSub
32881>>>>>
32881>>>>>    //AB-StoreTopStart
32881>>>>>
32881>>>>>    // How to Use It
32881>>>>>    // Get the maximum position of the bar
32881>>>>>    // Move (Bar_Maximum_position(Wait(self))) to iMax
32881>>>>>    //
32881>>>>>    // Set the maximum position of the bar
32881>>>>>    // Set Bar_Maximum_position of (Wait(self)) to iMax
32881>>>>>    //
32881>>>>>    // Start Bar Progress from beginning
32881>>>>>    // Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
32881>>>>>    //
32881>>>>>    // End Bar Progress
32881>>>>>    // Send Bar_Current_Position to (Wait(Self)) iMax iMax iMax False
32881>>>>>    //
32881>>>>>    // Update Bar Progress
32881>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax True OR
32881>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax False
32881>>>>>    // When you want the update to be done for every i (this is slower)
32881>>>>>    // Where i=Counter's current value, icounter=Counter's Max Value and iMax=Bar Max Position
32881>>>>>    //
32881>>>>>    // Display Buttons on the object
32881>>>>>    // Set Button_State of (Wait(Self)) to False/True
32881>>>>>    // If the Progress Bar gets initialized without buttons, it MUST be Deactivated
32881>>>>>    //
32881>>>>>    // Initialization of the Progress Bar
32881>>>>>    // Send Popup to (Wait(Self))
32881>>>>>    //
32881>>>>>    // Deactivation of the Progress Bar
32881>>>>>    // Send Deactivate to (Wait(Self))
32881>>>>>    //
32881>>>>>    // Message during the process
32881>>>>>    // Set Wait_Message of (Wait(Self)) to "Now Processing..."
32881>>>>>    //
32881>>>>>    // Extra Info for button "Info >>"
32881>>>>>    // Send Wait_Details to (Wait(Self)) sFile sDetail bInitData
32881>>>>>    // If sFile<>'' then reads the contents of the file
32881>>>>>    // Else Fills the Edit with the string of sDetail
32881>>>>>    // If bInitData is True then the edit object is cleared first else extra info is appended
32881>>>>>    //
32881>>>>>    // Remarks instead of Progress Bar
32881>>>>>    // Set Button_State of (Wait(Self))     to False
32881>>>>>    // Set BarVisibleState of (Wait(Self))  to 'Remarks' False
32881>>>>>    // Update During Process
32881>>>>>    // Send UpdateWait to (Wait(Self)) 'Remarks'
32881>>>>>
32881>>>>>    //AB-StoreTopEnd
32881>>>>>
32881>>>>>    Set Exit_Application_Local_State to FALSE
32882>>>>>    Set Modal_State to FALSE
32883>>>>>    Set Popup_State to TRUE
32884>>>>>    Set Border_Style to Border_Thick
32885>>>>>    Set Minimize_Icon to FALSE
32886>>>>>    Set Label to "¨¡¢é §¨ £â¤«..."
32887>>>>>    Set Size to 138 256
32888>>>>>
32888>>>>>    //AB-DDOStart
32888>>>>>
32888>>>>>
32888>>>>>    //AB-DDOEnd
32888>>>>>
32888>>>>>    Object WaitBar is a ProgressBarSub
32890>>>>>
32890>>>>>        //AB-StoreTopStart
32890>>>>>
32890>>>>>        //AB-StoreTopEnd
32890>>>>>
32890>>>>>        Set Size to 21 243
32891>>>>>        Set Location to 7 4
32892>>>>>
32892>>>>>        //AB-StoreStart
32892>>>>>        Send DoRegSize  self smTopRight
32893>>>>>        //AB-StoreEnd
32893>>>>>
32893>>>>>    End_Object
32894>>>>>
32894>>>>>    Object WaitText is a TextBoxSub
32896>>>>>
32896>>>>>        //AB-StoreTopStart
32896>>>>>
32896>>>>>        //AB-StoreTopEnd
32896>>>>>
32896>>>>>        Set Enabled_State to TRUE
32897>>>>>        Set Label to "Processing"
32898>>>>>        Set FontSize to 4 0
32899>>>>>        Set Size to 10 81
32900>>>>>        Set Location to 36 5
32901>>>>>
32901>>>>>        //AB-StoreStart
32901>>>>>
32901>>>>>        //AB-StoreEnd
32901>>>>>
32901>>>>>    End_Object
32902>>>>>
32902>>>>>    Object bnCancel is a ButtonSub
32904>>>>>
32904>>>>>        //AB-StoreTopStart
32904>>>>>
32904>>>>>        //AB-StoreTopEnd
32904>>>>>
32904>>>>>        Set Default_State to TRUE
32905>>>>>        Set Label to "OK"
32906>>>>>        Set Location to 34 143
32907>>>>>
32907>>>>>        //AB-StoreStart
32907>>>>>
32907>>>>>        Procedure OnClick
32909>>>>>             Send Deactivate to (Wait(Self))
32910>>>>>        End_Procedure
32911>>>>>
32911>>>>>        Send DoRegAlign self amTopRight
32912>>>>>        //AB-StoreEnd
32912>>>>>
32912>>>>>    End_Object
32913>>>>>
32913>>>>>    Object bnDetail is a ButtonSub
32915>>>>>
32915>>>>>        //AB-StoreTopStart
32915>>>>>
32915>>>>>        //AB-StoreTopEnd
32915>>>>>
32915>>>>>        Set Focus_Mode to Pointer_Only
32916>>>>>        Set Label to "Info >>"
32917>>>>>        Set Location to 34 197
32918>>>>>
32918>>>>>        //AB-StoreStart
32918>>>>>
32918>>>>>        Procedure OnClick
32920>>>>>            Delegate Send Show_Details False
32922>>>>>        End_Procedure
32923>>>>>
32923>>>>>        Send DoRegAlign self amTopRight
32924>>>>>        //AB-StoreEnd
32924>>>>>
32924>>>>>    End_Object
32925>>>>>
32925>>>>>    Object LineControlSub1 is a LineControlSub
32927>>>>>
32927>>>>>        //AB-StoreTopStart
32927>>>>>
32927>>>>>        //AB-StoreTopEnd
32927>>>>>
32927>>>>>        Set Size to 2 243
32928>>>>>        Set Location to 54 4
32929>>>>>
32929>>>>>        //AB-StoreStart
32929>>>>>
32929>>>>>        Send DoRegSize  self smTopRight
32930>>>>>        //AB-StoreEnd
32930>>>>>
32930>>>>>    End_Object
32931>>>>>
32931>>>>>    Object WaitEdit is a editSub
32933>>>>>
32933>>>>>        //AB-StoreTopStart
32933>>>>>
32933>>>>>        //AB-StoreTopEnd
32933>>>>>
32933>>>>>        Set Enabled_State to FALSE
32934>>>>>        Set Read_Only_State to TRUE
32935>>>>>        Set Size to 58 243
32936>>>>>        Set Location to 60 4
32937>>>>>        Set Color to clWhite
32938>>>>>
32938>>>>>        //AB-StoreStart
32938>>>>>
32938>>>>>        Send DoRegSize Self amBottomRight
32939>>>>>        Delegate Set Size to 66 256
32941>>>>>
32941>>>>>        //AB-StoreEnd
32941>>>>>
32941>>>>>    End_Object
32942>>>>>
32942>>>>>    Object oTxtAntiBar is a TextBoxSub
32944>>>>>        Set Enabled_State to TRUE
32945>>>>>        Set Visible_State to FALSE
32946>>>>>        Set Label to "¨¡¢é §¨ £â¤«..."
32947>>>>>        Set Justification_Mode to (jMode_Center IOR jMode_VCenter)
32948>>>>>        Set Auto_Size_State to FALSE
32949>>>>>        Set FontWeight to 600
32950>>>>>        Set FontSize to 4 0
32951>>>>>        Set Size to 10 209
32952>>>>>        Set Location to 10 4
32953>>>>>        Set TextColor to clNavy
32954>>>>>    End_Object
32955>>>>>
32955>>>>>
32955>>>>>    //AB-StoreStart
32955>>>>>    Property Integer piWaitSize  Public (Size(Self))
32957>>>>>    Property Integer piPrevSize  Public (Size(Self))
32959>>>>>    Property Integer piState     Public False
32961>>>>>
32961>>>>>    Set Locate_Mode to Center_On_Screen
32962>>>>>    Set Destroy_Object_State to True
32963>>>>>
32963>>>>>    Procedure Show_Details Integer bAlways
32965>>>>>        Local Integer liOriSize liSize hiSize hiOriSize lowSize bState
32966>>>>>        Local String sLabel
32966>>>>>        Get Size                to liSize
32967>>>>>        Get piState             to bState
32968>>>>>        Get piWaitSize          to liOriSize
32969>>>>>        Move (Hi(liSize))       to hiSize
32970>>>>>        Move (Low(liSize))      to lowSize
32971>>>>>        Move (Hi(liOriSize))    to hiOriSize
32972>>>>>        If (bAlways) Begin
32974>>>>>            Set piState         to False
32975>>>>>            Move 0              to bState
32976>>>>>        End
32976>>>>>>
32976>>>>>        If bState Begin
32978>>>>>             Set Size to hiOriSize lowSize
32979>>>>>             Set Label of (bnDetail(Self)) to "Info >>"
32980>>>>>        End
32980>>>>>>
32980>>>>>        Else Begin
32981>>>>>             Set Size to 138 lowSize
32982>>>>>             Set Label of (bnDetail(Self)) to "<< Info"
32983>>>>>        End
32983>>>>>>
32983>>>>>        Set piState to (1-bState)
32984>>>>>    End_Procedure
32985>>>>>
32985>>>>>    Procedure Bar_Current_Position Integer iCount Integer iOccurances Integer iMaximum Integer bState
32987>>>>>       If (bState) Begin
32989>>>>>         If (Mod(iCount,(iCount*((Number(iMaximum))/(Number(iOccurances)))))=0) ;            Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
32992>>>>>       End
32992>>>>>>
32992>>>>>       Else Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
32994>>>>>    End_Procedure
32995>>>>>
32995>>>>>    Procedure DoInitialize_WaitBar
32997>>>>>        Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
32998>>>>>    End_Procedure
32999>>>>>
32999>>>>>    Procedure DoTerminate_WaitBar
33001>>>>>        Local Integer iMax
33002>>>>>        Get Maximum_position of (WaitBar(Self)) to iMax
33003>>>>>        Send Bar_Current_Position to (Wait(Self)) iMax iMax Imax False
33004>>>>>    End_Procedure
33005>>>>>
33005>>>>>    Procedure Set Bar_Maximum_Position Integer iMaximum
33007>>>>>         Set Maximum_position of (WaitBar(Self)) to iMaximum
33008>>>>>    End_Procedure
33009>>>>>
33009>>>>>    Function Bar_Maximum_Position Returns Integer
33011>>>>>        Function_Return (Maximum_position(WaitBar(Self)))
33012>>>>>    End_Function
33013>>>>>
33013>>>>>    Procedure Set Bar_Minimum_Position Integer iMinimum
33015>>>>>         Set Minimum_position of (WaitBar(Self)) to iMinimum
33016>>>>>    End_Procedure
33017>>>>>
33017>>>>>    Function Bar_Minimum_Position Returns Integer
33019>>>>>        Function_Return (Minimum_position(WaitBar(Self)))
33020>>>>>    End_Function
33021>>>>>
33021>>>>>    Procedure Set Bar_Step_Value Integer iStep
33023>>>>>         Set Step_Value of (WaitBar(Self)) to iStep
33024>>>>>    End_Procedure
33025>>>>>
33025>>>>>    Function Bar_Step_Value Returns Integer
33027>>>>>        Function_Return (Step_Value(WaitBar(Self)))
33028>>>>>    End_Function
33029>>>>>
33029>>>>>    Procedure Set Wait_Message String sMessage
33031>>>>>        Set Value of (WaitText(Self)) to sMessage
33032>>>>>    End_Procedure
33033>>>>>
33033>>>>>    Procedure Wait_Details String sFile String sDetail Integer bInitData
33035>>>>>        Local Integer liEditId
33036>>>>>        Move (WaitEdit(Self)) to liEditId
33037>>>>>        If bInitData Send Delete_Data to liEditId
33040>>>>>        If sFile ne "" Begin
33042>>>>>           Send Read to liEditId sFile
33043>>>>>           Send Beginning_Of_Data to liEditId
33044>>>>>        End
33044>>>>>>
33044>>>>>        Else Begin
33045>>>>>           Send Insert to liEditId sDetail
33046>>>>>        End
33046>>>>>>
33046>>>>>    End_Procedure
33047>>>>>
33047>>>>>    Procedure OnResize
33049>>>>>        Local Integer liSize liHiSize liPrevSize liHiPrevSize bState liHiLoc liLoc
33050>>>>>        Get Size to liPrevSize
33051>>>>>        Move (Hi(liPrevSize)) to liHiPrevSize
33052>>>>>        Forward Send OnResize
33054>>>>>        Get Location of (WaitEdit(Self)) to liLoc
33055>>>>>        Move (Hi(liLoc)) to liHiLoc
33056>>>>>        Get piState to bState
33057>>>>>        Get Size to liSize
33058>>>>>        Move (Hi(liSize)) to liHiSize
33059>>>>>        If (liHiSize > (liHiLoc +30)) Begin
33061>>>>>            Set Value of (bnDetail(Self)) to "<< Info"
33062>>>>>            If (liHiPrevSize <= (liHiLoc +30)) Set piState to (1-bState)
33065>>>>>        End
33065>>>>>>
33065>>>>>        Else Begin
33066>>>>>            Set Value of (bnDetail(Self)) to "Info >>"
33067>>>>>            If (liHiPrevSize > (liHiLoc +30)) Set piState to (1-bState)
33070>>>>>        End
33070>>>>>>
33070>>>>>    End_Procedure
33071>>>>>
33071>>>>>    Procedure Set Button_State Integer bState
33073>>>>>        If bState Begin
33075>>>>>            Set Caption_Bar to True
33076>>>>>            Set Size to 66 256
33077>>>>>        End
33077>>>>>>
33077>>>>>        Else Begin
33078>>>>>            Set Caption_Bar to False
33079>>>>>            Set Size to 38 256
33080>>>>>        End
33080>>>>>>
33080>>>>>    End_Procedure
33081>>>>>
33081>>>>>    Procedure Set BarVisibleState String sMsg Integer bState
33083>>>>>        Set Visible_State of (oTxtAntiBar(Self)) to (bState = 0)
33084>>>>>        Set Visible_State of (WaitBar(Self))     to (bState = 1)
33085>>>>>        If (bState = 0) Begin
33087>>>>>            Set Size to 24 256
33088>>>>>            Set Location of (oTxtAntiBar(Self)) to 6 5
33089>>>>>        End
33089>>>>>>
33089>>>>>        If sMsg ne "" Set Value of (oTxtAntiBar(Self)) to sMsg
33092>>>>>    End_Procedure
33093>>>>>
33093>>>>>    Procedure Deactivating integer search_mode Returns Integer
33095>>>>>        local integer rval
33096>>>>>        Forward Get MSG_Deactivating search_mode to rval
33098>>>>>        Set Modal_State of (Wait(Self)) to False
33099>>>>>        Set BarVisibleState of (Wait(Self)) to "¨¡¢é §¨ £â¤«..." True
33100>>>>>        Procedure_Return rval
33101>>>>>    End_Procedure
33102>>>>>
33102>>>>>    Procedure UpdateWait String sMsg
33104>>>>>        Set Value of (oTxtAntiBar(Self)) to sMsg
33105>>>>>    End_Procedure
33106>>>>>
33106>>>>>
33106>>>>>    Procedure Set Horizontal_Justification Integer aiMode
33108>>>>>        Set Justification_Mode of oTxtAntiBar to (jMode_VCenter IOR aiMode)
33109>>>>>    End_Procedure
33110>>>>>
33110>>>>>
33110>>>>>
33110>>>>>
33110>>>>>
33110>>>>>
33110>>>>>    //AB-StoreEnd
33110>>>>>
33110>>>>>End_Object
33111>>>>>
33111>>>>>
33111>>>>>//AB-StoreStart
33111>>>>>
33111>>>>>//AB-StoreEnd
33111>>>>>
33111>>>>>//AB/ End_Object    // prj
33111>>>
33111>use roundfn.fnc
INCLUDING FILE: ROUNDFN.FNC
33111>>>// ===========================================================================
33111>>>//
33111>>>// The ROUND_NUMBER global function has been designed to return the rounded
33111>>>// value of a given 'numeric' argument at a specified rounding precision.
33111>>>//
33111>>>// ---------------------------------------------------------------------------
33111>>>// This version dispenses with the use of powers (10 ^ n) to perform the
33111>>>// necessary calculations.  It uses a string handling technique instead.
33111>>>// ---------------------------------------------------------------------------
33111>>>//
33111>>>// The function requires two arguments, as follows:-
33111>>>//
33111>>>// (a) The numeric value to be rounded, where the range of valid values is
33111>>>//     +/- 99,999,999,999,999.99999999.
33111>>>//
33111>>>// (b) The rounding precision required.  This must be an integer value in the
33111>>>//     range -13 to +8.  If a value outside this range is used, the nearest
33111>>>//     threshold value is substituted.
33111>>>//
33111>>>//     Values in the range +1 to +7 perform rounding on the decimal part of
33111>>>//     the number.  A value of +8 will perform no rounding at all.  A zero
33111>>>//     value will round to the nearest whole number.  Values -1 to -13 will
33111>>>//     round progressively to the left of the decimal point (a frequent
33111>>>//     requirement in financial reporting).
33111>>>//
33111>>>// If the result of the rounding produces a value outside the valid numeric
33111>>>// range (+/- 99,999,999,999,999.99999999) then a zero value is returned.
33111>>>//
33111>>>// Assumptions:-  The only assumptions made have been that the range of
33111>>>// numeric values and the limit of eight decimal places are unlikely to change
33111>>>// in the forseeable future.
33111>>>//
33111>>>// Examples:-
33111>>>//
33111>>>//  1st Argument      2nd Argument   Return Value
33111>>>//  ------------      ------------   ------------
33111>>>//  123456.87654321         8         123456.87654321
33111>>>//  123456.87654321         2         123456.88
33111>>>// -123456.87654321         2        -123456.88
33111>>>//  123456.98765432         0         123457
33111>>>// -123456.98765432        -1        -123460
33111>>>//  123456.98765432        -2         123500
33111>>>//  123456.98765432        -3         123000
33111>>>//  987654                 -4         990000
33111>>>//  987654                 -5        1000000
33111>>>//  987654                 -6        1000000
33111>>>//  987654                 -7              0
33111>>>//
33111>>>// ===========================================================================
33111>>>
33111>>>
33111>>>Function Round_Number GLOBAL number nVal integer iRnd returns Number
33112>>>
33112>>>  Local Number nAdj
33113>>>
33113>>>  Move 10000000000000 to nAdj
33114>>>
33114>>>  // If the rounding precision falls in the range 0 to 8, then return:-
33114>>>
33114>>>  If (iRnd >= 0) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 / (Number(Left(nAdj, ((iRnd + 1) ;      min 9)))) + nVal / (Number(Left(nAdj, (9 - (iRnd min 8))))) ;        * (Number(Left(nAdj, (9 - (iRnd min 8))))))
33117>>>
33117>>>  // Else, where the rounding precision is in the range -1 to -5, return:-
33117>>>
33117>>>  If (iRnd >= -5) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(Left(nAdj, (Abs(iRnd) + 9)))) ;        * (Number(Left(nAdj, (Abs(iRnd) + 9)))))
33120>>>
33120>>>  // Else, where the rounding precision is in the range -6 to -13, return:-
33120>>>
33120>>>  Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(nAdj)) / (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))) ;        * (Number(nAdj)) * (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))))
33121>>>
33121>>>End_Function
33122>Use Idiotht.pkg
INCLUDING FILE: IDIOTHT.PKG
33122>>>
33122>>>Open Users
33124>>>Open UserGrps
INCLUDING FILE: USERGRPS.FD
33126>>>Open Pedia
INCLUDING FILE: PEDIA.FD
33128>>>Open Arxeia
INCLUDING FILE: ARXEIA.FD
33130>>>Open GrpPedia
INCLUDING FILE: GRPPEDIA.FD
33132>>>Open GrpPed0
INCLUDING FILE: GRPPED0.FD
33134>>>Open GrpArx
INCLUDING FILE: GRPARX.FD
33136>>>Open GrpArx0
INCLUDING FILE: GRPARX0.FD
33138>>>Open ViewFlds
INCLUDING FILE: VIEWFLDS.FD
33140>>>Open Oth
INCLUDING FILE: OTH.FD
33142>>>Open GrpOth
INCLUDING FILE: GRPOTH.FD
33144>>>Open GrpOth0
INCLUDING FILE: GRPOTH0.FD
33146>>>Open Departm
INCLUDING FILE: DEPARTM.FD
33148>>>
33148>>>
33148>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
33149>>>
33149>>>Function Network_User_Name Returns String
33150>>>    Local String sName sLength
33151>>>    Local Pointer lpName_Addr lpLength_Addr
33151>>>    Local Integer iRetval
33151>>>    Movestr (Repeat (Character (0), 255)) To sName
33152>>>>
33152>>>    GetAddress Of sName To lpName_Addr
33153>>>    Movestr (DwordToBytes (255)) To sLength
33154>>>>
33154>>>    GetAddress Of sLength To lpLength_Addr
33155>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
33156>>>>
33156>>>    If iRetval Eq 0 Function_Return (CString (sName))
33159>>>    Else Function_Return "User Unknown"
33161>>>End_Function // Network_User_Name
33162>>>
33162>>>Function fsGetOfficePath Global Returns String
33163>>>    String sRegistryKeyPath sRegOfficePath
33164>>>    Set_Registry_Root                                                   to HKEY_LOCAL_MACHINE "Software"
33165>>>    Move "Microsoft\Office\9.0\Word"                                    to sRegistryKeyPath
33166>>>    Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path"    to sRegOfficePath
33170>>>    Move (Trim(sRegOfficePath))                                         to sRegOfficePath
33171>>>    If (sRegOfficePath='') Begin
33173>>>        Move "Microsoft\Office\8.0\Word"                                to sRegistryKeyPath
33174>>>        Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
33178>>>        Move (Trim(sRegOfficePath))                                     to sRegOfficePath
33179>>>        If (sRegOfficePath='') Begin
33181>>>            Move "Microsoft\Office\7.0\Word"                             to sRegistryKeyPath
33182>>>            Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
33186>>>            Move (Trim(sRegOfficePath))                                     to sRegOfficePath
33187>>>            If (sRegOfficePath='') Begin
33189>>>                Move "Microsoft\Office\10.0\Word"                                to sRegistryKeyPath
33190>>>                Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
33194>>>                Move (Trim(sRegOfficePath))                                     to sRegOfficePath
33195>>>            End
33195>>>>
33195>>>        End
33195>>>>
33195>>>    End
33195>>>>
33195>>>    Function_Return sRegOfficePath
33196>>>End_Procedure
33197>>>
33197>>>
33197>>>Function fsGetLastDir Global Returns String
33198>>>    String sRegistryKeyPath sRegDir sUserName
33199>>>    Get Network_User_Name to sUserName
33200>>>
33200>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
33203>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
33206>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
33208>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
33210>>>    Append sRegistryKeyPath  "\LastDirUsed\"
33211>>>    Append sRegistryKeyPath  (Trim(sUserName))
33212>>>    Get_profile_string sRegistryKeyPath "Path" to sRegDir
33215>>>    Function_Return sRegDir
33216>>>End_Procedure
33217>>>
33217>>>Function fiPutLastDir Global String asDirectory Returns Integer
33218>>>    String sRegistryKeyPath sRegDir sUserName
33219>>>    Get Network_User_Name to sUserName
33220>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
33223>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
33226>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
33228>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
33230>>>    Append sRegistryKeyPath  "\LastDirUsed\"
33231>>>    Append sRegistryKeyPath  (Trim(sUserName))
33232>>>    Set_profile_string sRegistryKeyPath "Path" to asDirectory
33235>>>    Function_Return 0
33236>>>End_Procedure
33237>>>
33237>>>
33237>>>Function fsVresExt Global String asFileName Returns String
33238>>>    String rVal
33239>>>    Integer iPos iLen
33239>>>    Move (UpperCase(asFileName)) to asFileName
33240>>>    Move (Trim(asFileName)) to asFileName
33241>>>    Move 0 to iPos
33242>>>    For iLen from 1 to (length(asFileName))
33248>>>>
33248>>>        If (Mid(asFileName,1,iLen)='.') Move iLen to iPos
33251>>>    Loop
33252>>>>
33252>>>    If (Not(iPos)) Function_Return ''
33255>>>    Move (Right(asFileName,(Length(asFileName)-iPos))) to rVal
33256>>>    Move (Trim(rVal)) to rVal
33257>>>    Function_Return rVal
33258>>>End_Function
33259>>>
33259>>>
33259>>>Function fiScreenFieldStatus Global String asViewName String asDbFormName Returns Integer
33260>>>    Integer rVal iUser iGroup
33261>>>    String  sUser sRecr
33261>>>    Move (Trim(asViewName))     to asViewName
33262>>>    Move (Trim(asDbFormName))   to asDbFormName
33263>>>
33263>>>    If ((asViewName<>'') And (asDbFormName<>'')) Begin
33265>>>        Get fsLoginUserID to sUser
33266>>>        Clear Users
33267>>>        Move sUser        to Users.Login_ID
33268>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
33269>>>>
33269>>>        If (Found=1) Begin
33271>>>            Move Users.User_ID  to iUser
33272>>>            Move Users.Grp_ID   to iGroup
33273>>>            Clear GrpOth
33274>>>            Move iUser          to GrpOth.User_ID
33275>>>            Move asViewName     to GrpOth.View_Name
33276>>>            Move asDbFormName   to GrpOth.Scr_Field_Name
33277>>>            Find eq GrpOth by Index.2 // GrpOth:Index.2:User_ID+View_Name+Scr_Field_Name
33278>>>>
33278>>>            If (Found=1) Begin
33280>>>                // rVal=1 ==> NO READ ALLOWED
33280>>>                // rVal=2 ==> NO EDIT BUT CAN COPY
33280>>>                // rVal=3 ==> NO EDIT AND NO COPY
33280>>>                If (GrpOth.Allow_Read <>'1') Move 1 to rVal
33283>>>                Else Begin
33284>>>                    If (GrpOth.Allow_Change<>'1') Begin
33286>>>                        If (GrpOth.Allow_Copy<>'1') Move 3 to rVal
33289>>>                        Else                        Move 2 to rVal
33291>>>                    End
33291>>>>
33291>>>                End
33291>>>>
33291>>>            End
33291>>>>
33291>>>            Else Begin
33292>>>                Clear GrpOth0
33293>>>                Move iGroup         to GrpOth0.Group_ID
33294>>>                Move asViewName     to GrpOth0.View_Name
33295>>>                Move asDbFormName   to GrpOth0.Scr_Field_Name
33296>>>
33296>>>                Find eq GrpOth0 by Index.2 // GrpOth0:Index.2:Group_ID+View_Name+Scr_Field_Name
33297>>>>
33297>>>                If (Found=1) Begin
33299>>>                    // rVal=1 ==> NO READ ALLOWED
33299>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
33299>>>                    // rVal=3 ==> NO EDIT AND NO COPY
33299>>>                    If (GrpOth0.Allow_Read <>'1') Move 1 to rVal
33302>>>                    Else Begin
33303>>>                        If (GrpOth0.Allow_Change<>'1') Begin
33305>>>                            If (GrpOth0.Allow_Copy<>'1') Move 3 to rVal
33308>>>                            Else                         Move 2 to rVal
33310>>>                        End
33310>>>>
33310>>>                    End
33310>>>>
33310>>>                End
33310>>>>
33310>>>                Else Move 0 to rVal
33312>>>            End
33312>>>>
33312>>>        End
33312>>>>
33312>>>        Else Move 0 to rVal
33314>>>    End
33314>>>>
33314>>>    Function_Return rVal
33315>>>End_Function
33316>>>
33316>>>Function fiFieldStatus Global Integer aiFileNumber Integer aiFieldNumber Returns Integer
33317>>>    Integer rVal iUser iGroup
33318>>>    String  sUser sRecr
33318>>>    If ((aiFileNumber) And (aiFieldNumber)) Begin
33320>>>        Get fsLoginUserID to sUser
33321>>>        Clear Users
33322>>>        Move sUser        to Users.Login_ID
33323>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
33324>>>>
33324>>>        If (Found=1) Begin
33326>>>            Move Users.User_ID  to iUser
33327>>>            Move Users.Grp_ID   to iGroup
33328>>>            Clear Pedia
33329>>>            Move aiFileNumber  to Pedia.Arxeio_ID
33330>>>            Move aiFieldNumber to Pedia.Pedio_Number
33331>>>            Find eq Pedia By Index.1 // Pedia:Index.1:Arxeio_ID+Pedio_Number
33332>>>>
33332>>>            If (Found=1) Begin
33334>>>                Move (Trim(Pedia.Pedio_Recr))   to sRecr
33335>>>                // Find Combination User/File/Field in GRPPEDIA
33335>>>                Clear GrpPedia
33336>>>                Move iUser                      to GrpPedia.User_ID
33337>>>                Move (Trim(sRecr))              to GrpPedia.Pedio_Recr
33338>>>                Find eq GrpPedia by Index.4 // GrpPedia:Index.4:Pedio_Recr + User_ID
33339>>>>
33339>>>                If (Found=1) Begin
33341>>>                    // rVal=1 ==> NO READ ALLOWED
33341>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
33341>>>                    // rVal=3 ==> NO EDIT AND NO COPY
33341>>>                    If (GrpPedia.Allow_Read <>'1') Move 1 to rVal
33344>>>                    Else Begin
33345>>>                        If (GrpPedia.Allow_Change<>'1') Begin
33347>>>                            If (GrpPedia.Allow_Copy<>'1')   Move 3 to rVal
33350>>>                            Else                            Move 2 to rVal
33352>>>                        End
33352>>>>
33352>>>                    End
33352>>>>
33352>>>                End
33352>>>>
33352>>>                Else Begin
33353>>>                    // Find Combination UserGrps/File/Field in GRPPED0
33353>>>                    Clear GrpPed0
33354>>>                    Move iGroup         to GrpPed0.Group_ID
33355>>>                    Move (Trim(sRecr))  to GrpPed0.Pedio_Recr
33356>>>                    Find eq GrpPed0 by Index.4 // GrpPed0:Index.4:Pedio_Recr + Group_ID
33357>>>>
33357>>>                    If (Found=1) Begin
33359>>>                        // rVal=1 ==> NO READ ALLOWED
33359>>>                        // rVal=2 ==> NO EDIT BUT CAN COPY
33359>>>                        // rVal=3 ==> NO EDIT AND NO COPY
33359>>>                        If (GrpPed0.Allow_Read <>'1') Move 1 to rVal
33362>>>                        Else Begin
33363>>>                            If (GrpPed0.Allow_Change<>'1') Begin
33365>>>                                If (GrpPed0.Allow_Copy<>'1')   Move 3 to rVal
33368>>>                                Else                           Move 2 to rVal
33370>>>                            End
33370>>>>
33370>>>                        End
33370>>>>
33370>>>                    End
33370>>>>
33370>>>                End
33370>>>>
33370>>>            End
33370>>>>
33370>>>            Else Begin
33371>>>                Move 0 to rVal
33372>>>            End
33372>>>>
33372>>>        End
33372>>>>
33372>>>        Else Begin
33373>>>            Move 0 to rVal
33374>>>        End
33374>>>>
33374>>>    End
33374>>>>
33374>>>    Function_Return rVal
33375>>>End_Function
33376>>>
33376>>>Function fsReturnFileFromPath Global String asFullPath Returns String
33377>>>    String rVal lsDirSep
33378>>>    Integer iPos iMet iLen iCnt
33378>>>    Move (Trim(asFullPath))                 To rVal
33379>>>    Move (Sysconf(SYSCONF_DIR_SEPARATOR))   To lsDirSep
33380>>>    If (rVal Contains lsDirSep) Begin
33382>>>        Move (Length(rVal)) to iLen
33383>>>        Move iLen to iCnt
33384>>>        While iCnt Gt 0
33388>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Begin
33390>>>                If (iCnt=iLen) Function_Return asFullPath
33393>>>                Else Function_Return (Right(rVal,(iLen-iCnt)))
33395>>>            End
33395>>>>
33395>>>            Decrement iCnt
33396>>>        End // While iCnt Gt 0
33397>>>>
33397>>>    End
33397>>>>
33397>>>    Else  Function_Return (Trim(asFullPath))
33399>>>    Function_Return rVal
33400>>>End_Function
33401>>>
33401>>>Function fsReturnDirectoriesFromPath Global String asFullPath Returns String
33402>>>    String rVal lsDirSep
33403>>>    Integer iPos iMet iLen iCnt
33403>>>    Move (Trim(asFullPath))                 To rVal
33404>>>    Move (Sysconf(SYSCOnF_DIR_SEPARATOR))   To lsDirSep
33405>>>    If (rVal Contains lsDirSep) Begin
33407>>>        Move (Length(rVal)) to iLen
33408>>>        Move iLen to iCnt
33409>>>        While iCnt Gt 0
33413>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Function_Return (Left(rVal,iCnt))
33416>>>            Decrement iCnt
33417>>>        End // While iCnt Gt 0
33418>>>>
33418>>>    End
33418>>>>
33418>>>    Function_Return rVal
33419>>>End_Function
33420>>>
33420>>>//Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
33420>>>//    Local String rVal lsTmp lsOO lsLL
33420>>>//    Local Number lnOO lnLL
33420>>>
33420>>>//    Move '' to lsOO
33420>>>//    Move '' to lsLL
33420>>>//    Move '' to rVal
33420>>>
33420>>>//    Move (Integer(anTime))                              to lnOO
33420>>>//    ////////////////////////////////////////////
33420>>>//    // sos sos sos jsjsjsjsjs yannis 30/03/2000
33420>>>//    //If ((lnOO=24) and (lnll=0)) Move 0 to lnOO
33420>>>//    ////////////////////////////////////////////
33420>>>
33420>>>//    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
33420>>>
33420>>>//    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
33420>>>//    Else         Move (String(lnOO))                    to lsOO
33420>>>//    Move (Trim(lsOO))                                   to lsOO
33420>>>
33420>>>//    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
33420>>>//    Else         Move (String(lnLL))                    to lsLL
33420>>>//    Move (Trim(lsLL))                                   to lsLL
33420>>>
33420>>>//    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
33420>>>
33420>>>//    Move (Trim(rVal)) to rVal
33420>>>
33420>>>//    Function_Return rVal
33420>>>//End_Function
33420>>>
33420>>>//Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
33420>>>//    Local Number rVal nOres nLepta
33420>>>//    Move (Integer(aiMinutes/60))    to nOres
33420>>>//    Move (    Mod(aiMinutes,60))    to nLepta
33420>>>//    Move (nOres+(nLepta/100))       to rVal
33420>>>//    Function_Return rVal
33420>>>//End_Function
33420>>>
33420>>>//Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
33420>>>//    Local Integer rVal
33420>>>//    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
33420>>>//    Function_Return rVal
33420>>>//End_Function
33420>>>
33420>>>//Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;
33420>>>//                                                                    Number anEndTime    ;
33420>>>//                                                                    Returns Integer
33420>>>//    Local Integer rVal iMinStart iMinEnd
33420>>>
33420>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
33420>>>
33420>>>//    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
33420>>>//    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
33420>>>//    Move (iMinEnd-iMinStart)                                                     to rVal
33420>>>//    Function_Return rVal
33420>>>//End_Function
33420>>>
33420>>>
33420>>>//Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;
33420>>>//                                                                Number anEndTime    ;
33420>>>//                                                                Returns Number
33420>>>//    Local Integer iTmp
33420>>>//    Local Number  rVal
33420>>>
33420>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
33420>>>
33420>>>//    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
33420>>>//    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
33420>>>//    Function_Return rVal
33420>>>//End_Function
33420>>>
33420>>>
33420>>>Function fsLoginUserID Global Returns String
33421>>>    Local String LastLogin# LoginUserid#
33422>>>    get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin#
33425>>>    If LastLogin# eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin#
33428>>>    insert "WorkSpaces\" in LastLogin# at 1
33430>>>    Append LastLogin# "\" (Module_Name(Self)) "\LastLogin"
33433>>>    get_profile_string LastLogin# "LoginUserId"  to LoginUserId#
33436>>>    Trim LoginUserID# to LoginUserID#
33437>>>>
33437>>>    If LoginUserId# eq "" Move (Network_User_Name(Current_Object)) to LoginUserId#
33440>>>    Function_Return LoginUserID#
33441>>>End_Function
33442>>>
33442>>>Function fiWriteRegistryLastSDFPath Global String asLastPath Returns Integer
33443>>>    Integer rVal
33444>>>    String  lsCurrentWksp
33444>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33447>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33450>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33452>>>    // ¦ ¡¢    - Last_SDF_Path -  ¡«à §¦ «¦ ©¬¡¡¨ £¤¦
33452>>>    // workspace §¦¬ ¦¬¢¬¦¬£
33452>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
33455>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
33458>>>    Function_Return rVal
33459>>>End_Function
33460>>>
33460>>>
33460>>>Function fsReadRegistryLastSDFPath Global Returns String
33461>>>    String rVal lsCurrentWksp
33462>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33465>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33468>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33470>>>    // ¦ ¡¢    - LastParastUsed -  ¡«à §¦ «¦ ©¬¡¡¨ £¤¦
33470>>>    // workspace §¦¬ ¦¬¢¬¦¬£
33470>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
33473>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
33476>>>    Function_Return (Trim(rVal))
33477>>>End_Function
33478>>>
33478>>>
33478>>>Function fiWriteRegistryLastMCryptPath Global String asLastPath Returns Integer
33479>>>    Integer rVal
33480>>>    String  lsCurrentWksp
33480>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33483>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33486>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33488>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
33491>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
33494>>>    Function_Return rVal
33495>>>End_Function
33496>>>
33496>>>
33496>>>Function fsReadRegistryLastMCryptPath Global Returns String
33497>>>    String rVal lsCurrentWksp
33498>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33501>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33504>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33506>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
33509>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
33512>>>    Function_Return (Trim(rVal))
33513>>>End_Function
33514>>>
33514>>>Function fiWriteRegistryLastWEBPath Global String asLastPath Returns Integer
33515>>>    Integer rVal
33516>>>    String  lsCurrentWksp
33516>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33519>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33522>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33524>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
33527>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
33530>>>    Function_Return rVal
33531>>>End_Function
33532>>>
33532>>>
33532>>>Function fsReadRegistryLastWEBPath Global Returns String
33533>>>    String rVal lsCurrentWksp
33534>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33537>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33540>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33542>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
33545>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
33548>>>    Function_Return (Trim(rVal))
33549>>>End_Function
33550>>>
33550>>>Function fsReadRegistryFEMRootDir Global Returns String
33551>>>    String rVal lsCurrentWksp
33552>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33555>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33558>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33560>>>    Append lsCurrentWksp "\FEM"
33561>>>    Get_Profile_String lsCurrentWksp "RootDir"  to rVal
33564>>>    Function_Return (Trim(rVal))
33565>>>End_Function
33566>>>
33566>>>Function fsReadRegistryFEMDevicePath Global Returns String
33567>>>    String rVal lsCurrentWksp
33568>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33571>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33574>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33576>>>    Append lsCurrentWksp "\FEM"
33577>>>    Get_Profile_String lsCurrentWksp "DevicePath"  to rVal
33580>>>    Function_Return (Trim(rVal))
33581>>>End_Function
33582>>>
33582>>>Function fiWriteRegistryFEMRootDir Global Returns Integer
33583>>>    Integer rVal
33584>>>    String  lsCurrentWksp
33584>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33587>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33590>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33592>>>    Append lsCurrentWksp "\FEM"
33593>>>    Set_Profile_String lsCurrentWksp "RootDir"  to "C:\FEM_ROOT\"
33596>>>    Function_Return rVal
33597>>>End_Function
33598>>>
33598>>>Function fiWriteRegistryFEMDevicePath Global Returns Integer
33599>>>    Integer rVal
33600>>>    String  lsCurrentWksp
33600>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33603>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33606>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33608>>>    Append lsCurrentWksp "\FEM"
33609>>>    Set_Profile_String lsCurrentWksp "DevicePath"  to "C:\FEM_ROOT\Device_File1.dat"
33612>>>    Function_Return rVal
33613>>>End_Function
33614>>>
33614>>>
33614>>>
33614>>>
33614>>>
33614>>>Function fig_Is_Admin Global Returns Integer
33615>>>    String sUser
33616>>>    Integer rVal
33616>>>    Get fsLoginUserID to sUser
33617>>>    Move (trim(sUser)) to sUser
33618>>>    Clear Users
33619>>>    Move sUser to Users.Login_ID
33620>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
33621>>>>
33621>>>    Move Users.Admin_Rights to rVal
33622>>>    Function_Return rVal
33623>>>End_Function
33624>>>
33624>>>Function fig_The_User_Group Global Returns Integer
33625>>>    String sUser
33626>>>    Get fsLoginUserID   to sUser
33627>>>    Move (trim(sUser))  to sUser
33628>>>    Clear Users
33629>>>    Move sUser          to Users.Login_ID
33630>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
33631>>>>
33631>>>    Clear UserGrps
33632>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
33633>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
33634>>>>
33634>>>    Function_Return UserGrps.Grp_ID
33635>>>End_Function
33636>>>
33636>>>Function fsg_The_User_Department Global Returns String
33637>>>    String sUser
33638>>>    Get fsLoginUserID   to sUser
33639>>>    Move (trim(sUser))  to sUser
33640>>>    Clear Users
33641>>>    Move sUser          to Users.Login_ID
33642>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
33643>>>>
33643>>>    Clear Departm
33644>>>    Move Users.Departm_Code   to Departm.Code
33645>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
33646>>>>
33646>>>    Function_Return Departm.Code
33647>>>End_Function
33648>>>
33648>>>
33648>>>Function fig_Is_Specific_Admin Global String asUser Returns Integer
33649>>>    Integer rVal
33650>>>    Move (trim(asUser)) to asUser
33651>>>    Clear Users
33652>>>    Move asUser to Users.Login_ID
33653>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
33654>>>>
33654>>>    Move Users.Admin_Rights to rVal
33655>>>    Function_Return rVal
33656>>>End_Function
33657>>>
33657>>>Function fig_The_Specific_User_Group Global String asUser Returns Integer
33658>>>    Move (trim(asUser))  to asUser
33659>>>    Clear Users
33660>>>    Move asUser          to Users.Login_ID
33661>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
33662>>>>
33662>>>    Clear UserGrps
33663>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
33664>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
33665>>>>
33665>>>    Function_Return UserGrps.Grp_ID
33666>>>End_Function
33667>>>
33667>>>Function fsg_The_Specific_User_Department Global String asUser Returns String
33668>>>    Move (trim(asUser))  to asUser
33669>>>    Clear Users
33670>>>    Move asUser          to Users.Login_ID
33671>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
33672>>>>
33672>>>    Clear Departm
33673>>>    Move Users.Departm_Code   to Departm.Code
33674>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
33675>>>>
33675>>>    Function_Return Departm.Code
33676>>>End_Function
33677>>>
33677>>>
33677>Use Menu_Sec.Sub
INCLUDING FILE: MENU_SEC.SUB
33677>>>
33677>>>Use Idiotht.pkg
33677>>>
33677>>>Class ViewPopupMenu_Sec Is A ViewPopupMenu
33678>>>
33678>>>    Open Sysfile
INCLUDING FILE: SYSFILE.FD
33680>>>    Open Users
33682>>>    Open Views
INCLUDING FILE: VIEWS.FD
33684>>>    Open GrpViews
INCLUDING FILE: GRPVIEWS.FD
33686>>>    Open GrpView0
INCLUDING FILE: GRPVIEW0.FD
33688>>>    Open Arxeia
33690>>>    Open GrpArx
33692>>>
33692>>>    Function Find_User_Rights_In_Class String asView Returns Integer
33693>>>        String  lsView lsLogin
33694>>>        Integer liUser  liViews iGroup
33694>>>
33694>>>        Move (fsLoginUserID())      to lsLogin
33695>>>        Move (Trim(ToOEM(asView)))  to lsView
33696>>>
33696>>>        //////  /////////////////////////////////////
33696>>>        Clear Users
33697>>>        Move lsLogin    to Users.Login_ID
33698>>>
33698>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
33699>>>>
33699>>>        If (Found=1)  Begin
33701>>>            Move Users.User_ID  to liUser
33702>>>            Move Users.Grp_ID   to iGroup
33703>>>        End
33703>>>>
33703>>>        Else Function_Return 0
33705>>>
33705>>>        Clear Views
33706>>>        Move (Trim(lsView)) to Views.Menu_Name
33707>>>        Find eq Views by Index.2 // Views:Index.2:Views.Menu_Name
33708>>>>
33708>>>        If (Found=1) Begin
33710>>>            Move Views.View_ID to liViews
33711>>>            Clear GrpViews
33712>>>            Move liUser    to GrpViews.User_ID
33713>>>            Move liViews   to GrpViews.View_ID
33714>>>            Find Eq GrpViews by Index.1 // GrpViews:Index.1:GrpViews.User_ID+GrpViews.View_ID
33715>>>>
33715>>>            If (Found=1) Begin // And (liUser=GrpViews.User_ID) And (liViews=GrpViews.View_ID)) Begin
33717>>>                Function_Return (GrpViews.Allow_Read<>'1')
33718>>>            End
33718>>>>
33718>>>            Else Begin
33719>>>                Clear GrpView0
33720>>>                Move iGroup    to GrpView0.Group_ID
33721>>>                Move liViews   to GrpView0.View_ID
33722>>>                Find eq GrpView0 by Index.1 // GrpView0:Index.1:Group_ID+View_ID
33723>>>>
33723>>>                If (Found=1) Begin
33725>>>                    Function_Return (GrpView0.Allow_Read<>'1')
33726>>>                End
33726>>>>
33726>>>                Else         Function_Return 0
33728>>>            End
33728>>>>
33728>>>        End
33728>>>>
33728>>>        Else Function_Return 0
33730>>>    End_Function
33731>>>
33731>>>//    Procedure Enhmerose_Views_File_In_Class
33731>>>//        Integer liCount liInt liLastNo
33731>>>//        String lsStr
33731>>>//        Get Item_Count to liCount
33731>>>//        // find last view_id
33731>>>//        Clear Views
33731>>>//        Move 9999 to Views.View_ID
33731>>>//        Find lt Views by index.1 // view_id
33731>>>//        If (Found=1)    Move Views.View_ID  to liLastNo
33731>>>//        Else            Move 0              to liLastNo
33731>>>//        For liInt From 0 to (liCount-1)
33731>>>//            Get Value item liInt to lsStr
33731>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
33731>>>//            //Move (Trim(lsStr)) to lsStr
33731>>>//            If (lsStr<>'') Begin
33731>>>//                Clear Views
33731>>>//                Move lsStr to Views.Menu_Name
33731>>>//                Find eq Views by index.2 // Views.Menu_Name
33731>>>//                If (NOT(Found)) Begin
33731>>>//                    Add 1 to liLastNo
33731>>>//                    Move liLastNo to Views.View_ID
33731>>>//                    Saverecord Views
33731>>>//                End
33731>>>//            End
33731>>>//        Loop
33731>>>//        For liInt From 0 to (liCount-1)
33731>>>//            Get Value item liInt to lsStr
33731>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
33731>>>//            //Move (Trim(lsStr)) to lsStr
33731>>>//            If (lsStr<>'') Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
33731>>>//        Loop
33731>>>//    End_procedure
33731>>>
33731>>>    Procedure OnInitMenu
33732>>>        Integer liCount liInt liLastNo
33733>>>        String lsStr
33733>>>
33733>>>        Get Item_Count to liCount
33734>>>
33734>>>        // find last view_id
33734>>>        Clear Views
33735>>>        Move 9999 to Views.View_ID
33736>>>        Find lt Views by index.1 // view_id
33737>>>>
33737>>>        If (Found=1)    Move Views.View_ID  to liLastNo
33740>>>        Else            Move 0              to liLastNo
33742>>>        For liInt From 0 to (liCount-1)
33748>>>>
33748>>>            Get Value item liInt to lsStr
33749>>>            Move (Trim(lsStr)) to lsStr
33750>>>            If ((lsStr<>'') and (Length(lsStr)>2)) Begin
33752>>>                Clear Views
33753>>>                Move (ToOEM(lsStr)) to Views.Menu_Name
33754>>>                Find eq Views by index.2 // Views.Menu_Name
33755>>>>
33755>>>                If (NOT(Found)) Begin
33757>>>                    Add 1 to liLastNo
33758>>>                    Move liLastNo to Views.View_ID
33759>>>                    //Move (ToOEM(lsStr)) to Views.Menu_Name
33759>>>                    Saverecord Views
33760>>>                End
33760>>>>
33760>>>            End
33760>>>>
33760>>>        Loop
33761>>>>
33761>>>        For liInt From 0 to (liCount-1)
33767>>>>
33767>>>            Get Value item liInt to lsStr
33768>>>            Move (Trim(lsStr)) to lsStr
33769>>>            Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
33770>>>        Loop
33771>>>>
33771>>>
33771>>>    End_procedure
33772>>>
33772>>>//    Procedure End_Construct_Object
33772>>>//        Forward Send End_Construct_Object
33772>>>//        Send Enhmerose_Views_File_In_Class
33772>>>//    End_Procedure
33772>>>
33772>>>End_Class //ButtonSub
33773>>>
33773>>>
33773>Use DD_Sec.Sub
INCLUDING FILE: DD_SEC.SUB
33773>>>
33773>>>Open Sysfile
33775>>>Open UserGrps
33777>>>Open Users
33779>>>Open Views
33781>>>Open GrpViews
33783>>>Open Arxeia
33785>>>Open GrpArx
33787>>>Open GrpArx0
33789>>>Open GrpView0
33791>>>
33791>>>Use DD.Sub
33791>>>
33791>>>Class Datadictionary_Sec  Is A DatadictionarySub
33792>>>
33792>>>
33792>>>    Procedure Construct_Object
33793>>>        Forward Send Construct_Object
33795>>>        Property Integer cpiUpdate              0
33796>>>        Property Integer cpiBackout             0
33797>>>        Property Integer cpiEditing             0
33798>>>        Property Integer cpiFileNumber          0
33799>>>        Property String  cpsFileName            ''
33800>>>        Property String  cpsLoginID             ''
33801>>>        Property Integer cpiCannot_Read         0
33802>>>        Property Integer cpiCannot_Create       0
33803>>>        Property Integer cpiCannot_Delete       0
33804>>>        Property Integer cpiCannot_Edit         0
33805>>>        Property Integer piFN                   0
33806>>>    End_Procedure
33807>>>
33807>>>//    Procedure Save_Main_File
33807>>>//        If (Operation_Origin<>Self) Begin
33807>>>//            If Indirect_File.Recnum Eq 0 Procedure_Return
33807>>>//        End
33807>>>//        Forward Send Save_Main_File
33807>>>//    End_Procedure
33807>>>
33807>>>
33807>>>
33807>>>    Function Validate_Save Returns Integer
33808>>>        Integer rVal
33809>>>        Forward Get Validate_Save to rVal
33811>>>        If (Not(rVal)) Begin
33813>>>            Get cpiCannot_Read to rVal
33814>>>            If (Not(rVal)) Begin
33816>>>                Set cpiEditing to ((cpiBackout(Self)=1) and (cpiUpdate(Self)=1))
33817>>>                If (cpiEditing(Self)=1) Get cpiCannot_Edit      to rVal
33820>>>                Else                    Get cpiCannot_Create    to rVal
33822>>>            End
33822>>>>
33822>>>            If (rVal) Send Operation_Not_Allowed rVal
33825>>>        End
33825>>>>
33825>>>        Function_Return rVal
33826>>>    End_Function
33827>>>
33827>>>    Function Validate_Delete Returns Integer
33828>>>        Integer rVal
33829>>>        Forward Get Validate_Delete to rVal
33831>>>        If (Not(rVal)) Begin
33833>>>            Get cpiCannot_Read to rVal
33834>>>            If (Not(rVal)) Get cpiCannot_Delete to rVal
33837>>>            If (rVal) Send Operation_Not_Allowed rVal
33840>>>        End
33840>>>>
33840>>>        Function_Return rVal
33841>>>    End_Function
33842>>>
33842>>>    Procedure End_Construct_Object
33843>>>        Integer liSrv rVal
33844>>>        String lsStr
33844>>>        Forward Send End_Construct_Object
33846>>>        Get Main_File                                   To liSrv
33847>>>        Set cpiFileNumber                               To liSrv
33848>>>        Get_Attribute DF_FILE_PHYSICAL_NAME Of liSrv    To lsStr
33851>>>        Set cpsFileName                                 To (Trim(Uppercase(lsStr)))
33852>>>        Set cpsLoginID                                  To (fsLoginUserID())
33853>>>        Send Find_User_Rights
33854>>>        Set piFN to lisrv
33855>>>    End_Procedure
33856>>>
33856>>>    Procedure Find_User_Rights
33857>>>        String lsArxeio lsLogin
33858>>>        Integer liUser liArxeio iGroup
33858>>>
33858>>>        Get cpiFileNumber   to liArxeio
33859>>>        Get cpsFileName     to lsArxeio
33860>>>        Get cpsLoginID      to lsLogin
33861>>>
33861>>>        Clear Users
33862>>>        Move lsLogin    to Users.Login_ID
33863>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
33864>>>>
33864>>>        If (Found=1)  Begin
33866>>>            Move Users.User_ID  to liUser
33867>>>            Move Users.Grp_ID   to iGroup
33868>>>        End
33868>>>>
33868>>>        //Else Send Operation_Not_Allowed 9999
33868>>>
33868>>>        Clear Arxeia
33869>>>
33869>>>        Move liArxeio to Arxeia.Arxeio_ID
33870>>>        Find eq Arxeia by Index.1 // Arxeia:Index.1:Arxeia.Arxeio_ID
33871>>>>
33871>>>
33871>>>        If (Found=1) Begin
33873>>>            Move Arxeia.Arxeio_ID to liArxeio
33874>>>
33874>>>            Clear GrpArx
33875>>>            Move liUser     to GrpArx.User_ID
33876>>>            Move liArxeio   to GrpArx.Arxeio_ID
33877>>>            Find eq GrpArx by Index.1 // GrpArx:Index.1:GrpArx.User_ID+GrpArx.Arxeio_ID
33878>>>>
33878>>>            If (Found=1) Begin
33880>>>               If (GrpArx.Allow_Read  ='1') Set cpiCannot_Read   to 0
33883>>>               Else                         Set cpiCannot_Read   to 10003
33885>>>               If (GrpArx.Allow_Create='1') Set cpiCannot_Create to 0
33888>>>               Else                         Set cpiCannot_Create to 10000
33890>>>               If (GrpArx.Allow_Change='1') Set cpiCannot_Edit   to 0
33893>>>               Else                         Set cpiCannot_Edit   to 10001
33895>>>               If (GrpArx.Allow_Delete='1') Set cpiCannot_Delete to 0
33898>>>               Else                         Set cpiCannot_Delete to 10002
33900>>>            End
33900>>>>
33900>>>            Else Begin
33901>>>                Clear GrpArx0
33902>>>                Move iGroup   to GrpArx0.Group_ID
33903>>>                Move liArxeio to GrpArx0.Arxeio_ID
33904>>>                Find eq GrpArx0 by Index.1 // GrpArx0:Index.1:Group_ID+Arxeio_ID
33905>>>>
33905>>>                If (Found=1) Begin
33907>>>                    If (GrpArx0.Allow_Read  ='1')   Set cpiCannot_Read   to 0
33910>>>                    Else                            Set cpiCannot_Read   to 20003
33912>>>                    If (GrpArx0.Allow_Create='1')   Set cpiCannot_Create to 0
33915>>>                    Else                            Set cpiCannot_Create to 20000
33917>>>                    If (GrpArx0.Allow_Change='1')   Set cpiCannot_Edit   to 0
33920>>>                    Else                            Set cpiCannot_Edit   to 20001
33922>>>                    If (GrpArx0.Allow_Delete='1')   Set cpiCannot_Delete to 0
33925>>>                    Else                            Set cpiCannot_Delete to 20002
33927>>>                End
33927>>>>
33927>>>                Else Begin
33928>>>                    Set cpiCannot_Read   to 0
33929>>>                    Set cpiCannot_Edit   to 0
33930>>>                    Set cpiCannot_Create to 0
33931>>>                    Set cpiCannot_Delete to 0
33932>>>                End
33932>>>>
33932>>>            End
33932>>>>
33932>>>        End
33932>>>>
33932>>>        Else Begin
33933>>>            // ¤ ¤ ¨  «¦ ¨® ¦ «¦« à¨¦¬£ ¦«  ¦ ®¨©«ª ®  §¨¦©© ©'¬«¦
33933>>>            Set cpiCannot_Read   to 0
33934>>>            Set cpiCannot_Edit   to 0
33935>>>            Set cpiCannot_Create to 0
33936>>>            Set cpiCannot_Delete to 0
33937>>>        End
33937>>>>
33937>>>    End_Procedure
33938>>>
33938>>>    Procedure Clear_main_file
33939>>>        Forward Send Clear_main_file
33941>>>        Set cpiBackout to 0
33942>>>        Set cpiUpdate  to 0
33943>>>    End_Procedure
33944>>>
33944>>>    Procedure Update
33945>>>        Forward Send Update
33947>>>        Set cpiUpdate to 1
33948>>>    End_Procedure
33949>>>
33949>>>    Procedure Backout
33950>>>        Forward Send Backout
33952>>>        Set cpiBackout to 1
33953>>>    End_Procedure
33954>>>
33954>>>    Procedure OnConstrain
33955>>>        Integer rVal liSrv
33956>>>        Forward Send OnConstrain
33958>>>        Get cpiFileNumber  To liSrv
33959>>>        Move liSrv         To Filenumber
33960>>>        Get cpiCannot_Read to rVal
33961>>>        If (rVal) Constrain Indirect_File.Recnum eq 0
33965>>>    End_Procedure
33966>>>
33966>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33967>>>        String sLektiko
33968>>>        Move '' to sLektiko
33969>>>
33969>>>             If iError_Num eq 10000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
33972>>>        Else If iError_Num eq 10001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Users permissions. Check with your Administrator"    to sLektiko
33976>>>        Else If iError_Num eq 10002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
33980>>>        Else If iError_Num eq 10003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
33984>>>        Else If iError_Num eq 20000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
33988>>>        Else If iError_Num eq 20001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Group permissions. Check with your Administrator"    to sLektiko
33992>>>        Else If iError_Num eq 20002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
33996>>>        Else If iError_Num eq 20003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
34000>>>        Else If iError_Num eq  9999 Move "Unknown User in Users File"                                                                                    to sLektiko
34004>>>        Else If iError_Num eq 20101 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Change its Data"                 to sLektiko
34008>>>        Else If iError_Num eq 20102 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Delete It"                       to sLektiko
34012>>>        Append sLektiko '\nFile = ' (String(cpiFileNumber(Self))) ' - ' (CpsFileName(Self))
34016>>>
34016>>>             If iError_Num eq 10000 Error 10000 sLektiko
34019>>>        Else If iError_Num eq 10001 Error 10001 sLektiko
34023>>>        Else If iError_Num eq 10002 Error 10002 sLektiko
34027>>>        Else If iError_Num eq 10003 Error 10003 sLektiko
34031>>>        Else If iError_Num eq 20000 Error 20000 sLektiko
34035>>>        Else If iError_Num eq 20001 Error 20001 sLektiko
34039>>>        Else If iError_Num eq 20002 Error 20002 sLektiko
34043>>>        Else If iError_Num eq 20003 Error 20003 sLektiko
34047>>>        Else If iError_Num eq  9999 Error  9999 sLektiko
34051>>>        Else If iError_Num eq 20101 Error 20101 sLektiko
34055>>>        Else If iError_Num eq 20102 Error 20102 sLektiko
34059>>>
34059>>>        Else Forward Send Operation_Not_Allowed  iError_Num
34062>>>    End_Procedure   // Operation_Not_Allowed
34063>>>
34063>>>
34063>>>End_Class //Datadictionary_Sec
34064>
34064>Integer giWait_Obj
34064>// Create-Edit-Delete Records only if the field m_code = gs_Module_Code
34064>Move "01" to gs_Module_Code
34065>
34065>//////////////////////
34065>// Regional Settings
34065>//Use Locales.pkg
34065>//Set Application_Locales ghoWorkSpace to True
34065>//Send Force_Application_Locales
34065>//////////////////////
34065>
34065>// Activate application once
34065>Set DoAutoSwitchPartial To ""
34066>
34066>// The Login Dialog Box
34066>Use ConnGL.dg
INCLUDING FILE: CONNGL.DG
34066>>>//AB/ Project ConnGL
34066>>>//AB/ Object prj is a Dialog_Project
34066>>>//AB/     Set ProjectName to "ConnGL"
34066>>>//AB/     Set ProjectFileName to "ConnGL.DG"
34066>>>
34066>>>// Project Object Structure
34066>>>//   ConnGL is a BasicPanelSub
34066>>>//     BitmapContainer1 is a BitmapContainerSub
34066>>>//     Textbox5 is a TextBoxSub
34066>>>//     ComboForm2 is a ComboFormSub
34066>>>//     Textbox6 is a TextBoxSub
34066>>>//     Form4 is a FormSub
34066>>>//     Textbox7 is a TextBoxSub
34066>>>//     Form5 is a FormSub
34066>>>//     Textbox8 is a TextBoxSub
34066>>>//     Form6 is a FormSub
34066>>>//     CheckBox1 is a CheckBoxSub
34066>>>//     oOK_bn is a ButtonSub
34066>>>//     oCancel_bn is a ButtonSub
34066>>>
34066>>>// Register all objects
34066>>>Register_Object BitmapContainer1
34066>>>Register_Object CheckBox1
34066>>>Register_Object ComboForm2
34066>>>Register_Object ConnGL
34066>>>Register_Object Form4
34066>>>Register_Object Form5
34066>>>Register_Object Form6
34066>>>Register_Object oCancel_bn
34066>>>Register_Object oOK_bn
34066>>>Register_Object Textbox5
34066>>>Register_Object Textbox6
34066>>>Register_Object Textbox7
34066>>>Register_Object Textbox8
34066>>>
34066>>>
34066>>>
34066>>>//AB-StoreTopStart
34066>>>
34066>>>///#INCLUDE
34066>>>Use mertech.inc
INCLUDING FILE: MERTECH.INC
34066>>>>>USE UI
34066>>>>>
#REM -----------------------------------------------
#REM MERTECH DATA SYSTEMS INC. - WWW.MERTECHDATA.COM
#REM MERTECH.INC VERSION 2.1.9
#REM -----------------------------------------------
34066>>>>>
34066>>>>>
34066>>>>>
34066>>>>>
34066>>>>>
34066>>>>>//
34066>>>>>//
34066>>>>>//
34066>>>>>//
34066>>>>>//
34066>>>>>//-----------------------------------------------
34066>>>>>// SELECT_COLUMNS_FIND <FILE> <START> THRU <END>
34066>>>>>// SELECT_COLUMNS_FIND <FILE> <FIELD>
34066>>>>>// This command will issue a properly commands to define the FETCH attribute status
34066>>>>>// for file fields.
34066>>>>>//
34066>>>>>//------------------------------------------------------------------------------
34066>>>>>// RESET_FETCH_FIELDS <FILE NAME>|<FILE NUMBER> <DF_FETCH_TRUE>|<DF_FETCH_FALSE>
34066>>>>>//
34066>>>>>//
34066>>>>>//-----------------------------
34066>>>>>// SQL_FOR_ONEROW <file number>
34066>>>>>//
34066>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get just
34066>>>>>// one ROW for each DataFlex FIND command issued
34066>>>>>// In this case the DBMS optimizer will generate a query with just one row
34066>>>>>//
34066>>>>>//
34066>>>>>//-------------------------------------------------------------------------------
34066>>>>>// SQL_FOR_SET <file number> MAXROWS <number of rows> CACHE|NOCACHE <return code>
34066>>>>>//
34066>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get a SET of rows.
34066>>>>>// In this case the DBMS optimizer will generate a query with <number of rows> Rows.
34066>>>>>// if CACHE is passed as argument, all these rows will be transfered to ORAFlex and then it will
34066>>>>>// save them in a local CACHE buffer. Just the FIND GT and FIND LT will get local cache.
34066>>>>>// Otherwise, i.e NOCACHE,  ORAFLex won't create a local cache.
34066>>>>>//
34066>>>>>//
34066>>>>>//---------------
34066>>>>>// SQL_SET <stmt>
34066>>>>>//
34066>>>>>//-----------------------------------------
34066>>>>>// SQL_APPEND <stmt1> <stmt2> .... <stmtn>
34066>>>>>//
34066>>>>>//------------
34066>>>>>// SQL_EXECUTE
34066>>>>>//
34066>>>>>//----------------------------------------------------------------------
34066>>>>>// LOCK_TABLE [<FILE NAME>|<FILE NUMBER> <FILE NAME>|<FILE NUMBER> ....]
34066>>>>>//
34066>>>>>// LOCK_TABLE will lock the entire table specified as an argument
34066>>>>>// This command will start a new transaction if it still wasn't done.
34066>>>>>// LOCK_TABLE won't lock the other opened tables or the current rows present
34066>>>>>// in their buffers it will be necessary issue a REREAD command to Lock the current
34066>>>>>// rows and then atualize their buffers
34066>>>>>//
34066>>>>>//
34066>>>>>//-------------------------------------------
34066>>>>>// SQL_CHECK_TABLE <SCHEMA NAME> <TABLE NAME>
34066>>>>>//
34066>>>>>//-------------------------------
34066>>>>>// CREATE_TD_FILE  DFTRUE|DFFALSE
34066>>>>>// SET A GLOBAL ATTRIBUTE TO CREATE THE TD FILE AFTER CLOSING AN OPENED FILE
34066>>>>>//
34066>>>>>//-------------------------------------------------
34066>>>>>// OPEN_INT <DATAFLEX FILE NAME>
34066>>>>>// OPEN_INT <PHYSICAL NAME> AS <DATAFLEX FILE NAME>
34066>>>>>//
34066>>>>>// OPEN_INT will check if the OPEN done is an OPEN AS. IF it's true, OPEN_INT
34066>>>>>// will try to open an intermediate file, if there is one. Otherwise OPEN_INT
34066>>>>>// will issue a OPEN command
34066>>>>>// OPEN_INT must be inserted into FMAC file instead OPEN COMMAND
34066>>>>>//
34066>>>>>//=========================================================================================================
34066>>>>>// SELECT STUFFS
34066>>>>>//--------------
34066>>>>>// SQL_SET_STMT OF FILENAME|FILENUMBER TO <STATMENT1>
34066>>>>>//
34066>>>>>// SQL_APPEND_ OF FILENAME|FILENUMBER TO <STATMENT1> <STATMENT2> ... <STATMENTn>
34066>>>>>//
34066>>>>>//
34066>>>>>// SQL_APPEND_UPDCOL_STMT OF FILENAME|FILENUMBER VALUE EXPRESSION WITH FIELD1 FIELD2 ... FIELDN
34066>>>>>//
34066>>>>>// SQL_PREPARE_STMT OF FILENAME|FILENUMBER
34066>>>>>//
34066>>>>>// SQL_BIND_COLUMN [FILENAME|FILENUMBER] [FIELDNAME|FIELDNUMBER]
34066>>>>>//
34066>>>>>// SQL_BINDCOLUMNS_STMT OF FILENAME|FILENUMBER TO <COLUMN1> <COLUMN2> ... <COLUMNn>
34066>>>>>//
34066>>>>>// SQL_EXECUTE_STMT OF FILENAME|FILENUMBER
34066>>>>>//
34066>>>>>// SQL_COMMIT_STMT
34066>>>>>//
34066>>>>>// SQL_ROLLBACK_STMT
34066>>>>>//
34066>>>>>// SQL_FETCH_NEXT_ROW OF FILENAME|FILENUMBER
34066>>>>>//
34066>>>>>//
34066>>>>>//
34066>>>>>//
34066>>>>>// CALL_STORED_PROCEDURE will call a stored procedure passing arguments
34066>>>>>//
34066>>>>>// FORMAT TO USE : CALL_STORED_PROCEDURE <STORED_PROC_NAME> [PASSING <ARG1> <ARG2> ....<ARGn>]
34066>>>>>//
34066>>>>>//
34066>>>>>//---------------------------------------------------------------------------------------------
34066>>>>>// CALL_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
34066>>>>>// CALL_STORED_FUNCTION will call an Oracle stored function passing arguments
34066>>>>>//
34066>>>>>//---------------------------
34066>>>>>// SQL_TEXT_MESSAGE <MESSAGE>
34066>>>>>// Writes a message inside driver log trace file if this is activated
34066>>>>>//
34066>>>>>//-----------------------------------------------------
34066>>>>>// OUTPUT_INT_FILE FOR <FILE NUMBER> TO <INT FILE NAME>
34066>>>>>// Generating the INT file
34066>>>>>//
34066>>>>>// -----------------------
34066>>>>>// SQL_ERROR_MESSAGE <VAR>
34066>>>>>// SQL_ERROR_MESSAGE retrieve the native error message issued by server for error number 25000
34066>>>>>
34066>>>>>
34066>>>>>//=======================================================================================
34066>>>>>// SQLFlex Commands
34066>>>>>//-----------------
34066>>>>>//
34066>>>>>//-----------------------
34066>>>>>// SQLFlex_REVISION <VAR>
34066>>>>>// Retrieves SQLFlex revision
34066>>>>>//
34066>>>>>//-------------------------------------
34066>>>>>// SET_DATABASE_NAME TO <DATABASE NAME>
34066>>>>>// Sets current database
34066>>>>>//
34066>>>>>//---------------------------
34066>>>>>// GET_DATABASE_NAME TO <VAR>
34066>>>>>// Gets name of current database
34066>>>>>//
34066>>>>>//----------------------------------
34066>>>>>// SET_SCHEMA_NAME TO <SCHEMA NAME>
34066>>>>>// Sets current schema name
34066>>>>>//
34066>>>>>//-------------------------
34066>>>>>// GET_SCHEMA_NAME TO <VAR>
34066>>>>>// Gets current schema name
34066>>>>>//
34066>>>>>//--------------------------------
34066>>>>>// SQL_USEDATABASE <DATABASE NAME>
34066>>>>>// Specifies the current Database
34066>>>>>//
34066>>>>>//----------------------------
34066>>>>>// SET_CURRENT_SERVER TO <VAR>
34066>>>>>// Set the current logged server
34066>>>>>//
34066>>>>>//----------------------------
34066>>>>>// GET_CURRENT_SERVER TO <VAR>
34066>>>>>// Retrieves the current logged server
34066>>>>>//
34066>>>>>//-----------------------------
34066>>>>>// SET_HOST_NAME TO <HOST NAME>
34066>>>>>// Defines current host name
34066>>>>>//
34066>>>>>//-----------------------
34066>>>>>// GET_HOST_NAME TO <VAR>
34066>>>>>// Retrieves the current host name
34066>>>>>//
34066>>>>>//---------------------------------------------------------------
34066>>>>>// LOGIN_SQLFLEX <SERVER NAME> <USER NAME> <PASSWORD> <HOST NAME>
34066>>>>>// Specifies host name during login process
34066>>>>>//
34066>>>>>// SQL_CANCEL_QUERY_STMT
34066>>>>>//
34066>>>>>//========================================
34066>>>>>// SQL SERVER Stored Procedure Call engine
34066>>>>>//----------------------------------------
34066>>>>>//
34066>>>>>//
34066>>>>>
34066>>>>>//
34066>>>>>//--------------------------------------------------------------------------------------------------------------
34066>>>>>// CALL_SQLSERVER_PROCEDURE <procedure name> PASSING <VALUE1|VARIABLE1> [SQLOUT] <VALUE2|VARIABLE2> [SQLOUT] ...
34066>>>>>//
34066>>>>>// Executes a stored procedure. SQLOUT will be used to indicate that the stored procedure
34066>>>>>// returns a parameter. The matching parameter in the stored proceudre must have been created with
34066>>>>>// the keyword OUTPUT. Call all procedures that doesn't returns any query with this syntax
34066>>>>>//
34066>>>>>//
34066>>>>>//
34066>>>>>//-----------------------------------------------------------------------------
34066>>>>>
34066>>>>>
34066>>>>>//=============================================================================
34066>>>>>// ORAFlex Commands
34066>>>>>//-----------------
34066>>>>>//----------------------------
34066>>>>>// ORAFlex_REVISION <VARIABLE>
34066>>>>>// Retrieves ORAFlex revision
34066>>>>>//
34066>>>>>//---------------------------------
34066>>>>>// KEEP_FILES_OPEN OF <SERVER NAME>
34066>>>>>// Keeps all files opened even during a LOGOUT
34066>>>>>//
34066>>>>>//-----------------------------------------------
34066>>>>>// SET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
34066>>>>>// Defines the maximum number of cursors that ORAFlex will be allowed for using
34066>>>>>//
34066>>>>>//-----------------------------------------------
34066>>>>>// GET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
34066>>>>>// Retrieves the maximum number of cursors allowed for ORAFlex use
34066>>>>>//
34066>>>>>//---------------------------------------------
34066>>>>>// GET_OPENED_CURSORS OF <SERVER NAME> TO <VAR>
34066>>>>>// Retrieves the number of opened cursors
34066>>>>>//
34066>>>>>//-----------------------------------------------
34066>>>>>// ACTIVATE_TIME_STAMP OF <SERVER NAME> TO ON|OFF
34066>>>>>// Activates Time stamp for date columns
34066>>>>>//
34066>>>>>//----------------------------------------------------------------------------------------------------
34066>>>>>// CALL_ORACLE_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
34066>>>>>// CALL_ORACLE_STORED_FUNCTION will call an Oracle stored function passing arguments
34066>>>>>//
34066>>>>>//-----------------------------------------------------------------------------
34066>>>>>
34066>>>>>//=============================================================================
34066>>>>>// BUFFER save stuffs
34066>>>>>//-------------------
34066>>>>>
34066>>>>>//-------------------------------------------------------
34066>>>>>// SQL_SAVE_BUFFER_BEGIN OF <FILE NUMBER> TO <CACHE SIZE>
34066>>>>>// Initialize the BUFFER buffer
34066>>>>>//
34066>>>>>//---------------------------------
34066>>>>>// SQL_SAVE_BUFFER OF <FILE NUMBER>
34066>>>>>// Moves field buffer values to cache buffer
34066>>>>>//-------------------------------------
34066>>>>>// SQL_SAVE_BUFFER_END OF <FILE NUMBER>
34066>>>>>// Save rows that remains in cache
34066>>>>>//-----------------------------------------------------------------------------
34066>>>>>
34066>>>
34066>>>//AB-StoreTopEnd
34066>>>
34066>>>//AB-IgnoreStart
34066>>>
34066>>>Use Panel.Sub
34066>>>Use Bitmap.Sub
34066>>>Use Txtbox.Sub
34066>>>Use Cmbfrm.Sub
34066>>>Use Form.Sub
34066>>>Use Chkbox.Sub
34066>>>Use Button.Sub
34066>>>
34066>>>
34066>>>//AB-IgnoreEnd
34066>>>
34066>>>Object ConnGL is a BasicPanelSub
34068>>>
34068>>>    //AB-StoreTopStart
34068>>>
34068>>>    //AB-StoreTopEnd
34068>>>
34068>>>    Set Sysmenu_Icon to FALSE
34069>>>    Set Minimize_Icon to FALSE
34070>>>    Set Label to "Login"
34071>>>    Set Size to 105 230
34072>>>    Set Location to 20 37
34073>>>
34073>>>    //AB-DDOStart
34073>>>
34073>>>
34073>>>    //AB-DDOEnd
34073>>>
34073>>>    Object BitmapContainer1 is a BitmapContainerSub
34075>>>        Set Size to 21 23
34076>>>        Set Location to 4 4
34077>>>        Set Bitmap to "Login1.bmp"
34078>>>        Set Border_Style to Border_None
34079>>>        Set Bitmap_Style to Bitmap_Center
34080>>>        Set Dialog_Caption to "Select a bitmap file"
34081>>>
34081>>>        //AB-StoreStart
34081>>>
34081>>>
34081>>>
34081>>>
34081>>>        //AB-StoreEnd
34081>>>
34081>>>    End_Object    // BitmapContainer1
34082>>>
34082>>>    Object Textbox5 is a TextBoxSub
34084>>>        Set Label to "Driver:"
34085>>>        Set FontSize to 4 0
34086>>>        Set Location to 6 34
34087>>>        Set Size to 13 40
34088>>>        Set Enabled_State to TRUE
34089>>>    End_Object    // Textbox5
34090>>>
34090>>>    Object ComboForm2 is a ComboFormSub
34092>>>
34092>>>        //AB-StoreTopStart
34092>>>
34092>>>        Set CapsLock_State to True
34093>>>
34093>>>        //AB-StoreTopEnd
34093>>>
34093>>>        Set Size to 13 85
34094>>>        Set Location to 6 76
34095>>>        Set Label_Col_Offset to 2
34096>>>        Set Label_Justification_Mode to jMode_Right
34097>>>
34097>>>        //AB-StoreStart
34097>>>        Procedure Combo_Fill_List
34099>>>                Local String Availdrv## TempDrv##
34100>>>                Local Integer HowMany i p1## p2##
34100>>>
34100>>>                get_profile_string "WorkSpaces" "CurrentWorkspace" to AvailDrv##
34103>>>                If AvailDrv## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to AvailDrv##
34106>>>                insert "WorkSpaces\" in AvailDrv## at 1
34108>>>                get_profile_string AvailDrv## "AvailableDrivers" to AvailDrv##
34111>>>
34111>>>                Move Availdrv## to Tempdrv##
34112>>>                Repeat
34112>>>>
34112>>>                    Replace "|" in Tempdrv## With ""
34114>>>                    [Found] Increment HowMany
34115>>>                Until [Finderr]
34117>>>
34117>>>                Send Combo_add_Item ""
34118>>>
34118>>>                If HowMany lt 1 Begin
34120>>>                    If Availdrv## ne "" Send Combo_Add_Item (UpperCase(Availdrv##))
34123>>>                End
34123>>>>
34123>>>                Else Begin
34124>>>                    For i From 0 to HowMany
34130>>>>
34130>>>                        If i eq 0 Move 1 to p1##
34133>>>                        Else Begin
34134>>>                            Move ((Pos("|",Availdrv##))+1) to p1##
34135>>>                            Replace "|" in Availdrv## With ","
34137>>>                        End
34137>>>>
34137>>>                        Move ((Pos("|",Availdrv##))) to p2##
34138>>>                        Send Combo_Add_Item (UpperCase(Mid(Availdrv##,(p2##-p1##),p1##)))
34139>>>                    Loop
34140>>>>
34140>>>                End
34140>>>>
34140>>>        End_Procedure
34141>>>
34141>>>        Set Allow_Blank_state to True
34142>>>
34142>>>
34142>>>
34142>>>        //AB-StoreEnd
34142>>>
34142>>>    End_Object    // ComboForm2
34143>>>
34143>>>    Object Textbox6 is a TextBoxSub
34145>>>        Set Label to "Server:"
34146>>>        Set FontSize to 4 0
34147>>>        Set Location to 22 34
34148>>>        Set Size to 13 40
34149>>>        Set Enabled_State to TRUE
34150>>>    End_Object    // Textbox6
34151>>>
34151>>>    Object Form4 is a FormSub
34153>>>        Set Size to 13 93
34154>>>        Set Location to 22 76
34155>>>        Set Label_Col_Offset to 2
34156>>>        Set Label_Justification_Mode to jMode_Right
34157>>>    End_Object    // Form4
34158>>>
34158>>>    Object Textbox7 is a TextBoxSub
34160>>>        Set Label to "User Name:"
34161>>>        Set FontSize to 4 0
34162>>>        Set Location to 38 34
34163>>>        Set Size to 13 40
34164>>>        Set Enabled_State to TRUE
34165>>>    End_Object    // Textbox7
34166>>>
34166>>>    Object Form5 is a FormSub
34168>>>        Set Size to 13 93
34169>>>        Set Location to 38 76
34170>>>        Set Label_Col_Offset to 2
34171>>>        Set Label_Justification_Mode to jMode_Right
34172>>>    End_Object    // Form5
34173>>>
34173>>>    Object Textbox8 is a TextBoxSub
34175>>>        Set Label to "Password:"
34176>>>        Set FontSize to 4 0
34177>>>        Set Location to 54 34
34178>>>        Set Size to 13 40
34179>>>        Set Enabled_State to TRUE
34180>>>    End_Object    // Textbox8
34181>>>
34181>>>    Object Form6 is a FormSub
34183>>>        Set Size to 13 93
34184>>>        Set Location to 54 76
34185>>>        Set Label_Col_Offset to 2
34186>>>        Set Label_Justification_Mode to jMode_Right
34187>>>
34187>>>        //AB-StoreStart
34187>>>        Set Password_State Item 0 to True
34188>>>
34188>>>        //AB-StoreEnd
34188>>>
34188>>>    End_Object    // Form6
34189>>>
34189>>>    Object CheckBox1 is a CheckBoxSub
34191>>>        Set Label to "Save Password"
34192>>>        Set Size to 10 66
34193>>>        Set Location to 73 76
34194>>>        Set Status_Help to "Remember The Password at Next Login"
34195>>>    End_Object    // CheckBox1
34196>>>
34196>>>    Object oOK_bn is a ButtonSub
34198>>>        Set Label to "Co&nnect"
34199>>>        Set Default_State to TRUE
34200>>>        Set Bitmap to "mcr.bmp"
34201>>>        Set Size to 28 33
34202>>>        Set Location to 9 184
34203>>>
34203>>>        //AB-StoreStart
34203>>>        Procedure OnClick
34205>>>            Set LoginOk to True
34206>>>            Send Stop_Modal_ui
34207>>>        End_Procedure
34208>>>        Set Status_Help to "ConnGL"
34209>>>
34209>>>
34209>>>
34209>>>
34209>>>
34209>>>
34209>>>
34209>>>
34209>>>
34209>>>
34209>>>
34209>>>
34209>>>
34209>>>        //AB-StoreEnd
34209>>>
34209>>>    End_Object    // oOK_bn
34210>>>
34210>>>    Object oCancel_bn is a ButtonSub
34212>>>        Set Label to "&Cancel"
34213>>>        Set Bitmap to "exit2.bmp"
34214>>>        Set Size to 28 32
34215>>>        Set Location to 39 184
34216>>>
34216>>>        //AB-StoreStart
34216>>>        ON_KEY KENTER SEND Exit_Application to (ConnGL(Current_Object))
34217>>>        Procedure OnClick
34219>>>            Set LoginOk to False
34220>>>            Send Exit_Application to (ConnGL(Current_Object))
34221>>>        End_Procedure
34222>>>
34222>>>        Set Status_Help to "Close Application"
34223>>>
34223>>>
34223>>>
34223>>>
34223>>>
34223>>>
34223>>>
34223>>>
34223>>>
34223>>>
34223>>>
34223>>>        //AB-StoreEnd
34223>>>
34223>>>    End_Object    // oCancel_bn
34224>>>
34224>>>
34224>>>    //AB-StoreStart
34224>>>
34224>>>    Set Modal_State to True
34225>>>
34225>>>    // Now is WorkspaceAware
34225>>>
34225>>>    ON_KEY KENTER SEND OnClick to (oOk_bn(Current_Object))
34226>>>    ON_KEY KSAVE_RECORD SEND OK
34227>>>    ON_KEY KCANCEL SEND EXIT_APPLICATION
34228>>>    ON_KEY KCLOSE_PANEL SEND EXIT_APPLICATION
34229>>>
34229>>>    Set Locate_Mode to Center_On_Screen
34230>>>    Set Exit_Application_Local_State to False
34231>>>    Set Exit_MSG to Exit
34232>>>    Set Description_State to True
34233>>>
34233>>>    Property Integer LoginOk public false
34235>>>
34235>>>    External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;        Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
34236>>>
34236>>>    Function Network_User_Name Returns String
34238>>>        Local String sName sLength
34239>>>        Local Pointer lpName_Addr lpLength_Addr
34239>>>        Local Integer iRetval
34239>>>
34239>>>        Movestr (Repeat (Character (0), 255)) To sName
34240>>>>
34240>>>        GetAddress Of sName To lpName_Addr
34241>>>        Movestr (DwordToBytes (255)) To sLength
34242>>>>
34242>>>        GetAddress Of sLength To lpLength_Addr
34243>>>
34243>>>        Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
34244>>>>
34244>>>
34244>>>        If iRetval Eq 0 Function_Return (CString (sName))
34247>>>        Else Function_Return "User Unknown"
34249>>>    End_Function // Network_User_Name
34250>>>
34250>>>    Function fsCrypto String lsWay String lsOld Returns String
34252>>>        Local String lsNew lsTemp
34253>>>        Local Integer liCount
34253>>>           For liCount From 1 to (Length(lsOld))
34259>>>>
34259>>>               Mid lsOld to lsTemp 1 liCount
34262>>>>
34262>>>               If ((Uppercase(lsWay)) eq 'FORWARD') Begin
34264>>>               If ((Ascii(lsTemp) = 255)) Move (Character(32)) to lsTemp
34267>>>               Else Move (Character(Ascii(lsTemp)+1)) to lsTemp
34269>>>               End
34269>>>>
34269>>>               Else Begin
34270>>>                   If ((Uppercase(lsWay)) eq 'BACKWARD') Begin
34272>>>                       If ((Ascii(lsTemp) = 32)) Move (Character(255)) to lsTemp
34275>>>                       Else Move (Character(Ascii(lsTemp)-1)) to lsTemp
34277>>>                   End
34277>>>>
34277>>>               End
34277>>>>
34277>>>               Append lsNew lsTemp
34278>>>           Loop
34279>>>>
34279>>>        Function_Return (lsNew)
34280>>>    End_Function
34281>>>
34281>>>    Procedure Activating
34283>>>        Local String LoginDriver## LoginServer## LoginUserid## LoginPassword##
34284>>>        Local String LastLogin## LoginSeq##
34284>>>        Local Integer SavePassword##
34284>>>
34284>>>        Forward Send Activating
34286>>>
34286>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
34289>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
34292>>>        insert "WorkSpaces\" in LastLogin## at 1
34294>>>        Append LastLogin## "\" (Module_Name(Self)) "\LastLogin"
34297>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
34300>>>
34300>>>        If "|" in LoginSeq## move (left(LoginSeq##,(pos("|",LoginSeq##) -1))) to LoginDriver##
34303>>>        Else Move LoginSeq## to LoginDriver##
34305>>>        get_profile_string LastLogin## "LoginServer"  to LoginServer##
34308>>>        get_profile_string LastLogin## "LoginUserId"  to LoginUserId##
34311>>>        get_profile_string LastLogin## "SavePassword" to SavePassword##
34314>>>        If LoginUserId## eq "" Move (Network_User_Name(Current_Object)) to LoginUserId##
34317>>>
34317>>>        If (((UpperCase(LoginDriver##)) eq "DATAFLEX") or (LoginDriver## eq "")) Begin
34319>>>                Set Value of (ComboForm2(Current_Object)) Item 0 to ""
34320>>>                Set Value of (Form4(Current_Object))      Item 0 to ""
34321>>>        End
34321>>>>
34321>>>        Else Begin
34322>>>            Set Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
34323>>>            Set Value of (Form4(Current_Object))      Item 0 to LoginServer##
34324>>>        End
34324>>>>
34324>>>        Set Value of (Form5(Current_Object))      Item 0 to LoginUserID##
34325>>>        Set Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
34326>>>        If (SavePassword##) Begin
34328>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
34329>>>            get_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to LoginPassword##
34333>>>            Set Value of (Form6(Current_Object))      Item 0 to (fsCrypto(Self,"backward",LoginPassword##))
34334>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
34335>>>        End
34335>>>>
34335>>>    End_Procedure
34336>>>
34336>>>    Function LoginUser Returns Integer
34338>>>        Integer SavePassword## Size## PasswordOk
34339>>>        String LoginDriver## LoginServer## LoginUserid## LoginPassword## LoginSeq## LastLogin##
34339>>>        String lsLoginDate lsHH lsMM lsSS sDepartment
34339>>>        Integer liOpenCursors
34339>>>
34339>>>        Send Popup_Modal
34340>>>
34340>>>        Get Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
34341>>>        Get Value of (Form4(Current_Object))      Item 0 to LoginServer##
34342>>>        Get Value of (Form5(Current_Object))      Item 0 to LoginUserID##
34343>>>        Get Value of (Form6(Current_Object))      Item 0 to LoginPassword##
34344>>>        Get Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
34345>>>        Set Value of (Form6(Current_Object))      Item 0 to ""
34346>>>
34346>>>        If ((LoginDriver## <> "") and (UpperCase(LoginDriver##)<>"DATAFLEX"))  begin
34348>>>            send ignore_error to (error_info_object(current_object)) 25000
34349>>>            send ignore_error to (error_info_object(current_object)) 4255
34350>>>            send ignore_error to (error_info_object(current_object)) 12293
34351>>>            login LoginServer## LoginUserId## LoginPassword## LoginDriver##
34353>>>            send trap_error to (error_info_object(current_object)) 25000
34354>>>            send trap_error to (error_info_object(current_object)) 4255
34355>>>            send trap_error to (error_info_object(current_object)) 12293
34356>>>            If LastErr eq 25000 Begin
34358>>>                Error LastErr "Invalid Login Information"
34359>>>>
34359>>>                Set LoginOk to False
34360>>>                Send Exit_Application
34361>>>            End
34361>>>>
34361>>>            If LastErr eq 4255 Begin
34363>>>                Error LastErr "Invalid Driver Name"
34364>>>>
34364>>>                Set LoginOk to False
34365>>>                Send Exit_Application
34366>>>            End
34366>>>>
34366>>>            If LastErr eq 12293 Begin
34368>>>                Error LastErr "(IBM CLI)Database alias name or Database name not found"
34369>>>>
34369>>>                Set LoginOk to False
34370>>>                Send Exit_Application
34371>>>            End
34371>>>>
34371>>>            Set LoginOk to True
34372>>>            If (UpperCase(LoginDriver##) = "ORA_DRV") Begin
34374>>>                GET_MAX_OPEN_CURSORS of LoginServer## to liOpenCursors
34387>>>                If (liOpenCursors <> 0) SET_MAX_OPEN_CURSORS of LoginServer## to (liOpenCursors+2)
34400>>>            End
34400>>>>
34400>>>        End
34400>>>>
34400>>>        Else Begin
34401>>>            Set LoginOk to True
34402>>>            Open "Users" as Users
34404>>>            Move "DATAFLEX" To LoginDriver##
34405>>>            Move "" to LoginServer##
34406>>>            File_Size Users to Size##
34409>>>            If Size## ne 0 Begin
34411>>>                 Clear Users
34412>>>                 Move LoginUSerId##   to Users.Login_Id
34413>>>                 Find eq Users by Index.1
34414>>>>
34414>>>                 [Finderr] Begin
34416>>>>
34416>>>                    Error 25000 "Unknown User"
34417>>>>
34417>>>                    Set LoginOk to False
34418>>>                    Get LoginOk to PasswordOk
34419>>>                    Function_Return PasswordOk
34420>>>                 End
34420>>>>
34420>>>                 [Found] Begin
34422>>>>
34422>>>                    If (LoginPassword## ne Users.Password) Begin
34424>>>                        Error 25000 "Invalid Password"
34425>>>>
34425>>>                        Set LoginOk to False
34426>>>                        Get LoginOk to PasswordOk
34427>>>                        Function_Return PasswordOk
34428>>>                    End
34428>>>>
34428>>>                 End
34428>>>>
34428>>>            End
34428>>>>
34428>>>
34428>>>            //Close Users
34428>>>
34428>>>
34428>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
34428>>>    //            Integer bFileExists
34428>>>    //            Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
34428>>>    //            If (NOT(bFileExists)) Begin
34428>>>
34428>>>    //                Get Get_File_Exists  "C:\UsrLogin.txt" To bFileExists
34428>>>    //                If (bFileExists) Begin
34428>>>
34428>>>    ////                        If Size## ne 0 Begin
34428>>>
34428>>>    //                            Local String ss1 ss2 ss3 ss4
34428>>>    //                            Local String dd1 dd2 dd3 dd4
34428>>>    //                            Move '' to dd1
34428>>>    //                            Move '' to dd2
34428>>>    //                            Move '' to dd3
34428>>>    //                            Move '' to dd4
34428>>>
34428>>>    //                            Direct_Input Channel 8 "C:\UsrLogin.txt"
34428>>>    //                            Readln Channel 8 ss1 ss2 ss3 ss4
34428>>>    //                            While (Not(Seqeof))
34428>>>    //                                Move (Trim(ss1)) to ss1
34428>>>    //                                Move (Trim(ss2)) to ss2
34428>>>    //                                Move (Trim(ss3)) to ss3
34428>>>    //                                Move (Trim(ss4)) to ss4
34428>>>    //                                Append dd1 '"' ss1 '"'
34428>>>    //                                Append dd2 '"' ss2 '"'
34428>>>    //                                Append dd3 '"' ss3 '"'
34428>>>    //                                Append dd4 '"' ss4 '"'
34428>>>    //                                Login dd1 dd2 dd3 dd4
34428>>>    //                                Readln Channel 8 ss1 ss2 ss3 ss4
34428>>>    //                            Loop
34428>>>
34428>>>
34428>>>    ////                            // Only Filmnet Users Log on to SQL
34428>>>    ////                            If (sDepartment='FILMNET') Begin
34428>>>    ////                                ////// 20/06/2001 js Allagh apo Oracle se SQL server
34428>>>    ////                                ////// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
34428>>>    ////                                login '192.168.128.5'   'sa'    ''   'SQL_DRV'
34428>>>    ////                                login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
34428>>>    ////                            End
34428>>>    ////                            Else login '192.168.128.5'      'sa'    ''   'SQL_DRV'
34428>>>    ////                            //Else login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
34428>>>
34428>>>    ////                        End
34428>>>    ////                        Else Begin
34428>>>    ////                            ////// 20/06/2001 js Allagh apo Oracle se SQL server
34428>>>    ////                            ///// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
34428>>>    ////                            login '192.168.128.5'       'sa'    ''   'SQL_DRV'
34428>>>    ////                            //login '192.168.128.5'   'EPGDNS'    'DNS'   'SQL_DRV'
34428>>>    ////                            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
34428>>>    ////                        End
34428>>>
34428>>>
34428>>>    //                End
34428>>>
34428>>>    //            End
34428>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
34428>>>
34428>>>
34428>>>
34428>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
34428>>>            //*Integer bFileExists
34428>>>            //*Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
34428>>>            //*If (NOT(bFileExists)) Begin
34428>>>            //*    If Size## ne 0 Begin
34428>>>            //*        // Only Filmnet Users Log on to SQL
34428>>>            //*        If (sDepartment='FILMNET') Begin
34428>>>            //*            login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
34428>>>            //*            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
34428>>>            //*        End
34428>>>            //*        Else login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
34428>>>            //*    End
34428>>>            //*    Else Begin
34428>>>            //*        login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
34428>>>            //*        login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
34428>>>            //*    End
34428>>>            //*
34428>>>            //*End
34428>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
34428>>>
34428>>>
34428>>>
34428>>>        End
34428>>>>
34428>>>
34428>>>        Get LoginOk to PasswordOk
34429>>>        Sysdate lsLoginDate lsHH lsMM lsSS
34433>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
34436>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
34439>>>        insert "WorkSpaces\" in LastLogin## at 1
34441>>>        get_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
34444>>>        If ((LoginDriver## ne "") and ((UpperCase(LoginDriver##)) ne "DATAFLEX")) Begin
34446>>>           If Not LoginDriver## in LoginSeq## Begin
34448>>>                 If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
34451>>>                 Else Move (LoginSeq##+"|"+LoginDriver##) to LoginSeq##
34453>>>                 set_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
34456>>>           End
34456>>>>
34456>>>        End
34456>>>>
34456>>>        Append LastLogin## "\" (Module_Name(Self))
34458>>>        Append LastLogin## "\LastLogin"
34459>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
34462>>>
34462>>>        If "|" in LoginSeq## Begin
34464>>>            If ((left(LoginSeq##,(pos("|",LoginSeq##) -1))) ne LoginDriver##) Insert (LoginDriver##+"|") in LoginSeq## at 1
34468>>>        End
34468>>>>
34468>>>        Else Begin
34469>>>            If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
34472>>>            Else If LoginSeq## ne LoginDriver## Insert (LoginDriver##+"|") in LoginSeq## at 1
34477>>>        End
34477>>>>
34477>>>        Left LoginSeq## to LoginSeq## 250
34479>>>>
34479>>>        set_profile_string LastLogin## "LoginDriver" to (UpperCase(LoginSeq##))
34482>>>        set_profile_string LastLogin## "LoginServer" to LoginServer##
34485>>>        set_profile_string LastLogin## "LoginUserId" to LoginUserId##
34488>>>        set_profile_string LastLogin## "SavePassword" to SavePassword##
34491>>>        If lsHH lt 10 Insert 0 in lsHH at 1
34495>>>        If lsMM lt 10 Insert 0 in lsMM at 1
34499>>>        If lsSS lt 10 Insert 0 in lsSS at 1
34503>>>        Append lsLoginDate " - " lsHH ":" lsMM ":" lsSS
34509>>>        set_profile_string LastLogin## "LoginTime" to lsLoginDate
34512>>>        If (SavePassword##) Begin
34514>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
34515>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to (fsCrypto(Self,"forward",LoginPassword##))
34518>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
34519>>>        End
34519>>>>
34519>>>        Else Begin
34520>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
34521>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to ""
34524>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
34525>>>        End
34525>>>>
34525>>>
34525>>>        Function_Return PasswordOk
34526>>>    End_Function
34527>>>
34527>>>    Procedure LoginGL For Desktop
34528>>>        Local Integer LoginPassword##
34529>>>        Get LoginUser of (ConnGL(Current_Object)) to LoginPassword##
34530>>>        If Not LoginPassword## Send Exit_Application
34533>>>    End_Procedure
34534>>>
34534>>>    Function CheckLogin For Desktop Returns Integer
34535>>>        Local Integer LoginPassword##
34536>>>        Get LoginUser of (ConnGL(Current_Object)) to LoginPassword##
34537>>>        Function_Return LoginPassword##
34538>>>    End_Function
34539>>>
34539>>>
34539>>>
34539>>>    //AB-StoreEnd
34539>>>
34539>>>End_Object    // ConnGL
34540>>>
34540>>>
34540>>>//AB-StoreStart
34540>>>
34540>>>
34540>>>
34540>>>//AB-StoreEnd
34540>>>
34540>>>//AB/ End_Object    // prj
34540>Send LoginGL
34541>
34541>// Select Company-Branch-Year Dialog Box
34541>Use SelectGL.dg
INCLUDING FILE: SELECTGL.DG
34541>>>//AB/ Project Select / Change Xrhsh GL
34541>>>//AB/ Object prj is a Dialog_Project
34541>>>//AB/     Set ProjectName to "Select / Change Xrhsh GL"
34541>>>//AB/     Set ProjectFileName to "SelectGL.dg"
34541>>>
34541>>>// Project Object Structure
34541>>>//   oSelectYear is a dbModalPanelSub
34541>>>//     Company_DD is a DataDictionary
34541>>>//     Branch_DD is a DataDictionary
34541>>>//     Year_DD is a DataDictionary
34541>>>//     Company_Company_Code is a dbFormSub
34541>>>//     Company_Company_Name is a dbFormSub
34541>>>//     Branch_Branch_Code is a dbFormSub
34541>>>//     Branch_Branch_Name is a dbFormSub
34541>>>//     Year_Year_Year is a dbFormSub
34541>>>//     Year_Year_Descr is a dbFormSub
34541>>>//     Year_Year_Entrydate is a dbFormSub
34541>>>//     oOk_bn is a ButtonSub
34541>>>//     oCancel_bn is a ButtonSub
34541>>>//     otxtCompany is a TextBoxSub
34541>>>//     otxtBranch is a TextBoxSub
34541>>>//     otxtYear is a TextBoxSub
34541>>>//     otxtWorkingDay is a TextBoxSub
34541>>>//     otxtWorkingDay is a TextBoxSub
34541>>>//     chkxr is a CheckBoxSub
34541>>>
34541>>>// Register all objects
34541>>>Register_Object Branch_Branch_Code
34541>>>Register_Object Branch_Branch_Name
34541>>>Register_Object Branch_DD
34541>>>Register_Object Company_Company_Code
34541>>>Register_Object Company_Company_Name
34541>>>Register_Object Company_DD
34541>>>Register_Object chkxr
34541>>>Register_Object oCancel_bn
34541>>>Register_Object oOk_bn
34541>>>Register_Object oSelectYear
34541>>>Register_Object otxtBranch
34541>>>Register_Object otxtCompany
34541>>>Register_Object otxtWorkingDay
34541>>>Register_Object otxtYear
34541>>>Register_Object Year_DD
34541>>>Register_Object Year_Year_Descr
34541>>>Register_Object Year_Year_Entrydate
34541>>>Register_Object Year_Year_Year
34541>>>
34541>>>
34541>>>
34541>>>//AB-StoreTopStart
34541>>>       string  gs_selected_beto_site
34541>>>
34541>>>Open SysCurGL
34543>>>Open Nomisma
34545>>>
34545>>>//AB-StoreTopEnd
34545>>>
34545>>>//AB-IgnoreStart
34545>>>
34545>>>Use DFAllEnt.pkg
34545>>>Use dbForm.Sub
34545>>>Use Button.Sub
34545>>>Use Txtbox.Sub
34545>>>Use Chkbox.Sub
34545>>>
34545>>>
34545>>>Use COMPANY.DD
INCLUDING FILE: COMPANY.DD
34545>>>>>//DDB-FileStart
34545>>>>>//DDB-HeaderStart
34545>>>>>
34545>>>>>// File Name : COMPANY.DD
34545>>>>>// Class Name: Company_DataDictionary
34545>>>>>// Revision  : 58
34545>>>>>// Version   : 2
34545>>>>>
34545>>>>>Use  Windows           // Basic Definitions
34545>>>>>Use  DataDict          // DataDictionary Class Definition
34545>>>>>Use  DDvalTbl          // Validation Table Class Definitions
34545>>>>>
34545>>>>>Open Company
INCLUDING FILE: COMPANY.FD
34547>>>>>Open Branch
34549>>>>>
34549>>>>>//DDB-HeaderEnd
34549>>>>>//DDB-ValidationStart
34549>>>>>
34549>>>>>Register_Object Company_Company_Doy_VT
34549>>>>>Register_Object Company_Company_J_Code_VT
34549>>>>>
34549>>>>>Object Company_Company_Doy_VT  is a CodeValidationTable
34551>>>>>    Set Type_Value        To "DOY"
34552>>>>>    Set Allow_Blank_State To TRUE
34553>>>>>    //DDB-ValidationCustomStart
34553>>>>>    //DDB-ValidationCustomEnd
34553>>>>>End_Object   // Company_Company_Doy_VT
34554>>>>>
34554>>>>>Object Company_Company_J_Code_VT  is a CodeValidationTable
34556>>>>>    Set Type_Value        To "JOB"
34557>>>>>    Set Allow_Blank_State To TRUE
34558>>>>>    //DDB-ValidationCustomStart
34558>>>>>    //DDB-ValidationCustomEnd
34558>>>>>End_Object   // Company_Company_J_Code_VT
34559>>>>>//DDB-ValidationEnd
34559>>>>>//DDB-SelectionStart
34559>>>>>//DDB/ ExternalSelectionList sl001  sl001.sl
34559>>>>>Register_Object sl001
34559>>>>>//DDB-SelectionEnd
34559>>>>> 
34559>>>>>Class Company_DataDictionary  is a DataDictionary
34560>>>>> 
34560>>>>>    // Update:
34560>>>>> 
34560>>>>>    Procedure Update
34561>>>>>        Forward Send Update
34563>>>>>        move 'DOY' to company.doy_type
34564>>>>>        move 'JOB' to company.jcode_type 
34565>>>>>        // Insert Code Here
34565>>>>>    End_Procedure   // Update
34566>>>>> 
34566>>>>>
34566>>>>>    // Operation_Not_Allowed:
34566>>>>>
34566>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
34567>>>>>        // Insert Code Here
34567>>>>>        Case Begin
34567>>>>>             Case (iError_Num = 1001)
34569>>>>>                  Error 1001 "DDC 051:¡«á¢¢¢¦ª à ¡æª « ¨åª!\n\n¤æª à ¡æª"
34570>>>>>>
34570>>>>>             Case Break
34571>>>>>
34571>>>>>             Case Else
34571>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
34573>>>>>        Case End
34573>>>>>    End_Procedure   // Operation_Not_Allowed
34574>>>>>
34574>>>>>
34574>>>>>    // Validate_Save:
34574>>>>>
34574>>>>>    Function Validate_Save  Returns Integer
34575>>>>>        Local Integer iReturnVal
34576>>>>>        Forward Get Validate_Save  To iReturnVal
34578>>>>>        If (Not(iReturnVal)) Begin
34580>>>>>            // Insert Code Here
34580>>>>>            If (Company.Company_Code="") Send Operation_Not_Allowed 1001
34583>>>>>        End
34583>>>>>>
34583>>>>>        Function_Return iReturnVal
34584>>>>>    End_Function   // Validate_Save
34585>>>>>
34585>>>>>
34585>>>>>    // Define_Fields:
34585>>>>>    // This procedure is used to set up all data-dictionary rules.
34585>>>>>
34585>>>>>    Procedure Define_Fields
34586>>>>>        Forward Send Define_Fields
34588>>>>>        //DDB-Generated-Code-Location
34588>>>>>        //DDB-DefineFieldStart
34588>>>>>
34588>>>>>        Set Main_File            To Company.File_Number
34589>>>>>        Set Cascade_Delete_State To FALSE
34590>>>>>
34590>>>>>
34590>>>>>        // Child (Client) file structure................
34590>>>>>        Send Add_Client_File  Branch.File_Number
34591>>>>>
34591>>>>>        // Field-based properties.......................
34591>>>>>
34591>>>>>        // Company.Company_Code
34591>>>>>        Set Field_Options          Field Company.Company_Code To DD_AUTOFIND   
34592>>>>>        Set Field_Prompt_Object    Field Company.Company_Code To (sl001(Self))
34593>>>>>
34593>>>>>        // Company.Company_Name
34593>>>>>        Set Field_Options          Field Company.Company_Name To DD_REQUIRED   
34594>>>>>        Set Field_Prompt_Object    Field Company.Company_Name To (sl001(Self))
34595>>>>>
34595>>>>>        // Company.Company_Afm
34595>>>>>        Set Field_Options          Field Company.Company_Afm To DD_AUTOFIND   
34596>>>>>
34596>>>>>        // Company.Company_Addr
34596>>>>>
34596>>>>>        // Company.Company_Tk
34596>>>>>
34596>>>>>        // Company.Company_Poli
34596>>>>>
34596>>>>>        // Company.Company_Doy
34596>>>>>        Set Field_Value_Table      Field Company.Company_Doy To (Company_Company_Doy_VT(Self))
34597>>>>>
34597>>>>>        // Company.Company_J_Code
34597>>>>>        Set Field_Value_Table      Field Company.Company_J_Code To (Company_Company_J_Code_VT(Self))
34598>>>>>
34598>>>>>        // Company.Company_C_Code0
34598>>>>>
34598>>>>>        // Company.Company_C_Cod00
34598>>>>>
34598>>>>>        // Company.Company_C_Coder
34598>>>>>
34598>>>>>        // Company.Company_Tel
34598>>>>>
34598>>>>>        // Company.Company_Fax
34598>>>>>
34598>>>>>        // Company.Company_Email
34598>>>>>
34598>>>>>        // Company.Company_Resp
34598>>>>>
34598>>>>>        // Company.Company_Bitmap
34598>>>>>
34598>>>>>        // Company.Beto_Site
34598>>>>>
34598>>>>>        // Company.Logo
34598>>>>>
34598>>>>>        // Company.Doy_Type
34598>>>>>
34598>>>>>        // Company.Jcode_Type
34598>>>>>
34598>>>>>        //DDB-DefineFieldEnd
34598>>>>>    End_Procedure    // Define_Fields
34599>>>>>
34599>>>>>    // Field_Defaults:
34599>>>>>    // This procedure is used to establish default field values.
34599>>>>>
34599>>>>>    Procedure Field_Defaults
34600>>>>>        Forward Send Field_Defaults
34602>>>>>        //DDB-Generated-Code-Location
34602>>>>>        //DDB-FieldDefaultStart
34602>>>>>        //DDB-FieldDefaultEnd
34602>>>>>    End_Procedure    // Field_Defaults
34603>>>>>End_Class    // Company_DataDictionary
34604>>>>>
34604>>>>>//DDB-Selection-pkg-Start
34604>>>>>
34604>>>>>Use sl001.sl         // sl001
INCLUDING FILE: SL001.SL
34604>>>>>>>//AB/ Project sl001 : Etairies
34604>>>>>>>//AB/     Object prj is a Lookup_Project
34604>>>>>>>//AB/         Set ProjectName to "sl001 : Etairies"
34604>>>>>>>//AB/         Set ProjectFileName to "sl001.SL"
34604>>>>>>>//AB/         Set GenerateFileName to "NONAME"
34604>>>>>>>
34604>>>>>>>// Project Object Structure
34604>>>>>>>//   sl001 is a dbModalPanel
34604>>>>>>>//     Company_DD is a DataDictionary
34604>>>>>>>//     oSelList is a dbList
34604>>>>>>>//     oOK_bn is a ButtonSub
34604>>>>>>>//     oCancel_bn is a ButtonSub
34604>>>>>>>//     oSearch_bn is a ButtonSub
34604>>>>>>>
34604>>>>>>>// Register all objects
34604>>>>>>>Register_Object Company_DD
34604>>>>>>>Register_Object oCancel_bn
34604>>>>>>>Register_Object oOK_bn
34604>>>>>>>Register_Object oSearch_bn
34604>>>>>>>Register_Object oSelList
34604>>>>>>>Register_Object sl001
34604>>>>>>>
34604>>>>>>>
34604>>>>>>>    //AB-IgnoreStart
34604>>>>>>>
34604>>>>>>>    Use DFAllEnt.pkg
34604>>>>>>>    Use Button.Sub
34604>>>>>>>
34604>>>>>>>
34604>>>>>>>    Use COMPANY.DD
34604>>>>>>>    
34604>>>>>>>    //AB-IgnoreEnd
34604>>>>>>>
34604>>>>>>>    CD_Popup_Object sl001 is a dbModalPanel
34623>>>>>>>        Set Label to "« ¨åª"
34624>>>>>>>        Set Size to 148 297
34625>>>>>>>        Set Location to 12 27
34626>>>>>>>
34626>>>>>>>        //AB-DDOStart
34626>>>>>>>
34626>>>>>>>        Object Company_DD is a Company_DataDictionary
34628>>>>>>>        End_Object    // Company_DD
34629>>>>>>>
34629>>>>>>>        Set Main_DD to (Company_DD(self))
34630>>>>>>>        Set Server to (Company_DD(self))
34631>>>>>>>
34631>>>>>>>        //AB-DDOEnd
34631>>>>>>>
34631>>>>>>>        Object oSelList is a dbList
34633>>>>>>>            Set Main_File to Company.File_Number
34634>>>>>>>            Set Size to 105 280
34635>>>>>>>            Set Location to 6 6
34636>>>>>>>
34636>>>>>>>            Begin_Row
34639>>>>>>>                Entry_Item Company.Company_code
34640>>>>>>>                Entry_Item Company.Company_name
34641>>>>>>>                Entry_Item Company.Company_afm
34642>>>>>>>            End_Row
34647>>>>>>>
34647>>>>>>>            Set Form_Width    item 0 to 42
34648>>>>>>>            Set Header_Label  item 0 to "à ¡æª"
34649>>>>>>>            
34649>>>>>>>            Set Form_Width    item 1 to 150
34650>>>>>>>            Set Header_Label  item 1 to "§à¤¬£å"
34651>>>>>>>            
34651>>>>>>>            Set Form_Width    item 2 to 80
34652>>>>>>>            Set Header_Label  item 2 to ".."
34653>>>>>>>            
34653>>>>>>>        End_Object    // oSelList
34654>>>>>>>
34654>>>>>>>        Object oOK_bn is a ButtonSub
34656>>>>>>>            Set Label to "&§ ¢¦ã"
34657>>>>>>>            Set Location to 115 126
34658>>>>>>>
34658>>>>>>>            //AB-StoreStart
34658>>>>>>>            Procedure OnClick
34660>>>>>>>                Send OK To (oSelList(current_object))
34661>>>>>>>            End_Procedure
34662>>>>>>>            //AB-StoreEnd
34662>>>>>>>
34662>>>>>>>        End_Object    // oOK_bn
34663>>>>>>>
34663>>>>>>>        Object oCancel_bn is a ButtonSub
34665>>>>>>>            Set Label to "&¡ç¨à©"
34666>>>>>>>            Set Location to 115 181
34667>>>>>>>
34667>>>>>>>            //AB-StoreStart
34667>>>>>>>            Procedure OnClick
34669>>>>>>>                Send Cancel To (oSelList(current_object))
34670>>>>>>>            End_Procedure
34671>>>>>>>            //AB-StoreEnd
34671>>>>>>>
34671>>>>>>>        End_Object    // oCancel_bn
34672>>>>>>>
34672>>>>>>>        Object oSearch_bn is a ButtonSub
34674>>>>>>>            Set Label to "&¤ã«©"
34675>>>>>>>            Set Location to 115 236
34676>>>>>>>
34676>>>>>>>            //AB-StoreStart
34676>>>>>>>            Procedure OnClick
34678>>>>>>>                Send Search To (oSelList(current_object))
34679>>>>>>>            End_Procedure
34680>>>>>>>            //AB-StoreEnd
34680>>>>>>>
34680>>>>>>>        End_Object    // oSearch_bn
34681>>>>>>>
34681>>>>>>>
34681>>>>>>>        //AB-StoreStart
34681>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To oOk_bn
34682>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To oCancel_bn
34683>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To oSearch_bn
34684>>>>>>>        //AB-StoreEnd
34684>>>>>>>
34684>>>>>>>    CD_End_Object    // sl001
34686>>>>>>>>
34686>>>>>>>
34686>>>>>>>//AB/     End_Object    // prj
34686>>>>>
34686>>>>>//DDB-Selection-pkg-End
34686>>>>>//DDB-FileEnd
34686>>>Use BRANCH.DD
INCLUDING FILE: BRANCH.DD
34686>>>>>//DDB-FileStart
34686>>>>>//DDB-HeaderStart
34686>>>>>
34686>>>>>// File Name : BRANCH.DD
34686>>>>>// Class Name: Branch_DataDictionary
34686>>>>>// Revision  : 52
34686>>>>>// Version   : 2
34686>>>>>
34686>>>>>Use  Windows           // Basic Definitions
34686>>>>>Use  DataDict          // DataDictionary Class Definition
34686>>>>>Use  DDvalTbl          // Validation Table Class Definitions
34686>>>>>
34686>>>>>Open Branch
34688>>>>>Open Year
34690>>>>>Open Brzones
INCLUDING FILE: BRZONES.FD
34692>>>>>Open Tpbranch
INCLUDING FILE: TPBRANCH.FD
34694>>>>>Open Company
34696>>>>>Open Sysrecg
INCLUDING FILE: SYSRECG.FD
34698>>>>>
34698>>>>>//DDB-HeaderEnd
34698>>>>>//DDB-ValidationStart
34698>>>>>
34698>>>>>Register_Object Branch_Branch_Doy_VT
34698>>>>>Register_Object Branch_Branch_J_Code_VT
34698>>>>>Register_Object Branch_Branch_C_Code0_VT
34698>>>>>
34698>>>>>Object Branch_Branch_Doy_VT  is a CodeValidationTable
34700>>>>>    Set Type_Value        To "DOY"
34701>>>>>    Set Allow_Blank_State To TRUE
34702>>>>>    //DDB-ValidationCustomStart
34702>>>>>    //DDB-ValidationCustomEnd
34702>>>>>End_Object   // Branch_Branch_Doy_VT
34703>>>>>
34703>>>>>Object Branch_Branch_J_Code_VT  is a CodeValidationTable
34705>>>>>    Set Type_Value        To "JOB"
34706>>>>>    Set Allow_Blank_State To TRUE
34707>>>>>    //DDB-ValidationCustomStart
34707>>>>>    //DDB-ValidationCustomEnd
34707>>>>>End_Object   // Branch_Branch_J_Code_VT
34708>>>>>
34708>>>>>Object Branch_Branch_C_Code0_VT  is a CodeValidationTable
34710>>>>>    Set Type_Value        To ""
34711>>>>>    Set Allow_Blank_State To TRUE
34712>>>>>    //DDB-ValidationCustomStart
34712>>>>>    //DDB-ValidationCustomEnd
34712>>>>>End_Object   // Branch_Branch_C_Code0_VT
34713>>>>>//DDB-ValidationEnd
34713>>>>>//DDB-SelectionStart
34713>>>>>//DDB/ ExternalSelectionList SL002  Sl002.sl
34713>>>>>Register_Object SL002
34713>>>>>//DDB-SelectionEnd
34713>>>>>
34713>>>>>Class Branch_DataDictionary  is a DataDictionary
34714>>>>> 
34714>>>>>    // Save_Main_File:
34714>>>>> 
34714>>>>>    Procedure Save_Main_File
34715>>>>>        Forward Send Save_Main_File
34717>>>>>        // Insert Code Here
34717>>>>>    End_Procedure   // Save_Main_File
34718>>>>> 
34718>>>>> 
34718>>>>>    // Creating:
34718>>>>> 
34718>>>>>    Procedure Creating
34719>>>>>        Forward Send Creating
34721>>>>>        // Insert Code Here
34721>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Branch.Branch_Rec0)))))) to Branch.Branch_Recr
34722>>>>>    End_Procedure   // Creating
34723>>>>> 
34723>>>>>
34723>>>>>    // Operation_Not_Allowed:
34723>>>>>
34723>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
34724>>>>>        // Insert Code Here
34724>>>>>        Case Begin
34724>>>>>             Case (iError_Num = 1001)
34726>>>>>                  Error 1001 "DDC 052:¡«á¢¢¢¦ª à ¡æª §¦¡«©«ã£«¦ª!\n\n¤æª à ¡æª"
34727>>>>>>
34727>>>>>             Case Break
34728>>>>>
34728>>>>>             Case Else
34728>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
34730>>>>>        Case End
34730>>>>>    End_Procedure   // Operation_Not_Allowed
34731>>>>>
34731>>>>>
34731>>>>>    // Validate_Save:
34731>>>>>
34731>>>>>    Function Validate_Save  Returns Integer
34732>>>>>        Local Integer iReturnVal
34733>>>>>        Forward Get Validate_Save  To iReturnVal
34735>>>>>        If (Not(iReturnVal)) Begin
34737>>>>>            // Insert Code Here
34737>>>>>            If (Branch.Branch_Code="") Send Operation_Not_Allowed 1001
34740>>>>>        End
34740>>>>>>
34740>>>>>        Function_Return iReturnVal
34741>>>>>    End_Function   // Validate_Save
34742>>>>>
34742>>>>>
34742>>>>>    // Define_Fields:
34742>>>>>    // This procedure is used to set up all data-dictionary rules.
34742>>>>>
34742>>>>>    Procedure Define_Fields
34743>>>>>        Forward Send Define_Fields
34745>>>>>        //DDB-Generated-Code-Location
34745>>>>>        //DDB-DefineFieldStart
34745>>>>>
34745>>>>>        Set Main_File            To Branch.File_Number
34746>>>>>        Set Cascade_Delete_State To FALSE
34747>>>>>
34747>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
34748>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOENTER     DD_FINDREQ    
34749>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
34750>>>>>
34750>>>>>        // Child (Client) file structure................
34750>>>>>        Send Add_Client_File  Year.File_Number
34751>>>>>        Send Add_Client_File  Brzones.File_Number
34752>>>>>        Send Add_Client_File  Tpbranch.File_Number
34753>>>>>
34753>>>>>        // Parent (Server) file structure...............
34753>>>>>        Send Add_Server_File  Company.File_Number
34754>>>>>
34754>>>>>        // External (System) file structure.............
34754>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
34755>>>>>
34755>>>>>        Define_Auto_Increment  Sysrecg.Branch_Rec0  To Branch.Branch_Rec0
34758>>>>>
34758>>>>>        // Field-based properties.......................
34758>>>>>
34758>>>>>        // Branch.Company_Code
34758>>>>>
34758>>>>>        // Branch.Branch_Code
34758>>>>>        Set Field_Options          Field Branch.Branch_Code To DD_AUTOFIND   
34759>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Code To (SL002(Self))
34760>>>>>        Set Key_Field_State        Field Branch.Branch_Code To TRUE
34761>>>>>
34761>>>>>        // Branch.Branch_Rec0
34761>>>>>
34761>>>>>        // Branch.Branch_Recr
34761>>>>>
34761>>>>>        // Branch.Branch_Name
34761>>>>>        Set Field_Options          Field Branch.Branch_Name To DD_REQUIRED   
34762>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Name To (SL002(Self))
34763>>>>>
34763>>>>>        // Branch.Branch_Afm
34763>>>>>
34763>>>>>        // Branch.Branch_Addr
34763>>>>>
34763>>>>>        // Branch.Branch_Tk
34763>>>>>
34763>>>>>        // Branch.Branch_Poli
34763>>>>>
34763>>>>>        // Branch.Branch_Doy
34763>>>>>        Set Field_Value_Table      Field Branch.Branch_Doy To (Branch_Branch_Doy_VT(Self))
34764>>>>>
34764>>>>>        // Branch.Branch_J_Code
34764>>>>>        Set Field_Value_Table      Field Branch.Branch_J_Code To (Branch_Branch_J_Code_VT(Self))
34765>>>>>
34765>>>>>        // Branch.Branch_C_Code0
34765>>>>>        Set Field_Value_Table      Field Branch.Branch_C_Code0 To (Branch_Branch_C_Code0_VT(Self))
34766>>>>>
34766>>>>>        // Branch.Branch_C_Code00
34766>>>>>
34766>>>>>        // Branch.Branch_C_Coder
34766>>>>>
34766>>>>>        // Branch.Branch_Tel
34766>>>>>
34766>>>>>        // Branch.Branch_Fax
34766>>>>>
34766>>>>>        // Branch.Branch_Email
34766>>>>>
34766>>>>>        // Branch.Branch_Resp
34766>>>>>
34766>>>>>        // Branch.Branch_Bitmap
34766>>>>>
34766>>>>>        // Branch.Branch_Site
34766>>>>>
34766>>>>>        // Branch.Branch_Apoth
34766>>>>>
34766>>>>>        // Branch.Beto_Site
34766>>>>>
34766>>>>>        //DDB-DefineFieldEnd
34766>>>>>    End_Procedure    // Define_Fields
34767>>>>>
34767>>>>>    // Field_Defaults:
34767>>>>>    // This procedure is used to establish default field values.
34767>>>>>
34767>>>>>    Procedure Field_Defaults
34768>>>>>        Forward Send Field_Defaults
34770>>>>>        //DDB-Generated-Code-Location
34770>>>>>        //DDB-FieldDefaultStart
34770>>>>>        //DDB-FieldDefaultEnd
34770>>>>>    End_Procedure    // Field_Defaults
34771>>>>>End_Class    // Branch_DataDictionary
34772>>>>>
34772>>>>>//DDB-Selection-pkg-Start
34772>>>>>
34772>>>>>Use Sl002.sl         // SL002
INCLUDING FILE: SL002.SL
34772>>>>>>>//AB/ Project SL002:Branch
34772>>>>>>>//AB/ Object prj is a Lookup_Project
34772>>>>>>>//AB/     Set ProjectName to "SL002:Branch"
34772>>>>>>>//AB/     Set ProjectFileName to "Sl002.sl"
34772>>>>>>>
34772>>>>>>>// Project Object Structure
34772>>>>>>>//   SL002 is a dbModalPanelSub
34772>>>>>>>//     Company_DD is a DataDictionary
34772>>>>>>>//     Branch_DD is a DataDictionary
34772>>>>>>>//     oSelList is a dbListSub
34772>>>>>>>//     oOK_bn is a ButtonSub
34772>>>>>>>//     oCancel_bn is a ButtonSub
34772>>>>>>>//     oSearch_bn is a ButtonSub
34772>>>>>>>
34772>>>>>>>// Register all objects
34772>>>>>>>Register_Object Branch_DD
34772>>>>>>>Register_Object Company_DD
34772>>>>>>>Register_Object oCancel_bn
34772>>>>>>>Register_Object oOK_bn
34772>>>>>>>Register_Object oSearch_bn
34772>>>>>>>Register_Object oSelList
34772>>>>>>>Register_Object SL002
34772>>>>>>>
34772>>>>>>>
34772>>>>>>>//AB-IgnoreStart
34772>>>>>>>
34772>>>>>>>Use DFAllEnt.pkg
34772>>>>>>>Use dbList.Sub
34772>>>>>>>Use Button.Sub
34772>>>>>>>
34772>>>>>>>
34772>>>>>>>Use COMPANY.DD
34772>>>>>>>Use BRANCH.DD
34772>>>>>>>
34772>>>>>>>//AB-IgnoreEnd
34772>>>>>>>
34772>>>>>>>Object SL002 is a dbModalPanelSub
34774>>>>>>>
34774>>>>>>>    //AB-StoreTopStart
34774>>>>>>>    Property String psFragmaCompanyCode  ""
34776>>>>>>>    
34776>>>>>>>    //AB-StoreTopEnd
34776>>>>>>>
34776>>>>>>>    Set Minimize_Icon to FALSE
34777>>>>>>>    Set Label to "§¦¡«©«ã£«"
34778>>>>>>>    Set Size to 146 430
34779>>>>>>>    Set Location to 4 5
34780>>>>>>>    Set Exit_Application_Local_State to FALSE
34781>>>>>>>    Set Modal_State to FALSE
34782>>>>>>>
34782>>>>>>>    //AB-DDOStart
34782>>>>>>>
34782>>>>>>>    Object Company_DD is a Company_DataDictionary
34784>>>>>>>    End_Object    // Company_DD
34785>>>>>>>
34785>>>>>>>    Object Branch_DD is a Branch_DataDictionary
34787>>>>>>>        Set DDO_Server to (Company_DD(self))
34788>>>>>>>
34788>>>>>>>        //AB-StoreStart
34788>>>>>>>        Procedure OnConstrain
34790>>>>>>>             String lsCompanyCode
34791>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
34792>>>>>>>             If (lsCompanyCode <> "") Constrain Branch.Company_code eq lsCompanyCode
34796>>>>>>>        End_Procedure // OnConstrain
34797>>>>>>>        
34797>>>>>>>        
34797>>>>>>>        
34797>>>>>>>        //AB-StoreEnd
34797>>>>>>>
34797>>>>>>>    End_Object    // Branch_DD
34798>>>>>>>
34798>>>>>>>    Set Main_DD to (Branch_DD(self))
34799>>>>>>>    Set Server to (Branch_DD(self))
34800>>>>>>>
34800>>>>>>>    //AB-DDOEnd
34800>>>>>>>
34800>>>>>>>    Object oSelList is a dbListSub
34802>>>>>>>        Set Main_File to Branch.File_Number
34803>>>>>>>        Set Size to 105 415
34804>>>>>>>        Set Location to 6 6
34805>>>>>>>
34805>>>>>>>        Begin_Row
34808>>>>>>>            Entry_Item Branch.Branch_code
34809>>>>>>>            Entry_Item Branch.Branch_name
34810>>>>>>>            Entry_Item Company.Company_code
34811>>>>>>>            Entry_Item Company.Company_name
34812>>>>>>>            Entry_Item Branch.Beto_site
34813>>>>>>>            Entry_Item Branch.Branch_recr
34814>>>>>>>        End_Row
34819>>>>>>>
34819>>>>>>>        Set Form_Width    item 0 to 60
34820>>>>>>>        Set Header_Label  item 0 to "à ¡æª"
34821>>>>>>>        
34821>>>>>>>        Set Form_Width    item 1 to 128
34822>>>>>>>        Set Header_Label  item 1 to "¤¦£"
34823>>>>>>>        
34823>>>>>>>        Set Form_Width    item 2 to 69
34824>>>>>>>        Set Header_Label  item 2 to "à ¡æª « ¨åª"
34825>>>>>>>        
34825>>>>>>>        Set Form_Width    item 3 to 109
34826>>>>>>>        Set Header_Label  item 3 to "¤¦£ « ¨åª"
34827>>>>>>>        
34827>>>>>>>        Set Form_Width    item 4 to 42
34828>>>>>>>        Set Header_Label  item 4 to "Site"
34829>>>>>>>        
34829>>>>>>>        Set Form_Width    item 5 to 0
34830>>>>>>>        Set Header_Label  item 5 to ""
34831>>>>>>>        
34831>>>>>>>
34831>>>>>>>        //AB-StoreStart
34831>>>>>>>        
34831>>>>>>>        Property String psStoreFragmaCompanyCode  ""
34833>>>>>>>        
34833>>>>>>>        Procedure Store_Defaults
34835>>>>>>>            forward send Store_Defaults
34837>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
34838>>>>>>>        end_Procedure // Store_Defaults
34839>>>>>>>        
34839>>>>>>>        Procedure Restore_Defaults
34841>>>>>>>            forward send Restore_Defaults
34843>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
34844>>>>>>>        end_Procedure // Restore_Defaults
34845>>>>>>>        
34845>>>>>>>        Procedure Activating
34847>>>>>>>            Forward Send Activating
34849>>>>>>>            Send Rebuild_Constraints to (Branch_DD(self))
34850>>>>>>>        End_Procedure // Activating
34851>>>>>>>        
34851>>>>>>>        Set Column_Options Item 5 to NoEnter True
34852>>>>>>>        
34852>>>>>>>        
34852>>>>>>>        //AB-StoreEnd
34852>>>>>>>
34852>>>>>>>    End_Object    // oSelList
34853>>>>>>>
34853>>>>>>>    Object oOK_bn is a ButtonSub
34855>>>>>>>        Set Label to "&§ ¢¦ã"
34856>>>>>>>        Set Location to 112 262
34857>>>>>>>
34857>>>>>>>        //AB-StoreStart
34857>>>>>>>        Procedure OnClick
34859>>>>>>>            Send OK To (oSelList(current_object))
34860>>>>>>>        End_Procedure
34861>>>>>>>        //AB-StoreEnd
34861>>>>>>>
34861>>>>>>>    End_Object    // oOK_bn
34862>>>>>>>
34862>>>>>>>    Object oCancel_bn is a ButtonSub
34864>>>>>>>        Set Label to "&¡ç¨à©"
34865>>>>>>>        Set Location to 112 317
34866>>>>>>>
34866>>>>>>>        //AB-StoreStart
34866>>>>>>>        Procedure OnClick
34868>>>>>>>            Send Cancel To (oSelList(current_object))
34869>>>>>>>        End_Procedure
34870>>>>>>>        //AB-StoreEnd
34870>>>>>>>
34870>>>>>>>    End_Object    // oCancel_bn
34871>>>>>>>
34871>>>>>>>    Object oSearch_bn is a ButtonSub
34873>>>>>>>        Set Label to "&¤ã«©"
34874>>>>>>>        Set Location to 112 372
34875>>>>>>>
34875>>>>>>>        //AB-StoreStart
34875>>>>>>>        Procedure OnClick
34877>>>>>>>            Send Search To (oSelList(current_object))
34878>>>>>>>        End_Procedure
34879>>>>>>>        //AB-StoreEnd
34879>>>>>>>
34879>>>>>>>    End_Object    // oSearch_bn
34880>>>>>>>
34880>>>>>>>
34880>>>>>>>    //AB-StoreStart
34880>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
34881>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
34882>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
34883>>>>>>>    
34883>>>>>>>    
34883>>>>>>>    //AB-StoreEnd
34883>>>>>>>
34883>>>>>>>End_Object    // SL002
34884>>>>>>>
34884>>>>>>>//AB/ End_Object    // prj
34884>>>>>
34884>>>>>//DDB-Selection-pkg-End
34884>>>>>//DDB-FileEnd
34884>>>Use YEAR.DD
INCLUDING FILE: YEAR.DD
34884>>>>>//DDB-FileStart
34884>>>>>//DDB-HeaderStart
34884>>>>>
34884>>>>>// File Name : YEAR.DD
34884>>>>>// Class Name: Year_DataDictionary
34884>>>>>// Revision  : 115
34884>>>>>// Version   : 2
34884>>>>>
34884>>>>>Use  Windows           // Basic Definitions
34884>>>>>Use  DataDict          // DataDictionary Class Definition
34884>>>>>Use  DDvalTbl          // Validation Table Class Definitions
34884>>>>>
34884>>>>>Open Year
34886>>>>>Open Branch
34888>>>>>Open Syscurxr
34890>>>>>
34890>>>>>//DDB-HeaderEnd
34890>>>>>//DDB-ValidationStart
34890>>>>>
34890>>>>>Register_Object Year_Year_C_Code0_VT1
34890>>>>>Register_Object Year_Year_C_Code00_VT1
34890>>>>>Register_Object Year_Year_C_Coder_VT1
34890>>>>>
34890>>>>>Object Year_Year_C_Code0_VT1  is a CodeValidationTable
34892>>>>>    Set Type_Value        To "CURRENCY"
34893>>>>>    //DDB-ValidationCustomStart
34893>>>>>    //DDB-ValidationCustomEnd
34893>>>>>End_Object   // Year_Year_C_Code0_VT1
34894>>>>>
34894>>>>>Object Year_Year_C_Code00_VT1  is a CodeValidationTable
34896>>>>>    Set Type_Value        To "CURRENCY"
34897>>>>>    //DDB-ValidationCustomStart
34897>>>>>    //DDB-ValidationCustomEnd
34897>>>>>End_Object   // Year_Year_C_Code00_VT1
34898>>>>>
34898>>>>>Object Year_Year_C_Coder_VT1  is a CodeValidationTable
34900>>>>>    Set Type_Value        To "CURRENCY"
34901>>>>>    //DDB-ValidationCustomStart
34901>>>>>    //DDB-ValidationCustomEnd
34901>>>>>End_Object   // Year_Year_C_Coder_VT1
34902>>>>>//DDB-ValidationEnd
34902>>>>>//DDB-SelectionStart
34902>>>>>//DDB/ ExternalSelectionList SL003  Sl003.sl
34902>>>>>Register_Object SL003
34902>>>>>//DDB-SelectionEnd
34902>>>>>            
34902>>>>>Class Year_DataDictionary  is a DataDictionary
34903>>>>>    
34903>>>>>    Procedure Creating
34904>>>>>        Forward Send Creating
34906>>>>>        // Insert Code Here
34906>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Year.Year_Year)))))) to Year.Year_Recr
34907>>>>>    End_Procedure   // Creating
34908>>>>>
34908>>>>>
34908>>>>>    // Operation_Not_Allowed:
34908>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
34909>>>>>        // Insert Code Here
34909>>>>>        Case Begin    
34909>>>>>             Case (iError_Num = 1001)
34911>>>>>                  Error 1001 "DDC 053:¡«á¢¢¢¦ª à ¡æª §¦¡«©«ã£«¦ª!\n\n¤æª à ¡æª"
34912>>>>>>
34912>>>>>             Case Break
34913>>>>>             Case (iError_Num=1002)
34916>>>>>                Error 1002 "DDC 053:Branch Site ¡«å¤  ©«¦ Year ¡¤æ"
34917>>>>>>
34917>>>>>             Case Break
34918>>>>>             Case (iError_Num=1003)
34921>>>>>                Error 1003 "DDC 053:Company Code=0"
34922>>>>>>
34922>>>>>             Case Break
34923>>>>>             Case (iError_Num=1004)
34926>>>>>                Error 1004 "DDC 053:Branch Code=0"
34927>>>>>>
34927>>>>>             Case Break
34928>>>>>             Case Else
34928>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
34930>>>>>        Case End
34930>>>>>    End_Procedure   // Operation_Not_Allowed
34931>>>>>
34931>>>>>
34931>>>>>    // Update:
34931>>>>>    // Use this message to effect changes in related-to files. The
34931>>>>>    // Backout message should be designed to reverse the effects of this
34931>>>>>    // message. It is invoked while the database is locked.
34931>>>>>
34931>>>>>    Procedure Update
34932>>>>>        Forward Send Update
34934>>>>>        // Insert Code Here
34934>>>>>        Move Company.Company_Code   to Year.Company_Code
34935>>>>>        Move Branch.Branch_Code     to Year.Branch_Code
34936>>>>>        move branch.beto_site       to year.beto_site
34937>>>>>
34937>>>>>        //sos:parametrika apo sysfile?
34937>>>>>       
34937>>>>>       // If ((Year.Year_EntryDate-14) < Year.Year_XrhshFrom) Begin
34937>>>>>       //     Move Year.Year_XrhshFrom to Year.Year_OpenFrom
34937>>>>>       // End
34937>>>>>       // Else Begin
34937>>>>>       //     Move (Year.Year_EntryDate-14) to Year.Year_OpenFrom
34937>>>>>       // End
34937>>>>>      //  Move Year.Year_EntryDate      to Year.Year_OpenTo
34937>>>>>    End_Procedure   // Update
34938>>>>>
34938>>>>>    // Validate_Save:
34938>>>>>
34938>>>>>    Function Validate_Save  Returns Integer
34939>>>>>        Local Integer iReturnVal
34940>>>>>        Forward Get Validate_Save  To iReturnVal
34942>>>>>        If (Not(iReturnVal)) Begin
34944>>>>>                 If (Year.Year_Year   = 0) Send Operation_Not_Allowed 1001
34947>>>>>            Else If (Year.Company_Code='') Send Operation_Not_Allowed 1003
34951>>>>>            Else If (Year.Branch_Code ='') Send Operation_Not_Allowed 1004
34955>>>>>        End
34955>>>>>>
34955>>>>>        Function_Return iReturnVal
34956>>>>>    End_Function   // Validate_Save
34957>>>>>
34957>>>>>
34957>>>>>    // Define_Fields:
34957>>>>>    // This procedure is used to set up all data-dictionary rules.
34957>>>>>
34957>>>>>    Procedure Define_Fields
34958>>>>>        Forward Send Define_Fields
34960>>>>>        //DDB-Generated-Code-Location
34960>>>>>        //DDB-DefineFieldStart
34960>>>>>
34960>>>>>        Set Main_File            To Year.File_Number
34961>>>>>        Set Cascade_Delete_State To FALSE
34962>>>>>
34962>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
34963>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
34964>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
34965>>>>>
34965>>>>>        // Parent (Server) file structure...............
34965>>>>>        Send Add_Server_File  Branch.File_Number
34966>>>>>
34966>>>>>        // External (System) file structure.............
34966>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
34967>>>>>
34967>>>>>        // Field-based properties.......................
34967>>>>>
34967>>>>>        // Year.Company_Code
34967>>>>>
34967>>>>>        // Year.Branch_Code
34967>>>>>
34967>>>>>        // Year.Year_Year
34967>>>>>        Set Field_Options          Field Year.Year_Year To DD_AUTOFIND    DD_REQUIRED   
34968>>>>>        Set Field_Prompt_Object    Field Year.Year_Year To (SL003(Self))
34969>>>>>        Set Key_Field_State        Field Year.Year_Year To TRUE
34970>>>>>
34970>>>>>        // Year.Year_Recr
34970>>>>>
34970>>>>>        // Year.Branch_Recr
34970>>>>>
34970>>>>>        // Year.Year_Descr
34970>>>>>
34970>>>>>        // Year.Year_Isolfrom
34970>>>>>
34970>>>>>        // Year.Year_Isolto
34970>>>>>
34970>>>>>        // Year.Year_Openfrom
34970>>>>>
34970>>>>>        // Year.Year_Opento
34970>>>>>
34970>>>>>        // Year.Year_Entrydate
34970>>>>>
34970>>>>>        // Year.Year_Dateaa
34970>>>>>
34970>>>>>        // Year.Year_Xrhshfrom
34970>>>>>
34970>>>>>        // Year.Year_Xrhshto
34970>>>>>
34970>>>>>        // Year.Year_Myflimit
34970>>>>>
34970>>>>>        // Year.Year_Numgtypkin
34970>>>>>
34970>>>>>        // Year.Year_Numgarticl
34970>>>>>
34970>>>>>        // Year.Year_Numgmove
34970>>>>>
34970>>>>>        // Year.Year_Numgplan
34970>>>>>
34970>>>>>        // Year.Year_Numgformat
34970>>>>>
34970>>>>>        // Year.Year_Numgthaa
34970>>>>>
34970>>>>>        // Year.Year_Numgopen
34970>>>>>
34970>>>>>        // Year.Year_Numbtypkin
34970>>>>>
34970>>>>>        // Year.Year_Numbaxio
34970>>>>>
34970>>>>>        // Year.Year_Numbarticl
34970>>>>>
34970>>>>>        // Year.Year_Numbmove
34970>>>>>
34970>>>>>        // Year.Year_Delimiter
34970>>>>>
34970>>>>>        // Year.Year_Printer
34970>>>>>
34970>>>>>        // Year.Year_Valid_Char
34970>>>>>
34970>>>>>        // Year.Year_C_Code0
34970>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0 To "dbComboFormSub"
34971>>>>>        Set Field_Value_Table      Field Year.Year_C_Code0 To (Year_Year_C_Code0_VT1(Self))
34972>>>>>
34972>>>>>        // Year.Year_C_Code00
34972>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00 To "dbComboFormSub"
34973>>>>>        Set Field_Value_Table      Field Year.Year_C_Code00 To (Year_Year_C_Code00_VT1(Self))
34974>>>>>
34974>>>>>        // Year.Year_C_Coder
34974>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder To "dbComboFormSub"
34975>>>>>        Set Field_Value_Table      Field Year.Year_C_Coder To (Year_Year_C_Coder_VT1(Self))
34976>>>>>
34976>>>>>        // Year.Beto_Site
34976>>>>>
34976>>>>>        // Year.Clients_Plafon
34976>>>>>
34976>>>>>        // Year.Payresp_Plafon
34976>>>>>
34976>>>>>        // Year.Clients_Ofeilh
34976>>>>>
34976>>>>>        // Year.Payresp_Ofeilh
34976>>>>>
34976>>>>>        //DDB-DefineFieldEnd
34976>>>>>
34976>>>>>        Set Main_File            To Year.File_Number
34977>>>>>        Set Cascade_Delete_State To FALSE
34978>>>>>
34978>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
34979>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
34980>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
34981>>>>>
34981>>>>>        // Child (Client) file structure................
34981>>>>>
34981>>>>>        // Parent (Server) file structure...............
34981>>>>>        Send Add_Server_File  Branch.File_Number
34982>>>>>
34982>>>>>        // Field-based properties.......................
34982>>>>>
34982>>>>>        // Year.Company_Code
34982>>>>>
34982>>>>>        // Year.Branch_Code
34982>>>>>
34982>>>>>        // Year.Year_Year
34982>>>>>        Set Field_Label_Long       Field Year.Year_Year           To "¨ã©"
34983>>>>>        Set Field_Label_Short      Field Year.Year_Year           To "¨ã©"
34984>>>>>        Set Field_Options          Field Year.Year_Year           To DD_REQUIRED
34985>>>>>        //Set Field_Prompt_Object    Field Year.Year_Year           To (SL053(Self))
34985>>>>>
34985>>>>>        // Year.Year_Descr
34985>>>>>        Set Field_Label_Long       Field Year.Year_Descr          To "¨ ¨­ã ¨ã©ª"
34986>>>>>        Set Field_Label_Short      Field Year.Year_Descr          To "¨.¨ã©ª"
34987>>>>>
34987>>>>>        // Year.Year_C_Code0
34987>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0        To "dbComboForm"
34988>>>>>        Set Field_Label_Long       Field Year.Year_C_Code0        To "ç¨ ¦ æ£ ©£"
34989>>>>>        Set Field_Label_Short      Field Year.Year_C_Code0        To "¬¨.¦£ ©£"
34990>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code0        To (Year_Year_C_Code0_VT(Self))
34990>>>>>
34990>>>>>        // Year.Year_C_Code00
34990>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00       To "dbComboForm"
34991>>>>>        Set Field_Label_Long       Field Year.Year_C_Code00       To "¬«¨ç¦¤ æ£ ©£"
34992>>>>>        Set Field_Label_Short      Field Year.Year_C_Code00       To "¬«¨ç¦¤ æ£ ©£"
34993>>>>>        //Set Field_Options          Field Year.Year_C_Code00       To DD_REQUIRED
34993>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code00       To (Year_Year_C_Code1_VT(Self))
34993>>>>>
34993>>>>>        // Year.Year_C_Coder
34993>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder        To "dbComboForm"
34994>>>>>        Set Field_Label_Long       Field Year.Year_C_Coder        To "æ£ ©£ REPORTING"
34995>>>>>        Set Field_Label_Short      Field Year.Year_C_Coder        To "æ£ ©£ REP"
34996>>>>>        //Set Field_Options          Field Year.Year_C_Coder        To DD_REQUIRED
34996>>>>>        //Set Field_Value_Table      Field Year.Year_C_Coder        To (Year_Year_C_Coder_VT(Self))
34996>>>>>
34996>>>>>        // Year.Year_Isolfrom
34996>>>>>        Set Field_Label_Long       Field Year.Year_Isolfrom       To "©¦¢¦ ©£æª §æ"
34997>>>>>        Set Field_Label_Short      Field Year.Year_Isolfrom       To "©¦¢¦ ©£æª §æ"
34998>>>>>
34998>>>>>        // Year.Year_Isolto
34998>>>>>        Set Field_Label_Long       Field Year.Year_Isolto         To "©¦¢¦ ©£æª àª"
34999>>>>>        Set Field_Label_Short      Field Year.Year_Isolto         To "©¦¢¦ ©£æª àª"
35000>>>>>
35000>>>>>        // Year.Year_Openfrom
35000>>>>>        Set Field_Label_Long       Field Year.Year_Openfrom       To "¨­âª §æ"
35001>>>>>        Set Field_Label_Short      Field Year.Year_Openfrom       To "¨­âª §æ"
35002>>>>>
35002>>>>>        // Year.Year_Opento
35002>>>>>        Set Field_Label_Long       Field Year.Year_Opento         To "¨­âª àª"
35003>>>>>        Set Field_Label_Short      Field Year.Year_Opento         To "¨­âª àª"
35004>>>>>
35004>>>>>        // Year.Year_Entrydate
35004>>>>>        Set Field_Label_Long       Field Year.Year_Entrydate      To "£¨¦£¤å ¨©åª"
35005>>>>>        Set Field_Label_Short      Field Year.Year_Entrydate      To "£/¤å ¨©åª"
35006>>>>>
35006>>>>>        // Year.Year_Dateaa
35006>>>>>
35006>>>>>        // Year.Year_Xrhshfrom
35006>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshfrom      To "¨ã© §æ"
35007>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshfrom      To "¨ã© §æ"
35008>>>>>
35008>>>>>        // Year.Year_Xrhshto
35008>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshto        To "¨ã© àª"
35009>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshto        To "¨ã© àª"
35010>>>>>
35010>>>>>        // Year.Year_Myflimit
35010>>>>>        Set Field_Label_Long       Field Year.Year_Myflimit       To "¨ ¦ "
35011>>>>>        Set Field_Label_Short      Field Year.Year_Myflimit       To "¨ ¦ "
35012>>>>>
35012>>>>>        // Year.Year_Numgtypkin
35012>>>>>        Set Field_Options          Field Year.Year_Numgtypkin     To DD_DISPLAYONLY
35013>>>>>
35013>>>>>        // Year.Year_Numgarticl
35013>>>>>        Set Field_Options          Field Year.Year_Numgarticl     To DD_DISPLAYONLY
35014>>>>>
35014>>>>>        // Year.Year_Numgmove
35014>>>>>        Set Field_Options          Field Year.Year_Numgmove       To DD_DISPLAYONLY
35015>>>>>
35015>>>>>        // Year.Year_Numgplan
35015>>>>>        Set Field_Options          Field Year.Year_Numgplan       To DD_DISPLAYONLY
35016>>>>>
35016>>>>>        // Year.Year_Numgformat
35016>>>>>        Set Field_Options          Field Year.Year_Numgformat     To DD_DISPLAYONLY
35017>>>>>
35017>>>>>        // Year.Year_Numgthaa
35017>>>>>        Set Field_Options          Field Year.Year_Numgthaa       To DD_DISPLAYONLY
35018>>>>>
35018>>>>>        // Year.Year_Numgopen
35018>>>>>        Set Field_Options          Field Year.Year_Numgopen       To DD_DISPLAYONLY
35019>>>>>
35019>>>>>        // Year.Year_Numbtypkin
35019>>>>>        Set Field_Options          Field Year.Year_Numbtypkin     To DD_DISPLAYONLY
35020>>>>>
35020>>>>>        // Year.Year_Numbaxio
35020>>>>>        Set Field_Options          Field Year.Year_Numbaxio       To DD_DISPLAYONLY
35021>>>>>
35021>>>>>        // Year.Year_Numbarticl
35021>>>>>        Set Field_Options          Field Year.Year_Numbarticl     To DD_DISPLAYONLY
35022>>>>>
35022>>>>>        // Year.Year_Numbmove
35022>>>>>        Set Field_Options          Field Year.Year_Numbmove       To DD_DISPLAYONLY
35023>>>>>
35023>>>>>        // Year.Year_Delimiter
35023>>>>>        Set Status_Help            Field Year.Year_Delimiter      To " ®à¨ ©« ¡æ   «¦  «ª ¨ã©àª"
35024>>>>>
35024>>>>>        // Year.Year_Printer
35024>>>>>
35024>>>>>        // Year.Year_Valid_Char
35024>>>>>
35024>>>>>    End_Procedure    // Define_Fields
35025>>>>>
35025>>>>>    // Field_Defaults:
35025>>>>>    // This procedure is used to establish default field values.
35025>>>>>
35025>>>>>    Procedure Field_Defaults
35026>>>>>        Forward Send Field_Defaults
35028>>>>>        //DDB-Generated-Code-Location
35028>>>>>        //DDB-FieldDefaultStart
35028>>>>>        //DDB-FieldDefaultEnd
35028>>>>>        Set Field_Changed_Value   Field Year.Year_Delimiter      To "."
35029>>>>>        Set Field_Changed_Value   Field Year.Year_Printer        To "LPT1:"
35030>>>>>        Set Field_Changed_Value   Field Year.Year_Valid_Char     To "1234567890"
35031>>>>>    End_Procedure    // Field_Defaults
35032>>>>>
35032>>>>>End_Class    // Year_DataDictionary
35033>>>>>//DDB-Selection-pkg-Start
35033>>>>>
35033>>>>>Use Sl003.sl         // SL003
INCLUDING FILE: SL003.SL
35033>>>>>>>//AB/ Project SL003:Year
35033>>>>>>>//AB/ Object prj is a Lookup_Project
35033>>>>>>>//AB/     Set ProjectName to "SL003:Year"
35033>>>>>>>//AB/     Set ProjectFileName to "Sl003.sl"
35033>>>>>>>
35033>>>>>>>// Project Object Structure
35033>>>>>>>//   SL003 is a dbModalPanelSub
35033>>>>>>>//     Company_DD is a DataDictionary
35033>>>>>>>//     Branch_DD is a DataDictionary
35033>>>>>>>//     Year_DD is a DataDictionary
35033>>>>>>>//     oSelList is a dbListSub
35033>>>>>>>//     oOK_bn is a ButtonSub
35033>>>>>>>//     oCancel_bn is a ButtonSub
35033>>>>>>>//     oSearch_bn is a ButtonSub
35033>>>>>>>
35033>>>>>>>// Register all objects
35033>>>>>>>Register_Object Branch_DD
35033>>>>>>>Register_Object Company_DD
35033>>>>>>>Register_Object oCancel_bn
35033>>>>>>>Register_Object oOK_bn
35033>>>>>>>Register_Object oSearch_bn
35033>>>>>>>Register_Object oSelList
35033>>>>>>>Register_Object SL003
35033>>>>>>>Register_Object Year_DD
35033>>>>>>>
35033>>>>>>>
35033>>>>>>>//AB-IgnoreStart
35033>>>>>>>
35033>>>>>>>Use DFAllEnt.pkg
35033>>>>>>>Use dbList.Sub
35033>>>>>>>Use Button.Sub
35033>>>>>>>
35033>>>>>>>
35033>>>>>>>Use COMPANY.DD
35033>>>>>>>Use BRANCH.DD
35033>>>>>>>Use YEAR.DD
35033>>>>>>>
35033>>>>>>>//AB-IgnoreEnd
35033>>>>>>>
35033>>>>>>>CD_Popup_Object SL003 is a dbModalPanelSub
35052>>>>>>>
35052>>>>>>>    //AB-StoreTopStart
35052>>>>>>>    Property String psFragmaCompanyCode  ""
35054>>>>>>>    Property String psFragmaBranchCode   ""
35056>>>>>>>    property integer pifragmaactive public 0
35058>>>>>>>    //AB-StoreTopEnd
35058>>>>>>>
35058>>>>>>>    Set Minimize_Icon to FALSE
35059>>>>>>>    Set Label to "¨ã© ª"
35060>>>>>>>    Set Size to 149 449
35061>>>>>>>    Set Location to 4 7
35062>>>>>>>    Set Exit_Application_Local_State to FALSE
35063>>>>>>>    Set Modal_State to FALSE
35064>>>>>>>
35064>>>>>>>    //AB-DDOStart
35064>>>>>>>
35064>>>>>>>    Object Company_DD is a Company_DataDictionary
35066>>>>>>>    End_Object    // Company_DD
35067>>>>>>>
35067>>>>>>>    Object Branch_DD is a Branch_DataDictionary
35069>>>>>>>        Set DDO_Server to (Company_DD(self))
35070>>>>>>>    End_Object    // Branch_DD
35071>>>>>>>
35071>>>>>>>    Object Year_DD is a Year_DataDictionary
35073>>>>>>>        Set DDO_Server to (Branch_DD(self))
35074>>>>>>>
35074>>>>>>>        //AB-StoreStart
35074>>>>>>>        Procedure OnConstrain
35076>>>>>>>             String lsCompanyCode lsBranchCode
35077>>>>>>>             integer iactive
35077>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
35078>>>>>>>             get pifragmaactive to iactive
35079>>>>>>>             If (lsCompanyCode <> "") Begin
35081>>>>>>>                Get psFragmaBranchCode  to lsBranchCode
35082>>>>>>>                Constrain Year.Company_Code eq lsCompanyCode
35084>>>>>>>                If (lsBranchCode <> "") Constrain Year.Branch_code eq lsBranchCode
35088>>>>>>>             End
35088>>>>>>>>
35088>>>>>>>             if (iactive = 0) constrain year.working ne 1
ERROR: 4328 Undefined symbol in argument YEAR.WORKING ON LINE: 78 (35091) OF FILE: C:\Vdf6\Develop\Empor\AppSrc\SL003.SL
35092>>>>>>>        End_Procedure // OnConstrain
35093>>>>>>>        
35093>>>>>>>        
35093>>>>>>>        
35093>>>>>>>        
35093>>>>>>>        
35093>>>>>>>        //AB-StoreEnd
35093>>>>>>>
35093>>>>>>>    End_Object    // Year_DD
35094>>>>>>>
35094>>>>>>>    Set Main_DD to (Year_DD(self))
35095>>>>>>>    Set Server to (Year_DD(self))
35096>>>>>>>
35096>>>>>>>    //AB-DDOEnd
35096>>>>>>>
35096>>>>>>>    Object oSelList is a dbListSub
35098>>>>>>>        Set Main_File to Year.File_Number
35099>>>>>>>        Set Size to 105 433
35100>>>>>>>        Set Location to 6 6
35101>>>>>>>
35101>>>>>>>        Begin_Row
35104>>>>>>>            Entry_Item Year.Year_year
35105>>>>>>>            Entry_Item Company.Company_code
35106>>>>>>>            Entry_Item Company.Company_name
35107>>>>>>>            Entry_Item Branch.Branch_code
35108>>>>>>>            Entry_Item Branch.Branch_name
35109>>>>>>>        End_Row
35114>>>>>>>
35114>>>>>>>        Set Form_Width    item 0 to 36
35115>>>>>>>        Set Header_Label  item 0 to "¨ã© :          "
35116>>>>>>>        
35116>>>>>>>        Set Form_Width    item 1 to 71
35117>>>>>>>        Set Header_Label  item 1 to "à ¡æª « ¨åª"
35118>>>>>>>        
35118>>>>>>>        Set Form_Width    item 2 to 136
35119>>>>>>>        Set Header_Label  item 2 to "¤¦£ « ¨åª"
35120>>>>>>>        
35120>>>>>>>        Set Form_Width    item 3 to 73
35121>>>>>>>        Set Header_Label  item 3 to "à ¡æª §¦¡/«¦ª"
35122>>>>>>>        
35122>>>>>>>        Set Form_Width    item 4 to 109
35123>>>>>>>        Set Header_Label  item 4 to "¤¦£ §¦¡/«¦ª"
35124>>>>>>>        
35124>>>>>>>
35124>>>>>>>        //AB-StoreStart
35124>>>>>>>                                                
35124>>>>>>>        Property String psStoreFragmaCompanyCode  ""
35126>>>>>>>        Property String psStoreFragmaBranchCode   ""
35128>>>>>>>        
35128>>>>>>>        Procedure Store_Defaults
35130>>>>>>>            forward send Store_Defaults
35132>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
35133>>>>>>>            Set psStoreFragmaBranchCode  to (psFragmaBranchCode(Self))
35134>>>>>>>        end_Procedure // Store_Defaults
35135>>>>>>>        
35135>>>>>>>        Procedure Restore_Defaults
35137>>>>>>>            forward send Restore_Defaults
35139>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
35140>>>>>>>            Set psFragmaBranchCode  to (psStoreFragmaBranchCode(self))
35141>>>>>>>        end_Procedure // Restore_Defaults
35142>>>>>>>        
35142>>>>>>>        Procedure Activating
35144>>>>>>>            Forward Send Activating
35146>>>>>>>            Send Rebuild_Constraints to (Year_DD(self))
35147>>>>>>>        End_Procedure // Activating
35148>>>>>>>        
35148>>>>>>>        
35148>>>>>>>        
35148>>>>>>>        //AB-StoreEnd
35148>>>>>>>
35148>>>>>>>    End_Object    // oSelList
35149>>>>>>>
35149>>>>>>>    Object oOK_bn is a ButtonSub
35151>>>>>>>        Set Label to "&§ ¢¦ã"
35152>>>>>>>        Set Location to 112 280
35153>>>>>>>
35153>>>>>>>        //AB-StoreStart
35153>>>>>>>        Procedure OnClick
35155>>>>>>>            Send OK To (oSelList(current_object))
35156>>>>>>>        End_Procedure
35157>>>>>>>        //AB-StoreEnd
35157>>>>>>>
35157>>>>>>>    End_Object    // oOK_bn
35158>>>>>>>
35158>>>>>>>    Object oCancel_bn is a ButtonSub
35160>>>>>>>        Set Label to "&¡ç¨à©"
35161>>>>>>>        Set Location to 112 335
35162>>>>>>>
35162>>>>>>>        //AB-StoreStart
35162>>>>>>>        Procedure OnClick
35164>>>>>>>            Send Cancel To (oSelList(current_object))
35165>>>>>>>        End_Procedure
35166>>>>>>>        //AB-StoreEnd
35166>>>>>>>
35166>>>>>>>    End_Object    // oCancel_bn
35167>>>>>>>
35167>>>>>>>    Object oSearch_bn is a ButtonSub
35169>>>>>>>        Set Label to "&¤ã«©"
35170>>>>>>>        Set Location to 112 390
35171>>>>>>>
35171>>>>>>>        //AB-StoreStart
35171>>>>>>>        Procedure OnClick
35173>>>>>>>            Send Search To (oSelList(current_object))
35174>>>>>>>        End_Procedure
35175>>>>>>>        //AB-StoreEnd
35175>>>>>>>
35175>>>>>>>    End_Object    // oSearch_bn
35176>>>>>>>
35176>>>>>>>
35176>>>>>>>    //AB-StoreStart
35176>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
35177>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
35178>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
35179>>>>>>>    
35179>>>>>>>    
35179>>>>>>>    
35179>>>>>>>    //AB-StoreEnd
35179>>>>>>>
35179>>>>>>>CD_End_Object    // SL003
35181>>>>>>>>
35181>>>>>>>
35181>>>>>>>//AB/ End_Object    // prj
35181>>>>>
35181>>>>>//DDB-Selection-pkg-End
35181>>>>>//DDB-FileEnd
35181>>>
35181>>>//AB-IgnoreEnd
35181>>>
35181>>>Object oSelectYear is a dbModalPanelSub
35183>>>
35183>>>    //AB-StoreTopStart
35183>>>    
35183>>>    Property String  psSelectedYearRecr  ''
35185>>>    Property Integer piChangeState False
35187>>>    
35187>>>    //AB-StoreTopEnd
35187>>>
35187>>>    Set Minimize_Icon to FALSE
35188>>>    Set Label to "§ ¢¦ã « ¨åª - §¦¡«©«ã£«¦ª - ¨ã©ª"
35189>>>    Set Size to 111 372
35190>>>    Set Location to 60 40
35191>>>    Set Color to 12232306
35192>>>    Set Popup_State to TRUE
35193>>>
35193>>>    //AB-DDOStart
35193>>>
35193>>>    Object Company_DD is a Company_DataDictionary
35195>>>
35195>>>        //AB-StoreStart
35195>>>        Set Foreign_Field_Options DD_KEYFIELD                   to DD_Clear_Field_Options DD_FindReq
35196>>>        Set Foreign_Field_Options DD_INDEXFIELD                 to DD_Clear_Field_Options DD_FindReq
35197>>>        Set Foreign_Field_Options Field Company.Company_Name    to DD_DisplayOnly
35198>>>        
35198>>>        
35198>>>        
35198>>>        //AB-StoreEnd
35198>>>
35198>>>    End_Object    // Company_DD
35199>>>
35199>>>    Object Branch_DD is a Branch_DataDictionary
35201>>>        Set DDO_Server to (Company_DD(self))
35202>>>
35202>>>        //AB-StoreStart
35202>>>        Set Foreign_Field_Options DD_KEYFIELD   to DD_Clear_Field_Options DD_FindReq
35203>>>        Set Foreign_Field_Options DD_INDEXFIELD to DD_Clear_Field_Options DD_FindReq
35204>>>        
35204>>>        Set Foreign_Field_Options DD_KEYFIELD   to DD_AutoFind_GE
35205>>>        Set Foreign_Field_Options DD_INDEXFIELD to DD_AutoFind_GE
35206>>>        
35206>>>        Set Foreign_Field_Options Field Branch.Branch_Name to DD_DisplayOnly
35207>>>        //AB-StoreEnd
35207>>>
35207>>>    End_Object    // Branch_DD
35208>>>
35208>>>    Object Year_DD is a Year_DataDictionary
35210>>>        Set DDO_Server to (Branch_DD(self))
35211>>>
35211>>>        //AB-StoreStart
35211>>>        
35211>>>        Set Field_Options Field Year.Year_Descr to DD_DisplayOnly
35212>>>        Set Field_Options Field Year.Year_Year to DD_AutoFind_GE
35213>>>        
35213>>>        Function Validate_Delete Returns Integer
35215>>>            Function_Return 1
35216>>>        End_Function
35217>>>        
35217>>>        //AB-StoreEnd
35217>>>
35217>>>    End_Object    // Year_DD
35218>>>
35218>>>    Set Main_DD to (Year_DD(self))
35219>>>    Set Server to (Year_DD(self))
35220>>>
35220>>>    //AB-DDOEnd
35220>>>
35220>>>    Object Company_Company_Code is a dbFormSub
35222>>>        Entry_Item Company.Company_code
35223>>>        Set Size to 13 71
35224>>>        Set Location to 9 112
35225>>>        Set Label_Col_Offset to 2
35226>>>        Set Label_Justification_Mode to jMode_Right
35227>>>        Set Prompt_Button_Mode to pb_PromptOn
35228>>>        Set Auto_Clear_Deo_State to FALSE
35229>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
35230>>>
35230>>>        //AB-StoreStart
35230>>>        
35230>>>        Set Prompt_Object to (sl001(Self))
35231>>>        
35231>>>        
35231>>>        //AB-StoreEnd
35231>>>
35231>>>    End_Object    // Company_Company_Code
35232>>>
35232>>>    Object Company_Company_Name is a dbFormSub
35234>>>        Entry_Item Company.Company_name
35235>>>        Set Size to 13 168
35236>>>        Set Location to 9 188
35237>>>        Set Label_Col_Offset to 2
35238>>>        Set Label_Justification_Mode to jMode_Right
35239>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
35240>>>
35240>>>        //AB-StoreStart
35240>>>        
35240>>>        //AB-StoreEnd
35240>>>
35240>>>    End_Object    // Company_Company_Name
35241>>>
35241>>>    Object Branch_Branch_Code is a dbFormSub
35243>>>        Entry_Item Branch.Branch_code
35244>>>        Set Size to 13 71
35245>>>        Set Location to 23 112
35246>>>        Set Label_Col_Offset to 2
35247>>>        Set Label_Justification_Mode to jMode_Right
35248>>>        Set Prompt_Button_Mode to pb_PromptOn
35249>>>        Set Auto_Clear_Deo_State to FALSE
35250>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
35251>>>
35251>>>        //AB-StoreStart
35251>>>        Set Prompt_Object to (sl002(Self))
35252>>>        
35252>>>        Procedure Prompt_CallBack Integer hPrompt
35254>>>            string lsCompanyCode
35255>>>            Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
35256>>>            Set psFragmaCompanyCode of hPrompt to lsCompanyCode
35257>>>        End_Procedure
35258>>>        
35258>>>        
35258>>>        
35258>>>        
35258>>>        //AB-StoreEnd
35258>>>
35258>>>    End_Object    // Branch_Branch_Code
35259>>>
35259>>>    Object Branch_Branch_Name is a dbFormSub
35261>>>        Entry_Item Branch.Branch_name
35262>>>        Set Size to 13 168
35263>>>        Set Location to 23 188
35264>>>        Set Label_Justification_Mode to jMode_Right
35265>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
35266>>>
35266>>>        //AB-StoreStart
35266>>>        
35266>>>        
35266>>>        //AB-StoreEnd
35266>>>
35266>>>    End_Object    // Branch_Branch_Name
35267>>>
35267>>>    Object Year_Year_Year is a dbFormSub
35269>>>        Entry_Item Year.Year_year
35270>>>        Set Size to 13 71
35271>>>        Set Location to 37 112
35272>>>        Set Label_Col_Offset to 2
35273>>>        Set Label_Justification_Mode to jMode_Right
35274>>>        Set Prompt_Button_Mode to pb_PromptOn
35275>>>        Set Auto_Clear_Deo_State to FALSE
35276>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
35277>>>
35277>>>        //AB-StoreStart
35277>>>        Set Prompt_Object to (sl003(Self))
35278>>>        
35278>>>        Procedure Prompt_CallBack Integer hPrompt
35280>>>            String lsCompanyCode lsBranchCode
35281>>>            integer icheck
35281>>>            Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
35282>>>            Get Field_Current_Value of Branch_DD  Field Branch.Branch_Code   to lsBranchCode
35283>>>            Set psFragmaCompanyCode of hPrompt to lsCompanyCode
35284>>>            Set psFragmaBranchCode  of hPrompt to lsBranchCode
35285>>>            get checked_state of (chkxr(self)) to icheck
35286>>>            set pifragmaactive      of hPrompt to icheck
35287>>>        End_Procedure
35288>>>        
35288>>>        
35288>>>        
35288>>>        
35288>>>        //AB-StoreEnd
35288>>>
35288>>>    End_Object    // Year_Year_Year
35289>>>
35289>>>    Object Year_Year_Descr is a dbFormSub
35291>>>        Entry_Item Year.Year_descr
35292>>>        Set Size to 13 168
35293>>>        Set Location to 37 188
35294>>>        Set Label_Col_Offset to 2
35295>>>        Set Label_Justification_Mode to jMode_Right
35296>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
35297>>>
35297>>>        //AB-StoreStart
35297>>>        
35297>>>        //AB-StoreEnd
35297>>>
35297>>>    End_Object    // Year_Year_Descr
35298>>>
35298>>>    Object Year_Year_Entrydate is a dbFormSub
35300>>>        Entry_Item Year.Year_entrydate
35301>>>        Set Size to 13 71
35302>>>        Set Location to 52 112
35303>>>        Set Label_Col_Offset to 2
35304>>>        Set Label_Justification_Mode to jMode_Right
35305>>>        Set Auto_Clear_Deo_State to FALSE
35306>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
35307>>>    End_Object    // Year_Year_Entrydate
35308>>>
35308>>>    Object oOk_bn is a ButtonSub
35310>>>        Set Label to "§¦¦®ã (F2)"
35311>>>        Set Size to 17 54
35312>>>        Set Location to 74 188
35313>>>        Set Form_FontHeight Item 0 to 14
35314>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
35315>>>
35315>>>        //AB-StoreStart
35315>>>        
35315>>>        Procedure OnClick
35317>>>            Delegate Send AcceptTheValues
35319>>>        End_Procedure
35320>>>        
35320>>>        
35320>>>        //AB-StoreEnd
35320>>>
35320>>>    End_Object    // oOk_bn
35321>>>
35321>>>    Object oCancel_bn is a ButtonSub
35323>>>        Set Label to "¥¦¦ª "
35324>>>        Set Size to 17 54
35325>>>        Set Location to 74 302
35326>>>        Set Form_FontHeight Item 0 to 14
35327>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
35328>>>
35328>>>        //AB-StoreStart
35328>>>        
35328>>>        Procedure OnClick
35330>>>           Send Exit_Application to oSelectYear
35331>>>        End_Procedure
35332>>>        
35332>>>        
35332>>>        
35332>>>        //AB-StoreEnd
35332>>>
35332>>>    End_Object    // oCancel_bn
35333>>>
35333>>>    Object otxtCompany is a TextBoxSub
35335>>>        Set Label to "« ¨å"
35336>>>        Set Auto_Size_State to FALSE
35337>>>        Set Color to 12232306
35338>>>        Set FontSize to 14 8
35339>>>        Set Location to 9 10
35340>>>        Set Size to 10 35
35341>>>        Set FontWeight to 600
35342>>>        Set TypeFace to "MS Sans Serif"
35343>>>        Set Enabled_State to TRUE
35344>>>    End_Object    // otxtCompany
35345>>>
35345>>>    Object otxtBranch is a TextBoxSub
35347>>>        Set Label to "§¦¡«©«ã£«"
35348>>>        Set Auto_Size_State to FALSE
35349>>>        Set Color to 12232306
35350>>>        Set FontSize to 14 8
35351>>>        Set Location to 23 10
35352>>>        Set Size to 10 63
35353>>>        Set FontWeight to 600
35354>>>        Set TypeFace to "MS Sans Serif"
35355>>>        Set Enabled_State to TRUE
35356>>>    End_Object    // otxtBranch
35357>>>
35357>>>    Object otxtYear is a TextBoxSub
35359>>>        Set Label to "¨ã© :          "
35360>>>        Set Auto_Size_State to FALSE
35361>>>        Set Color to 12232306
35362>>>        Set FontSize to 14 8
35363>>>        Set Location to 38 10
35364>>>        Set Size to 10 40
35365>>>        Set FontWeight to 600
35366>>>        Set TypeFace to "MS Sans Serif"
35367>>>        Set Enabled_State to TRUE
35368>>>    End_Object    // otxtYear
35369>>>
35369>>>    Object otxtWorkingDay is a TextBoxSub
35371>>>        Set Label to "£/¤å ¨©åª"
35372>>>        Set Auto_Size_State to FALSE
35373>>>        Set Color to 12232306
35374>>>        Set FontSize to 14 8
35375>>>        Set Location to 52 10
35376>>>        Set Size to 10 63
35377>>>        Set FontWeight to 600
35378>>>        Set TypeFace to "MS Sans Serif"
35379>>>        Set Enabled_State to TRUE
35380>>>    End_Object    // otxtWorkingDay
35381>>>
35381>>>    Object otxtWorkingDay is a TextBoxSub
35383>>>        Set Label to "¢ª ¦  ®¨ã© ª"
35384>>>        Set Auto_Size_State to FALSE
35385>>>        Set Color to 12232306
35386>>>        Set FontSize to 14 8
35387>>>        Set Location to 79 9
35388>>>        Set Size to 10 63
35389>>>        Set FontWeight to 600
35390>>>        Set TypeFace to "MS Sans Serif"
35391>>>        Set Enabled_State to TRUE
35392>>>    End_Object    // otxtWorkingDay
35393>>>
35393>>>    Object chkxr is a CheckBoxSub
35395>>>        Set Size to 13 22
35396>>>        Set Location to 79 113
35397>>>        Set Color to 12232306
35398>>>    End_Object    // chkxr
35399>>>
35399>>>
35399>>>    //AB-StoreStart
35399>>>    
35399>>>    Function ifSelect_Xrhsh Returns String
35401>>>        String  lsRecord_id
35402>>>        Set psSelectedYearRecr to gs_Selected_Year_Recr
35403>>>        send popup_modal
35404>>>        Get psSelectedYearRecr to lsRecord_id
35405>>>        Function_return lsRecord_Id
35406>>>    End_Function
35407>>>    
35407>>>    Procedure AcceptTheValues
35409>>>        Integer iRetVal liYearDD liCompanyDD liBranchDD
35410>>>        String ldcheck lsYearRecr lsSite sCname sBname sYname sNom1 sNom2 sNom3 sDelimiter sValidChars
35410>>>        Date ldYearXrhsh_From ldYearXrhsh_To dOpenFrom dOpenTo
35410>>>        Move Year_DD to liYearDD
35411>>>        Get Field_Current_Value of liYearDD Field Year.Year_EntryDate to ldcheck
35412>>>        if (ldcheck = "") ;            Get Message_Box "The Chosen Date is Not Correct." "Attention" MB_OK MB_ICONWARNING to iRetVal
35415>>>        else begin
35416>>>            Get Field_Current_Value of liYearDD Field Year.Year_XrhshFrom   to ldYearXrhsh_From
35417>>>            Get Field_Current_Value of liYearDD Field Year.Year_XrhshTo     to ldYearXrhsh_To
35418>>>            if ((ldcheck < ldYearXrhsh_From) or (ldcheck > ldYearXrhsh_To)) ;                Get Message_Box "The Date is Outside Range" "Attention" MB_OK MB_ICONWARNING to iRetVal
35421>>>            else begin
35422>>>                Move Company_DD to liCompanyDD
35423>>>                Move Branch_DD  to liBranchDD
35424>>>                Move Year_DD    to liYearDD
35425>>>                send Request_Save to liYearDD
35426>>>                Get Field_Current_Value of liCompanyDD Field Company.Company_Code to gs_Selected_Company_Code
35427>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_Code   to gs_Selected_Branch_Code
35428>>>    
35428>>>                Get Field_Current_Value of liBranchDD  Field Branch.Beto_Site   to gs_Selected_Beto_Site
35429>>>    
35429>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_Site   to lsSite
35430>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Year       to gi_Selected_Year
35431>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Recr       to lsYearRecr
35432>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_Code0    to sNom1
35433>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_Code00   to sNom2
35434>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_CodeR    to sNom3
35435>>>    
35435>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Valid_Char to sValidChars
35436>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Delimiter  to sDelimiter
35437>>>                Get Field_Current_Value of liYearDD    Field Year.Year_OpenFrom   to dOpenFrom
35438>>>                Get Field_Current_Value of liYearDD    Field Year.Year_OpenTo     to dOpenTo
35439>>>    
35439>>>                Get Field_Current_Value of liCompanyDD Field Company.Company_Name to sCname
35440>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_name   to sBname
35441>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Descr      to sYname
35442>>>    
35442>>>    
35442>>>                Local String    sCode
35442>>>                Local Integer   iBreak
35442>>>                Move 0 to iBreak
35443>>>                Clear Nomisma
35444>>>                Find Gt Nomisma.Recnum
35445>>>>
35445>>>                While ((Found=1) And (iBreak=0))
35449>>>                    If (Nomisma.Einai_Euro='1') Begin
35451>>>                        Move 1 to iBreak
35452>>>                        Move Nomisma.Nomisma_Code to sCode
35453>>>                    End
35453>>>>
35453>>>                    If (Not(iBreak)) Find Gt Nomisma.Recnum
35456>>>                Loop
35457>>>>
35457>>>                Move (Trim(sCode)) to sCode
35458>>>    
35458>>>    
35458>>>                Reread SysCurGL
35462>>>                Move gs_Selected_Company_Code   to SysCurGL.Company_Code
35463>>>                Move gs_Selected_beto_site      to SysCurGL.beto_site
35464>>>                Move gs_Selected_Branch_Code    to SysCurGL.Branch_Code
35465>>>                Move gi_Selected_Year           to SysCurGL.Year_Year
35466>>>                Move lsYearRecr                 to SysCurGL.Year_Recr
35467>>>                Move lsSite                     to SysCurGL.Branch_Site
35468>>>    
35468>>>                Move sCname                     to SysCurGL.Company_Name
35469>>>                Move sBname                     to SysCurGL.Branch_Name
35470>>>                Move sYname                     to SysCurGL.Year_Descr
35471>>>    
35471>>>                Move ldYearXrhsh_From           to SysCurGL.Year_XrhshFrom
35472>>>                Move ldYearXrhsh_To             to SysCurGL.Year_XrhshTo
35473>>>    
35473>>>                Move sValidChars                to SysCurGL.Year_Valid_Char
35474>>>                Move sDelimiter                 to SysCurGL.Year_Delimiter
35475>>>                Move dOpenFrom                  to SysCurGL.Year_OpenFrom
35476>>>                Move dOpenTo                    to SysCurGL.Year_OpenTo
35477>>>    
35477>>>                Move  (Trim(sNom1))             to SysCurGL.C_Code0
35478>>>                Move  (Trim(sNom2))             to SysCurGL.C_Code00
35479>>>                Move  (Trim(sNom3))             to SysCurGL.C_CodeR
35480>>>    
35480>>>                Move sCode                      to SysCurGL.Euro_Code
35481>>>    
35481>>>                Saverecord SysCurGL
35482>>>                Unlock
35483>>>>
35483>>>                Move lsYearRecr                 to gs_Selected_Year_Recr
35484>>>                Set psSelectedYearRecr          to lsYearRecr
35485>>>                Send Stop_Modal_ui
35486>>>                Set kEnter_Next_State of ghoWorkSpace to TRUE
35487>>>            End
35487>>>>
35487>>>        end
35487>>>>
35487>>>    End_Procedure
35488>>>    
35488>>>    Set Locate_Mode to Center_On_Screen
35489>>>    
35489>>>    On_Key KCancel      Send KeyAction to (oCancel_Bn(Self))
35490>>>    On_Key KClose_Panel Send KeyAction to (oCancel_Bn(Self))
35491>>>    On_Key Ksave_record send KeyAction to (oOK_Bn(Self))
35492>>>    
35492>>>    On_Key Key_alt+Key_A send KeyAction to (oOK_Bn(Self))
35493>>>    On_Key Key_alt+Key_Q send KeyAction to (oCancel_Bn(Self))
35494>>>    
35494>>>    //AB-StoreEnd
35494>>>
35494>>>End_Object    // oSelectYear
35495>>>
35495>>>
35495>>>//AB-StoreStart
35495>>>
35495>>>Procedure Epelexe_Xrhsh for BaseClass
35496>>>    Integer liCompanyDD liBranchDD liYearDD liYear liModalId
35497>>>    String lsCompany lsBranch lsWhatXrhsh
35497>>>    Move oSelectYear to liModalId
35498>>>    Get ifSelect_Xrhsh Of liModalId to lsWhatXrhsh
35499>>>    if (Trim(lsWhatXrhsh)='') Send Exit_Application
35502>>>End_Procedure
35503>>>
35503>>>Procedure Allaxe_Xrhsh for BaseClass
35504>>>    Integer rVal liModalId
35505>>>    get message_box "  ¤ ¢¢á¥« ®¨ã©  §¨â§  \n¤ ¡¢å©à ¦¢ « ¤¦ ®«á §¨á¬¨ «ª ­¨£¦ãª" "¢¢ã ®¨ã©ª" mb_yesno (mb_iconquestion ior mb_defbutton1) to rval
35506>>>    If (rVal = MBR_Yes) If (Close_All_Views(Self,True)=0) Begin
35510>>>        Move oSelectYear to liModalId
35511>>>        Send Epelexe_Xrhsh
35512>>>    End
35512>>>>
35512>>>End_Procedure
35513>>>
35513>>>On_Key Key_Ctrl+Key_X Send Allaxe_Xrhsh
35514>>>On_Key Key_Alt+Key_X  Send Allaxe_Xrhsh
35515>>>
35515>>>
35515>>>//AB-StoreEnd
35515>>>
35515>>>//AB/ End_Object    // prj
35515>
35515>Send Cursor_Wait to (Cursor_Control(Self))
35516>
35516>//Use AccStart.pkg // The Acc2000 Splash Screen
35516>
35516>// The Tips Object
35516>Use TipOfDay.dg
INCLUDING FILE: TIPOFDAY.DG
35516>>>
35516>>>Use AllEntSC.pkg
35516>>>
35516>>>//AB-IgnoreEnd
35516>>>
35516>>>
35516>>>//AB-IgnoreEnd
35516>>>Register_Object oTipDialog
35516>>>
35516>>>// Password for editing the TipOfDay Dialog Box
35516>>>Use PassDlg.dg
INCLUDING FILE: PASSDLG.DG
35516>>>>>    //AB-IgnoreStart
35516>>>>>
35516>>>>>    USE AllEntSc
35516>>>>>
35516>>>>>    //AB-IgnoreEnd
35516>>>>>
35516>>>>>
35516>>>>>    //AB-IgnoreEnd
35516>>>>>
35516>>>>>    Object oPassDlg is a ModalPanelSub
35518>>>>>
35518>>>>>        //AB-StoreTopStart
35518>>>>>
35518>>>>>        Property String  psGoodPassword  Public ""
35520>>>>>        Property Integer piOkPressed     Public False
35522>>>>>
35522>>>>>        //AB-StoreTopEnd
35522>>>>>
35522>>>>>        Set Exit_Application_Local_State to FALSE
35523>>>>>        Set Modal_State to FALSE
35524>>>>>        Set Minimize_Icon to FALSE
35525>>>>>        Set Label to "Enter Password..."
35526>>>>>        Set Location to 26 79
35527>>>>>        Set Size to 63 194
35528>>>>>
35528>>>>>        //AB-DDOStart
35528>>>>>
35528>>>>>
35528>>>>>        //AB-DDOEnd
35528>>>>>
35528>>>>>        Object PasswordForm is a Form
35530>>>>>
35530>>>>>            //AB-StoreTopStart
35530>>>>>
35530>>>>>            //AB-StoreTopEnd
35530>>>>>
35530>>>>>            Set Label_Col_Offset to 2
35531>>>>>            Set Label_Justification_Mode to jMode_Right
35532>>>>>            Set Size to 13 85
35533>>>>>            Set Location to 7 99
35534>>>>>
35534>>>>>            //AB-StoreStart
35534>>>>>
35534>>>>>            //  Set the Password_State property so that all data entry is
35534>>>>>            //  displayed as asterix (*) characters.
35534>>>>>            //
35534>>>>>            Set Password_State item 0 to TRUE
35535>>>>>
35535>>>>>            //AB-StoreEnd
35535>>>>>
35535>>>>>        End_Object    // PasswordForm
35536>>>>>
35536>>>>>        Object oOK_bn is a Button
35538>>>>>
35538>>>>>            //AB-StoreTopStart
35538>>>>>
35538>>>>>            //AB-StoreTopEnd
35538>>>>>
35538>>>>>            Set Default_State to TRUE
35539>>>>>            Set Label to "&OK"
35540>>>>>            Set Location to 28 134
35541>>>>>
35541>>>>>            //AB-StoreStart
35541>>>>>            Procedure OnClick
35543>>>>>                Set piOkPressed to True
35544>>>>>                Delegate Send Deactivate
35546>>>>>            End_Procedure
35547>>>>>
35547>>>>>            //AB-StoreEnd
35547>>>>>
35547>>>>>        End_Object    // oOK_bn
35548>>>>>
35548>>>>>        Object TextBoxSub1 is a TextBoxSub
35550>>>>>            Set Enabled_State to TRUE
35551>>>>>            Set Label to "Please Enter your Password:"
35552>>>>>            Set Auto_Size_State to FALSE
35553>>>>>            Set FontSize to 4 0
35554>>>>>            Set Size to 13 94
35555>>>>>            Set Location to 7 3
35556>>>>>        End_Object    // TextBoxSub1
35557>>>>>
35557>>>>>
35557>>>>>        //AB-StoreStart
35557>>>>>
35557>>>>>        //  To login a user, just set the psGoodPassword property to the value for a
35557>>>>>        //  valid password and then call the LoginUser function which will return TRUE/FALSE
35557>>>>>        //  depending on if the entered value (not case sensitive) matches the property
35557>>>>>        //  setting.
35557>>>>>        //
35557>>>>>        Function LoginPassword Returns Integer
35559>>>>>            Local Integer bPasswordGood
35560>>>>>            Local String sGoodPassword sEnteredPassword
35560>>>>>
35560>>>>>            Set value of (PasswordForm(Current_Object)) item 0 to ""
35561>>>>>            Send Popup_Modal
35562>>>>>
35562>>>>>            Get value of (PasswordForm(Current_Object)) item 0 to sEnteredPassword
35563>>>>>            Get psGoodPassword to sGoodPassword
35564>>>>>
35564>>>>>            if (sGoodPassword EQ sEnteredPassword) ;                move (TRUE) to bPasswordGood
35567>>>>>            else move (FALSE) to bPasswordGood
35569>>>>>            If (piOkPressed(Self)=0) move (FALSE) to bPasswordGood
35572>>>>>            Function_Return bPasswordGood
35573>>>>>        End_Function
35574>>>>>
35574>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
35575>>>>>
35575>>>>>        Procedure Activating
35577>>>>>            Set piOkPressed to False
35578>>>>>            Forward Send  Activating
35580>>>>>        End_Procedure
35581>>>>>
35581>>>>>
35581>>>>>        //AB-StoreEnd
35581>>>>>
35581>>>>>    End_Object    // oPassDlg
35582>>>>>
35582>>>>>//AB/     End_Object    // prj
35582>>>
35582>>>// If you don't want your customers to be able to accidently
35582>>>// hit F12 and being able to edit the Tip of the Day" texts
35582>>>// comment out the next line before deployment:
35582>>>// You could of course also edit/add/delete these texts
35582>>>// with the VDF program CodeMnt.vdf, but the edit dialog
35582>>>// in TipEdit.dg has been made the exact size of the TipOfDay dialog.
35582>>>Use TipEdit.dg
INCLUDING FILE: TIPEDIT.DG
35582>>>>>//AB/ Project Edit for Tip of the Day
35582>>>>>//AB/ Object prj is a Dialog_Project
35582>>>>>//AB/     Set ProjectName to "Edit for Tip of the Day"
35582>>>>>//AB/     Set ProjectFileName to "TipEdit.DG"
35582>>>>>//AB/     Set GenerateFileName to "NONAME"
35582>>>>>//****************************************************************************
35582>>>>>//
35582>>>>>// $Module type: dbModalPanel
35582>>>>>// $Module name: TipEdit
35582>>>>>// $Author     : Nils G. Svedmyr, Eurosoft. E-mail: nils@eurosoft.se CIS Id: 100315,2427
35582>>>>>// Created     : 1997-11-04 @ 02:57
35582>>>>>//
35582>>>>>// Description : Edit dialog for Tip of the Day (TipOfDay.dg).
35582>>>>>//               Invoked from there by pressing F12.
35582>>>>>//               Note: The size of the dbEdit has been set to the
35582>>>>>//               exact size of the Tip of the Day panel text.
35582>>>>>//
35582>>>>>// $Rev History
35582>>>>>//    1997-11-04  Module header created
35582>>>>>//****************************************************************************
35582>>>>>//AB-IgnoreStart
35582>>>>>
35582>>>>>USE AllEntSc.pkg
35582>>>>>
35582>>>>>//AB-IgnoreEnd
35582>>>>>
35582>>>>>
35582>>>>>//AB-IgnoreEnd
35582>>>>>
35582>>>>>Object oTipEdit is a dbModalPanelSub
35584>>>>>
35584>>>>>    //AB-StoreTopStart
35584>>>>>    Open "CodeType" as CodeType
INCLUDING FILE: CODETYPE.FD
35586>>>>>
35586>>>>>    Object CodeType_DS is a DataSet
35588>>>>>
35588>>>>>      Set Main_File to CodeType.File_Number
35589>>>>>
35589>>>>>      Begin_Constraints
35591>>>>>        Constrain CodeType.Type matches "TIP*"
35593>>>>>      End_constraints
35596>>>>>
35596>>>>>      Procedure Request_Save
35598>>>>>        Local Integer iTotalTips iOid
35599>>>>>        Local String sValue
35599>>>>>        Get CodeType_Type_Oid     to iOid
35600>>>>>        Get Value of iOid         to sValue
35601>>>>>        MoveStr (Left(sValue, 3)) to sValue
35602>>>>>>
35602>>>>>        If (sValue <> "TIP") Begin
35604>>>>>          Error 300 "The Code Must Start With the Word 'Tip'"
35605>>>>>>
35605>>>>>          Procedure_Return 1
35606>>>>>        End
35606>>>>>>
35606>>>>>        Forward Send Request_Save
35608>>>>>        Send Request_Clear // Start with a fresh buffer after a save.
35609>>>>>        // Don't forget to update the Registry key.
35609>>>>>        // Function TotalTips is a global function in TipOfDay.dg.
35609>>>>>        Get TotalTips to iTotalTips
35610>>>>>        Add 1 to iTotalTips
35611>>>>>        // Procedure TotalTips is a global procedure in TipOfDay.dg.
35611>>>>>        Set TotalTips to iTotalTips
35612>>>>>      End_Procedure // Request_Save
35613>>>>>
35613>>>>>      Procedure Request_Delete
35615>>>>>        Local Integer iTotalTips
35616>>>>>        Forward Send Request_Delete
35618>>>>>        Send Request_Clear
35619>>>>>        // Don't forget to update the Registry key.
35619>>>>>        // Function TotalTips is a global function in TipOfDay.dg.
35619>>>>>        Get TotalTips to iTotalTips
35620>>>>>        Add -1 to iTotalTips
35621>>>>>        // Procedure TotalTips is a global procedure in TipOfDay.dg.
35621>>>>>        Set TotalTips to iTotalTips
35622>>>>>      End_Procedure // Request_Delete
35623>>>>>
35623>>>>>    End_Object
35624>>>>>
35624>>>>>    //AB-StoreTopEnd
35624>>>>>
35624>>>>>    Set Minimize_Icon to FALSE
35625>>>>>    Set Label to "Managing Tips file (CodeType)"
35626>>>>>    Set Size to 135 231
35627>>>>>    Set Location to 18 60
35628>>>>>
35628>>>>>    //AB-DDOStart
35628>>>>>
35628>>>>>    //AB-DDOEnd
35628>>>>>
35628>>>>>    Object oBox is a dbContainer3d_
35630>>>>>
35630>>>>>        //AB-StoreTopStart
35630>>>>>        Set Server To (CodeType_DS(Self))
35631>>>>>        //AB-StoreTopEnd
35631>>>>>
35631>>>>>        Set Border_Style to Border_StaticEdge
35632>>>>>        Set Size to 97 219
35633>>>>>        Set Location to 4 5
35634>>>>>        Object CodeType_Type is a dbForm
35636>>>>>
35636>>>>>            //AB-StoreTopStart
35636>>>>>            //AB-StoreTopEnd
35636>>>>>
35636>>>>>            Entry_Item Codetype.Type
35637>>>>>            Set Label to "Code        "
35638>>>>>            Set Label_Col_Offset to 2
35639>>>>>            Set Label_Justification_Mode to jMode_Right
35640>>>>>            Set Size to 13 45
35641>>>>>            Set Location to 7 43
35642>>>>>
35642>>>>>            //AB-StoreStart
35642>>>>>            Set Item_Option item 0 to AutoFind True
35643>>>>>            Set CapsLock_State to True
35644>>>>>
35644>>>>>            // Function to return this object's id.
35644>>>>>            // Used by CodeType dataset at top of code.
35644>>>>>            Function CodeType_Type_Oid Global Returns Integer
35645>>>>>              Function_Return (Object_Id(CodeType_Type(oBox(Self))))
35646>>>>>            End_Function
35647>>>>>
35647>>>>>            //AB-StoreEnd
35647>>>>>
35647>>>>>        End_Object    // CodeType_Type
35648>>>>>
35648>>>>>        Object CodeType_Comment is a dbEdit
35650>>>>>
35650>>>>>            //AB-StoreTopStart
35650>>>>>
35650>>>>>            //AB-StoreTopEnd
35650>>>>>
35650>>>>>            Entry_Item Codetype.Comment
35651>>>>>            Set Label to "Text        "
35652>>>>>            Set Label_Col_Offset to 2
35653>>>>>            Set Label_Justification_Mode to jMode_Right
35654>>>>>            Set Size to 70 170
35655>>>>>            Set Location to 23 43
35656>>>>>
35656>>>>>            //AB-StoreStart
35656>>>>>
35656>>>>>            //AB-StoreEnd
35656>>>>>
35656>>>>>        End_Object    // CodeType_Comment
35657>>>>>
35657>>>>>
35657>>>>>        //AB-StoreStart
35657>>>>>
35657>>>>>        //AB-StoreEnd
35657>>>>>
35657>>>>>    End_Object    // oBox
35658>>>>>
35658>>>>>    Object oSave_bn is a ButtonSub
35660>>>>>
35660>>>>>        //AB-StoreTopStart
35660>>>>>
35660>>>>>        //AB-StoreTopEnd
35660>>>>>
35660>>>>>        Set Label to "Save"
35661>>>>>        Set Location to 104 67
35662>>>>>
35662>>>>>        //AB-StoreStart
35662>>>>>        Procedure OnClick
35664>>>>>            Send Request_Save to (CodeType_DS(Self))
35665>>>>>        End_Procedure
35666>>>>>
35666>>>>>        //AB-StoreEnd
35666>>>>>
35666>>>>>    End_Object    // oSave_bn
35667>>>>>
35667>>>>>    Object oDelete_bn is a ButtonSub
35669>>>>>
35669>>>>>        //AB-StoreTopStart
35669>>>>>
35669>>>>>        //AB-StoreTopEnd
35669>>>>>
35669>>>>>        Set Label to "Delete"
35670>>>>>        Set Location to 104 121
35671>>>>>
35671>>>>>        //AB-StoreStart
35671>>>>>        Procedure OnClick
35673>>>>>            Send Request_Delete to (CodeType_DS(Self))
35674>>>>>        End_Procedure
35675>>>>>
35675>>>>>        //AB-StoreEnd
35675>>>>>
35675>>>>>    End_Object    // oDelete_bn
35676>>>>>
35676>>>>>    Object oCancel_bn is a ButtonSub
35678>>>>>
35678>>>>>        //AB-StoreTopStart
35678>>>>>
35678>>>>>        //AB-StoreTopEnd
35678>>>>>
35678>>>>>        Set Label to "Cancel"
35679>>>>>        Set Location to 104 174
35680>>>>>
35680>>>>>        //AB-StoreStart
35680>>>>>        Procedure OnClick
35682>>>>>            Send Close_Panel
35683>>>>>        End_Procedure
35684>>>>>        //AB-StoreEnd
35684>>>>>
35684>>>>>    End_Object    // oCancel_bn
35685>>>>>
35685>>>>>    //AB-StoreStart
35685>>>>>    Procedure Popup
35687>>>>>        Local Integer liLoginOK##
35688>>>>>        Set psGoodPassword of (oPassDlg(Self)) to "jsfero"
35689>>>>>        Get LoginPassword of (oPassDlg(Self)) to liLoginOk##
35690>>>>>        Set psGoodPassword of (oPassDlg(Self)) to ""
35691>>>>>        If liLoginOK## Forward Send Popup
35695>>>>>        Else Send Info_Box "Invalid Password" "Error"
35697>>>>>    End_Procedure
35698>>>>>    //AB-StoreEnd
35698>>>>>
35698>>>>>End_Object    // oTipEdit
35699>>>>>
35699>>>>>//AB/ End_Object    // prj
35699>>>
35699>>>// To be able for the user to re-activate the Tip of Today dialog,
35699>>>// after it has been un-checked (checkbox "Show Tips at Startup"),
35699>>>// add these two lines to the Help menu package: (Helpa_PM.inc)
35699>>>//    On_Item "&Display Tip of the Day"  send Activate_TipOfDay
35699>>>//    Set Status_Help To "Show Tip of the Day dialog."
35699>>>Procedure Activate_TipOfDay // Send by help menu.
35700>>>  Send Activate to (oTipDialog(Self)) "Helpmenu"
35701>>>End_Procedure // Activate_TipOfDay
35702>>>
35702>>>Object oTipDialog is a ModalPanelSub
35704>>>
35704>>>    //AB-StoreTopStart
35704>>>    // All text strings used by this package: (cs is short for Compiler String)
35704>>>Use Language.pkg // Set default language if not set by compiler command line
35704>>>
35704>>>    // English: (Don't forget to change the short-cut keys at bottom of this code).
35704>>>    Define csDayTipHeader   for "Tip of the Day"
35704>>>    Define csDidYouKnow     for "Did you know..."
35704>>>    Define csDayTipNextTip  for "&Next Tip"
35704>>>    Define csDayTipPrevTip  for "&Previous Tip"
35704>>>    Define csClose          for "&Close"
35704>>>    Define csDayTipCheckbox for "&Show Tips at Startup"
35704>>>    //AB-StoreTopEnd
35704>>>
35704>>>    Set Minimize_Icon to FALSE
35705>>>    Set Label to csDayTipHeader
35706>>>    Set Size to 153 249
35707>>>    Set Locate_Mode to CENTER_ON_SCREEN
35708>>>
35708>>>    //AB-DDOStart
35708>>>
35708>>>
35708>>>    //AB-DDOEnd
35708>>>
35708>>>    Object oClose_bn is a ButtonSub
35710>>>
35710>>>        //AB-StoreTopStart
35710>>>
35710>>>        //AB-StoreTopEnd
35710>>>
35710>>>        Set Default_State to TRUE
35711>>>        Set Label to csClose
35712>>>        Set Location to 6 188
35713>>>
35713>>>        //AB-StoreStart
35713>>>        Procedure OnClick
35715>>>            Send Close_Panel
35716>>>        End_Procedure
35717>>>        //AB-StoreEnd
35717>>>
35717>>>    End_Object    // oClose_bn
35718>>>
35718>>>    Object oNext_bn is a ButtonSub
35720>>>
35720>>>        //AB-StoreTopStart
35720>>>
35720>>>        //AB-StoreTopEnd
35720>>>
35720>>>        Set Label to csDayTipNextTip
35721>>>        Set Location to 22 188
35722>>>
35722>>>        //AB-StoreStart
35722>>>        Procedure OnClick
35724>>>           Send DoConstrainedFind "Next"
35725>>>        End_Procedure
35726>>>        //AB-StoreEnd
35726>>>
35726>>>    End_Object    // oNext_bn
35727>>>
35727>>>    Object oPrev_bn is a ButtonSub
35729>>>
35729>>>        //AB-StoreTopStart
35729>>>
35729>>>        //AB-StoreTopEnd
35729>>>
35729>>>        Set Label to csDayTipPrevTip
35730>>>        Set Location to 39 188
35731>>>
35731>>>        //AB-StoreStart
35731>>>        Procedure OnClick
35733>>>           Send DoConstrainedFind "Prev"
35734>>>        End_Procedure
35735>>>
35735>>>        //AB-StoreEnd
35735>>>
35735>>>    End_Object    // oPrev_bn
35736>>>
35736>>>    Object oBox is a Container3dSub
35738>>>        Set Border_Style to Border_StaticEdge
35739>>>        Set Size to 113 175
35740>>>        Set Location to 6 5
35741>>>        Object Container3d1 is a Container3dSub
35743>>>            Set Border_Style to Border_None
35744>>>            Set Color to clWindow
35745>>>            Set Size to 105 167
35746>>>            Set Location to 4 3
35747>>>            Object oDidYouKnow_tb is a TextboxSub
35749>>>
35749>>>                //AB-StoreTopStart
35749>>>
35749>>>                //AB-StoreTopEnd
35749>>>
35749>>>                Set Color to clWindow
35750>>>                Set Label to csDidYouKnow
35751>>>                Set Size to 10 51
35752>>>                Set Location to 15 28
35753>>>
35753>>>                //AB-StoreStart
35753>>>                Set Justification_Mode item 0 to (jmode_center + jmode_vcenter + jmode_wrap)
35754>>>
35754>>>                //AB-StoreEnd
35754>>>
35754>>>            End_Object    // oDidYouKnow_tb
35755>>>
35755>>>            Object oDayTip_tb is a TextboxSub
35757>>>
35757>>>                //AB-StoreTopStart
35757>>>                // This is the textbox where the Tip of the Day text(s) are displayed.
35757>>>                //AB-StoreTopEnd
35757>>>
35757>>>                Set Color to clWindow
35758>>>                Set Label to ""
35759>>>                Set Auto_Size_State to FALSE
35760>>>                Set Size to 64 156
35761>>>                Set Location to 37 5
35762>>>
35762>>>                //AB-StoreStart
35762>>>                Set Justification_Mode item 0 to (jmode_center + jmode_vcenter + jmode_wrap)
35763>>>
35763>>>                //AB-StoreEnd
35763>>>
35763>>>            End_Object    // oDayTip_tb
35764>>>
35764>>>            Object BitmapContainer2 is a BitmapContainerSub
35766>>>                Set Border_Style to Border_None
35767>>>                Set Bitmap to "TipOfDay.bmp"
35768>>>                Set Size to 25 23
35769>>>                Set Location to 4 4
35770>>>            End_Object    // BitmapContainer2
35771>>>
35771>>>        End_Object    // Container3d1
35772>>>
35772>>>    End_Object    // oBox
35773>>>
35773>>>    Object oShowTips_cb is a CheckBoxSub
35775>>>
35775>>>        Set Label to csDayTipCheckbox
35776>>>        Set Size to 10 150
35777>>>        Set Location to 122 4
35778>>>        Set Auto_Size_State to False
35779>>>
35779>>>        //AB-StoreStart
35779>>>        Procedure DoSetTheState
35781>>>            If (Checked_State(Self)) Set Checked_State to False
35784>>>            Else Set Checked_State to True
35786>>>        End_Procedure
35787>>>
35787>>>        //AB-StoreEnd
35787>>>
35787>>>    End_Object    // oShowTips_cb
35788>>>
35788>>>
35788>>>    //AB-StoreStart
35788>>>
35788>>>    //******** PROCEDURES AND FUNCTIONS USED: **************
35788>>>
35788>>>    // Depending on the sMode passed to this procedure,
35788>>>    // it will find records in CodeType in one of three ways.
35788>>>    // "Random" will do a Find Ge on CodeType, which record buffer
35788>>>    // has been initialized with a random number in Procedure Activate.
35788>>>    // "Next" and "Prev" do what you think they do, *but* they ensure
35788>>>    // that the user will find records in CodeType in a "ring".
35788>>>    // "Tip0" is only displayed the very first time the program is started.
35788>>>    Procedure DoConstrainedFind String sMode
35790>>>      Local Integer ho // Object id.
35791>>>      Constraint_set 1
35792>>>      Constrain CodeType.Type matches "TIP*"
35794>>>      If (sMode = "Random") Begin
35796>>>        Constrained_Find Ge CodeType by index.1
35800>>>        [Not Found] Constrained_Find Le CodeType by index.1
35804>>>      End
35804>>>>
35804>>>      Else if (sMode = "Next") Begin
35807>>>        Constrained_Find Gt CodeType by index.1
35811>>>        [Not Found] Constrained_Find First CodeType by index.1
35816>>>        // The next line is to ensure we don't find an empty text...
35816>>>        If (CodeType.Comment = "") Constrained_Find Gt CodeType by index.1
35822>>>      End
35822>>>>
35822>>>      Else if (sMode = "Prev") Begin
35825>>>        Constrained_Find Lt CodeType by index.1
35829>>>        [Not Found] Constrained_Find Last CodeType by index.1
35834>>>        // The next line is to ensure we don't find an empty text...
35834>>>        If (CodeType.Comment = "") Constrained_Find Lt CodeType by index.1
35840>>>      End
35840>>>>
35840>>>      Else if (sMode = "FindTip0") Constrained_Find Eq CodeType by index.1
35847>>>      // Textbox for "Did You Know" text. We will *not* display this iff
35847>>>      // (if and only if) TIP0 will be displayed ("Welcome to this Program...").
35847>>>      Move (oDidYouKnow_tb(Container3d1(oBox(Self)))) to ho
35848>>>      If (CodeType.Type = "TIP0") Set Value of ho to ""
35851>>>      Else Set Value of ho to csDidYouKnow
35853>>>      // oDayTip_tb is the textbox where tip text(s) are displayed:
35853>>>      Move (oDayTip_tb(Container3d1(oBox(Self)))) to ho
35854>>>      Set Value of ho to CodeType.Comment
35855>>>    End_Procedure  // DoConstrainedFind
35856>>>
35856>>>    // This will activate the panel iff (if and only if) *one* of these three is true:
35856>>>    // 1. TipOfToday registry key for this Workspace is set to 1.
35856>>>    // 2. This is the first time the program is started and TipOfToday registry key
35856>>>    //    doesn't exist (If will get set by the TipOfToday function below).
35856>>>    // 3. The procedure has been passed the parameter "HELPMENU"
35856>>>    //    (See procedure Activate_TipOfDay at top of code).
35856>>>    Procedure Activate String sMode
35858>>>        Local integer iState iTotalTips ho
35859>>>        Local string sRandom
35859>>>        // Functions are defined further down in this code.
35859>>>        // iState can contain on of the following values:
35859>>>        //  1 ; Disply Tip of the Day panel
35859>>>        //  0 ; User has decided not to display Tip of the Day panel.
35859>>>        // -1 ; This is the first start of the program. TIPx records
35859>>>        //      exist in CodeType and we will display TIP0 = "Welcome to this program..."
35859>>>        //      upon startup.
35859>>>        Get TipOfToday to iState
35860>>>        // ...if user has decided not to display, we're out of here:
35860>>>        If ( (iState = 0) AND ( (Uppercase(sMode)) <> "HELPMENU") ) ;          Procedure_Return
35863>>>        Get TotalTips to iTotalTips
35864>>>        // Set the checkbox "Show Tips at Startup"...
35864>>>        Move (oShowTips_cb(Container3d1(oBox(Self)))) to ho
35865>>>        If iState ne 0 Set Checked_State of ho to True
35868>>>        // Get a random "tip of the day" to display:
35868>>>        If (iState <> -1) MoveStr (Random(iTotalTips)) to sRandom
35871>>>        Else MoveStr "0" to sRandom
35873>>>        Insert "TIP" in sRandom at 1
35875>>>        Clear CodeType
35876>>>        // Initialize buffer of CodeType with random number tip:
35876>>>        Move sRandom to CodeType.Type
35877>>>        If (iState <> -1)      Send DoConstrainedFind "Random"
35880>>>        Else If (iState  = -1) Send DoConstrainedFind "FindTip0"
35884>>>        Forward Send Activate
35886>>>    End_Procedure // Activate
35887>>>
35887>>>    // Function returns a value to indicate if the Tip of Today
35887>>>    // panel should be activated upon program start or not.
35887>>>    // If the registry key "TipOfToday" has not been
35887>>>    // previously set, it will be *created* and initialized to "1" (active state)
35887>>>    // The key "TotalTips", will also be created and initialized to number
35887>>>    // of "Tipx" saved in CodeType.
35887>>>    // Function Returns:
35887>>>    //  1 ; Disply Tip of the Day panel
35887>>>    //  0 ; User has decided not to display Tip of the Day panel.
35887>>>    // -1 ; This is the first start of the program. TIPx records
35887>>>    //      exist in CodeType and we will display TIP0 = "Welcome to this program..."
35887>>>    //      upon startup.
35887>>>    Function TipOfToday Returns Integer
35889>>>      Local Integer iRetval iRecords
35890>>>      Local dWord dwState
35890>>>      // Function returns the number of TIPx records in CodeType as a positive
35890>>>      // integer if a TIP0 record has been created and a negative integer with the
35890>>>      // number of records if TIP0 is *not* defined:
35890>>>      Get CheckIfTipsExist to iRecords
35891>>>      // TipOfDay was set to 1 (True) if Tip of the Day will be displayed:
35891>>>      Get System_Profile_Dword 'TipOfToday' to dwState
35892>>>      If dwState eq Reg_Value_Not_Exist Begin // Create it. New installation.
35894>>>        // We will first check if CodeType contains any TIPx records.
35894>>>        // If that's the case we will display the TIP0 record, which is
35894>>>        // the "Welcome to this program..." text.
35894>>>        // We also must take care of the special case when TIPx records
35894>>>        // do exist but no welcome screen message has been defined (TIP0).
35894>>>        // This way it's not necessary to set the registry keys on the
35894>>>        // user's machine before starting the program the first time,
35894>>>        // it's all automatically done for you.
35894>>>        // There are TIPx records, but no TIP0 record:
35894>>>        If (iRecords < 0) Begin
35896>>>          MoveInt (- iRecords) to iRecords // Make it positive.
35897>>>>
35897>>>          MoveInt 1 to iRetval
35898>>>>
35898>>>        End
35898>>>>
35898>>>        Else If (iRecords > 0) MoveInt -1 to iRetval
35902>>>        Set TipOfToday to 1              // Set it to true in the registry (Active)
35903>>>        Set TotalTips  to iRecords       // Set it to the number of records in CodeType. Will be 0 before records have been entered by developer.
35904>>>      End // If iState ne Reg_Value_Not_Exist Begin
35904>>>>
35904>>>      Else ;        Move dwState to iRetval
35906>>>      Function_Return iRetval
35907>>>    End_Function  // TipOfToday
35908>>>
35908>>>    Procedure Set TipOfToday Integer iState
35910>>>      // TipOfDay is a string setting in the registry,
35910>>>      // set to 1 if Tip of the Day will be displayed:
35910>>>      Set System_Profile_Dword 'TipOfToday' to iState
35911>>>    End_Procedure  // Set TipOfToday
35912>>>
35912>>>    // TipEdit.dg will use this procedure to increment
35912>>>    // and decrement the registry key when records are
35912>>>    // added and deleted, thus set it to Global.
35912>>>    Procedure Set TotalTips Global Integer iTotalTips
35913>>>      Set System_Profile_Dword 'TotalTips' to iTotalTips
35914>>>    End_Procedure  // Set TotalTips
35915>>>
35915>>>    // Set this function to Global so we can use it
35915>>>    // in TipEdit.dg, as well:
35915>>>    Function TotalTips Global Returns Integer
35916>>>      Local Integer iRetval
35917>>>      // TotalTips is the total number of Tip of today available.
35917>>>      // It's used by the random function:
35917>>>      Get System_Profile_Dword 'TotalTips' to iRetval
35918>>>      Function_Return iRetval
35919>>>    End_Function
35920>>>
35920>>>    // Used by TipOfToday function to check if there's
35920>>>    // a "Welcome to this program..." message saved in CodeType,
35920>>>    // and how many TIPx records have been saved in CodeType.
35920>>>    // Function Returns;
35920>>>    // - A positive integer with the number of CodeType TIPx records. TIP0 exist.
35920>>>    // - A negative integer with the number of CodeType TIPx records. There's *no* TIP0 record.
35920>>>    Function CheckIfTipsExist Returns Integer
35922>>>      Local Integer iRetval iState
35923>>>      Clear CodeType
35924>>>      Constraint_set 2
35925>>>      Constrain CodeType.Type matches "TIP*"
35927>>>      Move "TIP0" to CodeType.Type
35928>>>      Constrained_Find Eq CodeType by index.1
35932>>>      [Found] MoveInt 1 to iState
35933>>>>
35933>>>      [Found] MoveInt 1 to iRetval
35934>>>>
35934>>>      Repeat
35934>>>>
35934>>>        Constrained_Find Gt CodeType by index.1
35938>>>        [Found] Increment iRetval
35939>>>      Until [Not Found]
35941>>>      If (iState <> 1) MoveInt (- iRetval) to iRetval // Make it negative.
35944>>>      Function_Return iRetval
35945>>>    End_Function
35946>>>
35946>>>    Procedure Close_Panel
35948>>>      Local Integer ho iState
35949>>>      Move (oShowTips_cb(Container3d1(oBox(Self)))) to ho
35950>>>      Get Checked_State of ho to iState
35951>>>      // Save state of checkbox "Show Tips at Startup"
35951>>>      // to the registry.
35951>>>      Set TipOfToday to iState
35952>>>      Forward Send Close_Panel
35954>>>    End_Procedure // Close_Panel
35955>>>
35955>>>
35955>>>    On_Key Key_Alt+Key_K  Send KeyAction to (oClose_bn(Self))
35956>>>    On_Key Key_Alt+Key_E  Send KeyAction to (oNext_bn(Self))
35957>>>    On_Key kFind_Next     Send KeyAction to (oNext_bn(Self))
35958>>>    On_Key Key_Alt+Key_P  Send KeyAction to (oPrev_bn(Self))
35959>>>    On_Key kFind_Previous Send KeyAction to (oPrev_bn(Self))
35960>>>    On_Key Key_Alt+Key_D  Send DoSetTheState to (oShowTips_cb(Self))
35961>>>    On_Key Key_Ctrl+Key_E Send Popup     to (oTipEdit(Self))
35962>>>
35962>>>    //AB-StoreEnd
35962>>>
35962>>>End_Object    // oTipDialog
35963>>>
35963>>>//AB/ End_Object    // prj
35963>
35963>Use CheckLog.pkg
35963>Use Checkafm.pkg
INCLUDING FILE: CHECKAFM.PKG
35963>>>
35963>>>
35963>>>Function Check_Afm Global String Afm_Num Returns Integer
35964>>>    Integer iii Num1 Num2
35965>>>
35965>>>    Move (Trim(Afm_Num)) To Afm_Num
35966>>>    Move (Right(Afm_Num,1)) to Num2
35967>>>
35967>>>    If (Length(Afm_Num)<>9) Function_Return 2
35970>>>
35970>>>    For iii From 1 To (Length(Trim(Afm_Num)))
35976>>>>
35976>>>        If Not (Mid(Afm_Num,1,iii)) In  "0123456789" Function_Return 3
35979>>>    Loop
35980>>>>
35980>>>
35980>>>    Move 0 to Num1
35981>>>
35981>>>    For iii From 1 to 8
35987>>>>
35987>>>        Add ((Mid(Afm_Num,1,iii)) * (2 ^ (9 - iii))) to Num1
35988>>>    Loop
35989>>>>
35989>>>
35989>>>    Move (Mod(Num1,11)) to Num1
35990>>>    If (Num1=10) Move 0 to Num1
35993>>>
35993>>>    If (Num1=Num2)  Function_Return 0
35996>>>    Else            Function_Return 1
35998>>>End_Function
35999>>>
35999>Use Help_Ids.inc // Developer should provide this file of help context links.
INCLUDING FILE: HELP_IDS.INC
35999>>>// Help_ids.inc
35999>>>//
35999>>>// Context ids for the order entry system. This uses
35999>>>// help file ordentry.hlp.
35999>>>//
35999>>>// This is a sample version. YOU must supply
35999>>>// the ID values
35999>>>
35999>>>//  Generic Context Ids
35999>>>//
35999>>>
35999>>>// It is expected that file-names ids will be the same as their
35999>>>// filenumber.
35999>>>
35999>>>
35999>>>//  View and selection-list specific context ids
35999>>>//
35999>>>//..........add view, object, selection-list ids here....
35999>Use Std_Help.pkg
INCLUDING FILE: STD_HELP.PKG
35999>>>// STD_HELP.PKG
35999>>>//
35999>>>// Global Help Object
35999>>>//
35999>>>//  Creates all Help Support required to access WINDOWs help system
35999>>>//  with DataFlex. Creates a global object named Help_Object.
35999>>>//
35999>>>//  9/19/97 JJT - Modified to define stadnard help Ids if they are undefined
35999>>>
35999>>>use DFHlpSys // Context Sensitive Help Support
35999>>>
35999>>>
35999>>>// This file needs to be provided by the developer. It will contain
35999>>>// symbolic replacements for the ID integer values used to access the
35999>>>// the windows help file's topics.
35999>>>//
35999>>>use Help_ids.inc
35999>>>
35999>>>// If the following are not defined in help_ids.inc,
35999>>>//  create default 0 values for them
35999>>>Define GeneralHelpId    for    0
35999>>>Define KeysHelpId       for    0
35999>>>Define FileHelpId       for    0
35999>>>Define ErrorHelpId      for    0  // probably not used in VDF
35999>>>Define IndexHelpId      for    0  // probably not used in VDF
35999>>>
35999>>>object Help_Object is a HelpSystem // global help object
36001>>>
36001>>>   Set Help_Id_General to GeneralHelpId    // these should all be defined
36002>>>   Set Help_Id_Index   to IndexHelpId      // in help_ids.inc.
36003>>>   Set Help_Id_Keys    to KeysHelpId       //
36004>>>   Set Help_Id_Files   to FileHelpId       //
36005>>>   Set Help_Id_Errors  to ErrorHelpId      //
36006>>>
36006>>>end_object
36007>
36007>//AB-StoreTopEnd
36007>
36007>
36007>Object Main is a Panelsub
36009>    Set Label To "Acc2000"
36010>    Use glmenu.mn //  Menu package.
INCLUDING FILE: GLMENU.MN
36010>>>// MNB-FileStart
36010>>>// MNB-HeaderStart
36010>>>// MNB-HeaderEnd
36010>>>
36010>>>DFCreate_Menu Main_Menu                            
36013>>>    
36013>>>    Property String psMenuModule
36015>>>    
INCLUDING FILE: FILE_PM.INC
36015>>>>Object oMyWinPrint is an DF_PRINTER
36017>>>>
36017>>>>    Procedure DFPrint
36019>>>>        Local Integer iRetVal
36020>>>>
36020>>>>        Get DFGetPrintDialogFlags To iRetVal
36021>>>>
36021>>>>        If iRetVal Begin
36023>>>>            Send DFPrintDoc
36024>>>>            Send DFClearDoc
36025>>>>        End
36025>>>>>
36025>>>>    End_Procedure
36026>>>>    Move Current_Object to WinPrintId
36027>>>>End_Object
36028>>>>
36028>>>>
36028>>>>DFCreate_Menu "&File" File_Menu is a DEOPopupMenu
36032>>>>    On_Item "&Clear/Add\aF5" send Request_Clear
36033>>>>        Set Status_Help To 'Clear current record / Add a new record'
36034>>>>
36034>>>>    On_Item "Clear &all\aCtrl+F5" send Request_Clear_All
36035>>>>        Set Status_Help To 'Clear all data from view'
36036>>>>
36036>>>>    On_Item "&Delete\aShift+F2" send Request_Delete
36037>>>>        Set Status_Help To 'Delete the current record'
36038>>>>
36038>>>>    On_Item "&Find\aF9" send Find_GE
36039>>>>        Set Status_Help To 'Find a record'
36040>>>>
36040>>>>    On_Item "&Next\aF8" send Find_Next
36041>>>>        Set Status_Help To 'Find the Next record'
36042>>>>
36042>>>>    On_Item "&Previous\aF7" send Find_Previous
36043>>>>        Set Status_Help To 'Find the Previous record'
36044>>>>
36044>>>>    On_Item "Superfind\aShift+F9" send Superfind
36045>>>>        Set Status_Help To 'Superfind a record'
36046>>>>
36046>>>>    On_Item "Superfind next\aShift+F8" send Superfind_Next
36047>>>>        Set Status_Help To 'Superfind the Next record'
36048>>>>
36048>>>>    On_Item "Superfind previous\aShift+F7" send Superfind_Previous
36049>>>>        Set Status_Help To 'Superfind the Previous record'
36050>>>>
36050>>>>    On_Item "Find fi&rst\aCtrl+Home" send Beginning_Of_Data
36051>>>>        Set Status_Help To 'Find the First record'
36052>>>>
36052>>>>    On_Item "Find &last\aCtrl+End" send End_Of_Data
36053>>>>        Set Status_Help To 'Find the Last record'
36054>>>>
36054>>>>    On_Item "&Save\aF2" send Request_Save
36055>>>>        Set Status_Help To 'Save the current record'
36056>>>>
36056>>>>
36056>>>>    On_Item "" send NONE
36057>>>>
36057>>>>    on_item   "Printer Settings   "  send DFPrintSetup       to (oWinPrint(Self))
36058>>>>    Set Status_Help To ""
36059>>>>    on_item   "Print              "  send DFPrint            to (oMyWinPrint(Self))
36060>>>>    Set Status_Help To ""
36061>>>>
36061>>>>    On_Item "" send NONE
36062>>>>
36062>>>>    On_Item "Properties" send DoShowProperties to Self
36063>>>>    Set Status_Help To 'Setup Program Properties'
36064>>>>
36064>>>>    On_Item "" send NONE
36065>>>>
36065>>>>    On_Item "E&xit\aAlt+F4" send Exit_Application to desktop
36066>>>>        Set Status_Help To "Stop Program's execution"
36067>>>>
36067>>>>    Procedure DoShowProperties
36069>>>>       // If (Close_All_Views(Self,True)=0) Send Activate_View to (piPropertiesObjectId(self))
36069>>>>    End_Procedure
36070>>>>
36070>>>>    On_Key Key_Alt+Key_I Send DoShowProperties
36071>>>>
36071>>>>    //
36071>>>>    Procedure OnInitMenu
36073>>>>        Local integer Obj# IsDeo Changed NoIndex File# Field# Srvr Itm
36074>>>>        Local integer IsDeoControl lId liClId
36074>>>>        Get Focus to Obj#
36075>>>>        Get is_Function Get_DEO_Object Obj# TRUE to IsDeo
36076>>>>        If IsDeo Get Server of obj# to Srvr          // invoking data-set
36079>>>>        If (isDeo AND Srvr) Begin
36081>>>>            // returns T if object in question is a DEO control object (i.e.
36081>>>>            // understands the data_file, data_field messages).
36081>>>>            Get is_Function Get_DEO_Control_Object Obj# False to IsDeoControl
36082>>>>            Get Should_Save of Obj# to changed  // changed file?
36083>>>>            If IsDEOControl Begin
36085>>>>                Get data_file of Obj# to file#
36086>>>>                Get data_field of Obj# to field#
36087>>>>                Move ( File#=0 OR ;                    (Field_Main_Index(Srvr,File#,Field#)=-1) ;                    ) to NoIndex             // has a find index?
36088>>>>            End
36088>>>>>
36088>>>>            Else ;                Move 1 to NoIndex
36090>>>>            Set Shadow_state item  0  to False                     // Clear
36091>>>>            Set Shadow_state item  1  to False                     // Clear All
36092>>>>            Set Shadow_state item  2  to (Current_record(Srvr)=0)  // Delete
36093>>>>            Set Shadow_state item  3  to NoIndex                   // Find
36094>>>>            Set Shadow_state item  4  to NoIndex                   // Find Next
36095>>>>            Set Shadow_state item  5  to NoIndex                   // Find Previous
36096>>>>            Set Shadow_state item  6  to NoIndex                   // Superfind
36097>>>>            Set Shadow_state item  7  to NoIndex                   // Superfind Next
36098>>>>            Set Shadow_state item  8  to NoIndex                   // Superfind Previous
36099>>>>            Set Shadow_state item  9  to NoIndex                   // Find First
36100>>>>            Set Shadow_state item 10  to NoIndex                   // Find Last
36101>>>>            Set Shadow_state item 11  to (Should_Save(Srvr)=0)     // Save
36102>>>>            Set Shadow_state item 12  to NoIndex                   // Printer
36103>>>>            Set Shadow_state item 13  to NoIndex                   // Print
36104>>>>//            Set Shadow_state item 14  to NoIndex                   // Properties
36104>>>>//            Set Shadow_state item 15  to (Should_Save(Srvr)=0)     // Exodos
36104>>>>        End
36104>>>>>
36104>>>>        Else Begin
36105>>>>            for itm from 0 to 13
36111>>>>>
36111>>>>                set shadow_State item itm to TRUE
36112>>>>            Loop
36113>>>>>
36113>>>>        End
36113>>>>>
36113>>>> //       Set Shadow_State Item 14 to (piPropertiesObjectId(Self)=0)
36113>>>>    End_Procedure
36114>>>>
36114>>>>    Register_Procedure Activate_oPrnSetup
36114>>>>
36114>>>>End_Pull_Down
36116>>>>Set Status_Help to "Find, Save, Delete, Clear information or quit this application."
36117>>>>
36117>>>
36117>>>    DFCreate_Menu "&¦¨ ©£¦å" View_PopupMenu IS A ViewPopupMenu
36121>>>        On_Item "&¦ ©« ¡æ ®â ¦"              Send Activate_Gplan_View
36122>>>        On_Item ""  
36123>>>        On_Item "&¡«ç§à© ¦ ©« ¡¦ç ®å¦¬"  Send Activate_R150_0
36124>>>        On_Item "&¡«ç§à© ¦ ©« ¡¦ç ®å¦¬ (Basic)"  Send Activate_R056
36125>>>    End_Pull_Down // ¦ ©« ¡æ ®â ¦
36127>>>    Set Status_Help To "¦¨ ©£¦å"
36128>>>
36128>>>    DFCreate_Menu "& ¤ã© ª" View1_PopupMenu IS A ViewPopupMenu
36132>>>
36132>>>        On_Item "&£¨ã© ª  ¤ã© ª"                       Send Activate_Gmove_View //Arthro_l
36133>>>        Set Status_Help To "£¨ã© ª  ¤ã© ª"
36134>>>//        On_Item "& ®å¨ © Open Items"                     Send Activate_V068 
36134>>>//        On_Item ""                                          Send None
36134>>>//        Set Status_Help To "¬®«å© ª á¨¨à¤"
36134>>>        On_Item ""
36135>>>        On_Item "&¨æ«¬§ ¨¨ "                           Send Activate_V164
36136>>>//        On_Item "&¡¬¨à« ¡á ¨¨ "                         Send Activate_V058a
36136>>>//        On_Item ""
36136>>>//        On_Item "&¡«¬§à© £¨ã© à¤  ¤ã©à¤"               Send Activate_R058
36136>>>        
36136>>>        Procedure OnInitMenu
36138>>>//            Set Shadow_State Item 1 to True
36138>>>//            Set Shadow_State Item 3 to True
36138>>>//            Set Shadow_State Item 4 to True
36138>>>        End_Procedure
36139>>>
36139>>>    End_Pull_Down // &View
36141>>>    Set Status_Help To " ¤ã© ª"
36142>>>
36142>>>    DFCreate_Menu "¡«¬§é© ª - &§ ¡¦¤å© ª " Report_PopupMenu IS A ViewPopupMenu
36146>>>
36146>>>        DFCreate_Menu "§ ¡¦¤å© ª" Disp_PopupMenu IS A ViewPopupMenu
36150>>>            On_Item "&¤¢¬« ¡æ ¦¢ ¡æ"        Send Activate_AnalKath1_View
36151>>>            On_Item "&©¦ç ¦ "                 Send Activate_v56v59v60
36152>>>
36152>>>        End_Pull_Down // ThRep
36154>>>        Set Status_Help To "§ ¡¦¤å© ª"
36155>>>            On_Item ""
36156>>>
36156>>>        DFCreate_Menu "¡«¬§é© ª ¢â®¦¬" CheckRep_PopupMenu IS A ViewPopupMenu
36160>>>            On_Item "&¨æ® ¨¦ £¨¦¢æ ¦ (Basic)"               Send Activate_R058
36161>>>            On_Item "&¤¢¬« ¡æ ¦¢ ¡æ (Basic) "               Send Activate_R056_1
36162>>>            On_Item "&©¦ç ¦ ¢â®¦¬ (Basic)"                  Send ElegxoyIso
36163>>>            On_Item "¨ ¦ ¡ã &... (Basic) "                 Send Activate_r071
36164>>>            On_Item "" send none    
36165>>>            On_Item "¨æ® ¨¦ £¨¦¢æ ¦"                       Send Activate_R157_1
36166>>>            On_Item "¤¢¬« ¡æ ¦¢ ¡æ "                       Send Activate_R157_2
36167>>>       //     On_Item "©¦ç ¦ ¢â®¦¬ "                         Send activate_r157_3
36167>>>        End_Pull_Down //
36169>>>            
36169>>>
36169>>>        DFCreate_Menu "à¨£â¤ £¨¦¢æ " ThRep_PopupMenu IS A ViewPopupMenu
36173>>>
36173>>>
36173>>>            /////On_Item "&©¦ç ¦            "  Send TheorimenoIso
36173>>>            On_Item "&¤ ¡æ ¦¢ ¡æ     "  Send TheorimenoKath
36174>>>            On_Item "&£¨¦¢æ           "  Send Activate_R058T
36175>>>
36175>>>
36175>>>        End_Pull_Down // ThRep
36177>>>        Set Status_Help To "à¨£â¤ £¨¦¢æ "
36178>>>
36178>>>
36178>>>    Set Status_Help To "¡«¬§é© ª ¢â®¦¬"
36179>>>    End_Pull_Down // &Report
36181>>>    Set Status_Help To "¡«¬§é© ª"
36182>>>
36182>>>
36182>>>    DFCreate_Menu "¦&« ¡á ¨®å - ¨©åª" HlpFilesRep_PopupMenu IS A ViewPopupMenu
36186>>>            on_item "« ¨åª-§¦¡«-¨ã© ª"                    send activate_v3 
36187>>>            on_item " ®å¨ © ©à«¨ ¡é¤  ¤á¡à¤"               send activate_types_maint 
36188>>>            On_Item ""                                            Send NONE
36189>>>            //On_Item "¢¢ã « ¨åª-&¨ã©ª\aCtrl+X"                      Send DoChangeYear
36189>>>            //Set Status_Help To "¢¢ã « ¨åª - ¨ã©ª"
36189>>>            //On_Item " ®å¨ © ¨£â«¨à¤ &¨ã©à¤"              Send Activate_V53
36189>>>            On_Item "&£¨¦¢æ "                                 Send Activate_Gthhmgio
36190>>>            On_Item "&£¨¦£¤åª £¨¦¢¦åà¤"                    Send Activate_V063
36191>>>            On_Item "&ç§¦   ¤ã©à¤"                             Send Activate_Gtypkin_View
36192>>>            On_Item "&á©¡ª ¦ ©« ¡¦ç ®å¦¬"                  Send Activate_Gformat
36193>>>            on_item " ®å¨ © ¡«¬§é©à¤ "                      send activate_Vrep 
36194>>>          
36194>>>            On_Item ""
36195>>>            //On_Item "&¤« ¨­ã ¦ ©« ¡¦ç ®å¦¬  "             Send Activate_v056c
36195>>>            //On_Item ""
36195>>>//            On_Item "&¬¤«ã¨© ¡à ¡é¤ ¢ ©«é¤"                   Send Activate_Types_Maint
36195>>>//            Set Status_Help To "¬¤«ã¨© ¨®åà¤ (CodeMast - CodeType)"
36195>>>//            On_Item ""                                            Send None
36195>>>
36195>>>            DFCreate_Menu "¨©åª ." Works_PopupMenu IS A ViewPopupMenu
36199>>>
36199>>>                On_Item "&¨ ©« ¡¦§¦å© ¨­é¤"                    Send Activate_V58U
36200>>>                On_Item "&Utilities"                                  Send Activate_GLUTIL
36201>>>                On_Item "&«á©«¨à© ¨ ¦ ¡ãª "                  Send Activate_v071
36202>>>                //On_Item "&¤ ©£æª /¨ £¦ç"                     Send Activate_V058T
36202>>>
36202>>>            End_Pull_Down // Works
36204>>>            Set Status_Help To "¨©åª ¤ ¡ãª ¦ ©« ¡ãª"
36205>>>            
36205>>>            //Set Shadow_State Item 10 to True
36205>>>            
36205>>>    End_Pull_Down //HlpFilesRep
36207>>>    Set Status_Help To "¦« ¡á ¨®å"
36208>>>
36208>>>    //#INCLUDE Text_pm.inc
INCLUDING FILE: NAVI_PM.INC
36208>>>>Use DFDEOMnu
36208>>>>
36208>>>>DFCreate_Menu "&Navigation" NAVIGATE_Menu is a DEOPopupMenu
36212>>>>    On_Item "&Next Area\aF6"            send Switch_Next_Area
36213>>>>        Set Status_Help To  'Move to Next Area'
36214>>>>
36214>>>>    On_Item "&Previous Area\aShift+F6"  send Switch_Prior_Area
36215>>>>        Set Status_Help To  'Move to Previous Area'
36216>>>>
36216>>>>    On_Item "N&ext View\aAlt+F6"        send Switch_Next_View
36217>>>>        Set Status_Help To  'Move to Next View'
36218>>>>
36218>>>>    On_Item "P&revious View\aCtrl+F6"   send Switch_Prior_View
36219>>>>        Set Status_Help To  'Move to Previous View'
36220>>>>
36220>>>>    On_Item ""                          send none
36221>>>>
36221>>>>    On_Item "&List\aF4"               send Prompt
36222>>>>        Set Status_Help To  'Show Selection Lists'
36223>>>>
36223>>>>    On_Item "&Zoom\aAlt+F9"             send Zoom
36224>>>>        Set Status_Help To  'Show Zoom'
36225>>>>
36225>>>>    Procedure OnInitMenu
36227>>>>        Local integer Obj# IsDeo Itm prmpt zm isDeoControl
36228>>>>        Get Focus to Obj#
36229>>>>        Get is_Function Get_DEO_Object Obj# TRUE to IsDeo
36230>>>>        If IsDeo Begin
36232>>>>            Get is_Function Get_DEO_Control_Object Obj# False to IsDeoControl
36233>>>>            If IsDeoControl Begin
36235>>>>                Get Prompt_Object of Obj# to Prmpt
36236>>>>                Get Zoom_Object of Obj# to zm
36237>>>>            End
36237>>>>>
36237>>>>            Set Shadow_state item 0  to False
36238>>>>            Set Shadow_state item 1  to False
36239>>>>            Set Shadow_state item 2  to False
36240>>>>            Set Shadow_state item 3  to False
36241>>>>            Set Shadow_state item 5  to (Prmpt=0)
36242>>>>            Set Shadow_state item 6  to (Zm=0)
36243>>>>        End
36243>>>>>
36243>>>>        Else Begin
36244>>>>            for itm from 0 to 6
36250>>>>>
36250>>>>                set shadow_State item itm to TRUE
36251>>>>            Loop
36252>>>>>
36252>>>>        End
36252>>>>>
36252>>>>    End_Procedure
36253>>>>
36253>>>>End_Pull_Down
36255>>>>Set Status_Help to "Navigation in different areas of the screen"
36256>>>>
36256>>>>
INCLUDING FILE: PRN_PM.INC
36256>>>>
36256>>>>    Procedure pDriver
36258>>>>        Local String Slask
36259>>>>        Get DFGetCurrentDriver of (oWinPrint(Self)) To Slask
36260>>>>        Send Info_Box sLask "The Driver..." MB_ICONINFORMATION
36261>>>>    End_Procedure
36262>>>>
36262>>>>    Procedure pDevice
36264>>>>        Local String Slask
36265>>>>        Get DFGetCurrentDevice of (oWinPrint(Self)) To Slask
36266>>>>        Send Info_Box sLask "The Printer..." MB_ICONINFORMATION
36267>>>>    End_Procedure
36268>>>>
36268>>>>    Procedure pPort
36270>>>>        Local String Slask
36271>>>>        Get DFGetCurrentPort of (oWinPrint(Current_Object)) To Slask
36272>>>>        Send Info_Box sLask "The Port..." MB_ICONINFORMATION
36273>>>>    End_Procedure
36274>>>>
36274>>>>    Procedure pFlags
36276>>>>        Local Dword Slask
36277>>>>        Get DFGetPrintDialogFlags of (oWinPrint(Current_Object)) To Slask
36278>>>>        Send Info_Box sLask "Info" MB_ICONINFORMATION
36279>>>>    End_Procedure
36280>>>>
36280>>>>    Procedure pCheckFlags
36282>>>>        Local Integer Slask
36283>>>>        Get DFCheckPrintDialogFlag of (oWinPrint(Self)) DF_PAPER_A4 To Slask
36284>>>>        If slask Eq PRN_TRUE  Send Info_Box "A4 ok"     "Info" MB_ICONINFORMATION
36287>>>>        If slask Eq PRN_FALSE Send Info_Box "A4 not ok" "Info" MB_ICONINFORMATION
36290>>>>
36290>>>>        Get DFCheckPrintDialogFlag of (oWinPrint(Self)) DF_PAPER_LETTER To Slask
36291>>>>        If slask Eq PRN_TRUE  Send Info_Box "Letter ok"     "Info" MB_ICONINFORMATION
36294>>>>        If slask Eq PRN_FALSE Send Info_Box "Letter not ok" "Info" MB_ICONINFORMATION
36297>>>>    End_Procedure
36298>>>>
36298>>>>    Procedure pSetFlagsA4
36300>>>>        Send DFSetSpecPrintFlag To (oWinPrint(Self)) DF_PAPER_A4
36301>>>>    End_Procedure
36302>>>>
36302>>>>    Procedure pSetFlagsLT
36304>>>>        Send DFSetSpecPrintFlag To (oWinPrint(Self)) DF_PAPER_LETTER
36305>>>>    End_Procedure
36306>>>>
36306>>>>    Procedure pSetFlagsUser
36308>>>>        Send DFSetSpecPrintFlag To (oWinPrint(Self)) DF_PAPER_USER
36309>>>>    End_Procedure
36310>>>>
36310>>>>    Procedure pLen
36312>>>>        Local Number Slask
36313>>>>        Get DFGetUserDefinedLength of (oWinPrint(Self)) To Slask
36314>>>>        Send Info_Box sLask "Info" MB_ICONINFORMATION
36315>>>>    End_Procedure
36316>>>>
36316>>>>    Procedure pWid
36318>>>>        Local Number Slask
36319>>>>        Get DFGetUserDefinedWidth of (oWinPrint(Self)) To Slask
36320>>>>        Send Info_Box sLask "Info" MB_ICONINFORMATION
36321>>>>    End_Procedure
36322>>>>
36322>>>>    Procedure pSize
36324>>>>        Local Number Slask
36325>>>>        Send DFSetUserDefinedPapersize to (oWinPrint(Self)) 18.5 12.5
36326>>>>    End_Procedure
36327>>>>
36327>>>>
36327>>>>        DFCreate_Menu "&Printer" Prg_PullDown is a ViewPopupMenu
36331>>>>
36331>>>>           DFCreate_Menu "Printer &Settings" PRO_PullDown is a ViewPopupMenu
36335>>>>               Set select_mode to Multi_Select
36336>>>>               on_item   "The Driver         " send pDriver        to Self
36337>>>>               on_item   "The Printer        " send pDevice        to Self
36338>>>>               on_item   "The Port           " send pPort          to Self
36339>>>>               on_item   "Get PDFlags        " send pFlags         to Self
36340>>>>               on_item   "Check PDFlags      " send pCheckFlags    to Self
36341>>>>               on_item   "Set Spec Flag A4   " send pSetFlagsA4    to Self
36342>>>>               on_item   "Set Spec Flag LT   " send pSetFlagsLT    to Self
36343>>>>               on_item   "Set Spec Flag USER " send pSetFlagsUser  to Self
36344>>>>               on_item   "Get Len            " send pLen           to Self
36345>>>>               on_item   "Get Wid            " send pWid           to Self
36346>>>>               on_item   "Set pagesize       " send pSize          to Self
36347>>>>           End_Pull_Down
36349>>>>               Set Status_Help To "Printer Settings"
36350>>>>
36350>>>>            on_item   ""                 send none
36351>>>>            on_item   "Printer Settings   "  send DFPrintSetup to (oWinPrint(Self))
36352>>>>            Set Status_Help To ""
36353>>>>            on_item   "Print Preview      "  send DFPreview    to (oWinPrint(Self))
36354>>>>            Set Status_Help To ""
36355>>>>            on_item   "Print              "  send DFPrint      to (oWinPrint(Self))
36356>>>>            Set Status_Help To ""
36357>>>>
36357>>>>        End_Pull_Down
36359>>>>            Set Status_Help To ""
36360>>>>
INCLUDING FILE: WIN_PM.INC
36360>>>>DFCreate_Menu "&Window" Window_Menu
36364>>>>    Set select_mode to Multi_Select
36365>>>>    // normal number of items in pulldown (w/ no active views)
36365>>>>    property integer std_item_count public 0
36367>>>>
36367>>>>    DFCreate_Menu "&Preferences" Display_Options_Menu
36371>>>>        Set select_mode to Multi_Select
36372>>>>        On_Item "&ToolBar"        Send Toggle_Toolbar             To Self
36373>>>>        On_Item "&StatusBar"      Send Toggle_Statusbar           To Self
36374>>>>        On_Item "&Arrange Icons"  Send Toggle_Auto_Arrange_Icons  To Self
36375>>>>
36375>>>>        //  When ever the menu [pulldown] is initialized, check/set
36375>>>>        //  the state of its items.
36375>>>>        //
36375>>>>        Procedure OnInitMenu
36377>>>>            local integer bState
36378>>>>
36378>>>>            Get ToolBar_State to bState
36379>>>>            Set Select_State Item 0 to bState
36380>>>>            if  bState   Set Status_Help Item 0 To '' //'Hide the ToolBar'
36383>>>>            Else         Set Status_Help Item 0 to '' //'Show the ToolBar'
36385>>>>
36385>>>>            Get Statusbar_State to bState
36386>>>>            Set Select_State Item 1 to bState
36387>>>>            if  bState  Set Status_Help Item 1 To ''// 'Hide the StatusBar'
36390>>>>            Else        Set Status_Help Item 1 to ''// 'Show the StatusBar'
36392>>>>
36392>>>>            Get Auto_Arrange_Icons_State to bState
36393>>>>            Set Select_State Item 2 to bState
36394>>>>            if  bState  Set Status_Help Item 2 To '' //'Hide AutoArrange Icons'
36397>>>>            Else        Set Status_Help Item 2 to '' //'Show AutoArrange Icons'
36399>>>>
36399>>>>        End_procedure
36400>>>>
36400>>>>
36400>>>>    End_Pull_Down
36402>>>>    Set Status_Help                                           To '' //"Enable Toolbar, StatusBar, and AutoArrange Icons options"
36403>>>>
36403>>>>    On_Item ""
36404>>>>
36404>>>>    On_Item "&Cascade" send Cascade_Windows                   To Self
36405>>>>        Set Status_Help                                       To ''
36406>>>>
36406>>>>    On_Item "Tile &Horizontally" send Tile_Windows_Horizontal To Self
36407>>>>        Set Status_Help                                       To ''
36408>>>>
36408>>>>    On_Item "Tile &Vertically" send Tile_Windows_Vertical     To Self
36409>>>>        Set Status_Help                                       To ''
36410>>>>
36410>>>>    On_Item ""
36411>>>>
36411>>>>    On_Item "Minimize all" send Minimize_all_Windows          To Current_Object
36412>>>>        Set Status_Help                                       To ''
36413>>>>
36413>>>>    On_Item "&Restore all" send Restore_all_Windows           To Current_Object
36414>>>>        Set Status_Help                                       To ''
36415>>>>
36415>>>>    On_Item ""
36416>>>>
36416>>>>    On_Item "&Arrange Icons" send Arrange_Icons               To Current_Object
36417>>>>        Set Status_Help                                       To ''
36418>>>>
36418>>>>    // set this to the number of items in the menu with no views.
36418>>>>    Set Std_item_count to (item_count(current_object))
36419>>>>
36419>>>>    // add all active views to the end of the menu
36419>>>>    Procedure OnInitMenu
36421>>>>        local integer iStdCnt iNumCnt hVw hCl iCount
36422>>>>        Local string sLbl
36422>>>>        //*** Remove all old view items
36422>>>>        Get Item_count     to iNumCnt
36423>>>>        get Std_item_count to iStdCnt
36424>>>>        For iCount from 1  to (iNumCnt - iStdCnt)
36430>>>>>
36430>>>>            Send Delete_item iStdCnt
36431>>>>        Loop
36432>>>>>
36432>>>>
36432>>>>        Move iStdcnt to iNumCnt
36433>>>>        get Client_id to hCl // object id of client area
36434>>>>        If hCl Begin
36436>>>>           Get Next_Mdi_Dialog of hcl TRUE to hVw // find first view
36437>>>>           While hVw
36441>>>>              if (Active_state(hVw)) Begin
36443>>>>                 if iNumCnt eq iStdCnt Begin // if first view, add separator
36445>>>>                    send add_item 0 ''
36446>>>>                    increment iNumCnt
36447>>>>                 end
36447>>>>>
36447>>>>                 Get Label of hVw to sLbl // caption bar (name) of view
36448>>>>                 // note that all views understand the message activate_view.
36448>>>>                 send add_item msg_activate_view sLbl // set message, value and destination
36449>>>>                 set aux_value item iNumcnt to hVw
36450>>>>                 // if this is the focus view, mark it.
36450>>>>                 If (current_scope(desktop)=hVw and View_mode(hVw)<>VIEWMODE_ICONIZE) ;                     set select_state item iNumCnt to True
36453>>>>                 // create status help
36453>>>>                 Set Status_help item iNumCnt to ("Make this view (" - trim(sLbl) - ") the active window.")
36454>>>>                 increment iNumCnt
36455>>>>              end
36455>>>>>
36455>>>>              Get Next_Mdi_Dialog of hcl FALSE to hVw // find next
36456>>>>           End
36457>>>>>
36457>>>>        End
36457>>>>>
36457>>>>    End_Procedure // OnInitMenu
36458>>>>
36458>>>>End_Pull_Down
36460>>>>Set Status_Help to ''
36461>>>>
INCLUDING FILE: HELP_PM.INC
36461>>>>
36461>>>>Register_Procedure Activate_TipOfDay
36461>>>>
36461>>>>DFCreate_Menu "&Help" Help_Menu
36465>>>>//    on_item "&Context Help"          send Extended_Help
36465>>>>//        Set Status_Help To "Show Context sensitive help."
36465>>>>
36465>>>>//    on_item "&Files Help"            send File_Help
36465>>>>//        Set Status_Help To "Show Files help."
36465>>>>
36465>>>>//    on_item "&Keys Help"             send Keys_Help
36465>>>>//        Set Status_Help To "Show Keys help."
36465>>>>
36465>>>>//    on_item "&Index"                 send Help_Index
36465>>>>//        Set Status_Help To "Show Help Index."
36465>>>>
36465>>>>//    on_item "&Search for Help on..." send Help_on_topic
36465>>>>//        Set Status_Help To "Search for help on a particular subject."
36465>>>>
36465>>>>//    on_item "&How to Use Help"       send Help_For_Help
36465>>>>//        Set Status_Help To "Help on Help. How to use the Help system."
36465>>>>
36465>>>>//    on_item "" send NONE
36465>>>>
36465>>>>    On_Item "&Tips of the Day" send Activate_TipOfDay
36466>>>>        Set Status_Help To "Tips of the Day"
36467>>>>
36467>>>>    on_item "" send NONE
36468>>>>
36468>>>>    On_item "About" Send Activate_About
36469>>>>        Set Status_Help To "System Information"
36470>>>>end_pull_down
36472>>>>Set Status_Help to "Access to the program's help subsystem"
36473>>>>
36473>>>>Register_Procedure Activate_TipOfDay
36473>>>>
36473>>>>
36473>>>>
36473>>>
36473>>>End_Menu // Main_Menu
36475>>>
36475>>>//MNB-StoreStart
36475>>>
36475>>>//Register_Procedure activate_Gplan_View
36475>>>//Register_Procedure activate_R056
36475>>>//Register_Procedure Activate_Gmove_View //Arthro_L
36475>>>//Register_Procedure Protypo_Arthro
36475>>>//Register_Procedure activate_V058A
36475>>>//Register_Procedure activate_R058
36475>>>//Register_Procedure activate_Analkath1_View
36475>>>//Register_Procedure activate_V56V59V60
36475>>>//Register_Procedure activate_R056_1
36475>>>//Register_Procedure ElegxoyIso
36475>>>//Register_Procedure TheorimenoIso
36475>>>//Register_Procedure Theorimenokath
36475>>>//Register_Procedure activate_R058T
36475>>>//Register_Procedure activate_CBY_View
36475>>>//Register_Procedure activate_V53
36475>>>//Register_Procedure activate_V056
36475>>>//Register_Procedure activate_Gtypkin_View
36475>>>//Register_Procedure activate_V888
36475>>>//Register_Procedure activate_Gformat
36475>>>//Register_Procedure activate_V065
36475>>>//Register_Procedure activate_V056C
36475>>>//Register_Procedure Change_Xrhsh
36475>>>//Register_Procedure activate_V58U
36475>>>//Register_Procedure activate_V059U
36475>>>//Register_Procedure activate_V058T
36475>>>//Register_Procedure Activate_Query_vw
36475>>>//Register_Procedure Activate_V063
36475>>>//Register_Procedure Activate_R059
36475>>>//Register_Procedure Activate_V068
36475>>>//Register_Procedure Activate_V054
36475>>>//Register_Procedure Activate_GLUTIL
36475>>>//Register_Procedure Activate_r071
36475>>>//Register_Procedure Activate_v071
36475>>>
36475>>>//Register_Procedure Activate_Types_Maint
36475>>>
36475>>>//MNB-StoreEnd
36475>>>
36475>>>Register_Object Client_Area
36475>    
36475>    Use DFStdBtn.pkg //  Tool-Bar object.
INCLUDING FILE: DFSTDBTN.PKG
36475>>>// 07/23/96 JJT - New Class names
36475>>>// 10/03/97 KCR - removed leading separator
36475>>>
36475>>>Use DFMainBt  // dfMain_ButtonBar
INCLUDING FILE: DFMAINBT.PKG
36475>>>>>//-------------------------------------------------------------------------
36475>>>>>// DFMainBt.pkg - DfMain_ButtonBar class
36475>>>>>//
36475>>>>>//
36475>>>>>// 07/23/96 JJT - New Class names
36475>>>>>//-------------------------------------------------------------------------
36475>>>>>
36475>>>>>Use DfPanel // dfapp_buttonbar
36475>>>>>
36475>>>>>Class ToolBar is a AppToolBar
36476>>>>>
36476>>>>>    Function Is_Function Integer MsgId Integer ObjId Integer DelegateFg Returns Integer
36477>>>>>      Local integer rval MainObj#
36478>>>>>      Get Main_Panel_id to MainObj#
36479>>>>>      If (ObjId>Desktop AND MainObj#) ;         Get Is_Function of MainObj# MsgId ObjId DelegateFg to rVal
36482>>>>>      Function_Return rVal
36483>>>>>    End_Function
36484>>>>>
36484>>>>>    Procedure Redirect_Button_Message integer Itm
36485>>>>>         Local integer Msg# Aux# rval Understood
36486>>>>>         If (Shadow_State(Current_Object,itm)) Procedure_Return
36489>>>>>         Get Message   item itm  to Msg#
36490>>>>>         Get Aux_Value item itm  to Aux#
36491>>>>>         If Msg# Begin
36493>>>>>           If Aux# eq 0 Begin
36495>>>>>              Get Focus to Aux#
36496>>>>>              Get Is_Function Get_DEO_Object Aux# TRUE to Understood
36497>>>>>              If Not Understood Move 0 to Aux#
36500>>>>>           End
36500>>>>>>
36500>>>>>           If Aux# Get Msg# of Aux# to rval
36503>>>>>           Procedure_return rval
36504>>>>>         end
36504>>>>>>
36504>>>>>    End_Procedure // Redirect_Message
36505>>>>>
36505>>>>>End_Class
36506>>>>>
36506>>>>>
36506>>>
36506>>>//  Button bar object.
36506>>>//
36506>>>Object Tool_Bar is a ToolBar
36508>>>
36508>>>    Send ImageList_Add 'bgn.bmp'   // 0
36509>>>    Send ImageList_Add 'end.bmp'   // 1
36510>>>    Send ImageList_Add 'next.bmp'  // 2
36511>>>    Send ImageList_Add 'prev.bmp'  // 3
36512>>>    Send ImageList_Add 'clr.bmp'   // 4
36513>>>    Send ImageList_Add 'clra.bmp'  // 5
36514>>>
36514>>>    send Add_button (ico_user+0) msg_beginning_of_data
36515>>>    Send Add_ToolTip "Beginning of file"
36516>>>    Set  Status_Help To 'Find the First record (Ctrl+Home)'
36517>>>
36517>>>    send Add_button (ico_user+3) msg_find_previous
36518>>>    Send Add_ToolTip "Find Previous"
36519>>>    Set  Status_Help To 'Find the Previous record (F7)'
36520>>>
36520>>>    send Add_button (ico_user+2) msg_find_next
36521>>>    Send Add_ToolTip "Find Next"
36522>>>    Set  Status_Help To 'Find the Next record (F8)'
36523>>>
36523>>>    send Add_button (ico_user+1) msg_end_of_data
36524>>>    Send Add_ToolTip "End of File"
36525>>>    Set  Status_Help To 'Find the Last record (Ctrl+End)'
36526>>>
36526>>>    Send Add_space
36527>>>
36527>>>    send Add_button ico_std_find msg_prompt
36528>>>    Send Add_ToolTip "Prompt"
36529>>>    Set  Status_Help To 'Show available selections (F4)'
36530>>>
36530>>>    send Add_button (ico_user+4) msg_request_clear
36531>>>    Send Add_ToolTip "Clear"
36532>>>    Set  Status_Help To 'Clear current record / Add a new record (F5)'
36533>>>
36533>>>    send Add_button (ico_user+5) msg_request_clear_all
36534>>>    Send Add_ToolTip "Clear All"
36535>>>    Set  Status_Help To 'Clear all data from view (Ctrl+F5)'
36536>>>
36536>>>    send Add_space
36537>>>
36537>>>    send Add_button ico_std_filesave msg_request_save
36538>>>    Send Add_ToolTip "Save"
36539>>>    Set  Status_Help To 'Save the current record (F2)'
36540>>>
36540>>>    send Add_button ico_std_delete msg_request_delete
36541>>>    Send Add_ToolTip "Delete"
36542>>>    Set  Status_Help To 'Delete the current record (Shift+F2)'
36543>>>
36543>>>    send Add_space
36544>>>
36544>>>    send Add_button ico_std_cut msg_cut
36545>>>    Send Add_ToolTip "Cut"
36546>>>    Set  Status_Help to "Cuts the selection and puts it on the Clipboard"
36547>>>
36547>>>    send Add_button ico_std_copy msg_copy
36548>>>    Send Add_ToolTip "Copy"
36549>>>    Set  Status_Help to "Copies the selection and puts it on the Clipboard"
36550>>>
36550>>>    send Add_button ico_std_paste msg_paste
36551>>>    Send Add_ToolTip "Paste"
36552>>>    Set  Status_Help to "Inserts Clipboard contents"
36553>>>
36553>>>End_Object
36554>>>
36554>    
36554>    Object Client_Area is a AppClientAreasub
36556>
36556>        //AB-ClientStoreTopStart
36556>        Open Ctypkin
INCLUDING FILE: CTYPKIN.FD
36558>        Open Wtypkin
36560>        Open Particle
INCLUDING FILE: PARTICLE.FD
36562>        
36562>        Function fngConvertPoso Global String asNomismaCodeApo Number anPoso ;                                       String asNomismaCodeSe  Date   adHmnia;                                       Number nIsotimia  Returns Number
36563>        
36563>            Number rVal nApo_Euro_Isot nSe_Euro_Isot
36564>            Integer iApo_Einai_Euro_Zone iApo_Einai_DRX iApo_Einai_Euro iDekadika_Apo
36564>            Integer iSe_Einai_Euro_Zone  iSe_Einai_DRX  iSe_Einai_Euro  iDekadika_Se
36564>            String  sCode
36564>        
36564>            If (asNomismaCodeApo=asNomismaCodeSe) Function_Return anPoso
36567>        
36567>            Clear Nomisma
36568>            Move (Trim(asNomismaCodeApo)) to Nomisma.Nomisma_Code
36569>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
36570>            Move Nomisma.Euro_Zone      to iApo_Einai_Euro_Zone
36571>            Move Nomisma.Einai_DRX      to iApo_Einai_DRX
36572>            Move Nomisma.Einai_EURO     to iApo_Einai_Euro
36573>            Move Nomisma.KL_ISOT_EURO   to nApo_Euro_Isot
36574>            Move Nomisma.Dekadika       to iDekadika_Apo
36575>            // 1. An to nomisma APO den einai ths zonhs euro prepei na vrethei h isotimia tou
36575>            If ((NOT(iApo_Einai_Euro_Zone)) And (nApo_Euro_Isot=0))  Begin
36577>                If (adHmnia='') Sysdate            adHmnia
36580>                Move (Trim(asNomismaCodeApo))   to sCode
36581>                Clear Isotimia
INCLUDING FILE: ISOTIMIA.FD
36582>                Move sCode                      to Isotimia.Nomisma_Code
36583>                Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
36584>                Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
36585>                Move Isotimia.Isotimia_Euro     to nApo_Euro_Isot
36586>            End
36586>        
36586>            Clear Nomisma
36587>            Move (Trim(asNomismaCodeSe)) to Nomisma.Nomisma_Code
36588>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
36589>            Move Nomisma.Euro_Zone      to iSe_Einai_Euro_Zone
36590>            Move Nomisma.Einai_DRX      to iSe_Einai_DRX
36591>            Move Nomisma.Einai_EURO     to iSe_Einai_Euro
36592>            Move Nomisma.KL_ISOT_EURO   to nSe_Euro_Isot
36593>            Move Nomisma.Dekadika       to iDekadika_Se
36594>            // 2. An to nomisma SE den einai ths zonhs euro prepei na vrethei h isotimia tou
36594>            If ((NOT(iSe_Einai_Euro_Zone)) And (nSe_Euro_Isot=0)) Begin
36596>                If (adHmnia='') Sysdate            adHmnia
36599>                Move (Trim(asNomismaCodeSe))    to sCode
36600>                Clear Isotimia
36601>                Move sCode                      to Isotimia.Nomisma_Code
36602>                Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
36603>                Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
36604>                Move Isotimia.Isotimia_Euro     to nSe_Euro_Isot
36605>            End
36605>        
36605>            Calc (anPoso/nApo_Euro_Isot) to rVal
36606>            Move (Round_Number(rVal,6)) to rVal
36607>            Calc (rVal*nSe_Euro_Isot) to rVal
36608>            Move (Round_Number(rVal,iDekadika_Se)) to rVal
36609>        
36609>            Function_Return rVal
36610>        End_Function
36611>        //AB-ClientStoreTopEnd
36611>
36611>        //  Include all views
36611>        Use GFormat.vw                                                                      
INCLUDING FILE: GFORMAT.VW
36611>>>//AB/ Project GFormat
36611>>>//AB/     Object prj is a View_Project
36611>>>//AB/         Set ProjectName to "GFormat"
36611>>>//AB/         Set ProjectFileName to "GFormat.vw"
36611>>>
36611>>>// Project Object Structure
36611>>>//   GFormat is a dbViewSub
36611>>>//     Syscurgl_DD is a DataDictionary
36611>>>//     Gformat_DD is a DataDictionary
36611>>>//     The_Table is a dbGridSub
36611>>>//     Container1 is a dbContainer3dSub
36611>>>//       Company_Company_name is a dbFormSub
36611>>>//       Branch_Branch_name is a dbFormSub
36611>>>//       Year_Year_year is a dbFormSub
36611>>>//       TextBoxSub1 is a TextBoxSub
36611>>>//       TextBoxSub2 is a TextBoxSub
36611>>>//       TextBoxSub3 is a TextBoxSub
36611>>>
36611>>>// Register all objects
36611>>>Register_Object Branch_Branch_name
36611>>>Register_Object Company_Company_name
36611>>>Register_Object Container1
36611>>>Register_Object GFormat
36611>>>Register_Object Gformat_DD
36611>>>Register_Object Syscurgl_DD
36611>>>Register_Object TextBoxSub1
36611>>>Register_Object TextBoxSub2
36611>>>Register_Object TextBoxSub3
36611>>>Register_Object The_Table
36611>>>Register_Object Year_Year_year
36611>>>
36611>>>
36611>>>//AB/     AppBuild VIEW
36611>>>
36611>>>    //AB-IgnoreStart
36611>>>
36611>>>    Use dbView.Sub
36611>>>    Use DFAllEnt.pkg
36611>>>    Use dbGrid.Sub
36611>>>    Use dbCont3.Sub
36611>>>    Use dbForm.Sub
36611>>>    Use Txtbox.Sub
36611>>>
36611>>>    Use SysCurGL.dd
INCLUDING FILE: SYSCURGL.DD
36611>>>>>//DDB-FileStart
36611>>>>>//DDB-HeaderStart
36611>>>>>
36611>>>>>// File Name : SYSCURGL.DD
36611>>>>>// Class Name: Syscurgl_DataDictionary
36611>>>>>// Revision  : 2
36611>>>>>// Version   : 2
36611>>>>>
36611>>>>>Use  Windows           // Basic Definitions
36611>>>>>Use  DataDict          // DataDictionary Class Definition
36611>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36611>>>>>
36611>>>>>Open Syscurgl
36613>>>>>
36613>>>>>//DDB-HeaderEnd
36613>>>>>
36613>>>>>Class Syscurgl_DataDictionary  is a DataDictionary_Sec
36614>>>>>
36614>>>>>    // Define_Fields:
36614>>>>>    // This procedure is used to set up all data-dictionary rules.
36614>>>>>
36614>>>>>    Procedure Define_Fields
36615>>>>>        Forward Send Define_Fields
36617>>>>>        //DDB-Generated-Code-Location
36617>>>>>        //DDB-DefineFieldStart
36617>>>>>
36617>>>>>        Set Main_File            To Syscurgl.File_Number
36618>>>>>        Set Cascade_Delete_State To FALSE
36619>>>>>
36619>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
36620>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
36621>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
36622>>>>>
36622>>>>>        // Field-based properties.......................
36622>>>>>
36622>>>>>        // Syscurgl.Company_Code
36622>>>>>
36622>>>>>        // Syscurgl.Branch_Code
36622>>>>>
36622>>>>>        // Syscurgl.Year_Year
36622>>>>>
36622>>>>>        // Syscurgl.Branch_Site
36622>>>>>
36622>>>>>        // Syscurgl.Year_Recr
36622>>>>>
36622>>>>>        // Syscurgl.Company_Name
36622>>>>>
36622>>>>>        // Syscurgl.Branch_Name
36622>>>>>
36622>>>>>        // Syscurgl.Year_Descr
36622>>>>>
36622>>>>>        // Syscurgl.C_Code0
36622>>>>>
36622>>>>>        // Syscurgl.C_Code00
36622>>>>>
36622>>>>>        // Syscurgl.C_Coder
36622>>>>>
36622>>>>>        // Syscurgl.Year_Xrhshfrom
36622>>>>>
36622>>>>>        // Syscurgl.Year_Xrhshto
36622>>>>>
36622>>>>>        // Syscurgl.Beto_Site
36622>>>>>
36622>>>>>        // Syscurgl.Euro_Code
36622>>>>>
36622>>>>>        // Syscurgl.Year_Openfrom
36622>>>>>
36622>>>>>        // Syscurgl.Year_Opento
36622>>>>>
36622>>>>>        // Syscurgl.Year_Valid_Char
36622>>>>>
36622>>>>>        // Syscurgl.Year_Delimiter
36622>>>>>
36622>>>>>        //DDB-DefineFieldEnd
36622>>>>>    End_Procedure    // Define_Fields
36623>>>>>
36623>>>>>    // Field_Defaults:
36623>>>>>    // This procedure is used to establish default field values.
36623>>>>>
36623>>>>>    Procedure Field_Defaults
36624>>>>>        Forward Send Field_Defaults
36626>>>>>        //DDB-Generated-Code-Location
36626>>>>>        //DDB-FieldDefaultStart
36626>>>>>        //DDB-FieldDefaultEnd
36626>>>>>    End_Procedure    // Field_Defaults
36627>>>>>
36627>>>>>End_Class    // Syscurgl_DataDictionary
36628>>>>>//DDB-FileEnd
36628>>>    Use GFORMAT.DD
INCLUDING FILE: GFORMAT.DD
36628>>>>>//DDB-FileStart
36628>>>>>//DDB-HeaderStart
36628>>>>>
36628>>>>>// File Name : GFORMAT.DD
36628>>>>>// Class Name: Gformat_DataDictionary
36628>>>>>// Revision  : 18
36628>>>>>// Version   : 2
36628>>>>>
36628>>>>>Use  Windows           // Basic Definitions
36628>>>>>Use  DataDict          // DataDictionary Class Definition
36628>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36628>>>>>
36628>>>>>Open Gformat
INCLUDING FILE: GFORMAT.FD
36630>>>>>Open Sysrecg
36632>>>>>
36632>>>>>//DDB-HeaderEnd
36632>>>>>
36632>>>>>Class Gformat_DataDictionary  is a DataDictionary_Sec
36633>>>>>
36633>>>>>    Procedure Construct_Object
36634>>>>>        Forward Send Construct_Object
36636>>>>>        Property Integer piMustNOTConstrain Public 0
36637>>>>>    End_Procedure   // Construct_Object
36638>>>>>
36638>>>>>    Procedure OnConstrain
36639>>>>>        Forward Send OnConstrain
36641>>>>>        If (piMustNOTConstrain(Self)) Begin
36643>>>>>        End
36643>>>>>>
36643>>>>>        Else Begin
36644>>>>>            Constrain Gformat.Company_Code  eq SysCurGL.Company_Code
36646>>>>>            Constrain Gformat.Branch_Code   eq SysCurGL.Branch_Code
36648>>>>>            Constrain Gformat.Year_Year     eq SysCurGL.Year_Year
36650>>>>>        End
36650>>>>>>
36650>>>>>    End_Procedure
36651>>>>>
36651>>>>>    Procedure Update
36652>>>>>        Forward Send Update
36654>>>>>        // Insert Code Here
36654>>>>>        Move SysCurGL.Company_Code  to Gformat.Company_Code
36655>>>>>        Move SysCurGL.Branch_Code   to Gformat.Branch_Code
36656>>>>>        Move SysCurGL.Year_Year     to Gformat.Year_Year
36657>>>>>        Move SysCurGL.Year_Recr     to Gformat.Year_Recr
36658>>>>>    End_Procedure   // Update
36659>>>>>
36659>>>>>    Procedure Creating
36660>>>>>        Forward Send Creating
36662>>>>>        // Insert Code Here
36662>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gformat.Gformat_Rec0)))))) to Gformat.Gformat_Recr
36663>>>>>    End_Procedure   // Creating
36664>>>>>
36664>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
36665>>>>>         Case Begin
36665>>>>>             Case (iError_Num = 1001)
36667>>>>>                  Error 1001 "DDC 161:¡«á¢¢¢¦ª à ¡æª §¦¡«©«ã£«¦ª!\n\n¤æª à ¡æª"
36668>>>>>>
36668>>>>>             Case Break
36669>>>>>
36669>>>>>             Case Else
36669>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
36671>>>>>        Case End
36671>>>>>    End_Procedure   // Operation_Not_Allowed
36672>>>>>
36672>>>>>    Function Validate_Save  Returns Integer
36673>>>>>        Local Integer iReturnVal
36674>>>>>        Forward Get Validate_Save  To iReturnVal
36676>>>>>        If (Not(iReturnVal)) Begin
36678>>>>>            If (Gformat.Gformat_Code="") Send Operation_Not_Allowed 1001
36681>>>>>        End
36681>>>>>>
36681>>>>>        Function_Return iReturnVal
36682>>>>>    End_Function   // Validate_Save
36683>>>>>
36683>>>>>
36683>>>>>
36683>>>>>
36683>>>>>//    Procedure Creating
36683>>>>>//              Forward Send Creating
36683>>>>>//              Add 1 to Year.Year_NumGformat //¨ £æª ¨­é¤ gformat «ª ®¨ã©ª
36683>>>>>//    End_Procedure //creating
36683>>>>>//    Procedure Deleting
36683>>>>>//              Forward Send Deleting
36683>>>>>//              Sub 1 from Year.Year_NumGformat //¨ £æª ¨­é¤ gformat «ª ®¨ã©ª
36683>>>>>//    End_Procedure //deleting
36683>>>>>
36683>>>>>
36683>>>>>    Procedure Field_Defaults
36684>>>>>        Forward Send Field_Defaults
36686>>>>>        //DDB-Generated-Code-Location
36686>>>>>        //DDB-FieldDefaultStart
36686>>>>>        //DDB-FieldDefaultEnd
36686>>>>>    End_Procedure    // Field_Defaults
36687>>>>>
36687>>>>>    // Define_Fields:
36687>>>>>    // This procedure is used to set up all data-dictionary rules.
36687>>>>>
36687>>>>>    Procedure Define_Fields
36688>>>>>        Forward Send Define_Fields
36690>>>>>        //DDB-Generated-Code-Location
36690>>>>>        //DDB-DefineFieldStart
36690>>>>>
36690>>>>>        Set Main_File            To Gformat.File_Number
36691>>>>>        Set Cascade_Delete_State To FALSE
36692>>>>>
36692>>>>>
36692>>>>>        // External (System) file structure.............
36692>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
36693>>>>>
36693>>>>>        Define_Auto_Increment  Sysrecg.Gformat_Rec0  To Gformat.Gformat_Rec0
36696>>>>>
36696>>>>>        // Field-based properties.......................
36696>>>>>
36696>>>>>        // Gformat.Company_Code
36696>>>>>
36696>>>>>        // Gformat.Branch_Code
36696>>>>>
36696>>>>>        // Gformat.Year_Year
36696>>>>>
36696>>>>>        // Gformat.Gformat_Code
36696>>>>>        Set Field_Options          Field Gformat.Gformat_Code To DD_AUTOFIND   
36697>>>>>        Set Key_Field_State        Field Gformat.Gformat_Code To TRUE
36698>>>>>
36698>>>>>        // Gformat.Gformat_Rec0
36698>>>>>
36698>>>>>        // Gformat.Year_Recr
36698>>>>>
36698>>>>>        // Gformat.Gformat_Mask
36698>>>>>
36698>>>>>        // Gformat.Gformat_Recr
36698>>>>>        Set Field_Options          Field Gformat.Gformat_Recr To DD_AUTOFIND   
36699>>>>>
36699>>>>>        //DDB-DefineFieldEnd
36699>>>>>    End_Procedure    // Define_Fields
36700>>>>>End_Class    // Gformat_DataDictionary
36701>>>>>//DDB-FileEnd
36701>>>    
36701>>>    //AB-IgnoreEnd
36701>>>
36701>>>    ACTIVATE_VIEW Activate_GFormat FOR GFormat
36705>>>
36705>>>    Object GFormat is a dbViewSub
36707>>>
36707>>>        //AB-StoreTopStart
36707>>>                
36707>>>        //AB-StoreTopEnd
36707>>>
36707>>>        Set Label to "á©¡ª ¦ ©« ¡¦ç ®å¦¬"
36708>>>        Set Size to 254 467
36709>>>        Set Location to 8 7
36710>>>
36710>>>        //AB-DDOStart
36710>>>
36710>>>        Object Syscurgl_DD is a SysCurGL_DataDictionary
36712>>>        End_Object    // Syscurgl_DD
36713>>>
36713>>>        Object Gformat_DD is a Gformat_DataDictionary
36715>>>
36715>>>            //AB-StoreStart
36715>>>                                
36715>>>                                
36715>>>                                
36715>>>            //AB-StoreEnd
36715>>>
36715>>>        End_Object    // Gformat_DD
36716>>>
36716>>>        Set Main_DD to (Gformat_DD(self))
36717>>>        Set Server to (Gformat_DD(self))
36718>>>
36718>>>        //AB-DDOEnd
36718>>>
36718>>>        Object The_Table is a dbGridSub
36720>>>            Set Main_File to Gformat.File_Number
36721>>>            Set Size to 171 454
36722>>>            Set Location to 64 4
36723>>>            Set Wrap_State to TRUE
36724>>>
36724>>>            Begin_Row
36727>>>                Entry_Item Gformat.Gformat_code
36728>>>                Entry_Item Gformat.Gformat_mask
36729>>>            End_Row
36734>>>
36734>>>            Set Form_Width    item 0 to 123
36735>>>            Set Header_Label  item 0 to "«¦¨å à ¡¦ç"
36736>>>            
36736>>>            Set Form_Width    item 1 to 322
36737>>>            Set Header_Label  item 1 to "¦¨­ã á©¡ª"
36738>>>            
36738>>>
36738>>>            //AB-StoreStart
36738>>>                                
36738>>>            //***************** Predefined Procedures and Functions Section **************
36738>>>            
36738>>>            Procedure Request_Clear_All
36740>>>            End_Procedure // Request_Clear_All
36741>>>            
36741>>>            //AB-StoreEnd
36741>>>
36741>>>        End_Object    // The_Table
36742>>>
36742>>>        Object Container1 is a dbContainer3dSub
36744>>>            Set Server to (Syscurgl_DD(self))
36745>>>            Set Border_Style to Border_StaticEdge
36746>>>            Set Size to 54 454
36747>>>            Set Location to 5 4
36748>>>            Object Company_Company_name is a dbFormSub
36750>>>                Entry_Item Syscurgl.Company_name
36751>>>                Set Size to 13 366
36752>>>                Set Location to 5 66
36753>>>                Set Color to clBtnFace
36754>>>                Set Label_Col_Offset to 2
36755>>>                Set Label_Justification_Mode to jMode_Right
36756>>>                Set Enabled_State to FALSE
36757>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
36758>>>                Set Item_Shadow_State Item 0 to TRUE
36759>>>                Set Shadow_State Item 0 to TRUE
36760>>>            End_Object    // Company_Company_name
36761>>>
36761>>>            Object Branch_Branch_name is a dbFormSub
36763>>>                Entry_Item Syscurgl.Branch_name
36764>>>                Set Size to 13 366
36765>>>                Set Location to 20 66
36766>>>                Set Color to clBtnFace
36767>>>                Set Label_Col_Offset to 2
36768>>>                Set Label_Justification_Mode to jMode_Right
36769>>>                Set Enabled_State to FALSE
36770>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
36771>>>                Set Item_Shadow_State Item 0 to TRUE
36772>>>                Set Shadow_State Item 0 to TRUE
36773>>>            End_Object    // Branch_Branch_name
36774>>>
36774>>>            Object Year_Year_year is a dbFormSub
36776>>>                Entry_Item Syscurgl.Year_year
36777>>>                Set Size to 13 45
36778>>>                Set Location to 34 66
36779>>>                Set Color to clBtnFace
36780>>>                Set Label_Col_Offset to 2
36781>>>                Set Label_Justification_Mode to jMode_Right
36782>>>                Set Enabled_State to FALSE
36783>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
36784>>>                Set Item_Shadow_State Item 0 to TRUE
36785>>>                Set Shadow_State Item 0 to TRUE
36786>>>
36786>>>                //AB-StoreStart
36786>>>                                            
36786>>>                //AB-StoreEnd
36786>>>
36786>>>            End_Object    // Year_Year_year
36787>>>
36787>>>            Object TextBoxSub1 is a TextBoxSub
36789>>>                Set Label to "« ¨å:"
36790>>>                Set Auto_Size_State to FALSE
36791>>>                Set FontSize to 4 0
36792>>>                Set Location to 4 4
36793>>>                Set Size to 13 57
36794>>>                Set TypeFace to "MS Sans Serif"
36795>>>                Set Enabled_State to TRUE
36796>>>            End_Object    // TextBoxSub1
36797>>>
36797>>>            Object TextBoxSub2 is a TextBoxSub
36799>>>                Set Label to "§¦¡«á©«£:"
36800>>>                Set Auto_Size_State to FALSE
36801>>>                Set FontSize to 4 0
36802>>>                Set Location to 18 4
36803>>>                Set Size to 13 57
36804>>>                Set TypeFace to "MS Sans Serif"
36805>>>                Set Enabled_State to TRUE
36806>>>            End_Object    // TextBoxSub2
36807>>>
36807>>>            Object TextBoxSub3 is a TextBoxSub
36809>>>                Set Label to "¨ã©:"
36810>>>                Set Auto_Size_State to FALSE
36811>>>                Set FontSize to 4 0
36812>>>                Set Location to 33 4
36813>>>                Set Size to 13 57
36814>>>                Set TypeFace to "MS Sans Serif"
36815>>>                Set Enabled_State to TRUE
36816>>>            End_Object    // TextBoxSub3
36817>>>
36817>>>        End_Object    // Container1
36818>>>
36818>>>
36818>>>        //AB-StoreStart
36818>>>                
36818>>>                
36818>>>        //AB-StoreEnd
36818>>>
36818>>>    End_Object    // GFormat
36819>>>
36819>>>//AB/     End_Object    // prj
36819>        Use Fpa.vw                                                                          
INCLUDING FILE: FPA.VW
36819>>>//AB/ Project Fpa
36819>>>//AB/     Object prj is a View_Project
36819>>>//AB/         Set ProjectName to "Fpa"
36819>>>//AB/         Set ProjectFileName to "Fpa.vw"
36819>>>//AB/         Set GenerateFileName to "Fpa.vw"
36819>>>
36819>>>// Project Object Structure
36819>>>//   Fpa is a dbViewSub
36819>>>//     Fpa_DD is a DataDictionary
36819>>>//     dbGridSub1 is a dbGridSub
36819>>>
36819>>>// Register all objects
36819>>>Register_Object dbGridSub1
36819>>>Register_Object Fpa
36819>>>Register_Object Fpa_DD
36819>>>
36819>>>
36819>>>//AB/     AppBuild VIEW
36819>>>
36819>>>    //AB-IgnoreStart
36819>>>
36819>>>    Use dbView.Sub
36819>>>    Use DFAllEnt.pkg
36819>>>    Use dbGrid.Sub
36819>>>
36819>>>    Use FPA.DD
INCLUDING FILE: FPA.DD
36819>>>>>//DDB-FileStart
36819>>>>>//DDB-HeaderStart
36819>>>>>
36819>>>>>// File Name : FPA.DD
36819>>>>>// Class Name: Fpa_DataDictionary
36819>>>>>// Revision  : 32
36819>>>>>// Version   : 2
36819>>>>>
36819>>>>>Use  Windows           // Basic Definitions
36819>>>>>Use  DataDict          // DataDictionary Class Definition
36819>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36819>>>>>
36819>>>>>Open Fpa
INCLUDING FILE: FPA.FD
36821>>>>>Open Iteml
36823>>>>>Open Partlfpa
INCLUDING FILE: PARTLFPA.FD
36825>>>>>Open Item
INCLUDING FILE: ITEM.FD
36827>>>>>
36827>>>>>//DDB-HeaderEnd
36827>>>>>//DDB-SelectionStart
36827>>>>>//DDB/ ExternalSelectionList Fpa  Fpa.SL
36827>>>>>//DDB/ ExternalSelectionList sl150  sl150.SL
36827>>>>>Register_Object Fpa
36827>>>>>Register_Object sl150
36827>>>>>//DDB-SelectionEnd
36827>>>>>
36827>>>>>Class Fpa_DataDictionary  is a DataDictionary_Sec
36828>>>>> 
36828>>>>>    // Validate_Save:
36828>>>>> 
36828>>>>>    Function Validate_Save  Returns Integer
36829>>>>>        Local Integer iReturnVal icheck
36830>>>>>        Forward Get Validate_Save  To iReturnVal
36832>>>>>        If (Not(iReturnVal)) Begin
36834>>>>>            // Insert Code Here
36834>>>>>         //  if (fpa.agora_codegl <> '') begin
36834>>>>>         //     Move (Check_log(fpa.agora_codegl)) to iCheck  
36834>>>>>         //     if (icheck) Move 104001 to iReturnVal 
36834>>>>>         //  end
36834>>>>>         //  if (fpa.polhsh_codegl <> '') begin
36834>>>>>         //     Move (Check_log(fpa.polhsh_codegl)) to iCheck  
36834>>>>>         //     if (icheck) Move 104002 to iReturnVal
36834>>>>>         //  end   
36834>>>>>         //  If (iReturnVal) Send Operation_Not_Allowed iReturnVal
36834>>>>>        End
36834>>>>>>
36834>>>>>        Function_Return iReturnVal
36835>>>>>    End_Function   // Validate_Save
36836>>>>> 
36836>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
36837>>>>>        String lsError_Message
36838>>>>>        Case Begin
36838>>>>>            Case (iError_Num = 104001)
36840>>>>>                Move "DDC 104: ¤ç§¨¡«¦ª ¢¦. . .. ¦¨é¤" to lsError_Message
36841>>>>>              Case Break
36842>>>>>            Case (iError_Num = 104002)
36845>>>>>                Move "DDC 104: ¤ç§¨¡«¦ª ¢¦. . .. §à¢ã©à¤" to lsError_Message
36846>>>>>              Case Break
36847>>>>>            Case Else
36847>>>>>                Forward Send Operation_Not_Allowed iError_Num
36849>>>>>        Case End
36849>>>>>        Error iError_Num lsError_Message
36850>>>>>>
36850>>>>>    End_Procedure // operation_not_allowed
36851>>>>>
36851>>>>>    // Define_Fields:
36851>>>>>    // This procedure is used to set up all data-dictionary rules.
36851>>>>>
36851>>>>>    Procedure Define_Fields
36852>>>>>        Forward Send Define_Fields
36854>>>>>        //DDB-Generated-Code-Location
36854>>>>>        //DDB-DefineFieldStart
36854>>>>>
36854>>>>>        Set Main_File            To Fpa.File_Number
36855>>>>>        Set Cascade_Delete_State To FALSE
36856>>>>>
36856>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
36857>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
36858>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
36859>>>>>
36859>>>>>        // Child (Client) file structure................
36859>>>>>        Send Add_Client_File  Iteml.File_Number
36860>>>>>        Send Add_Client_File  Partlfpa.File_Number
36861>>>>>        Send Add_Client_File  Item.File_Number
36862>>>>>
36862>>>>>        // Field-based properties.......................
36862>>>>>
36862>>>>>        // Fpa.Fpa_Pososto
36862>>>>>        Set Field_Options          Field Fpa.Fpa_Pososto To DD_AUTOFIND    DD_FINDREQ    
36863>>>>>        Set Field_Prompt_Object    Field Fpa.Fpa_Pososto To (Fpa(Self))
36864>>>>>        Set Key_Field_State        Field Fpa.Fpa_Pososto To TRUE
36865>>>>>
36865>>>>>        // Fpa.Fpa_Descr
36865>>>>>        Set Field_Options          Field Fpa.Fpa_Descr To DD_AUTOFIND   
36866>>>>>        Set Field_Prompt_Object    Field Fpa.Fpa_Descr To (Fpa(Self))
36867>>>>>
36867>>>>>        // Fpa.Agora_Codegl
36867>>>>>        Set Field_Prompt_Object    Field Fpa.Agora_Codegl To (sl150(Self))
36868>>>>>
36868>>>>>        // Fpa.Polhsh_Codegl
36868>>>>>
36868>>>>>        //DDB-DefineFieldEnd
36868>>>>>    End_Procedure    // Define_Fields
36869>>>>>
36869>>>>>    // Field_Defaults:
36869>>>>>    // This procedure is used to establish default field values.
36869>>>>>
36869>>>>>    Procedure Field_Defaults
36870>>>>>        Forward Send Field_Defaults
36872>>>>>        //DDB-Generated-Code-Location
36872>>>>>        //DDB-FieldDefaultStart
36872>>>>>        //DDB-FieldDefaultEnd
36872>>>>>    End_Procedure    // Field_Defaults
36873>>>>>
36873>>>>>End_Class    // Fpa_DataDictionary
36874>>>>>//DDB-Selection-pkg-Start
36874>>>>>
36874>>>>>Use Fpa.SL           // Fpa
INCLUDING FILE: FPA.SL
36874>>>>>>>//AB/ Project Fpa:Lookup
36874>>>>>>>//AB/ Object prj is a Lookup_Project
36874>>>>>>>//AB/     Set ProjectName to "Fpa:Lookup"
36874>>>>>>>//AB/     Set ProjectFileName to "Fpa.SL"
36874>>>>>>>
36874>>>>>>>// Project Object Structure
36874>>>>>>>//   Fpa is a dbModalPanelSub
36874>>>>>>>//     Fpa_DD is a DataDictionary
36874>>>>>>>//     oSelList is a dbListSub
36874>>>>>>>//     oOK_bn is a ButtonSub
36874>>>>>>>//     oCancel_bn is a ButtonSub
36874>>>>>>>//     oSearch_bn is a ButtonSub
36874>>>>>>>
36874>>>>>>>// Register all objects
36874>>>>>>>Register_Object Fpa
36874>>>>>>>Register_Object Fpa_DD
36874>>>>>>>Register_Object oCancel_bn
36874>>>>>>>Register_Object oOK_bn
36874>>>>>>>Register_Object oSearch_bn
36874>>>>>>>Register_Object oSelList
36874>>>>>>>
36874>>>>>>>
36874>>>>>>>//AB-IgnoreStart
36874>>>>>>>
36874>>>>>>>Use DFAllEnt.pkg
36874>>>>>>>Use dbList.Sub
36874>>>>>>>Use Button.Sub
36874>>>>>>>
36874>>>>>>>
36874>>>>>>>Use FPA.DD
36874>>>>>>>
36874>>>>>>>//AB-IgnoreEnd
36874>>>>>>>
36874>>>>>>>CD_Popup_Object Fpa is a dbModalPanelSub
36893>>>>>>>    set label to "¦©¦©«á ..." 
36894>>>>>>>    Set Size to 148 181
36895>>>>>>>    Set Location to 4 5
36896>>>>>>>    Set Exit_Application_Local_State to FALSE
36897>>>>>>>    Set Modal_State to FALSE
36898>>>>>>>
36898>>>>>>>    //AB-DDOStart
36898>>>>>>>
36898>>>>>>>    Object Fpa_DD is a Fpa_DataDictionary
36900>>>>>>>    End_Object    // Fpa_DD
36901>>>>>>>
36901>>>>>>>    Set Main_DD to (Fpa_DD(self))
36902>>>>>>>    Set Server to (Fpa_DD(self))
36903>>>>>>>
36903>>>>>>>    //AB-DDOEnd
36903>>>>>>>
36903>>>>>>>    Object oSelList is a dbListSub
36905>>>>>>>        Set Main_File to Fpa.File_Number
36906>>>>>>>        Set Size to 105 165
36907>>>>>>>        Set Location to 6 6
36908>>>>>>>
36908>>>>>>>        Begin_Row
36911>>>>>>>            Entry_Item Fpa.Fpa_pososto
36912>>>>>>>            Entry_Item Fpa.Fpa_descr
36913>>>>>>>        End_Row
36918>>>>>>>
36918>>>>>>>        Set Form_Width    item 0 to 66
36919>>>>>>>        set header_label  item 0 to "% " 
36920>>>>>>>        
36920>>>>>>>        Set Form_Width    item 1 to 90
36921>>>>>>>        set header_label  item 1 to "¨ ¨­ã" 
36922>>>>>>>        
36922>>>>>>>    End_Object    // oSelList
36923>>>>>>>
36923>>>>>>>    Object oOK_bn is a ButtonSub
36925>>>>>>>        set label to "&§ ¢¦ã" 
36926>>>>>>>        Set Size to 14 46
36927>>>>>>>        Set Location to 113 26
36928>>>>>>>
36928>>>>>>>        //AB-StoreStart
36928>>>>>>>        Procedure OnClick
36930>>>>>>>            Send OK To (oSelList(current_object))
36931>>>>>>>        End_Procedure
36932>>>>>>>        //AB-StoreEnd
36932>>>>>>>
36932>>>>>>>    End_Object    // oOK_bn
36933>>>>>>>
36933>>>>>>>    Object oCancel_bn is a ButtonSub
36935>>>>>>>        set label to "&¡ç¨à©" 
36936>>>>>>>        Set Size to 14 46
36937>>>>>>>        Set Location to 113 75
36938>>>>>>>
36938>>>>>>>        //AB-StoreStart
36938>>>>>>>        Procedure OnClick
36940>>>>>>>            Send Cancel To (oSelList(current_object))
36941>>>>>>>        End_Procedure
36942>>>>>>>        //AB-StoreEnd
36942>>>>>>>
36942>>>>>>>    End_Object    // oCancel_bn
36943>>>>>>>
36943>>>>>>>    Object oSearch_bn is a ButtonSub
36945>>>>>>>        set label to "&¤ã«©" 
36946>>>>>>>        Set Size to 14 46
36947>>>>>>>        Set Location to 113 126
36948>>>>>>>
36948>>>>>>>        //AB-StoreStart
36948>>>>>>>        Procedure OnClick
36950>>>>>>>            Send Search To (oSelList(current_object))
36951>>>>>>>        End_Procedure
36952>>>>>>>        //AB-StoreEnd
36952>>>>>>>
36952>>>>>>>    End_Object    // oSearch_bn
36953>>>>>>>
36953>>>>>>>
36953>>>>>>>    //AB-StoreStart
36953>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
36954>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
36955>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
36956>>>>>>>    //AB-StoreEnd
36956>>>>>>>
36956>>>>>>>CD_End_Object    // Fpa
36958>>>>>>>>
36958>>>>>>>
36958>>>>>>>//AB/ End_Object    // prj
36958>>>>>Use sl150.SL         // sl150
INCLUDING FILE: SL150.SL
36958>>>>>>>//AB/ Project sl150:GL Gplan
36958>>>>>>>//AB/     Object prj is a Lookup_Project
36958>>>>>>>//AB/         Set ProjectName to "sl150:GL Gplan"
36958>>>>>>>//AB/         Set ProjectFileName to "sl150.SL"
36958>>>>>>>
36958>>>>>>>// Project Object Structure
36958>>>>>>>//   sl150 is a dbModalPanelSub
36958>>>>>>>//     Gplan_DD is a DataDictionary
36958>>>>>>>//     oSelList is a dbListSub
36958>>>>>>>//     oOK_bn is a Button
36958>>>>>>>//     oCancel_bn is a Button
36958>>>>>>>//     oSearch_bn is a Button
36958>>>>>>>
36958>>>>>>>// Register all objects
36958>>>>>>>Register_Object Gplan_DD
36958>>>>>>>Register_Object oCancel_bn
36958>>>>>>>Register_Object oOK_bn
36958>>>>>>>Register_Object oSearch_bn
36958>>>>>>>Register_Object oSelList
36958>>>>>>>Register_Object sl150
36958>>>>>>>
36958>>>>>>>
36958>>>>>>>    //AB-IgnoreStart
36958>>>>>>>
36958>>>>>>>    Use DFAllEnt.pkg
36958>>>>>>>    Use dbList.Sub
36958>>>>>>>
36958>>>>>>>
36958>>>>>>>    Use GPLAN.DD
INCLUDING FILE: GPLAN.DD
36958>>>>>>>>>//DDB-FileStart
36958>>>>>>>>>//DDB-HeaderStart
36958>>>>>>>>>
36958>>>>>>>>>// File Name : GPLAN.DD
36958>>>>>>>>>// Class Name: Gplan_DataDictionary
36958>>>>>>>>>// Revision  : 123
36958>>>>>>>>>// Version   : 2
36958>>>>>>>>>
36958>>>>>>>>>Use  Windows           // Basic Definitions
36958>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
36958>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36958>>>>>>>>>
36958>>>>>>>>>Open Gplan
36960>>>>>>>>>Open Gmovea
INCLUDING FILE: GMOVEA.FD
36962>>>>>>>>>Open Gplanmod
INCLUDING FILE: GPLANMOD.FD
36964>>>>>>>>>Open Gmhnes
INCLUDING FILE: GMHNES.FD
36966>>>>>>>>>Open Gmove
INCLUDING FILE: GMOVE.FD
36968>>>>>>>>>Open Gpmoves
INCLUDING FILE: GPMOVES.FD
36970>>>>>>>>>Open Gvatd
INCLUDING FILE: GVATD.FD
36972>>>>>>>>>Open Sysrecg
36974>>>>>>>>>Open Syscurgl
36976>>>>>>>>>
36976>>>>>>>>>//DDB-HeaderEnd
36976>>>>>>>>>//DDB-ValidationStart
36976>>>>>>>>>
36976>>>>>>>>>Register_Object Gplan_Gplan_O_Code_VT
36976>>>>>>>>>Register_Object Gplan_Gplan_Yn_VT
36976>>>>>>>>>Register_Object Gplan_Gplan_Xpm_VT
36976>>>>>>>>>Register_Object Gplan_Gplan_Doy_VT
36976>>>>>>>>>Register_Object Gplan_Gplan_J_Code_VT
36976>>>>>>>>>Register_Object Gplan_Gplan_C_Code2_VT
36976>>>>>>>>>Register_Object Gplan_Gplan_I_A_Code_VT2
36976>>>>>>>>>Register_Object Gplan_Gplan_Myf_Sum_VT
36976>>>>>>>>>
36976>>>>>>>>>Object Gplan_Gplan_O_Code_VT  is a CodeValidationTable
36978>>>>>>>>>    Set Type_Value        To "OMADA"
36979>>>>>>>>>    Set Allow_Blank_State To TRUE
36980>>>>>>>>>    //DDB-ValidationCustomStart
36980>>>>>>>>>    //DDB-ValidationCustomEnd
36980>>>>>>>>>End_Object   // Gplan_Gplan_O_Code_VT
36981>>>>>>>>>
36981>>>>>>>>>Object Gplan_Gplan_Yn_VT  is a CodeValidationTable
36983>>>>>>>>>    Set Type_Value        To "YESNO"
36984>>>>>>>>>    //DDB-ValidationCustomStart
36984>>>>>>>>>    //DDB-ValidationCustomEnd
36984>>>>>>>>>End_Object   // Gplan_Gplan_Yn_VT
36985>>>>>>>>>
36985>>>>>>>>>Object Gplan_Gplan_Xpm_VT  is a DescriptionValidationTable
36987>>>>>>>>>
36987>>>>>>>>>    Procedure Fill_List
36989>>>>>>>>>        Forward Send Fill_List
36991>>>>>>>>>        Send Add_Table_Value  "1"  "¨¦ç£¤¦ª"
36992>>>>>>>>>        Send Add_Table_Value  "2"  " ©«¦ç£¤¦ª"
36993>>>>>>>>>        Send Add_Table_Value  "3"  " ¡«æª"
36994>>>>>>>>>    End_Procedure    // Fill_List
36995>>>>>>>>>    //DDB-ValidationCustomStart
36995>>>>>>>>>    //DDB-ValidationCustomEnd
36995>>>>>>>>>End_Object   // Gplan_Gplan_Xpm_VT
36996>>>>>>>>>
36996>>>>>>>>>Object Gplan_Gplan_Doy_VT  is a CodeValidationTable
36998>>>>>>>>>    Set Type_Value        To "DOY"
36999>>>>>>>>>    Set Allow_Blank_State To TRUE
37000>>>>>>>>>    //DDB-ValidationCustomStart
37000>>>>>>>>>    //DDB-ValidationCustomEnd
37000>>>>>>>>>End_Object   // Gplan_Gplan_Doy_VT
37001>>>>>>>>>
37001>>>>>>>>>Object Gplan_Gplan_J_Code_VT  is a CodeValidationTable
37003>>>>>>>>>    Set Type_Value        To "JOB"
37004>>>>>>>>>    Set Allow_Blank_State To TRUE
37005>>>>>>>>>    //DDB-ValidationCustomStart
37005>>>>>>>>>    //DDB-ValidationCustomEnd
37005>>>>>>>>>End_Object   // Gplan_Gplan_J_Code_VT
37006>>>>>>>>>
37006>>>>>>>>>Object Gplan_Gplan_C_Code2_VT  is a CodeValidationTable
37008>>>>>>>>>    Set Type_Value        To "CURRENCY"
37009>>>>>>>>>    Set Allow_Blank_State To TRUE
37010>>>>>>>>>    //DDB-ValidationCustomStart
37010>>>>>>>>>    //DDB-ValidationCustomEnd
37010>>>>>>>>>End_Object   // Gplan_Gplan_C_Code2_VT
37011>>>>>>>>>
37011>>>>>>>>>Object Gplan_Gplan_I_A_Code_VT2  is a CodeValidationTable
37013>>>>>>>>>    Set Type_Value        To "AITIOL"
37014>>>>>>>>>    Set Allow_Blank_State To TRUE
37015>>>>>>>>>    //DDB-ValidationCustomStart
37015>>>>>>>>>    //DDB-ValidationCustomEnd
37015>>>>>>>>>End_Object   // Gplan_Gplan_I_A_Code_VT2
37016>>>>>>>>>
37016>>>>>>>>>Object Gplan_Gplan_Myf_Sum_VT  is a CodeValidationTable
37018>>>>>>>>>    Set Type_Value        To "MYF"
37019>>>>>>>>>    //DDB-ValidationCustomStart
37019>>>>>>>>>    //DDB-ValidationCustomEnd
37019>>>>>>>>>End_Object   // Gplan_Gplan_Myf_Sum_VT
37020>>>>>>>>>//DDB-ValidationEnd
37020>>>>>>>>>//DDB-SelectionStart
37020>>>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.sl
37020>>>>>>>>>//DDB/ ExternalSelectionList Gtypkin  Gtypkin.sl
37020>>>>>>>>>Register_Object sl150
37020>>>>>>>>>Register_Object Gtypkin
37020>>>>>>>>>//DDB-SelectionEnd
37020>>>>>>>>>Use arrays.Sub
37020>>>>>>>>>
37020>>>>>>>>>Use Gmovea.dd //®¨ á«  ¦§àã§¦«,  æ«  å¤  alias file ¡ 
INCLUDING FILE: GMOVEA.DD
37020>>>>>>>>>>>//DDB-FileStart
37020>>>>>>>>>>>//DDB-HeaderStart
37020>>>>>>>>>>>
37020>>>>>>>>>>>// File Name : GMOVEA.DD
37020>>>>>>>>>>>// Class Name: Gmovea_DataDictionary
37020>>>>>>>>>>>// Revision  : 17
37020>>>>>>>>>>>// Version   : 2
37020>>>>>>>>>>>
37020>>>>>>>>>>>Use  Windows           // Basic Definitions
37020>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
37020>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37020>>>>>>>>>>>
37020>>>>>>>>>>>Open Gmovea
37022>>>>>>>>>>>Open Gopen
INCLUDING FILE: GOPEN.FD
37024>>>>>>>>>>>Open Garticl
INCLUDING FILE: GARTICL.FD
37026>>>>>>>>>>>Open Gplan
37028>>>>>>>>>>>
37028>>>>>>>>>>>//DDB-HeaderEnd
37028>>>>>>>>>>>
37028>>>>>>>>>>>//open master file
37028>>>>>>>>>>>Open Gmove
37030>>>>>>>>>>>
37030>>>>>>>>>>>//define alias-master condition
37030>>>>>>>>>>>Set_Attribute DF_FILE_ALIAS of Gmovea.File_Number to DF_FILE_IS_ALIAS
37033>>>>>>>>>>>Set_Attribute DF_FILE_ALIAS of Gmove.File_Number  to DF_FILE_IS_MASTER
37036>>>>>>>>>>>
37036>>>>>>>>>>>//clear all relationships from the alias file
37036>>>>>>>>>>>Set_Relate Gmovea.Garticl_Recr to |FN0,0
37037>>>>>>>>>>>>
37037>>>>>>>>>>>Set_Relate Gmovea.Gplan_Recr   to |FN0,0
37038>>>>>>>>>>>>
37038>>>>>>>>>>>
37038>>>>>>>>>>>
37038>>>>>>>>>>>Class Gmovea_DataDictionary  is a DataDictionary_Sec
37039>>>>>>>>>>>
37039>>>>>>>>>>>
37039>>>>>>>>>>>      //private
37039>>>>>>>>>>>      //¤£¨é¤  « 13 §å open item
37039>>>>>>>>>>>      //¡¢å«  §æ update
37039>>>>>>>>>>>      Procedure private.Do_Compute_Open_Itemsa
37040>>>>>>>>>>>                Case Begin
37040>>>>>>>>>>>                     Case (Gmovea.Gmove_X0 > 0) //«æ­ ¦ ®¨à©« ¡æ record
37042>>>>>>>>>>>                          Move "+"                                                 to Gmovea.Gmove_Topen
37043>>>>>>>>>>>                          Move (     Gmovea.Gmove_X0  - Gmovea.Gmove_Open_Sx0) to Gmovea.Gmove_Open_Yx0
37044>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yp0
37045>>>>>>>>>>>                     Case Break
37046>>>>>>>>>>>
37046>>>>>>>>>>>                     Case (Gmovea.Gmove_X0 < 0) //¯¬«¦- ®¨à©« ¡æ record
37049>>>>>>>>>>>                          Move "-"                                                 to Gmovea.Gmove_Topen
37050>>>>>>>>>>>                          Move ((Abs(Gmovea.Gmove_X0))- Gmovea.Gmove_Open_Sp0) to Gmovea.Gmove_Open_Yp0
37051>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yx0
37052>>>>>>>>>>>                     Case Break
37053>>>>>>>>>>>
37053>>>>>>>>>>>                     Case (Gmovea.Gmove_P0 > 0) //«æ­ ¦ § ©«à« ¡æ record
37056>>>>>>>>>>>                          Move "-"                                                 to Gmovea.Gmove_Topen
37057>>>>>>>>>>>                          Move (     Gmovea.Gmove_P0  - Gmovea.Gmove_Open_Sp0) to Gmovea.Gmove_Open_Yp0
37058>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yx0
37059>>>>>>>>>>>                     Case Break
37060>>>>>>>>>>>
37060>>>>>>>>>>>                     Case (Gmovea.Gmove_P0 < 0) //¯ç«¦- ®¨à©« ¡æ record
37063>>>>>>>>>>>                          Move "+"                                                 to Gmovea.Gmove_Topen
37064>>>>>>>>>>>                          Move ((Abs(Gmovea.Gmove_P0))- Gmovea.Gmove_Open_Sx0) to Gmovea.Gmove_Open_Yx0
37065>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yp0
37066>>>>>>>>>>>                     Case Break
37067>>>>>>>>>>>                Case End
37067>>>>>>>>>>>      End_Procedure //private.do_compute_open_itemsa
37068>>>>>>>>>>>
37068>>>>>>>>>>>
37068>>>>>>>>>>>
37068>>>>>>>>>>>      //private
37068>>>>>>>>>>>      //¢â®  « 13 §å open item
37068>>>>>>>>>>>      //¡¢å«  §æ validate save
37068>>>>>>>>>>>      Function  private.fi_Validate_Open_Itemsa Returns Integer
37069>>>>>>>>>>>
37069>>>>>>>>>>>                 //1101+1102+1103+1104:â¢®¦  £ã ¨¤« ¡é¤ ¬§¦¢¦å§à¤ §¨¦ª ©¬©®â« © ¡  ©¬©®« ©â¤«à¤ §¦©é¤
37069>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 >= 0                       )) Function_Return 1101
37072>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 >= 0                       )) Function_Return 1102
37075>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 >= 0                       )) Function_Return 1103
37078>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 >= 0                       )) Function_Return 1104
37081>>>>>>>>>>>
37081>>>>>>>>>>>                 Case Begin
37081>>>>>>>>>>>                      //1105+1106+1107+1108:â¢®¦    «æ­ ¦ ®¨à©« ¡æ record
37081>>>>>>>>>>>                      Case (Gmovea.Gmove_X0 > 0)
37083>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 <=      Gmovea.Gmove_X0  )) Function_Return 1105
37086>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 <=      Gmovea.Gmove_X0  )) Function_Return 1106
37089>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0  = 0                       )) Function_Return 1107
37092>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0  = 0                       )) Function_Return 1108
37095>>>>>>>>>>>                      Case Break
37096>>>>>>>>>>>                      //1109+1110+1111+1112:â¢®¦    ¯¬«¦- ®¨à©« ¡æ record
37096>>>>>>>>>>>                      Case (Gmovea.Gmove_X0 < 0)
37099>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0  = 0                       )) Function_Return 1109
37102>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0  = 0                       )) Function_Return 1110
37105>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 <= (Abs(Gmovea.Gmove_X0)))) Function_Return 1111
37108>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 <= (Abs(Gmovea.Gmove_X0)))) Function_Return 1112
37111>>>>>>>>>>>                      Case Break
37112>>>>>>>>>>>                      //1113+1114+1115+1116:â¢®¦    «æ­ ¦ § ©«à« ¡æ record
37112>>>>>>>>>>>                      Case (Gmovea.Gmove_P0 > 0)
37115>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0  = 0                       )) Function_Return 1113
37118>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0  = 0                       )) Function_Return 1114
37121>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 <=      Gmovea.Gmove_P0  )) Function_Return 1115
37124>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 <=      Gmovea.Gmove_P0  )) Function_Return 1116
37127>>>>>>>>>>>                      Case Break
37128>>>>>>>>>>>                      //1117+1118+1119+1120:â¢®¦    ¯ç«¦- ®¨à©« ¡æ record
37128>>>>>>>>>>>                      Case (Gmovea.Gmove_P0 < 0)
37131>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 <= (Abs(Gmovea.Gmove_P0)))) Function_Return 1117
37134>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 <= (Abs(Gmovea.Gmove_P0)))) Function_Return 1118
37137>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0  = 0                       )) Function_Return 1119
37140>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0  = 0                       )) Function_Return 1120
37143>>>>>>>>>>>                      Case Break
37144>>>>>>>>>>>                 Case End
37144>>>>>>>>>>>
37144>>>>>>>>>>>                 Function_Return 0 //æ¢ ok
37145>>>>>>>>>>>      End_Function //private.fi_validate_open_itemsa
37146>>>>>>>>>>>
37146>>>>>>>>>>>    Procedure Update
37147>>>>>>>>>>>          Send private.Do_Compute_Open_Itemsa
37148>>>>>>>>>>>    End_Procedure //update
37149>>>>>>>>>>>
37149>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
37150>>>>>>>>>>>              String lsError_Message
37151>>>>>>>>>>>              Case Begin
37151>>>>>>>>>>>                   //§æ validate save
37151>>>>>>>>>>>                   Case (iError_Num = 1101)
37153>>>>>>>>>>>                        Move ("DDC 067:¡«á¢¢¢ ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        "¦ ©¬©®â« ©«¦ ®¨à©« ¡æ ¬§æ¢¦ §¦ å¤  ¨¤« ¡æ !");                        to lsError_Message
37154>>>>>>>>>>>                   Case Break
37155>>>>>>>>>>>                   Case (iError_Num = 1102)
37158>>>>>>>>>>>                        Move ("DDC 067:¡«á¢¢¢ ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        "¦ ©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ å¤  ¨¤« ¡æ !");                        to lsError_Message
37159>>>>>>>>>>>                   Case Break
37160>>>>>>>>>>>                   Case (iError_Num = 1103)
37163>>>>>>>>>>>                        Move ("DDC 067:¡«á¢¢¢ ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        " ¡á¢¬¯ «ª ®¨âà©ª å¤  ¨¤« ¡ã !");                        to lsError_Message
37164>>>>>>>>>>>                   Case Break
37165>>>>>>>>>>>                   Case (iError_Num = 1104)
37168>>>>>>>>>>>                        Move ("DDC 067:¡«á¢¢¢ ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        " ¡á¢¬¯ «ª §å©«à©ª å¤  ¨¤« ¡ã !");                        to lsError_Message
37169>>>>>>>>>>>                   Case Break
37170>>>>>>>>>>>                   //---------------------------------------« ¡âª ®¨é© ª-----------------
37170>>>>>>>>>>>                   Case (iError_Num = 1105)
37173>>>>>>>>>>>                        Move ("DDC 067:¡«á¢¢¢ ¨à©« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        "¦ ©¬©®â« ©«¦ ®¨à©« ¡æ ¬§æ¢¦ §¦ ¬§¨å¤  «¤ ¦¢ ¡ã ®¨âà© !");                        to lsError_Message
37174>>>>>>>>>>>                   Case Break
37175>>>>>>>>>>>                   Case (iError_Num = 1106)
37178>>>>>>>>>>>                        Move ("DDC 067:¡«á¢¢¢ ¨à©« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        " ¡á¢¬¯ «ª ®¨âà©ª ¬§¨å¤  «¤ ¦¢ ¡ã ®¨âà© !");                        to lsError_Message
37179>>>>>>>>>>>                   Case Break
37180>>>>>>>>>>>                   Case (iError_Num = 1107)
37183>>>>>>>>>>>                        Move ("DDC 067:¡«á¢¢¢ ¨à©« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        "¦ ©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ â¤ å¤  £¤ ¡æ !");                        to lsError_Message
37184>>>>>>>>>>>                   Case Break
37185>>>>>>>>>>>                   Case (iError_Num = 1108)
37188>>>>>>>>>>>                        Move ("DDC 067:¡«á¢¢¢ ¨à©« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        " ¡á¢¬¯ «ª §å©«à©ª â¤ å¤  £¤ ¡ã !");                        to lsError_Message
37189>>>>>>>>>>>                   Case Break
37190>>>>>>>>>>>                   //---------------------------------------¨¤« ¡âª ®¨é© ª---------------
37190>>>>>>>>>>>                   Case (iError_Num = 1109)
37193>>>>>>>>>>>                        Move ("DDC 067:¡«á¢¢¢ ¨¤« ¡ã ¨à©« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        "¦ ©¬©®â« ©«¦ ®¨à©« ¡æ ¬§æ¢¦ §¦ â¤ å¤  £¤ ¡æ!");                        to lsError_Message
37194>>>>>>>>>>>                   Case Break
37195>>>>>>>>>>>                   Case (iError_Num = 1110)
37198>>>>>>>>>>>                        Move ("DDC 067:¡«á¢¢¢ ¨¤« ¡ã ¨à©« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        " ¡á¢¬¯ «ª ®¨âà©ª â¤ å¤  £¤ ¡ã !");                        to lsError_Message
37199>>>>>>>>>>>                   Case Break
37200>>>>>>>>>>>                   Case (iError_Num = 1111)
37203>>>>>>>>>>>                        Move ("DDC 067:¡«á¢¢¢ ¨¤« ¡ã ¨à©« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        "¦ ©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§¨å¤  «¤ §æ¢¬« « £ã «ª ¨¤« ¡ãª ®¨âà©ª !");                        to lsError_Message
37204>>>>>>>>>>>                   Case Break
37205>>>>>>>>>>>                   Case (iError_Num = 1112)
37208>>>>>>>>>>>                        Move ("DDC 067:¡«á¢¢¢ ¨¤« ¡ã ¨à©« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        " ¡á¢¬¯ «ª §å©«à©ª ¬§¨å¤  «¤ §æ¢¬« « £ã «ª ¨¤« ¡ãª ®¨âà©ª !");                        to lsError_Message
37209>>>>>>>>>>>                   Case Break
37210>>>>>>>>>>>                   //---------------------------------------« ¡âª § ©«é© ª----------------
37210>>>>>>>>>>>                   Case (iError_Num = 1113)
37213>>>>>>>>>>>                        Move ("DDC 067:¡«á¢¢¢  ©«à« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        "¦ ©¬©®â« ©«¦ ®¨à©« ¡æ ¬§æ¢¦ §¦ â¤ å¤  £¤ ¡æ !");                        to lsError_Message
37214>>>>>>>>>>>                   Case Break
37215>>>>>>>>>>>                   Case (iError_Num = 1114)
37218>>>>>>>>>>>                        Move ("DDC 067:¡«á¢¢¢  ©«à« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        " ¡á¢¬¯ «ª ®¨âà©ª â¤ å¤  £¤ ¡ã !");                        to lsError_Message
37219>>>>>>>>>>>                   Case Break
37220>>>>>>>>>>>                   Case (iError_Num = 1115)
37223>>>>>>>>>>>                        Move ("DDC 067:¡«á¢¢¢  ©«à« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        "¦ ©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§¨å¤  «¤ ¦¢ ¡ã §å©«à© !");                        to lsError_Message
37224>>>>>>>>>>>                   Case Break
37225>>>>>>>>>>>                   Case (iError_Num = 1116)
37228>>>>>>>>>>>                        Move ("DDC 067:¡«á¢¢¢  ©«à« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        " ¡á¢¬¯ «ª §å©«à©ª ¬§¨å¤  «¤ ¦¢ ¡ã §å©«à© !");                        to lsError_Message
37229>>>>>>>>>>>                   Case Break
37230>>>>>>>>>>>                   //---------------------------------------¨à« ¡âª § ©«é© ª----------------
37230>>>>>>>>>>>                   Case (iError_Num = 1117)
37233>>>>>>>>>>>                        Move ("DDC 067:¡«á¢¢¢ ¨¤« ¡ã  ©«à« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        "¦ ©¬©®â« ©«¦ ®¨à©« ¡æ ¬§æ¢¦ §¦ â¤ å¤  £¤ ¡æ!");                        to lsError_Message
37234>>>>>>>>>>>                   Case Break
37235>>>>>>>>>>>                   Case (iError_Num = 1118)
37238>>>>>>>>>>>                        Move ("DDC 067:¡«á¢¢¢ ¨¤« ¡ã  ©«à« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        " ¡á¢¬¯ «ª ®¨âà©ª â¤ å¤  £¤ ¡ã !");                        to lsError_Message
37239>>>>>>>>>>>                   Case Break
37240>>>>>>>>>>>                   Case (iError_Num = 1119)
37243>>>>>>>>>>>                        Move ("DDC 067:¡«á¢¢¢ ¨¤« ¡ã  ©«à« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        "¦ ©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§¨å¤  «¤ §æ¢¬« « £ã «ª ¨¤« ¡ãª §å©«à©ª !");                        to lsError_Message
37244>>>>>>>>>>>                   Case Break
37245>>>>>>>>>>>                   Case (iError_Num = 1120) //soso ayto den xoraei display stin othoni !
37248>>>>>>>>>>>                        Move ("DDC 067:¡«á¢¢¢ ¨¤« ¡ã  ©«à« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        " ¡á¢¬¯ «ª §å©«à©ª ¬§¨å¤  «¤ §æ¢¬« « £ã «ª ¨¤« ¡ãª §å©«à©ª !");                        to lsError_Message
37249>>>>>>>>>>>                   Case Break
37250>>>>>>>>>>>
37250>>>>>>>>>>>
37250>>>>>>>>>>>                   //§æ validate delete
37250>>>>>>>>>>>                   Case (iError_Num = 2001)
37253>>>>>>>>>>>                        Move ("DDC 067:ç¤«   ¨­ã!\n\n¨¡¢é ¡¢â©« «¤ Solution !");                        to lsError_Message
37254>>>>>>>>>>>                   Case Break
37255>>>>>>>>>>>
37255>>>>>>>>>>>                   Case Else
37255>>>>>>>>>>>                        Forward Send Operation_Not_Allowed iError_Num
37257>>>>>>>>>>>              Case End
37257>>>>>>>>>>>
37257>>>>>>>>>>>              Error iError_Num lsError_Message
37258>>>>>>>>>>>>
37258>>>>>>>>>>>    End_Procedure   //operation_not_allowed
37259>>>>>>>>>>>
37259>>>>>>>>>>>
37259>>>>>>>>>>>    Function Validate_Save Returns Integer
37260>>>>>>>>>>>             Integer iReturnVal liOpen_Itemsa
37261>>>>>>>>>>>             Forward Get Validate_Save to iReturnVal
37263>>>>>>>>>>>
37263>>>>>>>>>>>             If (Not(iReturnVal));             Begin
37265>>>>>>>>>>>             //1101-1120:â¢®¦  open item
37265>>>>>>>>>>>              Move (private.fi_Validate_Open_Itemsa(Self)) to liOpen_Itemsa
37266>>>>>>>>>>>              If (liOpen_Itemsa <> 0) Send Operation_Not_Allowed liOpen_Itemsa
37269>>>>>>>>>>>             End //«â¢¦ª ¡é ¡ validation
37269>>>>>>>>>>>>
37269>>>>>>>>>>>
37269>>>>>>>>>>>
37269>>>>>>>>>>>             Function_Return iReturnVal
37270>>>>>>>>>>>    End_Function //validate_save
37271>>>>>>>>>>>
37271>>>>>>>>>>>
37271>>>>>>>>>>>    //2001:«¦ alias Gmovea â¤ § «¨â§          ¨­ã
37271>>>>>>>>>>>    Function Validate_Delete  Returns Integer
37272>>>>>>>>>>>             Send Operation_Not_Allowed 2001 //¢á¦ª «¦¬ ¡é ¡ !!!
37273>>>>>>>>>>>    End_Function //validate_delete
37274>>>>>>>>>>>
37274>>>>>>>>>>>
37274>>>>>>>>>>>    // Define_Fields:
37274>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
37274>>>>>>>>>>>
37274>>>>>>>>>>>    Procedure Define_Fields
37275>>>>>>>>>>>        Forward Send Define_Fields
37277>>>>>>>>>>>        //DDB-Generated-Code-Location
37277>>>>>>>>>>>        //DDB-DefineFieldStart
37277>>>>>>>>>>>
37277>>>>>>>>>>>        Set Main_File            To Gmovea.File_Number
37278>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
37279>>>>>>>>>>>
37279>>>>>>>>>>>
37279>>>>>>>>>>>        // Child (Client) file structure................
37279>>>>>>>>>>>        Send Add_Client_File  Gopen.File_Number
37280>>>>>>>>>>>
37280>>>>>>>>>>>        // Parent (Server) file structure...............
37280>>>>>>>>>>>        Send Add_Server_File  Garticl.File_Number
37281>>>>>>>>>>>        Send Add_Server_File  Gplan.File_Number
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Field-based properties.......................
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Company_Code
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Branch_Code
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Year_Year
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gtypkin_Code
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Garticl_Hmnia
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Garticl_No
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Garticl_Recr
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gplan_Recr
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Rec0
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gplan_Code
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Aitiol
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_X0
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_P0
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_X0k
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_P0k
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_X00
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_P00
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_X00k
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_P00k
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_X1
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_P1
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_X2
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_P2
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_X2k
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_P2k
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Xr
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Pr
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Xrk
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Prk
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Dlixis
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_A_Code
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gthhmgio_Code
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Aa
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx0
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp0
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx0
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp0
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx1
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp1
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx1
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp1
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx2
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp2
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx2
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp2
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Sc_Code2
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Open
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Aopen
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Topen
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Kk
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gthhmgio_Period
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gplan_Yn_Myfp
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gplan_Yn_Myfa
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gplan_Myf_Sump
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gplan_Myf_Suma
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gtypkin_Flag01
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gtypkin_Flag02
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gtypkin_Flag03
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gtypkin_Flag04
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gtypkin_Flag05
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gtypkin_Flag06
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gtypkin_Flag07
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gtypkin_Flag08
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gtypkin_Flag09
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gtypkin_Flag10
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gtypkin_Flag11
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gtypkin_Flag12
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gtypkin_Flag13
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gtypkin_Flag14
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gtypkin_Flag15
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gtypkin_Flag16
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gtypkin_Flag17
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gtypkin_Flag18
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gtypkin_Flag19
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gtypkin_Flag20
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Year_Recr
37282>>>>>>>>>>>
37282>>>>>>>>>>>        // Gmovea.Gmove_Recr
37282>>>>>>>>>>>
37282>>>>>>>>>>>        //DDB-DefineFieldEnd
37282>>>>>>>>>>>    End_Procedure    // Define_Fields
37283>>>>>>>>>>>
37283>>>>>>>>>>>    // Field_Defaults:
37283>>>>>>>>>>>    // This procedure is used to establish default field values.
37283>>>>>>>>>>>
37283>>>>>>>>>>>    Procedure Field_Defaults
37284>>>>>>>>>>>        Forward Send Field_Defaults
37286>>>>>>>>>>>        //DDB-Generated-Code-Location
37286>>>>>>>>>>>        //DDB-FieldDefaultStart
37286>>>>>>>>>>>        //DDB-FieldDefaultEnd
37286>>>>>>>>>>>    End_Procedure    // Field_Defaults
37287>>>>>>>>>>>End_Class    // Gmovea_DataDictionary
37288>>>>>>>>>>>//DDB-FileEnd
37288>>>>>>>>>              //©«¤ begin_transaction §¨¦¡¢å deadlock
37288>>>>>>>>>
37288>>>>>>>>>Class Gplan_DataDictionary  is a DataDictionary_Sec
37289>>>>>>>>>
37289>>>>>>>>>    Procedure Construct_Object
37290>>>>>>>>>        Forward Send Construct_Object
37292>>>>>>>>>        Object oarrayGplan_Aux is a cPinakas
37294>>>>>>>>>        End_Object
37295>>>>>>>>>        Property Integer pioarray_Gplan_Aux (oarrayGplan_Aux(self))
37296>>>>>>>>>        Property String psValidChars ""
37297>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
37298>>>>>>>>>    End_Procedure   // Construct_Object
37299>>>>>>>>>
37299>>>>>>>>>    Procedure OnConstrain
37300>>>>>>>>>        Forward Send OnConstrain
37302>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
37304>>>>>>>>>        End
37304>>>>>>>>>>
37304>>>>>>>>>        Else Begin
37305>>>>>>>>>            Constrain Gplan.Company_Code  eq SysCurGL.Company_Code
37307>>>>>>>>>            Constrain Gplan.Branch_Code   eq SysCurGL.Branch_Code
37309>>>>>>>>>            Constrain Gplan.Year_Year     eq SysCurGL.Year_Year
37311>>>>>>>>>        End
37311>>>>>>>>>>
37311>>>>>>>>>    End_Procedure
37312>>>>>>>>>
37312>>>>>>>>>    Procedure Update
37313>>>>>>>>>        Forward Send Update
37315>>>>>>>>>        // Insert Code Here
37315>>>>>>>>>        Move SysCurGL.Company_Code  to Gplan.Company_Code
37316>>>>>>>>>        Move SysCurGL.Branch_Code   to Gplan.Branch_Code
37317>>>>>>>>>        Move SysCurGL.Year_Year     to Gplan.Year_Year
37318>>>>>>>>>        Move SysCurGL.Year_Recr     to Gplan.Year_Recr
37319>>>>>>>>>    End_Procedure   // Update
37320>>>>>>>>>
37320>>>>>>>>>    Procedure Creating
37321>>>>>>>>>        Forward Send Creating
37323>>>>>>>>>        // Insert Code Here
37323>>>>>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gplan.Gplan_Rec0)))))) to Gplan.Gplan_Recr
37324>>>>>>>>>    End_Procedure   // Creating
37325>>>>>>>>>
37325>>>>>>>>>
37325>>>>>>>>>//////////////////////////////////////
37325>>>>>>>>>//////////////////////////////////////
37325>>>>>>>>>
37325>>>>>>>>>    Function fiCheckValidChars String asGplanCode String asValChars Returns Integer
37326>>>>>>>>>        String lsChar
37327>>>>>>>>>        Integer liLen liCharPos rVal
37327>>>>>>>>>        If (asGplanCode <> "") Begin
37329>>>>>>>>>            Move (Trim(asGplanCode)) to asGplanCode
37330>>>>>>>>>            Move (Length(asGplanCode)) to liLen
37331>>>>>>>>>            For liCharPos From 1 to liLen
37337>>>>>>>>>>
37337>>>>>>>>>               Move (Mid(asGplanCode,1,liCharPos)) to lsChar
37338>>>>>>>>>               If (Not(asValChars contains lsChar)) Begin
37340>>>>>>>>>                    Set psValidChars to asValChars
37341>>>>>>>>>                    Function_Return 1001
37342>>>>>>>>>               End
37342>>>>>>>>>>
37342>>>>>>>>>            Loop
37343>>>>>>>>>>
37343>>>>>>>>>        End
37343>>>>>>>>>>
37343>>>>>>>>>        Function_Return rVal
37344>>>>>>>>>    End_Function // fiCheckValidChars
37345>>>>>>>>>
37345>>>>>>>>>    // private_Do_Restore_Fields:
37345>>>>>>>>>    Procedure private_Do_Restore_Fields for Gplan_DataDictionary
37346>>>>>>>>>        // Insert Code Here
37346>>>>>>>>>        Local Integer lioarray_Gplan_Aux##
37347>>>>>>>>>        Local Integer liFile##
37347>>>>>>>>>        Local Integer liField_Count##
37347>>>>>>>>>        Local Integer liField_Type##
37347>>>>>>>>>        Local Integer liField##
37347>>>>>>>>>
37347>>>>>>>>>        Get pioarray_Gplan_Aux to lioarray_Gplan_Aux##
37348>>>>>>>>>        Get Main_File to liFile##
37349>>>>>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of liFile## to liField_Count##
37352>>>>>>>>>
37352>>>>>>>>>
37352>>>>>>>>>        For liField## from 0 to (liField_Count##-1)
37358>>>>>>>>>>
37358>>>>>>>>>            //Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
37358>>>>>>>>>            move liField## to Fieldindex
37359>>>>>>>>>            Get Array_Value of lioarray_Gplan_Aux## Item (liField##+1) to Gplan.Company_Code&
37360>>>>>>>>>        Loop
37361>>>>>>>>>>
37361>>>>>>>>>        Send Delete_Data to lioarray_Gplan_Aux##
37362>>>>>>>>>    End_Procedure   // private_Do_Restore_Fields
37363>>>>>>>>>
37363>>>>>>>>>    // private_Do_Keep_Fields:
37363>>>>>>>>>
37363>>>>>>>>>    Procedure private_Do_Keep_Fields for Gplan_DataDictionary
37364>>>>>>>>>        // Insert Code Here
37364>>>>>>>>>        Local Integer lioarray_Gplan_Aux##
37365>>>>>>>>>        Local Integer liFile##
37365>>>>>>>>>        Local Integer liField_Count##
37365>>>>>>>>>        Local Integer liField_Type##
37365>>>>>>>>>        Local Integer liField##
37365>>>>>>>>>
37365>>>>>>>>>        Get pioarray_Gplan_Aux to lioarray_Gplan_Aux##
37366>>>>>>>>>        Get Main_File to liFile##
37367>>>>>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of liFile## to liField_Count##
37370>>>>>>>>>
37370>>>>>>>>>        Send Delete_Data to lioarray_Gplan_Aux##
37371>>>>>>>>>        Send Add_Item to lioarray_Gplan_Aux## 0 //sos.sos
37372>>>>>>>>>
37372>>>>>>>>>        For liField## from 0 to (liField_Count##-1)
37378>>>>>>>>>>
37378>>>>>>>>>            //Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
37378>>>>>>>>>            move liField## to Fieldindex
37379>>>>>>>>>            Send Add_Item to lioarray_Gplan_Aux## Gplan.Company_Code&
37380>>>>>>>>>        Loop
37381>>>>>>>>>>
37381>>>>>>>>>    End_Procedure   // private_Do_Keep_Fields
37382>>>>>>>>>
37382>>>>>>>>>    // Request_Save:
37382>>>>>>>>>
37382>>>>>>>>>
37382>>>>>>>>>
37382>>>>>>>>>//-----------------------------------------------------------------------------
37382>>>>>>>>>    FUNCTION Compute_Bathmos for Gplan_DataDictionary STRING KODIKOS## RETURNS INTEGER
37383>>>>>>>>>             LOCAL INTEGER BATHMOS##
37384>>>>>>>>>             REPEAT
37384>>>>>>>>>>
37384>>>>>>>>>                   REPLACE "." IN KODIKOS## WITH ""
37386>>>>>>>>>                   [FOUND] INCREMENT BATHMOS##
37387>>>>>>>>>             UNTIL (FINDERR=1)
37389>>>>>>>>>             FUNCTION_RETURN (BATHMOS##+1)
37390>>>>>>>>>    END_FUNCTION //compute_bathmos
37391>>>>>>>>>
37391>>>>>>>>>    FUNCTION Find_Previous for Gplan_DataDictionary STRING LS_CODE1## RETURNS STRING
37392>>>>>>>>>        LOCAL STRING LS_TEMP_CODE1## LS_TEMP_CODE2##
37393>>>>>>>>>        LOCAL INTEGER LI_COUNTER##
37393>>>>>>>>>
37393>>>>>>>>>        FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_CODE1##))
37399>>>>>>>>>>
37399>>>>>>>>>             INSERT (MID(LS_CODE1##,1,LI_COUNTER##)) IN LS_TEMP_CODE1## AT 1
37401>>>>>>>>>        LOOP
37402>>>>>>>>>>
37402>>>>>>>>>        MOVE (RIGHT(LS_TEMP_CODE1##,(LENGTH(LS_TEMP_CODE1##)-(POS(".",LS_TEMP_CODE1##))))) ;             TO LS_TEMP_CODE1##
37403>>>>>>>>>        FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_TEMP_CODE1##))
37409>>>>>>>>>>
37409>>>>>>>>>            INSERT (MID(LS_TEMP_CODE1##,1,LI_COUNTER##)) IN LS_TEMP_CODE2## AT 1
37411>>>>>>>>>        LOOP
37412>>>>>>>>>>
37412>>>>>>>>>        FUNCTION_RETURN LS_TEMP_CODE2##
37413>>>>>>>>>    END_FUNCTION
37414>>>>>>>>>
37414>>>>>>>>>    FUNCTION fiCheck_Format STRING  LS_CODE1##;                            STRING  LS_MASK##;                            INTEGER LI_BATHMOS##;                            RETURNS INTEGER
37415>>>>>>>>>             String  LS_TEMP_CODE1## LS_TEMP_CODE2## LS_MASK2##
37416>>>>>>>>>             Integer LI_COUNTER## LI_BATHMOS1##
37416>>>>>>>>>             Move (Trim(ls_Code1##)) to ls_Code1##
37417>>>>>>>>>             Move (Trim(ls_Mask##))  to ls_Mask##
37418>>>>>>>>>             FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_MASK##))
37424>>>>>>>>>>
37424>>>>>>>>>                  IF ((MID(LS_MASK##,1,LI_COUNTER##)) = ".") INCREMENT LI_BATHMOS1##
37427>>>>>>>>>                  IF (LI_BATHMOS1## < LI_BATHMOS##) ;                  INSERT (MID(LS_MASK##,1,LI_COUNTER##)) IN LS_MASK2## AT LI_COUNTER##
37431>>>>>>>>>             LOOP
37432>>>>>>>>>>
37432>>>>>>>>>             IF (;                  (LENGTH(LS_CODE1##)) <> (LENGTH(LS_MASK2##));                ) FUNCTION_RETURN 1000
37435>>>>>>>>>             FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_MASK2##))
37441>>>>>>>>>>
37441>>>>>>>>>                  IF (;                      ((MID(LS_MASK2##,1,LI_COUNTER##)) = ".") AND;                      ((MID(LS_CODE1##,1,LI_COUNTER##)) <> ".");                     ) FUNCTION_RETURN 1000
37444>>>>>>>>>             LOOP
37445>>>>>>>>>>
37445>>>>>>>>>             FUNCTION_RETURN 0
37446>>>>>>>>>    END_FUNCTION //fiCHECK_FORMAT
37447>>>>>>>>>
37447>>>>>>>>>    Function fiBackward_Check for Gplan_DataDictionary String LsGplanCode_Back integer liBathmos Returns Integer
37448>>>>>>>>>        Integer liGplan_Yn_Last
37449>>>>>>>>>        Number liGplanRecnum
37449>>>>>>>>>        String LsSearch_CodePrevious
37449>>>>>>>>>
37449>>>>>>>>>        if (liBathmos > 1) begin
37451>>>>>>>>>
37451>>>>>>>>>            move (Current_Record(Self)) to liGplanRecnum
37452>>>>>>>>>            move gplan.Gplan_Yn_Last to liGplan_Yn_Last
37453>>>>>>>>>            Send private_Do_Keep_Fields
37454>>>>>>>>>
37454>>>>>>>>>            Move (Find_Previous(self,lsGplanCode_Back)) to lsSearch_CodePrevious
37455>>>>>>>>>
37455>>>>>>>>>            clear Gplan
37456>>>>>>>>>            move gs_Selected_Company_Code  to Gplan.Company_Code
37457>>>>>>>>>            move gs_Selected_Branch_Code   to Gplan.Branch_Code
37458>>>>>>>>>            move gi_Selected_Year          to Gplan.Year_Year
37459>>>>>>>>>            move lsSearch_CodePrevious     to Gplan.Gplan_Code
37460>>>>>>>>>            Find eq Gplan by index.1 // pkid
37461>>>>>>>>>>
37461>>>>>>>>>            If (Found = 0) begin
37463>>>>>>>>>                clear gplan
37464>>>>>>>>>                move liGplanRecnum to gplan.recnum
37465>>>>>>>>>                find eq gplan.recnum
37466>>>>>>>>>>
37466>>>>>>>>>                Send private_Do_Restore_Fields
37467>>>>>>>>>                Function_return  7001 //return to fiValidate
37468>>>>>>>>>            end
37468>>>>>>>>>>
37468>>>>>>>>>            else begin
37469>>>>>>>>>               // The  previous logar marked last  and current greater bathmos
37469>>>>>>>>>               if   (Gplan.Gplan_yn_Last = 1) begin
37471>>>>>>>>>                   Send private_Do_Restore_Fields
37472>>>>>>>>>                   Function_return 7003
37473>>>>>>>>>               end
37473>>>>>>>>>>
37473>>>>>>>>>               clear gplan
37474>>>>>>>>>               move liGplanRecnum to gplan.recnum
37475>>>>>>>>>               find eq gplan.recnum
37476>>>>>>>>>>
37476>>>>>>>>>               Send private_Do_Restore_Fields
37477>>>>>>>>>               function_Return 0 //ok
37478>>>>>>>>>            end
37478>>>>>>>>>>
37478>>>>>>>>>        end
37478>>>>>>>>>>
37478>>>>>>>>>        Function_Return 0
37479>>>>>>>>>    End_Function  // fiBackward_Check
37480>>>>>>>>>    //-----------------------------------------------------------------------------
37480>>>>>>>>>
37480>>>>>>>>>
37480>>>>>>>>>    //-----------------------------------------------------------------------------
37480>>>>>>>>>    FUNCTION fiForward_Check for Gplan_DataDictionary STRING LS_GplanCode integer liMode Returns Integer
37481>>>>>>>>>        String lsNext_Anoep
37482>>>>>>>>>        Integer liGplan_Yn_Last
37482>>>>>>>>>        Number liGplanRecnum
37482>>>>>>>>>
37482>>>>>>>>>
37482>>>>>>>>>        //move gplan.recnum to liGplanRecnum
37482>>>>>>>>>        move (Current_Record(Self)) to liGplanRecnum
37483>>>>>>>>>        move gplan.Gplan_Code to lsNext_Anoep
37484>>>>>>>>>        move gplan.Gplan_Yn_Last to liGplan_Yn_Last
37485>>>>>>>>>        Send private_Do_Keep_Fields
37486>>>>>>>>>
37486>>>>>>>>>        if (liGplan_Yn_Last = 1)  begin
37488>>>>>>>>>            find gt gplan by index.1
37489>>>>>>>>>>
37489>>>>>>>>>            if (found = 0) begin
37491>>>>>>>>>                clear gplan
37492>>>>>>>>>                move liGplanRecnum to gplan.recnum
37493>>>>>>>>>                find eq gplan.recnum
37494>>>>>>>>>>
37494>>>>>>>>>                Send private_Do_Restore_Fields
37495>>>>>>>>>            end
37495>>>>>>>>>>
37495>>>>>>>>>            else begin
37496>>>>>>>>>                // The Current and the previous logar marked last
37496>>>>>>>>>                if (Gplan.Gplan_Anoep = lsNext_Anoep) begin
37498>>>>>>>>>                    clear gplan
37499>>>>>>>>>                    move liGplanRecnum to gplan.recnum
37500>>>>>>>>>                    find eq gplan.recnum
37501>>>>>>>>>>
37501>>>>>>>>>                    Send private_Do_Restore_Fields
37502>>>>>>>>>                    Function_return 7004
37503>>>>>>>>>                end
37503>>>>>>>>>>
37503>>>>>>>>>                else begin
37504>>>>>>>>>                    clear gplan
37505>>>>>>>>>                    move liGplanRecnum to gplan.recnum
37506>>>>>>>>>                    find eq gplan.recnum
37507>>>>>>>>>>
37507>>>>>>>>>                    Send private_Do_Restore_Fields
37508>>>>>>>>>                end
37508>>>>>>>>>>
37508>>>>>>>>>            end
37508>>>>>>>>>>
37508>>>>>>>>>        end
37508>>>>>>>>>>
37508>>>>>>>>>
37508>>>>>>>>>        if (liMode = 1) begin
37510>>>>>>>>>            find gt gplan by index.1
37511>>>>>>>>>>
37511>>>>>>>>>            if (Found = 0) begin
37513>>>>>>>>>                clear gplan
37514>>>>>>>>>                move liGplanRecnum to gplan.recnum
37515>>>>>>>>>                find eq gplan.recnum
37516>>>>>>>>>>
37516>>>>>>>>>                Send private_Do_Restore_Fields
37517>>>>>>>>>            end
37517>>>>>>>>>>
37517>>>>>>>>>            else begin
37518>>>>>>>>>                if (Gplan.Gplan_Anoep = lsNext_Anoep) begin
37520>>>>>>>>>                    move liGplanRecnum to gplan.recnum
37521>>>>>>>>>                    find eq gplan.recnum
37522>>>>>>>>>>
37522>>>>>>>>>                    Send private_Do_Restore_Fields
37523>>>>>>>>>                    Function_return 7010 //called from validate delete
37524>>>>>>>>>                end
37524>>>>>>>>>>
37524>>>>>>>>>                move liGplanRecnum to gplan.recnum
37525>>>>>>>>>                find eq gplan.recnum
37526>>>>>>>>>>
37526>>>>>>>>>                //Send private_Do_Restore_Fields
37526>>>>>>>>>            end
37526>>>>>>>>>>
37526>>>>>>>>>        end
37526>>>>>>>>>>
37526>>>>>>>>>        Function_return 0
37527>>>>>>>>>    End_Function // fiForward_Check
37528>>>>>>>>>
37528>>>>>>>>>
37528>>>>>>>>>    Function private_Man_Gplan_Code for Gplan_DataDictionary integer liField## String lsGplan_Code integer liModeGplan Returns Integer
37529>>>>>>>>>
37529>>>>>>>>>        // Insert Code Here
37529>>>>>>>>>        Integer liCounter liPosition liLength liBathmos liRetVal
37530>>>>>>>>>        string lsMask lsCkeckChar lsSearchCode
37530>>>>>>>>>
37530>>>>>>>>>        Trim lsGplan_code to lsGplan_code
37531>>>>>>>>>>
37531>>>>>>>>>        Move lsGplan_Code to lsSearchCode
37532>>>>>>>>>    Search_Again:
37532>>>>>>>>>        clear Gformat
37533>>>>>>>>>        move SysCurGL.Company_Code  to Gformat.Company_Code
37534>>>>>>>>>        move SysCurGL.Branch_Code   to Gformat.Branch_Code
37535>>>>>>>>>        move SysCurGL.Year_Year     to Gformat.Year_Year
37536>>>>>>>>>        move lsSearchCode           to Gformat.Gformat_Code
37537>>>>>>>>>        Find eq Gformat by index.1
37538>>>>>>>>>>
37538>>>>>>>>>
37538>>>>>>>>>        if (Found = 1) begin
37540>>>>>>>>>            Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
37541>>>>>>>>>            Move (fiCheck_Format(self,lsGplan_Code,gformat.gformat_mask,liBathmos)) to liRetVal
37542>>>>>>>>>            if (liRetVal = 0) begin
37544>>>>>>>>>                Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
37545>>>>>>>>>                if (liModeGplan = 0) Begin
37547>>>>>>>>>                    if (Not(Current_Record(self))) begin
37549>>>>>>>>>                        set field_default_value field Gplan.gplan_Bathmos to libathmos //from deo
37550>>>>>>>>>                    end
37550>>>>>>>>>>
37550>>>>>>>>>                end
37550>>>>>>>>>>
37550>>>>>>>>>                if (libathmos > 1) begin
37552>>>>>>>>>                    Move (Find_Previous(self,lsGplan_Code)) to lsSearchCode
37553>>>>>>>>>                    if (liModeGplan = 0) Begin
37555>>>>>>>>>                        if (Not(Current_Record(self))) begin
37557>>>>>>>>>                            set field_default_value field Gplan.gplan_Anoep to lsSearchCode //from Deo
37558>>>>>>>>>                        End
37558>>>>>>>>>>
37558>>>>>>>>>                    End
37558>>>>>>>>>>
37558>>>>>>>>>                end
37558>>>>>>>>>>
37558>>>>>>>>>            function_return 0
37559>>>>>>>>>            end
37559>>>>>>>>>>
37559>>>>>>>>>            else begin
37560>>>>>>>>>                function_return 127
37561>>>>>>>>>            end
37561>>>>>>>>>>
37561>>>>>>>>>        end
37561>>>>>>>>>>
37561>>>>>>>>>        else begin
37562>>>>>>>>>            Move (Compute_Bathmos(self,lsSearchCode)) to liBathmos
37563>>>>>>>>>            if ((liBathmos-1) <> 0) begin
37565>>>>>>>>>                Move (Find_Previous(self,lsSearchCode)) to lsSearchCode
37566>>>>>>>>>                Goto Search_Again
37567>>>>>>>>>>
37567>>>>>>>>>            end
37567>>>>>>>>>>
37567>>>>>>>>>            else begin
37568>>>>>>>>>                clear Gformat
37569>>>>>>>>>                move SysCurGL.Company_Code  to Gformat.Company_Code
37570>>>>>>>>>                move SysCurGL.Branch_Code   to Gformat.Branch_Code
37571>>>>>>>>>                move SysCurGL.Year_Year     to Gformat.Year_Year
37572>>>>>>>>>                move "@@"                   to Gformat.Gformat_Code
37573>>>>>>>>>                Find eq Gformat by index.1 // pkid
37574>>>>>>>>>>
37574>>>>>>>>>//* to be a function
37574>>>>>>>>>                Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
37575>>>>>>>>>                Move (fiCheck_Format(self,lsGplan_Code,gformat.gformat_mask,liBathmos)) to liRetVal
37576>>>>>>>>>                if (liRetVal = 0) begin
37578>>>>>>>>>                    Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
37579>>>>>>>>>                    if (liModeGplan = 0) Begin
37581>>>>>>>>>                        if (Not(Current_Record(self))) begin
37583>>>>>>>>>                            set field_default_value field Gplan.gplan_Bathmos to libathmos //from Deo
37584>>>>>>>>>                        end
37584>>>>>>>>>>
37584>>>>>>>>>                    end
37584>>>>>>>>>>
37584>>>>>>>>>                    if (libathmos > 1) begin
37586>>>>>>>>>                        Move (Find_Previous(self,lsGplan_Code)) to lsSearchCode
37587>>>>>>>>>                        if (liModeGplan = 0) Begin
37589>>>>>>>>>                            if (Not(Current_Record(self))) begin
37591>>>>>>>>>                                set field_default_value field Gplan.gplan_Anoep to lsSearchCode //from Deo
37592>>>>>>>>>                            end
37592>>>>>>>>>>
37592>>>>>>>>>                        end
37592>>>>>>>>>>
37592>>>>>>>>>                    end
37592>>>>>>>>>>
37592>>>>>>>>>                function_return 0
37593>>>>>>>>>                end
37593>>>>>>>>>>
37593>>>>>>>>>                else begin
37594>>>>>>>>>                    function_return 127
37595>>>>>>>>>                end
37595>>>>>>>>>>
37595>>>>>>>>>
37595>>>>>>>>>                //* emd to be a function
37595>>>>>>>>>                function_return 0
37596>>>>>>>>>            end
37596>>>>>>>>>>
37596>>>>>>>>>        end
37596>>>>>>>>>>
37596>>>>>>>>>        Function_return 0    //ok
37597>>>>>>>>>    End_Function   // private_Man_Gplan_Code
37598>>>>>>>>>
37598>>>>>>>>>
37598>>>>>>>>>
37598>>>>>>>>>    // fiValidateGplanFields:
37598>>>>>>>>>
37598>>>>>>>>>    Function fiValidateGplanFields for Gplan_DataDictionary integer liField string lsFieldvalue Returns Integer
37599>>>>>>>>>        String  sName lsAnoep lsGplan_Code
37600>>>>>>>>>        Integer iMainFile liGplanRecnum liReturnVal liReturnValb liBathmos1
37600>>>>>>>>>        String lsValidChar lsDelimiter
37600>>>>>>>>>
37600>>>>>>>>>        Get Main_File to iMainFile
37601>>>>>>>>>        Get_Attribute DF_FIELD_NAME of iMainFile liField to sName
37604>>>>>>>>>
37604>>>>>>>>>        If (sName = 'GPLAN_CODE') Begin
37606>>>>>>>>>            move (trim(lsFieldvalue)) to lsFieldvalue //from deo
37607>>>>>>>>>            if (lsFieldvalue <>  "") begin //new
37609>>>>>>>>>                Move SyscurGL.Year_Valid_Char to lsValidChar
37610>>>>>>>>>                Move SyscurGL.Year_Delimiter  to lsDelimiter
37611>>>>>>>>>                Move (fiCheckValidChars(Self,lsFieldvalue,((Trim(lsValidChar))+(Trim(lsDelimiter))))) to liReturnVal
37612>>>>>>>>>                if (liReturnVal = '1001') begin
37614>>>>>>>>>                               error liReturnVal (" §¦¡«æª ®¨¡«ã¨ª   ¡à ¡æ . !\n\n§¦¡«¦å ®¨¡«ã¨ª : '" + (psValidChars(Self)) + "'")
37615>>>>>>>>>>
37615>>>>>>>>>                               Function_Return liReturnVal
37616>>>>>>>>>                            end
37616>>>>>>>>>>
37616>>>>>>>>>
37616>>>>>>>>>                Move (private_Man_Gplan_Code(self,liField,lsFieldvalue,0)) to liReturnVal
37617>>>>>>>>>                if (lireturnval <> 0) begin
37619>>>>>>>>>                                        error 127 ("á¦ª £¦¨­ã ¡à ¡¦ç !\n\n"+Gplan.Gplan_Code)
37620>>>>>>>>>>
37620>>>>>>>>>                                        function_return 127
37621>>>>>>>>>                                      end
37621>>>>>>>>>>
37621>>>>>>>>>
37621>>>>>>>>>                get field_current_value field Gplan.gplan_Code to lsGplan_Code
37622>>>>>>>>>                get field_current_value field Gplan.gplan_Bathmos to liBathmos1
37623>>>>>>>>>                get field_current_value field Gplan.gplan_anoep to lsAnoep
37624>>>>>>>>>                Move (fiBackward_Check(self,lsGplan_Code,liBathmos1)) to liReturnValb
37625>>>>>>>>>                if (liReturnValb = '7001') begin
37627>>>>>>>>>                                               error 7001 "¤ ¬§á¨®  ¦ §¨ ¢§« ¡æª £æª !"
37628>>>>>>>>>>
37628>>>>>>>>>                                               Function_Return 8001
37629>>>>>>>>>                                            end
37629>>>>>>>>>>
37629>>>>>>>>>                if (liReturnValb = '7002') begin
37631>>>>>>>>>                                               error 7002 "§á¨®  ¡à ¡æª «¢¬«å¦¬ £¦ç !"
37632>>>>>>>>>>
37632>>>>>>>>>                                               Function_Return 8002
37633>>>>>>>>>                                          end
37633>>>>>>>>>>
37633>>>>>>>>>                if (liReturnValb = '7003') begin
37635>>>>>>>>>                                               error 7003 " §¨¦¦ç£¤¦ª å¤  «¢¬«å¦¬ £¦ç !"
37636>>>>>>>>>>
37636>>>>>>>>>                                               Function_Return 8003
37637>>>>>>>>>                                          end
37637>>>>>>>>>>
37637>>>>>>>>>
37637>>>>>>>>>                Move (fiForward_Check(self,lsGplan_Code,0)) to liReturnValb
37638>>>>>>>>>                if (liReturnValb = '7004') begin
37640>>>>>>>>>                                               error 7004 "§á¨®  ¦ ¤é«¨¦ª £æª !"
37641>>>>>>>>>>
37641>>>>>>>>>                                               Function_Return 8004
37642>>>>>>>>>                                            end
37642>>>>>>>>>>
37642>>>>>>>>>
37642>>>>>>>>>            end
37642>>>>>>>>>>
37642>>>>>>>>>            else Function_Return 0  //exit function ok!!!
37644>>>>>>>>>         end
37644>>>>>>>>>>
37644>>>>>>>>>         function_return 0
37645>>>>>>>>>    End_Function   // fiValidateGplanFields
37646>>>>>>>>>
37646>>>>>>>>>
37646>>>>>>>>>//-----------------------------------------------Save Operation ----------------------------------------------------
37646>>>>>>>>>
37646>>>>>>>>>
37646>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
37647>>>>>>>>>        //Forward Send Operation_Not_Allowed  iError_Num
37647>>>>>>>>>        // Insert Code Here
37647>>>>>>>>>                 if iError_num eq 127  error 127 ((Trim(Gplan.Gplan_Code))+" Wrong Format !!!! \n\n")
37650>>>>>>>>>            Else if iError_num eq 128  error 128 ("Not a valid Data Entry.  Account is Missing !!!!\n\n"+Gplan.Gplan_Code)
37654>>>>>>>>>            Else if iError_num eq 129  error 129 ("Not a valid Data Entry.  Bathmos is Missing !!!!\n\n"+Gplan.Gplan_Code)
37658>>>>>>>>>            Else if iError_num eq 130  error 130 ("Not a valid Data Entry.  Previews Account is Missing !!!!\n\n"+Gplan.Gplan_Code)
37662>>>>>>>>>            Else if iError_num eq 1100  error 1100 "DDC:150 -  §¦¡«ã « ¨å-¨ã©"
37666>>>>>>>>>            Else if iError_num eq 2100  error 2100 "DDC:150 -  §¦¡«ã « ¨å-¨ã©"
37670>>>>>>>>>            Else if iError_num eq 7001 error 8001 ("Anoep Does not Exist !!!!\n\n"+Gplan.Gplan_Code)
37674>>>>>>>>>            Else if iError_num eq 7002 error 8002 ("Last Exists\n\n!!!! "+Gplan.Gplan_Code)
37678>>>>>>>>>            Else if iError_num eq 7003 error 8003 ("Previous batmos is last  !!!!\n\n"+Gplan.Gplan_Code)
37682>>>>>>>>>            Else if iError_num eq 7004 error 8004 ("Greater bathmos exists  !!!!\n\n"+Gplan.Gplan_Code)
37686>>>>>>>>>            Else if iError_num eq 7010 error 7010 ("Greater bathmos exists  !!!!\n\n"+Gplan.Gplan_Code)
37690>>>>>>>>>            Else if (iError_num = 1001) error 1001 (" §¦¡«æª ®¨¡«ã¨ª   ¡à ¡æ . !\n\n§¦¡«¦å ®¨¡«ã¨ª : '" + (psValidChars(Self)) + "'")
37694>>>>>>>>>            Else Forward Send Operation_Not_Allowed  iError_Num
37697>>>>>>>>>    End_Procedure
37698>>>>>>>>>
37698>>>>>>>>>
37698>>>>>>>>>    Procedure Clear_From_Bpo
37699>>>>>>>>>        Clear Gplan
37700>>>>>>>>>    End_Procedure
37701>>>>>>>>>
37701>>>>>>>>>    Function Validate_Save  Returns Integer
37702>>>>>>>>>        Local Integer iReturnVal iField##
37703>>>>>>>>>        locaL string lsVal##
37703>>>>>>>>>
37703>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
37705>>>>>>>>>
37705>>>>>>>>>
37705>>>>>>>>>        If (Not(iReturnVal))Begin
37707>>>>>>>>>            If (Not(Current_Record(Self))) Move (fiCheckValidChars(Self,Gplan.Gplan_Code,((Trim(Year.Year_Valid_Char))+(Trim(Year.Year_Delimiter))))) to iReturnVal
37710>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
37713>>>>>>>>>            If (Gplan.Gplan_Code    = "") Send Operation_Not_Allowed 128
37716>>>>>>>>>            If (Gplan.Gplan_Bathmos = 0 ) Send Operation_Not_Allowed 129
37719>>>>>>>>>            If (;                 (Gplan.Gplan_Bathmos <> 1) and;                 (Gplan.Gplan_Anoep = "");               ) Send Operation_Not_Allowed 130
37722>>>>>>>>>            For iField## from 4 to 4   // Field number for Starting and Ending pp's ???????
37728>>>>>>>>>>
37728>>>>>>>>>
37728>>>>>>>>>                Move (private_Man_Gplan_Code(self,iField##,Gplan.Gplan_Code,1))     to iReturnVal
37729>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
37732>>>>>>>>>
37732>>>>>>>>>                Move (fiBACKWARD_CHECK(self,Gplan.Gplan_Code,Gplan.Gplan_Bathmos)) to iReturnVal
37733>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
37736>>>>>>>>>
37736>>>>>>>>>                Move (fiFORWARD_CHECK(self,Gplan.Gplan_Code,0))                     to iReturnVal
37737>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
37740>>>>>>>>>
37740>>>>>>>>>            Loop
37741>>>>>>>>>>
37741>>>>>>>>>              //1100:cby = globals
37741>>>>>>>>>              If ( ;                   (Not(Gplan.Company_Code = SysCurGL.Company_Code)) or;                   (Not(Gplan.Branch_Code  = SysCurGL.Branch_Code )) or;                   (Not(Gplan.Year_Year    = SysCurGL.Year_Year   ));                  ) Send Operation_Not_Allowed 1100
37744>>>>>>>>>        End
37744>>>>>>>>>>
37744>>>>>>>>>        Function_Return iReturnVal
37745>>>>>>>>>    End_Function
37746>>>>>>>>>
37746>>>>>>>>>    Function Validate_Delete  Returns Integer
37747>>>>>>>>>        Local Integer iReturnVal liReturnValb##
37748>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
37750>>>>>>>>>
37750>>>>>>>>>        If (Not(iReturnVal)) Begin
37752>>>>>>>>>            // Insert Code Here
37752>>>>>>>>>               Move (fiFORWARD_CHECK(Self,Gplan.Gplan_Code,1)) to liReturnValb##
37753>>>>>>>>>               If (liReturnValb##>1) Send Operation_Not_Allowed liReturnValb##
37756>>>>>>>>>              //2100:cby = globals
37756>>>>>>>>>              If ( ;                   (Not(Gplan.Company_Code = SysCurGL.Company_Code)) or;                   (Not(Gplan.Branch_Code  = SysCurGL.Branch_Code )) or;                   (Not(Gplan.Year_Year    = SysCurGL.Year_Year   ));                  )                                                   Send Operation_Not_Allowed 2100
37759>>>>>>>>>        End
37759>>>>>>>>>>
37759>>>>>>>>>
37759>>>>>>>>>        Function_Return iReturnVal
37760>>>>>>>>>    End_Function
37761>>>>>>>>>
37761>>>>>>>>>
37761>>>>>>>>>//    Procedure Update
37761>>>>>>>>>//        Forward Send Update
37761>>>>>>>>>//        // Insert Code Here
37761>>>>>>>>>//        Move Company.Company_Code  to Gplan.Company_Code
37761>>>>>>>>>//        Move Branch.Branch_Code    to Gplan.Branch_Code
37761>>>>>>>>>//        Move Year.Year_Year        to Gplan.Year_Year
37761>>>>>>>>>//        Add 1 to Year.Year_NumGplan //¨ £æª ¢¦¨ ©£é¤ «ª ®¨ã©ª
37761>>>>>>>>>//    End_Procedure   // Update
37761>>>>>>>>>
37761>>>>>>>>>//    Procedure Backout
37761>>>>>>>>>//        Forward Send Backout
37761>>>>>>>>>//        Sub 1 from Year.Year_NumGplan //¨ £æª ¢¦¨ ©£é¤ «ª ®¨ã©ª
37761>>>>>>>>>//    End_Procedure //deleting
37761>>>>>>>>>
37761>>>>>>>>>
37761>>>>>>>>>
37761>>>>>>>>>    // Define_Fields:
37761>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
37761>>>>>>>>>
37761>>>>>>>>>    Procedure Define_Fields
37762>>>>>>>>>        Forward Send Define_Fields
37764>>>>>>>>>        //DDB-Generated-Code-Location
37764>>>>>>>>>        //DDB-DefineFieldStart
37764>>>>>>>>>
37764>>>>>>>>>        Set Main_File            To Gplan.File_Number
37765>>>>>>>>>        Set Cascade_Delete_State To FALSE
37766>>>>>>>>>
37766>>>>>>>>>
37766>>>>>>>>>        // Child (Client) file structure................
37766>>>>>>>>>        Send Add_Client_File  Gmovea.File_Number
37767>>>>>>>>>        Send Add_Client_File  Gplanmod.File_Number
37768>>>>>>>>>        Send Add_Client_File  Gmhnes.File_Number
37769>>>>>>>>>        Send Add_Client_File  Gmove.File_Number
37770>>>>>>>>>        Send Add_Client_File  Gpmoves.File_Number
37771>>>>>>>>>        Send Add_Client_File  Gvatd.File_Number
37772>>>>>>>>>
37772>>>>>>>>>        // External (System) file structure.............
37772>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
37773>>>>>>>>>        Send Add_System_File  Syscurgl.File_Number  DD_LOCK_ON_ALL
37774>>>>>>>>>
37774>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gplan_Rec0  To Gplan.Gplan_Rec0
37777>>>>>>>>>
37777>>>>>>>>>        // Field-based properties.......................
37777>>>>>>>>>
37777>>>>>>>>>        // Gplan.Company_Code
37777>>>>>>>>>
37777>>>>>>>>>        // Gplan.Branch_Code
37777>>>>>>>>>
37777>>>>>>>>>        // Gplan.Year_Year
37777>>>>>>>>>
37777>>>>>>>>>        // Gplan.Gplan_Code
37777>>>>>>>>>        Set Field_Exit_msg         Field Gplan.Gplan_Code To get_fiValidateGplanFields
37778>>>>>>>>>        Set Field_Options          Field Gplan.Gplan_Code To DD_AUTOFIND    DD_REQUIRED   
37779>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Code To (sl150(Self))
37780>>>>>>>>>
37780>>>>>>>>>        // Gplan.Gplan_Rec0
37780>>>>>>>>>
37780>>>>>>>>>        // Gplan.Year_Recr
37780>>>>>>>>>
37780>>>>>>>>>        // Gplan.Gplan_Descr1
37780>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Descr1 To (sl150(Self))
37781>>>>>>>>>
37781>>>>>>>>>        // Gplan.Gplan_Descr2
37781>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Descr2 To (sl150(Self))
37782>>>>>>>>>
37782>>>>>>>>>        // Gplan.Gplan_Bathmos
37782>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Bathmos To "Calulated"
37782>>>>>>>>>
37782>>>>>>>>>        // Gplan.Gplan_Anoep
37782>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Anoep To "Calulated"
37782>>>>>>>>>
37782>>>>>>>>>        // Gplan.Gplan_O_Code
37782>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_O_Code To "dbComboFormSub"
37783>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_O_Code To (Gplan_Gplan_O_Code_VT(Self))
37784>>>>>>>>>
37784>>>>>>>>>        // Gplan.Gplan_Yn_Xfer
37784>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Xfer To "dbComboFormSub"
37785>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Xfer To (Gplan_Gplan_Yn_VT(Self))
37786>>>>>>>>>
37786>>>>>>>>>        // Gplan.Gplan_Yn_Last
37786>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Last To "¨© £¦§¦ å«  ©«¤ validate save «¦¬ Gmove (1013)"
37786>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Last To "dbComboFormSub"
37787>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Last To (Gplan_Gplan_Yn_VT(Self))
37788>>>>>>>>>
37788>>>>>>>>>        // Gplan.Gplan_Yn_Kin
37788>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Kin To "¨© £¦§¦ å«  ©«¤ validate save «¦¬ Gmove (1014)"
37788>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Kin To "dbComboFormSub"
37789>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Kin To (Gplan_Gplan_Yn_VT(Self))
37790>>>>>>>>>
37790>>>>>>>>>        // Gplan.Gplan_Yn_Kk
37790>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Kk To "dbComboFormSub"
37791>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Kk To (Gplan_Gplan_Yn_VT(Self))
37792>>>>>>>>>
37792>>>>>>>>>        // Gplan.Gplan_Xpm
37792>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Xpm To "¨© £¦§¦ å«  ©«¤ validate save «¦¬ Gmove (1015+1016)"
37792>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Xpm To "dbComboFormSub"
37793>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Xpm To (Gplan_Gplan_Xpm_VT(Self))
37794>>>>>>>>>
37794>>>>>>>>>        // Gplan.Gplan_Yn_Xy
37794>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Xy To "¨© £¦§¦ å«  ©«¤ private.trexe «¦¬ Gmove (1017)"
37794>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Xy To "dbComboFormSub"
37795>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Xy To (Gplan_Gplan_Yn_VT(Self))
37796>>>>>>>>>
37796>>>>>>>>>        // Gplan.Gplan_Yn_Py
37796>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Py To "¨© £¦§¦ å«  ©«¤ private.trexe «¦¬ Gmove (1018)"
37796>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Py To "dbComboFormSub"
37797>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Py To (Gplan_Gplan_Yn_VT(Self))
37798>>>>>>>>>
37798>>>>>>>>>        // Gplan.Gplan_Fpaent
37798>>>>>>>>>
37798>>>>>>>>>        // Gplan.Gplan_Fpaent_Yn
37798>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Fpaent_Yn To (Gplan_Gplan_Yn_VT(Self))
37799>>>>>>>>>
37799>>>>>>>>>        // Gplan.Gplan_Afm
37799>>>>>>>>>
37799>>>>>>>>>        // Gplan.Gplan_Addr
37799>>>>>>>>>
37799>>>>>>>>>        // Gplan.Gplan_Tk
37799>>>>>>>>>
37799>>>>>>>>>        // Gplan.Gplan_Poli
37799>>>>>>>>>
37799>>>>>>>>>        // Gplan.Gplan_Doy
37799>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Doy To "dbComboFormSub"
37800>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Doy To (Gplan_Gplan_Doy_VT(Self))
37801>>>>>>>>>
37801>>>>>>>>>        // Gplan.Gplan_J_Code
37801>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_J_Code To "dbComboFormSub"
37802>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_J_Code To (Gplan_Gplan_J_Code_VT(Self))
37803>>>>>>>>>
37803>>>>>>>>>        // Gplan.Gplan_C_Code2
37803>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_C_Code2 To "¨© £¦§¦ å«  ©«¤ validate save «¦¬ Gmove (1019)"
37803>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_C_Code2 To "dbComboFormSub"
37804>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_C_Code2 To (Gplan_Gplan_C_Code2_VT(Self))
37805>>>>>>>>>
37805>>>>>>>>>        // Gplan.Gplan_Tel
37805>>>>>>>>>
37805>>>>>>>>>        // Gplan.Gplan_Email
37805>>>>>>>>>
37805>>>>>>>>>        // Gplan.Gplan_Resp
37805>>>>>>>>>
37805>>>>>>>>>        // Gplan.Gplan_Bitmap
37805>>>>>>>>>
37805>>>>>>>>>        // Gplan.Gplan_Rep_Code
37805>>>>>>>>>
37805>>>>>>>>>        // Gplan.Gplan_Rep_Pct
37805>>>>>>>>>
37805>>>>>>>>>        // Gplan.Gplan_I_Xy_Code
37805>>>>>>>>>
37805>>>>>>>>>        // Gplan.Gplan_I_Py_Code
37805>>>>>>>>>
37805>>>>>>>>>        // Gplan.Gplan_I_Ctypkin
37805>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_I_Ctypkin To (Gtypkin(Self))
37806>>>>>>>>>
37806>>>>>>>>>        // Gplan.Gplan_I_A_Code
37806>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_I_A_Code To "dbComboFormSub"
37807>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_I_A_Code To (Gplan_Gplan_I_A_Code_VT2(Self))
37808>>>>>>>>>
37808>>>>>>>>>        // Gplan.Gplan_Yn_Myfp
37808>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Myfp To "dbComboFormSub"
37809>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Myfp To (Gplan_Gplan_Yn_VT(Self))
37810>>>>>>>>>
37810>>>>>>>>>        // Gplan.Gplan_Yn_Myfa
37810>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Myfa To "dbComboFormSub"
37811>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Myfa To (Gplan_Gplan_Yn_VT(Self))
37812>>>>>>>>>
37812>>>>>>>>>        // Gplan.Gplan_Myfnump
37812>>>>>>>>>
37812>>>>>>>>>        // Gplan.Gplan_Myfvalp
37812>>>>>>>>>
37812>>>>>>>>>        // Gplan.Gplan_Myfnuma
37812>>>>>>>>>
37812>>>>>>>>>        // Gplan.Gplan_Myfvala
37812>>>>>>>>>
37812>>>>>>>>>        // Gplan.Gplan_Myf_Sump
37812>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Myf_Sump To "¦¨å  á¤ ¦  ®¨é© ª/§ ©«é© ª  ¨¦ ©«¦ç¤ ©«¤ "
37812>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Myf_Sump To "dbComboFormSub"
37813>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Myf_Sump To (Gplan_Gplan_Myf_Sum_VT(Self))
37814>>>>>>>>>
37814>>>>>>>>>        // Gplan.Gplan_Myf_Suma
37814>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Myf_Suma To "dbComboFormSub"
37815>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Myf_Suma To (Gplan_Gplan_Myf_Sum_VT(Self))
37816>>>>>>>>>
37816>>>>>>>>>        // Gplan.Gplan_Sx0
37816>>>>>>>>>
37816>>>>>>>>>        // Gplan.Gplan_Sp0
37816>>>>>>>>>
37816>>>>>>>>>        // Gplan.Gplan_Sx00
37816>>>>>>>>>
37816>>>>>>>>>        // Gplan.Gplan_Sp00
37816>>>>>>>>>
37816>>>>>>>>>        // Gplan.Gplan_Sxr
37816>>>>>>>>>
37816>>>>>>>>>        // Gplan.Gplan_Spr
37816>>>>>>>>>
37816>>>>>>>>>        // Gplan.Gplan_Sx2
37816>>>>>>>>>
37816>>>>>>>>>        // Gplan.Gplan_Sp2
37816>>>>>>>>>
37816>>>>>>>>>        // Gplan.Gplan_Gmhnnorec
37816>>>>>>>>>
37816>>>>>>>>>        // Gplan.Gplan_Recr
37816>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Recr To (sl150(Self))
37817>>>>>>>>>
37817>>>>>>>>>        //DDB-DefineFieldEnd
37817>>>>>>>>>    End_Procedure    // Define_Fields
37818>>>>>>>>>
37818>>>>>>>>>    // Field_Defaults:
37818>>>>>>>>>    // This procedure is used to establish default field values.
37818>>>>>>>>>
37818>>>>>>>>>    Procedure Field_Defaults
37819>>>>>>>>>        Forward Send Field_Defaults
37821>>>>>>>>>        //DDB-Generated-Code-Location
37821>>>>>>>>>        //DDB-FieldDefaultStart
37821>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Xfer To 0
37822>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Last To 0
37823>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Kin To 1
37824>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Kk To 0
37825>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Xpm To 3
37826>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Xy To 1
37827>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Py To 1
37828>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Fpaent_Yn To 0
37829>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Rep_Pct To 100
37830>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Myfp To 0
37831>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Myfa To 0
37832>>>>>>>>>        //DDB-FieldDefaultEnd
37832>>>>>>>>>    End_Procedure    // Field_Defaults
37833>>>>>>>>>End_Class    // Gplan_DataDictionary
37834>>>>>>>>>
37834>>>>>>>>>
37834>>>>>>>>>
37834>>>>>>>>>
37834>>>>>>>>>
37834>>>>>>>>>
37834>>>>>>>>>
37834>>>>>>>>>
37834>>>>>>>>>
37834>>>>>>>>>
37834>>>>>>>>>
37834>>>>>>>>>
37834>>>>>>>>>
37834>>>>>>>>>
37834>>>>>>>>>//DDB-Selection-pkg-Start
37834>>>>>>>>>
37834>>>>>>>>>Use sl150.sl         // sl150
37834>>>>>>>>>Use Gtypkin.sl       // Gtypkin
INCLUDING FILE: GTYPKIN.SL
37834>>>>>>>>>>>//AB/ Project gtypkin:Gtypkin
37834>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
37834>>>>>>>>>>>//AB/         Set ProjectName to "gtypkin:Gtypkin"
37834>>>>>>>>>>>//AB/         Set ProjectFileName to "gtypkin.SL"
37834>>>>>>>>>>>
37834>>>>>>>>>>>// Project Object Structure
37834>>>>>>>>>>>//   gtypkin is a dbModalPanel
37834>>>>>>>>>>>//     Gthhmgio_DD is a DataDictionary
37834>>>>>>>>>>>//     Gtypkin_DD is a DataDictionary
37834>>>>>>>>>>>//     oSelList is a dbList
37834>>>>>>>>>>>//     oOK_bn is a Button
37834>>>>>>>>>>>//     oCancel_bn is a Button
37834>>>>>>>>>>>//     oSearch_bn is a Button
37834>>>>>>>>>>>
37834>>>>>>>>>>>// Register all objects
37834>>>>>>>>>>>Register_Object Gthhmgio_DD
37834>>>>>>>>>>>Register_Object Gtypkin_DD
37834>>>>>>>>>>>Register_Object gtypkin
37834>>>>>>>>>>>Register_Object oCancel_bn
37834>>>>>>>>>>>Register_Object oOK_bn
37834>>>>>>>>>>>Register_Object oSearch_bn
37834>>>>>>>>>>>Register_Object oSelList
37834>>>>>>>>>>>
37834>>>>>>>>>>>
37834>>>>>>>>>>>    //AB-IgnoreStart
37834>>>>>>>>>>>
37834>>>>>>>>>>>    Use DFAllEnt.pkg
37834>>>>>>>>>>>
37834>>>>>>>>>>>
37834>>>>>>>>>>>    Use GTHHMGIO.DD
INCLUDING FILE: GTHHMGIO.DD
37834>>>>>>>>>>>>>//DDB-FileStart
37834>>>>>>>>>>>>>//DDB-HeaderStart
37834>>>>>>>>>>>>>
37834>>>>>>>>>>>>>// File Name : GTHHMGIO.DD
37834>>>>>>>>>>>>>// Class Name: Gthhmgio_DataDictionary
37834>>>>>>>>>>>>>// Revision  : 33
37834>>>>>>>>>>>>>// Version   : 2
37834>>>>>>>>>>>>>
37834>>>>>>>>>>>>>Use  Windows           // Basic Definitions
37834>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
37834>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37834>>>>>>>>>>>>>
37834>>>>>>>>>>>>>Open Gthhmgio
INCLUDING FILE: GTHHMGIO.FD
37836>>>>>>>>>>>>>Open Gtypkin
37838>>>>>>>>>>>>>Open Gthaa
INCLUDING FILE: GTHAA.FD
37840>>>>>>>>>>>>>Open Sysrecg
37842>>>>>>>>>>>>>
37842>>>>>>>>>>>>>//DDB-HeaderEnd
37842>>>>>>>>>>>>>//DDB-ValidationStart
37842>>>>>>>>>>>>>
37842>>>>>>>>>>>>>Register_Object Gthhmgio_Gthhmgio_Period_VT
37842>>>>>>>>>>>>>
37842>>>>>>>>>>>>>Object Gthhmgio_Gthhmgio_Period_VT  is a CodeValidationTable
37844>>>>>>>>>>>>>    Set Type_Value        To "PERIOD"
37845>>>>>>>>>>>>>    //DDB-ValidationCustomStart
37845>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
37845>>>>>>>>>>>>>End_Object   // Gthhmgio_Gthhmgio_Period_VT
37846>>>>>>>>>>>>>//DDB-ValidationEnd
37846>>>>>>>>>>>>>//DDB-SelectionStart
37846>>>>>>>>>>>>>//DDB/ ExternalSelectionList Gthhmgio  Gthhmgio.SL
37846>>>>>>>>>>>>>Register_Object Gthhmgio
37846>>>>>>>>>>>>>//DDB-SelectionEnd
37846>>>>>>>>>>>>>
37846>>>>>>>>>>>>>Class Gthhmgio_DataDictionary  is a DataDictionary_Sec
37847>>>>>>>>>>>>>
37847>>>>>>>>>>>>>
37847>>>>>>>>>>>>>    // Define_Fields:
37847>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
37847>>>>>>>>>>>>>
37847>>>>>>>>>>>>>    Procedure Define_Fields
37848>>>>>>>>>>>>>        Forward Send Define_Fields
37850>>>>>>>>>>>>>        //DDB-Generated-Code-Location
37850>>>>>>>>>>>>>        //DDB-DefineFieldStart
37850>>>>>>>>>>>>>
37850>>>>>>>>>>>>>        Set Main_File            To Gthhmgio.File_Number
37851>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
37852>>>>>>>>>>>>>
37852>>>>>>>>>>>>>
37852>>>>>>>>>>>>>        // Child (Client) file structure................
37852>>>>>>>>>>>>>        Send Add_Client_File  Gtypkin.File_Number
37853>>>>>>>>>>>>>        Send Add_Client_File  Gthaa.File_Number
37854>>>>>>>>>>>>>
37854>>>>>>>>>>>>>        // External (System) file structure.............
37854>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
37855>>>>>>>>>>>>>
37855>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gthhmgio_Rec0  To Gthhmgio.Gthhmgio_Rec0
37858>>>>>>>>>>>>>
37858>>>>>>>>>>>>>        // Field-based properties.......................
37858>>>>>>>>>>>>>
37858>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Code
37858>>>>>>>>>>>>>        Set Field_Options          Field Gthhmgio.Gthhmgio_Code To DD_AUTOFIND   
37859>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gthhmgio.Gthhmgio_Code To (Gthhmgio(Self))
37860>>>>>>>>>>>>>        Set Key_Field_State        Field Gthhmgio.Gthhmgio_Code To TRUE
37861>>>>>>>>>>>>>
37861>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Rec0
37861>>>>>>>>>>>>>
37861>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Descr
37861>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gthhmgio.Gthhmgio_Descr To (Gthhmgio(Self))
37862>>>>>>>>>>>>>
37862>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Period
37862>>>>>>>>>>>>>        Set Field_Value_Table      Field Gthhmgio.Gthhmgio_Period To (Gthhmgio_Gthhmgio_Period_VT(Self))
37863>>>>>>>>>>>>>
37863>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Recr
37863>>>>>>>>>>>>>        Set Field_Options          Field Gthhmgio.Gthhmgio_Recr To DD_AUTOFIND   
37864>>>>>>>>>>>>>        Set Key_Field_State        Field Gthhmgio.Gthhmgio_Recr To TRUE
37865>>>>>>>>>>>>>
37865>>>>>>>>>>>>>        //DDB-DefineFieldEnd
37865>>>>>>>>>>>>>    End_Procedure    // Define_Fields
37866>>>>>>>>>>>>>
37866>>>>>>>>>>>>>    // Field_Defaults:
37866>>>>>>>>>>>>>    // This procedure is used to establish default field values.
37866>>>>>>>>>>>>>
37866>>>>>>>>>>>>>    Procedure Field_Defaults
37867>>>>>>>>>>>>>        Forward Send Field_Defaults
37869>>>>>>>>>>>>>        //DDB-Generated-Code-Location
37869>>>>>>>>>>>>>        //DDB-FieldDefaultStart
37869>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
37869>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
37870>>>>>>>>>>>>>End_Class    // Gthhmgio_DataDictionary
37871>>>>>>>>>>>>>//DDB-Selection-pkg-Start
37871>>>>>>>>>>>>>
37871>>>>>>>>>>>>>Use Gthhmgio.SL      // Gthhmgio
INCLUDING FILE: GTHHMGIO.SL
37871>>>>>>>>>>>>>>>//AB/ Project Gthhmgio:Gthhmgio
37871>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
37871>>>>>>>>>>>>>>>//AB/         Set ProjectName to "Gthhmgio:Gthhmgio"
37871>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "Gthhmgio.SL"
37871>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
37871>>>>>>>>>>>>>>>
37871>>>>>>>>>>>>>>>// Project Object Structure
37871>>>>>>>>>>>>>>>//   Gthhmgio is a dbModalPanel
37871>>>>>>>>>>>>>>>//     Gthhmgio_DD is a DataDictionary
37871>>>>>>>>>>>>>>>//     oSelList is a dbList
37871>>>>>>>>>>>>>>>//     oOK_bn is a Button
37871>>>>>>>>>>>>>>>//     oCancel_bn is a Button
37871>>>>>>>>>>>>>>>//     oSearch_bn is a Button
37871>>>>>>>>>>>>>>>
37871>>>>>>>>>>>>>>>// Register all objects
37871>>>>>>>>>>>>>>>Register_Object Gthhmgio_DD
37871>>>>>>>>>>>>>>>Register_Object oCancel_bn
37871>>>>>>>>>>>>>>>Register_Object oOK_bn
37871>>>>>>>>>>>>>>>Register_Object oSearch_bn
37871>>>>>>>>>>>>>>>Register_Object oSelList
37871>>>>>>>>>>>>>>>Register_Object Gthhmgio
37871>>>>>>>>>>>>>>>
37871>>>>>>>>>>>>>>>
37871>>>>>>>>>>>>>>>    //AB-IgnoreStart
37871>>>>>>>>>>>>>>>
37871>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
37871>>>>>>>>>>>>>>>
37871>>>>>>>>>>>>>>>
37871>>>>>>>>>>>>>>>    Use GTHHMGIO.DD
37871>>>>>>>>>>>>>>>
37871>>>>>>>>>>>>>>>    //AB-IgnoreEnd
37871>>>>>>>>>>>>>>>
37871>>>>>>>>>>>>>>>    CD_Popup_Object Gthhmgio is a dbModalPanel
37890>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
37891>>>>>>>>>>>>>>>        Set Label to "å©« £¨¦¢¦åà¤"
37892>>>>>>>>>>>>>>>        Set Size to 148 297
37893>>>>>>>>>>>>>>>        Set Location to 4 5
37894>>>>>>>>>>>>>>>
37894>>>>>>>>>>>>>>>        //AB-DDOStart
37894>>>>>>>>>>>>>>>
37894>>>>>>>>>>>>>>>        Object Gthhmgio_DD is a Gthhmgio_DataDictionary
37896>>>>>>>>>>>>>>>        End_Object    // Gthhmgio_DD
37897>>>>>>>>>>>>>>>
37897>>>>>>>>>>>>>>>        Set Main_DD to (Gthhmgio_DD(self))
37898>>>>>>>>>>>>>>>        Set Server to (Gthhmgio_DD(self))
37899>>>>>>>>>>>>>>>
37899>>>>>>>>>>>>>>>        //AB-DDOEnd
37899>>>>>>>>>>>>>>>
37899>>>>>>>>>>>>>>>        Object oSelList is a dbList
37901>>>>>>>>>>>>>>>            Set Main_File to Gthhmgio.File_Number
37902>>>>>>>>>>>>>>>            Set Size to 105 280
37903>>>>>>>>>>>>>>>            Set Location to 6 6
37904>>>>>>>>>>>>>>>
37904>>>>>>>>>>>>>>>            Begin_Row
37907>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_code
37908>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_descr
37909>>>>>>>>>>>>>>>            End_Row
37914>>>>>>>>>>>>>>>
37914>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 52
37915>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "à ¡æª"
37916>>>>>>>>>>>>>>>
37916>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 220
37917>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "¨ ¨­ã"
37918>>>>>>>>>>>>>>>
37918>>>>>>>>>>>>>>>        End_Object    // oSelList
37919>>>>>>>>>>>>>>>
37919>>>>>>>>>>>>>>>        Object oOK_bn is a Button
37921>>>>>>>>>>>>>>>            Set Label to "&§ ¢¦ã"
37922>>>>>>>>>>>>>>>            Set Location to 111 127
37923>>>>>>>>>>>>>>>
37923>>>>>>>>>>>>>>>            //AB-StoreStart
37923>>>>>>>>>>>>>>>            Procedure OnClick
37925>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
37926>>>>>>>>>>>>>>>            End_Procedure
37927>>>>>>>>>>>>>>>            //AB-StoreEnd
37927>>>>>>>>>>>>>>>
37927>>>>>>>>>>>>>>>        End_Object    // oOK_bn
37928>>>>>>>>>>>>>>>
37928>>>>>>>>>>>>>>>        Object oCancel_bn is a Button
37930>>>>>>>>>>>>>>>            Set Label to "&¡ç¨à©"
37931>>>>>>>>>>>>>>>            Set Location to 111 181
37932>>>>>>>>>>>>>>>
37932>>>>>>>>>>>>>>>            //AB-StoreStart
37932>>>>>>>>>>>>>>>            Procedure OnClick
37934>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
37935>>>>>>>>>>>>>>>            End_Procedure
37936>>>>>>>>>>>>>>>            //AB-StoreEnd
37936>>>>>>>>>>>>>>>
37936>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
37937>>>>>>>>>>>>>>>
37937>>>>>>>>>>>>>>>        Object oSearch_bn is a Button
37939>>>>>>>>>>>>>>>            Set Label to "&¤ã«©..."
37940>>>>>>>>>>>>>>>            Set Location to 111 237
37941>>>>>>>>>>>>>>>
37941>>>>>>>>>>>>>>>            //AB-StoreStart
37941>>>>>>>>>>>>>>>            Procedure OnClick
37943>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
37944>>>>>>>>>>>>>>>            End_Procedure
37945>>>>>>>>>>>>>>>            //AB-StoreEnd
37945>>>>>>>>>>>>>>>
37945>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
37946>>>>>>>>>>>>>>>
37946>>>>>>>>>>>>>>>
37946>>>>>>>>>>>>>>>        //AB-StoreStart
37946>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
37947>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
37948>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
37949>>>>>>>>>>>>>>>        //AB-StoreEnd
37949>>>>>>>>>>>>>>>
37949>>>>>>>>>>>>>>>    CD_End_Object    // Gthhmgio
37951>>>>>>>>>>>>>>>>
37951>>>>>>>>>>>>>>>
37951>>>>>>>>>>>>>>>//AB/     End_Object    // prj
37951>>>>>>>>>>>>>
37951>>>>>>>>>>>>>//DDB-Selection-pkg-End
37951>>>>>>>>>>>>>//DDB-FileEnd
37951>>>>>>>>>>>    Use GTYPKIN.DD
INCLUDING FILE: GTYPKIN.DD
37951>>>>>>>>>>>>>//DDB-FileStart
37951>>>>>>>>>>>>>//DDB-HeaderStart
37951>>>>>>>>>>>>>
37951>>>>>>>>>>>>>// File Name : GTYPKIN.DD
37951>>>>>>>>>>>>>// Class Name: Gtypkin_DataDictionary
37951>>>>>>>>>>>>>// Revision  : 44
37951>>>>>>>>>>>>>// Version   : 2
37951>>>>>>>>>>>>>
37951>>>>>>>>>>>>>Use  Windows           // Basic Definitions
37951>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
37951>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37951>>>>>>>>>>>>>
37951>>>>>>>>>>>>>Open Gtypkin
37953>>>>>>>>>>>>>Open Garticl
37955>>>>>>>>>>>>>Open Gflagkin
INCLUDING FILE: GFLAGKIN.FD
37957>>>>>>>>>>>>>Open Gparticl
INCLUDING FILE: GPARTICL.FD
37959>>>>>>>>>>>>>Open Gthhmgio
37961>>>>>>>>>>>>>Open Sysrecg
37963>>>>>>>>>>>>>
37963>>>>>>>>>>>>>//DDB-HeaderEnd
37963>>>>>>>>>>>>>//DDB-SelectionStart
37963>>>>>>>>>>>>>//DDB/ ExternalSelectionList gtypkin  gtypkin.SL
37963>>>>>>>>>>>>>Register_Object gtypkin
37963>>>>>>>>>>>>>//DDB-SelectionEnd
37963>>>>>>>>>>>>>Open SysCurGL
37965>>>>>>>>>>>>>
37965>>>>>>>>>>>>>Class Gtypkin_DataDictionary  is a DataDictionary_Sec
37966>>>>>>>>>>>>>
37966>>>>>>>>>>>>>    Procedure Entry_Order_Date  Integer iField  Date dDate
37967>>>>>>>>>>>>>         // Add a default date if the field is blank
37967>>>>>>>>>>>>>         Integer Changed
37968>>>>>>>>>>>>>         Get Field_Changed_State iField to Changed
37969>>>>>>>>>>>>>         If (Changed=0 AND dDate =0) Begin
37971>>>>>>>>>>>>>             SysDate4 dDate
37972>>>>>>>>>>>>>             Set Field_Default_Value iField to dDate
37973>>>>>>>>>>>>>         End
37973>>>>>>>>>>>>>>
37973>>>>>>>>>>>>>    End_Procedure
37974>>>>>>>>>>>>>
37974>>>>>>>>>>>>>    Procedure Construct_Object
37975>>>>>>>>>>>>>        Forward Send Construct_Object
37977>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
37978>>>>>>>>>>>>>        Property Date    pdDefault_Hmnia    Public 0
37979>>>>>>>>>>>>>        Property Integer piRate             Public 0
37980>>>>>>>>>>>>>        Property Integer piGthhmgio_dd      Public 0
37981>>>>>>>>>>>>>    End_Procedure   // Construct_Object
37982>>>>>>>>>>>>>
37982>>>>>>>>>>>>>    Procedure OnConstrain
37983>>>>>>>>>>>>>        Forward Send OnConstrain
37985>>>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
37987>>>>>>>>>>>>>        End
37987>>>>>>>>>>>>>>
37987>>>>>>>>>>>>>        Else Begin
37988>>>>>>>>>>>>>            Constrain Gtypkin.Company_Code  eq SysCurGL.Company_Code
37990>>>>>>>>>>>>>            Constrain Gtypkin.Branch_Code   eq SysCurGL.Branch_Code
37992>>>>>>>>>>>>>            Constrain Gtypkin.Year_Year     eq SysCurGL.Year_Year
37994>>>>>>>>>>>>>        End
37994>>>>>>>>>>>>>>
37994>>>>>>>>>>>>>    End_Procedure
37995>>>>>>>>>>>>>
37995>>>>>>>>>>>>>    Procedure Update
37996>>>>>>>>>>>>>        Forward Send Update
37998>>>>>>>>>>>>>        // Insert Code Here
37998>>>>>>>>>>>>>        Move SysCurGL.Company_Code  to Gtypkin.Company_Code
37999>>>>>>>>>>>>>        Move SysCurGL.Branch_Code   to Gtypkin.Branch_Code
38000>>>>>>>>>>>>>        Move SysCurGL.Year_Year     to Gtypkin.Year_Year
38001>>>>>>>>>>>>>        Move SysCurGL.Year_Recr     to Gtypkin.Year_Recr
38002>>>>>>>>>>>>>        Move Gthhmgio.Gthhmgio_Code to Gtypkin.Gthhmgio_Code
38003>>>>>>>>>>>>>    End_Procedure   // Update
38004>>>>>>>>>>>>>
38004>>>>>>>>>>>>>    Procedure Creating
38005>>>>>>>>>>>>>        Forward Send Creating
38007>>>>>>>>>>>>>        // Insert Code Here
38007>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gtypkin.Gtypkin_Rec0)))))) to Gtypkin.Gtypkin_Recr
38008>>>>>>>>>>>>>    End_Procedure   // Creating
38009>>>>>>>>>>>>>
38009>>>>>>>>>>>>>
38009>>>>>>>>>>>>>
38009>>>>>>>>>>>>>//----------------------------------------------------------------------------
38009>>>>>>>>>>>>>
38009>>>>>>>>>>>>>//    Procedure Creating
38009>>>>>>>>>>>>>//              Forward Send Creating
38009>>>>>>>>>>>>>//              Add 1 to Year.Year_NumGtypkin //¨ £æª «ç§à¤ ¡ ¤ã©à¤ «ª ®¨ã©ª
38009>>>>>>>>>>>>>//    End_Procedure //creating
38009>>>>>>>>>>>>>//    Procedure Deleting
38009>>>>>>>>>>>>>//              Forward Send Deleting
38009>>>>>>>>>>>>>//              Sub 1 from Year.Year_NumGtypkin //¨ £æª «ç§à¤ ¡ ¤ã©à¤ «ª ®¨ã©ª
38009>>>>>>>>>>>>>//    End_Procedure //deleting
38009>>>>>>>>>>>>>
38009>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
38010>>>>>>>>>>>>>        Integer iReturnVal
38011>>>>>>>>>>>>>        Forward Get Validate_Save To iReturnVal
38013>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
38015>>>>>>>>>>>>>            //1100:cby = globals
38015>>>>>>>>>>>>>            If ( ;                (Not(Gtypkin.Company_Code = SysCurGL.Company_Code)) or;                (Not(Gtypkin.Branch_Code  = SysCurGL.Branch_Code )) or;                (Not(Gtypkin.Year_Year    = SysCurGL.Year_Year   ));                ) Send Operation_Not_Allowed 1100
38018>>>>>>>>>>>>>        End
38018>>>>>>>>>>>>>>
38018>>>>>>>>>>>>>        Function_Return iReturnVal
38019>>>>>>>>>>>>>    End_Function   //validate_save
38020>>>>>>>>>>>>>
38020>>>>>>>>>>>>>
38020>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
38021>>>>>>>>>>>>>        Integer iReturnVal
38022>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
38024>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
38026>>>>>>>>>>>>>            //2100:cby = globals
38026>>>>>>>>>>>>>            If ( ;                (Not(Gtypkin.Company_Code = SysCurGL.Company_Code)) or;                (Not(Gtypkin.Branch_Code  = SysCurGL.Branch_Code )) or;                (Not(Gtypkin.Year_Year    = SysCurGL.Year_Year   ));                ) Send Operation_Not_Allowed 2100
38029>>>>>>>>>>>>>        End
38029>>>>>>>>>>>>>>
38029>>>>>>>>>>>>>        Function_Return iReturnVal
38030>>>>>>>>>>>>>    End_Function   // validate_delete
38031>>>>>>>>>>>>>
38031>>>>>>>>>>>>>
38031>>>>>>>>>>>>>
38031>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
38032>>>>>>>>>>>>>              Case Begin
38032>>>>>>>>>>>>>                   Case (iError_Num = 1100)
38034>>>>>>>>>>>>>                        Error 1100 "DDC 151: §¦¡«ã « ¨å-¨ã©"
38035>>>>>>>>>>>>>>
38035>>>>>>>>>>>>>                        Case Break
38036>>>>>>>>>>>>>                   Case (iError_Num = 2100)
38039>>>>>>>>>>>>>                        Error 2100 "DDC 151: §¦¡«ã « ¨å-¨ã©"
38040>>>>>>>>>>>>>>
38040>>>>>>>>>>>>>                        Case Break
38041>>>>>>>>>>>>>                   Case Else
38041>>>>>>>>>>>>>                        Forward Send Operation_Not_Allowed  iError_Num
38043>>>>>>>>>>>>>              Case End
38043>>>>>>>>>>>>>    End_Procedure   //operation_not_allowed
38044>>>>>>>>>>>>>
38044>>>>>>>>>>>>>
38044>>>>>>>>>>>>>    Procedure Field_Defaults
38045>>>>>>>>>>>>>        Forward Send Field_Defaults
38047>>>>>>>>>>>>>        //DDB-Generated-Code-Location
38047>>>>>>>>>>>>>        //DDB-FieldDefaultStart
38047>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
38047>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
38048>>>>>>>>>>>>>
38048>>>>>>>>>>>>>
38048>>>>>>>>>>>>>
38048>>>>>>>>>>>>>    // Define_Fields:
38048>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38048>>>>>>>>>>>>>
38048>>>>>>>>>>>>>    Procedure Define_Fields
38049>>>>>>>>>>>>>        Forward Send Define_Fields
38051>>>>>>>>>>>>>        //DDB-Generated-Code-Location
38051>>>>>>>>>>>>>        //DDB-DefineFieldStart
38051>>>>>>>>>>>>>
38051>>>>>>>>>>>>>        Set Main_File            To Gtypkin.File_Number
38052>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
38053>>>>>>>>>>>>>
38053>>>>>>>>>>>>>
38053>>>>>>>>>>>>>        // Child (Client) file structure................
38053>>>>>>>>>>>>>        Send Add_Client_File  Garticl.File_Number
38054>>>>>>>>>>>>>        Send Add_Client_File  Gflagkin.File_Number
38055>>>>>>>>>>>>>        Send Add_Client_File  Gparticl.File_Number
38056>>>>>>>>>>>>>
38056>>>>>>>>>>>>>        // Parent (Server) file structure...............
38056>>>>>>>>>>>>>        Send Add_Server_File  Gthhmgio.File_Number
38057>>>>>>>>>>>>>
38057>>>>>>>>>>>>>        // External (System) file structure.............
38057>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
38058>>>>>>>>>>>>>
38058>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gtypkin_Rec0  To Gtypkin.Gtypkin_Rec0
38061>>>>>>>>>>>>>
38061>>>>>>>>>>>>>        // Field-based properties.......................
38061>>>>>>>>>>>>>
38061>>>>>>>>>>>>>        // Gtypkin.Company_Code
38061>>>>>>>>>>>>>
38061>>>>>>>>>>>>>        // Gtypkin.Branch_Code
38061>>>>>>>>>>>>>
38061>>>>>>>>>>>>>        // Gtypkin.Year_Year
38061>>>>>>>>>>>>>
38061>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Code
38061>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gtypkin.Gtypkin_Code To (gtypkin(Self))
38062>>>>>>>>>>>>>
38062>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Rec0
38062>>>>>>>>>>>>>
38062>>>>>>>>>>>>>        // Gtypkin.Year_Recr
38062>>>>>>>>>>>>>
38062>>>>>>>>>>>>>        // Gtypkin.Gthhmgio_Code
38062>>>>>>>>>>>>>
38062>>>>>>>>>>>>>        // Gtypkin.Gthhmgio_Recr
38062>>>>>>>>>>>>>
38062>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Descr
38062>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gtypkin.Gtypkin_Descr To (gtypkin(Self))
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Anti
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Printer
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Form
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_L_No
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_L_Hmnia
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Seira
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Abr
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag01
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag02
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag03
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag04
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag05
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag06
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag07
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag08
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag09
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag10
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag11
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag12
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag13
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag14
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag15
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag16
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag17
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag18
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag19
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag20
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Recr
38063>>>>>>>>>>>>>
38063>>>>>>>>>>>>>        //DDB-DefineFieldEnd
38063>>>>>>>>>>>>>    End_Procedure    // Define_Fields
38064>>>>>>>>>>>>>End_Class    // Gtypkin_DataDictionary
38065>>>>>>>>>>>>>//DDB-Selection-pkg-Start
38065>>>>>>>>>>>>>
38065>>>>>>>>>>>>>Use gtypkin.SL       // gtypkin
38065>>>>>>>>>>>>>
38065>>>>>>>>>>>>>//DDB-Selection-pkg-End
38065>>>>>>>>>>>>>//DDB-FileEnd
38065>>>>>>>>>>>    
38065>>>>>>>>>>>    //AB-IgnoreEnd
38065>>>>>>>>>>>
38065>>>>>>>>>>>    CD_Popup_Object gtypkin is a dbModalPanel
38084>>>>>>>>>>>        Set Minimize_Icon to FALSE
38085>>>>>>>>>>>        Set Label to "å©«  ¤ã©à¤"
38086>>>>>>>>>>>        Set Size to 171 467
38087>>>>>>>>>>>        Set Location to 4 5
38088>>>>>>>>>>>
38088>>>>>>>>>>>        //AB-DDOStart
38088>>>>>>>>>>>
38088>>>>>>>>>>>        Object Gthhmgio_DD is a Gthhmgio_DataDictionary
38090>>>>>>>>>>>        End_Object    // Gthhmgio_DD
38091>>>>>>>>>>>
38091>>>>>>>>>>>        Object Gtypkin_DD is a Gtypkin_DataDictionary
38093>>>>>>>>>>>            Set DDO_Server to (Gthhmgio_DD(self))
38094>>>>>>>>>>>        End_Object    // Gtypkin_DD
38095>>>>>>>>>>>
38095>>>>>>>>>>>        Set Main_DD to (Gtypkin_DD(self))
38096>>>>>>>>>>>        Set Server to (Gtypkin_DD(self))
38097>>>>>>>>>>>
38097>>>>>>>>>>>        //AB-DDOEnd
38097>>>>>>>>>>>
38097>>>>>>>>>>>        Object oSelList is a dbList
38099>>>>>>>>>>>            Set Main_File to Gtypkin.File_Number
38100>>>>>>>>>>>            Set Size to 132 450
38101>>>>>>>>>>>            Set Location to 6 6
38102>>>>>>>>>>>
38102>>>>>>>>>>>            Begin_Row
38105>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_code
38106>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_descr
38107>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_abr
38108>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_seira
38109>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_code
38110>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_descr
38111>>>>>>>>>>>            End_Row
38116>>>>>>>>>>>
38116>>>>>>>>>>>            Set Form_Width    item 0 to 40
38117>>>>>>>>>>>            Set Header_Label  item 0 to "à ¡æª"
38118>>>>>>>>>>>            
38118>>>>>>>>>>>            Set Form_Width    item 1 to 150
38119>>>>>>>>>>>            Set Header_Label  item 1 to "¨ ¨­ã"
38120>>>>>>>>>>>            
38120>>>>>>>>>>>            Set Form_Width    item 2 to 68
38121>>>>>>>>>>>            Set Header_Label  item 2 to "¬¤«¦£¦¨­å"
38122>>>>>>>>>>>            
38122>>>>>>>>>>>            Set Form_Width    item 3 to 30
38123>>>>>>>>>>>            Set Header_Label  item 3 to " ¨á"
38124>>>>>>>>>>>            
38124>>>>>>>>>>>            Set Form_Width    item 4 to 55
38125>>>>>>>>>>>            Set Header_Label  item 4 to "à ¡æª £/ ¦¬"
38126>>>>>>>>>>>            
38126>>>>>>>>>>>            Set Form_Width    item 5 to 99
38127>>>>>>>>>>>            Set Header_Label  item 5 to "¨ ¨­ã £/å¦¬"
38128>>>>>>>>>>>            
38128>>>>>>>>>>>        End_Object    // oSelList
38129>>>>>>>>>>>
38129>>>>>>>>>>>        Object oOK_bn is a Button
38131>>>>>>>>>>>            Set Label to "&§ ¢¦ã"
38132>>>>>>>>>>>            Set Location to 140 298
38133>>>>>>>>>>>
38133>>>>>>>>>>>            //AB-StoreStart
38133>>>>>>>>>>>            Procedure OnClick
38135>>>>>>>>>>>                Send OK To (oSelList(current_object))
38136>>>>>>>>>>>            End_Procedure
38137>>>>>>>>>>>            //AB-StoreEnd
38137>>>>>>>>>>>
38137>>>>>>>>>>>        End_Object    // oOK_bn
38138>>>>>>>>>>>
38138>>>>>>>>>>>        Object oCancel_bn is a Button
38140>>>>>>>>>>>            Set Label to "&¡ç¨à©"
38141>>>>>>>>>>>            Set Location to 140 353
38142>>>>>>>>>>>
38142>>>>>>>>>>>            //AB-StoreStart
38142>>>>>>>>>>>            Procedure OnClick
38144>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
38145>>>>>>>>>>>            End_Procedure
38146>>>>>>>>>>>            //AB-StoreEnd
38146>>>>>>>>>>>
38146>>>>>>>>>>>        End_Object    // oCancel_bn
38147>>>>>>>>>>>
38147>>>>>>>>>>>        Object oSearch_bn is a Button
38149>>>>>>>>>>>            Set Label to "&¤ã«©..."
38150>>>>>>>>>>>            Set Location to 140 408
38151>>>>>>>>>>>
38151>>>>>>>>>>>            //AB-StoreStart
38151>>>>>>>>>>>            Procedure OnClick
38153>>>>>>>>>>>                Send Search To (oSelList(current_object))
38154>>>>>>>>>>>            End_Procedure
38155>>>>>>>>>>>            //AB-StoreEnd
38155>>>>>>>>>>>
38155>>>>>>>>>>>        End_Object    // oSearch_bn
38156>>>>>>>>>>>
38156>>>>>>>>>>>
38156>>>>>>>>>>>        //AB-StoreStart
38156>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
38157>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
38158>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
38159>>>>>>>>>>>        //AB-StoreEnd
38159>>>>>>>>>>>
38159>>>>>>>>>>>    CD_End_Object    // gtypkin
38161>>>>>>>>>>>>
38161>>>>>>>>>>>
38161>>>>>>>>>>>//AB/     End_Object    // prj
38161>>>>>>>>>
38161>>>>>>>>>//DDB-Selection-pkg-End
38161>>>>>>>>>//DDB-FileEnd
38161>>>>>>>    
38161>>>>>>>    //AB-IgnoreEnd
38161>>>>>>>
38161>>>>>>>    CD_Popup_Object sl150 is a dbModalPanelSub
38180>>>>>>>
38180>>>>>>>        //AB-StoreTopStart
38180>>>>>>>        Property Integer piFragmaLast -1
38182>>>>>>>        Property String  psFragmaFromCode ""
38184>>>>>>>        Property String  psFragmaToCode ""
38186>>>>>>>        
38186>>>>>>>        //AB-StoreTopEnd
38186>>>>>>>
38186>>>>>>>        Set Minimize_Icon to FALSE
38187>>>>>>>        Set Label to "å©« ¦¨ ©£é¤"
38188>>>>>>>        Set Size to 204 393
38189>>>>>>>        Set Location to 5 16
38190>>>>>>>        Set Exit_Application_Local_State to FALSE
38191>>>>>>>        Set Modal_State to FALSE
38192>>>>>>>
38192>>>>>>>        //AB-DDOStart
38192>>>>>>>
38192>>>>>>>        Object Gplan_DD is a Gplan_DataDictionary
38194>>>>>>>
38194>>>>>>>            //AB-StoreStart
38194>>>>>>>                        
38194>>>>>>>            Procedure OnConstrain
38196>>>>>>>                Integer liFragmaLast
38197>>>>>>>                String lsFragmaFromCode lsFragmaToCode
38197>>>>>>>                Get piFragmaLast     to liFragmaLast
38198>>>>>>>                Get psFragmaFromCode to lsFragmaFromCode
38199>>>>>>>                Get psFragmaToCode   to lsFragmaToCode
38200>>>>>>>                If (liFragmaLast <> -1)     Constrain Gplan.Gplan_Yn_Last eq liFragmaLast
38204>>>>>>>                If (lsFragmaFromCode <> "") Constrain Gplan.Gplan_Code    ge lsFragmaFromCode
38208>>>>>>>                If (lsFragmaToCode <> "")   Constrain Gplan.Gplan_Code    le lsFragmaToCode
38212>>>>>>>            End_Procedure // OnConstrain
38213>>>>>>>            
38213>>>>>>>            
38213>>>>>>>            //AB-StoreEnd
38213>>>>>>>
38213>>>>>>>        End_Object    // Gplan_DD
38214>>>>>>>
38214>>>>>>>        Set Main_DD to (Gplan_DD(self))
38215>>>>>>>        Set Server to (Gplan_DD(self))
38216>>>>>>>
38216>>>>>>>        //AB-DDOEnd
38216>>>>>>>
38216>>>>>>>        Object oSelList is a dbListSub
38218>>>>>>>            Set Main_File to Gplan.File_Number
38219>>>>>>>            Set Ordering to 3
38220>>>>>>>            Set Size to 164 378
38221>>>>>>>            Set Location to 4 6
38222>>>>>>>
38222>>>>>>>            Begin_Row
38225>>>>>>>                Entry_Item Gplan.Gplan_code
38226>>>>>>>                Entry_Item Gplan.Gplan_descr1
38227>>>>>>>                Entry_Item Gplan.Gplan_bathmos
38228>>>>>>>                Entry_Item Gplan.Gplan_yn_last
38229>>>>>>>            End_Row
38234>>>>>>>
38234>>>>>>>            Set Form_Width    item 0 to 105
38235>>>>>>>            Set Header_Label  item 0 to "à ¡æª"
38236>>>>>>>            
38236>>>>>>>            Set Form_Width    item 1 to 212
38237>>>>>>>            Set Header_Label  item 1 to "¤¦£©å"
38238>>>>>>>            
38238>>>>>>>            Set Form_Width    item 2 to 34
38239>>>>>>>            Set Header_Label  item 2 to "£æª"
38240>>>>>>>            
38240>>>>>>>            Set Form_Width    item 3 to 19
38241>>>>>>>            Set Header_Label  item 3 to " "
38242>>>>>>>            Set Column_Checkbox_State  item 3 to True
38243>>>>>>>            
38243>>>>>>>
38243>>>>>>>            //AB-StoreStart
38243>>>>>>>                        
38243>>>>>>>            Property String piStoredFragmaLast -1
38245>>>>>>>            Property String psStoredFragmaFromCode ""
38247>>>>>>>            Property String psStoredFragmaToCode ""
38249>>>>>>>            
38249>>>>>>>            Procedure Store_Defaults
38251>>>>>>>                forward send Store_Defaults
38253>>>>>>>                Set piStoredFragmaLast     to (piFragmaLast(Self))
38254>>>>>>>                Set psStoredFragmaFromCode to (psFragmaFromCode(Self))
38255>>>>>>>                Set psStoredFragmaToCode   to (psFragmaToCode(Self))
38256>>>>>>>            end_Procedure // Store_Defaults
38257>>>>>>>            
38257>>>>>>>            Procedure Restore_Defaults
38259>>>>>>>                forward send Restore_Defaults
38261>>>>>>>                Set piFragmaLast     to (piStoredFragmaLast(self))
38262>>>>>>>                Set psFragmaFromCode to (psStoredFragmaFromCode(self))
38263>>>>>>>                Set psFragmaToCode   to (psStoredFragmaToCode(self))
38264>>>>>>>            end_Procedure // Restore_Defaults
38265>>>>>>>            
38265>>>>>>>            Procedure Activating
38267>>>>>>>                Forward Send Activating
38269>>>>>>>                Send Rebuild_Constraints to (Gplan_DD(self))
38270>>>>>>>            End_Procedure // Activating
38271>>>>>>>            
38271>>>>>>>            
38271>>>>>>>            
38271>>>>>>>            
38271>>>>>>>            //AB-StoreEnd
38271>>>>>>>
38271>>>>>>>        End_Object    // oSelList
38272>>>>>>>
38272>>>>>>>        Object oOK_bn is a Button
38274>>>>>>>            Set Label to "&§ ¢¦ã"
38275>>>>>>>            Set Location to 170 226
38276>>>>>>>
38276>>>>>>>            //AB-StoreStart
38276>>>>>>>            Procedure OnClick
38278>>>>>>>                Send OK To (oSelList(current_object))
38279>>>>>>>            End_Procedure
38280>>>>>>>            //AB-StoreEnd
38280>>>>>>>
38280>>>>>>>        End_Object    // oOK_bn
38281>>>>>>>
38281>>>>>>>        Object oCancel_bn is a Button
38283>>>>>>>            Set Label to "&¡ç¨à©"
38284>>>>>>>            Set Location to 170 279
38285>>>>>>>
38285>>>>>>>            //AB-StoreStart
38285>>>>>>>            Procedure OnClick
38287>>>>>>>                Send Cancel To (oSelList(current_object))
38288>>>>>>>            End_Procedure
38289>>>>>>>            //AB-StoreEnd
38289>>>>>>>
38289>>>>>>>        End_Object    // oCancel_bn
38290>>>>>>>
38290>>>>>>>        Object oSearch_bn is a Button
38292>>>>>>>            Set Label to "&¤ã«©..."
38293>>>>>>>            Set Location to 170 334
38294>>>>>>>
38294>>>>>>>            //AB-StoreStart
38294>>>>>>>            Procedure OnClick
38296>>>>>>>                Send Search To (oSelList(current_object))
38297>>>>>>>            End_Procedure
38298>>>>>>>            //AB-StoreEnd
38298>>>>>>>
38298>>>>>>>        End_Object    // oSearch_bn
38299>>>>>>>
38299>>>>>>>
38299>>>>>>>        //AB-StoreStart
38299>>>>>>>                
38299>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
38300>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
38301>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
38302>>>>>>>        
38302>>>>>>>        
38302>>>>>>>        
38302>>>>>>>        //AB-StoreEnd
38302>>>>>>>
38302>>>>>>>    CD_End_Object    // sl150
38304>>>>>>>>
38304>>>>>>>
38304>>>>>>>//AB/     End_Object    // prj
38304>>>>>
38304>>>>>//DDB-Selection-pkg-End
38304>>>>>//DDB-FileEnd
38304>>>    
38304>>>    //AB-IgnoreEnd
38304>>>
38304>>>    DEFERRED_VIEW Activate_Fpa FOR ;    ;    Object Fpa is a dbViewSub
38323>>>        Set Label to "¦©¦©«á "
38324>>>        Set Size to 135 465
38325>>>        Set Location to 7 9
38326>>>
38326>>>        //AB-DDOStart
38326>>>
38326>>>        Object Fpa_DD is a Fpa_DataDictionary
38328>>>
38328>>>            //AB-StoreStart
38328>>>            
38328>>>            
38328>>>            //AB-StoreEnd
38328>>>
38328>>>        End_Object    // Fpa_DD
38329>>>
38329>>>        Set Main_DD to (Fpa_DD(self))
38330>>>        Set Server to (Fpa_DD(self))
38331>>>
38331>>>        //AB-DDOEnd
38331>>>
38331>>>        Object dbGridSub1 is a dbGridSub
38333>>>            Set Main_File to Fpa.File_Number
38334>>>            Set Ordering to 1
38335>>>            Set Size to 110 455
38336>>>            Set Location to 4 3
38337>>>            Set Wrap_State to TRUE
38338>>>
38338>>>            Begin_Row
38341>>>                Entry_Item Fpa.Fpa_pososto
38342>>>                Entry_Item Fpa.Fpa_descr
38343>>>                Entry_Item Fpa.Agora_codegl
38344>>>                Entry_Item Fpa.Polhsh_codegl
38345>>>            End_Row
38350>>>
38350>>>            Set Form_Width    item 0 to 75
38351>>>            Set Header_Label  item 0 to "¦©¦©«æ ..."
38352>>>            
38352>>>            Set Form_Width    item 1 to 95
38353>>>            Set Header_Label  item 1 to "¨ ¨­ã"
38354>>>            
38354>>>            Set Form_Width    item 2 to 135
38355>>>            Set Header_Label  item 2 to "£ã£ ¦¨. . ... ¦¨é¤"
38356>>>            
38356>>>            Set Form_Width    item 3 to 141
38357>>>            Set Header_Label  item 3 to "£ã£ ¦¨. . ... §à¢ã©à¤"
38358>>>            
38358>>>        End_Object    // dbGridSub1
38359>>>
38359>>>    CD_End_Object    // Fpa
38361>>>>
38361>>>
38361>>>//AB/     End_Object    // prj
38361>        Use Glutil.vw                                                                       
INCLUDING FILE: GLUTIL.VW
38361>>>//AB/ Project GL-Utilities
38361>>>//AB/ Object prj is a View_Project
38361>>>//AB/     Set ProjectName to "GL-Utilities"
38361>>>//AB/     Set ProjectFileName to "GLUtil.VW"
38361>>>//AB/     Set GenerateFileName to "NONAME"
38361>>>
38361>>>// Project Object Structure
38361>>>//   GLUTIL is a dbViewSub
38361>>>//     Company_DD is a DataDictionary
38361>>>//     Branch_DD is a DataDictionary
38361>>>//     Year_DD is a DataDictionary
38361>>>//     Gthhmgio_DD is a DataDictionary
38361>>>//     Gtypkin_DD is a DataDictionary
38361>>>//     Gplan_DD is a DataDictionary
38361>>>//     Garticl_DD is a DataDictionary
38361>>>//     dbGrpYear is a dbGroupSub
38361>>>//       Company_Company_Name is a dbFormSub
38361>>>//       Branch_Branch_Name is a dbFormSub
38361>>>//       Year_Year_Year is a dbFormSub
38361>>>//       otxtCompany is a TextBoxSub
38361>>>//       otxtBranch is a TextBoxSub
38361>>>//       otxtYear is a TextBoxSub
38361>>>//     dbTabDialogSub1 is a dbTabDialogSub
38361>>>//       TP_REUPDATE_dbTabPageSub1 is a dbTabPageSub
38361>>>//         REUPDATE_ButtonSub is a ButtonSub
38361>>>//       dbTabPageSub2 is a dbTabPageSub
38361>>>//       dbTabPageSub3 is a dbTabPageSub
38361>>>
38361>>>// Register all objects
38361>>>Register_Object Branch_Branch_Name
38361>>>Register_Object Branch_DD
38361>>>Register_Object Company_Company_Name
38361>>>Register_Object Company_DD
38361>>>Register_Object dbGrpYear
38361>>>Register_Object dbTabDialogSub1
38361>>>Register_Object dbTabPageSub2
38361>>>Register_Object dbTabPageSub3
38361>>>Register_Object Garticl_DD
38361>>>Register_Object GLUTIL
38361>>>Register_Object Gplan_DD
38361>>>Register_Object Gthhmgio_DD
38361>>>Register_Object Gtypkin_DD
38361>>>Register_Object otxtBranch
38361>>>Register_Object otxtCompany
38361>>>Register_Object otxtYear
38361>>>Register_Object REUPDATE_ButtonSub
38361>>>Register_Object TP_REUPDATE_dbTabPageSub1
38361>>>Register_Object Year_DD
38361>>>Register_Object Year_Year_Year
38361>>>
38361>>>
38361>>>//AB/ AppBuild VIEW
38361>>>
38361>>>
38361>>>//AB-StoreTopStart
38361>>>Use DoGlmntn.bp
INCLUDING FILE: DOGLMNTN.BP
38361>>>>>// *Comments     : ¡«¢å « ª §¨¡á«à   ¡©åª ©¬¤«ã¨©ª:             *
38361>>>>>// *             : 1. xorigise.aa                                           *
38361>>>>>// *             : 2. zero.aa                                               *
38361>>>>>// *             :                                                          *
38361>>>>>
38361>>>>>//1000: «¦ ©ç©«£ â¤ § «¨â§  «¤ ®¦¨ã© 
38361>>>>>//1001 //â¤ ¨ã¡ «¦ year
38361>>>>>//1002 //« garticls â¤ å¤  â«¦ £   ®¦¨ã© 
38361>>>>>//1003 //«¦ gthaa â®  á¢¢ £¨¦£¤å
38361>>>>>//1004 //«¦ gthaa â®  á¢¢¦¤ /
38361>>>>>//1005 // £¨¦£¤å §¦¬ é©« å¤  §¨¦¤â©«¨
38361>>>>>//     //§æ «¤ «¢¬«å £/¤å ®¦¨ã©ª /
38361>>>>>//     //©«¦ ligthhmgio_code
38361>>>>>//1006 //garticl not valid!
38361>>>>>//1007 //«¦ garticl â¤ ©é¡
38361>>>>>//1008 //â¤ ©¬£­à¤¦ç¤ 1 + 2
38361>>>>>
38361>>>>>//         !!!  DDA  AUGMENTED CLASS METHODS !
38361>>>>>
38361>>>>>
38361>>>>>// *             :                                                          *
38361>>>>>// *nown bugs   :                                                          *
38361>>>>>// *             :                                                          *
38361>>>>>// *Improvements :                                                          *
38361>>>>>// *             :                                                          *
38361>>>>>// *             :                                                          *
38361>>>>>// *             :                                                          *
38361>>>>>// **************************************************************************
38361>>>>>// *                        A N A L Y S I S                                 *
38361>>>>>// **************************************************************************
38361>>>>>// *                                                                        *
38361>>>>>// **************************************************************************
38361>>>>>
38361>>>>>
38361>>>>>
38361>>>>>
38361>>>>>//------------------------------------------------------------------ddo tree
38361>>>>>//        gthhmgio               company
38361>>>>>//           I                     I
38361>>>>>//           I                   branch
38361>>>>>//           I                     I
38361>>>>>//           I                    year
38361>>>>>//           I                     I
38361>>>>>//           I----------I----------I------------I
38361>>>>>//                      I                       I
38361>>>>>//                    gtypkin                 gplan
38361>>>>>//                      I                       I
38361>>>>>//                      I                       I
38361>>>>>//                    garticl                   I
38361>>>>>//                      I                       I
38361>>>>>//                     ccc                      I
38361>>>>>//                      I                       I
38361>>>>>//                      I---------I-------------I
38361>>>>>//                              Gmove
38361>>>>>//                                I
38361>>>>>//                               ccc
38361>>>>>//                                I
38361>>>>>//                              Gopen
38361>>>>>//------------------------------------------------------------------ddo tree
38361>>>>>
38361>>>>>
38361>>>>>Use Wait.dg
38361>>>>>
38361>>>>>Use Company.dd
38361>>>>>Use Branch.dd
38361>>>>>Use Year.dd
38361>>>>>Use Gthhmgio.dd
38361>>>>>Use Gtypkin.dd
38361>>>>>Use Garticl.dd
INCLUDING FILE: GARTICL.DD
38361>>>>>>>//DDB-FileStart
38361>>>>>>>//DDB-HeaderStart
38361>>>>>>>
38361>>>>>>>// File Name : GARTICL.DD
38361>>>>>>>// Class Name: Garticl_DataDictionary
38361>>>>>>>// Revision  : 120
38361>>>>>>>// Version   : 2
38361>>>>>>>
38361>>>>>>>Use  Windows           // Basic Definitions
38361>>>>>>>Use  DataDict          // DataDictionary Class Definition
38361>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38361>>>>>>>
38361>>>>>>>Open Garticl
38363>>>>>>>Open Gmove
38365>>>>>>>Open Gpmoves
38367>>>>>>>Open Gmovea
38369>>>>>>>Open Gtypkin
38371>>>>>>>Open Gthaa
38373>>>>>>>Open Sysrecg
38375>>>>>>>
38375>>>>>>>//DDB-HeaderEnd
38375>>>>>>>//DDB-ValidationStart
38375>>>>>>>
38375>>>>>>>Register_Object Garticl_Garticl_A_Code_VT
38375>>>>>>>Register_Object Garticl_Garticl_C_Code2_VT
38375>>>>>>>Register_Object Garticl_Garticl_Statuse_VT
38375>>>>>>>Register_Object Garticl_Garticl_M_Code_VT
38375>>>>>>>
38375>>>>>>>Object Garticl_Garticl_A_Code_VT  is a CodeValidationTable
38377>>>>>>>    Set Type_Value        To "AITIOL"
38378>>>>>>>    Set Validate_State    To FALSE
38379>>>>>>>    Set Allow_Blank_State To TRUE
38380>>>>>>>    //DDB-ValidationCustomStart
38380>>>>>>>    //DDB-ValidationCustomEnd
38380>>>>>>>End_Object   // Garticl_Garticl_A_Code_VT
38381>>>>>>>
38381>>>>>>>Object Garticl_Garticl_C_Code2_VT  is a CodeValidationTable
38383>>>>>>>    Set Type_Value        To "CURRENCY"
38384>>>>>>>    Set Allow_Blank_State To TRUE
38385>>>>>>>    //DDB-ValidationCustomStart
38385>>>>>>>    //DDB-ValidationCustomEnd
38385>>>>>>>End_Object   // Garticl_Garticl_C_Code2_VT
38386>>>>>>>
38386>>>>>>>Object Garticl_Garticl_Statuse_VT  is a DescriptionValidationTable
38388>>>>>>>
38388>>>>>>>    Procedure Fill_List
38390>>>>>>>        Forward Send Fill_List
38392>>>>>>>        Send Add_Table_Value  "0"  "¨¦©à¨ ¤ã"
38393>>>>>>>        Send Add_Table_Value  "1"  "¤£¨à£â¤"
38394>>>>>>>        Send Add_Table_Value  "-1"  "¨ ¡ã"
38395>>>>>>>    End_Procedure    // Fill_List
38396>>>>>>>    //DDB-ValidationCustomStart
38396>>>>>>>    //DDB-ValidationCustomEnd
38396>>>>>>>End_Object   // Garticl_Garticl_Statuse_VT
38397>>>>>>>
38397>>>>>>>Object Garticl_Garticl_M_Code_VT  is a CodeValidationTable
38399>>>>>>>    Set Type_Value        To "MODULE"
38400>>>>>>>    Set Allow_Blank_State To TRUE
38401>>>>>>>    //DDB-ValidationCustomStart
38401>>>>>>>    //DDB-ValidationCustomEnd
38401>>>>>>>End_Object   // Garticl_Garticl_M_Code_VT
38402>>>>>>>//DDB-ValidationEnd
38402>>>>>>>//DDB-SelectionStart
38402>>>>>>>//DDB/ ExternalSelectionList Garticl  Garticl.SL
38402>>>>>>>Register_Object Garticl
38402>>>>>>>//DDB-SelectionEnd
38402>>>>>>>Open Rates
INCLUDING FILE: RATES.FD
38404>>>>>>>
38404>>>>>>>Register_Object oDo_Change_Garticl
38404>>>>>>>//Use Docnggar.bp
38404>>>>>>>
38404>>>>>>>Use Gmovea.dd //®¨ á«  ¦§àã§¦«,  æ«  å¤  alias file ¡ 
38404>>>>>>>              //©«¤ begin_transaction §¨¦¡¢å deadlock
38404>>>>>>>
38404>>>>>>>Class Garticl_DataDictionary  is a DataDictionary_Sec
38405>>>>>>>
38405>>>>>>>      //private
38405>>>>>>>      //¡¢å«  §¦ «¤ request_save ¡  £¤å  æ¢ « properties
38405>>>>>>>      Procedure private.Initialize_Properties
38406>>>>>>>                 //£¤ ©£æª §¢ é¤
38406>>>>>>>                 Set psB_Gtypkin_Recr    to ''
38407>>>>>>>                 Set pdB_Garticl_Hmnia   to 0
38408>>>>>>>                 Set piB_Garticl_No      to 0
38409>>>>>>>                 Set psB_Garticl_C_Code2 to ""
38410>>>>>>>                 Set pnB_Garticl_Rate0   to 0
38411>>>>>>>                 Set pnB_Garticl_Rate00  to 0
38412>>>>>>>                 Set pnB_Garticl_RateR   to 0
38413>>>>>>>                 Set piB_Garticl_Aa      to 0
38414>>>>>>>
38414>>>>>>>                 //£¤ ©£æª ¤âà¤
38414>>>>>>>                 Set psA_Gtypkin_Recr    to ''
38415>>>>>>>                 Set pdA_Garticl_Hmnia   to 0
38416>>>>>>>                 Set piA_Garticl_No      to 0
38417>>>>>>>                 Set psA_Garticl_C_Code2 to ""
38418>>>>>>>                 Set pnA_Garticl_Rate0   to 0
38419>>>>>>>                 Set pnA_Garticl_Rate00  to 0
38420>>>>>>>                 Set pnA_Garticl_RateR   to 0
38421>>>>>>>                 Set piA_Garticl_Aa      to 0
38422>>>>>>>
38422>>>>>>>                 //properties   «¦¤ â¢®¦ «¦¬ 
38422>>>>>>>                 Set pnA_Garticl_SX2     to 0
38423>>>>>>>                 Set pnA_Garticl_SP2     to 0
38424>>>>>>>                 Set pnA_Garticl_SX0     to 0
38425>>>>>>>                 Set pnA_Garticl_SP0     to 0
38426>>>>>>>                 Set pnA_Garticl_SX00    to 0
38427>>>>>>>                 Set pnA_Garticl_SP00    to 0
38428>>>>>>>                 Set pnA_Garticl_SXR     to 0
38429>>>>>>>                 Set pnA_Garticl_SPR     to 0
38430>>>>>>>                 Set pnA_Garticl_SX1     to 0
38431>>>>>>>                 Set pnA_Garticl_SP1     to 0
38432>>>>>>>
38432>>>>>>>                 Set pnB_Garticl_SX2     to 0
38433>>>>>>>                 Set pnB_Garticl_SP2     to 0
38434>>>>>>>                 Set pnB_Garticl_SX0     to 0
38435>>>>>>>                 Set pnB_Garticl_SP0     to 0
38436>>>>>>>                 Set pnB_Garticl_SX00    to 0
38437>>>>>>>                 Set pnB_Garticl_SP00    to 0
38438>>>>>>>                 Set pnB_Garticl_SXR     to 0
38439>>>>>>>                 Set pnB_Garticl_SPR     to 0
38440>>>>>>>                 Set pnB_Garticl_SX1     to 0
38441>>>>>>>                 Set pnB_Garticl_SP1     to 0
38442>>>>>>>
38442>>>>>>>      End_Procedure //private.Initialize_Properties
38443>>>>>>>
38443>>>>>>>
38443>>>>>>>    //private
38443>>>>>>>    //¡¢å«  §¦ «¤ update ¡  ©«á¨  hard-coded to garticl_statuse
38443>>>>>>>    //   ¤ à¨å â¤ á¨¨¦ â¡¬¨¦ §¨¦©à¨ ¤æ, §¨â§ 
38443>>>>>>>    // 1. ¤ â®  æ¢ «¦¬ « ¬§æ¢¦ § ¡  ©« 4 ¤¦£å©£« £¤ ¡á
38443>>>>>>>    // Garticl.Garticl_Syp0  = 0 and
38443>>>>>>>    // Garticl.Garticl_Syp00 = 0 and
38443>>>>>>>    // Garticl.Garticl_Sypr  = 0 and
38443>>>>>>>    // Garticl.Garticl_Syp2  = 0
38443>>>>>>>    // 2. ¤ â®  «¦¬¢á® ©«¦¤ 1 ¨££ã ®¨âà©ª ¡  1 ¨££ã §å©«à©ª
38443>>>>>>>    // Garticl.Garticl_Xreline >= 1 and
38443>>>>>>>    // Garticl.Garticl_Pisline >= 1
38443>>>>>>>    // 3. ¤ â®  «¦¬¢á® ©«¦¤ 2 gmoves (¬«æ £á¢¢¦¤ å¤  §¢¦¤©£æª)
38443>>>>>>>    // Garticl.Garticl_Mlines >= 2
38443>>>>>>>    // á¤ â©«à ¡  £å §¦ « ª §¨§á¤à 3 ©¬¤ã¡ª â¤  ©®ç , «æ«
38443>>>>>>>    // «¦ á¨¨¦ à¨å«  under construction ¡  â®  statuse=(-1)
38443>>>>>>>    //
38443>>>>>>>    // §å©ª, á¤ ¡  ¦  3 §¨§á¤à ©¬¤ã¡ª  ©®ç¦¬¤ (¦§æ« â®à statuse=0,
38443>>>>>>>    // «æ«:
38443>>>>>>>    // ap) á¤ flag 06 (¬¥á¤   à¢ã©à¤ (+§¢ã¦ª)
38443>>>>>>>    //     ap.1. ¨â§  ¤ â®  «¦¤ ¨ £æ 1 ©«¦     Garticl_MyfNump and
38443>>>>>>>    //     ap.2. ¨â§  ¤ â®  valid Gplan_Code ©«¦ Garticl_MyfCodp and
38443>>>>>>>    //     ap.3. ¨â§  ¤ â®  «¦¤ ¨ £æ 1 ©«¦      Garticl_MyfChkp
38443>>>>>>>    // bp) á¤ flag 07 (¬¥á¤   à¢ã©à¤ (+¥å)
38443>>>>>>>    //     bp.1. ¨â§  ¤ â®  « ¡ã « £ã  ©«¦     Garticl_MyfValp and
38443>>>>>>>    //     bp.2. ¨â§  ¤ â®  valid Gplan_Code ©«¦ Garticl_MyfCodp and
38443>>>>>>>    //     bp.3. ¨â§  ¤ â®  «¦¤ ¨ £æ 1 ©«¦      Garticl_MyfChkp
38443>>>>>>>    // cp) á¤ flag 08 (£ é¤   à¢ã©à¤ (-§¢ã¦ª)
38443>>>>>>>    //     cp.1. ¨â§  ¤ â®  «¦¤ ¨ £æ (-1) ©«¦  Garticl_MyfNump and
38443>>>>>>>    //     cp.2. ¨â§  ¤ â®  valid Gplan_Code ©«¦ Garticl_MyfCodp and
38443>>>>>>>    //     cp.3. ¨â§  ¤ â®  «¦¤ ¨ £æ 1 ©«¦      Garticl_MyfChkp
38443>>>>>>>    // dp) á¤ flag 09 (£ é¤   à¢ã©à¤ (-¥å)
38443>>>>>>>    //     dp.1. ¨â§  ¤ â®  ¨¤« ¡ã « £ã  ©«¦   Garticl_MyfValp and
38443>>>>>>>    //     dp.2. ¨â§  ¤ â®  valid Gplan_Code ©«¦ Garticl_MyfCodp and
38443>>>>>>>    //     dp.3. ¨â§  ¤ â®  «¦¤ ¨ £æ 1 ©«¦      Garticl_MyfChkp
38443>>>>>>>    // ¨æ£¦ ª ©¬¤ã¡ª  ©®ç¦¬¤ ¡    «¤  ¦¨é¤ (aa ba ca da)
38443>>>>>>>    //á¤ «¦ á¨¨¦ å¤  â¡¬¨¦ §¨¦©à¨ ¤á ¡  â®   > 0 , «æ« å¤  â¡¬¨¦ ¤£¨à£â¤¦
38443>>>>>>>    Function private.fiCurrent_Garticl_Status Returns Integer
38444>>>>>>>
38444>>>>>>>             //************************************************************
38444>>>>>>>             //*                                          *
38444>>>>>>>             //************************************************************
38444>>>>>>>
38444>>>>>>>             //â¢®¦ª ©¬¤ã¡ª 1 (§¨¦©¦®ã ©« ¬§æ¢¦ § ¢æà  ©¦« £åª!!!!
38444>>>>>>>             //                    â¤ £¤å¦¬¤, á¤ â¤ «¨â¥   check_Arthro_for_ypoloipo
38444>>>>>>>             If (Not(;                 (Garticl.Garticl_Syp0  = 0) and;                 (Garticl.Garticl_Syp00 = 0) and;                 (Garticl.Garticl_Sypr  = 0) and;                 (Garticl.Garticl_Syp2  = 0);                )) Function_Return (-1)
38447>>>>>>>
38447>>>>>>>             //â¢®¦ª ©¬¤ã¡ª 2
38447>>>>>>>             If (Not(;                 (Garticl.Garticl_Xreline >= 1) and;                 (Garticl.Garticl_Pisline >= 1);                )) Function_Return (-1)
38450>>>>>>>
38450>>>>>>>             //â¢®¦ª ©¬¤ã¡ª 3
38450>>>>>>>             If (Not(;                 (Garticl.Garticl_Mlines >= 2);                )) Function_Return (-1)
38453>>>>>>>
38453>>>>>>>             //************************************************************
38453>>>>>>>             //*                                               *
38453>>>>>>>             //************************************************************
38453>>>>>>>             //â¢®¦ª ©¬¤ã¡ª ap {flag 06:¬¥á¤   à¢ã©à¤ (+§¢ã¦ª)}
38453>>>>>>>             If (Gtypkin.Gtypkin_Flag06 = TRUE);             Begin
38455>>>>>>>                  If (Not(;                      (Garticl.Garticl_Myfnump  = 1 )   and;                      (Garticl.Garticl_MyfCodp <> "") and;                      (Garticl.Garticl_Myfchkp  = 1 );                     )) Function_Return (-1)
38458>>>>>>>             End
38458>>>>>>>>
38458>>>>>>>
38458>>>>>>>             //â¢®¦ª ©¬¤ã¡ª bp {(flag 07:¬¥á¤   à¢ã©à¤ (+¥å)}
38458>>>>>>>             If (Gtypkin.Gtypkin_Flag07 = TRUE);             Begin
38460>>>>>>>                  If (Not(;                      (Garticl.Garticl_MyfValp  > 0 ) and;                      (Garticl.Garticl_MyfCodp <> "") and;                      (Garticl.Garticl_Myfchkp  = 1 );                     )) Function_Return (-1)
38463>>>>>>>             End
38463>>>>>>>>
38463>>>>>>>
38463>>>>>>>             //â¢®¦ª ©¬¤ã¡ª cp {flag 08:£ é¤   à¢ã©à¤ (-§¢ã¦ª)}
38463>>>>>>>             If (Gtypkin.Gtypkin_Flag08 = TRUE);             Begin
38465>>>>>>>                  If (Not(;                      (Garticl.Garticl_Myfnump  = (-1)) and;                      (Garticl.Garticl_MyfCodp <>  "" ) and;                      (Garticl.Garticl_Myfchkp  =   1 );                     )) Function_Return (-1)
38468>>>>>>>             End
38468>>>>>>>>
38468>>>>>>>
38468>>>>>>>             //â¢®¦ª ©¬¤ã¡ª dp {(flag 07:£ é¤   à¢ã©à¤ (-¥å)}
38468>>>>>>>             If (Gtypkin.Gtypkin_Flag09 = TRUE);             Begin
38470>>>>>>>                  If (Not(;                      (Garticl.Garticl_MyfValp <  0 ) and;                      (Garticl.Garticl_MyfCodp <> "") and;                      (Garticl.Garticl_Myfchkp  = 1 );                     )) Function_Return (-1)
38473>>>>>>>             End
38473>>>>>>>>
38473>>>>>>>
38473>>>>>>>             //************************************************************
38473>>>>>>>             //*                                                 *
38473>>>>>>>             //************************************************************
38473>>>>>>>             //â¢®¦ª ©¬¤ã¡ª aa {flag 10:¬¥á¤   ¦¨é¤ (+§¢ã¦ª)}
38473>>>>>>>             If (Gtypkin.Gtypkin_Flag10 = TRUE);             Begin
38475>>>>>>>                  If (Not(;                      (Garticl.Garticl_Myfnuma  = 1 )   and;                      (Garticl.Garticl_MyfCoda <> "") and;                      (Garticl.Garticl_Myfchka  = 1 );                     )) Function_Return (-1)
38478>>>>>>>             End
38478>>>>>>>>
38478>>>>>>>
38478>>>>>>>             //â¢®¦ª ©¬¤ã¡ª ba {(flag 11:¬¥á¤   ¦¨é¤ (+¥å)}
38478>>>>>>>             If (Gtypkin.Gtypkin_Flag11 = TRUE);             Begin
38480>>>>>>>                  If (Not(;                      (Garticl.Garticl_MyfVala  > 0 ) and;                      (Garticl.Garticl_MyfCoda <> "") and;                      (Garticl.Garticl_Myfchka  = 1 );                     )) Function_Return (-1)
38483>>>>>>>             End
38483>>>>>>>>
38483>>>>>>>
38483>>>>>>>             //â¢®¦ª ©¬¤ã¡ª ca {flag 12:£ é¤   ¦¨é¤ (-§¢ã¦ª)}
38483>>>>>>>             If (Gtypkin.Gtypkin_Flag12 = TRUE);             Begin
38485>>>>>>>                  If (Not(;                      (Garticl.Garticl_Myfnuma  = (-1)) and;                      (Garticl.Garticl_MyfCoda <>  "" ) and;                      (Garticl.Garticl_Myfchka  =   1 );                     )) Function_Return (-1)
38488>>>>>>>             End
38488>>>>>>>>
38488>>>>>>>
38488>>>>>>>             //â¢®¦ª ©¬¤ã¡ª da {(flag 13:£ é¤   ¦¨é¤ (-¥å)}
38488>>>>>>>             If (Gtypkin.Gtypkin_Flag13 = TRUE);             Begin
38490>>>>>>>                  If (Not(;                      (Garticl.Garticl_MyfVala <  0 ) and;                      (Garticl.Garticl_MyfCoda <> "") and;                      (Garticl.Garticl_Myfchka  = 1 );                     )) Function_Return (-1)
38493>>>>>>>             End
38493>>>>>>>>
38493>>>>>>>
38493>>>>>>>             //á¤ å¤  æ¢ ok ¡  «¦ garticl å¤  ¦¨ ©« ¡¦§¦ £â¤¦,
38493>>>>>>>             //«æ« statuse = 1
38493>>>>>>>             If (Garticl.Garticl_Aa > 0) Function_Return 1 //valid ¤£¨à£â¤
38496>>>>>>>             Else                        Function_Return 0 //valid §¨¦©à¨ ¤ã
38498>>>>>>>    End_Function //private.ficurrent_garticl_status
38499>>>>>>>
38499>>>>>>>
38499>>>>>>>      //private
38499>>>>>>>      //¨å©¡  á¤ § «¨â§«   «¨¦§¦§¦å© (edit) «¦¬ «¨â®¦¤«¦ª Gmove record
38499>>>>>>>      //© ©¬¤á¨«© £ «¦¤ / «¦¬ á¨¨¦¬.
38499>>>>>>>      //¡¢å«  §æ validate_save, ¡  ¢ «¦¬¨å £ «¤ ¥ãª ¢¦ ¡ã:
38499>>>>>>>      //1.æ¢ « ¤â Gmove §¨â§  ¤ â®¦¬ =0
38499>>>>>>>      //2.£æ¤¦¤ ¦  bp's Do_Cascade_Update
38499>>>>>>>      //                xorigise_aa           (limode=1)
38499>>>>>>>      //                zero_aa               (limode=2)
38499>>>>>>>      //£§¦¨¦ç¤ ¤ ¢¢á¥¦¬¤ «¦¤ 
38499>>>>>>>      //© æ¢ª « ª á¢¢ª §¨ §«é© ª, á¤ >0 §¦¨ç«  «¦ edit «à¤ ¡¨å© £à¤ §åà¤
38499>>>>>>>      //
38499>>>>>>>      //For example, you could build a validation routine that only applies a field validation
38499>>>>>>>      //to new records (check the records status with the current_record property)
38499>>>>>>>
38499>>>>>>>      //or you could create validation routines that selectively skip certain fields
38499>>>>>>>      //when they are foreign (the operation_origin global integer tells you which
38499>>>>>>>      //DSO started the save).
38499>>>>>>>
38499>>>>>>>      Function private.fiCheck_Garticl_Aa Returns Integer
38500>>>>>>>               Integer  liCurrent_Record liCheck
38501>>>>>>>               Integer  lbAll_Critical_Fields_Are_Not_Changed
38501>>>>>>>               Integer  lbAll_Computed_Fields_Are_Not_Changed
38501>>>>>>>
38501>>>>>>>               Integer  liMode
38501>>>>>>>
38501>>>>>>>               Integer  lsB_Gtypkin_Recr     lsA_Gtypkin_Recr
38501>>>>>>>               Date     ldB_Garticl_Hmnia    ldA_Garticl_Hmnia
38501>>>>>>>               Integer  liB_Garticl_No       liA_Garticl_No
38501>>>>>>>               String   lsB_Garticl_C_Code2  lsA_Garticl_C_Code2
38501>>>>>>>               Number   lnB_Garticl_Rate0    lnA_Garticl_Rate0
38501>>>>>>>               Number   lnB_Garticl_Rate00   lnA_Garticl_Rate00
38501>>>>>>>               Number   lnB_Garticl_RateR    lnA_Garticl_RateR
38501>>>>>>>               Integer  liB_Garticl_Aa       liA_Garticl_Aa
38501>>>>>>>
38501>>>>>>>               Number   lnB_Garticl_SX2      lnA_Garticl_SX2
38501>>>>>>>               Number   lnB_Garticl_SP2      lnA_Garticl_SP2
38501>>>>>>>               Number   lnB_Garticl_SX0      lnA_Garticl_SX0
38501>>>>>>>               Number   lnB_Garticl_SP0      lnA_Garticl_SP0
38501>>>>>>>               Number   lnB_Garticl_SX00     lnA_Garticl_SX00
38501>>>>>>>               Number   lnB_Garticl_SP00     lnA_Garticl_SP00
38501>>>>>>>               Number   lnB_Garticl_SXR      lnA_Garticl_SXR
38501>>>>>>>               Number   lnB_Garticl_SPR      lnA_Garticl_SPR
38501>>>>>>>               Number   lnB_Garticl_SX1      lnA_Garticl_SX1
38501>>>>>>>               Number   lnB_Garticl_SP1      lnA_Garticl_SP1
38501>>>>>>>
38501>>>>>>>               Get piMode to liMode
38502>>>>>>>
38502>>>>>>>               //â¢®¦ª á¤ £ ¦¬¨é ¤â¦ record
38502>>>>>>>               Get Current_Record to liCurrent_Record
38503>>>>>>>               If (liCurrent_Record = 0);               Begin //£ ¦¬¨å ¤â¦¬ garticl £æ¤¦¤ £ limode=0 ¡  =0
38505>>>>>>>                 If (liMode             <> 0) Function_Return 1 //not valid
38508>>>>>>>                 If (Garticl.Garticl_Aa <> 0) Function_Return 1 //not valid
38511>>>>>>>                 Else                         Function_Return 0 //valid
38513>>>>>>>               End
38513>>>>>>>>
38513>>>>>>>
38513>>>>>>>               //¤á¤à© §¢ é¤ « £é¤
38513>>>>>>>               Get psB_Gtypkin_Recr     to lsB_Gtypkin_Recr
38514>>>>>>>               Get pdB_Garticl_Hmnia    to ldB_Garticl_Hmnia
38515>>>>>>>               Get piB_Garticl_No       to liB_Garticl_No
38516>>>>>>>               Get psB_Garticl_C_Code2  to lsB_Garticl_C_Code2
38517>>>>>>>               Get pnB_Garticl_Rate0    to lnB_Garticl_Rate0
38518>>>>>>>               Get pnB_Garticl_Rate00   to lnB_Garticl_Rate00
38519>>>>>>>               Get pnB_Garticl_RateR    to lnB_Garticl_RateR
38520>>>>>>>               Get piB_Garticl_Aa       to liB_Garticl_Aa
38521>>>>>>>
38521>>>>>>>               Get pnB_Garticl_SX2      to lnB_Garticl_SX2
38522>>>>>>>               Get pnB_Garticl_SP2      to lnB_Garticl_SP2
38523>>>>>>>               Get pnB_Garticl_SX0      to lnB_Garticl_SX0
38524>>>>>>>               Get pnB_Garticl_SP0      to lnB_Garticl_SP0
38525>>>>>>>               Get pnB_Garticl_SX00     to lnB_Garticl_SX00
38526>>>>>>>               Get pnB_Garticl_SP00     to lnB_Garticl_SP00
38527>>>>>>>               Get pnB_Garticl_SXR      to lnB_Garticl_SXR
38528>>>>>>>               Get pnB_Garticl_SPR      to lnB_Garticl_SPR
38529>>>>>>>               Get pnB_Garticl_SX1      to lnB_Garticl_SX1
38530>>>>>>>               Get pnB_Garticl_SP1      to lnB_Garticl_SP1
38531>>>>>>>
38531>>>>>>>               //¤á¤à© ¤âà¤ « £é¤
38531>>>>>>>               Get psA_Gtypkin_Recr     to lsA_Gtypkin_Recr
38532>>>>>>>               Get pdA_Garticl_Hmnia    to ldA_Garticl_Hmnia
38533>>>>>>>               Get piA_Garticl_No       to liA_Garticl_No
38534>>>>>>>               Get psA_Garticl_C_Code2  to lsA_Garticl_C_Code2
38535>>>>>>>               Get pnA_Garticl_Rate0    to lnA_Garticl_Rate0
38536>>>>>>>               Get pnA_Garticl_Rate00   to lnA_Garticl_Rate00
38537>>>>>>>               Get pnA_Garticl_RateR    to lnA_Garticl_RateR
38538>>>>>>>               Get piA_Garticl_Aa       to liA_Garticl_Aa
38539>>>>>>>
38539>>>>>>>               Get pnA_Garticl_SX2      to lnA_Garticl_SX2
38540>>>>>>>               Get pnA_Garticl_SP2      to lnA_Garticl_SP2
38541>>>>>>>               Get pnA_Garticl_SX0      to lnA_Garticl_SX0
38542>>>>>>>               Get pnA_Garticl_SP0      to lnA_Garticl_SP0
38543>>>>>>>               Get pnA_Garticl_SX00     to lnA_Garticl_SX00
38544>>>>>>>               Get pnA_Garticl_SP00     to lnA_Garticl_SP00
38545>>>>>>>               Get pnA_Garticl_SXR      to lnA_Garticl_SXR
38546>>>>>>>               Get pnA_Garticl_SPR      to lnA_Garticl_SPR
38547>>>>>>>               Get pnA_Garticl_SX1      to lnA_Garticl_SX1
38548>>>>>>>               Get pnA_Garticl_SP1      to lnA_Garticl_SP1
38549>>>>>>>
38549>>>>>>>               //á¤ æ¢ª ¦  §¨á£«¨¦  before+after å¤  å©ª,
38549>>>>>>>               //«æ« §¦â®¦£  «¦ validation
38549>>>>>>>               Move (;                     (lsB_Gtypkin_Recr   = lsA_Gtypkin_Recr   ) and;                     (ldB_Garticl_Hmnia  = ldA_Garticl_Hmnia  ) and;                     (liB_Garticl_No     = liA_Garticl_No     ) and;                     (lsB_Garticl_C_Code2= lsA_Garticl_C_Code2) and;                     (lnB_Garticl_Rate0  = lnA_Garticl_Rate0  ) and;                     (lnB_Garticl_Rate00 = lnA_Garticl_Rate00 ) and;                     (lnB_Garticl_RateR  = lnA_Garticl_RateR  )    ;                    ) to lbAll_Critical_Fields_Are_Not_Changed
38550>>>>>>>
38550>>>>>>>               Move (;                     (lnB_Garticl_SX2    = lnA_Garticl_SX2    ) and;                     (lnB_Garticl_SP2    = lnA_Garticl_SP2    ) and;                     (lnB_Garticl_SX0    = lnA_Garticl_SX0    ) and;                     (lnB_Garticl_SP0    = lnA_Garticl_SP0    ) and;                     (lnB_Garticl_SX00   = lnA_Garticl_SX00   ) and;                     (lnB_Garticl_SP00   = lnA_Garticl_SP00   ) and;                     (lnB_Garticl_SXR    = lnA_Garticl_SXR    ) and;                     (lnB_Garticl_SPR    = lnA_Garticl_SPR    )    ;                    ) to lbAll_Computed_Fields_Are_Not_Changed
38551>>>>>>>
38551>>>>>>>               Case Begin
38551>>>>>>>                    Case (liMode = 0) //normal operation (edit)
38553>>>>>>>                         If (;                              (liB_Garticl_Aa = 0) and;                              (liA_Garticl_Aa = 0)    ;                            )  Function_Return 0 //valid
38556>>>>>>>                         If (;                             (lbAll_Critical_Fields_Are_Not_Changed = TRUE          ) and;                             (lbAll_Computed_Fields_Are_Not_Changed = TRUE          ) and;                             (liB_Garticl_Aa                        = liA_Garticl_Aa)    ;                             ) Function_Return 0 //valid
38559>>>>>>>                         Else  Function_Return 1 //not valid
38561>>>>>>>                    Case Break
38562>>>>>>>
38562>>>>>>>                    Case (liMode = 1) //®¦¨ã© /
38565>>>>>>>                         Function_Return 0 //14/02/2000  1
38566>>>>>>>                         If (;                             (lbAll_Critical_Fields_Are_Not_Changed = TRUE) and;                             (lbAll_Computed_Fields_Are_Not_Changed = TRUE) and;                             (liB_Garticl_Aa                        = 0   ) and;                             (liA_Garticl_Aa                        > 0   )    ;                             ) Function_Return 0 //valid
38569>>>>>>>                         Else  Function_Return 1 //not valid
38571>>>>>>>                         //  (lnB_Garticl_SX1                       = 0   ) and;
38571>>>>>>>                         //  (lnA_Garticl_SX1                      <> 0   ) and;
38571>>>>>>>                         //  (lnB_Garticl_SP1                       = 0   ) and;
38571>>>>>>>                         //  (lnA_Garticl_SP1                      <> 0   )    ;
38571>>>>>>>                    Case Break
38572>>>>>>>
38572>>>>>>>                    Case (liMode = 2) //£¤ ©£æª /
38575>>>>>>>                         Function_Return 0 //14/02/2000 1
38576>>>>>>>                         If (;                             (lbAll_Critical_Fields_Are_Not_Changed = TRUE) and;                             (lbAll_Computed_Fields_Are_Not_Changed = TRUE) and;                             (liB_Garticl_Aa                        > 0   ) and;                             (liA_Garticl_Aa                        = 0   )    ;                             ) Function_Return 0 //valid
38579>>>>>>>                         Else  Function_Return 1 //not valid
38581>>>>>>>                         //  (lnB_Garticl_SX1                      <> 0   ) and;
38581>>>>>>>                         //  (lnA_Garticl_SX1                       = 0   ) and;
38581>>>>>>>                         //  (lnB_Garticl_SP1                      <> 0   ) and;
38581>>>>>>>                         //  (lnA_Garticl_SP1                       = 0   )    ;
38581>>>>>>>                    Case Break
38582>>>>>>>               Case End
38582>>>>>>>
38582>>>>>>>
38582>>>>>>>               Function_Return 1 //not valid
38583>>>>>>>      End_Function //private.fiGarticl_Aa
38584>>>>>>>
38584>>>>>>>
38584>>>>>>>    //private
38584>>>>>>>    //¨å©¡    «¦ ©¬¡¡¨ £â¤¦ à¨£â¤¦ £¨¦¢æ ¦,
38584>>>>>>>    //«¤ «¢¬«å £¨¦£¤å ®¦¨ã©ª /.
38584>>>>>>>    //á¤ â¤ ¬§á¨®  «â«¦  £¨¦£¤å, § ©«¨â­  «¤ §¨é« £¨¦£¤å «ª ®¨ã©àª
38584>>>>>>>    //¡¢å«  §æ:1. validate_save
38584>>>>>>>    //             2. private.Xorigise_Aa «ª bp oDo_GL_Maintainance (doGlMntn.bp)
38584>>>>>>>    Function private.fdGthaa_Last_Hmnia Integer liGthHmgio_Code Returns Date
38585>>>>>>>             Clear GthAA
38586>>>>>>>             Move SyscurGL.Company_Code to Gthaa.Company_Code
38587>>>>>>>             Move SyscurGL.Branch_Code  to Gthaa.Branch_Code
38588>>>>>>>             Move SyscurGL.Year_Year    to Gthaa.Year_Year
38589>>>>>>>             Move liGthHmgio_Code       to Gthaa.GthHmgio_Code
38590>>>>>>>             Find Eq Gthaa By Index.1 //company_code+branch_code+year_year+gthhmgio_code
38591>>>>>>>>
38591>>>>>>>             If (Found =1);                  Begin //â®  ¦å §¨¦¦¬£â¤àª 
38593>>>>>>>                   Function_Return Gthaa.Gthaa_Lhmnia
38594>>>>>>>                  End
38594>>>>>>>>
38594>>>>>>>             Else Begin //â¤ â®  ¦å 
38595>>>>>>>                    Function_Return SyscurGL.Year_XrhshFrom
38596>>>>>>>                  End
38596>>>>>>>>
38596>>>>>>>    End_Function //private.fdgthaa_last_hmnia
38597>>>>>>>
38597>>>>>>>    //private
38597>>>>>>>    //¨å©¡    «¦ ©¬¡¡¨ £â¤¦ à¨£â¤¦ £¨¦¢æ ¦,
38597>>>>>>>    //«¦¤ «¢¬«å¦ ¨ £æ /.
38597>>>>>>>    //á¤ â¤ ¬§á¨®  «â«¦ ¦ª, § ©«¨â­  0
38597>>>>>>>    //¡¢å«  §æ:1. validate_save
38597>>>>>>>    //             2. private.Xorigise_Aa «ª bp oDo_GL_Maintainance (doGlMntn.bp)
38597>>>>>>>    Function private.fiGthaa_Last_Aa Integer liGthHmgio_Code Returns Integer
38598>>>>>>>             Clear GthAA
38599>>>>>>>             Move SyscurGL.Company_Code to Gthaa.Company_Code
38600>>>>>>>             Move SyscurGL.Branch_Code  to Gthaa.Branch_Code
38601>>>>>>>             Move SyscurGL.Year_Year    to Gthaa.Year_Year
38602>>>>>>>             Move liGthHmgio_Code       to Gthaa.GthHmgio_Code
38603>>>>>>>             Find Eq Gthaa By Index.1 //company_code+branch_code+year_year+gthhmgio_code
38604>>>>>>>>
38604>>>>>>>             If (Found =1);                  Begin //â®  ¦å §¨¦¦¬£â¤àª 
38606>>>>>>>                   Function_Return Gthaa.Gthaa_Laa
38607>>>>>>>                  End
38607>>>>>>>>
38607>>>>>>>             Else Begin //â¤ â®  ¦å 
38608>>>>>>>                    Function_Return 0
38609>>>>>>>                  End
38609>>>>>>>>
38609>>>>>>>    End_Function //private.fdgthaa_last_aa
38610>>>>>>>
38610>>>>>>>
38610>>>>>>>    //private
38610>>>>>>>    //¨å©¡    «¦ ©¬¡¡¨ £â¤¦ ¤æ£ ©£ & £/¤å ¨­ãª
38610>>>>>>>    //«¦ ¤«å©«¦ ®¦ record «¦¬ rates ¡  ©«á¨  « 3 properties.
38610>>>>>>>    //á¤ â¤ ¬§á¨®  record  ©¦« £ é¤, ©«á¨  « properties © -1.
38610>>>>>>>    // function ¬«ã, ¡á¤  2 ¦¬¢ âª:
38610>>>>>>>    //) ¨å©¡  «¤  ©¦« £å 0   «¤ £««¨¦§ã «¦¬ ¤¦£å©£«¦ª ¨­ãª
38610>>>>>>>    //   © ¡ç¨ ¦ ¤æ£ ©£ ®¨ã©ª, ©«á¨¦¤«ª ¤«å©«¦ ® «¦ pnA_Garticl_Rate0,
38610>>>>>>>    // ¡ 
38610>>>>>>>    //) ¨å©¡  « ª  ©¦« £åª 00 ¡  r   «¤ £««¨¦§ã «¦¬ ¤¦£å©£«¦ª ¨­ãª
38610>>>>>>>    //   © ¬«¨ç¦¤ ¤æ£ ©£ ®¨ã©ª ¡  ¤æ£ ©£ reporting,
38610>>>>>>>    //   ©«á¨¦¤«ª ¤«å©«¦ ® « pnA_Garticl_Rate00 ¡  pnA_Garticl_Rater,
38610>>>>>>>    //   á©®« £ « flags 3 ¡  4.
38610>>>>>>>
38610>>>>>>>    //****************************************************************************
38610>>>>>>>    //p r o s o x i   sta rates 2->00 kai 2->r kai 2->0 !!!!!!                   *
38610>>>>>>>    //****************************************************************************
38610>>>>>>>
38610>>>>>>>    //¡¢å«  §¦ «¤ update
38610>>>>>>>    Procedure private.Find_Rates String lsCurrency_C_Code;                                 Date   ldRates_Hmnia
38611>>>>>>>
38611>>>>>>>              If (lsCurrency_C_Code = "");              Begin //â¤ â®  ¦¨ ©å ¤æ£ ©£ ¨­ãª ¡  â¤ £§¦¨é ¤ ¨é  ©¦« £åª
38613>>>>>>>               Set pnA_Garticl_Rate0  to (-1)
38614>>>>>>>               Set pnA_Garticl_Rate00 to (-1)
38615>>>>>>>               Set pnA_Garticl_RateR  to (-1)
38616>>>>>>>               Procedure_Return
38617>>>>>>>              End
38617>>>>>>>>
38617>>>>>>>
38617>>>>>>>              If (lsCurrency_C_Code = Year.Year_C_Code0);              Begin //«¦ ¤æ£ ©£ ¨­ãª  ©¦ç«  £ «¦ ¡ç¨ ¦ ¤æ£ ©£ ®¨ã©ª
38619>>>>>>>               Set pnA_Garticl_Rate0  to 1
38620>>>>>>>               //Set pnA_Garticl_Rate00 to 1
38620>>>>>>>               //Set pnA_Garticl_RateR  to 1
38620>>>>>>>               //Procedure_Return               sosososo ! ! ! !
38620>>>>>>>              End
38620>>>>>>>>
38620>>>>>>>
38620>>>>>>>              //If (ldRates_Hmnia = 0);
38620>>>>>>>              //Begin //â¤ â®  ¦¨ ©å £¨¦£¤å ¨­ãª ¡  â¤ £§¦¨é ¤ ¨é  ©¦« £åª??????
38620>>>>>>>              // Set pnA_Garticl_Rate0  to (-1)
38620>>>>>>>              // Set pnA_Garticl_Rate00 to (-1)
38620>>>>>>>              // Set pnA_Garticl_RateR  to (-1)
38620>>>>>>>              // Procedure_Return
38620>>>>>>>              //End
38620>>>>>>>
38620>>>>>>>
38620>>>>>>>              Clear Rates
38621>>>>>>>              Move lsCurrency_C_Code to Rates.Currency_C_Code
38622>>>>>>>              Move ldRAtes_Hmnia     to Rates.Rates_Hmnia
38623>>>>>>>              Find Eq Rates by Index.1 //currency_c_code+rates_hnmnia
38624>>>>>>>>
38624>>>>>>>              If (Found = 1) Begin
38626>>>>>>>                              Set pnA_Garticl_Rate0  to Rates.Rates_Rate0
38627>>>>>>>                              Set pnA_Garticl_Rate00 to Rates.Rates_Rate00
38628>>>>>>>                              Set pnA_Garticl_RateR  to Rates.Rates_RateR
38629>>>>>>>                             End
38629>>>>>>>>
38629>>>>>>>              Else           Begin
38630>>>>>>>                              Set pnA_Garticl_Rate0  to (-1)
38631>>>>>>>                              Set pnA_Garticl_Rate00 to (-1)
38632>>>>>>>                              Set pnA_Garticl_RateR  to (-1)
38633>>>>>>>
38633>>>>>>>                             End
38633>>>>>>>>
38633>>>>>>>    End_Procedure //private.find_rates
38634>>>>>>>
38634>>>>>>>
38634>>>>>>>    Procedure Construct_Object
38635>>>>>>>              Forward Send Construct_Object
38637>>>>>>>
38637>>>>>>>              Property String  psA_Gtypkin_Recr     ''
38638>>>>>>>              Property Date    pdA_Garticl_Hmnia    0
38639>>>>>>>              Property Integer piA_Garticl_No       0
38640>>>>>>>              Property String  psA_Garticl_C_Code2  ""
38641>>>>>>>              Property Number  pnA_Garticl_Rate0    0
38642>>>>>>>              Property Number  pnA_Garticl_Rate00   0
38643>>>>>>>              Property Number  pnA_Garticl_RateR    0
38644>>>>>>>              Property Integer piA_Garticl_Aa       0
38645>>>>>>>
38645>>>>>>>              Property String  psB_Gtypkin_Recr     ''
38646>>>>>>>              Property Date    pdB_Garticl_Hmnia    0
38647>>>>>>>              Property Integer piB_Garticl_No       0
38648>>>>>>>              Property String  psB_Garticl_C_Code2  ""
38649>>>>>>>              Property Number  pnB_Garticl_Rate0    0
38650>>>>>>>              Property Number  pnB_Garticl_Rate00   0
38651>>>>>>>              Property Number  pnB_Garticl_RateR    0
38652>>>>>>>              Property Integer piB_Garticl_Aa       0
38653>>>>>>>
38653>>>>>>>              Property Integer piDo_Change_Garticl  0 //object id «ª business process
38654>>>>>>>                                                      //§¦¬ ¢¢á  « 8 §å ©«¦ Gmove
38654>>>>>>>
38654>>>>>>>              //-----------------------------------------properties   «¦¤ â¢®¦ «¦¬ 
38654>>>>>>>              Property Integer piMode               0  // 0 : regular data entry operation
38655>>>>>>>                                                       // 1 : ®¦¨ã© /
38655>>>>>>>                                                       // 2 : £¤ ©£æª /
38655>>>>>>>
38655>>>>>>>              Property Number  pnB_Garticl_SX2      0  //X2          2:¤¦£ ©£ ¨­ãª
38656>>>>>>>              Property Number  pnB_Garticl_SP2      0  //P2
38657>>>>>>>              Property Number  pnB_Garticl_SX0      0  //x0          0:¡ç¨ ¦ ¤æ£ ©£ ®¨ã©ª
38658>>>>>>>              Property Number  pnB_Garticl_SP0      0  //p0
38659>>>>>>>              Property Number  pnB_Garticl_SX00     0  //x00         00:¬«¨ç¦¤ ¤æ£ ©£ ®¨ã©ª
38660>>>>>>>              Property Number  pnB_Garticl_SP00     0  //p00
38661>>>>>>>              Property Number  pnB_Garticl_SXR      0  //xr          r:¤æ£ ©£ reporting
38662>>>>>>>              Property Number  pnB_Garticl_SPR      0  //pr
38663>>>>>>>              Property Number  pnB_Garticl_SX1      0  //X1          0:¡ç¨ ¦ ¤æ£ ©£ ®¨ã©ª ¦¨ ©« ¡¦§¦ £â¤
38664>>>>>>>              Property Number  pnB_Garticl_SP1      0  //P1
38665>>>>>>>
38665>>>>>>>              Property Number  pnA_Garticl_SX2      0  //X2          2:¤¦£ ©£ ¨­ãª
38666>>>>>>>              Property Number  pnA_Garticl_SP2      0  //P2
38667>>>>>>>              Property Number  pnA_Garticl_SX0      0  //x0          0:¡ç¨ ¦ ¤æ£ ©£ ®¨ã©ª
38668>>>>>>>              Property Number  pnA_Garticl_SP0      0  //p0
38669>>>>>>>              Property Number  pnA_Garticl_SX00     0  //x00         00:¬«¨ç¦¤ ¤æ£ ©£ ®¨ã©ª
38670>>>>>>>              Property Number  pnA_Garticl_SP00     0  //p00
38671>>>>>>>              Property Number  pnA_Garticl_SXR      0  //xr          r:¤æ£ ©£ reporting
38672>>>>>>>              Property Number  pnA_Garticl_SPR      0  //pr
38673>>>>>>>              Property Number  pnA_Garticl_SX1      0  //X1          0:¡ç¨ ¦ ¤æ£ ©£ ®¨ã©ª ¦¨ ©« ¡¦§¦ £â¤
38674>>>>>>>              Property Number  pnA_Garticl_SP1      0  //P1
38675>>>>>>>
38675>>>>>>>
38675>>>>>>>              Property Integer piButton_id          0  //  ¤ £¦¬ å®¤   cascade update
38676>>>>>>>                                                       //« gmove recnums
38676>>>>>>>              //-----------------------------------------properties   «¦¤ â¢®¦ «¦¬ 
38676>>>>>>>
38676>>>>>>>              Property Integer piMustNotConstrain Public 0
38677>>>>>>>              
38677>>>>>>>              Property Integer piDoNotValidateMe  Public 0
38678>>>>>>>    End_Procedure   //construct_object
38679>>>>>>>
38679>>>>>>>
38679>>>>>>>    Procedure End_Construct_Object
38680>>>>>>>              Forward Send End_Construct_Object
38682>>>>>>>              Set piDo_Change_Garticl to (oDo_Change_Garticl(Self))
38683>>>>>>>              Send Remove_Client_File Gmovea.File_Number
38684>>>>>>>    End_Procedure   //end_construct_object
38685>>>>>>>
38685>>>>>>>
38685>>>>>>>    Procedure OnConstrain
38686>>>>>>>        Forward Send OnConstrain
38688>>>>>>>        If (piMustNOTConstrain(Self)) Begin
38690>>>>>>>        End
38690>>>>>>>>
38690>>>>>>>        Else Begin
38691>>>>>>>            Constrain Garticl.Company_Code  eq SysCurGL.Company_Code
38693>>>>>>>            Constrain Garticl.Branch_Code   eq SysCurGL.Branch_Code
38695>>>>>>>            Constrain Garticl.Year_Year     eq SysCurGL.Year_Year
38697>>>>>>>        End
38697>>>>>>>>
38697>>>>>>>    End_Procedure
38698>>>>>>>
38698>>>>>>>    //) ¤£â¨à© £ã related §åà¤
38698>>>>>>>    //) ¤á¤à© properties
38698>>>>>>>    //)  ®å¨ © calculated §åà¤
38698>>>>>>>    //) ¤£â¨à© ¨¦ ©«é¤ (adjust_balances)
38698>>>>>>>    //) ¤£â¨à© properties after
38698>>>>>>>    Procedure Update
38699>>>>>>>              Number lnIsotimia## lnIsotimia1##
38700>>>>>>>              Forward Send Update
38702>>>>>>>
38702>>>>>>>              //) ¤£â¨à© £ã related §åà¤
38702>>>>>>>              Move SyscurGL.Company_Code  to Garticl.Company_Code
38703>>>>>>>              Move SyscurGL.Branch_Code   to Garticl.Branch_Code
38704>>>>>>>              Move SyscurGL.Year_Year     to Garticl.Year_Year
38705>>>>>>>              Move Gtypkin.Gtypkin_Code   to Garticl.Gtypkin_Code
38706>>>>>>>
38706>>>>>>>              Move Gthhmgio.Gthhmgio_Code to Garticl.Gthhmgio_Code
38707>>>>>>>
38707>>>>>>>              //) ¤á¤à© properties
38707>>>>>>>
38707>>>>>>>              //)  ®å¨ © calculated §åà¤ 01:garticl_hmnia
38707>>>>>>>              //                                02:garticl_rate0
38707>>>>>>>              //                                03:garticl_rate00
38707>>>>>>>              //                                04:garticl_rater
38707>>>>>>>              //                                05:garticl_c_code2
38707>>>>>>>              //                                06:garticl_MyfNump
38707>>>>>>>              //                                07:garticl_MyfNuma
38707>>>>>>>              //                                08:garticl_statuse
38707>>>>>>>
38707>>>>>>>              //.01: ®å¨ © £¨¦£¤åª
38707>>>>>>>              If (Gthhmgio.Gthhmgio_Period <> 0);              Begin //£ã ¡¤¦¤ ¡âª §¨å¦¦ 
38709>>>>>>>               If (Gthhmgio.Gthhmgio_Period < 0);                    Move SysCurGL.Year_XrhshFrom to Garticl.Garticl_Hmnia //§¨å¦¦  §¦¨­ãª
38712>>>>>>>               Else Move SysCurGL.Year_XrhshTo   to Garticl.Garticl_Hmnia //§¨å¦¦   ©¦¢¦ ©£¦ç
38714>>>>>>>              End
38714>>>>>>>>
38714>>>>>>>
38714>>>>>>>              //£â©à «à¤ flags 2 3 4 6 8 10 12,  ® ¨ æ£©« « §¨¡á«à
38714>>>>>>>              //calculated §å:
38714>>>>>>>              //.02: ®å¨ © rate0  ¡ 
38714>>>>>>>              //.03: ®å¨ © rate00 ¡ 
38714>>>>>>>              //.04: ®å¨ © rater  ¡ 
38714>>>>>>>              //.05: ®å¨ © c_code_2
38714>>>>>>>              //.06:garticl_MyfNump
38714>>>>>>>              //.07:garticl_MyfNuma
38714>>>>>>>
38714>>>>>>>              //************************************************************************
38714>>>>>>>              //flag 2:¥åª 2 © ¥â¤¦ ¤æ£ ©£                                         *
38714>>>>>>>              //************************************************************************
38714>>>>>>>              //«¦ garticl §¨â§  ¦§à©§ã§¦« ¤ â®  ¤æ£ ©£ ¡  rate0 !
38714>>>>>>>              //á¤  ¡å¤© § «¨â§  ¥åª © ¥â¤¦ ¤æ£ ©£, «æ«:
38714>>>>>>>              //       ) á¤ ¦ user é©  ¡¨­à«æ rate, «æ«  ©®ç  ¬«æ,
38714>>>>>>>              //          ¢¢¦ éª, á¤ ¦ user é©  0 rate, «¦ ¨å©¡¦¬£ (á¤ ¬§á¨® ) §¦ «¦çª § ¤¡ª  ©¦« £ é¤,
38714>>>>>>>              //          ¡  ©«á¨¦¬£ « á¢¢ 2 rates.
38714>>>>>>>              //       ) á¤ ¦ user é©  ¡¨­à«æ ¤æ£ ©£ ¨­ãª, «æ«  ©®ç  ¬«æ,
38714>>>>>>>              //          ¢¢¦ éª ©«á¨¦¬£ by default © year_c_code0, ¡  §¦ §å¤¡ª  ©¦« £ é¤
38714>>>>>>>              //          ©«á¨¦¬£ « á¢¢ 2 rates.
38714>>>>>>>              If (Gtypkin.Gtypkin_Flag02= TRUE );                   Begin //ç¨© rate £««¨¦§ãª ¥åª 2 -> 0
38716>>>>>>>                    If (Garticl.Garticl_C_Code2= "" ) Move Year.Year_C_Code0 to Garticl.Garticl_C_Code2
38719>>>>>>>                    Send private.Find_Rates Garticl.Garticl_C_Code2 Garticl.Garticl_Hmnia
38720>>>>>>>                    If (Garticl.Garticl_Rate0  = 0  ) Get pnA_Garticl_Rate0  to Garticl.Garticl_Rate0
38723>>>>>>>                   End
38723>>>>>>>>
38723>>>>>>>              //á¤  ¡å¤© â¤ § «¨â§  ¥åª © ¥â¤¦ ¤æ£ ©£, «æ«
38723>>>>>>>              //       ©«á¨¦¬£ «¦ rate0 © 1 ¡  «¦ c_code2 © year_c_code0
38723>>>>>>>              Else Begin //¥åª £æ¤¦¤ © ¡ç¨ ¦ ¤æ£ ©£ ®¨ã©ª
38724>>>>>>>                    Move Year.Year_C_Code0 to Garticl.Garticl_C_Code2
38725>>>>>>>                    Move 1                 to Garticl.Garticl_Rate0
38726>>>>>>>                    Send private.Find_Rates Garticl.Garticl_C_Code2 Garticl.Garticl_Hmnia
38727>>>>>>>                   End
38727>>>>>>>>
38727>>>>>>>
38727>>>>>>>              //************************************************************************
38727>>>>>>>              //flag 3:£««¨¦§ã ¥ é¤ © ¬«¨ç¦¤ ¤æ£ ©£ ®¨ã©ª                    *
38727>>>>>>>              //************************************************************************
38727>>>>>>>              //â®  ã «¨â¥   private.Find_Rates, ¡  é §¢éª «© £§á£ « rates,
38727>>>>>>>              //« ¦§¦å « â®¦¬£ ã â«¦ £ !
38727>>>>>>>              If (Gtypkin.Gtypkin_Flag03 = TRUE);                   Begin //¤á¤à© rate £««¨¦§ãª ¥åª 2 -> 00
38729>>>>>>>                    If (Garticl.Garticl_Rate00 = 0  ) Get pnA_Garticl_Rate00 to Garticl.Garticl_Rate00
38732>>>>>>>                   End
38732>>>>>>>>
38732>>>>>>>              Else Begin //¦  ¥åª â¤ £««¨â§¦¤«  © ¬«¨ç¦¤ ¤æ£ ©£ ®¨ã©ª
38733>>>>>>>                    Move 0 to Garticl.Garticl_Rate00
38734>>>>>>>                    Set pnA_Garticl_Rate00 to 0
38735>>>>>>>                   End
38735>>>>>>>>
38735>>>>>>>
38735>>>>>>>              //************************************************************************
38735>>>>>>>              //flag 4:£««¨¦§ã ¥ é¤ © ¤æ£ ©£ reporting                            *
38735>>>>>>>              //************************************************************************
38735>>>>>>>              //â®  ã «¨â¥   private.Find_Rates, ¡  é §¢éª «© £§á£ « rates,
38735>>>>>>>              //« ¦§¦å « â®¦¬£ ã â«¦ £ !
38735>>>>>>>              If (Gtypkin.Gtypkin_Flag04 = TRUE);                   Begin //¤á¤à© rate £««¨¦§ãª ¥åª 2 -> R
38737>>>>>>>                    If (Garticl.Garticl_RateR  = 0  ) Get pnA_Garticl_RateR  to Garticl.Garticl_RateR
38740>>>>>>>                   End
38740>>>>>>>>
38740>>>>>>>              Else Begin //¦  ¥åª â¤ £««¨â§¦¤«  © ¤æ£ ©£ reporting
38741>>>>>>>                    Move 0 to Garticl.Garticl_RateR
38742>>>>>>>                    Set pnA_Garticl_RateR  to 0
38743>>>>>>>                   End
38743>>>>>>>>
38743>>>>>>>
38743>>>>>>>
38743>>>>>>>
38743>>>>>>>              //*********************************************************
38743>>>>>>>              //flag 6:¬¥á¤   §à¢ã©à¤ (+§¢ã¦ª)                   *
38743>>>>>>>              //*********************************************************
38743>>>>>>>              If (Gtypkin.Gtypkin_Flag06 = TRUE);                   Begin
38745>>>>>>>                    Move 1 to Garticl.Garticl_MyfNump //sos æ®    ¦¨à« ¡âª  !
38746>>>>>>>                   End
38746>>>>>>>>
38746>>>>>>>
38746>>>>>>>
38746>>>>>>>
38746>>>>>>>//sososo ¤ ¢å ¦ ¡é ¡ª   «¦ myfnump+a ! ! ! ! ! ! !
38746>>>>>>>              //*********************************************************
38746>>>>>>>              //flag 8:£ é¤   §à¢ã©à¤ (-§¢ã¦ª)                   *
38746>>>>>>>              //*********************************************************
38746>>>>>>>     Else     If (Gtypkin.Gtypkin_Flag08 = TRUE);                   Begin
38749>>>>>>>                    Move (-1) to Garticl.Garticl_MyfNump
38750>>>>>>>                   End
38750>>>>>>>>
38750>>>>>>>     Else           Move 0 to Garticl.Garticl_MyfNump //sos æ®    ¦¨à« ¡âª  !
38752>>>>>>>
38752>>>>>>>
38752>>>>>>>
38752>>>>>>>              //*********************************************************
38752>>>>>>>              //flag 10:¬¥á¤   ¦¨é¤ (+§¢ã¦ª)                    *
38752>>>>>>>              //*********************************************************
38752>>>>>>>              If (Gtypkin.Gtypkin_Flag10 = TRUE);                   Begin
38754>>>>>>>                    Move 1 to Garticl.Garticl_MyfNuma
38755>>>>>>>                   End
38755>>>>>>>>
38755>>>>>>>
38755>>>>>>>              //*********************************************************
38755>>>>>>>              //flag 12:£ é¤   ¦¨é¤ (-§¢ã¦ª)                    *
38755>>>>>>>              //*********************************************************
38755>>>>>>>     Else     If (Gtypkin.Gtypkin_Flag12 = TRUE);                   Begin
38758>>>>>>>                    Move (-1) to Garticl.Garticl_MyfNuma
38759>>>>>>>                   End
38759>>>>>>>>
38759>>>>>>>     Else           Move   0  to Garticl.Garticl_MyfNuma
38761>>>>>>>
38761>>>>>>>
38761>>>>>>>
38761>>>>>>>              //.08: ®å¨ © statuse
38761>>>>>>>              Move (private.fiCurrent_Garticl_Status(Self)) to Garticl.Garticl_Statuse
38762>>>>>>>
38762>>>>>>>
38762>>>>>>>              //) ¤£â¨à© ¨¦ ©«é¤ (adjust_balances)
38762>>>>>>>
38762>>>>>>>              //) ¤£â¨à© properties after (§æ parent buffers!)
38762>>>>>>>              Set psA_Gtypkin_Recr    to Gtypkin.Gtypkin_Recr
38763>>>>>>>              Set pdA_Garticl_Hmnia   to Garticl.Garticl_Hmnia
38764>>>>>>>              Set piA_Garticl_No      to Garticl.Garticl_No
38765>>>>>>>              Set psA_Garticl_C_Code2 to Garticl.Garticl_C_Code2
38766>>>>>>>              Set pnA_Garticl_Rate0   to Garticl.Garticl_Rate0
38767>>>>>>>              Set pnA_Garticl_Rate00  to Garticl.Garticl_Rate00
38768>>>>>>>              Set pnA_Garticl_RateR   to Garticl.Garticl_RateR
38769>>>>>>>              Set piA_Garticl_Aa      to Garticl.Garticl_Aa
38770>>>>>>>
38770>>>>>>>              //properties   «¦¤ â¢®¦ «¦¬ 
38770>>>>>>>              Set pnA_Garticl_SX2     to Garticl.Garticl_SX2
38771>>>>>>>              Set pnA_Garticl_SP2     to Garticl.Garticl_SP2
38772>>>>>>>              Set pnA_Garticl_SX0     to Garticl.Garticl_SX0
38773>>>>>>>              Set pnA_Garticl_SP0     to Garticl.Garticl_SP0
38774>>>>>>>              Set pnA_Garticl_SX00    to Garticl.Garticl_SX00
38775>>>>>>>              Set pnA_Garticl_SP00    to Garticl.Garticl_SP00
38776>>>>>>>              Set pnA_Garticl_SXR     to Garticl.Garticl_SXR
38777>>>>>>>              Set pnA_Garticl_SPR     to Garticl.Garticl_SPR
38778>>>>>>>              Set pnA_Garticl_SX1     to Garticl.Garticl_SX1
38779>>>>>>>              Set pnA_Garticl_SP1     to Garticl.Garticl_SP1
38780>>>>>>>
38780>>>>>>>    End_Procedure   //update
38781>>>>>>>
38781>>>>>>>
38781>>>>>>>    Procedure Backout
38782>>>>>>>              Forward Send Backout
38784>>>>>>>
38784>>>>>>>              //) ¤£â¨à© properties before (§æ current buffer)
38784>>>>>>>              Set psB_Gtypkin_Recr    to Garticl.Gtypkin_Recr
38785>>>>>>>              Set pdB_Garticl_Hmnia   to Garticl.Garticl_Hmnia
38786>>>>>>>              Set piB_Garticl_No      to Garticl.Garticl_No
38787>>>>>>>              Set psB_Garticl_C_Code2 to Garticl.Garticl_C_Code2
38788>>>>>>>              Set pnB_Garticl_Rate0   to Garticl.Garticl_Rate0
38789>>>>>>>              Set pnB_Garticl_Rate00  to Garticl.Garticl_Rate00
38790>>>>>>>              Set pnB_Garticl_RateR   to Garticl.Garticl_RateR
38791>>>>>>>              Set piB_Garticl_Aa      to Garticl.Garticl_Aa
38792>>>>>>>
38792>>>>>>>              //properties   «¦¤ â¢®¦ «¦¬ 
38792>>>>>>>              Set pnB_Garticl_SX2     to Garticl.Garticl_SX2
38793>>>>>>>              Set pnB_Garticl_SP2     to Garticl.Garticl_SP2
38794>>>>>>>              Set pnB_Garticl_SX0     to Garticl.Garticl_SX0
38795>>>>>>>              Set pnB_Garticl_SP0     to Garticl.Garticl_SP0
38796>>>>>>>              Set pnB_Garticl_SX00    to Garticl.Garticl_SX00
38797>>>>>>>              Set pnB_Garticl_SP00    to Garticl.Garticl_SP00
38798>>>>>>>              Set pnB_Garticl_SXR     to Garticl.Garticl_SXR
38799>>>>>>>              Set pnB_Garticl_SPR     to Garticl.Garticl_SPR
38800>>>>>>>              Set pnB_Garticl_SX1     to Garticl.Garticl_SX1
38801>>>>>>>              Set pnB_Garticl_SP1     to Garticl.Garticl_SP1
38802>>>>>>>    End_Procedure   // backout
38803>>>>>>>
38803>>>>>>>
38803>>>>>>>    Procedure Creating
38804>>>>>>>            Forward Send Creating
38806>>>>>>>
38806>>>>>>>            Move (Append('',((Trim(SysCurGL.Branch_Site))+;                             (Trim(String(Garticl.Garticl_Rec0)))))) to Garticl.Garticl_Recr
38807>>>>>>>
38807>>>>>>>              //Add 1 to Year.Year_NumGarticl //¨ £æª á¨¨à¤ «ª ®¨ã©ª
38807>>>>>>>
38807>>>>>>>              Move gs_Module_Code to Garticl.Garticl_M_Code //module ¨­ãª
38808>>>>>>>
38808>>>>>>>              //************************************************************************
38808>>>>>>>              //flag 5:¬«æ£« ¨å£©                                               *
38808>>>>>>>              //************************************************************************
38808>>>>>>>              If (Gtypkin.Gtypkin_Flag05 = TRUE);                   Begin //«¦ á¨¨¦ â®  ¬«æ£« ¨å£©
38810>>>>>>>                    Add 1 to Gtypkin.Gtypkin_L_No
38811>>>>>>>                    Move Gtypkin.Gtypkin_L_No to Garticl.Garticl_No
38812>>>>>>>                   End
38812>>>>>>>>
38812>>>>>>>              Else Begin //«¦ á¨¨¦ â®  ® ¨¦¡å¤« ¨å£©
38813>>>>>>>                   End
38813>>>>>>>>
38813>>>>>>>    End_Procedure //creating
38814>>>>>>>
38814>>>>>>>
38814>>>>>>>    Procedure Deleting
38815>>>>>>>              Forward Send Deleting
38817>>>>>>>              //Sub 1 from Year.Year_NumGarticl //¨ £æª á¨¨à¤ «ª ®¨ã©ª
38817>>>>>>>    End_Procedure //deleting
38818>>>>>>>
38818>>>>>>>
38818>>>>>>>    Procedure Save_Main_File
38819>>>>>>>              Forward Send Save_Main_File
38821>>>>>>>
38821>>>>>>>              //¤£â¨à© gthaa, á¤ «¦ garticl å¤  ¦¨ ©« ¡¦§¦ £â¤¦
38821>>>>>>>              If (Garticl.Garticl_Aa > 0);              Begin
38823>>>>>>>                  Clear GthAA
38824>>>>>>>                  Move SysCurGL.Company_Code    to Gthaa.Company_Code
38825>>>>>>>                  Move SysCurGL.Branch_Code     to Gthaa.Branch_Code
38826>>>>>>>                  Move SysCurGL.Year_Year       to Gthaa.Year_Year
38827>>>>>>>                  Move Gthhmgio.GthHmgio_Code   to Gthaa.GthHmgio_Code
38828>>>>>>>                  Find Eq Gthaa By Index.1 //company_code+branch_code+year_year+gthhmgio_code
38829>>>>>>>>
38829>>>>>>>                  If (Found=0);                  Begin //£ ¦¬¨å ¤â¦¬ record ghthaa
38831>>>>>>>                       Add 1 to SysrecG.Gthaa_Rec0
38832>>>>>>>                       Saverecord SysrecG
38833>>>>>>>                       Move SysrecG.Gthaa_Rec0      to Gthaa.Gthaa_Rec0
38834>>>>>>>                       Move (Append('',((Trim(SysCurGL.Branch_Site))+;                                        (Trim(String(Gthaa.Gthaa_Rec0)))))) to Gthaa.Gthaa_Recr
38835>>>>>>>
38835>>>>>>>                       //¤£â¨à© related §å¦¬
38835>>>>>>>                       Move Gthhmgio.Gthhmgio_Recr to Gthaa.Gthhmgio_Recr
38836>>>>>>>                       Move SysCurGL.Year_Recr     to Gthaa.Year_Recr
38837>>>>>>>                  End //«â¢¦ª £ ¦¬¨ås ¤â¦¬ record gthaa
38837>>>>>>>>
38837>>>>>>>
38837>>>>>>>                  Move (Garticl.Garticl_Hmnia Max Gthaa.Gthaa_Lhmnia) to Gthaa.Gthaa_Lhmnia
38838>>>>>>>                  Move (Garticl.Garticl_Aa    Max Gthaa.Gthaa_Laa   ) to Gthaa.Gthaa_Laa
38839>>>>>>>                  Saverecord Gthaa
38840>>>>>>>              End
38840>>>>>>>>
38840>>>>>>>    End_Procedure//save_main_file
38841>>>>>>>
38841>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
38842>>>>>>>              String lsError_Message
38843>>>>>>>              Date   ldGthaa_Hmnia
38843>>>>>>>              Case Begin
38843>>>>>>>                   //§æ validate save
38843>>>>>>>                   Case (iError_Num = 1001)
38845>>>>>>>                        Move ("DDC 156:¡«á¢¢¢ £¨¦£¤å !\n\n ¡¨æ«¨ «ª ¤á¨¥àª ®¨ã©àª ("+;                        (String(Year.Year_XrhshFrom))+")") to lsError_Message
38846>>>>>>>                        Case Break
38847>>>>>>>                   Case (iError_Num = 1002)
38850>>>>>>>                        Move ("DDC 156:¡«á¢¢¢ £¨¦£¤å !\n\n¢ç«¨ «ª ¢ã¥àª ®¨ã©àª ("+;                        (String(Year.Year_XrhshTo))+")") to lsError_Message
38851>>>>>>>                        Case Break
38852>>>>>>>                   Case (iError_Num = 1003)
38855>>>>>>>                        Move (private.fdGthaa_Last_Hmnia(Self,GthHmgio.GthHmgio_Code)) to ldGthaa_Hmnia
38856>>>>>>>                        Move ("DDC 156:¡«á¢¢¢ £¨¦£¤å !\n\n ¡¨æ«¨/å© «ª «¢¬«åª £¨¦£¤åª ®¦¨ã©ª\n\n/ ©«¦ à¨£â¤¦ £¨¦¢æ ¦ ("+;                        (String(ldGthaa_Hmnia))+")") to lsError_Message
38857>>>>>>>                        Case Break
38858>>>>>>>                   Case (iError_Num = 1004)
38861>>>>>>>                        Move ("DDC 156:¡«á¢¢¢ ¨­ã (rate1) !\n\nâ¤ â®  ¦¨ ©å  ©¦« £å £««¨¦§ãª © ¡ç¨ ¦ ¤æ£ ©£ ®¨ã©àª !");                        to lsError_Message
38862>>>>>>>                        Case Break
38863>>>>>>>                   Case (iError_Num = 1005)
38866>>>>>>>                        Move ("DDC 156:¡«á¢¢¢ ¨­ã (rate2) !\n\nâ¤ â®  ¦¨ ©å  ©¦« £å £««¨¦§ãª © ¬«¨â¬¦¤ ¤æ£ ©£ ®¨ã©àª !");                        to lsError_Message
38867>>>>>>>                        Case Break
38868>>>>>>>                   Case (iError_Num = 1006)
38871>>>>>>>                        Move ("DDC 156:¡«á¢¢¢ ¨­ã (rate3) !\n\nâ¤ â®  ¦¨ ©å  ©¦« £å £««¨¦§ãª © ¤æ£ ©£ reporting !");                        to lsError_Message
38872>>>>>>>                        Case Break
38873>>>>>>>                   Case (iError_Num = 1007)
38876>>>>>>>                        Move ("DDC 156:¡«á¢¢¢ ¨­ã !\n\n¤ ¡æª ¨ £æª §¨©«« ¡¦ç !");                        to lsError_Message
38877>>>>>>>                        Case Break
38878>>>>>>>                   Case (iError_Num = 1008)
38881>>>>>>>                        Move ("DDC 156:ç¤«  «¨¦§¦§¦å© !\n\nì ¨­ã å¤  ¦¨ ©« ¡ã !");                        to lsError_Message
38882>>>>>>>                        Case Break
38883>>>>>>>                   Case (iError_Num = 1009)
38886>>>>>>>                        Clear Codemast
38887>>>>>>>                        Move "MODULE" to Codemast.Type
38888>>>>>>>                        Move Garticl.Garticl_M_Code to Codemast.Code
38889>>>>>>>                        Find Eq Codemast by Index.1 //type+code
38890>>>>>>>>
38890>>>>>>>                        Move ("DDC 156:ç¤«  ¨­ã\n\n(¦ á¨¨¦ «¨¦§¦§¦ å«  £æ¤¦¤ §æ "+;                        (Trim(Codemast.Description))+" )") to lsError_Message
38891>>>>>>>                        Case Break
38892>>>>>>>                   Case (iError_Num = 1010)
38895>>>>>>>                        Move ("DDC 156:ç¤«  ¨­ã\n\n(â¤ â®  ¦¨ ©å ¤æ£ ©£ !)");                        to lsError_Message
38896>>>>>>>                        Case Break
38897>>>>>>>                   Case (iError_Num = 1011)
38900>>>>>>>                        Move ("DDC 156:ç¤«  ¨­ã\n\n(â¤ â®  ¦¨ ©å module !)");                        to lsError_Message
38901>>>>>>>                        Case Break
38902>>>>>>>                   Case (iError_Num = 1012)
38905>>>>>>>                        Move ("DDC 156:ç¤«  ¨­ã\n\n(â¤ â®  ¦¨ ©å delimiter   «¤ «¨â®¦¬© ®¨ã© !)");                        to lsError_Message
38906>>>>>>>                        Case Break
38907>>>>>>>                   Case (iError_Num = 1100)
38910>>>>>>>                        Move "DDC 156: §¦¡«ã « ¨å-¨ã©" to lsError_Message
38911>>>>>>>                        Case Break
38912>>>>>>>
38912>>>>>>>                   //§æ validate delete
38912>>>>>>>                   Case (iError_Num = 2001)
38915>>>>>>>                        Move ("DDC 156:ç¤«   ¨­ã!\n\n¦ á¨¨¦ â®  ¦¨ ©« ¡¦§¦ å (/= "+;                        (String(Garticl.Garticl_AA))+" )") to lsError_Message
38916>>>>>>>                        Case Break
38917>>>>>>>                   Case (iError_Num = 2002)
38920>>>>>>>                        Clear Codemast
38921>>>>>>>                        Move "MODULE" to Codemast.Type
38922>>>>>>>                        Move Garticl.Garticl_M_Code to Codemast.Code
38923>>>>>>>                        Find Eq Codemast by Index.1 //type+code
38924>>>>>>>>
38924>>>>>>>                        Move ("DDC 156:ç¤«   ¨­ã!\n\n(¦ á¨¨¦  ¨á­«  £æ¤¦¤ §æ "+;                        (Trim(Codemast.Description))+" )") to lsError_Message
38925>>>>>>>                        Case Break
38926>>>>>>>                   Case (iError_Num = 2100)
38929>>>>>>>                        Move "DDC 059: §¦¡«ã « ¨å-¨ã©"  to lsError_Message
38930>>>>>>>                        Case Break
38931>>>>>>>
38931>>>>>>>                   Case Else
38931>>>>>>>                        Forward Send Operation_Not_Allowed iError_Num
38933>>>>>>>              Case End
38933>>>>>>>
38933>>>>>>>              Error iError_Num lsError_Message
38934>>>>>>>>
38934>>>>>>>    End_Procedure // operation_not_allowed
38935>>>>>>>
38935>>>>>>>
38935>>>>>>>    //1001:gartcl_hmnia >= year_xrhsh From
38935>>>>>>>    //1002:gartcl_hmnia <= year_xrhsh To
38935>>>>>>>    //1003:gartcl_hmnia >  gthaa_lhmnia
38935>>>>>>>
38935>>>>>>>    //????:gartcl_aa    >= gthaa_laa
38935>>>>>>>
38935>>>>>>>
38935>>>>>>>    //1004:gartcl_rate0 > 0
38935>>>>>>>    //1005:If flag03 then garticl_rate0 > 0
38935>>>>>>>    //1006:If flag04 then garticl_rateR > 0
38935>>>>>>>    //1007:garticl_no > 0
38935>>>>>>>
38935>>>>>>>    //1008:garticl_aa = 0:§ «¨â§«  save £æ¤¦¤ © §¨¦©à¨ ¤âª ¡ ¤ã© ª-« ¦¨ ©« ¡á á¨¨ â¤ ¢¦ é¤¦¤« 
38935>>>>>>>    //                   (§¨¦©¦®ã ©«¤ ®¦¨ã©©  : §¨é« ©éà Gmove ¡  £«á garticl!)
38935>>>>>>>    //                   § ¤æ¤ ¦ â¢®¦ª ¬«æª ¤ å¤  £ «¦ statuse
38935>>>>>>>    //                   «¢ ¡á, ¦ â¢®¦ª ¬«æª å¤«  £ «¤ pibgarticl_aa
38935>>>>>>>
38935>>>>>>>    //1009:m_code: ¨­ã § «¨â§«  £æ¤¦¤ §¦ ¦ module §¦¬ «¤ £ ¦ç¨©
38935>>>>>>>    //1010:«¦ c_code2 § á¤«  §¦ «¦ validation table (no blanks allowed!)
38935>>>>>>>    //     ¬©«¬®éª, ¢æà «¦¬ ¦¤æ«¦ª æ«  §¨é« «¨â®  «¦ validation «¦¬ deo,
38935>>>>>>>    //     ¬§¦®¨æ¤¦£  ¤ áà blaks allowed, ¡  ¤ validaro é,
38935>>>>>>>    //      æ«  «¨â®¦¬¤ ¡  bp's ®à¨åª deo's.
38935>>>>>>>    //1011:m_code (  «¦¬ª å ¦¬ª ¢æ¦¬ª «¦¬ c_code_2
38935>>>>>>>    //1012:year_delimiter <> ""
38935>>>>>>>    //1013:aa >= gthaa if aa>0  !!!!!!!
38935>>>>>>>    //1100:cby = globals
38935>>>>>>>
38935>>>>>>>    //period (fixed date)????
38935>>>>>>>    //????:garticl_hmnia <= year_entry_date
38935>>>>>>>    //     :flag
38935>>>>>>>
38935>>>>>>>
38935>>>>>>>    Function Validate_Save Returns Integer
38936>>>>>>>             Integer iReturnVal liGthaa_Last_Aa
38937>>>>>>>             Date    ldGthaa_Last_Hmnia
38937>>>>>>>
38937>>>>>>>             Forward Get Validate_Save to iReturnVal
38939>>>>>>>
38939>>>>>>>             If (Not(iReturnVal));             Begin
38941>>>>>>>              //ç¨© «¢¬«åª £¨¦£¤åª ®¦¨ã©ª / ©«¦ à¨£â¤¦ £¨¦¢æ ¦
38941>>>>>>>              Move (private.fdGthaa_Last_Hmnia(Self,GthHmgio.GthHmgio_Code)) to ldGthaa_Last_Hmnia
38942>>>>>>>              // ! ¬«æ â¤ ¢â®«  !
38942>>>>>>>              //ç¨© «¢¬«å¦¬ ¨ £¦ç / ©«¦ à¨£â¤¦ £¨¦¢æ ¦
38942>>>>>>>              Move (private.fiGthaa_Last_Aa   (Self,GthHmgio.GthHmgio_Code)) to liGthaa_Last_Aa
38943>>>>>>>
38943>>>>>>>              // 10/05/2002
38943>>>>>>>              // Gia na mhn xtypaei h BP doEnhmGL sthn request_save
38943>>>>>>>              // dioti gia kapoio logo pou den exoume akoma brei
38943>>>>>>>              // erxetai edo me thn hmeromhnia kenh
38943>>>>>>>              
38943>>>>>>>              If (piDoNotValidateMe(Self)=0) Begin
38945>>>>>>>                  //1001+1002+1003:â¢®¦  £¨¦£¤åª
38945>>>>>>>                  If (Not(Garticl.Garticl_Hmnia >= SysCurGL.Year_XrhshFrom )) Send Operation_Not_Allowed 1001
38948>>>>>>>                  If (Not(Garticl.Garticl_Hmnia <= SysCurGL.Year_XrhshTo   )) Send Operation_Not_Allowed 1002
38951>>>>>>>
38951>>>>>>>                //sosososososo!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
38951>>>>>>>                //§¨â§  ¤ £§å > ¡  æ®  >=,  æ«  â®  §¨æ¢£  ¨¦¬«å¤ 
38951>>>>>>>                //pimode=1   «¤ ®¦¨ã© 
38951>>>>>>>                //pimode=2   «¦¤ £¤ ©£æ 
38951>>>>>>>                //«¦ pimode â®  « ª ¥ãª « £âª : 0 : regular data entry operation
38951>>>>>>>                //                                1 : ®¦¨ã© /
38951>>>>>>>                //                                2 : £¤ ©£æª /
38951>>>>>>>
38951>>>>>>>                  If (((piMode(Self)) = 0) and (liGthaa_Last_Aa<>0));                  Begin //regular data entry, â¢®¦ª £/¤åª ¢¦ ©« ¡¦§¦å©ª
38953>>>>>>>                       If (Not(Garticl.Garticl_Hmnia >   ldGthaa_Last_Hmnia  )) Send Operation_Not_Allowed 1003
38956>>>>>>>                  End
38956>>>>>>>>
38956>>>>>>>
38956>>>>>>>                  Else;                  If ((piMode(Self)) = 1);                  Begin //®¦¨ã© /
38959>>>>>>>                       If (Not(Garticl.Garticl_Hmnia >=  ldGthaa_Last_Hmnia  )) Send Operation_Not_Allowed 1003
38962>>>>>>>                  End
38962>>>>>>>>
38962>>>>>>>    
38962>>>>>>>                  Else;                  If ((piMode(Self)) = 2);                  Begin //£¤ ©£æª /
38965>>>>>>>                       If (Not(Garticl.Garticl_Hmnia <=  ldGthaa_Last_Hmnia  )) Send Operation_Not_Allowed 1003
38968>>>>>>>                  End
38968>>>>>>>>
38968>>>>>>>    
38968>>>>>>>    //              Else;
38968>>>>>>>    //              If ((piMode(Self)) = 0);
38968>>>>>>>    //              Begin //regular data entry
38968>>>>>>>    //                   //1009:â¢®¦ª module ¨­ãª
38968>>>>>>>    //                   If (Not(Garticl.Garticl_M_Code = gs_Module_Code))       Send Operation_Not_Allowed 1009
38968>>>>>>>    //              End
38968>>>>>>>    ////sosososososo!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
38968>>>>>>>
38968>>>>>>>              End
38968>>>>>>>>
38968>>>>>>>
38968>>>>>>>
38968>>>>>>>              //1004:â¢®¦ª  ©¦« £åª 0 //sosososo ¤ ¢å  ¢¦ ¡ã
38968>>>>>>>              If (Not(Garticl.Garticl_Rate0  >  0                  )) Send Operation_Not_Allowed 1004
38971>>>>>>>              //1004:â¢®¦ª  ©¦« £åª 00
38971>>>>>>>              If ((Gtypkin.Gtypkin_Flag03 = TRUE) and;              (Not(Garticl.Garticl_Rate00 > 0));                 )                                                    Send Operation_Not_Allowed 1005
38974>>>>>>>              //1005:â¢®¦ª  ©¦« £åª r
38974>>>>>>>              If ((Gtypkin.Gtypkin_Flag04 = TRUE) and;              (Not(Garticl.Garticl_RateR  > 0));                 )                                                    Send Operation_Not_Allowed 1006
38977>>>>>>>
38977>>>>>>>              //1007:â¢®¦ª ¨ £¦ç §¨©«« ¡¦ç
38977>>>>>>>              If (Not(Garticl.Garticl_No     >  0                  )) Send Operation_Not_Allowed 1007
38980>>>>>>>
38980>>>>>>>              //1008:â¢®¦ª / (¢¦ ©« ¡¦§¦å©ª)
38980>>>>>>>              If (Not((private.fiCheck_Garticl_Aa(Self)) = 0))        Send Operation_Not_Allowed 1008
38983>>>>>>>
38983>>>>>>>//â­¬ §æ é,  æ«  å® §¨æ¢£  ¨¦¬«å¤ ®¦¨ã©ª-£¤ ©£¦ç /
38983>>>>>>>//----------> //1009:â¢®¦ª module ¨­ãª
38983>>>>>>>//----------> If (Not(Garticl.Garticl_M_Code = gs_Module_Code))       Send Operation_Not_Allowed 1009
38983>>>>>>>
38983>>>>>>>              //1010:â¢®¦ª £ã ¡¤¦ç ¤¦£å©£«¦ª
38983>>>>>>>              If (Not(Garticl.Garticl_C_Code2 <> ""          ))       Send Operation_Not_Allowed 1010
38986>>>>>>>
38986>>>>>>>              //1011:â¢®¦ª £ã ¡¤¦ç module ¨­ãª
38986>>>>>>>              If (Not(Garticl.Garticl_M_Code <> ""           ))       Send Operation_Not_Allowed 1011
38989>>>>>>>
38989>>>>>>>              //1012:â¢®¦ª £ã ¡¤¦ç year_delimiter
38989>>>>>>>              If (Not(Year.Year_Delimiter <> ""              ))       Send Operation_Not_Allowed 1012
38992>>>>>>>
38992>>>>>>>              //1100:cby = globals
38992>>>>>>>              If ( ;                  (Not(Garticl.Company_Code = gs_Selected_Company_Code)) or;                  (Not(Garticl.Branch_Code  = gs_Selected_Branch_Code )) or;                  (Not(Garticl.Year_Year    = gi_Selected_Year        ));                  )                                                   Send Operation_Not_Allowed 1100
38995>>>>>>>
38995>>>>>>>              //â¢®¦ª £¨¦£¤åª ¨©åª
38995>>>>>>>              //If (Not(Garticl.Garticl_Hmnia <= Year.Year_Entry_Date)) Send Operation_Not_Allowed 999
38995>>>>>>>
38995>>>>>>>             End //«â¢¦ª ¡é ¡ validation
38995>>>>>>>>
38995>>>>>>>             Function_Return iReturnVal
38996>>>>>>>    End_Function   // validate_save
38997>>>>>>>
38997>>>>>>>
38997>>>>>>>    //2001:« ¦¨ ©« ¡¦§¦ £â¤ á¨¨ â¤  ¨á­¦¤« 
38997>>>>>>>    //2002:«¦ á¨¨¦  ¨á­«  £æ¤¦¤ §¦ «¦ module §¦¬ «¦ £ ¦ç¨©
38997>>>>>>>    //2100:cby = globals
38997>>>>>>>    Function Validate_Delete  Returns Integer
38998>>>>>>>             Integer iReturnVal
38999>>>>>>>             Forward Get Validate_Delete  To iReturnVal
39001>>>>>>>             If (Not(iReturnVal));             Begin
39003>>>>>>>             //2001:â¢®¦ª / (¢¦ ©« ¡¦§¦å©ª)
39003>>>>>>>              If (Garticl.Garticl_AA > 0                      )       Send Operation_Not_Allowed 2001
39006>>>>>>>
39006>>>>>>>              //2002:â¢®¦ª module ¨­ãª 13/05/02 removed from georg
39006>>>>>>>              //If (Not(Garticl.Garticl_M_Code = gs_Module_Code))       Send Operation_Not_Allowed 2002
39006>>>>>>>
39006>>>>>>>              //2100:cby = globals
39006>>>>>>>              If ( ;                   (Not(Garticl.Company_Code = SysCurGL.Company_Code)) or;                   (Not(Garticl.Branch_Code  = SysCurGL.Branch_Code )) or;                   (Not(Garticl.Year_Year    = SysCurGL.Year_Year   ));                  )                                                   Send Operation_Not_Allowed 2100
39009>>>>>>>             End //«â¢¦ª ¡é ¡ validation
39009>>>>>>>>
39009>>>>>>>             Function_Return iReturnVal
39010>>>>>>>    End_Function   // Validate_Delete
39011>>>>>>>
39011>>>>>>>
39011>>>>>>>
39011>>>>>>>     Procedure Request_Save
39012>>>>>>>               Integer liDo_Change_Garticl liTrexe_Result
39013>>>>>>>
39013>>>>>>>               //***************
39013>>>>>>>               BEGIN_TRANSACTION
39014>>>>>>>               //***************
39014>>>>>>>               Set Smart_Filemode_State to False
39015>>>>>>>               Forward Send Request_Save
39017>>>>>>>               Set Smart_Filemode_State to True
39018>>>>>>>
39018>>>>>>>               If (Not(Err));                    Begin //­'æ©¦¤ «¦ garticl record ©é¡ ¡¤¦¤ ¡á, §¨¦®à¨áà ©«¤ bpo
39020>>>>>>>                     Get piDo_Change_Garticl to liDo_Change_Garticl
39021>>>>>>>                     Get Trexe of liDo_Change_Garticl (Self) to liTrexe_Result
39022>>>>>>>
39022>>>>>>>                     If (liTrexe_Result <> 0);                        Begin //­'æ©¦¤  bpo â¤ â«¨¥ ©à©«á, ¡¬¨é¤à «¦ transaction
39024>>>>>>>                         //***************
39024>>>>>>>                         ABORT_TRANSACTION
39025>>>>>>>                         //***************
39025>>>>>>>                         //£¤ ©£æª properties   §æ£¤ ¡å¤©
39025>>>>>>>                         Send private.Initialize_Properties
39026>>>>>>>                         Indicate Err False
39027>>>>>>>                         Procedure_Return
39028>>>>>>>                        End
39028>>>>>>>>
39028>>>>>>>                     //§¤­¦¨á «¦¬ system indicator err
39028>>>>>>>                     Indicate Err False
39029>>>>>>>                    End
39029>>>>>>>>
39029>>>>>>>
39029>>>>>>>               Else Begin //­'æ©¦¤ «¦ Gmove record â¤ ©é¡, ¡¬¨é¤à «¦ transaction
39030>>>>>>>                     //***************
39030>>>>>>>                     ABORT_TRANSACTION
39031>>>>>>>                     //***************
39031>>>>>>>                     Send private.Initialize_Properties
39032>>>>>>>                     Indicate Err False
39033>>>>>>>                     Procedure_Return
39034>>>>>>>                    End
39034>>>>>>>>
39034>>>>>>>
39034>>>>>>>             //­'æ©¦¤ ¡  «¦ garticl record ©é¡ ¡¤¦¤ ¡á,
39034>>>>>>>             //¡   bpo â«¨¥ ®à¨åª error,  ¡«®à¨é «¦ transaction
39034>>>>>>>             //***************
39034>>>>>>>             END_TRANSACTION
39035>>>>>>>             //***************
39035>>>>>>>             //£¤ ©£æª properties   §æ£¤ ¡å¤©
39035>>>>>>>             Send private.Initialize_Properties
39036>>>>>>>             //§¤­¦¨á «¦¬ system indicator err
39036>>>>>>>             //?????Indicate Err False
39036>>>>>>>    End_Procedure   // Request_Save
39037>>>>>>>
39037>>>>>>>
39037>>>>>>>     //¡¢å«  §¦ á¢¢ modules £© §¦ transaction,
39037>>>>>>>     //á¨ å¤  å  £ «¤ original request_save, £æ¤¦¤ §¦¬
39037>>>>>>>     //â¤ ¡á¤  begin-abort-end transaction
39037>>>>>>>     //sososo please check logic with err indicator !
39037>>>>>>>     //¡¢å«  §æ:1.private.Transaction_Bmove_Update_Gmove «ª oDo_GL_Maintainance
39037>>>>>>>     //                ¦§¦å £ «¤ © ¨á «ª ¡¢å«  §¦ «¤ request_save «¦¬ bmove.dd
39037>>>>>>>     Procedure Request_Save_No_Transaction
39038>>>>>>>               Integer liDo_Change_Garticl liTrexe_Result
39039>>>>>>>
39039>>>>>>>               Forward Send Request_Save
39041>>>>>>>
39041>>>>>>>               If (Not(Err));                    Begin //­'æ©¦¤ «¦ garticl record ©é¡ ¡¤¦¤ ¡á, §¨¦®à¨áà ©«¤ bpo
39043>>>>>>>                     Get piDo_Change_Garticl to liDo_Change_Garticl
39044>>>>>>>                     Get Trexe of liDo_Change_Garticl (Self) to liTrexe_Result
39045>>>>>>>
39045>>>>>>>                     If (liTrexe_Result <> 0);                        Begin //­'æ©¦¤  bpo â¤ â«¨¥ ©à©«á, ¡¬¨é¤à «¦ transaction
39047>>>>>>>                         //£¤ ©£æª properties   §æ£¤ ¡å¤©
39047>>>>>>>                         Send private.Initialize_Properties
39048>>>>>>>                         Indicate Err False
39049>>>>>>>                         Procedure_Return
39050>>>>>>>                        End
39050>>>>>>>>
39050>>>>>>>                     //§¤­¦¨á «¦¬ system indicator err
39050>>>>>>>                     Indicate Err False
39051>>>>>>>                    End
39051>>>>>>>>
39051>>>>>>>
39051>>>>>>>               Else Begin //­'æ©¦¤ «¦ Gmove record â¤ ©é¡, ¡¬¨é¤à «¦ transaction
39052>>>>>>>                     Send private.Initialize_Properties
39053>>>>>>>                     Procedure_Return
39054>>>>>>>                    End
39054>>>>>>>>
39054>>>>>>>
39054>>>>>>>             //­'æ©¦¤ ¡  «¦ garticl record ©é¡ ¡¤¦¤ ¡á,
39054>>>>>>>             //¡   bpo â«¨¥ ®à¨åª error,  ¡«®à¨é «¦ transaction
39054>>>>>>>             //£¤ ©£æª properties   §æ£¤ ¡å¤©
39054>>>>>>>             Send private.Initialize_Properties
39055>>>>>>>             //§¤­¦¨á «¦¬ system indicator err
39055>>>>>>>             //?????Indicate Err False
39055>>>>>>>    End_Procedure   // request_save_no_transaction
39056>>>>>>>
39056>>>>>>>
39056>>>>>>>
39056>>>>>>>//------------------------------------------------------START OF DEO REQUIRED FUNCTIONS
39056>>>>>>>
39056>>>>>>>    Procedure pFindIsotimia String  Curr_Code##;                            Date    ldArticle_Date##
39057>>>>>>>                            Integer liModeF57##
39058>>>>>>>
39058>>>>>>>              Clear Rates
39059>>>>>>>              Move Curr_Code##      to Rates.Currency_C_code
39060>>>>>>>              Move ldArticle_Date## to Rates.Rates_Hmnia
39061>>>>>>>
39061>>>>>>>              Find Eq Rates By Index.1 //currency_c_code+rates_hmnia
39062>>>>>>>>
39062>>>>>>>
39062>>>>>>>              If (Found = 0);                   Begin //á¤ â¤ ¨é  ©¦« £å
39064>>>>>>>                    //If (gsC_Code0 = Curr_Code##);
39064>>>>>>>                    //     Begin //á¤ «¦ ¤æ£ ©£ ¨­ãª å¤  «¦ å ¦ £ «¦ ¡ç¨ ¦ ¤æ£ ©£ ®¨ã©àª
39064>>>>>>>                    //      Set Field_Changed_Value Field Garticl.Garticl_Rate0 to 1
39064>>>>>>>                    //      //Set pnRateFind to 1
39064>>>>>>>                    //     End
39064>>>>>>>                   End
39064>>>>>>>>
39064>>>>>>>              Else Begin //á¤ ¨é  ©¦« £å
39065>>>>>>>                    //If (gsC_Code0 = Curr_Code##);
39065>>>>>>>                    //     Begin //á¤ «¦ ¤æ£ ©£ ¨­ãª å¤  «¦ å ¦ £ «¦ ¡ç¨ ¦ ¤æ£ ©£ ®¨ã©àª
39065>>>>>>>                    //      Set Field_Changed_Value Field Garticl.Garticl_Rate0 to 1
39065>>>>>>>                    //      //Set pnRateFind to 1
39065>>>>>>>                    //     End
39065>>>>>>>                    //Else Begin //á¤ «¦ ¤æ£ ©£ ¨­ãª  å¤  «¦ å ¦ £ «¦ ¡ç¨ ¦ ¤æ£ ©£ ®¨ã©àª
39065>>>>>>>                    //      Set Field_Changed_Value Field Garticl.Garticl_Rate0 to Rates.Rates_Rate0
39065>>>>>>>                    //      //Set pnRateFind to Rates.Rates_Rate0
39065>>>>>>>                    //     End
39065>>>>>>>                    End
39065>>>>>>>>
39065>>>>>>>
39065>>>>>>>              //if (liModeF57## eq 0 ) set Field_Changed_Value Field Garticl.Garticl_Rate0 to Rates.Rates_Rate0
39065>>>>>>>    End_Procedure //pfindisotimia
39066>>>>>>>
39066>>>>>>>
39066>>>>>>>
39066>>>>>>>
39066>>>>>>>    // fiValidateGarticlFields_iexit:
39066>>>>>>>
39066>>>>>>>    Function fiCheckDate Integer liField ;                         Date    ldArticle_Date;                         Date    ldAllowedDateFrom ;                         Date    ldAllowedDateTo ;                         Integer liMode;                         Integer liHmgio_X##;                         Returns Integer
39067>>>>>>>
39067>>>>>>>        Integer liReturnVal##
39068>>>>>>>
39068>>>>>>>        Move 0 to liReturnVal##
39069>>>>>>>        If (liMode = 1);             Begin //mode 1 =?
39071>>>>>>>              If (ldArticle_Date < ldAllowedDateFrom) Function_Return 127
39074>>>>>>>              If (ldArticle_Date > ldAllowedDateTo  ) Function_Return 127
39077>>>>>>>             End
39077>>>>>>>>
39077>>>>>>>        If (liMode = 2);             Begin //mode 2 = ?
39079>>>>>>>              If (ldArticle_Date < ldAllowedDateFrom) Move 127 to liReturnVal##
39082>>>>>>>              If (ldArticle_Date > ldAllowedDateTo  ) Move 127 to liReturnVal##
39085>>>>>>>             End
39085>>>>>>>>
39085>>>>>>>//telika pia i diafora mode 1 kai 2 ?
39085>>>>>>>        Function_Return liReturnVal##
39086>>>>>>>    End_Function //fiCheckDate
39087>>>>>>>
39087>>>>>>>
39087>>>>>>>    Function fiValidateGarticlFields_iExit Integer liField##;                                           String lsFieldvalue##;                                           Returns Integer
39088>>>>>>>        Integer iReturnVal
39089>>>>>>>function_return 0 //sososososo
39090>>>>>>>        Date    ldAllowedDateFrom## //=Year_OpenFrom+Year.Year_DateAA
39090>>>>>>>        Date    ldAllowedDateTo##   //=Year_OpenTo
39090>>>>>>>        Date    ldArticl_Hmnia##
39090>>>>>>>        Date    ldDateAA##
39090>>>>>>>        String  sName##
39090>>>>>>>        Integer iMainFile## liReturnVal## liReturnValb## liHmgioCode_X##
39090>>>>>>>        Number  lnGtypkin_Code## lnIsot##
39090>>>>>>>
39090>>>>>>>        Get Main_File to iMainFile##
39091>>>>>>>        Get_Attribute DF_FIELD_NAME of iMainFile## liField## to sName##
39094>>>>>>>
39094>>>>>>>        //â¢®¦ª £¨¦£¤åª á¨¨¦¬
39094>>>>>>>        If (sName## = 'GARTICL_HMNIA');             Begin
39096>>>>>>>              Move (Trim(lsFieldvalue##)) to lsFieldvalue##
39097>>>>>>>              Get Field_Current_Value of (Year_DD    (Self)) Field SysCurGL.Year_OpenFrom     to ldAllowedDateFrom##
39098>>>>>>>              Get Field_Current_Value of (Year_DD    (Self)) Field SysCurGL.Year_OpenTo       to ldAllowedDateTo##
39099>>>>>>>              Get Field_Current_Value of (GThHmgio_DD(Self)) Field GThHmgio.GthHmgio_Code to liHmgioCode_X##
39100>>>>>>>
39100>>>>>>>              Move (fiCheckDate(self,liField##,;                                     lsFieldvalue##,;                                     ldAllowedDateFrom##,;                                     ldAllowedDateTo##,;                                     1,;                                     liHmgioCode_X##);                               ) to liReturnVal##
39101>>>>>>>              If (liReturnval## <> 0);                   Begin
39103>>>>>>>                    Error 127 " Invalid Date !!!!!"
39104>>>>>>>>
39104>>>>>>>                    Function_return 127
39105>>>>>>>                   End
39105>>>>>>>>
39105>>>>>>>
39105>>>>>>>              Get Field_Current_Value of (Year_DD(Self)) Field Year.Year_DateAA to ldAllowedDateFrom##
39106>>>>>>>              Move (fiCheckDate(Self,liField##,;                                     lsFieldvalue##,;                                     ldAllowedDateFrom##,;                                     ldAllowedDateTo##,;                                     2,;                                     liHmgioCode_X##);                               ) to liReturnVal##
39107>>>>>>>              If (liReturnval## <> 0);                   Begin
39109>>>>>>>                     Error 127 " Invalid Date !!!!!"
39110>>>>>>>>
39110>>>>>>>                     Function_return 127
39111>>>>>>>                   End
39111>>>>>>>>
39111>>>>>>>
39111>>>>>>>             End
39111>>>>>>>>
39111>>>>>>>
39111>>>>>>>             //â¢®¦ª ¤¦£å©£«¦ª ¨­ãª
39111>>>>>>>             If (sName## = 'GARTICL_C_CODE2');                  Begin
39113>>>>>>>                   Move (trim(lsFieldvalue##)) to lsFieldvalue##
39114>>>>>>>                   Get Field_Current_Value Field Garticl.Garticl_Hmnia  to ldArticl_Hmnia##
39115>>>>>>>                   Get Field_Current_Value Field Garticl.Garticl_Rate0  to lnIsot##
39116>>>>>>>                   If (lnIsot## = 0 ) Send pFindIsotimia lsFieldValue## ldArticl_Hmnia## 0
39119>>>>>>>                  End
39119>>>>>>>>
39119>>>>>>>
39119>>>>>>>             Move 0 to iReturnVal
39120>>>>>>>
39120>>>>>>>             Function_Return iReturnVal
39121>>>>>>>    End_Function // fiValidateGarticlFields_iexit
39122>>>>>>>//------------------------------------------------------END OF DEO REQUIRED FUNCTIONS
39122>>>>>>>
39122>>>>>>>
39122>>>>>>>
39122>>>>>>>
39122>>>>>>>
39122>>>>>>>
39122>>>>>>>    // Define_Fields:
39122>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39122>>>>>>>
39122>>>>>>>    Procedure Define_Fields
39123>>>>>>>        Forward Send Define_Fields
39125>>>>>>>        //DDB-Generated-Code-Location
39125>>>>>>>        //DDB-DefineFieldStart
39125>>>>>>>
39125>>>>>>>        Set Main_File            To Garticl.File_Number
39126>>>>>>>        Set Cascade_Delete_State To FALSE
39127>>>>>>>
39127>>>>>>>
39127>>>>>>>        // Child (Client) file structure................
39127>>>>>>>        Send Add_Client_File  Gmove.File_Number
39128>>>>>>>        Send Add_Client_File  Gpmoves.File_Number
39129>>>>>>>        Send Add_Client_File  Gmovea.File_Number
39130>>>>>>>
39130>>>>>>>        // Parent (Server) file structure...............
39130>>>>>>>        Send Add_Server_File  Gtypkin.File_Number
39131>>>>>>>
39131>>>>>>>        // External (System) file structure.............
39131>>>>>>>        Send Add_System_File  Gthaa.File_Number  DD_LOCK_ON_SAVE
39132>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_NEW_SAVE
39133>>>>>>>
39133>>>>>>>        Define_Auto_Increment  Sysrecg.Garticle_Rec0  To Garticl.Garticl_Rec0
39136>>>>>>>
39136>>>>>>>        // Field-based properties.......................
39136>>>>>>>
39136>>>>>>>        // Garticl.Company_Code
39136>>>>>>>        //DDB/ Comment_Short       Field Garticl.Company_Code To "¤£¨é¤«  ©«¤ Update"
39136>>>>>>>
39136>>>>>>>        // Garticl.Branch_Code
39136>>>>>>>        //DDB/ Comment_Short       Field Garticl.Branch_Code To "¤£¨é¤«  ©«¤ Update"
39136>>>>>>>
39136>>>>>>>        // Garticl.Year_Year
39136>>>>>>>        //DDB/ Comment_Short       Field Garticl.Year_Year To "¤£¨é¤«  ©«¤ Update"
39136>>>>>>>
39136>>>>>>>        // Garticl.Gtypkin_Code
39136>>>>>>>        //DDB/ Comment_Short       Field Garticl.Gtypkin_Code To "¤£¨é¤«  ©«¤ Update"
39136>>>>>>>
39136>>>>>>>        // Garticl.Garticl_Hmnia
39136>>>>>>>        //DDB/ Comment_Short       Field Garticl.Garticl_Hmnia To "¤£¨é¤«  ©«¤ Update £æ¤¦¤   £/   ©¦¢¦ ©£¦ç & §¦¨­ãª"
39136>>>>>>>        Set Field_Prompt_Object    Field Garticl.Garticl_Hmnia To (Garticl(Self))
39137>>>>>>>
39137>>>>>>>        // Garticl.Garticl_No
39137>>>>>>>
39137>>>>>>>        // Garticl.Garticl_Rec0
39137>>>>>>>
39137>>>>>>>        // Garticl.Gtypkin_Recr
39137>>>>>>>
39137>>>>>>>        // Garticl.Gthhmgio_Code
39137>>>>>>>        //DDB/ Comment_Short       Field Garticl.Gthhmgio_Code To "¤£¨é¤«  ©«¤ Update"
39137>>>>>>>
39137>>>>>>>        // Garticl.Garticl_Recr
39137>>>>>>>        Set Field_Prompt_Object    Field Garticl.Garticl_Recr To (Garticl(Self))
39138>>>>>>>
39138>>>>>>>        // Garticl.Garticl_Aa
39138>>>>>>>
39138>>>>>>>        // Garticl.Garticl_Aitiol
39138>>>>>>>        Set Field_Value_Table      Field Garticl.Garticl_Aitiol To (Garticl_Garticl_A_Code_VT(Self))
39139>>>>>>>
39139>>>>>>>        // Garticl.Garticl_C_Code2
39139>>>>>>>        Set Field_Value_Table      Field Garticl.Garticl_C_Code2 To (Garticl_Garticl_C_Code2_VT(Self))
39140>>>>>>>
39140>>>>>>>        // Garticl.Garticl_Rate0
39140>>>>>>>        //DDB/ Comment_Short       Field Garticl.Garticl_Rate0 To "¤£¨é¤«  ©«¤ Update if not  User Inputed"
39140>>>>>>>
39140>>>>>>>        // Garticl.Garticl_Rate00
39140>>>>>>>        //DDB/ Comment_Short       Field Garticl.Garticl_Rate00 To "¤£¨é¤«  ©«¤ Update if not  User Inputed"
39140>>>>>>>
39140>>>>>>>        // Garticl.Garticl_Rater
39140>>>>>>>        //DDB/ Comment_Short       Field Garticl.Garticl_Rater To "¤£¨é¤«  ©«¤ Update if not  User Inputed"
39140>>>>>>>
39140>>>>>>>        // Garticl.Garticl_Statuse
39140>>>>>>>        //DDB/ Comment_Short       Field Garticl.Garticl_Statuse To "¤£¨é¤«  ©«¤ Update"
39140>>>>>>>        Set Field_Value_Table      Field Garticl.Garticl_Statuse To (Garticl_Garticl_Statuse_VT(Self))
39141>>>>>>>
39141>>>>>>>        // Garticl.Garticl_Statusa
39141>>>>>>>
39141>>>>>>>        // Garticl.Garticl_M_Code
39141>>>>>>>        //DDB/ Comment_Short       Field Garticl.Garticl_M_Code To "Module ¨­ãª"
39141>>>>>>>        Set Field_Value_Table      Field Garticl.Garticl_M_Code To (Garticl_Garticl_M_Code_VT(Self))
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Sx0
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Sp0
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Syp0
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Syp0k
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Sx00
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Sp00
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Syp00
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Syp00k
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Sx1
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Sp1
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Sx2
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Sp2
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Syp2
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Sxr
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Spr
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Sypr
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Syprk
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Xreline
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Pisline
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Inc
39142>>>>>>>
39142>>>>>>>        // Garticl.Gartcl_Exp
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Cash
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Omada
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Other
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Mlines
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Myfvalp
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Myfcodp
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Myfnump
39142>>>>>>>        //DDB/ Comment_Short       Field Garticl.Garticl_Myfnump To "¤£¨é¤«  ©«¤ Update"
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Myfchkp
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Myfvala
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Myfcoda
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Myfnuma
39142>>>>>>>        //DDB/ Comment_Short       Field Garticl.Garticl_Myfnuma To "¤£¨é¤«  ©«¤ Update"
39142>>>>>>>
39142>>>>>>>        // Garticl.Garticl_Myfchka
39142>>>>>>>
39142>>>>>>>        //DDB-DefineFieldEnd
39142>>>>>>>    End_Procedure    // Define_Fields
39143>>>>>>>
39143>>>>>>>    // Field_Defaults:
39143>>>>>>>    // This procedure is used to establish default field values.
39143>>>>>>>
39143>>>>>>>    Procedure Field_Defaults
39144>>>>>>>        Forward Send Field_Defaults
39146>>>>>>>        //DDB-Generated-Code-Location
39146>>>>>>>        //DDB-FieldDefaultStart
39146>>>>>>>        Set Field_Changed_Value   Field Garticl.Garticl_C_Code2 To "EUR"
39147>>>>>>>        Set Field_Changed_Value   Field Garticl.Garticl_Statuse To -1
39148>>>>>>>        Set Field_Changed_Value   Field Garticl.Garticl_Statusa To 0
39149>>>>>>>        //DDB-FieldDefaultEnd
39149>>>>>>>    End_Procedure    // Field_Defaults
39150>>>>>>>End_Class    // Garticle_DataDictionary
39151>>>>>>>
39151>>>>>>>
39151>>>>>>>
39151>>>>>>>Use doCngGar.bp //defines business process oDoChangeKin
INCLUDING FILE: DOCNGGAR.BP
39151>>>>>>>>>
39151>>>>>>>>>//Set piError to 1001 //â¤ £ ¡á¢© ¡¤åª
39151>>>>>>>>>//Set piError to 1002 //«¦ ¡¢æ¤ ddo â¤ â®  current record
39151>>>>>>>>>//Set piError to 1003 //â¤ ¨â¡ «¦ original garticl
39151>>>>>>>>>
39151>>>>>>>>>
39151>>>>>>>>>//------------------------------------------------------------------ddo tree
39151>>>>>>>>>//        gthhmgio               company
39151>>>>>>>>>//           I                     I
39151>>>>>>>>>//           I                   branch
39151>>>>>>>>>//           I                     I
39151>>>>>>>>>//           I                    year
39151>>>>>>>>>//           I                     I
39151>>>>>>>>>//           I----------I----------I------------I
39151>>>>>>>>>//                      I                       I
39151>>>>>>>>>//                    gtypkin                 gplan
39151>>>>>>>>>//                      I                       I
39151>>>>>>>>>//                      I                       I
39151>>>>>>>>>//                    garticl                   I
39151>>>>>>>>>//                      I                       I
39151>>>>>>>>>//                     ccc                      I
39151>>>>>>>>>//                      I                       I
39151>>>>>>>>>//                      I---------I-------------I
39151>>>>>>>>>//                             Gmove
39151>>>>>>>>>//------------------------------------------------------------------ddo tree
39151>>>>>>>>>
39151>>>>>>>>>Use Gthhmgio.dd
39151>>>>>>>>>Use Gtypkin.dd
39151>>>>>>>>>Use Gplan.dd
39151>>>>>>>>>Use Gmove.dd
INCLUDING FILE: GMOVE.DD
39151>>>>>>>>>>>//DDB-FileStart
39151>>>>>>>>>>>//DDB-HeaderStart
39151>>>>>>>>>>>
39151>>>>>>>>>>>// File Name : GMOVE.DD
39151>>>>>>>>>>>// Class Name: Gmove_DataDictionary
39151>>>>>>>>>>>// Revision  : 89
39151>>>>>>>>>>>// Version   : 2
39151>>>>>>>>>>>
39151>>>>>>>>>>>Use  Windows           // Basic Definitions
39151>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
39151>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39151>>>>>>>>>>>
39151>>>>>>>>>>>Open Gmove
39153>>>>>>>>>>>Open Gopen
39155>>>>>>>>>>>Open Garticl
39157>>>>>>>>>>>Open Gplan
39159>>>>>>>>>>>Open Sysrecg
39161>>>>>>>>>>>Open Gmhnes
39163>>>>>>>>>>>Open Ghmnies
INCLUDING FILE: GHMNIES.FD
39165>>>>>>>>>>>Open Gplanmod
39167>>>>>>>>>>>
39167>>>>>>>>>>>//DDB-HeaderEnd
39167>>>>>>>>>>>//DDB-ValidationStart
39167>>>>>>>>>>>
39167>>>>>>>>>>>Register_Object Gmove_Gmove_A_Code_VT
39167>>>>>>>>>>>Register_Object Gmove_Gplan_Yn_VT
39167>>>>>>>>>>>
39167>>>>>>>>>>>Object Gmove_Gmove_A_Code_VT  is a CodeValidationTable
39169>>>>>>>>>>>    Set Type_Value        To "AITIOL"
39170>>>>>>>>>>>    Set Validate_State    To FALSE
39171>>>>>>>>>>>    Set Allow_Blank_State To TRUE
39172>>>>>>>>>>>    //DDB-ValidationCustomStart
39172>>>>>>>>>>>    //DDB-ValidationCustomEnd
39172>>>>>>>>>>>End_Object   // Gmove_Gmove_A_Code_VT
39173>>>>>>>>>>>
39173>>>>>>>>>>>Object Gmove_Gplan_Yn_VT  is a CodeValidationTable
39175>>>>>>>>>>>    Set Type_Value        To "YESNO"
39176>>>>>>>>>>>    //DDB-ValidationCustomStart
39176>>>>>>>>>>>    //DDB-ValidationCustomEnd
39176>>>>>>>>>>>End_Object   // Gmove_Gplan_Yn_VT
39177>>>>>>>>>>>//DDB-ValidationEnd
39177>>>>>>>>>>>Open Nomisma
39179>>>>>>>>>>>Open Gplanmod //«¦ ¨®å¦ ¬«æ ®¨ á«  £æ¤¦¤   read
39181>>>>>>>>>>>
39181>>>>>>>>>>>
39181>>>>>>>>>>>//«¦ Gmove ©«¤ update/backout ¤£¨é¤  « ¥ãª §å:
39181>>>>>>>>>>>//   Gmove                        garticl
39181>>>>>>>>>>>//   x0                           xreline
39181>>>>>>>>>>>//   po                           pisline
39181>>>>>>>>>>>//  ----------                    omada
39181>>>>>>>>>>>//   x00                          other
39181>>>>>>>>>>>//   poo                          mlines
39181>>>>>>>>>>>//  ----------
39181>>>>>>>>>>>//   xr
39181>>>>>>>>>>>//   pr                           sx2
39181>>>>>>>>>>>//                                sp2
39181>>>>>>>>>>>//                                syp2
39181>>>>>>>>>>>//                               ---------
39181>>>>>>>>>>>//                                sx0
39181>>>>>>>>>>>//                                sp0
39181>>>>>>>>>>>//                                syp0
39181>>>>>>>>>>>//                                syp0k
39181>>>>>>>>>>>//                               ---------
39181>>>>>>>>>>>//                                sx00
39181>>>>>>>>>>>//                                sp00
39181>>>>>>>>>>>//                                syp00
39181>>>>>>>>>>>//                                syp00k
39181>>>>>>>>>>>//                               ---------
39181>>>>>>>>>>>//                                sxr
39181>>>>>>>>>>>//                                spr
39181>>>>>>>>>>>//                                sypr
39181>>>>>>>>>>>//                                syprk
39181>>>>>>>>>>>
39181>>>>>>>>>>>//«¦ Gmove ©«¤ request_save/delete ¤£¨é¤  « ¥ãª ¨®å/§å:
39181>>>>>>>>>>>//    ghmnies  -->   gmhnes       gplan
39181>>>>>>>>>>>//    sx2            sx2          myfno1
39181>>>>>>>>>>>//    sp2            sp2          myfaxia1
39181>>>>>>>>>>>//  ----------
39181>>>>>>>>>>>//    sx0            sx0          myf2  ??
39181>>>>>>>>>>>//    sp0            sp0          myfaxia2
39181>>>>>>>>>>>//  ----------
39181>>>>>>>>>>>//    sx00           sx00
39181>>>>>>>>>>>//    sp00           sp00
39181>>>>>>>>>>>//  ----------
39181>>>>>>>>>>>//    sxr            sxr
39181>>>>>>>>>>>//    spr            spr
39181>>>>>>>>>>>//  ----------
39181>>>>>>>>>>>//    sx1            sx1
39181>>>>>>>>>>>//    sp1            sp1
39181>>>>>>>>>>>//  ----------
39181>>>>>>>>>>>//    gmnorec        ghmnorec
39181>>>>>>>>>>>
39181>>>>>>>>>>>
39181>>>>>>>>>>>
39181>>>>>>>>>>>// a n a l y s i s    g i a    t i s    l o g i s t i k e s    p e r i o d o u s
39181>>>>>>>>>>>//¬§¦¢¦ ©£æª ¢¦ ©« ¡ãª §¨ æ¦¬ ¤­¦¨áª:
39181>>>>>>>>>>>//§¦ « à¨£â¤ £¨¦¢æ  â®¦¬£ hard coded « ª ¥ãª ¢¦ ©« ¡âª §¨ æ¦¬ª:
39181>>>>>>>>>>>//                                               £¨¦£¤å                    PERIOD
39181>>>>>>>>>>>//-109      -9                                                               -9
39181>>>>>>>>>>>//-108      -8                                                               -8
39181>>>>>>>>>>>//-107      -7                                                               -7
39181>>>>>>>>>>>//-106      -6                                                               -6
39181>>>>>>>>>>>//-105      -5*******¨­âª §¦¨­ãª    23/05/98 (fixed)        1998      -5
39181>>>>>>>>>>>//-104      -4                                                               -4
39181>>>>>>>>>>>//-103      -3                                                               -3
39181>>>>>>>>>>>//-102      -2                                                               -2
39181>>>>>>>>>>>//-101      -1                                                               -1
39181>>>>>>>>>>>
39181>>>>>>>>>>>//   0  12 (max 24)     23/05/98 - 30/06/99     1998-1999  5-6-7..12-1-2..6
39181>>>>>>>>>>>
39181>>>>>>>>>>>// 101      +1                                                              101
39181>>>>>>>>>>>// 102      +2                                                              102
39181>>>>>>>>>>>// 103      +3                                                              103
39181>>>>>>>>>>>// 104   +4*******¨­âª «¡«¦§¦å©ª                                  104
39181>>>>>>>>>>>// 105      +5                                                              105
39181>>>>>>>>>>>// 106      +6                                                              106
39181>>>>>>>>>>>// 107      +7                                                              107
39181>>>>>>>>>>>// 108      +8                                                              108
39181>>>>>>>>>>>// 109   +9*******¨­âª ¢ ©å£«¦ª  30/06/99 (fixed)        1999     109
39181>>>>>>>>>>>
39181>>>>>>>>>>>//    £¨¦¢¦ ¡¦å §¨å¦¦  ®¨ã©àª ¤« ©«¦ ®¦ç¤ ©«¦çª 12 (ã maximum 24 £ã¤ª
39181>>>>>>>>>>>//    «¤ §¨å§«à© «ª ¬§¨à¡á£¤ª ®¨ã©ª), ©«åª ¦§¦åª ¡«®à¨¦ç¤«  £
39181>>>>>>>>>>>//   â«¦ª+£ã¤+£¨¦£¤å æ¢ª ¦  ¨­âª.
39181>>>>>>>>>>>
39181>>>>>>>>>>>//  §á¨®¦¬¤ §å©ª á¢¢ª 3 ¢¦ ©« ¡âª §¨å¦¦ , ¦  ¦§¦åª ®¨© £¦§¦ ¦ç¤« 
39181>>>>>>>>>>>//    «¤ §¨¡¦¢¦ç© «à¤ ¨­é¤ §¦¨­ãª (¤¦å£«¦ª),
39181>>>>>>>>>>>//  ©¦¢¦ ©£¦ç (¢ ©å£«¦ª) ¡  «¡«¦§¦å©ª.
39181>>>>>>>>>>>
39181>>>>>>>>>>>//  §æ ¡å ¡  §â¨, «¦ ©ç©«£ £ª å¤  «¤ ¬¤«æ«« ¦¨ ©£¦ç 9 §¨¦¦¬£â¤à¤
39181>>>>>>>>>>>//  ¡  8 §¦£â¤à¤ §¨ æà¤, ©« ª ¦§¦åª ¡«®à¨¦ç¤«  ¡«á §¨å§«à© ¦  ¤ á£©ª
39181>>>>>>>>>>>//  ¨­âª.
39181>>>>>>>>>>>
39181>>>>>>>>>>>//    ¨­âª © ¬«âª « ª ¢¦ ©« ¡âª §¨ æ¦¬ª, ¡«®à¨¦ç¤«  £
39181>>>>>>>>>>>//  £¨¦¢¦ ¡æ â«¦ª+¡à ¡æ ¢¦ ©« ¡ãª §¨ æ¦¬+fixed £¨¦£¤å.
39181>>>>>>>>>>>//  H fixed £¨¦£¤å,   £â¤ « ª §¨¦¦ç£¤ª «ª 1 ¢¦ ©« ¡âª §¨ æ¦¬ª
39181>>>>>>>>>>>//  å¤   year_xrhshFROM, ¤é   « ª £«¤â©«¨ª «ª 1 ¢¦ ©« ¡âª
39181>>>>>>>>>>>//  §¨ æ¦¬ª å¤   year_xrhshTO.
39181>>>>>>>>>>>
39181>>>>>>>>>>>//  Move liYear   to Gmhnes.Gmhnes_YYYY    //£¨¦¢¦ ¡æ â«¦ª
39181>>>>>>>>>>>//  Move liPeriod to Gmhnes.Gmhnes_PERIOD  //¢¦ ©« ¡ã §¨å¦¦ª
39181>>>>>>>>>>>
39181>>>>>>>>>>>// a n a l y s i s    g i a    t i n    M Y F
39181>>>>>>>>>>>
39181>>>>>>>>>>>////// js 09/04/2002 Use Convert.pkg   //package £««¨¦§ãª ¤¦£ ©£á«à¤ â¢®¦ª   ¨¤« ¡âª ¥åª ???
39181>>>>>>>>>>>
39181>>>>>>>>>>>Class Gmove_DataDictionary  is a DataDictionary_Sec
39182>>>>>>>>>>>
39182>>>>>>>>>>>
39182>>>>>>>>>>>      //****************************************************************************************
39182>>>>>>>>>>>      //**************P R O C E D U R A L                       **************
39182>>>>>>>>>>>      //****************************************************************************************
39182>>>>>>>>>>>
39182>>>>>>>>>>>
39182>>>>>>>>>>>      //¡¢å«  §æ save+delete_main_file, « £§¢¡æ£¤ ¨®å å¤  locked
39182>>>>>>>>>>>      // ¡  transaction is enabled!
39182>>>>>>>>>>>      //§å©ª â®à current record © æ¢ « parents.
39182>>>>>>>>>>>      //¡¢å «¤ private.update_gmhnes_ghmnies
39182>>>>>>>>>>>      //§ ©«¨â­  « ¥ãª ¢á: 3001 :¡«á¢¢¢¦ §¨æ©£¦ (¢á¦ª «¦¬ ¡é ¡)
39182>>>>>>>>>>>      //                         3002 :¤ç§¨¡«¦ª §¨ ¢§« ¡æª
39182>>>>>>>>>>>      //                         3003 :¤ç§¨¡«¦ª §¨ ¢§« ¡æª+¨® ¡æª  (¬«æ «¦ error ¬§¦¢é¤  ®¢©£â¤ á©!)
39182>>>>>>>>>>>      //                         3004 :â¤ £§æ¨© ¤ ¨é gplan by recr (¬«æ «¦ error ¬§¦¢é¤  ®¢©£â¤ á©!)
39182>>>>>>>>>>>      //                         3005 :â¤ â«¨¥ ¦ç« update ¦ç« backout (¢á¦ª ¡é ¡)
39182>>>>>>>>>>>      //§å©ª §¦ ¢á¦ª «¦¬ ¡é ¡, £§¦¨å ¤ é©  ¡  Error 10001 "Wrong Num Arguments!\n\nPlease Call Solution!"
39182>>>>>>>>>>>      //á¢¢ § ¤á errors å¤  1017 :§¦¨ç«  ®¨à©« ¡æ ¬§æ¢¦ §¦
39182>>>>>>>>>>>      //                         1018 :§¦¨ç«  § ©«à« ¡æ ¬§æ¢¦ §¦
39182>>>>>>>>>>>      Function private.Trexe Returns Integer
39183>>>>>>>>>>>               Integer liError liGplan_Recnum
39184>>>>>>>>>>>
39184>>>>>>>>>>>               //£¤ ©£æª property   «¬®æ¤ ¢á
39184>>>>>>>>>>>               Set piError to 0
39185>>>>>>>>>>>
39185>>>>>>>>>>>               //§¦ã¡¬© «¨â®¦¤«¦ª gplan recnum
39185>>>>>>>>>>>               Move Gplan.Recnum to liGplan_Recnum
39186>>>>>>>>>>>
39186>>>>>>>>>>>               Send private.Update_Gmhnes_Ghmnies //§¨¦©¦®ã! ¢¦ é¤  «¦ gplan current record !
39187>>>>>>>>>>>
39187>>>>>>>>>>>               //¤á¡¢© «¨â®¦¤«¦ª gplan recnum
39187>>>>>>>>>>>               Clear Gplan
39188>>>>>>>>>>>               Move liGplan_Recnum to Gplan.Recnum
39189>>>>>>>>>>>               Find Eq Gplan.Recnum
39190>>>>>>>>>>>>
39190>>>>>>>>>>>               If (Found = 0);               Begin
39192>>>>>>>>>>>                    Set piError to 0     //£¤ ©£æª property   §æ£¤ ¡å¤©
39193>>>>>>>>>>>                    Function_Return 3003 // ¡¦§ã «¦¬ transaction!
39194>>>>>>>>>>>               End                       //¤ç§¨¡«¦ª ¨® ¡æª (¬«æ «¦ error ¬§¦¢é¤  ®¢©£â¤ á©!)
39194>>>>>>>>>>>>
39194>>>>>>>>>>>                                         // æ«  â¤ £§æ¨© ¤ ¥¤¨é gplan by recnum!
39194>>>>>>>>>>>
39194>>>>>>>>>>>               //¤á¤à© property   «¬®æ¤ ¢á
39194>>>>>>>>>>>               Get piError to liError
39195>>>>>>>>>>>
39195>>>>>>>>>>>               //£¤ ©£æª property   §æ£¤ ¡å¤©
39195>>>>>>>>>>>               Set piError to 0
39196>>>>>>>>>>>               Function_Return liError
39197>>>>>>>>>>>      End_Function //private.trexe
39198>>>>>>>>>>>
39198>>>>>>>>>>>
39198>>>>>>>>>>>      //¡¢å«  §æ «¤ private.trexe
39198>>>>>>>>>>>      //¡¢å «¤ private.update_isozygia 1 ­¦¨á   backout (­å¨© §¢ é¤ « £é¤) ¡ 
39198>>>>>>>>>>>      //                                  1 ­¦¨á   update  (§¨æ©© ¤âà¤ « £é¤)
39198>>>>>>>>>>>      //§¨â§  ¤ ¦§« £¨ ©å   ¡¢ç«¨ «®ç««, æ§àª ¤¢ç«  §¨¡á«à:
39198>>>>>>>>>>>      //¦  § ¤âª §¨ §«é© ª å¤  ¦  ¥ãª:
39198>>>>>>>>>>>      //  update     backout    u * b   vala   valb   remarks
39198>>>>>>>>>>>      //    0           0         0      -      -     ç¤«¦¤ (error 3005=¢á¦ª ©«¦¤ ¡é ¡)
39198>>>>>>>>>>>      //    0           1         0     false  true   delete Gmove
39198>>>>>>>>>>>      //    1           0         0     true   false  create Gmove
39198>>>>>>>>>>>      //    1           1         1       ?     ?     edit   Gmove
39198>>>>>>>>>>>      //¤é ©«¦ delete+create Gmove « §¨á£« å¤  ¥¡á¨ æ©¦¤ ­¦¨á «¦ validation «¦¬ gplan,
39198>>>>>>>>>>>      //©«¦ edit Gmove,  ©®ç¦¬¤ « §¨¡á«à:
39198>>>>>>>>>>>      //                                                                            vala   valb
39198>>>>>>>>>>>      // if gplan_recra = gplan_recrb --> validate only at update                   true   false ¢ã ¡á¤à edit ©«¦ å ¦ gplan (¢¢áà £æ¤¦¤ ®¨âà©/§å©«à©)
39198>>>>>>>>>>>      // else                             validate both at backout and at update    true   true  ¢ã ¢¢áà «¦¬¢á® ©«¦¤ ¡à ¡æ
39198>>>>>>>>>>>      //«â¢¦ª, ¢â®¦¤«  æ¢ª ¦  §¨á£«¨¦  before+after á¤ å¤  å©ª,
39198>>>>>>>>>>>      //¦§æ« â¤ ¤£¨é¤à              «  ©¦ç  (§® ¡á¤à £æ¤¦¤ ¢¢ã  « ¦¢¦åª)
39198>>>>>>>>>>>      Procedure private.Update_Gmhnes_Ghmnies
39199>>>>>>>>>>>                Integer liBackout liUpdate  liError
39200>>>>>>>>>>>
39200>>>>>>>>>>>                Integer liB_Validate        liA_Validate
39200>>>>>>>>>>>
39200>>>>>>>>>>>                Integer liB_Gthhmgio_Period
39200>>>>>>>>>>>                String  lsB_Gplan_Recr
39200>>>>>>>>>>>                Date    ldB_Garticl_Hmnia
39200>>>>>>>>>>>                Number  lnB_Gmove_X2       lnB_Gmove_P2
39200>>>>>>>>>>>                Number  lnB_Gmove_X0       lnB_Gmove_P0
39200>>>>>>>>>>>                Number  lnB_Gmove_X00      lnB_Gmove_P00
39200>>>>>>>>>>>                Number  lnB_Gmove_XR       lnB_Gmove_PR
39200>>>>>>>>>>>                Number  lnB_Gmove_X1       lnB_Gmove_P1
39200>>>>>>>>>>>
39200>>>>>>>>>>>                Integer liA_Gthhmgio_Period
39200>>>>>>>>>>>                String  lsA_Gplan_Recr
39200>>>>>>>>>>>                Date    ldA_Garticl_Hmnia
39200>>>>>>>>>>>                Number  lnA_Gmove_X2       lnA_Gmove_P2
39200>>>>>>>>>>>                Number  lnA_Gmove_X0       lnA_Gmove_P0
39200>>>>>>>>>>>                Number  lnA_Gmove_X00      lnA_Gmove_P00
39200>>>>>>>>>>>                Number  lnA_Gmove_XR       lnA_Gmove_PR
39200>>>>>>>>>>>                Number  lnA_Gmove_X1       lnA_Gmove_P1
39200>>>>>>>>>>>
39200>>>>>>>>>>>                //¤á¤à© ¡«á©«©ª «¦¬ ddo
39200>>>>>>>>>>>                Get piBackout    to liBackout
39201>>>>>>>>>>>                Get piUpdate     to liUpdate
39202>>>>>>>>>>>
39202>>>>>>>>>>>                //  ¢æ¦¬ª ©­¢åª, â¢®¦ª backout & update
39202>>>>>>>>>>>                If (;                     (liBAckout = 0) and;                     (liUpdate  = 0);                   ) Begin
39204>>>>>>>>>>>                      Set piError to 3005 //â¤ â«¨¥ ¦ç« update ¦ç« backout (¢á¦ª ¡é ¡)
39205>>>>>>>>>>>                      Procedure_Return    // ¡¦§ã «¦¬ transaction! (£á¢¢¦¤ «¢åàª §å¤¦, but who knows!
39206>>>>>>>>>>>                     End
39206>>>>>>>>>>>>
39206>>>>>>>>>>>
39206>>>>>>>>>>>                //¤á¤à© §¢ é¤ « £é¤
39206>>>>>>>>>>>                Get piB_Gthhmgio_Period to liB_Gthhmgio_Period
39207>>>>>>>>>>>                Get pdB_Garticl_Hmnia   to ldB_Garticl_Hmnia
39208>>>>>>>>>>>                Get pnB_Gmove_X2       to lnB_Gmove_X2
39209>>>>>>>>>>>                Get pnB_Gmove_P2       to lnB_Gmove_P2
39210>>>>>>>>>>>                Get pnB_Gmove_X0       to lnB_Gmove_X0
39211>>>>>>>>>>>                Get pnB_Gmove_P0       to lnB_Gmove_P0
39212>>>>>>>>>>>                Get pnB_Gmove_X00      to lnB_Gmove_X00
39213>>>>>>>>>>>                Get pnB_Gmove_P00      to lnB_Gmove_P00
39214>>>>>>>>>>>                Get pnB_Gmove_XR       to lnB_Gmove_XR
39215>>>>>>>>>>>                Get pnB_Gmove_PR       to lnB_Gmove_PR
39216>>>>>>>>>>>                Get pnB_Gmove_X1       to lnB_Gmove_X1
39217>>>>>>>>>>>                Get pnB_Gmove_P1       to lnB_Gmove_P1
39218>>>>>>>>>>>                Get psB_Gplan_Recr     to lsB_Gplan_Recr
39219>>>>>>>>>>>
39219>>>>>>>>>>>                //¤á¤à© ¤âà¤ « £é¤
39219>>>>>>>>>>>                Get piA_Gthhmgio_Period to liA_Gthhmgio_Period
39220>>>>>>>>>>>                Get pdA_Garticl_Hmnia   to ldA_Garticl_Hmnia
39221>>>>>>>>>>>                Get pnA_Gmove_X2       to lnA_Gmove_X2
39222>>>>>>>>>>>                Get pnA_Gmove_P2       to lnA_Gmove_P2
39223>>>>>>>>>>>                Get pnA_Gmove_X0       to lnA_Gmove_X0
39224>>>>>>>>>>>                Get pnA_Gmove_P0       to lnA_Gmove_P0
39225>>>>>>>>>>>                Get pnA_Gmove_X00      to lnA_Gmove_X00
39226>>>>>>>>>>>                Get pnA_Gmove_P00      to lnA_Gmove_P00
39227>>>>>>>>>>>                Get pnA_Gmove_XR       to lnA_Gmove_XR
39228>>>>>>>>>>>                Get pnA_Gmove_PR       to lnA_Gmove_PR
39229>>>>>>>>>>>                Get pnA_Gmove_X1       to lnA_Gmove_X1
39230>>>>>>>>>>>                Get pnA_Gmove_P1       to lnA_Gmove_P1
39231>>>>>>>>>>>                Get psA_Gplan_Recr     to lsA_Gplan_Recr
39232>>>>>>>>>>>
39232>>>>>>>>>>>                //á¤ æ¢ª ¦  §¨á£«¨¦  before+after å¤  å©ª,
39232>>>>>>>>>>>                //«æ« â¤ £§å¤à ¡æ¢¦¬ ©«¤ ¤£â¨à©  ©¦¬åà¤,
39232>>>>>>>>>>>                //¢¢á ­çà ...«¨â®¦¤«ª!
39232>>>>>>>>>>>                If (;                     (liB_Gthhmgio_Period=liA_Gthhmgio_Period) and;                     (ldB_Garticl_Hmnia  =ldA_Garticl_Hmnia)   and;                     (lnB_Gmove_X2      =lnA_Gmove_X2)       and;                     (lnB_Gmove_P2      =lnA_Gmove_P2)       and;                     (lnB_Gmove_X0      =lnA_Gmove_X0)       and;                     (lnB_Gmove_P0      =lnB_Gmove_P0)       and;                     (lnB_Gmove_X00     =lnA_Gmove_X00)      and;                     (lnB_Gmove_P00     =lnA_Gmove_P00)      and;                     (lnB_Gmove_XR      =lnA_Gmove_XR)       and;                     (lnB_Gmove_PR      =lnA_Gmove_PR)       and;                     (lnB_Gmove_X1      =lnA_Gmove_X1)       and;                     (lnB_Gmove_P1      =lnA_Gmove_P1)       and;                     (lsB_Gplan_Recr    =lsA_Gplan_Recr);                    ) Begin
39234>>>>>>>>>>>                       Procedure_Return
39235>>>>>>>>>>>                      End
39235>>>>>>>>>>>>
39235>>>>>>>>>>>
39235>>>>>>>>>>>                //©«á¨ ©£«   gplan validations
39235>>>>>>>>>>>                If (;                    ((liUpdate * liBackout) = 0);                   ) Begin //¡á¤à create or delete Gmove record, á¨ validate only at backout or update ¤«å©«¦ ®
39237>>>>>>>>>>>                      Move 1 to liB_Validate
39238>>>>>>>>>>>                      Move 1 to liA_Validate
39239>>>>>>>>>>>                     End
39239>>>>>>>>>>>>
39239>>>>>>>>>>>                Else;                If (;                    (lsB_Gplan_Recr  = lsA_Gplan_Recr);                   ) Begin //¡á¤à edit ©«¦ å ¦ gplan record, á¨ validate only at update
39242>>>>>>>>>>>                      Move 0 to liB_Validate
39243>>>>>>>>>>>                      Move 1 to liA_Validate
39244>>>>>>>>>>>                     End
39244>>>>>>>>>>>>
39244>>>>>>>>>>>                Else;                If (;                    (lsB_Gplan_Recr <> lsA_Gplan_Recr);                   ) Begin //¢¢áà gplan record, á¨ validate both at backout and at update
39247>>>>>>>>>>>                      Move 1 to liB_Validate
39248>>>>>>>>>>>                      Move 1 to liA_Validate
39249>>>>>>>>>>>                     End
39249>>>>>>>>>>>>
39249>>>>>>>>>>>
39249>>>>>>>>>>>                //­å¨© §¢ é¤ « £é¤
39249>>>>>>>>>>>                If (liBackout = 1);                Begin
39251>>>>>>>>>>>                     Send private.Update_Isozygia liB_Gthhmgio_Period;                                                  ldB_Garticl_Hmnia;                                                  lsB_Gplan_Recr;                                                  lnB_Gmove_X2;                                                  lnB_Gmove_P2;                                                  lnB_Gmove_X0;                                                  lnB_Gmove_P0;                                                  lnB_Gmove_X00;                                                  lnB_Gmove_P00;                                                  lnB_Gmove_XR;                                                  lnB_Gmove_PR;                                                  lnB_Gmove_X1;                                                  lnB_Gmove_P1;                                                  (-1);                                                  liB_Validate
39252>>>>>>>>>>>                     Get piError to liError
39253>>>>>>>>>>>                     If (liError <> 0) Procedure_Return
39256>>>>>>>>>>>                End //if (libackout = 1)
39256>>>>>>>>>>>>
39256>>>>>>>>>>>
39256>>>>>>>>>>>                //§¨æ©© ¤âà¤ « £é¤
39256>>>>>>>>>>>                If (liUpdate = 1);                Begin
39258>>>>>>>>>>>                     Send private.Update_Isozygia liA_Gthhmgio_Period;                                                  ldA_Garticl_Hmnia;                                                  lsA_Gplan_Recr;                                                  lnA_Gmove_X2;                                                  lnA_Gmove_P2;                                                  lnA_Gmove_X0;                                                  lnA_Gmove_P0;                                                  lnA_Gmove_X00;                                                  lnA_Gmove_P00;                                                  lnA_Gmove_XR;                                                  lnA_Gmove_PR;                                                  lnA_Gmove_X1;                                                  lnA_Gmove_P1;                                                  1;                                                  liA_Validate
39259>>>>>>>>>>>                End //if (liupdate = 1)
39259>>>>>>>>>>>>
39259>>>>>>>>>>>      End_Procedure//private.update_gmhnes_ghmnies
39260>>>>>>>>>>>
39260>>>>>>>>>>>
39260>>>>>>>>>>>      //¡¢å«  §æ «¤ private.update_gmhnes_ghmnies
39260>>>>>>>>>>>      Procedure private.Update_Isozygia Integer liGthhmgio_Period;                                        Date    ldGarticl_Hmnia;                                        String  lsGplan_Recr;                                        Number  lnX2;                                        Number  lnP2;                                        Number  lnX0;                                        Number  lnP0;                                        Number  lnX00;                                        Number  lnP00;                                        Number  lnXR;                                        Number  lnPR;                                        Number  lnX1;                                        Number  lnP1;                                        Integer liSign;                                        Integer liValidate
39261>>>>>>>>>>>
39261>>>>>>>>>>>                String  lsGplan_Code
39262>>>>>>>>>>>                Integer liGplan_Bathmos liYear liPeriod liCounter
39262>>>>>>>>>>>
39262>>>>>>>>>>>                //  ¢æ¦¬ª ©­¢åª, £ã¤ «¬®æ¤ ¥§¨á©à «¦¬ª 255 ®¨¡«ã¨ª
39262>>>>>>>>>>>                If (Num_Arguments <> 15 ) Error 10001 "Wrong Num Arguments!\n\nPlease Call Solution!"
39265>>>>>>>>>>>
39265>>>>>>>>>>>                //**************************************************************************
39265>>>>>>>>>>>                //01.¬§¦¢¦ ©£æª & â¢®¦ª §¨¦©ã£¦¬ (+ ã -)
39265>>>>>>>>>>>                //**************************************************************************
39265>>>>>>>>>>>                If (;                     ((Abs(liSign)) <> 1 );                   ) Begin
39267>>>>>>>>>>>                      Set piError to 3001 //¡«á¢¢¢¦ §¨æ©£¦ (¢á¦ª ¡é ¡ª)
39268>>>>>>>>>>>                      Procedure_Return    // ¡¦§ã «¦¬ transaction!
39269>>>>>>>>>>>                     End
39269>>>>>>>>>>>>
39269>>>>>>>>>>>                Move (lnX2  * liSign) to lnX2
39270>>>>>>>>>>>                Move (lnP2  * liSign) to lnP2
39271>>>>>>>>>>>                Move (lnX0  * liSign) to lnX0
39272>>>>>>>>>>>                Move (lnP0  * liSign) to lnP0
39273>>>>>>>>>>>                Move (lnX00 * liSign) to lnX00
39274>>>>>>>>>>>                Move (lnP00 * liSign) to lnP00
39275>>>>>>>>>>>                Move (lnXR  * liSign) to lnXR
39276>>>>>>>>>>>                Move (lnPR  * liSign) to lnPR
39277>>>>>>>>>>>                Move (lnX1  * liSign) to lnX1
39278>>>>>>>>>>>                Move (lnP1  * liSign) to lnP1
39279>>>>>>>>>>>
39279>>>>>>>>>>>                //**************************************************************************
39279>>>>>>>>>>>                //02.¡¦¨ ©£æª year & period §¦ «¦ gthhmgio_period
39279>>>>>>>>>>>                //**************************************************************************
39279>>>>>>>>>>>                If (liGthHmgio_Period = 0);                     Begin //£¨¦¢¦ ¡âª §¨å¦¦  ®¨ã©àª
39281>>>>>>>>>>>                      Move (TheYearSegment (ldGarticl_Hmnia)) to liYear
39282>>>>>>>>>>>                      Move (TheMonthSegment(ldGarticl_Hmnia)) to liPeriod
39283>>>>>>>>>>>                     End
39283>>>>>>>>>>>>
39283>>>>>>>>>>>                Else Begin //  ¡ã §¨å¦¦ª
39284>>>>>>>>>>>                      Move (TheYearSegment (ldGarticl_Hmnia)) to liYear
39285>>>>>>>>>>>                      Move liGthHmgio_Period                  to liPeriod
39286>>>>>>>>>>>                     End
39286>>>>>>>>>>>>
39286>>>>>>>>>>>
39286>>>>>>>>>>>                //**************************************************************************
39286>>>>>>>>>>>                //03.ç¨© ©®« ¡¦ç gplan ¡  £¦ç
39286>>>>>>>>>>>                //**************************************************************************
39286>>>>>>>>>>>                Clear Gplan
39287>>>>>>>>>>>                Move lsGplan_Recr to Gplan.Gplan_Recr
39288>>>>>>>>>>>                Find Eq Gplan by Index.2 //gplan_recr
39289>>>>>>>>>>>>
39289>>>>>>>>>>>                If (Found = 0);                Begin
39291>>>>>>>>>>>                      Set piError to 3004 //¨® ¡æ gplan not found (®¢©£â¤ á©!)
39292>>>>>>>>>>>                      Procedure_Return    // ¡¦§ã «¦¬ transaction!
39293>>>>>>>>>>>                End
39293>>>>>>>>>>>>
39293>>>>>>>>>>>                Move Gplan.Gplan_Bathmos to liGplan_Bathmos
39294>>>>>>>>>>>
39294>>>>>>>>>>>                //**************************************************************************
39294>>>>>>>>>>>                //04.¤£â¨à©  ©¦¬åà¤ (gmhnes & ghmnies) ¡  ¨¦ ©«é¤ gplan
39294>>>>>>>>>>>                //**************************************************************************
39294>>>>>>>>>>>                For liCounter From 1 to liGplan_Bathmos
39300>>>>>>>>>>>>
39300>>>>>>>>>>>
39300>>>>>>>>>>>                    //04.1:ç¨©/£ ¦¬¨å & ¤£â¨à© gmhnes
39300>>>>>>>>>>>                    Clear Gmhnes
39301>>>>>>>>>>>                    Move  Gplan.Gplan_Recr             to Gmhnes.Gplan_Recr
39302>>>>>>>>>>>                    Move  liYear                       to Gmhnes.Gmhnes_YYYY
39303>>>>>>>>>>>                    Move  liPeriod                     to Gmhnes.Gmhnes_Period
39304>>>>>>>>>>>                    Find Eq Gmhnes by Index.3 //gplan_recr+gmhnes_yyyy+gmhnes_period
39305>>>>>>>>>>>>
39305>>>>>>>>>>>                    If (Found=0);                    Begin //¨®ã £ ¦¬¨ås ¤â¦¬ record gmhnes
39307>>>>>>>>>>>                         Add 1 to SysrecG.Gmhnes_Rec0
39308>>>>>>>>>>>                         Saverecord SysrecG
39309>>>>>>>>>>>                         Move SysrecG.Gmhnes_Rec0       to Gmhnes.Gmhnes_Rec0
39310>>>>>>>>>>>                         Move (Append('',((Trim(SysCurGL.Branch_Site))+;                                         (Trim(String(Gmhnes.Gmhnes_Rec0)))))) to Gmhnes.Gmhnes_Recr
39311>>>>>>>>>>>
39311>>>>>>>>>>>                         //¤£â¨à© £ã related §åà¤
39311>>>>>>>>>>>                         Move SysCurGL.Company_Code to Gmhnes.Company_Code
39312>>>>>>>>>>>                         Move SysCurGL.Branch_Code  to Gmhnes.Branch_Code
39313>>>>>>>>>>>                         Move SysCurGL.Year_Year    to Gmhnes.Year_Year
39314>>>>>>>>>>>                         Move Gplan.Gplan_Code      to Gmhnes.Gplan_Code
39315>>>>>>>>>>>                    End //«â¢¦ª £ ¦¬¨ås ¤â¦¬ record gmhnes
39315>>>>>>>>>>>>
39315>>>>>>>>>>>
39315>>>>>>>>>>>                    //04.2:ç¨©/£ ¦¬¨å gmhmnies
39315>>>>>>>>>>>                    Clear Ghmnies
39316>>>>>>>>>>>                    Move  Gmhnes.Gmhnes_Recr           to Ghmnies.Gmhnes_Recr
39317>>>>>>>>>>>                    Move  ldGarticl_Hmnia              to Ghmnies.Ghmnies_Hmnia
39318>>>>>>>>>>>                    Find Eq Ghmnies by Index.3 //gmhnes_recr+ghmnies_hmnia
39319>>>>>>>>>>>>
39319>>>>>>>>>>>                    If (Found=0);                    Begin //£ ¦¬¨å ¤â¦¬ record ghmnies
39321>>>>>>>>>>>                         Add 1 to SysrecG.Ghmnies_Rec0
39322>>>>>>>>>>>                         Saverecord SysrecG
39323>>>>>>>>>>>                         Move SysrecG.Ghmnies_Rec0      to Ghmnies.Ghmnies_Rec0
39324>>>>>>>>>>>                         Move (Append('',((Trim(SysCurGL.Branch_Site))+;                                         (Trim(String(Ghmnies.Ghmnies_Rec0)))))) to Ghmnies.Ghmnies_Recr
39325>>>>>>>>>>>
39325>>>>>>>>>>>
39325>>>>>>>>>>>
39325>>>>>>>>>>>
39325>>>>>>>>>>>                         //¤£â¨à© £ã related §åà¤
39325>>>>>>>>>>>                         Move SysCurGL.Company_Code to Ghmnies.Company_Code
39326>>>>>>>>>>>                         Move SysCurGL.Branch_Code  to Ghmnies.Branch_Code
39327>>>>>>>>>>>                         Move SysCurGL.Year_Year    to Ghmnies.Year_Year
39328>>>>>>>>>>>                         Move Gplan.Gplan_Code      to Ghmnies.Gplan_Code
39329>>>>>>>>>>>                         Move Gmhnes.Gmhnes_YYYY    to Ghmnies.Gmhnes_YYYY
39330>>>>>>>>>>>                         Move Gmhnes.Gmhnes_Period  to Ghmnies.Gmhnes_Period
39331>>>>>>>>>>>                    End //«â¢¦ª £ ¦¬¨ås ¤â¦¬ record ghmnies
39331>>>>>>>>>>>>
39331>>>>>>>>>>>
39331>>>>>>>>>>>                    //04.3:¤£â¨à© gplan + gmhnes + ghmnies
39331>>>>>>>>>>>
39331>>>>>>>>>>>                    //04.3.1:¤£â¨à© gplan (update+backout)
39331>>>>>>>>>>>                    Add lnX0   to Gplan.Gplan_Sx0
39332>>>>>>>>>>>                    Add lnP0   to Gplan.Gplan_Sp0
39333>>>>>>>>>>>                    Add lnX00  to Gplan.Gplan_Sx00
39334>>>>>>>>>>>                    Add lnP00  to Gplan.Gplan_Sp00
39335>>>>>>>>>>>                    Add lnXR   to Gplan.Gplan_SxR
39336>>>>>>>>>>>                    Add lnPR   to Gplan.Gplan_SpR
39337>>>>>>>>>>>                  //Add lnX1   to Gplan.Gplan_Sx1
39337>>>>>>>>>>>                  //Add lnP1   to Gplan.Gplan_Sp1
39337>>>>>>>>>>>
39337>>>>>>>>>>>                    Add liSign to Gplan.Gplan_Gmhnnorec
39338>>>>>>>>>>>                    //bale kai pedia gia periodoys (-) periodoys (0) periodous (+)!
39338>>>>>>>>>>>
39338>>>>>>>>>>>                    //04.3.2:â¢®¦ª gplan (validations 1017 + 1018:â¢®¦  ¬§¦¢¦å§à¤)
39338>>>>>>>>>>>                    //£æ¤¦¤ á¤ ®¨ á« 
39338>>>>>>>>>>>                    If (liValidate = TRUE);                    Begin
39340>>>>>>>>>>>                         //04.3.2.1:â¢®¦ª ®¨à©« ¡¦ç ¬§¦¢¦å§¦¬
39340>>>>>>>>>>>                         If (;                                  (Gplan.Gplan_Yn_Xy = FALSE          ) and;                              (Not(Gplan.Gplan_Sp0  >= Gplan.Gplan_Sx0));                            );                         Begin
39342>>>>>>>>>>>                              Set psGplan_Code  to Gplan.Gplan_Code
39343>>>>>>>>>>>                              Set pnGplan_Ypol0 to (Gplan.Gplan_Sx0-Gplan.Gplan_Sp0)
39344>>>>>>>>>>>                              Set piError to 1017 //§¦¨ç«  ®¨à©« ¡æ ¬§æ¢¦ §¦
39345>>>>>>>>>>>                              Procedure_Return   // ¡¦§ã «¦¬ transaction!
39346>>>>>>>>>>>                         End
39346>>>>>>>>>>>>
39346>>>>>>>>>>>                         //04.3.2.2:â¢®¦ª § ©«à« ¡¦ç ¬§¦¢¦å§¦¬
39346>>>>>>>>>>>                         If (;                                  (Gplan.Gplan_Yn_Py = FALSE          ) and;                              (Not(Gplan.Gplan_Sx0  >= Gplan.Gplan_Sp0));                            );                         Begin
39348>>>>>>>>>>>                              Set psGplan_Code  to Gplan.Gplan_Code
39349>>>>>>>>>>>                              Set pnGplan_Ypol0 to (Gplan.Gplan_Sx0-Gplan.Gplan_Sp0)
39350>>>>>>>>>>>                              Set piError to 1018 //§¦¨ç«  § ©«à« ¡æ ¬§æ¢¦ §¦
39351>>>>>>>>>>>                              Procedure_Return   // ¡¦§ã «¦¬ transaction!
39352>>>>>>>>>>>                         End
39352>>>>>>>>>>>>
39352>>>>>>>>>>>                    End //«â¢¦ª validation gplan
39352>>>>>>>>>>>>
39352>>>>>>>>>>>
39352>>>>>>>>>>>                    //04.3.3:¤£â¨à© ghhmnies (update+backout)
39352>>>>>>>>>>>                    Add lnX2   to Ghmnies.Ghmnies_Sx2
39353>>>>>>>>>>>                    Add lnP2   to Ghmnies.Ghmnies_Sp2
39354>>>>>>>>>>>                    Add lnX0   to Ghmnies.Ghmnies_Sx0
39355>>>>>>>>>>>                    Add lnP0   to Ghmnies.Ghmnies_Sp0
39356>>>>>>>>>>>                    Add lnX00  to Ghmnies.Ghmnies_Sx00
39357>>>>>>>>>>>                    Add lnP00  to Ghmnies.Ghmnies_Sp00
39358>>>>>>>>>>>                    Add lnXR   to Ghmnies.Ghmnies_SxR
39359>>>>>>>>>>>                    Add lnPR   to Ghmnies.Ghmnies_SpR
39360>>>>>>>>>>>                    Add lnX1   to Ghmnies.Ghmnies_Sx1
39361>>>>>>>>>>>                    Add lnP1   to Ghmnies.Ghmnies_Sp1
39362>>>>>>>>>>>
39362>>>>>>>>>>>                    Add liSign to Ghmnies.Ghmnies_Gmnorec
39363>>>>>>>>>>>
39363>>>>>>>>>>>                    //04.3.4:¤£â¨à© ghmnes (update+backout)
39363>>>>>>>>>>>                    Add lnX2   to Gmhnes.Gmhnes_Sx2
39364>>>>>>>>>>>                    Add lnP2   to Gmhnes.Gmhnes_Sp2
39365>>>>>>>>>>>                    Add lnX0   to Gmhnes.Gmhnes_Sx0
39366>>>>>>>>>>>                    Add lnP0   to Gmhnes.Gmhnes_Sp0
39367>>>>>>>>>>>                    Add lnX00  to Gmhnes.Gmhnes_Sx00
39368>>>>>>>>>>>                    Add lnP00  to Gmhnes.Gmhnes_Sp00
39369>>>>>>>>>>>                    Add lnXR   to Gmhnes.Gmhnes_SxR
39370>>>>>>>>>>>                    Add lnPR   to Gmhnes.Gmhnes_SpR
39371>>>>>>>>>>>                    Add lnX1   to Gmhnes.Gmhnes_Sx1
39372>>>>>>>>>>>                    Add lnP1   to Gmhnes.Gmhnes_Sp1
39373>>>>>>>>>>>
39373>>>>>>>>>>>                    Add liSign to Gmhnes.Gmhnes_GhmNoRec
39374>>>>>>>>>>>
39374>>>>>>>>>>>                    //04.3.5:©é© £¦ «à¤ 3 records
39374>>>>>>>>>>>                    Saverecord Gplan
39375>>>>>>>>>>>                    Saverecord Gmhnes
39376>>>>>>>>>>>                    Saverecord Ghmnies
39377>>>>>>>>>>>
39377>>>>>>>>>>>                    //04.4:ç¨© ¡à ¡¦ç §¨ ¢§« ¡¦ç   £ã §¨à«¦á£ ¦¬ª !
39377>>>>>>>>>>>                    //     (« §å gplan_anoep+gplan_bathmos â®¦¬¤ ã validaristei ©«¦ gplan_dd) please check it!!!
39377>>>>>>>>>>>                    If (Gplan.Gplan_Bathmos <> 1);                    Begin
39379>>>>>>>>>>>                          Move Gplan.Gplan_Anoep to lsGplan_Code
39380>>>>>>>>>>>                          //04.5:ç¨© §¨ ¢§« ¡¦ç
39380>>>>>>>>>>>                          Clear Gplan
39381>>>>>>>>>>>                          Move SysCurGL.Company_Code to Gplan.Company_Code
39382>>>>>>>>>>>                          Move SysCurGL.Branch_Code  to Gplan.Branch_Code
39383>>>>>>>>>>>                          Move SysCurGL.Year_Year    to Gplan.Year_Year
39384>>>>>>>>>>>                          Move lsGplan_Code          to Gplan.Gplan_Code
39385>>>>>>>>>>>                          Find Eq Gplan by Index.1 //company_code+branch_code+year_year+gplan_code
39386>>>>>>>>>>>>
39386>>>>>>>>>>>                          If (Found = 0);                          Begin
39388>>>>>>>>>>>                                Set piError to 3002 //¤ç§¨¡«¦ª §¨ ¢§« ¡æª (reindex + check gplan)
39389>>>>>>>>>>>                                Procedure_Return    // ¡¦§ã «¦¬ transaction!
39390>>>>>>>>>>>                          End
39390>>>>>>>>>>>>
39390>>>>>>>>>>>                    End
39390>>>>>>>>>>>>
39390>>>>>>>>>>>                Loop
39391>>>>>>>>>>>>
39391>>>>>>>>>>>      End_Procedure //private.update_isozygia
39392>>>>>>>>>>>      //****************************************************************************************
39392>>>>>>>>>>>      //**************P R O C E D U R A L                       **************
39392>>>>>>>>>>>      //****************************************************************************************
39392>>>>>>>>>>>
39392>>>>>>>>>>>
39392>>>>>>>>>>>      //private
39392>>>>>>>>>>>      //¤£¨é¤  « 13 §å open item
39392>>>>>>>>>>>      //¡¢å«  §æ update
39392>>>>>>>>>>>                     //§¨â§ : yx between 0 and x0     yx>=0
39392>>>>>>>>>>>                     //        yp         = 0
39392>>>>>>>>>>>                     //        sx between 0 and x0
39392>>>>>>>>>>>                     //        sp=0
39392>>>>>>>>>>>      Procedure private.Do_Compute_Open_Items
39393>>>>>>>>>>>                Case Begin
39393>>>>>>>>>>>                     Case (Gmove.Gmove_X0 > 0)
39395>>>>>>>>>>>                          Move "+"                                               to Gmove.Gmove_Topen
39396>>>>>>>>>>>                          Move (     Gmove.Gmove_X0  - Gmove.Gmove_Open_Sx0) to Gmove.Gmove_Open_Yx0
39397>>>>>>>>>>>                          Move 0                                                 to Gmove.Gmove_Open_Yp0
39398>>>>>>>>>>>                     Case Break
39399>>>>>>>>>>>
39399>>>>>>>>>>>                     Case (Gmove.Gmove_X0 < 0)
39402>>>>>>>>>>>                          Move "-"                                               to Gmove.Gmove_Topen
39403>>>>>>>>>>>                          Move ((Abs(Gmove.Gmove_X0))- Gmove.Gmove_Open_Sp0) to Gmove.Gmove_Open_Yp0
39404>>>>>>>>>>>                          Move 0                                                 to Gmove.Gmove_Open_Yx0
39405>>>>>>>>>>>                     Case Break
39406>>>>>>>>>>>
39406>>>>>>>>>>>                     Case (Gmove.Gmove_P0 > 0)
39409>>>>>>>>>>>                          Move "-"                                               to Gmove.Gmove_Topen
39410>>>>>>>>>>>                          Move (     Gmove.Gmove_P0  - Gmove.Gmove_Open_Sp0) to Gmove.Gmove_Open_Yp0
39411>>>>>>>>>>>                          Move 0                                                 to Gmove.Gmove_Open_Yx0
39412>>>>>>>>>>>                     Case Break
39413>>>>>>>>>>>
39413>>>>>>>>>>>                     Case (Gmove.Gmove_P0 < 0)
39416>>>>>>>>>>>                          Move "+"                                               to Gmove.Gmove_Topen
39417>>>>>>>>>>>                          Move ((Abs(Gmove.Gmove_P0))- Gmove.Gmove_Open_Sx0) to Gmove.Gmove_Open_Yx0
39418>>>>>>>>>>>                          Move 0                                                 to Gmove.Gmove_Open_Yp0
39419>>>>>>>>>>>                     Case Break
39420>>>>>>>>>>>                Case End
39420>>>>>>>>>>>      End_Procedure //private.Do_Compute_Open_Items
39421>>>>>>>>>>>
39421>>>>>>>>>>>
39421>>>>>>>>>>>
39421>>>>>>>>>>>      //private
39421>>>>>>>>>>>      //¢â®  « 13 §å open item
39421>>>>>>>>>>>      //¡¢å«  §æ validate save
39421>>>>>>>>>>>      Function  private.fi_Validate_Open_Items Returns Integer
39422>>>>>>>>>>>                 //1101+1102+1103+1104:â¢®¦  £ã ¨¤« ¡é¤ ¬§¦¢¦å§à¤ §¨¦ª ©¬©®â« © ¡  ©¬©®« ©â¤«à¤ §¦©é¤
39422>>>>>>>>>>>                           If (Not(Gmove.Gmove_Open_Yx0 >= 0                      )) Function_Return 1101
39425>>>>>>>>>>>                           If (Not(Gmove.Gmove_Open_Yp0 >= 0                      )) Function_Return 1102
39428>>>>>>>>>>>                           If (Not(Gmove.Gmove_Open_Sx0 >= 0                      )) Function_Return 1103
39431>>>>>>>>>>>                           If (Not(Gmove.Gmove_Open_Sp0 >= 0                      )) Function_Return 1104
39434>>>>>>>>>>>
39434>>>>>>>>>>>                 Case Begin
39434>>>>>>>>>>>                      //1105+1106+1107+1108:â¢®¦    «æ­ ¦ ®¨à©« ¡æ record
39434>>>>>>>>>>>                      Case (Gmove.Gmove_X0 > 0)
39436>>>>>>>>>>>                           If (Not(Gmove.Gmove_Open_Yx0 <=      Gmove.Gmove_X0  )) Function_Return 1105
39439>>>>>>>>>>>                           If (Not(Gmove.Gmove_Open_Sx0 <=      Gmove.Gmove_X0  )) Function_Return 1106
39442>>>>>>>>>>>                           If (Not(Gmove.Gmove_Open_Yp0  = 0                      )) Function_Return 1107
39445>>>>>>>>>>>                           If (Not(Gmove.Gmove_Open_Sp0  = 0                      )) Function_Return 1108
39448>>>>>>>>>>>                      Case Break
39449>>>>>>>>>>>                      //1109+1110+1111+1112:â¢®¦    ¯¬«¦- ®¨à©« ¡æ record
39449>>>>>>>>>>>                      Case (Gmove.Gmove_X0 < 0)
39452>>>>>>>>>>>                           If (Not(Gmove.Gmove_Open_Yx0  = 0                      )) Function_Return 1109
39455>>>>>>>>>>>                           If (Not(Gmove.Gmove_Open_Sx0  = 0                      )) Function_Return 1110
39458>>>>>>>>>>>                           If (Not(Gmove.Gmove_Open_Yp0 <= (Abs(Gmove.Gmove_X0)))) Function_Return 1111
39461>>>>>>>>>>>                           If (Not(Gmove.Gmove_Open_Sp0 <= (Abs(Gmove.Gmove_X0)))) Function_Return 1112
39464>>>>>>>>>>>                      Case Break
39465>>>>>>>>>>>                      //1113+1114+1115+1116:â¢®¦    «æ­ ¦ § ©«à« ¡æ record
39465>>>>>>>>>>>                      Case (Gmove.Gmove_P0 > 0)
39468>>>>>>>>>>>                           If (Not(Gmove.Gmove_Open_Yx0  = 0                      )) Function_Return 1113
39471>>>>>>>>>>>                           If (Not(Gmove.Gmove_Open_Sx0  = 0                      )) Function_Return 1114
39474>>>>>>>>>>>                           If (Not(Gmove.Gmove_Open_Yp0 <=      Gmove.Gmove_P0  )) Function_Return 1115
39477>>>>>>>>>>>                           If (Not(Gmove.Gmove_Open_Sp0 <=      Gmove.Gmove_P0  )) Function_Return 1116
39480>>>>>>>>>>>                      Case Break
39481>>>>>>>>>>>                      //1117+1118+1119+1120:â¢®¦    ¯ç«¦- ®¨à©« ¡æ record
39481>>>>>>>>>>>                      Case (Gmove.Gmove_P0 < 0)
39484>>>>>>>>>>>                           If (Not(Gmove.Gmove_Open_Yx0 <= (Abs(Gmove.Gmove_P0)))) Function_Return 1117
39487>>>>>>>>>>>                           If (Not(Gmove.Gmove_Open_Sx0 <= (Abs(Gmove.Gmove_P0)))) Function_Return 1118
39490>>>>>>>>>>>                           If (Not(Gmove.Gmove_Open_Yp0  = 0                      )) Function_Return 1119
39493>>>>>>>>>>>                           If (Not(Gmove.Gmove_Open_Sp0  = 0                      )) Function_Return 1120
39496>>>>>>>>>>>                      Case Break
39497>>>>>>>>>>>                 Case End
39497>>>>>>>>>>>
39497>>>>>>>>>>>                 Function_Return 0 //æ¢ ok
39498>>>>>>>>>>>      End_Function  //private.fi_validate_open_items
39499>>>>>>>>>>>
39499>>>>>>>>>>>
39499>>>>>>>>>>>
39499>>>>>>>>>>>
39499>>>>>>>>>>>
39499>>>>>>>>>>>      //private
39499>>>>>>>>>>>      //¨å©¡  á¤ § «¨â§«   ¡å¤©ã «¦¬ ©¬¡¡¨ £â¤¦¬ ¢¦¨ ©£¦ç
39499>>>>>>>>>>>      //«¦¬ Gmove §¦ «¦ «¨â®¦¤ module.
39499>>>>>>>>>>>      //¡¢å«  §æ validate_save
39499>>>>>>>>>>>      Function private.fiGplanmod_Module String  lsGplan_Recr;                                         String  lsModule;                                         Returns Integer
39500>>>>>>>>>>>               Clear Gplanmod
39501>>>>>>>>>>>               Move lsGplan_Recr to Gplanmod.Gplan_Recr
39502>>>>>>>>>>>               Move lsModule     to Gplanmod.Gplanmod_Module
39503>>>>>>>>>>>               Find Eq Gplanmod By Index.3 //gplan_recr+gplanmod_module
39504>>>>>>>>>>>>
39504>>>>>>>>>>>               Function_Return (Found)
39505>>>>>>>>>>>      End_Function //private.fiGplanmod_Module
39506>>>>>>>>>>>
39506>>>>>>>>>>>
39506>>>>>>>>>>>      Procedure private.Initialize_Properties
39507>>>>>>>>>>>                //Gmove related properties
39507>>>>>>>>>>>                Set psB_Gplan_Recr    to '' //gplan recr
39508>>>>>>>>>>>                Set pnB_Gmove_X2      to 0  //X2          2:¤¦£ ©£ ¨­ãª
39509>>>>>>>>>>>                Set pnB_Gmove_P2      to 0  //P2
39510>>>>>>>>>>>                Set pnB_Gmove_X0      to 0  //x0          0:¡ç¨ ¦ ¤æ£ ©£ ®¨ã©ª
39511>>>>>>>>>>>                Set pnB_Gmove_P0      to 0  //p0
39512>>>>>>>>>>>                Set pnB_Gmove_X00     to 0  //x00         00:¬«¨ç¦¤ ¤æ£ ©£ ®¨ã©ª
39513>>>>>>>>>>>                Set pnB_Gmove_P00     to 0  //p00
39514>>>>>>>>>>>                Set pnB_Gmove_XR      to 0  //xr          r:¤æ£ ©£ reporting
39515>>>>>>>>>>>                Set pnB_Gmove_PR      to 0  //pr
39516>>>>>>>>>>>                Set pnB_Gmove_X1      to 0  //X1          0:¡ç¨ ¦ ¤æ£ ©£ ®¨ã©ª ¦¨ ©« ¡¦§¦ £â¤
39517>>>>>>>>>>>                Set pnB_Gmove_P1      to 0  //P1
39518>>>>>>>>>>>
39518>>>>>>>>>>>                Set psA_Gplan_Recr    to '' //gplan recr
39519>>>>>>>>>>>                Set pnA_Gmove_X2      to 0  //X2          2:¤¦£ ©£ ¨­ãª
39520>>>>>>>>>>>                Set pnA_Gmove_P2      to 0  //P2
39521>>>>>>>>>>>                Set pnA_Gmove_X0      to 0  //x0          0:¡ç¨ ¦ ¤æ£ ©£ ®¨ã©ª
39522>>>>>>>>>>>                Set pnA_Gmove_P0      to 0  //p0
39523>>>>>>>>>>>                Set pnA_Gmove_X00     to 0  //x00         00:¬«¨ç¦¤ ¤æ£ ©£ ®¨ã©ª
39524>>>>>>>>>>>                Set pnA_Gmove_P00     to 0  //p00
39525>>>>>>>>>>>                Set pnA_Gmove_XR      to 0  //xr          r:¤æ£ ©£ reporting
39526>>>>>>>>>>>                Set pnA_Gmove_PR      to 0  //pr
39527>>>>>>>>>>>                Set pnA_Gmove_X2      to 0  //X1          0:¡ç¨ ¦ ¤æ£ ©£ ®¨ã©ª ¦¨ ©« ¡¦§¦ £â¤
39528>>>>>>>>>>>                Set pnA_Gmove_P2      to 0  //P1
39529>>>>>>>>>>>
39529>>>>>>>>>>>                //garticl related properties
39529>>>>>>>>>>>                Set pdB_Garticl_Hmnia  to 0
39530>>>>>>>>>>>                Set pdA_Garticl_Hmnia  to 0
39531>>>>>>>>>>>
39531>>>>>>>>>>>                //properties   procedural ¤£â¨à© ghmnies+gmhnes
39531>>>>>>>>>>>                Set piB_Gthhmgio_Period to 0
39532>>>>>>>>>>>////////////////Set piB_Gplan_Bathmos   to 0
39532>>>>>>>>>>>////////////////Set psB_Gplan_Code      to ""
39532>>>>>>>>>>>                Set piA_Gthhmgio_Period to 0
39533>>>>>>>>>>>////////////////Set piA_Gplan_Bathmos   to 0
39533>>>>>>>>>>>////////////////Set psA_Gplan_Code      to ""
39533>>>>>>>>>>>
39533>>>>>>>>>>>                Set piError             to 0
39534>>>>>>>>>>>                Set psGplan_Code        to ""
39535>>>>>>>>>>>                Set pnGplan_Ypol0       to 0
39536>>>>>>>>>>>
39536>>>>>>>>>>>
39536>>>>>>>>>>>                Set piUpdate           to 0
39537>>>>>>>>>>>                Set piBackout          to 0
39538>>>>>>>>>>>////////////////Set piTheorimeno       to 0
39538>>>>>>>>>>>
39538>>>>>>>>>>>                Set piFireConvert      to 0 //????? £§àª ¤ ®¨ «  à?
39539>>>>>>>>>>>
39539>>>>>>>>>>>                Set piB_Garticl_Aa     to 0 //  «¦¤ â¢®¦ 
39540>>>>>>>>>>>                Set piA_Garticl_Aa     to 0
39541>>>>>>>>>>>
39541>>>>>>>>>>>      End_Procedure //private.Initialize_Properties
39542>>>>>>>>>>>
39542>>>>>>>>>>>
39542>>>>>>>>>>>      //¡  ¬«ã  §¨â§  ¤ §á  global
39542>>>>>>>>>>>      Function fnFindOmada string LsGplan_Fn## Returns Integer
39543>>>>>>>>>>>               Local Integer liOmada##
39544>>>>>>>>>>>
39544>>>>>>>>>>>                   If (Mid(lsGPlan_Fn##,1,1) eq "6") begin
39546>>>>>>>>>>>                       Function_Return 1
39547>>>>>>>>>>>                   end
39547>>>>>>>>>>>>
39547>>>>>>>>>>>                   If (Mid(lsGPlan_Fn##,1,1) eq "7") begin
39549>>>>>>>>>>>                       Function_Return 1
39550>>>>>>>>>>>                   end
39550>>>>>>>>>>>>
39550>>>>>>>>>>>                   If (Mid(lsGPlan_Fn##,2,1) eq "38") begin
39552>>>>>>>>>>>                       Function_Return 1
39553>>>>>>>>>>>                   end
39553>>>>>>>>>>>>
39553>>>>>>>>>>>                   If (Mid(lsGPlan_Fn##,2,1) eq "2") begin
39555>>>>>>>>>>>                       Function_Return 1
39556>>>>>>>>>>>                   end
39556>>>>>>>>>>>>
39556>>>>>>>>>>>
39556>>>>>>>>>>>               Function_Return 0
39557>>>>>>>>>>>      End_Function
39558>>>>>>>>>>>
39558>>>>>>>>>>>
39558>>>>>>>>>>>      //¬«ã £á¢¢¦¤ ®¨© £¦§¦ å«  §¦ «¦ view ¡  §¨â§  ¤ ­ç  §¦ é!
39558>>>>>>>>>>>      Function FnXre_Pist Number lnXre## Number lnPist## Returns Integer
39559>>>>>>>>>>>           If (lnXre## <> 0) Begin
39561>>>>>>>>>>>               Function_Return 1
39562>>>>>>>>>>>           end
39562>>>>>>>>>>>>
39562>>>>>>>>>>>           If (lnPist## <> 0) Begin
39564>>>>>>>>>>>               Function_Return 2
39565>>>>>>>>>>>           end
39565>>>>>>>>>>>>
39565>>>>>>>>>>>           Function_Return 0
39566>>>>>>>>>>>      End_Function
39567>>>>>>>>>>>
39567>>>>>>>>>>>
39567>>>>>>>>>>>    Procedure Construct_Object
39568>>>>>>>>>>>
39568>>>>>>>>>>>              Forward Send Construct_Object
39570>>>>>>>>>>>
39570>>>>>>>>>>>              //Gmove related properties
39570>>>>>>>>>>>              Property String  psB_Gplan_Recr    ''  //gplan recr
39571>>>>>>>>>>>              Property Number  pnB_Gmove_X2       0  //X2          2:¤¦£ ©£ ¨­ãª
39572>>>>>>>>>>>              Property Number  pnB_Gmove_P2       0  //P2
39573>>>>>>>>>>>              Property Number  pnB_Gmove_X0       0  //x0          0:¡ç¨ ¦ ¤æ£ ©£ ®¨ã©ª
39574>>>>>>>>>>>              Property Number  pnB_Gmove_P0       0  //p0
39575>>>>>>>>>>>              Property Number  pnB_Gmove_X00      0  //x00         00:¬«¨ç¦¤ ¤æ£ ©£ ®¨ã©ª
39576>>>>>>>>>>>              Property Number  pnB_Gmove_P00      0  //p00
39577>>>>>>>>>>>              Property Number  pnB_Gmove_XR       0  //xr          r:¤æ£ ©£ reporting
39578>>>>>>>>>>>              Property Number  pnB_Gmove_PR       0  //pr
39579>>>>>>>>>>>              Property Number  pnB_Gmove_X1       0  //X1          0:¡ç¨ ¦ ¤æ£ ©£ ®¨ã©ª ¦¨ ©« ¡¦§¦ £â¤
39580>>>>>>>>>>>              Property Number  pnB_Gmove_P1       0  //P1
39581>>>>>>>>>>>
39581>>>>>>>>>>>              Property String  psA_Gplan_Recr    ''  //gplan recr
39582>>>>>>>>>>>              Property Number  pnA_Gmove_X2       0  //X2          2:¤¦£ ©£ ¨­ãª
39583>>>>>>>>>>>              Property Number  pnA_Gmove_P2       0  //P2
39584>>>>>>>>>>>              Property Number  pnA_Gmove_X0       0  //x0          0:¡ç¨ ¦ ¤æ£ ©£ ®¨ã©ª
39585>>>>>>>>>>>              Property Number  pnA_Gmove_P0       0  //p0
39586>>>>>>>>>>>              Property Number  pnA_Gmove_X00      0  //x00         00:¬«¨ç¦¤ ¤æ£ ©£ ®¨ã©ª
39587>>>>>>>>>>>              Property Number  pnA_Gmove_P00      0  //p00
39588>>>>>>>>>>>              Property Number  pnA_Gmove_XR       0  //xr          r:¤æ£ ©£ reporting
39589>>>>>>>>>>>              Property Number  pnA_Gmove_PR       0  //pr
39590>>>>>>>>>>>              Property Number  pnA_Gmove_X1       0  //X1          0:¡ç¨ ¦ ¤æ£ ©£ ®¨ã©ª ¦¨ ©« ¡¦§¦ £â¤
39591>>>>>>>>>>>              Property Number  pnA_Gmove_P1       0  //P1
39592>>>>>>>>>>>
39592>>>>>>>>>>>              //garticl related properties
39592>>>>>>>>>>>              Property Date    pdA_Garticl_Hmnia   0
39593>>>>>>>>>>>              Property Date    pdB_Garticl_Hmnia   0
39594>>>>>>>>>>>
39594>>>>>>>>>>>              Property Integer piUpdate            0
39595>>>>>>>>>>>              Property Integer piBackout           0
39596>>>>>>>>>>>//////////////Property Integer piTheorimeno        0 //©«á¨«  §¦ «¤ request_save_th,  ¦§æ 
39596>>>>>>>>>>>                                                           //                            ¡¢å«  §æ: a) doUpAA.pkg
39596>>>>>>>>>>>                                                           //                                          b) doZeroAA.pkg
39596>>>>>>>>>>>
39596>>>>>>>>>>>              //properties   procedural ¤£â¨à© ghmnies+gmhnes
39596>>>>>>>>>>>              Property Integer piB_Gthhmgio_Period  0
39597>>>>>>>>>>>              Property Integer piA_Gthhmgio_Period  0
39598>>>>>>>>>>>//////////////Property Integer piB_Gplan_Bathmos    0
39598>>>>>>>>>>>//////////////Property Integer piA_Gplan_Bathmos    0
39598>>>>>>>>>>>//////////////Property String  psB_Gplan_Code       ""
39598>>>>>>>>>>>//////////////Property String  psA_Gplan_Code       ""
39598>>>>>>>>>>>
39598>>>>>>>>>>>              Property Integer piError              0  //®¨© £¦§¦ ¦ç¤«  §¦ « ª private
39599>>>>>>>>>>>              Property String  psGplan_Code         "" //¨¦¬«å¤ª   «¤ procedural
39600>>>>>>>>>>>              Property Number  pnGplan_Ypol0        0  //¤£â¨à© «à¤  ©¦¬åà¤ æ«¤ ¤«¦§å«  ¢á¦ª
39601>>>>>>>>>>>                                                       //¦§æ«  operation_not_allowed ¥â¨  §¦æª ¢¦/£æª
39601>>>>>>>>>>>                                                       //®«¬§á  error 1017 + 1017
39601>>>>>>>>>>>
39601>>>>>>>>>>>              Property Integer piFireConvert        0 //ja//
39602>>>>>>>>>>>
39602>>>>>>>>>>>
39602>>>>>>>>>>>//////////////Property Integer piGarticl_dd         0 //object id of server garticl dd
39602>>>>>>>>>>>//////////////Property Integer pioDo_Update_Hmnies  0 //object id for business process object
39602>>>>>>>>>>>
39602>>>>>>>>>>>              Property String  psGarticl_MyfCodp    "" //£æ¤¦¤   display of error 1006
39603>>>>>>>>>>>              Property String  psGarticl_MyfCoda    "" //£æ¤¦¤   display of error 1007???
39604>>>>>>>>>>>
39604>>>>>>>>>>>
39604>>>>>>>>>>>
39604>>>>>>>>>>>              Property Integer piB_Garticl_Aa       0 //  «¦¤ â¢®¦ 
39605>>>>>>>>>>>              Property Integer piA_Garticl_Aa       0
39606>>>>>>>>>>>
39606>>>>>>>>>>>
39606>>>>>>>>>>>    End_Procedure   //construct_object
39607>>>>>>>>>>>
39607>>>>>>>>>>>
39607>>>>>>>>>>>//-     Procedure End_Construct_Object
39607>>>>>>>>>>>//- //////////////Integer liGarticl_dd
39607>>>>>>>>>>>//-               Forward Send End_Construct_Object
39607>>>>>>>>>>>//-               //find servers & clients
39607>>>>>>>>>>>//- //////////////Set piGarticl_dd to (Find_Server_DDO(Self,Garticl.File_Number))
39607>>>>>>>>>>>//- //////////////Get piGarticl_dd to liGarticl_dd
39607>>>>>>>>>>>//-
39607>>>>>>>>>>>//-               //Set piGmove_dd of liGarticl_dd to (Self)
39607>>>>>>>>>>>//-               //Set pioDo_Update_Hmnies to (oDoUpdateHmnies(Self))
39607>>>>>>>>>>>//     End_Procedure   //end_construct_object
39607>>>>>>>>>>>
39607>>>>>>>>>>>
39607>>>>>>>>>>>    Procedure Backout //sos é « properties b ©«á¨¦¤«  §¦ «¦ Gmove
39608>>>>>>>>>>>                      //¡  æ®  §¦ « parent buffers ! ! ! ! ! !
39608>>>>>>>>>>>
39608>>>>>>>>>>>              Forward Send Backout
39610>>>>>>>>>>>
39610>>>>>>>>>>>              Set pnB_Gmove_X2  to Gmove.Gmove_X2
39611>>>>>>>>>>>              Set pnB_Gmove_P2  to Gmove.Gmove_P2
39612>>>>>>>>>>>              Set pnB_Gmove_X0  to Gmove.Gmove_X0
39613>>>>>>>>>>>              Set pnB_Gmove_P0  to Gmove.Gmove_P0
39614>>>>>>>>>>>              Set pnB_Gmove_X00 to Gmove.Gmove_X00
39615>>>>>>>>>>>              Set pnB_Gmove_P00 to Gmove.Gmove_P00
39616>>>>>>>>>>>              Set pnB_Gmove_XR  to Gmove.Gmove_XR
39617>>>>>>>>>>>              Set pnB_Gmove_PR  to Gmove.Gmove_PR
39618>>>>>>>>>>>              Set pnB_Gmove_X1  to Gmove.Gmove_X1
39619>>>>>>>>>>>              Set pnB_Gmove_P1  to Gmove.Gmove_P1
39620>>>>>>>>>>>
39620>>>>>>>>>>>              //properties   procedural ¤£â¨à© ghmnies+gmhnes
39620>>>>>>>>>>>              //b) garticl related properties
39620>>>>>>>>>>>              Set piB_Gthhmgio_Period to Gmove.Gthhmgio_Period //Gthhmgio.Gthhmgio_Period
39621>>>>>>>>>>>              Set pdB_Garticl_Hmnia   to Gmove.Garticl_Hmnia
39622>>>>>>>>>>>              Set psB_Gplan_Recr      to Gmove.Gplan_Recr
39623>>>>>>>>>>>
39623>>>>>>>>>>>              Set piB_Garticl_Aa      to Gmove.Gmove_Aa //  «¦¤ â¢®¦ 
39624>>>>>>>>>>>
39624>>>>>>>>>>>
39624>>>>>>>>>>>              Set piBackout           to 1
39625>>>>>>>>>>>
39625>>>>>>>>>>>              Send private.Adjust_Balances (-1);                                            Gmove.Gplan_Code;                                            Gmove.Gplan_Myf_Sump;                                            Gmove.Gplan_Myf_Suma;                                            Gmove.Gplan_Yn_Myfp;                                            Gmove.Gplan_Yn_Myfa;                                            Gmove.Gtypkin_Flag07;                                            Gmove.Gtypkin_Flag09;                                            Gmove.Gtypkin_Flag11;                                            Gmove.Gtypkin_Flag13
39626>>>>>>>>>>>    End_Procedure   // backout
39627>>>>>>>>>>>
39627>>>>>>>>>>>
39627>>>>>>>>>>>    Procedure Update //sos é « properties a ©«á¨¦¤«  §¦ « parent buffers
39628>>>>>>>>>>>                     //¡  æ®  §¦ «¦ Gmove! ! ! ! ! !
39628>>>>>>>>>>>              Integer liFireConvert## //ja//sosososososo
39629>>>>>>>>>>>
39629>>>>>>>>>>>              Get piFireconvert to liFireConvert## //ja//sosososososo
39630>>>>>>>>>>>                                                   //¬«ã ¡¦¨å  ©«¤ update á¤
39630>>>>>>>>>>>                                                   // «¨â¥¦¬¤ ¦  ¨¦¬«å¤ª £««¨¦§ãª «à¤ ¤¦£ ©£á«à¤
39630>>>>>>>>>>>                                                   //©«á¨«  © 1 §¦ «¤ check_Arthro_For_Ypol
39630>>>>>>>>>>>                                                   // ¦§¦å ¡¢å«  §æ: a) Gmove.vw   function child_exiting
39630>>>>>>>>>>>                                                   //                      b) doAkArth.pkg (¡¬¨à« ¡æ á¨¨¦)
39630>>>>>>>>>>>
39630>>>>>>>>>>>              Forward Send Update
39632>>>>>>>>>>>
39632>>>>>>>>>>>              //¤£â¨à© £ related §åà¤
39632>>>>>>>>>>>              Move SysCurGL.Company_Code    to Gmove.Company_Code
39633>>>>>>>>>>>              Move SysCurGL.Branch_Code     to Gmove.Branch_Code
39634>>>>>>>>>>>              Move SysCurGL.Year_Year       to Gmove.Year_Year
39635>>>>>>>>>>>              Move SysCurGL.Year_Recr       to Gmove.Year_Recr
39636>>>>>>>>>>>              Move Gtypkin.Gtypkin_Code     to Gmove.Gtypkin_Code
39637>>>>>>>>>>>              Move Garticl.Garticl_Hmnia    to Gmove.Garticl_Hmnia
39638>>>>>>>>>>>              Move Garticl.Garticl_No       to Gmove.Garticl_No
39639>>>>>>>>>>>
39639>>>>>>>>>>>              //Move Garticl.Garticl_C_Code2  to Gmove.Gmove_C_Code2       //????????
39639>>>>>>>>>>>              Move Garticl.Garticl_AA       to Gmove.Gmove_AA
39640>>>>>>>>>>>              //Move Garticl.Garticl_StatusE  to Gmove.Gmove_StatusE
39640>>>>>>>>>>>              //Move Garticl.Garticl_StatusA  to Gmove.Gmove_StatusA
39640>>>>>>>>>>>
39640>>>>>>>>>>>              Move Gplan.Gplan_Code         to Gmove.Gplan_Code
39641>>>>>>>>>>>
39641>>>>>>>>>>>              Move Gthhmgio.Gthhmgio_Code   to Gmove.Gthhmgio_Code
39642>>>>>>>>>>>              Move Gthhmgio.Gthhmgio_Period to Gmove.Gthhmgio_Period
39643>>>>>>>>>>>
39643>>>>>>>>>>>              //¬©«¬®éª ,§å §¨å««   «¤ ¢¢ã «¦¬ garticl!
39643>>>>>>>>>>>              Move Gplan.Gplan_Code       to Gmove.Gplan_Code
39644>>>>>>>>>>>              Move Gplan.Gplan_Myf_Sump   to Gmove.Gplan_Myf_Sump
39645>>>>>>>>>>>              Move Gplan.Gplan_Myf_Suma   to Gmove.Gplan_Myf_Suma
39646>>>>>>>>>>>              Move Gplan.Gplan_Yn_Myfp    to Gmove.Gplan_Yn_Myfp
39647>>>>>>>>>>>              Move Gplan.Gplan_Yn_Myfa    to Gmove.Gplan_Yn_Myfa
39648>>>>>>>>>>>
39648>>>>>>>>>>>              Move Gtypkin.Gtypkin_Flag01 to Gmove.Gtypkin_Flag01
39649>>>>>>>>>>>              Move Gtypkin.Gtypkin_Flag02 to Gmove.Gtypkin_Flag02
39650>>>>>>>>>>>              Move Gtypkin.Gtypkin_Flag03 to Gmove.Gtypkin_Flag03
39651>>>>>>>>>>>              Move Gtypkin.Gtypkin_Flag04 to Gmove.Gtypkin_Flag04
39652>>>>>>>>>>>              Move Gtypkin.Gtypkin_Flag05 to Gmove.Gtypkin_Flag05
39653>>>>>>>>>>>              Move Gtypkin.Gtypkin_Flag06 to Gmove.Gtypkin_Flag06
39654>>>>>>>>>>>              Move Gtypkin.Gtypkin_Flag07 to Gmove.Gtypkin_Flag07
39655>>>>>>>>>>>              Move Gtypkin.Gtypkin_Flag08 to Gmove.Gtypkin_Flag08
39656>>>>>>>>>>>              Move Gtypkin.Gtypkin_Flag09 to Gmove.Gtypkin_Flag09
39657>>>>>>>>>>>              Move Gtypkin.Gtypkin_Flag10 to Gmove.Gtypkin_Flag10
39658>>>>>>>>>>>              Move Gtypkin.Gtypkin_Flag11 to Gmove.Gtypkin_Flag11
39659>>>>>>>>>>>              Move Gtypkin.Gtypkin_Flag12 to Gmove.Gtypkin_Flag12
39660>>>>>>>>>>>              Move Gtypkin.Gtypkin_Flag13 to Gmove.Gtypkin_Flag13
39661>>>>>>>>>>>              Move Gtypkin.Gtypkin_Flag14 to Gmove.Gtypkin_Flag14
39662>>>>>>>>>>>              Move Gtypkin.Gtypkin_Flag15 to Gmove.Gtypkin_Flag15
39663>>>>>>>>>>>              Move Gtypkin.Gtypkin_Flag16 to Gmove.Gtypkin_Flag16
39664>>>>>>>>>>>              Move Gtypkin.Gtypkin_Flag17 to Gmove.Gtypkin_Flag17
39665>>>>>>>>>>>              Move Gtypkin.Gtypkin_Flag18 to Gmove.Gtypkin_Flag18
39666>>>>>>>>>>>              Move Gtypkin.Gtypkin_Flag19 to Gmove.Gtypkin_Flag19
39667>>>>>>>>>>>              Move Gtypkin.Gtypkin_Flag20 to Gmove.Gtypkin_Flag20
39668>>>>>>>>>>>
39668>>>>>>>>>>>              //¤á¤à© properties
39668>>>>>>>>>>>
39668>>>>>>>>>>>              // ®å¨ © calculated §åà¤
39668>>>>>>>>>>>              //Gmove_x0  Gmove_p0
39668>>>>>>>>>>>              //Gmove_x00 Gmove_p00
39668>>>>>>>>>>>              //Gmove_xr  Gmove_pr
39668>>>>>>>>>>>              //Gmove_ys0  00 r ??
39668>>>>>>>>>>>              //Gmove_ys1  00 r ??
39668>>>>>>>>>>>              //Gmove_ys2  00 r ??
39668>>>>>>>>>>>              //Gmove_x1  Gmove_p1    (¬«á ¥¨«é¤«  §¦ «¦ garticl_aa)
39668>>>>>>>>>>>              //Gmove statuse + statusa ???
39668>>>>>>>>>>>              //Gmove sx0  sp0  yx0  yp0
39668>>>>>>>>>>>              //Gmove sx00 sp00 yx00 yp00
39668>>>>>>>>>>>              //Gmove sxr  spr  yxr  ypr
39668>>>>>>>>>>>              //Gmove sx2  sp2  yx2  yp2
39668>>>>>>>>>>>
39668>>>>>>>>>>>//              //£««¨¦§ª ¤¦£å©£«¦ª ¨­ãª (2) ©« ¢¦ §á 3 ¤¦£å©£«  (0 00 r)
39668>>>>>>>>>>>//              //¤á¢¦ £ « flags 3 ¡  4
39668>>>>>>>>>>>//              If (liFireConvert## = 0) ;
39668>>>>>>>>>>>//                 Begin
39668>>>>>>>>>>>//                  //*********************************************************
39668>>>>>>>>>>>//                  //£««¨¦§ã ¥ é¤ © ¡ç¨ ¦ ¤æ£ ©£ ®¨ã©ª  !   *
39668>>>>>>>>>>>//                  //*********************************************************
39668>>>>>>>>>>>//                  //®¨âà© 2-->0
39668>>>>>>>>>>>//                  Move (gnfConvert(Garticl.Garticl_C_Code2,;
39668>>>>>>>>>>>//                                   Year.Year_C_Code0,;
39668>>>>>>>>>>>//                                   Garticl.Garticl_Hmnia,;
39668>>>>>>>>>>>//                                   Gmove.Gmove_X2,;
39668>>>>>>>>>>>//                                   Garticl.Garticl_Rate0);
39668>>>>>>>>>>>//                                  ) to Gmove.Gmove_X0
39668>>>>>>>>>>>//                  //§å©«à© 2-->0
39668>>>>>>>>>>>//                  Move (gnfConvert(Garticl.Garticl_C_Code2,;
39668>>>>>>>>>>>//                                   Year.Year_C_Code0,;
39668>>>>>>>>>>>//                                   Garticl.Garticl_Hmnia,;
39668>>>>>>>>>>>//                                   Gmove.Gmove_P2,;
39668>>>>>>>>>>>//                                   Garticl.Garticl_Rate0);
39668>>>>>>>>>>>//                                  ) to Gmove.Gmove_P0
39668>>>>>>>>>>>
39668>>>>>>>>>>>//                  //*********************************************************
39668>>>>>>>>>>>//                  //flag 3:£««¨¦§ã ¥ é¤ © ¬«¨ç¦¤ ¤æ£ ©£ ®¨ã©ª     *
39668>>>>>>>>>>>//                  //*********************************************************
39668>>>>>>>>>>>//                  If (Gtypkin.Gtypkin_Flag03 = TRUE);
39668>>>>>>>>>>>//                       Begin
39668>>>>>>>>>>>//                        //®¨âà© 2-->00
39668>>>>>>>>>>>//                        Move (gnfConvert(Garticl.Garticl_C_Code2,;
39668>>>>>>>>>>>//                                         Year.Year_C_Code00,;
39668>>>>>>>>>>>//                                         Garticl.Garticl_Hmnia,;
39668>>>>>>>>>>>//                                         Gmove.Gmove_X2,;
39668>>>>>>>>>>>//                                         Garticl.Garticl_Rate00);
39668>>>>>>>>>>>//                                        ) to Gmove.Gmove_X00
39668>>>>>>>>>>>//                        //§å©«à© 2-->00
39668>>>>>>>>>>>//                        Move (gnfConvert(Garticl.Garticl_C_Code2,;
39668>>>>>>>>>>>//                                         Year.Year_C_Code00,;
39668>>>>>>>>>>>//                                         Garticl.Garticl_Hmnia,;
39668>>>>>>>>>>>//                                         Gmove.Gmove_P2,;
39668>>>>>>>>>>>//                                         Garticl.Garticl_Rate00);
39668>>>>>>>>>>>//                                        ) to Gmove.Gmove_P00
39668>>>>>>>>>>>//                       End
39668>>>>>>>>>>>//                  Else Begin
39668>>>>>>>>>>>//                        Move 0            to Gmove.Gmove_X00
39668>>>>>>>>>>>//                        Move 0            to Gmove.Gmove_P00
39668>>>>>>>>>>>//                       End
39668>>>>>>>>>>>
39668>>>>>>>>>>>//                  //*********************************************************
39668>>>>>>>>>>>//                  //flag 4:£««¨¦§ã ¥ é¤ © ¤æ£ ©£ reporting             *
39668>>>>>>>>>>>//                  //*********************************************************
39668>>>>>>>>>>>//                  If (Gtypkin.Gtypkin_Flag04 = TRUE);
39668>>>>>>>>>>>//                       Begin
39668>>>>>>>>>>>//                        //®¨âà© 2-->r
39668>>>>>>>>>>>//                        Move (gnfConvert(Garticl.Garticl_C_Code2,;
39668>>>>>>>>>>>//                                         Year.Year_C_CodeR,;
39668>>>>>>>>>>>//                                         Garticl.Garticl_Hmnia,;
39668>>>>>>>>>>>//                                         Gmove.Gmove_X2,;
39668>>>>>>>>>>>//                                         Garticl.Garticl_RateR);
39668>>>>>>>>>>>//                                        ) to Gmove.Gmove_XR
39668>>>>>>>>>>>//                        //§å©«à© 2-->r
39668>>>>>>>>>>>//                        Move (gnfConvert(Garticl.Garticl_C_Code2,;
39668>>>>>>>>>>>//                                         Year.Year_C_CodeR,;
39668>>>>>>>>>>>//                                         Garticl.Garticl_Hmnia,;
39668>>>>>>>>>>>//                                         Gmove.Gmove_P2,;
39668>>>>>>>>>>>//                                         Garticl.Garticl_RateR);
39668>>>>>>>>>>>//                                        ) to Gmove.Gmove_PR
39668>>>>>>>>>>>//                       End
39668>>>>>>>>>>>//                  Else Begin
39668>>>>>>>>>>>//                        Move 0            to Gmove.Gmove_XR
39668>>>>>>>>>>>//                        Move 0            to Gmove.Gmove_PR
39668>>>>>>>>>>>//                       End
39668>>>>>>>>>>>
39668>>>>>>>>>>>//                 End//«â¢¦ª £««¨¦§é¤ ¤¦£å©£«¦ª ¨­ãª ©« ¢¦ §á 3 ¤¦£å©£«
39668>>>>>>>>>>>
39668>>>>>>>>>>>              //á¤ «¦ á¨¨¦ å¤  ¦¨ ©« ¡¦§¦ £â¤¦,
39668>>>>>>>>>>>              // £«­¦¨á «à¤ ®¨à§ ©«é©à¤ 0 --> 1
39668>>>>>>>>>>>              //¢¢¦ éª, £¤ ©£æª «à¤ ®¨à§ ©«é©à¤ 1
39668>>>>>>>>>>>              If (Garticl.Garticl_Aa > 0);              Begin
39670>>>>>>>>>>>               Move Gmove.Gmove_X0 to Gmove.Gmove_X1
39671>>>>>>>>>>>               Move Gmove.Gmove_P0 to Gmove.Gmove_P1
39672>>>>>>>>>>>              End
39672>>>>>>>>>>>>
39672>>>>>>>>>>>              Else;              Begin
39673>>>>>>>>>>>               Move 0                to Gmove.Gmove_X1
39674>>>>>>>>>>>               Move 0                to Gmove.Gmove_P1
39675>>>>>>>>>>>              End
39675>>>>>>>>>>>>
39675>>>>>>>>>>>
39675>>>>>>>>>>>
39675>>>>>>>>>>>              //¤£â¨à© §åà¤ open items
39675>>>>>>>>>>>              Send private.Do_Compute_Open_Items
39676>>>>>>>>>>>
39676>>>>>>>>>>>
39676>>>>>>>>>>>              //¤£â¨à© ¨¦ ©«é¤
39676>>>>>>>>>>>              Send private.Adjust_Balances  1;                                            Gplan.Gplan_Code;                                            Gplan.Gplan_Myf_Sump;                                            Gplan.Gplan_Myf_Suma;                                            Gplan.Gplan_Yn_Myfp;                                            Gplan.Gplan_Yn_Myfa;                                            Gtypkin.Gtypkin_Flag07;                                            Gtypkin.Gtypkin_Flag09;                                            Gtypkin.Gtypkin_Flag11;                                            Gtypkin.Gtypkin_Flag13
39677>>>>>>>>>>>
39677>>>>>>>>>>>              //¤£â¨à© properties after
39677>>>>>>>>>>>              //a) Gmove related properties
39677>>>>>>>>>>>              Set pnA_Gmove_X2  to Gmove.Gmove_X2
39678>>>>>>>>>>>              Set pnA_Gmove_P2  to Gmove.Gmove_P2
39679>>>>>>>>>>>              Set pnA_Gmove_X0  to Gmove.Gmove_X0
39680>>>>>>>>>>>              Set pnA_Gmove_P0  to Gmove.Gmove_P0
39681>>>>>>>>>>>              Set pnA_Gmove_X00 to Gmove.Gmove_X00
39682>>>>>>>>>>>              Set pnA_Gmove_P00 to Gmove.Gmove_P00
39683>>>>>>>>>>>              Set pnA_Gmove_XR  to Gmove.Gmove_XR
39684>>>>>>>>>>>              Set pnA_Gmove_PR  to Gmove.Gmove_PR
39685>>>>>>>>>>>              Set pnA_Gmove_X1  to Gmove.Gmove_X1
39686>>>>>>>>>>>              Set pnA_Gmove_P1  to Gmove.Gmove_P1
39687>>>>>>>>>>>
39687>>>>>>>>>>>              //b) garticl related properties
39687>>>>>>>>>>>              //c) properties   procedural ¤£â¨à© ghmnies+gmhnes
39687>>>>>>>>>>>              Set piA_Gthhmgio_Period to Gthhmgio.Gthhmgio_Period
39688>>>>>>>>>>>              Set pdA_Garticl_Hmnia   to Garticl.Garticl_Hmnia
39689>>>>>>>>>>>              Set psA_Gplan_Recr      to Gplan.Gplan_Recr
39690>>>>>>>>>>>
39690>>>>>>>>>>>              Set piA_Garticl_Aa      to Gmove.Gmove_Aa //  «¦¤ â¢®¦ 
39691>>>>>>>>>>>
39691>>>>>>>>>>>              Set piUpdate       to 1
39692>>>>>>>>>>>    End_Procedure   //update
39693>>>>>>>>>>>
39693>>>>>>>>>>>    Procedure Creating
39694>>>>>>>>>>>        Forward Send Creating
39696>>>>>>>>>>>        // Insert Code Here
39696>>>>>>>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gmove.Gmove_Rec0)))))) to Gmove.Gmove_Recr
39697>>>>>>>>>>>    End_Procedure   // Creating
39698>>>>>>>>>>>
39698>>>>>>>>>>>
39698>>>>>>>>>>>    //¡¢å«  §æ update & backout
39698>>>>>>>>>>>    //â¢  §¨¦©¦®ã,  æ«  ©«¤ £â¤ backout ®¨ á«  « 9 arguments §¦ «¦ Gmove buffer,
39698>>>>>>>>>>>    //¤é ©«¤ update « ®¨ á«  §¦ « parent buffers ! ! !
39698>>>>>>>>>>>    Procedure private.Adjust_Balances Integer liSign;                                      String  lsGplan_Code;                                      Integer liGplan_Myf_Sump;                                      Integer liGplan_Myf_Suma;                                      Integer liGplan_Yn_Myfp;                                      Integer liGplan_Yn_Myfa;                                      Integer liGtypkin_Flag07;                                      Integer liGtypkin_Flag09;                                      Integer liGtypkin_Flag11;                                      Integer liGtypkin_Flag13
39699>>>>>>>>>>>
39699>>>>>>>>>>>              If (;                   ((Abs(liSign)) <> 1 );                 ) Begin
39701>>>>>>>>>>>                    Error 1002 "¡«á¢¢¢¦ §¨æ©£¦, ¢á¦ª ¡é ¡" // ¡¦§ã «¦¬ transaction!
39702>>>>>>>>>>>>
39702>>>>>>>>>>>                    Procedure_Return
39703>>>>>>>>>>>                   End
39703>>>>>>>>>>>>
39703>>>>>>>>>>>
39703>>>>>>>>>>>                   If (Gmove.Gmove_X2 > 0)                      Add liSign to Garticl.Garticl_XreLine
39706>>>>>>>>>>>              Else If (Gmove.Gmove_X2 < 0)                      Add liSign to Garticl.Garticl_PisLine
39710>>>>>>>>>>>                   If (Gmove.Gmove_P2 > 0)                      Add liSign to Garticl.Garticl_PisLine
39713>>>>>>>>>>>              Else If (Gmove.Gmove_P2 < 0)                      Add liSign to Garticl.Garticl_XreLine
39717>>>>>>>>>>>                   If ((fnFindOmada(Self,lsGplan_Code)) = 1)      Add liSign to Garticl.Garticl_Omada
39720>>>>>>>>>>>              Else                                                Add liSign to Garticl.Garticl_Other
39722>>>>>>>>>>>                                                                  Add liSign to Garticl.Garticl_Mlines //¬«æ ¨¦å  ©«¦ year_numgtypkin
39723>>>>>>>>>>>               //¤æ£ ©£ ¨­ãª
39723>>>>>>>>>>>              Add ((Gmove.Gmove_X2                   ) * liSign)           to Garticl.Garticl_Sx2
39724>>>>>>>>>>>              Add ((Gmove.Gmove_P2                   ) * liSign)           to Garticl.Garticl_Sp2
39725>>>>>>>>>>>              Add ((Gmove.Gmove_X2-Gmove.Gmove_P2  ) * liSign)           to Garticl.Garticl_Syp2
39726>>>>>>>>>>>
39726>>>>>>>>>>>              //¡ç¨ ¦ ¤æ£ ©£ ®¨ã©ª
39726>>>>>>>>>>>              Add ((Gmove.Gmove_X0                   ) * liSign)           to Garticl.Garticl_Sx0
39727>>>>>>>>>>>              Add ((Gmove.Gmove_P0                   ) * liSign)           to Garticl.Garticl_Sp0
39728>>>>>>>>>>>              Add ((Gmove.Gmove_X0-Gmove.Gmove_P0  ) * liSign)           to Garticl.Garticl_Syp0
39729>>>>>>>>>>>              Move (Abs(Garticl.Garticl_Syp0))                               to Garticl.Garticl_Syp0k
39730>>>>>>>>>>>
39730>>>>>>>>>>>              //¬«¨ç¦¤ ¤æ£ ©£ ®¨ã©ª
39730>>>>>>>>>>>              Add ((Gmove.Gmove_X00                  ) * liSign)           to Garticl.Garticl_Sx00
39731>>>>>>>>>>>              Add ((Gmove.Gmove_P00                  ) * liSign)           to Garticl.Garticl_Sp00
39732>>>>>>>>>>>              Add ((Gmove.Gmove_X00-Gmove.Gmove_P00) * liSign)           to Garticl.Garticl_Syp00
39733>>>>>>>>>>>              Move (Abs(Garticl.Garticl_Syp00))                              to Garticl.Garticl_Syp00k
39734>>>>>>>>>>>
39734>>>>>>>>>>>              //¤æ£ ©£ reporting
39734>>>>>>>>>>>              Add ((Gmove.Gmove_XR                   ) * liSign)           to Garticl.Garticl_SxR
39735>>>>>>>>>>>              Add ((Gmove.Gmove_PR                   ) * liSign)           to Garticl.Garticl_SpR
39736>>>>>>>>>>>              Add ((Gmove.Gmove_XR-Gmove.Gmove_PR  ) * liSign)           to Garticl.Garticl_SypR
39737>>>>>>>>>>>              Move (Abs(Garticl.Garticl_SypR))                               to Garticl.Garticl_SypRk
39738>>>>>>>>>>>
39738>>>>>>>>>>>              //¦¨ ©« ¡¦§¦ £â¤¦ ¡ç¨ ¦ ¤æ£ ©£ ®¨ã©ª
39738>>>>>>>>>>>              Add ((Gmove.Gmove_X1                   ) * liSign)           to Garticl.Garticl_Sx1
39739>>>>>>>>>>>              Add ((Gmove.Gmove_P1                   ) * liSign)           to Garticl.Garticl_Sp1
39740>>>>>>>>>>>
39740>>>>>>>>>>>
39740>>>>>>>>>>>              //*********************************************************
39740>>>>>>>>>>>              //flag 7:¬¥á¤   §à¢ã©à¤ (+¥å)                     *
39740>>>>>>>>>>>              //*********************************************************
39740>>>>>>>>>>>              If (liGtypkin_Flag07 = TRUE);              Begin
39742>>>>>>>>>>>                   Case Begin
39742>>>>>>>>>>>                        Case (liGplan_Myf_Sump = 1) //£æ¤¦¤ ¦  ®¨à©« ¡âª ¡ ¤ã© ª ¨¦å¦¬¤ ©«¤ 
39744>>>>>>>>>>>                              Add ((Abs(Gmove.Gmove_X0)) * liSign) to Garticl.Garticl_MyfValp
39745>>>>>>>>>>>                        Case Break
39746>>>>>>>>>>>                        Case (liGplan_Myf_Sump = 2) //£æ¤¦¤ ¦  § ©«à« ¡âª ¡ ¤ã© ª ¨¦å¦¬¤ ©«¤ 
39749>>>>>>>>>>>                              Add ((Abs(Gmove.Gmove_P0)) * liSign) to Garticl.Garticl_MyfValp
39750>>>>>>>>>>>                        Case Break
39751>>>>>>>>>>>                        Case (liGplan_Myf_Sump = 3) //æ¢ª ¦  ¡ ¤ã© ª (®¨à©« ¡âª & § ©«à« ¡âª) ¨¦å¦¬¤ ©«¤ 
39754>>>>>>>>>>>                              Add ((Abs(Gmove.Gmove_X0)) * liSign) to Garticl.Garticl_MyfValp
39755>>>>>>>>>>>                              Add ((Abs(Gmove.Gmove_P0)) * liSign) to Garticl.Garticl_MyfValp
39756>>>>>>>>>>>                        Case Break
39757>>>>>>>>>>>                   Case End
39757>>>>>>>>>>>
39757>>>>>>>>>>>                   If (liGplan_Yn_Myfp = TRUE);                       Begin
39759>>>>>>>>>>>                        Add liSign to Garticl.Garticl_MyfChkp
39760>>>>>>>>>>>                        If (liSign = 1);                             Begin //sosososso *************!!!!!!!!!!!!!!!!!!!!!!!!!!!
39762>>>>>>>>>>>                              If (Garticl.Garticl_MyfCodp = "") Move Gplan.Gplan_Code to Garticl.Garticl_MyfCodp
39765>>>>>>>>>>>                              If (Garticl.Garticl_MyfChkp = 1 ) Set psGarticl_MyfCodp to Garticl.Garticl_MyfCodp //£æ¤¦¤   display of error 1006
39768>>>>>>>>>>>                             End
39768>>>>>>>>>>>>
39768>>>>>>>>>>>                        Else Begin
39769>>>>>>>>>>>                              Move "" to Garticl.Garticl_MyfCodp
39770>>>>>>>>>>>                              If (Garticl.Garticl_MyfChkp = 0) Set psGarticl_MyfCodp  to ""                      //£æ¤¦¤   display of error 1006
39773>>>>>>>>>>>                             End
39773>>>>>>>>>>>>
39773>>>>>>>>>>>                       End
39773>>>>>>>>>>>>
39773>>>>>>>>>>>              End //«â¢¦ª ¡é ¡   flag07
39773>>>>>>>>>>>>
39773>>>>>>>>>>>
39773>>>>>>>>>>>
39773>>>>>>>>>>>              //*********************************************************
39773>>>>>>>>>>>              //flag 9:£ é¤   §à¢ã©à¤ (-¥å)                     *
39773>>>>>>>>>>>              //*********************************************************
39773>>>>>>>>>>>              If (liGtypkin_Flag09 = TRUE);              Begin
39775>>>>>>>>>>>                   Case Begin
39775>>>>>>>>>>>                        Case (liGplan_Myf_Sump = 1) //£æ¤¦¤ ¦  ®¨à©« ¡âª ¡ ¤ã© ª ¨¦å¦¬¤ ©«¤ 
39777>>>>>>>>>>>                              Sub ((Abs(Gmove.Gmove_X0)) * liSign) to Garticl.Garticl_MyfValp
39778>>>>>>>>>>>                        Case Break
39779>>>>>>>>>>>                        Case (liGplan_Myf_Sump = 2) //£æ¤¦¤ ¦  § ©«à« ¡âª ¡ ¤ã© ª ¨¦å¦¬¤ ©«¤ 
39782>>>>>>>>>>>                              Sub ((Abs(Gmove.Gmove_P0)) * liSign) to Garticl.Garticl_MyfValp
39783>>>>>>>>>>>                        Case Break
39784>>>>>>>>>>>                        Case (liGplan_Myf_Sump = 3) //æ¢ª ¦  ¡ ¤ã© ª (®¨à©« ¡âª & § ©«à« ¡âª) ¨¦å¦¬¤ ©«¤ 
39787>>>>>>>>>>>                              Sub ((Abs(Gmove.Gmove_X0)) * liSign) to Garticl.Garticl_MyfValp
39788>>>>>>>>>>>                              Sub ((Abs(Gmove.Gmove_P0)) * liSign) to Garticl.Garticl_MyfValp
39789>>>>>>>>>>>                        Case Break
39790>>>>>>>>>>>                   Case End
39790>>>>>>>>>>>
39790>>>>>>>>>>>                   If (liGplan_Yn_Myfp = TRUE);                       Begin
39792>>>>>>>>>>>                        Add liSign to Garticl.Garticl_MyfChkp
39793>>>>>>>>>>>                        If (liSign = 1);                             Begin //sosososso *************!!!!!!!!!!!!!!!!!!!!!!!!!!!
39795>>>>>>>>>>>                              If (Garticl.Garticl_MyfCodp = "") Move Gplan.Gplan_Code to Garticl.Garticl_MyfCodp
39798>>>>>>>>>>>                              If (Garticl.Garticl_MyfChkp = 1 ) Set psGarticl_MyfCodp to Garticl.Garticl_MyfCodp //£æ¤¦¤   display of error 1006
39801>>>>>>>>>>>                             End
39801>>>>>>>>>>>>
39801>>>>>>>>>>>                        Else Begin
39802>>>>>>>>>>>                              Move "" to Garticl.Garticl_MyfCodp
39803>>>>>>>>>>>                              If (Garticl.Garticl_MyfChkp = 0) Set psGarticl_MyfCodp  to ""                      //£æ¤¦¤   display of error 1006
39806>>>>>>>>>>>                             End
39806>>>>>>>>>>>>
39806>>>>>>>>>>>                       End
39806>>>>>>>>>>>>
39806>>>>>>>>>>>                   End //«â¢¦ª ¡é ¡   flag09
39806>>>>>>>>>>>>
39806>>>>>>>>>>>
39806>>>>>>>>>>>              //*********************************************************
39806>>>>>>>>>>>              //flag 11:¬¥á¤   ¦¨é¤ (+¥å)                      *
39806>>>>>>>>>>>              //*********************************************************
39806>>>>>>>>>>>              If (liGtypkin_Flag11 = TRUE);              Begin
39808>>>>>>>>>>>                   Case Begin
39808>>>>>>>>>>>                        Case (liGplan_Myf_Suma = 1) //£æ¤¦¤ ¦  ®¨à©« ¡âª ¡ ¤ã© ª ¨¦å¦¬¤ ©«¤ 
39810>>>>>>>>>>>                              Add ((Abs(Gmove.Gmove_X0)) * liSign) to Garticl.Garticl_MyfVala
39811>>>>>>>>>>>                        Case Break
39812>>>>>>>>>>>                        Case (liGplan_Myf_Suma = 2) //£æ¤¦¤ ¦  § ©«à« ¡âª ¡ ¤ã© ª ¨¦å¦¬¤ ©«¤ 
39815>>>>>>>>>>>                              Add ((Abs(Gmove.Gmove_P0)) * liSign) to Garticl.Garticl_MyfVala
39816>>>>>>>>>>>                        Case Break
39817>>>>>>>>>>>                        Case (liGplan_Myf_Suma = 3) //æ¢ª ¦  ¡ ¤ã© ª (®¨à©« ¡âª & § ©«à« ¡âª) ¨¦å¦¬¤ ©«¤ 
39820>>>>>>>>>>>                              Add ((Abs(Gmove.Gmove_X0)) * liSign) to Garticl.Garticl_MyfVala
39821>>>>>>>>>>>                              Add ((Abs(Gmove.Gmove_P0)) * liSign) to Garticl.Garticl_MyfVala
39822>>>>>>>>>>>                        Case Break
39823>>>>>>>>>>>                   Case End
39823>>>>>>>>>>>
39823>>>>>>>>>>>                   If (liGplan_Yn_Myfa = TRUE);                       Begin
39825>>>>>>>>>>>                        Add liSign to Garticl.Garticl_MyfChka
39826>>>>>>>>>>>                        If (liSign = 1);                             Begin //sosososso *************!!!!!!!!!!!!!!!!!!!!!!!!!!!
39828>>>>>>>>>>>                              If (Garticl.Garticl_MyfCoda = "") Move Gplan.Gplan_Code to Garticl.Garticl_MyfCoda
39831>>>>>>>>>>>                              If (Garticl.Garticl_MyfChka = 1 ) Set psGarticl_MyfCoda to Garticl.Garticl_MyfCoda //£æ¤¦¤   display of error 1006
39834>>>>>>>>>>>                             End
39834>>>>>>>>>>>>
39834>>>>>>>>>>>                        Else Begin
39835>>>>>>>>>>>                              Move "" to Garticl.Garticl_MyfCoda
39836>>>>>>>>>>>                              If (Garticl.Garticl_MyfChka = 0) Set psGarticl_MyfCoda  to ""                      //£æ¤¦¤   display of error 1006
39839>>>>>>>>>>>                             End
39839>>>>>>>>>>>>
39839>>>>>>>>>>>                       End
39839>>>>>>>>>>>>
39839>>>>>>>>>>>              End //«â¢¦ª ¡é ¡   flag11
39839>>>>>>>>>>>>
39839>>>>>>>>>>>
39839>>>>>>>>>>>              //*********************************************************
39839>>>>>>>>>>>              //flag 13:£ é¤   ¦¨é¤ (-¥å)                      *
39839>>>>>>>>>>>              //*********************************************************
39839>>>>>>>>>>>              If (liGtypkin_Flag13 = TRUE);              Begin
39841>>>>>>>>>>>                   Case Begin
39841>>>>>>>>>>>                        Case (liGplan_Myf_Suma = 1) //£æ¤¦¤ ¦  ®¨à©« ¡âª ¡ ¤ã© ª ¨¦å¦¬¤ ©«¤ 
39843>>>>>>>>>>>                              Sub ((Abs(Gmove.Gmove_X0)) * liSign) to Garticl.Garticl_MyfVala
39844>>>>>>>>>>>                        Case Break
39845>>>>>>>>>>>                        Case (liGplan_Myf_Suma = 2) //£æ¤¦¤ ¦  § ©«à« ¡âª ¡ ¤ã© ª ¨¦å¦¬¤ ©«¤ 
39848>>>>>>>>>>>                              Sub ((Abs(Gmove.Gmove_P0)) * liSign) to Garticl.Garticl_MyfVala
39849>>>>>>>>>>>                        Case Break
39850>>>>>>>>>>>                        Case (liGplan_Myf_Suma = 3) //æ¢ª ¦  ¡ ¤ã© ª (®¨à©« ¡âª & § ©«à« ¡âª) ¨¦å¦¬¤ ©«¤ 
39853>>>>>>>>>>>                              Sub ((Abs(Gmove.Gmove_X0)) * liSign) to Garticl.Garticl_MyfVala
39854>>>>>>>>>>>                              Sub ((Abs(Gmove.Gmove_P0)) * liSign) to Garticl.Garticl_MyfVala
39855>>>>>>>>>>>                        Case Break
39856>>>>>>>>>>>                   Case End
39856>>>>>>>>>>>
39856>>>>>>>>>>>                   If (liGplan_Yn_Myfa = TRUE);                       Begin
39858>>>>>>>>>>>                        Add liSign to Garticl.Garticl_MyfChka
39859>>>>>>>>>>>                        If (liSign = 1);                             Begin //sosososso *************!!!!!!!!!!!!!!!!!!!!!!!!!!!
39861>>>>>>>>>>>                              If (Garticl.Garticl_MyfCoda = "") Move Gplan.Gplan_Code to Garticl.Garticl_MyfCoda
39864>>>>>>>>>>>                              If (Garticl.Garticl_MyfChka = 1 ) Set psGarticl_MyfCoda to Garticl.Garticl_MyfCoda //£æ¤¦¤   display of error 1006
39867>>>>>>>>>>>                             End
39867>>>>>>>>>>>>
39867>>>>>>>>>>>                        Else Begin
39868>>>>>>>>>>>                              Move "" to Garticl.Garticl_MyfCoda
39869>>>>>>>>>>>                              If (Garticl.Garticl_MyfChka = 0) Set psGarticl_MyfCoda  to ""                      //£æ¤¦¤   display of error 1006
39872>>>>>>>>>>>                             End
39872>>>>>>>>>>>>
39872>>>>>>>>>>>                       End
39872>>>>>>>>>>>>
39872>>>>>>>>>>>                   End //«â¢¦ª ¡é ¡   flag13
39872>>>>>>>>>>>>
39872>>>>>>>>>>>
39872>>>>>>>>>>>
39872>>>>>>>>>>>    End_Procedure //private.adjust_balances
39873>>>>>>>>>>>
39873>>>>>>>>>>>
39873>>>>>>>>>>>    Procedure Save_Main_File
39874>>>>>>>>>>>              Integer liTrexe_Result
39875>>>>>>>>>>>              Forward Send Save_Main_File
39877>>>>>>>>>>>              Get private.Trexe to liTrexe_Result //procedural  ®å¨ © gmhnnes+ghmnies
39878>>>>>>>>>>>              Send private.Initialize_Properties
39879>>>>>>>>>>>              If (liTrexe_Result <> 0) Send Operation_Not_Allowed liTrexe_Result
39882>>>>>>>>>>>    End_Procedure//save_main_file
39883>>>>>>>>>>>
39883>>>>>>>>>>>
39883>>>>>>>>>>>    Procedure Delete_Main_File
39884>>>>>>>>>>>              Integer liTrexe_Result
39885>>>>>>>>>>>              Forward Send Delete_Main_File
39887>>>>>>>>>>>              Get private.Trexe to liTrexe_Result//procedural  ®å¨ © gmhnnes+ghmnies
39888>>>>>>>>>>>              Send private.Initialize_Properties
39889>>>>>>>>>>>              If (liTrexe_Result <> 0) Send Operation_Not_Allowed liTrexe_Result
39892>>>>>>>>>>>    End_Procedure//delete_main_file
39893>>>>>>>>>>>
39893>>>>>>>>>>>
39893>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
39894>>>>>>>>>>>              String lsError_Message lsGarticl_MyfCodp lsGarticl_MyfCoda lsGplan_Code lsGplan_Ypol
39895>>>>>>>>>>>              Case Begin
39895>>>>>>>>>>>                   //§æ validate save
39895>>>>>>>>>>>                   Case (iError_Num = 1001)
39897>>>>>>>>>>>                        Move ("DDC 157:¡«á¢¢¢ ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        "æ¤¦  ¨âà© ã £æ¤¦  å©«à© § «¨â§«  ¤ â®¦¬¤ £ã £¤ ¡ã « £ã!");                        to lsError_Message
39898>>>>>>>>>>>                   Case Break
39899>>>>>>>>>>>                   Case (iError_Num = 1002)
39902>>>>>>>>>>>                        Move ("DDC 157:¡«á¢¢¢ ¨­ã (¬«¨â¦¤ æ£ ©£ ¨ã©àª).\n\n"+;                        "æ¤¦  ¨âà© ã £æ¤¦  å©«à© § «¨â§«  ¤ â®¦¬¤ £ã £¤ ¡ã « £ã!");                        to lsError_Message
39903>>>>>>>>>>>                   Case Break
39904>>>>>>>>>>>                   Case (iError_Num = 1003)
39907>>>>>>>>>>>                        Move ("DDC 157:¡«á¢¢¢ ¨­ã (æ£ ©£ Reporting).\n\n"+;                        "æ¤¦  ¨âà© ã £æ¤¦  å©«à© § «¨â§«  ¤ â®¦¬¤ £ã £¤ ¡ã « £ã!");                        to lsError_Message
39908>>>>>>>>>>>                   Case Break
39909>>>>>>>>>>>                   Case (iError_Num = 1004)
39912>>>>>>>>>>>                        Move ("DDC 157:¡«á¢¢¢ ¨­ã (æ£ ©£  ¤ã©àª).\n\n"+;                        "æ¤¦  ¨âà© ã £æ¤¦  å©«à© § «¨â§«  ¤ â®¦¬¤ £ã £¤ ¡ã « £ã!");                        to lsError_Message
39913>>>>>>>>>>>                   Case Break
39914>>>>>>>>>>>                   Case (iError_Num = 1005)
39917>>>>>>>>>>>                        Move ("DDC 157:ç¤«  ¨­ã!\n\n¦ á¨¨¦ â®  ¦¨ ©« ¡¦§¦ å (/= "+;                        (String(Garticl.Garticl_AA))+" )") to lsError_Message
39918>>>>>>>>>>>                   Case Break
39919>>>>>>>>>>>                   Case (iError_Num = 1006)
39922>>>>>>>>>>>                        Get psGarticl_MyfCodp to lsGarticl_MyfCodp
39923>>>>>>>>>>>                        Move ("DDC 157:ç¤«  ¨­ã!\n\n¦ á¨¨¦ §¨ â®  ã 1 ¢¦¨ ©£æ  à¢ã©à¤! ("+;                        (Trim(lsGarticl_MyfCodp))+")") to lsError_Message
39924>>>>>>>>>>>                   Case Break
39925>>>>>>>>>>>                   Case (iError_Num = 1007)
39928>>>>>>>>>>>                        Get psGarticl_MyfCoda to lsGarticl_MyfCoda
39929>>>>>>>>>>>                        Move ("DDC 157:ç¤«  ¨­ã!\n\n¦ á¨¨¦ §¨ â®  ã 1 ¢¦¨ ©£æ  ¦¨é¤! ("+;                        (Trim(lsGarticl_MyfCoda))+")") to lsError_Message
39930>>>>>>>>>>>                   Case Break
39931>>>>>>>>>>>
39931>>>>>>>>>>>                   Case (iError_Num = 1009)
39934>>>>>>>>>>>                        Clear Codemast
39935>>>>>>>>>>>                        Move "MODULE" to Codemast.Type
39936>>>>>>>>>>>                        Move Garticl.Garticl_M_Code to Codemast.Code
39937>>>>>>>>>>>                        Find Eq Codemast by Index.1 //type+code
39938>>>>>>>>>>>>
39938>>>>>>>>>>>                        Move ("DDC 157:ç¤«  ¨­ã\n\n( ¨­ã «¨¦§¦§¦ å«  £æ¤¦¤ §æ "+;                        (Trim(Codemast.Description))+" )") to lsError_Message
39939>>>>>>>>>>>                   Case Break
39940>>>>>>>>>>>                   Case (iError_Num = 1100)
39943>>>>>>>>>>>                        Move "DDC 157: §¦¡«ã « ¨å-¨ã©" to lsError_Message
39944>>>>>>>>>>>                        Case Break
39945>>>>>>>>>>>
39945>>>>>>>>>>>                   //---------------------------------gplan related errors á£© §¦ Gmove
39945>>>>>>>>>>>                   Case (iError_Num = 1013)
39948>>>>>>>>>>>                        Move ("DDC 157:ç¤«  ¨­ã\n\n( "+(Trim(Gplan.Gplan_Code))+" â¤ å¤  «¢¬«å¦¬ £¦ç !)");                        to lsError_Message
39949>>>>>>>>>>>                   Case Break
39950>>>>>>>>>>>                   Case (iError_Num = 1014)
39953>>>>>>>>>>>                        Clear Codemast
39954>>>>>>>>>>>                        Move "MODULE" to Codemast.Type
39955>>>>>>>>>>>                        Move gs_Module_Code to Codemast.Code
39956>>>>>>>>>>>                        Find Eq Codemast by Index.1 //type+code
39957>>>>>>>>>>>>
39957>>>>>>>>>>>                        Move ("DDC 157:ç¤«  ¨­ã\n\n( "+(Trim(Gplan.Gplan_Code))+" â¤ ¡ ¤å«  §æ "+;                        (Trim(Codemast.Description))+" )") to lsError_Message
39958>>>>>>>>>>>                   Case Break
39959>>>>>>>>>>>                   Case (iError_Num = 1015)
39962>>>>>>>>>>>                        Move ("DDC 157:ç¤«  ¨­ã\n\n( "+(Trim(Gplan.Gplan_Code))+" â®«  £æ¤¦¤ ®¨é© ª !)");                        to lsError_Message
39963>>>>>>>>>>>                   Case Break
39964>>>>>>>>>>>                   Case (iError_Num = 1016)
39967>>>>>>>>>>>                        Move ("DDC 157:ç¤«  ¨­ã\n\n( "+(Trim(Gplan.Gplan_Code))+" â®«  £æ¤¦¤ § ©«é© ª !)");                        to lsError_Message
39968>>>>>>>>>>>                   Case Break
39969>>>>>>>>>>>                   Case (iError_Num = 1019)
39972>>>>>>>>>>>                        Clear Nomisma
39973>>>>>>>>>>>                        Move Gplan.Gplan_C_Code2 to Nomisma.Nomisma_Code
39974>>>>>>>>>>>                        Find Eq Nomisma by Index.1
39975>>>>>>>>>>>>
39975>>>>>>>>>>>                        If (Not(Found)) Move ("DDC 157:ç¤«  ¨­ã!\n\n( "+(Trim(Gplan.Gplan_Code))+" ¡ ¤å«  £æ¤¦¤ © "+;                            (Trim(Nomisma.Nomisma_Descr))+" )") to lsError_Message
39978>>>>>>>>>>>                   Case Break
39979>>>>>>>>>>>
39979>>>>>>>>>>>
39979>>>>>>>>>>>                   //§æ validate delete
39979>>>>>>>>>>>                   Case (iError_Num = 2001)
39982>>>>>>>>>>>                        Move ("DDC 157:ç¤«   ¨­ã!\n\n¦ á¨¨¦ â®  ¦¨ ©« ¡¦§¦ å (/= "+;                        (String(Garticl.Garticl_AA))+" )") to lsError_Message
39983>>>>>>>>>>>                   Case Break
39984>>>>>>>>>>>                   Case (iError_Num = 2002)
39987>>>>>>>>>>>                        Clear Codemast
39988>>>>>>>>>>>                        Move "MODULE" to Codemast.Type
39989>>>>>>>>>>>                        Move Garticl.Garticl_M_Code to Codemast.Code
39990>>>>>>>>>>>                        Find Eq Codemast by Index.1 //type+code
39991>>>>>>>>>>>>
39991>>>>>>>>>>>                        Move ("DDC 157:ç¤«   ¨­ã!\n\n( ¨­ã  ¨á­«  £æ¤¦¤ §æ "+;                        (Trim(Codemast.Description))+" )") to lsError_Message
39992>>>>>>>>>>>                   Case Break
39993>>>>>>>>>>>                   Case (iError_Num = 2100)
39996>>>>>>>>>>>                        Move "DDC 157: §¦¡«ã « ¨å-¨ã©" to lsError_Message
39997>>>>>>>>>>>                        Case Break
39998>>>>>>>>>>>
39998>>>>>>>>>>>
39998>>>>>>>>>>>                   //§æ private.trexe (save+delete main file)
39998>>>>>>>>>>>                   //---------------------------------gplan related errors â£© §¦ ¤£â¨à©  ©¦¬åà¤
39998>>>>>>>>>>>                   Case (iError_Num = 1017)
40001>>>>>>>>>>>                        Get psGplan_Code  to lsGplan_Code
40002>>>>>>>>>>>                        Get pnGplan_Ypol0 to lsGplan_Ypol
40003>>>>>>>>>>>                        Set psGplan_Code  to "" //£¤ ©£æª property   §æ£¤ ®¨ã©
40004>>>>>>>>>>>                        Set pnGplan_Ypol0 to 0  //£¤ ©£æª property   §æ£¤ ®¨ã©
40005>>>>>>>>>>>                        Move ("DDC 157:ç¤«  ¨­ã\n\n "+(Trim(lsGplan_Code))+" â¤ â®«  ®¨à©« ¡æ ¬§æ¢¦ §¦ ! (="+;                        lsGplan_Ypol+")") to lsError_Message
40006>>>>>>>>>>>                   Case Break
40007>>>>>>>>>>>                   Case (iError_Num = 1018)
40010>>>>>>>>>>>                        Get psGplan_Code  to lsGplan_Code
40011>>>>>>>>>>>                        Get pnGplan_Ypol0 to lsGplan_Ypol
40012>>>>>>>>>>>                        Set psGplan_Code  to "" //£¤ ©£æª property   §æ£¤ ®¨ã©
40013>>>>>>>>>>>                        Set pnGplan_Ypol0 to 0  //£¤ ©£æª property   §æ£¤ ®¨ã©
40014>>>>>>>>>>>                        Move ("DDC 157:ç¤«  ¨­ã\n\n "+(Trim(lsGplan_Code))+" â¤ â®«  § ©«à« ¡æ ¬§æ¢¦ §¦ ! (="+;                        lsGplan_Ypol+")") to lsError_Message
40015>>>>>>>>>>>                   Case Break
40016>>>>>>>>>>>
40016>>>>>>>>>>>                   Case (iError_Num = 3001) //¢á¦ª «¦¬ ¡é ¡
40019>>>>>>>>>>>                        Move ("DDC 157:Transaction Aborted! (¡«á¢¢¢¦ §¨æ©£¦)\n\n"+;                              "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
40020>>>>>>>>>>>                   Case Break
40021>>>>>>>>>>>                   Case (iError_Num = 3002) //®¢©£â¤¦ gplan (reindex gplan + check gplan
40024>>>>>>>>>>>                        Move ("DDC 157:Transaction Aborted! (A¤ç§¨¡«¦ª §¨ ¢§« ¡æª)\n\n"+;                              "¨¡¢¦ç£ «¨â¥« «¦¤ ¢®¦ ¦ ©« ¡¦ç ®å¦¬!") to lsError_Message
40025>>>>>>>>>>>                   Case Break
40026>>>>>>>>>>>                   Case (iError_Num = 3003) //â¤ £§æ¨© ¤ ¥¤¨é gplan by recnum!
40029>>>>>>>>>>>                        Move ("DDC 157:Transaction Aborted! (¤ç§¨¡«¦ª ¨® ¡æª)\n\n"+;                              "¨¡¢¦ç£ «¨â¥« «¦¤ ¢ ¡æ ¢®¦ «ª «ª á©ª!") to lsError_Message
40030>>>>>>>>>>>                   Case Break
40031>>>>>>>>>>>                   Case (iError_Num = 3004) //â¤ £§æ¨© ¤ ¨é gplan by recr!
40034>>>>>>>>>>>                        Move ("DDC 157:Transaction Aborted! (¤ç§¨¡«¦ª ¨® ¡æª)\n\n"+;                              "¨¡¢¦ç£ «¨â¥« «¦¤ ¢ ¡æ ¢®¦ «ª «ª á©ª!") to lsError_Message
40035>>>>>>>>>>>                   Case Break
40036>>>>>>>>>>>                   Case (iError_Num = 3005) //¢á¦ª «¦¬ ¡é ¡
40039>>>>>>>>>>>                        Move ("DDC 157:Transaction Aborted! (update=0 + backout=0)\n\n"+;                              "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ PIS ") to lsError_Message
40040>>>>>>>>>>>                   Case Break
40041>>>>>>>>>>>
40041>>>>>>>>>>>
40041>>>>>>>>>>>                   //â¢®¦  open items
40041>>>>>>>>>>>                   Case (iError_Num = 1101)
40044>>>>>>>>>>>                        Move ("DDC 157:¡«á¢¢¢ ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        "¦ ©¬©®â« ©«¦ ®¨à©« ¡æ ¬§æ¢¦ §¦ å¤  ¨¤« ¡æ !");                        to lsError_Message
40045>>>>>>>>>>>                   Case Break
40046>>>>>>>>>>>                   Case (iError_Num = 1102)
40049>>>>>>>>>>>                        Move ("DDC 157:¡«á¢¢¢ ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        "¦ ©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ å¤  ¨¤« ¡æ !");                        to lsError_Message
40050>>>>>>>>>>>                   Case Break
40051>>>>>>>>>>>                   Case (iError_Num = 1103)
40054>>>>>>>>>>>                        Move ("DDC 157:¡«á¢¢¢ ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        " ¡á¢¬¯ «ª ®¨âà©ª å¤  ¨¤« ¡ã !");                        to lsError_Message
40055>>>>>>>>>>>                   Case Break
40056>>>>>>>>>>>                   Case (iError_Num = 1104)
40059>>>>>>>>>>>                        Move ("DDC 157:¡«á¢¢¢ ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        " ¡á¢¬¯ «ª §å©«à©ª å¤  ¨¤« ¡ã !");                        to lsError_Message
40060>>>>>>>>>>>                   Case Break
40061>>>>>>>>>>>                   //---------------------------------------« ¡âª ®¨é© ª-----------------
40061>>>>>>>>>>>                   Case (iError_Num = 1105)
40064>>>>>>>>>>>                        Move ("DDC 157:¡«á¢¢¢ ¨à©« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        "¦ ©¬©®â« ©«¦ ®¨à©« ¡æ ¬§æ¢¦ §¦ ¬§¨å¤  «¤ ¦¢ ¡ã ®¨âà© !");                        to lsError_Message
40065>>>>>>>>>>>                   Case Break
40066>>>>>>>>>>>                   Case (iError_Num = 1106)
40069>>>>>>>>>>>                        Move ("DDC 157:¡«á¢¢¢ ¨à©« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        " ¡á¢¬¯ «ª ®¨âà©ª ¬§¨å¤  «¤ ¦¢ ¡ã ®¨âà© !");                        to lsError_Message
40070>>>>>>>>>>>                   Case Break
40071>>>>>>>>>>>                   Case (iError_Num = 1107)
40074>>>>>>>>>>>                        Move ("DDC 157:¡«á¢¢¢ ¨à©« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        "¦ ©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ â¤ å¤  £¤ ¡æ !");                        to lsError_Message
40075>>>>>>>>>>>                   Case Break
40076>>>>>>>>>>>                   Case (iError_Num = 1108)
40079>>>>>>>>>>>                        Move ("DDC 157:¡«á¢¢¢ ¨à©« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        " ¡á¢¬¯ «ª §å©«à©ª â¤ å¤  £¤ ¡ã !");                        to lsError_Message
40080>>>>>>>>>>>                   Case Break
40081>>>>>>>>>>>                   //---------------------------------------¨¤« ¡âª ®¨é© ª---------------
40081>>>>>>>>>>>                   Case (iError_Num = 1109)
40084>>>>>>>>>>>                        Move ("DDC 157:¡«á¢¢¢ ¨¤« ¡ã ¨à©« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        "¦ ©¬©®â« ©«¦ ®¨à©« ¡æ ¬§æ¢¦ §¦ â¤ å¤  £¤ ¡æ!");                        to lsError_Message
40085>>>>>>>>>>>                   Case Break
40086>>>>>>>>>>>                   Case (iError_Num = 1110)
40089>>>>>>>>>>>                        Move ("DDC 157:¡«á¢¢¢ ¨¤« ¡ã ¨à©« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        " ¡á¢¬¯ «ª ®¨âà©ª â¤ å¤  £¤ ¡ã !");                        to lsError_Message
40090>>>>>>>>>>>                   Case Break
40091>>>>>>>>>>>                   Case (iError_Num = 1111)
40094>>>>>>>>>>>                        Move ("DDC 157:¡«á¢¢¢ ¨¤« ¡ã ¨à©« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        "¦ ©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§¨å¤  «¤ §æ¢¬« « £ã «ª ¨¤« ¡ãª ®¨âà©ª !");                        to lsError_Message
40095>>>>>>>>>>>                   Case Break
40096>>>>>>>>>>>                   Case (iError_Num = 1112)
40099>>>>>>>>>>>                        Move ("DDC 157:¡«á¢¢¢ ¨¤« ¡ã ¨à©« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        " ¡á¢¬¯ «ª §å©«à©ª ¬§¨å¤  «¤ §æ¢¬« « £ã «ª ¨¤« ¡ãª ®¨âà©ª !");                        to lsError_Message
40100>>>>>>>>>>>                   Case Break
40101>>>>>>>>>>>                   //---------------------------------------« ¡âª § ©«é© ª----------------
40101>>>>>>>>>>>                   Case (iError_Num = 1113)
40104>>>>>>>>>>>                        Move ("DDC 157:¡«á¢¢¢  ©«à« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        "¦ ©¬©®â« ©«¦ ®¨à©« ¡æ ¬§æ¢¦ §¦ â¤ å¤  £¤ ¡æ !");                        to lsError_Message
40105>>>>>>>>>>>                   Case Break
40106>>>>>>>>>>>                   Case (iError_Num = 1114)
40109>>>>>>>>>>>                        Move ("DDC 157:¡«á¢¢¢  ©«à« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        " ¡á¢¬¯ «ª ®¨âà©ª â¤ å¤  £¤ ¡ã !");                        to lsError_Message
40110>>>>>>>>>>>                   Case Break
40111>>>>>>>>>>>                   Case (iError_Num = 1115)
40114>>>>>>>>>>>                        Move ("DDC 157:¡«á¢¢¢  ©«à« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        "¦ ©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§¨å¤  «¤ ¦¢ ¡ã §å©«à© !");                        to lsError_Message
40115>>>>>>>>>>>                   Case Break
40116>>>>>>>>>>>                   Case (iError_Num = 1116)
40119>>>>>>>>>>>                        Move ("DDC 157:¡«á¢¢¢  ©«à« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        " ¡á¢¬¯ «ª §å©«à©ª ¬§¨å¤  «¤ ¦¢ ¡ã §å©«à© !");                        to lsError_Message
40120>>>>>>>>>>>                   Case Break
40121>>>>>>>>>>>                   //---------------------------------------¨à« ¡âª § ©«é© ª----------------
40121>>>>>>>>>>>                   Case (iError_Num = 1117)
40124>>>>>>>>>>>                        Move ("DDC 157:¡«á¢¢¢ ¨¤« ¡ã  ©«à« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        "¦ ©¬©®â« ©«¦ ®¨à©« ¡æ ¬§æ¢¦ §¦ â¤ å¤  £¤ ¡æ!");                        to lsError_Message
40125>>>>>>>>>>>                   Case Break
40126>>>>>>>>>>>                   Case (iError_Num = 1118)
40129>>>>>>>>>>>                        Move ("DDC 157:¡«á¢¢¢ ¨¤« ¡ã  ©«à« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        " ¡á¢¬¯ «ª ®¨âà©ª â¤ å¤  £¤ ¡ã !");                        to lsError_Message
40130>>>>>>>>>>>                   Case Break
40131>>>>>>>>>>>                   Case (iError_Num = 1119)
40134>>>>>>>>>>>                        Move ("DDC 157:¡«á¢¢¢ ¨¤« ¡ã  ©«à« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        "¦ ©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§¨å¤  «¤ §æ¢¬« « £ã «ª ¨¤« ¡ãª §å©«à©ª !");                        to lsError_Message
40135>>>>>>>>>>>                   Case Break
40136>>>>>>>>>>>                   Case (iError_Num = 1120)
40139>>>>>>>>>>>                        Move ("DDC 157:¡«á¢¢¢ ¨¤« ¡ã  ©«à« ¡ã ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        " ¡á¢¬¯ «ª §å©«à©ª ¬§¨å¤  «¤ §æ¢¬« « £ã «ª ¨¤« ¡ãª §å©«à©ª !");                        to lsError_Message
40140>>>>>>>>>>>                   Case Break
40141>>>>>>>>>>>
40141>>>>>>>>>>>
40141>>>>>>>>>>>
40141>>>>>>>>>>>                   Case Else
40141>>>>>>>>>>>                        Forward Send Operation_Not_Allowed iError_Num
40143>>>>>>>>>>>              Case End
40143>>>>>>>>>>>
40143>>>>>>>>>>>              Error iError_Num lsError_Message
40144>>>>>>>>>>>>
40144>>>>>>>>>>>    End_Procedure   //operation_not_allowed
40145>>>>>>>>>>>
40145>>>>>>>>>>>
40145>>>>>>>>>>>    //1001:Gmove_x0  * Gmove_p0  = 0 (â¤ § «¨â§«  © â¤ record ¤ â®à ¡  ®¨âà© ¡å §å©«à©)
40145>>>>>>>>>>>    //1002:Gmove_x00 * Gmove_p00 = 0
40145>>>>>>>>>>>    //1003:Gmove_rxr * Gmove_pr  = 0
40145>>>>>>>>>>>    //1004:Gmove_x2  * Gmove_p2
40145>>>>>>>>>>>
40145>>>>>>>>>>>    //1005:garticl_aa = 0:§ «¨â§«  save £æ¤¦¤ © §¨¦©à¨ ¤âª ¡ ¤ã© ª-« ¦¨ ©« ¡á á¨¨ â¤ ¢¦ é¤¦¤« 
40145>>>>>>>>>>>    //                   (§¨¦©¦®ã ©«¤ ®¦¨ã©©  : §¨é« ©éà Gmove ¡  £«á garticl!)
40145>>>>>>>>>>>    //                   § ¤æ¤ ¦ â¢®¦ª ¬«æª ¤ å¤  £ «¦ statuse
40145>>>>>>>>>>>
40145>>>>>>>>>>>
40145>>>>>>>>>>>    //1006:garticl_myfchkp <=1:© ¡á á¨¨¦ § «¨â§«  £æ¤¦¤ 1 ¡æ«ª/§¦â¡«ª    §à¢ã©à¤
40145>>>>>>>>>>>    //1007:garticl_myfchka <=1:© ¡á á¨¨¦ § «¨â§«  £æ¤¦¤ 1 ¡æ«ª/§¦â¡«ª    ¦¨é¤
40145>>>>>>>>>>>
40145>>>>>>>>>>>    //1008
40145>>>>>>>>>>>
40145>>>>>>>>>>>    //02/05/2000:¦ â¢®¦ª module å¤«  £æ¤¦¤ ©«¦ garticl
40145>>>>>>>>>>>    //1009:m_code: ¨­ã § «¨â§«  £æ¤¦¤ §¦ ¦ module §¦¬ «¤ £ ¦ç¨© < ¡ ¬ ¨ ¦ ¤ !>
40145>>>>>>>>>>>
40145>>>>>>>>>>>
40145>>>>>>>>>>>    //1010:
40145>>>>>>>>>>>    //1011:
40145>>>>>>>>>>>    //1012:
40145>>>>>>>>>>>
40145>>>>>>>>>>>    //1013:gplan_yn_last = 1:¡å¤© £æ¤¦¤ © «¢¬«å¦ £æ
40145>>>>>>>>>>>    //1014:gplan_yn_kin  = 1:¢®¦ª ¡å¤©ª §¦ «¦ «¨â®¦¤ module
40145>>>>>>>>>>>    //1015:gplan_xpm=1 + p2=0:¢®¦ª å¦¬ª ¡ ¤ã©à¤
40145>>>>>>>>>>>    //1016:gplan_xpm=2 + x2=0:¢®¦ª å¦¬ª ¡ ¤ã©à¤
40145>>>>>>>>>>>
40145>>>>>>>>>>>    //¦  §¨¡á«à 2 â¢®¦  å¤¦¤«  ©«¤ private.trexe
40145>>>>>>>>>>>    //1017:gplan_yn_xy=0 + gplan_sx0>=gplan_sp0:§¦¨ç«  ®¨à©« ¡æ ¬§æ¢¦ §¦
40145>>>>>>>>>>>    //1018:gplan_yn_py=0 + gplan_sp0>=gplan_sx0:§¦¨ç«  § ©«à« ¡æ ¬§æ¢¦ §¦
40145>>>>>>>>>>>    //1019:gplan_c_code2:á¤ <> "", «æ« £æ¤¦¤ ¡ ¤ã© ª © ¬«æ «¦ ¤æ£ ©£
40145>>>>>>>>>>>
40145>>>>>>>>>>>    //1100:cby = globals
40145>>>>>>>>>>>    //§¦¨ç«  «¦ Gmove ¤ ¢¢á  parent garticl
40145>>>>>>>>>>>
40145>>>>>>>>>>>    //â¢®¦  open item
40145>>>>>>>>>>>    //1101:yx >= 0 §á¤«
40145>>>>>>>>>>>    //1102:yp >= 0 §á¤«
40145>>>>>>>>>>>    //1103:sx >= 0 §á¤«
40145>>>>>>>>>>>    //1104:sp >= 0 §á¤«
40145>>>>>>>>>>>
40145>>>>>>>>>>>    //1105:  «æ­ ¦ ®¨à©« ¡æ record: yx <= x0
40145>>>>>>>>>>>    //1106:                             sx <= x0
40145>>>>>>>>>>>    //1107:                             yp  =  0
40145>>>>>>>>>>>    //1108:                             sp  =  0
40145>>>>>>>>>>>
40145>>>>>>>>>>>    //1109:  ¯¬«¦- § ©«à« ¡æ record: yx  =  0
40145>>>>>>>>>>>    //1110:                             sx  =  0
40145>>>>>>>>>>>    //1111:                             yp  <= (abs(x0))
40145>>>>>>>>>>>    //1112:                             sp  <= (abs(x0))
40145>>>>>>>>>>>
40145>>>>>>>>>>>    //1113:  «æ­ ¦ § ©«à« ¡æ record: yx  =  0
40145>>>>>>>>>>>    //1114:                             sx  =  0
40145>>>>>>>>>>>    //1115:                             yp  <= p0
40145>>>>>>>>>>>    //1116:                             sp  <= p0
40145>>>>>>>>>>>
40145>>>>>>>>>>>    //1117:  ¯ç«¦- ®¨à©« ¡æ record: yx  =  0
40145>>>>>>>>>>>    //1118:                             sx  =  0
40145>>>>>>>>>>>    //1119:                             yp  <= (abs(p0))
40145>>>>>>>>>>>    //1120:                             sp  <= (abs(p0))
40145>>>>>>>>>>>
40145>>>>>>>>>>>
40145>>>>>>>>>>>    //        yp         = 0
40145>>>>>>>>>>>    //        sx between 0 and x0
40145>>>>>>>>>>>    //        sp=0
40145>>>>>>>>>>>
40145>>>>>>>>>>>
40145>>>>>>>>>>>    Function Validate_Save Returns Integer
40146>>>>>>>>>>>             Integer iReturnVal liZeroAA liOpen_Items
40147>>>>>>>>>>>             Forward Get Validate_Save to iReturnVal
40149>>>>>>>>>>>
40149>>>>>>>>>>>             If (Not(iReturnVal));             Begin
40151>>>>>>>>>>>
40151>>>>>>>>>>>              //â¢®¦  ®¨à§ ©«é©à¤
40151>>>>>>>>>>>              If (Not(Gmove.Gmove_X0 * Gmove.Gmove_P0 = 0)) Send Operation_Not_Allowed 1001
40154>>>>>>>>>>>              If (Not(Gmove.Gmove_X00* Gmove.Gmove_P00= 0)) Send Operation_Not_Allowed 1002
40157>>>>>>>>>>>              If (Not(Gmove.Gmove_Xr * Gmove.Gmove_Pr = 0)) Send Operation_Not_Allowed 1003
40160>>>>>>>>>>>              If (Not(Gmove.Gmove_X2 * Gmove.Gmove_P2 = 0)) Send Operation_Not_Allowed 1004
40163>>>>>>>>>>>
40163>>>>>>>>>>>//            //â¢®¦ª / (¢¦ ©« ¡¦§¦å©ª)
40163>>>>>>>>>>>//            If (Not(Garticl.Garticl_AA = 0))                  Send Operation_Not_Allowed 1005
40163>>>>>>>>>>>
40163>>>>>>>>>>>              //â¢®¦  
40163>>>>>>>>>>>              If (Not(Garticl.Garticl_MyfChkp <= 1))            Send Operation_Not_Allowed 1006
40166>>>>>>>>>>>              If (Not(Garticl.Garticl_MyfChka <= 1))            Send Operation_Not_Allowed 1007
40169>>>>>>>>>>>
40169>>>>>>>>>>>
40169>>>>>>>>>>>
40169>>>>>>>>>>>//           02/05/2000:¦ â¢®¦ª module å¤«  £æ¤¦¤ ©«¦ garticl
40169>>>>>>>>>>>//                      ¡  £æ¤¦¤   regular data entry (æ®    ®¦¨ã©-£¤ ©£æ /!
40169>>>>>>>>>>>//---------->//1009:â¢®¦ª module ¨­ãª
40169>>>>>>>>>>>//---------->If (Not(Garticl.Garticl_M_Code = gs_Module_Code))  Send Operation_Not_Allowed 1009
40169>>>>>>>>>>>
40169>>>>>>>>>>>             //¦  â¢®¦  «¦¬ gplan §¦¬ å¤¦¤«  é, ­¦¨æ¬¤ £æ¤¦¤ «¦¤ «¢¬«å¦ £æ,
40169>>>>>>>>>>>             //¦ ¦§¦å¦ª á¢¢à©« â®  ¡«®à¨å ©«¦ Gmove.
40169>>>>>>>>>>>             //¦  2 â¢®¦  ¬§¦¢¦å§à¤ (1017+1018) §¦¬ ­¦¨¦ç¤ ¡  æ¢¦¬ª «¦¬ª
40169>>>>>>>>>>>             //§¨ ¢§« ¡¦çª, å¤¦¤«  ©«¤ private.trexe
40169>>>>>>>>>>>             //1013:â¢®¦ª «¢¬«å¦¬ £¦ç
40169>>>>>>>>>>>             If (Not(Gplan.Gplan_Yn_Last = TRUE             ))  Send Operation_Not_Allowed 1013
40172>>>>>>>>>>>
40172>>>>>>>>>>>// js 10/05/2002
40172>>>>>>>>>>>//             //1014:â¢®¦ª ¡å¤©ª §¦ «¦ «¨â®¦¤ module
40172>>>>>>>>>>>//             If (;
40172>>>>>>>>>>>//                  (Gplan.Gplan_Yn_Kin  = FALSE) and;
40172>>>>>>>>>>>//                  ((private.fiGplanmod_Module(Self,;
40172>>>>>>>>>>>//                                              Gplan.Gplan_Recr,;
40172>>>>>>>>>>>//                                              gs_Module_Code);
40172>>>>>>>>>>>//                   ) = FALSE);
40172>>>>>>>>>>>//                )                                               Send Operation_Not_Allowed 1014
40172>>>>>>>>>>>
40172>>>>>>>>>>>             //1015+1016:â¢®¦  å¦¬ª ¡ ¤ã©à¤
40172>>>>>>>>>>>             //           ®¨¦ç£¤¦¬ª ¢¦/£¦çª,  §å©«à© §¨â§  ¤ å¤  0
40172>>>>>>>>>>>             If (   (Gplan.Gplan_Xpm  = 1) and;                (Not(Gmove.Gmove_P2 = 0)))                    Send Operation_Not_Allowed 1015
40175>>>>>>>>>>>             //           § ©«¦ç£¤¦¬ª ¢¦/£¦çª,  ®¨âà© §¨â§  ¤ å¤  0
40175>>>>>>>>>>>             If (   (Gplan.Gplan_Xpm  = 2) and;                (Not(Gmove.Gmove_X2 = 0)))                    Send Operation_Not_Allowed 1016
40178>>>>>>>>>>>
40178>>>>>>>>>>>             //1019:â¢®¦ª ¤¦£å©£«¦ª ¡å¤©ª ¢¦¨ ©£¦ç
40178>>>>>>>>>>>             If (;                     (Gplan.Gplan_C_Code2 <> "") and;                 (Not(Gplan.Gplan_C_Code2 = Garticl.Garticl_C_Code2));                )                                               Send Operation_Not_Allowed 1019
40181>>>>>>>>>>>
40181>>>>>>>>>>>             //1101-1120:â¢®¦  open item
40181>>>>>>>>>>>              Move (private.fi_Validate_Open_Items(Self)) to liOpen_Items
40182>>>>>>>>>>>              If (liOpen_Items <> 0) Send Operation_Not_Allowed liOpen_Items
40185>>>>>>>>>>>
40185>>>>>>>>>>>              //1100:cby = globals
40185>>>>>>>>>>>              If ( ;                  (Not(Gmove.Company_Code = SysCurGL.Company_Code)) or;                  (Not(Gmove.Branch_Code  = SysCurGL.Branch_Code )) or;                  (Not(Gmove.Year_Year    = SysCurGL.Year_Year   ));                  ) Send Operation_Not_Allowed 1100
40188>>>>>>>>>>>             End //«â¢¦ª ¡é ¡ validation
40188>>>>>>>>>>>>
40188>>>>>>>>>>>             Function_Return iReturnVal
40189>>>>>>>>>>>    End_Function //validate_save
40190>>>>>>>>>>>
40190>>>>>>>>>>>
40190>>>>>>>>>>>    //2001:« ¦¨ ©« ¡á á¨¨ â¤  ¨á­¦¤« 
40190>>>>>>>>>>>    //2002:«¦ á¨¨¦  ¨á­«  £æ¤¦¤ §¦ «¦ module §¦¬ «¦ £ ¦ç¨©
40190>>>>>>>>>>>    //2100:cby = globals
40190>>>>>>>>>>>
40190>>>>>>>>>>>    Function Validate_Delete  Returns Integer
40191>>>>>>>>>>>             Integer iReturnVal
40192>>>>>>>>>>>             Forward Get Validate_Delete  To iReturnVal
40194>>>>>>>>>>>             If (Not(iReturnVal));             Begin
40196>>>>>>>>>>>
40196>>>>>>>>>>>              //2001:â¢®¦ª / (¢¦ ©« ¡¦§¦å©ª)
40196>>>>>>>>>>>              If (Garticl.Garticl_AA <> 0)                     Send Operation_Not_Allowed 2001
40199>>>>>>>>>>>
40199>>>>>>>>>>>// js 10/05/2002
40199>>>>>>>>>>>//              //2002:â¢®¦ª module ¨­ãª
40199>>>>>>>>>>>//              If (Not(Garticl.Garticl_M_Code = gs_Module_Code)) Send Operation_Not_Allowed 2002
40199>>>>>>>>>>>
40199>>>>>>>>>>>              //2100:cby = globals
40199>>>>>>>>>>>              If ( ;                  (Not(Gmove.Company_Code = SysCurGL.Company_Code)) or;                  (Not(Gmove.Branch_Code  = SysCurGL.Branch_Code )) or;                  (Not(Gmove.Year_Year    = SysCurGL.Year_Year   ));                  ) Send Operation_Not_Allowed 2100
40202>>>>>>>>>>>             End //«â¢¦ª ¡é ¡ validation
40202>>>>>>>>>>>>
40202>>>>>>>>>>>             Function_Return iReturnVal
40203>>>>>>>>>>>    End_Function //validate_delete
40204>>>>>>>>>>>
40204>>>>>>>>>>>
40204>>>>>>>>>>>
40204>>>>>>>>>>>    Function fnCalcMonada Integer Rdigits## Returns Number
40205>>>>>>>>>>>        Local Number lnMonada##
40206>>>>>>>>>>>           move (1/(10^Rdigits##)) to lnMonada##
40207>>>>>>>>>>>        Function_Return lnMonada##
40208>>>>>>>>>>>    End_Function
40209>>>>>>>>>>>
40209>>>>>>>>>>>    Function FnSetValues Integer fnCurr## Integer fnxp## Integer fnMulti## Number fnValue## Returns Integer
40210>>>>>>>>>>>        Local Integer iRval##
40211>>>>>>>>>>>        If (fnCurr## = 1) Begin //Local-Book
40213>>>>>>>>>>>           if (Fnxp##= 1) Begin //Xreosh
40215>>>>>>>>>>>            set field_Changed_Value Field Gmove.Gmove_X0 to ((abs(Gmove.Gmove_X0)+abs(fnValue##)) * fnMulti##) //ja//to Gmove.Gmove_X0
40216>>>>>>>>>>>            set field_Changed_Value Field Gmove.Gmove_X0k to fnValue##
40217>>>>>>>>>>>           end
40217>>>>>>>>>>>>
40217>>>>>>>>>>>           if (Fnxp##= 2) Begin //Pistosi
40219>>>>>>>>>>>               set field_Changed_Value Field Gmove.Gmove_p0 to ((abs(Gmove.Gmove_p0)+abs(fnValue##)) * fnMulti##) //ja//to Gmove.Gmove_p0
40220>>>>>>>>>>>               set field_Changed_Value Field Gmove.Gmove_p0k to fnValue##
40221>>>>>>>>>>>           end
40221>>>>>>>>>>>>
40221>>>>>>>>>>>        end
40221>>>>>>>>>>>>
40221>>>>>>>>>>>        If (fnCurr## = 2) Begin //EUro
40223>>>>>>>>>>>           if (Fnxp##= 1) Begin //Xreosh
40225>>>>>>>>>>>            set field_Changed_Value Field Gmove.Gmove_X00 to ((abs(Gmove.Gmove_X00)+abs(fnValue##)) * fnMulti##) //ja//to Gmove.Gmove_X00
40226>>>>>>>>>>>            set field_Changed_Value Field Gmove.Gmove_X00k to fnValue##
40227>>>>>>>>>>>           end
40227>>>>>>>>>>>>
40227>>>>>>>>>>>           if (Fnxp##= 2) Begin //Pistosi
40229>>>>>>>>>>>               set field_Changed_Value Field Gmove.Gmove_p00 to ((abs(Gmove.Gmove_p00)+abs(fnValue##)) * fnMulti##) //ja//to Gmove.Gmove_p00
40230>>>>>>>>>>>               set field_Changed_Value Field Gmove.Gmove_p00k to fnValue##
40231>>>>>>>>>>>           end
40231>>>>>>>>>>>>
40231>>>>>>>>>>>        end
40231>>>>>>>>>>>>
40231>>>>>>>>>>>        If (fnCurr## = 3) Begin //Reporting
40233>>>>>>>>>>>           if (Fnxp##= 1) Begin //Xreosh
40235>>>>>>>>>>>            set field_Changed_Value Field Gmove.Gmove_XR to ((abs(Gmove.Gmove_XR)+abs(fnValue##)) * fnMulti##) //ja//to Gmove.Gmove_XR
40236>>>>>>>>>>>            set field_Changed_Value Field Gmove.Gmove_XRk to fnValue##
40237>>>>>>>>>>>           end
40237>>>>>>>>>>>>
40237>>>>>>>>>>>           if (Fnxp##= 2) Begin //Pistosi
40239>>>>>>>>>>>               set field_Changed_Value Field Gmove.Gmove_pR to ((abs(Gmove.Gmove_pR)+abs(fnValue##)) * fnMulti##) //ja//to Gmove.Gmove_pR
40240>>>>>>>>>>>               set field_Changed_Value Field Gmove.Gmove_pRk to fnValue##
40241>>>>>>>>>>>           end
40241>>>>>>>>>>>>
40241>>>>>>>>>>>        end
40241>>>>>>>>>>>>
40241>>>>>>>>>>>        move 0 to iRval##
40242>>>>>>>>>>>        Function_Return iRval##
40243>>>>>>>>>>>    End_Function
40244>>>>>>>>>>>
40244>>>>>>>>>>>    // ©¦©¡¢å  « ª ®¨à§ ©«é© ª ©« 3 ¤¦£å©£« ¤ â®¦¬¤ §¨¦¡å¯   ­¦¨âª
40244>>>>>>>>>>>    // ¢æà Rate
40244>>>>>>>>>>>    // pros to par;on §¤¨¦§¦ £â¤  «å §å¦¬£ £æ¤¦ ©' ¤ ¤æ£ ©£
40244>>>>>>>>>>>    // sosososososoososososos ¤ ¢®å  ¢¦ ¡ã
40244>>>>>>>>>>>    //¡¢å«  §æ: a) Gmove.vw   function exiting
40244>>>>>>>>>>>    //              b) doAkArth.pkg (¡¬¨à« ¡æ á¨¨¦)
40244>>>>>>>>>>>    procedure check_Arthro_For_Ypol
40245>>>>>>>>>>>
40245>>>>>>>>>>>        Local Integer liIndAxxre## LiIndAxpist##;     //Book                      liIndAxxreE## LiIndAxpistE##;   //Euro                      liIndAxxreR## LiIndAxpistR##;   //Reporting                      limulti## liMatch##;                      liCounterX## liCounterP##;                      liCounterRecords## liRval1## liRval2## liXP##
40246>>>>>>>>>>>
40246>>>>>>>>>>>        Local Number  lnCheckValueX## lnCheckValueP##;                      lnCheckValueXOther## lnCheckValuePOther##;                      lnSearchRecnum## lnSearchOtherRecnum##;                      lnStartYpol## lnTotalYpol##
40246>>>>>>>>>>>
40246>>>>>>>>>>>        Local Number  lnNewYpolL##;                      lnNewYpolE##;                      lnNewYpolR##
40246>>>>>>>>>>>
40246>>>>>>>>>>>        Local Integer liIncome## liExpense## liOther##;                      liLocal## liEuro## liReporting##
40246>>>>>>>>>>>
40246>>>>>>>>>>>        Local String  lsChkGPlan_o_Code## lsChkGplanC##
40246>>>>>>>>>>>
40246>>>>>>>>>>>
40246>>>>>>>>>>>        Procedure_Return 0
40247>>>>>>>>>>>
40247>>>>>>>>>>>        Set  piFireConvert to 1
40248>>>>>>>>>>>
40248>>>>>>>>>>>
40248>>>>>>>>>>>        //sosososo lathos, prpepei na kaneis get field curent value !!!!
40248>>>>>>>>>>>        if ((Garticl.Garticl_Syp0k <> 0) or (Garticl.Garticl_Syp00k <> 0) or (Garticl.Garticl_SypRk <> 0)) begin
40250>>>>>>>>>>>
40250>>>>>>>>>>>        if (Garticl.Garticl_Syp0k  <> 0)  Move 1 to liLocal##
40253>>>>>>>>>>>        if (Garticl.Garticl_Syp00k <> 0)  Move 1 to liEuro##
40256>>>>>>>>>>>        if (Garticl.Garticl_Syprk  <> 0)  Move 1 to liReporting##
40259>>>>>>>>>>>
40259>>>>>>>>>>>        move (Garticl.Garticl_Sx0-Garticl.Garticl_Sp0)   to lnNewYpolL##
40260>>>>>>>>>>>        move (Garticl.Garticl_Sx00-Garticl.Garticl_Sp00) to lnNewYpolE##
40261>>>>>>>>>>>        move (Garticl.Garticl_SxR-Garticl.Garticl_SpR)   to lnNewYpolR##
40262>>>>>>>>>>>
40262>>>>>>>>>>>            move 0 to liMulti##
40263>>>>>>>>>>>            move 0 to liIndAxxre##
40264>>>>>>>>>>>            move 0 to liIndAxPist##
40265>>>>>>>>>>>            move 0 to liMatch##
40266>>>>>>>>>>>
40266>>>>>>>>>>>
40266>>>>>>>>>>>            if ((Garticl.Garticl_Sx0-Garticl.Garticl_Sp0) > 0 ) move 1 to liIndAxxre##
40269>>>>>>>>>>>            else;            if ((Garticl.Garticl_Sx0-Garticl.Garticl_Sp0) < 0 ) move 1 to liIndAxPist##
40273>>>>>>>>>>>
40273>>>>>>>>>>>            if ((Garticl.Garticl_Sx00-Garticl.Garticl_Sp00) > 0 ) move 1 to liIndAxxreE##
40276>>>>>>>>>>>            else;            if ((Garticl.Garticl_Sx00-Garticl.Garticl_Sp00) < 0 ) move 1 to liIndAxPistE##
40280>>>>>>>>>>>
40280>>>>>>>>>>>            if ((Garticl.Garticl_SxR-Garticl.Garticl_SpR) > 0 ) move 1 to liIndAxxreR##
40283>>>>>>>>>>>            else;            if ((Garticl.Garticl_SxR-Garticl.Garticl_SpR) < 0 ) move 1 to liIndAxPistR##
40287>>>>>>>>>>>
40287>>>>>>>>>>>            Send Request_Find to (self) First_Record Gmove.File_Number 2
40288>>>>>>>>>>>            While ((Found) And (liMatch## = 0))
40292>>>>>>>>>>>
40292>>>>>>>>>>>                If ((liLocal##=1) and (lnNewYpolL## <> 0)) begin  //BOOK............
40294>>>>>>>>>>>                    Get Field_Current_Value Field Gmove.Gmove_X0 to lnCheckValueX##
40295>>>>>>>>>>>                    Get Field_Current_Value Field Gmove.Gmove_P0 to lnCheckValueP##
40296>>>>>>>>>>>                    if (liIndAxXre## =1) begin
40298>>>>>>>>>>>                        if ((lnCheckValueX## < 0) or (lnCheckValueP## > 0 )) begin
40300>>>>>>>>>>>                            if (lnCheckValueX## < 0)  move (fnSetValues(Self,1,1,-1,(fnCalcMonada(Self,0)))) to liRval1##
40303>>>>>>>>>>>                            if (lnCheckValueP## > 0)  move (fnSetValues(Self,1,2,1,(fnCalcMonada(Self,0))))  to liRval1##
40306>>>>>>>>>>>
40306>>>>>>>>>>>                            Set  piFireConvert to 1
40307>>>>>>>>>>>
40307>>>>>>>>>>>                            Send Request_Save
40308>>>>>>>>>>>                            if (lnNewYpolL## <> 0);                            move (lnNewYpolL## - (fnCalcMonada(Self,0))) to lnNewYpolL##
40311>>>>>>>>>>>                        end //if ((lnCheckValueX## < 0) or ....
40311>>>>>>>>>>>>
40311>>>>>>>>>>>                     end
40311>>>>>>>>>>>>
40311>>>>>>>>>>>                     else if (liIndAxPist## =1) begin
40314>>>>>>>>>>>                        if ((lnCheckValueX## > 0) or (lnCheckValueP## < 0 )) begin
40316>>>>>>>>>>>                            if (lnCheckValueX## > 0)  move (fnSetValues(Self,1,1,1,(fnCalcMonada(Self,0)))) to liRval1##
40319>>>>>>>>>>>                            if (lnCheckValueP## < 0)  move (fnSetValues(Self,1,2,-1,(fnCalcMonada(Self,0))))  to liRval1##
40322>>>>>>>>>>>
40322>>>>>>>>>>>                            //Move 1 to liFireConvert## //ja//
40322>>>>>>>>>>>                            Set  piFireConvert to 1
40323>>>>>>>>>>>
40323>>>>>>>>>>>                            Send Request_Save
40324>>>>>>>>>>>                            if (lnNewYpolL## <> 0);                            move (lnNewYpolL## + (fnCalcMonada(Self,0))) to lnNewYpolL##
40327>>>>>>>>>>>                        end //if ((lnCheckValueX## < 0) or ....
40327>>>>>>>>>>>>
40327>>>>>>>>>>>                     end
40327>>>>>>>>>>>>
40327>>>>>>>>>>>                end //((liLocal##=1) and ..........
40327>>>>>>>>>>>>
40327>>>>>>>>>>>
40327>>>>>>>>>>>                If ((liEuro##=1) and (lnNewYpolE## <> 0)) Begin  //EURO...............
40329>>>>>>>>>>>                    Get Field_Current_Value Field Gmove.Gmove_X00 to lnCheckValueX##
40330>>>>>>>>>>>                    Get Field_Current_Value Field Gmove.Gmove_P00 to lnCheckValueP##
40331>>>>>>>>>>>                    if (liIndAxXreE## =1) begin
40333>>>>>>>>>>>                        if ((lnCheckValueX## < 0) or (lnCheckValueP## > 0 )) begin
40335>>>>>>>>>>>                            if (lnCheckValueX## < 0)  move (fnSetValues(Self,2,1,-1,(fnCalcMonada(Self,2)))) to liRval1##
40338>>>>>>>>>>>                            if (lnCheckValueP## > 0)  move (fnSetValues(Self,2,2,1,(fnCalcMonada(Self,2))))  to liRval1##
40341>>>>>>>>>>>
40341>>>>>>>>>>>                            Set  piFireConvert to 1
40342>>>>>>>>>>>
40342>>>>>>>>>>>                            Send Request_Save
40343>>>>>>>>>>>                            if (lnNewYpolE## <> 0);                            move (lnNewYpolE## - (fnCalcMonada(Self,2))) to lnNewYpolE##
40346>>>>>>>>>>>                        end //if ((lnCheckValueX## < 0) or ....
40346>>>>>>>>>>>>
40346>>>>>>>>>>>                    end //Xrevsh
40346>>>>>>>>>>>>
40346>>>>>>>>>>>                    else if (liIndAxPistE## =1) begin
40349>>>>>>>>>>>                        if ((lnCheckValueX## >  0) or (lnCheckValueP## < 0 )) begin
40351>>>>>>>>>>>                            if (lnCheckValueX## > 0)  move (fnSetValues(Self,2,1,1,(fnCalcMonada(Self,2)))) to liRval1##
40354>>>>>>>>>>>                            if (lnCheckValueP## < 0)  move (fnSetValues(Self,2,2,-1,(fnCalcMonada(Self,2))))  to liRval1##
40357>>>>>>>>>>>
40357>>>>>>>>>>>                            Set  piFireConvert to 1
40358>>>>>>>>>>>
40358>>>>>>>>>>>                            Send Request_Save
40359>>>>>>>>>>>                            if (lnNewYpolE## <> 0);                            move (lnNewYpolE## + (fnCalcMonada(Self,2))) to lnNewYpolE##
40362>>>>>>>>>>>                        end //if ((lnCheckValueX## < 0) or ....
40362>>>>>>>>>>>>
40362>>>>>>>>>>>                    end //Pistosh
40362>>>>>>>>>>>>
40362>>>>>>>>>>>                end //ENd of EURO........
40362>>>>>>>>>>>>
40362>>>>>>>>>>>
40362>>>>>>>>>>>
40362>>>>>>>>>>>                If ((liReporting##=1) and (lnNewYpolR## <> 0)) begin
40364>>>>>>>>>>>                    Get Field_Current_Value Field Gmove.Gmove_XR to lnCheckValueX##
40365>>>>>>>>>>>                    Get Field_Current_Value Field Gmove.Gmove_PR to lnCheckValueP##
40366>>>>>>>>>>>                    if (liIndAxXreR## =1) begin
40368>>>>>>>>>>>                        if ((lnCheckValueX## < 0) or (lnCheckValueP## > 0 )) begin
40370>>>>>>>>>>>                            if (lnCheckValueX## < 0)  move (fnSetValues(Self,3,1,-1,(fnCalcMonada(Self,2)))) to liRval1##
40373>>>>>>>>>>>                            if (lnCheckValueP## > 0)  move (fnSetValues(Self,3,2,1,(fnCalcMonada(Self,2))))  to liRval1##
40376>>>>>>>>>>>
40376>>>>>>>>>>>                            Set  piFireConvert to 1
40377>>>>>>>>>>>
40377>>>>>>>>>>>                            Send Request_Save
40378>>>>>>>>>>>                            if (lnNewYpolR## <> 0);                            move (lnNewYpolR## - (fnCalcMonada(Self,0))) to lnNewYpolR##
40381>>>>>>>>>>>                        end //if ((lnCheckValueX## < 0) or ....
40381>>>>>>>>>>>>
40381>>>>>>>>>>>                     end
40381>>>>>>>>>>>>
40381>>>>>>>>>>>                     else if (liIndAxPistR## =1) begin
40384>>>>>>>>>>>                            if (lnCheckValueX## > 0)  move (fnSetValues(Self,3,1,1,(fnCalcMonada(Self,2)))) to liRval1##
40387>>>>>>>>>>>                            if (lnCheckValueP## < 0)  move (fnSetValues(Self,3,2,-1,(fnCalcMonada(Self,2))))  to liRval1##
40390>>>>>>>>>>>
40390>>>>>>>>>>>                            Set  piFireConvert to 1
40391>>>>>>>>>>>
40391>>>>>>>>>>>                            Send Request_Save
40392>>>>>>>>>>>                            if (lnNewYpolR## <> 0);                            move (lnNewYpolR## + (fnCalcMonada(Self,0))) to lnNewYpolR##
40395>>>>>>>>>>>                     end
40395>>>>>>>>>>>>
40395>>>>>>>>>>>                end //
40395>>>>>>>>>>>>
40395>>>>>>>>>>>
40395>>>>>>>>>>>                    if (liMatch## = 0);                    Send Request_Find to (self) Next_Record Gmove.File_Number 2
40398>>>>>>>>>>>            end  //While ((Found)
40399>>>>>>>>>>>>
40399>>>>>>>>>>>     end
40399>>>>>>>>>>>>
40399>>>>>>>>>>>        Set piFireConvert to 0
40400>>>>>>>>>>>    end_Procedure
40401>>>>>>>>>>>
40401>>>>>>>>>>>
40401>>>>>>>>>>>    // Define_Fields:
40401>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
40401>>>>>>>>>>>
40401>>>>>>>>>>>    Procedure Define_Fields
40402>>>>>>>>>>>        Forward Send Define_Fields
40404>>>>>>>>>>>        //DDB-Generated-Code-Location
40404>>>>>>>>>>>        //DDB-DefineFieldStart
40404>>>>>>>>>>>
40404>>>>>>>>>>>        Set Main_File            To Gmove.File_Number
40405>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
40406>>>>>>>>>>>
40406>>>>>>>>>>>
40406>>>>>>>>>>>        // Child (Client) file structure................
40406>>>>>>>>>>>        Send Add_Client_File  Gopen.File_Number
40407>>>>>>>>>>>
40407>>>>>>>>>>>        // Parent (Server) file structure...............
40407>>>>>>>>>>>        Send Add_Server_File  Garticl.File_Number
40408>>>>>>>>>>>        Send Add_Server_File  Gplan.File_Number
40409>>>>>>>>>>>
40409>>>>>>>>>>>        // External (System) file structure.............
40409>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_NEW_SAVE
40410>>>>>>>>>>>        Send Add_System_File  Gmhnes.File_Number  DD_LOCK_ON_ALL
40411>>>>>>>>>>>        Send Add_System_File  Ghmnies.File_Number  DD_LOCK_ON_ALL
40412>>>>>>>>>>>        Send Add_System_File  Gplanmod.File_Number  DD_LOCK_ON_ALL
40413>>>>>>>>>>>
40413>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gmove_Rec0  To Gmove.Gmove_Rec0
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Field-based properties.......................
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Company_Code
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Branch_Code
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Year_Year
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gtypkin_Code
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Garticl_Hmnia
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Garticl_No
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Garticl_Recr
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gplan_Recr
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gmove_Rec0
40416>>>>>>>>>>>        //DDB/ Comment_Short       Field Gmove.Gmove_Rec0 To "System ¡à ¡æª ¨­ãª"
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gplan_Code
40416>>>>>>>>>>>        //DDB/ Comment_Short       Field Gmove.Gplan_Code To "¤£¨é¤«  ©«¤ Update"
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gmove_Aitiol
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gmove_X0
40416>>>>>>>>>>>        //DDB/ Comment_Short       Field Gmove.Gmove_X0 To "¨âà© © ¤æ£ ©£ ®¨ã©ª (computed value)"
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gmove_P0
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gmove_X0k
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gmove_P0k
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gmove_X00
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gmove_P00
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gmove_X00k
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gmove_P00k
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gmove_X1
40416>>>>>>>>>>>        //DDB/ Comment_Short       Field Gmove.Gmove_X1 To "¨âà© © ¤æ£ ©£ ¢¦¨ ©£¦ç  (computed value)"
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gmove_P1
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gmove_X2
40416>>>>>>>>>>>        //DDB/ Comment_Short       Field Gmove.Gmove_X2 To "¨âà© © ¤æ£ ©£ ¨­ãª (user input)"
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gmove_P2
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gmove_X2k
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gmove_P2k
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gmove_Xr
40416>>>>>>>>>>>        //DDB/ Comment_Short       Field Gmove.Gmove_Xr To "¨âà© © ¤æ£ ©£ reporting (computed value)"
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gmove_Pr
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gmove_Xrk
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gmove_Prk
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gmove_Dlixis
40416>>>>>>>>>>>        //DDB/ Comment_Short       Field Gmove.Gmove_Dlixis To "£/¤å ¢ã¥ª §¢¨à£ãª."
40416>>>>>>>>>>>
40416>>>>>>>>>>>        // Gmove.Gmove_A_Code
40416>>>>>>>>>>>        //DDB/ Comment_Short       Field Gmove.Gmove_A_Code To "à ¡æª  « ¦¢¦åª (codemast)"
40416>>>>>>>>>>>        Set Field_Class_Name       Field Gmove.Gmove_A_Code To "dbComboFormSub"
40417>>>>>>>>>>>        Set Field_Value_Table      Field Gmove.Gmove_A_Code To (Gmove_Gmove_A_Code_VT(Self))
40418>>>>>>>>>>>
40418>>>>>>>>>>>        // Gmove.Gthhmgio_Code
40418>>>>>>>>>>>        //DDB/ Comment_Short       Field Gmove.Gthhmgio_Code To "à ¡æª à¨£â¤¦¬ £¨¦¢¦å¦¬ (¤£¨é¤«  ©«¤ update)"
40418>>>>>>>>>>>        Set Field_Options          Field Gmove.Gthhmgio_Code To DD_DISPLAYONLY
40419>>>>>>>>>>>
40419>>>>>>>>>>>        // Gmove.Gmove_Aa
40419>>>>>>>>>>>
40419>>>>>>>>>>>        // Gmove.Gmove_Open_Sx0
40419>>>>>>>>>>>
40419>>>>>>>>>>>        // Gmove.Gmove_Open_Sp0
40419>>>>>>>>>>>
40419>>>>>>>>>>>        // Gmove.Gmove_Open_Yx0
40419>>>>>>>>>>>
40419>>>>>>>>>>>        // Gmove.Gmove_Open_Yp0
40419>>>>>>>>>>>
40419>>>>>>>>>>>        // Gmove.Gmove_Open_Sx1
40419>>>>>>>>>>>
40419>>>>>>>>>>>        // Gmove.Gmove_Open_Sp1
40419>>>>>>>>>>>
40419>>>>>>>>>>>        // Gmove.Gmove_Open_Yx1
40419>>>>>>>>>>>
40419>>>>>>>>>>>        // Gmove.Gmove_Open_Yp1
40419>>>>>>>>>>>
40419>>>>>>>>>>>        // Gmove.Gmove_Open_Sx2
40419>>>>>>>>>>>
40419>>>>>>>>>>>        // Gmove.Gmove_Open_Sp2
40419>>>>>>>>>>>
40419>>>>>>>>>>>        // Gmove.Gmove_Open_Yx2
40419>>>>>>>>>>>
40419>>>>>>>>>>>        // Gmove.Gmove_Open_Yp2
40419>>>>>>>>>>>
40419>>>>>>>>>>>        // Gmove.Gmove_Sc_Code2
40419>>>>>>>>>>>        //DDB/ Comment_Short       Field Gmove.Gmove_Sc_Code2 To "à ¡æª ¤¦£å©£«¦ª ¡á¢¬¯ª ?"
40419>>>>>>>>>>>
40419>>>>>>>>>>>        // Gmove.Gmove_Open
40419>>>>>>>>>>>        //DDB/ Comment_Short       Field Gmove.Gmove_Open To "¤« ©«¦å® © ?"
40419>>>>>>>>>>>
40419>>>>>>>>>>>        // Gmove.Gmove_Aopen
40419>>>>>>>>>>>        //DDB/ Comment_Short       Field Gmove.Gmove_Aopen To "¬«æ£« ¤« ©«¦å® ©"
40419>>>>>>>>>>>
40419>>>>>>>>>>>        // Gmove.Gmove_Topen
40419>>>>>>>>>>>
40419>>>>>>>>>>>        // Gmove.Gmove_Kk
40419>>>>>>>>>>>
40419>>>>>>>>>>>        // Gmove.Gthhmgio_Period
40419>>>>>>>>>>>
40419>>>>>>>>>>>        // Gmove.Gplan_Yn_Myfp
40419>>>>>>>>>>>        Set Field_Value_Table      Field Gmove.Gplan_Yn_Myfp To (Gmove_Gplan_Yn_VT(Self))
40420>>>>>>>>>>>
40420>>>>>>>>>>>        // Gmove.Gplan_Yn_Myfa
40420>>>>>>>>>>>        Set Field_Value_Table      Field Gmove.Gplan_Yn_Myfa To (Gmove_Gplan_Yn_VT(Self))
40421>>>>>>>>>>>
40421>>>>>>>>>>>        // Gmove.Gplan_Myf_Sump
40421>>>>>>>>>>>
40421>>>>>>>>>>>        // Gmove.Gplan_Myf_Suma
40421>>>>>>>>>>>
40421>>>>>>>>>>>        // Gmove.Gtypkin_Flag01
40421>>>>>>>>>>>
40421>>>>>>>>>>>        // Gmove.Gtypkin_Flag02
40421>>>>>>>>>>>
40421>>>>>>>>>>>        // Gmove.Gtypkin_Flag03
40421>>>>>>>>>>>
40421>>>>>>>>>>>        // Gmove.Gtypkin_Flag04
40421>>>>>>>>>>>
40421>>>>>>>>>>>        // Gmove.Gtypkin_Flag05
40421>>>>>>>>>>>
40421>>>>>>>>>>>        // Gmove.Gtypkin_Flag06
40421>>>>>>>>>>>
40421>>>>>>>>>>>        // Gmove.Gtypkin_Flag07
40421>>>>>>>>>>>
40421>>>>>>>>>>>        // Gmove.Gtypkin_Flag08
40421>>>>>>>>>>>
40421>>>>>>>>>>>        // Gmove.Gtypkin_Flag09
40421>>>>>>>>>>>
40421>>>>>>>>>>>        // Gmove.Gtypkin_Flag10
40421>>>>>>>>>>>
40421>>>>>>>>>>>        // Gmove.Gtypkin_Flag11
40421>>>>>>>>>>>
40421>>>>>>>>>>>        // Gmove.Gtypkin_Flag12
40421>>>>>>>>>>>
40421>>>>>>>>>>>        // Gmove.Gtypkin_Flag13
40421>>>>>>>>>>>
40421>>>>>>>>>>>        // Gmove.Gtypkin_Flag14
40421>>>>>>>>>>>
40421>>>>>>>>>>>        // Gmove.Gtypkin_Flag15
40421>>>>>>>>>>>
40421>>>>>>>>>>>        // Gmove.Gtypkin_Flag16
40421>>>>>>>>>>>
40421>>>>>>>>>>>        // Gmove.Gtypkin_Flag17
40421>>>>>>>>>>>
40421>>>>>>>>>>>        // Gmove.Gtypkin_Flag18
40421>>>>>>>>>>>
40421>>>>>>>>>>>        // Gmove.Gtypkin_Flag19
40421>>>>>>>>>>>
40421>>>>>>>>>>>        // Gmove.Gtypkin_Flag20
40421>>>>>>>>>>>
40421>>>>>>>>>>>        // Gmove.Year_Recr
40421>>>>>>>>>>>
40421>>>>>>>>>>>        // Gmove.Gmove_Recr
40421>>>>>>>>>>>
40421>>>>>>>>>>>        //DDB-DefineFieldEnd
40421>>>>>>>>>>>    End_Procedure    // Define_Fields
40422>>>>>>>>>>>
40422>>>>>>>>>>>    // Field_Defaults:
40422>>>>>>>>>>>    // This procedure is used to establish default field values.
40422>>>>>>>>>>>
40422>>>>>>>>>>>    Procedure Field_Defaults
40423>>>>>>>>>>>        Forward Send Field_Defaults
40425>>>>>>>>>>>        //DDB-Generated-Code-Location
40425>>>>>>>>>>>        //DDB-FieldDefaultStart
40425>>>>>>>>>>>        //DDB-FieldDefaultEnd
40425>>>>>>>>>>>    End_Procedure    // Field_Defaults
40426>>>>>>>>>>>End_Class    // Gmove_DataDictionary
40427>>>>>>>>>>>//DDB-FileEnd
40427>>>>>>>>>Use Garticl.dd
40427>>>>>>>>>
40427>>>>>>>>>Object oDo_Change_Garticl is a BusinessProcessSub
40429>>>>>>>>>
40429>>>>>>>>>       Set Status_Panel_State  to False
40430>>>>>>>>>       Set Display_Error_State to True
40431>>>>>>>>>
40431>>>>>>>>>       Property Integer piCalling_Garticl_dd 0
40433>>>>>>>>>       Property Integer piError              0
40435>>>>>>>>>
40435>>>>>>>>>       //------------------------------------------------------------------ddo tree
40435>>>>>>>>>
40435>>>>>>>>>       Object Gthhmgio_DD is a Gthhmgio_DataDictionary
40437>>>>>>>>>       End_Object    // Gthhmgio_DD
40438>>>>>>>>>
40438>>>>>>>>>       Object Gtypkin_DD is a Gtypkin_DataDictionary
40440>>>>>>>>>           Set DDO_Server to (Gthhmgio_DD(Self))
40441>>>>>>>>>       End_Object    // Gtypkin_DD
40442>>>>>>>>>
40442>>>>>>>>>       Object Garticl_DD is a Garticl_DataDictionary
40444>>>>>>>>>           Set DDO_Server to (Gtypkin_DD(Self))
40445>>>>>>>>>       End_Object    // Garticl_DD
40446>>>>>>>>>
40446>>>>>>>>>       Object Gplan_DD is a Gplan_DataDictionary
40448>>>>>>>>>       End_Object    // Gplan_DD
40449>>>>>>>>>
40449>>>>>>>>>       Object Gmove_DD is a Gmove_DataDictionary
40451>>>>>>>>>           Set DDO_Server to (Gplan_DD(Self))
40452>>>>>>>>>           Set DDO_Server to (Garticl_DD(Self))
40453>>>>>>>>>           Procedure OnConstrain
40455>>>>>>>>>               Constrain Gmove Relates to Garticl
40456>>>>>>>>>           End_Procedure
40457>>>>>>>>>       End_Object    // Gmove_DD
40458>>>>>>>>>       //------------------------------------------------------------------ddo tree
40458>>>>>>>>>
40458>>>>>>>>>
40458>>>>>>>>>       Function   Trexe Integer liCalling_Garticl_dd Returns Integer
40460>>>>>>>>>                  Integer liError
40461>>>>>>>>>                  Set piCalling_Garticl_dd to liCalling_Garticl_dd
40462>>>>>>>>>                  Set piError to 0
40463>>>>>>>>>
40463>>>>>>>>>                  Send Private.Do_Cascade_Update
40464>>>>>>>>>                  //12/02/2000:Send DoProcess
40464>>>>>>>>>
40464>>>>>>>>>                  Get piError to liError
40465>>>>>>>>>                  Set piError to 0
40466>>>>>>>>>                  Function_Return liError
40467>>>>>>>>>       End_Function //trexe
40468>>>>>>>>>
40468>>>>>>>>>
40468>>>>>>>>>       Procedure Private.Do_Cascade_Update
40470>>>>>>>>>                 Integer liGtypkin_dd liGarticl_dd liGplan_dd liGmove_dd
40471>>>>>>>>>                 Integer liCurrent_Garticl_Recnum liCalling_Garticl_dd liErr
40471>>>>>>>>>
40471>>>>>>>>>                 String   lsB_Gtypkin_Recr     lsA_Gtypkin_Recr
40471>>>>>>>>>                 Date     ldB_Garticl_Hmnia    ldA_Garticl_Hmnia
40471>>>>>>>>>                 Integer  liB_Garticl_No       liA_Garticl_No
40471>>>>>>>>>                 String   lsB_Garticl_C_Code2  lsA_Garticl_C_Code2
40471>>>>>>>>>                 Number   lnB_Garticl_Rate0    lnA_Garticl_Rate0
40471>>>>>>>>>                 Number   lnB_Garticl_Rate00   lnA_Garticl_Rate00
40471>>>>>>>>>                 Number   lnB_Garticl_RateR    lnA_Garticl_RateR
40471>>>>>>>>>                 Integer  liB_Garticl_Aa       liA_Garticl_Aa
40471>>>>>>>>>
40471>>>>>>>>>                 Integer  liButton_id //  ¤ å®¤à ©« buttons «ª ®¦¨ã©ª/£¤ ©£¦ç /
40471>>>>>>>>>                                      //« gmove recnums
40471>>>>>>>>>                 Integer  liGmove_Counter
40471>>>>>>>>>
40471>>>>>>>>>                 //ç¨© ¡¢¦ç¤«¦ª ddo
40471>>>>>>>>>                 Get piCalling_Garticl_dd to liCalling_Garticl_dd
40472>>>>>>>>>
40472>>>>>>>>>                 //â¢®¦ª ¡¢¦ç¤«¦ª ddo (á¤ 0, ¡á¤«¤)
40472>>>>>>>>>                 If (liCalling_Garticl_dd = 0);                 Begin
40474>>>>>>>>>                      Set piError to 1001 //â¤ £ ¡á¢© ¡¤åª
40475>>>>>>>>>                      Procedure_Return
40476>>>>>>>>>                 End
40476>>>>>>>>>>
40476>>>>>>>>>
40476>>>>>>>>>                 //ç¨© current_record ¡¢¦ç¤«¦ª ddo
40476>>>>>>>>>                 Get Current_Record of liCalling_Garticl_dd to liCurrent_Garticl_Recnum
40477>>>>>>>>>
40477>>>>>>>>>                 //â¢®¦ª current_record (á¤ 0, ¡á¤«¤)
40477>>>>>>>>>                 If (liCurrent_Garticl_Recnum = 0);                 Begin
40479>>>>>>>>>                      Set piError to 1002 //«¦ ¡¢æ¤ ddo â¤ â®  current record
40480>>>>>>>>>                      Procedure_Return
40481>>>>>>>>>                 End
40481>>>>>>>>>>
40481>>>>>>>>>
40481>>>>>>>>>                 //¤á¤à© §¢ é¤ « £é¤ «¦¬ ¡¢¦ç¤«¦ª ddo
40481>>>>>>>>>                 Get psB_Gtypkin_Recr    of liCalling_Garticl_dd to lsB_Gtypkin_Recr
40482>>>>>>>>>                 Get pdB_Garticl_Hmnia   of liCalling_Garticl_dd to ldB_Garticl_Hmnia
40483>>>>>>>>>                 Get piB_Garticl_No      of liCalling_Garticl_dd to liB_Garticl_No
40484>>>>>>>>>                 Get psB_Garticl_C_Code2 of liCalling_Garticl_dd to lsB_Garticl_C_Code2
40485>>>>>>>>>                 Get pnB_Garticl_Rate0   of liCalling_Garticl_dd to lnB_Garticl_Rate0
40486>>>>>>>>>                 Get pnB_Garticl_Rate00  of liCalling_Garticl_dd to lnB_Garticl_Rate00
40487>>>>>>>>>                 Get pnB_Garticl_RateR   of liCalling_Garticl_dd to lnB_Garticl_RateR
40488>>>>>>>>>                 Get piB_Garticl_Aa      of liCalling_Garticl_dd to liB_Garticl_Aa
40489>>>>>>>>>
40489>>>>>>>>>                 //¤á¤à© ¤âà¤ « £é¤ «¦¬ ¡¢¦ç¤«¦ª ddo
40489>>>>>>>>>                 Get psA_Gtypkin_Recr    of liCalling_Garticl_dd to lsA_Gtypkin_Recr
40490>>>>>>>>>                 Get pdA_Garticl_Hmnia   of liCalling_Garticl_dd to ldA_Garticl_Hmnia
40491>>>>>>>>>                 Get piA_Garticl_No      of liCalling_Garticl_dd to liA_Garticl_No
40492>>>>>>>>>                 Get psA_Garticl_C_Code2 of liCalling_Garticl_dd to lsA_Garticl_C_Code2
40493>>>>>>>>>                 Get pnA_Garticl_Rate0   of liCalling_Garticl_dd to lnA_Garticl_Rate0
40494>>>>>>>>>                 Get pnA_Garticl_Rate00  of liCalling_Garticl_dd to lnA_Garticl_Rate00
40495>>>>>>>>>                 Get pnA_Garticl_RateR   of liCalling_Garticl_dd to lnA_Garticl_RateR
40496>>>>>>>>>                 Get piA_Garticl_Aa      of liCalling_Garticl_dd to liA_Garticl_Aa
40497>>>>>>>>>
40497>>>>>>>>>                 //á¤ æ¢ª ¦  §¨á£«¨¦  before+after å¤  å©ª,
40497>>>>>>>>>                 //«æ« â¤ £§å¤à ¡æ¢¦¬ ©«¦¤ ¡æ§¦ ¤ «¨â¥à,
40497>>>>>>>>>                 //¢¢á ­çà ...«¨â®¦¤«ª!
40497>>>>>>>>>                 If (;                      (lsB_Gtypkin_Recr   = lsA_Gtypkin_Recr   ) and;                      (ldB_Garticl_Hmnia  = ldA_Garticl_Hmnia  ) and;                      (liB_Garticl_No     = liA_Garticl_No     ) and;                      (lsB_Garticl_C_Code2= lsA_Garticl_C_Code2) and;                      (lnB_Garticl_Rate0  = lnA_Garticl_Rate0  ) and;                      (lnB_Garticl_Rate00 = lnA_Garticl_Rate00 ) and;                      (lnB_Garticl_RateR  = lnA_Garticl_RateR  ) and;                      (liB_Garticl_Aa     = liA_Garticl_Aa     )    ;                     ) Begin
40499>>>>>>>>>                        Procedure_Return
40500>>>>>>>>>                       End
40500>>>>>>>>>>
40500>>>>>>>>>
40500>>>>>>>>>                 //¤­¦¨¤«¢¢¬, §¨â§  ¤ «¨â¥à!
40500>>>>>>>>>
40500>>>>>>>>>                 //**************************************************************************
40500>>>>>>>>>                 //01.ç¨© object id's «à¤ £§¢¡¦£â¤à¤ ddo's
40500>>>>>>>>>                 //**************************************************************************
40500>>>>>>>>>                 Move (Garticl_dd(Self))  to liGarticl_dd
40501>>>>>>>>>                 Move (Gplan_dd  (Self))  to liGplan_dd
40502>>>>>>>>>                 Move (Gmove_dd (Self))   to liGmove_dd
40503>>>>>>>>>                 Move (Gtypkin_dd(Self))  to liGtypkin_dd
40504>>>>>>>>>
40504>>>>>>>>>                 Get piButton_id of liCalling_Garticl_dd to liButton_id
40505>>>>>>>>>                 Set piMode of liGarticl_dd to (piMode(liCalling_Garticl_dd)) //14/02/2000
40506>>>>>>>>>
40506>>>>>>>>>
40506>>>>>>>>>                 //**************************************************************************
40506>>>>>>>>>                 //02.rebuild constraints, ¢æà «à¤ ¡¢á©à¤
40506>>>>>>>>>                 //**************************************************************************
40506>>>>>>>>>                 Send Rebuild_Constraints to liGtypkin_dd
40507>>>>>>>>>                 Send Rebuild_Constraints to liGarticl_dd
40508>>>>>>>>>                 Send Rebuild_Constraints to liGplan_dd
40509>>>>>>>>>
40509>>>>>>>>>                 //**************************************************************************
40509>>>>>>>>>                 //03.ç¨© garticl
40509>>>>>>>>>                 //**************************************************************************
40509>>>>>>>>>                 Send Clear to liGarticl_dd
40510>>>>>>>>>                 Send Find_By_Recnum to liGarticl_dd Garticl.File_Number liCurrent_Garticl_Recnum
40511>>>>>>>>>                 If (Found = 0);                 Begin
40513>>>>>>>>>                      Set piError to 1003 //â¤ ¨â¡ «¦ original garticl
40514>>>>>>>>>                      Procedure_Return
40515>>>>>>>>>                 End
40515>>>>>>>>>>
40515>>>>>>>>>
40515>>>>>>>>>                 //**************************************************************************
40515>>>>>>>>>                 //04.©á¨à© Gmove
40515>>>>>>>>>                 //**************************************************************************
40515>>>>>>>>>                 Send Rebuild_Constraints to liGmove_dd
40516>>>>>>>>>                 Send Clear to liGmove_dd
40517>>>>>>>>>                 Send Request_Find to liGmove_dd FIRST_RECORD Gmove.File_Number 3 //garticl_recr+Gmove_recr
40518>>>>>>>>>                 While (Found=1)
40522>>>>>>>>>                        Increment liGmove_Counter
40523>>>>>>>>>
40523>>>>>>>>>                        If (liButton_id<>0);                        Begin //â®  ¡¢å §¦ ®¦¨ã©/£¤ ©£æ /
40525>>>>>>>>>                             Set Label of liButton_id to (;                                                           "¨­ã: "+;                                                           (String(liGmove_Counter));                                                         )
40526>>>>>>>>>                        End
40526>>>>>>>>>>
40526>>>>>>>>>
40526>>>>>>>>>                        Set Field_Changed_Value of liGmove_dd Field Gmove.Gmove_Kk to 1 //sosososo
40527>>>>>>>>>                        //Get Request_Validate of liGmove_dd to liErr
40527>>>>>>>>>                        //If (liErr<>0);
40527>>>>>>>>>                        //     Begin
40527>>>>>>>>>                        //      Set piError to 1004 //Gmove not valid!
40527>>>>>>>>>                        //      Procedure_Return
40527>>>>>>>>>                        //     End
40527>>>>>>>>>                        //Else Begin
40527>>>>>>>>>                              Send Request_Save to liGmove_dd
40528>>>>>>>>>                              Move (Err) to liErr
40529>>>>>>>>>                              If (liErr<>0) Begin
40531>>>>>>>>>                                             Set piError to 1105 //«¦ Gmoves â¤ ©é¡
40532>>>>>>>>>                                             Procedure_Return
40533>>>>>>>>>                                            End
40533>>>>>>>>>>
40533>>>>>>>>>                        //     End
40533>>>>>>>>>
40533>>>>>>>>>                        Send Request_Find to liGmove_dd NEXT_RECORD Gmove.File_Number 3 //garticl_recr+Gmove_recr
40534>>>>>>>>>                 Loop
40535>>>>>>>>>>
40535>>>>>>>>>                 //send check_arthro_for_ypol ( æ«  £§¦¨å ¤ ¢¢á¥   ©¦« £å !)
40535>>>>>>>>>       End_Procedure //private.do_cascade_update
40536>>>>>>>>>
40536>>>>>>>>>
40536>>>>>>>>>       Procedure OnProcess0
40538>>>>>>>>>                 Send Private.Do_Cascade_Update
40539>>>>>>>>>       End_Procedure //onprocess
40540>>>>>>>>>
40540>>>>>>>>>End_Object //odo_change_garticl
40541>>>>>>>>>
40541>>>>>>>>>//     Procedure Set_B_Values Integer  lsB_Gtypkin_Recr;
40541>>>>>>>>>//                            Date     ldB_Garticl_Hmnia;
40541>>>>>>>>>//                            Integer  liB_Garticl_No;
40541>>>>>>>>>//                            String   lsB_Garticl_C_Code2;
40541>>>>>>>>>//                            Number   lnB_Garticl_Rate0;
40541>>>>>>>>>//                            Number   lnB_Garticl_Rate00;
40541>>>>>>>>>//                            Number   lnB_Garticl_RateR;
40541>>>>>>>>>//                            Integer  liB_Garticl_Aa
40541>>>>>>>>>//
40541>>>>>>>>>//                Set psB_Gtypkin_Recr    to lsB_Gtypkin_Recr
40541>>>>>>>>>//                Set pdB_Garticl_Hmnia   to ldB_Garticl_Hmnia
40541>>>>>>>>>//                Set piB_Garticl_No      to liB_Garticl_No
40541>>>>>>>>>//                Set psB_Garticl_C_Code2 to lsB_Garticl_C_Code2
40541>>>>>>>>>//                Set pnB_Garticl_Rate0   to lnB_Garticl_Rate0
40541>>>>>>>>>//                Set pnB_Garticl_Rate00  to lnB_Garticl_Rate00
40541>>>>>>>>>//                Set pnB_Garticl_RateR   to lnB_Garticl_RateR
40541>>>>>>>>>//                Get piB_Garticl_Aa      to liB_Garticl_Aa
40541>>>>>>>>>//     End_Procedure //updatev1
40541>>>>>>>
40541>>>>>>>///////////////If ((Gtypkin.Gtypkin_Code ne Garticl.Gtypkin_Code) and (Current_Record(Srv##) ne 0)) Send Operation_Not_Allowedmove 129
40541>>>>>>>//                send pFindIsotimia Garticl.Garticl_C_Code2 Garticl.Garticl_Hmnia 0
40541>>>>>>>
40541>>>>>>>//           if Garticl.Garticl_AA gt 0 move 131 to iReturnVal SOS!!!
40541>>>>>>>//            move (fiValidateCheck_Save(self)) to iReturnVal
40541>>>>>>>
40541>>>>>>>
40541>>>>>>>
40541>>>>>>>//  Procedure Request_Save0
40541>>>>>>>//            Integer libpo_02
40541>>>>>>>//            Number lnRateBF lnRateAF
40541>>>>>>>//            String lsCurrBF lsCurrAF
40541>>>>>>>//
40541>>>>>>>//            Forward Send Request_Save
40541>>>>>>>//
40541>>>>>>>//            Get psCurrBF to lsCurrBF
40541>>>>>>>//            Get pnRateBF to lnRateBF
40541>>>>>>>//
40541>>>>>>>//            Get psCurrAF to lsCurrAF
40541>>>>>>>//            Get pnRateAF to lnRateAF
40541>>>>>>>//
40541>>>>>>>//
40541>>>>>>>//            If (;
40541>>>>>>>//                 (lnRateBF <> lnRateAF) or;
40541>>>>>>>//                 (lsCurrBF <> lsCurrAF);
40541>>>>>>>//                ) Begin
40541>>>>>>>//                   Move (oDoChangeKin(Self)) to liBpo_02
40541>>>>>>>//                   Send Change_Gtypkin_Code  to liBpo_02 lsCurrAF lnRateAF Garticl.Recnum
40541>>>>>>>//                  End
40541>>>>>>>//
40541>>>>>>>//            Set psCurrBF to ""
40541>>>>>>>//            Set pnRateBF to 0
40541>>>>>>>//
40541>>>>>>>//            Set psCurrAF to ""
40541>>>>>>>//            Set pnRateAF to 0
40541>>>>>>>//
40541>>>>>>>//            Set pnRateFind to 0
40541>>>>>>>//  End_Procedure   // Request_Save0
40541>>>>>>>
40541>>>>>>>
40541>>>>>>>
40541>>>>>>>//  Procedure Destroying0 //£á¢¢¦¤ â¤ ®¨ á« ,  æ«   creating «¦ ¡á¤  §¦ £æ¤ «ª
40541>>>>>>>//         Forward Send  Destroying
40541>>>>>>>//        //************************************************************************
40541>>>>>>>//        //flag 5:¬«æ£« ¨å£©                                               *
40541>>>>>>>//        //************************************************************************
40541>>>>>>>//        If (Gtypkin.Gtypkin_Flags Contains "-5-");
40541>>>>>>>//             Begin //«¦ á¨¨¦ â®  ¬«æ£« ¨å£©
40541>>>>>>>//              Set piA_Flag05 to TRUE
40541>>>>>>>//              Sub 1 to Gtypkin.Gtypkin_L_No
40541>>>>>>>//             End
40541>>>>>>>//        Else Begin //«¦ á¨¨¦ â®  ® ¨¦¡å¤« ¨å£©
40541>>>>>>>//              Set piA_Flag05 to FALSE
40541>>>>>>>//             End
40541>>>>>>>//  End_Procedure //Destroying0
40541>>>>>>>
40541>>>>>>>
40541>>>>>>>
40541>>>>>>>//    Function fiValidateCheck_Save  Returns Integer
40541>>>>>>>//        Local Integer iReturnVal
40541>>>>>>>//
40541>>>>>>>//                 if Garticl.Garticl_Hmnia   lt Year.Year_XrhshFrom Function_Return 131
40541>>>>>>>//            else if Garticl.Garticl_Hmnia   lt Year.Year_XrhshTo   Function_Return 131
40541>>>>>>>//            else if Garticl.Garticl_Hmnia   eq ""                  move 128 to ireturnVal
40541>>>>>>>//            else if Garticl.Garticl_Hmnia   lt Year.Year_DateAA    move 128 to ireturnVal //For Timologhsh
40541>>>>>>>//            else if Gtypkin.Gtypkin_Code    eq 0                   move 128 to ireturnVal //Gtypkin
40541>>>>>>>//            else if Garticl.Garticl_C_Code2 eq ""                  move 128 to ireturnVal //Currency
40541>>>>>>>//            else if Garticl.Garticl_Rate0   eq 0                   move 128 to ireturnVal //Isotimia
40541>>>>>>>//
40541>>>>>>>//        Function_Return iReturnVal
40541>>>>>>>//    End_Function
40541>>>>>>>
40541>>>>>>>////Procedure Set_ZeroAA Integer liStatusAA##
40541>>>>>>>////////Set piZeroAA to liStatusAA##
40541>>>>>>>////End_Procedure //set_zeroaa
40541>>>>>>>
40541>>>>>>>
40541>>>>>>>
40541>>>>>>>
40541>>>>>>>//DDB-Selection-pkg-Start
40541>>>>>>>
40541>>>>>>>Use Garticl.SL       // Garticl
INCLUDING FILE: GARTICL.SL
40541>>>>>>>>>//AB/ Project Garticl:Garticl
40541>>>>>>>>>//AB/ Object prj is a Lookup_Project
40541>>>>>>>>>//AB/     Set ProjectName to "Garticl:Garticl"
40541>>>>>>>>>//AB/     Set ProjectFileName to "Garticl.SL"
40541>>>>>>>>>
40541>>>>>>>>>// Project Object Structure
40541>>>>>>>>>//   Garticl is a dbModalPanelSub
40541>>>>>>>>>//     Gthhmgio_DD is a DataDictionary
40541>>>>>>>>>//     Gtypkin_DD is a DataDictionary
40541>>>>>>>>>//     Garticl_DD is a DataDictionary
40541>>>>>>>>>//     oSelList is a dbListSub
40541>>>>>>>>>//     oOK_bn is a ButtonSub
40541>>>>>>>>>//     oCancel_bn is a ButtonSub
40541>>>>>>>>>//     oSearch_bn is a ButtonSub
40541>>>>>>>>>
40541>>>>>>>>>// Register all objects
40541>>>>>>>>>Register_Object Garticl
40541>>>>>>>>>Register_Object Garticl_DD
40541>>>>>>>>>Register_Object Gthhmgio_DD
40541>>>>>>>>>Register_Object Gtypkin_DD
40541>>>>>>>>>Register_Object oCancel_bn
40541>>>>>>>>>Register_Object oOK_bn
40541>>>>>>>>>Register_Object oSearch_bn
40541>>>>>>>>>Register_Object oSelList
40541>>>>>>>>>
40541>>>>>>>>>
40541>>>>>>>>>//AB-IgnoreStart
40541>>>>>>>>>
40541>>>>>>>>>Use DFAllEnt.pkg
40541>>>>>>>>>Use dbList.Sub
40541>>>>>>>>>Use Button.Sub
40541>>>>>>>>>
40541>>>>>>>>>
40541>>>>>>>>>Use GTHHMGIO.DD
40541>>>>>>>>>Use GTYPKIN.DD
40541>>>>>>>>>Use GARTICL.DD
40541>>>>>>>>>
40541>>>>>>>>>//AB-IgnoreEnd
40541>>>>>>>>>
40541>>>>>>>>>CD_Popup_Object Garticl is a dbModalPanelSub
40560>>>>>>>>>
40560>>>>>>>>>    //AB-StoreTopStart
40560>>>>>>>>>    Property String psFragmaGtypkinRecr ''
40562>>>>>>>>>    
40562>>>>>>>>>    //AB-StoreTopEnd
40562>>>>>>>>>
40562>>>>>>>>>    Set Minimize_Icon to FALSE
40563>>>>>>>>>    Set Label to "å©« ¨¨à¤"
40564>>>>>>>>>    Set Size to 286 407
40565>>>>>>>>>    Set Location to 4 5
40566>>>>>>>>>    Set Exit_Application_Local_State to FALSE
40567>>>>>>>>>    Set Modal_State to FALSE
40568>>>>>>>>>
40568>>>>>>>>>    //AB-DDOStart
40568>>>>>>>>>
40568>>>>>>>>>    Object Gthhmgio_DD is a Gthhmgio_DataDictionary
40570>>>>>>>>>    End_Object    // Gthhmgio_DD
40571>>>>>>>>>
40571>>>>>>>>>    Object Gtypkin_DD is a Gtypkin_DataDictionary
40573>>>>>>>>>        Set DDO_Server to (Gthhmgio_DD(self))
40574>>>>>>>>>    End_Object    // Gtypkin_DD
40575>>>>>>>>>
40575>>>>>>>>>    Object Garticl_DD is a Garticl_DataDictionary
40577>>>>>>>>>        Set DDO_Server to (Gtypkin_DD(self))
40578>>>>>>>>>
40578>>>>>>>>>        //AB-StoreStart
40578>>>>>>>>>                
40578>>>>>>>>>        Procedure OnConstrain
40580>>>>>>>>>            String lsGtypkinRecr
40581>>>>>>>>>        
40581>>>>>>>>>            Get psFragmaGtypkinRecr to lsGtypkinRecr
40582>>>>>>>>>            If (lsGtypkinRecr <> 0) Constrain Garticl.Gtypkin_Recr eq lsGtypkinRecr
40586>>>>>>>>>        End_Procedure // OnConstrain
40587>>>>>>>>>        
40587>>>>>>>>>        //AB-StoreEnd
40587>>>>>>>>>
40587>>>>>>>>>    End_Object    // Garticl_DD
40588>>>>>>>>>
40588>>>>>>>>>    Set Main_DD to (Garticl_DD(self))
40589>>>>>>>>>    Set Server to (Garticl_DD(self))
40590>>>>>>>>>
40590>>>>>>>>>    //AB-DDOEnd
40590>>>>>>>>>
40590>>>>>>>>>    Object oSelList is a dbListSub
40592>>>>>>>>>        Set Main_File to Garticl.File_Number
40593>>>>>>>>>        Set Size to 247 393
40594>>>>>>>>>        Set Location to 6 6
40595>>>>>>>>>
40595>>>>>>>>>        Begin_Row
40598>>>>>>>>>            Entry_Item Garticl.Garticl_hmnia
40599>>>>>>>>>            Entry_Item Garticl.Gtypkin_code
40600>>>>>>>>>            Entry_Item Gthhmgio.Gthhmgio_code
40601>>>>>>>>>            Entry_Item Garticl.Garticl_recr
40602>>>>>>>>>            Entry_Item Gtypkin.Gtypkin_descr
40603>>>>>>>>>            Entry_Item Garticl.Garticl_aitiol
40604>>>>>>>>>        End_Row
40609>>>>>>>>>
40609>>>>>>>>>        Set Form_Width    item 0 to 53
40610>>>>>>>>>        Set Header_Label  item 0 to "£¨¦£¤å"
40611>>>>>>>>>        
40611>>>>>>>>>        Set Form_Width    item 1 to 37
40612>>>>>>>>>        Set Header_Label  item 1 to "å¤©"
40613>>>>>>>>>        
40613>>>>>>>>>        Set Form_Width    item 2 to 33
40614>>>>>>>>>        Set Header_Label  item 2 to "£/ ¦"
40615>>>>>>>>>        
40615>>>>>>>>>        Set Form_Width    item 3 to 50
40616>>>>>>>>>        Set Header_Label  item 3 to "¨.  ¨¨¦¬"
40617>>>>>>>>>        
40617>>>>>>>>>        Set Form_Width    item 4 to 100
40618>>>>>>>>>        Set Header_Label  item 4 to "¨©«« ¡æ"
40619>>>>>>>>>        
40619>>>>>>>>>        Set Form_Width    item 5 to 113
40620>>>>>>>>>        Set Header_Label  item 5 to " « ¦¢¦å"
40621>>>>>>>>>        
40621>>>>>>>>>
40621>>>>>>>>>        //AB-StoreStart
40621>>>>>>>>>                
40621>>>>>>>>>        Property String psStoreFragmaGtypkinRecr ''
40623>>>>>>>>>        
40623>>>>>>>>>        Procedure Store_Defaults
40625>>>>>>>>>            forward send Store_Defaults
40627>>>>>>>>>            Set psStoreFragmaGtypkinRecr to (psFragmaGtypkinRecr(Self))
40628>>>>>>>>>        end_Procedure // Store_Defaults
40629>>>>>>>>>        
40629>>>>>>>>>        Procedure Restore_Defaults
40631>>>>>>>>>            forward send Restore_Defaults
40633>>>>>>>>>            Set psFragmaGtypkinRecr to (psStoreFragmaGtypkinRecr(self))
40634>>>>>>>>>        end_Procedure // Restore_Defaults
40635>>>>>>>>>        
40635>>>>>>>>>        Procedure Activating
40637>>>>>>>>>            Forward Send Activating
40639>>>>>>>>>            Send Rebuild_Constraints to (Garticl_DD(self))
40640>>>>>>>>>        End_Procedure // Activating
40641>>>>>>>>>        
40641>>>>>>>>>        
40641>>>>>>>>>        //AB-StoreEnd
40641>>>>>>>>>
40641>>>>>>>>>    End_Object    // oSelList
40642>>>>>>>>>
40642>>>>>>>>>    Object oOK_bn is a ButtonSub
40644>>>>>>>>>        Set Label to "&§ ¢¦ã"
40645>>>>>>>>>        Set Location to 257 241
40646>>>>>>>>>
40646>>>>>>>>>        //AB-StoreStart
40646>>>>>>>>>        Procedure OnClick
40648>>>>>>>>>            Send OK To (oSelList(current_object))
40649>>>>>>>>>        End_Procedure
40650>>>>>>>>>        //AB-StoreEnd
40650>>>>>>>>>
40650>>>>>>>>>    End_Object    // oOK_bn
40651>>>>>>>>>
40651>>>>>>>>>    Object oCancel_bn is a ButtonSub
40653>>>>>>>>>        Set Label to "&¡ç¨à©"
40654>>>>>>>>>        Set Location to 257 294
40655>>>>>>>>>
40655>>>>>>>>>        //AB-StoreStart
40655>>>>>>>>>        Procedure OnClick
40657>>>>>>>>>            Send Cancel To (oSelList(current_object))
40658>>>>>>>>>        End_Procedure
40659>>>>>>>>>        //AB-StoreEnd
40659>>>>>>>>>
40659>>>>>>>>>    End_Object    // oCancel_bn
40660>>>>>>>>>
40660>>>>>>>>>    Object oSearch_bn is a ButtonSub
40662>>>>>>>>>        Set Label to "&¤ã«©..."
40663>>>>>>>>>        Set Location to 257 350
40664>>>>>>>>>
40664>>>>>>>>>        //AB-StoreStart
40664>>>>>>>>>        Procedure OnClick
40666>>>>>>>>>            Send Search To (oSelList(current_object))
40667>>>>>>>>>        End_Procedure
40668>>>>>>>>>        //AB-StoreEnd
40668>>>>>>>>>
40668>>>>>>>>>    End_Object    // oSearch_bn
40669>>>>>>>>>
40669>>>>>>>>>
40669>>>>>>>>>    //AB-StoreStart
40669>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
40670>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
40671>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
40672>>>>>>>>>    
40672>>>>>>>>>    procedure page integer pagemode
40674>>>>>>>>>        forward send page pagemode
40676>>>>>>>>>        set location to 40,40
40677>>>>>>>>>    end_procedure
40678>>>>>>>>>    
40678>>>>>>>>>    //AB-StoreEnd
40678>>>>>>>>>
40678>>>>>>>>>CD_End_Object    // Garticl
40680>>>>>>>>>>
40680>>>>>>>>>
40680>>>>>>>>>//AB/ End_Object    // prj
40680>>>>>>>
40680>>>>>>>//DDB-Selection-pkg-End
40680>>>>>>>//DDB-FileEnd
40680>>>>>Use Gplan.dd
40680>>>>>Use Gmove.dd
40680>>>>>Use Gopen.dd
INCLUDING FILE: GOPEN.DD
40680>>>>>>>//DDB-FileStart
40680>>>>>>>//DDB-HeaderStart
40680>>>>>>>
40680>>>>>>>// File Name : GOPEN.DD
40680>>>>>>>// Class Name: Gopen_DataDictionary
40680>>>>>>>// Revision  : 22
40680>>>>>>>// Version   : 2
40680>>>>>>>
40680>>>>>>>Use  Windows           // Basic Definitions
40680>>>>>>>Use  DataDict          // DataDictionary Class Definition
40680>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40680>>>>>>>
40680>>>>>>>Open Gopen
40682>>>>>>>Open Gmovea
40684>>>>>>>Open Sysrecg
40686>>>>>>>
40686>>>>>>>//DDB-HeaderEnd
40686>>>>>>>//DDB-ValidationStart
40686>>>>>>>
40686>>>>>>>Register_Object Gopen_Gopen_C_Code2_VT
40686>>>>>>>Register_Object Gopen_Gopen_M_Code_VT
40686>>>>>>>
40686>>>>>>>Object Gopen_Gopen_C_Code2_VT  is a CodeValidationTable
40688>>>>>>>    Set Type_Value        To "CURRENCY"
40689>>>>>>>    Set Allow_Blank_State To TRUE
40690>>>>>>>    //DDB-ValidationCustomStart
40690>>>>>>>    //DDB-ValidationCustomEnd
40690>>>>>>>End_Object   // Gopen_Gopen_C_Code2_VT
40691>>>>>>>
40691>>>>>>>Object Gopen_Gopen_M_Code_VT  is a CodeValidationTable
40693>>>>>>>    Set Type_Value        To "MODULE"
40694>>>>>>>    Set Allow_Blank_State To TRUE
40695>>>>>>>    //DDB-ValidationCustomStart
40695>>>>>>>    //DDB-ValidationCustomEnd
40695>>>>>>>End_Object   // Gopen_Gopen_M_Code_VT
40696>>>>>>>//DDB-ValidationEnd
40696>>>>>>>
40696>>>>>>>Class Gopen_DataDictionary  is a DataDictionary_Sec
40697>>>>>>>
40697>>>>>>>
40697>>>>>>>    Procedure Creating
40698>>>>>>>              Forward Send Creating
40700>>>>>>>              //Add 2               to Year.Year_NumGopen       //¨ £æª ©¬©®«å©à¤ «ª ®¨ã©ª
40700>>>>>>>              Move gs_Module_Code to Gopen.Gopen_M_Code       //module ¨­ãª
40701>>>>>>>            Move (Append('',((Trim(SysCurGL.Branch_Site))+;                             (Trim(String(Gopen.Gopen_Rec0)))))) to Gopen.Gopen_Recr
40702>>>>>>>    End_Procedure //creating
40703>>>>>>>
40703>>>>>>>
40703>>>>>>>    Procedure Deleting
40704>>>>>>>              Forward Send Deleting
40706>>>>>>>              //Sub 2             from Year.Year_NumGopen       //¨ £æª á¨¨à¤ «ª ®¨ã©ª
40706>>>>>>>    End_Procedure //deleting
40707>>>>>>>
40707>>>>>>>
40707>>>>>>>    Procedure Update
40708>>>>>>>              Forward Send Update
40710>>>>>>>              Add Gopen.Gopen_X0 to   Gmove.Gmove_Open_Sp0  //master § ©«à©
40711>>>>>>>              Add Gopen.Gopen_X0 to   Gmovea.Gmove_Open_Sx0 //alias  ®¨âà©
40712>>>>>>>              Add Gopen.Gopen_P0 to   Gmove.Gmove_Open_Sx0
40713>>>>>>>              Add Gopen.Gopen_P0 to   Gmovea.Gmove_Open_Sp0
40714>>>>>>>    End_Procedure //update
40715>>>>>>>
40715>>>>>>>
40715>>>>>>>    Procedure Backout
40716>>>>>>>              Forward Send Backout
40718>>>>>>>              Sub Gopen.Gopen_X0 from Gmove.Gmove_Open_Sp0
40719>>>>>>>              Sub Gopen.Gopen_X0 from Gmovea.Gmove_Open_Sx0
40720>>>>>>>              Sub Gopen.Gopen_P0 from Gmove.Gmove_Open_Sx0
40721>>>>>>>              Sub Gopen.Gopen_P0 from Gmovea.Gmove_Open_Sp0
40722>>>>>>>    End_Procedure //backout
40723>>>>>>>
40723>>>>>>>
40723>>>>>>>    Procedure Save_Main_File
40724>>>>>>>              Number  liX0 liP0
40725>>>>>>>              String  lsMaster lsAlias lsGopenRecr
40725>>>>>>>
40725>>>>>>>              Forward Send Save_Main_File
40727>>>>>>>
40727>>>>>>>              Move Gopen.Gmove_Recr    to lsMaster
40728>>>>>>>              Move Gopen.Gmovea_Recr   to lsAlias
40729>>>>>>>              Move Gopen.Gopen_X0      to liX0
40730>>>>>>>              Move Gopen.Gopen_P0      to liP0
40731>>>>>>>              Move Gopen.Gopen_Recr    to lsGopenRecr
40732>>>>>>>
40732>>>>>>>              Clear Gopen
40733>>>>>>>              Move lsAlias  to Gopen.Gmove_Recr
40734>>>>>>>              Move lsMaster to Gopen.Gmovea_Recr
40735>>>>>>>              Find Eq Gopen by Index.1 //Gmove_recr+Gmovea_recr
40736>>>>>>>>
40736>>>>>>>              Move liP0           to Gopen.Gopen_X0
40737>>>>>>>              Move liX0           to Gopen.Gopen_P0
40738>>>>>>>              Move gs_Module_Code to Gopen.Gopen_M_Code       //module ¨­ãª
40739>>>>>>>
40739>>>>>>>              Saverecord Gopen
40740>>>>>>>
40740>>>>>>>              Clear Gopen
40741>>>>>>>              Move lsGopenRecr to Gopen.Gopen_Recr
40742>>>>>>>              Find Eq Gopen By Index.2
40743>>>>>>>>
40743>>>>>>>              If (Found = 0) Send Operation_Not_Allowed 10001 //®¢©£â¤ á©, reindex «¦¬ gopen
40746>>>>>>>    End_Procedure   // save_main_file
40747>>>>>>>
40747>>>>>>>
40747>>>>>>>    Procedure Delete_Main_File
40748>>>>>>>              String  lsMaster lsAlias lsGopenRecr
40749>>>>>>>              Move Gopen.Gmove_Recr    to lsMaster
40750>>>>>>>              Move Gopen.Gmovea_Recr   to lsAlias
40751>>>>>>>
40751>>>>>>>              Forward Send Delete_Main_File
40753>>>>>>>
40753>>>>>>>              Clear Gopen
40754>>>>>>>              Move lsAlias  to Gopen.Gmove_Recr
40755>>>>>>>              Move lsMaster to Gopen.Gmovea_Recr
40756>>>>>>>              Find Eq Gopen by Index.1 //Gmove_recr+Gmovea_recr
40757>>>>>>>>
40757>>>>>>>              If (Found = 0) Send Operation_Not_Allowed 10002 //®¢©£â¤ á©, reindex «¦¬ gopen
40760>>>>>>>              Delete Gopen
40761>>>>>>>    End_Procedure   // delete_main_file
40762>>>>>>>
40762>>>>>>>
40762>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
40763>>>>>>>              String lsError_Message
40764>>>>>>>              Case Begin
40764>>>>>>>
40764>>>>>>>                   //§æ validate save
40764>>>>>>>                   Case (iError_Num = 1001)
40766>>>>>>>                        Move ("DDC 068:¡«á¢¢¢ ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        "¬©®â« © £æ¤¦¤ © ®¨âà© ã £æ¤¦¤ © §å©«à©!");                        to lsError_Message
40767>>>>>>>                   Case Break
40768>>>>>>>                   Case (iError_Num = 1002)
40771>>>>>>>                        Move ("DDC 068:¡«á¢¢¢ ¨­ã (¬«¨â¦¤ æ£ ©£ ¨ã©àª).\n\n"+;                        "¬©®â« © £æ¤¦¤ © ®¨âà© ã £æ¤¦¤ © §å©«à©!");                        to lsError_Message
40772>>>>>>>                   Case Break
40773>>>>>>>                   Case (iError_Num = 1003)
40776>>>>>>>                        Move ("DDC 068:¡«á¢¢¢ ¨­ã (æ£ ©£ Reporting).\n\n"+;                        "¬©®â« © £æ¤¦¤ © ®¨âà© ã £æ¤¦¤ © §å©«à©!");                        to lsError_Message
40777>>>>>>>                   Case Break
40778>>>>>>>                   Case (iError_Num = 1004)
40781>>>>>>>                        Move ("DDC 068:¡«á¢¢¢ ¨­ã (æ£ ©£  ¤ã©àª).\n\n"+;                        "¬©®â« © £æ¤¦¤ © ®¨âà© ã £æ¤¦¤ © §å©«à©!");                        to lsError_Message
40782>>>>>>>                   Case Break
40783>>>>>>>
40783>>>>>>>                   Case (iError_Num = 1009)
40786>>>>>>>                        Clear Codemast
40787>>>>>>>                        Move "MODULE" to Codemast.Type
40788>>>>>>>                        Move Gopen.Gopen_M_Code to Codemast.Code
40789>>>>>>>                        Find Eq Codemast by Index.1 //type+code
40790>>>>>>>>
40790>>>>>>>                        Move ("DDC 068:ç¤«  ¨­ã\n\n( ¬©®â« © «¨¦§¦§¦ å«  £æ¤¦¤ §æ "+;                        (Trim(Codemast.Description))+" )") to lsError_Message
40791>>>>>>>                   Case Break
40792>>>>>>>                   Case (iError_Num = 1100)
40795>>>>>>>                        Move "DDC 068: §¦¡«ã « ¨å-¨ã©" to lsError_Message
40796>>>>>>>                        Case Break
40797>>>>>>>
40797>>>>>>>                   //§æ validate delete
40797>>>>>>>                   Case (iError_Num = 2001)
40800>>>>>>>                        Clear Codemast
40801>>>>>>>                        Move "MODULE" to Codemast.Type
40802>>>>>>>                        Move Garticl.Garticl_M_Code to Codemast.Code
40803>>>>>>>                        Find Eq Codemast by Index.1 //type+code
40804>>>>>>>>
40804>>>>>>>                        Move ("DDC 068:ç¤«   ¨­ã!\n\n( ©¬©®â« ©  ¨á­«  £æ¤¦¤ §æ "+;                        (Trim(Codemast.Description))+" )") to lsError_Message
40805>>>>>>>                   Case Break
40806>>>>>>>                   Case (iError_Num = 2100)
40809>>>>>>>                        Move "DDC 068: §¦¡«ã « ¨å-¨ã©" to lsError_Message
40810>>>>>>>                        Case Break
40811>>>>>>>
40811>>>>>>>                   //â¢®¦  open items
40811>>>>>>>                   Case (iError_Num = 1101)
40814>>>>>>>                        Move ("DDC 068:¡«á¢¢¢ ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        "¦ ©¬©®« æ£¤¦ ®¨à©« ¡æ §¦©æ å¤  ¨¤« ¡æ !");                        to lsError_Message
40815>>>>>>>                   Case Break
40816>>>>>>>                   Case (iError_Num = 1102)
40819>>>>>>>                        Move ("DDC 068:¡«á¢¢¢ ¨­ã (ç¨ ¦ æ£ ©£ ¨ã©àª).\n\n"+;                        "¦ ©¬©®« æ£¤¦ § ©«à« ¡æ §¦©æ å¤  ¨¤« ¡æ !");                        to lsError_Message
40820>>>>>>>                   Case Break
40821>>>>>>>                   Case (iError_Num = 1103)
40824>>>>>>>                        Move ("DDC 068:¡«á¢¢¢ ¨­ã (¬«¨ç¦¤ æ£ ©£ ¨ã©àª).\n\n"+;                        "¦ ©¬©®« æ£¤¦ ®¨à©« ¡æ §¦©æ å¤  ¨¤« ¡æ !");                        to lsError_Message
40825>>>>>>>                   Case Break
40826>>>>>>>                   Case (iError_Num = 1104)
40829>>>>>>>                        Move ("DDC 068:¡«á¢¢¢ ¨­ã (¬«¨ç¦¤ æ£ ©£ ¨ã©àª).\n\n"+;                        "¦ ©¬©®« æ£¤¦ § ©«à« ¡æ §¦©æ å¤  ¨¤« ¡æ !");                        to lsError_Message
40830>>>>>>>                   Case Break
40831>>>>>>>                   Case (iError_Num = 1105)
40834>>>>>>>                        Move ("DDC 068:¡«á¢¢¢ ¨­ã (æ£ ©£ Reporting).\n\n"+;                        "¦ ©¬©®« æ£¤¦ ®¨à©« ¡æ §¦©æ å¤  ¨¤« ¡æ !");                        to lsError_Message
40835>>>>>>>                   Case Break
40836>>>>>>>                   Case (iError_Num = 1106)
40839>>>>>>>                        Move ("DDC 068:¡«á¢¢¢ ¨­ã (æ£ ©£ Reporting).\n\n"+;                        "¦ ©¬©®« æ£¤¦ § ©«à« ¡æ §¦©æ å¤  ¨¤« ¡æ !");                        to lsError_Message
40840>>>>>>>                   Case Break
40841>>>>>>>                   Case (iError_Num = 1107)
40844>>>>>>>                        Move ("DDC 068:¡«á¢¢¢ ¨­ã (æ£ ©£ ¨­ãª).\n\n"+;                        "¦ ©¬©®« æ£¤¦ ®¨à©« ¡æ §¦©æ å¤  ¨¤« ¡æ !");                        to lsError_Message
40845>>>>>>>                   Case Break
40846>>>>>>>                   Case (iError_Num = 1108)
40849>>>>>>>                        Move ("DDC 068:¡«á¢¢¢ ¨­ã (æ£ ©£ ¨­ãª).\n\n"+;                        "¦ ©¬©®« æ£¤¦ § ©«à« ¡æ §¦©æ å¤  ¨¤« ¡æ !");                        to lsError_Message
40850>>>>>>>
40850>>>>>>>                   //§æ save_main_file
40850>>>>>>>                   Case (iError_Num = 10001) //â¤ £§æ¨© ¤ ¥¤¨é gopen by recnum !
40853>>>>>>>                        Move ("DDC 068:Transaction Aborted! (¤ç§¨¡«¦ª ¨® ¡æª)\n\n"+;                              "¨¡¢¦ç£ «¨â¥« «¦¤ ¢ ¡æ ¢®¦ «ª «ª á©ª!") to lsError_Message
40854>>>>>>>                   Case Break
40855>>>>>>>                   //§æ delete_main_file
40855>>>>>>>                   Case (iError_Num = 10002) //â¤ £§æ¨© ¤ ¥¤¨é gopen by index.1 !
40858>>>>>>>                        Move ("DDC 068:Transaction Aborted! (¤ç§¨¡«¦ª ¨® ¡æª)\n\n"+;                              "¨¡¢¦ç£ «¨â¥« «¦¤ ¢ ¡æ ¢®¦ «ª «ª á©ª!") to lsError_Message
40859>>>>>>>                   Case Break
40860>>>>>>>
40860>>>>>>>                   Case Else
40860>>>>>>>                        Forward Send Operation_Not_Allowed iError_Num
40862>>>>>>>              Case End
40862>>>>>>>
40862>>>>>>>              Error iError_Num lsError_Message
40863>>>>>>>>
40863>>>>>>>    End_Procedure   //operation_not_allowed
40864>>>>>>>
40864>>>>>>>
40864>>>>>>>
40864>>>>>>>    //1001:gopen_x0  * gopen_p0  = 0 (â¤ § «¨â§«  © â¤ record ¤ â®à ¡  ®¨âà© ¡å §å©«à©)
40864>>>>>>>    //1002:gopen_x00 * gopen_p00 = 0 (â¤ § «¨â§«  © â¤ record ¤ â®à ¡  ®¨âà© ¡å §å©«à©)
40864>>>>>>>    //1003:gopen_xr  * gopen_pr  = 0 (â¤ § «¨â§«  © â¤ record ¤ â®à ¡  ®¨âà© ¡å §å©«à©)
40864>>>>>>>    //1004:gopen_x2  * gopen_p2  = 0 (â¤ § «¨â§«  © â¤ record ¤ â®à ¡  ®¨âà© ¡å §å©«à©)
40864>>>>>>>
40864>>>>>>>    //1009:m_code: ¨­ã § «¨â§«  £æ¤¦¤ §¦ ¦ module §¦¬ «¤ £ ¦ç¨©
40864>>>>>>>
40864>>>>>>>    //1100:cby = globals
40864>>>>>>>    //1101:gopen_x0  >=0
40864>>>>>>>    //1102:gopen_p0  >=0
40864>>>>>>>    //1103:gopen_p00 >=0
40864>>>>>>>    //1104:gopen_p00 >=0
40864>>>>>>>    //1105:gopen_pr  >=0
40864>>>>>>>    //1106:gopen_pr  >=0
40864>>>>>>>    //1107:gopen_p2  >=0
40864>>>>>>>    //1108:gopen_p2  >=0
40864>>>>>>>    Function Validate_Save Returns Integer
40865>>>>>>>             Integer iReturnVal
40866>>>>>>>             Forward Get Validate_Save to iReturnVal
40868>>>>>>>
40868>>>>>>>             If (Not(iReturnVal));             Begin
40870>>>>>>>              //â¢®¦  ®¨à§ ©«é©à¤
40870>>>>>>>              If (Not(Gopen.Gopen_X0 * Gopen.Gopen_P0 = 0)) Send Operation_Not_Allowed 1001
40873>>>>>>>              If (Not(Gopen.Gopen_X00* Gopen.Gopen_P00= 0)) Send Operation_Not_Allowed 1002
40876>>>>>>>              If (Not(Gopen.Gopen_Xr * Gopen.Gopen_Pr = 0)) Send Operation_Not_Allowed 1003
40879>>>>>>>              If (Not(Gopen.Gopen_X2 * Gopen.Gopen_P2 = 0)) Send Operation_Not_Allowed 1004
40882>>>>>>>
40882>>>>>>>              //1009:â¢®¦ª module ¨­ãª
40882>>>>>>>              If (Not(Gopen.Gopen_M_Code = gs_Module_Code)) Send Operation_Not_Allowed 1009
40885>>>>>>>
40885>>>>>>>              //1101-1108:â¢®¦  open items (æ¢ª ¦  ©¬©®«å© ª §¨â§  ¤ å¤  £ã ¨¤« ¡âª)
40885>>>>>>>              //          (gopen_x0  >= 0 ¡«¢
40885>>>>>>>              If (Not(Gopen.Gopen_X0  >= 0               )) Send Operation_Not_Allowed 1101
40888>>>>>>>              If (Not(Gopen.Gopen_P0  >= 0               )) Send Operation_Not_Allowed 1102
40891>>>>>>>              If (Not(Gopen.Gopen_X00 >= 0               )) Send Operation_Not_Allowed 1103
40894>>>>>>>              If (Not(Gopen.Gopen_P00 >= 0               )) Send Operation_Not_Allowed 1104
40897>>>>>>>              If (Not(Gopen.Gopen_XR  >= 0               )) Send Operation_Not_Allowed 1105
40900>>>>>>>              If (Not(Gopen.Gopen_PR  >= 0               )) Send Operation_Not_Allowed 1106
40903>>>>>>>              If (Not(Gopen.Gopen_X2  >= 0               )) Send Operation_Not_Allowed 1107
40906>>>>>>>              If (Not(Gopen.Gopen_P2  >= 0               )) Send Operation_Not_Allowed 1108
40909>>>>>>>
40909>>>>>>>             End //«â¢¦ª ¡é ¡ validation
40909>>>>>>>>
40909>>>>>>>
40909>>>>>>>             Function_Return iReturnVal
40910>>>>>>>    End_Function //validate_save
40911>>>>>>>
40911>>>>>>>
40911>>>>>>>    //2001: ©¬©®â« ©  ¨á­«  £æ¤¦¤ §¦ «¦ module §¦¬ «¦ £ ¦ç¨©
40911>>>>>>>    //2100:cby = globals
40911>>>>>>>    Function Validate_Delete  Returns Integer
40912>>>>>>>             Integer iReturnVal
40913>>>>>>>             Forward Get Validate_Delete  To iReturnVal
40915>>>>>>>             If (Not(iReturnVal));             Begin
40917>>>>>>>
40917>>>>>>>              //2001:â¢®¦ª module ¨­ãª
40917>>>>>>>              If (Not(Gopen.Gopen_M_Code = gs_Module_Code)) Send Operation_Not_Allowed 2001
40920>>>>>>>
40920>>>>>>>             End //«â¢¦ª ¡é ¡ validation
40920>>>>>>>>
40920>>>>>>>             Function_Return iReturnVal
40921>>>>>>>    End_Function   // validate_delete
40922>>>>>>>
40922>>>>>>>    //-----------------------------dubugging code
40922>>>>>>>    Procedure Request_Save
40923>>>>>>>              Integer liTemp
40924>>>>>>>              move 1 to liTemp    //  debugger break point
40925>>>>>>>              Forward Send Request_Save
40927>>>>>>>              move 2 to liTemp
40928>>>>>>>    End_Procedure //request_save
40929>>>>>>>    //-----------------------------dubugging code
40929>>>>>>>
40929>>>>>>>
40929>>>>>>>    // Define_Fields:
40929>>>>>>>    // This procedure is used to set up all data-dictionary rules.
40929>>>>>>>
40929>>>>>>>    Procedure Define_Fields
40930>>>>>>>        Forward Send Define_Fields
40932>>>>>>>        //DDB-Generated-Code-Location
40932>>>>>>>        //DDB-DefineFieldStart
40932>>>>>>>
40932>>>>>>>        Set Main_File            To Gopen.File_Number
40933>>>>>>>        Set Cascade_Delete_State To FALSE
40934>>>>>>>
40934>>>>>>>
40934>>>>>>>        // Parent (Server) file structure...............
40934>>>>>>>        Send Add_Server_File  Gmovea.File_Number
40935>>>>>>>
40935>>>>>>>        // External (System) file structure.............
40935>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
40936>>>>>>>
40936>>>>>>>        Define_Auto_Increment  Sysrecg.Gopen_Rec0  To Gopen.Gopen_Rec0
40939>>>>>>>
40939>>>>>>>        // Field-based properties.......................
40939>>>>>>>
40939>>>>>>>        // Gopen.Gmove_Recr
40939>>>>>>>
40939>>>>>>>        // Gopen.Gmovea_Recr
40939>>>>>>>
40939>>>>>>>        // Gopen.Gopen_X0
40939>>>>>>>        //DDB/ Comment_Short       Field Gopen.Gopen_X0 To "á¤« « ¡ã"
40939>>>>>>>
40939>>>>>>>        // Gopen.Gopen_P0
40939>>>>>>>        //DDB/ Comment_Short       Field Gopen.Gopen_P0 To "á¤« « ¡ã"
40939>>>>>>>
40939>>>>>>>        // Gopen.Gopen_X00
40939>>>>>>>
40939>>>>>>>        // Gopen.Gopen_P00
40939>>>>>>>
40939>>>>>>>        // Gopen.Gopen_Xr
40939>>>>>>>
40939>>>>>>>        // Gopen.Gopen_Pr
40939>>>>>>>
40939>>>>>>>        // Gopen.Gopen_X2
40939>>>>>>>
40939>>>>>>>        // Gopen.Gopen_P2
40939>>>>>>>
40939>>>>>>>        // Gopen.Gopen_C_Code2
40939>>>>>>>        Set Field_Value_Table      Field Gopen.Gopen_C_Code2 To (Gopen_Gopen_C_Code2_VT(Self))
40940>>>>>>>
40940>>>>>>>        // Gopen.Gopen_M_Code
40940>>>>>>>        //DDB/ Comment_Short       Field Gopen.Gopen_M_Code To "Module ¨­ãª"
40940>>>>>>>        Set Field_Class_Name       Field Gopen.Gopen_M_Code To "dbComboFormSub"
40941>>>>>>>        Set Field_Value_Table      Field Gopen.Gopen_M_Code To (Gopen_Gopen_M_Code_VT(Self))
40942>>>>>>>
40942>>>>>>>        // Gopen.Gopen_Rec0
40942>>>>>>>
40942>>>>>>>        // Gopen.Gopen_Recr
40942>>>>>>>
40942>>>>>>>        //DDB-DefineFieldEnd
40942>>>>>>>    End_Procedure    // Define_Fields
40943>>>>>>>
40943>>>>>>>    // Field_Defaults:
40943>>>>>>>    // This procedure is used to establish default field values.
40943>>>>>>>
40943>>>>>>>    Procedure Field_Defaults
40944>>>>>>>        Forward Send Field_Defaults
40946>>>>>>>        //DDB-Generated-Code-Location
40946>>>>>>>        //DDB-FieldDefaultStart
40946>>>>>>>        //DDB-FieldDefaultEnd
40946>>>>>>>    End_Procedure    // Field_Defaults
40947>>>>>>>End_Class    // Gopen_DataDictionary
40948>>>>>>>//DDB-FileEnd
40948>>>>>Use Gmovea.dd //®¨ á«  ¦§àã§¦«,  æ«  å¤  alias file ¡ 
40948>>>>>              //©«¤ begin_transaction §¨¦¡¢å deadlock
40948>>>>>
40948>>>>>Use Gbridgeh.dd //  «¤ external ¤£â¨à©, £â©à gbridge
INCLUDING FILE: GBRIDGEH.DD
40948>>>>>>>//DDB-FileStart
40948>>>>>>>//DDB-HeaderStart
40948>>>>>>>
40948>>>>>>>// File Name : GBRIDGEH.DD
40948>>>>>>>// Class Name: Gbridgeh_DataDictionary
40948>>>>>>>// Revision  : 20
40948>>>>>>>// Version   : 2
40948>>>>>>>
40948>>>>>>>Use  Windows           // Basic Definitions
40948>>>>>>>Use  DataDict          // DataDictionary Class Definition
40948>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40948>>>>>>>
40948>>>>>>>Open Gbridgeh
INCLUDING FILE: GBRIDGEH.FD
40950>>>>>>>Open Gbridged
INCLUDING FILE: GBRIDGED.FD
40952>>>>>>>Open Sysrecg
40954>>>>>>>
40954>>>>>>>//DDB-HeaderEnd
40954>>>>>>>//DDB-ValidationStart
40954>>>>>>>
40954>>>>>>>Register_Object Gbridgeh_Gbridgeh_M_Code_VT
40954>>>>>>>
40954>>>>>>>Object Gbridgeh_Gbridgeh_M_Code_VT  is a CodeValidationTable
40956>>>>>>>    Set Type_Value        To "MODULE"
40957>>>>>>>    //DDB-ValidationCustomStart
40957>>>>>>>    //DDB-ValidationCustomEnd
40957>>>>>>>End_Object   // Gbridgeh_Gbridgeh_M_Code_VT
40958>>>>>>>//DDB-ValidationEnd
40958>>>>>>>
40958>>>>>>>Register_Object oDo_GL_Maintainance //  ¢æ¦¬ª compilation
40958>>>>>>>Use doGlMntn.Bp                     //¤£â¨à© ¤ ¡ãª ¢¦ ©« ¡ãª
40958>>>>>>>
40958>>>>>>>
40958>>>>>>>Class Gbridgeh_DataDictionary  is a DataDictionary_Sec
40959>>>>>>>
40959>>>>>>>     Procedure Creating
40960>>>>>>>            Forward Send Creating
40962>>>>>>>            Move (Append('',((Trim(SysCurGL.Branch_Site))+;                             (Trim(String(Gbridgeh.Gbridgeh_Rec0)))))) to Gbridgeh.Gbridgeh_Recr
40963>>>>>>>    End_Procedure //creating
40964>>>>>>>
40964>>>>>>>      Procedure Construct_Object
40965>>>>>>>                Forward Send Construct_Object
40967>>>>>>>
40967>>>>>>>
40967>>>>>>>                Property  Integer piDo_GL_Maintainance       0 //object id «ª business process
40968>>>>>>>                                                               //§¦¬ ¤£¨é¤  «ã¤ ¤ ¡ã ¢¦ ©« ¡ã
40968>>>>>>>                Property  Integer piDo_CUSTOMER_Maintainance 0 //object id «ª business process
40969>>>>>>>                                                               //§¦¬ ¤£¨é¤  «¦¬ª §¢á«ª
40969>>>>>>>                Property  Integer piDo_VENDOR_Maintainance   0 //object id «ª business process
40970>>>>>>>                                                               //§¦¬ ¤£¨é¤  «¦¬ª §¨¦£¬«âª
40970>>>>>>>      End_Procedure //construct_object
40971>>>>>>>
40971>>>>>>>
40971>>>>>>>      Procedure End_Construct_Object
40972>>>>>>>                Forward Send End_Construct_Object
40974>>>>>>>
40974>>>>>>>                //object id «ª business process §¦¬ ¤£¨é¤  «¤ ¤ ¡ã ¢¦ ©« ¡ã
40974>>>>>>>                Set piDo_GL_Maintainance       to (oDo_GL_Maintainance      (Self))
40975>>>>>>>
40975>>>>>>>                //object id «ª business process §¦¬ ¤£¨é¤  «¦¬ª §¢á«ª
40975>>>>>>>//--------------Set piDo_CUSTOMER_Maintainance to (oDo_CUSTOMER_Maintainance(Self))
40975>>>>>>>
40975>>>>>>>                //object id «ª business process §¦¬ ¤£¨é¤  «¦¬ª §¨¦£¬«âª
40975>>>>>>>//------------->Set piDo_VENDOR_Maintainance   to (oDo_VENDOR_Maintainance  (Self))
40975>>>>>>>      End_Procedure   //end_construct_object
40976>>>>>>>
40976>>>>>>>
40976>>>>>>>      Procedure Test_Me
40977>>>>>>>                String lsGbridgeh_Recr
40978>>>>>>>                Get Field_Current_Value Field Gbridgeh.Gbridgeh_Recr to lsGbridgeh_Recr
40979>>>>>>>                Send Transaction_Update_GL_From_Gbridge to (piDo_GL_Maintainance(Self)) (Self);                                                                        lsGbridgeh_Recr;                                                                        0;                                                                        0;                                                                        0;                                                                        1
40980>>>>>>>      End_Procedure
40981>>>>>>>
40981>>>>>>>
40981>>>>>>>
40981>>>>>>>
40981>>>>>>>    // Define_Fields:
40981>>>>>>>    // This procedure is used to set up all data-dictionary rules.
40981>>>>>>>
40981>>>>>>>    Procedure Define_Fields
40982>>>>>>>        Forward Send Define_Fields
40984>>>>>>>        //DDB-Generated-Code-Location
40984>>>>>>>        //DDB-DefineFieldStart
40984>>>>>>>
40984>>>>>>>        Set Main_File            To Gbridgeh.File_Number
40985>>>>>>>
40985>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
40986>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
40987>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
40988>>>>>>>
40988>>>>>>>        // Child (Client) file structure................
40988>>>>>>>        Send Add_Client_File  Gbridged.File_Number
40989>>>>>>>
40989>>>>>>>        // External (System) file structure.............
40989>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_NEW_SAVE
40990>>>>>>>
40990>>>>>>>        Define_Auto_Increment  Sysrecg.Gbridgeh_Rec0  To Gbridgeh.Gbridgeh_Rec0
40993>>>>>>>
40993>>>>>>>        // Field-based properties.......................
40993>>>>>>>
40993>>>>>>>        // Gbridgeh.Gbridgeh_Rec0
40993>>>>>>>
40993>>>>>>>        // Gbridgeh.Company_Code
40993>>>>>>>
40993>>>>>>>        // Gbridgeh.Branch_Code
40993>>>>>>>
40993>>>>>>>        // Gbridgeh.Year_Year
40993>>>>>>>
40993>>>>>>>        // Gbridgeh.Particle_Recnum
40993>>>>>>>
40993>>>>>>>        // Gbridgeh.Garticl_Recr
40993>>>>>>>
40993>>>>>>>        // Gbridgeh.Gtypkin_Recr
40993>>>>>>>
40993>>>>>>>        // Gbridgeh.Garticl_Hmnia
40993>>>>>>>
40993>>>>>>>        // Gbridgeh.Garticl_No
40993>>>>>>>
40993>>>>>>>        // Gbridgeh.Garticl_Aitiol
40993>>>>>>>
40993>>>>>>>        // Gbridgeh.Garticl_C_Code2
40993>>>>>>>
40993>>>>>>>        // Gbridgeh.Garticl_Rate0
40993>>>>>>>
40993>>>>>>>        // Gbridgeh.Garticl_Rate00
40993>>>>>>>
40993>>>>>>>        // Gbridgeh.Garticl_Rater
40993>>>>>>>
40993>>>>>>>        // Gbridgeh.Gbridgeh_Flag
40993>>>>>>>        Set Field_Checkbox_Values  Field Gbridgeh.Gbridgeh_Flag To "1"  "0"
40994>>>>>>>        Set Field_Label_Long       Field Gbridgeh.Gbridgeh_Flag To "®  £«­¨å"
40995>>>>>>>        Set Field_Label_Short      Field Gbridgeh.Gbridgeh_Flag To "®  £«­¨å"
40996>>>>>>>        Set Status_Help            Field Gbridgeh.Gbridgeh_Flag To "§¦¢é¤  á¤  ¨­ã â®  ¤£¨é©  «¤ ¤.¦ ©« ¡ã"
40997>>>>>>>
40997>>>>>>>        // Gbridgeh.Gbridgeh_M_Code
40997>>>>>>>        Set Field_Value_Table      Field Gbridgeh.Gbridgeh_M_Code To (Gbridgeh_Gbridgeh_M_Code_VT(Self))
40998>>>>>>>
40998>>>>>>>        // Gbridgeh.Gbridgeh_Recr
40998>>>>>>>
40998>>>>>>>        // Gbridgeh.Year_Recr
40998>>>>>>>
40998>>>>>>>        // Gbridgeh.Module_From
40998>>>>>>>
40998>>>>>>>        // Gbridgeh.Ptyppar_Code
40998>>>>>>>
40998>>>>>>>        // Gbridgeh.Client_Id
40998>>>>>>>
40998>>>>>>>        //DDB-DefineFieldEnd
40998>>>>>>>    End_Procedure    // Define_Fields
40999>>>>>>>
40999>>>>>>>    // Field_Defaults:
40999>>>>>>>    // This procedure is used to establish default field values.
40999>>>>>>>
40999>>>>>>>    Procedure Field_Defaults
41000>>>>>>>        Forward Send Field_Defaults
41002>>>>>>>        //DDB-Generated-Code-Location
41002>>>>>>>        //DDB-FieldDefaultStart
41002>>>>>>>        //DDB-FieldDefaultEnd
41002>>>>>>>    End_Procedure    // Field_Defaults
41003>>>>>>>
41003>>>>>>>End_Class    // Gbridgeh_DataDictionary
41004>>>>>>>//DDB-FileEnd
41004>>>>>Use Gbridged.dd //  «¤ external ¤£â¨à©, £â©à gbridge
INCLUDING FILE: GBRIDGED.DD
41004>>>>>>>//DDB-FileStart
41004>>>>>>>//DDB-HeaderStart
41004>>>>>>>
41004>>>>>>>// File Name : GBRIDGED.DD
41004>>>>>>>// Class Name: Gbridged_DataDictionary
41004>>>>>>>// Revision  : 6
41004>>>>>>>// Version   : 2
41004>>>>>>>
41004>>>>>>>Use  Windows           // Basic Definitions
41004>>>>>>>Use  DataDict          // DataDictionary Class Definition
41004>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41004>>>>>>>
41004>>>>>>>Open Gbridged
41006>>>>>>>Open Gbridgeh
41008>>>>>>>
41008>>>>>>>//DDB-HeaderEnd
41008>>>>>>>
41008>>>>>>>Class Gbridged_DataDictionary  is a DataDictionary_Sec
41009>>>>>>>
41009>>>>>>>    // Define_Fields:
41009>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41009>>>>>>>
41009>>>>>>>    Procedure Define_Fields
41010>>>>>>>        Forward Send Define_Fields
41012>>>>>>>        //DDB-Generated-Code-Location
41012>>>>>>>        //DDB-DefineFieldStart
41012>>>>>>>
41012>>>>>>>        Set Main_File            To Gbridged.File_Number
41013>>>>>>>        Set Cascade_Delete_State To FALSE
41014>>>>>>>
41014>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41015>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41016>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41017>>>>>>>
41017>>>>>>>        // Parent (Server) file structure...............
41017>>>>>>>        Send Add_Server_File  Gbridgeh.File_Number
41018>>>>>>>
41018>>>>>>>        // Field-based properties.......................
41018>>>>>>>
41018>>>>>>>        // Gbridged.Gbridgeh_Recr
41018>>>>>>>
41018>>>>>>>        // Gbridged.Gplan_Recr
41018>>>>>>>
41018>>>>>>>        // Gbridged.Gmove_X2
41018>>>>>>>
41018>>>>>>>        // Gbridged.Gmove_P2
41018>>>>>>>
41018>>>>>>>        // Gbridged.Gmove_Aitiol
41018>>>>>>>
41018>>>>>>>        // Gbridged.Ext_Gplan_Code
41018>>>>>>>
41018>>>>>>>        // Gbridged.Gmove_Recr
41018>>>>>>>
41018>>>>>>>        //DDB-DefineFieldEnd
41018>>>>>>>    End_Procedure    // Define_Fields
41019>>>>>>>
41019>>>>>>>    // Field_Defaults:
41019>>>>>>>    // This procedure is used to establish default field values.
41019>>>>>>>
41019>>>>>>>    Procedure Field_Defaults
41020>>>>>>>        Forward Send Field_Defaults
41022>>>>>>>        //DDB-Generated-Code-Location
41022>>>>>>>        //DDB-FieldDefaultStart
41022>>>>>>>        //DDB-FieldDefaultEnd
41022>>>>>>>    End_Procedure    // Field_Defaults
41023>>>>>>>
41023>>>>>>>End_Class    // Gbridged_DataDictionary
41024>>>>>>>//DDB-FileEnd
41024>>>>>
41024>>>>>//Use Statlog.pkg //creates object named status_log
41024>>>>>
41024>>>>>
41024>>>>>Object oDo_GL_Maintainance is a BusinessProcessSub
41026>>>>>
41026>>>>>       Set Status_Panel_State  to False
41027>>>>>       Set Display_Error_State to False
41028>>>>>
41028>>>>>       Property Integer piError          0 //error code
41030>>>>>       Property Integer piStop           0
41032>>>>>
41032>>>>>
41032>>>>>       Property Integer piWhat_to_Do     0 //«  ¦¬¢ á  ¡á¤à: 1=®¦¨ã© /
41034>>>>>                                           //                    2=£¤ ©£æª /
41034>>>>>                                           //                    3=¤£â¨à© gmove §æ bmove
41034>>>>>                                           //                    4=¤£â¨à© gmove §æ cmove
41034>>>>>                                           //                    5=¤£â¨à© gmove §æ vmove
41034>>>>>                                           //                    6=¤£â¨à© gmove §æ wmove
41034>>>>>                                           //                    7=reupdate  ©¦ç  ¤ ¡ãª ¢¦ ©« ¡ãª
41034>>>>>
41034>>>>>
41034>>>>>       Property Integer piGthhmgio_Code  0 //  «¤ ®¦¨ã© ¡  £¤ ©£æ /
41036>>>>>       Property Date    pdApo_Hmnia      0 //  «¤ ®¦¨ã© /
41038>>>>>       Property Date    pdEos_Hmnia      0 //  «¤ ®¦¨ã© /
41040>>>>>
41040>>>>>       Property String  psGarticl_Recr  '' //  «¤  ¨­ã/ æ¨à© «¦¬ garticl
41042>>>>>       Property Integer piFlag02         0 //  «¤  ¨­ã/ æ¨à© «¦¬ garticl & «¤ ¤£â¨à© «à¤ gmoves
41044>>>>>       Property Integer piFlag03         0 //  «¤  ¨­ã/ æ¨à© «¦¬ garticl & «¤ ¤£â¨à© «à¤ gmoves
41046>>>>>       Property Integer piFlag04         0 //  «¤  ¨­ã/ æ¨à© «¦¬ garticl & «¤ ¤£â¨à© «à¤ gmoves
41048>>>>>       Property Integer piFlag05         0 //  «¤  ¨­ã/ æ¨à© «¦¬ garticl & «¤ ¤£â¨à© «à¤ gmoves
41050>>>>>
41050>>>>>       Property Integer piCalling_dd     0 //  «¤ ¤£â¨à© §æ á¢¢ modules
41052>>>>>
41052>>>>>       Property String  psGbridgeh_Recr '' //  «¤ ¤£â¨à© «ª ¢ §¦ gbridge
41054>>>>>                                           //®¨© £ç  ©¤ flag §¦¬ ¬§¦¢é¤ 
41054>>>>>                                           //á¤  å¤  batch  ã online ¤£â¨à©
41054>>>>>                                           //  0  = batch ¤£â¨à©
41054>>>>>                                           // >0  = online ¤£â¨à©   «¦ gbridgeh_recr
41054>>>>>
41054>>>>>       //7:reudate gl
41054>>>>>       Property String psYear_Recr     ''
41056>>>>>
41056>>>>>                               // todo:
41056>>>>>       Object Auxilliary_Object is An Array
41058>>>>>              Property String  psB_Garticl_Recr
41060>>>>>              Property String  psB_Gtypkin_Recr
41062>>>>>              Property Date    pdB_Garticl_Hmnia
41064>>>>>              Property Integer piB_Garticl_No
41066>>>>>              Property String  psB_Garticl_C_Code2
41068>>>>>              Property Number  pnB_Garticl_Rate0
41070>>>>>              Property Number  pnB_Garticl_Rate00
41072>>>>>              Property Number  pnB_Garticl_RateR
41074>>>>>              Property String  psB_Garticl_Aitiol
41076>>>>>
41076>>>>>              Property String  psB_Gmove_Master_Recr
41078>>>>>              Property String  psB_Gplan_Master_Recr
41080>>>>>              Property Number  pnB_Gmove_Master_X2
41082>>>>>              Property Number  pnB_Gmove_Master_P2
41084>>>>>              Property String  psB_Gmove_Master_Aitiol
41086>>>>>
41086>>>>>              Property String  psB_Gmove_Slave_Recr
41088>>>>>              Property String  psB_Gplan_Slave_Recr
41090>>>>>              Property Number  pnB_Gmove_Slave_X2
41092>>>>>              Property Number  pnB_Gmove_Slave_P2
41094>>>>>              Property String  psB_Gmove_Slave_Aitiol
41096>>>>>
41096>>>>>              Property String  psA_Garticl_Recr
41098>>>>>              Property String  psA_Gtypkin_Recr
41100>>>>>              Property Date    pdA_Garticl_Hmnia
41102>>>>>              Property Integer piA_Garticl_No
41104>>>>>              Property String  psA_Garticl_C_Code2
41106>>>>>              Property Number  pnA_Garticl_Rate0
41108>>>>>              Property Number  pnA_Garticl_Rate00
41110>>>>>              Property Number  pnA_Garticl_RateR
41112>>>>>              Property String  psA_Garticl_Aitiol
41114>>>>>
41114>>>>>              Property String  psA_Gmove_Master_Recr
41116>>>>>              Property String  psA_Gplan_Master_Recr
41118>>>>>              Property Number  pnA_Gmove_Master_X2
41120>>>>>              Property Number  pnA_Gmove_Master_P2
41122>>>>>              Property String  psA_Gmove_Master_Aitiol
41124>>>>>
41124>>>>>              Property String  psA_Gmove_Slave_Recr
41126>>>>>              Property String  psA_Gplan_Slave_Recr
41128>>>>>              Property Number  pnA_Gmove_Slave_X2
41130>>>>>              Property Number  pnA_Gmove_Slave_P2
41132>>>>>              Property String  psA_Gmove_Slave_Aitiol
41134>>>>>
41134>>>>>              Property Integer piGarticl_Delete
41136>>>>>              Property Integer piGarticl_Edit
41138>>>>>              Property Integer piGarticl_Create
41140>>>>>              Property Integer piMaster_Gmove_Delete
41142>>>>>              Property Integer piMaster_Gmove_Edit
41144>>>>>              Property Integer piMaster_Gmove_Create
41146>>>>>              Property Integer piSlave_Gmove_Delete
41148>>>>>              Property Integer piSlave_Gmove_Edit
41150>>>>>              Property Integer piSlave_Gmove_Create
41152>>>>>
41152>>>>>
41152>>>>>              //final values,   «ã¤ feedback ¤£â¨à© «¦¬ ¡¢¦ç¤«¦ª ddo
41152>>>>>              Property String  psF_Garticl_Recr
41154>>>>>              Property String  psF_Gmove_Master_Recr
41156>>>>>              Property String  psF_Gmove_Slave_Recr
41158>>>>>
41158>>>>>
41158>>>>>
41158>>>>>       End_Object //auxilliary_object
41159>>>>>
41159>>>>>       //------------------------------------------------------------------ddo tree start
41159>>>>>
41159>>>>>       Object Gthhmgio_DD is a Gthhmgio_DataDictionary
41161>>>>>       End_Object    // Gthhmgio_DD
41162>>>>>
41162>>>>>       Object Gtypkin_DD is a Gtypkin_DataDictionary
41164>>>>>           Set DDO_Server to (Gthhmgio_DD(Self))
41165>>>>>       End_Object    // Gtypkin_DD
41166>>>>>
41166>>>>>       Object Garticl_DD is a Garticl_DataDictionary
41168>>>>>           Set DDO_Server to (Gtypkin_DD(Self))
41169>>>>>
41169>>>>>           Procedure OnConstrain
41171>>>>>                     Integer liMode liGthhmgio_Code
41172>>>>>                     Date    ldApo_Hmnia ldEos_Hmnia
41172>>>>>                     Get piMode          to liMode
41173>>>>>                     Get piGthhmgio_Code to liGthhmgio_Code
41174>>>>>                     Get pdApo_Hmnia     to ldApo_Hmnia
41175>>>>>                     Get pdEos_Hmnia     to ldEos_Hmnia
41176>>>>>
41176>>>>>                     Case Begin
41176>>>>>                              //Case ((liMode = 1) or (liMode = 2)) //®¦¨ã© / ã £¤ ©£æª /
41176>>>>>                              Case (liMode = 1)                  //®¦¨ã© /
41178>>>>>                                    Set ordering to 4 //index.4:garticl:company_code+
41179>>>>>                                                      //                branch_code+
41179>>>>>                                                      //                year_year+
41179>>>>>                                                      //                gthhmgio_code+
41179>>>>>                                                      //                garticl_hmnia+
41179>>>>>                                                      //                gtypkin_code+
41179>>>>>                                                      //                garticl_no+
41179>>>>>                                                      //                garticl_recr
41179>>>>>                                    Constrain Garticl.Gthhmgio_Code Eq liGthhmgio_Code
41181>>>>>                                    Constrain Garticl.Garticl_Hmnia Ge ldApo_Hmnia
41183>>>>>                                    Constrain Garticl.Garticl_Hmnia Le ldEos_Hmnia
41185>>>>>                              Case Break
41186>>>>>                     Case End
41186>>>>>           End_Procedure //onconstrain
41187>>>>>
41187>>>>>
41187>>>>>           //14/02/2000:á¡¬¨¦¤ !
41187>>>>>           //augmented class method
41187>>>>>           Function private.fiCheck_Garticl_Aa0 Returns Integer
41189>>>>>                    Function_Return 0
41190>>>>>           End_Function //private.ficheck_garticl_aa
41191>>>>>
41191>>>>>       End_Object    // Garticl_DD
41192>>>>>
41192>>>>>       Object Gplan_DD is a Gplan_DataDictionary
41194>>>>>       End_Object    // Gplan_DD
41195>>>>>
41195>>>>>       Object Gmove_DD is a Gmove_DataDictionary
41197>>>>>           Set DDO_Server to (Gplan_DD(Self))
41198>>>>>           Set DDO_Server to (Garticl_DD(Self))
41199>>>>>
41199>>>>>           Procedure OnConstrain
41201>>>>>                     Constrain Gmove Relates to Garticl
41202>>>>>           End_Procedure
41203>>>>>
41203>>>>>
41203>>>>>          //augmented class method 11/02/2000:â¤ ¬§á¨®  ¬«ã ©«¤ ¡¢á©!
41203>>>>>           Function private.fiCheck_Gmove_Aa Returns Integer
41205>>>>>                    Function_Return 0
41206>>>>>           End_Function //private.ficheck_Gmove_aa
41207>>>>>
41207>>>>>
41207>>>>>           //12/02/2000
41207>>>>>           //«¢ ¡á « §¨¡á«à å¤  á¡¬¨,  æ« 
41207>>>>>           //®¨© £¦§¦å© procedural £â¦¦
41207>>>>>           //augmented class method
41207>>>>>           //æ«¤ «¨â®   reupdate, £¤å  §¨é« «¦¬ª ¨¦ ©«âª
41207>>>>>           //¡  £«á ©«â¢¤  request save.
41207>>>>>           //  ¤ ¤£¨à¦ç¤ ©à©«á ¦  ¨¦ ©«âª, §¨â§  ¤ "¡¦§å"  backout !
41207>>>>>           Procedure Backout0
41209>>>>>                     If ((piWhat_to_Do(Self)) = 7) Procedure_Return
41212>>>>>                     Forward Send Backout
41214>>>>>           End_Procedure
41215>>>>>
41215>>>>>
41215>>>>>       End_Object    // Gmove_DD
41216>>>>>
41216>>>>>       //¬«æ ®¨ á«  £æ¤¦¤   «¦ cascade delete «¦¬ garticl,
41216>>>>>       //§¦ «¤ private.Transaction_BCVWmove_Update_GL
41216>>>>>       Object Gopen_DD is a Gopen_DataDictionary
41218>>>>>           Set DDO_Server to (Gmove_DD(Self))
41219>>>>>           Procedure OnConstrain
41221>>>>>                     Constrain Gopen Relates to Gmove
41222>>>>>           End_Procedure
41223>>>>>
41223>>>>>           Procedure End_Construct_Object
41225>>>>>                     Forward Send End_Construct_Object
41227>>>>>                     Send Remove_Server_File Gmovea.File_Number
41228>>>>>           End_Procedure //end_construct_object
41229>>>>>
41229>>>>>
41229>>>>>       End_Object    // Gopen_DD
41230>>>>>       //------------------------------------------------------------------ddo tree end
41230>>>>>
41230>>>>>
41230>>>>>
41230>>>>>
41230>>>>>
41230>>>>>
41230>>>>>
41230>>>>>       //****************************************************************************
41230>>>>>       //*                     P R I V A T E    I N T E R F A C E                   *
41230>>>>>       //****************************************************************************
41230>>>>>       Procedure Private.Rebuild_All_Constraints
41232>>>>>                 Send Rebuild_Constraints to (Gtypkin_dd(Self))
41233>>>>>                 Send Rebuild_Constraints to (Gplan_dd  (Self))
41234>>>>>                 Send Rebuild_Constraints to (Garticl_dd(Self))
41235>>>>>                 Send Rebuild_Constraints to (Gmove_dd  (Self))
41236>>>>>                 Send Rebuild_Constraints to (Gopen_dd  (Self))
41237>>>>>       End_Procedure //private.rebuild_all_constraints
41238>>>>>
41238>>>>>
41238>>>>>       Procedure Operation_Not_Allowed Integer liError_Num
41240>>>>>                 String lsError_Message
41241>>>>>
41241>>>>>                 Get Old_Error_Object_id to Error_Object_id // restore previous error object
41242>>>>>                 Set Old_Error_Object_id to 0
41243>>>>>
41243>>>>>                 Case Begin
41243>>>>>                      //§æ private.xorigise_aa
41243>>>>>                      Case (liError_Num = 1001)
41245>>>>>                           Move ("BPO GLMNTN:¤ç§¨¡« ¨ã©\n\n"+;                                 "¨¡¢¦ç£ «¨â¥« ¦¢ ¡æ â¢®¦ «ª á©ª!") to lsError_Message
41246>>>>>                      Case Break
41247>>>>>                      Case (liError_Num = 1002)
41250>>>>>                           Move ("BPO GLMNTN:§á¨®¦¬¤ £ «¢ã á¨¨\n\n"+;                                 " §¨â§  ¤  ¦¨à¦ç¤!") to lsError_Message
41251>>>>>                      Case Break
41252>>>>>                      Case (liError_Num = 1003)
41255>>>>>                           Move ("BPO GLMNTN:©¬£­à¤å «¢¬«åª £/¤å à¨.£¨¦¢¦åà¤ £ «¦ ¨®å¦ á¨¨à¤\n\n"+;                                 "¨¡¢¦ç£ «¨â¥« reupdate «ª ¤ ¡ãª ¦ ©« ¡ãª!") to lsError_Message
41256>>>>>                      Case Break
41257>>>>>                      Case (liError_Num = 1004)
41260>>>>>                           Move ("BPO GLMNTN:©¬£­à¤å «¢¬«å¦¬ / à¨.£¨¦¢¦åà¤ £ «¦ ¨®å¦ á¨¨à¤\n\n"+;                                 "¨¡¢¦ç£ «¨â¥« reupdate «ª ¤ ¡ãª ¦ ©« ¡ãª!") to lsError_Message
41261>>>>>                      Case Break
41262>>>>>                      Case (liError_Num = 1005)
41265>>>>>                           Move ("BPO GLMNTN: £/¤å §¦¬ é©« å¤  §¨¦¤â©«¨ §¦ «¤ «¢¬«å £/¤å ®¦¨ã©ª /\n\n"+;                                 "¨¡¢¦ç£ é©« §¦¡«ã £/¤å!") to lsError_Message
41266>>>>>                      Case Break
41267>>>>>
41267>>>>>
41267>>>>>
41267>>>>>                      //§æ private.transaction_BCVWmove_update_gl
41267>>>>>                      Case (liError_Num = 3001)
41270>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Calling Object id = 0)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41271>>>>>                      Case Break
41272>>>>>                      Case (liError_Num = 3002)
41275>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Calling Current Record = 0)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41276>>>>>                      Case Break
41277>>>>>                      Case (liError_Num = 3003)
41280>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Wrong Booleans)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41281>>>>>                      Case Break
41282>>>>>                      Case (liError_Num = 3004)
41285>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Negative Booleans)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41286>>>>>                      Case Break
41287>>>>>                      Case (liError_Num = 3005)
41290>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (update=0 + backout=0)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41291>>>>>                      Case Break
41292>>>>>                      Case (liError_Num = 3006)
41295>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Delete with B records = 0)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41296>>>>>                      Case Break
41297>>>>>                      Case (liError_Num = 3007)
41300>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Delete with A records <> 0)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41301>>>>>                      Case Break
41302>>>>>                      Case (liError_Num = 3008)
41305>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Create with A records = 0)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41306>>>>>                      Case Break
41307>>>>>                      Case (liError_Num = 3009)
41310>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Check Edit <> 0)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41311>>>>>                      Case Break
41312>>>>>                      Case (liError_Num = 3010)
41315>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Create Garticl = FALSE)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41316>>>>>                      Case Break
41317>>>>>                      Case (liError_Num = 3011)
41320>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Gtypkin NOT Found)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41321>>>>>                      Case Break
41322>>>>>                      Case (liError_Num = 3012)
41325>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Garticl Current Record = 0)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41326>>>>>                      Case Break
41327>>>>>                      Case (liError_Num = 3013)
41330>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Create Gmove1 = FALSE)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41331>>>>>                      Case Break
41332>>>>>                      Case (liError_Num = 3014)
41335>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Gplan1 NOT Found)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41336>>>>>                      Case Break
41337>>>>>                      Case (liError_Num = 3015)
41340>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Delete Gmove1)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41341>>>>>                      Case Break
41342>>>>>                      Case (liError_Num = 3016)
41345>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Gmove1 Current Record = 0)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41346>>>>>                      Case Break
41347>>>>>                      Case (liError_Num = 3017)
41350>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Create Gmove2 = FALSE)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41351>>>>>                      Case Break
41352>>>>>                      Case (liError_Num = 3018)
41355>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Gplan2 NOT Found)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41356>>>>>                      Case Break
41357>>>>>                      Case (liError_Num = 3019)
41360>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Delete Gmove2 = FALSE)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41361>>>>>                      Case Break
41362>>>>>                      Case (liError_Num = 3020)
41365>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Gmove2 Current Record = 0)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41366>>>>>                      Case Break
41367>>>>>                      Case (liError_Num = 3021)
41370>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (  ¡ ¤ã© ª â¤ å¤  ¦£¦ åª!)\n\n"+;                                 " flags 2,3,4,5 §¨â§  ¤ ©¬®¨¦¤ ©¦ç¤ © æ¢ « modules!") to lsError_Message
41371>>>>>                      Case Break
41372>>>>>
41372>>>>>                      //§æ private.transaction_delete_garticl
41372>>>>>                      Case (liError_Num = 4001)
41375>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Calling Object id = 0)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41376>>>>>                      Case Break
41377>>>>>                      Case (liError_Num = 4002)
41380>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Calling Current Record = 0)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41381>>>>>                      Case Break
41382>>>>>                      Case (liError_Num = 4003)
41385>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (â¤ ¨â¡ «¦ ¬§æ  ¨­ã á¨¨¦ «ª !)\n\n"+;                                 "¨¡¢¦ç£ «¨â¥« «¦¤ ¢ ¡æ ¢®¦ «ª «ª á©ª!") to lsError_Message
41386>>>>>                      Case Break
41387>>>>>                      Case (liError_Num = 4004)
41390>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (  ¡ ¤ã© ª â¤ å¤  ¦£¦ åª!)\n\n"+;                                 " flags 2,3,4,5 §¨â§  ¤ ©¬®¨¦¤ ©¦ç¤ © æ¢ « modules!") to lsError_Message
41391>>>>>                      Case Break
41392>>>>>
41392>>>>>                      //§æ private.transaction_update_garticl
41392>>>>>                      Case (liError_Num = 5001)
41395>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Calling Object id = 0)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41396>>>>>                      Case Break
41397>>>>>                      Case (liError_Num = 5002)
41400>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Calling Current Record = 0)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41401>>>>>                      Case Break
41402>>>>>                      Case (liError_Num = 5003)
41405>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (â¤ ¨â¡ «¦ ¬§æ  æ¨à© á¨¨¦ «ª !)\n\n"+;                                 "¨¡¢¦ç£ «¨â¥« «¦¤ ¢ ¡æ ¢®¦ «ª «ª á©ª!") to lsError_Message
41406>>>>>                      Case Break
41407>>>>>                      Case (liError_Num = 5004)
41410>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (  ¡ ¤ã© ª â¤ å¤  ¦£¦ åª!)\n\n"+;                                 " flags 2,3,4,5 §¨â§  ¤ ©¬®¨¦¤ ©¦ç¤ © æ¢ « modules!") to lsError_Message
41411>>>>>                      Case Break
41412>>>>>
41412>>>>>                      //6:§æ private.Transaction_Update_GL_From_Gbridge
41412>>>>>                      Case (liError_Num = 6001)
41415>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Calling Object id = 0)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41416>>>>>                      Case Break
41417>>>>>                      Case (liError_Num = 6011)
41420>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Gtypkin NOT Found)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41421>>>>>                      Case Break
41422>>>>>                      Case (liError_Num = 6014)
41425>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (Gplan NOT Found)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41426>>>>>                      Case Break
41427>>>>>                      Case (liError_Num = 6021)
41430>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (  ¡ ¤ã© ª â¤ å¤  ¦£¦ åª!)\n\n"+;                                 " flags 2,3,4,5 §¨â§  ¤ ©¬®¨¦¤ ©¦ç¤ © æ¢ « modules!") to lsError_Message
41431>>>>>                      Case Break
41432>>>>>                      Case (liError_Num = 6022) //year not found
41435>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! ¤ç§¨¡«¦ª ¡à ¡æª « ¨åª/¨ã©àª!)\n\n"+;                                 "") to lsError_Message
41436>>>>>                      Case Break
41437>>>>>                      Case (liError_Num = 6023)
41440>>>>>                           Move ("BPO GLMNTN:Transaction Aborted!)\n\n"+;                                 "¨¡¢¦ç£ «¨â¥« «¦¤ ¢ ¡æ ¢®¦ «ª «ª á©ª") to lsError_Message
41441>>>>>                      Case Break
41442>>>>>                      Case (liError_Num = 6024) //gbridgeh not found
41445>>>>>                           Move ("BPO GLMNTN:Transaction Aborted!)\n\n"+;                                 "¨¡¢¦ç£ «¨â¥« «¦¤ ¢ ¡æ ¢®¦ «ª «ª á©ª") to lsError_Message
41446>>>>>                      Case Break
41447>>>>>
41447>>>>>
41447>>>>>                      Case Else
41447>>>>>                           Move ("BPO GLMNTN:Transaction Aborted! (No Error Text Available)\n\n"+;                                 "¨¡¢¦ç£ «¢­à¤ã©« ©«¤ Solution!") to lsError_Message
41448>>>>>                 Case End
41448>>>>>
41448>>>>>                 Error liError_Num lsError_Message
41449>>>>>>
41449>>>>>
41449>>>>>       End_Procedure //operation_not_allowed
41450>>>>>
41450>>>>>
41450>>>>>       //private
41450>>>>>       //¡¢å«  §¦ æ¢ª « ª functions «¦¬ public interface ¡  £¤å  æ¢ « properties
41450>>>>>       Procedure private.Initialize_Properties
41452>>>>>                 Set piError          to 0
41453>>>>>                 Set piStop           to 0
41454>>>>>
41454>>>>>                 Set piWhat_to_Do     to 0
41455>>>>>
41455>>>>>                 Set piGthhmgio_Code  to 0
41456>>>>>                 Set pdApo_Hmnia      to 0
41457>>>>>                 Set pdEos_Hmnia      to 0
41458>>>>>
41458>>>>>                 Set piCalling_dd     to 0
41459>>>>>
41459>>>>>                 Set psGarticl_Recr   to ''
41460>>>>>                 Set piFlag02         to 0
41461>>>>>                 Set piFlag03         to 0
41462>>>>>                 Set piFlag04         to 0
41463>>>>>                 Set piFlag05         to 0
41464>>>>>
41464>>>>>                 Set psGbridgeh_Recr  to ''
41465>>>>>
41465>>>>>
41465>>>>>                //7:reudate gl
41465>>>>>                Set psYear_Recr       to ''
41466>>>>>
41466>>>>>       End_Procedure //private.initialize_properties
41467>>>>>
41467>>>>>
41467>>>>>       //****************************************************************************
41467>>>>>       //* 1 :                    /                                   *
41467>>>>>       //****************************************************************************
41467>>>>>       //private
41467>>>>>       //1:¨¦¬«å¤ ®¦¨ã©ª /
41467>>>>>       Procedure private.Xorigise_Aa Integer liGthhmgio_Code;                                     Date    ldEos_Hmnia
41469>>>>>                 Integer liGtypkin_dd liGarticl_dd
41470>>>>>                 Integer liErr
41470>>>>>                 Integer liLast_Gthaa_AA     liLast_Garticl_aa    liAa        liCheck_Aa
41470>>>>>                 Date    ldLast_Gthaa_Hmnia  ldLast_Garticl_Hmnia ldApo_Hmnia
41470>>>>>                 Date    ldYear_XrhshFrom ldYear_XrhshTo
41470>>>>>                 Integer liNumber_of_Garticls1 liNumber_of_Garticls2 liGarticl_Recnum
41470>>>>>                 Integer liStop
41470>>>>>                 Number  lnPercent
41470>>>>>
41470>>>>>
41470>>>>>
41470>>>>>
41470>>>>>                 //*******
41470>>>>>                 LOCK
41471>>>>>>
41471>>>>>                 //*******
41471>>>>>
41471>>>>>
41471>>>>>
41471>>>>>
41471>>>>>                 //**************************************************************************
41471>>>>>                 //1-01:ç¨© object id's «à¤ £§¢¡¦£â¤à¤ ddo's
41471>>>>>                 //**************************************************************************
41471>>>>>                 Move (Gtypkin_dd(Self)) to liGtypkin_dd
41472>>>>>                 Move (Garticl_dd(Self)) to liGarticl_dd
41473>>>>>
41473>>>>>                 //**************************************************************************
41473>>>>>                 //1-02:ç¨© year, £¨¦£¤åª ¤á¨¥àª ¡  ¢ã¥àª ®¨ã©àª ¡  â¢®¦ª
41473>>>>>                 //     ¡«á©«©ª ©¬©«ã£«¦ª
41473>>>>>                 //**************************************************************************
41473>>>>>                 Move SyscurGL.Year_XrhshFrom to ldYear_XrhshFrom
41474>>>>>                 Move SyscurGL.Year_XrhshTo   to ldYear_XrhshTo
41475>>>>>
41475>>>>>                 //if system not ready for aa set pierror to 1000
41475>>>>>                 //lock system for aa
41475>>>>>
41475>>>>>                 //**************************************************************************
41475>>>>>                 //1-03:â¢®¦  data integrity, §¨å¤ §¨¦®à¨ã©à ©«¤ ®¦¨ã© 
41475>>>>>                 //**************************************************************************
41475>>>>>
41475>>>>>                 //1-03.01:  ¢æ¦¬ª ©­¢åª ¡  data integrity,  ¢â¥à á¤  £/¤å
41475>>>>>                 //      ¡  ¦ / §¦ç â®  «¦ ¨®å¦ gthaa ©¬£­à¤å £ «¦ garticl !
41475>>>>>
41475>>>>>                 //ç¨© «ª «¢¬«åª £¨¦£¤åª ®¦¨ã©ª / ¡  «¦¬ «¢¬«å¦¬ /
41475>>>>>                 // ©«¦ à¨£â¤¦ £¨¦¢æ ¦ (§¦ «¦ gthaa)
41475>>>>>                 Move (private.fdGthaa_Last_Hmnia(liGarticl_dd,liGthHmgio_Code)) to ldLast_Gthaa_Hmnia
41476>>>>>                 Move (private.fiGthaa_Last_Aa   (liGarticl_dd,liGthHmgio_Code)) to liLast_Gthaa_Aa
41477>>>>>
41477>>>>>                 //ç¨© «ª «¢¬«åª £¨¦£¤åª ®¦¨ã©ª / ¡  «¦¬ «¢¬«å¦¬ /
41477>>>>>                 // ©«¦ à¨£â¤¦ £¨¦¢æ ¦ (§¦ «¦ garticl, á©  «¦¬ index.4 company_code+
41477>>>>>                 //                                                             branch_code+
41477>>>>>                 //                                                             year_year+
41477>>>>>                 //                                                             gthhmgio_code+
41477>>>>>                 //                                                             garticl_hmnia+
41477>>>>>                 //                                                             gtypkin_vode+
41477>>>>>                 //                                                             garticl_no+
41477>>>>>                 //                                                             garticl_recr
41477>>>>>                 Clear Garticl
41478>>>>>                 Move SysCurGL.Company_Code  to Garticl.Company_Code
41479>>>>>                 Move SysCurGL.Branch_Code   to Garticl.Branch_Code
41480>>>>>                 Move SysCurGL.Year_Year     to Garticl.Year_Year
41481>>>>>                 Move liGthhmgio_Code        to Garticl.Gthhmgio_Code
41482>>>>>                 Move ldEos_Hmnia              to Garticl.Garticl_Hmnia
41483>>>>>                 Move 999999                   to Garticl.Gtypkin_Code   //n 6.0
41484>>>>>                 Move 99999999999999           to Garticl.Garticl_No     //n14.0
41485>>>>>                 Move 'éééééééééééé'           to Garticl.Garticl_Recr   //a12
41486>>>>>                 Find Lt Garticl by Index.4 //index.4:garticl:company_code+
41487>>>>>>
41487>>>>>                                            //                branch_code+
41487>>>>>                                            //                year_year+
41487>>>>>                                            //                gthhmgio_code+
41487>>>>>                                            //                garticl_hmnia+
41487>>>>>                                            //                gtypkin_code+
41487>>>>>                                            //                garticl_no+
41487>>>>>                                            //                garticl_recr
41487>>>>>                 While (;                        (Found = 1)                                         and;                        (Garticl.Company_Code   = gs_Selected_Company_Code) and;                        (Garticl.Branch_Code    = gs_Selected_Branch_Code ) and;                        (Garticl.Year_Year      = gi_Selected_Year        ) and;                        (Garticl.Gthhmgio_Code  = liGthhmgio_Code         ) and;                        (Garticl.Garticl_Hmnia <= ldEos_Hmnia             ) and;                        (Garticl.Garticl_Aa     = 0                       )    ;                       )
41491>>>>>
41491>>>>>                        Get Cancel_Check to liStop
41492>>>>>                        If (liStop <> 0) Begin
41494>>>>>                                          UNLOCK
41495>>>>>>
41495>>>>>                                          Procedure_Return
41496>>>>>                                         End
41496>>>>>>
41496>>>>>
41496>>>>>                        Send Update_Status ("¢®¦ª ¨¨à¤:"+;                                            (String(Garticl.Gtypkin_Code)) +"-"+;                                            (String(Garticl.Garticl_Hmnia))+"-"+;                                            (String(Garticl.Garticl_No   ))+"-"+ ;                                            (String(Garticl.Garticl_AA   ))+"-"+ ;                                            (String(Garticl.Recnum));                                           )
41497>>>>>
41497>>>>>                        //1-03.02:§å©ª,  ¢â¥à æ«  æ¢ « garticls §¦¬ §¨æ¡ «  ¤ §á¨¦¬¤ 
41497>>>>>                        //å¤  ok, ¢ã â®¦¬¤ =0 ¡å status=0
41497>>>>>                        If (Not(Garticl.Garticl_Statuse = 0));                        Begin
41499>>>>>                             UNLOCK
41500>>>>>>
41500>>>>>                             Set piError to 1002
41501>>>>>                             Send Operation_Not_Allowed 1002 //"¨¦©¦®ã! §á¨®¦¬¤ £ «¢ã ¨¨!"
41502>>>>>                             Procedure_Return
41503>>>>>                        End
41503>>>>>>
41503>>>>>
41503>>>>>                        Increment liNumber_of_Garticls1
41504>>>>>
41504>>>>>                        Find Lt Garticl by Index.4 //idex.4:garticl:company_code+
41505>>>>>>
41505>>>>>                                                   //               branch_code+
41505>>>>>                                                   //               year_year+
41505>>>>>                                                   //               gthhmgio_code+
41505>>>>>                                                   //               garticl_hmnia+
41505>>>>>                                                   //               gtypkin_code+
41505>>>>>                                                   //               garticl_no+
41505>>>>>                                                   //               garticl_recr
41505>>>>>                 Loop
41506>>>>>>
41506>>>>>
41506>>>>>                 //« §¨¡á«à  ©®ç¦¬¤   «¦ «¢¬«å¦ find lt, «¦ ¦§¦å¦ £¦¬ å®¤ 
41506>>>>>                 //á¤ «¦ £¨¦¢æ ¦ â®  ¥¤§á¨  , ã å¤   §¨é« ­¦¨á.
41506>>>>>                 If (;                     (Found = 1)                                         and;                     (Garticl.Company_Code   = SysCurGL.Company_Code) and;                     (Garticl.Branch_Code    = SysCurGL.Branch_Code ) and;                     (Garticl.Year_Year      = SysCurGL.Year_Year   ) and;                     (Garticl.Gthhmgio_Code  = liGthhmgio_Code      ) and;                     (Garticl.Garticl_Hmnia <= ldEos_Hmnia          ) and;                     (Garticl.Garticl_Aa    <> 0                    )    ;                    );                 Begin //¨ã¡ «¤ «¢¬«å ¨­ã «¦¬ å ¦¬ £¨¦¢¦å¦¬, §¦¬ â®  /
41508>>>>>                   Move Garticl.Garticl_Aa    to liLast_Garticl_Aa
41509>>>>>                   Move Garticl.Garticl_Hmnia to ldLast_Garticl_Hmnia
41510>>>>>                   Move Garticl.Recnum        to liGarticl_Recnum
41511>>>>>                 End
41511>>>>>>
41511>>>>>                 Else;                 Begin //«¦ ©¬¡¡¨ £â¤¦ £¨¦¢æ ¦ â¤ â®  §á¨  £â®¨  «é¨ /
41512>>>>>                   Move 0                     to liLast_Garticl_Aa
41513>>>>>                   Move ldYear_XrhshFrom      to ldLast_Garticl_Hmnia
41514>>>>>                   Move 0                     to liGarticl_Recnum
41515>>>>>                 End
41515>>>>>>
41515>>>>>
41515>>>>>                 // «¢¬«å £/¤å ¡   §¦¬ ¨ã¡ §¦ «¦ garticl,
41515>>>>>                 //§¨â§  ¤ å¤  å  £ ¬«ã¤ §¦ç ¨ã¡ §¦ «¦ gthaa
41515>>>>>                 If (;                     (Not(ldLast_Garticl_Hmnia = ldLast_Gthaa_Hmnia));                    ) Begin
41517>>>>>                           UNLOCK
41518>>>>>>
41518>>>>>                           Set piError to 1003 //«¦ gthaa â®  á¢¢ £¨¦£¤å
41519>>>>>                                               //§æ ¬«ã¤ §¦¬ ¨å©¡à ©«¦ garticl
41519>>>>>                           Send Operation_Not_Allowed 1003
41520>>>>>                           Procedure_Return
41521>>>>>                      End
41521>>>>>>
41521>>>>>                 If (;                     (Not(liLast_Garticl_Aa    = liLast_Gthaa_Aa   ));                    ) Begin
41523>>>>>                           UNLOCK
41524>>>>>>
41524>>>>>                           Set piError to 1004 //«¦ gthaa â®  á¢¢¦¤ /
41525>>>>>                                               //§æ ¬«æ¤ §¦¬ ¨å©¡à ©«¦ garticl
41525>>>>>                           Send Operation_Not_Allowed 1004
41526>>>>>                           Procedure_Return
41527>>>>>                      End
41527>>>>>>
41527>>>>>
41527>>>>>                 //1-03.03:â¢®¦ª ¦å©ª âàª £¨¦£¤åª
41527>>>>>                 //§¨â§  ¤ å¤  >= §¦ «¤ «¢¬«å £¨¦£¤å ®¦¨ã©ª /
41527>>>>>                 //  «¦ ©¬¡¡¨ £â¤¦ à¨£â¤¦ £¨¦¢æ ¦ (æ§àª «¤  áà §¦ «¦ gthaa)
41527>>>>>                 If (;                     (Not(ldEos_Hmnia >= ldLast_Gthaa_Hmnia));                    ) Begin
41529>>>>>                           UNLOCK
41530>>>>>>
41530>>>>>                           Set piError to 1005 // £¨¦£¤å §¦¬ é©« å¤  §¨¦¤â©«¨
41531>>>>>                                               //§æ «¤ «¢¬«å £/¤å ®¦¨ã©ª /
41531>>>>>                                              //©«¦ ligthhmgio_code
41531>>>>>                           Send Operation_Not_Allowed 1005
41532>>>>>                           Procedure_Return
41533>>>>>                      End
41533>>>>>>
41533>>>>>
41533>>>>>
41533>>>>>                 //é å¤  æ¢ ok ¡  §¨¦®à¨áà ©«¤ ®¦¨ã© /
41533>>>>>                 Move ldLast_Gthaa_Hmnia to ldApo_Hmnia
41534>>>>>                 Move liLast_Gthaa_Aa    to liAa
41535>>>>>
41535>>>>>                 //**************************************************************************
41535>>>>>                 //1-04:rebuild constraints, ¢æà «à¤ ¡¢á©à¤
41535>>>>>                 //**************************************************************************
41535>>>>>                 Send Rebuild_Constraints to liGtypkin_dd
41536>>>>>
41536>>>>>                 //**************************************************************************
41536>>>>>                 //1-05:«á¨ ©£ operation mode «¦¬ Garticl   « constraints
41536>>>>>                 //**************************************************************************
41536>>>>>                 Set piMode               of liGarticl_dd to 1              //®¦¨ã© /
41537>>>>>                 Set piGthhmgio_Code      of liGarticl_dd to liGthhmgio_Code
41538>>>>>                 Set pdApo_Hmnia          of liGarticl_dd to ldApo_Hmnia
41539>>>>>                 Set pdEos_Hmnia          of liGarticl_dd to ldEos_Hmnia
41540>>>>>                 Send Rebuild_Constraints to liGarticl_dd
41541>>>>>
41541>>>>>                 //**************************************************************************
41541>>>>>                 //1-06:©á¨à© garticl & ®¦¨ã© /
41541>>>>>                 //**************************************************************************
41541>>>>>
41541>>>>>                 Send Clear to liGarticl_dd   //¬«æ ®¨ á«  ?
41542>>>>>
41542>>>>>                 If (liGarticl_Recnum = 0);                 Begin //á¤  «¢¬«å £/¤å  å¤  æ¢ ¤¦ ¡«ã (®à¨åª )
41544>>>>>                      Send Find  to liGarticl_dd FIRST_RECORD 4 //index.4:garticl:company_code+
41545>>>>>                                                                //                branch_code+
41545>>>>>                                                                //                year_year+
41545>>>>>                                                                //                gthhmgio_code+
41545>>>>>                                                                //                garticl_hmnia+
41545>>>>>                                                                //                gtypkin_code+
41545>>>>>                                                                //                garticl_no+
41545>>>>>                                                                //                garticl_recr
41545>>>>>                 End
41545>>>>>>
41545>>>>>                 Else;                 Begin //á¤ ©«¤ «¢¬«å £/¤å , â®à §¨¦©â©  ¡  á¢¢ records
41546>>>>>                      Send Find_By_Recnum to liGarticl_dd Garticl.File_Number liGarticl_Recnum
41547>>>>>                      Send Find  to liGarticl_dd           Gt 4 //index.4:garticl:company_code+
41548>>>>>                                                                //                branch_code+
41548>>>>>                                                                //                year_year+
41548>>>>>                                                                //                gthhmgio_code+
41548>>>>>                                                                //                garticl_hmnia+
41548>>>>>                                                                //                gtypkin_code+
41548>>>>>                                                                //                garticl_no+
41548>>>>>                                                                //                garticl_recr
41548>>>>>                 End
41548>>>>>>
41548>>>>>
41548>>>>>                 While (Found = 1)
41552>>>>>
41552>>>>>                        Get Cancel_Check to liStop
41553>>>>>                        If (liStop <> 0) Begin
41555>>>>>                                          UNLOCK
41556>>>>>>
41556>>>>>                                          Procedure_Return
41557>>>>>                                         End
41557>>>>>>
41557>>>>>
41557>>>>>                        Send Update_Status (;                                            "/:"                                       +;                                            (String(liAA                  ))+":      "   +;                                            (String(Garticl.Gtypkin_Code  ))+"-"         +;                                            (String(Garticl.Garticl_Hmnia ))+"-"         +;                                            (String(Garticl.Garticl_No    ))+"      ¨­âª:"+;                                            (String(Garticl.Garticl_Mlines))+"       "   +;                                            (String(Integer(lnPercent)    ))+"%:";                                           )
41558>>>>>
41558>>>>>                        //  ¢æ¦¬ª ©­¢åª, ¡ ¤â¦¬ â¢®¦ª £¤ ¡¦ç 
41558>>>>>                        Get Field_Current_Value of liGarticl_dd Field Garticl.Garticl_AA to liCheck_AA
41559>>>>>
41559>>>>>                        If (liCheck_Aa = 0);                        Begin //®¦¨é / © records §¦¬ â¤ â®¦¬¤
41561>>>>>                              Increment liAA
41562>>>>>
41562>>>>>                              Increment liNumber_of_Garticls2
41563>>>>>
41563>>>>>                              Move (((Number(liNumber_of_Garticls2))/liNumber_of_Garticls1)*100) to lnPercent
41564>>>>>                              Send Update_Status ("__PROGRESS__" + String(Integer(lnPercent)))
41565>>>>>
41565>>>>>                              Set Field_Changed_Value of liGarticl_dd Field Garticl.Garticl_AA to liAA
41566>>>>>
41566>>>>>                              Send Request_Save to liGarticl_dd
41567>>>>>                              //Move (Err) to liErr
41567>>>>>                              //If (liErr <> 0);
41567>>>>>                              //Begin
41567>>>>>                              // UNLOCK
41567>>>>>                              // Set piError to 1006 //«¦ garticl â¤ ©é¡
41567>>>>>                              // Send Operation_Not_Allowed 1006
41567>>>>>                              // Procedure_Return
41567>>>>>                              //End
41567>>>>>                        End //if (liCheck_Aa = 0)
41567>>>>>>
41567>>>>>
41567>>>>>                        Send Find to liGarticl_dd NEXT_RECORD 4 //index.4:garticl:company_code+
41568>>>>>                                                                //                branch_code+
41568>>>>>                                                                //                year_year+
41568>>>>>                                                                //                gthhmgio_code+
41568>>>>>                                                                //                garticl_hmnia+
41568>>>>>                                                                //                gtypkin_code+
41568>>>>>                                                                //                garticl_no+
41568>>>>>                                                                //                garticl_recr
41568>>>>>                 Loop
41569>>>>>>
41569>>>>>
41569>>>>>
41569>>>>>
41569>>>>>                 //*******
41569>>>>>                 UNLOCK
41570>>>>>>
41570>>>>>                 //*******
41570>>>>>
41570>>>>>                 //14/02/2000:§¨â§  ¤ ¥¤¢å  ¢¦ ¡ã !
41570>>>>>                 //sosososososososososososososososososososososososo
41570>>>>>                 //If (liNumber_of_Garticls1 <> liNumber_of_Garticls2);
41570>>>>>                 //Begin
41570>>>>>                 // Set piError to 1008 //â¤ ©¬£­à¤¦ç¤ 1 + 2
41570>>>>>                 // Procedure_Return
41570>>>>>                 //End
41570>>>>>       End_Procedure //private.Xorigise_Aa
41571>>>>>       //****************************************************************************
41571>>>>>       //* 1 :                    /                                  *
41571>>>>>       //****************************************************************************
41571>>>>>
41571>>>>>
41571>>>>>
41571>>>>>
41571>>>>>
41571>>>>>
41571>>>>>
41571>>>>>
41571>>>>>
41571>>>>>
41571>>>>>       //****************************************************************************
41571>>>>>       //* 2 :                       /                              *
41571>>>>>       //****************************************************************************
41571>>>>>       //private
41571>>>>>       //2:¨¦¬«å¤ £¤ ©£¦ç /
41571>>>>>       Procedure private.Zero_Aa Integer liGthhmgio_Code
41573>>>>>                 Integer liStop liErr
41574>>>>>                 Integer liGarticl_dd liGarticl_Recnum
41574>>>>>                 Number  lnPercent
41574>>>>>                 Integer liGarticl_Last_Aa liGarticl_Counter
41574>>>>>
41574>>>>>
41574>>>>>
41574>>>>>
41574>>>>>
41574>>>>>                 //*******
41574>>>>>                 LOCK
41575>>>>>>
41575>>>>>                 //*******
41575>>>>>
41575>>>>>
41575>>>>>
41575>>>>>
41575>>>>>
41575>>>>>                 //2-01:ç¨© object id's «à¤ £§¢¡¦£â¤à¤ ddo's
41575>>>>>                 Move (Garticl_dd(Self)) to liGarticl_dd
41576>>>>>
41576>>>>>                 //2-02:ç¨© year
41576>>>>>
41576>>>>>                 //2-04:©«á¨ ©£ operation mode «¦¬ Garticl & rebuild constraints
41576>>>>>                 Set piMode               of liGarticl_dd to 2                //£¤ ©£æª /
41577>>>>>                 Send Rebuild_Constraints to liGarticl_dd
41578>>>>>
41578>>>>>                 //2-05:á¨à© Garticl & ¤ ©£æª /
41578>>>>>                 Clear Garticl
41579>>>>>                 Move SyscurGL.Company_Code to Garticl.Company_Code
41580>>>>>                 Move SyscurGL.Branch_Code  to Garticl.Branch_Code
41581>>>>>                 Move SyscurGL.Year_Year    to Garticl.Year_Year
41582>>>>>                 Move liGthhmgio_Code          to Garticl.Gthhmgio_Code
41583>>>>>                 Move 99999999999999           to Garticl.Garticl_Aa     //n14.0
41584>>>>>                 Find Lt Garticl by Index.6 //index.6:garticl:company_code+
41585>>>>>>
41585>>>>>                                            //                branch_code+
41585>>>>>                                            //                year_year+
41585>>>>>                                            //                gthhmgio_code+
41585>>>>>                                            //                garticl_aa+
41585>>>>>                                            //                recnum
41585>>>>>                 While (;                        (Found = 1)                                         and;                        (Garticl.Company_Code   = SyscurGL.Company_Code ) and;                        (Garticl.Branch_Code    = SyscurGL.Branch_Code  ) and;                        (Garticl.Year_Year      = SyscurGL.Year_Year    ) and;                        (Garticl.Gthhmgio_Code  = liGthhmgio_Code         ) and;                        (Garticl.Garticl_Aa    <> 0                       ) ;                       )
41589>>>>>
41589>>>>>                        If (liGarticl_Last_Aa=0) Move Garticl.Garticl_Aa to liGarticl_Last_Aa
41592>>>>>                        Increment liGarticl_Counter
41593>>>>>                        Move (((Number(liGarticl_Counter))/liGarticl_Last_Aa)*100) to lnPercent
41594>>>>>
41594>>>>>                        Get Cancel_Check to liStop
41595>>>>>                        If (liStop <> 0) Begin
41597>>>>>                                          UNLOCK
41598>>>>>>
41598>>>>>                                          Procedure_Return
41599>>>>>                                         End
41599>>>>>>
41599>>>>>
41599>>>>>                        Send Update_Status (;                                            "/:"                                       +;                                            (String(Garticl.Garticl_AA    ))+":      "   +;                                            (String(Garticl.Gtypkin_Code  ))+"-"         +;                                            (String(Garticl.Garticl_Hmnia ))+"-"         +;                                            (String(Garticl.Garticl_No    ))+"      ¨­âª:"+;                                            (String(Garticl.Garticl_Mlines))+"       "   +;                                            (String(Integer(lnPercent)    ))+"%:";                                           )
41600>>>>>                        Send Update_Status ("__PROGRESS__" + String(Integer(lnPercent)))
41601>>>>>
41601>>>>>                        Move Garticl.Recnum to liGarticl_Recnum
41602>>>>>
41602>>>>>                        Send Find_By_Recnum to liGarticl_dd Garticl.File_Number liGarticl_Recnum
41603>>>>>                        If (Found=0);                        Begin
41605>>>>>                             UNLOCK
41606>>>>>>
41606>>>>>                             Error 2002 "¤ç§¨¡«¦ ¨¨¦!"
41607>>>>>>
41607>>>>>                             Set piError to 2001 //â¤ ¨ã¡ «¦ garticl
41608>>>>>                             Procedure_Return
41609>>>>>                        End
41609>>>>>>
41609>>>>>
41609>>>>>                        Set Field_Changed_Value of liGarticl_dd Field Garticl.Garticl_AA to 0
41610>>>>>                        Send Request_Save to liGarticl_dd
41611>>>>>                        //Move (Err) to liErr
41611>>>>>                        //If (liErr <> 0);
41611>>>>>                        //Begin
41611>>>>>                        // Set piError to 1007 //«¦ garticl â¤ ©é¡
41611>>>>>                        // UNLOCK
41611>>>>>                        // Procedure_Return
41611>>>>>                        //End
41611>>>>>
41611>>>>>                        Clear Garticl
41612>>>>>                        Move gs_Selected_Company_Code to Garticl.Company_Code
41613>>>>>                        Move gs_Selected_Branch_Code  to Garticl.Branch_Code
41614>>>>>                        Move gi_Selected_Year         to Garticl.Year_Year
41615>>>>>                        Move liGthhmgio_Code          to Garticl.Gthhmgio_Code
41616>>>>>                        Move 99999999999999           to Garticl.Garticl_Aa     //n14.0
41617>>>>>                        Find Lt Garticl by Index.6 //index.6:garticl:company_code+
41618>>>>>>
41618>>>>>                                                   //                branch_code+
41618>>>>>                                                   //                year_year+
41618>>>>>                                                   //                gthhmgio_code+
41618>>>>>                                                   //                garticl_aa+
41618>>>>>                                                   //                recnum
41618>>>>>                 Loop
41619>>>>>>
41619>>>>>
41619>>>>>                 //2-03: ¨­ã gthaa
41619>>>>>                 Clear GthAA
41620>>>>>                 Move gs_Selected_Company_Code to Gthaa.Company_Code
41621>>>>>                 Move gs_Selected_Branch_Code  to Gthaa.Branch_Code
41622>>>>>                 Move gi_Selected_Year         to Gthaa.Year_Year
41623>>>>>                 Move liGthHmgio_Code          to Gthaa.GthHmgio_Code
41624>>>>>                 Find Eq Gthaa By Index.1 //index.1:gthaa:company_code+branch_code+year_year+gthhmgio_code
41625>>>>>>
41625>>>>>                 If (Found = 1) Delete Gthaa
41628>>>>>                 //finderr ??????????? sosososososososososososo
41628>>>>>
41628>>>>>                 //*******
41628>>>>>                 UNLOCK
41629>>>>>>
41629>>>>>                 //*******
41629>>>>>       End_Procedure //private.zero_aa
41630>>>>>       //****************************************************************************
41630>>>>>       //* 2 :                      /                              *
41630>>>>>       //****************************************************************************
41630>>>>>
41630>>>>>
41630>>>>>
41630>>>>>
41630>>>>>
41630>>>>>
41630>>>>>
41630>>>>>       //***************************************************************************
41630>>>>>       //*                                          *
41630>>>>>       //***************************************************************************
41630>>>>>
41630>>>>>//liA_Garticl_Recr       find garticl        Barticl.Garticl_Recr
41630>>>>>//liA_Gtypkin_Recr                           Btypkin.Gtypkin_Recr
41630>>>>>//
41630>>>>>//liA_Gmove_Master_Recr  find master gmove   Barticl.Gmove_Mrecr
41630>>>>>//liA_Gplan_Master_Recr  find master gplan   Barticl.Gplan_Mrecr
41630>>>>>//
41630>>>>>//liA_Gmove_Slave_Recr   find Slave gmove    Bsum.Gmove_Srecr
41630>>>>>//liA_Gplan_Slave_Recr   find Slave gplan    Bmove.Gplan_Srecr <------ Bkinkat.Bkinkat_GplnCode
41630>>>>>
41630>>>>>
41630>>>>>       //private
41630>>>>>       //¡¢å«  §æ:private.transaction_BCVWmove_update_gL
41630>>>>>       //transaction enabled !
41630>>>>>       //â¢®¦ª befora & after « £é¤ garticl
41630>>>>>       Function private.Garticl_Must_Be_Edited String  lsB_Gtypkin_Recr;                                               Date    ldB_Hmnia;                                               Integer liB_No;                                               String  lsB_C_Code2;                                               Number  lnB_Rate0;                                               Number  lnB_Rate00;                                               Number  lnB_RateR;                                               String  lsB_Aitiol;                                               String  lsA_Gtypkin_Recr;                                               Date    ldA_Hmnia;                                               Integer liA_No;                                               String  lsA_C_Code2;                                               Number  lnA_Rate0;                                               Number  lnA_Rate00;                                               Number  lnA_RateR;                                               String  lsA_Aitiol;                                               Returns Integer
41632>>>>>                Function_Return (Not(;                                  (lsB_Gtypkin_Recr = lsA_Gtypkin_Recr) and;                                  (ldB_Hmnia        = ldA_Hmnia       ) and;                                  (liB_No           = liA_No          ) and;                                  (lsB_C_Code2      = lsA_C_Code2     ) and;                                  (lnB_Rate0        = lnA_Rate0       ) and;                                  (lnB_Rate00       = lnA_Rate00      ) and;                                  (lnB_RateR        = lnA_RateR       ) and;                                  (lsB_Aitiol       = lsA_Aitiol      );                                ))
41633>>>>>       End_Function //private.garticl_must_be_edited
41634>>>>>
41634>>>>>
41634>>>>>       //private
41634>>>>>       //¡¢å«  §æ:private.transaction_BCVWmove_update_gL
41634>>>>>       //transaction enabled !
41634>>>>>       //â¢®¦ª before & after « £é¤ gmove (master & slave)
41634>>>>>       Function private.Gmove_Must_Be_Edited String  lsB_Gplan_Recr;                                             Number  lnB_Gmove_X2;                                             Number  lnB_Gmove_P2;                                             String  lsB_Gmove_Aitiol;                                             String  lsA_Gplan_Recr;                                             Number  lnA_Gmove_X2;                                             Number  lnA_Gmove_P2;                                             String  lsA_Gmove_Aitiol;                                             Returns Integer
41636>>>>>                Function_Return (Not(;                                  (lsB_Gplan_Recr   = lsA_Gplan_Recr  ) and;                                  (lnB_Gmove_X2     = lnA_Gmove_X2    ) and;                                  (lnB_Gmove_P2     = lnA_Gmove_P2    ) and;                                  (lsB_Gmove_Aitiol = lsA_Gmove_Aitiol);                                ))
41637>>>>>       End_Function //private.gmove_must_be_edited
41638>>>>>
41638>>>>>
41638>>>>>       //private
41638>>>>>       //¡¢å«  §æ:private.transaction_BCVWmove_update_gL
41638>>>>>       //transaction enabled !
41638>>>>>       Function private.Check_Edit String  lsB_Garticl_Recr;                                   String  lsB_Gmove_Master_Recr;                                   String  lsB_Gmove_Slave_Recr;                                   String  lsA_Garticl_Recr;                                   String  lsA_Gmove_Master_Recr;                                   String  lsA_Gmove_Slave_Recr;                                   Returns Integer
41640>>>>>
41640>>>>>                //§¨é« ¢â®à æ«  «¦ edit å¤«  ©« å  before & after records
41640>>>>>                If (;                    (lsB_Garticl_Recr       <> lsA_Garticl_Recr     ) or;                    (lsB_Gmove_Master_Recr  <> lsA_Gmove_Master_Recr) or;                    (lsB_Gmove_Slave_Recr   <> lsA_Gmove_Slave_Recr );                   );                Begin
41642>>>>>                     Function_Return 3005 //"edit:«¦ edit â¤ § «¨â§«  ©  ­¦¨« ¡á records (¢á¦ª ¡é ¡!)"
41643>>>>>                End
41643>>>>>>
41643>>>>>
41643>>>>>                //£«á ¢â®à æ«  « before records â¤ å¤  £¤ ¡á
41643>>>>>                //(§¦¬ æ£àª â®à §¨¦¦¬£â¤àª  àå æ«  å¤  å  £ « after)
41643>>>>>                If (;                    (lsB_Garticl_Recr       = '') or;                    (lsB_Gmove_Master_Recr  = '') or;                    (lsB_Gmove_Slave_Recr   = '');                   );                Begin
41645>>>>>                     Function_Return 3005 //"edit:« records å¤  £¤ ¡á (¢á¦ª ¡é ¡!)"
41646>>>>>                End
41646>>>>>>
41646>>>>>                Function_Return 0 //æ¢ ok
41647>>>>>       End_Function //private.check_edit
41648>>>>>
41648>>>>>
41648>>>>>       //private
41648>>>>>       //3:¨¦¬«å¤ ¤£â¨à©ª gmove §¦ bmove
41648>>>>>       //transaction enabled !
41648>>>>>       Procedure private.Transaction_BCVWmove_Update_GL
41650>>>>>                 Integer  liCalling_dd liCalling_dd_Current_Recnum
41651>>>>>                 Integer  liGtypkin_dd liGarticl_dd liGplan_dd liGmove_dd
41651>>>>>                 Integer  liErr
41651>>>>>                 Integer  liBackout liUpdate
41651>>>>>
41651>>>>>                 //19 properties §¦¬  áà §¦ «¦ ¡¢æ¤ ddo
41651>>>>>                 String   lsB_Garticl_Recr           lsA_Garticl_Recr
41651>>>>>                 String   lsB_Gtypkin_Recr           lsA_Gtypkin_Recr
41651>>>>>                 Date     ldB_Garticl_Hmnia          ldA_Garticl_Hmnia
41651>>>>>                 Integer  liB_Garticl_No             liA_Garticl_No
41651>>>>>                 String   lsB_Garticl_C_Code2        lsA_Garticl_C_Code2
41651>>>>>                 Number   lnB_Garticl_Rate0          lnA_Garticl_Rate0
41651>>>>>                 Number   lnB_Garticl_Rate00         lnA_Garticl_Rate00
41651>>>>>                 Number   lnB_Garticl_RateR          lnA_Garticl_RateR
41651>>>>>                 String   lsB_Garticl_Aitiol         lsA_Garticl_Aitiol
41651>>>>>
41651>>>>>                 String   lsB_Gmove_Master_Recr      lsA_Gmove_Master_Recr
41651>>>>>                 String   lsB_Gplan_Master_Recr      lsA_Gplan_Master_Recr
41651>>>>>                 Number   lnB_Gmove_Master_X2        lnA_Gmove_Master_X2
41651>>>>>                 Number   lnB_Gmove_Master_P2        lnA_Gmove_Master_P2
41651>>>>>                 String   lsB_Gmove_Master_Aitiol    lsA_Gmove_Master_Aitiol
41651>>>>>
41651>>>>>                 String   lsB_Gmove_Slave_Recr       lsA_Gmove_Slave_Recr
41651>>>>>                 String   lsB_Gplan_Slave_Recr       lsA_Gplan_Slave_Recr
41651>>>>>                 Number   lnB_Gmove_Slave_X2         lnA_Gmove_Slave_X2
41651>>>>>                 Number   lnB_Gmove_Slave_P2         lnA_Gmove_Slave_P2
41651>>>>>                 String   lsB_Gmove_Slave_Aitiol     lsA_Gmove_Slave_Aitiol
41651>>>>>
41651>>>>>                 //booleans §¦¬ ¢é¤¦¬¤ « operations §¦¬ §¨â§  ¤ å¤¦¬¤ ©«ã¤ ¢
41651>>>>>                 //å¤  ã ©«¨ ©£â¤ §¦ «¦ calling ddo
41651>>>>>                 //master operation       master operation      slave operation
41651>>>>>                 Integer liGarticl_Delete liMaster_Gmove_Delete liSlave_Gmove_Delete
41651>>>>>                 Integer liGarticl_Edit   liMaster_Gmove_Edit   liSlave_Gmove_Edit
41651>>>>>                 Integer liGarticl_Create liMaster_Gmove_Create liSlave_Gmove_Create
41651>>>>>
41651>>>>>                 //booleans, §¦¬ ¡¦¨å¦¬¤ « data operations
41651>>>>>                 //©«á¨¦¤«  ©à«¨ ¡á (private)
41651>>>>>                 Integer  liGarticl_Must_Be_Edited liGmove_Master_Must_Be_Edited liGmove_Slave_Must_Be_Edited
41651>>>>>                 Integer  liCheck_Edit
41651>>>>>
41651>>>>>                 //final values,   «ã¤ feedback ¤£â¨à© «¦¬ ¡¢¦ç¤«¦ª ddo
41651>>>>>                 String  lsF_Garticl_Recr lsF_Gmove_Master_Recr lsF_Gmove_Slave_Recr
41651>>>>>
41651>>>>>                 //§¢ âª ®¨à§ ©«é© ª, §¨å¤ «¦ edit
41651>>>>>                 Number lnO_Gmove_Master_X2 //§¢ á ®¨âà©  «¦¬ master gmove
41651>>>>>                 Number lnO_Gmove_Master_P2 //§¢ á §å©«à© «¦¬ master gmove
41651>>>>>                 Number lnO_Gmove_Slave_X2  //§¢ á ®¨âà©  «¦¬ slave  gmove
41651>>>>>                 Number lnO_Gmove_Slave_P2  //§¢ á §å©«à© «¦¬ slave  gmove
41651>>>>>
41651>>>>>                 //¤âª ®¨à§ ©«é© ª, æ§àª §¨¦¡ç§«¦¬¤ £«á «¦ edit
41651>>>>>                 Number lnN_Gmove_Master_X2 //¤â    ®¨âà©  «¦¬ master gmove
41651>>>>>                 Number lnN_Gmove_Master_P2 //¤â    §å©«à© «¦¬ master gmove
41651>>>>>                 Number lnN_Gmove_Slave_X2  //¤â    ®¨âà©  «¦¬ slave  gmove
41651>>>>>                 Number lnN_Gmove_Slave_P2  //¤â    §å©«à© «¦¬ slave  gmove
41651>>>>>
41651>>>>>                 //recr   « find
41651>>>>>                 String  lsGarticl_Recr
41651>>>>>                 String  lsGtypkin_Recr
41651>>>>>                 String  lsGmove_Master_Recr
41651>>>>>                 String  lsGplan_Master_Recr
41651>>>>>                 String  lsGmove_Slave_Recr
41651>>>>>                 String  lsGplan_Slave_Recr
41651>>>>>
41651>>>>>                 //4 flags §¦¬ §¨¤á  £ ¦¨å©£« «¦ ¡¢æ¤ ddo
41651>>>>>                 Integer liFlag02 liFlag03 liFlag04 liFlag05
41651>>>>>
41651>>>>>                 //4 flags §¦¬  áà §¦ «¦ gtypkin
41651>>>>>                 Integer liGFlag02 liGFlag03 liGFlag04 liGFlag05
41651>>>>>
41651>>>>>                 //ç¨© ¡¢¦ç¤«¦ª ddo
41651>>>>>                 Get piCalling_dd to liCalling_dd
41652>>>>>
41652>>>>>                 //â¢®¦ª ¡¢¦ç¤«¦ª ddo (á¤ 0, ¡á¤«¤)
41652>>>>>                 If (liCalling_dd = 0) Send Operation_Not_Allowed 3001 //"dâ¤ £ ¡á¢© ¡¤åª!"
41655>>>>>
41655>>>>>                 //ç¨© current_record ¡¢¦ç¤«¦ª ddo
41655>>>>>                 Get Current_Record of liCalling_dd to liCalling_dd_Current_Recnum
41656>>>>>
41656>>>>>                 //â¢®¦ª current_record (á¤ 0, ¡á¤«¤)
41656>>>>>                 //prosoxi sto delete !!!*** (¡  æ£àª, æ¢àª §¨ â¨àª, â®à current record!)
41656>>>>>                 If (liCalling_dd_Current_Recnum = 0) Send Operation_Not_Allowed 3002 //"«¦ ¡¢æ¤ ddo â¤ â®  current record!"
41659>>>>>
41659>>>>>                 //¤á¤à© ¡«á©«©ª ¡¢¦ç¤«¦ª ddo
41659>>>>>                 Get piBackout               of liCalling_dd to liBackout
41660>>>>>                 Get piUpdate                of liCalling_dd to liUpdate
41661>>>>>
41661>>>>>                 //¤á¤à© 19 §¢ é¤ « £é¤ «¦¬ ¡¢¦ç¤«¦ª ddo
41661>>>>>                 Get psB_Garticl_Recr        of liCalling_dd to lsB_Garticl_Recr
41662>>>>>                 Get psB_Gtypkin_Recr        of liCalling_dd to lsB_Gtypkin_Recr
41663>>>>>                 Get pdB_Garticl_Hmnia       of liCalling_dd to ldB_Garticl_Hmnia
41664>>>>>                 Get piB_Garticl_No          of liCalling_dd to liB_Garticl_No
41665>>>>>                 Get psB_Garticl_C_Code2     of liCalling_dd to lsB_Garticl_C_Code2
41666>>>>>                 Get pnB_Garticl_Rate0       of liCalling_dd to lnB_Garticl_Rate0
41667>>>>>                 Get pnB_Garticl_Rate00      of liCalling_dd to lnB_Garticl_Rate00
41668>>>>>                 Get pnB_Garticl_RateR       of liCalling_dd to lnB_Garticl_RateR
41669>>>>>                 Get psB_Garticl_Aitiol      of liCalling_dd to lsB_Garticl_Aitiol
41670>>>>>
41670>>>>>                 Get psB_Gmove_Master_Recr   of liCalling_dd to lsB_Gmove_Master_Recr
41671>>>>>                 Get psB_Gplan_Master_Recr   of liCalling_dd to lsB_Gplan_Master_Recr
41672>>>>>                 Get pnB_Gmove_Master_X2     of liCalling_dd to lnB_Gmove_Master_X2
41673>>>>>                 Get pnB_Gmove_Master_P2     of liCalling_dd to lnB_Gmove_Master_P2
41674>>>>>                 Get psB_Gmove_Master_Aitiol of liCalling_dd to lsB_Gmove_Master_Aitiol
41675>>>>>
41675>>>>>                 Get psB_Gmove_Slave_Recr    of liCalling_dd to lsB_Gmove_Slave_Recr
41676>>>>>                 Get psB_Gplan_Slave_Recr    of liCalling_dd to lsB_Gplan_Slave_Recr
41677>>>>>                 Get pnB_Gmove_Slave_X2      of liCalling_dd to lnB_Gmove_Slave_X2
41678>>>>>                 Get pnB_Gmove_Slave_P2      of liCalling_dd to lnB_Gmove_Slave_P2
41679>>>>>                 Get psB_Gmove_Slave_Aitiol  of liCalling_dd to lsB_Gmove_Slave_Aitiol
41680>>>>>
41680>>>>>                 //¤á¤à© 19 ¤âà¤ « £é¤ «¦¬ ¡¢¦ç¤«¦ª ddo
41680>>>>>                 Get psA_Garticl_Recr        of liCalling_dd to lsA_Garticl_Recr
41681>>>>>                 Get psA_Gtypkin_Recr        of liCalling_dd to lsA_Gtypkin_Recr
41682>>>>>                 Get pdA_Garticl_Hmnia       of liCalling_dd to ldA_Garticl_Hmnia
41683>>>>>                 Get piA_Garticl_No          of liCalling_dd to liA_Garticl_No
41684>>>>>                 Get psA_Garticl_C_Code2     of liCalling_dd to lsA_Garticl_C_Code2
41685>>>>>                 Get pnA_Garticl_Rate0       of liCalling_dd to lnA_Garticl_Rate0
41686>>>>>                 Get pnA_Garticl_Rate00      of liCalling_dd to lnA_Garticl_Rate00
41687>>>>>                 Get pnA_Garticl_RateR       of liCalling_dd to lnA_Garticl_RateR
41688>>>>>                 Get psA_Garticl_Aitiol      of liCalling_dd to lsA_Garticl_Aitiol
41689>>>>>
41689>>>>>                 Get psA_Gmove_Master_Recr   of liCalling_dd to lsA_Gmove_Master_Recr
41690>>>>>                 Get psA_Gplan_Master_Recr   of liCalling_dd to lsA_Gplan_Master_Recr
41691>>>>>                 Get pnA_Gmove_Master_X2     of liCalling_dd to lnA_Gmove_Master_X2
41692>>>>>                 Get pnA_Gmove_Master_P2     of liCalling_dd to lnA_Gmove_Master_P2
41693>>>>>                 Get psA_Gmove_Master_Aitiol of liCalling_dd to lsA_Gmove_Master_Aitiol
41694>>>>>
41694>>>>>                 Get psA_Gmove_Slave_Recr    of liCalling_dd to lsA_Gmove_Slave_Recr
41695>>>>>                 Get psA_Gplan_Slave_Recr    of liCalling_dd to lsA_Gplan_Slave_Recr
41696>>>>>                 Get pnA_Gmove_Slave_X2      of liCalling_dd to lnA_Gmove_Slave_X2
41697>>>>>                 Get pnA_Gmove_Slave_P2      of liCalling_dd to lnA_Gmove_Slave_P2
41698>>>>>                 Get psA_Gmove_Slave_Aitiol  of liCalling_dd to lsA_Gmove_Slave_Aitiol
41699>>>>>
41699>>>>>                 //booleans §¦¬ ¢é¤¦¬¤ « operations §¦¬ §¨â§  ¤ å¤¦¬¤ ©«ã¤ ¢
41699>>>>>                 //master operation
41699>>>>>                 Get piGarticl_Delete      of liCalling_dd to  liGarticl_Delete
41700>>>>>                 Get piGarticl_Edit        of liCalling_dd to  liGarticl_Edit
41701>>>>>                 Get piGarticl_Create      of liCalling_dd to  liGarticl_Create
41702>>>>>
41702>>>>>                 Get piMaster_Gmove_Delete of liCalling_dd to  liMaster_Gmove_Delete
41703>>>>>                 Get piMaster_Gmove_Edit   of liCalling_dd to  liMaster_Gmove_Edit
41704>>>>>                 Get piMaster_Gmove_Create of liCalling_dd to  liMaster_Gmove_Create
41705>>>>>
41705>>>>>                 //slave operation
41705>>>>>                 Get piSlave_Gmove_Delete  of liCalling_dd to  liSlave_Gmove_Delete
41706>>>>>                 Get piSlave_Gmove_Edit    of liCalling_dd to  liSlave_Gmove_Edit
41707>>>>>                 Get piSlave_Gmove_Create  of liCalling_dd to  liSlave_Gmove_Create
41708>>>>>
41708>>>>>//©¦©¦©¦©¦©¦sososososo pos xero oti prepei na trexo ?
41708>>>>>
41708>>>>>                 //â¢®¦ª æ«  §æ « 3 create+edit+delete booleans, £æ¤¦¤ «¦ 1 å¤  true
41708>>>>>                 If (;                      (liGarticl_Create     +liGarticl_Edit     +liGarticl_Delete      <> 1) or;                      (liMaster_Gmove_Create+liMaster_Gmove_Edit+liMaster_Gmove_Delete <> 1) or;                      (liSlave_Gmove_Create +liSlave_Gmove_Edit +liSlave_Gmove_Delete  <> 1);                     );                 Begin
41710>>>>>                     Send Operation_Not_Allowed 3003 //"akatalila booleans 1!"
41711>>>>>                 End
41711>>>>>>
41711>>>>>                 If (;                      (liGarticl_Create      < 0 ) or;                      (liGarticl_Edit        < 0 ) or;                      (liGarticl_Delete      < 0 ) or;                      (liMaster_Gmove_Create < 0 ) or;                      (liMaster_Gmove_Edit   < 0 ) or;                      (liMaster_Gmove_Delete < 0 ) or;                      (liSlave_Gmove_Create  < 0 ) or;                      (liSlave_Gmove_Edit    < 0 ) or;                      (liSlave_Gmove_Delete  < 0 );                     );                 Begin
41713>>>>>                     Send Operation_Not_Allowed 3004 //"akatalila booleans 2!"
41714>>>>>                 End
41714>>>>>>
41714>>>>>
41714>>>>>
41714>>>>>                 //â¢®¦ª backout & update
41714>>>>>                 Case Begin
41714>>>>>                      //1.-----------------------------------------------------------------------
41714>>>>>                      Case ((liBAckout =  0) and (liUpdate  =  0)) //ç¤«¦¤, ¢á¦ª ¡é ¡!
41716>>>>>                           Send Operation_Not_Allowed 3005 //"â¤ â«¨¥ ¦ç« update ¦ç« backout (¢á¦ª ¡é ¡)"
41717>>>>>                      Case Break
41718>>>>>
41718>>>>>                      //2.-----------------------------------------------------------------------
41718>>>>>                      Case ((liBAckout <> 0) and (liUpdate  =  0)) //delete bcvwmove
41721>>>>>                           //æ«¤ ¡á¤à delete ©«¦ bcvwmove, « gmoves ¢ «¦¬¨¦ç¤ éª ¥ãª:
41721>>>>>                           // master gmove      slave gmove     ©¬¤ã¡
41721>>>>>                           //-------------      -----------     -------------------
41721>>>>>                           //  edit             delete          bsum_sv0 =0
41721>>>>>                           //  edit             edit            bsum_sv0 > 0
41721>>>>>                           //  delete           delete          barticl_lines = 0
41721>>>>>
41721>>>>>                           //æ¢ « find å¤¦¤«  £ « ª §¢ âª « £âª,
41721>>>>>                           // æ«  â®  «¨â¥  £æ¤¦¤  backout.
41721>>>>>                           //2.1:§¨é« ¢â®à æ«  æ¢ « before records â¤ å¤  £¤ ¡á
41721>>>>>                           If (;                               (lsB_Garticl_Recr       = '') or;                               (lsB_Gmove_Master_Recr  = '') or;                               (lsB_Gmove_Slave_Recr   = '') or;                               (lsB_Gplan_Master_Recr  = '') or;                               (lsB_Gplan_Slave_Recr   = '') or;                               (lsB_Gtypkin_Recr       = '');                              );                           Begin
41723>>>>>                                Send Operation_Not_Allowed 3006 //"delete:« before records å¤  £¤ ¡á (¢á¦ª ¡é ¡!)"
41724>>>>>                           End
41724>>>>>>
41724>>>>>
41724>>>>>                           //2.2:£«á ¢â®à æ«  æ¢ « after records å¤  £¤ ¡á
41724>>>>>                           If (;                               (lsA_Garticl_Recr       <> '') or;                               (lsA_Gmove_Master_Recr  <> '') or;                               (lsA_Gmove_Slave_Recr   <> '') or;                               (lsA_Gplan_Master_Recr  <> '') or;                               (lsA_Gplan_Slave_Recr   <> '') or;                               (lsA_Gtypkin_Recr       <> '')   ;                              );                           Begin
41726>>>>>                                Send Operation_Not_Allowed 3007 //"delete:« after records â¤ å¤  £¤ ¡á (¢á¦ª ¡é ¡!)"
41727>>>>>                           End
41727>>>>>>
41727>>>>>
41727>>>>>                           //2.3  :£«á ©«á¨à « recr   « find, « ¦§¦å  å¤¦¬¤ £ « recr before
41727>>>>>                           //2.3.1:â¬¨© garticl §¦ recr before
41727>>>>>                           Move lsB_Garticl_Recr        to lsGarticl_Recr      //edit/delete
41728>>>>>
41728>>>>>                           //2.3.2:â¬¨© master gmove §¦ recr before
41728>>>>>                           Move lsB_Gmove_Master_Recr   to lsGmove_Master_Recr //edit/delete
41729>>>>>
41729>>>>>                           //2.3.2:â¬¨© slave gmove §¦ recr before
41729>>>>>                           Move lsB_Gmove_Slave_Recr    to lsGmove_Slave_Recr  //edit/delete
41730>>>>>
41730>>>>>                           //2.4:«â¢¦ª, ¢é¤à æ«  «¦ garticl å¤«  â£© edited §æ «¦ gmove
41730>>>>>                           //    é©« ¤ £ã¤ ©«å¢à request save ©«¦ garticl ddo
41730>>>>>                           Move 0 to liGarticl_Must_Be_Edited
41731>>>>>                      Case Break //«â¢¦ª delete bcvwmove
41732>>>>>
41732>>>>>                      //3.-----------------------------------------------------------------------
41732>>>>>                      Case ((liBAckout =  0) and (liUpdate  <> 0)) //create bcvwmove
41735>>>>>                           //æ«¤ ¡á¤à create ©«¦ bcvwmove, « gmoves ¢ «¦¬¨¦ç¤ éª ¥ãª:
41735>>>>>                           // master gmove      slave gmove
41735>>>>>                           //-------------      -----------
41735>>>>>                           //  edit             create
41735>>>>>                           //  edit             edit
41735>>>>>                           //  create           create
41735>>>>>
41735>>>>>                           //3.1:§¨é« ¢â®à æ«  £æ¤¦¤ « 3 after records â¤ å¤  £¤ ¡á.
41735>>>>>                           //    ¬«á  « ®¨ ©«é £æ¤¦¤ á¤ ¡á¤à create.
41735>>>>>                           //    â¤ ¢â®à æ¢ « 6 records,  æ«  £§¦¨å ¤ ¡á¤à create.
41735>>>>>                           If (;                               (lsA_Gtypkin_Recr       =  '') or;                               (lsA_Gplan_Master_Recr  =  '') or;                               (lsA_Gplan_Slave_Recr   =  '')   ;                              );                           Begin
41737>>>>>                                Send Operation_Not_Allowed 3008 //"create:« after records å¤  £¤ ¡á (¢á¦ª ¡é ¡!)"
41738>>>>>                           End
41738>>>>>>
41738>>>>>
41738>>>>>                           //3.2:¢é¤à á¤  ¡á¤à create/edit garticl
41738>>>>>                           Move liGarticl_Create to liGarticl_Must_Be_Edited
41739>>>>>
41739>>>>>                           //3.3  :£«á ©«á¨à « recr   « find, « ¦§¦å  å¤¦¬¤ £ « recr after
41739>>>>>                           //3.3.1:â¬¨© garticl §¦ recr after
41739>>>>>                           Move lsA_Garticl_Recr        to lsGarticl_Recr      /create/edit
41740>>>>>                           Move lsA_Gtypkin_Recr        to lsGtypkin_Recr      //®¨ á«  ©«¦ create garticl
41741>>>>>
41741>>>>>                           //3.3.2:â¬¨© master gmove §¦ recr after
41741>>>>>                           Move lsA_Gmove_Master_Recr   to lsGmove_Master_Recr /create/edit
41742>>>>>                           Move lsA_Gplan_Master_Recr   to lsGplan_Master_Recr //®¨ á«  ©«¦ create master gmove
41743>>>>>
41743>>>>>                           //3.3.3:â¬¨© slave gmove §¦ recr after
41743>>>>>                           Move lsA_Gmove_Slave_Recr    to lsGmove_Slave_Recr  /create/edit
41744>>>>>                           Move lsA_Gplan_Slave_Recr    to lsGplan_Slave_Recr  //®¨ á«  ©«¦ create slave gmove
41745>>>>>                      Case Break //«â¢¦ª create bcvwmove
41746>>>>>
41746>>>>>                      //4.-----------------------------------------------------------------------
41746>>>>>                      Case ((liBAckout <> 0) and (liUpdate  <> 0)) //edit bcvwmove
41749>>>>>                           //æ«¤ ¡á¤à edit ©«¦ bcvwmove, « gmoves ¢ «¦¬¨¦ç¤ éª ¥ãª:
41749>>>>>                           // master gmove      slave gmove
41749>>>>>                           //-------------      -----------
41749>>>>>                           //  edit             edit
41749>>>>>
41749>>>>>                           //----------------------¨®ã  ¢â®à¤ edit-----------------
41749>>>>>                           //4.1:­'æ©¦¤  ¡á¤à edit, ¢â®à « records
41749>>>>>                           Move (private.Check_Edit(Self,;                                                   lsB_Garticl_Recr,;                                                   lsB_Gmove_Master_Recr,;                                                   lsB_Gmove_Slave_Recr,;                                                   lsA_Garticl_Recr,;                                                   lsA_Gmove_Master_Recr,;                                                   lsA_Gmove_Slave_Recr);                                ) to liCheck_Edit
41750>>>>>                           If (liCheck_Edit <> 0) Send Operation_Not_Allowed 3009 //to liCalling_dd liCheck_Edit
41753>>>>>
41753>>>>>                           //4.2  :á¤ æ¢ª ¦  §¨á£«¨¦  before+after å¤  å©ª,
41753>>>>>                           //      «æ« â¤ £§å¤à ¡æ¢¦¬ ©«¦¤ ¡æ§¦ ¤ «¨â¥à,
41753>>>>>                           //      ¢¢á ­çà ...«¨â®¦¤«ª!
41753>>>>>
41753>>>>>                           //4.2.1:â¢®¦ª before & after « £é¤ garticl
41753>>>>>                           Move (private.Garticl_Must_Be_Edited(Self,;                           lsB_Gtypkin_Recr,;                           ldB_Garticl_Hmnia,;                           liB_Garticl_No,;                           lsB_Garticl_C_Code2,;                           lnB_Garticl_Rate0,;                           lnB_Garticl_Rate00,;                           lnB_Garticl_RateR,;                           lsB_Garticl_Aitiol,;                           lsA_Gtypkin_Recr,;                           ldA_Garticl_Hmnia,;                           liA_Garticl_No,;                           lsA_Garticl_C_Code2,;                           lnA_Garticl_Rate0,;                           lnA_Garticl_Rate00,;                           lnA_Garticl_RateR,;                           lsA_Garticl_Aitiol)) to liGarticl_Must_Be_Edited
41754>>>>>
41754>>>>>                           //4.2.2:â¢®¦ª before & after « £é¤ master gmove
41754>>>>>                           Move (private.Gmove_Must_Be_Edited(Self,;                           lsB_Gplan_Master_Recr,;                           lnB_Gmove_Master_X2,;                           lnB_Gmove_Master_P2,;                           lsB_Gmove_Master_Aitiol,;                           lsA_Gplan_Master_Recr,;                           lnA_Gmove_Master_X2,;                           lnA_Gmove_Master_P2,;                           lsA_Gmove_Master_Aitiol)) to liGmove_Master_Must_Be_Edited
41755>>>>>
41755>>>>>                           //4.2.3:â¢®¦ª before & after « £é¤ slave gmove
41755>>>>>                           Move (private.Gmove_Must_Be_Edited(Self,;                           lsB_Gplan_Slave_Recr,;                           lnB_Gmove_Slave_X2,;                           lnB_Gmove_Slave_P2,;                           lsB_Gmove_Slave_Aitiol,;                           lsA_Gplan_Slave_Recr,;                           lnA_Gmove_Slave_X2,;                           lnA_Gmove_Slave_P2,;                           lsA_Gmove_Slave_Aitiol))  to liGmove_Slave_Must_Be_Edited
41756>>>>>
41756>>>>>                           //4.2.4:á¤ â¤ â®  ¢¢á¥  «å§¦«, «¤ ¡á¤à «¨â®¦¤«ª
41756>>>>>                           If (;                                (liGarticl_Must_Be_Edited      = FALSE) and;                                (liGmove_Master_Must_Be_Edited = FALSE) and;                                (liGmove_Slave_Must_Be_Edited  = FALSE);                              );                           Begin
41758>>>>>                                Procedure_Return //â¤ ®¨ á«  ¤ ¡á¤à edit ©«¦ á¨¨¦
41759>>>>>                           End
41759>>>>>>
41759>>>>>                           //----------------------«â¢¦ª ¢â®à¤ edit-----------------
41759>>>>>
41759>>>>>                           //4.3  :unfortunatly §¨â§  ¤ ¡á¤à edit
41759>>>>>                           //      £«á ©«á¨à « recr   « find, « ¦§¦å  å¤¦¬¤ £ « recr after
41759>>>>>                           //4.3.1:â¬¨© garticl §¦ recr after
41759>>>>>                           Move lsA_Garticl_Recr        to lsGarticl_Recr      //edit
41760>>>>>
41760>>>>>                           //4.3.2:â¬¨© master gmove §¦ recr after
41760>>>>>                           Move lsA_Gmove_Master_Recr   to lsGmove_Master_Recr //edit
41761>>>>>
41761>>>>>                           //4.3.3:â¬¨© slave gmove §¦ recr after
41761>>>>>                           Move lsA_Gmove_Slave_Recr    to lsGmove_Slave_Recr  //edit
41762>>>>>                      Case Break //«â¢¦ª edit bcvwmove
41763>>>>>                 Case End
41763>>>>>
41763>>>>>                 //¤­¦¨¤«¢¢¬, §¨â§  ¤ «¨â¥à!
41763>>>>>
41763>>>>>                 //¤á¤à© 4 flags §¦¬ §â¨© £ ¦¨å©£« «¦ ¡¢æ¤ ddo
41763>>>>>                 Get piFlag02 to liFlag02
41764>>>>>                 Get piFlag03 to liFlag03
41765>>>>>                 Get piFlag04 to liFlag04
41766>>>>>                 Get piFlag05 to liFlag05
41767>>>>>
41767>>>>>                 //**************************************************************************
41767>>>>>                 //01.ç¨© object id's «à¤ £§¢¡¦£â¤à¤ ddo's
41767>>>>>                 //**************************************************************************
41767>>>>>                 Move (Gtypkin_dd(Self))  to liGtypkin_dd
41768>>>>>                 Move (Garticl_dd(Self))  to liGarticl_dd
41769>>>>>                 Move (Gplan_dd  (Self))  to liGplan_dd
41770>>>>>                 Move (Gmove_dd  (Self))  to liGmove_dd
41771>>>>>
41771>>>>>                 //**************************************************************************
41771>>>>>                 //02.rebuild constraints, ¢æà «à¤ ¡¢á©à¤
41771>>>>>                 //**************************************************************************
41771>>>>>                 Set piMode of liGarticl_dd to 0 //¤£â¨à© ¢ §æ b+c+v+wmove
41772>>>>>                 Send Private.Rebuild_All_Constraints
41773>>>>>
41773>>>>>                 //**************************************************************************
41773>>>>>                 //03.£ ¦¬¨å/ç¨©/¤£â¨à©/ ¨­ã garticl
41773>>>>>                 //**************************************************************************
41773>>>>>                 Send Clear to liGarticl_dd
41774>>>>>                 Move lsGarticl_Recr to Garticl.Garticl_Recr
41775>>>>>                 Send Find to liGarticl_dd Eq 2 //garticl_recr
41776>>>>>
41776>>>>>                 If (Found = 0);                 Begin //£ ¦¬¨å ¤â¦¬ garticl
41778>>>>>                       If (liGarticl_Create = FALSE) Send Operation_Not_Allowed 3010 //"Create Garticl !"
41781>>>>>                       //a)ç¨© gtypkin
41781>>>>>                       Send Clear to liGtypkin_dd
41782>>>>>                       Move lsGtypkin_Recr to Gtypkin.Gtypkin_Recr
41783>>>>>                       Send Find to liGtypkin_dd Eq 2 //gtypkin_recr
41784>>>>>                       If (Found = 0);                       Begin //â¤ ¨â¡ «¦ gtypkin
41786>>>>>                              Send Operation_Not_Allowed 3011 //"â¤ ¨â¡ «¦ original gtypkin"
41787>>>>>                       End
41787>>>>>>
41787>>>>>                 End
41787>>>>>>
41787>>>>>
41787>>>>>
41787>>>>>
41787>>>>>
41787>>>>>                 //â¢®¦ª «à¤ 4 flags
41787>>>>>                 //§¨â§  « flags 2,3,4 ¤ å¤  ¡¨ éª å ,
41787>>>>>                 //¤é «¦ flag 5 «ª ¢ ¤ å¤  false (¬«æ£« ¨å£©)
41787>>>>>                 Get File_Field_Current_Value of liGarticl_dd File_Field Gtypkin.Gtypkin_Flag02 to liGFlag02
41788>>>>>                 Get File_Field_Current_Value of liGarticl_dd File_Field Gtypkin.Gtypkin_Flag03 to liGFlag03
41789>>>>>                 Get File_Field_Current_Value of liGarticl_dd File_Field Gtypkin.Gtypkin_Flag04 to liGFlag04
41790>>>>>                 Get File_Field_Current_Value of liGarticl_dd File_Field Gtypkin.Gtypkin_Flag05 to liGFlag05
41791>>>>>                 If (;                     (liFlag02  <> liGFlag02) or;                     (liFlag03  <> liGFlag03) or;                     (liFlag04  <> liGFlag04) or;                     (liGFlag05 <> 0        )   ;                    );                 Begin
41793>>>>>                       Send Operation_Not_Allowed 3021 //"  ¡ ¤ã© ª â¤ å¤  ¦£¦ åª.¨¡¢é  ¦¨é©« « flags 2,3,4,5
41794>>>>>                 End
41794>>>>>>
41794>>>>>
41794>>>>>
41794>>>>>
41794>>>>>
41794>>>>>                 //cascade delete garticl
41794>>>>>                 If (liGarticl_Delete = TRUE);                 Begin //delete garticl
41796>>>>>                      Send Request_Delete to liGarticl_dd //â¤ ®¨ á¦¤«  validations & error trapping
41797>>>>>                                                          //å¦«  å£  £â© © transaction !
41797>>>>>                      Set psF_Garticl_Recr        of liCalling_dd to ''
41798>>>>>                      Set psF_Gmove_Master_Recr   of liCalling_dd to ''
41799>>>>>                      Set psF_Gmove_Slave_Recr    of liCalling_dd to ''
41800>>>>>                      Procedure_Return
41801>>>>>                 End   //«â¢¦ª cascade delete garticl
41801>>>>>>
41801>>>>>
41801>>>>>                 //edit or create  existing garticl (§á¤« £ « ª « £âª after!)
41801>>>>>                 If (liGarticl_Must_Be_Edited   = TRUE);                 Begin //create or edit garticl
41803>>>>>                      Set Field_Changed_Value          of liGarticl_dd Field Garticl.Garticl_Hmnia   to ldA_Garticl_Hmnia
41804>>>>>                      Set Field_Changed_Value          of liGarticl_dd Field Garticl.Garticl_No      to liA_Garticl_No
41805>>>>>                      Set Field_Changed_Value          of liGarticl_dd Field Garticl.Garticl_Aitiol  to lsA_Garticl_Aitiol
41806>>>>>                      Set Field_Changed_Value          of liGarticl_dd Field Garticl.Garticl_C_Code2 to lsA_Garticl_C_Code2
41807>>>>>                      Set Field_Changed_Value          of liGarticl_dd Field Garticl.Garticl_Rate0   to lnA_Garticl_Rate0
41808>>>>>                      Set Field_Changed_Value          of liGarticl_dd Field Garticl.Garticl_Rate00  to lnA_Garticl_Rate00
41809>>>>>                      Set Field_Changed_Value          of liGarticl_dd Field Garticl.Garticl_Rater   to lnA_Garticl_Rater
41810>>>>>                      Send Request_Save_No_Transaction to liGarticl_dd //â¤ ®¨ á¦¤«  validations & error trapping
41811>>>>>                                                                       //å¦«  å£  £â© © transaction !
41811>>>>>                 End   //«â¢¦ª create or edit garticl
41811>>>>>>
41811>>>>>                 //«â¢¦ª editing or creating garticl
41811>>>>>
41811>>>>>                 //é â¨®¦£  §¢â¦¤ £ current garticl record
41811>>>>>                 If ((Current_Record(liGarticl_dd)) = 0);                 Begin
41813>>>>>                      Send Operation_Not_Allowed 3012 //"no garticl current_record!"
41814>>>>>                 End
41814>>>>>>
41814>>>>>                 //feedback ¤£â¨à© «¦¬ calling dd, £æ¤¦¤ ©«¦ create
41814>>>>>                 Get Field_Current_Value  of liGarticl_dd Field Garticl.Garticl_Recr to lsF_Garticl_Recr
41815>>>>>
41815>>>>>                 //**************************************************************************
41815>>>>>                 //04.£ ¦¬¨å/ç¨©/¤£â¨à©/ ¨­ã master gmove
41815>>>>>                 //   ¬«æ ¡¦¢¦¬å «¦ å ¦ patern £ «¦ garticl
41815>>>>>                 //**************************************************************************
41815>>>>>                 Send Clear               to liGmove_dd
41816>>>>>                 Move lsGmove_Master_Recr to Gmove.Gmove_Recr
41817>>>>>                 Send Find to liGmove_dd Eq 2 //gmove_recr
41818>>>>>
41818>>>>>                 If (Found = 0);                 Begin //£ ¦¬¨å ¤â¦¬ master gmove
41820>>>>>                       If (liMaster_Gmove_Create = FALSE) Send Operation_Not_Allowed 3013 //"Create Master Gmove !"
41823>>>>>                       //a) ç¨© master gplan
41823>>>>>                       Send Clear to liGplan_dd
41824>>>>>                       Move lsGplan_Master_Recr to Gplan.Gplan_Recr
41825>>>>>                       Send Find to liGplan_dd Eq 2 //gplan_recr
41826>>>>>                       If (Found = 0);                       Begin //â¤ ¨â¡ «¦ master gplan
41828>>>>>                              Send Operation_Not_Allowed 3014 //"â¤ ¨â¡ «¦ original master gplan"
41829>>>>>                       End //«â¢¦ª ç¨©ª master gplan
41829>>>>>>
41829>>>>>                 End       //«â¢¦ª £ ¦¬¨åª ¤â¦¬ master gmove
41829>>>>>>
41829>>>>>
41829>>>>>                 //b) £ ¦¬¨å/¤£â¨à©/ ¨­ã master gmove
41829>>>>>
41829>>>>>                 Get Field_Current_Value of liGmove_dd Field Gmove.Gmove_X2             to lnO_Gmove_Master_X2 //§¢ á ®¨âà©  «¦¬ master gmove
41830>>>>>                 Get Field_Current_Value of liGmove_dd Field Gmove.Gmove_P2             to lnO_Gmove_Master_P2 //§¢ á §å©«à© «¦¬ master gmove
41831>>>>>
41831>>>>>                 Move (lnO_Gmove_Master_X2 + (lnA_Gmove_Master_X2-lnB_Gmove_Master_X2)) to lnN_Gmove_Master_X2 //¤â ®¨âà©  «¦¬ master gmove
41832>>>>>                 Move (lnO_Gmove_Master_P2 + (lnA_Gmove_Master_P2-lnB_Gmove_Master_P2)) to lnN_Gmove_Master_P2 //¤â §å©«à© «¦¬ master gmove
41833>>>>>
41833>>>>>                 If (;                     (lnN_Gmove_Master_X2 = 0) and;                     (lnN_Gmove_Master_P2 = 0);                    );                 Begin //b.1:  ¨­ã master gmove
41835>>>>>                       //¢¦ ¡á é â¤  §¨â§  §¦«â ¤ â¨à,  æ«  â®  §¨¦å
41835>>>>>                       // cascade delete «¦¬ garticl ! ! !
41835>>>>>                       Send Operation_Not_Allowed 3015 //"delete master gmove!"
41836>>>>>                       //**If (liMaster_Gmove_Delete = FALSE) Error 10001 "Delete Master Gmove !"
41836>>>>>                       //**If ((Current_Record(liGmove_dd)) = 0);
41836>>>>>                       //**Begin
41836>>>>>                       //**    Error 1003 "â¤ â®à current master gmove ¡  â¤ £§¦¨é ¤ ¡á¤à  ¨­ã!"
41836>>>>>                       //**    Procedure_Return
41836>>>>>                       //**End
41836>>>>>                       //**Send Request_Delete to liGmove_dd
41836>>>>>                       //**Move '' to lsF_Gmove_Master_Recr  //  «¤ feedback ¤£â¨à© «¦¬ calling dd
41836>>>>>                       //                                 // b - c - v - w move
41836>>>>>                 End   //«â¢¦ª  ¨­ãª master gmove
41836>>>>>>
41836>>>>>
41836>>>>>                 Else;                 Begin //b.2: £ ¦¬¨å/¤£â¨à© master gmove
41837>>>>>                       Set Field_Changed_Value of liGmove_dd Field Gmove.Gmove_X2     to lnN_Gmove_Master_X2
41838>>>>>                       Set Field_Changed_Value of liGmove_dd Field Gmove.Gmove_P2     to lnN_Gmove_Master_P2
41839>>>>>                       Set Field_Changed_Value of liGmove_dd Field Gmove.Gmove_Aitiol to lsA_Gmove_Master_Aitiol
41840>>>>>                       Send Request_Save       to liGmove_dd
41841>>>>>                 End   //«â¢¦ª £ ¦¬¨åª/¤£â¨à©ª master gmove
41841>>>>>>
41841>>>>>
41841>>>>>                 //é â¨®¦£  §¢â¦¤ £ current gmove master record
41841>>>>>                 If ((Current_Record(liGmove_dd)) = 0);                 Begin
41843>>>>>                      Send Operation_Not_Allowed 3016 //"no master gmove current_record!"
41844>>>>>                 End
41844>>>>>>
41844>>>>>                 //feedback ¤£â¨à© «¦¬ calling dd, £æ¤¦¤ ©«¦ create
41844>>>>>                 Get Field_Current_Value of liGmove_dd Field Gmove.Gmove_Recr   to lsF_Gmove_Master_Recr
41845>>>>>
41845>>>>>
41845>>>>>                 //**************************************************************************
41845>>>>>                 //05.£ ¦¬¨å/ç¨© ¡  ¤£â¨à© slave gmove
41845>>>>>                 //**************************************************************************
41845>>>>>                 Send Clear to liGmove_dd
41846>>>>>                 Move lsGmove_Slave_Recr to Gmove.Gmove_Recr
41847>>>>>                 Send Find to liGmove_dd Eq 2 //gmove_recr
41848>>>>>
41848>>>>>                 If (Found = 0);                 Begin //£ ¦¬¨å ¤â¦¬ slave gmove
41850>>>>>                       If (liSlave_Gmove_Create = FALSE) Send Operation_Not_Allowed 3017 //"Create Slave Gmove !"
41853>>>>>                       //a) ç¨© slave gplan
41853>>>>>                       Send Clear to liGplan_dd
41854>>>>>                       Move lsGplan_Slave_Recr to Gplan.Gplan_Recr
41855>>>>>                       Send Find to liGplan_dd Eq 2 //gplan_recr
41856>>>>>                       If (Found = 0);                       Begin //â¤ ¨â¡ «¦ slave gplan
41858>>>>>                              Send Operation_Not_Allowed 3018 //â¤ ¨â¡ «¦ original slave gplan
41859>>>>>                       End   //«â¢¦ª ç¨©ª slave gplan
41859>>>>>>
41859>>>>>                 End         //«â¢¦ª £ ¦¬¨åª ¤â¦¬ slave gmove
41859>>>>>>
41859>>>>>
41859>>>>>                 //b) £ ¦¬¨å/¤£â¨à©/ ¨­ã slave gmove
41859>>>>>                 Get Field_Current_Value of liGmove_dd Field Gmove.Gmove_X2          to lnO_Gmove_Slave_X2 //§¢ á ®¨âà©  «¦¬ Slave gmove
41860>>>>>                 Get Field_Current_Value of liGmove_dd Field Gmove.Gmove_P2          to lnO_Gmove_Slave_P2 //§¢ á §å©«à© «¦¬ Slave gmove
41861>>>>>
41861>>>>>                 Move (lnO_Gmove_Slave_X2 + (lnA_Gmove_Slave_X2-lnB_Gmove_Slave_X2)) to lnN_Gmove_Slave_X2 //¤â ®¨âà©  «¦¬ Slave gmove
41862>>>>>                 Move (lnO_Gmove_Slave_P2 + (lnA_Gmove_Slave_P2-lnB_Gmove_Slave_P2)) to lnN_Gmove_Slave_P2 //¤â §å©«à© «¦¬ Slave gmove
41863>>>>>
41863>>>>>                 If (;                     (lnN_Gmove_Slave_X2 = 0) and;                     (lnN_Gmove_Slave_P2 = 0);                    );                 Begin //b.1:  ¨­ã slave gmove
41865>>>>>                       If (liSlave_Gmove_Delete = FALSE) Send Operation_Not_Allowed 3019 //"Delete Slave Gmove !"
41868>>>>>                       If ((Current_Record(liGmove_dd)) = 0);                       Begin
41870>>>>>                           Send Operation_Not_Allowed 3020 //"â¤ â®à current slave gmove ¡  â¤ £§¦¨é ¤ ¡á¤à  ¨­ã"
41871>>>>>                       End
41871>>>>>>
41871>>>>>                       Send Request_Delete to liGmove_dd
41872>>>>>                       Move 0 to lsF_Gmove_Slave_Recr  //  «¤ feedback ¤£â¨à© «¦¬ calling dd
41873>>>>>                                                       // b - c - v - w move
41873>>>>>                 End   //«â¢¦ª  ¨­ãª Slave gmove
41873>>>>>>
41873>>>>>
41873>>>>>                 Else;                 Begin //b.2: £ ¦¬¨å/¤£â¨à© Slave gmove
41874>>>>>                       //If ((liSlave_Gmove_Create = 0) and (liSlave_Gmove_Edit = 0)) Error 10001 "Create/Edit Slave Gmove !"
41874>>>>>                       Set Field_Changed_Value of liGmove_dd Field Gmove.Gmove_X2     to lnN_Gmove_Slave_X2
41875>>>>>                       Set Field_Changed_Value of liGmove_dd Field Gmove.Gmove_P2     to lnN_Gmove_Slave_P2
41876>>>>>                       Set Field_Changed_Value of liGmove_dd Field Gmove.Gmove_Aitiol to lsA_Gmove_Slave_Aitiol
41877>>>>>                       Send Request_Save       to liGmove_dd
41878>>>>>                       Get Field_Current_Value of liGmove_dd Field Gmove.Gmove_Recr   to lsF_Gmove_Slave_Recr   //  «¤ feedback ¤£â¨à© «¦¬ calling dd
41879>>>>>                                                                                                                // b - c - v - w move
41879>>>>>                 End   //«â¢¦ª £ ¦¬¨åª/¤£â¨à©ª slave  gmove
41879>>>>>>
41879>>>>>
41879>>>>>
41879>>>>>                 //**************************************************************************
41879>>>>>                 //06.â¢®¦ª á¨¨¦¬
41879>>>>>                 //**************************************************************************
41879>>>>>                 //send check_arthro_for_ypol ( æ«  £§¦¨å ¤ ¢¢á¥   ©¦« £å !)
41879>>>>>
41879>>>>>                 //**************************************************************************
41879>>>>>                 //07.feedback ¤£â¨à© «¦¬ ¡¢¦ç¤«¦ª ddo
41879>>>>>                 //**************************************************************************
41879>>>>>                 //©«á¨ ©£ « £é¤/properties «¦¬ ¡¢¦ç¤«¦ª ddo
41879>>>>>                 Set psF_Garticl_Recr        of liCalling_dd to lsF_Garticl_Recr
41880>>>>>                 Set psF_Gmove_Master_Recr   of liCalling_dd to lsF_Gmove_Master_Recr
41881>>>>>                 Set psF_Gmove_Slave_Recr    of liCalling_dd to lsF_Gmove_Slave_Recr
41882>>>>>       End_Procedure //private.Transaction_BCVWmove_update_gmove
41883>>>>>       //****************************************************************************
41883>>>>>       //*                                          *
41883>>>>>       //****************************************************************************
41883>>>>>
41883>>>>>
41883>>>>>
41883>>>>>       //****************************************************************************
41883>>>>>       //*                                                       *
41883>>>>>       //****************************************************************************
41883>>>>>       //private
41883>>>>>       //4:¨¦¬«å¤  ¨­ãª á¨¨¦¬
41883>>>>>       //transaction enabled !
41883>>>>>       Procedure private.Transaction_Delete_Garticl
41885>>>>>                 Integer  liCalling_dd liCalling_dd_Current_Recnum liGarticl_dd
41886>>>>>                 String   lsGarticl_Recr
41886>>>>>
41886>>>>>                 //4 flags §¦¬ §¨¤á  £ ¦¨å©£« «¦ ¡¢æ¤ ddo
41886>>>>>                 Integer liFlag02 liFlag03 liFlag04 liFlag05
41886>>>>>
41886>>>>>                 //4 flags §¦¬  áà §¦ «¦ gtypkin
41886>>>>>                 Integer liGFlag02 liGFlag03 liGFlag04 liGFlag05
41886>>>>>
41886>>>>>                 //ç¨© ¡¢¦ç¤«¦ª ddo
41886>>>>>                 Get piCalling_dd to liCalling_dd
41887>>>>>
41887>>>>>                 //â¢®¦ª ¡¢¦ç¤«¦ª ddo (á¤ 0, ¡á¤«¤)
41887>>>>>                 If (liCalling_dd = 0) Send Operation_Not_Allowed 4001 //"dâ¤ £ ¡á¢© ¡¤åª!"
41890>>>>>
41890>>>>>                 //ç¨© current_record ¡¢¦ç¤«¦ª ddo
41890>>>>>                 Get Current_Record of liCalling_dd to liCalling_dd_Current_Recnum
41891>>>>>
41891>>>>>                 //â¢®¦ª current_record (á¤ 0, ¡á¤«¤)
41891>>>>>                 //prosoxi sto delete !!!*** (¡  æ£àª, æ¢àª §¨ â¨àª, â®à current record!)
41891>>>>>                 If (liCalling_dd_Current_Recnum = 0) Send Operation_Not_Allowed 4002 //"«¦ ¡¢æ¤ ddo â¤ â®  current record!"
41894>>>>>
41894>>>>>                 //¤á¤à© recr «¦¬ ¬§æ  ¨­ã á¨¨¦¬
41894>>>>>                 Get psGarticl_Recr to lsGarticl_Recr
41895>>>>>
41895>>>>>                 //unfortunatly, §¨â§  ¤ «¨â¥à!
41895>>>>>
41895>>>>>                 //¤á¤à© 4 flags
41895>>>>>                  Get piFlag02 to liFlag02
41896>>>>>                  Get piFlag03 to liFlag03
41897>>>>>                  Get piFlag04 to liFlag04
41898>>>>>                  Get piFlag05 to liFlag05
41899>>>>>
41899>>>>>                 //**************************************************************************
41899>>>>>                 //01.ç¨© object id's «à¤ £§¢¡¦£â¤à¤ ddo's
41899>>>>>                 //**************************************************************************
41899>>>>>                 Move (Garticl_dd(Self))  to liGarticl_dd
41900>>>>>
41900>>>>>                 //**************************************************************************
41900>>>>>                 //02.rebuild constraints, ¢æà «à¤ ¡¢á©à¤
41900>>>>>                 //**************************************************************************
41900>>>>>                 Set piMode of liGarticl_dd to 0 //¤£â¨à© ¢ §æ b+c+v+wmove
41901>>>>>                 Send Private.Rebuild_All_Constraints
41902>>>>>
41902>>>>>                 //**************************************************************************
41902>>>>>                 //03. ¨­ã garticl
41902>>>>>                 //**************************************************************************
41902>>>>>                 Send Clear to liGarticl_dd
41903>>>>>                 Move lsGarticl_Recr to Garticl.Garticl_Recr
41904>>>>>                 Send Find to liGarticl_dd Eq 2 //garticl_recr
41905>>>>>
41905>>>>>                 If (Found = 0);                 Begin //â¤ ¨â¡ «¦ ¬§æ  ¨­ã garticl
41907>>>>>                       Send Operation_Not_Allowed 4003 //"â¤ ¨â¡ «¦ Garticl!
41908>>>>>                 End
41908>>>>>>
41908>>>>>
41908>>>>>                 //â¢®¦ª «à¤ 4 flags
41908>>>>>                 Get File_Field_Current_Value of liGarticl_dd File_Field Gtypkin.Gtypkin_Flag02 to liGFlag02
41909>>>>>                 Get File_Field_Current_Value of liGarticl_dd File_Field Gtypkin.Gtypkin_Flag03 to liGFlag03
41910>>>>>                 Get File_Field_Current_Value of liGarticl_dd File_Field Gtypkin.Gtypkin_Flag04 to liGFlag04
41911>>>>>                 Get File_Field_Current_Value of liGarticl_dd File_Field Gtypkin.Gtypkin_Flag05 to liGFlag05
41912>>>>>                 If (;                     (liFlag02  <> liGFlag02) or;                     (liFlag03  <> liGFlag03) or;                     (liFlag04  <> liGFlag04) or;                     (liGFlag05 <> 0        )   ;                    );                 Begin
41914>>>>>                       Send Operation_Not_Allowed 4004 //"  ¡ ¤ã© ª â¤ å¤  ¦£¦ åª.¨¡¢é  ¦¨é©« « flags 2,3,4,5
41915>>>>>                 End
41915>>>>>>
41915>>>>>
41915>>>>>                 //cascade delete garticl
41915>>>>>                      Send Request_Delete to liGarticl_dd //â¤ ®¨ á¦¤«  validations & error trapping
41916>>>>>                                                          //å¦«  å£  £â© © transaction !
41916>>>>>       End_Procedure //private.transaction_delete_garticl
41917>>>>>       //****************************************************************************
41917>>>>>       //*                                                      *
41917>>>>>       //****************************************************************************
41917>>>>>
41917>>>>>
41917>>>>>
41917>>>>>       //****************************************************************************
41917>>>>>       //*                                                         *
41917>>>>>       //****************************************************************************
41917>>>>>       //private
41917>>>>>       //5:¨¦¬«å¤ ¤£â¨à©ª á¨¨¦¬
41917>>>>>       //transaction enabled !
41917>>>>>       //«¦ ¡¢æ¤ ddo å¤  «¦ barticl + cmove + vmove + ...
41917>>>>>       Procedure private.Transaction_Update_Garticl
41919>>>>>                 Integer  liCalling_dd liCalling_dd_Current_Recnum
41920>>>>>                 Integer  liGarticl_dd
41920>>>>>                 String   lsGarticl_Recr
41920>>>>>
41920>>>>>                 //3 properties §¦¬  áà §¦ «¦ ¡¢æ¤ ddo
41920>>>>>                 Date     ldB_Garticl_Hmnia          ldA_Garticl_Hmnia
41920>>>>>                 Integer  liB_Garticl_No             liA_Garticl_No
41920>>>>>                 String   lsB_Garticl_Aitiol         lsA_Garticl_Aitiol
41920>>>>>
41920>>>>>                 //4 flags §¦¬ §¨¤á  £ ¦¨å©£« «¦ ¡¢æ¤ ddo
41920>>>>>                 Integer liFlag02 liFlag03 liFlag04 liFlag05
41920>>>>>
41920>>>>>                 //4 flags §¦¬  áà §¦ «¦ gtypkin
41920>>>>>                 Integer liGFlag02 liGFlag03 liGFlag04 liGFlag05
41920>>>>>
41920>>>>>                 //ç¨© ¡¢¦ç¤«¦ª ddo
41920>>>>>                 Get piCalling_dd to liCalling_dd
41921>>>>>
41921>>>>>                 //â¢®¦ª ¡¢¦ç¤«¦ª ddo (á¤ 0, ¡á¤«¤)
41921>>>>>                 If (liCalling_dd = 0) Send Operation_Not_Allowed 5001 //"dâ¤ £ ¡á¢© ¡¤åª!"
41924>>>>>
41924>>>>>                 //ç¨© current_record ¡¢¦ç¤«¦ª ddo
41924>>>>>                 Get Current_Record of liCalling_dd to liCalling_dd_Current_Recnum
41925>>>>>
41925>>>>>                 //â¢®¦ª current_record (á¤ 0, ¡á¤«¤)
41925>>>>>                 //prosoxi sto delete !!!*** (¡  æ£àª, æ¢àª §¨ â¨àª, â®à current record!)
41925>>>>>                 If (liCalling_dd_Current_Recnum = 0) Send Operation_Not_Allowed 5002 //"«¦ ¡¢æ¤ ddo â¤ â®  current record!"
41928>>>>>
41928>>>>>                 //¤á¤à© recr «¦¬ ¬§æ  ¨­ã á¨¨¦¬
41928>>>>>                 Get psGarticl_Recr to lsGarticl_Recr
41929>>>>>
41929>>>>>                 //¤á¤à© 3 §¢ é¤ « £é¤ «¦¬ ¡¢¦ç¤«¦ª ddo
41929>>>>>                 Get pdB_Garticl_Hmnia       of liCalling_dd to ldB_Garticl_Hmnia
41930>>>>>                 Get piB_Garticl_No          of liCalling_dd to liB_Garticl_No
41931>>>>>                 Get psB_Garticl_Aitiol      of liCalling_dd to lsB_Garticl_Aitiol
41932>>>>>
41932>>>>>                 //¤á¤à© 3 ¤âà¤ « £é¤ «¦¬ ¡¢¦ç¤«¦ª ddo
41932>>>>>                 Get pdA_Garticl_Hmnia       of liCalling_dd to ldA_Garticl_Hmnia
41933>>>>>                 Get piA_Garticl_No          of liCalling_dd to liA_Garticl_No
41934>>>>>                 Get psA_Garticl_Aitiol      of liCalling_dd to lsA_Garticl_Aitiol
41935>>>>>
41935>>>>>                 //á¤ æ¢ª ¦  §¨á£«¨¦  before+after å¤  å©ª,
41935>>>>>                 //«æ« â¤ £§å¤à ¡æ¢¦¬ ©«¦¤ ¡æ§¦ ¤ «¨â¥à,
41935>>>>>                 //¢¢á ­çà ...«¨â®¦¤«ª!
41935>>>>>                 If (;                      (ldB_Garticl_Hmnia  = ldA_Garticl_Hmnia  ) and;                      (liB_Garticl_No     = liA_Garticl_No     ) and;                      (lsB_Garticl_Aitiol = lsA_Garticl_Aitiol )    ;                     ) Begin
41937>>>>>                        Procedure_Return
41938>>>>>                       End
41938>>>>>>
41938>>>>>
41938>>>>>                 //¤­¦¨¤«¢¢¬, §¨â§  ¤ «¨â¥à!
41938>>>>>
41938>>>>>                 //¤á¤à© 4 flags
41938>>>>>                  Get piFlag02 to liFlag02
41939>>>>>                  Get piFlag03 to liFlag03
41940>>>>>                  Get piFlag04 to liFlag04
41941>>>>>                  Get piFlag05 to liFlag05
41942>>>>>
41942>>>>>                 //**************************************************************************
41942>>>>>                 //01.ç¨© object id's «à¤ £§¢¡¦£â¤à¤ ddo's
41942>>>>>                 //**************************************************************************
41942>>>>>                 Move (Garticl_dd(Self))  to liGarticl_dd
41943>>>>>
41943>>>>>                 //**************************************************************************
41943>>>>>                 //02.rebuild constraints, ¢æà «à¤ ¡¢á©à¤
41943>>>>>                 //**************************************************************************
41943>>>>>                 Set piMode of liGarticl_dd to 0 //¤£â¨à© ¢ §æ b+c+v+wmove
41944>>>>>                 Send Private.Rebuild_All_Constraints
41945>>>>>
41945>>>>>                 //**************************************************************************
41945>>>>>                 //03.edit garticl
41945>>>>>                 //**************************************************************************
41945>>>>>                 Send Clear to liGarticl_dd
41946>>>>>                 Move lsGarticl_Recr to Garticl.Garticl_Recr
41947>>>>>                 Send Find to liGarticl_dd Eq 2 //garticl_recr
41948>>>>>
41948>>>>>                 If (Found = 0);                 Begin //â¤ ¨â¡ «¦ ¬§æ  ¨­ã garticl
41950>>>>>                       Send Operation_Not_Allowed 5003 //"â¤ ¨â¡ «¦ Garticl!
41951>>>>>                 End
41951>>>>>>
41951>>>>>
41951>>>>>                 //â¢®¦ª «à¤ 4 flags
41951>>>>>                 Get File_Field_Current_Value of liGarticl_dd File_Field Gtypkin.Gtypkin_Flag02 to liGFlag02
41952>>>>>                 Get File_Field_Current_Value of liGarticl_dd File_Field Gtypkin.Gtypkin_Flag03 to liGFlag03
41953>>>>>                 Get File_Field_Current_Value of liGarticl_dd File_Field Gtypkin.Gtypkin_Flag04 to liGFlag04
41954>>>>>                 Get File_Field_Current_Value of liGarticl_dd File_Field Gtypkin.Gtypkin_Flag05 to liGFlag05
41955>>>>>                 If (;                     (liFlag02  <> liGFlag02) or;                     (liFlag03  <> liGFlag03) or;                     (liFlag04  <> liGFlag04) or;                     (liGFlag05 <> 0        )   ;                    );                 Begin
41957>>>>>                       Send Operation_Not_Allowed 5004 //"  ¡ ¤ã© ª â¤ å¤  ¦£¦ åª.¨¡¢é  ¦¨é©« « flags 2,3,4,5
41958>>>>>                 End
41958>>>>>>
41958>>>>>
41958>>>>>                 //update garticl
41958>>>>>                 Set Field_Changed_Value          of liGarticl_dd Field Garticl.Garticl_Hmnia   to ldA_Garticl_Hmnia
41959>>>>>                 Set Field_Changed_Value          of liGarticl_dd Field Garticl.Garticl_No      to liA_Garticl_No
41960>>>>>                 Set Field_Changed_Value          of liGarticl_dd Field Garticl.Garticl_Aitiol  to lsA_Garticl_Aitiol
41961>>>>>                 Send Request_Save_No_Transaction to liGarticl_dd //â¤ ®¨ á¦¤«  validations & error trapping
41962>>>>>                                                                       //å¦«  å£  £â© © transaction !
41962>>>>>       End_Procedure //private.transaction_update_garticl
41963>>>>>       //****************************************************************************
41963>>>>>       //*                                                        *
41963>>>>>       //****************************************************************************
41963>>>>>
41963>>>>>
41963>>>>>
41963>>>>>
41963>>>>>
41963>>>>>
41963>>>>>
41963>>>>>
41963>>>>>
41963>>>>>       //****************************************************************************
41963>>>>>       //*                             G B R I D G E               *
41963>>>>>       //****************************************************************************
41963>>>>>       //private
41963>>>>>       //6:¨¦¬«å¤ª ¤£â¨à©ª ¢ §¦ «¦ ¨®å¦ gbridge
41963>>>>>       //transaction enabled !
41963>>>>>
41963>>>>>
41963>>>>>       //private
41963>>>>>       //¡¢å«  §æ «¤ private.transaction_update_gl_from_gbridge
41963>>>>>       Function  private.Transaction_Create_Garticl_from_Gbridgeh String  lsYear_Recr;                                                                  Integer lsGarticl_Recr;                                                                  Integer lsGtypkin_Recr;                                                                  Date    ldGarticl_Hmnia;                                                                  Integer liGarticl_No;                                                                  String  lsGarticl_Aitiol;                                                                  String  lsGarticl_C_Code2;                                                                  Number  lnGarticl_Rate0;                                                                  Number  lnGarticl_Rate00;                                                                  Number  lnGarticl_Rater;                                                                  Returns Integer
41965>>>>>
41965>>>>>                 //object id's «à¤ £§¢¡¦£â¤à¤ ddo's
41965>>>>>                 Integer  liGtypkin_dd liGarticl_dd
41966>>>>>
41966>>>>>                 //4 flags §¦¬ §¨¤á  £ ¦¨å©£« «¦ ¡¢æ¤ ddo
41966>>>>>                 Integer liFlag02 liFlag03 liFlag04 liFlag05
41966>>>>>
41966>>>>>                 //4 flags §¦¬  áà §¦ «¦ gtypkin
41966>>>>>                 Integer liGFlag02 liGFlag03 liGFlag04 liGFlag05
41966>>>>>
41966>>>>>                 //return value   «¤ feedback ¤£â¨à© «¦¬ gbridgeh
41966>>>>>                 Integer lsF_Garticl_Recr
41966>>>>>
41966>>>>>           If (giWait_Obj <> 0);                 Send UpdateWait to giWait_Obj (;                                                "BPO GLMNTN:¨¨¦:";                                                +(String(ldGarticl_Hmnia));                                                +":"+(String(liGarticl_No));                                                +":"+(Trim(lsGarticl_C_Code2));                                               )
41969>>>>>
41969>>>>>
41969>>>>>
41969>>>>>
41969>>>>>                 //01.¤á¤à© 4 flags §¦¬ §â¨© £ ¦¨å©£« «¦ ¡¢æ¤ ddo
41969>>>>>                 Get piFlag02 to liFlag02
41970>>>>>                 Get piFlag03 to liFlag03
41971>>>>>                 Get piFlag04 to liFlag04
41972>>>>>                 Get piFlag05 to liFlag05
41973>>>>>
41973>>>>>                 //02.ç¨© object id's «à¤ £§¢¡¦£â¤à¤ ddo's
41973>>>>>                 Move (Gtypkin_dd(Self))  to liGtypkin_dd
41974>>>>>                 Move (Garticl_dd(Self))  to liGarticl_dd
41975>>>>>
41975>>>>>                 //03.ç¨© year
41975>>>>>                 //04.rebuild constraints, ¢æà «à¤ ¡¢á©à¤
41975>>>>>                 Set piMode of liGarticl_dd to 0 //¤£â¨à© ¢ §æ gbridge
41976>>>>>                 Send Private.Rebuild_All_Constraints
41977>>>>>
41977>>>>>                 //05.£ ¦¬¨å/ç¨©/¤£â¨à©/ ¨­ã garticl
41977>>>>>                 Send Clear to liGarticl_dd
41978>>>>>                 Move lsGarticl_Recr to Garticl.Garticl_Recr
41979>>>>>                 Send Find to liGarticl_dd Eq 2 //garticl_recr
41980>>>>>
41980>>>>>                 //cascade delete garticl   ¤ ¡á¤à ©« ©¬¤â®  create
41980>>>>>                 If (Found = 1);                 Begin // ¨­ã §¢ ¦ç garticl
41982>>>>>                      Send Request_Delete to liGarticl_dd //â¤ ®¨ á¦¤«  validations & error trapping
41983>>>>>                                                          //å¦«  å£  £â© © transaction !
41983>>>>>                      Send Clear to liGarticl_dd
41984>>>>>                 End   //«â¢¦ª cascade delete garticl
41984>>>>>>
41984>>>>>
41984>>>>>                 //£ ¦¬¨å ¤â¦¬ garticl
41984>>>>>                 //a)ç¨© gtypkin
41984>>>>>                 Send Clear to liGtypkin_dd
41985>>>>>                 Move lsGtypkin_Recr to Gtypkin.Gtypkin_Recr
41986>>>>>                 Send Find to liGtypkin_dd Eq 2 //gtypkin_recr
41987>>>>>                 If (Found = 0);                 Begin //â¤ ¨â¡ «¦ gtypkin
41989>>>>>                       Send Operation_Not_Allowed 6011 //"â¤ ¨â¡ «¦ original gtypkin"
41990>>>>>                 End
41990>>>>>>
41990>>>>>
41990>>>>>                 //06.â¢®¦ª «à¤ 4 flags
41990>>>>>                 //§¨â§  « flags 2,3,4 ¤ å¤  ¡¨ éª å ,
41990>>>>>                 //¤é «¦ flag 5 «ª ¢ ¤ å¤  false (¬«æ£« ¨å£©)
41990>>>>>                 Get File_Field_Current_Value of liGarticl_dd File_Field Gtypkin.Gtypkin_Flag02 to liGFlag02
41991>>>>>                 Get File_Field_Current_Value of liGarticl_dd File_Field Gtypkin.Gtypkin_Flag03 to liGFlag03
41992>>>>>                 Get File_Field_Current_Value of liGarticl_dd File_Field Gtypkin.Gtypkin_Flag04 to liGFlag04
41993>>>>>                 Get File_Field_Current_Value of liGarticl_dd File_Field Gtypkin.Gtypkin_Flag05 to liGFlag05
41994>>>>>                 If (;                     (liFlag02  <> liGFlag02) or;                     (liFlag03  <> liGFlag03) or;                     (liFlag04  <> liGFlag04) or;                     (liGFlag05 <> 0        )   ;                    );                 Begin
41996>>>>>                       Send Operation_Not_Allowed 6021 //"  ¡ ¤ã© ª â¤ å¤  ¦£¦ åª.¨¡¢é  ¦¨é©« « flags 2,3,4,5
41997>>>>>                 End
41997>>>>>>
41997>>>>>
41997>>>>>                 Set Field_Changed_Value          of liGarticl_dd Field Garticl.Garticl_Hmnia   to ldGarticl_Hmnia
41998>>>>>                 Set Field_Changed_Value          of liGarticl_dd Field Garticl.Garticl_No      to liGarticl_No
41999>>>>>                 Set Field_Changed_Value          of liGarticl_dd Field Garticl.Garticl_Aitiol  to lsGarticl_Aitiol
42000>>>>>                 Set Field_Changed_Value          of liGarticl_dd Field Garticl.Garticl_C_Code2 to lsGarticl_C_Code2
42001>>>>>                 Set Field_Changed_Value          of liGarticl_dd Field Garticl.Garticl_Rate0   to lnGarticl_Rate0
42002>>>>>                 Set Field_Changed_Value          of liGarticl_dd Field Garticl.Garticl_Rate00  to lnGarticl_Rate00
42003>>>>>                 Set Field_Changed_Value          of liGarticl_dd Field Garticl.Garticl_Rater   to lnGarticl_Rater
42004>>>>>                 Send Request_Save_No_Transaction to liGarticl_dd //â¤ ®¨ á¦¤«  validations & error trapping
42005>>>>>                                                                  //å¦«  å£  £â© © transaction !
42005>>>>>                 //07.feedback ¤£â¨à© «¦¬ gbridgeh
42005>>>>>                 Get Field_Current_Value  of liGarticl_dd Field Garticl.Garticl_Recr to lsF_Garticl_Recr
42006>>>>>                 Function_Return lsF_Garticl_Recr
42007>>>>>       End_Function  //private.transaction_create_garticl_from_gbridgeh
42008>>>>>
42008>>>>>
42008>>>>>       //private
42008>>>>>       //¡¢å«  §æ «¤ private.transaction_update_gl_from_gbridge
42008>>>>>       //©¨é¤  æ¢ « child gbridged «¦¬ gbridgeh ¡  ¤£¨é¤  «¤ ¢ (gmoves).
42008>>>>>       //§¨â§  ¦§à©ã§¦« ¤ â®  current record «¦ garticl, else abort transaction
42008>>>>>       Procedure private.Transaction_Scan_Gbridged String lsGbridgeh_Recr
42010>>>>>                 Integer liGmove_dd liGplan_dd
42011>>>>>                 String lsF_Gmove_Recr
42011>>>>>
42011>>>>>                 Move (Gmove_dd(Self)) to liGmove_dd
42012>>>>>                 Move (Gplan_dd(Self)) to liGplan_dd
42013>>>>>
42013>>>>>                 Clear Gbridged
42014>>>>>                 Move lsGbridgeh_Recr to Gbridged.Gbridgeh_Recr
42015>>>>>                 Find Gt Gbridged by Index.1 //index.1:gbridged:gbridgeh_recr+ext_gplan_code+recnum
42016>>>>>>
42016>>>>>                 While (;                        (Found=1) and;                        (lsGbridgeh_Recr = Gbridged.Gbridgeh_Recr);                       )
42020>>>>>                       If (giWait_Obj <> 0);                       Send UpdateWait to giWait_Obj (;                                                      "BPO GLMNTN:¨­ã:";                                                      +    (String(Gbridged.Gmove_X2));                                                      +":"+(String(Gbridged.Gmove_P2));                                                      +":"+(Trim  (Gbridged.Ext_Gplan_Code));                                                     )
42023>>>>>
42023>>>>>                        Send Clear to liGmove_dd
42024>>>>>                        Move Gbridged.Gmove_Recr to Gmove.Gmove_Recr
42025>>>>>                        Send Find to liGmove_dd Eq 2 //gmove_recr
42026>>>>>                        If (Found=1);                        Begin
42028>>>>>                             Send Operation_Not_Allowed 6023 //¦¢ ¡æª â¢®¦ª
42029>>>>>                        End
42029>>>>>>
42029>>>>>
42029>>>>>                        //a) ç¨© gplan
42029>>>>>                        Move Gbridged.Gplan_Recr to Gplan.Gplan_Recr
42030>>>>>                        Send Find to liGplan_dd Eq 2 //gplan_recr
42031>>>>>                        If (Found = 0);                        Begin //â¤ ¨â¡ «¦ gplan
42033>>>>>                               Send Operation_Not_Allowed 6014 //"â¤ ¨â¡ «¦ gplan"
42034>>>>>                        End //«â¢¦ª ç¨©ª gplan
42034>>>>>>
42034>>>>>
42034>>>>>                        //b: £ ¦¬¨å gmove
42034>>>>>                        Set Field_Changed_Value of liGmove_dd Field Gmove.Gmove_X2     to Gbridged.Gmove_X2
42035>>>>>                        Set Field_Changed_Value of liGmove_dd Field Gmove.Gmove_P2     to Gbridged.Gmove_P2
42036>>>>>                        Set Field_Changed_Value of liGmove_dd Field Gmove.Gmove_Aitiol to Gbridged.Gmove_Aitiol
42037>>>>>                        Send Request_Save       to liGmove_dd
42038>>>>>
42038>>>>>                        //c: feedback ¤£â¨à© «¦¬ gbridged
42038>>>>>                        Get Field_Current_Value  of liGmove_dd Field Gmove.Gmove_Recr to lsF_Gmove_Recr
42039>>>>>                        Move lsF_Gmove_Recr to Gbridged.Gmove_Recr
42040>>>>>                        Saverecord Gbridged
42041>>>>>
42041>>>>>                        Find Gt Gbridged by Index.1 //gbridgeh_recr+recnum
42042>>>>>>
42042>>>>>                 Loop //«â¢¦ª ©á¨à©ª gbridged
42043>>>>>>
42043>>>>>       End_Procedure //private.transaction_scan_gbridged
42044>>>>>
42044>>>>>
42044>>>>>       //private
42044>>>>>       //¡¤«¨ ¡ã ¨¦¬«å¤ ¤£â¨à©ª ¢ §¦ «¦ ¨®å¦ gbridge
42044>>>>>       //transaction enabled !
42044>>>>>       //«¦ ¡¢æ¤ ddo ¡«'¨®áª £§¦¨å ¤ £ã¤ å¤  ddo (§® §¦ «¤ enhmgl.cls «¦¬ ad),
42044>>>>>       //¢¢á ¬«æ â¤ £ª § ¨á 
42044>>>>>       //¡¢å « ª : ) private.transaction_create_garticl_from_gbridgeh
42044>>>>>       //            ) private.transaction_scan_gbridged
42044>>>>>       Procedure private.Transaction_Update_GL_From_Gbridge Integer lsGbridgeh_Recr
42046>>>>>
42046>>>>>                 Integer  liCalling_dd
42047>>>>>
42047>>>>>                 //**************************************************************************
42047>>>>>                 //01.ç¨© ¡¢¦ç¤«¦ª object id (â¤ å¤  ddo !)
42047>>>>>                 //**************************************************************************
42047>>>>>                 Get piCalling_dd to liCalling_dd
42048>>>>>
42048>>>>>                 //**************************************************************************
42048>>>>>                 //02.â¢®¦ª ¡¢¦ç¤«¦ª object id (á¤ 0, ¡á¤«¤)
42048>>>>>                 //**************************************************************************
42048>>>>>                 If (liCalling_dd = 0) Send Operation_Not_Allowed 6001 //"dâ¤ £ ¡á¢© ¡¤åª!"
42051>>>>>
42051>>>>>                 //**************************************************************************
42051>>>>>                 //06.©á¨à© gbridgeh   æ¢ « ¡¡¨£ã á¨¨, ­'æ©¦¤ â®à «ã©  batch  â­¬¨,
42051>>>>>                 //   ¢¢¦ éª,
42051>>>>>                 //   ç¨© gbridgeh_recr ¡  ¤£â¨à© ¢   , ­'æ©¦¤ â®à «ã©  online â­¬¨
42051>>>>>                 //**************************************************************************
42051>>>>>                 If (lsGbridgeh_Recr = '');                 Begin //¨®ã batch ¤£â¨à©ª «ª ¢
42053>>>>>                       Clear Gbridgeh
42054>>>>>                       Move 0 to Gbridgeh.Gbridgeh_Flag
42055>>>>>                       Find Gt Gbridgeh by Index.3 //gbrigdeh_flag+extinv_recr
42056>>>>>>
42056>>>>>                       While (;                              (Found=1) and;                              (Gbridgeh.Gbridgeh_Flag = FALSE);                             )
42060>>>>>                             Move (private.Transaction_Create_Garticl_from_Gbridgeh(Self,;                                                                                    Gbridgeh.Year_Recr,;                                                                                    Gbridgeh.Garticl_Recr,;                                                                                    Gbridgeh.Gtypkin_Recr,;                                                                                    Gbridgeh.Garticl_Hmnia,;                                                                                    Gbridgeh.Garticl_No,;                                                                                    Gbridgeh.Garticl_Aitiol,;                                                                                    Gbridgeh.Garticl_C_Code2,;                                                                                    Gbridgeh.Garticl_Rate0,;                                                                                    Gbridgeh.Garticl_Rate00,;                                                                                    Gbridgeh.Garticl_Rater);                                  ) to Gbridgeh.Garticl_Recr
42061>>>>>
42061>>>>>                             Send private.Transaction_Scan_Gbridged Gbridgeh.Gbridgeh_Recr
42062>>>>>
42062>>>>>                             Move 1 to Gbridgeh.Gbridgeh_Flag
42063>>>>>                             Saverecord Gbridgeh //feedback ¤£â¨à© «¦¬ gbridgeh
42064>>>>>
42064>>>>>                             //06.â¢®¦ª á¨¨¦¬  sosososososo
42064>>>>>                             //send check_arthro_for_ypol ( æ«  £§¦¨å ¤ ¢¢á¥   ©¦« £å !)
42064>>>>>
42064>>>>>                             Clear Gbridgeh
42065>>>>>                             Move 0 to Gbridgeh.Gbridgeh_Flag
42066>>>>>                             Find Gt Gbridgeh by Index.3 //gbrigdeh_flag+extinv_recr
42067>>>>>>
42067>>>>>                       Loop //«â¢¦ª ©á¨à©ª gbridgeh   batch ¤£â¨à©
42068>>>>>>
42068>>>>>                       Procedure_Return
42069>>>>>                 End   //«â¢¦ª  batch ¤£â¨à©ª «ª ¢
42069>>>>>>
42069>>>>>
42069>>>>>
42069>>>>>                 Else;                 Begin //¨®ã  online ¤£â¨à©ª «ª ¢
42070>>>>>                       Clear Gbridgeh
42071>>>>>                       Move lsGbridgeh_Recr to Gbridgeh.Gbridgeh_Recr
42072>>>>>                       Find Eq Gbridgeh by Index.2 //gbrigdeh_recr
42073>>>>>>
42073>>>>>
42073>>>>>                       If (Found=0);                       Begin
42075>>>>>                             Send Operation_Not_Allowed 6024 //â¤ ¨â¡ «¦ gbridgeh
42076>>>>>                       End
42076>>>>>>
42076>>>>>
42076>>>>>                       Move (private.Transaction_Create_Garticl_from_Gbridgeh(Self,;                                                                              Gbridgeh.Year_Recr,;                                                                              Gbridgeh.Garticl_Recr,;                                                                              Gbridgeh.Gtypkin_Recr,;                                                                              Gbridgeh.Garticl_Hmnia,;                                                                              Gbridgeh.Garticl_No,;                                                                              Gbridgeh.Garticl_Aitiol,;                                                                              Gbridgeh.Garticl_C_Code2,;                                                                              Gbridgeh.Garticl_Rate0,;                                                                              Gbridgeh.Garticl_Rate00,;                                                                              Gbridgeh.Garticl_Rater);                            ) to Gbridgeh.Garticl_Recr
42077>>>>>
42077>>>>>                       Send private.Transaction_Scan_Gbridged Gbridgeh.Gbridgeh_Recr
42078>>>>>
42078>>>>>                       Move 1 to Gbridgeh.Gbridgeh_Flag
42079>>>>>                       Saverecord Gbridgeh //feedback ¤£â¨à© «¦¬ gbridgeh
42080>>>>>                 End   //«â¢¦ª online ¤£â¨à©ª «ª ¢
42080>>>>>>
42080>>>>>       End_Procedure //private.transaction_update_gl_from_gbridge
42081>>>>>       //****************************************************************************
42081>>>>>       //*                            G B R I D G E               *
42081>>>>>       //****************************************************************************
42081>>>>>
42081>>>>>
42081>>>>>
42081>>>>>       //****************************************************************************
42081>>>>>       //*                                GBRIDGEH            *
42081>>>>>       //****************************************************************************
42081>>>>>       //private
42081>>>>>       //10:¨¦¬«å¤  ¨­ãª á¨¨¦¬
42081>>>>>       //transaction enabled !
42081>>>>>       Procedure private.Transaction_Delete_Garticl_From_Gbridgeh
42083>>>>>                 Integer  liCalling_dd liCalling_dd_Current_Recnum
42084>>>>>                 Integer  liGarticl_dd
42084>>>>>                 String   lsGarticl_Recr
42084>>>>>
42084>>>>>                 //4 flags §¦¬ §¨¤á  £ ¦¨å©£« «¦ ¡¢æ¤ ddo
42084>>>>>                 Integer liFlag02 liFlag03 liFlag04 liFlag05
42084>>>>>
42084>>>>>                 //4 flags §¦¬  áà §¦ «¦ gtypkin
42084>>>>>                 Integer liGFlag02 liGFlag03 liGFlag04 liGFlag05
42084>>>>>
42084>>>>>                 //ç¨© ¡¢¦ç¤«¦ª ddo
42084>>>>>                 //Get piCalling_dd to liCalling_dd
42084>>>>>
42084>>>>>                 //â¢®¦ª ¡¢¦ç¤«¦ª ddo (á¤ 0, ¡á¤«¤)
42084>>>>>                 //If (liCalling_dd = 0) Send Operation_Not_Allowed 4001 //"dâ¤ £ ¡á¢© ¡¤åª!"
42084>>>>>
42084>>>>>                 //ç¨© current_record ¡¢¦ç¤«¦ª ddo
42084>>>>>                 //Get Current_Record of liCalling_dd to liCalling_dd_Current_Recnum
42084>>>>>
42084>>>>>                 //â¢®¦ª current_record (á¤ 0, ¡á¤«¤)
42084>>>>>                 //prosoxi sto delete !!!*** (¡  æ£àª, æ¢àª §¨ â¨àª, â®à current record!)
42084>>>>>                 //If (liCalling_dd_Current_Recnum = 0) Send Operation_Not_Allowed 4002 //"«¦ ¡¢æ¤ ddo â¤ â®  current record!"
42084>>>>>
42084>>>>>                 //¤á¤à© recr «¦¬ ¬§æ  ¨­ã á¨¨¦¬
42084>>>>>                 Get psGarticl_Recr to lsGarticl_Recr
42085>>>>>
42085>>>>>                 //unfortunatly, §¨â§  ¤ «¨â¥à!
42085>>>>>
42085>>>>>                 //¤á¤à© 4 flags
42085>>>>>                  Get piFlag02 to liFlag02
42086>>>>>                  Get piFlag03 to liFlag03
42087>>>>>                  Get piFlag04 to liFlag04
42088>>>>>                  Get piFlag05 to liFlag05
42089>>>>>
42089>>>>>
42089>>>>>                 //**************************************************************************
42089>>>>>                 //01.ç¨© object id's «à¤ £§¢¡¦£â¤à¤ ddo's
42089>>>>>                 //**************************************************************************
42089>>>>>                 Move (Garticl_dd(Self))  to liGarticl_dd
42090>>>>>
42090>>>>>                 //**************************************************************************
42090>>>>>                 //02.rebuild constraints, ¢æà «à¤ ¡¢á©à¤
42090>>>>>                 //**************************************************************************
42090>>>>>                 Set piMode of liGarticl_dd to 0 //¤£â¨à© ¢ §æ b+c+v+wmove
42091>>>>>                 Send Private.Rebuild_All_Constraints
42092>>>>>
42092>>>>>                 //**************************************************************************
42092>>>>>                 //03. ¨­ã garticl
42092>>>>>                 //**************************************************************************
42092>>>>>                 Send Clear to liGarticl_dd
42093>>>>>                 Move lsGarticl_Recr to Garticl.Garticl_Recr
42094>>>>>                 Send Find to liGarticl_dd Eq 2 //garticl_recr
42095>>>>>
42095>>>>>                 If (Found = 0);                 Begin //â¤ ¨â¡ «¦ ¬§æ  ¨­ã garticl
42097>>>>>                       Send Operation_Not_Allowed 10003 //"â¤ ¨â¡ «¦ Garticl!
42098>>>>>                 End
42098>>>>>>
42098>>>>>
42098>>>>>                 //â¢®¦ª «à¤ 4 flags
42098>>>>>                 Get File_Field_Current_Value of liGarticl_dd File_Field Gtypkin.Gtypkin_Flag02 to liGFlag02
42099>>>>>                 Get File_Field_Current_Value of liGarticl_dd File_Field Gtypkin.Gtypkin_Flag03 to liGFlag03
42100>>>>>                 Get File_Field_Current_Value of liGarticl_dd File_Field Gtypkin.Gtypkin_Flag04 to liGFlag04
42101>>>>>                 Get File_Field_Current_Value of liGarticl_dd File_Field Gtypkin.Gtypkin_Flag05 to liGFlag05
42102>>>>>                 If (;                     (liFlag02  <> liGFlag02) or;                     (liFlag03  <> liGFlag03) or;                     (liFlag04  <> liGFlag04) or;                     (liGFlag05 <> 0        )   ;                    );                 Begin
42104>>>>>                       Send Operation_Not_Allowed 10004 //"  ¡ ¤ã© ª â¤ å¤  ¦£¦ åª.¨¡¢é  ¦¨é©« « flags 2,3,4,5
42105>>>>>                 End
42105>>>>>>
42105>>>>>
42105>>>>>                 //cascade delete garticl
42105>>>>>                      Send Request_Delete to liGarticl_dd //â¤ ®¨ á¦¤«  validations & error trapping
42106>>>>>                                                          //å¦«  å£  £â© © transaction !
42106>>>>>       End_Procedure //private.transaction_delete_garticl_from_gbridgeh
42107>>>>>       //****************************************************************************
42107>>>>>       //*                               GBRIDGEH            *
42107>>>>>       //****************************************************************************
42107>>>>>
42107>>>>>
42107>>>>>
42107>>>>>
42107>>>>>
42107>>>>>
42107>>>>>
42107>>>>>
42107>>>>>
42107>>>>>       //****************************************************************************
42107>>>>>       //* 7 :        R E - U P D A T E     .  .                              *
42107>>>>>       //****************************************************************************
42107>>>>>       Procedure private.Zero_Gmhnes
42109>>>>>                 Integer liStop
42110>>>>>
42110>>>>>                 LOCK
42111>>>>>>
42111>>>>>
42111>>>>>                 Clear Gmhnes
42112>>>>>                 Move  SyscurGL.Company_Code to Gmhnes.Company_Code
42113>>>>>                 Move  SyscurGL.Branch_Code  to Gmhnes.Branch_Code
42114>>>>>                 Move  SyscurGL.Year_Year    to Gmhnes.Year_Year
42115>>>>>                 Find Gt Gmhnes by Index.1 //index.1:gmhnes:company_code+branch_code+year_year+
42116>>>>>>
42116>>>>>                                           //               gplan_code+gmhnes_yyyy+gmhnes_period
42116>>>>>                 While (;                        (Found=1) and;                        (SyscurGL.Company_Code= Gmhnes.Company_Code) and;                        (SyscurGL.Branch_Code = Gmhnes.Branch_Code ) and;                        (SyscurGL.Year_Year   = Gmhnes.Year_Year   );                       )
42120>>>>>                        Get Cancel_Check to liStop
42121>>>>>                        If (liStop <> 0) Begin
42123>>>>>                                          UNLOCK
42124>>>>>>
42124>>>>>                                          Procedure_Return
42125>>>>>                                         End
42125>>>>>>
42125>>>>>
42125>>>>>                        Send Update_Status ("¤.©¦ç :"+;                                            (String((Trim(Gmhnes.Gplan_Code)))) +" "+;                                            (String(Gmhnes.Gmhnes_YYYY  )) +" "+;                                            (String(Gmhnes.Gmhnes_Period)) +" "+;                                            (String(Gmhnes.Recnum));                                           )
42126>>>>>                        //Add 1 to Year.Year_NumGmhnes //§¢ã¦ª gmhnes «ª ®¨ã©ª
42126>>>>>                        //Saverecord Year
42126>>>>>
42126>>>>>                        Move 0 to Gmhnes.Gmhnes_Sx2
42127>>>>>                        Move 0 to Gmhnes.Gmhnes_Sp2
42128>>>>>                        Move 0 to Gmhnes.Gmhnes_Sx0
42129>>>>>                        Move 0 to Gmhnes.Gmhnes_Sp0
42130>>>>>                        Move 0 to Gmhnes.Gmhnes_Sx00
42131>>>>>                        Move 0 to Gmhnes.Gmhnes_Sp00
42132>>>>>                        Move 0 to Gmhnes.Gmhnes_SxR
42133>>>>>                        Move 0 to Gmhnes.Gmhnes_SpR
42134>>>>>                        Move 0 to Gmhnes.Gmhnes_Sx1
42135>>>>>                        Move 0 to Gmhnes.Gmhnes_Sp1
42136>>>>>                        Move 0 to Gmhnes.Gmhnes_GhmNoRec
42137>>>>>                        Saverecord Gmhnes
42138>>>>>
42138>>>>>                        Find Gt Gmhnes by Index.1 //index.1:gmhnes:company_code+branch_code+year_year+
42139>>>>>>
42139>>>>>                                                  //               gplan_code+gmhnes_yyyy+gmhnes_period
42139>>>>>                 Loop //while ghmhnes
42140>>>>>>
42140>>>>>                 UNLOCK
42141>>>>>>
42141>>>>>       End_Procedure //private.zero_gmhnes
42142>>>>>
42142>>>>>
42142>>>>>       Procedure private.Zero_Ghmnies
42144>>>>>                 Integer liStop
42145>>>>>
42145>>>>>                 LOCK
42146>>>>>>
42146>>>>>
42146>>>>>                 Clear Ghmnies
42147>>>>>                 Move  SyscurGL.Company_Code to Ghmnies.Company_Code
42148>>>>>                 Move  SyscurGL.Branch_Code  to Ghmnies.Branch_Code
42149>>>>>                 Move  SyscurGL.Year_Year    to Ghmnies.Year_Year
42150>>>>>                 Find Gt Ghmnies by Index.1 //index.1:Ghmnies:company_code+branch_code+year_year+
42151>>>>>>
42151>>>>>                                            //                gplan_code+gmhnes_yyyy+gmhnes_period
42151>>>>>                 While (;                        (Found=1) and;                        (SyscurGL.Company_Code= Ghmnies.Company_Code) and;                        (SyscurGL.Branch_Code = Ghmnies.Branch_Code ) and;                        (SyscurGL.Year_Year   = Ghmnies.Year_Year   );                       )
42155>>>>>                        Get Cancel_Check to liStop
42156>>>>>                        If (liStop <> 0) Begin
42158>>>>>                                          UNLOCK
42159>>>>>>
42159>>>>>                                          Procedure_Return
42160>>>>>                                         End
42160>>>>>>
42160>>>>>
42160>>>>>                        Send Update_Status ("¨.©¦ç :"+;                                            (String((Trim(Ghmnies.Gplan_Code)))) +" "+;                                            (String(Ghmnies.Gmhnes_YYYY  )) +" "+;                                            (String(Ghmnies.Gmhnes_Period)) +" "+;                                            (String(Ghmnies.Ghmnies_Hmnia));                                           )
42161>>>>>                        //Add 1 to Year.Year_NumGhmnies //§¢ã¦ª ghmnies «ª ®¨ã©ª
42161>>>>>                        //Saverecord Year
42161>>>>>
42161>>>>>                        Move 0 to Ghmnies.Ghmnies_Sx2
42162>>>>>                        Move 0 to Ghmnies.Ghmnies_Sp2
42163>>>>>                        Move 0 to Ghmnies.Ghmnies_Sx0
42164>>>>>                        Move 0 to Ghmnies.Ghmnies_Sp0
42165>>>>>                        Move 0 to Ghmnies.Ghmnies_Sx00
42166>>>>>                        Move 0 to Ghmnies.Ghmnies_Sp00
42167>>>>>                        Move 0 to Ghmnies.Ghmnies_SxR
42168>>>>>                        Move 0 to Ghmnies.Ghmnies_SpR
42169>>>>>                        Move 0 to Ghmnies.Ghmnies_Sx1
42170>>>>>                        Move 0 to Ghmnies.Ghmnies_Sp1
42171>>>>>                        Move 0 to Ghmnies.Ghmnies_GmNoRec
42172>>>>>                        Saverecord Ghmnies
42173>>>>>
42173>>>>>                        Find Gt Ghmnies by Index.1 //index.1:gmhnies:company_code+branch_code+year_year+
42174>>>>>>
42174>>>>>                                                  //                 gplan_code+gmhnes_yyyy+gmhnes_period
42174>>>>>                 Loop //while ghmnies
42175>>>>>>
42175>>>>>                 UNLOCK
42176>>>>>>
42176>>>>>       End_Procedure //private.zero_ghmnies
42177>>>>>
42177>>>>>
42177>>>>>       Procedure private.Zero_Gplan
42179>>>>>                 Integer liStop
42180>>>>>
42180>>>>>                 LOCK
42181>>>>>>
42181>>>>>
42181>>>>>                 Clear Gplan
42182>>>>>                 Move SyscurGL.Company_Code to Gplan.Company_Code
42183>>>>>                 Move SyscurGL.Branch_Code  to Gplan.Branch_Code
42184>>>>>                 Move SyscurGL.Year_Year    to Gplan.Year_Year
42185>>>>>                 Find Gt Gplan by Index.1 //index.1:gplan:company_code+branch_code+year_year+gplan_code
42186>>>>>>
42186>>>>>                 While (;                        (Found=1) and;                        (SyscurGL.Company_Code= Gplan.Company_Code) and;                        (SyscurGL.Branch_Code = Gplan.Branch_Code ) and;                        (SyscurGL.Year_Year   = Gplan.Year_Year   );                       )
42190>>>>>                        Get Cancel_Check to liStop
42191>>>>>                        If (liStop <> 0) Begin
42193>>>>>                                          UNLOCK
42194>>>>>>
42194>>>>>                                          Procedure_Return
42195>>>>>                                         End
42195>>>>>>
42195>>>>>
42195>>>>>                        Send Update_Status ("¦/¡æ ®â ¦:"+;                                            (String((Trim(Gplan.Gplan_Code))   )) +" "+;                                            (String(Gplan.Recnum));                                           )
42196>>>>>
42196>>>>>                        Add 1 to Year.Year_NumGplan //§¢ã¦ª ¢¦¨ ©£é¤ «ª ®¨ã©ª
42197>>>>>                        Saverecord Year
42198>>>>>
42198>>>>>                        //Move 0 to Gplan.Gplan_Sx2 ?
42198>>>>>                        //Move 0 to Gplan.Gplan_Sp2 ?
42198>>>>>                        //Move 0 to Gplan.Gplan_Sx1 ?
42198>>>>>                        //Move 0 to Gplan.Gplan_Sp1 ?
42198>>>>>                        Move 0 to Gplan.Gplan_Sx0
42199>>>>>                        Move 0 to Gplan.Gplan_Sp0
42200>>>>>                        Move 0 to Gplan.Gplan_Sx00
42201>>>>>                        Move 0 to Gplan.Gplan_Sp00
42202>>>>>                        Move 0 to Gplan.Gplan_SxR
42203>>>>>                        Move 0 to Gplan.Gplan_SpR
42204>>>>>                        Move 0 to Gplan.Gplan_GmhnNoRec
42205>>>>>                        Saverecord Gplan
42206>>>>>
42206>>>>>                        Find Gt Gplan by Index.1 //index.1:gplan:company_code+branch_code+year_year+gplan_code
42207>>>>>>
42207>>>>>                 Loop //while gplan
42208>>>>>>
42208>>>>>                 UNLOCK
42209>>>>>>
42209>>>>>       End_Procedure //private.zero_gplan
42210>>>>>
42210>>>>>
42210>>>>>       Procedure private.Zero_Garticl
42212>>>>>
42212>>>>>
42212>>>>>//sososososososososososososososososososososososososososososososososososososososososososososo
42212>>>>>PROCEDURE_RETURN
42213>>>>>//sososososososososososososososososososososososososososososososososososososososososososososo
42213>>>>>
42213>>>>>
42213>>>>>                 Integer liStop
42214>>>>>
42214>>>>>                 Clear Garticl
42215>>>>>                 Move  SyscurGL.Company_Code to Garticl.Company_Code
42216>>>>>                 Move  SyscurGL.Branch_Code  to Garticl.Branch_Code
42217>>>>>                 Move  SyscurGL.Year_Year    to Garticl.Year_Year
42218>>>>>                 Find Gt Garticl by Index.1 //index.1:garticl:company_code+branch_code+year_year+
42219>>>>>>
42219>>>>>                                            //                gtypkin_code+garticl_hmnia+garticl_no+garticl_recr
42219>>>>>                 While (;                        (Found=1) and;                        (SyscurGL.Company_Code = Garticl.Company_Code) and;                        (SyscurGL.Branch_Code  = Garticl.Branch_Code ) and;                        (SyscurGL.Year_Year    = Garticl.Year_Year   );                       )
42223>>>>>                        Get Cancel_Check to liStop
42224>>>>>                        If (liStop <> 0) Begin
42226>>>>>                                          UNLOCK
42227>>>>>>
42227>>>>>                                          Procedure_Return
42228>>>>>                                         End
42228>>>>>>
42228>>>>>
42228>>>>>                        Send Update_Status ("¨¨:"+;                                            (String(Garticl.Gtypkin_Code)) +" "+;                                            (String(Garticl.Garticl_Hmnia))+" "+;                                            (String(Garticl.Garticl_No   ))+" "+ ;                                            (String(Garticl.Recnum));                                           )
42229>>>>>
42229>>>>>                        Add 1 to Year.Year_NumGarticl //§¢ã¦ª á¨¨à¤ «ª ®¨ã©ª
42230>>>>>
42230>>>>>                        //garticl.garticl_statuse
42230>>>>>                        //garticl.garticl_statusa
42230>>>>>                        //garticl.garticl_inc
42230>>>>>                        //garticl.garticl_exp
42230>>>>>                        //garticl.garticl_cash
42230>>>>>                        //garticl.garticl_myfnump
42230>>>>>                        //garticl.garticl_myfnuma
42230>>>>>
42230>>>>>                        Move 0 to Garticl.Garticl_XreLine
42231>>>>>                        Move 0 to Garticl.Garticl_PisLine
42232>>>>>
42232>>>>>                        Move 0 to Garticl.Garticl_Omada
42233>>>>>                        Move 0 to Garticl.Garticl_Other
42234>>>>>                        Move 0 to Garticl.Garticl_Mlines //¬«æ ¨¦å  ©«¦ year_numgtypkin
42235>>>>>
42235>>>>>                        //¤æ£ ©£ ¨­ãª
42235>>>>>                        Move 0 to Garticl.Garticl_Sx2
42236>>>>>                        Move 0 to Garticl.Garticl_Sp2
42237>>>>>                        Move 0 to Garticl.Garticl_Syp2
42238>>>>>
42238>>>>>                        //¡ç¨ ¦ ¤æ£ ©£ ®¨ã©ª
42238>>>>>                        Move 0 to Garticl.Garticl_Sx0
42239>>>>>                        Move 0 to Garticl.Garticl_Sp0
42240>>>>>                        Move 0 to Garticl.Garticl_Syp0
42241>>>>>                        Move 0 to Garticl.Garticl_Syp0k
42242>>>>>
42242>>>>>                        //¬«¨ç¦¤ ¤æ£ ©£ ®¨ã©ª
42242>>>>>                        Move 0 to Garticl.Garticl_Sx00
42243>>>>>                        Move 0 to Garticl.Garticl_Sp00
42244>>>>>                        Move 0 to Garticl.Garticl_Syp00
42245>>>>>                        Move 0 to Garticl.Garticl_Syp00k
42246>>>>>
42246>>>>>                        //¤æ£ ©£ reporting
42246>>>>>                        Move 0 to Garticl.Garticl_SxR
42247>>>>>                        Move 0 to Garticl.Garticl_SpR
42248>>>>>                        Move 0 to Garticl.Garticl_SypR
42249>>>>>                        Move 0 to Garticl.Garticl_SypRk
42250>>>>>
42250>>>>>                        //¦¨ ©« ¡¦§¦ £â¤¦ ¡ç¨ ¦ ¤æ£ ©£ ®¨ã©ª
42250>>>>>                        Move 0 to Garticl.Garticl_Sx1
42251>>>>>                        Move 0 to Garticl.Garticl_Sp1
42252>>>>>
42252>>>>>                        //flags 7 9 11 13 :¬¥á¤ /£ é¤   §à¢ã©à¤/¦¨é¤ (¥å/§¢ã¦ª)
42252>>>>>                        Move 0  to Garticl.Garticl_MyfValp
42253>>>>>                        Move 0  to Garticl.Garticl_MyfChkp
42254>>>>>                        Move "" to Garticl.Garticl_MyfCodp
42255>>>>>
42255>>>>>                        Move 0  to Garticl.Garticl_MyfVala
42256>>>>>                        Move 0  to Garticl.Garticl_MyfChka
42257>>>>>                        Move "" to Garticl.Garticl_MyfCoda
42258>>>>>
42258>>>>>                        Saverecord Garticl
42259>>>>>
42259>>>>>                        Find Gt Garticl by Index.1 //index.1:garticl:company_code+branch_code+year_year+
42260>>>>>>
42260>>>>>                                                   //                gtypkin_code+garticl_hmnia+garticl_no+garticl_recr
42260>>>>>                 Loop //while garticl
42261>>>>>>
42261>>>>>       End_Procedure //private.zero_garticl
42262>>>>>
42262>>>>>
42262>>>>>
42262>>>>>       Procedure private.ReUpdate_Isozygia_GL String lsYear_Recr
42264>>>>>                 Integer liStop
42265>>>>>                 Integer liGarticl_dd liGmove_dd
42265>>>>>                 Integer liErr
42265>>>>>
42265>>>>>
42265>>>>>                 //file_mode gtypkin read_only
42265>>>>>
42265>>>>>
42265>>>>>
42265>>>>>
42265>>>>>
42265>>>>>                 //*******
42265>>>>>                 LOCK
42266>>>>>>
42266>>>>>                 //*******
42266>>>>>
42266>>>>>
42266>>>>>                 //02.©á¨à© & £¤ ©£æª ¨¦ ©«é¤ gmhnes
42266>>>>>                 Send private.Zero_Gmhnes
42267>>>>>
42267>>>>>                 //03.©á¨à© & £¤ ©£æª ¨¦ ©«é¤ ghmnies
42267>>>>>                 Send private.Zero_Ghmnies
42268>>>>>
42268>>>>>                 //04.©á¨à© & £¤ ©£æª ¨¦ ©«é¤ gplan
42268>>>>>                 Send private.Zero_Gplan
42269>>>>>
42269>>>>>                 //05.©á¨à© & £¤ ©£æª ¨¦ ©«é¤ garticl
42269>>>>>
42269>>>>>
42269>>>>>                 Move (Gmove_dd (Self))  to liGmove_dd
42270>>>>>                 //06.©á¨à© gmove & ¤£â¨à© ghmnies+gmhnes+gplan
42270>>>>>                 Clear Gmove
42271>>>>>                 Move SyscurGL.Company_Code to Gmove.Company_Code
42272>>>>>                 Move SyscurGL.Branch_Code  to Gmove.Branch_Code
42273>>>>>                 Move SyscurGL.Year_Year    to Gmove.Year_Year
42274>>>>>                 Find Gt Gmove by Index.1 //index.1:gmove:company_code+branch_code+year_year+
42275>>>>>>
42275>>>>>                                          //              gtypkin_code+garticl_hmnia+garticl_no+garticl_recr+
42275>>>>>                                          //              gplan_recr+gmove_recr
42275>>>>>                 While (;                        (Found=1) and;                        (SyscurGL.Company_Code = Gmove.Company_Code) and;                        (SyscurGL.Branch_Code  = Gmove.Branch_Code ) and;                        (SyscurGL.Year_Year    = Gmove.Year_Year   );                       )
42279>>>>>                        Get Cancel_Check to liStop
42280>>>>>                        If (liStop <> 0) Begin
42282>>>>>                                          UNLOCK
42283>>>>>>
42283>>>>>                                          Procedure_Return
42284>>>>>                                         End
42284>>>>>>
42284>>>>>
42284>>>>>                        Send Update_Status (" ¤ã© ª:"+;                                            (String(Gmove.Gtypkin_Code)) +" "+;                                            (String(Gmove.Garticl_Hmnia))+" "+;                                            (String(Gmove.Recnum));                                           )
42285>>>>>
42285>>>>>                        Add 1 to Year.Year_NumGmove //§¢ã¦ª á¨¨à¤ «ª ®¨ã©ª
42286>>>>>                        Saverecord Year
42287>>>>>
42287>>>>>                        //§¨æ©© ¤âà¤ « £é¤
42287>>>>>                        Send private.Update_Isozygia to liGmove_dd Gmove.Gthhmgio_Period;                                                                   Gmove.Garticl_Hmnia;                                                                   Gmove.Gplan_Recr;                                                                   Gmove.Gmove_X2;                                                                   Gmove.Gmove_P2;                                                                   Gmove.Gmove_X0;                                                                   Gmove.Gmove_P0;                                                                   Gmove.Gmove_X00;                                                                   Gmove.Gmove_P00;                                                                   Gmove.Gmove_XR;                                                                   Gmove.Gmove_PR;                                                                   Gmove.Gmove_X1;                                                                   Gmove.Gmove_P1;                                                                   1;                                                                   FALSE
42288>>>>>
42288>>>>>                        Find Gt Gmove by Index.1 //index.1:gmove:company_code+branch_code+year_year+
42289>>>>>>
42289>>>>>                                                 //              gtypkin_code+garticl_hmnia+garticl_no+garticl_recr+
42289>>>>>                                                 //              gplan_recr+gmove_recr
42289>>>>>                 Loop //while gmove
42290>>>>>>
42290>>>>>
42290>>>>>                 //*******
42290>>>>>                 UNLOCK
42291>>>>>>
42291>>>>>                 //*******
42291>>>>>
42291>>>>>       End_Procedure //private.reupdate_isozygia_gl
42292>>>>>       //****************************************************************************
42292>>>>>       //* 7 :         R E - U P D A T E     .  .                            *
42292>>>>>       //****************************************************************************
42292>>>>>
42292>>>>>
42292>>>>>
42292>>>>>
42292>>>>>
42292>>>>>
42292>>>>>
42292>>>>>
42292>>>>>
42292>>>>>       Procedure OnProcess
42294>>>>>                 Integer liWhat_to_Do
42295>>>>>                 Integer liGthhmgio_Code
42295>>>>>                 Date    ldEos_Hmnia
42295>>>>>
42295>>>>>                 //7:reupdate gl
42295>>>>>                 String lsYear_Recr
42295>>>>>
42295>>>>>                 Get piWhat_to_Do to liWhat_to_Do
42296>>>>>
42296>>>>>                 Case Begin
42296>>>>>                       Case (liWhat_to_Do = 1) //®¦¨ã© /
42298>>>>>                            Get piGthhmgio_Code to liGthhmgio_Code
42299>>>>>                            Get pdEos_Hmnia     to ldEos_Hmnia
42300>>>>>                            Send private.Xorigise_Aa liGthhmgio_Code ldEos_Hmnia
42301>>>>>                       Case Break
42302>>>>>
42302>>>>>                       Case (liWhat_to_Do = 2) //£¤ ©£æª /
42305>>>>>                            Get piGthhmgio_Code to liGthhmgio_Code
42306>>>>>                            Send private.Zero_Aa liGthhmgio_Code
42307>>>>>                       Case Break
42308>>>>>
42308>>>>>                       Case (liWhat_to_Do = 3) //¤£â¨à© gmove §æ bmove
42311>>>>>                            Set Display_Error_State to True
42312>>>>>                            Send private.Transaction_BCVWmove_Update_GL
42313>>>>>                       Case Break
42314>>>>>
42314>>>>>                       Case (liWhat_to_Do = 4) //cascade delete «¦¬ garticl
42317>>>>>                            Set Display_Error_State to True
42318>>>>>                            Send private.Transaction_Delete_Garticl
42319>>>>>                       Case Break
42320>>>>>
42320>>>>>                       Case (liWhat_to_Do = 5) //update garticl
42323>>>>>                            Set Display_Error_State to True
42324>>>>>                            Send private.Transaction_Update_Garticl
42325>>>>>                       Case Break
42326>>>>>
42326>>>>>                       Case (liWhat_to_Do = 6) //update from gbridge
42329>>>>>                            Set Display_Error_State to True
42330>>>>>                            Send private.Transaction_Update_GL_From_Gbridge (psGbridgeh_Recr(Self))
42331>>>>>                       Case Break
42332>>>>>
42332>>>>>                       Case (liWhat_to_Do = 7) //re-update  ©¦ç 
42335>>>>>                            Get psYear_Recr to lsYear_Recr
42336>>>>>                            Send private.ReUpdate_Isozygia_GL lsYear_Recr
42337>>>>>                       Case Break
42338>>>>>
42338>>>>>                       Case (liWhat_to_Do =10) //delete garticl from gbridgeh
42341>>>>>                            Set Display_Error_State to True
42342>>>>>                            Send private.Transaction_Delete_Garticl_From_Gbridgeh
42343>>>>>                       Case Break
42344>>>>>                 Case End
42344>>>>>
42344>>>>>       End_Procedure //onprocess
42345>>>>>
42345>>>>>
42345>>>>>
42345>>>>>
42345>>>>>
42345>>>>>
42345>>>>>
42345>>>>>       //****************************************************************************
42345>>>>>       //*                     P U B L I C    I N T E R F A C E                     *
42345>>>>>       //****************************************************************************
42345>>>>>
42345>>>>>       //1:
42345>>>>>       Function   Xorigise_Aa Integer liGthhmgio_Code;                              Date    ldEos_Hmnia;                              Integer liButton_id;                              Returns Integer
42347>>>>>
42347>>>>>                  Integer liError
42348>>>>>                  String  lsButton_Label
42348>>>>>
42348>>>>>                  Send private.Initialize_properties
42349>>>>>
42349>>>>>                  Set piWhat_to_Do                          to 1
42350>>>>>                  Set piGthhmgio_Code                       to liGthhmgio_Code
42351>>>>>                  Set pdEos_Hmnia                           to ldEos_Hmnia
42352>>>>>                  Set piButton_Id     of (Garticl_dd(Self)) to liButton_id
42353>>>>>                  Get Label           of liButton_id        to lsButton_Label
42354>>>>>
42354>>>>>                  Clear Gthhmgio
42355>>>>>                  Move liGthhmgio_Code to Gthhmgio.Gthhmgio_Code
42356>>>>>                  Find Eq Gthhmgio by Index.1 //index.1:gthhmgio:gthhmgio_code
42357>>>>>>
42357>>>>>                  If (Found=0);                  Begin
42359>>>>>                       Error 9999 "¤ç§¨¡«¦ £¨¦¢æ ¦!"
42360>>>>>>
42360>>>>>                       Function_Return 9999
42361>>>>>                  End
42361>>>>>>
42361>>>>>
42361>>>>>                  If (ldEos_Hmnia <=0);                  Begin
42363>>>>>                       Error 9999 "¡«á¢¢¢ £¨¦£¤å!"
42364>>>>>>
42364>>>>>                       Function_Return 9999
42365>>>>>                  End
42365>>>>>>
42365>>>>>
42365>>>>>                  //©«á¨ ©£ «à¤ user interface properties «¦¬ bpo
42365>>>>>                  //1. status panel related properties
42365>>>>>                  Set Status_Panel_State   to TRUE                                //default= TRUE
42366>>>>>                  Set Allow_Cancel_State   to FALSE                               //default= FALSE
42367>>>>>                  Set Process_Caption      to "Utilities ¤ ¡ãª ¦ ©« ¡ãª"            //default= "Running Process"
42368>>>>>                  Set Process_Title        to "¦¨ã© /"                      //default= ""
42369>>>>>                  Set Process_Message      to Gthhmgio.Gthhmgio_Descr             //default= ""
42370>>>>>                  //t Status_Panel_Id      to ""                                  //default= (Status_Panel(Current_Object))
42370>>>>>                  //t Status_Params        to ""                                  //default= ''
42370>>>>>                  //Set Button_Text of (Status_Panel(Self))   to "¡ç¨à©"
42370>>>>>
42370>>>>>                  //Set Sentinel_Name of (Status_Panel(Self)) to "Sentinel"
42370>>>>>                  Set Sentinel_Name of (Status_Panel(Self)) to "prgssent"
42371>>>>>
42371>>>>>                  //2. error related properties
42371>>>>>                  //   if set true, errors will be forwarded to the normal
42371>>>>>                  //   VDF error handler causing an error message to popup.
42371>>>>>                  //   Normally you would not want this during a batch process.
42371>>>>>                  Set Display_Error_State  to TRUE //`                     //default= False
42372>>>>>                  Set Error_Count          to 0                             //default= 0      // number of errors
42373>>>>>                  Set Old_Error_Object_ID  to 0                             //default= 0
42374>>>>>
42374>>>>>                  //3. Logging
42374>>>>>                  // If you are going to log information you must create a
42374>>>>>                  // status log object and set this property to its ID. See
42374>>>>>                  // Statlog.pkg for more information.
42374>>>>>//                  Set Status_Log_State     to FALSE                          //default= False
42374>>>>>//                  Set Status_Log_Id        to 0
42374>>>>>//                  Set Status_Log_State     to FALSE
42374>>>>>
42374>>>>>                  Send DoProcess
42375>>>>>
42375>>>>>                  Set Label       of liButton_id        to lsButton_Label
42376>>>>>                  Set piButton_Id of (Garticl_dd(Self)) to 0
42377>>>>>                  Get piError                           to liError
42378>>>>>                  Send private.Initialize_properties //£¤ ©£æª properties   §æ£¤ ®¨ã©
42379>>>>>                  Function_Return liError
42380>>>>>       End_Function  //xorigise_aa
42381>>>>>
42381>>>>>
42381>>>>>       //2:
42381>>>>>       Function   Zero_Aa Integer liGthhmgio_Code;                          Integer liButton_Id;                          Returns Integer
42383>>>>>
42383>>>>>                  Integer liError
42384>>>>>                  String  lsButton_Label
42384>>>>>
42384>>>>>                  Send private.Initialize_properties
42385>>>>>
42385>>>>>                  Set piWhat_to_Do                          to 2
42386>>>>>                  Set piGthhmgio_Code                       to liGthhmgio_Code
42387>>>>>                  Set piButton_Id     of (Garticl_dd(Self)) to liButton_id
42388>>>>>                  Get Label           of liButton_id        to lsButton_Label
42389>>>>>
42389>>>>>                  Clear Gthhmgio
42390>>>>>                  Move liGthhmgio_Code to Gthhmgio.Gthhmgio_Code
42391>>>>>                  Find Eq Gthhmgio by Index.1 //index.1:gthhmgio:gthhmgio_code
42392>>>>>>
42392>>>>>                  If (Found=0);                  Begin
42394>>>>>                       Error 9999 "¤ç§¨¡«¦ £¨¦¢æ ¦!"
42395>>>>>>
42395>>>>>                       Function_Return 9999
42396>>>>>                  End
42396>>>>>>
42396>>>>>
42396>>>>>                  //©«á¨ ©£ «à¤ user interface properties «¦¬ bpo
42396>>>>>                  //1. status panel related properties
42396>>>>>                  Set Status_Panel_State   to TRUE                                //default= TRUE
42397>>>>>                  Set Allow_Cancel_State   to FALSE                               //default= FALSE
42398>>>>>                  Set Process_Caption      to "Utilities ¤ ¡ãª ¦ ©« ¡ãª"      //default= "Running Process"
42399>>>>>                  Set Process_Title        to "¤ ©£æª /"                    //default= ""
42400>>>>>                  Set Process_Message      to Gthhmgio.Gthhmgio_Descr             //default= ""
42401>>>>>                  //t Status_Panel_Id      to ""                                  //default= (Status_Panel(Current_Object))
42401>>>>>                  //t Status_Params        to ""                                  //default= ''
42401>>>>>                  //Set Button_Text of (Status_Panel(Self))   to "¡ç¨à©"
42401>>>>>
42401>>>>>                  //Set Sentinel_Name of (Status_Panel(Self)) to "Sentinel"
42401>>>>>                  Set Sentinel_Name of (Status_Panel(Self)) to "prgssent"
42402>>>>>
42402>>>>>                  //2. error related properties
42402>>>>>                  //   if set true, errors will be forwarded to the normal
42402>>>>>                  //   VDF error handler causing an error message to popup.
42402>>>>>                  //   Normally you would not want this during a batch process.
42402>>>>>                  Set Display_Error_State  to TRUE //`                     //default= False
42403>>>>>                  Set Error_Count          to 0                             //default= 0      // number of errors
42404>>>>>                  Set Old_Error_Object_ID  to 0                             //default= 0
42405>>>>>
42405>>>>>                  //3. Logging
42405>>>>>                  // If you are going to log information you must create a
42405>>>>>                  // status log object and set this property to its ID. See
42405>>>>>                  // Statlog.pkg for more information.
42405>>>>>//                  Set Status_Log_State     to FALSE                          //default= False
42405>>>>>//                  Set Status_Log_Id        to 0
42405>>>>>//                  Set Status_Log_State     to FALSE
42405>>>>>
42405>>>>>                  Send DoProcess
42406>>>>>
42406>>>>>                  Set Label       of liButton_id        to lsButton_Label
42407>>>>>                  Set piButton_Id of (Garticl_dd(Self)) to 0
42408>>>>>                  Get piError                           to liError
42409>>>>>                  Send private.Initialize_properties //£¤ ©£æª properties   §æ£¤ ®¨ã©
42410>>>>>                  Function_Return liError
42411>>>>>       End_Function  //zero_aa
42412>>>>>
42412>>>>>
42412>>>>>       //transaction enabled
42412>>>>>       //¡¢å«  §æ:) bmove.dd (request save & delete)
42412>>>>>       Procedure  Transaction_BCVWmove_Update_GL Integer liCalling_dd;                                                 Integer liFlag02;                                                 Integer liFlag03;                                                 Integer liFlag04;                                                 Integer liFlag05
42414>>>>>
42414>>>>>                  Send private.Initialize_properties
42415>>>>>
42415>>>>>                  Set piWhat_to_Do to 3
42416>>>>>                  Set piCalling_Dd to liCalling_dd
42417>>>>>                  Set piFlag02     to liFlag02
42418>>>>>                  Set piFlag03     to liFlag03
42419>>>>>                  Set piFlag04     to liFlag04
42420>>>>>                  Set piFlag05     to liFlag05
42421>>>>>
42421>>>>>                  Send DoProcess
42422>>>>>
42422>>>>>                  Send private.Initialize_properties //£¤ ©£æª properties   §æ£¤ ®¨ã©
42423>>>>>       End_Procedure //transaction_BCVWmove_update_gl
42424>>>>>
42424>>>>>
42424>>>>>       //transaction enabled
42424>>>>>       //¡¢å«  §æ:) barticl_dd (request delete)
42424>>>>>       Procedure  Transaction_Delete_Garticl Integer liCalling_dd;                                             String  lsGarticl_Recr;                                             Integer liFlag02;                                             Integer liFlag03;                                             Integer liFlag04;                                             Integer liFlag05
42426>>>>>
42426>>>>>                  Send private.Initialize_properties
42427>>>>>
42427>>>>>                  Set piWhat_to_Do   to 4
42428>>>>>                  Set piCalling_Dd   to liCalling_dd
42429>>>>>                  Set psGarticl_Recr to lsGarticl_Recr
42430>>>>>                  Set piFlag02       to liFlag02
42431>>>>>                  Set piFlag03       to liFlag03
42432>>>>>                  Set piFlag04       to liFlag04
42433>>>>>                  Set piFlag05       to liFlag05
42434>>>>>
42434>>>>>                  Send DoProcess
42435>>>>>
42435>>>>>                  Send private.Initialize_properties //£¤ ©£æª properties   §æ£¤ ®¨ã©
42436>>>>>       End_Procedure //transaction_delete_garticl
42437>>>>>
42437>>>>>
42437>>>>>       //transaction enabled
42437>>>>>       //¡¢å«  §æ:) barticl_dd (request save)
42437>>>>>       Procedure  Transaction_Update_Garticl Integer liCalling_dd;                                             String  lsGarticl_Recr;                                             Integer liFlag02;                                             Integer liFlag03;                                             Integer liFlag04;                                             Integer liFlag05
42439>>>>>
42439>>>>>                  Send private.Initialize_properties
42440>>>>>
42440>>>>>                  Set piWhat_to_Do   to 5
42441>>>>>                  Set piCalling_Dd   to liCalling_dd
42442>>>>>                  Set psGarticl_Recr to lsGarticl_Recr
42443>>>>>                  Set piFlag02       to liFlag02
42444>>>>>                  Set piFlag03       to liFlag03
42445>>>>>                  Set piFlag04       to liFlag04
42446>>>>>                  Set piFlag05       to liFlag05
42447>>>>>
42447>>>>>                  Send DoProcess
42448>>>>>
42448>>>>>                  Send private.Initialize_properties //£¤ ©£æª properties   §æ£¤ ®¨ã©
42449>>>>>       End_Procedure //transaction_update_garticl
42450>>>>>
42450>>>>>
42450>>>>>       //transaction enabled
42450>>>>>       //¡¢å«  §æ:) enhmgl.cls «¦¬ ad
42450>>>>>       Procedure  Transaction_Update_GL_From_Gbridge Integer liCalling_dd;                                                     String  lsGbridgeh_Recr;                                                     Integer liFlag02;                                                     Integer liFlag03;                                                     Integer liFlag04;                                                     Integer liFlag05
42452>>>>>
42452>>>>>                  Send private.Initialize_properties
42453>>>>>
42453>>>>>                  Set piWhat_to_Do    to 6
42454>>>>>                  Set piCalling_Dd    to liCalling_dd
42455>>>>>
42455>>>>>                  Set psGbridgeh_Recr to lsGbridgeh_Recr
42456>>>>>                  Set piFlag02        to liFlag02
42457>>>>>                  Set piFlag03        to liFlag03
42458>>>>>                  Set piFlag04        to liFlag04
42459>>>>>                  Set piFlag05        to liFlag05
42460>>>>>
42460>>>>>                  Send DoProcess
42461>>>>>
42461>>>>>                  Send private.Initialize_properties //£¤ ©£æª properties   §æ£¤ ®¨ã©
42462>>>>>       End_Procedure //transaction_update_gl_from_gbridge
42463>>>>>
42463>>>>>
42463>>>>>       //7:
42463>>>>>       //transaction enabled
42463>>>>>       //¡¢å«  §æ:) «¦ 1¦ tab «ª GLUTIL
42463>>>>>       Function  Do_ReUpdate_Isozygia_GL String lsYear_Recr Returns Integer
42465>>>>>
42465>>>>>                 Integer liStop
42466>>>>>
42466>>>>>                 Send private.Initialize_properties
42467>>>>>
42467>>>>>                 //©«á¨ ©£ «à¤ properties «¦¬ bpo
42467>>>>>                 Set piWhat_to_Do to 7
42468>>>>>                 Set psYear_Recr  to lsYear_Recr
42469>>>>>
42469>>>>>                 //©«á¨ ©£ «à¤ user interface properties «¦¬ bpo
42469>>>>>                 //1. status panel related properties
42469>>>>>                 Set Status_Panel_State   to TRUE                                //default= TRUE
42470>>>>>                 Set Allow_Cancel_State   to TRUE                                //default= FALSE
42471>>>>>                 Set Process_Caption      to "Utilities ¤ ¡ãª ¦ ©« ¡ãª"      //default= "Running Process"
42472>>>>>                 Set Process_Title        to "Reupdate ©¦ç "                 //default= ""
42473>>>>>                 Set Process_Message      to "¨¡¢é ¨ £â¤«..."            //default= ""
42474>>>>>                 //t Status_Panel_Id      to ""                                  //default= (Status_Panel(Current_Object))
42474>>>>>                 //t Status_Params        to ""                                  //default= ''
42474>>>>>                 Set Button_Text of (Status_Panel(Self))   to "¡ç¨à©"
42475>>>>>
42475>>>>>                 Set Sentinel_Name of (Status_Panel(Self)) to "Sentinel"
42476>>>>>                 //Set Sentinel_Name of (Status_Panel(Self)) to "prgssent"
42476>>>>>
42476>>>>>                 //2. error related properties
42476>>>>>                 //   if set true, errors will be forwarded to the normal
42476>>>>>                 //   VDF error handler causing an error message to popup.
42476>>>>>                 //   Normally you would not want this during a batch process.
42476>>>>>                 Set Display_Error_State  to TRUE //`                     //default= False
42477>>>>>                 Set Error_Count          to 0                             //default= 0      // number of errors
42478>>>>>                 Set Old_Error_Object_ID  to 0                             //default= 0
42479>>>>>
42479>>>>>                 //3. Logging
42479>>>>>                 // If you are going to log information you must create a
42479>>>>>                 // status log object and set this property to its ID. See
42479>>>>>                 // Statlog.pkg for more information.
42479>>>>>//                 Set Status_Log_State     to FALSE                        //default= False
42479>>>>>//                 Set Status_Log_Id        to 0                            //(Status_Log(Self))
42479>>>>>//                 Set Status_Log_State     to FALSE
42479>>>>>
42479>>>>>                 Send DoProcess
42480>>>>>
42480>>>>>//                 Set Status_Log_State     to FALSE                         //default= False
42480>>>>>//                 Set Status_Log_Id        to 0
42480>>>>>//                 Set Status_Log_State     to FALSE
42480>>>>>
42480>>>>>                 Get piStop to liStop
42481>>>>>
42481>>>>>                 Send private.Initialize_properties //£¤ ©£æª properties   §æ£¤ ®¨ã©
42482>>>>>
42482>>>>>                 Function_Return liStop
42483>>>>>
42483>>>>>       End_Function  //do_reupdate_isozygia_gl
42484>>>>>
42484>>>>>
42484>>>>>
42484>>>>>
42484>>>>>
42484>>>>>
42484>>>>>
42484>>>>>//=====================================================================
42484>>>>>       //transaction enabled
42484>>>>>       //¡¢å«  §æ:) enhmgl.cls «¦¬ ad
42484>>>>>       Procedure  Transaction_Create_Akkyrotiko_Arthro
42486>>>>>                                                     Integer liCalling_dd
42487>>>>>                                                     String  lsGbridgeh_Recr
42487>>>>>                                                     Integer liFlag02
42487>>>>>                                                     Integer liFlag03
42487>>>>>                                                     Integer liFlag04
42487>>>>>                                                     Integer liFlag05
42487>>>>>
42487>>>>>                  Send private.Initialize_properties
42488>>>>>
42488>>>>>                  Set piWhat_to_Do    to 8
42489>>>>>                  Set piCalling_Dd    to liCalling_dd
42490>>>>>
42490>>>>>                  Set psGbridgeh_Recr to lsGbridgeh_Recr
42491>>>>>                  Set piFlag02        to liFlag02
42492>>>>>                  Set piFlag03        to liFlag03
42493>>>>>                  Set piFlag04        to liFlag04
42494>>>>>                  Set piFlag05        to liFlag05
42495>>>>>
42495>>>>>                  //Send DoProcess
42495>>>>>
42495>>>>>                  Send private.Initialize_properties //£¤ ©£æª properties   §æ£¤ ®¨ã©
42496>>>>>       End_Procedure //transaction_create_akkyrotiko_arthro
42497>>>>>
42497>>>>>
42497>>>>>
42497>>>>>       //transaction enabled
42497>>>>>       //¡¢å«  §æ:) enhmgl.cls «¦¬ ad
42497>>>>>       Procedure  Transaction_Copy_Gplan
42499>>>>>                                                     Integer liCalling_dd
42500>>>>>                                                     String  lsGbridgeh_Recr
42500>>>>>                                                     Integer liFlag02
42500>>>>>                                                     Integer liFlag03
42500>>>>>                                                     Integer liFlag04
42500>>>>>                                                     Integer liFlag05
42500>>>>>
42500>>>>>                  Send private.Initialize_properties
42501>>>>>
42501>>>>>                  Set piWhat_to_Do    to 9
42502>>>>>                  Set piCalling_Dd    to liCalling_dd
42503>>>>>
42503>>>>>                  Set psGbridgeh_Recr to lsGbridgeh_Recr
42504>>>>>                  Set piFlag02        to liFlag02
42505>>>>>                  Set piFlag03        to liFlag03
42506>>>>>                  Set piFlag04        to liFlag04
42507>>>>>                  Set piFlag05        to liFlag05
42508>>>>>
42508>>>>>                  //Send DoProcess
42508>>>>>
42508>>>>>                  Send private.Initialize_properties //£¤ ©£æª properties   §æ£¤ ®¨ã©
42509>>>>>       End_Procedure //transaction_copy_gplan
42510>>>>>
42510>>>>>
42510>>>>>       //transaction enabled
42510>>>>>       //¡¢å«  §æ:) barticl_dd (request delete)
42510>>>>>       Procedure  Transaction_Delete_Garticl_From_Gbridgeh Integer liCalling_dd;                                                           String  lsGarticl_Recr;                                                           Integer liFlag02;                                                           Integer liFlag03;                                                           Integer liFlag04;                                                           Integer liFlag05
42512>>>>>
42512>>>>>                  Send private.Initialize_properties
42513>>>>>
42513>>>>>                  Set piWhat_to_Do   to 10
42514>>>>>                  Set piCalling_Dd   to liCalling_dd
42515>>>>>                  Set psGarticl_Recr to lsGarticl_Recr
42516>>>>>                  Set piFlag02       to liFlag02
42517>>>>>                  Set piFlag03       to liFlag03
42518>>>>>                  Set piFlag04       to liFlag04
42519>>>>>                  Set piFlag05       to liFlag05
42520>>>>>
42520>>>>>                  Send DoProcess
42521>>>>>
42521>>>>>                  Send private.Initialize_properties //£¤ ©£æª properties   §æ£¤ ®¨ã©
42522>>>>>       End_Procedure //transaction_delete_garticl_from_gbridgeh
42523>>>>>
42523>>>>>
42523>>>>>End_Object //odo_gl_maintainance
42524>>>>>
42524>>>>>//                       Get Cancel_Check to liStop
42524>>>>>//                       If (liStop <> 0) Procedure_Return
42524>>>>>//
42524>>>>>//
42524>>>>>//                       Add 1 to liCounterOfRecords
42524>>>>>//                       Move (((Number(liCounterOfRecords))/liNumberOfRecords)*100) to lnPercent
42524>>>>>//                       Send Update_Status (" á©«¡¤: "+;
42524>>>>>//                                           (String(Meg.Recnum))+;
42524>>>>>//                                           "              ç¤¦¢¦ ¨­é¤: "+;
42524>>>>>//                                           (String(liNumberOfRecords))+;
42524>>>>>//                                           "                       ")
42524>>>>>//                       Send Update_Status ("__PROGRESS__" + String(Integer(lnPercent)))
42524>>>>>
42524>>>>>
42524>>>>>
42524>>>>>
42524>>>>>
42524>>>>>
/I071_FPA_HEADER
Image 2, I071_FPA_HEADER
 _____________________________ _______________________________  ________________                                                                  __/__/____  __:__
                _____________________________________________ ___________ ã¤ª __      «¦ª ___.                                                              ___.
===================================================================================================================================================================
à.   : ¨ ¨­ã                              : %¬¤«.:          å¤© ã¤: §¦­¦¨¦¢¦£â¤ ¥å:____________________:______________________________________
===================================================================================================================================================================
/i071_FPA_BODY
Image 3, I071_FPA_BODY
__________:________________________________________:____.__:__,___,___,___,___.__:__,___,___,___,___.__:____________________:______________________________________
/i071_FPA_SUBTOTAL
Image 4, I071_FPA_SUBTOTAL
__________:________________________________________:____.__:__,___,___,___,___.__:__,___,___,___,___.__:____________________:______________________________________
----------:----------------------------------------:-------:---------------------:---------------------:--------------------:--------------------------------------
/*
42524>>>>>
42524>>>>>Open Gvath
INCLUDING FILE: GVATH.FD
42526>>>>>Open Gvatd
42528>>>>>Open Gplan
42530>>>>>
42530>>>>>
42530>>>>>
42530>>>>>        Procedure private.DoCompute_Fpa Global String  asYear_Recr;                                               Integer aiYYYY;                                               Integer aiPeriod;                                               Integer aiMode;                                               Integer aiCurrency;                                               Integer aiFlag;                                               Integer aiChannel;                                               String  asArxeio
42531>>>>>
42531>>>>>                  //aiMode  ;    1=©¬¡¤«¨à« ¡æ  2=¤¢¬« ¡æ
42531>>>>>                  //aiCurrency   1=0              2=00          3=r
42531>>>>>                  //aiFlag   ;   1=ola  2=oristika
42531>>>>>
42531>>>>>                  //01.â¢®¦  ¦¨ ©£á«à¤
42531>>>>>                  Clear Year
42532>>>>>                  Move asYear_Recr to Year.Year_Recr
42533>>>>>                  Find Eq Year by Index.2 //index.2:year:year_recr
42534>>>>>>
42534>>>>>                  If (Found=0);                  Begin
42536>>>>>                       Error 9999 "¤ç§¨¡« ¨ã© !"
42537>>>>>>
42537>>>>>                       Procedure_Return
42538>>>>>                  End
42538>>>>>>
42538>>>>>                  Relate Year //ç¨© company+branch   «¦ header
42539>>>>>
42539>>>>>                  If ((aiMode <> 1 ) and (aiMode <> 2));                  Begin
42541>>>>>                       Error 9999 "¡«á¢¢¢¦ aiMode !"
42542>>>>>>
42542>>>>>                       Procedure_Return
42543>>>>>                  End
42543>>>>>>
42543>>>>>
42543>>>>>                  If ((aiCurrency <> 1 ) and (aiCurrency <> 2) and (aiCurrency <> 3));                  Begin
42545>>>>>                       Error 9999 "¡«á¢¢¢¦ aiCurrency !"
42546>>>>>>
42546>>>>>                       Procedure_Return
42547>>>>>                  End
42547>>>>>>
42547>>>>>
42547>>>>>                  If ((aiFlag <> 1 ) and (aiFlag <> 2));                  Begin
42549>>>>>                       Error 9999 "¡«á¢¢¢¦ aiFlag !"
42550>>>>>>
42550>>>>>                       Procedure_Return
42551>>>>>                  End
42551>>>>>>
42551>>>>>
42551>>>>>                  If ((aiChannel < 1 ) or (aiChannel > 9));                  Begin
42553>>>>>                       Error 9999 "¡«á¢¢¢¦ aiChannel !"
42554>>>>>>
42554>>>>>                       Procedure_Return
42555>>>>>                  End
42555>>>>>>
42555>>>>>
42555>>>>>                  If (asArxeio = "");                  Begin
42557>>>>>                       Error 9999 "¡«á¢¢¢¦ asArxeio !"
42558>>>>>>
42558>>>>>                       Procedure_Return
42559>>>>>                  End
42559>>>>>>
42559>>>>>
42559>>>>>//sosososososo
42559>>>>>///////////////// Move 1                                        to aiChannel
42559>>>>>///////////////// Move "i:\homewin.dev\easyware.vis\gl\fpa.txt" to asArxeio
42559>>>>>//////////////////Move 1                                        to aiMode
42559>>>>>
42559>>>>>                  //02:á¤¦ £ temp file
42559>>>>>                  Direct_Output Channel aiChannel asArxeio
42561>>>>>
42561>>>>>                  //03:§¨¦«¦ £©å & ¡«ç§à© header
42561>>>>>                  Blankform i071_FPA_HEADER
42562>>>>>>
42562>>>>>                  Print Company.Company_Name                          to i071_FPA_HEADER.1
42563>>>>>                  Print Branch.Branch_Name                            to i071_FPA_HEADER.2
42564>>>>>                  Print Year.Year_Descr                               to i071_FPA_HEADER.3
42565>>>>>                  Sysdate4                                               i071_FPA_HEADER.4 i071_FPA_HEADER.5 i071_FPA_HEADER.6
42568>>>>>                  Print "                       "   to i071_FPA_HEADER.7
42569>>>>>                  Print ""                                            to i071_FPA_HEADER.8   // PERIOD
42570>>>>>                  Print aiPeriod                                      to i071_FPA_HEADER.9   // MHNA
42571>>>>>                  Print aiYYYY                                        to i071_FPA_HEADER.10  // ETOS
42572>>>>>                  Blankform                                              i071_FPA_HEADER.11
42573>>>>>>
42573>>>>>
42573>>>>>                  If (aiMode=2);                  Begin
42575>>>>>                       Print "à.¦/£¦ç"       to i071_FPA_HEADER.12
42576>>>>>                       Print "¨ ¨­ã ¦/£¦ç" to i071_FPA_HEADER.13
42577>>>>>                  End
42577>>>>>>
42577>>>>>                  Else;                  Begin
42578>>>>>                       Blankform                    i071_FPA_HEADER.12
42579>>>>>>
42579>>>>>                       Blankform                    i071_FPA_HEADER.13
42580>>>>>>
42580>>>>>                  End
42580>>>>>>
42580>>>>>                  Output Channel aiChannel   i071_FPA_HEADER
42582>>>>>
42582>>>>>                  //04:©á¨à© gvath
42582>>>>>                  Clear Gvath
42583>>>>>                  Find Gt Gvath by Index.1 //index.1:vath:vath_code
42584>>>>>>
42584>>>>>                  While (Found=1)
42588>>>>>
42588>>>>>                        Blankform i071_FPA_BODY
42589>>>>>>
42589>>>>>                        Blankform i071_FPA_SUBTOTAL
42590>>>>>>
42590>>>>>
42590>>>>>                        Print Gvath.Gvath_Code  to i071_FPA_SUBTOTAL.1
42591>>>>>                        Print Gvath.Gvath_Descr to i071_FPA_SUBTOTAL.2
42592>>>>>                        Print Gvath.Gvath_Pct   to i071_FPA_SUBTOTAL.3
42593>>>>>                        If (i071_FPA_SUBTOTAL.3=0) Blankform i071_FPA_SUBTOTAL.3
42596>>>>>
42596>>>>>                        //04.1:©á¨à© gvatd
42596>>>>>                        Clear Gvatd
42597>>>>>                        Move Gvath.Gvath_Code to Gvatd.Gvath_Code
42598>>>>>                        Move asYear_Recr      to Gvatd.Year_Recr
42599>>>>>                        Find Gt Gvatd by Index.3 //index.3:vatd:vath_code+year_recr+gplan_code+recnum
42600>>>>>>
42600>>>>>                        While (;                               (Found=1) and;                               (Gvath.Gvath_Code = Gvatd.Gvath_Code) and;                               (asYear_Recr      = Gvatd.Year_Recr );                              )
42604>>>>>
42604>>>>>                              //04.2:ç¨© gmhnes
42604>>>>>                              Clear Gmhnes
42605>>>>>                              Move Gvatd.Gplan_Recr to Gmhnes.Gplan_Recr
42606>>>>>                              Move aiYYYY           to Gmhnes.Gmhnes_YYYY
42607>>>>>                              Move aiPeriod         to Gmhnes.Gmhnes_Period
42608>>>>>                              Find Eq Gmhnes by Index.3 //index.3:gmhnes:gplan_recr+gmhnes_yyyy+gmhnes_period
42609>>>>>>
42609>>>>>                              If (Found=1);                              Begin
42611>>>>>                                   Clear Gplan
42612>>>>>                                   Move Gvatd.Gplan_Recr to Gplan.Gplan_Recr
42613>>>>>                                   Find Eq Gplan By Index.2 //index.2:gplan:gplan_recr
42614>>>>>>
42614>>>>>                                   If (Found=1);                                   Begin
42616>>>>>                                        Print Gplan.Gplan_Code      to i071_FPA_BODY.6
42617>>>>>                                        Print Gplan.Gplan_Descr1    to i071_FPA_BODY.7
42618>>>>>                                   End
42618>>>>>>
42618>>>>>                                   Else;                                   Begin
42619>>>>>                                        Print "*******************" to i071_FPA_BODY.6
42620>>>>>                                        Print "*******************" to i071_FPA_BODY.7
42621>>>>>                                   End
42621>>>>>>
42621>>>>>
42621>>>>>                                   If (Gvatd.Gvatd_XP = "1");                                   Begin //®¨é© ª
42623>>>>>                                       If (aiFlag=1);                                       Begin //æ¢
42625>>>>>                                                  If (aiCurrency=1) Print Gmhnes.Gmhnes_Sx0  to i071_FPA_BODY.4 {Points=2}
42628>>>>>                                             Else If (aiCurrency=2) Print Gmhnes.Gmhnes_Sx00 to i071_FPA_BODY.4 {Points=2}
42632>>>>>                                             Else If (aiCurrency=3) Print Gmhnes.Gmhnes_Sxr  to i071_FPA_BODY.4 {Points=2}
42636>>>>>                                       End
42636>>>>>>
42636>>>>>                                       If (aiFlag=2);                                       Begin //¦¨ ©« ¡á
42638>>>>>                                                                    Print Gmhnes.Gmhnes_Sx1  to i071_FPA_BODY.4 {Points=2}
42639>>>>>                                       End
42639>>>>>>
42639>>>>>
42639>>>>>                                       If (aiMode=2) Output Channel aiChannel i071_Fpa_BODY
42643>>>>>
42643>>>>>                                       Print (i071_FPA_BODY.4+i071_FPA_SUBTOTAL.4) to i071_FPA_SUBTOTAL.4 {Points=2}
42644>>>>>                                   End   //«â¢¦ª ®¨é©à¤
42644>>>>>>
42644>>>>>
42644>>>>>                                   If (Gvatd.Gvatd_XP = "2");                                   Begin //§ ©«é© ª
42646>>>>>                                       If (aiFlag=1);                                       Begin //æ¢
42648>>>>>                                                  If (aiCurrency=1) Print Gmhnes.Gmhnes_Sp0  to i071_FPA_BODY.4 {Points=2}
42651>>>>>                                             Else If (aiCurrency=2) Print Gmhnes.Gmhnes_Sp00 to i071_FPA_BODY.4 {Points=2}
42655>>>>>                                             Else If (aiCurrency=3) Print Gmhnes.Gmhnes_Spr  to i071_FPA_BODY.4 {Points=2}
42659>>>>>                                       End
42659>>>>>>
42659>>>>>                                       If (aiFlag=2);                                       Begin //¦¨ ©« ¡á
42661>>>>>                                                                    Print Gmhnes.Gmhnes_Sp1  to i071_FPA_BODY.4 {Points=2}
42662>>>>>                                       End
42662>>>>>>
42662>>>>>
42662>>>>>                                       If (aiMode=2) Output Channel aiChannel i071_Fpa_BODY
42666>>>>>
42666>>>>>                                       Print (i071_FPA_BODY.4+i071_FPA_SUBTOTAL.4) to i071_FPA_SUBTOTAL.4 {Points=2}
42667>>>>>                                   End   //«â¢¦ª § ©«é©à¤
42667>>>>>>
42667>>>>>                              End  //found gmhnes
42667>>>>>>
42667>>>>>
42667>>>>>                              Find Gt Gvatd by Index.3 //index.3:vatd:vath_code+year_recr+gplan_code+recnum
42668>>>>>>
42668>>>>>                        Loop //while vatd
42669>>>>>>
42669>>>>>
42669>>>>>                        Print (Round_number((i071_FPA_SUBTOTAL.4/(i071_FPA_SUBTOTAL.3/100)),2)) to i071_FPA_SUBTOTAL.5 {Points=2}
42670>>>>>                        If (i071_FPA_SUBTOTAL.5=0) Blankform i071_FPA_SUBTOTAL.5
42673>>>>>                        Output Channel aiChannel i071_Fpa_SUBTOTAL
42675>>>>>
42675>>>>>                        Find Gt Gvath by Index.1 //index.1:vath:vath_code
42676>>>>>>
42676>>>>>                  Loop //while vath
42677>>>>>>
42677>>>>>
42677>>>>>                  //05:¡¢å© £¦ temp file
42677>>>>>                  Close_Output Channel aiChannel
42679>>>>>        End_Procedure //private.docompute_fpa
42680>>>//AB-StoreTopEnd
42680>>>
42680>>>//AB-IgnoreStart
42680>>>
42680>>>Use dbView.Sub
42680>>>Use DFAllEnt.pkg
42680>>>Use dbGroup.Sub
42680>>>Use dbForm.Sub
42680>>>Use Txtbox.Sub
42680>>>Use dbTabdlg.Sub
42680>>>Use Button.Sub
42680>>>
42680>>>Use COMPANY.DD
42680>>>Use BRANCH.DD
42680>>>Use YEAR.DD
42680>>>Use GTHHMGIO.DD
42680>>>Use GTYPKIN.DD
42680>>>Use GPLAN.DD
42680>>>Use GARTICL.DD
42680>>>
42680>>>//AB-IgnoreEnd
42680>>>
42680>>>DEFERRED_VIEW Activate_GLUTIL FOR ;;Object GLUTIL is a dbViewSub
42699>>>
42699>>>    //AB-StoreTopStart
42699>>>    //AB-StoreTopEnd
42699>>>
42699>>>    Set Label to "Utilities ¤ ¡ãª ¦ ©« ¡ãª"
42700>>>    Set Size to 311 530
42701>>>    Set Location to 0 0
42702>>>
42702>>>    //AB-DDOStart
42702>>>
42702>>>    Object Company_DD is a Company_DataDictionary
42704>>>
42704>>>        //AB-StoreStart
42704>>>        Set Read_Only_State to TRUE
42705>>>        //AB-StoreEnd
42705>>>
42705>>>    End_Object    // Company_DD
42706>>>
42706>>>    Object Branch_DD is a Branch_DataDictionary
42708>>>        Set DDO_Server to (Company_DD(self))
42709>>>
42709>>>        //AB-StoreStart
42709>>>        Set Read_Only_State to TRUE
42710>>>        //AB-StoreEnd
42710>>>
42710>>>    End_Object    // Branch_DD
42711>>>
42711>>>    Object Year_DD is a Year_DataDictionary
42713>>>        Set DDO_Server to (Branch_DD(self))
42714>>>
42714>>>        //AB-StoreStart
42714>>>        Set Read_Only_State to TRUE
42715>>>        Set Field_Options Field Year.Year_Year to DD_DISPLAYONLY
42716>>>
42716>>>        //AB-StoreEnd
42716>>>
42716>>>    End_Object    // Year_DD
42717>>>
42717>>>    Object Gthhmgio_DD is a Gthhmgio_DataDictionary
42719>>>
42719>>>        //AB-StoreStart
42719>>>        Set Read_Only_State to TRUE
42720>>>        //AB-StoreEnd
42720>>>
42720>>>    End_Object    // Gthhmgio_DD
42721>>>
42721>>>    Object Gtypkin_DD is a Gtypkin_DataDictionary
42723>>>        Set DDO_Server to (Gthhmgio_DD(self))
42724>>>
42724>>>        //AB-StoreStart
42724>>>        Set Read_Only_State to TRUE
42725>>>
42725>>>        //AB-StoreEnd
42725>>>
42725>>>    End_Object    // Gtypkin_DD
42726>>>
42726>>>    Object Gplan_DD is a Gplan_DataDictionary
42728>>>
42728>>>        //AB-StoreStart
42728>>>        Set Read_Only_State to TRUE
42729>>>
42729>>>        //AB-StoreEnd
42729>>>
42729>>>    End_Object    // Gplan_DD
42730>>>
42730>>>    Object Garticl_DD is a Garticl_DataDictionary
42732>>>        Set DDO_Server to (Gtypkin_DD(self))
42733>>>
42733>>>        //AB-StoreStart
42733>>>        Set Read_Only_State to TRUE
42734>>>        Procedure OnConstrain
42736>>>                  Constrain Garticl Relates to Gtypkin
42737>>>        End_Procedure
42738>>>
42738>>>        //AB-StoreEnd
42738>>>
42738>>>    End_Object    // Garticl_DD
42739>>>
42739>>>    Set Main_DD to (Year_DD(self))
42740>>>    Set Server to (Year_DD(self))
42741>>>
42741>>>    //AB-DDOEnd
42741>>>
42741>>>    Object dbGrpYear is a dbGroupSub
42743>>>        Set Size to 26 502
42744>>>        Set Location to 10 5
42745>>>        Set Auto_Clear_Deo_State to FALSE
42746>>>        Object Company_Company_Name is a dbFormSub
42748>>>            Entry_Item Company.Company_name
42749>>>            Set Size to 13 135
42750>>>            Set Location to 9 49
42751>>>            Set Label_Col_Offset to 2
42752>>>            Set Label_Justification_Mode to jMode_Right
42753>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
42754>>>        End_Object    // Company_Company_Name
42755>>>
42755>>>        Object Branch_Branch_Name is a dbFormSub
42757>>>            Entry_Item Branch.Branch_name
42758>>>            Set Size to 13 110
42759>>>            Set Location to 9 257
42760>>>            Set Label_Col_Offset to 2
42761>>>            Set Label_Justification_Mode to jMode_Right
42762>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
42763>>>        End_Object    // Branch_Branch_Name
42764>>>
42764>>>        Object Year_Year_Year is a dbFormSub
42766>>>            Entry_Item Year.Year_year
42767>>>            Set Size to 13 61
42768>>>            Set Location to 8 436
42769>>>            Set Label_Col_Offset to 2
42770>>>            Set Label_Justification_Mode to jMode_Right
42771>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
42772>>>
42772>>>            //AB-StoreStart
42772>>>
42772>>>
42772>>>            //AB-StoreEnd
42772>>>
42772>>>        End_Object    // Year_Year_Year
42773>>>
42773>>>        Object otxtCompany is a TextBoxSub
42775>>>            Set Label to "« ¨å :"
42776>>>            Set Auto_Size_State to FALSE
42777>>>            Set TextColor to clNavy
42778>>>            Set FontSize to 4 0
42779>>>            Set Location to 10 6
42780>>>            Set Size to 10 32
42781>>>            Set FontWeight to 800
42782>>>            Set Justification_Mode to jMode_Right
42783>>>            Set TypeFace to "MS Sans Serif"
42784>>>            Set Enabled_State to TRUE
42785>>>        End_Object    // otxtCompany
42786>>>
42786>>>        Object otxtBranch is a TextBoxSub
42788>>>            Set Label to "§¦¡/£ :"
42789>>>            Set Auto_Size_State to FALSE
42790>>>            Set TextColor to clNavy
42791>>>            Set FontSize to 4 0
42792>>>            Set Location to 10 212
42793>>>            Set Size to 10 37
42794>>>            Set FontWeight to 800
42795>>>            Set Justification_Mode to jMode_Right
42796>>>            Set TypeFace to "MS Sans Serif"
42797>>>            Set Enabled_State to TRUE
42798>>>        End_Object    // otxtBranch
42799>>>
42799>>>        Object otxtYear is a TextBoxSub
42801>>>            Set Label to "¨ã©:"
42802>>>            Set Auto_Size_State to FALSE
42803>>>            Set TextColor to clNavy
42804>>>            Set FontSize to 4 0
42805>>>            Set Location to 10 403
42806>>>            Set Size to 10 26
42807>>>            Set FontWeight to 800
42808>>>            Set Justification_Mode to jMode_Right
42809>>>            Set TypeFace to "MS Sans Serif"
42810>>>            Set Enabled_State to TRUE
42811>>>        End_Object    // otxtYear
42812>>>
42812>>>    End_Object    // dbGrpYear
42813>>>
42813>>>    Object dbTabDialogSub1 is a dbTabDialogSub
42815>>>        Set Size to 224 507
42816>>>        Set Location to 40 8
42817>>>        Object TP_REUPDATE_dbTabPageSub1 is a dbTabPageSub
42819>>>            Set Label to "REUPDATE_dbTabPageSub1"
42820>>>            Object REUPDATE_ButtonSub is a ButtonSub
42822>>>                Set Label to "Reupdate ©¦ç "
42823>>>                Set Size to 14 75
42824>>>                Set Location to 114 345
42825>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
42826>>>
42826>>>                //AB-StoreStart
42826>>>                Procedure OnClick
42828>>>                    Integer liTemp
42829>>>                    String  lsYear_Recr
42829>>>                    Move SysCurGL.Year_Recr to lsYear_Recr
42830>>>                    Get Do_ReUpdate_Isozygia_Gl of (oDo_GL_Maintainance(Self)) lsYear_Recr to liTemp
42831>>>                End_Procedure // OnClick
42832>>>
42832>>>
42832>>>
42832>>>                //AB-StoreEnd
42832>>>
42832>>>            End_Object    // REUPDATE_ButtonSub
42833>>>
42833>>>
42833>>>            //AB-StoreStart
42833>>>            Set Label to "Re-update ©¦ç "
42834>>>
42834>>>            //AB-StoreEnd
42834>>>
42834>>>        End_Object    // TP_REUPDATE_dbTabPageSub1
42835>>>
42835>>>        Object dbTabPageSub2 is a dbTabPageSub
42837>>>            Set Label to "dbTabPageSub2"
42838>>>
42838>>>            //AB-StoreStart
42838>>>            Set Label to "Re-update "
42839>>>            //AB-StoreEnd
42839>>>
42839>>>        End_Object    // dbTabPageSub2
42840>>>
42840>>>        Object dbTabPageSub3 is a dbTabPageSub
42842>>>            Set Label to "dbTabPageSub3"
42843>>>
42843>>>            //AB-StoreStart
42843>>>            Set Label to ""
42844>>>            //AB-StoreEnd
42844>>>
42844>>>        End_Object    // dbTabPageSub3
42845>>>
42845>>>
42845>>>        //AB-StoreStart
42845>>>        Procedure Request_Clear_All
42847>>>        End_Procedure // Request_Clear_All
42848>>>
42848>>>        //AB-StoreEnd
42848>>>
42848>>>    End_Object    // dbTabDialogSub1
42849>>>
42849>>>
42849>>>    //AB-StoreStart
42849>>>
42849>>>    //AB-StoreEnd
42849>>>
42849>>>CD_End_Object    // GLUTIL
42851>>>>
42851>>>
42851>>>
42851>>>//AB-StoreStart
42851>>>
42851>>>//AB-StoreEnd
42851>>>
42851>>>//AB/ End_Object    // prj
42851>        Use Gmoves.VW                                                                       
INCLUDING FILE: GMOVES.VW
42851>>>//AB/ Project Gmoves (DoUpHm.pkg) v058
42851>>>//AB/     Object prj is a View_Project
42851>>>//AB/         Set ProjectName to "Gmoves (DoUpHm.pkg) v058"
42851>>>//AB/         Set ProjectFileName to "Gmoves.VW"
42851>>>
42851>>>// Project Object Structure
42851>>>//   Gmove_View is a dbViewSub
42851>>>//     Country_DD is a DataDictionary
42851>>>//     Towns_DD is a DataDictionary
42851>>>//     Cities_DD is a DataDictionary
42851>>>//     Areas_DD is a DataDictionary
42851>>>//     Payresp_DD is a DataDictionary
42851>>>//     Clients_DD is a DataDictionary
42851>>>//     Gplan_DD is a DataDictionary
42851>>>//     Gthhmgio_DD is a DataDictionary
42851>>>//     Gtypkin_DD is a DataDictionary
42851>>>//     Syscurgl_DD is a DataDictionary
42851>>>//     Garticl_DD is a DataDictionary
42851>>>//     Gmove_DD is a DataDictionary
42851>>>//     Gmoved_DD is a DataDictionary
42851>>>//     dbgrpArticle is a dbGroupSub
42851>>>//       Gtypkin_Gtypkin_Code is a dbFormSub
42851>>>//       Gtypkin_Gtypkin_Descr is a dbFormSub
42851>>>//       Garticl_Garticl_Hmnia is a dbFormSub
42851>>>//       Garticl_Garticl_No is a dbFormSub
42851>>>//       Garticl_Garticl_Aitiol is a dbFormSub
42851>>>//       Garticl_Garticl_Aa is a dbFormSub
42851>>>//       Garticl_Garticl_C_Code2 is a dbComboFormSub
42851>>>//       Garticl_Garticl_Rate0 is a dbFormSub
42851>>>//       Garticl_Garticl_Rate00 is a dbFormSub
42851>>>//       Garticl_Garticl_Rater is a dbFormSub
42851>>>//       Garticl_Garticl_Recr is a dbFormSub
42851>>>//       btnEisagogh is a ButtonSub
42851>>>//       otxtDate is a TextBoxSub
42851>>>//       otxtGarticlNo is a TextBoxSub
42851>>>//       otxtTypkinCode is a TextBoxSub
42851>>>//       otxtDescr is a TextBoxSub
42851>>>//       otxtGarticlAA is a TextBoxSub
42851>>>//       otxtNomisma is a TextBoxSub
42851>>>//       otxtRate is a TextBoxSub
42851>>>//       otxtProtypoArthro is a TextBoxSub
42851>>>//       frmProtypoArthroDescr is a FormSub
42851>>>//       TextBoxSub1 is a TextBoxSub
42851>>>//       frmProtypoArthro is a FormSub
42851>>>//       txtDisplay is a ButtonSub
42851>>>//     Gplan_ is a dbGridSub
42851>>>//     Gmoved_ is a dbGridSub
42851>>>//     dbgrpFooter is a dbGroupSub
42851>>>//       Myf_Axia_dbForm is a dbFormSub
42851>>>//       Myf_Code_dbForm is a dbFormSub
42851>>>//       Garticl_Garticl_Syp2 is a dbFormSub
42851>>>//       otxtYpol is a TextBoxSub
42851>>>//     oPrint_bn is a ButtonSub
42851>>>//     oGplan_bn is a ButtonSub
42851>>>//     dbGrpYear is a dbGroupSub
42851>>>//       Company_Company_Name is a dbFormSub
42851>>>//       Branch_Branch_Name is a dbFormSub
42851>>>//       Year_Year_Year is a dbFormSub
42851>>>//       otxtCompany is a TextBoxSub
42851>>>//       otxtBranch is a TextBoxSub
42851>>>//       otxtYear is a TextBoxSub
42851>>>
42851>>>// Register all objects
42851>>>Register_Object Areas_DD
42851>>>Register_Object Branch_Branch_Name
42851>>>Register_Object btnEisagogh
42851>>>Register_Object Cities_DD
42851>>>Register_Object Clients_DD
42851>>>Register_Object Company_Company_Name
42851>>>Register_Object Country_DD
42851>>>Register_Object dbGrpYear
42851>>>Register_Object dbgrpArticle
42851>>>Register_Object dbgrpFooter
42851>>>Register_Object frmProtypoArthro
42851>>>Register_Object frmProtypoArthroDescr
42851>>>Register_Object Garticl_DD
42851>>>Register_Object Garticl_Garticl_Aa
42851>>>Register_Object Garticl_Garticl_Aitiol
42851>>>Register_Object Garticl_Garticl_C_Code2
42851>>>Register_Object Garticl_Garticl_Hmnia
42851>>>Register_Object Garticl_Garticl_No
42851>>>Register_Object Garticl_Garticl_Rate0
42851>>>Register_Object Garticl_Garticl_Rate00
42851>>>Register_Object Garticl_Garticl_Rater
42851>>>Register_Object Garticl_Garticl_Recr
42851>>>Register_Object Garticl_Garticl_Syp2
42851>>>Register_Object Gmove_DD
42851>>>Register_Object Gmove_View
42851>>>Register_Object Gmoved_
42851>>>Register_Object Gmoved_DD
42851>>>Register_Object Gplan_
42851>>>Register_Object Gplan_DD
42851>>>Register_Object Gthhmgio_DD
42851>>>Register_Object Gtypkin_DD
42851>>>Register_Object Gtypkin_Gtypkin_Code
42851>>>Register_Object Gtypkin_Gtypkin_Descr
42851>>>Register_Object Myf_Axia_dbForm
42851>>>Register_Object Myf_Code_dbForm
42851>>>Register_Object oGplan_bn
42851>>>Register_Object oPrint_bn
42851>>>Register_Object otxtBranch
42851>>>Register_Object otxtCompany
42851>>>Register_Object otxtDate
42851>>>Register_Object otxtDescr
42851>>>Register_Object otxtGarticlAA
42851>>>Register_Object otxtGarticlNo
42851>>>Register_Object otxtNomisma
42851>>>Register_Object otxtProtypoArthro
42851>>>Register_Object otxtRate
42851>>>Register_Object otxtTypkinCode
42851>>>Register_Object otxtYear
42851>>>Register_Object otxtYpol
42851>>>Register_Object Payresp_DD
42851>>>Register_Object Syscurgl_DD
42851>>>Register_Object TextBoxSub1
42851>>>Register_Object Towns_DD
42851>>>Register_Object txtDisplay
42851>>>Register_Object Year_Year_Year
42851>>>
42851>>>
42851>>>//AB/     AppBuild VIEW
42851>>>
42851>>>
42851>>>    //AB-StoreTopStart
42851>>>            
42851>>>    Use     Sysfile.DD
INCLUDING FILE: SYSFILE.DD
42851>>>>>//DDB-FileStart
42851>>>>>//DDB-HeaderStart
42851>>>>>
42851>>>>>// File Name : SYSFILE.DD
42851>>>>>// Class Name: Sysfile_DataDictionary
42851>>>>>// Revision  : 23
42851>>>>>// Version   : 2
42851>>>>>
42851>>>>>Use  Windows           // Basic Definitions
42851>>>>>Use  DataDict          // DataDictionary Class Definition
42851>>>>>Use  DDvalTbl          // Validation Table Class Definitions
42851>>>>>
42851>>>>>Open Sysfile
42853>>>>>
42853>>>>>//DDB-HeaderEnd
42853>>>>>
42853>>>>>Class Sysfile_DataDictionary  is a DataDictionary_Sec
42854>>>>>
42854>>>>>    // Define_Fields:
42854>>>>>    // This procedure is used to set up all data-dictionary rules.
42854>>>>>
42854>>>>>    Procedure Define_Fields
42855>>>>>        Forward Send Define_Fields
42857>>>>>        //DDB-Generated-Code-Location
42857>>>>>        //DDB-DefineFieldStart
42857>>>>>
42857>>>>>        Set Main_File            To Sysfile.File_Number
42858>>>>>
42858>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
42859>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
42860>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
42861>>>>>
42861>>>>>        // Field-based properties.......................
42861>>>>>
42861>>>>>        // Sysfile.Company_Name
42861>>>>>
42861>>>>>        // Sysfile.Serial_Number
42861>>>>>
42861>>>>>        // Sysfile.Version_Number
42861>>>>>
42861>>>>>        // Sysfile.Can_Force_Open
42861>>>>>
42861>>>>>        // Sysfile.Use_Sql_Reports
42861>>>>>
42861>>>>>        // Sysfile.Client_Digits
42861>>>>>
42861>>>>>        // Sysfile.Use_English
42861>>>>>
42861>>>>>        // Sysfile.Over_Overhead
42861>>>>>
42861>>>>>        // Sysfile.Chk_Apothema
42861>>>>>
42861>>>>>        // Sysfile.Hm_Kleisimatos
42861>>>>>
42861>>>>>        // Sysfile.Check_Article
42861>>>>>
42861>>>>>        // Sysfile.Last_Hmnia_Ekt
42861>>>>>
42861>>>>>        // Sysfile.Enhm_Arxeia
42861>>>>>
42861>>>>>        // Sysfile.Dferr_Path
42861>>>>>
42861>>>>>        //DDB-DefineFieldEnd
42861>>>>>    End_Procedure    // Define_Fields
42862>>>>>
42862>>>>>    // Field_Defaults:
42862>>>>>    // This procedure is used to establish default field values.
42862>>>>>
42862>>>>>    Procedure Field_Defaults
42863>>>>>        Forward Send Field_Defaults
42865>>>>>        //DDB-Generated-Code-Location
42865>>>>>        //DDB-FieldDefaultStart
42865>>>>>        //DDB-FieldDefaultEnd
42865>>>>>    End_Procedure    // Field_Defaults
42866>>>>>
42866>>>>>End_Class    // Sysfile_DataDictionary
42867>>>>>//DDB-FileEnd
42867>>>    Use     Gplan.vw
INCLUDING FILE: GPLAN.VW
42867>>>>>//AB/ Project Gplan
42867>>>>>//AB/ Object prj is a View_Project
42867>>>>>//AB/     Set ProjectName to "Gplan"
42867>>>>>//AB/     Set ProjectFileName to "gplan.vw"
42867>>>>>
42867>>>>>// Project Object Structure
42867>>>>>//   Gplan_View is a dbViewSub
42867>>>>>//     Gplan_DD is a DataDictionary
42867>>>>>//     Syscurgl_DD is a DataDictionary
42867>>>>>//     Gplanmod_DD is a DataDictionary
42867>>>>>//     Gvath_DD is a DataDictionary
42867>>>>>//     Gvatd_DD is a DataDictionary
42867>>>>>//     Gplan_Gplan_Code is a dbFormSub
42867>>>>>//     Gplan_Gplan_Descr1 is a dbFormSub
42867>>>>>//     Gplan_Gplan_Descr2 is a dbFormSub
42867>>>>>//     Gplan_Gplan_Bathmos is a dbFormSub
42867>>>>>//     Gplan_Gplan_Anoep is a dbFormSub
42867>>>>>//     Gplan_Gplan_O_Code is a dbComboFormSub
42867>>>>>//     Gplan_Gplan_C_Code1 is a dbComboFormSub
42867>>>>>//     dbTabDialogSub1 is a dbTabDialogSub
42867>>>>>//       dbTabPage1 is a dbTabPage
42867>>>>>//         dbGroupSub2 is a dbGroupSub
42867>>>>>//           Gplan_Gplan_Yn_Last is a dbComboFormSub
42867>>>>>//           Gplan_Gplan_Yn_Xfer is a dbComboFormSub
42867>>>>>//           Gplan_Gplan_Yn_Kin is a dbComboFormSub
42867>>>>>//           Gplan_Gplan_Yn_Xy is a dbComboFormSub
42867>>>>>//           Gplan_Gplan_Yn_Py is a dbComboFormSub
42867>>>>>//           Gplan_Gplan_Myf_Sum is a dbComboFormSub
42867>>>>>//           Gplan_Gplan_Yn_Myfp is a dbComboFormSub
42867>>>>>//           Gplan_Gplan_Yn_Kk is a dbCheckBoxSub
42867>>>>>//           TextBoxSub12 is a TextBoxSub
42867>>>>>//           TextBoxSub13 is a TextBoxSub
42867>>>>>//           TextBoxSub15 is a TextBoxSub
42867>>>>>//           TextBoxSub16 is a TextBoxSub
42867>>>>>//           TextBoxSub17 is a TextBoxSub
42867>>>>>//           TextBoxSub18 is a TextBoxSub
42867>>>>>//           TextBoxSub46 is a TextBoxSub
42867>>>>>//         dbGroupSub3 is a dbGroupSub
42867>>>>>//           Gplan_Gplan_Xpm is a dbComboFormSub
42867>>>>>//           Gplan_Gplan_Rep_Code is a dbFormSub
42867>>>>>//           Gplan_Gplan_Rep_Pct is a dbFormSub
42867>>>>>//           Gvath_Gvath_Descr is a dbFormSub
42867>>>>>//           Gvath_Gvath_Code is a dbFormSub
42867>>>>>//           Gplan_Gplan_Myf_Suma is a dbComboFormSub
42867>>>>>//           Gplan_Gplan_Yn_Myfa is a dbComboFormSub
42867>>>>>//           TextBoxSub19 is a TextBoxSub
42867>>>>>//           TextBoxSub40 is a TextBoxSub
42867>>>>>//           TextBoxSub41 is a TextBoxSub
42867>>>>>//           txtSymMyfA is a TextBoxSub
42867>>>>>//           txtMyfA is a TextBoxSub
42867>>>>>//           txtFpa1 is a TextBoxSub
42867>>>>>//           txtFpa2 is a TextBoxSub
42867>>>>>//       dbTabPage2 is a dbTabPage
42867>>>>>//         dbGroupSub4 is a dbGroupSub
42867>>>>>//           Gplan_Gplan_Afm is a dbFormSub
42867>>>>>//           Gplan_Gplan_Addr is a dbFormSub
42867>>>>>//           Gplan_Gplan_Doy is a dbComboFormSub
42867>>>>>//           Gplan_Gplan_Poli is a dbFormSub
42867>>>>>//           Gplan_Gplan_Tk_ is a dbFormSub
42867>>>>>//           Gplan_Gplan_Tel is a dbFormSub
42867>>>>>//           Gplan_Gplan_Email is a dbFormSub
42867>>>>>//           Gplan_Gplan_Resp is a dbFormSub
42867>>>>>//           Gplan_Gplan_Bitmap is a dbFormSub
42867>>>>>//           Gplan_Gplan_J_Code is a dbComboFormSub
42867>>>>>//           TextBoxSub23 is a TextBoxSub
42867>>>>>//           TextBoxSub24 is a TextBoxSub
42867>>>>>//           TextBoxSub25 is a TextBoxSub
42867>>>>>//           TextBoxSub26 is a TextBoxSub
42867>>>>>//           TextBoxSub27 is a TextBoxSub
42867>>>>>//           TextBoxSub28 is a TextBoxSub
42867>>>>>//           TextBoxSub29 is a TextBoxSub
42867>>>>>//           TextBoxSub30 is a TextBoxSub
42867>>>>>//           TextBoxSub31 is a TextBoxSub
42867>>>>>//           TextBoxSub39 is a TextBoxSub
42867>>>>>//         dbGroupSub8 is a dbGroupSub
42867>>>>>//           Gplan_Gplan_Myfno1 is a dbFormSub
42867>>>>>//           Gplan_Gplan_Myfaxia1 is a dbFormSub
42867>>>>>//           Gplan_Gplan_Myf2 is a dbFormSub
42867>>>>>//           Gplan_Gplan_Myfaxia2 is a dbFormSub
42867>>>>>//           TextBoxSub35 is a TextBoxSub
42867>>>>>//           TextBoxSub36 is a TextBoxSub
42867>>>>>//           TextBoxSub37 is a TextBoxSub
42867>>>>>//           TextBoxSub38 is a TextBoxSub
42867>>>>>//       dbTabPage3 is a dbTabPage
42867>>>>>//         dbGroupSub5 is a dbGroupSub
42867>>>>>//           Gplan_Gplan_I_Xy_Code is a dbFormSub
42867>>>>>//           Gplan_Gplan_I_Py_Code is a dbFormSub
42867>>>>>//           Gplan_Gplan_I_A_Code is a dbComboForm
42867>>>>>//           Gplan_Gplan_I_Ctypkin is a dbFormSub
42867>>>>>//           TextBoxSub42 is a TextBoxSub
42867>>>>>//           TextBoxSub43 is a TextBoxSub
42867>>>>>//           TextBoxSub44 is a TextBoxSub
42867>>>>>//           TextBoxSub45 is a TextBoxSub
42867>>>>>//       dbTabPage4 is a dbTabPage
42867>>>>>//         Gplanmod_ is a dbGridSub
42867>>>>>//     dbgrpYear is a dbGroupSub
42867>>>>>//       Company_Company_Name is a dbFormSub
42867>>>>>//       Branch_Branch_Name is a dbFormSub
42867>>>>>//       Year_Year_Year is a dbFormSub
42867>>>>>//       otxtCompany is a TextBoxSub
42867>>>>>//       otxtBranch is a TextBoxSub
42867>>>>>//       otxtYear is a TextBoxSub
42867>>>>>//     TextBoxSub4 is a TextBoxSub
42867>>>>>//     TextBoxSub5 is a TextBoxSub
42867>>>>>//     TextBoxSub6 is a TextBoxSub
42867>>>>>//     TextBoxSub7 is a TextBoxSub
42867>>>>>//     TextBoxSub8 is a TextBoxSub
42867>>>>>//     TextBoxSub9 is a TextBoxSub
42867>>>>>//     TextBoxSub10 is a TextBoxSub
42867>>>>>//     btnPartl is a ButtonSub
42867>>>>>
42867>>>>>// Register all objects
42867>>>>>Register_Object Branch_Branch_Name
42867>>>>>Register_Object btnPartl
42867>>>>>Register_Object Company_Company_Name
42867>>>>>Register_Object dbGroupSub2
42867>>>>>Register_Object dbGroupSub3
42867>>>>>Register_Object dbGroupSub4
42867>>>>>Register_Object dbGroupSub5
42867>>>>>Register_Object dbGroupSub8
42867>>>>>Register_Object dbgrpYear
42867>>>>>Register_Object dbTabDialogSub1
42867>>>>>Register_Object dbTabPage1
42867>>>>>Register_Object dbTabPage2
42867>>>>>Register_Object dbTabPage3
42867>>>>>Register_Object dbTabPage4
42867>>>>>Register_Object Gplan_DD
42867>>>>>Register_Object Gplan_Gplan_Addr
42867>>>>>Register_Object Gplan_Gplan_Afm
42867>>>>>Register_Object Gplan_Gplan_Anoep
42867>>>>>Register_Object Gplan_Gplan_Bathmos
42867>>>>>Register_Object Gplan_Gplan_Bitmap
42867>>>>>Register_Object Gplan_Gplan_C_Code1
42867>>>>>Register_Object Gplan_Gplan_Code
42867>>>>>Register_Object Gplan_Gplan_Descr1
42867>>>>>Register_Object Gplan_Gplan_Descr2
42867>>>>>Register_Object Gplan_Gplan_Doy
42867>>>>>Register_Object Gplan_Gplan_Email
42867>>>>>Register_Object Gplan_Gplan_I_A_Code
42867>>>>>Register_Object Gplan_Gplan_I_Ctypkin
42867>>>>>Register_Object Gplan_Gplan_I_Py_Code
42867>>>>>Register_Object Gplan_Gplan_I_Xy_Code
42867>>>>>Register_Object Gplan_Gplan_J_Code
42867>>>>>Register_Object Gplan_Gplan_Myf_Sum
42867>>>>>Register_Object Gplan_Gplan_Myf_Suma
42867>>>>>Register_Object Gplan_Gplan_Myf2
42867>>>>>Register_Object Gplan_Gplan_Myfaxia1
42867>>>>>Register_Object Gplan_Gplan_Myfaxia2
42867>>>>>Register_Object Gplan_Gplan_Myfno1
42867>>>>>Register_Object Gplan_Gplan_O_Code
42867>>>>>Register_Object Gplan_Gplan_Poli
42867>>>>>Register_Object Gplan_Gplan_Rep_Code
42867>>>>>Register_Object Gplan_Gplan_Rep_Pct
42867>>>>>Register_Object Gplan_Gplan_Resp
42867>>>>>Register_Object Gplan_Gplan_Tel
42867>>>>>Register_Object Gplan_Gplan_Tk_
42867>>>>>Register_Object Gplan_Gplan_Xpm
42867>>>>>Register_Object Gplan_Gplan_Yn_Kin
42867>>>>>Register_Object Gplan_Gplan_Yn_Kk
42867>>>>>Register_Object Gplan_Gplan_Yn_Last
42867>>>>>Register_Object Gplan_Gplan_Yn_Myfa
42867>>>>>Register_Object Gplan_Gplan_Yn_Myfp
42867>>>>>Register_Object Gplan_Gplan_Yn_Py
42867>>>>>Register_Object Gplan_Gplan_Yn_Xfer
42867>>>>>Register_Object Gplan_Gplan_Yn_Xy
42867>>>>>Register_Object Gplan_View
42867>>>>>Register_Object Gplanmod_
42867>>>>>Register_Object Gplanmod_DD
42867>>>>>Register_Object Gvatd_DD
42867>>>>>Register_Object Gvath_DD
42867>>>>>Register_Object Gvath_Gvath_Code
42867>>>>>Register_Object Gvath_Gvath_Descr
42867>>>>>Register_Object otxtBranch
42867>>>>>Register_Object otxtCompany
42867>>>>>Register_Object otxtYear
42867>>>>>Register_Object Syscurgl_DD
42867>>>>>Register_Object TextBoxSub10
42867>>>>>Register_Object TextBoxSub12
42867>>>>>Register_Object TextBoxSub13
42867>>>>>Register_Object TextBoxSub15
42867>>>>>Register_Object TextBoxSub16
42867>>>>>Register_Object TextBoxSub17
42867>>>>>Register_Object TextBoxSub18
42867>>>>>Register_Object TextBoxSub19
42867>>>>>Register_Object TextBoxSub23
42867>>>>>Register_Object TextBoxSub24
42867>>>>>Register_Object TextBoxSub25
42867>>>>>Register_Object TextBoxSub26
42867>>>>>Register_Object TextBoxSub27
42867>>>>>Register_Object TextBoxSub28
42867>>>>>Register_Object TextBoxSub29
42867>>>>>Register_Object TextBoxSub30
42867>>>>>Register_Object TextBoxSub31
42867>>>>>Register_Object TextBoxSub35
42867>>>>>Register_Object TextBoxSub36
42867>>>>>Register_Object TextBoxSub37
42867>>>>>Register_Object TextBoxSub38
42867>>>>>Register_Object TextBoxSub39
42867>>>>>Register_Object TextBoxSub4
42867>>>>>Register_Object TextBoxSub40
42867>>>>>Register_Object TextBoxSub41
42867>>>>>Register_Object TextBoxSub42
42867>>>>>Register_Object TextBoxSub43
42867>>>>>Register_Object TextBoxSub44
42867>>>>>Register_Object TextBoxSub45
42867>>>>>Register_Object TextBoxSub46
42867>>>>>Register_Object TextBoxSub5
42867>>>>>Register_Object TextBoxSub6
42867>>>>>Register_Object TextBoxSub7
42867>>>>>Register_Object TextBoxSub8
42867>>>>>Register_Object TextBoxSub9
42867>>>>>Register_Object txtFpa1
42867>>>>>Register_Object txtFpa2
42867>>>>>Register_Object txtMyfA
42867>>>>>Register_Object txtSymMyfA
42867>>>>>Register_Object Year_Year_Year
42867>>>>>
42867>>>>>
42867>>>>>//AB/ AppBuild VIEW
42867>>>>>
42867>>>>>
42867>>>>>//AB-StoreTopStart
42867>>>>>                
42867>>>>>Object oGplan_View_Properties is an Array
42869>>>>>    Property Integer Modal_State False
42871>>>>>    Property Integer Invoking_Object_Id 0
42873>>>>>End_Object
42874>>>>>
42874>>>>>//AB-StoreTopEnd
42874>>>>>
42874>>>>>//AB-IgnoreStart
42874>>>>>
42874>>>>>Use dbView.Sub
42874>>>>>Use DFAllEnt.pkg
42874>>>>>Use dbForm.Sub
42874>>>>>Use dbCmbfrm.Sub
42874>>>>>Use dbTabdlg.Sub
42874>>>>>Use dbGroup.Sub
42874>>>>>Use dbChkbox.Sub
42874>>>>>Use Txtbox.Sub
42874>>>>>Use dbGrid.Sub
42874>>>>>Use Button.Sub
42874>>>>>
42874>>>>>Use GPLAN.DD
42874>>>>>Use SysCurGL.dd
42874>>>>>Use GPLANMOD.DD
INCLUDING FILE: GPLANMOD.DD
42874>>>>>>>//DDB-FileStart
42874>>>>>>>//DDB-HeaderStart
42874>>>>>>>
42874>>>>>>>// File Name : GPLANMOD.DD
42874>>>>>>>// Class Name: Gplanmod_DataDictionary
42874>>>>>>>// Revision  : 7
42874>>>>>>>// Version   : 2
42874>>>>>>>
42874>>>>>>>Use  Windows           // Basic Definitions
42874>>>>>>>Use  DataDict          // DataDictionary Class Definition
42874>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
42874>>>>>>>
42874>>>>>>>Open Gplanmod
42876>>>>>>>Open Gplan
42878>>>>>>>Open Sysrecg
42880>>>>>>>
42880>>>>>>>//DDB-HeaderEnd
42880>>>>>>>//DDB-ValidationStart
42880>>>>>>>
42880>>>>>>>Register_Object Gplanmod_Gplanmod_Module_VT
42880>>>>>>>
42880>>>>>>>Object Gplanmod_Gplanmod_Module_VT  is a CodeValidationTable
42882>>>>>>>    Set Type_Value        To "MODULE"
42883>>>>>>>    //DDB-ValidationCustomStart
42883>>>>>>>    //DDB-ValidationCustomEnd
42883>>>>>>>End_Object   // Gplanmod_Gplanmod_Module_VT
42884>>>>>>>//DDB-ValidationEnd
42884>>>>>>>Open SyscurGL
42886>>>>>>>
42886>>>>>>>Class Gplanmod_DataDictionary  is a DataDictionary_Sec
42887>>>>>>>
42887>>>>>>>    Procedure Creating
42888>>>>>>>        Forward Send Creating
42890>>>>>>>        // Insert Code Here
42890>>>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gplanmod.Gplanmod_Rec0)))))) to Gplanmod.Gplanmod_Recr
42891>>>>>>>    End_Procedure   // Creating
42892>>>>>>>
42892>>>>>>>    Procedure Update
42893>>>>>>>        Forward Send Update
42895>>>>>>>         Move SysCurGL.Company_Code to Gplanmod.Company_Code
42896>>>>>>>         Move SysCurGL.Branch_Code  to Gplanmod.Branch_Code
42897>>>>>>>         Move SysCurGL.Year_Year    to Gplanmod.Year_Year
42898>>>>>>>         Move SysCurGL.Year_Recr    to Gplanmod.Year_Recr
42899>>>>>>>         Move Gplan.Gplan_Code      to Gplanmod.Gplan_Code
42900>>>>>>>    End_Procedure   // Update
42901>>>>>>>
42901>>>>>>>
42901>>>>>>>    //1100:cby = globals
42901>>>>>>>    // Validate_Save:
42901>>>>>>>
42901>>>>>>>    Function Validate_Save  Returns Integer
42902>>>>>>>        Integer iReturnVal
42903>>>>>>>        Forward Get Validate_Save  To iReturnVal
42905>>>>>>>        If (Not(iReturnVal))Begin
42907>>>>>>>            //1100:cby = globals
42907>>>>>>>            If ( ;                (Not(Gplanmod.Company_Code = SysCurGL.Company_Code)) or;                (Not(Gplanmod.Branch_Code  = SysCurGL.Branch_Code )) or;                (Not(Gplanmod.Year_Year    = SysCurGL.Year_Year   ));                ) Send Operation_Not_Allowed 1100
42910>>>>>>>        End
42910>>>>>>>>
42910>>>>>>>        Function_Return iReturnVal
42911>>>>>>>    End_Function   // Validate_Save
42912>>>>>>>
42912>>>>>>>    //2100:cby = globals
42912>>>>>>>    // Validate_Delete:
42912>>>>>>>
42912>>>>>>>    Function Validate_Delete  Returns Integer
42913>>>>>>>        Local Integer iReturnVal liReturnValb##
42914>>>>>>>        Forward Get Validate_Delete  To iReturnVal
42916>>>>>>>
42916>>>>>>>        If (Not(iReturnVal)) Begin
42918>>>>>>>            // Insert Code Here
42918>>>>>>>            //2100:cby = globals
42918>>>>>>>            If ( ;                (Not(Gplanmod.Company_Code = SysCurGL.Company_Code)) or;                (Not(Gplanmod.Branch_Code  = SysCurGL.Branch_Code )) or;                (Not(Gplanmod.Year_Year    = SysCurGL.Year_Year   ));                )                                                   Send Operation_Not_Allowed 2100
42921>>>>>>>        End
42921>>>>>>>>
42921>>>>>>>
42921>>>>>>>        Function_Return iReturnVal
42922>>>>>>>    End_Function   // Validate_Delete
42923>>>>>>>
42923>>>>>>>    // Operation_Not_Allowed:
42923>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
42924>>>>>>>        // Insert Code Here
42924>>>>>>>             If (iError_num = 1100)  error 1100 "DDC 165 -  §¦¡«ã « ¨å-¨ã©"
42927>>>>>>>        Else if (iError_num = 2100)  error 2100 "DDC 165 -  §¦¡«ã « ¨å-¨ã©"
42931>>>>>>>        Else Forward Send Operation_Not_Allowed  iError_Num
42934>>>>>>>    End_Procedure   // Operation_Not_Allowed
42935>>>>>>>
42935>>>>>>>    Procedure Field_Defaults
42936>>>>>>>        Forward Send Field_Defaults
42938>>>>>>>        //DDB-Generated-Code-Location
42938>>>>>>>        //DDB-FieldDefaultStart
42938>>>>>>>        //DDB-FieldDefaultEnd
42938>>>>>>>    End_Procedure    // Field_Defaults
42939>>>>>>>
42939>>>>>>>
42939>>>>>>>    // Define_Fields:
42939>>>>>>>    // This procedure is used to set up all data-dictionary rules.
42939>>>>>>>
42939>>>>>>>    Procedure Define_Fields
42940>>>>>>>        Forward Send Define_Fields
42942>>>>>>>        //DDB-Generated-Code-Location
42942>>>>>>>        //DDB-DefineFieldStart
42942>>>>>>>
42942>>>>>>>        Set Main_File            To Gplanmod.File_Number
42943>>>>>>>        Set Cascade_Delete_State To FALSE
42944>>>>>>>
42944>>>>>>>
42944>>>>>>>        // Parent (Server) file structure...............
42944>>>>>>>        Send Add_Server_File  Gplan.File_Number
42945>>>>>>>
42945>>>>>>>        // External (System) file structure.............
42945>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_NEW_SAVE
42946>>>>>>>
42946>>>>>>>        Define_Auto_Increment  Sysrecg.Gplanmod_Rec0  To Gplanmod.Gplanmod_Rec0
42949>>>>>>>
42949>>>>>>>        // Field-based properties.......................
42949>>>>>>>
42949>>>>>>>        // Gplanmod.Company_Code
42949>>>>>>>
42949>>>>>>>        // Gplanmod.Branch_Code
42949>>>>>>>
42949>>>>>>>        // Gplanmod.Year_Year
42949>>>>>>>
42949>>>>>>>        // Gplanmod.Gplan_Code
42949>>>>>>>
42949>>>>>>>        // Gplanmod.Gplanmod_Module
42949>>>>>>>        Set Field_Value_Table      Field Gplanmod.Gplanmod_Module To (Gplanmod_Gplanmod_Module_VT(Self))
42950>>>>>>>
42950>>>>>>>        // Gplanmod.Gplanmod_Rec0
42950>>>>>>>
42950>>>>>>>        // Gplanmod.Gplan_Recr
42950>>>>>>>
42950>>>>>>>        // Gplanmod.Year_Recr
42950>>>>>>>
42950>>>>>>>        // Gplanmod.Gplanmod_Recr
42950>>>>>>>
42950>>>>>>>        //DDB-DefineFieldEnd
42950>>>>>>>    End_Procedure    // Define_Fields
42951>>>>>>>End_Class    // Gplanmod_DataDictionary
42952>>>>>>>//DDB-FileEnd
42952>>>>>Use GvatH.DD
INCLUDING FILE: GVATH.DD
42952>>>>>>>//DDB-FileStart
42952>>>>>>>//DDB-HeaderStart
42952>>>>>>>
42952>>>>>>>// File Name : GVATH.DD
42952>>>>>>>// Class Name: Gvath_DataDictionary
42952>>>>>>>// Revision  : 7
42952>>>>>>>// Version   : 2
42952>>>>>>>
42952>>>>>>>Use  Windows           // Basic Definitions
42952>>>>>>>Use  DataDict          // DataDictionary Class Definition
42952>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
42952>>>>>>>
42952>>>>>>>Open Gvath
42954>>>>>>>Open Gvatd
42956>>>>>>>
42956>>>>>>>//DDB-HeaderEnd
42956>>>>>>>//DDB-SelectionStart
42956>>>>>>>//DDB/ ExternalSelectionList sl071  Sl071.sl
42956>>>>>>>Register_Object sl071
42956>>>>>>>//DDB-SelectionEnd
42956>>>>>>>
42956>>>>>>>Class Gvath_DataDictionary  is a DataDictionary_Sec
42957>>>>>>>
42957>>>>>>>    // Define_Fields:
42957>>>>>>>    // This procedure is used to set up all data-dictionary rules.
42957>>>>>>>
42957>>>>>>>    Procedure Define_Fields
42958>>>>>>>        Forward Send Define_Fields
42960>>>>>>>        //DDB-Generated-Code-Location
42960>>>>>>>        //DDB-DefineFieldStart
42960>>>>>>>
42960>>>>>>>        Set Main_File            To Gvath.File_Number
42961>>>>>>>        Set Cascade_Delete_State To FALSE
42962>>>>>>>
42962>>>>>>>
42962>>>>>>>        // Child (Client) file structure................
42962>>>>>>>        Send Add_Client_File  Gvatd.File_Number
42963>>>>>>>
42963>>>>>>>        // Field-based properties.......................
42963>>>>>>>
42963>>>>>>>        // Gvath.Gvath_Code
42963>>>>>>>        Set Field_Options          Field Gvath.Gvath_Code To DD_AUTOFIND   
42964>>>>>>>        Set Field_Prompt_Object    Field Gvath.Gvath_Code To (sl071(Self))
42965>>>>>>>        Set Key_Field_State        Field Gvath.Gvath_Code To TRUE
42966>>>>>>>
42966>>>>>>>        // Gvath.Gvath_Descr
42966>>>>>>>        Set Field_Prompt_Object    Field Gvath.Gvath_Descr To (sl071(Self))
42967>>>>>>>
42967>>>>>>>        // Gvath.Gvath_Pct
42967>>>>>>>
42967>>>>>>>        // Gvath.Gvath_Recr
42967>>>>>>>
42967>>>>>>>        //DDB-DefineFieldEnd
42967>>>>>>>    End_Procedure    // Define_Fields
42968>>>>>>>
42968>>>>>>>    // Field_Defaults:
42968>>>>>>>    // This procedure is used to establish default field values.
42968>>>>>>>
42968>>>>>>>    Procedure Field_Defaults
42969>>>>>>>        Forward Send Field_Defaults
42971>>>>>>>        //DDB-Generated-Code-Location
42971>>>>>>>        //DDB-FieldDefaultStart
42971>>>>>>>        //DDB-FieldDefaultEnd
42971>>>>>>>    End_Procedure    // Field_Defaults
42972>>>>>>>End_Class    // Gvath_DataDictionary
42973>>>>>>>//DDB-Selection-pkg-Start
42973>>>>>>>
42973>>>>>>>Use Sl071.sl         // sl071
INCLUDING FILE: SL071.SL
42973>>>>>>>>>//AB/ Project sl071:Katastrosi Periodikhs FPA
42973>>>>>>>>>//AB/     Object prj is a Lookup_Project
42973>>>>>>>>>//AB/         Set ProjectName to "sl071:Katastrosi Periodikhs FPA"
42973>>>>>>>>>//AB/         Set ProjectFileName to "sl071.SL"
42973>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
42973>>>>>>>>>
42973>>>>>>>>>// Project Object Structure
42973>>>>>>>>>//   sl071 is a dbModalPanel
42973>>>>>>>>>//     Gvath_DD is a DataDictionary
42973>>>>>>>>>//     oSelList is a dbList
42973>>>>>>>>>//     oOK_bn is a Button
42973>>>>>>>>>//     oCancel_bn is a Button
42973>>>>>>>>>//     oSearch_bn is a Button
42973>>>>>>>>>
42973>>>>>>>>>// Register all objects
42973>>>>>>>>>Register_Object Gvath_DD
42973>>>>>>>>>Register_Object oCancel_bn
42973>>>>>>>>>Register_Object oOK_bn
42973>>>>>>>>>Register_Object oSearch_bn
42973>>>>>>>>>Register_Object oSelList
42973>>>>>>>>>Register_Object sl071
42973>>>>>>>>>
42973>>>>>>>>>
42973>>>>>>>>>    //AB-IgnoreStart
42973>>>>>>>>>
42973>>>>>>>>>    Use DFAllEnt.pkg
42973>>>>>>>>>
42973>>>>>>>>>
42973>>>>>>>>>    Use GVATH.DD
42973>>>>>>>>>    
42973>>>>>>>>>    //AB-IgnoreEnd
42973>>>>>>>>>
42973>>>>>>>>>    CD_Popup_Object sl071 is a dbModalPanel
42992>>>>>>>>>        Set Label to "sl071:¨ ¦ ¡ã ã¢à© "
42993>>>>>>>>>        Set Size to 215 418
42994>>>>>>>>>
42994>>>>>>>>>        //AB-DDOStart
42994>>>>>>>>>
42994>>>>>>>>>        Object Gvath_DD is a Gvath_DataDictionary
42996>>>>>>>>>        End_Object    // Gvath_DD
42997>>>>>>>>>
42997>>>>>>>>>        Set Main_DD to (Gvath_DD(self))
42998>>>>>>>>>        Set Server to (Gvath_DD(self))
42999>>>>>>>>>
42999>>>>>>>>>        //AB-DDOEnd
42999>>>>>>>>>
42999>>>>>>>>>        Object oSelList is a dbList
43001>>>>>>>>>            Set Main_File to Gvath.File_Number
43002>>>>>>>>>            Set Ordering to 1
43003>>>>>>>>>            Set Size to 159 403
43004>>>>>>>>>            Set Location to 7 5
43005>>>>>>>>>
43005>>>>>>>>>            Begin_Row
43008>>>>>>>>>                Entry_Item Gvath.Gvath_code
43009>>>>>>>>>                Entry_Item Gvath.Gvath_descr
43010>>>>>>>>>                Entry_Item Gvath.Gvath_pct
43011>>>>>>>>>            End_Row
43016>>>>>>>>>
43016>>>>>>>>>            Set Form_Width    item 0 to 120
43017>>>>>>>>>            Set Header_Label  item 0 to "à ¡æª "
43018>>>>>>>>>            
43018>>>>>>>>>            Set Form_Width    item 1 to 229
43019>>>>>>>>>            Set Header_Label  item 1 to "¨ ¨­ã"
43020>>>>>>>>>            
43020>>>>>>>>>            Set Form_Width    item 2 to 48
43021>>>>>>>>>            Set Header_Label  item 2 to "%¬¤«."
43022>>>>>>>>>            
43022>>>>>>>>>        End_Object    // oSelList
43023>>>>>>>>>
43023>>>>>>>>>        Object oOK_bn is a Button
43025>>>>>>>>>            Set Label to "&OK"
43026>>>>>>>>>            Set Location to 175 247
43027>>>>>>>>>
43027>>>>>>>>>            //AB-StoreStart
43027>>>>>>>>>            Procedure OnClick
43029>>>>>>>>>                Send OK To oSelList
43030>>>>>>>>>            End_Procedure
43031>>>>>>>>>            //AB-StoreEnd
43031>>>>>>>>>
43031>>>>>>>>>        End_Object    // oOK_bn
43032>>>>>>>>>
43032>>>>>>>>>        Object oCancel_bn is a Button
43034>>>>>>>>>            Set Label to "&Cancel"
43035>>>>>>>>>            Set Location to 175 300
43036>>>>>>>>>
43036>>>>>>>>>            //AB-StoreStart
43036>>>>>>>>>            Procedure OnClick
43038>>>>>>>>>                Send Cancel To oSelList
43039>>>>>>>>>            End_Procedure
43040>>>>>>>>>            //AB-StoreEnd
43040>>>>>>>>>
43040>>>>>>>>>        End_Object    // oCancel_bn
43041>>>>>>>>>
43041>>>>>>>>>        Object oSearch_bn is a Button
43043>>>>>>>>>            Set Label to "&Search..."
43044>>>>>>>>>            Set Location to 175 356
43045>>>>>>>>>
43045>>>>>>>>>            //AB-StoreStart
43045>>>>>>>>>            Procedure OnClick
43047>>>>>>>>>                Send Search To oSelList
43048>>>>>>>>>            End_Procedure
43049>>>>>>>>>            //AB-StoreEnd
43049>>>>>>>>>
43049>>>>>>>>>        End_Object    // oSearch_bn
43050>>>>>>>>>
43050>>>>>>>>>
43050>>>>>>>>>        //AB-StoreStart
43050>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To oOk_bn
43051>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To oCancel_bn
43052>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To oSearch_bn
43053>>>>>>>>>        //AB-StoreEnd
43053>>>>>>>>>
43053>>>>>>>>>    CD_End_Object    // sl071
43055>>>>>>>>>>
43055>>>>>>>>>
43055>>>>>>>>>//AB/     End_Object    // prj
43055>>>>>>>
43055>>>>>>>//DDB-Selection-pkg-End
43055>>>>>>>//DDB-FileEnd
43055>>>>>Use GVATD.DD
INCLUDING FILE: GVATD.DD
43055>>>>>>>//DDB-FileStart
43055>>>>>>>//DDB-HeaderStart
43055>>>>>>>
43055>>>>>>>// File Name : GVATD.DD
43055>>>>>>>// Class Name: Gvatd_DataDictionary
43055>>>>>>>// Revision  : 6
43055>>>>>>>// Version   : 2
43055>>>>>>>
43055>>>>>>>Use  Windows           // Basic Definitions
43055>>>>>>>Use  DataDict          // DataDictionary Class Definition
43055>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43055>>>>>>>
43055>>>>>>>Open Gvatd
43057>>>>>>>Open Gvath
43059>>>>>>>Open Gplan
43061>>>>>>>
43061>>>>>>>//DDB-HeaderEnd
43061>>>>>>>//DDB-ValidationStart
43061>>>>>>>
43061>>>>>>>Register_Object Gvatd_Gvatd_Xp_VT
43061>>>>>>>
43061>>>>>>>Object Gvatd_Gvatd_Xp_VT  is a DescriptionValidationTable
43063>>>>>>>
43063>>>>>>>    Procedure Fill_List
43065>>>>>>>        Forward Send Fill_List
43067>>>>>>>        Send Add_Table_Value  "1"  "¨âà©"
43068>>>>>>>        Send Add_Table_Value  "2"  "å©«à©"
43069>>>>>>>    End_Procedure    // Fill_List
43070>>>>>>>    //DDB-ValidationCustomStart
43070>>>>>>>    //DDB-ValidationCustomEnd
43070>>>>>>>End_Object   // Gvatd_Gvatd_Xp_VT
43071>>>>>>>//DDB-ValidationEnd
43071>>>>>>>  
43071>>>>>>>Class Gvatd_DataDictionary  is a DataDictionary_Sec
43072>>>>>>>
43072>>>>>>>    Procedure Update
43073>>>>>>>        Forward Send Update
43075>>>>>>>        // Insert Code Here
43075>>>>>>>        Move SysCurGL.Company_Code  to GVatd.Company_Code
43076>>>>>>>        Move SysCurGL.Branch_Code   to GVatd.Branch_Code
43077>>>>>>>        Move SysCurGL.Year_Year     to GVatd.Year_Year
43078>>>>>>>        Move SysCurGL.Year_Recr     to GVatd.Year_Recr
43079>>>>>>>        Move Gplan.Gplan_Code       to GVatd.Gplan_Code
43080>>>>>>>    End_Procedure   // Update
43081>>>>>>>
43081>>>>>>>    // Define_Fields:
43081>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43081>>>>>>>
43081>>>>>>>    Procedure Define_Fields
43082>>>>>>>        Forward Send Define_Fields
43084>>>>>>>        //DDB-Generated-Code-Location
43084>>>>>>>        //DDB-DefineFieldStart
43084>>>>>>>
43084>>>>>>>        Set Main_File            To Gvatd.File_Number
43085>>>>>>>        Set Cascade_Delete_State To FALSE
43086>>>>>>>
43086>>>>>>>
43086>>>>>>>        // Parent (Server) file structure...............
43086>>>>>>>        Send Add_Server_File  Gvath.File_Number
43087>>>>>>>        Send Add_Server_File  Gplan.File_Number
43088>>>>>>>
43088>>>>>>>        // Field-based properties.......................
43088>>>>>>>
43088>>>>>>>        // Gvatd.Company_Code
43088>>>>>>>
43088>>>>>>>        // Gvatd.Branch_Code
43088>>>>>>>
43088>>>>>>>        // Gvatd.Year_Year
43088>>>>>>>
43088>>>>>>>        // Gvatd.Year_Recr
43088>>>>>>>
43088>>>>>>>        // Gvatd.Gvath_Code
43088>>>>>>>
43088>>>>>>>        // Gvatd.Gplan_Code
43088>>>>>>>
43088>>>>>>>        // Gvatd.Gplan_Recr
43088>>>>>>>
43088>>>>>>>        // Gvatd.Gvatd_Xp
43088>>>>>>>        Set Field_Value_Table      Field Gvatd.Gvatd_Xp To (Gvatd_Gvatd_Xp_VT(Self))
43089>>>>>>>
43089>>>>>>>        //DDB-DefineFieldEnd
43089>>>>>>>    End_Procedure    // Define_Fields
43090>>>>>>>
43090>>>>>>>    // Field_Defaults:
43090>>>>>>>    // This procedure is used to establish default field values.
43090>>>>>>>
43090>>>>>>>    Procedure Field_Defaults
43091>>>>>>>        Forward Send Field_Defaults
43093>>>>>>>        //DDB-Generated-Code-Location
43093>>>>>>>        //DDB-FieldDefaultStart
43093>>>>>>>        Set Field_Changed_Value   Field Gvatd.Gvatd_Xp To "1"
43094>>>>>>>        //DDB-FieldDefaultEnd
43094>>>>>>>    End_Procedure    // Field_Defaults
43095>>>>>>>End_Class    // Gvatd_DataDictionary
43096>>>>>>>//DDB-FileEnd
43096>>>>>
43096>>>>>//AB-IgnoreEnd
43096>>>>>
43096>>>>>DEFERRED_VIEW Activate_Gplan_View FOR ;;Object Gplan_View is a dbViewSub
43115>>>>>
43115>>>>>    //AB-StoreTopStart
43115>>>>>    Property string PsGformat_Mask ""
43117>>>>>    
43117>>>>>    //AB-StoreTopEnd
43117>>>>>
43117>>>>>    Set Label to "¦ ©« ¡æ ®â ¦"
43118>>>>>    Set Size to 292 513
43119>>>>>    Set Location to 1 2
43120>>>>>
43120>>>>>    //AB-DDOStart
43120>>>>>
43120>>>>>    Object Gplan_DD is a Gplan_DataDictionary
43122>>>>>
43122>>>>>        //AB-StoreStart
43122>>>>>                                                                                
43122>>>>>        Set allow_foreign_new_save_state to True
43123>>>>>        
43123>>>>>        
43123>>>>>        
43123>>>>>        
43123>>>>>        
43123>>>>>        //AB-StoreEnd
43123>>>>>
43123>>>>>    End_Object    // Gplan_DD
43124>>>>>
43124>>>>>    Object Syscurgl_DD is a SysCurGL_DataDictionary
43126>>>>>    End_Object    // Syscurgl_DD
43127>>>>>
43127>>>>>    Object Gplanmod_DD is a Gplanmod_DataDictionary
43129>>>>>        Set DDO_Server to (Gplan_DD(self))
43130>>>>>        Set Constrain_File to Gplan.File_Number
43131>>>>>    End_Object    // Gplanmod_DD
43132>>>>>
43132>>>>>    Object Gvath_DD is a GvatH_DataDictionary
43134>>>>>    End_Object    // Gvath_DD
43135>>>>>
43135>>>>>    Object Gvatd_DD is a Gvatd_DataDictionary
43137>>>>>        Set DDO_Server to (Gvath_DD(self))
43138>>>>>        Set DDO_Server to (Gplan_DD(self))
43139>>>>>        Set Constrain_File to Gplan.File_Number
43140>>>>>    End_Object    // Gvatd_DD
43141>>>>>
43141>>>>>    Set Main_DD to (Gplan_DD(self))
43142>>>>>    Set Server to (Gplan_DD(self))
43143>>>>>
43143>>>>>    //AB-DDOEnd
43143>>>>>
43143>>>>>    Object Gplan_Gplan_Code is a dbFormSub
43145>>>>>        Entry_Item Gplan.Gplan_code
43146>>>>>        Set Size to 13 126
43147>>>>>        Set Location to 31 81
43148>>>>>        Set Label_Col_Offset to 2
43149>>>>>        Set Label_Justification_Mode to jMode_Right
43150>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43151>>>>>
43151>>>>>        //AB-StoreStart
43151>>>>>                                                                                
43151>>>>>                                                                                
43151>>>>>        //AB-StoreEnd
43151>>>>>
43151>>>>>    End_Object    // Gplan_Gplan_Code
43152>>>>>
43152>>>>>    Object Gplan_Gplan_Descr1 is a dbFormSub
43154>>>>>        Entry_Item Gplan.Gplan_descr1
43155>>>>>        Set Size to 13 298
43156>>>>>        Set Location to 46 80
43157>>>>>        Set Label_Col_Offset to 2
43158>>>>>        Set Label_Justification_Mode to jMode_Right
43159>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43160>>>>>    End_Object    // Gplan_Gplan_Descr1
43161>>>>>
43161>>>>>    Object Gplan_Gplan_Descr2 is a dbFormSub
43163>>>>>        Entry_Item Gplan.Gplan_descr2
43164>>>>>        Set Size to 13 298
43165>>>>>        Set Location to 60 80
43166>>>>>        Set Label_Col_Offset to 2
43167>>>>>        Set Label_Justification_Mode to jMode_Right
43168>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43169>>>>>    End_Object    // Gplan_Gplan_Descr2
43170>>>>>
43170>>>>>    Object Gplan_Gplan_Bathmos is a dbFormSub
43172>>>>>        Entry_Item Gplan.Gplan_bathmos
43173>>>>>        Set Size to 13 18
43174>>>>>        Set Location to 76 80
43175>>>>>        Set Label_Col_Offset to 2
43176>>>>>        Set Label_Justification_Mode to jMode_Right
43177>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43178>>>>>
43178>>>>>        //AB-StoreStart
43178>>>>>        Set Object_Shadow_State to True
43179>>>>>        
43179>>>>>        
43179>>>>>        
43179>>>>>        //AB-StoreEnd
43179>>>>>
43179>>>>>    End_Object    // Gplan_Gplan_Bathmos
43180>>>>>
43180>>>>>    Object Gplan_Gplan_Anoep is a dbFormSub
43182>>>>>        Entry_Item Gplan.Gplan_anoep
43183>>>>>        Set Size to 13 146
43184>>>>>        Set Location to 76 232
43185>>>>>        Set Label_Col_Offset to 2
43186>>>>>        Set Label_Justification_Mode to jMode_Right
43187>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43188>>>>>
43188>>>>>        //AB-StoreStart
43188>>>>>        Set Object_Shadow_State to True
43189>>>>>        
43189>>>>>        
43189>>>>>        
43189>>>>>        //AB-StoreEnd
43189>>>>>
43189>>>>>    End_Object    // Gplan_Gplan_Anoep
43190>>>>>
43190>>>>>    Object Gplan_Gplan_O_Code is a dbComboFormSub
43192>>>>>        Entry_Item Gplan.Gplan_o_code
43193>>>>>        Set Size to 13 81
43194>>>>>        Set Location to 91 80
43195>>>>>        Set Label_Col_Offset to 2
43196>>>>>        Set Label_Justification_Mode to jMode_Right
43197>>>>>    End_Object    // Gplan_Gplan_O_Code
43198>>>>>
43198>>>>>    Object Gplan_Gplan_C_Code1 is a dbComboFormSub
43200>>>>>        Entry_Item Gplan.Gplan_c_code2
43201>>>>>        Set Size to 13 65
43202>>>>>        Set Location to 90 232
43203>>>>>        Set Label_Col_Offset to 2
43204>>>>>        Set Label_Justification_Mode to jMode_Right
43205>>>>>        Set Visible_State to FALSE
43206>>>>>
43206>>>>>        //AB-StoreStart
43206>>>>>        set enabled_state to false
43207>>>>>        //AB-StoreEnd
43207>>>>>
43207>>>>>    End_Object    // Gplan_Gplan_C_Code1
43208>>>>>
43208>>>>>    Object dbTabDialogSub1 is a dbTabDialogSub
43210>>>>>        Set Size to 159 505
43211>>>>>        Set Location to 116 3
43212>>>>>        Set Rotate_Mode to RM_Rotate
43213>>>>>        Object dbTabPage1 is a dbTabPage
43215>>>>>            Set Label to "dbTabPage1"
43216>>>>>            Object dbGroupSub2 is a dbGroupSub
43218>>>>>                Set Size to 134 246
43219>>>>>                Set Location to 4 2
43220>>>>>                Object Gplan_Gplan_Yn_Last is a dbComboFormSub
43222>>>>>                    Entry_Item Gplan.Gplan_yn_last
43223>>>>>                    Set Size to 10 54
43224>>>>>                    Set Location to 9 127
43225>>>>>                    Set Label_Col_Offset to 2
43226>>>>>                End_Object    // Gplan_Gplan_Yn_Last
43227>>>>>
43227>>>>>                Object Gplan_Gplan_Yn_Xfer is a dbComboFormSub
43229>>>>>                    Entry_Item Gplan.Gplan_yn_xfer
43230>>>>>                    Set Size to 10 54
43231>>>>>                    Set Location to 22 127
43232>>>>>                    Set Label_Col_Offset to 2
43233>>>>>                End_Object    // Gplan_Gplan_Yn_Xfer
43234>>>>>
43234>>>>>                Object Gplan_Gplan_Yn_Kin is a dbComboFormSub
43236>>>>>                    Entry_Item Gplan.Gplan_yn_kin
43237>>>>>                    Set Size to 10 54
43238>>>>>                    Set Location to 35 127
43239>>>>>                    Set Label_Col_Offset to 2
43240>>>>>                End_Object    // Gplan_Gplan_Yn_Kin
43241>>>>>
43241>>>>>                Object Gplan_Gplan_Yn_Xy is a dbComboFormSub
43243>>>>>                    Entry_Item Gplan.Gplan_yn_xy
43244>>>>>                    Set Size to 10 54
43245>>>>>                    Set Location to 48 127
43246>>>>>                    Set Label_Col_Offset to 2
43247>>>>>                End_Object    // Gplan_Gplan_Yn_Xy
43248>>>>>
43248>>>>>                Object Gplan_Gplan_Yn_Py is a dbComboFormSub
43250>>>>>                    Entry_Item Gplan.Gplan_yn_py
43251>>>>>                    Set Size to 10 54
43252>>>>>                    Set Location to 61 127
43253>>>>>                    Set Label_Col_Offset to 2
43254>>>>>                End_Object    // Gplan_Gplan_Yn_Py
43255>>>>>
43255>>>>>                Object Gplan_Gplan_Myf_Sum is a dbComboFormSub
43257>>>>>                    Entry_Item Gplan.Gplan_myf_sump
43258>>>>>                    Set Size to 13 156
43259>>>>>                    Set Location to 75 87
43260>>>>>                    Set Label_Col_Offset to 2
43261>>>>>                End_Object    // Gplan_Gplan_Myf_Sum
43262>>>>>
43262>>>>>                Object Gplan_Gplan_Yn_Myfp is a dbComboFormSub
43264>>>>>                    Entry_Item Gplan.Gplan_yn_myfp
43265>>>>>                    Set Size to 10 54
43266>>>>>                    Set Location to 88 127
43267>>>>>                    Set Label_Col_Offset to 2
43268>>>>>                End_Object    // Gplan_Gplan_Yn_Myfp
43269>>>>>
43269>>>>>                Object Gplan_Gplan_Yn_Kk is a dbCheckBoxSub
43271>>>>>                    Entry_Item Gplan.Gplan_yn_kk
43272>>>>>                    Set Label to "¤á¢¬© © â¤«¨ æ©«¦¬ª"
43273>>>>>                    Set Size to 10 113
43274>>>>>                    Set Location to 103 127
43275>>>>>                End_Object    // Gplan_Gplan_Yn_Kk
43276>>>>>
43276>>>>>                Object TextBoxSub12 is a TextBoxSub
43278>>>>>                    Set Label to "«­â¨« :"
43279>>>>>                    Set Auto_Size_State to FALSE
43280>>>>>                    Set FontSize to 4 0
43281>>>>>                    Set Location to 21 6
43282>>>>>                    Set Size to 13 113
43283>>>>>                    Set TypeFace to "MS Sans Serif"
43284>>>>>                    Set Enabled_State to TRUE
43285>>>>>                End_Object    // TextBoxSub12
43286>>>>>
43286>>>>>                Object TextBoxSub13 is a TextBoxSub
43288>>>>>                    Set Label to " ¤å«  §¦ æ¢ « modules"
43289>>>>>                    Set Auto_Size_State to FALSE
43290>>>>>                    Set FontSize to 4 0
43291>>>>>                    Set Location to 35 6
43292>>>>>                    Set Size to 13 113
43293>>>>>                    Set TypeFace to "MS Sans Serif"
43294>>>>>                    Set Enabled_State to TRUE
43295>>>>>                End_Object    // TextBoxSub13
43296>>>>>
43296>>>>>                Object TextBoxSub15 is a TextBoxSub
43298>>>>>                    Set Label to "¢¬«å¦ª £æª:"
43299>>>>>                    Set Auto_Size_State to FALSE
43300>>>>>                    Set FontSize to 4 0
43301>>>>>                    Set Location to 8 6
43302>>>>>                    Set Size to 13 113
43303>>>>>                    Set TypeFace to "MS Sans Serif"
43304>>>>>                    Set Enabled_State to TRUE
43305>>>>>                End_Object    // TextBoxSub15
43306>>>>>
43306>>>>>                Object TextBoxSub16 is a TextBoxSub
43308>>>>>                    Set Label to "§ «¨â§«  ¨à©« ¡æ §æ¢¦ §¦:"
43309>>>>>                    Set Auto_Size_State to FALSE
43310>>>>>                    Set FontSize to 4 0
43311>>>>>                    Set Location to 47 6
43312>>>>>                    Set Size to 13 113
43313>>>>>                    Set TypeFace to "MS Sans Serif"
43314>>>>>                    Set Enabled_State to TRUE
43315>>>>>                End_Object    // TextBoxSub16
43316>>>>>
43316>>>>>                Object TextBoxSub17 is a TextBoxSub
43318>>>>>                    Set Label to "§ «¨â§«   ©«à« ¡æ §æ¢¦ §¦:"
43319>>>>>                    Set Auto_Size_State to FALSE
43320>>>>>                    Set FontSize to 4 0
43321>>>>>                    Set Location to 60 6
43322>>>>>                    Set Size to 13 113
43323>>>>>                    Set TypeFace to "MS Sans Serif"
43324>>>>>                    Set Enabled_State to TRUE
43325>>>>>                End_Object    // TextBoxSub17
43326>>>>>
43326>>>>>                Object TextBoxSub18 is a TextBoxSub
43328>>>>>                    Set Label to "¦¨ ©£æª "
43329>>>>>                    Set Auto_Size_State to FALSE
43330>>>>>                    Set FontSize to 4 0
43331>>>>>                    Set Location to 89 6
43332>>>>>                    Set Size to 13 113
43333>>>>>                    Set TypeFace to "MS Sans Serif"
43334>>>>>                    Set Enabled_State to TRUE
43335>>>>>                End_Object    // TextBoxSub18
43336>>>>>
43336>>>>>                Object TextBoxSub46 is a TextBoxSub
43338>>>>>                    Set Label to "¬££«¦®ã ©  "
43339>>>>>                    Set Auto_Size_State to FALSE
43340>>>>>                    Set FontSize to 4 0
43341>>>>>                    Set Location to 75 6
43342>>>>>                    Set Size to 13 78
43343>>>>>                    Set TypeFace to "MS Sans Serif"
43344>>>>>                    Set Enabled_State to TRUE
43345>>>>>                End_Object    // TextBoxSub46
43346>>>>>
43346>>>>>            End_Object    // dbGroupSub2
43347>>>>>
43347>>>>>            Object dbGroupSub3 is a dbGroupSub
43349>>>>>                Set Size to 134 247
43350>>>>>                Set Location to 4 251
43351>>>>>                Object Gplan_Gplan_Xpm is a dbComboFormSub
43353>>>>>                    Entry_Item Gplan.Gplan_xpm
43354>>>>>                    Set Size to 13 126
43355>>>>>                    Set Location to 9 115
43356>>>>>                    Set Label_Col_Offset to 2
43357>>>>>                    Set Label_Justification_Mode to jMode_Right
43358>>>>>                End_Object    // Gplan_Gplan_Xpm
43359>>>>>
43359>>>>>                Object Gplan_Gplan_Rep_Code is a dbFormSub
43361>>>>>                    Entry_Item Gplan.Gplan_rep_code
43362>>>>>                    Set Size to 13 126
43363>>>>>                    Set Location to 22 115
43364>>>>>                    Set Label_Col_Offset to 2
43365>>>>>                    Set Label_Justification_Mode to jMode_Right
43366>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
43367>>>>>                End_Object    // Gplan_Gplan_Rep_Code
43368>>>>>
43368>>>>>                Object Gplan_Gplan_Rep_Pct is a dbFormSub
43370>>>>>                    Entry_Item Gplan.Gplan_rep_pct
43371>>>>>                    Set Size to 13 54
43372>>>>>                    Set Location to 35 115
43373>>>>>                    Set Label_Col_Offset to 2
43374>>>>>                    Set Label_Justification_Mode to jMode_Right
43375>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
43376>>>>>                End_Object    // Gplan_Gplan_Rep_Pct
43377>>>>>
43377>>>>>                Object Gvath_Gvath_Descr is a dbFormSub
43379>>>>>                    Entry_Item Gvath.Gvath_descr
43380>>>>>                    Set Server to (Gvatd_DD(self))
43381>>>>>                    Set Size to 13 126
43382>>>>>                    Set Location to 63 115
43383>>>>>                    Set Label_Col_Offset to 100
43384>>>>>                    Set Auto_Fill_State to TRUE
43385>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
43386>>>>>                End_Object    // Gvath_Gvath_Descr
43387>>>>>
43387>>>>>                Object Gvath_Gvath_Code is a dbFormSub
43389>>>>>                    Entry_Item Gvath.Gvath_code
43390>>>>>                    Set Server to (Gvatd_DD(self))
43391>>>>>                    Set Size to 13 126
43392>>>>>                    Set Location to 49 115
43393>>>>>                    Set Label_Col_Offset to 100
43394>>>>>                    Set Auto_Fill_State to TRUE
43395>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
43396>>>>>                End_Object    // Gvath_Gvath_Code
43397>>>>>
43397>>>>>                Object Gplan_Gplan_Myf_Suma is a dbComboFormSub
43399>>>>>                    Entry_Item Gplan.Gplan_myf_suma
43400>>>>>                    Set Size to 13 156
43401>>>>>                    Set Location to 77 85
43402>>>>>                    Set Label_Col_Offset to 73
43403>>>>>                    Set Visible_State to FALSE
43404>>>>>                End_Object    // Gplan_Gplan_Myf_Suma
43405>>>>>
43405>>>>>                Object Gplan_Gplan_Yn_Myfa is a dbComboFormSub
43407>>>>>                    Entry_Item Gplan.Gplan_yn_myfa
43408>>>>>                    Set Size to 10 56
43409>>>>>                    Set Location to 91 115
43410>>>>>                    Set Label_Col_Offset to 98
43411>>>>>                    Set Visible_State to FALSE
43412>>>>>                End_Object    // Gplan_Gplan_Yn_Myfa
43413>>>>>
43413>>>>>                Object TextBoxSub19 is a TextBoxSub
43415>>>>>                    Set Label to "å¦ª å¤©ª:"
43416>>>>>                    Set Auto_Size_State to FALSE
43417>>>>>                    Set FontSize to 4 0
43418>>>>>                    Set Location to 9 7
43419>>>>>                    Set Size to 13 75
43420>>>>>                    Set TypeFace to "MS Sans Serif"
43421>>>>>                    Set Enabled_State to TRUE
43422>>>>>                End_Object    // TextBoxSub19
43423>>>>>
43423>>>>>                Object TextBoxSub40 is a TextBoxSub
43425>>>>>                    Set Label to "à ¡æª ¦/£¦ç Reporting:"
43426>>>>>                    Set Auto_Size_State to FALSE
43427>>>>>                    Set FontSize to 4 0
43428>>>>>                    Set Location to 22 7
43429>>>>>                    Set Size to 13 91
43430>>>>>                    Set TypeFace to "MS Sans Serif"
43431>>>>>                    Set Enabled_State to TRUE
43432>>>>>                End_Object    // TextBoxSub40
43433>>>>>
43433>>>>>                Object TextBoxSub41 is a TextBoxSub
43435>>>>>                    Set Label to "¦©¦©«æ «­¦¨áª:"
43436>>>>>                    Set Auto_Size_State to FALSE
43437>>>>>                    Set FontSize to 4 0
43438>>>>>                    Set Location to 35 7
43439>>>>>                    Set Size to 13 91
43440>>>>>                    Set TypeFace to "MS Sans Serif"
43441>>>>>                    Set Enabled_State to TRUE
43442>>>>>                End_Object    // TextBoxSub41
43443>>>>>
43443>>>>>                Object txtSymMyfA is a TextBoxSub
43445>>>>>                    Set Label to "¬££«¦®ã ©  A:"
43446>>>>>                    Set Location to 79 7
43447>>>>>                    Set Size to 10 77
43448>>>>>                    Set TypeFace to "MS Sans Serif"
43449>>>>>                    Set Visible_State to FALSE
43450>>>>>                End_Object    // txtSymMyfA
43451>>>>>
43451>>>>>                Object txtMyfA is a TextBoxSub
43453>>>>>                    Set Label to "¦¨ ©£æª  A:"
43454>>>>>                    Set Location to 94 7
43455>>>>>                    Set Size to 10 73
43456>>>>>                    Set TypeFace to "MS Sans Serif"
43457>>>>>                    Set Visible_State to FALSE
43458>>>>>                End_Object    // txtMyfA
43459>>>>>
43459>>>>>                Object txtFpa1 is a TextBoxSub
43461>>>>>                    Set Label to "à. ¨ ¦ ¡ãª ã¢à©ª:"
43462>>>>>                    Set Location to 50 7
43463>>>>>                    Set Size to 10 104
43464>>>>>                    Set TypeFace to "MS Sans Serif"
43465>>>>>                End_Object    // txtFpa1
43466>>>>>
43466>>>>>                Object txtFpa2 is a TextBoxSub
43468>>>>>                    Set Label to "¨. ¨ ¦ ¡ãª ã¢à©ª:"
43469>>>>>                    Set Location to 65 7
43470>>>>>                    Set Size to 10 104
43471>>>>>                    Set TypeFace to "MS Sans Serif"
43472>>>>>                End_Object    // txtFpa2
43473>>>>>
43473>>>>>            End_Object    // dbGroupSub3
43474>>>>>
43474>>>>>
43474>>>>>            //AB-StoreStart
43474>>>>>            Set Label to "«¦ ®å å¤©ª ¦¨ ©£¦ç"
43475>>>>>            
43475>>>>>            
43475>>>>>            //AB-StoreEnd
43475>>>>>
43475>>>>>        End_Object    // dbTabPage1
43476>>>>>
43476>>>>>        Object dbTabPage2 is a dbTabPage
43478>>>>>            Set Label to "dbTabPage2"
43479>>>>>            Object dbGroupSub4 is a dbGroupSub
43481>>>>>                Set Size to 132 335
43482>>>>>                Set Location to 5 2
43483>>>>>                Object Gplan_Gplan_Afm is a dbFormSub
43485>>>>>                    Entry_Item Gplan.Gplan_afm
43486>>>>>                    Set Size to 13 126
43487>>>>>                    Set Location to 9 71
43488>>>>>                    Set Label_Col_Offset to 2
43489>>>>>                    Set Label_Justification_Mode to jMode_Right
43490>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
43491>>>>>                End_Object    // Gplan_Gplan_Afm
43492>>>>>
43492>>>>>                Object Gplan_Gplan_Addr is a dbFormSub
43494>>>>>                    Entry_Item Gplan.Gplan_addr
43495>>>>>                    Set Size to 13 257
43496>>>>>                    Set Location to 23 71
43497>>>>>                    Set Label_Col_Offset to 2
43498>>>>>                    Set Label_Justification_Mode to jMode_Right
43499>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
43500>>>>>                End_Object    // Gplan_Gplan_Addr
43501>>>>>
43501>>>>>                Object Gplan_Gplan_Doy is a dbComboFormSub
43503>>>>>                    Entry_Item Gplan.Gplan_doy
43504>>>>>                    Set Size to 13 126
43505>>>>>                    Set Location to 37 71
43506>>>>>                    Set Label_Col_Offset to 2
43507>>>>>                    Set Label_Justification_Mode to jMode_Right
43508>>>>>                End_Object    // Gplan_Gplan_Doy
43509>>>>>
43509>>>>>                Object Gplan_Gplan_Poli is a dbFormSub
43511>>>>>                    Entry_Item Gplan.Gplan_poli
43512>>>>>                    Set Size to 13 126
43513>>>>>                    Set Location to 52 71
43514>>>>>                    Set Label_Col_Offset to 2
43515>>>>>                    Set Label_Justification_Mode to jMode_Right
43516>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
43517>>>>>                End_Object    // Gplan_Gplan_Poli
43518>>>>>
43518>>>>>                Object Gplan_Gplan_Tk_ is a dbFormSub
43520>>>>>                    Entry_Item Gplan.Gplan_tk
43521>>>>>                    Set Size to 13 89
43522>>>>>                    Set Location to 52 235
43523>>>>>                    Set Label_Col_Offset to 2
43524>>>>>                    Set Label_Justification_Mode to jMode_Right
43525>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
43526>>>>>                End_Object    // Gplan_Gplan_Tk_
43527>>>>>
43527>>>>>                Object Gplan_Gplan_Tel is a dbFormSub
43529>>>>>                    Entry_Item Gplan.Gplan_tel
43530>>>>>                    Set Size to 13 126
43531>>>>>                    Set Location to 67 71
43532>>>>>                    Set Label_Col_Offset to 2
43533>>>>>                    Set Label_Justification_Mode to jMode_Right
43534>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
43535>>>>>                End_Object    // Gplan_Gplan_Tel
43536>>>>>
43536>>>>>                Object Gplan_Gplan_Email is a dbFormSub
43538>>>>>                    Entry_Item Gplan.Gplan_email
43539>>>>>                    Set Size to 13 89
43540>>>>>                    Set Location to 67 235
43541>>>>>                    Set Label_Col_Offset to 2
43542>>>>>                    Set Label_Justification_Mode to jMode_Right
43543>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
43544>>>>>                End_Object    // Gplan_Gplan_Email
43545>>>>>
43545>>>>>                Object Gplan_Gplan_Resp is a dbFormSub
43547>>>>>                    Entry_Item Gplan.Gplan_resp
43548>>>>>                    Set Size to 13 126
43549>>>>>                    Set Location to 81 71
43550>>>>>                    Set Label_Col_Offset to 2
43551>>>>>                    Set Label_Justification_Mode to jMode_Right
43552>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
43553>>>>>                End_Object    // Gplan_Gplan_Resp
43554>>>>>
43554>>>>>                Object Gplan_Gplan_Bitmap is a dbFormSub
43556>>>>>                    Entry_Item Gplan.Gplan_bitmap
43557>>>>>                    Set Size to 13 127
43558>>>>>                    Set Location to 95 71
43559>>>>>                    Set Label_Col_Offset to 2
43560>>>>>                    Set Label_Justification_Mode to jMode_Right
43561>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
43562>>>>>                End_Object    // Gplan_Gplan_Bitmap
43563>>>>>
43563>>>>>                Object Gplan_Gplan_J_Code is a dbComboFormSub
43565>>>>>                    Entry_Item Gplan.Gplan_j_code
43566>>>>>                    Set Size to 13 126
43567>>>>>                    Set Location to 110 71
43568>>>>>                    Set Label_Col_Offset to 2
43569>>>>>                    Set Label_Justification_Mode to jMode_Right
43570>>>>>                End_Object    // Gplan_Gplan_J_Code
43571>>>>>
43571>>>>>                Object TextBoxSub23 is a TextBoxSub
43573>>>>>                    Set Label to "..:"
43574>>>>>                    Set Auto_Size_State to FALSE
43575>>>>>                    Set FontSize to 4 0
43576>>>>>                    Set Location to 10 4
43577>>>>>                    Set Size to 13 63
43578>>>>>                    Set TypeFace to "MS Sans Serif"
43579>>>>>                    Set Enabled_State to TRUE
43580>>>>>                End_Object    // TextBoxSub23
43581>>>>>
43581>>>>>                Object TextBoxSub24 is a TextBoxSub
43583>>>>>                    Set Label to " ç¬¤©:"
43584>>>>>                    Set Auto_Size_State to FALSE
43585>>>>>                    Set FontSize to 4 0
43586>>>>>                    Set Location to 23 4
43587>>>>>                    Set Size to 13 63
43588>>>>>                    Set TypeFace to "MS Sans Serif"
43589>>>>>                    Set Enabled_State to TRUE
43590>>>>>                End_Object    // TextBoxSub24
43591>>>>>
43591>>>>>                Object TextBoxSub25 is a TextBoxSub
43593>>>>>                    Set Label to "..:"
43594>>>>>                    Set Auto_Size_State to FALSE
43595>>>>>                    Set FontSize to 4 0
43596>>>>>                    Set Location to 38 4
43597>>>>>                    Set Size to 13 63
43598>>>>>                    Set TypeFace to "MS Sans Serif"
43599>>>>>                    Set Enabled_State to TRUE
43600>>>>>                End_Object    // TextBoxSub25
43601>>>>>
43601>>>>>                Object TextBoxSub26 is a TextBoxSub
43603>>>>>                    Set Label to "æ¢:"
43604>>>>>                    Set Auto_Size_State to FALSE
43605>>>>>                    Set FontSize to 4 0
43606>>>>>                    Set Location to 53 4
43607>>>>>                    Set Size to 13 63
43608>>>>>                    Set TypeFace to "MS Sans Serif"
43609>>>>>                    Set Enabled_State to TRUE
43610>>>>>                End_Object    // TextBoxSub26
43611>>>>>
43611>>>>>                Object TextBoxSub27 is a TextBoxSub
43613>>>>>                    Set Label to "T.K:"
43614>>>>>                    Set Auto_Size_State to FALSE
43615>>>>>                    Set FontSize to 4 0
43616>>>>>                    Set Location to 54 204
43617>>>>>                    Set Size to 12 19
43618>>>>>                    Set TypeFace to "MS Sans Serif"
43619>>>>>                    Set Enabled_State to TRUE
43620>>>>>                End_Object    // TextBoxSub27
43621>>>>>
43621>>>>>                Object TextBoxSub28 is a TextBoxSub
43623>>>>>                    Set Label to "¢â­à¤¦:"
43624>>>>>                    Set Auto_Size_State to FALSE
43625>>>>>                    Set FontSize to 4 0
43626>>>>>                    Set Location to 68 4
43627>>>>>                    Set Size to 13 63
43628>>>>>                    Set TypeFace to "MS Sans Serif"
43629>>>>>                    Set Enabled_State to TRUE
43630>>>>>                End_Object    // TextBoxSub28
43631>>>>>
43631>>>>>                Object TextBoxSub29 is a TextBoxSub
43633>>>>>                    Set Label to "e-mail:"
43634>>>>>                    Set Auto_Size_State to FALSE
43635>>>>>                    Set FontSize to 4 0
43636>>>>>                    Set Location to 67 204
43637>>>>>                    Set Size to 13 26
43638>>>>>                    Set TypeFace to "MS Sans Serif"
43639>>>>>                    Set Enabled_State to TRUE
43640>>>>>                End_Object    // TextBoxSub29
43641>>>>>
43641>>>>>                Object TextBoxSub30 is a TextBoxSub
43643>>>>>                    Set Label to "§ç¬¤¦ª: "
43644>>>>>                    Set Auto_Size_State to FALSE
43645>>>>>                    Set FontSize to 4 0
43646>>>>>                    Set Location to 82 4
43647>>>>>                    Set Size to 13 63
43648>>>>>                    Set TypeFace to "MS Sans Serif"
43649>>>>>                    Set Enabled_State to TRUE
43650>>>>>                End_Object    // TextBoxSub30
43651>>>>>
43651>>>>>                Object TextBoxSub31 is a TextBoxSub
43653>>>>>                    Set Label to "Bitmap:"
43654>>>>>                    Set Auto_Size_State to FALSE
43655>>>>>                    Set FontSize to 4 0
43656>>>>>                    Set Location to 95 4
43657>>>>>                    Set Size to 13 63
43658>>>>>                    Set TypeFace to "MS Sans Serif"
43659>>>>>                    Set Enabled_State to TRUE
43660>>>>>                End_Object    // TextBoxSub31
43661>>>>>
43661>>>>>                Object TextBoxSub39 is a TextBoxSub
43663>>>>>                    Set Label to "§á¢£:"
43664>>>>>                    Set Auto_Size_State to FALSE
43665>>>>>                    Set FontSize to 4 0
43666>>>>>                    Set Location to 110 4
43667>>>>>                    Set Size to 13 63
43668>>>>>                    Set TypeFace to "MS Sans Serif"
43669>>>>>                    Set Enabled_State to TRUE
43670>>>>>                End_Object    // TextBoxSub39
43671>>>>>
43671>>>>>            End_Object    // dbGroupSub4
43672>>>>>
43672>>>>>            Object dbGroupSub8 is a dbGroupSub
43674>>>>>                Set Size to 132 158
43675>>>>>                Set Location to 5 340
43676>>>>>                Object Gplan_Gplan_Myfno1 is a dbFormSub
43678>>>>>                    Entry_Item Gplan.Gplan_myfnump
43679>>>>>                    Set Size to 13 60
43680>>>>>                    Set Location to 10 69
43681>>>>>                    Set Label_Col_Offset to 2
43682>>>>>                    Set Label_Justification_Mode to jMode_Right
43683>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
43684>>>>>                End_Object    // Gplan_Gplan_Myfno1
43685>>>>>
43685>>>>>                Object Gplan_Gplan_Myfaxia1 is a dbFormSub
43687>>>>>                    Entry_Item Gplan.Gplan_myfvalp
43688>>>>>                    Set Size to 13 85
43689>>>>>                    Set Location to 24 69
43690>>>>>                    Set Label_Col_Offset to 2
43691>>>>>                    Set Label_Justification_Mode to jMode_Right
43692>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
43693>>>>>
43693>>>>>                    //AB-StoreStart
43693>>>>>                    set points item 0 to 2
43694>>>>>                    Set Numeric_Mask item 0 to 14 2 " ,*"
43695>>>>>                    //AB-StoreEnd
43695>>>>>
43695>>>>>                End_Object    // Gplan_Gplan_Myfaxia1
43696>>>>>
43696>>>>>                Object Gplan_Gplan_Myf2 is a dbFormSub
43698>>>>>                    Entry_Item Gplan.Gplan_myfnuma
43699>>>>>                    Set Label to "Gplan Myf2:"
43700>>>>>                    Set Size to 13 60
43701>>>>>                    Set Location to 57 69
43702>>>>>                    Set Label_Col_Offset to 2
43703>>>>>                    Set Label_Justification_Mode to jMode_Right
43704>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
43705>>>>>                End_Object    // Gplan_Gplan_Myf2
43706>>>>>
43706>>>>>                Object Gplan_Gplan_Myfaxia2 is a dbFormSub
43708>>>>>                    Entry_Item Gplan.Gplan_myfvala
43709>>>>>                    Set Size to 13 85
43710>>>>>                    Set Location to 71 69
43711>>>>>                    Set Label_Col_Offset to 2
43712>>>>>                    Set Label_Justification_Mode to jMode_Right
43713>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
43714>>>>>
43714>>>>>                    //AB-StoreStart
43714>>>>>                    set points item 0 to 2
43715>>>>>                    Set Numeric_Mask item 0 to 14 2 " ,*"
43716>>>>>                    //AB-StoreEnd
43716>>>>>
43716>>>>>                End_Object    // Gplan_Gplan_Myfaxia2
43717>>>>>
43717>>>>>                Object TextBoxSub35 is a TextBoxSub
43719>>>>>                    Set Label to "¨ £æª  £/åà¤:"
43720>>>>>                    Set Auto_Size_State to FALSE
43721>>>>>                    Set FontSize to 4 0
43722>>>>>                    Set Location to 10 6
43723>>>>>                    Set Size to 13 60
43724>>>>>                    Set TypeFace to "MS Sans Serif"
43725>>>>>                    Set Enabled_State to TRUE
43726>>>>>                End_Object    // TextBoxSub35
43727>>>>>
43727>>>>>                Object TextBoxSub36 is a TextBoxSub
43729>>>>>                    Set Label to "¥å  £/åà¤:"
43730>>>>>                    Set Auto_Size_State to FALSE
ERROR: 52 Bad format of expression (operator)  ON LINE: 924 (43730) OF FILE: C:\Vdf6\Develop\Empor\AppSrc\GPLAN.VW
ERROR: 4121 Operation aborted  ON LINE: 924 (43730) OF FILE: C:\Vdf6\Develop\Empor\AppSrc\GPLAN.VW
Summary
Memory Available: 2147483647
Total Errors   : 13
Total Symbols  : 23901
Total Resources: 0
Total Commands : 43729
Total Windows  : 28
Total Pages    : 4
Static Data    : 315975
Message area   : 222740
Total Blocks   : 14403
13 ERRORS HAVE BEEN FOUND.
