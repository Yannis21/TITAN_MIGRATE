Compiling Program: L:\VDF6\Develop\Empor\AppSrc\#fixtim.src
Memory Available: 2147483647
1>Use AllEntSc
Using pre-compiled package ALLENTSC
INCLUDING FILE: ALLENTSC.PKI
30333>
30333>Register_Object Client_Area
30333>
30333>//AB-StoreTopStart
30333>Use Workspc.pkg
30333>
30333>//  Set date attributes as needed
30333>Set_Date_Attribute sysdate4_State to (TRUE)
30334>Set_Date_Attribute Date4_State    to (TRUE)
30335>Set_Date_Attribute epoch_value    to 30
30336>
30336>Object ProgramWorkspace is a WorkspaceSub
30338>    Set WorkspaceName to CURRENT$WORKSPACE
30339>    Set kEnter_Next_State to True
30340>//    Set ModuleName    to 'ProgramName' // Special module name.
30340>//    Set HelpName      to 'HelpName.hlp'// Please provide the name of your Windows help file.
30340>End_Object
30341>
30341>Use Help_Ids.inc // Developer should provide this file of help context links.
INCLUDING FILE: HELP_IDS.INC
30341>>>// Help_ids.inc
30341>>>//
30341>>>// Context ids for the order entry system. This uses
30341>>>// help file ordentry.hlp.
30341>>>//
30341>>>// This is a sample version. YOU must supply
30341>>>// the ID values
30341>>>
30341>>>//  Generic Context Ids
30341>>>//
30341>>>
30341>>>// It is expected that file-names ids will be the same as their
30341>>>// filenumber.
30341>>>
30341>>>
30341>>>//  View and selection-list specific context ids
30341>>>//
30341>>>//..........add view, object, selection-list ids here....
30341>Use Std_Help.pkg
INCLUDING FILE: STD_HELP.PKG
30341>>>// STD_HELP.PKG
30341>>>//
30341>>>// Global Help Object
30341>>>//
30341>>>//  Creates all Help Support required to access WINDOWs help system
30341>>>//  with DataFlex. Creates a global object named Help_Object.
30341>>>//
30341>>>//  9/19/97 JJT - Modified to define stadnard help Ids if they are undefined
30341>>>
30341>>>use DFHlpSys // Context Sensitive Help Support
30341>>>
30341>>>
30341>>>// This file needs to be provided by the developer. It will contain
30341>>>// symbolic replacements for the ID integer values used to access the
30341>>>// the windows help file's topics.
30341>>>//
30341>>>use Help_ids.inc
30341>>>
30341>>>// If the following are not defined in help_ids.inc,
30341>>>//  create default 0 values for them
30341>>>Define GeneralHelpId    for    0
30341>>>Define KeysHelpId       for    0
30341>>>Define FileHelpId       for    0
30341>>>Define ErrorHelpId      for    0  // probably not used in VDF
30341>>>Define IndexHelpId      for    0  // probably not used in VDF
30341>>>
30341>>>object Help_Object is a HelpSystem // global help object
30343>>>
30343>>>   Set Help_Id_General to GeneralHelpId    // these should all be defined
30344>>>   Set Help_Id_Index   to IndexHelpId      // in help_ids.inc.
30345>>>   Set Help_Id_Keys    to KeysHelpId       //
30346>>>   Set Help_Id_Files   to FileHelpId       //
30347>>>   Set Help_Id_Errors  to ErrorHelpId      //
30348>>>
30348>>>end_object
30349>
30349>Use WinQlSQL.Sub
INCLUDING FILE: WINQLSQL.SUB
30349>>>Use CrystalReport.pkg
30349>>>
30349>>>Define PE_SUBREPORT_NAME_LEN       for 128
30349>>>
30349>>>Type PESubreportInfo
30349>>>  Field PESubreportInfo.structSize as Word
30349>>>  Field PESubreportInfo.name       as Char PE_SUBREPORT_NAME_LEN
30349>>>  Field PESubreportInfo.NLinks     as Short
30349>>>  Field PESubreportInfo.IsOnDemand as Short
30349>>>End_Type // PESubreportInfo
30349>>>
30349>>>
30349>>>External_Function PEGetNSections "PEGetNSections" CRPE32.DLL ;  Integer printJob ;  Returns Integer
30350>>>
30350>>>External_Function PEGetSectionCode "PEGetSectionCode" CRPE32.DLL ;  Integer printJob ;  Integer sectionN ;  Returns Integer
30351>>>
30351>>>External_Function PECloseSubreport "PECloseSubreport" CRPE32.DLL ;  Integer printJob ;  Returns Integer
30352>>>
30352>>>External_Function PEGetNSubreportsInSection "PEGetNSubreportsInSection" CRPE32.DLL ;  Integer printJob ;  Integer sectionCode ;  Returns Integer
30353>>>
30353>>>External_Function PEGetNthSubreportInSection "PEGetNthSubreportInSection" CRPE32.DLL ;  Integer printJob ;  Integer sectionCode ;  Integer subreportN ;  Returns Integer
30354>>>
30354>>>External_Function PEGetSubreportInfo "PEGetSubreportInfo" CRPE32.DLL ;  Integer printJob ;  Integer subreportHandle ;  Pointer subreportInfo ;  Returns Integer
30355>>>
30355>>>External_Function PEOpenSubreport "PEOpenSubreport" CRPE32.DLL ;  Integer parentJob ;  Pointer subreportName ;  Returns Integer
30356>>>
30356>>>
30356>>>Type PEWindowOptions
30356>>>  Field PEWindowOptions.StructSize As Word
30356>>>  Field PEWindowOptions.hasGroupTree As Word
30356>>>  Field PEWindowOptions.canDrillDown As Word
30356>>>  Field PEWindowOptions.hasNavigationControls As Word
30356>>>  Field PEWindowOptions.hasCancelButton As Word
30356>>>  Field PEWindowOptions.hasPrintButton As Word
30356>>>  Field PEWindowOptions.hasExportButton As Word
30356>>>  Field PEWindowOptions.hasZoomControl As Word
30356>>>  Field PEWindowOptions.hasCloseButton As Word
30356>>>  Field PEWindowOptions.hasProgressControls As Word
30356>>>  Field PEWindowOptions.hasSearchButton As Word
30356>>>  Field PEWindowOptions.hasPrintSetupButton As Word
30356>>>  Field PEWindowOptions.hasRefreshButton As Word
30356>>>End_Type // PEWindowOptions
30356>>>
30356>>>External_Function32 PESetWindowOptions "PESetWindowOptions" CRPE32.DLL ;  Integer printJob pointer Options Returns Integer
30357>>>
30357>>>Class CrystalReportSubSQL Is A CrystalReport
30358>>>
30358>>>    Procedure Construct_Object
30359>>>        Forward send Construct_Object
30361>>>        // Everything on except hasGroupTree by default
30361>>>        property integer hasGroupTree 0
30362>>>        property integer canDrillDown 1
30363>>>        property integer hasNavigationControls 1
30364>>>        property integer hasCancelButton 1
30365>>>        property integer hasPrintButton 1
30366>>>        property integer hasExportButton 1
30367>>>        property integer hasZoomControl 1
30368>>>        property integer hasCloseButton 1
30369>>>        property integer hasProgressControls 1
30370>>>        property integer hasSearchButton 1
30371>>>        property integer hasPrintSetupButton 1
30372>>>        property integer hasRefreshButton 1
30373>>>
30373>>>        Set WindowStyle To (WS_MAXIMIZE iOr WS_OVERLAPPEDWINDOW)
30374>>>    End_Procedure // Construct_Object
30375>>>
30375>>>    Procedure OutputToWindow String sTitle Integer iLeft Integer iTop Integer iWidth Integer iHeight Integer iStyle Handle hParent
30376>>>        Integer iPrintJob iResult
30377>>>        String sPEWindowOptions
30377>>>        Pointer pPeWindowOptions
30377>>>
30377>>>        Get PrintJob To iPrintJob
30378>>>        FillType PEWindowOptions with 0     to sPEWindowOptions
30379>>>        put PEWindowOptions_Size            to sPEWindowOptions at PEWindowOptions.StructSize
30380>>>        put (hasGroupTree(self))            to sPEWindowOptions at PEWindowOptions.hasGroupTree
30381>>>        put (canDrillDown(self))            to sPEWindowOptions at PEWindowOptions.canDrillDown
30382>>>        put (hasNavigationControls(self))   to sPEWindowOptions at PEWindowOptions.hasNavigationControls
30383>>>        put (hasCancelButton(self))         to sPEWindowOptions at PEWindowOptions.hasCancelButton
30384>>>        put (hasPrintButton(self))          to sPEWindowOptions at PEWindowOptions.hasPrintButton
30385>>>        put (hasExportButton(self))         to sPEWindowOptions at PEWindowOptions.hasExportButton
30386>>>        put (hasZoomControl(self))          to sPEWindowOptions at PEWindowOptions.hasZoomControl
30387>>>        put (hasCloseButton(self))          to sPEWindowOptions at PEWindowOptions.hasCloseButton
30388>>>        put (hasProgressControls(self))     to sPEWindowOptions at PEWindowOptions.hasProgressControls
30389>>>        put (hasSearchButton(self))         to sPEWindowOptions at PEWindowOptions.hasSearchButton
30390>>>        put (hasPrintSetupButton(self))     to sPEWindowOptions at PEWindowOptions.hasPrintSetupButton
30391>>>        put (hasRefreshButton(self))        to sPEWindowOptions at PEWindowOptions.hasrefreshButton
30392>>>        GetAddress of sPEWindowOptions      to pPEWindowOptions
30393>>>        Move (PESetWindowOptions(iPrintJob, pPEWindowOptions)) to iResult
30394>>>        Forward Send OutputToWindow sTitle iLeft iTop iWidth iHeight iStyle hParent
30396>>>    End_Procedure // OutputToWindow
30397>>>
30397>>>    Procedure Set TmpFileDir String aDir
30398>>>        String lsCurrWspc lsDir
30399>>>
30399>>>//        If (ghoWorkSpace <> 0) Begin
30399>>>//            Get WorkSpaceName of ghoWorkSpace to lsCurrWspc
30399>>>//            Insert "WorkSpaces\" in lsCurrWspc at 1
30399>>>//            Get_Profile_String lsCurrWspc aDir to lsDir
30399>>>//            Set Report_Data_Path to lsDir
30399>>>//        End
30399>>>    End_Procedure
30400>>>
30400>>>    Procedure DoWinQLReport
30401>>>        // This can be used when reports must be able to run in different data directories
30401>>>        Set TmpFileDir to "TmpFileDir"
30402>>>        Forward Send DoWinQLReport
30404>>>    End_Procedure
30405>>>
30405>>>
30405>>>  Function NSections Returns Integer
30406>>>    Integer iPrintJob iResult
30407>>>
30407>>>    Get PrintJob To iPrintJob
30408>>>    Move (PEGetNSections(iPrintJob)) To iResult
30409>>>    Move (Low(iResult)) To iResult
30410>>>    Function_Return iResult
30411>>>  End_Function // NSections
30412>>>
30412>>>  Function SectionCode Integer iSectionN Returns Integer
30413>>>    Integer iPrintJob iResult
30414>>>
30414>>>    Get PrintJob To iPrintJob
30415>>>    Move (PEGetSectionCode(iPrintJob,iSectionN)) To iResult
30416>>>    Move (Low(iResult)) To iResult
30417>>>    Function_Return iResult
30418>>>  End_Function // SectionCode
30419>>>
30419>>>  Function CloseSubreport Integer iSubreport Returns Integer
30420>>>    Integer iResult
30421>>>
30421>>>    Move (PECloseSubreport(iSubreport)) To iResult
30422>>>    Function_Return iResult
30423>>>  End_Function // CloseSubreport
30424>>>
30424>>>  Function NSubreportsInSection Integer iSectionCode Returns Integer
30425>>>    Integer iPrintJob iResult
30426>>>
30426>>>    Get PrintJob To iPrintJob
30427>>>    Move (PEGetNSubreportsInSection(iPrintJob,iSectionCode)) To iResult
30428>>>    Move (Low(iResult)) To iResult
30429>>>    Function_Return iResult
30430>>>  End_Function // nSubreportsInSection
30431>>>
30431>>>  Function NthSubreportInSection Integer iSectionCode Integer iSubreportN Returns Integer
30432>>>    Integer iPrintJob iResult
30433>>>
30433>>>    Get PrintJob To iPrintJob
30434>>>    Move (PEGetNthSubreportInSection(iPrintJob,iSectionCode,iSubreportN)) To iResult
30435>>>    Function_Return iResult
30436>>>  End_Function // NthSubreportInSection
30437>>>
30437>>>  Function SubreportName Integer iSubreportHandle Returns String
30438>>>    String sPESubreportInfo sResult
30439>>>    Pointer pPESubreportInfo
30439>>>    Integer iPrintJob iResult
30439>>>
30439>>>    ZeroType PESubreportInfo To sPESubreportInfo
30440>>>    Put PESubreportInfo_Size To sPESubreportInfo at PESubreportInfo.structSize
30441>>>    GetAddress Of sPESubreportInfo to pPESubreportInfo
30442>>>
30442>>>    Get PrintJob To iPrintJob
30443>>>    Move (PEGetsubreportInfo(iPrintJob,iSubreportHandle,pPESubreportInfo)) To iResult
30444>>>    If iResult GetBuff_String From sPESubreportInfo at PESubreportInfo.name To sResult
30447>>>    Function_Return (ToOEM(sResult))
30448>>>  End_Function // SubreportName
30449>>>
30449>>>  Function SubreportNLinks Integer iSubreportHandle Returns Integer
30450>>>    String sPESubreportInfo
30451>>>    Pointer pPESubreportInfo
30451>>>    Integer iPrintJob iResult
30451>>>
30451>>>    ZeroType PESubreportInfo To sPESubreportInfo
30452>>>    Put PESubreportInfo_Size To sPESubreportInfo at PESubreportInfo.structSize
30453>>>    GetAddress Of sPESubreportInfo to pPESubreportInfo
30454>>>
30454>>>    Get PrintJob To iPrintJob
30455>>>    Move (PEGetsubreportInfo(iPrintJob,iSubreportHandle,pPESubreportInfo)) To iResult
30456>>>    If iResult GetBuff From sPESubreportInfo at PESubreportInfo.NLinks To iResult
30459>>>    Function_Return iResult
30460>>>  End_Function // SubreportNLinks
30461>>>
30461>>>  Function SubreportIsOnDemand Integer iSubreportHandle Returns Integer
30462>>>    String sPESubreportInfo
30463>>>    Pointer pPESubreportInfo
30463>>>    Integer iPrintJob iResult
30463>>>
30463>>>    ZeroType PESubreportInfo To sPESubreportInfo
30464>>>    Put PESubreportInfo_Size To sPESubreportInfo at PESubreportInfo.structSize
30465>>>    GetAddress Of sPESubreportInfo to pPESubreportInfo
30466>>>
30466>>>    Get PrintJob To iPrintJob
30467>>>    Move (PEGetsubreportInfo(iPrintJob,iSubreportHandle,pPESubreportInfo)) To iResult
30468>>>    If iResult GetBuff From sPESubreportInfo at PESubreportInfo.IsOnDemand To iResult
30471>>>    Function_Return iResult
30472>>>  End_Function // SubreportIsOnDemand
30473>>>
30473>>>  Function OpenSubReport String sSubreport Returns Integer
30474>>>    Integer iPrintJob iResult
30475>>>    Pointer pSubreport
30475>>>
30475>>>    Get PrintJob To iPrintJob
30476>>>    GetAddress Of sSubreport To pSubreport
30477>>>    Move (PEOpenSubreport(iPrintJob,pSubreport)) To iResult
30478>>>    Move (Low(iResult)) To iResult
30479>>>    Function_Return iResult
30480>>>  End_Function // OpenSubReport
30481>>>
30481>>>  Function NTablesInSubreport Integer iSubreportHandle Returns Integer
30482>>>    Local Integer iResult
30483>>>
30483>>>    Move (PEGetNTables(iSubreportHandle)) To iResult
30484>>>    Move (Low(iResult)) To iResult
30485>>>    Function_Return iResult
30486>>>  End_Function // NTablesInSubreport
30487>>>
30487>>>  Function NthTableLocationInSubreport Integer iSubreportHandle Integer iTableN Returns String
30488>>>    Local String sPETableLocation sReturn
30489>>>    Local Pointer pPETableLocation
30489>>>    Local Integer iResult
30489>>>
30489>>>    FillType PETableLocation With 0 To sPETableLocation
30490>>>    Put PETableLocation_Size To sPETableLocation At PETableLocation.StructSize
30491>>>    GetAddress Of sPETableLocation To pPETableLocation
30492>>>    Move (PEGetNthTableLocation(iSubreportHandle,iTableN,pPETableLocation)) To iResult
30493>>>    If iResult GetBuff_String From sPETableLocation At PETableLocation.Location To sReturn
30496>>>    Function_Return (ToOEM(sReturn))
30497>>>  End_Function // NthTableLocationInSubreport
30498>>>
30498>>>  Procedure Set NthTableLocationInSubreport Integer iSubreportHandle Integer iTableN String sLocation
30499>>>    Local String sPETableLocation
30500>>>    Local Pointer pPETableLocation
30500>>>    Local Integer iResult
30500>>>
30500>>>    Move (ToANSI(sLocation+Character(0))) To sLocation
30501>>>    FillType PETableLocation With 0 To sPETableLocation
30502>>>    Put PETableLocation_Size To sPETableLocation At PETableLocation.StructSize
30503>>>    Put_String sLocation To sPETableLocation At PETableLocation.Location
30504>>>    GetAddress Of sPETableLocation To pPETableLocation
30505>>>    Move (PESetNthTableLocation(iSubreportHandle,iTableN,pPETableLocation)) To iResult
30506>>>  End_Procedure // Set NthTableLocationInSubreport
30507>>>
30507>>>
30507>>>    // This hook procedure is called after the print job has been opened.
30507>>>    Procedure OnInitializeReport
30508>>>    ////// SOS Na ginei xana OnInitializeReport ///////////
30508>>>
30508>>>        Integer iTables iMax iCount iType
30509>>>        String  sLocation sLocation2 sPath DirSep
30509>>>        String  sNewPath sNewLocation sDataPath sMyLocation
30509>>>
30509>>>        Integer lnSections lnSubreports lnTables iPrintJob iPath
30509>>>        Integer iSection iCode iSubreport iTable iNumPaths bExists
30509>>>        Handle hSubreport
30509>>>        String sTable sSubreport sTempFilePath
30509>>>        Boolean bCheckforTempfile bTemp
30509>>>
30509>>>        //Forward Send OnInitializeReport
30509>>>
30509>>>        Open Company
INCLUDING FILE: COMPANY.FD
30511>>>        Open Syscurxr
INCLUDING FILE: SYSCURXR.FD
30513>>>
30513>>>        Clear Company
30514>>>        Move SyscurXr.Company_Code to Company.Company_Code
30515>>>        Find Eq Company By Index.1
30516>>>>
30516>>>
30516>>>        If ((Found) And (Company.Company_C_CodeR='')) Procedure_Return
30519>>>        String  sActualSQL
30519>>>        String  sActualTemp
30519>>>        String  sOldSQL
30519>>>        String  sOldTemp
30519>>>        String  sServerName
30519>>>        String  sDatabaseName
30519>>>        String  sUserID
30519>>>
30519>>>        Move Company.Company_C_CodeR    to sServerName          // ODBC sto 1o pedio
30520>>>        Move Company.Company_C_CodER    to sActualSQL           // Database sto 2o pedio
30521>>>        Move Company.Company_C_CodER    to sDatabaseName        // Database sto 2o pedio
30522>>>
30522>>>        Move 'SMS'              to sOldSQL
30523>>>        Move 'C:\Dns_tmp\'      to sOldTemp
30524>>>
30524>>>
30524>>>        Move 'C:\Dns_tmp\'      to sActualTemp
30525>>>
30525>>>        Move (Trim(sActualSQL   )) to sActualSQL
30526>>>        Move (Trim(sActualTemp  )) to sActualTemp
30527>>>        Move (Trim(sOldSQL      )) to sOldSQL
30528>>>        Move (Trim(sOldTemp     )) to sOldTemp
30529>>>        Move (Trim(sServerName  )) to sServerName
30530>>>        Move (Trim(sDatabaseName)) to sDatabaseName
30531>>>        Move (Trim(sUserID      )) to sUserID
30532>>>
30532>>>        Move (Sysconf(SYSCONF_DIR_SEPARATOR)) To DirSep
30533>>>
30533>>>        Get NTables To iMax
30534>>>        Decrement iMax
30535>>>        Get Report_Data_Path                                    To sPath
30536>>>        If Not (Right(sPath,1)) Eq DirSep Move (sPath-DirSep)   To sPath
30539>>>        For iCount From 0 To iMax
30545>>>>
30545>>>            Get NthTableLocation iCount         To sLocation
30546>>>            Get Report_Base_File_Name sLocation To sLocation2
30547>>>            Get NthTableDBType           iCount to iType
30548>>>
30548>>>            // An einai type 1 topiko
30548>>>            //               2=SQL
30548>>>            If (iType=2) Begin
30550>>>                If (sLocation contains sOldSQL) Begin
30552>>>                    Move (Replace(sOldSQL,sLocation,sActualSQL))    to sLocation
30553>>>                    Set NthTableLocation iCount                     to (Trim(sLocation))
30554>>>                End
30554>>>>
30554>>>            End
30554>>>>
30554>>>            Else If (iType=1) Begin
30557>>>                If (sLocation contains sOldTemp) Begin
30559>>>                    Move (Replace(sOldTemp,sLocation,sActualTemp))  to sLocation
30560>>>                    Set NthTableLocation iCount                     to (Trim(sLocation))
30561>>>                End
30561>>>>
30561>>>            End
30561>>>>
30561>>>            Set nthTableLogOnServerName     iCount to sServerName     0
30562>>>            Set nthTableLogOnDataBaseName   iCount to sDatabaseName   0
30563>>>            Set nthTableLogOnUserID         iCount to sUserID         0 // 'sa'     0
30564>>>        Loop // For iCount From 0 To iMax
30565>>>>
30565>>>
30565>>>        // Set the location of the tables for the subreports
30565>>>        Get NSections To lnSections
30566>>>        For iSection From 0 To (lnSections-1)
30572>>>>
30572>>>            Get SectionCode iSection To iCode
30573>>>            Get NSubreportsInSection iCode To lnSubreports
30574>>>            For iSubreport From 0 To (lnSubreports-1)
30580>>>>
30580>>>                Get NthSubreportInSection iCode iSubreport To hSubreport
30581>>>                Get SubreportName hSubreport To sSubreport
30582>>>                Get OpenSubreport sSubreport To iPrintJob
30583>>>                Get NTablesInSubreport iPrintJob To lnTables
30584>>>                For iTable From 0 To (lnTables-1)
30590>>>>
30590>>>                    Get NthTableLocationInSubreport iPrintJob iTable To sTable
30591>>>                    If (sTable contains sOldSQL) Begin
30593>>>                            Move '' to sLocation
30594>>>                            Move (Replace(sOldSQL,sTable,sActualSQL)) to sLocation
30595>>>                            Set NthTableLocationInSubreport iPrintJob iTable To (Trim(sLocation))
30596>>>                            Set nthTableLogOnServerName     iTable to sServerName     0
30597>>>                            Set nthTableLogOnDataBaseName   iTable to sDatabaseName   0
30598>>>                            Set nthTableLogOnUserID         iTable to sUserID         0 // 'sa'     0
30599>>>                    End
30599>>>>
30599>>>                Loop // For iTable From 0 To nTables
30600>>>>
30600>>>            Loop // For iSubreport From 0 To nSubreports
30601>>>>
30601>>>        Loop // For iSection From 0 To (iSections-1)
30602>>>>
30602>>>
30602>>>    End_Procedure // OnInitializeReport
30603>>>
30603>>>
30603>>>    // This hook procedure is called just before a print job is closed.
30603>>>    Procedure OnDeInitializeReport
30604>>>        Forward Send OnDEInitializeReport
30606>>>    End_Procedure // OnDeInitializeReport
30607>>>
30607>>>    // This hook procedure is called just before a the print job is started.
30607>>>    Procedure OnStartPrinting
30608>>>        Forward Send OnStartPrinting
30610>>>    End_Procedure // OnStartPrinting
30611>>>
30611>>>    // This hook procedure is called just after a print job has finished.
30611>>>    Procedure OnStopPrinting
30612>>>        Forward Send OnStopPrinting
30614>>>    End_Procedure // OnStopPrinting
30615>>>End_Class // CrystalReportSubSQL
30616>>>
30616>Integer giWait_Obj
30616>
30616>// General Functions-Procedures and Variables
30616>Use Globals.Inc
INCLUDING FILE: GLOBALS.INC
30616>>>
30616>>>        String  gs_Selected_Company_Code
30616>>>        String  gs_Selected_Branch_Code
30616>>>        Integer gi_Selected_Year
30616>>>        String gs_Selected_Year_Recr
30616>>>        String  gs_Module_Code
30616>>>
30616>>>
30616>>>//Open Currency
30616>>>//Function CurrDigits Global String asCurr Returns Integer
30616>>>//    Integer liDecX
30616>>>//    Clear Currency
30616>>>//    move asCurr to Currency.Currency_C_Code
30616>>>//    Find Eq Currency By Index.1
30616>>>//    move Currency.Currency_Dec to liDecX
30616>>>//    Function_Return liDecX
30616>>>//End_Function // CurrDigits
30616>>>
30616>>>Open Nomisma
INCLUDING FILE: NOMISMA.FD
30618>>>Open SysCurXr
30620>>>
30620>>>Function fiDekadika_Nomismatos Global String asNomisma Returns Integer
30621>>>    Move (Trim(asNomisma)) to asNomisma
30622>>>    Clear Nomisma
30623>>>    If ( asNomisma<>'' ) Move asNomisma         to Nomisma.Nomisma_Code
30626>>>    Else                 Move SysCurXr.C_Code0  to Nomisma.Nomisma_Code
30628>>>    Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
30629>>>>
30629>>>    Function_Return Nomisma.Dekadika
30630>>>End_Function //
30631>>>
30631>>>Function fsgCode_W_Zeroes Global Integer aiCode Integer aiPlaces Returns String
30632>>>    String rVal
30633>>>    Integer iLength iInt
30633>>>    Move aiCode to rVal
30634>>>    Move (trim(rVal)) to rVal
30635>>>    For iInt From 1 to (aiPlaces-(Length(rVal)))
30641>>>>
30641>>>        Move (Insert('0',rVal,1)) to rVal
30642>>>    Loop
30643>>>>
30643>>>    Function_Return rVal
30644>>>End_Function
30645>>>
30645>>>Function fsgCode_n_Zeroes Global number aiCode Integer aiPlaces Returns String
30646>>>    String rVal
30647>>>    Integer iLength iInt ipos
30647>>>    Move aiCode to rVal
30648>>>    Move (trim(rVal)) to rVal
30649>>>    MOVE (aiPlaces-(Length(rVal))) to ipos
30650>>>    For iInt From 1 to ipos
30656>>>>
30656>>>        Move (Insert('0',rVal,1)) to rVal
30657>>>    Loop
30658>>>>
30658>>>    Function_Return rVal
30659>>>End_Function
30660>>>
30660>>>
30660>>>Open Year
INCLUDING FILE: YEAR.FD
30662>>>Procedure EnumDDsForRebuildConstrain for DataDictionary integer aiMsg integer ahId
30663>>>    Send aiMsg to Self
30664>>>End_Procedure
30665>>>
30665>>>Procedure DoRefindYear for baseclass Integer aiPanel Integer aiYearDD
30666>>>    Integer liChanged
30667>>>
30667>>>    If ((aiYearDD = 0) or (Main_File(aiYearDD)<>Year.File_Number)) ;        Procedure_Return (Message_Box("Invalid Year_DD","Developer's Warning",MB_OK,MB_ICONWARNING))
30670>>>    If (Not(Current_Record(aiYearDD))) Begin
30672>>>        Get Should_Save of aiPanel to liChanged
30673>>>        Send Clear to aiYearDD
30674>>>        Move gs_Selected_Company_Code to Year.Company_Code
30675>>>        Move gs_Selected_Branch_Code  to Year.Branch_Code
30676>>>        Move gi_Selected_Year         to Year.Year_Year
30677>>>        Send Find to aiYearDD Eq 1 //Year.Index.1 - company_code+ranch_code+year_year
30678>>>        If (Not(liChanged)) Set Changed_State of aiPanel to False
30681>>>    End
30681>>>>
30681>>>End_Procedure
30682>>>
30682>>>Procedure RebuildConstrainIfYearChanged for baseclass Integer aiPanel String asCurrentYearRecr Integer aiYearDDId
30683>>>    Integer liSrvr
30684>>>    String  lsCurrentYearRecr
30684>>>
30684>>>    If (asCurrentYearRecr <> gs_Selected_Year_Recr) Begin
30686>>>        Broadcast Send EnumDDsForRebuildConstrain to aiPanel msg_Rebuild_Constraints Self
30688>>>    End
30688>>>>
30688>>>    Send DoRefindYear aiPanel aiYearDDId //(Year_DD(Self))
30689>>>    Get Server of aiPanel to liSrvr
30690>>>    // Respects Default values
30690>>>    If (liSrvr) If (Not(Current_Record(liSrvr))) Send Request_Clear to aiPanel
30695>>>End_Procedure
30696>>>
30696>>>//                                       ’¦ View            Property «¦¬ View             ’¦ Year DDO «¦¬ View
30696>>>//                                                          Holds the current year rec0
30696>>>// ‰¢ã©ž : Send RbldConstrIfYearChanged (Gplan_Test(Self))  (psCurrentYearRecr(Self))     (Year_DD(Self))
30696>>>
30696>>>
30696>>>Function fiRefindYear Global Returns Integer
30697>>>    Clear Year
30698>>>    Move gs_Selected_Company_Code to Year.Company_Code
30699>>>    Move gs_Selected_Branch_Code  to Year.Branch_Code
30700>>>    Move gi_Selected_Year         to Year.Year_Year
30701>>>    Find eq Year by Index.1 //company_code+ranch_code+year_year
30702>>>>
30702>>>    Function_Return (Found = 0)
30703>>>End_Function //fiRefindYear
30704>>>
30704>>>Procedure DoRunApplication for Baseclass String sAppName
30705>>>    string sRuntime  lsStr
30706>>>
30706>>>    Append lsStr 'C:\Dns.bat ' sAppName
30708>>>    RunProgram Wait  lsStr
30709>>>
30709>>>//    get_profile_string "defaults" "VDFBinDir" to sRuntime
30709>>>//    append sRuntime "\dfrun " sAppName
30709>>>    Append sRuntime 'C:\Program Files\Accessories\WORDPAD.EXE ' sAppName
30711>>>    runprogram background sRuntime
30712>>>End_procedure // DoRunApplication
30713>>>
30713>>>// Run the Editor
30713>>>Procedure DoRunEditor for Baseclass String asFile
30714>>>    string sRunPath lsWspcName
30715>>>    Move (WorkspaceName(ProgramWorkspace(Self))) to lsWspcName
30716>>>    get_profile_string ("workspaces\"+lsWspcName) "programpath" to sRunPath
30719>>>    //append sRunPath "\Editor "  asFile //// js 15/03/2002 " " lsWspcName
30719>>>    Move (Replace('.',asFile,'')) to asFile
30720>>>    append sRunPath asFile //// js 15/03/2002 " " lsWspcName
30721>>>    send DoRunApplication sRunPath
30722>>>End_Procedure // DoRunEditor
30723>>>
30723>>>//--------------------------------------
30723>>>
30723>>>//start of global functions and procedures
30723>>>
30723>>>
30723>>>//®¨ž© £¦§¦ œå«˜  ˜§æ: ˜) gmoves.dd    :private.update_gmhnes_ghmnies
30723>>>Function gsfFind_Previous Global String lsCode;                                 String lsDelimiter;                                 Returns String
30724>>>         String  lsTemp_Code1 lsTemp_Code2
30725>>>         Integer liCounter
30725>>>
30725>>>         //1.˜­˜å¨œ©ž ¡œ¤é¤
30725>>>         Move (Trim(lsCode)) to lsCode                                  //§® 30.12.345
30726>>>
30726>>>         //2.˜¤« ©«¨¦­ã
30726>>>         For liCounter From 1 to (Length(lsCode))
30732>>>>
30732>>>             Move (Insert(;                           (Mid(lsCode,1,liCounter)),;                           lsTemp_Code1,;                           1;                         )) to lsTemp_Code1                             //§® 543.21.03
30733>>>         Loop
30734>>>>
30734>>>
30734>>>         //3.˜­˜å¨œ©ž ¡œ¤é¤ (›â¤ ®¨œ áœ«˜ , safety only)
30734>>>         Move (Trim(lsTemp_Code1)) to lsTemp_Code1
30735>>>
30735>>>         //4.§˜å¨¤à £æ¤¦ «¦ ›œ¥ æ £â¨¦ª «¦¬ ˜¤«å©«¨¦­¦¬, £œ«á «¦ §¨é«¦ delimiter
30735>>>         Move (Right(;                      lsTemp_Code1,;                      ((Length(lsTemp_Code1))-((Pos(lsDelimiter,lsTemp_Code1))));                    )) to lsTemp_Code1                                  // §® 21.03
30736>>>
30736>>>         //5.¥˜¤á ˜¤« ©«¨¦­ã «¦¬ ˜¤«å©«¨¦­¦¬
30736>>>         For liCounter from 1 to (Length(lsTemp_Code1))
30742>>>>
30742>>>             Move (Insert(;                           (Mid(lsTemp_Code1,1,liCounter)),;                           lsTemp_Code2,;                           1;                         )) to lsTemp_Code2                             //§® 30.12
30743>>>         Loop
30744>>>>
30744>>>
30744>>>         Function_Return (Trim(lsTemp_Code2))
30745>>>End_Function //gsffind_previous
30746>>>
30746>>>
30746>>>Function gifSystem_Check Returns Integer
30747>>>         Integer liF_Gtypkins liF_Garicls liF_Gmoves liF_Gplans liF_Gmhnes liF_Ghmnies
30748>>>         Integer liS_Gtypkins liS_Garicls liS_Gmoves liS_Gplans liS_Gmhnes liS_Ghmnies
30748>>>//       Clear Company
30748>>>//       Find Gt Company.Recnum
30748>>>//       While (Found = 1)
30748>>>//             Add Company.Company_NumGtypkin to liS_Gtypkins § Ÿ˜¤é© ©«¦ sysfile ¤˜ «˜ ¡˜¨˜«áà ˜¬«á
30748>>>//             Add Company.Company_NumGarticl to liS_Garticls
30748>>>//             Add Company.Company_NumGmoves  to liS_Gmoves
30748>>>//             //d Company.Company_NumGtypkin to liS_Gtypkins
30748>>>//             Add Company.Company_NumGplan   to liS_GPlans
30748>>>//             Add Company.Company_NumGmhnes  to liS_Gmhnes
30748>>>//             Add Company.Company_NumGhmnies to liS_Ghmnies
30748>>>//             Find Gt Company.Recnum
30748>>>//       Loop
30748>>>//
30748>>>//       Get_Attribute {attribute} [of {file-handle} ;
30748>>>//                        [{field-num} | {index-num} [{segment-num}]]] ;
30748>>>//                        To {variable}
30748>>>//
30748>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30748>>>//       Get_Attribute DF_FILE_RECORDS_USED of Garticl.File_Number to liF_Garticls
30748>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmoves.File_Number  to liF_Gmoves
30748>>>//       //t_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30748>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gplan.File_Number   to liF_Gplans
30748>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmhnes.File_Number  to liF_Gmhnes
30748>>>//       Get_Attribute DF_FILE_RECORDS_USED of Ghmnies.File_Number to liF_Ghmnies
30748>>>//
30748>>>
30748>>>//       //â¢œš®¦ª DF_FILE_MAX_RECORDS+ £œ records used
30748>>>
30748>>>//       //â¢œš®¦ª last rec0 = sysrec rec0
30748>>>
30748>>>    Function_Return 0
30749>>>End_Function //gifSystem_Check
30750>>>
30750>>>/////////////////////////////////////////////////////////////////
30750>>>//‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª, £œ ž ®à¨åª ›œ¡˜› ¡á  JS
30750>>>Function Sfi_All_Numbers Global Number anValue Integer aiLengthAkeraios Integer aiLengthDekadika Returns String
30751>>>
30751>>>    String  lsRetval lsValue lsAkeraios lsDekadika
30752>>>    Integer liInt liInteger iTimes iStart
30752>>>    Number  lnDecimals
30752>>>
30752>>>    Move (Integer(anValue))                                         to liInteger
30753>>>    Move (Round(AnValue-(Integer(anValue))*(10^aiLengthDekadika)))  to lnDecimals
30754>>>
30754>>>    Move liInteger              to lsAkeraios
30755>>>    Move lnDecimals             to lsDekadika
30756>>>    Move (Trim(lsAkeraios))     to lsAkeraios
30757>>>    Move (Trim(lsDekadika))     to lsDekadika
30758>>>
30758>>>    Move (Length(lsAkeraios)) to iStart
30759>>>    For iTimes From iStart to (aiLengthAkeraios-1)
30765>>>>
30765>>>        Insert "0" in lsAkeraios at 1
30767>>>    Loop
30768>>>>
30768>>>    Move (Trim(lsAkeraios)) to lsAkeraios
30769>>>
30769>>>    Move (Length(lsDekadika)) to iStart
30770>>>    For iTimes From iStart to (aiLengthDekadika-1)
30776>>>>
30776>>>        Move (Append(lsDekadika,"0")) to lsDekadika
30777>>>    Loop
30778>>>>
30778>>>    Move (Trim(lsDekadika)) to lsDekadika
30779>>>
30779>>>    If (aiLengthDekadika=0) Move '' to lsDekadika
30782>>>    Move '' to lsRetVal
30783>>>    Move (Pad((lsAkeraios-lsDekadika),(aiLengthAkeraios+aiLengthDekadika))) to lsRetval
30784>>>    Function_Return lsRetval
30785>>>End_Function //sfi_All_Numbers  ‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª
30786>>>              //                 £œ ž ®à¨åª ›œ¡˜› ¡á (JS)
30786>>>
30786>>>Open Codemast
30788>>>
30788>>>
30788>>>Function gsfCode_Mast Global String lsType String lsValue Returns String
30789>>>         Clear Codemast
30790>>>         Move lsType  to Codemast.Type
30791>>>         Move lsValue to Codemast.Code
30792>>>         Find Eq Codemast by Index.1 //type+code
30793>>>>
30793>>>         Function_Return Codemast.Description
30794>>>End_Function //code_mast
30795>>>
30795>>>
30795>>>Open Branch
INCLUDING FILE: BRANCH.FD
30797>>>Function fsgCode_With_Zeroes Global Integer aiCode    ;                                    Integer aiPlaces  ;                                    String asCompany  ;                                    String asBranch   ;                               Returns String
30798>>>    String rVal
30799>>>    Integer iInt
30799>>>    Clear Branch
30800>>>    Move asCompany  to Branch.Company_Code
30801>>>    Move asBranch   to Branch.Branch_Code
30802>>>    Find Eq Branch by Index.1
30803>>>>
30803>>>    If (Trim(Branch.Tomeas_Code)<>'') Move (Trim(Branch.Tomeas_Code)) to asBranch
30806>>>    Move (Trim(asCompany))  to asCompany
30807>>>    Move (Trim(asBranch))   to asBranch
30808>>>    If (Length(asCompany)=1) Insert '0' In asCompany At 1
30812>>>    If (Length(asBranch) =1) Insert '0' In asBranch  At 1
30816>>>    Move ''                                           to rVal
30817>>>    Move (Sfi_All_Numbers(aiCode,aiPlaces,0))         to rVal
30818>>>    Move (Append((asCompany+'.'+asBranch+'.'),rVal))  to rVal
30819>>>    Move (Trim(rVal))                                 to rVal
30820>>>    Function_Return rVal
30821>>>End_Function
30822>>>
30822>>>Function fsgStripCodeFromID Global String asID Returns Integer
30823>>>      Integer iLen iPos iInt
30824>>>      If (Trim(asID)='') Function_Return 0
30827>>>      Move (Trim  (asID)) to asID
30828>>>      Move (Length(asID)) to iLen
30829>>>      For iInt From 1     to iLen
30835>>>>
30835>>>          If (Mid(asID,1,iInt)='.') Move iInt to iPos
30838>>>      Loop
30839>>>>
30839>>>      Function_Return (Right(asID,(iLen-iPos)))
30840>>>End_Function
30841>>>
30841>>>Function fsCityDescr Global Integer aiCityID Returns String
30842>>>    String rVal
30843>>>    Open Cities
INCLUDING FILE: CITIES.FD
30845>>>    Clear Cities
30846>>>    Move aiCityID to Cities.City_ID
30847>>>    Find Eq Cities By Index.1
30848>>>>
30848>>>    If (Found=1) Move Cities.City_descr to rVal
30851>>>    Else         Move '' to rVal
30853>>>    Function_Return rVal
30854>>>End_Function
30855>>>
30855>>>Function fiTownIDFromCity Global Integer aiCityID Returns Integer
30856>>>    Open Cities
30858>>>    Clear Cities
30859>>>    Move aiCityID to Cities.City_ID
30860>>>    Find Eq Cities By Index.1
30861>>>>
30861>>>    Function_Return Cities.Town_ID
30862>>>End_Function
30863>>>
30863>>>Function fiCountryIDFromTown Global Integer aiTownID Returns Integer
30864>>>    Open Towns
INCLUDING FILE: TOWNS.FD
30866>>>    Clear Towns
30867>>>    Move aiTownID to Towns.Town_ID
30868>>>    Find Eq Towns By Index.1
30869>>>>
30869>>>    Function_Return Towns.Country_ID
30870>>>End_Function
30871>>>
30871>>>Function fsTownDescr Global Integer aiTownID Returns String
30872>>>    String rVal
30873>>>    Open Towns
30875>>>    Clear Towns
30876>>>    Move aiTownID to Towns.Town_ID
30877>>>    Find Eq Towns By Index.1
30878>>>>
30878>>>    If (Found=1) Move Towns.Town_descr to rVal
30881>>>    Else         Move '' to rVal
30883>>>    Function_Return rVal
30884>>>End_Function
30885>>>
30885>>>Function fsCountryDescr Global Integer aiCountryID Returns String
30886>>>    String rVal
30887>>>    Open Country
INCLUDING FILE: COUNTRY.FD
30889>>>    Clear Country
30890>>>    Move aiCountryID to Country.Country_ID
30891>>>    Find Eq Country By Index.1
30892>>>>
30892>>>    If (Found=1) Move Country.Country_descr to rVal
30895>>>    Else         Move '' to rVal
30897>>>    Function_Return rVal
30898>>>End_Function
30899>>>
30899>>>Function fsAreaDescr Global Integer aiAreaID Returns String
30900>>>    String rVal
30901>>>    Open Areas
INCLUDING FILE: AREAS.FD
30903>>>    Clear Areas
30904>>>    Move aiAreaID to Areas.Area_ID
30905>>>    Find Eq Areas By Index.1
30906>>>>
30906>>>    If (Found=1) Move Areas.Area_descr to rVal
30909>>>    Else         Move '' to rVal
30911>>>    Function_Return rVal
30912>>>End_Function
30913>>>
30913>>>Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
30914>>>    Local String rVal lsTmp lsOO lsLL
30915>>>    Local Number lnOO lnLL
30915>>>
30915>>>    Move '' to lsOO
30916>>>    Move '' to lsLL
30917>>>    Move '' to rVal
30918>>>
30918>>>    Move (Integer(anTime))                              to lnOO
30919>>>
30919>>>    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
30920>>>
30920>>>    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
30923>>>    Else         Move (String(lnOO))                    to lsOO
30925>>>    Move (Trim(lsOO))                                   to lsOO
30926>>>
30926>>>    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
30929>>>    Else         Move (String(lnLL))                    to lsLL
30931>>>    Move (Trim(lsLL))                                   to lsLL
30932>>>
30932>>>    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
30933>>>
30933>>>    Move (Trim(rVal)) to rVal
30934>>>
30934>>>    Function_Return rVal
30935>>>End_Function
30936>>>
30936>>>Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
30937>>>    Local Number rVal nOres nLepta
30938>>>    Move (Integer(aiMinutes/60))    to nOres
30939>>>    Move (    Mod(aiMinutes,60))    to nLepta
30940>>>    Move (nOres+(nLepta/100))       to rVal
30941>>>    Function_Return rVal
30942>>>End_Function
30943>>>
30943>>>Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
30944>>>    Local Integer rVal
30945>>>    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
30946>>>    Function_Return rVal
30947>>>End_Function
30948>>>
30948>>>Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;                                                                    Number anEndTime    ;                                                                    Returns Integer
30949>>>    Local Integer rVal iMinStart iMinEnd
30950>>>
30950>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30953>>>
30953>>>    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
30954>>>    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
30955>>>    Move (iMinEnd-iMinStart)                                                     to rVal
30956>>>    Function_Return rVal
30957>>>End_Function
30958>>>
30958>>>
30958>>>Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;                                                                Number anEndTime    ;                                                                Returns Number
30959>>>    Local Integer iTmp
30960>>>    Local Number  rVal
30960>>>
30960>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30963>>>
30963>>>    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
30964>>>    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
30965>>>    Function_Return rVal
30966>>>End_Function
30967>>>
30967>>>
30967>>>Open WitemCL
INCLUDING FILE: WITEMCL.FD
30969>>>Open WitemCld
INCLUDING FILE: WITEMCLD.FD
30971>>>Open WitemxT
INCLUDING FILE: WITEMXT.FD
30973>>>
30973>>>Function fnTeleytaiaTimhAgoras String asPromCode String asItemCode  ;                               Date   adHmnia    Number anQty       ;                               Returns Number
30974>>>  Integer iExodos
30975>>>  Number nPoso nPct
30975>>>  Move 0 to nPoso
30976>>>  Move 0 to nPct
30977>>>  Move 0 to iExodos
30978>>>
30978>>>  Move (Trim(asItemCode)) to asItemCode
30979>>>  Move (Trim(asPromCode)) to asPromCode
30980>>>
30980>>>  // 1.Anazhthsh sto arxeio Witemcld
30980>>>  Clear Witemcld
30981>>>  Move asItemCode to Witemcld.Item_Code
30982>>>  Move asPromCode to Witemcld.Client_Code
30983>>>  Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30984>>>>
30984>>>  While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;                       (Witemcld.Client_Code= asPromCode) And ;                       (iExodos=0))
30988>>>      If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30990>>>          Move 1 to iExodos
30991>>>               If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30994>>>          Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30998>>>      End
30998>>>>
30998>>>      Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30999>>>>
30999>>>  Loop
31000>>>>
31000>>>  If (iExodos) Begin
31002>>>      If (nPoso) Function_Return nPoso
31005>>>      Else Function_Return nPct
31007>>>  End
31007>>>>
31007>>>
31007>>>  // 2.Anazhthsh sto arxeio Witemcl
31007>>>  Clear WitemCL
31008>>>  Move (Trim(asPromCode)) to WitemCL.Client_Code
31009>>>  Move (Trim(asItemCode)) to WitemCL.Item_Code
31010>>>  Find Eq WitemCL By Index.1
31011>>>>
31011>>>  If (Found=1) Function_Return WitemCL.Client_Price
31014>>>
31014>>>  Function_Return 0
31015>>>End_Function
31016>>>
31016>>>
31016>>>Open BtnOrdd
INCLUDING FILE: BTNORDD.FD
31018>>>
31018>>>Function fnTeleytaiaTimhPolhshs String asWitemxRecr String asClientID ;                                String asWitemxCode Date   adHmnia    ;                                String asItemCode   Number anQty      ;                                String asCNCode     Returns Number
31019>>>
31019>>>  Integer iExodos iCheckDeop
31020>>>  Number nPoso nPct
31020>>>
31020>>>  Move (Num_Arguments=7) to iCheckDeop
31021>>>
31021>>>  Move 0 to nPoso
31022>>>  Move 0 to nPct
31023>>>  Move 0 to iExodos
31024>>>
31024>>>  Move (Trim(asItemCode))                 to asItemCode
31025>>>  Move (Trim(asClientID))                 to asClientID
31026>>>  Move (Trim(asWitemxRecr))               to asWitemxRecr
31027>>>  Move (Trim(asWitemxCode))               to asWitemxCode
31028>>>  If (iCheckDeop) Move (Trim(asCNCode))   to asCNCode
31031>>>
31031>>>  // 1. Anazhthsh apo DEOP ef' oson yparxei kodikos ergou
31031>>>  If (iCheckDeop) Begin
31033>>>      Clear btnordd
31034>>>      Move asClientID   to btnordd.vclient_id
31035>>>      Move asCNCode     to btnordd.vcn_code
31036>>>      Move asWitemxCode to btnordd.vitem
31037>>>      Move 0            to btnordd.vactive
31038>>>      Move adHmnia      to btnordd.arxh_date
31039>>>      Find LE btnordd by index.4//client_id+cn_code+item+arxh_date
31040>>>>
31040>>>      If ((found=1) and (asWitemxCode=btnordd.vitem)    and (adHmnia>=btnordd.arxh_date) ;                    and (adHmnia<=btnordd.deop_date)    and (btnordd.vactive=0)          ;                    and (asCNCode=btnordd.vcn_code)) begin
31042>>>          move btnordd.vprice to nPoso
31043>>>          If (nPoso) Function_Return nPoso
31046>>>      End
31046>>>>
31046>>>  End
31046>>>>
31046>>>  // 19-03-2007 Tolhs na pernei times mono an brei apo deop
31046>>>  // 2.Anazhthsh sto arxeio Witemcld (Timokatalogos Pelath/Eidous)
31046>>> // Clear Witemcld
31046>>> // Move asItemCode to Witemcld.Item_Code
31046>>> // Move asClientID to Witemcld.Client_Code
31046>>> // Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
31046>>> // While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;
31046>>> //                      (Witemcld.Client_Code= asClientID) And ;
31046>>> //                      (iExodos=0))
31046>>> //     If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
31046>>> //         Move 1 to iExodos
31046>>> //              If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
31046>>> //         Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
31046>>> //     End
31046>>> //     Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
31046>>> // Loop
31046>>> // If (iExodos) Begin
31046>>> //     If (nPoso) Function_Return nPoso
31046>>> //     Else Function_Return nPct
31046>>> // End
31046>>>
31046>>>
31046>>>  // 3.Anazhthsh sto arxeio Witemxt (Timokatalogos Eidous)
31046>>>  //Clear Witemxt
31046>>>  //Move SysCurXr.Company_Code  to Witemxt.Company_Code
31046>>>  //Move SysCurXr.Branch_Code   to Witemxt.Branch_Code
31046>>>  //Move SysCurXr.Year_Year     to Witemxt.Year_Year
31046>>>  //Move asWitemxRecr           to Witemxt.Witemx_Recr
31046>>>  //Find Gt Witemxt By Index.1 // Witemxt:Index.1
31046>>>  //While ((Found=1) And (Witemxt.Company_Code = SysCurXr.Company_Code) And ;
31046>>>  //                     (Witemxt.Branch_Code  = SysCurXr.Branch_Code ) And ;
31046>>>  //                     (Witemxt.Year_Year    = SysCurXr.Year_Year   ) And ;
31046>>>  //                     (Witemxt.Witemx_Recr  = asWitemxRecr         ) And ;
31046>>>  //                     (iExodos=0))
31046>>>  //    If ((adHmnia>=Witemxt.Value_Date) And (anQty<=Witemxt.Qty)) Begin
31046>>>  //        Move 1 to iExodos
31046>>>  //             If (Witemxt.Axia0 <>0) Move  Witemxt.Axia0         to nPoso
31046>>>  //        Else If (Witemxt.PcDisc<>0) Move (Witemxt.PcDisc*(-1))  to nPct
31046>>>  //    End
31046>>>  //    Find Gt Witemxt By Index.1 // Witemxt:Index.1
31046>>>  //Loop
31046>>>  //If (iExodos) Begin
31046>>>  //    If (nPoso) Function_Return nPoso
31046>>>  //    Else Function_Return nPct
31046>>>  //End
31046>>>
31046>>>
31046>>>  // 4.Anazhthsh sto arxeio Witemcl (Teleytaia Timh Agoras)
31046>>>  //Clear WitemCL
31046>>>  //Move (Trim(asClientID)) to WitemCL.Client_Code
31046>>>  //Move (Trim(asItemCode)) to WitemCL.Item_Code
31046>>>  //Find Eq WitemCL By Index.1
31046>>>  //If (Found=1) Function_Return WitemCL.Client_Price
31046>>>
31046>>>  Function_Return 0
31047>>>End_Function
31048>>>
31048>>>Function fsStripTextFieldFromEnter Global String asStr Returns String
31049>>>    String sEnter
31050>>>    Move '' to sEnter
31051>>>    Move (Trim(asStr)) to asStr
31052>>>    Append sEnter (Character(13)) (Character(10))
31054>>>    Move (Replaces(sEnter,asStr,' ')) to asStr
31055>>>    Function_return (Trim(asStr))
31056>>>End_function
31057>>>
31057>>>
31057>>>//end   of global functions and procedures
31057>>>Use Wait.DG
INCLUDING FILE: WAIT.DG
31057>>>>>USE AllEntSc
31057>>>>>
31057>>>>>//AB-IgnoreEnd
31057>>>>>
31057>>>>>
31057>>>>>//AB-IgnoreEnd
31057>>>>>
31057>>>>>Object Wait is a ModalPanelSub
31059>>>>>
31059>>>>>    //AB-StoreTopStart
31059>>>>>
31059>>>>>    // How to Use It
31059>>>>>    // Get the maximum position of the bar
31059>>>>>    // Move (Bar_Maximum_position(Wait(self))) to iMax
31059>>>>>    //
31059>>>>>    // Set the maximum position of the bar
31059>>>>>    // Set Bar_Maximum_position of (Wait(self)) to iMax
31059>>>>>    //
31059>>>>>    // Start Bar Progress from beginning
31059>>>>>    // Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
31059>>>>>    //
31059>>>>>    // End Bar Progress
31059>>>>>    // Send Bar_Current_Position to (Wait(Self)) iMax iMax iMax False
31059>>>>>    //
31059>>>>>    // Update Bar Progress
31059>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax True OR
31059>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax False
31059>>>>>    // When you want the update to be done for every i (this is slower)
31059>>>>>    // Where i=Counter's current value, icounter=Counter's Max Value and iMax=Bar Max Position
31059>>>>>    //
31059>>>>>    // Display Buttons on the object
31059>>>>>    // Set Button_State of (Wait(Self)) to False/True
31059>>>>>    // If the Progress Bar gets initialized without buttons, it MUST be Deactivated
31059>>>>>    //
31059>>>>>    // Initialization of the Progress Bar
31059>>>>>    // Send Popup to (Wait(Self))
31059>>>>>    //
31059>>>>>    // Deactivation of the Progress Bar
31059>>>>>    // Send Deactivate to (Wait(Self))
31059>>>>>    //
31059>>>>>    // Message during the process
31059>>>>>    // Set Wait_Message of (Wait(Self)) to "Now Processing..."
31059>>>>>    //
31059>>>>>    // Extra Info for button "Info >>"
31059>>>>>    // Send Wait_Details to (Wait(Self)) sFile sDetail bInitData
31059>>>>>    // If sFile<>'' then reads the contents of the file
31059>>>>>    // Else Fills the Edit with the string of sDetail
31059>>>>>    // If bInitData is True then the edit object is cleared first else extra info is appended
31059>>>>>    //
31059>>>>>    // Remarks instead of Progress Bar
31059>>>>>    // Set Button_State of (Wait(Self))     to False
31059>>>>>    // Set BarVisibleState of (Wait(Self))  to 'Remarks' False
31059>>>>>    // Update During Process
31059>>>>>    // Send UpdateWait to (Wait(Self)) 'Remarks'
31059>>>>>
31059>>>>>    //AB-StoreTopEnd
31059>>>>>
31059>>>>>    Set Exit_Application_Local_State to FALSE
31060>>>>>    Set Modal_State to FALSE
31061>>>>>    Set Popup_State to TRUE
31062>>>>>    Set Border_Style to Border_Thick
31063>>>>>    Set Minimize_Icon to FALSE
31064>>>>>    Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
31065>>>>>    Set Size to 138 256
31066>>>>>
31066>>>>>    //AB-DDOStart
31066>>>>>
31066>>>>>
31066>>>>>    //AB-DDOEnd
31066>>>>>
31066>>>>>    Object WaitBar is a ProgressBarSub
31068>>>>>
31068>>>>>        //AB-StoreTopStart
31068>>>>>
31068>>>>>        //AB-StoreTopEnd
31068>>>>>
31068>>>>>        Set Size to 21 243
31069>>>>>        Set Location to 7 4
31070>>>>>
31070>>>>>        //AB-StoreStart
31070>>>>>        Send DoRegSize  self smTopRight
31071>>>>>        //AB-StoreEnd
31071>>>>>
31071>>>>>    End_Object
31072>>>>>
31072>>>>>    Object WaitText is a TextBoxSub
31074>>>>>
31074>>>>>        //AB-StoreTopStart
31074>>>>>
31074>>>>>        //AB-StoreTopEnd
31074>>>>>
31074>>>>>        Set Enabled_State to TRUE
31075>>>>>        Set Label to "Processing"
31076>>>>>        Set FontSize to 4 0
31077>>>>>        Set Size to 10 81
31078>>>>>        Set Location to 36 5
31079>>>>>
31079>>>>>        //AB-StoreStart
31079>>>>>
31079>>>>>        //AB-StoreEnd
31079>>>>>
31079>>>>>    End_Object
31080>>>>>
31080>>>>>    Object bnCancel is a ButtonSub
31082>>>>>
31082>>>>>        //AB-StoreTopStart
31082>>>>>
31082>>>>>        //AB-StoreTopEnd
31082>>>>>
31082>>>>>        Set Default_State to TRUE
31083>>>>>        Set Label to "OK"
31084>>>>>        Set Location to 34 143
31085>>>>>
31085>>>>>        //AB-StoreStart
31085>>>>>
31085>>>>>        Procedure OnClick
31087>>>>>             Send Deactivate to (Wait(Self))
31088>>>>>        End_Procedure
31089>>>>>
31089>>>>>        Send DoRegAlign self amTopRight
31090>>>>>        //AB-StoreEnd
31090>>>>>
31090>>>>>    End_Object
31091>>>>>
31091>>>>>    Object bnDetail is a ButtonSub
31093>>>>>
31093>>>>>        //AB-StoreTopStart
31093>>>>>
31093>>>>>        //AB-StoreTopEnd
31093>>>>>
31093>>>>>        Set Focus_Mode to Pointer_Only
31094>>>>>        Set Label to "Info >>"
31095>>>>>        Set Location to 34 197
31096>>>>>
31096>>>>>        //AB-StoreStart
31096>>>>>
31096>>>>>        Procedure OnClick
31098>>>>>            Delegate Send Show_Details False
31100>>>>>        End_Procedure
31101>>>>>
31101>>>>>        Send DoRegAlign self amTopRight
31102>>>>>        //AB-StoreEnd
31102>>>>>
31102>>>>>    End_Object
31103>>>>>
31103>>>>>    Object LineControlSub1 is a LineControlSub
31105>>>>>
31105>>>>>        //AB-StoreTopStart
31105>>>>>
31105>>>>>        //AB-StoreTopEnd
31105>>>>>
31105>>>>>        Set Size to 2 243
31106>>>>>        Set Location to 54 4
31107>>>>>
31107>>>>>        //AB-StoreStart
31107>>>>>
31107>>>>>        Send DoRegSize  self smTopRight
31108>>>>>        //AB-StoreEnd
31108>>>>>
31108>>>>>    End_Object
31109>>>>>
31109>>>>>    Object WaitEdit is a editSub
31111>>>>>
31111>>>>>        //AB-StoreTopStart
31111>>>>>
31111>>>>>        //AB-StoreTopEnd
31111>>>>>
31111>>>>>        Set Enabled_State to FALSE
31112>>>>>        Set Read_Only_State to TRUE
31113>>>>>        Set Size to 58 243
31114>>>>>        Set Location to 60 4
31115>>>>>        Set Color to clWhite
31116>>>>>
31116>>>>>        //AB-StoreStart
31116>>>>>
31116>>>>>        Send DoRegSize Self amBottomRight
31117>>>>>        Delegate Set Size to 66 256
31119>>>>>
31119>>>>>        //AB-StoreEnd
31119>>>>>
31119>>>>>    End_Object
31120>>>>>
31120>>>>>    Object oTxtAntiBar is a TextBoxSub
31122>>>>>        Set Enabled_State to TRUE
31123>>>>>        Set Visible_State to FALSE
31124>>>>>        Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
31125>>>>>        Set Justification_Mode to (jMode_Center IOR jMode_VCenter)
31126>>>>>        Set Auto_Size_State to FALSE
31127>>>>>        Set FontWeight to 600
31128>>>>>        Set FontSize to 4 0
31129>>>>>        Set Size to 10 209
31130>>>>>        Set Location to 10 4
31131>>>>>        Set TextColor to clNavy
31132>>>>>    End_Object
31133>>>>>
31133>>>>>
31133>>>>>    //AB-StoreStart
31133>>>>>    Property Integer piWaitSize  Public (Size(Self))
31135>>>>>    Property Integer piPrevSize  Public (Size(Self))
31137>>>>>    Property Integer piState     Public False
31139>>>>>
31139>>>>>    Set Locate_Mode to Center_On_Screen
31140>>>>>    Set Destroy_Object_State to True
31141>>>>>
31141>>>>>    Procedure Show_Details Integer bAlways
31143>>>>>        Local Integer liOriSize liSize hiSize hiOriSize lowSize bState
31144>>>>>        Local String sLabel
31144>>>>>        Get Size                to liSize
31145>>>>>        Get piState             to bState
31146>>>>>        Get piWaitSize          to liOriSize
31147>>>>>        Move (Hi(liSize))       to hiSize
31148>>>>>        Move (Low(liSize))      to lowSize
31149>>>>>        Move (Hi(liOriSize))    to hiOriSize
31150>>>>>        If (bAlways) Begin
31152>>>>>            Set piState         to False
31153>>>>>            Move 0              to bState
31154>>>>>        End
31154>>>>>>
31154>>>>>        If bState Begin
31156>>>>>             Set Size to hiOriSize lowSize
31157>>>>>             Set Label of (bnDetail(Self)) to "Info >>"
31158>>>>>        End
31158>>>>>>
31158>>>>>        Else Begin
31159>>>>>             Set Size to 138 lowSize
31160>>>>>             Set Label of (bnDetail(Self)) to "<< Info"
31161>>>>>        End
31161>>>>>>
31161>>>>>        Set piState to (1-bState)
31162>>>>>    End_Procedure
31163>>>>>
31163>>>>>    Procedure Bar_Current_Position Integer iCount Integer iOccurances Integer iMaximum Integer bState
31165>>>>>       If (bState) Begin
31167>>>>>         If (Mod(iCount,(iCount*((Number(iMaximum))/(Number(iOccurances)))))=0) ;            Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
31170>>>>>       End
31170>>>>>>
31170>>>>>       Else Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
31172>>>>>    End_Procedure
31173>>>>>
31173>>>>>    Procedure DoInitialize_WaitBar
31175>>>>>        Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
31176>>>>>    End_Procedure
31177>>>>>
31177>>>>>    Procedure DoTerminate_WaitBar
31179>>>>>        Local Integer iMax
31180>>>>>        Get Maximum_position of (WaitBar(Self)) to iMax
31181>>>>>        Send Bar_Current_Position to (Wait(Self)) iMax iMax Imax False
31182>>>>>    End_Procedure
31183>>>>>
31183>>>>>    Procedure Set Bar_Maximum_Position Integer iMaximum
31185>>>>>         Set Maximum_position of (WaitBar(Self)) to iMaximum
31186>>>>>    End_Procedure
31187>>>>>
31187>>>>>    Function Bar_Maximum_Position Returns Integer
31189>>>>>        Function_Return (Maximum_position(WaitBar(Self)))
31190>>>>>    End_Function
31191>>>>>
31191>>>>>    Procedure Set Bar_Minimum_Position Integer iMinimum
31193>>>>>         Set Minimum_position of (WaitBar(Self)) to iMinimum
31194>>>>>    End_Procedure
31195>>>>>
31195>>>>>    Function Bar_Minimum_Position Returns Integer
31197>>>>>        Function_Return (Minimum_position(WaitBar(Self)))
31198>>>>>    End_Function
31199>>>>>
31199>>>>>    Procedure Set Bar_Step_Value Integer iStep
31201>>>>>         Set Step_Value of (WaitBar(Self)) to iStep
31202>>>>>    End_Procedure
31203>>>>>
31203>>>>>    Function Bar_Step_Value Returns Integer
31205>>>>>        Function_Return (Step_Value(WaitBar(Self)))
31206>>>>>    End_Function
31207>>>>>
31207>>>>>    Procedure Set Wait_Message String sMessage
31209>>>>>        Set Value of (WaitText(Self)) to sMessage
31210>>>>>    End_Procedure
31211>>>>>
31211>>>>>    Procedure Wait_Details String sFile String sDetail Integer bInitData
31213>>>>>        Local Integer liEditId
31214>>>>>        Move (WaitEdit(Self)) to liEditId
31215>>>>>        If bInitData Send Delete_Data to liEditId
31218>>>>>        If sFile ne "" Begin
31220>>>>>           Send Read to liEditId sFile
31221>>>>>           Send Beginning_Of_Data to liEditId
31222>>>>>        End
31222>>>>>>
31222>>>>>        Else Begin
31223>>>>>           Send Insert to liEditId sDetail
31224>>>>>        End
31224>>>>>>
31224>>>>>    End_Procedure
31225>>>>>
31225>>>>>    Procedure OnResize
31227>>>>>        Local Integer liSize liHiSize liPrevSize liHiPrevSize bState liHiLoc liLoc
31228>>>>>        Get Size to liPrevSize
31229>>>>>        Move (Hi(liPrevSize)) to liHiPrevSize
31230>>>>>        Forward Send OnResize
31232>>>>>        Get Location of (WaitEdit(Self)) to liLoc
31233>>>>>        Move (Hi(liLoc)) to liHiLoc
31234>>>>>        Get piState to bState
31235>>>>>        Get Size to liSize
31236>>>>>        Move (Hi(liSize)) to liHiSize
31237>>>>>        If (liHiSize > (liHiLoc +30)) Begin
31239>>>>>            Set Value of (bnDetail(Self)) to "<< Info"
31240>>>>>            If (liHiPrevSize <= (liHiLoc +30)) Set piState to (1-bState)
31243>>>>>        End
31243>>>>>>
31243>>>>>        Else Begin
31244>>>>>            Set Value of (bnDetail(Self)) to "Info >>"
31245>>>>>            If (liHiPrevSize > (liHiLoc +30)) Set piState to (1-bState)
31248>>>>>        End
31248>>>>>>
31248>>>>>    End_Procedure
31249>>>>>
31249>>>>>    Procedure Set Button_State Integer bState
31251>>>>>        If bState Begin
31253>>>>>            Set Caption_Bar to True
31254>>>>>            Set Size to 66 256
31255>>>>>        End
31255>>>>>>
31255>>>>>        Else Begin
31256>>>>>            Set Caption_Bar to False
31257>>>>>            Set Size to 38 256
31258>>>>>        End
31258>>>>>>
31258>>>>>    End_Procedure
31259>>>>>
31259>>>>>    Procedure Set BarVisibleState String sMsg Integer bState
31261>>>>>        Set Visible_State of (oTxtAntiBar(Self)) to (bState = 0)
31262>>>>>        Set Visible_State of (WaitBar(Self))     to (bState = 1)
31263>>>>>        If (bState = 0) Begin
31265>>>>>            Set Size to 24 256
31266>>>>>            Set Location of (oTxtAntiBar(Self)) to 6 5
31267>>>>>        End
31267>>>>>>
31267>>>>>        If sMsg ne "" Set Value of (oTxtAntiBar(Self)) to sMsg
31270>>>>>    End_Procedure
31271>>>>>
31271>>>>>    Procedure Deactivating integer search_mode Returns Integer
31273>>>>>        local integer rval
31274>>>>>        Forward Get MSG_Deactivating search_mode to rval
31276>>>>>        Set Modal_State of (Wait(Self)) to False
31277>>>>>        Set BarVisibleState of (Wait(Self)) to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..." True
31278>>>>>        Procedure_Return rval
31279>>>>>    End_Procedure
31280>>>>>
31280>>>>>    Procedure UpdateWait String sMsg
31282>>>>>        Set Value of (oTxtAntiBar(Self)) to sMsg
31283>>>>>    End_Procedure
31284>>>>>
31284>>>>>
31284>>>>>    Procedure Set Horizontal_Justification Integer aiMode
31286>>>>>        Set Justification_Mode of oTxtAntiBar to (jMode_VCenter IOR aiMode)
31287>>>>>    End_Procedure
31288>>>>>
31288>>>>>
31288>>>>>
31288>>>>>
31288>>>>>
31288>>>>>
31288>>>>>    //AB-StoreEnd
31288>>>>>
31288>>>>>End_Object
31289>>>>>
31289>>>>>
31289>>>>>//AB-StoreStart
31289>>>>>
31289>>>>>//AB-StoreEnd
31289>>>>>
31289>>>>>//AB/ End_Object    // prj
31289>>>
31289>Use Calendar.sl
INCLUDING FILE: CALENDAR.SL
31289>>>//AB/ Project Calendar
31289>>>//AB/ Object prj is a Lookup_Project
31289>>>//AB/     Set ProjectName to "Calendar"
31289>>>//AB/     Set ProjectFileName to "Calendar.sl"
31289>>>
31289>>>// Project Object Structure
31289>>>//   oCalendar is a dbModalPanel
31289>>>//     Container3d1 is a Container3d
31289>>>//       Grid2 is a Grid
31289>>>//       Textbox2 is a Textbox
31289>>>//       Textbox3 is a Textbox
31289>>>//       Textbox4 is a Textbox
31289>>>//       Textbox5 is a Textbox
31289>>>//       Textbox6 is a Textbox
31289>>>//       Textbox7 is a Textbox
31289>>>//       Textbox8 is a Textbox
31289>>>//       LineControl1 is a LineControl
31289>>>//       Container3d2 is a Container3d
31289>>>//         oRght is a BitmapContainer
31289>>>//         oLeft is a BitmapContainer
31289>>>//         oMonth is a Textbox
31289>>>//           oSelectMonth is a FloatingPopupMenu
31289>>>//         oYear is a Textbox
31289>>>//         oSelectYear is a Form
31289>>>//     BitmapContainer3 is a BitmapContainer
31289>>>//     oToday is a Textbox
31289>>>
31289>>>// Register all objects
31289>>>Register_Object BitmapContainer3
31289>>>Register_Object Container3d1
31289>>>Register_Object Container3d2
31289>>>Register_Object Grid2
31289>>>Register_Object LineControl1
31289>>>Register_Object oCalendar
31289>>>Register_Object oLeft
31289>>>Register_Object oMonth
31289>>>Register_Object oRght
31289>>>Register_Object oSelectMonth
31289>>>Register_Object oSelectYear
31289>>>Register_Object oToday
31289>>>Register_Object oYear
31289>>>Register_Object Textbox2
31289>>>Register_Object Textbox3
31289>>>Register_Object Textbox4
31289>>>Register_Object Textbox5
31289>>>Register_Object Textbox6
31289>>>Register_Object Textbox7
31289>>>Register_Object Textbox8
31289>>>
31289>>>
31289>>>
31289>>>//AB-StoreTopStart
31289>>>Use dates.utl
INCLUDING FILE: DATES.UTL
31289>>>>>// **********************************************************************
31289>>>>>// Use Dates.utl    // Date manipulation for VDF and DF3.1
31289>>>>>//
31289>>>>>// by Sture Andersen (sa1@vd.dk)
31289>>>>>//
31289>>>>>// The file contains a number of global functions for manipulating
31289>>>>>// dates. The package may be used with DataFlex 3.1 and Visual DataFlex.
31289>>>>>// This package is public domain.
31289>>>>>//
31289>>>>>// The package file is accompanied by a Word document (dfutil.doc)
31289>>>>>// listing the functions and their use.
31289>>>>>//
31289>>>>>//
31289>>>>>// Create: Fri  06-06-1997 - Merger of s_utl020, 021, 022, 023, 024, 025.
31289>>>>>// Update: Thu  26-06-1997 - Fixes for strange behavior when date4_state is set.
31289>>>>>//                         - Addition of popup_calendar to VDF.
31289>>>>>//         Sun  29-06-1997 - Character mode popup calender.
31289>>>>>//         Fri  04-07-1997 - Function WeekToDate added.
31289>>>>>//         Thu  10-07-1997 - Fixes.
31289>>>>>//         Mon  11-08-1997 - WeekToDate fixed.
31289>>>>>//         Sun  24-08-1997 - Character mode popup calender finished.
31289>>>>>//         Mon  15-12-1997 - Procedure Request_Popup_Calendar added.
31289>>>>>//         Mon  29-12-1997 - Procedures ItemYear2to4, ItemDate2to4 and
31289>>>>>//                           ItemSysdate added.
31289>>>>>//         Mon  29-12-1997 - Procedures FieldYear2to4, FieldDate2to4 and
31289>>>>>//                           FieldSysdate added.
31289>>>>>//         Sun  01-02-1998 - Functions Module_Compile_Date and
31289>>>>>//                           Module_Compile_Time added.
31289>>>>>//         Wed  25-02-1998 - Request_Popup in calendar object now only
31289>>>>>//                           responds if entry_state of the calling object
31289>>>>>//                           is true (VDF version). (No apparent effect)
31289>>>>>//         Sat  28-03-1998 - Added the following functions:
31289>>>>>//                             TS_SysTime      TS_ExtractDate
31289>>>>>//                             TS_ExtractTime  TS_ConvertToString
31289>>>>>//         Tue  26-05-1998 - Procedure TS_UI_Update added
31289>>>>>//         Sat  01-08-1998 - mask_date_window taken into account
31289>>>>>//         Mon  10-08-1998 - Functions Module_Start_Date and
31289>>>>>//                           Module_Start_Time added.
31289>>>>>//         Wed  02-09-1998 - Parameter for Module_Start_Date removed
31289>>>>>//         Mon  12-10-1998 - Portuguese added
31289>>>>>//         Wed  04-11-1998 - TS_TimeEstimator class added
31289>>>>>//         Tue  29-12-1998 - Function DateAsString added
31289>>>>>//         Wed  13-01-1999 - Function DateWeekNumber changed according to
31289>>>>>//                           Kjetil Johanson
31289>>>>>//         Mon  18-01-1999 - Function DateWeekNumber changed according to
31289>>>>>//                           Kjetil Johanson (again)
31289>>>>>//         Tue  19-01-1999 - Changed procedure names in TS_TimeEstimator
31289>>>>>//                           class (Continue->TS_Continue and Pause->
31289>>>>>//                           TS_Pause)
31289>>>>>//         Thu  21-01-1999 - Procedures DateFormatAsString and DateFormatName
31289>>>>>//                           added.
31289>>>>>//                         - Procedures DateCurrentSeparator and
31289>>>>>//                           DateCurrentFormat added.
31289>>>>>//         Tue  13-04-1999 - Julian constants added: Jan1st1900, Jan1st2000
31289>>>>>//                           Jan1st1000 and Jan1st100
31289>>>>>//         Mon  26-04-1999 - Changed procedure FieldYear2to4 and ItemYear2to4
31289>>>>>//                           to trap 3 digit years.
31289>>>>>//         Wed  27-04-1999 - Changed Dutch abbriviated day names (to 2 characters)
31289>>>>>//         Sun  02-05-1999 - Added function TS_Compose2
31289>>>>>//                         - Fixed error in TS_ConvertToString
31289>>>>>//         Tue  01-06-1999 - Added procedure popup_no_export to calendar.
31289>>>>>//         Thu  15-06-1999 - Fixed Date4to2 function and exporting dates
31289>>>>>//                           from the calendar to forms with no form_margin.
31289>>>>>//         Tue  07-09-1999 - Added function DateAsText
31289>>>>>//         Wed  27-10-1999 - Temporary fix for Module_Compile_Date function
31289>>>>>//                           in combination with y2k.
31289>>>>>//         Wed  19-12-1999 - Function StringToDate added.
31289>>>>>//                         - Existing function DateAsString renamed to
31289>>>>>//                           DateToString.
31289>>>>>//         Mon  03-01-2000 - Fix for VDF4. Popup calendar on empty date field
31289>>>>>//                           would result in seeding the calendar on year 100.
31289>>>>>//                           This error was caused by the fact that VDF 4
31289>>>>>//                           ignores SYSDATE4_STATE such that the sysdate
31289>>>>>//                           command returns 03-01-100
31289>>>>>//         Wed  01-02-2000 - Define instead of #REPLACE
31289>>>>>//         Wed  23-08-2000 - Function TS_Module_Compile_Time added
31289>>>>>//
31289>>>>>// NOTE:  There is language dependent string constants in this file.
31289>>>>>//        Currently there are sections for dutch, english, danish, swedish,
31289>>>>>//        norwegian, spanish, german and portuguese
31289>>>>>//
31289>>>>>//        These sections may be identified by searching the symbol LNG_DEFAULT
31289>>>>>//
31289>>>>>// ***********************************************************************
31289>>>>>
31289>>>>>Use ui
31289>>>>>Use Language    // Set default languange if not set by compiler command line
INCLUDING FILE: LANGUAGE.PKG
31289>>>>>>>// Use Language     // Default language setup
31289>>>>>>>// Sets default languange if not set by compiler command line
31289>>>>>>>
31289>>>>>>>define lng_dutch      for 131
31289>>>>>>>define lng_french     for 133 // NOT TRANSLATED. DO NOT SELECT!
31289>>>>>>>define lng_spanish    for 134
31289>>>>>>>define lng_italian    for 139 // NOT TRANSLATED. DO NOT SELECT!
31289>>>>>>>define lng_english    for 144
31289>>>>>>>define lng_danish     for 145
31289>>>>>>>define lng_swedish    for 146
31289>>>>>>>define lng_norwegian  for 147
31289>>>>>>>define lng_Greek    for 148
31289>>>>>>>define lng_german     for 149
31289>>>>>>>define lng_portuguese for 155
31289>>>>>>>define lng_papiamentu for 199 // NOT TRANSLATED. DO NOT SELECT!
31289>>>>>>>
31289>>>>>>>
31289>>>>>>>define lng_default for !@
31289>>>>>>>
31289>>>>>>>  define _LANGUAGE_ for $ENGLISH$
31289>>>>>>>
#REM LANGUAGE SET BY LANGUAGE.PKG: $ENGLISH$
31289>>>>>Use Seq_Chnl    // Defines global sequential device management operations (DAC)
31289>>>>>Use Macros.utl  // Various macros (DESKTOP_SECTION)
INCLUDING FILE: MACROS.UTL
31289>>>>>>>// Use Macros.utl   // Various macros (FOR_EX...)
31289>>>>>>>
31289>>>>>>>//  FOR_EX (extended FOR command)
31289>>>>>>>//  -----------------------------
31289>>>>>>>//> The FOR_EX command is exactly like the standard FOR command except
31289>>>>>>>//> that it will allow you to use keyword "DOWN_TO" instead of "TO" if
31289>>>>>>>//> you need to do a decremental loop.
31289>>>>>>>
31289>>>>>>>
31289>>>>>>>//  DESKTOP_SECTION
31289>>>>>>>//  ---------------
31289>>>>>>>//> The DESKTOP_SECTION/END_DESKTOP_SECTION commands will make a sequence of
31289>>>>>>>//> code compile (or rather instantiate) as if it was situated on the DESKTOP
31289>>>>>>>//> even when it isn't. DESKTOP_SECTION's may not be nested.
31289>>>>>>>
31289>>>>>>>
31289>>>>>>>
31289>>>>>
31289>>>>>// Switches
31289>>>>>
31289>>>>>define DATES_INCLUDE_POPUP for 1   // If set to 0 the popup calendar will not be included
31289>>>>>define DATES_DF31B_EPOCH   for 40  // DF3.1b didn't have an epoch setting. Therefore this symbol defines the epoch value for that version.
31289>>>>>
31289>>>>> define t.calendar.year           for "Year"
31289>>>>> define t.calendar.month          for "Month"
31289>>>>> define t.calendar.day            for "Day"
31289>>>>> define t.calendar.week           for "Wk."
31289>>>>> define t.calendar.calendar_popup for "Calendar Popup"
31289>>>>> define t.calendar.Monday         for "Monday"
31289>>>>> define t.calendar.Tuesday        for "Tuesday"
31289>>>>> define t.calendar.Wednesday      for "Wednesday"
31289>>>>> define t.calendar.Thursday       for "Thursday"
31289>>>>> define t.calendar.Friday         for "Friday"
31289>>>>> define t.calendar.Saturday       for "Saturday"
31289>>>>> define t.calendar.Sunday         for "Sunday"
31289>>>>> define t.calendar.January        for "January"
31289>>>>> define t.calendar.February       for "February"
31289>>>>> define t.calendar.March          for "March"
31289>>>>> define t.calendar.April          for "April"
31289>>>>> define t.calendar.May            for "May"
31289>>>>> define t.calendar.June           for "June"
31289>>>>> define t.calendar.July           for "July"
31289>>>>> define t.calendar.August         for "August"
31289>>>>> define t.calendar.September      for "September"
31289>>>>> define t.calendar.October        for "October"
31289>>>>> define t.calendar.November       for "November"
31289>>>>> define t.calendar.December       for "December"
31289>>>>> define t.calendar.ok             for "OK"
31289>>>>> define t.calendar.Cancel         for "Cancel"
31289>>>>> define t.calendar.Activate       for "Activate popup calendar (Ctrl+D)"
31289>>>>>
31289>>>>>define LargestPossibleDate for 913490 // December 31st 2500
31289>>>>>define Jan1st1900          for 693975
31289>>>>>define Jan1st2000          for 730500
31289>>>>>define Jan1st1000          for 365250
31289>>>>>define Jan1st105           for 38352
31289>>>>>define Jan1st100           for 36525
31289>>>>>
31289>>>>>enumeration_list // Date Segments
31289>>>>>  define DS_DAY
31289>>>>>  define DS_WEEK
31289>>>>>  define DS_MONTH
31289>>>>>  define DS_YEAR
31289>>>>>end_enumeration_list
31289>>>>>
31289>>>>>integer Dates$Year Dates$Month Dates$Day // internal use
31289>>>>>
31289>>>>>procedure DateDecompose global date date# //very internal!!
31290>>>>>  local integer pos1# pos2# format#
31291>>>>>  local string str# sep#
31291>>>>>  get_attribute DF_DATE_FORMAT to format#
31294>>>>>  get_attribute DF_DATE_SEPARATOR to pos1# // overload
31297>>>>>  character pos1# to sep#                  // end overload
31298>>>>>>
31298>>>>>  move date# to str#
31299>>>>>  replace sep# in str# with "$"
31301>>>>>  move strmark to pos1#
31302>>>>>  if [found] begin
31304>>>>>    replace sep# in str# with "$"
31306>>>>>    move strmark to pos2#
31307>>>>>  end
31307>>>>>>
31307>>>>>  else begin
31308>>>>>    move 0 to Dates$Year
31309>>>>>    move 0 to Dates$Month
31310>>>>>    move 0 to Dates$Day
31311>>>>>  end
31311>>>>>>
31311>>>>>  [ found] begin
31313>>>>>>
31313>>>>>    if format# eq DF_DATE_EUROPEAN ;          left str# to Dates$Day    (pos1#-1)
31317>>>>>    if format# eq DF_DATE_USA begin
31319>>>>>          mid  str# to Dates$Day    (pos2#-pos1#-1) (pos1#+1)
31322>>>>>>
31322>>>>>          left str# to Dates$Month  (pos1#-1)
31324>>>>>>
31324>>>>>    end
31324>>>>>>
31324>>>>>    else  mid  str# to Dates$Month  (pos2#-pos1#-1) (pos1#+1)
31328>>>>>
31328>>>>>    if format# eq DF_DATE_MILITARY begin
31330>>>>>          mid  str# to Dates$Day  2 (pos2#+1)
31333>>>>>>
31333>>>>>          left str# to Dates$Year   (pos1#-1)
31335>>>>>>
31335>>>>>    end
31335>>>>>>
31335>>>>>    else  mid  str# to Dates$Year 4 (pos2#+1)
31339>>>>>  end
31339>>>>>>
31339>>>>>end_procedure
31340>>>>>
31340>>>>>function DateCompose global integer day# integer month# integer year# returns date
31341>>>>>  local integer format#
31342>>>>>  local date date#
31342>>>>>  local string sep#
31342>>>>>  ifnot (day#*month#*year#) function_return 0
31345>>>>>  get_attribute DF_DATE_SEPARATOR to format# // overload
31348>>>>>  character format# to sep#                  // end overload
31349>>>>>>
31349>>>>>  get_attribute DF_DATE_FORMAT to format#
31352>>>>>  if day# gt 28 begin
31354>>>>>    if format# eq DF_DATE_EUROPEAN move (date(string(day#)+sep#+string(month#)+sep#+string(year#))) to date# // DMY
31357>>>>>    if format# eq DF_DATE_USA      move (date(string(month#)+sep#+string(day#)+sep#+string(year#))) to date# // MDY
31360>>>>>    if format# eq DF_DATE_MILITARY move (date(string(year#)+sep#+string(month#)+sep#+string(day#))) to date# // YMD
31363>>>>>    send DateDecompose date#
31364>>>>>    if Dates$Month ne month# move (day#-Dates$Day) to day#
31367>>>>>  end
31367>>>>>>
31367>>>>>  if format# eq DF_DATE_EUROPEAN function_return (date(string(day#)+sep#+string(month#)+sep#+string(year#))) // DMY
31370>>>>>  if format# eq DF_DATE_USA function_return (date(string(month#)+sep#+string(day#)+sep#+string(year#))) // MDY
31373>>>>>  function_return (date(string(year#)+sep#+string(month#)+sep#+string(day#))) // YMD
31374>>>>>end_function
31375>>>>>
31375>>>>>function DateFormatName global integer format# returns string
31376>>>>>  if format# eq DF_DATE_EUROPEAN function_return "European"
31379>>>>>  if format# eq DF_DATE_USA      function_return "United States"
31382>>>>>  if format# eq DF_DATE_MILITARY function_return "Military"
31385>>>>>end_function
31386>>>>>
31386>>>>>function DateCurrentSeparator global returns string
31387>>>>>  local integer rval#
31388>>>>>  get_attribute DF_DATE_SEPARATOR to rval#
31391>>>>>  function_return (character(rval#))
31392>>>>>end_function
31393>>>>>
31393>>>>>function DateCurrentFormat global returns integer
31394>>>>>  local integer rval#
31395>>>>>  get_attribute DF_DATE_FORMAT to rval#
31398>>>>>  function_return rval#
31399>>>>>end_function
31400>>>>>
31400>>>>>function DateFormatAsString global integer format# integer long# string sep# returns string
31401>>>>>  local string rval# letter#
31402>>>>>  if format# eq DF_DATE_EUROPEAN move "3342241111" to rval#
31405>>>>>  if format# eq DF_DATE_USA      move "2243341111" to rval#
31408>>>>>  if format# eq DF_DATE_MILITARY move "1111422433" to rval#
31411>>>>>  left t.calendar.year to letter# 1
31413>>>>>>
31413>>>>>  replace "1" in rval# with letter#
31415>>>>>  replace "1" in rval# with letter#
31417>>>>>  ifnot long# move "" to letter#
31420>>>>>  move (replaces("1",rval#,letter#)) to rval#
31421>>>>>  move (replaces("2",rval#,left(t.calendar.month,1))) to rval#
31422>>>>>  move (replaces("3",rval#,left(t.calendar.day,1))) to rval#
31423>>>>>  if sep# eq "" begin
31425>>>>>    get_attribute DF_DATE_SEPARATOR to format#
31428>>>>>    character format# to sep#
31429>>>>>>
31429>>>>>  end
31429>>>>>>
31429>>>>>  move (replaces("4",rval#,sep#)) to rval#
31430>>>>>  function_return rval#
31431>>>>>end_function
31432>>>>>
31432>>>>>function StringToDate global string date# integer format# integer four_digit_year# string sep# returns date
31433>>>>>  local integer sep_len# day# month# year#
31434>>>>>  move (length(sep#)) to sep_len#
31435>>>>>  if four_digit_year# move 4 to four_digit_year#
31438>>>>>  else move 2 to four_digit_year#
31440>>>>>  if format# eq DF_DATE_EUROPEAN begin // DMY
31442>>>>>    move (mid(date#,2,1)) to day#
31443>>>>>    move (mid(date#,2,3+sep_len#)) to month#
31444>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31445>>>>>  end
31445>>>>>>
31445>>>>>  if format# eq DF_DATE_USA begin // MDY
31447>>>>>    move (mid(date#,2,1)) to month#
31448>>>>>    move (mid(date#,2,3+sep_len#)) to year#
31449>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31450>>>>>  end
31450>>>>>>
31450>>>>>  if format# eq DF_DATE_MILITARY begin // YMD
31452>>>>>    move (mid(date#,four_digit_year#,1)) to year#
31453>>>>>    move (mid(date#,2,1+four_digit_year#+sep_len#)) to month#
31454>>>>>    move (mid(date#,2,3+four_digit_year#+sep_len#+sep_len#)) to day#
31455>>>>>  end
31455>>>>>>
31455>>>>>  function_return (DateCompose(day#,month#,year#))
31456>>>>>end_function
31457>>>>>
31457>>>>>function DateToString global date date# integer format# integer four_digit_year# string sep# returns string
31458>>>>>  local string rval# day# month# year#
31459>>>>>  get Date2to4 date# to date#
31460>>>>>  if (integer(date#)) begin
31462>>>>>    send DateDecompose date#
31463>>>>>    move Dates$Day to day#
31464>>>>>    if Dates$Day lt 10 insert "0" in day# at 1
31468>>>>>    move Dates$Month to month#
31469>>>>>    if Dates$Month lt 10 insert "0" in month# at 1
31473>>>>>    move Dates$Year to year#
31474>>>>>    ifnot four_digit_year# move (right(year#,2)) to year#
31477>>>>>    if format# eq DF_DATE_EUROPEAN move (day#+sep#+month#+sep#+year#) to rval# // DMY
31480>>>>>    if format# eq DF_DATE_USA      move (month#+sep#+day#+sep#+year#) to rval# // MDY
31483>>>>>    if format# eq DF_DATE_MILITARY move (year#+sep#+month#+sep#+day#) to rval# // YMD
31486>>>>>  end
31486>>>>>>
31486>>>>>  function_return rval#
31487>>>>>end_function
31488>>>>>
31488>>>>>// Function DateAsString is only here for compatibility with earlier versions.
31488>>>>>// Use function DateToString instead.
31488>>>>>function DateAsString global date date# integer format# integer four_digit_year# string sep# returns string
31489>>>>>  function_return (DateToString(date#,format#,four_digit_year#,sep#))
31490>>>>>end_function
31491>>>>>
31491>>>>>function DateIncrement global date date# integer segment# integer amount# returns date
31492>>>>>  if (date#=0) function_return 0
31495>>>>>  if segment# eq DS_WEEK function_return (date#+(amount#*7)) //weeks
31498>>>>>  if (segment#<>DS_DAY) begin // months or years
31500>>>>>    send DateDecompose date#
31501>>>>>    if segment# eq DS_MONTH begin //months
31503>>>>>      move (Dates$Month+amount#) to Dates$Month
31504>>>>>      if amount# ge 0 function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-1)/12)*12),Dates$Year+((Dates$Month-1)/12)))
31507>>>>>      function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-12)/12)*12),Dates$Year+((Dates$Month-12)/12)))
31508>>>>>    end //years:
31508>>>>>>
31508>>>>>    if segment# eq DS_YEAR function_return (DateCompose(Dates$Day,Dates$Month,Dates$Year+amount#))
31511>>>>>  end
31511>>>>>>
31511>>>>>  else function_return (date#+amount#) //days
31513>>>>>end_function
31514>>>>>
31514>>>>>function DateSegment global date date# integer segment# returns integer
31515>>>>>  send DateDecompose date#
31516>>>>>  if segment# eq DS_DAY   function_return Dates$Day
31519>>>>>  if segment# eq DS_MONTH function_return Dates$Month
31522>>>>>  if segment# eq DS_YEAR  function_return Dates$Year
31525>>>>>end_function
31526>>>>>
31526>>>>>function DateToInteger global date date# returns integer
31527>>>>>  send DateDecompose date#
31528>>>>>  function_return (Dates$Year*100+Dates$Month*100+Dates$Day)
31529>>>>>end_function
31530>>>>>
31530>>>>>function FirstDayInMonth global date date# returns date
31531>>>>>  local integer month# year#
31532>>>>>  move (DateSegment(date#,DS_MONTH)) to month#
31533>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31534>>>>>  function_return (DateCompose(1,month#,year#))
31535>>>>>end_function
31536>>>>>
31536>>>>>function LastDayInMonth global date date# returns date
31537>>>>>  move (DateIncrement(date#,DS_MONTH,1)) to date#
31538>>>>>  function_return (FirstDayInMonth(date#)-1)
31539>>>>>end_function
31540>>>>>
31540>>>>>function FirstDayInYear global date date# returns date
31541>>>>>  local integer year#
31542>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31543>>>>>  function_return (DateCompose(1,1,year#))
31544>>>>>end_function
31545>>>>>
31545>>>>>function LastDayInYear global date date# returns date
31546>>>>>  move (DateIncrement(date#,DS_YEAR,1)) to date#
31547>>>>>  function_return (FirstDayInYear(date#)-1)
31548>>>>>end_function
31549>>>>>
31549>>>>>// Prior to 18/1-99 version of DateWeekNumber
31549>>>>>//function DateWeekNumber global date date# returns integer
31549>>>>>//  local integer week# first_wd# day_of_year# year#
31549>>>>>//  if (date#=0) function_return 0
31549>>>>>//  get Date2to4 date# to date#
31549>>>>>//  move (DateSegment(date#,DS_YEAR)) to year#
31549>>>>>//  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31549>>>>>//  move (date#-FirstDayInYear(date#)) to day_of_year#
31549>>>>>//  move (day_of_year#-1-7+first_wd#) to day_of_year#
31549>>>>>//  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31549>>>>>//  else move 0 to week#
31549>>>>>//  if first_wd# le 4 increment week#
31549>>>>>//  if week# gt 52 begin
31549>>>>>//    move 1 to week#
31549>>>>>//    if first_wd# eq 4 move 53 to week#
31549>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31549>>>>>//  end
31549>>>>>//  if week# eq 0 begin
31549>>>>>//    //get DateWeekNumber (DateIncrement(date#,DS_YEAR,-1)) to first_wd# // Original line
31549>>>>>//    get DateDayNumber  (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#ÿ // changed line
31549>>>>>//    move 52 to week#
31549>>>>>//    if first_wd# eq 4 move 53 to week#
31549>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31549>>>>>//  end
31549>>>>>//  function_return week#
31549>>>>>//end_function
31549>>>>>
31549>>>>>function DateWeekNumber global date date# returns integer
31550>>>>>  local integer week# first_wd# day_of_year# year# wd#
31551>>>>>  if (date#=0) function_return 0
31554>>>>>  get Date2to4 date# to date#
31555>>>>>  // Leap-year test for actual or previous year
31555>>>>>  // Year# only used for selection between 52 and
31555>>>>>  // Therefore get year# from the first day of actual week
31555>>>>>  get DateDayNumber date# to wd#
31556>>>>>  move (DateSegment(date#-wd#+1,DS_YEAR)) to year#
31557>>>>>
31557>>>>>  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31558>>>>>  move (date#-FirstDayInYear(date#)) to day_of_year#
31559>>>>>  move (day_of_year#-1-7+first_wd#) to day_of_year#
31560>>>>>  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31563>>>>>  else move 0 to week#
31565>>>>>  if first_wd# le 4 increment week#
31568>>>>>  if week# gt 52 begin
31570>>>>>    move 1 to week#
31571>>>>>    if first_wd# eq 4 move 53 to week#
31574>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31581>>>>>  end
31581>>>>>>
31581>>>>>  if week# eq 0 begin
31583>>>>>    // Week 52 or 53
31583>>>>>    get DateDayNumber (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#
31584>>>>>    move 52 to week#
31585>>>>>    if first_wd# eq 4 move 53 to week#
31588>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31595>>>>>  end
31595>>>>>>
31595>>>>>  function_return week#
31596>>>>>end_function
31597>>>>>
31597>>>>>function DayName global integer int# returns string
31598>>>>>  if int# eq 1 function_return t.calendar.Monday
31601>>>>>  if int# eq 2 function_return t.calendar.Tuesday
31604>>>>>  if int# eq 3 function_return t.calendar.Wednesday
31607>>>>>  if int# eq 4 function_return t.calendar.Thursday
31610>>>>>  if int# eq 5 function_return t.calendar.Friday
31613>>>>>  if int# eq 6 function_return t.calendar.Saturday
31616>>>>>  if int# eq 7 function_return t.calendar.Sunday
31619>>>>>  function_return ""
31620>>>>>end_function
31621>>>>>
31621>>>>>function DateDayNumber global date date# returns integer
31622>>>>>  local integer rval# // 1=Monday, ... , 7=Sunday
31623>>>>>  get Date2to4 date# to date#
31624>>>>>  move date# to rval#
31625>>>>>  if rval# begin
31627>>>>>    if rval# gt 693975 move (rval#-2) to rval#
31630>>>>>    move (rval#-((rval#/7)*7)) to rval#
31631>>>>>    if rval# eq 0 move 7 to rval#
31634>>>>>  end
31634>>>>>>
31634>>>>>  function_return rval#
31635>>>>>end_function
31636>>>>>
31636>>>>>function DateDayName global date date# returns string
31637>>>>>  function_return (DayName(DateDayNumber(date#)))
31638>>>>>end_function
31639>>>>>
31639>>>>>function YearMaxWeek global integer year# returns integer
31640>>>>>  local integer wk1# wk2#
31641>>>>>  get DateWeekNumber (DateCompose(31,12,year#)) to wk1#
31642>>>>>  get DateWeekNumber (DateCompose(24,12,year#)) to wk2#
31643>>>>>  function_return (wk1# max wk2#)
31644>>>>>end_function
31645>>>>>
31645>>>>>function WeekToDate global integer year# integer week# returns date
31646>>>>>  local date date#
31647>>>>>  move (DateCompose(1,1,year#)) to date#
31648>>>>>  if (DateWeekNumber(date#)) ne 1 move (date#+7) to date# // week 52 or 53
31651>>>>>  move (date#-DateDayNumber(date#)+1) to date# // Now it's a Monday
31652>>>>>  function_return (week#-1*7+date#)
31653>>>>>end_function
31654>>>>>
31654>>>>>function MonthName global integer int# returns string
31655>>>>>  if int# eq  1 function_return t.calendar.January
31658>>>>>  if int# eq  2 function_return t.calendar.February
31661>>>>>  if int# eq  3 function_return t.calendar.March
31664>>>>>  if int# eq  4 function_return t.calendar.April
31667>>>>>  if int# eq  5 function_return t.calendar.May
31670>>>>>  if int# eq  6 function_return t.calendar.June
31673>>>>>  if int# eq  7 function_return t.calendar.July
31676>>>>>  if int# eq  8 function_return t.calendar.August
31679>>>>>  if int# eq  9 function_return t.calendar.September
31682>>>>>  if int# eq 10 function_return t.calendar.October
31685>>>>>  if int# eq 11 function_return t.calendar.November
31688>>>>>  if int# eq 12 function_return t.calendar.December
31691>>>>>  function_return ""
31692>>>>>end_function
31693>>>>>
31693>>>>>function DateMonthName global date date# returns string
31694>>>>>  function_return (MonthName(DateSegment(date#,DS_MONTH)))
31695>>>>>end_function
31696>>>>>
31696>>>>>function DateAsText global date date# string format# returns string
31697>>>>>  if date# eq 0 function_return ""
31700>>>>>  move (replace("#DN",format#,DateDayName(date#)))                  to format#
31701>>>>>  move (replace("#MN",format#,DateMonthName(date#)))                to format#
31702>>>>>  move (replace("#D" ,format#,string(DateSegment(date#,DS_DAY))))   to format#
31703>>>>>  move (replace("#Y" ,format#,string(DateSegment(date#,DS_YEAR))))  to format#
31704>>>>>  move (replace("#M" ,format#,string(DateSegment(date#,DS_MONTH)))) to format#
31705>>>>>  function_return format#
31706>>>>>end_function
31707>>>>>
31707>>>>>function Year2to4 global integer year# returns integer
31708>>>>>  local integer epoch_value#
31709>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31710>>>>>  if year# lt 100 begin
31712>>>>>    if year# gt epoch_value# function_return (year#+1900)
31715>>>>>    function_return (year#+2000)
31716>>>>>  end
31716>>>>>>
31716>>>>>  function_return year# // No conversion done!
31717>>>>>end_function
31718>>>>>
31718>>>>>function Date2to4 global date date# returns date
31719>>>>>  local integer epoch_value#
31720>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31721>>>>>  if date# gt 0 begin // Only if there is a date to convert
31723>>>>>    if (DateSegment(date#,DS_YEAR)) lt 105 begin
31725>>>>>      if Dates$Year gt epoch_value# function_return (DateIncrement(date#,DS_YEAR,1900))
31728>>>>>      function_return (DateIncrement(date#,DS_YEAR,2000))
31729>>>>>    end
31729>>>>>>
31729>>>>>    function_return date# // No conversion done!
31730>>>>>  end
31730>>>>>>
31730>>>>>end_function
31731>>>>>
31731>>>>>function Date4to2 global date date# returns date
31732>>>>>  local integer epoch_value# year#
31733>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31734>>>>>  if date# gt 0 begin // Only if there is a date to convert
31736>>>>>    move (DateSegment(date#,DS_YEAR)) to year#
31737>>>>>    if year# ge 100 begin // Only then conversion is needed!
31739>>>>>      if (year#>=(1900+epoch_value#) and year#<(2000+epoch_value#)) begin
31741>>>>>        if year# lt 2000 function_return (DateIncrement(date#,DS_YEAR,-1900))
31744>>>>>        else             function_return (DateIncrement(date#,DS_YEAR,-2000))
31746>>>>>      end
31746>>>>>>
31746>>>>>      else error 301 "Date is out of epoch range"
31748>>>>>    end
31748>>>>>>
31748>>>>>  end
31748>>>>>>
31748>>>>>  function_return date# // No conversion done!
31749>>>>>end_function
31750>>>>>
31750>>>>>function dSysDate global returns date
31751>>>>>  local date date#
31752>>>>>  sysdate4 date#
31753>>>>>  function_return date#
31754>>>>>end_function
31755>>>>>
31755>>>>>function iSysYear global returns integer
31756>>>>>  local date date#
31757>>>>>  sysdate4 date#
31758>>>>>  function_return (DateSegment(date#,DS_YEAR))
31759>>>>>end_function
31760>>>>>
31760>>>>>procedure ItemSysdate for desktop integer itm#
31761>>>>>  local date date#
31762>>>>>  get value item itm# to date#
31763>>>>>  if date# eq 0 begin
31765>>>>>    sysdate4 date#
31766>>>>>    set changed_value item itm# to date#
31767>>>>>  end
31767>>>>>>
31767>>>>>end_procedure
31768>>>>>
31768>>>>>procedure ItemDate2to4 for desktop integer itm#
31769>>>>>  local integer year#
31770>>>>>  local date date# new_date#
31770>>>>>  get value item itm# to date#
31771>>>>>
31771>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31772>>>>>  if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31775>>>>>  else move date# to new_date#
31777>>>>>
31777>>>>>  move (Date2to4(new_date#)) to new_date#
31778>>>>>  move (DateSegment(new_date#,3)) to year#
31779>>>>>  if (year#>99 and year#<1000) begin
31781>>>>>    error 15 // Illegal entry in this window
31782>>>>>>
31782>>>>>    procedure_return 1
31783>>>>>  end
31783>>>>>>
31783>>>>>  if new_date# ne date# set value item itm# to new_date#
31786>>>>>end_procedure
31787>>>>>
31787>>>>>procedure ItemYear2to4 for desktop integer itm#
31788>>>>>  local integer year# new_year#
31789>>>>>  get value item itm# to year#
31790>>>>>  if (year#>99 and year#<1000) begin
31792>>>>>    error 15 // Illegal entry in this window
31793>>>>>>
31793>>>>>    procedure_return 1
31794>>>>>  end
31794>>>>>>
31794>>>>>  move (Year2to4(year#)) to new_year#
31795>>>>>  if new_year# ne year# set value item itm# to new_year#
31798>>>>>end_procedure
31799>>>>>
31799>>>>> procedure FieldSysdate for DataDictionary integer fld#
31800>>>>>   local date date#
31801>>>>>   get field_current_value fld# to date#
31802>>>>>   if date# eq 0 begin
31804>>>>>     sysdate4 date#
31805>>>>>     set field_changed_value fld# to date#
31806>>>>>   end
31806>>>>>>
31806>>>>> end_procedure
31807>>>>>
31807>>>>> procedure FieldDate2to4 for DataDictionary integer fld#
31808>>>>>   local integer year#
31809>>>>>   local date date# new_date#
31809>>>>>   get field_current_value fld# to date#
31810>>>>>
31810>>>>>   move (DateSegment(date#,DS_YEAR)) to year#
31811>>>>>   if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31814>>>>>   else move date# to new_date#
31816>>>>>
31816>>>>>   move (Date2to4(new_date#)) to new_date#
31817>>>>>   move (DateSegment(new_date#,3)) to year#
31818>>>>>   if (year#>99 and year# <=999) begin
31820>>>>>     error 15 // Illegal entry in this window
31821>>>>>>
31821>>>>>     procedure_return 1
31822>>>>>   end
31822>>>>>>
31822>>>>>   if new_date# ne date# set field_changed_value fld# to new_date#
31825>>>>> end_procedure
31826>>>>>
31826>>>>> procedure FieldYear2to4 for DataDictionary integer fld#
31827>>>>>   local integer year# new_year# changed#
31828>>>>>   get field_current_value fld# to year#
31829>>>>>   get field_changed_state fld# to changed#
31830>>>>>   if changed# begin
31832>>>>>     if (year#>99 and year#<1000) begin
31834>>>>>       error 15 // Illegal entry in this window
31835>>>>>>
31835>>>>>       procedure_return 1
31836>>>>>     end
31836>>>>>>
31836>>>>>     move (Year2to4(year#)) to new_year#
31837>>>>>     if new_year# ne year# set field_changed_value fld# to new_year#
31840>>>>>   end
31840>>>>>>
31840>>>>> end_procedure
31841>>>>>
31841>>>>> function SysDate global returns date
31842>>>>>   function_return (dSysDate())
31843>>>>> end_function
31844>>>>>
31844>>>>>function sSysTime global returns string
31845>>>>>  local integer h# m# s#
31846>>>>>  sysdate4 h# h# m# s#
31850>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31851>>>>>end_function
31852>>>>>
31852>>>>>function TS_SysTime global returns number
31853>>>>>  local integer d# h# m# s#
31854>>>>>  sysdate4 d# h# m# s#
31858>>>>>  function_return (d#*24.0+h#*60+m#*60+s#)
31859>>>>>end_function
31860>>>>>
31860>>>>>//> This function returns a TS value composed from the date and time
31860>>>>>//> passed to it. Note that the time variable must be of the format
31860>>>>>//> "hh:mm:ss".
31860>>>>>function TS_Compose global date date# string time# returns number
31861>>>>>  local integer h# m# s#
31862>>>>>  left time# to h# 2
31864>>>>>>
31864>>>>>  mid time# to m# 2 4
31867>>>>>>
31867>>>>>  mid time# to s# 2 7
31870>>>>>>
31870>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31871>>>>>end_function
31872>>>>>
31872>>>>>function TS_Compose2 global date date# integer h# integer m# integer s# returns number
31873>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31874>>>>>end_function
31875>>>>>
31875>>>>>function TS_ExtractDate global number time# returns date
31876>>>>>  function_return (time#/86400) // 86400=24*60*60
31877>>>>>end_function
31878>>>>>
31878>>>>>function TS_ExtractTime global number time# returns string
31879>>>>>  local integer h# m# s#
31880>>>>>  move (time#-(86400.0*integer(TS_ExtractDate(time#)))) to s#
31881>>>>>  move (s#/3600) to h#
31882>>>>>  move (s#-(h#*3600)) to s#
31883>>>>>  move (s#/60) to m#
31884>>>>>  move (s#-(m#*60)) to s#
31885>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31886>>>>>end_function
31887>>>>>
31887>>>>>function TS_ConvertToString global number time# returns string
31888>>>>>  local date d#
31889>>>>>  move (TS_ExtractDate(time#)) to d#
31890>>>>>  if (integer(d#)) function_return (string(d#)+" "+TS_ExtractTime(time#))
31893>>>>>  else function_return (TS_ExtractTime(time#))
31895>>>>>end_function
31896>>>>>
31896>>>>>function TS_ConvertToStringNoDate global number ts# returns string
31897>>>>>  local integer h# m#
31898>>>>>  move (ts#/3600) to h#
31899>>>>>  move (ts#-(h#*3600)) to ts#
31900>>>>>  move (ts#/60) to m#
31901>>>>>  move (ts#-(m#*60)) to ts#
31902>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(ts#<10,"0","")+string(ts#))
31903>>>>>end_function
31904>>>>>
31904>>>>>// This procedure is used when a TS-variable must be displayed on screen.
31904>>>>>procedure TS_UI_Update global number TS# integer obj1# integer itm1# integer tmp_obj2# integer tmp_itm2#
31905>>>>>  local integer obj2# itm2#
31906>>>>>  if num_arguments gt 3 begin
31908>>>>>    move tmp_obj2# to obj2#
31909>>>>>    move tmp_itm2# to itm2#
31910>>>>>  end
31910>>>>>>
31910>>>>>  else begin
31911>>>>>    move obj1# to obj2#
31912>>>>>    move (itm1#+1) to itm2#
31913>>>>>  end
31913>>>>>>
31913>>>>>  set value of obj1# item itm1# to (TS_ExtractDate(TS#))
31914>>>>>  set value of obj2# item itm2# to (TS_ExtractTime(TS#))
31915>>>>>end_procedure
31916>>>>>
31916>>>>>class TS_TimeEstimator is an array
31917>>>>>  procedure construct_object
31918>>>>>    forward send construct_object
31920>>>>>    set delegation_mode to delegate_to_parent
31921>>>>>    property number  pnTotal   public 0 // Seconds needed to run the loop.
31922>>>>>    property number  pnElapsed public 0 // Seconds elapsed so far.
31923>>>>>    property number  pnLeft    public 0 // Number of seconds left
31924>>>>>    property number  pnStart   public 0
31925>>>>>    property number  pnPause   public 0
31926>>>>>    property number  pnPercent public 0
31927>>>>>    property integer piMin     public 0
31928>>>>>    property integer piMax     public 0
31929>>>>>  end_procedure
31930>>>>>
31930>>>>>  procedure TS_Start integer min# integer max#
31931>>>>>    set piMin to min#
31932>>>>>    set piMax to max#
31933>>>>>    set pnStart to (TS_SysTime())
31934>>>>>    set pnElapsed to 0
31935>>>>>    set pnPercent to 0
31936>>>>>  end_procedure
31937>>>>>
31937>>>>>  procedure TS_Calculate integer pos#
31938>>>>>    local integer min# max#
31939>>>>>    get piMin to min#
31940>>>>>    get piMax to max#
31941>>>>>    set pnElapsed to (TS_SysTime()-pnStart(current_object))
31942>>>>>    set pnTotal   to (pnElapsed(current_object)*(max#-min#)/number(pos#-min#))
31943>>>>>    set pnLeft    to (pnTotal(current_object)-pnElapsed(current_object))
31944>>>>>    set pnPercent to (100.0*(pos#-min#)/(max#-min#))
31945>>>>>  end_procedure
31946>>>>>
31946>>>>>  procedure TS_Pause
31947>>>>>    set pnPause to (TS_SysTime())
31948>>>>>  end_procedure
31949>>>>>
31949>>>>>  procedure TS_Continue
31950>>>>>    set pnStart to (pnStart(current_object)+TS_SysTime()-pnPause(current_object))
31951>>>>>  end_procedure
31952>>>>>end_class
31953>>>>>
31953>>>>>function TS_Module_Compile_Time global string path# returns number
31954>>>>>  local integer pos# day# month# year# seqeof# ch#
31955>>>>>  local string date# str# time#
31955>>>>>  move path# to str#
31956>>>>>  if str# ne "" begin
31958>>>>>    get Seq_New_Channel to ch#   // This method and Seq_Release_Channel are
31959>>>>>    send Seq_Release_Channel ch# // We only need it for a second
31960>>>>>      direct_input channel ch# (trim(str#)+".vd6") // VDF 6
31962>>>>>      [seqeof] direct_input channel ch# (trim(str#)+".vd5") // VDF 5
31964>>>>>    [ seqeof] move 1 to seqeof#
31965>>>>>    [~seqeof] move 0 to seqeof#
31966>>>>>    [~seqeof] readln str#
31967>>>>>    close_input channel ch#
31969>>>>>  end
31969>>>>>>
31969>>>>>  if seqeof# function_return 0
31972>>>>>  pos "," in str# to pos#
31974>>>>>>
31974>>>>>  move (mid(str#,18,pos#+2)) to str#
31975>>>>>  move (integer(mid(str#,2,4))) to day#
31976>>>>>  move (integer(mid(str#,2,1))) to month#
31977>>>>>  move (integer(mid(str#,2,7))) to year#
31978>>>>>  if year# eq 10 begin
31980>>>>>    move (integer(mid(str#,3,7))+1900) to year#
31981>>>>>    move (mid(str#,8,11)) to str#
31982>>>>>  end
31982>>>>>>
31982>>>>>  else move (mid(str#,8,10)) to str#
31984>>>>>  move (DateCompose(day#,month#,year#)) to date#
31985>>>>>  move (Date2to4(date#)) to date#
31986>>>>>  pos ":" in str# to pos#
31988>>>>>>
31988>>>>>  function_return (TS_Compose(date#,mid(str#,8,pos#-2)))
31989>>>>>end_function
31990>>>>>
31990>>>>>string Dates$Module_Compile_Time
31990>>>>>move "" to Dates$Module_Compile_Time
31991>>>>>
31991>>>>>function Module_Compile_Date global returns date
31992>>>>>  local number ts#
31993>>>>>  local string str#
31993>>>>>  get module_name to str# // 'module_name' is most likely the name of the .flx file.
31994>>>>>  get TS_Module_Compile_Time str# to ts#
31995>>>>>  move (TS_ExtractTime(ts#)) to Dates$Module_Compile_Time
31996>>>>>  function_return (TS_ExtractDate(ts#))
31997>>>>>end_function
31998>>>>>
31998>>>>>function Module_Compile_Time global returns string
31999>>>>>  local date grb#
32000>>>>>  // Module_Compile_Date must be called before this one!
32000>>>>>  if Dates$Module_Compile_Time eq "" move (Module_Compile_Date()) to grb#
32003>>>>>  function_return Dates$Module_Compile_Time
32004>>>>>end_function
32005>>>>>
32005>>>>>date   Dates$ModuleStartDate
32005>>>>>string Dates$ModuleStartTime 8
32005>>>>>move (dSysDate()) to Dates$ModuleStartDate
32006>>>>>move (sSysTime()) to Dates$ModuleStartTime
32007>>>>>
32007>>>>>function Module_Start_Date global returns date
32008>>>>>  function_return Dates$ModuleStartDate
32009>>>>>end_function
32010>>>>>
32010>>>>>function Module_Start_Time global returns string
32011>>>>>  function_return Dates$ModuleStartTime
32012>>>>>end_function
32013>>>>>
32013>>>>> register_procedure NotifyPopupCalendarChange date date#
32013>>>>> register_procedure NotifyPopupCalendarSelect date date#
32013>>>>>  use dfAllent
32013>>>>>  class calendar.textbox is a textbox
32014>>>>>    procedure construct_object
32015>>>>>      forward send construct_object
32017>>>>>      Set Auto_Size_State To False
32018>>>>>      Set Justification_Mode To (jMode_vCenter+jMode_Center)
32019>>>>>    end_procedure
32020>>>>>  end_class
32021>>>>>
32021>>>>>  register_object btn1
32021>>>>>  register_object btn6
32021>>>>>
32021>>>>>  class calendar.button is a button
32022>>>>>
32022>>>>>    procedure construct_object
32023>>>>>      forward send construct_object
32025>>>>>      set size to 15 18
32026>>>>>      on_key kleftarrow   send prev_day
32027>>>>>      on_key krightarrow  send next_day
32028>>>>>      on_key kuparrow     send prev_week
32029>>>>>      on_key kdownarrow   send next_week
32030>>>>>      property date p_assigned_date public 0
32031>>>>>    end_procedure
32032>>>>>
32032>>>>>    procedure switch // This makes all 42 buttons act as if they are one focus
32033>>>>>      send activate to (btn1(current_object))
32034>>>>>    end_procedure
32035>>>>>    procedure switch_back
32036>>>>>      send activate to (btn6(current_object))
32037>>>>>    end_procedure
32038>>>>>
32038>>>>>    procedure mouse_down
32039>>>>>      local integer current_object#
32040>>>>>      forward send mouse_down
32042>>>>>      move current_object to current_object#
32043>>>>>      delegate set p_current_date to (p_assigned_date(current_object#))
32045>>>>>    end_procedure
32046>>>>>  end_class
32047>>>>>
32047>>>>>  desktop_section
32053>>>>>    object popup_calendar is a ModalPanel
32055>>>>>      set size to 160 250
32056>>>>>      property date    p_current_date  public 0
32058>>>>>      property integer p_current_year  public -1
32060>>>>>      property integer p_current_month public -1
32062>>>>>      property integer pExportState    public 1
32064>>>>>
32064>>>>>      on_key key_ctrl+key_pgup send prev_year
32065>>>>>      on_key key_ctrl+key_pgdn send next_year
32066>>>>>      on_key          key_pgup send prev_month
32067>>>>>      on_key          key_pgdn send next_month
32068>>>>>      on_key key_ctrl+key_d    send go_today
32069>>>>>      on_key kcancel           send cancel
32070>>>>>
32070>>>>>      object cont3d is a container3d
32072>>>>>        set location to 5 5
32073>>>>>        set size to 120 237
32074>>>>>        object textbox_year is a calendar.textbox
32076>>>>>          set location to 5 5
32077>>>>>          set size to 15 30
32078>>>>>          set border_style to border_staticedge
32079>>>>>          procedure display
32081>>>>>            set value to (p_current_year(current_object))
32082>>>>>          end_procedure
32083>>>>>        end_object
32084>>>>>        object dayname_header is a container3d
32086>>>>>          set location to 5 39
32087>>>>>          set size to 15 126
32088>>>>>          set border_style to border_staticedge
32089>>>>>          procedure initialize
32091>>>>>            local integer itm#
32092>>>>>            for itm# from 0 to 6
32098>>>>>>
32098>>>>>              object txt is a calendar.textbox
32100>>>>>                set size to 12 17
32101>>>>>                set location to 0 (itm#*17.6+1)
32102>>>>>                 set value to (left(DayName(itm#+1),3))
32103>>>>>              end_object
32104>>>>>            loop
32105>>>>>>
32105>>>>>          end_procedure
32106>>>>>          send initialize
32107>>>>>        end_object
32108>>>>>        object weeknumber_header is a container3d
32110>>>>>          set location to 24 5
32111>>>>>          set size     to 89 30
32112>>>>>          set border_style to border_staticedge
32113>>>>>          object obj_id_array is an array
32115>>>>>          end_object
32116>>>>>          procedure initialize
32118>>>>>            local integer itm# obj#
32119>>>>>            move (obj_id_array(current_object)) to obj#
32120>>>>>            for itm# from 0 to 5
32126>>>>>>
32126>>>>>              object txt is a textbox
32128>>>>>                set size to 15 30
32129>>>>>                set location to (itm#*15+1) 1
32130>>>>>                set value of obj# item (item_count(obj#)) to current_object
32131>>>>>              end_object
32132>>>>>            loop
32133>>>>>>
32133>>>>>          end_procedure
32134>>>>>          procedure display
32136>>>>>            local integer itm# obj#
32137>>>>>            local date date# last_date#
32137>>>>>            move (obj_id_array(current_object)) to obj#
32138>>>>>            get p_current_date to date#
32139>>>>>            move (FirstDayInMonth(date#)) to date#
32140>>>>>            move (LastDayInMonth(date#)) to last_date#
32141>>>>>            move (date#-DateDayNumber(date#)+1) to date#
32142>>>>>            for itm# from 0 to 5
32148>>>>>>
32148>>>>>              if (itm#*7+date#) le last_date# ;                set value of (integer(value(obj#,itm#))) to (t.calendar.week*string(DateWeekNumber(itm#*7+date#)))
32151>>>>>              else set value of (integer(value(obj#,itm#))) to ""
32153>>>>>            loop
32154>>>>>>
32154>>>>>          end_procedure
32155>>>>>          send initialize
32156>>>>>        end_object
32157>>>>>        object days_grid is a container3d
32159>>>>>          set location to 23 39
32160>>>>>          set size     to 100 127
32161>>>>>          set border_style to border_none
32162>>>>>          object btn_array is an array
32164>>>>>          end_object
32165>>>>>          procedure initialize
32167>>>>>            local integer row# col# button_array#
32168>>>>>            move (btn_array(current_object)) to button_array#
32169>>>>>            for row# from 0 to 5
32175>>>>>>
32175>>>>>              for col# from 0 to 6
32181>>>>>>
32181>>>>>                object btn is a calendar.button
32183>>>>>                  set location to (row#*15) (col#*18)
32184>>>>>                  set value of button_array# item (item_count(button_array#)) to current_object
32185>>>>>                  on_item "" send move_value_out_ok
32186>>>>>                end_object
32187>>>>>              loop
32188>>>>>>
32188>>>>>            loop
32189>>>>>>
32189>>>>>          end_procedure
32190>>>>>          send initialize
32191>>>>>
32191>>>>>          procedure display.iii integer itm# integer day# integer activate#
32193>>>>>            local integer obj# current_day#
32194>>>>>            move (integer(value(btn_array(current_object),itm#))) to obj#
32195>>>>>            move (DateSegment(p_current_date(current_object),DS_DAY)) to current_day#
32196>>>>>            if activate# begin
32198>>>>>              if day# eq current_day# send activate to obj#
32201>>>>>            end
32201>>>>>>
32201>>>>>            else begin
32202>>>>>              if day# begin
32204>>>>>                set value of obj# to day#
32205>>>>>                set visible_state of obj# to true
32206>>>>>                set p_assigned_date of obj# to (DateCompose(day#,p_current_month(current_object),p_current_year(current_object)))
32207>>>>>              end
32207>>>>>>
32207>>>>>              else set visible_state of obj# to false
32209>>>>>            end
32209>>>>>>
32209>>>>>          end_procedure
32210>>>>>
32210>>>>>          procedure display integer activate#
32212>>>>>            local integer first_item# last_item# itm# day# date#
32213>>>>>            get p_current_date to date#
32214>>>>>            move (FirstDayInMonth(date#)) to date#
32215>>>>>            move (DateDayNumber(date#)-1) to first_item#
32216>>>>>            move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32217>>>>>            ifnot activate# begin
32219>>>>>              for itm# from 0 to (first_item#-1)
32225>>>>>>
32225>>>>>                send display.iii itm# 0 0
32226>>>>>              loop
32227>>>>>>
32227>>>>>            end
32227>>>>>>
32227>>>>>            move 1 to day#
32228>>>>>            for itm# from first_item# to last_item#
32234>>>>>>
32234>>>>>              send display.iii itm# day# activate#
32235>>>>>              increment day#
32236>>>>>            loop
32237>>>>>>
32237>>>>>            ifnot activate# begin
32239>>>>>              for itm# from (last_item#+1) to 41
32245>>>>>>
32245>>>>>                send display.iii itm# 0 0
32246>>>>>              loop
32247>>>>>>
32247>>>>>            end
32247>>>>>>
32247>>>>>          end_procedure
32248>>>>>        end_object
32249>>>>>        object txt_month is a calendar.textbox
32251>>>>>          set size to 12 27
32252>>>>>          set location to 25 185
32253>>>>>          set value to t.calendar.month
32254>>>>>        end_object
32255>>>>>        object btn1 is a button
32257>>>>>          set size to 12 12
32258>>>>>          set location to 40 185
32259>>>>>          on_item "" send prev_month
32260>>>>>          set bitmap to "prev.bmp"
32261>>>>>          procedure switch_back
32263>>>>>            send display_main
32264>>>>>          end_procedure
32265>>>>>        end_object
32266>>>>>        object btn2 is a button
32268>>>>>          set size to 12 12
32269>>>>>          set location to 40 200
32270>>>>>          on_item "" send next_month
32271>>>>>          set bitmap to "next.bmp"
32272>>>>>        end_object
32273>>>>>        object txt_year is a calendar.textbox
32275>>>>>          set size to 12 27
32276>>>>>          set location to 70 185
32277>>>>>          set value to t.calendar.year
32278>>>>>        end_object
32279>>>>>        object btn3 is a button
32281>>>>>          set size to 12 12
32282>>>>>          set location to 85 185
32283>>>>>          on_item "" send prev_year
32284>>>>>          set bitmap to "prev.bmp"
32285>>>>>        end_object
32286>>>>>        object btn4 is a button
32288>>>>>          set size to 12 12
32289>>>>>          set location to 85 200
32290>>>>>          on_item "" send next_year
32291>>>>>          set bitmap to "next.bmp"
32292>>>>>        end_object
32293>>>>>      end_object
32294>>>>>      object btn5 is a button
32296>>>>>        set size to 14 60
32297>>>>>        set location to 129 115
32298>>>>>        on_item t.calendar.ok send move_value_out_ok
32299>>>>>      end_object
32300>>>>>      object btn6 is a button
32302>>>>>        set size to 14 60
32303>>>>>        set location to 129 182
32304>>>>>        on_item t.calendar.cancel send cancel
32305>>>>>        procedure switch
32307>>>>>          send display_main
32308>>>>>        end_procedure
32309>>>>>      end_object
32310>>>>>      procedure next_year
32312>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32313>>>>>        send display_main
32314>>>>>      end_procedure
32315>>>>>      procedure prev_year
32317>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32318>>>>>        send display_main
32319>>>>>      end_procedure
32320>>>>>      procedure next_month
32322>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32323>>>>>        send display_main
32324>>>>>      end_procedure
32325>>>>>      procedure prev_month
32327>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32328>>>>>        send display_main
32329>>>>>      end_procedure
32330>>>>>      procedure next_week
32332>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,1))
32333>>>>>        send display_main
32334>>>>>      end_procedure
32335>>>>>      procedure prev_week
32337>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,-1))
32338>>>>>        send display_main
32339>>>>>      end_procedure
32340>>>>>      procedure next_day
32342>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,1))
32343>>>>>        send display_main
32344>>>>>      end_procedure
32345>>>>>      procedure prev_day
32347>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,-1))
32348>>>>>        send display_main
32349>>>>>      end_procedure
32350>>>>>      procedure go_today
32352>>>>>        local date date#
32353>>>>>        sysdate4 date#
32354>>>>>        set p_current_date to date#
32355>>>>>        send display_main
32356>>>>>      end_procedure
32357>>>>>      property integer invoking_object_id public 0
32359>>>>>      procedure OnChange date date#
32361>>>>>        local integer focus# dm#
32362>>>>>        get invoking_object_id to focus#
32363>>>>>        if focus# gt desktop begin
32365>>>>>          get delegation_mode of focus# to dm#
32366>>>>>          set delegation_mode of focus# to no_delegate_or_error
32367>>>>>          send NotifyPopupCalendarChange to focus# date#
32368>>>>>          set delegation_mode of focus# to dm#
32369>>>>>        end
32369>>>>>>
32369>>>>>      end_procedure
32370>>>>>      procedure display
32372>>>>>        local integer date# month# year#
32373>>>>>        get p_current_date to date#
32374>>>>>        send OnChange date#
32375>>>>>        move (DateSegment(date#,DS_YEAR)) to year#
32376>>>>>        move (DateSegment(date#,DS_MONTH)) to month#
32377>>>>>        if (p_current_year(current_object)<>year# or p_current_month(current_object)<>month#) begin
32379>>>>>          set p_current_year to year#
32380>>>>>          set p_current_month to month#
32381>>>>>          set value to (t.calendar.calendar_popup+", "+MonthName(month#))
32382>>>>>          send display to (textbox_year(cont3d(current_object)))
32383>>>>>          send display to (weeknumber_header(cont3d(current_object)))
32384>>>>>          send display to (days_grid(cont3d(current_object))) 0
32385>>>>>        end
32385>>>>>>
32385>>>>>      end_procedure
32386>>>>>      procedure display_main
32388>>>>>        send display
32389>>>>>        send display to (days_grid(cont3d(current_object))) 1
32390>>>>>      end_procedure
32391>>>>>      procedure popup_no_export
32393>>>>>        set pExportState to false
32394>>>>>        send popup
32395>>>>>        set pExportState to true
32396>>>>>      end_procedure
32397>>>>>
32397>>>>>      procedure popup_group
32399>>>>>        local integer focus#
32400>>>>>        local date date#
32400>>>>>        move (focus(desktop)) to focus#
32401>>>>>        set invoking_object_id to focus#
32402>>>>>        get value of focus# item current to date#
32403>>>>>        ifnot (integer(date#)) move (dSysdate()) to date#
32406>>>>>        move (Date2to4(date#)) to date#
32407>>>>>        set p_current_date to date#
32408>>>>>        send display
32409>>>>>        forward send popup_group
32411>>>>>        send display to (days_grid(cont3d(current_object))) 1
32412>>>>>      end_procedure
32413>>>>>
32413>>>>>      procedure move_value_out
32415>>>>>        local integer focus# dm# margin# datatype#
32416>>>>>        if (pExportState(current_object)) begin
32418>>>>>          get invoking_object_id to focus#
32419>>>>>          if focus# gt desktop begin
32421>>>>>            get delegation_mode of focus# to dm#
32422>>>>>            set delegation_mode of focus# to no_delegate_or_error
32423>>>>>            send NotifyPopupCalendarSelect to focus# (p_current_date(current_object))
32424>>>>>            get form_margin of focus# item current to margin#
32425>>>>>            get form_datatype of focus# item current to datatype#
32426>>>>>            set delegation_mode of focus# to dm#
32427>>>>>            if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to (p_current_date(current_object))
32430>>>>>            else             set value of focus# item current to (Date4to2(p_current_date(current_object)))
32432>>>>>            set item_changed_state of focus# item current to true
32433>>>>>          end
32433>>>>>>
32433>>>>>        end
32433>>>>>>
32433>>>>>      end_procedure
32434>>>>>
32434>>>>>      procedure move_value_out_ok
32436>>>>>        send move_value_out
32437>>>>>        send deactivate
32438>>>>>      end_procedure
32439>>>>>
32439>>>>>      procedure request_popup
32441>>>>>        local integer focus# type# dm#
32442>>>>>        move (focus(desktop)) to focus#
32443>>>>>        if focus# gt desktop begin
32445>>>>>          get delegation_mode of focus# to dm#
32446>>>>>          set delegation_mode of focus# to no_delegate_or_error
32447>>>>>          get form_datatype of focus# item current to type#
32448>>>>>          if (type#=date_window or type#=mask_date_window) send popup
32451>>>>>          set delegation_mode of focus# to dm#
32452>>>>>        end
32452>>>>>>
32452>>>>>      end_procedure
32453>>>>>    end_object
32454>>>>>  end_desktop_section
32456>>>>>  // If the procedure below was not defined "for BaseClass" its symbolic
32456>>>>>  // substitute would become negative (because located on the desktop). This
32456>>>>>  // would result in the toolbar object not being able to handle it. Therefore:
32456>>>>>  procedure request_popup_calendar for BaseClass
32457>>>>>    send request_popup to (popup_calendar(current_object))
32458>>>>>  end_procedure
32459>>>>>  procedure popup_calendar_no_export
32460>>>>>    send popup_no_export to (popup_calendar(current_object))
32461>>>>>  end_procedure
32462>>>>>  register_procedure Add_Toolbar_Button_Bitmap string bmp# string Tip# string StHlp# integer msg# integer obj#
32462>>>>>  procedure Add_Calendar_tbButton integer oTb#
32463>>>>>    send Add_Toolbar_Button_Bitmap to oTb# "DfCalend.bmp" t.calendar.calendar_popup t.calendar.Activate msg_request_popup_calendar
32464>>>>>  end_procedure
32465>>>>> function s.calendar returns integer // Backwards compatible!!
32466>>>>>   function_return (popup_calendar(current_object))
32467>>>>> end_function
32468>>>>>
32468>>>>>// Karl,
32468>>>>>// Structure is as follows,
32468>>>>>//
32468>>>>>// //put this code in the top portion of the view code or in the program
32468>>>>>// code.
32468>>>>>//
32468>>>>>// Type SystemTime
32468>>>>>//   field SystemTime.iYear As Word
32468>>>>>//   field SystemTime.iMonth As Word
32468>>>>>//   field SystemTime.iDayOfWeek As Word
32468>>>>>//   field SystemTime.iDay As Word
32468>>>>>//   field SystemTime.iHour As Word
32468>>>>>//   field SystemTime.iMinute As Word
32468>>>>>//   field SystemTime.iSecond As Word
32468>>>>>//   field SystemTime.iMilliseconds As Word
32468>>>>>// End_Type
32468>>>>>//
32468>>>>>// external_function GetSystemTime "GetSystemTime" kernel32.dll Pointer lpGST Returns VOID_TYPE
32468>>>>>//
32468>>>>>// //put this code in an onClick or wherever
32468>>>>>// procedure onclick
32468>>>>>//   local integer iRetVal
32468>>>>>//   local string TimeData
32468>>>>>//   local pointer GST
32468>>>>>//
32468>>>>>//   ZeroType SystemTime to TimeData
32468>>>>>//   getAddress from TimeData to GST
32468>>>>>//
32468>>>>>//   move (GetSystemTime(GST)) to iRetVal
32468>>>>>// end_procedure
32468>>>>>//
32468>>>>>// To extract the data from the Structure after calling the function use
32468>>>>>// the getbuff command as follows:
32468>>>>>//
32468>>>>>// getbuff from TimeData as SystemTime.IVAL to var
32468>>>>>//
32468>>>>>// where IVAL is one of the vars such as iYear or iDay, etc.
32468>>>>>//
32468>>>>>// OLIVER NELSON
32468>>>>>//
32468>>>>>//
32468>>>
32468>>>//AB-StoreTopEnd
32468>>>
32468>>>//AB-IgnoreStart
32468>>>
32468>>>Use DFAllEnt.pkg
32468>>>
32468>>>
32468>>>//AB-IgnoreEnd
32468>>>
32468>>>CD_Popup_Object oCalendar is a dbModalPanel
32487>>>
32487>>>    //AB-StoreTopStart
32487>>>    on_key kcancel           send cancel
32488>>>    //AB-StoreTopEnd
32488>>>
32488>>>    Set Border_Style to Border_Normal
32489>>>    Set Caption_Bar to FALSE
32490>>>    Set Label to "Ÿ­¢ àì, 2001"
32491>>>    Set Size to 98 123
32492>>>    Set Location to 10 22
32493>>>    Set Color to clWhite
32494>>>
32494>>>    //AB-DDOStart
32494>>>
32494>>>
32494>>>    //AB-DDOEnd
32494>>>
32494>>>    Object Container3d1 is a Container3d
32496>>>        Set Size to 88 135
32497>>>        Set Location to -2 -1
32498>>>        Set Color to clWhite
32499>>>        Set Border_Style to Border_None
32500>>>        Object Grid2 is a Grid
32502>>>
32502>>>            //AB-StoreTopStart
32502>>>            property date    p_current_date     public 0
32504>>>            property integer p_current_year     public -1
32506>>>            property integer p_current_month    public -1
32508>>>            property integer p_selected_day     public -1
32510>>>            property integer pExportState       public 1
32512>>>            property integer invoking_object_id public 0
32514>>>            
32514>>>            Set Border_Style To BORDER_NONE
32515>>>            Set header_visible_state To False
32516>>>            set select_mode to no_select
32517>>>            Set Gridline_mode To GRID_VISIBLE_NONE
32518>>>            
32518>>>            on_key Key_F1 Send Help
32519>>>            on_key key_ctrl+key_pgup send prev_year
32520>>>            on_key key_ctrl+key_pgdn send next_year
32521>>>            on_key          key_pgup send prev_month
32522>>>            on_key          key_pgdn send next_month
32523>>>            on_key key_enter         send move_value_out
32524>>>            on_key key_ctrl+key_d    send go_today
32525>>>            
32525>>>            //AB-StoreTopEnd
32525>>>
32525>>>            Set Color to clWhite
32526>>>            Set CurrentCellColor to clWhite
32527>>>            Set CurrentCellTextColor to clWhite
32528>>>            Set Size to 61 145
32529>>>            Set Location to 30 1
32530>>>            Set Resize_Column_state to FALSE
32531>>>
32531>>>            Set Line_Width to 7 0
32532>>>
32532>>>            Set Form_Width    item 0 to 18
32533>>>            Set Header_Label  item 0 to "­"
32534>>>            
32534>>>            Set Form_Width    item 1 to 18
32535>>>            Set Header_Label  item 1 to "‚â"
32536>>>            
32536>>>            Set Form_Width    item 2 to 18
32537>>>            Set Header_Label  item 2 to "‘à"
32538>>>            
32538>>>            Set Form_Width    item 3 to 18
32539>>>            Set Header_Label  item 3 to "—â"
32540>>>            
32540>>>            Set Form_Width    item 4 to 18
32541>>>            Set Header_Label  item 4 to "â"
32542>>>            
32542>>>            Set Form_Width    item 5 to 18
32543>>>            Set Header_Label  item 5 to "‘¡"
32544>>>            
32544>>>            Set Form_Width    item 6 to 18
32545>>>            Set Header_Label  item 6 to "‚á"
32546>>>            
32546>>>
32546>>>            //AB-StoreStart
32546>>>            
32546>>>            procedure go_today
32548>>>                Date date#
32549>>>                sysdate4 date#
32550>>>                set p_current_date to date#
32551>>>                Send Update_Calendar
32552>>>            end_procedure
32553>>>            
32553>>>            procedure next_month
32555>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32556>>>                Send Update_Calendar
32557>>>            end_procedure
32558>>>            
32558>>>            procedure prev_month
32560>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32561>>>                Send Update_Calendar
32562>>>            end_procedure
32563>>>            
32563>>>            procedure next_year
32565>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32566>>>                Send Update_Calendar
32567>>>            end_procedure
32568>>>            
32568>>>            procedure prev_year
32570>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32571>>>                Send Update_Calendar
32572>>>            end_procedure
32573>>>            
32573>>>            Procedure Activate
32575>>>                Date date#
32576>>>                Forward Send Activate
32578>>>                Set current_item to (p_selected_day(Self))
32579>>>            End_Procedure
32580>>>            
32580>>>            Procedure Update_Calendar
32582>>>                Set Dynamic_Update_State To False
32583>>>                send Fill_List
32584>>>                Set Dynamic_Update_State To True
32585>>>                // Send Update_Label
32585>>>                Set current_item to (p_selected_day(Self))
32586>>>                Send Date_Changing to (oYear(Container3d2(self)))
32587>>>                Send Date_Changing to (oMonth(Container3d2(self)))
32588>>>            End_Procedure
32589>>>            
32589>>>            Procedure Fill_List
32591>>>                Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
32592>>>                Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
32592>>>                Date dToday
32592>>>                Send Delete_Data
32593>>>            
32593>>>                Get p_current_date to date#
32594>>>            
32594>>>                SysDate4 dToday
32595>>>                move (DateSegment(dToday,DS_DAY)) to cur_day#
32596>>>                move (DateSegment(dToday,DS_MONTH)) to cur_month#
32597>>>                move (DateSegment(dToday,DS_YEAR)) to cur_year#
32598>>>            
32598>>>                move (DateSegment(date#,DS_DAY)) to sel_day#
32599>>>                move (DateSegment(date#,DS_MONTH)) to sel_month#
32600>>>                move (DateSegment(date#,DS_YEAR)) to sel_year#
32601>>>                Set p_current_month To sel_month#
32602>>>                Set p_current_year To sel_year#
32603>>>            
32603>>>                move (FirstDayInMonth(date#)) to date#
32604>>>                move (DateDayNumber(date#)-1) to first_item#
32605>>>                move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32606>>>                move (DateIncrement(date#,DS_Month,-1)) To prevdate#
32607>>>                move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
32608>>>            
32608>>>                If (first_item# > 0) Begin
32610>>>                    Move (first_item#-1) to day#
32611>>>                    For iFor from 0 to (first_item#-1)
32617>>>>
32617>>>                        Send Add_Item msg_move_value_out (prev_last#-day#)
32618>>>                        Set Entry_State Item iFor To False
32619>>>                        Set ItemTextColor Item iFor To clGray
32620>>>                        Decrement day#
32621>>>                    Loop
32622>>>>
32622>>>                End
32622>>>>
32622>>>            
32622>>>                Move 1 To day#
32623>>>                For iFor from first_item# to last_item#
32629>>>>
32629>>>                    Send Add_Item Msg_Move_Value_Out day#
32630>>>                    Set Entry_State Item iFor To False
32631>>>                    If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Set Form_Bitmap Item iFor To "cdate.bmp"
32634>>>                    If Day# eq sel_day# Set p_selected_day To iFor
32637>>>                    Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
32638>>>                    Set form_datatype item iFor To mask_numeric_window
32639>>>                    Set form_Mask item iFor To "## "
32640>>>                    Increment day#
32641>>>                Loop
32642>>>>
32642>>>            
32642>>>                move (DateIncrement(date#,DS_Month,1)) To nextdate#
32643>>>                move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
32644>>>            
32644>>>                If (last_item# < 41) Begin
32646>>>                    Move 1 to day#
32647>>>                    For iFor from (last_item#+1) to 41
32653>>>>
32653>>>                        Send Add_Item msg_move_value_out day#
32654>>>                        Set Entry_State Item iFor To False
32655>>>                        Set ItemTextColor Item iFor To clGray
32656>>>                        Increment day#
32657>>>                    Loop
32658>>>>
32658>>>                End
32658>>>>
32658>>>            
32658>>>            End_Procedure
32659>>>            
32659>>>            Procedure Help
32661>>>                Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<PgUp>, <PgDn> - Select year.\n\n(c) 2001, SCR. Special thanks to Sture Andersen.") ("Help on Calendar")
32662>>>            End_Procedure
32663>>>            
32663>>>            procedure mouse_click integer window integer char_pos
32665>>>                Send Move_Value_Out
32666>>>                forward send mouse_click window char_pos
32668>>>            end_procedure
32669>>>            
32669>>>            Procedure Move_Value_Out
32671>>>                Integer iYear iMonth iDay iItm
32672>>>                Date Date# next_date# prev_date#
32672>>>                Get Current_Item To iItm
32673>>>                If (pExportState(Self)) Begin
32675>>>                    Get Value Item iItm To iDay
32676>>>                    Get p_current_month to iMonth
32677>>>                    Get p_current_year  to iYear
32678>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32679>>>            
32679>>>                    If ((iItm>27)and(iDay<15)) Begin
32681>>>                        Move (DateCompose(1,iMonth,iYear)) To next_date#
32682>>>                        move (DateIncrement(next_date#,DS_Month,1)) To next_date#
32683>>>                        move (DateSegment(next_date#,DS_MONTH)) to iMonth
32684>>>                        move (DateSegment(next_date#,DS_YEAR)) to iYear
32685>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32686>>>                    End
32686>>>>
32686>>>                    If ((iItm<7)and(iDay>20)) Begin
32688>>>                        Move (DateCompose(1,iMonth,iYear)) To prev_date#
32689>>>                        move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
32690>>>                        move (DateSegment(prev_date#,DS_MONTH)) to iMonth
32691>>>                        move (DateSegment(prev_date#,DS_YEAR)) to iYear
32692>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32693>>>                    End
32693>>>>
32693>>>            
32693>>>                    Send Export_Date date#
32694>>>                End
32694>>>>
32694>>>            End_Procedure
32695>>>            
32695>>>            Procedure Export_Date date date#
32697>>>                local integer focus# dm# margin# datatype#
32698>>>                get invoking_object_id to focus#
32699>>>            
32699>>>                if focus# gt desktop begin
32701>>>                     get delegation_mode of focus# to dm#
32702>>>                     set delegation_mode of focus# to no_delegate_or_error
32703>>>                     get form_margin of focus# item current to margin#
32704>>>                     get form_datatype of focus# item current to datatype#
32705>>>                     set delegation_mode of focus# to dm#
32706>>>                     if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
32709>>>                     else             set value of focus# item current to (Date4to2(date#))
32711>>>                     set item_changed_state of focus# item current to true
32712>>>                end
32712>>>>
32712>>>                Send Close_Calendar
32713>>>            End_Procedure
32714>>>            //AB-StoreEnd
32714>>>
32714>>>        End_Object    // Grid2
32715>>>
32715>>>        Object Textbox2 is a Textbox
32717>>>            Set Label to "­"
32718>>>            Set Auto_Size_State to FALSE
32719>>>            Set Transparent_State to TRUE
32720>>>            Set Color to clWhite
32721>>>            Set TextColor to clNavy
32722>>>            Set Location to 19 4
32723>>>            Set Size to 10 15
32724>>>
32724>>>            //AB-StoreStart
32724>>>                                        
32724>>>            Set Label To (left(t.calendar.Monday,2))
32725>>>            //AB-StoreEnd
32725>>>
32725>>>        End_Object    // Textbox2
32726>>>
32726>>>        Object Textbox3 is a Textbox
32728>>>            Set Label to "‚â"
32729>>>            Set Auto_Size_State to FALSE
32730>>>            Set Transparent_State to TRUE
32731>>>            Set Color to clWhite
32732>>>            Set TextColor to clNavy
32733>>>            Set Location to 19 22
32734>>>            Set Size to 10 12
32735>>>
32735>>>            //AB-StoreStart
32735>>>                                        
32735>>>            Set Label To (left(t.calendar.Tuesday,2))
32736>>>            //AB-StoreEnd
32736>>>
32736>>>        End_Object    // Textbox3
32737>>>
32737>>>        Object Textbox4 is a Textbox
32739>>>            Set Label to "‘à"
32740>>>            Set Auto_Size_State to FALSE
32741>>>            Set Transparent_State to TRUE
32742>>>            Set Color to clWhite
32743>>>            Set TextColor to clNavy
32744>>>            Set Location to 19 39
32745>>>            Set Size to 10 15
32746>>>
32746>>>            //AB-StoreStart
32746>>>                                        
32746>>>            Set Label To (left(t.calendar.Wednesday,2))
32747>>>            //AB-StoreEnd
32747>>>
32747>>>        End_Object    // Textbox4
32748>>>
32748>>>        Object Textbox5 is a Textbox
32750>>>            Set Label to "—â"
32751>>>            Set Auto_Size_State to FALSE
32752>>>            Set Transparent_State to TRUE
32753>>>            Set Color to clWhite
32754>>>            Set TextColor to clNavy
32755>>>            Set Location to 19 57
32756>>>            Set Size to 10 17
32757>>>
32757>>>            //AB-StoreStart
32757>>>                                        
32757>>>            Set Label To (left(t.calendar.Thursday,2))
32758>>>            //AB-StoreEnd
32758>>>
32758>>>        End_Object    // Textbox5
32759>>>
32759>>>        Object Textbox6 is a Textbox
32761>>>            Set Label to "â"
32762>>>            Set Auto_Size_State to FALSE
32763>>>            Set Transparent_State to TRUE
32764>>>            Set Color to clWhite
32765>>>            Set TextColor to clNavy
32766>>>            Set Location to 19 76
32767>>>            Set Size to 10 17
32768>>>
32768>>>            //AB-StoreStart
32768>>>                                        
32768>>>            Set Label To (left(t.calendar.Friday,2))
32769>>>            //AB-StoreEnd
32769>>>
32769>>>        End_Object    // Textbox6
32770>>>
32770>>>        Object Textbox7 is a Textbox
32772>>>            Set Label to "‘¡"
32773>>>            Set Auto_Size_State to FALSE
32774>>>            Set Transparent_State to TRUE
32775>>>            Set Color to clWhite
32776>>>            Set TextColor to clNavy
32777>>>            Set Location to 19 91
32778>>>            Set Size to 10 18
32779>>>
32779>>>            //AB-StoreStart
32779>>>                                        
32779>>>            Set Label To (left(t.calendar.Saturday,2))
32780>>>            //AB-StoreEnd
32780>>>
32780>>>        End_Object    // Textbox7
32781>>>
32781>>>        Object Textbox8 is a Textbox
32783>>>            Set Label to "‚á"
32784>>>            Set Auto_Size_State to FALSE
32785>>>            Set Transparent_State to TRUE
32786>>>            Set Color to clWhite
32787>>>            Set TextColor to clNavy
32788>>>            Set Location to 19 109
32789>>>            Set Size to 10 17
32790>>>
32790>>>            //AB-StoreStart
32790>>>                                        
32790>>>            Set Label To (left(t.calendar.Sunday,2))
32791>>>            //AB-StoreEnd
32791>>>
32791>>>        End_Object    // Textbox8
32792>>>
32792>>>        Object LineControl1 is a LineControl
32794>>>            Set Line_Style to lnSINGLE
32795>>>            Set Size to 1 116
32796>>>            Set Location to 28 4
32797>>>
32797>>>            //AB-StoreStart
32797>>>                                        
32797>>>            //AB-StoreEnd
32797>>>
32797>>>        End_Object    // LineControl1
32798>>>
32798>>>        Object Container3d2 is a Container3d
32800>>>            Set Size to 18 131
32801>>>            Set Location to 1 1
32802>>>            Set Color to clNavy
32803>>>            Set Border_Style to Border_None
32804>>>            Object oRght is a BitmapContainer
32806>>>                Set Size to 10 14
32807>>>                Set Location to 4 105
32808>>>                Set Bitmap to "rght.bmp"
32809>>>                Set Border_Style to Border_None
32810>>>
32810>>>                //AB-StoreStart
32810>>>                Procedure Mouse_Down
32812>>>                    Send Next_Month to Grid2
32813>>>                End_Procedure
32814>>>                //AB-StoreEnd
32814>>>
32814>>>            End_Object    // oRght
32815>>>
32815>>>            Object oLeft is a BitmapContainer
32817>>>                Set Size to 10 14
32818>>>                Set Location to 4 3
32819>>>                Set Bitmap to "lft.bmp"
32820>>>                Set Border_Style to Border_None
32821>>>
32821>>>                //AB-StoreStart
32821>>>                Procedure Mouse_Down
32823>>>                    Send Prev_Month to Grid2
32824>>>                End_Procedure
32825>>>                //AB-StoreEnd
32825>>>
32825>>>            End_Object    // oLeft
32826>>>
32826>>>            Object oMonth is a Textbox
32828>>>
32828>>>                //AB-StoreTopStart
32828>>>                Property integer piSelected_Month public 0
32830>>>                //AB-StoreTopEnd
32830>>>
32830>>>                Set Label to "January"
32831>>>                Set Auto_Size_State to FALSE
32832>>>                Set Transparent_State to TRUE
32833>>>                Set Color to clWhite
32834>>>                Set TextColor to clWhite
32835>>>                Set Location to 4 23
32836>>>                Set Size to 10 43
32837>>>                Set FontWeight to 800
32838>>>                Set Justification_Mode to jMode_Center
32839>>>
32839>>>                //AB-StoreStart
32839>>>                                    
32839>>>                Procedure Mouse_Down
32841>>>                    Integer iState
32842>>>                    Get Visible_State of oSelectYear to iState
32843>>>                    If (iState) Send OnKillFocus to oSelectYear
32846>>>                    Send Popup to oSelectMonth
32847>>>                End_Procedure
32848>>>                
32848>>>                Procedure pSelectJan
32850>>>                    Set Label to t.calendar.january
32851>>>                    Set piSelected_Month to 1
32852>>>                    Send Adjust_Calendar
32853>>>                End_Procedure
32854>>>                Procedure pSelectFeb
32856>>>                    Set Label to t.calendar.february
32857>>>                    Set piSelected_Month to 2
32858>>>                    Send Adjust_Calendar
32859>>>                End_Procedure
32860>>>                Procedure pSelectMar
32862>>>                    Set Label to t.calendar.march
32863>>>                    Set piSelected_Month to 3
32864>>>                    Send Adjust_Calendar
32865>>>                End_Procedure
32866>>>                Procedure pSelectApr
32868>>>                    Set Label to t.calendar.april
32869>>>                    Set piSelected_Month to 4
32870>>>                    Send Adjust_Calendar
32871>>>                End_Procedure
32872>>>                Procedure pSelectMay
32874>>>                    Set Label to t.calendar.may
32875>>>                    Set piSelected_Month to 5
32876>>>                    Send Adjust_Calendar
32877>>>                End_Procedure
32878>>>                Procedure pSelectJun
32880>>>                    Set Label to t.calendar.june
32881>>>                    Set piSelected_Month to 6
32882>>>                    Send Adjust_Calendar
32883>>>                End_Procedure
32884>>>                Procedure pSelectJul
32886>>>                    Set Label to t.calendar.july
32887>>>                    Set piSelected_Month to 7
32888>>>                    Send Adjust_Calendar
32889>>>                End_Procedure
32890>>>                Procedure pSelectAug
32892>>>                    Set Label to t.calendar.august
32893>>>                    Set piSelected_Month to 8
32894>>>                    Send Adjust_Calendar
32895>>>                End_Procedure
32896>>>                Procedure pSelectSep
32898>>>                    Set Label to t.calendar.september
32899>>>                    Set piSelected_Month to 9
32900>>>                    Send Adjust_Calendar
32901>>>                End_Procedure
32902>>>                Procedure pSelectOct
32904>>>                    Set Label to t.calendar.october
32905>>>                    Set piSelected_Month to 10
32906>>>                    Send Adjust_Calendar
32907>>>                End_Procedure
32908>>>                Procedure pSelectNov
32910>>>                    Set Label to t.calendar.november
32911>>>                    Set piSelected_Month to 11
32912>>>                    Send Adjust_Calendar
32913>>>                End_Procedure
32914>>>                Procedure pSelectDec
32916>>>                    Set Label to t.calendar.december
32917>>>                    Set piSelected_Month to 12
32918>>>                    Send Adjust_Calendar
32919>>>                End_Procedure
32920>>>                
32920>>>                Object oSelectMonth is a FloatingPopupMenu
32922>>>                    Send Add_Item msg_pSelectJan t.calendar.january
32923>>>                    Send Add_Item msg_pSelectFeb t.calendar.february
32924>>>                    Send Add_Item msg_pSelectMar t.calendar.march
32925>>>                    Send Add_Item msg_pSelectApr t.calendar.april
32926>>>                    Send Add_Item msg_pSelectMay t.calendar.may
32927>>>                    Send Add_Item msg_pSelectJun t.calendar.june
32928>>>                    Send Add_Item msg_pSelectJul t.calendar.july
32929>>>                    Send Add_Item msg_pSelectAug t.calendar.august
32930>>>                    Send Add_Item msg_pSelectSep t.calendar.september
32931>>>                    Send Add_Item msg_pSelectOct t.calendar.october
32932>>>                    Send Add_Item msg_pSelectNov t.calendar.november
32933>>>                    Send Add_Item msg_pSelectDec t.calendar.december
32934>>>                End_Object
32935>>>                
32935>>>                Procedure Adjust_Calendar
32937>>>                    Date date#
32938>>>                    Integer iDay iMonth iYear iItm
32938>>>                    Set Visible_State to false
32939>>>                    Set Visible_State to true
32940>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32941>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32942>>>                    Get piSelected_Month to iMonth
32943>>>                    Get Label of oYear to iYear
32944>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32945>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32946>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32947>>>                End_Procedure
32948>>>                
32948>>>                Procedure Activating
32950>>>                    Forward Send Activating
32952>>>                    Send Date_Changing
32953>>>                End_Procedure
32954>>>                
32954>>>                Procedure Date_Changing
32956>>>                    Set Visible_State to false
32957>>>                    Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
32958>>>                    Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
32959>>>                    Set Visible_State to true
32960>>>                End_Procedure
32961>>>                
32961>>>                
32961>>>                //AB-StoreEnd
32961>>>
32961>>>            End_Object    // oMonth
32962>>>
32962>>>            Object oYear is a Textbox
32964>>>                Set Label to "2001"
32965>>>                Set Transparent_State to TRUE
32966>>>                Set Color to clWhite
32967>>>                Set TextColor to clWhite
32968>>>                Set Location to 4 77
32969>>>                Set Size to 10 18
32970>>>                Set FontWeight to 800
32971>>>
32971>>>                //AB-StoreStart
32971>>>                                                    
32971>>>                Procedure Mouse_Down
32973>>>                    String sVal
32974>>>                    Get Label to sVal
32975>>>                    Set Value of oSelectYear item 0 to sVal
32976>>>                    Set Visible_State of oSelectYear to True
32977>>>                    Send Activate to (oSelectYear(Self))
32978>>>                End_Procedure
32979>>>                
32979>>>                Procedure Activating
32981>>>                    Forward Send Activating
32983>>>                    Send Date_Changing
32984>>>                End_Procedure
32985>>>                
32985>>>                Procedure Date_Changing
32987>>>                    Set Visible_State to false
32988>>>                    Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
32989>>>                    Set Visible_State to true
32990>>>                End_Procedure
32991>>>                //AB-StoreEnd
32991>>>
32991>>>            End_Object    // oYear
32992>>>
32992>>>            Object oSelectYear is a Form
32994>>>
32994>>>                //AB-StoreTopStart
32994>>>                Set Visible_State To False
32995>>>                //AB-StoreTopEnd
32995>>>
32995>>>                Set Size to 10 24
32996>>>                Set Location to 4 75
32997>>>                Set Color to clWhite
32998>>>                Set TextColor to clNavy
32999>>>                Set Form_Border Item 0 to Border_Normal
33000>>>
33000>>>                //AB-StoreStart
33000>>>                                                    
33000>>>                On_Key Key_Enter Send OnKillFocus
33001>>>                On_Key Key_Escape Send OnKillFocus
33002>>>                
33002>>>                Procedure SetFontWeight
33004>>>                    Set Form_FontWeight item 0 to 800
33005>>>                End_Procedure
33006>>>                
33006>>>                Procedure OnKillFocus
33008>>>                    String sVal
33009>>>                    Integer iMonth iDay iYear iItm
33009>>>                    Date date#
33009>>>                    Get Value item 0 to sVal
33010>>>                    Set Visible_State of oYear to false
33011>>>                    Set Label of oYear to sVal
33012>>>                    Set Visible_State of oYear to true
33013>>>                    Set Visible_State to false
33014>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
33015>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
33016>>>                    Get piSelected_Month of oMonth to iMonth
33017>>>                    Get Value item 0 to iYear
33018>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
33019>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
33020>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
33021>>>                End_Procedure
33022>>>                
33022>>>                Send SetFontWeight
33023>>>                //AB-StoreEnd
33023>>>
33023>>>            End_Object    // oSelectYear
33024>>>
33024>>>
33024>>>            //AB-StoreStart
33024>>>                            
33024>>>            Procedure Mouse_Down
33026>>>                Integer iState
33027>>>                Get Visible_State of oSelectYear to iState
33028>>>                If (iState) Send OnKillFocus to oSelectYear
33031>>>            End_Procedure
33032>>>            
33032>>>            //AB-StoreEnd
33032>>>
33032>>>        End_Object    // Container3d2
33033>>>
33033>>>
33033>>>        //AB-StoreStart
33033>>>                            
33033>>>        //AB-StoreEnd
33033>>>
33033>>>    End_Object    // Container3d1
33034>>>
33034>>>    Object BitmapContainer3 is a BitmapContainer
33036>>>        Set Size to 9 19
33037>>>        Set Location to 88 3
33038>>>        Set Color to clWhite
33039>>>        Set Bitmap to "cdate.bmp"
33040>>>        Set Border_Style to Border_None
33041>>>
33041>>>        //AB-StoreStart
33041>>>        Procedure Mouse_Down
33043>>>            Send go_today to (Grid2(Container3d1(Self)))
33044>>>            Send Adjust_Label to oToday
33045>>>        End_Procedure
33046>>>        //AB-StoreEnd
33046>>>
33046>>>    End_Object    // BitmapContainer3
33047>>>
33047>>>    Object oToday is a Textbox
33049>>>        Set Label to "Today: 01.01.2001"
33050>>>        Set Auto_Size_State to FALSE
33051>>>        Set Color to clWhite
33052>>>        Set Location to 88 22
33053>>>        Set Size to 8 73
33054>>>        Set FontWeight to 800
33055>>>
33055>>>        //AB-StoreStart
33055>>>        Procedure Mouse_Down
33057>>>            Send go_today to (Grid2(Container3d1(Self)))
33058>>>            Send Adjust_Label
33059>>>        End_Procedure
33060>>>        
33060>>>        Procedure Adjust_Label
33062>>>            date date#
33063>>>            SysDate4 date#
33064>>>            Set Visible_State To false
33065>>>            Set Label         to (t.calendar.today+": "+String(date#))
33066>>>            Set Visible_State To true
33067>>>        End_Procedure
33068>>>        
33068>>>        Procedure Activating
33070>>>            Forward Send Activating
33072>>>            Send Adjust_Label
33073>>>        End_Procedure
33074>>>        //AB-StoreEnd
33074>>>
33074>>>    End_Object    // oToday
33075>>>
33075>>>
33075>>>    //AB-StoreStart
33075>>>                
33075>>>    procedure popup
33077>>>        local integer focus# icItm iYear iMonth
33078>>>        local date date#
33078>>>        move (focus(desktop)) to focus#
33079>>>        set invoking_object_id of (Grid2(Container3d1(self))) to focus#
33080>>>        get value of focus# item current to date#
33081>>>        ifnot (integer(date#)) sysdate date#
33084>>>        move (Date2to4(date#)) to date#
33085>>>        set p_current_date of (Grid2(Container3d1(self))) to date#
33086>>>        send fill_list to (Grid2(Container3d1(self)))
33087>>>        move (DateSegment(date#,DS_YEAR)) to iYear
33088>>>        move (DateSegment(date#,DS_MONTH)) to iMonth
33089>>>        Set Label To (MonthName(iMonth)+', '+String(iYear))
33090>>>        forward send popup
33092>>>    end_procedure
33093>>>    
33093>>>    Procedure Close_Calendar
33095>>>        Send Exit
33096>>>    End_Procedure
33097>>>    //AB-StoreEnd
33097>>>
33097>>>CD_End_Object    // oCalendar
33099>>>>
33099>>>
33099>>>
33099>>>//AB-StoreStart
33099>>>    
33099>>>    
33099>>>//AB-StoreEnd
33099>>>
33099>>>//AB/ End_Object    // prj
33099>Use Dates.Utl
33099>Use Roundfn.Fnc
INCLUDING FILE: ROUNDFN.FNC
33099>>>// ===========================================================================
33099>>>//
33099>>>// The ROUND_NUMBER global function has been designed to return the rounded
33099>>>// value of a given 'numeric' argument at a specified rounding precision.
33099>>>//
33099>>>// ---------------------------------------------------------------------------
33099>>>// This version dispenses with the use of powers (10 ^ n) to perform the
33099>>>// necessary calculations.  It uses a string handling technique instead.
33099>>>// ---------------------------------------------------------------------------
33099>>>//
33099>>>// The function requires two arguments, as follows:-
33099>>>//
33099>>>// (a) The numeric value to be rounded, where the range of valid values is
33099>>>//     +/- 99,999,999,999,999.99999999.
33099>>>//
33099>>>// (b) The rounding precision required.  This must be an integer value in the
33099>>>//     range -13 to +8.  If a value outside this range is used, the nearest
33099>>>//     threshold value is substituted.
33099>>>//
33099>>>//     Values in the range +1 to +7 perform rounding on the decimal part of
33099>>>//     the number.  A value of +8 will perform no rounding at all.  A zero
33099>>>//     value will round to the nearest whole number.  Values -1 to -13 will
33099>>>//     round progressively to the left of the decimal point (a frequent
33099>>>//     requirement in financial reporting).
33099>>>//
33099>>>// If the result of the rounding produces a value outside the valid numeric
33099>>>// range (+/- 99,999,999,999,999.99999999) then a zero value is returned.
33099>>>//
33099>>>// Assumptions:-  The only assumptions made have been that the range of
33099>>>// numeric values and the limit of eight decimal places are unlikely to change
33099>>>// in the forseeable future.
33099>>>//
33099>>>// Examples:-
33099>>>//
33099>>>//  1st Argument      2nd Argument   Return Value
33099>>>//  ------------      ------------   ------------
33099>>>//  123456.87654321         8         123456.87654321
33099>>>//  123456.87654321         2         123456.88
33099>>>// -123456.87654321         2        -123456.88
33099>>>//  123456.98765432         0         123457
33099>>>// -123456.98765432        -1        -123460
33099>>>//  123456.98765432        -2         123500
33099>>>//  123456.98765432        -3         123000
33099>>>//  987654                 -4         990000
33099>>>//  987654                 -5        1000000
33099>>>//  987654                 -6        1000000
33099>>>//  987654                 -7              0
33099>>>//
33099>>>// ===========================================================================
33099>>>
33099>>>
33099>>>Function Round_Number GLOBAL number nVal integer iRnd returns Number
33100>>>
33100>>>  Local Number nAdj
33101>>>
33101>>>  Move 10000000000000 to nAdj
33102>>>
33102>>>  // If the rounding precision falls in the range 0 to 8, then return:-
33102>>>
33102>>>  If (iRnd >= 0) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 / (Number(Left(nAdj, ((iRnd + 1) ;      min 9)))) + nVal / (Number(Left(nAdj, (9 - (iRnd min 8))))) ;        * (Number(Left(nAdj, (9 - (iRnd min 8))))))
33105>>>
33105>>>  // Else, where the rounding precision is in the range -1 to -5, return:-
33105>>>
33105>>>  If (iRnd >= -5) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(Left(nAdj, (Abs(iRnd) + 9)))) ;        * (Number(Left(nAdj, (Abs(iRnd) + 9)))))
33108>>>
33108>>>  // Else, where the rounding precision is in the range -6 to -13, return:-
33108>>>
33108>>>  Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(nAdj)) / (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))) ;        * (Number(nAdj)) * (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))))
33109>>>
33109>>>End_Function
33110>Use Connect.Dg
INCLUDING FILE: CONNECT.DG
33110>>>//AB/ Project Connect
33110>>>//AB/ Object prj is a Dialog_Project
33110>>>//AB/     Set ProjectName to "Connect"
33110>>>//AB/     Set ProjectFileName to "Connect.dg"
33110>>>
33110>>>// Project Object Structure
33110>>>//   Connect is a BasicPanelSub
33110>>>//     BitmapContainer1 is a BitmapContainerSub
33110>>>//     Textbox5 is a TextBoxSub
33110>>>//     ComboForm2 is a ComboFormSub
33110>>>//     Textbox6 is a TextBoxSub
33110>>>//     Form4 is a FormSub
33110>>>//     Textbox7 is a TextBoxSub
33110>>>//     Form5 is a FormSub
33110>>>//     Textbox8 is a TextBoxSub
33110>>>//     Form6 is a FormSub
33110>>>//     CheckBox1 is a CheckBoxSub
33110>>>//     oOK_bn is a ButtonSub
33110>>>//     oCancel_bn is a ButtonSub
33110>>>
33110>>>// Register all objects
33110>>>Register_Object BitmapContainer1
33110>>>Register_Object CheckBox1
33110>>>Register_Object ComboForm2
33110>>>Register_Object Connect
33110>>>Register_Object Form4
33110>>>Register_Object Form5
33110>>>Register_Object Form6
33110>>>Register_Object oCancel_bn
33110>>>Register_Object oOK_bn
33110>>>Register_Object Textbox5
33110>>>Register_Object Textbox6
33110>>>Register_Object Textbox7
33110>>>Register_Object Textbox8
33110>>>
33110>>>
33110>>>
33110>>>//AB-StoreTopStart
33110>>>
33110>>>///#INCLUDE
33110>>>Use mertech.inc
INCLUDING FILE: MERTECH.INC
33110>>>>>USE UI
33110>>>>>
#REM -----------------------------------------------
#REM MERTECH DATA SYSTEMS INC. - WWW.MERTECHDATA.COM
#REM MERTECH.INC VERSION 2.1.9
#REM -----------------------------------------------
33110>>>>>
33110>>>>>
33110>>>>>
33110>>>>>
33110>>>>>
33110>>>>>//
33110>>>>>//
33110>>>>>//
33110>>>>>//
33110>>>>>//
33110>>>>>//-----------------------------------------------
33110>>>>>// SELECT_COLUMNS_FIND <FILE> <START> THRU <END>
33110>>>>>// SELECT_COLUMNS_FIND <FILE> <FIELD>
33110>>>>>// This command will issue a properly commands to define the FETCH attribute status
33110>>>>>// for file fields.
33110>>>>>//
33110>>>>>//------------------------------------------------------------------------------
33110>>>>>// RESET_FETCH_FIELDS <FILE NAME>|<FILE NUMBER> <DF_FETCH_TRUE>|<DF_FETCH_FALSE>
33110>>>>>//
33110>>>>>//
33110>>>>>//-----------------------------
33110>>>>>// SQL_FOR_ONEROW <file number>
33110>>>>>//
33110>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get just
33110>>>>>// one ROW for each DataFlex FIND command issued
33110>>>>>// In this case the DBMS optimizer will generate a query with just one row
33110>>>>>//
33110>>>>>//
33110>>>>>//-------------------------------------------------------------------------------
33110>>>>>// SQL_FOR_SET <file number> MAXROWS <number of rows> CACHE|NOCACHE <return code>
33110>>>>>//
33110>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get a SET of rows.
33110>>>>>// In this case the DBMS optimizer will generate a query with <number of rows> Rows.
33110>>>>>// if CACHE is passed as argument, all these rows will be transfered to ORAFlex and then it will
33110>>>>>// save them in a local CACHE buffer. Just the FIND GT and FIND LT will get local cache.
33110>>>>>// Otherwise, i.e NOCACHE,  ORAFLex won't create a local cache.
33110>>>>>//
33110>>>>>//
33110>>>>>//---------------
33110>>>>>// SQL_SET <stmt>
33110>>>>>//
33110>>>>>//-----------------------------------------
33110>>>>>// SQL_APPEND <stmt1> <stmt2> .... <stmtn>
33110>>>>>//
33110>>>>>//------------
33110>>>>>// SQL_EXECUTE
33110>>>>>//
33110>>>>>//----------------------------------------------------------------------
33110>>>>>// LOCK_TABLE [<FILE NAME>|<FILE NUMBER> <FILE NAME>|<FILE NUMBER> ....]
33110>>>>>//
33110>>>>>// LOCK_TABLE will lock the entire table specified as an argument
33110>>>>>// This command will start a new transaction if it still wasn't done.
33110>>>>>// LOCK_TABLE won't lock the other opened tables or the current rows present
33110>>>>>// in their buffers it will be necessary issue a REREAD command to Lock the current
33110>>>>>// rows and then atualize their buffers
33110>>>>>//
33110>>>>>//
33110>>>>>//-------------------------------------------
33110>>>>>// SQL_CHECK_TABLE <SCHEMA NAME> <TABLE NAME>
33110>>>>>//
33110>>>>>//-------------------------------
33110>>>>>// CREATE_TD_FILE  DFTRUE|DFFALSE
33110>>>>>// SET A GLOBAL ATTRIBUTE TO CREATE THE TD FILE AFTER CLOSING AN OPENED FILE
33110>>>>>//
33110>>>>>//-------------------------------------------------
33110>>>>>// OPEN_INT <DATAFLEX FILE NAME>
33110>>>>>// OPEN_INT <PHYSICAL NAME> AS <DATAFLEX FILE NAME>
33110>>>>>//
33110>>>>>// OPEN_INT will check if the OPEN done is an OPEN AS. IF it's true, OPEN_INT
33110>>>>>// will try to open an intermediate file, if there is one. Otherwise OPEN_INT
33110>>>>>// will issue a OPEN command
33110>>>>>// OPEN_INT must be inserted into FMAC file instead OPEN COMMAND
33110>>>>>//
33110>>>>>//=========================================================================================================
33110>>>>>// SELECT STUFFS
33110>>>>>//--------------
33110>>>>>// SQL_SET_STMT OF FILENAME|FILENUMBER TO <STATMENT1>
33110>>>>>//
33110>>>>>// SQL_APPEND_ OF FILENAME|FILENUMBER TO <STATMENT1> <STATMENT2> ... <STATMENTn>
33110>>>>>//
33110>>>>>//
33110>>>>>// SQL_APPEND_UPDCOL_STMT OF FILENAME|FILENUMBER VALUE EXPRESSION WITH FIELD1 FIELD2 ... FIELDN
33110>>>>>//
33110>>>>>// SQL_PREPARE_STMT OF FILENAME|FILENUMBER
33110>>>>>//
33110>>>>>// SQL_BIND_COLUMN [FILENAME|FILENUMBER] [FIELDNAME|FIELDNUMBER]
33110>>>>>//
33110>>>>>// SQL_BINDCOLUMNS_STMT OF FILENAME|FILENUMBER TO <COLUMN1> <COLUMN2> ... <COLUMNn>
33110>>>>>//
33110>>>>>// SQL_EXECUTE_STMT OF FILENAME|FILENUMBER
33110>>>>>//
33110>>>>>// SQL_COMMIT_STMT
33110>>>>>//
33110>>>>>// SQL_ROLLBACK_STMT
33110>>>>>//
33110>>>>>// SQL_FETCH_NEXT_ROW OF FILENAME|FILENUMBER
33110>>>>>//
33110>>>>>//
33110>>>>>//
33110>>>>>//
33110>>>>>// CALL_STORED_PROCEDURE will call a stored procedure passing arguments
33110>>>>>//
33110>>>>>// FORMAT TO USE : CALL_STORED_PROCEDURE <STORED_PROC_NAME> [PASSING <ARG1> <ARG2> ....<ARGn>]
33110>>>>>//
33110>>>>>//
33110>>>>>//---------------------------------------------------------------------------------------------
33110>>>>>// CALL_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
33110>>>>>// CALL_STORED_FUNCTION will call an Oracle stored function passing arguments
33110>>>>>//
33110>>>>>//---------------------------
33110>>>>>// SQL_TEXT_MESSAGE <MESSAGE>
33110>>>>>// Writes a message inside driver log trace file if this is activated
33110>>>>>//
33110>>>>>//-----------------------------------------------------
33110>>>>>// OUTPUT_INT_FILE FOR <FILE NUMBER> TO <INT FILE NAME>
33110>>>>>// Generating the INT file
33110>>>>>//
33110>>>>>// -----------------------
33110>>>>>// SQL_ERROR_MESSAGE <VAR>
33110>>>>>// SQL_ERROR_MESSAGE retrieve the native error message issued by server for error number 25000
33110>>>>>
33110>>>>>
33110>>>>>//=======================================================================================
33110>>>>>// SQLFlex Commands
33110>>>>>//-----------------
33110>>>>>//
33110>>>>>//-----------------------
33110>>>>>// SQLFlex_REVISION <VAR>
33110>>>>>// Retrieves SQLFlex revision
33110>>>>>//
33110>>>>>//-------------------------------------
33110>>>>>// SET_DATABASE_NAME TO <DATABASE NAME>
33110>>>>>// Sets current database
33110>>>>>//
33110>>>>>//---------------------------
33110>>>>>// GET_DATABASE_NAME TO <VAR>
33110>>>>>// Gets name of current database
33110>>>>>//
33110>>>>>//----------------------------------
33110>>>>>// SET_SCHEMA_NAME TO <SCHEMA NAME>
33110>>>>>// Sets current schema name
33110>>>>>//
33110>>>>>//-------------------------
33110>>>>>// GET_SCHEMA_NAME TO <VAR>
33110>>>>>// Gets current schema name
33110>>>>>//
33110>>>>>//--------------------------------
33110>>>>>// SQL_USEDATABASE <DATABASE NAME>
33110>>>>>// Specifies the current Database
33110>>>>>//
33110>>>>>//----------------------------
33110>>>>>// SET_CURRENT_SERVER TO <VAR>
33110>>>>>// Set the current logged server
33110>>>>>//
33110>>>>>//----------------------------
33110>>>>>// GET_CURRENT_SERVER TO <VAR>
33110>>>>>// Retrieves the current logged server
33110>>>>>//
33110>>>>>//-----------------------------
33110>>>>>// SET_HOST_NAME TO <HOST NAME>
33110>>>>>// Defines current host name
33110>>>>>//
33110>>>>>//-----------------------
33110>>>>>// GET_HOST_NAME TO <VAR>
33110>>>>>// Retrieves the current host name
33110>>>>>//
33110>>>>>//---------------------------------------------------------------
33110>>>>>// LOGIN_SQLFLEX <SERVER NAME> <USER NAME> <PASSWORD> <HOST NAME>
33110>>>>>// Specifies host name during login process
33110>>>>>//
33110>>>>>// SQL_CANCEL_QUERY_STMT
33110>>>>>//
33110>>>>>//========================================
33110>>>>>// SQL SERVER Stored Procedure Call engine
33110>>>>>//----------------------------------------
33110>>>>>//
33110>>>>>//
33110>>>>>
33110>>>>>//
33110>>>>>//--------------------------------------------------------------------------------------------------------------
33110>>>>>// CALL_SQLSERVER_PROCEDURE <procedure name> PASSING <VALUE1|VARIABLE1> [SQLOUT] <VALUE2|VARIABLE2> [SQLOUT] ...
33110>>>>>//
33110>>>>>// Executes a stored procedure. SQLOUT will be used to indicate that the stored procedure
33110>>>>>// returns a parameter. The matching parameter in the stored proceudre must have been created with
33110>>>>>// the keyword OUTPUT. Call all procedures that doesn't returns any query with this syntax
33110>>>>>//
33110>>>>>//
33110>>>>>//
33110>>>>>//-----------------------------------------------------------------------------
33110>>>>>
33110>>>>>
33110>>>>>//=============================================================================
33110>>>>>// ORAFlex Commands
33110>>>>>//-----------------
33110>>>>>//----------------------------
33110>>>>>// ORAFlex_REVISION <VARIABLE>
33110>>>>>// Retrieves ORAFlex revision
33110>>>>>//
33110>>>>>//---------------------------------
33110>>>>>// KEEP_FILES_OPEN OF <SERVER NAME>
33110>>>>>// Keeps all files opened even during a LOGOUT
33110>>>>>//
33110>>>>>//-----------------------------------------------
33110>>>>>// SET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
33110>>>>>// Defines the maximum number of cursors that ORAFlex will be allowed for using
33110>>>>>//
33110>>>>>//-----------------------------------------------
33110>>>>>// GET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
33110>>>>>// Retrieves the maximum number of cursors allowed for ORAFlex use
33110>>>>>//
33110>>>>>//---------------------------------------------
33110>>>>>// GET_OPENED_CURSORS OF <SERVER NAME> TO <VAR>
33110>>>>>// Retrieves the number of opened cursors
33110>>>>>//
33110>>>>>//-----------------------------------------------
33110>>>>>// ACTIVATE_TIME_STAMP OF <SERVER NAME> TO ON|OFF
33110>>>>>// Activates Time stamp for date columns
33110>>>>>//
33110>>>>>//----------------------------------------------------------------------------------------------------
33110>>>>>// CALL_ORACLE_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
33110>>>>>// CALL_ORACLE_STORED_FUNCTION will call an Oracle stored function passing arguments
33110>>>>>//
33110>>>>>//-----------------------------------------------------------------------------
33110>>>>>
33110>>>>>//=============================================================================
33110>>>>>// BUFFER save stuffs
33110>>>>>//-------------------
33110>>>>>
33110>>>>>//-------------------------------------------------------
33110>>>>>// SQL_SAVE_BUFFER_BEGIN OF <FILE NUMBER> TO <CACHE SIZE>
33110>>>>>// Initialize the BUFFER buffer
33110>>>>>//
33110>>>>>//---------------------------------
33110>>>>>// SQL_SAVE_BUFFER OF <FILE NUMBER>
33110>>>>>// Moves field buffer values to cache buffer
33110>>>>>//-------------------------------------
33110>>>>>// SQL_SAVE_BUFFER_END OF <FILE NUMBER>
33110>>>>>// Save rows that remains in cache
33110>>>>>//-----------------------------------------------------------------------------
33110>>>>>
33110>>>
33110>>>//AB-StoreTopEnd
33110>>>
33110>>>//AB-IgnoreStart
33110>>>
33110>>>Use Panel.Sub
33110>>>Use Bitmap.Sub
33110>>>Use Txtbox.Sub
33110>>>Use Cmbfrm.Sub
33110>>>Use Form.Sub
33110>>>Use Chkbox.Sub
33110>>>Use Button.Sub
33110>>>
33110>>>
33110>>>//AB-IgnoreEnd
33110>>>
33110>>>Object Connect is a BasicPanelSub
33112>>>
33112>>>    //AB-StoreTopStart
33112>>>
33112>>>    //AB-StoreTopEnd
33112>>>
33112>>>    Set Sysmenu_Icon to FALSE
33113>>>    Set Minimize_Icon to FALSE
33114>>>    Set Label to "Login"
33115>>>    Set Size to 105 230
33116>>>    Set Location to 20 37
33117>>>
33117>>>    //AB-DDOStart
33117>>>
33117>>>
33117>>>    //AB-DDOEnd
33117>>>
33117>>>    Object BitmapContainer1 is a BitmapContainerSub
33119>>>        Set Size to 21 23
33120>>>        Set Location to 4 4
33121>>>        Set Bitmap to "Login1.bmp"
33122>>>        Set Border_Style to Border_None
33123>>>        Set Bitmap_Style to Bitmap_Center
33124>>>        Set Dialog_Caption to "Select a bitmap file"
33125>>>
33125>>>        //AB-StoreStart
33125>>>
33125>>>
33125>>>
33125>>>
33125>>>        //AB-StoreEnd
33125>>>
33125>>>    End_Object    // BitmapContainer1
33126>>>
33126>>>    Object Textbox5 is a TextBoxSub
33128>>>        Set Label to "Driver:"
33129>>>        Set FontSize to 4 0
33130>>>        Set Location to 6 34
33131>>>        Set Size to 13 40
33132>>>        Set TypeFace to "MS Sans Serif"
33133>>>        Set Enabled_State to TRUE
33134>>>    End_Object    // Textbox5
33135>>>
33135>>>    Object ComboForm2 is a ComboFormSub
33137>>>
33137>>>        //AB-StoreTopStart
33137>>>
33137>>>        Set CapsLock_State to True
33138>>>
33138>>>        //AB-StoreTopEnd
33138>>>
33138>>>        Set Size to 13 85
33139>>>        Set Location to 6 76
33140>>>        Set Label_Col_Offset to 2
33141>>>        Set Label_Justification_Mode to jMode_Right
33142>>>
33142>>>        //AB-StoreStart
33142>>>        Procedure Combo_Fill_List
33144>>>                Local String Availdrv## TempDrv##
33145>>>                Local Integer HowMany i p1## p2##
33145>>>
33145>>>                get_profile_string "WorkSpaces" "CurrentWorkspace" to AvailDrv##
33148>>>                If AvailDrv## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to AvailDrv##
33151>>>                insert "WorkSpaces\" in AvailDrv## at 1
33153>>>                get_profile_string AvailDrv## "AvailableDrivers" to AvailDrv##
33156>>>
33156>>>                Move Availdrv## to Tempdrv##
33157>>>                Repeat
33157>>>>
33157>>>                    Replace "|" in Tempdrv## With ""
33159>>>                    [Found] Increment HowMany
33160>>>                Until [Finderr]
33162>>>
33162>>>                Send Combo_add_Item ""
33163>>>
33163>>>                If HowMany lt 1 Begin
33165>>>                    If Availdrv## ne "" Send Combo_Add_Item (UpperCase(Availdrv##))
33168>>>                End
33168>>>>
33168>>>                Else Begin
33169>>>                    For i From 0 to HowMany
33175>>>>
33175>>>                        If i eq 0 Move 1 to p1##
33178>>>                        Else Begin
33179>>>                            Move ((Pos("|",Availdrv##))+1) to p1##
33180>>>                            Replace "|" in Availdrv## With ","
33182>>>                        End
33182>>>>
33182>>>                        Move ((Pos("|",Availdrv##))) to p2##
33183>>>                        Send Combo_Add_Item (UpperCase(Mid(Availdrv##,(p2##-p1##),p1##)))
33184>>>                    Loop
33185>>>>
33185>>>                End
33185>>>>
33185>>>        End_Procedure
33186>>>
33186>>>        Set Allow_Blank_state to True
33187>>>
33187>>>
33187>>>
33187>>>        //AB-StoreEnd
33187>>>
33187>>>    End_Object    // ComboForm2
33188>>>
33188>>>    Object Textbox6 is a TextBoxSub
33190>>>        Set Label to "Server:"
33191>>>        Set FontSize to 4 0
33192>>>        Set Location to 22 34
33193>>>        Set Size to 13 40
33194>>>        Set TypeFace to "MS Sans Serif"
33195>>>        Set Enabled_State to TRUE
33196>>>    End_Object    // Textbox6
33197>>>
33197>>>    Object Form4 is a FormSub
33199>>>        Set Size to 13 93
33200>>>        Set Location to 22 76
33201>>>        Set Label_Col_Offset to 2
33202>>>        Set Label_Justification_Mode to jMode_Right
33203>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33204>>>    End_Object    // Form4
33205>>>
33205>>>    Object Textbox7 is a TextBoxSub
33207>>>        Set Label to "User Name:"
33208>>>        Set FontSize to 4 0
33209>>>        Set Location to 38 34
33210>>>        Set Size to 13 40
33211>>>        Set TypeFace to "MS Sans Serif"
33212>>>        Set Enabled_State to TRUE
33213>>>    End_Object    // Textbox7
33214>>>
33214>>>    Object Form5 is a FormSub
33216>>>        Set Size to 13 93
33217>>>        Set Location to 38 76
33218>>>        Set Label_Col_Offset to 2
33219>>>        Set Label_Justification_Mode to jMode_Right
33220>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33221>>>    End_Object    // Form5
33222>>>
33222>>>    Object Textbox8 is a TextBoxSub
33224>>>        Set Label to "Password:"
33225>>>        Set FontSize to 4 0
33226>>>        Set Location to 54 34
33227>>>        Set Size to 13 40
33228>>>        Set TypeFace to "MS Sans Serif"
33229>>>        Set Enabled_State to TRUE
33230>>>    End_Object    // Textbox8
33231>>>
33231>>>    Object Form6 is a FormSub
33233>>>        Set Size to 13 93
33234>>>        Set Location to 54 76
33235>>>        Set Label_Col_Offset to 2
33236>>>        Set Label_Justification_Mode to jMode_Right
33237>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33238>>>
33238>>>        //AB-StoreStart
33238>>>        Set Password_State Item 0 to True
33239>>>
33239>>>        //AB-StoreEnd
33239>>>
33239>>>    End_Object    // Form6
33240>>>
33240>>>    Object CheckBox1 is a CheckBoxSub
33242>>>        Set Label to "Save Password"
33243>>>        Set Size to 10 66
33244>>>        Set Location to 73 76
33245>>>        Set Status_Help to "Remember The Password at Next Login"
33246>>>    End_Object    // CheckBox1
33247>>>
33247>>>    Object oOK_bn is a ButtonSub
33249>>>        Set Label to "Co&nnect"
33250>>>        Set Default_State to TRUE
33251>>>        Set Bitmap to "mcr.bmp"
33252>>>        Set Size to 28 33
33253>>>        Set Location to 9 184
33254>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33255>>>
33255>>>        //AB-StoreStart
33255>>>        Procedure OnClick
33257>>>            Set LoginOk to True
33258>>>            Send Stop_Modal_ui
33259>>>        End_Procedure
33260>>>        Set Status_Help to "Connect"
33261>>>        //AB-StoreEnd
33261>>>
33261>>>    End_Object    // oOK_bn
33262>>>
33262>>>    Object oCancel_bn is a ButtonSub
33264>>>        Set Label to "&Cancel"
33265>>>        Set Bitmap to "exit2.bmp"
33266>>>        Set Size to 28 32
33267>>>        Set Location to 39 184
33268>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33269>>>
33269>>>        //AB-StoreStart
33269>>>
33269>>>        ON_KEY KENTER SEND Exit_Application to (Connect(Current_Object))
33270>>>
33270>>>        Procedure OnClick
33272>>>            Set LoginOk to False
33273>>>            Send Exit_Application to (Connect(Current_Object))
33274>>>        End_Procedure
33275>>>
33275>>>        Set Status_Help to "Close Application"
33276>>>
33276>>>
33276>>>        //AB-StoreEnd
33276>>>
33276>>>    End_Object    // oCancel_bn
33277>>>
33277>>>
33277>>>    //AB-StoreStart
33277>>>
33277>>>    Set Modal_State to True
33278>>>
33278>>>    // Now is WorkspaceAware
33278>>>
33278>>>    ON_KEY KENTER SEND OnClick to (oOk_bn(Current_Object))
33279>>>    ON_KEY KSAVE_RECORD SEND OK
33280>>>    ON_KEY KCANCEL SEND EXIT_APPLICATION
33281>>>    ON_KEY KCLOSE_PANEL SEND EXIT_APPLICATION
33282>>>
33282>>>    Set Locate_Mode to Center_On_Screen
33283>>>    Set Exit_Application_Local_State to False
33284>>>    Set Exit_MSG to Exit
33285>>>    Set Description_State to True
33286>>>
33286>>>    Property Integer LoginOk public false
33288>>>
33288>>>    External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;        Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
33289>>>
33289>>>    Function Network_User_Name Returns String
33291>>>        Local String sName sLength
33292>>>        Local Pointer lpName_Addr lpLength_Addr
33292>>>        Local Integer iRetval
33292>>>
33292>>>        Movestr (Repeat (Character (0), 255)) To sName
33293>>>>
33293>>>        GetAddress Of sName To lpName_Addr
33294>>>        Movestr (DwordToBytes (255)) To sLength
33295>>>>
33295>>>        GetAddress Of sLength To lpLength_Addr
33296>>>
33296>>>        Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
33297>>>>
33297>>>
33297>>>        If iRetval Eq 0 Function_Return (CString (sName))
33300>>>        Else Function_Return "User Unknown"
33302>>>    End_Function // Network_User_Name
33303>>>
33303>>>    Function fsCrypto String lsWay String lsOld Returns String
33305>>>        Local String lsNew lsTemp
33306>>>        Local Integer liCount
33306>>>           For liCount From 1 to (Length(lsOld))
33312>>>>
33312>>>               Mid lsOld to lsTemp 1 liCount
33315>>>>
33315>>>               If ((Uppercase(lsWay)) eq 'FORWARD') Begin
33317>>>               If ((Ascii(lsTemp) = 255)) Move (Character(32)) to lsTemp
33320>>>               Else Move (Character(Ascii(lsTemp)+1)) to lsTemp
33322>>>               End
33322>>>>
33322>>>               Else Begin
33323>>>                   If ((Uppercase(lsWay)) eq 'BACKWARD') Begin
33325>>>                       If ((Ascii(lsTemp) = 32)) Move (Character(255)) to lsTemp
33328>>>                       Else Move (Character(Ascii(lsTemp)-1)) to lsTemp
33330>>>                   End
33330>>>>
33330>>>               End
33330>>>>
33330>>>               Append lsNew lsTemp
33331>>>           Loop
33332>>>>
33332>>>        Function_Return (lsNew)
33333>>>    End_Function
33334>>>
33334>>>    Procedure Activating
33336>>>        Local String LoginDriver## LoginServer## LoginUserid## LoginPassword##
33337>>>        Local String LastLogin## LoginSeq##
33337>>>        Local Integer SavePassword##
33337>>>
33337>>>        Forward Send Activating
33339>>>
33339>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33342>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33345>>>        insert "WorkSpaces\" in LastLogin## at 1
33347>>>        Append LastLogin## "\" (Module_Name(Self)) "\LastLogin"
33350>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33353>>>
33353>>>        If "|" in LoginSeq## move (left(LoginSeq##,(pos("|",LoginSeq##) -1))) to LoginDriver##
33356>>>        Else Move LoginSeq## to LoginDriver##
33358>>>        get_profile_string LastLogin## "LoginServer"  to LoginServer##
33361>>>        get_profile_string LastLogin## "LoginUserId"  to LoginUserId##
33364>>>        get_profile_string LastLogin## "SavePassword" to SavePassword##
33367>>>        If LoginUserId## eq "" Move (Network_User_Name(Current_Object)) to LoginUserId##
33370>>>
33370>>>        If (((UpperCase(LoginDriver##)) eq "DATAFLEX") or (LoginDriver## eq "")) Begin
33372>>>                Set Value of (ComboForm2(Current_Object)) Item 0 to ""
33373>>>                Set Value of (Form4(Current_Object))      Item 0 to ""
33374>>>        End
33374>>>>
33374>>>        Else Begin
33375>>>            Set Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
33376>>>            Set Value of (Form4(Current_Object))      Item 0 to LoginServer##
33377>>>        End
33377>>>>
33377>>>        Set Value of (Form5(Current_Object))      Item 0 to LoginUserID##
33378>>>        Set Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
33379>>>        If (SavePassword##) Begin
33381>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33382>>>            get_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to LoginPassword##
33386>>>            Set Value of (Form6(Current_Object))      Item 0 to (fsCrypto(Self,"backward",LoginPassword##))
33387>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33388>>>        End
33388>>>>
33388>>>    End_Procedure
33389>>>
33389>>>    Function LoginUser Returns Integer
33391>>>        Integer SavePassword## Size## PasswordOk
33392>>>        String LoginDriver## LoginServer## LoginUserid## LoginPassword## LoginSeq## LastLogin##
33392>>>        String lsLoginDate lsHH lsMM lsSS sDepartment
33392>>>        Integer liOpenCursors
33392>>>
33392>>>        Send Popup_Modal
33393>>>
33393>>>        Get Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
33394>>>        Get Value of (Form4(Current_Object))      Item 0 to LoginServer##
33395>>>        Get Value of (Form5(Current_Object))      Item 0 to LoginUserID##
33396>>>        Get Value of (Form6(Current_Object))      Item 0 to LoginPassword##
33397>>>        Get Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
33398>>>        Set Value of (Form6(Current_Object))      Item 0 to ""
33399>>>
33399>>>    //tolis 03/02/2004
33399>>>        If ((LoginDriver## <> "") and (UpperCase(LoginDriver##)<>"DATAFLEX"))  begin
33401>>>    //        send ignore_error to (error_info_object(current_object)) 25000
33401>>>    //        send ignore_error to (error_info_object(current_object)) 4255
33401>>>    //        send ignore_error to (error_info_object(current_object)) 12293
33401>>>    //        login LoginServer## LoginUserId## LoginPassword## LoginDriver##
33401>>>    //        send trap_error to (error_info_object(current_object)) 25000
33401>>>    //        send trap_error to (error_info_object(current_object)) 4255
33401>>>    //        send trap_error to (error_info_object(current_object)) 12293
33401>>>    //        If LastErr eq 25000 Begin
33401>>>    //            Error LastErr "Invalid Login Information"
33401>>>    //            Set LoginOk to False
33401>>>    //            Send Exit_Application
33401>>>    //        End
33401>>>    //        If LastErr eq 4255 Begin
33401>>>    //            Error LastErr "Invalid Driver Name"
33401>>>    //            Set LoginOk to False
33401>>>    //            Send Exit_Application
33401>>>    //        End
33401>>>    //        If LastErr eq 12293 Begin
33401>>>    //            Error LastErr "(IBM CLI)Database alias name or Database name not found"
33401>>>    //            Set LoginOk to False
33401>>>    //           Send Exit_Application
33401>>>    //      End
33401>>>            Set LoginOk to True
33402>>>    //        If (UpperCase(LoginDriver##) = "ORA_DRV") Begin
33402>>>    //            GET_MAX_OPEN_CURSORS of LoginServer## to liOpenCursors
33402>>>    //            If (liOpenCursors <> 0) SET_MAX_OPEN_CURSORS of LoginServer## to (liOpenCursors+2)
33402>>>    //        End
33402>>>        End
33402>>>>
33402>>>        Else Begin
33403>>>            Set LoginOk to True
33404>>>            Open "Users" as Users
INCLUDING FILE: USERS.FD
33406>>>            Move "DATAFLEX" To LoginDriver##
33407>>>            Move "" to LoginServer##
33408>>>            File_Size Users to Size##
33411>>>            If Size## ne 0 Begin
33413>>>                 Clear Users
33414>>>                 Move LoginUSerId##   to Users.Login_Id
33415>>>                 Find eq Users by Index.1
33416>>>>
33416>>>                 [Finderr] Begin
33418>>>>
33418>>>                    Error 25000 "Unknown User"
33419>>>>
33419>>>                    Set LoginOk to False
33420>>>                    Get LoginOk to PasswordOk
33421>>>                    Function_Return PasswordOk
33422>>>                 End
33422>>>>
33422>>>                 [Found] Begin
33424>>>>
33424>>>                    If (LoginPassword## ne Users.Password) Begin
33426>>>                        Error 25000 "Invalid Password"
33427>>>>
33427>>>                        Set LoginOk to False
33428>>>                        Get LoginOk to PasswordOk
33429>>>                        Function_Return PasswordOk
33430>>>                    End
33430>>>>
33430>>>                    Else Move Users.Departm_Code to sDepartment
33432>>>                    Move (Trim(sDepartment)) to sDepartment
33433>>>                 End
33433>>>>
33433>>>            End
33433>>>>
33433>>>            Close Users
33434>>>
33434>>>
33434>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33434>>>    //            Integer bFileExists
33434>>>    //            Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33434>>>    //            If (NOT(bFileExists)) Begin
33434>>>
33434>>>    //                Get Get_File_Exists  "C:\UsrLogin.txt" To bFileExists
33434>>>    //                If (bFileExists) Begin
33434>>>
33434>>>    ////                        If Size## ne 0 Begin
33434>>>
33434>>>    //                            Local String ss1 ss2 ss3 ss4
33434>>>    //                            Local String dd1 dd2 dd3 dd4
33434>>>    //                            Move '' to dd1
33434>>>    //                            Move '' to dd2
33434>>>    //                            Move '' to dd3
33434>>>    //                            Move '' to dd4
33434>>>
33434>>>    //                            Direct_Input Channel 8 "C:\UsrLogin.txt"
33434>>>    //                            Readln Channel 8 ss1 ss2 ss3 ss4
33434>>>    //                            While (Not(Seqeof))
33434>>>    //                                Move (Trim(ss1)) to ss1
33434>>>    //                                Move (Trim(ss2)) to ss2
33434>>>    //                                Move (Trim(ss3)) to ss3
33434>>>    //                                Move (Trim(ss4)) to ss4
33434>>>    //                                Append dd1 '"' ss1 '"'
33434>>>    //                                Append dd2 '"' ss2 '"'
33434>>>    //                                Append dd3 '"' ss3 '"'
33434>>>    //                                Append dd4 '"' ss4 '"'
33434>>>    //                                Login dd1 dd2 dd3 dd4
33434>>>    //                                Readln Channel 8 ss1 ss2 ss3 ss4
33434>>>    //                            Loop
33434>>>
33434>>>
33434>>>    ////                            // Only Filmnet Users Log on to SQL
33434>>>    ////                            If (sDepartment='FILMNET') Begin
33434>>>    ////                                ////// 20/06/2001 js Allagh apo Oracle se SQL server
33434>>>    ////                                ////// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33434>>>    ////                                login '192.168.128.5'   'sa'    ''   'SQL_DRV'
33434>>>    ////                                login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33434>>>    ////                            End
33434>>>    ////                            Else login '192.168.128.5'      'sa'    ''   'SQL_DRV'
33434>>>    ////                            //Else login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33434>>>
33434>>>    ////                        End
33434>>>    ////                        Else Begin
33434>>>    ////                            ////// 20/06/2001 js Allagh apo Oracle se SQL server
33434>>>    ////                            ///// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33434>>>    ////                            login '192.168.128.5'       'sa'    ''   'SQL_DRV'
33434>>>    ////                            //login '192.168.128.5'   'EPGDNS'    'DNS'   'SQL_DRV'
33434>>>    ////                            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33434>>>    ////                        End
33434>>>
33434>>>
33434>>>    //                End
33434>>>
33434>>>    //            End
33434>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33434>>>
33434>>>
33434>>>
33434>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33434>>>            //*Integer bFileExists
33434>>>            //*Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33434>>>            //*If (NOT(bFileExists)) Begin
33434>>>            //*    If Size## ne 0 Begin
33434>>>            //*        // Only Filmnet Users Log on to SQL
33434>>>            //*        If (sDepartment='FILMNET') Begin
33434>>>            //*            login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33434>>>            //*            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33434>>>            //*        End
33434>>>            //*        Else login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33434>>>            //*    End
33434>>>            //*    Else Begin
33434>>>            //*        login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33434>>>            //*        login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33434>>>            //*    End
33434>>>            //*
33434>>>            //*End
33434>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33434>>>
33434>>>
33434>>>
33434>>>        End
33434>>>>
33434>>>
33434>>>        Open Users
33436>>>        //Open "Users" as Users
33436>>>        File_Size Users to Size##
33439>>>        If Size## ne 0 Begin
33441>>>             Clear Users
33442>>>             Move LoginUSerId##   to Users.Login_Id
33443>>>             Find eq Users by Index.1
33444>>>>
33444>>>             [Finderr] Begin
33446>>>>
33446>>>                Error 25000 "Unknown User"
33447>>>>
33447>>>                Set LoginOk to False
33448>>>                Get LoginOk to PasswordOk
33449>>>                Function_Return PasswordOk
33450>>>             End
33450>>>>
33450>>>             [Found] Begin
33452>>>>
33452>>>                If (LoginPassword## ne Users.Password) Begin
33454>>>                    Error 25000 "Invalid Password"
33455>>>>
33455>>>                    Set LoginOk to False
33456>>>                    Get LoginOk to PasswordOk
33457>>>                    Function_Return PasswordOk
33458>>>                End
33458>>>>
33458>>>                Else Move Users.Departm_Code to sDepartment
33460>>>                Move (Trim(sDepartment)) to sDepartment
33461>>>             End
33461>>>>
33461>>>        End
33461>>>>
33461>>>        Close Users
33462>>>
33462>>>        Get LoginOk to PasswordOk
33463>>>        Sysdate lsLoginDate lsHH lsMM lsSS
33467>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33470>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33473>>>        insert "WorkSpaces\" in LastLogin## at 1
33475>>>        get_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33478>>>        If ((LoginDriver## ne "") and ((UpperCase(LoginDriver##)) ne "DATAFLEX")) Begin
33480>>>           If Not LoginDriver## in LoginSeq## Begin
33482>>>                 If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33485>>>                 Else Move (LoginSeq##+"|"+LoginDriver##) to LoginSeq##
33487>>>                 set_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33490>>>           End
33490>>>>
33490>>>        End
33490>>>>
33490>>>        Append LastLogin## "\" (Module_Name(Self))
33492>>>        Append LastLogin## "\LastLogin"
33493>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33496>>>
33496>>>        If "|" in LoginSeq## Begin
33498>>>            If ((left(LoginSeq##,(pos("|",LoginSeq##) -1))) ne LoginDriver##) Insert (LoginDriver##+"|") in LoginSeq## at 1
33502>>>        End
33502>>>>
33502>>>        Else Begin
33503>>>            If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33506>>>            Else If LoginSeq## ne LoginDriver## Insert (LoginDriver##+"|") in LoginSeq## at 1
33511>>>        End
33511>>>>
33511>>>        Left LoginSeq## to LoginSeq## 250
33513>>>>
33513>>>        set_profile_string LastLogin## "LoginDriver" to (UpperCase(LoginSeq##))
33516>>>        set_profile_string LastLogin## "LoginServer" to LoginServer##
33519>>>        set_profile_string LastLogin## "LoginUserId" to LoginUserId##
33522>>>        set_profile_string LastLogin## "SavePassword" to SavePassword##
33525>>>        If lsHH lt 10 Insert 0 in lsHH at 1
33529>>>        If lsMM lt 10 Insert 0 in lsMM at 1
33533>>>        If lsSS lt 10 Insert 0 in lsSS at 1
33537>>>        Append lsLoginDate " - " lsHH ":" lsMM ":" lsSS
33543>>>        set_profile_string LastLogin## "LoginTime" to lsLoginDate
33546>>>        If (SavePassword##) Begin
33548>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33549>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to (fsCrypto(Self,"forward",LoginPassword##))
33552>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33553>>>        End
33553>>>>
33553>>>        Else Begin
33554>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33555>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to ""
33558>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33559>>>        End
33559>>>>
33559>>>
33559>>>        Function_Return PasswordOk
33560>>>    End_Function
33561>>>
33561>>>    Procedure Login For Desktop
33562>>>        Local Integer LoginPassword##
33563>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33564>>>        If Not LoginPassword## Send Exit_Application
33567>>>    End_Procedure
33568>>>
33568>>>    Function CheckLogin For Desktop Returns Integer
33569>>>        Local Integer LoginPassword##
33570>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33571>>>        Function_Return LoginPassword##
33572>>>    End_Function
33573>>>
33573>>>
33573>>>
33573>>>
33573>>>
33573>>>
33573>>>    //AB-StoreEnd
33573>>>
33573>>>End_Object    // Connect
33574>>>
33574>>>
33574>>>//AB-StoreStart
33574>>>
33574>>>
33574>>>
33574>>>//AB-StoreEnd
33574>>>
33574>>>//AB/ End_Object    // prj
33574>use checkafm.pkg
INCLUDING FILE: CHECKAFM.PKG
33574>>>
33574>>>
33574>>>Function Check_Afm Global String Afm_Num Returns Integer
33575>>>    Integer iii Num1 Num2
33576>>>
33576>>>    Move (Trim(Afm_Num)) To Afm_Num
33577>>>
33577>>>    For iii From 1 To (Length(Trim(Afm_Num)))
33583>>>>
33583>>>        If Not (Mid(Afm_Num,1,iii)) In  "0123456789" Function_Return 3
33586>>>    Loop
33587>>>>
33587>>>
33587>>>    Move (Right(Afm_Num,1)) to Num2
33588>>>
33588>>>    If (Length(Afm_Num)<>9) Function_Return 2
33591>>>
33591>>>    Move 0 to Num1
33592>>>
33592>>>    For iii From 1 to 8
33598>>>>
33598>>>        Add ((Mid(Afm_Num,1,iii)) * (2 ^ (9 - iii))) to Num1
33599>>>    Loop
33600>>>>
33600>>>
33600>>>    Move (Mod(Num1,11)) to Num1
33601>>>    If (Num1=10) Move 0 to Num1
33604>>>
33604>>>    If (Num1=Num2)  Function_Return 0
33607>>>    Else            Function_Return 1
33609>>>End_Function
33610>>>
33610>use checklog.pkg
INCLUDING FILE: CHECKLOG.PKG
33610>>>open syscurgl
INCLUDING FILE: SYSCURGL.FD
33612>>>open syscurxr
33614>>>open gplan
INCLUDING FILE: GPLAN.FD
33616>>>//open gplanl
33616>>>open iteml
INCLUDING FILE: ITEML.FD
33618>>>open cn
INCLUDING FILE: CN.FD
33620>>>open payresp
INCLUDING FILE: PAYRESP.FD
33622>>>open salesmen
INCLUDING FILE: SALESMEN.FD
33624>>>open mhxanik
INCLUDING FILE: MHXANIK.FD
33626>>>open constrct
INCLUDING FILE: CONSTRCT.FD
33628>>>open clients
INCLUDING FILE: CLIENTS.FD
33630>>>open wtypkin
INCLUDING FILE: WTYPKIN.FD
33632>>>open wax
INCLUDING FILE: WAX.FD
33634>>>Function Check_log Global String slog Returns Integer
33635>>>    clear gplan
33636>>>    move syscurxr.company_code to gplan.company_code
33637>>>    move syscurxr.branch_code  to gplan.branch_code
33638>>>    move syscurxr.year_year    to gplan.year_year
33639>>>    move slog                  to gplan.gplan_code
33640>>>    find eq gplan by index.1
33641>>>>
33641>>>    if (found=1) function_return 0
33644>>>    else         function_return 1
33646>>>
33646>>>End_Function
33647>>>
33647>>>Function Check_last Global String slog Returns Integer
33648>>>    clear gplan
33649>>>    move syscurxr.company_code to gplan.company_code
33650>>>    move syscurxr.branch_code  to gplan.branch_code
33651>>>    move syscurxr.year_year    to gplan.year_year
33652>>>    move slog                  to gplan.gplan_code
33653>>>    find eq gplan by index.1
33654>>>>
33654>>>    if ((found=1) and (Gplan.Gplan_Yn_Last = 1)) Function_Return 0
33657>>>    else                                         Function_return 1
33659>>>
33659>>>End_Function
33660>>>
33660>>>Function fsgplandescr String slog Returns string
33661>>>    clear gplan
33662>>>    move syscurgl.company_code to gplan.company_code
33663>>>    move syscurgl.branch_code  to gplan.branch_code
33664>>>    move syscurgl.year_year    to gplan.year_year
33665>>>    move slog                  to gplan.gplan_code
33666>>>    find eq gplan by index.1
33667>>>>
33667>>>    if (found=1) function_return gplan.gplan_descr1
33670>>>    else         function_return ''
33672>>>
33672>>>End_Function
33673>>>
33673>>>//Function fsgplanperi String slog Returns string
33673>>>//    string sdescr
33673>>>//    clear gplanl
33673>>>//    move syscurgl.company_code to  gplanl.company_code
33673>>>//    move syscurgl.branch_code  to  gplanl.branch_code
33673>>>//    move slog                  to  gplanl.gplan_code
33673>>>//    find eq gplanl by index.1
33673>>>//    if (found=1) begin
33673>>>//        move gplanl.gplan_descr1 to sdescr
33673>>>//        function_return sdescr
33673>>>//    end
33673>>>//    else         function_return ''
33673>>>//End_Function
33673>>>
33673>>>
33673>>>
33673>>>Function fsclient string code Returns string
33674>>>    string name
33675>>>    clear clients
33676>>>    move code to clients.client_id
33677>>>    find eq clients by index.6
33678>>>>
33678>>>    if (found) move clients.client_name to name
33681>>>    else       move '' to name
33683>>>    function_return name
33684>>>end_Function
33685>>>
33685>>>Function fspayresp string code Returns string
33686>>>    string name
33687>>>    clear payresp
33688>>>    move code to payresp.presp_id
33689>>>    find eq payresp by index.7
33690>>>>
33690>>>    if (found) move payresp.presp_name to name
33693>>>    else       move '' to name
33695>>>    function_return name
33696>>>end_Function
33697>>>
33697>>>Function fssalesmen string code Returns string
33698>>>    string name
33699>>>    clear salesmen
33700>>>    move code to salesmen.sls_id
33701>>>    find eq salesmen by index.4
33702>>>>
33702>>>    if (found) move salesmen.sls_name to name
33705>>>    else       move '' to name
33707>>>    function_return name
33708>>>end_Function
33709>>>
33709>>>Function fsconstrct string code Returns string
33710>>>    string name
33711>>>    clear constrct
33712>>>    move code to constrct.cnt_id
33713>>>    find eq constrct by index.5
33714>>>>
33714>>>    if (found) move constrct.cnt_name to name
33717>>>    else       move '' to name
33719>>>    function_return name
33720>>>end_Function
33721>>>
33721>>>Function fsmhxanik string code Returns string
33722>>>    string name
33723>>>    clear mhxanik
33724>>>    move code to mhxanik.mhx_id
33725>>>    find eq mhxanik by index.4
33726>>>>
33726>>>    if (found) move mhxanik.mhx_name to name
33729>>>    else       move '' to name
33731>>>    function_return name
33732>>>end_Function
33733>>>
33733>>>
33733>>>Function fsptyppar string code Returns string
33734>>>    string sdescr
33735>>>    clear ptypparl
INCLUDING FILE: PTYPPARL.FD
33736>>>    move syscurxr.company_code to ptypparl.company_code
33737>>>    move syscurxr.branch_code  to ptypparl.branch_code
33738>>> //   move syscurxr.year_year    to ptypparl.year_year
33738>>>    move code                  to ptypparl.ptyppar_code
33739>>>    find eq ptypparl by index.1
33740>>>>
33740>>>    move ptypparl.ptyppar_descr to sdescr
33741>>>    function_return sdescr
33742>>>end_Function
33743>>>
33743>>>Function fsgplan string code Returns string
33744>>>    string sdescr
33745>>>    clear gplan
33746>>>    move syscurxr.company_code to gplan.company_code
33747>>>    move syscurxr.branch_code  to gplan.branch_code
33748>>>    move syscurxr.year_year    to gplan.year_year
33749>>>    move code                  to gplan.gplan_code
33750>>>    find eq gplan by index.1
33751>>>>
33751>>>    move gplan.gplan_descr1    to sdescr
33752>>>    function_return sdescr
33753>>>end_Function
33754>>>
33754>>>Function fsitem string scode Returns string
33755>>>    clear iteml
33756>>>    move scode to iteml.item_code
33757>>>    find eq iteml by index.5
33758>>>>
33758>>>    function_return iteml.item_descr
33759>>>end_Function
33760>>>
33760>>>Function fswax string srecr Returns string
33761>>>    clear wax
33762>>>    move srecr to wax.wax_recr
33763>>>    find eq wax by index.2
33764>>>>
33764>>>    function_return wax.wax_descr
33765>>>end_Function
33766>>>
33766>>>
33766>>>Function fswitemx string code Returns string
33767>>>    string name
33768>>>    clear witemx
INCLUDING FILE: WITEMX.FD
33769>>>    move syscurxr.company_code to witemx.company_code
33770>>>    move syscurxr.branch_code  to witemx.branch_code
33771>>>    move syscurxr.year_year    to witemx.year_year
33772>>>    move code to witemx.witemx_code
33773>>>    find eq witemx by index.5
33774>>>>
33774>>>    move witemx.witemx_descr to name
33775>>>    function_return name
33776>>>end_Function
33777>>>
33777>>>Function fsCNDescr String asItem Returns String
33778>>>    Clear CN
33779>>>    move asItem to CN.CN_Code
33780>>>    Find Eq CN by Index.5
33781>>>>
33781>>>    Function_Return CN.CN_Descr
33782>>>End_Function
33783>>>
33783>>>Function fswtypkin String askin Returns String
33784>>>    Clear Wtypkin
33785>>>    move askin to Wtypkin.wtypkin_code
33786>>>    Find Eq wtypkin by Index.1
33787>>>>
33787>>>    Function_Return Wtypkin.wtypkin_descr
33788>>>End_Function
33789>>>
33789>>>Function FindGtypkinDescr Integer aiCode Returns String
33790>>>    String lsDescr
33791>>>    Clear Gtypkin
INCLUDING FILE: GTYPKIN.FD
33792>>>    Move syscurxr.company_code    to Gtypkin.Company_Code
33793>>>    Move syscurxr.Branch_Code     to Gtypkin.Branch_Code
33794>>>    Move syscurxr.Year_year       to Gtypkin.Year_Year
33795>>>    Move aiCode                   to Gtypkin.Gtypkin_Code
33796>>>    Find eq Gtypkin by Index.1
33797>>>>
33797>>>    [Found] Move Gtypkin.Gtypkin_Descr to lsDescr
33798>>>    Function_Return lsDescr
33799>>>End_Function // FindGtypkinDescr
33800>>>
33800>>>Function FindBtypkinDescr Integer aiCode Returns String
33801>>>    String lsDescr
33802>>>    Clear Btypkin
INCLUDING FILE: BTYPKIN.FD
33803>>>    Move syscurxr.company_code    to Btypkin.Company_Code
33804>>>    Move syscurxr.Branch_Code     to Btypkin.Branch_Code
33805>>>    Move syscurxr.Year_year       to Btypkin.Year_Year
33806>>>    Move aiCode                   to Btypkin.btypkin_Code
33807>>>    Find eq Btypkin by Index.1
33808>>>>
33808>>>    [Found] Move Btypkin.Btypkin_Descr to lsDescr
33809>>>    Function_Return lsDescr
33810>>>End_Function // FindGtypkinDescr
33811>>>
33811>>>
33811>Send Login
33812>Use Xrhsh.pkg
INCLUDING FILE: XRHSH.PKG
33812>>>//------------------------------
33812>>>Use SelectXr.Dg
INCLUDING FILE: SELECTXR.DG
33812>>>>>//AB/ Project Select / Change Xrhsh
33812>>>>>//AB/ Object prj is a Dialog_Project
33812>>>>>//AB/     Set ProjectName to "Select / Change Xrhsh"
33812>>>>>//AB/     Set ProjectFileName to "SelectXR.DG"
33812>>>>>
33812>>>>>// Project Object Structure
33812>>>>>//   oSelectYear is a dbModalPanelSub
33812>>>>>//     Company_DD is a DataDictionary
33812>>>>>//     Branch_DD is a DataDictionary
33812>>>>>//     Year_DD is a DataDictionary
33812>>>>>//     Company_Company_Code is a dbFormSub
33812>>>>>//     Company_Company_Name is a dbFormSub
33812>>>>>//     Branch_Branch_Code is a dbFormSub
33812>>>>>//     Branch_Branch_Name is a dbFormSub
33812>>>>>//     Year_Year_Year is a dbFormSub
33812>>>>>//     Year_Year_Descr is a dbFormSub
33812>>>>>//     Year_Year_Entrydate is a dbFormSub
33812>>>>>//     oOk_bn is a ButtonSub
33812>>>>>//     oCancel_bn is a ButtonSub
33812>>>>>//     otxtCompany is a TextBoxSub
33812>>>>>//     otxtBranch is a TextBoxSub
33812>>>>>//     otxtYear is a TextBoxSub
33812>>>>>//     otxtWorkingDay is a TextBoxSub
33812>>>>>//     otxtWorkingDay is a TextBoxSub
33812>>>>>//     chkxr is a CheckBoxSub
33812>>>>>
33812>>>>>// Register all objects
33812>>>>>Register_Object Branch_Branch_Code
33812>>>>>Register_Object Branch_Branch_Name
33812>>>>>Register_Object Branch_DD
33812>>>>>Register_Object Company_Company_Code
33812>>>>>Register_Object Company_Company_Name
33812>>>>>Register_Object Company_DD
33812>>>>>Register_Object chkxr
33812>>>>>Register_Object oCancel_bn
33812>>>>>Register_Object oOk_bn
33812>>>>>Register_Object oSelectYear
33812>>>>>Register_Object otxtBranch
33812>>>>>Register_Object otxtCompany
33812>>>>>Register_Object otxtWorkingDay
33812>>>>>Register_Object otxtYear
33812>>>>>Register_Object Year_DD
33812>>>>>Register_Object Year_Year_Descr
33812>>>>>Register_Object Year_Year_Entrydate
33812>>>>>Register_Object Year_Year_Year
33812>>>>>
33812>>>>>
33812>>>>>
33812>>>>>//AB-StoreTopStart
33812>>>>>
33812>>>>>
33812>>>>>
33812>>>>>
33812>>>>>       String  gs_selected_beto_site
33812>>>>>
33812>>>>>Open SysCurXR
33814>>>>>Open Nomisma
33816>>>>>
33816>>>>>//AB-StoreTopEnd
33816>>>>>
33816>>>>>//AB-IgnoreStart
33816>>>>>
33816>>>>>Use DFAllEnt.pkg
33816>>>>>Use dbForm.Sub
33816>>>>>Use Button.Sub
33816>>>>>Use Txtbox.Sub
33816>>>>>Use Chkbox.Sub
33816>>>>>
33816>>>>>
33816>>>>>Use COMPANY.DD
INCLUDING FILE: COMPANY.DD
33816>>>>>>>//DDB-FileStart
33816>>>>>>>//DDB-HeaderStart
33816>>>>>>>
33816>>>>>>>// File Name : COMPANY.DD
33816>>>>>>>// Class Name: Company_DataDictionary
33816>>>>>>>// Revision  : 64
33816>>>>>>>// Version   : 2
33816>>>>>>>
33816>>>>>>>Use  Windows           // Basic Definitions
33816>>>>>>>Use  DataDict          // DataDictionary Class Definition
33816>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33816>>>>>>>
33816>>>>>>>Open Company
33818>>>>>>>Open Branch
33820>>>>>>>
33820>>>>>>>//DDB-HeaderEnd
33820>>>>>>>//DDB-ValidationStart
33820>>>>>>>
33820>>>>>>>Register_Object Company_Company_Doy_VT
33820>>>>>>>Register_Object Company_Company_J_Code_VT
33820>>>>>>>
33820>>>>>>>Object Company_Company_Doy_VT  is a CodeValidationTable
33822>>>>>>>    Set Type_Value        To "DOY"
33823>>>>>>>    Set Allow_Blank_State To TRUE
33824>>>>>>>    //DDB-ValidationCustomStart
33824>>>>>>>    //DDB-ValidationCustomEnd
33824>>>>>>>End_Object   // Company_Company_Doy_VT
33825>>>>>>>
33825>>>>>>>Object Company_Company_J_Code_VT  is a CodeValidationTable
33827>>>>>>>    Set Type_Value        To "JOB"
33828>>>>>>>    Set Allow_Blank_State To TRUE
33829>>>>>>>    //DDB-ValidationCustomStart
33829>>>>>>>    //DDB-ValidationCustomEnd
33829>>>>>>>End_Object   // Company_Company_J_Code_VT
33830>>>>>>>//DDB-ValidationEnd
33830>>>>>>>//DDB-SelectionStart
33830>>>>>>>//DDB/ ExternalSelectionList sl001  sl001.sl
33830>>>>>>>Register_Object sl001
33830>>>>>>>//DDB-SelectionEnd
33830>>>>>>> 
33830>>>>>>>Class Company_DataDictionary  is a DataDictionary
33831>>>>>>> 
33831>>>>>>>    // Update:
33831>>>>>>> 
33831>>>>>>>    Procedure Update
33832>>>>>>>        Forward Send Update
33834>>>>>>>        move 'DOY' to company.doy_type
33835>>>>>>>        move 'JOB' to company.jcode_type 
33836>>>>>>>        // Insert Code Here
33836>>>>>>>    End_Procedure   // Update
33837>>>>>>> 
33837>>>>>>>
33837>>>>>>>    // Operation_Not_Allowed:
33837>>>>>>>
33837>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33838>>>>>>>        // Insert Code Here
33838>>>>>>>        Case Begin
33838>>>>>>>             Case (iError_Num = 1001)
33840>>>>>>>                  Error 1001 "DDC 051:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª „«˜ ¨œå˜ª!\n\n‰œ¤æª ‰à› ¡æª"
33841>>>>>>>>
33841>>>>>>>             Case Break
33842>>>>>>>
33842>>>>>>>             Case Else
33842>>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33844>>>>>>>        Case End
33844>>>>>>>    End_Procedure   // Operation_Not_Allowed
33845>>>>>>>
33845>>>>>>>
33845>>>>>>>    // Validate_Save:
33845>>>>>>>
33845>>>>>>>    Function Validate_Save  Returns Integer
33846>>>>>>>        Local Integer iReturnVal
33847>>>>>>>        Forward Get Validate_Save  To iReturnVal
33849>>>>>>>        If (Not(iReturnVal)) Begin
33851>>>>>>>            // Insert Code Here
33851>>>>>>>            If (Company.Company_Code="") Send Operation_Not_Allowed 1001
33854>>>>>>>        End
33854>>>>>>>>
33854>>>>>>>        Function_Return iReturnVal
33855>>>>>>>    End_Function   // Validate_Save
33856>>>>>>>
33856>>>>>>>
33856>>>>>>>    // Define_Fields:
33856>>>>>>>    // This procedure is used to set up all data-dictionary rules.
33856>>>>>>>
33856>>>>>>>    Procedure Define_Fields
33857>>>>>>>        Forward Send Define_Fields
33859>>>>>>>        //DDB-Generated-Code-Location
33859>>>>>>>        //DDB-DefineFieldStart
33859>>>>>>>
33859>>>>>>>        Set Main_File            To Company.File_Number
33860>>>>>>>        Set Cascade_Delete_State To FALSE
33861>>>>>>>
33861>>>>>>>
33861>>>>>>>        // Child (Client) file structure................
33861>>>>>>>        Send Add_Client_File  Branch.File_Number
33862>>>>>>>
33862>>>>>>>        // Field-based properties.......................
33862>>>>>>>
33862>>>>>>>        // Company.Company_Code
33862>>>>>>>        Set Field_Options          Field Company.Company_Code To DD_AUTOFIND   
33863>>>>>>>        Set Field_Prompt_Object    Field Company.Company_Code To (sl001(Self))
33864>>>>>>>
33864>>>>>>>        // Company.Company_Name
33864>>>>>>>        Set Field_Options          Field Company.Company_Name To DD_REQUIRED   
33865>>>>>>>        Set Field_Prompt_Object    Field Company.Company_Name To (sl001(Self))
33866>>>>>>>
33866>>>>>>>        // Company.Company_Afm
33866>>>>>>>        Set Field_Options          Field Company.Company_Afm To DD_AUTOFIND   
33867>>>>>>>
33867>>>>>>>        // Company.Company_Addr
33867>>>>>>>
33867>>>>>>>        // Company.Company_Tk
33867>>>>>>>
33867>>>>>>>        // Company.Company_Poli
33867>>>>>>>
33867>>>>>>>        // Company.Company_Doy
33867>>>>>>>        Set Field_Value_Table      Field Company.Company_Doy To (Company_Company_Doy_VT(Self))
33868>>>>>>>
33868>>>>>>>        // Company.Company_J_Code
33868>>>>>>>        Set Field_Value_Table      Field Company.Company_J_Code To (Company_Company_J_Code_VT(Self))
33869>>>>>>>
33869>>>>>>>        // Company.Company_C_Code0
33869>>>>>>>
33869>>>>>>>        // Company.Company_C_Cod00
33869>>>>>>>
33869>>>>>>>        // Company.Company_C_Coder
33869>>>>>>>
33869>>>>>>>        // Company.Company_Tel
33869>>>>>>>
33869>>>>>>>        // Company.Company_Fax
33869>>>>>>>
33869>>>>>>>        // Company.Company_Email
33869>>>>>>>
33869>>>>>>>        // Company.Company_Resp
33869>>>>>>>
33869>>>>>>>        // Company.Company_Bitmap
33869>>>>>>>
33869>>>>>>>        // Company.Beto_Site
33869>>>>>>>
33869>>>>>>>        // Company.Logo
33869>>>>>>>
33869>>>>>>>        // Company.Doy_Type
33869>>>>>>>
33869>>>>>>>        // Company.Jcode_Type
33869>>>>>>>
33869>>>>>>>        // Company.Sap_Code
33869>>>>>>>
33869>>>>>>>        // Company.Sap_Path
33869>>>>>>>
33869>>>>>>>        //DDB-DefineFieldEnd
33869>>>>>>>    End_Procedure    // Define_Fields
33870>>>>>>>
33870>>>>>>>    // Field_Defaults:
33870>>>>>>>    // This procedure is used to establish default field values.
33870>>>>>>>
33870>>>>>>>    Procedure Field_Defaults
33871>>>>>>>        Forward Send Field_Defaults
33873>>>>>>>        //DDB-Generated-Code-Location
33873>>>>>>>        //DDB-FieldDefaultStart
33873>>>>>>>        //DDB-FieldDefaultEnd
33873>>>>>>>    End_Procedure    // Field_Defaults
33874>>>>>>>End_Class    // Company_DataDictionary
33875>>>>>>>
33875>>>>>>>//DDB-Selection-pkg-Start
33875>>>>>>>
33875>>>>>>>Use sl001.sl         // sl001
INCLUDING FILE: SL001.SL
33875>>>>>>>>>//AB/ Project sl001 : Etairies
33875>>>>>>>>>//AB/     Object prj is a Lookup_Project
33875>>>>>>>>>//AB/         Set ProjectName to "sl001 : Etairies"
33875>>>>>>>>>//AB/         Set ProjectFileName to "sl001.SL"
33875>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
33875>>>>>>>>>
33875>>>>>>>>>// Project Object Structure
33875>>>>>>>>>//   sl001 is a dbModalPanel
33875>>>>>>>>>//     Company_DD is a DataDictionary
33875>>>>>>>>>//     oSelList is a dbList
33875>>>>>>>>>//     oOK_bn is a ButtonSub
33875>>>>>>>>>//     oCancel_bn is a ButtonSub
33875>>>>>>>>>//     oSearch_bn is a ButtonSub
33875>>>>>>>>>
33875>>>>>>>>>// Register all objects
33875>>>>>>>>>Register_Object Company_DD
33875>>>>>>>>>Register_Object oCancel_bn
33875>>>>>>>>>Register_Object oOK_bn
33875>>>>>>>>>Register_Object oSearch_bn
33875>>>>>>>>>Register_Object oSelList
33875>>>>>>>>>Register_Object sl001
33875>>>>>>>>>
33875>>>>>>>>>
33875>>>>>>>>>    //AB-IgnoreStart
33875>>>>>>>>>
33875>>>>>>>>>    Use DFAllEnt.pkg
33875>>>>>>>>>    Use Button.Sub
33875>>>>>>>>>
33875>>>>>>>>>
33875>>>>>>>>>    Use COMPANY.DD
33875>>>>>>>>>    
33875>>>>>>>>>    //AB-IgnoreEnd
33875>>>>>>>>>
33875>>>>>>>>>    CD_Popup_Object sl001 is a dbModalPanel
33894>>>>>>>>>        Set Label to "„«˜ ¨åœª"
33895>>>>>>>>>        Set Size to 148 297
33896>>>>>>>>>        Set Location to 12 27
33897>>>>>>>>>
33897>>>>>>>>>        //AB-DDOStart
33897>>>>>>>>>
33897>>>>>>>>>        Object Company_DD is a Company_DataDictionary
33899>>>>>>>>>        End_Object    // Company_DD
33900>>>>>>>>>
33900>>>>>>>>>        Set Main_DD to (Company_DD(self))
33901>>>>>>>>>        Set Server to (Company_DD(self))
33902>>>>>>>>>
33902>>>>>>>>>        //AB-DDOEnd
33902>>>>>>>>>
33902>>>>>>>>>        Object oSelList is a dbList
33904>>>>>>>>>            Set Main_File to Company.File_Number
33905>>>>>>>>>            Set Size to 105 280
33906>>>>>>>>>            Set Location to 6 6
33907>>>>>>>>>
33907>>>>>>>>>            Begin_Row
33910>>>>>>>>>                Entry_Item Company.Company_code
33911>>>>>>>>>                Entry_Item Company.Company_name
33912>>>>>>>>>                Entry_Item Company.Company_afm
33913>>>>>>>>>            End_Row
33918>>>>>>>>>
33918>>>>>>>>>            Set Form_Width    item 0 to 42
33919>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
33920>>>>>>>>>            
33920>>>>>>>>>            Set Form_Width    item 1 to 150
33921>>>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
33922>>>>>>>>>            
33922>>>>>>>>>            Set Form_Width    item 2 to 80
33923>>>>>>>>>            Set Header_Label  item 2 to "€.”.‹"
33924>>>>>>>>>            
33924>>>>>>>>>        End_Object    // oSelList
33925>>>>>>>>>
33925>>>>>>>>>        Object oOK_bn is a ButtonSub
33927>>>>>>>>>            Set Label to "&„§ ¢¦šã"
33928>>>>>>>>>            Set Location to 115 126
33929>>>>>>>>>
33929>>>>>>>>>            //AB-StoreStart
33929>>>>>>>>>            Procedure OnClick
33931>>>>>>>>>                Send OK To (oSelList(current_object))
33932>>>>>>>>>            End_Procedure
33933>>>>>>>>>            //AB-StoreEnd
33933>>>>>>>>>
33933>>>>>>>>>        End_Object    // oOK_bn
33934>>>>>>>>>
33934>>>>>>>>>        Object oCancel_bn is a ButtonSub
33936>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
33937>>>>>>>>>            Set Location to 115 181
33938>>>>>>>>>
33938>>>>>>>>>            //AB-StoreStart
33938>>>>>>>>>            Procedure OnClick
33940>>>>>>>>>                Send Cancel To (oSelList(current_object))
33941>>>>>>>>>            End_Procedure
33942>>>>>>>>>            //AB-StoreEnd
33942>>>>>>>>>
33942>>>>>>>>>        End_Object    // oCancel_bn
33943>>>>>>>>>
33943>>>>>>>>>        Object oSearch_bn is a ButtonSub
33945>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
33946>>>>>>>>>            Set Location to 115 236
33947>>>>>>>>>
33947>>>>>>>>>            //AB-StoreStart
33947>>>>>>>>>            Procedure OnClick
33949>>>>>>>>>                Send Search To (oSelList(current_object))
33950>>>>>>>>>            End_Procedure
33951>>>>>>>>>            //AB-StoreEnd
33951>>>>>>>>>
33951>>>>>>>>>        End_Object    // oSearch_bn
33952>>>>>>>>>
33952>>>>>>>>>
33952>>>>>>>>>        //AB-StoreStart
33952>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To oOk_bn
33953>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To oCancel_bn
33954>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To oSearch_bn
33955>>>>>>>>>        //AB-StoreEnd
33955>>>>>>>>>
33955>>>>>>>>>    CD_End_Object    // sl001
33957>>>>>>>>>>
33957>>>>>>>>>
33957>>>>>>>>>//AB/     End_Object    // prj
33957>>>>>>>
33957>>>>>>>//DDB-Selection-pkg-End
33957>>>>>>>//DDB-FileEnd
33957>>>>>Use BRANCH.DD
INCLUDING FILE: BRANCH.DD
33957>>>>>>>//DDB-FileStart
33957>>>>>>>//DDB-HeaderStart
33957>>>>>>>
33957>>>>>>>// File Name : BRANCH.DD
33957>>>>>>>// Class Name: Branch_DataDictionary
33957>>>>>>>// Revision  : 96
33957>>>>>>>// Version   : 2
33957>>>>>>>
33957>>>>>>>Use  Windows           // Basic Definitions
33957>>>>>>>Use  DataDict          // DataDictionary Class Definition
33957>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33957>>>>>>>
33957>>>>>>>Open Branch
33959>>>>>>>Open Year
33961>>>>>>>Open Brzones
INCLUDING FILE: BRZONES.FD
33963>>>>>>>Open Tpbranch
INCLUDING FILE: TPBRANCH.FD
33965>>>>>>>Open Company
33967>>>>>>>Open Sysrecg
INCLUDING FILE: SYSRECG.FD
33969>>>>>>>
33969>>>>>>>//DDB-HeaderEnd
33969>>>>>>>//DDB-ValidationStart
33969>>>>>>>
33969>>>>>>>Register_Object Branch_Branch_Doy_VT
33969>>>>>>>Register_Object Branch_Branch_C_Code0_VT
33969>>>>>>>
33969>>>>>>>Object Branch_Branch_Doy_VT  is a CodeValidationTable
33971>>>>>>>    Set Type_Value        To "DOY"
33972>>>>>>>    Set Validate_State    To FALSE
33973>>>>>>>    Set Allow_Blank_State To TRUE
33974>>>>>>>    //DDB-ValidationCustomStart
33974>>>>>>>    //DDB-ValidationCustomEnd
33974>>>>>>>End_Object   // Branch_Branch_Doy_VT
33975>>>>>>>
33975>>>>>>>Object Branch_Branch_C_Code0_VT  is a CodeValidationTable
33977>>>>>>>    Set Type_Value        To ""
33978>>>>>>>    Set Allow_Blank_State To TRUE
33979>>>>>>>    //DDB-ValidationCustomStart
33979>>>>>>>    //DDB-ValidationCustomEnd
33979>>>>>>>End_Object   // Branch_Branch_C_Code0_VT
33980>>>>>>>//DDB-ValidationEnd
33980>>>>>>>//DDB-SelectionStart
33980>>>>>>>//DDB/ ExternalSelectionList SL002  Sl002.sl
33980>>>>>>>Register_Object SL002
33980>>>>>>>//DDB-SelectionEnd
33980>>>>>>>
33980>>>>>>>Class Branch_DataDictionary  is a DataDictionary
33981>>>>>>> 
33981>>>>>>>    Procedure Save_Main_File
33982>>>>>>>        Forward Send Save_Main_File
33984>>>>>>>        // Insert Code Here
33984>>>>>>>    End_Procedure   // Save_Main_File
33985>>>>>>> 
33985>>>>>>>    Procedure Creating
33986>>>>>>>        Forward Send Creating
33988>>>>>>>        // Insert Code Here
33988>>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Branch.Branch_Rec0)))))) to Branch.Branch_Recr
33989>>>>>>>    End_Procedure   // Creating
33990>>>>>>>
33990>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33991>>>>>>>        // Insert Code Here
33991>>>>>>>        Case Begin
33991>>>>>>>             Case (iError_Num = 1001)
33993>>>>>>>                  Error 1001 "DDC 002:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
33994>>>>>>>>
33994>>>>>>>             Case Break
33995>>>>>>>
33995>>>>>>>             Case Else
33995>>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33997>>>>>>>        Case End
33997>>>>>>>    End_Procedure   // Operation_Not_Allowed
33998>>>>>>>
33998>>>>>>>
33998>>>>>>>    // Validate_Save:
33998>>>>>>>
33998>>>>>>>    Function Validate_Save  Returns Integer
33999>>>>>>>        Local Integer iReturnVal
34000>>>>>>>        Forward Get Validate_Save  To iReturnVal
34002>>>>>>>        If (Not(iReturnVal)) Begin
34004>>>>>>>            // Insert Code Here
34004>>>>>>>            If (Branch.Branch_Code="") Send Operation_Not_Allowed 1001
34007>>>>>>>        End
34007>>>>>>>>
34007>>>>>>>        Function_Return iReturnVal
34008>>>>>>>    End_Function   // Validate_Save
34009>>>>>>>
34009>>>>>>>
34009>>>>>>>    // Define_Fields:
34009>>>>>>>    // This procedure is used to set up all data-dictionary rules.
34009>>>>>>>
34009>>>>>>>    Procedure Define_Fields
34010>>>>>>>        Forward Send Define_Fields
34012>>>>>>>        //DDB-Generated-Code-Location
34012>>>>>>>        //DDB-DefineFieldStart
34012>>>>>>>
34012>>>>>>>        Set Main_File            To Branch.File_Number
34013>>>>>>>        Set Cascade_Delete_State To FALSE
34014>>>>>>>
34014>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
34015>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOENTER     DD_FINDREQ    
34016>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
34017>>>>>>>
34017>>>>>>>        // Child (Client) file structure................
34017>>>>>>>        Send Add_Client_File  Year.File_Number
34018>>>>>>>        Send Add_Client_File  Brzones.File_Number
34019>>>>>>>        Send Add_Client_File  Tpbranch.File_Number
34020>>>>>>>
34020>>>>>>>        // Parent (Server) file structure...............
34020>>>>>>>        Send Add_Server_File  Company.File_Number
34021>>>>>>>
34021>>>>>>>        // External (System) file structure.............
34021>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
34022>>>>>>>
34022>>>>>>>        Define_Auto_Increment  Sysrecg.Branch_Rec0  To Branch.Branch_Rec0
34025>>>>>>>
34025>>>>>>>        // Field-based properties.......................
34025>>>>>>>
34025>>>>>>>        // Branch.Company_Code
34025>>>>>>>
34025>>>>>>>        // Branch.Branch_Code
34025>>>>>>>        Set Field_Options          Field Branch.Branch_Code To DD_AUTOFIND   
34026>>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Code To (SL002(Self))
34027>>>>>>>        Set Key_Field_State        Field Branch.Branch_Code To TRUE
34028>>>>>>>
34028>>>>>>>        // Branch.Branch_Rec0
34028>>>>>>>
34028>>>>>>>        // Branch.Branch_Recr
34028>>>>>>>
34028>>>>>>>        // Branch.Branch_Name
34028>>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Name To (SL002(Self))
34029>>>>>>>
34029>>>>>>>        // Branch.Branch_Afm
34029>>>>>>>
34029>>>>>>>        // Branch.Branch_Addr
34029>>>>>>>
34029>>>>>>>        // Branch.Branch_Tk
34029>>>>>>>
34029>>>>>>>        // Branch.Branch_Poli
34029>>>>>>>
34029>>>>>>>        // Branch.Branch_Doy
34029>>>>>>>        Set Field_Value_Table      Field Branch.Branch_Doy To (Branch_Branch_Doy_VT(Self))
34030>>>>>>>
34030>>>>>>>        // Branch.Branch_J_Code
34030>>>>>>>
34030>>>>>>>        // Branch.Branch_C_Code0
34030>>>>>>>        Set Field_Value_Table      Field Branch.Branch_C_Code0 To (Branch_Branch_C_Code0_VT(Self))
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_C_Code00
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_C_Coder
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_Tel
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_Fax
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_Email
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_Resp
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_Bitmap
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_Site
34031>>>>>>>
34031>>>>>>>        // Branch.Branch_Apoth
34031>>>>>>>
34031>>>>>>>        // Branch.Beto_Site
34031>>>>>>>
34031>>>>>>>        // Branch.Path_Exp
34031>>>>>>>
34031>>>>>>>        // Branch.Exp_Txtname
34031>>>>>>>
34031>>>>>>>        // Branch.Send_Phone
34031>>>>>>>
34031>>>>>>>        // Branch.Send_Path_Files
34031>>>>>>>
34031>>>>>>>        // Branch.Send_Path_Conf
34031>>>>>>>
34031>>>>>>>        // Branch.Tomeas_Code
34031>>>>>>>
34031>>>>>>>        // Branch.Ftp_Sec_Retry
34031>>>>>>>
34031>>>>>>>        // Branch.Ftp_Sec_Exit
34031>>>>>>>
34031>>>>>>>        // Branch.Ras_Name
34031>>>>>>>
34031>>>>>>>        // Branch.Ras_Passw
34031>>>>>>>
34031>>>>>>>        // Branch.Ras_Domain
34031>>>>>>>
34031>>>>>>>        // Branch.Last_Hmnia_Ekt
34031>>>>>>>
34031>>>>>>>        // Branch.Deop_Logo
34031>>>>>>>
34031>>>>>>>        // Branch.Entolh
34031>>>>>>>
34031>>>>>>>        // Branch.Paragogh
34031>>>>>>>
34031>>>>>>>        // Branch.Locked_Until
34031>>>>>>>
34031>>>>>>>        // Branch.Sap_Code
34031>>>>>>>
34031>>>>>>>        // Branch.Perioxh
34031>>>>>>>
34031>>>>>>>        // Branch.Egkatastash
34031>>>>>>>
34031>>>>>>>        // Branch.Date_Locked
34031>>>>>>>        Set Field_Mask_Type        Field Branch.Date_Locked To MASK_DATE_WINDOW
34032>>>>>>>
34032>>>>>>>        // Branch.Ypokat1
34032>>>>>>>
34032>>>>>>>        // Branch.Ypokat1a
34032>>>>>>>
34032>>>>>>>        // Branch.Ypokat2
34032>>>>>>>
34032>>>>>>>        // Branch.Edra1
34032>>>>>>>
34032>>>>>>>        // Branch.Edra1a
34032>>>>>>>
34032>>>>>>>        // Branch.Edra2
34032>>>>>>>
34032>>>>>>>        //DDB-DefineFieldEnd
34032>>>>>>>    End_Procedure    // Define_Fields
34033>>>>>>>
34033>>>>>>>    // Field_Defaults:
34033>>>>>>>    // This procedure is used to establish default field values.
34033>>>>>>>
34033>>>>>>>    Procedure Field_Defaults
34034>>>>>>>        Forward Send Field_Defaults
34036>>>>>>>        //DDB-Generated-Code-Location
34036>>>>>>>        //DDB-FieldDefaultStart
34036>>>>>>>        //DDB-FieldDefaultEnd
34036>>>>>>>    End_Procedure    // Field_Defaults
34037>>>>>>>End_Class    // Branch_DataDictionary
34038>>>>>>>
34038>>>>>>>//DDB-Selection-pkg-Start
34038>>>>>>>
34038>>>>>>>Use Sl002.sl         // SL002
INCLUDING FILE: SL002.SL
34038>>>>>>>>>//AB/ Project SL002:Branch
34038>>>>>>>>>//AB/ Object prj is a Lookup_Project
34038>>>>>>>>>//AB/     Set ProjectName to "SL002:Branch"
34038>>>>>>>>>//AB/     Set ProjectFileName to "Sl002.sl"
34038>>>>>>>>>
34038>>>>>>>>>// Project Object Structure
34038>>>>>>>>>//   SL002 is a dbModalPanelSub
34038>>>>>>>>>//     Company_DD is a DataDictionary
34038>>>>>>>>>//     Branch_DD is a DataDictionary
34038>>>>>>>>>//     oSelList is a dbListSub
34038>>>>>>>>>//     oOK_bn is a ButtonSub
34038>>>>>>>>>//     oCancel_bn is a ButtonSub
34038>>>>>>>>>//     oSearch_bn is a ButtonSub
34038>>>>>>>>>
34038>>>>>>>>>// Register all objects
34038>>>>>>>>>Register_Object Branch_DD
34038>>>>>>>>>Register_Object Company_DD
34038>>>>>>>>>Register_Object oCancel_bn
34038>>>>>>>>>Register_Object oOK_bn
34038>>>>>>>>>Register_Object oSearch_bn
34038>>>>>>>>>Register_Object oSelList
34038>>>>>>>>>Register_Object SL002
34038>>>>>>>>>
34038>>>>>>>>>
34038>>>>>>>>>//AB-IgnoreStart
34038>>>>>>>>>
34038>>>>>>>>>Use DFAllEnt.pkg
34038>>>>>>>>>Use dbList.Sub
34038>>>>>>>>>Use Button.Sub
34038>>>>>>>>>
34038>>>>>>>>>
34038>>>>>>>>>Use COMPANY.DD
34038>>>>>>>>>Use BRANCH.DD
34038>>>>>>>>>
34038>>>>>>>>>//AB-IgnoreEnd
34038>>>>>>>>>
34038>>>>>>>>>Object SL002 is a dbModalPanelSub
34040>>>>>>>>>
34040>>>>>>>>>    //AB-StoreTopStart
34040>>>>>>>>>    Property String psFragmaCompanyCode  ""
34042>>>>>>>>>    
34042>>>>>>>>>    //AB-StoreTopEnd
34042>>>>>>>>>
34042>>>>>>>>>    Set Minimize_Icon to FALSE
34043>>>>>>>>>    Set Label to "“§¦¡˜«˜©«ã£˜«˜"
34044>>>>>>>>>    Set Size to 146 430
34045>>>>>>>>>    Set Location to 4 5
34046>>>>>>>>>    Set Exit_Application_Local_State to FALSE
34047>>>>>>>>>    Set Modal_State to FALSE
34048>>>>>>>>>
34048>>>>>>>>>    //AB-DDOStart
34048>>>>>>>>>
34048>>>>>>>>>    Object Company_DD is a Company_DataDictionary
34050>>>>>>>>>    End_Object    // Company_DD
34051>>>>>>>>>
34051>>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
34053>>>>>>>>>        Set DDO_Server to (Company_DD(self))
34054>>>>>>>>>
34054>>>>>>>>>        //AB-StoreStart
34054>>>>>>>>>        Procedure OnConstrain
34056>>>>>>>>>             String lsCompanyCode
34057>>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
34058>>>>>>>>>             If (lsCompanyCode <> "") Constrain Branch.Company_code eq lsCompanyCode
34062>>>>>>>>>        End_Procedure // OnConstrain
34063>>>>>>>>>        
34063>>>>>>>>>        
34063>>>>>>>>>        
34063>>>>>>>>>        //AB-StoreEnd
34063>>>>>>>>>
34063>>>>>>>>>    End_Object    // Branch_DD
34064>>>>>>>>>
34064>>>>>>>>>    Set Main_DD to (Branch_DD(self))
34065>>>>>>>>>    Set Server to (Branch_DD(self))
34066>>>>>>>>>
34066>>>>>>>>>    //AB-DDOEnd
34066>>>>>>>>>
34066>>>>>>>>>    Object oSelList is a dbListSub
34068>>>>>>>>>        Set Main_File to Branch.File_Number
34069>>>>>>>>>        Set Size to 105 415
34070>>>>>>>>>        Set Location to 6 6
34071>>>>>>>>>
34071>>>>>>>>>        Begin_Row
34074>>>>>>>>>            Entry_Item Branch.Branch_code
34075>>>>>>>>>            Entry_Item Branch.Branch_name
34076>>>>>>>>>            Entry_Item Company.Company_code
34077>>>>>>>>>            Entry_Item Company.Company_name
34078>>>>>>>>>            Entry_Item Branch.Beto_site
34079>>>>>>>>>            Entry_Item Branch.Branch_recr
34080>>>>>>>>>        End_Row
34085>>>>>>>>>
34085>>>>>>>>>        Set Form_Width    item 0 to 60
34086>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
34087>>>>>>>>>        
34087>>>>>>>>>        Set Form_Width    item 1 to 128
34088>>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜"
34089>>>>>>>>>        
34089>>>>>>>>>        Set Form_Width    item 2 to 69
34090>>>>>>>>>        Set Header_Label  item 2 to "‰à› ¡æª „«˜ ¨å˜ª"
34091>>>>>>>>>        
34091>>>>>>>>>        Set Form_Width    item 3 to 109
34092>>>>>>>>>        Set Header_Label  item 3 to "Ž¤¦£˜ „«˜ ¨å˜ª"
34093>>>>>>>>>        
34093>>>>>>>>>        Set Form_Width    item 4 to 42
34094>>>>>>>>>        Set Header_Label  item 4 to "Site"
34095>>>>>>>>>        
34095>>>>>>>>>        Set Form_Width    item 5 to 0
34096>>>>>>>>>        Set Header_Label  item 5 to ""
34097>>>>>>>>>        
34097>>>>>>>>>
34097>>>>>>>>>        //AB-StoreStart
34097>>>>>>>>>                
34097>>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
34099>>>>>>>>>        
34099>>>>>>>>>        Procedure Store_Defaults
34101>>>>>>>>>            forward send Store_Defaults
34103>>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
34104>>>>>>>>>        end_Procedure // Store_Defaults
34105>>>>>>>>>        
34105>>>>>>>>>        Procedure Restore_Defaults
34107>>>>>>>>>            forward send Restore_Defaults
34109>>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
34110>>>>>>>>>        end_Procedure // Restore_Defaults
34111>>>>>>>>>        
34111>>>>>>>>>        Procedure Activating
34113>>>>>>>>>            Forward Send Activating
34115>>>>>>>>>            Send Rebuild_Constraints to (Branch_DD(self))
34116>>>>>>>>>        End_Procedure // Activating
34117>>>>>>>>>        
34117>>>>>>>>>        Set Column_Options Item 5 to NoEnter True
34118>>>>>>>>>        
34118>>>>>>>>>        
34118>>>>>>>>>        //AB-StoreEnd
34118>>>>>>>>>
34118>>>>>>>>>    End_Object    // oSelList
34119>>>>>>>>>
34119>>>>>>>>>    Object oOK_bn is a ButtonSub
34121>>>>>>>>>        Set Label to "&„§ ¢¦šã"
34122>>>>>>>>>        Set Location to 112 262
34123>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34124>>>>>>>>>
34124>>>>>>>>>        //AB-StoreStart
34124>>>>>>>>>        Procedure OnClick
34126>>>>>>>>>            Send OK To (oSelList(current_object))
34127>>>>>>>>>        End_Procedure
34128>>>>>>>>>        //AB-StoreEnd
34128>>>>>>>>>
34128>>>>>>>>>    End_Object    // oOK_bn
34129>>>>>>>>>
34129>>>>>>>>>    Object oCancel_bn is a ButtonSub
34131>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
34132>>>>>>>>>        Set Location to 112 317
34133>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34134>>>>>>>>>
34134>>>>>>>>>        //AB-StoreStart
34134>>>>>>>>>        Procedure OnClick
34136>>>>>>>>>            Send Cancel To (oSelList(current_object))
34137>>>>>>>>>        End_Procedure
34138>>>>>>>>>        //AB-StoreEnd
34138>>>>>>>>>
34138>>>>>>>>>    End_Object    // oCancel_bn
34139>>>>>>>>>
34139>>>>>>>>>    Object oSearch_bn is a ButtonSub
34141>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
34142>>>>>>>>>        Set Location to 112 372
34143>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34144>>>>>>>>>
34144>>>>>>>>>        //AB-StoreStart
34144>>>>>>>>>        Procedure OnClick
34146>>>>>>>>>            Send Search To (oSelList(current_object))
34147>>>>>>>>>        End_Procedure
34148>>>>>>>>>        //AB-StoreEnd
34148>>>>>>>>>
34148>>>>>>>>>    End_Object    // oSearch_bn
34149>>>>>>>>>
34149>>>>>>>>>
34149>>>>>>>>>    //AB-StoreStart
34149>>>>>>>>>    
34149>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
34150>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
34151>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
34152>>>>>>>>>    
34152>>>>>>>>>    
34152>>>>>>>>>    
34152>>>>>>>>>    //AB-StoreEnd
34152>>>>>>>>>
34152>>>>>>>>>End_Object    // SL002
34153>>>>>>>>>
34153>>>>>>>>>//AB/ End_Object    // prj
34153>>>>>>>
34153>>>>>>>//DDB-Selection-pkg-End
34153>>>>>>>//DDB-FileEnd
34153>>>>>Use YEAR.DD
INCLUDING FILE: YEAR.DD
34153>>>>>>>//DDB-FileStart
34153>>>>>>>//DDB-HeaderStart
34153>>>>>>>
34153>>>>>>>// File Name : YEAR.DD
34153>>>>>>>// Class Name: Year_DataDictionary
34153>>>>>>>// Revision  : 119
34153>>>>>>>// Version   : 2
34153>>>>>>>
34153>>>>>>>Use  Windows           // Basic Definitions
34153>>>>>>>Use  DataDict          // DataDictionary Class Definition
34153>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
34153>>>>>>>
34153>>>>>>>Open Year
34155>>>>>>>Open Branch
34157>>>>>>>Open Syscurxr
34159>>>>>>>
34159>>>>>>>//DDB-HeaderEnd
34159>>>>>>>//DDB-ValidationStart
34159>>>>>>>
34159>>>>>>>Register_Object Year_Year_C_Code0_VT1
34159>>>>>>>Register_Object Year_Year_C_Code00_VT1
34159>>>>>>>Register_Object Year_Year_C_Coder_VT1
34159>>>>>>>
34159>>>>>>>Object Year_Year_C_Code0_VT1  is a CodeValidationTable
34161>>>>>>>    Set Type_Value        To "CURRENCY"
34162>>>>>>>    //DDB-ValidationCustomStart
34162>>>>>>>    //DDB-ValidationCustomEnd
34162>>>>>>>End_Object   // Year_Year_C_Code0_VT1
34163>>>>>>>
34163>>>>>>>Object Year_Year_C_Code00_VT1  is a CodeValidationTable
34165>>>>>>>    Set Type_Value        To "CURRENCY"
34166>>>>>>>    //DDB-ValidationCustomStart
34166>>>>>>>    //DDB-ValidationCustomEnd
34166>>>>>>>End_Object   // Year_Year_C_Code00_VT1
34167>>>>>>>
34167>>>>>>>Object Year_Year_C_Coder_VT1  is a CodeValidationTable
34169>>>>>>>    Set Type_Value        To "CURRENCY"
34170>>>>>>>    //DDB-ValidationCustomStart
34170>>>>>>>    //DDB-ValidationCustomEnd
34170>>>>>>>End_Object   // Year_Year_C_Coder_VT1
34171>>>>>>>//DDB-ValidationEnd
34171>>>>>>>//DDB-SelectionStart
34171>>>>>>>//DDB/ ExternalSelectionList SL003  Sl003.sl
34171>>>>>>>Register_Object SL003
34171>>>>>>>//DDB-SelectionEnd
34171>>>>>>>            
34171>>>>>>>Class Year_DataDictionary  is a DataDictionary
34172>>>>>>>    
34172>>>>>>>    Procedure Creating
34173>>>>>>>        Forward Send Creating
34175>>>>>>>        // Insert Code Here
34175>>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Year.Year_Year)))))) to Year.Year_Recr
34176>>>>>>>    End_Procedure   // Creating
34177>>>>>>>
34177>>>>>>>
34177>>>>>>>    // Operation_Not_Allowed:
34177>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
34178>>>>>>>        // Insert Code Here
34178>>>>>>>        Case Begin    
34178>>>>>>>             Case (iError_Num = 1001)
34180>>>>>>>                  Error 1001 "DDC 053:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
34181>>>>>>>>
34181>>>>>>>             Case Break
34182>>>>>>>             Case (iError_Num=1002)
34185>>>>>>>                Error 1002 "DDC 053:Branch Site ¡˜«œ™˜å¤œ  ©«¦ Year ¡œ¤æ"
34186>>>>>>>>
34186>>>>>>>             Case Break
34187>>>>>>>             Case (iError_Num=1003)
34190>>>>>>>                Error 1003 "DDC 053:Company Code=0"
34191>>>>>>>>
34191>>>>>>>             Case Break
34192>>>>>>>             Case (iError_Num=1004)
34195>>>>>>>                Error 1004 "DDC 053:Branch Code=0"
34196>>>>>>>>
34196>>>>>>>             Case Break
34197>>>>>>>             Case Else
34197>>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
34199>>>>>>>        Case End
34199>>>>>>>    End_Procedure   // Operation_Not_Allowed
34200>>>>>>>
34200>>>>>>>
34200>>>>>>>    // Update:
34200>>>>>>>    // Use this message to effect changes in related-to files. The
34200>>>>>>>    // Backout message should be designed to reverse the effects of this
34200>>>>>>>    // message. It is invoked while the database is locked.
34200>>>>>>>
34200>>>>>>>    Procedure Update
34201>>>>>>>        Forward Send Update
34203>>>>>>>        // Insert Code Here
34203>>>>>>>        Move Company.Company_Code   to Year.Company_Code
34204>>>>>>>        Move Branch.Branch_Code     to Year.Branch_Code
34205>>>>>>>        move branch.beto_site       to year.beto_site
34206>>>>>>>
34206>>>>>>>        //sos:parametrika apo sysfile?
34206>>>>>>>       
34206>>>>>>>       // If ((Year.Year_EntryDate-14) < Year.Year_XrhshFrom) Begin
34206>>>>>>>       //     Move Year.Year_XrhshFrom to Year.Year_OpenFrom
34206>>>>>>>       // End
34206>>>>>>>       // Else Begin
34206>>>>>>>       //     Move (Year.Year_EntryDate-14) to Year.Year_OpenFrom
34206>>>>>>>       // End
34206>>>>>>>      //  Move Year.Year_EntryDate      to Year.Year_OpenTo
34206>>>>>>>    End_Procedure   // Update
34207>>>>>>>
34207>>>>>>>    // Validate_Save:
34207>>>>>>>
34207>>>>>>>    Function Validate_Save  Returns Integer
34208>>>>>>>        Local Integer iReturnVal
34209>>>>>>>        Forward Get Validate_Save  To iReturnVal
34211>>>>>>>        If (Not(iReturnVal)) Begin
34213>>>>>>>                 If (Year.Year_Year   = 0) Send Operation_Not_Allowed 1001
34216>>>>>>>            Else If (Year.Company_Code='') Send Operation_Not_Allowed 1003
34220>>>>>>>            Else If (Year.Branch_Code ='') Send Operation_Not_Allowed 1004
34224>>>>>>>        End
34224>>>>>>>>
34224>>>>>>>        Function_Return iReturnVal
34225>>>>>>>    End_Function   // Validate_Save
34226>>>>>>>
34226>>>>>>>
34226>>>>>>>    // Define_Fields:
34226>>>>>>>    // This procedure is used to set up all data-dictionary rules.
34226>>>>>>>
34226>>>>>>>    Procedure Define_Fields
34227>>>>>>>        Forward Send Define_Fields
34229>>>>>>>        //DDB-Generated-Code-Location
34229>>>>>>>        //DDB-DefineFieldStart
34229>>>>>>>
34229>>>>>>>        Set Main_File            To Year.File_Number
34230>>>>>>>        Set Cascade_Delete_State To FALSE
34231>>>>>>>
34231>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
34232>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
34233>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
34234>>>>>>>
34234>>>>>>>        // Parent (Server) file structure...............
34234>>>>>>>        Send Add_Server_File  Branch.File_Number
34235>>>>>>>
34235>>>>>>>        // External (System) file structure.............
34235>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
34236>>>>>>>
34236>>>>>>>        // Field-based properties.......................
34236>>>>>>>
34236>>>>>>>        // Year.Company_Code
34236>>>>>>>
34236>>>>>>>        // Year.Branch_Code
34236>>>>>>>
34236>>>>>>>        // Year.Year_Year
34236>>>>>>>        Set Field_Options          Field Year.Year_Year To DD_AUTOFIND    DD_REQUIRED   
34237>>>>>>>        Set Field_Prompt_Object    Field Year.Year_Year To (SL003(Self))
34238>>>>>>>        Set Key_Field_State        Field Year.Year_Year To TRUE
34239>>>>>>>
34239>>>>>>>        // Year.Year_Recr
34239>>>>>>>        Set Field_Prompt_Object    Field Year.Year_Recr To (SL003(Self))
34240>>>>>>>
34240>>>>>>>        // Year.Branch_Recr
34240>>>>>>>
34240>>>>>>>        // Year.Year_Descr
34240>>>>>>>
34240>>>>>>>        // Year.Year_Isolfrom
34240>>>>>>>
34240>>>>>>>        // Year.Year_Isolto
34240>>>>>>>
34240>>>>>>>        // Year.Year_Openfrom
34240>>>>>>>
34240>>>>>>>        // Year.Year_Opento
34240>>>>>>>
34240>>>>>>>        // Year.Year_Entrydate
34240>>>>>>>
34240>>>>>>>        // Year.Year_Dateaa
34240>>>>>>>
34240>>>>>>>        // Year.Year_Xrhshfrom
34240>>>>>>>
34240>>>>>>>        // Year.Year_Xrhshto
34240>>>>>>>
34240>>>>>>>        // Year.Year_Myflimit
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numgtypkin
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numgarticl
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numgmove
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numgplan
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numgformat
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numgthaa
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numgopen
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numbtypkin
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numbaxio
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numbarticl
34240>>>>>>>
34240>>>>>>>        // Year.Year_Numbmove
34240>>>>>>>
34240>>>>>>>        // Year.Year_Delimiter
34240>>>>>>>
34240>>>>>>>        // Year.Year_Printer
34240>>>>>>>
34240>>>>>>>        // Year.Year_Valid_Char
34240>>>>>>>
34240>>>>>>>        // Year.Year_C_Code0
34240>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0 To "dbComboFormSub"
34241>>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code0 To (Year_Year_C_Code0_VT1(Self))
34242>>>>>>>
34242>>>>>>>        // Year.Year_C_Code00
34242>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00 To "dbComboFormSub"
34243>>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code00 To (Year_Year_C_Code00_VT1(Self))
34244>>>>>>>
34244>>>>>>>        // Year.Year_C_Coder
34244>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder To "dbComboFormSub"
34245>>>>>>>        Set Field_Value_Table      Field Year.Year_C_Coder To (Year_Year_C_Coder_VT1(Self))
34246>>>>>>>
34246>>>>>>>        // Year.Beto_Site
34246>>>>>>>
34246>>>>>>>        // Year.Clients_Plafon
34246>>>>>>>
34246>>>>>>>        // Year.Payresp_Plafon
34246>>>>>>>
34246>>>>>>>        // Year.Clients_Ofeilh
34246>>>>>>>
34246>>>>>>>        // Year.Payresp_Ofeilh
34246>>>>>>>
34246>>>>>>>        // Year.Working
34246>>>>>>>
34246>>>>>>>        //DDB-DefineFieldEnd
34246>>>>>>>
34246>>>>>>>        Set Main_File            To Year.File_Number
34247>>>>>>>        Set Cascade_Delete_State To FALSE
34248>>>>>>>
34248>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
34249>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
34250>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
34251>>>>>>>
34251>>>>>>>        // Child (Client) file structure................
34251>>>>>>>
34251>>>>>>>        // Parent (Server) file structure...............
34251>>>>>>>        Send Add_Server_File  Branch.File_Number
34252>>>>>>>
34252>>>>>>>        // Field-based properties.......................
34252>>>>>>>
34252>>>>>>>        // Year.Company_Code
34252>>>>>>>
34252>>>>>>>        // Year.Branch_Code
34252>>>>>>>
34252>>>>>>>        // Year.Year_Year
34252>>>>>>>        Set Field_Label_Long       Field Year.Year_Year           To "•¨ã©ž"
34253>>>>>>>        Set Field_Label_Short      Field Year.Year_Year           To "•¨ã©ž"
34254>>>>>>>        Set Field_Options          Field Year.Year_Year           To DD_REQUIRED
34255>>>>>>>        //Set Field_Prompt_Object    Field Year.Year_Year           To (SL053(Self))
34255>>>>>>>
34255>>>>>>>        // Year.Year_Descr
34255>>>>>>>        Set Field_Label_Long       Field Year.Year_Descr          To "œ¨ š¨˜­ã •¨ã©žª"
34256>>>>>>>        Set Field_Label_Short      Field Year.Year_Descr          To "œ¨.•¨ã©žª"
34257>>>>>>>
34257>>>>>>>        // Year.Year_C_Code0
34257>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0        To "dbComboForm"
34258>>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code0        To "‰ç¨ ¦ Œæ£ ©£˜"
34259>>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code0        To "‰¬¨.Œ¦£ ©£˜"
34260>>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code0        To (Year_Year_C_Code0_VT(Self))
34260>>>>>>>
34260>>>>>>>        // Year.Year_C_Code00
34260>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00       To "dbComboForm"
34261>>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
34262>>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
34263>>>>>>>        //Set Field_Options          Field Year.Year_C_Code00       To DD_REQUIRED
34263>>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code00       To (Year_Year_C_Code1_VT(Self))
34263>>>>>>>
34263>>>>>>>        // Year.Year_C_Coder
34263>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder        To "dbComboForm"
34264>>>>>>>        Set Field_Label_Long       Field Year.Year_C_Coder        To "Œæ£ ©£˜ REPORTING"
34265>>>>>>>        Set Field_Label_Short      Field Year.Year_C_Coder        To "Œæ£ ©£˜ REP"
34266>>>>>>>        //Set Field_Options          Field Year.Year_C_Coder        To DD_REQUIRED
34266>>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Coder        To (Year_Year_C_Coder_VT(Self))
34266>>>>>>>
34266>>>>>>>        // Year.Year_Isolfrom
34266>>>>>>>        Set Field_Label_Long       Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
34267>>>>>>>        Set Field_Label_Short      Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
34268>>>>>>>
34268>>>>>>>        // Year.Year_Isolto
34268>>>>>>>        Set Field_Label_Long       Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
34269>>>>>>>        Set Field_Label_Short      Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
34270>>>>>>>
34270>>>>>>>        // Year.Year_Openfrom
34270>>>>>>>        Set Field_Label_Long       Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
34271>>>>>>>        Set Field_Label_Short      Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
34272>>>>>>>
34272>>>>>>>        // Year.Year_Opento
34272>>>>>>>        Set Field_Label_Long       Field Year.Year_Opento         To "„šš¨˜­âª „àª"
34273>>>>>>>        Set Field_Label_Short      Field Year.Year_Opento         To "„šš¨˜­âª „àª"
34274>>>>>>>
34274>>>>>>>        // Year.Year_Entrydate
34274>>>>>>>        Set Field_Label_Long       Field Year.Year_Entrydate      To "†£œ¨¦£ž¤å˜ „¨š˜©å˜ª"
34275>>>>>>>        Set Field_Label_Short      Field Year.Year_Entrydate      To "†£/¤å˜ „¨š˜©å˜ª"
34276>>>>>>>
34276>>>>>>>        // Year.Year_Dateaa
34276>>>>>>>
34276>>>>>>>        // Year.Year_Xrhshfrom
34276>>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
34277>>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
34278>>>>>>>
34278>>>>>>>        // Year.Year_Xrhshto
34278>>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
34279>>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
34280>>>>>>>
34280>>>>>>>        // Year.Year_Myflimit
34280>>>>>>>        Set Field_Label_Long       Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
34281>>>>>>>        Set Field_Label_Short      Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
34282>>>>>>>
34282>>>>>>>        // Year.Year_Numgtypkin
34282>>>>>>>        Set Field_Options          Field Year.Year_Numgtypkin     To DD_DISPLAYONLY
34283>>>>>>>
34283>>>>>>>        // Year.Year_Numgarticl
34283>>>>>>>        Set Field_Options          Field Year.Year_Numgarticl     To DD_DISPLAYONLY
34284>>>>>>>
34284>>>>>>>        // Year.Year_Numgmove
34284>>>>>>>        Set Field_Options          Field Year.Year_Numgmove       To DD_DISPLAYONLY
34285>>>>>>>
34285>>>>>>>        // Year.Year_Numgplan
34285>>>>>>>        Set Field_Options          Field Year.Year_Numgplan       To DD_DISPLAYONLY
34286>>>>>>>
34286>>>>>>>        // Year.Year_Numgformat
34286>>>>>>>        Set Field_Options          Field Year.Year_Numgformat     To DD_DISPLAYONLY
34287>>>>>>>
34287>>>>>>>        // Year.Year_Numgthaa
34287>>>>>>>        Set Field_Options          Field Year.Year_Numgthaa       To DD_DISPLAYONLY
34288>>>>>>>
34288>>>>>>>        // Year.Year_Numgopen
34288>>>>>>>        Set Field_Options          Field Year.Year_Numgopen       To DD_DISPLAYONLY
34289>>>>>>>
34289>>>>>>>        // Year.Year_Numbaxio
34289>>>>>>>        Set Field_Options          Field Year.Year_Numbaxio       To DD_DISPLAYONLY
34290>>>>>>>
34290>>>>>>>        // Year.Year_Numbarticl
34290>>>>>>>        Set Field_Options          Field Year.Year_Numbarticl     To DD_DISPLAYONLY
34291>>>>>>>
34291>>>>>>>        // Year.Year_Numbmove
34291>>>>>>>        Set Field_Options          Field Year.Year_Numbmove       To DD_DISPLAYONLY
34292>>>>>>>
34292>>>>>>>        // Year.Year_Delimiter
34292>>>>>>>        Set Status_Help            Field Year.Year_Delimiter      To "ƒ ˜®à¨ ©« ¡æ š ˜ «¦ Š‘ «žª •¨ã©œàª"
34293>>>>>>>
34293>>>>>>>        // Year.Year_Printer
34293>>>>>>>
34293>>>>>>>        // Year.Year_Valid_Char
34293>>>>>>>
34293>>>>>>>    End_Procedure    // Define_Fields
34294>>>>>>>
34294>>>>>>>    // Field_Defaults:
34294>>>>>>>    // This procedure is used to establish default field values.
34294>>>>>>>
34294>>>>>>>    Procedure Field_Defaults
34295>>>>>>>        Forward Send Field_Defaults
34297>>>>>>>        //DDB-Generated-Code-Location
34297>>>>>>>        //DDB-FieldDefaultStart
34297>>>>>>>        //DDB-FieldDefaultEnd
34297>>>>>>>        Set Field_Changed_Value   Field Year.Year_Delimiter      To "."
34298>>>>>>>        Set Field_Changed_Value   Field Year.Year_Printer        To "LPT1:"
34299>>>>>>>        Set Field_Changed_Value   Field Year.Year_Valid_Char     To "1234567890"
34300>>>>>>>    End_Procedure    // Field_Defaults
34301>>>>>>>
34301>>>>>>>End_Class    // Year_DataDictionary
34302>>>>>>>//DDB-Selection-pkg-Start
34302>>>>>>>
34302>>>>>>>Use Sl003.sl         // SL003
INCLUDING FILE: SL003.SL
34302>>>>>>>>>//AB/ Project SL003:Year
34302>>>>>>>>>//AB/ Object prj is a Lookup_Project
34302>>>>>>>>>//AB/     Set ProjectName to "SL003:Year"
34302>>>>>>>>>//AB/     Set ProjectFileName to "Sl003.sl"
34302>>>>>>>>>
34302>>>>>>>>>// Project Object Structure
34302>>>>>>>>>//   SL003 is a dbModalPanelSub
34302>>>>>>>>>//     Company_DD is a DataDictionary
34302>>>>>>>>>//     Branch_DD is a DataDictionary
34302>>>>>>>>>//     Year_DD is a DataDictionary
34302>>>>>>>>>//     oSelList is a dbListSub
34302>>>>>>>>>//     oOK_bn is a ButtonSub
34302>>>>>>>>>//     oCancel_bn is a ButtonSub
34302>>>>>>>>>//     oSearch_bn is a ButtonSub
34302>>>>>>>>>
34302>>>>>>>>>// Register all objects
34302>>>>>>>>>Register_Object Branch_DD
34302>>>>>>>>>Register_Object Company_DD
34302>>>>>>>>>Register_Object oCancel_bn
34302>>>>>>>>>Register_Object oOK_bn
34302>>>>>>>>>Register_Object oSearch_bn
34302>>>>>>>>>Register_Object oSelList
34302>>>>>>>>>Register_Object SL003
34302>>>>>>>>>Register_Object Year_DD
34302>>>>>>>>>
34302>>>>>>>>>
34302>>>>>>>>>//AB-IgnoreStart
34302>>>>>>>>>
34302>>>>>>>>>Use DFAllEnt.pkg
34302>>>>>>>>>Use dbList.Sub
34302>>>>>>>>>Use Button.Sub
34302>>>>>>>>>
34302>>>>>>>>>
34302>>>>>>>>>Use COMPANY.DD
34302>>>>>>>>>Use BRANCH.DD
34302>>>>>>>>>Use YEAR.DD
34302>>>>>>>>>
34302>>>>>>>>>//AB-IgnoreEnd
34302>>>>>>>>>
34302>>>>>>>>>CD_Popup_Object SL003 is a dbModalPanelSub
34321>>>>>>>>>
34321>>>>>>>>>    //AB-StoreTopStart
34321>>>>>>>>>    Property String psFragmaCompanyCode  ""
34323>>>>>>>>>    Property String psFragmaBranchCode   ""
34325>>>>>>>>>    property integer pifragmaactive public 0
34327>>>>>>>>>    //AB-StoreTopEnd
34327>>>>>>>>>
34327>>>>>>>>>    Set Minimize_Icon to FALSE
34328>>>>>>>>>    Set Label to "•¨ã©œ ª"
34329>>>>>>>>>    Set Size to 149 449
34330>>>>>>>>>    Set Location to 4 7
34331>>>>>>>>>    Set Exit_Application_Local_State to FALSE
34332>>>>>>>>>    Set Modal_State to FALSE
34333>>>>>>>>>
34333>>>>>>>>>    //AB-DDOStart
34333>>>>>>>>>
34333>>>>>>>>>    Object Company_DD is a Company_DataDictionary
34335>>>>>>>>>    End_Object    // Company_DD
34336>>>>>>>>>
34336>>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
34338>>>>>>>>>        Set DDO_Server to (Company_DD(self))
34339>>>>>>>>>    End_Object    // Branch_DD
34340>>>>>>>>>
34340>>>>>>>>>    Object Year_DD is a Year_DataDictionary
34342>>>>>>>>>        Set DDO_Server to (Branch_DD(self))
34343>>>>>>>>>
34343>>>>>>>>>        //AB-StoreStart
34343>>>>>>>>>        Procedure OnConstrain
34345>>>>>>>>>             String lsCompanyCode lsBranchCode
34346>>>>>>>>>             integer iactive
34346>>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
34347>>>>>>>>>             get pifragmaactive to iactive
34348>>>>>>>>>             If (lsCompanyCode <> "") Begin
34350>>>>>>>>>                Get psFragmaBranchCode  to lsBranchCode
34351>>>>>>>>>                Constrain Year.Company_Code eq lsCompanyCode
34353>>>>>>>>>                If (lsBranchCode <> "") Constrain Year.Branch_code eq lsBranchCode
34357>>>>>>>>>             End
34357>>>>>>>>>>
34357>>>>>>>>>             if (iactive = 0) constrain year.working ne 1
34361>>>>>>>>>        End_Procedure // OnConstrain
34362>>>>>>>>>        
34362>>>>>>>>>        
34362>>>>>>>>>        
34362>>>>>>>>>        
34362>>>>>>>>>        
34362>>>>>>>>>        //AB-StoreEnd
34362>>>>>>>>>
34362>>>>>>>>>    End_Object    // Year_DD
34363>>>>>>>>>
34363>>>>>>>>>    Set Main_DD to (Year_DD(self))
34364>>>>>>>>>    Set Server to (Year_DD(self))
34365>>>>>>>>>
34365>>>>>>>>>    //AB-DDOEnd
34365>>>>>>>>>
34365>>>>>>>>>    Object oSelList is a dbListSub
34367>>>>>>>>>        Set Main_File to Year.File_Number
34368>>>>>>>>>        Set Size to 105 433
34369>>>>>>>>>        Set Location to 6 6
34370>>>>>>>>>
34370>>>>>>>>>        Begin_Row
34373>>>>>>>>>            Entry_Item Year.Year_year
34374>>>>>>>>>            Entry_Item Company.Company_code
34375>>>>>>>>>            Entry_Item Company.Company_name
34376>>>>>>>>>            Entry_Item Branch.Branch_code
34377>>>>>>>>>            Entry_Item Branch.Branch_name
34378>>>>>>>>>        End_Row
34383>>>>>>>>>
34383>>>>>>>>>        Set Form_Width    item 0 to 36
34384>>>>>>>>>        Set Header_Label  item 0 to "•¨ã©ž :          "
34385>>>>>>>>>        
34385>>>>>>>>>        Set Form_Width    item 1 to 71
34386>>>>>>>>>        Set Header_Label  item 1 to "‰à› ¡æª „«˜ ¨å˜ª"
34387>>>>>>>>>        
34387>>>>>>>>>        Set Form_Width    item 2 to 136
34388>>>>>>>>>        Set Header_Label  item 2 to "Ž¤¦£˜ „«˜ ¨å˜ª"
34389>>>>>>>>>        
34389>>>>>>>>>        Set Form_Width    item 3 to 73
34390>>>>>>>>>        Set Header_Label  item 3 to "‰à› ¡æª “§¦¡/«¦ª"
34391>>>>>>>>>        
34391>>>>>>>>>        Set Form_Width    item 4 to 109
34392>>>>>>>>>        Set Header_Label  item 4 to "Ž¤¦£˜ “§¦¡/«¦ª"
34393>>>>>>>>>        
34393>>>>>>>>>
34393>>>>>>>>>        //AB-StoreStart
34393>>>>>>>>>                                                
34393>>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
34395>>>>>>>>>        Property String psStoreFragmaBranchCode   ""
34397>>>>>>>>>        
34397>>>>>>>>>        Procedure Store_Defaults
34399>>>>>>>>>            forward send Store_Defaults
34401>>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
34402>>>>>>>>>            Set psStoreFragmaBranchCode  to (psFragmaBranchCode(Self))
34403>>>>>>>>>        end_Procedure // Store_Defaults
34404>>>>>>>>>        
34404>>>>>>>>>        Procedure Restore_Defaults
34406>>>>>>>>>            forward send Restore_Defaults
34408>>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
34409>>>>>>>>>            Set psFragmaBranchCode  to (psStoreFragmaBranchCode(self))
34410>>>>>>>>>        end_Procedure // Restore_Defaults
34411>>>>>>>>>        
34411>>>>>>>>>        Procedure Activating
34413>>>>>>>>>            Forward Send Activating
34415>>>>>>>>>            Send Rebuild_Constraints to (Year_DD(self))
34416>>>>>>>>>        End_Procedure // Activating
34417>>>>>>>>>        
34417>>>>>>>>>        
34417>>>>>>>>>        
34417>>>>>>>>>        //AB-StoreEnd
34417>>>>>>>>>
34417>>>>>>>>>    End_Object    // oSelList
34418>>>>>>>>>
34418>>>>>>>>>    Object oOK_bn is a ButtonSub
34420>>>>>>>>>        Set Label to "&„§ ¢¦šã"
34421>>>>>>>>>        Set Location to 112 280
34422>>>>>>>>>
34422>>>>>>>>>        //AB-StoreStart
34422>>>>>>>>>        Procedure OnClick
34424>>>>>>>>>            Send OK To (oSelList(current_object))
34425>>>>>>>>>        End_Procedure
34426>>>>>>>>>        //AB-StoreEnd
34426>>>>>>>>>
34426>>>>>>>>>    End_Object    // oOK_bn
34427>>>>>>>>>
34427>>>>>>>>>    Object oCancel_bn is a ButtonSub
34429>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
34430>>>>>>>>>        Set Location to 112 335
34431>>>>>>>>>
34431>>>>>>>>>        //AB-StoreStart
34431>>>>>>>>>        Procedure OnClick
34433>>>>>>>>>            Send Cancel To (oSelList(current_object))
34434>>>>>>>>>        End_Procedure
34435>>>>>>>>>        //AB-StoreEnd
34435>>>>>>>>>
34435>>>>>>>>>    End_Object    // oCancel_bn
34436>>>>>>>>>
34436>>>>>>>>>    Object oSearch_bn is a ButtonSub
34438>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
34439>>>>>>>>>        Set Location to 112 390
34440>>>>>>>>>
34440>>>>>>>>>        //AB-StoreStart
34440>>>>>>>>>        Procedure OnClick
34442>>>>>>>>>            Send Search To (oSelList(current_object))
34443>>>>>>>>>        End_Procedure
34444>>>>>>>>>        //AB-StoreEnd
34444>>>>>>>>>
34444>>>>>>>>>    End_Object    // oSearch_bn
34445>>>>>>>>>
34445>>>>>>>>>
34445>>>>>>>>>    //AB-StoreStart
34445>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
34446>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
34447>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
34448>>>>>>>>>    
34448>>>>>>>>>    
34448>>>>>>>>>    
34448>>>>>>>>>    //AB-StoreEnd
34448>>>>>>>>>
34448>>>>>>>>>CD_End_Object    // SL003
34450>>>>>>>>>>
34450>>>>>>>>>
34450>>>>>>>>>//AB/ End_Object    // prj
34450>>>>>>>
34450>>>>>>>//DDB-Selection-pkg-End
34450>>>>>>>//DDB-FileEnd
34450>>>>>
34450>>>>>//AB-IgnoreEnd
34450>>>>>
34450>>>>>Object oSelectYear is a dbModalPanelSub
34452>>>>>
34452>>>>>    //AB-StoreTopStart
34452>>>>>    
34452>>>>>    Property String  psSelectedYearRecr  ''
34454>>>>>    Property Integer piChangeState False
34456>>>>>    
34456>>>>>    //AB-StoreTopEnd
34456>>>>>
34456>>>>>    Set Minimize_Icon to FALSE
34457>>>>>    Set Label to "„§ ¢¦šã „«˜ ¨œå˜ª - “§¦¡˜«˜©«ã£˜«¦ª - •¨ã©žª"
34458>>>>>    Set Size to 111 372
34459>>>>>    Set Location to 60 40
34460>>>>>    Set Color to 12232306
34461>>>>>
34461>>>>>    //AB-DDOStart
34461>>>>>
34461>>>>>    Object Company_DD is a Company_DataDictionary
34463>>>>>
34463>>>>>        //AB-StoreStart
34463>>>>>        Set Foreign_Field_Options DD_KEYFIELD                   to DD_Clear_Field_Options DD_FindReq
34464>>>>>        Set Foreign_Field_Options DD_INDEXFIELD                 to DD_Clear_Field_Options DD_FindReq
34465>>>>>        Set Foreign_Field_Options Field Company.Company_Name    to DD_DisplayOnly
34466>>>>>        
34466>>>>>        
34466>>>>>        
34466>>>>>        //AB-StoreEnd
34466>>>>>
34466>>>>>    End_Object    // Company_DD
34467>>>>>
34467>>>>>    Object Branch_DD is a Branch_DataDictionary
34469>>>>>        Set DDO_Server to (Company_DD(self))
34470>>>>>
34470>>>>>        //AB-StoreStart
34470>>>>>        Set Foreign_Field_Options DD_KEYFIELD   to DD_Clear_Field_Options DD_FindReq
34471>>>>>        Set Foreign_Field_Options DD_INDEXFIELD to DD_Clear_Field_Options DD_FindReq
34472>>>>>        
34472>>>>>        Set Foreign_Field_Options DD_KEYFIELD   to DD_AutoFind_GE
34473>>>>>        Set Foreign_Field_Options DD_INDEXFIELD to DD_AutoFind_GE
34474>>>>>        
34474>>>>>        Set Foreign_Field_Options Field Branch.Branch_Name to DD_DisplayOnly
34475>>>>>        //AB-StoreEnd
34475>>>>>
34475>>>>>    End_Object    // Branch_DD
34476>>>>>
34476>>>>>    Object Year_DD is a Year_DataDictionary
34478>>>>>        Set DDO_Server to (Branch_DD(self))
34479>>>>>
34479>>>>>        //AB-StoreStart
34479>>>>>        
34479>>>>>        Set Field_Options Field Year.Year_Descr to DD_DisplayOnly
34480>>>>>        Set Field_Options Field Year.Year_Year to DD_AutoFind_GE
34481>>>>>        
34481>>>>>        Function Validate_Delete Returns Integer
34483>>>>>            Function_Return 1
34484>>>>>        End_Function
34485>>>>>        
34485>>>>>        //AB-StoreEnd
34485>>>>>
34485>>>>>    End_Object    // Year_DD
34486>>>>>
34486>>>>>    Set Main_DD to (Year_DD(self))
34487>>>>>    Set Server to (Year_DD(self))
34488>>>>>
34488>>>>>    //AB-DDOEnd
34488>>>>>
34488>>>>>    Object Company_Company_Code is a dbFormSub
34490>>>>>        Entry_Item Company.Company_code
34491>>>>>        Set Size to 13 71
34492>>>>>        Set Location to 9 112
34493>>>>>        Set Color to 12232306
34494>>>>>        Set Label_Col_Offset to 2
34495>>>>>        Set Label_Justification_Mode to jMode_Right
34496>>>>>        Set Prompt_Button_Mode to pb_PromptOn
34497>>>>>        Set Auto_Clear_Deo_State to FALSE
34498>>>>>        Set Enabled_State to FALSE
34499>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34500>>>>>        Set Item_Shadow_State Item 0 to TRUE
34501>>>>>        Set Shadow_State Item 0 to TRUE
34502>>>>>
34502>>>>>        //AB-StoreStart
34502>>>>>        
34502>>>>>        Set Prompt_Object to (sl001(Self))
34503>>>>>        
34503>>>>>        
34503>>>>>        //AB-StoreEnd
34503>>>>>
34503>>>>>    End_Object    // Company_Company_Code
34504>>>>>
34504>>>>>    Object Company_Company_Name is a dbFormSub
34506>>>>>        Entry_Item Company.Company_name
34507>>>>>        Set Size to 13 168
34508>>>>>        Set Location to 9 188
34509>>>>>        Set Color to 12232306
34510>>>>>        Set Label_Col_Offset to 2
34511>>>>>        Set Label_Justification_Mode to jMode_Right
34512>>>>>        Set Enabled_State to FALSE
34513>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34514>>>>>        Set Item_Shadow_State Item 0 to TRUE
34515>>>>>        Set Shadow_State Item 0 to TRUE
34516>>>>>
34516>>>>>        //AB-StoreStart
34516>>>>>        
34516>>>>>        //AB-StoreEnd
34516>>>>>
34516>>>>>    End_Object    // Company_Company_Name
34517>>>>>
34517>>>>>    Object Branch_Branch_Code is a dbFormSub
34519>>>>>        Entry_Item Branch.Branch_code
34520>>>>>        Set Size to 13 71
34521>>>>>        Set Location to 23 112
34522>>>>>        Set Color to 12232306
34523>>>>>        Set Label_Col_Offset to 2
34524>>>>>        Set Label_Justification_Mode to jMode_Right
34525>>>>>        Set Prompt_Button_Mode to pb_PromptOn
34526>>>>>        Set Auto_Clear_Deo_State to FALSE
34527>>>>>        Set Enabled_State to FALSE
34528>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34529>>>>>        Set Item_Shadow_State Item 0 to TRUE
34530>>>>>        Set Shadow_State Item 0 to TRUE
34531>>>>>
34531>>>>>        //AB-StoreStart
34531>>>>>        Set Prompt_Object to (sl002(Self))
34532>>>>>        
34532>>>>>        Procedure Prompt_CallBack Integer hPrompt
34534>>>>>            string lsCompanyCode
34535>>>>>            Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
34536>>>>>            Set psFragmaCompanyCode of hPrompt to lsCompanyCode
34537>>>>>        End_Procedure
34538>>>>>        
34538>>>>>        
34538>>>>>        
34538>>>>>        
34538>>>>>        //AB-StoreEnd
34538>>>>>
34538>>>>>    End_Object    // Branch_Branch_Code
34539>>>>>
34539>>>>>    Object Branch_Branch_Name is a dbFormSub
34541>>>>>        Entry_Item Branch.Branch_name
34542>>>>>        Set Size to 13 168
34543>>>>>        Set Location to 23 188
34544>>>>>        Set Color to 12232306
34545>>>>>        Set Label_Justification_Mode to jMode_Right
34546>>>>>        Set Enabled_State to FALSE
34547>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34548>>>>>        Set Item_Shadow_State Item 0 to TRUE
34549>>>>>        Set Shadow_State Item 0 to TRUE
34550>>>>>
34550>>>>>        //AB-StoreStart
34550>>>>>        
34550>>>>>        
34550>>>>>        //AB-StoreEnd
34550>>>>>
34550>>>>>    End_Object    // Branch_Branch_Name
34551>>>>>
34551>>>>>    Object Year_Year_Year is a dbFormSub
34553>>>>>        Entry_Item Year.Year_year
34554>>>>>        Set Size to 13 71
34555>>>>>        Set Location to 37 112
34556>>>>>        Set Label_Col_Offset to 2
34557>>>>>        Set Label_Justification_Mode to jMode_Right
34558>>>>>        Set Prompt_Button_Mode to pb_PromptOn
34559>>>>>        Set Auto_Clear_Deo_State to FALSE
34560>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34561>>>>>
34561>>>>>        //AB-StoreStart
34561>>>>>        Set Prompt_Object to (sl003(Self))
34562>>>>>        
34562>>>>>        Procedure Prompt_CallBack Integer hPrompt
34564>>>>>            String lsCompanyCode lsBranchCode
34565>>>>>            integer icheck
34565>>>>>            get checked_state of (chkxr(self)) to icheck
34566>>>>>            Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
34567>>>>>            Get Field_Current_Value of Branch_DD  Field Branch.Branch_Code   to lsBranchCode
34568>>>>>            Set psFragmaCompanyCode of hPrompt to lsCompanyCode
34569>>>>>            Set psFragmaBranchCode  of hPrompt to lsBranchCode
34570>>>>>            set pifragmaactive      of hPrompt to icheck
34571>>>>>        End_Procedure
34572>>>>>        
34572>>>>>        
34572>>>>>        
34572>>>>>        
34572>>>>>        
34572>>>>>        
34572>>>>>        //AB-StoreEnd
34572>>>>>
34572>>>>>    End_Object    // Year_Year_Year
34573>>>>>
34573>>>>>    Object Year_Year_Descr is a dbFormSub
34575>>>>>        Entry_Item Year.Year_descr
34576>>>>>        Set Size to 13 168
34577>>>>>        Set Location to 37 188
34578>>>>>        Set Color to 12232306
34579>>>>>        Set Label_Col_Offset to 2
34580>>>>>        Set Label_Justification_Mode to jMode_Right
34581>>>>>        Set Enabled_State to FALSE
34582>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34583>>>>>        Set Item_Shadow_State Item 0 to TRUE
34584>>>>>        Set Shadow_State Item 0 to TRUE
34585>>>>>
34585>>>>>        //AB-StoreStart
34585>>>>>        
34585>>>>>        //AB-StoreEnd
34585>>>>>
34585>>>>>    End_Object    // Year_Year_Descr
34586>>>>>
34586>>>>>    Object Year_Year_Entrydate is a dbFormSub
34588>>>>>        Entry_Item Year.Year_entrydate
34589>>>>>        Set Size to 13 71
34590>>>>>        Set Location to 52 112
34591>>>>>        Set Label_Col_Offset to 2
34592>>>>>        Set Label_Justification_Mode to jMode_Right
34593>>>>>        Set Auto_Clear_Deo_State to FALSE
34594>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34595>>>>>    End_Object    // Year_Year_Entrydate
34596>>>>>
34596>>>>>    Object oOk_bn is a ButtonSub
34598>>>>>        Set Label to "€§¦›¦®ã (F2)"
34599>>>>>        Set Size to 17 54
34600>>>>>        Set Location to 74 188
34601>>>>>        Set Form_FontHeight Item 0 to 14
34602>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34603>>>>>
34603>>>>>        //AB-StoreStart
34603>>>>>        
34603>>>>>        Procedure OnClick
34605>>>>>            Delegate Send AcceptTheValues
34607>>>>>        End_Procedure
34608>>>>>        
34608>>>>>        
34608>>>>>        
34608>>>>>        
34608>>>>>        //AB-StoreEnd
34608>>>>>
34608>>>>>    End_Object    // oOk_bn
34609>>>>>
34609>>>>>    Object oCancel_bn is a ButtonSub
34611>>>>>        Set Label to "„¥¦›¦ª "
34612>>>>>        Set Size to 17 54
34613>>>>>        Set Location to 74 302
34614>>>>>        Set Form_FontHeight Item 0 to 14
34615>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34616>>>>>
34616>>>>>        //AB-StoreStart
34616>>>>>        
34616>>>>>        Procedure OnClick
34618>>>>>           Send Exit_Application to oSelectYear
34619>>>>>        End_Procedure
34620>>>>>        
34620>>>>>        
34620>>>>>        
34620>>>>>        //AB-StoreEnd
34620>>>>>
34620>>>>>    End_Object    // oCancel_bn
34621>>>>>
34621>>>>>    Object otxtCompany is a TextBoxSub
34623>>>>>        Set Label to "„«˜ ¨œå˜"
34624>>>>>        Set Auto_Size_State to FALSE
34625>>>>>        Set Color to 12232306
34626>>>>>        Set FontSize to 14 8
34627>>>>>        Set Location to 9 10
34628>>>>>        Set Size to 10 35
34629>>>>>        Set FontWeight to 600
34630>>>>>        Set TypeFace to "MS Sans Serif"
34631>>>>>        Set Enabled_State to TRUE
34632>>>>>    End_Object    // otxtCompany
34633>>>>>
34633>>>>>    Object otxtBranch is a TextBoxSub
34635>>>>>        Set Label to "“§¦¡˜«˜©«ã£˜«˜"
34636>>>>>        Set Auto_Size_State to FALSE
34637>>>>>        Set Color to 12232306
34638>>>>>        Set FontSize to 14 8
34639>>>>>        Set Location to 23 10
34640>>>>>        Set Size to 10 63
34641>>>>>        Set FontWeight to 600
34642>>>>>        Set TypeFace to "MS Sans Serif"
34643>>>>>        Set Enabled_State to TRUE
34644>>>>>    End_Object    // otxtBranch
34645>>>>>
34645>>>>>    Object otxtYear is a TextBoxSub
34647>>>>>        Set Label to "•¨ã©ž :          "
34648>>>>>        Set Auto_Size_State to FALSE
34649>>>>>        Set Color to 12232306
34650>>>>>        Set FontSize to 14 8
34651>>>>>        Set Location to 38 10
34652>>>>>        Set Size to 10 40
34653>>>>>        Set FontWeight to 600
34654>>>>>        Set TypeFace to "MS Sans Serif"
34655>>>>>        Set Enabled_State to TRUE
34656>>>>>    End_Object    // otxtYear
34657>>>>>
34657>>>>>    Object otxtWorkingDay is a TextBoxSub
34659>>>>>        Set Label to "†£/¤å˜ „¨š˜©å˜ª"
34660>>>>>        Set Auto_Size_State to FALSE
34661>>>>>        Set Color to 12232306
34662>>>>>        Set FontSize to 14 8
34663>>>>>        Set Location to 52 10
34664>>>>>        Set Size to 10 63
34665>>>>>        Set FontWeight to 600
34666>>>>>        Set TypeFace to "MS Sans Serif"
34667>>>>>        Set Enabled_State to TRUE
34668>>>>>    End_Object    // otxtWorkingDay
34669>>>>>
34669>>>>>    Object otxtWorkingDay is a TextBoxSub
34671>>>>>        Set Label to "Ž¢œª ¦  ®¨ã©œ ª"
34672>>>>>        Set Auto_Size_State to FALSE
34673>>>>>        Set Color to 12232306
34674>>>>>        Set FontSize to 14 8
34675>>>>>        Set Location to 79 9
34676>>>>>        Set Size to 10 63
34677>>>>>        Set FontWeight to 600
34678>>>>>        Set TypeFace to "MS Sans Serif"
34679>>>>>        Set Enabled_State to TRUE
34680>>>>>    End_Object    // otxtWorkingDay
34681>>>>>
34681>>>>>    Object chkxr is a CheckBoxSub
34683>>>>>        Set Size to 13 22
34684>>>>>        Set Location to 79 113
34685>>>>>        Set Color to 12232306
34686>>>>>    End_Object    // chkxr
34687>>>>>
34687>>>>>
34687>>>>>    //AB-StoreStart
34687>>>>>    
34687>>>>>    On_Key Key_Ctrl+Key_X Send None
34688>>>>>    On_Key Key_Alt+Key_X  Send None
34689>>>>>    
34689>>>>>    Function ifSelect_Xrhsh Returns String
34691>>>>>        String  lsRecord_id
34692>>>>>        Set psSelectedYearRecr to gs_Selected_Year_Recr
34693>>>>>        send popup_modal
34694>>>>>        Get psSelectedYearRecr to lsRecord_id
34695>>>>>        Function_return lsRecord_Id
34696>>>>>    End_Function
34697>>>>>    
34697>>>>>    Procedure AcceptTheValues
34699>>>>>        Integer iRetVal liYearDD liCompanyDD liBranchDD
34700>>>>>        String ldcheck lsYearRecr lsSite sCname sBname sYname sNom1 sNom2 sNom3
34700>>>>>        Date ldYearXrhsh_From ldYearXrhsh_To
34700>>>>>        Move Year_DD to liYearDD
34701>>>>>        Get Field_Current_Value of liYearDD Field Year.Year_EntryDate to ldcheck
34702>>>>>        if (ldcheck = "") ;            Get Message_Box "ƒœ¤ œ§ ¢â¥˜«œ ©à©«ã ž£œ¨¦£ž¤å˜." "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
34705>>>>>        else begin
34706>>>>>            Get Field_Current_Value of liYearDD Field Year.Year_XrhshFrom   to ldYearXrhsh_From
34707>>>>>            Get Field_Current_Value of liYearDD Field Year.Year_XrhshTo     to ldYearXrhsh_To
34708>>>>>            if ((ldcheck < ldYearXrhsh_From) or (ldcheck > ldYearXrhsh_To)) ;                Get Message_Box "†£œ¨/¤å˜ œ¡«éª ¦¨åà¤" "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
34711>>>>>            else begin
34712>>>>>                Move Company_DD to liCompanyDD
34713>>>>>                Move Branch_DD  to liBranchDD
34714>>>>>                Move Year_DD    to liYearDD
34715>>>>>                send Request_Save to liYearDD
34716>>>>>                Get Field_Current_Value of liCompanyDD Field Company.Company_Code to gs_Selected_Company_Code
34717>>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_Code   to gs_Selected_Branch_Code
34718>>>>>    
34718>>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Beto_Site   to gs_Selected_Beto_Site
34719>>>>>    
34719>>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_Site   to lsSite
34720>>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Year       to gi_Selected_Year
34721>>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Recr       to lsYearRecr
34722>>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_Code0    to sNom1
34723>>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_Code00   to sNom2
34724>>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_CodeR    to sNom3
34725>>>>>    
34725>>>>>                Get Field_Current_Value of liCompanyDD Field Company.Company_Name to sCname
34726>>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_name   to sBname
34727>>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Descr      to sYname
34728>>>>>    
34728>>>>>    
34728>>>>>                Local String    sCode
34728>>>>>                Local Integer   iBreak
34728>>>>>                Move 0 to iBreak
34729>>>>>                Clear Nomisma
34730>>>>>                Find Gt Nomisma.Recnum
34731>>>>>>
34731>>>>>                While ((Found=1) And (iBreak=0))
34735>>>>>                    If (Nomisma.Einai_Euro='1') Begin
34737>>>>>                        Move 1 to iBreak
34738>>>>>                        Move Nomisma.Nomisma_Code to sCode
34739>>>>>                    End
34739>>>>>>
34739>>>>>                    If (Not(iBreak)) Find Gt Nomisma.Recnum
34742>>>>>                Loop
34743>>>>>>
34743>>>>>                Move (Trim(sCode)) to sCode
34744>>>>>    
34744>>>>>    
34744>>>>>                Reread SysCurXR
34748>>>>>                Move gs_Selected_Company_Code   to SysCurXR.Company_Code
34749>>>>>                Move gs_Selected_beto_site      to SysCurXR.beto_site
34750>>>>>                Move gs_Selected_Branch_Code    to SysCurXR.Branch_Code
34751>>>>>                Move gi_Selected_Year           to SysCurXR.Year_Year
34752>>>>>                Move lsYearRecr                 to SysCurXR.Year_Recr
34753>>>>>                Move lsSite                     to SysCurXR.Branch_Site
34754>>>>>    
34754>>>>>                Move sCname                     to SysCurXR.Company_Name
34755>>>>>                Move sBname                     to SysCurXR.Branch_Name
34756>>>>>                Move sYname                     to SysCurXR.Year_Descr
34757>>>>>    
34757>>>>>                Move ldYearXrhsh_From           to SysCurXr.Year_XrhshFrom
34758>>>>>                Move ldYearXrhsh_To             to SysCurXr.Year_XrhshTo
34759>>>>>    
34759>>>>>                Move  (Trim(sNom1))             to SysCurXR.C_Code0
34760>>>>>                Move  (Trim(sNom2))             to SysCurXR.C_Code00
34761>>>>>                Move  (Trim(sNom3))             to SysCurXR.C_CodeR
34762>>>>>    
34762>>>>>                Move sCode                      to SysCurXR.Euro_Code
34763>>>>>    
34763>>>>>                Saverecord SysCurXR
34764>>>>>                Unlock
34765>>>>>>
34765>>>>>    
34765>>>>>                Move lsYearRecr                 to gs_Selected_Year_Recr
34766>>>>>                Set psSelectedYearRecr          to lsYearRecr
34767>>>>>    
34767>>>>>                Send Stop_Modal_ui
34768>>>>>    
34768>>>>>                Set kEnter_Next_State of ghoWorkSpace to TRUE
34769>>>>>            End
34769>>>>>>
34769>>>>>        end
34769>>>>>>
34769>>>>>    End_Procedure
34770>>>>>    
34770>>>>>    Set Locate_Mode to Center_On_Screen
34771>>>>>    
34771>>>>>    On_Key KCancel      Send KeyAction to (oCancel_Bn(Self))
34772>>>>>    On_Key KClose_Panel Send KeyAction to (oCancel_Bn(Self))
34773>>>>>    On_Key Ksave_record send KeyAction to (oOK_Bn(Self))
34774>>>>>    
34774>>>>>    On_Key Key_alt+Key_A send KeyAction to (oOK_Bn(Self))
34775>>>>>    On_Key Key_alt+Key_Q send KeyAction to (oCancel_Bn(Self))
34776>>>>>    
34776>>>>>    
34776>>>>>    
34776>>>>>    
34776>>>>>    
34776>>>>>    
34776>>>>>    
34776>>>>>    //AB-StoreEnd
34776>>>>>
34776>>>>>End_Object    // oSelectYear
34777>>>>>
34777>>>>>
34777>>>>>//AB-StoreStart
34777>>>>>
34777>>>>>
34777>>>>>//AB-StoreEnd
34777>>>>>
34777>>>>>//AB/ End_Object    // prj
34777>>>
34777>>>Procedure Epelexe_Xrhsh
34778>>>    Integer liCompanyDD liBranchDD liYearDD liYear liModalId
34779>>>    String lsCompany lsBranch lsWhatXrhsh
34779>>>    Move oSelectYear to liModalId
34780>>>    Get ifSelect_Xrhsh Of liModalId to lsWhatXrhsh
34781>>>    if (Trim(lsWhatXrhsh)='') Send Exit_Application
34784>>>End_Procedure
34785>>>
34785>>>Procedure Allaxe_Xrhsh
34786>>>    Integer rVal liModalId iID
34787>>>    If (Close_All_Views(Self,True)=0) Begin
34789>>>        Move oSelectYear to liModalId
34790>>>        Send Epelexe_Xrhsh
34791>>>    End
34791>>>>
34791>>>End_Procedure
34792>>>
34792>>>On_Key Key_Ctrl+Key_X Send Allaxe_Xrhsh
34793>>>On_Key Key_Alt+Key_X  Send Allaxe_Xrhsh
34794>>>
34794>>>Send Epelexe_Xrhsh
34795>>>//------------------------------
34795>>>
34795>//Send Epelexe_Xrhsh
34795>
34795>Use Menu_Sec.Sub
INCLUDING FILE: MENU_SEC.SUB
34795>>>
34795>>>Use Idiotht.pkg
INCLUDING FILE: IDIOTHT.PKG
34795>>>>>
34795>>>>>Open Users
34797>>>>>Open UserGrps
INCLUDING FILE: USERGRPS.FD
34799>>>>>Open Pedia
INCLUDING FILE: PEDIA.FD
34801>>>>>Open Arxeia
INCLUDING FILE: ARXEIA.FD
34803>>>>>Open GrpPedia
INCLUDING FILE: GRPPEDIA.FD
34805>>>>>Open GrpPed0
INCLUDING FILE: GRPPED0.FD
34807>>>>>Open GrpArx
INCLUDING FILE: GRPARX.FD
34809>>>>>Open GrpArx0
INCLUDING FILE: GRPARX0.FD
34811>>>>>Open ViewFlds
INCLUDING FILE: VIEWFLDS.FD
34813>>>>>Open Oth
INCLUDING FILE: OTH.FD
34815>>>>>Open GrpOth
INCLUDING FILE: GRPOTH.FD
34817>>>>>Open GrpOth0
INCLUDING FILE: GRPOTH0.FD
34819>>>>>Open Departm
INCLUDING FILE: DEPARTM.FD
34821>>>>>
34821>>>>>
34821>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
34822>>>>>
34822>>>>>Function Network_User_Name Returns String
34823>>>>>    Local String sName sLength
34824>>>>>    Local Pointer lpName_Addr lpLength_Addr
34824>>>>>    Local Integer iRetval
34824>>>>>    Movestr (Repeat (Character (0), 255)) To sName
34825>>>>>>
34825>>>>>    GetAddress Of sName To lpName_Addr
34826>>>>>    Movestr (DwordToBytes (255)) To sLength
34827>>>>>>
34827>>>>>    GetAddress Of sLength To lpLength_Addr
34828>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
34829>>>>>>
34829>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
34832>>>>>    Else Function_Return "User Unknown"
34834>>>>>End_Function // Network_User_Name
34835>>>>>
34835>>>>>Function fsGetOfficePath Global Returns String
34836>>>>>    String sRegistryKeyPath sRegOfficePath
34837>>>>>    Set_Registry_Root                                                   to HKEY_LOCAL_MACHINE "Software"
34838>>>>>    Move "Microsoft\Office\9.0\Word"                                    to sRegistryKeyPath
34839>>>>>    Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path"    to sRegOfficePath
34843>>>>>    Move (Trim(sRegOfficePath))                                         to sRegOfficePath
34844>>>>>    If (sRegOfficePath='') Begin
34846>>>>>        Move "Microsoft\Office\8.0\Word"                                to sRegistryKeyPath
34847>>>>>        Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34851>>>>>        Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34852>>>>>        If (sRegOfficePath='') Begin
34854>>>>>            Move "Microsoft\Office\7.0\Word"                             to sRegistryKeyPath
34855>>>>>            Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34859>>>>>            Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34860>>>>>            If (sRegOfficePath='') Begin
34862>>>>>                Move "Microsoft\Office\10.0\Word"                                to sRegistryKeyPath
34863>>>>>                Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34867>>>>>                Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34868>>>>>            End
34868>>>>>>
34868>>>>>        End
34868>>>>>>
34868>>>>>    End
34868>>>>>>
34868>>>>>    Function_Return sRegOfficePath
34869>>>>>End_Procedure
34870>>>>>
34870>>>>>
34870>>>>>Function fsGetLastDir Global Returns String
34871>>>>>    String sRegistryKeyPath sRegDir sUserName
34872>>>>>    Get Network_User_Name to sUserName
34873>>>>>
34873>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
34876>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
34879>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
34881>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
34883>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
34884>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
34885>>>>>    Get_profile_string sRegistryKeyPath "Path" to sRegDir
34888>>>>>    Function_Return sRegDir
34889>>>>>End_Procedure
34890>>>>>
34890>>>>>Function fiPutLastDir Global String asDirectory Returns Integer
34891>>>>>    String sRegistryKeyPath sRegDir sUserName
34892>>>>>    Get Network_User_Name to sUserName
34893>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
34896>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
34899>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
34901>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
34903>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
34904>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
34905>>>>>    Set_profile_string sRegistryKeyPath "Path" to asDirectory
34908>>>>>    Function_Return 0
34909>>>>>End_Procedure
34910>>>>>
34910>>>>>
34910>>>>>Function fsVresExt Global String asFileName Returns String
34911>>>>>    String rVal
34912>>>>>    Integer iPos iLen
34912>>>>>    Move (UpperCase(asFileName)) to asFileName
34913>>>>>    Move (Trim(asFileName)) to asFileName
34914>>>>>    Move 0 to iPos
34915>>>>>    For iLen from 1 to (length(asFileName))
34921>>>>>>
34921>>>>>        If (Mid(asFileName,1,iLen)='.') Move iLen to iPos
34924>>>>>    Loop
34925>>>>>>
34925>>>>>    If (Not(iPos)) Function_Return ''
34928>>>>>    Move (Right(asFileName,(Length(asFileName)-iPos))) to rVal
34929>>>>>    Move (Trim(rVal)) to rVal
34930>>>>>    Function_Return rVal
34931>>>>>End_Function
34932>>>>>
34932>>>>>
34932>>>>>Function fiScreenFieldStatus Global String asViewName String asDbFormName Returns Integer
34933>>>>>    Integer rVal iUser iGroup
34934>>>>>    String  sUser sRecr
34934>>>>>    Move (Trim(asViewName))     to asViewName
34935>>>>>    Move (Trim(asDbFormName))   to asDbFormName
34936>>>>>
34936>>>>>    If ((asViewName<>'') And (asDbFormName<>'')) Begin
34938>>>>>        Get fsLoginUserID to sUser
34939>>>>>        Clear Users
34940>>>>>        Move sUser        to Users.Login_ID
34941>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34942>>>>>>
34942>>>>>        If (Found=1) Begin
34944>>>>>            Move Users.User_ID  to iUser
34945>>>>>            Move Users.Grp_ID   to iGroup
34946>>>>>            Clear GrpOth
34947>>>>>            Move iUser          to GrpOth.User_ID
34948>>>>>            Move asViewName     to GrpOth.View_Name
34949>>>>>            Move asDbFormName   to GrpOth.Scr_Field_Name
34950>>>>>            Find eq GrpOth by Index.2 // GrpOth:Index.2:User_ID+View_Name+Scr_Field_Name
34951>>>>>>
34951>>>>>            If (Found=1) Begin
34953>>>>>                // rVal=1 ==> NO READ ALLOWED
34953>>>>>                // rVal=2 ==> NO EDIT BUT CAN COPY
34953>>>>>                // rVal=3 ==> NO EDIT AND NO COPY
34953>>>>>                If (GrpOth.Allow_Read <>'1') Move 1 to rVal
34956>>>>>                Else Begin
34957>>>>>                    If (GrpOth.Allow_Change<>'1') Begin
34959>>>>>                        If (GrpOth.Allow_Copy<>'1') Move 3 to rVal
34962>>>>>                        Else                        Move 2 to rVal
34964>>>>>                    End
34964>>>>>>
34964>>>>>                End
34964>>>>>>
34964>>>>>            End
34964>>>>>>
34964>>>>>            Else Begin
34965>>>>>                Clear GrpOth0
34966>>>>>                Move iGroup         to GrpOth0.Group_ID
34967>>>>>                Move asViewName     to GrpOth0.View_Name
34968>>>>>                Move asDbFormName   to GrpOth0.Scr_Field_Name
34969>>>>>
34969>>>>>                Find eq GrpOth0 by Index.2 // GrpOth0:Index.2:Group_ID+View_Name+Scr_Field_Name
34970>>>>>>
34970>>>>>                If (Found=1) Begin
34972>>>>>                    // rVal=1 ==> NO READ ALLOWED
34972>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
34972>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
34972>>>>>                    If (GrpOth0.Allow_Read <>'1') Move 1 to rVal
34975>>>>>                    Else Begin
34976>>>>>                        If (GrpOth0.Allow_Change<>'1') Begin
34978>>>>>                            If (GrpOth0.Allow_Copy<>'1') Move 3 to rVal
34981>>>>>                            Else                         Move 2 to rVal
34983>>>>>                        End
34983>>>>>>
34983>>>>>                    End
34983>>>>>>
34983>>>>>                End
34983>>>>>>
34983>>>>>                Else Move 0 to rVal
34985>>>>>            End
34985>>>>>>
34985>>>>>        End
34985>>>>>>
34985>>>>>        Else Move 0 to rVal
34987>>>>>    End
34987>>>>>>
34987>>>>>    Function_Return rVal
34988>>>>>End_Function
34989>>>>>
34989>>>>>Function fiFieldStatus Global Integer aiFileNumber Integer aiFieldNumber Returns Integer
34990>>>>>    Integer rVal iUser iGroup
34991>>>>>    String  sUser sRecr
34991>>>>>    If ((aiFileNumber) And (aiFieldNumber)) Begin
34993>>>>>        Get fsLoginUserID to sUser
34994>>>>>        Clear Users
34995>>>>>        Move sUser        to Users.Login_ID
34996>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34997>>>>>>
34997>>>>>        If (Found=1) Begin
34999>>>>>            Move Users.User_ID  to iUser
35000>>>>>            Move Users.Grp_ID   to iGroup
35001>>>>>            Clear Pedia
35002>>>>>            Move aiFileNumber  to Pedia.Arxeio_ID
35003>>>>>            Move aiFieldNumber to Pedia.Pedio_Number
35004>>>>>            Find eq Pedia By Index.1 // Pedia:Index.1:Arxeio_ID+Pedio_Number
35005>>>>>>
35005>>>>>            If (Found=1) Begin
35007>>>>>                Move (Trim(Pedia.Pedio_Recr))   to sRecr
35008>>>>>                // Find Combination User/File/Field in GRPPEDIA
35008>>>>>                Clear GrpPedia
35009>>>>>                Move iUser                      to GrpPedia.User_ID
35010>>>>>                Move (Trim(sRecr))              to GrpPedia.Pedio_Recr
35011>>>>>                Find eq GrpPedia by Index.4 // GrpPedia:Index.4:Pedio_Recr + User_ID
35012>>>>>>
35012>>>>>                If (Found=1) Begin
35014>>>>>                    // rVal=1 ==> NO READ ALLOWED
35014>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
35014>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
35014>>>>>                    If (GrpPedia.Allow_Read <>'1') Move 1 to rVal
35017>>>>>                    Else Begin
35018>>>>>                        If (GrpPedia.Allow_Change<>'1') Begin
35020>>>>>                            If (GrpPedia.Allow_Copy<>'1')   Move 3 to rVal
35023>>>>>                            Else                            Move 2 to rVal
35025>>>>>                        End
35025>>>>>>
35025>>>>>                    End
35025>>>>>>
35025>>>>>                End
35025>>>>>>
35025>>>>>                Else Begin
35026>>>>>                    // Find Combination UserGrps/File/Field in GRPPED0
35026>>>>>                    Clear GrpPed0
35027>>>>>                    Move iGroup         to GrpPed0.Group_ID
35028>>>>>                    Move (Trim(sRecr))  to GrpPed0.Pedio_Recr
35029>>>>>                    Find eq GrpPed0 by Index.4 // GrpPed0:Index.4:Pedio_Recr + Group_ID
35030>>>>>>
35030>>>>>                    If (Found=1) Begin
35032>>>>>                        // rVal=1 ==> NO READ ALLOWED
35032>>>>>                        // rVal=2 ==> NO EDIT BUT CAN COPY
35032>>>>>                        // rVal=3 ==> NO EDIT AND NO COPY
35032>>>>>                        If (GrpPed0.Allow_Read <>'1') Move 1 to rVal
35035>>>>>                        Else Begin
35036>>>>>                            If (GrpPed0.Allow_Change<>'1') Begin
35038>>>>>                                If (GrpPed0.Allow_Copy<>'1')   Move 3 to rVal
35041>>>>>                                Else                           Move 2 to rVal
35043>>>>>                            End
35043>>>>>>
35043>>>>>                        End
35043>>>>>>
35043>>>>>                    End
35043>>>>>>
35043>>>>>                End
35043>>>>>>
35043>>>>>            End
35043>>>>>>
35043>>>>>            Else Begin
35044>>>>>                Move 0 to rVal
35045>>>>>            End
35045>>>>>>
35045>>>>>        End
35045>>>>>>
35045>>>>>        Else Begin
35046>>>>>            Move 0 to rVal
35047>>>>>        End
35047>>>>>>
35047>>>>>    End
35047>>>>>>
35047>>>>>    Function_Return rVal
35048>>>>>End_Function
35049>>>>>
35049>>>>>Function fsReturnFileFromPath Global String asFullPath Returns String
35050>>>>>    String rVal lsDirSep
35051>>>>>    Integer iPos iMet iLen iCnt
35051>>>>>    Move (Trim(asFullPath))                 To rVal
35052>>>>>    Move (Sysconf(SYSCONF_DIR_SEPARATOR))   To lsDirSep
35053>>>>>    If (rVal Contains lsDirSep) Begin
35055>>>>>        Move (Length(rVal)) to iLen
35056>>>>>        Move iLen to iCnt
35057>>>>>        While iCnt Gt 0
35061>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Begin
35063>>>>>                If (iCnt=iLen) Function_Return asFullPath
35066>>>>>                Else Function_Return (Right(rVal,(iLen-iCnt)))
35068>>>>>            End
35068>>>>>>
35068>>>>>            Decrement iCnt
35069>>>>>        End // While iCnt Gt 0
35070>>>>>>
35070>>>>>    End
35070>>>>>>
35070>>>>>    Else  Function_Return (Trim(asFullPath))
35072>>>>>    Function_Return rVal
35073>>>>>End_Function
35074>>>>>
35074>>>>>Function fsReturnDirectoriesFromPath Global String asFullPath Returns String
35075>>>>>    String rVal lsDirSep
35076>>>>>    Integer iPos iMet iLen iCnt
35076>>>>>    Move (Trim(asFullPath))                 To rVal
35077>>>>>    Move (Sysconf(SYSCOnF_DIR_SEPARATOR))   To lsDirSep
35078>>>>>    If (rVal Contains lsDirSep) Begin
35080>>>>>        Move (Length(rVal)) to iLen
35081>>>>>        Move iLen to iCnt
35082>>>>>        While iCnt Gt 0
35086>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Function_Return (Left(rVal,iCnt))
35089>>>>>            Decrement iCnt
35090>>>>>        End // While iCnt Gt 0
35091>>>>>>
35091>>>>>    End
35091>>>>>>
35091>>>>>    Function_Return rVal
35092>>>>>End_Function
35093>>>>>
35093>>>>>//Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
35093>>>>>//    Local String rVal lsTmp lsOO lsLL
35093>>>>>//    Local Number lnOO lnLL
35093>>>>>
35093>>>>>//    Move '' to lsOO
35093>>>>>//    Move '' to lsLL
35093>>>>>//    Move '' to rVal
35093>>>>>
35093>>>>>//    Move (Integer(anTime))                              to lnOO
35093>>>>>//    ////////////////////////////////////////////
35093>>>>>//    // sos sos sos jsjsjsjsjs yannis 30/03/2000
35093>>>>>//    //If ((lnOO=24) and (lnll=0)) Move 0 to lnOO
35093>>>>>//    ////////////////////////////////////////////
35093>>>>>
35093>>>>>//    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
35093>>>>>
35093>>>>>//    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
35093>>>>>//    Else         Move (String(lnOO))                    to lsOO
35093>>>>>//    Move (Trim(lsOO))                                   to lsOO
35093>>>>>
35093>>>>>//    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
35093>>>>>//    Else         Move (String(lnLL))                    to lsLL
35093>>>>>//    Move (Trim(lsLL))                                   to lsLL
35093>>>>>
35093>>>>>//    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
35093>>>>>
35093>>>>>//    Move (Trim(rVal)) to rVal
35093>>>>>
35093>>>>>//    Function_Return rVal
35093>>>>>//End_Function
35093>>>>>
35093>>>>>//Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
35093>>>>>//    Local Number rVal nOres nLepta
35093>>>>>//    Move (Integer(aiMinutes/60))    to nOres
35093>>>>>//    Move (    Mod(aiMinutes,60))    to nLepta
35093>>>>>//    Move (nOres+(nLepta/100))       to rVal
35093>>>>>//    Function_Return rVal
35093>>>>>//End_Function
35093>>>>>
35093>>>>>//Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
35093>>>>>//    Local Integer rVal
35093>>>>>//    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
35093>>>>>//    Function_Return rVal
35093>>>>>//End_Function
35093>>>>>
35093>>>>>//Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;
35093>>>>>//                                                                    Number anEndTime    ;
35093>>>>>//                                                                    Returns Integer
35093>>>>>//    Local Integer rVal iMinStart iMinEnd
35093>>>>>
35093>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
35093>>>>>
35093>>>>>//    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
35093>>>>>//    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
35093>>>>>//    Move (iMinEnd-iMinStart)                                                     to rVal
35093>>>>>//    Function_Return rVal
35093>>>>>//End_Function
35093>>>>>
35093>>>>>
35093>>>>>//Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;
35093>>>>>//                                                                Number anEndTime    ;
35093>>>>>//                                                                Returns Number
35093>>>>>//    Local Integer iTmp
35093>>>>>//    Local Number  rVal
35093>>>>>
35093>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
35093>>>>>
35093>>>>>//    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
35093>>>>>//    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
35093>>>>>//    Function_Return rVal
35093>>>>>//End_Function
35093>>>>>
35093>>>>>
35093>>>>>Function fsLoginUserID Global Returns String
35094>>>>>    Local String LastLogin# LoginUserid#
35095>>>>>    get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin#
35098>>>>>    If LastLogin# eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin#
35101>>>>>    insert "WorkSpaces\" in LastLogin# at 1
35103>>>>>    Append LastLogin# "\" (Module_Name(Self)) "\LastLogin"
35106>>>>>    get_profile_string LastLogin# "LoginUserId"  to LoginUserId#
35109>>>>>    Trim LoginUserID# to LoginUserID#
35110>>>>>>
35110>>>>>    If LoginUserId# eq "" Move (Network_User_Name(Current_Object)) to LoginUserId#
35113>>>>>    Function_Return LoginUserID#
35114>>>>>End_Function
35115>>>>>
35115>>>>>Function fiWriteRegistryLastSDFPath Global String asLastPath Returns Integer
35116>>>>>    Integer rVal
35117>>>>>    String  lsCurrentWksp
35117>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35120>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35123>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35125>>>>>    // Œœ¦ ¡¢œ ›   - Last_SDF_Path -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
35125>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
35125>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
35128>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
35131>>>>>    Function_Return rVal
35132>>>>>End_Function
35133>>>>>
35133>>>>>
35133>>>>>Function fsReadRegistryLastSDFPath Global Returns String
35134>>>>>    String rVal lsCurrentWksp
35135>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35138>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35141>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35143>>>>>    // Œœ¦ ¡¢œ ›   - LastParastUsed -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
35143>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
35143>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
35146>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
35149>>>>>    Function_Return (Trim(rVal))
35150>>>>>End_Function
35151>>>>>
35151>>>>>
35151>>>>>Function fiWriteRegistryLastMCryptPath Global String asLastPath Returns Integer
35152>>>>>    Integer rVal
35153>>>>>    String  lsCurrentWksp
35153>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35156>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35159>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35161>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
35164>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
35167>>>>>    Function_Return rVal
35168>>>>>End_Function
35169>>>>>
35169>>>>>
35169>>>>>Function fsReadRegistryLastMCryptPath Global Returns String
35170>>>>>    String rVal lsCurrentWksp
35171>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35174>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35177>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35179>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
35182>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
35185>>>>>    Function_Return (Trim(rVal))
35186>>>>>End_Function
35187>>>>>
35187>>>>>Function fiWriteRegistryLastWEBPath Global String asLastPath Returns Integer
35188>>>>>    Integer rVal
35189>>>>>    String  lsCurrentWksp
35189>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35192>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35195>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35197>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
35200>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
35203>>>>>    Function_Return rVal
35204>>>>>End_Function
35205>>>>>
35205>>>>>
35205>>>>>Function fsReadRegistryLastWEBPath Global Returns String
35206>>>>>    String rVal lsCurrentWksp
35207>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35210>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35213>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35215>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
35218>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
35221>>>>>    Function_Return (Trim(rVal))
35222>>>>>End_Function
35223>>>>>
35223>>>>>Function fsReadRegistryFEMRootDir Global Returns String
35224>>>>>    String rVal lsCurrentWksp
35225>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35228>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35231>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35233>>>>>    Append lsCurrentWksp "\FEM"
35234>>>>>    Get_Profile_String lsCurrentWksp "RootDir"  to rVal
35237>>>>>    Function_Return (Trim(rVal))
35238>>>>>End_Function
35239>>>>>
35239>>>>>Function fsReadRegistryFEMDevicePath Global Returns String
35240>>>>>    String rVal lsCurrentWksp
35241>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35244>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35247>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35249>>>>>    Append lsCurrentWksp "\FEM"
35250>>>>>    Get_Profile_String lsCurrentWksp "DevicePath"  to rVal
35253>>>>>    Function_Return (Trim(rVal))
35254>>>>>End_Function
35255>>>>>
35255>>>>>Function fiWriteRegistryFEMRootDir Global Returns Integer
35256>>>>>    Integer rVal
35257>>>>>    String  lsCurrentWksp
35257>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35260>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35263>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35265>>>>>    Append lsCurrentWksp "\FEM"
35266>>>>>    Set_Profile_String lsCurrentWksp "RootDir"  to "C:\FEM_ROOT\"
35269>>>>>    Function_Return rVal
35270>>>>>End_Function
35271>>>>>
35271>>>>>Function fiWriteRegistryFEMDevicePath Global Returns Integer
35272>>>>>    Integer rVal
35273>>>>>    String  lsCurrentWksp
35273>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35276>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35279>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35281>>>>>    Append lsCurrentWksp "\FEM"
35282>>>>>    Set_Profile_String lsCurrentWksp "DevicePath"  to "C:\FEM_ROOT\Device_File1.dat"
35285>>>>>    Function_Return rVal
35286>>>>>End_Function
35287>>>>>
35287>>>>>
35287>>>>>
35287>>>>>
35287>>>>>
35287>>>>>Function fig_Is_Admin Global Returns Integer
35288>>>>>    String sUser
35289>>>>>    Integer rVal
35289>>>>>    Get fsLoginUserID to sUser
35290>>>>>    Move (trim(sUser)) to sUser
35291>>>>>    Clear Users
35292>>>>>    Move sUser to Users.Login_ID
35293>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35294>>>>>>
35294>>>>>    Move Users.Admin_Rights to rVal
35295>>>>>    Function_Return rVal
35296>>>>>End_Function
35297>>>>>
35297>>>>>Function fig_The_User_Group Global Returns Integer
35298>>>>>    String sUser
35299>>>>>    Get fsLoginUserID   to sUser
35300>>>>>    Move (trim(sUser))  to sUser
35301>>>>>    Clear Users
35302>>>>>    Move sUser          to Users.Login_ID
35303>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35304>>>>>>
35304>>>>>    Clear UserGrps
35305>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
35306>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
35307>>>>>>
35307>>>>>    Function_Return UserGrps.Grp_ID
35308>>>>>End_Function
35309>>>>>
35309>>>>>Function fsg_The_User_Department Global Returns String
35310>>>>>    String sUser
35311>>>>>    Get fsLoginUserID   to sUser
35312>>>>>    Move (trim(sUser))  to sUser
35313>>>>>    Clear Users
35314>>>>>    Move sUser          to Users.Login_ID
35315>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35316>>>>>>
35316>>>>>    Clear Departm
35317>>>>>    Move Users.Departm_Code   to Departm.Code
35318>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
35319>>>>>>
35319>>>>>    Function_Return Departm.Code
35320>>>>>End_Function
35321>>>>>
35321>>>>>
35321>>>>>Function fig_Is_Specific_Admin Global String asUser Returns Integer
35322>>>>>    Integer rVal
35323>>>>>    Move (trim(asUser)) to asUser
35324>>>>>    Clear Users
35325>>>>>    Move asUser to Users.Login_ID
35326>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35327>>>>>>
35327>>>>>    Move Users.Admin_Rights to rVal
35328>>>>>    Function_Return rVal
35329>>>>>End_Function
35330>>>>>
35330>>>>>Function fig_The_Specific_User_Group Global String asUser Returns Integer
35331>>>>>    Move (trim(asUser))  to asUser
35332>>>>>    Clear Users
35333>>>>>    Move asUser          to Users.Login_ID
35334>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35335>>>>>>
35335>>>>>    Clear UserGrps
35336>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
35337>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
35338>>>>>>
35338>>>>>    Function_Return UserGrps.Grp_ID
35339>>>>>End_Function
35340>>>>>
35340>>>>>Function fsg_The_Specific_User_Department Global String asUser Returns String
35341>>>>>    Move (trim(asUser))  to asUser
35342>>>>>    Clear Users
35343>>>>>    Move asUser          to Users.Login_ID
35344>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35345>>>>>>
35345>>>>>    Clear Departm
35346>>>>>    Move Users.Departm_Code   to Departm.Code
35347>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
35348>>>>>>
35348>>>>>    Function_Return Departm.Code
35349>>>>>End_Function
35350>>>>>
35350>>>>>
35350>>>
35350>>>Class ViewPopupMenu_Sec Is A ViewPopupMenu
35351>>>
35351>>>    Open Sysfile
INCLUDING FILE: SYSFILE.FD
35353>>>    Open Users
35355>>>    Open Views
INCLUDING FILE: VIEWS.FD
35357>>>    Open GrpViews
INCLUDING FILE: GRPVIEWS.FD
35359>>>    Open GrpView0
INCLUDING FILE: GRPVIEW0.FD
35361>>>    Open Arxeia
35363>>>    Open GrpArx
35365>>>
35365>>>    Function Find_User_Rights_In_Class String asView Returns Integer
35366>>>        String  lsView lsLogin
35367>>>        Integer liUser  liViews iGroup
35367>>>
35367>>>        Move (fsLoginUserID())      to lsLogin
35368>>>        Move (Trim(ToOEM(asView)))  to lsView
35369>>>
35369>>>        //////  /////////////////////////////////////
35369>>>        Clear Users
35370>>>        Move lsLogin    to Users.Login_ID
35371>>>
35371>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
35372>>>>
35372>>>        If (Found=1)  Begin
35374>>>            Move Users.User_ID  to liUser
35375>>>            Move Users.Grp_ID   to iGroup
35376>>>        End
35376>>>>
35376>>>        Else Function_Return 0
35378>>>
35378>>>        Clear Views
35379>>>        Move (Trim(lsView)) to Views.Menu_Name
35380>>>        Find eq Views by Index.2 // Views:Index.2:Views.Menu_Name
35381>>>>
35381>>>        If (Found=1) Begin
35383>>>            Move Views.View_ID to liViews
35384>>>            Clear GrpViews
35385>>>            Move liUser    to GrpViews.User_ID
35386>>>            Move liViews   to GrpViews.View_ID
35387>>>            Find Eq GrpViews by Index.1 // GrpViews:Index.1:GrpViews.User_ID+GrpViews.View_ID
35388>>>>
35388>>>            If (Found=1) Begin // And (liUser=GrpViews.User_ID) And (liViews=GrpViews.View_ID)) Begin
35390>>>                Function_Return (GrpViews.Allow_Read<>'1')
35391>>>            End
35391>>>>
35391>>>            Else Begin
35392>>>                Clear GrpView0
35393>>>                Move iGroup    to GrpView0.Group_ID
35394>>>                Move liViews   to GrpView0.View_ID
35395>>>                Find eq GrpView0 by Index.1 // GrpView0:Index.1:Group_ID+View_ID
35396>>>>
35396>>>                If (Found=1) Begin
35398>>>                    Function_Return (GrpView0.Allow_Read<>'1')
35399>>>                End
35399>>>>
35399>>>                Else         Function_Return 0
35401>>>            End
35401>>>>
35401>>>        End
35401>>>>
35401>>>        Else Function_Return 0
35403>>>    End_Function
35404>>>
35404>>>//    Procedure Enhmerose_Views_File_In_Class
35404>>>//        Integer liCount liInt liLastNo
35404>>>//        String lsStr
35404>>>//        Get Item_Count to liCount
35404>>>//        // find last view_id
35404>>>//        Clear Views
35404>>>//        Move 9999 to Views.View_ID
35404>>>//        Find lt Views by index.1 // view_id
35404>>>//        If (Found=1)    Move Views.View_ID  to liLastNo
35404>>>//        Else            Move 0              to liLastNo
35404>>>//        For liInt From 0 to (liCount-1)
35404>>>//            Get Value item liInt to lsStr
35404>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
35404>>>//            //Move (Trim(lsStr)) to lsStr
35404>>>//            If (lsStr<>'') Begin
35404>>>//                Clear Views
35404>>>//                Move lsStr to Views.Menu_Name
35404>>>//                Find eq Views by index.2 // Views.Menu_Name
35404>>>//                If (NOT(Found)) Begin
35404>>>//                    Add 1 to liLastNo
35404>>>//                    Move liLastNo to Views.View_ID
35404>>>//                    Saverecord Views
35404>>>//                End
35404>>>//            End
35404>>>//        Loop
35404>>>//        For liInt From 0 to (liCount-1)
35404>>>//            Get Value item liInt to lsStr
35404>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
35404>>>//            //Move (Trim(lsStr)) to lsStr
35404>>>//            If (lsStr<>'') Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
35404>>>//        Loop
35404>>>//    End_procedure
35404>>>
35404>>>    Procedure OnInitMenu
35405>>>        Integer liCount liInt liLastNo
35406>>>        String lsStr
35406>>>
35406>>>        Get Item_Count to liCount
35407>>>
35407>>>        // find last view_id
35407>>>        Clear Views
35408>>>        Move 9999 to Views.View_ID
35409>>>        Find lt Views by index.1 // view_id
35410>>>>
35410>>>        If (Found=1)    Move Views.View_ID  to liLastNo
35413>>>        Else            Move 0              to liLastNo
35415>>>        For liInt From 0 to (liCount-1)
35421>>>>
35421>>>            Get Value item liInt to lsStr
35422>>>            Move (Trim(lsStr)) to lsStr
35423>>>            If ((lsStr<>'') and (Length(lsStr)>2)) Begin
35425>>>                Clear Views
35426>>>                Move (ToOEM(lsStr)) to Views.Menu_Name
35427>>>                Find eq Views by index.2 // Views.Menu_Name
35428>>>>
35428>>>                If (NOT(Found)) Begin
35430>>>                    Add 1 to liLastNo
35431>>>                    Move liLastNo to Views.View_ID
35432>>>                    //Move (ToOEM(lsStr)) to Views.Menu_Name
35432>>>                    Saverecord Views
35433>>>                End
35433>>>>
35433>>>            End
35433>>>>
35433>>>        Loop
35434>>>>
35434>>>        For liInt From 0 to (liCount-1)
35440>>>>
35440>>>            Get Value item liInt to lsStr
35441>>>            Move (Trim(lsStr)) to lsStr
35442>>>            Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
35443>>>        Loop
35444>>>>
35444>>>
35444>>>    End_procedure
35445>>>
35445>>>//    Procedure End_Construct_Object
35445>>>//        Forward Send End_Construct_Object
35445>>>//        Send Enhmerose_Views_File_In_Class
35445>>>//    End_Procedure
35445>>>
35445>>>End_Class //ButtonSub
35446>>>
35446>>>
35446>Use DD_Sec.Sub
INCLUDING FILE: DD_SEC.SUB
35446>>>
35446>>>Open Sysfile
35448>>>Open UserGrps
35450>>>Open Users
35452>>>Open Views
35454>>>Open GrpViews
35456>>>Open Arxeia
35458>>>Open GrpArx
35460>>>Open GrpArx0
35462>>>Open GrpView0
35464>>>
35464>>>Use DD.Sub
35464>>>
35464>>>Class Datadictionary_Sec  Is A DatadictionarySub
35465>>>
35465>>>
35465>>>    Procedure Construct_Object
35466>>>        Forward Send Construct_Object
35468>>>        Property Integer cpiUpdate              0
35469>>>        Property Integer cpiBackout             0
35470>>>        Property Integer cpiEditing             0
35471>>>        Property Integer cpiFileNumber          0
35472>>>        Property String  cpsFileName            ''
35473>>>        Property String  cpsLoginID             ''
35474>>>        Property Integer cpiCannot_Read         0
35475>>>        Property Integer cpiCannot_Create       0
35476>>>        Property Integer cpiCannot_Delete       0
35477>>>        Property Integer cpiCannot_Edit         0
35478>>>        Property Integer piFN                   0
35479>>>    End_Procedure
35480>>>
35480>>>//    Procedure Save_Main_File
35480>>>//        If (Operation_Origin<>Self) Begin
35480>>>//            If Indirect_File.Recnum Eq 0 Procedure_Return
35480>>>//        End
35480>>>//        Forward Send Save_Main_File
35480>>>//    End_Procedure
35480>>>
35480>>>
35480>>>
35480>>>    Function Validate_Save Returns Integer
35481>>>        Integer rVal
35482>>>        Forward Get Validate_Save to rVal
35484>>>        If (Not(rVal)) Begin
35486>>>            Get cpiCannot_Read to rVal
35487>>>            If (Not(rVal)) Begin
35489>>>                Set cpiEditing to ((cpiBackout(Self)=1) and (cpiUpdate(Self)=1))
35490>>>                If (cpiEditing(Self)=1) Get cpiCannot_Edit      to rVal
35493>>>                Else                    Get cpiCannot_Create    to rVal
35495>>>            End
35495>>>>
35495>>>            If (rVal) Send Operation_Not_Allowed rVal
35498>>>        End
35498>>>>
35498>>>        Function_Return rVal
35499>>>    End_Function
35500>>>
35500>>>    Function Validate_Delete Returns Integer
35501>>>        Integer rVal
35502>>>        Forward Get Validate_Delete to rVal
35504>>>        If (Not(rVal)) Begin
35506>>>            Get cpiCannot_Read to rVal
35507>>>            If (Not(rVal)) Get cpiCannot_Delete to rVal
35510>>>            If (rVal) Send Operation_Not_Allowed rVal
35513>>>        End
35513>>>>
35513>>>        Function_Return rVal
35514>>>    End_Function
35515>>>
35515>>>    Procedure End_Construct_Object
35516>>>        Integer liSrv rVal
35517>>>        String lsStr
35517>>>        Forward Send End_Construct_Object
35519>>>        Get Main_File                                   To liSrv
35520>>>        Set cpiFileNumber                               To liSrv
35521>>>        Get_Attribute DF_FILE_PHYSICAL_NAME Of liSrv    To lsStr
35524>>>        Set cpsFileName                                 To (Trim(Uppercase(lsStr)))
35525>>>        Set cpsLoginID                                  To (fsLoginUserID())
35526>>>        Send Find_User_Rights
35527>>>        Set piFN to lisrv
35528>>>    End_Procedure
35529>>>
35529>>>    Procedure Find_User_Rights
35530>>>        String lsArxeio lsLogin
35531>>>        Integer liUser liArxeio iGroup
35531>>>
35531>>>        Get cpiFileNumber   to liArxeio
35532>>>        Get cpsFileName     to lsArxeio
35533>>>        Get cpsLoginID      to lsLogin
35534>>>
35534>>>        Clear Users
35535>>>        Move lsLogin    to Users.Login_ID
35536>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
35537>>>>
35537>>>        If (Found=1)  Begin
35539>>>            Move Users.User_ID  to liUser
35540>>>            Move Users.Grp_ID   to iGroup
35541>>>        End
35541>>>>
35541>>>        //Else Send Operation_Not_Allowed 9999
35541>>>
35541>>>        Clear Arxeia
35542>>>
35542>>>        Move liArxeio to Arxeia.Arxeio_ID
35543>>>        Find eq Arxeia by Index.1 // Arxeia:Index.1:Arxeia.Arxeio_ID
35544>>>>
35544>>>
35544>>>        If (Found=1) Begin
35546>>>            Move Arxeia.Arxeio_ID to liArxeio
35547>>>
35547>>>            Clear GrpArx
35548>>>            Move liUser     to GrpArx.User_ID
35549>>>            Move liArxeio   to GrpArx.Arxeio_ID
35550>>>            Find eq GrpArx by Index.1 // GrpArx:Index.1:GrpArx.User_ID+GrpArx.Arxeio_ID
35551>>>>
35551>>>            If (Found=1) Begin
35553>>>               If (GrpArx.Allow_Read  ='1') Set cpiCannot_Read   to 0
35556>>>               Else                         Set cpiCannot_Read   to 10003
35558>>>               If (GrpArx.Allow_Create='1') Set cpiCannot_Create to 0
35561>>>               Else                         Set cpiCannot_Create to 10000
35563>>>               If (GrpArx.Allow_Change='1') Set cpiCannot_Edit   to 0
35566>>>               Else                         Set cpiCannot_Edit   to 10001
35568>>>               If (GrpArx.Allow_Delete='1') Set cpiCannot_Delete to 0
35571>>>               Else                         Set cpiCannot_Delete to 10002
35573>>>            End
35573>>>>
35573>>>            Else Begin
35574>>>                Clear GrpArx0
35575>>>                Move iGroup   to GrpArx0.Group_ID
35576>>>                Move liArxeio to GrpArx0.Arxeio_ID
35577>>>                Find eq GrpArx0 by Index.1 // GrpArx0:Index.1:Group_ID+Arxeio_ID
35578>>>>
35578>>>                If (Found=1) Begin
35580>>>                    If (GrpArx0.Allow_Read  ='1')   Set cpiCannot_Read   to 0
35583>>>                    Else                            Set cpiCannot_Read   to 20003
35585>>>                    If (GrpArx0.Allow_Create='1')   Set cpiCannot_Create to 0
35588>>>                    Else                            Set cpiCannot_Create to 20000
35590>>>                    If (GrpArx0.Allow_Change='1')   Set cpiCannot_Edit   to 0
35593>>>                    Else                            Set cpiCannot_Edit   to 20001
35595>>>                    If (GrpArx0.Allow_Delete='1')   Set cpiCannot_Delete to 0
35598>>>                    Else                            Set cpiCannot_Delete to 20002
35600>>>                End
35600>>>>
35600>>>                Else Begin
35601>>>                    Set cpiCannot_Read   to 0
35602>>>                    Set cpiCannot_Edit   to 0
35603>>>                    Set cpiCannot_Create to 0
35604>>>                    Set cpiCannot_Delete to 0
35605>>>                End
35605>>>>
35605>>>            End
35605>>>>
35605>>>        End
35605>>>>
35605>>>        Else Begin
35606>>>            // €¤ ›œ¤ ™¨œŸœ  «¦ ˜¨®œ ¦ «¦«œ Ÿœà¨¦¬£œ ¦«  ¦ ®¨ž©«žª œ®œ  §¨¦©™˜©ž ©'˜¬«¦
35606>>>            Set cpiCannot_Read   to 0
35607>>>            Set cpiCannot_Edit   to 0
35608>>>            Set cpiCannot_Create to 0
35609>>>            Set cpiCannot_Delete to 0
35610>>>        End
35610>>>>
35610>>>    End_Procedure
35611>>>
35611>>>    Procedure Clear_main_file
35612>>>        Forward Send Clear_main_file
35614>>>        Set cpiBackout to 0
35615>>>        Set cpiUpdate  to 0
35616>>>    End_Procedure
35617>>>
35617>>>    Procedure Update
35618>>>        Forward Send Update
35620>>>        Set cpiUpdate to 1
35621>>>    End_Procedure
35622>>>
35622>>>    Procedure Backout
35623>>>        Forward Send Backout
35625>>>        Set cpiBackout to 1
35626>>>    End_Procedure
35627>>>
35627>>>    Procedure OnConstrain
35628>>>        Integer rVal liSrv
35629>>>        Forward Send OnConstrain
35631>>>        Get cpiFileNumber  To liSrv
35632>>>        Move liSrv         To Filenumber
35633>>>        Get cpiCannot_Read to rVal
35634>>>        If (rVal) Constrain Indirect_File.Recnum eq 0
35638>>>    End_Procedure
35639>>>
35639>>>    Procedure Operation_Not_Allowed  Integer iError_Num
35640>>>        String sLektiko
35641>>>        Move '' to sLektiko
35642>>>
35642>>>             If iError_Num eq 10000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
35645>>>        Else If iError_Num eq 10001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Users permissions. Check with your Administrator"    to sLektiko
35649>>>        Else If iError_Num eq 10002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
35653>>>        Else If iError_Num eq 10003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
35657>>>        Else If iError_Num eq 20000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
35661>>>        Else If iError_Num eq 20001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Group permissions. Check with your Administrator"    to sLektiko
35665>>>        Else If iError_Num eq 20002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
35669>>>        Else If iError_Num eq 20003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
35673>>>        Else If iError_Num eq  9999 Move "Unknown User in Users File"                                                                                    to sLektiko
35677>>>        Else If iError_Num eq 20101 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Change its Data"                 to sLektiko
35681>>>        Else If iError_Num eq 20102 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Delete It"                       to sLektiko
35685>>>        Append sLektiko '\nFile = ' (String(cpiFileNumber(Self))) ' - ' (CpsFileName(Self))
35689>>>
35689>>>             If iError_Num eq 10000 Error 10000 sLektiko
35692>>>        Else If iError_Num eq 10001 Error 10001 sLektiko
35696>>>        Else If iError_Num eq 10002 Error 10002 sLektiko
35700>>>        Else If iError_Num eq 10003 Error 10003 sLektiko
35704>>>        Else If iError_Num eq 20000 Error 20000 sLektiko
35708>>>        Else If iError_Num eq 20001 Error 20001 sLektiko
35712>>>        Else If iError_Num eq 20002 Error 20002 sLektiko
35716>>>        Else If iError_Num eq 20003 Error 20003 sLektiko
35720>>>        Else If iError_Num eq  9999 Error  9999 sLektiko
35724>>>        Else If iError_Num eq 20101 Error 20101 sLektiko
35728>>>        Else If iError_Num eq 20102 Error 20102 sLektiko
35732>>>
35732>>>        Else Forward Send Operation_Not_Allowed  iError_Num
35735>>>    End_Procedure   // Operation_Not_Allowed
35736>>>
35736>>>
35736>>>End_Class //Datadictionary_Sec
35737>
35737>
35737>//AB-StoreTopEnd
35737>
35737>
35737>Object Main is a Panelsub
35739>
35739>    //AB-PanelStoreTopStart
35739>    
35739>    
35739>    //AB-PanelStoreTopEnd
35739>
35739>    Set Label To "#FixTim"
35740>
35740>    DFCreate_Menu Main_Menu
INCLUDING FILE: FILE_PM.INC
35743>>//************************************************************************
35743>>//
35743>>//* Copyright (c) 1997 Data Access Corporation, Miami Florida,
35743>>//* All rights reserved.
35743>>//* DataFlex is a registered trademark of Data Access Corporation.
35743>>//*
35743>>//*
35743>>//*  Module Name:
35743>>//*      FILE_PM.INC
35743>>//*
35743>>//*  Creator:
35743>>//*        LS, MAZ, JJT(changed for windaf)
35743>>//*
35743>>//*  Date:
35743>>//*      November 31, 1992
35743>>//*      10/28/94 03:17 pm - JJT windaf chagges
35743>>//*
35743>>//*  Purpose:
35743>>//*         package for creating generic record_pull_down object for entry
35743>>//*             object actions(assumed to be used as first pull down menu,
35743>>//*             hence EXIT option as last item)
35743>>//*
35743>>//*************************************************************************
35743>>// JJT - Modified to shadow items if not a DEO OR if no server
35743>>//*************************************************************************
35743>>
35743>>
35743>>Object oMyWinPrint is an DF_PRINTER
35745>>
35745>>    Procedure DFPrint
35747>>        Local Integer iRetVal
35748>>
35748>>        Get DFGetPrintDialogFlags To iRetVal
35749>>
35749>>        If iRetVal Begin
35751>>            Send DFPrintDoc
35752>>            Send DFClearDoc
35753>>        End
35753>>>
35753>>    End_Procedure
35754>>    Move Current_Object to WinPrintId
35755>>End_Object
35756>>
35756>>Register_Procedure Set piPropertiesObjectId
35756>>Register_Function piPropertiesObjectId Returns Integer
35756>>
35756>>Register_Function Close_All_Views Integer bWith_Confirmation Returns Integer
35756>>
35756>>DFCreate_Menu "&„šš¨˜­âª" File_Menu is a DEOPopupMenu
35760>>    On_Item "&€¡ç¨à©ž/Add\aF5" send Request_Clear
35761>>        Set Status_Help To '‰˜Ÿ˜¨åœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã'
35762>>
35762>>    On_Item "&Super €¡ç¨à©ž\aCtrl+F5" send Request_Clear_All
35763>>        Set Status_Help To '‰˜Ÿ˜¨åœ  æ¢˜ «˜ ›œ›¦£â¤˜ ˜§æ «ž¤ æ¯ž'
35764>>
35764>>    On_Item "&ƒ ˜š¨˜­ã\aShift+F2" send Request_Delete
35765>>        Set Status_Help To 'ƒ ˜š¨á­œ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã'
35766>>
35766>>    On_Item "&€¤˜ã«ž©ž\aF9" send Find_GE
35767>>        Set Status_Help To '¨å©¡œ  £ á œšš¨˜­ã'
35768>>
35768>>    On_Item "&„§æ£œ¤¦\aF8" send Find_Next
35769>>        Set Status_Help To '¨å©¡œ  «ž¤ œ§æ£œ¤ž œšš¨˜­ã'
35770>>
35770>>    On_Item "&¨¦žš¦ç£œ¤¦\aF7" send Find_Previous
35771>>        Set Status_Help To '¨å©¡œ  «ž¤ §¨¦žš¦ç£œ¤ž œšš¨˜­ã'
35772>>
35772>>    //On_Item "Super ˜¤˜ã«ž©ž\aShift+F9" send Superfind
35772>>    //    Set Status_Help To 'Super_˜¤˜ã«ž©ž £ áª œšš¨˜­ãª'
35772>>
35772>>    //On_Item "Super œ§æ£œ¤¦\aShift+F8" send Superfind_Next
35772>>    //    Set Status_Help To 'Super_˜¤˜ã«ž©ž œ§æ£œ¤žª œšš¨˜­ãª'
35772>>
35772>>    //On_Item "Super §¨¦žš¦ç£œ¤¦\aShift+F7" send Superfind_Previous
35772>>    //    Set Status_Help To 'Super_˜¤˜ã«ž©ž §¨¦žš¦ç£œ¤žª œšš¨˜­ãª'
35772>>
35772>>    On_Item "&¨é«¦\aCtrl+Home" send Beginning_Of_Data
35773>>        Set Status_Help To '¨å©¡œ  «ž¤ §¨é«ž œšš¨˜­ã'
35774>>
35774>>    On_Item "’œ&¢œ¬«˜å¦\aCtrl+End" send End_Of_Data
35775>>        Set Status_Help To '¨å©¡œ  «ž¤ «œ¢œ¬«˜¢å˜ œšš¨˜­ã'
35776>>
35776>>    On_Item "&„šš¨˜­ž\aF2" send Request_Save
35777>>        Set Status_Help To '‘éœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã'
35778>>
35778>>    On_Item "" send NONE
35779>>
35779>>    //on_item   "çŸ£ ©ž œ¡«ç§à©žª  "  Send Activate_oPrnSetup to (client_area(current_object))
35779>>    on_item   "çŸ£ ©ž œ¡«ç§à©žª  "  send DFPrintSetup       to (oWinPrint(Self))
35780>>    Set Status_Help To "çŸ£ ©ž œ¡«ç§à©žª"
35781>>    on_item   "„¡«ç§à©ž           "  send DFPrint            to (oMyWinPrint(Self))
35782>>    Set Status_Help To "„¡«ç§à©ž œšš¨á­¦¬"
35783>>
35783>>    On_Item "" send NONE
35784>>
35784>>    On_Item "&ˆ› ¦«ž«œª\aAlt+I" send DoShowProperties to Self
35785>>    Set Status_Help To '‰˜Ÿ¦¨ ©£æª ˆ› ¦«ã«à¤ «žª œ­˜¨£¦šãª'
35786>>
35786>>    On_Item "" send NONE
35787>>
35787>>    On_Item "„&¥¦›¦ª\aAlt+F4" send Exit_Application to desktop
35788>>        Set Status_Help To 'š˜å¤œ  ˜§¦ «ž¤ œ­˜¨£¦šã'
35789>>
35789>>    Procedure DoShowProperties
35791>>        If (Close_All_Views(Self,True)=0) Send Activate_View to (piPropertiesObjectId(self))
35794>>    End_Procedure
35795>>
35795>>    On_Key Key_Alt+Key_I Send DoShowProperties
35796>>
35796>>    //  When ever the menu [pulldown] is initialized, check/set
35796>>    //  the state of its items.
35796>>    //
35796>>    Procedure OnInitMenu
35798>>        Local integer Obj# IsDeo Changed NoIndex File# Field# Srvr Itm
35799>>        Local integer IsDeoControl lId liClId
35799>>        Get Focus to Obj#
35800>>        Get is_Function Get_DEO_Object Obj# TRUE to IsDeo
35801>>        If IsDeo Get Server of obj# to Srvr          // invoking data-set
35804>>        If (isDeo AND Srvr) Begin
35806>>            // returns T if object in question is a DEO control object (i.e.
35806>>            // understands the data_file, data_field messages).
35806>>            Get is_Function Get_DEO_Control_Object Obj# False to IsDeoControl
35807>>            Get Should_Save of Obj# to changed  // changed file?
35808>>            If IsDEOControl Begin
35810>>                Get data_file of Obj# to file#
35811>>                Get data_field of Obj# to field#
35812>>                Move ( File#=0 OR ;                    (Field_Main_Index(Srvr,File#,Field#)=-1) ;                    ) to NoIndex             // has a find index?
35813>>            End
35813>>>
35813>>            Else ;                Move 1 to NoIndex
35815>>            Set Shadow_state item 0  to False
35816>>            Set Shadow_state item 1  to False
35817>>            Set Shadow_state item 2  to (Current_record(Srvr)=0)
35818>>            Set Shadow_state item 3  to NoIndex
35819>>            Set Shadow_state item 4  to NoIndex
35820>>            Set Shadow_state item 5  to NoIndex
35821>>            Set Shadow_state item 6  to NoIndex
35822>>            Set Shadow_state item 7  to NoIndex
35823>>            Set Shadow_state item 8  to (Should_Save(Srvr)=0)
35824>>         //   Set Shadow_state item 9  to NoIndex
35824>>         //   Set Shadow_state item 10  to NoIndex
35824>>         //   Set Shadow_state item 11 to NoIndex
35824>>         //   Set Shadow_state item 12 to (Should_Save(Srvr)=0)
35824>>        End
35824>>>
35824>>        Else Begin
35825>>            for itm from 0 to 8 //11
35831>>>
35831>>                set shadow_State item itm to TRUE
35832>>            Loop
35833>>>
35833>>        End
35833>>>
35833>>        Set Shadow_State Item 13 to (piPropertiesObjectId(Self)=0)
35834>>    End_Procedure
35835>>
35835>>    Register_Procedure Activate_oPrnSetup
35835>>
35835>>End_Pull_Down
35837>>Set Status_Help to "€¤˜ã«ž©ž, „šš¨˜­ã, ƒ ˜š¨˜­ã, €¡ç¨à©ž ›œ›¦£â¤à¤ ã â¥¦›¦ª ˜§¦ «ž¤ œ­˜¨£¦šã"
35838>
35838>        DFCreate_Menu "&View" ViewPopupMenu is a ViewPopupMenu
35842>            On_Item "&FixTim\aCtrl+1" Send Activate_FixTim
35843>        End_Pull_down
35845>        Set Status_Help To "Available Views"
35846>        
INCLUDING FILE: NAVI_PM.INC
35846>>Use DFDEOMnu
35846>>
35846>>DFCreate_Menu "&Navigation" NAVIGATE_Menu is a DEOPopupMenu
35850>>    On_Item "&Next Area\aF6"            send Switch_Next_Area
35851>>        Set Status_Help To  'Move to Next Area'
35852>>
35852>>    On_Item "&Previous Area\aShift+F6"  send Switch_Prior_Area
35853>>        Set Status_Help To  'Move to Previous Area'
35854>>
35854>>    On_Item "N&ext View\aAlt+F6"        send Switch_Next_View
35855>>        Set Status_Help To  'Move to Next View'
35856>>
35856>>    On_Item "P&revious View\aCtrl+F6"   send Switch_Prior_View
35857>>        Set Status_Help To  'Move to Previous View'
35858>>
35858>>    On_Item ""                          send none
35859>>
35859>>    On_Item "&List\aF4"               send Prompt
35860>>        Set Status_Help To  'Show Selection Lists'
35861>>
35861>>    On_Item "&Zoom\aAlt+F9"             send Zoom
35862>>        Set Status_Help To  'Show Zoom'
35863>>
35863>>    Procedure OnInitMenu
35865>>        Local integer Obj# IsDeo Itm prmpt zm isDeoControl
35866>>        Get Focus to Obj#
35867>>        Get is_Function Get_DEO_Object Obj# TRUE to IsDeo
35868>>        If IsDeo Begin
35870>>            Get is_Function Get_DEO_Control_Object Obj# False to IsDeoControl
35871>>            If IsDeoControl Begin
35873>>                Get Prompt_Object of Obj# to Prmpt
35874>>                Get Zoom_Object of Obj# to zm
35875>>            End
35875>>>
35875>>            Set Shadow_state item 0  to False
35876>>            Set Shadow_state item 1  to False
35877>>            Set Shadow_state item 2  to False
35878>>            Set Shadow_state item 3  to False
35879>>            Set Shadow_state item 5  to (Prmpt=0)
35880>>            Set Shadow_state item 6  to (Zm=0)
35881>>        End
35881>>>
35881>>        Else Begin
35882>>            for itm from 0 to 6
35888>>>
35888>>                set shadow_State item itm to TRUE
35889>>            Loop
35890>>>
35890>>        End
35890>>>
35890>>    End_Procedure
35891>>
35891>>End_Pull_Down
35893>>Set Status_Help to "Navigation in different areas of the screen"
35894>>
INCLUDING FILE: WIN_PM.INC
35894>>DFCreate_Menu "&Window" Window_Menu
35898>>    Set select_mode to Multi_Select
35899>>    // normal number of items in pulldown (w/ no active views)
35899>>    property integer std_item_count public 0
35901>>
35901>>    DFCreate_Menu "&Preferences" Display_Options_Menu
35905>>        Set select_mode to Multi_Select
35906>>        On_Item "&ToolBar"        Send Toggle_Toolbar             To Self
35907>>        On_Item "&StatusBar"      Send Toggle_Statusbar           To Self
35908>>        On_Item "&Arrange Icons"  Send Toggle_Auto_Arrange_Icons  To Self
35909>>
35909>>        //  When ever the menu [pulldown] is initialized, check/set
35909>>        //  the state of its items.
35909>>        //
35909>>        Procedure OnInitMenu
35911>>            local integer bState
35912>>
35912>>            Get ToolBar_State to bState
35913>>            Set Select_State Item 0 to bState
35914>>            if  bState   Set Status_Help Item 0 To '' //'Hide the ToolBar'
35917>>            Else         Set Status_Help Item 0 to '' //'Show the ToolBar'
35919>>
35919>>            Get Statusbar_State to bState
35920>>            Set Select_State Item 1 to bState
35921>>            if  bState  Set Status_Help Item 1 To ''// 'Hide the StatusBar'
35924>>            Else        Set Status_Help Item 1 to ''// 'Show the StatusBar'
35926>>
35926>>            Get Auto_Arrange_Icons_State to bState
35927>>            Set Select_State Item 2 to bState
35928>>            if  bState  Set Status_Help Item 2 To '' //'Hide AutoArrange Icons'
35931>>            Else        Set Status_Help Item 2 to '' //'Show AutoArrange Icons'
35933>>
35933>>        End_procedure
35934>>
35934>>
35934>>    End_Pull_Down
35936>>    Set Status_Help                                           To '' //"Enable Toolbar, StatusBar, and AutoArrange Icons options"
35937>>
35937>>    On_Item ""
35938>>
35938>>    On_Item "&Cascade" send Cascade_Windows                   To Self
35939>>        Set Status_Help                                       To ''
35940>>
35940>>    On_Item "Tile &Horizontally" send Tile_Windows_Horizontal To Self
35941>>        Set Status_Help                                       To ''
35942>>
35942>>    On_Item "Tile &Vertically" send Tile_Windows_Vertical     To Self
35943>>        Set Status_Help                                       To ''
35944>>
35944>>    On_Item ""
35945>>
35945>>    On_Item "Minimize all" send Minimize_all_Windows          To Current_Object
35946>>        Set Status_Help                                       To ''
35947>>
35947>>    On_Item "&Restore all" send Restore_all_Windows           To Current_Object
35948>>        Set Status_Help                                       To ''
35949>>
35949>>    On_Item ""
35950>>
35950>>    On_Item "&Arrange Icons" send Arrange_Icons               To Current_Object
35951>>        Set Status_Help                                       To ''
35952>>
35952>>    // set this to the number of items in the menu with no views.
35952>>    Set Std_item_count to (item_count(current_object))
35953>>
35953>>    // add all active views to the end of the menu
35953>>    Procedure OnInitMenu
35955>>        local integer iStdCnt iNumCnt hVw hCl iCount
35956>>        Local string sLbl
35956>>        //*** Remove all old view items
35956>>        Get Item_count     to iNumCnt
35957>>        get Std_item_count to iStdCnt
35958>>        For iCount from 1  to (iNumCnt - iStdCnt)
35964>>>
35964>>            Send Delete_item iStdCnt
35965>>        Loop
35966>>>
35966>>
35966>>        Move iStdcnt to iNumCnt
35967>>        get Client_id to hCl // object id of client area
35968>>        If hCl Begin
35970>>           Get Next_Mdi_Dialog of hcl TRUE to hVw // find first view
35971>>           While hVw
35975>>              if (Active_state(hVw)) Begin
35977>>                 if iNumCnt eq iStdCnt Begin // if first view, add separator
35979>>                    send add_item 0 ''
35980>>                    increment iNumCnt
35981>>                 end
35981>>>
35981>>                 Get Label of hVw to sLbl // caption bar (name) of view
35982>>                 // note that all views understand the message activate_view.
35982>>                 send add_item msg_activate_view sLbl // set message, value and destination
35983>>                 set aux_value item iNumcnt to hVw
35984>>                 // if this is the focus view, mark it.
35984>>                 If (current_scope(desktop)=hVw and View_mode(hVw)<>VIEWMODE_ICONIZE) ;                     set select_state item iNumCnt to True
35987>>                 // create status help
35987>>                 Set Status_help item iNumCnt to ("Make this view (" - trim(sLbl) - ") the active window.")
35988>>                 increment iNumCnt
35989>>              end
35989>>>
35989>>              Get Next_Mdi_Dialog of hcl FALSE to hVw // find next
35990>>           End
35991>>>
35991>>        End
35991>>>
35991>>    End_Procedure // OnInitMenu
35992>>
35992>>End_Pull_Down
35994>>Set Status_Help to ''
INCLUDING FILE: HELPA_PM.INC
35995>>
35995>>
35995>>DFCreate_Menu "&Help" Help_Menu
35999>>    on_item "&Help Topic" send Help_on_topic
36000>>        Set Status_Help To "Search for help on a particular subject."
36001>>        on_item "" send NONE
36002>>    on_item "&Context Help"          send Extended_Help
36003>>        Set Status_Help To "Show Context sensitive help."
36004>>
36004>>    on_item "&Files Help"            send File_Help
36005>>        Set Status_Help To "Show Files help."
36006>>
36006>>    on_item "&Keys Help"             send Keys_Help
36007>>        Set Status_Help To "Show Keys help."
36008>>
36008>>    on_item "" send NONE
36009>>
36009>>    on_item "&How to Use Help"       send Help_For_Help
36010>>        Set Status_Help To "How to Use Help"
36011>>
36011>>    on_item "" send NONE
36012>>
36012>>    On_Item "&Tips of the Day" send Activate_TipOfDay
36013>>        Set Status_Help To "Tips of the Day"
36014>>
36014>>    on_item "" send NONE
36015>>
36015>>    On_item "About" Send Activate_About
36016>>        Set Status_Help To "System Information"
36017>>end_pull_down
36019>>Set Status_Help to "Access to the program's help subsystem"
36020>>
36020>>Register_Procedure Activate_TipOfDay
36020>>
36020>>
36020>    End_Menu
36022>
36022>    Use DFStdBtn.pkg //  Tool-Bar object.
INCLUDING FILE: DFSTDBTN.PKG
36022>>>// 07/23/96 JJT - New Class names
36022>>>// 10/03/97 KCR - removed leading separator
36022>>>
36022>>>Use DFMainBt  // dfMain_ButtonBar
INCLUDING FILE: DFMAINBT.PKG
36022>>>>>//-------------------------------------------------------------------------
36022>>>>>// DFMainBt.pkg - DfMain_ButtonBar class
36022>>>>>//
36022>>>>>//
36022>>>>>// 07/23/96 JJT - New Class names
36022>>>>>//-------------------------------------------------------------------------
36022>>>>>
36022>>>>>Use DfPanel // dfapp_buttonbar
36022>>>>>
36022>>>>>Class ToolBar is a AppToolBar
36023>>>>>
36023>>>>>    Function Is_Function Integer MsgId Integer ObjId Integer DelegateFg Returns Integer
36024>>>>>      Local integer rval MainObj#
36025>>>>>      Get Main_Panel_id to MainObj#
36026>>>>>      If (ObjId>Desktop AND MainObj#) ;         Get Is_Function of MainObj# MsgId ObjId DelegateFg to rVal
36029>>>>>      Function_Return rVal
36030>>>>>    End_Function
36031>>>>>
36031>>>>>    Procedure Redirect_Button_Message integer Itm
36032>>>>>         Local integer Msg# Aux# rval Understood
36033>>>>>         If (Shadow_State(Current_Object,itm)) Procedure_Return
36036>>>>>         Get Message   item itm  to Msg#
36037>>>>>         Get Aux_Value item itm  to Aux#
36038>>>>>         If Msg# Begin
36040>>>>>           If Aux# eq 0 Begin
36042>>>>>              Get Focus to Aux#
36043>>>>>              Get Is_Function Get_DEO_Object Aux# TRUE to Understood
36044>>>>>              If Not Understood Move 0 to Aux#
36047>>>>>           End
36047>>>>>>
36047>>>>>           If Aux# Get Msg# of Aux# to rval
36050>>>>>           Procedure_return rval
36051>>>>>         end
36051>>>>>>
36051>>>>>    End_Procedure // Redirect_Message
36052>>>>>
36052>>>>>End_Class
36053>>>>>
36053>>>>>
36053>>>
36053>>>//  Button bar object.
36053>>>//
36053>>>Object Tool_Bar is a ToolBar
36055>>>
36055>>>    Send ImageList_Add 'bgn.bmp'   // 0
36056>>>    Send ImageList_Add 'end.bmp'   // 1
36057>>>    Send ImageList_Add 'next.bmp'  // 2
36058>>>    Send ImageList_Add 'prev.bmp'  // 3
36059>>>    Send ImageList_Add 'clr.bmp'   // 4
36060>>>    Send ImageList_Add 'clra.bmp'  // 5
36061>>>
36061>>>    send Add_button (ico_user+0) msg_beginning_of_data
36062>>>    Send Add_ToolTip "Beginning of file"
36063>>>    Set  Status_Help To 'Find the First record (Ctrl+Home)'
36064>>>
36064>>>    send Add_button (ico_user+3) msg_find_previous
36065>>>    Send Add_ToolTip "Find Previous"
36066>>>    Set  Status_Help To 'Find the Previous record (F7)'
36067>>>
36067>>>    send Add_button (ico_user+2) msg_find_next
36068>>>    Send Add_ToolTip "Find Next"
36069>>>    Set  Status_Help To 'Find the Next record (F8)'
36070>>>
36070>>>    send Add_button (ico_user+1) msg_end_of_data
36071>>>    Send Add_ToolTip "End of File"
36072>>>    Set  Status_Help To 'Find the Last record (Ctrl+End)'
36073>>>
36073>>>    send Add_space
36074>>>
36074>>>    send Add_button ico_std_find msg_prompt
36075>>>    Send Add_ToolTip "Prompt"
36076>>>    Set  Status_Help To 'Show available selections (F4)'
36077>>>
36077>>>    send Add_button (ico_user+4) msg_request_clear
36078>>>    Send Add_ToolTip "Clear"
36079>>>    Set  Status_Help To 'Clear current record / Add a new record (F5)'
36080>>>
36080>>>    send Add_button (ico_user+5) msg_request_clear_all
36081>>>    Send Add_ToolTip "Clear All"
36082>>>    Set  Status_Help To 'Clear all data from view (Ctrl+F5)'
36083>>>
36083>>>    send Add_space
36084>>>
36084>>>    send Add_button ico_std_filesave msg_request_save
36085>>>    Send Add_ToolTip "Save"
36086>>>    Set  Status_Help To 'Save the current record (F2)'
36087>>>
36087>>>    send Add_button ico_std_delete msg_request_delete
36088>>>    Send Add_ToolTip "Delete"
36089>>>    Set  Status_Help To 'Delete the current record (Shift+F2)'
36090>>>
36090>>>    send Add_space
36091>>>
36091>>>    send Add_button ico_std_cut msg_cut
36092>>>    Send Add_ToolTip "Cut"
36093>>>    Set  Status_Help to "Cuts the selection and puts it on the Clipboard"
36094>>>
36094>>>    send Add_button ico_std_copy msg_copy
36095>>>    Send Add_ToolTip "Copy"
36096>>>    Set  Status_Help to "Copies the selection and puts it on the Clipboard"
36097>>>
36097>>>    send Add_button ico_std_paste msg_paste
36098>>>    Send Add_ToolTip "Paste"
36099>>>    Set  Status_Help to "Inserts Clipboard contents"
36100>>>
36100>>>End_Object
36101>>>
36101>    
36101>    Object Client_Area is a AppClientAreasub
36103>
36103>        //AB-ClientStoreTopStart
36103>        // Ž‘Ž•† ‚„Œˆ‰„‘ ‹„’€Š†’„‘ //
36103>        String Plhktro_BIP  Plhktro_Esc  Plhktro_N11  Plhktro_N00  Plhktro_FS  Plhktro_AAA  Plhktro_DSI
36103>        String Plhktro_SO   Plhktro_DC4     //expanded for 1 line
36103>        String Plhktro_SI   Plhktro_DC2     //condesed
36103>        String Plhktro_PAV                  //underline
36103>        String Plhktro_EEE  Plhktro_FFF     //emphasized
36103>        String Plhktro_GGG  Plhktro_HHH     //double strike
36103>        String Plhktro_WWW                  //expanded
36103>        string Plhktro_Q Plhktro_160
36103>        Integer giViewID
36103>        String  gsViewName
36103>        // Ž‘Ž•† ‚„Œˆ‰„‘ ‹„’€Š†’„‘ //
36103>        
36103>        Open Sysfile
36105>        Open Sysrec
INCLUDING FILE: SYSREC.FD
36107>        
36107>        //Use dbViews.Sub
36107>        //Use dbForms.Sub
36107>        
36107>        //Use GrpPed00.vw
36107>        //Use GrpPedia.vw
36107>        //Use GrpView0.vw
36107>        //Use GrpViews.vw
36107>        //Use GrpOth0.vw
36107>        //Use GrpOth.vw
36107>        //Use Users.vw
36107>        //Use UserGrps.vw
36107>        //Use Departm.vw
36107>        //Use Othon.vw
36107>        //Use Views.vw
36107>        //Use Arxeia.vw
36107>        //Use Pedia.vw
36107>        //Use Viewflds.vw
36107>        
36107>        //Use Cflagkin.vw
36107>        //Use Wflagkin.vw
36107>        
36107>        //Use Listes
36107>        
36107>        //Use bpMakeSx.dg
36107>        
36107>        //Open Nomisma
36107>        //Open Isotimia
36107>        
36107>        
36107>        
36107>        //Function fngConvertPoso Global String asNomismaCodeApo Number anPoso ;
36107>        //                               String asNomismaCodeSe  Date   adHmnia;
36107>        //                               Number nIsotimia  Returns Number
36107>        
36107>        //    Number rVal nApo_Euro_Isot nSe_Euro_Isot
36107>        //    Integer iApo_Einai_Euro_Zone iApo_Einai_DRX iApo_Einai_Euro iDekadika_Apo
36107>        //    Integer iSe_Einai_Euro_Zone  iSe_Einai_DRX  iSe_Einai_Euro  iDekadika_Se
36107>        //    String  sCode
36107>        
36107>        //    If (asNomismaCodeApo=asNomismaCodeSe) Function_Return anPoso
36107>        
36107>        //    Clear Nomisma
36107>        //    Move (Trim(asNomismaCodeApo)) to Nomisma.Nomisma_Code
36107>        //    Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
36107>        //    Move Nomisma.Euro_Zone      to iApo_Einai_Euro_Zone
36107>        //    Move Nomisma.Einai_DRX      to iApo_Einai_DRX
36107>        //    Move Nomisma.Einai_EURO     to iApo_Einai_Euro
36107>        //    Move Nomisma.KL_ISOT_EURO   to nApo_Euro_Isot
36107>        //    Move Nomisma.Dekadika       to iDekadika_Apo
36107>        //    // 1. An to nomisma APO den einai ths zonhs euro prepei na vrethei h isotimia tou
36107>        //    If ((NOT(iApo_Einai_Euro_Zone)) And (nApo_Euro_Isot=0))  Begin
36107>        //        If (adHmnia='') Sysdate            adHmnia
36107>        //        Move (Trim(asNomismaCodeApo))   to sCode
36107>        //        Clear Isotimia
36107>        //        Move sCode                      to Isotimia.Nomisma_Code
36107>        //        Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
36107>        //        Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
36107>        //        Move Isotimia.Isotimia_Euro     to nApo_Euro_Isot
36107>        //    End
36107>        
36107>        //    Clear Nomisma
36107>        //    Move (Trim(asNomismaCodeSe)) to Nomisma.Nomisma_Code
36107>        //    Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
36107>        //    Move Nomisma.Euro_Zone      to iSe_Einai_Euro_Zone
36107>        //    Move Nomisma.Einai_DRX      to iSe_Einai_DRX
36107>        //    Move Nomisma.Einai_EURO     to iSe_Einai_Euro
36107>        //    Move Nomisma.KL_ISOT_EURO   to nSe_Euro_Isot
36107>        //    Move Nomisma.Dekadika       to iDekadika_Se
36107>        //    // 2. An to nomisma SE den einai ths zonhs euro prepei na vrethei h isotimia tou
36107>        //    If ((NOT(iSe_Einai_Euro_Zone)) And (nSe_Euro_Isot=0)) Begin
36107>        //        If (adHmnia='') Sysdate            adHmnia
36107>        //        Move (Trim(asNomismaCodeSe))    to sCode
36107>        //        Clear Isotimia
36107>        //        Move sCode                      to Isotimia.Nomisma_Code
36107>        //        Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
36107>        //        Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
36107>        //        Move Isotimia.Isotimia_Euro     to nSe_Euro_Isot
36107>        //    End
36107>        
36107>        //    Calc (anPoso/nApo_Euro_Isot) to rVal
36107>        //    Move (Round_Number(rVal,6)) to rVal
36107>        //    Calc (rVal*nSe_Euro_Isot) to rVal
36107>        //    Move (Round_Number(rVal,iDekadika_Se)) to rVal
36107>        
36107>        //    Function_Return rVal
36107>        //End_Function
36107>        
36107>        
36107>        //AB-ClientStoreTopEnd
36107>
36107>        //  Include all views
36107>        Use FixTim.VW                                                                       
INCLUDING FILE: FIXTIM.VW
36107>>>//AB/ Project FixTim
36107>>>//AB/     Object prj is a View_Project
36107>>>//AB/         Set ProjectName to "FixTim"
36107>>>//AB/         Set ProjectFileName to "FixTim.VW"
36107>>>//AB/         Set GenerateFileName to "NONAME"
36107>>>
36107>>>// Project Object Structure
36107>>>//   FixTim is a dbViewSubs
36107>>>//     ButtonSub1 is a ButtonSub
36107>>>
36107>>>// Register all objects
36107>>>Register_Object ButtonSub1
36107>>>Register_Object FixTim
36107>>>
36107>>>
36107>>>//AB/     AppBuild VIEW
36107>>>
36107>>>
36107>>>    //AB-StoreTopStart
36107>>>    
36107>>>    Open Syscurxr
36109>>>    Open Witemx
36111>>>    Open Witemxt
36113>>>    
36113>>>    //AB-StoreTopEnd
36113>>>
36113>>>    //AB-IgnoreStart
36113>>>
36113>>>    Use dbViews.Sub
INCLUDING FILE: DBVIEWS.SUB
36113>>>>>Open Oth 
36115>>>>>Open GrpAct
INCLUDING FILE: GRPACT.FD
36117>>>>>Open GrpAct0
INCLUDING FILE: GRPACT0.FD
36119>>>>>
36119>>>>>Class DbviewSubs Is A DbviewSub
36120>>>>>
36120>>>>>    Procedure Construct_Object
36121>>>>>        Integer iPos iCount
36122>>>>>        Forward Send Construct_Object
36124>>>>>
36124>>>>>        Property String     psMyViewName        Public ''
36125>>>>>        Property Integer    piMyViewID          Public  0
36126>>>>>        Property Integer    piDoNotActivateView Public  0
36127>>>>>
36127>>>>>        Get Name            to gsViewName
36128>>>>>        Get Object_ID       to giViewID
36129>>>>>
36129>>>>>        Move 0 to iPos
36130>>>>>        For iCount From 1 to (Length(gsViewName))
36136>>>>>>
36136>>>>>            If (Mid(gsViewName,1,iCount)='.') Move iCount to iPos
36139>>>>>        Loop
36140>>>>>>
36140>>>>>        Move (Right(gsViewName,(Length(gsViewName)-iPos))) to gsViewName
36141>>>>>        Move (Trim(gsViewName)) to gsViewName
36142>>>>>
36142>>>>>        Set psMyViewName    to (Trim(gsViewName))
36143>>>>>        Set piMyViewID      to giViewID
36144>>>>>
36144>>>>>    End_Procedure
36145>>>>>
36145>>>>>    Procedure End_Construct_Object
36146>>>>>        Integer iFileNumber iFieldNumber iUser iColor iLimit iBase iCurr iCol iDeo iPos
36147>>>>>        Integer iObj iPrototype iColumn iItem iInt iFieldStatus iCurCol iCount
36147>>>>>        String  sFileName sFieldName sUser sRecr sStr sDbFormName sViewLabel sDeo svn
36147>>>>>
36147>>>>>        Forward Send End_Construct_Object
36149>>>>>
36149>>>>>        Get psMyViewName        to gsViewName
36150>>>>>        Get piMyViewID          to giViewID
36151>>>>>        Get Label Of giViewID   to sViewLabel
36152>>>>>        Move (Trim(sViewLabel)) to sViewLabel
36153>>>>>
36153>>>>>        Clear Oth
36154>>>>>        Move gsViewName to Oth.View_Name
36155>>>>>        Find eq Oth By Index.2 // Oth:Index.2:View_Name
36156>>>>>>
36156>>>>>        If (Not(Found)) Begin
36158>>>>>            Move sViewLabel to Oth.View_Label
36159>>>>>            Move giViewID   to Oth.View_ID
36160>>>>>            Saverecord Oth
36161>>>>>        End
36161>>>>>>
36161>>>>>
36161>>>>>//        Set piDoNotActivateView to 0
36161>>>>>//        Send DisableActivateView
36161>>>>>
36161>>>>>    End_Procedure //End_Construct_Object
36162>>>>>
36162>>>>>    Procedure Activate_View Returns Integer
36163>>>>>        String  lsLogin
36164>>>>>        String sLektiko
36164>>>>>        Integer liUser iGroup rVal
36164>>>>>        Set piDoNotActivateView to 0
36165>>>>>        Send DisableActivateView
36166>>>>>        If (piDoNotActivateView(Self)=0) Forward get Msg_Activate_View to rVal
36170>>>>>        Else Move -1 to rVal
36172>>>>>        Procedure_Return rVal
36173>>>>>    End_procedure
36174>>>>>
36174>>>>>
36174>>>>>    Procedure DisableActivateView
36175>>>>>        String  lsLogin
36176>>>>>        String sLektiko
36176>>>>>        Integer liUser iGroup rVal
36176>>>>>
36176>>>>>        Move (fsLoginUserID())      to lsLogin
36177>>>>>        Clear Users
36178>>>>>        Move lsLogin    to Users.Login_ID
36179>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
36180>>>>>>
36180>>>>>        If (Found=1)  Begin
36182>>>>>            Move Users.User_ID  to liUser
36183>>>>>            Move Users.Grp_ID   to iGroup
36184>>>>>        End
36184>>>>>>
36184>>>>>        
36184>>>>>        Clear GrpAct
36185>>>>>        Move liUser                 to GrpAct.User_ID
36186>>>>>        Move (psMyViewName(Self))   to GrpAct.View_Name
36187>>>>>        Find Eq GrpAct By Index.1
36188>>>>>>
36188>>>>>        If (Found) Begin
36190>>>>>            If (GrpAct.Allow=0) Begin
36192>>>>>                Set piDoNotActivateView to 1
36193>>>>>                Move "€¤œ§˜¨¡ã › ˜¡ é£˜«˜ •¨ã©«ž š ˜ œ¤œ¨š¦§¦åž©ž «¦¬ §˜¨˜Ÿç¨¦¬\n„§ ¡¦ ¤à¤ã©«œ £œ «¦¤ ƒ ˜®œ ¨ ©«ã «¦¬ ©¬©«ã£˜«¦ª" to sLektiko
36194>>>>>                Send Stop_Box sLektiko "Error 30001"
36195>>>>>                Procedure_Return -1
36196>>>>>            End
36196>>>>>>
36196>>>>>        End
36196>>>>>>
36196>>>>>
36196>>>>>        Clear GrpAct0
36197>>>>>        Move iGroup                 to GrpAct0.Group_ID
36198>>>>>        Move (psMyViewName(Self))   to GrpAct0.View_Name
36199>>>>>        Find Eq GrpAct0 By Index.1
36200>>>>>>
36200>>>>>        If ((Found) And (GrpAct0.Allow=0)) Begin
36202>>>>>            Set piDoNotActivateView to 1
36203>>>>>            Move "€¤œ§˜¨¡ã › ˜¡ é£˜«˜ Ž£á›˜ª š ˜ œ¤œ¨š¦§¦åž©ž «¦¬ §˜¨˜Ÿç¨¦¬\n„§ ¡¦ ¤à¤ã©«œ £œ «¦¤ ƒ ˜®œ ¨ ©«ã «¦¬ ©¬©«ã£˜«¦ª" to sLektiko
36204>>>>>            Send Stop_Box sLektiko "Error 30002"
36205>>>>>            Procedure_Return -1
36206>>>>>        End
36206>>>>>>
36206>>>>>    End_procedure
36207>>>>>
36207>>>>>
36207>>>>>End_Class //dbviewSubs
36208>>>>>
36208>>>>>
36208>>>    Use Button.Sub
36208>>>
36208>>>    //AB-IgnoreEnd
36208>>>
36208>>>    ACTIVATE_VIEW Activate_FixTim FOR FixTim
36212>>>
36212>>>    Object FixTim is a dbViewSubs
36214>>>
36214>>>        //AB-StoreTopStart
36214>>>                                                                                                                                                                        
36214>>>        //AB-StoreTopEnd
36214>>>
36214>>>        Set Label to "„¤ž£â¨à©ž ’ £¦¡˜«˜¢æšà¤"
36215>>>        Set Size to 89 425
36216>>>        Set Location to 7 10
36217>>>
36217>>>        //AB-DDOStart
36217>>>
36217>>>
36217>>>        //AB-DDOEnd
36217>>>
36217>>>        Object ButtonSub1 is a ButtonSub
36219>>>
36219>>>            //AB-StoreTopStart
36219>>>            
36219>>>            //AB-StoreTopEnd
36219>>>
36219>>>            Set Label to "ButtonSub1"
36220>>>            Set Size to 14 181
36221>>>            Set Location to 39 120
36222>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
36223>>>
36223>>>            //AB-StoreStart
36223>>>            
36223>>>            Set Label to '„¤ž£œ¨à©ž'
36224>>>            
36224>>>            Procedure OnClick
36226>>>                String  sLabel sStr sNomisma
36227>>>                Integer iCount iErr
36227>>>                Number  nAxia nPosothta nUnitPrice nIsotimia
36227>>>                Date    dHmnia
36227>>>            
36227>>>                Indicate Err False
36228>>>                Move 0 to iCount
36229>>>            
36229>>>                Get Label to sLabel
36230>>>            
36230>>>                Clear Witemxt
36231>>>                Move SyscurXr.Company_Code  to Witemxt.Company_Code
36232>>>                Move SyscurXr.Branch_Code   to Witemxt.Branch_Code
36233>>>                Move SyscurXr.Year_Year     to Witemxt.Year_Year
36234>>>                Find Ge Witemxt By Index.1
36235>>>>
36235>>>                While ((Found) And (SyscurXr.Company_Code=Witemxt.Company_Code) And (SyscurXr.Branch_Code=Witemxt.Branch_Code) And (SyscurXr.Year_Year=Witemxt.Year_Year))
36239>>>                    Set Label to ('„¤ž£â¨à©ž ’ £¦¡˜«˜¢æš¦¬  ' + Trim(Witemxt.Witemx_Recr))
36240>>>                    If (Trim(Witemxt.Item_Code)="") Begin
36242>>>                        Clear Witemx
36243>>>                        Move Witemxt.Witemx_Recr to Witemx.Witemx_recr
36244>>>                        Find Eq Witemx By Index.2
36245>>>>
36245>>>                        If (Found) Begin
36247>>>                            Reread Witemxt
36251>>>                            //Move 9999               to Witemxt.Qty
36251>>>                            Move Witemx.Item_Code   to Witemxt.Item_Code
36252>>>                            Saverecord Witemxt
36253>>>                            Unlock
36254>>>>
36254>>>                            Set Label to ('„¤ž£â¨à©ž ’ £¦¡˜«˜¢æš¦¬  ' + Trim(Witemxt.Witemx_Recr)+ "  " + Trim(Witemxt.Item_Code))
36255>>>                        End
36255>>>>
36255>>>                    End
36255>>>>
36255>>>                    Find GT Witemxt By Index.1
36256>>>>
36256>>>                Loop
36257>>>>
36257>>>                Send Info_Box "† „§œ¥œ¨š˜©å˜ «œ¢œåà©œ" "¢ž¨¦­¦¨å˜"
36258>>>                Set Label to sLabel
36259>>>            End_Procedure // OnClick
36260>>>            
36260>>>            
36260>>>            
36260>>>            
36260>>>            
36260>>>            
36260>>>            
36260>>>            
36260>>>            
36260>>>            
36260>>>            
36260>>>            //AB-StoreEnd
36260>>>
36260>>>        End_Object    // ButtonSub1
36261>>>
36261>>>
36261>>>        //AB-StoreStart
36261>>>                                                                                                                                                                        
36261>>>        //AB-StoreEnd
36261>>>
36261>>>    End_Object    // FixTim
36262>>>
36262>>>
36262>>>    //AB-StoreStart
36262>>>    
36262>>>    
36262>>>    
36262>>>    
36262>>>    
36262>>>    
36262>>>    
36262>>>    
36262>>>    
36262>>>    //AB-StoreEnd
36262>>>
36262>>>//AB/     End_Object    // prj
36262>
36262>        //AB-ClientStoreStart
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        
36262>        //AB-ClientStoreEnd
36262>
36262>
36262>    End_Object  // Client_Area
36263>    
36263>    On_Key Key_Ctrl+Key_1 Send Activate_FixTim To Client_Area
36264>    
36264>    Use DFStdSbr.pkg //  Status-Bar object.
INCLUDING FILE: DFSTDSBR.PKG
36264>>>// 07/23/96 JJT - New Class names
36264>>>// Very prototype global status bar
36264>>>//
36264>>>Use dfMainSt.pkg
INCLUDING FILE: DFMAINST.PKG
36264>>>>>// 07/23/96 JJT - New Class names
36264>>>>>Use dfAstbar.pkg
36264>>>>>
36264>>>>>Class StatusBar is a AppStatusBar
36265>>>>>
36265>>>>>    Procedure Construct_Object
36266>>>>>       Forward Send Construct_Object
36268>>>>>       //
36268>>>>>       Send Add_Item 350  ''     // micro-help
36269>>>>>       Send Add_Item  40  'View:'
36270>>>>>       Set Item_Display_Style To sbNORMAL
36271>>>>>       Send Add_Item 200  ''     // view name
36272>>>>>       Send Add_Item   0  ''     // spring 'normal' to end
36273>>>>>       Set Item_Display_Style To sbNORMAL
36274>>>>>    End_Procedure // Construct_Object
36275>>>>>
36275>>>>>    Procedure Show_View_Name String sName
36276>>>>>        Set Value item 2 to sName
36277>>>>>    End_Procedure
36278>>>>>
36278>>>>>End_Class
36279>>>
36279>>>Object Status_Bar is a StatusBar
36281>>>End_Object
36282>
36282>    //AB-PanelStoreStart
36282>    Use StdAbout.pkg // Standard "About" package.
INCLUDING FILE: STDABOUT.PKG
36282>>>//************************************************************************
36282>>>// Confidential Trade Secret.
36282>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
36282>>>// as an unpublished work.  All rights reserved.
36282>>>// DataFlex is a registered trademark of Data Access Corporation.
36282>>>//
36282>>>//************************************************************************
36282>>>//************************************************************************
36282>>>//
36282>>>// $File name  : StdAbout.pkg
36282>>>// $File title : Standard about object package for VDF
36282>>>// Notice      :
36282>>>// $Author(s)  : John Tuohy
36282>>>//
36282>>>// $Rev History
36282>>>//
36282>>>// JT 06/27/97   File created
36282>>>//************************************************************************
36282>>>
36282>>>// This provides a quick and simple way to create an about package for a program.
36282>>>// You need to create a message inside you client area called Activate_About.
36282>>>// Within this message you should send the message DoAbout passing needed
36282>>>// string information.
36282>>>//
36282>>>//       Procedure Activate_About
36282>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
36282>>>//       End_Procedure
36282>>>//    where: sTitle =     Name of application. If none provided, uses caption
36282>>>//                        bar title
36282>>>//           sVersion   = Version Line. If none provided, will be blank
36282>>>//           sCopyRight = Copyright Line. If none provided, will be blank
36282>>>//           sAuthor    = Author name, blank if none provided
36282>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
36282>>>//                        is used.
36282>>>// It is expected that you will place this in your own object package. For
36282>>>// example an order about package may look like this:
36282>>>//
36282>>>//   // OrderAbout.pkg
36282>>>//   Use StdAbout.pkg
36282>>>//   Procedure Activate_About
36282>>>//      Local String sTitle sCopyright sVersion sAuthor
36282>>>//      Move "My Order Entry System" to sTitle
36282>>>//      Move "Version 2.1" to sVersion
36282>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
36282>>>//      Move "John Smith"  to sAuthor
36282>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
36282>>>//   end_procedure
36282>>>//   // end of file.
36282>>>
36282>>>Use DfAbout.pkg
INCLUDING FILE: DFABOUT.PKG
36282>>>>>//************************************************************************
36282>>>>>// Confidential Trade Secret.
36282>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
36282>>>>>// as an unpublished work.  All rights reserved.
36282>>>>>// DataFlex is a registered trademark of Data Access Corporation.
36282>>>>>//
36282>>>>>//************************************************************************
36282>>>>>//************************************************************************
36282>>>>>//
36282>>>>>// $File name  : DfAbout.pkg
36282>>>>>// $File title : About class support
36282>>>>>// Notice      :
36282>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
36282>>>>>//
36282>>>>>// $Rev History
36282>>>>>//
36282>>>>>// JJT 11/5/98    Added version information
36282>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
36282>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
36282>>>>>//                workspace package.
36282>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
36282>>>>>//                class can create this object.
36282>>>>>//                Cleaned up the interface (used correct classes and messages)
36282>>>>>//                Added workspace reporting support to sys-info.
36282>>>>>//                Turned off wrapping in the sys-info editor.
36282>>>>>// KR  ??/??/96   File created
36282>>>>>//************************************************************************
36282>>>>>Use windows.pkg
36282>>>>>Use DFbitmap.pkg
36282>>>>>
36282>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
36283>>>>>
36283>>>>>//****************************************************************************
36283>>>>>// $Module type: FUNCTION
36283>>>>>// $Module name: Network_User_Name
36283>>>>>// $Author     : AK/VOO/KCR
36283>>>>>// Created     : 24-09-96 @ 19:17
36283>>>>>//
36283>>>>>// Description
36283>>>>>//    This function reads the current username of windows and returns that
36283>>>>>//    name or an text unknown user
36283>>>>>//
36283>>>>>// $Rev History
36283>>>>>//    24-09-96  Module header created
36283>>>>>//****************************************************************************
36283>>>>>Function Network_User_Name Returns String
36285>>>>>    Local String sName sLength
36286>>>>>    Local Pointer lpName_Addr lpLength_Addr
36286>>>>>    Local Integer iRetval
36286>>>>>
36286>>>>>    Movestr (Repeat (Character (0), 255)) To sName
36287>>>>>>
36287>>>>>    GetAddress Of sName To lpName_Addr
36288>>>>>    Movestr (DwordToBytes (255)) To sLength
36289>>>>>>
36289>>>>>    GetAddress Of sLength To lpLength_Addr
36290>>>>>
36290>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
36291>>>>>>
36291>>>>>
36291>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
36294>>>>>    Else Function_Return "User Unknown"
36296>>>>>End_Function // Network_User_Name
36297>>>>>
36297>>>>>Type MEMORYSTATUS
36297>>>>>   Field MEMORYSTATUS.dwLength         As Dword // sizeof(MEMORYSTATUS)
36297>>>>>   Field MEMORYSTATUS.dwMemoryLoad     As Dword // percent of memory in use
36297>>>>>   Field MEMORYSTATUS.dwTotalPhys      As Dword // bytes of physical memory
36297>>>>>   Field MEMORYSTATUS.dwAvailPhys      As Dword // free physical memory bytes
36297>>>>>   Field MEMORYSTATUS.dwTotalPageFile  As Dword // bytes of paging file
36297>>>>>   Field MEMORYSTATUS.dwAvailPageFile  As Dword // free bytes of paging file
36297>>>>>   Field MEMORYSTATUS.dwTotalVirtual   As Dword // user bytes of address space
36297>>>>>   Field MEMORYSTATUS.dwAvailVirtual   As Dword // free user bytes
36297>>>>>End_Type // MEMORYSTATUS
36297>>>>>
36297>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
36298>>>>>
36298>>>>>// If a global workspace object exists it will use this variable to store
36298>>>>>// its object id.
36298>>>>>
36298>>>>>Class SysinfoDisplay Is An Edit
36299>>>>>    Procedure Construct_Object
36300>>>>>        forward send construct_object
36302>>>>>
36302>>>>>        Set Location To 6 6
36303>>>>>        Set Size To 110 255
36304>>>>>        Set Read_Only_State To True
36305>>>>>        Set wrap_state to False
36306>>>>>    end_Procedure
36307>>>>>
36307>>>>>    //****************************************************************************
36307>>>>>    // $Module type: PROCEDURE
36307>>>>>    // $Module name: Add_Line
36307>>>>>    // $Author     : VOO
36307>>>>>    // Created     : 06-10-96 @ 15:23
36307>>>>>    //
36307>>>>>    // Description
36307>>>>>    //    This method will add a line to this edit object, it should go simpler
36307>>>>>    //    but it seems to be done this way.
36307>>>>>    //
36307>>>>>    // $Rev History
36307>>>>>    //    06-10-96  Module header created
36307>>>>>    //****************************************************************************
36307>>>>>    Procedure Add_Line String sVal
36308>>>>>        Local Integer iLine
36309>>>>>
36309>>>>>        Moveint (Line_Count (Current_Object)) To iLine
36310>>>>>>
36310>>>>>        If (iLine = 1 And Changed_State (Current_Object) = False) Moveint 0 To iLine
36313>>>>>        Set Value Item iLine To sVal
36314>>>>>    End_Procedure // Add_Line
36315>>>>>
36315>>>>>    //****************************************************************************
36315>>>>>    // $Module type: PROCEDURE
36315>>>>>    // $Module name: Show_Current_Directory
36315>>>>>    // $Author     : VOO
36315>>>>>    // Created     : 06-10-96 @ 15:24
36315>>>>>    //
36315>>>>>    // Description
36315>>>>>    //    This method will show the name of the current directory in the system
36315>>>>>    //    information box
36315>>>>>    //
36315>>>>>    // $Rev History
36315>>>>>    //    06-10-96  Module header created
36315>>>>>    //****************************************************************************
36315>>>>>    Procedure Show_Current_Directory
36316>>>>>        Local String sDir
36317>>>>>
36317>>>>>        Get_Current_Directory To sDir
36318>>>>>        Send Add_Line ("Current Directory: " + sDir)
36319>>>>>    End_Procedure // Show_Current_Directory
36320>>>>>
36320>>>>>    Procedure Show_Windows_Directory
36321>>>>>        Local String sWindir
36322>>>>>
36322>>>>>        Get_Windows_Directory To sWindir
36323>>>>>        Send Add_Line ("Windows Directory: " * sWindir)
36324>>>>>    End_Procedure // Show_Windows_Directory
36325>>>>>
36325>>>>>    Procedure Show_Current_User
36326>>>>>        Send Add_Line ("Network User Name: " * Network_User_Name (Current_Object))
36327>>>>>    End_Procedure // Show_Current_User
36328>>>>>
36328>>>>>    Procedure Show_Number_Format
36329>>>>>        Local Integer iFormat
36330>>>>>
36330>>>>>        Get_Attribute Df_Thousands_Separator To iFormat
36333>>>>>        Send Add_Line ('Thousands Separator: "' - Character (iFormat) - '" (' - String (iFormat) - ')')
36334>>>>>        Get_Number_Format To iFormat
36335>>>>>        Send Add_Line ('Decimal Separator: "' - If (iFormat = 0, '.', ',') - '"')
36336>>>>>    End_Procedure // Show_Number_Format
36337>>>>>
36337>>>>>    Procedure Show_Filelist_Name
36338>>>>>        Local String sFilename
36339>>>>>
36339>>>>>        Get_Attribute Df_Filelist_Name To sFilename
36342>>>>>        Send Add_Line ("Current Filelist: " * sFilename)
36343>>>>>    End_Procedure // Show_Filelist_Name
36344>>>>>
36344>>>>>    Procedure Show_Lock_Delay
36345>>>>>        Local Integer iLockdelay
36346>>>>>
36346>>>>>        Get_Attribute Df_Lock_Delay To iLockdelay
36349>>>>>        Send Add_Line ("Database Locking Delay: " * String (iLockdelay) * "Milliseconds")
36350>>>>>    End_Procedure // Show_Lock_Delay
36351>>>>>
36351>>>>>    Procedure Show_Lock_Timeout
36352>>>>>        Local Integer iLockTimeout
36353>>>>>
36353>>>>>        Get_Attribute Df_Lock_Timeout To iLockTimeout
36356>>>>>        Send Add_Line ("Database Locking Timeout: " * String (iLockTimeout) * "Milliseconds")
36357>>>>>    End_Procedure // Show_Lock_Timeout
36358>>>>>
36358>>>>>    Procedure Show_Screen_Size
36359>>>>>        Local Integer iYscreensize iXscreensize
36360>>>>>
36360>>>>>        Moveint (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
36361>>>>>>
36361>>>>>        Moveint (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
36362>>>>>>
36362>>>>>
36362>>>>>        Send Add_Line ("Video Resolution: " * String (iXscreensize) * "by" * String (iYscreensize))
36363>>>>>    End_Procedure // Show_Screen_Size
36364>>>>>
36364>>>>>    Procedure Show_Page_Size
36365>>>>>        Send Add_Line ("Page End: " * String (Pageend) * "Form Feed: " * String (Pagefeed))
36366>>>>>    End_procedure
36367>>>>>
36367>>>>>    Procedure Show_Date
36368>>>>>        Local Date dToday
36369>>>>>
36369>>>>>        Sysdate4 dToday
36370>>>>>        Send Add_Line ("Current System Date: " * String (dToday))
36371>>>>>    End_procedure // Show_Date
36372>>>>>
36372>>>>>    Procedure Show_Date_Format
36373>>>>>        Local Integer iDateFormat
36374>>>>>        Local String sDateFormat
36374>>>>>
36374>>>>>        Get_Attribute Df_Date_Format To iDateFormat
36377>>>>>        if iDateFormat Eq DF_DATE_USA ;            Movestr "USA" To sDateFormat
36380>>>>>        else if iDateformat Eq DF_DATE_EUROPEAN ;            Movestr "European" To sDateFormat
36384>>>>>        else if iDateformat Eq DF_DATE_MILITARY ;            Movestr "Military" To sDateFormat
36388>>>>>        else ;            Movestr "Unknown Date Type" To sDateFormat
36390>>>>>        Send Add_Line ("Date Format: " * sDateformat)
36391>>>>>    End_Procedure // Show_Date_Format
36392>>>>>
36392>>>>>    Procedure Show_Memavail
36393>>>>>        Local Integer iMem
36394>>>>>
36394>>>>>        Memory iMem
36395>>>>>>
36395>>>>>        Send Add_Line ("Available Memory: " * String (iMem))
36396>>>>>    End_Procedure // Show_Memavail
36397>>>>>
36397>>>>>    Procedure Show_Systemresources
36398>>>>>        Local String sMemoryStatus
36399>>>>>        Local Pointer lpsMemoryStatus
36399>>>>>        Local Integer iVoid
36399>>>>>        Local Dword dwMemoryLoad dwTotalPhys dwAvailPhys dwTotalPageFile dwAvailPageFile dwTotalVirtual dwAvailVirtual
36399>>>>>
36399>>>>>        ZeroType MEMORYSTATUS To sMemoryStatus
36400>>>>>        GetAddress Of sMemoryStatus To lpsMemoryStatus
36401>>>>>
36401>>>>>        Moveint (GlobalMemoryStatus (lpsMemoryStatus)) To iVoid
36402>>>>>>
36402>>>>>
36402>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwMemoryLoad    To dwMemoryLoad
36403>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPhys     To dwTotalPhys
36404>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPhys     To dwAvailPhys
36405>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPageFile To dwTotalPageFile
36406>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPageFile To dwAvailPageFile
36407>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalVirtual  To dwTotalVirtual
36408>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailVirtual  To dwAvailVirtual
36409>>>>>
36409>>>>>        Send Add_Line ("Current memory utilization:" * String (dwMemoryLoad))
36410>>>>>        Send Add_Line ("Percentage available physical memory:" * String (dwAvailPhys / dwTotalPhys * 100.0) - "%")
36411>>>>>        Send Add_Line ("Percentage available pagefile space:" * String (dwAvailPageFile / dwTotalPageFile * 100.0) - "%")
36412>>>>>        Send Add_Line ("Percentage available virtual memory:" * String (dwAvailVirtual / dwTotalVirtual * 100.0) - "%")
36413>>>>>    End_Procedure // Show_Systemresources
36414>>>>>
36414>>>>>    Procedure Show_Registration
36415>>>>>        Local String sRegName
36416>>>>>        Local Integer iSN
36416>>>>>        Registration sRegName iSN
36417>>>>>>
36417>>>>>
36417>>>>>        Send Add_Line ("Serial# : " + (String(iSN)))
36418>>>>>        Send Add_Line ("Reg Name: " + sRegName)
36419>>>>>
36419>>>>>    End_Procedure // Show_Current_Directory
36420>>>>>
36420>>>>>
36420>>>>>
36420>>>>>    //****************************************************************************
36420>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
36420>>>>>    // to the workspace object passing the an object and message to send back
36420>>>>>    // to this object. It is expected that the workspace object will send this
36420>>>>>    // message for every line of information it wants displayed (passing the
36420>>>>>    // information to be displayed
36420>>>>>    //****************************************************************************
36420>>>>>    register_procedure EnumerateWorkspaceData integer hObjId integer hmMessId
36420>>>>>    Procedure Show_WorkspaceInformation
36421>>>>>        If ghoWorkspace ;            Send EnumerateWorkspaceData to ghoWorkspace Current_object Msg_add_Line
36424>>>>>    End_Procedure
36425>>>>>
36425>>>>>    Function VersionStr integer iVer integer iRev integer iBld Returns string
36426>>>>>        Function_Return (string(iVer)-"."-string(iRev)-"."-string(iBld))
36427>>>>>    End_Function
36428>>>>>
36428>>>>>    Procedure Show_Versions
36429>>>>>        local integer iVersion iRevision iBuild
36430>>>>>        Version_information iVersion iRevision iBuild
36432>>>>>        Send Add_Line ("Runtime Version:" * VersionStr(self,iVersion,iRevision,iBuild) )
36433>>>>>        Send Add_Line ("Package Version:" * VersionStr(self,PKG_VERSION, PKG_REVISION, PKG_BUILD) )
36434>>>>>        Send Add_Line ("FMAC Version:"    * VersionStr(self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) )
36435>>>>>    End_Procedure
36436>>>>>
36436>>>>>
36436>>>>>    //***
36436>>>>>    //*** BW
36436>>>>>    //*** Procedure: Show_Drivers
36436>>>>>    //*** Purpose  : Show loaed database drivers
36436>>>>>    //***
36436>>>>>
36436>>>>>    Procedure Show_Drivers
36437>>>>>        Local String  Current_drvr
36438>>>>>        Local String  Loadeddrvrs
36438>>>>>        Local Integer Number_of_drvrs
36438>>>>>        Local Integer Count
36438>>>>>
36438>>>>>        Move "" To Loadeddrvrs
36439>>>>>        Get_attribute DF_NUMBER_DRIVERS To Number_of_drvrs
36442>>>>>        For Count From 1 To Number_of_drvrs
36448>>>>>>
36448>>>>>            Get_attribute DF_DRIVER_NAME Of Count To Current_drvr
36451>>>>>            If (Loadeddrvrs <> "") ;                Move (Append(Loadeddrvrs, ", ")) To Loadeddrvrs
36454>>>>>            Move (Append(Loadeddrvrs, Current_drvr)) To Loadeddrvrs
36455>>>>>        Loop
36456>>>>>>
36456>>>>>        Send Add_Line ("Database driver(s):" * Loadeddrvrs)
36457>>>>>    End_Procedure // Show_Drivers
36458>>>>>
36458>>>>>    //****************************************************************************
36458>>>>>    // $Module type: PROCEDURE
36458>>>>>    // $Module name: Add_Focus
36458>>>>>    // $Author     : VOO
36458>>>>>    // Created     : 24-09-96 @ 19:43
36458>>>>>    //
36458>>>>>    // Description
36458>>>>>    //    During activation we will remove the old information and add the newly
36458>>>>>    //    found systeminformation
36458>>>>>    //
36458>>>>>    // $Rev History
36458>>>>>    //    24-09-96  Module header created
36458>>>>>    //****************************************************************************
36458>>>>>    Procedure Add_Focus Integer hoRoot
36459>>>>>        Forward Send Add_Focus hoRoot
36461>>>>>
36461>>>>>        Send Delete_Data
36462>>>>>        Set Changed_State To False
36463>>>>>        Set Read_Only_State To True
36464>>>>>        Send Show_WorkSpaceInformation // added to show WS info
36465>>>>>        SEnd Show_Drivers
36466>>>>>        Send Show_Current_User
36467>>>>>        Send Show_Windows_Directory
36468>>>>>        Send Show_Current_Directory
36469>>>>>        Send Show_Filelist_Name
36470>>>>>        Send Show_Versions
36471>>>>>        Send Show_Memavail
36472>>>>>        Send Show_Screen_Size
36473>>>>>        Send Show_Page_Size
36474>>>>>        Send Show_Number_Format
36475>>>>>        Send Show_Date_Format
36476>>>>>        Send Show_Lock_Delay
36477>>>>>        Send Show_Lock_Timeout
36478>>>>>        Send Show_Date
36479>>>>>        Send Show_Systemresources
36480>>>>>        Send Show_Registration
36481>>>>>    End_Procedure // Show_All_Info
36482>>>>>
36482>>>>>End_Class // SysinfoDisplay
36483>>>>>
36483>>>>>
36483>>>>>//****************************************************************************
36483>>>>>// $Module type: OBJECT
36483>>>>>// $Module name: Sysinfo_Dialog
36483>>>>>// $Author     : VOO
36483>>>>>// Created     : 24-09-96 @ 18:47
36483>>>>>//
36483>>>>>// Description
36483>>>>>//    This object shows the systeminformation on the screen
36483>>>>>//
36483>>>>>// $Rev History
36483>>>>>//    24-09-96  Module header created
36483>>>>>//****************************************************************************
36483>>>>>Class SysInfoDialog Is A ModalPanel
36484>>>>>    Procedure Construct_Object
36485>>>>>        forward send construct_object
36487>>>>>
36487>>>>>        Set Caption_Bar To True
36488>>>>>        Set Sysmenu_Icon To True
36489>>>>>        Set Label To "System Information"
36490>>>>>        Set Size To 152 270
36491>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
36492>>>>>        Set Minimize_Icon To False
36493>>>>>        Set Maximize_Icon To False
36494>>>>>        Set Border_Style To Border_Dialog
36495>>>>>
36495>>>>>        Object Sysinfo_Display Is A SysInfoDisplay
36497>>>>>        End_Object
36498>>>>>
36498>>>>>        Object Close_Button Is A Button
36500>>>>>            Set Label to "&Close"
36501>>>>>            Set Location To 120 212
36502>>>>>            Set Message item 0 to msg_Close_Panel
36503>>>>>            Set default_action_button to current_object
36504>>>>>        End_Object // Close_Button
36505>>>>>
36505>>>>>        On_Key Kcancel       Send Close_Panel
36506>>>>>        On_Key Key_Alt+Key_C Send Close_Panel
36507>>>>>    End_procedure
36508>>>>>
36508>>>>>End_Class // SysinfoDialog
36509>>>>>
36509>>>>>// Purpose:
36509>>>>>//
36509>>>>>// Ken Ross 12/17/96 5:16PM
36509>>>>>//
36509>>>>>Class AboutDialog Is A ModalPanel
36510>>>>>
36510>>>>>    Procedure construct_object
36511>>>>>        String sVdfRootDir
36512>>>>>        forward send construct_object
36514>>>>>        Set Label to "About..."
36515>>>>>        Set Size to 100 217
36516>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
36517>>>>>
36517>>>>>        Object SysInfo_Dialog is a SysInfoDialog
36519>>>>>        End_Object
36520>>>>>
36520>>>>>        Object oBox is a Container3d
36522>>>>>            Set Border_Style to Border_StaticEdge
36523>>>>>            Set Size to 63 202
36524>>>>>            Set Location to 4 5
36525>>>>>
36525>>>>>            Object AboutGraphic is a BitmapContainer
36527>>>>>                Set Border_Style to Border_None
36528>>>>>                Set Bitmap_Style to Bitmap_Center
36529>>>>>                Set Size to 48 48
36530>>>>>                Set Location to 7 2
36531>>>>>            End_Object    // AboutGraphic
36532>>>>>
36532>>>>>            Object ProductName is a TextBox
36534>>>>>                Set label to "ProductName"
36535>>>>>                Set Size to 10 45
36536>>>>>                Set Location to 8 53
36537>>>>>            End_Object    // ProductName
36538>>>>>
36538>>>>>            Object Version is a TextBox
36540>>>>>                Set label to "Version"
36541>>>>>                Set Size to 10 25
36542>>>>>                Set Location to 21 53
36543>>>>>            End_Object    // Version
36544>>>>>
36544>>>>>            Object Copyright is a TextBox
36546>>>>>                Set label to "Copyright"
36547>>>>>                Set Size to 10 31
36548>>>>>                Set Location to 34 53
36549>>>>>            End_Object    // Copyright
36550>>>>>
36550>>>>>            Object Author is a TextBox
36552>>>>>                Set label to "Author"
36553>>>>>                Set Size to 10 22
36554>>>>>                Set Location to 46 53
36555>>>>>            End_Object    // Author
36556>>>>>
36556>>>>>        End_Object    // oBox
36557>>>>>
36557>>>>>        Object OK_bn is a Button
36559>>>>>            On_Item "&OK" Send Close_Panel
36560>>>>>            Set Size to 14 50
36561>>>>>            Set Location to 71 157
36562>>>>>        End_Object    // OK_bn
36563>>>>>
36563>>>>>        Object SysInfo_bn is a Button
36565>>>>>            On_Item "&System Info" Send Show_Sysinfo
36566>>>>>            Set Size to 14 50
36567>>>>>            Set Location to 71 101
36568>>>>>        End_Object    // SysInfo_bn
36569>>>>>
36569>>>>>        On_Key Kcancel Send KeyAction to (Ok_bn(Current_Object))
36570>>>>>        On_Key Key_Alt+Key_O Send KeyAction to (Ok_bn(Current_Object))
36571>>>>>        On_Key Key_Alt+Key_S Send KeyAction to (SysInfo_bn(Current_Object))
36572>>>>>
36572>>>>>        Get_Profile_String "Defaults" "VdfRootDir" To sVdfRootDir
36575>>>>>        Set logo to (sVdfRootDir +"\Bitmaps\DacAbout.bmp")  // square bitmaps of 42x42 work best
36576>>>>>
36576>>>>>    End_Procedure
36577>>>>>
36577>>>>>    Procedure set productname string sval
36578>>>>>        set label of (productname(oBox(current_object))) to sval
36579>>>>>    End_Procedure
36580>>>>>
36580>>>>>    Procedure set version string sval
36581>>>>>        set label of (version(oBox(current_object))) to sval
36582>>>>>    End_Procedure
36583>>>>>
36583>>>>>    Procedure set copyright string sval
36584>>>>>        set label of (copyright(oBox(current_object))) to sval
36585>>>>>    End_Procedure
36586>>>>>
36586>>>>>    Procedure set author string sval
36587>>>>>        set label of (author(oBox(current_object))) to sval
36588>>>>>    End_Procedure
36589>>>>>
36589>>>>>    // square bitmaps of 42x42 work best
36589>>>>>    //
36589>>>>>    Procedure set logo string sval
36590>>>>>        set bitmap of (aboutgraphic(oBox(current_object))) to sval
36591>>>>>    End_Procedure
36592>>>>>
36592>>>>>    Procedure Show_Sysinfo
36593>>>>>        Send Popup_Modal To (Sysinfo_Dialog(Current_Object))
36594>>>>>    End_Procedure // Show_Sysinfo
36595>>>>>
36595>>>>>End_Class
36596>>>>>
36596>>>>>
36596>>>>>//Object About_Dialog is an AboutDialog
36596>>>>>//    set productname to "Visual DataFlex"
36596>>>>>//    set version to "version 4.0"
36596>>>>>//    set copyright to "Copyright 1997 Data Access Corporation"
36596>>>>>//    set author to ""
36596>>>>>//    set logo to "ablogo.bmp"  // square bitmaps of 42x42 work best
36596>>>>>//End_Object
36596>>>>>
36596>>>>>//Procedure Activate_About
36596>>>>>//   Send Popup_Modal To (About_Dialog (Current_Object))
36596>>>>>//End_Procedure
36596>>>
36596>>>// *************************************************************************
36596>>>//  Public message. This is the default message. It is expected that you will
36596>>>//   create your own message to override this
36596>>>// *************************************************************************
36596>>>
36596>>>Procedure Activate_About
36598>>>   Send DoAbout "" "" "" "" "" ""
36599>>>End_Procedure
36600>>>
36600>>>// *************************************************************************
36600>>>//  Public message. It is expected that you will send this message (most
36600>>>//  likely from Activate_About. This creates an about object, activates it
36600>>>//  and destroys it when done. It is not exepected that you will augment this.
36600>>>// *************************************************************************
36600>>>
36600>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
36602>>>        Local integer hoObj hoMain
36603>>>
36603>>>        // create object
36603>>>        Object About is an AboutDialog
36605>>>            // if no title passed use the label of the main panel
36605>>>            // (if a main panel exists).
36605>>>            if sTitle     eq '' Begin
36607>>>                Get Main_Window to hoMain
36608>>>                if hoMain Get Label of hoMain to sTitle
36611>>>            end
36611>>>>
36611>>>            set productname to sTitle
36612>>>            set version     to sVersion
36613>>>            set copyright   to sCopyRight
36614>>>            set author      to sAuthor
36615>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
36618>>>            Move Current_Object to hoObj // object Id
36619>>>        End_Object
36620>>>        Send Popup to hoObj    // popup the about object
36621>>>        Send Request_Destroy_Object to hoObj // when done, it will be destroyed
36622>>>End_procedure
36623>    
36623>    
36623>    
36623>    
36623>    
36623>    //AB-PanelStoreEnd
36623>
36623>
36623>End_Object
36624>
36624>
36624>//AB-StoreStart
36624>
36624>Start_UI
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>
36625>//AB-StoreEnd
36625>
36625>
Summary
Memory Available: 2147483647
Total Errors   : 0
Total Symbols  : 21499
Total Resources: 0
Total Commands : 36624
Total Windows  : 1
Total Pages    : 1
Static Data    : 255695
Message area   : 181766
Total Blocks   : 12199
