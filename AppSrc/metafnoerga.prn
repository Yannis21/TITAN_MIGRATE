Compiling Program: L:\Vdf6\Develop\Empor\AppSrc\metafnoerga.src
Memory Available: 2147483647
1>Use AllEntSc
Using pre-compiled package ALLENTSC
INCLUDING FILE: ALLENTSC.PKI
30325>
30325>Register_Object Client_Area
30325>
30325>//AB-StoreTopStart
30325>Use Workspc.pkg
30325>
30325>//  Set date attributes as needed
30325>Set_Date_Attribute sysdate4_State to (TRUE)
30326>Set_Date_Attribute Date4_State    to (TRUE)
30327>Set_Date_Attribute epoch_value    to 30
30328>
30328>Object ProgramWorkspace is a WorkspaceSub
30330>    Set WorkspaceName to CURRENT$WORKSPACE
30331>    Set kEnter_Next_State to True
30332>//    Set ModuleName    to 'ProgramName' // Special module name.
30332>//    Set HelpName      to 'HelpName.hlp'// Please provide the name of your Windows help file.
30332>End_Object
30333>
30333>Use Help_Ids.inc // Developer should provide this file of help context links.
INCLUDING FILE: HELP_IDS.INC
30333>>>// Help_ids.inc
30333>>>//
30333>>>// Context ids for the order entry system. This uses
30333>>>// help file ordentry.hlp.
30333>>>//
30333>>>// This is a sample version. YOU must supply
30333>>>// the ID values
30333>>>
30333>>>//  Generic Context Ids
30333>>>//
30333>>>
30333>>>// It is expected that file-names ids will be the same as their
30333>>>// filenumber.
30333>>>
30333>>>
30333>>>//  View and selection-list specific context ids
30333>>>//
30333>>>//..........add view, object, selection-list ids here....
30333>Use Std_Help.pkg
INCLUDING FILE: STD_HELP.PKG
30333>>>// STD_HELP.PKG
30333>>>//
30333>>>// Global Help Object
30333>>>//
30333>>>//  Creates all Help Support required to access WINDOWs help system
30333>>>//  with DataFlex. Creates a global object named Help_Object.
30333>>>//
30333>>>//  9/19/97 JJT - Modified to define stadnard help Ids if they are undefined
30333>>>
30333>>>use DFHlpSys // Context Sensitive Help Support
30333>>>
30333>>>
30333>>>// This file needs to be provided by the developer. It will contain
30333>>>// symbolic replacements for the ID integer values used to access the
30333>>>// the windows help file's topics.
30333>>>//
30333>>>use Help_ids.inc
30333>>>
30333>>>// If the following are not defined in help_ids.inc,
30333>>>//  create default 0 values for them
30333>>>Define GeneralHelpId    for    0
30333>>>Define KeysHelpId       for    0
30333>>>Define FileHelpId       for    0
30333>>>Define ErrorHelpId      for    0  // probably not used in VDF
30333>>>Define IndexHelpId      for    0  // probably not used in VDF
30333>>>
30333>>>object Help_Object is a HelpSystem // global help object
30335>>>
30335>>>   Set Help_Id_General to GeneralHelpId    // these should all be defined
30336>>>   Set Help_Id_Index   to IndexHelpId      // in help_ids.inc.
30337>>>   Set Help_Id_Keys    to KeysHelpId       //
30338>>>   Set Help_Id_Files   to FileHelpId       //
30339>>>   Set Help_Id_Errors  to ErrorHelpId      //
30340>>>
30340>>>end_object
30341>
30341>Use WinQlSQL.Sub
INCLUDING FILE: WINQLSQL.SUB
30341>>>Use CrystalReport.pkg
30341>>>
30341>>>
30341>>>
30341>>>Type PEWindowOptions
30341>>>  Field PEWindowOptions.StructSize As Word
30341>>>  Field PEWindowOptions.hasGroupTree As Word
30341>>>  Field PEWindowOptions.canDrillDown As Word
30341>>>  Field PEWindowOptions.hasNavigationControls As Word
30341>>>  Field PEWindowOptions.hasCancelButton As Word
30341>>>  Field PEWindowOptions.hasPrintButton As Word
30341>>>  Field PEWindowOptions.hasExportButton As Word
30341>>>  Field PEWindowOptions.hasZoomControl As Word
30341>>>  Field PEWindowOptions.hasCloseButton As Word
30341>>>  Field PEWindowOptions.hasProgressControls As Word
30341>>>  Field PEWindowOptions.hasSearchButton As Word
30341>>>  Field PEWindowOptions.hasPrintSetupButton As Word
30341>>>  Field PEWindowOptions.hasRefreshButton As Word
30341>>>End_Type // PEWindowOptions
30341>>>
30341>>>External_Function32 PESetWindowOptions "PESetWindowOptions" CRPE32.DLL ;  Integer printJob pointer Options Returns Integer
30342>>>
30342>>>Class CrystalReportSubSQL Is A CrystalReport
30343>>>
30343>>>    Procedure Construct_Object
30344>>>        Forward send Construct_Object
30346>>>        // Everything on except hasGroupTree by default
30346>>>        property integer hasGroupTree 0
30347>>>        property integer canDrillDown 1
30348>>>        property integer hasNavigationControls 1
30349>>>        property integer hasCancelButton 1
30350>>>        property integer hasPrintButton 1
30351>>>        property integer hasExportButton 1
30352>>>        property integer hasZoomControl 1
30353>>>        property integer hasCloseButton 1
30354>>>        property integer hasProgressControls 1
30355>>>        property integer hasSearchButton 1
30356>>>        property integer hasPrintSetupButton 1
30357>>>        property integer hasRefreshButton 1
30358>>>
30358>>>        Set WindowStyle To (WS_MAXIMIZE iOr WS_OVERLAPPEDWINDOW)
30359>>>    End_Procedure // Construct_Object
30360>>>
30360>>>    Procedure OutputToWindow String sTitle Integer iLeft Integer iTop Integer iWidth Integer iHeight Integer iStyle Handle hParent
30361>>>        Integer iPrintJob iResult
30362>>>        String sPEWindowOptions
30362>>>        Pointer pPeWindowOptions
30362>>>
30362>>>        Get PrintJob To iPrintJob
30363>>>        FillType PEWindowOptions with 0     to sPEWindowOptions
30364>>>        put PEWindowOptions_Size            to sPEWindowOptions at PEWindowOptions.StructSize
30365>>>        put (hasGroupTree(self))            to sPEWindowOptions at PEWindowOptions.hasGroupTree
30366>>>        put (canDrillDown(self))            to sPEWindowOptions at PEWindowOptions.canDrillDown
30367>>>        put (hasNavigationControls(self))   to sPEWindowOptions at PEWindowOptions.hasNavigationControls
30368>>>        put (hasCancelButton(self))         to sPEWindowOptions at PEWindowOptions.hasCancelButton
30369>>>        put (hasPrintButton(self))          to sPEWindowOptions at PEWindowOptions.hasPrintButton
30370>>>        put (hasExportButton(self))         to sPEWindowOptions at PEWindowOptions.hasExportButton
30371>>>        put (hasZoomControl(self))          to sPEWindowOptions at PEWindowOptions.hasZoomControl
30372>>>        put (hasCloseButton(self))          to sPEWindowOptions at PEWindowOptions.hasCloseButton
30373>>>        put (hasProgressControls(self))     to sPEWindowOptions at PEWindowOptions.hasProgressControls
30374>>>        put (hasSearchButton(self))         to sPEWindowOptions at PEWindowOptions.hasSearchButton
30375>>>        put (hasPrintSetupButton(self))     to sPEWindowOptions at PEWindowOptions.hasPrintSetupButton
30376>>>        put (hasRefreshButton(self))        to sPEWindowOptions at PEWindowOptions.hasrefreshButton
30377>>>        GetAddress of sPEWindowOptions      to pPEWindowOptions
30378>>>        Move (PESetWindowOptions(iPrintJob, pPEWindowOptions)) to iResult
30379>>>        Forward Send OutputToWindow sTitle iLeft iTop iWidth iHeight iStyle hParent
30381>>>    End_Procedure // OutputToWindow
30382>>>
30382>>>    Procedure Set TmpFileDir String aDir
30383>>>        String lsCurrWspc lsDir
30384>>>
30384>>>//        If (ghoWorkSpace <> 0) Begin
30384>>>//            Get WorkSpaceName of ghoWorkSpace to lsCurrWspc
30384>>>//            Insert "WorkSpaces\" in lsCurrWspc at 1
30384>>>//            Get_Profile_String lsCurrWspc aDir to lsDir
30384>>>//            Set Report_Data_Path to lsDir
30384>>>//        End
30384>>>    End_Procedure
30385>>>
30385>>>    Procedure DoWinQLReport
30386>>>        // This can be used when reports must be able to run in different data directories
30386>>>        Set TmpFileDir to "TmpFileDir"
30387>>>        Forward Send DoWinQLReport
30389>>>    End_Procedure
30390>>>
30390>>>
30390>>>    // This hook procedure is called after the print job has been opened.
30390>>>
30390>>>    Procedure OnInitializeReport000
30391>>>    ////// SOS Na ginei xana OnInitializeReport ///////////
30391>>>
30391>>>        Integer iTables iMax iCount iType
30392>>>        String  sLocation sLocation2 sPath DirSep
30392>>>        String  sNewPath sNewLocation sDataPath sMyLocation
30392>>>
30392>>>//        Open Sysfile
30392>>>
30392>>>        String  sActualSQL
30392>>>        String  sActualTemp
30392>>>        String  sOldSQL
30392>>>        String  sOldTemp
30392>>>        String  sServerName
30392>>>        String  sDatabaseName
30392>>>        String  sUserID
30392>>>
30392>>>//        Move Sysfile.ActualSQL      to sActualSQL
30392>>>//        Move Sysfile.ActualTemp     to sActualTemp
30392>>>//        Move Sysfile.OldSQL         to sOldSQL
30392>>>//        Move Sysfile.OldTemp        to sOldTemp
30392>>>//        Move Sysfile.cServerName    to sServerName
30392>>>//        Move Sysfile.cDatabaseName  to sDatabaseName
30392>>>//        Move Sysfile.cUserID        to sUserID
30392>>>
30392>>> //       Move 'SMS'                 to sOldSQL
30392>>> //       Move 'C:\Dns_tmp\'         to sOldTemp
30392>>> //       Move 'SMSMET'        to sActualSQL      // Database
30392>>> //       Move 'C:\Dns_tmp\'         to sActualTemp
30392>>> //      Move 'SMSMET'        to sServerName    // ODBC
30392>>> //       Move 'SMSMET'        to sDatabaseName  // DataBase
30392>>>     //   Move 'sa'               to sUserID
30392>>>
30392>>>        Move 'SMS'                 to sOldSQL
30393>>>        Move 'C:\Dns_tmp\'         to sOldTemp
30394>>>        Move 'SMSTITAN'            to sActualSQL      // Database
30395>>>        Move 'C:\Dns_tmp\'         to sActualTemp
30396>>>        Move 'SMSTITAN'            to sServerName    // ODBC
30397>>>        Move 'SMSTITAN'            to sDatabaseName  // DataBase
30398>>>
30398>>>
30398>>>        Move (Trim(sActualSQL   )) to sActualSQL
30399>>>        Move (Trim(sActualTemp  )) to sActualTemp
30400>>>        Move (Trim(sOldSQL      )) to sOldSQL
30401>>>        Move (Trim(sOldTemp     )) to sOldTemp
30402>>>        Move (Trim(sServerName  )) to sServerName
30403>>>        Move (Trim(sDatabaseName)) to sDatabaseName
30404>>>        Move (Trim(sUserID      )) to sUserID
30405>>>
30405>>>
30405>>>        Forward Send OnInitializeReport
30407>>>
30407>>>        Move (Sysconf(SYSCONF_DIR_SEPARATOR)) To DirSep
30408>>>        Get NTables To iMax
30409>>>        Decrement iMax
30410>>>        Get Report_Data_Path                                    To sPath
30411>>>        If Not (Right(sPath,1)) Eq DirSep Move (sPath-DirSep)   To sPath
30414>>>        For iCount From 0 To iMax
30420>>>>
30420>>>            Get NthTableLocation iCount         To sLocation
30421>>>            Get Report_Base_File_Name sLocation To sLocation2
30422>>>            Get NthTableDBType           iCount to iType
30423>>>
30423>>>            // An einai type 1 topiko
30423>>>            //               2=SQL
30423>>>            If (iType=2) Begin
30425>>>                If (sLocation contains sOldSQL) Begin
30427>>>                    Move (Replace(sOldSQL,sLocation,sActualSQL))    to sLocation
30428>>>                    Set NthTableLocation iCount                     to (Trim(sLocation))
30429>>>                End
30429>>>>
30429>>>            End
30429>>>>
30429>>>            Else If (iType=1) Begin
30432>>>                If (sLocation contains sOldTemp) Begin
30434>>>                    Move (Replace(sOldTemp,sLocation,sActualTemp))  to sLocation
30435>>>                    Set NthTableLocation iCount                     to (Trim(sLocation))
30436>>>                End
30436>>>>
30436>>>            End
30436>>>>
30436>>>            Set nthTableLogOnServerName     iCount to sServerName     0
30437>>>            Set nthTableLogOnDataBaseName   iCount to sDatabaseName   0
30438>>>            Set nthTableLogOnUserID         iCount to sUserID         0 // 'sa'     0
30439>>>        Loop // For iCount From 0 To iMax
30440>>>>
30440>>>
30440>>>    End_Procedure // OnInitializeReport
30441>>>
30441>>>
30441>>>//                Showln '--------------------------------------------------------'
30441>>>//                Showln iCount
30441>>>//                Showln sLocation
30441>>>//                Showln sPath
30441>>>//                Showln sLocation2
30441>>>//                Showln iType
30441>>>
30441>>>                //If (Trim(LowerCase(sLocation2))='btnemp.dat') Begin
30441>>>                  //Set Report_Data_Path to ''
30441>>>                  //Get NthTableDBType              iCount to iType
30441>>>                    //Set nthTableLogOnPassword       iCount to '123'     0
30441>>>                  //Set NthTableLocation            iCount To "BTNEMP"
30441>>>                    //Set NthTableLocation iCount To (sPath-sLocation2)
30441>>>                  //Get NthTableLocation iCount                 To sMyLocation
30441>>>                  //Move (Replace(sLocation,sMyLocation,''))    To sMyLocation
30441>>>                  //Showln sMyLocation
30441>>>                  //Set NthTableLocation            iCount To sMyLocation
30441>>>                //End
30441>>>
30441>>>
30441>>>
30441>>>    // This hook procedure is called just before a print job is closed.
30441>>>    Procedure OnDeInitializeReport
30442>>>        Forward Send OnDEInitializeReport
30444>>>    End_Procedure // OnDeInitializeReport
30445>>>
30445>>>    // This hook procedure is called just before a the print job is started.
30445>>>    Procedure OnStartPrinting
30446>>>        Forward Send OnStartPrinting
30448>>>    End_Procedure // OnStartPrinting
30449>>>
30449>>>    // This hook procedure is called just after a print job has finished.
30449>>>    Procedure OnStopPrinting
30450>>>        Forward Send OnStopPrinting
30452>>>    End_Procedure // OnStopPrinting
30453>>>
30453>>>
30453>>>End_Class // CrystalReportSubSQL
30454>>>
30454>Integer giWait_Obj
30454>
30454>// General Functions-Procedures and Variables
30454>Use Globals.Inc
INCLUDING FILE: GLOBALS.INC
30454>>>
30454>>>        String  gs_Selected_Company_Code
30454>>>        String  gs_Selected_Branch_Code
30454>>>        Integer gi_Selected_Year
30454>>>        String gs_Selected_Year_Recr
30454>>>        String  gs_Module_Code
30454>>>
30454>>>
30454>>>//Open Currency
30454>>>//Function CurrDigits Global String asCurr Returns Integer
30454>>>//    Integer liDecX
30454>>>//    Clear Currency
30454>>>//    move asCurr to Currency.Currency_C_Code
30454>>>//    Find Eq Currency By Index.1
30454>>>//    move Currency.Currency_Dec to liDecX
30454>>>//    Function_Return liDecX
30454>>>//End_Function // CurrDigits
30454>>>
30454>>>Open Nomisma
INCLUDING FILE: NOMISMA.FD
30456>>>Open SysCurXr
INCLUDING FILE: SYSCURXR.FD
30458>>>
30458>>>Function fiDekadika_Nomismatos Global String asNomisma Returns Integer
30459>>>    Move (Trim(asNomisma)) to asNomisma
30460>>>    Clear Nomisma
30461>>>    If ( asNomisma<>'' ) Move asNomisma         to Nomisma.Nomisma_Code
30464>>>    Else                 Move SysCurXr.C_Code0  to Nomisma.Nomisma_Code
30466>>>    Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
30467>>>>
30467>>>    Function_Return Nomisma.Dekadika
30468>>>End_Function //
30469>>>
30469>>>Function fsgCode_W_Zeroes Global Integer aiCode Integer aiPlaces Returns String
30470>>>    String rVal
30471>>>    Integer iLength iInt
30471>>>    Move aiCode to rVal
30472>>>    Move (trim(rVal)) to rVal
30473>>>    For iInt From 1 to (aiPlaces-(Length(rVal)))
30479>>>>
30479>>>        Move (Insert('0',rVal,1)) to rVal
30480>>>    Loop
30481>>>>
30481>>>    Function_Return rVal
30482>>>End_Function
30483>>>
30483>>>Function fsgCode_n_Zeroes Global number aiCode Integer aiPlaces Returns String
30484>>>    String rVal
30485>>>    Integer iLength iInt ipos
30485>>>    Move aiCode to rVal
30486>>>    Move (trim(rVal)) to rVal
30487>>>    MOVE (aiPlaces-(Length(rVal))) to ipos
30488>>>    For iInt From 1 to ipos
30494>>>>
30494>>>        Move (Insert('0',rVal,1)) to rVal
30495>>>    Loop
30496>>>>
30496>>>    Function_Return rVal
30497>>>End_Function
30498>>>
30498>>>
30498>>>Open Year
INCLUDING FILE: YEAR.FD
30500>>>Procedure EnumDDsForRebuildConstrain for DataDictionary integer aiMsg integer ahId
30501>>>    Send aiMsg to Self
30502>>>End_Procedure
30503>>>
30503>>>Procedure DoRefindYear for baseclass Integer aiPanel Integer aiYearDD
30504>>>    Integer liChanged
30505>>>
30505>>>    If ((aiYearDD = 0) or (Main_File(aiYearDD)<>Year.File_Number)) ;        Procedure_Return (Message_Box("Invalid Year_DD","Developer's Warning",MB_OK,MB_ICONWARNING))
30508>>>    If (Not(Current_Record(aiYearDD))) Begin
30510>>>        Get Should_Save of aiPanel to liChanged
30511>>>        Send Clear to aiYearDD
30512>>>        Move gs_Selected_Company_Code to Year.Company_Code
30513>>>        Move gs_Selected_Branch_Code  to Year.Branch_Code
30514>>>        Move gi_Selected_Year         to Year.Year_Year
30515>>>        Send Find to aiYearDD Eq 1 //Year.Index.1 - company_code+ranch_code+year_year
30516>>>        If (Not(liChanged)) Set Changed_State of aiPanel to False
30519>>>    End
30519>>>>
30519>>>End_Procedure
30520>>>
30520>>>Procedure RebuildConstrainIfYearChanged for baseclass Integer aiPanel String asCurrentYearRecr Integer aiYearDDId
30521>>>    Integer liSrvr
30522>>>    String  lsCurrentYearRecr
30522>>>
30522>>>    If (asCurrentYearRecr <> gs_Selected_Year_Recr) Begin
30524>>>        Broadcast Send EnumDDsForRebuildConstrain to aiPanel msg_Rebuild_Constraints Self
30526>>>    End
30526>>>>
30526>>>    Send DoRefindYear aiPanel aiYearDDId //(Year_DD(Self))
30527>>>    Get Server of aiPanel to liSrvr
30528>>>    // Respects Default values
30528>>>    If (liSrvr) If (Not(Current_Record(liSrvr))) Send Request_Clear to aiPanel
30533>>>End_Procedure
30534>>>
30534>>>//                                       ’¦ View            Property «¦¬ View             ’¦ Year DDO «¦¬ View
30534>>>//                                                          Holds the current year rec0
30534>>>// ‰¢ã©ž : Send RbldConstrIfYearChanged (Gplan_Test(Self))  (psCurrentYearRecr(Self))     (Year_DD(Self))
30534>>>
30534>>>
30534>>>Function fiRefindYear Global Returns Integer
30535>>>    Clear Year
30536>>>    Move gs_Selected_Company_Code to Year.Company_Code
30537>>>    Move gs_Selected_Branch_Code  to Year.Branch_Code
30538>>>    Move gi_Selected_Year         to Year.Year_Year
30539>>>    Find eq Year by Index.1 //company_code+ranch_code+year_year
30540>>>>
30540>>>    Function_Return (Found = 0)
30541>>>End_Function //fiRefindYear
30542>>>
30542>>>Procedure DoRunApplication for Baseclass String sAppName
30543>>>    string sRuntime  lsStr
30544>>>
30544>>>    Append lsStr 'C:\Dns.bat ' sAppName
30546>>>    RunProgram Wait  lsStr
30547>>>
30547>>>//    get_profile_string "defaults" "VDFBinDir" to sRuntime
30547>>>//    append sRuntime "\dfrun " sAppName
30547>>>    Append sRuntime 'C:\Program Files\Accessories\WORDPAD.EXE ' sAppName
30549>>>    runprogram background sRuntime
30550>>>End_procedure // DoRunApplication
30551>>>
30551>>>// Run the Editor
30551>>>Procedure DoRunEditor for Baseclass String asFile
30552>>>    string sRunPath lsWspcName
30553>>>    Move (WorkspaceName(ProgramWorkspace(Self))) to lsWspcName
30554>>>    get_profile_string ("workspaces\"+lsWspcName) "programpath" to sRunPath
30557>>>    //append sRunPath "\Editor "  asFile //// js 15/03/2002 " " lsWspcName
30557>>>    Move (Replace('.',asFile,'')) to asFile
30558>>>    append sRunPath asFile //// js 15/03/2002 " " lsWspcName
30559>>>    send DoRunApplication sRunPath
30560>>>End_Procedure // DoRunEditor
30561>>>
30561>>>//--------------------------------------
30561>>>
30561>>>//start of global functions and procedures
30561>>>
30561>>>
30561>>>//®¨ž© £¦§¦ œå«˜  ˜§æ: ˜) gmoves.dd    :private.update_gmhnes_ghmnies
30561>>>Function gsfFind_Previous Global String lsCode;                                 String lsDelimiter;                                 Returns String
30562>>>         String  lsTemp_Code1 lsTemp_Code2
30563>>>         Integer liCounter
30563>>>
30563>>>         //1.˜­˜å¨œ©ž ¡œ¤é¤
30563>>>         Move (Trim(lsCode)) to lsCode                                  //§® 30.12.345
30564>>>
30564>>>         //2.˜¤« ©«¨¦­ã
30564>>>         For liCounter From 1 to (Length(lsCode))
30570>>>>
30570>>>             Move (Insert(;                           (Mid(lsCode,1,liCounter)),;                           lsTemp_Code1,;                           1;                         )) to lsTemp_Code1                             //§® 543.21.03
30571>>>         Loop
30572>>>>
30572>>>
30572>>>         //3.˜­˜å¨œ©ž ¡œ¤é¤ (›â¤ ®¨œ áœ«˜ , safety only)
30572>>>         Move (Trim(lsTemp_Code1)) to lsTemp_Code1
30573>>>
30573>>>         //4.§˜å¨¤à £æ¤¦ «¦ ›œ¥ æ £â¨¦ª «¦¬ ˜¤«å©«¨¦­¦¬, £œ«á «¦ §¨é«¦ delimiter
30573>>>         Move (Right(;                      lsTemp_Code1,;                      ((Length(lsTemp_Code1))-((Pos(lsDelimiter,lsTemp_Code1))));                    )) to lsTemp_Code1                                  // §® 21.03
30574>>>
30574>>>         //5.¥˜¤á ˜¤« ©«¨¦­ã «¦¬ ˜¤«å©«¨¦­¦¬
30574>>>         For liCounter from 1 to (Length(lsTemp_Code1))
30580>>>>
30580>>>             Move (Insert(;                           (Mid(lsTemp_Code1,1,liCounter)),;                           lsTemp_Code2,;                           1;                         )) to lsTemp_Code2                             //§® 30.12
30581>>>         Loop
30582>>>>
30582>>>
30582>>>         Function_Return (Trim(lsTemp_Code2))
30583>>>End_Function //gsffind_previous
30584>>>
30584>>>
30584>>>Function gifSystem_Check Returns Integer
30585>>>         Integer liF_Gtypkins liF_Garicls liF_Gmoves liF_Gplans liF_Gmhnes liF_Ghmnies
30586>>>         Integer liS_Gtypkins liS_Garicls liS_Gmoves liS_Gplans liS_Gmhnes liS_Ghmnies
30586>>>//       Clear Company
30586>>>//       Find Gt Company.Recnum
30586>>>//       While (Found = 1)
30586>>>//             Add Company.Company_NumGtypkin to liS_Gtypkins § Ÿ˜¤é© ©«¦ sysfile ¤˜ «˜ ¡˜¨˜«áà ˜¬«á
30586>>>//             Add Company.Company_NumGarticl to liS_Garticls
30586>>>//             Add Company.Company_NumGmoves  to liS_Gmoves
30586>>>//             //d Company.Company_NumGtypkin to liS_Gtypkins
30586>>>//             Add Company.Company_NumGplan   to liS_GPlans
30586>>>//             Add Company.Company_NumGmhnes  to liS_Gmhnes
30586>>>//             Add Company.Company_NumGhmnies to liS_Ghmnies
30586>>>//             Find Gt Company.Recnum
30586>>>//       Loop
30586>>>//
30586>>>//       Get_Attribute {attribute} [of {file-handle} ;
30586>>>//                        [{field-num} | {index-num} [{segment-num}]]] ;
30586>>>//                        To {variable}
30586>>>//
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Garticl.File_Number to liF_Garticls
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmoves.File_Number  to liF_Gmoves
30586>>>//       //t_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gplan.File_Number   to liF_Gplans
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmhnes.File_Number  to liF_Gmhnes
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Ghmnies.File_Number to liF_Ghmnies
30586>>>//
30586>>>
30586>>>//       //â¢œš®¦ª DF_FILE_MAX_RECORDS+ £œ records used
30586>>>
30586>>>//       //â¢œš®¦ª last rec0 = sysrec rec0
30586>>>
30586>>>    Function_Return 0
30587>>>End_Function //gifSystem_Check
30588>>>
30588>>>/////////////////////////////////////////////////////////////////
30588>>>//‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª, £œ ž ®à¨åª ›œ¡˜› ¡á  JS
30588>>>Function Sfi_All_Numbers Global Number anValue Integer aiLengthAkeraios Integer aiLengthDekadika Returns String
30589>>>
30589>>>    String  lsRetval lsValue lsAkeraios lsDekadika
30590>>>    Integer liInt liInteger iTimes iStart
30590>>>    Number  lnDecimals
30590>>>
30590>>>    Move (Integer(anValue))                                         to liInteger
30591>>>    Move (Round(AnValue-(Integer(anValue))*(10^aiLengthDekadika)))  to lnDecimals
30592>>>
30592>>>    Move liInteger              to lsAkeraios
30593>>>    Move lnDecimals             to lsDekadika
30594>>>    Move (Trim(lsAkeraios))     to lsAkeraios
30595>>>    Move (Trim(lsDekadika))     to lsDekadika
30596>>>
30596>>>    Move (Length(lsAkeraios)) to iStart
30597>>>    For iTimes From iStart to (aiLengthAkeraios-1)
30603>>>>
30603>>>        Insert "0" in lsAkeraios at 1
30605>>>    Loop
30606>>>>
30606>>>    Move (Trim(lsAkeraios)) to lsAkeraios
30607>>>
30607>>>    Move (Length(lsDekadika)) to iStart
30608>>>    For iTimes From iStart to (aiLengthDekadika-1)
30614>>>>
30614>>>        Move (Append(lsDekadika,"0")) to lsDekadika
30615>>>    Loop
30616>>>>
30616>>>    Move (Trim(lsDekadika)) to lsDekadika
30617>>>
30617>>>    If (aiLengthDekadika=0) Move '' to lsDekadika
30620>>>    Move '' to lsRetVal
30621>>>    Move (Pad((lsAkeraios-lsDekadika),(aiLengthAkeraios+aiLengthDekadika))) to lsRetval
30622>>>    Function_Return lsRetval
30623>>>End_Function //sfi_All_Numbers  ‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª
30624>>>              //                 £œ ž ®à¨åª ›œ¡˜› ¡á (JS)
30624>>>
30624>>>Open Codemast
30626>>>
30626>>>
30626>>>Function gsfCode_Mast Global String lsType String lsValue Returns String
30627>>>         Clear Codemast
30628>>>         Move lsType  to Codemast.Type
30629>>>         Move lsValue to Codemast.Code
30630>>>         Find Eq Codemast by Index.1 //type+code
30631>>>>
30631>>>         Function_Return Codemast.Description
30632>>>End_Function //code_mast
30633>>>
30633>>>
30633>>>Open Branch
INCLUDING FILE: BRANCH.FD
30635>>>Function fsgCode_With_Zeroes Global Integer aiCode    ;                                    Integer aiPlaces  ;                                    String asCompany  ;                                    String asBranch   ;                               Returns String
30636>>>    String rVal
30637>>>    Integer iInt
30637>>>    Clear Branch
30638>>>    Move asCompany  to Branch.Company_Code
30639>>>    Move asBranch   to Branch.Branch_Code
30640>>>    Find Eq Branch by Index.1
30641>>>>
30641>>>    If (Trim(Branch.Tomeas_Code)<>'') Move (Trim(Branch.Tomeas_Code)) to asBranch
30644>>>    Move (Trim(asCompany))  to asCompany
30645>>>    Move (Trim(asBranch))   to asBranch
30646>>>    If (Length(asCompany)=1) Insert '0' In asCompany At 1
30650>>>    If (Length(asBranch) =1) Insert '0' In asBranch  At 1
30654>>>    Move ''                                           to rVal
30655>>>    Move (Sfi_All_Numbers(aiCode,aiPlaces,0))         to rVal
30656>>>    Move (Append((asCompany+'.'+asBranch+'.'),rVal))  to rVal
30657>>>    Move (Trim(rVal))                                 to rVal
30658>>>    Function_Return rVal
30659>>>End_Function
30660>>>
30660>>>Function fsgStripCodeFromID Global String asID Returns Integer
30661>>>      Integer iLen iPos iInt
30662>>>      If (Trim(asID)='') Function_Return 0
30665>>>      Move (Trim  (asID)) to asID
30666>>>      Move (Length(asID)) to iLen
30667>>>      For iInt From 1     to iLen
30673>>>>
30673>>>          If (Mid(asID,1,iInt)='.') Move iInt to iPos
30676>>>      Loop
30677>>>>
30677>>>      Function_Return (Right(asID,(iLen-iPos)))
30678>>>End_Function
30679>>>
30679>>>Function fsCityDescr Global Integer aiCityID Returns String
30680>>>    String rVal
30681>>>    Open Cities
INCLUDING FILE: CITIES.FD
30683>>>    Clear Cities
30684>>>    Move aiCityID to Cities.City_ID
30685>>>    Find Eq Cities By Index.1
30686>>>>
30686>>>    If (Found=1) Move Cities.City_descr to rVal
30689>>>    Else         Move '' to rVal
30691>>>    Function_Return rVal
30692>>>End_Function
30693>>>
30693>>>Function fiTownIDFromCity Global Integer aiCityID Returns Integer
30694>>>    Open Cities
30696>>>    Clear Cities
30697>>>    Move aiCityID to Cities.City_ID
30698>>>    Find Eq Cities By Index.1
30699>>>>
30699>>>    Function_Return Cities.Town_ID
30700>>>End_Function
30701>>>
30701>>>Function fiCountryIDFromTown Global Integer aiTownID Returns Integer
30702>>>    Open Towns
INCLUDING FILE: TOWNS.FD
30704>>>    Clear Towns
30705>>>    Move aiTownID to Towns.Town_ID
30706>>>    Find Eq Towns By Index.1
30707>>>>
30707>>>    Function_Return Towns.Country_ID
30708>>>End_Function
30709>>>
30709>>>Function fsTownDescr Global Integer aiTownID Returns String
30710>>>    String rVal
30711>>>    Open Towns
30713>>>    Clear Towns
30714>>>    Move aiTownID to Towns.Town_ID
30715>>>    Find Eq Towns By Index.1
30716>>>>
30716>>>    If (Found=1) Move Towns.Town_descr to rVal
30719>>>    Else         Move '' to rVal
30721>>>    Function_Return rVal
30722>>>End_Function
30723>>>
30723>>>Function fsCountryDescr Global Integer aiCountryID Returns String
30724>>>    String rVal
30725>>>    Open Country
INCLUDING FILE: COUNTRY.FD
30727>>>    Clear Country
30728>>>    Move aiCountryID to Country.Country_ID
30729>>>    Find Eq Country By Index.1
30730>>>>
30730>>>    If (Found=1) Move Country.Country_descr to rVal
30733>>>    Else         Move '' to rVal
30735>>>    Function_Return rVal
30736>>>End_Function
30737>>>
30737>>>Function fsAreaDescr Global Integer aiAreaID Returns String
30738>>>    String rVal
30739>>>    Open Areas
INCLUDING FILE: AREAS.FD
30741>>>    Clear Areas
30742>>>    Move aiAreaID to Areas.Area_ID
30743>>>    Find Eq Areas By Index.1
30744>>>>
30744>>>    If (Found=1) Move Areas.Area_descr to rVal
30747>>>    Else         Move '' to rVal
30749>>>    Function_Return rVal
30750>>>End_Function
30751>>>
30751>>>Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
30752>>>    Local String rVal lsTmp lsOO lsLL
30753>>>    Local Number lnOO lnLL
30753>>>
30753>>>    Move '' to lsOO
30754>>>    Move '' to lsLL
30755>>>    Move '' to rVal
30756>>>
30756>>>    Move (Integer(anTime))                              to lnOO
30757>>>
30757>>>    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
30758>>>
30758>>>    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
30761>>>    Else         Move (String(lnOO))                    to lsOO
30763>>>    Move (Trim(lsOO))                                   to lsOO
30764>>>
30764>>>    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
30767>>>    Else         Move (String(lnLL))                    to lsLL
30769>>>    Move (Trim(lsLL))                                   to lsLL
30770>>>
30770>>>    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
30771>>>
30771>>>    Move (Trim(rVal)) to rVal
30772>>>
30772>>>    Function_Return rVal
30773>>>End_Function
30774>>>
30774>>>Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
30775>>>    Local Number rVal nOres nLepta
30776>>>    Move (Integer(aiMinutes/60))    to nOres
30777>>>    Move (    Mod(aiMinutes,60))    to nLepta
30778>>>    Move (nOres+(nLepta/100))       to rVal
30779>>>    Function_Return rVal
30780>>>End_Function
30781>>>
30781>>>Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
30782>>>    Local Integer rVal
30783>>>    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
30784>>>    Function_Return rVal
30785>>>End_Function
30786>>>
30786>>>Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;                                                                    Number anEndTime    ;                                                                    Returns Integer
30787>>>    Local Integer rVal iMinStart iMinEnd
30788>>>
30788>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30791>>>
30791>>>    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
30792>>>    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
30793>>>    Move (iMinEnd-iMinStart)                                                     to rVal
30794>>>    Function_Return rVal
30795>>>End_Function
30796>>>
30796>>>
30796>>>Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;                                                                Number anEndTime    ;                                                                Returns Number
30797>>>    Local Integer iTmp
30798>>>    Local Number  rVal
30798>>>
30798>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30801>>>
30801>>>    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
30802>>>    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
30803>>>    Function_Return rVal
30804>>>End_Function
30805>>>
30805>>>
30805>>>Open WitemCL
INCLUDING FILE: WITEMCL.FD
30807>>>Open WitemCld
INCLUDING FILE: WITEMCLD.FD
30809>>>Open WitemxT
INCLUDING FILE: WITEMXT.FD
30811>>>
30811>>>Function fnTeleytaiaTimhAgoras String asPromCode String asItemCode  ;                               Date   adHmnia    Number anQty       ;                               Returns Number
30812>>>  Integer iExodos
30813>>>  Number nPoso nPct
30813>>>  Move 0 to nPoso
30814>>>  Move 0 to nPct
30815>>>  Move 0 to iExodos
30816>>>
30816>>>  Move (Trim(asItemCode)) to asItemCode
30817>>>  Move (Trim(asPromCode)) to asPromCode
30818>>>
30818>>>  // 1.Anazhthsh sto arxeio Witemcld
30818>>>  Clear Witemcld
30819>>>  Move asItemCode to Witemcld.Item_Code
30820>>>  Move asPromCode to Witemcld.Client_Code
30821>>>  Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30822>>>>
30822>>>  While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;                       (Witemcld.Client_Code= asPromCode) And ;                       (iExodos=0))
30826>>>      If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30828>>>          Move 1 to iExodos
30829>>>               If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30832>>>          Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30836>>>      End
30836>>>>
30836>>>      Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30837>>>>
30837>>>  Loop
30838>>>>
30838>>>  If (iExodos) Begin
30840>>>      If (nPoso) Function_Return nPoso
30843>>>      Else Function_Return nPct
30845>>>  End
30845>>>>
30845>>>
30845>>>  // 2.Anazhthsh sto arxeio Witemcl
30845>>>  Clear WitemCL
30846>>>  Move (Trim(asPromCode)) to WitemCL.Client_Code
30847>>>  Move (Trim(asItemCode)) to WitemCL.Item_Code
30848>>>  Find Eq WitemCL By Index.1
30849>>>>
30849>>>  If (Found=1) Function_Return WitemCL.Client_Price
30852>>>
30852>>>  Function_Return 0
30853>>>End_Function
30854>>>
30854>>>
30854>>>Open BtnOrdd
INCLUDING FILE: BTNORDD.FD
30856>>>
30856>>>Function fnTeleytaiaTimhPolhshs String asWitemxRecr String asClientID ;                                String asWitemxCode Date   adHmnia    ;                                String asItemCode   Number anQty      ;                                String asCNCode     Returns Number
30857>>>
30857>>>  Integer iExodos iCheckDeop
30858>>>  Number nPoso nPct
30858>>>
30858>>>  Move (Num_Arguments=7) to iCheckDeop
30859>>>
30859>>>  Move 0 to nPoso
30860>>>  Move 0 to nPct
30861>>>  Move 0 to iExodos
30862>>>
30862>>>  Move (Trim(asItemCode))                 to asItemCode
30863>>>  Move (Trim(asClientID))                 to asClientID
30864>>>  Move (Trim(asWitemxRecr))               to asWitemxRecr
30865>>>  Move (Trim(asWitemxCode))               to asWitemxCode
30866>>>  If (iCheckDeop) Move (Trim(asCNCode))   to asCNCode
30869>>>
30869>>>  // 1. Anazhthsh apo DEOP ef' oson yparxei kodikos ergou
30869>>>  If (iCheckDeop) Begin
30871>>>      Clear btnordd
30872>>>      Move asClientID   to btnordd.vclient_id
30873>>>      Move asCNCode     to btnordd.vcn_code
30874>>>      Move asWitemxCode to btnordd.vitem
30875>>>      Move 0            to btnordd.vactive
30876>>>      Move adHmnia      to btnordd.arxh_date
30877>>>      Find LE btnordd by index.4//client_id+cn_code+item+arxh_date
30878>>>>
30878>>>      If ((found=1) and (asWitemxCode=btnordd.vitem)    and (adHmnia>=btnordd.arxh_date) ;                    and (adHmnia<=btnordd.deop_date)    and (btnordd.vactive=0)          ;                    and (asCNCode=btnordd.vcn_code)) begin
30880>>>          move btnordd.vprice to nPoso
30881>>>          If (nPoso) Function_Return nPoso
30884>>>      End
30884>>>>
30884>>>  End
30884>>>>
30884>>>  // 19-03-2007 Tolhs na pernei times mono an brei apo deop
30884>>>  // 2.Anazhthsh sto arxeio Witemcld (Timokatalogos Pelath/Eidous)
30884>>> // Clear Witemcld
30884>>> // Move asItemCode to Witemcld.Item_Code
30884>>> // Move asClientID to Witemcld.Client_Code
30884>>> // Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30884>>> // While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;
30884>>> //                      (Witemcld.Client_Code= asClientID) And ;
30884>>> //                      (iExodos=0))
30884>>> //     If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30884>>> //         Move 1 to iExodos
30884>>> //              If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30884>>> //         Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30884>>> //     End
30884>>> //     Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30884>>> // Loop
30884>>> // If (iExodos) Begin
30884>>> //     If (nPoso) Function_Return nPoso
30884>>> //     Else Function_Return nPct
30884>>> // End
30884>>>
30884>>>
30884>>>  // 3.Anazhthsh sto arxeio Witemxt (Timokatalogos Eidous)
30884>>>  //Clear Witemxt
30884>>>  //Move SysCurXr.Company_Code  to Witemxt.Company_Code
30884>>>  //Move SysCurXr.Branch_Code   to Witemxt.Branch_Code
30884>>>  //Move SysCurXr.Year_Year     to Witemxt.Year_Year
30884>>>  //Move asWitemxRecr           to Witemxt.Witemx_Recr
30884>>>  //Find Gt Witemxt By Index.1 // Witemxt:Index.1
30884>>>  //While ((Found=1) And (Witemxt.Company_Code = SysCurXr.Company_Code) And ;
30884>>>  //                     (Witemxt.Branch_Code  = SysCurXr.Branch_Code ) And ;
30884>>>  //                     (Witemxt.Year_Year    = SysCurXr.Year_Year   ) And ;
30884>>>  //                     (Witemxt.Witemx_Recr  = asWitemxRecr         ) And ;
30884>>>  //                     (iExodos=0))
30884>>>  //    If ((adHmnia>=Witemxt.Value_Date) And (anQty<=Witemxt.Qty)) Begin
30884>>>  //        Move 1 to iExodos
30884>>>  //             If (Witemxt.Axia0 <>0) Move  Witemxt.Axia0         to nPoso
30884>>>  //        Else If (Witemxt.PcDisc<>0) Move (Witemxt.PcDisc*(-1))  to nPct
30884>>>  //    End
30884>>>  //    Find Gt Witemxt By Index.1 // Witemxt:Index.1
30884>>>  //Loop
30884>>>  //If (iExodos) Begin
30884>>>  //    If (nPoso) Function_Return nPoso
30884>>>  //    Else Function_Return nPct
30884>>>  //End
30884>>>
30884>>>
30884>>>  // 4.Anazhthsh sto arxeio Witemcl (Teleytaia Timh Agoras)
30884>>>  //Clear WitemCL
30884>>>  //Move (Trim(asClientID)) to WitemCL.Client_Code
30884>>>  //Move (Trim(asItemCode)) to WitemCL.Item_Code
30884>>>  //Find Eq WitemCL By Index.1
30884>>>  //If (Found=1) Function_Return WitemCL.Client_Price
30884>>>
30884>>>  Function_Return 0
30885>>>End_Function
30886>>>
30886>>>Function fsStripTextFieldFromEnter Global String asStr Returns String
30887>>>    String sEnter
30888>>>    Move '' to sEnter
30889>>>    Move (Trim(asStr)) to asStr
30890>>>    Append sEnter (Character(13)) (Character(10))
30892>>>    Move (Replaces(sEnter,asStr,' ')) to asStr
30893>>>    Function_return (Trim(asStr))
30894>>>End_function
30895>>>
30895>>>
30895>>>//end   of global functions and procedures
30895>>>Use Wait.DG
INCLUDING FILE: WAIT.DG
30895>>>>>USE AllEntSc
30895>>>>>
30895>>>>>//AB-IgnoreEnd
30895>>>>>
30895>>>>>
30895>>>>>//AB-IgnoreEnd
30895>>>>>
30895>>>>>Object Wait is a ModalPanelSub
30897>>>>>
30897>>>>>    //AB-StoreTopStart
30897>>>>>
30897>>>>>    // How to Use It
30897>>>>>    // Get the maximum position of the bar
30897>>>>>    // Move (Bar_Maximum_position(Wait(self))) to iMax
30897>>>>>    //
30897>>>>>    // Set the maximum position of the bar
30897>>>>>    // Set Bar_Maximum_position of (Wait(self)) to iMax
30897>>>>>    //
30897>>>>>    // Start Bar Progress from beginning
30897>>>>>    // Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
30897>>>>>    //
30897>>>>>    // End Bar Progress
30897>>>>>    // Send Bar_Current_Position to (Wait(Self)) iMax iMax iMax False
30897>>>>>    //
30897>>>>>    // Update Bar Progress
30897>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax True OR
30897>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax False
30897>>>>>    // When you want the update to be done for every i (this is slower)
30897>>>>>    // Where i=Counter's current value, icounter=Counter's Max Value and iMax=Bar Max Position
30897>>>>>    //
30897>>>>>    // Display Buttons on the object
30897>>>>>    // Set Button_State of (Wait(Self)) to False/True
30897>>>>>    // If the Progress Bar gets initialized without buttons, it MUST be Deactivated
30897>>>>>    //
30897>>>>>    // Initialization of the Progress Bar
30897>>>>>    // Send Popup to (Wait(Self))
30897>>>>>    //
30897>>>>>    // Deactivation of the Progress Bar
30897>>>>>    // Send Deactivate to (Wait(Self))
30897>>>>>    //
30897>>>>>    // Message during the process
30897>>>>>    // Set Wait_Message of (Wait(Self)) to "Now Processing..."
30897>>>>>    //
30897>>>>>    // Extra Info for button "Info >>"
30897>>>>>    // Send Wait_Details to (Wait(Self)) sFile sDetail bInitData
30897>>>>>    // If sFile<>'' then reads the contents of the file
30897>>>>>    // Else Fills the Edit with the string of sDetail
30897>>>>>    // If bInitData is True then the edit object is cleared first else extra info is appended
30897>>>>>    //
30897>>>>>    // Remarks instead of Progress Bar
30897>>>>>    // Set Button_State of (Wait(Self))     to False
30897>>>>>    // Set BarVisibleState of (Wait(Self))  to 'Remarks' False
30897>>>>>    // Update During Process
30897>>>>>    // Send UpdateWait to (Wait(Self)) 'Remarks'
30897>>>>>
30897>>>>>    //AB-StoreTopEnd
30897>>>>>
30897>>>>>    Set Exit_Application_Local_State to FALSE
30898>>>>>    Set Modal_State to FALSE
30899>>>>>    Set Popup_State to TRUE
30900>>>>>    Set Border_Style to Border_Thick
30901>>>>>    Set Minimize_Icon to FALSE
30902>>>>>    Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
30903>>>>>    Set Size to 138 256
30904>>>>>
30904>>>>>    //AB-DDOStart
30904>>>>>
30904>>>>>
30904>>>>>    //AB-DDOEnd
30904>>>>>
30904>>>>>    Object WaitBar is a ProgressBarSub
30906>>>>>
30906>>>>>        //AB-StoreTopStart
30906>>>>>
30906>>>>>        //AB-StoreTopEnd
30906>>>>>
30906>>>>>        Set Size to 21 243
30907>>>>>        Set Location to 7 4
30908>>>>>
30908>>>>>        //AB-StoreStart
30908>>>>>        Send DoRegSize  self smTopRight
30909>>>>>        //AB-StoreEnd
30909>>>>>
30909>>>>>    End_Object
30910>>>>>
30910>>>>>    Object WaitText is a TextBoxSub
30912>>>>>
30912>>>>>        //AB-StoreTopStart
30912>>>>>
30912>>>>>        //AB-StoreTopEnd
30912>>>>>
30912>>>>>        Set Enabled_State to TRUE
30913>>>>>        Set Label to "Processing"
30914>>>>>        Set FontSize to 4 0
30915>>>>>        Set Size to 10 81
30916>>>>>        Set Location to 36 5
30917>>>>>
30917>>>>>        //AB-StoreStart
30917>>>>>
30917>>>>>        //AB-StoreEnd
30917>>>>>
30917>>>>>    End_Object
30918>>>>>
30918>>>>>    Object bnCancel is a ButtonSub
30920>>>>>
30920>>>>>        //AB-StoreTopStart
30920>>>>>
30920>>>>>        //AB-StoreTopEnd
30920>>>>>
30920>>>>>        Set Default_State to TRUE
30921>>>>>        Set Label to "OK"
30922>>>>>        Set Location to 34 143
30923>>>>>
30923>>>>>        //AB-StoreStart
30923>>>>>
30923>>>>>        Procedure OnClick
30925>>>>>             Send Deactivate to (Wait(Self))
30926>>>>>        End_Procedure
30927>>>>>
30927>>>>>        Send DoRegAlign self amTopRight
30928>>>>>        //AB-StoreEnd
30928>>>>>
30928>>>>>    End_Object
30929>>>>>
30929>>>>>    Object bnDetail is a ButtonSub
30931>>>>>
30931>>>>>        //AB-StoreTopStart
30931>>>>>
30931>>>>>        //AB-StoreTopEnd
30931>>>>>
30931>>>>>        Set Focus_Mode to Pointer_Only
30932>>>>>        Set Label to "Info >>"
30933>>>>>        Set Location to 34 197
30934>>>>>
30934>>>>>        //AB-StoreStart
30934>>>>>
30934>>>>>        Procedure OnClick
30936>>>>>            Delegate Send Show_Details False
30938>>>>>        End_Procedure
30939>>>>>
30939>>>>>        Send DoRegAlign self amTopRight
30940>>>>>        //AB-StoreEnd
30940>>>>>
30940>>>>>    End_Object
30941>>>>>
30941>>>>>    Object LineControlSub1 is a LineControlSub
30943>>>>>
30943>>>>>        //AB-StoreTopStart
30943>>>>>
30943>>>>>        //AB-StoreTopEnd
30943>>>>>
30943>>>>>        Set Size to 2 243
30944>>>>>        Set Location to 54 4
30945>>>>>
30945>>>>>        //AB-StoreStart
30945>>>>>
30945>>>>>        Send DoRegSize  self smTopRight
30946>>>>>        //AB-StoreEnd
30946>>>>>
30946>>>>>    End_Object
30947>>>>>
30947>>>>>    Object WaitEdit is a editSub
30949>>>>>
30949>>>>>        //AB-StoreTopStart
30949>>>>>
30949>>>>>        //AB-StoreTopEnd
30949>>>>>
30949>>>>>        Set Enabled_State to FALSE
30950>>>>>        Set Read_Only_State to TRUE
30951>>>>>        Set Size to 58 243
30952>>>>>        Set Location to 60 4
30953>>>>>        Set Color to clWhite
30954>>>>>
30954>>>>>        //AB-StoreStart
30954>>>>>
30954>>>>>        Send DoRegSize Self amBottomRight
30955>>>>>        Delegate Set Size to 66 256
30957>>>>>
30957>>>>>        //AB-StoreEnd
30957>>>>>
30957>>>>>    End_Object
30958>>>>>
30958>>>>>    Object oTxtAntiBar is a TextBoxSub
30960>>>>>        Set Enabled_State to TRUE
30961>>>>>        Set Visible_State to FALSE
30962>>>>>        Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
30963>>>>>        Set Justification_Mode to (jMode_Center IOR jMode_VCenter)
30964>>>>>        Set Auto_Size_State to FALSE
30965>>>>>        Set FontWeight to 600
30966>>>>>        Set FontSize to 4 0
30967>>>>>        Set Size to 10 209
30968>>>>>        Set Location to 10 4
30969>>>>>        Set TextColor to clNavy
30970>>>>>    End_Object
30971>>>>>
30971>>>>>
30971>>>>>    //AB-StoreStart
30971>>>>>    Property Integer piWaitSize  Public (Size(Self))
30973>>>>>    Property Integer piPrevSize  Public (Size(Self))
30975>>>>>    Property Integer piState     Public False
30977>>>>>
30977>>>>>    Set Locate_Mode to Center_On_Screen
30978>>>>>    Set Destroy_Object_State to True
30979>>>>>
30979>>>>>    Procedure Show_Details Integer bAlways
30981>>>>>        Local Integer liOriSize liSize hiSize hiOriSize lowSize bState
30982>>>>>        Local String sLabel
30982>>>>>        Get Size                to liSize
30983>>>>>        Get piState             to bState
30984>>>>>        Get piWaitSize          to liOriSize
30985>>>>>        Move (Hi(liSize))       to hiSize
30986>>>>>        Move (Low(liSize))      to lowSize
30987>>>>>        Move (Hi(liOriSize))    to hiOriSize
30988>>>>>        If (bAlways) Begin
30990>>>>>            Set piState         to False
30991>>>>>            Move 0              to bState
30992>>>>>        End
30992>>>>>>
30992>>>>>        If bState Begin
30994>>>>>             Set Size to hiOriSize lowSize
30995>>>>>             Set Label of (bnDetail(Self)) to "Info >>"
30996>>>>>        End
30996>>>>>>
30996>>>>>        Else Begin
30997>>>>>             Set Size to 138 lowSize
30998>>>>>             Set Label of (bnDetail(Self)) to "<< Info"
30999>>>>>        End
30999>>>>>>
30999>>>>>        Set piState to (1-bState)
31000>>>>>    End_Procedure
31001>>>>>
31001>>>>>    Procedure Bar_Current_Position Integer iCount Integer iOccurances Integer iMaximum Integer bState
31003>>>>>       If (bState) Begin
31005>>>>>         If (Mod(iCount,(iCount*((Number(iMaximum))/(Number(iOccurances)))))=0) ;            Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
31008>>>>>       End
31008>>>>>>
31008>>>>>       Else Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
31010>>>>>    End_Procedure
31011>>>>>
31011>>>>>    Procedure DoInitialize_WaitBar
31013>>>>>        Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
31014>>>>>    End_Procedure
31015>>>>>
31015>>>>>    Procedure DoTerminate_WaitBar
31017>>>>>        Local Integer iMax
31018>>>>>        Get Maximum_position of (WaitBar(Self)) to iMax
31019>>>>>        Send Bar_Current_Position to (Wait(Self)) iMax iMax Imax False
31020>>>>>    End_Procedure
31021>>>>>
31021>>>>>    Procedure Set Bar_Maximum_Position Integer iMaximum
31023>>>>>         Set Maximum_position of (WaitBar(Self)) to iMaximum
31024>>>>>    End_Procedure
31025>>>>>
31025>>>>>    Function Bar_Maximum_Position Returns Integer
31027>>>>>        Function_Return (Maximum_position(WaitBar(Self)))
31028>>>>>    End_Function
31029>>>>>
31029>>>>>    Procedure Set Bar_Minimum_Position Integer iMinimum
31031>>>>>         Set Minimum_position of (WaitBar(Self)) to iMinimum
31032>>>>>    End_Procedure
31033>>>>>
31033>>>>>    Function Bar_Minimum_Position Returns Integer
31035>>>>>        Function_Return (Minimum_position(WaitBar(Self)))
31036>>>>>    End_Function
31037>>>>>
31037>>>>>    Procedure Set Bar_Step_Value Integer iStep
31039>>>>>         Set Step_Value of (WaitBar(Self)) to iStep
31040>>>>>    End_Procedure
31041>>>>>
31041>>>>>    Function Bar_Step_Value Returns Integer
31043>>>>>        Function_Return (Step_Value(WaitBar(Self)))
31044>>>>>    End_Function
31045>>>>>
31045>>>>>    Procedure Set Wait_Message String sMessage
31047>>>>>        Set Value of (WaitText(Self)) to sMessage
31048>>>>>    End_Procedure
31049>>>>>
31049>>>>>    Procedure Wait_Details String sFile String sDetail Integer bInitData
31051>>>>>        Local Integer liEditId
31052>>>>>        Move (WaitEdit(Self)) to liEditId
31053>>>>>        If bInitData Send Delete_Data to liEditId
31056>>>>>        If sFile ne "" Begin
31058>>>>>           Send Read to liEditId sFile
31059>>>>>           Send Beginning_Of_Data to liEditId
31060>>>>>        End
31060>>>>>>
31060>>>>>        Else Begin
31061>>>>>           Send Insert to liEditId sDetail
31062>>>>>        End
31062>>>>>>
31062>>>>>    End_Procedure
31063>>>>>
31063>>>>>    Procedure OnResize
31065>>>>>        Local Integer liSize liHiSize liPrevSize liHiPrevSize bState liHiLoc liLoc
31066>>>>>        Get Size to liPrevSize
31067>>>>>        Move (Hi(liPrevSize)) to liHiPrevSize
31068>>>>>        Forward Send OnResize
31070>>>>>        Get Location of (WaitEdit(Self)) to liLoc
31071>>>>>        Move (Hi(liLoc)) to liHiLoc
31072>>>>>        Get piState to bState
31073>>>>>        Get Size to liSize
31074>>>>>        Move (Hi(liSize)) to liHiSize
31075>>>>>        If (liHiSize > (liHiLoc +30)) Begin
31077>>>>>            Set Value of (bnDetail(Self)) to "<< Info"
31078>>>>>            If (liHiPrevSize <= (liHiLoc +30)) Set piState to (1-bState)
31081>>>>>        End
31081>>>>>>
31081>>>>>        Else Begin
31082>>>>>            Set Value of (bnDetail(Self)) to "Info >>"
31083>>>>>            If (liHiPrevSize > (liHiLoc +30)) Set piState to (1-bState)
31086>>>>>        End
31086>>>>>>
31086>>>>>    End_Procedure
31087>>>>>
31087>>>>>    Procedure Set Button_State Integer bState
31089>>>>>        If bState Begin
31091>>>>>            Set Caption_Bar to True
31092>>>>>            Set Size to 66 256
31093>>>>>        End
31093>>>>>>
31093>>>>>        Else Begin
31094>>>>>            Set Caption_Bar to False
31095>>>>>            Set Size to 38 256
31096>>>>>        End
31096>>>>>>
31096>>>>>    End_Procedure
31097>>>>>
31097>>>>>    Procedure Set BarVisibleState String sMsg Integer bState
31099>>>>>        Set Visible_State of (oTxtAntiBar(Self)) to (bState = 0)
31100>>>>>        Set Visible_State of (WaitBar(Self))     to (bState = 1)
31101>>>>>        If (bState = 0) Begin
31103>>>>>            Set Size to 24 256
31104>>>>>            Set Location of (oTxtAntiBar(Self)) to 6 5
31105>>>>>        End
31105>>>>>>
31105>>>>>        If sMsg ne "" Set Value of (oTxtAntiBar(Self)) to sMsg
31108>>>>>    End_Procedure
31109>>>>>
31109>>>>>    Procedure Deactivating integer search_mode Returns Integer
31111>>>>>        local integer rval
31112>>>>>        Forward Get MSG_Deactivating search_mode to rval
31114>>>>>        Set Modal_State of (Wait(Self)) to False
31115>>>>>        Set BarVisibleState of (Wait(Self)) to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..." True
31116>>>>>        Procedure_Return rval
31117>>>>>    End_Procedure
31118>>>>>
31118>>>>>    Procedure UpdateWait String sMsg
31120>>>>>        Set Value of (oTxtAntiBar(Self)) to sMsg
31121>>>>>    End_Procedure
31122>>>>>
31122>>>>>
31122>>>>>    Procedure Set Horizontal_Justification Integer aiMode
31124>>>>>        Set Justification_Mode of oTxtAntiBar to (jMode_VCenter IOR aiMode)
31125>>>>>    End_Procedure
31126>>>>>
31126>>>>>
31126>>>>>
31126>>>>>
31126>>>>>
31126>>>>>
31126>>>>>    //AB-StoreEnd
31126>>>>>
31126>>>>>End_Object
31127>>>>>
31127>>>>>
31127>>>>>//AB-StoreStart
31127>>>>>
31127>>>>>//AB-StoreEnd
31127>>>>>
31127>>>>>//AB/ End_Object    // prj
31127>>>
31127>Use Calendar.sl
INCLUDING FILE: CALENDAR.SL
31127>>>//AB/ Project Calendar
31127>>>//AB/ Object prj is a Lookup_Project
31127>>>//AB/     Set ProjectName to "Calendar"
31127>>>//AB/     Set ProjectFileName to "Calendar.sl"
31127>>>
31127>>>// Project Object Structure
31127>>>//   oCalendar is a dbModalPanel
31127>>>//     Container3d1 is a Container3d
31127>>>//       Grid2 is a Grid
31127>>>//       Textbox2 is a Textbox
31127>>>//       Textbox3 is a Textbox
31127>>>//       Textbox4 is a Textbox
31127>>>//       Textbox5 is a Textbox
31127>>>//       Textbox6 is a Textbox
31127>>>//       Textbox7 is a Textbox
31127>>>//       Textbox8 is a Textbox
31127>>>//       LineControl1 is a LineControl
31127>>>//       Container3d2 is a Container3d
31127>>>//         oRght is a BitmapContainer
31127>>>//         oLeft is a BitmapContainer
31127>>>//         oMonth is a Textbox
31127>>>//           oSelectMonth is a FloatingPopupMenu
31127>>>//         oYear is a Textbox
31127>>>//         oSelectYear is a Form
31127>>>//     BitmapContainer3 is a BitmapContainer
31127>>>//     oToday is a Textbox
31127>>>
31127>>>// Register all objects
31127>>>Register_Object BitmapContainer3
31127>>>Register_Object Container3d1
31127>>>Register_Object Container3d2
31127>>>Register_Object Grid2
31127>>>Register_Object LineControl1
31127>>>Register_Object oCalendar
31127>>>Register_Object oLeft
31127>>>Register_Object oMonth
31127>>>Register_Object oRght
31127>>>Register_Object oSelectMonth
31127>>>Register_Object oSelectYear
31127>>>Register_Object oToday
31127>>>Register_Object oYear
31127>>>Register_Object Textbox2
31127>>>Register_Object Textbox3
31127>>>Register_Object Textbox4
31127>>>Register_Object Textbox5
31127>>>Register_Object Textbox6
31127>>>Register_Object Textbox7
31127>>>Register_Object Textbox8
31127>>>
31127>>>
31127>>>
31127>>>//AB-StoreTopStart
31127>>>Use dates.utl
INCLUDING FILE: DATES.UTL
31127>>>>>// **********************************************************************
31127>>>>>// Use Dates.utl    // Date manipulation for VDF and DF3.1
31127>>>>>//
31127>>>>>// by Sture Andersen (sa1@vd.dk)
31127>>>>>//
31127>>>>>// The file contains a number of global functions for manipulating
31127>>>>>// dates. The package may be used with DataFlex 3.1 and Visual DataFlex.
31127>>>>>// This package is public domain.
31127>>>>>//
31127>>>>>// The package file is accompanied by a Word document (dfutil.doc)
31127>>>>>// listing the functions and their use.
31127>>>>>//
31127>>>>>//
31127>>>>>// Create: Fri  06-06-1997 - Merger of s_utl020, 021, 022, 023, 024, 025.
31127>>>>>// Update: Thu  26-06-1997 - Fixes for strange behavior when date4_state is set.
31127>>>>>//                         - Addition of popup_calendar to VDF.
31127>>>>>//         Sun  29-06-1997 - Character mode popup calender.
31127>>>>>//         Fri  04-07-1997 - Function WeekToDate added.
31127>>>>>//         Thu  10-07-1997 - Fixes.
31127>>>>>//         Mon  11-08-1997 - WeekToDate fixed.
31127>>>>>//         Sun  24-08-1997 - Character mode popup calender finished.
31127>>>>>//         Mon  15-12-1997 - Procedure Request_Popup_Calendar added.
31127>>>>>//         Mon  29-12-1997 - Procedures ItemYear2to4, ItemDate2to4 and
31127>>>>>//                           ItemSysdate added.
31127>>>>>//         Mon  29-12-1997 - Procedures FieldYear2to4, FieldDate2to4 and
31127>>>>>//                           FieldSysdate added.
31127>>>>>//         Sun  01-02-1998 - Functions Module_Compile_Date and
31127>>>>>//                           Module_Compile_Time added.
31127>>>>>//         Wed  25-02-1998 - Request_Popup in calendar object now only
31127>>>>>//                           responds if entry_state of the calling object
31127>>>>>//                           is true (VDF version). (No apparent effect)
31127>>>>>//         Sat  28-03-1998 - Added the following functions:
31127>>>>>//                             TS_SysTime      TS_ExtractDate
31127>>>>>//                             TS_ExtractTime  TS_ConvertToString
31127>>>>>//         Tue  26-05-1998 - Procedure TS_UI_Update added
31127>>>>>//         Sat  01-08-1998 - mask_date_window taken into account
31127>>>>>//         Mon  10-08-1998 - Functions Module_Start_Date and
31127>>>>>//                           Module_Start_Time added.
31127>>>>>//         Wed  02-09-1998 - Parameter for Module_Start_Date removed
31127>>>>>//         Mon  12-10-1998 - Portuguese added
31127>>>>>//         Wed  04-11-1998 - TS_TimeEstimator class added
31127>>>>>//         Tue  29-12-1998 - Function DateAsString added
31127>>>>>//         Wed  13-01-1999 - Function DateWeekNumber changed according to
31127>>>>>//                           Kjetil Johanson
31127>>>>>//         Mon  18-01-1999 - Function DateWeekNumber changed according to
31127>>>>>//                           Kjetil Johanson (again)
31127>>>>>//         Tue  19-01-1999 - Changed procedure names in TS_TimeEstimator
31127>>>>>//                           class (Continue->TS_Continue and Pause->
31127>>>>>//                           TS_Pause)
31127>>>>>//         Thu  21-01-1999 - Procedures DateFormatAsString and DateFormatName
31127>>>>>//                           added.
31127>>>>>//                         - Procedures DateCurrentSeparator and
31127>>>>>//                           DateCurrentFormat added.
31127>>>>>//         Tue  13-04-1999 - Julian constants added: Jan1st1900, Jan1st2000
31127>>>>>//                           Jan1st1000 and Jan1st100
31127>>>>>//         Mon  26-04-1999 - Changed procedure FieldYear2to4 and ItemYear2to4
31127>>>>>//                           to trap 3 digit years.
31127>>>>>//         Wed  27-04-1999 - Changed Dutch abbriviated day names (to 2 characters)
31127>>>>>//         Sun  02-05-1999 - Added function TS_Compose2
31127>>>>>//                         - Fixed error in TS_ConvertToString
31127>>>>>//         Tue  01-06-1999 - Added procedure popup_no_export to calendar.
31127>>>>>//         Thu  15-06-1999 - Fixed Date4to2 function and exporting dates
31127>>>>>//                           from the calendar to forms with no form_margin.
31127>>>>>//         Tue  07-09-1999 - Added function DateAsText
31127>>>>>//         Wed  27-10-1999 - Temporary fix for Module_Compile_Date function
31127>>>>>//                           in combination with y2k.
31127>>>>>//         Wed  19-12-1999 - Function StringToDate added.
31127>>>>>//                         - Existing function DateAsString renamed to
31127>>>>>//                           DateToString.
31127>>>>>//         Mon  03-01-2000 - Fix for VDF4. Popup calendar on empty date field
31127>>>>>//                           would result in seeding the calendar on year 100.
31127>>>>>//                           This error was caused by the fact that VDF 4
31127>>>>>//                           ignores SYSDATE4_STATE such that the sysdate
31127>>>>>//                           command returns 03-01-100
31127>>>>>//         Wed  01-02-2000 - Define instead of #REPLACE
31127>>>>>//         Wed  23-08-2000 - Function TS_Module_Compile_Time added
31127>>>>>//
31127>>>>>// NOTE:  There is language dependent string constants in this file.
31127>>>>>//        Currently there are sections for dutch, english, danish, swedish,
31127>>>>>//        norwegian, spanish, german and portuguese
31127>>>>>//
31127>>>>>//        These sections may be identified by searching the symbol LNG_DEFAULT
31127>>>>>//
31127>>>>>// ***********************************************************************
31127>>>>>
31127>>>>>Use ui
31127>>>>>Use Language    // Set default languange if not set by compiler command line
INCLUDING FILE: LANGUAGE.PKG
31127>>>>>>>// Use Language     // Default language setup
31127>>>>>>>// Sets default languange if not set by compiler command line
31127>>>>>>>
31127>>>>>>>define lng_dutch      for 131
31127>>>>>>>define lng_french     for 133 // NOT TRANSLATED. DO NOT SELECT!
31127>>>>>>>define lng_spanish    for 134
31127>>>>>>>define lng_italian    for 139 // NOT TRANSLATED. DO NOT SELECT!
31127>>>>>>>define lng_english    for 144
31127>>>>>>>define lng_danish     for 145
31127>>>>>>>define lng_swedish    for 146
31127>>>>>>>define lng_norwegian  for 147
31127>>>>>>>define lng_Greek    for 148
31127>>>>>>>define lng_german     for 149
31127>>>>>>>define lng_portuguese for 155
31127>>>>>>>define lng_papiamentu for 199 // NOT TRANSLATED. DO NOT SELECT!
31127>>>>>>>
31127>>>>>>>
31127>>>>>>>define lng_default for !@
31127>>>>>>>
31127>>>>>>>  define _LANGUAGE_ for $ENGLISH$
31127>>>>>>>
#REM LANGUAGE SET BY LANGUAGE.PKG: $ENGLISH$
31127>>>>>Use Seq_Chnl    // Defines global sequential device management operations (DAC)
31127>>>>>Use Macros.utl  // Various macros (DESKTOP_SECTION)
INCLUDING FILE: MACROS.UTL
31127>>>>>>>// Use Macros.utl   // Various macros (FOR_EX...)
31127>>>>>>>
31127>>>>>>>//  FOR_EX (extended FOR command)
31127>>>>>>>//  -----------------------------
31127>>>>>>>//> The FOR_EX command is exactly like the standard FOR command except
31127>>>>>>>//> that it will allow you to use keyword "DOWN_TO" instead of "TO" if
31127>>>>>>>//> you need to do a decremental loop.
31127>>>>>>>
31127>>>>>>>
31127>>>>>>>//  DESKTOP_SECTION
31127>>>>>>>//  ---------------
31127>>>>>>>//> The DESKTOP_SECTION/END_DESKTOP_SECTION commands will make a sequence of
31127>>>>>>>//> code compile (or rather instantiate) as if it was situated on the DESKTOP
31127>>>>>>>//> even when it isn't. DESKTOP_SECTION's may not be nested.
31127>>>>>>>
31127>>>>>>>
31127>>>>>>>
31127>>>>>
31127>>>>>// Switches
31127>>>>>
31127>>>>>define DATES_INCLUDE_POPUP for 1   // If set to 0 the popup calendar will not be included
31127>>>>>define DATES_DF31B_EPOCH   for 40  // DF3.1b didn't have an epoch setting. Therefore this symbol defines the epoch value for that version.
31127>>>>>
31127>>>>> define t.calendar.year           for "Year"
31127>>>>> define t.calendar.month          for "Month"
31127>>>>> define t.calendar.day            for "Day"
31127>>>>> define t.calendar.week           for "Wk."
31127>>>>> define t.calendar.calendar_popup for "Calendar Popup"
31127>>>>> define t.calendar.Monday         for "Monday"
31127>>>>> define t.calendar.Tuesday        for "Tuesday"
31127>>>>> define t.calendar.Wednesday      for "Wednesday"
31127>>>>> define t.calendar.Thursday       for "Thursday"
31127>>>>> define t.calendar.Friday         for "Friday"
31127>>>>> define t.calendar.Saturday       for "Saturday"
31127>>>>> define t.calendar.Sunday         for "Sunday"
31127>>>>> define t.calendar.January        for "January"
31127>>>>> define t.calendar.February       for "February"
31127>>>>> define t.calendar.March          for "March"
31127>>>>> define t.calendar.April          for "April"
31127>>>>> define t.calendar.May            for "May"
31127>>>>> define t.calendar.June           for "June"
31127>>>>> define t.calendar.July           for "July"
31127>>>>> define t.calendar.August         for "August"
31127>>>>> define t.calendar.September      for "September"
31127>>>>> define t.calendar.October        for "October"
31127>>>>> define t.calendar.November       for "November"
31127>>>>> define t.calendar.December       for "December"
31127>>>>> define t.calendar.ok             for "OK"
31127>>>>> define t.calendar.Cancel         for "Cancel"
31127>>>>> define t.calendar.Activate       for "Activate popup calendar (Ctrl+D)"
31127>>>>>
31127>>>>>define LargestPossibleDate for 913490 // December 31st 2500
31127>>>>>define Jan1st1900          for 693975
31127>>>>>define Jan1st2000          for 730500
31127>>>>>define Jan1st1000          for 365250
31127>>>>>define Jan1st105           for 38352
31127>>>>>define Jan1st100           for 36525
31127>>>>>
31127>>>>>enumeration_list // Date Segments
31127>>>>>  define DS_DAY
31127>>>>>  define DS_WEEK
31127>>>>>  define DS_MONTH
31127>>>>>  define DS_YEAR
31127>>>>>end_enumeration_list
31127>>>>>
31127>>>>>integer Dates$Year Dates$Month Dates$Day // internal use
31127>>>>>
31127>>>>>procedure DateDecompose global date date# //very internal!!
31128>>>>>  local integer pos1# pos2# format#
31129>>>>>  local string str# sep#
31129>>>>>  get_attribute DF_DATE_FORMAT to format#
31132>>>>>  get_attribute DF_DATE_SEPARATOR to pos1# // overload
31135>>>>>  character pos1# to sep#                  // end overload
31136>>>>>>
31136>>>>>  move date# to str#
31137>>>>>  replace sep# in str# with "$"
31139>>>>>  move strmark to pos1#
31140>>>>>  if [found] begin
31142>>>>>    replace sep# in str# with "$"
31144>>>>>    move strmark to pos2#
31145>>>>>  end
31145>>>>>>
31145>>>>>  else begin
31146>>>>>    move 0 to Dates$Year
31147>>>>>    move 0 to Dates$Month
31148>>>>>    move 0 to Dates$Day
31149>>>>>  end
31149>>>>>>
31149>>>>>  [ found] begin
31151>>>>>>
31151>>>>>    if format# eq DF_DATE_EUROPEAN ;          left str# to Dates$Day    (pos1#-1)
31155>>>>>    if format# eq DF_DATE_USA begin
31157>>>>>          mid  str# to Dates$Day    (pos2#-pos1#-1) (pos1#+1)
31160>>>>>>
31160>>>>>          left str# to Dates$Month  (pos1#-1)
31162>>>>>>
31162>>>>>    end
31162>>>>>>
31162>>>>>    else  mid  str# to Dates$Month  (pos2#-pos1#-1) (pos1#+1)
31166>>>>>
31166>>>>>    if format# eq DF_DATE_MILITARY begin
31168>>>>>          mid  str# to Dates$Day  2 (pos2#+1)
31171>>>>>>
31171>>>>>          left str# to Dates$Year   (pos1#-1)
31173>>>>>>
31173>>>>>    end
31173>>>>>>
31173>>>>>    else  mid  str# to Dates$Year 4 (pos2#+1)
31177>>>>>  end
31177>>>>>>
31177>>>>>end_procedure
31178>>>>>
31178>>>>>function DateCompose global integer day# integer month# integer year# returns date
31179>>>>>  local integer format#
31180>>>>>  local date date#
31180>>>>>  local string sep#
31180>>>>>  ifnot (day#*month#*year#) function_return 0
31183>>>>>  get_attribute DF_DATE_SEPARATOR to format# // overload
31186>>>>>  character format# to sep#                  // end overload
31187>>>>>>
31187>>>>>  get_attribute DF_DATE_FORMAT to format#
31190>>>>>  if day# gt 28 begin
31192>>>>>    if format# eq DF_DATE_EUROPEAN move (date(string(day#)+sep#+string(month#)+sep#+string(year#))) to date# // DMY
31195>>>>>    if format# eq DF_DATE_USA      move (date(string(month#)+sep#+string(day#)+sep#+string(year#))) to date# // MDY
31198>>>>>    if format# eq DF_DATE_MILITARY move (date(string(year#)+sep#+string(month#)+sep#+string(day#))) to date# // YMD
31201>>>>>    send DateDecompose date#
31202>>>>>    if Dates$Month ne month# move (day#-Dates$Day) to day#
31205>>>>>  end
31205>>>>>>
31205>>>>>  if format# eq DF_DATE_EUROPEAN function_return (date(string(day#)+sep#+string(month#)+sep#+string(year#))) // DMY
31208>>>>>  if format# eq DF_DATE_USA function_return (date(string(month#)+sep#+string(day#)+sep#+string(year#))) // MDY
31211>>>>>  function_return (date(string(year#)+sep#+string(month#)+sep#+string(day#))) // YMD
31212>>>>>end_function
31213>>>>>
31213>>>>>function DateFormatName global integer format# returns string
31214>>>>>  if format# eq DF_DATE_EUROPEAN function_return "European"
31217>>>>>  if format# eq DF_DATE_USA      function_return "United States"
31220>>>>>  if format# eq DF_DATE_MILITARY function_return "Military"
31223>>>>>end_function
31224>>>>>
31224>>>>>function DateCurrentSeparator global returns string
31225>>>>>  local integer rval#
31226>>>>>  get_attribute DF_DATE_SEPARATOR to rval#
31229>>>>>  function_return (character(rval#))
31230>>>>>end_function
31231>>>>>
31231>>>>>function DateCurrentFormat global returns integer
31232>>>>>  local integer rval#
31233>>>>>  get_attribute DF_DATE_FORMAT to rval#
31236>>>>>  function_return rval#
31237>>>>>end_function
31238>>>>>
31238>>>>>function DateFormatAsString global integer format# integer long# string sep# returns string
31239>>>>>  local string rval# letter#
31240>>>>>  if format# eq DF_DATE_EUROPEAN move "3342241111" to rval#
31243>>>>>  if format# eq DF_DATE_USA      move "2243341111" to rval#
31246>>>>>  if format# eq DF_DATE_MILITARY move "1111422433" to rval#
31249>>>>>  left t.calendar.year to letter# 1
31251>>>>>>
31251>>>>>  replace "1" in rval# with letter#
31253>>>>>  replace "1" in rval# with letter#
31255>>>>>  ifnot long# move "" to letter#
31258>>>>>  move (replaces("1",rval#,letter#)) to rval#
31259>>>>>  move (replaces("2",rval#,left(t.calendar.month,1))) to rval#
31260>>>>>  move (replaces("3",rval#,left(t.calendar.day,1))) to rval#
31261>>>>>  if sep# eq "" begin
31263>>>>>    get_attribute DF_DATE_SEPARATOR to format#
31266>>>>>    character format# to sep#
31267>>>>>>
31267>>>>>  end
31267>>>>>>
31267>>>>>  move (replaces("4",rval#,sep#)) to rval#
31268>>>>>  function_return rval#
31269>>>>>end_function
31270>>>>>
31270>>>>>function StringToDate global string date# integer format# integer four_digit_year# string sep# returns date
31271>>>>>  local integer sep_len# day# month# year#
31272>>>>>  move (length(sep#)) to sep_len#
31273>>>>>  if four_digit_year# move 4 to four_digit_year#
31276>>>>>  else move 2 to four_digit_year#
31278>>>>>  if format# eq DF_DATE_EUROPEAN begin // DMY
31280>>>>>    move (mid(date#,2,1)) to day#
31281>>>>>    move (mid(date#,2,3+sep_len#)) to month#
31282>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31283>>>>>  end
31283>>>>>>
31283>>>>>  if format# eq DF_DATE_USA begin // MDY
31285>>>>>    move (mid(date#,2,1)) to month#
31286>>>>>    move (mid(date#,2,3+sep_len#)) to year#
31287>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31288>>>>>  end
31288>>>>>>
31288>>>>>  if format# eq DF_DATE_MILITARY begin // YMD
31290>>>>>    move (mid(date#,four_digit_year#,1)) to year#
31291>>>>>    move (mid(date#,2,1+four_digit_year#+sep_len#)) to month#
31292>>>>>    move (mid(date#,2,3+four_digit_year#+sep_len#+sep_len#)) to day#
31293>>>>>  end
31293>>>>>>
31293>>>>>  function_return (DateCompose(day#,month#,year#))
31294>>>>>end_function
31295>>>>>
31295>>>>>function DateToString global date date# integer format# integer four_digit_year# string sep# returns string
31296>>>>>  local string rval# day# month# year#
31297>>>>>  get Date2to4 date# to date#
31298>>>>>  if (integer(date#)) begin
31300>>>>>    send DateDecompose date#
31301>>>>>    move Dates$Day to day#
31302>>>>>    if Dates$Day lt 10 insert "0" in day# at 1
31306>>>>>    move Dates$Month to month#
31307>>>>>    if Dates$Month lt 10 insert "0" in month# at 1
31311>>>>>    move Dates$Year to year#
31312>>>>>    ifnot four_digit_year# move (right(year#,2)) to year#
31315>>>>>    if format# eq DF_DATE_EUROPEAN move (day#+sep#+month#+sep#+year#) to rval# // DMY
31318>>>>>    if format# eq DF_DATE_USA      move (month#+sep#+day#+sep#+year#) to rval# // MDY
31321>>>>>    if format# eq DF_DATE_MILITARY move (year#+sep#+month#+sep#+day#) to rval# // YMD
31324>>>>>  end
31324>>>>>>
31324>>>>>  function_return rval#
31325>>>>>end_function
31326>>>>>
31326>>>>>// Function DateAsString is only here for compatibility with earlier versions.
31326>>>>>// Use function DateToString instead.
31326>>>>>function DateAsString global date date# integer format# integer four_digit_year# string sep# returns string
31327>>>>>  function_return (DateToString(date#,format#,four_digit_year#,sep#))
31328>>>>>end_function
31329>>>>>
31329>>>>>function DateIncrement global date date# integer segment# integer amount# returns date
31330>>>>>  if (date#=0) function_return 0
31333>>>>>  if segment# eq DS_WEEK function_return (date#+(amount#*7)) //weeks
31336>>>>>  if (segment#<>DS_DAY) begin // months or years
31338>>>>>    send DateDecompose date#
31339>>>>>    if segment# eq DS_MONTH begin //months
31341>>>>>      move (Dates$Month+amount#) to Dates$Month
31342>>>>>      if amount# ge 0 function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-1)/12)*12),Dates$Year+((Dates$Month-1)/12)))
31345>>>>>      function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-12)/12)*12),Dates$Year+((Dates$Month-12)/12)))
31346>>>>>    end //years:
31346>>>>>>
31346>>>>>    if segment# eq DS_YEAR function_return (DateCompose(Dates$Day,Dates$Month,Dates$Year+amount#))
31349>>>>>  end
31349>>>>>>
31349>>>>>  else function_return (date#+amount#) //days
31351>>>>>end_function
31352>>>>>
31352>>>>>function DateSegment global date date# integer segment# returns integer
31353>>>>>  send DateDecompose date#
31354>>>>>  if segment# eq DS_DAY   function_return Dates$Day
31357>>>>>  if segment# eq DS_MONTH function_return Dates$Month
31360>>>>>  if segment# eq DS_YEAR  function_return Dates$Year
31363>>>>>end_function
31364>>>>>
31364>>>>>function DateToInteger global date date# returns integer
31365>>>>>  send DateDecompose date#
31366>>>>>  function_return (Dates$Year*100+Dates$Month*100+Dates$Day)
31367>>>>>end_function
31368>>>>>
31368>>>>>function FirstDayInMonth global date date# returns date
31369>>>>>  local integer month# year#
31370>>>>>  move (DateSegment(date#,DS_MONTH)) to month#
31371>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31372>>>>>  function_return (DateCompose(1,month#,year#))
31373>>>>>end_function
31374>>>>>
31374>>>>>function LastDayInMonth global date date# returns date
31375>>>>>  move (DateIncrement(date#,DS_MONTH,1)) to date#
31376>>>>>  function_return (FirstDayInMonth(date#)-1)
31377>>>>>end_function
31378>>>>>
31378>>>>>function FirstDayInYear global date date# returns date
31379>>>>>  local integer year#
31380>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31381>>>>>  function_return (DateCompose(1,1,year#))
31382>>>>>end_function
31383>>>>>
31383>>>>>function LastDayInYear global date date# returns date
31384>>>>>  move (DateIncrement(date#,DS_YEAR,1)) to date#
31385>>>>>  function_return (FirstDayInYear(date#)-1)
31386>>>>>end_function
31387>>>>>
31387>>>>>// Prior to 18/1-99 version of DateWeekNumber
31387>>>>>//function DateWeekNumber global date date# returns integer
31387>>>>>//  local integer week# first_wd# day_of_year# year#
31387>>>>>//  if (date#=0) function_return 0
31387>>>>>//  get Date2to4 date# to date#
31387>>>>>//  move (DateSegment(date#,DS_YEAR)) to year#
31387>>>>>//  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31387>>>>>//  move (date#-FirstDayInYear(date#)) to day_of_year#
31387>>>>>//  move (day_of_year#-1-7+first_wd#) to day_of_year#
31387>>>>>//  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31387>>>>>//  else move 0 to week#
31387>>>>>//  if first_wd# le 4 increment week#
31387>>>>>//  if week# gt 52 begin
31387>>>>>//    move 1 to week#
31387>>>>>//    if first_wd# eq 4 move 53 to week#
31387>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31387>>>>>//  end
31387>>>>>//  if week# eq 0 begin
31387>>>>>//    //get DateWeekNumber (DateIncrement(date#,DS_YEAR,-1)) to first_wd# // Original line
31387>>>>>//    get DateDayNumber  (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#ÿ // changed line
31387>>>>>//    move 52 to week#
31387>>>>>//    if first_wd# eq 4 move 53 to week#
31387>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31387>>>>>//  end
31387>>>>>//  function_return week#
31387>>>>>//end_function
31387>>>>>
31387>>>>>function DateWeekNumber global date date# returns integer
31388>>>>>  local integer week# first_wd# day_of_year# year# wd#
31389>>>>>  if (date#=0) function_return 0
31392>>>>>  get Date2to4 date# to date#
31393>>>>>  // Leap-year test for actual or previous year
31393>>>>>  // Year# only used for selection between 52 and
31393>>>>>  // Therefore get year# from the first day of actual week
31393>>>>>  get DateDayNumber date# to wd#
31394>>>>>  move (DateSegment(date#-wd#+1,DS_YEAR)) to year#
31395>>>>>
31395>>>>>  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31396>>>>>  move (date#-FirstDayInYear(date#)) to day_of_year#
31397>>>>>  move (day_of_year#-1-7+first_wd#) to day_of_year#
31398>>>>>  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31401>>>>>  else move 0 to week#
31403>>>>>  if first_wd# le 4 increment week#
31406>>>>>  if week# gt 52 begin
31408>>>>>    move 1 to week#
31409>>>>>    if first_wd# eq 4 move 53 to week#
31412>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31419>>>>>  end
31419>>>>>>
31419>>>>>  if week# eq 0 begin
31421>>>>>    // Week 52 or 53
31421>>>>>    get DateDayNumber (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#
31422>>>>>    move 52 to week#
31423>>>>>    if first_wd# eq 4 move 53 to week#
31426>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31433>>>>>  end
31433>>>>>>
31433>>>>>  function_return week#
31434>>>>>end_function
31435>>>>>
31435>>>>>function DayName global integer int# returns string
31436>>>>>  if int# eq 1 function_return t.calendar.Monday
31439>>>>>  if int# eq 2 function_return t.calendar.Tuesday
31442>>>>>  if int# eq 3 function_return t.calendar.Wednesday
31445>>>>>  if int# eq 4 function_return t.calendar.Thursday
31448>>>>>  if int# eq 5 function_return t.calendar.Friday
31451>>>>>  if int# eq 6 function_return t.calendar.Saturday
31454>>>>>  if int# eq 7 function_return t.calendar.Sunday
31457>>>>>  function_return ""
31458>>>>>end_function
31459>>>>>
31459>>>>>function DateDayNumber global date date# returns integer
31460>>>>>  local integer rval# // 1=Monday, ... , 7=Sunday
31461>>>>>  get Date2to4 date# to date#
31462>>>>>  move date# to rval#
31463>>>>>  if rval# begin
31465>>>>>    if rval# gt 693975 move (rval#-2) to rval#
31468>>>>>    move (rval#-((rval#/7)*7)) to rval#
31469>>>>>    if rval# eq 0 move 7 to rval#
31472>>>>>  end
31472>>>>>>
31472>>>>>  function_return rval#
31473>>>>>end_function
31474>>>>>
31474>>>>>function DateDayName global date date# returns string
31475>>>>>  function_return (DayName(DateDayNumber(date#)))
31476>>>>>end_function
31477>>>>>
31477>>>>>function YearMaxWeek global integer year# returns integer
31478>>>>>  local integer wk1# wk2#
31479>>>>>  get DateWeekNumber (DateCompose(31,12,year#)) to wk1#
31480>>>>>  get DateWeekNumber (DateCompose(24,12,year#)) to wk2#
31481>>>>>  function_return (wk1# max wk2#)
31482>>>>>end_function
31483>>>>>
31483>>>>>function WeekToDate global integer year# integer week# returns date
31484>>>>>  local date date#
31485>>>>>  move (DateCompose(1,1,year#)) to date#
31486>>>>>  if (DateWeekNumber(date#)) ne 1 move (date#+7) to date# // week 52 or 53
31489>>>>>  move (date#-DateDayNumber(date#)+1) to date# // Now it's a Monday
31490>>>>>  function_return (week#-1*7+date#)
31491>>>>>end_function
31492>>>>>
31492>>>>>function MonthName global integer int# returns string
31493>>>>>  if int# eq  1 function_return t.calendar.January
31496>>>>>  if int# eq  2 function_return t.calendar.February
31499>>>>>  if int# eq  3 function_return t.calendar.March
31502>>>>>  if int# eq  4 function_return t.calendar.April
31505>>>>>  if int# eq  5 function_return t.calendar.May
31508>>>>>  if int# eq  6 function_return t.calendar.June
31511>>>>>  if int# eq  7 function_return t.calendar.July
31514>>>>>  if int# eq  8 function_return t.calendar.August
31517>>>>>  if int# eq  9 function_return t.calendar.September
31520>>>>>  if int# eq 10 function_return t.calendar.October
31523>>>>>  if int# eq 11 function_return t.calendar.November
31526>>>>>  if int# eq 12 function_return t.calendar.December
31529>>>>>  function_return ""
31530>>>>>end_function
31531>>>>>
31531>>>>>function DateMonthName global date date# returns string
31532>>>>>  function_return (MonthName(DateSegment(date#,DS_MONTH)))
31533>>>>>end_function
31534>>>>>
31534>>>>>function DateAsText global date date# string format# returns string
31535>>>>>  if date# eq 0 function_return ""
31538>>>>>  move (replace("#DN",format#,DateDayName(date#)))                  to format#
31539>>>>>  move (replace("#MN",format#,DateMonthName(date#)))                to format#
31540>>>>>  move (replace("#D" ,format#,string(DateSegment(date#,DS_DAY))))   to format#
31541>>>>>  move (replace("#Y" ,format#,string(DateSegment(date#,DS_YEAR))))  to format#
31542>>>>>  move (replace("#M" ,format#,string(DateSegment(date#,DS_MONTH)))) to format#
31543>>>>>  function_return format#
31544>>>>>end_function
31545>>>>>
31545>>>>>function Year2to4 global integer year# returns integer
31546>>>>>  local integer epoch_value#
31547>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31548>>>>>  if year# lt 100 begin
31550>>>>>    if year# gt epoch_value# function_return (year#+1900)
31553>>>>>    function_return (year#+2000)
31554>>>>>  end
31554>>>>>>
31554>>>>>  function_return year# // No conversion done!
31555>>>>>end_function
31556>>>>>
31556>>>>>function Date2to4 global date date# returns date
31557>>>>>  local integer epoch_value#
31558>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31559>>>>>  if date# gt 0 begin // Only if there is a date to convert
31561>>>>>    if (DateSegment(date#,DS_YEAR)) lt 105 begin
31563>>>>>      if Dates$Year gt epoch_value# function_return (DateIncrement(date#,DS_YEAR,1900))
31566>>>>>      function_return (DateIncrement(date#,DS_YEAR,2000))
31567>>>>>    end
31567>>>>>>
31567>>>>>    function_return date# // No conversion done!
31568>>>>>  end
31568>>>>>>
31568>>>>>end_function
31569>>>>>
31569>>>>>function Date4to2 global date date# returns date
31570>>>>>  local integer epoch_value# year#
31571>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31572>>>>>  if date# gt 0 begin // Only if there is a date to convert
31574>>>>>    move (DateSegment(date#,DS_YEAR)) to year#
31575>>>>>    if year# ge 100 begin // Only then conversion is needed!
31577>>>>>      if (year#>=(1900+epoch_value#) and year#<(2000+epoch_value#)) begin
31579>>>>>        if year# lt 2000 function_return (DateIncrement(date#,DS_YEAR,-1900))
31582>>>>>        else             function_return (DateIncrement(date#,DS_YEAR,-2000))
31584>>>>>      end
31584>>>>>>
31584>>>>>      else error 301 "Date is out of epoch range"
31586>>>>>    end
31586>>>>>>
31586>>>>>  end
31586>>>>>>
31586>>>>>  function_return date# // No conversion done!
31587>>>>>end_function
31588>>>>>
31588>>>>>function dSysDate global returns date
31589>>>>>  local date date#
31590>>>>>  sysdate4 date#
31591>>>>>  function_return date#
31592>>>>>end_function
31593>>>>>
31593>>>>>function iSysYear global returns integer
31594>>>>>  local date date#
31595>>>>>  sysdate4 date#
31596>>>>>  function_return (DateSegment(date#,DS_YEAR))
31597>>>>>end_function
31598>>>>>
31598>>>>>procedure ItemSysdate for desktop integer itm#
31599>>>>>  local date date#
31600>>>>>  get value item itm# to date#
31601>>>>>  if date# eq 0 begin
31603>>>>>    sysdate4 date#
31604>>>>>    set changed_value item itm# to date#
31605>>>>>  end
31605>>>>>>
31605>>>>>end_procedure
31606>>>>>
31606>>>>>procedure ItemDate2to4 for desktop integer itm#
31607>>>>>  local integer year#
31608>>>>>  local date date# new_date#
31608>>>>>  get value item itm# to date#
31609>>>>>
31609>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31610>>>>>  if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31613>>>>>  else move date# to new_date#
31615>>>>>
31615>>>>>  move (Date2to4(new_date#)) to new_date#
31616>>>>>  move (DateSegment(new_date#,3)) to year#
31617>>>>>  if (year#>99 and year#<1000) begin
31619>>>>>    error 15 // Illegal entry in this window
31620>>>>>>
31620>>>>>    procedure_return 1
31621>>>>>  end
31621>>>>>>
31621>>>>>  if new_date# ne date# set value item itm# to new_date#
31624>>>>>end_procedure
31625>>>>>
31625>>>>>procedure ItemYear2to4 for desktop integer itm#
31626>>>>>  local integer year# new_year#
31627>>>>>  get value item itm# to year#
31628>>>>>  if (year#>99 and year#<1000) begin
31630>>>>>    error 15 // Illegal entry in this window
31631>>>>>>
31631>>>>>    procedure_return 1
31632>>>>>  end
31632>>>>>>
31632>>>>>  move (Year2to4(year#)) to new_year#
31633>>>>>  if new_year# ne year# set value item itm# to new_year#
31636>>>>>end_procedure
31637>>>>>
31637>>>>> procedure FieldSysdate for DataDictionary integer fld#
31638>>>>>   local date date#
31639>>>>>   get field_current_value fld# to date#
31640>>>>>   if date# eq 0 begin
31642>>>>>     sysdate4 date#
31643>>>>>     set field_changed_value fld# to date#
31644>>>>>   end
31644>>>>>>
31644>>>>> end_procedure
31645>>>>>
31645>>>>> procedure FieldDate2to4 for DataDictionary integer fld#
31646>>>>>   local integer year#
31647>>>>>   local date date# new_date#
31647>>>>>   get field_current_value fld# to date#
31648>>>>>
31648>>>>>   move (DateSegment(date#,DS_YEAR)) to year#
31649>>>>>   if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31652>>>>>   else move date# to new_date#
31654>>>>>
31654>>>>>   move (Date2to4(new_date#)) to new_date#
31655>>>>>   move (DateSegment(new_date#,3)) to year#
31656>>>>>   if (year#>99 and year# <=999) begin
31658>>>>>     error 15 // Illegal entry in this window
31659>>>>>>
31659>>>>>     procedure_return 1
31660>>>>>   end
31660>>>>>>
31660>>>>>   if new_date# ne date# set field_changed_value fld# to new_date#
31663>>>>> end_procedure
31664>>>>>
31664>>>>> procedure FieldYear2to4 for DataDictionary integer fld#
31665>>>>>   local integer year# new_year# changed#
31666>>>>>   get field_current_value fld# to year#
31667>>>>>   get field_changed_state fld# to changed#
31668>>>>>   if changed# begin
31670>>>>>     if (year#>99 and year#<1000) begin
31672>>>>>       error 15 // Illegal entry in this window
31673>>>>>>
31673>>>>>       procedure_return 1
31674>>>>>     end
31674>>>>>>
31674>>>>>     move (Year2to4(year#)) to new_year#
31675>>>>>     if new_year# ne year# set field_changed_value fld# to new_year#
31678>>>>>   end
31678>>>>>>
31678>>>>> end_procedure
31679>>>>>
31679>>>>> function SysDate global returns date
31680>>>>>   function_return (dSysDate())
31681>>>>> end_function
31682>>>>>
31682>>>>>function sSysTime global returns string
31683>>>>>  local integer h# m# s#
31684>>>>>  sysdate4 h# h# m# s#
31688>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31689>>>>>end_function
31690>>>>>
31690>>>>>function TS_SysTime global returns number
31691>>>>>  local integer d# h# m# s#
31692>>>>>  sysdate4 d# h# m# s#
31696>>>>>  function_return (d#*24.0+h#*60+m#*60+s#)
31697>>>>>end_function
31698>>>>>
31698>>>>>//> This function returns a TS value composed from the date and time
31698>>>>>//> passed to it. Note that the time variable must be of the format
31698>>>>>//> "hh:mm:ss".
31698>>>>>function TS_Compose global date date# string time# returns number
31699>>>>>  local integer h# m# s#
31700>>>>>  left time# to h# 2
31702>>>>>>
31702>>>>>  mid time# to m# 2 4
31705>>>>>>
31705>>>>>  mid time# to s# 2 7
31708>>>>>>
31708>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31709>>>>>end_function
31710>>>>>
31710>>>>>function TS_Compose2 global date date# integer h# integer m# integer s# returns number
31711>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31712>>>>>end_function
31713>>>>>
31713>>>>>function TS_ExtractDate global number time# returns date
31714>>>>>  function_return (time#/86400) // 86400=24*60*60
31715>>>>>end_function
31716>>>>>
31716>>>>>function TS_ExtractTime global number time# returns string
31717>>>>>  local integer h# m# s#
31718>>>>>  move (time#-(86400.0*integer(TS_ExtractDate(time#)))) to s#
31719>>>>>  move (s#/3600) to h#
31720>>>>>  move (s#-(h#*3600)) to s#
31721>>>>>  move (s#/60) to m#
31722>>>>>  move (s#-(m#*60)) to s#
31723>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31724>>>>>end_function
31725>>>>>
31725>>>>>function TS_ConvertToString global number time# returns string
31726>>>>>  local date d#
31727>>>>>  move (TS_ExtractDate(time#)) to d#
31728>>>>>  if (integer(d#)) function_return (string(d#)+" "+TS_ExtractTime(time#))
31731>>>>>  else function_return (TS_ExtractTime(time#))
31733>>>>>end_function
31734>>>>>
31734>>>>>function TS_ConvertToStringNoDate global number ts# returns string
31735>>>>>  local integer h# m#
31736>>>>>  move (ts#/3600) to h#
31737>>>>>  move (ts#-(h#*3600)) to ts#
31738>>>>>  move (ts#/60) to m#
31739>>>>>  move (ts#-(m#*60)) to ts#
31740>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(ts#<10,"0","")+string(ts#))
31741>>>>>end_function
31742>>>>>
31742>>>>>// This procedure is used when a TS-variable must be displayed on screen.
31742>>>>>procedure TS_UI_Update global number TS# integer obj1# integer itm1# integer tmp_obj2# integer tmp_itm2#
31743>>>>>  local integer obj2# itm2#
31744>>>>>  if num_arguments gt 3 begin
31746>>>>>    move tmp_obj2# to obj2#
31747>>>>>    move tmp_itm2# to itm2#
31748>>>>>  end
31748>>>>>>
31748>>>>>  else begin
31749>>>>>    move obj1# to obj2#
31750>>>>>    move (itm1#+1) to itm2#
31751>>>>>  end
31751>>>>>>
31751>>>>>  set value of obj1# item itm1# to (TS_ExtractDate(TS#))
31752>>>>>  set value of obj2# item itm2# to (TS_ExtractTime(TS#))
31753>>>>>end_procedure
31754>>>>>
31754>>>>>class TS_TimeEstimator is an array
31755>>>>>  procedure construct_object
31756>>>>>    forward send construct_object
31758>>>>>    set delegation_mode to delegate_to_parent
31759>>>>>    property number  pnTotal   public 0 // Seconds needed to run the loop.
31760>>>>>    property number  pnElapsed public 0 // Seconds elapsed so far.
31761>>>>>    property number  pnLeft    public 0 // Number of seconds left
31762>>>>>    property number  pnStart   public 0
31763>>>>>    property number  pnPause   public 0
31764>>>>>    property number  pnPercent public 0
31765>>>>>    property integer piMin     public 0
31766>>>>>    property integer piMax     public 0
31767>>>>>  end_procedure
31768>>>>>
31768>>>>>  procedure TS_Start integer min# integer max#
31769>>>>>    set piMin to min#
31770>>>>>    set piMax to max#
31771>>>>>    set pnStart to (TS_SysTime())
31772>>>>>    set pnElapsed to 0
31773>>>>>    set pnPercent to 0
31774>>>>>  end_procedure
31775>>>>>
31775>>>>>  procedure TS_Calculate integer pos#
31776>>>>>    local integer min# max#
31777>>>>>    get piMin to min#
31778>>>>>    get piMax to max#
31779>>>>>    set pnElapsed to (TS_SysTime()-pnStart(current_object))
31780>>>>>    set pnTotal   to (pnElapsed(current_object)*(max#-min#)/number(pos#-min#))
31781>>>>>    set pnLeft    to (pnTotal(current_object)-pnElapsed(current_object))
31782>>>>>    set pnPercent to (100.0*(pos#-min#)/(max#-min#))
31783>>>>>  end_procedure
31784>>>>>
31784>>>>>  procedure TS_Pause
31785>>>>>    set pnPause to (TS_SysTime())
31786>>>>>  end_procedure
31787>>>>>
31787>>>>>  procedure TS_Continue
31788>>>>>    set pnStart to (pnStart(current_object)+TS_SysTime()-pnPause(current_object))
31789>>>>>  end_procedure
31790>>>>>end_class
31791>>>>>
31791>>>>>function TS_Module_Compile_Time global string path# returns number
31792>>>>>  local integer pos# day# month# year# seqeof# ch#
31793>>>>>  local string date# str# time#
31793>>>>>  move path# to str#
31794>>>>>  if str# ne "" begin
31796>>>>>    get Seq_New_Channel to ch#   // This method and Seq_Release_Channel are
31797>>>>>    send Seq_Release_Channel ch# // We only need it for a second
31798>>>>>      direct_input channel ch# (trim(str#)+".vd6") // VDF 6
31800>>>>>      [seqeof] direct_input channel ch# (trim(str#)+".vd5") // VDF 5
31802>>>>>    [ seqeof] move 1 to seqeof#
31803>>>>>    [~seqeof] move 0 to seqeof#
31804>>>>>    [~seqeof] readln str#
31805>>>>>    close_input channel ch#
31807>>>>>  end
31807>>>>>>
31807>>>>>  if seqeof# function_return 0
31810>>>>>  pos "," in str# to pos#
31812>>>>>>
31812>>>>>  move (mid(str#,18,pos#+2)) to str#
31813>>>>>  move (integer(mid(str#,2,4))) to day#
31814>>>>>  move (integer(mid(str#,2,1))) to month#
31815>>>>>  move (integer(mid(str#,2,7))) to year#
31816>>>>>  if year# eq 10 begin
31818>>>>>    move (integer(mid(str#,3,7))+1900) to year#
31819>>>>>    move (mid(str#,8,11)) to str#
31820>>>>>  end
31820>>>>>>
31820>>>>>  else move (mid(str#,8,10)) to str#
31822>>>>>  move (DateCompose(day#,month#,year#)) to date#
31823>>>>>  move (Date2to4(date#)) to date#
31824>>>>>  pos ":" in str# to pos#
31826>>>>>>
31826>>>>>  function_return (TS_Compose(date#,mid(str#,8,pos#-2)))
31827>>>>>end_function
31828>>>>>
31828>>>>>string Dates$Module_Compile_Time
31828>>>>>move "" to Dates$Module_Compile_Time
31829>>>>>
31829>>>>>function Module_Compile_Date global returns date
31830>>>>>  local number ts#
31831>>>>>  local string str#
31831>>>>>  get module_name to str# // 'module_name' is most likely the name of the .flx file.
31832>>>>>  get TS_Module_Compile_Time str# to ts#
31833>>>>>  move (TS_ExtractTime(ts#)) to Dates$Module_Compile_Time
31834>>>>>  function_return (TS_ExtractDate(ts#))
31835>>>>>end_function
31836>>>>>
31836>>>>>function Module_Compile_Time global returns string
31837>>>>>  local date grb#
31838>>>>>  // Module_Compile_Date must be called before this one!
31838>>>>>  if Dates$Module_Compile_Time eq "" move (Module_Compile_Date()) to grb#
31841>>>>>  function_return Dates$Module_Compile_Time
31842>>>>>end_function
31843>>>>>
31843>>>>>date   Dates$ModuleStartDate
31843>>>>>string Dates$ModuleStartTime 8
31843>>>>>move (dSysDate()) to Dates$ModuleStartDate
31844>>>>>move (sSysTime()) to Dates$ModuleStartTime
31845>>>>>
31845>>>>>function Module_Start_Date global returns date
31846>>>>>  function_return Dates$ModuleStartDate
31847>>>>>end_function
31848>>>>>
31848>>>>>function Module_Start_Time global returns string
31849>>>>>  function_return Dates$ModuleStartTime
31850>>>>>end_function
31851>>>>>
31851>>>>> register_procedure NotifyPopupCalendarChange date date#
31851>>>>> register_procedure NotifyPopupCalendarSelect date date#
31851>>>>>  use dfAllent
31851>>>>>  class calendar.textbox is a textbox
31852>>>>>    procedure construct_object
31853>>>>>      forward send construct_object
31855>>>>>      Set Auto_Size_State To False
31856>>>>>      Set Justification_Mode To (jMode_vCenter+jMode_Center)
31857>>>>>    end_procedure
31858>>>>>  end_class
31859>>>>>
31859>>>>>  register_object btn1
31859>>>>>  register_object btn6
31859>>>>>
31859>>>>>  class calendar.button is a button
31860>>>>>
31860>>>>>    procedure construct_object
31861>>>>>      forward send construct_object
31863>>>>>      set size to 15 18
31864>>>>>      on_key kleftarrow   send prev_day
31865>>>>>      on_key krightarrow  send next_day
31866>>>>>      on_key kuparrow     send prev_week
31867>>>>>      on_key kdownarrow   send next_week
31868>>>>>      property date p_assigned_date public 0
31869>>>>>    end_procedure
31870>>>>>
31870>>>>>    procedure switch // This makes all 42 buttons act as if they are one focus
31871>>>>>      send activate to (btn1(current_object))
31872>>>>>    end_procedure
31873>>>>>    procedure switch_back
31874>>>>>      send activate to (btn6(current_object))
31875>>>>>    end_procedure
31876>>>>>
31876>>>>>    procedure mouse_down
31877>>>>>      local integer current_object#
31878>>>>>      forward send mouse_down
31880>>>>>      move current_object to current_object#
31881>>>>>      delegate set p_current_date to (p_assigned_date(current_object#))
31883>>>>>    end_procedure
31884>>>>>  end_class
31885>>>>>
31885>>>>>  desktop_section
31891>>>>>    object popup_calendar is a ModalPanel
31893>>>>>      set size to 160 250
31894>>>>>      property date    p_current_date  public 0
31896>>>>>      property integer p_current_year  public -1
31898>>>>>      property integer p_current_month public -1
31900>>>>>      property integer pExportState    public 1
31902>>>>>
31902>>>>>      on_key key_ctrl+key_pgup send prev_year
31903>>>>>      on_key key_ctrl+key_pgdn send next_year
31904>>>>>      on_key          key_pgup send prev_month
31905>>>>>      on_key          key_pgdn send next_month
31906>>>>>      on_key key_ctrl+key_d    send go_today
31907>>>>>      on_key kcancel           send cancel
31908>>>>>
31908>>>>>      object cont3d is a container3d
31910>>>>>        set location to 5 5
31911>>>>>        set size to 120 237
31912>>>>>        object textbox_year is a calendar.textbox
31914>>>>>          set location to 5 5
31915>>>>>          set size to 15 30
31916>>>>>          set border_style to border_staticedge
31917>>>>>          procedure display
31919>>>>>            set value to (p_current_year(current_object))
31920>>>>>          end_procedure
31921>>>>>        end_object
31922>>>>>        object dayname_header is a container3d
31924>>>>>          set location to 5 39
31925>>>>>          set size to 15 126
31926>>>>>          set border_style to border_staticedge
31927>>>>>          procedure initialize
31929>>>>>            local integer itm#
31930>>>>>            for itm# from 0 to 6
31936>>>>>>
31936>>>>>              object txt is a calendar.textbox
31938>>>>>                set size to 12 17
31939>>>>>                set location to 0 (itm#*17.6+1)
31940>>>>>                 set value to (left(DayName(itm#+1),3))
31941>>>>>              end_object
31942>>>>>            loop
31943>>>>>>
31943>>>>>          end_procedure
31944>>>>>          send initialize
31945>>>>>        end_object
31946>>>>>        object weeknumber_header is a container3d
31948>>>>>          set location to 24 5
31949>>>>>          set size     to 89 30
31950>>>>>          set border_style to border_staticedge
31951>>>>>          object obj_id_array is an array
31953>>>>>          end_object
31954>>>>>          procedure initialize
31956>>>>>            local integer itm# obj#
31957>>>>>            move (obj_id_array(current_object)) to obj#
31958>>>>>            for itm# from 0 to 5
31964>>>>>>
31964>>>>>              object txt is a textbox
31966>>>>>                set size to 15 30
31967>>>>>                set location to (itm#*15+1) 1
31968>>>>>                set value of obj# item (item_count(obj#)) to current_object
31969>>>>>              end_object
31970>>>>>            loop
31971>>>>>>
31971>>>>>          end_procedure
31972>>>>>          procedure display
31974>>>>>            local integer itm# obj#
31975>>>>>            local date date# last_date#
31975>>>>>            move (obj_id_array(current_object)) to obj#
31976>>>>>            get p_current_date to date#
31977>>>>>            move (FirstDayInMonth(date#)) to date#
31978>>>>>            move (LastDayInMonth(date#)) to last_date#
31979>>>>>            move (date#-DateDayNumber(date#)+1) to date#
31980>>>>>            for itm# from 0 to 5
31986>>>>>>
31986>>>>>              if (itm#*7+date#) le last_date# ;                set value of (integer(value(obj#,itm#))) to (t.calendar.week*string(DateWeekNumber(itm#*7+date#)))
31989>>>>>              else set value of (integer(value(obj#,itm#))) to ""
31991>>>>>            loop
31992>>>>>>
31992>>>>>          end_procedure
31993>>>>>          send initialize
31994>>>>>        end_object
31995>>>>>        object days_grid is a container3d
31997>>>>>          set location to 23 39
31998>>>>>          set size     to 100 127
31999>>>>>          set border_style to border_none
32000>>>>>          object btn_array is an array
32002>>>>>          end_object
32003>>>>>          procedure initialize
32005>>>>>            local integer row# col# button_array#
32006>>>>>            move (btn_array(current_object)) to button_array#
32007>>>>>            for row# from 0 to 5
32013>>>>>>
32013>>>>>              for col# from 0 to 6
32019>>>>>>
32019>>>>>                object btn is a calendar.button
32021>>>>>                  set location to (row#*15) (col#*18)
32022>>>>>                  set value of button_array# item (item_count(button_array#)) to current_object
32023>>>>>                  on_item "" send move_value_out_ok
32024>>>>>                end_object
32025>>>>>              loop
32026>>>>>>
32026>>>>>            loop
32027>>>>>>
32027>>>>>          end_procedure
32028>>>>>          send initialize
32029>>>>>
32029>>>>>          procedure display.iii integer itm# integer day# integer activate#
32031>>>>>            local integer obj# current_day#
32032>>>>>            move (integer(value(btn_array(current_object),itm#))) to obj#
32033>>>>>            move (DateSegment(p_current_date(current_object),DS_DAY)) to current_day#
32034>>>>>            if activate# begin
32036>>>>>              if day# eq current_day# send activate to obj#
32039>>>>>            end
32039>>>>>>
32039>>>>>            else begin
32040>>>>>              if day# begin
32042>>>>>                set value of obj# to day#
32043>>>>>                set visible_state of obj# to true
32044>>>>>                set p_assigned_date of obj# to (DateCompose(day#,p_current_month(current_object),p_current_year(current_object)))
32045>>>>>              end
32045>>>>>>
32045>>>>>              else set visible_state of obj# to false
32047>>>>>            end
32047>>>>>>
32047>>>>>          end_procedure
32048>>>>>
32048>>>>>          procedure display integer activate#
32050>>>>>            local integer first_item# last_item# itm# day# date#
32051>>>>>            get p_current_date to date#
32052>>>>>            move (FirstDayInMonth(date#)) to date#
32053>>>>>            move (DateDayNumber(date#)-1) to first_item#
32054>>>>>            move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32055>>>>>            ifnot activate# begin
32057>>>>>              for itm# from 0 to (first_item#-1)
32063>>>>>>
32063>>>>>                send display.iii itm# 0 0
32064>>>>>              loop
32065>>>>>>
32065>>>>>            end
32065>>>>>>
32065>>>>>            move 1 to day#
32066>>>>>            for itm# from first_item# to last_item#
32072>>>>>>
32072>>>>>              send display.iii itm# day# activate#
32073>>>>>              increment day#
32074>>>>>            loop
32075>>>>>>
32075>>>>>            ifnot activate# begin
32077>>>>>              for itm# from (last_item#+1) to 41
32083>>>>>>
32083>>>>>                send display.iii itm# 0 0
32084>>>>>              loop
32085>>>>>>
32085>>>>>            end
32085>>>>>>
32085>>>>>          end_procedure
32086>>>>>        end_object
32087>>>>>        object txt_month is a calendar.textbox
32089>>>>>          set size to 12 27
32090>>>>>          set location to 25 185
32091>>>>>          set value to t.calendar.month
32092>>>>>        end_object
32093>>>>>        object btn1 is a button
32095>>>>>          set size to 12 12
32096>>>>>          set location to 40 185
32097>>>>>          on_item "" send prev_month
32098>>>>>          set bitmap to "prev.bmp"
32099>>>>>          procedure switch_back
32101>>>>>            send display_main
32102>>>>>          end_procedure
32103>>>>>        end_object
32104>>>>>        object btn2 is a button
32106>>>>>          set size to 12 12
32107>>>>>          set location to 40 200
32108>>>>>          on_item "" send next_month
32109>>>>>          set bitmap to "next.bmp"
32110>>>>>        end_object
32111>>>>>        object txt_year is a calendar.textbox
32113>>>>>          set size to 12 27
32114>>>>>          set location to 70 185
32115>>>>>          set value to t.calendar.year
32116>>>>>        end_object
32117>>>>>        object btn3 is a button
32119>>>>>          set size to 12 12
32120>>>>>          set location to 85 185
32121>>>>>          on_item "" send prev_year
32122>>>>>          set bitmap to "prev.bmp"
32123>>>>>        end_object
32124>>>>>        object btn4 is a button
32126>>>>>          set size to 12 12
32127>>>>>          set location to 85 200
32128>>>>>          on_item "" send next_year
32129>>>>>          set bitmap to "next.bmp"
32130>>>>>        end_object
32131>>>>>      end_object
32132>>>>>      object btn5 is a button
32134>>>>>        set size to 14 60
32135>>>>>        set location to 129 115
32136>>>>>        on_item t.calendar.ok send move_value_out_ok
32137>>>>>      end_object
32138>>>>>      object btn6 is a button
32140>>>>>        set size to 14 60
32141>>>>>        set location to 129 182
32142>>>>>        on_item t.calendar.cancel send cancel
32143>>>>>        procedure switch
32145>>>>>          send display_main
32146>>>>>        end_procedure
32147>>>>>      end_object
32148>>>>>      procedure next_year
32150>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32151>>>>>        send display_main
32152>>>>>      end_procedure
32153>>>>>      procedure prev_year
32155>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32156>>>>>        send display_main
32157>>>>>      end_procedure
32158>>>>>      procedure next_month
32160>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32161>>>>>        send display_main
32162>>>>>      end_procedure
32163>>>>>      procedure prev_month
32165>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32166>>>>>        send display_main
32167>>>>>      end_procedure
32168>>>>>      procedure next_week
32170>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,1))
32171>>>>>        send display_main
32172>>>>>      end_procedure
32173>>>>>      procedure prev_week
32175>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,-1))
32176>>>>>        send display_main
32177>>>>>      end_procedure
32178>>>>>      procedure next_day
32180>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,1))
32181>>>>>        send display_main
32182>>>>>      end_procedure
32183>>>>>      procedure prev_day
32185>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,-1))
32186>>>>>        send display_main
32187>>>>>      end_procedure
32188>>>>>      procedure go_today
32190>>>>>        local date date#
32191>>>>>        sysdate4 date#
32192>>>>>        set p_current_date to date#
32193>>>>>        send display_main
32194>>>>>      end_procedure
32195>>>>>      property integer invoking_object_id public 0
32197>>>>>      procedure OnChange date date#
32199>>>>>        local integer focus# dm#
32200>>>>>        get invoking_object_id to focus#
32201>>>>>        if focus# gt desktop begin
32203>>>>>          get delegation_mode of focus# to dm#
32204>>>>>          set delegation_mode of focus# to no_delegate_or_error
32205>>>>>          send NotifyPopupCalendarChange to focus# date#
32206>>>>>          set delegation_mode of focus# to dm#
32207>>>>>        end
32207>>>>>>
32207>>>>>      end_procedure
32208>>>>>      procedure display
32210>>>>>        local integer date# month# year#
32211>>>>>        get p_current_date to date#
32212>>>>>        send OnChange date#
32213>>>>>        move (DateSegment(date#,DS_YEAR)) to year#
32214>>>>>        move (DateSegment(date#,DS_MONTH)) to month#
32215>>>>>        if (p_current_year(current_object)<>year# or p_current_month(current_object)<>month#) begin
32217>>>>>          set p_current_year to year#
32218>>>>>          set p_current_month to month#
32219>>>>>          set value to (t.calendar.calendar_popup+", "+MonthName(month#))
32220>>>>>          send display to (textbox_year(cont3d(current_object)))
32221>>>>>          send display to (weeknumber_header(cont3d(current_object)))
32222>>>>>          send display to (days_grid(cont3d(current_object))) 0
32223>>>>>        end
32223>>>>>>
32223>>>>>      end_procedure
32224>>>>>      procedure display_main
32226>>>>>        send display
32227>>>>>        send display to (days_grid(cont3d(current_object))) 1
32228>>>>>      end_procedure
32229>>>>>      procedure popup_no_export
32231>>>>>        set pExportState to false
32232>>>>>        send popup
32233>>>>>        set pExportState to true
32234>>>>>      end_procedure
32235>>>>>
32235>>>>>      procedure popup_group
32237>>>>>        local integer focus#
32238>>>>>        local date date#
32238>>>>>        move (focus(desktop)) to focus#
32239>>>>>        set invoking_object_id to focus#
32240>>>>>        get value of focus# item current to date#
32241>>>>>        ifnot (integer(date#)) move (dSysdate()) to date#
32244>>>>>        move (Date2to4(date#)) to date#
32245>>>>>        set p_current_date to date#
32246>>>>>        send display
32247>>>>>        forward send popup_group
32249>>>>>        send display to (days_grid(cont3d(current_object))) 1
32250>>>>>      end_procedure
32251>>>>>
32251>>>>>      procedure move_value_out
32253>>>>>        local integer focus# dm# margin# datatype#
32254>>>>>        if (pExportState(current_object)) begin
32256>>>>>          get invoking_object_id to focus#
32257>>>>>          if focus# gt desktop begin
32259>>>>>            get delegation_mode of focus# to dm#
32260>>>>>            set delegation_mode of focus# to no_delegate_or_error
32261>>>>>            send NotifyPopupCalendarSelect to focus# (p_current_date(current_object))
32262>>>>>            get form_margin of focus# item current to margin#
32263>>>>>            get form_datatype of focus# item current to datatype#
32264>>>>>            set delegation_mode of focus# to dm#
32265>>>>>            if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to (p_current_date(current_object))
32268>>>>>            else             set value of focus# item current to (Date4to2(p_current_date(current_object)))
32270>>>>>            set item_changed_state of focus# item current to true
32271>>>>>          end
32271>>>>>>
32271>>>>>        end
32271>>>>>>
32271>>>>>      end_procedure
32272>>>>>
32272>>>>>      procedure move_value_out_ok
32274>>>>>        send move_value_out
32275>>>>>        send deactivate
32276>>>>>      end_procedure
32277>>>>>
32277>>>>>      procedure request_popup
32279>>>>>        local integer focus# type# dm#
32280>>>>>        move (focus(desktop)) to focus#
32281>>>>>        if focus# gt desktop begin
32283>>>>>          get delegation_mode of focus# to dm#
32284>>>>>          set delegation_mode of focus# to no_delegate_or_error
32285>>>>>          get form_datatype of focus# item current to type#
32286>>>>>          if (type#=date_window or type#=mask_date_window) send popup
32289>>>>>          set delegation_mode of focus# to dm#
32290>>>>>        end
32290>>>>>>
32290>>>>>      end_procedure
32291>>>>>    end_object
32292>>>>>  end_desktop_section
32294>>>>>  // If the procedure below was not defined "for BaseClass" its symbolic
32294>>>>>  // substitute would become negative (because located on the desktop). This
32294>>>>>  // would result in the toolbar object not being able to handle it. Therefore:
32294>>>>>  procedure request_popup_calendar for BaseClass
32295>>>>>    send request_popup to (popup_calendar(current_object))
32296>>>>>  end_procedure
32297>>>>>  procedure popup_calendar_no_export
32298>>>>>    send popup_no_export to (popup_calendar(current_object))
32299>>>>>  end_procedure
32300>>>>>  register_procedure Add_Toolbar_Button_Bitmap string bmp# string Tip# string StHlp# integer msg# integer obj#
32300>>>>>  procedure Add_Calendar_tbButton integer oTb#
32301>>>>>    send Add_Toolbar_Button_Bitmap to oTb# "DfCalend.bmp" t.calendar.calendar_popup t.calendar.Activate msg_request_popup_calendar
32302>>>>>  end_procedure
32303>>>>> function s.calendar returns integer // Backwards compatible!!
32304>>>>>   function_return (popup_calendar(current_object))
32305>>>>> end_function
32306>>>>>
32306>>>>>// Karl,
32306>>>>>// Structure is as follows,
32306>>>>>//
32306>>>>>// //put this code in the top portion of the view code or in the program
32306>>>>>// code.
32306>>>>>//
32306>>>>>// Type SystemTime
32306>>>>>//   field SystemTime.iYear As Word
32306>>>>>//   field SystemTime.iMonth As Word
32306>>>>>//   field SystemTime.iDayOfWeek As Word
32306>>>>>//   field SystemTime.iDay As Word
32306>>>>>//   field SystemTime.iHour As Word
32306>>>>>//   field SystemTime.iMinute As Word
32306>>>>>//   field SystemTime.iSecond As Word
32306>>>>>//   field SystemTime.iMilliseconds As Word
32306>>>>>// End_Type
32306>>>>>//
32306>>>>>// external_function GetSystemTime "GetSystemTime" kernel32.dll Pointer lpGST Returns VOID_TYPE
32306>>>>>//
32306>>>>>// //put this code in an onClick or wherever
32306>>>>>// procedure onclick
32306>>>>>//   local integer iRetVal
32306>>>>>//   local string TimeData
32306>>>>>//   local pointer GST
32306>>>>>//
32306>>>>>//   ZeroType SystemTime to TimeData
32306>>>>>//   getAddress from TimeData to GST
32306>>>>>//
32306>>>>>//   move (GetSystemTime(GST)) to iRetVal
32306>>>>>// end_procedure
32306>>>>>//
32306>>>>>// To extract the data from the Structure after calling the function use
32306>>>>>// the getbuff command as follows:
32306>>>>>//
32306>>>>>// getbuff from TimeData as SystemTime.IVAL to var
32306>>>>>//
32306>>>>>// where IVAL is one of the vars such as iYear or iDay, etc.
32306>>>>>//
32306>>>>>// OLIVER NELSON
32306>>>>>//
32306>>>>>//
32306>>>
32306>>>//AB-StoreTopEnd
32306>>>
32306>>>//AB-IgnoreStart
32306>>>
32306>>>Use DFAllEnt.pkg
32306>>>
32306>>>
32306>>>//AB-IgnoreEnd
32306>>>
32306>>>CD_Popup_Object oCalendar is a dbModalPanel
32325>>>
32325>>>    //AB-StoreTopStart
32325>>>    on_key kcancel           send cancel
32326>>>    //AB-StoreTopEnd
32326>>>
32326>>>    Set Border_Style to Border_Normal
32327>>>    Set Caption_Bar to FALSE
32328>>>    Set Label to "Ÿ­¢ àì, 2001"
32329>>>    Set Size to 98 123
32330>>>    Set Location to 10 22
32331>>>    Set Color to clWhite
32332>>>
32332>>>    //AB-DDOStart
32332>>>
32332>>>
32332>>>    //AB-DDOEnd
32332>>>
32332>>>    Object Container3d1 is a Container3d
32334>>>        Set Size to 88 135
32335>>>        Set Location to -2 -1
32336>>>        Set Color to clWhite
32337>>>        Set Border_Style to Border_None
32338>>>        Object Grid2 is a Grid
32340>>>
32340>>>            //AB-StoreTopStart
32340>>>            property date    p_current_date     public 0
32342>>>            property integer p_current_year     public -1
32344>>>            property integer p_current_month    public -1
32346>>>            property integer p_selected_day     public -1
32348>>>            property integer pExportState       public 1
32350>>>            property integer invoking_object_id public 0
32352>>>            
32352>>>            Set Border_Style To BORDER_NONE
32353>>>            Set header_visible_state To False
32354>>>            set select_mode to no_select
32355>>>            Set Gridline_mode To GRID_VISIBLE_NONE
32356>>>            
32356>>>            on_key Key_F1 Send Help
32357>>>            on_key key_ctrl+key_pgup send prev_year
32358>>>            on_key key_ctrl+key_pgdn send next_year
32359>>>            on_key          key_pgup send prev_month
32360>>>            on_key          key_pgdn send next_month
32361>>>            on_key key_enter         send move_value_out
32362>>>            on_key key_ctrl+key_d    send go_today
32363>>>            
32363>>>            //AB-StoreTopEnd
32363>>>
32363>>>            Set Color to clWhite
32364>>>            Set CurrentCellColor to clWhite
32365>>>            Set CurrentCellTextColor to clWhite
32366>>>            Set Size to 61 145
32367>>>            Set Location to 30 1
32368>>>            Set Resize_Column_state to FALSE
32369>>>
32369>>>            Set Line_Width to 7 0
32370>>>
32370>>>            Set Form_Width    item 0 to 18
32371>>>            Set Header_Label  item 0 to "­"
32372>>>            
32372>>>            Set Form_Width    item 1 to 18
32373>>>            Set Header_Label  item 1 to "‚â"
32374>>>            
32374>>>            Set Form_Width    item 2 to 18
32375>>>            Set Header_Label  item 2 to "‘à"
32376>>>            
32376>>>            Set Form_Width    item 3 to 18
32377>>>            Set Header_Label  item 3 to "—â"
32378>>>            
32378>>>            Set Form_Width    item 4 to 18
32379>>>            Set Header_Label  item 4 to "â"
32380>>>            
32380>>>            Set Form_Width    item 5 to 18
32381>>>            Set Header_Label  item 5 to "‘¡"
32382>>>            
32382>>>            Set Form_Width    item 6 to 18
32383>>>            Set Header_Label  item 6 to "‚á"
32384>>>            
32384>>>
32384>>>            //AB-StoreStart
32384>>>            
32384>>>            procedure go_today
32386>>>                Date date#
32387>>>                sysdate4 date#
32388>>>                set p_current_date to date#
32389>>>                Send Update_Calendar
32390>>>            end_procedure
32391>>>            
32391>>>            procedure next_month
32393>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32394>>>                Send Update_Calendar
32395>>>            end_procedure
32396>>>            
32396>>>            procedure prev_month
32398>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32399>>>                Send Update_Calendar
32400>>>            end_procedure
32401>>>            
32401>>>            procedure next_year
32403>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32404>>>                Send Update_Calendar
32405>>>            end_procedure
32406>>>            
32406>>>            procedure prev_year
32408>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32409>>>                Send Update_Calendar
32410>>>            end_procedure
32411>>>            
32411>>>            Procedure Activate
32413>>>                Date date#
32414>>>                Forward Send Activate
32416>>>                Set current_item to (p_selected_day(Self))
32417>>>            End_Procedure
32418>>>            
32418>>>            Procedure Update_Calendar
32420>>>                Set Dynamic_Update_State To False
32421>>>                send Fill_List
32422>>>                Set Dynamic_Update_State To True
32423>>>                // Send Update_Label
32423>>>                Set current_item to (p_selected_day(Self))
32424>>>                Send Date_Changing to (oYear(Container3d2(self)))
32425>>>                Send Date_Changing to (oMonth(Container3d2(self)))
32426>>>            End_Procedure
32427>>>            
32427>>>            Procedure Fill_List
32429>>>                Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
32430>>>                Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
32430>>>                Date dToday
32430>>>                Send Delete_Data
32431>>>            
32431>>>                Get p_current_date to date#
32432>>>            
32432>>>                SysDate4 dToday
32433>>>                move (DateSegment(dToday,DS_DAY)) to cur_day#
32434>>>                move (DateSegment(dToday,DS_MONTH)) to cur_month#
32435>>>                move (DateSegment(dToday,DS_YEAR)) to cur_year#
32436>>>            
32436>>>                move (DateSegment(date#,DS_DAY)) to sel_day#
32437>>>                move (DateSegment(date#,DS_MONTH)) to sel_month#
32438>>>                move (DateSegment(date#,DS_YEAR)) to sel_year#
32439>>>                Set p_current_month To sel_month#
32440>>>                Set p_current_year To sel_year#
32441>>>            
32441>>>                move (FirstDayInMonth(date#)) to date#
32442>>>                move (DateDayNumber(date#)-1) to first_item#
32443>>>                move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32444>>>                move (DateIncrement(date#,DS_Month,-1)) To prevdate#
32445>>>                move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
32446>>>            
32446>>>                If (first_item# > 0) Begin
32448>>>                    Move (first_item#-1) to day#
32449>>>                    For iFor from 0 to (first_item#-1)
32455>>>>
32455>>>                        Send Add_Item msg_move_value_out (prev_last#-day#)
32456>>>                        Set Entry_State Item iFor To False
32457>>>                        Set ItemTextColor Item iFor To clGray
32458>>>                        Decrement day#
32459>>>                    Loop
32460>>>>
32460>>>                End
32460>>>>
32460>>>            
32460>>>                Move 1 To day#
32461>>>                For iFor from first_item# to last_item#
32467>>>>
32467>>>                    Send Add_Item Msg_Move_Value_Out day#
32468>>>                    Set Entry_State Item iFor To False
32469>>>                    If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Set Form_Bitmap Item iFor To "cdate.bmp"
32472>>>                    If Day# eq sel_day# Set p_selected_day To iFor
32475>>>                    Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
32476>>>                    Set form_datatype item iFor To mask_numeric_window
32477>>>                    Set form_Mask item iFor To "## "
32478>>>                    Increment day#
32479>>>                Loop
32480>>>>
32480>>>            
32480>>>                move (DateIncrement(date#,DS_Month,1)) To nextdate#
32481>>>                move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
32482>>>            
32482>>>                If (last_item# < 41) Begin
32484>>>                    Move 1 to day#
32485>>>                    For iFor from (last_item#+1) to 41
32491>>>>
32491>>>                        Send Add_Item msg_move_value_out day#
32492>>>                        Set Entry_State Item iFor To False
32493>>>                        Set ItemTextColor Item iFor To clGray
32494>>>                        Increment day#
32495>>>                    Loop
32496>>>>
32496>>>                End
32496>>>>
32496>>>            
32496>>>            End_Procedure
32497>>>            
32497>>>            Procedure Help
32499>>>                Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<PgUp>, <PgDn> - Select year.\n\n(c) 2001, SCR. Special thanks to Sture Andersen.") ("Help on Calendar")
32500>>>            End_Procedure
32501>>>            
32501>>>            procedure mouse_click integer window integer char_pos
32503>>>                Send Move_Value_Out
32504>>>                forward send mouse_click window char_pos
32506>>>            end_procedure
32507>>>            
32507>>>            Procedure Move_Value_Out
32509>>>                Integer iYear iMonth iDay iItm
32510>>>                Date Date# next_date# prev_date#
32510>>>                Get Current_Item To iItm
32511>>>                If (pExportState(Self)) Begin
32513>>>                    Get Value Item iItm To iDay
32514>>>                    Get p_current_month to iMonth
32515>>>                    Get p_current_year  to iYear
32516>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32517>>>            
32517>>>                    If ((iItm>27)and(iDay<15)) Begin
32519>>>                        Move (DateCompose(1,iMonth,iYear)) To next_date#
32520>>>                        move (DateIncrement(next_date#,DS_Month,1)) To next_date#
32521>>>                        move (DateSegment(next_date#,DS_MONTH)) to iMonth
32522>>>                        move (DateSegment(next_date#,DS_YEAR)) to iYear
32523>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32524>>>                    End
32524>>>>
32524>>>                    If ((iItm<7)and(iDay>20)) Begin
32526>>>                        Move (DateCompose(1,iMonth,iYear)) To prev_date#
32527>>>                        move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
32528>>>                        move (DateSegment(prev_date#,DS_MONTH)) to iMonth
32529>>>                        move (DateSegment(prev_date#,DS_YEAR)) to iYear
32530>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32531>>>                    End
32531>>>>
32531>>>            
32531>>>                    Send Export_Date date#
32532>>>                End
32532>>>>
32532>>>            End_Procedure
32533>>>            
32533>>>            Procedure Export_Date date date#
32535>>>                local integer focus# dm# margin# datatype#
32536>>>                get invoking_object_id to focus#
32537>>>            
32537>>>                if focus# gt desktop begin
32539>>>                     get delegation_mode of focus# to dm#
32540>>>                     set delegation_mode of focus# to no_delegate_or_error
32541>>>                     get form_margin of focus# item current to margin#
32542>>>                     get form_datatype of focus# item current to datatype#
32543>>>                     set delegation_mode of focus# to dm#
32544>>>                     if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
32547>>>                     else             set value of focus# item current to (Date4to2(date#))
32549>>>                     set item_changed_state of focus# item current to true
32550>>>                end
32550>>>>
32550>>>                Send Close_Calendar
32551>>>            End_Procedure
32552>>>            //AB-StoreEnd
32552>>>
32552>>>        End_Object    // Grid2
32553>>>
32553>>>        Object Textbox2 is a Textbox
32555>>>            Set Label to "­"
32556>>>            Set Auto_Size_State to FALSE
32557>>>            Set Transparent_State to TRUE
32558>>>            Set Color to clWhite
32559>>>            Set TextColor to clNavy
32560>>>            Set Location to 19 4
32561>>>            Set Size to 10 15
32562>>>
32562>>>            //AB-StoreStart
32562>>>                                        
32562>>>            Set Label To (left(t.calendar.Monday,2))
32563>>>            //AB-StoreEnd
32563>>>
32563>>>        End_Object    // Textbox2
32564>>>
32564>>>        Object Textbox3 is a Textbox
32566>>>            Set Label to "‚â"
32567>>>            Set Auto_Size_State to FALSE
32568>>>            Set Transparent_State to TRUE
32569>>>            Set Color to clWhite
32570>>>            Set TextColor to clNavy
32571>>>            Set Location to 19 22
32572>>>            Set Size to 10 12
32573>>>
32573>>>            //AB-StoreStart
32573>>>                                        
32573>>>            Set Label To (left(t.calendar.Tuesday,2))
32574>>>            //AB-StoreEnd
32574>>>
32574>>>        End_Object    // Textbox3
32575>>>
32575>>>        Object Textbox4 is a Textbox
32577>>>            Set Label to "‘à"
32578>>>            Set Auto_Size_State to FALSE
32579>>>            Set Transparent_State to TRUE
32580>>>            Set Color to clWhite
32581>>>            Set TextColor to clNavy
32582>>>            Set Location to 19 39
32583>>>            Set Size to 10 15
32584>>>
32584>>>            //AB-StoreStart
32584>>>                                        
32584>>>            Set Label To (left(t.calendar.Wednesday,2))
32585>>>            //AB-StoreEnd
32585>>>
32585>>>        End_Object    // Textbox4
32586>>>
32586>>>        Object Textbox5 is a Textbox
32588>>>            Set Label to "—â"
32589>>>            Set Auto_Size_State to FALSE
32590>>>            Set Transparent_State to TRUE
32591>>>            Set Color to clWhite
32592>>>            Set TextColor to clNavy
32593>>>            Set Location to 19 57
32594>>>            Set Size to 10 17
32595>>>
32595>>>            //AB-StoreStart
32595>>>                                        
32595>>>            Set Label To (left(t.calendar.Thursday,2))
32596>>>            //AB-StoreEnd
32596>>>
32596>>>        End_Object    // Textbox5
32597>>>
32597>>>        Object Textbox6 is a Textbox
32599>>>            Set Label to "â"
32600>>>            Set Auto_Size_State to FALSE
32601>>>            Set Transparent_State to TRUE
32602>>>            Set Color to clWhite
32603>>>            Set TextColor to clNavy
32604>>>            Set Location to 19 76
32605>>>            Set Size to 10 17
32606>>>
32606>>>            //AB-StoreStart
32606>>>                                        
32606>>>            Set Label To (left(t.calendar.Friday,2))
32607>>>            //AB-StoreEnd
32607>>>
32607>>>        End_Object    // Textbox6
32608>>>
32608>>>        Object Textbox7 is a Textbox
32610>>>            Set Label to "‘¡"
32611>>>            Set Auto_Size_State to FALSE
32612>>>            Set Transparent_State to TRUE
32613>>>            Set Color to clWhite
32614>>>            Set TextColor to clNavy
32615>>>            Set Location to 19 91
32616>>>            Set Size to 10 18
32617>>>
32617>>>            //AB-StoreStart
32617>>>                                        
32617>>>            Set Label To (left(t.calendar.Saturday,2))
32618>>>            //AB-StoreEnd
32618>>>
32618>>>        End_Object    // Textbox7
32619>>>
32619>>>        Object Textbox8 is a Textbox
32621>>>            Set Label to "‚á"
32622>>>            Set Auto_Size_State to FALSE
32623>>>            Set Transparent_State to TRUE
32624>>>            Set Color to clWhite
32625>>>            Set TextColor to clNavy
32626>>>            Set Location to 19 109
32627>>>            Set Size to 10 17
32628>>>
32628>>>            //AB-StoreStart
32628>>>                                        
32628>>>            Set Label To (left(t.calendar.Sunday,2))
32629>>>            //AB-StoreEnd
32629>>>
32629>>>        End_Object    // Textbox8
32630>>>
32630>>>        Object LineControl1 is a LineControl
32632>>>            Set Line_Style to lnSINGLE
32633>>>            Set Size to 1 116
32634>>>            Set Location to 28 4
32635>>>
32635>>>            //AB-StoreStart
32635>>>                                        
32635>>>            //AB-StoreEnd
32635>>>
32635>>>        End_Object    // LineControl1
32636>>>
32636>>>        Object Container3d2 is a Container3d
32638>>>            Set Size to 18 131
32639>>>            Set Location to 1 1
32640>>>            Set Color to clNavy
32641>>>            Set Border_Style to Border_None
32642>>>            Object oRght is a BitmapContainer
32644>>>                Set Size to 10 14
32645>>>                Set Location to 4 105
32646>>>                Set Bitmap to "rght.bmp"
32647>>>                Set Border_Style to Border_None
32648>>>
32648>>>                //AB-StoreStart
32648>>>                Procedure Mouse_Down
32650>>>                    Send Next_Month to Grid2
32651>>>                End_Procedure
32652>>>                //AB-StoreEnd
32652>>>
32652>>>            End_Object    // oRght
32653>>>
32653>>>            Object oLeft is a BitmapContainer
32655>>>                Set Size to 10 14
32656>>>                Set Location to 4 3
32657>>>                Set Bitmap to "lft.bmp"
32658>>>                Set Border_Style to Border_None
32659>>>
32659>>>                //AB-StoreStart
32659>>>                Procedure Mouse_Down
32661>>>                    Send Prev_Month to Grid2
32662>>>                End_Procedure
32663>>>                //AB-StoreEnd
32663>>>
32663>>>            End_Object    // oLeft
32664>>>
32664>>>            Object oMonth is a Textbox
32666>>>
32666>>>                //AB-StoreTopStart
32666>>>                Property integer piSelected_Month public 0
32668>>>                //AB-StoreTopEnd
32668>>>
32668>>>                Set Label to "January"
32669>>>                Set Auto_Size_State to FALSE
32670>>>                Set Transparent_State to TRUE
32671>>>                Set Color to clWhite
32672>>>                Set TextColor to clWhite
32673>>>                Set Location to 4 23
32674>>>                Set Size to 10 43
32675>>>                Set FontWeight to 800
32676>>>                Set Justification_Mode to jMode_Center
32677>>>
32677>>>                //AB-StoreStart
32677>>>                                    
32677>>>                Procedure Mouse_Down
32679>>>                    Integer iState
32680>>>                    Get Visible_State of oSelectYear to iState
32681>>>                    If (iState) Send OnKillFocus to oSelectYear
32684>>>                    Send Popup to oSelectMonth
32685>>>                End_Procedure
32686>>>                
32686>>>                Procedure pSelectJan
32688>>>                    Set Label to t.calendar.january
32689>>>                    Set piSelected_Month to 1
32690>>>                    Send Adjust_Calendar
32691>>>                End_Procedure
32692>>>                Procedure pSelectFeb
32694>>>                    Set Label to t.calendar.february
32695>>>                    Set piSelected_Month to 2
32696>>>                    Send Adjust_Calendar
32697>>>                End_Procedure
32698>>>                Procedure pSelectMar
32700>>>                    Set Label to t.calendar.march
32701>>>                    Set piSelected_Month to 3
32702>>>                    Send Adjust_Calendar
32703>>>                End_Procedure
32704>>>                Procedure pSelectApr
32706>>>                    Set Label to t.calendar.april
32707>>>                    Set piSelected_Month to 4
32708>>>                    Send Adjust_Calendar
32709>>>                End_Procedure
32710>>>                Procedure pSelectMay
32712>>>                    Set Label to t.calendar.may
32713>>>                    Set piSelected_Month to 5
32714>>>                    Send Adjust_Calendar
32715>>>                End_Procedure
32716>>>                Procedure pSelectJun
32718>>>                    Set Label to t.calendar.june
32719>>>                    Set piSelected_Month to 6
32720>>>                    Send Adjust_Calendar
32721>>>                End_Procedure
32722>>>                Procedure pSelectJul
32724>>>                    Set Label to t.calendar.july
32725>>>                    Set piSelected_Month to 7
32726>>>                    Send Adjust_Calendar
32727>>>                End_Procedure
32728>>>                Procedure pSelectAug
32730>>>                    Set Label to t.calendar.august
32731>>>                    Set piSelected_Month to 8
32732>>>                    Send Adjust_Calendar
32733>>>                End_Procedure
32734>>>                Procedure pSelectSep
32736>>>                    Set Label to t.calendar.september
32737>>>                    Set piSelected_Month to 9
32738>>>                    Send Adjust_Calendar
32739>>>                End_Procedure
32740>>>                Procedure pSelectOct
32742>>>                    Set Label to t.calendar.october
32743>>>                    Set piSelected_Month to 10
32744>>>                    Send Adjust_Calendar
32745>>>                End_Procedure
32746>>>                Procedure pSelectNov
32748>>>                    Set Label to t.calendar.november
32749>>>                    Set piSelected_Month to 11
32750>>>                    Send Adjust_Calendar
32751>>>                End_Procedure
32752>>>                Procedure pSelectDec
32754>>>                    Set Label to t.calendar.december
32755>>>                    Set piSelected_Month to 12
32756>>>                    Send Adjust_Calendar
32757>>>                End_Procedure
32758>>>                
32758>>>                Object oSelectMonth is a FloatingPopupMenu
32760>>>                    Send Add_Item msg_pSelectJan t.calendar.january
32761>>>                    Send Add_Item msg_pSelectFeb t.calendar.february
32762>>>                    Send Add_Item msg_pSelectMar t.calendar.march
32763>>>                    Send Add_Item msg_pSelectApr t.calendar.april
32764>>>                    Send Add_Item msg_pSelectMay t.calendar.may
32765>>>                    Send Add_Item msg_pSelectJun t.calendar.june
32766>>>                    Send Add_Item msg_pSelectJul t.calendar.july
32767>>>                    Send Add_Item msg_pSelectAug t.calendar.august
32768>>>                    Send Add_Item msg_pSelectSep t.calendar.september
32769>>>                    Send Add_Item msg_pSelectOct t.calendar.october
32770>>>                    Send Add_Item msg_pSelectNov t.calendar.november
32771>>>                    Send Add_Item msg_pSelectDec t.calendar.december
32772>>>                End_Object
32773>>>                
32773>>>                Procedure Adjust_Calendar
32775>>>                    Date date#
32776>>>                    Integer iDay iMonth iYear iItm
32776>>>                    Set Visible_State to false
32777>>>                    Set Visible_State to true
32778>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32779>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32780>>>                    Get piSelected_Month to iMonth
32781>>>                    Get Label of oYear to iYear
32782>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32783>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32784>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32785>>>                End_Procedure
32786>>>                
32786>>>                Procedure Activating
32788>>>                    Forward Send Activating
32790>>>                    Send Date_Changing
32791>>>                End_Procedure
32792>>>                
32792>>>                Procedure Date_Changing
32794>>>                    Set Visible_State to false
32795>>>                    Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
32796>>>                    Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
32797>>>                    Set Visible_State to true
32798>>>                End_Procedure
32799>>>                
32799>>>                
32799>>>                //AB-StoreEnd
32799>>>
32799>>>            End_Object    // oMonth
32800>>>
32800>>>            Object oYear is a Textbox
32802>>>                Set Label to "2001"
32803>>>                Set Transparent_State to TRUE
32804>>>                Set Color to clWhite
32805>>>                Set TextColor to clWhite
32806>>>                Set Location to 4 77
32807>>>                Set Size to 10 18
32808>>>                Set FontWeight to 800
32809>>>
32809>>>                //AB-StoreStart
32809>>>                                                    
32809>>>                Procedure Mouse_Down
32811>>>                    String sVal
32812>>>                    Get Label to sVal
32813>>>                    Set Value of oSelectYear item 0 to sVal
32814>>>                    Set Visible_State of oSelectYear to True
32815>>>                    Send Activate to (oSelectYear(Self))
32816>>>                End_Procedure
32817>>>                
32817>>>                Procedure Activating
32819>>>                    Forward Send Activating
32821>>>                    Send Date_Changing
32822>>>                End_Procedure
32823>>>                
32823>>>                Procedure Date_Changing
32825>>>                    Set Visible_State to false
32826>>>                    Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
32827>>>                    Set Visible_State to true
32828>>>                End_Procedure
32829>>>                //AB-StoreEnd
32829>>>
32829>>>            End_Object    // oYear
32830>>>
32830>>>            Object oSelectYear is a Form
32832>>>
32832>>>                //AB-StoreTopStart
32832>>>                Set Visible_State To False
32833>>>                //AB-StoreTopEnd
32833>>>
32833>>>                Set Size to 10 24
32834>>>                Set Location to 4 75
32835>>>                Set Color to clWhite
32836>>>                Set TextColor to clNavy
32837>>>                Set Form_Border Item 0 to Border_Normal
32838>>>
32838>>>                //AB-StoreStart
32838>>>                                                    
32838>>>                On_Key Key_Enter Send OnKillFocus
32839>>>                On_Key Key_Escape Send OnKillFocus
32840>>>                
32840>>>                Procedure SetFontWeight
32842>>>                    Set Form_FontWeight item 0 to 800
32843>>>                End_Procedure
32844>>>                
32844>>>                Procedure OnKillFocus
32846>>>                    String sVal
32847>>>                    Integer iMonth iDay iYear iItm
32847>>>                    Date date#
32847>>>                    Get Value item 0 to sVal
32848>>>                    Set Visible_State of oYear to false
32849>>>                    Set Label of oYear to sVal
32850>>>                    Set Visible_State of oYear to true
32851>>>                    Set Visible_State to false
32852>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32853>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32854>>>                    Get piSelected_Month of oMonth to iMonth
32855>>>                    Get Value item 0 to iYear
32856>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32857>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32858>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32859>>>                End_Procedure
32860>>>                
32860>>>                Send SetFontWeight
32861>>>                //AB-StoreEnd
32861>>>
32861>>>            End_Object    // oSelectYear
32862>>>
32862>>>
32862>>>            //AB-StoreStart
32862>>>                            
32862>>>            Procedure Mouse_Down
32864>>>                Integer iState
32865>>>                Get Visible_State of oSelectYear to iState
32866>>>                If (iState) Send OnKillFocus to oSelectYear
32869>>>            End_Procedure
32870>>>            
32870>>>            //AB-StoreEnd
32870>>>
32870>>>        End_Object    // Container3d2
32871>>>
32871>>>
32871>>>        //AB-StoreStart
32871>>>                            
32871>>>        //AB-StoreEnd
32871>>>
32871>>>    End_Object    // Container3d1
32872>>>
32872>>>    Object BitmapContainer3 is a BitmapContainer
32874>>>        Set Size to 9 19
32875>>>        Set Location to 88 3
32876>>>        Set Color to clWhite
32877>>>        Set Bitmap to "cdate.bmp"
32878>>>        Set Border_Style to Border_None
32879>>>
32879>>>        //AB-StoreStart
32879>>>        Procedure Mouse_Down
32881>>>            Send go_today to (Grid2(Container3d1(Self)))
32882>>>            Send Adjust_Label to oToday
32883>>>        End_Procedure
32884>>>        //AB-StoreEnd
32884>>>
32884>>>    End_Object    // BitmapContainer3
32885>>>
32885>>>    Object oToday is a Textbox
32887>>>        Set Label to "Today: 01.01.2001"
32888>>>        Set Auto_Size_State to FALSE
32889>>>        Set Color to clWhite
32890>>>        Set Location to 88 22
32891>>>        Set Size to 8 73
32892>>>        Set FontWeight to 800
32893>>>
32893>>>        //AB-StoreStart
32893>>>        Procedure Mouse_Down
32895>>>            Send go_today to (Grid2(Container3d1(Self)))
32896>>>            Send Adjust_Label
32897>>>        End_Procedure
32898>>>        
32898>>>        Procedure Adjust_Label
32900>>>            date date#
32901>>>            SysDate4 date#
32902>>>            Set Visible_State To false
32903>>>            Set Label         to (t.calendar.today+": "+String(date#))
32904>>>            Set Visible_State To true
32905>>>        End_Procedure
32906>>>        
32906>>>        Procedure Activating
32908>>>            Forward Send Activating
32910>>>            Send Adjust_Label
32911>>>        End_Procedure
32912>>>        //AB-StoreEnd
32912>>>
32912>>>    End_Object    // oToday
32913>>>
32913>>>
32913>>>    //AB-StoreStart
32913>>>                
32913>>>    procedure popup
32915>>>        local integer focus# icItm iYear iMonth
32916>>>        local date date#
32916>>>        move (focus(desktop)) to focus#
32917>>>        set invoking_object_id of (Grid2(Container3d1(self))) to focus#
32918>>>        get value of focus# item current to date#
32919>>>        ifnot (integer(date#)) sysdate date#
32922>>>        move (Date2to4(date#)) to date#
32923>>>        set p_current_date of (Grid2(Container3d1(self))) to date#
32924>>>        send fill_list to (Grid2(Container3d1(self)))
32925>>>        move (DateSegment(date#,DS_YEAR)) to iYear
32926>>>        move (DateSegment(date#,DS_MONTH)) to iMonth
32927>>>        Set Label To (MonthName(iMonth)+', '+String(iYear))
32928>>>        forward send popup
32930>>>    end_procedure
32931>>>    
32931>>>    Procedure Close_Calendar
32933>>>        Send Exit
32934>>>    End_Procedure
32935>>>    //AB-StoreEnd
32935>>>
32935>>>CD_End_Object    // oCalendar
32937>>>>
32937>>>
32937>>>
32937>>>//AB-StoreStart
32937>>>    
32937>>>    
32937>>>//AB-StoreEnd
32937>>>
32937>>>//AB/ End_Object    // prj
32937>Use Dates.Utl
32937>Use Roundfn.Fnc
INCLUDING FILE: ROUNDFN.FNC
32937>>>// ===========================================================================
32937>>>//
32937>>>// The ROUND_NUMBER global function has been designed to return the rounded
32937>>>// value of a given 'numeric' argument at a specified rounding precision.
32937>>>//
32937>>>// ---------------------------------------------------------------------------
32937>>>// This version dispenses with the use of powers (10 ^ n) to perform the
32937>>>// necessary calculations.  It uses a string handling technique instead.
32937>>>// ---------------------------------------------------------------------------
32937>>>//
32937>>>// The function requires two arguments, as follows:-
32937>>>//
32937>>>// (a) The numeric value to be rounded, where the range of valid values is
32937>>>//     +/- 99,999,999,999,999.99999999.
32937>>>//
32937>>>// (b) The rounding precision required.  This must be an integer value in the
32937>>>//     range -13 to +8.  If a value outside this range is used, the nearest
32937>>>//     threshold value is substituted.
32937>>>//
32937>>>//     Values in the range +1 to +7 perform rounding on the decimal part of
32937>>>//     the number.  A value of +8 will perform no rounding at all.  A zero
32937>>>//     value will round to the nearest whole number.  Values -1 to -13 will
32937>>>//     round progressively to the left of the decimal point (a frequent
32937>>>//     requirement in financial reporting).
32937>>>//
32937>>>// If the result of the rounding produces a value outside the valid numeric
32937>>>// range (+/- 99,999,999,999,999.99999999) then a zero value is returned.
32937>>>//
32937>>>// Assumptions:-  The only assumptions made have been that the range of
32937>>>// numeric values and the limit of eight decimal places are unlikely to change
32937>>>// in the forseeable future.
32937>>>//
32937>>>// Examples:-
32937>>>//
32937>>>//  1st Argument      2nd Argument   Return Value
32937>>>//  ------------      ------------   ------------
32937>>>//  123456.87654321         8         123456.87654321
32937>>>//  123456.87654321         2         123456.88
32937>>>// -123456.87654321         2        -123456.88
32937>>>//  123456.98765432         0         123457
32937>>>// -123456.98765432        -1        -123460
32937>>>//  123456.98765432        -2         123500
32937>>>//  123456.98765432        -3         123000
32937>>>//  987654                 -4         990000
32937>>>//  987654                 -5        1000000
32937>>>//  987654                 -6        1000000
32937>>>//  987654                 -7              0
32937>>>//
32937>>>// ===========================================================================
32937>>>
32937>>>
32937>>>Function Round_Number GLOBAL number nVal integer iRnd returns Number
32938>>>
32938>>>  Local Number nAdj
32939>>>
32939>>>  Move 10000000000000 to nAdj
32940>>>
32940>>>  // If the rounding precision falls in the range 0 to 8, then return:-
32940>>>
32940>>>  If (iRnd >= 0) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 / (Number(Left(nAdj, ((iRnd + 1) ;      min 9)))) + nVal / (Number(Left(nAdj, (9 - (iRnd min 8))))) ;        * (Number(Left(nAdj, (9 - (iRnd min 8))))))
32943>>>
32943>>>  // Else, where the rounding precision is in the range -1 to -5, return:-
32943>>>
32943>>>  If (iRnd >= -5) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(Left(nAdj, (Abs(iRnd) + 9)))) ;        * (Number(Left(nAdj, (Abs(iRnd) + 9)))))
32946>>>
32946>>>  // Else, where the rounding precision is in the range -6 to -13, return:-
32946>>>
32946>>>  Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(nAdj)) / (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))) ;        * (Number(nAdj)) * (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))))
32947>>>
32947>>>End_Function
32948>Use Connect.Dg
INCLUDING FILE: CONNECT.DG
32948>>>//AB/ Project Connect
32948>>>//AB/ Object prj is a Dialog_Project
32948>>>//AB/     Set ProjectName to "Connect"
32948>>>//AB/     Set ProjectFileName to "Connect.dg"
32948>>>
32948>>>// Project Object Structure
32948>>>//   Connect is a BasicPanelSub
32948>>>//     BitmapContainer1 is a BitmapContainerSub
32948>>>//     Textbox5 is a TextBoxSub
32948>>>//     ComboForm2 is a ComboFormSub
32948>>>//     Textbox6 is a TextBoxSub
32948>>>//     Form4 is a FormSub
32948>>>//     Textbox7 is a TextBoxSub
32948>>>//     Form5 is a FormSub
32948>>>//     Textbox8 is a TextBoxSub
32948>>>//     Form6 is a FormSub
32948>>>//     CheckBox1 is a CheckBoxSub
32948>>>//     oOK_bn is a ButtonSub
32948>>>//     oCancel_bn is a ButtonSub
32948>>>
32948>>>// Register all objects
32948>>>Register_Object BitmapContainer1
32948>>>Register_Object CheckBox1
32948>>>Register_Object ComboForm2
32948>>>Register_Object Connect
32948>>>Register_Object Form4
32948>>>Register_Object Form5
32948>>>Register_Object Form6
32948>>>Register_Object oCancel_bn
32948>>>Register_Object oOK_bn
32948>>>Register_Object Textbox5
32948>>>Register_Object Textbox6
32948>>>Register_Object Textbox7
32948>>>Register_Object Textbox8
32948>>>
32948>>>
32948>>>
32948>>>//AB-StoreTopStart
32948>>>
32948>>>///#INCLUDE
32948>>>Use mertech.inc
INCLUDING FILE: MERTECH.INC
32948>>>>>USE UI
32948>>>>>
#REM -----------------------------------------------
#REM MERTECH DATA SYSTEMS INC. - WWW.MERTECHDATA.COM
#REM MERTECH.INC VERSION 2.1.9
#REM -----------------------------------------------
32948>>>>>
32948>>>>>
32948>>>>>
32948>>>>>
32948>>>>>
32948>>>>>//
32948>>>>>//
32948>>>>>//
32948>>>>>//
32948>>>>>//
32948>>>>>//-----------------------------------------------
32948>>>>>// SELECT_COLUMNS_FIND <FILE> <START> THRU <END>
32948>>>>>// SELECT_COLUMNS_FIND <FILE> <FIELD>
32948>>>>>// This command will issue a properly commands to define the FETCH attribute status
32948>>>>>// for file fields.
32948>>>>>//
32948>>>>>//------------------------------------------------------------------------------
32948>>>>>// RESET_FETCH_FIELDS <FILE NAME>|<FILE NUMBER> <DF_FETCH_TRUE>|<DF_FETCH_FALSE>
32948>>>>>//
32948>>>>>//
32948>>>>>//-----------------------------
32948>>>>>// SQL_FOR_ONEROW <file number>
32948>>>>>//
32948>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get just
32948>>>>>// one ROW for each DataFlex FIND command issued
32948>>>>>// In this case the DBMS optimizer will generate a query with just one row
32948>>>>>//
32948>>>>>//
32948>>>>>//-------------------------------------------------------------------------------
32948>>>>>// SQL_FOR_SET <file number> MAXROWS <number of rows> CACHE|NOCACHE <return code>
32948>>>>>//
32948>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get a SET of rows.
32948>>>>>// In this case the DBMS optimizer will generate a query with <number of rows> Rows.
32948>>>>>// if CACHE is passed as argument, all these rows will be transfered to ORAFlex and then it will
32948>>>>>// save them in a local CACHE buffer. Just the FIND GT and FIND LT will get local cache.
32948>>>>>// Otherwise, i.e NOCACHE,  ORAFLex won't create a local cache.
32948>>>>>//
32948>>>>>//
32948>>>>>//---------------
32948>>>>>// SQL_SET <stmt>
32948>>>>>//
32948>>>>>//-----------------------------------------
32948>>>>>// SQL_APPEND <stmt1> <stmt2> .... <stmtn>
32948>>>>>//
32948>>>>>//------------
32948>>>>>// SQL_EXECUTE
32948>>>>>//
32948>>>>>//----------------------------------------------------------------------
32948>>>>>// LOCK_TABLE [<FILE NAME>|<FILE NUMBER> <FILE NAME>|<FILE NUMBER> ....]
32948>>>>>//
32948>>>>>// LOCK_TABLE will lock the entire table specified as an argument
32948>>>>>// This command will start a new transaction if it still wasn't done.
32948>>>>>// LOCK_TABLE won't lock the other opened tables or the current rows present
32948>>>>>// in their buffers it will be necessary issue a REREAD command to Lock the current
32948>>>>>// rows and then atualize their buffers
32948>>>>>//
32948>>>>>//
32948>>>>>//-------------------------------------------
32948>>>>>// SQL_CHECK_TABLE <SCHEMA NAME> <TABLE NAME>
32948>>>>>//
32948>>>>>//-------------------------------
32948>>>>>// CREATE_TD_FILE  DFTRUE|DFFALSE
32948>>>>>// SET A GLOBAL ATTRIBUTE TO CREATE THE TD FILE AFTER CLOSING AN OPENED FILE
32948>>>>>//
32948>>>>>//-------------------------------------------------
32948>>>>>// OPEN_INT <DATAFLEX FILE NAME>
32948>>>>>// OPEN_INT <PHYSICAL NAME> AS <DATAFLEX FILE NAME>
32948>>>>>//
32948>>>>>// OPEN_INT will check if the OPEN done is an OPEN AS. IF it's true, OPEN_INT
32948>>>>>// will try to open an intermediate file, if there is one. Otherwise OPEN_INT
32948>>>>>// will issue a OPEN command
32948>>>>>// OPEN_INT must be inserted into FMAC file instead OPEN COMMAND
32948>>>>>//
32948>>>>>//=========================================================================================================
32948>>>>>// SELECT STUFFS
32948>>>>>//--------------
32948>>>>>// SQL_SET_STMT OF FILENAME|FILENUMBER TO <STATMENT1>
32948>>>>>//
32948>>>>>// SQL_APPEND_ OF FILENAME|FILENUMBER TO <STATMENT1> <STATMENT2> ... <STATMENTn>
32948>>>>>//
32948>>>>>//
32948>>>>>// SQL_APPEND_UPDCOL_STMT OF FILENAME|FILENUMBER VALUE EXPRESSION WITH FIELD1 FIELD2 ... FIELDN
32948>>>>>//
32948>>>>>// SQL_PREPARE_STMT OF FILENAME|FILENUMBER
32948>>>>>//
32948>>>>>// SQL_BIND_COLUMN [FILENAME|FILENUMBER] [FIELDNAME|FIELDNUMBER]
32948>>>>>//
32948>>>>>// SQL_BINDCOLUMNS_STMT OF FILENAME|FILENUMBER TO <COLUMN1> <COLUMN2> ... <COLUMNn>
32948>>>>>//
32948>>>>>// SQL_EXECUTE_STMT OF FILENAME|FILENUMBER
32948>>>>>//
32948>>>>>// SQL_COMMIT_STMT
32948>>>>>//
32948>>>>>// SQL_ROLLBACK_STMT
32948>>>>>//
32948>>>>>// SQL_FETCH_NEXT_ROW OF FILENAME|FILENUMBER
32948>>>>>//
32948>>>>>//
32948>>>>>//
32948>>>>>//
32948>>>>>// CALL_STORED_PROCEDURE will call a stored procedure passing arguments
32948>>>>>//
32948>>>>>// FORMAT TO USE : CALL_STORED_PROCEDURE <STORED_PROC_NAME> [PASSING <ARG1> <ARG2> ....<ARGn>]
32948>>>>>//
32948>>>>>//
32948>>>>>//---------------------------------------------------------------------------------------------
32948>>>>>// CALL_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
32948>>>>>// CALL_STORED_FUNCTION will call an Oracle stored function passing arguments
32948>>>>>//
32948>>>>>//---------------------------
32948>>>>>// SQL_TEXT_MESSAGE <MESSAGE>
32948>>>>>// Writes a message inside driver log trace file if this is activated
32948>>>>>//
32948>>>>>//-----------------------------------------------------
32948>>>>>// OUTPUT_INT_FILE FOR <FILE NUMBER> TO <INT FILE NAME>
32948>>>>>// Generating the INT file
32948>>>>>//
32948>>>>>// -----------------------
32948>>>>>// SQL_ERROR_MESSAGE <VAR>
32948>>>>>// SQL_ERROR_MESSAGE retrieve the native error message issued by server for error number 25000
32948>>>>>
32948>>>>>
32948>>>>>//=======================================================================================
32948>>>>>// SQLFlex Commands
32948>>>>>//-----------------
32948>>>>>//
32948>>>>>//-----------------------
32948>>>>>// SQLFlex_REVISION <VAR>
32948>>>>>// Retrieves SQLFlex revision
32948>>>>>//
32948>>>>>//-------------------------------------
32948>>>>>// SET_DATABASE_NAME TO <DATABASE NAME>
32948>>>>>// Sets current database
32948>>>>>//
32948>>>>>//---------------------------
32948>>>>>// GET_DATABASE_NAME TO <VAR>
32948>>>>>// Gets name of current database
32948>>>>>//
32948>>>>>//----------------------------------
32948>>>>>// SET_SCHEMA_NAME TO <SCHEMA NAME>
32948>>>>>// Sets current schema name
32948>>>>>//
32948>>>>>//-------------------------
32948>>>>>// GET_SCHEMA_NAME TO <VAR>
32948>>>>>// Gets current schema name
32948>>>>>//
32948>>>>>//--------------------------------
32948>>>>>// SQL_USEDATABASE <DATABASE NAME>
32948>>>>>// Specifies the current Database
32948>>>>>//
32948>>>>>//----------------------------
32948>>>>>// SET_CURRENT_SERVER TO <VAR>
32948>>>>>// Set the current logged server
32948>>>>>//
32948>>>>>//----------------------------
32948>>>>>// GET_CURRENT_SERVER TO <VAR>
32948>>>>>// Retrieves the current logged server
32948>>>>>//
32948>>>>>//-----------------------------
32948>>>>>// SET_HOST_NAME TO <HOST NAME>
32948>>>>>// Defines current host name
32948>>>>>//
32948>>>>>//-----------------------
32948>>>>>// GET_HOST_NAME TO <VAR>
32948>>>>>// Retrieves the current host name
32948>>>>>//
32948>>>>>//---------------------------------------------------------------
32948>>>>>// LOGIN_SQLFLEX <SERVER NAME> <USER NAME> <PASSWORD> <HOST NAME>
32948>>>>>// Specifies host name during login process
32948>>>>>//
32948>>>>>// SQL_CANCEL_QUERY_STMT
32948>>>>>//
32948>>>>>//========================================
32948>>>>>// SQL SERVER Stored Procedure Call engine
32948>>>>>//----------------------------------------
32948>>>>>//
32948>>>>>//
32948>>>>>
32948>>>>>//
32948>>>>>//--------------------------------------------------------------------------------------------------------------
32948>>>>>// CALL_SQLSERVER_PROCEDURE <procedure name> PASSING <VALUE1|VARIABLE1> [SQLOUT] <VALUE2|VARIABLE2> [SQLOUT] ...
32948>>>>>//
32948>>>>>// Executes a stored procedure. SQLOUT will be used to indicate that the stored procedure
32948>>>>>// returns a parameter. The matching parameter in the stored proceudre must have been created with
32948>>>>>// the keyword OUTPUT. Call all procedures that doesn't returns any query with this syntax
32948>>>>>//
32948>>>>>//
32948>>>>>//
32948>>>>>//-----------------------------------------------------------------------------
32948>>>>>
32948>>>>>
32948>>>>>//=============================================================================
32948>>>>>// ORAFlex Commands
32948>>>>>//-----------------
32948>>>>>//----------------------------
32948>>>>>// ORAFlex_REVISION <VARIABLE>
32948>>>>>// Retrieves ORAFlex revision
32948>>>>>//
32948>>>>>//---------------------------------
32948>>>>>// KEEP_FILES_OPEN OF <SERVER NAME>
32948>>>>>// Keeps all files opened even during a LOGOUT
32948>>>>>//
32948>>>>>//-----------------------------------------------
32948>>>>>// SET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
32948>>>>>// Defines the maximum number of cursors that ORAFlex will be allowed for using
32948>>>>>//
32948>>>>>//-----------------------------------------------
32948>>>>>// GET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
32948>>>>>// Retrieves the maximum number of cursors allowed for ORAFlex use
32948>>>>>//
32948>>>>>//---------------------------------------------
32948>>>>>// GET_OPENED_CURSORS OF <SERVER NAME> TO <VAR>
32948>>>>>// Retrieves the number of opened cursors
32948>>>>>//
32948>>>>>//-----------------------------------------------
32948>>>>>// ACTIVATE_TIME_STAMP OF <SERVER NAME> TO ON|OFF
32948>>>>>// Activates Time stamp for date columns
32948>>>>>//
32948>>>>>//----------------------------------------------------------------------------------------------------
32948>>>>>// CALL_ORACLE_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
32948>>>>>// CALL_ORACLE_STORED_FUNCTION will call an Oracle stored function passing arguments
32948>>>>>//
32948>>>>>//-----------------------------------------------------------------------------
32948>>>>>
32948>>>>>//=============================================================================
32948>>>>>// BUFFER save stuffs
32948>>>>>//-------------------
32948>>>>>
32948>>>>>//-------------------------------------------------------
32948>>>>>// SQL_SAVE_BUFFER_BEGIN OF <FILE NUMBER> TO <CACHE SIZE>
32948>>>>>// Initialize the BUFFER buffer
32948>>>>>//
32948>>>>>//---------------------------------
32948>>>>>// SQL_SAVE_BUFFER OF <FILE NUMBER>
32948>>>>>// Moves field buffer values to cache buffer
32948>>>>>//-------------------------------------
32948>>>>>// SQL_SAVE_BUFFER_END OF <FILE NUMBER>
32948>>>>>// Save rows that remains in cache
32948>>>>>//-----------------------------------------------------------------------------
32948>>>>>
32948>>>
32948>>>//AB-StoreTopEnd
32948>>>
32948>>>//AB-IgnoreStart
32948>>>
32948>>>Use Panel.Sub
32948>>>Use Bitmap.Sub
32948>>>Use Txtbox.Sub
32948>>>Use Cmbfrm.Sub
32948>>>Use Form.Sub
32948>>>Use Chkbox.Sub
32948>>>Use Button.Sub
32948>>>
32948>>>
32948>>>//AB-IgnoreEnd
32948>>>
32948>>>Object Connect is a BasicPanelSub
32950>>>
32950>>>    //AB-StoreTopStart
32950>>>
32950>>>    //AB-StoreTopEnd
32950>>>
32950>>>    Set Sysmenu_Icon to FALSE
32951>>>    Set Minimize_Icon to FALSE
32952>>>    Set Label to "Login"
32953>>>    Set Size to 105 230
32954>>>    Set Location to 20 37
32955>>>
32955>>>    //AB-DDOStart
32955>>>
32955>>>
32955>>>    //AB-DDOEnd
32955>>>
32955>>>    Object BitmapContainer1 is a BitmapContainerSub
32957>>>        Set Size to 21 23
32958>>>        Set Location to 4 4
32959>>>        Set Bitmap to "Login1.bmp"
32960>>>        Set Border_Style to Border_None
32961>>>        Set Bitmap_Style to Bitmap_Center
32962>>>        Set Dialog_Caption to "Select a bitmap file"
32963>>>
32963>>>        //AB-StoreStart
32963>>>
32963>>>
32963>>>
32963>>>
32963>>>        //AB-StoreEnd
32963>>>
32963>>>    End_Object    // BitmapContainer1
32964>>>
32964>>>    Object Textbox5 is a TextBoxSub
32966>>>        Set Label to "Driver:"
32967>>>        Set FontSize to 4 0
32968>>>        Set Location to 6 34
32969>>>        Set Size to 13 40
32970>>>        Set TypeFace to "MS Sans Serif"
32971>>>        Set Enabled_State to TRUE
32972>>>    End_Object    // Textbox5
32973>>>
32973>>>    Object ComboForm2 is a ComboFormSub
32975>>>
32975>>>        //AB-StoreTopStart
32975>>>
32975>>>        Set CapsLock_State to True
32976>>>
32976>>>        //AB-StoreTopEnd
32976>>>
32976>>>        Set Size to 13 85
32977>>>        Set Location to 6 76
32978>>>        Set Label_Col_Offset to 2
32979>>>        Set Label_Justification_Mode to jMode_Right
32980>>>
32980>>>        //AB-StoreStart
32980>>>        Procedure Combo_Fill_List
32982>>>                Local String Availdrv## TempDrv##
32983>>>                Local Integer HowMany i p1## p2##
32983>>>
32983>>>                get_profile_string "WorkSpaces" "CurrentWorkspace" to AvailDrv##
32986>>>                If AvailDrv## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to AvailDrv##
32989>>>                insert "WorkSpaces\" in AvailDrv## at 1
32991>>>                get_profile_string AvailDrv## "AvailableDrivers" to AvailDrv##
32994>>>
32994>>>                Move Availdrv## to Tempdrv##
32995>>>                Repeat
32995>>>>
32995>>>                    Replace "|" in Tempdrv## With ""
32997>>>                    [Found] Increment HowMany
32998>>>                Until [Finderr]
33000>>>
33000>>>                Send Combo_add_Item ""
33001>>>
33001>>>                If HowMany lt 1 Begin
33003>>>                    If Availdrv## ne "" Send Combo_Add_Item (UpperCase(Availdrv##))
33006>>>                End
33006>>>>
33006>>>                Else Begin
33007>>>                    For i From 0 to HowMany
33013>>>>
33013>>>                        If i eq 0 Move 1 to p1##
33016>>>                        Else Begin
33017>>>                            Move ((Pos("|",Availdrv##))+1) to p1##
33018>>>                            Replace "|" in Availdrv## With ","
33020>>>                        End
33020>>>>
33020>>>                        Move ((Pos("|",Availdrv##))) to p2##
33021>>>                        Send Combo_Add_Item (UpperCase(Mid(Availdrv##,(p2##-p1##),p1##)))
33022>>>                    Loop
33023>>>>
33023>>>                End
33023>>>>
33023>>>        End_Procedure
33024>>>
33024>>>        Set Allow_Blank_state to True
33025>>>
33025>>>
33025>>>
33025>>>        //AB-StoreEnd
33025>>>
33025>>>    End_Object    // ComboForm2
33026>>>
33026>>>    Object Textbox6 is a TextBoxSub
33028>>>        Set Label to "Server:"
33029>>>        Set FontSize to 4 0
33030>>>        Set Location to 22 34
33031>>>        Set Size to 13 40
33032>>>        Set TypeFace to "MS Sans Serif"
33033>>>        Set Enabled_State to TRUE
33034>>>    End_Object    // Textbox6
33035>>>
33035>>>    Object Form4 is a FormSub
33037>>>        Set Size to 13 93
33038>>>        Set Location to 22 76
33039>>>        Set Label_Col_Offset to 2
33040>>>        Set Label_Justification_Mode to jMode_Right
33041>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33042>>>    End_Object    // Form4
33043>>>
33043>>>    Object Textbox7 is a TextBoxSub
33045>>>        Set Label to "User Name:"
33046>>>        Set FontSize to 4 0
33047>>>        Set Location to 38 34
33048>>>        Set Size to 13 40
33049>>>        Set TypeFace to "MS Sans Serif"
33050>>>        Set Enabled_State to TRUE
33051>>>    End_Object    // Textbox7
33052>>>
33052>>>    Object Form5 is a FormSub
33054>>>        Set Size to 13 93
33055>>>        Set Location to 38 76
33056>>>        Set Label_Col_Offset to 2
33057>>>        Set Label_Justification_Mode to jMode_Right
33058>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33059>>>    End_Object    // Form5
33060>>>
33060>>>    Object Textbox8 is a TextBoxSub
33062>>>        Set Label to "Password:"
33063>>>        Set FontSize to 4 0
33064>>>        Set Location to 54 34
33065>>>        Set Size to 13 40
33066>>>        Set TypeFace to "MS Sans Serif"
33067>>>        Set Enabled_State to TRUE
33068>>>    End_Object    // Textbox8
33069>>>
33069>>>    Object Form6 is a FormSub
33071>>>        Set Size to 13 93
33072>>>        Set Location to 54 76
33073>>>        Set Label_Col_Offset to 2
33074>>>        Set Label_Justification_Mode to jMode_Right
33075>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33076>>>
33076>>>        //AB-StoreStart
33076>>>        Set Password_State Item 0 to True
33077>>>
33077>>>        //AB-StoreEnd
33077>>>
33077>>>    End_Object    // Form6
33078>>>
33078>>>    Object CheckBox1 is a CheckBoxSub
33080>>>        Set Label to "Save Password"
33081>>>        Set Size to 10 66
33082>>>        Set Location to 73 76
33083>>>        Set Status_Help to "Remember The Password at Next Login"
33084>>>    End_Object    // CheckBox1
33085>>>
33085>>>    Object oOK_bn is a ButtonSub
33087>>>        Set Label to "Co&nnect"
33088>>>        Set Default_State to TRUE
33089>>>        Set Bitmap to "mcr.bmp"
33090>>>        Set Size to 28 33
33091>>>        Set Location to 9 184
33092>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33093>>>
33093>>>        //AB-StoreStart
33093>>>        Procedure OnClick
33095>>>            Set LoginOk to True
33096>>>            Send Stop_Modal_ui
33097>>>        End_Procedure
33098>>>        Set Status_Help to "Connect"
33099>>>        //AB-StoreEnd
33099>>>
33099>>>    End_Object    // oOK_bn
33100>>>
33100>>>    Object oCancel_bn is a ButtonSub
33102>>>        Set Label to "&Cancel"
33103>>>        Set Bitmap to "exit2.bmp"
33104>>>        Set Size to 28 32
33105>>>        Set Location to 39 184
33106>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33107>>>
33107>>>        //AB-StoreStart
33107>>>
33107>>>        ON_KEY KENTER SEND Exit_Application to (Connect(Current_Object))
33108>>>
33108>>>        Procedure OnClick
33110>>>            Set LoginOk to False
33111>>>            Send Exit_Application to (Connect(Current_Object))
33112>>>        End_Procedure
33113>>>
33113>>>        Set Status_Help to "Close Application"
33114>>>
33114>>>
33114>>>        //AB-StoreEnd
33114>>>
33114>>>    End_Object    // oCancel_bn
33115>>>
33115>>>
33115>>>    //AB-StoreStart
33115>>>
33115>>>    Set Modal_State to True
33116>>>
33116>>>    // Now is WorkspaceAware
33116>>>
33116>>>    ON_KEY KENTER SEND OnClick to (oOk_bn(Current_Object))
33117>>>    ON_KEY KSAVE_RECORD SEND OK
33118>>>    ON_KEY KCANCEL SEND EXIT_APPLICATION
33119>>>    ON_KEY KCLOSE_PANEL SEND EXIT_APPLICATION
33120>>>
33120>>>    Set Locate_Mode to Center_On_Screen
33121>>>    Set Exit_Application_Local_State to False
33122>>>    Set Exit_MSG to Exit
33123>>>    Set Description_State to True
33124>>>
33124>>>    Property Integer LoginOk public false
33126>>>
33126>>>    External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;        Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
33127>>>
33127>>>    Function Network_User_Name Returns String
33129>>>        Local String sName sLength
33130>>>        Local Pointer lpName_Addr lpLength_Addr
33130>>>        Local Integer iRetval
33130>>>
33130>>>        Movestr (Repeat (Character (0), 255)) To sName
33131>>>>
33131>>>        GetAddress Of sName To lpName_Addr
33132>>>        Movestr (DwordToBytes (255)) To sLength
33133>>>>
33133>>>        GetAddress Of sLength To lpLength_Addr
33134>>>
33134>>>        Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
33135>>>>
33135>>>
33135>>>        If iRetval Eq 0 Function_Return (CString (sName))
33138>>>        Else Function_Return "User Unknown"
33140>>>    End_Function // Network_User_Name
33141>>>
33141>>>    Function fsCrypto String lsWay String lsOld Returns String
33143>>>        Local String lsNew lsTemp
33144>>>        Local Integer liCount
33144>>>           For liCount From 1 to (Length(lsOld))
33150>>>>
33150>>>               Mid lsOld to lsTemp 1 liCount
33153>>>>
33153>>>               If ((Uppercase(lsWay)) eq 'FORWARD') Begin
33155>>>               If ((Ascii(lsTemp) = 255)) Move (Character(32)) to lsTemp
33158>>>               Else Move (Character(Ascii(lsTemp)+1)) to lsTemp
33160>>>               End
33160>>>>
33160>>>               Else Begin
33161>>>                   If ((Uppercase(lsWay)) eq 'BACKWARD') Begin
33163>>>                       If ((Ascii(lsTemp) = 32)) Move (Character(255)) to lsTemp
33166>>>                       Else Move (Character(Ascii(lsTemp)-1)) to lsTemp
33168>>>                   End
33168>>>>
33168>>>               End
33168>>>>
33168>>>               Append lsNew lsTemp
33169>>>           Loop
33170>>>>
33170>>>        Function_Return (lsNew)
33171>>>    End_Function
33172>>>
33172>>>    Procedure Activating
33174>>>        Local String LoginDriver## LoginServer## LoginUserid## LoginPassword##
33175>>>        Local String LastLogin## LoginSeq##
33175>>>        Local Integer SavePassword##
33175>>>
33175>>>        Forward Send Activating
33177>>>
33177>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33180>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33183>>>        insert "WorkSpaces\" in LastLogin## at 1
33185>>>        Append LastLogin## "\" (Module_Name(Self)) "\LastLogin"
33188>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33191>>>
33191>>>        If "|" in LoginSeq## move (left(LoginSeq##,(pos("|",LoginSeq##) -1))) to LoginDriver##
33194>>>        Else Move LoginSeq## to LoginDriver##
33196>>>        get_profile_string LastLogin## "LoginServer"  to LoginServer##
33199>>>        get_profile_string LastLogin## "LoginUserId"  to LoginUserId##
33202>>>        get_profile_string LastLogin## "SavePassword" to SavePassword##
33205>>>        If LoginUserId## eq "" Move (Network_User_Name(Current_Object)) to LoginUserId##
33208>>>
33208>>>        If (((UpperCase(LoginDriver##)) eq "DATAFLEX") or (LoginDriver## eq "")) Begin
33210>>>                Set Value of (ComboForm2(Current_Object)) Item 0 to ""
33211>>>                Set Value of (Form4(Current_Object))      Item 0 to ""
33212>>>        End
33212>>>>
33212>>>        Else Begin
33213>>>            Set Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
33214>>>            Set Value of (Form4(Current_Object))      Item 0 to LoginServer##
33215>>>        End
33215>>>>
33215>>>        Set Value of (Form5(Current_Object))      Item 0 to LoginUserID##
33216>>>        Set Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
33217>>>        If (SavePassword##) Begin
33219>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33220>>>            get_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to LoginPassword##
33224>>>            Set Value of (Form6(Current_Object))      Item 0 to (fsCrypto(Self,"backward",LoginPassword##))
33225>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33226>>>        End
33226>>>>
33226>>>    End_Procedure
33227>>>
33227>>>    Function LoginUser Returns Integer
33229>>>        Integer SavePassword## Size## PasswordOk
33230>>>        String LoginDriver## LoginServer## LoginUserid## LoginPassword## LoginSeq## LastLogin##
33230>>>        String lsLoginDate lsHH lsMM lsSS sDepartment
33230>>>        Integer liOpenCursors
33230>>>
33230>>>        Send Popup_Modal
33231>>>
33231>>>        Get Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
33232>>>        Get Value of (Form4(Current_Object))      Item 0 to LoginServer##
33233>>>        Get Value of (Form5(Current_Object))      Item 0 to LoginUserID##
33234>>>        Get Value of (Form6(Current_Object))      Item 0 to LoginPassword##
33235>>>        Get Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
33236>>>        Set Value of (Form6(Current_Object))      Item 0 to ""
33237>>>
33237>>>    //tolis 03/02/2004
33237>>>        If ((LoginDriver## <> "") and (UpperCase(LoginDriver##)<>"DATAFLEX"))  begin
33239>>>    //        send ignore_error to (error_info_object(current_object)) 25000
33239>>>    //        send ignore_error to (error_info_object(current_object)) 4255
33239>>>    //        send ignore_error to (error_info_object(current_object)) 12293
33239>>>    //        login LoginServer## LoginUserId## LoginPassword## LoginDriver##
33239>>>    //        send trap_error to (error_info_object(current_object)) 25000
33239>>>    //        send trap_error to (error_info_object(current_object)) 4255
33239>>>    //        send trap_error to (error_info_object(current_object)) 12293
33239>>>    //        If LastErr eq 25000 Begin
33239>>>    //            Error LastErr "Invalid Login Information"
33239>>>    //            Set LoginOk to False
33239>>>    //            Send Exit_Application
33239>>>    //        End
33239>>>    //        If LastErr eq 4255 Begin
33239>>>    //            Error LastErr "Invalid Driver Name"
33239>>>    //            Set LoginOk to False
33239>>>    //            Send Exit_Application
33239>>>    //        End
33239>>>    //        If LastErr eq 12293 Begin
33239>>>    //            Error LastErr "(IBM CLI)Database alias name or Database name not found"
33239>>>    //            Set LoginOk to False
33239>>>    //           Send Exit_Application
33239>>>    //      End
33239>>>            Set LoginOk to True
33240>>>    //        If (UpperCase(LoginDriver##) = "ORA_DRV") Begin
33240>>>    //            GET_MAX_OPEN_CURSORS of LoginServer## to liOpenCursors
33240>>>    //            If (liOpenCursors <> 0) SET_MAX_OPEN_CURSORS of LoginServer## to (liOpenCursors+2)
33240>>>    //        End
33240>>>        End
33240>>>>
33240>>>        Else Begin
33241>>>            Set LoginOk to True
33242>>>            Open "Users" as Users
INCLUDING FILE: USERS.FD
33244>>>            Move "DATAFLEX" To LoginDriver##
33245>>>            Move "" to LoginServer##
33246>>>            File_Size Users to Size##
33249>>>            If Size## ne 0 Begin
33251>>>                 Clear Users
33252>>>                 Move LoginUSerId##   to Users.Login_Id
33253>>>                 Find eq Users by Index.1
33254>>>>
33254>>>                 [Finderr] Begin
33256>>>>
33256>>>                    Error 25000 "Unknown User"
33257>>>>
33257>>>                    Set LoginOk to False
33258>>>                    Get LoginOk to PasswordOk
33259>>>                    Function_Return PasswordOk
33260>>>                 End
33260>>>>
33260>>>                 [Found] Begin
33262>>>>
33262>>>                    If (LoginPassword## ne Users.Password) Begin
33264>>>                        Error 25000 "Invalid Password"
33265>>>>
33265>>>                        Set LoginOk to False
33266>>>                        Get LoginOk to PasswordOk
33267>>>                        Function_Return PasswordOk
33268>>>                    End
33268>>>>
33268>>>                    Else Move Users.Departm_Code to sDepartment
33270>>>                    Move (Trim(sDepartment)) to sDepartment
33271>>>                 End
33271>>>>
33271>>>            End
33271>>>>
33271>>>            Close Users
33272>>>
33272>>>
33272>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33272>>>    //            Integer bFileExists
33272>>>    //            Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33272>>>    //            If (NOT(bFileExists)) Begin
33272>>>
33272>>>    //                Get Get_File_Exists  "C:\UsrLogin.txt" To bFileExists
33272>>>    //                If (bFileExists) Begin
33272>>>
33272>>>    ////                        If Size## ne 0 Begin
33272>>>
33272>>>    //                            Local String ss1 ss2 ss3 ss4
33272>>>    //                            Local String dd1 dd2 dd3 dd4
33272>>>    //                            Move '' to dd1
33272>>>    //                            Move '' to dd2
33272>>>    //                            Move '' to dd3
33272>>>    //                            Move '' to dd4
33272>>>
33272>>>    //                            Direct_Input Channel 8 "C:\UsrLogin.txt"
33272>>>    //                            Readln Channel 8 ss1 ss2 ss3 ss4
33272>>>    //                            While (Not(Seqeof))
33272>>>    //                                Move (Trim(ss1)) to ss1
33272>>>    //                                Move (Trim(ss2)) to ss2
33272>>>    //                                Move (Trim(ss3)) to ss3
33272>>>    //                                Move (Trim(ss4)) to ss4
33272>>>    //                                Append dd1 '"' ss1 '"'
33272>>>    //                                Append dd2 '"' ss2 '"'
33272>>>    //                                Append dd3 '"' ss3 '"'
33272>>>    //                                Append dd4 '"' ss4 '"'
33272>>>    //                                Login dd1 dd2 dd3 dd4
33272>>>    //                                Readln Channel 8 ss1 ss2 ss3 ss4
33272>>>    //                            Loop
33272>>>
33272>>>
33272>>>    ////                            // Only Filmnet Users Log on to SQL
33272>>>    ////                            If (sDepartment='FILMNET') Begin
33272>>>    ////                                ////// 20/06/2001 js Allagh apo Oracle se SQL server
33272>>>    ////                                ////// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33272>>>    ////                                login '192.168.128.5'   'sa'    ''   'SQL_DRV'
33272>>>    ////                                login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33272>>>    ////                            End
33272>>>    ////                            Else login '192.168.128.5'      'sa'    ''   'SQL_DRV'
33272>>>    ////                            //Else login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33272>>>
33272>>>    ////                        End
33272>>>    ////                        Else Begin
33272>>>    ////                            ////// 20/06/2001 js Allagh apo Oracle se SQL server
33272>>>    ////                            ///// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33272>>>    ////                            login '192.168.128.5'       'sa'    ''   'SQL_DRV'
33272>>>    ////                            //login '192.168.128.5'   'EPGDNS'    'DNS'   'SQL_DRV'
33272>>>    ////                            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33272>>>    ////                        End
33272>>>
33272>>>
33272>>>    //                End
33272>>>
33272>>>    //            End
33272>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33272>>>
33272>>>
33272>>>
33272>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33272>>>            //*Integer bFileExists
33272>>>            //*Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33272>>>            //*If (NOT(bFileExists)) Begin
33272>>>            //*    If Size## ne 0 Begin
33272>>>            //*        // Only Filmnet Users Log on to SQL
33272>>>            //*        If (sDepartment='FILMNET') Begin
33272>>>            //*            login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33272>>>            //*            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33272>>>            //*        End
33272>>>            //*        Else login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33272>>>            //*    End
33272>>>            //*    Else Begin
33272>>>            //*        login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33272>>>            //*        login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33272>>>            //*    End
33272>>>            //*
33272>>>            //*End
33272>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33272>>>
33272>>>
33272>>>
33272>>>        End
33272>>>>
33272>>>
33272>>>        Open Users
33274>>>        //Open "Users" as Users
33274>>>        File_Size Users to Size##
33277>>>        If Size## ne 0 Begin
33279>>>             Clear Users
33280>>>             Move LoginUSerId##   to Users.Login_Id
33281>>>             Find eq Users by Index.1
33282>>>>
33282>>>             [Finderr] Begin
33284>>>>
33284>>>                Error 25000 "Unknown User"
33285>>>>
33285>>>                Set LoginOk to False
33286>>>                Get LoginOk to PasswordOk
33287>>>                Function_Return PasswordOk
33288>>>             End
33288>>>>
33288>>>             [Found] Begin
33290>>>>
33290>>>                If (LoginPassword## ne Users.Password) Begin
33292>>>                    Error 25000 "Invalid Password"
33293>>>>
33293>>>                    Set LoginOk to False
33294>>>                    Get LoginOk to PasswordOk
33295>>>                    Function_Return PasswordOk
33296>>>                End
33296>>>>
33296>>>                Else Move Users.Departm_Code to sDepartment
33298>>>                Move (Trim(sDepartment)) to sDepartment
33299>>>             End
33299>>>>
33299>>>        End
33299>>>>
33299>>>        Close Users
33300>>>
33300>>>        Get LoginOk to PasswordOk
33301>>>        Sysdate lsLoginDate lsHH lsMM lsSS
33305>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33308>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33311>>>        insert "WorkSpaces\" in LastLogin## at 1
33313>>>        get_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33316>>>        If ((LoginDriver## ne "") and ((UpperCase(LoginDriver##)) ne "DATAFLEX")) Begin
33318>>>           If Not LoginDriver## in LoginSeq## Begin
33320>>>                 If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33323>>>                 Else Move (LoginSeq##+"|"+LoginDriver##) to LoginSeq##
33325>>>                 set_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33328>>>           End
33328>>>>
33328>>>        End
33328>>>>
33328>>>        Append LastLogin## "\" (Module_Name(Self))
33330>>>        Append LastLogin## "\LastLogin"
33331>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33334>>>
33334>>>        If "|" in LoginSeq## Begin
33336>>>            If ((left(LoginSeq##,(pos("|",LoginSeq##) -1))) ne LoginDriver##) Insert (LoginDriver##+"|") in LoginSeq## at 1
33340>>>        End
33340>>>>
33340>>>        Else Begin
33341>>>            If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33344>>>            Else If LoginSeq## ne LoginDriver## Insert (LoginDriver##+"|") in LoginSeq## at 1
33349>>>        End
33349>>>>
33349>>>        Left LoginSeq## to LoginSeq## 250
33351>>>>
33351>>>        set_profile_string LastLogin## "LoginDriver" to (UpperCase(LoginSeq##))
33354>>>        set_profile_string LastLogin## "LoginServer" to LoginServer##
33357>>>        set_profile_string LastLogin## "LoginUserId" to LoginUserId##
33360>>>        set_profile_string LastLogin## "SavePassword" to SavePassword##
33363>>>        If lsHH lt 10 Insert 0 in lsHH at 1
33367>>>        If lsMM lt 10 Insert 0 in lsMM at 1
33371>>>        If lsSS lt 10 Insert 0 in lsSS at 1
33375>>>        Append lsLoginDate " - " lsHH ":" lsMM ":" lsSS
33381>>>        set_profile_string LastLogin## "LoginTime" to lsLoginDate
33384>>>        If (SavePassword##) Begin
33386>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33387>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to (fsCrypto(Self,"forward",LoginPassword##))
33390>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33391>>>        End
33391>>>>
33391>>>        Else Begin
33392>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33393>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to ""
33396>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33397>>>        End
33397>>>>
33397>>>
33397>>>        Function_Return PasswordOk
33398>>>    End_Function
33399>>>
33399>>>    Procedure Login For Desktop
33400>>>        Local Integer LoginPassword##
33401>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33402>>>        If Not LoginPassword## Send Exit_Application
33405>>>    End_Procedure
33406>>>
33406>>>    Function CheckLogin For Desktop Returns Integer
33407>>>        Local Integer LoginPassword##
33408>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33409>>>        Function_Return LoginPassword##
33410>>>    End_Function
33411>>>
33411>>>
33411>>>
33411>>>
33411>>>
33411>>>
33411>>>    //AB-StoreEnd
33411>>>
33411>>>End_Object    // Connect
33412>>>
33412>>>
33412>>>//AB-StoreStart
33412>>>
33412>>>
33412>>>
33412>>>//AB-StoreEnd
33412>>>
33412>>>//AB/ End_Object    // prj
33412>use checkafm.pkg
INCLUDING FILE: CHECKAFM.PKG
33412>>>
33412>>>
33412>>>Function Check_Afm Global String Afm_Num Returns Integer
33413>>>    Integer iii Num1 Num2
33414>>>
33414>>>    Move (Trim(Afm_Num)) To Afm_Num
33415>>>
33415>>>    For iii From 1 To (Length(Trim(Afm_Num)))
33421>>>>
33421>>>        If Not (Mid(Afm_Num,1,iii)) In  "0123456789" Function_Return 3
33424>>>    Loop
33425>>>>
33425>>>
33425>>>    Move (Right(Afm_Num,1)) to Num2
33426>>>
33426>>>    If (Length(Afm_Num)<>9) Function_Return 2
33429>>>
33429>>>    Move 0 to Num1
33430>>>
33430>>>    For iii From 1 to 8
33436>>>>
33436>>>        Add ((Mid(Afm_Num,1,iii)) * (2 ^ (9 - iii))) to Num1
33437>>>    Loop
33438>>>>
33438>>>
33438>>>    Move (Mod(Num1,11)) to Num1
33439>>>    If (Num1=10) Move 0 to Num1
33442>>>
33442>>>    If (Num1=Num2)  Function_Return 0
33445>>>    Else            Function_Return 1
33447>>>End_Function
33448>>>
33448>use checklog.pkg
INCLUDING FILE: CHECKLOG.PKG
33448>>>open syscurgl
INCLUDING FILE: SYSCURGL.FD
33450>>>open syscurxr
33452>>>open gplan
INCLUDING FILE: GPLAN.FD
33454>>>//open gplanl
33454>>>open iteml
INCLUDING FILE: ITEML.FD
33456>>>open cn
INCLUDING FILE: CN.FD
33458>>>open payresp
INCLUDING FILE: PAYRESP.FD
33460>>>open salesmen
INCLUDING FILE: SALESMEN.FD
33462>>>open mhxanik
INCLUDING FILE: MHXANIK.FD
33464>>>open constrct
INCLUDING FILE: CONSTRCT.FD
33466>>>open clients
INCLUDING FILE: CLIENTS.FD
33468>>>open wtypkin
INCLUDING FILE: WTYPKIN.FD
33470>>>open wax
INCLUDING FILE: WAX.FD
33472>>>Function Check_log Global String slog Returns Integer
33473>>>    clear gplan
33474>>>    move syscurxr.company_code to gplan.company_code
33475>>>    move syscurxr.branch_code  to gplan.branch_code
33476>>>    move syscurxr.year_year    to gplan.year_year
33477>>>    move slog                  to gplan.gplan_code
33478>>>    find eq gplan by index.1
33479>>>>
33479>>>    if (found=1) function_return 0
33482>>>    else         function_return 1
33484>>>
33484>>>End_Function
33485>>>
33485>>>Function Check_last Global String slog Returns Integer
33486>>>    clear gplan
33487>>>    move syscurxr.company_code to gplan.company_code
33488>>>    move syscurxr.branch_code  to gplan.branch_code
33489>>>    move syscurxr.year_year    to gplan.year_year
33490>>>    move slog                  to gplan.gplan_code
33491>>>    find eq gplan by index.1
33492>>>>
33492>>>    if ((found=1) and (Gplan.Gplan_Yn_Last = 1)) Function_Return 0
33495>>>    else                                         Function_return 1
33497>>>
33497>>>End_Function
33498>>>
33498>>>Function fsgplandescr String slog Returns string
33499>>>    clear gplan
33500>>>    move syscurgl.company_code to gplan.company_code
33501>>>    move syscurgl.branch_code  to gplan.branch_code
33502>>>    move syscurgl.year_year    to gplan.year_year
33503>>>    move slog                  to gplan.gplan_code
33504>>>    find eq gplan by index.1
33505>>>>
33505>>>    if (found=1) function_return gplan.gplan_descr1
33508>>>    else         function_return ''
33510>>>
33510>>>End_Function
33511>>>
33511>>>//Function fsgplanperi String slog Returns string
33511>>>//    string sdescr
33511>>>//    clear gplanl
33511>>>//    move syscurgl.company_code to  gplanl.company_code
33511>>>//    move syscurgl.branch_code  to  gplanl.branch_code
33511>>>//    move slog                  to  gplanl.gplan_code
33511>>>//    find eq gplanl by index.1
33511>>>//    if (found=1) begin
33511>>>//        move gplanl.gplan_descr1 to sdescr
33511>>>//        function_return sdescr
33511>>>//    end
33511>>>//    else         function_return ''
33511>>>//End_Function
33511>>>
33511>>>
33511>>>
33511>>>Function fsclient string code Returns string
33512>>>    string name
33513>>>    clear clients
33514>>>    move code to clients.client_id
33515>>>    find eq clients by index.6
33516>>>>
33516>>>    if (found) move clients.client_name to name
33519>>>    else       move '' to name
33521>>>    function_return name
33522>>>end_Function
33523>>>
33523>>>Function fspayresp string code Returns string
33524>>>    string name
33525>>>    clear payresp
33526>>>    move code to payresp.presp_id
33527>>>    find eq payresp by index.7
33528>>>>
33528>>>    if (found) move payresp.presp_name to name
33531>>>    else       move '' to name
33533>>>    function_return name
33534>>>end_Function
33535>>>
33535>>>Function fssalesmen string code Returns string
33536>>>    string name
33537>>>    clear salesmen
33538>>>    move code to salesmen.sls_id
33539>>>    find eq salesmen by index.4
33540>>>>
33540>>>    if (found) move salesmen.sls_name to name
33543>>>    else       move '' to name
33545>>>    function_return name
33546>>>end_Function
33547>>>
33547>>>Function fsconstrct string code Returns string
33548>>>    string name
33549>>>    clear constrct
33550>>>    move code to constrct.cnt_id
33551>>>    find eq constrct by index.5
33552>>>>
33552>>>    if (found) move constrct.cnt_name to name
33555>>>    else       move '' to name
33557>>>    function_return name
33558>>>end_Function
33559>>>
33559>>>Function fsmhxanik string code Returns string
33560>>>    string name
33561>>>    clear mhxanik
33562>>>    move code to mhxanik.mhx_id
33563>>>    find eq mhxanik by index.4
33564>>>>
33564>>>    if (found) move mhxanik.mhx_name to name
33567>>>    else       move '' to name
33569>>>    function_return name
33570>>>end_Function
33571>>>
33571>>>
33571>>>Function fsptyppar string code Returns string
33572>>>    string sdescr
33573>>>    clear ptypparl
INCLUDING FILE: PTYPPARL.FD
33574>>>    move syscurxr.company_code to ptypparl.company_code
33575>>>    move syscurxr.branch_code  to ptypparl.branch_code
33576>>> //   move syscurxr.year_year    to ptypparl.year_year
33576>>>    move code                  to ptypparl.ptyppar_code
33577>>>    find eq ptypparl by index.1
33578>>>>
33578>>>    move ptypparl.ptyppar_descr to sdescr
33579>>>    function_return sdescr
33580>>>end_Function
33581>>>
33581>>>Function fsgplan string code Returns string
33582>>>    string sdescr
33583>>>    clear gplan
33584>>>    move syscurxr.company_code to gplan.company_code
33585>>>    move syscurxr.branch_code  to gplan.branch_code
33586>>>    move syscurxr.year_year    to gplan.year_year
33587>>>    move code                  to gplan.gplan_code
33588>>>    find eq gplan by index.1
33589>>>>
33589>>>    move gplan.gplan_descr1    to sdescr
33590>>>    function_return sdescr
33591>>>end_Function
33592>>>
33592>>>Function fsitem string scode Returns string
33593>>>    clear iteml
33594>>>    move scode to iteml.item_code
33595>>>    find eq iteml by index.5
33596>>>>
33596>>>    function_return iteml.item_descr
33597>>>end_Function
33598>>>
33598>>>Function fswax string srecr Returns string
33599>>>    clear wax
33600>>>    move srecr to wax.wax_recr
33601>>>    find eq wax by index.2
33602>>>>
33602>>>    function_return wax.wax_descr
33603>>>end_Function
33604>>>
33604>>>
33604>>>Function fswitemx string code Returns string
33605>>>    string name
33606>>>    clear witemx
INCLUDING FILE: WITEMX.FD
33607>>>    move syscurxr.company_code to witemx.company_code
33608>>>    move syscurxr.branch_code  to witemx.branch_code
33609>>>    move syscurxr.year_year    to witemx.year_year
33610>>>    move code to witemx.witemx_code
33611>>>    find eq witemx by index.5
33612>>>>
33612>>>    move witemx.witemx_descr to name
33613>>>    function_return name
33614>>>end_Function
33615>>>
33615>>>Function fsCNDescr String asItem Returns String
33616>>>    Clear CN
33617>>>    move asItem to CN.CN_Code
33618>>>    Find Eq CN by Index.5
33619>>>>
33619>>>    Function_Return CN.CN_Descr
33620>>>End_Function
33621>>>
33621>>>Function fswtypkin String askin Returns String
33622>>>    Clear Wtypkin
33623>>>    move askin to Wtypkin.wtypkin_code
33624>>>    Find Eq wtypkin by Index.1
33625>>>>
33625>>>    Function_Return Wtypkin.wtypkin_descr
33626>>>End_Function
33627>>>
33627>>>Function FindGtypkinDescr Integer aiCode Returns String
33628>>>    String lsDescr
33629>>>    Clear Gtypkin
INCLUDING FILE: GTYPKIN.FD
33630>>>    Move syscurxr.company_code    to Gtypkin.Company_Code
33631>>>    Move syscurxr.Branch_Code     to Gtypkin.Branch_Code
33632>>>    Move syscurxr.Year_year       to Gtypkin.Year_Year
33633>>>    Move aiCode                   to Gtypkin.Gtypkin_Code
33634>>>    Find eq Gtypkin by Index.1
33635>>>>
33635>>>    [Found] Move Gtypkin.Gtypkin_Descr to lsDescr
33636>>>    Function_Return lsDescr
33637>>>End_Function // FindGtypkinDescr
33638>>>
33638>>>Function FindBtypkinDescr Integer aiCode Returns String
33639>>>    String lsDescr
33640>>>    Clear Btypkin
INCLUDING FILE: BTYPKIN.FD
33641>>>    Move syscurxr.company_code    to Btypkin.Company_Code
33642>>>    Move syscurxr.Branch_Code     to Btypkin.Branch_Code
33643>>>    Move syscurxr.Year_year       to Btypkin.Year_Year
33644>>>    Move aiCode                   to Btypkin.btypkin_Code
33645>>>    Find eq Btypkin by Index.1
33646>>>>
33646>>>    [Found] Move Btypkin.Btypkin_Descr to lsDescr
33647>>>    Function_Return lsDescr
33648>>>End_Function // FindGtypkinDescr
33649>>>
33649>>>
33649>Send Login
33650>Use TranLock
INCLUDING FILE: TRANLOCK.PKG
33650>>>// Statement of purpose:
33650>>>// When using a reread command in VDF you will unfortunately lock many more
33650>>>// files than are necessary.  In order to only lock the files necessary I
33650>>>// use the following procedure to set all files to readonly, manually set
33650>>>// the files being worked on to (default) and then reset all back at the end.
33650>>>// This is what a data dictionary does in a VDF program for it's ddo tree.
33650>>>
33650>>>// The original package is a contribution of another programmer whom I cannot
33650>>>// remember their name (sorry).  The alteration I have done is to make sure that any file
33650>>>// with a non-default filemode will be set back to it's previous setting.
33650>>>
33650>>>Object FileModeArray Is An Array
33652>>>    // 0 = File Number
33652>>>    // 1 = Non-Default FileMode Existing Before Change By ChangeAllFileModes Procedure
33652>>>End_Object
33653>>>
33653>>>Procedure Write_Attribute_Array Integer iFile Integer iFileMode
33654>>>    Integer iCounter hArray iExists
33655>>>    Move (FileModeArray(Self)) To hArray
33656>>>    For iCounter From 0 To 1000
33662>>>>
33662>>>        Get Array_Value Of hArray Item ((iCounter * 2) + 0) To iExists
33663>>>        If (Not(iExists) Or (iExists = iFile)) Begin
33665>>>            Set Array_Value Of hArray Item ((iCounter * 2) + 0) To iFile
33666>>>            Set Array_Value Of hArray Item ((iCounter * 2) + 1) To iFileMode
33667>>>        End
33667>>>>
33667>>>        If (Not(iExists) Or (iExists = iFile)) Break
33670>>>    Loop
33671>>>>
33671>>>End_Procedure
33672>>>
33672>>>Procedure Clear_FileModeArray
33673>>>    Send Delete_Data To (FileModeArray(Self))
33674>>>End_Procedure
33675>>>
33675>>>Function Is_NonStandardFileMode Integer iFile Returns Integer
33676>>>    Integer iCounter iExists iNonStandardFileMode hArray
33677>>>    Move (FileModeArray(Self)) To hArray
33678>>>    For iCounter From 0 To 1000
33684>>>>
33684>>>        Get Array_Value Of hArray Item ((iCounter * 2) + 0) To iExists
33685>>>        If (Not(iExists)) Function_Return 0 // Not Listed In Array
33688>>>        If (iExists = iFile) Begin
33690>>>            Get Array_Value Of hArray Item ((iCounter * 2) + 1) To iNonStandardFileMode
33691>>>            Function_Return iNonStandardFileMode
33692>>>        End
33692>>>>
33692>>>    Loop
33693>>>>
33693>>>    Function_Return
33694>>>End_Function
33695>>>
33695>>>Procedure ChangeAllFileModes Integer iMode
33696>>>    Integer iFile iExistingFileMode iNonStandardFileMode
33697>>>    If (iMode = DF_FileMode_ReadOnly) Send Clear_FileModeArray
33700>>>    Repeat
33700>>>>
33700>>>        // Get Each Opened File, One At A Time...
33700>>>        Get_Attribute DF_File_Next_Opened Of iFile To iFile
33703>>>        If (Not(iFile)) Break
33706>>>        If (iMode = DF_Filemode_ReadOnly) Begin  // Setting All Files To Readonly: Check Alias Stuff
33708>>>            Get_Attribute DF_File_Mode Of iFile To iExistingFileMode
33711>>>            If (iExistingFileMode <> DF_Filemode_Default) Send Write_Attribute_Array iFile iExistingFileMode
33714>>>        End
33714>>>>
33714>>>        If (iMode = DF_Filemode_Default) Begin  // Setting All Files Back To Default
33716>>>            Get Is_NonStandardFileMode iFile To iNonStandardFileMode
33717>>>        End
33717>>>>
33717>>>        If (iNonStandardFileMode) Set_Attribute DF_File_Mode Of iFile To iNonStandardFileMode
33722>>>        Else                      Set_Attribute DF_File_Mode Of iFile To iMode
33726>>>    Loop
33727>>>>
33727>>>End_Procedure
33728>>>
33728>>>// // Comment: Example Of Usage:
33728>>>//    Send ChangeAllFileModes DF_Filemode_ReadOnly  // See Stark.Pkg for This Desktop Procedure
33728>>>// // Comment: Set All Open Files To ReadOnly Except For... (Files Used In Transaction Block)
33728>>>//    Set_Attribute DF_File_Mode Of MyFile1.File_Number To DF_Filemode_Default
33728>>>//    Set_Attribute DF_File_Mode Of MyFile2.File_Number  To DF_Filemode_Default
33728>>>//    Indicate Err False
33728>>>//    Begin_Transaction
33728>>>//
33728>>>//        Clear MyFile1
33728>>>//        Move 1 To MyFile1.Key
33728>>>//        Find EQ MyFile1 By Index.1
33728>>>//        Relate MyFile1
33728>>>//        Add MyFile2.Amount To MyFile1.Amount
33728>>>//        Saverecord MyFile1
33728>>>//        Saverecord MyFile2
33728>>>//        If (Condition) Error 300 "Error Message Here" // Saves Rolled Back
33728>>>//
33728>>>//    End_Transaction
33728>>>//    If (Err) Begin
33728>>>//        Send Info_Box "Errors Were Encountered: No Files Were Altered By This Process (All Changes Rolled Back)"
33728>>>//    End
33728>>>//    Send ChangeAllFileModes DF_Filemode_Default  // Set FileModes Back From Readonly To Normal
INCLUDING FILE: XRHSH.PKG
33728>>//------------------------------
33728>>Use SelectXr.Dg
INCLUDING FILE: SELECTXR.DG
33728>>>>//AB/ Project Select / Change Xrhsh
33728>>>>//AB/ Object prj is a Dialog_Project
33728>>>>//AB/     Set ProjectName to "Select / Change Xrhsh"
33728>>>>//AB/     Set ProjectFileName to "SelectXR.DG"
33728>>>>
33728>>>>// Project Object Structure
33728>>>>//   oSelectYear is a dbModalPanelSub
33728>>>>//     Company_DD is a DataDictionary
33728>>>>//     Branch_DD is a DataDictionary
33728>>>>//     Year_DD is a DataDictionary
33728>>>>//     Company_Company_Code is a dbFormSub
33728>>>>//     Company_Company_Name is a dbFormSub
33728>>>>//     Branch_Branch_Code is a dbFormSub
33728>>>>//     Branch_Branch_Name is a dbFormSub
33728>>>>//     Year_Year_Year is a dbFormSub
33728>>>>//     Year_Year_Descr is a dbFormSub
33728>>>>//     Year_Year_Entrydate is a dbFormSub
33728>>>>//     oOk_bn is a ButtonSub
33728>>>>//     oCancel_bn is a ButtonSub
33728>>>>//     otxtCompany is a TextBoxSub
33728>>>>//     otxtBranch is a TextBoxSub
33728>>>>//     otxtYear is a TextBoxSub
33728>>>>//     otxtWorkingDay is a TextBoxSub
33728>>>>//     otxtWorkingDay is a TextBoxSub
33728>>>>//     chkxr is a CheckBoxSub
33728>>>>
33728>>>>// Register all objects
33728>>>>Register_Object Branch_Branch_Code
33728>>>>Register_Object Branch_Branch_Name
33728>>>>Register_Object Branch_DD
33728>>>>Register_Object Company_Company_Code
33728>>>>Register_Object Company_Company_Name
33728>>>>Register_Object Company_DD
33728>>>>Register_Object chkxr
33728>>>>Register_Object oCancel_bn
33728>>>>Register_Object oOk_bn
33728>>>>Register_Object oSelectYear
33728>>>>Register_Object otxtBranch
33728>>>>Register_Object otxtCompany
33728>>>>Register_Object otxtWorkingDay
33728>>>>Register_Object otxtYear
33728>>>>Register_Object Year_DD
33728>>>>Register_Object Year_Year_Descr
33728>>>>Register_Object Year_Year_Entrydate
33728>>>>Register_Object Year_Year_Year
33728>>>>
33728>>>>
33728>>>>
33728>>>>//AB-StoreTopStart
33728>>>>
33728>>>>
33728>>>>
33728>>>>
33728>>>>       String  gs_selected_beto_site
33728>>>>
33728>>>>Open SysCurXR
33730>>>>Open Nomisma
33732>>>>
33732>>>>//AB-StoreTopEnd
33732>>>>
33732>>>>//AB-IgnoreStart
33732>>>>
33732>>>>Use DFAllEnt.pkg
33732>>>>Use dbForm.Sub
33732>>>>Use Button.Sub
33732>>>>Use Txtbox.Sub
33732>>>>Use Chkbox.Sub
33732>>>>
33732>>>>
33732>>>>Use COMPANY.DD
INCLUDING FILE: COMPANY.DD
33732>>>>>>//DDB-FileStart
33732>>>>>>//DDB-HeaderStart
33732>>>>>>
33732>>>>>>// File Name : COMPANY.DD
33732>>>>>>// Class Name: Company_DataDictionary
33732>>>>>>// Revision  : 62
33732>>>>>>// Version   : 2
33732>>>>>>
33732>>>>>>Use  Windows           // Basic Definitions
33732>>>>>>Use  DataDict          // DataDictionary Class Definition
33732>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33732>>>>>>
33732>>>>>>Open Company
INCLUDING FILE: COMPANY.FD
33734>>>>>>Open Branch
33736>>>>>>
33736>>>>>>//DDB-HeaderEnd
33736>>>>>>//DDB-ValidationStart
33736>>>>>>
33736>>>>>>Register_Object Company_Company_Doy_VT
33736>>>>>>Register_Object Company_Company_J_Code_VT
33736>>>>>>
33736>>>>>>Object Company_Company_Doy_VT  is a CodeValidationTable
33738>>>>>>    Set Type_Value        To "DOY"
33739>>>>>>    Set Allow_Blank_State To TRUE
33740>>>>>>    //DDB-ValidationCustomStart
33740>>>>>>    //DDB-ValidationCustomEnd
33740>>>>>>End_Object   // Company_Company_Doy_VT
33741>>>>>>
33741>>>>>>Object Company_Company_J_Code_VT  is a CodeValidationTable
33743>>>>>>    Set Type_Value        To "JOB"
33744>>>>>>    Set Allow_Blank_State To TRUE
33745>>>>>>    //DDB-ValidationCustomStart
33745>>>>>>    //DDB-ValidationCustomEnd
33745>>>>>>End_Object   // Company_Company_J_Code_VT
33746>>>>>>//DDB-ValidationEnd
33746>>>>>>//DDB-SelectionStart
33746>>>>>>//DDB/ ExternalSelectionList sl001  sl001.sl
33746>>>>>>Register_Object sl001
33746>>>>>>//DDB-SelectionEnd
33746>>>>>> 
33746>>>>>>Class Company_DataDictionary  is a DataDictionary
33747>>>>>> 
33747>>>>>>    // Update:
33747>>>>>> 
33747>>>>>>    Procedure Update
33748>>>>>>        Forward Send Update
33750>>>>>>        move 'DOY' to company.doy_type
33751>>>>>>        move 'JOB' to company.jcode_type 
33752>>>>>>        // Insert Code Here
33752>>>>>>    End_Procedure   // Update
33753>>>>>> 
33753>>>>>>
33753>>>>>>    // Operation_Not_Allowed:
33753>>>>>>
33753>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33754>>>>>>        // Insert Code Here
33754>>>>>>        Case Begin
33754>>>>>>             Case (iError_Num = 1001)
33756>>>>>>                  Error 1001 "DDC 051:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª „«˜ ¨œå˜ª!\n\n‰œ¤æª ‰à› ¡æª"
33757>>>>>>>
33757>>>>>>             Case Break
33758>>>>>>
33758>>>>>>             Case Else
33758>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33760>>>>>>        Case End
33760>>>>>>    End_Procedure   // Operation_Not_Allowed
33761>>>>>>
33761>>>>>>
33761>>>>>>    // Validate_Save:
33761>>>>>>
33761>>>>>>    Function Validate_Save  Returns Integer
33762>>>>>>        Local Integer iReturnVal
33763>>>>>>        Forward Get Validate_Save  To iReturnVal
33765>>>>>>        If (Not(iReturnVal)) Begin
33767>>>>>>            // Insert Code Here
33767>>>>>>            If (Company.Company_Code="") Send Operation_Not_Allowed 1001
33770>>>>>>        End
33770>>>>>>>
33770>>>>>>        Function_Return iReturnVal
33771>>>>>>    End_Function   // Validate_Save
33772>>>>>>
33772>>>>>>
33772>>>>>>    // Define_Fields:
33772>>>>>>    // This procedure is used to set up all data-dictionary rules.
33772>>>>>>
33772>>>>>>    Procedure Define_Fields
33773>>>>>>        Forward Send Define_Fields
33775>>>>>>        //DDB-Generated-Code-Location
33775>>>>>>        //DDB-DefineFieldStart
33775>>>>>>
33775>>>>>>        Set Main_File            To Company.File_Number
33776>>>>>>        Set Cascade_Delete_State To FALSE
33777>>>>>>
33777>>>>>>
33777>>>>>>        // Child (Client) file structure................
33777>>>>>>        Send Add_Client_File  Branch.File_Number
33778>>>>>>
33778>>>>>>        // Field-based properties.......................
33778>>>>>>
33778>>>>>>        // Company.Company_Code
33778>>>>>>        Set Field_Options          Field Company.Company_Code To DD_AUTOFIND   
33779>>>>>>        Set Field_Prompt_Object    Field Company.Company_Code To (sl001(Self))
33780>>>>>>
33780>>>>>>        // Company.Company_Name
33780>>>>>>        Set Field_Options          Field Company.Company_Name To DD_REQUIRED   
33781>>>>>>        Set Field_Prompt_Object    Field Company.Company_Name To (sl001(Self))
33782>>>>>>
33782>>>>>>        // Company.Company_Afm
33782>>>>>>        Set Field_Options          Field Company.Company_Afm To DD_AUTOFIND   
33783>>>>>>
33783>>>>>>        // Company.Company_Addr
33783>>>>>>
33783>>>>>>        // Company.Company_Tk
33783>>>>>>
33783>>>>>>        // Company.Company_Poli
33783>>>>>>
33783>>>>>>        // Company.Company_Doy
33783>>>>>>        Set Field_Value_Table      Field Company.Company_Doy To (Company_Company_Doy_VT(Self))
33784>>>>>>
33784>>>>>>        // Company.Company_J_Code
33784>>>>>>        Set Field_Value_Table      Field Company.Company_J_Code To (Company_Company_J_Code_VT(Self))
33785>>>>>>
33785>>>>>>        // Company.Company_C_Code0
33785>>>>>>
33785>>>>>>        // Company.Company_C_Cod00
33785>>>>>>
33785>>>>>>        // Company.Company_C_Coder
33785>>>>>>
33785>>>>>>        // Company.Company_Tel
33785>>>>>>
33785>>>>>>        // Company.Company_Fax
33785>>>>>>
33785>>>>>>        // Company.Company_Email
33785>>>>>>
33785>>>>>>        // Company.Company_Resp
33785>>>>>>
33785>>>>>>        // Company.Company_Bitmap
33785>>>>>>
33785>>>>>>        // Company.Beto_Site
33785>>>>>>
33785>>>>>>        // Company.Logo
33785>>>>>>
33785>>>>>>        // Company.Doy_Type
33785>>>>>>
33785>>>>>>        // Company.Jcode_Type
33785>>>>>>
33785>>>>>>        // Company.Sap_Code
33785>>>>>>
33785>>>>>>        // Company.Sap_Path
33785>>>>>>
33785>>>>>>        //DDB-DefineFieldEnd
33785>>>>>>    End_Procedure    // Define_Fields
33786>>>>>>
33786>>>>>>    // Field_Defaults:
33786>>>>>>    // This procedure is used to establish default field values.
33786>>>>>>
33786>>>>>>    Procedure Field_Defaults
33787>>>>>>        Forward Send Field_Defaults
33789>>>>>>        //DDB-Generated-Code-Location
33789>>>>>>        //DDB-FieldDefaultStart
33789>>>>>>        //DDB-FieldDefaultEnd
33789>>>>>>    End_Procedure    // Field_Defaults
33790>>>>>>End_Class    // Company_DataDictionary
33791>>>>>>
33791>>>>>>//DDB-Selection-pkg-Start
33791>>>>>>
33791>>>>>>Use sl001.sl         // sl001
INCLUDING FILE: SL001.SL
33791>>>>>>>>//AB/ Project sl001 : Etairies
33791>>>>>>>>//AB/     Object prj is a Lookup_Project
33791>>>>>>>>//AB/         Set ProjectName to "sl001 : Etairies"
33791>>>>>>>>//AB/         Set ProjectFileName to "sl001.SL"
33791>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
33791>>>>>>>>
33791>>>>>>>>// Project Object Structure
33791>>>>>>>>//   sl001 is a dbModalPanel
33791>>>>>>>>//     Company_DD is a DataDictionary
33791>>>>>>>>//     oSelList is a dbList
33791>>>>>>>>//     oOK_bn is a ButtonSub
33791>>>>>>>>//     oCancel_bn is a ButtonSub
33791>>>>>>>>//     oSearch_bn is a ButtonSub
33791>>>>>>>>
33791>>>>>>>>// Register all objects
33791>>>>>>>>Register_Object Company_DD
33791>>>>>>>>Register_Object oCancel_bn
33791>>>>>>>>Register_Object oOK_bn
33791>>>>>>>>Register_Object oSearch_bn
33791>>>>>>>>Register_Object oSelList
33791>>>>>>>>Register_Object sl001
33791>>>>>>>>
33791>>>>>>>>
33791>>>>>>>>    //AB-IgnoreStart
33791>>>>>>>>
33791>>>>>>>>    Use DFAllEnt.pkg
33791>>>>>>>>    Use Button.Sub
33791>>>>>>>>
33791>>>>>>>>
33791>>>>>>>>    Use COMPANY.DD
33791>>>>>>>>    
33791>>>>>>>>    //AB-IgnoreEnd
33791>>>>>>>>
33791>>>>>>>>    CD_Popup_Object sl001 is a dbModalPanel
33810>>>>>>>>        Set Label to "„«˜ ¨åœª"
33811>>>>>>>>        Set Size to 148 297
33812>>>>>>>>        Set Location to 12 27
33813>>>>>>>>
33813>>>>>>>>        //AB-DDOStart
33813>>>>>>>>
33813>>>>>>>>        Object Company_DD is a Company_DataDictionary
33815>>>>>>>>        End_Object    // Company_DD
33816>>>>>>>>
33816>>>>>>>>        Set Main_DD to (Company_DD(self))
33817>>>>>>>>        Set Server to (Company_DD(self))
33818>>>>>>>>
33818>>>>>>>>        //AB-DDOEnd
33818>>>>>>>>
33818>>>>>>>>        Object oSelList is a dbList
33820>>>>>>>>            Set Main_File to Company.File_Number
33821>>>>>>>>            Set Size to 105 280
33822>>>>>>>>            Set Location to 6 6
33823>>>>>>>>
33823>>>>>>>>            Begin_Row
33826>>>>>>>>                Entry_Item Company.Company_code
33827>>>>>>>>                Entry_Item Company.Company_name
33828>>>>>>>>                Entry_Item Company.Company_afm
33829>>>>>>>>            End_Row
33834>>>>>>>>
33834>>>>>>>>            Set Form_Width    item 0 to 42
33835>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
33836>>>>>>>>            
33836>>>>>>>>            Set Form_Width    item 1 to 150
33837>>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
33838>>>>>>>>            
33838>>>>>>>>            Set Form_Width    item 2 to 80
33839>>>>>>>>            Set Header_Label  item 2 to "€.”.‹"
33840>>>>>>>>            
33840>>>>>>>>        End_Object    // oSelList
33841>>>>>>>>
33841>>>>>>>>        Object oOK_bn is a ButtonSub
33843>>>>>>>>            Set Label to "&„§ ¢¦šã"
33844>>>>>>>>            Set Location to 115 126
33845>>>>>>>>
33845>>>>>>>>            //AB-StoreStart
33845>>>>>>>>            Procedure OnClick
33847>>>>>>>>                Send OK To (oSelList(current_object))
33848>>>>>>>>            End_Procedure
33849>>>>>>>>            //AB-StoreEnd
33849>>>>>>>>
33849>>>>>>>>        End_Object    // oOK_bn
33850>>>>>>>>
33850>>>>>>>>        Object oCancel_bn is a ButtonSub
33852>>>>>>>>            Set Label to "&€¡ç¨à©ž"
33853>>>>>>>>            Set Location to 115 181
33854>>>>>>>>
33854>>>>>>>>            //AB-StoreStart
33854>>>>>>>>            Procedure OnClick
33856>>>>>>>>                Send Cancel To (oSelList(current_object))
33857>>>>>>>>            End_Procedure
33858>>>>>>>>            //AB-StoreEnd
33858>>>>>>>>
33858>>>>>>>>        End_Object    // oCancel_bn
33859>>>>>>>>
33859>>>>>>>>        Object oSearch_bn is a ButtonSub
33861>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
33862>>>>>>>>            Set Location to 115 236
33863>>>>>>>>
33863>>>>>>>>            //AB-StoreStart
33863>>>>>>>>            Procedure OnClick
33865>>>>>>>>                Send Search To (oSelList(current_object))
33866>>>>>>>>            End_Procedure
33867>>>>>>>>            //AB-StoreEnd
33867>>>>>>>>
33867>>>>>>>>        End_Object    // oSearch_bn
33868>>>>>>>>
33868>>>>>>>>
33868>>>>>>>>        //AB-StoreStart
33868>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To oOk_bn
33869>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To oCancel_bn
33870>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To oSearch_bn
33871>>>>>>>>        //AB-StoreEnd
33871>>>>>>>>
33871>>>>>>>>    CD_End_Object    // sl001
33873>>>>>>>>>
33873>>>>>>>>
33873>>>>>>>>//AB/     End_Object    // prj
33873>>>>>>
33873>>>>>>//DDB-Selection-pkg-End
33873>>>>>>//DDB-FileEnd
33873>>>>Use BRANCH.DD
INCLUDING FILE: BRANCH.DD
33873>>>>>>//DDB-FileStart
33873>>>>>>//DDB-HeaderStart
33873>>>>>>
33873>>>>>>// File Name : BRANCH.DD
33873>>>>>>// Class Name: Branch_DataDictionary
33873>>>>>>// Revision  : 92
33873>>>>>>// Version   : 2
33873>>>>>>
33873>>>>>>Use  Windows           // Basic Definitions
33873>>>>>>Use  DataDict          // DataDictionary Class Definition
33873>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33873>>>>>>
33873>>>>>>Open Branch
33875>>>>>>Open Year
33877>>>>>>Open Brzones
INCLUDING FILE: BRZONES.FD
33879>>>>>>Open Tpbranch
INCLUDING FILE: TPBRANCH.FD
33881>>>>>>Open Company
33883>>>>>>Open Sysrecg
INCLUDING FILE: SYSRECG.FD
33885>>>>>>
33885>>>>>>//DDB-HeaderEnd
33885>>>>>>//DDB-ValidationStart
33885>>>>>>
33885>>>>>>Register_Object Branch_Branch_Doy_VT
33885>>>>>>Register_Object Branch_Branch_C_Code0_VT
33885>>>>>>
33885>>>>>>Object Branch_Branch_Doy_VT  is a CodeValidationTable
33887>>>>>>    Set Type_Value        To "DOY"
33888>>>>>>    Set Validate_State    To FALSE
33889>>>>>>    Set Allow_Blank_State To TRUE
33890>>>>>>    //DDB-ValidationCustomStart
33890>>>>>>    //DDB-ValidationCustomEnd
33890>>>>>>End_Object   // Branch_Branch_Doy_VT
33891>>>>>>
33891>>>>>>Object Branch_Branch_C_Code0_VT  is a CodeValidationTable
33893>>>>>>    Set Type_Value        To ""
33894>>>>>>    Set Allow_Blank_State To TRUE
33895>>>>>>    //DDB-ValidationCustomStart
33895>>>>>>    //DDB-ValidationCustomEnd
33895>>>>>>End_Object   // Branch_Branch_C_Code0_VT
33896>>>>>>//DDB-ValidationEnd
33896>>>>>>//DDB-SelectionStart
33896>>>>>>//DDB/ ExternalSelectionList SL002  Sl002.sl
33896>>>>>>Register_Object SL002
33896>>>>>>//DDB-SelectionEnd
33896>>>>>>
33896>>>>>>Class Branch_DataDictionary  is a DataDictionary
33897>>>>>> 
33897>>>>>>    Procedure Save_Main_File
33898>>>>>>        Forward Send Save_Main_File
33900>>>>>>        // Insert Code Here
33900>>>>>>    End_Procedure   // Save_Main_File
33901>>>>>> 
33901>>>>>>    Procedure Creating
33902>>>>>>        Forward Send Creating
33904>>>>>>        // Insert Code Here
33904>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Branch.Branch_Rec0)))))) to Branch.Branch_Recr
33905>>>>>>    End_Procedure   // Creating
33906>>>>>>
33906>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33907>>>>>>        // Insert Code Here
33907>>>>>>        Case Begin
33907>>>>>>             Case (iError_Num = 1001)
33909>>>>>>                  Error 1001 "DDC 052:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
33910>>>>>>>
33910>>>>>>             Case Break
33911>>>>>>
33911>>>>>>             Case Else
33911>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33913>>>>>>        Case End
33913>>>>>>    End_Procedure   // Operation_Not_Allowed
33914>>>>>>
33914>>>>>>
33914>>>>>>    // Validate_Save:
33914>>>>>>
33914>>>>>>    Function Validate_Save  Returns Integer
33915>>>>>>        Local Integer iReturnVal
33916>>>>>>        Forward Get Validate_Save  To iReturnVal
33918>>>>>>        If (Not(iReturnVal)) Begin
33920>>>>>>            // Insert Code Here
33920>>>>>>            If (Branch.Branch_Code="") Send Operation_Not_Allowed 1001
33923>>>>>>        End
33923>>>>>>>
33923>>>>>>        Function_Return iReturnVal
33924>>>>>>    End_Function   // Validate_Save
33925>>>>>>
33925>>>>>>
33925>>>>>>    // Define_Fields:
33925>>>>>>    // This procedure is used to set up all data-dictionary rules.
33925>>>>>>
33925>>>>>>    Procedure Define_Fields
33926>>>>>>        Forward Send Define_Fields
33928>>>>>>        //DDB-Generated-Code-Location
33928>>>>>>        //DDB-DefineFieldStart
33928>>>>>>
33928>>>>>>        Set Main_File            To Branch.File_Number
33929>>>>>>        Set Cascade_Delete_State To FALSE
33930>>>>>>
33930>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
33931>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOENTER     DD_FINDREQ    
33932>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
33933>>>>>>
33933>>>>>>        // Child (Client) file structure................
33933>>>>>>        Send Add_Client_File  Year.File_Number
33934>>>>>>        Send Add_Client_File  Brzones.File_Number
33935>>>>>>        Send Add_Client_File  Tpbranch.File_Number
33936>>>>>>
33936>>>>>>        // Parent (Server) file structure...............
33936>>>>>>        Send Add_Server_File  Company.File_Number
33937>>>>>>
33937>>>>>>        // External (System) file structure.............
33937>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
33938>>>>>>
33938>>>>>>        Define_Auto_Increment  Sysrecg.Branch_Rec0  To Branch.Branch_Rec0
33941>>>>>>
33941>>>>>>        // Field-based properties.......................
33941>>>>>>
33941>>>>>>        // Branch.Company_Code
33941>>>>>>
33941>>>>>>        // Branch.Branch_Code
33941>>>>>>        Set Field_Options          Field Branch.Branch_Code To DD_AUTOFIND   
33942>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Code To (SL002(Self))
33943>>>>>>        Set Key_Field_State        Field Branch.Branch_Code To TRUE
33944>>>>>>
33944>>>>>>        // Branch.Branch_Rec0
33944>>>>>>
33944>>>>>>        // Branch.Branch_Recr
33944>>>>>>
33944>>>>>>        // Branch.Branch_Name
33944>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Name To (SL002(Self))
33945>>>>>>
33945>>>>>>        // Branch.Branch_Afm
33945>>>>>>
33945>>>>>>        // Branch.Branch_Addr
33945>>>>>>
33945>>>>>>        // Branch.Branch_Tk
33945>>>>>>
33945>>>>>>        // Branch.Branch_Poli
33945>>>>>>
33945>>>>>>        // Branch.Branch_Doy
33945>>>>>>        Set Field_Value_Table      Field Branch.Branch_Doy To (Branch_Branch_Doy_VT(Self))
33946>>>>>>
33946>>>>>>        // Branch.Branch_J_Code
33946>>>>>>
33946>>>>>>        // Branch.Branch_C_Code0
33946>>>>>>        Set Field_Value_Table      Field Branch.Branch_C_Code0 To (Branch_Branch_C_Code0_VT(Self))
33947>>>>>>
33947>>>>>>        // Branch.Branch_C_Code00
33947>>>>>>
33947>>>>>>        // Branch.Branch_C_Coder
33947>>>>>>
33947>>>>>>        // Branch.Branch_Tel
33947>>>>>>
33947>>>>>>        // Branch.Branch_Fax
33947>>>>>>
33947>>>>>>        // Branch.Branch_Email
33947>>>>>>
33947>>>>>>        // Branch.Branch_Resp
33947>>>>>>
33947>>>>>>        // Branch.Branch_Bitmap
33947>>>>>>
33947>>>>>>        // Branch.Branch_Site
33947>>>>>>
33947>>>>>>        // Branch.Branch_Apoth
33947>>>>>>
33947>>>>>>        // Branch.Beto_Site
33947>>>>>>
33947>>>>>>        // Branch.Path_Exp
33947>>>>>>
33947>>>>>>        // Branch.Exp_Txtname
33947>>>>>>
33947>>>>>>        // Branch.Send_Phone
33947>>>>>>
33947>>>>>>        // Branch.Send_Path_Files
33947>>>>>>
33947>>>>>>        // Branch.Send_Path_Conf
33947>>>>>>
33947>>>>>>        // Branch.Tomeas_Code
33947>>>>>>
33947>>>>>>        // Branch.Ftp_Sec_Retry
33947>>>>>>
33947>>>>>>        // Branch.Ftp_Sec_Exit
33947>>>>>>
33947>>>>>>        // Branch.Ras_Name
33947>>>>>>
33947>>>>>>        // Branch.Ras_Passw
33947>>>>>>
33947>>>>>>        // Branch.Ras_Domain
33947>>>>>>
33947>>>>>>        // Branch.Last_Hmnia_Ekt
33947>>>>>>
33947>>>>>>        // Branch.Deop_Logo
33947>>>>>>
33947>>>>>>        // Branch.Entolh
33947>>>>>>
33947>>>>>>        // Branch.Paragogh
33947>>>>>>
33947>>>>>>        // Branch.Locked_Until
33947>>>>>>
33947>>>>>>        // Branch.Sap_Code
33947>>>>>>
33947>>>>>>        // Branch.Perioxh
33947>>>>>>
33947>>>>>>        // Branch.Egkatastash
33947>>>>>>
33947>>>>>>        // Branch.Date_Locked
33947>>>>>>        Set Field_Mask_Type        Field Branch.Date_Locked To MASK_DATE_WINDOW
33948>>>>>>
33948>>>>>>        //DDB-DefineFieldEnd
33948>>>>>>    End_Procedure    // Define_Fields
33949>>>>>>
33949>>>>>>    // Field_Defaults:
33949>>>>>>    // This procedure is used to establish default field values.
33949>>>>>>
33949>>>>>>    Procedure Field_Defaults
33950>>>>>>        Forward Send Field_Defaults
33952>>>>>>        //DDB-Generated-Code-Location
33952>>>>>>        //DDB-FieldDefaultStart
33952>>>>>>        //DDB-FieldDefaultEnd
33952>>>>>>    End_Procedure    // Field_Defaults
33953>>>>>>End_Class    // Branch_DataDictionary
33954>>>>>>
33954>>>>>>//DDB-Selection-pkg-Start
33954>>>>>>
33954>>>>>>Use Sl002.sl         // SL002
INCLUDING FILE: SL002.SL
33954>>>>>>>>//AB/ Project SL002:Branch
33954>>>>>>>>//AB/ Object prj is a Lookup_Project
33954>>>>>>>>//AB/     Set ProjectName to "SL002:Branch"
33954>>>>>>>>//AB/     Set ProjectFileName to "Sl002.sl"
33954>>>>>>>>
33954>>>>>>>>// Project Object Structure
33954>>>>>>>>//   SL002 is a dbModalPanelSub
33954>>>>>>>>//     Company_DD is a DataDictionary
33954>>>>>>>>//     Branch_DD is a DataDictionary
33954>>>>>>>>//     oSelList is a dbListSub
33954>>>>>>>>//     oOK_bn is a ButtonSub
33954>>>>>>>>//     oCancel_bn is a ButtonSub
33954>>>>>>>>//     oSearch_bn is a ButtonSub
33954>>>>>>>>
33954>>>>>>>>// Register all objects
33954>>>>>>>>Register_Object Branch_DD
33954>>>>>>>>Register_Object Company_DD
33954>>>>>>>>Register_Object oCancel_bn
33954>>>>>>>>Register_Object oOK_bn
33954>>>>>>>>Register_Object oSearch_bn
33954>>>>>>>>Register_Object oSelList
33954>>>>>>>>Register_Object SL002
33954>>>>>>>>
33954>>>>>>>>
33954>>>>>>>>//AB-IgnoreStart
33954>>>>>>>>
33954>>>>>>>>Use DFAllEnt.pkg
33954>>>>>>>>Use dbList.Sub
33954>>>>>>>>Use Button.Sub
33954>>>>>>>>
33954>>>>>>>>
33954>>>>>>>>Use COMPANY.DD
33954>>>>>>>>Use BRANCH.DD
33954>>>>>>>>
33954>>>>>>>>//AB-IgnoreEnd
33954>>>>>>>>
33954>>>>>>>>Object SL002 is a dbModalPanelSub
33956>>>>>>>>
33956>>>>>>>>    //AB-StoreTopStart
33956>>>>>>>>    Property String psFragmaCompanyCode  ""
33958>>>>>>>>    
33958>>>>>>>>    //AB-StoreTopEnd
33958>>>>>>>>
33958>>>>>>>>    Set Minimize_Icon to FALSE
33959>>>>>>>>    Set Label to "“§¦¡˜«˜©«ã£˜«˜"
33960>>>>>>>>    Set Size to 146 430
33961>>>>>>>>    Set Location to 4 5
33962>>>>>>>>    Set Exit_Application_Local_State to FALSE
33963>>>>>>>>    Set Modal_State to FALSE
33964>>>>>>>>
33964>>>>>>>>    //AB-DDOStart
33964>>>>>>>>
33964>>>>>>>>    Object Company_DD is a Company_DataDictionary
33966>>>>>>>>    End_Object    // Company_DD
33967>>>>>>>>
33967>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
33969>>>>>>>>        Set DDO_Server to (Company_DD(self))
33970>>>>>>>>
33970>>>>>>>>        //AB-StoreStart
33970>>>>>>>>        Procedure OnConstrain
33972>>>>>>>>             String lsCompanyCode
33973>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
33974>>>>>>>>             If (lsCompanyCode <> "") Constrain Branch.Company_code eq lsCompanyCode
33978>>>>>>>>        End_Procedure // OnConstrain
33979>>>>>>>>        
33979>>>>>>>>        
33979>>>>>>>>        
33979>>>>>>>>        //AB-StoreEnd
33979>>>>>>>>
33979>>>>>>>>    End_Object    // Branch_DD
33980>>>>>>>>
33980>>>>>>>>    Set Main_DD to (Branch_DD(self))
33981>>>>>>>>    Set Server to (Branch_DD(self))
33982>>>>>>>>
33982>>>>>>>>    //AB-DDOEnd
33982>>>>>>>>
33982>>>>>>>>    Object oSelList is a dbListSub
33984>>>>>>>>        Set Main_File to Branch.File_Number
33985>>>>>>>>        Set Size to 105 415
33986>>>>>>>>        Set Location to 6 6
33987>>>>>>>>
33987>>>>>>>>        Begin_Row
33990>>>>>>>>            Entry_Item Branch.Branch_code
33991>>>>>>>>            Entry_Item Branch.Branch_name
33992>>>>>>>>            Entry_Item Company.Company_code
33993>>>>>>>>            Entry_Item Company.Company_name
33994>>>>>>>>            Entry_Item Branch.Beto_site
33995>>>>>>>>            Entry_Item Branch.Branch_recr
33996>>>>>>>>        End_Row
34001>>>>>>>>
34001>>>>>>>>        Set Form_Width    item 0 to 60
34002>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
34003>>>>>>>>        
34003>>>>>>>>        Set Form_Width    item 1 to 128
34004>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜"
34005>>>>>>>>        
34005>>>>>>>>        Set Form_Width    item 2 to 69
34006>>>>>>>>        Set Header_Label  item 2 to "‰à› ¡æª „«˜ ¨å˜ª"
34007>>>>>>>>        
34007>>>>>>>>        Set Form_Width    item 3 to 109
34008>>>>>>>>        Set Header_Label  item 3 to "Ž¤¦£˜ „«˜ ¨å˜ª"
34009>>>>>>>>        
34009>>>>>>>>        Set Form_Width    item 4 to 42
34010>>>>>>>>        Set Header_Label  item 4 to "Site"
34011>>>>>>>>        
34011>>>>>>>>        Set Form_Width    item 5 to 0
34012>>>>>>>>        Set Header_Label  item 5 to ""
34013>>>>>>>>        
34013>>>>>>>>
34013>>>>>>>>        //AB-StoreStart
34013>>>>>>>>                
34013>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
34015>>>>>>>>        
34015>>>>>>>>        Procedure Store_Defaults
34017>>>>>>>>            forward send Store_Defaults
34019>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
34020>>>>>>>>        end_Procedure // Store_Defaults
34021>>>>>>>>        
34021>>>>>>>>        Procedure Restore_Defaults
34023>>>>>>>>            forward send Restore_Defaults
34025>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
34026>>>>>>>>        end_Procedure // Restore_Defaults
34027>>>>>>>>        
34027>>>>>>>>        Procedure Activating
34029>>>>>>>>            Forward Send Activating
34031>>>>>>>>            Send Rebuild_Constraints to (Branch_DD(self))
34032>>>>>>>>        End_Procedure // Activating
34033>>>>>>>>        
34033>>>>>>>>        Set Column_Options Item 5 to NoEnter True
34034>>>>>>>>        
34034>>>>>>>>        
34034>>>>>>>>        //AB-StoreEnd
34034>>>>>>>>
34034>>>>>>>>    End_Object    // oSelList
34035>>>>>>>>
34035>>>>>>>>    Object oOK_bn is a ButtonSub
34037>>>>>>>>        Set Label to "&„§ ¢¦šã"
34038>>>>>>>>        Set Location to 112 262
34039>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34040>>>>>>>>
34040>>>>>>>>        //AB-StoreStart
34040>>>>>>>>        Procedure OnClick
34042>>>>>>>>            Send OK To (oSelList(current_object))
34043>>>>>>>>        End_Procedure
34044>>>>>>>>        //AB-StoreEnd
34044>>>>>>>>
34044>>>>>>>>    End_Object    // oOK_bn
34045>>>>>>>>
34045>>>>>>>>    Object oCancel_bn is a ButtonSub
34047>>>>>>>>        Set Label to "&€¡ç¨à©ž"
34048>>>>>>>>        Set Location to 112 317
34049>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34050>>>>>>>>
34050>>>>>>>>        //AB-StoreStart
34050>>>>>>>>        Procedure OnClick
34052>>>>>>>>            Send Cancel To (oSelList(current_object))
34053>>>>>>>>        End_Procedure
34054>>>>>>>>        //AB-StoreEnd
34054>>>>>>>>
34054>>>>>>>>    End_Object    // oCancel_bn
34055>>>>>>>>
34055>>>>>>>>    Object oSearch_bn is a ButtonSub
34057>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
34058>>>>>>>>        Set Location to 112 372
34059>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34060>>>>>>>>
34060>>>>>>>>        //AB-StoreStart
34060>>>>>>>>        Procedure OnClick
34062>>>>>>>>            Send Search To (oSelList(current_object))
34063>>>>>>>>        End_Procedure
34064>>>>>>>>        //AB-StoreEnd
34064>>>>>>>>
34064>>>>>>>>    End_Object    // oSearch_bn
34065>>>>>>>>
34065>>>>>>>>
34065>>>>>>>>    //AB-StoreStart
34065>>>>>>>>    
34065>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
34066>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
34067>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
34068>>>>>>>>    
34068>>>>>>>>    
34068>>>>>>>>    
34068>>>>>>>>    //AB-StoreEnd
34068>>>>>>>>
34068>>>>>>>>End_Object    // SL002
34069>>>>>>>>
34069>>>>>>>>//AB/ End_Object    // prj
34069>>>>>>
34069>>>>>>//DDB-Selection-pkg-End
34069>>>>>>//DDB-FileEnd
34069>>>>Use YEAR.DD
INCLUDING FILE: YEAR.DD
34069>>>>>>//DDB-FileStart
34069>>>>>>//DDB-HeaderStart
34069>>>>>>
34069>>>>>>// File Name : YEAR.DD
34069>>>>>>// Class Name: Year_DataDictionary
34069>>>>>>// Revision  : 119
34069>>>>>>// Version   : 2
34069>>>>>>
34069>>>>>>Use  Windows           // Basic Definitions
34069>>>>>>Use  DataDict          // DataDictionary Class Definition
34069>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
34069>>>>>>
34069>>>>>>Open Year
34071>>>>>>Open Branch
34073>>>>>>Open Syscurxr
34075>>>>>>
34075>>>>>>//DDB-HeaderEnd
34075>>>>>>//DDB-ValidationStart
34075>>>>>>
34075>>>>>>Register_Object Year_Year_C_Code0_VT1
34075>>>>>>Register_Object Year_Year_C_Code00_VT1
34075>>>>>>Register_Object Year_Year_C_Coder_VT1
34075>>>>>>
34075>>>>>>Object Year_Year_C_Code0_VT1  is a CodeValidationTable
34077>>>>>>    Set Type_Value        To "CURRENCY"
34078>>>>>>    //DDB-ValidationCustomStart
34078>>>>>>    //DDB-ValidationCustomEnd
34078>>>>>>End_Object   // Year_Year_C_Code0_VT1
34079>>>>>>
34079>>>>>>Object Year_Year_C_Code00_VT1  is a CodeValidationTable
34081>>>>>>    Set Type_Value        To "CURRENCY"
34082>>>>>>    //DDB-ValidationCustomStart
34082>>>>>>    //DDB-ValidationCustomEnd
34082>>>>>>End_Object   // Year_Year_C_Code00_VT1
34083>>>>>>
34083>>>>>>Object Year_Year_C_Coder_VT1  is a CodeValidationTable
34085>>>>>>    Set Type_Value        To "CURRENCY"
34086>>>>>>    //DDB-ValidationCustomStart
34086>>>>>>    //DDB-ValidationCustomEnd
34086>>>>>>End_Object   // Year_Year_C_Coder_VT1
34087>>>>>>//DDB-ValidationEnd
34087>>>>>>//DDB-SelectionStart
34087>>>>>>//DDB/ ExternalSelectionList SL003  Sl003.sl
34087>>>>>>Register_Object SL003
34087>>>>>>//DDB-SelectionEnd
34087>>>>>>            
34087>>>>>>Class Year_DataDictionary  is a DataDictionary
34088>>>>>>    
34088>>>>>>    Procedure Creating
34089>>>>>>        Forward Send Creating
34091>>>>>>        // Insert Code Here
34091>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Year.Year_Year)))))) to Year.Year_Recr
34092>>>>>>    End_Procedure   // Creating
34093>>>>>>
34093>>>>>>
34093>>>>>>    // Operation_Not_Allowed:
34093>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
34094>>>>>>        // Insert Code Here
34094>>>>>>        Case Begin    
34094>>>>>>             Case (iError_Num = 1001)
34096>>>>>>                  Error 1001 "DDC 053:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
34097>>>>>>>
34097>>>>>>             Case Break
34098>>>>>>             Case (iError_Num=1002)
34101>>>>>>                Error 1002 "DDC 053:Branch Site ¡˜«œ™˜å¤œ  ©«¦ Year ¡œ¤æ"
34102>>>>>>>
34102>>>>>>             Case Break
34103>>>>>>             Case (iError_Num=1003)
34106>>>>>>                Error 1003 "DDC 053:Company Code=0"
34107>>>>>>>
34107>>>>>>             Case Break
34108>>>>>>             Case (iError_Num=1004)
34111>>>>>>                Error 1004 "DDC 053:Branch Code=0"
34112>>>>>>>
34112>>>>>>             Case Break
34113>>>>>>             Case Else
34113>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
34115>>>>>>        Case End
34115>>>>>>    End_Procedure   // Operation_Not_Allowed
34116>>>>>>
34116>>>>>>
34116>>>>>>    // Update:
34116>>>>>>    // Use this message to effect changes in related-to files. The
34116>>>>>>    // Backout message should be designed to reverse the effects of this
34116>>>>>>    // message. It is invoked while the database is locked.
34116>>>>>>
34116>>>>>>    Procedure Update
34117>>>>>>        Forward Send Update
34119>>>>>>        // Insert Code Here
34119>>>>>>        Move Company.Company_Code   to Year.Company_Code
34120>>>>>>        Move Branch.Branch_Code     to Year.Branch_Code
34121>>>>>>        move branch.beto_site       to year.beto_site
34122>>>>>>
34122>>>>>>        //sos:parametrika apo sysfile?
34122>>>>>>       
34122>>>>>>       // If ((Year.Year_EntryDate-14) < Year.Year_XrhshFrom) Begin
34122>>>>>>       //     Move Year.Year_XrhshFrom to Year.Year_OpenFrom
34122>>>>>>       // End
34122>>>>>>       // Else Begin
34122>>>>>>       //     Move (Year.Year_EntryDate-14) to Year.Year_OpenFrom
34122>>>>>>       // End
34122>>>>>>      //  Move Year.Year_EntryDate      to Year.Year_OpenTo
34122>>>>>>    End_Procedure   // Update
34123>>>>>>
34123>>>>>>    // Validate_Save:
34123>>>>>>
34123>>>>>>    Function Validate_Save  Returns Integer
34124>>>>>>        Local Integer iReturnVal
34125>>>>>>        Forward Get Validate_Save  To iReturnVal
34127>>>>>>        If (Not(iReturnVal)) Begin
34129>>>>>>                 If (Year.Year_Year   = 0) Send Operation_Not_Allowed 1001
34132>>>>>>            Else If (Year.Company_Code='') Send Operation_Not_Allowed 1003
34136>>>>>>            Else If (Year.Branch_Code ='') Send Operation_Not_Allowed 1004
34140>>>>>>        End
34140>>>>>>>
34140>>>>>>        Function_Return iReturnVal
34141>>>>>>    End_Function   // Validate_Save
34142>>>>>>
34142>>>>>>
34142>>>>>>    // Define_Fields:
34142>>>>>>    // This procedure is used to set up all data-dictionary rules.
34142>>>>>>
34142>>>>>>    Procedure Define_Fields
34143>>>>>>        Forward Send Define_Fields
34145>>>>>>        //DDB-Generated-Code-Location
34145>>>>>>        //DDB-DefineFieldStart
34145>>>>>>
34145>>>>>>        Set Main_File            To Year.File_Number
34146>>>>>>        Set Cascade_Delete_State To FALSE
34147>>>>>>
34147>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
34148>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
34149>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
34150>>>>>>
34150>>>>>>        // Parent (Server) file structure...............
34150>>>>>>        Send Add_Server_File  Branch.File_Number
34151>>>>>>
34151>>>>>>        // External (System) file structure.............
34151>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
34152>>>>>>
34152>>>>>>        // Field-based properties.......................
34152>>>>>>
34152>>>>>>        // Year.Company_Code
34152>>>>>>
34152>>>>>>        // Year.Branch_Code
34152>>>>>>
34152>>>>>>        // Year.Year_Year
34152>>>>>>        Set Field_Options          Field Year.Year_Year To DD_AUTOFIND    DD_REQUIRED   
34153>>>>>>        Set Field_Prompt_Object    Field Year.Year_Year To (SL003(Self))
34154>>>>>>        Set Key_Field_State        Field Year.Year_Year To TRUE
34155>>>>>>
34155>>>>>>        // Year.Year_Recr
34155>>>>>>        Set Field_Prompt_Object    Field Year.Year_Recr To (SL003(Self))
34156>>>>>>
34156>>>>>>        // Year.Branch_Recr
34156>>>>>>
34156>>>>>>        // Year.Year_Descr
34156>>>>>>
34156>>>>>>        // Year.Year_Isolfrom
34156>>>>>>
34156>>>>>>        // Year.Year_Isolto
34156>>>>>>
34156>>>>>>        // Year.Year_Openfrom
34156>>>>>>
34156>>>>>>        // Year.Year_Opento
34156>>>>>>
34156>>>>>>        // Year.Year_Entrydate
34156>>>>>>
34156>>>>>>        // Year.Year_Dateaa
34156>>>>>>
34156>>>>>>        // Year.Year_Xrhshfrom
34156>>>>>>
34156>>>>>>        // Year.Year_Xrhshto
34156>>>>>>
34156>>>>>>        // Year.Year_Myflimit
34156>>>>>>
34156>>>>>>        // Year.Year_Numgtypkin
34156>>>>>>
34156>>>>>>        // Year.Year_Numgarticl
34156>>>>>>
34156>>>>>>        // Year.Year_Numgmove
34156>>>>>>
34156>>>>>>        // Year.Year_Numgplan
34156>>>>>>
34156>>>>>>        // Year.Year_Numgformat
34156>>>>>>
34156>>>>>>        // Year.Year_Numgthaa
34156>>>>>>
34156>>>>>>        // Year.Year_Numgopen
34156>>>>>>
34156>>>>>>        // Year.Year_Numbtypkin
34156>>>>>>
34156>>>>>>        // Year.Year_Numbaxio
34156>>>>>>
34156>>>>>>        // Year.Year_Numbarticl
34156>>>>>>
34156>>>>>>        // Year.Year_Numbmove
34156>>>>>>
34156>>>>>>        // Year.Year_Delimiter
34156>>>>>>
34156>>>>>>        // Year.Year_Printer
34156>>>>>>
34156>>>>>>        // Year.Year_Valid_Char
34156>>>>>>
34156>>>>>>        // Year.Year_C_Code0
34156>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0 To "dbComboFormSub"
34157>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code0 To (Year_Year_C_Code0_VT1(Self))
34158>>>>>>
34158>>>>>>        // Year.Year_C_Code00
34158>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00 To "dbComboFormSub"
34159>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code00 To (Year_Year_C_Code00_VT1(Self))
34160>>>>>>
34160>>>>>>        // Year.Year_C_Coder
34160>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder To "dbComboFormSub"
34161>>>>>>        Set Field_Value_Table      Field Year.Year_C_Coder To (Year_Year_C_Coder_VT1(Self))
34162>>>>>>
34162>>>>>>        // Year.Beto_Site
34162>>>>>>
34162>>>>>>        // Year.Clients_Plafon
34162>>>>>>
34162>>>>>>        // Year.Payresp_Plafon
34162>>>>>>
34162>>>>>>        // Year.Clients_Ofeilh
34162>>>>>>
34162>>>>>>        // Year.Payresp_Ofeilh
34162>>>>>>
34162>>>>>>        // Year.Working
34162>>>>>>
34162>>>>>>        //DDB-DefineFieldEnd
34162>>>>>>
34162>>>>>>        Set Main_File            To Year.File_Number
34163>>>>>>        Set Cascade_Delete_State To FALSE
34164>>>>>>
34164>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
34165>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
34166>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
34167>>>>>>
34167>>>>>>        // Child (Client) file structure................
34167>>>>>>
34167>>>>>>        // Parent (Server) file structure...............
34167>>>>>>        Send Add_Server_File  Branch.File_Number
34168>>>>>>
34168>>>>>>        // Field-based properties.......................
34168>>>>>>
34168>>>>>>        // Year.Company_Code
34168>>>>>>
34168>>>>>>        // Year.Branch_Code
34168>>>>>>
34168>>>>>>        // Year.Year_Year
34168>>>>>>        Set Field_Label_Long       Field Year.Year_Year           To "•¨ã©ž"
34169>>>>>>        Set Field_Label_Short      Field Year.Year_Year           To "•¨ã©ž"
34170>>>>>>        Set Field_Options          Field Year.Year_Year           To DD_REQUIRED
34171>>>>>>        //Set Field_Prompt_Object    Field Year.Year_Year           To (SL053(Self))
34171>>>>>>
34171>>>>>>        // Year.Year_Descr
34171>>>>>>        Set Field_Label_Long       Field Year.Year_Descr          To "œ¨ š¨˜­ã •¨ã©žª"
34172>>>>>>        Set Field_Label_Short      Field Year.Year_Descr          To "œ¨.•¨ã©žª"
34173>>>>>>
34173>>>>>>        // Year.Year_C_Code0
34173>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0        To "dbComboForm"
34174>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code0        To "‰ç¨ ¦ Œæ£ ©£˜"
34175>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code0        To "‰¬¨.Œ¦£ ©£˜"
34176>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code0        To (Year_Year_C_Code0_VT(Self))
34176>>>>>>
34176>>>>>>        // Year.Year_C_Code00
34176>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00       To "dbComboForm"
34177>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
34178>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
34179>>>>>>        //Set Field_Options          Field Year.Year_C_Code00       To DD_REQUIRED
34179>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code00       To (Year_Year_C_Code1_VT(Self))
34179>>>>>>
34179>>>>>>        // Year.Year_C_Coder
34179>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder        To "dbComboForm"
34180>>>>>>        Set Field_Label_Long       Field Year.Year_C_Coder        To "Œæ£ ©£˜ REPORTING"
34181>>>>>>        Set Field_Label_Short      Field Year.Year_C_Coder        To "Œæ£ ©£˜ REP"
34182>>>>>>        //Set Field_Options          Field Year.Year_C_Coder        To DD_REQUIRED
34182>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Coder        To (Year_Year_C_Coder_VT(Self))
34182>>>>>>
34182>>>>>>        // Year.Year_Isolfrom
34182>>>>>>        Set Field_Label_Long       Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
34183>>>>>>        Set Field_Label_Short      Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
34184>>>>>>
34184>>>>>>        // Year.Year_Isolto
34184>>>>>>        Set Field_Label_Long       Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
34185>>>>>>        Set Field_Label_Short      Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
34186>>>>>>
34186>>>>>>        // Year.Year_Openfrom
34186>>>>>>        Set Field_Label_Long       Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
34187>>>>>>        Set Field_Label_Short      Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
34188>>>>>>
34188>>>>>>        // Year.Year_Opento
34188>>>>>>        Set Field_Label_Long       Field Year.Year_Opento         To "„šš¨˜­âª „àª"
34189>>>>>>        Set Field_Label_Short      Field Year.Year_Opento         To "„šš¨˜­âª „àª"
34190>>>>>>
34190>>>>>>        // Year.Year_Entrydate
34190>>>>>>        Set Field_Label_Long       Field Year.Year_Entrydate      To "†£œ¨¦£ž¤å˜ „¨š˜©å˜ª"
34191>>>>>>        Set Field_Label_Short      Field Year.Year_Entrydate      To "†£/¤å˜ „¨š˜©å˜ª"
34192>>>>>>
34192>>>>>>        // Year.Year_Dateaa
34192>>>>>>
34192>>>>>>        // Year.Year_Xrhshfrom
34192>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
34193>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
34194>>>>>>
34194>>>>>>        // Year.Year_Xrhshto
34194>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
34195>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
34196>>>>>>
34196>>>>>>        // Year.Year_Myflimit
34196>>>>>>        Set Field_Label_Long       Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
34197>>>>>>        Set Field_Label_Short      Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
34198>>>>>>
34198>>>>>>        // Year.Year_Numgtypkin
34198>>>>>>        Set Field_Options          Field Year.Year_Numgtypkin     To DD_DISPLAYONLY
34199>>>>>>
34199>>>>>>        // Year.Year_Numgarticl
34199>>>>>>        Set Field_Options          Field Year.Year_Numgarticl     To DD_DISPLAYONLY
34200>>>>>>
34200>>>>>>        // Year.Year_Numgmove
34200>>>>>>        Set Field_Options          Field Year.Year_Numgmove       To DD_DISPLAYONLY
34201>>>>>>
34201>>>>>>        // Year.Year_Numgplan
34201>>>>>>        Set Field_Options          Field Year.Year_Numgplan       To DD_DISPLAYONLY
34202>>>>>>
34202>>>>>>        // Year.Year_Numgformat
34202>>>>>>        Set Field_Options          Field Year.Year_Numgformat     To DD_DISPLAYONLY
34203>>>>>>
34203>>>>>>        // Year.Year_Numgthaa
34203>>>>>>        Set Field_Options          Field Year.Year_Numgthaa       To DD_DISPLAYONLY
34204>>>>>>
34204>>>>>>        // Year.Year_Numgopen
34204>>>>>>        Set Field_Options          Field Year.Year_Numgopen       To DD_DISPLAYONLY
34205>>>>>>
34205>>>>>>        // Year.Year_Numbaxio
34205>>>>>>        Set Field_Options          Field Year.Year_Numbaxio       To DD_DISPLAYONLY
34206>>>>>>
34206>>>>>>        // Year.Year_Numbarticl
34206>>>>>>        Set Field_Options          Field Year.Year_Numbarticl     To DD_DISPLAYONLY
34207>>>>>>
34207>>>>>>        // Year.Year_Numbmove
34207>>>>>>        Set Field_Options          Field Year.Year_Numbmove       To DD_DISPLAYONLY
34208>>>>>>
34208>>>>>>        // Year.Year_Delimiter
34208>>>>>>        Set Status_Help            Field Year.Year_Delimiter      To "ƒ ˜®à¨ ©« ¡æ š ˜ «¦ Š‘ «žª •¨ã©œàª"
34209>>>>>>
34209>>>>>>        // Year.Year_Printer
34209>>>>>>
34209>>>>>>        // Year.Year_Valid_Char
34209>>>>>>
34209>>>>>>    End_Procedure    // Define_Fields
34210>>>>>>
34210>>>>>>    // Field_Defaults:
34210>>>>>>    // This procedure is used to establish default field values.
34210>>>>>>
34210>>>>>>    Procedure Field_Defaults
34211>>>>>>        Forward Send Field_Defaults
34213>>>>>>        //DDB-Generated-Code-Location
34213>>>>>>        //DDB-FieldDefaultStart
34213>>>>>>        //DDB-FieldDefaultEnd
34213>>>>>>        Set Field_Changed_Value   Field Year.Year_Delimiter      To "."
34214>>>>>>        Set Field_Changed_Value   Field Year.Year_Printer        To "LPT1:"
34215>>>>>>        Set Field_Changed_Value   Field Year.Year_Valid_Char     To "1234567890"
34216>>>>>>    End_Procedure    // Field_Defaults
34217>>>>>>
34217>>>>>>End_Class    // Year_DataDictionary
34218>>>>>>//DDB-Selection-pkg-Start
34218>>>>>>
34218>>>>>>Use Sl003.sl         // SL003
INCLUDING FILE: SL003.SL
34218>>>>>>>>//AB/ Project SL003:Year
34218>>>>>>>>//AB/ Object prj is a Lookup_Project
34218>>>>>>>>//AB/     Set ProjectName to "SL003:Year"
34218>>>>>>>>//AB/     Set ProjectFileName to "Sl003.sl"
34218>>>>>>>>
34218>>>>>>>>// Project Object Structure
34218>>>>>>>>//   SL003 is a dbModalPanelSub
34218>>>>>>>>//     Company_DD is a DataDictionary
34218>>>>>>>>//     Branch_DD is a DataDictionary
34218>>>>>>>>//     Year_DD is a DataDictionary
34218>>>>>>>>//     oSelList is a dbListSub
34218>>>>>>>>//     oOK_bn is a ButtonSub
34218>>>>>>>>//     oCancel_bn is a ButtonSub
34218>>>>>>>>//     oSearch_bn is a ButtonSub
34218>>>>>>>>
34218>>>>>>>>// Register all objects
34218>>>>>>>>Register_Object Branch_DD
34218>>>>>>>>Register_Object Company_DD
34218>>>>>>>>Register_Object oCancel_bn
34218>>>>>>>>Register_Object oOK_bn
34218>>>>>>>>Register_Object oSearch_bn
34218>>>>>>>>Register_Object oSelList
34218>>>>>>>>Register_Object SL003
34218>>>>>>>>Register_Object Year_DD
34218>>>>>>>>
34218>>>>>>>>
34218>>>>>>>>//AB-IgnoreStart
34218>>>>>>>>
34218>>>>>>>>Use DFAllEnt.pkg
34218>>>>>>>>Use dbList.Sub
34218>>>>>>>>Use Button.Sub
34218>>>>>>>>
34218>>>>>>>>
34218>>>>>>>>Use COMPANY.DD
34218>>>>>>>>Use BRANCH.DD
34218>>>>>>>>Use YEAR.DD
34218>>>>>>>>
34218>>>>>>>>//AB-IgnoreEnd
34218>>>>>>>>
34218>>>>>>>>CD_Popup_Object SL003 is a dbModalPanelSub
34237>>>>>>>>
34237>>>>>>>>    //AB-StoreTopStart
34237>>>>>>>>    Property String psFragmaCompanyCode  ""
34239>>>>>>>>    Property String psFragmaBranchCode   ""
34241>>>>>>>>    property integer pifragmaactive public 0
34243>>>>>>>>    //AB-StoreTopEnd
34243>>>>>>>>
34243>>>>>>>>    Set Minimize_Icon to FALSE
34244>>>>>>>>    Set Label to "•¨ã©œ ª"
34245>>>>>>>>    Set Size to 149 449
34246>>>>>>>>    Set Location to 4 7
34247>>>>>>>>    Set Exit_Application_Local_State to FALSE
34248>>>>>>>>    Set Modal_State to FALSE
34249>>>>>>>>
34249>>>>>>>>    //AB-DDOStart
34249>>>>>>>>
34249>>>>>>>>    Object Company_DD is a Company_DataDictionary
34251>>>>>>>>    End_Object    // Company_DD
34252>>>>>>>>
34252>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
34254>>>>>>>>        Set DDO_Server to (Company_DD(self))
34255>>>>>>>>    End_Object    // Branch_DD
34256>>>>>>>>
34256>>>>>>>>    Object Year_DD is a Year_DataDictionary
34258>>>>>>>>        Set DDO_Server to (Branch_DD(self))
34259>>>>>>>>
34259>>>>>>>>        //AB-StoreStart
34259>>>>>>>>        Procedure OnConstrain
34261>>>>>>>>             String lsCompanyCode lsBranchCode
34262>>>>>>>>             integer iactive
34262>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
34263>>>>>>>>             get pifragmaactive to iactive
34264>>>>>>>>             If (lsCompanyCode <> "") Begin
34266>>>>>>>>                Get psFragmaBranchCode  to lsBranchCode
34267>>>>>>>>                Constrain Year.Company_Code eq lsCompanyCode
34269>>>>>>>>                If (lsBranchCode <> "") Constrain Year.Branch_code eq lsBranchCode
34273>>>>>>>>             End
34273>>>>>>>>>
34273>>>>>>>>             if (iactive = 0) constrain year.working ne 1
34277>>>>>>>>        End_Procedure // OnConstrain
34278>>>>>>>>        
34278>>>>>>>>        
34278>>>>>>>>        
34278>>>>>>>>        
34278>>>>>>>>        
34278>>>>>>>>        //AB-StoreEnd
34278>>>>>>>>
34278>>>>>>>>    End_Object    // Year_DD
34279>>>>>>>>
34279>>>>>>>>    Set Main_DD to (Year_DD(self))
34280>>>>>>>>    Set Server to (Year_DD(self))
34281>>>>>>>>
34281>>>>>>>>    //AB-DDOEnd
34281>>>>>>>>
34281>>>>>>>>    Object oSelList is a dbListSub
34283>>>>>>>>        Set Main_File to Year.File_Number
34284>>>>>>>>        Set Size to 105 433
34285>>>>>>>>        Set Location to 6 6
34286>>>>>>>>
34286>>>>>>>>        Begin_Row
34289>>>>>>>>            Entry_Item Year.Year_year
34290>>>>>>>>            Entry_Item Company.Company_code
34291>>>>>>>>            Entry_Item Company.Company_name
34292>>>>>>>>            Entry_Item Branch.Branch_code
34293>>>>>>>>            Entry_Item Branch.Branch_name
34294>>>>>>>>        End_Row
34299>>>>>>>>
34299>>>>>>>>        Set Form_Width    item 0 to 36
34300>>>>>>>>        Set Header_Label  item 0 to "•¨ã©ž :          "
34301>>>>>>>>        
34301>>>>>>>>        Set Form_Width    item 1 to 71
34302>>>>>>>>        Set Header_Label  item 1 to "‰à› ¡æª „«˜ ¨å˜ª"
34303>>>>>>>>        
34303>>>>>>>>        Set Form_Width    item 2 to 136
34304>>>>>>>>        Set Header_Label  item 2 to "Ž¤¦£˜ „«˜ ¨å˜ª"
34305>>>>>>>>        
34305>>>>>>>>        Set Form_Width    item 3 to 73
34306>>>>>>>>        Set Header_Label  item 3 to "‰à› ¡æª “§¦¡/«¦ª"
34307>>>>>>>>        
34307>>>>>>>>        Set Form_Width    item 4 to 109
34308>>>>>>>>        Set Header_Label  item 4 to "Ž¤¦£˜ “§¦¡/«¦ª"
34309>>>>>>>>        
34309>>>>>>>>
34309>>>>>>>>        //AB-StoreStart
34309>>>>>>>>                                                
34309>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
34311>>>>>>>>        Property String psStoreFragmaBranchCode   ""
34313>>>>>>>>        
34313>>>>>>>>        Procedure Store_Defaults
34315>>>>>>>>            forward send Store_Defaults
34317>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
34318>>>>>>>>            Set psStoreFragmaBranchCode  to (psFragmaBranchCode(Self))
34319>>>>>>>>        end_Procedure // Store_Defaults
34320>>>>>>>>        
34320>>>>>>>>        Procedure Restore_Defaults
34322>>>>>>>>            forward send Restore_Defaults
34324>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
34325>>>>>>>>            Set psFragmaBranchCode  to (psStoreFragmaBranchCode(self))
34326>>>>>>>>        end_Procedure // Restore_Defaults
34327>>>>>>>>        
34327>>>>>>>>        Procedure Activating
34329>>>>>>>>            Forward Send Activating
34331>>>>>>>>            Send Rebuild_Constraints to (Year_DD(self))
34332>>>>>>>>        End_Procedure // Activating
34333>>>>>>>>        
34333>>>>>>>>        
34333>>>>>>>>        
34333>>>>>>>>        //AB-StoreEnd
34333>>>>>>>>
34333>>>>>>>>    End_Object    // oSelList
34334>>>>>>>>
34334>>>>>>>>    Object oOK_bn is a ButtonSub
34336>>>>>>>>        Set Label to "&„§ ¢¦šã"
34337>>>>>>>>        Set Location to 112 280
34338>>>>>>>>
34338>>>>>>>>        //AB-StoreStart
34338>>>>>>>>        Procedure OnClick
34340>>>>>>>>            Send OK To (oSelList(current_object))
34341>>>>>>>>        End_Procedure
34342>>>>>>>>        //AB-StoreEnd
34342>>>>>>>>
34342>>>>>>>>    End_Object    // oOK_bn
34343>>>>>>>>
34343>>>>>>>>    Object oCancel_bn is a ButtonSub
34345>>>>>>>>        Set Label to "&€¡ç¨à©ž"
34346>>>>>>>>        Set Location to 112 335
34347>>>>>>>>
34347>>>>>>>>        //AB-StoreStart
34347>>>>>>>>        Procedure OnClick
34349>>>>>>>>            Send Cancel To (oSelList(current_object))
34350>>>>>>>>        End_Procedure
34351>>>>>>>>        //AB-StoreEnd
34351>>>>>>>>
34351>>>>>>>>    End_Object    // oCancel_bn
34352>>>>>>>>
34352>>>>>>>>    Object oSearch_bn is a ButtonSub
34354>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
34355>>>>>>>>        Set Location to 112 390
34356>>>>>>>>
34356>>>>>>>>        //AB-StoreStart
34356>>>>>>>>        Procedure OnClick
34358>>>>>>>>            Send Search To (oSelList(current_object))
34359>>>>>>>>        End_Procedure
34360>>>>>>>>        //AB-StoreEnd
34360>>>>>>>>
34360>>>>>>>>    End_Object    // oSearch_bn
34361>>>>>>>>
34361>>>>>>>>
34361>>>>>>>>    //AB-StoreStart
34361>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
34362>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
34363>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
34364>>>>>>>>    
34364>>>>>>>>    
34364>>>>>>>>    
34364>>>>>>>>    //AB-StoreEnd
34364>>>>>>>>
34364>>>>>>>>CD_End_Object    // SL003
34366>>>>>>>>>
34366>>>>>>>>
34366>>>>>>>>//AB/ End_Object    // prj
34366>>>>>>
34366>>>>>>//DDB-Selection-pkg-End
34366>>>>>>//DDB-FileEnd
34366>>>>
34366>>>>//AB-IgnoreEnd
34366>>>>
34366>>>>Object oSelectYear is a dbModalPanelSub
34368>>>>
34368>>>>    //AB-StoreTopStart
34368>>>>    
34368>>>>    Property String  psSelectedYearRecr  ''
34370>>>>    Property Integer piChangeState False
34372>>>>    
34372>>>>    //AB-StoreTopEnd
34372>>>>
34372>>>>    Set Minimize_Icon to FALSE
34373>>>>    Set Label to "„§ ¢¦šã „«˜ ¨œå˜ª - “§¦¡˜«˜©«ã£˜«¦ª - •¨ã©žª"
34374>>>>    Set Size to 111 372
34375>>>>    Set Location to 60 40
34376>>>>    Set Color to 12232306
34377>>>>
34377>>>>    //AB-DDOStart
34377>>>>
34377>>>>    Object Company_DD is a Company_DataDictionary
34379>>>>
34379>>>>        //AB-StoreStart
34379>>>>        Set Foreign_Field_Options DD_KEYFIELD                   to DD_Clear_Field_Options DD_FindReq
34380>>>>        Set Foreign_Field_Options DD_INDEXFIELD                 to DD_Clear_Field_Options DD_FindReq
34381>>>>        Set Foreign_Field_Options Field Company.Company_Name    to DD_DisplayOnly
34382>>>>        
34382>>>>        
34382>>>>        
34382>>>>        //AB-StoreEnd
34382>>>>
34382>>>>    End_Object    // Company_DD
34383>>>>
34383>>>>    Object Branch_DD is a Branch_DataDictionary
34385>>>>        Set DDO_Server to (Company_DD(self))
34386>>>>
34386>>>>        //AB-StoreStart
34386>>>>        Set Foreign_Field_Options DD_KEYFIELD   to DD_Clear_Field_Options DD_FindReq
34387>>>>        Set Foreign_Field_Options DD_INDEXFIELD to DD_Clear_Field_Options DD_FindReq
34388>>>>        
34388>>>>        Set Foreign_Field_Options DD_KEYFIELD   to DD_AutoFind_GE
34389>>>>        Set Foreign_Field_Options DD_INDEXFIELD to DD_AutoFind_GE
34390>>>>        
34390>>>>        Set Foreign_Field_Options Field Branch.Branch_Name to DD_DisplayOnly
34391>>>>        //AB-StoreEnd
34391>>>>
34391>>>>    End_Object    // Branch_DD
34392>>>>
34392>>>>    Object Year_DD is a Year_DataDictionary
34394>>>>        Set DDO_Server to (Branch_DD(self))
34395>>>>
34395>>>>        //AB-StoreStart
34395>>>>        
34395>>>>        Set Field_Options Field Year.Year_Descr to DD_DisplayOnly
34396>>>>        Set Field_Options Field Year.Year_Year to DD_AutoFind_GE
34397>>>>        
34397>>>>        Function Validate_Delete Returns Integer
34399>>>>            Function_Return 1
34400>>>>        End_Function
34401>>>>        
34401>>>>        //AB-StoreEnd
34401>>>>
34401>>>>    End_Object    // Year_DD
34402>>>>
34402>>>>    Set Main_DD to (Year_DD(self))
34403>>>>    Set Server to (Year_DD(self))
34404>>>>
34404>>>>    //AB-DDOEnd
34404>>>>
34404>>>>    Object Company_Company_Code is a dbFormSub
34406>>>>        Entry_Item Company.Company_code
34407>>>>        Set Size to 13 71
34408>>>>        Set Location to 9 112
34409>>>>        Set Color to 12232306
34410>>>>        Set Label_Col_Offset to 2
34411>>>>        Set Label_Justification_Mode to jMode_Right
34412>>>>        Set Prompt_Button_Mode to pb_PromptOn
34413>>>>        Set Auto_Clear_Deo_State to FALSE
34414>>>>        Set Enabled_State to FALSE
34415>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34416>>>>        Set Item_Shadow_State Item 0 to TRUE
34417>>>>        Set Shadow_State Item 0 to TRUE
34418>>>>
34418>>>>        //AB-StoreStart
34418>>>>        
34418>>>>        Set Prompt_Object to (sl001(Self))
34419>>>>        
34419>>>>        
34419>>>>        //AB-StoreEnd
34419>>>>
34419>>>>    End_Object    // Company_Company_Code
34420>>>>
34420>>>>    Object Company_Company_Name is a dbFormSub
34422>>>>        Entry_Item Company.Company_name
34423>>>>        Set Size to 13 168
34424>>>>        Set Location to 9 188
34425>>>>        Set Color to 12232306
34426>>>>        Set Label_Col_Offset to 2
34427>>>>        Set Label_Justification_Mode to jMode_Right
34428>>>>        Set Enabled_State to FALSE
34429>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34430>>>>        Set Item_Shadow_State Item 0 to TRUE
34431>>>>        Set Shadow_State Item 0 to TRUE
34432>>>>
34432>>>>        //AB-StoreStart
34432>>>>        
34432>>>>        //AB-StoreEnd
34432>>>>
34432>>>>    End_Object    // Company_Company_Name
34433>>>>
34433>>>>    Object Branch_Branch_Code is a dbFormSub
34435>>>>        Entry_Item Branch.Branch_code
34436>>>>        Set Size to 13 71
34437>>>>        Set Location to 23 112
34438>>>>        Set Color to 12232306
34439>>>>        Set Label_Col_Offset to 2
34440>>>>        Set Label_Justification_Mode to jMode_Right
34441>>>>        Set Prompt_Button_Mode to pb_PromptOn
34442>>>>        Set Auto_Clear_Deo_State to FALSE
34443>>>>        Set Enabled_State to FALSE
34444>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34445>>>>        Set Item_Shadow_State Item 0 to TRUE
34446>>>>        Set Shadow_State Item 0 to TRUE
34447>>>>
34447>>>>        //AB-StoreStart
34447>>>>        Set Prompt_Object to (sl002(Self))
34448>>>>        
34448>>>>        Procedure Prompt_CallBack Integer hPrompt
34450>>>>            string lsCompanyCode
34451>>>>            Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
34452>>>>            Set psFragmaCompanyCode of hPrompt to lsCompanyCode
34453>>>>        End_Procedure
34454>>>>        
34454>>>>        
34454>>>>        
34454>>>>        
34454>>>>        //AB-StoreEnd
34454>>>>
34454>>>>    End_Object    // Branch_Branch_Code
34455>>>>
34455>>>>    Object Branch_Branch_Name is a dbFormSub
34457>>>>        Entry_Item Branch.Branch_name
34458>>>>        Set Size to 13 168
34459>>>>        Set Location to 23 188
34460>>>>        Set Color to 12232306
34461>>>>        Set Label_Justification_Mode to jMode_Right
34462>>>>        Set Enabled_State to FALSE
34463>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34464>>>>        Set Item_Shadow_State Item 0 to TRUE
34465>>>>        Set Shadow_State Item 0 to TRUE
34466>>>>
34466>>>>        //AB-StoreStart
34466>>>>        
34466>>>>        
34466>>>>        //AB-StoreEnd
34466>>>>
34466>>>>    End_Object    // Branch_Branch_Name
34467>>>>
34467>>>>    Object Year_Year_Year is a dbFormSub
34469>>>>        Entry_Item Year.Year_year
34470>>>>        Set Size to 13 71
34471>>>>        Set Location to 37 112
34472>>>>        Set Label_Col_Offset to 2
34473>>>>        Set Label_Justification_Mode to jMode_Right
34474>>>>        Set Prompt_Button_Mode to pb_PromptOn
34475>>>>        Set Auto_Clear_Deo_State to FALSE
34476>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34477>>>>
34477>>>>        //AB-StoreStart
34477>>>>        Set Prompt_Object to (sl003(Self))
34478>>>>        
34478>>>>        Procedure Prompt_CallBack Integer hPrompt
34480>>>>            String lsCompanyCode lsBranchCode
34481>>>>            integer icheck
34481>>>>            get checked_state of (chkxr(self)) to icheck
34482>>>>            Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
34483>>>>            Get Field_Current_Value of Branch_DD  Field Branch.Branch_Code   to lsBranchCode
34484>>>>            Set psFragmaCompanyCode of hPrompt to lsCompanyCode
34485>>>>            Set psFragmaBranchCode  of hPrompt to lsBranchCode
34486>>>>            set pifragmaactive      of hPrompt to icheck
34487>>>>        End_Procedure
34488>>>>        
34488>>>>        
34488>>>>        
34488>>>>        
34488>>>>        
34488>>>>        
34488>>>>        //AB-StoreEnd
34488>>>>
34488>>>>    End_Object    // Year_Year_Year
34489>>>>
34489>>>>    Object Year_Year_Descr is a dbFormSub
34491>>>>        Entry_Item Year.Year_descr
34492>>>>        Set Size to 13 168
34493>>>>        Set Location to 37 188
34494>>>>        Set Color to 12232306
34495>>>>        Set Label_Col_Offset to 2
34496>>>>        Set Label_Justification_Mode to jMode_Right
34497>>>>        Set Enabled_State to FALSE
34498>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34499>>>>        Set Item_Shadow_State Item 0 to TRUE
34500>>>>        Set Shadow_State Item 0 to TRUE
34501>>>>
34501>>>>        //AB-StoreStart
34501>>>>        
34501>>>>        //AB-StoreEnd
34501>>>>
34501>>>>    End_Object    // Year_Year_Descr
34502>>>>
34502>>>>    Object Year_Year_Entrydate is a dbFormSub
34504>>>>        Entry_Item Year.Year_entrydate
34505>>>>        Set Size to 13 71
34506>>>>        Set Location to 52 112
34507>>>>        Set Label_Col_Offset to 2
34508>>>>        Set Label_Justification_Mode to jMode_Right
34509>>>>        Set Auto_Clear_Deo_State to FALSE
34510>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34511>>>>    End_Object    // Year_Year_Entrydate
34512>>>>
34512>>>>    Object oOk_bn is a ButtonSub
34514>>>>        Set Label to "€§¦›¦®ã (F2)"
34515>>>>        Set Size to 17 54
34516>>>>        Set Location to 74 188
34517>>>>        Set Form_FontHeight Item 0 to 14
34518>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34519>>>>
34519>>>>        //AB-StoreStart
34519>>>>        
34519>>>>        Procedure OnClick
34521>>>>            Delegate Send AcceptTheValues
34523>>>>        End_Procedure
34524>>>>        
34524>>>>        
34524>>>>        
34524>>>>        
34524>>>>        //AB-StoreEnd
34524>>>>
34524>>>>    End_Object    // oOk_bn
34525>>>>
34525>>>>    Object oCancel_bn is a ButtonSub
34527>>>>        Set Label to "„¥¦›¦ª "
34528>>>>        Set Size to 17 54
34529>>>>        Set Location to 74 302
34530>>>>        Set Form_FontHeight Item 0 to 14
34531>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34532>>>>
34532>>>>        //AB-StoreStart
34532>>>>        
34532>>>>        Procedure OnClick
34534>>>>           Send Exit_Application to oSelectYear
34535>>>>        End_Procedure
34536>>>>        
34536>>>>        
34536>>>>        
34536>>>>        //AB-StoreEnd
34536>>>>
34536>>>>    End_Object    // oCancel_bn
34537>>>>
34537>>>>    Object otxtCompany is a TextBoxSub
34539>>>>        Set Label to "„«˜ ¨œå˜"
34540>>>>        Set Auto_Size_State to FALSE
34541>>>>        Set Color to 12232306
34542>>>>        Set FontSize to 14 8
34543>>>>        Set Location to 9 10
34544>>>>        Set Size to 10 35
34545>>>>        Set FontWeight to 600
34546>>>>        Set TypeFace to "MS Sans Serif"
34547>>>>        Set Enabled_State to TRUE
34548>>>>    End_Object    // otxtCompany
34549>>>>
34549>>>>    Object otxtBranch is a TextBoxSub
34551>>>>        Set Label to "“§¦¡˜«˜©«ã£˜«˜"
34552>>>>        Set Auto_Size_State to FALSE
34553>>>>        Set Color to 12232306
34554>>>>        Set FontSize to 14 8
34555>>>>        Set Location to 23 10
34556>>>>        Set Size to 10 63
34557>>>>        Set FontWeight to 600
34558>>>>        Set TypeFace to "MS Sans Serif"
34559>>>>        Set Enabled_State to TRUE
34560>>>>    End_Object    // otxtBranch
34561>>>>
34561>>>>    Object otxtYear is a TextBoxSub
34563>>>>        Set Label to "•¨ã©ž :          "
34564>>>>        Set Auto_Size_State to FALSE
34565>>>>        Set Color to 12232306
34566>>>>        Set FontSize to 14 8
34567>>>>        Set Location to 38 10
34568>>>>        Set Size to 10 40
34569>>>>        Set FontWeight to 600
34570>>>>        Set TypeFace to "MS Sans Serif"
34571>>>>        Set Enabled_State to TRUE
34572>>>>    End_Object    // otxtYear
34573>>>>
34573>>>>    Object otxtWorkingDay is a TextBoxSub
34575>>>>        Set Label to "†£/¤å˜ „¨š˜©å˜ª"
34576>>>>        Set Auto_Size_State to FALSE
34577>>>>        Set Color to 12232306
34578>>>>        Set FontSize to 14 8
34579>>>>        Set Location to 52 10
34580>>>>        Set Size to 10 63
34581>>>>        Set FontWeight to 600
34582>>>>        Set TypeFace to "MS Sans Serif"
34583>>>>        Set Enabled_State to TRUE
34584>>>>    End_Object    // otxtWorkingDay
34585>>>>
34585>>>>    Object otxtWorkingDay is a TextBoxSub
34587>>>>        Set Label to "Ž¢œª ¦  ®¨ã©œ ª"
34588>>>>        Set Auto_Size_State to FALSE
34589>>>>        Set Color to 12232306
34590>>>>        Set FontSize to 14 8
34591>>>>        Set Location to 79 9
34592>>>>        Set Size to 10 63
34593>>>>        Set FontWeight to 600
34594>>>>        Set TypeFace to "MS Sans Serif"
34595>>>>        Set Enabled_State to TRUE
34596>>>>    End_Object    // otxtWorkingDay
34597>>>>
34597>>>>    Object chkxr is a CheckBoxSub
34599>>>>        Set Size to 13 22
34600>>>>        Set Location to 79 113
34601>>>>        Set Color to 12232306
34602>>>>    End_Object    // chkxr
34603>>>>
34603>>>>
34603>>>>    //AB-StoreStart
34603>>>>    
34603>>>>    On_Key Key_Ctrl+Key_X Send None
34604>>>>    On_Key Key_Alt+Key_X  Send None
34605>>>>    
34605>>>>    Function ifSelect_Xrhsh Returns String
34607>>>>        String  lsRecord_id
34608>>>>        Set psSelectedYearRecr to gs_Selected_Year_Recr
34609>>>>        send popup_modal
34610>>>>        Get psSelectedYearRecr to lsRecord_id
34611>>>>        Function_return lsRecord_Id
34612>>>>    End_Function
34613>>>>    
34613>>>>    Procedure AcceptTheValues
34615>>>>        Integer iRetVal liYearDD liCompanyDD liBranchDD
34616>>>>        String ldcheck lsYearRecr lsSite sCname sBname sYname sNom1 sNom2 sNom3
34616>>>>        Date ldYearXrhsh_From ldYearXrhsh_To
34616>>>>        Move Year_DD to liYearDD
34617>>>>        Get Field_Current_Value of liYearDD Field Year.Year_EntryDate to ldcheck
34618>>>>        if (ldcheck = "") ;            Get Message_Box "ƒœ¤ œ§ ¢â¥˜«œ ©à©«ã ž£œ¨¦£ž¤å˜." "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
34621>>>>        else begin
34622>>>>            Get Field_Current_Value of liYearDD Field Year.Year_XrhshFrom   to ldYearXrhsh_From
34623>>>>            Get Field_Current_Value of liYearDD Field Year.Year_XrhshTo     to ldYearXrhsh_To
34624>>>>            if ((ldcheck < ldYearXrhsh_From) or (ldcheck > ldYearXrhsh_To)) ;                Get Message_Box "†£œ¨/¤å˜ œ¡«éª ¦¨åà¤" "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
34627>>>>            else begin
34628>>>>                Move Company_DD to liCompanyDD
34629>>>>                Move Branch_DD  to liBranchDD
34630>>>>                Move Year_DD    to liYearDD
34631>>>>                send Request_Save to liYearDD
34632>>>>                Get Field_Current_Value of liCompanyDD Field Company.Company_Code to gs_Selected_Company_Code
34633>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_Code   to gs_Selected_Branch_Code
34634>>>>    
34634>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Beto_Site   to gs_Selected_Beto_Site
34635>>>>    
34635>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_Site   to lsSite
34636>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Year       to gi_Selected_Year
34637>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Recr       to lsYearRecr
34638>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_Code0    to sNom1
34639>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_Code00   to sNom2
34640>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_CodeR    to sNom3
34641>>>>    
34641>>>>                Get Field_Current_Value of liCompanyDD Field Company.Company_Name to sCname
34642>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_name   to sBname
34643>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Descr      to sYname
34644>>>>    
34644>>>>    
34644>>>>                Local String    sCode
34644>>>>                Local Integer   iBreak
34644>>>>                Move 0 to iBreak
34645>>>>                Clear Nomisma
34646>>>>                Find Gt Nomisma.Recnum
34647>>>>>
34647>>>>                While ((Found=1) And (iBreak=0))
34651>>>>                    If (Nomisma.Einai_Euro='1') Begin
34653>>>>                        Move 1 to iBreak
34654>>>>                        Move Nomisma.Nomisma_Code to sCode
34655>>>>                    End
34655>>>>>
34655>>>>                    If (Not(iBreak)) Find Gt Nomisma.Recnum
34658>>>>                Loop
34659>>>>>
34659>>>>                Move (Trim(sCode)) to sCode
34660>>>>    
34660>>>>    
34660>>>>                Reread SysCurXR
34664>>>>                Move gs_Selected_Company_Code   to SysCurXR.Company_Code
34665>>>>                Move gs_Selected_beto_site      to SysCurXR.beto_site
34666>>>>                Move gs_Selected_Branch_Code    to SysCurXR.Branch_Code
34667>>>>                Move gi_Selected_Year           to SysCurXR.Year_Year
34668>>>>                Move lsYearRecr                 to SysCurXR.Year_Recr
34669>>>>                Move lsSite                     to SysCurXR.Branch_Site
34670>>>>    
34670>>>>                Move sCname                     to SysCurXR.Company_Name
34671>>>>                Move sBname                     to SysCurXR.Branch_Name
34672>>>>                Move sYname                     to SysCurXR.Year_Descr
34673>>>>    
34673>>>>                Move ldYearXrhsh_From           to SysCurXr.Year_XrhshFrom
34674>>>>                Move ldYearXrhsh_To             to SysCurXr.Year_XrhshTo
34675>>>>    
34675>>>>                Move  (Trim(sNom1))             to SysCurXR.C_Code0
34676>>>>                Move  (Trim(sNom2))             to SysCurXR.C_Code00
34677>>>>                Move  (Trim(sNom3))             to SysCurXR.C_CodeR
34678>>>>    
34678>>>>                Move sCode                      to SysCurXR.Euro_Code
34679>>>>    
34679>>>>                Saverecord SysCurXR
34680>>>>                Unlock
34681>>>>>
34681>>>>    
34681>>>>                Move lsYearRecr                 to gs_Selected_Year_Recr
34682>>>>                Set psSelectedYearRecr          to lsYearRecr
34683>>>>    
34683>>>>                Send Stop_Modal_ui
34684>>>>    
34684>>>>                Set kEnter_Next_State of ghoWorkSpace to TRUE
34685>>>>            End
34685>>>>>
34685>>>>        end
34685>>>>>
34685>>>>    End_Procedure
34686>>>>    
34686>>>>    Set Locate_Mode to Center_On_Screen
34687>>>>    
34687>>>>    On_Key KCancel      Send KeyAction to (oCancel_Bn(Self))
34688>>>>    On_Key KClose_Panel Send KeyAction to (oCancel_Bn(Self))
34689>>>>    On_Key Ksave_record send KeyAction to (oOK_Bn(Self))
34690>>>>    
34690>>>>    On_Key Key_alt+Key_A send KeyAction to (oOK_Bn(Self))
34691>>>>    On_Key Key_alt+Key_Q send KeyAction to (oCancel_Bn(Self))
34692>>>>    
34692>>>>    
34692>>>>    
34692>>>>    
34692>>>>    
34692>>>>    
34692>>>>    
34692>>>>    //AB-StoreEnd
34692>>>>
34692>>>>End_Object    // oSelectYear
34693>>>>
34693>>>>
34693>>>>//AB-StoreStart
34693>>>>
34693>>>>
34693>>>>//AB-StoreEnd
34693>>>>
34693>>>>//AB/ End_Object    // prj
34693>>
34693>>Procedure Epelexe_Xrhsh
34694>>    Integer liCompanyDD liBranchDD liYearDD liYear liModalId
34695>>    String lsCompany lsBranch lsWhatXrhsh
34695>>    Move oSelectYear to liModalId
34696>>    Get ifSelect_Xrhsh Of liModalId to lsWhatXrhsh
34697>>    if (Trim(lsWhatXrhsh)='') Send Exit_Application
34700>>End_Procedure
34701>>
34701>>Procedure Allaxe_Xrhsh
34702>>    Integer rVal liModalId iID
34703>>    If (Close_All_Views(Self,True)=0) Begin
34705>>        Move oSelectYear to liModalId
34706>>        Send Epelexe_Xrhsh
34707>>    End
34707>>>
34707>>End_Procedure
34708>>
34708>>On_Key Key_Ctrl+Key_X Send Allaxe_Xrhsh
34709>>On_Key Key_Alt+Key_X  Send Allaxe_Xrhsh
34710>>
34710>>Send Epelexe_Xrhsh
34711>>//------------------------------
34711>>
34711>Set Button_State    of (Wait(Self)) to False
34712>Set BarVisibleState of (Wait(Self)) to '' False
34713>Send Popup                          to (Wait(Self))
34714>Send UpdateWait to (Wait(Self))     '˜¨˜¡˜¢é §œ¨ £â¤œ«œ. „¢œš®¦ª ˜¨®œåà¤ œ­˜¨£¦šãª'
34715>
34715>Use Menu_Sec.Sub
INCLUDING FILE: MENU_SEC.SUB
34715>>>
34715>>>Use Idiotht.pkg
INCLUDING FILE: IDIOTHT.PKG
34715>>>>>
34715>>>>>Open Users
34717>>>>>Open UserGrps
INCLUDING FILE: USERGRPS.FD
34719>>>>>Open Pedia
INCLUDING FILE: PEDIA.FD
34721>>>>>Open Arxeia
INCLUDING FILE: ARXEIA.FD
34723>>>>>Open GrpPedia
INCLUDING FILE: GRPPEDIA.FD
34725>>>>>Open GrpPed0
INCLUDING FILE: GRPPED0.FD
34727>>>>>Open GrpArx
INCLUDING FILE: GRPARX.FD
34729>>>>>Open GrpArx0
INCLUDING FILE: GRPARX0.FD
34731>>>>>Open ViewFlds
INCLUDING FILE: VIEWFLDS.FD
34733>>>>>Open Oth
INCLUDING FILE: OTH.FD
34735>>>>>Open GrpOth
INCLUDING FILE: GRPOTH.FD
34737>>>>>Open GrpOth0
INCLUDING FILE: GRPOTH0.FD
34739>>>>>Open Departm
INCLUDING FILE: DEPARTM.FD
34741>>>>>
34741>>>>>
34741>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
34742>>>>>
34742>>>>>Function Network_User_Name Returns String
34743>>>>>    Local String sName sLength
34744>>>>>    Local Pointer lpName_Addr lpLength_Addr
34744>>>>>    Local Integer iRetval
34744>>>>>    Movestr (Repeat (Character (0), 255)) To sName
34745>>>>>>
34745>>>>>    GetAddress Of sName To lpName_Addr
34746>>>>>    Movestr (DwordToBytes (255)) To sLength
34747>>>>>>
34747>>>>>    GetAddress Of sLength To lpLength_Addr
34748>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
34749>>>>>>
34749>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
34752>>>>>    Else Function_Return "User Unknown"
34754>>>>>End_Function // Network_User_Name
34755>>>>>
34755>>>>>Function fsGetOfficePath Global Returns String
34756>>>>>    String sRegistryKeyPath sRegOfficePath
34757>>>>>    Set_Registry_Root                                                   to HKEY_LOCAL_MACHINE "Software"
34758>>>>>    Move "Microsoft\Office\9.0\Word"                                    to sRegistryKeyPath
34759>>>>>    Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path"    to sRegOfficePath
34763>>>>>    Move (Trim(sRegOfficePath))                                         to sRegOfficePath
34764>>>>>    If (sRegOfficePath='') Begin
34766>>>>>        Move "Microsoft\Office\8.0\Word"                                to sRegistryKeyPath
34767>>>>>        Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34771>>>>>        Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34772>>>>>        If (sRegOfficePath='') Begin
34774>>>>>            Move "Microsoft\Office\7.0\Word"                             to sRegistryKeyPath
34775>>>>>            Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34779>>>>>            Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34780>>>>>            If (sRegOfficePath='') Begin
34782>>>>>                Move "Microsoft\Office\10.0\Word"                                to sRegistryKeyPath
34783>>>>>                Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34787>>>>>                Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34788>>>>>            End
34788>>>>>>
34788>>>>>        End
34788>>>>>>
34788>>>>>    End
34788>>>>>>
34788>>>>>    Function_Return sRegOfficePath
34789>>>>>End_Procedure
34790>>>>>
34790>>>>>
34790>>>>>Function fsGetLastDir Global Returns String
34791>>>>>    String sRegistryKeyPath sRegDir sUserName
34792>>>>>    Get Network_User_Name to sUserName
34793>>>>>
34793>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
34796>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
34799>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
34801>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
34803>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
34804>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
34805>>>>>    Get_profile_string sRegistryKeyPath "Path" to sRegDir
34808>>>>>    Function_Return sRegDir
34809>>>>>End_Procedure
34810>>>>>
34810>>>>>Function fiPutLastDir Global String asDirectory Returns Integer
34811>>>>>    String sRegistryKeyPath sRegDir sUserName
34812>>>>>    Get Network_User_Name to sUserName
34813>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
34816>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
34819>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
34821>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
34823>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
34824>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
34825>>>>>    Set_profile_string sRegistryKeyPath "Path" to asDirectory
34828>>>>>    Function_Return 0
34829>>>>>End_Procedure
34830>>>>>
34830>>>>>
34830>>>>>Function fsVresExt Global String asFileName Returns String
34831>>>>>    String rVal
34832>>>>>    Integer iPos iLen
34832>>>>>    Move (UpperCase(asFileName)) to asFileName
34833>>>>>    Move (Trim(asFileName)) to asFileName
34834>>>>>    Move 0 to iPos
34835>>>>>    For iLen from 1 to (length(asFileName))
34841>>>>>>
34841>>>>>        If (Mid(asFileName,1,iLen)='.') Move iLen to iPos
34844>>>>>    Loop
34845>>>>>>
34845>>>>>    If (Not(iPos)) Function_Return ''
34848>>>>>    Move (Right(asFileName,(Length(asFileName)-iPos))) to rVal
34849>>>>>    Move (Trim(rVal)) to rVal
34850>>>>>    Function_Return rVal
34851>>>>>End_Function
34852>>>>>
34852>>>>>
34852>>>>>Function fiScreenFieldStatus Global String asViewName String asDbFormName Returns Integer
34853>>>>>    Integer rVal iUser iGroup
34854>>>>>    String  sUser sRecr
34854>>>>>    Move (Trim(asViewName))     to asViewName
34855>>>>>    Move (Trim(asDbFormName))   to asDbFormName
34856>>>>>
34856>>>>>    If ((asViewName<>'') And (asDbFormName<>'')) Begin
34858>>>>>        Get fsLoginUserID to sUser
34859>>>>>        Clear Users
34860>>>>>        Move sUser        to Users.Login_ID
34861>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34862>>>>>>
34862>>>>>        If (Found=1) Begin
34864>>>>>            Move Users.User_ID  to iUser
34865>>>>>            Move Users.Grp_ID   to iGroup
34866>>>>>            Clear GrpOth
34867>>>>>            Move iUser          to GrpOth.User_ID
34868>>>>>            Move asViewName     to GrpOth.View_Name
34869>>>>>            Move asDbFormName   to GrpOth.Scr_Field_Name
34870>>>>>            Find eq GrpOth by Index.2 // GrpOth:Index.2:User_ID+View_Name+Scr_Field_Name
34871>>>>>>
34871>>>>>            If (Found=1) Begin
34873>>>>>                // rVal=1 ==> NO READ ALLOWED
34873>>>>>                // rVal=2 ==> NO EDIT BUT CAN COPY
34873>>>>>                // rVal=3 ==> NO EDIT AND NO COPY
34873>>>>>                If (GrpOth.Allow_Read <>'1') Move 1 to rVal
34876>>>>>                Else Begin
34877>>>>>                    If (GrpOth.Allow_Change<>'1') Begin
34879>>>>>                        If (GrpOth.Allow_Copy<>'1') Move 3 to rVal
34882>>>>>                        Else                        Move 2 to rVal
34884>>>>>                    End
34884>>>>>>
34884>>>>>                End
34884>>>>>>
34884>>>>>            End
34884>>>>>>
34884>>>>>            Else Begin
34885>>>>>                Clear GrpOth0
34886>>>>>                Move iGroup         to GrpOth0.Group_ID
34887>>>>>                Move asViewName     to GrpOth0.View_Name
34888>>>>>                Move asDbFormName   to GrpOth0.Scr_Field_Name
34889>>>>>
34889>>>>>                Find eq GrpOth0 by Index.2 // GrpOth0:Index.2:Group_ID+View_Name+Scr_Field_Name
34890>>>>>>
34890>>>>>                If (Found=1) Begin
34892>>>>>                    // rVal=1 ==> NO READ ALLOWED
34892>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
34892>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
34892>>>>>                    If (GrpOth0.Allow_Read <>'1') Move 1 to rVal
34895>>>>>                    Else Begin
34896>>>>>                        If (GrpOth0.Allow_Change<>'1') Begin
34898>>>>>                            If (GrpOth0.Allow_Copy<>'1') Move 3 to rVal
34901>>>>>                            Else                         Move 2 to rVal
34903>>>>>                        End
34903>>>>>>
34903>>>>>                    End
34903>>>>>>
34903>>>>>                End
34903>>>>>>
34903>>>>>                Else Move 0 to rVal
34905>>>>>            End
34905>>>>>>
34905>>>>>        End
34905>>>>>>
34905>>>>>        Else Move 0 to rVal
34907>>>>>    End
34907>>>>>>
34907>>>>>    Function_Return rVal
34908>>>>>End_Function
34909>>>>>
34909>>>>>Function fiFieldStatus Global Integer aiFileNumber Integer aiFieldNumber Returns Integer
34910>>>>>    Integer rVal iUser iGroup
34911>>>>>    String  sUser sRecr
34911>>>>>    If ((aiFileNumber) And (aiFieldNumber)) Begin
34913>>>>>        Get fsLoginUserID to sUser
34914>>>>>        Clear Users
34915>>>>>        Move sUser        to Users.Login_ID
34916>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34917>>>>>>
34917>>>>>        If (Found=1) Begin
34919>>>>>            Move Users.User_ID  to iUser
34920>>>>>            Move Users.Grp_ID   to iGroup
34921>>>>>            Clear Pedia
34922>>>>>            Move aiFileNumber  to Pedia.Arxeio_ID
34923>>>>>            Move aiFieldNumber to Pedia.Pedio_Number
34924>>>>>            Find eq Pedia By Index.1 // Pedia:Index.1:Arxeio_ID+Pedio_Number
34925>>>>>>
34925>>>>>            If (Found=1) Begin
34927>>>>>                Move (Trim(Pedia.Pedio_Recr))   to sRecr
34928>>>>>                // Find Combination User/File/Field in GRPPEDIA
34928>>>>>                Clear GrpPedia
34929>>>>>                Move iUser                      to GrpPedia.User_ID
34930>>>>>                Move (Trim(sRecr))              to GrpPedia.Pedio_Recr
34931>>>>>                Find eq GrpPedia by Index.4 // GrpPedia:Index.4:Pedio_Recr + User_ID
34932>>>>>>
34932>>>>>                If (Found=1) Begin
34934>>>>>                    // rVal=1 ==> NO READ ALLOWED
34934>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
34934>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
34934>>>>>                    If (GrpPedia.Allow_Read <>'1') Move 1 to rVal
34937>>>>>                    Else Begin
34938>>>>>                        If (GrpPedia.Allow_Change<>'1') Begin
34940>>>>>                            If (GrpPedia.Allow_Copy<>'1')   Move 3 to rVal
34943>>>>>                            Else                            Move 2 to rVal
34945>>>>>                        End
34945>>>>>>
34945>>>>>                    End
34945>>>>>>
34945>>>>>                End
34945>>>>>>
34945>>>>>                Else Begin
34946>>>>>                    // Find Combination UserGrps/File/Field in GRPPED0
34946>>>>>                    Clear GrpPed0
34947>>>>>                    Move iGroup         to GrpPed0.Group_ID
34948>>>>>                    Move (Trim(sRecr))  to GrpPed0.Pedio_Recr
34949>>>>>                    Find eq GrpPed0 by Index.4 // GrpPed0:Index.4:Pedio_Recr + Group_ID
34950>>>>>>
34950>>>>>                    If (Found=1) Begin
34952>>>>>                        // rVal=1 ==> NO READ ALLOWED
34952>>>>>                        // rVal=2 ==> NO EDIT BUT CAN COPY
34952>>>>>                        // rVal=3 ==> NO EDIT AND NO COPY
34952>>>>>                        If (GrpPed0.Allow_Read <>'1') Move 1 to rVal
34955>>>>>                        Else Begin
34956>>>>>                            If (GrpPed0.Allow_Change<>'1') Begin
34958>>>>>                                If (GrpPed0.Allow_Copy<>'1')   Move 3 to rVal
34961>>>>>                                Else                           Move 2 to rVal
34963>>>>>                            End
34963>>>>>>
34963>>>>>                        End
34963>>>>>>
34963>>>>>                    End
34963>>>>>>
34963>>>>>                End
34963>>>>>>
34963>>>>>            End
34963>>>>>>
34963>>>>>            Else Begin
34964>>>>>                Move 0 to rVal
34965>>>>>            End
34965>>>>>>
34965>>>>>        End
34965>>>>>>
34965>>>>>        Else Begin
34966>>>>>            Move 0 to rVal
34967>>>>>        End
34967>>>>>>
34967>>>>>    End
34967>>>>>>
34967>>>>>    Function_Return rVal
34968>>>>>End_Function
34969>>>>>
34969>>>>>Function fsReturnFileFromPath Global String asFullPath Returns String
34970>>>>>    String rVal lsDirSep
34971>>>>>    Integer iPos iMet iLen iCnt
34971>>>>>    Move (Trim(asFullPath))                 To rVal
34972>>>>>    Move (Sysconf(SYSCONF_DIR_SEPARATOR))   To lsDirSep
34973>>>>>    If (rVal Contains lsDirSep) Begin
34975>>>>>        Move (Length(rVal)) to iLen
34976>>>>>        Move iLen to iCnt
34977>>>>>        While iCnt Gt 0
34981>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Begin
34983>>>>>                If (iCnt=iLen) Function_Return asFullPath
34986>>>>>                Else Function_Return (Right(rVal,(iLen-iCnt)))
34988>>>>>            End
34988>>>>>>
34988>>>>>            Decrement iCnt
34989>>>>>        End // While iCnt Gt 0
34990>>>>>>
34990>>>>>    End
34990>>>>>>
34990>>>>>    Else  Function_Return (Trim(asFullPath))
34992>>>>>    Function_Return rVal
34993>>>>>End_Function
34994>>>>>
34994>>>>>Function fsReturnDirectoriesFromPath Global String asFullPath Returns String
34995>>>>>    String rVal lsDirSep
34996>>>>>    Integer iPos iMet iLen iCnt
34996>>>>>    Move (Trim(asFullPath))                 To rVal
34997>>>>>    Move (Sysconf(SYSCOnF_DIR_SEPARATOR))   To lsDirSep
34998>>>>>    If (rVal Contains lsDirSep) Begin
35000>>>>>        Move (Length(rVal)) to iLen
35001>>>>>        Move iLen to iCnt
35002>>>>>        While iCnt Gt 0
35006>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Function_Return (Left(rVal,iCnt))
35009>>>>>            Decrement iCnt
35010>>>>>        End // While iCnt Gt 0
35011>>>>>>
35011>>>>>    End
35011>>>>>>
35011>>>>>    Function_Return rVal
35012>>>>>End_Function
35013>>>>>
35013>>>>>//Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
35013>>>>>//    Local String rVal lsTmp lsOO lsLL
35013>>>>>//    Local Number lnOO lnLL
35013>>>>>
35013>>>>>//    Move '' to lsOO
35013>>>>>//    Move '' to lsLL
35013>>>>>//    Move '' to rVal
35013>>>>>
35013>>>>>//    Move (Integer(anTime))                              to lnOO
35013>>>>>//    ////////////////////////////////////////////
35013>>>>>//    // sos sos sos jsjsjsjsjs yannis 30/03/2000
35013>>>>>//    //If ((lnOO=24) and (lnll=0)) Move 0 to lnOO
35013>>>>>//    ////////////////////////////////////////////
35013>>>>>
35013>>>>>//    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
35013>>>>>
35013>>>>>//    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
35013>>>>>//    Else         Move (String(lnOO))                    to lsOO
35013>>>>>//    Move (Trim(lsOO))                                   to lsOO
35013>>>>>
35013>>>>>//    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
35013>>>>>//    Else         Move (String(lnLL))                    to lsLL
35013>>>>>//    Move (Trim(lsLL))                                   to lsLL
35013>>>>>
35013>>>>>//    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
35013>>>>>
35013>>>>>//    Move (Trim(rVal)) to rVal
35013>>>>>
35013>>>>>//    Function_Return rVal
35013>>>>>//End_Function
35013>>>>>
35013>>>>>//Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
35013>>>>>//    Local Number rVal nOres nLepta
35013>>>>>//    Move (Integer(aiMinutes/60))    to nOres
35013>>>>>//    Move (    Mod(aiMinutes,60))    to nLepta
35013>>>>>//    Move (nOres+(nLepta/100))       to rVal
35013>>>>>//    Function_Return rVal
35013>>>>>//End_Function
35013>>>>>
35013>>>>>//Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
35013>>>>>//    Local Integer rVal
35013>>>>>//    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
35013>>>>>//    Function_Return rVal
35013>>>>>//End_Function
35013>>>>>
35013>>>>>//Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;
35013>>>>>//                                                                    Number anEndTime    ;
35013>>>>>//                                                                    Returns Integer
35013>>>>>//    Local Integer rVal iMinStart iMinEnd
35013>>>>>
35013>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
35013>>>>>
35013>>>>>//    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
35013>>>>>//    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
35013>>>>>//    Move (iMinEnd-iMinStart)                                                     to rVal
35013>>>>>//    Function_Return rVal
35013>>>>>//End_Function
35013>>>>>
35013>>>>>
35013>>>>>//Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;
35013>>>>>//                                                                Number anEndTime    ;
35013>>>>>//                                                                Returns Number
35013>>>>>//    Local Integer iTmp
35013>>>>>//    Local Number  rVal
35013>>>>>
35013>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
35013>>>>>
35013>>>>>//    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
35013>>>>>//    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
35013>>>>>//    Function_Return rVal
35013>>>>>//End_Function
35013>>>>>
35013>>>>>
35013>>>>>Function fsLoginUserID Global Returns String
35014>>>>>    Local String LastLogin# LoginUserid#
35015>>>>>    get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin#
35018>>>>>    If LastLogin# eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin#
35021>>>>>    insert "WorkSpaces\" in LastLogin# at 1
35023>>>>>    Append LastLogin# "\" (Module_Name(Self)) "\LastLogin"
35026>>>>>    get_profile_string LastLogin# "LoginUserId"  to LoginUserId#
35029>>>>>    Trim LoginUserID# to LoginUserID#
35030>>>>>>
35030>>>>>    If LoginUserId# eq "" Move (Network_User_Name(Current_Object)) to LoginUserId#
35033>>>>>    Function_Return LoginUserID#
35034>>>>>End_Function
35035>>>>>
35035>>>>>Function fiWriteRegistryLastSDFPath Global String asLastPath Returns Integer
35036>>>>>    Integer rVal
35037>>>>>    String  lsCurrentWksp
35037>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35040>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35043>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35045>>>>>    // Œœ¦ ¡¢œ ›   - Last_SDF_Path -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
35045>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
35045>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
35048>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
35051>>>>>    Function_Return rVal
35052>>>>>End_Function
35053>>>>>
35053>>>>>
35053>>>>>Function fsReadRegistryLastSDFPath Global Returns String
35054>>>>>    String rVal lsCurrentWksp
35055>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35058>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35061>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35063>>>>>    // Œœ¦ ¡¢œ ›   - LastParastUsed -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
35063>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
35063>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
35066>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
35069>>>>>    Function_Return (Trim(rVal))
35070>>>>>End_Function
35071>>>>>
35071>>>>>
35071>>>>>Function fiWriteRegistryLastMCryptPath Global String asLastPath Returns Integer
35072>>>>>    Integer rVal
35073>>>>>    String  lsCurrentWksp
35073>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35076>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35079>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35081>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
35084>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
35087>>>>>    Function_Return rVal
35088>>>>>End_Function
35089>>>>>
35089>>>>>
35089>>>>>Function fsReadRegistryLastMCryptPath Global Returns String
35090>>>>>    String rVal lsCurrentWksp
35091>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35094>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35097>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35099>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
35102>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
35105>>>>>    Function_Return (Trim(rVal))
35106>>>>>End_Function
35107>>>>>
35107>>>>>Function fiWriteRegistryLastWEBPath Global String asLastPath Returns Integer
35108>>>>>    Integer rVal
35109>>>>>    String  lsCurrentWksp
35109>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35112>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35115>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35117>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
35120>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
35123>>>>>    Function_Return rVal
35124>>>>>End_Function
35125>>>>>
35125>>>>>
35125>>>>>Function fsReadRegistryLastWEBPath Global Returns String
35126>>>>>    String rVal lsCurrentWksp
35127>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35130>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35133>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35135>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
35138>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
35141>>>>>    Function_Return (Trim(rVal))
35142>>>>>End_Function
35143>>>>>
35143>>>>>Function fsReadRegistryFEMRootDir Global Returns String
35144>>>>>    String rVal lsCurrentWksp
35145>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35148>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35151>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35153>>>>>    Append lsCurrentWksp "\FEM"
35154>>>>>    Get_Profile_String lsCurrentWksp "RootDir"  to rVal
35157>>>>>    Function_Return (Trim(rVal))
35158>>>>>End_Function
35159>>>>>
35159>>>>>Function fsReadRegistryFEMDevicePath Global Returns String
35160>>>>>    String rVal lsCurrentWksp
35161>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35164>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35167>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35169>>>>>    Append lsCurrentWksp "\FEM"
35170>>>>>    Get_Profile_String lsCurrentWksp "DevicePath"  to rVal
35173>>>>>    Function_Return (Trim(rVal))
35174>>>>>End_Function
35175>>>>>
35175>>>>>Function fiWriteRegistryFEMRootDir Global Returns Integer
35176>>>>>    Integer rVal
35177>>>>>    String  lsCurrentWksp
35177>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35180>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35183>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35185>>>>>    Append lsCurrentWksp "\FEM"
35186>>>>>    Set_Profile_String lsCurrentWksp "RootDir"  to "C:\FEM_ROOT\"
35189>>>>>    Function_Return rVal
35190>>>>>End_Function
35191>>>>>
35191>>>>>Function fiWriteRegistryFEMDevicePath Global Returns Integer
35192>>>>>    Integer rVal
35193>>>>>    String  lsCurrentWksp
35193>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35196>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35199>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35201>>>>>    Append lsCurrentWksp "\FEM"
35202>>>>>    Set_Profile_String lsCurrentWksp "DevicePath"  to "C:\FEM_ROOT\Device_File1.dat"
35205>>>>>    Function_Return rVal
35206>>>>>End_Function
35207>>>>>
35207>>>>>
35207>>>>>
35207>>>>>
35207>>>>>
35207>>>>>Function fig_Is_Admin Global Returns Integer
35208>>>>>    String sUser
35209>>>>>    Integer rVal
35209>>>>>    Get fsLoginUserID to sUser
35210>>>>>    Move (trim(sUser)) to sUser
35211>>>>>    Clear Users
35212>>>>>    Move sUser to Users.Login_ID
35213>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35214>>>>>>
35214>>>>>    Move Users.Admin_Rights to rVal
35215>>>>>    Function_Return rVal
35216>>>>>End_Function
35217>>>>>
35217>>>>>Function fig_The_User_Group Global Returns Integer
35218>>>>>    String sUser
35219>>>>>    Get fsLoginUserID   to sUser
35220>>>>>    Move (trim(sUser))  to sUser
35221>>>>>    Clear Users
35222>>>>>    Move sUser          to Users.Login_ID
35223>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35224>>>>>>
35224>>>>>    Clear UserGrps
35225>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
35226>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
35227>>>>>>
35227>>>>>    Function_Return UserGrps.Grp_ID
35228>>>>>End_Function
35229>>>>>
35229>>>>>Function fsg_The_User_Department Global Returns String
35230>>>>>    String sUser
35231>>>>>    Get fsLoginUserID   to sUser
35232>>>>>    Move (trim(sUser))  to sUser
35233>>>>>    Clear Users
35234>>>>>    Move sUser          to Users.Login_ID
35235>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35236>>>>>>
35236>>>>>    Clear Departm
35237>>>>>    Move Users.Departm_Code   to Departm.Code
35238>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
35239>>>>>>
35239>>>>>    Function_Return Departm.Code
35240>>>>>End_Function
35241>>>>>
35241>>>>>
35241>>>>>Function fig_Is_Specific_Admin Global String asUser Returns Integer
35242>>>>>    Integer rVal
35243>>>>>    Move (trim(asUser)) to asUser
35244>>>>>    Clear Users
35245>>>>>    Move asUser to Users.Login_ID
35246>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35247>>>>>>
35247>>>>>    Move Users.Admin_Rights to rVal
35248>>>>>    Function_Return rVal
35249>>>>>End_Function
35250>>>>>
35250>>>>>Function fig_The_Specific_User_Group Global String asUser Returns Integer
35251>>>>>    Move (trim(asUser))  to asUser
35252>>>>>    Clear Users
35253>>>>>    Move asUser          to Users.Login_ID
35254>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35255>>>>>>
35255>>>>>    Clear UserGrps
35256>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
35257>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
35258>>>>>>
35258>>>>>    Function_Return UserGrps.Grp_ID
35259>>>>>End_Function
35260>>>>>
35260>>>>>Function fsg_The_Specific_User_Department Global String asUser Returns String
35261>>>>>    Move (trim(asUser))  to asUser
35262>>>>>    Clear Users
35263>>>>>    Move asUser          to Users.Login_ID
35264>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35265>>>>>>
35265>>>>>    Clear Departm
35266>>>>>    Move Users.Departm_Code   to Departm.Code
35267>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
35268>>>>>>
35268>>>>>    Function_Return Departm.Code
35269>>>>>End_Function
35270>>>>>
35270>>>>>
35270>>>
35270>>>Class ViewPopupMenu_Sec Is A ViewPopupMenu
35271>>>
35271>>>    Open Sysfile
INCLUDING FILE: SYSFILE.FD
35273>>>    Open Users
35275>>>    Open Views
INCLUDING FILE: VIEWS.FD
35277>>>    Open GrpViews
INCLUDING FILE: GRPVIEWS.FD
35279>>>    Open GrpView0
INCLUDING FILE: GRPVIEW0.FD
35281>>>    Open Arxeia
35283>>>    Open GrpArx
35285>>>
35285>>>    Function Find_User_Rights_In_Class String asView Returns Integer
35286>>>        String  lsView lsLogin
35287>>>        Integer liUser  liViews iGroup
35287>>>
35287>>>        Move (fsLoginUserID())      to lsLogin
35288>>>        Move (Trim(ToOEM(asView)))  to lsView
35289>>>
35289>>>        //////  /////////////////////////////////////
35289>>>        Clear Users
35290>>>        Move lsLogin    to Users.Login_ID
35291>>>
35291>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
35292>>>>
35292>>>        If (Found=1)  Begin
35294>>>            Move Users.User_ID  to liUser
35295>>>            Move Users.Grp_ID   to iGroup
35296>>>        End
35296>>>>
35296>>>        Else Function_Return 0
35298>>>
35298>>>        Clear Views
35299>>>        Move (Trim(lsView)) to Views.Menu_Name
35300>>>        Find eq Views by Index.2 // Views:Index.2:Views.Menu_Name
35301>>>>
35301>>>        If (Found=1) Begin
35303>>>            Move Views.View_ID to liViews
35304>>>            Clear GrpViews
35305>>>            Move liUser    to GrpViews.User_ID
35306>>>            Move liViews   to GrpViews.View_ID
35307>>>            Find Eq GrpViews by Index.1 // GrpViews:Index.1:GrpViews.User_ID+GrpViews.View_ID
35308>>>>
35308>>>            If (Found=1) Begin // And (liUser=GrpViews.User_ID) And (liViews=GrpViews.View_ID)) Begin
35310>>>                Function_Return (GrpViews.Allow_Read<>'1')
35311>>>            End
35311>>>>
35311>>>            Else Begin
35312>>>                Clear GrpView0
35313>>>                Move iGroup    to GrpView0.Group_ID
35314>>>                Move liViews   to GrpView0.View_ID
35315>>>                Find eq GrpView0 by Index.1 // GrpView0:Index.1:Group_ID+View_ID
35316>>>>
35316>>>                If (Found=1) Begin
35318>>>                    Function_Return (GrpView0.Allow_Read<>'1')
35319>>>                End
35319>>>>
35319>>>                Else         Function_Return 0
35321>>>            End
35321>>>>
35321>>>        End
35321>>>>
35321>>>        Else Function_Return 0
35323>>>    End_Function
35324>>>
35324>>>//    Procedure Enhmerose_Views_File_In_Class
35324>>>//        Integer liCount liInt liLastNo
35324>>>//        String lsStr
35324>>>//        Get Item_Count to liCount
35324>>>//        // find last view_id
35324>>>//        Clear Views
35324>>>//        Move 9999 to Views.View_ID
35324>>>//        Find lt Views by index.1 // view_id
35324>>>//        If (Found=1)    Move Views.View_ID  to liLastNo
35324>>>//        Else            Move 0              to liLastNo
35324>>>//        For liInt From 0 to (liCount-1)
35324>>>//            Get Value item liInt to lsStr
35324>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
35324>>>//            //Move (Trim(lsStr)) to lsStr
35324>>>//            If (lsStr<>'') Begin
35324>>>//                Clear Views
35324>>>//                Move lsStr to Views.Menu_Name
35324>>>//                Find eq Views by index.2 // Views.Menu_Name
35324>>>//                If (NOT(Found)) Begin
35324>>>//                    Add 1 to liLastNo
35324>>>//                    Move liLastNo to Views.View_ID
35324>>>//                    Saverecord Views
35324>>>//                End
35324>>>//            End
35324>>>//        Loop
35324>>>//        For liInt From 0 to (liCount-1)
35324>>>//            Get Value item liInt to lsStr
35324>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
35324>>>//            //Move (Trim(lsStr)) to lsStr
35324>>>//            If (lsStr<>'') Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
35324>>>//        Loop
35324>>>//    End_procedure
35324>>>
35324>>>    Procedure OnInitMenu
35325>>>        Integer liCount liInt liLastNo
35326>>>        String lsStr
35326>>>
35326>>>        Get Item_Count to liCount
35327>>>
35327>>>        // find last view_id
35327>>>        Clear Views
35328>>>        Move 9999 to Views.View_ID
35329>>>        Find lt Views by index.1 // view_id
35330>>>>
35330>>>        If (Found=1)    Move Views.View_ID  to liLastNo
35333>>>        Else            Move 0              to liLastNo
35335>>>        For liInt From 0 to (liCount-1)
35341>>>>
35341>>>            Get Value item liInt to lsStr
35342>>>            Move (Trim(lsStr)) to lsStr
35343>>>            If ((lsStr<>'') and (Length(lsStr)>2)) Begin
35345>>>                Clear Views
35346>>>                Move (ToOEM(lsStr)) to Views.Menu_Name
35347>>>                Find eq Views by index.2 // Views.Menu_Name
35348>>>>
35348>>>                If (NOT(Found)) Begin
35350>>>                    Add 1 to liLastNo
35351>>>                    Move liLastNo to Views.View_ID
35352>>>                    //Move (ToOEM(lsStr)) to Views.Menu_Name
35352>>>                    Saverecord Views
35353>>>                End
35353>>>>
35353>>>            End
35353>>>>
35353>>>        Loop
35354>>>>
35354>>>        For liInt From 0 to (liCount-1)
35360>>>>
35360>>>            Get Value item liInt to lsStr
35361>>>            Move (Trim(lsStr)) to lsStr
35362>>>            Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
35363>>>        Loop
35364>>>>
35364>>>
35364>>>    End_procedure
35365>>>
35365>>>//    Procedure End_Construct_Object
35365>>>//        Forward Send End_Construct_Object
35365>>>//        Send Enhmerose_Views_File_In_Class
35365>>>//    End_Procedure
35365>>>
35365>>>End_Class //ButtonSub
35366>>>
35366>>>
35366>Use DD_Sec.Sub
INCLUDING FILE: DD_SEC.SUB
35366>>>
35366>>>Open Sysfile
35368>>>Open UserGrps
35370>>>Open Users
35372>>>Open Views
35374>>>Open GrpViews
35376>>>Open Arxeia
35378>>>Open GrpArx
35380>>>Open GrpArx0
35382>>>Open GrpView0
35384>>>
35384>>>Use DD.Sub
35384>>>
35384>>>Class Datadictionary_Sec  Is A DatadictionarySub
35385>>>
35385>>>
35385>>>    Procedure Construct_Object
35386>>>        Forward Send Construct_Object
35388>>>        Property Integer cpiUpdate              0
35389>>>        Property Integer cpiBackout             0
35390>>>        Property Integer cpiEditing             0
35391>>>        Property Integer cpiFileNumber          0
35392>>>        Property String  cpsFileName            ''
35393>>>        Property String  cpsLoginID             ''
35394>>>        Property Integer cpiCannot_Read         0
35395>>>        Property Integer cpiCannot_Create       0
35396>>>        Property Integer cpiCannot_Delete       0
35397>>>        Property Integer cpiCannot_Edit         0
35398>>>        Property Integer piFN                   0
35399>>>    End_Procedure
35400>>>
35400>>>//    Procedure Save_Main_File
35400>>>//        If (Operation_Origin<>Self) Begin
35400>>>//            If Indirect_File.Recnum Eq 0 Procedure_Return
35400>>>//        End
35400>>>//        Forward Send Save_Main_File
35400>>>//    End_Procedure
35400>>>
35400>>>
35400>>>
35400>>>    Function Validate_Save Returns Integer
35401>>>        Integer rVal
35402>>>        Forward Get Validate_Save to rVal
35404>>>        If (Not(rVal)) Begin
35406>>>            Get cpiCannot_Read to rVal
35407>>>            If (Not(rVal)) Begin
35409>>>                Set cpiEditing to ((cpiBackout(Self)=1) and (cpiUpdate(Self)=1))
35410>>>                If (cpiEditing(Self)=1) Get cpiCannot_Edit      to rVal
35413>>>                Else                    Get cpiCannot_Create    to rVal
35415>>>            End
35415>>>>
35415>>>            If (rVal) Send Operation_Not_Allowed rVal
35418>>>        End
35418>>>>
35418>>>        Function_Return rVal
35419>>>    End_Function
35420>>>
35420>>>    Function Validate_Delete Returns Integer
35421>>>        Integer rVal
35422>>>        Forward Get Validate_Delete to rVal
35424>>>        If (Not(rVal)) Begin
35426>>>            Get cpiCannot_Read to rVal
35427>>>            If (Not(rVal)) Get cpiCannot_Delete to rVal
35430>>>            If (rVal) Send Operation_Not_Allowed rVal
35433>>>        End
35433>>>>
35433>>>        Function_Return rVal
35434>>>    End_Function
35435>>>
35435>>>    Procedure End_Construct_Object
35436>>>        Integer liSrv rVal
35437>>>        String lsStr
35437>>>        Forward Send End_Construct_Object
35439>>>        Get Main_File                                   To liSrv
35440>>>        Set cpiFileNumber                               To liSrv
35441>>>        Get_Attribute DF_FILE_PHYSICAL_NAME Of liSrv    To lsStr
35444>>>        Set cpsFileName                                 To (Trim(Uppercase(lsStr)))
35445>>>        Set cpsLoginID                                  To (fsLoginUserID())
35446>>>        Send Find_User_Rights
35447>>>        Set piFN to lisrv
35448>>>    End_Procedure
35449>>>
35449>>>    Procedure Find_User_Rights
35450>>>        String lsArxeio lsLogin
35451>>>        Integer liUser liArxeio iGroup
35451>>>
35451>>>        Get cpiFileNumber   to liArxeio
35452>>>        Get cpsFileName     to lsArxeio
35453>>>        Get cpsLoginID      to lsLogin
35454>>>
35454>>>        Clear Users
35455>>>        Move lsLogin    to Users.Login_ID
35456>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
35457>>>>
35457>>>        If (Found=1)  Begin
35459>>>            Move Users.User_ID  to liUser
35460>>>            Move Users.Grp_ID   to iGroup
35461>>>        End
35461>>>>
35461>>>        //Else Send Operation_Not_Allowed 9999
35461>>>
35461>>>        Clear Arxeia
35462>>>
35462>>>        Move liArxeio to Arxeia.Arxeio_ID
35463>>>        Find eq Arxeia by Index.1 // Arxeia:Index.1:Arxeia.Arxeio_ID
35464>>>>
35464>>>
35464>>>        If (Found=1) Begin
35466>>>            Move Arxeia.Arxeio_ID to liArxeio
35467>>>
35467>>>            Clear GrpArx
35468>>>            Move liUser     to GrpArx.User_ID
35469>>>            Move liArxeio   to GrpArx.Arxeio_ID
35470>>>            Find eq GrpArx by Index.1 // GrpArx:Index.1:GrpArx.User_ID+GrpArx.Arxeio_ID
35471>>>>
35471>>>            If (Found=1) Begin
35473>>>               If (GrpArx.Allow_Read  ='1') Set cpiCannot_Read   to 0
35476>>>               Else                         Set cpiCannot_Read   to 10003
35478>>>               If (GrpArx.Allow_Create='1') Set cpiCannot_Create to 0
35481>>>               Else                         Set cpiCannot_Create to 10000
35483>>>               If (GrpArx.Allow_Change='1') Set cpiCannot_Edit   to 0
35486>>>               Else                         Set cpiCannot_Edit   to 10001
35488>>>               If (GrpArx.Allow_Delete='1') Set cpiCannot_Delete to 0
35491>>>               Else                         Set cpiCannot_Delete to 10002
35493>>>            End
35493>>>>
35493>>>            Else Begin
35494>>>                Clear GrpArx0
35495>>>                Move iGroup   to GrpArx0.Group_ID
35496>>>                Move liArxeio to GrpArx0.Arxeio_ID
35497>>>                Find eq GrpArx0 by Index.1 // GrpArx0:Index.1:Group_ID+Arxeio_ID
35498>>>>
35498>>>                If (Found=1) Begin
35500>>>                    If (GrpArx0.Allow_Read  ='1')   Set cpiCannot_Read   to 0
35503>>>                    Else                            Set cpiCannot_Read   to 20003
35505>>>                    If (GrpArx0.Allow_Create='1')   Set cpiCannot_Create to 0
35508>>>                    Else                            Set cpiCannot_Create to 20000
35510>>>                    If (GrpArx0.Allow_Change='1')   Set cpiCannot_Edit   to 0
35513>>>                    Else                            Set cpiCannot_Edit   to 20001
35515>>>                    If (GrpArx0.Allow_Delete='1')   Set cpiCannot_Delete to 0
35518>>>                    Else                            Set cpiCannot_Delete to 20002
35520>>>                End
35520>>>>
35520>>>                Else Begin
35521>>>                    Set cpiCannot_Read   to 0
35522>>>                    Set cpiCannot_Edit   to 0
35523>>>                    Set cpiCannot_Create to 0
35524>>>                    Set cpiCannot_Delete to 0
35525>>>                End
35525>>>>
35525>>>            End
35525>>>>
35525>>>        End
35525>>>>
35525>>>        Else Begin
35526>>>            // €¤ ›œ¤ ™¨œŸœ  «¦ ˜¨®œ ¦ «¦«œ Ÿœà¨¦¬£œ ¦«  ¦ ®¨ž©«žª œ®œ  §¨¦©™˜©ž ©'˜¬«¦
35526>>>            Set cpiCannot_Read   to 0
35527>>>            Set cpiCannot_Edit   to 0
35528>>>            Set cpiCannot_Create to 0
35529>>>            Set cpiCannot_Delete to 0
35530>>>        End
35530>>>>
35530>>>    End_Procedure
35531>>>
35531>>>    Procedure Clear_main_file
35532>>>        Forward Send Clear_main_file
35534>>>        Set cpiBackout to 0
35535>>>        Set cpiUpdate  to 0
35536>>>    End_Procedure
35537>>>
35537>>>    Procedure Update
35538>>>        Forward Send Update
35540>>>        Set cpiUpdate to 1
35541>>>    End_Procedure
35542>>>
35542>>>    Procedure Backout
35543>>>        Forward Send Backout
35545>>>        Set cpiBackout to 1
35546>>>    End_Procedure
35547>>>
35547>>>    Procedure OnConstrain
35548>>>        Integer rVal liSrv
35549>>>        Forward Send OnConstrain
35551>>>        Get cpiFileNumber  To liSrv
35552>>>        Move liSrv         To Filenumber
35553>>>        Get cpiCannot_Read to rVal
35554>>>        If (rVal) Constrain Indirect_File.Recnum eq 0
35558>>>    End_Procedure
35559>>>
35559>>>    Procedure Operation_Not_Allowed  Integer iError_Num
35560>>>        String sLektiko
35561>>>        Move '' to sLektiko
35562>>>
35562>>>             If iError_Num eq 10000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
35565>>>        Else If iError_Num eq 10001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Users permissions. Check with your Administrator"    to sLektiko
35569>>>        Else If iError_Num eq 10002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
35573>>>        Else If iError_Num eq 10003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
35577>>>        Else If iError_Num eq 20000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
35581>>>        Else If iError_Num eq 20001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Group permissions. Check with your Administrator"    to sLektiko
35585>>>        Else If iError_Num eq 20002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
35589>>>        Else If iError_Num eq 20003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
35593>>>        Else If iError_Num eq  9999 Move "Unknown User in Users File"                                                                                    to sLektiko
35597>>>        Else If iError_Num eq 20101 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Change its Data"                 to sLektiko
35601>>>        Else If iError_Num eq 20102 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Delete It"                       to sLektiko
35605>>>        Append sLektiko '\nFile = ' (String(cpiFileNumber(Self))) ' - ' (CpsFileName(Self))
35609>>>
35609>>>             If iError_Num eq 10000 Error 10000 sLektiko
35612>>>        Else If iError_Num eq 10001 Error 10001 sLektiko
35616>>>        Else If iError_Num eq 10002 Error 10002 sLektiko
35620>>>        Else If iError_Num eq 10003 Error 10003 sLektiko
35624>>>        Else If iError_Num eq 20000 Error 20000 sLektiko
35628>>>        Else If iError_Num eq 20001 Error 20001 sLektiko
35632>>>        Else If iError_Num eq 20002 Error 20002 sLektiko
35636>>>        Else If iError_Num eq 20003 Error 20003 sLektiko
35640>>>        Else If iError_Num eq  9999 Error  9999 sLektiko
35644>>>        Else If iError_Num eq 20101 Error 20101 sLektiko
35648>>>        Else If iError_Num eq 20102 Error 20102 sLektiko
35652>>>
35652>>>        Else Forward Send Operation_Not_Allowed  iError_Num
35655>>>    End_Procedure   // Operation_Not_Allowed
35656>>>
35656>>>
35656>>>End_Class //Datadictionary_Sec
35657>
35657>//------------------------------
35657>Use Flexole
INCLUDING FILE: FLEXOLE.PKG
35657>>>//****************************************************************************
35657>>>//
35657>>>// $File name  : FlexOLE
35657>>>// $File title : Base class for OLE Automation in DataFlex under win95/NT
35657>>>// Notice      : Copyright (c) ADB-UTVECKLING AB 1996-1998
35657>>>// $Author     : JW, SF
35657>>>// $System     : DFOLE
35657>>>// Created     : 96-05-30 @ 18.12.51
35657>>>// $Last Rev   : 96-10-09 @ 14.59.35
35657>>>//
35657>>>// $Description
35657>>>// This file contains the complete FlexOLE OLE2 implementation in DataFlex.
35657>>>// Including all DLL interface declarations and DataFlex classes
35657>>>//
35657>>>// $Rev History
35657>>>//   96-05-30 File header created
35657>>>//
35657>>>//****************************************************************************
35657>>>
35657>>>USE DLL
35657>>>USE FOLE_API
INCLUDING FILE: FOLE_API.PKG
35657>>>>>//****************************************************************************
35657>>>>>//
35657>>>>>// $File name  : FOLE_API
35657>>>>>// $File title : API for FlexOLE
35657>>>>>// Notice      : Copyright (c) ADB-UTVECKLING AB 1996-1998
35657>>>>>// $Author     : JW, SF
35657>>>>>// $System     : FlexOLE
35657>>>>>// Created     : 96-05-30 @ 18.12.51
35657>>>>>// $Last Rev   : 96-10-09 @ 14.59.35
35657>>>>>//
35657>>>>>// $Description
35657>>>>>//  DLL interface declarations
35657>>>>>//
35657>>>>>// $Rev History
35657>>>>>//   96-05-30 File header created
35657>>>>>//
35657>>>>>//****************************************************************************
35657>>>>>
35657>>>>>
35657>>>>>USE DLL
35657>>>>>
35657>>>>>// Global variable for OLE
35657>>>>>Integer WM_DFOCXEVENT // This is the message sent from the DLL
35657>>>>>Integer WM_DFOCXNOTIFYEVENT // This is the notify message sent from the DLL
35657>>>>>
35657>>>>>//Global integer for objectId
35657>>>>>Integer oOLEVariantId
35657>>>>>
35657>>>>>
35657>>>>>
35657>>>>>// Optional param for OLEVariant.
35657>>>>>// For optional parameters, pass OLE_VT_OPTIONAL instead of an OLEVariant
35657>>>>>
35657>>>>>// DISP_E_PARAMNOTFOUND is the constant used together with OLE_VT_ERROR
35657>>>>>// to signify that this parameter is optional and not specified.
35657>>>>>// It is only used internally, DON'T use it directly, see above constant.
35657>>>>>
35657>>>>>// The current maximum size of strings, used both for String and OLEVariant with OLE_VT_BSTR
35657>>>>>
35657>>>>>// Null terminating for C strings
35657>>>>>
35657>>>>>// Alias data types
35657>>>>>                            // but since DataFlex has no substitute data type
35657>>>>>                            // it is internally casted back and forth
35657>>>>>                            // into an Integer
35657>>>>>                            // NOTE! Might be changed to a one char string
35657>>>>>
35657>>>>>
35657>>>>>
35657>>>>>// Pointers to vars needs to be inside a Type to use GetAddress...
35657>>>>>// It looks like we have to create these anyway (to compile cleanly)
35657>>>>>
35657>>>>>
35657>>>>>Type TP_OLEVariant
35657>>>>>    Field Variant.vt     as DWORD      // An OLE_VT_XXX constant
35657>>>>>    Field Variant.iVal   as DWORD      // If vt is OLE_VT_I2 this field contains a Short value
35657>>>>>    Field Variant.lVal   as DWORD      // If vt is OLE_VT_I4 this field contains an Integer value
35657>>>>>    Field Variant.fltVal as Char 10    // If vt is OLE_VT_R4 this field contains a ShortReal value
35657>>>>>    Field Variant.dblVal as Char 20    // If vt is OLE_VT_R8 this field contains a Real value
35657>>>>>    Field Variant.cyVal  as Char 25    // If vt is OLE_VT_CY this field contains a Currency value
35657>>>>>    Field Variant.dtVal  as Date       // If vt is OLE_VT_DATE this field contains a Date value
35657>>>>>    Field Variant.strVal as Char 255   // If vt is OLE_VT_BSTR this field contains a pointer to a String
35657>>>>>    Field Variant.dspVal as LPDISPATCH // If vt is OLE_VT_DISPATCH this field contains an LPDISPATCH
35657>>>>>    Field Variant.errVal as OLEError   // If vt is OLE_VT_ERROR this field contains an OLEError
35657>>>>>    Field Variant.blVal  as Bool       // If vt is OLE_VT_BOOL this field contains a Bool value
35657>>>>>    Field Variant.uknVal as LPIUNKNOWN // If vt is OLE_VT_UNKNOWN this field contains an LPIUnknown
35657>>>>>    Field Variant.ui1Val as DWORD      // If vt is OLE_VT_UI1 this field contains a UChar value
35657>>>>>End_Type
35657>>>>>
35657>>>>>
35657>>>>>// VARIANT constants used with the vt field in an OLEVariant type
35657>>>>>
35657>>>>>
35657>>>>>
35657>>>>>// SetFocus/KillFocus event, sent in wParam of WM_DFOCXNOTIFYEVENT
35657>>>>>
35657>>>>>// Used to register the OCX event notification messages
35657>>>>>External_Function32 RegisterWindowMessage "RegisterWindowMessageA" USER32.DLL;                    String sWM_MSG;                    Returns Integer
35658>>>>>
35658>>>>>// External functions providing access to DFOLECLN.DLL
35658>>>>>// These functions are normally not accessed directly, they are
35658>>>>>// rather accessed through an Automation_Client/OCX_Client derived class/object
35658>>>>>
35658>>>>>//********DLL Interface OLE Auto General Functions************
35658>>>>>
35658>>>>>External_Function32 CreateAutomationClient "CreateAutomationClient" DFOLECLN.DLL;                    Returns DWORD
35659>>>>>
35659>>>>>
35659>>>>>External_Function32 DestroyAutomationClient "DestroyAutomationClient" DFOLECLN.DLL;                    Integer clientId;                    Returns DWORD
35660>>>>>
35660>>>>>External_Function32 CreateAutoClientDispatch "CreateAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    String progIdStr;                    Returns DWORD
35661>>>>>
35661>>>>>External_Function32 AttachAutoClientDispatch "AttachAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    LPDispatch disp;                    Integer addRef;                    Returns DWORD
35662>>>>>
35662>>>>>External_Function32 AttachAutoClientActiveObject "AttachAutoClientActiveObject" DFOLECLN.DLL;                    Integer clientId;                    String progIdStr;                    Returns DWORD
35663>>>>>
35663>>>>>External_Function32 ReleaseAutoClientDispatch "ReleaseAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    Returns DWORD
35664>>>>>
35664>>>>>External_Function32 GetAutoClientDispatch "GetAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    Returns LPDispatch
35665>>>>>
35665>>>>>//********DLL Interface OLE Auto Get Property Functions**************
35665>>>>>
35665>>>>>External_Function32 GetAutoClientBoolProperty "GetAutoClientBoolProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35666>>>>>
35666>>>>>External_Function32 GetAutoClientCurrencyProperty "GetAutoClientCurrencyProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35667>>>>>
35667>>>>>External_Function32 GetAutoClientDateProperty "GetAutoClientDateProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Date
35668>>>>>
35668>>>>>External_Function32 GetAutoClientLPDispatchProperty "GetAutoClientLPDispatchProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns LPDispatch
35669>>>>>
35669>>>>>External_Function32 GetAutoClientRealProperty "GetAutoClientRealProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35670>>>>>
35670>>>>>External_Function32 GetAutoClientShortRealProperty "GetAutoClientShortRealProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Real
35671>>>>>
35671>>>>>External_Function32 GetAutoClientIntegerProperty "GetAutoClientIntegerProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35672>>>>>
35672>>>>>External_Function32 GetAutoClientShortProperty "GetAutoClientShortProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Integer
35673>>>>>
35673>>>>>
35673>>>>>External_Function32 GetAutoClientStringProperty "GetAutoClientStringProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns DWORD
35674>>>>>
35674>>>>>External_Function32 GetAutoClientOLEVariantProperty "GetAutoClientOLEVariantProperty" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    LPOLEVar destVar;                    Returns  LPOLEVar
35675>>>>>
35675>>>>>
35675>>>>>//********DLL Interface OLE Auto Set Property Functions**************
35675>>>>>
35675>>>>>External_Function32 SetAutoClientBoolProperty "SetAutoClientBoolProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    DWORD    prop;                    Returns DWORD
35676>>>>>
35676>>>>>External_Function32 SetAutoClientCurrencyProperty "SetAutoClientCurrencyProperty" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    String prop;                    Returns  DWORD
35677>>>>>
35677>>>>>External_Function32 SetAutoClientDateProperty "SetAutoClientDateProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Date    prop;                    Returns DWORD
35678>>>>>
35678>>>>>External_Function32 SetAutoClientLPDispatchProperty "SetAutoClientLPDispatchProperty" DFOLECLN.DLL;                    Integer    clientId;                    DWORD    dwDispId;                    LPDispatch prop;                    Returns    DWORD
35679>>>>>
35679>>>>>External_Function32 SetAutoClientRealProperty "SetAutoClientRealProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    String   prop;                    Returns DWORD
35680>>>>>
35680>>>>>External_Function32 SetAutoClientShortRealProperty "SetAutoClientShortRealProperty" DFOLECLN.DLL;                    Integer   clientId;                    DWORD   dwDispId;                    String prop;                    Returns   DWORD
35681>>>>>
35681>>>>>External_Function32 SetAutoClientIntegerProperty "SetAutoClientIntegerProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    DWORD prop;                    Returns DWORD
35682>>>>>
35682>>>>>External_Function32 SetAutoClientShortProperty "SetAutoClientShortProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Integer   prop;                    Returns DWORD
35683>>>>>
35683>>>>>External_Function32 SetAutoClientStringProperty "SetAutoClientStringProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    String  prop;                    Returns DWORD
35684>>>>>
35684>>>>>External_Function32 SetAutoClientOLEVariantProperty "SetAutoClientOLEVariantProperty" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    String prop;                    Returns  DWORD
35685>>>>>
35685>>>>>
35685>>>>>//******DLL Interface OLE Auto Pre Invoke Functions**************
35685>>>>>
35685>>>>>External_Function32 DeclareAutoClientInvokeParams "DeclareAutoClientInvokeParams" DFOLECLN.DLL;                    Integer clientId;                    DWORD nrOfParams;                    Returns DWORD
35686>>>>>
35686>>>>>External_Function32 DefineAutoClientBoolParam "DefineAutoClientBoolParam" DFOLECLN.DLL;                    Integer clientId;                    DWORD    param;                    Returns DWORD
35687>>>>>
35687>>>>>External_Function32 DefineAutoClientCurrencyParam "DefineAutoClientCurrencyParam" DFOLECLN.DLL;                    Integer clientId;                    String  param;                    Returns DWORD
35688>>>>>
35688>>>>>External_Function32 DefineAutoClientDateParam "DefineAutoClientDateParam" DFOLECLN.DLL;                    Integer clientId;                    Date    param;                    Returns DWORD
35689>>>>>
35689>>>>>External_Function32 DefineAutoClientRealParam "DefineAutoClientRealParam" DFOLECLN.DLL;                    Integer clientId;                    String    param;                    Returns DWORD
35690>>>>>
35690>>>>>External_Function32 DefineAutoClientShortRealParam "DefineAutoClientShortRealParam" DFOLECLN.DLL;                    Integer   clientId;                    String param;                    Returns   DWORD
35691>>>>>
35691>>>>>External_Function32 DefineAutoClientIntegerParam "DefineAutoClientIntegerParam" DFOLECLN.DLL;                    Integer clientId;                    DWORD param;                    Returns DWORD
35692>>>>>
35692>>>>>External_Function32 DefineAutoClientShortParam "DefineAutoClientShortParam" DFOLECLN.DLL;                    Integer clientId;                    Integer   param;                    Returns DWORD
35693>>>>>
35693>>>>>External_Function32 DefineAutoClientLPDispatchParam "DefineAutoClientLPDispatchParam" DFOLECLN.DLL;                    Integer clientId;                    LPDispatch param;                    Returns DWORD
35694>>>>>
35694>>>>>External_Function32 DefineAutoClientStringParam "DefineAutoClientStringParam" DFOLECLN.DLL;                    Integer clientId;                    String  param;                    Returns DWORD
35695>>>>>
35695>>>>>External_Function32 DefineAutoClientOLEVariantParam "DefineAutoClientOLEVariantParam" DFOLECLN.DLL;                    Integer  clientId;                    OLEVariant param;                    Returns  DWORD
35696>>>>>
35696>>>>>//********DLL Interface OLE Auto Invoke Functions*********************
35696>>>>>
35696>>>>>External_Function32 InvokeAutoClientVoidFunction "InvokeAutoClientVoidFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35697>>>>>
35697>>>>>External_Function32 InvokeAutoClientBoolFunction "InvokeAutoClientBoolFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35698>>>>>
35698>>>>>External_Function32 InvokeAutoClientCurrencyFunction "InvokeAutoClientCurrencyFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35699>>>>>
35699>>>>>External_Function32 InvokeAutoClientDateFunction "InvokeAutoClientDateFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Date
35700>>>>>
35700>>>>>External_Function32 InvokeAutoClientLPDispatchFunction "InvokeAutoClientLPDispatchFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns LPDispatch
35701>>>>>
35701>>>>>External_Function32 InvokeAutoClientRealFunction "InvokeAutoClientRealFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35702>>>>>
35702>>>>>External_Function32 InvokeAutoClientShortRealFunction "InvokeAutoClientShortRealFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35703>>>>>
35703>>>>>External_Function32 InvokeAutoClientIntegerFunction "InvokeAutoClientIntegerFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35704>>>>>
35704>>>>>External_Function32 InvokeAutoClientShortFunction "InvokeAutoClientShortFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Integer
35705>>>>>
35705>>>>>External_Function32 InvokeAutoClientStringFunction "InvokeAutoClientStringFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer  destStr;                    Returns Integer
35706>>>>>
35706>>>>>
35706>>>>>External_Function32 InvokeAutoClientOLEVariantFunction "InvokeAutoClientOLEVariantFunction" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    LPOLEVar destVar;                    Returns  Integer
35707>>>>>
35707>>>>>//********DLL Interface OLE Control Functions*********************
35707>>>>>
35707>>>>>
35707>>>>>External_Function32 CreateOCXClient "CreateOCXClient" DFOLECLN.DLL;                    Returns Integer
35708>>>>>
35708>>>>>
35708>>>>>External_Function32 CreateOCXControl "CreateOCXControl" DFOLECLN.DLL;                    Integer iCId;                    Pointer pPar;                    String  sCId;                    String  sCap;                    Dword   wSty;                    String  sLic;                    String  sFile;                    Returns Integer
35709>>>>>
35709>>>>>External_Function32 DestroyOCXControl "DestroyOCXControl" DFOLECLN.DLL;                    Integer iClientId;                    Returns Integer
35710>>>>>
35710>>>>>External_Function32 GetOCXEventBoolParam "GetOCXEventBoolParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Integer
35711>>>>>
35711>>>>>External_Function32 GetOCXEventCurrencyParam "GetOCXEventCurrencyParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer destStr;                    Returns Integer
35712>>>>>
35712>>>>>External_Function32 GetOCXEventDateParam "GetOCXEventDateParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Date
35713>>>>>
35713>>>>>External_Function32 GetOCXEventRealParam "GetOCXEventRealParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer destStr;                    Returns Integer
35714>>>>>
35714>>>>>External_Function32 GetOCXEventShortRealParam "GetOCXEventShortRealParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer destStr;                    Returns Integer
35715>>>>>
35715>>>>>External_Function32 GetOCXEventIntegerParam "GetOCXEventIntegerParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Integer
35716>>>>>
35716>>>>>External_Function32 GetOCXEventShortParam "GetOCXEventShortParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Integer
35717>>>>>
35717>>>>>External_Function32 GetOCXEventStringParam "GetOCXEventStringParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer pDestStr;                    Returns Integer
35718>>>>>
35718>>>>>External_Function32 GetOCXEventOLEVariantParam "GetOCXEventOLEVariantParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    LPOLEVAR pDestVar;                    Returns Integer
35719>>>>>
35719>>>>>External_Function32 EnableOCXControl "EnableOCXControl" DFOLECLN.DLL;                    Integer iClientId;                    BOOL bEnable;                    Returns Integer
35720>>>>>
35720>>>>>External_Function32 GetOCXControlCaption "GetOCXControlCaption" DFOLECLN.DLL;                    Integer iClientId;                    Pointer lpDestStr;                    Returns Integer
35721>>>>>
35721>>>>>External_Function32 SetOCXControlCaption "SetOCXControlCaption" DFOLECLN.DLL;                    Integer iClientId;                    String  sCaption;                    Returns Integer
35722>>>>>
35722>>>>>External_Function32 LoadOlePicture "LoadOlePicture" DFOLECLN.DLL;                    String  sFilename;                    Returns LPDispatch
35723>>>>>
35723>>>>>External_Function32 ReleaseComPointer "ReleaseComPtr" DFOLECLN.DLL;                    LPIUnknown  comPtr;                    Returns Integer
35724>>>>>
35724>>>>>External_Function32 DFOleInit "DFOleInit" DFOLECLN.DLL;                    Returns Integer
35725>>>>>
35725>>>>>External_Function32 DFOleUninit "DFOleUninit" DFOLECLN.DLL;                    Returns Integer
35726>>>>>
35726>>>>>External_Function32 AlterOCXEventParam "AlterOCXEventParam" DFOLECLN.DLL;                    Pointer  pdispParams;                    Integer iparam;                    OLEVariant vNewValue;                    Returns  Integer
35727>>>>>
35727>>>>>
35727>>>>>
35727>>>>>// This command is only used internaly and should NOT be used by the developer
35727>>>>>
35727>>>USE DFEXTCLM
35727>>>USE EXTFRM
35727>>>USE DBEXTFRM
35727>>>
35727>>>//**********
35727>>>//*** Error messages***
35727>>>//**********
35727>>>
35727>>>    Enum_List
35727>>>        Define OLE_SV_LANG
35727>>>        Define OLE_US_LANG
35727>>>    End_Enum_List
35727>>>
35727>>>    Define OLE_CURR_LANG For OLE_US_LANG
35727>>>
35727>>>        //*** US
INCLUDING FILE: FLXOLEUS.INC
35727>>>>
35727>>>
35727>>>
35727>>>// This class encapsulates the behaviour of an OLEVariant, and simplifies
35727>>>// tasks involved working with the OLEVariant.
35727>>>Class cOLEVariant is an array
35728>>>    Procedure Construct_Object
35729>>>        Forward Send Construct_Object
35731>>>        Local Integer iRetVal
35732>>>        Move (DFOleInit()) to iRetVal
35733>>>        Send OCXInit
35734>>>    End_Procedure
35735>>>
35735>>>    Procedure Destroy_Object
35736>>>        Local Integer iRetVal
35737>>>        Move (DFOleUninit()) to iRetVal
35738>>>        Forward Send Destroy_Object
35740>>>    End_Procedure
35741>>>
35741>>>    Procedure OCXInit
35742>>>        Move (RegisterWindowMessage("WM_DFOCXEVENT")) to WM_DFOCXEVENT
35743>>>        Move (RegisterWindowMessage("WM_DFOCXNOTIFYEVENT")) to WM_DFOCXNOTIFYEVENT
35744>>>    End_Procedure
35745>>>
35745>>>    Function GetType  OLEVariant var Returns DWORD
35746>>>        Local DWORD varVt
35747>>>        GetBuff from var at Variant.vt to varVt
35748>>>        Function_Return varVt
35749>>>    End_Function
35750>>>
35750>>>    Function GetShort OLEVariant var Returns Integer
35751>>>        Local Integer iVal
35752>>>        GetBuff from var at Variant.iVal to iVal
35753>>>        Function_Return iVal
35754>>>    End_Function
35755>>>
35755>>>    Function GetInteger OLEVariant var Returns Integer
35756>>>        Local Integer lVal
35757>>>        GetBuff from var at Variant.lVal to lVal
35758>>>        Function_Return lVal
35759>>>    End_Function
35760>>>
35760>>>    Function GetFloat OLEVariant var Returns OLEReal
35761>>>        Local OLEReal fltVal
35762>>>        GetBuff_String from var at Variant.fltVal to fltVal
35763>>>        Function_Return fltVal
35764>>>    End_Function
35765>>>
35765>>>    Function GetDouble OLEVariant var Returns OLEReal
35766>>>        Local OLEReal dblVal
35767>>>        GetBuff_String from var at Variant.dblVal to dblVal
35768>>>        Function_Return dblVal
35769>>>    End_Function
35770>>>
35770>>>    Function GetCurrency OLEVariant var Returns Number
35771>>>        Local Number cyVal
35772>>>        GetBuff_String from var at Variant.cyVal to cyVal
35773>>>        Function_Return cyVal
35774>>>    End_Function
35775>>>
35775>>>    Function GetDate OLEVariant var Returns Date
35776>>>        Local Date dtVal
35777>>>        GetBuff from var at Variant.dtVal to dtVal
35778>>>        Function_Return dtVal
35779>>>    End_Function
35780>>>
35780>>>    Function GetString OLEVariant var Returns String
35781>>>        Local String strVal
35782>>>        GetBuff_String from var at Variant.strVal to strVal
35783>>>        Function_Return strVal
35784>>>    End_Function
35785>>>
35785>>>    Function GetLPDispatch OLEVariant var Returns LPDispatch
35786>>>        Local LPDispatch dspVal
35787>>>        GetBuff from var at Variant.dspVal to dspVal
35788>>>        Function_Return dspVal
35789>>>    End_Function
35790>>>
35790>>>    Function GetOLEError OLEVariant var Returns OLEError
35791>>>        Local OLEError errVal
35792>>>        GetBuff from var at Variant.errVal to errVal
35793>>>        Function_Return errVal
35794>>>    End_Function
35795>>>
35795>>>    Function GetBool OLEVariant var Returns Bool
35796>>>        Local Bool blVal
35797>>>        GetBuff from var at Variant.blVal to blVal
35798>>>        Function_Return blVal
35799>>>    End_Function
35800>>>
35800>>>    Function GetLPIUnknown OLEVariant var Returns LPIUnknown
35801>>>        Local LPIUnknown uknVal
35802>>>        GetBuff from var at Variant.uknVal to uknVal
35803>>>        Function_Return uknVal
35804>>>    End_Function
35805>>>
35805>>>    Function GetUChar OLEVariant var Returns UChar
35806>>>        Local UChar ui1Val
35807>>>        GetBuff from var at Variant.ui1Val to ui1Val
35808>>>        Function_Return ui1Val
35809>>>    End_Function
35810>>>
35810>>>    Function GetValue OLEVariant var Returns String
35811>>>        Local DWORD vt
35812>>>        Local String retVal
35812>>>        Get GetType var to vt
35813>>>             If vt Eq OLE_VT_I2        Get GetShort var to retVal
35816>>>        Else If vt Eq OLE_VT_I4        Get GetInteger var to retVal
35820>>>        Else If vt Eq OLE_VT_R4        Get GetFloat var to retVal
35824>>>        Else If vt Eq OLE_VT_R8        Get GetDouble var to retVal
35828>>>        Else If vt Eq OLE_VT_CY        Get GetCurrency var to retVal
35832>>>        Else If vt Eq OLE_VT_DATE      Get GetDate var to retVal
35836>>>        Else If vt Eq OLE_VT_BSTR      Get GetString var to retVal
35840>>>        Else If vt Eq OLE_VT_DISPATCH  Get GetLPDispatch var to retVal
35844>>>        Else If vt Eq OLE_VT_ERROR     Get GetOLEError var to retVal
35848>>>        Else If vt Eq OLE_VT_BOOL      Get GetBool var to retVal
35852>>>        Else If vt Eq OLE_VT_UNKNOWN   Get GetLPIUnknown var to retVal
35856>>>        Else If vt Eq OLE_VT_UI1       Get GetUChar var to retVal
35860>>>        Function_Return retVal
35861>>>    End_Function
35862>>>
35862>>>    Function PutValue DWORD vt String val Returns OLEVariant
35863>>>        Inst_OLEVariant var
35865>>>        Put vt to var at Variant.vt
35866>>>             If vt Eq OLE_VT_I2        Put (Integer(val)) to var at Variant.iVal
35869>>>        Else If vt Eq OLE_VT_I4        Put (Integer(val)) to var at Variant.lVal
35873>>>        Else If vt Eq OLE_VT_R4        Put_String val to var at Variant.fltVal
35877>>>        Else If vt Eq OLE_VT_R8        Put_String val to var at Variant.dblVal
35881>>>        Else If vt Eq OLE_VT_CY        Put_String val to var at Variant.cyVal
35885>>>        Else If vt Eq OLE_VT_DATE      Put (Date(val)) to var at Variant.dtVal
35889>>>        Else If vt Eq OLE_VT_BSTR      Put_String val to var at Variant.strVal
35893>>>        Else If vt Eq OLE_VT_DISPATCH  Put (LPDispatch(val)) to var at Variant.dspVal
35897>>>        Else If vt Eq OLE_VT_ERROR     Put (OLEError(val)) to var at Variant.errVal
35901>>>        Else If vt Eq OLE_VT_BOOL      Put (Bool(val)) to var at Variant.blVal
35905>>>        Else If vt Eq OLE_VT_UNKNOWN   Put (LPIUnknown(val)) to var at Variant.uknVal
35909>>>        Else If vt Eq OLE_VT_UI1       Put (UChar(val)) to var at Variant.ui1Val
35913>>>        Else begin
35914>>>            Put OLE_VT_ERROR to var at Variant.vt
35915>>>            Put DISP_E_PARAMNOTFOUND to var at Variant.errVal
35916>>>        End
35916>>>>
35916>>>        Function_Return var
35917>>>    End_Function
35918>>>
35918>>>End_Class
35919>>>
35919>>>// The one and only cOLEVariant helper object
35919>>>Object oOLEVariant is a cOLEVariant
35921>>>        Move Current_Object to oOLEVariantId
35922>>>End_Object
35923>>>
35923>>>//Command so we get nicer code for the events, only used internally
35923>>>
35923>>>// Command to extract the value of an OLEVariant no matter what datatype its currently holding
35923>>>
35923>>>// Command to both set the datatype and value to an OLEVariant
35923>>>
35923>>>
35923>>>// The OLE Base class, all OLE classes are derived from this class
35923>>>// Defines basic functionality and conversation with DLL interface
35923>>>
35923>>>Class cCOM_IDispatch is a Message
35924>>>
35924>>>    Procedure DefineCOM_IDispatch
35925>>>        Property String  progIdStr Public ""
35926>>>        Property Integer ClientId Public 0
35927>>>        Property Integer AutoAddRef Public 0
35928>>>    End_Procedure
35929>>>
35929>>>// GetProperty functions
35929>>>    Function GetIntegerProperty DWORD dwDispId returns Integer
35930>>>        Local Integer lpropVal iClientId
35931>>>        Get clientId to iClientId
35932>>>        Move (GetAutoClientIntegerProperty (iClientId,dwDispId)) to lpropVal
35933>>>        Function_Return lpropVal
35934>>>    End_Function
35935>>>
35935>>>    Function GetShortProperty DWORD dwDispId returns Integer
35936>>>        Local Integer lpropVal iClientId
35937>>>        Get clientId to iClientId
35938>>>        Move (GetAutoClientShortProperty (iClientId,dwDispId)) to lpropVal
35939>>>        Function_Return lpropVal
35940>>>    End_Function
35941>>>
35941>>>    Function GetBoolProperty DWORD dwDispId returns BOOL
35942>>>        Local BOOL lpropVal
35943>>>        Local Integer iClientId
35943>>>        Get clientId to iClientId
35944>>>        Move (GetAutoClientBoolProperty (iClientId,dwDispId)) to lpropVal
35945>>>        Function_Return lpropVal
35946>>>    End_Function
35947>>>
35947>>>    Function GetCurrencyProperty DWORD dwDispId returns Number
35948>>>        Local Number lpropVal
35949>>>        Local String lsProp
35949>>>        Local Integer iClientId iRetVal
35949>>>        Local Pointer llpsprop
35949>>>        Get clientId to iClientId
35950>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lsProp
35951>>>        GetAddress of lsprop to llpsprop
35952>>>        Move (GetAutoClientCurrencyProperty (iClientId,dwDispId,llpsprop)) to iRetVal
35953>>>        Move lsProp to lpropVal
35954>>>        Function_Return lpropVal
35955>>>    End_Function
35956>>>
35956>>>    Function GetDateProperty DWORD dwDispId returns Date
35957>>>        Local Date lpropVal
35958>>>        Local Integer iClientId
35958>>>        Get clientId to iClientId
35959>>>        Move (GetAutoClientDateProperty (iClientId,dwDispId)) to lpropVal
35960>>>        Function_Return lpropVal
35961>>>    End_Function
35962>>>
35962>>>    Function GetLPDispatchProperty DWORD dwDispId returns Date
35963>>>        Local LPDispatch lpropVal
35964>>>        Local Integer iClientId
35964>>>        Get clientId to iClientId
35965>>>        Move (GetAutoClientLPDispatchProperty (iClientId,dwDispId)) to lpropVal
35966>>>        Function_Return lpropVal
35967>>>    End_Function
35968>>>
35968>>>    Function GetRealProperty DWORD dwDispId returns OLEReal
35969>>>        Local OLEReal lpropVal
35970>>>        Local Integer iClientId iRetVal
35970>>>        Local String lsProp
35970>>>        Local Pointer llpsprop
35970>>>        Get clientId to iClientId
35971>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lsProp
35972>>>        GetAddress of lsprop to llpsprop
35973>>>        Move (GetAutoClientRealProperty (iClientId,dwDispId,llpsprop)) to iRetVal
35974>>>        Move lsProp to lpropVal
35975>>>        Function_Return lpropVal
35976>>>    End_Function
35977>>>
35977>>>    Function GetShortRealProperty DWORD dwDispId returns OLEReal
35978>>>        Local OLEReal lpropVal
35979>>>        Local Integer iClientId iRetVal
35979>>>        Local String lsProp
35979>>>        Local Pointer llpsprop
35979>>>        Get clientId to iClientId
35980>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lsProp
35981>>>        GetAddress of lsprop to llpsprop
35982>>>        Move (GetAutoClientShortRealProperty (iClientId,dwDispId,llpsprop)) to iRetVal
35983>>>        Move lsProp to lpropVal
35984>>>        Function_Return lpropVal
35985>>>    End_Function
35986>>>
35986>>>    Function GetStringProperty DWORD dwDispId returns String
35987>>>        Local String lpropVal
35988>>>        Local Integer iClientId iRetVal
35988>>>        Local Pointer llppropVal
35988>>>        Get clientId to iClientId
35989>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lpropVal
35990>>>        GetAddress of lpropVal to llppropval
35991>>>        Move (GetAutoClientStringProperty (iClientId,dwDispId,llppropVal)) to iRetVal
35992>>>        Function_Return (CString(lpropVal))
35993>>>    End_Function
35994>>>
35994>>>    Function GetOLEVariantProperty DWORD dwDispId returns OLEVariant
35995>>>        Local OLEVariant lpropVal
35996>>>        Local Integer iClientId iRetVal
35996>>>        Local Pointer llppropVal
35996>>>        Get clientId to iClientId
35997>>>        ZeroType TP_OLEVariant to lpropVal
35998>>>        GetAddress of lpropVal to llppropval
35999>>>        Move (GetAutoClientOLEVariantProperty (iClientId,dwDispId,llppropVal)) to iRetVal
36000>>>        Function_Return lpropVal
36001>>>    End_Function
36002>>>
36002>>>// SetProperty procedures
36002>>>    Procedure SetIntegerProperty DWORD dwDispId Integer lpropVal
36003>>>        Local Integer iClientId iRetVal
36004>>>        Get ClientId to iClientId
36005>>>        Move (SetAutoClientIntegerProperty (iClientId,dwDispId,lpropVal)) to iRetVal
36006>>>    End_Procedure
36007>>>
36007>>>    Procedure SetShortProperty DWORD dwDispId Integer lpropVal
36008>>>        Local Integer iClientId iRetVal
36009>>>        Get ClientId to iClientId
36010>>>        Move (SetAutoClientShortProperty (iClientId,dwDispId,lpropVal)) to iRetVal
36011>>>    End_Procedure
36012>>>
36012>>>    Procedure SetBoolProperty DWORD dwDispId BOOL lpropVal
36013>>>        Local Integer iClientId iRetVal
36014>>>        Get ClientId to iClientId
36015>>>        Move (SetAutoClientShortProperty (iClientId,dwDispId,lpropVal)) to iRetVal
36016>>>    End_Procedure
36017>>>
36017>>>    Procedure SetCurrencyProperty DWORD dwDispId Number lpropVal
36018>>>        Local Integer iClientId iRetVal
36019>>>        Local String lsprop
36019>>>        Get ClientId to iClientId
36020>>>        Move lpropVal to lsprop
36021>>>        Move (SetAutoClientCurrencyProperty(iClientId,dwDispId,lsprop)) to iRetVal
36022>>>    End_Procedure
36023>>>
36023>>>    Procedure SetDateProperty DWORD dwDispId Date lpropVal
36024>>>        Local Integer iClientId iRetVal
36025>>>        Get ClientId to iClientId
36026>>>        Move (SetAutoClientDateProperty(iClientId,dwDispId,lpropVal)) to iRetVal
36027>>>    End_Procedure
36028>>>
36028>>>    Procedure SetLPDispatchProperty DWORD dwDispId LPDispatch lpropVal
36029>>>        Local Integer iClientId iRetVal
36030>>>        Get ClientId to iClientId
36031>>>        Move (SetAutoClientLPDispatchProperty(iClientId,dwDispId,lpropVal)) to iRetVal
36032>>>    End_Procedure
36033>>>
36033>>>    Procedure SetRealProperty DWORD dwDispId OLEReal lpropVal
36034>>>        Local Integer iClientId iRetVal
36035>>>        Local String lsprop
36035>>>        Get ClientId to iClientId
36036>>>        Move lpropVal to lsprop
36037>>>        Move (SetAutoClientRealProperty(iClientId,dwDispId,lsprop)) to iRetVal
36038>>>    End_Procedure
36039>>>
36039>>>    Procedure SetShortRealProperty DWORD dwDispId OLEReal lpropVal
36040>>>        Local Integer iClientId iRetVal
36041>>>        Local String lsprop
36041>>>        Get ClientId to iClientId
36042>>>        Move lpropVal to lsprop
36043>>>        Move (SetAutoClientShortRealProperty(iClientId,dwDispId,lsprop)) to iRetVal
36044>>>    End_Procedure
36045>>>
36045>>>    Procedure SetStringProperty DWORD dwDispId String lpropVal
36046>>>        Local Integer iClientId iRetVal
36047>>>        Get ClientId to iClientId
36048>>>        Move (SetAutoClientStringProperty(iClientId,dwDispId,lpropVal)) to iRetVal
36049>>>    End_Procedure
36050>>>
36050>>>    Procedure SetOLEVariantProperty DWORD dwDispId OLEVariant lpropVal
36051>>>        Local Integer iClientId iRetVal
36052>>>        Get ClientId to iClientId
36053>>>        If (Length(lpropval)) Lt TP_OLEVariant_Size;            Get PutValue of oOLEVariantId OLE_VT_ERROR DISP_E_PARAMNOTFOUND to lpropVal
36056>>>        Move (SetAutoClientOLEVariantProperty(iClientId,dwDispId,lpropVal)) to iRetVal
36057>>>    End_Procedure
36058>>>
36058>>>// Pre-Invoke functions
36058>>>    Procedure DeclareParams Integer nrOfParams
36059>>>        Local Integer iClientId iRetVal
36060>>>        Get ClientId to iCLientId
36061>>>        Move (DeclareAutoClientInvokeParams(iClientId,nrOfParams)) to iRetVal
36062>>>    End_Procedure
36063>>>
36063>>>    Procedure DefineIntegerParam Integer param
36064>>>        Local Integer iClientId iRetVal
36065>>>        Get ClientId to iClientId
36066>>>        Move (DefineAutoClientIntegerParam(iClientId,param)) to iRetVal
36067>>>    End_Procedure
36068>>>
36068>>>    Procedure DefineShortParam Integer param
36069>>>        Local Integer iClientId iRetVal
36070>>>        Get ClientId to iClientId
36071>>>        Move (DefineAutoClientShortParam(iClientId,param)) to iRetVal
36072>>>    End_Procedure
36073>>>
36073>>>    Procedure DefineBoolParam BOOL param
36074>>>        Local Integer iClientId iRetVal
36075>>>        Get ClientId to iClientId
36076>>>        Move (DefineAutoClientBoolParam(iClientId,param)) to iRetVal
36077>>>    End_Procedure
36078>>>
36078>>>    Procedure DefineCurrencyParam Number param
36079>>>        Local Integer iClientId iRetVal
36080>>>        Local String lsparam
36080>>>        Get ClientId to iClientId
36081>>>        Move param to lsparam
36082>>>        Move (DefineAutoClientCurrencyParam(iClientId,lsparam)) to iRetVal
36083>>>    End_Procedure
36084>>>
36084>>>    Procedure DefineDateParam Date param
36085>>>        Local Integer iClientId iRetVal
36086>>>        Get ClientId to iClientId
36087>>>        Move (DefineAutoClientDateParam(iClientId,param)) to iRetVal
36088>>>    End_Procedure
36089>>>
36089>>>    Procedure DefineLPDispatchParam LPDispatch param
36090>>>        Local Integer iClientId iRetVal
36091>>>        Get ClientId to iClientId
36092>>>        Move (DefineAutoClientLPDispatchParam(iClientId,param)) to iRetVal
36093>>>    End_Procedure
36094>>>
36094>>>    Procedure DefineRealParam OLEReal param
36095>>>        Local Integer iClientId iRetVal
36096>>>        Local String lsparam
36096>>>        Get ClientId to iClientId
36097>>>        Move param to lsparam
36098>>>        Move (DefineAutoClientRealParam(iClientId,lsparam)) to iRetVal
36099>>>    End_Procedure
36100>>>
36100>>>    Procedure DefineShortRealParam OLEReal param
36101>>>        Local Integer iClientId iRetVal
36102>>>        Local String lsparam
36102>>>        Get ClientId to iClientId
36103>>>        Move param to lsparam
36104>>>        Move (DefineAutoClientShortRealParam(iClientId,lsparam)) to iRetVal
36105>>>    End_Procedure
36106>>>
36106>>>    Procedure DefineStringParam String param
36107>>>        Local Integer iClientId iRetVal
36108>>>        Get ClientId to iClientId
36109>>>        Append param OLENull
36110>>>        Move (DefineAutoClientStringParam(iClientId,param)) to iRetVal
36111>>>    End_Procedure
36112>>>
36112>>>    Procedure DefineOLEVariantParam OLEVariant param
36113>>>        Local Integer iClientId iRetVal
36114>>>        Get ClientId to iClientId
36115>>>        If (Length(param)) Lt TP_OLEVariant_Size ;            Get PutValue of oOLEVariantId OLE_VT_ERROR DISP_E_PARAMNOTFOUND to param
36118>>>        Move (DefineAutoClientOLEVariantParam(iClientId,param)) to iRetVal
36119>>>    End_Procedure
36120>>>
36120>>>// Invoke functions
36120>>>    Procedure InvokeVoidFunction DWORD dwDispId
36121>>>        Local Integer iClientId iRetVal
36122>>>        Get ClientId to iClientId
36123>>>        Move (InvokeAutoClientVoidFunction(iClientId,dwDispId)) to iRetVal
36124>>>    End_Procedure
36125>>>
36125>>>    Function InvokeIntegerFunction DWORD dwDispId returns Integer
36126>>>        Local Integer iClientId iRetVal
36127>>>        Get ClientId to iClientId
36128>>>        Move (InvokeAutoClientIntegerFunction(iClientId,dwDispId)) to iRetVal
36129>>>        Function_Return iRetVal
36130>>>    End_Function
36131>>>
36131>>>    Function InvokeShortFunction DWORD dwDispId returns Integer
36132>>>        Local Integer iClientId iRetVal
36133>>>        Get ClientId to iClientId
36134>>>        Move (InvokeAutoClientShortFunction(iClientId,dwDispId)) to iRetVal
36135>>>        Function_Return iRetVal
36136>>>    End_Function
36137>>>
36137>>>    Function InvokeBoolFunction DWORD dwDispId returns BOOL
36138>>>        Local Integer iClientId iRetVal
36139>>>        Get ClientId to iClientId
36140>>>        Move (InvokeAutoClientBoolFunction(iClientId,dwDispId)) to iRetVal
36141>>>        Function_Return iRetVal
36142>>>    End_Function
36143>>>
36143>>>    Function InvokeCurrencyFunction DWORD dwDispId returns Number
36144>>>        Local Integer iClientId iRetVal
36145>>>        Local Number nRetVal
36145>>>        Local String sRetVal
36145>>>        Local Pointer psRetVal
36145>>>        Get ClientId to iClientId
36146>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
36147>>>        GetAddress of sRetVal to psRetVal
36148>>>        Move (InvokeAutoClientCurrencyFunction(iClientId,dwDispId,psRetVal)) to iRetVal
36149>>>        Move sRetVal to nRetVal
36150>>>        Function_Return nRetVal
36151>>>    End_Function
36152>>>
36152>>>    Function InvokeDateFunction DWORD dwDispId returns Date
36153>>>        Local Integer iClientId
36154>>>        Local Date dRetVal
36154>>>        Get ClientId to iClientId
36155>>>        Move (InvokeAutoClientDateFunction(iClientId,dwDispId)) to dRetVal
36156>>>        Function_Return dRetVal
36157>>>    End_Function
36158>>>
36158>>>    Function InvokeLPDispatchFunction DWORD dwDispId returns LPDispatch
36159>>>        Local Integer iClientId
36160>>>        Local LPDispatch lpdRetVal
36160>>>        Get ClientId to iClientId
36161>>>        Move (InvokeAutoClientLPDispatchFunction(iClientId,dwDispId)) to lpdRetVal
36162>>>        Function_Return lpdRetVal
36163>>>    End_Function
36164>>>
36164>>>    Function InvokeRealFunction DWORD dwDispId returns OLEReal
36165>>>        Local Integer iClientId iRetVal
36166>>>        Local OLEReal rRetVal
36166>>>        Local String sRetVal
36166>>>        Local Pointer psRetVal
36166>>>        Get ClientId to iClientId
36167>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
36168>>>        GetAddress of sRetVal to psRetVal
36169>>>        Move (InvokeAutoClientRealFunction(iClientId,dwDispId,psRetVal)) to iRetVal
36170>>>        Move sRetVal to rRetVal
36171>>>        Function_Return rRetVal
36172>>>    End_Function
36173>>>
36173>>>    Function InvokeShortRealFunction DWORD dwDispId returns OLEReal
36174>>>        Local Integer iClientId iRetVal
36175>>>        Local OLEReal rRetVal
36175>>>        Local String sRetVal
36175>>>        Local Pointer psRetVal
36175>>>        Get ClientId to iClientId
36176>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
36177>>>        GetAddress of sRetVal to psRetVal
36178>>>        Move (InvokeAutoClientShortRealFunction(iClientId,dwDispId,psRetVal)) to iRetVal
36179>>>        Move sRetVal to rRetVal
36180>>>        Function_Return rRetVal
36181>>>    End_Function
36182>>>
36182>>>    Function InvokeStringFunction DWORD dwDispId returns String
36183>>>        Local Integer iClientId iRetVal
36184>>>        Local String sRetVal
36184>>>        Local Pointer psRetVal
36184>>>        Get ClientId to iClientId
36185>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
36186>>>        GetAddress of sRetVal to psRetVal
36187>>>        Move (InvokeAutoClientStringFunction(iClientId,dwDispId,psRetVal)) to iRetVal
36188>>>        Function_Return (CString(sRetVal))
36189>>>    End_Function
36190>>>
36190>>>    Function InvokeOleVariantFunction DWORD dwDispId returns OLEVariant
36191>>>        Local Integer iClientId iRetVal
36192>>>        Local OLEVariant vRetVal
36192>>>        Local Pointer pvRetVal
36192>>>        Get ClientId to iClientId
36193>>>        ZeroType TP_OLEVariant to vRetVal
36194>>>        GetAddress of vRetVal to pvRetVal
36195>>>        Move (InvokeAutoClientOLEVariantFunction(iClientId,dwDispId,pvRetVal)) to iRetVal
36196>>>        Function_Return vRetVal
36197>>>    End_Function
36198>>>
36198>>>
36198>>>// Event parameter functions, might be moved to cOCX_Client_Mixin or similar
36198>>>    Function GetEventIntegerParam DWORD lParam DWORD iPara returns Integer
36199>>>        Local Integer iRetVal
36200>>>        Move (GetOCXEventIntegerParam(lParam,iPara)) to iRetVal
36201>>>        Function_Return iRetVal
36202>>>    End_Function
36203>>>
36203>>>    Function GetEventShortParam DWORD lParam DWORD iPara returns Integer
36204>>>        Local Integer iRetVal
36205>>>        Move (GetOCXEventShortParam(lParam,iPara)) to iRetVal
36206>>>        Function_Return iRetVal
36207>>>    End_Function
36208>>>
36208>>>    Function GetEventBoolParam DWORD lParam DWORD iPara returns Bool
36209>>>        Local Bool iRetVal
36210>>>        Move (GetOCXEventBoolParam(lParam,iPara)) to iRetVal
36211>>>        Function_Return iRetVal
36212>>>    End_Function
36213>>>
36213>>>    Function GetEventCurrencyParam DWORD lParam DWORD iPara returns Currency
36214>>>        Local Integer iretVal
36215>>>        Local Currency cRetVal
36215>>>        Local String destStr
36215>>>        Local Pointer pdestStr
36215>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
36216>>>        GetAddress of destStr to pdestStr
36217>>>        Move (GetOCXEventCurrencyParam(lParam,iPara,pdestStr)) to iRetVal
36218>>>        Move (CString(destStr)) to cRetVal
36219>>>        Function_Return cRetVal
36220>>>    End_Function
36221>>>
36221>>>    Function GetEventDateParam DWORD lParam DWORD iPara returns Date
36222>>>        Local Date dRetVal
36223>>>        Move (GetOCXEventDateParam(lParam,iPara)) to dRetVal
36224>>>        Function_Return dRetVal
36225>>>    End_Function
36226>>>
36226>>>    Function GetEventLPDispatchParam DWORD lParam DWORD iPara returns LPDispatch
36227>>>        Local LPDispatch lpRetVal
36228>>>        Get GetEventIntegerParam lParam iPara to lpRetVal
36229>>>        Function_Return lpRetVal
36230>>>    End_Function
36231>>>
36231>>>    Function GetEventRealParam DWORD lParam DWORD iPara returns OLEReal
36232>>>        Local Integer iretVal
36233>>>        Local OLEReal rRetVal
36233>>>        Local String destStr
36233>>>        Local Pointer pdestStr
36233>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
36234>>>        GetAddress of destStr to pdestStr
36235>>>        Move (GetOCXEventRealParam(lParam,iPara,pdestStr)) to iRetVal
36236>>>        Move (CString(destStr)) to rRetVal
36237>>>        Function_Return rRetVal
36238>>>    End_Function
36239>>>
36239>>>    Function GetEventShortRealParam DWORD lParam DWORD iPara returns ShortReal
36240>>>        Local Integer iretVal
36241>>>        Local ShortReal rRetVal
36241>>>        Local String destStr
36241>>>        Local Pointer pdestStr
36241>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
36242>>>        GetAddress of destStr to pdestStr
36243>>>        Move (GetOCXEventShortRealParam(lParam,iPara,pdestStr)) to iRetVal
36244>>>        Move (CString(destStr)) to rRetVal
36245>>>        Function_Return rRetVal
36246>>>    End_Function
36247>>>
36247>>>    Function GetEventStringParam DWORD lParam DWORD iPara returns String
36248>>>        Local Integer iretVal
36249>>>        Local String sRetVal
36249>>>        Local Pointer psRetVal
36249>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
36250>>>        GetAddress of sRetVal to psRetVal
36251>>>        Move (GetOCXEventStringParam(lParam,iPara,psRetVal)) to iRetVal
36252>>>        Function_Return (CString(sRetVal))
36253>>>    End_Function
36254>>>
36254>>>    Function GetEventOLEVariantParam DWORD lParam DWORD iPara returns OLEVariant
36255>>>        Local Integer iretVal
36256>>>        Inst_OLEVariant vRetVal
36257>>>        Local Pointer pvRetVal
36257>>>        GetAddress of vRetVal to pvRetVal
36258>>>        Move (GetOCXEventOLEVariantParam(lParam,iPara,pvRetVal)) to iRetVal
36259>>>        Function_Return vRetVal
36260>>>    End_Function
36261>>>
36261>>>End_Class
36262>>>
36262>>>
36262>>>// The OLE Automation base class,
36262>>>// which all automation classes are derived from
36262>>>
36262>>>Class Automation_Client is a cCOM_IDispatch
36263>>>    Procedure Construct_Object
36264>>>        Forward Send Construct_Object
36266>>>        Send DefineCOM_IDispatch
36267>>>        Local Integer iClientId
36268>>>        Move (CreateAutomationClient()) To iClientId
36269>>>        If iClientId Eq 0 Begin
36271>>>            Set ClientId to 0
36272>>>            Error 1002 DFOLEError1002
36273>>>>
36273>>>        End
36273>>>>
36273>>>        Else Set ClientId To iClientId
36275>>>        End_Procedure
36276>>>
36276>>>    Procedure Destroy_Object
36277>>>        Local Integer iRetVal iClientId
36278>>>        Get ClientId to iClientId
36279>>>        Move (DestroyAutomationClient(iClientId)) to iRetVal
36280>>>        Forward Send Destroy_Object
36282>>>    End_Procedure
36283>>>
36283>>>    Procedure CreateDispatch
36284>>>                Local Integer iRetVal
36285>>>                Local Integer iClientId
36285>>>        Local String sCLSID
36285>>>        Get progIdStr to sCLSID
36286>>>        Append sCLSID OLENull
36287>>>
36287>>>                Get clientId to iClientId
36288>>>        Move (CreateAutoClientDispatch (iClientId,sCLSID)) To iRetVal
36289>>>                If iRetVal Eq 0 Begin
36291>>>            Error 1000 DFOLEError1000
36292>>>>
36292>>>                End
36292>>>>
36292>>>        End_Procedure
36293>>>
36293>>>        Procedure AttachDispatch LPDispatch pdisp
36294>>>                Local Integer iRetVal
36295>>>                Local Integer iClientId
36295>>>                Local Integer bAutoAddRef
36295>>>                Get clientId to iClientId
36296>>>                Get AutoAddRef to bAutoAddRef
36297>>>                Move (AttachAutoClientDispatch (iClientId,pdisp,bAutoAddRef)) To iRetVal
36298>>>                If iRetVal Eq 0 Begin
36300>>>                Error 1001 DFOLEError1001
36301>>>>
36301>>>                End
36301>>>>
36301>>>    End_Procedure
36302>>>
36302>>>    Function AttachActiveObject Returns Bool
36303>>>                Local Bool bRetVal
36304>>>                Local Integer iClientId
36304>>>                Local String sCLSID
36304>>>                Get progIdStr to sCLSID
36305>>>                Append sCLSID OLENull
36306>>>                Get clientId to iClientId
36307>>>                Move (AttachAutoClientActiveObject (iClientId,sCLSID)) To bRetVal
36308>>>                Function_Return bRetVal
36309>>>    End_Function
36310>>>
36310>>>    Procedure ReleaseDispatch
36311>>>        Local Integer iRetVal
36312>>>        Local Integer iClientId
36312>>>        Get clientId to iClientId
36313>>>        Move (ReleaseAutoClientDispatch (iClientId)) to iRetVal
36314>>>    End_Procedure
36315>>>
36315>>>    Function GetDispatch returns LPDispatch
36316>>>        Local LPDispatch retVal
36317>>>        Local Integer iClientId
36317>>>        Get clientId to iClientId
36318>>>        Move (GetAutoClientDispatch(iClientId)) to retVal
36319>>>        Function_Return retVal
36320>>>    End_Function
36321>>>
36321>>>End_Class
36322>>>
36322>>>
36322>>>//     cCom_IDispatch  External_Class_Mixin
36322>>>//                 |       |    
36322>>>//                 |       cOCXNavigation_Mixin
36322>>>//                 |         |    
36322>>>//               cOCX_Client_Mixin
36322>>>//                        |    |
36322>>>//                        |    |
36322>>>// Form_External_Control  |    |   dbForm_External_Control
36322>>>//                 |      |    |        |  
36322>>>//                OCX_Client   dbOCX_Client
36322>>>
36322>>>
36322>>>
36322>>>// The focus navigation mixin class for ActiveX controls
36322>>>Class cOCX_Navigation_Class_Mixin is a Mixin 
36323>>>    Import_Class_Protocol External_Class_Mixin
36324>>>    Register_Procedure WMDF_DFOCXNotifyEvent
36324>>>
36324>>>    Procedure WMDF_DFOCXNotifyEvent Integer wParam Integer lParam
36325>>>        ON_EVENT WM_DFOCX_FOCUSCHANGE Fire OCXFocusChange
36328>>>    End_Procedure
36329>>>
36329>>>    Procedure OCXFocusChange Integer lParam
36330>>>        If (lParam);            Send External_SetFocus
36333>>>        Else;            Send External_KillFocus
36335>>>    End_Procedure
36336>>>
36336>>>    //Provided just to cancel the External_Class_Mixin implementation
36336>>>    //It actually gets cancelled in the cOCX_Clint_Mixin, but hey!?
36336>>>    Procedure Page_Object Integer state
36337>>>        Forward Send Page_Object state        
36339>>>    End_Procedure
36340>>>
36340>>>    Procedure Enable_Window integer iState
36341>>>      // Here we switch iState again, for backwards compatibility
36341>>>      Set OcxShadow_State to (Not(iState))
36342>>>    End_procedure
36343>>>
36343>>>End_Class
36344>>>
36344>>>
36344>>>//The standard OCX class mixin, it is the 
36344>>>// OCX base class which all OLE Controls are derived from (read mixin'd)
36344>>>Class cOCX_Client_Mixin is a Mixin
36345>>>
36345>>>    Import_Class_Protocol cCOM_IDispatch
36346>>>    Import_Class_Protocol cOCX_Navigation_Class_Mixin
36347>>>    Register_Procedure WMDF_DFOCXEVENT Integer wParam Integer lParam
36347>>>
36347>>>    Procedure DefineOCX_Client
36348>>>        Send DefineCOM_IDispatch
36349>>>        Local Integer iClientId
36350>>>        Property integer Private.OCXShadowState Public 0
36351>>>        Property String  Private.OCXCaption Public ""
36352>>>        Property String  OCXLicense Public ""
36353>>>        Property String  OCXPropFile Public ""
36354>>>        Move (CreateOCXClient()) to iclientId
36355>>>                Set ClientId to iClientId
36356>>>        Send Use_Parent_Color
36357>>>    End_Procedure
36358>>>
36358>>>    Function OCXShadow_State Returns Integer
36359>>>        Local Integer bEnabled
36360>>>        Get Private.OCXShadowState to bEnabled
36361>>>        Function_Return bEnabled
36362>>>    End_Function
36363>>>
36363>>>    Procedure Set OCXShadow_State Integer bEnable
36364>>>        Local integer hWnd iSuccess iCLientId
36365>>>        Set Private.OCXShadowState to bEnable
36366>>>        Get clientId to iClientId
36367>>>        If bEnable;            Move (false) to bEnable
36370>>>        else;            Move (true) to bEnable
36372>>>        Get Window_Handle to hWnd
36373>>>        If hWnd;            Move (EnableOCXControl(iClientId,bEnable)) To iSuccess
36376>>>    End_Procedure
36377>>>
36377>>>    Procedure SetOCXCaption String sCaption
36378>>>        Local Integer iClientId iRetVal
36379>>>        Get ClientId to iClientId
36380>>>        Append sCaption OLENull
36381>>>        Move (SetOCXControlCaption(iClientId,sCaption)) to iRetVal
36382>>>        If (Not(iRetVal));            Error 1004 DFOLEError1004
36385>>>        Else;            Set Private.OCXCaption to sCaption
36387>>>    End_Procedure
36388>>>
36388>>>    Function GetOCXCaption Returns String
36389>>>        Local Integer iClientId iRetVal
36390>>>        Local String destStr
36390>>>        Local Pointer lpDestStr
36390>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
36391>>>        GetAddress of destStr to lpDestStr
36392>>>        Move (GetOCXControlCaption(iClientId,lpDestStr)) to iRetVal
36393>>>        If (not(iRetVal));            Error 1004 DFOLEError1004
36396>>>        Set Private.OCXCaption to (CString(destStr))
36397>>>        Function_Return (Private.OCXCaption(Current_Object))
36398>>>    End_Function
36399>>>
36399>>>    Procedure SET OCXCaption String sCaption
36400>>>        If (Window_Handle(Current_Object));            Send SetOCXCaption sCaption
36403>>>        Else;            Set Private.OCXCaption to sCaption
36405>>>    End_Procedure
36406>>>
36406>>>    Function OCXCaption Returns String
36407>>>        If (Window_Handle(Current_Object));            Function_Return (GetOCXCaption(Current_Object))
36410>>>        Else;            Function_Return (Private.OCXCaption(Current_Object))
36412>>>    End_Procedure
36413>>>
36413>>>    // To avoid flickering during resize operations
36413>>>    Procedure Use_Parent_Color
36414>>>        Local Integer Clr Txtclr Backclr
36415>>>        Delegate Get Object_Color To Clr
36417>>>        Move (Hi(Clr)) To Txtclr
36418>>>        Move (Low(Clr)) To Backclr
36419>>>        Set Object_Color To Txtclr Backclr
36420>>>    End_Procedure
36421>>>
36421>>>    Procedure Page_Object integer iState
36422>>>        Forward Send Page_Object iState
36424>>>        If iState Eq (True) Send LoadOCX
36427>>>    End_Procedure
36428>>>
36428>>>    Procedure Remove_Object
36429>>>        Send UnloadOCX
36430>>>        Forward send Remove_Object
36432>>>    End_Procedure
36433>>>
36433>>>    Procedure LoadOCX
36434>>>        Local Pointer HWnd
36435>>>        Local Integer iCLientId iRetVal iVisible iShadow dwSty
36435>>>        Local String sPrgId lic sCap sPropFile
36435>>>        Send PreCreateOCX
36436>>>        Get ClientId to iClientId
36437>>>        Get Window_Handle to hwnd
36438>>>        Get progIdStr to sPrgId
36439>>>        Append sPrgId OLENull
36440>>>        Get Private.OCXCaption To sCap
36441>>>        Append sCap OLENull
36442>>>        Get OCXLicense To Lic
36443>>>        Append Lic OLENull
36444>>>        Get OCXPropFile To sPropFile
36445>>>        Append sPropfile OLENull
36446>>>        Get Visible_State to iVisible
36447>>>        If (iVisible) Move WS_VISIBLE to dwSty
36450>>>        Else Move 0 to dwSty
36452>>>        Get Private.OCXShadowState to iShadow
36453>>>        If (iShadow) Move (dwSty ior WS_DISABLED) to dwSty
36456>>>        Move (dwSty ior WS_TABSTOP) to dwSty
36457>>>        Move (CreateOCXControl(iClientId,HWnd,sPrgId,sCap,dwSty,lic,sPropFile)) to iRetVal
36458>>>        Send PostCreateOCX
36459>>>    End_Procedure
36460>>>
36460>>>    Procedure UnloadOCX
36461>>>        Local Integer iRetVal
36462>>>                Local Integer iClientId
36462>>>                Get ClientId to iClientId
36463>>>                Move (DestroyOCXControl(iClientId)) to iRetVal
36464>>>    End_Procedure
36465>>>
36465>>>    //This procedure is triggered before the OCX control is created
36465>>>    Procedure PreCreateOCX
36466>>>    End_Procedure
36467>>>
36467>>>    //This procedure is triggered after the OCX control is created but
36467>>>    //before it's shown
36467>>>    Procedure PostCreateOCX
36468>>>    End_Procedure
36469>>>End_Class
36470>>>
36470>>>// The non data aware OCX class
36470>>>// Derive from this class if you DON'T want your ActiveX control to be data aware
36470>>>Class OCX_Client is a FormExternalControl
36471>>>    Import_Class_Protocol cOCX_Client_Mixin
36472>>>
36472>>>    //These allows us to use the VDF standard 'Value' to get and set the
36472>>>    // caption of the ActiveX control (e.g. Get/Set Value to someVariable)
36472>>>
36472>>>    Procedure Set ControlValue string sVal
36473>>>        Set OCXCaption to sVal
36474>>>    End_Procedure
36475>>>
36475>>>    Function Value Integer item_number Returns String
36476>>>        Function_Return (OCXCaption(Current_Object))
36477>>>    End_Function
36478>>>
36478>>>End_Class
36479>>>
36479>>>
36479>>>// The Data aware OCX class
36479>>>// Derive from this class if you want your ActiveX control to be data aware
36479>>>Class dbOCX_Client is a dbFormExternalControl
36480>>>    Import_Class_Protocol cOCX_Client_Mixin
36481>>>
36481>>>    Procedure DefinedbOCX_Client
36482>>>        Send DefineOCX_Client
36483>>>        Property String  Private.OCXdbValue public ""
36484>>>    End_Procedure
36485>>>
36485>>>    Procedure Set ControlValue string sVal
36486>>>        If (Window_Handle(Current_Object));            Send OnRefreshDbOcxValue sVal
36489>>>    End_Procedure
36490>>>
36490>>>    Function ControlValue Returns String
36491>>>        Function_Return (Private.OCXDbValue(Current_Object))
36492>>>    End_Function
36493>>>
36493>>>    //Triggered when the database value has changed,
36493>>>    // and the ActiveX control needs to be updated
36493>>>    //Override and perform necessary updating to the OCX
36493>>>    Procedure OnRefreshDbOcxValue String sVal
36494>>>    End_Procedure
36495>>>
36495>>>    //Should be called when the ActiveX control's value has changed,
36495>>>    // and the database value needs to be updated
36495>>>    Procedure UpdateDbOcxValue String sVal
36496>>>        Set Private.OCXdbValue to sVal
36497>>>        Send ControlValueChanged
36498>>>    End_Procedure
36499>>>
36499>>>End_Class
36500>>>
36500>>>
36500>>>// Command for common declarations of ActiveX control classes, only used internally
36500>>>
36500>>>
36500>>>Use FontDisp
INCLUDING FILE: FONTDISP.PKG
36500>>>>>// OLEStdFont Charset Constants
36500>>>>>Enum_List
36500>>>>>        Define OLEANSI_CHARSET for 0 
36500>>>>>        Define OLEDEFAULT_CHARSET for 1
36500>>>>>        Define OLESYMBOL_CHARSET for 2
36500>>>>>End_Enum_List
36500>>>>>
36500>>>>>
36500>>>>>// CLSID:{BEF6E003-A874-101A-8BBA-00AA00300CAB}
36500>>>>>// ProgId: 
36500>>>>>Class OLEFontMixin is a Automation_Client
36501>>>>>
36501>>>>>        Function StdFontName Returns String
36502>>>>>                Local String lpropVal
36503>>>>>                Get GetStringProperty 0 to lpropVal
36504>>>>>                Function_Return lpropVal
36505>>>>>        End_Function
36506>>>>>
36506>>>>>        Procedure SET StdFontName String lpropVal
36507>>>>>                Send SetStringProperty 0 lpropVal
36508>>>>>        End_Procedure
36509>>>>>
36509>>>>>        Function StdFontSize Returns Currency
36510>>>>>                Local Currency lpropVal
36511>>>>>                Get GetCurrencyProperty 2 to lpropVal
36512>>>>>                Function_Return lpropVal
36513>>>>>        End_Function
36514>>>>>
36514>>>>>        Procedure SET StdFontSize Currency lpropVal
36515>>>>>                Send SetCurrencyProperty 2 lpropVal
36516>>>>>        End_Procedure
36517>>>>>
36517>>>>>        Function StdFontBold Returns Bool
36518>>>>>                Local Bool lpropVal
36519>>>>>                Get GetBoolProperty 3 to lpropVal
36520>>>>>                Function_Return lpropVal
36521>>>>>        End_Function
36522>>>>>
36522>>>>>        Procedure SET StdFontBold Bool lpropVal
36523>>>>>                Send SetBoolProperty 3 lpropVal
36524>>>>>        End_Procedure
36525>>>>>
36525>>>>>        Function StdFontItalic Returns Bool
36526>>>>>                Local Bool lpropVal
36527>>>>>                Get GetBoolProperty 4 to lpropVal
36528>>>>>                Function_Return lpropVal
36529>>>>>        End_Function
36530>>>>>
36530>>>>>        Procedure SET StdFontItalic Bool lpropVal
36531>>>>>                Send SetBoolProperty 4 lpropVal
36532>>>>>        End_Procedure
36533>>>>>
36533>>>>>        Function StdFontUnderline Returns Bool
36534>>>>>                Local Bool lpropVal
36535>>>>>                Get GetBoolProperty 5 to lpropVal
36536>>>>>                Function_Return lpropVal
36537>>>>>        End_Function
36538>>>>>
36538>>>>>        Procedure SET StdFontUnderline Bool lpropVal
36539>>>>>                Send SetBoolProperty 5 lpropVal
36540>>>>>        End_Procedure
36541>>>>>
36541>>>>>        Function StdFontStrikethrough Returns Bool
36542>>>>>                Local Bool lpropVal
36543>>>>>                Get GetBoolProperty 6 to lpropVal
36544>>>>>                Function_Return lpropVal
36545>>>>>        End_Function
36546>>>>>
36546>>>>>        Procedure SET StdFontStrikethrough Bool lpropVal
36547>>>>>                Send SetBoolProperty 6 lpropVal
36548>>>>>        End_Procedure
36549>>>>>
36549>>>>>        Function StdFontWeight Returns Integer
36550>>>>>                Local Integer lpropVal
36551>>>>>                Get GetShortProperty 7 to lpropVal
36552>>>>>                Function_Return lpropVal
36553>>>>>        End_Function
36554>>>>>
36554>>>>>        Procedure SET StdFontWeight Integer lpropVal
36555>>>>>                Send SetShortProperty 7 lpropVal
36556>>>>>        End_Procedure
36557>>>>>
36557>>>>>        Function StdFontCharset Returns Integer
36558>>>>>                Local Integer lpropVal
36559>>>>>                Get GetShortProperty 8 to lpropVal
36560>>>>>                Function_Return lpropVal
36561>>>>>        End_Function
36562>>>>>
36562>>>>>        Procedure SET StdFontCharset Integer lpropVal
36563>>>>>                Send SetShortProperty 8 lpropVal
36564>>>>>        End_Procedure
36565>>>>>
36565>>>>>End_Class
36566>>>>>
36566>>>>>// CoClass CLSID:{0BE35203-8F91-11CE-9DE3-00AA004BB851}
36566>>>>>// ProgId: StdFont
36566>>>>>// Number of impl.Types:1
36566>>>>>// Referenced class Font
36566>>>>>Class OLEStdFont is a Automation_Client
36567>>>>>        Import_Class_Protocol OLEFontMixin
36568>>>>>
36568>>>>>        Procedure Construct_Object
36569>>>>>                Forward Send Construct_Object
36571>>>>>                Set progIdStr to "StdFont"
36572>>>>>        End_Procedure
36573>>>>>End_Class
36574>>>Use PicDisp
INCLUDING FILE: PICDISP.PKG
36574>>>>>
36574>>>>>// Picture Type Constants
36574>>>>>//Enum_List
36574>>>>>        Define OLEPICTYPE_UNINITIALIZED for -1 // Uninitialized
36574>>>>>        Define OLEPICTYPE_NONE for 0 // None
36574>>>>>        Define OLEPICTYPE_BITMAP for 1 // Bitmap
36574>>>>>        Define OLEPICTYPE_METAFILE for 2 // Windows Metafile
36574>>>>>        Define OLEPICTYPE_ICON for 3 // Icon
36574>>>>>        Define OLEPICTYPE_ENHMETAFILE for 4 // Enhanced Metafile
36574>>>>>//End_Enum_List
36574>>>>>
36574>>>>>// CLSID:{7BF80981-BF32-101A-8BBB-00AA00300CAB}
36574>>>>>// ProgId: 
36574>>>>>Class OLEPictureMixin is a Automation_Client
36575>>>>>
36575>>>>>        Function StdPictureHandle Returns OLE_HANDLE
36576>>>>>                Local OLE_HANDLE lpropVal
36577>>>>>                Get GetIntegerProperty 0 to lpropVal
36578>>>>>                Function_Return lpropVal
36579>>>>>        End_Function
36580>>>>>
36580>>>>>        Function StdPicturehPal Returns OLE_HANDLE
36581>>>>>                Local OLE_HANDLE lpropVal
36582>>>>>                Get GetIntegerProperty 2 to lpropVal
36583>>>>>                Function_Return lpropVal
36584>>>>>        End_Function
36585>>>>>
36585>>>>>        Procedure SET StdPicturehPal OLE_HANDLE lpropVal
36586>>>>>                Send SetIntegerProperty 2 lpropVal
36587>>>>>        End_Procedure
36588>>>>>
36588>>>>>        Function StdPictureType Returns Integer
36589>>>>>                Local Integer lpropVal
36590>>>>>                Get GetShortProperty 3 to lpropVal
36591>>>>>                Function_Return lpropVal
36592>>>>>        End_Function
36593>>>>>
36593>>>>>        Function StdPictureWidth Returns OLE_XSIZE_HIMETRIC
36594>>>>>                Local OLE_XSIZE_HIMETRIC lpropVal
36595>>>>>                Get GetIntegerProperty 4 to lpropVal
36596>>>>>                Function_Return lpropVal
36597>>>>>        End_Function
36598>>>>>
36598>>>>>        Function StdPictureHeight Returns OLE_YSIZE_HIMETRIC
36599>>>>>                Local OLE_YSIZE_HIMETRIC lpropVal
36600>>>>>                Get GetIntegerProperty 5 to lpropVal
36601>>>>>                Function_Return lpropVal
36602>>>>>        End_Function
36603>>>>>
36603>>>>>        Procedure StdPictureRender DWORD lhdc DWORD lx DWORD ly DWORD lcx DWORD lcy OLE_XPOS_HIMETRIC lxSrc OLE_YPOS_HIMETRIC lySrc OLE_XSIZE_HIMETRIC lcxSrc OLE_YSIZE_HIMETRIC lcySrc LPOLE_RECT lprcWBounds
36604>>>>>                Send DeclareParams 10
36605>>>>>                Send DefineIntegerParam lhdc
36606>>>>>                Send DefineIntegerParam lx
36607>>>>>                Send DefineIntegerParam ly
36608>>>>>                Send DefineIntegerParam lcx
36609>>>>>                Send DefineIntegerParam lcy
36610>>>>>                Send DefineIntegerParam lxSrc
36611>>>>>                Send DefineIntegerParam lySrc
36612>>>>>                Send DefineIntegerParam lcxSrc
36613>>>>>                Send DefineIntegerParam lcySrc
36614>>>>>                Send DefineIntegerParam lprcWBounds
36615>>>>>                Send InvokeVoidFunction 6
36616>>>>>        End_Procedure 
36617>>>>>
36617>>>>>End_Class
36618>>>>>
36618>>>>>// CoClass CLSID:{0BE35204-8F91-11CE-9DE3-00AA004BB851}
36618>>>>>// ProgId: StdPicture
36618>>>>>// Number of impl.Types:1
36618>>>>>// Referenced class Picture
36618>>>>>Class OLEStdPicture is a Automation_Client
36619>>>>>        Import_Class_Protocol OLEPictureMixin
36620>>>>>
36620>>>>>        Procedure Construct_Object
36621>>>>>                Forward Send Construct_Object
36623>>>>>                Set progIdStr to "StdPicture"
36624>>>>>        End_Procedure
36625>>>>>End_Class
36626>Use DPDlg    // Full Path Directory Picker
INCLUDING FILE: DPDLG.PKG
36626>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\DPDLG.OCX
36626>>>// Generated by FlexOLE Class Generator Friday, November 10, 2000 17:30:33
36626>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
36626>>>
36626>>>//Enum_List
36626>>>    Define OLEdpdDesktop        for  0 // Desktop
36626>>>    Define OLEdpdControlPanel   for  1 // Control Panel
36626>>>    Define OLEdpdDesktopDir     for  2 // Desktop Directory
36626>>>    Define OLEdpdMyComputer     for  3 // My Computer
36626>>>    Define OLEdpdFontDir        for  4 // Font Directory
36626>>>    Define OLEdpdNetwork        for  5 // Network Neighborhood
36626>>>    Define OLEdpdPrinters       for  6 // Printers
36626>>>    Define OLEdpdPrograms       for  7 // Programs
36626>>>    Define OLEdpdRecent         for  8 // Recent
36626>>>    Define OLEdpdRecycleBin     for  9 // Recycle Bin
36626>>>    Define OLEdpdSendTo         for 10 // Send To
36626>>>    Define OLEdpdStartMenu      for 11 // Start Menu
36626>>>    Define OLEdpdStartUp        for 12 // Start Up
36626>>>    Define OLEdpdTemplates      for 13 // Templates
36626>>>    Define OLEdpdCustom         for 14 // Custom Root
36626>>>//End_Enum_List
36626>>>
36626>>>// Dispatch interface for DPDlg Control
36626>>>// CLSID:{BE5AB244-F888-11D0-9F5E-B42103C10710}
36626>>>// ProgId:
36626>>>Class OLE_DDPDlg is a Message
36627>>>
36627>>>        Function DPDlgBrowseForComputer Returns Bool
36628>>>                Local Bool lpropVal
36629>>>                Get GetBoolProperty 1 to lpropVal
36630>>>                Function_Return lpropVal
36631>>>        End_Function
36632>>>
36632>>>        Procedure SET DPDlgBrowseForComputer Bool lpropVal
36633>>>                Send SetBoolProperty 1 lpropVal
36634>>>        End_Procedure
36635>>>
36635>>>        Function DPDlgBrowseForPrinter Returns Bool
36636>>>                Local Bool lpropVal
36637>>>                Get GetBoolProperty 2 to lpropVal
36638>>>                Function_Return lpropVal
36639>>>        End_Function
36640>>>
36640>>>        Procedure SET DPDlgBrowseForPrinter Bool lpropVal
36641>>>                Send SetBoolProperty 2 lpropVal
36642>>>        End_Procedure
36643>>>
36643>>>        Function DPDlgDontGoBelowDomain Returns Bool
36644>>>                Local Bool lpropVal
36645>>>                Get GetBoolProperty 3 to lpropVal
36646>>>                Function_Return lpropVal
36647>>>        End_Function
36648>>>
36648>>>        Procedure SET DPDlgDontGoBelowDomain Bool lpropVal
36649>>>                Send SetBoolProperty 3 lpropVal
36650>>>        End_Procedure
36651>>>
36651>>>        Function DPDlgReturnFSAncestors Returns Bool
36652>>>                Local Bool lpropVal
36653>>>                Get GetBoolProperty 4 to lpropVal
36654>>>                Function_Return lpropVal
36655>>>        End_Function
36656>>>
36656>>>        Procedure SET DPDlgReturnFSAncestors Bool lpropVal
36657>>>                Send SetBoolProperty 4 lpropVal
36658>>>        End_Procedure
36659>>>
36659>>>        Function DPDlgReturnOnlyFSDirs Returns Bool
36660>>>                Local Bool lpropVal
36661>>>                Get GetBoolProperty 5 to lpropVal
36662>>>                Function_Return lpropVal
36663>>>        End_Function
36664>>>
36664>>>        Procedure SET DPDlgReturnOnlyFSDirs Bool lpropVal
36665>>>                Send SetBoolProperty 5 lpropVal
36666>>>        End_Procedure
36667>>>
36667>>>        Function DPDlgRoot Returns OLE_ROOTSHORT
36668>>>                Local OLE_ROOTSHORT lpropVal
36669>>>                Get GetIntegerProperty 6 to lpropVal
36670>>>                Function_Return lpropVal
36671>>>        End_Function
36672>>>
36672>>>        Procedure SET DPDlgRoot OLE_ROOTSHORT lpropVal
36673>>>                Send SetIntegerProperty 6 lpropVal
36674>>>        End_Procedure
36675>>>
36675>>>        Function DPDlghWnd Returns OLE_HANDLE
36676>>>                Local OLE_HANDLE lpropVal
36677>>>                Get GetIntegerProperty -515 to lpropVal
36678>>>                Function_Return lpropVal
36679>>>        End_Function
36680>>>
36680>>>        Procedure SET DPDlghWnd OLE_HANDLE lpropVal
36681>>>                Send SetIntegerProperty -515 lpropVal
36682>>>        End_Procedure
36683>>>
36683>>>        Function DPDlgIcon Returns LPDispatch
36684>>>                Local LPDispatch lpropVal
36685>>>                Get GetLPDispatchProperty 7 to lpropVal
36686>>>                Function_Return lpropVal
36687>>>        End_Function
36688>>>
36688>>>        Procedure SET DPDlgIcon LPDispatch lpropVal
36689>>>                Send SetLPDispatchProperty 7 lpropVal
36690>>>        End_Procedure
36691>>>
36691>>>        Function DPDlgFolder Returns String
36692>>>                Local String lpropVal
36693>>>                Get GetStringProperty 8 to lpropVal
36694>>>                Function_Return lpropVal
36695>>>        End_Function
36696>>>
36696>>>        Procedure SET DPDlgFolder String lpropVal
36697>>>                Send SetStringProperty 8 lpropVal
36698>>>        End_Procedure
36699>>>
36699>>>        Function DPDlgCaption Returns String
36700>>>                Local String lpropVal
36701>>>                Get GetStringProperty -518 to lpropVal
36702>>>                Function_Return lpropVal
36703>>>        End_Function
36704>>>
36704>>>        Procedure SET DPDlgCaption String lpropVal
36705>>>                Send SetStringProperty -518 lpropVal
36706>>>        End_Procedure
36707>>>
36707>>>        Function DPDlg_Caption Returns String
36708>>>                Local String lpropVal
36709>>>                Get GetStringProperty 0 to lpropVal
36710>>>                Function_Return lpropVal
36711>>>        End_Function
36712>>>
36712>>>        Procedure SET DPDlg_Caption String lpropVal
36713>>>                Send SetStringProperty 0 lpropVal
36714>>>        End_Procedure
36715>>>
36715>>>        Function DPDlgPath Returns String
36716>>>                Local String lpropVal
36717>>>                Get GetStringProperty 9 to lpropVal
36718>>>                Function_Return lpropVal
36719>>>        End_Function
36720>>>
36720>>>        Procedure SET DPDlgPath String lpropVal
36721>>>                Send SetStringProperty 9 lpropVal
36722>>>        End_Procedure
36723>>>
36723>>>        Function DPDlgCustomRoot Returns String
36724>>>                Local String lpropVal
36725>>>                Get GetStringProperty 10 to lpropVal
36726>>>                Function_Return lpropVal
36727>>>        End_Function
36728>>>
36728>>>        Procedure SET DPDlgCustomRoot String lpropVal
36729>>>                Send SetStringProperty 10 lpropVal
36730>>>        End_Procedure
36731>>>
36731>>>        Function DPDlgShow Returns Bool
36732>>>                Local Bool lretVal
36733>>>                Get InvokeBoolFunction 11 to lretVal
36734>>>                Function_Return lretVal
36735>>>        End_Function
36736>>>
36736>>>        Procedure DPDlgAboutBox
36737>>>                Send InvokeVoidFunction -552
36738>>>        End_Procedure
36739>>>
36739>>>End_Class
36740>>>
36740>>>// Event interface for DPDlg Control
36740>>>// CLSID:{BE5AB245-F888-11D0-9F5E-B42103C10710}
36740>>>// ProgId:
36740>>>Class OLE_DDPDlgEvents is a Message
36741>>>
36741>>>        Procedure OnDPDlgFolderSelected String lPath Bool lAllow
36742>>>        End_Procedure
36743>>>
36743>>>End_Class
36744>>>
36744>>>// DPDlg Control
36744>>>// CoClass CLSID:{BE5AB246-F888-11D0-9F5E-B42103C10710}
36744>>>// ProgId: DPDLG.DPDlgCtrl.1
36744>>>// Number of impl.Types:2
36744>>>// Referenced class _DDPDlg
36744>>>// Referenced class _DDPDlgEvents
36744>>>Class OLEDPDlg is a OCX_Client
36745>>>        Import_Class_Protocol OLE_DDPDlg
36746>>>        Import_Class_Protocol OLE_DDPDlgEvents
36747>>>
36747>>>        Procedure Construct_Object
36748>>>                Forward Send Construct_Object
36750>>>                Send DefineOCX_Client
36751>>>                Set progIdStr to "DPDLG.DPDlgCtrl.1"
36752>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEDPDlg"
36755>>>        End_Procedure
36756>>>
36756>>>        Procedure PreDPDlgFolderSelected Integer lParam
36757>>>                Local String lPath
36758>>>                Local Bool lAllow
36758>>>                Get GetEventStringParam lParam 0 to lPath
36759>>>                Get GetEventBoolParam lParam 1 to lAllow
36760>>>                Send OnDPDlgFolderSelected lPath lAllow
36761>>>        End_Procedure
36762>>>
36762>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
36763>>>                ON_EVENT 1 Fire PreDPDlgFolderSelected
36766>>>        End_Procedure
36767>>>End_Class
36768>>>
36768>>>// DPDlg Control
36768>>>// CoClass CLSID:{BE5AB246-F888-11D0-9F5E-B42103C10710}
36768>>>// ProgId: DPDLG.DPDlgCtrl.1
36768>>>// Number of impl.Types:2
36768>>>// Referenced class _DDPDlg
36768>>>// Referenced class _DDPDlgEvents
36768>>>Class dbOLEDPDlg is a dbOCX_Client
36769>>>        Import_Class_Protocol OLE_DDPDlg
36770>>>        Import_Class_Protocol OLE_DDPDlgEvents
36771>>>
36771>>>        Procedure Construct_Object
36772>>>                Forward Send Construct_Object
36774>>>                Send DefineDbOCX_Client
36775>>>                Set progIdStr to "DPDLG.DPDlgCtrl.1"
36776>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEDPDlg"
36779>>>        End_Procedure
36780>>>
36780>>>        Procedure PreDPDlgFolderSelected Integer lParam
36781>>>                Local String lPath
36782>>>                Local Bool lAllow
36782>>>                Get GetEventStringParam lParam 0 to lPath
36783>>>                Get GetEventBoolParam lParam 1 to lAllow
36784>>>                Send OnDPDlgFolderSelected lPath lAllow
36785>>>        End_Procedure
36786>>>
36786>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
36787>>>                ON_EVENT 1 Fire PreDPDlgFolderSelected
36790>>>        End_Procedure
36791>>>End_Class
36792>Use RasxDll  // Ras Package
INCLUDING FILE: RASXDLL.PKG
36792>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\RASX.DLL
36792>>>// Generated by FlexOLE Class Generator Friday, November 08, 2002 15:47:23
36792>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
36792>>>
36792>>>//Enum_List
36792>>>    Define OLERasActionNone         for 0 // No action
36792>>>    Define OLERasActionConnect      for 1 // Connect server
36792>>>    Define OLERasActionGetEntry     for 2 // Get phonebook entry
36792>>>    Define OLERasActionDisconnect   for 3 // Hang up (disconnect from server)
36792>>>    Define OLERasActionRefresh      for 4 // Refresh entries list
36792>>>    Define OLERasActionCreateEntry  for 5 // Create phonebook entry
36792>>>    Define OLERasActionEditEntry    for 6 // Edit phonebook entry
36792>>>//End_Enum_List
36792>>>
36792>>>// IRasXCom Interface
36792>>>// CLSID:{8E71552C-4915-11D3-B4C3-0020AFD69DE6}
36792>>>// ProgId:
36792>>>Class OLEIRasXCom is a Automation_Client
36793>>>
36793>>>// Sets or returns the filename of the phonebook to use.
36793>>>        Function RasXComPhoneBook Returns String
36794>>>                Local String lpropVal
36795>>>                Get GetStringProperty 1 to lpropVal
36796>>>                Function_Return lpropVal
36797>>>        End_Function
36798>>>
36798>>>// Sets or returns the filename of the phonebook to use.
36798>>>        Procedure SET RasXComPhoneBook String lpropVal
36799>>>                Send SetStringProperty 1 lpropVal
36800>>>        End_Procedure
36801>>>
36801>>>// Sets or returns the phone number to dial.
36801>>>        Function RasXComPhoneNumber Returns String
36802>>>                Local String lpropVal
36803>>>                Get GetStringProperty 2 to lpropVal
36804>>>                Function_Return lpropVal
36805>>>        End_Function
36806>>>
36806>>>// Sets or returns the phone number to dial.
36806>>>        Procedure SET RasXComPhoneNumber String lpropVal
36807>>>                Send SetStringProperty 2 lpropVal
36808>>>        End_Procedure
36809>>>
36809>>>// Sets or returns the name to use when logging on.
36809>>>        Function RasXComLogonName Returns String
36810>>>                Local String lpropVal
36811>>>                Get GetStringProperty 3 to lpropVal
36812>>>                Function_Return lpropVal
36813>>>        End_Function
36814>>>
36814>>>// Sets or returns the name to use when logging on.
36814>>>        Procedure SET RasXComLogonName String lpropVal
36815>>>                Send SetStringProperty 3 lpropVal
36816>>>        End_Procedure
36817>>>
36817>>>// Sets or returns the password to use.
36817>>>        Function RasXComLogonPassword Returns String
36818>>>                Local String lpropVal
36819>>>                Get GetStringProperty 4 to lpropVal
36820>>>                Function_Return lpropVal
36821>>>        End_Function
36822>>>
36822>>>// Sets or returns the password to use.
36822>>>        Procedure SET RasXComLogonPassword String lpropVal
36823>>>                Send SetStringProperty 4 lpropVal
36824>>>        End_Procedure
36825>>>
36825>>>// Sets or returns the phone number that a server should call back for certain kinds of verification.
36825>>>        Function RasXComCallbackNumber Returns String
36826>>>                Local String lpropVal
36827>>>                Get GetStringProperty 5 to lpropVal
36828>>>                Function_Return lpropVal
36829>>>        End_Function
36830>>>
36830>>>// Sets or returns the phone number that a server should call back for certain kinds of verification.
36830>>>        Procedure SET RasXComCallbackNumber String lpropVal
36831>>>                Send SetStringProperty 5 lpropVal
36832>>>        End_Procedure
36833>>>
36833>>>// Sets or returns the name of the current phone book entry.
36833>>>        Function RasXComEntryName Returns String
36834>>>                Local String lpropVal
36835>>>                Get GetStringProperty 6 to lpropVal
36836>>>                Function_Return lpropVal
36837>>>        End_Function
36838>>>
36838>>>// Sets or returns the name of the current phone book entry.
36838>>>        Procedure SET RasXComEntryName String lpropVal
36839>>>                Send SetStringProperty 6 lpropVal
36840>>>        End_Procedure
36841>>>
36841>>>// Sets or returns the domain to use for user authentication.
36841>>>        Function RasXComDomain Returns String
36842>>>                Local String lpropVal
36843>>>                Get GetStringProperty 7 to lpropVal
36844>>>                Function_Return lpropVal
36845>>>        End_Function
36846>>>
36846>>>// Sets or returns the domain to use for user authentication.
36846>>>        Procedure SET RasXComDomain String lpropVal
36847>>>                Send SetStringProperty 7 lpropVal
36848>>>        End_Procedure
36849>>>
36849>>>// Determines if methods are blocking.
36849>>>        Function RasXComBlocking Returns Bool
36850>>>                Local Bool lpropVal
36851>>>                Get GetBoolProperty 8 to lpropVal
36852>>>                Function_Return lpropVal
36853>>>        End_Function
36854>>>
36854>>>// Determines if methods are blocking.
36854>>>        Procedure SET RasXComBlocking Bool lpropVal
36855>>>                Send SetBoolProperty 8 lpropVal
36856>>>        End_Procedure
36857>>>
36857>>>// Returns the version of the control.
36857>>>        Function RasXComVersion Returns String
36858>>>                Local String lpropVal
36859>>>                Get GetStringProperty 9 to lpropVal
36860>>>                Function_Return lpropVal
36861>>>        End_Function
36862>>>
36862>>>// Returns the number of names in the current phonebook.
36862>>>        Function RasXComEntryCount Returns Integer
36863>>>                Local Integer lpropVal
36864>>>                Get GetShortProperty 10 to lpropVal
36865>>>                Function_Return lpropVal
36866>>>        End_Function
36867>>>
36867>>>// Returns whether or not RAS services are available.
36867>>>        Function RasXComRASAvailable Returns Bool
36868>>>                Local Bool lpropVal
36869>>>                Get GetBoolProperty 11 to lpropVal
36870>>>                Function_Return lpropVal
36871>>>        End_Function
36872>>>
36872>>>// Holds the last error number reported.
36872>>>        Function RasXComLastError Returns Integer
36873>>>                Local Integer lpropVal
36874>>>                Get GetShortProperty 12 to lpropVal
36875>>>                Function_Return lpropVal
36876>>>        End_Function
36877>>>
36877>>>// Returns the last method executed.
36877>>>        Function RasXComLastMethod Returns OLE_MethodsEnum
36878>>>                Local OLE_MethodsEnum lpropVal
36879>>>                Get GetIntegerProperty 13 to lpropVal
36880>>>                Function_Return lpropVal
36881>>>        End_Function
36882>>>
36882>>>// Holds a description of the last error number reported.
36882>>>        Function RasXComLastErrorString Returns String
36883>>>                Local String lpropVal
36884>>>                Get GetStringProperty 14 to lpropVal
36885>>>                Function_Return lpropVal
36886>>>        End_Function
36887>>>
36887>>>// The current state of the control.
36887>>>        Function RasXComState Returns Integer
36888>>>                Local Integer lpropVal
36889>>>                Get GetShortProperty 15 to lpropVal
36890>>>                Function_Return lpropVal
36891>>>        End_Function
36892>>>
36892>>>// A user-friendly version of the current state of the control.
36892>>>        Function RasXComStateString Returns String
36893>>>                Local String lpropVal
36894>>>                Get GetStringProperty 16 to lpropVal
36895>>>                Function_Return lpropVal
36896>>>        End_Function
36897>>>
36897>>>// Returns the RAS handle of a connection.
36897>>>        Function RasXComHandle Returns DWORD
36898>>>                Local DWORD lpropVal
36899>>>                Get GetIntegerProperty 17 to lpropVal
36900>>>                Function_Return lpropVal
36901>>>        End_Function
36902>>>
36902>>>// Returns whether or not a connection is active.
36902>>>        Function RasXComEntryConnected Returns Bool
36903>>>                Local Bool lpropVal
36904>>>                Get GetBoolProperty 18 to lpropVal
36905>>>                Function_Return lpropVal
36906>>>        End_Function
36907>>>
36907>>>// Returns the list of names in a phone book.
36907>>>        Function RasXComEntryList Integer lIndex Returns String
36908>>>                Local String lpropVal
36909>>>                Send DeclareParams 1
36910>>>                Send DefineShortParam lIndex
36911>>>                Get GetStringProperty 19 to lpropVal
36912>>>                Function_Return lpropVal
36913>>>        End_Function
36914>>>
36914>>>// Holds licensing information.
36914>>>        Function RasXComLicenseKey Returns String
36915>>>                Local String lpropVal
36916>>>                Get GetStringProperty 20 to lpropVal
36917>>>                Function_Return lpropVal
36918>>>        End_Function
36919>>>
36919>>>// Holds licensing information.
36919>>>        Procedure SET RasXComLicenseKey String lpropVal
36920>>>                Send SetStringProperty 20 lpropVal
36921>>>        End_Procedure
36922>>>
36922>>>// Connects to a server.
36922>>>        Procedure RasXComConnect
36923>>>                Send InvokeVoidFunction 22
36924>>>        End_Procedure
36925>>>
36925>>>// Disconnects (logs off) from the server.
36925>>>        Procedure RasXComDisconnect
36926>>>                Send InvokeVoidFunction 23
36927>>>        End_Procedure
36928>>>
36928>>>// Retrives an entry from the current phonebook.
36928>>>        Procedure RasXComGetEntry
36929>>>                Send InvokeVoidFunction 24
36930>>>        End_Procedure
36931>>>
36931>>>// Creates and entry in the current phone book.
36931>>>        Procedure RasXComCreateEntry
36932>>>                Send InvokeVoidFunction 25
36933>>>        End_Procedure
36934>>>
36934>>>// Allows the user to edit a RAS phone book entry.
36934>>>        Procedure RasXComEditEntry
36935>>>                Send InvokeVoidFunction 26
36936>>>        End_Procedure
36937>>>
36937>>>// Resets the component to its original state and re-loads the phone book.
36937>>>        Procedure RasXComRefresh
36938>>>                Send InvokeVoidFunction -550
36939>>>        End_Procedure
36940>>>
36940>>>// Displays About Box.
36940>>>        Procedure RasXComAbout
36941>>>                Send InvokeVoidFunction -552
36942>>>        End_Procedure
36943>>>
36943>>>// Allows object to unload without disconnecting the current connection.
36943>>>        Function RasXComDisconnectOnDestroy Returns Bool
36944>>>                Local Bool lpropVal
36945>>>                Get GetBoolProperty 28 to lpropVal
36946>>>                Function_Return lpropVal
36947>>>        End_Function
36948>>>
36948>>>// Allows object to unload without disconnecting the current connection.
36948>>>        Procedure SET RasXComDisconnectOnDestroy Bool lpropVal
36949>>>                Send SetBoolProperty 28 lpropVal
36950>>>        End_Procedure
36951>>>
36951>>>// Sets or returns an object reference to an object supporting the Fast Notification interface.
36951>>>        Function RasXComNotificationObject Returns LPDispatch
36952>>>                Local LPDispatch lpropVal
36953>>>                Get GetLPDispatchProperty 27 to lpropVal
36954>>>                Function_Return lpropVal
36955>>>        End_Function
36956>>>
36956>>>// Sets or returns an object reference to an object supporting the Fast Notification interface.
36956>>>        Procedure SET RasXComNotificationObject LPDispatch lpropVal
36957>>>                Send SetLPDispatchProperty 27 lpropVal
36958>>>        End_Procedure
36959>>>
36959>>>// Returns the version of the control.
36959>>>        Procedure SET RasXComVersion String lpropVal
36960>>>                Send SetStringProperty 9 lpropVal
36961>>>        End_Procedure
36962>>>
36962>>>End_Class
36963>>>
36963>>>// _IRasXComEvents Interface
36963>>>// CLSID:{8E71552E-4915-11D3-B4C3-0020AFD69DE6}
36963>>>// ProgId:
36963>>>Class OLE_IRasXComEvents is a Automation_Client
36964>>>
36964>>>// Fired when a method finishes.
36964>>>        Procedure RasXComDone OLE_MethodsEnum lLastMethod Integer lErrorCode String lErrorString
36965>>>                Send DeclareParams 3
36966>>>                Send DefineIntegerParam lLastMethod
36967>>>                Send DefineShortParam lErrorCode
36968>>>                Send DefineStringParam lErrorString
36969>>>                Send InvokeVoidFunction 1
36970>>>        End_Procedure
36971>>>
36971>>>// Fired when the control's internal state changes.
36971>>>        Procedure RasXComStateChanged Integer lNewState Integer lOldState
36972>>>                Send DeclareParams 2
36973>>>                Send DefineShortParam lNewState
36974>>>                Send DefineShortParam lOldState
36975>>>                Send InvokeVoidFunction 2
36976>>>        End_Procedure
36977>>>
36977>>>End_Class
36978>>>
36978>>>// RasXCom Class
36978>>>// CoClass CLSID:{8E71552D-4915-11D3-B4C3-0020AFD69DE6}
36978>>>// ProgId: Mabry.RasXCom.1
36978>>>// Number of impl.Types:2
36978>>>// Referenced class IRasXCom
36978>>>// Referenced class _IRasXComEvents
36978>>>Class OLERasXCom is a Automation_Client
36979>>>        Import_Class_Protocol OLEIRasXCom
36980>>>        Import_Class_Protocol OLE_IRasXComEvents
36981>>>
36981>>>        Procedure Construct_Object
36982>>>                Forward Send Construct_Object
36984>>>        Set progIdStr to "Mabry.RasXCom"
36985>>>        End_Procedure
36986>>>End_Class
36987>>>
36987>>>// IRasXComNotify Interface
36987>>>// CLSID:{40B44160-49E0-11D3-B4C3-0020AFD69DE6}
36987>>>// ProgId:
36987>>>Class OLEIRasXComNotify is a Automation_Client
36988>>>
36988>>>// Done
36988>>>        Procedure IRasXComNotifyDone LPDispatch lPackageObject OLE_MethodsEnum lLastMethod Integer lErrorCode String lErrorString
36989>>>                Send DeclareParams 4
36990>>>                Send DefineLPDispatchParam lPackageObject
36991>>>                Send DefineIntegerParam lLastMethod
36992>>>                Send DefineShortParam lErrorCode
36993>>>                Send DefineStringParam lErrorString
36994>>>                Send InvokeVoidFunction 1
36995>>>        End_Procedure
36996>>>
36996>>>// Fired when the control's internal state changes.
36996>>>        Procedure IRasXComNotifyStateChanged LPDispatch lPackageObject Integer lNewState Integer lOldState
36997>>>                Send DeclareParams 3
36998>>>                Send DefineLPDispatchParam lPackageObject
36999>>>                Send DefineShortParam lNewState
37000>>>                Send DefineShortParam lOldState
37001>>>                Send InvokeVoidFunction 2
37002>>>        End_Procedure
37003>>>
37003>>>End_Class
37004>Use Xfind    // Recursive Directory FILE FINDER
INCLUDING FILE: XFIND.PKG
37004>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\XFIND10DEMO.OCX
37004>>>// Generated by FlexOLE Class Generator Friday, November 10, 2000 16:23:24
37004>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
37004>>>
37004>>>// Dispatch interface for xfind Control
37004>>>// CLSID:{DF5A0221-37A0-11D4-881C-E7F891A83074}
37004>>>// ProgId: 
37004>>>Class OLEIxfind is a Message
37005>>>
37005>>>        Procedure xfindAboutBox
37006>>>                Send InvokeVoidFunction -552
37007>>>        End_Procedure 
37008>>>
37008>>>        Function xfindSearchString Returns String
37009>>>                Local String lpropVal
37010>>>                Get GetStringProperty 6 to lpropVal
37011>>>                Function_Return lpropVal
37012>>>        End_Function
37013>>>
37013>>>        Procedure SET xfindSearchString String lpropVal
37014>>>                Send SetStringProperty 6 lpropVal
37015>>>        End_Procedure
37016>>>
37016>>>        Function xfindSearchFrom Returns String
37017>>>                Local String lpropVal
37018>>>                Get GetStringProperty 7 to lpropVal
37019>>>                Function_Return lpropVal
37020>>>        End_Function
37021>>>
37021>>>        Procedure SET xfindSearchFrom String lpropVal
37022>>>                Send SetStringProperty 7 lpropVal
37023>>>        End_Procedure
37024>>>
37024>>>        Function xfindSearchSubDirs Returns Bool
37025>>>                Local Bool lpropVal
37026>>>                Get GetBoolProperty 8 to lpropVal
37027>>>                Function_Return lpropVal
37028>>>        End_Function
37029>>>
37029>>>        Procedure SET xfindSearchSubDirs Bool lpropVal
37030>>>                Send SetBoolProperty 8 lpropVal
37031>>>        End_Procedure
37032>>>
37032>>>        Procedure xfindStartSearching
37033>>>                Send InvokeVoidFunction 2
37034>>>        End_Procedure 
37035>>>
37035>>>        Function xfindIsSearching Returns Bool
37036>>>                Local Bool lpropVal
37037>>>                Get GetBoolProperty 5 to lpropVal
37038>>>                Function_Return lpropVal
37039>>>        End_Function
37040>>>
37040>>>        Procedure xfindAbortSearch
37041>>>                Send InvokeVoidFunction 9
37042>>>        End_Procedure 
37043>>>
37043>>>        Function xfindFileName Returns String
37044>>>                Local String lpropVal
37045>>>                Get GetStringProperty 3 to lpropVal
37046>>>                Function_Return lpropVal
37047>>>        End_Function
37048>>>
37048>>>        Function xfindFileSize Returns DWORD
37049>>>                Local DWORD lpropVal
37050>>>                Get GetIntegerProperty 4 to lpropVal
37051>>>                Function_Return lpropVal
37052>>>        End_Function
37053>>>
37053>>>End_Class
37054>>>
37054>>>// Events interface for xfind Control
37054>>>// CLSID:{DF5A0223-37A0-11D4-881C-E7F891A83074}
37054>>>// ProgId: 
37054>>>Class OLEIxfindEvents is a Message
37055>>>
37055>>>        Procedure OnxfindActivate
37056>>>        End_Procedure
37057>>>
37057>>>        Procedure OnxfindClick
37058>>>        End_Procedure
37059>>>
37059>>>        Procedure OnxfindCreate
37060>>>        End_Procedure
37061>>>
37061>>>        Procedure OnxfindDblClick
37062>>>        End_Procedure
37063>>>
37063>>>        Procedure OnxfindDestroy
37064>>>        End_Procedure
37065>>>
37065>>>        Procedure OnxfindDeactivate
37066>>>        End_Procedure
37067>>>
37067>>>        Procedure OnxfindKeyPress Integer lKey
37068>>>        End_Procedure
37069>>>
37069>>>        Procedure OnxfindPaint
37070>>>        End_Procedure
37071>>>
37071>>>        Procedure OnxfindFinishedSearch
37072>>>        End_Procedure
37073>>>
37073>>>        Procedure OnxfindFoundFile
37074>>>        End_Procedure
37075>>>
37075>>>End_Class
37076>>>
37076>>>// xfind Control
37076>>>// CoClass CLSID:{DF5A0225-37A0-11D4-881C-E7F891A83074}
37076>>>// ProgId: xfind10.xfind
37076>>>// Number of impl.Types:2
37076>>>// Referenced class Ixfind
37076>>>// Referenced class IxfindEvents
37076>>>Class OLExfind is a OCX_Client
37077>>>        Import_Class_Protocol OLEIxfind
37078>>>        Import_Class_Protocol OLEIxfindEvents
37079>>>
37079>>>        Procedure Construct_Object
37080>>>                Forward Send Construct_Object
37082>>>                Send DefineOCX_Client
37083>>>                Set progIdStr to "xfind10.xfind"
37084>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLExfind"
37087>>>        End_Procedure
37088>>>
37088>>>        Procedure PrexfindKeyPress Integer lParam
37089>>>                Local Integer lKey
37090>>>                Get GetEventShortParam lParam 0 to lKey
37091>>>                Send OnxfindKeyPress lKey
37092>>>        End_Procedure
37093>>>
37093>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
37094>>>                ON_EVENT 1 Fire OnxfindActivate
37097>>>                ON_EVENT 2 Fire OnxfindClick
37100>>>                ON_EVENT 3 Fire OnxfindCreate
37103>>>                ON_EVENT 5 Fire OnxfindDblClick
37106>>>                ON_EVENT 6 Fire OnxfindDestroy
37109>>>                ON_EVENT 7 Fire OnxfindDeactivate
37112>>>                ON_EVENT 11 Fire PrexfindKeyPress
37115>>>                ON_EVENT 16 Fire OnxfindPaint
37118>>>                ON_EVENT 4 Fire OnxfindFinishedSearch
37121>>>                ON_EVENT 8 Fire OnxfindFoundFile
37124>>>        End_Procedure
37125>>>End_Class
37126>>>
37126>>>// xfind Control
37126>>>// CoClass CLSID:{DF5A0225-37A0-11D4-881C-E7F891A83074}
37126>>>// ProgId: xfind10.xfind
37126>>>// Number of impl.Types:2
37126>>>// Referenced class Ixfind
37126>>>// Referenced class IxfindEvents
37126>>>Class dbOLExfind is a dbOCX_Client
37127>>>        Import_Class_Protocol OLEIxfind
37128>>>        Import_Class_Protocol OLEIxfindEvents
37129>>>
37129>>>        Procedure Construct_Object
37130>>>                Forward Send Construct_Object
37132>>>                Send DefineDbOCX_Client
37133>>>                Set progIdStr to "xfind10.xfind"
37134>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLExfind"
37137>>>        End_Procedure
37138>>>
37138>>>        Procedure PrexfindKeyPress Integer lParam
37139>>>                Local Integer lKey
37140>>>                Get GetEventShortParam lParam 0 to lKey
37141>>>                Send OnxfindKeyPress lKey
37142>>>        End_Procedure
37143>>>
37143>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
37144>>>                ON_EVENT 1 Fire OnxfindActivate
37147>>>                ON_EVENT 2 Fire OnxfindClick
37150>>>                ON_EVENT 3 Fire OnxfindCreate
37153>>>                ON_EVENT 5 Fire OnxfindDblClick
37156>>>                ON_EVENT 6 Fire OnxfindDestroy
37159>>>                ON_EVENT 7 Fire OnxfindDeactivate
37162>>>                ON_EVENT 11 Fire PrexfindKeyPress
37165>>>                ON_EVENT 16 Fire OnxfindPaint
37168>>>                ON_EVENT 4 Fire OnxfindFinishedSearch
37171>>>                ON_EVENT 8 Fire OnxfindFoundFile
37174>>>        End_Procedure
37175>>>End_Class
37176>Use EZFTP    // Ftp Package
INCLUDING FILE: EZFTP.PKG
37176>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\EZFTP.OCX
37176>>>// Generated by FlexOLE Class Generator Thursday, December 28, 2000 13:30:32
37176>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
37176>>>
37176>>>// Dispatch interface for EZFTP Control
37176>>>// CLSID:{6580F765-7819-11CF-B86C-444553540000}
37176>>>// ProgId:
37176>>>Class OLE_DEZFTP is a Message
37177>>>
37177>>>        Function EZFTPRemoteAddress Returns String
37178>>>                Local String lpropVal
37179>>>                Get GetStringProperty 1 to lpropVal
37180>>>                Function_Return lpropVal
37181>>>        End_Function
37182>>>
37182>>>        Procedure SET EZFTPRemoteAddress String lpropVal
37183>>>                Send SetStringProperty 1 lpropVal
37184>>>        End_Procedure
37185>>>
37185>>>        Function EZFTPLocalFile Returns String
37186>>>                Local String lpropVal
37187>>>                Get GetStringProperty 2 to lpropVal
37188>>>                Function_Return lpropVal
37189>>>        End_Function
37190>>>
37190>>>        Procedure SET EZFTPLocalFile String lpropVal
37191>>>                Send SetStringProperty 2 lpropVal
37192>>>        End_Procedure
37193>>>
37193>>>        Function EZFTPRemoteFile Returns String
37194>>>                Local String lpropVal
37195>>>                Get GetStringProperty 3 to lpropVal
37196>>>                Function_Return lpropVal
37197>>>        End_Function
37198>>>
37198>>>        Procedure SET EZFTPRemoteFile String lpropVal
37199>>>                Send SetStringProperty 3 lpropVal
37200>>>        End_Procedure
37201>>>
37201>>>        Function EZFTPUserName Returns String
37202>>>                Local String lpropVal
37203>>>                Get GetStringProperty 4 to lpropVal
37204>>>                Function_Return lpropVal
37205>>>        End_Function
37206>>>
37206>>>        Procedure SET EZFTPUserName String lpropVal
37207>>>                Send SetStringProperty 4 lpropVal
37208>>>        End_Procedure
37209>>>
37209>>>        Function EZFTPPassword Returns String
37210>>>                Local String lpropVal
37211>>>                Get GetStringProperty 5 to lpropVal
37212>>>                Function_Return lpropVal
37213>>>        End_Function
37214>>>
37214>>>        Procedure SET EZFTPPassword String lpropVal
37215>>>                Send SetStringProperty 5 lpropVal
37216>>>        End_Procedure
37217>>>
37217>>>        Function EZFTPBinary Returns Bool
37218>>>                Local Bool lpropVal
37219>>>                Get GetBoolProperty 6 to lpropVal
37220>>>                Function_Return lpropVal
37221>>>        End_Function
37222>>>
37222>>>        Procedure SET EZFTPBinary Bool lpropVal
37223>>>                Send SetBoolProperty 6 lpropVal
37224>>>        End_Procedure
37225>>>
37225>>>        Function EZFTPRemoteDirectory Returns String
37226>>>                Local String lpropVal
37227>>>                Get GetStringProperty 9 to lpropVal
37228>>>                Function_Return lpropVal
37229>>>        End_Function
37230>>>
37230>>>        Procedure SET EZFTPRemoteDirectory String lpropVal
37231>>>                Send SetStringProperty 9 lpropVal
37232>>>        End_Procedure
37233>>>
37233>>>        Function EZFTPProfessionalEdition Returns Bool
37234>>>                Local Bool lpropVal
37235>>>                Get GetBoolProperty 10 to lpropVal
37236>>>                Function_Return lpropVal
37237>>>        End_Function
37238>>>
37238>>>        Procedure SET EZFTPProfessionalEdition Bool lpropVal
37239>>>                Send SetBoolProperty 10 lpropVal
37240>>>        End_Procedure
37241>>>
37241>>>        Function EZFTPUseCache Returns Bool
37242>>>                Local Bool lpropVal
37243>>>                Get GetBoolProperty 7 to lpropVal
37244>>>                Function_Return lpropVal
37245>>>        End_Function
37246>>>
37246>>>        Procedure SET EZFTPUseCache Bool lpropVal
37247>>>                Send SetBoolProperty 7 lpropVal
37248>>>        End_Procedure
37249>>>
37249>>>        Function EZFTPCancelTransfer Returns Bool
37250>>>                Local Bool lpropVal
37251>>>                Get GetBoolProperty 8 to lpropVal
37252>>>                Function_Return lpropVal
37253>>>        End_Function
37254>>>
37254>>>        Procedure SET EZFTPCancelTransfer Bool lpropVal
37255>>>                Send SetBoolProperty 8 lpropVal
37256>>>        End_Procedure
37257>>>
37257>>>        Procedure EZFTPConnect
37258>>>                Send InvokeVoidFunction 11
37259>>>        End_Procedure
37260>>>
37260>>>        Procedure EZFTPDisconnect
37261>>>                Send InvokeVoidFunction 12
37262>>>        End_Procedure
37263>>>
37263>>>        Procedure EZFTPGetFile
37264>>>                Send InvokeVoidFunction 13
37265>>>        End_Procedure
37266>>>
37266>>>        Procedure EZFTPPutFile
37267>>>                Send InvokeVoidFunction 14
37268>>>        End_Procedure
37269>>>
37269>>>        Procedure EZFTPDeleteFile String lFileName
37270>>>                Send DeclareParams 1
37271>>>                Send DefineStringParam lFileName
37272>>>                Send InvokeVoidFunction 15
37273>>>        End_Procedure
37274>>>
37274>>>        Procedure EZFTPRenameFile String lOldName String lNewName
37275>>>                Send DeclareParams 2
37276>>>                Send DefineStringParam lOldName
37277>>>                Send DefineStringParam lNewName
37278>>>                Send InvokeVoidFunction 16
37279>>>        End_Procedure
37280>>>
37280>>>        Procedure EZFTPMkDir String lDirectoryName
37281>>>                Send DeclareParams 1
37282>>>                Send DefineStringParam lDirectoryName
37283>>>                Send InvokeVoidFunction 17
37284>>>        End_Procedure
37285>>>
37285>>>        Procedure EZFTPRmDir String lDirectoryName
37286>>>                Send DeclareParams 1
37287>>>                Send DefineStringParam lDirectoryName
37288>>>                Send InvokeVoidFunction 18
37289>>>        End_Procedure
37290>>>
37290>>>        Procedure EZFTPGetDirectory String lFileName
37291>>>                Send DeclareParams 1
37292>>>                Send DefineStringParam lFileName
37293>>>                Send InvokeVoidFunction 19
37294>>>        End_Procedure
37295>>>
37295>>>        Procedure EZFTPAboutBox
37296>>>                Send InvokeVoidFunction -552
37297>>>        End_Procedure
37298>>>
37298>>>End_Class
37299>>>
37299>>>// Event interface for EZFTP Control
37299>>>// CLSID:{6580F766-7819-11CF-B86C-444553540000}
37299>>>// ProgId:
37299>>>Class OLE_DEZFTPEvents is a Message
37300>>>
37300>>>        Procedure OnEZFTPNextDirectoryEntry String lFileName DWORD lAttributes OLEReal lLength
37301>>>        End_Procedure
37302>>>
37302>>>        Procedure OnEZFTPTransferProgress DWORD lBytesTransferred DWORD lTotalBytes
37303>>>        End_Procedure
37304>>>
37304>>>End_Class
37305>>>
37305>>>// EZFTP Control
37305>>>// CoClass CLSID:{6580F767-7819-11CF-B86C-444553540000}
37305>>>// ProgId: EZFTP.EZFTPCtrl.1
37305>>>// Number of impl.Types:2
37305>>>// Referenced class _DEZFTP
37305>>>// Referenced class _DEZFTPEvents
37305>>>
37305>>>Class OLEEZFTP is a OCX_Client
37306>>>        Import_Class_Protocol OLE_DEZFTP
37307>>>        Import_Class_Protocol OLE_DEZFTPEvents
37308>>>
37308>>>        Procedure Construct_Object
37309>>>                Forward Send Construct_Object
37311>>>                Send DefineOCX_Client
37312>>>                Set progIdStr to "EZFTP.EZFTPCtrl.1"
37313>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEEZFTP"
37316>>>        End_Procedure
37317>>>
37317>>>        Procedure PreEZFTPNextDirectoryEntry Integer lParam
37318>>>                Local String lFileName
37319>>>                Local DWORD lAttributes
37319>>>                Local OLEReal lLength
37319>>>                Get GetEventStringParam lParam 0 to lFileName
37320>>>                Get GetEventIntegerParam lParam 1 to lAttributes
37321>>>                Get GetEventRealParam lParam 2 to lLength
37322>>>                Send OnEZFTPNextDirectoryEntry lFileName lAttributes lLength
37323>>>        End_Procedure
37324>>>
37324>>>        Procedure PreEZFTPTransferProgress Integer lParam
37325>>>                Local DWORD lBytesTransferred
37326>>>                Local DWORD lTotalBytes
37326>>>                Get GetEventIntegerParam lParam 0 to lBytesTransferred
37327>>>                Get GetEventIntegerParam lParam 1 to lTotalBytes
37328>>>                Send OnEZFTPTransferProgress lBytesTransferred lTotalBytes
37329>>>        End_Procedure
37330>>>
37330>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
37331>>>                ON_EVENT 1 Fire PreEZFTPNextDirectoryEntry
37334>>>                ON_EVENT 2 Fire PreEZFTPTransferProgress
37337>>>        End_Procedure
37338>>>End_Class
37339>>>
37339>>>// EZFTP Control
37339>>>// CoClass CLSID:{6580F767-7819-11CF-B86C-444553540000}
37339>>>// ProgId: EZFTP.EZFTPCtrl.1
37339>>>// Number of impl.Types:2
37339>>>// Referenced class _DEZFTP
37339>>>// Referenced class _DEZFTPEvents
37339>>>Class dbOLEEZFTP is a dbOCX_Client
37340>>>        Import_Class_Protocol OLE_DEZFTP
37341>>>        Import_Class_Protocol OLE_DEZFTPEvents
37342>>>
37342>>>        Procedure Construct_Object
37343>>>                Forward Send Construct_Object
37345>>>                Send DefineDbOCX_Client
37346>>>                Set progIdStr to "EZFTP.EZFTPCtrl.1"
37347>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEEZFTP"
37350>>>        End_Procedure
37351>>>
37351>>>        Procedure PreEZFTPNextDirectoryEntry Integer lParam
37352>>>                Local String lFileName
37353>>>                Local DWORD lAttributes
37353>>>                Local OLEReal lLength
37353>>>                Get GetEventStringParam lParam 0 to lFileName
37354>>>                Get GetEventIntegerParam lParam 1 to lAttributes
37355>>>                Get GetEventRealParam lParam 2 to lLength
37356>>>                Send OnEZFTPNextDirectoryEntry lFileName lAttributes lLength
37357>>>        End_Procedure
37358>>>
37358>>>        Procedure PreEZFTPTransferProgress Integer lParam
37359>>>                Local DWORD lBytesTransferred
37360>>>                Local DWORD lTotalBytes
37360>>>                Get GetEventIntegerParam lParam 0 to lBytesTransferred
37361>>>                Get GetEventIntegerParam lParam 1 to lTotalBytes
37362>>>                Send OnEZFTPTransferProgress lBytesTransferred lTotalBytes
37363>>>        End_Procedure
37364>>>
37364>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
37365>>>                ON_EVENT 1 Fire PreEZFTPNextDirectoryEntry
37368>>>                ON_EVENT 2 Fire PreEZFTPTransferProgress
37371>>>        End_Procedure
37372>>>End_Class
37373>Use dvFTP    // Ftp Package
INCLUDING FILE: DVFTP.PKG
37373>>>// DVFTP.PKG - Internet File Transfer Protocol (FTP) functions
37373>>>//             for Visual Dataflex
37373>>>//
37373>>>// Created by: Marcel J. Zwiebel
37373>>>//             Dataview - The Netherlands
37373>>>// E-mail    : marcel@dataview-sc.com
37373>>>// CIS id    : 100273,2473
37373>>>// Web URL   : http://www.dataview-sc.com
37373>>>//
37373>>>// Date      : 28/07/1997 
37373>>>
37373>>>Use Windows.pkg
37373>>>Use DLL.pkg
37373>>>
37373>>>// register external functions of the dvftp.dll
37373>>>
37373>>>
37373>>>// function   : dvInternetAttemptConnect
37373>>>//
37373>>>// description: Attemps to make a connection to the Internet. If the user has a dialup-connection
37373>>>//              to an Internet Service Provider (ISP) and the computer is not connected to this 
37373>>>//              ISP, the standard dialup dialog box will be evoked.
37373>>>//                   
37373>>>// parameters : none
37373>>>//
37373>>>// returns    : integer - Is 0 (ok) or error-number.
37373>>>//
37373>>>External_Function dvInternetAttemptConnect "dvInternetAttemptConnect" DVFTP.DLL ;     Returns Integer
37374>>>
37374>>>
37374>>>// function   : dvInternetOpen
37374>>>//
37374>>>// description: Initializes the application's use of the WIN32 Internet functions.
37374>>>//
37374>>>// parameters : none
37374>>>//
37374>>>// returns    : integer - Is 0 (ok) or error-number.
37374>>>//
37374>>>External_Function dvInternetOpen "dvInternetOpen" DVFTP.DLL ;     Returns Integer
37375>>>
37375>>>
37375>>>// function   : dvInternetConnect
37375>>>//
37375>>>// description: Opens an FTP-session with a server.
37375>>>//
37375>>>// parameters : string ServerName - Can be a DNS-name (for example: ftp.daccess.com) or 
37375>>>//                                  an ip-number (for example: 145.58.31.4).
37375>>>//              string UserName   - Login-name for the server, can be empty for 
37375>>>//                                  "anonymous" login (default for most FTP servers).
37375>>>//              string Password   - Password for the server, can be empty for 
37375>>>//                                  "anonymous" login (default for most FTP servers).
37375>>>//              integer Firewall  - Must be 1 for connecting through a SOCKS firewall
37375>>>//                                  server, otherwise 0.
37375>>>//
37375>>>// returns    : integer - Is 0 (ok) or error-number.
37375>>>//
37375>>>External_Function dvInternetConnect "dvInternetConnect" DVFTP.DLL ;     String szServerName String szUserName String szPassword Integer iFirewall;     Returns Integer
37376>>>
37376>>>
37376>>>// function   : dvFtpSetCurrentDirectory
37376>>>//
37376>>>// description: Changes to a different working directory on the FTP server.
37376>>>//
37376>>>// parameters : string directory - Name of the directory to change to on the remote system. 
37376>>>//                                 This can be either a fully qualified path or a name 
37376>>>//                                 relative to the current directory. 
37376>>>//                                 A backslash (\) or forward slash (/) can be used as the 
37376>>>//                                 directory separator for either name. dvFtpSetCurrentDirectory
37376>>>//                                 translates the directory name separators to the appropriate 
37376>>>//                                 character before they are used. 
37376>>>//                                 Use dvFtpGetCurrentDirectory to determine the remote site's 
37376>>>//                                 current working directory (not all remote systems use a
37376>>>//                                 hierarchical naming scheme for directories).
37376>>>//
37376>>>// returns    : integer - Is 0 (ok) or error-number.
37376>>>//
37376>>>External_Function dvFtpSetCurrentDirectory "dvFtpSetCurrentDirectory" DVFTP.DLL ;     String szDirectory Returns Integer
37377>>>
37377>>>
37377>>>// function   : dvFtpGetCurrentDirectory
37377>>>//
37377>>>// description: Retrieves the current directory for the specified FTP session.
37377>>>//
37377>>>// parameters : none
37377>>>//
37377>>>// returns    : string - Name of the current directory.
37377>>>//
37377>>>External_Function dvFtpGetCurrentDirectory "dvFtpGetCurrentDirectory" DVFTP.DLL ;     Returns String
37378>>>
37378>>>
37378>>>// function   : dvFtpCreateDirectory
37378>>>//
37378>>>// description: Creates a new directory on the FTP server. 
37378>>>//
37378>>>// parameters : string Directory - The name of the directory to create on the remote system.
37378>>>//                                 This can be either a fully qualified path or a name 
37378>>>//                                 relative to the current directory. 
37378>>>//                                 A backslash (\) or forward slash (/) can be used as the 
37378>>>//                                 directory separator for either name. dvFtpCreateDirectory
37378>>>//                                 translates the directory name separators to the appropriate 
37378>>>//                                 character before they are used. 
37378>>>//                                 Use dvFtpGetCurrentDirectory to determine the remote site's 
37378>>>//                                 current working directory (not all remote systems use a
37378>>>//                                 hierarchical naming scheme for directories).
37378>>>//
37378>>>// returns    : integer - Is 0 (ok) or error-number.
37378>>>//
37378>>>External_Function dvFtpCreateDirectory "dvFtpCreateDirectory" DVFTP.DLL ;     String szDirectory Returns Integer
37379>>>
37379>>>
37379>>>// function   : dvFtpRemoveDirectory
37379>>>//
37379>>>// description: Removes the specified directory on the FTP server. 
37379>>>//
37379>>>// parameters : string Directory - The name of the directory to remove on the remote system.
37379>>>//                                 This can be either a fully qualified path or a name 
37379>>>//                                 relative to the current directory. 
37379>>>//                                 A backslash (\) or forward slash (/) can be used as the 
37379>>>//                                 directory separator for either name. dvFtpRemoveDirectory
37379>>>//                                 translates the directory name separators to the appropriate 
37379>>>//                                 character before they are used. 
37379>>>//                                 Use dvFtpGetCurrentDirectory to determine the remote site's 
37379>>>//                                 current working directory (not all remote systems use a
37379>>>//                                 hierarchical naming scheme for directories).
37379>>>//
37379>>>// returns    : integer - Is 0 (ok) or error-number.
37379>>>//
37379>>>External_Function dvFtpRemoveDirectory "dvFtpRemoveDirectory" DVFTP.DLL ;     String szDirectory Returns Integer
37380>>>
37380>>>
37380>>>// function   : dvFtpFindFirstFile
37380>>>//
37380>>>// description: Searches the specified directory of the given FTP session.
37380>>>//
37380>>>// parameters : string FileSelect - A valid directory path or file name (wildcards allowed) for
37380>>>//                                  the FTP server's file system. If the string is empty the 
37380>>>//                                  first file in the current directory on the server will be 
37380>>>//                                  searched for. 
37380>>>//              integer UseCache  - Indicates using the local computer's cache.
37380>>>//                                  If the value is 0 then the the cache will be used. 
37380>>>//                                  If the value is 1 then a download of the requested file, 
37380>>>//                                  object, or directory listing from the origin server will be 
37380>>>//                                  forced, not from the cache.
37380>>>//
37380>>>// returns    : string - Name of the first file found or empty when no files found. When the 
37380>>>//                       searched directory is empty the string "directory is empty" is returned.
37380>>>//
37380>>>External_Function dvFtpFindFirstFile "dvFtpFindFirstFile" DVFTP.DLL ;     String szFileSelect Integer iUseCache Returns String
37381>>>
37381>>>
37381>>>// function   : dvFtpFindNextFile
37381>>>//
37381>>>// description: Continues a file search started as a result of executing dvFtpFindFirstFile.
37381>>>//
37381>>>// parameters : none
37381>>>//
37381>>>// returns    : string - Name of the next file found or empty when no more files are found.
37381>>>//
37381>>>External_Function dvFtpFindNextFile "dvFtpFindNextFile" DVFTP.DLL ;     Returns String
37382>>>
37382>>>
37382>>>// function   : dvFtpDeleteFile
37382>>>//
37382>>>// description: Deletes a file stored on the FTP server. 
37382>>>//
37382>>>// parameters : string FileSelect - Name of the file to be deleted.
37382>>>//                                  Can be file names relative to the current directory. 
37382>>>//                                  A backslash (\) or forward slash (/) can be used as 
37382>>>//                                  the directory separator. dvFtpDeleteFile translates the 
37382>>>//                                  directory name separators to the appropriate character 
37382>>>//                                  before they are used. 
37382>>>//
37382>>>// returns    : integer - Is 0 (ok) or error-number.
37382>>>//
37382>>>External_Function dvFtpDeleteFile "dvFtpDeleteFile" DVFTP.DLL ;     String szFileSelect Returns Integer
37383>>>
37383>>>
37383>>>// function   : dvFtpRenameFile
37383>>>//
37383>>>// description: Renames a file stored on the FTP server. 
37383>>>//
37383>>>// parameters : string Existing - The name of the file that will have its name changed on the
37383>>>//                                remote FTP server. 
37383>>>//              string New      - The new name for the remote file. 
37383>>>//
37383>>>//                                Both names can be relative to the current directory. A backslash 
37383>>>//                                (\) or forward slash (/) can be used as the directory separator 
37383>>>//                                for either name. dvFtpRenameFile translates the directory name 
37383>>>//                                separators to the appropriate character before they are used. 
37383>>>//
37383>>>// returns    : integer - Is 0 (ok) or error-number.
37383>>>//
37383>>>External_Function dvFtpRenameFile "dvFtpRenameFile" DVFTP.DLL ;     String szExisting String szNew Returns Integer
37384>>>
37384>>>
37384>>>// function   : dvFtpGetFile
37384>>>//
37384>>>// description: Retrieves a file from the FTP server and stores it under the specified file name, 
37384>>>//              creating a new local file in the process. 
37384>>>//
37384>>>// parameters : string  RemoteFile   - The name of the file to retrieve from the remote system. 
37384>>>//              string  NewFile      - The name of the file to create on the local system. 
37384>>>//              integer FailIfExists - Boolean flag that indicates whether the function should 
37384>>>//                                     proceed if a local file of the specified name already exists. 
37384>>>//                                     If value is 1 and the local file exists, dvFtpGetFile fails. 
37384>>>//              integer FileType     - Indicates the transfer method.
37384>>>//                                     If the value is 0 then the function transfers the file using 
37384>>>//                                     FTP's ASCII (Type A) transfer method. Control and formatting 
37384>>>//                                     information is converted to local equivalents. 
37384>>>//                                     If the value is 1 then the function transfers the file using 
37384>>>//                                     FTP's Image (Type I) transfer method. The file is transferred 
37384>>>//                                     exactly as it exists with no changes. 
37384>>>//
37384>>>// returns    : integer - Is 0 (ok) or error-number.
37384>>>//
37384>>>External_Function dvFtpGetFile "dvFtpGetFile" DVFTP.DLL ;     String szRemoteFile String szNewFile Integer bFailIfExists Integer iFileType Returns Integer
37385>>>
37385>>>
37385>>>// function   : dvFtpPutFile
37385>>>//
37385>>>// description: Stores a file on the FTP server. 
37385>>>//
37385>>>// parameters : string  LocalFile     - The name of the file to send from the local system. 
37385>>>//              string  NewRemoteFile - The name of the file to create on the remote system.
37385>>>//              integer FileType      - Indicates the transfer method.
37385>>>//                                      If the value is 0 then the function transfers the 
37385>>>//                                      file as ASCII. 
37385>>>//                                      If the value is 1 then the function transfres the
37385>>>//                                      file as binary. 
37385>>>//
37385>>>// returns    : integer - Is 0 (ok) or error-number.
37385>>>//
37385>>>External_Function dvFtpPutFile "dvFtpPutFile" DVFTP.DLL ;     String szLocalFile String szNewRemoteFile Integer iFileType Returns Integer
37386>>>
37386>>>
37386>>>
37386>>>// The following functions give common file-information after performing dvFtpFindFirstFile
37386>>>// and dvFtpFindNextFile. Because the FTP protocol provides no standard means of enumerating, 
37386>>>// some of the common information about files, such as file creation date and time, is not 
37386>>>// always available or correct. When this happens, dvFtpFindFirstFile and dvFtpFindNextFile 
37386>>>// fill in unavailable information with a best guess based on available information. For example,
37386>>>// creation and last access dates will often be the same as the file's modification date.
37386>>>
37386>>>
37386>>>// function   : dvFtpFilename
37386>>>//
37386>>>// description: The name of the file. 
37386>>>//
37386>>>// parameters : none
37386>>>//
37386>>>// returns    : string - Name of the file
37386>>>//
37386>>>External_Function dvFtpFilename "dvFtpFilename" DVFTP.DLL ;     Returns String
37387>>>
37387>>>
37387>>>// function   : dvFtpAlternateFilename
37387>>>//
37387>>>// description: An alternative name for the file. This name is in the classic 8.3 (filename.ext)
37387>>>//              filename format.
37387>>>//
37387>>>// parameters : none
37387>>>//
37387>>>// returns    : string - Alternate name for the file. If the file has a long filename, the complete 
37387>>>//                       name can be retrieved by the dvFtpFilename function, and the 8.3 format
37387>>>//                       truncated version of the name can be retrieved with this function. Otherwise, 
37387>>>//                       this function returns an empty string.
37387>>>//
37387>>>External_Function dvFtpAlternateFilename "dvFtpAlternateFilename" DVFTP.DLL ;     Returns String
37388>>>
37388>>>
37388>>>// function   : dvFtpFileCreated
37388>>>//              
37388>>>// description: The date/time the file was created in 24-hour format.
37388>>>//
37388>>>// parameters : integer DateFormat - The format of the date to be retrieved.
37388>>>//                                   If value is 0 then US-formatted date is returned (mm/dd/yyyy).
37388>>>//                                   If value is 1 then European-formatted date is returned (dd/mm/yyyy).
37388>>>//                                   If value is 2 then military-formatted date is returned (yyyy.mm.dd).
37388>>>//
37388>>>// returns    : string - The file creation-date/time
37388>>>//
37388>>>External_Function dvFtpFileCreated "dvFtpFileCreated" DVFTP.DLL ;     Integer iDateFormat Returns String
37389>>>
37389>>>
37389>>>// function   : dvFtpFileAccessed
37389>>>//              
37389>>>// description: The last date/time the file was accessed in 24-hour format.
37389>>>//
37389>>>// parameters : integer DateFormat - The format of the date to be retrieved.
37389>>>//                                   If value is 0 then US-formatted date is returned (mm/dd/yyyy).
37389>>>//                                   If value is 1 then European-formatted date is returned (dd/mm/yyyy).
37389>>>//                                   If value is 2 then military-formatted date is returned (yyyy.mm.dd).
37389>>>//
37389>>>// returns    : string - The last file access-date/time
37389>>>//
37389>>>External_Function dvFtpFileAccessed "dvFtpFileAccessed" DVFTP.DLL ;     Integer iDateFormat Returns String
37390>>>
37390>>>
37390>>>// function   : dvFtpFileWritten
37390>>>//              
37390>>>// description: The last date/time the file was written to in 24-hour format.
37390>>>//
37390>>>// parameters : integer DateFormat - The format of the date to be retrieved.
37390>>>//                                   If value is 0 then US-formatted date is returned (mm/dd/yyyy).
37390>>>//                                   If value is 1 then European-formatted date is returned (dd/mm/yyyy).
37390>>>//                                   If value is 2 then military-formatted date is returned (yyyy.mm.dd).
37390>>>//
37390>>>// returns    : string - The last file written to-date/time
37390>>>//
37390>>>External_Function dvFtpFileWritten "dvFtpFileWritten" DVFTP.DLL ;     Integer iDateFormat Returns String
37391>>>
37391>>>
37391>>>// function   : dvFtpFileSize
37391>>>//              
37391>>>// description: The size of the file in bytes.
37391>>>//
37391>>>// parameters : none
37391>>>//
37391>>>// returns    : integer - Filesize in bytes.
37391>>>//
37391>>>External_Function dvFtpFileSize "dvFtpFileSize" DVFTP.DLL ;     Returns Integer
37392>>>
37392>>>
37392>>>// function   : dvFtpIsDirectory
37392>>>//              
37392>>>// description: The file is an directory.
37392>>>//
37392>>>// parameters : none
37392>>>//
37392>>>// returns    : integer - If value is 1 the file is directory, otherwise 0 will be returned.
37392>>>//
37392>>>External_Function dvFtpIsDirectory "dvFtpIsDirectory" DVFTP.DLL ;     Returns Integer
37393>>>
37393>>>
37393>>>// function   : dvGetServerMsg
37393>>>//              
37393>>>// description: Gets the returned message from the FTP server (error-number will
37393>>>//              be 12003 "extended error").
37393>>>//
37393>>>// parameters : none
37393>>>//
37393>>>// returns    : string - Return message from the FTP server.
37393>>>//
37393>>>External_Function dvGetServerMsg "dvGetServerMsg" DVFTP.DLL;     Returns String
37394>>>
37394>>>
37394>>>// error-numbers returned
37394>>>//
37394>>>// 12001  "out of handles"            
37394>>>// 12002  "timeout"
37394>>>// 12003  "extended error"
37394>>>// 12004  "internal error"            
37394>>>// 12005  "invalid url"               
37394>>>// 12006  "unrecognized scheme"       
37394>>>// 12007  "name not resolved"         
37394>>>// 12008  "protocol not found"        
37394>>>// 12009  "invalid option"            
37394>>>// 12010  "bad option length"         
37394>>>// 12011  "option not settable"      
37394>>>// 12012  "shutdown"                  
37394>>>// 12013  "incorrect user name"       
37394>>>// 12014  "incorrect password"
37394>>>// 12015  "login failure"             
37394>>>// 12016  "invalid operation"         
37394>>>// 12017  "operation cancelled"       
37394>>>// 12018  "incorrect handle type"     
37394>>>// 12019  "incorrect handle state"
37394>>>// 12020  "not proxy request"         
37394>>>// 12021  "registry value not found"
37394>>>// 12022  "bad registry parameter"    
37394>>>// 12023  "no direct access"          
37394>>>// 12024  "no context"                
37394>>>// 12025  "no callback"               
37394>>>// 12026  "request pending"           
37394>>>// 12027  "incorrect format"          
37394>>>// 12028  "item not found"            
37394>>>// 12029  "cannot connect"            
37394>>>// 12030  "connection aborted"        
37394>>>// 12031  "connection reset"          
37394>>>// 12032  "force retry"               
37394>>>// 12033  "invalid proxy request"     
37394>>>// 12034  "need ui"                   
37394>>>// 12036  "handle exists"             
37394>>>// 12037  "sec cert date invalid"     
37394>>>// 12038  "sec cert cn invalid"       
37394>>>// 12039  "http to https on redir"    
37394>>>// 12040  "https to http on_redir"    
37394>>>// 12041  "mixed security"            
37394>>>// 12042  "chg post is non secure"    
37394>>>// 12043  "post is non_secure"        
37394>>>// 12044  "client auth cert needed"   
37394>>>// 12045  "invalid ca"                
37394>>>// 12046  "client auth not setup"     
37394>>>// 12047  "async thread failed"       
37394>>>// 12048  "redirect scheme change"    
37394>>>// 12049  "dialog pending"            
37394>>>// 12050  "retry dialog"              
37394>>>// 12110  "ftp transfer in progress"  
37394>>>// 12111  "ftp dropped"               
37394>>>// 12112  "ftp no passive mode"       
37394>>>// 12157  "security channel error"    
37394>>>// 12158  "unable to cache file"      
37394>>>// 12159  "tcpip not installed"       
37394>>>// 12163  "disconnected"              
37394>>>// 12164  "server unreachable"        
37394>>>// 12165  "proxy server unreachable"  
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>Use DVDIALER // Vdf6 Dialer
INCLUDING FILE: DVDIALER.PKG
37394>>>// DVDIALER.PKG - Automatic dialing functions for dial-up access to the Internet
37394>>>//
37394>>>// Created by: Marcel J. Zwiebel
37394>>>//             Dataview - The Netherlands
37394>>>// E-mail    : marcel@dataview-sc.com
37394>>>// Web URL   : http://www.dataview-sc.com
37394>>>//
37394>>>// Date      : 03/24/1999
37394>>>
37394>>>Use Windows.pkg
37394>>>Use DLL.pkg 
37394>>>
37394>>>
37394>>>// register external functions of the dvdailer.dll
37394>>>
37394>>>
37394>>>// function   : dvInternetGetConnectedState
37394>>>//
37394>>>// description: Retrieves the connected state of the local system.
37394>>>//                   
37394>>>// parameters : none
37394>>>//
37394>>>// returns    : integer - value 1 = the local system is (currently) connected by a modem to the Internet.
37394>>>//                              2 = the local system uses a local area network to connect to the Internet.
37394>>>//                              3 = the local system uses a proxy server to connect to the Internet.
37394>>>//                              4 = the local system's modem is busy with a non-Internet connection.
37394>>>//                              0 = there is no Internet connection.
37394>>>//
37394>>>External_Function32 dvInternetGetConnectedState "dvInternetGetConnectedState" DVDIALER.DLL Returns Integer
37395>>>
37395>>>
37395>>>// function   : dvInternetAutodial
37395>>>//
37395>>>// description: Automatically causes the modem to dial the default Internet connection.
37395>>>//              Use the function dvInternetAutodialHangup to hangup this connection.
37395>>>//                   
37395>>>// parameters : none
37395>>>//
37395>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37395>>>//
37395>>>External_Function32 dvInternetAutodial "dvInternetAutodial" DVDIALER.DLL Returns Integer
37396>>>
37396>>>
37396>>>// function   : dvInternetAutodialHangup
37396>>>//
37396>>>// description: Disconnects an automatic dial-up connection invoked by dvInternetAutodial. 
37396>>>//                   
37396>>>// parameters : none
37396>>>//
37396>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37396>>>//
37396>>>External_Function32 dvInternetAutodialHangup "dvInternetAutodialHangup" DVDIALER.DLL Returns Integer
37397>>>
37397>>>
37397>>>// function   : dvInternetDial
37397>>>//
37397>>>// description: Initiates a connection to the Internet using a modem connection and a phonebook entry.
37397>>>//              Use the function dvInternetHangup to hangup this connection.
37397>>>//                   
37397>>>// parameters : string - The name of the dial-up connection to use (phonebook entry).
37397>>>//
37397>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37397>>>//
37397>>>External_Function32 dvInternetDial "dvInternetDial" DVDIALER.DLL String szConnectiontoid Returns Integer
37398>>>
37398>>>
37398>>>// function   : dvInternetHangup
37398>>>//
37398>>>// description: Instructs the modem to disconnect from the Internet (connection invoked by dvInternetDial). 
37398>>>//              
37398>>>// parameters : none
37398>>>//
37398>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37398>>>//
37398>>>External_Function32 dvInternetHangUp "dvInternetHangUp" DVDIALER.DLL Returns Integer
37399>>>
37399>>>
37399>>>
37399>>>
37399>>>
37399>>>
37399>>>
37399>>>
37399>>>
37399>>>
37399>>>
37399>>>
37399>//------------------------------
37399>
37399>
37399>//AB-StoreTopEnd
37399>
37399>
37399>Object Main is a Panelsub
37401>    Set Label To "MetafNoErga"
37402>
37402>    DFCreate_Menu Main_Menu
INCLUDING FILE: FILE_PM.INC
37405>>//************************************************************************
37405>>//
37405>>//* Copyright (c) 1997 Data Access Corporation, Miami Florida,
37405>>//* All rights reserved.
37405>>//* DataFlex is a registered trademark of Data Access Corporation.
37405>>//*
37405>>//*
37405>>//*  Module Name:
37405>>//*      FILE_PM.INC
37405>>//*
37405>>//*  Creator:
37405>>//*        LS, MAZ, JJT(changed for windaf)
37405>>//*
37405>>//*  Date:
37405>>//*      November 31, 1992
37405>>//*      10/28/94 03:17 pm - JJT windaf chagges
37405>>//*
37405>>//*  Purpose:
37405>>//*         package for creating generic record_pull_down object for entry
37405>>//*             object actions(assumed to be used as first pull down menu,
37405>>//*             hence EXIT option as last item)
37405>>//*
37405>>//*************************************************************************
37405>>// JJT - Modified to shadow items if not a DEO OR if no server
37405>>//*************************************************************************
37405>>
37405>>
37405>>Object oMyWinPrint is an DF_PRINTER
37407>>
37407>>    Procedure DFPrint
37409>>        Local Integer iRetVal
37410>>
37410>>        Get DFGetPrintDialogFlags To iRetVal
37411>>
37411>>        If iRetVal Begin
37413>>            Send DFPrintDoc
37414>>            Send DFClearDoc
37415>>        End
37415>>>
37415>>    End_Procedure
37416>>    Move Current_Object to WinPrintId
37417>>End_Object
37418>>
37418>>Register_Procedure Set piPropertiesObjectId
37418>>Register_Function piPropertiesObjectId Returns Integer
37418>>
37418>>Register_Function Close_All_Views Integer bWith_Confirmation Returns Integer
37418>>
37418>>DFCreate_Menu "&„šš¨˜­âª" File_Menu is a DEOPopupMenu
37422>>    On_Item "&€¡ç¨à©ž/Add\aF5" send Request_Clear
37423>>        Set Status_Help To '‰˜Ÿ˜¨åœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã'
37424>>
37424>>    On_Item "&Super €¡ç¨à©ž\aCtrl+F5" send Request_Clear_All
37425>>        Set Status_Help To '‰˜Ÿ˜¨åœ  æ¢˜ «˜ ›œ›¦£â¤˜ ˜§æ «ž¤ æ¯ž'
37426>>
37426>>    On_Item "&ƒ ˜š¨˜­ã\aShift+F2" send Request_Delete
37427>>        Set Status_Help To 'ƒ ˜š¨á­œ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã'
37428>>
37428>>    On_Item "&€¤˜ã«ž©ž\aF9" send Find_GE
37429>>        Set Status_Help To '¨å©¡œ  £ á œšš¨˜­ã'
37430>>
37430>>    On_Item "&„§æ£œ¤¦\aF8" send Find_Next
37431>>        Set Status_Help To '¨å©¡œ  «ž¤ œ§æ£œ¤ž œšš¨˜­ã'
37432>>
37432>>    On_Item "&¨¦žš¦ç£œ¤¦\aF7" send Find_Previous
37433>>        Set Status_Help To '¨å©¡œ  «ž¤ §¨¦žš¦ç£œ¤ž œšš¨˜­ã'
37434>>
37434>>    //On_Item "Super ˜¤˜ã«ž©ž\aShift+F9" send Superfind
37434>>    //    Set Status_Help To 'Super_˜¤˜ã«ž©ž £ áª œšš¨˜­ãª'
37434>>
37434>>    //On_Item "Super œ§æ£œ¤¦\aShift+F8" send Superfind_Next
37434>>    //    Set Status_Help To 'Super_˜¤˜ã«ž©ž œ§æ£œ¤žª œšš¨˜­ãª'
37434>>
37434>>    //On_Item "Super §¨¦žš¦ç£œ¤¦\aShift+F7" send Superfind_Previous
37434>>    //    Set Status_Help To 'Super_˜¤˜ã«ž©ž §¨¦žš¦ç£œ¤žª œšš¨˜­ãª'
37434>>
37434>>    On_Item "&¨é«¦\aCtrl+Home" send Beginning_Of_Data
37435>>        Set Status_Help To '¨å©¡œ  «ž¤ §¨é«ž œšš¨˜­ã'
37436>>
37436>>    On_Item "’œ&¢œ¬«˜å¦\aCtrl+End" send End_Of_Data
37437>>        Set Status_Help To '¨å©¡œ  «ž¤ «œ¢œ¬«˜¢å˜ œšš¨˜­ã'
37438>>
37438>>    On_Item "&„šš¨˜­ž\aF2" send Request_Save
37439>>        Set Status_Help To '‘éœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã'
37440>>
37440>>    On_Item "" send NONE
37441>>
37441>>    //on_item   "çŸ£ ©ž œ¡«ç§à©žª  "  Send Activate_oPrnSetup to (client_area(current_object))
37441>>    on_item   "çŸ£ ©ž œ¡«ç§à©žª  "  send DFPrintSetup       to (oWinPrint(Self))
37442>>    Set Status_Help To "çŸ£ ©ž œ¡«ç§à©žª"
37443>>    on_item   "„¡«ç§à©ž           "  send DFPrint            to (oMyWinPrint(Self))
37444>>    Set Status_Help To "„¡«ç§à©ž œšš¨á­¦¬"
37445>>
37445>>    On_Item "" send NONE
37446>>
37446>>    On_Item "&ˆ› ¦«ž«œª\aAlt+I" send DoShowProperties to Self
37447>>    Set Status_Help To '‰˜Ÿ¦¨ ©£æª ˆ› ¦«ã«à¤ «žª œ­˜¨£¦šãª'
37448>>
37448>>    On_Item "" send NONE
37449>>
37449>>    On_Item "„&¥¦›¦ª\aAlt+F4" send Exit_Application to desktop
37450>>        Set Status_Help To 'š˜å¤œ  ˜§¦ «ž¤ œ­˜¨£¦šã'
37451>>
37451>>    Procedure DoShowProperties
37453>>        If (Close_All_Views(Self,True)=0) Send Activate_View to (piPropertiesObjectId(self))
37456>>    End_Procedure
37457>>
37457>>    On_Key Key_Alt+Key_I Send DoShowProperties
37458>>
37458>>    //  When ever the menu [pulldown] is initialized, check/set
37458>>    //  the state of its items.
37458>>    //
37458>>    Procedure OnInitMenu
37460>>        Local integer Obj# IsDeo Changed NoIndex File# Field# Srvr Itm
37461>>        Local integer IsDeoControl lId liClId
37461>>        Get Focus to Obj#
37462>>        Get is_Function Get_DEO_Object Obj# TRUE to IsDeo
37463>>        If IsDeo Get Server of obj# to Srvr          // invoking data-set
37466>>        If (isDeo AND Srvr) Begin
37468>>            // returns T if object in question is a DEO control object (i.e.
37468>>            // understands the data_file, data_field messages).
37468>>            Get is_Function Get_DEO_Control_Object Obj# False to IsDeoControl
37469>>            Get Should_Save of Obj# to changed  // changed file?
37470>>            If IsDEOControl Begin
37472>>                Get data_file of Obj# to file#
37473>>                Get data_field of Obj# to field#
37474>>                Move ( File#=0 OR ;                    (Field_Main_Index(Srvr,File#,Field#)=-1) ;                    ) to NoIndex             // has a find index?
37475>>            End
37475>>>
37475>>            Else ;                Move 1 to NoIndex
37477>>            Set Shadow_state item 0  to False
37478>>            Set Shadow_state item 1  to False
37479>>            Set Shadow_state item 2  to (Current_record(Srvr)=0)
37480>>            Set Shadow_state item 3  to NoIndex
37481>>            Set Shadow_state item 4  to NoIndex
37482>>            Set Shadow_state item 5  to NoIndex
37483>>            Set Shadow_state item 6  to NoIndex
37484>>            Set Shadow_state item 7  to NoIndex
37485>>            Set Shadow_state item 8  to (Should_Save(Srvr)=0)
37486>>         //   Set Shadow_state item 9  to NoIndex
37486>>         //   Set Shadow_state item 10  to NoIndex
37486>>         //   Set Shadow_state item 11 to NoIndex
37486>>         //   Set Shadow_state item 12 to (Should_Save(Srvr)=0)
37486>>        End
37486>>>
37486>>        Else Begin
37487>>            for itm from 0 to 8 //11
37493>>>
37493>>                set shadow_State item itm to TRUE
37494>>            Loop
37495>>>
37495>>        End
37495>>>
37495>>        Set Shadow_State Item 13 to (piPropertiesObjectId(Self)=0)
37496>>    End_Procedure
37497>>
37497>>    Register_Procedure Activate_oPrnSetup
37497>>
37497>>End_Pull_Down
37499>>Set Status_Help to "€¤˜ã«ž©ž, „šš¨˜­ã, ƒ ˜š¨˜­ã, €¡ç¨à©ž ›œ›¦£â¤à¤ ã â¥¦›¦ª ˜§¦ «ž¤ œ­˜¨£¦šã"
37500>
37500>        DFCreate_Menu "&View" ViewPopupMenu is a ViewPopupMenu
37504>        End_Pull_down
37506>        Set Status_Help To "Available Views"
37507>        
37507>        DFCreate_Menu "&Report" ReportPopupMenu is a ViewPopupMenu
37511>            On_Item "&rMetafNoErg\aCtrl+1" Send Activate_rMetafNoErg
37512>        End_Pull_down
37514>        Set Status_Help To "Available Reports"
37515>        
INCLUDING FILE: NAVI_PM.INC
37515>>Use DFDEOMnu
37515>>
37515>>DFCreate_Menu "&Navigation" NAVIGATE_Menu is a DEOPopupMenu
37519>>    On_Item "&Next Area\aF6"            send Switch_Next_Area
37520>>        Set Status_Help To  'Move to Next Area'
37521>>
37521>>    On_Item "&Previous Area\aShift+F6"  send Switch_Prior_Area
37522>>        Set Status_Help To  'Move to Previous Area'
37523>>
37523>>    On_Item "N&ext View\aAlt+F6"        send Switch_Next_View
37524>>        Set Status_Help To  'Move to Next View'
37525>>
37525>>    On_Item "P&revious View\aCtrl+F6"   send Switch_Prior_View
37526>>        Set Status_Help To  'Move to Previous View'
37527>>
37527>>    On_Item ""                          send none
37528>>
37528>>    On_Item "&List\aF4"               send Prompt
37529>>        Set Status_Help To  'Show Selection Lists'
37530>>
37530>>    On_Item "&Zoom\aAlt+F9"             send Zoom
37531>>        Set Status_Help To  'Show Zoom'
37532>>
37532>>    Procedure OnInitMenu
37534>>        Local integer Obj# IsDeo Itm prmpt zm isDeoControl
37535>>        Get Focus to Obj#
37536>>        Get is_Function Get_DEO_Object Obj# TRUE to IsDeo
37537>>        If IsDeo Begin
37539>>            Get is_Function Get_DEO_Control_Object Obj# False to IsDeoControl
37540>>            If IsDeoControl Begin
37542>>                Get Prompt_Object of Obj# to Prmpt
37543>>                Get Zoom_Object of Obj# to zm
37544>>            End
37544>>>
37544>>            Set Shadow_state item 0  to False
37545>>            Set Shadow_state item 1  to False
37546>>            Set Shadow_state item 2  to False
37547>>            Set Shadow_state item 3  to False
37548>>            Set Shadow_state item 5  to (Prmpt=0)
37549>>            Set Shadow_state item 6  to (Zm=0)
37550>>        End
37550>>>
37550>>        Else Begin
37551>>            for itm from 0 to 6
37557>>>
37557>>                set shadow_State item itm to TRUE
37558>>            Loop
37559>>>
37559>>        End
37559>>>
37559>>    End_Procedure
37560>>
37560>>End_Pull_Down
37562>>Set Status_Help to "Navigation in different areas of the screen"
37563>>
INCLUDING FILE: WIN_PM.INC
37563>>DFCreate_Menu "&Window" Window_Menu
37567>>    Set select_mode to Multi_Select
37568>>    // normal number of items in pulldown (w/ no active views)
37568>>    property integer std_item_count public 0
37570>>
37570>>    DFCreate_Menu "&Preferences" Display_Options_Menu
37574>>        Set select_mode to Multi_Select
37575>>        On_Item "&ToolBar"        Send Toggle_Toolbar             To Self
37576>>        On_Item "&StatusBar"      Send Toggle_Statusbar           To Self
37577>>        On_Item "&Arrange Icons"  Send Toggle_Auto_Arrange_Icons  To Self
37578>>
37578>>        //  When ever the menu [pulldown] is initialized, check/set
37578>>        //  the state of its items.
37578>>        //
37578>>        Procedure OnInitMenu
37580>>            local integer bState
37581>>
37581>>            Get ToolBar_State to bState
37582>>            Set Select_State Item 0 to bState
37583>>            if  bState   Set Status_Help Item 0 To '' //'Hide the ToolBar'
37586>>            Else         Set Status_Help Item 0 to '' //'Show the ToolBar'
37588>>
37588>>            Get Statusbar_State to bState
37589>>            Set Select_State Item 1 to bState
37590>>            if  bState  Set Status_Help Item 1 To ''// 'Hide the StatusBar'
37593>>            Else        Set Status_Help Item 1 to ''// 'Show the StatusBar'
37595>>
37595>>            Get Auto_Arrange_Icons_State to bState
37596>>            Set Select_State Item 2 to bState
37597>>            if  bState  Set Status_Help Item 2 To '' //'Hide AutoArrange Icons'
37600>>            Else        Set Status_Help Item 2 to '' //'Show AutoArrange Icons'
37602>>
37602>>        End_procedure
37603>>
37603>>
37603>>    End_Pull_Down
37605>>    Set Status_Help                                           To '' //"Enable Toolbar, StatusBar, and AutoArrange Icons options"
37606>>
37606>>    On_Item ""
37607>>
37607>>    On_Item "&Cascade" send Cascade_Windows                   To Self
37608>>        Set Status_Help                                       To ''
37609>>
37609>>    On_Item "Tile &Horizontally" send Tile_Windows_Horizontal To Self
37610>>        Set Status_Help                                       To ''
37611>>
37611>>    On_Item "Tile &Vertically" send Tile_Windows_Vertical     To Self
37612>>        Set Status_Help                                       To ''
37613>>
37613>>    On_Item ""
37614>>
37614>>    On_Item "Minimize all" send Minimize_all_Windows          To Current_Object
37615>>        Set Status_Help                                       To ''
37616>>
37616>>    On_Item "&Restore all" send Restore_all_Windows           To Current_Object
37617>>        Set Status_Help                                       To ''
37618>>
37618>>    On_Item ""
37619>>
37619>>    On_Item "&Arrange Icons" send Arrange_Icons               To Current_Object
37620>>        Set Status_Help                                       To ''
37621>>
37621>>    // set this to the number of items in the menu with no views.
37621>>    Set Std_item_count to (item_count(current_object))
37622>>
37622>>    // add all active views to the end of the menu
37622>>    Procedure OnInitMenu
37624>>        local integer iStdCnt iNumCnt hVw hCl iCount
37625>>        Local string sLbl
37625>>        //*** Remove all old view items
37625>>        Get Item_count     to iNumCnt
37626>>        get Std_item_count to iStdCnt
37627>>        For iCount from 1  to (iNumCnt - iStdCnt)
37633>>>
37633>>            Send Delete_item iStdCnt
37634>>        Loop
37635>>>
37635>>
37635>>        Move iStdcnt to iNumCnt
37636>>        get Client_id to hCl // object id of client area
37637>>        If hCl Begin
37639>>           Get Next_Mdi_Dialog of hcl TRUE to hVw // find first view
37640>>           While hVw
37644>>              if (Active_state(hVw)) Begin
37646>>                 if iNumCnt eq iStdCnt Begin // if first view, add separator
37648>>                    send add_item 0 ''
37649>>                    increment iNumCnt
37650>>                 end
37650>>>
37650>>                 Get Label of hVw to sLbl // caption bar (name) of view
37651>>                 // note that all views understand the message activate_view.
37651>>                 send add_item msg_activate_view sLbl // set message, value and destination
37652>>                 set aux_value item iNumcnt to hVw
37653>>                 // if this is the focus view, mark it.
37653>>                 If (current_scope(desktop)=hVw and View_mode(hVw)<>VIEWMODE_ICONIZE) ;                     set select_state item iNumCnt to True
37656>>                 // create status help
37656>>                 Set Status_help item iNumCnt to ("Make this view (" - trim(sLbl) - ") the active window.")
37657>>                 increment iNumCnt
37658>>              end
37658>>>
37658>>              Get Next_Mdi_Dialog of hcl FALSE to hVw // find next
37659>>           End
37660>>>
37660>>        End
37660>>>
37660>>    End_Procedure // OnInitMenu
37661>>
37661>>End_Pull_Down
37663>>Set Status_Help to ''
INCLUDING FILE: HELPA_PM.INC
37664>>
37664>>
37664>>DFCreate_Menu "&Help" Help_Menu
37668>>    on_item "&Help Topic" send Help_on_topic
37669>>        Set Status_Help To "Search for help on a particular subject."
37670>>        on_item "" send NONE
37671>>    on_item "&Context Help"          send Extended_Help
37672>>        Set Status_Help To "Show Context sensitive help."
37673>>
37673>>    on_item "&Files Help"            send File_Help
37674>>        Set Status_Help To "Show Files help."
37675>>
37675>>    on_item "&Keys Help"             send Keys_Help
37676>>        Set Status_Help To "Show Keys help."
37677>>
37677>>    on_item "" send NONE
37678>>
37678>>    on_item "&How to Use Help"       send Help_For_Help
37679>>        Set Status_Help To "How to Use Help"
37680>>
37680>>    on_item "" send NONE
37681>>
37681>>    On_Item "&Tips of the Day" send Activate_TipOfDay
37682>>        Set Status_Help To "Tips of the Day"
37683>>
37683>>    on_item "" send NONE
37684>>
37684>>    On_item "About" Send Activate_About
37685>>        Set Status_Help To "System Information"
37686>>end_pull_down
37688>>Set Status_Help to "Access to the program's help subsystem"
37689>>
37689>>Register_Procedure Activate_TipOfDay
37689>>
37689>>
37689>    End_Menu
37691>
37691>    Use Ewbtnbar.pkg //  Tool-Bar object.
INCLUDING FILE: EWBTNBAR.PKG
37691>>>// 23/07/1998 SPY
37691>>>
37691>>>Use DFMainBt  // dfMain_ButtonBar
INCLUDING FILE: DFMAINBT.PKG
37691>>>>>//-------------------------------------------------------------------------
37691>>>>>// DFMainBt.pkg - DfMain_ButtonBar class
37691>>>>>//
37691>>>>>//
37691>>>>>// 07/23/96 JJT - New Class names
37691>>>>>//-------------------------------------------------------------------------
37691>>>>>
37691>>>>>Use DfPanel // dfapp_buttonbar
37691>>>>>
37691>>>>>Class ToolBar is a AppToolBar
37692>>>>>
37692>>>>>    Function Is_Function Integer MsgId Integer ObjId Integer DelegateFg Returns Integer
37693>>>>>      Local integer rval MainObj#
37694>>>>>      Get Main_Panel_id to MainObj#
37695>>>>>      If (ObjId>Desktop AND MainObj#) ;         Get Is_Function of MainObj# MsgId ObjId DelegateFg to rVal
37698>>>>>      Function_Return rVal
37699>>>>>    End_Function
37700>>>>>
37700>>>>>    Procedure Redirect_Button_Message integer Itm
37701>>>>>         Local integer Msg# Aux# rval Understood
37702>>>>>         If (Shadow_State(Current_Object,itm)) Procedure_Return
37705>>>>>         Get Message   item itm  to Msg#
37706>>>>>         Get Aux_Value item itm  to Aux#
37707>>>>>         If Msg# Begin
37709>>>>>           If Aux# eq 0 Begin
37711>>>>>              Get Focus to Aux#
37712>>>>>              Get Is_Function Get_DEO_Object Aux# TRUE to Understood
37713>>>>>              If Not Understood Move 0 to Aux#
37716>>>>>           End
37716>>>>>>
37716>>>>>           If Aux# Get Msg# of Aux# to rval
37719>>>>>           Procedure_return rval
37720>>>>>         end
37720>>>>>>
37720>>>>>    End_Procedure // Redirect_Message
37721>>>>>
37721>>>>>End_Class
37722>>>>>
37722>>>>>
37722>>>Use Dates.utl
37722>>>
37722>>>Register_Object CalendarEz
37722>>>Register_Procedure Activate_Sort_Vw
37722>>>Register_Procedure DoPrintScreen
37722>>>
37722>>>Procedure doPopupCalendar
37724>>>    Send request_popup to (Popup_calendar(Self))
37725>>>End_Procedure
37726>>>
37726>>>Procedure doRebuild
37728>>>    Send Activate_Sort_Vw To (Client_Area(Main(Self)))
37729>>>End_Procedure
37730>>>
37730>>>Procedure doExit_Application
37732>>>    send Exit_Application to desktop
37733>>>End_Procedure
37734>>>
37734>>>Procedure DoRefresh_Grids
37736>>>    Integer liObj
37737>>>    
37737>>>    Move (Focus(Desktop)) to liObj
37738>>>    If (Base_class(liObj) = list_class) Send beginning_of_data to liObj
37741>>>End_Procedure
37742>>>
37742>>>Procedure DoPopupCalc
37744>>>    Runprogram background "Calc.exe"
37745>>>End_Procedure
37746>>>
37746>>>Procedure DoPopupSetup
37748>>>    string sRunPath
37749>>>    get_profile_string "workspaces\ad" "dfparamspath" to sRunPath
37752>>>    append sRunPath "\dfparams"
37753>>>    send DoRunApplication sRunPath
37754>>>End_Procedure
37755>>>
37755>>>Object oMyWinPrint is an DF_PRINTER
37757>>>    Procedure DFPrint
37759>>>        Integer iRetVal
37760>>>        Get DFGetPrintDialogFlags To iRetVal
37761>>>        If iRetVal Begin
37763>>>            Send DFPrintDoc
37764>>>            Send DFClearDoc
37765>>>        End
37765>>>>
37765>>>    End_Procedure
37766>>>    Move Current_Object to WinPrintId
37767>>>End_Object
37768>>>
37768>>>
37768>>>Procedure DoPrint
37770>>>    Send DfPrint to (oMyWinPrint(Self))
37771>>>End_Procedure
37772>>>
37772>>>Procedure DoShowPropertiesPage
37774>>>   If (Close_All_Views(Self,True)=0) Send Activate_View to (piPropertiesObjectId(self))
37777>>>End_Procedure
37778>>>
37778>>>   //  Button bar object.
37778>>>//
37778>>>Object Tool_Bar is a ToolBar     
37780>>>    
37780>>>    Property Integer piOutputDestination Public 0
37782>>>
37782>>>    Send ImageList_Add 'bgn.bmp'      // 0
37783>>>    Send ImageList_Add 'end.bmp'      // 1
37784>>>    Send ImageList_Add 'next.bmp'     // 2
37785>>>    Send ImageList_Add 'prev.bmp'     // 3
37786>>>    Send ImageList_Add 'clr.bmp'      // 4
37787>>>    Send ImageList_Add 'clra.bmp'     // 5
37788>>>    Send ImageList_Add 'calend.bmp'   // 6
37789>>>    Send ImageList_Add 'Abfile.bmp'   // 7
37790>>>    Send ImageList_Add 'Dbexplor.bmp' // 8
37791>>>    Send ImageList_Add 'Ddb_find.bmp' // 9
37792>>>    Send ImageList_Add 'Abup.bmp'     // 10
37793>>>    Send ImageList_Add 'Arrow2.bmp'   // 11
37794>>>    Send ImageList_Add 'Save1.bmp'    // 12
37795>>>    Send ImageList_Add 'Exitm.bmp'    // 13
37796>>>    Send ImageList_Add 'include.bmp'  // 14
37797>>>    Send ImageList_Add 'Zoom_m1.bmp'  // 15
37798>>>    Send ImageList_Add 'Zoom2mg.bmp'  // 16
37799>>>    Send ImageList_Add 'DbeRefrh.Bmp' // 17
37800>>>    Send ImageList_Add 'calc1.bmp'    // 18
37801>>>    Send ImageList_Add 'print_m0.bmp' // 19
37802>>>    Send ImageList_Add 'Abcodeed.bmp' // 20
37803>>>    Send ImageList_Add 'vuur.bmp'     // 21
37804>>>    //Send ImageList_Add 'wmsui329.bmp' // 22
37804>>>
37804>>>    send Add_button (ico_user+0) msg_beginning_of_data
37805>>>    Send Add_ToolTip "€¨®ã €¨®œå¦¬ (Ctrl+Home)"
37806>>>    Set  Status_Help To '¨å©¡œ  «ž¤ ¨é«ž „šš¨˜­ã (Ctrl+Home)'
37807>>>
37807>>>    send Add_button (ico_user+3) msg_find_previous
37808>>>    Send Add_ToolTip "¨¦žš¦ç£œ¤ž „šš¨˜­ã (F7)"
37809>>>    Set  Status_Help To '¨å©¡œ  «ž¤ ¨¦žš¦ç£œ¤ž „šš¨˜­ã (F7)'
37810>>>
37810>>>    send Add_button (ico_user+10) msg_find_GE
37811>>>    Send Add_ToolTip "€¤˜ã«ž©ž (F9)"
37812>>>    Set  Status_Help To '¨å©¡œ  «ž¤ „šš¨˜­ã á©œ  «à¤ ‘«¦ ®œåà¤ (F9)'
37813>>>
37813>>>    send Add_button (ico_user+2) msg_find_next
37814>>>    Send Add_ToolTip "„§æ£œ¤ž „šš¨˜­ã (F8)"
37815>>>    Set  Status_Help To '¨å©¡œ  «ž¤ „§æ£œ¤ž „šš¨˜­ã (F8)'
37816>>>
37816>>>    send Add_button (ico_user+1) msg_end_of_data
37817>>>    Send Add_ToolTip "’â¢¦ª €¨®œå¦¬ (Ctrl+End)"
37818>>>    Set  Status_Help To '¨å©¡œ  «ž¤ ’œ¢œ¬«˜å˜ „šš¨˜­ã (Ctrl+End)'
37819>>>
37819>>>    send Add_space
37820>>>
37820>>>    send Add_button ico_std_find msg_prompt
37821>>>    Send Add_ToolTip "Šå©«˜ (F4)"
37822>>>    Set  Status_Help To '‹§¦¨œåª ¤˜ ›œåª æ¢œª « ª › ˜Ÿâ© £œª œ§ ¢¦šâª (F4)'
37823>>>
37823>>>    send Add_button (ico_User+15) msg_zoom
37824>>>    Send Add_ToolTip "Z¦¦£ (Alt+F9)"
37825>>>    Set  Status_Help To '‹§¦¨œåª ¤˜ ›œåª §¨æ©Ÿœ«œª §¢ž¨¦­¦¨åœª (Alt+F9)'
37826>>>
37826>>>    send Add_button (ico_user+6) msg_doPopupCalendar
37827>>>    Send Add_ToolTip "†£œ¨¦¢æš ¦"
37828>>>    Set  Status_Help To "†£œ¨¦¢æš ¦ ƒ ˜Ÿâ© £¦ £æ¤¦ ©œ §œ›å˜-†£œ¨¦£ž¤åœª"
37829>>>
37829>>>    send Add_space
37830>>>
37830>>>    send Add_button (ico_user+4) msg_request_clear
37831>>>    Send Add_ToolTip "€¡ç¨à©ž (F5)"
37832>>>    Set  Status_Help To '€¡ç¨à©ž «¨â®¦¬©˜ª œšš¨˜­ãª / ¨æ©Ÿœ©ž ¤â˜ª œšš¨˜­ãª (F5)'
37833>>>
37833>>>    send Add_button (ico_user+5) msg_request_clear_all
37834>>>    Send Add_ToolTip "Ž¢ ¡ã €¡ç¨à©ž (Ctrl+F5)"
37835>>>    Set  Status_Help To 'Ž¢ ¡ã ˜¡ç¨à©ž «à¤ ›œ›¦£â¤à¤ ©«ž¤ æ¯ž §¦¬ › ˜®œ ¨åœ«˜  ¦ ®¨ã©«žª (Ctrl+F5)'
37836>>>
37836>>>    send Add_button (ico_user+17) msg_DoRefresh_Grids
37837>>>    Send Add_ToolTip "€¤˜¤âà©ž ƒœ›¦£â¤à¤ (Ctrl+Home)"
37838>>>    Set  Status_Help To '€¤˜¤œé¤œ  «˜ ›œ›¦£â¤˜ ©«˜ Grids (Ctrl+Home)'
37839>>>
37839>>>    send Add_space
37840>>>
37840>>>    send Add_button ico_std_filesave msg_request_save
37841>>>    Send Add_ToolTip "„šš¨˜­ã+€¡ç¨à©ž (F2)"
37842>>>    Set  Status_Help To '‘éœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã ©«¦ ˜¨®œå¦ (F2)'
37843>>>
37843>>>    send Add_button ico_std_delete msg_request_delete
37844>>>    Send Add_ToolTip "ƒ ˜š¨˜­ã (Shift+F2)"
37845>>>    Set  Status_Help To 'ƒ ˜š¨á­œ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã ˜§æ «¦ ˜¨®œå¦ (Shift+F2)'
37846>>>
37846>>>    send Add_button (ico_user+12) msg_request_save_no_clear
37847>>>    Send Add_ToolTip "„šš¨˜­ã (F12)"
37848>>>    Set  Status_Help To '‘éœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã ©«¦ ˜¨®œå¦ ®à¨åª ¤˜ ¡˜Ÿ˜¨åœ  «˜ ›œ›¦£â¤˜ (F12)'
37849>>>
37849>>>    send Add_space
37850>>>
37850>>>    send Add_button ico_std_cut msg_cut
37851>>>    Send Add_ToolTip "€§¦¡¦§ã"
37852>>>    Set  Status_Help To "€§¦¡æ§«œ  «¦ œ§ ¢œš£â¤¦ ¡¦££á«  ¡˜  «¦ ¡¨˜«áœ  ©«¦ Clipboard"
37853>>>
37853>>>    send Add_button ico_std_copy msg_copy
37854>>>    Send Add_ToolTip "€¤« š¨˜­ã"
37855>>>    Set  Status_Help To "€¤« š¨á­œ  «¦ œ§ ¢œš£â¤¦ ¡¦££á«  ¡˜  «¦ ¡¨˜«áœ  ©«¦ Clipboard"
37856>>>
37856>>>    send Add_button ico_std_paste msg_paste
37857>>>    Send Add_ToolTip "„ ©˜šàšã"
37858>>>    Set  Status_Help To "„ ©ášœ  §œ¨ œ®æ£œ¤˜ ˜§æ «¦ Clipboard"
37859>>>
37859>>>    //send Add_button (ico_user+19) msg_DoPrint
37859>>>    send Add_button ICO_STD_PRINT msg_DoPrint
37860>>>    Send Add_ToolTip "„¡«ç§à©ž"
37861>>>    Set  Status_Help To "„¡«¬§é©œ ª ‰œ £â¤à¤"
37862>>>
37862>>>    send Add_space              
37863>>>
37863>>>    //send Add_button (ico_user+20) msg_DoPrintScreen
37863>>>    send Add_button ICO_STD_PRINTPRE msg_DoPrintScreen
37864>>>    Send Add_ToolTip "„¡«ç§à©ž ¦Ÿæ¤žª"
37865>>>    Set  Status_Help To "„¡«ç§à©ž ¦Ÿæ¤žª ©«¦ Clipboard ã ©«¦¤ „¡«à§à«ã"
37866>>>    
37866>>>    Object oOutputSelector Is A ComboFormSub
37868>>>       Set Entry_State Item 0 to FALSE
37869>>>       Set Combo_Sort_State to FALSE
37870>>>       Set GuiLocation to 1 480
37871>>>       Set Size to 14 55
37872>>>       Set Status_Help to "„§â¢œ¥œ §¦¬ Ÿ˜ šå¤œ  ž œ¡«ç§à©ž «žª ¦Ÿæ¤žª"
37873>>>       Set Focus_Mode to Pointer_Only
37874>>>       Set Skip_State to True
37875>>>       
37875>>>       Procedure Combo_Fill_List
37877>>>       
37877>>>           Send Combo_Add_Item '„¡«¬§à«ãª'
37878>>>           Send Combo_Add_Item 'Clipboard'
37879>>>       
37879>>>       End_Procedure
37880>>>       
37880>>>       Procedure OnChange
37882>>>           String liValue
37883>>>           
37883>>>           Get Value Item 0 to liValue 
37884>>>           If (Combo_Value(Self,0) = liValue) Set piOutputDestination to 0
37887>>>           Else If (Combo_Value(Self,1) = liValue) Set piOutputDestination to 1
37891>>>       End_Procedure
37892>>>       
37892>>>    End_Object   // oReportSelector
37893>>>    
37893>>>    For WindowIndex from 1 to 12
37899>>>>
37899>>>        send Add_space              
37900>>>    Loop
37901>>>>
37901>>>
37901>>>    send Add_button (ico_user+7) msg_DoRebuild
37902>>>    Send Add_ToolTip "„§ › æ¨Ÿà©ž á©žª ƒœ›¦£â¤à¤"
37903>>>    Set  Status_Help To "€¤˜¡˜«˜©¡œ¬ã «à¤ ˆndexes (Reindex) ¡˜  ¡˜Ÿ˜¨ ©£æª «¦¬ª (CleanUp) ˜¤ ®¨œ áœ«˜ "
37904>>>
37904>>>    send Add_button (ico_user+18) msg_DoPopupCalc
37905>>>    Send Add_ToolTip "€¨ Ÿ£¦£ž®˜¤ã"
37906>>>    Set  Status_Help To ""
37907>>>
37907>>>    send Add_button (ico_user+21) msg_DoPopupSetup
37908>>>    Send Add_ToolTip "Setup Client"
37909>>>    Set  Status_Help To "Machine Settings Network Parameter"
37910>>>
37910>>>    send Add_space
37911>>>
37911>>>    send Add_button ico_std_properties msg_DoShowPropertiesPage
37912>>>    Send Add_ToolTip "ˆ› æ«ž«œª"
37913>>>    Set  Status_Help To "ˆ› æ«ž«œª ¡˜  ®˜¨˜¡«ž¨ ©« ¡á «žª œ­˜¨£¦šãª"
37914>>>
37914>>>    send Add_button ico_std_help msg_Help_On_Topic
37915>>>    Send Add_ToolTip "¦ãŸœ ˜ (F1)"
37916>>>    Set  Status_Help To "‰¢ã©ž ©¬©«ã£˜«¦ª ™¦žŸœå˜ª (F1)"
37917>>>
37917>>>    send Add_space
37918>>>
37918>>>    send Add_button (ico_user+13) msg_Exit_Application
37919>>>    Send Add_ToolTip "„¥¦›¦ª (Alt+F4)"
37920>>>    Set  Status_Help To "„¥¦›¦ ˜§æ „­˜¨£¦šã (Alt+F4)"
37921>>>
37921>>>    Procedure DoPrintScreen
37923>>>        Integer iVoid aiWhereTo
37924>>>        
37924>>>        Get piOutputDestination to aiWhereTo
37925>>>        If (aiWhereTo = 0) Send Print_Screen to Desktop ""
37928>>>        Else If (aiWhereTo = 1) Move (Keybd_Event(VK_SNAPSHOT, 0, 0, 0)) To iVoid
37932>>>    End_Procedure
37933>>>
37933>>>
37933>>>    Procedure Redirect_Button_Message integer Itm
37935>>>        Integer msg# liObj liCls
37936>>>        
37936>>>        Get Message   item itm  to Msg#
37937>>>        If (Msg_DoRebuild = Msg#)  Send DoRebuild
37940>>>        Else If (msg_Help_On_Topic = Msg#) Send Help_On_Topic
37944>>>        Else If (msg_Exit_Application = Msg#) Send Exit_Application
37948>>>        Else If (msg_DoPopupCalc = Msg#) Send DoPopupCalc
37952>>>        Else If (msg_DoPrintScreen = Msg#) Send DoPrintScreen
37956>>>        Else If (msg_DoShowPropertiesPage = Msg#) Send DoShowPropertiesPage
37960>>>        Else If (msg_DoPopupSetup = Msg#) Send DoPopupSetup
37964>>>        Else Forward Send Redirect_Button_Message Itm
37967>>>    End_Procedure // Redirect_Message
37968>>>
37968>>>    Procedure DoChangeToolBarIcon Integer iItem Integer iImageIndex
37970>>>        Integer hoClient
37971>>>        
37971>>>        Delegate Get Client_Id To hoClient
37973>>>        Delegate Set Client_Id To 0
37975>>>        //----Changes the Icon
37975>>>        //Set Toolbar_State To False
37975>>>        //Set Form_Image_Index Item iItem To iImageIndex
37975>>>        //Set Toolbar_State To True
37975>>>        //----Changes the Shadow_State
37975>>>        Set Shadow_State Item iItem To iImageIndex
37976>>>        Delegate Set Client_Id To hoClient
37978>>>    End_Procedure // DoChangeToolBarIcon
37979>>>
37979>>>    Procedure Page_Object Integer iState
37981>>>      Integer hoCurrentObject
37982>>>      
37982>>>      Forward Send Page_Object iState
37984>>>      Move (Self) to hoCurrentObject
37985>>>      Send Add_Focus To (oOutputSelector(SELF)) hoCurrentObject
37986>>>    End_Procedure   // Page_Object
37987>>>
37987>>>    
37987>>>    Procedure Page Integer iState
37989>>>        Forward Send Page iState
37991>>>        Set Shadow_State Item 40 to (piPropertiesObjectId(Main_Menu(Self))=0)
37992>>>        If iState Begin
37994>>>             //Set Timer_Active_State Of (oToolBarTimer (Self)) To True
37994>>>        End
37994>>>>
37994>>>    End_Procedure
37995>>>    
37995>>>//    Object oToolBarTimer Is A DfTimer
37995>>>//        Procedure OnTimer
37995>>>//           Local Integer hoFocus bIsDeo bState hoToolBar bIsModal
37995>>>//           
37995>>>//           Get Focus To hoFocus
37995>>>//           If hoFocus Gt Desktop Begin
37995>>>//                Get Is_Function Get_Modal_State hoFocus Dftrue To bIsModal
37995>>>//                // **WvA: 11-10-1999, we should not check the DEO object any more if 
37995>>>//                //                    if it is a modal panel, this could throw up error messages.
37995>>>//                If (bIsModal = DfFalse) Begin
37995>>>//                  Get Is_Function Get_DEO_Object hoFocus Dftrue To bIsDeo
37995>>>//                End
37995>>>//                Move (bIsDeo = Dffalse Or bIsModal = Dftrue) To bState
37995>>>//                Move (Parent (Self)) To hoToolBar
37995>>>//                If (pbToolbarWasDisabled (hoToolBar)) Ne bState Begin
37995>>>//                   Set pbToolbarWasDisabled Of hoToolBar To bState
37995>>>//                   Set Shadow_State Of hoToolBar Item 0 To bState
37995>>>//                   Set Shadow_State Of hoToolBar Item 1 To bState
37995>>>//                   Set Shadow_State Of hoToolBar Item 2 To bState
37995>>>//                   Set Shadow_State Of hoToolBar Item 3 To bState
37995>>>//                   Set Shadow_State Of hoToolBar Item 5 To bState
37995>>>//                   Set Shadow_State Of hoToolBar Item 6 To bState
37995>>>//                   Set Shadow_State Of hoToolBar Item 7 To bState
37995>>>//                   Set Shadow_State Of hoToolBar Item 9 To bState
37995>>>//                   Set Shadow_State Of hoToolBar Item 10 To bState
37995>>>//                End
37995>>>//           End
37995>>>//       End_Procedure // OnTimer
37995>>>//   End_Object // oToolBarTimer
37995>>>   
37995>>>End_Object
37996>>>
37996>>>
37996>    
37996>    Object Client_Area is a AppClientAreasub
37998>
37998>        //AB-ClientStoreTopStart
37998>        
37998>        
37998>        Use Roundfn.Fnc
37998>        Function fngConvertPoso Global String asNomismaCodeApo Number anPoso ;                                       String asNomismaCodeSe  Date   adHmnia;                                       Number nIsotimia  Returns Number
37999>        
37999>            Number rVal nApo_Euro_Isot nSe_Euro_Isot
38000>            Integer iApo_Einai_Euro_Zone iApo_Einai_DRX iApo_Einai_Euro iDekadika_Apo
38000>            Integer iSe_Einai_Euro_Zone  iSe_Einai_DRX  iSe_Einai_Euro  iDekadika_Se
38000>            String  sCode
38000>        
38000>            If (asNomismaCodeApo=asNomismaCodeSe) Function_Return anPoso
38003>        
38003>            Clear Nomisma
38004>            Move (Trim(asNomismaCodeApo)) to Nomisma.Nomisma_Code
38005>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
38006>            Move Nomisma.Euro_Zone      to iApo_Einai_Euro_Zone
38007>            Move Nomisma.Einai_DRX      to iApo_Einai_DRX
38008>            Move Nomisma.Einai_EURO     to iApo_Einai_Euro
38009>            Move Nomisma.KL_ISOT_EURO   to nApo_Euro_Isot
38010>            Move Nomisma.Dekadika       to iDekadika_Apo
38011>            // 1. An to nomisma APO den einai ths zonhs euro prepei na vrethei h isotimia tou
38011>            If ((NOT(iApo_Einai_Euro_Zone)) And (nApo_Euro_Isot=0))  Begin
38013>                If (adHmnia='') Sysdate            adHmnia
38016>                Move (Trim(asNomismaCodeApo))   to sCode
38017>                Clear Isotimia
INCLUDING FILE: ISOTIMIA.FD
38018>                Move sCode                      to Isotimia.Nomisma_Code
38019>                Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
38020>                Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
38021>                Move Isotimia.Isotimia_Euro     to nApo_Euro_Isot
38022>            End
38022>        
38022>            Clear Nomisma
38023>            Move (Trim(asNomismaCodeSe)) to Nomisma.Nomisma_Code
38024>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
38025>            Move Nomisma.Euro_Zone      to iSe_Einai_Euro_Zone
38026>            Move Nomisma.Einai_DRX      to iSe_Einai_DRX
38027>            Move Nomisma.Einai_EURO     to iSe_Einai_Euro
38028>            Move Nomisma.KL_ISOT_EURO   to nSe_Euro_Isot
38029>            Move Nomisma.Dekadika       to iDekadika_Se
38030>            // 2. An to nomisma SE den einai ths zonhs euro prepei na vrethei h isotimia tou
38030>            If ((NOT(iSe_Einai_Euro_Zone)) And (nSe_Euro_Isot=0)) Begin
38032>                If (adHmnia='') Sysdate            adHmnia
38035>                Move (Trim(asNomismaCodeSe))    to sCode
38036>                Clear Isotimia
38037>                Move sCode                      to Isotimia.Nomisma_Code
38038>                Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
38039>                Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
38040>                Move Isotimia.Isotimia_Euro     to nSe_Euro_Isot
38041>            End
38041>        
38041>            Calc (anPoso/nApo_Euro_Isot) to rVal
38042>            Move (Round_Number(rVal,6)) to rVal
38043>            Calc (rVal*nSe_Euro_Isot) to rVal
38044>            Move (Round_Number(rVal,iDekadika_Se)) to rVal
38045>        
38045>            Function_Return rVal
38046>        End_Function
38047>        
38047>        
38047>        //AB-ClientStoreTopEnd
38047>
38047>        //  Include all views
38047>
38047>        //  Include all reports
38047>        Use rMetafNoErg.RV                                                                  
INCLUDING FILE: RMETAFNOERG.RV
38047>>>//AB/ Project rMetafNoErg
38047>>>//AB/     Object prj is a Report_Project
38047>>>//AB/         Set ProjectName to "rMetafNoErg"
38047>>>//AB/         Set ProjectFileName to "rMetafNoErg.RV"
38047>>>
38047>>>// Project Object Structure
38047>>>//   rMetafNoErg is a ReportViewSub
38047>>>//     cSyDateForm1 is a cSyDateForm
38047>>>//     ButtonSub3 is a ButtonSub
38047>>>//     TextBoxSub1 is a TextBoxSub
38047>>>//     TextBoxSub2 is a TextBoxSub
38047>>>//     f_payresp is a CheckBoxSub
38047>>>//     TextBoxSub3 is a TextBoxSub
38047>>>//     chkAkyr is a CheckBoxSub
38047>>>//     TextBoxSub4 is a TextBoxSub
38047>>>//     FormSub2 is a FormSub
38047>>>//     btnMess is a ButtonSub
38047>>>//     Areas_DD is a Areas_DataDictionary
38047>>>//     Payresp_DD is a Payresp_DataDictionary
38047>>>//     syscurxr_DD is a syscurxr_DataDictionary
38047>>>//     Country_DD is a Country_DataDictionary
38047>>>//     Towns_DD is a Towns_DataDictionary
38047>>>//     Ctypkin_DD is a Ctypkin_DataDictionary
38047>>>//     Cities_DD is a Cities_DataDictionary
38047>>>//     Clients_DD is a Clients_DataDictionary
38047>>>//     Cmoves_DD is a Cmoves_DataDictionary
38047>>>//     metafyp_BasicReport is a BasicReport
38047>>>//       Areas_DD is a Areas_DataDictionary
38047>>>//       Payresp_DD is a Payresp_DataDictionary
38047>>>//       syscurxr_DD is a syscurxr_DataDictionary
38047>>>//       Country_DD is a Country_DataDictionary
38047>>>//       Towns_DD is a Towns_DataDictionary
38047>>>//       Ctypkin_DD is a Ctypkin_DataDictionary
38047>>>//       Cities_DD is a Cities_DataDictionary
38047>>>//       Clients_DD is a Clients_DataDictionary
38047>>>//       Cmoves_DD is a Cmoves_DataDictionary
38047>>>//       Cmovesa_DD is a Cmovesa_DataDictionary
38047>>>
38047>>>// Register all objects
38047>>>Register_Object Areas_DD
38047>>>Register_Object ButtonSub3
38047>>>Register_Object btnMess
38047>>>Register_Object Cities_DD
38047>>>Register_Object Clients_DD
38047>>>Register_Object Cmoves_DD
38047>>>Register_Object Cmovesa_DD
38047>>>Register_Object Country_DD
38047>>>Register_Object Ctypkin_DD
38047>>>Register_Object chkAkyr
38047>>>Register_Object cSyDateForm1
38047>>>Register_Object FormSub2
38047>>>Register_Object f_payresp
38047>>>Register_Object metafyp_BasicReport
38047>>>Register_Object Payresp_DD
38047>>>Register_Object rMetafNoErg
38047>>>Register_Object syscurxr_DD
38047>>>Register_Object TextBoxSub1
38047>>>Register_Object TextBoxSub2
38047>>>Register_Object TextBoxSub3
38047>>>Register_Object TextBoxSub4
38047>>>Register_Object Towns_DD
38047>>>
38047>>>
38047>>>//AB/     Report View
38047>>>
38047>>>
38047>>>    //AB-StoreTopStart
38047>>>    Use dfallrpt.pkg
38047>>>    use areas.dd
INCLUDING FILE: AREAS.DD
38047>>>>>//DDB-FileStart
38047>>>>>//DDB-HeaderStart
38047>>>>>
38047>>>>>// File Name : AREAS.DD
38047>>>>>// Class Name: Areas_DataDictionary
38047>>>>>// Revision  : 8
38047>>>>>// Version   : 2
38047>>>>>
38047>>>>>Use  Windows           // Basic Definitions
38047>>>>>Use  DataDict          // DataDictionary Class Definition
38047>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38047>>>>>
38047>>>>>Open Areas
38049>>>>>Open Clients
38051>>>>>
38051>>>>>//DDB-HeaderEnd
38051>>>>>//DDB-SelectionStart
38051>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
38051>>>>>Register_Object sl197
38051>>>>>//DDB-SelectionEnd
38051>>>>>
38051>>>>>Class Areas_DataDictionary  is a DataDictionary_Sec
38052>>>>>
38052>>>>>    // Define_Fields:
38052>>>>>    // This procedure is used to set up all data-dictionary rules.
38052>>>>>
38052>>>>>    Procedure Define_Fields
38053>>>>>        Forward Send Define_Fields
38055>>>>>        //DDB-Generated-Code-Location
38055>>>>>        //DDB-DefineFieldStart
38055>>>>>
38055>>>>>        Set Main_File            To Areas.File_Number
38056>>>>>        Set Cascade_Delete_State To FALSE
38057>>>>>
38057>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38058>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38059>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38060>>>>>
38060>>>>>        // Child (Client) file structure................
38060>>>>>        Send Add_Client_File  Clients.File_Number
38061>>>>>
38061>>>>>        // Field-based properties.......................
38061>>>>>
38061>>>>>        // Areas.Area_Id
38061>>>>>        Set Field_Options          Field Areas.Area_Id To DD_AUTOFIND   
38062>>>>>        Set Field_Prompt_Object    Field Areas.Area_Id To (sl197(Self))
38063>>>>>
38063>>>>>        // Areas.Area_Descr
38063>>>>>        Set Field_Prompt_Object    Field Areas.Area_Descr To (sl197(Self))
38064>>>>>
38064>>>>>        // Areas.Area_Site
38064>>>>>
38064>>>>>        //DDB-DefineFieldEnd
38064>>>>>    End_Procedure    // Define_Fields
38065>>>>>
38065>>>>>    // Field_Defaults:
38065>>>>>    // This procedure is used to establish default field values.
38065>>>>>
38065>>>>>    Procedure Field_Defaults
38066>>>>>        Forward Send Field_Defaults
38068>>>>>        //DDB-Generated-Code-Location
38068>>>>>        //DDB-FieldDefaultStart
38068>>>>>        //DDB-FieldDefaultEnd
38068>>>>>    End_Procedure    // Field_Defaults
38069>>>>>
38069>>>>>End_Class    // Areas_DataDictionary
38070>>>>>//DDB-Selection-pkg-Start
38070>>>>>
38070>>>>>Use sl197.SL         // sl197
INCLUDING FILE: SL197.SL
38070>>>>>>>//AB/ Project sl197:areas
38070>>>>>>>//AB/     Object prj is a Lookup_Project
38070>>>>>>>//AB/         Set ProjectName to "sl197:areas"
38070>>>>>>>//AB/         Set ProjectFileName to "sl197.SL"
38070>>>>>>>//AB/         Set GenerateFileName to "NONAME"
38070>>>>>>>
38070>>>>>>>// Project Object Structure
38070>>>>>>>//   sl197 is a dbModalPanelSub
38070>>>>>>>//     Areas_DD is a DataDictionary
38070>>>>>>>//     oSelList is a dbListSub
38070>>>>>>>//     oOK_bn is a ButtonSub
38070>>>>>>>//     oCancel_bn is a ButtonSub
38070>>>>>>>//     oSearch_bn is a ButtonSub
38070>>>>>>>
38070>>>>>>>// Register all objects
38070>>>>>>>Register_Object Areas_DD
38070>>>>>>>Register_Object oCancel_bn
38070>>>>>>>Register_Object oOK_bn
38070>>>>>>>Register_Object oSearch_bn
38070>>>>>>>Register_Object oSelList
38070>>>>>>>Register_Object sl197
38070>>>>>>>
38070>>>>>>>
38070>>>>>>>    //AB-IgnoreStart
38070>>>>>>>
38070>>>>>>>    Use DFAllEnt.pkg
38070>>>>>>>    Use dbList.Sub
38070>>>>>>>    Use Button.Sub
38070>>>>>>>
38070>>>>>>>
38070>>>>>>>    Use AREAS.DD
38070>>>>>>>    
38070>>>>>>>    //AB-IgnoreEnd
38070>>>>>>>
38070>>>>>>>    Object sl197 is a dbModalPanelSub
38072>>>>>>>
38072>>>>>>>        //AB-StoreTopStart
38072>>>>>>>                    
38072>>>>>>>        //AB-StoreTopEnd
38072>>>>>>>
38072>>>>>>>        Set Label to "€¨®œå¦ œ¨ ¦®é¤"
38073>>>>>>>        Set Size to 148 297
38074>>>>>>>        Set Location to 4 5
38075>>>>>>>        Set Exit_Application_Local_State to FALSE
38076>>>>>>>        Set Modal_State to FALSE
38077>>>>>>>
38077>>>>>>>        //AB-DDOStart
38077>>>>>>>
38077>>>>>>>        Object Areas_DD is a Areas_DataDictionary
38079>>>>>>>
38079>>>>>>>            //AB-StoreStart
38079>>>>>>>                                    
38079>>>>>>>            //AB-StoreEnd
38079>>>>>>>
38079>>>>>>>        End_Object    // Areas_DD
38080>>>>>>>
38080>>>>>>>        Set Main_DD to (Areas_DD(self))
38081>>>>>>>        Set Server to (Areas_DD(self))
38082>>>>>>>
38082>>>>>>>        //AB-DDOEnd
38082>>>>>>>
38082>>>>>>>        Object oSelList is a dbListSub
38084>>>>>>>            Set Main_File to Areas.File_Number
38085>>>>>>>            Set Ordering to 2
38086>>>>>>>            Set Size to 105 280
38087>>>>>>>            Set Location to 5 5
38088>>>>>>>            Set Export_Item_State to TRUE
38089>>>>>>>
38089>>>>>>>            Begin_Row
38092>>>>>>>                Entry_Item Areas.Area_id
38093>>>>>>>                Entry_Item Areas.Area_descr
38094>>>>>>>                Entry_Item Areas.Area_site
38095>>>>>>>            End_Row
38100>>>>>>>
38100>>>>>>>            Set Form_Width    item 0 to 45
38101>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
38102>>>>>>>            
38102>>>>>>>            Set Form_Width    item 1 to 192
38103>>>>>>>            Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
38104>>>>>>>            
38104>>>>>>>            Set Form_Width    item 2 to 35
38105>>>>>>>            Set Header_Label  item 2 to "’¦£â˜ª"
38106>>>>>>>            
38106>>>>>>>
38106>>>>>>>            //AB-StoreStart
38106>>>>>>>            
38106>>>>>>>            Set Column_Option Item 0 to NoEnter True
38107>>>>>>>            
38107>>>>>>>            
38107>>>>>>>            //AB-StoreEnd
38107>>>>>>>
38107>>>>>>>        End_Object    // oSelList
38108>>>>>>>
38108>>>>>>>        Object oOK_bn is a ButtonSub
38110>>>>>>>            Set Label to "&„§ ¢¦šã"
38111>>>>>>>            Set Location to 115 126
38112>>>>>>>
38112>>>>>>>            //AB-StoreStart
38112>>>>>>>            Procedure OnClick
38114>>>>>>>                Send OK To (oSelList(current_object))
38115>>>>>>>            End_Procedure
38116>>>>>>>            //AB-StoreEnd
38116>>>>>>>
38116>>>>>>>        End_Object    // oOK_bn
38117>>>>>>>
38117>>>>>>>        Object oCancel_bn is a ButtonSub
38119>>>>>>>            Set Label to "&€¡ç¨à©ž"
38120>>>>>>>            Set Location to 115 181
38121>>>>>>>
38121>>>>>>>            //AB-StoreStart
38121>>>>>>>            Procedure OnClick
38123>>>>>>>                Send Cancel To (oSelList(current_object))
38124>>>>>>>            End_Procedure
38125>>>>>>>            //AB-StoreEnd
38125>>>>>>>
38125>>>>>>>        End_Object    // oCancel_bn
38126>>>>>>>
38126>>>>>>>        Object oSearch_bn is a ButtonSub
38128>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
38129>>>>>>>            Set Location to 115 236
38130>>>>>>>
38130>>>>>>>            //AB-StoreStart
38130>>>>>>>            Procedure OnClick
38132>>>>>>>                Send Search To (oSelList(current_object))
38133>>>>>>>            End_Procedure
38134>>>>>>>            //AB-StoreEnd
38134>>>>>>>
38134>>>>>>>        End_Object    // oSearch_bn
38135>>>>>>>
38135>>>>>>>
38135>>>>>>>        //AB-StoreStart
38135>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
38136>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
38137>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
38138>>>>>>>        
38138>>>>>>>        
38138>>>>>>>        
38138>>>>>>>        
38138>>>>>>>        
38138>>>>>>>        //AB-StoreEnd
38138>>>>>>>
38138>>>>>>>    End_Object    // sl197
38139>>>>>>>
38139>>>>>>>//AB/     End_Object    // prj
38139>>>>>
38139>>>>>//DDB-Selection-pkg-End
38139>>>>>//DDB-FileEnd
38139>>>    use country.dd
INCLUDING FILE: COUNTRY.DD
38139>>>>>//DDB-FileStart
38139>>>>>//DDB-HeaderStart
38139>>>>>
38139>>>>>// File Name : COUNTRY.DD
38139>>>>>// Class Name: Country_DataDictionary
38139>>>>>// Revision  : 3
38139>>>>>// Version   : 2
38139>>>>>
38139>>>>>Use  Windows           // Basic Definitions
38139>>>>>Use  DataDict          // DataDictionary Class Definition
38139>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38139>>>>>
38139>>>>>Open Country
38141>>>>>Open Towns
38143>>>>>
38143>>>>>//DDB-HeaderEnd
38143>>>>>//DDB-SelectionStart
38143>>>>>//DDB/ ExternalSelectionList sl058  sl058.SL
38143>>>>>Register_Object sl058
38143>>>>>//DDB-SelectionEnd
38143>>>>>
38143>>>>>Class Country_DataDictionary  is a DataDictionary_Sec
38144>>>>>
38144>>>>>    // Define_Fields:
38144>>>>>    // This procedure is used to set up all data-dictionary rules.
38144>>>>>
38144>>>>>    Procedure Define_Fields
38145>>>>>        Forward Send Define_Fields
38147>>>>>        //DDB-Generated-Code-Location
38147>>>>>        //DDB-DefineFieldStart
38147>>>>>
38147>>>>>        Set Main_File            To Country.File_Number
38148>>>>>        Set Cascade_Delete_State To FALSE
38149>>>>>
38149>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38150>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38151>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38152>>>>>
38152>>>>>        // Child (Client) file structure................
38152>>>>>        Send Add_Client_File  Towns.File_Number
38153>>>>>
38153>>>>>        // Field-based properties.......................
38153>>>>>
38153>>>>>        // Country.Country_Id
38153>>>>>        Set Field_Options          Field Country.Country_Id To DD_AUTOFIND   
38154>>>>>        Set Field_Prompt_Object    Field Country.Country_Id To (sl058(Self))
38155>>>>>
38155>>>>>        // Country.Country_Descr
38155>>>>>        Set Field_Prompt_Object    Field Country.Country_Descr To (sl058(Self))
38156>>>>>
38156>>>>>        //DDB-DefineFieldEnd
38156>>>>>    End_Procedure    // Define_Fields
38157>>>>>
38157>>>>>    // Field_Defaults:
38157>>>>>    // This procedure is used to establish default field values.
38157>>>>>
38157>>>>>    Procedure Field_Defaults
38158>>>>>        Forward Send Field_Defaults
38160>>>>>        //DDB-Generated-Code-Location
38160>>>>>        //DDB-FieldDefaultStart
38160>>>>>        //DDB-FieldDefaultEnd
38160>>>>>    End_Procedure    // Field_Defaults
38161>>>>>
38161>>>>>End_Class    // Country_DataDictionary
38162>>>>>//DDB-Selection-pkg-Start
38162>>>>>
38162>>>>>Use sl058.SL         // sl058
INCLUDING FILE: SL058.SL
38162>>>>>>>//AB/ Project sl058 : Countries - Xores
38162>>>>>>>//AB/     Object prj is a Lookup_Project
38162>>>>>>>//AB/         Set ProjectName to "sl058 : Countries - Xores"
38162>>>>>>>//AB/         Set ProjectFileName to "sl058.SL"
38162>>>>>>>//AB/         Set GenerateFileName to "NONAME"
38162>>>>>>>
38162>>>>>>>// Project Object Structure
38162>>>>>>>//   sl058 is a dbModalPanelSub
38162>>>>>>>//     Country_DD is a DataDictionary
38162>>>>>>>//     oSelList is a dbListSub
38162>>>>>>>//     oOK_bn is a ButtonSub
38162>>>>>>>//     oCancel_bn is a ButtonSub
38162>>>>>>>//     oSearch_bn is a ButtonSub
38162>>>>>>>
38162>>>>>>>// Register all objects
38162>>>>>>>Register_Object Country_DD
38162>>>>>>>Register_Object oCancel_bn
38162>>>>>>>Register_Object oOK_bn
38162>>>>>>>Register_Object oSearch_bn
38162>>>>>>>Register_Object oSelList
38162>>>>>>>Register_Object sl058
38162>>>>>>>
38162>>>>>>>
38162>>>>>>>    //AB-IgnoreStart
38162>>>>>>>
38162>>>>>>>    Use DFAllEnt.pkg
38162>>>>>>>    Use dbList.Sub
38162>>>>>>>    Use Button.Sub
38162>>>>>>>
38162>>>>>>>
38162>>>>>>>    Use Country.DD
38162>>>>>>>    
38162>>>>>>>    //AB-IgnoreEnd
38162>>>>>>>
38162>>>>>>>    Object sl058 is a dbModalPanelSub
38164>>>>>>>        Set Label to "•é¨œª"
38165>>>>>>>        Set Size to 148 297
38166>>>>>>>        Set Location to 6 10
38167>>>>>>>        Set Exit_Application_Local_State to FALSE
38168>>>>>>>        Set Modal_State to FALSE
38169>>>>>>>
38169>>>>>>>        //AB-DDOStart
38169>>>>>>>
38169>>>>>>>        Object Country_DD is a Country_DataDictionary
38171>>>>>>>        End_Object    // Country_DD
38172>>>>>>>
38172>>>>>>>        Set Main_DD to (Country_DD(self))
38173>>>>>>>        Set Server to (Country_DD(self))
38174>>>>>>>
38174>>>>>>>        //AB-DDOEnd
38174>>>>>>>
38174>>>>>>>        Object oSelList is a dbListSub
38176>>>>>>>            Set Main_File to Country.File_Number
38177>>>>>>>            Set Size to 105 280
38178>>>>>>>            Set Location to 6 6
38179>>>>>>>
38179>>>>>>>            Begin_Row
38182>>>>>>>                Entry_Item Country.Country_id
38183>>>>>>>                Entry_Item Country.Country_descr
38184>>>>>>>            End_Row
38189>>>>>>>
38189>>>>>>>            Set Form_Width    item 0 to 87
38190>>>>>>>            Set Header_Label  item 0 to "‰à›"
38191>>>>>>>            
38191>>>>>>>            Set Form_Width    item 1 to 183
38192>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
38193>>>>>>>            
38193>>>>>>>        End_Object    // oSelList
38194>>>>>>>
38194>>>>>>>        Object oOK_bn is a ButtonSub
38196>>>>>>>            Set Label to "&„§ ¢¦šã"
38197>>>>>>>            Set Location to 115 126
38198>>>>>>>
38198>>>>>>>            //AB-StoreStart
38198>>>>>>>            Procedure OnClick
38200>>>>>>>                Send OK To (oSelList(current_object))
38201>>>>>>>            End_Procedure
38202>>>>>>>            //AB-StoreEnd
38202>>>>>>>
38202>>>>>>>        End_Object    // oOK_bn
38203>>>>>>>
38203>>>>>>>        Object oCancel_bn is a ButtonSub
38205>>>>>>>            Set Label to "&€¡ç¨à©ž"
38206>>>>>>>            Set Location to 115 181
38207>>>>>>>
38207>>>>>>>            //AB-StoreStart
38207>>>>>>>            Procedure OnClick
38209>>>>>>>                Send Cancel To (oSelList(current_object))
38210>>>>>>>            End_Procedure
38211>>>>>>>            //AB-StoreEnd
38211>>>>>>>
38211>>>>>>>        End_Object    // oCancel_bn
38212>>>>>>>
38212>>>>>>>        Object oSearch_bn is a ButtonSub
38214>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
38215>>>>>>>            Set Location to 115 236
38216>>>>>>>
38216>>>>>>>            //AB-StoreStart
38216>>>>>>>            Procedure OnClick
38218>>>>>>>                Send Search To (oSelList(current_object))
38219>>>>>>>            End_Procedure
38220>>>>>>>            //AB-StoreEnd
38220>>>>>>>
38220>>>>>>>        End_Object    // oSearch_bn
38221>>>>>>>
38221>>>>>>>
38221>>>>>>>        //AB-StoreStart
38221>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
38222>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
38223>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
38224>>>>>>>        //AB-StoreEnd
38224>>>>>>>
38224>>>>>>>    End_Object    // sl058
38225>>>>>>>
38225>>>>>>>//AB/     End_Object    // prj
38225>>>>>
38225>>>>>//DDB-Selection-pkg-End
38225>>>>>//DDB-FileEnd
38225>>>    use towns.dd
INCLUDING FILE: TOWNS.DD
38225>>>>>//DDB-FileStart
38225>>>>>//DDB-HeaderStart
38225>>>>>
38225>>>>>// File Name : TOWNS.DD
38225>>>>>// Class Name: Towns_DataDictionary
38225>>>>>// Revision  : 8
38225>>>>>// Version   : 2
38225>>>>>
38225>>>>>Use  Windows           // Basic Definitions
38225>>>>>Use  DataDict          // DataDictionary Class Definition
38225>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38225>>>>>
38225>>>>>Open Towns
38227>>>>>Open Cities
38229>>>>>Open Country
38231>>>>>
38231>>>>>//DDB-HeaderEnd
38231>>>>>//DDB-SelectionStart
38231>>>>>//DDB/ ExternalSelectionList sl057  sl057.SL
38231>>>>>Register_Object sl057
38231>>>>>//DDB-SelectionEnd
38231>>>>>
38231>>>>>Class Towns_DataDictionary  is a DataDictionary_Sec
38232>>>>>
38232>>>>>    Procedure Save_Main_File
38233>>>>>        If (Operation_Origin<>Self) Begin
38235>>>>>            If Towns.Recnum Eq 0 Procedure_Return
38238>>>>>        End
38238>>>>>>
38238>>>>>        Forward Send Save_Main_File
38240>>>>>    End_Procedure
38241>>>>>
38241>>>>>
38241>>>>>    // Define_Fields:
38241>>>>>    // This procedure is used to set up all data-dictionary rules.
38241>>>>>
38241>>>>>    Procedure Define_Fields
38242>>>>>        Forward Send Define_Fields
38244>>>>>        //DDB-Generated-Code-Location
38244>>>>>        //DDB-DefineFieldStart
38244>>>>>
38244>>>>>        Set Main_File            To Towns.File_Number
38245>>>>>        Set Cascade_Delete_State To FALSE
38246>>>>>
38246>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   to DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38247>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD to DD_NOPUT       DD_FINDREQ    
38248>>>>>        Set Foreign_Field_Options  DD_DEFAULT    to DD_DISPLAYONLY
38249>>>>>
38249>>>>>        // Child (Client) file structure................
38249>>>>>        Send Add_Client_File  Cities.File_Number
38250>>>>>
38250>>>>>        // Parent (Server) file structure...............
38250>>>>>        Send Add_Server_File  Country.File_Number
38251>>>>>
38251>>>>>        // Field-based properties.......................
38251>>>>>
38251>>>>>        // Towns.Country_Id
38251>>>>>        Set Key_Field_State        Field Towns.Country_Id To TRUE
38252>>>>>
38252>>>>>        // Towns.Town_Id
38252>>>>>        Set Field_Options          Field Towns.Town_Id To DD_AUTOFIND   
38253>>>>>        Set Field_Prompt_Object    Field Towns.Town_Id To (sl057(Self))
38254>>>>>
38254>>>>>        // Towns.Town_Descr
38254>>>>>        Set Field_Prompt_Object    Field Towns.Town_Descr To (sl057(Self))
38255>>>>>
38255>>>>>        //DDB-DefineFieldEnd
38255>>>>>    End_Procedure    // Define_Fields
38256>>>>>
38256>>>>>    // Field_Defaults:
38256>>>>>    // This procedure is used to establish default field values.
38256>>>>>
38256>>>>>    Procedure Field_Defaults
38257>>>>>        Forward Send Field_Defaults
38259>>>>>        //DDB-Generated-Code-Location
38259>>>>>        //DDB-FieldDefaultStart
38259>>>>>        //DDB-FieldDefaultEnd
38259>>>>>    End_Procedure    // Field_Defaults
38260>>>>>
38260>>>>>End_Class    // Towns_DataDictionary
38261>>>>>//DDB-Selection-pkg-Start
38261>>>>>
38261>>>>>Use sl057.SL         // sl057
INCLUDING FILE: SL057.SL
38261>>>>>>>//AB/ Project sl057 : Towns -Nomoi - Eyr Perioxes
38261>>>>>>>//AB/     Object prj is a Lookup_Project
38261>>>>>>>//AB/         Set ProjectName to "sl057 : Towns -Nomoi - Eyr Perioxes"
38261>>>>>>>//AB/         Set ProjectFileName to "sl057.SL"
38261>>>>>>>
38261>>>>>>>// Project Object Structure
38261>>>>>>>//   sl057 is a dbModalPanelSub
38261>>>>>>>//     Country_DD is a DataDictionary
38261>>>>>>>//     Towns_DD is a DataDictionary
38261>>>>>>>//     oSelList is a dbListSub
38261>>>>>>>//     oOK_bn is a ButtonSub
38261>>>>>>>//     oCancel_bn is a ButtonSub
38261>>>>>>>//     oSearch_bn is a ButtonSub
38261>>>>>>>
38261>>>>>>>// Register all objects
38261>>>>>>>Register_Object Country_DD
38261>>>>>>>Register_Object oCancel_bn
38261>>>>>>>Register_Object oOK_bn
38261>>>>>>>Register_Object oSearch_bn
38261>>>>>>>Register_Object oSelList
38261>>>>>>>Register_Object sl057
38261>>>>>>>Register_Object Towns_DD
38261>>>>>>>
38261>>>>>>>
38261>>>>>>>    //AB-IgnoreStart
38261>>>>>>>
38261>>>>>>>    Use DFAllEnt.pkg
38261>>>>>>>    Use dbList.Sub
38261>>>>>>>    Use Button.Sub
38261>>>>>>>
38261>>>>>>>
38261>>>>>>>    Use COUNTRY.DD
38261>>>>>>>    Use TOWNS.DD
38261>>>>>>>    
38261>>>>>>>    //AB-IgnoreEnd
38261>>>>>>>
38261>>>>>>>    Object sl057 is a dbModalPanelSub
38263>>>>>>>        Set Label to "Œ¦£¦å - „¬¨ç«œ¨œª §œ¨ ¦®âª"
38264>>>>>>>        Set Size to 148 297
38265>>>>>>>        Set Location to 6 10
38266>>>>>>>        Set Exit_Application_Local_State to FALSE
38267>>>>>>>        Set Modal_State to FALSE
38268>>>>>>>
38268>>>>>>>        //AB-DDOStart
38268>>>>>>>
38268>>>>>>>        Object Country_DD is a Country_DataDictionary
38270>>>>>>>        End_Object    // Country_DD
38271>>>>>>>
38271>>>>>>>        Object Towns_DD is a Towns_DataDictionary
38273>>>>>>>            Set DDO_Server to (Country_DD(self))
38274>>>>>>>        End_Object    // Towns_DD
38275>>>>>>>
38275>>>>>>>        Set Main_DD to (Towns_DD(self))
38276>>>>>>>        Set Server to (Towns_DD(self))
38277>>>>>>>
38277>>>>>>>        //AB-DDOEnd
38277>>>>>>>
38277>>>>>>>        Object oSelList is a dbListSub
38279>>>>>>>            Set Main_File to Towns.File_Number
38280>>>>>>>            Set Size to 105 280
38281>>>>>>>            Set Location to 6 6
38282>>>>>>>
38282>>>>>>>            Begin_Row
38285>>>>>>>                Entry_Item Towns.Town_id
38286>>>>>>>                Entry_Item Towns.Town_descr
38287>>>>>>>                Entry_Item Country.Country_descr
38288>>>>>>>            End_Row
38293>>>>>>>
38293>>>>>>>            Set Form_Width    item 0 to 43
38294>>>>>>>            Set Header_Label  item 0 to "‰à›"
38295>>>>>>>            
38295>>>>>>>            Set Form_Width    item 1 to 137
38296>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
38297>>>>>>>            
38297>>>>>>>            Set Form_Width    item 2 to 94
38298>>>>>>>            Set Header_Label  item 2 to "•é¨˜"
38299>>>>>>>            
38299>>>>>>>        End_Object    // oSelList
38300>>>>>>>
38300>>>>>>>        Object oOK_bn is a ButtonSub
38302>>>>>>>            Set Label to "&„§ ¢¦šã"
38303>>>>>>>            Set Location to 115 126
38304>>>>>>>
38304>>>>>>>            //AB-StoreStart
38304>>>>>>>            Procedure OnClick
38306>>>>>>>                Send OK To (oSelList(current_object))
38307>>>>>>>            End_Procedure
38308>>>>>>>            //AB-StoreEnd
38308>>>>>>>
38308>>>>>>>        End_Object    // oOK_bn
38309>>>>>>>
38309>>>>>>>        Object oCancel_bn is a ButtonSub
38311>>>>>>>            Set Label to "&€¡ç¨à©ž"
38312>>>>>>>            Set Location to 115 181
38313>>>>>>>
38313>>>>>>>            //AB-StoreStart
38313>>>>>>>            Procedure OnClick
38315>>>>>>>                Send Cancel To (oSelList(current_object))
38316>>>>>>>            End_Procedure
38317>>>>>>>            //AB-StoreEnd
38317>>>>>>>
38317>>>>>>>        End_Object    // oCancel_bn
38318>>>>>>>
38318>>>>>>>        Object oSearch_bn is a ButtonSub
38320>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
38321>>>>>>>            Set Location to 115 236
38322>>>>>>>
38322>>>>>>>            //AB-StoreStart
38322>>>>>>>            Procedure OnClick
38324>>>>>>>                Send Search To (oSelList(current_object))
38325>>>>>>>            End_Procedure
38326>>>>>>>            //AB-StoreEnd
38326>>>>>>>
38326>>>>>>>        End_Object    // oSearch_bn
38327>>>>>>>
38327>>>>>>>
38327>>>>>>>        //AB-StoreStart
38327>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
38328>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
38329>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
38330>>>>>>>        //AB-StoreEnd
38330>>>>>>>
38330>>>>>>>    End_Object    // sl057
38331>>>>>>>
38331>>>>>>>//AB/     End_Object    // prj
38331>>>>>
38331>>>>>//DDB-Selection-pkg-End
38331>>>>>//DDB-FileEnd
38331>>>    use payresp.dd
INCLUDING FILE: PAYRESP.DD
38331>>>>>//DDB-FileStart
38331>>>>>//DDB-HeaderStart
38331>>>>>
38331>>>>>// File Name : PAYRESP.DD
38331>>>>>// Class Name: Payresp_DataDictionary
38331>>>>>// Revision  : 82
38331>>>>>// Version   : 2
38331>>>>>
38331>>>>>Use  Windows           // Basic Definitions
38331>>>>>Use  DataDict          // DataDictionary Class Definition
38331>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38331>>>>>
38331>>>>>Open Payresp
38333>>>>>Open Prspbank
INCLUDING FILE: PRSPBANK.FD
38335>>>>>Open Tppresp
INCLUDING FILE: TPPRESP.FD
38337>>>>>Open Clients
38339>>>>>Open Sysrecc
INCLUDING FILE: SYSRECC.FD
38341>>>>>Open Gmove
INCLUDING FILE: GMOVE.FD
38343>>>>>Open Sysrecg
38345>>>>>
38345>>>>>//DDB-HeaderEnd
38345>>>>>//DDB-ValidationStart
38345>>>>>
38345>>>>>Register_Object Payresp_Presp_Doy_VT
38345>>>>>Register_Object Payresp_Presp_Categfpa_VT
38345>>>>>Register_Object Payresp_Feregios_VT
38345>>>>>
38345>>>>>Object Payresp_Presp_Doy_VT  is a CodeValidationTable
38347>>>>>    Set Type_Value        To "DOY"
38348>>>>>    Set Allow_Blank_State To TRUE
38349>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
38350>>>>>    //DDB-ValidationCustomStart
38350>>>>>    //DDB-ValidationCustomEnd
38350>>>>>End_Object   // Payresp_Presp_Doy_VT
38351>>>>>
38351>>>>>Object Payresp_Presp_Categfpa_VT  is a CodeValidationTable
38353>>>>>    Set Type_Value        To "VAT_STATUS"
38354>>>>>    Set Validate_State    To FALSE
38355>>>>>    Set Allow_Blank_State To TRUE
38356>>>>>    //DDB-ValidationCustomStart
38356>>>>>    //DDB-ValidationCustomEnd
38356>>>>>End_Object   // Payresp_Presp_Categfpa_VT
38357>>>>>
38357>>>>>Object Payresp_Feregios_VT  is a CodeValidationTable
38359>>>>>    Set Type_Value        To "FEREGIOS"
38360>>>>>    Set Allow_Blank_State To TRUE
38361>>>>>    Set Table_Title       To "ƒœå¡«œª ”œ¨œšš¬æ«ž«˜ª ”¦¨âà¤"
38362>>>>>    //DDB-ValidationCustomStart
38362>>>>>    //DDB-ValidationCustomEnd
38362>>>>>End_Object   // Payresp_Feregios_VT
38363>>>>>//DDB-ValidationEnd
38363>>>>>//DDB-SelectionStart
38363>>>>>//DDB/ ExternalSelectionList sl111  sl111.SL
38363>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
38363>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
38363>>>>>Register_Object sl111
38363>>>>>Register_Object sl198
38363>>>>>Register_Object sl197
38363>>>>>//DDB-SelectionEnd
38363>>>>>
38363>>>>>Open Year
38365>>>>>
38365>>>>>Class Payresp_DataDictionary  is a DataDictionary_Sec
38366>>>>>
38366>>>>>    Procedure Construct_Object
38367>>>>>        Forward Send Construct_Object
38369>>>>>        Property Integer piCheckPlaf        Public 0
38370>>>>>        //------------------------------------------------
38370>>>>>        // Properties gia na kraththoun oi palies times
38370>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio
38370>>>>>        // einai 1     js 03/12/2007
38370>>>>>        //------------------------------------------------
38370>>>>>        Property Integer piCreateNew            Public  0
38371>>>>>        Property String  psAud_Old_Pelaths      Public ""
38372>>>>>        Property String  psAud_Old_PelathsN     Public ""
38373>>>>>        Property String  psAud_Old_AFM          Public ""
38374>>>>>        Property String  psAud_Old_DOY          Public ""
38375>>>>>        Property String  psAud_Old_DOYN         Public ""
38376>>>>>        Property Integer piAud_Old_HPAL         Public  0
38377>>>>>        Property Integer piAud_Old_HPSO         Public  0
38378>>>>>        Property String  psAud_Old_PartlRecr    Public ""
38379>>>>>        Property String  psAud_Old_PmsRecr      Public ""
38380>>>>>        //------------------------------------------------
38380>>>>>
38380>>>>>    End_procedure
38381>>>>>
38381>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
38382>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
38384>>>>>        //------------------------------------------------
38384>>>>>        // Properties gia na kraththoun oi palies times
38384>>>>>        // ton pedion js 03/12/2007
38384>>>>>        //------------------------------------------------
38384>>>>>        Set psAud_Old_Pelaths      to Payresp.Presp_ID
38385>>>>>        Set psAud_Old_PelathsN     to Payresp.Presp_Name
38386>>>>>        Set psAud_Old_AFM          to Payresp.Presp_AFM
38387>>>>>        Set psAud_Old_DOY          to Payresp.Presp_Doy
38388>>>>>        Set psAud_Old_DOYN         to (gsfCode_Mast("DOY",Payresp.Presp_Doy))
38389>>>>>        Set piAud_Old_HPAL         to Payresp.Stoxos_IPAL
38390>>>>>        Set piAud_Old_HPSO         to Payresp.Stoxos_IPSO
38391>>>>>        Set psAud_Old_PartlRecr    to Payresp.Presp_Recr
38392>>>>>        Set psAud_Old_PmsRecr      to Payresp.Presp_Recr
38393>>>>>        //------------------------------------------------
38393>>>>>     End_Procedure   // New_Current_Record
38394>>>>>
38394>>>>>    Procedure Delete_Main_File
38395>>>>>        //---------------------------------------------
38395>>>>>        // Auditing / Katagrafh allagon
38395>>>>>        String  sUser sText sTime sMin sHour sSec
38396>>>>>        Date    dDate  Shmer
38396>>>>>        Integer iMin iHour iSec iLen
38396>>>>>        Sysdate dDate iHour iMin iSec
38400>>>>>        Move iHour  to sHour
38401>>>>>        Move iMin   to sMin
38402>>>>>        Move iSec   to sSec
38403>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
38407>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
38411>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
38415>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
38416>>>>>
38416>>>>>        // Auditing / Diagrafh
38416>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
38418>>>>>            Get fsLoginUserID to sUser
38419>>>>>            clear gmove
38420>>>>>            move syscurxr.company_code  to gmove.company_code
38421>>>>>            move syscurxr.branch_code   to gmove.branch_code
38422>>>>>            move syscurxr.year_year     to gmove.year_year
38423>>>>>            move  3                     to gmove.gtypkin_code// Apo Clients
38424>>>>>            move ddate                  to gmove.garticl_hmnia
38425>>>>>            move suser                  to gmove.gplan_code
38426>>>>>            move Payresp.Presp_Recr    to gmove.garticl_recr
38427>>>>>            reread sysrecg
38431>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
38432>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
38433>>>>>            saverecord sysrecg
38434>>>>>            unlock
38435>>>>>>
38435>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
38436>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
38437>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs
38438>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
38439>>>>>
38439>>>>>            Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
38440>>>>>            Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
38441>>>>>            Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
38442>>>>>            Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy
38443>>>>>            Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
38444>>>>>            Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
38445>>>>>            Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
38446>>>>>
38446>>>>>
38446>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª “§œ¬Ÿç¤¦¬ ¢ž¨à£é¤"     to gmove.gmove_aitiol
38447>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
38448>>>>>            saverecord gmove
38449>>>>>        End
38449>>>>>>
38449>>>>>        Forward Send Delete_Main_File
38451>>>>>
38451>>>>>    End_Procedure
38452>>>>>
38452>>>>>    Procedure Update
38453>>>>>        Forward Send Update
38455>>>>>        Move SysCurXR.Company_Code  to payresp.Company_Code
38456>>>>>        Move SysCurXR.Branch_Code   to payresp.Branch_Code
38457>>>>>        Move SysCurXR.Year_Year     to payresp.Year_Year
38458>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
38458>>>>>        Move (payresp.Xreosh-payresp.Pistosh)   to payresp.Ypoloipo
38459>>>>>        Move (payresp.Plafon-payresp.ypoloipo)  to payresp.Overhead
38460>>>>>
38460>>>>>        //betolink
38460>>>>>        Move SysCurXR.Beto_Site      to payresp.presp_SiteW
38461>>>>>        Move payresp.presp_Rec0      to payresp.presp_SN
38462>>>>>        Move payresp.presp_id        to payresp.presp_Repm
38463>>>>>
38463>>>>>        //---------------------------------------------
38463>>>>>        // Auditing / Katagrafh allagon
38463>>>>>        String  sUser sText sTime sMin sHour sSec
38464>>>>>        Date    dDate  Shmer
38464>>>>>        Integer iMin iHour iSec iLen
38464>>>>>        Sysdate dDate iHour iMin iSec
38468>>>>>        Move iHour  to sHour
38469>>>>>        Move iMin   to sMin
38470>>>>>        Move iSec   to sSec
38471>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
38475>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
38479>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
38483>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
38484>>>>>
38484>>>>>        // Auditing / Dhmiourgia - Diorthosh
38484>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
38486>>>>>            Get fsLoginUserID to sUser
38487>>>>>            If (piCreateNew(Self)=1) Begin
38489>>>>>                clear gmove
38490>>>>>                move syscurxr.company_code  to gmove.company_code
38491>>>>>                move syscurxr.branch_code   to gmove.branch_code
38492>>>>>                move syscurxr.year_year     to gmove.year_year
38493>>>>>                move  3                     to gmove.gtypkin_code// Apo Clients
38494>>>>>                move ddate                  to gmove.garticl_hmnia
38495>>>>>                move suser                  to gmove.gplan_code
38496>>>>>                move Payresp.Presp_Recr     to gmove.garticl_recr
38497>>>>>                reread sysrecg
38501>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
38502>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
38503>>>>>                saverecord sysrecg
38504>>>>>                unlock
38505>>>>>>
38505>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
38506>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
38507>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
38508>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
38509>>>>>                Move Payresp.Presp_ID               to Gmove.Cur_ID
38510>>>>>                Move Payresp.Presp_Name             to Gmove.Cur_Name
38511>>>>>                Move Payresp.Presp_Recr             to Gmove.Partl_Recr 
38512>>>>>                Move Payresp.Presp_Recr             to Gmove.Pms_Recr          
38513>>>>>                Move Payresp.Presp_AFM              to Gmove.Cur_AFM
38514>>>>>                Move Payresp.Presp_DOY              to Gmove.Cur_DOY
38515>>>>>                Move (gsfCode_Mast("DOY",Payresp.Presp_Doy)) to Gmove.Txt4
38516>>>>>                Move Payresp.Stoxos_IPAL            to Gmove.Prev_Stoxos1
38517>>>>>                Move Payresp.Stoxos_IPSO            to Gmove.Prev_Stoxos2
38518>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â¦¬ “§œ¬Ÿç¤¦¬ ¢ž¨à£é¤" to Gmove.Gmove_Aitiol
38519>>>>>                Move "N" to Gmove.Eidos_Metabolhs
38520>>>>>                saverecord gmove
38521>>>>>                Set piCreateNew to 0
38522>>>>>            End
38522>>>>>>
38522>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
38525>>>>>                Integer isChanged
38525>>>>>                Move 0 to isChanged
38526>>>>>                
38526>>>>>                     If (psAud_Old_Pelaths  (Self)<>Payresp.Presp_ID   ) Move 1 to isChanged
38529>>>>>                Else If (psAud_Old_PelathsN (Self)<>Payresp.Presp_Name ) Move 1 to isChanged
38533>>>>>                Else If (psAud_Old_AFM      (Self)<>Payresp.Presp_AFM  ) Move 1 to isChanged
38537>>>>>                Else If (psAud_Old_DOY      (Self)<>Payresp.Presp_DOY  ) Move 1 to isChanged
38541>>>>>                Else If (piAud_Old_HPAL     (Self)<>Payresp.Stoxos_IPAL) Move 1 to isChanged
38545>>>>>                Else If (piAud_Old_HPSO     (Self)<>Payresp.Stoxos_IPSO) Move 1 to isChanged
38549>>>>>                
38549>>>>>                If (isChanged>0) Begin  
38551>>>>>                    clear gmove
38552>>>>>                    move syscurxr.company_code  to gmove.company_code
38553>>>>>                    move syscurxr.branch_code   to gmove.branch_code
38554>>>>>                    move syscurxr.year_year     to gmove.year_year
38555>>>>>                    move  3                     to gmove.gtypkin_code// Apo Clients
38556>>>>>                    move ddate                  to gmove.garticl_hmnia
38557>>>>>                    move suser                  to gmove.gplan_code
38558>>>>>                    move Payresp.Presp_Recr    to gmove.garticl_recr
38559>>>>>                    reread sysrecg
38563>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
38564>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
38565>>>>>                    saverecord sysrecg
38566>>>>>                    unlock
38567>>>>>>
38567>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
38568>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
38569>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
38570>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
38571>>>>>                    Move Payresp.Presp_Recr             to Gmove.Partl_Recr 
38572>>>>>                    Move Payresp.Presp_Recr             to Gmove.Pms_Recr          
38573>>>>>                    //--
38573>>>>>                    Move Payresp.Presp_ID               to Gmove.Cur_ID
38574>>>>>                    Move Payresp.Presp_Name             to Gmove.Cur_Name
38575>>>>>                    Move Payresp.Presp_AFM              to Gmove.Cur_AFM
38576>>>>>                    Move Payresp.Presp_DOY              to Gmove.Cur_DOY
38577>>>>>                    Move (gsfCode_Mast("DOY",Payresp.Presp_Doy)) to Gmove.Txt4
38578>>>>>                    Move Payresp.Stoxos_IPAL            to Gmove.Prev_Stoxos1
38579>>>>>                    Move Payresp.Stoxos_IPSO            to Gmove.Prev_Stoxos2
38580>>>>>                    //--
38580>>>>>                    Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
38581>>>>>                    Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
38582>>>>>                    Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
38583>>>>>                    Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy 
38584>>>>>                    Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
38585>>>>>                    Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
38586>>>>>                    Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
38587>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª “§œ¬Ÿç¤¦¬ ¢ž¨à£é¤"  to gmove.gmove_aitiol
38588>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
38589>>>>>                    saverecord gmove
38590>>>>>                    Set piCreateNew to 0
38591>>>>>                End
38591>>>>>>
38591>>>>>            End
38591>>>>>>
38591>>>>>        End
38591>>>>>>
38591>>>>>
38591>>>>>    End_Procedure   // Update
38592>>>>>
38592>>>>>     Procedure Creating
38593>>>>>        Forward Send Creating
38595>>>>>        // Insert Code Here
38595>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(payresp.presp_Rec0))))));                                    to payresp.presp_Recr
38596>>>>>        Move '1'                    to payresp.presp_Active
38597>>>>>        get fsgCode_With_Zeroes payresp.presp_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to payresp.presp_ID
38598>>>>>        clear year
38599>>>>>        move syscurxr.branch_code   to year.branch_code
38600>>>>>        move syscurxr.company_code  to year.company_code
38601>>>>>        move syscurxr.year_year     to YEAR.year_year
38602>>>>>        find eq year by index.1
38603>>>>>>
38603>>>>>        if (found=1) begin
38605>>>>>            move year.payresp_plafon to payresp.plafon
38606>>>>>            move year.payresp_ofeilh to payresp.orio_syn_ofeilh
38607>>>>>        end
38607>>>>>>
38607>>>>>        Set piCreateNew to 1
38608>>>>>    End_Procedure   // Creating
38609>>>>>
38609>>>>>   Function Validate_Save  Returns Integer
38610>>>>>        Integer iReturnVal iCheck iYes
38611>>>>>        Forward Get Validate_Save  To iReturnVal
38613>>>>>        If (Not(iReturnVal)) Begin
38615>>>>>
38615>>>>>            If (Sysfile.Check_Afm=1) Begin
38617>>>>>                Move (Check_AFM(payresp.presp_Afm)) to iCheck
38618>>>>>                If (iCheck) Begin
38620>>>>>                         If (iCheck=1) Move 4001 to iReturnVal
38623>>>>>                    Else If (iCheck=2) Move 4002 to iReturnVal
38627>>>>>                    Else If (iCheck=3) Move 4003 to iReturnVal
38631>>>>>                End
38631>>>>>>
38631>>>>>            End
38631>>>>>>
38631>>>>>
38631>>>>>           If (piCheckPlaf(Self)=1) Begin
38633>>>>>                If ((PayResp.Plafon>0) And ((PayResp.Ypoloipo+PayResp.Posa_Apo_Dap)>PayResp.Plafon)) Begin
38635>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 5000 Payresp'  to iYes
38636>>>>>                        If (iYes=MBR_NO) Error 4004 'DDC111: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4004 to iReturnVal
38639>>>>>                End
38639>>>>>>
38639>>>>>                Else If ((PayResp.Orio_Syn_Ofeilh>0) And (PayResp.Synolikh_Ofeilh>PayResp.Orio_Syn_Ofeilh)) Begin
38642>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 5001 Payresp' to iYes
38643>>>>>                        If (iYes=MBR_NO) Error 4005 'DDC111: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
38646>>>>>                End
38646>>>>>>
38646>>>>>           End
38646>>>>>>
38646>>>>>        If (iReturnVal) Send Operation_Not_Allowed iReturnVal
38649>>>>>        End
38649>>>>>>
38649>>>>>        Function_Return iReturnVal
38650>>>>>    End_Function   // Validate_Save
38651>>>>>
38651>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
38652>>>>>        String lsError_Message
38653>>>>>        Case Begin
38653>>>>>            Case (iError_Num = 4001)
38655>>>>>                Move "DDC 100: Š˜¤Ÿ˜©£â¤¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤" to lsError_Message
38656>>>>>              Case Break
38657>>>>>            Case (iError_Num = 4002)
38660>>>>>                Move "DDC 100: ’¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤ ›œ¤ œå¤˜  9 ¯ã­ ¦" to lsError_Message
38661>>>>>              Case Break
38662>>>>>            Case (iError_Num = 4003)
38665>>>>>                Move "DDC 100: €¡˜«á¢¢ž¢¦ª ®˜¨˜¡«ã¨˜ª ©«¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤ " to lsError_Message
38666>>>>>              Case Break
38667>>>>>            Case (iError_Num = 4004)
38670>>>>>                Move "DDC 100: „š ¤œ ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç" to lsError_Message
38671>>>>>              Case Break
38672>>>>>            Case (iError_Num = 4005)
38675>>>>>                Move "DDC 100: „š ¤œ ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª" to lsError_Message
38676>>>>>              Case Break
38677>>>>>            Case Else
38677>>>>>                Forward Send Operation_Not_Allowed iError_Num
38679>>>>>        Case End
38679>>>>>        Error iError_Num lsError_Message
38680>>>>>>
38680>>>>>    End_Procedure // operation_not_allowed
38681>>>>>
38681>>>>>
38681>>>>>
38681>>>>>    Procedure Define_Fields
38682>>>>>        Forward Send Define_Fields
38684>>>>>        //DDB-Generated-Code-Location
38684>>>>>        //DDB-DefineFieldStart
38684>>>>>
38684>>>>>        Set Main_File            To Payresp.File_Number
38685>>>>>        Set Cascade_Delete_State To FALSE
38686>>>>>
38686>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38687>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38688>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38689>>>>>
38689>>>>>        // Child (Client) file structure................
38689>>>>>        Send Add_Client_File  Prspbank.File_Number
38690>>>>>        Send Add_Client_File  Tppresp.File_Number
38691>>>>>        Send Add_Client_File  Clients.File_Number
38692>>>>>
38692>>>>>        // External (System) file structure.............
38692>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
38693>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
38694>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
38695>>>>>
38695>>>>>        Define_Auto_Increment  Sysrecc.Payresp_Rec0  To Payresp.Presp_Rec0
38698>>>>>
38698>>>>>        // Field-based properties.......................
38698>>>>>
38698>>>>>        // Payresp.Company_Code
38698>>>>>
38698>>>>>        // Payresp.Branch_Code
38698>>>>>
38698>>>>>        // Payresp.Year_Year
38698>>>>>
38698>>>>>        // Payresp.Custprom_Code
38698>>>>>
38698>>>>>        // Payresp.Presp_Id
38698>>>>>        Set Field_Options          Field Payresp.Presp_Id To DD_AUTOFIND    DD_NOPUT      
38699>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Id To (sl111(Self))
38700>>>>>        Set Key_Field_State        Field Payresp.Presp_Id To TRUE
38701>>>>>
38701>>>>>        // Payresp.Presp_Name
38701>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Name To (sl111(Self))
38702>>>>>
38702>>>>>        // Payresp.Presp_Afm
38702>>>>>
38702>>>>>        // Payresp.Presp_Rec0
38702>>>>>
38702>>>>>        // Payresp.Custprom_Recr
38702>>>>>
38702>>>>>        // Payresp.Presp_Recr
38702>>>>>
38702>>>>>        // Payresp.Last_Xreosh
38702>>>>>
38702>>>>>        // Payresp.Last_Pistosh
38702>>>>>
38702>>>>>        // Payresp.Last_Order
38702>>>>>
38702>>>>>        // Payresp.Presp_Doy
38702>>>>>        Set Field_Value_Table      Field Payresp.Presp_Doy To (Payresp_Presp_Doy_VT(Self))
38703>>>>>
38703>>>>>        // Payresp.Presp_Address
38703>>>>>
38703>>>>>        // Payresp.Presp_City_Id
38703>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_City_Id To (sl198(Self))
38704>>>>>
38704>>>>>        // Payresp.Presp_Area
38704>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Area To (sl197(Self))
38705>>>>>
38705>>>>>        // Payresp.Presp_Job
38705>>>>>
38705>>>>>        // Payresp.Presp_Respons
38705>>>>>
38705>>>>>        // Payresp.Presp_Zipcode
38705>>>>>
38705>>>>>        // Payresp.Presp_Phone
38705>>>>>
38705>>>>>        // Payresp.Presp_Fax
38705>>>>>
38705>>>>>        // Payresp.Presp_Mobile
38705>>>>>
38705>>>>>        // Payresp.Presp_Aoh
38705>>>>>
38705>>>>>        // Payresp.Presp_Email
38705>>>>>
38705>>>>>        // Payresp.Presp_Class
38705>>>>>
38705>>>>>        // Payresp.Presp_Details
38705>>>>>
38705>>>>>        // Payresp.Presp_Sitew
38705>>>>>
38705>>>>>        // Payresp.Presp_Codem
38705>>>>>
38705>>>>>        // Payresp.Presp_Categfpa
38705>>>>>        Set Field_Value_Table      Field Payresp.Presp_Categfpa To (Payresp_Presp_Categfpa_VT(Self))
38706>>>>>
38706>>>>>        // Payresp.Presp_Fpa
38706>>>>>
38706>>>>>        // Payresp.Presp_Public
38706>>>>>
38706>>>>>        // Payresp.Presp_Sn
38706>>>>>
38706>>>>>        // Payresp.Presp_Repm
38706>>>>>
38706>>>>>        // Payresp.Presp_Active
38706>>>>>
38706>>>>>        // Payresp.Presp_Reported
38706>>>>>
38706>>>>>        // Payresp.Presp_Pelprom
38706>>>>>
38706>>>>>        // Payresp.Presp_Lastupd
38706>>>>>
38706>>>>>        // Payresp.Presp_Markexp
38706>>>>>
38706>>>>>        // Payresp.Presp_Catjob
38706>>>>>
38706>>>>>        // Payresp.Is_Promhtheyths
38706>>>>>
38706>>>>>        // Payresp.Xreosh
38706>>>>>
38706>>>>>        // Payresp.Pistosh
38706>>>>>
38706>>>>>        // Payresp.Ypoloipo
38706>>>>>
38706>>>>>        // Payresp.Plafon
38706>>>>>
38706>>>>>        // Payresp.Overhead
38706>>>>>
38706>>>>>        // Payresp.Presp_Add_No
38706>>>>>
38706>>>>>        // Payresp.Presp_Nomos
38706>>>>>
38706>>>>>        // Payresp.Presp_Xora
38706>>>>>
38706>>>>>        // Payresp.Polh_Recr
38706>>>>>
38706>>>>>        // Payresp.Synolikh_Ofeilh
38706>>>>>
38706>>>>>        // Payresp.Stoxos_Ipal
38706>>>>>
38706>>>>>        // Payresp.Stoxos_Ipso
38706>>>>>
38706>>>>>        // Payresp.Poso_Se_Apait
38706>>>>>
38706>>>>>        // Payresp.Orio_Syn_Ofeilh
38706>>>>>
38706>>>>>        // Payresp.Posa_Apo_Dap
38706>>>>>
38706>>>>>        // Payresp.Feregios
38706>>>>>        Set Field_Value_Table      Field Payresp.Feregios To (Payresp_Feregios_VT(Self))
38707>>>>>
38707>>>>>        //DDB-DefineFieldEnd
38707>>>>>    End_Procedure    // Define_Fields
38708>>>>>
38708>>>>>    // Field_Defaults:
38708>>>>>    // This procedure is used to establish default field values.
38708>>>>>
38708>>>>>    Procedure Field_Defaults
38709>>>>>        Forward Send Field_Defaults
38711>>>>>        //DDB-Generated-Code-Location
38711>>>>>        //DDB-FieldDefaultStart
38711>>>>>        Set Field_Changed_Value   Field Payresp.Presp_Doy To "0"
38712>>>>>        //DDB-FieldDefaultEnd
38712>>>>>    End_Procedure    // Field_Defaults
38713>>>>>
38713>>>>>End_Class    // Payresp_DataDictionary
38714>>>>>//DDB-Selection-pkg-Start
38714>>>>>
38714>>>>>Use sl111.SL         // sl111
INCLUDING FILE: SL111.SL
38714>>>>>>>//AB/ Project sl111
38714>>>>>>>//AB/ Object prj is a Lookup_Project
38714>>>>>>>//AB/     Set ProjectName to "sl111"
38714>>>>>>>//AB/     Set ProjectFileName to "sl111.SL"
38714>>>>>>>//AB/     Set GenerateFileName to "NONAME"
38714>>>>>>>
38714>>>>>>>// Project Object Structure
38714>>>>>>>//   sl111 is a dbModalPanelSub
38714>>>>>>>//     Payresp_DD is a DataDictionary
38714>>>>>>>//     oSelList is a dbListSub
38714>>>>>>>//     oOK_bn is a ButtonSub
38714>>>>>>>//     oCancel_bn is a ButtonSub
38714>>>>>>>//     oSearch_bn is a ButtonSub
38714>>>>>>>
38714>>>>>>>// Register all objects
38714>>>>>>>Register_Object oCancel_bn
38714>>>>>>>Register_Object oOK_bn
38714>>>>>>>Register_Object oSearch_bn
38714>>>>>>>Register_Object oSelList
38714>>>>>>>Register_Object Payresp_DD
38714>>>>>>>Register_Object sl111
38714>>>>>>>
38714>>>>>>>
38714>>>>>>>//AB-IgnoreStart
38714>>>>>>>
38714>>>>>>>Use DFAllEnt.pkg
38714>>>>>>>Use dbList.Sub
38714>>>>>>>Use Button.Sub
38714>>>>>>>
38714>>>>>>>
38714>>>>>>>Use PAYRESP.DD
38714>>>>>>>
38714>>>>>>>//AB-IgnoreEnd
38714>>>>>>>
38714>>>>>>>Object sl111 is a dbModalPanelSub
38716>>>>>>>    Set Label to "“§œçŸ¬¤¦  ¢ž¨à£é¤ "
38717>>>>>>>    Set Size to 148 443
38718>>>>>>>    Set Location to 4 5
38719>>>>>>>    Set Exit_Application_Local_State to FALSE
38720>>>>>>>    Set Modal_State to FALSE
38721>>>>>>>
38721>>>>>>>    //AB-DDOStart
38721>>>>>>>
38721>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
38723>>>>>>>    End_Object    // Payresp_DD
38724>>>>>>>
38724>>>>>>>    Set Main_DD to (Payresp_DD(self))
38725>>>>>>>    Set Server to (Payresp_DD(self))
38726>>>>>>>
38726>>>>>>>    //AB-DDOEnd
38726>>>>>>>
38726>>>>>>>    Object oSelList is a dbListSub
38728>>>>>>>        Set Main_File to Payresp.File_Number
38729>>>>>>>        Set Size to 105 430
38730>>>>>>>        Set Location to 6 6
38731>>>>>>>
38731>>>>>>>        Begin_Row
38734>>>>>>>            Entry_Item Payresp.Presp_id
38735>>>>>>>            Entry_Item Payresp.Presp_name
38736>>>>>>>            Entry_Item Payresp.Presp_afm
38737>>>>>>>            Entry_Item Payresp.Presp_address
38738>>>>>>>            Entry_Item Payresp.Presp_phone
38739>>>>>>>        End_Row
38744>>>>>>>
38744>>>>>>>        Set Form_Width    item 0 to 60
38745>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
38746>>>>>>>        
38746>>>>>>>        Set Form_Width    item 1 to 106
38747>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
38748>>>>>>>        
38748>>>>>>>        Set Form_Width    item 2 to 60
38749>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
38750>>>>>>>        
38750>>>>>>>        Set Form_Width    item 3 to 135
38751>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
38752>>>>>>>        
38752>>>>>>>        Set Form_Width    item 4 to 60
38753>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
38754>>>>>>>        
38754>>>>>>>    End_Object    // oSelList
38755>>>>>>>
38755>>>>>>>    Object oOK_bn is a ButtonSub
38757>>>>>>>        Set Label to "&„§ ¢¦šã"
38758>>>>>>>        Set Location to 113 277
38759>>>>>>>
38759>>>>>>>        //AB-StoreStart
38759>>>>>>>        Procedure OnClick
38761>>>>>>>            Send OK To (oSelList(current_object))
38762>>>>>>>        End_Procedure
38763>>>>>>>        //AB-StoreEnd
38763>>>>>>>
38763>>>>>>>    End_Object    // oOK_bn
38764>>>>>>>
38764>>>>>>>    Object oCancel_bn is a ButtonSub
38766>>>>>>>        Set Label to "&€¡ç¨à©ž"
38767>>>>>>>        Set Location to 113 332
38768>>>>>>>
38768>>>>>>>        //AB-StoreStart
38768>>>>>>>        Procedure OnClick
38770>>>>>>>            Send Cancel To (oSelList(current_object))
38771>>>>>>>        End_Procedure
38772>>>>>>>        //AB-StoreEnd
38772>>>>>>>
38772>>>>>>>    End_Object    // oCancel_bn
38773>>>>>>>
38773>>>>>>>    Object oSearch_bn is a ButtonSub
38775>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
38776>>>>>>>        Set Location to 113 387
38777>>>>>>>
38777>>>>>>>        //AB-StoreStart
38777>>>>>>>        Procedure OnClick
38779>>>>>>>            Send Search To (oSelList(current_object))
38780>>>>>>>        End_Procedure
38781>>>>>>>        //AB-StoreEnd
38781>>>>>>>
38781>>>>>>>    End_Object    // oSearch_bn
38782>>>>>>>
38782>>>>>>>
38782>>>>>>>    //AB-StoreStart
38782>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
38783>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
38784>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
38785>>>>>>>    //AB-StoreEnd
38785>>>>>>>
38785>>>>>>>End_Object    // sl111
38786>>>>>>>
38786>>>>>>>//AB/ End_Object    // prj
38786>>>>>Use sl198.sl         // sl198
INCLUDING FILE: SL198.SL
38786>>>>>>>//AB/ Project sl198:cities
38786>>>>>>>//AB/ Object prj is a Lookup_Project
38786>>>>>>>//AB/     Set ProjectName to "sl198:cities"
38786>>>>>>>//AB/     Set ProjectFileName to "sl198.SL"
38786>>>>>>>//AB/     Set GenerateFileName to "NONAME"
38786>>>>>>>
38786>>>>>>>// Project Object Structure
38786>>>>>>>//   sl198 is a dbModalPanelSub
38786>>>>>>>//     Cities_DD is a DataDictionary
38786>>>>>>>//     oSelList is a dbListSub
38786>>>>>>>//     oOK_bn is a ButtonSub
38786>>>>>>>//     oCancel_bn is a ButtonSub
38786>>>>>>>//     oSearch_bn is a ButtonSub
38786>>>>>>>
38786>>>>>>>// Register all objects
38786>>>>>>>Register_Object Cities_DD
38786>>>>>>>Register_Object oCancel_bn
38786>>>>>>>Register_Object oOK_bn
38786>>>>>>>Register_Object oSearch_bn
38786>>>>>>>Register_Object oSelList
38786>>>>>>>Register_Object sl198
38786>>>>>>>
38786>>>>>>>
38786>>>>>>>//AB-IgnoreStart
38786>>>>>>>
38786>>>>>>>Use DFAllEnt.pkg
38786>>>>>>>Use dbList.Sub
38786>>>>>>>Use Button.Sub
38786>>>>>>>
38786>>>>>>>
38786>>>>>>>Use CITIES.DD
INCLUDING FILE: CITIES.DD
38786>>>>>>>>>//DDB-FileStart
38786>>>>>>>>>//DDB-HeaderStart
38786>>>>>>>>>
38786>>>>>>>>>// File Name : CITIES.DD
38786>>>>>>>>>// Class Name: Cities_DataDictionary
38786>>>>>>>>>// Revision  : 14
38786>>>>>>>>>// Version   : 2
38786>>>>>>>>>
38786>>>>>>>>>Use  Windows           // Basic Definitions
38786>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
38786>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38786>>>>>>>>>
38786>>>>>>>>>Open Cities
38788>>>>>>>>>Open Clients
38790>>>>>>>>>Open Towns
38792>>>>>>>>>
38792>>>>>>>>>//DDB-HeaderEnd
38792>>>>>>>>>//DDB-SelectionStart
38792>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.SL
38792>>>>>>>>>Register_Object sl198
38792>>>>>>>>>//DDB-SelectionEnd
38792>>>>>>>>>
38792>>>>>>>>>Class Cities_DataDictionary  is a DataDictionary_Sec
38793>>>>>>>>>
38793>>>>>>>>>    // Define_Fields:
38793>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38793>>>>>>>>>
38793>>>>>>>>>    Procedure Define_Fields
38794>>>>>>>>>        Forward Send Define_Fields
38796>>>>>>>>>        //DDB-Generated-Code-Location
38796>>>>>>>>>        //DDB-DefineFieldStart
38796>>>>>>>>>
38796>>>>>>>>>        Set Main_File            To Cities.File_Number
38797>>>>>>>>>        Set Cascade_Delete_State To FALSE
38798>>>>>>>>>
38798>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38799>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38800>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38801>>>>>>>>>
38801>>>>>>>>>        // Child (Client) file structure................
38801>>>>>>>>>        Send Add_Client_File  Clients.File_Number
38802>>>>>>>>>
38802>>>>>>>>>        // Parent (Server) file structure...............
38802>>>>>>>>>        Send Add_Server_File  Towns.File_Number
38803>>>>>>>>>
38803>>>>>>>>>        // Field-based properties.......................
38803>>>>>>>>>
38803>>>>>>>>>        // Cities.City_Id
38803>>>>>>>>>        Set Field_Options          Field Cities.City_Id To DD_AUTOFIND   
38804>>>>>>>>>        Set Field_Prompt_Object    Field Cities.City_Id To (sl198(Self))
38805>>>>>>>>>        Set Key_Field_State        Field Cities.City_Id To TRUE
38806>>>>>>>>>
38806>>>>>>>>>        // Cities.City_Descr
38806>>>>>>>>>        Set Field_Prompt_Object    Field Cities.City_Descr To (sl198(Self))
38807>>>>>>>>>
38807>>>>>>>>>        // Cities.Town_Id
38807>>>>>>>>>
38807>>>>>>>>>        //DDB-DefineFieldEnd
38807>>>>>>>>>    End_Procedure    // Define_Fields
38808>>>>>>>>>
38808>>>>>>>>>    // Field_Defaults:
38808>>>>>>>>>    // This procedure is used to establish default field values.
38808>>>>>>>>>
38808>>>>>>>>>    Procedure Field_Defaults
38809>>>>>>>>>        Forward Send Field_Defaults
38811>>>>>>>>>        //DDB-Generated-Code-Location
38811>>>>>>>>>        //DDB-FieldDefaultStart
38811>>>>>>>>>        //DDB-FieldDefaultEnd
38811>>>>>>>>>    End_Procedure    // Field_Defaults
38812>>>>>>>>>
38812>>>>>>>>>End_Class    // Cities_DataDictionary
38813>>>>>>>>>//DDB-Selection-pkg-Start
38813>>>>>>>>>
38813>>>>>>>>>Use sl198.SL         // sl198
38813>>>>>>>>>
38813>>>>>>>>>//DDB-Selection-pkg-End
38813>>>>>>>>>//DDB-FileEnd
38813>>>>>>>
38813>>>>>>>//AB-IgnoreEnd
38813>>>>>>>
38813>>>>>>>Object sl198 is a dbModalPanelSub
38815>>>>>>>    Set Label to "€¨®œå¦ æ¢œà¤"
38816>>>>>>>    Set Size to 148 297
38817>>>>>>>    Set Location to 4 5
38818>>>>>>>    Set Exit_Application_Local_State to FALSE
38819>>>>>>>    Set Modal_State to FALSE
38820>>>>>>>
38820>>>>>>>    //AB-DDOStart
38820>>>>>>>
38820>>>>>>>    Object Cities_DD is a Cities_DataDictionary
38822>>>>>>>
38822>>>>>>>        //AB-StoreStart
38822>>>>>>>                
38822>>>>>>>                
38822>>>>>>>        //AB-StoreEnd
38822>>>>>>>
38822>>>>>>>    End_Object    // Cities_DD
38823>>>>>>>
38823>>>>>>>    Set Main_DD to (Cities_DD(self))
38824>>>>>>>    Set Server to (Cities_DD(self))
38825>>>>>>>
38825>>>>>>>    //AB-DDOEnd
38825>>>>>>>
38825>>>>>>>    Object oSelList is a dbListSub
38827>>>>>>>        Set Main_File to Cities.File_Number
38828>>>>>>>        Set Size to 105 280
38829>>>>>>>        Set Location to 6 6
38830>>>>>>>
38830>>>>>>>        Begin_Row
38833>>>>>>>            Entry_Item Cities.City_id
38834>>>>>>>            Entry_Item Cities.City_descr
38835>>>>>>>        End_Row
38840>>>>>>>
38840>>>>>>>        Set Form_Width    item 0 to 50
38841>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
38842>>>>>>>        
38842>>>>>>>        Set Form_Width    item 1 to 221
38843>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
38844>>>>>>>        
38844>>>>>>>
38844>>>>>>>        //AB-StoreStart
38844>>>>>>>        
38844>>>>>>>        Set Column_Option Item 0 to NoEnter True
38845>>>>>>>        
38845>>>>>>>        
38845>>>>>>>        
38845>>>>>>>        
38845>>>>>>>        
38845>>>>>>>        //AB-StoreEnd
38845>>>>>>>
38845>>>>>>>    End_Object    // oSelList
38846>>>>>>>
38846>>>>>>>    Object oOK_bn is a ButtonSub
38848>>>>>>>        Set Label to "&„§ ¢¦šã"
38849>>>>>>>        Set Location to 115 126
38850>>>>>>>
38850>>>>>>>        //AB-StoreStart
38850>>>>>>>        Procedure OnClick
38852>>>>>>>            Send OK To (oSelList(current_object))
38853>>>>>>>        End_Procedure
38854>>>>>>>        //AB-StoreEnd
38854>>>>>>>
38854>>>>>>>    End_Object    // oOK_bn
38855>>>>>>>
38855>>>>>>>    Object oCancel_bn is a ButtonSub
38857>>>>>>>        Set Label to "&€¡ç¨à©ž"
38858>>>>>>>        Set Location to 115 181
38859>>>>>>>
38859>>>>>>>        //AB-StoreStart
38859>>>>>>>        Procedure OnClick
38861>>>>>>>            Send Cancel To (oSelList(current_object))
38862>>>>>>>        End_Procedure
38863>>>>>>>        //AB-StoreEnd
38863>>>>>>>
38863>>>>>>>    End_Object    // oCancel_bn
38864>>>>>>>
38864>>>>>>>    Object oSearch_bn is a ButtonSub
38866>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
38867>>>>>>>        Set Location to 115 236
38868>>>>>>>
38868>>>>>>>        //AB-StoreStart
38868>>>>>>>        Procedure OnClick
38870>>>>>>>            Send Search To (oSelList(current_object))
38871>>>>>>>        End_Procedure
38872>>>>>>>        //AB-StoreEnd
38872>>>>>>>
38872>>>>>>>    End_Object    // oSearch_bn
38873>>>>>>>
38873>>>>>>>
38873>>>>>>>    //AB-StoreStart
38873>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
38874>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
38875>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
38876>>>>>>>    //AB-StoreEnd
38876>>>>>>>
38876>>>>>>>End_Object    // sl198
38877>>>>>>>
38877>>>>>>>//AB/ End_Object    // prj
38877>>>>>Use sl197.SL         // sl197
38877>>>>>
38877>>>>>//DDB-Selection-pkg-End
38877>>>>>//DDB-FileEnd
38877>>>    Use cities.DD
38877>>>    Use clients.DD
INCLUDING FILE: CLIENTS.DD
38877>>>>>//DDB-FileStart
38877>>>>>//DDB-HeaderStart
38877>>>>>
38877>>>>>// File Name : CLIENTS.DD
38877>>>>>// Class Name: Clients_DataDictionary
38877>>>>>// Revision  : 241
38877>>>>>// Version   : 2
38877>>>>>
38877>>>>>Use  Windows           // Basic Definitions
38877>>>>>Use  DataDict          // DataDictionary Class Definition
38877>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38877>>>>>
38877>>>>>Open Clients
38879>>>>>Open Cmoves
INCLUDING FILE: CMOVES.FD
38881>>>>>Open Particle
INCLUDING FILE: PARTICLE.FD
38883>>>>>Open Cmovesa
INCLUDING FILE: CMOVESA.FD
38885>>>>>Open Cn
38887>>>>>Open Particll
INCLUDING FILE: PARTICLL.FD
38889>>>>>Open Clnbank
INCLUDING FILE: CLNBANK.FD
38891>>>>>Open Tpclient
INCLUDING FILE: TPCLIENT.FD
38893>>>>>Open Clorder
INCLUDING FILE: CLORDER.FD
38895>>>>>Open Clitem
INCLUDING FILE: CLITEM.FD
38897>>>>>Open Cities
38899>>>>>Open Areas
38901>>>>>Open Payresp
38903>>>>>Open Syscurxr
38905>>>>>Open Sysrecc
38907>>>>>Open Ptypparl
38909>>>>>Open Gmove
38911>>>>>Open Sysrecg
38913>>>>>
38913>>>>>//DDB-HeaderEnd
38913>>>>>//DDB-ValidationStart
38913>>>>>
38913>>>>>Register_Object Clients_Client_Doy_VT
38913>>>>>Register_Object Clients_Client_Job_VT
38913>>>>>Register_Object Clients_Client_Categfpa_VT
38913>>>>>Register_Object Clients_Client_Catjob_VT1
38913>>>>>Register_Object Clients_Client_Idiot_VT
38913>>>>>Register_Object Clients_Feregios_VT
38913>>>>>
38913>>>>>Object Clients_Client_Doy_VT  is a CodeValidationTable
38915>>>>>    Set Type_Value        To "DOY"
38916>>>>>    Set Validate_State    To FALSE
38917>>>>>    Set Allow_Blank_State To TRUE
38918>>>>>    Set Table_Title       To "ƒ.Ž.“"
38919>>>>>    //DDB-ValidationCustomStart
38919>>>>>    //DDB-ValidationCustomEnd
38919>>>>>End_Object   // Clients_Client_Doy_VT
38920>>>>>
38920>>>>>Object Clients_Client_Job_VT  is a CodeValidationTable
38922>>>>>    Set Type_Value        To "JOB"
38923>>>>>    Set Validate_State    To FALSE
38924>>>>>    Set Allow_Blank_State To TRUE
38925>>>>>    Set Table_Title       To "„§˜ššâ¢£˜«˜"
38926>>>>>    //DDB-ValidationCustomStart
38926>>>>>    //DDB-ValidationCustomEnd
38926>>>>>End_Object   // Clients_Client_Job_VT
38927>>>>>
38927>>>>>Object Clients_Client_Categfpa_VT  is a CodeValidationTable
38929>>>>>    Set Type_Value        To "VAT_STATUS"
38930>>>>>    Set Validate_State    To FALSE
38931>>>>>    Set Allow_Blank_State To TRUE
38932>>>>>    //DDB-ValidationCustomStart
38932>>>>>    //DDB-ValidationCustomEnd
38932>>>>>End_Object   // Clients_Client_Categfpa_VT
38933>>>>>
38933>>>>>Object Clients_Client_Catjob_VT1  is a CodeValidationTable
38935>>>>>    Set Type_Value        To "JOB"
38936>>>>>    Set Validate_State    To FALSE
38937>>>>>    Set Allow_Blank_State To TRUE
38938>>>>>    //DDB-ValidationCustomStart
38938>>>>>    //DDB-ValidationCustomEnd
38938>>>>>End_Object   // Clients_Client_Catjob_VT1
38939>>>>>
38939>>>>>Object Clients_Client_Idiot_VT  is a CodeValidationTable
38941>>>>>    Set Type_Value        To "IDIOT"
38942>>>>>    Set Validate_State    To FALSE
38943>>>>>    Set Allow_Blank_State To TRUE
38944>>>>>    Set Table_Title       To "€¨®œå¦ ˆ› ¦«ã«à¤"
38945>>>>>    //DDB-ValidationCustomStart
38945>>>>>    //DDB-ValidationCustomEnd
38945>>>>>End_Object   // Clients_Client_Idiot_VT
38946>>>>>
38946>>>>>Object Clients_Feregios_VT  is a CodeValidationTable
38948>>>>>    Set Type_Value        To "FEREGIOS"
38949>>>>>    Set Allow_Blank_State To TRUE
38950>>>>>    Set Table_Title       To "ƒœå¡«œª ”œ¨œšš¬æ«ž«˜ª ”¦¨âà¤"
38951>>>>>    //DDB-ValidationCustomStart
38951>>>>>    //DDB-ValidationCustomEnd
38951>>>>>End_Object   // Clients_Feregios_VT
38952>>>>>//DDB-ValidationEnd
38952>>>>>//DDB-SelectionStart
38952>>>>>//DDB/ ExternalSelectionList sl100  sl100.SL
38952>>>>>Register_Object sl100
38952>>>>>//DDB-SelectionEnd
38952>>>>>Open Sysfile
38954>>>>>open year
38956>>>>>
38956>>>>>Class Clients_DataDictionary  is a DataDictionary_Sec
38957>>>>>
38957>>>>>    Procedure Construct_Object
38958>>>>>        Forward Send Construct_Object
38960>>>>>        Property Integer piMustNOTConstrain Public 0
38961>>>>>        Property Integer piCheckPlaf        Public 0
38962>>>>>        //------------------------------------------------
38962>>>>>        // Properties gia na kraththoun oi palies times
38962>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio
38962>>>>>        // einai 1     js 03/12/2007
38962>>>>>        //------------------------------------------------
38962>>>>>        Property Integer piCreateNew            Public  0
38963>>>>>        Property String  psAud_Old_Pelaths      Public ""
38964>>>>>        Property String  psAud_Old_PelathsN     Public ""
38965>>>>>        Property String  psAud_Old_AFM          Public ""
38966>>>>>        Property String  psAud_Old_DOY          Public ""
38967>>>>>        Property String  psAud_Old_DOYN         Public ""
38968>>>>>        Property Integer piAud_Old_HPAL         Public  0
38969>>>>>        Property Integer piAud_Old_HPSO         Public  0
38970>>>>>        Property String  psAud_Old_PartlRecr    Public ""
38971>>>>>        Property String  psAud_Old_PmsRecr      Public ""
38972>>>>>        //------------------------------------------------
38972>>>>>
38972>>>>>    End_Procedure
38973>>>>>
38973>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
38974>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
38976>>>>>        //------------------------------------------------
38976>>>>>        // Properties gia na kraththoun oi palies times
38976>>>>>        // ton pedion js 03/12/2007
38976>>>>>        //------------------------------------------------
38976>>>>>        Set psAud_Old_Pelaths      to Clients.Client_ID
38977>>>>>        Set psAud_Old_PelathsN     to Clients.Client_Name
38978>>>>>        Set psAud_Old_AFM          to Clients.Client_AFM
38979>>>>>        Set psAud_Old_DOY          to Clients.Client_Doy
38980>>>>>        Set psAud_Old_DOYN         to (gsfCode_Mast("DOY",Clients.Client_Doy))
38981>>>>>        Set piAud_Old_HPAL         to Clients.HPAL
38982>>>>>        Set piAud_Old_HPSO         to Clients.HPSO
38983>>>>>        Set psAud_Old_PartlRecr    to Clients.Client_Recr
38984>>>>>        Set psAud_Old_PmsRecr      to Clients.Client_Recr
38985>>>>>        //------------------------------------------------
38985>>>>>     End_Procedure   // New_Current_Record
38986>>>>>
38986>>>>>
38986>>>>>    // Backout:
38986>>>>>    Procedure Backout
38987>>>>>        Forward Send Backout
38989>>>>>        // Insert Code Here
38989>>>>>    End_Procedure   // Backout
38990>>>>>
38990>>>>>    Procedure Delete_Main_File
38991>>>>>        //---------------------------------------------
38991>>>>>        // Auditing / Katagrafh allagon
38991>>>>>        String  sUser sText sTime sMin sHour sSec
38992>>>>>        Date    dDate  Shmer
38992>>>>>        Integer iMin iHour iSec iLen
38992>>>>>        Sysdate dDate iHour iMin iSec
38996>>>>>        Move iHour  to sHour
38997>>>>>        Move iMin   to sMin
38998>>>>>        Move iSec   to sSec
38999>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
39003>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
39007>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
39011>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
39012>>>>>
39012>>>>>        // Auditing / Diagrafh
39012>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
39014>>>>>            Get fsLoginUserID to sUser
39015>>>>>            clear gmove
39016>>>>>            move syscurxr.company_code  to gmove.company_code
39017>>>>>            move syscurxr.branch_code   to gmove.branch_code
39018>>>>>            move syscurxr.year_year     to gmove.year_year
39019>>>>>            move  2                     to gmove.gtypkin_code// Apo Clients
39020>>>>>            move ddate                  to gmove.garticl_hmnia
39021>>>>>            move suser                  to gmove.gplan_code
39022>>>>>            move Clients.Client_Recr    to gmove.garticl_recr
39023>>>>>            reread sysrecg
39027>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
39028>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
39029>>>>>            saverecord sysrecg
39030>>>>>            unlock
39031>>>>>>
39031>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
39032>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
39033>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs
39034>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
39035>>>>>
39035>>>>>            Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
39036>>>>>            Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
39037>>>>>            Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
39038>>>>>            Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy
39039>>>>>            Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
39040>>>>>            Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
39041>>>>>            Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
39042>>>>>
39042>>>>>
39042>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª œ¢á«ž"     to gmove.gmove_aitiol
39043>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
39044>>>>>            saverecord gmove
39045>>>>>        End
39045>>>>>>
39045>>>>>
39045>>>>>        Forward Send Delete_Main_File
39047>>>>>
39047>>>>>    End_Procedure
39048>>>>>
39048>>>>>
39048>>>>>    Procedure Update
39049>>>>>        Forward Send Update
39051>>>>>        // Insert Code Here
39051>>>>>        Move SysCurXR.Company_Code  to Clients.Company_Code
39052>>>>>        Move SysCurXR.Branch_Code   to Clients.Branch_Code
39053>>>>>        Move SysCurXR.Year_Year     to Clients.Year_Year
39054>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
39054>>>>>        Move (Clients.Xreosh-Clients.Pistosh)   to Clients.Ypoloipo
39055>>>>>        Move (Clients.Plafon-Clients.Ypoloipo)  to Clients.Overhead
39056>>>>>
39056>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
39056>>>>>
39056>>>>>        //betolink
39056>>>>>        Move SysCurXR.Beto_Site      to Clients.Client_SiteW
39057>>>>>        Move Clients.Client_Rec0     to Clients.Client_SN
39058>>>>>        Move Clients.Client_id       to Clients.Client_Repm
39059>>>>>        Move Clients.Company_Code    to Clients.CLIENT_COMPANY
39060>>>>>        Move Clients.Client_id       to Clients.Client_RepMatch
39061>>>>>     //   Move (gsfCode_Mast('JOB',Clients.Client_CatJob)) to Clients.Client_Job             
39061>>>>>     
39061>>>>>     
39061>>>>>        //---------------------------------------------
39061>>>>>        // Auditing / Katagrafh allagon
39061>>>>>        String  sUser sText sTime sMin sHour sSec
39062>>>>>        Date    dDate  Shmer 
39062>>>>>        Integer iMin iHour iSec iLen
39062>>>>>        Sysdate dDate iHour iMin iSec 
39066>>>>>        Move iHour  to sHour
39067>>>>>        Move iMin   to sMin
39068>>>>>        Move iSec   to sSec
39069>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
39073>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
39077>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
39081>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
39082>>>>>        
39082>>>>>        // Auditing / Dhmiourgia - Diorthosh
39082>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
39084>>>>>            Get fsLoginUserID to sUser
39085>>>>>            If (piCreateNew(Self)=1) Begin
39087>>>>>                clear gmove
39088>>>>>                move syscurxr.company_code  to gmove.company_code
39089>>>>>                move syscurxr.branch_code   to gmove.branch_code
39090>>>>>                move syscurxr.year_year     to gmove.year_year
39091>>>>>                move  2                     to gmove.gtypkin_code// Apo Clients
39092>>>>>                move ddate                  to gmove.garticl_hmnia
39093>>>>>                move suser                  to gmove.gplan_code
39094>>>>>                move Clients.Client_Recr    to gmove.garticl_recr
39095>>>>>                reread sysrecg
39099>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
39100>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
39101>>>>>                saverecord sysrecg
39102>>>>>                unlock
39103>>>>>>
39103>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
39104>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
39105>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
39106>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
39107>>>>>                Move Clients.Client_ID              to Gmove.Cur_ID
39108>>>>>                Move Clients.CLient_Name            to Gmove.Cur_Name
39109>>>>>                Move Clients.Client_Recr            to Gmove.Partl_Recr 
39110>>>>>                Move Clients.Client_Recr            to Gmove.Pms_Recr  
39111>>>>>                Move Clients.Client_AFM             to Gmove.Cur_AFM
39112>>>>>                Move Clients.Client_DOY             to Gmove.Cur_DOY
39113>>>>>                Move (gsfCode_Mast("DOY",Clients.Client_Doy)) to Gmove.Txt4
39114>>>>>                Move Clients.HPAL                   to Gmove.Prev_Stoxos1
39115>>>>>                Move Clients.HPSO                   to Gmove.Prev_Stoxos2
39116>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â¦¬ œ¢á«ž"       to Gmove.Gmove_Aitiol
39117>>>>>                Move "N" to Gmove.Eidos_Metabolhs
39118>>>>>                saverecord gmove
39119>>>>>                Set piCreateNew to 0
39120>>>>>            End
39120>>>>>>
39120>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
39123>>>>>                Integer isChanged
39123>>>>>                Move 0 to isChanged
39124>>>>>                
39124>>>>>                     If (psAud_Old_Pelaths  (Self)<>Clients.Client_ID   ) Move 1 to isChanged
39127>>>>>                Else If (psAud_Old_PelathsN (Self)<>Clients.Client_Name ) Move 1 to isChanged
39131>>>>>                Else If (psAud_Old_AFM      (Self)<>Clients.Client_AFM  ) Move 1 to isChanged
39135>>>>>                Else If (psAud_Old_DOY      (Self)<>Clients.Client_DOY  ) Move 1 to isChanged
39139>>>>>                Else If (piAud_Old_HPAL     (Self)<>Clients.HPAL        ) Move 1 to isChanged
39143>>>>>                Else If (piAud_Old_HPSO     (Self)<>Clients.HPSO        ) Move 1 to isChanged
39147>>>>>                
39147>>>>>                If (isChanged>0) Begin  
39149>>>>>                    clear gmove
39150>>>>>                    move syscurxr.company_code  to gmove.company_code
39151>>>>>                    move syscurxr.branch_code   to gmove.branch_code
39152>>>>>                    move syscurxr.year_year     to gmove.year_year
39153>>>>>                    move  2                     to gmove.gtypkin_code// Apo Clients
39154>>>>>                    move ddate                  to gmove.garticl_hmnia
39155>>>>>                    move suser                  to gmove.gplan_code
39156>>>>>                    move Clients.Client_Recr    to gmove.garticl_recr
39157>>>>>                    reread sysrecg
39161>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
39162>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
39163>>>>>                    saverecord sysrecg
39164>>>>>                    unlock
39165>>>>>>
39165>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
39166>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
39167>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
39168>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
39169>>>>>                    Move Clients.Client_Recr            to Gmove.Partl_Recr 
39170>>>>>                    Move Clients.Client_Recr            to Gmove.Pms_Recr  
39171>>>>>                    //--
39171>>>>>                    Move Clients.Client_ID              to Gmove.Cur_ID
39172>>>>>                    Move Clients.CLient_Name            to Gmove.Cur_Name
39173>>>>>                    Move Clients.Client_AFM             to Gmove.Cur_AFM
39174>>>>>                    Move Clients.Client_DOY             to Gmove.Cur_DOY
39175>>>>>                    Move (gsfCode_Mast("DOY",Clients.Client_Doy)) to Gmove.Txt4
39176>>>>>                    Move Clients.HPAL                   to Gmove.Cur_Stoxos1
39177>>>>>                    Move Clients.HPSO                   to Gmove.Cur_Stoxos2
39178>>>>>                    //--
39178>>>>>                    Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
39179>>>>>                    Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
39180>>>>>                    Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
39181>>>>>                    Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy 
39182>>>>>                    Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
39183>>>>>                    Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
39184>>>>>                    Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
39185>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª œ¢á«ž"     to gmove.gmove_aitiol
39186>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
39187>>>>>                    saverecord gmove
39188>>>>>                    Set piCreateNew to 0
39189>>>>>                End
39189>>>>>>
39189>>>>>            End
39189>>>>>>
39189>>>>>        End
39189>>>>>>
39189>>>>>
39189>>>>>     
39189>>>>>    End_Procedure   // Update
39190>>>>>
39190>>>>>
39190>>>>>    Procedure Creating
39191>>>>>        date ddate iYes
39192>>>>>        Forward Send Creating
39194>>>>>        // Insert Code Here
39194>>>>>
39194>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Clients.Client_Rec0))))));                                    to Clients.Client_Recr
39195>>>>>        Move '1'                    to Clients.Client_Active
39196>>>>>        get fsgCode_With_Zeroes Clients.Client_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Clients.Client_ID
39197>>>>>        sysdate4 ddate
39198>>>>>        move ddate                  to Clients.Client_Hmnia    
39199>>>>>        Set piCreateNew to 1
39200>>>>>    End_Procedure   // Creating
39201>>>>>
39201>>>>>    Function Validate_Save  Returns Integer
39202>>>>>        Integer iReturnVal iCheck iYes
39203>>>>>        Forward Get Validate_Save  To iReturnVal
39205>>>>>        If (Not(iReturnVal)) Begin
39207>>>>>
39207>>>>>            If (clients.is_eksoter <> '1') begin
39209>>>>>                If (Clients.Is_Xondr='1') Begin
39211>>>>>                    If (Sysfile.Check_Afm=1) Begin
39213>>>>>                        Move (Check_AFM(Clients.Client_Afm)) to iCheck
39214>>>>>                        If (iCheck) Begin
39216>>>>>                                 If (iCheck=1) Move 4001 to iReturnVal
39219>>>>>                            Else If (iCheck=2) Move 4002 to iReturnVal
39223>>>>>                            Else If (iCheck=3) Move 4003 to iReturnVal
39227>>>>>                        End
39227>>>>>>
39227>>>>>                    End
39227>>>>>>
39227>>>>>                End
39227>>>>>>
39227>>>>>            End
39227>>>>>>
39227>>>>>
39227>>>>>            If (piCheckPlaf(Self)=1) Begin
39229>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Dap)>Clients.Plafon)) Begin
39231>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4000 Clients' to iYes
39232>>>>>                    If (iYes=MBR_NO) Error 4004 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž' //Move 4004 to iReturnVal
39235>>>>>                End
39235>>>>>>
39235>>>>>                Else If ((PayResp.Plafon<>0) And (PayResp.Plafon<=PayResp.Synolikh_Ofeilh)) Begin
39238>>>>>                    Get YesNo_Box 'Ž ¬§œçŸ¬¤¦ª §¢ž¨à£ãª ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž\nŒ˜ ©¬¤œ®å©à ©«ž¤ ›ž£ ¦¬¨šå˜ œšš¨˜­ãª §œ¢á«ž;' to iYes
39239>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
39242>>>>>                End
39242>>>>>>
39242>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Clients.Orio_Syn_Ofeilh)) Begin
39245>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4001 Clients' to iYes
39246>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
39249>>>>>                End
39249>>>>>>
39249>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (PayResp.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Payresp.Orio_Syn_Ofeilh)) Begin
39252>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4002 Clients' to iYes
39253>>>>>                    If (iYes=MBR_NO) Error 4006 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'   //Move 4006 to iReturnVal
39256>>>>>                End
39256>>>>>>
39256>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Parag)>Clients.Plafon)) Begin
39258>>>>>                    Send Info_Box '’˜ §¦©á «à¤ ž£œ¨ž©åà¤ §˜¨˜ššœ¢ é¤\n¬§œ¨™˜å¤¦¬¤ «¦ › ˜Ÿâ© £¦ ¬§æ¢¦ §¦\n™á©ž §¢˜­æ¤ «¦¬ §œ¢á«ž' '¨¦©¦®ã !!!'
39259>>>>>                End
39259>>>>>>
39259>>>>>            End
39259>>>>>>
39259>>>>>
39259>>>>>            If (iReturnVal) Begin
39261>>>>>                Send Operation_Not_Allowed iReturnVal
39262>>>>>            End
39262>>>>>>
39262>>>>>        End
39262>>>>>>
39262>>>>>        Function_Return iReturnVal
39263>>>>>    End_Function   // Validate_Save
39264>>>>>
39264>>>>>
39264>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
39265>>>>>        String lsError_Message
39266>>>>>
39266>>>>>        Case Begin
39266>>>>>            Case (iError_Num = 4001)
39268>>>>>                Move "DDC 100: Š˜¤Ÿ˜©£â¤¦ €”‹ œ¢á«ž" ;                    to lsError_Message
39269>>>>>              Case Break
39270>>>>>            Case (iError_Num = 4002)
39273>>>>>                Move "DDC 100: ’¦ €”‹ œ¢á«ž ›œ¤ œå¤˜  9 ¯ã­ ¦" ;                    to lsError_Message
39274>>>>>              Case Break
39275>>>>>            Case (iError_Num = 4003)
39278>>>>>                Move "DDC 100: €¡˜«á¢¢ž¢¦ª ®˜¨˜¡«ã¨˜ª ©«¦ €”‹ œ¢á«ž" ;                    to lsError_Message
39279>>>>>              Case Break
39280>>>>>            Case (iError_Num = 4004)
39283>>>>>                Move "DDC 100: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ §œ¢á«ž" ;                    to lsError_Message
39284>>>>>              Case Break
39285>>>>>            Case (iError_Num = 4005)
39288>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª" ;                    to lsError_Message
39289>>>>>              Case Break
39290>>>>>            Case (iError_Num = 4006)
39293>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª «¦¬ “§œ¬Ÿç¤¦¬" ;                    to lsError_Message
39294>>>>>              Case Break
39295>>>>>
39295>>>>>            Case Else
39295>>>>>                Forward Send Operation_Not_Allowed iError_Num
39297>>>>>        Case End
39297>>>>>
39297>>>>>        Error iError_Num lsError_Message
39298>>>>>>
39298>>>>>    End_Procedure // operation_not_allowed
39299>>>>>
39299>>>>>
39299>>>>>    // Define_Fields:
39299>>>>>    // This procedure is used to set up all data-dictionary rules.
39299>>>>>
39299>>>>>    Procedure Define_Fields
39300>>>>>        Forward Send Define_Fields
39302>>>>>        //DDB-Generated-Code-Location
39302>>>>>        //DDB-DefineFieldStart
39302>>>>>
39302>>>>>        Set Main_File            To Clients.File_Number
39303>>>>>        Set Cascade_Delete_State To FALSE
39304>>>>>
39304>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39305>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39306>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39307>>>>>
39307>>>>>        // Child (Client) file structure................
39307>>>>>        Send Add_Client_File  Cmoves.File_Number
39308>>>>>        Send Add_Client_File  Particle.File_Number
39309>>>>>        Send Add_Client_File  Cmovesa.File_Number
39310>>>>>        Send Add_Client_File  Cn.File_Number
39311>>>>>        Send Add_Client_File  Particll.File_Number
39312>>>>>        Send Add_Client_File  Clnbank.File_Number
39313>>>>>        Send Add_Client_File  Tpclient.File_Number
39314>>>>>        Send Add_Client_File  Clorder.File_Number
39315>>>>>        Send Add_Client_File  Clitem.File_Number
39316>>>>>
39316>>>>>        // Parent (Server) file structure...............
39316>>>>>        Send Add_Server_File  Cities.File_Number
39317>>>>>        Send Add_Server_File  Areas.File_Number
39318>>>>>        Send Add_Server_File  Payresp.File_Number
39319>>>>>
39319>>>>>        // External (System) file structure.............
39319>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
39320>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
39321>>>>>        Send Add_System_File  Ptypparl.File_Number  DD_LOCK_ON_ALL
39322>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
39323>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
39324>>>>>
39324>>>>>        Define_Auto_Increment  Sysrecc.Client_Rec0  To Clients.Client_Rec0
39327>>>>>
39327>>>>>        // Field-based properties.......................
39327>>>>>
39327>>>>>        // Clients.Company_Code
39327>>>>>
39327>>>>>        // Clients.Branch_Code
39327>>>>>
39327>>>>>        // Clients.Year_Year
39327>>>>>
39327>>>>>        // Clients.Custprom_Code
39327>>>>>
39327>>>>>        // Clients.Client_Id
39327>>>>>        Set Field_Options          Field Clients.Client_Id To DD_AUTOFIND    DD_NOPUT      
39328>>>>>        Set Field_Prompt_Object    Field Clients.Client_Id To (sl100(Self))
39329>>>>>        Set Key_Field_State        Field Clients.Client_Id To TRUE
39330>>>>>
39330>>>>>        // Clients.Client_Name
39330>>>>>        Set Field_Prompt_Object    Field Clients.Client_Name To (sl100(Self))
39331>>>>>
39331>>>>>        // Clients.Client_Afm
39331>>>>>        Set Field_Options          Field Clients.Client_Afm To DD_AUTOFIND   
39332>>>>>
39332>>>>>        // Clients.Client_Rec0
39332>>>>>        Set Field_Options          Field Clients.Client_Rec0 To DD_AUTOFIND   
39333>>>>>
39333>>>>>        // Clients.Custprom_Recr
39333>>>>>
39333>>>>>        // Clients.Client_Recr
39333>>>>>        Set Field_Options          Field Clients.Client_Recr To DD_AUTOFIND   
39334>>>>>
39334>>>>>        // Clients.Last_Xreosh
39334>>>>>
39334>>>>>        // Clients.Last_Pistosh
39334>>>>>
39334>>>>>        // Clients.Last_Order
39334>>>>>        Set Field_Class_Name       Field Clients.Last_Order To "dbComboFormSub"
39335>>>>>
39335>>>>>        // Clients.Client_Doy
39335>>>>>        Set Field_Value_Table      Field Clients.Client_Doy To (Clients_Client_Doy_VT(Self))
39336>>>>>
39336>>>>>        // Clients.Client_Address
39336>>>>>
39336>>>>>        // Clients.Client_City_Id
39336>>>>>
39336>>>>>        // Clients.Client_Area
39336>>>>>
39336>>>>>        // Clients.Client_Job
39336>>>>>        Set Field_Value_Table      Field Clients.Client_Job To (Clients_Client_Job_VT(Self))
39337>>>>>
39337>>>>>        // Clients.Client_Respons
39337>>>>>
39337>>>>>        // Clients.Client_Zipcode
39337>>>>>
39337>>>>>        // Clients.Client_Phone
39337>>>>>
39337>>>>>        // Clients.Client_Fax
39337>>>>>
39337>>>>>        // Clients.Client_Mobile
39337>>>>>
39337>>>>>        // Clients.Client_Aoh
39337>>>>>
39337>>>>>        // Clients.Client_Email
39337>>>>>
39337>>>>>        // Clients.Client_Class
39337>>>>>
39337>>>>>        // Clients.Client_Details
39337>>>>>
39337>>>>>        // Clients.Client_Sitew
39337>>>>>
39337>>>>>        // Clients.Client_Codem
39337>>>>>
39337>>>>>        // Clients.Client_Categfpa
39337>>>>>        Set Field_Value_Table      Field Clients.Client_Categfpa To (Clients_Client_Categfpa_VT(Self))
39338>>>>>
39338>>>>>        // Clients.Client_Fpa
39338>>>>>
39338>>>>>        // Clients.Client_Public
39338>>>>>
39338>>>>>        // Clients.Client_Sn
39338>>>>>
39338>>>>>        // Clients.Client_Repm
39338>>>>>
39338>>>>>        // Clients.Client_Active
39338>>>>>
39338>>>>>        // Clients.Client_Reported
39338>>>>>
39338>>>>>        // Clients.Client_Pelprom
39338>>>>>
39338>>>>>        // Clients.Client_Lastupd
39338>>>>>
39338>>>>>        // Clients.Client_Markexp
39338>>>>>
39338>>>>>        // Clients.Client_Catjob
39338>>>>>        Set Field_Value_Table      Field Clients.Client_Catjob To (Clients_Client_Catjob_VT1(Self))
39339>>>>>
39339>>>>>        // Clients.Is_Promhtheyths
39339>>>>>
39339>>>>>        // Clients.Xreosh
39339>>>>>
39339>>>>>        // Clients.Pistosh
39339>>>>>
39339>>>>>        // Clients.Ypoloipo
39339>>>>>
39339>>>>>        // Clients.Plafon
39339>>>>>
39339>>>>>        // Clients.Overhead
39339>>>>>
39339>>>>>        // Clients.Client_Company
39339>>>>>
39339>>>>>        // Clients.Client_Repmatch
39339>>>>>
39339>>>>>        // Clients.Client_Hmnia
39339>>>>>
39339>>>>>        // Clients.Client_Presp
39339>>>>>
39339>>>>>        // Clients.Client_Locked
39339>>>>>
39339>>>>>        // Clients.Synolikh_Ofeilh
39339>>>>>
39339>>>>>        // Clients.Client_Idiot
39339>>>>>        Set Field_Value_Table      Field Clients.Client_Idiot To (Clients_Client_Idiot_VT(Self))
39340>>>>>
39340>>>>>        // Clients.Client_Add_No
39340>>>>>
39340>>>>>        // Clients.Client_Nomos
39340>>>>>
39340>>>>>        // Clients.Client_Xora
39340>>>>>
39340>>>>>        // Clients.Polh_Recr
39340>>>>>
39340>>>>>        // Clients.Presp_Id
39340>>>>>
39340>>>>>        // Clients.Sum_Pct_Tpcl
39340>>>>>
39340>>>>>        // Clients.Is_Client
39340>>>>>
39340>>>>>        // Clients.Sysxetish
39340>>>>>
39340>>>>>        // Clients.Poso_Se_Apait
39340>>>>>
39340>>>>>        // Clients.Client_Glcode
39340>>>>>
39340>>>>>        // Clients.Is_Eksoter
39340>>>>>
39340>>>>>        // Clients.Is_Xondr
39340>>>>>
39340>>>>>        // Clients.Orio_Syn_Ofeilh
39340>>>>>
39340>>>>>        // Clients.Posa_Apo_Dap
39340>>>>>
39340>>>>>        // Clients.Client_Doybtm
39340>>>>>
39340>>>>>        // Clients.Posa_Apo_Parag
39340>>>>>
39340>>>>>        // Clients.Client_Ptyppar
39340>>>>>
39340>>>>>        // Clients.Client_Seira
39340>>>>>
39340>>>>>        // Clients.Hpso
39340>>>>>
39340>>>>>        // Clients.Hpal
39340>>>>>
39340>>>>>        // Clients.Feregios
39340>>>>>        Set Field_Value_Table      Field Clients.Feregios To (Clients_Feregios_VT(Self))
39341>>>>>
39341>>>>>        // Clients.Diakin
39341>>>>>
39341>>>>>        // Clients.Status
39341>>>>>
39341>>>>>        // Clients.Anal
39341>>>>>
39341>>>>>        // Clients.Endoomil
39341>>>>>
39341>>>>>        // Clients.Npdd
39341>>>>>
39341>>>>>        // Clients.Sap_Hmnia
39341>>>>>
39341>>>>>        //DDB-DefineFieldEnd
39341>>>>>    End_Procedure    // Define_Fields
39342>>>>>
39342>>>>>    // Field_Defaults:
39342>>>>>    // This procedure is used to establish default field values.
39342>>>>>
39342>>>>>    Procedure Field_Defaults
39343>>>>>        Forward Send Field_Defaults
39345>>>>>        //DDB-Generated-Code-Location
39345>>>>>        //DDB-FieldDefaultStart
39345>>>>>        Set Field_Changed_Value   Field Clients.Client_Doy To "0"
39346>>>>>        //DDB-FieldDefaultEnd
39346>>>>>    End_Procedure    // Field_Defaults
39347>>>>>
39347>>>>>End_Class    // Clients_DataDictionary
39348>>>>>//DDB-Selection-pkg-Start
39348>>>>>
39348>>>>>Use sl100.SL         // sl100
INCLUDING FILE: SL100.SL
39348>>>>>>>//AB/ Project SL100:PELATES
39348>>>>>>>//AB/     Object prj is a Lookup_Project
39348>>>>>>>//AB/         Set ProjectName to "SL100:PELATES"
39348>>>>>>>//AB/         Set ProjectFileName to "SL100.SL"
39348>>>>>>>
39348>>>>>>>// Project Object Structure
39348>>>>>>>//   sl100 is a dbModalPanelSub
39348>>>>>>>//     Clients_DD is a DataDictionary
39348>>>>>>>//     oSelList is a dbListSub
39348>>>>>>>//     oOK_bn is a ButtonSub
39348>>>>>>>//     oCancel_bn is a ButtonSub
39348>>>>>>>//     oSearch_bn is a ButtonSub
39348>>>>>>>
39348>>>>>>>// Register all objects
39348>>>>>>>Register_Object Clients_DD
39348>>>>>>>Register_Object oCancel_bn
39348>>>>>>>Register_Object oOK_bn
39348>>>>>>>Register_Object oSearch_bn
39348>>>>>>>Register_Object oSelList
39348>>>>>>>Register_Object sl100
39348>>>>>>>
39348>>>>>>>
39348>>>>>>>    //AB-IgnoreStart
39348>>>>>>>
39348>>>>>>>    Use DFAllEnt.pkg
39348>>>>>>>    Use dbList.Sub
39348>>>>>>>    Use Button.Sub
39348>>>>>>>
39348>>>>>>>
39348>>>>>>>    Use CLIENTS.DD
39348>>>>>>>    
39348>>>>>>>    //AB-IgnoreEnd
39348>>>>>>>
39348>>>>>>>    Object sl100 is a dbModalPanelSub
39350>>>>>>>
39350>>>>>>>        //AB-StoreTopStart
39350>>>>>>>                
39350>>>>>>>        Property String     FragmaClient        Public ''
39352>>>>>>>        Property String     psIsPromhtheyths    Public ''
39354>>>>>>>        Property Integer    piMustConstrain     Public  0
39356>>>>>>>        Property String     psModule            Public ''
39358>>>>>>>        
39358>>>>>>>        //AB-StoreTopEnd
39358>>>>>>>
39358>>>>>>>        Set Label to "(Xlate(Label(Self)))"
39359>>>>>>>        Set Size to 252 509
39360>>>>>>>        Set Location to 4 5
39361>>>>>>>
39361>>>>>>>        //AB-DDOStart
39361>>>>>>>
39361>>>>>>>        Object Clients_DD is a Clients_DataDictionary
39363>>>>>>>
39363>>>>>>>            //AB-StoreTopStart
39363>>>>>>>                                                        
39363>>>>>>>            //AB-StoreTopEnd
39363>>>>>>>
39363>>>>>>>
39363>>>>>>>            //AB-StoreStart
39363>>>>>>>                                                        
39363>>>>>>>            Begin_Constraints
39365>>>>>>>                     If (psModule(Self)='01') BEGIN
39367>>>>>>>                        Constrain Clients.is_Client        Eq '1'
39369>>>>>>>                     end
39369>>>>>>>>
39369>>>>>>>                     Else If (psModule(Self)='02') begin
39372>>>>>>>                        Constrain Clients.is_Promhtheyths  Eq '1'
39374>>>>>>>                     end
39374>>>>>>>>
39374>>>>>>>            End_Constraints
39377>>>>>>>            
39377>>>>>>>            
39377>>>>>>>            
39377>>>>>>>            
39377>>>>>>>            
39377>>>>>>>            //AB-StoreEnd
39377>>>>>>>
39377>>>>>>>        End_Object    // Clients_DD
39378>>>>>>>
39378>>>>>>>        Set Main_DD to (Clients_DD(self))
39379>>>>>>>        Set Server to (Clients_DD(self))
39380>>>>>>>
39380>>>>>>>        //AB-DDOEnd
39380>>>>>>>
39380>>>>>>>        Object oSelList is a dbListSub
39382>>>>>>>            Set Main_File to Clients.File_Number
39383>>>>>>>            Set Size to 204 496
39384>>>>>>>            Set Location to 7 5
39385>>>>>>>            Set Auto_Index_State to FALSE
39386>>>>>>>
39386>>>>>>>            Begin_Row
39389>>>>>>>                Entry_Item Clients.Client_id
39390>>>>>>>                Entry_Item Clients.Client_name
39391>>>>>>>                Entry_Item Clients.Client_afm
39392>>>>>>>                Entry_Item Clients.Last_xreosh
39393>>>>>>>                Entry_Item Clients.Last_pistosh
39394>>>>>>>                Entry_Item Clients.Client_codem
39395>>>>>>>                Entry_Item Clients.Is_client
39396>>>>>>>                Entry_Item Clients.Is_promhtheyths
39397>>>>>>>            End_Row
39402>>>>>>>
39402>>>>>>>            Set Form_Width    item 0 to 64
39403>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
39404>>>>>>>            
39404>>>>>>>            Set Form_Width    item 1 to 133
39405>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
39406>>>>>>>            
39406>>>>>>>            Set Form_Width    item 2 to 62
39407>>>>>>>            Set Header_Label  item 2 to "€”‹"
39408>>>>>>>            
39408>>>>>>>            Set Form_Width    item 3 to 60
39409>>>>>>>            Set Header_Label  item 3 to "’œ¢. •¨âà©ž"
39410>>>>>>>            
39410>>>>>>>            Set Form_Width    item 4 to 60
39411>>>>>>>            Set Header_Label  item 4 to "’œ¢. å©«à©ž"
39412>>>>>>>            
39412>>>>>>>            Set Form_Width    item 5 to 59
39413>>>>>>>            Set Header_Label  item 5 to "‰à›.‘ç¤›œ©žª"
39414>>>>>>>            
39414>>>>>>>            Set Form_Width    item 6 to 26
39415>>>>>>>            Set Header_Label  item 6 to "œ¢"
39416>>>>>>>            Set Column_Checkbox_State  item 6 to True
39417>>>>>>>            
39417>>>>>>>            Set Form_Width    item 7 to 26
39418>>>>>>>            Set Header_Label  item 7 to "¨¦£"
39419>>>>>>>            Set Column_Checkbox_State  item 7 to True
39420>>>>>>>            
39420>>>>>>>
39420>>>>>>>            //AB-StoreStart
39420>>>>>>>                                                                                
39420>>>>>>>            //Property String StoreFragmaClient   Public ''
39420>>>>>>>            //Property String StorePsModule       Public ''
39420>>>>>>>            
39420>>>>>>>            //Procedure Store_Defaults
39420>>>>>>>            //    Forward Send Store_Defaults
39420>>>>>>>            //    Set StoreFragmaClient   to (FragmaClient(Self))
39420>>>>>>>            //    Set StorePsModule       to (psModule    (Self))
39420>>>>>>>            //End_Procedure
39420>>>>>>>            
39420>>>>>>>            //Procedure ReStore_Defaults
39420>>>>>>>            //    Forward Send ReStore_Defaults
39420>>>>>>>            //    Set FragmaClient to (StoreFragmaClient(Self))
39420>>>>>>>            //    Set psModule     to (StorePsModule    (Self))
39420>>>>>>>            //End_Procedure
39420>>>>>>>            
39420>>>>>>>            Set Column_Option Item 6 to NoEnter True
39421>>>>>>>            Set Column_Option Item 7 to NoEnter True
39422>>>>>>>            
39422>>>>>>>            Procedure Activating
39424>>>>>>>                Forward Send Activating
39426>>>>>>>                Set Auto_Index_State to True
39427>>>>>>>            End_Procedure
39428>>>>>>>            
39428>>>>>>>            Procedure Activate
39430>>>>>>>                Send Rebuild_Constraints    to Clients_DD
39431>>>>>>>                If (FragmaClient(Self)<>'') Begin
39433>>>>>>>                    Clear Clients
39434>>>>>>>                    Move (FragmaClient(Self)) to Clients.Client_ID
39435>>>>>>>                    Find Eq Clients By Index.6
39436>>>>>>>>
39436>>>>>>>                    If (Found) Send Request_Find to Clients_DD Eq Clients.File_Number 6
39439>>>>>>>                End
39439>>>>>>>>
39439>>>>>>>                Forward Send Activate
39441>>>>>>>            End_procedure
39442>>>>>>>            
39442>>>>>>>            
39442>>>>>>>            
39442>>>>>>>            
39442>>>>>>>            //AB-StoreEnd
39442>>>>>>>
39442>>>>>>>        End_Object    // oSelList
39443>>>>>>>
39443>>>>>>>        Object oOK_bn is a ButtonSub
39445>>>>>>>            Set Label to "&„§ ¢¦šã"
39446>>>>>>>            Set Location to 218 341
39447>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39448>>>>>>>
39448>>>>>>>            //AB-StoreStart
39448>>>>>>>            Procedure OnClick
39450>>>>>>>                Send OK To (oSelList(current_object))
39451>>>>>>>            End_Procedure
39452>>>>>>>            //AB-StoreEnd
39452>>>>>>>
39452>>>>>>>        End_Object    // oOK_bn
39453>>>>>>>
39453>>>>>>>        Object oCancel_bn is a ButtonSub
39455>>>>>>>            Set Label to "&€¡ç¨à©ž"
39456>>>>>>>            Set Location to 218 396
39457>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39458>>>>>>>
39458>>>>>>>            //AB-StoreStart
39458>>>>>>>            Procedure OnClick
39460>>>>>>>                Send Cancel To (oSelList(current_object))
39461>>>>>>>            End_Procedure
39462>>>>>>>            //AB-StoreEnd
39462>>>>>>>
39462>>>>>>>        End_Object    // oCancel_bn
39463>>>>>>>
39463>>>>>>>        Object oSearch_bn is a ButtonSub
39465>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
39466>>>>>>>            Set Location to 218 451
39467>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39468>>>>>>>
39468>>>>>>>            //AB-StoreStart
39468>>>>>>>            Procedure OnClick
39470>>>>>>>                Send Search To (oSelList(current_object))
39471>>>>>>>            End_Procedure
39472>>>>>>>            //AB-StoreEnd
39472>>>>>>>
39472>>>>>>>        End_Object    // oSearch_bn
39473>>>>>>>
39473>>>>>>>
39473>>>>>>>        //AB-StoreStart
39473>>>>>>>                
39473>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39474>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39475>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39476>>>>>>>        
39476>>>>>>>        Set Modal_State to True
39477>>>>>>>        Set Locate_Mode to Center_On_Screen
39478>>>>>>>        
39478>>>>>>>        
39478>>>>>>>        Procedure Activating Returns Integer
39480>>>>>>>            Integer rVal
39481>>>>>>>            Forward Get Msg_Activating to rVal
39483>>>>>>>                 if (psmodule(self)='01') set label of sl100 to '‰˜«á¢¦š¦ª œ¢˜«é¤'
39486>>>>>>>            else if (psmodule(self)='02') set label of sl100 to '‰˜«á¢¦š¦ª ¨¦£žŸœ¬«é¤'
39490>>>>>>>            Procedure_Return rVal
39491>>>>>>>        End_procedure
39492>>>>>>>        
39492>>>>>>>        
39492>>>>>>>        
39492>>>>>>>        
39492>>>>>>>        
39492>>>>>>>        
39492>>>>>>>        
39492>>>>>>>        
39492>>>>>>>        
39492>>>>>>>        //AB-StoreEnd
39492>>>>>>>
39492>>>>>>>    End_Object    // sl100
39493>>>>>>>
39493>>>>>>>//AB/     End_Object    // prj
39493>>>>>
39493>>>>>//DDB-Selection-pkg-End
39493>>>>>//DDB-FileEnd
39493>>>    Use ctypkin.DD
INCLUDING FILE: CTYPKIN.DD
39493>>>>>//DDB-FileStart
39493>>>>>//DDB-HeaderStart
39493>>>>>
39493>>>>>// File Name : CTYPKIN.DD
39493>>>>>// Class Name: Ctypkin_DataDictionary
39493>>>>>// Revision  : 70
39493>>>>>// Version   : 2
39493>>>>>
39493>>>>>Use  Windows           // Basic Definitions
39493>>>>>Use  DataDict          // DataDictionary Class Definition
39493>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39493>>>>>
39493>>>>>Open Ctypkin
INCLUDING FILE: CTYPKIN.FD
39495>>>>>Open Cmoves
39497>>>>>Open Cflagkin
INCLUDING FILE: CFLAGKIN.FD
39499>>>>>Open Ptypparl
39501>>>>>Open Ptyppar
INCLUDING FILE: PTYPPAR.FD
39503>>>>>Open Hmctyp
INCLUDING FILE: HMCTYP.FD
39505>>>>>Open Cmovesa
39507>>>>>Open Sysrecc
39509>>>>>Open Syscurxr
39511>>>>>
39511>>>>>//DDB-HeaderEnd
39511>>>>>//DDB-ValidationStart
39511>>>>>
39511>>>>>Register_Object Ctypkin_Ctypkin_Module_VT
39511>>>>>
39511>>>>>Object Ctypkin_Ctypkin_Module_VT  is a CodeValidationTable
39513>>>>>    Set Type_Value        To "MODULE"
39514>>>>>    //DDB-ValidationCustomStart
39514>>>>>    //DDB-ValidationCustomEnd
39514>>>>>End_Object   // Ctypkin_Ctypkin_Module_VT
39515>>>>>//DDB-ValidationEnd
39515>>>>>//DDB-SelectionStart
39515>>>>>//DDB/ ExternalSelectionList sl007  sl007.SL
39515>>>>>Register_Object sl007
39515>>>>>//DDB-SelectionEnd
39515>>>>>
39515>>>>>Class Ctypkin_DataDictionary  is a DataDictionary
39516>>>>>         
39516>>>>>    Procedure Construct_Object
39517>>>>>        Forward Send Construct_Object
39519>>>>>        Property Integer piMustNOTConstrain Public 0
39520>>>>>    End_Procedure
39521>>>>>
39521>>>>>    Procedure Save_Main_File
39522>>>>>        If (Operation_Origin<>Self) Begin
39524>>>>>            If Ctypkin.Recnum Eq 0 Procedure_Return
39527>>>>>        End
39527>>>>>>
39527>>>>>        Forward Send Save_Main_File
39529>>>>>    End_Procedure
39530>>>>>
39530>>>>>     Procedure Creating
39531>>>>>        Forward Send Creating
39533>>>>>        // Insert Code Here
39533>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Ctypkin.Ctypkin_Rec0)))))) to Ctypkin.Ctypkin_Recr
39534>>>>>    End_Procedure   // Creating
39535>>>>>
39535>>>>>
39535>>>>>    // Define_Fields:
39535>>>>>    // This procedure is used to set up all data-dictionary rules.
39535>>>>>
39535>>>>>    Procedure Define_Fields
39536>>>>>        Forward Send Define_Fields
39538>>>>>        //DDB-Generated-Code-Location
39538>>>>>        //DDB-DefineFieldStart
39538>>>>>
39538>>>>>        Set Main_File            To Ctypkin.File_Number
39539>>>>>        Set Cascade_Delete_State To FALSE
39540>>>>>
39540>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39541>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39542>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39543>>>>>
39543>>>>>        // Child (Client) file structure................
39543>>>>>        Send Add_Client_File  Cmoves.File_Number
39544>>>>>        Send Add_Client_File  Cflagkin.File_Number
39545>>>>>        Send Add_Client_File  Ptypparl.File_Number
39546>>>>>        Send Add_Client_File  Ptyppar.File_Number
39547>>>>>        Send Add_Client_File  Hmctyp.File_Number
39548>>>>>        Send Add_Client_File  Cmovesa.File_Number
39549>>>>>
39549>>>>>        // External (System) file structure.............
39549>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
39550>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
39551>>>>>
39551>>>>>        Define_Auto_Increment  Sysrecc.Ctypkin_Rec0  To Ctypkin.Ctypkin_Rec0
39554>>>>>
39554>>>>>        // Field-based properties.......................
39554>>>>>
39554>>>>>        // Ctypkin.Company_Code
39554>>>>>
39554>>>>>        // Ctypkin.Branch_Code
39554>>>>>
39554>>>>>        // Ctypkin.Year_Year
39554>>>>>
39554>>>>>        // Ctypkin.Ctypkin_Code
39554>>>>>        Set Field_Options          Field Ctypkin.Ctypkin_Code To DD_AUTOFIND   
39555>>>>>        Set Field_Prompt_Object    Field Ctypkin.Ctypkin_Code To (sl007(Self))
39556>>>>>        Set Key_Field_State        Field Ctypkin.Ctypkin_Code To TRUE
39557>>>>>
39557>>>>>        // Ctypkin.Ctypkin_Rec0
39557>>>>>
39557>>>>>        // Ctypkin.Ctypkin_Recr
39557>>>>>
39557>>>>>        // Ctypkin.Year_Recr
39557>>>>>
39557>>>>>        // Ctypkin.Ctypkin_Descr
39557>>>>>        Set Field_Prompt_Object    Field Ctypkin.Ctypkin_Descr To (sl007(Self))
39558>>>>>
39558>>>>>        // Ctypkin.Ctypkin_Anti
39558>>>>>
39558>>>>>        // Ctypkin.Ctypkin_Flags
39558>>>>>
39558>>>>>        // Ctypkin.Ctypkin_Module
39558>>>>>        Set Field_Value_Table      Field Ctypkin.Ctypkin_Module To (Ctypkin_Ctypkin_Module_VT(Self))
39559>>>>>
39559>>>>>        // Ctypkin.Open_Item
39559>>>>>
39559>>>>>        // Ctypkin.Check_Overhead
39559>>>>>
39559>>>>>        // Ctypkin.Max_Days_Sx_Par
39559>>>>>
39559>>>>>        // Ctypkin.Singular
39559>>>>>
39559>>>>>        // Ctypkin.Sub
39559>>>>>
39559>>>>>        // Ctypkin.Subreport
39559>>>>>
39559>>>>>        //DDB-DefineFieldEnd
39559>>>>>    End_Procedure    // Define_Fields
39560>>>>>
39560>>>>>    // Field_Defaults:
39560>>>>>    // This procedure is used to establish default field values.
39560>>>>>
39560>>>>>    Procedure Field_Defaults
39561>>>>>        Forward Send Field_Defaults
39563>>>>>        //DDB-Generated-Code-Location
39563>>>>>        //DDB-FieldDefaultStart
39563>>>>>        //DDB-FieldDefaultEnd
39563>>>>>    End_Procedure    // Field_Defaults
39564>>>>>
39564>>>>>End_Class    // Ctypkin_DataDictionary
39565>>>>>//DDB-Selection-pkg-Start
39565>>>>>
39565>>>>>Use sl007.SL         // sl007
INCLUDING FILE: SL007.SL
39565>>>>>>>//AB/ Project Ctypkin : sl007
39565>>>>>>>//AB/ Object prj is a Lookup_Project
39565>>>>>>>//AB/     Set ProjectName to "Ctypkin : sl007"
39565>>>>>>>//AB/     Set ProjectFileName to "sl007.SL"
39565>>>>>>>//AB/     Set GenerateFileName to "NONAME"
39565>>>>>>>
39565>>>>>>>// Project Object Structure
39565>>>>>>>//   sl007 is a dbModalPanelSub
39565>>>>>>>//     Ctypkin_DD is a DataDictionary
39565>>>>>>>//     oSelList is a dbListSub
39565>>>>>>>//     oOK_bn is a ButtonSub
39565>>>>>>>//     oCancel_bn is a ButtonSub
39565>>>>>>>//     oSearch_bn is a ButtonSub
39565>>>>>>>
39565>>>>>>>// Register all objects
39565>>>>>>>Register_Object Ctypkin_DD
39565>>>>>>>Register_Object oCancel_bn
39565>>>>>>>Register_Object oOK_bn
39565>>>>>>>Register_Object oSearch_bn
39565>>>>>>>Register_Object oSelList
39565>>>>>>>Register_Object sl007
39565>>>>>>>
39565>>>>>>>
39565>>>>>>>//AB-IgnoreStart
39565>>>>>>>
39565>>>>>>>Use DFAllEnt.pkg
39565>>>>>>>Use dbList.Sub
39565>>>>>>>Use Button.Sub
39565>>>>>>>
39565>>>>>>>
39565>>>>>>>Use CTYPKIN.DD
39565>>>>>>>
39565>>>>>>>//AB-IgnoreEnd
39565>>>>>>>
39565>>>>>>>Object sl007 is a dbModalPanelSub
39567>>>>>>>
39567>>>>>>>    //AB-StoreTopStart
39567>>>>>>>    Property String psModule Public ''
39569>>>>>>>    
39569>>>>>>>    //AB-StoreTopEnd
39569>>>>>>>
39569>>>>>>>    Set Label to "‰ ¤ã©œ ª    "
39570>>>>>>>    Set Size to 148 350
39571>>>>>>>    Set Location to 4 7
39572>>>>>>>    Set Exit_Application_Local_State to FALSE
39573>>>>>>>    Set Modal_State to FALSE
39574>>>>>>>
39574>>>>>>>    //AB-DDOStart
39574>>>>>>>
39574>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
39576>>>>>>>
39576>>>>>>>        //AB-StoreStart
39576>>>>>>>                                
39576>>>>>>>        Begin_Constraints
39578>>>>>>>            If (psModule(sl007(Self))<>'') Constrain Ctypkin.Ctypkin_Module eq (psModule(sl007(Self)))
39582>>>>>>>        End_Constraints
39585>>>>>>>        
39585>>>>>>>        
39585>>>>>>>        
39585>>>>>>>        
39585>>>>>>>        //AB-StoreEnd
39585>>>>>>>
39585>>>>>>>    End_Object    // Ctypkin_DD
39586>>>>>>>
39586>>>>>>>    Set Main_DD to (Ctypkin_DD(self))
39587>>>>>>>    Set Server to (Ctypkin_DD(self))
39588>>>>>>>
39588>>>>>>>    //AB-DDOEnd
39588>>>>>>>
39588>>>>>>>    Object oSelList is a dbListSub
39590>>>>>>>        Set Main_File to Ctypkin.File_Number
39591>>>>>>>        Set Size to 105 335
39592>>>>>>>        Set Location to 6 6
39593>>>>>>>
39593>>>>>>>        Begin_Row
39596>>>>>>>            Entry_Item Ctypkin.Ctypkin_code
39597>>>>>>>            Entry_Item Ctypkin.Ctypkin_descr
39598>>>>>>>        End_Row
39603>>>>>>>
39603>>>>>>>        Set Form_Width    item 0 to 71
39604>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª ‰ ¤ã©œàª"
39605>>>>>>>        
39605>>>>>>>        Set Form_Width    item 1 to 255
39606>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã ‰ ¤ã©œàª"
39607>>>>>>>        
39607>>>>>>>
39607>>>>>>>        //AB-StoreStart
39607>>>>>>>                    
39607>>>>>>>                    
39607>>>>>>>        Procedure Activate
39609>>>>>>>            Forward Send Activate
39611>>>>>>>            Send Beginning_Of_Data to oSelList True
39612>>>>>>>        End_Procedure
39613>>>>>>>        
39613>>>>>>>        
39613>>>>>>>        
39613>>>>>>>        
39613>>>>>>>        //AB-StoreEnd
39613>>>>>>>
39613>>>>>>>    End_Object    // oSelList
39614>>>>>>>
39614>>>>>>>    Object oOK_bn is a ButtonSub
39616>>>>>>>        Set Label to "&„§ ¢¦šã"
39617>>>>>>>        Set Location to 113 171
39618>>>>>>>
39618>>>>>>>        //AB-StoreStart
39618>>>>>>>        Procedure OnClick
39620>>>>>>>            Send OK To (oSelList(current_object))
39621>>>>>>>        End_Procedure
39622>>>>>>>        //AB-StoreEnd
39622>>>>>>>
39622>>>>>>>    End_Object    // oOK_bn
39623>>>>>>>
39623>>>>>>>    Object oCancel_bn is a ButtonSub
39625>>>>>>>        Set Label to "&€¡ç¨à©ž"
39626>>>>>>>        Set Location to 113 226
39627>>>>>>>
39627>>>>>>>        //AB-StoreStart
39627>>>>>>>        Procedure OnClick
39629>>>>>>>            Send Cancel To (oSelList(current_object))
39630>>>>>>>        End_Procedure
39631>>>>>>>        //AB-StoreEnd
39631>>>>>>>
39631>>>>>>>    End_Object    // oCancel_bn
39632>>>>>>>
39632>>>>>>>    Object oSearch_bn is a ButtonSub
39634>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
39635>>>>>>>        Set Location to 113 281
39636>>>>>>>
39636>>>>>>>        //AB-StoreStart
39636>>>>>>>        Procedure OnClick
39638>>>>>>>            Send Search To (oSelList(current_object))
39639>>>>>>>        End_Procedure
39640>>>>>>>        //AB-StoreEnd
39640>>>>>>>
39640>>>>>>>    End_Object    // oSearch_bn
39641>>>>>>>
39641>>>>>>>
39641>>>>>>>    //AB-StoreStart
39641>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39642>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39643>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39644>>>>>>>    
39644>>>>>>>    Procedure Activate Returns Integer
39646>>>>>>>        Integer rVal
39647>>>>>>>        Send Rebuild_Constraints to Ctypkin_DD
39648>>>>>>>        Forward Get Msg_Activate to rVal
39650>>>>>>>        Procedure_Return rVal
39651>>>>>>>    End_Procedure
39652>>>>>>>    
39652>>>>>>>    //AB-StoreEnd
39652>>>>>>>
39652>>>>>>>End_Object    // sl007
39653>>>>>>>
39653>>>>>>>//AB/ End_Object    // prj
39653>>>>>
39653>>>>>//DDB-Selection-pkg-End
39653>>>>>//DDB-FileEnd
39653>>>    Use cmoves.DD
INCLUDING FILE: CMOVES.DD
39653>>>>>//DDB-FileStart
39653>>>>>//DDB-HeaderStart
39653>>>>>
39653>>>>>// File Name : CMOVES.DD
39653>>>>>// Class Name: Cmoves_DataDictionary
39653>>>>>// Revision  : 148
39653>>>>>// Version   : 2
39653>>>>>
39653>>>>>Use  Windows           // Basic Definitions
39653>>>>>Use  DataDict          // DataDictionary Class Definition
39653>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39653>>>>>
39653>>>>>Open Cmoves
39655>>>>>Open Copen
INCLUDING FILE: COPEN.FD
39657>>>>>Open Ctypkin
39659>>>>>Open Clients
39661>>>>>Open Sysrecc
39663>>>>>Open Syscurxr
39665>>>>>
39665>>>>>//DDB-HeaderEnd
39665>>>>>//DDB-SelectionStart
39665>>>>>//DDB/ ExternalSelectionList sl006  sl006.SL
39665>>>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
39665>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
39665>>>>>Register_Object sl006
39665>>>>>Register_Object slNomism
39665>>>>>Register_Object sl041
39665>>>>>//DDB-SelectionEnd
39665>>>>> 
39665>>>>>Use Payresp.DD
39665>>>>>Use PmsSxet.DD
INCLUDING FILE: PMSSXET.DD
39665>>>>>>>//DDB-FileStart
39665>>>>>>>//DDB-HeaderStart
39665>>>>>>>
39665>>>>>>>// File Name : PMSSXET.DD
39665>>>>>>>// Class Name: PmsSxet_DataDictionary
39665>>>>>>>// Revision  : 27
39665>>>>>>>// Version   : 2
39665>>>>>>>
39665>>>>>>>Use  Windows           // Basic Definitions
39665>>>>>>>Use  DataDict          // DataDictionary Class Definition
39665>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39665>>>>>>>
39665>>>>>>>Open Pmssxet
INCLUDING FILE: PMSSXET.FD
39667>>>>>>>Open Pmoves
INCLUDING FILE: PMOVES.FD
39669>>>>>>>Open Psxetika
INCLUDING FILE: PSXETIKA.FD
39671>>>>>>>Open Pmoves
39673>>>>>>>
39673>>>>>>>//DDB-HeaderEnd
39673>>>>>>>
39673>>>>>>>Use bpEnYpol.dg
INCLUDING FILE: BPENYPOL.DG
39673>>>>>>>>>//AB/ Project bpEnYpol
39673>>>>>>>>>//AB/ Object prj is a Dialog_Project
39673>>>>>>>>>//AB/     Set ProjectName to "bpEnYpol"
39673>>>>>>>>>//AB/     Set ProjectFileName to "bpEnYpol.DG"
39673>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
39673>>>>>>>>>
39673>>>>>>>>>// Project Object Structure
39673>>>>>>>>>//   bpEnYpol is a BusinessProcessSub
39673>>>>>>>>>
39673>>>>>>>>>// Register all objects
39673>>>>>>>>>Register_Object bpEnYpol
39673>>>>>>>>>
39673>>>>>>>>>
39673>>>>>>>>>//AB-IgnoreStart
39673>>>>>>>>>
39673>>>>>>>>>Use Bproces.Sub
39673>>>>>>>>>
39673>>>>>>>>>
39673>>>>>>>>>//AB-IgnoreEnd
39673>>>>>>>>>
39673>>>>>>>>>Object bpEnYpol is a BusinessProcessSub
39675>>>>>>>>>
39675>>>>>>>>>    //AB-StoreTopStart
39675>>>>>>>>>
39675>>>>>>>>>    Open Pmoves
39677>>>>>>>>>    Open Psxetika
39679>>>>>>>>>
39679>>>>>>>>>    Set Status_Panel_State to False
39680>>>>>>>>>    //Set Allow_Cancel_State  to True
39680>>>>>>>>>    Set Display_Error_State to True
39681>>>>>>>>>    //Set Process_Title to "               "
39681>>>>>>>>>    //Set Status_Log_id to (status_log(Self)) //Use statlog.pkg
39681>>>>>>>>>    //Set Status_log_state to True
39681>>>>>>>>>
39681>>>>>>>>>    Property Integer    piFromAkyrosh       Public  0
39683>>>>>>>>>    Property Integer    piLathos            Public  0
39685>>>>>>>>>    Property Number     pnQty               Public  0
39687>>>>>>>>>    Property Integer    piCurrentPartl      Public  0
39689>>>>>>>>>    Property Integer    piCurrentPmoves     Public  0
39691>>>>>>>>>    Property Integer    piCurrentPmsSxet    Public  0
39693>>>>>>>>>    Property String     psRecr              Public ''
39695>>>>>>>>>
39695>>>>>>>>>
39695>>>>>>>>>    //AB-StoreTopEnd
39695>>>>>>>>>
39695>>>>>>>>>    Set Size to 60 100
39696>>>>>>>>>    Set Location to 4 5
39697>>>>>>>>>
39697>>>>>>>>>    //AB-DDOStart
39697>>>>>>>>>
39697>>>>>>>>>
39697>>>>>>>>>    //AB-DDOEnd
39697>>>>>>>>>
39697>>>>>>>>>
39697>>>>>>>>>    //AB-StoreStart
39697>>>>>>>>>
39697>>>>>>>>>    Function fiUpdate_Pmoves_Qty String asRecr Number anQty Integer aiDoNotOpen Returns Integer
39699>>>>>>>>>        Clear Pmoves
39700>>>>>>>>>        Move asRecr to Pmoves.Pms_Recr
39701>>>>>>>>>        Find Eq Pmoves by index.2
39702>>>>>>>>>>
39702>>>>>>>>>        If (Found) Begin
39704>>>>>>>>>            If ((Pmoves.Timol_Qty+anQty) > Pmoves.Pms_Qty)      Function_Return 40001
39707>>>>>>>>>            Else Begin
39708>>>>>>>>>                Add anQty to Pmoves.Timol_Qty
39709>>>>>>>>>                Move (Pmoves.Pms_Qty-Pmoves.Timol_Qty) to Pmoves.Timol_Ypol
39710>>>>>>>>>                If (Pmoves.Timol_Ypol>Pmoves.Pms_Qty)  Function_Return 40003
39713>>>>>>>>>                Saverecord Pmoves
39714>>>>>>>>>
39714>>>>>>>>>                Clear Particle
39715>>>>>>>>>                Move Pmoves.Partl_Recr to Particle.Partl_Recr
39716>>>>>>>>>                Find Eq Particle by Index.2
39717>>>>>>>>>>
39717>>>>>>>>>                If (Found) Begin
39719>>>>>>>>>                   // Reread
39719>>>>>>>>>                    Add anQty to Particle.Timol_Qty
39720>>>>>>>>>                    If (Particle.Partl_TotTem>0) Begin
39722>>>>>>>>>                        Move (Particle.Partl_TotTem-Particle.Timol_Qty)     to Particle.Timol_Ypol
39723>>>>>>>>>
39723>>>>>>>>>                        If (aiDoNotOpen=1)  Move 1                          to Particle.Partl_Timol
39726>>>>>>>>>                        Else                Move (Particle.Timol_Ypol=0 )   to Particle.Partl_Timol
39728>>>>>>>>>
39728>>>>>>>>>                    End
39728>>>>>>>>>>
39728>>>>>>>>>                    Else Move 0 to Particle.Partl_Timol
39730>>>>>>>>>                    Saverecord Particle
39731>>>>>>>>>                   // Unlock
39731>>>>>>>>>                End
39731>>>>>>>>>>
39731>>>>>>>>>                Else Function_Return 40002
39733>>>>>>>>>            End
39733>>>>>>>>>>
39733>>>>>>>>>        End
39733>>>>>>>>>>
39733>>>>>>>>>        Else Function_Return 40000
39735>>>>>>>>>        Function_Return 0
39736>>>>>>>>>    End_Function
39737>>>>>>>>>
39737>>>>>>>>>    Procedure OnProcess
39739>>>>>>>>>        Integer iLathos iSub iAkyro
39740>>>>>>>>>        String  sCurr sRecr sPmoveRecr sParticleRecr
39740>>>>>>>>>        Number  nQty nQty2
39740>>>>>>>>>
39740>>>>>>>>>        Set piLathos        to 0
39741>>>>>>>>>        Get pnQty           to nQty2
39742>>>>>>>>>        Get psRecr          to sRecr
39743>>>>>>>>>        Get piFromAkyrosh   to iAkyro
39744>>>>>>>>>
39744>>>>>>>>>        // An h posothta einai setarismenh thetika shmainei pos klhthike
39744>>>>>>>>>        // apo thn Update tou PmsSxet, allios an erthei arnhtikh apo thn Backout
39744>>>>>>>>>        // Prepei na to xeroume gia thn periptosh tou akyrotikou, opou tha trexei
39744>>>>>>>>>        // apanota h function kai tha antistrpsei to proshmo ths posothtas.
39744>>>>>>>>>        Move (nQty2<0)   to iSub
39745>>>>>>>>>
39745>>>>>>>>>
39745>>>>>>>>>        Get fiUpdate_Pmoves_Qty sRecr nQty2 0 to iLathos
39746>>>>>>>>>
39746>>>>>>>>>        If (iLathos) Begin
39748>>>>>>>>>            Set piLathos to iLathos
39749>>>>>>>>>            Procedure_Return
39750>>>>>>>>>        End
39750>>>>>>>>>>
39750>>>>>>>>>
39750>>>>>>>>>
39750>>>>>>>>>        // js 30/08/2002 Enhmerosh ena bhma pio piso sthn periptosh pou
39750>>>>>>>>>        // h enhmerosh ton pmoves apo backout kai update tou PmsSxet,
39750>>>>>>>>>        // afora Akyrotiko. (DAP --> TIM --> AKYROTIKO). Erxomaste dhladh edo apo
39750>>>>>>>>>        // AKYROTIKO na enhmerosoume tis posothtes tou TIMOLOGIOU.
39750>>>>>>>>>        // Sthn periptosh ayth prepei na kanoume ta exhs:
39750>>>>>>>>>        // 1. Eyresh ton sxetikon tou trxontos pmove TIMOLOGIOU
39750>>>>>>>>>        // 2. Antistrofh tou proshmou ths posothtas tous
39750>>>>>>>>>        // 3. Eyresh tou arxikou Pmoves (DAP) kai enhmerosh posothtas kinhshs
39750>>>>>>>>>
39750>>>>>>>>>        If (iAkyro) Begin
39752>>>>>>>>>            Clear Pmoves
39753>>>>>>>>>            Move sRecr to Pmoves.Pms_Recr
39754>>>>>>>>>            Find Eq Pmoves by index.2
39755>>>>>>>>>>
39755>>>>>>>>>            If (Found) Begin
39757>>>>>>>>>                Clear PmsSxet
39758>>>>>>>>>                Move sRecr to PmsSxet.Pms_Recr
39759>>>>>>>>>                Find Gt PmsSxet by Index.1
39760>>>>>>>>>>
39760>>>>>>>>>                While ((Found=1) And (PmsSxet.Pms_Recr=sRecr))
39764>>>>>>>>>                    Move PmsSxet.Sxetiko_Recr   to sCurr
39765>>>>>>>>>                    Move PmsSxet.Posothta       to nQty
39766>>>>>>>>>                    If (iSub) Begin
39768>>>>>>>>>                        // An Exei erthei apo Backout tou PmsSxet (to gnorizoume apo thn posothta
39768>>>>>>>>>                        // h opoia sto property einai arnhtikh) tote gyrname thn posothta tou
39768>>>>>>>>>                        // PmsSxet thetikh (Ousiastika thn afhnoume opos einai dhladh).
39768>>>>>>>>>                    End
39768>>>>>>>>>>
39768>>>>>>>>>                    Else Begin
39769>>>>>>>>>                        // An Exei erthei apo Update tou PmsSxet (to gnorizoume apo thn posothta
39769>>>>>>>>>                        // h opoia sto property einai thetikh) tote gyrname thn posothta tou
39769>>>>>>>>>                        // PmsSxet arnhtikh.
39769>>>>>>>>>                        Move (nQty*(-1)) to nQty
39770>>>>>>>>>                    End
39770>>>>>>>>>>
39770>>>>>>>>>
39770>>>>>>>>>                    //Get fiUpdate_Pmoves_Qty sCurr nQty 1 to iLathos
39770>>>>>>>>>                    // 07/01/2003 //
39770>>>>>>>>>                    Get fiUpdate_Pmoves_Qty sCurr nQty 0 to iLathos
39771>>>>>>>>>
39771>>>>>>>>>                    If (iLathos) Begin
39773>>>>>>>>>                        Set piLathos to (iLathos+3)
39774>>>>>>>>>                        // An Gyrisei Pmoves Not Found      (40000) To kanoume 40003
39774>>>>>>>>>                        // An Gyrisei problhma sto ypoloipo (40001) To kanoume 40004
39774>>>>>>>>>                        // An Gyrisei problhma sto particle (40002) To kanoume 40005
39774>>>>>>>>>                        // An Gyrisei problhma sto particle (40003) To kanoume 40006
39774>>>>>>>>>                        Procedure_Return
39775>>>>>>>>>                    End
39775>>>>>>>>>>
39775>>>>>>>>>
39775>>>>>>>>>                    Clear PmsSxet
39776>>>>>>>>>                    Move sRecr      to PmsSxet.Pms_Recr
39777>>>>>>>>>                    Move sCurr      to PmsSxet.Sxetiko_Recr
39778>>>>>>>>>                    Find Eq PmsSxet by Index.1
39779>>>>>>>>>>
39779>>>>>>>>>                    Find Gt PmsSxet by Index.1
39780>>>>>>>>>>
39780>>>>>>>>>                Loop
39781>>>>>>>>>>
39781>>>>>>>>>            End
39781>>>>>>>>>>
39781>>>>>>>>>            Else Set piLathos to 40007
39783>>>>>>>>>        End
39783>>>>>>>>>>
39783>>>>>>>>>
39783>>>>>>>>>        If (piLathos(Self)<>0) Procedure_Return
39786>>>>>>>>>
39786>>>>>>>>>    End_Procedure
39787>>>>>>>>>
39787>>>>>>>>>    Procedure OnError integer error_info string errMsg
39789>>>>>>>>>    End_Procedure
39790>>>>>>>>>
39790>>>>>>>>>    Procedure Start_Process
39792>>>>>>>>>        Forward Send Start_Process
39794>>>>>>>>>    End_Procedure
39795>>>>>>>>>
39795>>>>>>>>>    Procedure End_Process
39797>>>>>>>>>        Forward Send End_Process
39799>>>>>>>>>        If (piCurrentPartl(Self)) Begin
39801>>>>>>>>>            Clear Particle
39802>>>>>>>>>            Move (piCurrentPartl(Self)) to Particle.Recnum
39803>>>>>>>>>            Find Eq Particle.Recnum
39804>>>>>>>>>>
39804>>>>>>>>>        End
39804>>>>>>>>>>
39804>>>>>>>>>        If (piCurrentPmoves(Self)) Begin
39806>>>>>>>>>            Clear Pmoves
39807>>>>>>>>>            Move (piCurrentPmoves(Self)) to Pmoves.Recnum
39808>>>>>>>>>            Find Eq Pmoves.Recnum
39809>>>>>>>>>>
39809>>>>>>>>>        End
39809>>>>>>>>>>
39809>>>>>>>>>        If (piCurrentPmsSxet(Self)<>0) Begin
39811>>>>>>>>>            Clear PmsSxet
39812>>>>>>>>>            Move (piCurrentPmsSxet(Self)) to PmsSxet.Recnum
39813>>>>>>>>>            Find Eq PmsSxet.Recnum
39814>>>>>>>>>>
39814>>>>>>>>>        End
39814>>>>>>>>>>
39814>>>>>>>>>    End_Procedure
39815>>>>>>>>>
39815>>>>>>>>>    //AB-StoreEnd
39815>>>>>>>>>
39815>>>>>>>>>End_Object    // bpEnYpol
39816>>>>>>>>>
39816>>>>>>>>>//AB/ End_Object    // prj
39816>>>>>>>Use MyArray.dg
INCLUDING FILE: MYARRAY.DG
39816>>>>>>>>>//AB/ Project MyArray
39816>>>>>>>>>//AB/     Object prj is a Dialog_Project
39816>>>>>>>>>//AB/         Set ProjectName to "MyArray"
39816>>>>>>>>>//AB/         Set ProjectFileName to "MyArray.DG"
39816>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
39816>>>>>>>>>
39816>>>>>>>>>// Project Object Structure
39816>>>>>>>>>//   Psx_Array is a BusinessProcessSub
39816>>>>>>>>>//     Ctypkin_DD2 is a Ctypkin_DataDictionary
39816>>>>>>>>>//     Wtypkin_DD2 is a Wtypkin_DataDictionary
39816>>>>>>>>>//     Ptyppar_DD2 is a Ptyppar_DataDictionary
39816>>>>>>>>>//     Country_DD2 is a Country_DataDictionary
39816>>>>>>>>>//     Towns_DD2 is a Towns_DataDictionary
39816>>>>>>>>>//     Cities_DD2 is a Cities_DataDictionary
39816>>>>>>>>>//     Areas_DD2 is a Areas_DataDictionary
39816>>>>>>>>>//     Payresp_DD2 is a Payresp_DataDictionary
39816>>>>>>>>>//     Clients_DD2 is a Clients_DataDictionary
39816>>>>>>>>>//     Nomisma_DD2 is a Nomisma_DataDictionary
39816>>>>>>>>>//     Particle_DD2 is a Particle_DataDictionary
39816>>>>>>>>>//     Ctypkin_DD is a Ctypkin_DataDictionary
39816>>>>>>>>>//     Wtypkin_DD is a Wtypkin_DataDictionary
39816>>>>>>>>>//     Ptyppar_DD is a Ptyppar_DataDictionary
39816>>>>>>>>>//     Country_DD is a Country_DataDictionary
39816>>>>>>>>>//     Towns_DD is a Towns_DataDictionary
39816>>>>>>>>>//     Cities_DD is a Cities_DataDictionary
39816>>>>>>>>>//     Areas_DD is a Areas_DataDictionary
39816>>>>>>>>>//     Payresp_DD is a Payresp_DataDictionary
39816>>>>>>>>>//     Clients_DD is a Clients_DataDictionary
39816>>>>>>>>>//     Nomisma_DD is a Nomisma_DataDictionary
39816>>>>>>>>>//     Particle_DD is a Particle_DataDictionary
39816>>>>>>>>>//     Psxetika_DD is a Psxetika_DataDictionary
39816>>>>>>>>>
39816>>>>>>>>>// Register all objects
39816>>>>>>>>>Register_Object Areas_DD
39816>>>>>>>>>Register_Object Areas_DD2
39816>>>>>>>>>Register_Object Cities_DD
39816>>>>>>>>>Register_Object Cities_DD2
39816>>>>>>>>>Register_Object Clients_DD
39816>>>>>>>>>Register_Object Clients_DD2
39816>>>>>>>>>Register_Object Country_DD
39816>>>>>>>>>Register_Object Country_DD2
39816>>>>>>>>>Register_Object Ctypkin_DD
39816>>>>>>>>>Register_Object Ctypkin_DD2
39816>>>>>>>>>Register_Object Nomisma_DD
39816>>>>>>>>>Register_Object Nomisma_DD2
39816>>>>>>>>>Register_Object Particle_DD
39816>>>>>>>>>Register_Object Particle_DD2
39816>>>>>>>>>Register_Object Payresp_DD
39816>>>>>>>>>Register_Object Payresp_DD2
39816>>>>>>>>>Register_Object Psx_Array
39816>>>>>>>>>Register_Object Psxetika_DD
39816>>>>>>>>>Register_Object Ptyppar_DD
39816>>>>>>>>>Register_Object Ptyppar_DD2
39816>>>>>>>>>Register_Object Towns_DD
39816>>>>>>>>>Register_Object Towns_DD2
39816>>>>>>>>>Register_Object Wtypkin_DD
39816>>>>>>>>>Register_Object Wtypkin_DD2
39816>>>>>>>>>
39816>>>>>>>>>
39816>>>>>>>>>
39816>>>>>>>>>    //AB-StoreTopStart
39816>>>>>>>>>
39816>>>>>>>>>    Use CTYPKIN.DD
39816>>>>>>>>>    Use WTYPKIN.DD
INCLUDING FILE: WTYPKIN.DD
39816>>>>>>>>>>>//DDB-FileStart
39816>>>>>>>>>>>//DDB-HeaderStart
39816>>>>>>>>>>>
39816>>>>>>>>>>>// File Name : WTYPKIN.DD
39816>>>>>>>>>>>// Class Name: Wtypkin_DataDictionary
39816>>>>>>>>>>>// Revision  : 49
39816>>>>>>>>>>>// Version   : 2
39816>>>>>>>>>>>
39816>>>>>>>>>>>Use  Windows           // Basic Definitions
39816>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
39816>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39816>>>>>>>>>>>
39816>>>>>>>>>>>Open Wtypkin
39818>>>>>>>>>>>Open Ptyppar
39820>>>>>>>>>>>Open Wcmoves
INCLUDING FILE: WCMOVES.FD
39822>>>>>>>>>>>Open Hmwtyp
INCLUDING FILE: HMWTYP.FD
39824>>>>>>>>>>>Open Wflagkin
INCLUDING FILE: WFLAGKIN.FD
39826>>>>>>>>>>>Open Sysrecw
INCLUDING FILE: SYSRECW.FD
39828>>>>>>>>>>>Open Syscurxr
39830>>>>>>>>>>>
39830>>>>>>>>>>>//DDB-HeaderEnd
39830>>>>>>>>>>>//DDB-ValidationStart
39830>>>>>>>>>>>
39830>>>>>>>>>>>Register_Object Wtypkin_Wtypkin_Module_VT
39830>>>>>>>>>>>
39830>>>>>>>>>>>Object Wtypkin_Wtypkin_Module_VT  is a CodeValidationTable
39832>>>>>>>>>>>    Set Type_Value        To "MODULE"
39833>>>>>>>>>>>    //DDB-ValidationCustomStart
39833>>>>>>>>>>>    //DDB-ValidationCustomEnd
39833>>>>>>>>>>>End_Object   // Wtypkin_Wtypkin_Module_VT
39834>>>>>>>>>>>//DDB-ValidationEnd
39834>>>>>>>>>>>//DDB-SelectionStart
39834>>>>>>>>>>>//DDB/ ExternalSelectionList sl029a  sl029a.SL
39834>>>>>>>>>>>Register_Object sl029a
39834>>>>>>>>>>>//DDB-SelectionEnd
39834>>>>>>>>>>>
39834>>>>>>>>>>>Class Wtypkin_DataDictionary  is a DataDictionary
39835>>>>>>>>>>>               
39835>>>>>>>>>>>    Procedure Construct_Object
39836>>>>>>>>>>>        Forward Send Construct_Object
39838>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
39839>>>>>>>>>>>    End_Procedure
39840>>>>>>>>>>>
39840>>>>>>>>>>>    Procedure Save_Main_File
39841>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
39843>>>>>>>>>>>            If Wtypkin.Recnum Eq 0 Procedure_Return
39846>>>>>>>>>>>        End
39846>>>>>>>>>>>>
39846>>>>>>>>>>>        Forward Send Save_Main_File
39848>>>>>>>>>>>    End_Procedure
39849>>>>>>>>>>>
39849>>>>>>>>>>>
39849>>>>>>>>>>>     Procedure Creating
39850>>>>>>>>>>>        Forward Send Creating
39852>>>>>>>>>>>        // Insert Code Here
39852>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wtypkin.Wtypkin_Rec0)))))) to Wtypkin.Wtypkin_Recr
39853>>>>>>>>>>>    End_Procedure   // Creating
39854>>>>>>>>>>>
39854>>>>>>>>>>>    // Define_Fields:
39854>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39854>>>>>>>>>>>
39854>>>>>>>>>>>    Procedure Define_Fields
39855>>>>>>>>>>>        Forward Send Define_Fields
39857>>>>>>>>>>>        //DDB-Generated-Code-Location
39857>>>>>>>>>>>        //DDB-DefineFieldStart
39857>>>>>>>>>>>
39857>>>>>>>>>>>        Set Main_File            To Wtypkin.File_Number
39858>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
39859>>>>>>>>>>>
39859>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39860>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39861>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39862>>>>>>>>>>>
39862>>>>>>>>>>>        // Child (Client) file structure................
39862>>>>>>>>>>>        Send Add_Client_File  Ptyppar.File_Number
39863>>>>>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
39864>>>>>>>>>>>        Send Add_Client_File  Hmwtyp.File_Number
39865>>>>>>>>>>>        Send Add_Client_File  Wflagkin.File_Number
39866>>>>>>>>>>>
39866>>>>>>>>>>>        // External (System) file structure.............
39866>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
39867>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
39868>>>>>>>>>>>
39868>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wtypkin_Rec0  To Wtypkin.Wtypkin_Rec0
39871>>>>>>>>>>>
39871>>>>>>>>>>>        // Field-based properties.......................
39871>>>>>>>>>>>
39871>>>>>>>>>>>        // Wtypkin.Company_Code
39871>>>>>>>>>>>
39871>>>>>>>>>>>        // Wtypkin.Branch_Code
39871>>>>>>>>>>>
39871>>>>>>>>>>>        // Wtypkin.Year_Year
39871>>>>>>>>>>>
39871>>>>>>>>>>>        // Wtypkin.Wtypkin_Code
39871>>>>>>>>>>>        Set Field_Options          Field Wtypkin.Wtypkin_Code To DD_AUTOFIND   
39872>>>>>>>>>>>        Set Field_Prompt_Object    Field Wtypkin.Wtypkin_Code To (sl029a(Self))
39873>>>>>>>>>>>        Set Key_Field_State        Field Wtypkin.Wtypkin_Code To TRUE
39874>>>>>>>>>>>
39874>>>>>>>>>>>        // Wtypkin.Wtypkin_Rec0
39874>>>>>>>>>>>        Set Field_Options          Field Wtypkin.Wtypkin_Rec0 To DD_AUTOFIND   
39875>>>>>>>>>>>
39875>>>>>>>>>>>        // Wtypkin.Wtypkin_Recr
39875>>>>>>>>>>>
39875>>>>>>>>>>>        // Wtypkin.Year_Recr
39875>>>>>>>>>>>
39875>>>>>>>>>>>        // Wtypkin.Wtypkin_Descr
39875>>>>>>>>>>>        Set Field_Prompt_Object    Field Wtypkin.Wtypkin_Descr To (sl029a(Self))
39876>>>>>>>>>>>
39876>>>>>>>>>>>        // Wtypkin.Wtypkin_Anti
39876>>>>>>>>>>>
39876>>>>>>>>>>>        // Wtypkin.Wtypkin_Module
39876>>>>>>>>>>>        Set Field_Value_Table      Field Wtypkin.Wtypkin_Module To (Wtypkin_Wtypkin_Module_VT(Self))
39877>>>>>>>>>>>
39877>>>>>>>>>>>        // Wtypkin.Max_Days_Sx_Par
39877>>>>>>>>>>>
39877>>>>>>>>>>>        //DDB-DefineFieldEnd
39877>>>>>>>>>>>    End_Procedure    // Define_Fields
39878>>>>>>>>>>>
39878>>>>>>>>>>>    // Field_Defaults:
39878>>>>>>>>>>>    // This procedure is used to establish default field values.
39878>>>>>>>>>>>
39878>>>>>>>>>>>    Procedure Field_Defaults
39879>>>>>>>>>>>        Forward Send Field_Defaults
39881>>>>>>>>>>>        //DDB-Generated-Code-Location
39881>>>>>>>>>>>        //DDB-FieldDefaultStart
39881>>>>>>>>>>>        //DDB-FieldDefaultEnd
39881>>>>>>>>>>>    End_Procedure    // Field_Defaults
39882>>>>>>>>>>>
39882>>>>>>>>>>>End_Class    // Wtypkin_DataDictionary
39883>>>>>>>>>>>//DDB-Selection-pkg-Start
39883>>>>>>>>>>>
39883>>>>>>>>>>>Use sl029a.SL        // sl029a
INCLUDING FILE: SL029A.SL
39883>>>>>>>>>>>>>//AB/ Project sl029a:wtypkin
39883>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
39883>>>>>>>>>>>>>//AB/         Set ProjectName to "sl029a:wtypkin"
39883>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl029a.SL"
39883>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
39883>>>>>>>>>>>>>
39883>>>>>>>>>>>>>// Project Object Structure
39883>>>>>>>>>>>>>//   sl029a is a dbModalPanelSub
39883>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
39883>>>>>>>>>>>>>//     oSelList is a dbListSub
39883>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
39883>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
39883>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
39883>>>>>>>>>>>>>
39883>>>>>>>>>>>>>// Register all objects
39883>>>>>>>>>>>>>Register_Object oCancel_bn
39883>>>>>>>>>>>>>Register_Object oOK_bn
39883>>>>>>>>>>>>>Register_Object oSearch_bn
39883>>>>>>>>>>>>>Register_Object oSelList
39883>>>>>>>>>>>>>Register_Object sl029a
39883>>>>>>>>>>>>>Register_Object Wtypkin_DD
39883>>>>>>>>>>>>>
39883>>>>>>>>>>>>>
39883>>>>>>>>>>>>>    //AB-IgnoreStart
39883>>>>>>>>>>>>>
39883>>>>>>>>>>>>>    Use DFAllEnt.pkg
39883>>>>>>>>>>>>>    Use dbList.Sub
39883>>>>>>>>>>>>>    Use Button.Sub
39883>>>>>>>>>>>>>
39883>>>>>>>>>>>>>
39883>>>>>>>>>>>>>    Use WTYPKIN.DD
39883>>>>>>>>>>>>>    
39883>>>>>>>>>>>>>    //AB-IgnoreEnd
39883>>>>>>>>>>>>>
39883>>>>>>>>>>>>>    Object sl029a is a dbModalPanelSub
39885>>>>>>>>>>>>>        set label to "Ž¨ ©£æª ‰ ¤ã©œà¤ €§¦Ÿã¡žª" 
39886>>>>>>>>>>>>>        Set Size to 148 297
39887>>>>>>>>>>>>>        Set Location to 4 5
39888>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
39889>>>>>>>>>>>>>        Set Modal_State to FALSE
39890>>>>>>>>>>>>>
39890>>>>>>>>>>>>>        //AB-DDOStart
39890>>>>>>>>>>>>>
39890>>>>>>>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
39892>>>>>>>>>>>>>        End_Object    // Wtypkin_DD
39893>>>>>>>>>>>>>
39893>>>>>>>>>>>>>        Set Main_DD to (Wtypkin_DD(self))
39894>>>>>>>>>>>>>        Set Server to (Wtypkin_DD(self))
39895>>>>>>>>>>>>>
39895>>>>>>>>>>>>>        //AB-DDOEnd
39895>>>>>>>>>>>>>
39895>>>>>>>>>>>>>        Object oSelList is a dbListSub
39897>>>>>>>>>>>>>            Set Main_File to Wtypkin.File_Number
39898>>>>>>>>>>>>>            Set Size to 105 280
39899>>>>>>>>>>>>>            Set Location to 6 6
39900>>>>>>>>>>>>>
39900>>>>>>>>>>>>>            Begin_Row
39903>>>>>>>>>>>>>                Entry_Item Wtypkin.Wtypkin_code
39904>>>>>>>>>>>>>                Entry_Item Wtypkin.Wtypkin_descr
39905>>>>>>>>>>>>>            End_Row
39910>>>>>>>>>>>>>
39910>>>>>>>>>>>>>            Set Form_Width    item 0 to 60
39911>>>>>>>>>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
39912>>>>>>>>>>>>>            
39912>>>>>>>>>>>>>            Set Form_Width    item 1 to 212
39913>>>>>>>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
39914>>>>>>>>>>>>>            
39914>>>>>>>>>>>>>        End_Object    // oSelList
39915>>>>>>>>>>>>>
39915>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
39917>>>>>>>>>>>>>            set label to "&„§ ¢¦šã" 
39918>>>>>>>>>>>>>            Set Location to 115 126
39919>>>>>>>>>>>>>
39919>>>>>>>>>>>>>            //AB-StoreStart
39919>>>>>>>>>>>>>            Procedure OnClick
39921>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
39922>>>>>>>>>>>>>            End_Procedure
39923>>>>>>>>>>>>>            //AB-StoreEnd
39923>>>>>>>>>>>>>
39923>>>>>>>>>>>>>        End_Object    // oOK_bn
39924>>>>>>>>>>>>>
39924>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
39926>>>>>>>>>>>>>            set label to "&€¡ç¨à©ž" 
39927>>>>>>>>>>>>>            Set Location to 115 181
39928>>>>>>>>>>>>>
39928>>>>>>>>>>>>>            //AB-StoreStart
39928>>>>>>>>>>>>>            Procedure OnClick
39930>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
39931>>>>>>>>>>>>>            End_Procedure
39932>>>>>>>>>>>>>            //AB-StoreEnd
39932>>>>>>>>>>>>>
39932>>>>>>>>>>>>>        End_Object    // oCancel_bn
39933>>>>>>>>>>>>>
39933>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
39935>>>>>>>>>>>>>            set label to "€&¤˜ã«ž©ž" 
39936>>>>>>>>>>>>>            Set Location to 115 236
39937>>>>>>>>>>>>>
39937>>>>>>>>>>>>>            //AB-StoreStart
39937>>>>>>>>>>>>>            Procedure OnClick
39939>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
39940>>>>>>>>>>>>>            End_Procedure
39941>>>>>>>>>>>>>            //AB-StoreEnd
39941>>>>>>>>>>>>>
39941>>>>>>>>>>>>>        End_Object    // oSearch_bn
39942>>>>>>>>>>>>>
39942>>>>>>>>>>>>>
39942>>>>>>>>>>>>>        //AB-StoreStart
39942>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39943>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39944>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39945>>>>>>>>>>>>>        //AB-StoreEnd
39945>>>>>>>>>>>>>
39945>>>>>>>>>>>>>    End_Object    // sl029a
39946>>>>>>>>>>>>>
39946>>>>>>>>>>>>>//AB/     End_Object    // prj
39946>>>>>>>>>>>
39946>>>>>>>>>>>//DDB-Selection-pkg-End
39946>>>>>>>>>>>//DDB-FileEnd
39946>>>>>>>>>    Use PTYPPAR.DD
INCLUDING FILE: PTYPPAR.DD
39946>>>>>>>>>>>//DDB-FileStart
39946>>>>>>>>>>>//DDB-HeaderStart
39946>>>>>>>>>>>
39946>>>>>>>>>>>// File Name : PTYPPAR.DD
39946>>>>>>>>>>>// Class Name: Ptyppar_DataDictionary
39946>>>>>>>>>>>// Revision  : 88
39946>>>>>>>>>>>// Version   : 2
39946>>>>>>>>>>>
39946>>>>>>>>>>>Use  Windows           // Basic Definitions
39946>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
39946>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39946>>>>>>>>>>>
39946>>>>>>>>>>>Open Ptyppar
39948>>>>>>>>>>>Open Particle
39950>>>>>>>>>>>Open Pseira
INCLUDING FILE: PSEIRA.FD
39952>>>>>>>>>>>Open Ptypmet
INCLUDING FILE: PTYPMET.FD
39954>>>>>>>>>>>Open Ptypparh
INCLUDING FILE: PTYPPARH.FD
39956>>>>>>>>>>>Open Ctypkin
39958>>>>>>>>>>>Open Wtypkin
39960>>>>>>>>>>>Open Sysrecp
INCLUDING FILE: SYSRECP.FD
39962>>>>>>>>>>>Open Syscurxr
39964>>>>>>>>>>>
39964>>>>>>>>>>>//DDB-HeaderEnd
39964>>>>>>>>>>>//DDB-ValidationStart
39964>>>>>>>>>>>
39964>>>>>>>>>>>Register_Object Ptyppar_Year_Recr_VT
39964>>>>>>>>>>>Register_Object Ptyppar_Ptyppar_Is_What_VT
39964>>>>>>>>>>>Register_Object Ptyppar_Ptyppar_Module_VT
39964>>>>>>>>>>>Register_Object Ptyppar_Ti_Typonei_Pms_VT1
39964>>>>>>>>>>>
39964>>>>>>>>>>>Object Ptyppar_Year_Recr_VT  is a DescriptionValidationTable
39966>>>>>>>>>>>    Set Allow_Blank_State To TRUE
39967>>>>>>>>>>>
39967>>>>>>>>>>>    Procedure Fill_List
39969>>>>>>>>>>>        Forward Send Fill_List
39971>>>>>>>>>>>        Send Add_Table_Value  ""  "ƒœ¤ ‘¬££œ«â®œ "
39972>>>>>>>>>>>        Send Add_Table_Value  "1"  "¨¦©Ÿœ« ¡á"
39973>>>>>>>>>>>        Send Add_Table_Value  "2"  "€­˜ ¨œ« ¡á"
39974>>>>>>>>>>>    End_Procedure    // Fill_List
39975>>>>>>>>>>>    //DDB-ValidationCustomStart
39975>>>>>>>>>>>    //DDB-ValidationCustomEnd
39975>>>>>>>>>>>End_Object   // Ptyppar_Year_Recr_VT
39976>>>>>>>>>>>
39976>>>>>>>>>>>Object Ptyppar_Ptyppar_Is_What_VT  is a DescriptionValidationTable
39978>>>>>>>>>>>
39978>>>>>>>>>>>    Procedure Fill_List
39980>>>>>>>>>>>        Forward Send Fill_List
39982>>>>>>>>>>>        Send Add_Table_Value  "1"  "€š¦¨á"
39983>>>>>>>>>>>        Send Add_Table_Value  "2"  "é¢ž©ž"
39984>>>>>>>>>>>        Send Add_Table_Value  "3"  "€ŠŠŽ"
39985>>>>>>>>>>>    End_Procedure    // Fill_List
39986>>>>>>>>>>>    //DDB-ValidationCustomStart
39986>>>>>>>>>>>    //DDB-ValidationCustomEnd
39986>>>>>>>>>>>End_Object   // Ptyppar_Ptyppar_Is_What_VT
39987>>>>>>>>>>>
39987>>>>>>>>>>>Object Ptyppar_Ptyppar_Module_VT  is a CodeValidationTable
39989>>>>>>>>>>>    Set Type_Value        To "MODULE"
39990>>>>>>>>>>>    Set Allow_Blank_State To TRUE
39991>>>>>>>>>>>    //DDB-ValidationCustomStart
39991>>>>>>>>>>>    //DDB-ValidationCustomEnd
39991>>>>>>>>>>>End_Object   // Ptyppar_Ptyppar_Module_VT
39992>>>>>>>>>>>
39992>>>>>>>>>>>Object Ptyppar_Ti_Typonei_Pms_VT1  is a DescriptionValidationTable
39994>>>>>>>>>>>    Set Allow_Blank_State To TRUE
39995>>>>>>>>>>>
39995>>>>>>>>>>>    Procedure Fill_List
39997>>>>>>>>>>>        Forward Send Fill_List
39999>>>>>>>>>>>        Send Add_Table_Value  ""  "¦©æ«ž«œª ¡˜  €¥åœª"
40000>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦©æ«ž«œª"
40001>>>>>>>>>>>        Send Add_Table_Value  "2"  "€¥åœª"
40002>>>>>>>>>>>    End_Procedure    // Fill_List
40003>>>>>>>>>>>    //DDB-ValidationCustomStart
40003>>>>>>>>>>>    //DDB-ValidationCustomEnd
40003>>>>>>>>>>>End_Object   // Ptyppar_Ti_Typonei_Pms_VT1
40004>>>>>>>>>>>//DDB-ValidationEnd
40004>>>>>>>>>>>//DDB-SelectionStart
40004>>>>>>>>>>>//DDB/ ExternalSelectionList sl012  sl012.SL
40004>>>>>>>>>>>Register_Object sl012
40004>>>>>>>>>>>//DDB-SelectionEnd
40004>>>>>>>>>>>
40004>>>>>>>>>>>Class Ptyppar_DataDictionary  is a DataDictionary_Sec
40005>>>>>>>>>>>
40005>>>>>>>>>>>    Procedure Construct_Object
40006>>>>>>>>>>>        Forward Send Construct_Object
40008>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
40009>>>>>>>>>>>        Property Integer piOldCtypkin       Public 0
40010>>>>>>>>>>>        Property Integer piOldWtypkin       Public 0
40011>>>>>>>>>>>    End_Procedure
40012>>>>>>>>>>>
40012>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
40013>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
40015>>>>>>>>>>>        Set piOldCtypkin to Ctypkin.Ctypkin_Code
40016>>>>>>>>>>>        Set piOldWtypkin to Wtypkin.Wtypkin_Code
40017>>>>>>>>>>>    End_Procedure   // New_Current_Record
40018>>>>>>>>>>>
40018>>>>>>>>>>>    Procedure OnConstrain
40019>>>>>>>>>>>        If (piMustNotConstrain(Self)=0) Begin
40021>>>>>>>>>>>            Constrain Ptyppar.Company_Code  eq SysCurXR.Company_Code
40023>>>>>>>>>>>            Constrain Ptyppar.Branch_Code   eq SysCurXR.Branch_Code
40025>>>>>>>>>>>        End
40025>>>>>>>>>>>>
40025>>>>>>>>>>>    End_Procedure
40026>>>>>>>>>>>
40026>>>>>>>>>>>    Procedure Clear_Main_File
40027>>>>>>>>>>>        Forward Send Clear_Main_File
40029>>>>>>>>>>>        Set piOldCtypkin to 0
40030>>>>>>>>>>>        Set piOldWtypkin to 0
40031>>>>>>>>>>>    End_Procedure
40032>>>>>>>>>>>
40032>>>>>>>>>>>    Procedure Save_Main_File
40033>>>>>>>>>>>        Integer isAdmin iYes
40034>>>>>>>>>>>        String  sStr
40034>>>>>>>>>>>        Get fig_Is_Admin to isAdmin
40035>>>>>>>>>>>
40035>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
40037>>>>>>>>>>>            If Ptyppar.Recnum Eq 0 Procedure_Return
40040>>>>>>>>>>>        End
40040>>>>>>>>>>>>
40040>>>>>>>>>>>
40040>>>>>>>>>>>        If (Operation_Origin=Self) Begin
40042>>>>>>>>>>>            If ((piOldCtypkin(Self)<>0) And (piOldCtypkin(Self)<>Ctypkin.Ctypkin_Code)) Begin
40044>>>>>>>>>>>                If (Not(isAdmin)) Error 1001 'ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ¡å¤ž©žª §œ¢á«ž'
40047>>>>>>>>>>>                Else Begin
40048>>>>>>>>>>>                    Move '' to sStr
40049>>>>>>>>>>>                    Append sStr '€¤ ˜¢¢á¥œ«œ ¡å¤ž©ž, £§¦¨œå ¤˜ œ§ž¨œá©œ  ã›ž ¡˜«˜®à¨ž£â¤˜ §˜¨˜©«˜« ¡á\n «˜ ¦§¦å˜ â®¦¬¤ ­« ˜®«œå £œ « ª §˜¢ âª ¡ ¤ã©œ ª §¦¬ «é¨˜ ˜¢¢áœ«œ\n„å©«œ ™â™˜ ¦  §àª Ÿâ¢œ«œ ¤˜ ©¬¤œ®å©à ?'
40050>>>>>>>>>>>                    Get YesNo_Box sStr to iYes
40051>>>>>>>>>>>                    If (iYes=MBR_NO) Error 1000 '€¡¬¨éŸž¡œ ž › ˜› ¡˜©å˜ ˜¢¢˜šãª ˜§¦ «¦¤ ®¨ã©«ž'
40054>>>>>>>>>>>                End
40054>>>>>>>>>>>>
40054>>>>>>>>>>>            End // If ((piOldCtypkin(Self)<>0) And (piOldCtypkin(Self)<>Ctypkin.Ctypkin_Code))
40054>>>>>>>>>>>>
40054>>>>>>>>>>>            If ((piOldWtypkin(Self)<>0) And (piOldWtypkin(Self)<>Wtypkin.Wtypkin_Code)) Begin
40056>>>>>>>>>>>                If (Not(isAdmin)) Error 1002 'ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ¡å¤ž©žª ˜§¦Ÿã¡žª'
40059>>>>>>>>>>>                Else Begin
40060>>>>>>>>>>>                    Move '' to sStr
40061>>>>>>>>>>>                    Append sStr '€¤ ˜¢¢á¥œ«œ ¡å¤ž©ž, £§¦¨œå ¤˜ œ§ž¨œá©œ  ã›ž ¡˜«˜®à¨ž£â¤˜ §˜¨˜©«˜« ¡á\n «˜ ¦§¦å˜ â®¦¬¤ ­« ˜®«œå £œ « ª §˜¢ âª ¡ ¤ã©œ ª §¦¬ «é¨˜ ˜¢¢áœ«œ\n„å©«œ ™â™˜ ¦  §àª Ÿâ¢œ«œ ¤˜ ©¬¤œ®å©à ?'
40062>>>>>>>>>>>                    Get YesNo_Box sStr to iYes
40063>>>>>>>>>>>                    If (iYes=MBR_NO) Error 1000 '€¡¬¨éŸž¡œ ž › ˜› ¡˜©å˜ ˜¢¢˜šãª ˜§¦ «¦¤ ®¨ã©«ž'
40066>>>>>>>>>>>                End
40066>>>>>>>>>>>>
40066>>>>>>>>>>>            End // ((piOldWtypkin(Self)<>0) And (piOldWtypkin(Self)<>Wtypkin.Wtypkin_Code))
40066>>>>>>>>>>>>
40066>>>>>>>>>>>        End // If (Operation_Origin=Self)
40066>>>>>>>>>>>>
40066>>>>>>>>>>>        Forward Send Save_Main_File
40068>>>>>>>>>>>    End_Procedure // Save_Main_File
40069>>>>>>>>>>>
40069>>>>>>>>>>>
40069>>>>>>>>>>>    Procedure Update
40070>>>>>>>>>>>        Forward Send Update
40072>>>>>>>>>>>        // Insert Code Here
40072>>>>>>>>>>>//        If (piMustNotConstrain(Self)=0) Begin
40072>>>>>>>>>>>            Move SysCurXR.Company_Code  to Ptyppar.Company_Code
40073>>>>>>>>>>>            Move SysCurXR.Branch_Code   to Ptyppar.Branch_Code
40074>>>>>>>>>>>//        end
40074>>>>>>>>>>>//        Move SysCurXR.Year_Year     to Ptyppar.Year_Year
40074>>>>>>>>>>>//        Move SysCurXR.Year_Recr     to Ptyppar.Year_Recr
40074>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Ptyppar.Ctypkin_Code
40075>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Ptyppar.Wtypkin_Code
40076>>>>>>>>>>>        if (ptyppar.sysxet_ptyppar='');            move '' to ptyppar.sysx_ptyp_recr
40079>>>>>>>>>>>    End_Procedure   // Update
40080>>>>>>>>>>>
40080>>>>>>>>>>>    Procedure Creating
40081>>>>>>>>>>>        Forward Send Creating
40083>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Ptyppar.Ptyppar_Rec0)))))) to Ptyppar.Ptyppar_Recr
40084>>>>>>>>>>>    End_Procedure   // Creating
40085>>>>>>>>>>>
40085>>>>>>>>>>>
40085>>>>>>>>>>>    // Define_Fields:
40085>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
40085>>>>>>>>>>>    Procedure Define_Fields
40086>>>>>>>>>>>        Forward Send Define_Fields
40088>>>>>>>>>>>        //DDB-Generated-Code-Location
40088>>>>>>>>>>>        //DDB-DefineFieldStart
40088>>>>>>>>>>>
40088>>>>>>>>>>>        Set Main_File            To Ptyppar.File_Number
40089>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
40090>>>>>>>>>>>
40090>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
40091>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
40092>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
40093>>>>>>>>>>>
40093>>>>>>>>>>>        // Child (Client) file structure................
40093>>>>>>>>>>>        Send Add_Client_File  Particle.File_Number
40094>>>>>>>>>>>        Send Add_Client_File  Pseira.File_Number
40095>>>>>>>>>>>        Send Add_Client_File  Ptypmet.File_Number
40096>>>>>>>>>>>        Send Add_Client_File  Ptypparh.File_Number
40097>>>>>>>>>>>
40097>>>>>>>>>>>        // Parent (Server) file structure...............
40097>>>>>>>>>>>        Send Add_Server_File  Ctypkin.File_Number
40098>>>>>>>>>>>        Send Add_Server_File  Wtypkin.File_Number
40099>>>>>>>>>>>
40099>>>>>>>>>>>        // External (System) file structure.............
40099>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
40100>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
40101>>>>>>>>>>>
40101>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Ptyppar_Rec0  To Ptyppar.Ptyppar_Rec0
40104>>>>>>>>>>>
40104>>>>>>>>>>>        // Field-based properties.......................
40104>>>>>>>>>>>
40104>>>>>>>>>>>        // Ptyppar.Company_Code
40104>>>>>>>>>>>
40104>>>>>>>>>>>        // Ptyppar.Branch_Code
40104>>>>>>>>>>>
40104>>>>>>>>>>>        // Ptyppar.Year_Year
40104>>>>>>>>>>>
40104>>>>>>>>>>>        // Ptyppar.Ctypkin_Code
40104>>>>>>>>>>>
40104>>>>>>>>>>>        // Ptyppar.Wtypkin_Code
40104>>>>>>>>>>>
40104>>>>>>>>>>>        // Ptyppar.Year_Recr
40104>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Year_Recr To (Ptyppar_Year_Recr_VT(Self))
40105>>>>>>>>>>>
40105>>>>>>>>>>>        // Ptyppar.Ctypkin_Recr
40105>>>>>>>>>>>
40105>>>>>>>>>>>        // Ptyppar.Wtypkin_Recr
40105>>>>>>>>>>>
40105>>>>>>>>>>>        // Ptyppar.Ptyppar_Code
40105>>>>>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Code To DD_AUTOFIND
40106>>>>>>>>>>>        Set Field_Prompt_Object    Field Ptyppar.Ptyppar_Code To (sl012(Self))
40107>>>>>>>>>>>        Set Key_Field_State        Field Ptyppar.Ptyppar_Code To TRUE
40108>>>>>>>>>>>
40108>>>>>>>>>>>        // Ptyppar.Ptyppar_Rec0
40108>>>>>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Rec0 To DD_AUTOFIND
40109>>>>>>>>>>>
40109>>>>>>>>>>>        // Ptyppar.Ptyppar_Descr
40109>>>>>>>>>>>        Set Field_Prompt_Object    Field Ptyppar.Ptyppar_Descr To (sl012(Self))
40110>>>>>>>>>>>
40110>>>>>>>>>>>        // Ptyppar.Ptyppar_Recr
40110>>>>>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Recr To DD_AUTOFIND
40111>>>>>>>>>>>
40111>>>>>>>>>>>        // Ptyppar.Ptyppar_Is_What
40111>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ptyppar_Is_What To (Ptyppar_Ptyppar_Is_What_VT(Self))
40112>>>>>>>>>>>
40112>>>>>>>>>>>        // Ptyppar.Ptyppar_Module
40112>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ptyppar_Module To (Ptyppar_Ptyppar_Module_VT(Self))
40113>>>>>>>>>>>
40113>>>>>>>>>>>        // Ptyppar.Ptyppar_Abrev
40113>>>>>>>>>>>
40113>>>>>>>>>>>        // Ptyppar.Ftiaxnei_Tpay
40113>>>>>>>>>>>        Set Field_Class_Name       Field Ptyppar.Ftiaxnei_Tpay To "dbCheckBoxsub"
40114>>>>>>>>>>>
40114>>>>>>>>>>>        // Ptyppar.Ti_Typonei_Pms
40114>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ti_Typonei_Pms To (Ptyppar_Ti_Typonei_Pms_VT1(Self))
40115>>>>>>>>>>>
40115>>>>>>>>>>>        // Ptyppar.Einai_Paroxh_Yp
40115>>>>>>>>>>>        Set Field_Checkbox_Values  Field Ptyppar.Einai_Paroxh_Yp To "1"  "0"
40116>>>>>>>>>>>        Set Field_Class_Name       Field Ptyppar.Einai_Paroxh_Yp To "dbCheckBoxsub"
40117>>>>>>>>>>>
40117>>>>>>>>>>>        // Ptyppar.Gtypkin_Code
40117>>>>>>>>>>>
40117>>>>>>>>>>>        // Ptyppar.Sysxet_Ptyppar
40117>>>>>>>>>>>
40117>>>>>>>>>>>        // Ptyppar.Sysx_Ptyp_Recr
40117>>>>>>>>>>>
40117>>>>>>>>>>>        // Ptyppar.Check_Posa_Plaf
40117>>>>>>>>>>>
40117>>>>>>>>>>>        // Ptyppar.Singular
40117>>>>>>>>>>>
40117>>>>>>>>>>>        // Ptyppar.Sub
40117>>>>>>>>>>>
40117>>>>>>>>>>>        // Ptyppar.Constrain
40117>>>>>>>>>>>
40117>>>>>>>>>>>        // Ptyppar.Label
40117>>>>>>>>>>>
40117>>>>>>>>>>>        // Ptyppar.Label1
40117>>>>>>>>>>>
40117>>>>>>>>>>>        // Ptyppar.Sap
40117>>>>>>>>>>>
40117>>>>>>>>>>>        // Ptyppar.Is_Xondr
40117>>>>>>>>>>>
40117>>>>>>>>>>>        //DDB-DefineFieldEnd
40117>>>>>>>>>>>    End_Procedure    // Define_Fields
40118>>>>>>>>>>>
40118>>>>>>>>>>>    // Field_Defaults:
40118>>>>>>>>>>>    // This procedure is used to establish default field values.
40118>>>>>>>>>>>
40118>>>>>>>>>>>    Procedure Field_Defaults
40119>>>>>>>>>>>        Forward Send Field_Defaults
40121>>>>>>>>>>>        //DDB-Generated-Code-Location
40121>>>>>>>>>>>        //DDB-FieldDefaultStart
40121>>>>>>>>>>>        Set Field_Changed_Value   Field Ptyppar.Ftiaxnei_Tpay To "1"
40122>>>>>>>>>>>        Set Field_Changed_Value   Field Ptyppar.Einai_Paroxh_Yp To 0
40123>>>>>>>>>>>        //DDB-FieldDefaultEnd
40123>>>>>>>>>>>    End_Procedure    // Field_Defaults
40124>>>>>>>>>>>
40124>>>>>>>>>>>End_Class    // Ptyppar_DataDictionary
40125>>>>>>>>>>>//DDB-Selection-pkg-Start
40125>>>>>>>>>>>
40125>>>>>>>>>>>Use sl012.SL         // sl012
INCLUDING FILE: SL012.SL
40125>>>>>>>>>>>>>//AB/ Project sl012 : Ptyppar
40125>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
40125>>>>>>>>>>>>>//AB/     Set ProjectName to "sl012 : Ptyppar"
40125>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl012.SL"
40125>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
40125>>>>>>>>>>>>>
40125>>>>>>>>>>>>>// Project Object Structure
40125>>>>>>>>>>>>>//   sl012 is a dbModalPanelSub
40125>>>>>>>>>>>>>//     Ctypkin_DD is a DataDictionary
40125>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
40125>>>>>>>>>>>>>//     Ptyppar_DD is a DataDictionary
40125>>>>>>>>>>>>>//     oSelList is a dbListSub
40125>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
40125>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
40125>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
40125>>>>>>>>>>>>>
40125>>>>>>>>>>>>>// Register all objects
40125>>>>>>>>>>>>>Register_Object Ctypkin_DD
40125>>>>>>>>>>>>>Register_Object oCancel_bn
40125>>>>>>>>>>>>>Register_Object oOK_bn
40125>>>>>>>>>>>>>Register_Object oSearch_bn
40125>>>>>>>>>>>>>Register_Object oSelList
40125>>>>>>>>>>>>>Register_Object Ptyppar_DD
40125>>>>>>>>>>>>>Register_Object sl012
40125>>>>>>>>>>>>>Register_Object Wtypkin_DD
40125>>>>>>>>>>>>>
40125>>>>>>>>>>>>>
40125>>>>>>>>>>>>>//AB-IgnoreStart
40125>>>>>>>>>>>>>
40125>>>>>>>>>>>>>Use DFAllEnt.pkg
40125>>>>>>>>>>>>>Use dbList.Sub
40125>>>>>>>>>>>>>Use Button.Sub
40125>>>>>>>>>>>>>
40125>>>>>>>>>>>>>
40125>>>>>>>>>>>>>Use CTYPKIN.DD
40125>>>>>>>>>>>>>Use WTYPKIN.DD
40125>>>>>>>>>>>>>Use PTYPPAR.DD
40125>>>>>>>>>>>>>
40125>>>>>>>>>>>>>//AB-IgnoreEnd
40125>>>>>>>>>>>>>
40125>>>>>>>>>>>>>Object sl012 is a dbModalPanelSub
40127>>>>>>>>>>>>>
40127>>>>>>>>>>>>>    //AB-StoreTopStart
40127>>>>>>>>>>>>>    Property String psModule Public ''
40129>>>>>>>>>>>>>    Property integer pifromclient Public 0
40131>>>>>>>>>>>>>    
40131>>>>>>>>>>>>>    //AB-StoreTopEnd
40131>>>>>>>>>>>>>
40131>>>>>>>>>>>>>    Set Label to "’ç§¦  §˜¨˜©«˜« ¡é¤"
40132>>>>>>>>>>>>>    Set Size to 203 490
40133>>>>>>>>>>>>>    Set Location to 4 4
40134>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
40135>>>>>>>>>>>>>    Set Modal_State to FALSE
40136>>>>>>>>>>>>>
40136>>>>>>>>>>>>>    //AB-DDOStart
40136>>>>>>>>>>>>>
40136>>>>>>>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
40138>>>>>>>>>>>>>    End_Object    // Ctypkin_DD
40139>>>>>>>>>>>>>
40139>>>>>>>>>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
40141>>>>>>>>>>>>>    End_Object    // Wtypkin_DD
40142>>>>>>>>>>>>>
40142>>>>>>>>>>>>>    Object Ptyppar_DD is a Ptyppar_DataDictionary
40144>>>>>>>>>>>>>        Set DDO_Server to (Ctypkin_DD(self))
40145>>>>>>>>>>>>>        Set DDO_Server to (Wtypkin_DD(self))
40146>>>>>>>>>>>>>
40146>>>>>>>>>>>>>        //AB-StoreStart
40146>>>>>>>>>>>>>        
40146>>>>>>>>>>>>>        Procedure OnConstrain
40148>>>>>>>>>>>>>            Forward Send OnConstrain
40150>>>>>>>>>>>>>            If (psModule(Self)<>'') Begin
40152>>>>>>>>>>>>>                Constrain Ptyppar.Ptyppar_Module eq (psModule(Self))
40154>>>>>>>>>>>>>            End
40154>>>>>>>>>>>>>>
40154>>>>>>>>>>>>>            If (pifromclient(self)=1) Begin
40156>>>>>>>>>>>>>                Constrain Ptyppar.constrain eq '1'
40158>>>>>>>>>>>>>            End
40158>>>>>>>>>>>>>>
40158>>>>>>>>>>>>>        End_Procedure
40159>>>>>>>>>>>>>        
40159>>>>>>>>>>>>>        
40159>>>>>>>>>>>>>        
40159>>>>>>>>>>>>>        
40159>>>>>>>>>>>>>        //AB-StoreEnd
40159>>>>>>>>>>>>>
40159>>>>>>>>>>>>>    End_Object    // Ptyppar_DD
40160>>>>>>>>>>>>>
40160>>>>>>>>>>>>>    Set Main_DD to (Ptyppar_DD(self))
40161>>>>>>>>>>>>>    Set Server to (Ptyppar_DD(self))
40162>>>>>>>>>>>>>
40162>>>>>>>>>>>>>    //AB-DDOEnd
40162>>>>>>>>>>>>>
40162>>>>>>>>>>>>>    Object oSelList is a dbListSub
40164>>>>>>>>>>>>>        Set Main_File to Ptyppar.File_Number
40165>>>>>>>>>>>>>        Set Size to 161 474
40166>>>>>>>>>>>>>        Set Location to 6 6
40167>>>>>>>>>>>>>
40167>>>>>>>>>>>>>        Begin_Row
40170>>>>>>>>>>>>>            Entry_Item Ptyppar.Ptyppar_code
40171>>>>>>>>>>>>>            Entry_Item Ptyppar.Ptyppar_descr
40172>>>>>>>>>>>>>            Entry_Item Ctypkin.Ctypkin_descr
40173>>>>>>>>>>>>>            Entry_Item Wtypkin.Wtypkin_descr
40174>>>>>>>>>>>>>        End_Row
40179>>>>>>>>>>>>>
40179>>>>>>>>>>>>>        Set Form_Width    item 0 to 77
40180>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à›. ˜¨˜©«˜« ¡¦ç"
40181>>>>>>>>>>>>>        
40181>>>>>>>>>>>>>        Set Form_Width    item 1 to 125
40182>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
40183>>>>>>>>>>>>>        
40183>>>>>>>>>>>>>        Set Form_Width    item 2 to 137
40184>>>>>>>>>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
40185>>>>>>>>>>>>>        
40185>>>>>>>>>>>>>        Set Form_Width    item 3 to 129
40186>>>>>>>>>>>>>        Set Header_Label  item 3 to "‰å¤ž©ž €§¦Ÿã¡žª"
40187>>>>>>>>>>>>>        
40187>>>>>>>>>>>>>
40187>>>>>>>>>>>>>        //AB-StoreStart
40187>>>>>>>>>>>>>        
40187>>>>>>>>>>>>>        Procedure Activate
40189>>>>>>>>>>>>>            Forward Send Activate
40191>>>>>>>>>>>>>            Send Rebuild_Constraints to Ptyppar_DD
40192>>>>>>>>>>>>>            Send Beginning_Of_Data to oSelList True
40193>>>>>>>>>>>>>        End_Procedure
40194>>>>>>>>>>>>>        
40194>>>>>>>>>>>>>        //AB-StoreEnd
40194>>>>>>>>>>>>>
40194>>>>>>>>>>>>>    End_Object    // oSelList
40195>>>>>>>>>>>>>
40195>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
40197>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
40198>>>>>>>>>>>>>        Set Location to 171 323
40199>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
40200>>>>>>>>>>>>>
40200>>>>>>>>>>>>>        //AB-StoreStart
40200>>>>>>>>>>>>>        Procedure OnClick
40202>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
40203>>>>>>>>>>>>>        End_Procedure
40204>>>>>>>>>>>>>        //AB-StoreEnd
40204>>>>>>>>>>>>>
40204>>>>>>>>>>>>>    End_Object    // oOK_bn
40205>>>>>>>>>>>>>
40205>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
40207>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
40208>>>>>>>>>>>>>        Set Location to 171 377
40209>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
40210>>>>>>>>>>>>>
40210>>>>>>>>>>>>>        //AB-StoreStart
40210>>>>>>>>>>>>>        Procedure OnClick
40212>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
40213>>>>>>>>>>>>>        End_Procedure
40214>>>>>>>>>>>>>        //AB-StoreEnd
40214>>>>>>>>>>>>>
40214>>>>>>>>>>>>>    End_Object    // oCancel_bn
40215>>>>>>>>>>>>>
40215>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
40217>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
40218>>>>>>>>>>>>>        Set Location to 171 433
40219>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
40220>>>>>>>>>>>>>
40220>>>>>>>>>>>>>        //AB-StoreStart
40220>>>>>>>>>>>>>        Procedure OnClick
40222>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
40223>>>>>>>>>>>>>        End_Procedure
40224>>>>>>>>>>>>>        //AB-StoreEnd
40224>>>>>>>>>>>>>
40224>>>>>>>>>>>>>    End_Object    // oSearch_bn
40225>>>>>>>>>>>>>
40225>>>>>>>>>>>>>
40225>>>>>>>>>>>>>    //AB-StoreStart
40225>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
40226>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
40227>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
40228>>>>>>>>>>>>>    
40228>>>>>>>>>>>>>    
40228>>>>>>>>>>>>>    //AB-StoreEnd
40228>>>>>>>>>>>>>
40228>>>>>>>>>>>>>End_Object    // sl012
40229>>>>>>>>>>>>>
40229>>>>>>>>>>>>>//AB/ End_Object    // prj
40229>>>>>>>>>>>
40229>>>>>>>>>>>//DDB-Selection-pkg-End
40229>>>>>>>>>>>//DDB-FileEnd
40229>>>>>>>>>    Use PSEIRA.DD
INCLUDING FILE: PSEIRA.DD
40229>>>>>>>>>>>//DDB-FileStart
40229>>>>>>>>>>>//DDB-HeaderStart
40229>>>>>>>>>>>
40229>>>>>>>>>>>// File Name : PSEIRA.DD
40229>>>>>>>>>>>// Class Name: Pseira_DataDictionary
40229>>>>>>>>>>>// Revision  : 34
40229>>>>>>>>>>>// Version   : 2
40229>>>>>>>>>>>
40229>>>>>>>>>>>Use  Windows           // Basic Definitions
40229>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
40229>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40229>>>>>>>>>>>
40229>>>>>>>>>>>Open Pseira
40231>>>>>>>>>>>Open Ptyppar
40233>>>>>>>>>>>Open Sysrecp
40235>>>>>>>>>>>Open Syscurxr
40237>>>>>>>>>>>
40237>>>>>>>>>>>//DDB-HeaderEnd
40237>>>>>>>>>>>//DDB-SelectionStart
40237>>>>>>>>>>>//DDB/ ExternalSelectionList sl013  sl013.SL
40237>>>>>>>>>>>Register_Object sl013
40237>>>>>>>>>>>//DDB-SelectionEnd
40237>>>>>>>>>>>
40237>>>>>>>>>>>Class Pseira_DataDictionary  is a DataDictionary
40238>>>>>>>>>>>
40238>>>>>>>>>>>    Procedure Save_Main_File
40239>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
40241>>>>>>>>>>>            If Pseira.Recnum Eq 0 Procedure_Return
40244>>>>>>>>>>>        End
40244>>>>>>>>>>>>
40244>>>>>>>>>>>        Forward Send Save_Main_File
40246>>>>>>>>>>>    End_Procedure
40247>>>>>>>>>>>
40247>>>>>>>>>>>    Procedure Update
40248>>>>>>>>>>>        Forward Send Update
40250>>>>>>>>>>>        // Insert Code Here
40250>>>>>>>>>>>        Move SysCurXR.Company_Code  to Pseira.Company_Code
40251>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Pseira.Branch_Code
40252>>>>>>>>>>>        Move SysCurXR.Year_Year     to Pseira.Year_Year
40253>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Pseira.Ctypkin_Code
40254>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Pseira.Wtypkin_Code
40255>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code   to Pseira.Ptyppar_Code
40256>>>>>>>>>>>    End_Procedure   // Update
40257>>>>>>>>>>>
40257>>>>>>>>>>>
40257>>>>>>>>>>>     Procedure Creating
40258>>>>>>>>>>>        Forward Send Creating
40260>>>>>>>>>>>        // Insert Code Here
40260>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Pseira.Pseira_Rec0)))))) to Pseira.Pseira_Recr
40261>>>>>>>>>>>    End_Procedure   // Creating
40262>>>>>>>>>>>
40262>>>>>>>>>>>
40262>>>>>>>>>>>    // Define_Fields:
40262>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
40262>>>>>>>>>>>
40262>>>>>>>>>>>    Procedure Define_Fields
40263>>>>>>>>>>>        Forward Send Define_Fields
40265>>>>>>>>>>>        //DDB-Generated-Code-Location
40265>>>>>>>>>>>        //DDB-DefineFieldStart
40265>>>>>>>>>>>
40265>>>>>>>>>>>        Set Main_File            To Pseira.File_Number
40266>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
40267>>>>>>>>>>>
40267>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
40268>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
40269>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
40270>>>>>>>>>>>
40270>>>>>>>>>>>        // Parent (Server) file structure...............
40270>>>>>>>>>>>        Send Add_Server_File  Ptyppar.File_Number
40271>>>>>>>>>>>
40271>>>>>>>>>>>        // External (System) file structure.............
40271>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
40272>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
40273>>>>>>>>>>>
40273>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Pseira_Rec0  To Pseira.Pseira_Rec0
40276>>>>>>>>>>>
40276>>>>>>>>>>>        // Field-based properties.......................
40276>>>>>>>>>>>
40276>>>>>>>>>>>        // Pseira.Company_Code
40276>>>>>>>>>>>
40276>>>>>>>>>>>        // Pseira.Branch_Code
40276>>>>>>>>>>>
40276>>>>>>>>>>>        // Pseira.Year_Year
40276>>>>>>>>>>>
40276>>>>>>>>>>>        // Pseira.Ctypkin_Code
40276>>>>>>>>>>>
40276>>>>>>>>>>>        // Pseira.Wtypkin_Code
40276>>>>>>>>>>>
40276>>>>>>>>>>>        // Pseira.Ptyppar_Code
40276>>>>>>>>>>>
40276>>>>>>>>>>>        // Pseira.Ptyppar_Recr
40276>>>>>>>>>>>
40276>>>>>>>>>>>        // Pseira.Pseira_Seira
40276>>>>>>>>>>>        Set Field_Options          Field Pseira.Pseira_Seira To DD_AUTOFIND   
40277>>>>>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Seira To (sl013(Self))
40278>>>>>>>>>>>
40278>>>>>>>>>>>        // Pseira.Pseira_Rec0
40278>>>>>>>>>>>        Set Field_Options          Field Pseira.Pseira_Rec0 To DD_AUTOFIND   
40279>>>>>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Rec0 To (sl013(Self))
40280>>>>>>>>>>>
40280>>>>>>>>>>>        // Pseira.Pseira_Recr
40280>>>>>>>>>>>        Set Field_Options          Field Pseira.Pseira_Recr To DD_AUTOFIND   
40281>>>>>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Recr To (sl013(Self))
40282>>>>>>>>>>>
40282>>>>>>>>>>>        // Pseira.Pseira_Printer
40282>>>>>>>>>>>
40282>>>>>>>>>>>        // Pseira.Pseira_Form
40282>>>>>>>>>>>
40282>>>>>>>>>>>        // Pseira.Pseira_Autonum
40282>>>>>>>>>>>
40282>>>>>>>>>>>        // Pseira.Autonum_Plus
40282>>>>>>>>>>>
40282>>>>>>>>>>>        // Pseira.Autonum_Minus
40282>>>>>>>>>>>
40282>>>>>>>>>>>        // Pseira.Auto_Plus_Last
40282>>>>>>>>>>>
40282>>>>>>>>>>>        //DDB-DefineFieldEnd
40282>>>>>>>>>>>    End_Procedure    // Define_Fields
40283>>>>>>>>>>>
40283>>>>>>>>>>>    // Field_Defaults:
40283>>>>>>>>>>>    // This procedure is used to establish default field values.
40283>>>>>>>>>>>
40283>>>>>>>>>>>    Procedure Field_Defaults
40284>>>>>>>>>>>        Forward Send Field_Defaults
40286>>>>>>>>>>>        //DDB-Generated-Code-Location
40286>>>>>>>>>>>        //DDB-FieldDefaultStart
40286>>>>>>>>>>>        //DDB-FieldDefaultEnd
40286>>>>>>>>>>>    End_Procedure    // Field_Defaults
40287>>>>>>>>>>>
40287>>>>>>>>>>>End_Class    // Pseira_DataDictionary
40288>>>>>>>>>>>//DDB-Selection-pkg-Start
40288>>>>>>>>>>>
40288>>>>>>>>>>>Use sl013.SL         // sl013
INCLUDING FILE: SL013.SL
40288>>>>>>>>>>>>>//AB/ Project sl013:SeiraP
40288>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
40288>>>>>>>>>>>>>//AB/         Set ProjectName to "sl013:SeiraP"
40288>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl013.SL"
40288>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
40288>>>>>>>>>>>>>
40288>>>>>>>>>>>>>// Project Object Structure
40288>>>>>>>>>>>>>//   sl013 is a dbModalPanelSub
40288>>>>>>>>>>>>>//     Ctypkin_DD is a DataDictionary
40288>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
40288>>>>>>>>>>>>>//     Ptyppar_DD is a DataDictionary
40288>>>>>>>>>>>>>//     Pseira_DD is a DataDictionary
40288>>>>>>>>>>>>>//     oSelList is a dbListSub
40288>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
40288>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
40288>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
40288>>>>>>>>>>>>>
40288>>>>>>>>>>>>>// Register all objects
40288>>>>>>>>>>>>>Register_Object Ctypkin_DD
40288>>>>>>>>>>>>>Register_Object oCancel_bn
40288>>>>>>>>>>>>>Register_Object oOK_bn
40288>>>>>>>>>>>>>Register_Object oSearch_bn
40288>>>>>>>>>>>>>Register_Object oSelList
40288>>>>>>>>>>>>>Register_Object Pseira_DD
40288>>>>>>>>>>>>>Register_Object Ptyppar_DD
40288>>>>>>>>>>>>>Register_Object sl013
40288>>>>>>>>>>>>>Register_Object Wtypkin_DD
40288>>>>>>>>>>>>>
40288>>>>>>>>>>>>>
40288>>>>>>>>>>>>>    //AB-IgnoreStart
40288>>>>>>>>>>>>>
40288>>>>>>>>>>>>>    Use DFAllEnt.pkg
40288>>>>>>>>>>>>>    Use dbList.Sub
40288>>>>>>>>>>>>>    Use Button.Sub
40288>>>>>>>>>>>>>
40288>>>>>>>>>>>>>
40288>>>>>>>>>>>>>    Use CTYPKIN.DD
40288>>>>>>>>>>>>>    Use WTYPKIN.DD
40288>>>>>>>>>>>>>    Use PTYPPAR.DD
40288>>>>>>>>>>>>>    Use PSEIRA.DD
40288>>>>>>>>>>>>>    
40288>>>>>>>>>>>>>    //AB-IgnoreEnd
40288>>>>>>>>>>>>>
40288>>>>>>>>>>>>>    Object sl013 is a dbModalPanelSub
40290>>>>>>>>>>>>>
40290>>>>>>>>>>>>>        //AB-StoreTopStart
40290>>>>>>>>>>>>>        Property String FragmaPtyppar_Recr Public ''
40292>>>>>>>>>>>>>        
40292>>>>>>>>>>>>>        //AB-StoreTopEnd
40292>>>>>>>>>>>>>
40292>>>>>>>>>>>>>        Set Label to "‰˜«á¢¦š¦ª ‘œ ¨é¤"
40293>>>>>>>>>>>>>        Set Size to 148 214
40294>>>>>>>>>>>>>        Set Location to 1 7
40295>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
40296>>>>>>>>>>>>>        Set Modal_State to FALSE
40297>>>>>>>>>>>>>
40297>>>>>>>>>>>>>        //AB-DDOStart
40297>>>>>>>>>>>>>
40297>>>>>>>>>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
40299>>>>>>>>>>>>>        End_Object    // Ctypkin_DD
40300>>>>>>>>>>>>>
40300>>>>>>>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
40302>>>>>>>>>>>>>        End_Object    // Wtypkin_DD
40303>>>>>>>>>>>>>
40303>>>>>>>>>>>>>        Object Ptyppar_DD is a Ptyppar_DataDictionary
40305>>>>>>>>>>>>>            Set DDO_Server to (Ctypkin_DD(self))
40306>>>>>>>>>>>>>            Set DDO_Server to (Wtypkin_DD(self))
40307>>>>>>>>>>>>>        End_Object    // Ptyppar_DD
40308>>>>>>>>>>>>>
40308>>>>>>>>>>>>>        Object Pseira_DD is a Pseira_DataDictionary
40310>>>>>>>>>>>>>            Set DDO_Server to (Ptyppar_DD(self))
40311>>>>>>>>>>>>>
40311>>>>>>>>>>>>>            //AB-StoreStart
40311>>>>>>>>>>>>>            Procedure OnConstrain
40313>>>>>>>>>>>>>                String sID
40314>>>>>>>>>>>>>                Forward Send OnConstrain
40316>>>>>>>>>>>>>                Get FragmaPtyppar_Recr to sID
40317>>>>>>>>>>>>>                Move (trim(sID)) to sID
40318>>>>>>>>>>>>>                If (sID<>'') Constrain Pseira.Ptyppar_Recr eq sID
40322>>>>>>>>>>>>>            End_procedure
40323>>>>>>>>>>>>>            
40323>>>>>>>>>>>>>            //AB-StoreEnd
40323>>>>>>>>>>>>>
40323>>>>>>>>>>>>>        End_Object    // Pseira_DD
40324>>>>>>>>>>>>>
40324>>>>>>>>>>>>>        Set Main_DD to (Pseira_DD(self))
40325>>>>>>>>>>>>>        Set Server to (Pseira_DD(self))
40326>>>>>>>>>>>>>
40326>>>>>>>>>>>>>        //AB-DDOEnd
40326>>>>>>>>>>>>>
40326>>>>>>>>>>>>>        Object oSelList is a dbListSub
40328>>>>>>>>>>>>>            Set Main_File to Pseira.File_Number
40329>>>>>>>>>>>>>            Set Size to 105 197
40330>>>>>>>>>>>>>            Set Location to 6 6
40331>>>>>>>>>>>>>
40331>>>>>>>>>>>>>            Begin_Row
40334>>>>>>>>>>>>>                Entry_Item Pseira.Pseira_seira
40335>>>>>>>>>>>>>                Entry_Item Pseira.Pseira_printer
40336>>>>>>>>>>>>>                Entry_Item Pseira.Pseira_autonum
40337>>>>>>>>>>>>>            End_Row
40342>>>>>>>>>>>>>
40342>>>>>>>>>>>>>            Set Form_Width    item 0 to 40
40343>>>>>>>>>>>>>            Set Header_Label  item 0 to "‘œ ¨á"
40344>>>>>>>>>>>>>            
40344>>>>>>>>>>>>>            Set Form_Width    item 1 to 135
40345>>>>>>>>>>>>>            Set Header_Label  item 1 to "„¡«¬§à«ãª"
40346>>>>>>>>>>>>>            
40346>>>>>>>>>>>>>            Set Form_Width    item 2 to 16
40347>>>>>>>>>>>>>            Set Header_Label  item 2 to "Autonum"
40348>>>>>>>>>>>>>            Set Column_Checkbox_State  item 2 to True
40349>>>>>>>>>>>>>            
40349>>>>>>>>>>>>>
40349>>>>>>>>>>>>>            //AB-StoreStart
40349>>>>>>>>>>>>>                    
40349>>>>>>>>>>>>>            Property String StoreFragmaPtyppar_Recr Public ''
40351>>>>>>>>>>>>>            
40351>>>>>>>>>>>>>            Procedure Store_Defaults
40353>>>>>>>>>>>>>                   Forward Send Store_Defaults
40355>>>>>>>>>>>>>                   Set StoreFragmaPtyppar_Recr to (FragmaPtyppar_Recr(Self))
40356>>>>>>>>>>>>>            End_Procedure
40357>>>>>>>>>>>>>            
40357>>>>>>>>>>>>>            Procedure ReStore_Defaults
40359>>>>>>>>>>>>>                   Forward Send ReStore_Defaults
40361>>>>>>>>>>>>>                   Set FragmaPtyppar_Recr to (StoreFragmaPtyppar_Recr(Self))
40362>>>>>>>>>>>>>            End_Procedure
40363>>>>>>>>>>>>>            
40363>>>>>>>>>>>>>            Procedure Activating
40365>>>>>>>>>>>>>                Forward Send Activating
40367>>>>>>>>>>>>>                Send Rebuild_Constraints to (Pseira_DD(Self))
40368>>>>>>>>>>>>>            End_Procedure
40369>>>>>>>>>>>>>            
40369>>>>>>>>>>>>>            
40369>>>>>>>>>>>>>            //AB-StoreEnd
40369>>>>>>>>>>>>>
40369>>>>>>>>>>>>>        End_Object    // oSelList
40370>>>>>>>>>>>>>
40370>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
40372>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
40373>>>>>>>>>>>>>            Set Location to 114 42
40374>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
40375>>>>>>>>>>>>>
40375>>>>>>>>>>>>>            //AB-StoreStart
40375>>>>>>>>>>>>>            Procedure OnClick
40377>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
40378>>>>>>>>>>>>>            End_Procedure
40379>>>>>>>>>>>>>            //AB-StoreEnd
40379>>>>>>>>>>>>>
40379>>>>>>>>>>>>>        End_Object    // oOK_bn
40380>>>>>>>>>>>>>
40380>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
40382>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
40383>>>>>>>>>>>>>            Set Location to 114 98
40384>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
40385>>>>>>>>>>>>>
40385>>>>>>>>>>>>>            //AB-StoreStart
40385>>>>>>>>>>>>>            Procedure OnClick
40387>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
40388>>>>>>>>>>>>>            End_Procedure
40389>>>>>>>>>>>>>            //AB-StoreEnd
40389>>>>>>>>>>>>>
40389>>>>>>>>>>>>>        End_Object    // oCancel_bn
40390>>>>>>>>>>>>>
40390>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
40392>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
40393>>>>>>>>>>>>>            Set Location to 114 153
40394>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
40395>>>>>>>>>>>>>
40395>>>>>>>>>>>>>            //AB-StoreStart
40395>>>>>>>>>>>>>            Procedure OnClick
40397>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
40398>>>>>>>>>>>>>            End_Procedure
40399>>>>>>>>>>>>>            //AB-StoreEnd
40399>>>>>>>>>>>>>
40399>>>>>>>>>>>>>        End_Object    // oSearch_bn
40400>>>>>>>>>>>>>
40400>>>>>>>>>>>>>
40400>>>>>>>>>>>>>        //AB-StoreStart
40400>>>>>>>>>>>>>            
40400>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
40401>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
40402>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
40403>>>>>>>>>>>>>        
40403>>>>>>>>>>>>>        
40403>>>>>>>>>>>>>        
40403>>>>>>>>>>>>>        
40403>>>>>>>>>>>>>        
40403>>>>>>>>>>>>>        
40403>>>>>>>>>>>>>        
40403>>>>>>>>>>>>>        
40403>>>>>>>>>>>>>        //AB-StoreEnd
40403>>>>>>>>>>>>>
40403>>>>>>>>>>>>>    End_Object    // sl013
40404>>>>>>>>>>>>>
40404>>>>>>>>>>>>>//AB/     End_Object    // prj
40404>>>>>>>>>>>
40404>>>>>>>>>>>//DDB-Selection-pkg-End
40404>>>>>>>>>>>//DDB-FileEnd
40404>>>>>>>>>    Use NOMISMA.DD
INCLUDING FILE: NOMISMA.DD
40404>>>>>>>>>>>//DDB-FileStart
40404>>>>>>>>>>>//DDB-HeaderStart
40404>>>>>>>>>>>
40404>>>>>>>>>>>// File Name : NOMISMA.DD
40404>>>>>>>>>>>// Class Name: Nomisma_DataDictionary
40404>>>>>>>>>>>// Revision  : 52
40404>>>>>>>>>>>// Version   : 2
40404>>>>>>>>>>>
40404>>>>>>>>>>>Use  Windows           // Basic Definitions
40404>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
40404>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40404>>>>>>>>>>>
40404>>>>>>>>>>>Open Nomisma
40406>>>>>>>>>>>Open Isotimia
40408>>>>>>>>>>>Open Particle
40410>>>>>>>>>>>
40410>>>>>>>>>>>//DDB-HeaderEnd
40410>>>>>>>>>>>//DDB-ValidationStart
40410>>>>>>>>>>>
40410>>>>>>>>>>>Register_Object Nomisma_Nomisma_Type_VT
40410>>>>>>>>>>>Register_Object Nomisma_Nomisma_Sign0_VT
40410>>>>>>>>>>>Register_Object Nomisma_Nomisma_Sign00_VT
40410>>>>>>>>>>>Register_Object Nomisma_Nomisma_Signr_VT
40410>>>>>>>>>>>
40410>>>>>>>>>>>Object Nomisma_Nomisma_Type_VT  is a DescriptionValidationTable
40412>>>>>>>>>>>
40412>>>>>>>>>>>    Procedure Fill_List
40414>>>>>>>>>>>        Forward Send Fill_List
40416>>>>>>>>>>>        Send Add_Table_Value  "1"  "Book1"
40417>>>>>>>>>>>        Send Add_Table_Value  "2"  "Book2"
40418>>>>>>>>>>>        Send Add_Table_Value  "3"  "Reporting"
40419>>>>>>>>>>>        Send Add_Table_Value  "0"  "Other"
40420>>>>>>>>>>>    End_Procedure    // Fill_List
40421>>>>>>>>>>>    //DDB-ValidationCustomStart
40421>>>>>>>>>>>    //DDB-ValidationCustomEnd
40421>>>>>>>>>>>End_Object   // Nomisma_Nomisma_Type_VT
40422>>>>>>>>>>>
40422>>>>>>>>>>>Object Nomisma_Nomisma_Sign0_VT  is a DescriptionValidationTable
40424>>>>>>>>>>>
40424>>>>>>>>>>>    Procedure Fill_List
40426>>>>>>>>>>>        Forward Send Fill_List
40428>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
40429>>>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
40430>>>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨œ¯ £¦"
40431>>>>>>>>>>>    End_Procedure    // Fill_List
40432>>>>>>>>>>>    //DDB-ValidationCustomStart
40432>>>>>>>>>>>    //DDB-ValidationCustomEnd
40432>>>>>>>>>>>End_Object   // Nomisma_Nomisma_Sign0_VT
40433>>>>>>>>>>>
40433>>>>>>>>>>>Object Nomisma_Nomisma_Sign00_VT  is a DescriptionValidationTable
40435>>>>>>>>>>>
40435>>>>>>>>>>>    Procedure Fill_List
40437>>>>>>>>>>>        Forward Send Fill_List
40439>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
40440>>>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
40441>>>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨â¯ £¦"
40442>>>>>>>>>>>    End_Procedure    // Fill_List
40443>>>>>>>>>>>    //DDB-ValidationCustomStart
40443>>>>>>>>>>>    //DDB-ValidationCustomEnd
40443>>>>>>>>>>>End_Object   // Nomisma_Nomisma_Sign00_VT
40444>>>>>>>>>>>
40444>>>>>>>>>>>Object Nomisma_Nomisma_Signr_VT  is a DescriptionValidationTable
40446>>>>>>>>>>>
40446>>>>>>>>>>>    Procedure Fill_List
40448>>>>>>>>>>>        Forward Send Fill_List
40450>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
40451>>>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
40452>>>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨â¯ £¦"
40453>>>>>>>>>>>    End_Procedure    // Fill_List
40454>>>>>>>>>>>    //DDB-ValidationCustomStart
40454>>>>>>>>>>>    //DDB-ValidationCustomEnd
40454>>>>>>>>>>>End_Object   // Nomisma_Nomisma_Signr_VT
40455>>>>>>>>>>>//DDB-ValidationEnd
40455>>>>>>>>>>>//DDB-SelectionStart
40455>>>>>>>>>>>//DDB/ ExternalSelectionList sl059  sl059.sl
40455>>>>>>>>>>>Register_Object sl059
40455>>>>>>>>>>>//DDB-SelectionEnd
40455>>>>>>>>>>>
40455>>>>>>>>>>>Class Nomisma_DataDictionary  is a DataDictionary_Sec
40456>>>>>>>>>>>
40456>>>>>>>>>>>    Procedure Construct_Object
40457>>>>>>>>>>>        Forward Send Construct_Object
40459>>>>>>>>>>>        Property String psOldCode Public ''
40460>>>>>>>>>>>    End_procedure
40461>>>>>>>>>>>
40461>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
40462>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
40464>>>>>>>>>>>        Set psOldCode to Nomisma.Nomisma_Code
40465>>>>>>>>>>>    End_Procedure   // New_Current_Record
40466>>>>>>>>>>>
40466>>>>>>>>>>>    Procedure Save_Main_File
40467>>>>>>>>>>>        If ((Operation_Origin<>Self) And;             (Nomisma.Recnum=0)) Procedure_Return
40470>>>>>>>>>>>        Forward Send Save_Main_File
40472>>>>>>>>>>>    End_Procedure   // Save_Main_File
40473>>>>>>>>>>>
40473>>>>>>>>>>>    Function Validate_Save  Returns Integer
40474>>>>>>>>>>>        Local Integer iReturnVal 
40475>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
40477>>>>>>>>>>>        If (Not(iReturnVal)) ;            Begin
40479>>>>>>>>>>>                     If  Nomisma.nomisma_Code eq ''                 Move 6220 to iReturnVal
40482>>>>>>>>>>>                Else If (Nomisma.Nomisma_Code <>(psOldCode(Self)) And ;                         (psOldCode(Self)<>''))  Move 6030 to iReturnVal
40486>>>>>>>>>>>                if iReturnVal Send Operation_Not_Allowed iReturnVal
40489>>>>>>>>>>>            End
40489>>>>>>>>>>>>
40489>>>>>>>>>>>        Function_Return iReturnVal
40490>>>>>>>>>>>    End_Function   // Validate_Save
40491>>>>>>>>>>>
40491>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
40492>>>>>>>>>>>             if iError_num eq 6220 error 6220 "Œ¦£ ©£˜«˜ => ‰à› ¡æª ¡œ¤æª "
40495>>>>>>>>>>>        Else if iError_num eq 6030 error 6030 "„§ ¢â¥«œ ¤æ£ ©£˜ ˜§¦ «ž¤ ¢å©«˜ £œ (F4)\nž §˜«ã©«œ §¨é«˜ F5 ©«¦ ž›ž ¬§á¨®¦¤\nà©«œ ¤˜ ¡˜Ÿ˜¨å©œ  ž ˜¨® ¡ã «¦¬ « £ã\n§¨å¤ œ§ ¢â¥œ«œ á¢¢¦"
40499>>>>>>>>>>>        //Else if iError_num eq 6030 error 6030 "ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ©«¦ ¡à› ¡æ ¤¦£å©£˜«¦ª"
40499>>>>>>>>>>>        else Forward Send Operation_Not_Allowed  iError_Num
40502>>>>>>>>>>>    End_Procedure   // Operation_Not_Allowed
40503>>>>>>>>>>>
40503>>>>>>>>>>>    Procedure Update
40504>>>>>>>>>>>        Forward Send Update
40506>>>>>>>>>>>        // Insert Code Here
40506>>>>>>>>>>>        SYSDATE NOMISMA.LUP
40507>>>>>>>>>>>    End_Procedure   // Update
40508>>>>>>>>>>>
40508>>>>>>>>>>>    Procedure Creating
40509>>>>>>>>>>>        Forward Send Creating
40511>>>>>>>>>>>        // Insert Code Here
40511>>>>>>>>>>>        SYSDATE NOMISMA.FUP
40512>>>>>>>>>>>    End_Procedure   // Creating
40513>>>>>>>>>>>
40513>>>>>>>>>>>    // Define_Fields:
40513>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
40513>>>>>>>>>>>
40513>>>>>>>>>>>    Procedure Define_Fields
40514>>>>>>>>>>>        Forward Send Define_Fields
40516>>>>>>>>>>>        //DDB-Generated-Code-Location
40516>>>>>>>>>>>        //DDB-DefineFieldStart
40516>>>>>>>>>>>
40516>>>>>>>>>>>        Set Main_File            To Nomisma.File_Number
40517>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
40518>>>>>>>>>>>
40518>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
40519>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
40520>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
40521>>>>>>>>>>>
40521>>>>>>>>>>>        // Child (Client) file structure................
40521>>>>>>>>>>>        Send Add_Client_File  Isotimia.File_Number
40522>>>>>>>>>>>        Send Add_Client_File  Particle.File_Number
40523>>>>>>>>>>>
40523>>>>>>>>>>>        // Field-based properties.......................
40523>>>>>>>>>>>
40523>>>>>>>>>>>        // Nomisma.Nomisma_Code
40523>>>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Code To DD_AUTOFIND    DD_CAPSLOCK   
40524>>>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Code To (sl059(Self))
40525>>>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Code To TRUE
40526>>>>>>>>>>>
40526>>>>>>>>>>>        // Nomisma.Nomisma_Descr
40526>>>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Descr To DD_CAPSLOCK   
40527>>>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Descr To (sl059(Self))
40528>>>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Descr To TRUE
40529>>>>>>>>>>>
40529>>>>>>>>>>>        // Nomisma.Nomisma_Short
40529>>>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Short To DD_CAPSLOCK   
40530>>>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Short To (sl059(Self))
40531>>>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Short To TRUE
40532>>>>>>>>>>>
40532>>>>>>>>>>>        // Nomisma.Dekadika
40532>>>>>>>>>>>
40532>>>>>>>>>>>        // Nomisma.Fup
40532>>>>>>>>>>>
40532>>>>>>>>>>>        // Nomisma.Lup
40532>>>>>>>>>>>
40532>>>>>>>>>>>        // Nomisma.Euro_Zone
40532>>>>>>>>>>>
40532>>>>>>>>>>>        // Nomisma.Einai_Drx
40532>>>>>>>>>>>
40532>>>>>>>>>>>        // Nomisma.Einai_Euro
40532>>>>>>>>>>>
40532>>>>>>>>>>>        // Nomisma.Monades
40532>>>>>>>>>>>
40532>>>>>>>>>>>        // Nomisma.Kl_Isot_Euro
40532>>>>>>>>>>>
40532>>>>>>>>>>>        // Nomisma.Nomisma_Type
40532>>>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Type To (Nomisma_Nomisma_Type_VT(Self))
40533>>>>>>>>>>>
40533>>>>>>>>>>>        // Nomisma.Nomisma_Sign0
40533>>>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Sign0 To (Nomisma_Nomisma_Sign0_VT(Self))
40534>>>>>>>>>>>
40534>>>>>>>>>>>        // Nomisma.Nomisma_Sign00
40534>>>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Sign00 To (Nomisma_Nomisma_Sign00_VT(Self))
40535>>>>>>>>>>>
40535>>>>>>>>>>>        // Nomisma.Nomisma_Signr
40535>>>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Signr To (Nomisma_Nomisma_Signr_VT(Self))
40536>>>>>>>>>>>
40536>>>>>>>>>>>        //DDB-DefineFieldEnd
40536>>>>>>>>>>>    End_Procedure    // Define_Fields
40537>>>>>>>>>>>
40537>>>>>>>>>>>    // Field_Defaults:
40537>>>>>>>>>>>    // This procedure is used to establish default field values.
40537>>>>>>>>>>>
40537>>>>>>>>>>>    Procedure Field_Defaults
40538>>>>>>>>>>>        Forward Send Field_Defaults
40540>>>>>>>>>>>        //DDB-Generated-Code-Location
40540>>>>>>>>>>>        //DDB-FieldDefaultStart
40540>>>>>>>>>>>        //DDB-FieldDefaultEnd
40540>>>>>>>>>>>    End_Procedure    // Field_Defaults
40541>>>>>>>>>>>
40541>>>>>>>>>>>End_Class    // Nomisma_DataDictionary
40542>>>>>>>>>>>//DDB-Selection-pkg-Start
40542>>>>>>>>>>>
40542>>>>>>>>>>>Use sl059.sl         // sl059
INCLUDING FILE: SL059.SL
40542>>>>>>>>>>>>>//AB/ Project sl059
40542>>>>>>>>>>>>>//AB/     Object prj is a LOOKUP_Project
40542>>>>>>>>>>>>>//AB/         Set ProjectName to "sl059"
40542>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl059.SL"
40542>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
40542>>>>>>>>>>>>>
40542>>>>>>>>>>>>>    //AB-IgnoreStart
40542>>>>>>>>>>>>>
40542>>>>>>>>>>>>>
40542>>>>>>>>>>>>>
40542>>>>>>>>>>>>>
40542>>>>>>>>>>>>>    Use NOMISMA.DD
40542>>>>>>>>>>>>>
40542>>>>>>>>>>>>>    //AB-IgnoreEnd
40542>>>>>>>>>>>>>
40542>>>>>>>>>>>>>    CD_Popup_Object sl059 is a dbModalPanelSub
40561>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
40562>>>>>>>>>>>>>        Set Modal_State to FALSE
40563>>>>>>>>>>>>>        Set Popup_State to FALSE
40564>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
40565>>>>>>>>>>>>>        set label to "Œ¦£å©£˜«˜" 
40566>>>>>>>>>>>>>        Set Size to 148 295
40567>>>>>>>>>>>>>        Set Location to 4 5
40568>>>>>>>>>>>>>
40568>>>>>>>>>>>>>        //AB-DDOStart
40568>>>>>>>>>>>>>
40568>>>>>>>>>>>>>        Object Nomisma_DD is a Nomisma_DataDictionary
40570>>>>>>>>>>>>>        End_Object    // Nomisma_DD
40571>>>>>>>>>>>>>
40571>>>>>>>>>>>>>        Set Main_DD to (Nomisma_DD(Current_Object))
40572>>>>>>>>>>>>>        Set Server to (Nomisma_DD(Current_Object))
40573>>>>>>>>>>>>>
40573>>>>>>>>>>>>>        //AB-DDOEnd
40573>>>>>>>>>>>>>
40573>>>>>>>>>>>>>        Object oSelList is a dbListSub
40575>>>>>>>>>>>>>            Set Main_File to Nomisma.File_Number
40576>>>>>>>>>>>>>            Set Size to 105 278
40577>>>>>>>>>>>>>            Set Location to 6 6
40578>>>>>>>>>>>>>
40578>>>>>>>>>>>>>            Begin_Row
40581>>>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_code
40582>>>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_descr
40583>>>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_short
40584>>>>>>>>>>>>>                Entry_Item Nomisma.Dekadika
40585>>>>>>>>>>>>>            End_Row
40590>>>>>>>>>>>>>
40590>>>>>>>>>>>>>            Set Form_Width    item 0 to 45
40591>>>>>>>>>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
40592>>>>>>>>>>>>>
40592>>>>>>>>>>>>>            Set Form_Width    item 1 to 115
40593>>>>>>>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
40594>>>>>>>>>>>>>
40594>>>>>>>>>>>>>            Set Form_Width    item 2 to 58
40595>>>>>>>>>>>>>            set header_label  item 2 to "‘ç¤«¦£ž" 
40596>>>>>>>>>>>>>
40596>>>>>>>>>>>>>            Set Form_Width    item 3 to 54
40597>>>>>>>>>>>>>            set header_label  item 3 to "ƒœ¡˜› ¡á" 
40598>>>>>>>>>>>>>
40598>>>>>>>>>>>>>        End_Object    // oSelList
40599>>>>>>>>>>>>>
40599>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
40601>>>>>>>>>>>>>            set label to "&„§ ¢¦šã" 
40602>>>>>>>>>>>>>            Set Location to 113 124
40603>>>>>>>>>>>>>
40603>>>>>>>>>>>>>            //AB-StoreStart
40603>>>>>>>>>>>>>            Procedure OnClick
40605>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
40606>>>>>>>>>>>>>            End_Procedure
40607>>>>>>>>>>>>>            //AB-StoreEnd
40607>>>>>>>>>>>>>
40607>>>>>>>>>>>>>        End_Object    // oOK_bn
40608>>>>>>>>>>>>>
40608>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
40610>>>>>>>>>>>>>            set label to "&€¡ç¨à©ž" 
40611>>>>>>>>>>>>>            Set Location to 113 179
40612>>>>>>>>>>>>>
40612>>>>>>>>>>>>>            //AB-StoreStart
40612>>>>>>>>>>>>>            Procedure OnClick
40614>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
40615>>>>>>>>>>>>>            End_Procedure
40616>>>>>>>>>>>>>            //AB-StoreEnd
40616>>>>>>>>>>>>>
40616>>>>>>>>>>>>>        End_Object    // oCancel_bn
40617>>>>>>>>>>>>>
40617>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
40619>>>>>>>>>>>>>            set label to "€&¤˜ã«ž©ž" 
40620>>>>>>>>>>>>>            Set Location to 113 234
40621>>>>>>>>>>>>>
40621>>>>>>>>>>>>>            //AB-StoreStart
40621>>>>>>>>>>>>>            Procedure OnClick
40623>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
40624>>>>>>>>>>>>>            End_Procedure
40625>>>>>>>>>>>>>            //AB-StoreEnd
40625>>>>>>>>>>>>>
40625>>>>>>>>>>>>>        End_Object    // oSearch_bn
40626>>>>>>>>>>>>>
40626>>>>>>>>>>>>>
40626>>>>>>>>>>>>>        //AB-StoreStart
40626>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
40627>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
40628>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
40629>>>>>>>>>>>>>        //AB-StoreEnd
40629>>>>>>>>>>>>>
40629>>>>>>>>>>>>>    CD_End_Object    // sl059
40631>>>>>>>>>>>>>>
40631>>>>>>>>>>>>>
40631>>>>>>>>>>>>>//AB/     End_Object    // prj
40631>>>>>>>>>>>
40631>>>>>>>>>>>//DDB-Selection-pkg-End
40631>>>>>>>>>>>//DDB-FileEnd
40631>>>>>>>>>    Use COUNTRY.DD
40631>>>>>>>>>    Use TOWNS.DD
40631>>>>>>>>>    Use CITIES.DD
40631>>>>>>>>>    Use PAYRESP.DD
40631>>>>>>>>>    Use AREAS.DD
40631>>>>>>>>>    Use CLIENTS.DD
40631>>>>>>>>>    Use PARTICLE.DD
INCLUDING FILE: PARTICLE.DD
40631>>>>>>>>>>>//DDB-FileStart
40631>>>>>>>>>>>//DDB-HeaderStart
40631>>>>>>>>>>>
40631>>>>>>>>>>>// File Name : PARTICLE.DD
40631>>>>>>>>>>>// Class Name: Particle_DataDictionary
40631>>>>>>>>>>>// Revision  : 262
40631>>>>>>>>>>>// Version   : 2
40631>>>>>>>>>>>
40631>>>>>>>>>>>Use  Windows           // Basic Definitions
40631>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
40631>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40631>>>>>>>>>>>
40631>>>>>>>>>>>Open Particle
40633>>>>>>>>>>>Open Pmoves
40635>>>>>>>>>>>Open Tparticl
INCLUDING FILE: TPARTICL.FD
40637>>>>>>>>>>>Open Partlfpa
INCLUDING FILE: PARTLFPA.FD
40639>>>>>>>>>>>Open Pmovesl
INCLUDING FILE: PMOVESL.FD
40641>>>>>>>>>>>Open Psxetika
40643>>>>>>>>>>>Open Clients
40645>>>>>>>>>>>Open Ptyppar
40647>>>>>>>>>>>Open Nomisma
40649>>>>>>>>>>>Open Sysrecp
40651>>>>>>>>>>>Open Syscurxr
40653>>>>>>>>>>>Open Pseira
40655>>>>>>>>>>>Open Cn
40657>>>>>>>>>>>Open Partlfpa
40659>>>>>>>>>>>Open Clorder
40661>>>>>>>>>>>Open Clorderd
INCLUDING FILE: CLORDERD.FD
40663>>>>>>>>>>>Open Ypoprosf
INCLUDING FILE: YPOPROSF.FD
40665>>>>>>>>>>>Open Psxetika
40667>>>>>>>>>>>Open Pmoves
40669>>>>>>>>>>>Open Gmove
40671>>>>>>>>>>>Open Sysrecg
40673>>>>>>>>>>>
40673>>>>>>>>>>>//DDB-HeaderEnd
40673>>>>>>>>>>>//DDB-ValidationStart
40673>>>>>>>>>>>
40673>>>>>>>>>>>Register_Object Particle_Tropos_Diakin_VT
40673>>>>>>>>>>>Register_Object Particle_Skopos_Diakin_VT
40673>>>>>>>>>>>Register_Object Particle_Tropos_Plhromhs_VT
40673>>>>>>>>>>>
40673>>>>>>>>>>>Object Particle_Tropos_Diakin_VT  is a CodeValidationTable
40675>>>>>>>>>>>    Set Type_Value        To "SEND_TERMS"
40676>>>>>>>>>>>    Set Allow_Blank_State To TRUE
40677>>>>>>>>>>>    //DDB-ValidationCustomStart
40677>>>>>>>>>>>    //DDB-ValidationCustomEnd
40677>>>>>>>>>>>End_Object   // Particle_Tropos_Diakin_VT
40678>>>>>>>>>>>
40678>>>>>>>>>>>Object Particle_Skopos_Diakin_VT  is a CodeValidationTable
40680>>>>>>>>>>>    Set Type_Value        To "SKOPOS"
40681>>>>>>>>>>>    Set Allow_Blank_State To TRUE
40682>>>>>>>>>>>    //DDB-ValidationCustomStart
40682>>>>>>>>>>>    //DDB-ValidationCustomEnd
40682>>>>>>>>>>>End_Object   // Particle_Skopos_Diakin_VT
40683>>>>>>>>>>>
40683>>>>>>>>>>>Object Particle_Tropos_Plhromhs_VT  is a CodeValidationTable
40685>>>>>>>>>>>    Set Type_Value        To "PAY_TERMS"
40686>>>>>>>>>>>    Set Validate_State    To FALSE
40687>>>>>>>>>>>    Set Allow_Blank_State To TRUE
40688>>>>>>>>>>>    //DDB-ValidationCustomStart
40688>>>>>>>>>>>    //DDB-ValidationCustomEnd
40688>>>>>>>>>>>End_Object   // Particle_Tropos_Plhromhs_VT
40689>>>>>>>>>>>//DDB-ValidationEnd
40689>>>>>>>>>>>//DDB-SelectionStart
40689>>>>>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
40689>>>>>>>>>>>//DDB/ ExternalSelectionList sl014  sl014.SL
40689>>>>>>>>>>>//DDB/ ExternalSelectionList sl054  sl054.SL
40689>>>>>>>>>>>//DDB/ ExternalSelectionList sl053  sl053.SL
40689>>>>>>>>>>>//DDB/ ExternalSelectionList sl064  sl064.SL
40689>>>>>>>>>>>Register_Object sl041
40689>>>>>>>>>>>Register_Object sl014
40689>>>>>>>>>>>Register_Object sl054
40689>>>>>>>>>>>Register_Object sl053
40689>>>>>>>>>>>Register_Object sl064
40689>>>>>>>>>>>//DDB-SelectionEnd
40689>>>>>>>>>>>
40689>>>>>>>>>>>//Object oValidateSeira is a FileValidationTable
40689>>>>>>>>>>>//    Set Table_Title         to "„§ ¢¦šã ‘œ ¨áª ˜¨˜©«˜« ¡¦ç"
40689>>>>>>>>>>>//    Set Main_File           to Pseira.File_Number
40689>>>>>>>>>>>//    Set Code_Field          to  8 //Pseira.Pseira_Seira
40689>>>>>>>>>>>//    Set Description_Field   to 11 //Pseira.Pseira_Printer
40689>>>>>>>>>>>//    Set Ordering            to  1
40689>>>>>>>>>>>//    Set Static_State to False
40689>>>>>>>>>>>//End_Object
40689>>>>>>>>>>>
40689>>>>>>>>>>>Open Cars
INCLUDING FILE: CARS.FD
40691>>>>>>>>>>>Open Drivers
INCLUDING FILE: DRIVERS.FD
40693>>>>>>>>>>>Open Pumps
INCLUDING FILE: PUMPS.FD
40695>>>>>>>>>>>Open SysCurXr
40697>>>>>>>>>>>
40697>>>>>>>>>>>Class Particle_DataDictionary  is a DataDictionary_Sec
40698>>>>>>>>>>>
40698>>>>>>>>>>>    Function fsVresCNDescr String asCNCode Returns String
40699>>>>>>>>>>>        String rVal
40700>>>>>>>>>>>        Clear CN
40701>>>>>>>>>>>        Move asCNCode            to Cn.Cn_Code
40702>>>>>>>>>>>        Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
40703>>>>>>>>>>>>
40703>>>>>>>>>>>        If (Found) Move (Trim(CN.CN_Descr)) to rVal
40706>>>>>>>>>>>        Else Move '' to rVal
40708>>>>>>>>>>>        Function_Return rVal
40709>>>>>>>>>>>    End_Function
40710>>>>>>>>>>>
40710>>>>>>>>>>>    Function fsVresAntliaDescr String asOxhmaCode Returns String
40711>>>>>>>>>>>        String rVal
40712>>>>>>>>>>>        Clear Pumps
40713>>>>>>>>>>>        Move SysCurXr.Company_Code  to Pumps.Pump_Company
40714>>>>>>>>>>>        Move asOxhmaCode            to Pumps.Pump_ID
40715>>>>>>>>>>>        Find Eq Pumps By Index.1 // Pump_Company + Pump_ID
40716>>>>>>>>>>>>
40716>>>>>>>>>>>        If (Found) Move (Trim(Pumps.Pump_Descr)) to rVal
40719>>>>>>>>>>>        Else Move '' to rVal
40721>>>>>>>>>>>        Function_Return rVal
40722>>>>>>>>>>>    End_Function
40723>>>>>>>>>>>
40723>>>>>>>>>>>    Function fsVresOxhmaDescr String asOxhmaCode Returns String
40724>>>>>>>>>>>        String rVal
40725>>>>>>>>>>>        Clear Cars
40726>>>>>>>>>>>        Move SysCurXr.Company_Code  to Cars.Car_Company
40727>>>>>>>>>>>        Move asOxhmaCode            to Cars.Car_ID
40728>>>>>>>>>>>        Find Eq Cars By Index.1 // Car_Company + Car_ID
40729>>>>>>>>>>>>
40729>>>>>>>>>>>
40729>>>>>>>>>>>        If (Found) Move (Trim(Cars.Car_License)) to rVal
40732>>>>>>>>>>>        Else Move '' to rVal
40734>>>>>>>>>>>        Function_Return rVal
40735>>>>>>>>>>>    End_Function
40736>>>>>>>>>>>
40736>>>>>>>>>>>    Function fsVresDriverCode String asOxhmaCode Returns String
40737>>>>>>>>>>>        String rVal
40738>>>>>>>>>>>        Clear Cars
40739>>>>>>>>>>>        Move SysCurXr.Company_Code  to Cars.Car_Company
40740>>>>>>>>>>>        Move asOxhmaCode            to Cars.Car_ID
40741>>>>>>>>>>>        Find Eq Cars By Index.1 // Car_Company + Car_ID
40742>>>>>>>>>>>>
40742>>>>>>>>>>>        If (Found)  Move (Trim(Cars.Car_DriverID)) to rVal
40745>>>>>>>>>>>        Else        Move '' to rVal
40747>>>>>>>>>>>        Function_Return rVal
40748>>>>>>>>>>>    End_Function
40749>>>>>>>>>>>
40749>>>>>>>>>>>    Function fsVresDriverDescr String asDriverCode Returns String
40750>>>>>>>>>>>        String rVal
40751>>>>>>>>>>>        Clear Drivers
40752>>>>>>>>>>>        Move SysCurXr.Company_Code  to Drivers.Driver_Company
40753>>>>>>>>>>>        Move asDriverCode           to Drivers.Driver_ID
40754>>>>>>>>>>>        Find Eq Drivers By Index.1 // Driver_Company + Driver_ID
40755>>>>>>>>>>>>
40755>>>>>>>>>>>        If (Found) Move (Trim(Drivers.Driver_Name)) to rVal
40758>>>>>>>>>>>        Else Move '' to rVal
40760>>>>>>>>>>>        Function_Return rVal
40761>>>>>>>>>>>    End_Function
40762>>>>>>>>>>>
40762>>>>>>>>>>>    Procedure Construct_Object
40763>>>>>>>>>>>        Forward Send Construct_Object
40765>>>>>>>>>>>        Property String     psOldCode       Public ''
40766>>>>>>>>>>>        Property Integer    piPmovesID      Public  0
40767>>>>>>>>>>>        Property String     psOldUserID     Public ''
40768>>>>>>>>>>>        Property Integer    piOldSelected   Public  0
40769>>>>>>>>>>>        Property Integer    piFromMetasx    Public  0 
40770>>>>>>>>>>>        Property Integer    PifromBhma1     Public  0 
40771>>>>>>>>>>>        //------------------------------------------------
40771>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
40771>>>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
40771>>>>>>>>>>>        // einai 1     js 03/12/2007
40771>>>>>>>>>>>        //------------------------------------------------  
40771>>>>>>>>>>>        Property Integer piCreateNew            Public  0
40772>>>>>>>>>>>        Property String  psAud_Old_Pelaths      Public ""
40773>>>>>>>>>>>        Property String  psAud_Old_PelathsN     Public ""
40774>>>>>>>>>>>        Property String  psAud_Old_Ergo         Public ""
40775>>>>>>>>>>>        Property String  psAud_Old_ErgoDescr    Public ""
40776>>>>>>>>>>>        Property String  psAud_Old_Zonh         Public ""
40777>>>>>>>>>>>        Property String  psAud_Old_Antlia       Public ""
40778>>>>>>>>>>>        Property String  psAud_Old_Oxhma        Public ""
40779>>>>>>>>>>>        Property String  psAud_Old_PartlRecr    Public ""
40780>>>>>>>>>>>        Property String  psAud_Old_PmsRecr      Public ""
40781>>>>>>>>>>>        Property String  psAud_Old_Module       Public ""
40782>>>>>>>>>>>        Property String  psAud_Old_Parast       Public ""
40783>>>>>>>>>>>        Property String  psAud_Old_Seira        Public ""
40784>>>>>>>>>>>        Property Date    pdAud_Old_Hmnia        Public ""  
40785>>>>>>>>>>>        Property Integer piAud_Old_No           Public  0     
40786>>>>>>>>>>>        Property String  psAud_Old_Ektyposh     Public "" 
40787>>>>>>>>>>>        Property Integer piAud_Old_Timol        Public  0
40788>>>>>>>>>>>        Property Date    pdAud_Old_SapHmnia     Public ""
40789>>>>>>>>>>>        //------------------------------------------------
40789>>>>>>>>>>>    End_procedure
40790>>>>>>>>>>> 
40790>>>>>>>>>>> 
40790>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
40791>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
40793>>>>>>>>>>>        Set psOldCode       to Particle.Nomisma_Code
40794>>>>>>>>>>>        Set psOldUserID     to Particle.Partl_ToposF
40795>>>>>>>>>>>        Set piOldSelected   to Particle.Partl_Selected
40796>>>>>>>>>>>        //------------------------------------------------
40796>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
40796>>>>>>>>>>>        // ton pedion js 03/12/2007
40796>>>>>>>>>>>        //------------------------------------------------
40796>>>>>>>>>>>        Set psAud_Old_Pelaths       to Particle.Client_ID
40797>>>>>>>>>>>        Set psAud_Old_PelathsN      to Clients.Client_Name
40798>>>>>>>>>>>        Set psAud_Old_Ergo          to Particle.CN_Code     
40799>>>>>>>>>>>        Set psAud_Old_ErgoDescr     to (fsVresCNDescr(Self,Particle.CN_Code))
40800>>>>>>>>>>>        Set psAud_Old_PartlRecr     to Particle.Partl_Recr 
40801>>>>>>>>>>>        Set psAud_Old_PmsRecr       to Particle.Partl_Recr 
40802>>>>>>>>>>>        Set psAud_Old_Module        to Particle.Partl_Module
40803>>>>>>>>>>>        Set psAud_Old_Zonh          to Particle.Zone_ID
40804>>>>>>>>>>>        Set psAud_Old_Antlia        to Particle.Antlia_code
40805>>>>>>>>>>>        Set psAud_Old_Oxhma         to Particle.Oxhma_code
40806>>>>>>>>>>>        Set psAud_Old_Parast        to Ptyppar.Ptyppar_Code
40807>>>>>>>>>>>        Set psAud_Old_Seira         to Particle.Pseira_Seira
40808>>>>>>>>>>>        Set pdAud_Old_Hmnia         to Particle.Partl_Hmnia
40809>>>>>>>>>>>        Set piAud_Old_No            to Particle.Partl_No    
40810>>>>>>>>>>>        Set psAud_Old_Ektyposh      to Particle.Partl_Ektyposh 
40811>>>>>>>>>>>        Set piAud_Old_Timol         to Particle.Partl_Timol
40812>>>>>>>>>>>        Set pdAud_Old_SapHmnia      to Particle.Sap_hmnia
40813>>>>>>>>>>>
40813>>>>>>>>>>>        
40813>>>>>>>>>>>        //------------------------------------------------
40813>>>>>>>>>>>     End_Procedure   // New_Current_Record
40814>>>>>>>>>>>
40814>>>>>>>>>>>    Procedure Shmera integer iField  Date dDate
40815>>>>>>>>>>>        Local Integer Changed
40816>>>>>>>>>>>        Get Field_Changed_State iField to Changed
40817>>>>>>>>>>>        If (Changed=0 AND dDate =0) Begin
40819>>>>>>>>>>>            SysDate4 dDate
40820>>>>>>>>>>>            Set Field_Default_Value iField to dDate
40821>>>>>>>>>>>        End
40821>>>>>>>>>>>>
40821>>>>>>>>>>>    End_Procedure   // Shmera
40822>>>>>>>>>>>
40822>>>>>>>>>>>    Procedure Shmera_Ora integer iField  Number nOra
40823>>>>>>>>>>>        Local Integer Changed
40824>>>>>>>>>>>        Date dDate
40824>>>>>>>>>>>        Number nHour nMin
40824>>>>>>>>>>>        Get Field_Changed_State iField to Changed
40825>>>>>>>>>>>        If (Changed=0 AND nOra =0) Begin
40827>>>>>>>>>>>            SysDate4 dDate nHour nMin
40830>>>>>>>>>>>            Set Field_Default_Value iField to (nHour+(nMin/100))
40831>>>>>>>>>>>        End
40831>>>>>>>>>>>>
40831>>>>>>>>>>>    End_Procedure   // Shmera
40832>>>>>>>>>>>
40832>>>>>>>>>>>    Procedure Shmera_Ora_String integer iField  String asOra
40833>>>>>>>>>>>        Local Integer Changed
40834>>>>>>>>>>>        Date dDate
40834>>>>>>>>>>>        Number nHour nMin nTotal
40834>>>>>>>>>>>        String sOra sMin
40834>>>>>>>>>>>        Get Field_Changed_State iField to Changed
40835>>>>>>>>>>>        If (Changed=0 AND asOra='') Begin
40837>>>>>>>>>>>            SysDate4 dDate nHour nMin
40840>>>>>>>>>>>            Move (nHour+(nMin/100)) to nTotal
40841>>>>>>>>>>>            Set Field_Default_Value iField to (fsConvert_Time_Number_To_String_With_Zeroes(nTotal))
40842>>>>>>>>>>>        End
40842>>>>>>>>>>>>
40842>>>>>>>>>>>    End_Procedure   // Shmera
40843>>>>>>>>>>>
40843>>>>>>>>>>>    Procedure Save_Main_File
40844>>>>>>>>>>>        String  sCodeApo sCodeEos sOldUserID sCurrentUserID
40845>>>>>>>>>>>        Integer iBreak iPmoves iSelected iOldSelected
40845>>>>>>>>>>>        Number  nPoso nPosoEuro nIsotimia nPosothtaKin
40845>>>>>>>>>>>        Date    dHmnia
40845>>>>>>>>>>>
40845>>>>>>>>>>>        If ((Operation_Origin<>Self) And ;            (Particle.Recnum=0)) Procedure_Return
40848>>>>>>>>>>>
40848>>>>>>>>>>>        If (Particle.Cn_Code<>'') Begin
40850>>>>>>>>>>>            Clear Cn
40851>>>>>>>>>>>            Move Particle.Cn_Code   to Cn.Cn_Code
40852>>>>>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
40853>>>>>>>>>>>>
40853>>>>>>>>>>>            If (Found) Begin
40855>>>>>>>>>>>                Move Cn.Cn_Sls_ID       to Particle.Sls_ID
40856>>>>>>>>>>>                Move Cn.CN_Cnt_ID       to Particle.Cnt_ID
40857>>>>>>>>>>>                Move Cn.CN_Recr         to Particle.CN_Recr
40858>>>>>>>>>>>            End
40858>>>>>>>>>>>>
40858>>>>>>>>>>>            Else Begin
40859>>>>>>>>>>>                Move ''                 to Particle.Sls_ID
40860>>>>>>>>>>>                Move ''                 to Particle.Cnt_ID
40861>>>>>>>>>>>                Move ''                 to Particle.CN_Recr
40862>>>>>>>>>>>            End
40862>>>>>>>>>>>>
40862>>>>>>>>>>>        End
40862>>>>>>>>>>>>
40862>>>>>>>>>>>        Else Begin
40863>>>>>>>>>>>            Move ''                 to Particle.Sls_ID
40864>>>>>>>>>>>            Move ''                 to Particle.Cnt_ID
40865>>>>>>>>>>>            Move ''                 to Particle.CN_Recr
40866>>>>>>>>>>>        End
40866>>>>>>>>>>>>
40866>>>>>>>>>>>
40866>>>>>>>>>>>        Move Pmoves.Recnum              to iPmoves
40867>>>>>>>>>>>
40867>>>>>>>>>>>        Move Particle.Partl_Selected    to iSelected
40868>>>>>>>>>>>        Get piOldSelected               to iOldSelected
40869>>>>>>>>>>>        Get fsLoginUserID               to sCurrentUserID
40870>>>>>>>>>>>        Get psOldUserID                 to sOldUserID
40871>>>>>>>>>>>
40871>>>>>>>>>>>        If (Particle.Partl_Disctof<>0) Begin
40873>>>>>>>>>>>            If (sOldUserID='') Move sCurrentUserID to Particle.Partl_Toposf
40876>>>>>>>>>>>        End
40876>>>>>>>>>>>>
40876>>>>>>>>>>>        Else Begin
40877>>>>>>>>>>>            Move '' to Particle.Partl_Toposf
40878>>>>>>>>>>>        End
40878>>>>>>>>>>>>
40878>>>>>>>>>>>
40878>>>>>>>>>>>        Move 0 to nPosothtaKin
40879>>>>>>>>>>>        If ((piFromMetasx(Self)) Or (iSelected<>iOldSelected))Begin
40881>>>>>>>>>>>            If ((Particle.Partl_Toposf=sCurrentUserID) Or (Particle.Partl_Toposf='')) Begin
40883>>>>>>>>>>>                If (iSelected) Begin
40885>>>>>>>>>>>                    Clear Pmoves
40886>>>>>>>>>>>                    Move Particle.Partl_Recr to Pmoves.Partl_Recr
40887>>>>>>>>>>>                    Find Gt Pmoves by index.3
40888>>>>>>>>>>>>
40888>>>>>>>>>>>                    While ((Found=1) And (Pmoves.Partl_Recr=Particle.Partl_Recr))
40892>>>>>>>>>>>                        Move Pmoves.Timol_Ypol  to Pmoves.Qty_Kinhshs
40893>>>>>>>>>>>                        Add  Pmoves.Timol_Ypol  to nPosothtaKin
40894>>>>>>>>>>>                        Move 1              to Pmoves.Pms_Selected
40895>>>>>>>>>>>                        Saverecord Pmoves
40896>>>>>>>>>>>                        Find Gt Pmoves by index.3
40897>>>>>>>>>>>>
40897>>>>>>>>>>>                    Loop
40898>>>>>>>>>>>>
40898>>>>>>>>>>>                    Move sCurrentUserID to Particle.Partl_Toposf
40899>>>>>>>>>>>                    Move nPosothtaKin   to Particle.Partl_Disctof
40900>>>>>>>>>>>                End
40900>>>>>>>>>>>>
40900>>>>>>>>>>>                Else Begin
40901>>>>>>>>>>>                    Clear Pmoves
40902>>>>>>>>>>>                    Move Particle.Partl_Recr to Pmoves.Partl_Recr
40903>>>>>>>>>>>                    Find Gt Pmoves by index.3
40904>>>>>>>>>>>>
40904>>>>>>>>>>>                    While ((Found=1) And (Pmoves.Partl_Recr=Particle.Partl_Recr))
40908>>>>>>>>>>>                        Move 0 to Pmoves.Qty_Kinhshs
40909>>>>>>>>>>>                        Move 0 to Pmoves.Pms_Selected
40910>>>>>>>>>>>                        Saverecord Pmoves
40911>>>>>>>>>>>                        Find Gt Pmoves by index.3
40912>>>>>>>>>>>>
40912>>>>>>>>>>>                    Loop
40913>>>>>>>>>>>>
40913>>>>>>>>>>>                    Move '' to Particle.Partl_Toposf
40914>>>>>>>>>>>                    Move 0  to Particle.Partl_Disctof
40915>>>>>>>>>>>                End
40915>>>>>>>>>>>>
40915>>>>>>>>>>>
40915>>>>>>>>>>>//                // js 11/04/2003
40915>>>>>>>>>>>//                If (iPmoves) Begin
40915>>>>>>>>>>>//                    Clear Pmoves
40915>>>>>>>>>>>//                    Move iPmoves to Pmoves.Recnum
40915>>>>>>>>>>>//                    Find Eq Pmoves.Recnum
40915>>>>>>>>>>>//                End
40915>>>>>>>>>>>
40915>>>>>>>>>>>            End
40915>>>>>>>>>>>>
40915>>>>>>>>>>>            Set piFromMetasx to 0
40916>>>>>>>>>>>        End
40916>>>>>>>>>>>>
40916>>>>>>>>>>>
40916>>>>>>>>>>>        Forward Send Save_Main_File
40918>>>>>>>>>>>
40918>>>>>>>>>>>    End_Procedure   // Save_Main_File
40919>>>>>>>>>>>
40919>>>>>>>>>>>
40919>>>>>>>>>>>    Procedure Calc_The_Totals
40920>>>>>>>>>>>        Number nPct nPoso nAxia nTmp
40921>>>>>>>>>>>
40921>>>>>>>>>>>        Move (Particle.Partl_AMDISCPMS  + ;              Particle.Partl_TotDiscPc)         to Particle.Partl_DiscAm
40922>>>>>>>>>>>
40922>>>>>>>>>>>        Move (Particle.Partl_TotAmBD    - ;              Particle.Partl_DiscAm)            to Particle.Partl_TotAmAd
40923>>>>>>>>>>>
40923>>>>>>>>>>>        Move (Particle.Partl_TotAmAd    + ;              Particle.Partl_Extra)             to Particle.Partl_GenAm
40924>>>>>>>>>>>
40924>>>>>>>>>>>        If ((Particle.Partl_Extra<>0) And (Particle.Partl_ExtraVatP<>0)) Begin
40926>>>>>>>>>>>            Move (Round(Particle.Partl_Extra        *;                        Particle.Partl_ExtraVatP    /;                  100))                         to Particle.Partl_ExtraVat
40927>>>>>>>>>>>        End
40927>>>>>>>>>>>>
40927>>>>>>>>>>>
40927>>>>>>>>>>>        If ((Particle.Partl_TotDiscPC<>0) And (Particle.Disc_Vat_Pct<>0)) Begin
40929>>>>>>>>>>>            Move (Round(Particle.Partl_TotDiscPC    *;                        Particle.Disc_Vat_Pct       /;                  100))                         to Particle.Disc_Vat_Poso
40930>>>>>>>>>>>        End
40930>>>>>>>>>>>>
40930>>>>>>>>>>>
40930>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
40930>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
40930>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
40930>>>>>>>>>>>        If (Sysfile.Fpa_On_Total=0) Begin
40932>>>>>>>>>>>            Move (Particle.Partl_Vatam-Particle.Disc_Vat_Poso+Particle.Partl_ExtraVat) ;                to Particle.Total_Vat_Poso
40933>>>>>>>>>>>        End
40933>>>>>>>>>>>>
40933>>>>>>>>>>>        Else Begin
40934>>>>>>>>>>>            If (Particle.Fpa_On_Total<>0) ;                Move (Particle.Fpa_On_Total-Particle.Disc_Vat_Poso+Particle.Partl_ExtraVat) ;                    to Particle.Total_Vat_Poso
40937>>>>>>>>>>>            Else ;                Move (Particle.Partl_Vatam-Particle.Disc_Vat_Poso+Particle.Partl_ExtraVat) ;                    to Particle.Total_Vat_Poso
40939>>>>>>>>>>>        End
40939>>>>>>>>>>>>
40939>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
40939>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
40939>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
40939>>>>>>>>>>>
40939>>>>>>>>>>>        Move (Particle.Partl_GenAm      + ;              Particle.Total_Vat_Poso ) to Particle.Partl_PayAm
40940>>>>>>>>>>>
40940>>>>>>>>>>>        If (Particle.PARTL_TOTTEM>0) Begin
40942>>>>>>>>>>>            Move (Particle.PARTL_TOTTEM-Particle.Timol_Qty) ;                                            to Particle.Timol_Ypol
40943>>>>>>>>>>>
40943>>>>>>>>>>>            Move (Particle.Timol_Ypol=0)    to Particle.Partl_Timol
40944>>>>>>>>>>>
40944>>>>>>>>>>>        End
40944>>>>>>>>>>>>
40944>>>>>>>>>>>        Else Move 0 to Particle.Partl_Timol
40946>>>>>>>>>>>
40946>>>>>>>>>>>        Move Particle.Partl_TotAmAD  to nAxia
40947>>>>>>>>>>>        Move Particle.Parakrat_Pct   to nPct
40948>>>>>>>>>>>        Move (Round_Number(((nAxia*nPct)/100),2)) to nTmp
40949>>>>>>>>>>>        Move nTmp to Particle.Parakrat_Poso
40950>>>>>>>>>>>    End_Procedure
40951>>>>>>>>>>>
40951>>>>>>>>>>>    Procedure Find_The_Rate
40952>>>>>>>>>>>        String  sCode sWhat
40953>>>>>>>>>>>        Integer iRateID
40953>>>>>>>>>>>        Number nEuro nIsot nRate
40953>>>>>>>>>>>        Date dHmnia
40953>>>>>>>>>>>        Move Nomisma.Nomisma_Code                   to sCode
40954>>>>>>>>>>>        If (Trim(sCode)='') Move SysCurXr.C_Code0   to sCode
40957>>>>>>>>>>>        Move Particle.Partl_Hmnia       to dHmnia
40958>>>>>>>>>>>        Move Particle.Isotimia          to nIsot
40959>>>>>>>>>>>        If (nIsot=0) Begin
40961>>>>>>>>>>>            If (dHmnia='') Sysdate dHmnia
40964>>>>>>>>>>>            Move (Trim(sCode)) to sCode
40965>>>>>>>>>>>            Clear Isotimia
40966>>>>>>>>>>>            Move sCode      to Isotimia.Nomisma_Code
40967>>>>>>>>>>>            Move (dHmnia+1) to Isotimia.Isotimia_Hmnia
40968>>>>>>>>>>>            Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
40969>>>>>>>>>>>>
40969>>>>>>>>>>>            If (Nomisma.Einai_Drx) Move 1 to Particle.Isotimia
40972>>>>>>>>>>>            Else Begin
40973>>>>>>>>>>>                Case Begin
40973>>>>>>>>>>>                    case (isotimia.poia_metatrepei='€') // Agora
40975>>>>>>>>>>>                        Move Isotimia.Isotimia_Agora to Particle.Isotimia
40976>>>>>>>>>>>                        Case Break
40977>>>>>>>>>>>                    case (isotimia.poia_metatrepei='') // Polhsh
40980>>>>>>>>>>>                        Move Isotimia.Isotimia_Polhsh to Particle.Isotimia
40981>>>>>>>>>>>                        Case Break
40982>>>>>>>>>>>                    Case (Isotimia.Poia_Metatrepei='F') // Fixing
40985>>>>>>>>>>>                        Move Isotimia.Isotimia_Fixing to Particle.Isotimia
40986>>>>>>>>>>>                        Case Break
40987>>>>>>>>>>>                    Case (Isotimia.Poia_Metatrepei='P') // Private
40990>>>>>>>>>>>                        Move Isotimia.Isotimia_Privat to Particle.Isotimia
40991>>>>>>>>>>>                        Case Break
40992>>>>>>>>>>>                Case End
40992>>>>>>>>>>>            End
40992>>>>>>>>>>>>
40992>>>>>>>>>>>        End
40992>>>>>>>>>>>>
40992>>>>>>>>>>>        Else Begin
40993>>>>>>>>>>>            If (dHmnia='') Sysdate      dHmnia
40996>>>>>>>>>>>            Move (Trim(sCode))      to  sCode
40997>>>>>>>>>>>            Clear Nomisma
40998>>>>>>>>>>>            Move sCode              to Nomisma.Nomisma_Code
40999>>>>>>>>>>>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
41000>>>>>>>>>>>>
41000>>>>>>>>>>>            If (Nomisma.Einai_Drx) Move 1 to Particle.Isotimia
41003>>>>>>>>>>>        End
41003>>>>>>>>>>>>
41003>>>>>>>>>>>    End_Procedure
41004>>>>>>>>>>>
41004>>>>>>>>>>>    Procedure Update
41005>>>>>>>>>>>        String  sCodeApo sCodeEos
41006>>>>>>>>>>>        String  sCar sCarDescr sDriver sDriverDescr
41006>>>>>>>>>>>        Integer iBreak iPmovesID
41006>>>>>>>>>>>        Number  nPoso nPosoEuro nIsotimia
41006>>>>>>>>>>>        Date    dHmnia
41006>>>>>>>>>>>
41006>>>>>>>>>>>        Forward Send Update
41008>>>>>>>>>>>
41008>>>>>>>>>>>        Send Find_The_Rate
41009>>>>>>>>>>>
41009>>>>>>>>>>>        Move SysCurXR.Company_Code  to Particle.Company_Code
41010>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Particle.Branch_Code
41011>>>>>>>>>>>        Move SysCurXR.Year_Year     to Particle.Year_Year
41012>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Particle.Ctypkin_Code
41013>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Particle.Wtypkin_Code
41014>>>>>>>>>>>        //Move Custprom.Custprom_Code to Particle.Custprom_Code
41014>>>>>>>>>>>        Move Clients.Client_ID      to Particle.Client_ID
41015>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code   to Particle.Ptyppar_Code
41016>>>>>>>>>>>        Move Ptyppar.Ptyppar_Module to Particle.Partl_Module
41017>>>>>>>>>>>
41017>>>>>>>>>>>        Move Payresp.Presp_ID       to Particle.Presp_ID
41018>>>>>>>>>>>
41018>>>>>>>>>>>        Send Calc_The_Totals
41019>>>>>>>>>>>
41019>>>>>>>>>>>        Move    Particle.Oxhma_Code             to sCar
41020>>>>>>>>>>>        Get     fsVresOxhmaDescr sCar           to Particle.Oxhma_Descr
41021>>>>>>>>>>>        Get     fsVresDriverCode sCar           to Particle.Odhgos_Code
41022>>>>>>>>>>>        Move    Particle.Odhgos_Code            to sDriver
41023>>>>>>>>>>>        Get     fsVresDriverDescr sDriver       to Particle.Odhgos_Name
41024>>>>>>>>>>>        Move    Particle.Antlia_Code            to sCar
41025>>>>>>>>>>>        Get     fsVresAntliaDescr sCar          to sCarDescr
41026>>>>>>>>>>>        Move    sCarDescr                       to Particle.Antlia_Descr
41027>>>>>>>>>>>
41027>>>>>>>>>>>
41027>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
41027>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
41027>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
41027>>>>>>>>>>>//        If (Particle.Partl_ExtraVat) Begin
41027>>>>>>>>>>>//            Clear PartlFpa
41027>>>>>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
41027>>>>>>>>>>>//            Move Particle.Partl_ExtraVatP   to PartlFpa.Fpa_Pososto
41027>>>>>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
41027>>>>>>>>>>>//            Add Particle.Partl_ExtraVat     to PartlFpa.PartlFpa_Poso
41027>>>>>>>>>>>//            Saverecord PartlFpa
41027>>>>>>>>>>>//        End
41027>>>>>>>>>>>
41027>>>>>>>>>>>//        If (Particle.Disc_Vat_Poso) Begin
41027>>>>>>>>>>>//            Clear PartlFpa
41027>>>>>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
41027>>>>>>>>>>>//            Move Particle.Disc_Vat_Pct      to PartlFpa.Fpa_Pososto
41027>>>>>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
41027>>>>>>>>>>>//            Add Particle.Disc_Vat_Poso      to PartlFpa.PartlFpa_Poso
41027>>>>>>>>>>>//            Saverecord PartlFpa
41027>>>>>>>>>>>//        End
41027>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
41027>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
41027>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
41027>>>>>>>>>>>
41027>>>>>>>>>>>        // 01/10/2001 Mphke edo anti gia thn creating gia na kalipsei to problhma
41027>>>>>>>>>>>        // pou proekeipte an gia kapoio logo den symplhrvnotan seira kai o arithmos
41027>>>>>>>>>>>        // emene 0 eprepe na sbhstoun OLA ta lines kai to idio to parastatiko gia na
41027>>>>>>>>>>>        // xanatrexei o kodikas elegxou seiras kai arithmou
41027>>>>>>>>>>>        // Tora trexei sthn Update (giati sthn Save_Main_File kanei validation
41027>>>>>>>>>>>        // PRIN kai kobei thn eggrafh epeidh o arithmos einai 0
41027>>>>>>>>>>>        If ( ((Operation_Origin=Self) Or                 ;             (Operation_Origin=(piPmovesID(Self)))) And  ;             (Particle.Partl_No=0)) Send Kathorise_Thn_Seira
41030>>>>>>>>>>>        // 01/10/2001
41030>>>>>>>>>>>
41030>>>>>>>>>>>
41030>>>>>>>>>>>        //---------------------------------------------
41030>>>>>>>>>>>        // Auditing / Katagrafh allagon
41030>>>>>>>>>>>        //OPERATION_MODE       OPERATION_ORIGIN
41030>>>>>>>>>>>            //MODE_WAITING  
41030>>>>>>>>>>>            //MODE_FINDING  
41030>>>>>>>>>>>            //MODE_CLEARING 
41030>>>>>>>>>>>            //MODE_CREATING 
41030>>>>>>>>>>>            //MODE_SAVING   
41030>>>>>>>>>>>            //MODE_DELETING 
41030>>>>>>>>>>>            //MODE_ABORTING 
41030>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
41030>>>>>>>>>>>        Date    dDate  Shmer 
41030>>>>>>>>>>>        Integer iMin iHour iSec iLen
41030>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
41034>>>>>>>>>>>        Move iHour  to sHour
41035>>>>>>>>>>>        Move iMin   to sMin
41036>>>>>>>>>>>        Move iSec   to sSec
41037>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
41041>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
41045>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
41049>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
41050>>>>>>>>>>>        
41050>>>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
41050>>>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
41052>>>>>>>>>>>            Get fsLoginUserID to sUser
41053>>>>>>>>>>>            If (piCreateNew(Self)=1) Begin
41055>>>>>>>>>>>                clear gmove
41056>>>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
41057>>>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
41058>>>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
41059>>>>>>>>>>>                move  1                     to gmove.gtypkin_code// Apo Parastatika
41060>>>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
41061>>>>>>>>>>>                move Particle.partl_no      to gmove.garticl_no
41062>>>>>>>>>>>                move Particle.CN_Code       to gmove.gplan_recr
41063>>>>>>>>>>>                move suser                  to gmove.gplan_code
41064>>>>>>>>>>>                move Particle.Partl_Recr    to gmove.garticl_recr
41065>>>>>>>>>>>                reread sysrecg
41069>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
41070>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
41071>>>>>>>>>>>                saverecord sysrecg
41072>>>>>>>>>>>                unlock
41073>>>>>>>>>>>>
41073>>>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                            to Gmove.Gmove_Recr
41074>>>>>>>>>>>                Move Particle.Partl_Module          to Gmove.Module
41075>>>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
41076>>>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
41077>>>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
41078>>>>>>>>>>>                Move Clients.Client_ID              to Gmove.Cur_ID
41079>>>>>>>>>>>                Move Clients.CLient_Name            to Gmove.Cur_Name
41080>>>>>>>>>>>                Move Particle.CN_Code               to Gmove.Cur_CN
41081>>>>>>>>>>>                Move (fsVresCNDescr(Self,Particle.CN_Code)) ;                                                    to gmove.Cur_CN_Addr 
41082>>>>>>>>>>>                Move Particle.Partl_Recr            to Gmove.Partl_Recr 
41083>>>>>>>>>>>                Move Particle.Partl_Recr            to Gmove.Pms_Recr  
41084>>>>>>>>>>>                Move Particle.Zone_ID               to Gmove.Cur_Zonh
41085>>>>>>>>>>>                Move Particle.Antlia_code           to Gmove.Cur_Antlia
41086>>>>>>>>>>>                Move Particle.Oxhma_code            to Gmove.Cur_Oxhma       
41087>>>>>>>>>>>                Move Ptyppar.Ptyppar_Code           to Gmove.Cur_Parast
41088>>>>>>>>>>>                Move Particle.Pseira_Seira          to Gmove.Cur_Seira
41089>>>>>>>>>>>                Move Particle.Partl_Hmnia           to Gmove.Cur_Hmnia
41090>>>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ §˜¨˜©«˜« ¡¦ç" to sText
41091>>>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs
41092>>>>>>>>>>>                move (trim(stext))          to gmove.gmove_aitiol
41093>>>>>>>>>>>                Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                    to Gmove.Txt1
41094>>>>>>>>>>>                saverecord gmove
41095>>>>>>>>>>>                Set piCreateNew to 0
41096>>>>>>>>>>>            End
41096>>>>>>>>>>>>
41096>>>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
41099>>>>>>>>>>>                Integer isChanged
41099>>>>>>>>>>>                Move 0 to isChanged
41100>>>>>>>>>>>                
41100>>>>>>>>>>>                     If ((Trim(psAud_Old_Pelaths (Self))<>Trim(Clients.Client_ID      ))   Or  (Trim(psAud_Old_Ergo    (Self))<>Trim(Particle.CN_Code    ))) Move 1 to isChanged    
41103>>>>>>>>>>>                Else If ((Trim(psAud_Old_Zonh    (Self))<>Trim(Particle.Zone_ID       ))   Or  (Trim(psAud_Old_Antlia  (Self))<>Trim(Particle.Antlia_code))) Move 1 to isChanged   
41107>>>>>>>>>>>                Else If ((Trim(psAud_Old_Oxhma   (Self))<>Trim(Particle.Oxhma_code    ))   Or  (Trim(psAud_Old_Parast  (Self))<>Trim(Ptyppar.Ptyppar_Code))) Move 1 to isChanged   
41111>>>>>>>>>>>                Else If ((Trim(psAud_Old_Seira   (Self))<>Trim(Particle.Pseira_Seira  ))   Or  (Trim(pdAud_Old_Hmnia   (Self))<>Particle.Partl_Hmnia      )) Move 1 to isChanged  
41115>>>>>>>>>>>                Else If  (piAud_Old_No           (Self) <>Particle.Partl_No)                                                                                 Move 1 to isChanged
41119>>>>>>>>>>>                Else If ((Trim(psAud_Old_Ektyposh(Self))<>Trim(Particle.Partl_Ektyposh))   Or  (piAud_Old_Timol(Self)<>Particle.Partl_Timol               )) Move 1 to isChanged  
41123>>>>>>>>>>>                Else If  (pdAud_Old_SapHmnia     (Self) <>Particle.Sap_hmnia) Move 1 to isChanged
41127>>>>>>>>>>>
41127>>>>>>>>>>>                If (isChanged>0) Begin  
41129>>>>>>>>>>>                    clear gmove
41130>>>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
41131>>>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
41132>>>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
41133>>>>>>>>>>>                    move  1                     to gmove.gtypkin_code// Apo Parastatika
41134>>>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
41135>>>>>>>>>>>                    move Particle.partl_no      to gmove.garticl_no
41136>>>>>>>>>>>                    move Particle.CN_Code       to gmove.gplan_recr
41137>>>>>>>>>>>                    move suser                  to gmove.gplan_code
41138>>>>>>>>>>>                    move Particle.Partl_Recr    to gmove.garticl_recr
41139>>>>>>>>>>>                    reread sysrecg
41143>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
41144>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
41145>>>>>>>>>>>                    saverecord sysrecg
41146>>>>>>>>>>>                    unlock
41147>>>>>>>>>>>>
41147>>>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
41148>>>>>>>>>>>                    Move Particle.Partl_Module          to Gmove.Module
41149>>>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
41150>>>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
41151>>>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
41152>>>>>>>>>>>                    //--
41152>>>>>>>>>>>                    Move Particle.Partl_Recr            to Gmove.Partl_Recr 
41153>>>>>>>>>>>                    Move Particle.Partl_Recr            to Gmove.Pms_Recr  
41154>>>>>>>>>>>                    //--
41154>>>>>>>>>>>                    Move (Trim(Clients.Client_ID    ))  to Gmove.Cur_ID
41155>>>>>>>>>>>                    Move (Trim(Clients.CLient_Name  ))  to Gmove.Cur_Name
41156>>>>>>>>>>>                    Move (Trim(Particle.CN_Code     ))  to Gmove.Cur_CN
41157>>>>>>>>>>>                    Move (fsVresCNDescr(Self,Particle.CN_Code)) ;                                                        to gmove.Cur_CN_Addr 
41158>>>>>>>>>>>                    Move (Trim(Particle.Zone_ID     ))  to Gmove.Cur_Zonh
41159>>>>>>>>>>>                    Move (Trim(Particle.Antlia_code ))  to Gmove.Cur_Antlia
41160>>>>>>>>>>>                    Move (Trim(Particle.Oxhma_code  ))  to Gmove.Cur_Oxhma       
41161>>>>>>>>>>>                    Move (Trim(Ptyppar.Ptyppar_Code ))  to Gmove.Cur_Parast
41162>>>>>>>>>>>                    Move (Trim(Particle.Pseira_Seira))  to Gmove.Cur_Seira
41163>>>>>>>>>>>                    Move       Particle.Partl_Hmnia     to Gmove.Cur_Hmnia
41164>>>>>>>>>>>                    Move       Particle.Partl_No        to Gmove.Cur_No     
41165>>>>>>>>>>>                    Move Particle.Sap_hmnia             to Gmove.Date1
41166>>>>>>>>>>>                    //--
41166>>>>>>>>>>>                    Move (Trim(psAud_Old_Pelaths (Self))) to Gmove.Prev_ID
41167>>>>>>>>>>>                    Move (Trim(psAud_Old_PelathsN(Self))) to Gmove.Prev_Name
41168>>>>>>>>>>>                    Move (Trim(psAud_Old_Ergo    (Self))) to Gmove.Prev_CN
41169>>>>>>>>>>>                    Move (fsVresCNDescr(Self,(psAud_Old_Ergo(Self)))) ;                                                          to gmove.Prev_CN_Addr 
41170>>>>>>>>>>>                    Move (Trim(psAud_Old_Zonh    (Self))) to Gmove.Prev_Zonh
41171>>>>>>>>>>>                    Move (Trim(psAud_Old_Antlia  (Self))) to Gmove.Prev_Antlia
41172>>>>>>>>>>>                    Move (Trim(psAud_Old_Oxhma   (Self))) to Gmove.Prev_Oxhma
41173>>>>>>>>>>>                    Move (Trim(psAud_Old_Parast  (Self))) to Gmove.Prev_Parast
41174>>>>>>>>>>>                    Move (Trim(psAud_Old_Seira   (Self))) to Gmove.Prev_Seira
41175>>>>>>>>>>>                    Move      (pdAud_Old_Hmnia   (Self )) to Gmove.Prev_Hmnia
41176>>>>>>>>>>>                    Move      (piAud_Old_No      (Self )) to Gmove.Prev_No
41177>>>>>>>>>>>                    Move (pdAud_Old_SapHmnia     (Self )) to gmove.Date2 
41178>>>>>>>>>>>                    
41178>>>>>>>>>>>                    //--  
41178>>>>>>>>>>>                    If ((Trim(psAud_Old_Ektyposh(Self))<>Trim(Particle.Partl_Ektyposh)) Or (piAud_Old_Timol(Self)<>Particle.Partl_Timol) Or ;                        (pdAud_Old_SapHmnia     (Self) <>Particle.Sap_hmnia)) Move "€¤¦ š£˜ ˜¨˜©«˜« ¡¦ç - BACK DOOR"    to sText 
41181>>>>>>>>>>>                    Else Move "ƒ æ¨Ÿà©ž ˜¨˜©«˜« ¡¦ç"               to sText 
41183>>>>>>>>>>>                    
41183>>>>>>>>>>>                    Move "E" to Gmove.Eidos_Metabolhs
41184>>>>>>>>>>>                    move (trim(stext))          to gmove.gmove_aitiol
41185>>>>>>>>>>>                    Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                        to Gmove.Txt1
41186>>>>>>>>>>>                    saverecord gmove
41187>>>>>>>>>>>                    Set piCreateNew to 0
41188>>>>>>>>>>>                End
41188>>>>>>>>>>>>
41188>>>>>>>>>>>            End
41188>>>>>>>>>>>>
41188>>>>>>>>>>>        End
41188>>>>>>>>>>>>
41188>>>>>>>>>>>
41188>>>>>>>>>>>
41188>>>>>>>>>>>    End_Procedure   // Update
41189>>>>>>>>>>>
41189>>>>>>>>>>>    Procedure Delete_Main_File
41190>>>>>>>>>>>        //---------------------------------------------
41190>>>>>>>>>>>        // Auditing / Katagrafh allagon
41190>>>>>>>>>>>        //OPERATION_MODE       OPERATION_ORIGIN
41190>>>>>>>>>>>            //MODE_WAITING  
41190>>>>>>>>>>>            //MODE_FINDING  
41190>>>>>>>>>>>            //MODE_CLEARING 
41190>>>>>>>>>>>            //MODE_CREATING 
41190>>>>>>>>>>>            //MODE_SAVING   
41190>>>>>>>>>>>            //MODE_DELETING 
41190>>>>>>>>>>>            //MODE_ABORTING 
41190>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
41191>>>>>>>>>>>        Date    dDate  Shmer 
41191>>>>>>>>>>>        Integer iMin iHour iSec iLen
41191>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
41195>>>>>>>>>>>        Move iHour  to sHour
41196>>>>>>>>>>>        Move iMin   to sMin
41197>>>>>>>>>>>        Move iSec   to sSec
41198>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
41202>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
41206>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
41210>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
41211>>>>>>>>>>>        
41211>>>>>>>>>>>        // Auditing / Diagrafh 
41211>>>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
41213>>>>>>>>>>>            Get fsLoginUserID to sUser
41214>>>>>>>>>>>
41214>>>>>>>>>>>            clear gmove
41215>>>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
41216>>>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
41217>>>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
41218>>>>>>>>>>>            move  1                     to gmove.gtypkin_code// Apo Parastatika
41219>>>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
41220>>>>>>>>>>>            move Particle.partl_no      to gmove.garticl_no
41221>>>>>>>>>>>            move Particle.CN_Code       to gmove.gplan_recr
41222>>>>>>>>>>>            move suser                  to gmove.gplan_code
41223>>>>>>>>>>>            move Particle.Partl_Recr    to gmove.garticl_recr
41224>>>>>>>>>>>            reread sysrecg
41228>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
41229>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
41230>>>>>>>>>>>            saverecord sysrecg
41231>>>>>>>>>>>            unlock
41232>>>>>>>>>>>>
41232>>>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                        to Gmove.Gmove_Recr
41233>>>>>>>>>>>
41233>>>>>>>>>>>            Move (psAud_Old_Module(Self))       to Gmove.Module
41234>>>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
41235>>>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
41236>>>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
41237>>>>>>>>>>>            Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
41238>>>>>>>>>>>            Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
41239>>>>>>>>>>>            Move (psAud_Old_Ergo     (Self))    to Gmove.Prev_CN
41240>>>>>>>>>>>            Move (fsVresCNDescr(Self,(psAud_Old_Ergo(Self)))) ;                                                to gmove.Prev_CN_Addr 
41241>>>>>>>>>>>            Move (psAud_Old_PartlRecr(Self))    to Gmove.Partl_Recr 
41242>>>>>>>>>>>            Move (psAud_Old_PmsRecr  (Self))    to Gmove.Pms_Recr  
41243>>>>>>>>>>>            Move (psAud_Old_Zonh     (Self))    to Gmove.Prev_Zonh
41244>>>>>>>>>>>            Move (psAud_Old_Antlia   (Self))    to Gmove.Prev_Antlia
41245>>>>>>>>>>>            Move (psAud_Old_Oxhma    (Self))    to Gmove.Prev_Oxhma
41246>>>>>>>>>>>            Move (psAud_Old_Parast   (Self))    to Gmove.Prev_Parast
41247>>>>>>>>>>>            Move (psAud_Old_Seira    (Self))    to Gmove.Prev_Seira
41248>>>>>>>>>>>            Move (pdAud_Old_Hmnia    (Self))    to Gmove.Prev_Hmnia
41249>>>>>>>>>>>            Move (piAud_Old_No       (Self))    to Gmove.Prev_No
41250>>>>>>>>>>>            Move (pdAud_Old_SapHmnia (Self ))   to gmove.Date2 
41251>>>>>>>>>>>            Move "ƒ ˜š¨˜­ã ˜¨˜©«˜« ¡¦ç" to sText
41252>>>>>>>>>>>            Move "D" to Gmove.Eidos_Metabolhs
41253>>>>>>>>>>>            move (trim(stext))          to gmove.gmove_aitiol
41254>>>>>>>>>>>            Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                to Gmove.Txt1
41255>>>>>>>>>>>            saverecord gmove
41256>>>>>>>>>>>        End
41256>>>>>>>>>>>>
41256>>>>>>>>>>>
41256>>>>>>>>>>>        Forward Send Delete_Main_File
41258>>>>>>>>>>>
41258>>>>>>>>>>>    End_Procedure
41259>>>>>>>>>>>
41259>>>>>>>>>>>    Procedure Backout
41260>>>>>>>>>>>        Forward Send Backout
41262>>>>>>>>>>>        Send Calc_The_Totals
41263>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
41263>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
41263>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
41263>>>>>>>>>>>//        If (Particle.Partl_ExtraVat) Begin
41263>>>>>>>>>>>//            Clear PartlFpa
41263>>>>>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
41263>>>>>>>>>>>//            Move Particle.Partl_ExtraVatP   to PartlFpa.Fpa_Pososto
41263>>>>>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
41263>>>>>>>>>>>//            Sub Particle.Partl_ExtraVat   From PartlFpa.PartlFpa_Poso
41263>>>>>>>>>>>//            Saverecord PartlFpa
41263>>>>>>>>>>>//            If (PartlFpa.PartlFpa_Poso=0) Delete PartlFpa
41263>>>>>>>>>>>//        End
41263>>>>>>>>>>>
41263>>>>>>>>>>>//        If (Particle.Disc_Vat_Poso) Begin
41263>>>>>>>>>>>//            Clear PartlFpa
41263>>>>>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
41263>>>>>>>>>>>//            Move Particle.Disc_Vat_Pct      to PartlFpa.Fpa_Pososto
41263>>>>>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
41263>>>>>>>>>>>//            Sub Particle.Disc_Vat_Poso    From PartlFpa.PartlFpa_Poso
41263>>>>>>>>>>>//            Saverecord PartlFpa
41263>>>>>>>>>>>//            If (PartlFpa.PartlFpa_Poso=0) Delete PartlFpa
41263>>>>>>>>>>>//        End
41263>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
41263>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
41263>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
41263>>>>>>>>>>>
41263>>>>>>>>>>>
41263>>>>>>>>>>>    End_Procedure
41264>>>>>>>>>>>
41264>>>>>>>>>>>    Procedure Kathorise_Thn_Seira
41265>>>>>>>>>>>        Integer iNextNo iSeiraRecnum iPtypparRecnum
41266>>>>>>>>>>>
41266>>>>>>>>>>>//       js 25/04/2002 Prosthikh gia na ypostirixei ektyposh promhtheyton
41266>>>>>>>>>>>        If (Ptyppar.Ptyppar_Is_What='2') Begin
41268>>>>>>>>>>>            Clear Pseira
41269>>>>>>>>>>>            Move SysCurXr.Company_Code  to Pseira.Company_Code
41270>>>>>>>>>>>            Move SysCurXr.Branch_Code   to Pseira.Branch_Code
41271>>>>>>>>>>>            //Move SysCurXr.Year_Year     to Pseira.Year_Year
41271>>>>>>>>>>>            //Move Ctypkin.Ctypkin_Code   to Pseira.Ctypkin_Code
41271>>>>>>>>>>>            //Move Wtypkin.Wtypkin_Code   to Pseira.Wtypkin_Code
41271>>>>>>>>>>>            Move Ptyppar.Ptyppar_Code   to Pseira.Ptyppar_Code
41272>>>>>>>>>>>            Move Particle.Pseira_Seira  to Pseira.Pseira_Seira
41273>>>>>>>>>>>            Find eq Pseira By Index.1 // Pseira:Index.1:Company_Code+Branch_Code+Year_Year+;
41274>>>>>>>>>>>>
41274>>>>>>>>>>>                                    //                Ctypkin_Code+Wtypkin_Code+Ptyppar_Code+Seira_Seira
41274>>>>>>>>>>>            If (Found=1) Begin
41276>>>>>>>>>>>                // €¤ ž ©œ ¨˜ œ ¤˜  autonum ¡˜  «¦ §˜¨˜©«˜« ¡¦ œ ¤˜  «¬§¦¬ 2 —Š†‘†
41276>>>>>>>>>>>                If ((Pseira.Pseira_Autonum  = 1)    And ;                    (Particle.Partl_No      = 0 )) Begin
41278>>>>>>>>>>>                    Move (Pseira.Autonum_Minus-1) to iNextNo
41279>>>>>>>>>>>                    Move (Pseira.Autonum_Minus-1) to Pseira.Autonum_Minus
41280>>>>>>>>>>>                    Saverecord Pseira
41281>>>>>>>>>>>                    Move iNextNo to Particle.Partl_No
41282>>>>>>>>>>>                End
41282>>>>>>>>>>>>
41282>>>>>>>>>>>            End
41282>>>>>>>>>>>>
41282>>>>>>>>>>>        End
41282>>>>>>>>>>>>
41282>>>>>>>>>>>        Else Begin
41283>>>>>>>>>>>//       js 25/04/2002 Prosthikh gia na ypostirixei ektyposh promhtheyton
41283>>>>>>>>>>>            If ((Ptyppar.Ptyppar_Is_What='1') And (Trim(Ptyppar.Sysxet_Ptyppar)<>'')) Begin
41285>>>>>>>>>>>                Move (Random(-10000000)-1) To Particle.Partl_No
41286>>>>>>>>>>>            End
41286>>>>>>>>>>>>
41286>>>>>>>>>>>        End
41286>>>>>>>>>>>>
41286>>>>>>>>>>>    End_Procedure
41287>>>>>>>>>>>
41287>>>>>>>>>>>    Procedure Creating
41288>>>>>>>>>>>        Integer iNextNo
41289>>>>>>>>>>>        String  sNo sSeira
41289>>>>>>>>>>>        Forward Send Creating
41291>>>>>>>>>>>        // Insert Code Here
41291>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                         (Trim(String(Particle.Partl_Rec0)))))) to Particle.Partl_Recr
41292>>>>>>>>>>>
41292>>>>>>>>>>>        If (Particle.Disc_Vat_Pct   =0) Move 19 to Particle.Disc_Vat_Pct
41295>>>>>>>>>>>        If (Particle.Partl_ExtraVatP=0) Move 19 to Particle.Partl_ExtraVatP
41298>>>>>>>>>>>
41298>>>>>>>>>>>        Move Clients.Ypoloipo to Particle.Prohg_Ypol
41299>>>>>>>>>>>
41299>>>>>>>>>>>        If ((Trim(Ptyppar.Ti_Typonei_Pms)<>'2') And (Trim(Particle.Cn_Code)<>'')) Begin
41301>>>>>>>>>>>            Clear Cn
41302>>>>>>>>>>>            Move Particle.Cn_Code   to Cn.Cn_Code
41303>>>>>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
41304>>>>>>>>>>>>
41304>>>>>>>>>>>            If (Found) Begin
41306>>>>>>>>>>>                Move Particle.Partl_No      to sNo
41307>>>>>>>>>>>                Move Particle.Pseira_Seira  to sSeira
41308>>>>>>>>>>>                Move (Trim(sNo))            to sNo
41309>>>>>>>>>>>                Move (Trim(sSeira))         to sSeira
41310>>>>>>>>>>>                if (cn.hm_prot_fortio='')   Move Particle.Partl_Hmnia   to Cn.Hm_prot_Fortio
41313>>>>>>>>>>>                Move Particle.Partl_Hmnia   to Cn.Hm_Tel_Fortio
41314>>>>>>>>>>>                Move (Trim(sSeira+' '+sNo)) to Cn.Tel_Fortio_No
41315>>>>>>>>>>>                Saverecord CN
41316>>>>>>>>>>>            End
41316>>>>>>>>>>>>
41316>>>>>>>>>>>        End 
41316>>>>>>>>>>>>
41316>>>>>>>>>>>        // sta deltia apostolhs bhma1 den theloyme na ginetai elegxos opos
41316>>>>>>>>>>>        // kai sta aytonoma deltia apostolhs
41316>>>>>>>>>>>        if (PifromBhma1(self)=0) begin
41318>>>>>>>>>>>            if (clients.client_ptyppar='100') begin
41320>>>>>>>>>>>                if (ptyppar.is_xondr<>'1');                    error 5716 '‘œ œ¢á«ž •¦¤›¨ ¡ãª ›œ¤ £§¦¨œåª ¤˜ ¡æ¯œ ª ˜¨˜©«˜« ¡æ Š ˜¤ ¡ãª !!' 
41323>>>>>>>>>>>            end
41323>>>>>>>>>>>>
41323>>>>>>>>>>>            else if (clients.client_ptyppar='113') begin 
41326>>>>>>>>>>>                if (ptyppar.is_xondr='1');                    error 5717 '‘œ œ¢á«ž Š ˜¤ ¡ãª ›œ¤ £§¦¨œåª ¤˜ ¡æ¯œ ª ˜¨˜©«˜« ¡æ •¦¤›¨ ¡ãª !!' 
41329>>>>>>>>>>>            end
41329>>>>>>>>>>>>
41329>>>>>>>>>>>        End
41329>>>>>>>>>>>>
41329>>>>>>>>>>>        
41329>>>>>>>>>>>        Set piCreateNew to 1
41330>>>>>>>>>>>    
41330>>>>>>>>>>>    End_Procedure   // Creating
41331>>>>>>>>>>>
41331>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
41332>>>>>>>>>>>        String sStr
41333>>>>>>>>>>>        Move '' to sStr
41334>>>>>>>>>>>        Append sStr "DDC 14: ’¦ §˜¨˜©«˜« ¡æ §œ¨ â®œ  œ¤˜ œå›¦ª «¦ ¦§¦å¦\n"
41335>>>>>>>>>>>        Append sStr "§˜¨¦¬© áœ  ¡å¤ž©ž §¨¦ª £œ«˜©®ž£˜« ©£æ ˜§¦ «¦¤ ®¨ã©«ž\n"
41336>>>>>>>>>>>        Append sStr Particle.Partl_Toposf ". ˜«ã©«œ F5 £œ«˜ «¦ Ž‰"
41338>>>>>>>>>>>
41338>>>>>>>>>>>             If (iError_Num = 1001) Error 1001 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ˜¨˜©«˜« ¡¦ç"
41341>>>>>>>>>>>        Else If (iError_Num = 1002) Error 1002 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ”¦¨â˜"
41345>>>>>>>>>>>        Else If (iError_Num = 1003) Error 1003 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã Œ¦£å©£˜«¦ª"
41349>>>>>>>>>>>        Else If (iError_Num = 1004) Error 1004 "DDC 14: †£œ¨¦£ž¤å˜ §˜¨˜©«˜« ¡¦ç ¡œ¤ã"
41353>>>>>>>>>>>        Else If (iError_Num = 1005) Error 1005 "DDC 14: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
41357>>>>>>>>>>>        Else If (iError_Num = 1006) Error 1006 "DDC 14: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
41361>>>>>>>>>>>        Else If (iError_Num = 1007) Error 1007 "DDC 14: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
41365>>>>>>>>>>>        Else If (iError_Num = 1008) Error 1008 "DDC 14: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
41369>>>>>>>>>>>        Else If (iError_Num = 1009) Error 1009 "DDC 14: ƒœ¤ œå¤˜  œ­ ¡«ã ž › ˜š¨˜­ã \n„®œ  ›ž£ ¦¬¨šžŸœå £œ«˜©®ž£˜« ©£â¤¦ §˜¨˜©«˜« ¡æ"
41373>>>>>>>>>>>        Else If (iError_Num = 1010) Error 1010 "DDC 14: † é¨˜ §¨â§œ  ¤˜ ›¦Ÿœå\n£œ 2 ¯ž­å˜ š ˜ «ž¤ é¨˜ ¡˜  2 š ˜ «˜ ¢œ§«á"
41377>>>>>>>>>>>        Else If (iError_Num = 1011) Error 1011 "DDC 14: †£œ¨¦£ž¤å˜ §¨¦šœ¤â©«œ¨ž «žª «œ¢œ¬«˜å˜ª œ¡«ç§à©žª"
41381>>>>>>>>>>>        Else If (iError_Num = 1012) Error 1012 sStr
41385>>>>>>>>>>>        Else If (iError_Num = 1055) Error 1055 "DDC 14: †£œ¨¦£ž¤åœª œ¡«æª ¦¨åà¤ ®¨ã©žª"
41389>>>>>>>>>>>        Else If (iError_Num = 1060) Error 1060 "DDC 14: ˜¨˜©«˜« ¡æ £œ«˜©®ž£˜« ©£â¤¦.\nƒœ¤ œ§ «¨â§œ«˜  ¦§¦ ˜›ã§¦«œ ˜¢¢˜šã ©«¦ ®œåà¤"
41393>>>>>>>>>>>        Else If (iError_Num = 1061) Error 1061 "DDC 14: ˜¨˜©«˜« ¡æ £œ«˜©®ž£˜« ©£â¤¦.\nƒœ¤ œ§ «¨â§œ«˜  ¤˜ › ˜š¨˜­œå"
41397>>>>>>>>>>>        Else If (iError_Num = 6040) Error 6040 "DDC 14: ƒœ¤ â®œ  §¨¦©› ¦¨ ©«œå ¡à› ¡æª ¤¦£å©£˜«¦ª"
41401>>>>>>>>>>>        Else If (iError_Num = 6050) Error 6050 "DDC 14: Ž œ¢á«žª ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž"
41405>>>>>>>>>>>        Else If (iError_Num = 6051) Error 6051 "DDC 14: ’¦ §˜¨˜©«˜« ¡æ ¡ ¤œå ˜¥åœª ˜¢¢á «¦ ©ç¤¦¢¦ «à¤ ˜¥ é¤ «¦¬ œå¤˜  £ž›œ¤ ¡æ"
41409>>>>>>>>>>>        Else If (iError_Num = 6060) Error 6060 "DDC 14: Ž “§œçŸ¬¤¦ª ¢ž¨à£é¤ ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž"
41413>>>>>>>>>>>        Else If (iError_Num = 1110) Error 1110 "DDC 14: †£/¤å˜ §˜¨˜©«˜« ¡¦ç <= †£/¤å˜ª ¡¢œ ©å£˜«¦ª\nƒœ¤ œ§ «¨â§œ«˜  ¡˜££å˜ «¨¦§¦§¦åž©ž ©«¦ §˜¨˜©«˜« ¡æ"
41417>>>>>>>>>>>        Else If (iError_Num = 1065) Error 1065 "DDC 14: Ž €¨ Ÿ£æª «¦¬ §˜¨˜©«˜« ¡¦ç \nƒ„Œ §¨â§œ  ¡˜  ›œ¤ £§¦¨œå ¤˜ œå¤˜  £ž›œ¤ ¡æª"
41421>>>>>>>>>>>        Else If (iError_Num = 1099) Error 1099 "DDC 14: ‰˜«žš¦¨å˜ œ¢á«ž › ˜­¦¨œ« ¡ã ¡˜«žš¦¨å˜ª ˜¨˜©«˜« ¡¦ç.\n„¢œš®¦ª ¡˜«žš¦¨å˜ª Š ˜¤ ¡ãª / •¦¤›¨ ¡ãª"
41425>>>>>>>>>>>        Else Forward Send Operation_Not_Allowed  iError_Num
41428>>>>>>>>>>>    End_Procedure   // Operation_Not_Allowed
41429>>>>>>>>>>>
41429>>>>>>>>>>>    Function Validate_Save Returns Integer
41430>>>>>>>>>>>        Number nqty
41431>>>>>>>>>>>        Integer iReturnVal iYes
41431>>>>>>>>>>>        String  sCurrentUserID sOldUserID
41431>>>>>>>>>>>
41431>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
41433>>>>>>>>>>>
41433>>>>>>>>>>>        If (Not(iReturnVal)) Begin
41435>>>>>>>>>>>                 If (Ptyppar.Recnum      = 0)   Move 1001 to iReturnVal
41438>>>>>>>>>>>            Else If (Clients.Recnum      = 0)   Move 1002 to iReturnVal
41442>>>>>>>>>>>            Else If (Nomisma.Recnum      = 0)   Move 1003 to iReturnVal
41446>>>>>>>>>>>            Else If (Particle.Partl_Hmnia='')   Move 1004 to iReturnVal
41450>>>>>>>>>>>            Else If  Nomisma.nomisma_Code eq '' Move 6040 to iReturnVal
41454>>>>>>>>>>>          //  else if (clients.is_xondr ne ptyppar.is_xondr) move 1099 to iReturnVal
41454>>>>>>>>>>>            Else Begin
41455>>>>>>>>>>>//                If ((Clients.Plafon>0) And (Clients.OverHead<1) And (Sysfile.Over_OverHead<>'1')) Begin
41455>>>>>>>>>>>//                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
41455>>>>>>>>>>>//                    If (iYes=MBR_NO) Move 6050 to iReturnVal
41455>>>>>>>>>>>//                End
41455>>>>>>>>>>>//                Else If ((Clients.Plafon>0) And (PayResp.Plafon>0) And (PayResp.OverHead<1) And (Sysfile.Over_OverHead<>'1')) Begin
41455>>>>>>>>>>>//                    Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
41455>>>>>>>>>>>//                    If (iYes=MBR_NO) Move 6060 to iReturnVal
41455>>>>>>>>>>>//                End
41455>>>>>>>>>>>//                Else If ((PayResp.Plafon>0) And (PayResp.OverHead<1) And (Sysfile.Over_OverHead<>'1')) begin
41455>>>>>>>>>>>//                    Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
41455>>>>>>>>>>>//                    If (iYes=MBR_NO) Move 6060 to iReturnVal
41455>>>>>>>>>>>//                End
41455>>>>>>>>>>>
41455>>>>>>>>>>>                If ((Particle.Partl_Hmnia<SYSCURXR.YEAR_XRHSHFROM) Or ;                    (Particle.Partl_Hmnia>SYSCURXR.YEAR_XRHSHTO))     ;                                                Move 1055 to iReturnVal
41458>>>>>>>>>>>                Else Begin
41459>>>>>>>>>>>                    If (Particle.Partl_Disctof<>0) Begin
41461>>>>>>>>>>>                        Get fsLoginUserID to sCurrentUserID
41462>>>>>>>>>>>                        Get psOldUserID   to sOldUserID
41463>>>>>>>>>>>                        If (sOldUserID<>'') Begin
41465>>>>>>>>>>>                            If (sOldUserID<>sCurrentUserID) Move 1012 to iReturnVal
41468>>>>>>>>>>>                        End
41468>>>>>>>>>>>>
41468>>>>>>>>>>>                        //Else Move sCurrentUserID to Particle.Partl_Toposf
41468>>>>>>>>>>>                    End
41468>>>>>>>>>>>>
41468>>>>>>>>>>>                    //Else Move '' to Particle.Partl_Toposf
41468>>>>>>>>>>>                End
41468>>>>>>>>>>>>
41468>>>>>>>>>>>            End
41468>>>>>>>>>>>>
41468>>>>>>>>>>>/////////////////////////////////////////////////////////////////////////////
41468>>>>>>>>>>>// js 26/08/2002 Erothsh: Pos tha piaso ena parastatiko to opoio kinei
41468>>>>>>>>>>>//               axies alla katalhgei na exei geniko synolo 0 (an p.x.
41468>>>>>>>>>>>//               ginoun ekptoseis 100%.
41468>>>>>>>>>>>//               Apanthsh: To piano edo me ton oro oti den mporei na kopsei
41468>>>>>>>>>>>//               timologio m'ena eidos mono to opoio exei ekptosh 100%, opote
41468>>>>>>>>>>>//               ef'oson tha yparxoun pano apo ena eidos, to eidos me thn
41468>>>>>>>>>>>//               ekptosh prepei na kataxorithei san 2o kai meta.POTE proto
41468>>>>>>>>>>>//               giati etsi tha exei 0 to synolo tou parastatikou kai tha
41468>>>>>>>>>>>//               varesei to validation.
41468>>>>>>>>>>>
41468>>>>>>>>>>>// Rem giati sthn fash metasxhmatismou apo DAP se TIM den yparxoun times sto DAP
41468>>>>>>>>>>>// opote kai to TIM pou paragetai den exei times (Eno leme pos TIM xoris times den ginetai
41468>>>>>>>>>>>// Bebaia edo mporoume na elegxoume epipleon an to paragomeno erxetai apo metasxhmatismo
41468>>>>>>>>>>>// opote kai tha to afhname. NA TO DOUME.
41468>>>>>>>>>>>//            Else If ((Sysfile.Mhdeniko_Partl=0) And (Ptyppar.Ti_Typonei_Pms<>'1') And ;
41468>>>>>>>>>>>//                     (Particle.Partl_Payam=0)   And (Particle.Partl_NoOfLines>0)) ;
41468>>>>>>>>>>>//                    Move 6051 to iReturnVal
41468>>>>>>>>>>>
41468>>>>>>>>>>>/////////////////////////////////////////////////////////////////////////////
41468>>>>>>>>>>>
41468>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
41471>>>>>>>>>>>        End
41471>>>>>>>>>>>>
41471>>>>>>>>>>>        Function_Return iReturnVal
41472>>>>>>>>>>>    End_Function   // Validate_Save
41473>>>>>>>>>>>
41473>>>>>>>>>>>
41473>>>>>>>>>>>    Function Validate_Delete  Returns Integer
41474>>>>>>>>>>>        Integer iReturnVal
41475>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
41477>>>>>>>>>>>        If (Not(iReturnVal)) Begin
41479>>>>>>>>>>>            If (Particle.Partl_Timol = 1) Move 1009 to iReturnVal
41482>>>>>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                     Move 1110 to iReturnVal
41486>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
41489>>>>>>>>>>>        End
41489>>>>>>>>>>>>
41489>>>>>>>>>>>        Function_Return iReturnVal
41490>>>>>>>>>>>    End_Function   // Validate_Delete
41491>>>>>>>>>>>
41491>>>>>>>>>>>
41491>>>>>>>>>>>    // Define_Fields:
41491>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41491>>>>>>>>>>>
41491>>>>>>>>>>>    Procedure Define_Fields
41492>>>>>>>>>>>        Forward Send Define_Fields
41494>>>>>>>>>>>        //DDB-Generated-Code-Location
41494>>>>>>>>>>>        //DDB-DefineFieldStart
41494>>>>>>>>>>>
41494>>>>>>>>>>>        Set Main_File            To Particle.File_Number
41495>>>>>>>>>>>
41495>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41496>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41497>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41498>>>>>>>>>>>
41498>>>>>>>>>>>        // Child (Client) file structure................
41498>>>>>>>>>>>        Send Add_Client_File  Pmoves.File_Number
41499>>>>>>>>>>>        Send Add_Client_File  Tparticl.File_Number
41500>>>>>>>>>>>        Send Add_Client_File  Partlfpa.File_Number
41501>>>>>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
41502>>>>>>>>>>>        Send Add_Client_File  Psxetika.File_Number
41503>>>>>>>>>>>
41503>>>>>>>>>>>        // Parent (Server) file structure...............
41503>>>>>>>>>>>        Send Add_Server_File  Clients.File_Number
41504>>>>>>>>>>>        Send Add_Server_File  Ptyppar.File_Number
41505>>>>>>>>>>>        Send Add_Server_File  Nomisma.File_Number
41506>>>>>>>>>>>
41506>>>>>>>>>>>        // External (System) file structure.............
41506>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_NEW_SAVE
41507>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
41508>>>>>>>>>>>        Send Add_System_File  Pseira.File_Number  DD_LOCK_ON_ALL
41509>>>>>>>>>>>        Send Add_System_File  Cn.File_Number  DD_LOCK_ON_ALL
41510>>>>>>>>>>>        Send Add_System_File  Partlfpa.File_Number  DD_LOCK_ON_ALL
41511>>>>>>>>>>>        Send Add_System_File  Clorder.File_Number  DD_LOCK_ON_ALL
41512>>>>>>>>>>>        Send Add_System_File  Clorderd.File_Number  DD_LOCK_ON_ALL
41513>>>>>>>>>>>        Send Add_System_File  Ypoprosf.File_Number  DD_LOCK_ON_ALL
41514>>>>>>>>>>>        Send Add_System_File  Psxetika.File_Number  DD_LOCK_ON_ALL
41515>>>>>>>>>>>        Send Add_System_File  Pmoves.File_Number  DD_LOCK_ON_ALL
41516>>>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
41517>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
41518>>>>>>>>>>>
41518>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Particle_Rec0  To Particle.Partl_Rec0
41521>>>>>>>>>>>
41521>>>>>>>>>>>        // Field-based properties.......................
41521>>>>>>>>>>>
41521>>>>>>>>>>>        // Particle.Company_Code
41521>>>>>>>>>>>
41521>>>>>>>>>>>        // Particle.Branch_Code
41521>>>>>>>>>>>
41521>>>>>>>>>>>        // Particle.Year_Year
41521>>>>>>>>>>>
41521>>>>>>>>>>>        // Particle.Ctypkin_Code
41521>>>>>>>>>>>
41521>>>>>>>>>>>        // Particle.Wtypkin_Code
41521>>>>>>>>>>>
41521>>>>>>>>>>>        // Particle.Ptyppar_Code
41521>>>>>>>>>>>
41521>>>>>>>>>>>        // Particle.Pseira_Seira
41521>>>>>>>>>>>
41521>>>>>>>>>>>        // Particle.Custprom_Code
41521>>>>>>>>>>>
41521>>>>>>>>>>>        // Particle.Client_Id
41521>>>>>>>>>>>
41521>>>>>>>>>>>        // Particle.Partl_No
41521>>>>>>>>>>>
41521>>>>>>>>>>>        // Particle.Cn_Recr
41521>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Cn_Recr To (sl041(Self))
41522>>>>>>>>>>>
41522>>>>>>>>>>>        // Particle.Pseira_Recr
41522>>>>>>>>>>>
41522>>>>>>>>>>>        // Particle.Partl_Hmnia
41522>>>>>>>>>>>        Set Field_Entry_msg        Field Particle.Partl_Hmnia To Shmera
41523>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Partl_Hmnia To (sl014(Self))
41524>>>>>>>>>>>
41524>>>>>>>>>>>        // Particle.Partl_Rec0
41524>>>>>>>>>>>        Set Field_Options          Field Particle.Partl_Rec0 To DD_AUTOFIND   
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Lastno
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Tdiakin
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Car
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Reldoc
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Toposf
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Toposa
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Troposa
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Tof
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Disctof
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Disccl
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Autodisc
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Time
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Totambd
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Amdiscpms
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Totdiscpc
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Discam
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Totamad
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Vatpct
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Vatam
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Genam
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Extra
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Extravatp
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Extravat
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Payam
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Befypol
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Currypol
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Tottem
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Det
41525>>>>>>>>>>>
41525>>>>>>>>>>>        // Particle.Partl_Recr
41525>>>>>>>>>>>        Set Field_Options          Field Particle.Partl_Recr To DD_AUTOFIND   
41526>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Partl_Recr To (sl014(Self))
41527>>>>>>>>>>>
41527>>>>>>>>>>>        // Particle.Cn_Code
41527>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Cn_Code To (sl041(Self))
41528>>>>>>>>>>>
41528>>>>>>>>>>>        // Particle.Client_Recr
41528>>>>>>>>>>>
41528>>>>>>>>>>>        // Particle.Ptyppar_Recr
41528>>>>>>>>>>>
41528>>>>>>>>>>>        // Particle.Partl_Ekleise
41528>>>>>>>>>>>
41528>>>>>>>>>>>        // Particle.Partl_Ekl_Recr
41528>>>>>>>>>>>
41528>>>>>>>>>>>        // Particle.Partl_Ektyposh
41528>>>>>>>>>>>
41528>>>>>>>>>>>        // Particle.Partl_Akyrosh
41528>>>>>>>>>>>
41528>>>>>>>>>>>        // Particle.Partl_Akyr_Recr
41528>>>>>>>>>>>
41528>>>>>>>>>>>        // Particle.Partl_Nooflines
41528>>>>>>>>>>>
41528>>>>>>>>>>>        // Particle.Cmoves_Recr
41528>>>>>>>>>>>
41528>>>>>>>>>>>        // Particle.Nomisma_Code
41528>>>>>>>>>>>
41528>>>>>>>>>>>        // Particle.Isotimia
41528>>>>>>>>>>>
41528>>>>>>>>>>>        // Particle.Wcmoves_Recr
41528>>>>>>>>>>>
41528>>>>>>>>>>>        // Particle.Partl_Module
41528>>>>>>>>>>>
41528>>>>>>>>>>>        // Particle.Partl_Timol
41528>>>>>>>>>>>        Set Field_Mask             Field Particle.Partl_Timol To "#"
41529>>>>>>>>>>>        Set Field_Mask_Type        Field Particle.Partl_Timol To MASK_NUMERIC_WINDOW
41530>>>>>>>>>>>
41530>>>>>>>>>>>        // Particle.Partl_Selected
41530>>>>>>>>>>>
41530>>>>>>>>>>>        // Particle.Partl_Tim_Recr
41530>>>>>>>>>>>
41530>>>>>>>>>>>        // Particle.Partl_Vsn
41530>>>>>>>>>>>
41530>>>>>>>>>>>        // Particle.Sls_Id
41530>>>>>>>>>>>
41530>>>>>>>>>>>        // Particle.Presp_Id
41530>>>>>>>>>>>
41530>>>>>>>>>>>        // Particle.Cnt_Id
41530>>>>>>>>>>>
41530>>>>>>>>>>>        // Particle.Topos_Apostolhs
41530>>>>>>>>>>>
41530>>>>>>>>>>>        // Particle.Tropos_Diakin
41530>>>>>>>>>>>        Set Field_Class_Name       Field Particle.Tropos_Diakin To "dbComboFormsub"
41531>>>>>>>>>>>        Set Field_Value_Table      Field Particle.Tropos_Diakin To (Particle_Tropos_Diakin_VT(Self))
41532>>>>>>>>>>>
41532>>>>>>>>>>>        // Particle.Ora_Apostolhs
41532>>>>>>>>>>>        Set Field_Entry_msg        Field Particle.Ora_Apostolhs To Shmera_Ora_String
41533>>>>>>>>>>>        Set Field_Mask             Field Particle.Ora_Apostolhs To "##:##"
41534>>>>>>>>>>>
41534>>>>>>>>>>>        // Particle.Skopos_Diakin
41534>>>>>>>>>>>        Set Field_Class_Name       Field Particle.Skopos_Diakin To "dbComboFormsub"
41535>>>>>>>>>>>        Set Field_Value_Table      Field Particle.Skopos_Diakin To (Particle_Skopos_Diakin_VT(Self))
41536>>>>>>>>>>>
41536>>>>>>>>>>>        // Particle.Tropos_Plhromhs
41536>>>>>>>>>>>        Set Field_Value_Table      Field Particle.Tropos_Plhromhs To (Particle_Tropos_Plhromhs_VT(Self))
41537>>>>>>>>>>>
41537>>>>>>>>>>>        // Particle.Odhgos_Code
41537>>>>>>>>>>>
41537>>>>>>>>>>>        // Particle.Odhgos_Name
41537>>>>>>>>>>>
41537>>>>>>>>>>>        // Particle.Oxhma_Code
41537>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Oxhma_Code To (sl054(Self))
41538>>>>>>>>>>>
41538>>>>>>>>>>>        // Particle.Oxhma_Descr
41538>>>>>>>>>>>
41538>>>>>>>>>>>        // Particle.Antlia_Code
41538>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Antlia_Code To (sl053(Self))
41539>>>>>>>>>>>
41539>>>>>>>>>>>        // Particle.Antlia_Descr
41539>>>>>>>>>>>
41539>>>>>>>>>>>        // Particle.Partl_Euro
41539>>>>>>>>>>>
41539>>>>>>>>>>>        // Particle.Disc_Vat_Pct
41539>>>>>>>>>>>
41539>>>>>>>>>>>        // Particle.Disc_Vat_Poso
41539>>>>>>>>>>>
41539>>>>>>>>>>>        // Particle.Total_Vat_Poso
41539>>>>>>>>>>>
41539>>>>>>>>>>>        // Particle.Exei_Sxetika
41539>>>>>>>>>>>
41539>>>>>>>>>>>        // Particle.Aitiol
41539>>>>>>>>>>>
41539>>>>>>>>>>>        // Particle.Max_Days_Date
41539>>>>>>>>>>>
41539>>>>>>>>>>>        // Particle.Timol_Qty
41539>>>>>>>>>>>
41539>>>>>>>>>>>        // Particle.Timol_Ypol
41539>>>>>>>>>>>
41539>>>>>>>>>>>        // Particle.Epilogh_Ekkrem
41539>>>>>>>>>>>
41539>>>>>>>>>>>        // Particle.No_Print_Module
41539>>>>>>>>>>>        //DDB/ Comment_Short       Field Particle.No_Print_Module To "Œ˜ £ž¤ «¬§é¤œ«˜  (˜§¦ ˜¢¢¦ ¡ç¡¢à£˜ §.®.§˜¨˜š ©œ ¨¦£)"
41539>>>>>>>>>>>
41539>>>>>>>>>>>        // Particle.Prohg_Ypol
41539>>>>>>>>>>>
41539>>>>>>>>>>>        // Particle.Trex_Ypol
41539>>>>>>>>>>>
41539>>>>>>>>>>>        // Particle.Parakrat_Pct
41539>>>>>>>>>>>
41539>>>>>>>>>>>        // Particle.Parakrat_Poso
41539>>>>>>>>>>>
41539>>>>>>>>>>>        // Particle.Cms_Parak_Recr
41539>>>>>>>>>>>
41539>>>>>>>>>>>        // Particle.Enhm_Logik
41539>>>>>>>>>>>
41539>>>>>>>>>>>        // Particle.Se_Logik
41539>>>>>>>>>>>
41539>>>>>>>>>>>        // Particle.Akyro
41539>>>>>>>>>>>
41539>>>>>>>>>>>        // Particle.Zone_Id
41539>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Zone_Id To (sl064(Self))
41540>>>>>>>>>>>
41540>>>>>>>>>>>        // Particle.Fpa_On_Total
41540>>>>>>>>>>>
41540>>>>>>>>>>>        // Particle.Ss_Arithmos
41540>>>>>>>>>>>
41540>>>>>>>>>>>        // Particle.Sap_Hmnia
41540>>>>>>>>>>>        Set Field_Mask_Type        Field Particle.Sap_Hmnia To MASK_DATE_WINDOW
41541>>>>>>>>>>>
41541>>>>>>>>>>>        //DDB-DefineFieldEnd
41541>>>>>>>>>>>    End_Procedure    // Define_Fields
41542>>>>>>>>>>>
41542>>>>>>>>>>>    // Field_Defaults:
41542>>>>>>>>>>>    // This procedure is used to establish default field values.
41542>>>>>>>>>>>
41542>>>>>>>>>>>    Procedure Field_Defaults
41543>>>>>>>>>>>        Forward Send Field_Defaults
41545>>>>>>>>>>>        //DDB-Generated-Code-Location
41545>>>>>>>>>>>        //DDB-FieldDefaultStart
41545>>>>>>>>>>>        //DDB-FieldDefaultEnd
41545>>>>>>>>>>>        Set Field_Changed_Value Field Particle.Nomisma_Code to SyscurXr.C_Code0
41546>>>>>>>>>>>    End_Procedure    // Field_Defaults
41547>>>>>>>>>>>
41547>>>>>>>>>>>End_Class    // Particle_DataDictionary
41548>>>>>>>>>>>//DDB-Selection-pkg-Start
41548>>>>>>>>>>>
41548>>>>>>>>>>>Use sl041.SL         // sl041
INCLUDING FILE: SL041.SL
41548>>>>>>>>>>>>>//AB/ Project CN : sl041
41548>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
41548>>>>>>>>>>>>>//AB/         Set ProjectName to "CN : sl041"
41548>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl041.SL"
41548>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
41548>>>>>>>>>>>>>
41548>>>>>>>>>>>>>// Project Object Structure
41548>>>>>>>>>>>>>//   sl041 is a dbModalPanelSub
41548>>>>>>>>>>>>>//     Clients_DD is a DataDictionary
41548>>>>>>>>>>>>>//     Cn_DD is a DataDictionary
41548>>>>>>>>>>>>>//     oSelList is a dbListSub
41548>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
41548>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
41548>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
41548>>>>>>>>>>>>>
41548>>>>>>>>>>>>>// Register all objects
41548>>>>>>>>>>>>>Register_Object Clients_DD
41548>>>>>>>>>>>>>Register_Object Cn_DD
41548>>>>>>>>>>>>>Register_Object oCancel_bn
41548>>>>>>>>>>>>>Register_Object oOK_bn
41548>>>>>>>>>>>>>Register_Object oSearch_bn
41548>>>>>>>>>>>>>Register_Object oSelList
41548>>>>>>>>>>>>>Register_Object sl041
41548>>>>>>>>>>>>>
41548>>>>>>>>>>>>>
41548>>>>>>>>>>>>>    //AB-IgnoreStart
41548>>>>>>>>>>>>>
41548>>>>>>>>>>>>>    Use DFAllEnt.pkg
41548>>>>>>>>>>>>>    Use dbList.Sub
41548>>>>>>>>>>>>>    Use Button.Sub
41548>>>>>>>>>>>>>
41548>>>>>>>>>>>>>
41548>>>>>>>>>>>>>    Use CLIENTS.DD
41548>>>>>>>>>>>>>    Use CN.DD
INCLUDING FILE: CN.DD
41548>>>>>>>>>>>>>>>//DDB-FileStart
41548>>>>>>>>>>>>>>>//DDB-HeaderStart
41548>>>>>>>>>>>>>>>
41548>>>>>>>>>>>>>>>// File Name : CN.DD
41548>>>>>>>>>>>>>>>// Class Name: Cn_DataDictionary
41548>>>>>>>>>>>>>>>// Revision  : 99
41548>>>>>>>>>>>>>>>// Version   : 2
41548>>>>>>>>>>>>>>>
41548>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
41548>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41548>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41548>>>>>>>>>>>>>>>
41548>>>>>>>>>>>>>>>Open Cn
41550>>>>>>>>>>>>>>>Open Cnzones
INCLUDING FILE: CNZONES.FD
41552>>>>>>>>>>>>>>>Open Tperga
INCLUDING FILE: TPERGA.FD
41554>>>>>>>>>>>>>>>Open Btnordh
INCLUDING FILE: BTNORDH.FD
41556>>>>>>>>>>>>>>>Open Dorderh
INCLUDING FILE: DORDERH.FD
41558>>>>>>>>>>>>>>>Open Clients
41560>>>>>>>>>>>>>>>Open Salesmen
41562>>>>>>>>>>>>>>>Open Mhxanik
41564>>>>>>>>>>>>>>>Open Constrct
41566>>>>>>>>>>>>>>>Open Sysrecc
41568>>>>>>>>>>>>>>>Open Syscurxr
41570>>>>>>>>>>>>>>>Open Gmove
41572>>>>>>>>>>>>>>>Open Sysrecg
41574>>>>>>>>>>>>>>>
41574>>>>>>>>>>>>>>>//DDB-HeaderEnd
41574>>>>>>>>>>>>>>>//DDB-ValidationStart
41574>>>>>>>>>>>>>>>
41574>>>>>>>>>>>>>>>Register_Object Cn_Cn_Categfpa_VT1
41574>>>>>>>>>>>>>>>Register_Object Cn_Tropos_Metaf_VT
41574>>>>>>>>>>>>>>>Register_Object Cn_Eidos_Cn_VT
41574>>>>>>>>>>>>>>>Register_Object Cn_Yesno_VT
41574>>>>>>>>>>>>>>>
41574>>>>>>>>>>>>>>>Object Cn_Cn_Categfpa_VT1  is a CodeValidationTable
41576>>>>>>>>>>>>>>>    Set Type_Value        To "VAT_STATUS"
41577>>>>>>>>>>>>>>>    Set Validate_State    To FALSE
41578>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
41579>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
41579>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
41579>>>>>>>>>>>>>>>End_Object   // Cn_Cn_Categfpa_VT1
41580>>>>>>>>>>>>>>>
41580>>>>>>>>>>>>>>>Object Cn_Tropos_Metaf_VT  is a CodeValidationTable
41582>>>>>>>>>>>>>>>    Set Type_Value        To "FORTOSH"
41583>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
41584>>>>>>>>>>>>>>>    Set Table_Title       To "’¨æ§¦  ‹œ«˜­¦¨áª"
41585>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
41585>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
41585>>>>>>>>>>>>>>>End_Object   // Cn_Tropos_Metaf_VT
41586>>>>>>>>>>>>>>>
41586>>>>>>>>>>>>>>>Object Cn_Eidos_Cn_VT  is a CodeValidationTable
41588>>>>>>>>>>>>>>>    Set Type_Value        To "EIDOSCN"
41589>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
41590>>>>>>>>>>>>>>>    Set Table_Title       To "„å›¦ª „¨š¦¬"
41591>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
41591>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
41591>>>>>>>>>>>>>>>End_Object   // Cn_Eidos_Cn_VT
41592>>>>>>>>>>>>>>>
41592>>>>>>>>>>>>>>>Object Cn_Yesno_VT  is a CodeValidationTable
41594>>>>>>>>>>>>>>>    Set Type_Value        To "YESNO"
41595>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
41596>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
41596>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
41596>>>>>>>>>>>>>>>End_Object   // Cn_Yesno_VT
41597>>>>>>>>>>>>>>>//DDB-ValidationEnd
41597>>>>>>>>>>>>>>>//DDB-SelectionStart
41597>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.sl
41597>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
41597>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
41597>>>>>>>>>>>>>>>Register_Object sl041
41597>>>>>>>>>>>>>>>Register_Object sl198
41597>>>>>>>>>>>>>>>Register_Object sl197
41597>>>>>>>>>>>>>>>//DDB-SelectionEnd
41597>>>>>>>>>>>>>>>
41597>>>>>>>>>>>>>>>Class Cn_DataDictionary  is a DataDictionary_Sec
41598>>>>>>>>>>>>>>>
41598>>>>>>>>>>>>>>>
41598>>>>>>>>>>>>>>>    Procedure Construct_Object
41599>>>>>>>>>>>>>>>        Forward Send Construct_Object
41601>>>>>>>>>>>>>>>        //------------------------------------------------
41601>>>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
41601>>>>>>>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
41601>>>>>>>>>>>>>>>        // einai 1     js 03/12/2007
41601>>>>>>>>>>>>>>>        //------------------------------------------------  
41601>>>>>>>>>>>>>>>        Property Integer piCreateNew            Public  0
41602>>>>>>>>>>>>>>>        Property String  psAud_Old_CN           Public ""
41603>>>>>>>>>>>>>>>        Property String  psAud_Old_CNAdd        Public ""
41604>>>>>>>>>>>>>>>        Property String  psAud_Old_Chem         Public ""
41605>>>>>>>>>>>>>>>        Property String  psAud_Old_CNRecr       Public ""
41606>>>>>>>>>>>>>>>        //------------------------------------------------
41606>>>>>>>>>>>>>>>
41606>>>>>>>>>>>>>>>    End_procedure
41607>>>>>>>>>>>>>>>
41607>>>>>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
41608>>>>>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
41610>>>>>>>>>>>>>>>        //------------------------------------------------
41610>>>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
41610>>>>>>>>>>>>>>>        // ton pedion js 03/12/2007
41610>>>>>>>>>>>>>>>        //------------------------------------------------
41610>>>>>>>>>>>>>>>        Set psAud_Old_CN           to CN.CN_Code
41611>>>>>>>>>>>>>>>        Set psAud_Old_CNAdd        to CN.CN_Descr
41612>>>>>>>>>>>>>>>        Set psAud_Old_Chem         to CN.CN_VTicket
41613>>>>>>>>>>>>>>>        Set psAud_Old_CNRecr       to CN.CN_Recr
41614>>>>>>>>>>>>>>>        //------------------------------------------------
41614>>>>>>>>>>>>>>>     End_Procedure   // New_Current_Record
41615>>>>>>>>>>>>>>>
41615>>>>>>>>>>>>>>>    Procedure Delete_Main_File
41616>>>>>>>>>>>>>>>        //---------------------------------------------
41616>>>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
41616>>>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
41617>>>>>>>>>>>>>>>        Date    dDate  Shmer 
41617>>>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
41617>>>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
41621>>>>>>>>>>>>>>>        Move iHour  to sHour
41622>>>>>>>>>>>>>>>        Move iMin   to sMin
41623>>>>>>>>>>>>>>>        Move iSec   to sSec
41624>>>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
41628>>>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
41632>>>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
41636>>>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
41637>>>>>>>>>>>>>>>        
41637>>>>>>>>>>>>>>>        // Auditing / Diagrafh 
41637>>>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
41639>>>>>>>>>>>>>>>            Get fsLoginUserID to sUser
41640>>>>>>>>>>>>>>>            clear gmove
41641>>>>>>>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
41642>>>>>>>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
41643>>>>>>>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
41644>>>>>>>>>>>>>>>            move  4                     to gmove.gtypkin_code// Apo Clients
41645>>>>>>>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
41646>>>>>>>>>>>>>>>            move suser                  to gmove.gplan_code
41647>>>>>>>>>>>>>>>            move CN.CN_Recr             to gmove.garticl_recr
41648>>>>>>>>>>>>>>>            reread sysrecg
41652>>>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
41653>>>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
41654>>>>>>>>>>>>>>>            saverecord sysrecg
41655>>>>>>>>>>>>>>>            unlock
41656>>>>>>>>>>>>>>>>
41656>>>>>>>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
41657>>>>>>>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
41658>>>>>>>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
41659>>>>>>>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
41660>>>>>>>>>>>>>>>            
41660>>>>>>>>>>>>>>>            Move CN.CN_Recr                     to Gmove.Partl_Recr          
41661>>>>>>>>>>>>>>>            Move CN.CN_Recr                     to Gmove.Pms_Recr          
41662>>>>>>>>>>>>>>>
41662>>>>>>>>>>>>>>>            Move (psAud_Old_CN    (Self))       to Gmove.Prev_CN
41663>>>>>>>>>>>>>>>            Move (psAud_Old_CNAdd (Self))       to Gmove.Prev_CN_Addr
41664>>>>>>>>>>>>>>>            Move (psAud_Old_Chem  (Self))       to Gmove.Prev_CN_Prosth
41665>>>>>>>>>>>>>>>
41665>>>>>>>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª ë¨š¦¬"      to gmove.gmove_aitiol
41666>>>>>>>>>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
41667>>>>>>>>>>>>>>>            saverecord gmove
41668>>>>>>>>>>>>>>>        End
41668>>>>>>>>>>>>>>>>
41668>>>>>>>>>>>>>>>        Forward Send Delete_Main_File
41670>>>>>>>>>>>>>>>
41670>>>>>>>>>>>>>>>    End_Procedure
41671>>>>>>>>>>>>>>>
41671>>>>>>>>>>>>>>>    Procedure Update
41672>>>>>>>>>>>>>>>        Forward Send Update
41674>>>>>>>>>>>>>>>        // Insert Code Here
41674>>>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to CN.Company_Code
41675>>>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to CN.Branch_Code
41676>>>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to CN.Year_Year
41677>>>>>>>>>>>>>>>        //Move Custprom.Custprom_Code to CN.Custprom_Code
41677>>>>>>>>>>>>>>>        Move Clients.Client_ID      to CN.Client_ID
41678>>>>>>>>>>>>>>>
41678>>>>>>>>>>>>>>>        Move SysCurXR.Beto_Site      to CN.Cn_SiteW
41679>>>>>>>>>>>>>>>        Move Cn.Cn_Rec0              to CN.Cn_SN
41680>>>>>>>>>>>>>>>        Move Cn.Client_id            to Cn.Cn_clientid
41681>>>>>>>>>>>>>>>        Move Cn.cn_code              to Cn.Cn_Repmatch
41682>>>>>>>>>>>>>>>        Move Cn.Cn_Code              to Cn.Constraction_ID
41683>>>>>>>>>>>>>>>        Move PayResp.Presp_ID        to Cn.Cn_Presp_ID
41684>>>>>>>>>>>>>>>        Move Salesmen.Sls_ID         to Cn.Cn_Sls_ID
41685>>>>>>>>>>>>>>>        Move Constrct.Cnt_ID         to Cn.Cn_Cnt_ID
41686>>>>>>>>>>>>>>>        Move mhxanik.mhx_id          to Cn.mhxanik_ID
41687>>>>>>>>>>>>>>>
41687>>>>>>>>>>>>>>>        //---------------------------------------------
41687>>>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
41687>>>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
41688>>>>>>>>>>>>>>>        Date    dDate  Shmer 
41688>>>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
41688>>>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
41692>>>>>>>>>>>>>>>        Move iHour  to sHour
41693>>>>>>>>>>>>>>>        Move iMin   to sMin
41694>>>>>>>>>>>>>>>        Move iSec   to sSec
41695>>>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
41699>>>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
41703>>>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
41707>>>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
41708>>>>>>>>>>>>>>>        
41708>>>>>>>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
41708>>>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
41710>>>>>>>>>>>>>>>            Get fsLoginUserID to sUser
41711>>>>>>>>>>>>>>>            If (piCreateNew(Self)=1) Begin
41713>>>>>>>>>>>>>>>                clear gmove
41714>>>>>>>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
41715>>>>>>>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
41716>>>>>>>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
41717>>>>>>>>>>>>>>>                move  4                     to gmove.gtypkin_code// Apo Clients
41718>>>>>>>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
41719>>>>>>>>>>>>>>>                move suser                  to gmove.gplan_code
41720>>>>>>>>>>>>>>>                move CN.CN_Recr             to gmove.garticl_recr
41721>>>>>>>>>>>>>>>                reread sysrecg
41725>>>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
41726>>>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
41727>>>>>>>>>>>>>>>                saverecord sysrecg
41728>>>>>>>>>>>>>>>                unlock
41729>>>>>>>>>>>>>>>>
41729>>>>>>>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
41730>>>>>>>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
41731>>>>>>>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
41732>>>>>>>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
41733>>>>>>>>>>>>>>>
41733>>>>>>>>>>>>>>>                Move CN.CN_Recr                 to Gmove.Partl_Recr          
41734>>>>>>>>>>>>>>>                Move CN.CN_Recr                 to Gmove.Pms_Recr          
41735>>>>>>>>>>>>>>>
41735>>>>>>>>>>>>>>>                Move CN.CN_Code                 to Gmove.Cur_CN
41736>>>>>>>>>>>>>>>                Move CN.CN_Descr                to Gmove.Cur_CN_Addr
41737>>>>>>>>>>>>>>>                Move CN.CN_VTicket              to Gmove.Cur_CN_Prosth
41738>>>>>>>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â¦¬ ë¨š¦¬"    to Gmove.Gmove_Aitiol
41739>>>>>>>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs  
41740>>>>>>>>>>>>>>>                saverecord gmove
41741>>>>>>>>>>>>>>>                Set piCreateNew to 0
41742>>>>>>>>>>>>>>>            End
41742>>>>>>>>>>>>>>>>
41742>>>>>>>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
41745>>>>>>>>>>>>>>>                Integer isChanged
41745>>>>>>>>>>>>>>>                Move 0 to isChanged
41746>>>>>>>>>>>>>>>                
41746>>>>>>>>>>>>>>>                     If (psAud_Old_CN   (Self)<>CN.CN_Code   ) Move 1 to isChanged
41749>>>>>>>>>>>>>>>                Else If (psAud_Old_CNAdd(Self)<>CN.CN_Descr  ) Move 1 to isChanged
41753>>>>>>>>>>>>>>>                Else If (psAud_Old_Chem (Self)<>CN.CN_VTicket) Move 1 to isChanged
41757>>>>>>>>>>>>>>>                
41757>>>>>>>>>>>>>>>                If (isChanged>0) Begin  
41759>>>>>>>>>>>>>>>                    clear gmove
41760>>>>>>>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
41761>>>>>>>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
41762>>>>>>>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
41763>>>>>>>>>>>>>>>                    move  4                     to gmove.gtypkin_code// Apo Clients
41764>>>>>>>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
41765>>>>>>>>>>>>>>>                    move suser                  to gmove.gplan_code
41766>>>>>>>>>>>>>>>                    move Payresp.Presp_Recr    to gmove.garticl_recr
41767>>>>>>>>>>>>>>>                    reread sysrecg
41771>>>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
41772>>>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
41773>>>>>>>>>>>>>>>                    saverecord sysrecg
41774>>>>>>>>>>>>>>>                    unlock
41775>>>>>>>>>>>>>>>>
41775>>>>>>>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
41776>>>>>>>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
41777>>>>>>>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
41778>>>>>>>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
41779>>>>>>>>>>>>>>>                    Move CN.CN_Recr                     to Gmove.Partl_Recr          
41780>>>>>>>>>>>>>>>                    Move CN.CN_Recr                     to Gmove.Pms_Recr          
41781>>>>>>>>>>>>>>>                    //--                                
41781>>>>>>>>>>>>>>>                    Move CN.CN_Code                     to Gmove.Cur_CN
41782>>>>>>>>>>>>>>>                    Move CN.CN_Descr                    to Gmove.Cur_CN_Addr
41783>>>>>>>>>>>>>>>                    Move CN.CN_VTicket                  to Gmove.Cur_CN_Prosth
41784>>>>>>>>>>>>>>>                    //--
41784>>>>>>>>>>>>>>>                    Move (psAud_Old_CN    (Self))       to Gmove.Prev_CN
41785>>>>>>>>>>>>>>>                    Move (psAud_Old_CNAdd (Self))       to Gmove.Prev_CN_Addr
41786>>>>>>>>>>>>>>>                    Move (psAud_Old_Chem  (Self))       to Gmove.Prev_CN_Prosth
41787>>>>>>>>>>>>>>>
41787>>>>>>>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª ë¨š¦¬"      to gmove.gmove_aitiol
41788>>>>>>>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
41789>>>>>>>>>>>>>>>                    saverecord gmove
41790>>>>>>>>>>>>>>>                    Set piCreateNew to 0
41791>>>>>>>>>>>>>>>                End
41791>>>>>>>>>>>>>>>>
41791>>>>>>>>>>>>>>>            End
41791>>>>>>>>>>>>>>>>
41791>>>>>>>>>>>>>>>        End
41791>>>>>>>>>>>>>>>>
41791>>>>>>>>>>>>>>>
41791>>>>>>>>>>>>>>>
41791>>>>>>>>>>>>>>>    End_Procedure   // Update
41792>>>>>>>>>>>>>>>
41792>>>>>>>>>>>>>>>     Procedure Creating
41793>>>>>>>>>>>>>>>        Forward Send Creating
41795>>>>>>>>>>>>>>>        // Insert Code Here
41795>>>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(CN.CN_Rec0)))))) to CN.CN_Recr
41796>>>>>>>>>>>>>>>        Get fsgCode_With_Zeroes CN.CN_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to CN.CN_Code
41797>>>>>>>>>>>>>>>        Set piCreateNew to 1
41798>>>>>>>>>>>>>>>    End_Procedure   // Creating
41799>>>>>>>>>>>>>>>
41799>>>>>>>>>>>>>>>
41799>>>>>>>>>>>>>>>
41799>>>>>>>>>>>>>>>    // Define_Fields:
41799>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41799>>>>>>>>>>>>>>>
41799>>>>>>>>>>>>>>>    Procedure Define_Fields
41800>>>>>>>>>>>>>>>        Forward Send Define_Fields
41802>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
41802>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
41802>>>>>>>>>>>>>>>
41802>>>>>>>>>>>>>>>        Set Main_File            To Cn.File_Number
41803>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
41804>>>>>>>>>>>>>>>
41804>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41805>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41806>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41807>>>>>>>>>>>>>>>
41807>>>>>>>>>>>>>>>        // Child (Client) file structure................
41807>>>>>>>>>>>>>>>        Send Add_Client_File  Cnzones.File_Number
41808>>>>>>>>>>>>>>>        Send Add_Client_File  Tperga.File_Number
41809>>>>>>>>>>>>>>>        Send Add_Client_File  Btnordh.File_Number
41810>>>>>>>>>>>>>>>        Send Add_Client_File  Dorderh.File_Number
41811>>>>>>>>>>>>>>>
41811>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
41811>>>>>>>>>>>>>>>        Send Add_Server_File  Clients.File_Number
41812>>>>>>>>>>>>>>>        Send Add_Server_File  Salesmen.File_Number
41813>>>>>>>>>>>>>>>        Send Add_Server_File  Mhxanik.File_Number
41814>>>>>>>>>>>>>>>        Send Add_Server_File  Constrct.File_Number
41815>>>>>>>>>>>>>>>
41815>>>>>>>>>>>>>>>        // External (System) file structure.............
41815>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
41816>>>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
41817>>>>>>>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
41818>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
41819>>>>>>>>>>>>>>>
41819>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Cn_Rec0  To Cn.Cn_Rec0
41822>>>>>>>>>>>>>>>
41822>>>>>>>>>>>>>>>        // Field-based properties.......................
41822>>>>>>>>>>>>>>>
41822>>>>>>>>>>>>>>>        // Cn.Company_Code
41822>>>>>>>>>>>>>>>
41822>>>>>>>>>>>>>>>        // Cn.Branch_Code
41822>>>>>>>>>>>>>>>
41822>>>>>>>>>>>>>>>        // Cn.Year_Year
41822>>>>>>>>>>>>>>>
41822>>>>>>>>>>>>>>>        // Cn.Custprom_Code
41822>>>>>>>>>>>>>>>
41822>>>>>>>>>>>>>>>        // Cn.Client_Id
41822>>>>>>>>>>>>>>>
41822>>>>>>>>>>>>>>>        // Cn.Cn_Code
41822>>>>>>>>>>>>>>>        Set Field_Options          Field Cn.Cn_Code To DD_AUTOFIND    DD_NOPUT      
41823>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Code To (sl041(Self))
41824>>>>>>>>>>>>>>>        Set Key_Field_State        Field Cn.Cn_Code To TRUE
41825>>>>>>>>>>>>>>>
41825>>>>>>>>>>>>>>>        // Cn.Client_Recr
41825>>>>>>>>>>>>>>>
41825>>>>>>>>>>>>>>>        // Cn.Cn_Rec0
41825>>>>>>>>>>>>>>>
41825>>>>>>>>>>>>>>>        // Cn.Cn_Recr
41825>>>>>>>>>>>>>>>
41825>>>>>>>>>>>>>>>        // Cn.Cn_Descr
41825>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Descr To (sl041(Self))
41826>>>>>>>>>>>>>>>
41826>>>>>>>>>>>>>>>        // Cn.Cn_Address
41826>>>>>>>>>>>>>>>
41826>>>>>>>>>>>>>>>        // Cn.Cn_Zipcode
41826>>>>>>>>>>>>>>>
41826>>>>>>>>>>>>>>>        // Cn.Cn_City
41826>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_City To (sl198(Self))
41827>>>>>>>>>>>>>>>
41827>>>>>>>>>>>>>>>        // Cn.Cn_Area
41827>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Area To (sl197(Self))
41828>>>>>>>>>>>>>>>
41828>>>>>>>>>>>>>>>        // Cn.Cn_License
41828>>>>>>>>>>>>>>>
41828>>>>>>>>>>>>>>>        // Cn.Cn_Responsible
41828>>>>>>>>>>>>>>>
41828>>>>>>>>>>>>>>>        // Cn.Cn_Cnt_Recr
41828>>>>>>>>>>>>>>>
41828>>>>>>>>>>>>>>>        // Cn.Cn_Cnt_Id
41828>>>>>>>>>>>>>>>
41828>>>>>>>>>>>>>>>        // Cn.Cn_Phone
41828>>>>>>>>>>>>>>>
41828>>>>>>>>>>>>>>>        // Cn.Cn_Zone
41828>>>>>>>>>>>>>>>
41828>>>>>>>>>>>>>>>        // Cn.Cn_Sls_Recr
41828>>>>>>>>>>>>>>>
41828>>>>>>>>>>>>>>>        // Cn.Cn_Sls_Id
41828>>>>>>>>>>>>>>>
41828>>>>>>>>>>>>>>>        // Cn.Cn_Details
41828>>>>>>>>>>>>>>>
41828>>>>>>>>>>>>>>>        // Cn.Cn_Distance
41828>>>>>>>>>>>>>>>
41828>>>>>>>>>>>>>>>        // Cn.Cn_Pump
41828>>>>>>>>>>>>>>>
41828>>>>>>>>>>>>>>>        // Cn.Cn_Pumplicense
41828>>>>>>>>>>>>>>>
41828>>>>>>>>>>>>>>>        // Cn.Cn_Totalstats
41828>>>>>>>>>>>>>>>
41828>>>>>>>>>>>>>>>        // Cn.Cn_Analstats
41828>>>>>>>>>>>>>>>
41828>>>>>>>>>>>>>>>        // Cn.Cn_Coated
41828>>>>>>>>>>>>>>>
41828>>>>>>>>>>>>>>>        // Cn.Cn_Sitew
41828>>>>>>>>>>>>>>>
41828>>>>>>>>>>>>>>>        // Cn.Cn_Clientmatch
41828>>>>>>>>>>>>>>>
41828>>>>>>>>>>>>>>>        // Cn.Cn_Codematch
41828>>>>>>>>>>>>>>>
41828>>>>>>>>>>>>>>>        // Cn.Cn_Pumpid
41828>>>>>>>>>>>>>>>
41828>>>>>>>>>>>>>>>        // Cn.Cn_Clientid
41828>>>>>>>>>>>>>>>
41828>>>>>>>>>>>>>>>        // Cn.Cn_Sn
41828>>>>>>>>>>>>>>>
41828>>>>>>>>>>>>>>>        // Cn.Cn_Repmatch
41828>>>>>>>>>>>>>>>
41828>>>>>>>>>>>>>>>        // Cn.Cn_Active
41828>>>>>>>>>>>>>>>        Set Field_Checkbox_Values  Field Cn.Cn_Active To "A"  "F"
41829>>>>>>>>>>>>>>>
41829>>>>>>>>>>>>>>>        // Cn.Cn_Reported
41829>>>>>>>>>>>>>>>
41829>>>>>>>>>>>>>>>        // Cn.Cn_Lastupdated
41829>>>>>>>>>>>>>>>
41829>>>>>>>>>>>>>>>        // Cn.Cn_Markexp
41829>>>>>>>>>>>>>>>
41829>>>>>>>>>>>>>>>        // Cn.Cn_Vdetails
41829>>>>>>>>>>>>>>>
41829>>>>>>>>>>>>>>>        // Cn.Cn_Vticket
41829>>>>>>>>>>>>>>>
41829>>>>>>>>>>>>>>>        // Cn.Constraction_Id
41829>>>>>>>>>>>>>>>
41829>>>>>>>>>>>>>>>        // Cn.Cn_Presp_Id
41829>>>>>>>>>>>>>>>
41829>>>>>>>>>>>>>>>        // Cn.Cn_Presp_Recr
41829>>>>>>>>>>>>>>>
41829>>>>>>>>>>>>>>>        // Cn.Cn_Add_No
41829>>>>>>>>>>>>>>>
41829>>>>>>>>>>>>>>>        // Cn.Cn_Nomos
41829>>>>>>>>>>>>>>>
41829>>>>>>>>>>>>>>>        // Cn.Cn_Xora
41829>>>>>>>>>>>>>>>
41829>>>>>>>>>>>>>>>        // Cn.Polh_Recr
41829>>>>>>>>>>>>>>>
41829>>>>>>>>>>>>>>>        // Cn.Lic_Number
41829>>>>>>>>>>>>>>>
41829>>>>>>>>>>>>>>>        // Cn.Lic_Date
41829>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Lic_Date To MASK_DATE_WINDOW
41830>>>>>>>>>>>>>>>
41830>>>>>>>>>>>>>>>        // Cn.Lic_Lixi
41830>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Lic_Lixi To MASK_DATE_WINDOW
41831>>>>>>>>>>>>>>>
41831>>>>>>>>>>>>>>>        // Cn.Lic_Auth
41831>>>>>>>>>>>>>>>
41831>>>>>>>>>>>>>>>        // Cn.Cn_Start_Date
41831>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Cn_Start_Date To MASK_DATE_WINDOW
41832>>>>>>>>>>>>>>>
41832>>>>>>>>>>>>>>>        // Cn.Cn_End_Date
41832>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Cn_End_Date To MASK_DATE_WINDOW
41833>>>>>>>>>>>>>>>
41833>>>>>>>>>>>>>>>        // Cn.Cn_Categfpa
41833>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Cn.Cn_Categfpa To (Cn_Cn_Categfpa_VT1(Self))
41834>>>>>>>>>>>>>>>
41834>>>>>>>>>>>>>>>        // Cn.Cn_Tpay
41834>>>>>>>>>>>>>>>
41834>>>>>>>>>>>>>>>        // Cn.Mhxanik_Id
41834>>>>>>>>>>>>>>>
41834>>>>>>>>>>>>>>>        // Cn.Sum_Pct_Tper
41834>>>>>>>>>>>>>>>
41834>>>>>>>>>>>>>>>        // Cn.Cn_M3
41834>>>>>>>>>>>>>>>
41834>>>>>>>>>>>>>>>        // Cn.Aa_Deop
41834>>>>>>>>>>>>>>>
41834>>>>>>>>>>>>>>>        // Cn.Hm_Tel_Fortio
41834>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Hm_Tel_Fortio To MASK_DATE_WINDOW
41835>>>>>>>>>>>>>>>
41835>>>>>>>>>>>>>>>        // Cn.Tel_Fortio_No
41835>>>>>>>>>>>>>>>
41835>>>>>>>>>>>>>>>        // Cn.Tropos_Metaf
41835>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Cn.Tropos_Metaf To (Cn_Tropos_Metaf_VT(Self))
41836>>>>>>>>>>>>>>>
41836>>>>>>>>>>>>>>>        // Cn.Eidos_Cn
41836>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Cn.Eidos_Cn To (Cn_Eidos_Cn_VT(Self))
41837>>>>>>>>>>>>>>>
41837>>>>>>>>>>>>>>>        // Cn.Polhths_Constr
41837>>>>>>>>>>>>>>>
41837>>>>>>>>>>>>>>>        // Cn.Polhths_Mhx
41837>>>>>>>>>>>>>>>
41837>>>>>>>>>>>>>>>        // Cn.Hm_Prot_Fortio
41837>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Hm_Prot_Fortio To MASK_DATE_WINDOW
41838>>>>>>>>>>>>>>>
41838>>>>>>>>>>>>>>>        // Cn.Mesoskyklos
41838>>>>>>>>>>>>>>>
41838>>>>>>>>>>>>>>>        // Cn.Diodia
41838>>>>>>>>>>>>>>>
41838>>>>>>>>>>>>>>>        // Cn.Yesno
41838>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Cn.Yesno To (Cn_Yesno_VT(Self))
41839>>>>>>>>>>>>>>>
41839>>>>>>>>>>>>>>>        // Cn.Dateeggy
41839>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Cn.Dateeggy To MASK_DATE_WINDOW
41840>>>>>>>>>>>>>>>
41840>>>>>>>>>>>>>>>        // Cn.Cn_Branch
41840>>>>>>>>>>>>>>>
41840>>>>>>>>>>>>>>>        // Cn.Cn_Exfd1
41840>>>>>>>>>>>>>>>
41840>>>>>>>>>>>>>>>        // Cn.Cn_Exfd2
41840>>>>>>>>>>>>>>>
41840>>>>>>>>>>>>>>>        // Cn.Cn_Exfd3
41840>>>>>>>>>>>>>>>
41840>>>>>>>>>>>>>>>        // Cn.Cn_Exfd4
41840>>>>>>>>>>>>>>>
41840>>>>>>>>>>>>>>>        // Cn.Cn_Exfd5
41840>>>>>>>>>>>>>>>
41840>>>>>>>>>>>>>>>        // Cn.Cn_Exfd6
41840>>>>>>>>>>>>>>>
41840>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
41840>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
41841>>>>>>>>>>>>>>>
41841>>>>>>>>>>>>>>>    // Field_Defaults:
41841>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
41841>>>>>>>>>>>>>>>          
41841>>>>>>>>>>>>>>>    Procedure Field_Defaults
41842>>>>>>>>>>>>>>>        Forward Send Field_Defaults
41844>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
41844>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
41844>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Cn.Cn_Active To "A"
41845>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
41845>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
41846>>>>>>>>>>>>>>>
41846>>>>>>>>>>>>>>>End_Class    // Cn_DataDictionary
41847>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
41847>>>>>>>>>>>>>>>
41847>>>>>>>>>>>>>>>Use sl041.sl         // sl041
41847>>>>>>>>>>>>>>>Use sl198.sl         // sl198
41847>>>>>>>>>>>>>>>Use sl197.SL         // sl197
41847>>>>>>>>>>>>>>>
41847>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
41847>>>>>>>>>>>>>>>//DDB-FileEnd
41847>>>>>>>>>>>>>    
41847>>>>>>>>>>>>>    //AB-IgnoreEnd
41847>>>>>>>>>>>>>
41847>>>>>>>>>>>>>    Object sl041 is a dbModalPanelSub
41849>>>>>>>>>>>>>
41849>>>>>>>>>>>>>        //AB-StoreTopStart
41849>>>>>>>>>>>>>        Property String FragmaClient_ID Public ''
41851>>>>>>>>>>>>>        
41851>>>>>>>>>>>>>        //AB-StoreTopEnd
41851>>>>>>>>>>>>>
41851>>>>>>>>>>>>>        Set Label to "„§ ¢¦šã „¨šà¤"
41852>>>>>>>>>>>>>        Set Size to 249 500
41853>>>>>>>>>>>>>        Set Location to 2 6
41854>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
41855>>>>>>>>>>>>>        Set Modal_State to FALSE
41856>>>>>>>>>>>>>
41856>>>>>>>>>>>>>        //AB-DDOStart
41856>>>>>>>>>>>>>
41856>>>>>>>>>>>>>        Object Clients_DD is a Clients_DataDictionary
41858>>>>>>>>>>>>>
41858>>>>>>>>>>>>>            //AB-StoreStart
41858>>>>>>>>>>>>>                                                                                                                                                                                                                                        
41858>>>>>>>>>>>>>                                                                                                                                                                                                                                        
41858>>>>>>>>>>>>>                                                                                                                                                                                                                                        
41858>>>>>>>>>>>>>            //AB-StoreEnd
41858>>>>>>>>>>>>>
41858>>>>>>>>>>>>>        End_Object    // Clients_DD
41859>>>>>>>>>>>>>
41859>>>>>>>>>>>>>        Object Cn_DD is a Cn_DataDictionary
41861>>>>>>>>>>>>>            Set DDO_Server to (Clients_DD(self))
41862>>>>>>>>>>>>>
41862>>>>>>>>>>>>>            //AB-StoreStart
41862>>>>>>>>>>>>>                                            
41862>>>>>>>>>>>>>            Begin_Constraints
41864>>>>>>>>>>>>>                String sID
41865>>>>>>>>>>>>>                Get FragmaClient_ID to sID
41866>>>>>>>>>>>>>                If (sID<>'') begin
41868>>>>>>>>>>>>>                    set ordering to 4
41869>>>>>>>>>>>>>                    Constrain CN.Client_ID eq sID
41871>>>>>>>>>>>>>                end
41871>>>>>>>>>>>>>>
41871>>>>>>>>>>>>>                ELSE SET ORDERING TO -1
41873>>>>>>>>>>>>>            End_Constraints
41876>>>>>>>>>>>>>            
41876>>>>>>>>>>>>>            
41876>>>>>>>>>>>>>            
41876>>>>>>>>>>>>>            
41876>>>>>>>>>>>>>            
41876>>>>>>>>>>>>>            
41876>>>>>>>>>>>>>            
41876>>>>>>>>>>>>>            
41876>>>>>>>>>>>>>            
41876>>>>>>>>>>>>>            
41876>>>>>>>>>>>>>            
41876>>>>>>>>>>>>>            
41876>>>>>>>>>>>>>            
41876>>>>>>>>>>>>>            
41876>>>>>>>>>>>>>            
41876>>>>>>>>>>>>>            //AB-StoreEnd
41876>>>>>>>>>>>>>
41876>>>>>>>>>>>>>        End_Object    // Cn_DD
41877>>>>>>>>>>>>>
41877>>>>>>>>>>>>>        Set Main_DD to (Cn_DD(self))
41878>>>>>>>>>>>>>        Set Server to (Cn_DD(self))
41879>>>>>>>>>>>>>
41879>>>>>>>>>>>>>        //AB-DDOEnd
41879>>>>>>>>>>>>>
41879>>>>>>>>>>>>>        Object oSelList is a dbListSub
41881>>>>>>>>>>>>>            Set Main_File to Cn.File_Number
41882>>>>>>>>>>>>>            Set Ordering to 4
41883>>>>>>>>>>>>>            Set Size to 209 481
41884>>>>>>>>>>>>>            Set Location to 6 6
41885>>>>>>>>>>>>>            Set Auto_Index_State to FALSE
41886>>>>>>>>>>>>>
41886>>>>>>>>>>>>>            Begin_Row
41889>>>>>>>>>>>>>                Entry_Item Cn.Cn_code
41890>>>>>>>>>>>>>                Entry_Item Cn.Cn_descr
41891>>>>>>>>>>>>>                Entry_Item Cn.Client_id
41892>>>>>>>>>>>>>                Entry_Item Clients.Client_name
41893>>>>>>>>>>>>>                Entry_Item Cn.Cn_active
41894>>>>>>>>>>>>>            End_Row
41899>>>>>>>>>>>>>
41899>>>>>>>>>>>>>            Set Form_Width    item 0 to 61
41900>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª „¨š¦¬"
41901>>>>>>>>>>>>>            
41901>>>>>>>>>>>>>            Set Form_Width    item 1 to 185
41902>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã „¨š¦¬"
41903>>>>>>>>>>>>>            
41903>>>>>>>>>>>>>            Set Form_Width    item 2 to 60
41904>>>>>>>>>>>>>            Set Header_Label  item 2 to "‰à›.œ¢á«ž"
41905>>>>>>>>>>>>>            
41905>>>>>>>>>>>>>            Set Form_Width    item 3 to 123
41906>>>>>>>>>>>>>            Set Header_Label  item 3 to "„§à¤¬£å˜ œ¢á«ž"
41907>>>>>>>>>>>>>            
41907>>>>>>>>>>>>>            Set Form_Width    item 4 to 44
41908>>>>>>>>>>>>>            Set Header_Label  item 4 to "‘œ „¥â¢ ¥ž"
41909>>>>>>>>>>>>>            Set Column_Checkbox_State  item 4 to True
41910>>>>>>>>>>>>>            
41910>>>>>>>>>>>>>
41910>>>>>>>>>>>>>            //AB-StoreStart
41910>>>>>>>>>>>>>                                            
41910>>>>>>>>>>>>>            Property String StoreFragmaClient_ID Public ''
41912>>>>>>>>>>>>>            
41912>>>>>>>>>>>>>            Procedure Store_Defaults
41914>>>>>>>>>>>>>                   Forward Send Store_Defaults
41916>>>>>>>>>>>>>                   Set StoreFragmaClient_ID to (FragmaClient_ID(Self))
41917>>>>>>>>>>>>>            End_Procedure
41918>>>>>>>>>>>>>            
41918>>>>>>>>>>>>>            Procedure ReStore_Defaults
41920>>>>>>>>>>>>>                   Forward Send ReStore_Defaults
41922>>>>>>>>>>>>>                   Set FragmaClient_ID to (StoreFragmaClient_ID(Self))
41923>>>>>>>>>>>>>            End_Procedure
41924>>>>>>>>>>>>>            
41924>>>>>>>>>>>>>            Procedure Activating Returns Integer
41926>>>>>>>>>>>>>                Integer rVal
41927>>>>>>>>>>>>>                Forward Get Msg_Activating to rVal
41929>>>>>>>>>>>>>                set auto_index_state to true
41930>>>>>>>>>>>>>                SET ORDERING TO -1
41931>>>>>>>>>>>>>                Procedure_Return rVal
41932>>>>>>>>>>>>>            End_Procedure
41933>>>>>>>>>>>>>            
41933>>>>>>>>>>>>>            
41933>>>>>>>>>>>>>            
41933>>>>>>>>>>>>>            
41933>>>>>>>>>>>>>            
41933>>>>>>>>>>>>>            
41933>>>>>>>>>>>>>            
41933>>>>>>>>>>>>>            
41933>>>>>>>>>>>>>            
41933>>>>>>>>>>>>>            
41933>>>>>>>>>>>>>            
41933>>>>>>>>>>>>>            
41933>>>>>>>>>>>>>            
41933>>>>>>>>>>>>>            
41933>>>>>>>>>>>>>            
41933>>>>>>>>>>>>>            
41933>>>>>>>>>>>>>            
41933>>>>>>>>>>>>>            
41933>>>>>>>>>>>>>            //AB-StoreEnd
41933>>>>>>>>>>>>>
41933>>>>>>>>>>>>>        End_Object    // oSelList
41934>>>>>>>>>>>>>
41934>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
41936>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
41937>>>>>>>>>>>>>            Set Location to 219 327
41938>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
41939>>>>>>>>>>>>>
41939>>>>>>>>>>>>>            //AB-StoreStart
41939>>>>>>>>>>>>>            Procedure OnClick
41941>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
41942>>>>>>>>>>>>>            End_Procedure
41943>>>>>>>>>>>>>            //AB-StoreEnd
41943>>>>>>>>>>>>>
41943>>>>>>>>>>>>>        End_Object    // oOK_bn
41944>>>>>>>>>>>>>
41944>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
41946>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
41947>>>>>>>>>>>>>            Set Location to 219 383
41948>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
41949>>>>>>>>>>>>>
41949>>>>>>>>>>>>>            //AB-StoreStart
41949>>>>>>>>>>>>>            Procedure OnClick
41951>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
41952>>>>>>>>>>>>>            End_Procedure
41953>>>>>>>>>>>>>            //AB-StoreEnd
41953>>>>>>>>>>>>>
41953>>>>>>>>>>>>>        End_Object    // oCancel_bn
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
41956>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
41957>>>>>>>>>>>>>            Set Location to 219 437
41958>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
41959>>>>>>>>>>>>>
41959>>>>>>>>>>>>>            //AB-StoreStart
41959>>>>>>>>>>>>>            Procedure OnClick
41961>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
41962>>>>>>>>>>>>>            End_Procedure
41963>>>>>>>>>>>>>            //AB-StoreEnd
41963>>>>>>>>>>>>>
41963>>>>>>>>>>>>>        End_Object    // oSearch_bn
41964>>>>>>>>>>>>>
41964>>>>>>>>>>>>>
41964>>>>>>>>>>>>>        //AB-StoreStart
41964>>>>>>>>>>>>>                        
41964>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41965>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41966>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41967>>>>>>>>>>>>>        Set Modal_State to True
41968>>>>>>>>>>>>>        Procedure Activating Returns Integer
41970>>>>>>>>>>>>>            Integer rVal
41971>>>>>>>>>>>>>            Forward Get Msg_Activating to rVal
41973>>>>>>>>>>>>>            Send Rebuild_Constraints to (CN_DD(Self))
41974>>>>>>>>>>>>>            Send Beginning_Of_Data to oSelList
41975>>>>>>>>>>>>>            Procedure_Return rVal
41976>>>>>>>>>>>>>        End_Procedure
41977>>>>>>>>>>>>>        
41977>>>>>>>>>>>>>        procedure page integer pagemode
41979>>>>>>>>>>>>>            forward send page pagemode
41981>>>>>>>>>>>>>            set location to 40,40
41982>>>>>>>>>>>>>        end_procedure
41983>>>>>>>>>>>>>        
41983>>>>>>>>>>>>>        
41983>>>>>>>>>>>>>        
41983>>>>>>>>>>>>>        
41983>>>>>>>>>>>>>        
41983>>>>>>>>>>>>>        
41983>>>>>>>>>>>>>        
41983>>>>>>>>>>>>>        
41983>>>>>>>>>>>>>        
41983>>>>>>>>>>>>>        
41983>>>>>>>>>>>>>        
41983>>>>>>>>>>>>>        
41983>>>>>>>>>>>>>        
41983>>>>>>>>>>>>>        
41983>>>>>>>>>>>>>        
41983>>>>>>>>>>>>>        
41983>>>>>>>>>>>>>        
41983>>>>>>>>>>>>>        
41983>>>>>>>>>>>>>        //AB-StoreEnd
41983>>>>>>>>>>>>>
41983>>>>>>>>>>>>>    End_Object    // sl041
41984>>>>>>>>>>>>>
41984>>>>>>>>>>>>>//AB/     End_Object    // prj
41984>>>>>>>>>>>Use sl014.SL         // sl014
INCLUDING FILE: SL014.SL
41984>>>>>>>>>>>>>//AB/ Project sl014:Particle Lookup
41984>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
41984>>>>>>>>>>>>>//AB/     Set ProjectName to "sl014:Particle Lookup"
41984>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl014.SL"
41984>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
41984>>>>>>>>>>>>>
41984>>>>>>>>>>>>>// Project Object Structure
41984>>>>>>>>>>>>>//   sl014 is a dbModalPanelSub
41984>>>>>>>>>>>>>//     Ctypkin_DD is a DataDictionary
41984>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
41984>>>>>>>>>>>>>//     Ptyppar_DD is a DataDictionary
41984>>>>>>>>>>>>>//     Clients_DD is a DataDictionary
41984>>>>>>>>>>>>>//     Nomisma_DD is a DataDictionary
41984>>>>>>>>>>>>>//     Particle_DD is a DataDictionary
41984>>>>>>>>>>>>>//     oSelList is a dbListSub
41984>>>>>>>>>>>>>//     cSyDateForm1 is a cSyDateForm
41984>>>>>>>>>>>>>//     FormSub1 is a FormSub
41984>>>>>>>>>>>>>//     FormSub3 is a FormSub
41984>>>>>>>>>>>>>//     FormSub2 is a FormSub
41984>>>>>>>>>>>>>//     FormSub4 is a FormSub
41984>>>>>>>>>>>>>//     FormSub5 is a FormSub
41984>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
41984>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
41984>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
41984>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
41984>>>>>>>>>>>>>//     oOk_bn is a ButtonSub
41984>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
41984>>>>>>>>>>>>>//     TextBoxSub4 is a TextBoxSub
41984>>>>>>>>>>>>>
41984>>>>>>>>>>>>>// Register all objects
41984>>>>>>>>>>>>>Register_Object ButtonSub1
41984>>>>>>>>>>>>>Register_Object Clients_DD
41984>>>>>>>>>>>>>Register_Object Ctypkin_DD
41984>>>>>>>>>>>>>Register_Object cSyDateForm1
41984>>>>>>>>>>>>>Register_Object FormSub1
41984>>>>>>>>>>>>>Register_Object FormSub2
41984>>>>>>>>>>>>>Register_Object FormSub3
41984>>>>>>>>>>>>>Register_Object FormSub4
41984>>>>>>>>>>>>>Register_Object FormSub5
41984>>>>>>>>>>>>>Register_Object Nomisma_DD
41984>>>>>>>>>>>>>Register_Object oOk_bn
41984>>>>>>>>>>>>>Register_Object oSearch_bn
41984>>>>>>>>>>>>>Register_Object oSelList
41984>>>>>>>>>>>>>Register_Object Particle_DD
41984>>>>>>>>>>>>>Register_Object Ptyppar_DD
41984>>>>>>>>>>>>>Register_Object sl014
41984>>>>>>>>>>>>>Register_Object TextBoxSub1
41984>>>>>>>>>>>>>Register_Object TextBoxSub2
41984>>>>>>>>>>>>>Register_Object TextBoxSub3
41984>>>>>>>>>>>>>Register_Object TextBoxSub4
41984>>>>>>>>>>>>>Register_Object Wtypkin_DD
41984>>>>>>>>>>>>>
41984>>>>>>>>>>>>>
41984>>>>>>>>>>>>>
41984>>>>>>>>>>>>>//AB-StoreTopStart
41984>>>>>>>>>>>>>            
41984>>>>>>>>>>>>>Open PtypparL
41986>>>>>>>>>>>>>
41986>>>>>>>>>>>>>Use sl100.sl
41986>>>>>>>>>>>>>Use sl012.sl
41986>>>>>>>>>>>>>
41986>>>>>>>>>>>>>//AB-StoreTopEnd
41986>>>>>>>>>>>>>
41986>>>>>>>>>>>>>//AB-IgnoreStart
41986>>>>>>>>>>>>>
41986>>>>>>>>>>>>>Use DFAllEnt.pkg
41986>>>>>>>>>>>>>Use dbList.Sub
41986>>>>>>>>>>>>>Use cSyDateForm.Pkg
INCLUDING FILE: CSYDATEFORM.PKG
41986>>>>>>>>>>>>>>>Use cSyDateIntelliMix.pkg
INCLUDING FILE: CSYDATEINTELLIMIX.PKG
41986>>>>>>>>>>>>>>>>>Use cOutlook.Sl // Needed for date prompt.
INCLUDING FILE: COUTLOOK.SL
41986>>>>>>>>>>>>>>>>>>>//AB/ Project Calendar Outlook
41986>>>>>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
41986>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectName to "Calendar Outlook"
41986>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "coutlook.sl"
41986>>>>>>>>>>>>>>>>>>>
41986>>>>>>>>>>>>>>>>>>>// Project Object Structure
41986>>>>>>>>>>>>>>>>>>>//   oCalendar is a BasicPanelSub
41986>>>>>>>>>>>>>>>>>>>//     Container3d1 is a Container3d
41986>>>>>>>>>>>>>>>>>>>//       Grid2 is a Grid
41986>>>>>>>>>>>>>>>>>>>//         cOutlookFloatingMenu is a FloatingPopupMenu
41986>>>>>>>>>>>>>>>>>>>//       Textbox2 is a Textbox
41986>>>>>>>>>>>>>>>>>>>//       Textbox3 is a Textbox
41986>>>>>>>>>>>>>>>>>>>//       Textbox4 is a Textbox
41986>>>>>>>>>>>>>>>>>>>//       Textbox5 is a Textbox
41986>>>>>>>>>>>>>>>>>>>//       Textbox6 is a Textbox
41986>>>>>>>>>>>>>>>>>>>//       Textbox7 is a Textbox
41986>>>>>>>>>>>>>>>>>>>//       Textbox8 is a Textbox
41986>>>>>>>>>>>>>>>>>>>//       LineControl1 is a LineControl
41986>>>>>>>>>>>>>>>>>>>//       Container3d2 is a Container3d
41986>>>>>>>>>>>>>>>>>>>//         oRght is a BitmapContainer
41986>>>>>>>>>>>>>>>>>>>//         oLeft is a BitmapContainer
41986>>>>>>>>>>>>>>>>>>>//         oMonth is a Textbox
41986>>>>>>>>>>>>>>>>>>>//           oSelectMonth is a FloatingPopupMenu
41986>>>>>>>>>>>>>>>>>>>//         oCalendarYear is a Textbox
41986>>>>>>>>>>>>>>>>>>>//         oSelectCalendarYear is a Form
41986>>>>>>>>>>>>>>>>>>>//     BitmapContainer3 is a BitmapContainer
41986>>>>>>>>>>>>>>>>>>>//     oToday is a Textbox
41986>>>>>>>>>>>>>>>>>>>//     oCloseCalendar_bn is a BitmapContainer
41986>>>>>>>>>>>>>>>>>>>//     Help_Container is a Container3d
41986>>>>>>>>>>>>>>>>>>>//       Help_Info is a Edit
41986>>>>>>>>>>>>>>>>>>>//         HelpFloatingMenu is a FloatingPopupMenu
41986>>>>>>>>>>>>>>>>>>>
41986>>>>>>>>>>>>>>>>>>>// Register all objects
41986>>>>>>>>>>>>>>>>>>>Register_Object BitmapContainer3
41986>>>>>>>>>>>>>>>>>>>Register_Object Container3d1
41986>>>>>>>>>>>>>>>>>>>Register_Object Container3d2
41986>>>>>>>>>>>>>>>>>>>Register_Object cOutlookFloatingMenu
41986>>>>>>>>>>>>>>>>>>>Register_Object Grid2
41986>>>>>>>>>>>>>>>>>>>Register_Object Help_Container
41986>>>>>>>>>>>>>>>>>>>Register_Object Help_Info
41986>>>>>>>>>>>>>>>>>>>Register_Object HelpFloatingMenu
41986>>>>>>>>>>>>>>>>>>>Register_Object LineControl1
41986>>>>>>>>>>>>>>>>>>>Register_Object oCalendar
41986>>>>>>>>>>>>>>>>>>>Register_Object oCalendarYear
41986>>>>>>>>>>>>>>>>>>>Register_Object oCloseCalendar_bn
41986>>>>>>>>>>>>>>>>>>>Register_Object oLeft
41986>>>>>>>>>>>>>>>>>>>Register_Object oMonth
41986>>>>>>>>>>>>>>>>>>>Register_Object oRght
41986>>>>>>>>>>>>>>>>>>>Register_Object oSelectCalendarYear
41986>>>>>>>>>>>>>>>>>>>Register_Object oSelectMonth
41986>>>>>>>>>>>>>>>>>>>Register_Object oToday
41986>>>>>>>>>>>>>>>>>>>Register_Object Textbox2
41986>>>>>>>>>>>>>>>>>>>Register_Object Textbox3
41986>>>>>>>>>>>>>>>>>>>Register_Object Textbox4
41986>>>>>>>>>>>>>>>>>>>Register_Object Textbox5
41986>>>>>>>>>>>>>>>>>>>Register_Object Textbox6
41986>>>>>>>>>>>>>>>>>>>Register_Object Textbox7
41986>>>>>>>>>>>>>>>>>>>Register_Object Textbox8
41986>>>>>>>>>>>>>>>>>>>
41986>>>>>>>>>>>>>>>>>>>
41986>>>>>>>>>>>>>>>>>>>
41986>>>>>>>>>>>>>>>>>>>    //AB-StoreTopStart
41986>>>>>>>>>>>>>>>>>>>    Use dates.utl
41986>>>>>>>>>>>>>>>>>>>
41986>>>>>>>>>>>>>>>>>>>
41986>>>>>>>>>>>>>>>>>>>    //AB-StoreTopEnd
41986>>>>>>>>>>>>>>>>>>>
41986>>>>>>>>>>>>>>>>>>>    //AB-IgnoreStart
41986>>>>>>>>>>>>>>>>>>>
41986>>>>>>>>>>>>>>>>>>>    Use Panel.Sub
41986>>>>>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
41986>>>>>>>>>>>>>>>>>>>
41986>>>>>>>>>>>>>>>>>>>
41986>>>>>>>>>>>>>>>>>>>
41986>>>>>>>>>>>>>>>>>>>    //AB-IgnoreEnd
41986>>>>>>>>>>>>>>>>>>>
41986>>>>>>>>>>>>>>>>>>>    Object oCalendar is a BasicPanelSub
41988>>>>>>>>>>>>>>>>>>>        Set Border_Style to Border_Normal
41989>>>>>>>>>>>>>>>>>>>        Set Caption_Bar to FALSE
41990>>>>>>>>>>>>>>>>>>>        Set Label to "January, 2001"
41991>>>>>>>>>>>>>>>>>>>        Set Size to 98 123
41992>>>>>>>>>>>>>>>>>>>        Set Location to 10 22
41993>>>>>>>>>>>>>>>>>>>        Set Color to clWhite
41994>>>>>>>>>>>>>>>>>>>        Set Exit_Application_Local_State to TRUE
41995>>>>>>>>>>>>>>>>>>>        Set Popup_State to TRUE
41996>>>>>>>>>>>>>>>>>>>
41996>>>>>>>>>>>>>>>>>>>        //AB-DDOStart
41996>>>>>>>>>>>>>>>>>>>
41996>>>>>>>>>>>>>>>>>>>
41996>>>>>>>>>>>>>>>>>>>        //AB-DDOEnd
41996>>>>>>>>>>>>>>>>>>>
41996>>>>>>>>>>>>>>>>>>>        Object Container3d1 is a Container3d
41998>>>>>>>>>>>>>>>>>>>            Set Size to 88 135
41999>>>>>>>>>>>>>>>>>>>            Set Location to -2 -1
42000>>>>>>>>>>>>>>>>>>>            Set Color to clWhite
42001>>>>>>>>>>>>>>>>>>>            Set Border_Style to Border_None
42002>>>>>>>>>>>>>>>>>>>            Object Grid2 is a Grid
42004>>>>>>>>>>>>>>>>>>>
42004>>>>>>>>>>>>>>>>>>>                //AB-StoreTopStart
42004>>>>>>>>>>>>>>>>>>>                property date    p_current_date     0
42006>>>>>>>>>>>>>>>>>>>                property integer p_current_year     -1
42008>>>>>>>>>>>>>>>>>>>                property integer p_current_month    -1
42010>>>>>>>>>>>>>>>>>>>                property integer p_selected_day     -1
42012>>>>>>>>>>>>>>>>>>>                property integer pExportState       1
42014>>>>>>>>>>>>>>>>>>>                property integer invoking_object_id 0
42016>>>>>>>>>>>>>>>>>>>                Property integer piCurrentDayItem   -1
42018>>>>>>>>>>>>>>>>>>>
42018>>>>>>>>>>>>>>>>>>>                Set Border_Style To BORDER_NONE
42019>>>>>>>>>>>>>>>>>>>                Set header_visible_state To False
42020>>>>>>>>>>>>>>>>>>>                set select_mode to no_select
42021>>>>>>>>>>>>>>>>>>>                Set Gridline_mode To GRID_VISIBLE_NONE
42022>>>>>>>>>>>>>>>>>>>
42022>>>>>>>>>>>>>>>>>>>                on_key Key_F1 Send Help
42023>>>>>>>>>>>>>>>>>>>                on_key key_ctrl+key_pgup send prev_year
42024>>>>>>>>>>>>>>>>>>>                on_key key_ctrl+key_pgdn send next_year
42025>>>>>>>>>>>>>>>>>>>                on_key          key_pgup send prev_month
42026>>>>>>>>>>>>>>>>>>>                on_key          key_pgdn send next_month
42027>>>>>>>>>>>>>>>>>>>                on_key key_enter         send move_value_out
42028>>>>>>>>>>>>>>>>>>>                on_key key_ctrl+key_d    send go_today
42029>>>>>>>>>>>>>>>>>>>                on_key key_ctrl+key_y    send Change_Year
42030>>>>>>>>>>>>>>>>>>>
42030>>>>>>>>>>>>>>>>>>>                //AB-StoreTopEnd
42030>>>>>>>>>>>>>>>>>>>
42030>>>>>>>>>>>>>>>>>>>                Set Color to clWhite
42031>>>>>>>>>>>>>>>>>>>                Set CurrentCellColor to clWhite
42032>>>>>>>>>>>>>>>>>>>                Set CurrentCellTextColor to clWhite
42033>>>>>>>>>>>>>>>>>>>                Set Size to 61 145
42034>>>>>>>>>>>>>>>>>>>                Set Location to 30 1
42035>>>>>>>>>>>>>>>>>>>                Set Resize_Column_state to FALSE
42036>>>>>>>>>>>>>>>>>>>
42036>>>>>>>>>>>>>>>>>>>                Set Line_Width to 7 0
42037>>>>>>>>>>>>>>>>>>>
42037>>>>>>>>>>>>>>>>>>>                Set Form_Width    item 0 to 18
42038>>>>>>>>>>>>>>>>>>>                Set Header_Label  item 0 to "Mo"
42039>>>>>>>>>>>>>>>>>>>
42039>>>>>>>>>>>>>>>>>>>                Set Form_Width    item 1 to 18
42040>>>>>>>>>>>>>>>>>>>                Set Header_Label  item 1 to "Tu"
42041>>>>>>>>>>>>>>>>>>>
42041>>>>>>>>>>>>>>>>>>>                Set Form_Width    item 2 to 18
42042>>>>>>>>>>>>>>>>>>>                Set Header_Label  item 2 to "We"
42043>>>>>>>>>>>>>>>>>>>
42043>>>>>>>>>>>>>>>>>>>                Set Form_Width    item 3 to 18
42044>>>>>>>>>>>>>>>>>>>                Set Header_Label  item 3 to "Th"
42045>>>>>>>>>>>>>>>>>>>
42045>>>>>>>>>>>>>>>>>>>                Set Form_Width    item 4 to 18
42046>>>>>>>>>>>>>>>>>>>                Set Header_Label  item 4 to "Fr"
42047>>>>>>>>>>>>>>>>>>>
42047>>>>>>>>>>>>>>>>>>>                Set Form_Width    item 5 to 18
42048>>>>>>>>>>>>>>>>>>>                Set Header_Label  item 5 to "Sa"
42049>>>>>>>>>>>>>>>>>>>
42049>>>>>>>>>>>>>>>>>>>                Set Form_Width    item 6 to 18
42050>>>>>>>>>>>>>>>>>>>                Set Header_Label  item 6 to "Su"
42051>>>>>>>>>>>>>>>>>>>
42051>>>>>>>>>>>>>>>>>>>
42051>>>>>>>>>>>>>>>>>>>                //AB-StoreStart
42051>>>>>>>>>>>>>>>>>>>
42051>>>>>>>>>>>>>>>>>>>                Procedure Change_Year
42053>>>>>>>>>>>>>>>>>>>                    Send Mouse_Down to (oCalendarYear(Container3d2(Self)))
42054>>>>>>>>>>>>>>>>>>>                End_Procedure // Change_Year
42055>>>>>>>>>>>>>>>>>>>
42055>>>>>>>>>>>>>>>>>>>                procedure go_today
42057>>>>>>>>>>>>>>>>>>>                    Date date#
42058>>>>>>>>>>>>>>>>>>>                    sysdate4 date#
42059>>>>>>>>>>>>>>>>>>>                    set p_current_date to date#
42060>>>>>>>>>>>>>>>>>>>                    Send Update_Calendar
42061>>>>>>>>>>>>>>>>>>>                end_procedure
42062>>>>>>>>>>>>>>>>>>>
42062>>>>>>>>>>>>>>>>>>>                procedure next_month
42064>>>>>>>>>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
42065>>>>>>>>>>>>>>>>>>>                    Send Update_Calendar
42066>>>>>>>>>>>>>>>>>>>                end_procedure
42067>>>>>>>>>>>>>>>>>>>
42067>>>>>>>>>>>>>>>>>>>                procedure prev_month
42069>>>>>>>>>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
42070>>>>>>>>>>>>>>>>>>>                    Send Update_Calendar
42071>>>>>>>>>>>>>>>>>>>                end_procedure
42072>>>>>>>>>>>>>>>>>>>
42072>>>>>>>>>>>>>>>>>>>                procedure next_year
42074>>>>>>>>>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
42075>>>>>>>>>>>>>>>>>>>                    Send Update_Calendar
42076>>>>>>>>>>>>>>>>>>>                end_procedure
42077>>>>>>>>>>>>>>>>>>>
42077>>>>>>>>>>>>>>>>>>>                procedure prev_year
42079>>>>>>>>>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
42080>>>>>>>>>>>>>>>>>>>                    Send Update_Calendar
42081>>>>>>>>>>>>>>>>>>>                end_procedure
42082>>>>>>>>>>>>>>>>>>>
42082>>>>>>>>>>>>>>>>>>>                Procedure Activate
42084>>>>>>>>>>>>>>>>>>>                    Date date#
42085>>>>>>>>>>>>>>>>>>>                    Forward Send Activate
42087>>>>>>>>>>>>>>>>>>>                    Set current_item to (p_selected_day(Self))
42088>>>>>>>>>>>>>>>>>>>                End_Procedure
42089>>>>>>>>>>>>>>>>>>>
42089>>>>>>>>>>>>>>>>>>>                Procedure Update_Calendar
42091>>>>>>>>>>>>>>>>>>>                    Set Dynamic_Update_State To False
42092>>>>>>>>>>>>>>>>>>>                    send Fill_List
42093>>>>>>>>>>>>>>>>>>>                    Set Dynamic_Update_State To True
42094>>>>>>>>>>>>>>>>>>>                    // Send Update_Label
42094>>>>>>>>>>>>>>>>>>>                    Set current_item to (p_selected_day(Self))
42095>>>>>>>>>>>>>>>>>>>                    Send Date_Changing to (oCalendarYear(Container3d2(self)))
42096>>>>>>>>>>>>>>>>>>>                    Send Date_Changing to (oMonth(Container3d2(self)))
42097>>>>>>>>>>>>>>>>>>>                End_Procedure
42098>>>>>>>>>>>>>>>>>>>
42098>>>>>>>>>>>>>>>>>>>                Procedure Fill_List
42100>>>>>>>>>>>>>>>>>>>                    Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
42101>>>>>>>>>>>>>>>>>>>                    Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
42101>>>>>>>>>>>>>>>>>>>                    Date dToday
42101>>>>>>>>>>>>>>>>>>>                    Send Delete_Data
42102>>>>>>>>>>>>>>>>>>>
42102>>>>>>>>>>>>>>>>>>>                    Get p_current_date to date#
42103>>>>>>>>>>>>>>>>>>>
42103>>>>>>>>>>>>>>>>>>>                    SysDate4 dToday
42104>>>>>>>>>>>>>>>>>>>                    move (DateSegment(dToday,DS_DAY)) to cur_day#
42105>>>>>>>>>>>>>>>>>>>                    move (DateSegment(dToday,DS_MONTH)) to cur_month#
42106>>>>>>>>>>>>>>>>>>>                    move (DateSegment(dToday,DS_YEAR)) to cur_year#
42107>>>>>>>>>>>>>>>>>>>
42107>>>>>>>>>>>>>>>>>>>                    move (DateSegment(date#,DS_DAY)) to sel_day#
42108>>>>>>>>>>>>>>>>>>>                    move (DateSegment(date#,DS_MONTH)) to sel_month#
42109>>>>>>>>>>>>>>>>>>>                    move (DateSegment(date#,DS_YEAR)) to sel_year#
42110>>>>>>>>>>>>>>>>>>>                    Set p_current_month To sel_month#
42111>>>>>>>>>>>>>>>>>>>                    Set p_current_year To sel_year#
42112>>>>>>>>>>>>>>>>>>>
42112>>>>>>>>>>>>>>>>>>>                    move (FirstDayInMonth(date#)) to date#
42113>>>>>>>>>>>>>>>>>>>                    move (DateDayNumber(date#)-1) to first_item#
42114>>>>>>>>>>>>>>>>>>>                    move (LastDayInMonth(date#)-date#+first_item#) to last_item#
42115>>>>>>>>>>>>>>>>>>>                    move (DateIncrement(date#,DS_Month,-1)) To prevdate#
42116>>>>>>>>>>>>>>>>>>>                    move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
42117>>>>>>>>>>>>>>>>>>>
42117>>>>>>>>>>>>>>>>>>>                    If (first_item# > 0) Begin
42119>>>>>>>>>>>>>>>>>>>                        Move (first_item#-1) to day#
42120>>>>>>>>>>>>>>>>>>>                        For iFor from 0 to (first_item#-1)
42126>>>>>>>>>>>>>>>>>>>>
42126>>>>>>>>>>>>>>>>>>>                            Send Add_Item msg_move_value_out (prev_last#-day#)
42127>>>>>>>>>>>>>>>>>>>                            Set Entry_State Item iFor To False
42128>>>>>>>>>>>>>>>>>>>                            Set ItemTextColor Item iFor To clGray
42129>>>>>>>>>>>>>>>>>>>                            Decrement day#
42130>>>>>>>>>>>>>>>>>>>                        Loop
42131>>>>>>>>>>>>>>>>>>>>
42131>>>>>>>>>>>>>>>>>>>                    End
42131>>>>>>>>>>>>>>>>>>>>
42131>>>>>>>>>>>>>>>>>>>
42131>>>>>>>>>>>>>>>>>>>                    Move 1 To day#
42132>>>>>>>>>>>>>>>>>>>                    For iFor from first_item# to last_item#
42138>>>>>>>>>>>>>>>>>>>>
42138>>>>>>>>>>>>>>>>>>>                        Send Add_Item Msg_Move_Value_Out day#
42139>>>>>>>>>>>>>>>>>>>                        Set Entry_State Item iFor To False
42140>>>>>>>>>>>>>>>>>>>                        If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Begin
42142>>>>>>>>>>>>>>>>>>>                            Set Form_Bitmap Item iFor To "cdate.bmp"
42143>>>>>>>>>>>>>>>>>>>                            Set piCurrentDayItem to iFor
42144>>>>>>>>>>>>>>>>>>>                        End
42144>>>>>>>>>>>>>>>>>>>>
42144>>>>>>>>>>>>>>>>>>>                        If Day# eq sel_day# Set p_selected_day To iFor
42147>>>>>>>>>>>>>>>>>>>                        Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
42148>>>>>>>>>>>>>>>>>>>                        Set form_datatype item iFor To mask_numeric_window
42149>>>>>>>>>>>>>>>>>>>                        Set form_Mask item iFor To "## "
42150>>>>>>>>>>>>>>>>>>>                        Increment day#
42151>>>>>>>>>>>>>>>>>>>                    Loop
42152>>>>>>>>>>>>>>>>>>>>
42152>>>>>>>>>>>>>>>>>>>
42152>>>>>>>>>>>>>>>>>>>                    move (DateIncrement(date#,DS_Month,1)) To nextdate#
42153>>>>>>>>>>>>>>>>>>>                    move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
42154>>>>>>>>>>>>>>>>>>>
42154>>>>>>>>>>>>>>>>>>>                    If (last_item# < 41) Begin
42156>>>>>>>>>>>>>>>>>>>                        Move 1 to day#
42157>>>>>>>>>>>>>>>>>>>                        For iFor from (last_item#+1) to 41
42163>>>>>>>>>>>>>>>>>>>>
42163>>>>>>>>>>>>>>>>>>>                            Send Add_Item msg_move_value_out day#
42164>>>>>>>>>>>>>>>>>>>                            Set Entry_State Item iFor To False
42165>>>>>>>>>>>>>>>>>>>                            Set ItemTextColor Item iFor To clGray
42166>>>>>>>>>>>>>>>>>>>                            Increment day#
42167>>>>>>>>>>>>>>>>>>>                        Loop
42168>>>>>>>>>>>>>>>>>>>>
42168>>>>>>>>>>>>>>>>>>>                    End
42168>>>>>>>>>>>>>>>>>>>>
42168>>>>>>>>>>>>>>>>>>>
42168>>>>>>>>>>>>>>>>>>>                End_Procedure
42169>>>>>>>>>>>>>>>>>>>
42169>>>>>>>>>>>>>>>>>>>                Procedure Help
42171>>>>>>>>>>>>>>>>>>>                    //Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<Y> - select year.\n<Ctrl>+<PgUp>, <PgDn> - Select year.") ("Help on Calendar")
42171>>>>>>>>>>>>>>>>>>>                    Set Visible_State of Help_Container to True
42172>>>>>>>>>>>>>>>>>>>                    Set Enabled_State of Help_Container to True
42173>>>>>>>>>>>>>>>>>>>                    Send Activate to Help_Container
42174>>>>>>>>>>>>>>>>>>>                End_Procedure
42175>>>>>>>>>>>>>>>>>>>
42175>>>>>>>>>>>>>>>>>>>                procedure mouse_click integer window integer char_pos
42177>>>>>>>>>>>>>>>>>>>                    Send Move_Value_Out
42178>>>>>>>>>>>>>>>>>>>                    forward send mouse_click window char_pos
42180>>>>>>>>>>>>>>>>>>>                end_procedure
42181>>>>>>>>>>>>>>>>>>>
42181>>>>>>>>>>>>>>>>>>>                Procedure Move_Value_Out
42183>>>>>>>>>>>>>>>>>>>                    Integer iYear iMonth iDay iItm
42184>>>>>>>>>>>>>>>>>>>                    Date Date# next_date# prev_date#
42184>>>>>>>>>>>>>>>>>>>                    Get Current_Item To iItm
42185>>>>>>>>>>>>>>>>>>>                    If (pExportState(Self)) Begin
42187>>>>>>>>>>>>>>>>>>>                        Get Value Item iItm To iDay
42188>>>>>>>>>>>>>>>>>>>                        Get p_current_month to iMonth
42189>>>>>>>>>>>>>>>>>>>                        Get p_current_year  to iYear
42190>>>>>>>>>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
42191>>>>>>>>>>>>>>>>>>>
42191>>>>>>>>>>>>>>>>>>>                        If ((iItm>27)and(iDay<15)) Begin
42193>>>>>>>>>>>>>>>>>>>                            Move (DateCompose(1,iMonth,iYear)) To next_date#
42194>>>>>>>>>>>>>>>>>>>                            move (DateIncrement(next_date#,DS_Month,1)) To next_date#
42195>>>>>>>>>>>>>>>>>>>                            move (DateSegment(next_date#,DS_MONTH)) to iMonth
42196>>>>>>>>>>>>>>>>>>>                            move (DateSegment(next_date#,DS_YEAR)) to iYear
42197>>>>>>>>>>>>>>>>>>>                            move (DateCompose(iDay,iMonth,iYear)) to date#
42198>>>>>>>>>>>>>>>>>>>                        End
42198>>>>>>>>>>>>>>>>>>>>
42198>>>>>>>>>>>>>>>>>>>                        If ((iItm<7)and(iDay>20)) Begin
42200>>>>>>>>>>>>>>>>>>>                            Move (DateCompose(1,iMonth,iYear)) To prev_date#
42201>>>>>>>>>>>>>>>>>>>                            move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
42202>>>>>>>>>>>>>>>>>>>                            move (DateSegment(prev_date#,DS_MONTH)) to iMonth
42203>>>>>>>>>>>>>>>>>>>                            move (DateSegment(prev_date#,DS_YEAR)) to iYear
42204>>>>>>>>>>>>>>>>>>>                            move (DateCompose(iDay,iMonth,iYear)) to date#
42205>>>>>>>>>>>>>>>>>>>                        End
42205>>>>>>>>>>>>>>>>>>>>
42205>>>>>>>>>>>>>>>>>>>
42205>>>>>>>>>>>>>>>>>>>                        Send Export_Date date#
42206>>>>>>>>>>>>>>>>>>>                    End
42206>>>>>>>>>>>>>>>>>>>>
42206>>>>>>>>>>>>>>>>>>>                End_Procedure
42207>>>>>>>>>>>>>>>>>>>
42207>>>>>>>>>>>>>>>>>>>                Procedure Export_Date date date#
42209>>>>>>>>>>>>>>>>>>>                    local integer focus# dm# margin# datatype#
42210>>>>>>>>>>>>>>>>>>>                    get invoking_object_id to focus#
42211>>>>>>>>>>>>>>>>>>>
42211>>>>>>>>>>>>>>>>>>>                    if focus# gt desktop begin
42213>>>>>>>>>>>>>>>>>>>                         get delegation_mode of focus# to dm#
42214>>>>>>>>>>>>>>>>>>>                         set delegation_mode of focus# to no_delegate_or_error
42215>>>>>>>>>>>>>>>>>>>                         get form_margin of focus# item current to margin#
42216>>>>>>>>>>>>>>>>>>>                         get form_datatype of focus# item current to datatype#
42217>>>>>>>>>>>>>>>>>>>                         set delegation_mode of focus# to dm#
42218>>>>>>>>>>>>>>>>>>>                         if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
42221>>>>>>>>>>>>>>>>>>>                         else             set value of focus# item current to (Date4to2(date#))
42223>>>>>>>>>>>>>>>>>>>                         set item_changed_state of focus# item current to true
42224>>>>>>>>>>>>>>>>>>>                    end
42224>>>>>>>>>>>>>>>>>>>>
42224>>>>>>>>>>>>>>>>>>>                    Send Close_Calendar
42225>>>>>>>>>>>>>>>>>>>                End_Procedure
42226>>>>>>>>>>>>>>>>>>>
42226>>>>>>>>>>>>>>>>>>>                Object cOutlookFloatingMenu is a FloatingPopupMenu
42228>>>>>>>>>>>>>>>>>>>
42228>>>>>>>>>>>>>>>>>>>                    Procedure Close_Calendar
42230>>>>>>>>>>>>>>>>>>>                        Send Close_Calendar to (oCalendar(Self))
42231>>>>>>>>>>>>>>>>>>>                    End_Procedure // Close_Calendar
42232>>>>>>>>>>>>>>>>>>>
42232>>>>>>>>>>>>>>>>>>>                    Send Add_item msg_go_today         t.calendar.today
42233>>>>>>>>>>>>>>>>>>>                    Send Add_item msg_None             ""
42234>>>>>>>>>>>>>>>>>>>                    Send Add_Item msg_prev_year        t.calendar.PrevYear
42235>>>>>>>>>>>>>>>>>>>                    Send Add_Item msg_next_year        t.calendar.NextYear
42236>>>>>>>>>>>>>>>>>>>                    Send Add_Item msg_prev_month       t.calendar.PrevMonth
42237>>>>>>>>>>>>>>>>>>>                    Send Add_Item msg_next_month       t.calendar.NextMonth
42238>>>>>>>>>>>>>>>>>>>                    Send Add_item msg_None             ""
42239>>>>>>>>>>>>>>>>>>>                    Send Add_Item msg_move_value_out   t.calendar.Select
42240>>>>>>>>>>>>>>>>>>>                    Send Add_item msg_None             ""
42241>>>>>>>>>>>>>>>>>>>                    Send Add_item msg_Close_Calendar   t.calendar.Cancel
42242>>>>>>>>>>>>>>>>>>>                End_Object // cOutlookFloatingMenu
42243>>>>>>>>>>>>>>>>>>>
42243>>>>>>>>>>>>>>>>>>>                Set floating_menu_object to (cOutlookFloatingMenu(Self))
42244>>>>>>>>>>>>>>>>>>>
42244>>>>>>>>>>>>>>>>>>>                procedure item_change integer fromi integer toi returns integer
42246>>>>>>>>>>>>>>>>>>>                    Integer new_item liMonth
42247>>>>>>>>>>>>>>>>>>>                    Date    ldSysdate
42247>>>>>>>>>>>>>>>>>>>                    forward get msg_item_change fromi toi to new_item
42249>>>>>>>>>>>>>>>>>>>                    If (Focus(Desktop) = Self) Begin
42251>>>>>>>>>>>>>>>>>>>                        If (new_item >= 0) Begin
42253>>>>>>>>>>>>>>>>>>>                            Sysdate4 ldSysdate
42254>>>>>>>>>>>>>>>>>>>                            Move (TheMonthSegment(ldSysdate)) to liMonth
42255>>>>>>>>>>>>>>>>>>>                            If ((p_current_month(Self) = liMonth) and (piCurrentDayItem(Self) = fromi)) Set Form_Bitmap Item fromi to "Cdate.bmp"
42258>>>>>>>>>>>>>>>>>>>                            Else Set Form_Bitmap Item fromi to ""
42260>>>>>>>>>>>>>>>>>>>                            If (((p_current_month(Self) = liMonth) and (piCurrentDayItem(Self) <> new_item)) or;                                 (p_current_month(Self) <> liMonth)) Set Form_Bitmap Item new_item   to "Cdate1.bmp"
42263>>>>>>>>>>>>>>>>>>>                        End
42263>>>>>>>>>>>>>>>>>>>>
42263>>>>>>>>>>>>>>>>>>>                    End
42263>>>>>>>>>>>>>>>>>>>>
42263>>>>>>>>>>>>>>>>>>>                    procedure_return new_item
42264>>>>>>>>>>>>>>>>>>>                End_Procedure // Current_Item
42265>>>>>>>>>>>>>>>>>>>
42265>>>>>>>>>>>>>>>>>>>
42265>>>>>>>>>>>>>>>>>>>
42265>>>>>>>>>>>>>>>>>>>                //AB-StoreEnd
42265>>>>>>>>>>>>>>>>>>>
42265>>>>>>>>>>>>>>>>>>>            End_Object    // Grid2
42266>>>>>>>>>>>>>>>>>>>
42266>>>>>>>>>>>>>>>>>>>            Object Textbox2 is a Textbox
42268>>>>>>>>>>>>>>>>>>>                Set Label to "Mo"
42269>>>>>>>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
42270>>>>>>>>>>>>>>>>>>>                Set Transparent_State to TRUE
42271>>>>>>>>>>>>>>>>>>>                Set Color to clWhite
42272>>>>>>>>>>>>>>>>>>>                Set TextColor to clNavy
42273>>>>>>>>>>>>>>>>>>>                Set Location to 19 4
42274>>>>>>>>>>>>>>>>>>>                Set Size to 10 15
42275>>>>>>>>>>>>>>>>>>>
42275>>>>>>>>>>>>>>>>>>>                //AB-StoreStart
42275>>>>>>>>>>>>>>>>>>>
42275>>>>>>>>>>>>>>>>>>>                Set Label To (left(t.calendar.Monday,2))
42276>>>>>>>>>>>>>>>>>>>                //AB-StoreEnd
42276>>>>>>>>>>>>>>>>>>>
42276>>>>>>>>>>>>>>>>>>>            End_Object    // Textbox2
42277>>>>>>>>>>>>>>>>>>>
42277>>>>>>>>>>>>>>>>>>>            Object Textbox3 is a Textbox
42279>>>>>>>>>>>>>>>>>>>                Set Label to "Tu"
42280>>>>>>>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
42281>>>>>>>>>>>>>>>>>>>                Set Transparent_State to TRUE
42282>>>>>>>>>>>>>>>>>>>                Set Color to clWhite
42283>>>>>>>>>>>>>>>>>>>                Set TextColor to clNavy
42284>>>>>>>>>>>>>>>>>>>                Set Location to 19 22
42285>>>>>>>>>>>>>>>>>>>                Set Size to 10 12
42286>>>>>>>>>>>>>>>>>>>
42286>>>>>>>>>>>>>>>>>>>                //AB-StoreStart
42286>>>>>>>>>>>>>>>>>>>
42286>>>>>>>>>>>>>>>>>>>                Set Label To (left(t.calendar.Tuesday,2))
42287>>>>>>>>>>>>>>>>>>>                //AB-StoreEnd
42287>>>>>>>>>>>>>>>>>>>
42287>>>>>>>>>>>>>>>>>>>            End_Object    // Textbox3
42288>>>>>>>>>>>>>>>>>>>
42288>>>>>>>>>>>>>>>>>>>            Object Textbox4 is a Textbox
42290>>>>>>>>>>>>>>>>>>>                Set Label to "We"
42291>>>>>>>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
42292>>>>>>>>>>>>>>>>>>>                Set Transparent_State to TRUE
42293>>>>>>>>>>>>>>>>>>>                Set Color to clWhite
42294>>>>>>>>>>>>>>>>>>>                Set TextColor to clNavy
42295>>>>>>>>>>>>>>>>>>>                Set Location to 19 39
42296>>>>>>>>>>>>>>>>>>>                Set Size to 10 15
42297>>>>>>>>>>>>>>>>>>>
42297>>>>>>>>>>>>>>>>>>>                //AB-StoreStart
42297>>>>>>>>>>>>>>>>>>>
42297>>>>>>>>>>>>>>>>>>>                Set Label To (left(t.calendar.Wednesday,2))
42298>>>>>>>>>>>>>>>>>>>                //AB-StoreEnd
42298>>>>>>>>>>>>>>>>>>>
42298>>>>>>>>>>>>>>>>>>>            End_Object    // Textbox4
42299>>>>>>>>>>>>>>>>>>>
42299>>>>>>>>>>>>>>>>>>>            Object Textbox5 is a Textbox
42301>>>>>>>>>>>>>>>>>>>                Set Label to "Th"
42302>>>>>>>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
42303>>>>>>>>>>>>>>>>>>>                Set Transparent_State to TRUE
42304>>>>>>>>>>>>>>>>>>>                Set Color to clWhite
42305>>>>>>>>>>>>>>>>>>>                Set TextColor to clNavy
42306>>>>>>>>>>>>>>>>>>>                Set Location to 19 57
42307>>>>>>>>>>>>>>>>>>>                Set Size to 10 17
42308>>>>>>>>>>>>>>>>>>>
42308>>>>>>>>>>>>>>>>>>>                //AB-StoreStart
42308>>>>>>>>>>>>>>>>>>>
42308>>>>>>>>>>>>>>>>>>>                Set Label To (left(t.calendar.Thursday,2))
42309>>>>>>>>>>>>>>>>>>>                //AB-StoreEnd
42309>>>>>>>>>>>>>>>>>>>
42309>>>>>>>>>>>>>>>>>>>            End_Object    // Textbox5
42310>>>>>>>>>>>>>>>>>>>
42310>>>>>>>>>>>>>>>>>>>            Object Textbox6 is a Textbox
42312>>>>>>>>>>>>>>>>>>>                Set Label to "Fr"
42313>>>>>>>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
42314>>>>>>>>>>>>>>>>>>>                Set Transparent_State to TRUE
42315>>>>>>>>>>>>>>>>>>>                Set Color to clWhite
42316>>>>>>>>>>>>>>>>>>>                Set TextColor to clNavy
42317>>>>>>>>>>>>>>>>>>>                Set Location to 19 76
42318>>>>>>>>>>>>>>>>>>>                Set Size to 10 17
42319>>>>>>>>>>>>>>>>>>>
42319>>>>>>>>>>>>>>>>>>>                //AB-StoreStart
42319>>>>>>>>>>>>>>>>>>>
42319>>>>>>>>>>>>>>>>>>>                Set Label To (left(t.calendar.Friday,2))
42320>>>>>>>>>>>>>>>>>>>                //AB-StoreEnd
42320>>>>>>>>>>>>>>>>>>>
42320>>>>>>>>>>>>>>>>>>>            End_Object    // Textbox6
42321>>>>>>>>>>>>>>>>>>>
42321>>>>>>>>>>>>>>>>>>>            Object Textbox7 is a Textbox
42323>>>>>>>>>>>>>>>>>>>                Set Label to "Sa"
42324>>>>>>>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
42325>>>>>>>>>>>>>>>>>>>                Set Transparent_State to TRUE
42326>>>>>>>>>>>>>>>>>>>                Set Color to clWhite
42327>>>>>>>>>>>>>>>>>>>                Set TextColor to clNavy
42328>>>>>>>>>>>>>>>>>>>                Set Location to 19 91
42329>>>>>>>>>>>>>>>>>>>                Set Size to 10 18
42330>>>>>>>>>>>>>>>>>>>
42330>>>>>>>>>>>>>>>>>>>                //AB-StoreStart
42330>>>>>>>>>>>>>>>>>>>
42330>>>>>>>>>>>>>>>>>>>                Set Label To (left(t.calendar.Saturday,2))
42331>>>>>>>>>>>>>>>>>>>                //AB-StoreEnd
42331>>>>>>>>>>>>>>>>>>>
42331>>>>>>>>>>>>>>>>>>>            End_Object    // Textbox7
42332>>>>>>>>>>>>>>>>>>>
42332>>>>>>>>>>>>>>>>>>>            Object Textbox8 is a Textbox
42334>>>>>>>>>>>>>>>>>>>                Set Label to "Su"
42335>>>>>>>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
42336>>>>>>>>>>>>>>>>>>>                Set Transparent_State to TRUE
42337>>>>>>>>>>>>>>>>>>>                Set Color to clWhite
42338>>>>>>>>>>>>>>>>>>>                Set TextColor to clNavy
42339>>>>>>>>>>>>>>>>>>>                Set Location to 19 109
42340>>>>>>>>>>>>>>>>>>>                Set Size to 10 17
42341>>>>>>>>>>>>>>>>>>>
42341>>>>>>>>>>>>>>>>>>>                //AB-StoreStart
42341>>>>>>>>>>>>>>>>>>>
42341>>>>>>>>>>>>>>>>>>>                Set Label To (left(t.calendar.Sunday,2))
42342>>>>>>>>>>>>>>>>>>>                //AB-StoreEnd
42342>>>>>>>>>>>>>>>>>>>
42342>>>>>>>>>>>>>>>>>>>            End_Object    // Textbox8
42343>>>>>>>>>>>>>>>>>>>
42343>>>>>>>>>>>>>>>>>>>            Object LineControl1 is a LineControl
42345>>>>>>>>>>>>>>>>>>>                Set Line_Style to lnSINGLE
42346>>>>>>>>>>>>>>>>>>>                Set Size to 1 116
42347>>>>>>>>>>>>>>>>>>>                Set Location to 28 4
42348>>>>>>>>>>>>>>>>>>>
42348>>>>>>>>>>>>>>>>>>>                //AB-StoreStart
42348>>>>>>>>>>>>>>>>>>>
42348>>>>>>>>>>>>>>>>>>>                //AB-StoreEnd
42348>>>>>>>>>>>>>>>>>>>
42348>>>>>>>>>>>>>>>>>>>            End_Object    // LineControl1
42349>>>>>>>>>>>>>>>>>>>
42349>>>>>>>>>>>>>>>>>>>            Object Container3d2 is a Container3d
42351>>>>>>>>>>>>>>>>>>>                Set Size to 18 131
42352>>>>>>>>>>>>>>>>>>>                Set Location to 1 1
42353>>>>>>>>>>>>>>>>>>>                Set Color to clNavy
42354>>>>>>>>>>>>>>>>>>>                Set Border_Style to Border_None
42355>>>>>>>>>>>>>>>>>>>                Object oRght is a BitmapContainer
42357>>>>>>>>>>>>>>>>>>>                    Set Size to 10 14
42358>>>>>>>>>>>>>>>>>>>                    Set Location to 4 105
42359>>>>>>>>>>>>>>>>>>>                    Set Bitmap to "rght.bmp"
42360>>>>>>>>>>>>>>>>>>>                    Set Border_Style to Border_None
42361>>>>>>>>>>>>>>>>>>>
42361>>>>>>>>>>>>>>>>>>>                    //AB-StoreStart
42361>>>>>>>>>>>>>>>>>>>                    Procedure Mouse_Down
42363>>>>>>>>>>>>>>>>>>>                        Send Next_Month to Grid2
42364>>>>>>>>>>>>>>>>>>>                    End_Procedure
42365>>>>>>>>>>>>>>>>>>>                    //AB-StoreEnd
42365>>>>>>>>>>>>>>>>>>>
42365>>>>>>>>>>>>>>>>>>>                End_Object    // oRght
42366>>>>>>>>>>>>>>>>>>>
42366>>>>>>>>>>>>>>>>>>>                Object oLeft is a BitmapContainer
42368>>>>>>>>>>>>>>>>>>>                    Set Size to 10 14
42369>>>>>>>>>>>>>>>>>>>                    Set Location to 4 3
42370>>>>>>>>>>>>>>>>>>>                    Set Bitmap to "lft.bmp"
42371>>>>>>>>>>>>>>>>>>>                    Set Border_Style to Border_None
42372>>>>>>>>>>>>>>>>>>>
42372>>>>>>>>>>>>>>>>>>>                    //AB-StoreStart
42372>>>>>>>>>>>>>>>>>>>                    Procedure Mouse_Down
42374>>>>>>>>>>>>>>>>>>>                        Send Prev_Month to Grid2
42375>>>>>>>>>>>>>>>>>>>                    End_Procedure
42376>>>>>>>>>>>>>>>>>>>                    //AB-StoreEnd
42376>>>>>>>>>>>>>>>>>>>
42376>>>>>>>>>>>>>>>>>>>                End_Object    // oLeft
42377>>>>>>>>>>>>>>>>>>>
42377>>>>>>>>>>>>>>>>>>>                Object oMonth is a Textbox
42379>>>>>>>>>>>>>>>>>>>
42379>>>>>>>>>>>>>>>>>>>                    //AB-StoreTopStart
42379>>>>>>>>>>>>>>>>>>>                    Property integer piSelected_Month public 0
42381>>>>>>>>>>>>>>>>>>>                    //AB-StoreTopEnd
42381>>>>>>>>>>>>>>>>>>>
42381>>>>>>>>>>>>>>>>>>>                    Set Label to "January"
42382>>>>>>>>>>>>>>>>>>>                    Set Auto_Size_State to FALSE
42383>>>>>>>>>>>>>>>>>>>                    Set Transparent_State to TRUE
42384>>>>>>>>>>>>>>>>>>>                    Set Color to clWhite
42385>>>>>>>>>>>>>>>>>>>                    Set TextColor to clWhite
42386>>>>>>>>>>>>>>>>>>>                    Set Location to 4 19
42387>>>>>>>>>>>>>>>>>>>                    Set Size to 10 46
42388>>>>>>>>>>>>>>>>>>>                    Set FontWeight to 800
42389>>>>>>>>>>>>>>>>>>>                    Set Justification_Mode to jMode_Center
42390>>>>>>>>>>>>>>>>>>>
42390>>>>>>>>>>>>>>>>>>>                    //AB-StoreStart
42390>>>>>>>>>>>>>>>>>>>
42390>>>>>>>>>>>>>>>>>>>                    Procedure Mouse_Down
42392>>>>>>>>>>>>>>>>>>>                        Integer iState
42393>>>>>>>>>>>>>>>>>>>                        Get Visible_State of oSelectCalendarYear to iState
42394>>>>>>>>>>>>>>>>>>>                        If (iState) Send OnKillFocus to oSelectCalendarYear
42397>>>>>>>>>>>>>>>>>>>                        Send Popup to oSelectMonth
42398>>>>>>>>>>>>>>>>>>>                    End_Procedure
42399>>>>>>>>>>>>>>>>>>>
42399>>>>>>>>>>>>>>>>>>>                    Procedure pSelectJan
42401>>>>>>>>>>>>>>>>>>>                        Set Label to t.calendar.january
42402>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to 1
42403>>>>>>>>>>>>>>>>>>>                        Send Adjust_Calendar
42404>>>>>>>>>>>>>>>>>>>                    End_Procedure
42405>>>>>>>>>>>>>>>>>>>                    Procedure pSelectFeb
42407>>>>>>>>>>>>>>>>>>>                        Set Label to t.calendar.february
42408>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to 2
42409>>>>>>>>>>>>>>>>>>>                        Send Adjust_Calendar
42410>>>>>>>>>>>>>>>>>>>                    End_Procedure
42411>>>>>>>>>>>>>>>>>>>                    Procedure pSelectMar
42413>>>>>>>>>>>>>>>>>>>                        Set Label to t.calendar.march
42414>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to 3
42415>>>>>>>>>>>>>>>>>>>                        Send Adjust_Calendar
42416>>>>>>>>>>>>>>>>>>>                    End_Procedure
42417>>>>>>>>>>>>>>>>>>>                    Procedure pSelectApr
42419>>>>>>>>>>>>>>>>>>>                        Set Label to t.calendar.april
42420>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to 4
42421>>>>>>>>>>>>>>>>>>>                        Send Adjust_Calendar
42422>>>>>>>>>>>>>>>>>>>                    End_Procedure
42423>>>>>>>>>>>>>>>>>>>                    Procedure pSelectMay
42425>>>>>>>>>>>>>>>>>>>                        Set Label to t.calendar.may
42426>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to 5
42427>>>>>>>>>>>>>>>>>>>                        Send Adjust_Calendar
42428>>>>>>>>>>>>>>>>>>>                    End_Procedure
42429>>>>>>>>>>>>>>>>>>>                    Procedure pSelectJun
42431>>>>>>>>>>>>>>>>>>>                        Set Label to t.calendar.june
42432>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to 6
42433>>>>>>>>>>>>>>>>>>>                        Send Adjust_Calendar
42434>>>>>>>>>>>>>>>>>>>                    End_Procedure
42435>>>>>>>>>>>>>>>>>>>                    Procedure pSelectJul
42437>>>>>>>>>>>>>>>>>>>                        Set Label to t.calendar.july
42438>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to 7
42439>>>>>>>>>>>>>>>>>>>                        Send Adjust_Calendar
42440>>>>>>>>>>>>>>>>>>>                    End_Procedure
42441>>>>>>>>>>>>>>>>>>>                    Procedure pSelectAug
42443>>>>>>>>>>>>>>>>>>>                        Set Label to t.calendar.august
42444>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to 8
42445>>>>>>>>>>>>>>>>>>>                        Send Adjust_Calendar
42446>>>>>>>>>>>>>>>>>>>                    End_Procedure
42447>>>>>>>>>>>>>>>>>>>                    Procedure pSelectSep
42449>>>>>>>>>>>>>>>>>>>                        Set Label to t.calendar.september
42450>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to 9
42451>>>>>>>>>>>>>>>>>>>                        Send Adjust_Calendar
42452>>>>>>>>>>>>>>>>>>>                    End_Procedure
42453>>>>>>>>>>>>>>>>>>>                    Procedure pSelectOct
42455>>>>>>>>>>>>>>>>>>>                        Set Label to t.calendar.october
42456>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to 10
42457>>>>>>>>>>>>>>>>>>>                        Send Adjust_Calendar
42458>>>>>>>>>>>>>>>>>>>                    End_Procedure
42459>>>>>>>>>>>>>>>>>>>                    Procedure pSelectNov
42461>>>>>>>>>>>>>>>>>>>                        Set Label to t.calendar.november
42462>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to 11
42463>>>>>>>>>>>>>>>>>>>                        Send Adjust_Calendar
42464>>>>>>>>>>>>>>>>>>>                    End_Procedure
42465>>>>>>>>>>>>>>>>>>>                    Procedure pSelectDec
42467>>>>>>>>>>>>>>>>>>>                        Set Label to t.calendar.december
42468>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to 12
42469>>>>>>>>>>>>>>>>>>>                        Send Adjust_Calendar
42470>>>>>>>>>>>>>>>>>>>                    End_Procedure
42471>>>>>>>>>>>>>>>>>>>
42471>>>>>>>>>>>>>>>>>>>                    Object oSelectMonth is a FloatingPopupMenu
42473>>>>>>>>>>>>>>>>>>>                        Send Add_Item msg_pSelectJan t.calendar.january
42474>>>>>>>>>>>>>>>>>>>                        Send Add_Item msg_pSelectFeb t.calendar.february
42475>>>>>>>>>>>>>>>>>>>                        Send Add_Item msg_pSelectMar t.calendar.march
42476>>>>>>>>>>>>>>>>>>>                        Send Add_Item msg_pSelectApr t.calendar.april
42477>>>>>>>>>>>>>>>>>>>                        Send Add_Item msg_pSelectMay t.calendar.may
42478>>>>>>>>>>>>>>>>>>>                        Send Add_Item msg_pSelectJun t.calendar.june
42479>>>>>>>>>>>>>>>>>>>                        Send Add_Item msg_pSelectJul t.calendar.july
42480>>>>>>>>>>>>>>>>>>>                        Send Add_Item msg_pSelectAug t.calendar.august
42481>>>>>>>>>>>>>>>>>>>                        Send Add_Item msg_pSelectSep t.calendar.september
42482>>>>>>>>>>>>>>>>>>>                        Send Add_Item msg_pSelectOct t.calendar.october
42483>>>>>>>>>>>>>>>>>>>                        Send Add_Item msg_pSelectNov t.calendar.november
42484>>>>>>>>>>>>>>>>>>>                        Send Add_Item msg_pSelectDec t.calendar.december
42485>>>>>>>>>>>>>>>>>>>                    End_Object
42486>>>>>>>>>>>>>>>>>>>
42486>>>>>>>>>>>>>>>>>>>                    Procedure Adjust_Calendar
42488>>>>>>>>>>>>>>>>>>>                        Date date#
42489>>>>>>>>>>>>>>>>>>>                        Integer iDay iMonth iYear iItm
42489>>>>>>>>>>>>>>>>>>>                        Set Visible_State to false
42490>>>>>>>>>>>>>>>>>>>                        Set Visible_State to true
42491>>>>>>>>>>>>>>>>>>>                        Get Current_Item of (Grid2(Container3D1(Self))) to iItm
42492>>>>>>>>>>>>>>>>>>>                        Get value of (Grid2(Container3D1(Self))) item iItm to iDay
42493>>>>>>>>>>>>>>>>>>>                        Get piSelected_Month to iMonth
42494>>>>>>>>>>>>>>>>>>>                        Get Label of oCalendarYear to iYear
42495>>>>>>>>>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
42496>>>>>>>>>>>>>>>>>>>                        Set p_current_date of (Grid2(Container3D1(Self))) to date#
42497>>>>>>>>>>>>>>>>>>>                        Send Update_Calendar to (Grid2(Container3D1(Self)))
42498>>>>>>>>>>>>>>>>>>>                    End_Procedure
42499>>>>>>>>>>>>>>>>>>>
42499>>>>>>>>>>>>>>>>>>>                    Procedure Activating
42501>>>>>>>>>>>>>>>>>>>                        Forward Send Activating
42503>>>>>>>>>>>>>>>>>>>                        Send Date_Changing
42504>>>>>>>>>>>>>>>>>>>                    End_Procedure
42505>>>>>>>>>>>>>>>>>>>
42505>>>>>>>>>>>>>>>>>>>                    Procedure Date_Changing
42507>>>>>>>>>>>>>>>>>>>                        Set Visible_State to false
42508>>>>>>>>>>>>>>>>>>>                        Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
42509>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
42510>>>>>>>>>>>>>>>>>>>                        Set Visible_State to true
42511>>>>>>>>>>>>>>>>>>>                    End_Procedure
42512>>>>>>>>>>>>>>>>>>>
42512>>>>>>>>>>>>>>>>>>>
42512>>>>>>>>>>>>>>>>>>>
42512>>>>>>>>>>>>>>>>>>>                    //AB-StoreEnd
42512>>>>>>>>>>>>>>>>>>>
42512>>>>>>>>>>>>>>>>>>>                End_Object    // oMonth
42513>>>>>>>>>>>>>>>>>>>
42513>>>>>>>>>>>>>>>>>>>                Object oCalendarYear is a Textbox
42515>>>>>>>>>>>>>>>>>>>                    Set Label to "2001"
42516>>>>>>>>>>>>>>>>>>>                    Set Transparent_State to TRUE
42517>>>>>>>>>>>>>>>>>>>                    Set Color to clWhite
42518>>>>>>>>>>>>>>>>>>>                    Set TextColor to clWhite
42519>>>>>>>>>>>>>>>>>>>                    Set Location to 4 77
42520>>>>>>>>>>>>>>>>>>>                    Set Size to 10 18
42521>>>>>>>>>>>>>>>>>>>                    Set FontWeight to 800
42522>>>>>>>>>>>>>>>>>>>
42522>>>>>>>>>>>>>>>>>>>                    //AB-StoreStart
42522>>>>>>>>>>>>>>>>>>>
42522>>>>>>>>>>>>>>>>>>>                    Procedure Mouse_Down
42524>>>>>>>>>>>>>>>>>>>                        String sVal
42525>>>>>>>>>>>>>>>>>>>                        Get Label to sVal
42526>>>>>>>>>>>>>>>>>>>                        Set Value of oSelectCalendarYear item 0 to sVal
42527>>>>>>>>>>>>>>>>>>>                        Set Visible_State of oSelectCalendarYear to True
42528>>>>>>>>>>>>>>>>>>>                        Send Activate to (oSelectCalendarYear(Self))
42529>>>>>>>>>>>>>>>>>>>                    End_Procedure
42530>>>>>>>>>>>>>>>>>>>
42530>>>>>>>>>>>>>>>>>>>                    Procedure Activating
42532>>>>>>>>>>>>>>>>>>>                        Forward Send Activating
42534>>>>>>>>>>>>>>>>>>>                        Send Date_Changing
42535>>>>>>>>>>>>>>>>>>>                    End_Procedure
42536>>>>>>>>>>>>>>>>>>>
42536>>>>>>>>>>>>>>>>>>>                    Procedure Date_Changing
42538>>>>>>>>>>>>>>>>>>>                        Set Visible_State to false
42539>>>>>>>>>>>>>>>>>>>                        Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
42540>>>>>>>>>>>>>>>>>>>                        Set Visible_State to true
42541>>>>>>>>>>>>>>>>>>>                    End_Procedure
42542>>>>>>>>>>>>>>>>>>>
42542>>>>>>>>>>>>>>>>>>>                    //AB-StoreEnd
42542>>>>>>>>>>>>>>>>>>>
42542>>>>>>>>>>>>>>>>>>>                End_Object    // oCalendarYear
42543>>>>>>>>>>>>>>>>>>>
42543>>>>>>>>>>>>>>>>>>>                Object oSelectCalendarYear is a Form
42545>>>>>>>>>>>>>>>>>>>
42545>>>>>>>>>>>>>>>>>>>                    //AB-StoreTopStart
42545>>>>>>>>>>>>>>>>>>>                    Set Visible_State To False
42546>>>>>>>>>>>>>>>>>>>                    //AB-StoreTopEnd
42546>>>>>>>>>>>>>>>>>>>
42546>>>>>>>>>>>>>>>>>>>                    Set Size to 10 24
42547>>>>>>>>>>>>>>>>>>>                    Set Location to 4 75
42548>>>>>>>>>>>>>>>>>>>                    Set Color to clWhite
42549>>>>>>>>>>>>>>>>>>>                    Set TextColor to clNavy
42550>>>>>>>>>>>>>>>>>>>                    Set Form_Border Item 0 to Border_Normal
42551>>>>>>>>>>>>>>>>>>>
42551>>>>>>>>>>>>>>>>>>>                    //AB-StoreStart
42551>>>>>>>>>>>>>>>>>>>
42551>>>>>>>>>>>>>>>>>>>                    On_Key Key_Enter Send OnKillFocus
42552>>>>>>>>>>>>>>>>>>>                    On_Key Key_Escape Send OnKillFocus
42553>>>>>>>>>>>>>>>>>>>
42553>>>>>>>>>>>>>>>>>>>                    Procedure SetFontWeight
42555>>>>>>>>>>>>>>>>>>>                        Set Form_FontWeight item 0 to 800
42556>>>>>>>>>>>>>>>>>>>                    End_Procedure
42557>>>>>>>>>>>>>>>>>>>
42557>>>>>>>>>>>>>>>>>>>                    Procedure OnKillFocus
42559>>>>>>>>>>>>>>>>>>>                        String sVal
42560>>>>>>>>>>>>>>>>>>>                        Integer iMonth iDay iYear iItm
42560>>>>>>>>>>>>>>>>>>>                        Date date#
42560>>>>>>>>>>>>>>>>>>>                        Get Value item 0 to sVal
42561>>>>>>>>>>>>>>>>>>>                        Set Visible_State of oCalendarYear to false
42562>>>>>>>>>>>>>>>>>>>                        Set Label of oCalendarYear to sVal
42563>>>>>>>>>>>>>>>>>>>                        Set Visible_State of oCalendarYear to true
42564>>>>>>>>>>>>>>>>>>>                        Set Visible_State to false
42565>>>>>>>>>>>>>>>>>>>                        Get Current_Item of (Grid2(Container3D1(Self))) to iItm
42566>>>>>>>>>>>>>>>>>>>                        Get value of (Grid2(Container3D1(Self))) item iItm to iDay
42567>>>>>>>>>>>>>>>>>>>                        Get piSelected_Month of oMonth to iMonth
42568>>>>>>>>>>>>>>>>>>>                        Get Value item 0 to iYear
42569>>>>>>>>>>>>>>>>>>>                        If (iYear = 0) Move 2000 to iYear
42572>>>>>>>>>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
42573>>>>>>>>>>>>>>>>>>>                        Set p_current_date of (Grid2(Container3D1(Self))) to date#
42574>>>>>>>>>>>>>>>>>>>                        Send Update_Calendar to (Grid2(Container3D1(Self)))
42575>>>>>>>>>>>>>>>>>>>                        Send Activate        to (Grid2(Container3D1(Self)))
42576>>>>>>>>>>>>>>>>>>>                    End_Procedure
42577>>>>>>>>>>>>>>>>>>>
42577>>>>>>>>>>>>>>>>>>>                    Send SetFontWeight
42578>>>>>>>>>>>>>>>>>>>
42578>>>>>>>>>>>>>>>>>>>
42578>>>>>>>>>>>>>>>>>>>
42578>>>>>>>>>>>>>>>>>>>                    //AB-StoreEnd
42578>>>>>>>>>>>>>>>>>>>
42578>>>>>>>>>>>>>>>>>>>                End_Object    // oSelectCalendarYear
42579>>>>>>>>>>>>>>>>>>>
42579>>>>>>>>>>>>>>>>>>>
42579>>>>>>>>>>>>>>>>>>>                //AB-StoreStart
42579>>>>>>>>>>>>>>>>>>>
42579>>>>>>>>>>>>>>>>>>>                Procedure Mouse_Down
42581>>>>>>>>>>>>>>>>>>>                    Integer iState
42582>>>>>>>>>>>>>>>>>>>                    Get Visible_State of oSelectCalendarYear to iState
42583>>>>>>>>>>>>>>>>>>>                    If (iState) Send OnKillFocus to oSelectCalendarYear
42586>>>>>>>>>>>>>>>>>>>                End_Procedure
42587>>>>>>>>>>>>>>>>>>>
42587>>>>>>>>>>>>>>>>>>>
42587>>>>>>>>>>>>>>>>>>>                //AB-StoreEnd
42587>>>>>>>>>>>>>>>>>>>
42587>>>>>>>>>>>>>>>>>>>            End_Object    // Container3d2
42588>>>>>>>>>>>>>>>>>>>
42588>>>>>>>>>>>>>>>>>>>
42588>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
42588>>>>>>>>>>>>>>>>>>>
42588>>>>>>>>>>>>>>>>>>>
42588>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
42588>>>>>>>>>>>>>>>>>>>
42588>>>>>>>>>>>>>>>>>>>        End_Object    // Container3d1
42589>>>>>>>>>>>>>>>>>>>
42589>>>>>>>>>>>>>>>>>>>        Object BitmapContainer3 is a BitmapContainer
42591>>>>>>>>>>>>>>>>>>>            Set Size to 9 19
42592>>>>>>>>>>>>>>>>>>>            Set Location to 88 3
42593>>>>>>>>>>>>>>>>>>>            Set Color to clWhite
42594>>>>>>>>>>>>>>>>>>>            Set Bitmap to "cdate.bmp"
42595>>>>>>>>>>>>>>>>>>>            Set Border_Style to Border_None
42596>>>>>>>>>>>>>>>>>>>
42596>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
42596>>>>>>>>>>>>>>>>>>>            Procedure Mouse_Down
42598>>>>>>>>>>>>>>>>>>>                Send go_today to (Grid2(Container3d1(Self)))
42599>>>>>>>>>>>>>>>>>>>                Send Adjust_Label to oToday
42600>>>>>>>>>>>>>>>>>>>            End_Procedure
42601>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
42601>>>>>>>>>>>>>>>>>>>
42601>>>>>>>>>>>>>>>>>>>        End_Object    // BitmapContainer3
42602>>>>>>>>>>>>>>>>>>>
42602>>>>>>>>>>>>>>>>>>>        Object oToday is a Textbox
42604>>>>>>>>>>>>>>>>>>>            Set Label to "Today: 01.01.2001"
42605>>>>>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
42606>>>>>>>>>>>>>>>>>>>            Set Color to clWhite
42607>>>>>>>>>>>>>>>>>>>            Set Location to 88 22
42608>>>>>>>>>>>>>>>>>>>            Set Size to 8 70
42609>>>>>>>>>>>>>>>>>>>            Set FontWeight to 800
42610>>>>>>>>>>>>>>>>>>>
42610>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
42610>>>>>>>>>>>>>>>>>>>            Procedure Mouse_Down
42612>>>>>>>>>>>>>>>>>>>                Send go_today to (Grid2(Container3d1(Self)))
42613>>>>>>>>>>>>>>>>>>>                Send Adjust_Label
42614>>>>>>>>>>>>>>>>>>>            End_Procedure
42615>>>>>>>>>>>>>>>>>>>
42615>>>>>>>>>>>>>>>>>>>            Procedure Adjust_Label
42617>>>>>>>>>>>>>>>>>>>                date date#
42618>>>>>>>>>>>>>>>>>>>                SysDate4 date#
42619>>>>>>>>>>>>>>>>>>>                Set Visible_State To false
42620>>>>>>>>>>>>>>>>>>>                Set Label         to (t.calendar.today+": "+String(date#))
42621>>>>>>>>>>>>>>>>>>>                Set Visible_State To true
42622>>>>>>>>>>>>>>>>>>>            End_Procedure
42623>>>>>>>>>>>>>>>>>>>
42623>>>>>>>>>>>>>>>>>>>            Procedure Activating
42625>>>>>>>>>>>>>>>>>>>                Forward Send Activating
42627>>>>>>>>>>>>>>>>>>>                Send Adjust_Label
42628>>>>>>>>>>>>>>>>>>>            End_Procedure
42629>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
42629>>>>>>>>>>>>>>>>>>>
42629>>>>>>>>>>>>>>>>>>>        End_Object    // oToday
42630>>>>>>>>>>>>>>>>>>>
42630>>>>>>>>>>>>>>>>>>>        Object oCloseCalendar_bn is a BitmapContainer
42632>>>>>>>>>>>>>>>>>>>            Set Size to 9 10
42633>>>>>>>>>>>>>>>>>>>            Set Location to 88 112
42634>>>>>>>>>>>>>>>>>>>            Set Bitmap to "Cdate1.bmp"
42635>>>>>>>>>>>>>>>>>>>            Set Bitmap_Style to Bitmap_Center
42636>>>>>>>>>>>>>>>>>>>
42636>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
42636>>>>>>>>>>>>>>>>>>>
42636>>>>>>>>>>>>>>>>>>>            Procedure Mouse_Up
42638>>>>>>>>>>>>>>>>>>>                Send Close_Calendar
42639>>>>>>>>>>>>>>>>>>>            End_Procedure // Mouse_Up
42640>>>>>>>>>>>>>>>>>>>
42640>>>>>>>>>>>>>>>>>>>
42640>>>>>>>>>>>>>>>>>>>
42640>>>>>>>>>>>>>>>>>>>
42640>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
42640>>>>>>>>>>>>>>>>>>>
42640>>>>>>>>>>>>>>>>>>>        End_Object    // oCloseCalendar_bn
42641>>>>>>>>>>>>>>>>>>>
42641>>>>>>>>>>>>>>>>>>>
42641>>>>>>>>>>>>>>>>>>>        //AB-StoreStart
42641>>>>>>>>>>>>>>>>>>>
42641>>>>>>>>>>>>>>>>>>>        Set Block_Mouse_State to True
42642>>>>>>>>>>>>>>>>>>>        Set Popup_State to True
42643>>>>>>>>>>>>>>>>>>>        Set Locate_Mode to Popup_Locate
42644>>>>>>>>>>>>>>>>>>>
42644>>>>>>>>>>>>>>>>>>>        procedure popup
42646>>>>>>>>>>>>>>>>>>>            local integer focus# icItm iYear iMonth
42647>>>>>>>>>>>>>>>>>>>            local date date#
42647>>>>>>>>>>>>>>>>>>>            move (focus(desktop)) to focus#
42648>>>>>>>>>>>>>>>>>>>            set invoking_object_id of (Grid2(Container3d1(self))) to focus#
42649>>>>>>>>>>>>>>>>>>>            get value of focus# item current to date#
42650>>>>>>>>>>>>>>>>>>>            ifnot (integer(date#)) sysdate date#
42653>>>>>>>>>>>>>>>>>>>            move (Date2to4(date#)) to date#
42654>>>>>>>>>>>>>>>>>>>            set p_current_date of (Grid2(Container3d1(self))) to date#
42655>>>>>>>>>>>>>>>>>>>            send fill_list to (Grid2(Container3d1(self)))
42656>>>>>>>>>>>>>>>>>>>            move (DateSegment(date#,DS_YEAR)) to iYear
42657>>>>>>>>>>>>>>>>>>>            move (DateSegment(date#,DS_MONTH)) to iMonth
42658>>>>>>>>>>>>>>>>>>>            Set Label To (MonthName(iMonth)+', '+String(iYear))
42659>>>>>>>>>>>>>>>>>>>            forward send popup
42661>>>>>>>>>>>>>>>>>>>        end_procedure
42662>>>>>>>>>>>>>>>>>>>
42662>>>>>>>>>>>>>>>>>>>        Procedure Close_Calendar
42664>>>>>>>>>>>>>>>>>>>            Send Close_Panel
42665>>>>>>>>>>>>>>>>>>>        End_Procedure // Close_Calendar
42666>>>>>>>>>>>>>>>>>>>
42666>>>>>>>>>>>>>>>>>>>        Object Help_Container is a Container3d
42668>>>>>>>>>>>>>>>>>>>            Set Location to 0 0
42669>>>>>>>>>>>>>>>>>>>            Set Size     to 98 122
42670>>>>>>>>>>>>>>>>>>>            Set Visible_State to False
42671>>>>>>>>>>>>>>>>>>>            Set Enabled_State to False
42672>>>>>>>>>>>>>>>>>>>            Set Border_Style to Border_None
42673>>>>>>>>>>>>>>>>>>>            Set TextColor to clNavy
42674>>>>>>>>>>>>>>>>>>>
42674>>>>>>>>>>>>>>>>>>>            Object Help_Info is an Edit
42676>>>>>>>>>>>>>>>>>>>                Set Location to 0 0
42677>>>>>>>>>>>>>>>>>>>                Set Size     to 98 122
42678>>>>>>>>>>>>>>>>>>>                Set read_only_state to true
42679>>>>>>>>>>>>>>>>>>>                Set Border_Style to Border_None
42680>>>>>>>>>>>>>>>>>>>                Set scroll_bar_visible_state to False
42681>>>>>>>>>>>>>>>>>>>                Set FontWeight to 800
42682>>>>>>>>>>>>>>>>>>>
42682>>>>>>>>>>>>>>>>>>>                Procedure ReadHelpComments
42684>>>>>>>>>>>>>>>>>>>                    String lsFile
42685>>>>>>>>>>>>>>>>>>>
42685>>>>>>>>>>>>>>>>>>>                    Get_File_Path "Calendar.txt" to lsFile
42686>>>>>>>>>>>>>>>>>>>                    If (lsFile <> "") Send read lsFile
42689>>>>>>>>>>>>>>>>>>>                End_Procedure // ReadHelpComments
42690>>>>>>>>>>>>>>>>>>>
42690>>>>>>>>>>>>>>>>>>>                Procedure SetComments
42692>>>>>>>>>>>>>>>>>>>                    Send append_text "Help on Calendar"
42693>>>>>>>>>>>>>>>>>>>                    Send Insert ""
42694>>>>>>>>>>>>>>>>>>>                    Send Insert ""
42695>>>>>>>>>>>>>>>>>>>                    Send append_text "1.<Up>,<Dn>,<Lft>,<Rgt>"
42696>>>>>>>>>>>>>>>>>>>                    Send Insert ""
42697>>>>>>>>>>>>>>>>>>>                    Send append_text "  - select date."
42698>>>>>>>>>>>>>>>>>>>                    Send Insert ""
42699>>>>>>>>>>>>>>>>>>>                    Send append_text "2.<PgUp>,<PgDn>"
42700>>>>>>>>>>>>>>>>>>>                    Send Insert ""
42701>>>>>>>>>>>>>>>>>>>                    Send append_text "  - select month."
42702>>>>>>>>>>>>>>>>>>>                    Send Insert ""
42703>>>>>>>>>>>>>>>>>>>                    Send append_text "3.<Ctrl>+<D>"
42704>>>>>>>>>>>>>>>>>>>                    Send Insert ""
42705>>>>>>>>>>>>>>>>>>>                    Send append_text "  - set current date."
42706>>>>>>>>>>>>>>>>>>>                    Send Insert ""
42707>>>>>>>>>>>>>>>>>>>                    Send append_text "4.<Ctrl>+<Y>"
42708>>>>>>>>>>>>>>>>>>>                    Send Insert ""
42709>>>>>>>>>>>>>>>>>>>                    Send append_text "  - Change year."
42710>>>>>>>>>>>>>>>>>>>                    Send Insert ""
42711>>>>>>>>>>>>>>>>>>>                    Send append_text "5.<Ctrl>+<PgUp>,<PgDn>"
42712>>>>>>>>>>>>>>>>>>>                    Send Insert ""
42713>>>>>>>>>>>>>>>>>>>                    Send append_text "  - Select year."
42714>>>>>>>>>>>>>>>>>>>                End_procedure // SetComments
42715>>>>>>>>>>>>>>>>>>>
42715>>>>>>>>>>>>>>>>>>>                //Send SetComments
42715>>>>>>>>>>>>>>>>>>>                Set Color     to clWhite
42716>>>>>>>>>>>>>>>>>>>                Set TextColor to clNavy
42717>>>>>>>>>>>>>>>>>>>
42717>>>>>>>>>>>>>>>>>>>                Procedure OnSetFocus
42719>>>>>>>>>>>>>>>>>>>                    Send ReadHelpComments
42720>>>>>>>>>>>>>>>>>>>                End_Procedure
42721>>>>>>>>>>>>>>>>>>>
42721>>>>>>>>>>>>>>>>>>>                Object HelpFloatingMenu is a FloatingPopupMenu
42723>>>>>>>>>>>>>>>>>>>
42723>>>>>>>>>>>>>>>>>>>                    Procedure Close_Help
42725>>>>>>>>>>>>>>>>>>>                        Send Close_Help to Help_Container
42726>>>>>>>>>>>>>>>>>>>                    End_Procedure // Close_Calendar
42727>>>>>>>>>>>>>>>>>>>
42727>>>>>>>>>>>>>>>>>>>                    Send Add_item msg_Close_Help   t.calendar.Ok
42728>>>>>>>>>>>>>>>>>>>                End_Object // cOutlookFloatingMenu
42729>>>>>>>>>>>>>>>>>>>
42729>>>>>>>>>>>>>>>>>>>                Procedure Mouse_Up2 Integer aiWindow Integer aiChar_Pos
42731>>>>>>>>>>>>>>>>>>>                    Send Popup to HelpFloatingMenu
42732>>>>>>>>>>>>>>>>>>>                End_Procedure // Mouse_Up2
42733>>>>>>>>>>>>>>>>>>>
42733>>>>>>>>>>>>>>>>>>>            End_Object
42734>>>>>>>>>>>>>>>>>>>
42734>>>>>>>>>>>>>>>>>>>            Procedure Close_Help
42736>>>>>>>>>>>>>>>>>>>                Send Delete_Data to Help_Info
42737>>>>>>>>>>>>>>>>>>>                Set Visible_State to False
42738>>>>>>>>>>>>>>>>>>>                Set Enabled_State to False
42739>>>>>>>>>>>>>>>>>>>                Send Activate to (Grid2(Container3D1(Self)))
42740>>>>>>>>>>>>>>>>>>>            End_Procedure // Close_Help
42741>>>>>>>>>>>>>>>>>>>
42741>>>>>>>>>>>>>>>>>>>            On_Key kCancel Send Close_Help
42742>>>>>>>>>>>>>>>>>>>            On_Key Key_F1  Send Close_Help
42743>>>>>>>>>>>>>>>>>>>            On_Key kEnter  Send Close_Help
42744>>>>>>>>>>>>>>>>>>>        End_Object // Help_Info
42745>>>>>>>>>>>>>>>>>>>
42745>>>>>>>>>>>>>>>>>>>        on_key kcancel           send Close_Calendar
42746>>>>>>>>>>>>>>>>>>>
42746>>>>>>>>>>>>>>>>>>>
42746>>>>>>>>>>>>>>>>>>>
42746>>>>>>>>>>>>>>>>>>>
42746>>>>>>>>>>>>>>>>>>>
42746>>>>>>>>>>>>>>>>>>>
42746>>>>>>>>>>>>>>>>>>>        //AB-StoreEnd
42746>>>>>>>>>>>>>>>>>>>
42746>>>>>>>>>>>>>>>>>>>    End_Object    // oCalendar
42747>>>>>>>>>>>>>>>>>>>
42747>>>>>>>>>>>>>>>>>>>
42747>>>>>>>>>>>>>>>>>>>    //AB-StoreStart
42747>>>>>>>>>>>>>>>>>>>
42747>>>>>>>>>>>>>>>>>>>    Procedure Request_Popup_cOutlookCalendar for BaseClass
42748>>>>>>>>>>>>>>>>>>>        Integer focus# type# dm#
42749>>>>>>>>>>>>>>>>>>>
42749>>>>>>>>>>>>>>>>>>>        move (focus(desktop)) to focus#
42750>>>>>>>>>>>>>>>>>>>        if focus# gt desktop begin
42752>>>>>>>>>>>>>>>>>>>          get delegation_mode of focus# to dm#
42753>>>>>>>>>>>>>>>>>>>          set delegation_mode of focus# to no_delegate_or_error
42754>>>>>>>>>>>>>>>>>>>          get form_datatype of focus# item current to type#
42755>>>>>>>>>>>>>>>>>>>          if (type#=date_window or type#=mask_date_window) send popup to oCalendar
42758>>>>>>>>>>>>>>>>>>>          set delegation_mode of focus# to dm#
42759>>>>>>>>>>>>>>>>>>>        end
42759>>>>>>>>>>>>>>>>>>>>
42759>>>>>>>>>>>>>>>>>>>    End_Procedure
42760>>>>>>>>>>>>>>>>>>>
42760>>>>>>>>>>>>>>>>>>>    On_Key Key_Ctrl+Key_F1 Send Request_Popup_cOutlookCalendar
42761>>>>>>>>>>>>>>>>>>>    On_Key Key_Ctrl+Key_H  Send Request_Popup_cOutlookCalendar
42762>>>>>>>>>>>>>>>>>>>
42762>>>>>>>>>>>>>>>>>>>
42762>>>>>>>>>>>>>>>>>>>    //AB-StoreEnd
42762>>>>>>>>>>>>>>>>>>>
42762>>>>>>>>>>>>>>>>>>>//AB/     End_Object    // prj
42762>>>>>>>>>>>>>>>>>Use Dates.Utl
42762>>>>>>>>>>>>>>>>>
42762>>>>>>>>>>>>>>>>>   Define cStatusHelp       for "F4 = Calendar. T = Today, B = Begin of month, E = End of month."
42762>>>>>>>>>>>>>>>>>   Define cDateToday        for "T"
42762>>>>>>>>>>>>>>>>>   Define cDateBeginOfMonth for "B"
42762>>>>>>>>>>>>>>>>>   Define cDateEndOfMonth   for "E"
42762>>>>>>>>>>>>>>>>>
42762>>>>>>>>>>>>>>>>>Class cSyIntelliSense_Date_Mixin is a Message
42763>>>>>>>>>>>>>>>>>   Procedure DoDefineIntelliSenseDateMixin
42764>>>>>>>>>>>>>>>>>      Property Date    pdOriginal_Value          Public 0
42765>>>>>>>>>>>>>>>>>      Property Integer pbIntelliSense_Date_State Public dfTrue
42766>>>>>>>>>>>>>>>>>      Property Integer pbEnableCalendarPrompt    Public dfTrue
42767>>>>>>>>>>>>>>>>>      On_Key KUpArrow         Send DoAddOneDay
42768>>>>>>>>>>>>>>>>>      On_Key KDownArrow       Send DoSubOneDay
42769>>>>>>>>>>>>>>>>>   End_Procedure // DoDefineIntelliSenseDateMixin
42770>>>>>>>>>>>>>>>>>
42770>>>>>>>>>>>>>>>>>   Procedure DoAddOneDay
42771>>>>>>>>>>>>>>>>>        Integer rVal
42772>>>>>>>>>>>>>>>>>        Date dHmnia
42772>>>>>>>>>>>>>>>>>
42772>>>>>>>>>>>>>>>>>        Get Value Item 0 to dHmnia
42773>>>>>>>>>>>>>>>>>        Add 1 to dHmnia
42774>>>>>>>>>>>>>>>>>        Set Value Item 0 to dHmnia
42775>>>>>>>>>>>>>>>>>    End_Procedure // Add_One_Day
42776>>>>>>>>>>>>>>>>>
42776>>>>>>>>>>>>>>>>>    Procedure DoSubOneDay
42777>>>>>>>>>>>>>>>>>        Integer rVal
42778>>>>>>>>>>>>>>>>>        Date dHmnia
42778>>>>>>>>>>>>>>>>>
42778>>>>>>>>>>>>>>>>>        Get Value Item 0 to dHmnia
42779>>>>>>>>>>>>>>>>>        Sub 1 to dHmnia
42780>>>>>>>>>>>>>>>>>        Set Value Item 0 to dHmnia
42781>>>>>>>>>>>>>>>>>    End_Procedure // Add_One_Day
42782>>>>>>>>>>>>>>>>>
42782>>>>>>>>>>>>>>>>>   // **WvA: Augmented to store the current date-value before any changes are made
42782>>>>>>>>>>>>>>>>>   Procedure Entering returns Integer
42783>>>>>>>>>>>>>>>>>      Integer iRetVal
42784>>>>>>>>>>>>>>>>>      Date    dOriginal
42784>>>>>>>>>>>>>>>>>      Forward Get Msg_Entering to iRetVal
42786>>>>>>>>>>>>>>>>>      If (iRetVal = 0) Begin
42788>>>>>>>>>>>>>>>>>         Send DoStoreOriginalDate
42789>>>>>>>>>>>>>>>>>      End
42789>>>>>>>>>>>>>>>>>>
42789>>>>>>>>>>>>>>>>>      Procedure_Return iRetVal
42790>>>>>>>>>>>>>>>>>   End_Procedure // Entering
42791>>>>>>>>>>>>>>>>>
42791>>>>>>>>>>>>>>>>>   //**WvA: This procedure is augmented to see if the user entered a 1 or 2 digit
42791>>>>>>>>>>>>>>>>>   //       value with the intention to only change the day-part of the current date.
42791>>>>>>>>>>>>>>>>>   Procedure Next
42792>>>>>>>>>>>>>>>>>      Send DoIntelliSenseDate
42793>>>>>>>>>>>>>>>>>      Forward Send Next
42795>>>>>>>>>>>>>>>>>   End_Procedure // Next
42796>>>>>>>>>>>>>>>>>
42796>>>>>>>>>>>>>>>>>   // **WvA: Store the current date-value before any changes are made
42796>>>>>>>>>>>>>>>>>   Procedure DoStoreOriginalDate
42797>>>>>>>>>>>>>>>>>      Date    dOriginal
42798>>>>>>>>>>>>>>>>>      //If (pbIntelliSense_Date_State(Self)) Begin
42798>>>>>>>>>>>>>>>>>         Get Value Item 0 to dOriginal
42799>>>>>>>>>>>>>>>>>         Set pdOriginal_Value to dOriginal
42800>>>>>>>>>>>>>>>>>      //End
42800>>>>>>>>>>>>>>>>>   End_Procedure // DoStoreOriginalDate
42801>>>>>>>>>>>>>>>>>
42801>>>>>>>>>>>>>>>>>   Procedure DoIntelliSenseDate
42802>>>>>>>>>>>>>>>>>      Integer iCurrent iStored iDaysOffSet iSep iDate_Format bChanged iYear
42803>>>>>>>>>>>>>>>>>      Date    dCurrent dOriginal
42803>>>>>>>>>>>>>>>>>      String  sStored  sCurrent sSep sMask
42803>>>>>>>>>>>>>>>>>
42803>>>>>>>>>>>>>>>>>      Get Item_Changed_State Item 0 to bChanged
42804>>>>>>>>>>>>>>>>>      Get pdOriginal_Value to dOriginal
42805>>>>>>>>>>>>>>>>>      If (pbIntelliSense_Date_State(Self) And (bChanged)) Begin
42807>>>>>>>>>>>>>>>>>         If (dOriginal Eq 0) Sysdate4 dOriginal
42810>>>>>>>>>>>>>>>>>
42810>>>>>>>>>>>>>>>>>         // We need the masked value, because the normal value is corrected by the runtime for
42810>>>>>>>>>>>>>>>>>         // USA dates.
42810>>>>>>>>>>>>>>>>>         Get Masked_Value Item 0 to sCurrent // getting a 2 digit entered date to a datavariable results in an error.
42811>>>>>>>>>>>>>>>>>         Move (Replaces(" ",sCurrent,"")) to sCurrent
42812>>>>>>>>>>>>>>>>>         Get_Attribute DF_DATE_SEPARATOR to iSep
42815>>>>>>>>>>>>>>>>>         Move (Character(iSep)) to sSep
42816>>>>>>>>>>>>>>>>>
42816>>>>>>>>>>>>>>>>>         // Although the sep value is "/" in the European date format, the mask seperator is "-".
42816>>>>>>>>>>>>>>>>>         Move (Replaces("-",sCurrent,sSep)) to sCurrent
42817>>>>>>>>>>>>>>>>>         Move (sSep+sSep) to sMask
42818>>>>>>>>>>>>>>>>>
42818>>>>>>>>>>>>>>>>>         // Now check if the user just entered a day or a day and a month.
42818>>>>>>>>>>>>>>>>>         // Something very special is going on here. We are interpreting a string, so the format
42818>>>>>>>>>>>>>>>>>         // will always be the same, even for USA or Military dates. "99//" where 9 can be any number
42818>>>>>>>>>>>>>>>>>         //If ( (length(sCurrent) > 2) And (Right(sCurrent,2) = sMask)  ) Begin
42818>>>>>>>>>>>>>>>>>         If ((length(sCurrent) <= 4) And (Right(sCurrent,2) = sMask)) Begin
42820>>>>>>>>>>>>>>>>>            Move (replace(sMask,sCurrent,"")) to sCurrent
42821>>>>>>>>>>>>>>>>>            Move sCurrent to iCurrent
42822>>>>>>>>>>>>>>>>>            If ((iCurrent >= 1) And (iCurrent <= 31)) Begin
42824>>>>>>>>>>>>>>>>>               Get_Attribute DF_DATE_FORMAT to iDate_Format
42827>>>>>>>>>>>>>>>>>               If (iDate_Format = DF_DATE_USA) Begin
42829>>>>>>>>>>>>>>>>>                  Move (Mid( String(dOriginal),2,4)) to iDaysOffSet
42830>>>>>>>>>>>>>>>>>               End
42830>>>>>>>>>>>>>>>>>>
42830>>>>>>>>>>>>>>>>>               Else If (iDate_Format = DF_DATE_EUROPEAN) Begin
42833>>>>>>>>>>>>>>>>>                  Move (Left( String(dOriginal),2 )) to iDaysOffSet
42834>>>>>>>>>>>>>>>>>               End
42834>>>>>>>>>>>>>>>>>>
42834>>>>>>>>>>>>>>>>>               Else If (iDate_Format = DF_DATE_MILITARY) Begin
42837>>>>>>>>>>>>>>>>>                  Move (Right( String(dOriginal),2 )) to iDaysOffSet
42838>>>>>>>>>>>>>>>>>               End
42838>>>>>>>>>>>>>>>>>>
42838>>>>>>>>>>>>>>>>>               Set Value Item 0 to (Date(dOriginal - iDaysOffSet + iCurrent))
42839>>>>>>>>>>>>>>>>>            End // Let the runtime handle the error if value not in the range 1..31
42839>>>>>>>>>>>>>>>>>>
42839>>>>>>>>>>>>>>>>>         End
42839>>>>>>>>>>>>>>>>>>
42839>>>>>>>>>>>>>>>>>         Else If ((length(sCurrent) > 4) And (Right(sCurrent,1) = sSep)) Begin
42842>>>>>>>>>>>>>>>>>            Get_Attribute DF_DATE_FORMAT to iDate_Format
42845>>>>>>>>>>>>>>>>>            If ((iDate_Format = DF_DATE_USA) Or (iDate_Format = DF_DATE_EUROPEAN)) Begin
42847>>>>>>>>>>>>>>>>>               Move (Right(dOriginal,4)) to iYear
42848>>>>>>>>>>>>>>>>>            End
42848>>>>>>>>>>>>>>>>>>
42848>>>>>>>>>>>>>>>>>            Else If (iDate_Format = DF_DATE_MILITARY) Begin
42851>>>>>>>>>>>>>>>>>               Move (Left(dOriginal,4))  to iYear
42852>>>>>>>>>>>>>>>>>            End
42852>>>>>>>>>>>>>>>>>>
42852>>>>>>>>>>>>>>>>>            Set Value Item 0 to (Date(sCurrent + String(iYear)))
42853>>>>>>>>>>>>>>>>>         End
42853>>>>>>>>>>>>>>>>>>
42853>>>>>>>>>>>>>>>>>      End
42853>>>>>>>>>>>>>>>>>>
42853>>>>>>>>>>>>>>>>>   End_Procedure // DoIntelliSenseDate
42854>>>>>>>>>>>>>>>>>
42854>>>>>>>>>>>>>>>>>   Procedure Key Integer iKey Returns Integer
42855>>>>>>>>>>>>>>>>>      Date dToday dTemp
42856>>>>>>>>>>>>>>>>>      Sysdate4 dToday
42857>>>>>>>>>>>>>>>>>
42857>>>>>>>>>>>>>>>>>      If ((Character(iKey) EQ cDateToday) OR (Character(iKey) EQ Lowercase(cDateToday))) Begin
42859>>>>>>>>>>>>>>>>>         Set Value to dToday
42860>>>>>>>>>>>>>>>>>      End
42860>>>>>>>>>>>>>>>>>>
42860>>>>>>>>>>>>>>>>>      Else If ((Character(iKey) EQ cDateBeginOfMonth) OR (Character(iKey) EQ Lowercase(cDateBeginOfMonth))) Begin
42863>>>>>>>>>>>>>>>>>         Get FirstDayInMonth dToday to dTemp
42864>>>>>>>>>>>>>>>>>         Set Value to dTemp
42865>>>>>>>>>>>>>>>>>      End
42865>>>>>>>>>>>>>>>>>>
42865>>>>>>>>>>>>>>>>>      Else If ((Character(iKey) EQ cDateEndOfMonth) OR (Character(iKey) EQ Lowercase(cDateEndOfMonth))) Begin
42868>>>>>>>>>>>>>>>>>         Get LastDayInMonth dToday to dTemp
42869>>>>>>>>>>>>>>>>>         Set Value to dTemp
42870>>>>>>>>>>>>>>>>>      End
42870>>>>>>>>>>>>>>>>>>
42870>>>>>>>>>>>>>>>>>      Else Forward Send Key iKey
42873>>>>>>>>>>>>>>>>>   End_procedure
42874>>>>>>>>>>>>>>>>>
42874>>>>>>>>>>>>>>>>>End_Class // cSyIntelliSense_Date_Mixin
42875>>>>>>>>>>>>>>>
42875>>>>>>>>>>>>>>>Class cSyDateForm Is A FormSub
42876>>>>>>>>>>>>>>>   Procedure Construct_Object
42877>>>>>>>>>>>>>>>      Forward Send Construct_Object
42879>>>>>>>>>>>>>>>
42879>>>>>>>>>>>>>>>      Set Prompt_Button_Mode   to PB_PromptOn
42880>>>>>>>>>>>>>>>      Set Form_Datatype Item 0 to Mask_Date_Window
42881>>>>>>>>>>>>>>>
42881>>>>>>>>>>>>>>>      Send DoDefineIntelliSenseDateMixin
42882>>>>>>>>>>>>>>>
42882>>>>>>>>>>>>>>>      On_Key kPrompt Send Prompt
42883>>>>>>>>>>>>>>>
42883>>>>>>>>>>>>>>>      Set Prompt_Object to (oCalendar(Self))
42884>>>>>>>>>>>>>>>      Set Status_Help   to cStatusHelp
42885>>>>>>>>>>>>>>>
42885>>>>>>>>>>>>>>>   End_Procedure // Construct_Object
42886>>>>>>>>>>>>>>>
42886>>>>>>>>>>>>>>>   Import_Class_Protocol cSyIntelliSense_Date_Mixin
42887>>>>>>>>>>>>>>>
42887>>>>>>>>>>>>>>>//   Function Form_Datatype Integer iItem Returns Integer
42887>>>>>>>>>>>>>>>//      Integer iDatatype
42887>>>>>>>>>>>>>>>//
42887>>>>>>>>>>>>>>>//      If (iItem = Current) Begin
42887>>>>>>>>>>>>>>>//         Get Current_Item to iItem
42887>>>>>>>>>>>>>>>//      End
42887>>>>>>>>>>>>>>>//
42887>>>>>>>>>>>>>>>//      Forward Get Form_Datatype Item iItem to iDataType
42887>>>>>>>>>>>>>>>//
42887>>>>>>>>>>>>>>>//      Function_Return iDatatype
42887>>>>>>>>>>>>>>>//   End_Function // Form_Datatype
42887>>>>>>>>>>>>>>>
42887>>>>>>>>>>>>>>>End_Class // cSyDateForm
42888>>>>>>>>>>>>>Use Form.Sub
42888>>>>>>>>>>>>>Use Txtbox.Sub
42888>>>>>>>>>>>>>Use Button.Sub
42888>>>>>>>>>>>>>
42888>>>>>>>>>>>>>
42888>>>>>>>>>>>>>Use CTYPKIN.DD
42888>>>>>>>>>>>>>Use WTYPKIN.DD
42888>>>>>>>>>>>>>Use PTYPPAR.DD
42888>>>>>>>>>>>>>Use CLIENTS.DD
42888>>>>>>>>>>>>>Use NOMISMA.DD
42888>>>>>>>>>>>>>Use PARTICLE.DD
42888>>>>>>>>>>>>>
42888>>>>>>>>>>>>>//AB-IgnoreEnd
42888>>>>>>>>>>>>>
42888>>>>>>>>>>>>>Object sl014 is a dbModalPanelSub
42890>>>>>>>>>>>>>
42890>>>>>>>>>>>>>    //AB-StoreTopStart
42890>>>>>>>>>>>>>                                
42890>>>>>>>>>>>>>    Property String psModule        Public ''
42892>>>>>>>>>>>>>    Property String psClient        Public ''
42894>>>>>>>>>>>>>    Property String psPtyppar       Public ''
42896>>>>>>>>>>>>>    Property String psCtypkin       Public ''
42898>>>>>>>>>>>>>    Property String psWtypkin       Public ''
42900>>>>>>>>>>>>>    Property String psPtypparRecr   Public ''
42902>>>>>>>>>>>>>    Property Integer Pino           Public 0
42904>>>>>>>>>>>>>    Property Date   pdHmnia         Public ''
42906>>>>>>>>>>>>>    
42906>>>>>>>>>>>>>    //AB-StoreTopEnd
42906>>>>>>>>>>>>>
42906>>>>>>>>>>>>>    Set Label to "˜¨˜©«˜« ¡á"
42907>>>>>>>>>>>>>    Set Size to 294 523
42908>>>>>>>>>>>>>    Set Location to 0 3
42909>>>>>>>>>>>>>    Set Color to 12363657
42910>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
42911>>>>>>>>>>>>>    Set Modal_State to FALSE
42912>>>>>>>>>>>>>
42912>>>>>>>>>>>>>    //AB-DDOStart
42912>>>>>>>>>>>>>
42912>>>>>>>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
42914>>>>>>>>>>>>>    End_Object    // Ctypkin_DD
42915>>>>>>>>>>>>>
42915>>>>>>>>>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
42917>>>>>>>>>>>>>    End_Object    // Wtypkin_DD
42918>>>>>>>>>>>>>
42918>>>>>>>>>>>>>    Object Ptyppar_DD is a Ptyppar_DataDictionary
42920>>>>>>>>>>>>>        Set DDO_Server to (Ctypkin_DD(self))
42921>>>>>>>>>>>>>        Set DDO_Server to (Wtypkin_DD(self))
42922>>>>>>>>>>>>>    End_Object    // Ptyppar_DD
42923>>>>>>>>>>>>>
42923>>>>>>>>>>>>>    Object Clients_DD is a Clients_DataDictionary
42925>>>>>>>>>>>>>    End_Object    // Clients_DD
42926>>>>>>>>>>>>>
42926>>>>>>>>>>>>>    Object Nomisma_DD is a Nomisma_DataDictionary
42928>>>>>>>>>>>>>    End_Object    // Nomisma_DD
42929>>>>>>>>>>>>>
42929>>>>>>>>>>>>>    Object Particle_DD is a Particle_DataDictionary
42931>>>>>>>>>>>>>        Set DDO_Server to (Clients_DD(self))
42932>>>>>>>>>>>>>        Set DDO_Server to (Ptyppar_DD(self))
42933>>>>>>>>>>>>>        Set DDO_Server to (Nomisma_DD(self))
42934>>>>>>>>>>>>>
42934>>>>>>>>>>>>>        //AB-StoreStart
42934>>>>>>>>>>>>>                                                        
42934>>>>>>>>>>>>>        Procedure OnConstrain
42936>>>>>>>>>>>>>            String  sPtyppar sWtypkin sCtypkin sClientID sPtypparRecr
42937>>>>>>>>>>>>>            Date    dHmnia
42937>>>>>>>>>>>>>            Integer Ino
42937>>>>>>>>>>>>>            Get psClient        to sClientID
42938>>>>>>>>>>>>>            Get psPtyppar       to sPtyppar
42939>>>>>>>>>>>>>            Get psPtypparRecr   to sPtypparRecr
42940>>>>>>>>>>>>>            Get psCtypkin       to sCtypkin
42941>>>>>>>>>>>>>            Get psWtypkin       to sWtypkin
42942>>>>>>>>>>>>>            Get Value Of cSyDateForm1 Item 0 to dHmnia
42943>>>>>>>>>>>>>            get Pino            to Ino
42944>>>>>>>>>>>>>            If (sClientID<>'') Begin
42946>>>>>>>>>>>>>                If (sPtypparRecr<>'') Begin
42948>>>>>>>>>>>>>                    Set Ordering to 1
42949>>>>>>>>>>>>>                    Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
42951>>>>>>>>>>>>>                    Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
42953>>>>>>>>>>>>>                    Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
42955>>>>>>>>>>>>>                    Constrain Particle.CustProm_Code    Eq ''
42957>>>>>>>>>>>>>                    Constrain Particle.Client_ID        Eq sClientID
42959>>>>>>>>>>>>>                    Constrain Particle.Ctypkin_Code     Eq sCtypkin
42961>>>>>>>>>>>>>                    Constrain Particle.Wtypkin_Code     Eq sWtypkin
42963>>>>>>>>>>>>>                    Constrain Particle.Ptyppar_Code     Eq sPtyppar
42965>>>>>>>>>>>>>                    If (dHmnia<>'') ;                        Constrain Particle.Partl_Hmnia  Eq dHmnia
42969>>>>>>>>>>>>>                    If (Ino<>0) ;                        Constrain Particle.Partl_no     Eq Ino
42973>>>>>>>>>>>>>                End
42973>>>>>>>>>>>>>>
42973>>>>>>>>>>>>>                Else Begin
42974>>>>>>>>>>>>>                    Set Ordering to 13
42975>>>>>>>>>>>>>                    Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
42977>>>>>>>>>>>>>                    Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
42979>>>>>>>>>>>>>                    Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
42981>>>>>>>>>>>>>                    Constrain Particle.Client_ID        Eq sClientID
42983>>>>>>>>>>>>>                    If (dHmnia<>'') ;                        Constrain Particle.Partl_Hmnia  Eq dHmnia
42987>>>>>>>>>>>>>                    If (Ino<>0) ;                        Constrain Particle.Partl_no     Eq Ino
42991>>>>>>>>>>>>>                End
42991>>>>>>>>>>>>>>
42991>>>>>>>>>>>>>            End
42991>>>>>>>>>>>>>>
42991>>>>>>>>>>>>>            Else If (sPtypparRecr<>'') Begin
42994>>>>>>>>>>>>>                Set Ordering to 12
42995>>>>>>>>>>>>>                Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
42997>>>>>>>>>>>>>                Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
42999>>>>>>>>>>>>>                Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
43001>>>>>>>>>>>>>                Constrain Particle.Partl_Module     Eq (psModule(Self))
43003>>>>>>>>>>>>>                Constrain Particle.Ptyppar_Recr     Eq sPtypparRecr
43005>>>>>>>>>>>>>                If (dHmnia<>'') ;                    Constrain Particle.Partl_Hmnia  Eq dHmnia
43009>>>>>>>>>>>>>                If (Ino<>0) ;                    Constrain Particle.Partl_no     Eq Ino
43013>>>>>>>>>>>>>            End
43013>>>>>>>>>>>>>>
43013>>>>>>>>>>>>>            Else  Begin
43014>>>>>>>>>>>>>                Set Ordering to 14
43015>>>>>>>>>>>>>                Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
43017>>>>>>>>>>>>>                Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
43019>>>>>>>>>>>>>                Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
43021>>>>>>>>>>>>>                Constrain Particle.Partl_Module     Eq (psModule(Self))
43023>>>>>>>>>>>>>                If (dHmnia<>'') ;                    Constrain Particle.Partl_Hmnia  Eq dHmnia
43027>>>>>>>>>>>>>                If (Ino<>0) ;                    Constrain Particle.Partl_no     Eq Ino
43031>>>>>>>>>>>>>            End
43031>>>>>>>>>>>>>>
43031>>>>>>>>>>>>>        
43031>>>>>>>>>>>>>        End_Procedure
43032>>>>>>>>>>>>>        
43032>>>>>>>>>>>>>        
43032>>>>>>>>>>>>>        
43032>>>>>>>>>>>>>        
43032>>>>>>>>>>>>>        
43032>>>>>>>>>>>>>        
43032>>>>>>>>>>>>>        
43032>>>>>>>>>>>>>        
43032>>>>>>>>>>>>>        
43032>>>>>>>>>>>>>        
43032>>>>>>>>>>>>>        
43032>>>>>>>>>>>>>        
43032>>>>>>>>>>>>>        
43032>>>>>>>>>>>>>        
43032>>>>>>>>>>>>>        
43032>>>>>>>>>>>>>        
43032>>>>>>>>>>>>>        
43032>>>>>>>>>>>>>        //AB-StoreEnd
43032>>>>>>>>>>>>>
43032>>>>>>>>>>>>>    End_Object    // Particle_DD
43033>>>>>>>>>>>>>
43033>>>>>>>>>>>>>    Set Main_DD to (Particle_DD(self))
43034>>>>>>>>>>>>>    Set Server to (Particle_DD(self))
43035>>>>>>>>>>>>>
43035>>>>>>>>>>>>>    //AB-DDOEnd
43035>>>>>>>>>>>>>
43035>>>>>>>>>>>>>    Object oSelList is a dbListSub
43037>>>>>>>>>>>>>        Set Main_File to Particle.File_Number
43038>>>>>>>>>>>>>        Set Size to 208 511
43039>>>>>>>>>>>>>        Set Location to 6 5
43040>>>>>>>>>>>>>        Set Auto_Index_State to FALSE
43041>>>>>>>>>>>>>
43041>>>>>>>>>>>>>        Begin_Row
43044>>>>>>>>>>>>>            Entry_Item Particle.Partl_hmnia
43045>>>>>>>>>>>>>            Entry_Item Ptyppar.Ptyppar_descr
43046>>>>>>>>>>>>>            Entry_Item Particle.Pseira_seira
43047>>>>>>>>>>>>>            Entry_Item Particle.Partl_no
43048>>>>>>>>>>>>>            Entry_Item Clients.Client_id
43049>>>>>>>>>>>>>            Entry_Item Clients.Client_name
43050>>>>>>>>>>>>>            Entry_Item Particle.Partl_payam
43051>>>>>>>>>>>>>            Entry_Item Particle.Partl_ekleise
43052>>>>>>>>>>>>>        End_Row
43057>>>>>>>>>>>>>
43057>>>>>>>>>>>>>        Set Form_Width    item 0 to 55
43058>>>>>>>>>>>>>        Set Header_Label  item 0 to "†£œ¨/¤å˜"
43059>>>>>>>>>>>>>        
43059>>>>>>>>>>>>>        Set Form_Width    item 1 to 100
43060>>>>>>>>>>>>>        Set Header_Label  item 1 to "˜¨˜©«˜« ¡æ"
43061>>>>>>>>>>>>>        
43061>>>>>>>>>>>>>        Set Form_Width    item 2 to 36
43062>>>>>>>>>>>>>        Set Header_Label  item 2 to "‘œ ¨á"
43063>>>>>>>>>>>>>        
43063>>>>>>>>>>>>>        Set Form_Width    item 3 to 55
43064>>>>>>>>>>>>>        Set Header_Label  item 3 to "€¨ Ÿ£æª"
43065>>>>>>>>>>>>>        
43065>>>>>>>>>>>>>        Set Form_Width    item 4 to 57
43066>>>>>>>>>>>>>        Set Header_Label  item 4 to "‰à› ¡æª"
43067>>>>>>>>>>>>>        
43067>>>>>>>>>>>>>        Set Form_Width    item 5 to 140
43068>>>>>>>>>>>>>        Set Header_Label  item 5 to "œ¢á«žª / ¨¦£žŸœ¬«ãª"
43069>>>>>>>>>>>>>        
43069>>>>>>>>>>>>>        Set Form_Width    item 6 to 48
43070>>>>>>>>>>>>>        Set Header_Label  item 6 to "€¥å˜"
43071>>>>>>>>>>>>>        
43071>>>>>>>>>>>>>        Set Form_Width    item 7 to 16
43072>>>>>>>>>>>>>        Set Header_Label  item 7 to "K"
43073>>>>>>>>>>>>>        Set Column_Checkbox_State  item 7 to True
43074>>>>>>>>>>>>>        
43074>>>>>>>>>>>>>
43074>>>>>>>>>>>>>        //AB-StoreStart
43074>>>>>>>>>>>>>        Set Column_Option       Item  1 to NoEnter  True
43075>>>>>>>>>>>>>        Procedure End_Construct_Object
43077>>>>>>>>>>>>>            Integer iDecimals
43078>>>>>>>>>>>>>            Forward Send End_Construct_Object
43080>>>>>>>>>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0   to    iDecimals
43081>>>>>>>>>>>>>            Set Points Item 6 to iDecimals
43082>>>>>>>>>>>>>            Set Numeric_Mask Item 6 to 14 iDecimals ' ,*'
43083>>>>>>>>>>>>>        End_Procedure
43084>>>>>>>>>>>>>        
43084>>>>>>>>>>>>>        
43084>>>>>>>>>>>>>        Procedure Activate
43086>>>>>>>>>>>>>            Send Keyaction to ButtonSub1
43087>>>>>>>>>>>>>            Forward Send Activate
43089>>>>>>>>>>>>>        End_procedure
43090>>>>>>>>>>>>>        
43090>>>>>>>>>>>>>        Procedure Activating
43092>>>>>>>>>>>>>            Forward Send Activating
43094>>>>>>>>>>>>>            Set Auto_Index_State to True
43095>>>>>>>>>>>>>        End_Procedure
43096>>>>>>>>>>>>>        
43096>>>>>>>>>>>>>        
43096>>>>>>>>>>>>>        
43096>>>>>>>>>>>>>        
43096>>>>>>>>>>>>>        //AB-StoreEnd
43096>>>>>>>>>>>>>
43096>>>>>>>>>>>>>    End_Object    // oSelList
43097>>>>>>>>>>>>>
43097>>>>>>>>>>>>>    Object cSyDateForm1 is a cSyDateForm
43099>>>>>>>>>>>>>        Set Size to 13 85
43100>>>>>>>>>>>>>        Set Location to 222 54
43101>>>>>>>>>>>>>        Set Label_Col_Offset to 2
43102>>>>>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
43103>>>>>>>>>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
43104>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43105>>>>>>>>>>>>>
43105>>>>>>>>>>>>>        //AB-StoreStart
43105>>>>>>>>>>>>>                                                                                                        
43105>>>>>>>>>>>>>        Procedure Key Integer iKey
43107>>>>>>>>>>>>>            Integer iRetVal
43108>>>>>>>>>>>>>            Forward Send Key iKey
43110>>>>>>>>>>>>>            If (iKey=277) Begin
43112>>>>>>>>>>>>>                Send Clear_Me
43113>>>>>>>>>>>>>            End
43113>>>>>>>>>>>>>>
43113>>>>>>>>>>>>>        End_Procedure
43114>>>>>>>>>>>>>        
43114>>>>>>>>>>>>>        Procedure Clear_Me
43116>>>>>>>>>>>>>            Set Value Item 0 to ''
43117>>>>>>>>>>>>>            Send KeyAction to ButtonSub1
43118>>>>>>>>>>>>>        End_Procedure
43119>>>>>>>>>>>>>        
43119>>>>>>>>>>>>>        Procedure Exiting00000
43121>>>>>>>>>>>>>            Forward Send Exiting
43123>>>>>>>>>>>>>            Send KeyAction to ButtonSub1
43124>>>>>>>>>>>>>        End_procedure
43125>>>>>>>>>>>>>        
43125>>>>>>>>>>>>>        
43125>>>>>>>>>>>>>        
43125>>>>>>>>>>>>>        //AB-StoreEnd
43125>>>>>>>>>>>>>
43125>>>>>>>>>>>>>    End_Object    // cSyDateForm1
43126>>>>>>>>>>>>>
43126>>>>>>>>>>>>>    Object FormSub1 is a FormSub
43128>>>>>>>>>>>>>        Set Size to 13 85
43129>>>>>>>>>>>>>        Set Location to 236 54
43130>>>>>>>>>>>>>        Set Label_Col_Offset to 2
43131>>>>>>>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
43132>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43133>>>>>>>>>>>>>
43133>>>>>>>>>>>>>        //AB-StoreStart
43133>>>>>>>>>>>>>                                                                                                
43133>>>>>>>>>>>>>        Set Prompt_Object to (sl012(Self))
43134>>>>>>>>>>>>>        
43134>>>>>>>>>>>>>        Procedure Prompt
43136>>>>>>>>>>>>>            String sModule
43137>>>>>>>>>>>>>            Get psModule Of (sl012(Self)) to sModule
43138>>>>>>>>>>>>>            Set psModule Of (sl012(Self)) to (psModule(Self))
43139>>>>>>>>>>>>>            Forward Send Prompt
43141>>>>>>>>>>>>>            Set psModule Of (sl012(Self)) to sModule
43142>>>>>>>>>>>>>        End_Procedure
43143>>>>>>>>>>>>>        
43143>>>>>>>>>>>>>        Procedure OnChange
43145>>>>>>>>>>>>>            String s1
43146>>>>>>>>>>>>>            Get Value Item 0 to s1
43147>>>>>>>>>>>>>            Set Value Of FormSub3 Item 0 to (fsPtyppar(Self,s1))
43148>>>>>>>>>>>>>            Clear Ptypparl
43149>>>>>>>>>>>>>            Move Syscurxr.Company_Code  to ptypparl.Company_Code
43150>>>>>>>>>>>>>            Move Syscurxr.Branch_Code   to ptypparl.Branch_Code
43151>>>>>>>>>>>>>            Move s1                     to Ptypparl.Ptyppar_Code
43152>>>>>>>>>>>>>            Find Eq Ptypparl by index.1
43153>>>>>>>>>>>>>>
43153>>>>>>>>>>>>>            Set psPtyppar       to s1
43154>>>>>>>>>>>>>            Set psPtypparRecr   to Ptypparl.Ptyppar_Recr
43155>>>>>>>>>>>>>            Set psWtypkin       to PtypparL.Wtypkin_Code
43156>>>>>>>>>>>>>            Set psCtypkin       to PtypparL.Ctypkin_Code
43157>>>>>>>>>>>>>        End_Procedure
43158>>>>>>>>>>>>>        
43158>>>>>>>>>>>>>        
43158>>>>>>>>>>>>>        
43158>>>>>>>>>>>>>        
43158>>>>>>>>>>>>>        
43158>>>>>>>>>>>>>        
43158>>>>>>>>>>>>>        
43158>>>>>>>>>>>>>        //AB-StoreEnd
43158>>>>>>>>>>>>>
43158>>>>>>>>>>>>>    End_Object    // FormSub1
43159>>>>>>>>>>>>>
43159>>>>>>>>>>>>>    Object FormSub3 is a FormSub
43161>>>>>>>>>>>>>        Set Size to 13 195
43162>>>>>>>>>>>>>        Set Location to 236 145
43163>>>>>>>>>>>>>        Set Color to 12363657
43164>>>>>>>>>>>>>        Set Label_Col_Offset to 2
43165>>>>>>>>>>>>>        Set Enabled_State to FALSE
43166>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43167>>>>>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
43168>>>>>>>>>>>>>        Set Shadow_State Item 0 to TRUE
43169>>>>>>>>>>>>>    End_Object    // FormSub3
43170>>>>>>>>>>>>>
43170>>>>>>>>>>>>>    Object FormSub2 is a FormSub
43172>>>>>>>>>>>>>        Set Size to 13 85
43173>>>>>>>>>>>>>        Set Location to 250 54
43174>>>>>>>>>>>>>        Set Label_Col_Offset to 2
43175>>>>>>>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
43176>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43177>>>>>>>>>>>>>
43177>>>>>>>>>>>>>        //AB-StoreStart
43177>>>>>>>>>>>>>                                                                                                
43177>>>>>>>>>>>>>        Set Prompt_Object to (sl100(Self))
43178>>>>>>>>>>>>>        
43178>>>>>>>>>>>>>        Procedure Prompt
43180>>>>>>>>>>>>>            String sModule
43181>>>>>>>>>>>>>            Get psModule Of (sl100(Self)) to sModule
43182>>>>>>>>>>>>>            Set psModule Of (sl100(Self)) to (psModule(Self))
43183>>>>>>>>>>>>>            Forward Send Prompt
43185>>>>>>>>>>>>>            Set psModule Of (sl100(Self)) to sModule
43186>>>>>>>>>>>>>        End_Procedure
43187>>>>>>>>>>>>>        
43187>>>>>>>>>>>>>        Procedure OnChange
43189>>>>>>>>>>>>>            String s1
43190>>>>>>>>>>>>>            Get Value Item 0 to s1
43191>>>>>>>>>>>>>            Set Value Of FormSub4 Item 0 to (fsClient(Self,s1))
43192>>>>>>>>>>>>>            Set psClient to s1
43193>>>>>>>>>>>>>        End_Procedure
43194>>>>>>>>>>>>>        
43194>>>>>>>>>>>>>        
43194>>>>>>>>>>>>>        
43194>>>>>>>>>>>>>        
43194>>>>>>>>>>>>>        
43194>>>>>>>>>>>>>        
43194>>>>>>>>>>>>>        
43194>>>>>>>>>>>>>        //AB-StoreEnd
43194>>>>>>>>>>>>>
43194>>>>>>>>>>>>>    End_Object    // FormSub2
43195>>>>>>>>>>>>>
43195>>>>>>>>>>>>>    Object FormSub4 is a FormSub
43197>>>>>>>>>>>>>        Set Size to 13 195
43198>>>>>>>>>>>>>        Set Location to 250 145
43199>>>>>>>>>>>>>        Set Color to 12363657
43200>>>>>>>>>>>>>        Set Label_Col_Offset to 2
43201>>>>>>>>>>>>>        Set Enabled_State to FALSE
43202>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43203>>>>>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
43204>>>>>>>>>>>>>        Set Shadow_State Item 0 to TRUE
43205>>>>>>>>>>>>>    End_Object    // FormSub4
43206>>>>>>>>>>>>>
43206>>>>>>>>>>>>>    Object FormSub5 is a FormSub
43208>>>>>>>>>>>>>        Set Size to 13 85
43209>>>>>>>>>>>>>        Set Location to 263 54
43210>>>>>>>>>>>>>        Set Label_Col_Offset to 2
43211>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43212>>>>>>>>>>>>>
43212>>>>>>>>>>>>>        //AB-StoreStart
43212>>>>>>>>>>>>>        Procedure OnChange
43214>>>>>>>>>>>>>            integer ino
43215>>>>>>>>>>>>>            Get Value Item 0 to ino
43216>>>>>>>>>>>>>            Set pino to ino
43217>>>>>>>>>>>>>        End_Procedure
43218>>>>>>>>>>>>>        
43218>>>>>>>>>>>>>        
43218>>>>>>>>>>>>>        
43218>>>>>>>>>>>>>        
43218>>>>>>>>>>>>>        
43218>>>>>>>>>>>>>        
43218>>>>>>>>>>>>>        
43218>>>>>>>>>>>>>        
43218>>>>>>>>>>>>>        
43218>>>>>>>>>>>>>        
43218>>>>>>>>>>>>>        
43218>>>>>>>>>>>>>        //AB-StoreEnd
43218>>>>>>>>>>>>>
43218>>>>>>>>>>>>>    End_Object    // FormSub5
43219>>>>>>>>>>>>>
43219>>>>>>>>>>>>>    Object TextBoxSub1 is a TextBoxSub
43221>>>>>>>>>>>>>        Set Label to "†£œ¨/¤å˜"
43222>>>>>>>>>>>>>        Set Color to 12363657
43223>>>>>>>>>>>>>        Set Location to 222 5
43224>>>>>>>>>>>>>        Set Size to 10 35
43225>>>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
43226>>>>>>>>>>>>>    End_Object    // TextBoxSub1
43227>>>>>>>>>>>>>
43227>>>>>>>>>>>>>    Object TextBoxSub2 is a TextBoxSub
43229>>>>>>>>>>>>>        Set Label to "˜¨˜©«/¡æ"
43230>>>>>>>>>>>>>        Set Color to 12363657
43231>>>>>>>>>>>>>        Set Location to 237 4
43232>>>>>>>>>>>>>        Set Size to 10 41
43233>>>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
43234>>>>>>>>>>>>>    End_Object    // TextBoxSub2
43235>>>>>>>>>>>>>
43235>>>>>>>>>>>>>    Object TextBoxSub3 is a TextBoxSub
43237>>>>>>>>>>>>>        Set Label to "”¦¨â˜ª"
43238>>>>>>>>>>>>>        Set Color to 12363657
43239>>>>>>>>>>>>>        Set Location to 252 4
43240>>>>>>>>>>>>>        Set Size to 10 31
43241>>>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
43242>>>>>>>>>>>>>    End_Object    // TextBoxSub3
43243>>>>>>>>>>>>>
43243>>>>>>>>>>>>>    Object ButtonSub1 is a ButtonSub
43245>>>>>>>>>>>>>        Set Label to "œ¨ æ¨ ©œ"
43246>>>>>>>>>>>>>        Set Size to 13 50
43247>>>>>>>>>>>>>        Set Location to 252 355
43248>>>>>>>>>>>>>        Set Form_FontWeight Item 0 to 600
43249>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43250>>>>>>>>>>>>>
43250>>>>>>>>>>>>>        //AB-StoreStart
43250>>>>>>>>>>>>>                
43250>>>>>>>>>>>>>        Procedure OnClick
43252>>>>>>>>>>>>>            Send Rebuild_Constraints to Particle_DD
43253>>>>>>>>>>>>>            Send Beginning_Of_Data to oSelList True
43254>>>>>>>>>>>>>        End_Procedure // OnClick
43255>>>>>>>>>>>>>        
43255>>>>>>>>>>>>>        
43255>>>>>>>>>>>>>        
43255>>>>>>>>>>>>>        
43255>>>>>>>>>>>>>        
43255>>>>>>>>>>>>>        //AB-StoreEnd
43255>>>>>>>>>>>>>
43255>>>>>>>>>>>>>    End_Object    // ButtonSub1
43256>>>>>>>>>>>>>
43256>>>>>>>>>>>>>    Object oOk_bn is a ButtonSub
43258>>>>>>>>>>>>>
43258>>>>>>>>>>>>>        //AB-StoreTopStart
43258>>>>>>>>>>>>>                
43258>>>>>>>>>>>>>        //AB-StoreTopEnd
43258>>>>>>>>>>>>>
43258>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
43259>>>>>>>>>>>>>        Set Location to 252 412
43260>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43261>>>>>>>>>>>>>
43261>>>>>>>>>>>>>        //AB-StoreStart
43261>>>>>>>>>>>>>                
43261>>>>>>>>>>>>>        Procedure OnClick
43263>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
43264>>>>>>>>>>>>>        End_Procedure
43265>>>>>>>>>>>>>        
43265>>>>>>>>>>>>>        //AB-StoreEnd
43265>>>>>>>>>>>>>
43265>>>>>>>>>>>>>    End_Object    // oOk_bn
43266>>>>>>>>>>>>>
43266>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
43268>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
43269>>>>>>>>>>>>>        Set Size to 13 50
43270>>>>>>>>>>>>>        Set Location to 252 466
43271>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43272>>>>>>>>>>>>>
43272>>>>>>>>>>>>>        //AB-StoreStart
43272>>>>>>>>>>>>>        Procedure OnClick
43274>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
43275>>>>>>>>>>>>>        End_Procedure
43276>>>>>>>>>>>>>        //AB-StoreEnd
43276>>>>>>>>>>>>>
43276>>>>>>>>>>>>>    End_Object    // oSearch_bn
43277>>>>>>>>>>>>>
43277>>>>>>>>>>>>>    Object TextBoxSub4 is a TextBoxSub
43279>>>>>>>>>>>>>        Set Label to "€¨ Ÿ£æª"
43280>>>>>>>>>>>>>        Set Color to 12363657
43281>>>>>>>>>>>>>        Set Location to 265 4
43282>>>>>>>>>>>>>        Set Size to 10 31
43283>>>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
43284>>>>>>>>>>>>>    End_Object    // TextBoxSub4
43285>>>>>>>>>>>>>
43285>>>>>>>>>>>>>
43285>>>>>>>>>>>>>    //AB-StoreStart
43285>>>>>>>>>>>>>                                
43285>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
43286>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
43287>>>>>>>>>>>>>    
43287>>>>>>>>>>>>>    Set Locate_Mode to Center_On_Screen
43288>>>>>>>>>>>>>    Set Modal_State to True
43289>>>>>>>>>>>>>    
43289>>>>>>>>>>>>>    Procedure Request_Cancel
43291>>>>>>>>>>>>>        Set Value Of cSyDateForm1 Item 0 to ''
43292>>>>>>>>>>>>>        Send Clear to Particle_DD
43293>>>>>>>>>>>>>        Forward Send Request_Cancel
43295>>>>>>>>>>>>>    End_Procedure
43296>>>>>>>>>>>>>    
43296>>>>>>>>>>>>>    
43296>>>>>>>>>>>>>    
43296>>>>>>>>>>>>>    
43296>>>>>>>>>>>>>    
43296>>>>>>>>>>>>>    
43296>>>>>>>>>>>>>    
43296>>>>>>>>>>>>>    
43296>>>>>>>>>>>>>    
43296>>>>>>>>>>>>>    
43296>>>>>>>>>>>>>    
43296>>>>>>>>>>>>>    
43296>>>>>>>>>>>>>    
43296>>>>>>>>>>>>>    
43296>>>>>>>>>>>>>    
43296>>>>>>>>>>>>>    
43296>>>>>>>>>>>>>    
43296>>>>>>>>>>>>>    
43296>>>>>>>>>>>>>    
43296>>>>>>>>>>>>>    
43296>>>>>>>>>>>>>    //AB-StoreEnd
43296>>>>>>>>>>>>>
43296>>>>>>>>>>>>>End_Object    // sl014
43297>>>>>>>>>>>>>
43297>>>>>>>>>>>>>
43297>>>>>>>>>>>>>//AB-StoreStart
43297>>>>>>>>>>>>>            
43297>>>>>>>>>>>>>            
43297>>>>>>>>>>>>>//AB-StoreEnd
43297>>>>>>>>>>>>>
43297>>>>>>>>>>>>>//AB/ End_Object    // prj
43297>>>>>>>>>>>Use sl054.SL         // sl054
INCLUDING FILE: SL054.SL
43297>>>>>>>>>>>>>//AB/ Project sl054:cars
43297>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
43297>>>>>>>>>>>>>//AB/     Set ProjectName to "sl054:cars"
43297>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl054.SL"
43297>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
43297>>>>>>>>>>>>>
43297>>>>>>>>>>>>>// Project Object Structure
43297>>>>>>>>>>>>>//   sl054 is a dbModalPanelSub
43297>>>>>>>>>>>>>//     Cars_DD is a DataDictionary
43297>>>>>>>>>>>>>//     oSelList is a dbListSub
43297>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
43297>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
43297>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
43297>>>>>>>>>>>>>
43297>>>>>>>>>>>>>// Register all objects
43297>>>>>>>>>>>>>Register_Object Cars_DD
43297>>>>>>>>>>>>>Register_Object oCancel_bn
43297>>>>>>>>>>>>>Register_Object oOK_bn
43297>>>>>>>>>>>>>Register_Object oSearch_bn
43297>>>>>>>>>>>>>Register_Object oSelList
43297>>>>>>>>>>>>>Register_Object sl054
43297>>>>>>>>>>>>>
43297>>>>>>>>>>>>>
43297>>>>>>>>>>>>>//AB-IgnoreStart
43297>>>>>>>>>>>>>
43297>>>>>>>>>>>>>Use DFAllEnt.pkg
43297>>>>>>>>>>>>>Use dbList.Sub
43297>>>>>>>>>>>>>Use Button.Sub
43297>>>>>>>>>>>>>
43297>>>>>>>>>>>>>
43297>>>>>>>>>>>>>Use Cars.DD
INCLUDING FILE: CARS.DD
43297>>>>>>>>>>>>>>>//DDB-FileStart
43297>>>>>>>>>>>>>>>//DDB-HeaderStart
43297>>>>>>>>>>>>>>>
43297>>>>>>>>>>>>>>>// File Name : CARS.DD
43297>>>>>>>>>>>>>>>// Class Name: Cars_DataDictionary
43297>>>>>>>>>>>>>>>// Revision  : 16
43297>>>>>>>>>>>>>>>// Version   : 2
43297>>>>>>>>>>>>>>>
43297>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
43297>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43297>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43297>>>>>>>>>>>>>>>
43297>>>>>>>>>>>>>>>Open Cars
43299>>>>>>>>>>>>>>>Open Gmove
43301>>>>>>>>>>>>>>>Open Sysrecg
43303>>>>>>>>>>>>>>>
43303>>>>>>>>>>>>>>>//DDB-HeaderEnd
43303>>>>>>>>>>>>>>>//DDB-ValidationStart
43303>>>>>>>>>>>>>>>
43303>>>>>>>>>>>>>>>Register_Object Cars_Ctype_Id_VT
43303>>>>>>>>>>>>>>>
43303>>>>>>>>>>>>>>>Object Cars_Ctype_Id_VT  is a CodeValidationTable
43305>>>>>>>>>>>>>>>    Set Type_Value        To "PUMPSTYPE"
43306>>>>>>>>>>>>>>>    Set Validate_State    To FALSE
43307>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
43308>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43308>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43308>>>>>>>>>>>>>>>End_Object   // Cars_Ctype_Id_VT
43309>>>>>>>>>>>>>>>//DDB-ValidationEnd
43309>>>>>>>>>>>>>>>//DDB-SelectionStart
43309>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl054  sl054.SL
43309>>>>>>>>>>>>>>>Register_Object sl054
43309>>>>>>>>>>>>>>>//DDB-SelectionEnd
43309>>>>>>>>>>>>>>>
43309>>>>>>>>>>>>>>>Class Cars_DataDictionary  is a DataDictionary_Sec
43310>>>>>>>>>>>>>>>
43310>>>>>>>>>>>>>>>
43310>>>>>>>>>>>>>>>    Procedure Construct_Object
43311>>>>>>>>>>>>>>>        Forward Send Construct_Object
43313>>>>>>>>>>>>>>>        //------------------------------------------------
43313>>>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
43313>>>>>>>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
43313>>>>>>>>>>>>>>>        // einai 1     js 03/12/2007
43313>>>>>>>>>>>>>>>        //------------------------------------------------  
43313>>>>>>>>>>>>>>>        Property Integer piCreateNew            Public  0
43314>>>>>>>>>>>>>>>        Property Integer piAud_Old_Tare         Public  0
43315>>>>>>>>>>>>>>>        Property Number  pnAud_Old_Pagio        Public  0
43316>>>>>>>>>>>>>>>        Property String  psAud_Old_CarID        Public ""
43317>>>>>>>>>>>>>>>        Property String  psAud_Old_CarLicense   Public ""
43318>>>>>>>>>>>>>>>        //------------------------------------------------
43318>>>>>>>>>>>>>>>
43318>>>>>>>>>>>>>>>    End_procedure
43319>>>>>>>>>>>>>>>
43319>>>>>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
43320>>>>>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
43322>>>>>>>>>>>>>>>        //------------------------------------------------
43322>>>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
43322>>>>>>>>>>>>>>>        // ton pedion js 03/12/2007
43322>>>>>>>>>>>>>>>        //------------------------------------------------
43322>>>>>>>>>>>>>>>        Set piAud_Old_Tare          to Cars.Car_Tare
43323>>>>>>>>>>>>>>>        Set pnAud_Old_Pagio         to Cars.Pagio
43324>>>>>>>>>>>>>>>        Set psAud_Old_CarID         to Cars.Car_ID
43325>>>>>>>>>>>>>>>        Set psAud_Old_CarLicense    to Cars.Car_License
43326>>>>>>>>>>>>>>>        //------------------------------------------------
43326>>>>>>>>>>>>>>>     End_Procedure   // New_Current_Record
43327>>>>>>>>>>>>>>>
43327>>>>>>>>>>>>>>>    Procedure Delete_Main_File
43328>>>>>>>>>>>>>>>        //---------------------------------------------
43328>>>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
43328>>>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
43329>>>>>>>>>>>>>>>        Date    dDate  Shmer 
43329>>>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
43329>>>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
43333>>>>>>>>>>>>>>>        Move iHour  to sHour
43334>>>>>>>>>>>>>>>        Move iMin   to sMin
43335>>>>>>>>>>>>>>>        Move iSec   to sSec
43336>>>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
43340>>>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
43344>>>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
43348>>>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
43349>>>>>>>>>>>>>>>        
43349>>>>>>>>>>>>>>>        // Auditing / Diagrafh 
43349>>>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
43351>>>>>>>>>>>>>>>            Get fsLoginUserID to sUser
43352>>>>>>>>>>>>>>>            clear gmove
43353>>>>>>>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
43354>>>>>>>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
43355>>>>>>>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
43356>>>>>>>>>>>>>>>            move  5                     to gmove.gtypkin_code// Apo Clients
43357>>>>>>>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
43358>>>>>>>>>>>>>>>            move suser                  to gmove.gplan_code
43359>>>>>>>>>>>>>>>            move Cars.Car_ID            to gmove.garticl_recr
43360>>>>>>>>>>>>>>>            reread sysrecg
43364>>>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
43365>>>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
43366>>>>>>>>>>>>>>>            saverecord sysrecg
43367>>>>>>>>>>>>>>>            unlock
43368>>>>>>>>>>>>>>>>
43368>>>>>>>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
43369>>>>>>>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
43370>>>>>>>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
43371>>>>>>>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
43372>>>>>>>>>>>>>>>            
43372>>>>>>>>>>>>>>>            Move Cars.Car_ID                    to Gmove.Partl_Recr          
43373>>>>>>>>>>>>>>>            Move Cars.Car_ID                    to Gmove.Pms_Recr          
43374>>>>>>>>>>>>>>>
43374>>>>>>>>>>>>>>>            Move (piAud_Old_Tare      (Self))   to Gmove.Prev_Ox_Apobaro
43375>>>>>>>>>>>>>>>            Move (pnAud_Old_Pagio     (Self))   to Gmove.Prev_Stoxos1
43376>>>>>>>>>>>>>>>            Move (psAud_Old_CarID     (Self))   to Gmove.Prev_Oxhma
43377>>>>>>>>>>>>>>>            Move (psAud_Old_CarLicense(Self))   to Gmove.Prev_CN_Prosth
43378>>>>>>>>>>>>>>>
43378>>>>>>>>>>>>>>>
43378>>>>>>>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª Ž®ã£˜«¦ª"    to gmove.gmove_aitiol
43379>>>>>>>>>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
43380>>>>>>>>>>>>>>>            saverecord gmove
43381>>>>>>>>>>>>>>>        End
43381>>>>>>>>>>>>>>>>
43381>>>>>>>>>>>>>>>        Forward Send Delete_Main_File
43383>>>>>>>>>>>>>>>
43383>>>>>>>>>>>>>>>    End_Procedure
43384>>>>>>>>>>>>>>>
43384>>>>>>>>>>>>>>>     Procedure Creating
43385>>>>>>>>>>>>>>>        Forward Send Creating
43387>>>>>>>>>>>>>>>        Set piCreateNew to 1
43388>>>>>>>>>>>>>>>    End_Procedure   // Creating
43389>>>>>>>>>>>>>>>
43389>>>>>>>>>>>>>>>
43389>>>>>>>>>>>>>>>
43389>>>>>>>>>>>>>>>
43389>>>>>>>>>>>>>>>    // Update:
43389>>>>>>>>>>>>>>>    Procedure Update
43390>>>>>>>>>>>>>>>        Forward Send Update
43392>>>>>>>>>>>>>>>        move syscurxr.company_code  to cars.car_company
43393>>>>>>>>>>>>>>>        move syscurxr.beto_site     to cars.car_bsite
43394>>>>>>>>>>>>>>>        // Insert Code Here
43394>>>>>>>>>>>>>>>        
43394>>>>>>>>>>>>>>>        //---------------------------------------------
43394>>>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
43394>>>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
43395>>>>>>>>>>>>>>>        Date    dDate  Shmer 
43395>>>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
43395>>>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
43399>>>>>>>>>>>>>>>        Move iHour  to sHour
43400>>>>>>>>>>>>>>>        Move iMin   to sMin
43401>>>>>>>>>>>>>>>        Move iSec   to sSec
43402>>>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
43406>>>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
43410>>>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
43414>>>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
43415>>>>>>>>>>>>>>>        
43415>>>>>>>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
43415>>>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
43417>>>>>>>>>>>>>>>            Get fsLoginUserID to sUser
43418>>>>>>>>>>>>>>>            If (piCreateNew(Self)=1) Begin
43420>>>>>>>>>>>>>>>                clear gmove
43421>>>>>>>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
43422>>>>>>>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
43423>>>>>>>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
43424>>>>>>>>>>>>>>>                move  5                     to gmove.gtypkin_code// Apo Clients
43425>>>>>>>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
43426>>>>>>>>>>>>>>>                move suser                  to gmove.gplan_code
43427>>>>>>>>>>>>>>>                move Cars.Car_ID            to gmove.garticl_recr
43428>>>>>>>>>>>>>>>                reread sysrecg
43432>>>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
43433>>>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
43434>>>>>>>>>>>>>>>                saverecord sysrecg
43435>>>>>>>>>>>>>>>                unlock
43436>>>>>>>>>>>>>>>>
43436>>>>>>>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
43437>>>>>>>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
43438>>>>>>>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
43439>>>>>>>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
43440>>>>>>>>>>>>>>>
43440>>>>>>>>>>>>>>>                Move Cars.Car_ID            to Gmove.Partl_Recr          
43441>>>>>>>>>>>>>>>                Move Cars.Car_ID            to Gmove.Pms_Recr          
43442>>>>>>>>>>>>>>>
43442>>>>>>>>>>>>>>>                Move Cars.Car_Tare          to Gmove.Cur_Ox_Apobaro
43443>>>>>>>>>>>>>>>                Move Cars.Pagio             to Gmove.Cur_Stoxos1
43444>>>>>>>>>>>>>>>                Move Cars.Car_ID            to Gmove.Cur_Oxhma
43445>>>>>>>>>>>>>>>                Move Cars.Car_License       to Gmove.Cur_CN_Prosth
43446>>>>>>>>>>>>>>>                
43446>>>>>>>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â˜ª Ž®ã£˜«¦ª" to Gmove.Gmove_Aitiol
43447>>>>>>>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs  
43448>>>>>>>>>>>>>>>                saverecord gmove
43449>>>>>>>>>>>>>>>                Set piCreateNew to 0
43450>>>>>>>>>>>>>>>            End
43450>>>>>>>>>>>>>>>>
43450>>>>>>>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
43453>>>>>>>>>>>>>>>                Integer isChanged
43453>>>>>>>>>>>>>>>                Move 0 to isChanged
43454>>>>>>>>>>>>>>>                
43454>>>>>>>>>>>>>>>                     If (pnAud_Old_Pagio     (Self)<>Cars.Pagio        ) Move 1 to isChanged
43457>>>>>>>>>>>>>>>                Else If (piAud_Old_Tare      (Self)<>Cars.Car_Tare     ) Move 1 to isChanged
43461>>>>>>>>>>>>>>>                Else If (psAud_Old_CarID     (Self)<>Cars.Car_ID       ) Move 1 to isChanged
43465>>>>>>>>>>>>>>>                Else If (psAud_Old_CarLicense(Self)<>Cars.Car_License  ) Move 1 to isChanged
43469>>>>>>>>>>>>>>>                
43469>>>>>>>>>>>>>>>                If (isChanged>0) Begin  
43471>>>>>>>>>>>>>>>                    clear gmove
43472>>>>>>>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
43473>>>>>>>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
43474>>>>>>>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
43475>>>>>>>>>>>>>>>                    move  5                     to gmove.gtypkin_code// Apo Clients
43476>>>>>>>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
43477>>>>>>>>>>>>>>>                    move suser                  to gmove.gplan_code
43478>>>>>>>>>>>>>>>                    move Cars.Car_ID          to gmove.garticl_recr
43479>>>>>>>>>>>>>>>                    reread sysrecg
43483>>>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
43484>>>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
43485>>>>>>>>>>>>>>>                    saverecord sysrecg
43486>>>>>>>>>>>>>>>                    unlock
43487>>>>>>>>>>>>>>>>
43487>>>>>>>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
43488>>>>>>>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
43489>>>>>>>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
43490>>>>>>>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
43491>>>>>>>>>>>>>>>                    Move Cars.Car_ID                    to Gmove.Partl_Recr          
43492>>>>>>>>>>>>>>>                    Move Cars.Car_ID                    to Gmove.Pms_Recr          
43493>>>>>>>>>>>>>>>                    //--                                
43493>>>>>>>>>>>>>>>                    Move Cars.Car_Tare                  to Gmove.Cur_Ox_Apobaro
43494>>>>>>>>>>>>>>>                    Move Cars.Pagio                     to Gmove.Cur_Stoxos1
43495>>>>>>>>>>>>>>>                    Move Cars.Car_ID                    to Gmove.Cur_Oxhma
43496>>>>>>>>>>>>>>>                    Move Cars.Car_License               to Gmove.Cur_CN_Prosth
43497>>>>>>>>>>>>>>>                    //--
43497>>>>>>>>>>>>>>>                    Move (piAud_Old_Tare      (Self))   to Gmove.Prev_Ox_Apobaro    
43498>>>>>>>>>>>>>>>                    Move (pnAud_Old_Pagio     (Self))   to Gmove.Prev_Stoxos1       
43499>>>>>>>>>>>>>>>                    Move (psAud_Old_CarID     (Self))   to Gmove.Prev_Oxhma         
43500>>>>>>>>>>>>>>>                    Move (psAud_Old_CarLicense(Self))   to Gmove.Prev_CN_Prosth
43501>>>>>>>>>>>>>>>                                                         
43501>>>>>>>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª Ž®ã£˜«¦ª"   to gmove.gmove_aitiol
43502>>>>>>>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
43503>>>>>>>>>>>>>>>                    saverecord gmove
43504>>>>>>>>>>>>>>>                    Set piCreateNew to 0
43505>>>>>>>>>>>>>>>                End
43505>>>>>>>>>>>>>>>>
43505>>>>>>>>>>>>>>>            End
43505>>>>>>>>>>>>>>>>
43505>>>>>>>>>>>>>>>        End
43505>>>>>>>>>>>>>>>>
43505>>>>>>>>>>>>>>>        
43505>>>>>>>>>>>>>>>    End_Procedure   // Update
43506>>>>>>>>>>>>>>>
43506>>>>>>>>>>>>>>>
43506>>>>>>>>>>>>>>>    // Define_Fields:
43506>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43506>>>>>>>>>>>>>>>
43506>>>>>>>>>>>>>>>    Procedure Define_Fields
43507>>>>>>>>>>>>>>>        Forward Send Define_Fields
43509>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43509>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
43509>>>>>>>>>>>>>>>
43509>>>>>>>>>>>>>>>        Set Main_File            To Cars.File_Number
43510>>>>>>>>>>>>>>>
43510>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
43511>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
43512>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43513>>>>>>>>>>>>>>>
43513>>>>>>>>>>>>>>>        // External (System) file structure.............
43513>>>>>>>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
43514>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
43515>>>>>>>>>>>>>>>
43515>>>>>>>>>>>>>>>        // Field-based properties.......................
43515>>>>>>>>>>>>>>>
43515>>>>>>>>>>>>>>>        // Cars.Car_Recnum
43515>>>>>>>>>>>>>>>
43515>>>>>>>>>>>>>>>        // Cars.Car_Company
43515>>>>>>>>>>>>>>>
43515>>>>>>>>>>>>>>>        // Cars.Car_Id
43515>>>>>>>>>>>>>>>        Set Field_Options          Field Cars.Car_Id To DD_AUTOFIND   
43516>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cars.Car_Id To (sl054(Self))
43517>>>>>>>>>>>>>>>        Set Key_Field_State        Field Cars.Car_Id To TRUE
43518>>>>>>>>>>>>>>>
43518>>>>>>>>>>>>>>>        // Cars.Car_Descr
43518>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cars.Car_Descr To (sl054(Self))
43519>>>>>>>>>>>>>>>
43519>>>>>>>>>>>>>>>        // Cars.Car_License
43519>>>>>>>>>>>>>>>
43519>>>>>>>>>>>>>>>        // Cars.Car_Driverrecn
43519>>>>>>>>>>>>>>>
43519>>>>>>>>>>>>>>>        // Cars.Car_Details
43519>>>>>>>>>>>>>>>
43519>>>>>>>>>>>>>>>        // Cars.Car_Maxm3
43519>>>>>>>>>>>>>>>
43519>>>>>>>>>>>>>>>        // Cars.Car_Sitew
43519>>>>>>>>>>>>>>>
43519>>>>>>>>>>>>>>>        // Cars.Car_Tare
43519>>>>>>>>>>>>>>>
43519>>>>>>>>>>>>>>>        // Cars.Car_Codematch
43519>>>>>>>>>>>>>>>
43519>>>>>>>>>>>>>>>        // Cars.Car_Driverid
43519>>>>>>>>>>>>>>>
43519>>>>>>>>>>>>>>>        // Cars.Car_Sn
43519>>>>>>>>>>>>>>>
43519>>>>>>>>>>>>>>>        // Cars.Car_Lastupdated
43519>>>>>>>>>>>>>>>
43519>>>>>>>>>>>>>>>        // Cars.Car_Markexp
43519>>>>>>>>>>>>>>>
43519>>>>>>>>>>>>>>>        // Cars.Car_748tare1
43519>>>>>>>>>>>>>>>
43519>>>>>>>>>>>>>>>        // Cars.Car_748tare2
43519>>>>>>>>>>>>>>>
43519>>>>>>>>>>>>>>>        // Cars.Car_748sign
43519>>>>>>>>>>>>>>>
43519>>>>>>>>>>>>>>>        // Cars.Car_Bsite
43519>>>>>>>>>>>>>>>
43519>>>>>>>>>>>>>>>        // Cars.Ctype_Id
43519>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Cars.Ctype_Id To "dbComboFormsub"
43520>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Cars.Ctype_Id To (Cars_Ctype_Id_VT(Self))
43521>>>>>>>>>>>>>>>
43521>>>>>>>>>>>>>>>        // Cars.Pagio
43521>>>>>>>>>>>>>>>
43521>>>>>>>>>>>>>>>        // Cars.Parakrat
43521>>>>>>>>>>>>>>>
43521>>>>>>>>>>>>>>>        // Cars.Car_What
43521>>>>>>>>>>>>>>>
43521>>>>>>>>>>>>>>>        // Cars.Car_Lc
43521>>>>>>>>>>>>>>>
43521>>>>>>>>>>>>>>>        // Cars.Car_Ln
43521>>>>>>>>>>>>>>>
43521>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
43521>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
43522>>>>>>>>>>>>>>>
43522>>>>>>>>>>>>>>>    // Field_Defaults:
43522>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
43522>>>>>>>>>>>>>>>
43522>>>>>>>>>>>>>>>    Procedure Field_Defaults
43523>>>>>>>>>>>>>>>        Forward Send Field_Defaults
43525>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43525>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
43525>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
43525>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
43526>>>>>>>>>>>>>>>
43526>>>>>>>>>>>>>>>End_Class    // Cars_DataDictionary
43527>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
43527>>>>>>>>>>>>>>>
43527>>>>>>>>>>>>>>>Use sl054.SL         // sl054
43527>>>>>>>>>>>>>>>
43527>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
43527>>>>>>>>>>>>>>>//DDB-FileEnd
43527>>>>>>>>>>>>>
43527>>>>>>>>>>>>>//AB-IgnoreEnd
43527>>>>>>>>>>>>>
43527>>>>>>>>>>>>>Object sl054 is a dbModalPanelSub
43529>>>>>>>>>>>>>    Set Label to "€¨®œå¦ Ž®ž£á«à¤"
43530>>>>>>>>>>>>>    Set Size to 148 420
43531>>>>>>>>>>>>>    Set Location to 4 5
43532>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
43533>>>>>>>>>>>>>    Set Modal_State to FALSE
43534>>>>>>>>>>>>>
43534>>>>>>>>>>>>>    //AB-DDOStart
43534>>>>>>>>>>>>>
43534>>>>>>>>>>>>>    Object Cars_DD is a Cars_DataDictionary
43536>>>>>>>>>>>>>    End_Object    // Cars_DD
43537>>>>>>>>>>>>>
43537>>>>>>>>>>>>>    Set Main_DD to (Cars_DD(self))
43538>>>>>>>>>>>>>    Set Server to (Cars_DD(self))
43539>>>>>>>>>>>>>
43539>>>>>>>>>>>>>    //AB-DDOEnd
43539>>>>>>>>>>>>>
43539>>>>>>>>>>>>>    Object oSelList is a dbListSub
43541>>>>>>>>>>>>>        Set Main_File to Cars.File_Number
43542>>>>>>>>>>>>>        Set Size to 105 403
43543>>>>>>>>>>>>>        Set Location to 6 6
43544>>>>>>>>>>>>>
43544>>>>>>>>>>>>>        Begin_Row
43547>>>>>>>>>>>>>            Entry_Item Cars.Car_id
43548>>>>>>>>>>>>>            Entry_Item Cars.Car_descr
43549>>>>>>>>>>>>>            Entry_Item Cars.Car_license
43550>>>>>>>>>>>>>            Entry_Item Cars.Car_maxm3
43551>>>>>>>>>>>>>            Entry_Item Cars.Car_driverid
43552>>>>>>>>>>>>>        End_Row
43557>>>>>>>>>>>>>
43557>>>>>>>>>>>>>        Set Form_Width    item 0 to 80
43558>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à›.Ž®ã£˜«¦ª"
43559>>>>>>>>>>>>>        
43559>>>>>>>>>>>>>        Set Form_Width    item 1 to 120
43560>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
43561>>>>>>>>>>>>>        
43561>>>>>>>>>>>>>        Set Form_Width    item 2 to 80
43562>>>>>>>>>>>>>        Set Header_Label  item 2 to "€¨ Ÿ.‰¬¡¢¦­¦¨å˜ª"
43563>>>>>>>>>>>>>        
43563>>>>>>>>>>>>>        Set Form_Width    item 3 to 50
43564>>>>>>>>>>>>>        Set Header_Label  item 3 to "Max.m3"
43565>>>>>>>>>>>>>        
43565>>>>>>>>>>>>>        Set Form_Width    item 4 to 65
43566>>>>>>>>>>>>>        Set Header_Label  item 4 to "‰à›.Ž›žš¦ç"
43567>>>>>>>>>>>>>        
43567>>>>>>>>>>>>>    End_Object    // oSelList
43568>>>>>>>>>>>>>
43568>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
43570>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
43571>>>>>>>>>>>>>        Set Location to 114 249
43572>>>>>>>>>>>>>
43572>>>>>>>>>>>>>        //AB-StoreStart
43572>>>>>>>>>>>>>        Procedure OnClick
43574>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
43575>>>>>>>>>>>>>        End_Procedure
43576>>>>>>>>>>>>>        //AB-StoreEnd
43576>>>>>>>>>>>>>
43576>>>>>>>>>>>>>    End_Object    // oOK_bn
43577>>>>>>>>>>>>>
43577>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
43579>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
43580>>>>>>>>>>>>>        Set Location to 114 305
43581>>>>>>>>>>>>>
43581>>>>>>>>>>>>>        //AB-StoreStart
43581>>>>>>>>>>>>>        Procedure OnClick
43583>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
43584>>>>>>>>>>>>>        End_Procedure
43585>>>>>>>>>>>>>        //AB-StoreEnd
43585>>>>>>>>>>>>>
43585>>>>>>>>>>>>>    End_Object    // oCancel_bn
43586>>>>>>>>>>>>>
43586>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
43588>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
43589>>>>>>>>>>>>>        Set Location to 114 359
43590>>>>>>>>>>>>>
43590>>>>>>>>>>>>>        //AB-StoreStart
43590>>>>>>>>>>>>>        Procedure OnClick
43592>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
43593>>>>>>>>>>>>>        End_Procedure
43594>>>>>>>>>>>>>        //AB-StoreEnd
43594>>>>>>>>>>>>>
43594>>>>>>>>>>>>>    End_Object    // oSearch_bn
43595>>>>>>>>>>>>>
43595>>>>>>>>>>>>>
43595>>>>>>>>>>>>>    //AB-StoreStart
43595>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
43596>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
43597>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
43598>>>>>>>>>>>>>    //AB-StoreEnd
43598>>>>>>>>>>>>>
43598>>>>>>>>>>>>>End_Object    // sl054
43599>>>>>>>>>>>>>
43599>>>>>>>>>>>>>//AB/ End_Object    // prj
43599>>>>>>>>>>>Use sl053.SL         // sl053
INCLUDING FILE: SL053.SL
43599>>>>>>>>>>>>>//AB/ Project sl053:pumps
43599>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
43599>>>>>>>>>>>>>//AB/     Set ProjectName to "sl053:pumps"
43599>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl053.SL"
43599>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
43599>>>>>>>>>>>>>
43599>>>>>>>>>>>>>// Project Object Structure
43599>>>>>>>>>>>>>//   sl053 is a dbModalPanelSub
43599>>>>>>>>>>>>>//     Pumps_DD is a DataDictionary
43599>>>>>>>>>>>>>//     oSelList is a dbListSub
43599>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
43599>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
43599>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
43599>>>>>>>>>>>>>
43599>>>>>>>>>>>>>// Register all objects
43599>>>>>>>>>>>>>Register_Object oCancel_bn
43599>>>>>>>>>>>>>Register_Object oOK_bn
43599>>>>>>>>>>>>>Register_Object oSearch_bn
43599>>>>>>>>>>>>>Register_Object oSelList
43599>>>>>>>>>>>>>Register_Object Pumps_DD
43599>>>>>>>>>>>>>Register_Object sl053
43599>>>>>>>>>>>>>
43599>>>>>>>>>>>>>
43599>>>>>>>>>>>>>//AB-IgnoreStart
43599>>>>>>>>>>>>>
43599>>>>>>>>>>>>>Use DFAllEnt.pkg
43599>>>>>>>>>>>>>Use dbList.Sub
43599>>>>>>>>>>>>>Use Button.Sub
43599>>>>>>>>>>>>>
43599>>>>>>>>>>>>>
43599>>>>>>>>>>>>>Use Pumps.DD
INCLUDING FILE: PUMPS.DD
43599>>>>>>>>>>>>>>>//DDB-FileStart
43599>>>>>>>>>>>>>>>//DDB-HeaderStart
43599>>>>>>>>>>>>>>>
43599>>>>>>>>>>>>>>>// File Name : PUMPS.DD
43599>>>>>>>>>>>>>>>// Class Name: Pumps_DataDictionary
43599>>>>>>>>>>>>>>>// Revision  : 18
43599>>>>>>>>>>>>>>>// Version   : 2
43599>>>>>>>>>>>>>>>
43599>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
43599>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43599>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43599>>>>>>>>>>>>>>>
43599>>>>>>>>>>>>>>>Open Pumps
43601>>>>>>>>>>>>>>>Open Gmove
43603>>>>>>>>>>>>>>>Open Sysrecg
43605>>>>>>>>>>>>>>>
43605>>>>>>>>>>>>>>>//DDB-HeaderEnd
43605>>>>>>>>>>>>>>>//DDB-ValidationStart
43605>>>>>>>>>>>>>>>
43605>>>>>>>>>>>>>>>Register_Object Pumps_Ctype_Id_VT
43605>>>>>>>>>>>>>>>
43605>>>>>>>>>>>>>>>Object Pumps_Ctype_Id_VT  is a CodeValidationTable
43607>>>>>>>>>>>>>>>    Set Type_Value        To "PUMPSTYPE"
43608>>>>>>>>>>>>>>>    Set Validate_State    To FALSE
43609>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
43610>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43610>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43610>>>>>>>>>>>>>>>End_Object   // Pumps_Ctype_Id_VT
43611>>>>>>>>>>>>>>>//DDB-ValidationEnd
43611>>>>>>>>>>>>>>>//DDB-SelectionStart
43611>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl053  sl053.SL
43611>>>>>>>>>>>>>>>Register_Object sl053
43611>>>>>>>>>>>>>>>//DDB-SelectionEnd
43611>>>>>>>>>>>>>>>
43611>>>>>>>>>>>>>>>Class Pumps_DataDictionary  is a DataDictionary_Sec
43612>>>>>>>>>>>>>>>
43612>>>>>>>>>>>>>>>    Procedure Construct_Object
43613>>>>>>>>>>>>>>>        Forward Send Construct_Object
43615>>>>>>>>>>>>>>>        //------------------------------------------------
43615>>>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
43615>>>>>>>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
43615>>>>>>>>>>>>>>>        // einai 1     js 03/12/2007
43615>>>>>>>>>>>>>>>        //------------------------------------------------  
43615>>>>>>>>>>>>>>>        Property Integer piCreateNew            Public  0
43616>>>>>>>>>>>>>>>        Property Number  pnAud_Old_M3           Public  0
43617>>>>>>>>>>>>>>>        Property Integer piAud_Old_Pagio        Public  0
43618>>>>>>>>>>>>>>>        Property String  psAud_Old_PumpID       Public ""
43619>>>>>>>>>>>>>>>        Property String  psAud_Old_License      Public ""
43620>>>>>>>>>>>>>>>        //------------------------------------------------
43620>>>>>>>>>>>>>>>
43620>>>>>>>>>>>>>>>    End_procedure
43621>>>>>>>>>>>>>>>
43621>>>>>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
43622>>>>>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
43624>>>>>>>>>>>>>>>        //------------------------------------------------
43624>>>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
43624>>>>>>>>>>>>>>>        // ton pedion js 03/12/2007
43624>>>>>>>>>>>>>>>        //------------------------------------------------
43624>>>>>>>>>>>>>>>        Set pnAud_Old_M3        to Pumps.PriceM3
43625>>>>>>>>>>>>>>>        Set piAud_Old_Pagio     to Pumps.PagioMin
43626>>>>>>>>>>>>>>>        Set psAud_Old_PumpID    to Pumps.Pump_ID
43627>>>>>>>>>>>>>>>        Set psAud_Old_License   to Pumps.Pump_License
43628>>>>>>>>>>>>>>>        //------------------------------------------------
43628>>>>>>>>>>>>>>>     End_Procedure   // New_Current_Record
43629>>>>>>>>>>>>>>>
43629>>>>>>>>>>>>>>>    Procedure Delete_Main_File
43630>>>>>>>>>>>>>>>        //---------------------------------------------
43630>>>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
43630>>>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
43631>>>>>>>>>>>>>>>        Date    dDate  Shmer 
43631>>>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
43631>>>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
43635>>>>>>>>>>>>>>>        Move iHour  to sHour
43636>>>>>>>>>>>>>>>        Move iMin   to sMin
43637>>>>>>>>>>>>>>>        Move iSec   to sSec
43638>>>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
43642>>>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
43646>>>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
43650>>>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
43651>>>>>>>>>>>>>>>        
43651>>>>>>>>>>>>>>>        // Auditing / Diagrafh 
43651>>>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
43653>>>>>>>>>>>>>>>            Get fsLoginUserID to sUser
43654>>>>>>>>>>>>>>>            clear gmove
43655>>>>>>>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
43656>>>>>>>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
43657>>>>>>>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
43658>>>>>>>>>>>>>>>            move  6                     to gmove.gtypkin_code// Apo Clients
43659>>>>>>>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
43660>>>>>>>>>>>>>>>            move suser                  to gmove.gplan_code
43661>>>>>>>>>>>>>>>            move Pumps.Pump_ID          to gmove.garticl_recr
43662>>>>>>>>>>>>>>>            reread sysrecg
43666>>>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
43667>>>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
43668>>>>>>>>>>>>>>>            saverecord sysrecg
43669>>>>>>>>>>>>>>>            unlock
43670>>>>>>>>>>>>>>>>
43670>>>>>>>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
43671>>>>>>>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
43672>>>>>>>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
43673>>>>>>>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
43674>>>>>>>>>>>>>>>            
43674>>>>>>>>>>>>>>>            Move Pumps.Pump_ID                  to Gmove.Partl_Recr          
43675>>>>>>>>>>>>>>>            Move Pumps.Pump_ID                  to Gmove.Pms_Recr          
43676>>>>>>>>>>>>>>>
43676>>>>>>>>>>>>>>>            Move (pnAud_Old_M3     (Self))      to Gmove.Prev_Ant_Min_M3
43677>>>>>>>>>>>>>>>            Move (piAud_Old_Pagio  (Self))      to Gmove.Prev_Stoxos1
43678>>>>>>>>>>>>>>>            Move (psAud_Old_License(Self))      to Gmove.Prev_CN_Prosth
43679>>>>>>>>>>>>>>>            Move (psAud_Old_PumpID (Self))      to Gmove.Prev_Antlia
43680>>>>>>>>>>>>>>>
43680>>>>>>>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª €¤«¢å˜ª"    to gmove.gmove_aitiol
43681>>>>>>>>>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
43682>>>>>>>>>>>>>>>            saverecord gmove
43683>>>>>>>>>>>>>>>        End
43683>>>>>>>>>>>>>>>>
43683>>>>>>>>>>>>>>>        Forward Send Delete_Main_File
43685>>>>>>>>>>>>>>>
43685>>>>>>>>>>>>>>>    End_Procedure
43686>>>>>>>>>>>>>>>
43686>>>>>>>>>>>>>>>     Procedure Creating
43687>>>>>>>>>>>>>>>        Forward Send Creating
43689>>>>>>>>>>>>>>>        Set piCreateNew to 1
43690>>>>>>>>>>>>>>>    End_Procedure   // Creating
43691>>>>>>>>>>>>>>>
43691>>>>>>>>>>>>>>>
43691>>>>>>>>>>>>>>>    // Update:
43691>>>>>>>>>>>>>>>    Procedure Update
43692>>>>>>>>>>>>>>>        Forward Send Update
43694>>>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Pumps.Pump_Company
43695>>>>>>>>>>>>>>>        Move SysCurXR.Beto_Site     to Pumps.Pump_SiteW
43696>>>>>>>>>>>>>>>
43696>>>>>>>>>>>>>>>
43696>>>>>>>>>>>>>>>        //---------------------------------------------
43696>>>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
43696>>>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
43697>>>>>>>>>>>>>>>        Date    dDate  Shmer 
43697>>>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
43697>>>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
43701>>>>>>>>>>>>>>>        Move iHour  to sHour
43702>>>>>>>>>>>>>>>        Move iMin   to sMin
43703>>>>>>>>>>>>>>>        Move iSec   to sSec
43704>>>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
43708>>>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
43712>>>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
43716>>>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
43717>>>>>>>>>>>>>>>        
43717>>>>>>>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
43717>>>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
43719>>>>>>>>>>>>>>>            Get fsLoginUserID to sUser
43720>>>>>>>>>>>>>>>            If (piCreateNew(Self)=1) Begin
43722>>>>>>>>>>>>>>>                clear gmove
43723>>>>>>>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
43724>>>>>>>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
43725>>>>>>>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
43726>>>>>>>>>>>>>>>                move  6                     to gmove.gtypkin_code// Apo Clients
43727>>>>>>>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
43728>>>>>>>>>>>>>>>                move suser                  to gmove.gplan_code
43729>>>>>>>>>>>>>>>                move Pumps.Pump_ID          to gmove.garticl_recr
43730>>>>>>>>>>>>>>>                reread sysrecg
43734>>>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
43735>>>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
43736>>>>>>>>>>>>>>>                saverecord sysrecg
43737>>>>>>>>>>>>>>>                unlock
43738>>>>>>>>>>>>>>>>
43738>>>>>>>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
43739>>>>>>>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
43740>>>>>>>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
43741>>>>>>>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
43742>>>>>>>>>>>>>>>
43742>>>>>>>>>>>>>>>                Move Pumps.Pump_ID         to Gmove.Partl_Recr          
43743>>>>>>>>>>>>>>>                Move Pumps.Pump_ID         to Gmove.Pms_Recr          
43744>>>>>>>>>>>>>>>
43744>>>>>>>>>>>>>>>                move Pumps.Pump_ID          to gmove.Cur_Antlia
43745>>>>>>>>>>>>>>>                Move Pumps.PriceM3          to Gmove.Cur_Stoxos1
43746>>>>>>>>>>>>>>>                Move Pumps.PagioMin         to Gmove.Cur_Ant_Min_M3
43747>>>>>>>>>>>>>>>                Move Pumps.Pump_License     to Gmove.Cur_CN_Prosth
43748>>>>>>>>>>>>>>>
43748>>>>>>>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â˜ª €¤«¢å˜ª" to Gmove.Gmove_Aitiol
43749>>>>>>>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs  
43750>>>>>>>>>>>>>>>                saverecord gmove
43751>>>>>>>>>>>>>>>                Set piCreateNew to 0
43752>>>>>>>>>>>>>>>            End
43752>>>>>>>>>>>>>>>>
43752>>>>>>>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
43755>>>>>>>>>>>>>>>                Integer isChanged
43755>>>>>>>>>>>>>>>                Move 0 to isChanged
43756>>>>>>>>>>>>>>>                
43756>>>>>>>>>>>>>>>                     If (pnAud_Old_M3      (Self)<>Pumps.PriceM3     ) Move 1 to isChanged
43759>>>>>>>>>>>>>>>                Else If (piAud_Old_Pagio   (Self)<>Pumps.PagioMin    ) Move 1 to isChanged
43763>>>>>>>>>>>>>>>                Else If (psAud_Old_PumpID  (Self)<>Pumps.Pump_ID     ) Move 1 to isChanged
43767>>>>>>>>>>>>>>>                Else If (psAud_Old_License (Self)<>Pumps.Pump_License) Move 1 to isChanged
43771>>>>>>>>>>>>>>>
43771>>>>>>>>>>>>>>>                If (isChanged>0) Begin  
43773>>>>>>>>>>>>>>>                    clear gmove
43774>>>>>>>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
43775>>>>>>>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
43776>>>>>>>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
43777>>>>>>>>>>>>>>>                    move  6                     to gmove.gtypkin_code// Apo Clients
43778>>>>>>>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
43779>>>>>>>>>>>>>>>                    move suser                  to gmove.gplan_code
43780>>>>>>>>>>>>>>>                    move Pumps.Pump_ID          to gmove.garticl_recr
43781>>>>>>>>>>>>>>>                    reread sysrecg
43785>>>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
43786>>>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
43787>>>>>>>>>>>>>>>                    saverecord sysrecg
43788>>>>>>>>>>>>>>>                    unlock
43789>>>>>>>>>>>>>>>>
43789>>>>>>>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
43790>>>>>>>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
43791>>>>>>>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
43792>>>>>>>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
43793>>>>>>>>>>>>>>>                    Move Pumps.Pump_ID                  to Gmove.Partl_Recr          
43794>>>>>>>>>>>>>>>                    Move Pumps.Pump_ID                  to Gmove.Pms_Recr          
43795>>>>>>>>>>>>>>>                    //--                                
43795>>>>>>>>>>>>>>>                    move Pumps.Pump_ID                  to gmove.Cur_Antlia
43796>>>>>>>>>>>>>>>                    Move Pumps.PriceM3                  to Gmove.Cur_Stoxos1
43797>>>>>>>>>>>>>>>                    Move Pumps.PagioMin                 to Gmove.Cur_Ant_Min_M3
43798>>>>>>>>>>>>>>>                    Move Pumps.Pump_License             to Gmove.Cur_CN_Prosth
43799>>>>>>>>>>>>>>>                    //--
43799>>>>>>>>>>>>>>>                    Move (pnAud_Old_M3     (Self))      to Gmove.Prev_Stoxos1      
43800>>>>>>>>>>>>>>>                    Move (piAud_Old_Pagio  (Self))      to Gmove.Prev_Ant_Min_M3   
43801>>>>>>>>>>>>>>>                    Move (psAud_Old_License(Self))      to Gmove.Prev_CN_Prosth
43802>>>>>>>>>>>>>>>                    Move (psAud_Old_PumpID (Self))      to Gmove.Prev_Antlia
43803>>>>>>>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª €¤«¢å˜ª"    to gmove.gmove_aitiol
43804>>>>>>>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
43805>>>>>>>>>>>>>>>                    saverecord gmove
43806>>>>>>>>>>>>>>>                    Set piCreateNew to 0
43807>>>>>>>>>>>>>>>                End
43807>>>>>>>>>>>>>>>>
43807>>>>>>>>>>>>>>>            End
43807>>>>>>>>>>>>>>>>
43807>>>>>>>>>>>>>>>        End
43807>>>>>>>>>>>>>>>>
43807>>>>>>>>>>>>>>>
43807>>>>>>>>>>>>>>>
43807>>>>>>>>>>>>>>>
43807>>>>>>>>>>>>>>>    End_Procedure   // Update
43808>>>>>>>>>>>>>>>
43808>>>>>>>>>>>>>>>
43808>>>>>>>>>>>>>>>    // Define_Fields:
43808>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43808>>>>>>>>>>>>>>>
43808>>>>>>>>>>>>>>>    Procedure Define_Fields
43809>>>>>>>>>>>>>>>        Forward Send Define_Fields
43811>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43811>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
43811>>>>>>>>>>>>>>>
43811>>>>>>>>>>>>>>>        Set Main_File            To Pumps.File_Number
43812>>>>>>>>>>>>>>>
43812>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
43813>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
43814>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43815>>>>>>>>>>>>>>>
43815>>>>>>>>>>>>>>>        // External (System) file structure.............
43815>>>>>>>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
43816>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
43817>>>>>>>>>>>>>>>
43817>>>>>>>>>>>>>>>        // Field-based properties.......................
43817>>>>>>>>>>>>>>>
43817>>>>>>>>>>>>>>>        // Pumps.Pump_Recnum
43817>>>>>>>>>>>>>>>
43817>>>>>>>>>>>>>>>        // Pumps.Pump_Company
43817>>>>>>>>>>>>>>>
43817>>>>>>>>>>>>>>>        // Pumps.Pump_Id
43817>>>>>>>>>>>>>>>        Set Field_Options          Field Pumps.Pump_Id To DD_AUTOFIND   
43818>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pumps.Pump_Id To (sl053(Self))
43819>>>>>>>>>>>>>>>        Set Key_Field_State        Field Pumps.Pump_Id To TRUE
43820>>>>>>>>>>>>>>>
43820>>>>>>>>>>>>>>>        // Pumps.Pump_Descr
43820>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pumps.Pump_Descr To (sl053(Self))
43821>>>>>>>>>>>>>>>
43821>>>>>>>>>>>>>>>        // Pumps.Pump_License
43821>>>>>>>>>>>>>>>
43821>>>>>>>>>>>>>>>        // Pumps.Pump_Mhkos
43821>>>>>>>>>>>>>>>
43821>>>>>>>>>>>>>>>        // Pumps.Pump_Mhkosch
43821>>>>>>>>>>>>>>>
43821>>>>>>>>>>>>>>>        // Pumps.Pump_Codematch
43821>>>>>>>>>>>>>>>
43821>>>>>>>>>>>>>>>        // Pumps.Pump_Sitew
43821>>>>>>>>>>>>>>>
43821>>>>>>>>>>>>>>>        // Pumps.Pump_Driver
43821>>>>>>>>>>>>>>>
43821>>>>>>>>>>>>>>>        // Pumps.Pump_Bsite
43821>>>>>>>>>>>>>>>
43821>>>>>>>>>>>>>>>        // Pumps.Ctype_Id
43821>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Pumps.Ctype_Id To "dbComboFormsub"
43822>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Pumps.Ctype_Id To (Pumps_Ctype_Id_VT(Self))
43823>>>>>>>>>>>>>>>
43823>>>>>>>>>>>>>>>        // Pumps.Pagiomin
43823>>>>>>>>>>>>>>>
43823>>>>>>>>>>>>>>>        // Pumps.Pricem3
43823>>>>>>>>>>>>>>>
43823>>>>>>>>>>>>>>>        // Pumps.Parakrat
43823>>>>>>>>>>>>>>>
43823>>>>>>>>>>>>>>>        // Pumps.Pump_What
43823>>>>>>>>>>>>>>>
43823>>>>>>>>>>>>>>>        // Pumps.Pump_Lc
43823>>>>>>>>>>>>>>>
43823>>>>>>>>>>>>>>>        // Pumps.Pump_Ln
43823>>>>>>>>>>>>>>>
43823>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
43823>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
43824>>>>>>>>>>>>>>>
43824>>>>>>>>>>>>>>>    // Field_Defaults:
43824>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
43824>>>>>>>>>>>>>>>
43824>>>>>>>>>>>>>>>    Procedure Field_Defaults
43825>>>>>>>>>>>>>>>        Forward Send Field_Defaults
43827>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43827>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
43827>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
43827>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
43828>>>>>>>>>>>>>>>
43828>>>>>>>>>>>>>>>End_Class    // Pumps_DataDictionary
43829>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
43829>>>>>>>>>>>>>>>
43829>>>>>>>>>>>>>>>Use sl053.SL         // sl053
43829>>>>>>>>>>>>>>>
43829>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
43829>>>>>>>>>>>>>>>//DDB-FileEnd
43829>>>>>>>>>>>>>
43829>>>>>>>>>>>>>//AB-IgnoreEnd
43829>>>>>>>>>>>>>
43829>>>>>>>>>>>>>Object sl053 is a dbModalPanelSub
43831>>>>>>>>>>>>>    Set Label to "€¨®œå¦ €¤«¢ é¤"
43832>>>>>>>>>>>>>    Set Size to 148 325
43833>>>>>>>>>>>>>    Set Location to 4 5
43834>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
43835>>>>>>>>>>>>>    Set Modal_State to FALSE
43836>>>>>>>>>>>>>
43836>>>>>>>>>>>>>    //AB-DDOStart
43836>>>>>>>>>>>>>
43836>>>>>>>>>>>>>    Object Pumps_DD is a Pumps_DataDictionary
43838>>>>>>>>>>>>>    End_Object    // Pumps_DD
43839>>>>>>>>>>>>>
43839>>>>>>>>>>>>>    Set Main_DD to (Pumps_DD(self))
43840>>>>>>>>>>>>>    Set Server to (Pumps_DD(self))
43841>>>>>>>>>>>>>
43841>>>>>>>>>>>>>    //AB-DDOEnd
43841>>>>>>>>>>>>>
43841>>>>>>>>>>>>>    Object oSelList is a dbListSub
43843>>>>>>>>>>>>>        Set Main_File to Pumps.File_Number
43844>>>>>>>>>>>>>        Set Size to 105 309
43845>>>>>>>>>>>>>        Set Location to 6 6
43846>>>>>>>>>>>>>
43846>>>>>>>>>>>>>        Begin_Row
43849>>>>>>>>>>>>>            Entry_Item Pumps.Pump_id
43850>>>>>>>>>>>>>            Entry_Item Pumps.Pump_descr
43851>>>>>>>>>>>>>            Entry_Item Pumps.Pump_license
43852>>>>>>>>>>>>>            Entry_Item Pumps.Pump_mhkos
43853>>>>>>>>>>>>>        End_Row
43858>>>>>>>>>>>>>
43858>>>>>>>>>>>>>        Set Form_Width    item 0 to 70
43859>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª €¤«¢å˜ª"
43860>>>>>>>>>>>>>        
43860>>>>>>>>>>>>>        Set Form_Width    item 1 to 120
43861>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
43862>>>>>>>>>>>>>        
43862>>>>>>>>>>>>>        Set Form_Width    item 2 to 65
43863>>>>>>>>>>>>>        Set Header_Label  item 2 to " ¤˜¡å›˜"
43864>>>>>>>>>>>>>        
43864>>>>>>>>>>>>>        Set Form_Width    item 3 to 46
43865>>>>>>>>>>>>>        Set Header_Label  item 3 to "‹ã¡¦ª"
43866>>>>>>>>>>>>>        
43866>>>>>>>>>>>>>    End_Object    // oSelList
43867>>>>>>>>>>>>>
43867>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
43869>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
43870>>>>>>>>>>>>>        Set Location to 114 157
43871>>>>>>>>>>>>>
43871>>>>>>>>>>>>>        //AB-StoreStart
43871>>>>>>>>>>>>>        Procedure OnClick
43873>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
43874>>>>>>>>>>>>>        End_Procedure
43875>>>>>>>>>>>>>        //AB-StoreEnd
43875>>>>>>>>>>>>>
43875>>>>>>>>>>>>>    End_Object    // oOK_bn
43876>>>>>>>>>>>>>
43876>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
43878>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
43879>>>>>>>>>>>>>        Set Location to 114 212
43880>>>>>>>>>>>>>
43880>>>>>>>>>>>>>        //AB-StoreStart
43880>>>>>>>>>>>>>        Procedure OnClick
43882>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
43883>>>>>>>>>>>>>        End_Procedure
43884>>>>>>>>>>>>>        //AB-StoreEnd
43884>>>>>>>>>>>>>
43884>>>>>>>>>>>>>    End_Object    // oCancel_bn
43885>>>>>>>>>>>>>
43885>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
43887>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
43888>>>>>>>>>>>>>        Set Location to 114 267
43889>>>>>>>>>>>>>
43889>>>>>>>>>>>>>        //AB-StoreStart
43889>>>>>>>>>>>>>        Procedure OnClick
43891>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
43892>>>>>>>>>>>>>        End_Procedure
43893>>>>>>>>>>>>>        //AB-StoreEnd
43893>>>>>>>>>>>>>
43893>>>>>>>>>>>>>    End_Object    // oSearch_bn
43894>>>>>>>>>>>>>
43894>>>>>>>>>>>>>
43894>>>>>>>>>>>>>    //AB-StoreStart
43894>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
43895>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
43896>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
43897>>>>>>>>>>>>>    //AB-StoreEnd
43897>>>>>>>>>>>>>
43897>>>>>>>>>>>>>End_Object    // sl053
43898>>>>>>>>>>>>>
43898>>>>>>>>>>>>>//AB/ End_Object    // prj
43898>>>>>>>>>>>Use sl064.SL         // sl064
INCLUDING FILE: SL064.SL
43898>>>>>>>>>>>>>//AB/ Project sl064 : Zones
43898>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
43898>>>>>>>>>>>>>//AB/     Set ProjectName to "sl064 : Zones"
43898>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl064.SL"
43898>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
43898>>>>>>>>>>>>>
43898>>>>>>>>>>>>>// Project Object Structure
43898>>>>>>>>>>>>>//   sl064 is a dbModalPanelSub
43898>>>>>>>>>>>>>//     Zones_DD is a DataDictionary
43898>>>>>>>>>>>>>//     oSelList is a dbListSub
43898>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
43898>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
43898>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
43898>>>>>>>>>>>>>
43898>>>>>>>>>>>>>// Register all objects
43898>>>>>>>>>>>>>Register_Object oCancel_bn
43898>>>>>>>>>>>>>Register_Object oOK_bn
43898>>>>>>>>>>>>>Register_Object oSearch_bn
43898>>>>>>>>>>>>>Register_Object oSelList
43898>>>>>>>>>>>>>Register_Object sl064
43898>>>>>>>>>>>>>Register_Object Zones_DD
43898>>>>>>>>>>>>>
43898>>>>>>>>>>>>>
43898>>>>>>>>>>>>>//AB-IgnoreStart
43898>>>>>>>>>>>>>
43898>>>>>>>>>>>>>Use DFAllEnt.pkg
43898>>>>>>>>>>>>>Use dbList.Sub
43898>>>>>>>>>>>>>Use Button.Sub
43898>>>>>>>>>>>>>
43898>>>>>>>>>>>>>
43898>>>>>>>>>>>>>Use ZONES.DD
INCLUDING FILE: ZONES.DD
43898>>>>>>>>>>>>>>>//DDB-FileStart
43898>>>>>>>>>>>>>>>//DDB-HeaderStart
43898>>>>>>>>>>>>>>>
43898>>>>>>>>>>>>>>>// File Name : ZONES.DD
43898>>>>>>>>>>>>>>>// Class Name: Zones_DataDictionary
43898>>>>>>>>>>>>>>>// Revision  : 4
43898>>>>>>>>>>>>>>>// Version   : 2
43898>>>>>>>>>>>>>>>
43898>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
43898>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43898>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43898>>>>>>>>>>>>>>>
43898>>>>>>>>>>>>>>>Open Zones
INCLUDING FILE: ZONES.FD
43900>>>>>>>>>>>>>>>Open Brzones
43902>>>>>>>>>>>>>>>
43902>>>>>>>>>>>>>>>//DDB-HeaderEnd
43902>>>>>>>>>>>>>>>//DDB-SelectionStart
43902>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl064  sl064.SL
43902>>>>>>>>>>>>>>>Register_Object sl064
43902>>>>>>>>>>>>>>>//DDB-SelectionEnd
43902>>>>>>>>>>>>>>>
43902>>>>>>>>>>>>>>>Class Zones_DataDictionary  is a DataDictionary_Sec
43903>>>>>>>>>>>>>>>
43903>>>>>>>>>>>>>>>    // Define_Fields:
43903>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43903>>>>>>>>>>>>>>>
43903>>>>>>>>>>>>>>>    Procedure Define_Fields
43904>>>>>>>>>>>>>>>        Forward Send Define_Fields
43906>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43906>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
43906>>>>>>>>>>>>>>>
43906>>>>>>>>>>>>>>>        Set Main_File            To Zones.File_Number
43907>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
43908>>>>>>>>>>>>>>>
43908>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
43909>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
43910>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43911>>>>>>>>>>>>>>>
43911>>>>>>>>>>>>>>>        // Child (Client) file structure................
43911>>>>>>>>>>>>>>>        Send Add_Client_File  Brzones.File_Number
43912>>>>>>>>>>>>>>>
43912>>>>>>>>>>>>>>>        // Field-based properties.......................
43912>>>>>>>>>>>>>>>
43912>>>>>>>>>>>>>>>        // Zones.Zone_Id
43912>>>>>>>>>>>>>>>        Set Field_Options          Field Zones.Zone_Id To DD_AUTOFIND   
43913>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Zones.Zone_Id To (sl064(Self))
43914>>>>>>>>>>>>>>>        Set Key_Field_State        Field Zones.Zone_Id To TRUE
43915>>>>>>>>>>>>>>>
43915>>>>>>>>>>>>>>>        // Zones.Zone_Descr
43915>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Zones.Zone_Descr To (sl064(Self))
43916>>>>>>>>>>>>>>>
43916>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
43916>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
43917>>>>>>>>>>>>>>>
43917>>>>>>>>>>>>>>>    // Field_Defaults:
43917>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
43917>>>>>>>>>>>>>>>
43917>>>>>>>>>>>>>>>    Procedure Field_Defaults
43918>>>>>>>>>>>>>>>        Forward Send Field_Defaults
43920>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43920>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
43920>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
43920>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
43921>>>>>>>>>>>>>>>
43921>>>>>>>>>>>>>>>End_Class    // Zones_DataDictionary
43922>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
43922>>>>>>>>>>>>>>>
43922>>>>>>>>>>>>>>>Use sl064.SL         // sl064
43922>>>>>>>>>>>>>>>
43922>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
43922>>>>>>>>>>>>>>>//DDB-FileEnd
43922>>>>>>>>>>>>>
43922>>>>>>>>>>>>>//AB-IgnoreEnd
43922>>>>>>>>>>>>>
43922>>>>>>>>>>>>>CD_Popup_Object sl064 is a dbModalPanelSub
43941>>>>>>>>>>>>>    Set Label to "…é¤œª"
43942>>>>>>>>>>>>>    Set Size to 148 297
43943>>>>>>>>>>>>>    Set Location to 4 5
43944>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
43945>>>>>>>>>>>>>    Set Modal_State to FALSE
43946>>>>>>>>>>>>>
43946>>>>>>>>>>>>>    //AB-DDOStart
43946>>>>>>>>>>>>>
43946>>>>>>>>>>>>>    Object Zones_DD is a Zones_DataDictionary
43948>>>>>>>>>>>>>    End_Object    // Zones_DD
43949>>>>>>>>>>>>>
43949>>>>>>>>>>>>>    Set Main_DD to (Zones_DD(self))
43950>>>>>>>>>>>>>    Set Server to (Zones_DD(self))
43951>>>>>>>>>>>>>
43951>>>>>>>>>>>>>    //AB-DDOEnd
43951>>>>>>>>>>>>>
43951>>>>>>>>>>>>>    Object oSelList is a dbListSub
43953>>>>>>>>>>>>>        Set Main_File to Zones.File_Number
43954>>>>>>>>>>>>>        Set Size to 105 280
43955>>>>>>>>>>>>>        Set Location to 6 6
43956>>>>>>>>>>>>>
43956>>>>>>>>>>>>>        Begin_Row
43959>>>>>>>>>>>>>            Entry_Item Zones.Zone_id
43960>>>>>>>>>>>>>            Entry_Item Zones.Zone_descr
43961>>>>>>>>>>>>>        End_Row
43966>>>>>>>>>>>>>
43966>>>>>>>>>>>>>        Set Form_Width    item 0 to 73
43967>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
43968>>>>>>>>>>>>>        
43968>>>>>>>>>>>>>        Set Form_Width    item 1 to 199
43969>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
43970>>>>>>>>>>>>>        
43970>>>>>>>>>>>>>    End_Object    // oSelList
43971>>>>>>>>>>>>>
43971>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
43973>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
43974>>>>>>>>>>>>>        Set Location to 115 126
43975>>>>>>>>>>>>>
43975>>>>>>>>>>>>>        //AB-StoreStart
43975>>>>>>>>>>>>>        Procedure OnClick
43977>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
43978>>>>>>>>>>>>>        End_Procedure
43979>>>>>>>>>>>>>        //AB-StoreEnd
43979>>>>>>>>>>>>>
43979>>>>>>>>>>>>>    End_Object    // oOK_bn
43980>>>>>>>>>>>>>
43980>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
43982>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
43983>>>>>>>>>>>>>        Set Location to 115 181
43984>>>>>>>>>>>>>
43984>>>>>>>>>>>>>        //AB-StoreStart
43984>>>>>>>>>>>>>        Procedure OnClick
43986>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
43987>>>>>>>>>>>>>        End_Procedure
43988>>>>>>>>>>>>>        //AB-StoreEnd
43988>>>>>>>>>>>>>
43988>>>>>>>>>>>>>    End_Object    // oCancel_bn
43989>>>>>>>>>>>>>
43989>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
43991>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
43992>>>>>>>>>>>>>        Set Location to 115 236
43993>>>>>>>>>>>>>
43993>>>>>>>>>>>>>        //AB-StoreStart
43993>>>>>>>>>>>>>        Procedure OnClick
43995>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
43996>>>>>>>>>>>>>        End_Procedure
43997>>>>>>>>>>>>>        //AB-StoreEnd
43997>>>>>>>>>>>>>
43997>>>>>>>>>>>>>    End_Object    // oSearch_bn
43998>>>>>>>>>>>>>
43998>>>>>>>>>>>>>
43998>>>>>>>>>>>>>    //AB-StoreStart
43998>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
43999>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
44000>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
44001>>>>>>>>>>>>>    //AB-StoreEnd
44001>>>>>>>>>>>>>
44001>>>>>>>>>>>>>CD_End_Object    // sl064
44003>>>>>>>>>>>>>>
44003>>>>>>>>>>>>>
44003>>>>>>>>>>>>>//AB/ End_Object    // prj
44003>>>>>>>>>>>
44003>>>>>>>>>>>//DDB-Selection-pkg-End
44003>>>>>>>>>>>//DDB-FileEnd
44003>>>>>>>>>    Use WAPOKAT.DD
INCLUDING FILE: WAPOKAT.DD
44003>>>>>>>>>>>//DDB-FileStart
44003>>>>>>>>>>>//DDB-HeaderStart
44003>>>>>>>>>>>
44003>>>>>>>>>>>// File Name : WAPOKAT.DD
44003>>>>>>>>>>>// Class Name: Wapokat_DataDictionary
44003>>>>>>>>>>>// Revision  : 21
44003>>>>>>>>>>>// Version   : 2
44003>>>>>>>>>>>
44003>>>>>>>>>>>Use  Windows           // Basic Definitions
44003>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
44003>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
44003>>>>>>>>>>>
44003>>>>>>>>>>>Open Wapokat
INCLUDING FILE: WAPOKAT.FD
44005>>>>>>>>>>>Open Wapomast
INCLUDING FILE: WAPOMAST.FD
44007>>>>>>>>>>>Open Sysrecw
44009>>>>>>>>>>>Open Syscurxr
44011>>>>>>>>>>>
44011>>>>>>>>>>>//DDB-HeaderEnd
44011>>>>>>>>>>>//DDB-SelectionStart
44011>>>>>>>>>>>//DDB/ ExternalSelectionList sl022  sl022.SL
44011>>>>>>>>>>>Register_Object sl022
44011>>>>>>>>>>>//DDB-SelectionEnd
44011>>>>>>>>>>>
44011>>>>>>>>>>>Class Wapokat_DataDictionary  is a DataDictionary
44012>>>>>>>>>>>
44012>>>>>>>>>>>    // Update:
44012>>>>>>>>>>>    Procedure Update
44013>>>>>>>>>>>        Forward Send Update
44015>>>>>>>>>>>        // Insert Code Here
44015>>>>>>>>>>>//        Move SysCurXR.Company_Code   to Wapokat.Company_Code
44015>>>>>>>>>>>//        Move SysCurXR.Branch_Code     to Wapokat.Branch_Code
44015>>>>>>>>>>>//        Move SysCurXR.Year_Year         to Wapokat.Year_Year
44015>>>>>>>>>>>    End_Procedure   // Update
44016>>>>>>>>>>> 
44016>>>>>>>>>>>     Procedure Creating
44017>>>>>>>>>>>        Forward Send Creating
44019>>>>>>>>>>>        // Insert Code Here
44019>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wapokat.Wapokat_Rec0)))))) to Wapokat.Wapokat_Recr
44020>>>>>>>>>>>    End_Procedure   // Creating
44021>>>>>>>>>>>
44021>>>>>>>>>>>
44021>>>>>>>>>>>    // Define_Fields:
44021>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44021>>>>>>>>>>>
44021>>>>>>>>>>>    Procedure Define_Fields
44022>>>>>>>>>>>        Forward Send Define_Fields
44024>>>>>>>>>>>        //DDB-Generated-Code-Location
44024>>>>>>>>>>>        //DDB-DefineFieldStart
44024>>>>>>>>>>>
44024>>>>>>>>>>>        Set Main_File            To Wapokat.File_Number
44025>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
44026>>>>>>>>>>>
44026>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
44027>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
44028>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
44029>>>>>>>>>>>
44029>>>>>>>>>>>        // Child (Client) file structure................
44029>>>>>>>>>>>        Send Add_Client_File  Wapomast.File_Number
44030>>>>>>>>>>>
44030>>>>>>>>>>>        // External (System) file structure.............
44030>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
44031>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
44032>>>>>>>>>>>
44032>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wapokat_Rec0  To Wapokat.Wapokat_Rec0
44035>>>>>>>>>>>
44035>>>>>>>>>>>        // Field-based properties.......................
44035>>>>>>>>>>>
44035>>>>>>>>>>>        // Wapokat.Wapokat_Code
44035>>>>>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Code To DD_AUTOFIND   
44036>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapokat.Wapokat_Code To (sl022(Self))
44037>>>>>>>>>>>
44037>>>>>>>>>>>        // Wapokat.Wapokat_Rec0
44037>>>>>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Rec0 To DD_AUTOFIND   
44038>>>>>>>>>>>
44038>>>>>>>>>>>        // Wapokat.Wapokat_Descr
44038>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapokat.Wapokat_Descr To (sl022(Self))
44039>>>>>>>>>>>
44039>>>>>>>>>>>        // Wapokat.Wapokat_Recr
44039>>>>>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Recr To DD_AUTOFIND   
44040>>>>>>>>>>>
44040>>>>>>>>>>>        // Wapokat.Enhm_Sap
44040>>>>>>>>>>>
44040>>>>>>>>>>>        // Wapokat.Sap_Descr
44040>>>>>>>>>>>
44040>>>>>>>>>>>        // Wapokat.Gl
44040>>>>>>>>>>>
44040>>>>>>>>>>>        // Wapokat.Glzz
44040>>>>>>>>>>>
44040>>>>>>>>>>>        // Wapokat.Oximm1
44040>>>>>>>>>>>
44040>>>>>>>>>>>        //DDB-DefineFieldEnd
44040>>>>>>>>>>>    End_Procedure    // Define_Fields
44041>>>>>>>>>>>
44041>>>>>>>>>>>    // Field_Defaults:
44041>>>>>>>>>>>    // This procedure is used to establish default field values.
44041>>>>>>>>>>>
44041>>>>>>>>>>>    Procedure Field_Defaults
44042>>>>>>>>>>>        Forward Send Field_Defaults
44044>>>>>>>>>>>        //DDB-Generated-Code-Location
44044>>>>>>>>>>>        //DDB-FieldDefaultStart
44044>>>>>>>>>>>        //DDB-FieldDefaultEnd
44044>>>>>>>>>>>    End_Procedure    // Field_Defaults
44045>>>>>>>>>>>
44045>>>>>>>>>>>End_Class    // Wapokat_DataDictionary
44046>>>>>>>>>>>//DDB-Selection-pkg-Start
44046>>>>>>>>>>>
44046>>>>>>>>>>>Use sl022.SL         // sl022
INCLUDING FILE: SL022.SL
44046>>>>>>>>>>>>>//AB/ Project sl022:kathg-apothkon
44046>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
44046>>>>>>>>>>>>>//AB/     Set ProjectName to "sl022:kathg-apothkon"
44046>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl022.SL"
44046>>>>>>>>>>>>>
44046>>>>>>>>>>>>>// Project Object Structure
44046>>>>>>>>>>>>>//   sl022 is a dbModalPanelSub
44046>>>>>>>>>>>>>//     Wapokat_DD is a DataDictionary
44046>>>>>>>>>>>>>//     oSelList is a dbListSub
44046>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
44046>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
44046>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
44046>>>>>>>>>>>>>
44046>>>>>>>>>>>>>// Register all objects
44046>>>>>>>>>>>>>Register_Object oCancel_bn
44046>>>>>>>>>>>>>Register_Object oOK_bn
44046>>>>>>>>>>>>>Register_Object oSearch_bn
44046>>>>>>>>>>>>>Register_Object oSelList
44046>>>>>>>>>>>>>Register_Object sl022
44046>>>>>>>>>>>>>Register_Object Wapokat_DD
44046>>>>>>>>>>>>>
44046>>>>>>>>>>>>>
44046>>>>>>>>>>>>>//AB-IgnoreStart
44046>>>>>>>>>>>>>
44046>>>>>>>>>>>>>Use DFAllEnt.pkg
44046>>>>>>>>>>>>>Use dbList.Sub
44046>>>>>>>>>>>>>Use Button.Sub
44046>>>>>>>>>>>>>
44046>>>>>>>>>>>>>
44046>>>>>>>>>>>>>Use WAPOKAT.DD
44046>>>>>>>>>>>>>
44046>>>>>>>>>>>>>//AB-IgnoreEnd
44046>>>>>>>>>>>>>
44046>>>>>>>>>>>>>CD_Popup_Object sl022 is a dbModalPanelSub
44065>>>>>>>>>>>>>    set label to "‰˜«žš¦¨åœª €§¦Ÿž¡é¤" 
44066>>>>>>>>>>>>>    Set Size to 148 297
44067>>>>>>>>>>>>>    Set Location to 12 19
44068>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
44069>>>>>>>>>>>>>    Set Modal_State to FALSE
44070>>>>>>>>>>>>>
44070>>>>>>>>>>>>>    //AB-DDOStart
44070>>>>>>>>>>>>>
44070>>>>>>>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
44072>>>>>>>>>>>>>    End_Object    // Wapokat_DD
44073>>>>>>>>>>>>>
44073>>>>>>>>>>>>>    Set Main_DD to (Wapokat_DD(self))
44074>>>>>>>>>>>>>    Set Server to (Wapokat_DD(self))
44075>>>>>>>>>>>>>
44075>>>>>>>>>>>>>    //AB-DDOEnd
44075>>>>>>>>>>>>>
44075>>>>>>>>>>>>>    Object oSelList is a dbListSub
44077>>>>>>>>>>>>>        Set Main_File to Wapokat.File_Number
44078>>>>>>>>>>>>>        Set Size to 105 280
44079>>>>>>>>>>>>>        Set Location to 6 6
44080>>>>>>>>>>>>>
44080>>>>>>>>>>>>>        Begin_Row
44083>>>>>>>>>>>>>            Entry_Item Wapokat.Wapokat_code
44084>>>>>>>>>>>>>            Entry_Item Wapokat.Wapokat_descr
44085>>>>>>>>>>>>>        End_Row
44090>>>>>>>>>>>>>
44090>>>>>>>>>>>>>        Set Form_Width    item 0 to 42
44091>>>>>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
44092>>>>>>>>>>>>>        
44092>>>>>>>>>>>>>        Set Form_Width    item 1 to 228
44093>>>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
44094>>>>>>>>>>>>>        
44094>>>>>>>>>>>>>    End_Object    // oSelList
44095>>>>>>>>>>>>>
44095>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
44097>>>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
44098>>>>>>>>>>>>>        Set Location to 115 126
44099>>>>>>>>>>>>>
44099>>>>>>>>>>>>>        //AB-StoreStart
44099>>>>>>>>>>>>>        Procedure OnClick
44101>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
44102>>>>>>>>>>>>>        End_Procedure
44103>>>>>>>>>>>>>        //AB-StoreEnd
44103>>>>>>>>>>>>>
44103>>>>>>>>>>>>>    End_Object    // oOK_bn
44104>>>>>>>>>>>>>
44104>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
44106>>>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
44107>>>>>>>>>>>>>        Set Location to 115 181
44108>>>>>>>>>>>>>
44108>>>>>>>>>>>>>        //AB-StoreStart
44108>>>>>>>>>>>>>        Procedure OnClick
44110>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
44111>>>>>>>>>>>>>        End_Procedure
44112>>>>>>>>>>>>>        //AB-StoreEnd
44112>>>>>>>>>>>>>
44112>>>>>>>>>>>>>    End_Object    // oCancel_bn
44113>>>>>>>>>>>>>
44113>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
44115>>>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
44116>>>>>>>>>>>>>        Set Location to 115 236
44117>>>>>>>>>>>>>
44117>>>>>>>>>>>>>        //AB-StoreStart
44117>>>>>>>>>>>>>        Procedure OnClick
44119>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
44120>>>>>>>>>>>>>        End_Procedure
44121>>>>>>>>>>>>>        //AB-StoreEnd
44121>>>>>>>>>>>>>
44121>>>>>>>>>>>>>    End_Object    // oSearch_bn
44122>>>>>>>>>>>>>
44122>>>>>>>>>>>>>
44122>>>>>>>>>>>>>    //AB-StoreStart
44122>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
44123>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
44124>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
44125>>>>>>>>>>>>>    //AB-StoreEnd
44125>>>>>>>>>>>>>
44125>>>>>>>>>>>>>CD_End_Object    // sl022
44127>>>>>>>>>>>>>>
44127>>>>>>>>>>>>>
44127>>>>>>>>>>>>>//AB/ End_Object    // prj
44127>>>>>>>>>>>
44127>>>>>>>>>>>//DDB-Selection-pkg-End
44127>>>>>>>>>>>//DDB-FileEnd
44127>>>>>>>>>    Use WAPOMAST.DD
INCLUDING FILE: WAPOMAST.DD
44127>>>>>>>>>>>//DDB-FileStart
44127>>>>>>>>>>>//DDB-HeaderStart
44127>>>>>>>>>>>
44127>>>>>>>>>>>// File Name : WAPOMAST.DD
44127>>>>>>>>>>>// Class Name: Wapomast_DataDictionary
44127>>>>>>>>>>>// Revision  : 13
44127>>>>>>>>>>>// Version   : 2
44127>>>>>>>>>>>
44127>>>>>>>>>>>Use  Windows           // Basic Definitions
44127>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
44127>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
44127>>>>>>>>>>>
44127>>>>>>>>>>>Open Wapomast
44129>>>>>>>>>>>Open Wax
44131>>>>>>>>>>>Open Wapokat
44133>>>>>>>>>>>Open Sysrecw
44135>>>>>>>>>>>
44135>>>>>>>>>>>//DDB-HeaderEnd
44135>>>>>>>>>>>//DDB-SelectionStart
44135>>>>>>>>>>>//DDB/ ExternalSelectionList sl023  sl023.SL
44135>>>>>>>>>>>Register_Object sl023
44135>>>>>>>>>>>//DDB-SelectionEnd
44135>>>>>>>>>>>
44135>>>>>>>>>>>Class Wapomast_DataDictionary  is a DataDictionary
44136>>>>>>>>>>>    // Update:
44136>>>>>>>>>>>    Procedure Update
44137>>>>>>>>>>>        Forward Send Update
44139>>>>>>>>>>>        // Insert Code Here
44139>>>>>>>>>>>//        Move SysCurXR.Company_Code   to Wapomast.Company_Code
44139>>>>>>>>>>>//        Move SysCurXR.Branch_Code     to Wapomast.Branch_Code
44139>>>>>>>>>>>//        Move SysCurXR.Year_Year         to Wapomast.Year_Year
44139>>>>>>>>>>>        Move Wapokat.Wapokat_Code   to Wapomast.Wapokat_Code
44140>>>>>>>>>>>    End_Procedure   // Update
44141>>>>>>>>>>> 
44141>>>>>>>>>>>     Procedure Creating
44142>>>>>>>>>>>        Forward Send Creating
44144>>>>>>>>>>>        // Insert Code Here
44144>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wapomast.Wapomast_Rec0)))))) to Wapomast.Wapomast_Recr
44145>>>>>>>>>>>    End_Procedure   // Creating
44146>>>>>>>>>>>
44146>>>>>>>>>>>
44146>>>>>>>>>>>    // Define_Fields:
44146>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44146>>>>>>>>>>>
44146>>>>>>>>>>>    Procedure Define_Fields
44147>>>>>>>>>>>        Forward Send Define_Fields
44149>>>>>>>>>>>        //DDB-Generated-Code-Location
44149>>>>>>>>>>>        //DDB-DefineFieldStart
44149>>>>>>>>>>>
44149>>>>>>>>>>>        Set Main_File            To Wapomast.File_Number
44150>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
44151>>>>>>>>>>>
44151>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
44152>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
44153>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
44154>>>>>>>>>>>
44154>>>>>>>>>>>        // Child (Client) file structure................
44154>>>>>>>>>>>        Send Add_Client_File  Wax.File_Number
44155>>>>>>>>>>>
44155>>>>>>>>>>>        // Parent (Server) file structure...............
44155>>>>>>>>>>>        Send Add_Server_File  Wapokat.File_Number
44156>>>>>>>>>>>
44156>>>>>>>>>>>        // External (System) file structure.............
44156>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
44157>>>>>>>>>>>
44157>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wapomast_Rec0  To Wapomast.Wapomast_Rec0
44160>>>>>>>>>>>
44160>>>>>>>>>>>        // Field-based properties.......................
44160>>>>>>>>>>>
44160>>>>>>>>>>>        // Wapomast.Wapokat_Code
44160>>>>>>>>>>>
44160>>>>>>>>>>>        // Wapomast.Wapokat_Recr
44160>>>>>>>>>>>
44160>>>>>>>>>>>        // Wapomast.Wapomast_Code
44160>>>>>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Code To DD_AUTOFIND   
44161>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapomast.Wapomast_Code To (sl023(Self))
44162>>>>>>>>>>>
44162>>>>>>>>>>>        // Wapomast.Wapomast_Rec0
44162>>>>>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Rec0 To DD_AUTOFIND   
44163>>>>>>>>>>>
44163>>>>>>>>>>>        // Wapomast.Wapomast_Descr
44163>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapomast.Wapomast_Descr To (sl023(Self))
44164>>>>>>>>>>>
44164>>>>>>>>>>>        // Wapomast.Wapomast_Recr
44164>>>>>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Recr To DD_AUTOFIND   
44165>>>>>>>>>>>
44165>>>>>>>>>>>        //DDB-DefineFieldEnd
44165>>>>>>>>>>>    End_Procedure    // Define_Fields
44166>>>>>>>>>>>
44166>>>>>>>>>>>    // Field_Defaults:
44166>>>>>>>>>>>    // This procedure is used to establish default field values.
44166>>>>>>>>>>>
44166>>>>>>>>>>>    Procedure Field_Defaults
44167>>>>>>>>>>>        Forward Send Field_Defaults
44169>>>>>>>>>>>        //DDB-Generated-Code-Location
44169>>>>>>>>>>>        //DDB-FieldDefaultStart
44169>>>>>>>>>>>        //DDB-FieldDefaultEnd
44169>>>>>>>>>>>    End_Procedure    // Field_Defaults
44170>>>>>>>>>>>
44170>>>>>>>>>>>End_Class    // Wapomast_DataDictionary
44171>>>>>>>>>>>//DDB-Selection-pkg-Start
44171>>>>>>>>>>>
44171>>>>>>>>>>>Use sl023.SL         // sl023
INCLUDING FILE: SL023.SL
44171>>>>>>>>>>>>>//AB/ Project sl023:apothkes
44171>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
44171>>>>>>>>>>>>>//AB/     Set ProjectName to "sl023:apothkes"
44171>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl023.SL"
44171>>>>>>>>>>>>>
44171>>>>>>>>>>>>>// Project Object Structure
44171>>>>>>>>>>>>>//   sl023 is a dbModalPanelSub
44171>>>>>>>>>>>>>//     Wapokat_DD is a DataDictionary
44171>>>>>>>>>>>>>//     Wapomast_DD is a DataDictionary
44171>>>>>>>>>>>>>//     oSelList is a dbListSub
44171>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
44171>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
44171>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
44171>>>>>>>>>>>>>
44171>>>>>>>>>>>>>// Register all objects
44171>>>>>>>>>>>>>Register_Object oCancel_bn
44171>>>>>>>>>>>>>Register_Object oOK_bn
44171>>>>>>>>>>>>>Register_Object oSearch_bn
44171>>>>>>>>>>>>>Register_Object oSelList
44171>>>>>>>>>>>>>Register_Object sl023
44171>>>>>>>>>>>>>Register_Object Wapokat_DD
44171>>>>>>>>>>>>>Register_Object Wapomast_DD
44171>>>>>>>>>>>>>
44171>>>>>>>>>>>>>
44171>>>>>>>>>>>>>//AB-IgnoreStart
44171>>>>>>>>>>>>>
44171>>>>>>>>>>>>>Use DFAllEnt.pkg
44171>>>>>>>>>>>>>Use dbList.Sub
44171>>>>>>>>>>>>>Use Button.Sub
44171>>>>>>>>>>>>>
44171>>>>>>>>>>>>>
44171>>>>>>>>>>>>>Use WAPOKAT.DD
44171>>>>>>>>>>>>>Use WAPOMAST.DD
44171>>>>>>>>>>>>>
44171>>>>>>>>>>>>>//AB-IgnoreEnd
44171>>>>>>>>>>>>>
44171>>>>>>>>>>>>>Object sl023 is a dbModalPanelSub
44173>>>>>>>>>>>>>
44173>>>>>>>>>>>>>    //AB-StoreTopStart
44173>>>>>>>>>>>>>    property string psapokat public ''
44175>>>>>>>>>>>>>    //AB-StoreTopEnd
44175>>>>>>>>>>>>>
44175>>>>>>>>>>>>>    Set Label to "€§¦Ÿã¡œª"
44176>>>>>>>>>>>>>    Set Size to 126 260
44177>>>>>>>>>>>>>    Set Location to 4 19
44178>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
44179>>>>>>>>>>>>>    Set Modal_State to FALSE
44180>>>>>>>>>>>>>
44180>>>>>>>>>>>>>    //AB-DDOStart
44180>>>>>>>>>>>>>
44180>>>>>>>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
44182>>>>>>>>>>>>>    End_Object    // Wapokat_DD
44183>>>>>>>>>>>>>
44183>>>>>>>>>>>>>    Object Wapomast_DD is a Wapomast_DataDictionary
44185>>>>>>>>>>>>>        Set DDO_Server to (Wapokat_DD(self))
44186>>>>>>>>>>>>>
44186>>>>>>>>>>>>>        //AB-StoreStart
44186>>>>>>>>>>>>>        
44186>>>>>>>>>>>>>        begin_constraints
44188>>>>>>>>>>>>>          if (psapokat(self) <> '') constrain wapomast.wapokat_code eq (psapokat(self))
44192>>>>>>>>>>>>>        
44192>>>>>>>>>>>>>        end_constraints
44195>>>>>>>>>>>>>        
44195>>>>>>>>>>>>>        //AB-StoreEnd
44195>>>>>>>>>>>>>
44195>>>>>>>>>>>>>    End_Object    // Wapomast_DD
44196>>>>>>>>>>>>>
44196>>>>>>>>>>>>>    Set Main_DD to (Wapomast_DD(self))
44197>>>>>>>>>>>>>    Set Server to (Wapomast_DD(self))
44198>>>>>>>>>>>>>
44198>>>>>>>>>>>>>    //AB-DDOEnd
44198>>>>>>>>>>>>>
44198>>>>>>>>>>>>>    Object oSelList is a dbListSub
44200>>>>>>>>>>>>>        Set Main_File to Wapomast.File_Number
44201>>>>>>>>>>>>>        Set Server to (Wapokat_DD(self))
44202>>>>>>>>>>>>>        Set Size to 89 240
44203>>>>>>>>>>>>>        Set Location to 6 6
44204>>>>>>>>>>>>>
44204>>>>>>>>>>>>>        Begin_Row
44207>>>>>>>>>>>>>            Entry_Item Wapomast.Wapomast_code
44208>>>>>>>>>>>>>            Entry_Item Wapomast.Wapomast_descr
44209>>>>>>>>>>>>>        End_Row
44214>>>>>>>>>>>>>
44214>>>>>>>>>>>>>        Set Form_Width    item 0 to 70
44215>>>>>>>>>>>>>        Set Header_Label  item 0 to "€§¦Ÿã¡ž      :"
44216>>>>>>>>>>>>>        
44216>>>>>>>>>>>>>        Set Form_Width    item 1 to 160
44217>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
44218>>>>>>>>>>>>>        
44218>>>>>>>>>>>>>
44218>>>>>>>>>>>>>        //AB-StoreStart
44218>>>>>>>>>>>>>                    
44218>>>>>>>>>>>>>                    
44218>>>>>>>>>>>>>        //AB-StoreEnd
44218>>>>>>>>>>>>>
44218>>>>>>>>>>>>>    End_Object    // oSelList
44219>>>>>>>>>>>>>
44219>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
44221>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
44222>>>>>>>>>>>>>        Set Location to 92 81
44223>>>>>>>>>>>>>
44223>>>>>>>>>>>>>        //AB-StoreStart
44223>>>>>>>>>>>>>        Procedure OnClick
44225>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
44226>>>>>>>>>>>>>        End_Procedure
44227>>>>>>>>>>>>>        //AB-StoreEnd
44227>>>>>>>>>>>>>
44227>>>>>>>>>>>>>    End_Object    // oOK_bn
44228>>>>>>>>>>>>>
44228>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
44230>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
44231>>>>>>>>>>>>>        Set Location to 92 135
44232>>>>>>>>>>>>>
44232>>>>>>>>>>>>>        //AB-StoreStart
44232>>>>>>>>>>>>>        Procedure OnClick
44234>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
44235>>>>>>>>>>>>>        End_Procedure
44236>>>>>>>>>>>>>        //AB-StoreEnd
44236>>>>>>>>>>>>>
44236>>>>>>>>>>>>>    End_Object    // oCancel_bn
44237>>>>>>>>>>>>>
44237>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
44239>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
44240>>>>>>>>>>>>>        Set Location to 92 191
44241>>>>>>>>>>>>>
44241>>>>>>>>>>>>>        //AB-StoreStart
44241>>>>>>>>>>>>>        Procedure OnClick
44243>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
44244>>>>>>>>>>>>>        End_Procedure
44245>>>>>>>>>>>>>        //AB-StoreEnd
44245>>>>>>>>>>>>>
44245>>>>>>>>>>>>>    End_Object    // oSearch_bn
44246>>>>>>>>>>>>>
44246>>>>>>>>>>>>>
44246>>>>>>>>>>>>>    //AB-StoreStart
44246>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
44247>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
44248>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
44249>>>>>>>>>>>>>    
44249>>>>>>>>>>>>>    procedure activate
44251>>>>>>>>>>>>>        send rebuild_constraints to wapomast_dd
44252>>>>>>>>>>>>>        send beginning_of_data to osellist true
44253>>>>>>>>>>>>>        forward send activate
44255>>>>>>>>>>>>>    end_procedure
44256>>>>>>>>>>>>>    
44256>>>>>>>>>>>>>    
44256>>>>>>>>>>>>>    //AB-StoreEnd
44256>>>>>>>>>>>>>
44256>>>>>>>>>>>>>End_Object    // sl023
44257>>>>>>>>>>>>>
44257>>>>>>>>>>>>>//AB/ End_Object    // prj
44257>>>>>>>>>>>
44257>>>>>>>>>>>//DDB-Selection-pkg-End
44257>>>>>>>>>>>//DDB-FileEnd
44257>>>>>>>>>    Use WAX.DD
INCLUDING FILE: WAX.DD
44257>>>>>>>>>>>//DDB-FileStart
44257>>>>>>>>>>>//DDB-HeaderStart
44257>>>>>>>>>>>
44257>>>>>>>>>>>// File Name : WAX.DD
44257>>>>>>>>>>>// Class Name: Wax_DataDictionary
44257>>>>>>>>>>>// Revision  : 39
44257>>>>>>>>>>>// Version   : 2
44257>>>>>>>>>>>
44257>>>>>>>>>>>Use  Windows           // Basic Definitions
44257>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
44257>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
44257>>>>>>>>>>>
44257>>>>>>>>>>>Open Wax
44259>>>>>>>>>>>Open Pmoves
44261>>>>>>>>>>>Open Wcmoves
44263>>>>>>>>>>>Open Wam
INCLUDING FILE: WAM.FD
44265>>>>>>>>>>>Open Pmovesl
44267>>>>>>>>>>>Open Wapomast
44269>>>>>>>>>>>Open Sysrecw
44271>>>>>>>>>>>Open Syscurxr
44273>>>>>>>>>>>
44273>>>>>>>>>>>//DDB-HeaderEnd
44273>>>>>>>>>>>//DDB-SelectionStart
44273>>>>>>>>>>>//DDB/ ExternalSelectionList Wax  Wax.SL
44273>>>>>>>>>>>Register_Object Wax
44273>>>>>>>>>>>//DDB-SelectionEnd
44273>>>>>>>>>>>
44273>>>>>>>>>>>Open Units
INCLUDING FILE: UNITS.FD
44275>>>>>>>>>>>Open Wapokat
44277>>>>>>>>>>>Open WitemKat
INCLUDING FILE: WITEMKAT.FD
44279>>>>>>>>>>>
44279>>>>>>>>>>>Class Wax_DataDictionary  is a DataDictionary_Sec
44280>>>>>>>>>>>
44280>>>>>>>>>>>    Procedure Construct_Object
44281>>>>>>>>>>>        Forward Send Construct_Object
44283>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
44284>>>>>>>>>>>    End_Procedure //construct_object
44285>>>>>>>>>>>
44285>>>>>>>>>>>    Procedure OnConstrain
44286>>>>>>>>>>>        Forward Send OnConstrain
44288>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
44290>>>>>>>>>>>        End
44290>>>>>>>>>>>>
44290>>>>>>>>>>>        Else Begin
44291>>>>>>>>>>>            Constrain Wax.Company_Code  eq SysCurXR.Company_Code
44293>>>>>>>>>>>            Constrain Wax.Branch_Code   eq SysCurXR.Branch_Code
44295>>>>>>>>>>>            Constrain Wax.Year_Year     eq SysCurXR.Year_Year
44297>>>>>>>>>>>        End
44297>>>>>>>>>>>>
44297>>>>>>>>>>>    End_Procedure
44298>>>>>>>>>>>
44298>>>>>>>>>>>
44298>>>>>>>>>>>    // Update:
44298>>>>>>>>>>>    Procedure Update
44299>>>>>>>>>>>        Forward Send Update
44301>>>>>>>>>>>        // Insert Code Here
44301>>>>>>>>>>>        Move SysCurXR.Company_Code  to Wax.Company_Code
44302>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Wax.Branch_Code
44303>>>>>>>>>>>        Move SysCurXR.Year_Year     to Wax.Year_Year
44304>>>>>>>>>>>        Move SysCurXR.Year_Recr     to Wax.Year_Recr
44305>>>>>>>>>>>        Move Wapokat.Wapokat_Code   to Wax.Wapokat_Code
44306>>>>>>>>>>>        Move Wapomast.Wapomast_Code to Wax.Wapomast_Code
44307>>>>>>>>>>>    End_Procedure   // Update
44308>>>>>>>>>>>
44308>>>>>>>>>>>     Procedure Creating
44309>>>>>>>>>>>        Forward Send Creating
44311>>>>>>>>>>>        // Insert Code Here
44311>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wax.Wax_Rec0)))))) to Wax.Wax_Recr
44312>>>>>>>>>>>    End_Procedure   // Creating
44313>>>>>>>>>>>
44313>>>>>>>>>>>
44313>>>>>>>>>>>
44313>>>>>>>>>>>    // Define_Fields:
44313>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44313>>>>>>>>>>>
44313>>>>>>>>>>>    Procedure Define_Fields
44314>>>>>>>>>>>        Forward Send Define_Fields
44316>>>>>>>>>>>        //DDB-Generated-Code-Location
44316>>>>>>>>>>>        //DDB-DefineFieldStart
44316>>>>>>>>>>>
44316>>>>>>>>>>>        Set Main_File            To Wax.File_Number
44317>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
44318>>>>>>>>>>>
44318>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
44319>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
44320>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
44321>>>>>>>>>>>
44321>>>>>>>>>>>        // Child (Client) file structure................
44321>>>>>>>>>>>        Send Add_Client_File  Pmoves.File_Number
44322>>>>>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
44323>>>>>>>>>>>        Send Add_Client_File  Wam.File_Number
44324>>>>>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
44325>>>>>>>>>>>
44325>>>>>>>>>>>        // Parent (Server) file structure...............
44325>>>>>>>>>>>        Send Add_Server_File  Wapomast.File_Number
44326>>>>>>>>>>>
44326>>>>>>>>>>>        // External (System) file structure.............
44326>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
44327>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
44328>>>>>>>>>>>
44328>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wax_Rec0  To Wax.Wax_Rec0
44331>>>>>>>>>>>
44331>>>>>>>>>>>        // Field-based properties.......................
44331>>>>>>>>>>>
44331>>>>>>>>>>>        // Wax.Company_Code
44331>>>>>>>>>>>
44331>>>>>>>>>>>        // Wax.Branch_Code
44331>>>>>>>>>>>
44331>>>>>>>>>>>        // Wax.Year_Year
44331>>>>>>>>>>>
44331>>>>>>>>>>>        // Wax.Wapokat_Code
44331>>>>>>>>>>>
44331>>>>>>>>>>>        // Wax.Wapomast_Code
44331>>>>>>>>>>>
44331>>>>>>>>>>>        // Wax.Wax_Code
44331>>>>>>>>>>>        Set Field_Options          Field Wax.Wax_Code To DD_AUTOFIND   
44332>>>>>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Code To (Wax(Self))
44333>>>>>>>>>>>
44333>>>>>>>>>>>        // Wax.Year_Recr
44333>>>>>>>>>>>
44333>>>>>>>>>>>        // Wax.Wapomast_Recr
44333>>>>>>>>>>>
44333>>>>>>>>>>>        // Wax.Wax_Rec0
44333>>>>>>>>>>>        Set Field_Options          Field Wax.Wax_Rec0 To DD_AUTOFIND   
44334>>>>>>>>>>>
44334>>>>>>>>>>>        // Wax.Wax_Recr
44334>>>>>>>>>>>        Set Field_Options          Field Wax.Wax_Recr To DD_AUTOFIND   
44335>>>>>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Recr To (Wax(Self))
44336>>>>>>>>>>>
44336>>>>>>>>>>>        // Wax.Wax_Descr
44336>>>>>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Descr To (Wax(Self))
44337>>>>>>>>>>>
44337>>>>>>>>>>>        //DDB-DefineFieldEnd
44337>>>>>>>>>>>    End_Procedure    // Define_Fields
44338>>>>>>>>>>>
44338>>>>>>>>>>>    // Field_Defaults:
44338>>>>>>>>>>>    // This procedure is used to establish default field values.
44338>>>>>>>>>>>
44338>>>>>>>>>>>    Procedure Field_Defaults
44339>>>>>>>>>>>        Forward Send Field_Defaults
44341>>>>>>>>>>>        //DDB-Generated-Code-Location
44341>>>>>>>>>>>        //DDB-FieldDefaultStart
44341>>>>>>>>>>>        //DDB-FieldDefaultEnd
44341>>>>>>>>>>>    End_Procedure    // Field_Defaults
44342>>>>>>>>>>>
44342>>>>>>>>>>>End_Class    // Wax_DataDictionary
44343>>>>>>>>>>>//DDB-Selection-pkg-Start
44343>>>>>>>>>>>
44343>>>>>>>>>>>Use Wax.SL           // Wax
INCLUDING FILE: WAX.SL
44343>>>>>>>>>>>>>//AB/ Project Wax:Lookup Apothikhs
44343>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
44343>>>>>>>>>>>>>//AB/     Set ProjectName to "Wax:Lookup Apothikhs"
44343>>>>>>>>>>>>>//AB/     Set ProjectFileName to "Wax.SL"
44343>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
44343>>>>>>>>>>>>>
44343>>>>>>>>>>>>>// Project Object Structure
44343>>>>>>>>>>>>>//   Wax is a dbModalPanelSub
44343>>>>>>>>>>>>>//     Wapokat_DD is a DataDictionary
44343>>>>>>>>>>>>>//     Wapomast_DD is a DataDictionary
44343>>>>>>>>>>>>>//     Wax_DD is a DataDictionary
44343>>>>>>>>>>>>>//     oSelList is a dbListSub
44343>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
44343>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
44343>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
44343>>>>>>>>>>>>>
44343>>>>>>>>>>>>>// Register all objects
44343>>>>>>>>>>>>>Register_Object oCancel_bn
44343>>>>>>>>>>>>>Register_Object oOK_bn
44343>>>>>>>>>>>>>Register_Object oSearch_bn
44343>>>>>>>>>>>>>Register_Object oSelList
44343>>>>>>>>>>>>>Register_Object Wapokat_DD
44343>>>>>>>>>>>>>Register_Object Wapomast_DD
44343>>>>>>>>>>>>>Register_Object Wax
44343>>>>>>>>>>>>>Register_Object Wax_DD
44343>>>>>>>>>>>>>
44343>>>>>>>>>>>>>
44343>>>>>>>>>>>>>//AB-IgnoreStart
44343>>>>>>>>>>>>>
44343>>>>>>>>>>>>>Use DFAllEnt.pkg
44343>>>>>>>>>>>>>Use dbList.Sub
44343>>>>>>>>>>>>>Use Button.Sub
44343>>>>>>>>>>>>>
44343>>>>>>>>>>>>>
44343>>>>>>>>>>>>>Use WAPOKAT.DD
44343>>>>>>>>>>>>>Use WAPOMAST.DD
44343>>>>>>>>>>>>>Use WAX.DD
44343>>>>>>>>>>>>>
44343>>>>>>>>>>>>>//AB-IgnoreEnd
44343>>>>>>>>>>>>>
44343>>>>>>>>>>>>>Object Wax is a dbModalPanelSub
44345>>>>>>>>>>>>>
44345>>>>>>>>>>>>>    //AB-StoreTopStart
44345>>>>>>>>>>>>>                                    
44345>>>>>>>>>>>>>    Property Integer    piMustConstrain Public  0
44347>>>>>>>>>>>>>    Property Integer    piYear          Public  0
44349>>>>>>>>>>>>>    Property String     psCompany       Public ''
44351>>>>>>>>>>>>>    Property String     psBranch        Public ''
44353>>>>>>>>>>>>>    Property String     psWapokat       Public ''
44355>>>>>>>>>>>>>    
44355>>>>>>>>>>>>>    //AB-StoreTopEnd
44355>>>>>>>>>>>>>
44355>>>>>>>>>>>>>    Set Label to "‰˜«á¢¦š¦ª €§¦Ÿž¡é¤"
44356>>>>>>>>>>>>>    Set Size to 148 355
44357>>>>>>>>>>>>>    Set Location to 8 21
44358>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
44359>>>>>>>>>>>>>    Set Modal_State to FALSE
44360>>>>>>>>>>>>>
44360>>>>>>>>>>>>>    //AB-DDOStart
44360>>>>>>>>>>>>>
44360>>>>>>>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
44362>>>>>>>>>>>>>    End_Object    // Wapokat_DD
44363>>>>>>>>>>>>>
44363>>>>>>>>>>>>>    Object Wapomast_DD is a Wapomast_DataDictionary
44365>>>>>>>>>>>>>        Set DDO_Server to (Wapokat_DD(self))
44366>>>>>>>>>>>>>    End_Object    // Wapomast_DD
44367>>>>>>>>>>>>>
44367>>>>>>>>>>>>>    Object Wax_DD is a Wax_DataDictionary
44369>>>>>>>>>>>>>        Set DDO_Server to (Wapomast_DD(self))
44370>>>>>>>>>>>>>
44370>>>>>>>>>>>>>        //AB-StoreStart
44370>>>>>>>>>>>>>        
44370>>>>>>>>>>>>>        Begin_Constraints
44372>>>>>>>>>>>>>            Integer iMustConstrain iYear
44373>>>>>>>>>>>>>            String  sCompany sBranch sWapokat
44373>>>>>>>>>>>>>            Get piMustConstrain to iMustConstrain
44374>>>>>>>>>>>>>            If (iMustConstrain) Begin
44376>>>>>>>>>>>>>                Get piYear     to  iYear
44377>>>>>>>>>>>>>                Get psCompany  to  sCompany
44378>>>>>>>>>>>>>                Get psBranch   to  sBranch
44379>>>>>>>>>>>>>                Get psWapokat  to  sWapokat
44380>>>>>>>>>>>>>                If (sCompany<>'') Begin
44382>>>>>>>>>>>>>                    Constrain Wax.Company_Code eq sCompany
44384>>>>>>>>>>>>>                    If (sBranch<>'') Begin
44386>>>>>>>>>>>>>                        Constrain Wax.Branch_Code eq sBranch
44388>>>>>>>>>>>>>                        If (iYear<>0) Begin
44390>>>>>>>>>>>>>                            Constrain Wax.Year_Year eq iYear
44392>>>>>>>>>>>>>                            If (sWapokat<>'') Begin
44394>>>>>>>>>>>>>                                Constrain Wax.Wapokat_Code eq sWapokat
44396>>>>>>>>>>>>>                            End
44396>>>>>>>>>>>>>>
44396>>>>>>>>>>>>>                        End
44396>>>>>>>>>>>>>>
44396>>>>>>>>>>>>>                    End
44396>>>>>>>>>>>>>>
44396>>>>>>>>>>>>>                End
44396>>>>>>>>>>>>>>
44396>>>>>>>>>>>>>            End
44396>>>>>>>>>>>>>>
44396>>>>>>>>>>>>>        End_Constraints
44399>>>>>>>>>>>>>        
44399>>>>>>>>>>>>>        
44399>>>>>>>>>>>>>        
44399>>>>>>>>>>>>>        
44399>>>>>>>>>>>>>        
44399>>>>>>>>>>>>>        
44399>>>>>>>>>>>>>        //AB-StoreEnd
44399>>>>>>>>>>>>>
44399>>>>>>>>>>>>>    End_Object    // Wax_DD
44400>>>>>>>>>>>>>
44400>>>>>>>>>>>>>    Set Main_DD to (Wax_DD(self))
44401>>>>>>>>>>>>>    Set Server to (Wax_DD(self))
44402>>>>>>>>>>>>>
44402>>>>>>>>>>>>>    //AB-DDOEnd
44402>>>>>>>>>>>>>
44402>>>>>>>>>>>>>    Object oSelList is a dbListSub
44404>>>>>>>>>>>>>        Set Main_File to Wax.File_Number
44405>>>>>>>>>>>>>        Set Size to 105 340
44406>>>>>>>>>>>>>        Set Location to 5 6
44407>>>>>>>>>>>>>
44407>>>>>>>>>>>>>        Begin_Row
44410>>>>>>>>>>>>>            Entry_Item Wax.Wax_recr
44411>>>>>>>>>>>>>            Entry_Item Wax.Wax_code
44412>>>>>>>>>>>>>            Entry_Item Wax.Wax_descr
44413>>>>>>>>>>>>>        End_Row
44418>>>>>>>>>>>>>
44418>>>>>>>>>>>>>        Set Form_Width    item 0 to 33
44419>>>>>>>>>>>>>        Set Header_Label  item 0 to "Recr"
44420>>>>>>>>>>>>>        
44420>>>>>>>>>>>>>        Set Form_Width    item 1 to 80
44421>>>>>>>>>>>>>        Set Header_Label  item 1 to "‰à› ¡æª"
44422>>>>>>>>>>>>>        
44422>>>>>>>>>>>>>        Set Form_Width    item 2 to 219
44423>>>>>>>>>>>>>        Set Header_Label  item 2 to "œ¨ š¨˜­ã"
44424>>>>>>>>>>>>>        
44424>>>>>>>>>>>>>
44424>>>>>>>>>>>>>        //AB-StoreStart
44424>>>>>>>>>>>>>        
44424>>>>>>>>>>>>>        Procedure Activate
44426>>>>>>>>>>>>>            Send Rebuild_Constraints to Wax_DD
44427>>>>>>>>>>>>>            Send Beginning_Of_Data to oSelList True
44428>>>>>>>>>>>>>            Forward Send Activate
44430>>>>>>>>>>>>>        End_procedure
44431>>>>>>>>>>>>>        
44431>>>>>>>>>>>>>        //AB-StoreEnd
44431>>>>>>>>>>>>>
44431>>>>>>>>>>>>>    End_Object    // oSelList
44432>>>>>>>>>>>>>
44432>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
44434>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
44435>>>>>>>>>>>>>        Set Location to 113 186
44436>>>>>>>>>>>>>
44436>>>>>>>>>>>>>        //AB-StoreStart
44436>>>>>>>>>>>>>        Procedure OnClick
44438>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
44439>>>>>>>>>>>>>        End_Procedure
44440>>>>>>>>>>>>>        //AB-StoreEnd
44440>>>>>>>>>>>>>
44440>>>>>>>>>>>>>    End_Object    // oOK_bn
44441>>>>>>>>>>>>>
44441>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
44443>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
44444>>>>>>>>>>>>>        Set Location to 113 241
44445>>>>>>>>>>>>>
44445>>>>>>>>>>>>>        //AB-StoreStart
44445>>>>>>>>>>>>>        Procedure OnClick
44447>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
44448>>>>>>>>>>>>>        End_Procedure
44449>>>>>>>>>>>>>        //AB-StoreEnd
44449>>>>>>>>>>>>>
44449>>>>>>>>>>>>>    End_Object    // oCancel_bn
44450>>>>>>>>>>>>>
44450>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
44452>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
44453>>>>>>>>>>>>>        Set Location to 113 296
44454>>>>>>>>>>>>>
44454>>>>>>>>>>>>>        //AB-StoreStart
44454>>>>>>>>>>>>>        Procedure OnClick
44456>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
44457>>>>>>>>>>>>>        End_Procedure
44458>>>>>>>>>>>>>        //AB-StoreEnd
44458>>>>>>>>>>>>>
44458>>>>>>>>>>>>>    End_Object    // oSearch_bn
44459>>>>>>>>>>>>>
44459>>>>>>>>>>>>>
44459>>>>>>>>>>>>>    //AB-StoreStart
44459>>>>>>>>>>>>>                                    
44459>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
44460>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
44461>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
44462>>>>>>>>>>>>>    
44462>>>>>>>>>>>>>    
44462>>>>>>>>>>>>>    
44462>>>>>>>>>>>>>    
44462>>>>>>>>>>>>>    
44462>>>>>>>>>>>>>    
44462>>>>>>>>>>>>>    //AB-StoreEnd
44462>>>>>>>>>>>>>
44462>>>>>>>>>>>>>End_Object    // Wax
44463>>>>>>>>>>>>>
44463>>>>>>>>>>>>>//AB/ End_Object    // prj
44463>>>>>>>>>>>
44463>>>>>>>>>>>//DDB-Selection-pkg-End
44463>>>>>>>>>>>//DDB-FileEnd
44463>>>>>>>>>    Use UNITS.DD
INCLUDING FILE: UNITS.DD
44463>>>>>>>>>>>//DDB-FileStart
44463>>>>>>>>>>>//DDB-HeaderStart
44463>>>>>>>>>>>
44463>>>>>>>>>>>// File Name : UNITS.DD
44463>>>>>>>>>>>// Class Name: Units_DataDictionary
44463>>>>>>>>>>>// Revision  : 17
44463>>>>>>>>>>>// Version   : 2
44463>>>>>>>>>>>
44463>>>>>>>>>>>Use  Windows           // Basic Definitions
44463>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
44463>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
44463>>>>>>>>>>>
44463>>>>>>>>>>>Open Units
44465>>>>>>>>>>>Open Item
INCLUDING FILE: ITEM.FD
44467>>>>>>>>>>>Open Sysrecw
44469>>>>>>>>>>>Open Syscurxr
44471>>>>>>>>>>>
44471>>>>>>>>>>>//DDB-HeaderEnd
44471>>>>>>>>>>>//DDB-SelectionStart
44471>>>>>>>>>>>//DDB/ ExternalSelectionList sl025  sl025.SL
44471>>>>>>>>>>>Register_Object sl025
44471>>>>>>>>>>>//DDB-SelectionEnd
44471>>>>>>>>>>>
44471>>>>>>>>>>>Class Units_DataDictionary  is a DataDictionary
44472>>>>>>>>>>>
44472>>>>>>>>>>>    Procedure Save_Main_File
44473>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
44475>>>>>>>>>>>            If Units.Recnum Eq 0 Procedure_Return
44478>>>>>>>>>>>        End
44478>>>>>>>>>>>>
44478>>>>>>>>>>>        Forward Send Save_Main_File
44480>>>>>>>>>>>    End_Procedure
44481>>>>>>>>>>>
44481>>>>>>>>>>>
44481>>>>>>>>>>>     Procedure Creating
44482>>>>>>>>>>>        Forward Send Creating
44484>>>>>>>>>>>        // Insert Code Here
44484>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Units.Units_Rec0)))))) to Units.Units_Recr
44485>>>>>>>>>>>    End_Procedure   // Creating
44486>>>>>>>>>>>
44486>>>>>>>>>>>
44486>>>>>>>>>>>
44486>>>>>>>>>>>    // Define_Fields:
44486>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44486>>>>>>>>>>>
44486>>>>>>>>>>>    Procedure Define_Fields
44487>>>>>>>>>>>        Forward Send Define_Fields
44489>>>>>>>>>>>        //DDB-Generated-Code-Location
44489>>>>>>>>>>>        //DDB-DefineFieldStart
44489>>>>>>>>>>>
44489>>>>>>>>>>>        Set Main_File            To Units.File_Number
44490>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
44491>>>>>>>>>>>
44491>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
44492>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
44493>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
44494>>>>>>>>>>>
44494>>>>>>>>>>>        // Child (Client) file structure................
44494>>>>>>>>>>>        Send Add_Client_File  Item.File_Number
44495>>>>>>>>>>>
44495>>>>>>>>>>>        // External (System) file structure.............
44495>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
44496>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
44497>>>>>>>>>>>
44497>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Units_Rec0  To Units.Units_Rec0
44500>>>>>>>>>>>
44500>>>>>>>>>>>        // Field-based properties.......................
44500>>>>>>>>>>>
44500>>>>>>>>>>>        // Units.Units_Code
44500>>>>>>>>>>>        Set Field_Options          Field Units.Units_Code To DD_AUTOFIND   
44501>>>>>>>>>>>        Set Field_Prompt_Object    Field Units.Units_Code To (sl025(Self))
44502>>>>>>>>>>>
44502>>>>>>>>>>>        // Units.Units_Rec0
44502>>>>>>>>>>>        Set Field_Options          Field Units.Units_Rec0 To DD_AUTOFIND   
44503>>>>>>>>>>>
44503>>>>>>>>>>>        // Units.Units_Descr
44503>>>>>>>>>>>        Set Field_Prompt_Object    Field Units.Units_Descr To (sl025(Self))
44504>>>>>>>>>>>
44504>>>>>>>>>>>        // Units.Units_Recr
44504>>>>>>>>>>>        Set Field_Options          Field Units.Units_Recr To DD_AUTOFIND   
44505>>>>>>>>>>>
44505>>>>>>>>>>>        //DDB-DefineFieldEnd
44505>>>>>>>>>>>    End_Procedure    // Define_Fields
44506>>>>>>>>>>>
44506>>>>>>>>>>>    // Field_Defaults:
44506>>>>>>>>>>>    // This procedure is used to establish default field values.
44506>>>>>>>>>>>
44506>>>>>>>>>>>    Procedure Field_Defaults
44507>>>>>>>>>>>        Forward Send Field_Defaults
44509>>>>>>>>>>>        //DDB-Generated-Code-Location
44509>>>>>>>>>>>        //DDB-FieldDefaultStart
44509>>>>>>>>>>>        //DDB-FieldDefaultEnd
44509>>>>>>>>>>>    End_Procedure    // Field_Defaults
44510>>>>>>>>>>>
44510>>>>>>>>>>>End_Class    // Units_DataDictionary
44511>>>>>>>>>>>//DDB-Selection-pkg-Start
44511>>>>>>>>>>>
44511>>>>>>>>>>>Use sl025.SL         // sl025
INCLUDING FILE: SL025.SL
44511>>>>>>>>>>>>>//AB/ Project sl025
44511>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
44511>>>>>>>>>>>>>//AB/     Set ProjectName to "sl025"
44511>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl025.SL"
44511>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
44511>>>>>>>>>>>>>
44511>>>>>>>>>>>>>// Project Object Structure
44511>>>>>>>>>>>>>//   sl025 is a dbModalPanelSub
44511>>>>>>>>>>>>>//     Units_DD is a DataDictionary
44511>>>>>>>>>>>>>//     oSelList is a dbListSub
44511>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
44511>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
44511>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
44511>>>>>>>>>>>>>
44511>>>>>>>>>>>>>// Register all objects
44511>>>>>>>>>>>>>Register_Object oCancel_bn
44511>>>>>>>>>>>>>Register_Object oOK_bn
44511>>>>>>>>>>>>>Register_Object oSearch_bn
44511>>>>>>>>>>>>>Register_Object oSelList
44511>>>>>>>>>>>>>Register_Object sl025
44511>>>>>>>>>>>>>Register_Object Units_DD
44511>>>>>>>>>>>>>
44511>>>>>>>>>>>>>
44511>>>>>>>>>>>>>//AB-IgnoreStart
44511>>>>>>>>>>>>>
44511>>>>>>>>>>>>>Use DFAllEnt.pkg
44511>>>>>>>>>>>>>Use dbList.Sub
44511>>>>>>>>>>>>>Use Button.Sub
44511>>>>>>>>>>>>>
44511>>>>>>>>>>>>>
44511>>>>>>>>>>>>>Use UNITS.DD
44511>>>>>>>>>>>>>
44511>>>>>>>>>>>>>//AB-IgnoreEnd
44511>>>>>>>>>>>>>
44511>>>>>>>>>>>>>Object sl025 is a dbModalPanelSub
44513>>>>>>>>>>>>>    set label to "‹¦¤á›œª ‹â«¨ž©žª" 
44514>>>>>>>>>>>>>    Set Size to 148 297
44515>>>>>>>>>>>>>    Set Location to 4 5
44516>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
44517>>>>>>>>>>>>>    Set Modal_State to FALSE
44518>>>>>>>>>>>>>
44518>>>>>>>>>>>>>    //AB-DDOStart
44518>>>>>>>>>>>>>
44518>>>>>>>>>>>>>    Object Units_DD is a Units_DataDictionary
44520>>>>>>>>>>>>>    End_Object    // Units_DD
44521>>>>>>>>>>>>>
44521>>>>>>>>>>>>>    Set Main_DD to (Units_DD(self))
44522>>>>>>>>>>>>>    Set Server to (Units_DD(self))
44523>>>>>>>>>>>>>
44523>>>>>>>>>>>>>    //AB-DDOEnd
44523>>>>>>>>>>>>>
44523>>>>>>>>>>>>>    Object oSelList is a dbListSub
44525>>>>>>>>>>>>>        set main_file to units.file_number 
44526>>>>>>>>>>>>>        Set Size to 105 280
44527>>>>>>>>>>>>>        Set Location to 6 6
44528>>>>>>>>>>>>>
44528>>>>>>>>>>>>>        Begin_Row
44531>>>>>>>>>>>>>            entry_item units.units_code 
44532>>>>>>>>>>>>>            entry_item units.units_descr 
44533>>>>>>>>>>>>>        End_Row
44538>>>>>>>>>>>>>
44538>>>>>>>>>>>>>        Set Form_Width    item 0 to 91
44539>>>>>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
44540>>>>>>>>>>>>>        
44540>>>>>>>>>>>>>        Set Form_Width    item 1 to 180
44541>>>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
44542>>>>>>>>>>>>>        
44542>>>>>>>>>>>>>    End_Object    // oSelList
44543>>>>>>>>>>>>>
44543>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
44545>>>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
44546>>>>>>>>>>>>>        Set Location to 115 126
44547>>>>>>>>>>>>>
44547>>>>>>>>>>>>>        //AB-StoreStart
44547>>>>>>>>>>>>>        Procedure OnClick
44549>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
44550>>>>>>>>>>>>>        End_Procedure
44551>>>>>>>>>>>>>        //AB-StoreEnd
44551>>>>>>>>>>>>>
44551>>>>>>>>>>>>>    End_Object    // oOK_bn
44552>>>>>>>>>>>>>
44552>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
44554>>>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
44555>>>>>>>>>>>>>        Set Location to 115 181
44556>>>>>>>>>>>>>
44556>>>>>>>>>>>>>        //AB-StoreStart
44556>>>>>>>>>>>>>        Procedure OnClick
44558>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
44559>>>>>>>>>>>>>        End_Procedure
44560>>>>>>>>>>>>>        //AB-StoreEnd
44560>>>>>>>>>>>>>
44560>>>>>>>>>>>>>    End_Object    // oCancel_bn
44561>>>>>>>>>>>>>
44561>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
44563>>>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
44564>>>>>>>>>>>>>        Set Location to 115 236
44565>>>>>>>>>>>>>
44565>>>>>>>>>>>>>        //AB-StoreStart
44565>>>>>>>>>>>>>        Procedure OnClick
44567>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
44568>>>>>>>>>>>>>        End_Procedure
44569>>>>>>>>>>>>>        //AB-StoreEnd
44569>>>>>>>>>>>>>
44569>>>>>>>>>>>>>    End_Object    // oSearch_bn
44570>>>>>>>>>>>>>
44570>>>>>>>>>>>>>
44570>>>>>>>>>>>>>    //AB-StoreStart
44570>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
44571>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
44572>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
44573>>>>>>>>>>>>>    //AB-StoreEnd
44573>>>>>>>>>>>>>
44573>>>>>>>>>>>>>End_Object    // sl025
44574>>>>>>>>>>>>>
44574>>>>>>>>>>>>>//AB/ End_Object    // prj
44574>>>>>>>>>>>
44574>>>>>>>>>>>//DDB-Selection-pkg-End
44574>>>>>>>>>>>//DDB-FileEnd
44574>>>>>>>>>    Use WITEMKAT.DD
INCLUDING FILE: WITEMKAT.DD
44574>>>>>>>>>>>//DDB-FileStart
44574>>>>>>>>>>>//DDB-HeaderStart
44574>>>>>>>>>>>
44574>>>>>>>>>>>// File Name : WITEMKAT.DD
44574>>>>>>>>>>>// Class Name: Witemkat_DataDictionary
44574>>>>>>>>>>>// Revision  : 26
44574>>>>>>>>>>>
44574>>>>>>>>>>>Use  Windows           // Basic Definitions
44574>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
44574>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
44574>>>>>>>>>>>
44574>>>>>>>>>>>Open Witemkat
44576>>>>>>>>>>>Open Item
44578>>>>>>>>>>>Open Sysrecw
44580>>>>>>>>>>>Open Syscurxr
44582>>>>>>>>>>>
44582>>>>>>>>>>>//DDB-HeaderEnd
44582>>>>>>>>>>>//DDB-SelectionStart
44582>>>>>>>>>>>//DDB/ ExternalSelectionList sl024  sl024.SL
44582>>>>>>>>>>>Register_Object sl024
44582>>>>>>>>>>>//DDB-SelectionEnd
44582>>>>>>>>>>>
44582>>>>>>>>>>>Class Witemkat_DataDictionary  is a DataDictionary
44583>>>>>>>>>>>
44583>>>>>>>>>>>     Procedure Creating
44584>>>>>>>>>>>        Forward Send Creating
44586>>>>>>>>>>>        // Insert Code Here
44586>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(WitemKat.WitemKat_Rec0)))))) to WitemKat.WitemKat_Recr
44587>>>>>>>>>>>    End_Procedure   // Creating
44588>>>>>>>>>>>   
44588>>>>>>>>>>>    Function Validate_Save  Returns Integer
44589>>>>>>>>>>>        Local Integer iReturnVal icheck
44590>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
44592>>>>>>>>>>>        If (Not(iReturnVal)) Begin
44594>>>>>>>>>>>            // Insert Code Here
44594>>>>>>>>>>>//           if (witemkat.codegl <> '') begin
44594>>>>>>>>>>>//              Move (Check_log(witemkat.codegl)) to iCheck  
44594>>>>>>>>>>>//              if (icheck) Move 24001 to iReturnVal 
44594>>>>>>>>>>>//           end
44594>>>>>>>>>>>           If (iReturnVal) Send Operation_Not_Allowed iReturnVal
44597>>>>>>>>>>>        End
44597>>>>>>>>>>>>
44597>>>>>>>>>>>        Function_Return iReturnVal
44598>>>>>>>>>>>    End_Function   // Validate_Save
44599>>>>>>>>>>> 
44599>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
44600>>>>>>>>>>>        String lsError_Message
44601>>>>>>>>>>>        Case Begin
44601>>>>>>>>>>>            Case (iError_Num = 24001)
44603>>>>>>>>>>>                Move "DDC 24: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ¡˜«žš¦¨å˜ª œå›¦¬ª" to lsError_Message
44604>>>>>>>>>>>              Case Break
44605>>>>>>>>>>>            Case Else
44605>>>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
44607>>>>>>>>>>>        Case End
44607>>>>>>>>>>>        Error iError_Num lsError_Message
44608>>>>>>>>>>>>
44608>>>>>>>>>>>    End_Procedure // operation_not_allowed
44609>>>>>>>>>>>
44609>>>>>>>>>>>
44609>>>>>>>>>>>
44609>>>>>>>>>>>    // Define_Fields:
44609>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44609>>>>>>>>>>>
44609>>>>>>>>>>>    Procedure Define_Fields
44610>>>>>>>>>>>        Forward Send Define_Fields
44612>>>>>>>>>>>        //DDB-Generated-Code-Location
44612>>>>>>>>>>>        //DDB-DefineFieldStart
44612>>>>>>>>>>>
44612>>>>>>>>>>>        Set Main_File            To Witemkat.File_Number
44613>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
44614>>>>>>>>>>>
44614>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
44615>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
44616>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
44617>>>>>>>>>>>
44617>>>>>>>>>>>        // Child (Client) file structure................
44617>>>>>>>>>>>        Send Add_Client_File  Item.File_Number
44618>>>>>>>>>>>
44618>>>>>>>>>>>        // External (System) file structure.............
44618>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
44619>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
44620>>>>>>>>>>>
44620>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Witemkat_Rec0  To Witemkat.Witemkat_Rec0
44623>>>>>>>>>>>
44623>>>>>>>>>>>        // Field-based properties.......................
44623>>>>>>>>>>>
44623>>>>>>>>>>>        // Witemkat.Witemkat_Code  
44623>>>>>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Code   To DD_AUTOFIND   
44624>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemkat.Witemkat_Code   To (sl024(Self))
44625>>>>>>>>>>>
44625>>>>>>>>>>>        // Witemkat.Witemkat_Rec0  
44625>>>>>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Rec0   To DD_AUTOFIND   
44626>>>>>>>>>>>
44626>>>>>>>>>>>        // Witemkat.Witemkat_Descr 
44626>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemkat.Witemkat_Descr  To (sl024(Self))
44627>>>>>>>>>>>
44627>>>>>>>>>>>        // Witemkat.Witemkat_Recr  
44627>>>>>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Recr   To DD_AUTOFIND   
44628>>>>>>>>>>>
44628>>>>>>>>>>>        // Witemkat.Codeglpol      
44628>>>>>>>>>>>
44628>>>>>>>>>>>        // Witemkat.Codeglago      
44628>>>>>>>>>>>
44628>>>>>>>>>>>        //DDB-DefineFieldEnd
44628>>>>>>>>>>>    End_Procedure    // Define_Fields
44629>>>>>>>>>>>
44629>>>>>>>>>>>    // Field_Defaults:
44629>>>>>>>>>>>    // This procedure is used to establish default field values.
44629>>>>>>>>>>>
44629>>>>>>>>>>>    Procedure Field_Defaults
44630>>>>>>>>>>>        Forward Send Field_Defaults
44632>>>>>>>>>>>        //DDB-Generated-Code-Location
44632>>>>>>>>>>>        //DDB-FieldDefaultStart
44632>>>>>>>>>>>        //DDB-FieldDefaultEnd
44632>>>>>>>>>>>    End_Procedure    // Field_Defaults
44633>>>>>>>>>>>
44633>>>>>>>>>>>End_Class    // Witemkat_DataDictionary
44634>>>>>>>>>>>//DDB-Selection-pkg-Start
44634>>>>>>>>>>>Use sl024.SL         // sl024
INCLUDING FILE: SL024.SL
44634>>>>>>>>>>>>>//AB/ Project sl024:kathgories eidon
44634>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
44634>>>>>>>>>>>>>//AB/     Set ProjectName to "sl024:kathgories eidon"
44634>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl024.SL"
44634>>>>>>>>>>>>>
44634>>>>>>>>>>>>>// Project Object Structure
44634>>>>>>>>>>>>>//   sl024 is a dbModalPanelSub
44634>>>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
44634>>>>>>>>>>>>>//     oSelList is a dbListSub
44634>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
44634>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
44634>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
44634>>>>>>>>>>>>>
44634>>>>>>>>>>>>>// Register all objects
44634>>>>>>>>>>>>>Register_Object oCancel_bn
44634>>>>>>>>>>>>>Register_Object oOK_bn
44634>>>>>>>>>>>>>Register_Object oSearch_bn
44634>>>>>>>>>>>>>Register_Object oSelList
44634>>>>>>>>>>>>>Register_Object sl024
44634>>>>>>>>>>>>>Register_Object Witemkat_DD
44634>>>>>>>>>>>>>
44634>>>>>>>>>>>>>
44634>>>>>>>>>>>>>//AB-IgnoreStart
44634>>>>>>>>>>>>>
44634>>>>>>>>>>>>>Use DFAllEnt.pkg
44634>>>>>>>>>>>>>Use dbList.Sub
44634>>>>>>>>>>>>>Use Button.Sub
44634>>>>>>>>>>>>>
44634>>>>>>>>>>>>>
44634>>>>>>>>>>>>>Use WITEMKAT.DD
44634>>>>>>>>>>>>>
44634>>>>>>>>>>>>>//AB-IgnoreEnd
44634>>>>>>>>>>>>>
44634>>>>>>>>>>>>>Object sl024 is a dbModalPanelSub
44636>>>>>>>>>>>>>    Set Label to "‰˜«žš¦¨åœª „ ›é¤"
44637>>>>>>>>>>>>>    Set Size to 217 375
44638>>>>>>>>>>>>>    Set Location to 4 5
44639>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
44640>>>>>>>>>>>>>    Set Modal_State to FALSE
44641>>>>>>>>>>>>>
44641>>>>>>>>>>>>>    //AB-DDOStart
44641>>>>>>>>>>>>>
44641>>>>>>>>>>>>>    Object Witemkat_DD is a Witemkat_DataDictionary
44643>>>>>>>>>>>>>    End_Object    // Witemkat_DD
44644>>>>>>>>>>>>>
44644>>>>>>>>>>>>>    Set Main_DD to (Witemkat_DD(self))
44645>>>>>>>>>>>>>    Set Server to (Witemkat_DD(self))
44646>>>>>>>>>>>>>
44646>>>>>>>>>>>>>    //AB-DDOEnd
44646>>>>>>>>>>>>>
44646>>>>>>>>>>>>>    Object oSelList is a dbListSub
44648>>>>>>>>>>>>>        Set Main_File to Witemkat.File_Number
44649>>>>>>>>>>>>>        Set Size to 175 357
44650>>>>>>>>>>>>>        Set Location to 6 6
44651>>>>>>>>>>>>>
44651>>>>>>>>>>>>>        Begin_Row
44654>>>>>>>>>>>>>            Entry_Item Witemkat.Witemkat_code
44655>>>>>>>>>>>>>            Entry_Item Witemkat.Witemkat_descr
44656>>>>>>>>>>>>>        End_Row
44661>>>>>>>>>>>>>
44661>>>>>>>>>>>>>        Set Form_Width    item 0 to 124
44662>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
44663>>>>>>>>>>>>>        
44663>>>>>>>>>>>>>        Set Form_Width    item 1 to 223
44664>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
44665>>>>>>>>>>>>>        
44665>>>>>>>>>>>>>    End_Object    // oSelList
44666>>>>>>>>>>>>>
44666>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
44668>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
44669>>>>>>>>>>>>>        Set Location to 186 210
44670>>>>>>>>>>>>>
44670>>>>>>>>>>>>>        //AB-StoreStart
44670>>>>>>>>>>>>>        Procedure OnClick
44672>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
44673>>>>>>>>>>>>>        End_Procedure
44674>>>>>>>>>>>>>        //AB-StoreEnd
44674>>>>>>>>>>>>>
44674>>>>>>>>>>>>>    End_Object    // oOK_bn
44675>>>>>>>>>>>>>
44675>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
44677>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
44678>>>>>>>>>>>>>        Set Location to 186 265
44679>>>>>>>>>>>>>
44679>>>>>>>>>>>>>        //AB-StoreStart
44679>>>>>>>>>>>>>        Procedure OnClick
44681>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
44682>>>>>>>>>>>>>        End_Procedure
44683>>>>>>>>>>>>>        //AB-StoreEnd
44683>>>>>>>>>>>>>
44683>>>>>>>>>>>>>    End_Object    // oCancel_bn
44684>>>>>>>>>>>>>
44684>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
44686>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
44687>>>>>>>>>>>>>        Set Location to 186 320
44688>>>>>>>>>>>>>
44688>>>>>>>>>>>>>        //AB-StoreStart
44688>>>>>>>>>>>>>        Procedure OnClick
44690>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
44691>>>>>>>>>>>>>        End_Procedure
44692>>>>>>>>>>>>>        //AB-StoreEnd
44692>>>>>>>>>>>>>
44692>>>>>>>>>>>>>    End_Object    // oSearch_bn
44693>>>>>>>>>>>>>
44693>>>>>>>>>>>>>
44693>>>>>>>>>>>>>    //AB-StoreStart
44693>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
44694>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
44695>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
44696>>>>>>>>>>>>>    //AB-StoreEnd
44696>>>>>>>>>>>>>
44696>>>>>>>>>>>>>End_Object    // sl024
44697>>>>>>>>>>>>>
44697>>>>>>>>>>>>>//AB/ End_Object    // prj
44697>>>>>>>>>>>//DDB-Selection-pkg-End
44697>>>>>>>>>>>//DDB-FileEnd
44697>>>>>>>>>    Use FPA.DD
INCLUDING FILE: FPA.DD
44697>>>>>>>>>>>//DDB-FileStart
44697>>>>>>>>>>>//DDB-HeaderStart
44697>>>>>>>>>>>
44697>>>>>>>>>>>// File Name : FPA.DD
44697>>>>>>>>>>>// Class Name: Fpa_DataDictionary
44697>>>>>>>>>>>// Revision  : 34
44697>>>>>>>>>>>// Version   : 2
44697>>>>>>>>>>>
44697>>>>>>>>>>>Use  Windows           // Basic Definitions
44697>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
44697>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
44697>>>>>>>>>>>
44697>>>>>>>>>>>Open Fpa
INCLUDING FILE: FPA.FD
44699>>>>>>>>>>>Open Iteml
44701>>>>>>>>>>>Open Partlfpa
44703>>>>>>>>>>>Open Item
44705>>>>>>>>>>>
44705>>>>>>>>>>>//DDB-HeaderEnd
44705>>>>>>>>>>>//DDB-SelectionStart
44705>>>>>>>>>>>//DDB/ ExternalSelectionList Fpa  Fpa.SL
44705>>>>>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.SL
44705>>>>>>>>>>>Register_Object Fpa
44705>>>>>>>>>>>Register_Object sl150
44705>>>>>>>>>>>//DDB-SelectionEnd
44705>>>>>>>>>>>
44705>>>>>>>>>>>Class Fpa_DataDictionary  is a DataDictionary_Sec
44706>>>>>>>>>>> 
44706>>>>>>>>>>>    // Validate_Save:
44706>>>>>>>>>>> 
44706>>>>>>>>>>>    Function Validate_Save  Returns Integer
44707>>>>>>>>>>>        Local Integer iReturnVal icheck
44708>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
44710>>>>>>>>>>>        If (Not(iReturnVal)) Begin
44712>>>>>>>>>>>            // Insert Code Here
44712>>>>>>>>>>>         //  if (fpa.agora_codegl <> '') begin
44712>>>>>>>>>>>         //     Move (Check_log(fpa.agora_codegl)) to iCheck  
44712>>>>>>>>>>>         //     if (icheck) Move 104001 to iReturnVal 
44712>>>>>>>>>>>         //  end
44712>>>>>>>>>>>         //  if (fpa.polhsh_codegl <> '') begin
44712>>>>>>>>>>>         //     Move (Check_log(fpa.polhsh_codegl)) to iCheck  
44712>>>>>>>>>>>         //     if (icheck) Move 104002 to iReturnVal
44712>>>>>>>>>>>         //  end   
44712>>>>>>>>>>>         //  If (iReturnVal) Send Operation_Not_Allowed iReturnVal
44712>>>>>>>>>>>        End
44712>>>>>>>>>>>>
44712>>>>>>>>>>>        Function_Return iReturnVal
44713>>>>>>>>>>>    End_Function   // Validate_Save
44714>>>>>>>>>>> 
44714>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
44715>>>>>>>>>>>        String lsError_Message
44716>>>>>>>>>>>        Case Begin
44716>>>>>>>>>>>            Case (iError_Num = 104001)
44718>>>>>>>>>>>                Move "DDC 104: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ”..€ ˜š¦¨é¤" to lsError_Message
44719>>>>>>>>>>>              Case Break
44720>>>>>>>>>>>            Case (iError_Num = 104002)
44723>>>>>>>>>>>                Move "DDC 104: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ”..€ §à¢ã©œà¤" to lsError_Message
44724>>>>>>>>>>>              Case Break
44725>>>>>>>>>>>            Case Else
44725>>>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
44727>>>>>>>>>>>        Case End
44727>>>>>>>>>>>        Error iError_Num lsError_Message
44728>>>>>>>>>>>>
44728>>>>>>>>>>>    End_Procedure // operation_not_allowed
44729>>>>>>>>>>>
44729>>>>>>>>>>>    // Define_Fields:
44729>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44729>>>>>>>>>>>
44729>>>>>>>>>>>    Procedure Define_Fields
44730>>>>>>>>>>>        Forward Send Define_Fields
44732>>>>>>>>>>>        //DDB-Generated-Code-Location
44732>>>>>>>>>>>        //DDB-DefineFieldStart
44732>>>>>>>>>>>
44732>>>>>>>>>>>        Set Main_File            To Fpa.File_Number
44733>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
44734>>>>>>>>>>>
44734>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
44735>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
44736>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
44737>>>>>>>>>>>
44737>>>>>>>>>>>        // Child (Client) file structure................
44737>>>>>>>>>>>        Send Add_Client_File  Iteml.File_Number
44738>>>>>>>>>>>        Send Add_Client_File  Partlfpa.File_Number
44739>>>>>>>>>>>        Send Add_Client_File  Item.File_Number
44740>>>>>>>>>>>
44740>>>>>>>>>>>        // Field-based properties.......................
44740>>>>>>>>>>>
44740>>>>>>>>>>>        // Fpa.Fpa_Pososto
44740>>>>>>>>>>>        Set Field_Options          Field Fpa.Fpa_Pososto To DD_AUTOFIND    DD_REQUIRED   
44741>>>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Fpa_Pososto To (Fpa(Self))
44742>>>>>>>>>>>        Set Key_Field_State        Field Fpa.Fpa_Pososto To TRUE
44743>>>>>>>>>>>
44743>>>>>>>>>>>        // Fpa.Fpa_Descr
44743>>>>>>>>>>>        Set Field_Options          Field Fpa.Fpa_Descr To DD_AUTOFIND   
44744>>>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Fpa_Descr To (Fpa(Self))
44745>>>>>>>>>>>
44745>>>>>>>>>>>        // Fpa.Agora_Codegl
44745>>>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Agora_Codegl To (sl150(Self))
44746>>>>>>>>>>>
44746>>>>>>>>>>>        // Fpa.Polhsh_Codegl
44746>>>>>>>>>>>
44746>>>>>>>>>>>        //DDB-DefineFieldEnd
44746>>>>>>>>>>>    End_Procedure    // Define_Fields
44747>>>>>>>>>>>
44747>>>>>>>>>>>    // Field_Defaults:
44747>>>>>>>>>>>    // This procedure is used to establish default field values.
44747>>>>>>>>>>>
44747>>>>>>>>>>>    Procedure Field_Defaults
44748>>>>>>>>>>>        Forward Send Field_Defaults
44750>>>>>>>>>>>        //DDB-Generated-Code-Location
44750>>>>>>>>>>>        //DDB-FieldDefaultStart
44750>>>>>>>>>>>        //DDB-FieldDefaultEnd
44750>>>>>>>>>>>    End_Procedure    // Field_Defaults
44751>>>>>>>>>>>
44751>>>>>>>>>>>End_Class    // Fpa_DataDictionary
44752>>>>>>>>>>>//DDB-Selection-pkg-Start
44752>>>>>>>>>>>
44752>>>>>>>>>>>Use Fpa.SL           // Fpa
INCLUDING FILE: FPA.SL
44752>>>>>>>>>>>>>//AB/ Project Fpa:Lookup
44752>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
44752>>>>>>>>>>>>>//AB/     Set ProjectName to "Fpa:Lookup"
44752>>>>>>>>>>>>>//AB/     Set ProjectFileName to "Fpa.SL"
44752>>>>>>>>>>>>>
44752>>>>>>>>>>>>>// Project Object Structure
44752>>>>>>>>>>>>>//   Fpa is a dbModalPanelSub
44752>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
44752>>>>>>>>>>>>>//     oSelList is a dbListSub
44752>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
44752>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
44752>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
44752>>>>>>>>>>>>>
44752>>>>>>>>>>>>>// Register all objects
44752>>>>>>>>>>>>>Register_Object Fpa
44752>>>>>>>>>>>>>Register_Object Fpa_DD
44752>>>>>>>>>>>>>Register_Object oCancel_bn
44752>>>>>>>>>>>>>Register_Object oOK_bn
44752>>>>>>>>>>>>>Register_Object oSearch_bn
44752>>>>>>>>>>>>>Register_Object oSelList
44752>>>>>>>>>>>>>
44752>>>>>>>>>>>>>
44752>>>>>>>>>>>>>//AB-IgnoreStart
44752>>>>>>>>>>>>>
44752>>>>>>>>>>>>>Use DFAllEnt.pkg
44752>>>>>>>>>>>>>Use dbList.Sub
44752>>>>>>>>>>>>>Use Button.Sub
44752>>>>>>>>>>>>>
44752>>>>>>>>>>>>>
44752>>>>>>>>>>>>>Use FPA.DD
44752>>>>>>>>>>>>>
44752>>>>>>>>>>>>>//AB-IgnoreEnd
44752>>>>>>>>>>>>>
44752>>>>>>>>>>>>>CD_Popup_Object Fpa is a dbModalPanelSub
44771>>>>>>>>>>>>>    set label to "¦©¦©«á ”..€." 
44772>>>>>>>>>>>>>    Set Size to 148 181
44773>>>>>>>>>>>>>    Set Location to 4 5
44774>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
44775>>>>>>>>>>>>>    Set Modal_State to FALSE
44776>>>>>>>>>>>>>
44776>>>>>>>>>>>>>    //AB-DDOStart
44776>>>>>>>>>>>>>
44776>>>>>>>>>>>>>    Object Fpa_DD is a Fpa_DataDictionary
44778>>>>>>>>>>>>>    End_Object    // Fpa_DD
44779>>>>>>>>>>>>>
44779>>>>>>>>>>>>>    Set Main_DD to (Fpa_DD(self))
44780>>>>>>>>>>>>>    Set Server to (Fpa_DD(self))
44781>>>>>>>>>>>>>
44781>>>>>>>>>>>>>    //AB-DDOEnd
44781>>>>>>>>>>>>>
44781>>>>>>>>>>>>>    Object oSelList is a dbListSub
44783>>>>>>>>>>>>>        Set Main_File to Fpa.File_Number
44784>>>>>>>>>>>>>        Set Size to 105 165
44785>>>>>>>>>>>>>        Set Location to 6 6
44786>>>>>>>>>>>>>
44786>>>>>>>>>>>>>        Begin_Row
44789>>>>>>>>>>>>>            Entry_Item Fpa.Fpa_pososto
44790>>>>>>>>>>>>>            Entry_Item Fpa.Fpa_descr
44791>>>>>>>>>>>>>        End_Row
44796>>>>>>>>>>>>>
44796>>>>>>>>>>>>>        Set Form_Width    item 0 to 66
44797>>>>>>>>>>>>>        set header_label  item 0 to "% ”€" 
44798>>>>>>>>>>>>>        
44798>>>>>>>>>>>>>        Set Form_Width    item 1 to 90
44799>>>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
44800>>>>>>>>>>>>>        
44800>>>>>>>>>>>>>    End_Object    // oSelList
44801>>>>>>>>>>>>>
44801>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
44803>>>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
44804>>>>>>>>>>>>>        Set Size to 14 46
44805>>>>>>>>>>>>>        Set Location to 113 26
44806>>>>>>>>>>>>>
44806>>>>>>>>>>>>>        //AB-StoreStart
44806>>>>>>>>>>>>>        Procedure OnClick
44808>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
44809>>>>>>>>>>>>>        End_Procedure
44810>>>>>>>>>>>>>        //AB-StoreEnd
44810>>>>>>>>>>>>>
44810>>>>>>>>>>>>>    End_Object    // oOK_bn
44811>>>>>>>>>>>>>
44811>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
44813>>>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
44814>>>>>>>>>>>>>        Set Size to 14 46
44815>>>>>>>>>>>>>        Set Location to 113 75
44816>>>>>>>>>>>>>
44816>>>>>>>>>>>>>        //AB-StoreStart
44816>>>>>>>>>>>>>        Procedure OnClick
44818>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
44819>>>>>>>>>>>>>        End_Procedure
44820>>>>>>>>>>>>>        //AB-StoreEnd
44820>>>>>>>>>>>>>
44820>>>>>>>>>>>>>    End_Object    // oCancel_bn
44821>>>>>>>>>>>>>
44821>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
44823>>>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
44824>>>>>>>>>>>>>        Set Size to 14 46
44825>>>>>>>>>>>>>        Set Location to 113 126
44826>>>>>>>>>>>>>
44826>>>>>>>>>>>>>        //AB-StoreStart
44826>>>>>>>>>>>>>        Procedure OnClick
44828>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
44829>>>>>>>>>>>>>        End_Procedure
44830>>>>>>>>>>>>>        //AB-StoreEnd
44830>>>>>>>>>>>>>
44830>>>>>>>>>>>>>    End_Object    // oSearch_bn
44831>>>>>>>>>>>>>
44831>>>>>>>>>>>>>
44831>>>>>>>>>>>>>    //AB-StoreStart
44831>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
44832>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
44833>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
44834>>>>>>>>>>>>>    //AB-StoreEnd
44834>>>>>>>>>>>>>
44834>>>>>>>>>>>>>CD_End_Object    // Fpa
44836>>>>>>>>>>>>>>
44836>>>>>>>>>>>>>
44836>>>>>>>>>>>>>//AB/ End_Object    // prj
44836>>>>>>>>>>>Use sl150.SL         // sl150
INCLUDING FILE: SL150.SL
44836>>>>>>>>>>>>>//AB/ Project sl150:GL Gplan
44836>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
44836>>>>>>>>>>>>>//AB/         Set ProjectName to "sl150:GL Gplan"
44836>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl150.SL"
44836>>>>>>>>>>>>>
44836>>>>>>>>>>>>>// Project Object Structure
44836>>>>>>>>>>>>>//   sl150 is a dbModalPanelSub
44836>>>>>>>>>>>>>//     Gplan_DD is a DataDictionary
44836>>>>>>>>>>>>>//     oSelList is a dbListSub
44836>>>>>>>>>>>>>//     oOK_bn is a Button
44836>>>>>>>>>>>>>//     oCancel_bn is a Button
44836>>>>>>>>>>>>>//     oSearch_bn is a Button
44836>>>>>>>>>>>>>
44836>>>>>>>>>>>>>// Register all objects
44836>>>>>>>>>>>>>Register_Object Gplan_DD
44836>>>>>>>>>>>>>Register_Object oCancel_bn
44836>>>>>>>>>>>>>Register_Object oOK_bn
44836>>>>>>>>>>>>>Register_Object oSearch_bn
44836>>>>>>>>>>>>>Register_Object oSelList
44836>>>>>>>>>>>>>Register_Object sl150
44836>>>>>>>>>>>>>
44836>>>>>>>>>>>>>
44836>>>>>>>>>>>>>    //AB-IgnoreStart
44836>>>>>>>>>>>>>
44836>>>>>>>>>>>>>    Use DFAllEnt.pkg
44836>>>>>>>>>>>>>    Use dbList.Sub
44836>>>>>>>>>>>>>
44836>>>>>>>>>>>>>
44836>>>>>>>>>>>>>    Use GPLAN.DD
INCLUDING FILE: GPLAN.DD
44836>>>>>>>>>>>>>>>//DDB-FileStart
44836>>>>>>>>>>>>>>>//DDB-HeaderStart
44836>>>>>>>>>>>>>>>
44836>>>>>>>>>>>>>>>// File Name : GPLAN.DD
44836>>>>>>>>>>>>>>>// Class Name: Gplan_DataDictionary
44836>>>>>>>>>>>>>>>// Revision  : 132
44836>>>>>>>>>>>>>>>// Version   : 2
44836>>>>>>>>>>>>>>>
44836>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
44836>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
44836>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
44836>>>>>>>>>>>>>>>
44836>>>>>>>>>>>>>>>Open Gplan
44838>>>>>>>>>>>>>>>Open Gmovea
INCLUDING FILE: GMOVEA.FD
44840>>>>>>>>>>>>>>>Open Gplanmod
INCLUDING FILE: GPLANMOD.FD
44842>>>>>>>>>>>>>>>Open Gmhnes
INCLUDING FILE: GMHNES.FD
44844>>>>>>>>>>>>>>>Open Gvatd
INCLUDING FILE: GVATD.FD
44846>>>>>>>>>>>>>>>Open Gpmoves
INCLUDING FILE: GPMOVES.FD
44848>>>>>>>>>>>>>>>Open Sysrecg
44850>>>>>>>>>>>>>>>Open Syscurgl
44852>>>>>>>>>>>>>>>
44852>>>>>>>>>>>>>>>//DDB-HeaderEnd
44852>>>>>>>>>>>>>>>//DDB-ValidationStart
44852>>>>>>>>>>>>>>>
44852>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_O_Code_VT
44852>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Yn_VT
44852>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Xpm_VT
44852>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Doy_VT
44852>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_J_Code_VT
44852>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_C_Code2_VT
44852>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_I_A_Code_VT2
44852>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Myf_Sum_VT
44852>>>>>>>>>>>>>>>
44852>>>>>>>>>>>>>>>Object Gplan_Gplan_O_Code_VT  is a CodeValidationTable
44854>>>>>>>>>>>>>>>    Set Type_Value        To "OMADA"
44855>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
44856>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
44856>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
44856>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_O_Code_VT
44857>>>>>>>>>>>>>>>
44857>>>>>>>>>>>>>>>Object Gplan_Gplan_Yn_VT  is a CodeValidationTable
44859>>>>>>>>>>>>>>>    Set Type_Value        To "YESNO"
44860>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
44860>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
44860>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Yn_VT
44861>>>>>>>>>>>>>>>
44861>>>>>>>>>>>>>>>Object Gplan_Gplan_Xpm_VT  is a DescriptionValidationTable
44863>>>>>>>>>>>>>>>
44863>>>>>>>>>>>>>>>    Procedure Fill_List
44865>>>>>>>>>>>>>>>        Forward Send Fill_List
44867>>>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "•¨œ¦ç£œ¤¦ª"
44868>>>>>>>>>>>>>>>        Send Add_Table_Value  "2"  " ©«¦ç£œ¤¦ª"
44869>>>>>>>>>>>>>>>        Send Add_Table_Value  "3"  "‹ ¡«æª"
44870>>>>>>>>>>>>>>>    End_Procedure    // Fill_List
44871>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
44871>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
44871>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Xpm_VT
44872>>>>>>>>>>>>>>>
44872>>>>>>>>>>>>>>>Object Gplan_Gplan_Doy_VT  is a CodeValidationTable
44874>>>>>>>>>>>>>>>    Set Type_Value        To "DOY"
44875>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
44876>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
44876>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
44876>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Doy_VT
44877>>>>>>>>>>>>>>>
44877>>>>>>>>>>>>>>>Object Gplan_Gplan_J_Code_VT  is a CodeValidationTable
44879>>>>>>>>>>>>>>>    Set Type_Value        To "JOB"
44880>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
44881>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
44881>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
44881>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_J_Code_VT
44882>>>>>>>>>>>>>>>
44882>>>>>>>>>>>>>>>Object Gplan_Gplan_C_Code2_VT  is a CodeValidationTable
44884>>>>>>>>>>>>>>>    Set Type_Value        To "CURRENCY"
44885>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
44886>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
44886>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
44886>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_C_Code2_VT
44887>>>>>>>>>>>>>>>
44887>>>>>>>>>>>>>>>Object Gplan_Gplan_I_A_Code_VT2  is a CodeValidationTable
44889>>>>>>>>>>>>>>>    Set Type_Value        To "AITIOL"
44890>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
44891>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
44891>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
44891>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_I_A_Code_VT2
44892>>>>>>>>>>>>>>>
44892>>>>>>>>>>>>>>>Object Gplan_Gplan_Myf_Sum_VT  is a CodeValidationTable
44894>>>>>>>>>>>>>>>    Set Type_Value        To "MYF"
44895>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
44895>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
44895>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Myf_Sum_VT
44896>>>>>>>>>>>>>>>//DDB-ValidationEnd
44896>>>>>>>>>>>>>>>//DDB-SelectionStart
44896>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.sl
44896>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList Gtypkin  Gtypkin.sl
44896>>>>>>>>>>>>>>>Register_Object sl150
44896>>>>>>>>>>>>>>>Register_Object Gtypkin
44896>>>>>>>>>>>>>>>//DDB-SelectionEnd
44896>>>>>>>>>>>>>>>Use arrays.Sub
44896>>>>>>>>>>>>>>>
44896>>>>>>>>>>>>>>>Use Gmovea.dd //®¨œ áœ«˜  ¦§à›ã§¦«œ, › æ«  œå¤˜  alias file ¡˜ 
INCLUDING FILE: GMOVEA.DD
44896>>>>>>>>>>>>>>>>>//DDB-FileStart
44896>>>>>>>>>>>>>>>>>//DDB-HeaderStart
44896>>>>>>>>>>>>>>>>>
44896>>>>>>>>>>>>>>>>>// File Name : GMOVEA.DD
44896>>>>>>>>>>>>>>>>>// Class Name: Gmovea_DataDictionary
44896>>>>>>>>>>>>>>>>>// Revision  : 17
44896>>>>>>>>>>>>>>>>>// Version   : 2
44896>>>>>>>>>>>>>>>>>
44896>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
44896>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
44896>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
44896>>>>>>>>>>>>>>>>>
44896>>>>>>>>>>>>>>>>>Open Gmovea
44898>>>>>>>>>>>>>>>>>Open Gopen
INCLUDING FILE: GOPEN.FD
44900>>>>>>>>>>>>>>>>>Open Garticl
INCLUDING FILE: GARTICL.FD
44902>>>>>>>>>>>>>>>>>Open Gplan
44904>>>>>>>>>>>>>>>>>
44904>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
44904>>>>>>>>>>>>>>>>>
44904>>>>>>>>>>>>>>>>>//open master file
44904>>>>>>>>>>>>>>>>>Open Gmove
44906>>>>>>>>>>>>>>>>>
44906>>>>>>>>>>>>>>>>>//define alias-master condition
44906>>>>>>>>>>>>>>>>>Set_Attribute DF_FILE_ALIAS of Gmovea.File_Number to DF_FILE_IS_ALIAS
44909>>>>>>>>>>>>>>>>>Set_Attribute DF_FILE_ALIAS of Gmove.File_Number  to DF_FILE_IS_MASTER
44912>>>>>>>>>>>>>>>>>
44912>>>>>>>>>>>>>>>>>//clear all relationships from the alias file
44912>>>>>>>>>>>>>>>>>Set_Relate Gmovea.Garticl_Recr to |FN0,0
44913>>>>>>>>>>>>>>>>>>
44913>>>>>>>>>>>>>>>>>Set_Relate Gmovea.Gplan_Recr   to |FN0,0
44914>>>>>>>>>>>>>>>>>>
44914>>>>>>>>>>>>>>>>>
44914>>>>>>>>>>>>>>>>>
44914>>>>>>>>>>>>>>>>>Class Gmovea_DataDictionary  is a DataDictionary_Sec
44915>>>>>>>>>>>>>>>>>
44915>>>>>>>>>>>>>>>>>
44915>>>>>>>>>>>>>>>>>      //private
44915>>>>>>>>>>>>>>>>>      //œ¤ž£œ¨é¤œ  «˜ 13 §œ›å˜ open item
44915>>>>>>>>>>>>>>>>>      //¡˜¢œå«˜  ˜§æ update
44915>>>>>>>>>>>>>>>>>      Procedure private.Do_Compute_Open_Itemsa
44916>>>>>>>>>>>>>>>>>                Case Begin
44916>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_X0 > 0) //˜«æ­ ¦ ®¨œà©« ¡æ record
44918>>>>>>>>>>>>>>>>>                          Move "+"                                                 to Gmovea.Gmove_Topen
44919>>>>>>>>>>>>>>>>>                          Move (     Gmovea.Gmove_X0  - Gmovea.Gmove_Open_Sx0) to Gmovea.Gmove_Open_Yx0
44920>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yp0
44921>>>>>>>>>>>>>>>>>                     Case Break
44922>>>>>>>>>>>>>>>>>
44922>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_X0 < 0) //¯œ¬«¦- ®¨œà©« ¡æ record
44925>>>>>>>>>>>>>>>>>                          Move "-"                                                 to Gmovea.Gmove_Topen
44926>>>>>>>>>>>>>>>>>                          Move ((Abs(Gmovea.Gmove_X0))- Gmovea.Gmove_Open_Sp0) to Gmovea.Gmove_Open_Yp0
44927>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yx0
44928>>>>>>>>>>>>>>>>>                     Case Break
44929>>>>>>>>>>>>>>>>>
44929>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_P0 > 0) //˜«æ­ ¦ § ©«à« ¡æ record
44932>>>>>>>>>>>>>>>>>                          Move "-"                                                 to Gmovea.Gmove_Topen
44933>>>>>>>>>>>>>>>>>                          Move (     Gmovea.Gmove_P0  - Gmovea.Gmove_Open_Sp0) to Gmovea.Gmove_Open_Yp0
44934>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yx0
44935>>>>>>>>>>>>>>>>>                     Case Break
44936>>>>>>>>>>>>>>>>>
44936>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_P0 < 0) //¯œç«¦- ®¨œà©« ¡æ record
44939>>>>>>>>>>>>>>>>>                          Move "+"                                                 to Gmovea.Gmove_Topen
44940>>>>>>>>>>>>>>>>>                          Move ((Abs(Gmovea.Gmove_P0))- Gmovea.Gmove_Open_Sx0) to Gmovea.Gmove_Open_Yx0
44941>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yp0
44942>>>>>>>>>>>>>>>>>                     Case Break
44943>>>>>>>>>>>>>>>>>                Case End
44943>>>>>>>>>>>>>>>>>      End_Procedure //private.do_compute_open_itemsa
44944>>>>>>>>>>>>>>>>>
44944>>>>>>>>>>>>>>>>>
44944>>>>>>>>>>>>>>>>>
44944>>>>>>>>>>>>>>>>>      //private
44944>>>>>>>>>>>>>>>>>      //œ¢âš®œ  «˜ 13 §œ›å˜ open item
44944>>>>>>>>>>>>>>>>>      //¡˜¢œå«˜  ˜§æ validate save
44944>>>>>>>>>>>>>>>>>      Function  private.fi_Validate_Open_Itemsa Returns Integer
44945>>>>>>>>>>>>>>>>>
44945>>>>>>>>>>>>>>>>>                 //1101+1102+1103+1104:â¢œš®¦  £ã ˜¨¤ž« ¡é¤ ¬§¦¢¦å§à¤ §¨¦ª ©¬©®â« ©ž ¡˜  ©¬©®œ« ©Ÿâ¤«à¤ §¦©é¤
44945>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 >= 0                       )) Function_Return 1101
44948>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 >= 0                       )) Function_Return 1102
44951>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 >= 0                       )) Function_Return 1103
44954>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 >= 0                       )) Function_Return 1104
44957>>>>>>>>>>>>>>>>>
44957>>>>>>>>>>>>>>>>>                 Case Begin
44957>>>>>>>>>>>>>>>>>                      //1105+1106+1107+1108:â¢œš®¦  š ˜ ˜«æ­ ¦ ®¨œà©« ¡æ record
44957>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_X0 > 0)
44959>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 <=      Gmovea.Gmove_X0  )) Function_Return 1105
44962>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 <=      Gmovea.Gmove_X0  )) Function_Return 1106
44965>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0  = 0                       )) Function_Return 1107
44968>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0  = 0                       )) Function_Return 1108
44971>>>>>>>>>>>>>>>>>                      Case Break
44972>>>>>>>>>>>>>>>>>                      //1109+1110+1111+1112:â¢œš®¦  š ˜ ¯œ¬«¦- ®¨œà©« ¡æ record
44972>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_X0 < 0)
44975>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0  = 0                       )) Function_Return 1109
44978>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0  = 0                       )) Function_Return 1110
44981>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 <= (Abs(Gmovea.Gmove_X0)))) Function_Return 1111
44984>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 <= (Abs(Gmovea.Gmove_X0)))) Function_Return 1112
44987>>>>>>>>>>>>>>>>>                      Case Break
44988>>>>>>>>>>>>>>>>>                      //1113+1114+1115+1116:â¢œš®¦  š ˜ ˜«æ­ ¦ § ©«à« ¡æ record
44988>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_P0 > 0)
44991>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0  = 0                       )) Function_Return 1113
44994>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0  = 0                       )) Function_Return 1114
44997>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 <=      Gmovea.Gmove_P0  )) Function_Return 1115
45000>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 <=      Gmovea.Gmove_P0  )) Function_Return 1116
45003>>>>>>>>>>>>>>>>>                      Case Break
45004>>>>>>>>>>>>>>>>>                      //1117+1118+1119+1120:â¢œš®¦  š ˜ ¯œç«¦- ®¨œà©« ¡æ record
45004>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_P0 < 0)
45007>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 <= (Abs(Gmovea.Gmove_P0)))) Function_Return 1117
45010>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 <= (Abs(Gmovea.Gmove_P0)))) Function_Return 1118
45013>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0  = 0                       )) Function_Return 1119
45016>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0  = 0                       )) Function_Return 1120
45019>>>>>>>>>>>>>>>>>                      Case Break
45020>>>>>>>>>>>>>>>>>                 Case End
45020>>>>>>>>>>>>>>>>>
45020>>>>>>>>>>>>>>>>>                 Function_Return 0 //æ¢˜ ok
45021>>>>>>>>>>>>>>>>>      End_Function //private.fi_validate_open_itemsa
45022>>>>>>>>>>>>>>>>>
45022>>>>>>>>>>>>>>>>>    Procedure Update
45023>>>>>>>>>>>>>>>>>          Send private.Do_Compute_Open_Itemsa
45024>>>>>>>>>>>>>>>>>    End_Procedure //update
45025>>>>>>>>>>>>>>>>>
45025>>>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
45026>>>>>>>>>>>>>>>>>              String lsError_Message
45027>>>>>>>>>>>>>>>>>              Case Begin
45027>>>>>>>>>>>>>>>>>                   //˜§æ validate save
45027>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1101)
45029>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ œå¤˜  ˜¨¤ž« ¡æ !");                        to lsError_Message
45030>>>>>>>>>>>>>>>>>                   Case Break
45031>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1102)
45034>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ œå¤˜  ˜¨¤ž« ¡æ !");                        to lsError_Message
45035>>>>>>>>>>>>>>>>>                   Case Break
45036>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1103)
45039>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª œå¤˜  ˜¨¤ž« ¡ã !");                        to lsError_Message
45040>>>>>>>>>>>>>>>>>                   Case Break
45041>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1104)
45044>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª œå¤˜  ˜¨¤ž« ¡ã !");                        to lsError_Message
45045>>>>>>>>>>>>>>>>>                   Case Break
45046>>>>>>>>>>>>>>>>>                   //---------------------------------------Ÿœ« ¡âª ®¨œé©œ ª-----------------
45046>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1105)
45049>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã ®¨âà©ž !");                        to lsError_Message
45050>>>>>>>>>>>>>>>>>                   Case Break
45051>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1106)
45054>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã ®¨âà©ž !");                        to lsError_Message
45055>>>>>>>>>>>>>>>>>                   Case Break
45056>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1107)
45059>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ !");                        to lsError_Message
45060>>>>>>>>>>>>>>>>>                   Case Break
45061>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1108)
45064>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
45065>>>>>>>>>>>>>>>>>                   Case Break
45066>>>>>>>>>>>>>>>>>                   //---------------------------------------˜¨¤ž« ¡âª ®¨œé©œ ª---------------
45066>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1109)
45069>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ!");                        to lsError_Message
45070>>>>>>>>>>>>>>>>>                   Case Break
45071>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1110)
45074>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
45075>>>>>>>>>>>>>>>>>                   Case Break
45076>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1111)
45079>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª ®¨âà©žª !");                        to lsError_Message
45080>>>>>>>>>>>>>>>>>                   Case Break
45081>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1112)
45084>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª ®¨âà©žª !");                        to lsError_Message
45085>>>>>>>>>>>>>>>>>                   Case Break
45086>>>>>>>>>>>>>>>>>                   //---------------------------------------Ÿœ« ¡âª § ©«é©œ ª----------------
45086>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1113)
45089>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ !");                        to lsError_Message
45090>>>>>>>>>>>>>>>>>                   Case Break
45091>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1114)
45094>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
45095>>>>>>>>>>>>>>>>>                   Case Break
45096>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1115)
45099>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã §å©«à©ž !");                        to lsError_Message
45100>>>>>>>>>>>>>>>>>                   Case Break
45101>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1116)
45104>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã §å©«à©ž !");                        to lsError_Message
45105>>>>>>>>>>>>>>>>>                   Case Break
45106>>>>>>>>>>>>>>>>>                   //---------------------------------------˜¨àž« ¡âª § ©«é©œ ª----------------
45106>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1117)
45109>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ!");                        to lsError_Message
45110>>>>>>>>>>>>>>>>>                   Case Break
45111>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1118)
45114>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
45115>>>>>>>>>>>>>>>>>                   Case Break
45116>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1119)
45119>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª §å©«à©žª !");                        to lsError_Message
45120>>>>>>>>>>>>>>>>>                   Case Break
45121>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1120) //soso ayto den xoraei display stin othoni !
45124>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª §å©«à©žª !");                        to lsError_Message
45125>>>>>>>>>>>>>>>>>                   Case Break
45126>>>>>>>>>>>>>>>>>
45126>>>>>>>>>>>>>>>>>
45126>>>>>>>>>>>>>>>>>                   //˜§æ validate delete
45126>>>>>>>>>>>>>>>>>                   Case (iError_Num = 2001)
45129>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n˜¨˜¡˜¢é ¡˜¢â©˜«œ «ž¤ Solution !");                        to lsError_Message
45130>>>>>>>>>>>>>>>>>                   Case Break
45131>>>>>>>>>>>>>>>>>
45131>>>>>>>>>>>>>>>>>                   Case Else
45131>>>>>>>>>>>>>>>>>                        Forward Send Operation_Not_Allowed iError_Num
45133>>>>>>>>>>>>>>>>>              Case End
45133>>>>>>>>>>>>>>>>>
45133>>>>>>>>>>>>>>>>>              Error iError_Num lsError_Message
45134>>>>>>>>>>>>>>>>>>
45134>>>>>>>>>>>>>>>>>    End_Procedure   //operation_not_allowed
45135>>>>>>>>>>>>>>>>>
45135>>>>>>>>>>>>>>>>>
45135>>>>>>>>>>>>>>>>>    Function Validate_Save Returns Integer
45136>>>>>>>>>>>>>>>>>             Integer iReturnVal liOpen_Itemsa
45137>>>>>>>>>>>>>>>>>             Forward Get Validate_Save to iReturnVal
45139>>>>>>>>>>>>>>>>>
45139>>>>>>>>>>>>>>>>>             If (Not(iReturnVal));             Begin
45141>>>>>>>>>>>>>>>>>             //1101-1120:â¢œš®¦  open item
45141>>>>>>>>>>>>>>>>>              Move (private.fi_Validate_Open_Itemsa(Self)) to liOpen_Itemsa
45142>>>>>>>>>>>>>>>>>              If (liOpen_Itemsa <> 0) Send Operation_Not_Allowed liOpen_Itemsa
45145>>>>>>>>>>>>>>>>>             End //«â¢¦ª ¡é› ¡˜ validation
45145>>>>>>>>>>>>>>>>>>
45145>>>>>>>>>>>>>>>>>
45145>>>>>>>>>>>>>>>>>
45145>>>>>>>>>>>>>>>>>             Function_Return iReturnVal
45146>>>>>>>>>>>>>>>>>    End_Function //validate_save
45147>>>>>>>>>>>>>>>>>
45147>>>>>>>>>>>>>>>>>
45147>>>>>>>>>>>>>>>>>    //2001:«¦ alias Gmovea ›â¤ œ§ «¨â§œ  ‰ € ‹ ˆ €   › ˜š¨˜­ã
45147>>>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
45148>>>>>>>>>>>>>>>>>             Send Operation_Not_Allowed 2001 //¢áŸ¦ª «¦¬ ¡é› ¡˜ !!!
45149>>>>>>>>>>>>>>>>>    End_Function //validate_delete
45150>>>>>>>>>>>>>>>>>
45150>>>>>>>>>>>>>>>>>
45150>>>>>>>>>>>>>>>>>    // Define_Fields:
45150>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
45150>>>>>>>>>>>>>>>>>
45150>>>>>>>>>>>>>>>>>    Procedure Define_Fields
45151>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
45153>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
45153>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
45153>>>>>>>>>>>>>>>>>
45153>>>>>>>>>>>>>>>>>        Set Main_File            To Gmovea.File_Number
45154>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
45155>>>>>>>>>>>>>>>>>
45155>>>>>>>>>>>>>>>>>
45155>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
45155>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gopen.File_Number
45156>>>>>>>>>>>>>>>>>
45156>>>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
45156>>>>>>>>>>>>>>>>>        Send Add_Server_File  Garticl.File_Number
45157>>>>>>>>>>>>>>>>>        Send Add_Server_File  Gplan.File_Number
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Field-based properties.......................
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Company_Code
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Branch_Code
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Year_Year
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Code
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Garticl_Hmnia
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Garticl_No
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Garticl_Recr
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Recr
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Rec0
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Code
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aitiol
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X0
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P0
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X0k
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P0k
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X00
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P00
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X00k
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P00k
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X1
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P1
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X2
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P2
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X2k
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P2k
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Xr
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Pr
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Xrk
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Prk
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Dlixis
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_A_Code
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gthhmgio_Code
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aa
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx0
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp0
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx0
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp0
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx1
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp1
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx1
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp1
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx2
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp2
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx2
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp2
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Sc_Code2
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aopen
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Topen
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Kk
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gthhmgio_Period
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Yn_Myfp
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Yn_Myfa
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Myf_Sump
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Myf_Suma
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag01
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag02
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag03
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag04
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag05
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag06
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag07
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag08
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag09
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag10
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag11
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag12
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag13
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag14
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag15
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag16
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag17
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag18
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag19
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag20
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Year_Recr
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Recr
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
45158>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
45159>>>>>>>>>>>>>>>>>
45159>>>>>>>>>>>>>>>>>    // Field_Defaults:
45159>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
45159>>>>>>>>>>>>>>>>>
45159>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
45160>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
45162>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
45162>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
45162>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
45162>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
45163>>>>>>>>>>>>>>>>>End_Class    // Gmovea_DataDictionary
45164>>>>>>>>>>>>>>>>>//DDB-FileEnd
45164>>>>>>>>>>>>>>>              //©«ž¤ begin_transaction §¨¦¡˜¢œå deadlock
45164>>>>>>>>>>>>>>>
45164>>>>>>>>>>>>>>>Class Gplan_DataDictionary  is a DataDictionary_Sec
45165>>>>>>>>>>>>>>>
45165>>>>>>>>>>>>>>>    Procedure Construct_Object
45166>>>>>>>>>>>>>>>        Forward Send Construct_Object
45168>>>>>>>>>>>>>>>        Object oarrayGplan_Aux is a cPinakas
45170>>>>>>>>>>>>>>>        End_Object
45171>>>>>>>>>>>>>>>        Property Integer    pioarray_Gplan_Aux (oarrayGplan_Aux(self))
45172>>>>>>>>>>>>>>>        Property String     psValidChars ""
45173>>>>>>>>>>>>>>>        Property Integer    piMustNOTConstrain Public 0 
45174>>>>>>>>>>>>>>>        Property String     psBranch 
45175>>>>>>>>>>>>>>>    End_Procedure   // Construct_Object
45176>>>>>>>>>>>>>>>
45176>>>>>>>>>>>>>>>    Procedure OnConstrain
45177>>>>>>>>>>>>>>>        Forward Send OnConstrain
45179>>>>>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
45181>>>>>>>>>>>>>>>        End
45181>>>>>>>>>>>>>>>>
45181>>>>>>>>>>>>>>>        Else Begin
45182>>>>>>>>>>>>>>>            Constrain Gplan.Company_Code  eq SysCurGL.Company_Code
45184>>>>>>>>>>>>>>>            Constrain Gplan.Branch_Code   eq SysCurGL.Branch_Code
45186>>>>>>>>>>>>>>>        End
45186>>>>>>>>>>>>>>>>
45186>>>>>>>>>>>>>>>    End_Procedure
45187>>>>>>>>>>>>>>>
45187>>>>>>>>>>>>>>>    Procedure Update
45188>>>>>>>>>>>>>>>        Forward Send Update
45190>>>>>>>>>>>>>>>        // Insert Code Here
45190>>>>>>>>>>>>>>>        Move SysCurGL.Company_Code  to Gplan.Company_Code
45191>>>>>>>>>>>>>>>        Move SysCurGL.Branch_Code   to Gplan.Branch_Code
45192>>>>>>>>>>>>>>>        Move SysCurGL.Year_Year     to Gplan.Year_Year
45193>>>>>>>>>>>>>>>        Move SysCurGL.Year_Recr     to Gplan.Year_Recr
45194>>>>>>>>>>>>>>>    End_Procedure   // Update
45195>>>>>>>>>>>>>>>
45195>>>>>>>>>>>>>>>    Procedure Creating
45196>>>>>>>>>>>>>>>        Forward Send Creating
45198>>>>>>>>>>>>>>>        // Insert Code Here
45198>>>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gplan.Gplan_Rec0)))))) to Gplan.Gplan_Recr
45199>>>>>>>>>>>>>>>    End_Procedure   // Creating
45200>>>>>>>>>>>>>>>
45200>>>>>>>>>>>>>>>
45200>>>>>>>>>>>>>>>//////////////////////////////////////
45200>>>>>>>>>>>>>>>//////////////////////////////////////
45200>>>>>>>>>>>>>>>
45200>>>>>>>>>>>>>>>    Function fiCheckValidChars String asGplanCode String asValChars Returns Integer
45201>>>>>>>>>>>>>>>        String lsChar
45202>>>>>>>>>>>>>>>        Integer liLen liCharPos rVal
45202>>>>>>>>>>>>>>>        If (asGplanCode <> "") Begin
45204>>>>>>>>>>>>>>>            Move (Trim(asGplanCode)) to asGplanCode
45205>>>>>>>>>>>>>>>            Move (Length(asGplanCode)) to liLen
45206>>>>>>>>>>>>>>>            For liCharPos From 1 to liLen
45212>>>>>>>>>>>>>>>>
45212>>>>>>>>>>>>>>>               Move (Mid(asGplanCode,1,liCharPos)) to lsChar
45213>>>>>>>>>>>>>>>               If (Not(asValChars contains lsChar)) Begin
45215>>>>>>>>>>>>>>>                    Set psValidChars to asValChars
45216>>>>>>>>>>>>>>>                    Function_Return 1001
45217>>>>>>>>>>>>>>>               End
45217>>>>>>>>>>>>>>>>
45217>>>>>>>>>>>>>>>            Loop
45218>>>>>>>>>>>>>>>>
45218>>>>>>>>>>>>>>>        End
45218>>>>>>>>>>>>>>>>
45218>>>>>>>>>>>>>>>        Function_Return rVal
45219>>>>>>>>>>>>>>>    End_Function // fiCheckValidChars
45220>>>>>>>>>>>>>>>
45220>>>>>>>>>>>>>>>    // private_Do_Restore_Fields:
45220>>>>>>>>>>>>>>>    Procedure private_Do_Restore_Fields for Gplan_DataDictionary
45221>>>>>>>>>>>>>>>        // Insert Code Here
45221>>>>>>>>>>>>>>>        Local Integer lioarray_Gplan_Aux##
45222>>>>>>>>>>>>>>>        Local Integer liFile##
45222>>>>>>>>>>>>>>>        Local Integer liField_Count##
45222>>>>>>>>>>>>>>>        Local Integer liField_Type##
45222>>>>>>>>>>>>>>>        Local Integer liField##
45222>>>>>>>>>>>>>>>
45222>>>>>>>>>>>>>>>        Get pioarray_Gplan_Aux to lioarray_Gplan_Aux##
45223>>>>>>>>>>>>>>>        Get Main_File to liFile##
45224>>>>>>>>>>>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of liFile## to liField_Count##
45227>>>>>>>>>>>>>>>
45227>>>>>>>>>>>>>>>
45227>>>>>>>>>>>>>>>        For liField## from 0 to (liField_Count##-1)
45233>>>>>>>>>>>>>>>>
45233>>>>>>>>>>>>>>>            //Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
45233>>>>>>>>>>>>>>>            move liField## to Fieldindex
45234>>>>>>>>>>>>>>>            Get Array_Value of lioarray_Gplan_Aux## Item (liField##+1) to Gplan.Company_Code&
45235>>>>>>>>>>>>>>>        Loop
45236>>>>>>>>>>>>>>>>
45236>>>>>>>>>>>>>>>        Send Delete_Data to lioarray_Gplan_Aux##
45237>>>>>>>>>>>>>>>    End_Procedure   // private_Do_Restore_Fields
45238>>>>>>>>>>>>>>>
45238>>>>>>>>>>>>>>>    // private_Do_Keep_Fields:
45238>>>>>>>>>>>>>>>
45238>>>>>>>>>>>>>>>    Procedure private_Do_Keep_Fields for Gplan_DataDictionary
45239>>>>>>>>>>>>>>>        // Insert Code Here
45239>>>>>>>>>>>>>>>        Local Integer lioarray_Gplan_Aux##
45240>>>>>>>>>>>>>>>        Local Integer liFile##
45240>>>>>>>>>>>>>>>        Local Integer liField_Count##
45240>>>>>>>>>>>>>>>        Local Integer liField_Type##
45240>>>>>>>>>>>>>>>        Local Integer liField##
45240>>>>>>>>>>>>>>>
45240>>>>>>>>>>>>>>>        Get pioarray_Gplan_Aux to lioarray_Gplan_Aux##
45241>>>>>>>>>>>>>>>        Get Main_File to liFile##
45242>>>>>>>>>>>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of liFile## to liField_Count##
45245>>>>>>>>>>>>>>>
45245>>>>>>>>>>>>>>>        Send Delete_Data to lioarray_Gplan_Aux##
45246>>>>>>>>>>>>>>>        Send Add_Item to lioarray_Gplan_Aux## 0 //sos.sos
45247>>>>>>>>>>>>>>>
45247>>>>>>>>>>>>>>>        For liField## from 0 to (liField_Count##-1)
45253>>>>>>>>>>>>>>>>
45253>>>>>>>>>>>>>>>            //Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
45253>>>>>>>>>>>>>>>            move liField## to Fieldindex
45254>>>>>>>>>>>>>>>            Send Add_Item to lioarray_Gplan_Aux## Gplan.Company_Code&
45255>>>>>>>>>>>>>>>        Loop
45256>>>>>>>>>>>>>>>>
45256>>>>>>>>>>>>>>>    End_Procedure   // private_Do_Keep_Fields
45257>>>>>>>>>>>>>>>
45257>>>>>>>>>>>>>>>    // Request_Save:
45257>>>>>>>>>>>>>>>
45257>>>>>>>>>>>>>>>
45257>>>>>>>>>>>>>>>
45257>>>>>>>>>>>>>>>//-----------------------------------------------------------------------------
45257>>>>>>>>>>>>>>>    FUNCTION Compute_Bathmos for Gplan_DataDictionary STRING KODIKOS## RETURNS INTEGER
45258>>>>>>>>>>>>>>>             LOCAL INTEGER BATHMOS##
45259>>>>>>>>>>>>>>>             REPEAT
45259>>>>>>>>>>>>>>>>
45259>>>>>>>>>>>>>>>                   REPLACE "." IN KODIKOS## WITH ""
45261>>>>>>>>>>>>>>>                   [FOUND] INCREMENT BATHMOS##
45262>>>>>>>>>>>>>>>             UNTIL (FINDERR=1)
45264>>>>>>>>>>>>>>>             FUNCTION_RETURN (BATHMOS##+1)
45265>>>>>>>>>>>>>>>    END_FUNCTION //compute_bathmos
45266>>>>>>>>>>>>>>>
45266>>>>>>>>>>>>>>>    FUNCTION Find_Previous for Gplan_DataDictionary STRING LS_CODE1## RETURNS STRING
45267>>>>>>>>>>>>>>>        LOCAL STRING LS_TEMP_CODE1## LS_TEMP_CODE2##
45268>>>>>>>>>>>>>>>        LOCAL INTEGER LI_COUNTER##
45268>>>>>>>>>>>>>>>
45268>>>>>>>>>>>>>>>        FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_CODE1##))
45274>>>>>>>>>>>>>>>>
45274>>>>>>>>>>>>>>>             INSERT (MID(LS_CODE1##,1,LI_COUNTER##)) IN LS_TEMP_CODE1## AT 1
45276>>>>>>>>>>>>>>>        LOOP
45277>>>>>>>>>>>>>>>>
45277>>>>>>>>>>>>>>>        MOVE (RIGHT(LS_TEMP_CODE1##,(LENGTH(LS_TEMP_CODE1##)-(POS(".",LS_TEMP_CODE1##))))) ;             TO LS_TEMP_CODE1##
45278>>>>>>>>>>>>>>>        FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_TEMP_CODE1##))
45284>>>>>>>>>>>>>>>>
45284>>>>>>>>>>>>>>>            INSERT (MID(LS_TEMP_CODE1##,1,LI_COUNTER##)) IN LS_TEMP_CODE2## AT 1
45286>>>>>>>>>>>>>>>        LOOP
45287>>>>>>>>>>>>>>>>
45287>>>>>>>>>>>>>>>        FUNCTION_RETURN LS_TEMP_CODE2##
45288>>>>>>>>>>>>>>>    END_FUNCTION
45289>>>>>>>>>>>>>>>
45289>>>>>>>>>>>>>>>    FUNCTION fiCheck_Format STRING  LS_CODE1##;                            STRING  LS_MASK##;                            INTEGER LI_BATHMOS##;                            RETURNS INTEGER
45290>>>>>>>>>>>>>>>             String  LS_TEMP_CODE1## LS_TEMP_CODE2## LS_MASK2##
45291>>>>>>>>>>>>>>>             Integer LI_COUNTER## LI_BATHMOS1##
45291>>>>>>>>>>>>>>>             Move (Trim(ls_Code1##)) to ls_Code1##
45292>>>>>>>>>>>>>>>             Move (Trim(ls_Mask##))  to ls_Mask##
45293>>>>>>>>>>>>>>>             FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_MASK##))
45299>>>>>>>>>>>>>>>>
45299>>>>>>>>>>>>>>>                  IF ((MID(LS_MASK##,1,LI_COUNTER##)) = ".") INCREMENT LI_BATHMOS1##
45302>>>>>>>>>>>>>>>                  IF (LI_BATHMOS1## < LI_BATHMOS##) ;                  INSERT (MID(LS_MASK##,1,LI_COUNTER##)) IN LS_MASK2## AT LI_COUNTER##
45306>>>>>>>>>>>>>>>             LOOP
45307>>>>>>>>>>>>>>>>
45307>>>>>>>>>>>>>>>             IF (;                  (LENGTH(LS_CODE1##)) <> (LENGTH(LS_MASK2##));                ) FUNCTION_RETURN 1000
45310>>>>>>>>>>>>>>>             FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_MASK2##))
45316>>>>>>>>>>>>>>>>
45316>>>>>>>>>>>>>>>                  IF (;                      ((MID(LS_MASK2##,1,LI_COUNTER##)) = ".") AND;                      ((MID(LS_CODE1##,1,LI_COUNTER##)) <> ".");                     ) FUNCTION_RETURN 1000
45319>>>>>>>>>>>>>>>             LOOP
45320>>>>>>>>>>>>>>>>
45320>>>>>>>>>>>>>>>             FUNCTION_RETURN 0
45321>>>>>>>>>>>>>>>    END_FUNCTION //fiCHECK_FORMAT
45322>>>>>>>>>>>>>>>
45322>>>>>>>>>>>>>>>    Function fiBackward_Check for Gplan_DataDictionary String LsGplanCode_Back integer liBathmos Returns Integer
45323>>>>>>>>>>>>>>>        Integer liGplan_Yn_Last
45324>>>>>>>>>>>>>>>        Number liGplanRecnum
45324>>>>>>>>>>>>>>>        String LsSearch_CodePrevious
45324>>>>>>>>>>>>>>>
45324>>>>>>>>>>>>>>>        if (liBathmos > 1) begin
45326>>>>>>>>>>>>>>>
45326>>>>>>>>>>>>>>>            move (Current_Record(Self)) to liGplanRecnum
45327>>>>>>>>>>>>>>>            move gplan.Gplan_Yn_Last to liGplan_Yn_Last
45328>>>>>>>>>>>>>>>            Send private_Do_Keep_Fields
45329>>>>>>>>>>>>>>>
45329>>>>>>>>>>>>>>>            Move (Find_Previous(self,lsGplanCode_Back)) to lsSearch_CodePrevious
45330>>>>>>>>>>>>>>>
45330>>>>>>>>>>>>>>>            clear Gplan
45331>>>>>>>>>>>>>>>            move gs_Selected_Company_Code  to Gplan.Company_Code
45332>>>>>>>>>>>>>>>            move gs_Selected_Branch_Code   to Gplan.Branch_Code
45333>>>>>>>>>>>>>>>            move gi_Selected_Year          to Gplan.Year_Year
45334>>>>>>>>>>>>>>>            move lsSearch_CodePrevious     to Gplan.Gplan_Code
45335>>>>>>>>>>>>>>>            Find eq Gplan by index.1 // pkid
45336>>>>>>>>>>>>>>>>
45336>>>>>>>>>>>>>>>            If (Found = 0) begin
45338>>>>>>>>>>>>>>>                clear gplan
45339>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
45340>>>>>>>>>>>>>>>                find eq gplan.recnum
45341>>>>>>>>>>>>>>>>
45341>>>>>>>>>>>>>>>                Send private_Do_Restore_Fields
45342>>>>>>>>>>>>>>>                Function_return  7001 //return to fiValidate
45343>>>>>>>>>>>>>>>            end
45343>>>>>>>>>>>>>>>>
45343>>>>>>>>>>>>>>>            else begin
45344>>>>>>>>>>>>>>>               // The  previous logar marked last  and current greater bathmos
45344>>>>>>>>>>>>>>>               if   (Gplan.Gplan_yn_Last = 1) begin
45346>>>>>>>>>>>>>>>                   Send private_Do_Restore_Fields
45347>>>>>>>>>>>>>>>                   Function_return 7003
45348>>>>>>>>>>>>>>>               end
45348>>>>>>>>>>>>>>>>
45348>>>>>>>>>>>>>>>               clear gplan
45349>>>>>>>>>>>>>>>               move liGplanRecnum to gplan.recnum
45350>>>>>>>>>>>>>>>               find eq gplan.recnum
45351>>>>>>>>>>>>>>>>
45351>>>>>>>>>>>>>>>               Send private_Do_Restore_Fields
45352>>>>>>>>>>>>>>>               function_Return 0 //ok
45353>>>>>>>>>>>>>>>            end
45353>>>>>>>>>>>>>>>>
45353>>>>>>>>>>>>>>>        end
45353>>>>>>>>>>>>>>>>
45353>>>>>>>>>>>>>>>        Function_Return 0
45354>>>>>>>>>>>>>>>    End_Function  // fiBackward_Check
45355>>>>>>>>>>>>>>>    //-----------------------------------------------------------------------------
45355>>>>>>>>>>>>>>>
45355>>>>>>>>>>>>>>>
45355>>>>>>>>>>>>>>>    //-----------------------------------------------------------------------------
45355>>>>>>>>>>>>>>>    FUNCTION fiForward_Check for Gplan_DataDictionary STRING LS_GplanCode integer liMode Returns Integer
45356>>>>>>>>>>>>>>>        String lsNext_Anoep
45357>>>>>>>>>>>>>>>        Integer liGplan_Yn_Last
45357>>>>>>>>>>>>>>>        Number liGplanRecnum
45357>>>>>>>>>>>>>>>
45357>>>>>>>>>>>>>>>
45357>>>>>>>>>>>>>>>        //move gplan.recnum to liGplanRecnum
45357>>>>>>>>>>>>>>>        move (Current_Record(Self)) to liGplanRecnum
45358>>>>>>>>>>>>>>>        move gplan.Gplan_Code to lsNext_Anoep
45359>>>>>>>>>>>>>>>        move gplan.Gplan_Yn_Last to liGplan_Yn_Last
45360>>>>>>>>>>>>>>>        Send private_Do_Keep_Fields
45361>>>>>>>>>>>>>>>
45361>>>>>>>>>>>>>>>        if (liGplan_Yn_Last = 1)  begin
45363>>>>>>>>>>>>>>>            find gt gplan by index.1
45364>>>>>>>>>>>>>>>>
45364>>>>>>>>>>>>>>>            if (found = 0) begin
45366>>>>>>>>>>>>>>>                clear gplan
45367>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
45368>>>>>>>>>>>>>>>                find eq gplan.recnum
45369>>>>>>>>>>>>>>>>
45369>>>>>>>>>>>>>>>                Send private_Do_Restore_Fields
45370>>>>>>>>>>>>>>>            end
45370>>>>>>>>>>>>>>>>
45370>>>>>>>>>>>>>>>            else begin
45371>>>>>>>>>>>>>>>                // The Current and the previous logar marked last
45371>>>>>>>>>>>>>>>                if (Gplan.Gplan_Anoep = lsNext_Anoep) begin
45373>>>>>>>>>>>>>>>                    clear gplan
45374>>>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
45375>>>>>>>>>>>>>>>                    find eq gplan.recnum
45376>>>>>>>>>>>>>>>>
45376>>>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
45377>>>>>>>>>>>>>>>                    Function_return 7004
45378>>>>>>>>>>>>>>>                end
45378>>>>>>>>>>>>>>>>
45378>>>>>>>>>>>>>>>                else begin
45379>>>>>>>>>>>>>>>                    clear gplan
45380>>>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
45381>>>>>>>>>>>>>>>                    find eq gplan.recnum
45382>>>>>>>>>>>>>>>>
45382>>>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
45383>>>>>>>>>>>>>>>                end
45383>>>>>>>>>>>>>>>>
45383>>>>>>>>>>>>>>>            end
45383>>>>>>>>>>>>>>>>
45383>>>>>>>>>>>>>>>        end
45383>>>>>>>>>>>>>>>>
45383>>>>>>>>>>>>>>>
45383>>>>>>>>>>>>>>>        if (liMode = 1) begin
45385>>>>>>>>>>>>>>>            find gt gplan by index.1
45386>>>>>>>>>>>>>>>>
45386>>>>>>>>>>>>>>>            if (Found = 0) begin
45388>>>>>>>>>>>>>>>                clear gplan
45389>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
45390>>>>>>>>>>>>>>>                find eq gplan.recnum
45391>>>>>>>>>>>>>>>>
45391>>>>>>>>>>>>>>>                Send private_Do_Restore_Fields
45392>>>>>>>>>>>>>>>            end
45392>>>>>>>>>>>>>>>>
45392>>>>>>>>>>>>>>>            else begin
45393>>>>>>>>>>>>>>>                if (Gplan.Gplan_Anoep = lsNext_Anoep) begin
45395>>>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
45396>>>>>>>>>>>>>>>                    find eq gplan.recnum
45397>>>>>>>>>>>>>>>>
45397>>>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
45398>>>>>>>>>>>>>>>                    Function_return 7010 //called from validate delete
45399>>>>>>>>>>>>>>>                end
45399>>>>>>>>>>>>>>>>
45399>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
45400>>>>>>>>>>>>>>>                find eq gplan.recnum
45401>>>>>>>>>>>>>>>>
45401>>>>>>>>>>>>>>>                //Send private_Do_Restore_Fields
45401>>>>>>>>>>>>>>>            end
45401>>>>>>>>>>>>>>>>
45401>>>>>>>>>>>>>>>        end
45401>>>>>>>>>>>>>>>>
45401>>>>>>>>>>>>>>>        Function_return 0
45402>>>>>>>>>>>>>>>    End_Function // fiForward_Check
45403>>>>>>>>>>>>>>>
45403>>>>>>>>>>>>>>>
45403>>>>>>>>>>>>>>>    Function private_Man_Gplan_Code for Gplan_DataDictionary integer liField## String lsGplan_Code integer liModeGplan Returns Integer
45404>>>>>>>>>>>>>>>
45404>>>>>>>>>>>>>>>        // Insert Code Here
45404>>>>>>>>>>>>>>>        Integer liCounter liPosition liLength liBathmos liRetVal
45405>>>>>>>>>>>>>>>        string lsMask lsCkeckChar lsSearchCode
45405>>>>>>>>>>>>>>>
45405>>>>>>>>>>>>>>>        Trim lsGplan_code to lsGplan_code
45406>>>>>>>>>>>>>>>>
45406>>>>>>>>>>>>>>>        Move lsGplan_Code to lsSearchCode
45407>>>>>>>>>>>>>>>    Search_Again:
45407>>>>>>>>>>>>>>>        clear Gformat
INCLUDING FILE: GFORMAT.FD
45408>>>>>>>>>>>>>>>        move SysCurGL.Company_Code  to Gformat.Company_Code
45409>>>>>>>>>>>>>>>        move SysCurGL.Branch_Code   to Gformat.Branch_Code
45410>>>>>>>>>>>>>>>        move SysCurGL.Year_Year     to Gformat.Year_Year
45411>>>>>>>>>>>>>>>        move lsSearchCode           to Gformat.Gformat_Code
45412>>>>>>>>>>>>>>>        Find eq Gformat by index.1
45413>>>>>>>>>>>>>>>>
45413>>>>>>>>>>>>>>>
45413>>>>>>>>>>>>>>>        if (Found = 1) begin
45415>>>>>>>>>>>>>>>            Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
45416>>>>>>>>>>>>>>>            Move (fiCheck_Format(self,lsGplan_Code,gformat.gformat_mask,liBathmos)) to liRetVal
45417>>>>>>>>>>>>>>>            if (liRetVal = 0) begin
45419>>>>>>>>>>>>>>>                Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
45420>>>>>>>>>>>>>>>                if (liModeGplan = 0) Begin
45422>>>>>>>>>>>>>>>                    if (Not(Current_Record(self))) begin
45424>>>>>>>>>>>>>>>                        set field_default_value field Gplan.gplan_Bathmos to libathmos //from deo
45425>>>>>>>>>>>>>>>                    end
45425>>>>>>>>>>>>>>>>
45425>>>>>>>>>>>>>>>                end
45425>>>>>>>>>>>>>>>>
45425>>>>>>>>>>>>>>>                if (libathmos > 1) begin
45427>>>>>>>>>>>>>>>                    Move (Find_Previous(self,lsGplan_Code)) to lsSearchCode
45428>>>>>>>>>>>>>>>                    if (liModeGplan = 0) Begin
45430>>>>>>>>>>>>>>>                        if (Not(Current_Record(self))) begin
45432>>>>>>>>>>>>>>>                            set field_default_value field Gplan.gplan_Anoep to lsSearchCode //from Deo
45433>>>>>>>>>>>>>>>                        End
45433>>>>>>>>>>>>>>>>
45433>>>>>>>>>>>>>>>                    End
45433>>>>>>>>>>>>>>>>
45433>>>>>>>>>>>>>>>                end
45433>>>>>>>>>>>>>>>>
45433>>>>>>>>>>>>>>>            function_return 0
45434>>>>>>>>>>>>>>>            end
45434>>>>>>>>>>>>>>>>
45434>>>>>>>>>>>>>>>            else begin
45435>>>>>>>>>>>>>>>                function_return 127
45436>>>>>>>>>>>>>>>            end
45436>>>>>>>>>>>>>>>>
45436>>>>>>>>>>>>>>>        end
45436>>>>>>>>>>>>>>>>
45436>>>>>>>>>>>>>>>        else begin
45437>>>>>>>>>>>>>>>            Move (Compute_Bathmos(self,lsSearchCode)) to liBathmos
45438>>>>>>>>>>>>>>>            if ((liBathmos-1) <> 0) begin
45440>>>>>>>>>>>>>>>                Move (Find_Previous(self,lsSearchCode)) to lsSearchCode
45441>>>>>>>>>>>>>>>                Goto Search_Again
45442>>>>>>>>>>>>>>>>
45442>>>>>>>>>>>>>>>            end
45442>>>>>>>>>>>>>>>>
45442>>>>>>>>>>>>>>>            else begin
45443>>>>>>>>>>>>>>>                clear Gformat
45444>>>>>>>>>>>>>>>                move SysCurGL.Company_Code  to Gformat.Company_Code
45445>>>>>>>>>>>>>>>                move SysCurGL.Branch_Code   to Gformat.Branch_Code
45446>>>>>>>>>>>>>>>                move SysCurGL.Year_Year     to Gformat.Year_Year
45447>>>>>>>>>>>>>>>                move "@@"                   to Gformat.Gformat_Code
45448>>>>>>>>>>>>>>>                Find eq Gformat by index.1 // pkid
45449>>>>>>>>>>>>>>>>
45449>>>>>>>>>>>>>>>//* to be a function
45449>>>>>>>>>>>>>>>                Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
45450>>>>>>>>>>>>>>>                Move (fiCheck_Format(self,lsGplan_Code,gformat.gformat_mask,liBathmos)) to liRetVal
45451>>>>>>>>>>>>>>>                if (liRetVal = 0) begin
45453>>>>>>>>>>>>>>>                    Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
45454>>>>>>>>>>>>>>>                    if (liModeGplan = 0) Begin
45456>>>>>>>>>>>>>>>                        if (Not(Current_Record(self))) begin
45458>>>>>>>>>>>>>>>                            set field_default_value field Gplan.gplan_Bathmos to libathmos //from Deo
45459>>>>>>>>>>>>>>>                        end
45459>>>>>>>>>>>>>>>>
45459>>>>>>>>>>>>>>>                    end
45459>>>>>>>>>>>>>>>>
45459>>>>>>>>>>>>>>>                    if (libathmos > 1) begin
45461>>>>>>>>>>>>>>>                        Move (Find_Previous(self,lsGplan_Code)) to lsSearchCode
45462>>>>>>>>>>>>>>>                        if (liModeGplan = 0) Begin
45464>>>>>>>>>>>>>>>                            if (Not(Current_Record(self))) begin
45466>>>>>>>>>>>>>>>                                set field_default_value field Gplan.gplan_Anoep to lsSearchCode //from Deo
45467>>>>>>>>>>>>>>>                            end
45467>>>>>>>>>>>>>>>>
45467>>>>>>>>>>>>>>>                        end
45467>>>>>>>>>>>>>>>>
45467>>>>>>>>>>>>>>>                    end
45467>>>>>>>>>>>>>>>>
45467>>>>>>>>>>>>>>>                function_return 0
45468>>>>>>>>>>>>>>>                end
45468>>>>>>>>>>>>>>>>
45468>>>>>>>>>>>>>>>                else begin
45469>>>>>>>>>>>>>>>                    function_return 127
45470>>>>>>>>>>>>>>>                end
45470>>>>>>>>>>>>>>>>
45470>>>>>>>>>>>>>>>
45470>>>>>>>>>>>>>>>                //* emd to be a function
45470>>>>>>>>>>>>>>>                function_return 0
45471>>>>>>>>>>>>>>>            end
45471>>>>>>>>>>>>>>>>
45471>>>>>>>>>>>>>>>        end
45471>>>>>>>>>>>>>>>>
45471>>>>>>>>>>>>>>>        Function_return 0    //ok
45472>>>>>>>>>>>>>>>    End_Function   // private_Man_Gplan_Code
45473>>>>>>>>>>>>>>>
45473>>>>>>>>>>>>>>>
45473>>>>>>>>>>>>>>>
45473>>>>>>>>>>>>>>>    // fiValidateGplanFields:
45473>>>>>>>>>>>>>>>
45473>>>>>>>>>>>>>>>    Function fiValidateGplanFields for Gplan_DataDictionary integer liField string lsFieldvalue Returns Integer
45474>>>>>>>>>>>>>>>        String  sName lsAnoep lsGplan_Code
45475>>>>>>>>>>>>>>>        Integer iMainFile liGplanRecnum liReturnVal liReturnValb liBathmos1
45475>>>>>>>>>>>>>>>        String lsValidChar lsDelimiter
45475>>>>>>>>>>>>>>>
45475>>>>>>>>>>>>>>>        Get Main_File to iMainFile
45476>>>>>>>>>>>>>>>        Get_Attribute DF_FIELD_NAME of iMainFile liField to sName
45479>>>>>>>>>>>>>>>
45479>>>>>>>>>>>>>>>        If (sName = 'GPLAN_CODE') Begin
45481>>>>>>>>>>>>>>>            move (trim(lsFieldvalue)) to lsFieldvalue //from deo
45482>>>>>>>>>>>>>>>            if (lsFieldvalue <>  "") begin //new
45484>>>>>>>>>>>>>>>                Move SyscurGL.Year_Valid_Char to lsValidChar
45485>>>>>>>>>>>>>>>                Move SyscurGL.Year_Delimiter  to lsDelimiter
45486>>>>>>>>>>>>>>>                Move (fiCheckValidChars(Self,lsFieldvalue,((Trim(lsValidChar))+(Trim(lsDelimiter))))) to liReturnVal
45487>>>>>>>>>>>>>>>                if (liReturnVal = '1001') begin
45489>>>>>>>>>>>>>>>                               error liReturnVal ("‹ž ˜§¦›œ¡«æª ®˜¨˜¡«ã¨˜ª š ˜ ¡à› ¡æ Š.‘ !\n\n€§¦›œ¡«¦å ®˜¨˜¡«ã¨œª : '" + (psValidChars(Self)) + "'")
45490>>>>>>>>>>>>>>>>
45490>>>>>>>>>>>>>>>                               Function_Return liReturnVal
45491>>>>>>>>>>>>>>>                            end
45491>>>>>>>>>>>>>>>>
45491>>>>>>>>>>>>>>>
45491>>>>>>>>>>>>>>>                Move (private_Man_Gplan_Code(self,liField,lsFieldvalue,0)) to liReturnVal
45492>>>>>>>>>>>>>>>                if (lireturnval <> 0) begin
45494>>>>>>>>>>>>>>>                                        error 127 ("ŠáŸ¦ª £¦¨­ã ¡à› ¡¦ç !\n\n"+Gplan.Gplan_Code)
45495>>>>>>>>>>>>>>>>
45495>>>>>>>>>>>>>>>                                        function_return 127
45496>>>>>>>>>>>>>>>                                      end
45496>>>>>>>>>>>>>>>>
45496>>>>>>>>>>>>>>>
45496>>>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_Code to lsGplan_Code
45497>>>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_Bathmos to liBathmos1
45498>>>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_anoep to lsAnoep
45499>>>>>>>>>>>>>>>                Move (fiBackward_Check(self,lsGplan_Code,liBathmos1)) to liReturnValb
45500>>>>>>>>>>>>>>>                if (liReturnValb = '7001') begin
45502>>>>>>>>>>>>>>>                                               error 7001 "ƒœ¤ ¬§á¨®œ  ¦ §œ¨ ¢ž§« ¡æª ™˜Ÿ£æª !"
45503>>>>>>>>>>>>>>>>
45503>>>>>>>>>>>>>>>                                               Function_Return 8001
45504>>>>>>>>>>>>>>>                                            end
45504>>>>>>>>>>>>>>>>
45504>>>>>>>>>>>>>>>                if (liReturnValb = '7002') begin
45506>>>>>>>>>>>>>>>                                               error 7002 "“§á¨®œ  ¡à› ¡æª «œ¢œ¬«˜å¦¬ ™˜Ÿ£¦ç !"
45507>>>>>>>>>>>>>>>>
45507>>>>>>>>>>>>>>>                                               Function_Return 8002
45508>>>>>>>>>>>>>>>                                          end
45508>>>>>>>>>>>>>>>>
45508>>>>>>>>>>>>>>>                if (liReturnValb = '7003') begin
45510>>>>>>>>>>>>>>>                                               error 7003 "Ž §¨¦žš¦ç£œ¤¦ª œå¤˜  «œ¢œ¬«˜å¦¬ ™˜Ÿ£¦ç !"
45511>>>>>>>>>>>>>>>>
45511>>>>>>>>>>>>>>>                                               Function_Return 8003
45512>>>>>>>>>>>>>>>                                          end
45512>>>>>>>>>>>>>>>>
45512>>>>>>>>>>>>>>>
45512>>>>>>>>>>>>>>>                Move (fiForward_Check(self,lsGplan_Code,0)) to liReturnValb
45513>>>>>>>>>>>>>>>                if (liReturnValb = '7004') begin
45515>>>>>>>>>>>>>>>                                               error 7004 "“§á¨®œ  ¦ ˜¤é«œ¨¦ª ™˜Ÿ£æª !"
45516>>>>>>>>>>>>>>>>
45516>>>>>>>>>>>>>>>                                               Function_Return 8004
45517>>>>>>>>>>>>>>>                                            end
45517>>>>>>>>>>>>>>>>
45517>>>>>>>>>>>>>>>
45517>>>>>>>>>>>>>>>            end
45517>>>>>>>>>>>>>>>>
45517>>>>>>>>>>>>>>>            else Function_Return 0  //exit function ok!!!
45519>>>>>>>>>>>>>>>         end
45519>>>>>>>>>>>>>>>>
45519>>>>>>>>>>>>>>>         function_return 0
45520>>>>>>>>>>>>>>>    End_Function   // fiValidateGplanFields
45521>>>>>>>>>>>>>>>
45521>>>>>>>>>>>>>>>
45521>>>>>>>>>>>>>>>//-----------------------------------------------Save Operation ----------------------------------------------------
45521>>>>>>>>>>>>>>>
45521>>>>>>>>>>>>>>>
45521>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
45522>>>>>>>>>>>>>>>        //Forward Send Operation_Not_Allowed  iError_Num
45522>>>>>>>>>>>>>>>        // Insert Code Here
45522>>>>>>>>>>>>>>>                 if iError_num eq 127  error 127 ((Trim(Gplan.Gplan_Code))+" Wrong Format !!!! \n\n")
45525>>>>>>>>>>>>>>>            Else if iError_num eq 128  error 128 ("Not a valid Data Entry.  Account is Missing !!!!\n\n"+Gplan.Gplan_Code)
45529>>>>>>>>>>>>>>>            Else if iError_num eq 129  error 129 ("Not a valid Data Entry.  Bathmos is Missing !!!!\n\n"+Gplan.Gplan_Code)
45533>>>>>>>>>>>>>>>            Else if iError_num eq 130  error 130 ("Not a valid Data Entry.  Previews Account is Missing !!!!\n\n"+Gplan.Gplan_Code)
45537>>>>>>>>>>>>>>>            Else if iError_num eq 1100  error 1100 "DDC:150 - ‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
45541>>>>>>>>>>>>>>>            Else if iError_num eq 2100  error 2100 "DDC:150 - ‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
45545>>>>>>>>>>>>>>>            Else if iError_num eq 7001 error 8001 ("Anoep Does not Exist !!!!\n\n"+Gplan.Gplan_Code)
45549>>>>>>>>>>>>>>>            Else if iError_num eq 7002 error 8002 ("Last Exists\n\n!!!! "+Gplan.Gplan_Code)
45553>>>>>>>>>>>>>>>            Else if iError_num eq 7003 error 8003 ("Previous batmos is last  !!!!\n\n"+Gplan.Gplan_Code)
45557>>>>>>>>>>>>>>>            Else if iError_num eq 7004 error 8004 ("Greater bathmos exists  !!!!\n\n"+Gplan.Gplan_Code)
45561>>>>>>>>>>>>>>>            Else if iError_num eq 7010 error 7010 ("Greater bathmos exists  !!!!\n\n"+Gplan.Gplan_Code)
45565>>>>>>>>>>>>>>>            Else if (iError_num = 1001) error 1001 ("‹ž ˜§¦›œ¡«æª ®˜¨˜¡«ã¨˜ª š ˜ ¡à› ¡æ Š.‘ !\n\n€§¦›œ¡«¦å ®˜¨˜¡«ã¨œª : '" + (psValidChars(Self)) + "'")
45569>>>>>>>>>>>>>>>            Else Forward Send Operation_Not_Allowed  iError_Num
45572>>>>>>>>>>>>>>>    End_Procedure
45573>>>>>>>>>>>>>>>
45573>>>>>>>>>>>>>>>
45573>>>>>>>>>>>>>>>    Procedure Clear_From_Bpo
45574>>>>>>>>>>>>>>>        Clear Gplan
45575>>>>>>>>>>>>>>>    End_Procedure
45576>>>>>>>>>>>>>>>
45576>>>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
45577>>>>>>>>>>>>>>>        Local Integer iReturnVal iField##
45578>>>>>>>>>>>>>>>        locaL string lsVal##
45578>>>>>>>>>>>>>>>
45578>>>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
45580>>>>>>>>>>>>>>>
45580>>>>>>>>>>>>>>>
45580>>>>>>>>>>>>>>>        If (Not(iReturnVal))Begin
45582>>>>>>>>>>>>>>>        //    If (Not(Current_Record(Self))) Move (fiCheckValidChars(Self,Gplan.Gplan_Code,((Trim(Year.Year_Valid_Char))+(Trim(Year.Year_Delimiter))))) to iReturnVal
45582>>>>>>>>>>>>>>>        //    If (iReturnVal) Send Operation_Not_Allowed iReturnVal
45582>>>>>>>>>>>>>>>            If (Gplan.Gplan_Code    = "") Send Operation_Not_Allowed 128
45585>>>>>>>>>>>>>>>            If (Gplan.Gplan_Bathmos = 0 ) Send Operation_Not_Allowed 129
45588>>>>>>>>>>>>>>>            If (;                 (Gplan.Gplan_Bathmos <> 1) and;                 (Gplan.Gplan_Anoep = "");               ) Send Operation_Not_Allowed 130
45591>>>>>>>>>>>>>>>            For iField## from 4 to 4   // Field number for Starting and Ending pp's ???????
45597>>>>>>>>>>>>>>>>
45597>>>>>>>>>>>>>>>
45597>>>>>>>>>>>>>>>                Move (private_Man_Gplan_Code(self,iField##,Gplan.Gplan_Code,1))     to iReturnVal
45598>>>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
45601>>>>>>>>>>>>>>>
45601>>>>>>>>>>>>>>>                Move (fiBACKWARD_CHECK(self,Gplan.Gplan_Code,Gplan.Gplan_Bathmos)) to iReturnVal
45602>>>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
45605>>>>>>>>>>>>>>>
45605>>>>>>>>>>>>>>>                Move (fiFORWARD_CHECK(self,Gplan.Gplan_Code,0))                     to iReturnVal
45606>>>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
45609>>>>>>>>>>>>>>>
45609>>>>>>>>>>>>>>>            Loop
45610>>>>>>>>>>>>>>>>
45610>>>>>>>>>>>>>>>              //1100:cby = globals
45610>>>>>>>>>>>>>>>              If ( ;                   (Not(Gplan.Company_Code = SysCurGL.Company_Code)) or;                   (Not(Gplan.Branch_Code  = SysCurGL.Branch_Code )) ;                  ) Send Operation_Not_Allowed 1100
45613>>>>>>>>>>>>>>>        End
45613>>>>>>>>>>>>>>>>
45613>>>>>>>>>>>>>>>        Function_Return iReturnVal
45614>>>>>>>>>>>>>>>    End_Function
45615>>>>>>>>>>>>>>>
45615>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
45616>>>>>>>>>>>>>>>        Local Integer iReturnVal liReturnValb##
45617>>>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
45619>>>>>>>>>>>>>>>
45619>>>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
45621>>>>>>>>>>>>>>>            // Insert Code Here
45621>>>>>>>>>>>>>>>               Move (fiFORWARD_CHECK(Self,Gplan.Gplan_Code,1)) to liReturnValb##
45622>>>>>>>>>>>>>>>               If (liReturnValb##>1) Send Operation_Not_Allowed liReturnValb##
45625>>>>>>>>>>>>>>>              //2100:cby = globals
45625>>>>>>>>>>>>>>>              If ( ;                   (Not(Gplan.Company_Code = SysCurGL.Company_Code)) or;                   (Not(Gplan.Branch_Code  = SysCurGL.Branch_Code )) ;                  ) Send Operation_Not_Allowed 2100
45628>>>>>>>>>>>>>>>        End
45628>>>>>>>>>>>>>>>>
45628>>>>>>>>>>>>>>>
45628>>>>>>>>>>>>>>>        Function_Return iReturnVal
45629>>>>>>>>>>>>>>>    End_Function
45630>>>>>>>>>>>>>>>
45630>>>>>>>>>>>>>>>
45630>>>>>>>>>>>>>>>//    Procedure Update
45630>>>>>>>>>>>>>>>//        Forward Send Update
45630>>>>>>>>>>>>>>>//        // Insert Code Here
45630>>>>>>>>>>>>>>>//        Move Company.Company_Code  to Gplan.Company_Code
45630>>>>>>>>>>>>>>>//        Move Branch.Branch_Code    to Gplan.Branch_Code
45630>>>>>>>>>>>>>>>//        Move Year.Year_Year        to Gplan.Year_Year
45630>>>>>>>>>>>>>>>//        Add 1 to Year.Year_NumGplan //˜¨ Ÿ£æª ¢¦š˜¨ ˜©£é¤ «žª ®¨ã©žª
45630>>>>>>>>>>>>>>>//    End_Procedure   // Update
45630>>>>>>>>>>>>>>>
45630>>>>>>>>>>>>>>>//    Procedure Backout
45630>>>>>>>>>>>>>>>//        Forward Send Backout
45630>>>>>>>>>>>>>>>//        Sub 1 from Year.Year_NumGplan //˜¨ Ÿ£æª ¢¦š˜¨ ˜©£é¤ «žª ®¨ã©žª
45630>>>>>>>>>>>>>>>//    End_Procedure //deleting
45630>>>>>>>>>>>>>>>
45630>>>>>>>>>>>>>>>
45630>>>>>>>>>>>>>>>
45630>>>>>>>>>>>>>>>    // Define_Fields:
45630>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
45630>>>>>>>>>>>>>>>
45630>>>>>>>>>>>>>>>    Procedure Define_Fields
45631>>>>>>>>>>>>>>>        Forward Send Define_Fields
45633>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
45633>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
45633>>>>>>>>>>>>>>>
45633>>>>>>>>>>>>>>>        Set Main_File            To Gplan.File_Number
45634>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
45635>>>>>>>>>>>>>>>
45635>>>>>>>>>>>>>>>
45635>>>>>>>>>>>>>>>        // Child (Client) file structure................
45635>>>>>>>>>>>>>>>        Send Add_Client_File  Gmovea.File_Number
45636>>>>>>>>>>>>>>>        Send Add_Client_File  Gplanmod.File_Number
45637>>>>>>>>>>>>>>>        Send Add_Client_File  Gmhnes.File_Number
45638>>>>>>>>>>>>>>>        Send Add_Client_File  Gvatd.File_Number
45639>>>>>>>>>>>>>>>        Send Add_Client_File  Gpmoves.File_Number
45640>>>>>>>>>>>>>>>
45640>>>>>>>>>>>>>>>        // External (System) file structure.............
45640>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
45641>>>>>>>>>>>>>>>        Send Add_System_File  Syscurgl.File_Number  DD_LOCK_ON_ALL
45642>>>>>>>>>>>>>>>
45642>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gplan_Rec0  To Gplan.Gplan_Rec0
45645>>>>>>>>>>>>>>>
45645>>>>>>>>>>>>>>>        // Field-based properties.......................
45645>>>>>>>>>>>>>>>
45645>>>>>>>>>>>>>>>        // Gplan.Company_Code
45645>>>>>>>>>>>>>>>
45645>>>>>>>>>>>>>>>        // Gplan.Branch_Code
45645>>>>>>>>>>>>>>>
45645>>>>>>>>>>>>>>>        // Gplan.Year_Year
45645>>>>>>>>>>>>>>>
45645>>>>>>>>>>>>>>>        // Gplan.Gplan_Code
45645>>>>>>>>>>>>>>>        Set Field_Exit_msg         Field Gplan.Gplan_Code To get_fiValidateGplanFields
45646>>>>>>>>>>>>>>>        Set Field_Options          Field Gplan.Gplan_Code To DD_AUTOFIND    DD_REQUIRED   
45647>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Code To (sl150(Self))
45648>>>>>>>>>>>>>>>
45648>>>>>>>>>>>>>>>        // Gplan.Gplan_Rec0
45648>>>>>>>>>>>>>>>
45648>>>>>>>>>>>>>>>        // Gplan.Year_Recr
45648>>>>>>>>>>>>>>>
45648>>>>>>>>>>>>>>>        // Gplan.Gplan_Descr1
45648>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Descr1 To (sl150(Self))
45649>>>>>>>>>>>>>>>
45649>>>>>>>>>>>>>>>        // Gplan.Gplan_Descr2
45649>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Descr2 To (sl150(Self))
45650>>>>>>>>>>>>>>>
45650>>>>>>>>>>>>>>>        // Gplan.Gplan_Bathmos
45650>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Bathmos To "Calulated"
45650>>>>>>>>>>>>>>>
45650>>>>>>>>>>>>>>>        // Gplan.Gplan_Anoep
45650>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Anoep To "Calulated"
45650>>>>>>>>>>>>>>>
45650>>>>>>>>>>>>>>>        // Gplan.Gplan_O_Code
45650>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_O_Code To "dbComboFormSub"
45651>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_O_Code To (Gplan_Gplan_O_Code_VT(Self))
45652>>>>>>>>>>>>>>>
45652>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Xfer
45652>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Xfer To "dbComboFormSub"
45653>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Xfer To (Gplan_Gplan_Yn_VT(Self))
45654>>>>>>>>>>>>>>>
45654>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Last
45654>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Last To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1013)"
45654>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Last To "dbComboFormSub"
45655>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Last To (Gplan_Gplan_Yn_VT(Self))
45656>>>>>>>>>>>>>>>
45656>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Kin
45656>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Kin To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1014)"
45656>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Kin To "dbComboFormSub"
45657>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Kin To (Gplan_Gplan_Yn_VT(Self))
45658>>>>>>>>>>>>>>>
45658>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Kk
45658>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Kk To "dbComboFormSub"
45659>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Kk To (Gplan_Gplan_Yn_VT(Self))
45660>>>>>>>>>>>>>>>
45660>>>>>>>>>>>>>>>        // Gplan.Gplan_Xpm
45660>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Xpm To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1015+1016)"
45660>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Xpm To "dbComboFormSub"
45661>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Xpm To (Gplan_Gplan_Xpm_VT(Self))
45662>>>>>>>>>>>>>>>
45662>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Xy
45662>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Xy To "•¨ž© £¦§¦ œå«˜  ©«ž¤ private.trexe «¦¬ Gmove (1017)"
45662>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Xy To "dbComboFormSub"
45663>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Xy To (Gplan_Gplan_Yn_VT(Self))
45664>>>>>>>>>>>>>>>
45664>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Py
45664>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Py To "•¨ž© £¦§¦ œå«˜  ©«ž¤ private.trexe «¦¬ Gmove (1018)"
45664>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Py To "dbComboFormSub"
45665>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Py To (Gplan_Gplan_Yn_VT(Self))
45666>>>>>>>>>>>>>>>
45666>>>>>>>>>>>>>>>        // Gplan.Gplan_Fpaent
45666>>>>>>>>>>>>>>>
45666>>>>>>>>>>>>>>>        // Gplan.Gplan_Fpaent_Yn
45666>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Fpaent_Yn To (Gplan_Gplan_Yn_VT(Self))
45667>>>>>>>>>>>>>>>
45667>>>>>>>>>>>>>>>        // Gplan.Gplan_Afm
45667>>>>>>>>>>>>>>>
45667>>>>>>>>>>>>>>>        // Gplan.Gplan_Addr
45667>>>>>>>>>>>>>>>
45667>>>>>>>>>>>>>>>        // Gplan.Gplan_Tk
45667>>>>>>>>>>>>>>>
45667>>>>>>>>>>>>>>>        // Gplan.Gplan_Poli
45667>>>>>>>>>>>>>>>
45667>>>>>>>>>>>>>>>        // Gplan.Gplan_Doy
45667>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Doy To "dbComboFormSub"
45668>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Doy To (Gplan_Gplan_Doy_VT(Self))
45669>>>>>>>>>>>>>>>
45669>>>>>>>>>>>>>>>        // Gplan.Gplan_J_Code
45669>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_J_Code To "dbComboFormSub"
45670>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_J_Code To (Gplan_Gplan_J_Code_VT(Self))
45671>>>>>>>>>>>>>>>
45671>>>>>>>>>>>>>>>        // Gplan.Gplan_C_Code2
45671>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_C_Code2 To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1019)"
45671>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_C_Code2 To "dbComboFormSub"
45672>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_C_Code2 To (Gplan_Gplan_C_Code2_VT(Self))
45673>>>>>>>>>>>>>>>
45673>>>>>>>>>>>>>>>        // Gplan.Gplan_Tel
45673>>>>>>>>>>>>>>>
45673>>>>>>>>>>>>>>>        // Gplan.Gplan_Email
45673>>>>>>>>>>>>>>>
45673>>>>>>>>>>>>>>>        // Gplan.Gplan_Resp
45673>>>>>>>>>>>>>>>
45673>>>>>>>>>>>>>>>        // Gplan.Gplan_Bitmap
45673>>>>>>>>>>>>>>>
45673>>>>>>>>>>>>>>>        // Gplan.Gplan_Rep_Code
45673>>>>>>>>>>>>>>>
45673>>>>>>>>>>>>>>>        // Gplan.Gplan_Rep_Pct
45673>>>>>>>>>>>>>>>
45673>>>>>>>>>>>>>>>        // Gplan.Gplan_I_Xy_Code
45673>>>>>>>>>>>>>>>
45673>>>>>>>>>>>>>>>        // Gplan.Gplan_I_Py_Code
45673>>>>>>>>>>>>>>>
45673>>>>>>>>>>>>>>>        // Gplan.Gplan_I_Ctypkin
45673>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_I_Ctypkin To (Gtypkin(Self))
45674>>>>>>>>>>>>>>>
45674>>>>>>>>>>>>>>>        // Gplan.Gplan_I_A_Code
45674>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_I_A_Code To "dbComboFormSub"
45675>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_I_A_Code To (Gplan_Gplan_I_A_Code_VT2(Self))
45676>>>>>>>>>>>>>>>
45676>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Myfp
45676>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Myfp To "dbComboFormSub"
45677>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Myfp To (Gplan_Gplan_Yn_VT(Self))
45678>>>>>>>>>>>>>>>
45678>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Myfa
45678>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Myfa To "dbComboFormSub"
45679>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Myfa To (Gplan_Gplan_Yn_VT(Self))
45680>>>>>>>>>>>>>>>
45680>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfnump
45680>>>>>>>>>>>>>>>
45680>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfvalp
45680>>>>>>>>>>>>>>>
45680>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfnuma
45680>>>>>>>>>>>>>>>
45680>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfvala
45680>>>>>>>>>>>>>>>
45680>>>>>>>>>>>>>>>        // Gplan.Gplan_Myf_Sump
45680>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Myf_Sump To "‰˜Ÿ¦¨åœ  œá¤ ¦  ®¨œé©œ ª/§ ©«é©œ ª Ÿ˜ ˜Ÿ¨¦ ©«¦ç¤ ©«ž¤ ‹“”"
45680>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Myf_Sump To "dbComboFormSub"
45681>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Myf_Sump To (Gplan_Gplan_Myf_Sum_VT(Self))
45682>>>>>>>>>>>>>>>
45682>>>>>>>>>>>>>>>        // Gplan.Gplan_Myf_Suma
45682>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Myf_Suma To "dbComboFormSub"
45683>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Myf_Suma To (Gplan_Gplan_Myf_Sum_VT(Self))
45684>>>>>>>>>>>>>>>
45684>>>>>>>>>>>>>>>        // Gplan.Gplan_Sx0
45684>>>>>>>>>>>>>>>
45684>>>>>>>>>>>>>>>        // Gplan.Gplan_Sp0
45684>>>>>>>>>>>>>>>
45684>>>>>>>>>>>>>>>        // Gplan.Gplan_Sx00
45684>>>>>>>>>>>>>>>
45684>>>>>>>>>>>>>>>        // Gplan.Gplan_Sp00
45684>>>>>>>>>>>>>>>
45684>>>>>>>>>>>>>>>        // Gplan.Gplan_Sxr
45684>>>>>>>>>>>>>>>
45684>>>>>>>>>>>>>>>        // Gplan.Gplan_Spr
45684>>>>>>>>>>>>>>>
45684>>>>>>>>>>>>>>>        // Gplan.Gplan_Sx2
45684>>>>>>>>>>>>>>>
45684>>>>>>>>>>>>>>>        // Gplan.Gplan_Sp2
45684>>>>>>>>>>>>>>>
45684>>>>>>>>>>>>>>>        // Gplan.Gplan_Gmhnnorec
45684>>>>>>>>>>>>>>>
45684>>>>>>>>>>>>>>>        // Gplan.Gplan_Recr
45684>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Recr To (sl150(Self))
45685>>>>>>>>>>>>>>>
45685>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
45685>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
45686>>>>>>>>>>>>>>>
45686>>>>>>>>>>>>>>>    // Field_Defaults:
45686>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
45686>>>>>>>>>>>>>>>
45686>>>>>>>>>>>>>>>    Procedure Field_Defaults
45687>>>>>>>>>>>>>>>        Forward Send Field_Defaults
45689>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
45689>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
45689>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Xfer To 0
45690>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Last To 0
45691>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Kin To 1
45692>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Kk To 0
45693>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Xpm To 3
45694>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Xy To 1
45695>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Py To 1
45696>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Fpaent_Yn To 0
45697>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Rep_Pct To 100
45698>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Myfp To 0
45699>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Myfa To 0
45700>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
45700>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
45701>>>>>>>>>>>>>>>End_Class    // Gplan_DataDictionary
45702>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
45702>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>Use sl150.sl         // sl150
45702>>>>>>>>>>>>>>>Use Gtypkin.sl       // Gtypkin
INCLUDING FILE: GTYPKIN.SL
45702>>>>>>>>>>>>>>>>>//AB/ Project gtypkin:Gtypkin
45702>>>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
45702>>>>>>>>>>>>>>>>>//AB/         Set ProjectName to "gtypkin:Gtypkin"
45702>>>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "gtypkin.SL"
45702>>>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>>>// Project Object Structure
45702>>>>>>>>>>>>>>>>>//   gtypkin is a dbModalPanel
45702>>>>>>>>>>>>>>>>>//     Gthhmgio_DD is a DataDictionary
45702>>>>>>>>>>>>>>>>>//     Gtypkin_DD is a DataDictionary
45702>>>>>>>>>>>>>>>>>//     oSelList is a dbList
45702>>>>>>>>>>>>>>>>>//     oOK_bn is a Button
45702>>>>>>>>>>>>>>>>>//     oCancel_bn is a Button
45702>>>>>>>>>>>>>>>>>//     oSearch_bn is a Button
45702>>>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>>>// Register all objects
45702>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_DD
45702>>>>>>>>>>>>>>>>>Register_Object Gtypkin_DD
45702>>>>>>>>>>>>>>>>>Register_Object gtypkin
45702>>>>>>>>>>>>>>>>>Register_Object oCancel_bn
45702>>>>>>>>>>>>>>>>>Register_Object oOK_bn
45702>>>>>>>>>>>>>>>>>Register_Object oSearch_bn
45702>>>>>>>>>>>>>>>>>Register_Object oSelList
45702>>>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>>>    //AB-IgnoreStart
45702>>>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
45702>>>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>>>    Use GTHHMGIO.DD
INCLUDING FILE: GTHHMGIO.DD
45702>>>>>>>>>>>>>>>>>>>//DDB-FileStart
45702>>>>>>>>>>>>>>>>>>>//DDB-HeaderStart
45702>>>>>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>>>>>// File Name : GTHHMGIO.DD
45702>>>>>>>>>>>>>>>>>>>// Class Name: Gthhmgio_DataDictionary
45702>>>>>>>>>>>>>>>>>>>// Revision  : 33
45702>>>>>>>>>>>>>>>>>>>// Version   : 2
45702>>>>>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
45702>>>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
45702>>>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
45702>>>>>>>>>>>>>>>>>>>
45702>>>>>>>>>>>>>>>>>>>Open Gthhmgio
INCLUDING FILE: GTHHMGIO.FD
45704>>>>>>>>>>>>>>>>>>>Open Gtypkin
45706>>>>>>>>>>>>>>>>>>>Open Gthaa
INCLUDING FILE: GTHAA.FD
45708>>>>>>>>>>>>>>>>>>>Open Sysrecg
45710>>>>>>>>>>>>>>>>>>>
45710>>>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
45710>>>>>>>>>>>>>>>>>>>//DDB-ValidationStart
45710>>>>>>>>>>>>>>>>>>>
45710>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_Gthhmgio_Period_VT
45710>>>>>>>>>>>>>>>>>>>
45710>>>>>>>>>>>>>>>>>>>Object Gthhmgio_Gthhmgio_Period_VT  is a CodeValidationTable
45712>>>>>>>>>>>>>>>>>>>    Set Type_Value        To "PERIOD"
45713>>>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
45713>>>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
45713>>>>>>>>>>>>>>>>>>>End_Object   // Gthhmgio_Gthhmgio_Period_VT
45714>>>>>>>>>>>>>>>>>>>//DDB-ValidationEnd
45714>>>>>>>>>>>>>>>>>>>//DDB-SelectionStart
45714>>>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList Gthhmgio  Gthhmgio.SL
45714>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio
45714>>>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
45714>>>>>>>>>>>>>>>>>>>
45714>>>>>>>>>>>>>>>>>>>Class Gthhmgio_DataDictionary  is a DataDictionary_Sec
45715>>>>>>>>>>>>>>>>>>>
45715>>>>>>>>>>>>>>>>>>>
45715>>>>>>>>>>>>>>>>>>>    // Define_Fields:
45715>>>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
45715>>>>>>>>>>>>>>>>>>>
45715>>>>>>>>>>>>>>>>>>>    Procedure Define_Fields
45716>>>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
45718>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
45718>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
45718>>>>>>>>>>>>>>>>>>>
45718>>>>>>>>>>>>>>>>>>>        Set Main_File            To Gthhmgio.File_Number
45719>>>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
45720>>>>>>>>>>>>>>>>>>>
45720>>>>>>>>>>>>>>>>>>>
45720>>>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
45720>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gtypkin.File_Number
45721>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gthaa.File_Number
45722>>>>>>>>>>>>>>>>>>>
45722>>>>>>>>>>>>>>>>>>>        // External (System) file structure.............
45722>>>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
45723>>>>>>>>>>>>>>>>>>>
45723>>>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gthhmgio_Rec0  To Gthhmgio.Gthhmgio_Rec0
45726>>>>>>>>>>>>>>>>>>>
45726>>>>>>>>>>>>>>>>>>>        // Field-based properties.......................
45726>>>>>>>>>>>>>>>>>>>
45726>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Code
45726>>>>>>>>>>>>>>>>>>>        Set Field_Options          Field Gthhmgio.Gthhmgio_Code To DD_AUTOFIND   
45727>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gthhmgio.Gthhmgio_Code To (Gthhmgio(Self))
45728>>>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Gthhmgio.Gthhmgio_Code To TRUE
45729>>>>>>>>>>>>>>>>>>>
45729>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Rec0
45729>>>>>>>>>>>>>>>>>>>
45729>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Descr
45729>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gthhmgio.Gthhmgio_Descr To (Gthhmgio(Self))
45730>>>>>>>>>>>>>>>>>>>
45730>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Period
45730>>>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gthhmgio.Gthhmgio_Period To (Gthhmgio_Gthhmgio_Period_VT(Self))
45731>>>>>>>>>>>>>>>>>>>
45731>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Recr
45731>>>>>>>>>>>>>>>>>>>        Set Field_Options          Field Gthhmgio.Gthhmgio_Recr To DD_AUTOFIND   
45732>>>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Gthhmgio.Gthhmgio_Recr To TRUE
45733>>>>>>>>>>>>>>>>>>>
45733>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
45733>>>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
45734>>>>>>>>>>>>>>>>>>>
45734>>>>>>>>>>>>>>>>>>>    // Field_Defaults:
45734>>>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
45734>>>>>>>>>>>>>>>>>>>
45734>>>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
45735>>>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
45737>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
45737>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
45737>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
45737>>>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
45738>>>>>>>>>>>>>>>>>>>End_Class    // Gthhmgio_DataDictionary
45739>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
45739>>>>>>>>>>>>>>>>>>>
45739>>>>>>>>>>>>>>>>>>>Use Gthhmgio.SL      // Gthhmgio
INCLUDING FILE: GTHHMGIO.SL
45739>>>>>>>>>>>>>>>>>>>>>//AB/ Project Gthhmgio:Gthhmgio
45739>>>>>>>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
45739>>>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectName to "Gthhmgio:Gthhmgio"
45739>>>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "Gthhmgio.SL"
45739>>>>>>>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
45739>>>>>>>>>>>>>>>>>>>>>
45739>>>>>>>>>>>>>>>>>>>>>// Project Object Structure
45739>>>>>>>>>>>>>>>>>>>>>//   Gthhmgio is a dbModalPanel
45739>>>>>>>>>>>>>>>>>>>>>//     Gthhmgio_DD is a DataDictionary
45739>>>>>>>>>>>>>>>>>>>>>//     oSelList is a dbList
45739>>>>>>>>>>>>>>>>>>>>>//     oOK_bn is a Button
45739>>>>>>>>>>>>>>>>>>>>>//     oCancel_bn is a Button
45739>>>>>>>>>>>>>>>>>>>>>//     oSearch_bn is a Button
45739>>>>>>>>>>>>>>>>>>>>>
45739>>>>>>>>>>>>>>>>>>>>>// Register all objects
45739>>>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_DD
45739>>>>>>>>>>>>>>>>>>>>>Register_Object oCancel_bn
45739>>>>>>>>>>>>>>>>>>>>>Register_Object oOK_bn
45739>>>>>>>>>>>>>>>>>>>>>Register_Object oSearch_bn
45739>>>>>>>>>>>>>>>>>>>>>Register_Object oSelList
45739>>>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio
45739>>>>>>>>>>>>>>>>>>>>>
45739>>>>>>>>>>>>>>>>>>>>>
45739>>>>>>>>>>>>>>>>>>>>>    //AB-IgnoreStart
45739>>>>>>>>>>>>>>>>>>>>>
45739>>>>>>>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
45739>>>>>>>>>>>>>>>>>>>>>
45739>>>>>>>>>>>>>>>>>>>>>
45739>>>>>>>>>>>>>>>>>>>>>    Use GTHHMGIO.DD
45739>>>>>>>>>>>>>>>>>>>>>
45739>>>>>>>>>>>>>>>>>>>>>    //AB-IgnoreEnd
45739>>>>>>>>>>>>>>>>>>>>>
45739>>>>>>>>>>>>>>>>>>>>>    CD_Popup_Object Gthhmgio is a dbModalPanel
45758>>>>>>>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
45759>>>>>>>>>>>>>>>>>>>>>        Set Label to "Šå©«˜ †£œ¨¦¢¦šåà¤"
45760>>>>>>>>>>>>>>>>>>>>>        Set Size to 148 297
45761>>>>>>>>>>>>>>>>>>>>>        Set Location to 4 5
45762>>>>>>>>>>>>>>>>>>>>>
45762>>>>>>>>>>>>>>>>>>>>>        //AB-DDOStart
45762>>>>>>>>>>>>>>>>>>>>>
45762>>>>>>>>>>>>>>>>>>>>>        Object Gthhmgio_DD is a Gthhmgio_DataDictionary
45764>>>>>>>>>>>>>>>>>>>>>        End_Object    // Gthhmgio_DD
45765>>>>>>>>>>>>>>>>>>>>>
45765>>>>>>>>>>>>>>>>>>>>>        Set Main_DD to (Gthhmgio_DD(self))
45766>>>>>>>>>>>>>>>>>>>>>        Set Server to (Gthhmgio_DD(self))
45767>>>>>>>>>>>>>>>>>>>>>
45767>>>>>>>>>>>>>>>>>>>>>        //AB-DDOEnd
45767>>>>>>>>>>>>>>>>>>>>>
45767>>>>>>>>>>>>>>>>>>>>>        Object oSelList is a dbList
45769>>>>>>>>>>>>>>>>>>>>>            Set Main_File to Gthhmgio.File_Number
45770>>>>>>>>>>>>>>>>>>>>>            Set Size to 105 280
45771>>>>>>>>>>>>>>>>>>>>>            Set Location to 6 6
45772>>>>>>>>>>>>>>>>>>>>>
45772>>>>>>>>>>>>>>>>>>>>>            Begin_Row
45775>>>>>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_code
45776>>>>>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_descr
45777>>>>>>>>>>>>>>>>>>>>>            End_Row
45782>>>>>>>>>>>>>>>>>>>>>
45782>>>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 52
45783>>>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
45784>>>>>>>>>>>>>>>>>>>>>
45784>>>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 220
45785>>>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
45786>>>>>>>>>>>>>>>>>>>>>
45786>>>>>>>>>>>>>>>>>>>>>        End_Object    // oSelList
45787>>>>>>>>>>>>>>>>>>>>>
45787>>>>>>>>>>>>>>>>>>>>>        Object oOK_bn is a Button
45789>>>>>>>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
45790>>>>>>>>>>>>>>>>>>>>>            Set Location to 111 127
45791>>>>>>>>>>>>>>>>>>>>>
45791>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
45791>>>>>>>>>>>>>>>>>>>>>            Procedure OnClick
45793>>>>>>>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
45794>>>>>>>>>>>>>>>>>>>>>            End_Procedure
45795>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
45795>>>>>>>>>>>>>>>>>>>>>
45795>>>>>>>>>>>>>>>>>>>>>        End_Object    // oOK_bn
45796>>>>>>>>>>>>>>>>>>>>>
45796>>>>>>>>>>>>>>>>>>>>>        Object oCancel_bn is a Button
45798>>>>>>>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
45799>>>>>>>>>>>>>>>>>>>>>            Set Location to 111 181
45800>>>>>>>>>>>>>>>>>>>>>
45800>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
45800>>>>>>>>>>>>>>>>>>>>>            Procedure OnClick
45802>>>>>>>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
45803>>>>>>>>>>>>>>>>>>>>>            End_Procedure
45804>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
45804>>>>>>>>>>>>>>>>>>>>>
45804>>>>>>>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
45805>>>>>>>>>>>>>>>>>>>>>
45805>>>>>>>>>>>>>>>>>>>>>        Object oSearch_bn is a Button
45807>>>>>>>>>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
45808>>>>>>>>>>>>>>>>>>>>>            Set Location to 111 237
45809>>>>>>>>>>>>>>>>>>>>>
45809>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
45809>>>>>>>>>>>>>>>>>>>>>            Procedure OnClick
45811>>>>>>>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
45812>>>>>>>>>>>>>>>>>>>>>            End_Procedure
45813>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
45813>>>>>>>>>>>>>>>>>>>>>
45813>>>>>>>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
45814>>>>>>>>>>>>>>>>>>>>>
45814>>>>>>>>>>>>>>>>>>>>>
45814>>>>>>>>>>>>>>>>>>>>>        //AB-StoreStart
45814>>>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
45815>>>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
45816>>>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
45817>>>>>>>>>>>>>>>>>>>>>        //AB-StoreEnd
45817>>>>>>>>>>>>>>>>>>>>>
45817>>>>>>>>>>>>>>>>>>>>>    CD_End_Object    // Gthhmgio
45819>>>>>>>>>>>>>>>>>>>>>>
45819>>>>>>>>>>>>>>>>>>>>>
45819>>>>>>>>>>>>>>>>>>>>>//AB/     End_Object    // prj
45819>>>>>>>>>>>>>>>>>>>
45819>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
45819>>>>>>>>>>>>>>>>>>>//DDB-FileEnd
45819>>>>>>>>>>>>>>>>>    Use GTYPKIN.DD
INCLUDING FILE: GTYPKIN.DD
45819>>>>>>>>>>>>>>>>>>>//DDB-FileStart
45819>>>>>>>>>>>>>>>>>>>//DDB-HeaderStart
45819>>>>>>>>>>>>>>>>>>>
45819>>>>>>>>>>>>>>>>>>>// File Name : GTYPKIN.DD
45819>>>>>>>>>>>>>>>>>>>// Class Name: Gtypkin_DataDictionary
45819>>>>>>>>>>>>>>>>>>>// Revision  : 45
45819>>>>>>>>>>>>>>>>>>>// Version   : 2
45819>>>>>>>>>>>>>>>>>>>
45819>>>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
45819>>>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
45819>>>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
45819>>>>>>>>>>>>>>>>>>>
45819>>>>>>>>>>>>>>>>>>>Open Gtypkin
45821>>>>>>>>>>>>>>>>>>>Open Garticl
45823>>>>>>>>>>>>>>>>>>>Open Gflagkin
INCLUDING FILE: GFLAGKIN.FD
45825>>>>>>>>>>>>>>>>>>>Open Gparticl
INCLUDING FILE: GPARTICL.FD
45827>>>>>>>>>>>>>>>>>>>Open Gthhmgio
45829>>>>>>>>>>>>>>>>>>>Open Sysrecg
45831>>>>>>>>>>>>>>>>>>>
45831>>>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
45831>>>>>>>>>>>>>>>>>>>//DDB-SelectionStart
45831>>>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList gtypkin  gtypkin.SL
45831>>>>>>>>>>>>>>>>>>>Register_Object gtypkin
45831>>>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
45831>>>>>>>>>>>>>>>>>>>Open SysCurGL
45833>>>>>>>>>>>>>>>>>>>
45833>>>>>>>>>>>>>>>>>>>Class Gtypkin_DataDictionary  is a DataDictionary_Sec
45834>>>>>>>>>>>>>>>>>>>
45834>>>>>>>>>>>>>>>>>>>    Procedure Entry_Order_Date  Integer iField  Date dDate
45835>>>>>>>>>>>>>>>>>>>         // Add a default date if the field is blank
45835>>>>>>>>>>>>>>>>>>>         Integer Changed
45836>>>>>>>>>>>>>>>>>>>         Get Field_Changed_State iField to Changed
45837>>>>>>>>>>>>>>>>>>>         If (Changed=0 AND dDate =0) Begin
45839>>>>>>>>>>>>>>>>>>>             SysDate4 dDate
45840>>>>>>>>>>>>>>>>>>>             Set Field_Default_Value iField to dDate
45841>>>>>>>>>>>>>>>>>>>         End
45841>>>>>>>>>>>>>>>>>>>>
45841>>>>>>>>>>>>>>>>>>>    End_Procedure
45842>>>>>>>>>>>>>>>>>>>
45842>>>>>>>>>>>>>>>>>>>    Procedure Construct_Object
45843>>>>>>>>>>>>>>>>>>>        Forward Send Construct_Object
45845>>>>>>>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
45846>>>>>>>>>>>>>>>>>>>        Property Date    pdDefault_Hmnia    Public 0
45847>>>>>>>>>>>>>>>>>>>        Property Integer piRate             Public 0
45848>>>>>>>>>>>>>>>>>>>        Property Integer piGthhmgio_dd      Public 0
45849>>>>>>>>>>>>>>>>>>>    End_Procedure   // Construct_Object
45850>>>>>>>>>>>>>>>>>>>
45850>>>>>>>>>>>>>>>>>>>//    Procedure OnConstrain
45850>>>>>>>>>>>>>>>>>>>//        Forward Send OnConstrain
45850>>>>>>>>>>>>>>>>>>>//        If (piMustNOTConstrain(Self)) Begin
45850>>>>>>>>>>>>>>>>>>>//        End
45850>>>>>>>>>>>>>>>>>>>//        Else Begin
45850>>>>>>>>>>>>>>>>>>>//            Constrain Gtypkin.Company_Code  eq SysCurGL.Company_Code
45850>>>>>>>>>>>>>>>>>>>//            Constrain Gtypkin.Branch_Code   eq SysCurGL.Branch_Code
45850>>>>>>>>>>>>>>>>>>>//            Constrain Gtypkin.Year_Year     eq SysCurGL.Year_Year
45850>>>>>>>>>>>>>>>>>>>//        End
45850>>>>>>>>>>>>>>>>>>>//    End_Procedure
45850>>>>>>>>>>>>>>>>>>>
45850>>>>>>>>>>>>>>>>>>>    Procedure Update
45851>>>>>>>>>>>>>>>>>>>        Forward Send Update
45853>>>>>>>>>>>>>>>>>>>        // Insert Code Here
45853>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Company_Code  to Gtypkin.Company_Code
45854>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Branch_Code   to Gtypkin.Branch_Code
45855>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Year_Year     to Gtypkin.Year_Year
45856>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Year_Recr     to Gtypkin.Year_Recr
45857>>>>>>>>>>>>>>>>>>>        Move Gthhmgio.Gthhmgio_Code to Gtypkin.Gthhmgio_Code
45858>>>>>>>>>>>>>>>>>>>    End_Procedure   // Update
45859>>>>>>>>>>>>>>>>>>>
45859>>>>>>>>>>>>>>>>>>>    Procedure Creating
45860>>>>>>>>>>>>>>>>>>>        Forward Send Creating
45862>>>>>>>>>>>>>>>>>>>        // Insert Code Here
45862>>>>>>>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gtypkin.Gtypkin_Rec0)))))) to Gtypkin.Gtypkin_Recr
45863>>>>>>>>>>>>>>>>>>>    End_Procedure   // Creating
45864>>>>>>>>>>>>>>>>>>>
45864>>>>>>>>>>>>>>>>>>>
45864>>>>>>>>>>>>>>>>>>>
45864>>>>>>>>>>>>>>>>>>>//----------------------------------------------------------------------------
45864>>>>>>>>>>>>>>>>>>>
45864>>>>>>>>>>>>>>>>>>>//    Procedure Creating
45864>>>>>>>>>>>>>>>>>>>//              Forward Send Creating
45864>>>>>>>>>>>>>>>>>>>//              Add 1 to Year.Year_NumGtypkin //˜¨ Ÿ£æª «ç§à¤ ¡ ¤ã©œà¤ «žª ®¨ã©žª
45864>>>>>>>>>>>>>>>>>>>//    End_Procedure //creating
45864>>>>>>>>>>>>>>>>>>>//    Procedure Deleting
45864>>>>>>>>>>>>>>>>>>>//              Forward Send Deleting
45864>>>>>>>>>>>>>>>>>>>//              Sub 1 from Year.Year_NumGtypkin //˜¨ Ÿ£æª «ç§à¤ ¡ ¤ã©œà¤ «žª ®¨ã©žª
45864>>>>>>>>>>>>>>>>>>>//    End_Procedure //deleting
45864>>>>>>>>>>>>>>>>>>>
45864>>>>>>>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
45865>>>>>>>>>>>>>>>>>>>        Integer iReturnVal
45866>>>>>>>>>>>>>>>>>>>        Forward Get Validate_Save To iReturnVal
45868>>>>>>>>>>>>>>>>>>>//        If (Not(iReturnVal)) Begin
45868>>>>>>>>>>>>>>>>>>>//            //1100:cby = globals
45868>>>>>>>>>>>>>>>>>>>//            If ( ;
45868>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Company_Code = SysCurGL.Company_Code)) or;
45868>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Branch_Code  = SysCurGL.Branch_Code )) or;
45868>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Year_Year    = SysCurGL.Year_Year   ));
45868>>>>>>>>>>>>>>>>>>>//                ) Send Operation_Not_Allowed 1100
45868>>>>>>>>>>>>>>>>>>>//        End
45868>>>>>>>>>>>>>>>>>>>        Function_Return iReturnVal
45869>>>>>>>>>>>>>>>>>>>    End_Function   //validate_save
45870>>>>>>>>>>>>>>>>>>>
45870>>>>>>>>>>>>>>>>>>>
45870>>>>>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
45871>>>>>>>>>>>>>>>>>>>        Integer iReturnVal
45872>>>>>>>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
45874>>>>>>>>>>>>>>>>>>>//        If (Not(iReturnVal)) Begin
45874>>>>>>>>>>>>>>>>>>>//            //2100:cby = globals
45874>>>>>>>>>>>>>>>>>>>//            If ( ;
45874>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Company_Code = SysCurGL.Company_Code)) or;
45874>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Branch_Code  = SysCurGL.Branch_Code )) or;
45874>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Year_Year    = SysCurGL.Year_Year   ));
45874>>>>>>>>>>>>>>>>>>>//                ) Send Operation_Not_Allowed 2100
45874>>>>>>>>>>>>>>>>>>>//        End
45874>>>>>>>>>>>>>>>>>>>        Function_Return iReturnVal
45875>>>>>>>>>>>>>>>>>>>    End_Function   // validate_delete
45876>>>>>>>>>>>>>>>>>>>
45876>>>>>>>>>>>>>>>>>>>
45876>>>>>>>>>>>>>>>>>>>
45876>>>>>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
45877>>>>>>>>>>>>>>>>>>>              Case Begin
45877>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1100)
45879>>>>>>>>>>>>>>>>>>>                        Error 1100 "DDC 151:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
45880>>>>>>>>>>>>>>>>>>>>
45880>>>>>>>>>>>>>>>>>>>                        Case Break
45881>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 2100)
45884>>>>>>>>>>>>>>>>>>>                        Error 2100 "DDC 151:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
45885>>>>>>>>>>>>>>>>>>>>
45885>>>>>>>>>>>>>>>>>>>                        Case Break
45886>>>>>>>>>>>>>>>>>>>                   Case Else
45886>>>>>>>>>>>>>>>>>>>                        Forward Send Operation_Not_Allowed  iError_Num
45888>>>>>>>>>>>>>>>>>>>              Case End
45888>>>>>>>>>>>>>>>>>>>    End_Procedure   //operation_not_allowed
45889>>>>>>>>>>>>>>>>>>>
45889>>>>>>>>>>>>>>>>>>>
45889>>>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
45890>>>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
45892>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
45892>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
45892>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
45892>>>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
45893>>>>>>>>>>>>>>>>>>>
45893>>>>>>>>>>>>>>>>>>>
45893>>>>>>>>>>>>>>>>>>>
45893>>>>>>>>>>>>>>>>>>>    // Define_Fields:
45893>>>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
45893>>>>>>>>>>>>>>>>>>>
45893>>>>>>>>>>>>>>>>>>>    Procedure Define_Fields
45894>>>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
45896>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
45896>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
45896>>>>>>>>>>>>>>>>>>>
45896>>>>>>>>>>>>>>>>>>>        Set Main_File            To Gtypkin.File_Number
45897>>>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
45898>>>>>>>>>>>>>>>>>>>
45898>>>>>>>>>>>>>>>>>>>
45898>>>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
45898>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Garticl.File_Number
45899>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gflagkin.File_Number
45900>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gparticl.File_Number
45901>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
45901>>>>>>>>>>>>>>>>>>>        Send Add_Server_File  Gthhmgio.File_Number
45902>>>>>>>>>>>>>>>>>>>
45902>>>>>>>>>>>>>>>>>>>        // External (System) file structure.............
45902>>>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
45903>>>>>>>>>>>>>>>>>>>
45903>>>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gtypkin_Rec0  To Gtypkin.Gtypkin_Rec0
45906>>>>>>>>>>>>>>>>>>>
45906>>>>>>>>>>>>>>>>>>>        // Field-based properties.......................
45906>>>>>>>>>>>>>>>>>>>
45906>>>>>>>>>>>>>>>>>>>        // Gtypkin.Company_Code
45906>>>>>>>>>>>>>>>>>>>
45906>>>>>>>>>>>>>>>>>>>        // Gtypkin.Branch_Code
45906>>>>>>>>>>>>>>>>>>>
45906>>>>>>>>>>>>>>>>>>>        // Gtypkin.Year_Year
45906>>>>>>>>>>>>>>>>>>>
45906>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Code
45906>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gtypkin.Gtypkin_Code To (gtypkin(Self))
45907>>>>>>>>>>>>>>>>>>>
45907>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Rec0
45907>>>>>>>>>>>>>>>>>>>
45907>>>>>>>>>>>>>>>>>>>        // Gtypkin.Year_Recr
45907>>>>>>>>>>>>>>>>>>>
45907>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gthhmgio_Code
45907>>>>>>>>>>>>>>>>>>>
45907>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gthhmgio_Recr
45907>>>>>>>>>>>>>>>>>>>
45907>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Descr
45907>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gtypkin.Gtypkin_Descr To (gtypkin(Self))
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Anti
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Printer
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Form
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_L_No
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_L_Hmnia
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Seira
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Abr
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag01
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag02
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag03
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag04
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag05
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag06
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag07
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag08
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag09
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag10
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag11
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag12
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag13
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag14
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag15
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag16
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag17
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag18
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag19
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag20
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Recr
45908>>>>>>>>>>>>>>>>>>>
45908>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
45908>>>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
45909>>>>>>>>>>>>>>>>>>>End_Class    // Gtypkin_DataDictionary
45910>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
45910>>>>>>>>>>>>>>>>>>>
45910>>>>>>>>>>>>>>>>>>>Use gtypkin.SL       // gtypkin
45910>>>>>>>>>>>>>>>>>>>
45910>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
45910>>>>>>>>>>>>>>>>>>>//DDB-FileEnd
45910>>>>>>>>>>>>>>>>>    
45910>>>>>>>>>>>>>>>>>    //AB-IgnoreEnd
45910>>>>>>>>>>>>>>>>>
45910>>>>>>>>>>>>>>>>>    CD_Popup_Object gtypkin is a dbModalPanel
45929>>>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
45930>>>>>>>>>>>>>>>>>        Set Label to "Šå©«˜ ‰ ¤ã©œà¤"
45931>>>>>>>>>>>>>>>>>        Set Size to 171 467
45932>>>>>>>>>>>>>>>>>        Set Location to 4 5
45933>>>>>>>>>>>>>>>>>
45933>>>>>>>>>>>>>>>>>        //AB-DDOStart
45933>>>>>>>>>>>>>>>>>
45933>>>>>>>>>>>>>>>>>        Object Gthhmgio_DD is a Gthhmgio_DataDictionary
45935>>>>>>>>>>>>>>>>>        End_Object    // Gthhmgio_DD
45936>>>>>>>>>>>>>>>>>
45936>>>>>>>>>>>>>>>>>        Object Gtypkin_DD is a Gtypkin_DataDictionary
45938>>>>>>>>>>>>>>>>>            Set DDO_Server to (Gthhmgio_DD(self))
45939>>>>>>>>>>>>>>>>>        End_Object    // Gtypkin_DD
45940>>>>>>>>>>>>>>>>>
45940>>>>>>>>>>>>>>>>>        Set Main_DD to (Gtypkin_DD(self))
45941>>>>>>>>>>>>>>>>>        Set Server to (Gtypkin_DD(self))
45942>>>>>>>>>>>>>>>>>
45942>>>>>>>>>>>>>>>>>        //AB-DDOEnd
45942>>>>>>>>>>>>>>>>>
45942>>>>>>>>>>>>>>>>>        Object oSelList is a dbList
45944>>>>>>>>>>>>>>>>>            Set Main_File to Gtypkin.File_Number
45945>>>>>>>>>>>>>>>>>            Set Size to 132 450
45946>>>>>>>>>>>>>>>>>            Set Location to 6 6
45947>>>>>>>>>>>>>>>>>
45947>>>>>>>>>>>>>>>>>            Begin_Row
45950>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_code
45951>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_descr
45952>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_abr
45953>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_seira
45954>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_code
45955>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_descr
45956>>>>>>>>>>>>>>>>>            End_Row
45961>>>>>>>>>>>>>>>>>
45961>>>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 40
45962>>>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
45963>>>>>>>>>>>>>>>>>            
45963>>>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 150
45964>>>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
45965>>>>>>>>>>>>>>>>>            
45965>>>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 68
45966>>>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "‘¬¤«¦£¦š¨˜­å˜"
45967>>>>>>>>>>>>>>>>>            
45967>>>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 30
45968>>>>>>>>>>>>>>>>>            Set Header_Label  item 3 to "‘œ ¨á"
45969>>>>>>>>>>>>>>>>>            
45969>>>>>>>>>>>>>>>>>            Set Form_Width    item 4 to 55
45970>>>>>>>>>>>>>>>>>            Set Header_Label  item 4 to "‰à› ¡æª †£/š ¦¬"
45971>>>>>>>>>>>>>>>>>            
45971>>>>>>>>>>>>>>>>>            Set Form_Width    item 5 to 99
45972>>>>>>>>>>>>>>>>>            Set Header_Label  item 5 to "œ¨ š¨˜­ã †£/šå¦¬"
45973>>>>>>>>>>>>>>>>>            
45973>>>>>>>>>>>>>>>>>        End_Object    // oSelList
45974>>>>>>>>>>>>>>>>>
45974>>>>>>>>>>>>>>>>>        Object oOK_bn is a Button
45976>>>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
45977>>>>>>>>>>>>>>>>>            Set Location to 140 298
45978>>>>>>>>>>>>>>>>>
45978>>>>>>>>>>>>>>>>>            //AB-StoreStart
45978>>>>>>>>>>>>>>>>>            Procedure OnClick
45980>>>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
45981>>>>>>>>>>>>>>>>>            End_Procedure
45982>>>>>>>>>>>>>>>>>            //AB-StoreEnd
45982>>>>>>>>>>>>>>>>>
45982>>>>>>>>>>>>>>>>>        End_Object    // oOK_bn
45983>>>>>>>>>>>>>>>>>
45983>>>>>>>>>>>>>>>>>        Object oCancel_bn is a Button
45985>>>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
45986>>>>>>>>>>>>>>>>>            Set Location to 140 353
45987>>>>>>>>>>>>>>>>>
45987>>>>>>>>>>>>>>>>>            //AB-StoreStart
45987>>>>>>>>>>>>>>>>>            Procedure OnClick
45989>>>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
45990>>>>>>>>>>>>>>>>>            End_Procedure
45991>>>>>>>>>>>>>>>>>            //AB-StoreEnd
45991>>>>>>>>>>>>>>>>>
45991>>>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
45992>>>>>>>>>>>>>>>>>
45992>>>>>>>>>>>>>>>>>        Object oSearch_bn is a Button
45994>>>>>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
45995>>>>>>>>>>>>>>>>>            Set Location to 140 408
45996>>>>>>>>>>>>>>>>>
45996>>>>>>>>>>>>>>>>>            //AB-StoreStart
45996>>>>>>>>>>>>>>>>>            Procedure OnClick
45998>>>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
45999>>>>>>>>>>>>>>>>>            End_Procedure
46000>>>>>>>>>>>>>>>>>            //AB-StoreEnd
46000>>>>>>>>>>>>>>>>>
46000>>>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
46001>>>>>>>>>>>>>>>>>
46001>>>>>>>>>>>>>>>>>
46001>>>>>>>>>>>>>>>>>        //AB-StoreStart
46001>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
46002>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
46003>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
46004>>>>>>>>>>>>>>>>>        //AB-StoreEnd
46004>>>>>>>>>>>>>>>>>
46004>>>>>>>>>>>>>>>>>    CD_End_Object    // gtypkin
46006>>>>>>>>>>>>>>>>>>
46006>>>>>>>>>>>>>>>>>
46006>>>>>>>>>>>>>>>>>//AB/     End_Object    // prj
46006>>>>>>>>>>>>>>>
46006>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
46006>>>>>>>>>>>>>>>//DDB-FileEnd
46006>>>>>>>>>>>>>    
46006>>>>>>>>>>>>>    //AB-IgnoreEnd
46006>>>>>>>>>>>>>
46006>>>>>>>>>>>>>    CD_Popup_Object sl150 is a dbModalPanelSub
46025>>>>>>>>>>>>>
46025>>>>>>>>>>>>>        //AB-StoreTopStart
46025>>>>>>>>>>>>>        Property Integer piFragmaLast -1
46027>>>>>>>>>>>>>        Property String  psFragmaFromCode ""
46029>>>>>>>>>>>>>        Property String  psFragmaToCode ""
46031>>>>>>>>>>>>>        
46031>>>>>>>>>>>>>        //AB-StoreTopEnd
46031>>>>>>>>>>>>>
46031>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
46032>>>>>>>>>>>>>        Set Label to "Šå©«˜ Š¦š˜¨ ˜©£é¤"
46033>>>>>>>>>>>>>        Set Size to 204 393
46034>>>>>>>>>>>>>        Set Location to 5 16
46035>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
46036>>>>>>>>>>>>>        Set Modal_State to FALSE
46037>>>>>>>>>>>>>
46037>>>>>>>>>>>>>        //AB-DDOStart
46037>>>>>>>>>>>>>
46037>>>>>>>>>>>>>        Object Gplan_DD is a Gplan_DataDictionary
46039>>>>>>>>>>>>>
46039>>>>>>>>>>>>>            //AB-StoreStart
46039>>>>>>>>>>>>>                        
46039>>>>>>>>>>>>>            Procedure OnConstrain
46041>>>>>>>>>>>>>                Integer liFragmaLast
46042>>>>>>>>>>>>>                String lsFragmaFromCode lsFragmaToCode
46042>>>>>>>>>>>>>                Get piFragmaLast     to liFragmaLast
46043>>>>>>>>>>>>>                Get psFragmaFromCode to lsFragmaFromCode
46044>>>>>>>>>>>>>                Get psFragmaToCode   to lsFragmaToCode
46045>>>>>>>>>>>>>                If (liFragmaLast <> -1)     Constrain Gplan.Gplan_Yn_Last eq liFragmaLast
46049>>>>>>>>>>>>>                If (lsFragmaFromCode <> "") Constrain Gplan.Gplan_Code    ge lsFragmaFromCode
46053>>>>>>>>>>>>>                If (lsFragmaToCode <> "")   Constrain Gplan.Gplan_Code    le lsFragmaToCode
46057>>>>>>>>>>>>>            End_Procedure // OnConstrain
46058>>>>>>>>>>>>>            
46058>>>>>>>>>>>>>            
46058>>>>>>>>>>>>>            //AB-StoreEnd
46058>>>>>>>>>>>>>
46058>>>>>>>>>>>>>        End_Object    // Gplan_DD
46059>>>>>>>>>>>>>
46059>>>>>>>>>>>>>        Set Main_DD to (Gplan_DD(self))
46060>>>>>>>>>>>>>        Set Server to (Gplan_DD(self))
46061>>>>>>>>>>>>>
46061>>>>>>>>>>>>>        //AB-DDOEnd
46061>>>>>>>>>>>>>
46061>>>>>>>>>>>>>        Object oSelList is a dbListSub
46063>>>>>>>>>>>>>            Set Main_File to Gplan.File_Number
46064>>>>>>>>>>>>>            Set Ordering to 3
46065>>>>>>>>>>>>>            Set Size to 164 378
46066>>>>>>>>>>>>>            Set Location to 4 6
46067>>>>>>>>>>>>>
46067>>>>>>>>>>>>>            Begin_Row
46070>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_code
46071>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_descr1
46072>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_bathmos
46073>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_yn_last
46074>>>>>>>>>>>>>            End_Row
46079>>>>>>>>>>>>>
46079>>>>>>>>>>>>>            Set Form_Width    item 0 to 105
46080>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
46081>>>>>>>>>>>>>            
46081>>>>>>>>>>>>>            Set Form_Width    item 1 to 212
46082>>>>>>>>>>>>>            Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
46083>>>>>>>>>>>>>            
46083>>>>>>>>>>>>>            Set Form_Width    item 2 to 34
46084>>>>>>>>>>>>>            Set Header_Label  item 2 to "˜Ÿ£æª"
46085>>>>>>>>>>>>>            
46085>>>>>>>>>>>>>            Set Form_Width    item 3 to 19
46086>>>>>>>>>>>>>            Set Header_Label  item 3 to " ’"
46087>>>>>>>>>>>>>            Set Column_Checkbox_State  item 3 to True
46088>>>>>>>>>>>>>            
46088>>>>>>>>>>>>>
46088>>>>>>>>>>>>>            //AB-StoreStart
46088>>>>>>>>>>>>>                        
46088>>>>>>>>>>>>>            Property String piStoredFragmaLast -1
46090>>>>>>>>>>>>>            Property String psStoredFragmaFromCode ""
46092>>>>>>>>>>>>>            Property String psStoredFragmaToCode ""
46094>>>>>>>>>>>>>            
46094>>>>>>>>>>>>>            Procedure Store_Defaults
46096>>>>>>>>>>>>>                forward send Store_Defaults
46098>>>>>>>>>>>>>                Set piStoredFragmaLast     to (piFragmaLast(Self))
46099>>>>>>>>>>>>>                Set psStoredFragmaFromCode to (psFragmaFromCode(Self))
46100>>>>>>>>>>>>>                Set psStoredFragmaToCode   to (psFragmaToCode(Self))
46101>>>>>>>>>>>>>            end_Procedure // Store_Defaults
46102>>>>>>>>>>>>>            
46102>>>>>>>>>>>>>            Procedure Restore_Defaults
46104>>>>>>>>>>>>>                forward send Restore_Defaults
46106>>>>>>>>>>>>>                Set piFragmaLast     to (piStoredFragmaLast(self))
46107>>>>>>>>>>>>>                Set psFragmaFromCode to (psStoredFragmaFromCode(self))
46108>>>>>>>>>>>>>                Set psFragmaToCode   to (psStoredFragmaToCode(self))
46109>>>>>>>>>>>>>            end_Procedure // Restore_Defaults
46110>>>>>>>>>>>>>            
46110>>>>>>>>>>>>>            Procedure Activating
46112>>>>>>>>>>>>>                Forward Send Activating
46114>>>>>>>>>>>>>                Send Rebuild_Constraints to (Gplan_DD(self))
46115>>>>>>>>>>>>>            End_Procedure // Activating
46116>>>>>>>>>>>>>            
46116>>>>>>>>>>>>>            
46116>>>>>>>>>>>>>            
46116>>>>>>>>>>>>>            
46116>>>>>>>>>>>>>            //AB-StoreEnd
46116>>>>>>>>>>>>>
46116>>>>>>>>>>>>>        End_Object    // oSelList
46117>>>>>>>>>>>>>
46117>>>>>>>>>>>>>        Object oOK_bn is a Button
46119>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
46120>>>>>>>>>>>>>            Set Location to 170 226
46121>>>>>>>>>>>>>
46121>>>>>>>>>>>>>            //AB-StoreStart
46121>>>>>>>>>>>>>            Procedure OnClick
46123>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
46124>>>>>>>>>>>>>            End_Procedure
46125>>>>>>>>>>>>>            //AB-StoreEnd
46125>>>>>>>>>>>>>
46125>>>>>>>>>>>>>        End_Object    // oOK_bn
46126>>>>>>>>>>>>>
46126>>>>>>>>>>>>>        Object oCancel_bn is a Button
46128>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
46129>>>>>>>>>>>>>            Set Location to 170 279
46130>>>>>>>>>>>>>
46130>>>>>>>>>>>>>            //AB-StoreStart
46130>>>>>>>>>>>>>            Procedure OnClick
46132>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
46133>>>>>>>>>>>>>            End_Procedure
46134>>>>>>>>>>>>>            //AB-StoreEnd
46134>>>>>>>>>>>>>
46134>>>>>>>>>>>>>        End_Object    // oCancel_bn
46135>>>>>>>>>>>>>
46135>>>>>>>>>>>>>        Object oSearch_bn is a Button
46137>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
46138>>>>>>>>>>>>>            Set Location to 170 334
46139>>>>>>>>>>>>>
46139>>>>>>>>>>>>>            //AB-StoreStart
46139>>>>>>>>>>>>>            Procedure OnClick
46141>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
46142>>>>>>>>>>>>>            End_Procedure
46143>>>>>>>>>>>>>            //AB-StoreEnd
46143>>>>>>>>>>>>>
46143>>>>>>>>>>>>>        End_Object    // oSearch_bn
46144>>>>>>>>>>>>>
46144>>>>>>>>>>>>>
46144>>>>>>>>>>>>>        //AB-StoreStart
46144>>>>>>>>>>>>>                
46144>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
46145>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
46146>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
46147>>>>>>>>>>>>>        
46147>>>>>>>>>>>>>        
46147>>>>>>>>>>>>>        
46147>>>>>>>>>>>>>        //AB-StoreEnd
46147>>>>>>>>>>>>>
46147>>>>>>>>>>>>>    CD_End_Object    // sl150
46149>>>>>>>>>>>>>>
46149>>>>>>>>>>>>>
46149>>>>>>>>>>>>>//AB/     End_Object    // prj
46149>>>>>>>>>>>
46149>>>>>>>>>>>//DDB-Selection-pkg-End
46149>>>>>>>>>>>//DDB-FileEnd
46149>>>>>>>>>    Use ITEM.DD
INCLUDING FILE: ITEM.DD
46149>>>>>>>>>>>//DDB-FileStart
46149>>>>>>>>>>>//DDB-HeaderStart
46149>>>>>>>>>>>
46149>>>>>>>>>>>// File Name : ITEM.DD
46149>>>>>>>>>>>// Class Name: Item_DataDictionary
46149>>>>>>>>>>>// Revision  : 63
46149>>>>>>>>>>>// Version   : 2
46149>>>>>>>>>>>
46149>>>>>>>>>>>Use  Windows           // Basic Definitions
46149>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
46149>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46149>>>>>>>>>>>
46149>>>>>>>>>>>Open Item
46151>>>>>>>>>>>Open Witemx
46153>>>>>>>>>>>Open Witemcl
46155>>>>>>>>>>>Open Itemtehn
INCLUDING FILE: ITEMTEHN.FD
46157>>>>>>>>>>>Open Units
46159>>>>>>>>>>>Open Witemkat
46161>>>>>>>>>>>Open Fpa
46163>>>>>>>>>>>Open Sysrecw
46165>>>>>>>>>>>Open Witemx
46167>>>>>>>>>>>
46167>>>>>>>>>>>//DDB-HeaderEnd
46167>>>>>>>>>>>//DDB-ValidationStart
46167>>>>>>>>>>>
46167>>>>>>>>>>>Register_Object Item_Item_Qual_VT
46167>>>>>>>>>>>Register_Object Item_Item_Analysh_VT
46167>>>>>>>>>>>
46167>>>>>>>>>>>Object Item_Item_Qual_VT  is a CodeValidationTable
46169>>>>>>>>>>>    Set Type_Value        To "QUAL"
46170>>>>>>>>>>>    Set Validate_State    To FALSE
46171>>>>>>>>>>>    Set Allow_Blank_State To TRUE
46172>>>>>>>>>>>    //DDB-ValidationCustomStart
46172>>>>>>>>>>>    //DDB-ValidationCustomEnd
46172>>>>>>>>>>>End_Object   // Item_Item_Qual_VT
46173>>>>>>>>>>>
46173>>>>>>>>>>>Object Item_Item_Analysh_VT  is a CodeValidationTable
46175>>>>>>>>>>>    Set Type_Value        To "ITEMANAL"
46176>>>>>>>>>>>    Set Table_Title       To "€¤á¢¬©ž „å›¦¬ª"
46177>>>>>>>>>>>    //DDB-ValidationCustomStart
46177>>>>>>>>>>>    //DDB-ValidationCustomEnd
46177>>>>>>>>>>>End_Object   // Item_Item_Analysh_VT
46178>>>>>>>>>>>//DDB-ValidationEnd
46178>>>>>>>>>>>//DDB-SelectionStart
46178>>>>>>>>>>>//DDB/ ExternalSelectionList SL22s  sl22s.sl
46178>>>>>>>>>>>//DDB/ ExternalSelectionList sl022  sl022.SL
46178>>>>>>>>>>>Register_Object SL22s
46178>>>>>>>>>>>Register_Object sl022
46178>>>>>>>>>>>//DDB-SelectionEnd
46178>>>>>>>>>>>
46178>>>>>>>>>>>Class Item_DataDictionary  is a DataDictionary
46179>>>>>>>>>>>
46179>>>>>>>>>>>    Procedure Update
46180>>>>>>>>>>>        Forward Send Update
46182>>>>>>>>>>>        Move Witemkat.Witemkat_Code to Item.Witemkat_Code
46183>>>>>>>>>>>        Move Units.Units_Code       to Item.Units_Code
46184>>>>>>>>>>>    End_Procedure   // Update
46185>>>>>>>>>>>
46185>>>>>>>>>>>    Procedure Creating
46186>>>>>>>>>>>        Date dHmnia
46187>>>>>>>>>>>        Forward Send Creating
46189>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                         (Trim(String(Item.Item_Rec0)))))) to Item.Item_Recr
46190>>>>>>>>>>>        
46190>>>>>>>>>>>        Clear Branch
46191>>>>>>>>>>>        Move SysCurXR.Company_Code    to Branch.Company_Code
46192>>>>>>>>>>>        Find Gt Branch By Index.1 
46193>>>>>>>>>>>>
46193>>>>>>>>>>>        While ((Found=1) And (Branch.Company_Code=SysCurXR.Company_Code))
46197>>>>>>>>>>>            Clear Witemx
46198>>>>>>>>>>>            Move SysCurXR.Company_Code      to Witemx.Company_Code
46199>>>>>>>>>>>            Move Branch.Branch_Code         to Witemx.Branch_Code
46200>>>>>>>>>>>            Move SysCurXR.Year_Year         to Witemx.Year_Year
46201>>>>>>>>>>>            Move SysCurXR.Year_Year         to Witemx.Witemx_YearDesc
46202>>>>>>>>>>>            Move SysCurXR.Year_Recr         to Witemx.Year_Recr
46203>>>>>>>>>>>            Move Witemkat.Witemkat_Code     to Witemx.Witemkat_Code
46204>>>>>>>>>>>            Move Units.Units_Code           to Witemx.Units_Code
46205>>>>>>>>>>>            Move Item.Item_Code             to Witemx.Item_Code
46206>>>>>>>>>>>            Move Item.Item_Code             to Witemx.Witemx_Code
46207>>>>>>>>>>>            Move Item.Item_Descr            to Witemx.Witemx_Descr
46208>>>>>>>>>>>            Move Item.Wapokat_Code          to Witemx.ITEM_APOKAT_COD
46209>>>>>>>>>>>            Move Item.link1                 to Witemx.link1
46210>>>>>>>>>>>            Move Item.link2                 to Witemx.link2
46211>>>>>>>>>>>            Move Item.Item_Recr             to Witemx.Item_Recr
46212>>>>>>>>>>>            Move (Sysrecw.Witemx_Rec0+1)    to Witemx.Witemx_Rec0
46213>>>>>>>>>>>            Move (Sysrecw.Witemx_Rec0+1)    to Sysrecw.Witemx_Rec0
46214>>>>>>>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                           (Trim(String(Witemx.Witemx_Rec0)))))) ;                                          to Witemx.Witemx_Recr
46215>>>>>>>>>>>            Saverecord Sysrecw
46216>>>>>>>>>>>            Saverecord Witemx
46217>>>>>>>>>>>            
46217>>>>>>>>>>>            Find Gt Branch By Index.1 
46218>>>>>>>>>>>>
46218>>>>>>>>>>>        Loop
46219>>>>>>>>>>>>
46219>>>>>>>>>>>    End_Procedure   // Creating
46220>>>>>>>>>>>
46220>>>>>>>>>>>
46220>>>>>>>>>>>    // Define_Fields:
46220>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
46220>>>>>>>>>>>
46220>>>>>>>>>>>    Procedure Define_Fields
46221>>>>>>>>>>>        Forward Send Define_Fields
46223>>>>>>>>>>>        //DDB-Generated-Code-Location
46223>>>>>>>>>>>        //DDB-DefineFieldStart
46223>>>>>>>>>>>
46223>>>>>>>>>>>        Set Main_File            To Item.File_Number
46224>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
46225>>>>>>>>>>>
46225>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
46226>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
46227>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
46228>>>>>>>>>>>
46228>>>>>>>>>>>        // Child (Client) file structure................
46228>>>>>>>>>>>        Send Add_Client_File  Witemx.File_Number
46229>>>>>>>>>>>        Send Add_Client_File  Witemcl.File_Number
46230>>>>>>>>>>>        Send Add_Client_File  Itemtehn.File_Number
46231>>>>>>>>>>>
46231>>>>>>>>>>>        // Parent (Server) file structure...............
46231>>>>>>>>>>>        Send Add_Server_File  Units.File_Number
46232>>>>>>>>>>>        Send Add_Server_File  Witemkat.File_Number
46233>>>>>>>>>>>        Send Add_Server_File  Fpa.File_Number
46234>>>>>>>>>>>
46234>>>>>>>>>>>        // External (System) file structure.............
46234>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
46235>>>>>>>>>>>        Send Add_System_File  Witemx.File_Number  DD_LOCK_ON_ALL
46236>>>>>>>>>>>
46236>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Item_Rec0  To Item.Item_Rec0
46239>>>>>>>>>>>
46239>>>>>>>>>>>        // Field-based properties.......................
46239>>>>>>>>>>>
46239>>>>>>>>>>>        // Item.Units_Code
46239>>>>>>>>>>>
46239>>>>>>>>>>>        // Item.Units_Recr
46239>>>>>>>>>>>
46239>>>>>>>>>>>        // Item.Witemkat_Code
46239>>>>>>>>>>>
46239>>>>>>>>>>>        // Item.Witemkat_Recr
46239>>>>>>>>>>>
46239>>>>>>>>>>>        // Item.Item_Code
46239>>>>>>>>>>>        Set Field_Options          Field Item.Item_Code To DD_AUTOFIND   
46240>>>>>>>>>>>        Set Field_Prompt_Object    Field Item.Item_Code To (SL22s(Self))
46241>>>>>>>>>>>        Set Key_Field_State        Field Item.Item_Code To TRUE
46242>>>>>>>>>>>
46242>>>>>>>>>>>        // Item.Item_Rec0
46242>>>>>>>>>>>        Set Field_Options          Field Item.Item_Rec0 To DD_AUTOFIND   
46243>>>>>>>>>>>
46243>>>>>>>>>>>        // Item.Item_Descr
46243>>>>>>>>>>>        Set Field_Prompt_Object    Field Item.Item_Descr To (SL22s(Self))
46244>>>>>>>>>>>
46244>>>>>>>>>>>        // Item.Item_Recr
46244>>>>>>>>>>>        Set Field_Options          Field Item.Item_Recr To DD_AUTOFIND   
46245>>>>>>>>>>>
46245>>>>>>>>>>>        // Item.Fpa_Pososto
46245>>>>>>>>>>>        Set Key_Field_State        Field Item.Fpa_Pososto To TRUE
46246>>>>>>>>>>>
46246>>>>>>>>>>>        // Item.Item_Qual
46246>>>>>>>>>>>        Set Field_Value_Table      Field Item.Item_Qual To (Item_Item_Qual_VT(Self))
46247>>>>>>>>>>>
46247>>>>>>>>>>>        // Item.Wapokat_Code
46247>>>>>>>>>>>        Set Field_Prompt_Object    Field Item.Wapokat_Code To (sl022(Self))
46248>>>>>>>>>>>
46248>>>>>>>>>>>        // Item.Item_Analysh
46248>>>>>>>>>>>        Set Field_Class_Name       Field Item.Item_Analysh To "dbComboFormsub"
46249>>>>>>>>>>>        Set Field_Value_Table      Field Item.Item_Analysh To (Item_Item_Analysh_VT(Self))
46250>>>>>>>>>>>
46250>>>>>>>>>>>        // Item.Item_Orio
46250>>>>>>>>>>>
46250>>>>>>>>>>>        // Item.Codeglpol
46250>>>>>>>>>>>
46250>>>>>>>>>>>        // Item.Codeglago
46250>>>>>>>>>>>
46250>>>>>>>>>>>        // Item.Link1
46250>>>>>>>>>>>
46250>>>>>>>>>>>        // Item.Link2
46250>>>>>>>>>>>
46250>>>>>>>>>>>        // Item.Group
46250>>>>>>>>>>>
46250>>>>>>>>>>>        // Item.Sap
46250>>>>>>>>>>>
46250>>>>>>>>>>>        //DDB-DefineFieldEnd
46250>>>>>>>>>>>    End_Procedure    // Define_Fields
46251>>>>>>>>>>>
46251>>>>>>>>>>>    // Field_Defaults:
46251>>>>>>>>>>>    // This procedure is used to establish default field values.
46251>>>>>>>>>>>
46251>>>>>>>>>>>    Procedure Field_Defaults
46252>>>>>>>>>>>        Forward Send Field_Defaults
46254>>>>>>>>>>>        //DDB-Generated-Code-Location
46254>>>>>>>>>>>        //DDB-FieldDefaultStart
46254>>>>>>>>>>>        Set Field_Changed_Value   Field Item.Item_Analysh To "0"
46255>>>>>>>>>>>        //DDB-FieldDefaultEnd
46255>>>>>>>>>>>    End_Procedure    // Field_Defaults
46256>>>>>>>>>>>
46256>>>>>>>>>>>End_Class    // Item_DataDictionary
46257>>>>>>>>>>>//DDB-Selection-pkg-Start
46257>>>>>>>>>>>
46257>>>>>>>>>>>Use sl22s.sl         // SL22s
INCLUDING FILE: SL22S.SL
46257>>>>>>>>>>>>>//AB/ Project SL22s:ITEM
46257>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
46257>>>>>>>>>>>>>//AB/         Set ProjectName to "SL22s:ITEM"
46257>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl22s.sl"
46257>>>>>>>>>>>>>
46257>>>>>>>>>>>>>// Project Object Structure
46257>>>>>>>>>>>>>//   SL22s is a dbModalPanel
46257>>>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
46257>>>>>>>>>>>>>//     Units_DD is a DataDictionary
46257>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
46257>>>>>>>>>>>>>//     Item_DD is a DataDictionary
46257>>>>>>>>>>>>>//     oSelList is a dbListSub
46257>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
46257>>>>>>>>>>>>>//     ocode is a FormSub
46257>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
46257>>>>>>>>>>>>>//     operi is a FormSub
46257>>>>>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
46257>>>>>>>>>>>>>//       Radio1 is a RadioSub
46257>>>>>>>>>>>>>//       Radio2 is a RadioSub
46257>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
46257>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
46257>>>>>>>>>>>>>//     ocodekat is a FormSub
46257>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
46257>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
46257>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
46257>>>>>>>>>>>>>
46257>>>>>>>>>>>>>// Register all objects
46257>>>>>>>>>>>>>Register_Object ButtonSub1
46257>>>>>>>>>>>>>Register_Object Fpa_DD
46257>>>>>>>>>>>>>Register_Object Item_DD
46257>>>>>>>>>>>>>Register_Object oCancel_bn
46257>>>>>>>>>>>>>Register_Object ocode
46257>>>>>>>>>>>>>Register_Object ocodekat
46257>>>>>>>>>>>>>Register_Object oOK_bn
46257>>>>>>>>>>>>>Register_Object operi
46257>>>>>>>>>>>>>Register_Object oSearch_bn
46257>>>>>>>>>>>>>Register_Object oSelList
46257>>>>>>>>>>>>>Register_Object Radio1
46257>>>>>>>>>>>>>Register_Object Radio2
46257>>>>>>>>>>>>>Register_Object RadioGroupSub1
46257>>>>>>>>>>>>>Register_Object SL22s
46257>>>>>>>>>>>>>Register_Object TextBoxSub1
46257>>>>>>>>>>>>>Register_Object TextBoxSub2
46257>>>>>>>>>>>>>Register_Object TextBoxSub3
46257>>>>>>>>>>>>>Register_Object Units_DD
46257>>>>>>>>>>>>>Register_Object Witemkat_DD
46257>>>>>>>>>>>>>
46257>>>>>>>>>>>>>
46257>>>>>>>>>>>>>
46257>>>>>>>>>>>>>    //AB-StoreTopStart
46257>>>>>>>>>>>>>                                
46257>>>>>>>>>>>>>                                
46257>>>>>>>>>>>>>    //AB-StoreTopEnd
46257>>>>>>>>>>>>>
46257>>>>>>>>>>>>>    //AB-IgnoreStart
46257>>>>>>>>>>>>>
46257>>>>>>>>>>>>>    Use DFAllEnt.pkg
46257>>>>>>>>>>>>>    Use dbList.Sub
46257>>>>>>>>>>>>>    Use Txtbox.Sub
46257>>>>>>>>>>>>>    Use Form.Sub
46257>>>>>>>>>>>>>    Use Rgroup.Sub
46257>>>>>>>>>>>>>    Use Radio.Sub
46257>>>>>>>>>>>>>    Use Button.Sub
46257>>>>>>>>>>>>>
46257>>>>>>>>>>>>>
46257>>>>>>>>>>>>>    Use WITEMKAT.DD
46257>>>>>>>>>>>>>    Use UNITS.DD
46257>>>>>>>>>>>>>    Use FPA.DD
46257>>>>>>>>>>>>>    Use ITEM.DD
46257>>>>>>>>>>>>>    
46257>>>>>>>>>>>>>    //AB-IgnoreEnd
46257>>>>>>>>>>>>>
46257>>>>>>>>>>>>>    CD_Popup_Object SL22s is a dbModalPanel
46276>>>>>>>>>>>>>
46276>>>>>>>>>>>>>        //AB-StoreTopStart
46276>>>>>>>>>>>>>        Property String     pscode                  ''
46278>>>>>>>>>>>>>        Property String     psperi                  ''
46280>>>>>>>>>>>>>        Property Integer    piContains_Or_Starts     0
46282>>>>>>>>>>>>>        Property String     pscodekat               ''
46284>>>>>>>>>>>>>        
46284>>>>>>>>>>>>>        //AB-StoreTopEnd
46284>>>>>>>>>>>>>
46284>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
46285>>>>>>>>>>>>>        Set Label to "€¨®œå¦ „ ›é¤"
46286>>>>>>>>>>>>>        Set Size to 270 484
46287>>>>>>>>>>>>>        Set Location to 5 7
46288>>>>>>>>>>>>>
46288>>>>>>>>>>>>>        //AB-DDOStart
46288>>>>>>>>>>>>>
46288>>>>>>>>>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
46290>>>>>>>>>>>>>        End_Object    // Witemkat_DD
46291>>>>>>>>>>>>>
46291>>>>>>>>>>>>>        Object Units_DD is a Units_DataDictionary
46293>>>>>>>>>>>>>        End_Object    // Units_DD
46294>>>>>>>>>>>>>
46294>>>>>>>>>>>>>        Object Fpa_DD is a Fpa_DataDictionary
46296>>>>>>>>>>>>>        End_Object    // Fpa_DD
46297>>>>>>>>>>>>>
46297>>>>>>>>>>>>>        Object Item_DD is a Item_DataDictionary
46299>>>>>>>>>>>>>
46299>>>>>>>>>>>>>            //AB-StoreTopStart
46299>>>>>>>>>>>>>            Function fiPeriexei Returns Integer
46301>>>>>>>>>>>>>                       String lsperi lscode  lscodekat
46302>>>>>>>>>>>>>                       Integer rVal liContains_Or_Starts
46302>>>>>>>>>>>>>                       Move 0 to rVal
46303>>>>>>>>>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
46304>>>>>>>>>>>>>                       Get psperi to lsperi
46305>>>>>>>>>>>>>                       Get pscode to lscode
46306>>>>>>>>>>>>>                       Get pscodekat to lscodekat
46307>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
46308>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
46309>>>>>>>>>>>>>                  //     Move (Trim(lscodekat)) to lscodekat
46309>>>>>>>>>>>>>                       If (liContains_Or_Starts=0) Begin
46311>>>>>>>>>>>>>                           If ((Trim(item.item_descr)) Contains lsperi) Begin
46313>>>>>>>>>>>>>                               If ((Trim(item.item_code)) Contains lscode) Move 1 to rVal
46316>>>>>>>>>>>>>                           End
46316>>>>>>>>>>>>>>
46316>>>>>>>>>>>>>            
46316>>>>>>>>>>>>>                       End
46316>>>>>>>>>>>>>>
46316>>>>>>>>>>>>>                       Else Begin
46317>>>>>>>>>>>>>                           If (Left(item.item_descr,(Length(lsperi)))=lsperi) Begin
46319>>>>>>>>>>>>>                               If (Left(item.item_code,(Length(lscode)))=lscode) Move 1 to rVal
46322>>>>>>>>>>>>>                           End
46322>>>>>>>>>>>>>>
46322>>>>>>>>>>>>>            
46322>>>>>>>>>>>>>                       End
46322>>>>>>>>>>>>>>
46322>>>>>>>>>>>>>                       Function_Return rVal
46323>>>>>>>>>>>>>                   End_Function
46324>>>>>>>>>>>>>            
46324>>>>>>>>>>>>>                   Function fiArxizeiperi Returns Integer
46326>>>>>>>>>>>>>                       String lsperi
46327>>>>>>>>>>>>>                       Get psperi to lsperi
46328>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
46329>>>>>>>>>>>>>                       Function_Return (Left(item.item_descr,(Length(lsperi)))=lsperi)
46330>>>>>>>>>>>>>                   End_Function
46331>>>>>>>>>>>>>            
46331>>>>>>>>>>>>>                   Function fiArxizeicode Returns Integer
46333>>>>>>>>>>>>>                       String lscode lscodekat
46334>>>>>>>>>>>>>                       Get pscode to lscode
46335>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
46336>>>>>>>>>>>>>                       Function_Return (Left(item.item_code,(Length(lscode)))=lscode)
46337>>>>>>>>>>>>>                   End_Function
46338>>>>>>>>>>>>>            
46338>>>>>>>>>>>>>            //AB-StoreTopEnd
46338>>>>>>>>>>>>>
46338>>>>>>>>>>>>>            Set DDO_Server to (Units_DD(self))
46339>>>>>>>>>>>>>            Set DDO_Server to (Witemkat_DD(self))
46340>>>>>>>>>>>>>            Set DDO_Server to (Fpa_DD(self))
46341>>>>>>>>>>>>>
46341>>>>>>>>>>>>>            //AB-StoreStart
46341>>>>>>>>>>>>>                                                                                                
46341>>>>>>>>>>>>>                                                                                                
46341>>>>>>>>>>>>>                                                                                                
46341>>>>>>>>>>>>>            Begin_Constraints
46343>>>>>>>>>>>>>               String lsperi lscode lsvalue lstype lscodekat
46344>>>>>>>>>>>>>               Integer liContains_Or_Starts
46344>>>>>>>>>>>>>             //  Get FragmaItem  to lsValue
46344>>>>>>>>>>>>>            
46344>>>>>>>>>>>>>                   Get psperi  to lsperi
46345>>>>>>>>>>>>>                   Get pscode  to lscode
46346>>>>>>>>>>>>>                   Get pscodekat  to lscodekat
46347>>>>>>>>>>>>>                   Get piContains_Or_Starts to liContains_Or_Starts
46348>>>>>>>>>>>>>                   Move (Trim(lsperi)) to lsperi
46349>>>>>>>>>>>>>                   Move (Trim(lscode)) to lscode
46350>>>>>>>>>>>>>                   Move (Trim(lscodekat)) to lscodekat
46351>>>>>>>>>>>>>                   If ((lsperi<>'') and (lscode<>'')) begin
46353>>>>>>>>>>>>>                        set ordering to 5
46354>>>>>>>>>>>>>                        Constrain item as (fiPeriexei(Self)=1)
46355>>>>>>>>>>>>>                   end
46355>>>>>>>>>>>>>>
46355>>>>>>>>>>>>>                   Else Begin
46356>>>>>>>>>>>>>                      If (liContains_Or_Starts=0) Begin
46358>>>>>>>>>>>>>                        If (lsperi<>'') begin
46360>>>>>>>>>>>>>                            set ordering to 3
46361>>>>>>>>>>>>>                            Constrain item.item_descr Contains lsperi
46363>>>>>>>>>>>>>                        end
46363>>>>>>>>>>>>>>
46363>>>>>>>>>>>>>                        Else If (lscode<>'') begin
46366>>>>>>>>>>>>>                            set ordering to 5
46367>>>>>>>>>>>>>                            Constrain item.item_code Contains lscode
46369>>>>>>>>>>>>>                        end
46369>>>>>>>>>>>>>>
46369>>>>>>>>>>>>>                      End
46369>>>>>>>>>>>>>>
46369>>>>>>>>>>>>>                      Else Begin
46370>>>>>>>>>>>>>                           If (lsperi<>'') begin
46372>>>>>>>>>>>>>                                set ordering to 3
46373>>>>>>>>>>>>>                                Constrain item as (fiArxizeiperi(Self)=1) //item.item_descr
46374>>>>>>>>>>>>>                           end
46374>>>>>>>>>>>>>>
46374>>>>>>>>>>>>>                           Else If (lscode<>'') begin
46377>>>>>>>>>>>>>                                set ordering to 5
46378>>>>>>>>>>>>>                                Constrain item as (fiArxizeicode(Self)=1) //item.item_code
46379>>>>>>>>>>>>>                           end
46379>>>>>>>>>>>>>>
46379>>>>>>>>>>>>>                      End
46379>>>>>>>>>>>>>>
46379>>>>>>>>>>>>>                   End
46379>>>>>>>>>>>>>>
46379>>>>>>>>>>>>>                   If (lscodekat<>'') Constrain item.witemkat_code Contains lscodekat
46383>>>>>>>>>>>>>            
46383>>>>>>>>>>>>>            End_Constraints
46386>>>>>>>>>>>>>            
46386>>>>>>>>>>>>>            
46386>>>>>>>>>>>>>            
46386>>>>>>>>>>>>>            
46386>>>>>>>>>>>>>            //AB-StoreEnd
46386>>>>>>>>>>>>>
46386>>>>>>>>>>>>>        End_Object    // Item_DD
46387>>>>>>>>>>>>>
46387>>>>>>>>>>>>>        Set Main_DD to (Item_DD(self))
46388>>>>>>>>>>>>>        Set Server to (Item_DD(self))
46389>>>>>>>>>>>>>
46389>>>>>>>>>>>>>        //AB-DDOEnd
46389>>>>>>>>>>>>>
46389>>>>>>>>>>>>>        Object oSelList is a dbListSub
46391>>>>>>>>>>>>>            Set Main_File to Item.File_Number
46392>>>>>>>>>>>>>            Set Ordering to 5
46393>>>>>>>>>>>>>            Set Size to 190 475
46394>>>>>>>>>>>>>            Set Location to -1 2
46395>>>>>>>>>>>>>            Set Color to 14280447
46396>>>>>>>>>>>>>            Set CurrentRowColor to 11783679
46397>>>>>>>>>>>>>            Set CurrentCellColor to 11783679
46398>>>>>>>>>>>>>            Set Auto_Index_State to FALSE
46399>>>>>>>>>>>>>
46399>>>>>>>>>>>>>            Begin_Row
46402>>>>>>>>>>>>>                Entry_Item Item.Item_code
46403>>>>>>>>>>>>>                Entry_Item Item.Item_descr
46404>>>>>>>>>>>>>                Entry_Item Item.Witemkat_code
46405>>>>>>>>>>>>>                Entry_Item Witemkat.Witemkat_descr
46406>>>>>>>>>>>>>                Entry_Item Item.Item_qual
46407>>>>>>>>>>>>>                Entry_Item Fpa.Fpa_pososto
46408>>>>>>>>>>>>>            End_Row
46413>>>>>>>>>>>>>
46413>>>>>>>>>>>>>            Set Form_Width    item 0 to 60
46414>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à›. „å›¦¬ª"
46415>>>>>>>>>>>>>            
46415>>>>>>>>>>>>>            Set Form_Width    item 1 to 140
46416>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
46417>>>>>>>>>>>>>            
46417>>>>>>>>>>>>>            Set Form_Width    item 2 to 70
46418>>>>>>>>>>>>>            Set Header_Label  item 2 to "‰à›. ‰˜«žš¦¨å˜ª"
46419>>>>>>>>>>>>>            
46419>>>>>>>>>>>>>            Set Form_Width    item 3 to 88
46420>>>>>>>>>>>>>            Set Header_Label  item 3 to "œ¨ š¨˜­ã ‰˜«žš."
46421>>>>>>>>>>>>>            
46421>>>>>>>>>>>>>            Set Form_Width    item 4 to 64
46422>>>>>>>>>>>>>            Set Header_Label  item 4 to "¦ æ«ž«˜"
46423>>>>>>>>>>>>>            
46423>>>>>>>>>>>>>            Set Form_Width    item 5 to 45
46424>>>>>>>>>>>>>            Set Header_Label  item 5 to "‰˜«.”..€"
46425>>>>>>>>>>>>>            
46425>>>>>>>>>>>>>
46425>>>>>>>>>>>>>            //AB-StoreStart
46425>>>>>>>>>>>>>            
46425>>>>>>>>>>>>>            Property String Store_Fragma_Items public ""
46427>>>>>>>>>>>>>            
46427>>>>>>>>>>>>>            set export_item_state to true
46428>>>>>>>>>>>>>            
46428>>>>>>>>>>>>>            Procedure Activating
46430>>>>>>>>>>>>>               Forward send Activating
46432>>>>>>>>>>>>>               Send Rebuild_Constraints to (Item_DD(Self))
46433>>>>>>>>>>>>>            End_Procedure
46434>>>>>>>>>>>>>            
46434>>>>>>>>>>>>>            Function Child_Exiting Integer iWhere Returns Integer
46436>>>>>>>>>>>>>                local integer Rval
46437>>>>>>>>>>>>>                Forward get Child_Exiting iWhere  to Rval
46439>>>>>>>>>>>>>                set value of (ocode   (self))   to ''
46440>>>>>>>>>>>>>                set value of (operi   (self))   to ''
46441>>>>>>>>>>>>>                set value of (ocodekat(self))   to ''
46442>>>>>>>>>>>>>                set psperi                      to ''
46443>>>>>>>>>>>>>                set pscode                      to ''
46444>>>>>>>>>>>>>                set pscodekat                   to ''
46445>>>>>>>>>>>>>                function_return Rval // if non-zero do not enter
46446>>>>>>>>>>>>>            End_function
46447>>>>>>>>>>>>>            
46447>>>>>>>>>>>>>            
46447>>>>>>>>>>>>>            
46447>>>>>>>>>>>>>            
46447>>>>>>>>>>>>>            
46447>>>>>>>>>>>>>            
46447>>>>>>>>>>>>>            
46447>>>>>>>>>>>>>            
46447>>>>>>>>>>>>>            
46447>>>>>>>>>>>>>            
46447>>>>>>>>>>>>>            
46447>>>>>>>>>>>>>            
46447>>>>>>>>>>>>>            
46447>>>>>>>>>>>>>            
46447>>>>>>>>>>>>>            
46447>>>>>>>>>>>>>            
46447>>>>>>>>>>>>>            
46447>>>>>>>>>>>>>            
46447>>>>>>>>>>>>>            
46447>>>>>>>>>>>>>            
46447>>>>>>>>>>>>>            //AB-StoreEnd
46447>>>>>>>>>>>>>
46447>>>>>>>>>>>>>        End_Object    // oSelList
46448>>>>>>>>>>>>>
46448>>>>>>>>>>>>>        Object TextBoxSub1 is a TextBoxSub
46450>>>>>>>>>>>>>            Set Label to "‘á¨à©ž ‰à› ¡¦ç ‚ á"
46451>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
46452>>>>>>>>>>>>>            Set Location to 192 6
46453>>>>>>>>>>>>>            Set Size to 13 78
46454>>>>>>>>>>>>>        End_Object    // TextBoxSub1
46455>>>>>>>>>>>>>
46455>>>>>>>>>>>>>        Object ocode is a FormSub
46457>>>>>>>>>>>>>            Set Size to 13 197
46458>>>>>>>>>>>>>            Set Location to 192 79
46459>>>>>>>>>>>>>            Set Label_Col_Offset to 2
46460>>>>>>>>>>>>>
46460>>>>>>>>>>>>>            //AB-StoreStart
46460>>>>>>>>>>>>>                                                
46460>>>>>>>>>>>>>            Procedure OnKILLFOCUS
46462>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
46463>>>>>>>>>>>>>            End_Procedure
46464>>>>>>>>>>>>>            
46464>>>>>>>>>>>>>            
46464>>>>>>>>>>>>>            
46464>>>>>>>>>>>>>            
46464>>>>>>>>>>>>>            //AB-StoreEnd
46464>>>>>>>>>>>>>
46464>>>>>>>>>>>>>        End_Object    // ocode
46465>>>>>>>>>>>>>
46465>>>>>>>>>>>>>        Object TextBoxSub2 is a TextBoxSub
46467>>>>>>>>>>>>>            Set Label to "‘á¨à©ž œ¨ š¨˜­ãª "
46468>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
46469>>>>>>>>>>>>>            Set Location to 207 6
46470>>>>>>>>>>>>>            Set Size to 13 83
46471>>>>>>>>>>>>>        End_Object    // TextBoxSub2
46472>>>>>>>>>>>>>
46472>>>>>>>>>>>>>        Object operi is a FormSub
46474>>>>>>>>>>>>>            Set Size to 13 197
46475>>>>>>>>>>>>>            Set Location to 207 79
46476>>>>>>>>>>>>>            Set Label_Col_Offset to 2
46477>>>>>>>>>>>>>
46477>>>>>>>>>>>>>            //AB-StoreStart
46477>>>>>>>>>>>>>                                                
46477>>>>>>>>>>>>>            Procedure OnKILLFOCUS
46479>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
46480>>>>>>>>>>>>>            End_Procedure
46481>>>>>>>>>>>>>            
46481>>>>>>>>>>>>>            
46481>>>>>>>>>>>>>            
46481>>>>>>>>>>>>>            
46481>>>>>>>>>>>>>            //AB-StoreEnd
46481>>>>>>>>>>>>>
46481>>>>>>>>>>>>>        End_Object    // operi
46482>>>>>>>>>>>>>
46482>>>>>>>>>>>>>        Object RadioGroupSub1 is a RadioGroupSub
46484>>>>>>>>>>>>>            Set Size to 32 77
46485>>>>>>>>>>>>>            Set Location to 193 277
46486>>>>>>>>>>>>>            Object Radio1 is a RadioSub
46488>>>>>>>>>>>>>                Set Label to "œ¨ â®œ«˜ "
46489>>>>>>>>>>>>>                Set Size to 10 53
46490>>>>>>>>>>>>>                Set Location to 7 5
46491>>>>>>>>>>>>>            End_Object    // Radio1
46492>>>>>>>>>>>>>
46492>>>>>>>>>>>>>            Object Radio2 is a RadioSub
46494>>>>>>>>>>>>>                Set Label to "€¨®åœ  €§æ"
46495>>>>>>>>>>>>>                Set Size to 10 51
46496>>>>>>>>>>>>>                Set Location to 21 5
46497>>>>>>>>>>>>>            End_Object    // Radio2
46498>>>>>>>>>>>>>
46498>>>>>>>>>>>>>
46498>>>>>>>>>>>>>            //AB-StoreStart
46498>>>>>>>>>>>>>                                                
46498>>>>>>>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
46500>>>>>>>>>>>>>                Set piContains_Or_Starts to iToItem
46501>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
46502>>>>>>>>>>>>>            End_Procedure
46503>>>>>>>>>>>>>            
46503>>>>>>>>>>>>>            
46503>>>>>>>>>>>>>            
46503>>>>>>>>>>>>>            
46503>>>>>>>>>>>>>            //AB-StoreEnd
46503>>>>>>>>>>>>>
46503>>>>>>>>>>>>>        End_Object    // RadioGroupSub1
46504>>>>>>>>>>>>>
46504>>>>>>>>>>>>>        Object ButtonSub1 is a ButtonSub
46506>>>>>>>>>>>>>            Set Label to "Search"
46507>>>>>>>>>>>>>            Set Size to 28 37
46508>>>>>>>>>>>>>            Set Location to 198 357
46509>>>>>>>>>>>>>            Set Form_FontWeight Item 0 to 800
46510>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
46511>>>>>>>>>>>>>
46511>>>>>>>>>>>>>            //AB-StoreStart
46511>>>>>>>>>>>>>                                                                                                
46511>>>>>>>>>>>>>            Set Visible_State to False
46512>>>>>>>>>>>>>            
46512>>>>>>>>>>>>>            Procedure OnClick
46514>>>>>>>>>>>>>                Forward Send OnClick
46516>>>>>>>>>>>>>                Set pscode  to (Value(ocode(Self),0))
46517>>>>>>>>>>>>>                Set psperi  to (Value(operi(Self),0))
46518>>>>>>>>>>>>>                Set pscodekat  to (Value(ocodekat(Self),0))
46519>>>>>>>>>>>>>                send Rebuild_Constraints    to (item_DD(Self))
46520>>>>>>>>>>>>>                Send Beginning_Of_Data      to oSelList True
46521>>>>>>>>>>>>>            End_Procedure // OnClick
46522>>>>>>>>>>>>>            
46522>>>>>>>>>>>>>            
46522>>>>>>>>>>>>>            
46522>>>>>>>>>>>>>            
46522>>>>>>>>>>>>>            
46522>>>>>>>>>>>>>            
46522>>>>>>>>>>>>>            
46522>>>>>>>>>>>>>            
46522>>>>>>>>>>>>>            
46522>>>>>>>>>>>>>            
46522>>>>>>>>>>>>>            
46522>>>>>>>>>>>>>            
46522>>>>>>>>>>>>>            
46522>>>>>>>>>>>>>            //AB-StoreEnd
46522>>>>>>>>>>>>>
46522>>>>>>>>>>>>>        End_Object    // ButtonSub1
46523>>>>>>>>>>>>>
46523>>>>>>>>>>>>>        Object TextBoxSub3 is a TextBoxSub
46525>>>>>>>>>>>>>            Set Label to "‰à›.‰˜«žš¦¨å˜ª ‚ á"
46526>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
46527>>>>>>>>>>>>>            Set Location to 221 5
46528>>>>>>>>>>>>>            Set Size to 13 78
46529>>>>>>>>>>>>>        End_Object    // TextBoxSub3
46530>>>>>>>>>>>>>
46530>>>>>>>>>>>>>        Object ocodekat is a FormSub
46532>>>>>>>>>>>>>            Set Size to 13 197
46533>>>>>>>>>>>>>            Set Location to 221 78
46534>>>>>>>>>>>>>            Set Label_Col_Offset to 2
46535>>>>>>>>>>>>>
46535>>>>>>>>>>>>>            //AB-StoreStart
46535>>>>>>>>>>>>>                                                
46535>>>>>>>>>>>>>            Procedure OnKILLFOCUS
46537>>>>>>>>>>>>>               Send KeyAction to ButtonSub1
46538>>>>>>>>>>>>>            End_Procedure
46539>>>>>>>>>>>>>            
46539>>>>>>>>>>>>>            
46539>>>>>>>>>>>>>            
46539>>>>>>>>>>>>>            //AB-StoreEnd
46539>>>>>>>>>>>>>
46539>>>>>>>>>>>>>        End_Object    // ocodekat
46540>>>>>>>>>>>>>
46540>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
46542>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
46543>>>>>>>>>>>>>            Set Location to 237 316
46544>>>>>>>>>>>>>
46544>>>>>>>>>>>>>            //AB-StoreStart
46544>>>>>>>>>>>>>            Procedure OnClick
46546>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
46547>>>>>>>>>>>>>            End_Procedure
46548>>>>>>>>>>>>>            //AB-StoreEnd
46548>>>>>>>>>>>>>
46548>>>>>>>>>>>>>        End_Object    // oOK_bn
46549>>>>>>>>>>>>>
46549>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
46551>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
46552>>>>>>>>>>>>>            Set Location to 237 371
46553>>>>>>>>>>>>>
46553>>>>>>>>>>>>>            //AB-StoreStart
46553>>>>>>>>>>>>>            Procedure OnClick
46555>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
46556>>>>>>>>>>>>>            End_Procedure
46557>>>>>>>>>>>>>            //AB-StoreEnd
46557>>>>>>>>>>>>>
46557>>>>>>>>>>>>>        End_Object    // oCancel_bn
46558>>>>>>>>>>>>>
46558>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
46560>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
46561>>>>>>>>>>>>>            Set Location to 237 426
46562>>>>>>>>>>>>>
46562>>>>>>>>>>>>>            //AB-StoreStart
46562>>>>>>>>>>>>>            Procedure OnClick
46564>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
46565>>>>>>>>>>>>>            End_Procedure
46566>>>>>>>>>>>>>            //AB-StoreEnd
46566>>>>>>>>>>>>>
46566>>>>>>>>>>>>>        End_Object    // oSearch_bn
46567>>>>>>>>>>>>>
46567>>>>>>>>>>>>>
46567>>>>>>>>>>>>>        //AB-StoreStart
46567>>>>>>>>>>>>>                
46567>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
46568>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
46569>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
46570>>>>>>>>>>>>>        
46570>>>>>>>>>>>>>        Set Locate_Mode to Center_On_Screen
46571>>>>>>>>>>>>>        
46571>>>>>>>>>>>>>        
46571>>>>>>>>>>>>>        
46571>>>>>>>>>>>>>        
46571>>>>>>>>>>>>>        
46571>>>>>>>>>>>>>        
46571>>>>>>>>>>>>>        
46571>>>>>>>>>>>>>        
46571>>>>>>>>>>>>>        
46571>>>>>>>>>>>>>        
46571>>>>>>>>>>>>>        
46571>>>>>>>>>>>>>        
46571>>>>>>>>>>>>>        //AB-StoreEnd
46571>>>>>>>>>>>>>
46571>>>>>>>>>>>>>    CD_End_Object    // SL22s
46573>>>>>>>>>>>>>>
46573>>>>>>>>>>>>>
46573>>>>>>>>>>>>>
46573>>>>>>>>>>>>>    //AB-StoreStart
46573>>>>>>>>>>>>>                                
46573>>>>>>>>>>>>>                                
46573>>>>>>>>>>>>>                                
46573>>>>>>>>>>>>>                                
46573>>>>>>>>>>>>>                                
46573>>>>>>>>>>>>>                                
46573>>>>>>>>>>>>>                                
46573>>>>>>>>>>>>>                                
46573>>>>>>>>>>>>>                                
46573>>>>>>>>>>>>>                                
46573>>>>>>>>>>>>>    //AB-StoreEnd
46573>>>>>>>>>>>>>
46573>>>>>>>>>>>>>//AB/     End_Object    // prj
46573>>>>>>>>>>>Use sl022.SL         // sl022
46573>>>>>>>>>>>
46573>>>>>>>>>>>//DDB-Selection-pkg-End
46573>>>>>>>>>>>//DDB-FileEnd
46573>>>>>>>>>    Use WITEMX.DD
INCLUDING FILE: WITEMX.DD
46573>>>>>>>>>>>//DDB-FileStart
46573>>>>>>>>>>>//DDB-HeaderStart
46573>>>>>>>>>>>
46573>>>>>>>>>>>// File Name : WITEMX.DD
46573>>>>>>>>>>>// Class Name: Witemx_DataDictionary
46573>>>>>>>>>>>// Revision  : 77
46573>>>>>>>>>>>// Version   : 2
46573>>>>>>>>>>>
46573>>>>>>>>>>>Use  Windows           // Basic Definitions
46573>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
46573>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46573>>>>>>>>>>>
46573>>>>>>>>>>>Open Witemx
46575>>>>>>>>>>>Open Witemxt
46577>>>>>>>>>>>Open Pmoves
46579>>>>>>>>>>>Open Wam
46581>>>>>>>>>>>Open Pmovesl
46583>>>>>>>>>>>Open Witemxen
INCLUDING FILE: WITEMXEN.FD
46585>>>>>>>>>>>Open Camovedd
INCLUDING FILE: CAMOVEDD.FD
46587>>>>>>>>>>>Open Wcmoves
46589>>>>>>>>>>>Open Item
46591>>>>>>>>>>>Open Sysrecw
46593>>>>>>>>>>>Open Syscurxr
46595>>>>>>>>>>>
46595>>>>>>>>>>>//DDB-HeaderEnd
46595>>>>>>>>>>>//DDB-SelectionStart
46595>>>>>>>>>>>//DDB/ ExternalSelectionList SL17  sl17.SL
46595>>>>>>>>>>>Register_Object SL17
46595>>>>>>>>>>>//DDB-SelectionEnd
46595>>>>>>>>>>>
46595>>>>>>>>>>>Class Witemx_DataDictionary  is a DataDictionary
46596>>>>>>>>>>>
46596>>>>>>>>>>>    Procedure Construct_Object
46597>>>>>>>>>>>        Forward Send Construct_Object
46599>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
46600>>>>>>>>>>>    End_Procedure //construct_object
46601>>>>>>>>>>>
46601>>>>>>>>>>>    Procedure OnConstrain
46602>>>>>>>>>>>        Forward Send OnConstrain
46604>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
46606>>>>>>>>>>>        End
46606>>>>>>>>>>>>
46606>>>>>>>>>>>        Else Begin
46607>>>>>>>>>>>            Constrain Witemx.Company_Code  eq SysCurXR.Company_Code
46609>>>>>>>>>>>            Constrain Witemx.Branch_Code   eq SysCurXR.Branch_Code
46611>>>>>>>>>>>            Constrain Witemx.Year_Year     eq SysCurXR.Year_Year
46613>>>>>>>>>>>        End
46613>>>>>>>>>>>>
46613>>>>>>>>>>>    End_Procedure
46614>>>>>>>>>>>
46614>>>>>>>>>>>    Procedure Save_Main_File
46615>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
46617>>>>>>>>>>>            If Witemx.Recnum Eq 0 Procedure_Return
46620>>>>>>>>>>>        End
46620>>>>>>>>>>>>
46620>>>>>>>>>>>        Forward Send Save_Main_File
46622>>>>>>>>>>>    End_Procedure
46623>>>>>>>>>>>
46623>>>>>>>>>>>    // Update:
46623>>>>>>>>>>>    Procedure Update
46624>>>>>>>>>>>        Forward Send Update
46626>>>>>>>>>>>        // Insert Code Here
46626>>>>>>>>>>>        Move SysCurXR.Company_Code  to Witemx.Company_Code
46627>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Witemx.Branch_Code
46628>>>>>>>>>>>        Move SysCurXR.Year_Year     to Witemx.Year_Year
46629>>>>>>>>>>>        Move SysCurXR.Year_Recr     to Witemx.Year_Recr
46630>>>>>>>>>>>        Move Witemkat.Witemkat_Code to Witemx.Witemkat_Code
46631>>>>>>>>>>>        Move Units.Units_Code       to Witemx.Units_Code
46632>>>>>>>>>>>        Move Item.Item_Code         to Witemx.Item_Code
46633>>>>>>>>>>>        Move Item.Item_Code         to Witemx.Witemx_Code
46634>>>>>>>>>>>        Move Item.Item_Descr        to Witemx.Witemx_Descr
46635>>>>>>>>>>>        Move Item.Wapokat_Code      to Witemx.ITEM_APOKAT_COD 
46636>>>>>>>>>>>        Move Item.link1             to witemx.link1
46637>>>>>>>>>>>        move Item.link2             to witemx.link2
46638>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Xre/Witemx.Qty_Xre),4))  to Witemx.Mesosta_Xre
46639>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Pis/Witemx.Qty_Pis),4))  to Witemx.Mesosta_Pis
46640>>>>>>>>>>>    End_Procedure   // Update
46641>>>>>>>>>>>
46641>>>>>>>>>>>
46641>>>>>>>>>>>    Procedure Backout
46642>>>>>>>>>>>        Forward Send Backout
46644>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Xre/Witemx.Qty_Xre),4))  to Witemx.Mesosta_Xre
46645>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Pis/Witemx.Qty_Pis),4))  to Witemx.Mesosta_Pis
46646>>>>>>>>>>>    End_Procedure   // Update
46647>>>>>>>>>>>
46647>>>>>>>>>>>    Procedure Creating
46648>>>>>>>>>>>        Forward Send Creating
46650>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                       (Trim(String(Witemx.Witemx_Rec0)))))) to Witemx.Witemx_Recr
46651>>>>>>>>>>>    End_Procedure   // Creating
46652>>>>>>>>>>>
46652>>>>>>>>>>>
46652>>>>>>>>>>>
46652>>>>>>>>>>>    // Define_Fields:
46652>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
46652>>>>>>>>>>>
46652>>>>>>>>>>>    Procedure Define_Fields
46653>>>>>>>>>>>        Forward Send Define_Fields
46655>>>>>>>>>>>        //DDB-Generated-Code-Location
46655>>>>>>>>>>>        //DDB-DefineFieldStart
46655>>>>>>>>>>>
46655>>>>>>>>>>>        Set Main_File            To Witemx.File_Number
46656>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
46657>>>>>>>>>>>
46657>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
46658>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
46659>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
46660>>>>>>>>>>>
46660>>>>>>>>>>>        // Child (Client) file structure................
46660>>>>>>>>>>>        Send Add_Client_File  Witemxt.File_Number
46661>>>>>>>>>>>        Send Add_Client_File  Pmoves.File_Number
46662>>>>>>>>>>>        Send Add_Client_File  Wam.File_Number
46663>>>>>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
46664>>>>>>>>>>>        Send Add_Client_File  Witemxen.File_Number
46665>>>>>>>>>>>        Send Add_Client_File  Camovedd.File_Number
46666>>>>>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
46667>>>>>>>>>>>
46667>>>>>>>>>>>        // Parent (Server) file structure...............
46667>>>>>>>>>>>        Send Add_Server_File  Item.File_Number
46668>>>>>>>>>>>
46668>>>>>>>>>>>        // External (System) file structure.............
46668>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
46669>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
46670>>>>>>>>>>>
46670>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Witemx_Rec0  To Witemx.Witemx_Rec0
46673>>>>>>>>>>>
46673>>>>>>>>>>>        // Field-based properties.......................
46673>>>>>>>>>>>
46673>>>>>>>>>>>        // Witemx.Company_Code
46673>>>>>>>>>>>
46673>>>>>>>>>>>        // Witemx.Branch_Code
46673>>>>>>>>>>>
46673>>>>>>>>>>>        // Witemx.Year_Year
46673>>>>>>>>>>>
46673>>>>>>>>>>>        // Witemx.Units_Code
46673>>>>>>>>>>>
46673>>>>>>>>>>>        // Witemx.Witemkat_Code
46673>>>>>>>>>>>
46673>>>>>>>>>>>        // Witemx.Item_Code
46673>>>>>>>>>>>
46673>>>>>>>>>>>        // Witemx.Witemx_Code
46673>>>>>>>>>>>        Set Field_Options          Field Witemx.Witemx_Code To DD_AUTOFIND   
46674>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Code To (SL17(Self))
46675>>>>>>>>>>>        Set Key_Field_State        Field Witemx.Witemx_Code To TRUE
46676>>>>>>>>>>>
46676>>>>>>>>>>>        // Witemx.Witemx_Recr
46676>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Recr To (SL17(Self))
46677>>>>>>>>>>>
46677>>>>>>>>>>>        // Witemx.Year_Recr
46677>>>>>>>>>>>
46677>>>>>>>>>>>        // Witemx.Item_Recr
46677>>>>>>>>>>>
46677>>>>>>>>>>>        // Witemx.Witemx_Descr
46677>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Descr To (SL17(Self))
46678>>>>>>>>>>>
46678>>>>>>>>>>>        // Witemx.Witemx_Rec0
46678>>>>>>>>>>>
46678>>>>>>>>>>>        // Witemx.Witemx_Yeardesc
46678>>>>>>>>>>>
46678>>>>>>>>>>>        // Witemx.Item_Apokat_Cod
46678>>>>>>>>>>>
46678>>>>>>>>>>>        // Witemx.Qty_Xre
46678>>>>>>>>>>>
46678>>>>>>>>>>>        // Witemx.Qty_Pis
46678>>>>>>>>>>>
46678>>>>>>>>>>>        // Witemx.Axia_Xre
46678>>>>>>>>>>>
46678>>>>>>>>>>>        // Witemx.Axia_Pis
46678>>>>>>>>>>>
46678>>>>>>>>>>>        // Witemx.Mesosta_Xre
46678>>>>>>>>>>>
46678>>>>>>>>>>>        // Witemx.Mesosta_Pis
46678>>>>>>>>>>>
46678>>>>>>>>>>>        // Witemx.Link1
46678>>>>>>>>>>>
46678>>>>>>>>>>>        // Witemx.Link2
46678>>>>>>>>>>>
46678>>>>>>>>>>>        //DDB-DefineFieldEnd
46678>>>>>>>>>>>    End_Procedure    // Define_Fields
46679>>>>>>>>>>>
46679>>>>>>>>>>>    // Field_Defaults:
46679>>>>>>>>>>>    // This procedure is used to establish default field values.
46679>>>>>>>>>>>
46679>>>>>>>>>>>    Procedure Field_Defaults
46680>>>>>>>>>>>        Forward Send Field_Defaults
46682>>>>>>>>>>>        //DDB-Generated-Code-Location
46682>>>>>>>>>>>        //DDB-FieldDefaultStart
46682>>>>>>>>>>>        //DDB-FieldDefaultEnd
46682>>>>>>>>>>>    End_Procedure    // Field_Defaults
46683>>>>>>>>>>>
46683>>>>>>>>>>>End_Class    // Witemx_DataDictionary
46684>>>>>>>>>>>//DDB-Selection-pkg-Start
46684>>>>>>>>>>>
46684>>>>>>>>>>>Use sl17.SL          // SL17
INCLUDING FILE: SL17.SL
46684>>>>>>>>>>>>>//AB/ Project SL17:witemx
46684>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
46684>>>>>>>>>>>>>//AB/         Set ProjectName to "SL17:witemx"
46684>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl17.SL"
46684>>>>>>>>>>>>>
46684>>>>>>>>>>>>>// Project Object Structure
46684>>>>>>>>>>>>>//   SL17 is a dbModalPanelSub
46684>>>>>>>>>>>>>//     Units_DD is a DataDictionary
46684>>>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
46684>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
46684>>>>>>>>>>>>>//     Item_DD is a DataDictionary
46684>>>>>>>>>>>>>//     Witemx_DD is a DataDictionary
46684>>>>>>>>>>>>>//     oSelList is a dbListSub
46684>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
46684>>>>>>>>>>>>>//     ocode is a FormSub
46684>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
46684>>>>>>>>>>>>>//     operi is a FormSub
46684>>>>>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
46684>>>>>>>>>>>>>//       Radio1 is a RadioSub
46684>>>>>>>>>>>>>//       Radio2 is a RadioSub
46684>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
46684>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
46684>>>>>>>>>>>>>//     ocodekat is a FormSub
46684>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
46684>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
46684>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
46684>>>>>>>>>>>>>//     btnwitemcl is a ButtonSub
46684>>>>>>>>>>>>>
46684>>>>>>>>>>>>>// Register all objects
46684>>>>>>>>>>>>>Register_Object ButtonSub1
46684>>>>>>>>>>>>>Register_Object btnwitemcl
46684>>>>>>>>>>>>>Register_Object Fpa_DD
46684>>>>>>>>>>>>>Register_Object Item_DD
46684>>>>>>>>>>>>>Register_Object oCancel_bn
46684>>>>>>>>>>>>>Register_Object ocode
46684>>>>>>>>>>>>>Register_Object ocodekat
46684>>>>>>>>>>>>>Register_Object oOK_bn
46684>>>>>>>>>>>>>Register_Object operi
46684>>>>>>>>>>>>>Register_Object oSearch_bn
46684>>>>>>>>>>>>>Register_Object oSelList
46684>>>>>>>>>>>>>Register_Object Radio1
46684>>>>>>>>>>>>>Register_Object Radio2
46684>>>>>>>>>>>>>Register_Object RadioGroupSub1
46684>>>>>>>>>>>>>Register_Object SL17
46684>>>>>>>>>>>>>Register_Object TextBoxSub1
46684>>>>>>>>>>>>>Register_Object TextBoxSub2
46684>>>>>>>>>>>>>Register_Object TextBoxSub3
46684>>>>>>>>>>>>>Register_Object Units_DD
46684>>>>>>>>>>>>>Register_Object Witemkat_DD
46684>>>>>>>>>>>>>Register_Object Witemx_DD
46684>>>>>>>>>>>>>
46684>>>>>>>>>>>>>
46684>>>>>>>>>>>>>
46684>>>>>>>>>>>>>    //AB-StoreTopStart
46684>>>>>>>>>>>>>    use dg186.dg
INCLUDING FILE: DG186.DG
46684>>>>>>>>>>>>>>>//AB/ Project dg186
46684>>>>>>>>>>>>>>>//AB/     Object prj is a Dialog_Project
46684>>>>>>>>>>>>>>>//AB/         Set ProjectName to "dg186"
46684>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "dg186.DG"
46684>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
46684>>>>>>>>>>>>>>>
46684>>>>>>>>>>>>>>>// Project Object Structure
46684>>>>>>>>>>>>>>>//   dg186 is a dbModalPanelSub
46684>>>>>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
46684>>>>>>>>>>>>>>>//     Units_DD is a DataDictionary
46684>>>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
46684>>>>>>>>>>>>>>>//     Item_DD is a DataDictionary
46684>>>>>>>>>>>>>>>//     Witemcl_DD is a DataDictionary
46684>>>>>>>>>>>>>>>//     The_Table is a dbGrid
46684>>>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
46684>>>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
46684>>>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
46684>>>>>>>>>>>>>>>//     ocode is a FormSub
46684>>>>>>>>>>>>>>>//     operi is a FormSub
46684>>>>>>>>>>>>>>>//     ocodeprom is a FormSub
46684>>>>>>>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
46684>>>>>>>>>>>>>>>//       Radio1 is a RadioSub
46684>>>>>>>>>>>>>>>//       Radio2 is a RadioSub
46684>>>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
46684>>>>>>>>>>>>>>>//     btnwitemcl is a ButtonSub
46684>>>>>>>>>>>>>>>
46684>>>>>>>>>>>>>>>// Register all objects
46684>>>>>>>>>>>>>>>Register_Object ButtonSub1
46684>>>>>>>>>>>>>>>Register_Object btnwitemcl
46684>>>>>>>>>>>>>>>Register_Object dg186
46684>>>>>>>>>>>>>>>Register_Object Fpa_DD
46684>>>>>>>>>>>>>>>Register_Object Item_DD
46684>>>>>>>>>>>>>>>Register_Object ocode
46684>>>>>>>>>>>>>>>Register_Object ocodeprom
46684>>>>>>>>>>>>>>>Register_Object operi
46684>>>>>>>>>>>>>>>Register_Object Radio1
46684>>>>>>>>>>>>>>>Register_Object Radio2
46684>>>>>>>>>>>>>>>Register_Object RadioGroupSub1
46684>>>>>>>>>>>>>>>Register_Object TextBoxSub1
46684>>>>>>>>>>>>>>>Register_Object TextBoxSub2
46684>>>>>>>>>>>>>>>Register_Object TextBoxSub3
46684>>>>>>>>>>>>>>>Register_Object The_Table
46684>>>>>>>>>>>>>>>Register_Object Units_DD
46684>>>>>>>>>>>>>>>Register_Object Witemcl_DD
46684>>>>>>>>>>>>>>>Register_Object Witemkat_DD
46684>>>>>>>>>>>>>>>
46684>>>>>>>>>>>>>>>
46684>>>>>>>>>>>>>>>
46684>>>>>>>>>>>>>>>    //AB-StoreTopStart
46684>>>>>>>>>>>>>>>    open clients
46686>>>>>>>>>>>>>>>    use sl17.sl
46686>>>>>>>>>>>>>>>    //AB-StoreTopEnd
46686>>>>>>>>>>>>>>>
46686>>>>>>>>>>>>>>>    //AB-IgnoreStart
46686>>>>>>>>>>>>>>>
46686>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
46686>>>>>>>>>>>>>>>    Use Txtbox.Sub
46686>>>>>>>>>>>>>>>    Use Form.Sub
46686>>>>>>>>>>>>>>>    Use Rgroup.Sub
46686>>>>>>>>>>>>>>>    Use Radio.Sub
46686>>>>>>>>>>>>>>>    Use Button.Sub
46686>>>>>>>>>>>>>>>
46686>>>>>>>>>>>>>>>
46686>>>>>>>>>>>>>>>    Use WITEMKAT.DD
46686>>>>>>>>>>>>>>>    Use UNITS.DD
46686>>>>>>>>>>>>>>>    Use FPA.DD
46686>>>>>>>>>>>>>>>    Use ITEM.DD
46686>>>>>>>>>>>>>>>    Use WITEMCL.DD
INCLUDING FILE: WITEMCL.DD
46686>>>>>>>>>>>>>>>>>//DDB-FileStart
46686>>>>>>>>>>>>>>>>>//DDB-HeaderStart
46686>>>>>>>>>>>>>>>>>
46686>>>>>>>>>>>>>>>>>// File Name : WITEMCL.DD
46686>>>>>>>>>>>>>>>>>// Class Name: Witemcl_DataDictionary
46686>>>>>>>>>>>>>>>>>// Revision  : 16
46686>>>>>>>>>>>>>>>>>// Version   : 2
46686>>>>>>>>>>>>>>>>>
46686>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
46686>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
46686>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46686>>>>>>>>>>>>>>>>>
46686>>>>>>>>>>>>>>>>>Open Witemcl
46688>>>>>>>>>>>>>>>>>Open Witemcld
46690>>>>>>>>>>>>>>>>>Open Item
46692>>>>>>>>>>>>>>>>>Open Sysrecw
46694>>>>>>>>>>>>>>>>>
46694>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
46694>>>>>>>>>>>>>>>>>//DDB-SelectionStart
46694>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList SL100  sl100.sl
46694>>>>>>>>>>>>>>>>>Register_Object SL100
46694>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
46694>>>>>>>>>>>>>>>>>
46694>>>>>>>>>>>>>>>>>Class Witemcl_DataDictionary  is a DataDictionary_Sec
46695>>>>>>>>>>>>>>>>> 
46695>>>>>>>>>>>>>>>>>    // Update:
46695>>>>>>>>>>>>>>>>> 
46695>>>>>>>>>>>>>>>>>    Procedure Update
46696>>>>>>>>>>>>>>>>>        Forward Send Update  
46698>>>>>>>>>>>>>>>>>        move item.item_descr to witemcl.item_descr
46699>>>>>>>>>>>>>>>>>    End_Procedure   // Update
46700>>>>>>>>>>>>>>>>> 
46700>>>>>>>>>>>>>>>>>
46700>>>>>>>>>>>>>>>>>    // Define_Fields:
46700>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
46700>>>>>>>>>>>>>>>>>
46700>>>>>>>>>>>>>>>>>    Procedure Define_Fields
46701>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
46703>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
46703>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
46703>>>>>>>>>>>>>>>>>
46703>>>>>>>>>>>>>>>>>        Set Main_File            To Witemcl.File_Number
46704>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
46705>>>>>>>>>>>>>>>>>
46705>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
46706>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
46707>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
46708>>>>>>>>>>>>>>>>>
46708>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
46708>>>>>>>>>>>>>>>>>        Send Add_Client_File  Witemcld.File_Number
46709>>>>>>>>>>>>>>>>>
46709>>>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
46709>>>>>>>>>>>>>>>>>        Send Add_Server_File  Item.File_Number
46710>>>>>>>>>>>>>>>>>
46710>>>>>>>>>>>>>>>>>        // External (System) file structure.............
46710>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
46711>>>>>>>>>>>>>>>>>
46711>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Witemcl_Rec0  To Witemcl.Rec0
46714>>>>>>>>>>>>>>>>>
46714>>>>>>>>>>>>>>>>>        // Field-based properties.......................
46714>>>>>>>>>>>>>>>>>
46714>>>>>>>>>>>>>>>>>        // Witemcl.Item_Code
46714>>>>>>>>>>>>>>>>>
46714>>>>>>>>>>>>>>>>>        // Witemcl.Client_Code
46714>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemcl.Client_Code To (SL100(Self))
46715>>>>>>>>>>>>>>>>>
46715>>>>>>>>>>>>>>>>>        // Witemcl.Client_Itemcode
46715>>>>>>>>>>>>>>>>>
46715>>>>>>>>>>>>>>>>>        // Witemcl.Client_Date
46715>>>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Witemcl.Client_Date To MASK_DATE_WINDOW
46716>>>>>>>>>>>>>>>>>
46716>>>>>>>>>>>>>>>>>        // Witemcl.Client_Price
46716>>>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Witemcl.Client_Price To MASK_NUMERIC_WINDOW
46717>>>>>>>>>>>>>>>>>
46717>>>>>>>>>>>>>>>>>        // Witemcl.Item_Descr
46717>>>>>>>>>>>>>>>>>
46717>>>>>>>>>>>>>>>>>        // Witemcl.Rec0
46717>>>>>>>>>>>>>>>>>
46717>>>>>>>>>>>>>>>>>        // Witemcl.Is_Client
46717>>>>>>>>>>>>>>>>>
46717>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
46717>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
46718>>>>>>>>>>>>>>>>>
46718>>>>>>>>>>>>>>>>>    // Field_Defaults:
46718>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
46718>>>>>>>>>>>>>>>>>
46718>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
46719>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
46721>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
46721>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
46721>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
46721>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
46722>>>>>>>>>>>>>>>>>
46722>>>>>>>>>>>>>>>>>End_Class    // Witemcl_DataDictionary
46723>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
46723>>>>>>>>>>>>>>>>>
46723>>>>>>>>>>>>>>>>>Use sl100.sl         // SL100
46723>>>>>>>>>>>>>>>>>
46723>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
46723>>>>>>>>>>>>>>>>>//DDB-FileEnd
46723>>>>>>>>>>>>>>>    
46723>>>>>>>>>>>>>>>    //AB-IgnoreEnd
46723>>>>>>>>>>>>>>>
46723>>>>>>>>>>>>>>>    Object dg186 is a dbModalPanelSub
46725>>>>>>>>>>>>>>>
46725>>>>>>>>>>>>>>>        //AB-StoreTopStart
46725>>>>>>>>>>>>>>>        Function fsclient string code Returns string
46727>>>>>>>>>>>>>>>            string name
46728>>>>>>>>>>>>>>>            clear clients
46729>>>>>>>>>>>>>>>            move code to clients.client_id
46730>>>>>>>>>>>>>>>            find eq clients by index.6
46731>>>>>>>>>>>>>>>>
46731>>>>>>>>>>>>>>>            move clients.client_name to name
46732>>>>>>>>>>>>>>>            function_return name
46733>>>>>>>>>>>>>>>        end_Function
46734>>>>>>>>>>>>>>>        
46734>>>>>>>>>>>>>>>        Property String     pscode                  ''
46736>>>>>>>>>>>>>>>        Property String     psperi                  ''
46738>>>>>>>>>>>>>>>        Property Integer    piContains_Or_Starts     0
46740>>>>>>>>>>>>>>>        Property String     pscodeprom              ''
46742>>>>>>>>>>>>>>>        
46742>>>>>>>>>>>>>>>        
46742>>>>>>>>>>>>>>>        //AB-StoreTopEnd
46742>>>>>>>>>>>>>>>
46742>>>>>>>>>>>>>>>        Set Label to "‘¬©®œ«å©œ ª „ ›é¤ €§¦Ÿã¡žª"
46743>>>>>>>>>>>>>>>        Set Size to 289 527
46744>>>>>>>>>>>>>>>        Set Location to 0 2
46745>>>>>>>>>>>>>>>
46745>>>>>>>>>>>>>>>        //AB-DDOStart
46745>>>>>>>>>>>>>>>
46745>>>>>>>>>>>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
46747>>>>>>>>>>>>>>>        End_Object    // Witemkat_DD
46748>>>>>>>>>>>>>>>
46748>>>>>>>>>>>>>>>        Object Units_DD is a Units_DataDictionary
46750>>>>>>>>>>>>>>>        End_Object    // Units_DD
46751>>>>>>>>>>>>>>>
46751>>>>>>>>>>>>>>>        Object Fpa_DD is a Fpa_DataDictionary
46753>>>>>>>>>>>>>>>        End_Object    // Fpa_DD
46754>>>>>>>>>>>>>>>
46754>>>>>>>>>>>>>>>        Object Item_DD is a Item_DataDictionary
46756>>>>>>>>>>>>>>>            Set DDO_Server to (Units_DD(self))
46757>>>>>>>>>>>>>>>            Set DDO_Server to (Witemkat_DD(self))
46758>>>>>>>>>>>>>>>            Set DDO_Server to (Fpa_DD(self))
46759>>>>>>>>>>>>>>>        End_Object    // Item_DD
46760>>>>>>>>>>>>>>>
46760>>>>>>>>>>>>>>>        Object Witemcl_DD is a Witemcl_DataDictionary
46762>>>>>>>>>>>>>>>
46762>>>>>>>>>>>>>>>            //AB-StoreTopStart
46762>>>>>>>>>>>>>>>            Function fiPeriexei Returns Integer
46764>>>>>>>>>>>>>>>                       String lsperi lscode  lscodeprom
46765>>>>>>>>>>>>>>>                       Integer rVal liContains_Or_Starts
46765>>>>>>>>>>>>>>>                       Move 0 to rVal
46766>>>>>>>>>>>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
46767>>>>>>>>>>>>>>>                       Get psperi to lsperi
46768>>>>>>>>>>>>>>>                       Get pscode to lscode
46769>>>>>>>>>>>>>>>                       Get pscodeprom to lscodeprom
46770>>>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
46771>>>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
46772>>>>>>>>>>>>>>>                  //     Move (Trim(lscodekat)) to lscodekat
46772>>>>>>>>>>>>>>>                       If (liContains_Or_Starts=0) Begin
46774>>>>>>>>>>>>>>>                           If ((Trim(witemcl.item_descr)) Contains lsperi) Begin
46776>>>>>>>>>>>>>>>                               If ((Trim(witemcl.item_code)) Contains lscode) Move 1 to rVal
46779>>>>>>>>>>>>>>>                           End
46779>>>>>>>>>>>>>>>>
46779>>>>>>>>>>>>>>>            
46779>>>>>>>>>>>>>>>                       End
46779>>>>>>>>>>>>>>>>
46779>>>>>>>>>>>>>>>                       Else Begin
46780>>>>>>>>>>>>>>>                           If (Left(witemcl.item_descr,(Length(lsperi)))=lsperi) Begin
46782>>>>>>>>>>>>>>>                               If (Left(witemcl.item_code,(Length(lscode)))=lscode) Move 1 to rVal
46785>>>>>>>>>>>>>>>                           End
46785>>>>>>>>>>>>>>>>
46785>>>>>>>>>>>>>>>            
46785>>>>>>>>>>>>>>>                       End
46785>>>>>>>>>>>>>>>>
46785>>>>>>>>>>>>>>>                       Function_Return rVal
46786>>>>>>>>>>>>>>>                   End_Function
46787>>>>>>>>>>>>>>>            
46787>>>>>>>>>>>>>>>                   Function fiArxizeiperi Returns Integer
46789>>>>>>>>>>>>>>>                       String lsperi
46790>>>>>>>>>>>>>>>                       Get psperi to lsperi
46791>>>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
46792>>>>>>>>>>>>>>>                       Function_Return (Left(witemcl.item_descr,(Length(lsperi)))=lsperi)
46793>>>>>>>>>>>>>>>                   End_Function
46794>>>>>>>>>>>>>>>            
46794>>>>>>>>>>>>>>>                   Function fiArxizeicode Returns Integer
46796>>>>>>>>>>>>>>>                       String lscode lscodeprom
46797>>>>>>>>>>>>>>>                       Get pscode to lscode
46798>>>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
46799>>>>>>>>>>>>>>>                       Function_Return (Left(witemcl.item_code,(Length(lscode)))=lscode)
46800>>>>>>>>>>>>>>>                   End_Function
46801>>>>>>>>>>>>>>>            
46801>>>>>>>>>>>>>>>            //AB-StoreTopEnd
46801>>>>>>>>>>>>>>>
46801>>>>>>>>>>>>>>>            Set DDO_Server to (Item_DD(self))
46802>>>>>>>>>>>>>>>
46802>>>>>>>>>>>>>>>            //AB-StoreStart
46802>>>>>>>>>>>>>>>                                                                
46802>>>>>>>>>>>>>>>                                                                
46802>>>>>>>>>>>>>>>            Begin_Constraints
46804>>>>>>>>>>>>>>>               String lsperi lscode lsvalue lstype lscodeprom
46805>>>>>>>>>>>>>>>               Integer liContains_Or_Starts
46805>>>>>>>>>>>>>>>                   Get psperi  to lsperi
46806>>>>>>>>>>>>>>>                   Get pscode  to lscode
46807>>>>>>>>>>>>>>>                   Get pscodeprom  to lscodeprom
46808>>>>>>>>>>>>>>>                   Get piContains_Or_Starts to liContains_Or_Starts
46809>>>>>>>>>>>>>>>                   Move (Trim(lsperi)) to lsperi
46810>>>>>>>>>>>>>>>                   Move (Trim(lscode)) to lscode
46811>>>>>>>>>>>>>>>                   Move (Trim(lscodeprom)) to lscodeprom
46812>>>>>>>>>>>>>>>                   If ((lsperi<>'') and ;                      (lscode<>'')) Constrain witemcl as (fiPeriexei(Self)=1)
46815>>>>>>>>>>>>>>>                   Else Begin
46816>>>>>>>>>>>>>>>                      If (liContains_Or_Starts=0) Begin
46818>>>>>>>>>>>>>>>                      If (lsperi<>'') Constrain witemcl.item_descr Contains lsperi
46822>>>>>>>>>>>>>>>                      Else If (lscode<>'') Constrain witemcl.item_code Contains lscode
46827>>>>>>>>>>>>>>>                      End
46827>>>>>>>>>>>>>>>>
46827>>>>>>>>>>>>>>>                   Else Begin
46828>>>>>>>>>>>>>>>                       If (lsperi<>'') Constrain witemcl as (fiArxizeiperi(Self)=1) //witemcl.item_descr
46831>>>>>>>>>>>>>>>                       Else If (lscode<>'') Constrain witemcl as (fiArxizeicode(Self)=1) //witemcl.item_code
46835>>>>>>>>>>>>>>>                       End
46835>>>>>>>>>>>>>>>>
46835>>>>>>>>>>>>>>>                   End
46835>>>>>>>>>>>>>>>>
46835>>>>>>>>>>>>>>>                   If (lscodeprom<>'') Constrain witemcl.client_itemcode Contains lscodeprom
46839>>>>>>>>>>>>>>>            
46839>>>>>>>>>>>>>>>            End_Constraints
46842>>>>>>>>>>>>>>>            
46842>>>>>>>>>>>>>>>            
46842>>>>>>>>>>>>>>>            //AB-StoreEnd
46842>>>>>>>>>>>>>>>
46842>>>>>>>>>>>>>>>        End_Object    // Witemcl_DD
46843>>>>>>>>>>>>>>>
46843>>>>>>>>>>>>>>>        Set Main_DD to (Witemcl_DD(self))
46844>>>>>>>>>>>>>>>        Set Server to (Witemcl_DD(self))
46845>>>>>>>>>>>>>>>
46845>>>>>>>>>>>>>>>        //AB-DDOEnd
46845>>>>>>>>>>>>>>>
46845>>>>>>>>>>>>>>>        Object The_Table is a dbGrid
46847>>>>>>>>>>>>>>>            Set Main_File to Witemcl.File_Number
46848>>>>>>>>>>>>>>>            Set Size to 201 519
46849>>>>>>>>>>>>>>>            Set Location to 3 2
46850>>>>>>>>>>>>>>>            Set Color to 14280447
46851>>>>>>>>>>>>>>>            Set CurrentRowColor to 11783679
46852>>>>>>>>>>>>>>>            Set CurrentCellColor to 11783679
46853>>>>>>>>>>>>>>>            Set Wrap_State to TRUE
46854>>>>>>>>>>>>>>>
46854>>>>>>>>>>>>>>>            Begin_Row
46857>>>>>>>>>>>>>>>                Entry_Item Witemcl.Item_code
46858>>>>>>>>>>>>>>>                Entry_Item Witemcl.Client_itemcode
46859>>>>>>>>>>>>>>>                Entry_Item Witemcl.Item_descr
46860>>>>>>>>>>>>>>>                Entry_Item Witemcl.Client_code
46861>>>>>>>>>>>>>>>                Entry_Item (fsclient(self,witemcl.client_code))
46862>>>>>>>>>>>>>>>            End_Row
46867>>>>>>>>>>>>>>>
46867>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 100
46868>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª „å›¦¬ª"
46869>>>>>>>>>>>>>>>            
46869>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 100
46870>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "„å›¦ª ¨¦£žŸœ¬«ã"
46871>>>>>>>>>>>>>>>            
46871>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 200
46872>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "œ¨ š¨˜­ã „å›¦¬ª"
46873>>>>>>>>>>>>>>>            
46873>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 0
46874>>>>>>>>>>>>>>>            Set Header_Label  item 3 to ""
46875>>>>>>>>>>>>>>>            
46875>>>>>>>>>>>>>>>            Set Form_Width    item 4 to 111
46876>>>>>>>>>>>>>>>            Set Header_Label  item 4 to "¨¦£žŸœ¬«ãª"
46877>>>>>>>>>>>>>>>            
46877>>>>>>>>>>>>>>>
46877>>>>>>>>>>>>>>>            //AB-StoreStart
46877>>>>>>>>>>>>>>>            Set Column_Option Item 3 to NoEnter True
46878>>>>>>>>>>>>>>>            //set read_only_state to true
46878>>>>>>>>>>>>>>>            set no_create_state to true
46879>>>>>>>>>>>>>>>            set no_delete_state to true
46880>>>>>>>>>>>>>>>            //AB-StoreEnd
46880>>>>>>>>>>>>>>>
46880>>>>>>>>>>>>>>>        End_Object    // The_Table
46881>>>>>>>>>>>>>>>
46881>>>>>>>>>>>>>>>        Object TextBoxSub1 is a TextBoxSub
46883>>>>>>>>>>>>>>>            Set Label to "‘á¨à©ž ‰à› ¡¦ç ‚ á"
46884>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
46885>>>>>>>>>>>>>>>            Set Location to 208 5
46886>>>>>>>>>>>>>>>            Set Size to 13 78
46887>>>>>>>>>>>>>>>        End_Object    // TextBoxSub1
46888>>>>>>>>>>>>>>>
46888>>>>>>>>>>>>>>>        Object TextBoxSub2 is a TextBoxSub
46890>>>>>>>>>>>>>>>            Set Label to "‘á¨à©ž œ¨ š¨˜­ãª "
46891>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
46892>>>>>>>>>>>>>>>            Set Location to 223 5
46893>>>>>>>>>>>>>>>            Set Size to 13 83
46894>>>>>>>>>>>>>>>        End_Object    // TextBoxSub2
46895>>>>>>>>>>>>>>>
46895>>>>>>>>>>>>>>>        Object TextBoxSub3 is a TextBoxSub
46897>>>>>>>>>>>>>>>            Set Label to "„å›¦ª ¨¦£žŸœ¬«ã ‚ á"
46898>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
46899>>>>>>>>>>>>>>>            Set Location to 237 5
46900>>>>>>>>>>>>>>>            Set Size to 13 78
46901>>>>>>>>>>>>>>>        End_Object    // TextBoxSub3
46902>>>>>>>>>>>>>>>
46902>>>>>>>>>>>>>>>        Object ocode is a FormSub
46904>>>>>>>>>>>>>>>            Set Size to 13 197
46905>>>>>>>>>>>>>>>            Set Location to 209 91
46906>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
46907>>>>>>>>>>>>>>>
46907>>>>>>>>>>>>>>>            //AB-StoreStart
46907>>>>>>>>>>>>>>>                                                                                                                                                                                                    
46907>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
46909>>>>>>>>>>>>>>>               Send KeyAction to ButtonSub1
46910>>>>>>>>>>>>>>>            End_Procedure
46911>>>>>>>>>>>>>>>            
46911>>>>>>>>>>>>>>>            
46911>>>>>>>>>>>>>>>            
46911>>>>>>>>>>>>>>>            
46911>>>>>>>>>>>>>>>            //AB-StoreEnd
46911>>>>>>>>>>>>>>>
46911>>>>>>>>>>>>>>>        End_Object    // ocode
46912>>>>>>>>>>>>>>>
46912>>>>>>>>>>>>>>>        Object operi is a FormSub
46914>>>>>>>>>>>>>>>            Set Size to 13 197
46915>>>>>>>>>>>>>>>            Set Location to 223 91
46916>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
46917>>>>>>>>>>>>>>>
46917>>>>>>>>>>>>>>>            //AB-StoreStart
46917>>>>>>>>>>>>>>>                                                                                                                                                                                                    
46917>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
46919>>>>>>>>>>>>>>>              Send KeyAction to ButtonSub1
46920>>>>>>>>>>>>>>>            End_Procedure
46921>>>>>>>>>>>>>>>            
46921>>>>>>>>>>>>>>>            
46921>>>>>>>>>>>>>>>            
46921>>>>>>>>>>>>>>>            
46921>>>>>>>>>>>>>>>            //AB-StoreEnd
46921>>>>>>>>>>>>>>>
46921>>>>>>>>>>>>>>>        End_Object    // operi
46922>>>>>>>>>>>>>>>
46922>>>>>>>>>>>>>>>        Object ocodeprom is a FormSub
46924>>>>>>>>>>>>>>>            Set Size to 13 197
46925>>>>>>>>>>>>>>>            Set Location to 238 91
46926>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
46927>>>>>>>>>>>>>>>
46927>>>>>>>>>>>>>>>            //AB-StoreStart
46927>>>>>>>>>>>>>>>                                                                                                                                                                                                    
46927>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
46929>>>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
46930>>>>>>>>>>>>>>>            End_Procedure
46931>>>>>>>>>>>>>>>            
46931>>>>>>>>>>>>>>>            
46931>>>>>>>>>>>>>>>            
46931>>>>>>>>>>>>>>>            //AB-StoreEnd
46931>>>>>>>>>>>>>>>
46931>>>>>>>>>>>>>>>        End_Object    // ocodeprom
46932>>>>>>>>>>>>>>>
46932>>>>>>>>>>>>>>>        Object RadioGroupSub1 is a RadioGroupSub
46934>>>>>>>>>>>>>>>            Set Size to 32 77
46935>>>>>>>>>>>>>>>            Set Location to 209 296
46936>>>>>>>>>>>>>>>            Object Radio1 is a RadioSub
46938>>>>>>>>>>>>>>>                Set Label to "œ¨ â®œ«˜ "
46939>>>>>>>>>>>>>>>                Set Size to 10 53
46940>>>>>>>>>>>>>>>                Set Location to 7 5
46941>>>>>>>>>>>>>>>            End_Object    // Radio1
46942>>>>>>>>>>>>>>>
46942>>>>>>>>>>>>>>>            Object Radio2 is a RadioSub
46944>>>>>>>>>>>>>>>                Set Label to "€¨®åœ  €§æ"
46945>>>>>>>>>>>>>>>                Set Size to 10 51
46946>>>>>>>>>>>>>>>                Set Location to 21 5
46947>>>>>>>>>>>>>>>            End_Object    // Radio2
46948>>>>>>>>>>>>>>>
46948>>>>>>>>>>>>>>>
46948>>>>>>>>>>>>>>>            //AB-StoreStart
46948>>>>>>>>>>>>>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
46948>>>>>>>>>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
46950>>>>>>>>>>>>>>>                //iToItem=0 => Contains, =1 => Starts with
46950>>>>>>>>>>>>>>>                Set piContains_Or_Starts to iToItem
46951>>>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
46952>>>>>>>>>>>>>>>            End_Procedure
46953>>>>>>>>>>>>>>>            
46953>>>>>>>>>>>>>>>            // If you set Current_radio you must set this after the
46953>>>>>>>>>>>>>>>            // radio objects have been created AND after Notify_select_State has been
46953>>>>>>>>>>>>>>>            // created. i.e. Set in bottom-code at end!!
46953>>>>>>>>>>>>>>>            //Set Current_Radio to 0
46953>>>>>>>>>>>>>>>            
46953>>>>>>>>>>>>>>>            
46953>>>>>>>>>>>>>>>            //AB-StoreEnd
46953>>>>>>>>>>>>>>>
46953>>>>>>>>>>>>>>>        End_Object    // RadioGroupSub1
46954>>>>>>>>>>>>>>>
46954>>>>>>>>>>>>>>>        Object ButtonSub1 is a ButtonSub
46956>>>>>>>>>>>>>>>            Set Label to "Search"
46957>>>>>>>>>>>>>>>            Set Size to 28 37
46958>>>>>>>>>>>>>>>            Set Location to 210 413
46959>>>>>>>>>>>>>>>            Set Form_FontWeight Item 0 to 800
46960>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
46961>>>>>>>>>>>>>>>
46961>>>>>>>>>>>>>>>            //AB-StoreStart
46961>>>>>>>>>>>>>>>                                        
46961>>>>>>>>>>>>>>>            Set Visible_State to False
46962>>>>>>>>>>>>>>>            
46962>>>>>>>>>>>>>>>            Procedure OnClick
46964>>>>>>>>>>>>>>>                Forward Send OnClick
46966>>>>>>>>>>>>>>>                Set pscode  to (Value(ocode(Self),0))
46967>>>>>>>>>>>>>>>                Set psperi  to (Value(operi(Self),0))
46968>>>>>>>>>>>>>>>                Set pscodeprom  to (Value(ocodeprom(Self),0))
46969>>>>>>>>>>>>>>>                send Rebuild_Constraints    to (witemcl_DD(Self))
46970>>>>>>>>>>>>>>>                Send Beginning_Of_Data      to the_table
46971>>>>>>>>>>>>>>>            End_Procedure // OnClick
46972>>>>>>>>>>>>>>>            
46972>>>>>>>>>>>>>>>            
46972>>>>>>>>>>>>>>>            
46972>>>>>>>>>>>>>>>            
46972>>>>>>>>>>>>>>>            
46972>>>>>>>>>>>>>>>            
46972>>>>>>>>>>>>>>>            
46972>>>>>>>>>>>>>>>            
46972>>>>>>>>>>>>>>>            
46972>>>>>>>>>>>>>>>            
46972>>>>>>>>>>>>>>>            
46972>>>>>>>>>>>>>>>            
46972>>>>>>>>>>>>>>>            
46972>>>>>>>>>>>>>>>            
46972>>>>>>>>>>>>>>>            
46972>>>>>>>>>>>>>>>            //AB-StoreEnd
46972>>>>>>>>>>>>>>>
46972>>>>>>>>>>>>>>>        End_Object    // ButtonSub1
46973>>>>>>>>>>>>>>>
46973>>>>>>>>>>>>>>>        Object btnwitemcl is a ButtonSub
46975>>>>>>>>>>>>>>>
46975>>>>>>>>>>>>>>>            //AB-StoreTopStart
46975>>>>>>>>>>>>>>>                                                                                    
46975>>>>>>>>>>>>>>>            //AB-StoreTopEnd
46975>>>>>>>>>>>>>>>
46975>>>>>>>>>>>>>>>            Set Label to "ButtonSub1"
46976>>>>>>>>>>>>>>>            Set Bitmap to "Filesys3.bmp"
46977>>>>>>>>>>>>>>>            Set Size to 22 25
46978>>>>>>>>>>>>>>>            Set Location to 214 482
46979>>>>>>>>>>>>>>>            Set Focus_Mode to Pointer_Only
46980>>>>>>>>>>>>>>>
46980>>>>>>>>>>>>>>>            //AB-StoreStart
46980>>>>>>>>>>>>>>>                                                                                    
46980>>>>>>>>>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ œ¬¨œ«ã¨ ¦ „ ›é¤"
46981>>>>>>>>>>>>>>>            
46981>>>>>>>>>>>>>>>            Procedure OnClick
46983>>>>>>>>>>>>>>>                String  scode speri
46984>>>>>>>>>>>>>>>                Get value of (ocode(self)) to scode
46985>>>>>>>>>>>>>>>                Get value of (operi(self)) to speri
46986>>>>>>>>>>>>>>>                set pscode of (sl17(self)) to scode
46987>>>>>>>>>>>>>>>                set psperi of (sl17(self)) to speri
46988>>>>>>>>>>>>>>>                send request_cancel to dg186
46989>>>>>>>>>>>>>>>            End_Procedure // OnClick
46990>>>>>>>>>>>>>>>            
46990>>>>>>>>>>>>>>>            
46990>>>>>>>>>>>>>>>            
46990>>>>>>>>>>>>>>>            
46990>>>>>>>>>>>>>>>            
46990>>>>>>>>>>>>>>>            
46990>>>>>>>>>>>>>>>            
46990>>>>>>>>>>>>>>>            
46990>>>>>>>>>>>>>>>            
46990>>>>>>>>>>>>>>>            
46990>>>>>>>>>>>>>>>            
46990>>>>>>>>>>>>>>>            
46990>>>>>>>>>>>>>>>            
46990>>>>>>>>>>>>>>>            
46990>>>>>>>>>>>>>>>            
46990>>>>>>>>>>>>>>>            
46990>>>>>>>>>>>>>>>            
46990>>>>>>>>>>>>>>>            
46990>>>>>>>>>>>>>>>            
46990>>>>>>>>>>>>>>>            
46990>>>>>>>>>>>>>>>            
46990>>>>>>>>>>>>>>>            //AB-StoreEnd
46990>>>>>>>>>>>>>>>
46990>>>>>>>>>>>>>>>        End_Object    // btnwitemcl
46991>>>>>>>>>>>>>>>
46991>>>>>>>>>>>>>>>
46991>>>>>>>>>>>>>>>        //AB-StoreStart
46991>>>>>>>>>>>>>>>        Procedure Activating
46993>>>>>>>>>>>>>>>           integer rval
46994>>>>>>>>>>>>>>>           set value of (ocode(self)) to (pscode(self))
46995>>>>>>>>>>>>>>>           set value of (operi(self)) to (psperi(self))
46996>>>>>>>>>>>>>>>           Send Rebuild_Constraints to (witemcl_DD(Self))
46997>>>>>>>>>>>>>>>           Forward send Activating
46999>>>>>>>>>>>>>>>        
46999>>>>>>>>>>>>>>>        End_Procedure
47000>>>>>>>>>>>>>>>        
47000>>>>>>>>>>>>>>>        
47000>>>>>>>>>>>>>>>        
47000>>>>>>>>>>>>>>>        
47000>>>>>>>>>>>>>>>        
47000>>>>>>>>>>>>>>>        
47000>>>>>>>>>>>>>>>        //AB-StoreEnd
47000>>>>>>>>>>>>>>>
47000>>>>>>>>>>>>>>>    End_Object    // dg186
47001>>>>>>>>>>>>>>>
47001>>>>>>>>>>>>>>>
47001>>>>>>>>>>>>>>>    //AB-StoreStart
47001>>>>>>>>>>>>>>>        
47001>>>>>>>>>>>>>>>    //AB-StoreEnd
47001>>>>>>>>>>>>>>>
47001>>>>>>>>>>>>>>>//AB/     End_Object    // prj
47001>>>>>>>>>>>>>    //AB-StoreTopEnd
47001>>>>>>>>>>>>>
47001>>>>>>>>>>>>>    //AB-IgnoreStart
47001>>>>>>>>>>>>>
47001>>>>>>>>>>>>>    Use DFAllEnt.pkg
47001>>>>>>>>>>>>>    Use dbList.Sub
47001>>>>>>>>>>>>>    Use Txtbox.Sub
47001>>>>>>>>>>>>>    Use Form.Sub
47001>>>>>>>>>>>>>    Use Rgroup.Sub
47001>>>>>>>>>>>>>    Use Radio.Sub
47001>>>>>>>>>>>>>    Use Button.Sub
47001>>>>>>>>>>>>>
47001>>>>>>>>>>>>>
47001>>>>>>>>>>>>>    Use UNITS.DD
47001>>>>>>>>>>>>>    Use WITEMKAT.DD
47001>>>>>>>>>>>>>    Use FPA.DD
47001>>>>>>>>>>>>>    Use ITEM.DD
47001>>>>>>>>>>>>>    Use WITEMX.DD
47001>>>>>>>>>>>>>    
47001>>>>>>>>>>>>>    //AB-IgnoreEnd
47001>>>>>>>>>>>>>
47001>>>>>>>>>>>>>    Object SL17 is a dbModalPanelSub
47003>>>>>>>>>>>>>
47003>>>>>>>>>>>>>        //AB-StoreTopStart
47003>>>>>>>>>>>>>                
47003>>>>>>>>>>>>>        Property String     pscode                  ''
47005>>>>>>>>>>>>>        Property String     psperi                  ''
47007>>>>>>>>>>>>>        Property Integer    piContains_Or_Starts     0
47009>>>>>>>>>>>>>        Property String     pscodekat               ''
47011>>>>>>>>>>>>>        
47011>>>>>>>>>>>>>        //AB-StoreTopEnd
47011>>>>>>>>>>>>>
47011>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
47012>>>>>>>>>>>>>        Set Label to "„¬¨œ«ã¨ ¦ €¨®œå¦¬ „ ›é¤"
47013>>>>>>>>>>>>>        Set Size to 266 484
47014>>>>>>>>>>>>>        Set Location to 9 14
47015>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
47016>>>>>>>>>>>>>        Set Modal_State to FALSE
47017>>>>>>>>>>>>>
47017>>>>>>>>>>>>>        //AB-DDOStart
47017>>>>>>>>>>>>>
47017>>>>>>>>>>>>>        Object Units_DD is a Units_DataDictionary
47019>>>>>>>>>>>>>        End_Object    // Units_DD
47020>>>>>>>>>>>>>
47020>>>>>>>>>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
47022>>>>>>>>>>>>>        End_Object    // Witemkat_DD
47023>>>>>>>>>>>>>
47023>>>>>>>>>>>>>        Object Fpa_DD is a Fpa_DataDictionary
47025>>>>>>>>>>>>>        End_Object    // Fpa_DD
47026>>>>>>>>>>>>>
47026>>>>>>>>>>>>>        Object Item_DD is a Item_DataDictionary
47028>>>>>>>>>>>>>
47028>>>>>>>>>>>>>            //AB-StoreTopStart
47028>>>>>>>>>>>>>                                                                                                    
47028>>>>>>>>>>>>>                                                                                                    
47028>>>>>>>>>>>>>            //AB-StoreTopEnd
47028>>>>>>>>>>>>>
47028>>>>>>>>>>>>>            Set DDO_Server to (Units_DD(self))
47029>>>>>>>>>>>>>            Set DDO_Server to (Witemkat_DD(self))
47030>>>>>>>>>>>>>            Set DDO_Server to (Fpa_DD(self))
47031>>>>>>>>>>>>>
47031>>>>>>>>>>>>>            //AB-StoreStart
47031>>>>>>>>>>>>>                                                                                                    
47031>>>>>>>>>>>>>                                                                                                    
47031>>>>>>>>>>>>>                                                                                                    
47031>>>>>>>>>>>>>                                                                                                    
47031>>>>>>>>>>>>>                                                                                                    
47031>>>>>>>>>>>>>                                                                                                    
47031>>>>>>>>>>>>>                                                                                                    
47031>>>>>>>>>>>>>                                                                                                    
47031>>>>>>>>>>>>>            //AB-StoreEnd
47031>>>>>>>>>>>>>
47031>>>>>>>>>>>>>        End_Object    // Item_DD
47032>>>>>>>>>>>>>
47032>>>>>>>>>>>>>        Object Witemx_DD is a Witemx_DataDictionary
47034>>>>>>>>>>>>>
47034>>>>>>>>>>>>>            //AB-StoreTopStart
47034>>>>>>>>>>>>>            Function fiPeriexei Returns Integer
47036>>>>>>>>>>>>>                       String lsperi lscode  lscodekat
47037>>>>>>>>>>>>>                       Integer rVal liContains_Or_Starts
47037>>>>>>>>>>>>>                       Move 0 to rVal
47038>>>>>>>>>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
47039>>>>>>>>>>>>>                       Get psperi to lsperi
47040>>>>>>>>>>>>>                       Get pscode to lscode
47041>>>>>>>>>>>>>                       Get pscodekat to lscodekat
47042>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
47043>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
47044>>>>>>>>>>>>>                       If (liContains_Or_Starts=0) Begin
47046>>>>>>>>>>>>>                           If ((Trim(witemx.witemx_descr)) Contains lsperi) Begin
47048>>>>>>>>>>>>>                               If ((Trim(witemx.witemx_code)) Contains lscode) Move 1 to rVal
47051>>>>>>>>>>>>>                           End
47051>>>>>>>>>>>>>>
47051>>>>>>>>>>>>>                       End
47051>>>>>>>>>>>>>>
47051>>>>>>>>>>>>>                       Else Begin
47052>>>>>>>>>>>>>                           If (Left(witemx.witemx_descr,(Length(lsperi)))=lsperi) Begin
47054>>>>>>>>>>>>>                               If (Left(witemx.witemx_code,(Length(lscode)))=lscode) Move 1 to rVal
47057>>>>>>>>>>>>>                           End
47057>>>>>>>>>>>>>>
47057>>>>>>>>>>>>>                       End
47057>>>>>>>>>>>>>>
47057>>>>>>>>>>>>>                       Function_Return rVal
47058>>>>>>>>>>>>>                   End_Function
47059>>>>>>>>>>>>>            
47059>>>>>>>>>>>>>                   Function fiArxizeiperi Returns Integer
47061>>>>>>>>>>>>>                       String lsperi
47062>>>>>>>>>>>>>                       Get psperi to lsperi
47063>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
47064>>>>>>>>>>>>>                       Function_Return (Left(witemx.witemx_descr,(Length(lsperi)))=lsperi)
47065>>>>>>>>>>>>>                   End_Function
47066>>>>>>>>>>>>>            
47066>>>>>>>>>>>>>                   Function fiArxizeicode Returns Integer
47068>>>>>>>>>>>>>                       String lscode lscodekat
47069>>>>>>>>>>>>>                       Get pscode to lscode
47070>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
47071>>>>>>>>>>>>>                       Function_Return (Left(witemx.witemx_code,(Length(lscode)))=lscode)
47072>>>>>>>>>>>>>                   End_Function
47073>>>>>>>>>>>>>            //AB-StoreTopEnd
47073>>>>>>>>>>>>>
47073>>>>>>>>>>>>>            Set DDO_Server to (Item_DD(self))
47074>>>>>>>>>>>>>
47074>>>>>>>>>>>>>            //AB-StoreStart
47074>>>>>>>>>>>>>                                                                                
47074>>>>>>>>>>>>>            Begin_Constraints
47076>>>>>>>>>>>>>               String lsperi lscode lsvalue lstype lscodekat
47077>>>>>>>>>>>>>               Integer liContains_Or_Starts
47077>>>>>>>>>>>>>               Get psperi               to lsperi
47078>>>>>>>>>>>>>               Get pscode               to lscode
47079>>>>>>>>>>>>>               Get pscodekat            to lscodekat
47080>>>>>>>>>>>>>               Get piContains_Or_Starts to liContains_Or_Starts
47081>>>>>>>>>>>>>               Move (Trim(lsperi))      to lsperi
47082>>>>>>>>>>>>>               Move (Trim(lscode))      to lscode
47083>>>>>>>>>>>>>               Move (Trim(lscodekat))   to lscodekat
47084>>>>>>>>>>>>>               Set Ordering to 4
47085>>>>>>>>>>>>>               If ((lsperi<>'') and (lscode<>'')) Begin
47087>>>>>>>>>>>>>                    Set Ordering to 4
47088>>>>>>>>>>>>>                    Constrain witemx as (fiPeriexei(Self)=1)
47089>>>>>>>>>>>>>               End
47089>>>>>>>>>>>>>>
47089>>>>>>>>>>>>>               Else Begin
47090>>>>>>>>>>>>>                  If (liContains_Or_Starts=0) Begin
47092>>>>>>>>>>>>>                        If (lsperi<>'') Begin
47094>>>>>>>>>>>>>                            Set Ordering to 3
47095>>>>>>>>>>>>>                            Constrain witemx.witemx_descr Contains lsperi
47097>>>>>>>>>>>>>                        End
47097>>>>>>>>>>>>>>
47097>>>>>>>>>>>>>                        Else If (lscode<>'') Begin
47100>>>>>>>>>>>>>                            Set Ordering to 4
47101>>>>>>>>>>>>>                            Constrain witemx.witemx_code Contains lscode
47103>>>>>>>>>>>>>                        End
47103>>>>>>>>>>>>>>
47103>>>>>>>>>>>>>                  End
47103>>>>>>>>>>>>>>
47103>>>>>>>>>>>>>                  Else Begin
47104>>>>>>>>>>>>>                        If (lsperi<>'') Begin
47106>>>>>>>>>>>>>                            Set Ordering to 3
47107>>>>>>>>>>>>>                            Constrain witemx as (fiArxizeiperi(Self)=1) //witemx.witemx_descr
47108>>>>>>>>>>>>>                        End
47108>>>>>>>>>>>>>>
47108>>>>>>>>>>>>>                        Else If (lscode<>'') Begin
47111>>>>>>>>>>>>>                            Set Ordering to 4
47112>>>>>>>>>>>>>                            Constrain witemx as (fiArxizeicode(Self)=1) //witemx.witemx_code
47113>>>>>>>>>>>>>                        End
47113>>>>>>>>>>>>>>
47113>>>>>>>>>>>>>                  End
47113>>>>>>>>>>>>>>
47113>>>>>>>>>>>>>                  If (lscodekat<>'') Begin
47115>>>>>>>>>>>>>                        Constrain witemx.witemkat_code Contains lscodekat
47117>>>>>>>>>>>>>                  End
47117>>>>>>>>>>>>>>
47117>>>>>>>>>>>>>               End
47117>>>>>>>>>>>>>>
47117>>>>>>>>>>>>>            End_Constraints
47120>>>>>>>>>>>>>            
47120>>>>>>>>>>>>>            
47120>>>>>>>>>>>>>            //AB-StoreEnd
47120>>>>>>>>>>>>>
47120>>>>>>>>>>>>>        End_Object    // Witemx_DD
47121>>>>>>>>>>>>>
47121>>>>>>>>>>>>>        Set Main_DD to (Witemx_DD(self))
47122>>>>>>>>>>>>>        Set Server to (Witemx_DD(self))
47123>>>>>>>>>>>>>
47123>>>>>>>>>>>>>        //AB-DDOEnd
47123>>>>>>>>>>>>>
47123>>>>>>>>>>>>>        Object oSelList is a dbListSub
47125>>>>>>>>>>>>>            Set Main_File to Witemx.File_Number
47126>>>>>>>>>>>>>            Set Ordering to 5
47127>>>>>>>>>>>>>            Set Size to 190 475
47128>>>>>>>>>>>>>            Set Location to 1 1
47129>>>>>>>>>>>>>            Set Color to 14280447
47130>>>>>>>>>>>>>            Set CurrentRowColor to 11783679
47131>>>>>>>>>>>>>            Set CurrentCellColor to 11783679
47132>>>>>>>>>>>>>            Set Auto_Index_State to FALSE
47133>>>>>>>>>>>>>
47133>>>>>>>>>>>>>            Begin_Row
47136>>>>>>>>>>>>>                Entry_Item Witemx.Witemx_code
47137>>>>>>>>>>>>>                Entry_Item Witemx.Witemx_descr
47138>>>>>>>>>>>>>                Entry_Item Witemx.Witemkat_code
47139>>>>>>>>>>>>>                Entry_Item Witemkat.Witemkat_descr
47140>>>>>>>>>>>>>                Entry_Item Item.Item_qual
47141>>>>>>>>>>>>>                Entry_Item Fpa.Fpa_pososto
47142>>>>>>>>>>>>>            End_Row
47147>>>>>>>>>>>>>
47147>>>>>>>>>>>>>            Set Form_Width    item 0 to 60
47148>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à›. „å›¦¬ª"
47149>>>>>>>>>>>>>            
47149>>>>>>>>>>>>>            Set Form_Width    item 1 to 140
47150>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
47151>>>>>>>>>>>>>            
47151>>>>>>>>>>>>>            Set Form_Width    item 2 to 70
47152>>>>>>>>>>>>>            Set Header_Label  item 2 to "‰à›. ‰˜«žš¦¨å˜ª"
47153>>>>>>>>>>>>>            
47153>>>>>>>>>>>>>            Set Form_Width    item 3 to 88
47154>>>>>>>>>>>>>            Set Header_Label  item 3 to "œ¨ š¨˜­ã ‰˜«žš."
47155>>>>>>>>>>>>>            
47155>>>>>>>>>>>>>            Set Form_Width    item 4 to 64
47156>>>>>>>>>>>>>            Set Header_Label  item 4 to "¦ æ«ž«˜"
47157>>>>>>>>>>>>>            
47157>>>>>>>>>>>>>            Set Form_Width    item 5 to 45
47158>>>>>>>>>>>>>            Set Header_Label  item 5 to "‰˜«.”..€"
47159>>>>>>>>>>>>>            
47159>>>>>>>>>>>>>
47159>>>>>>>>>>>>>            //AB-StoreStart
47159>>>>>>>>>>>>>            Property String Store_Fragma_Items public ""
47161>>>>>>>>>>>>>            set export_item_state to true
47162>>>>>>>>>>>>>            
47162>>>>>>>>>>>>>            Procedure End_Construct_Object
47164>>>>>>>>>>>>>                Forward Send End_Construct_Object
47166>>>>>>>>>>>>>                Set Color               to 14280447
47167>>>>>>>>>>>>>                Set CurrentRowColor     to 11783679
47168>>>>>>>>>>>>>                Set CurrentCellColor    to 11783679
47169>>>>>>>>>>>>>            End_Procedure
47170>>>>>>>>>>>>>            
47170>>>>>>>>>>>>>            Procedure Activating Returns Integer
47172>>>>>>>>>>>>>                Integer rVal
47173>>>>>>>>>>>>>                Forward Get Msg_Activating to rVal
47175>>>>>>>>>>>>>                set auto_index_state to true
47176>>>>>>>>>>>>>                Procedure_Return rVal
47177>>>>>>>>>>>>>            End_Procedure
47178>>>>>>>>>>>>>            
47178>>>>>>>>>>>>>            procedure move_value_out
47180>>>>>>>>>>>>>                forward send move_value_out
47182>>>>>>>>>>>>>                set value of (ocode(self)) to ''
47183>>>>>>>>>>>>>                set value of (operi(self)) to ''
47184>>>>>>>>>>>>>                set value of (ocodekat(self)) to ''
47185>>>>>>>>>>>>>                set psperi to ''
47186>>>>>>>>>>>>>                set pscode to ''
47187>>>>>>>>>>>>>                set pscodekat to ''
47188>>>>>>>>>>>>>            end_procedure
47189>>>>>>>>>>>>>            
47189>>>>>>>>>>>>>            
47189>>>>>>>>>>>>>            
47189>>>>>>>>>>>>>            
47189>>>>>>>>>>>>>            
47189>>>>>>>>>>>>>            
47189>>>>>>>>>>>>>            
47189>>>>>>>>>>>>>            
47189>>>>>>>>>>>>>            
47189>>>>>>>>>>>>>            //AB-StoreEnd
47189>>>>>>>>>>>>>
47189>>>>>>>>>>>>>        End_Object    // oSelList
47190>>>>>>>>>>>>>
47190>>>>>>>>>>>>>        Object TextBoxSub1 is a TextBoxSub
47192>>>>>>>>>>>>>            Set Label to "‘á¨à©ž ¡à› ¡¦ç š ˜"
47193>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
47194>>>>>>>>>>>>>            Set Location to 192 6
47195>>>>>>>>>>>>>            Set Size to 13 69
47196>>>>>>>>>>>>>        End_Object    // TextBoxSub1
47197>>>>>>>>>>>>>
47197>>>>>>>>>>>>>        Object ocode is a FormSub
47199>>>>>>>>>>>>>            Set Size to 13 197
47200>>>>>>>>>>>>>            Set Location to 192 79
47201>>>>>>>>>>>>>            Set Label_Col_Offset to 2
47202>>>>>>>>>>>>>
47202>>>>>>>>>>>>>            //AB-StoreStart
47202>>>>>>>>>>>>>            
47202>>>>>>>>>>>>>            
47202>>>>>>>>>>>>>            
47202>>>>>>>>>>>>>            
47202>>>>>>>>>>>>>            
47202>>>>>>>>>>>>>            
47202>>>>>>>>>>>>>            
47202>>>>>>>>>>>>>            
47202>>>>>>>>>>>>>            //AB-StoreEnd
47202>>>>>>>>>>>>>
47202>>>>>>>>>>>>>        End_Object    // ocode
47203>>>>>>>>>>>>>
47203>>>>>>>>>>>>>        Object TextBoxSub2 is a TextBoxSub
47205>>>>>>>>>>>>>            Set Label to "‘á¨à©ž §œ¨ š¨˜­ãª "
47206>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
47207>>>>>>>>>>>>>            Set Location to 207 6
47208>>>>>>>>>>>>>            Set Size to 13 71
47209>>>>>>>>>>>>>        End_Object    // TextBoxSub2
47210>>>>>>>>>>>>>
47210>>>>>>>>>>>>>        Object operi is a FormSub
47212>>>>>>>>>>>>>            Set Size to 13 197
47213>>>>>>>>>>>>>            Set Location to 207 79
47214>>>>>>>>>>>>>            Set Label_Col_Offset to 2
47215>>>>>>>>>>>>>
47215>>>>>>>>>>>>>            //AB-StoreStart
47215>>>>>>>>>>>>>            
47215>>>>>>>>>>>>>            
47215>>>>>>>>>>>>>            
47215>>>>>>>>>>>>>            
47215>>>>>>>>>>>>>            
47215>>>>>>>>>>>>>            
47215>>>>>>>>>>>>>            
47215>>>>>>>>>>>>>            //AB-StoreEnd
47215>>>>>>>>>>>>>
47215>>>>>>>>>>>>>        End_Object    // operi
47216>>>>>>>>>>>>>
47216>>>>>>>>>>>>>        Object RadioGroupSub1 is a RadioGroupSub
47218>>>>>>>>>>>>>            Set Size to 32 77
47219>>>>>>>>>>>>>            Set Location to 191 279
47220>>>>>>>>>>>>>            Object Radio1 is a RadioSub
47222>>>>>>>>>>>>>                Set Label to "œ¨ â®œ«˜ "
47223>>>>>>>>>>>>>                Set Size to 10 53
47224>>>>>>>>>>>>>                Set Location to 7 5
47225>>>>>>>>>>>>>            End_Object    // Radio1
47226>>>>>>>>>>>>>
47226>>>>>>>>>>>>>            Object Radio2 is a RadioSub
47228>>>>>>>>>>>>>                Set Label to "€¨®åœ  €§¦"
47229>>>>>>>>>>>>>                Set Size to 10 52
47230>>>>>>>>>>>>>                Set Location to 21 5
47231>>>>>>>>>>>>>            End_Object    // Radio2
47232>>>>>>>>>>>>>
47232>>>>>>>>>>>>>
47232>>>>>>>>>>>>>            //AB-StoreStart
47232>>>>>>>>>>>>>            
47232>>>>>>>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
47234>>>>>>>>>>>>>                Set piContains_Or_Starts to iToItem
47235>>>>>>>>>>>>>            End_Procedure
47236>>>>>>>>>>>>>            
47236>>>>>>>>>>>>>            
47236>>>>>>>>>>>>>            
47236>>>>>>>>>>>>>            
47236>>>>>>>>>>>>>            
47236>>>>>>>>>>>>>            //AB-StoreEnd
47236>>>>>>>>>>>>>
47236>>>>>>>>>>>>>        End_Object    // RadioGroupSub1
47237>>>>>>>>>>>>>
47237>>>>>>>>>>>>>        Object ButtonSub1 is a ButtonSub
47239>>>>>>>>>>>>>            Set Label to "œ¨ æ¨ ©œ"
47240>>>>>>>>>>>>>            Set Size to 15 197
47241>>>>>>>>>>>>>            Set Location to 236 79
47242>>>>>>>>>>>>>            Set Form_FontWeight Item 0 to 800
47243>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
47244>>>>>>>>>>>>>
47244>>>>>>>>>>>>>            //AB-StoreStart
47244>>>>>>>>>>>>>            
47244>>>>>>>>>>>>>            Procedure OnClick
47246>>>>>>>>>>>>>                Forward Send OnClick
47248>>>>>>>>>>>>>                Set pscode      to (Value(ocode(Self),0))
47249>>>>>>>>>>>>>                Set psperi      to (Value(operi(Self),0))
47250>>>>>>>>>>>>>                Set pscodekat   to (Value(ocodekat(Self),0))
47251>>>>>>>>>>>>>                send Rebuild_Constraints    to (witemx_DD(Self))
47252>>>>>>>>>>>>>                Send Beginning_Of_Data      to oSelList True
47253>>>>>>>>>>>>>            End_Procedure // OnClick
47254>>>>>>>>>>>>>            
47254>>>>>>>>>>>>>            
47254>>>>>>>>>>>>>            //AB-StoreEnd
47254>>>>>>>>>>>>>
47254>>>>>>>>>>>>>        End_Object    // ButtonSub1
47255>>>>>>>>>>>>>
47255>>>>>>>>>>>>>        Object TextBoxSub3 is a TextBoxSub
47257>>>>>>>>>>>>>            Set Label to "‰à›. ¡˜«žš¦¨å˜ª š ˜"
47258>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
47259>>>>>>>>>>>>>            Set Location to 221 5
47260>>>>>>>>>>>>>            Set Size to 13 70
47261>>>>>>>>>>>>>        End_Object    // TextBoxSub3
47262>>>>>>>>>>>>>
47262>>>>>>>>>>>>>        Object ocodekat is a FormSub
47264>>>>>>>>>>>>>            Set Size to 13 197
47265>>>>>>>>>>>>>            Set Location to 221 79
47266>>>>>>>>>>>>>            Set Label_Col_Offset to 2
47267>>>>>>>>>>>>>
47267>>>>>>>>>>>>>            //AB-StoreStart
47267>>>>>>>>>>>>>            
47267>>>>>>>>>>>>>            
47267>>>>>>>>>>>>>            
47267>>>>>>>>>>>>>            
47267>>>>>>>>>>>>>            
47267>>>>>>>>>>>>>            
47267>>>>>>>>>>>>>            
47267>>>>>>>>>>>>>            //AB-StoreEnd
47267>>>>>>>>>>>>>
47267>>>>>>>>>>>>>        End_Object    // ocodekat
47268>>>>>>>>>>>>>
47268>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
47270>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
47271>>>>>>>>>>>>>            Set Location to 232 318
47272>>>>>>>>>>>>>
47272>>>>>>>>>>>>>            //AB-StoreStart
47272>>>>>>>>>>>>>            Procedure OnClick
47274>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
47275>>>>>>>>>>>>>            End_Procedure
47276>>>>>>>>>>>>>            //AB-StoreEnd
47276>>>>>>>>>>>>>
47276>>>>>>>>>>>>>        End_Object    // oOK_bn
47277>>>>>>>>>>>>>
47277>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
47279>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
47280>>>>>>>>>>>>>            Set Location to 232 373
47281>>>>>>>>>>>>>
47281>>>>>>>>>>>>>            //AB-StoreStart
47281>>>>>>>>>>>>>            Procedure OnClick
47283>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
47284>>>>>>>>>>>>>            End_Procedure
47285>>>>>>>>>>>>>            //AB-StoreEnd
47285>>>>>>>>>>>>>
47285>>>>>>>>>>>>>        End_Object    // oCancel_bn
47286>>>>>>>>>>>>>
47286>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
47288>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
47289>>>>>>>>>>>>>            Set Location to 232 428
47290>>>>>>>>>>>>>
47290>>>>>>>>>>>>>            //AB-StoreStart
47290>>>>>>>>>>>>>            Procedure OnClick
47292>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
47293>>>>>>>>>>>>>            End_Procedure
47294>>>>>>>>>>>>>            //AB-StoreEnd
47294>>>>>>>>>>>>>
47294>>>>>>>>>>>>>        End_Object    // oSearch_bn
47295>>>>>>>>>>>>>
47295>>>>>>>>>>>>>        Object btnwitemcl is a ButtonSub
47297>>>>>>>>>>>>>
47297>>>>>>>>>>>>>            //AB-StoreTopStart
47297>>>>>>>>>>>>>            
47297>>>>>>>>>>>>>            //AB-StoreTopEnd
47297>>>>>>>>>>>>>
47297>>>>>>>>>>>>>            Set Label to "ButtonSub1"
47298>>>>>>>>>>>>>            Set Bitmap to "Filesys3.bmp"
47299>>>>>>>>>>>>>            Set Size to 22 25
47300>>>>>>>>>>>>>            Set Location to 196 443
47301>>>>>>>>>>>>>            Set Focus_Mode to Pointer_Only
47302>>>>>>>>>>>>>
47302>>>>>>>>>>>>>            //AB-StoreStart
47302>>>>>>>>>>>>>            
47302>>>>>>>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ œ¬¨œ«ã¨ ¦ „ ›é¤ / ¨¦£žŸœ¬«ã"
47303>>>>>>>>>>>>>            
47303>>>>>>>>>>>>>            Procedure OnClick
47305>>>>>>>>>>>>>                String  scode speri
47306>>>>>>>>>>>>>                Get value of (ocode(self)) to scode
47307>>>>>>>>>>>>>                Get value of (operi(self)) to speri
47308>>>>>>>>>>>>>                set pscode of (dg186(self)) to scode
47309>>>>>>>>>>>>>                set psperi of (dg186(self)) to speri
47310>>>>>>>>>>>>>               Send popup_modal to (dg186(self))
47311>>>>>>>>>>>>>            End_Procedure // OnClick
47312>>>>>>>>>>>>>            
47312>>>>>>>>>>>>>            
47312>>>>>>>>>>>>>            
47312>>>>>>>>>>>>>            
47312>>>>>>>>>>>>>            
47312>>>>>>>>>>>>>            
47312>>>>>>>>>>>>>            
47312>>>>>>>>>>>>>            
47312>>>>>>>>>>>>>            
47312>>>>>>>>>>>>>            
47312>>>>>>>>>>>>>            
47312>>>>>>>>>>>>>            
47312>>>>>>>>>>>>>            
47312>>>>>>>>>>>>>            
47312>>>>>>>>>>>>>            
47312>>>>>>>>>>>>>            
47312>>>>>>>>>>>>>            
47312>>>>>>>>>>>>>            
47312>>>>>>>>>>>>>            
47312>>>>>>>>>>>>>            
47312>>>>>>>>>>>>>            
47312>>>>>>>>>>>>>            
47312>>>>>>>>>>>>>            
47312>>>>>>>>>>>>>            //AB-StoreEnd
47312>>>>>>>>>>>>>
47312>>>>>>>>>>>>>        End_Object    // btnwitemcl
47313>>>>>>>>>>>>>
47313>>>>>>>>>>>>>
47313>>>>>>>>>>>>>        //AB-StoreStart
47313>>>>>>>>>>>>>                
47313>>>>>>>>>>>>>        Set Locate_Mode to Center_On_Screen
47314>>>>>>>>>>>>>        
47314>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
47315>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
47316>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
47317>>>>>>>>>>>>>        
47317>>>>>>>>>>>>>        Procedure Activate
47319>>>>>>>>>>>>>            Send Rebuild_Constraints    to Witemx_DD
47320>>>>>>>>>>>>>            Send Beginning_Of_Data      to oSelList True
47321>>>>>>>>>>>>>            Forward Send Activate
47323>>>>>>>>>>>>>        End_Procedure
47324>>>>>>>>>>>>>        
47324>>>>>>>>>>>>>        procedure request_cancel
47326>>>>>>>>>>>>>            forward send request_cancel
47328>>>>>>>>>>>>>            set value of (ocode(self)) to ''
47329>>>>>>>>>>>>>            set value of (operi(self)) to ''
47330>>>>>>>>>>>>>            set value of (ocodekat(self)) to ''
47331>>>>>>>>>>>>>            Set psperi  to ''
47332>>>>>>>>>>>>>            Set pscode  to ''
47333>>>>>>>>>>>>>            Set pscodekat TO ''
47334>>>>>>>>>>>>>        end_procedure
47335>>>>>>>>>>>>>        
47335>>>>>>>>>>>>>        
47335>>>>>>>>>>>>>        
47335>>>>>>>>>>>>>        
47335>>>>>>>>>>>>>        
47335>>>>>>>>>>>>>        
47335>>>>>>>>>>>>>        
47335>>>>>>>>>>>>>        
47335>>>>>>>>>>>>>        
47335>>>>>>>>>>>>>        //AB-StoreEnd
47335>>>>>>>>>>>>>
47335>>>>>>>>>>>>>    End_Object    // SL17
47336>>>>>>>>>>>>>
47336>>>>>>>>>>>>>
47336>>>>>>>>>>>>>    //AB-StoreStart
47336>>>>>>>>>>>>>    
47336>>>>>>>>>>>>>    
47336>>>>>>>>>>>>>    
47336>>>>>>>>>>>>>    
47336>>>>>>>>>>>>>    
47336>>>>>>>>>>>>>    
47336>>>>>>>>>>>>>    
47336>>>>>>>>>>>>>    
47336>>>>>>>>>>>>>    
47336>>>>>>>>>>>>>    
47336>>>>>>>>>>>>>    
47336>>>>>>>>>>>>>    
47336>>>>>>>>>>>>>    //AB-StoreEnd
47336>>>>>>>>>>>>>
47336>>>>>>>>>>>>>//AB/     End_Object    // prj
47336>>>>>>>>>>>
47336>>>>>>>>>>>//DDB-Selection-pkg-End
47336>>>>>>>>>>>//DDB-FileEnd
47336>>>>>>>>>    Use PMOVES.DD
INCLUDING FILE: PMOVES.DD
47336>>>>>>>>>>>//DDB-FileStart
47336>>>>>>>>>>>//DDB-HeaderStart
47336>>>>>>>>>>>
47336>>>>>>>>>>>// File Name : PMOVES.DD
47336>>>>>>>>>>>// Class Name: Pmoves_DataDictionary
47336>>>>>>>>>>>// Revision  : 157
47336>>>>>>>>>>>// Version   : 2
47336>>>>>>>>>>>
47336>>>>>>>>>>>Use  Windows           // Basic Definitions
47336>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
47336>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
47336>>>>>>>>>>>
47336>>>>>>>>>>>Open Pmoves
47338>>>>>>>>>>>Open Pmsdtl
INCLUDING FILE: PMSDTL.FD
47340>>>>>>>>>>>Open Pmssxet
47342>>>>>>>>>>>Open Wax
47344>>>>>>>>>>>Open Witemx
47346>>>>>>>>>>>Open Particle
47348>>>>>>>>>>>Open Sysrecp
47350>>>>>>>>>>>Open Syscurxr
47352>>>>>>>>>>>Open Partlfpa
47354>>>>>>>>>>>Open Clorder
47356>>>>>>>>>>>Open Clorderd
47358>>>>>>>>>>>Open Btnemp
INCLUDING FILE: BTNEMP.FD
47360>>>>>>>>>>>Open Gmove
47362>>>>>>>>>>>Open Sysrecg
47364>>>>>>>>>>>
47364>>>>>>>>>>>//DDB-HeaderEnd
47364>>>>>>>>>>>Open Fpa
47366>>>>>>>>>>>Open PartlFpa
47368>>>>>>>>>>>Open Item
47370>>>>>>>>>>>Open Wtypkin
47372>>>>>>>>>>>Open Witemkat
47374>>>>>>>>>>>Open Wapomast
47376>>>>>>>>>>>Open Wapokat
47378>>>>>>>>>>>Open Payresp
47380>>>>>>>>>>>
47380>>>>>>>>>>>Class Pmoves_DataDictionary  is a DataDictionary_Sec
47381>>>>>>>>>>>
47381>>>>>>>>>>>
47381>>>>>>>>>>>    Procedure Construct_Object
47382>>>>>>>>>>>        Forward Send Construct_Object
47384>>>>>>>>>>>        Property Number  pnoQty         Public  0
47385>>>>>>>>>>>        Property integer pifromclorder  Public  0
47386>>>>>>>>>>>        Property Integer piCheckZeroFpa Public  0
47387>>>>>>>>>>>        Property Integer piPmsSxetID    Public  0
47388>>>>>>>>>>>        Property integer piFromMetasx   Public  0
47389>>>>>>>>>>>        Property String  psOldItem      Public ''        
47390>>>>>>>>>>>        //------------------------------------------------
47390>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
47390>>>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
47390>>>>>>>>>>>        // einai 1     js 03/12/2007
47390>>>>>>>>>>>        //------------------------------------------------  
47390>>>>>>>>>>>        Property Integer piCreateNew            Public  0
47391>>>>>>>>>>>        Property String  psAud_Old_Pelaths      Public ""
47392>>>>>>>>>>>        Property String  psAud_Old_PelathsN     Public ""
47393>>>>>>>>>>>        Property String  psAud_Old_Ergo         Public ""
47394>>>>>>>>>>>        Property String  psAud_Old_Poiothta     Public ""
47395>>>>>>>>>>>        Property String  psAud_Old_Eidos        Public ""
47396>>>>>>>>>>>
47396>>>>>>>>>>>        Property String  psAud_Old_Zonh         Public ""
47397>>>>>>>>>>>        Property String  psAud_Old_Antlia       Public ""
47398>>>>>>>>>>>        Property String  psAud_Old_Oxhma        Public ""
47399>>>>>>>>>>>
47399>>>>>>>>>>>        Property Number  pnAud_Old_Qty          Public  0
47400>>>>>>>>>>>        Property Number  pnAud_Old_Timh         Public  0
47401>>>>>>>>>>>        Property String  psAud_Old_PartlRecr    Public ""
47402>>>>>>>>>>>        Property String  psAud_Old_PmsRecr      Public ""
47403>>>>>>>>>>>        Property String  psAud_Old_Module       Public ""
47404>>>>>>>>>>>        Property String  psAud_Old_Parast       Public ""
47405>>>>>>>>>>>        Property String  psAud_Old_Seira        Public ""
47406>>>>>>>>>>>        Property Date    pdAud_Old_Hmnia        Public ""  
47407>>>>>>>>>>>        Property Integer piAud_Old_No           Public  0
47408>>>>>>>>>>>        //------------------------------------------------
47408>>>>>>>>>>>    End_Procedure
47409>>>>>>>>>>>
47409>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
47410>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
47412>>>>>>>>>>>        Set pnoQty      to Pmoves.Pms_Qty
47413>>>>>>>>>>>        Set psOldItem   to Item.Item_Code           
47414>>>>>>>>>>>        //------------------------------------------------
47414>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
47414>>>>>>>>>>>        // ton pedion js 03/12/2007
47414>>>>>>>>>>>        //------------------------------------------------
47414>>>>>>>>>>>        Set psAud_Old_Pelaths       to Pmoves.Client_ID
47415>>>>>>>>>>>        Set psAud_Old_PelathsN      to Clients.Client_Name
47416>>>>>>>>>>>        Set psAud_Old_Ergo          to Pmoves.CN_Code
47417>>>>>>>>>>>        Set psAud_Old_Eidos         to Pmoves.Witemx_Code   
47418>>>>>>>>>>>        Set psAud_Old_Poiothta      to Item.Item_Qual 
47419>>>>>>>>>>>        Set pnAud_Old_Qty           to Pmoves.Pms_Qty 
47420>>>>>>>>>>>        Set pnAud_Old_Timh          to Pmoves.Pms_UnitPrice 
47421>>>>>>>>>>>        Set psAud_Old_PartlRecr     to Pmoves.Partl_Recr 
47422>>>>>>>>>>>        Set psAud_Old_PmsRecr       to Pmoves.Pms_Recr 
47423>>>>>>>>>>>        Set psAud_Old_Module        to Particle.Partl_Module
47424>>>>>>>>>>>        Set psAud_Old_Zonh          to Pmoves.Zone
47425>>>>>>>>>>>        Set psAud_Old_Antlia        to Pmoves.Pump_ID
47426>>>>>>>>>>>        Set psAud_Old_Oxhma         to Pmoves.Car_ID
47427>>>>>>>>>>>        Set psAud_Old_Parast        to Ptyppar.Ptyppar_Code
47428>>>>>>>>>>>        Set psAud_Old_Seira         to Particle.Pseira_Seira
47429>>>>>>>>>>>        Set pdAud_Old_Hmnia         to Particle.Partl_Hmnia
47430>>>>>>>>>>>        Set piAud_Old_No            to Particle.Partl_No
47431>>>>>>>>>>>        //------------------------------------------------
47431>>>>>>>>>>>    End_Procedure   // New_Current_Record
47432>>>>>>>>>>>
47432>>>>>>>>>>>
47432>>>>>>>>>>>    // Delete_Main_File:
47432>>>>>>>>>>>    Procedure Delete_Main_File
47433>>>>>>>>>>>        clear btnemp
47434>>>>>>>>>>>        move pmoves.pms_recr to btnemp.pms_recr
47435>>>>>>>>>>>        find ge btnemp by index.11
47436>>>>>>>>>>>>
47436>>>>>>>>>>>        if ((found=1) and (pmoves.pms_recr=btnemp.pms_recr)) begin
47438>>>>>>>>>>>           move 0 to btnemp.pms_recr
47439>>>>>>>>>>>           saverecord btnemp
47440>>>>>>>>>>>        end                             
47440>>>>>>>>>>>>
47440>>>>>>>>>>>
47440>>>>>>>>>>>        //---------------------------------------------
47440>>>>>>>>>>>        // Auditing / Katagrafh allagon
47440>>>>>>>>>>>        //OPERATION_MODE       OPERATION_ORIGIN
47440>>>>>>>>>>>            //MODE_WAITING  
47440>>>>>>>>>>>            //MODE_FINDING  
47440>>>>>>>>>>>            //MODE_CLEARING 
47440>>>>>>>>>>>            //MODE_CREATING 
47440>>>>>>>>>>>            //MODE_SAVING   
47440>>>>>>>>>>>            //MODE_DELETING 
47440>>>>>>>>>>>            //MODE_ABORTING 
47440>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
47441>>>>>>>>>>>        Date    dDate  Shmer 
47441>>>>>>>>>>>        Integer iMin iHour iSec iLen
47441>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
47445>>>>>>>>>>>        Move iHour  to sHour
47446>>>>>>>>>>>        Move iMin   to sMin
47447>>>>>>>>>>>        Move iSec   to sSec
47448>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
47452>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
47456>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
47460>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
47461>>>>>>>>>>>        
47461>>>>>>>>>>>        // Auditing / Diagrafh - Diorthosh
47461>>>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING)) Begin
47463>>>>>>>>>>>            Get fsLoginUserID to sUser
47464>>>>>>>>>>>
47464>>>>>>>>>>>            clear gmove
47465>>>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
47466>>>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
47467>>>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
47468>>>>>>>>>>>            move  1                     to gmove.gtypkin_code// Apo Parastatika
47469>>>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
47470>>>>>>>>>>>            move pmoves.partl_no        to gmove.garticl_no
47471>>>>>>>>>>>            move Particle.CN_Code       to gmove.gplan_recr
47472>>>>>>>>>>>            move suser                  to gmove.gplan_code
47473>>>>>>>>>>>            move pmoves.pms_recr        to gmove.garticl_recr
47474>>>>>>>>>>>            reread sysrecg
47478>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
47479>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
47480>>>>>>>>>>>            saverecord sysrecg
47481>>>>>>>>>>>            unlock
47482>>>>>>>>>>>>
47482>>>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                        to Gmove.Gmove_Recr
47483>>>>>>>>>>>
47483>>>>>>>>>>>            Move (psAud_Old_Module(Self))       to Gmove.Module
47484>>>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
47485>>>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
47486>>>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
47487>>>>>>>>>>>            Move (psAud_Old_Pelaths (Self))     to Gmove.Prev_ID
47488>>>>>>>>>>>            Move (psAud_Old_PelathsN(Self))     to Gmove.Prev_Name
47489>>>>>>>>>>>            Move (psAud_Old_Ergo     (Self))    to Gmove.Prev_CN
47490>>>>>>>>>>>            Move (psAud_Old_Eidos    (Self))    to Gmove.Prev_Item
47491>>>>>>>>>>>            Move (psAud_Old_Poiothta (Self))    to Gmove.Prev_Qual 
47492>>>>>>>>>>>            Move (pnAud_Old_Qty      (Self))    to Gmove.Prev_M3 
47493>>>>>>>>>>>            Move (pnAud_Old_Timh     (Self))    to Gmove.Prev_UnitPrice
47494>>>>>>>>>>>            Move (psAud_Old_PartlRecr(Self))    to Gmove.Partl_Recr 
47495>>>>>>>>>>>            Move (psAud_Old_PmsRecr  (Self))    to Gmove.Pms_Recr  
47496>>>>>>>>>>>            Move (psAud_Old_Zonh     (Self))    to Gmove.Prev_Zonh
47497>>>>>>>>>>>            Move (psAud_Old_Antlia   (Self))    to Gmove.Prev_Antlia
47498>>>>>>>>>>>            Move (psAud_Old_Oxhma    (Self))    to Gmove.Prev_Oxhma
47499>>>>>>>>>>>            Move (psAud_Old_Parast   (Self))    to Gmove.Prev_Parast
47500>>>>>>>>>>>            Move (psAud_Old_Seira    (Self))    to Gmove.Prev_Seira
47501>>>>>>>>>>>            Move (pdAud_Old_Hmnia    (Self))    to Gmove.Prev_Hmnia
47502>>>>>>>>>>>            Move (piAud_Old_No       (Self))    to Gmove.Prev_No
47503>>>>>>>>>>>            Move "ƒ ˜š¨˜­ã š¨˜££ãª  ˜¨˜©«˜« ¡¦ç)" to sText
47504>>>>>>>>>>>            Move "D" to Gmove.Eidos_Metabolhs
47505>>>>>>>>>>>            move (trim(stext))          to gmove.gmove_aitiol
47506>>>>>>>>>>>            Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                to Gmove.Txt1
47507>>>>>>>>>>>            saverecord gmove
47508>>>>>>>>>>>        End
47508>>>>>>>>>>>>
47508>>>>>>>>>>>
47508>>>>>>>>>>>        Forward Send Delete_Main_File
47510>>>>>>>>>>>        // Insert Code Here
47510>>>>>>>>>>>    End_Procedure   // Delete_Main_File
47511>>>>>>>>>>>                      
47511>>>>>>>>>>>
47511>>>>>>>>>>>    Procedure Save_Main_File
47512>>>>>>>>>>>        Integer iYes
47513>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
47515>>>>>>>>>>>            If Pmoves.Recnum Eq 0 Procedure_Return
47518>>>>>>>>>>>        End
47518>>>>>>>>>>>>
47518>>>>>>>>>>>
47518>>>>>>>>>>>        If ((Operation_Origin=Self) And (piCheckZeroFpa(Self))) Begin
47520>>>>>>>>>>>            // Elegxos FPA
47520>>>>>>>>>>>            // An typonei otidhpote ektos apo 1 (mono Posothtes)
47520>>>>>>>>>>>            If ((Ptyppar.Ti_Typonei_Pms<>'1')   And ;                (Pmoves.Pms_Vatam=0)            And ;                (Operation_Mode<>MODE_DELETING)) Begin
47522>>>>>>>>>>>                Move (YesNo_Box("¦©æ ”€ £ž›œ¤ ¡æ. Œ˜ ©¬¤œ®å©à ;", ;                                     "¨¦©¦®ã",  MB_DEFBUTTON2) ) to iYes
47523>>>>>>>>>>>                If (iYes=MBR_NO)  Send Operation_Not_Allowed 8000
47526>>>>>>>>>>>            End
47526>>>>>>>>>>>>
47526>>>>>>>>>>>        End
47526>>>>>>>>>>>>
47526>>>>>>>>>>>        Forward Send Save_Main_File
47528>>>>>>>>>>>    End_Procedure
47529>>>>>>>>>>>
47529>>>>>>>>>>>    Function fnTeleytaiaTimh Returns Number
47530>>>>>>>>>>>        Number  rVal nQty
47531>>>>>>>>>>>        String  sClientID sWitemxCode
47531>>>>>>>>>>>        Date    dHmnia
47531>>>>>>>>>>>        String  sWhat sRecr sClientCode sItemCode sCN
47531>>>>>>>>>>>
47531>>>>>>>>>>>        Get File_Field_Current_Value File_Field Ptyppar.Ptyppar_Is_What to sWhat
47532>>>>>>>>>>>        If (Trim(sWhat)='1') Begin
47534>>>>>>>>>>>            // 1=€š¦¨œª
47534>>>>>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Recr      to sRecr
47535>>>>>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Qty          to nQty
47536>>>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Hmnia    to dHmnia
47537>>>>>>>>>>>            Get File_Field_Current_Value File_Field Item.Item_Code          to sItemCode
47538>>>>>>>>>>>            Get File_Field_Current_Value File_Field Clients.Client_ID       to sClientCode
47539>>>>>>>>>>>            // Sto arxeio Globals.inc
47539>>>>>>>>>>>            Get fnTeleytaiaTimhAgoras sClientCode sItemCode dHmnia nQty to rVal
47540>>>>>>>>>>>        End
47540>>>>>>>>>>>>
47540>>>>>>>>>>>        Else If (Trim(sWhat)='2') Begin
47543>>>>>>>>>>>            // 2=à¢ã©œ ª
47543>>>>>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Qty          to nQty
47544>>>>>>>>>>>            Get File_Field_Current_Value File_Field Item.Item_Code          to sItemCode
47545>>>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Hmnia    to dHmnia
47546>>>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Cn_Code        to sCN
47547>>>>>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Recr      to sRecr
47548>>>>>>>>>>>            Get File_Field_Current_Value File_Field Clients.Client_ID       to sClientID
47549>>>>>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Code      to sWitemxCode
47550>>>>>>>>>>>            // Sto arxeio Globals.inc
47550>>>>>>>>>>>            Get fnTeleytaiaTimhPolhshs sRecr sClientID sWitemxCode dHmnia sItemCode nQty sCN to rVal
47551>>>>>>>>>>>        End
47551>>>>>>>>>>>>
47551>>>>>>>>>>>        Function_Return rVal
47552>>>>>>>>>>>    End_Function
47553>>>>>>>>>>>
47553>>>>>>>>>>>    Procedure Creating
47554>>>>>>>>>>>        Forward Send Creating
47556>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Pmoves.Pms_Rec0)))))) to Pmoves.Pms_Recr
47557>>>>>>>>>>>        Set piCreateNew to 1
47558>>>>>>>>>>>    End_Procedure   // Creating
47559>>>>>>>>>>>
47559>>>>>>>>>>>    Procedure Update
47560>>>>>>>>>>>        Integer iDecimals
47561>>>>>>>>>>>        Number  nInt nFpaOnTotal
47561>>>>>>>>>>>        String  sCurrentUser
47561>>>>>>>>>>>
47561>>>>>>>>>>>        Forward Send Update
47563>>>>>>>>>>>
47563>>>>>>>>>>>        Move SysCurXR.Company_Code                          to Pmoves.Company_Code
47564>>>>>>>>>>>        Move SysCurXR.Branch_Code                           to Pmoves.Branch_Code
47565>>>>>>>>>>>        Move SysCurXR.Year_Year                             to Pmoves.Year_Year
47566>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code                           to Pmoves.Ctypkin_Code
47567>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code                           to Pmoves.Wtypkin_Code
47568>>>>>>>>>>>
47568>>>>>>>>>>>        Move Witemkat.Witemkat_Code                         to Pmoves.Witemkat_Code
47569>>>>>>>>>>>        Move Item.Item_Code                                 to Pmoves.Item_Code
47570>>>>>>>>>>>        Move Witemx.Witemx_Code                             to Pmoves.Witemx_Code
47571>>>>>>>>>>>        Move Wapokat.Wapokat_Code                           to Pmoves.Wapokat_Code
47572>>>>>>>>>>>        Move Wapomast.Wapomast_Code                         to Pmoves.Wapomast_Code
47573>>>>>>>>>>>        Move Wax.Wax_Code                                   to Pmoves.Wax_Code
47574>>>>>>>>>>>
47574>>>>>>>>>>>        //Move Custprom.Custprom_Code                         to Pmoves.Custprom_Code
47574>>>>>>>>>>>        Move Clients.Client_ID                              to Pmoves.Client_ID
47575>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code                           to Pmoves.Ptyppar_Code
47576>>>>>>>>>>>        Move Ptyppar.TI_TYPONEI_PMS                         to Pmoves.TI_TYPONEI_PMS
47577>>>>>>>>>>>        Move Particle.PSeira_Seira                          to Pmoves.Pseira_Seira
47578>>>>>>>>>>>
47578>>>>>>>>>>>        Move Nomisma.Nomisma_Code                           to Pmoves.Pms_Sc_Code2
47579>>>>>>>>>>>        Move Nomisma.Dekadika                               To iDecimals
47580>>>>>>>>>>>
47580>>>>>>>>>>>        Move Particle.CN_Code                               to Pmoves.CN_Code
47581>>>>>>>>>>>        Move Particle.Partl_No                              to Pmoves.Partl_No
47582>>>>>>>>>>>        Move Particle.Partl_Hmnia                           to Pmoves.Partl_Hmnia
47583>>>>>>>>>>>        Move Particle.Partl_Module                          to Pmoves.Pms_Module
47584>>>>>>>>>>>        Move Particle.Partl_Rec0                            to Pmoves.Partl_Rec0
47585>>>>>>>>>>>
47585>>>>>>>>>>>        Move Particle.Sls_ID                                to Pmoves.Sls_ID
47586>>>>>>>>>>>        Move Particle.Presp_ID                              to Pmoves.Presp_ID
47587>>>>>>>>>>>        Move Particle.Cnt_ID                                to Pmoves.Cnt_ID
47588>>>>>>>>>>>        Move Item.Units_Code                                to Pmoves.Pms_UnitCode
47589>>>>>>>>>>>        move witemx.witemx_descr                            to pmoves.witemx_descr
47590>>>>>>>>>>>        move ptyppar.ptyppar_descr                          to pmoves.ptyppar_descr
47591>>>>>>>>>>>        move clients.client_name                            to pmoves.client_name
47592>>>>>>>>>>>
47592>>>>>>>>>>>        if (Trim(pmoves.pump_id)='') ;            move particle.antlia_code                       to pmoves.pump_id
47595>>>>>>>>>>>        If (Trim(pmoves.car_id)='') ;            move particle.oxhma_code                        to pmoves.car_id
47598>>>>>>>>>>>        If (Trim(pmoves.zone)='') ;            move particle.zone_id                           to pmoves.zone
47601>>>>>>>>>>>
47601>>>>>>>>>>>      //  if (particle.zone_id='') move pmoves.zone           to particle.zone_id
47601>>>>>>>>>>>      //  else move particle.Zone_ID                          to pmoves.Zone
47601>>>>>>>>>>>
47601>>>>>>>>>>>        Move (Pmoves.Pms_Qty-Pmoves.Timol_Qty)              to Pmoves.Timol_Ypol
47602>>>>>>>>>>>
47602>>>>>>>>>>>        Move (Pmoves.Qty_Kinhshs>0)                         to Pmoves.pms_Selected
47603>>>>>>>>>>>
47603>>>>>>>>>>>        Move (Round_Number((Pmoves.Pms_Qty*Pmoves.Pms_UnitPrice),iDecimals))    ;                                                            to Pmoves.Pms_Ambd
47604>>>>>>>>>>>
47604>>>>>>>>>>>        If (Pmoves.Pms_PctDisc<>0) ;            Move (Round_Number((Pmoves.Pms_Ambd*Pmoves.Pms_PctDisc/100),iDecimals)) ;                                                            to Pmoves.Pms_Discam
47607>>>>>>>>>>>        Else ;            Move (Round_Number( ((Pmoves.Pms_Discam/Pmoves.Pms_Ambd)*100),iDecimals)) ;                                                            to Pmoves.Pms_PctDisc
47609>>>>>>>>>>>
47609>>>>>>>>>>>        Move (Pmoves.Pms_Ambd-Pmoves.Pms_Discam)            to Pmoves.Pms_Amaftdisc
47610>>>>>>>>>>>
47610>>>>>>>>>>>        Move (Round_Number((Pmoves.Pms_Amaftdisc*Pmoves.Pms_Vatpct/100),iDecimals));                                                            to Pmoves.Pms_Vatam
47611>>>>>>>>>>>        Move (Pmoves.Pms_Amaftdisc+Pmoves.Pms_Vatam)        to Pmoves.Pms_Payable
47612>>>>>>>>>>>        Move Pmoves.Pms_Payable                             to Pmoves.Pms_Axia
47613>>>>>>>>>>>
47613>>>>>>>>>>>        Add Pmoves.Pms_Qty                                  to Particle.Partl_TotTem
47614>>>>>>>>>>>        Add Pmoves.Timol_Qty                                to Particle.Timol_Qty
47615>>>>>>>>>>>
47615>>>>>>>>>>>        Add Pmoves.Pms_Ambd                                 to Particle.Partl_TotAmBD
47616>>>>>>>>>>>        Add Pmoves.Pms_DiscAm                               to Particle.Partl_AMDISCPMS
47617>>>>>>>>>>>        Add Pmoves.Pms_Amaftdisc                            to Particle.Partl_TotAmAd
47618>>>>>>>>>>>        Add 1                                               to Particle.Partl_NoOfLines
47619>>>>>>>>>>>
47619>>>>>>>>>>>        // An einai parastatiko polhshs kai to ptyppar einai flagarismeno oti
47619>>>>>>>>>>>        // prepei na enhmerosh to pedio Clients.Posa_apo_dap
47619>>>>>>>>>>>        // tote theoroume oti ypoxreotika prepei na vroume timh apo
47619>>>>>>>>>>>        // function timokatalogon kai na thn krathsoume sto pedio
47619>>>>>>>>>>>        // Pmoves.Posa_apo_dap
47619>>>>>>>>>>>        If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
47621>>>>>>>>>>>            // An to pedio Particle.Partl_Vsn einai 0 tote shmainei
47621>>>>>>>>>>>            // oti den einai parastatiko metasxhmatismeno (px D.AP) ara
47621>>>>>>>>>>>            // h update prepei na prosthesei sto antistoixo pedio client
47621>>>>>>>>>>>            // An omos einai metasxhmatismeno (px apo D.AP tora einai
47621>>>>>>>>>>>            // Timologio) tote  prepei h update na afairesei apo to pedio
47621>>>>>>>>>>>            // tou client dioti to arxiko D.AP eixe prosthesei.
47621>>>>>>>>>>>
47621>>>>>>>>>>>            Move (Round_Number(Pmoves.Pms_Payable,2)) to Pmoves.Posa_Apo_Dap
47622>>>>>>>>>>>
47622>>>>>>>>>>>            If (Particle.Partl_Vsn=0) Begin
47624>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Clients.Posa_Apo_Dap
47625>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Payresp.Posa_Apo_Dap
47626>>>>>>>>>>>            End
47626>>>>>>>>>>>>
47626>>>>>>>>>>>            Else Begin
47627>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Clients.Posa_Apo_Dap
47628>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Payresp.Posa_Apo_Dap
47629>>>>>>>>>>>            End
47629>>>>>>>>>>>>
47629>>>>>>>>>>>        End
47629>>>>>>>>>>>>
47629>>>>>>>>>>>
47629>>>>>>>>>>>        Add Pmoves.Qty_Kinhshs  to Particle.Partl_Disctof
47630>>>>>>>>>>>
47630>>>>>>>>>>>
47630>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47630>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
47630>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47630>>>>>>>>>>>        Add Pmoves.Pms_Vatam            to Particle.Partl_Vatam
47631>>>>>>>>>>>
47631>>>>>>>>>>>        Clear PartlFpa
47632>>>>>>>>>>>        Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
47633>>>>>>>>>>>        Move Pmoves.Pms_VatPct          to PartlFpa.Fpa_Pososto
47634>>>>>>>>>>>        Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
47635>>>>>>>>>>>>
47635>>>>>>>>>>>        Add Pmoves.Pms_Vatam            to PartlFpa.PartlFpa_Poso
47636>>>>>>>>>>>        Add Pmoves.Pms_Amaftdisc        to PartlFpa.Poso_Pro_Fpa
47637>>>>>>>>>>>        Saverecord PartlFpa
47638>>>>>>>>>>>
47638>>>>>>>>>>>        Move 0 to nFpaOnTotal
47639>>>>>>>>>>>        Clear PartlFpa
47640>>>>>>>>>>>        Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
47641>>>>>>>>>>>        Find Gt PartlFpa By Index.1
47642>>>>>>>>>>>>
47642>>>>>>>>>>>        While ((Found=1) And (PartlFpa.Partl_Recr=Particle.Partl_Recr))
47646>>>>>>>>>>>            Move (Round_Number(((PartlFpa.Fpa_Pososto*PartlFpa.Poso_Pro_Fpa)/100),2)) to PartlFpa.POSO_FPA
47647>>>>>>>>>>>            Move (PartlFpa.Poso_Pro_Fpa+PartlFpa.POSO_FPA) to PartlFpa.POSO_ME_FPA
47648>>>>>>>>>>>            Saverecord PartlFpa
47649>>>>>>>>>>>            Add PartlFpa.POSO_FPA to nFpaOnTotal
47650>>>>>>>>>>>            Find Gt PartlFpa By Index.1
47651>>>>>>>>>>>>
47651>>>>>>>>>>>        Loop
47652>>>>>>>>>>>>
47652>>>>>>>>>>>
47652>>>>>>>>>>>        Move nFpaOnTotal to Particle.Fpa_On_Total
47653>>>>>>>>>>>
47653>>>>>>>>>>>
47653>>>>>>>>>>>        //---------------------------------------------
47653>>>>>>>>>>>        // Auditing / Katagrafh allagon
47653>>>>>>>>>>>        //OPERATION_MODE       OPERATION_ORIGIN
47653>>>>>>>>>>>            //MODE_WAITING  
47653>>>>>>>>>>>            //MODE_FINDING  
47653>>>>>>>>>>>            //MODE_CLEARING 
47653>>>>>>>>>>>            //MODE_CREATING 
47653>>>>>>>>>>>            //MODE_SAVING   
47653>>>>>>>>>>>            //MODE_DELETING 
47653>>>>>>>>>>>            //MODE_ABORTING 
47653>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
47653>>>>>>>>>>>        Date    dDate  Shmer 
47653>>>>>>>>>>>        Integer iMin iHour iSec iLen
47653>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
47657>>>>>>>>>>>        Move iHour  to sHour
47658>>>>>>>>>>>        Move iMin   to sMin
47659>>>>>>>>>>>        Move iSec   to sSec
47660>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
47664>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
47668>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
47672>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
47673>>>>>>>>>>>        
47673>>>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
47673>>>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
47675>>>>>>>>>>>            Get fsLoginUserID to sUser
47676>>>>>>>>>>>            If (piCreateNew(Self)=1) Begin
47678>>>>>>>>>>>                clear gmove
47679>>>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
47680>>>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
47681>>>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
47682>>>>>>>>>>>                move  1                     to gmove.gtypkin_code// Apo Parastatika
47683>>>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
47684>>>>>>>>>>>                move pmoves.partl_no        to gmove.garticl_no
47685>>>>>>>>>>>                move Particle.CN_Code       to gmove.gplan_recr
47686>>>>>>>>>>>                move suser                  to gmove.gplan_code
47687>>>>>>>>>>>                move pmoves.pms_recr        to gmove.garticl_recr
47688>>>>>>>>>>>                reread sysrecg
47692>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
47693>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
47694>>>>>>>>>>>                saverecord sysrecg
47695>>>>>>>>>>>                unlock
47696>>>>>>>>>>>>
47696>>>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                            to Gmove.Gmove_Recr
47697>>>>>>>>>>>                Move Particle.Partl_Module          to Gmove.Module
47698>>>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
47699>>>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
47700>>>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
47701>>>>>>>>>>>                Move Clients.Client_ID              to Gmove.Cur_ID
47702>>>>>>>>>>>                Move Clients.CLient_Name            to Gmove.Cur_Name
47703>>>>>>>>>>>                Move Particle.CN_Code               to Gmove.Cur_CN
47704>>>>>>>>>>>                Move Item.Item_Code                 to Gmove.Cur_Item
47705>>>>>>>>>>>                Move Item.Item_Qual                 to Gmove.Cur_Qual 
47706>>>>>>>>>>>                Move Pmoves.Pms_Qty                 to Gmove.Cur_M3 
47707>>>>>>>>>>>                Move Pmoves.Pms_UnitPrice           to Gmove.Cur_UnitPrice
47708>>>>>>>>>>>                Move Particle.Partl_Recr            to Gmove.Partl_Recr 
47709>>>>>>>>>>>                Move Pmoves.Pms_Recr                to Gmove.Pms_Recr  
47710>>>>>>>>>>>                
47710>>>>>>>>>>>                Move Pmoves.Zone                    to Gmove.Cur_Zonh
47711>>>>>>>>>>>                Move Pmoves.Pump_ID                 to Gmove.Cur_Antlia
47712>>>>>>>>>>>                Move Pmoves.Car_ID                  to Gmove.Cur_Oxhma       
47713>>>>>>>>>>>                
47713>>>>>>>>>>>                Move Ptyppar.Ptyppar_Code           to Gmove.Cur_Parast
47714>>>>>>>>>>>                Move Particle.Pseira_Seira          to Gmove.Cur_Seira
47715>>>>>>>>>>>                Move Particle.Partl_Hmnia           to Gmove.Cur_Hmnia
47716>>>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ š¨˜££ãª §˜¨˜©«˜« ¡¦ç)" to sText
47717>>>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs
47718>>>>>>>>>>>                move (trim(stext))          to gmove.gmove_aitiol
47719>>>>>>>>>>>                Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                    to Gmove.Txt1
47720>>>>>>>>>>>                saverecord gmove
47721>>>>>>>>>>>                Set piCreateNew to 0
47722>>>>>>>>>>>            End
47722>>>>>>>>>>>>
47722>>>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1)) Begin                                
47725>>>>>>>>>>>                Integer isChanged
47725>>>>>>>>>>>                Move 0 to isChanged
47726>>>>>>>>>>>                
47726>>>>>>>>>>>                     If ((Trim(psAud_Old_Pelaths(Self))<>Trim(Clients.Client_ID    ))   Or  (Trim(psAud_Old_Ergo    (Self))<>Trim(Pmoves.CN_Code      ))) Move 1 to isChanged    
47729>>>>>>>>>>>                Else If ((Trim(psAud_Old_Eidos  (Self))<>Trim(Item.Item_Code       ))   Or  (Trim(psAud_Old_Poiothta(Self))<>Trim(Item.Item_Qual      ))) Move 1 to isChanged   
47733>>>>>>>>>>>                Else If ((pnAud_Old_Qty         (Self) <>Pmoves.Pms_Qty             )   Or  (pnAud_Old_Timh         (Self) <>Pmoves.Pms_UnitPrice      )) Move 1 to isChanged   
47737>>>>>>>>>>>                Else If ((Trim(psAud_Old_Zonh   (Self))<>Trim(Pmoves.Zone          ))   Or  (Trim(psAud_Old_Antlia  (Self))<>Trim(Pmoves.Pump_ID      ))) Move 1 to isChanged   
47741>>>>>>>>>>>                Else If ((Trim(psAud_Old_Oxhma  (Self))<>Trim(Pmoves.Car_ID        ))   Or  (Trim(psAud_Old_Parast  (Self))<>Trim(Ptyppar.Ptyppar_Code))) Move 1 to isChanged   
47745>>>>>>>>>>>                Else If ((Trim(psAud_Old_Seira  (Self))<>Trim(Particle.Pseira_Seira))   Or  (Trim(pdAud_Old_Hmnia   (Self))<>Particle.Partl_Hmnia      )) Move 1 to isChanged  
47749>>>>>>>>>>>                Else If  (piAud_Old_No          (Self) <>Particle.Partl_No)                                                                               Move 1 to isChanged
47753>>>>>>>>>>>
47753>>>>>>>>>>>                If (isChanged>0) Begin  
47755>>>>>>>>>>>                    clear gmove
47756>>>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
47757>>>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
47758>>>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
47759>>>>>>>>>>>                    move  1                     to gmove.gtypkin_code// Apo Parastatika
47760>>>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
47761>>>>>>>>>>>                    move pmoves.partl_no        to gmove.garticl_no
47762>>>>>>>>>>>                    move Particle.CN_Code       to gmove.gplan_recr
47763>>>>>>>>>>>                    move suser                  to gmove.gplan_code
47764>>>>>>>>>>>                    move pmoves.pms_recr        to gmove.garticl_recr
47765>>>>>>>>>>>                    reread sysrecg
47769>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
47770>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
47771>>>>>>>>>>>                    saverecord sysrecg
47772>>>>>>>>>>>                    unlock
47773>>>>>>>>>>>>
47773>>>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
47774>>>>>>>>>>>                    Move Particle.Partl_Module          to Gmove.Module
47775>>>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
47776>>>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
47777>>>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
47778>>>>>>>>>>>                    //--
47778>>>>>>>>>>>                    Move Particle.Partl_Recr            to Gmove.Partl_Recr 
47779>>>>>>>>>>>                    Move Pmoves.Pms_Recr                to Gmove.Pms_Recr  
47780>>>>>>>>>>>                    //--
47780>>>>>>>>>>>                    Move (Trim(Clients.Client_ID    ))  to Gmove.Cur_ID
47781>>>>>>>>>>>                    Move (Trim(Clients.CLient_Name  ))  to Gmove.Cur_Name
47782>>>>>>>>>>>                    Move (Trim(Particle.CN_Code     ))  to Gmove.Cur_CN
47783>>>>>>>>>>>                    Move (Trim(Item.Item_Code       ))  to Gmove.Cur_Item
47784>>>>>>>>>>>                    Move (Trim(Item.Item_Qual       ))  to Gmove.Cur_Qual 
47785>>>>>>>>>>>                    Move       Pmoves.Pms_Qty           to Gmove.Cur_M3 
47786>>>>>>>>>>>                    Move       Pmoves.Pms_UnitPrice     to Gmove.Cur_UnitPrice
47787>>>>>>>>>>>
47787>>>>>>>>>>>                    Move (Trim(Pmoves.Zone          ))  to Gmove.Cur_Zonh
47788>>>>>>>>>>>                    Move (Trim(Pmoves.Pump_ID       ))  to Gmove.Cur_Antlia
47789>>>>>>>>>>>                    Move (Trim(Pmoves.Car_ID        ))  to Gmove.Cur_Oxhma       
47790>>>>>>>>>>>
47790>>>>>>>>>>>                    Move (Trim(Ptyppar.Ptyppar_Code ))  to Gmove.Cur_Parast
47791>>>>>>>>>>>                    Move (Trim(Particle.Pseira_Seira))  to Gmove.Cur_Seira
47792>>>>>>>>>>>                    Move       Particle.Partl_Hmnia     to Gmove.Cur_Hmnia
47793>>>>>>>>>>>                    Move       Particle.Partl_No        to Gmove.Cur_No
47794>>>>>>>>>>>                    //--
47794>>>>>>>>>>>                    Move (Trim(psAud_Old_Pelaths (Self))) to Gmove.Prev_ID
47795>>>>>>>>>>>                    Move (Trim(psAud_Old_PelathsN(Self))) to Gmove.Prev_Name
47796>>>>>>>>>>>                    Move (Trim(psAud_Old_Ergo    (Self))) to Gmove.Prev_CN
47797>>>>>>>>>>>                    Move (Trim(psAud_Old_Eidos   (Self))) to Gmove.Prev_Item
47798>>>>>>>>>>>                    Move (Trim(psAud_Old_Poiothta(Self))) to Gmove.Prev_Qual 
47799>>>>>>>>>>>                    Move      (pnAud_Old_Qty     (Self )) to Gmove.Prev_M3 
47800>>>>>>>>>>>                    Move      (pnAud_Old_Timh    (Self )) to Gmove.Prev_UnitPrice
47801>>>>>>>>>>>                    Move (Trim(psAud_Old_Zonh    (Self))) to Gmove.Prev_Zonh
47802>>>>>>>>>>>                    Move (Trim(psAud_Old_Antlia  (Self))) to Gmove.Prev_Antlia
47803>>>>>>>>>>>                    Move (Trim(psAud_Old_Oxhma   (Self))) to Gmove.Prev_Oxhma
47804>>>>>>>>>>>                    Move (Trim(psAud_Old_Parast  (Self))) to Gmove.Prev_Parast
47805>>>>>>>>>>>                    Move (Trim(psAud_Old_Seira   (Self))) to Gmove.Prev_Seira
47806>>>>>>>>>>>                    Move      (pdAud_Old_Hmnia   (Self )) to Gmove.Prev_Hmnia
47807>>>>>>>>>>>                    Move      (piAud_Old_No      (Self )) to Gmove.Prev_No
47808>>>>>>>>>>>                    //--
47808>>>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž š¨˜££ãª ˜¨˜©«˜« ¡¦ç)" to sText 
47809>>>>>>>>>>>                    Move "E" to Gmove.Eidos_Metabolhs
47810>>>>>>>>>>>                    move (trim(stext))          to gmove.gmove_aitiol
47811>>>>>>>>>>>                    Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                        to Gmove.Txt1
47812>>>>>>>>>>>                    saverecord gmove
47813>>>>>>>>>>>                    Set piCreateNew to 0
47814>>>>>>>>>>>                End
47814>>>>>>>>>>>>
47814>>>>>>>>>>>            End
47814>>>>>>>>>>>>
47814>>>>>>>>>>>        End
47814>>>>>>>>>>>>
47814>>>>>>>>>>>    End_Procedure   // Update
47815>>>>>>>>>>>
47815>>>>>>>>>>>    // Backout:
47815>>>>>>>>>>>    Procedure Backout
47816>>>>>>>>>>>        Number nFpaOnTotal
47817>>>>>>>>>>>        Forward Send Backout
47819>>>>>>>>>>>
47819>>>>>>>>>>>        Sub Pmoves.Pms_Qty        From Particle.Partl_TotTem
47820>>>>>>>>>>>        Sub Pmoves.Timol_Qty      From Particle.Timol_Qty
47821>>>>>>>>>>>        Sub Pmoves.Pms_Ambd       From Particle.Partl_TotAmBD
47822>>>>>>>>>>>        Sub Pmoves.Pms_DiscAm     From Particle.Partl_AMDISCPMS
47823>>>>>>>>>>>        Sub Pmoves.Pms_Amaftdisc  From Particle.Partl_TotAmAd
47824>>>>>>>>>>>        Sub 1                     From Particle.Partl_NoOfLines
47825>>>>>>>>>>>
47825>>>>>>>>>>>        // An einai parastatiko polhshs kai to ptyppar einai flagarismeno oti
47825>>>>>>>>>>>        // prepei na enhmerosh to pedio Clients.Posa_apo_dap
47825>>>>>>>>>>>        // tote theoroume oti ypoxreotika prepei na vroume timh sto pedio
47825>>>>>>>>>>>        // Pmoves.Posa_apo_dap
47825>>>>>>>>>>>        If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
47827>>>>>>>>>>>            // An to pedio Particle.Partl_Vsn einai 0 tote shmainei
47827>>>>>>>>>>>            // oti den einai parastatiko metasxhmatismeno (px D.AP) ara
47827>>>>>>>>>>>            // h backout prepei na afairesei apo antistoixo pedio client
47827>>>>>>>>>>>            // An omos einai metasxhmatismeno (px apo D.AP tora einai
47827>>>>>>>>>>>            // Timologio) tote  prepei h backout na prosthesi sto pedio
47827>>>>>>>>>>>            // tou client dioti to arxiko D.AP eixe afairethei.
47827>>>>>>>>>>>            If (Particle.Partl_Vsn=0) Begin
47829>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Clients.Posa_Apo_Dap
47830>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Payresp.Posa_Apo_Dap
47831>>>>>>>>>>>            End
47831>>>>>>>>>>>>
47831>>>>>>>>>>>            Else Begin
47832>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Clients.Posa_Apo_Dap
47833>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Payresp.Posa_Apo_Dap
47834>>>>>>>>>>>            End
47834>>>>>>>>>>>>
47834>>>>>>>>>>>        End
47834>>>>>>>>>>>>
47834>>>>>>>>>>>
47834>>>>>>>>>>>        Sub Pmoves.Qty_Kinhshs From Particle.Partl_Disctof
47835>>>>>>>>>>>
47835>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47835>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
47835>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47835>>>>>>>>>>>        Sub Pmoves.Pms_Vatam      From Particle.Partl_Vatam
47836>>>>>>>>>>>
47836>>>>>>>>>>>        Clear PartlFpa
47837>>>>>>>>>>>        Move Particle.Partl_Recr    to PartlFpa.Partl_Recr
47838>>>>>>>>>>>        Move Pmoves.Pms_VatPct      to PartlFpa.Fpa_Pososto
47839>>>>>>>>>>>        Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
47840>>>>>>>>>>>>
47840>>>>>>>>>>>        Sub Pmoves.Pms_Vatam      From PartlFpa.PartlFpa_Poso
47841>>>>>>>>>>>        Sub Pmoves.Pms_Amaftdisc  From PartlFpa.Poso_Pro_Fpa
47842>>>>>>>>>>>        Saverecord PartlFpa
47843>>>>>>>>>>>
47843>>>>>>>>>>>        Move 0 to nFpaOnTotal
47844>>>>>>>>>>>        Clear PartlFpa
47845>>>>>>>>>>>        Move Particle.Partl_Recr  to PartlFpa.Partl_Recr
47846>>>>>>>>>>>        Find Gt PartlFpa By Index.1
47847>>>>>>>>>>>>
47847>>>>>>>>>>>        While ((Found=1) And (PartlFpa.Partl_Recr=Particle.Partl_Recr))
47851>>>>>>>>>>>            Move (Round_Number(((PartlFpa.Fpa_Pososto*PartlFpa.Poso_Pro_Fpa)/100),2)) to PartlFpa.POSO_FPA
47852>>>>>>>>>>>            Move (PartlFpa.Poso_Pro_Fpa+PartlFpa.POSO_FPA) to PartlFpa.POSO_ME_FPA
47853>>>>>>>>>>>            Saverecord PartlFpa
47854>>>>>>>>>>>            Add PartlFpa.POSO_FPA to nFpaOnTotal
47855>>>>>>>>>>>            Find Gt PartlFpa By Index.1
47856>>>>>>>>>>>>
47856>>>>>>>>>>>        Loop
47857>>>>>>>>>>>>
47857>>>>>>>>>>>
47857>>>>>>>>>>>        Move nFpaOnTotal to Particle.Fpa_On_Total     
47858>>>>>>>>>>>        
47858>>>>>>>>>>>    End_Procedure   // Backout
47859>>>>>>>>>>>
47859>>>>>>>>>>>
47859>>>>>>>>>>>
47859>>>>>>>>>>>
47859>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
47860>>>>>>>>>>>             If (iError_Num = 1001) Error 1001 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Wax"
47863>>>>>>>>>>>        Else If (iError_Num = 1002) Error 1002 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Witemx"
47867>>>>>>>>>>>        Else If (iError_Num = 1003) Error 1003 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Particle"
47871>>>>>>>>>>>        Else If (iError_Num = 1004) Error 1004 "DDC 18: ¦©æ«ž«˜ „å›¦¬ª ‹ž›œ¤ ¡ã\nƒ ˜š¨á¯«œ ˜¤ Ÿâ¢œ«œ, «ž š¨˜££ã «¦¬ œå›¦¬ª"
47875>>>>>>>>>>>        Else If (iError_Num = 1005) Error 1005 "DDC 18: ¦©æ §¨¦ „¡§«à©žª ‹ž›œ¤ ¡æ"
47879>>>>>>>>>>>        Else If (iError_Num = 1006) Error 1006 "DDC 18: ¦©æ §¨¦ ”€ ‹ž›œ¤ ¡æ"
47883>>>>>>>>>>>        Else If (iError_Num = 1007) Error 1007 "DDC 18: ¦©æ ¢ž¨à«â¦ „å›¦¬ª ‹ž›œ¤ ¡æ"
47887>>>>>>>>>>>        Else If (iError_Num = 1009) Error 1009 "DDC 18: ƒœ¤ œå¤˜  œ­ ¡«ã ž › ˜š¨˜­ã \n„®œ  ›ž£ ¦¬¨šžŸœå £œ«˜©®ž£˜« ©£â¤¦ §˜¨˜©«˜« ¡æ"
47891>>>>>>>>>>>        Else If (iError_Num = 1010) Error 1010 "DDC 18: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ §œ¢á«ž"
47895>>>>>>>>>>>        Else If (iError_Num = 1011) Error 1011 "DDC 18: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ ¬§. §¢ž¨à£ãª"
47899>>>>>>>>>>>        Else If (iError_Num = 1012) Error 1012 "DDC 18: ’¦ œå›¦ª ˜¬«æ §¨¦ã¢Ÿœ ˜§¦ £œ«˜©®ž£˜« ©£æ ¡˜  ›œ¤ › ˜š¨á­œ«˜ .\nƒ ˜š¨á¯«œ «¦ §˜¨˜©«˜« ¡æ ¡˜  ¥˜¤˜£œ«˜©®ž£˜«å©«œ «¦ ˜¨® ¡æ."
47903>>>>>>>>>>>        Else If (iError_Num = 1013) Error 1013 "DDC 18: ’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\n‰ ¤ãŸž¡œ §¦©æ«ž«˜ > ˜§¦ «ž › ˜Ÿâ© £ž"
47907>>>>>>>>>>>        Else If (iError_Num = 1111) Error 1111 "DDC 18: ƒœ¤ â®œ  ¡˜«˜®à¨žŸœå ©«¦ ©ç©«ž£˜ «â«¦ ¦ §¦©¦©«æ ”€"
47911>>>>>>>>>>>        Else If (iError_Num = 1105) Error 1105 "DDC 18: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
47915>>>>>>>>>>>        Else If (iError_Num = 1106) Error 1106 "DDC 18: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
47919>>>>>>>>>>>        Else If (iError_Num = 1107) Error 1107 "DDC 18: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
47923>>>>>>>>>>>        Else If (iError_Num = 1108) Error 1108 "DDC 18: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
47927>>>>>>>>>>>        Else If (iError_Num = 1110) Error 1110 "DDC 18: †£/¤å˜ §˜¨˜©«˜« ¡¦ç <= †£/¤å˜ª ¡¢œ ©å£˜«¦ª\nƒœ¤ œ§ «¨â§œ«˜  ¡˜££å˜ «¨¦§¦§¦åž©ž ©«¦ §˜¨˜©«˜« ¡æ"
47931>>>>>>>>>>>        Else If (iError_Num = 6001) Error 6001 "DDC 18: ƒœ¤ §¨¦¡ç§«œ  §¦©¦ ˜§¦ « £¦¡˜«á¢¦š¦"
47935>>>>>>>>>>>        Else If (iError_Num = 7000) Error 7000 "DDC 18: ¨¦â¨®œ«˜  ˜§¦ ˜¨˜ššœ¢å˜. † š¨˜££ã ˜¬«ã £æ¤¦ › ˜š¨á­œ«˜ "
47939>>>>>>>>>>>        Else If (iError_Num = 7001) Error 7001 "DDC 18: ’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ."
47943>>>>>>>>>>>        Else If (iError_Num = 7005) Error 7005 "DDC 18: † §¦©æ«ž«˜ ›œ¤ «¨¦§¦§¦ œå«˜  š ˜«  §¨¦ã¢Ÿœ ˜§¦ £œ«˜©®ž£˜« ©£æ.\nƒ ˜š¨á¯«œ «¦ §˜¨˜©«˜« ¡æ ¡˜  ¥˜¤˜£œ«˜©®ž£˜«å©«œ «¦ ˜¨® ¡æ."
47947>>>>>>>>>>>        Else If (iError_Num = 8000) Error 8000 "DDC 18: €¡¬¨éŸž¡œ ž ¡˜«˜®é¨ž©ž «¦¬ œå›¦¬ª ˜§¦ «¦¤ ®¨ã©«ž\n‹œ«˜ «¦ Ž‰, §˜«ã©«œ F5"
47951>>>>>>>>>>>        Else If (iError_Num = 8001) Error 8001 "DDC 18: ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã œå›¦¬ª\n‹œ«˜ «¦ Ž‰, §˜«ã©«œ F5"
47955>>>>>>>>>>>        Else If (iError_Num = 6655) Error 6655 "DDC 18: ¨¦¡ç§«œ  ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž > ˜¨® ¡ãª §¦©æ«ž«˜ª"
47959>>>>>>>>>>>        Else Forward Send Operation_Not_Allowed  iError_Num
47962>>>>>>>>>>>    End_Procedure   // Operation_Not_Allowed
47963>>>>>>>>>>>
47963>>>>>>>>>>>    Function Validate_Save  Returns Integer
47964>>>>>>>>>>>        Integer iReturnVal iFpaRecnum iYes
47965>>>>>>>>>>>        Number  nInt nqty nQtyKin
47965>>>>>>>>>>>        String  sUserID sOldUserID sOldItem
47965>>>>>>>>>>>
47965>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
47967>>>>>>>>>>>
47967>>>>>>>>>>>        If (Not(iReturnVal)) Begin
47969>>>>>>>>>>>
47969>>>>>>>>>>>//////////////////////////////////////////////////////////////////////////////////////
47969>>>>>>>>>>>        // Egine rem o kodikas pou elegxei to pososto fpa giati sto shmeio ayto
47969>>>>>>>>>>>        // dhmiourgouse parenergeia an o xrhsths allaze to pososto fpa pou erxotan
47969>>>>>>>>>>>        // apo to eidos, tote allaze kai sto record tou eidous
47969>>>>>>>>>>>
47969>>>>>>>>>>>//            If (Pmoves.Pms_VatPct) Begin
47969>>>>>>>>>>>//                Move Fpa.Recnum to iFpaRecnum
47969>>>>>>>>>>>//                Clear Fpa
47969>>>>>>>>>>>//                Move Pmoves.Pms_VatPct      to Fpa.Fpa_Pososto
47969>>>>>>>>>>>//                Find eq Fpa By Index.1 // Fpa:Index.1:Fpa_Pososto
47969>>>>>>>>>>>//                If (Not(Found)) Move 1111 to iReturnVal
47969>>>>>>>>>>>//                If (iFpaRecnum) Begin
47969>>>>>>>>>>>//                    Clear Fpa
47969>>>>>>>>>>>//                    Move iFpaRecnum to Fpa.Recnum
47969>>>>>>>>>>>//                    Find Eq Fpa.Recnum
47969>>>>>>>>>>>//                End
47969>>>>>>>>>>>//            End
47969>>>>>>>>>>>//////////////////////////////////////////////////////////////////////////////////////
47969>>>>>>>>>>>
47969>>>>>>>>>>>                 If (Wax.Recnum          =0) Move 1001 to iReturnVal
47972>>>>>>>>>>>            Else If (Witemx.Recnum       =0) Move 1002 to iReturnVal
47976>>>>>>>>>>>            Else If (Particle.Recnum     =0) Move 1003 to iReturnVal
47980>>>>>>>>>>>            Else If (Pmoves.Pms_Qty      =0) Move 1004 to iReturnVal
47984>>>>>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                     Move 1110 to iReturnVal
47988>>>>>>>>>>>            Else Begin
47989>>>>>>>>>>>                //If (Pmoves.Timol_Ypol<0)                        Move 7001 to iReturnVal
47989>>>>>>>>>>>                If (Pmoves.Qty_Kinhshs>Pmoves.Timol_Ypol)  Move 1013 to iReturnVal
47992>>>>>>>>>>>                Else If (Pmoves.Timol_Ypol>Pmoves.Pms_Qty)      Move 6655 to iReturnVal
47996>>>>>>>>>>>                // SOS SOS SOS 24/10/2002 ¨¦©¦¨ ¤˜ Off š ˜«  ®«¬§˜œ  ©« ª ˜¤«¢ œª
47996>>>>>>>>>>>
47996>>>>>>>>>>>//                Else If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
47996>>>>>>>>>>>//                    If (Pmoves.Posa_Apo_Dap=0) Begin
47996>>>>>>>>>>>//                        Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
47996>>>>>>>>>>>//                        If (iYes=MBR_NO) Move 6001 to iReturnVal
47996>>>>>>>>>>>//                    End
47996>>>>>>>>>>>//                End
47996>>>>>>>>>>>//                Else If ((Clients.Plafon>0) And ;
47996>>>>>>>>>>>//                    ((Clients.Ypoloipo+Pmoves.Posa_Apo_Dap)>Clients.Plafon) And ;
47996>>>>>>>>>>>//                    (Ptyppar.Check_Posa_Plaf='1')) Begin
47996>>>>>>>>>>>//                        Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
47996>>>>>>>>>>>//                        If (iYes=MBR_NO) Move 1010 to iReturnVal
47996>>>>>>>>>>>//                End
47996>>>>>>>>>>>//                Else If ((PayResp.Plafon>0) And ;
47996>>>>>>>>>>>//                        ((PayResp.Ypoloipo+Pmoves.Posa_Apo_Dap)>PayResp.Plafon) And ;
47996>>>>>>>>>>>//                         (Ptyppar.Check_Posa_Plaf='1')) Begin
47996>>>>>>>>>>>//                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
47996>>>>>>>>>>>//                        If (iYes=MBR_NO) Move 1011 to iReturnVal
47996>>>>>>>>>>>//                End
47996>>>>>>>>>>>                Else If ((pmoves.clorderd_recr <> '') and (pifromclorder(self)<>1)) begin //?? Pmoves ???ÿ????š???? ? ???????êœ??
47999>>>>>>>>>>>                    get pnoqty to nqty
48000>>>>>>>>>>>                    if (nqty <> pmoves.pms_qty)                 Move 7000 to iReturnVal
48003>>>>>>>>>>>                End
48003>>>>>>>>>>>>
48003>>>>>>>>>>>
48003>>>>>>>>>>>                Else If ((Pmoves.Qty_Ypol=1) And (piFromMetasx(Self)=0)) begin
48006>>>>>>>>>>>                    // js 28/08/2002
48006>>>>>>>>>>>                    // To pedio Qty_Ypol xrhsimopoihtai gia na flagarei an ena Pmove
48006>>>>>>>>>>>                    // exei proelthei apo metasxhmatismo (Eite sygkentrotika, eite analytika)
48006>>>>>>>>>>>                    // To xrhsimopoihsame ayto gia na mhn anoixtei neo pedio.
48006>>>>>>>>>>>                    // An loipon exei proelthei apo metasxhmatismo DEN epitrepetai tropopoihsh
48006>>>>>>>>>>>                    // ths posothtas tou ap' eutheias alla mono meso ths posothtas mias
48006>>>>>>>>>>>                    // sygkekrimenhs eggrafhs tou arxeiou PmsSxet
48006>>>>>>>>>>>                    If (Operation_Origin=Self) Begin
48008>>>>>>>>>>>                        get pnoqty to nqty
48009>>>>>>>>>>>                        if (nqty <> pmoves.pms_qty)             Move 7005 to iReturnVal
48012>>>>>>>>>>>                        // js 22/12/2003
48012>>>>>>>>>>>                        // Epishs DEN epitrepetai allagh eidous
48012>>>>>>>>>>>                        // Pianoume to bug pou se metasxhmatismeno parastatiko
48012>>>>>>>>>>>                        // mporouse na allaxei to eidos me F7/F8
48012>>>>>>>>>>>                        Get psOldItem to sOldItem
48013>>>>>>>>>>>                        If (Item.Item_Code<>sOldItem) Move 8001 to iReturnVal
48016>>>>>>>>>>>                    End
48016>>>>>>>>>>>>
48016>>>>>>>>>>>                End
48016>>>>>>>>>>>>
48016>>>>>>>>>>>            End
48016>>>>>>>>>>>>
48016>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
48019>>>>>>>>>>>        End
48019>>>>>>>>>>>>
48019>>>>>>>>>>>        Function_Return iReturnVal
48020>>>>>>>>>>>    End_Function   // Validate_Save
48021>>>>>>>>>>>
48021>>>>>>>>>>>    Function Validate_Delete  Returns Integer
48022>>>>>>>>>>>        Integer iReturnVal
48023>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
48025>>>>>>>>>>>        If (Not(iReturnVal)) Begin
48027>>>>>>>>>>>            If (Particle.Partl_Timol=1) Move 1009 to iReturnVal
48030>>>>>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                Move 1110 to iReturnVal
48034>>>>>>>>>>>            Else If ((pmoves.qty_ypol=1) And (Operation_Origin=Self)) Move 1012 to iReturnVal
48038>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
48041>>>>>>>>>>>        End
48041>>>>>>>>>>>>
48041>>>>>>>>>>>        Function_Return iReturnVal
48042>>>>>>>>>>>    End_Function   // Validate_Delete
48043>>>>>>>>>>>
48043>>>>>>>>>>>    Procedure Set_UnitPrice integer iField  Number nNum
48044>>>>>>>>>>>        Local Integer   Changed
48045>>>>>>>>>>>        Local Number    nInt
48045>>>>>>>>>>>        Get Field_Changed_State iField to Changed
48046>>>>>>>>>>>        If (Changed=0 AND nNum=0) Begin
48048>>>>>>>>>>>            Get fnTeleytaiaTimh to nInt
48049>>>>>>>>>>>            Set Field_Default_Value iField to nInt
48050>>>>>>>>>>>        End
48050>>>>>>>>>>>>
48050>>>>>>>>>>>    End_Procedure   // Shmera
48051>>>>>>>>>>>
48051>>>>>>>>>>>    Procedure Set_Discount integer iField  Number nNum
48052>>>>>>>>>>>        Local Integer Changed
48053>>>>>>>>>>>        Local Number nInt
48053>>>>>>>>>>>        Get Field_Changed_State iField to Changed
48054>>>>>>>>>>>        If (Changed=0 AND nNum=0) Begin
48056>>>>>>>>>>>            Get fnTeleytaiaTimh to nInt
48057>>>>>>>>>>>            If (nInt<0) Begin
48059>>>>>>>>>>>                Move (nInt*(-1)) to nInt
48060>>>>>>>>>>>                Set Field_Default_Value iField to nInt
48061>>>>>>>>>>>            End
48061>>>>>>>>>>>>
48061>>>>>>>>>>>        End
48061>>>>>>>>>>>>
48061>>>>>>>>>>>    End_Procedure   // Shmera
48062>>>>>>>>>>>
48062>>>>>>>>>>>    Procedure Set_FPA integer iField  Number nNum
48063>>>>>>>>>>>        Local Integer Changed
48064>>>>>>>>>>>        Local Number nInt
48064>>>>>>>>>>>        Get Field_Changed_State iField to Changed
48065>>>>>>>>>>>        If (Changed=0 AND nNum=0) Begin
48067>>>>>>>>>>>            Move Item.Fpa_Pososto to nInt
48068>>>>>>>>>>>            Set Field_Default_Value iField to nInt
48069>>>>>>>>>>>        End
48069>>>>>>>>>>>>
48069>>>>>>>>>>>    End_Procedure   // Shmera
48070>>>>>>>>>>>
48070>>>>>>>>>>>    // Define_Fields:
48070>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48070>>>>>>>>>>>
48070>>>>>>>>>>>    Procedure Define_Fields
48071>>>>>>>>>>>        Forward Send Define_Fields
48073>>>>>>>>>>>        //DDB-Generated-Code-Location
48073>>>>>>>>>>>        //DDB-DefineFieldStart
48073>>>>>>>>>>>
48073>>>>>>>>>>>        Set Main_File            To Pmoves.File_Number
48074>>>>>>>>>>>
48074>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48075>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48076>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48077>>>>>>>>>>>
48077>>>>>>>>>>>        // Child (Client) file structure................
48077>>>>>>>>>>>        Send Add_Client_File  Pmsdtl.File_Number
48078>>>>>>>>>>>        Send Add_Client_File  Pmssxet.File_Number
48079>>>>>>>>>>>
48079>>>>>>>>>>>        // Parent (Server) file structure...............
48079>>>>>>>>>>>        Send Add_Server_File  Wax.File_Number
48080>>>>>>>>>>>        Send Add_Server_File  Witemx.File_Number
48081>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
48082>>>>>>>>>>>
48082>>>>>>>>>>>        // External (System) file structure.............
48082>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_NEW_SAVE
48083>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
48084>>>>>>>>>>>        Send Add_System_File  Partlfpa.File_Number  DD_LOCK_ON_ALL
48085>>>>>>>>>>>        Send Add_System_File  Clorder.File_Number  DD_LOCK_ON_ALL
48086>>>>>>>>>>>        Send Add_System_File  Clorderd.File_Number  DD_LOCK_ON_ALL
48087>>>>>>>>>>>        Send Add_System_File  Btnemp.File_Number  DD_LOCK_ON_ALL
48088>>>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
48089>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
48090>>>>>>>>>>>
48090>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Pmoves_Rec0  To Pmoves.Pms_Rec0
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Field-based properties.......................
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Pmoves.Company_Code
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Pmoves.Branch_Code
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Pmoves.Year_Year
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Pmoves.Ctypkin_Code
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Pmoves.Wtypkin_Code
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Pmoves.Custprom_Code
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Pmoves.Client_Id
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Pmoves.Cn_Code
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Pmoves.Ptyppar_Code
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Pmoves.Partl_Hmnia
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Pmoves.Pseira_Seira
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Pmoves.Partl_No
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Pmoves.Partl_Rec0
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Pmoves.Witemkat_Code
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Pmoves.Units_Code
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Pmoves.Item_Code
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Pmoves.Witemx_Code
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Pmoves.Wapokat_Code
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Pmoves.Wapomast_Code
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Pmoves.Wax_Code
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Pmoves.Wax_Recr
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Pmoves.Witemx_Recr
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Pmoves.Partl_Recr
48093>>>>>>>>>>>
48093>>>>>>>>>>>        // Pmoves.Pms_Rec0
48093>>>>>>>>>>>        Set Field_Options          Field Pmoves.Pms_Rec0 To DD_AUTOFIND   
48094>>>>>>>>>>>
48094>>>>>>>>>>>        // Pmoves.Pms_No
48094>>>>>>>>>>>
48094>>>>>>>>>>>        // Pmoves.Pms_Recr
48094>>>>>>>>>>>
48094>>>>>>>>>>>        // Pmoves.Pms_Unitcode
48094>>>>>>>>>>>
48094>>>>>>>>>>>        // Pmoves.Pms_Qty
48094>>>>>>>>>>>
48094>>>>>>>>>>>        // Pmoves.Pms_Unitprice
48094>>>>>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Unitprice To Set_UnitPrice
48095>>>>>>>>>>>
48095>>>>>>>>>>>        // Pmoves.Pms_Ambd
48095>>>>>>>>>>>
48095>>>>>>>>>>>        // Pmoves.Pms_Pctdisc
48095>>>>>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Pctdisc To Set_Discount
48096>>>>>>>>>>>
48096>>>>>>>>>>>        // Pmoves.Pms_Discam
48096>>>>>>>>>>>
48096>>>>>>>>>>>        // Pmoves.Pms_Amaftdisc
48096>>>>>>>>>>>
48096>>>>>>>>>>>        // Pmoves.Pms_Vatpct
48096>>>>>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Vatpct To Set_FPA
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_Vatam
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_Exrampct
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_Exdet
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_Payable
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_Axia
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_X0
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_P0
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_X00
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_P00
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_X1
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_P1
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_X2
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_P2
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_Dlixis
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_A_Code
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_Status_E
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_Status_A
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_S0
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_Ys0
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_S1
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_Ys1
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_S2
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_Ys2
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_Sc_Code2
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_Open
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_Aopen
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_M_Code
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_Yn_Myf
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_Myf_Axia
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_Kk
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_C_Code2
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_Cn_Code
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Wcmoves_Recr
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_Module
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Btnl2_Recr
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Btnemp_Recr
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Btarticle_Recr
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Sls_Id
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Presp_Id
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Cnt_Id
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Mhxanik_Id
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Extra_Epimer
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Ekpt_Epimer
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Clorderd_Recr
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Witemx_Descr
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Ptyppar_Descr
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Ti_Typonei_Pms
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Timol_Qty
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Timol_Ypol
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Posa_Apo_Dap
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Qty_Ypol
48097>>>>>>>>>>>
48097>>>>>>>>>>>        // Pmoves.Pms_Selected
48097>>>>>>>>>>>        Set Field_Class_Name       Field Pmoves.Pms_Selected To "dbCheckBoxsub"
48098>>>>>>>>>>>
48098>>>>>>>>>>>        // Pmoves.Qty_Kinhshs
48098>>>>>>>>>>>
48098>>>>>>>>>>>        // Pmoves.Sx_Parast
48098>>>>>>>>>>>
48098>>>>>>>>>>>        // Pmoves.Sx_Hmnia
48098>>>>>>>>>>>
48098>>>>>>>>>>>        // Pmoves.Sx_Seira
48098>>>>>>>>>>>
48098>>>>>>>>>>>        // Pmoves.Sx_Arithmos
48098>>>>>>>>>>>
48098>>>>>>>>>>>        // Pmoves.Pump_Id
48098>>>>>>>>>>>
48098>>>>>>>>>>>        // Pmoves.Car_Id
48098>>>>>>>>>>>
48098>>>>>>>>>>>        // Pmoves.Item_Ypot
48098>>>>>>>>>>>
48098>>>>>>>>>>>        // Pmoves.Qty_Return
48098>>>>>>>>>>>
48098>>>>>>>>>>>        // Pmoves.Client_Name
48098>>>>>>>>>>>
48098>>>>>>>>>>>        // Pmoves.Zone
48098>>>>>>>>>>>
48098>>>>>>>>>>>        //DDB-DefineFieldEnd
48098>>>>>>>>>>>    End_Procedure    // Define_Fields
48099>>>>>>>>>>>
48099>>>>>>>>>>>    // Field_Defaults:
48099>>>>>>>>>>>    // This procedure is used to establish default field values.
48099>>>>>>>>>>>
48099>>>>>>>>>>>    Procedure Field_Defaults
48100>>>>>>>>>>>        Forward Send Field_Defaults
48102>>>>>>>>>>>        //DDB-Generated-Code-Location
48102>>>>>>>>>>>        //DDB-FieldDefaultStart
48102>>>>>>>>>>>        //DDB-FieldDefaultEnd
48102>>>>>>>>>>>        //Set Field_Changed_Value Field Pmoves.Pms_VatPct to Item.Fpa_Pososto
48102>>>>>>>>>>>    End_Procedure    // Field_Defaults
48103>>>>>>>>>>>
48103>>>>>>>>>>>End_Class    // Pmoves_DataDictionary
48104>>>>>>>>>>>//DDB-FileEnd
48104>>>>>>>>>    Use PmsDtl.DD
INCLUDING FILE: PMSDTL.DD
48104>>>>>>>>>>>//DDB-FileStart
48104>>>>>>>>>>>//DDB-HeaderStart
48104>>>>>>>>>>>
48104>>>>>>>>>>>// File Name : PmsDtl.DD
48104>>>>>>>>>>>// Class Name: Pmsdtl_DataDictionary
48104>>>>>>>>>>>// Revision  : 0
48104>>>>>>>>>>>// Version   : 2
48104>>>>>>>>>>>
48104>>>>>>>>>>>Use  Windows           // Basic Definitions
48104>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48104>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48104>>>>>>>>>>>
48104>>>>>>>>>>>Open Pmsdtl
48106>>>>>>>>>>>Open Pmoves
48108>>>>>>>>>>>
48108>>>>>>>>>>>//DDB-HeaderEnd
48108>>>>>>>>>>>
48108>>>>>>>>>>>Class Pmsdtl_DataDictionary  is a DataDictionary_Sec
48109>>>>>>>>>>>
48109>>>>>>>>>>>    // Define_Fields:
48109>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48109>>>>>>>>>>>
48109>>>>>>>>>>>    Procedure Define_Fields
48110>>>>>>>>>>>        Forward Send Define_Fields
48112>>>>>>>>>>>        //DDB-Generated-Code-Location
48112>>>>>>>>>>>        //DDB-DefineFieldStart
48112>>>>>>>>>>>
48112>>>>>>>>>>>        Set Main_File            To Pmsdtl.File_Number
48113>>>>>>>>>>>
48113>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48114>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48115>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48116>>>>>>>>>>>
48116>>>>>>>>>>>        // Parent (Server) file structure...............
48116>>>>>>>>>>>        Send Add_Server_File  Pmoves.File_Number
48117>>>>>>>>>>>
48117>>>>>>>>>>>        // Field-based properties.......................
48117>>>>>>>>>>>
48117>>>>>>>>>>>        // Pmsdtl.Pms_Recr
48117>>>>>>>>>>>        Set Field_Options          Field Pmsdtl.Pms_Recr To DD_AUTOFIND   
48118>>>>>>>>>>>        Set Key_Field_State        Field Pmsdtl.Pms_Recr To TRUE
48119>>>>>>>>>>>
48119>>>>>>>>>>>        // Pmsdtl.Line1
48119>>>>>>>>>>>
48119>>>>>>>>>>>        // Pmsdtl.Line2
48119>>>>>>>>>>>
48119>>>>>>>>>>>        // Pmsdtl.Line3
48119>>>>>>>>>>>
48119>>>>>>>>>>>        // Pmsdtl.Line4
48119>>>>>>>>>>>
48119>>>>>>>>>>>        // Pmsdtl.Line5
48119>>>>>>>>>>>
48119>>>>>>>>>>>        //DDB-DefineFieldEnd
48119>>>>>>>>>>>    End_Procedure    // Define_Fields
48120>>>>>>>>>>>
48120>>>>>>>>>>>    // Field_Defaults:
48120>>>>>>>>>>>    // This procedure is used to establish default field values.
48120>>>>>>>>>>>
48120>>>>>>>>>>>    Procedure Field_Defaults
48121>>>>>>>>>>>        Forward Send Field_Defaults
48123>>>>>>>>>>>        //DDB-Generated-Code-Location
48123>>>>>>>>>>>        //DDB-FieldDefaultStart
48123>>>>>>>>>>>        //DDB-FieldDefaultEnd
48123>>>>>>>>>>>    End_Procedure    // Field_Defaults
48124>>>>>>>>>>>
48124>>>>>>>>>>>End_Class    // Pmsdtl_DataDictionary
48125>>>>>>>>>>>//DDB-FileEnd
48125>>>>>>>>>    Use BAXIOKAT.DD
INCLUDING FILE: BAXIOKAT.DD
48125>>>>>>>>>>>//DDB-FileStart
48125>>>>>>>>>>>//DDB-HeaderStart
48125>>>>>>>>>>>
48125>>>>>>>>>>>// File Name : BAXIOKAT.DD
48125>>>>>>>>>>>// Class Name: Baxiokat_DataDictionary
48125>>>>>>>>>>>// Revision  : 45
48125>>>>>>>>>>>// Version   : 2
48125>>>>>>>>>>>
48125>>>>>>>>>>>Use  Windows           // Basic Definitions
48125>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48125>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48125>>>>>>>>>>>
48125>>>>>>>>>>>Open Baxiokat
INCLUDING FILE: BAXIOKAT.FD
48127>>>>>>>>>>>Open Baxio
INCLUDING FILE: BAXIO.FD
48129>>>>>>>>>>>Open Bkinkat
INCLUDING FILE: BKINKAT.FD
48131>>>>>>>>>>>Open Tpclient
48133>>>>>>>>>>>Open Tperga
48135>>>>>>>>>>>Open Tparticl
48137>>>>>>>>>>>Open Sysrecb
INCLUDING FILE: SYSRECB.FD
48139>>>>>>>>>>>
48139>>>>>>>>>>>//DDB-HeaderEnd
48139>>>>>>>>>>>//DDB-ValidationStart
48139>>>>>>>>>>>
48139>>>>>>>>>>>//DDB/ ExternalValidationTable Baxiokat_Type_VT  BAXIO.PKG
48139>>>>>>>>>>>
48139>>>>>>>>>>>Register_Object Baxiokat_Type_VT
48139>>>>>>>>>>>Register_Object Baxiokat_Baxiokat_Yn5390_VT
48139>>>>>>>>>>>Register_Object Baxiokat_Baxiokat_Bank_VT
48139>>>>>>>>>>>Register_Object Baxiokat_Baxiokat_Formul_VT
48139>>>>>>>>>>>Use BAXIO.PKG        // Baxiokat_Type_VT
INCLUDING FILE: BAXIO.PKG
48139>>>>>>>>>>>>>// **************************************************************************
48139>>>>>>>>>>>>>// *Code Style   : Object                                                   *
48139>>>>>>>>>>>>>// *Name         : Baxio.vts                                                *
48139>>>>>>>>>>>>>// *Revision     : 1                                                        *
48139>>>>>>>>>>>>>// *Main File    :                                                          *
48139>>>>>>>>>>>>>// *Location     : \Home.Win\Easyware\ED\Appsrc                             *
48139>>>>>>>>>>>>>// *Creation Date: 01/09/99                                                 *
48139>>>>>>>>>>>>>// *Last Update  :                                                          *
48139>>>>>>>>>>>>>// *Author       : JA                                                       *
48139>>>>>>>>>>>>>// *Includes     :                                                          *
48139>>>>>>>>>>>>>// *Comments     : œ¨ â®œ  æ¢˜ «˜ static validation tables «¦¬             *
48139>>>>>>>>>>>>>// *             : module «à¤ ˜¥ ¦š¨á­à¤.                                   *
48139>>>>>>>>>>>>>// *             :                                                          *
48139>>>>>>>>>>>>>// *             :                                                          *
48139>>>>>>>>>>>>>// *Returns      :                                                          *
48139>>>>>>>>>>>>>// *             :                                                          *
48139>>>>>>>>>>>>>// *‰nown bugs   :                                                          *
48139>>>>>>>>>>>>>// *             :                                                          *
48139>>>>>>>>>>>>>// *Improvements :                                                          *
48139>>>>>>>>>>>>>// *             :                                                          *
48139>>>>>>>>>>>>>// *             :                                                          *
48139>>>>>>>>>>>>>// **************************************************************************
48139>>>>>>>>>>>>>// *                        A N A L Y S I S                                 *
48139>>>>>>>>>>>>>// **************************************************************************
48139>>>>>>>>>>>>>// *                                                                        *
48139>>>>>>>>>>>>>// **************************************************************************
48139>>>>>>>>>>>>>
48139>>>>>>>>>>>>>
48139>>>>>>>>>>>>>//Set Allow_Blank_State To TRUE
48139>>>>>>>>>>>>>
48139>>>>>>>>>>>>>//used by: 1. baxiokat.baxiokat_type
48139>>>>>>>>>>>>>Object Baxiokat_Type_VT  is a DescriptionValidationTable
48141>>>>>>>>>>>>>       set table_title to "„å›¦ª €¥ ¦š¨á­¦¬"
48142>>>>>>>>>>>>>       Procedure Fill_List
48144>>>>>>>>>>>>>                 Forward Send Fill_List
48146>>>>>>>>>>>>>                 Send Add_Table_Value  "1"  "„ ©§¨˜¡«â¦"
48147>>>>>>>>>>>>>                 send add_table_value  "2"  "¢ž¨à«â¦"
48148>>>>>>>>>>>>>       End_Procedure //fill_list
48149>>>>>>>>>>>>>End_Object   //Baxiokat_Type_VT
48150>>>>>>>>>>>>>
48150>>>>>>>>>>>>>
48150>>>>>>>>>>>>>//¡˜«˜©«á©œ ª ˜¥ ¦š¨á­à¤
48150>>>>>>>>>>>>>//used by: 1. bkinkat.baxio_stat_from :¡˜«á©«˜©ž ˜§æ
48150>>>>>>>>>>>>>//         2. bkinkat.baxio_stat_to   :¡˜«á©«˜©ž ©â
48150>>>>>>>>>>>>>//         3. baxio.baxio_status      :¡˜«á©«˜©ž
48150>>>>>>>>>>>>>//â¤˜ ˜¥ æš¨˜­¦ œå¤˜  § Ÿ˜¤æ ¤˜ ™¨œŸœå ©« ª §˜¨˜¡á«à 3 ¡˜«˜©«á©œ ª:
48150>>>>>>>>>>>>>Object Baxio_Status_VT  is a DescriptionValidationTable
48152>>>>>>>>>>>>>       set table_title to "‰˜«˜©«á©œ ª €¥ ¦š¨á­à¤"
48153>>>>>>>>>>>>>       Procedure Fill_List
48155>>>>>>>>>>>>>                 Forward Send Fill_List
48157>>>>>>>>>>>>>                 Send Add_Table_Value  "1"  "„¡¡¨œ£âª"
48158>>>>>>>>>>>>>                 Send Add_Table_Value  "2"  "„¥¦­¢ž£â¤¦"
48159>>>>>>>>>>>>>                 Send Add_Table_Value  "3"  "ƒ ˜£˜¨«¬¨ž£â¤¦"
48160>>>>>>>>>>>>>                 Send Add_Table_Value  "4"  "’˜£œå¦"
48161>>>>>>>>>>>>>                 Send Add_Table_Value  "5"  "ƒœ©£œ¬£â¤¦"
48162>>>>>>>>>>>>>
48162>>>>>>>>>>>>>       End_Procedure // fill_list
48163>>>>>>>>>>>>>End_Object   //Baxio_Status_VT1
48164>>>>>>>>>>>>>
48164>>>>>>>>>>>>>
48164>>>>>>>>>>>>>
48164>>>>>>>>>>>>>//used by: 1. btypkin.btypkin_anti1
48164>>>>>>>>>>>>>//         2. btypkin.btypkin_anti2
48164>>>>>>>>>>>>>//         3. baxio.baxio_file_in
48164>>>>>>>>>>>>>//         4. baxio.baxio_file_out
48164>>>>>>>>>>>>>//         5. baxio.baxio_lfile
48164>>>>>>>>>>>>>Object Bfile_VT  is a DescriptionValidationTable
48166>>>>>>>>>>>>>       set table_title to "‘¬¤˜¢¢˜©æ£œ¤¦ª/˜¨˜¢ã§«žª ˜§æ"
48167>>>>>>>>>>>>>       Procedure Fill_List
48169>>>>>>>>>>>>>                 Forward Send Fill_List
48171>>>>>>>>>>>>>                 Send Add_Table_Value  "-1" "ƒœ¤ “§á¨®œ "
48172>>>>>>>>>>>>>                 Send Add_Table_Value  "0"  "Data Entry"
48173>>>>>>>>>>>>>                 Send Add_Table_Value  "1"  "Š¦š˜¨ ˜©£é¤ ‚Š"
48174>>>>>>>>>>>>>                 send add_table_value  "2"  "”¦¨â˜ª"
48175>>>>>>>>>>>>>                 Send Add_Table_Value  "3"  "¨¦£žŸœ¬«é¤"
48176>>>>>>>>>>>>>                 Send Add_Table_Value  "5"  "Ž ‘¬¤˜¢¢˜©æ£œ¤¦ª"
48177>>>>>>>>>>>>>                 Send Add_Table_Value  "6"  "’œ¢.˜¨˜¢ã§«žª"
48178>>>>>>>>>>>>>       End_Procedure // fill_list
48179>>>>>>>>>>>>>End_Object   // Btypkin_Btypkin_Anti_VT
48180>>>>>>>>>>>>>
48180>>>>>>>>>>>
48180>>>>>>>>>>>Object Baxiokat_Baxiokat_Yn5390_VT  is a DescriptionValidationTable
48182>>>>>>>>>>>
48182>>>>>>>>>>>    Procedure Fill_List
48184>>>>>>>>>>>        Forward Send Fill_List
48186>>>>>>>>>>>        Send Add_Table_Value  "0"  "Ž® "
48187>>>>>>>>>>>        Send Add_Table_Value  "1"  "Œ˜ "
48188>>>>>>>>>>>    End_Procedure    // Fill_List
48189>>>>>>>>>>>    //DDB-ValidationCustomStart
48189>>>>>>>>>>>    //DDB-ValidationCustomEnd
48189>>>>>>>>>>>End_Object   // Baxiokat_Baxiokat_Yn5390_VT
48190>>>>>>>>>>>
48190>>>>>>>>>>>Object Baxiokat_Baxiokat_Bank_VT  is a CodeValidationTable
48192>>>>>>>>>>>    Set Type_Value        To "BANK"
48193>>>>>>>>>>>    Set Allow_Blank_State To TRUE
48194>>>>>>>>>>>    //DDB-ValidationCustomStart
48194>>>>>>>>>>>    //DDB-ValidationCustomEnd
48194>>>>>>>>>>>End_Object   // Baxiokat_Baxiokat_Bank_VT
48195>>>>>>>>>>>
48195>>>>>>>>>>>Object Baxiokat_Baxiokat_Formul_VT  is a DescriptionValidationTable
48197>>>>>>>>>>>    Set Allow_Blank_State To TRUE
48198>>>>>>>>>>>
48198>>>>>>>>>>>    Procedure Fill_List
48200>>>>>>>>>>>        Forward Send Fill_List
48202>>>>>>>>>>>        Send Add_Table_Value  "0"  ""
48203>>>>>>>>>>>        Send Add_Table_Value  "1"  "’ç§¦ª 1"
48204>>>>>>>>>>>        Send Add_Table_Value  "2"  "’ç§¦ª 2"
48205>>>>>>>>>>>    End_Procedure    // Fill_List
48206>>>>>>>>>>>    //DDB-ValidationCustomStart
48206>>>>>>>>>>>    //DDB-ValidationCustomEnd
48206>>>>>>>>>>>End_Object   // Baxiokat_Baxiokat_Formul_VT
48207>>>>>>>>>>>//DDB-ValidationEnd
48207>>>>>>>>>>>//DDB-SelectionStart
48207>>>>>>>>>>>//DDB/ ExternalSelectionList SL034  SL034.SL
48207>>>>>>>>>>>Register_Object SL034
48207>>>>>>>>>>>//DDB-SelectionEnd
48207>>>>>>>>>>>
48207>>>>>>>>>>>Open Syscurxr
48209>>>>>>>>>>>Open Btypkin
48211>>>>>>>>>>>Open Bkinkat
48213>>>>>>>>>>>
48213>>>>>>>>>>>
48213>>>>>>>>>>>// Apo Baxio_DD
48213>>>>>>>>>>>Register_Function private.Default_Axio_C_Code2 Returns String
48213>>>>>>>>>>>//
48213>>>>>>>>>>>
48213>>>>>>>>>>>Class Baxiokat_DataDictionary  is a DataDictionary_Sec
48214>>>>>>>>>>>
48214>>>>>>>>>>>     Procedure Creating
48215>>>>>>>>>>>        Forward Send Creating
48217>>>>>>>>>>>        // Insert Code Here
48217>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Baxiokat.Baxiokat_Rec0)))))) to Baxiokat.Baxiokat_Recr
48218>>>>>>>>>>>    End_Procedure   // Creating
48219>>>>>>>>>>>
48219>>>>>>>>>>>     Procedure Construct_Object
48220>>>>>>>>>>>               Forward Send Construct_Object
48222>>>>>>>>>>>
48222>>>>>>>>>>>               //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
48222>>>>>>>>>>>               //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
48222>>>>>>>>>>>               //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
48222>>>>>>>>>>>               //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
48222>>>>>>>>>>>               Property Integer piBarticl_dd  0
48223>>>>>>>>>>>               Property Integer piBmove_dd    0
48224>>>>>>>>>>>               Property Integer piBaxio_dd    0
48225>>>>>>>>>>>               Property Integer piBtypkin_dd 0
48226>>>>>>>>>>>     End_Procedure   //construct_object
48227>>>>>>>>>>>
48227>>>>>>>>>>>
48227>>>>>>>>>>>     //private
48227>>>>>>>>>>>     //¡˜¢œå«˜  ˜§æ: iexit «¦¬ baxiokat_code
48227>>>>>>>>>>>     //©œ«á¨œ      : «ž¤ default « £ã «¦¬ baxio_c_code2, ˜¤á¢¦š˜ £œ «¦ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
48227>>>>>>>>>>>     Procedure private.Exit_Baxiokat_Code Integer liField Integer liBaxiokat_Code
48228>>>>>>>>>>>               String lsBaxio_C_Code_2
48229>>>>>>>>>>>        PROCEDURE_RETURN
48230>>>>>>>>>>>//jsjsjs 24/01/2001
48230>>>>>>>>>>>//               Get File_Field_Current_Value File_Field Year.Year_C_Code0 to lsBaxio_C_Code_2
48230>>>>>>>>>>>
48230>>>>>>>>>>>//               Set Field_Changed_Value of (piBaxio_dd(Self)) Field Baxio.Baxio_C_Code2 to  lsBaxio_C_Code_2 //(private.Default_Axio_C_Code2((piBAxio_dd(Self))))
48230>>>>>>>>>>>//jsjsjs 24/01/2001
48230>>>>>>>>>>>     End_Procedure //private.exit_baxiokat_code
48231>>>>>>>>>>>
48231>>>>>>>>>>>
48231>>>>>>>>>>>    //private
48231>>>>>>>>>>>    //¡˜¢œå«˜  ˜§æ:
48231>>>>>>>>>>>    //©œ«á¨œ : «ž¤ default value to baxiokat_code, ˜¤á¢¦š˜ £œ «¦ btypkin.baxiokat_num
48231>>>>>>>>>>>    Procedure private.Entry_Baxiokat_Code Integer liField Integer liBaxiokat_Code
48232>>>>>>>>>>>              Integer liBtypkin_dd liBkinkat_Num liBtypkin_Rec0
48233>>>>>>>>>>>
48233>>>>>>>>>>>        PROCEDURE_RETURN
48234>>>>>>>>>>>
48234>>>>>>>>>>>
48234>>>>>>>>>>>    End_Procedure //private.entry_gtypkin_code
48235>>>>>>>>>>>
48235>>>>>>>>>>>
48235>>>>>>>>>>>
48235>>>>>>>>>>>
48235>>>>>>>>>>>    Procedure Update
48236>>>>>>>>>>>          Forward Send Update
48238>>>>>>>>>>>          If (Baxiokat.Baxiokat_Yn5390 = 0);          Begin //œá¤ ›â¤ œå¤˜  £ž®˜¤¦š¨˜­ž£â¤œª œ§ «˜šâª, £ž›â¤ ©œ æ¢˜ «˜ ©®œ« ¡á §œ›å˜
48240>>>>>>>>>>>               Move "" to Baxiokat.Baxiokat_Bank
48241>>>>>>>>>>>               Move "" to Baxiokat.Baxiokat_Lno
48242>>>>>>>>>>>               Move 0  to Baxiokat.Baxiokat_Formul
48243>>>>>>>>>>>          End
48243>>>>>>>>>>>>
48243>>>>>>>>>>>    End_Procedure
48244>>>>>>>>>>>
48244>>>>>>>>>>>
48244>>>>>>>>>>>    Procedure Define_Fields
48245>>>>>>>>>>>        Forward Send Define_Fields
48247>>>>>>>>>>>        //DDB-Generated-Code-Location
48247>>>>>>>>>>>        //DDB-DefineFieldStart
48247>>>>>>>>>>>
48247>>>>>>>>>>>        Set Main_File            To Baxiokat.File_Number
48248>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
48249>>>>>>>>>>>
48249>>>>>>>>>>>
48249>>>>>>>>>>>        // Child (Client) file structure................
48249>>>>>>>>>>>        Send Add_Client_File  Baxio.File_Number
48250>>>>>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
48251>>>>>>>>>>>        Send Add_Client_File  Tpclient.File_Number
48252>>>>>>>>>>>        Send Add_Client_File  Tperga.File_Number
48253>>>>>>>>>>>        Send Add_Client_File  Tparticl.File_Number
48254>>>>>>>>>>>
48254>>>>>>>>>>>        // External (System) file structure.............
48254>>>>>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
48255>>>>>>>>>>>
48255>>>>>>>>>>>        Define_Auto_Increment  Sysrecb.Baxiokat_Rec0  To Baxiokat.Baxiokat_Rec0
48258>>>>>>>>>>>
48258>>>>>>>>>>>        // Field-based properties.......................
48258>>>>>>>>>>>
48258>>>>>>>>>>>        // Baxiokat.Baxiokat_Code
48258>>>>>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Code To (SL034(Self))
48259>>>>>>>>>>>
48259>>>>>>>>>>>        // Baxiokat.Baxiokat_Descr
48259>>>>>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Descr To (SL034(Self))
48260>>>>>>>>>>>
48260>>>>>>>>>>>        // Baxiokat.Baxiokat_Rec0
48260>>>>>>>>>>>
48260>>>>>>>>>>>        // Baxiokat.Baxiokat_Recr
48260>>>>>>>>>>>
48260>>>>>>>>>>>        // Baxiokat.Baxiokat_Type
48260>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Type To (Baxiokat_Type_VT(Self))
48261>>>>>>>>>>>
48261>>>>>>>>>>>        // Baxiokat.Baxio_Lcode
48261>>>>>>>>>>>        //DDB/ Comment_Short       Field Baxiokat.Baxio_Lcode To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ creating/deleting «¦¬ baxio)"
48261>>>>>>>>>>>
48261>>>>>>>>>>>        // Baxiokat.Baxiokat_Yn5390
48261>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Yn5390 To (Baxiokat_Baxiokat_Yn5390_VT(Self))
48262>>>>>>>>>>>
48262>>>>>>>>>>>        // Baxiokat.Baxiokat_Bank
48262>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Bank To (Baxiokat_Baxiokat_Bank_VT(Self))
48263>>>>>>>>>>>
48263>>>>>>>>>>>        // Baxiokat.Baxiokat_Lno
48263>>>>>>>>>>>
48263>>>>>>>>>>>        // Baxiokat.Baxiokat_Formul
48263>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Formul To (Baxiokat_Baxiokat_Formul_VT(Self))
48264>>>>>>>>>>>
48264>>>>>>>>>>>        //DDB-DefineFieldEnd
48264>>>>>>>>>>>
48264>>>>>>>>>>>        Set Main_File            To Baxiokat.File_Number
48265>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
48266>>>>>>>>>>>
48266>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
48267>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
48268>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48269>>>>>>>>>>>
48269>>>>>>>>>>>        // Child (Client) file structure................
48269>>>>>>>>>>>        Send Add_Client_File  Baxio.File_Number
48270>>>>>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
48271>>>>>>>>>>>
48271>>>>>>>>>>>        // External (System) file structure.............
48271>>>>>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
48272>>>>>>>>>>>
48272>>>>>>>>>>>        Define_Auto_Increment  Sysrecb.Baxiokat_Rec0  To Baxiokat.Baxiokat_Rec0
48275>>>>>>>>>>>
48275>>>>>>>>>>>        // Field-based properties.......................
48275>>>>>>>>>>>
48275>>>>>>>>>>>        // Baxiokat.Baxiokat_Code
48275>>>>>>>>>>>        Set Field_Entry_msg        Field Baxiokat.Baxiokat_Code   To private.Entry_Baxiokat_Code
48276>>>>>>>>>>>        Set Field_Exit_msg         Field Baxiokat.Baxiokat_Code   To private.Exit_Baxiokat_Code
48277>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Code   To "‰à› ¡æª „å›¦¬ª €¥ ¦š¨á­¦¬"
48278>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Code   To "„å›¦ª"
48279>>>>>>>>>>>        Set Field_Options          Field Baxiokat.Baxiokat_Code   To DD_AUTOFIND    DD_REQUIRED
48280>>>>>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Code   To (SL034(Self))
48281>>>>>>>>>>>        Set Key_Field_State        Field Baxiokat.Baxiokat_Code   To TRUE
48282>>>>>>>>>>>
48282>>>>>>>>>>>        // Baxiokat.Baxiokat_Descr
48282>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Descr  To "œ¨ š¨˜­ã „å›¦¬ª €¥ ¦š¨á­¦¬"
48283>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Descr  To "œ¨ š¨˜­ã"
48284>>>>>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Descr  To (SL034(Self))
48285>>>>>>>>>>>
48285>>>>>>>>>>>        // Baxiokat.Baxiokat_Rec0
48285>>>>>>>>>>>        Set Field_Options          Field Baxiokat.Baxiokat_Rec0   To DD_AUTOFIND    DD_REQUIRED
48286>>>>>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Rec0   To (SL034(Self))
48287>>>>>>>>>>>        Set Key_Field_State        Field Baxiokat.Baxiokat_Rec0   To TRUE
48288>>>>>>>>>>>
48288>>>>>>>>>>>        // Baxiokat.Baxiokat_Type
48288>>>>>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Type   To "dbComboForm_EZ"
48289>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Type   To "„ ©§¨˜¡«â¦/¢ž¨à«â¦"
48290>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Type   To "„ ©./¢ã¨."
48291>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Type   To (Baxiokat_Type_VT(Self))
48292>>>>>>>>>>>
48292>>>>>>>>>>>        // Baxiokat.Baxio_Lcode
48292>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxio_Lcode     To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª €¥ ¦šá­¦¬"
48293>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxio_Lcode     To "’œ¢.€¨ Ÿ£æª"
48294>>>>>>>>>>>        //Set Field_Options          Field Baxiokat.Baxio_Lcode     To DD_DISPLAYONLY
48294>>>>>>>>>>>
48294>>>>>>>>>>>        // Baxiokat.Baxiokat_Yn5390
48294>>>>>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Yn5390 To "dbComboForm_EZ"
48295>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Yn5390 To "‹ž®˜¤¦š¨˜­ž£â¤œª „§ «˜šâª ?"
48296>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Yn5390 To "‹ž®/¡âª „§ «˜šâª"
48297>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Yn5390 To (Baxiokat_Baxiokat_Yn5390_VT(Self))
48298>>>>>>>>>>>
48298>>>>>>>>>>>        // Baxiokat.Baxiokat_Bank
48298>>>>>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Bank   To "dbComboForm_EZ"
48299>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Bank   To "’¨á§œ˜"
48300>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Bank   To "’¨á§œ˜"
48301>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Bank   To (Baxiokat_Baxiokat_Bank_VT(Self))
48302>>>>>>>>>>>
48302>>>>>>>>>>>        // Baxiokat.Baxiokat_Lno
48302>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Lno    To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª"
48303>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Lno    To "’œ¢.€¨ Ÿ£æª"
48304>>>>>>>>>>>
48304>>>>>>>>>>>        // Baxiokat.Baxiokat_Formul
48304>>>>>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Formul To "dbComboForm_EZ"
48305>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Formul To "€¢šæ¨ Ÿ£¦ª Check Digit"
48306>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Formul To "Check Digit"
48307>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Formul To (Baxiokat_Baxiokat_Formul_VT(Self))
48308>>>>>>>>>>>
48308>>>>>>>>>>>    End_Procedure    // Define_Fields
48309>>>>>>>>>>>
48309>>>>>>>>>>>
48309>>>>>>>>>>>    Procedure Field_Defaults
48310>>>>>>>>>>>        Forward Send Field_Defaults
48312>>>>>>>>>>>        //DDB-Generated-Code-Location
48312>>>>>>>>>>>        //DDB-FieldDefaultStart
48312>>>>>>>>>>>        //DDB-FieldDefaultEnd
48312>>>>>>>>>>>        Set Field_Changed_Value   Field Baxiokat.Baxiokat_Yn5390 To 0
48313>>>>>>>>>>>    End_Procedure    // Field_Defaults
48314>>>>>>>>>>>
48314>>>>>>>>>>>End_Class    // Baxiokat_DataDictionary
48315>>>>>>>>>>>//DDB-Selection-pkg-Start
48315>>>>>>>>>>>
48315>>>>>>>>>>>Use SL034.SL         // SL034
INCLUDING FILE: SL034.SL
48315>>>>>>>>>>>>>//AB/ Project SL034:BAXIOKAT
48315>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
48315>>>>>>>>>>>>>//AB/     Set ProjectName to "SL034:BAXIOKAT"
48315>>>>>>>>>>>>>//AB/     Set ProjectFileName to "SL034.SL"
48315>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
48315>>>>>>>>>>>>>
48315>>>>>>>>>>>>>// Project Object Structure
48315>>>>>>>>>>>>>//   SL034 is a dbModalPanelSub
48315>>>>>>>>>>>>>//     Baxiokat_DD is a DataDictionary
48315>>>>>>>>>>>>>//     oSelList is a dbListSub
48315>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
48315>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
48315>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
48315>>>>>>>>>>>>>
48315>>>>>>>>>>>>>// Register all objects
48315>>>>>>>>>>>>>Register_Object Baxiokat_DD
48315>>>>>>>>>>>>>Register_Object oCancel_bn
48315>>>>>>>>>>>>>Register_Object oOK_bn
48315>>>>>>>>>>>>>Register_Object oSearch_bn
48315>>>>>>>>>>>>>Register_Object oSelList
48315>>>>>>>>>>>>>Register_Object SL034
48315>>>>>>>>>>>>>
48315>>>>>>>>>>>>>
48315>>>>>>>>>>>>>//AB-IgnoreStart
48315>>>>>>>>>>>>>
48315>>>>>>>>>>>>>Use DFAllEnt.pkg
48315>>>>>>>>>>>>>Use dbList.Sub
48315>>>>>>>>>>>>>Use Button.Sub
48315>>>>>>>>>>>>>
48315>>>>>>>>>>>>>
48315>>>>>>>>>>>>>Use BAXIOKAT.DD
48315>>>>>>>>>>>>>
48315>>>>>>>>>>>>>//AB-IgnoreEnd
48315>>>>>>>>>>>>>
48315>>>>>>>>>>>>>CD_Popup_Object SL034 is a dbModalPanelSub
48334>>>>>>>>>>>>>    set label to "‰˜«žš¦¨åœª €¥ ¦š¨á­à¤" 
48335>>>>>>>>>>>>>    Set Size to 206 347
48336>>>>>>>>>>>>>    Set Location to 4 5
48337>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
48338>>>>>>>>>>>>>    Set Modal_State to FALSE
48339>>>>>>>>>>>>>
48339>>>>>>>>>>>>>    //AB-DDOStart
48339>>>>>>>>>>>>>
48339>>>>>>>>>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
48341>>>>>>>>>>>>>    End_Object    // Baxiokat_DD
48342>>>>>>>>>>>>>
48342>>>>>>>>>>>>>    Set Main_DD to (Baxiokat_DD(self))
48343>>>>>>>>>>>>>    Set Server to (Baxiokat_DD(self))
48344>>>>>>>>>>>>>
48344>>>>>>>>>>>>>    //AB-DDOEnd
48344>>>>>>>>>>>>>
48344>>>>>>>>>>>>>    Object oSelList is a dbListSub
48346>>>>>>>>>>>>>        Set Main_File to Baxiokat.File_Number
48347>>>>>>>>>>>>>        Set Size to 164 335
48348>>>>>>>>>>>>>        Set Location to 5 4
48349>>>>>>>>>>>>>
48349>>>>>>>>>>>>>        Begin_Row
48352>>>>>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_code
48353>>>>>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_descr
48354>>>>>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_type
48355>>>>>>>>>>>>>            Entry_Item (Export_Code_Description(Self,2,Baxiokat.Baxiokat_type))
48356>>>>>>>>>>>>>        End_Row
48361>>>>>>>>>>>>>
48361>>>>>>>>>>>>>        Set Form_Width    item 0 to 55
48362>>>>>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
48363>>>>>>>>>>>>>
48363>>>>>>>>>>>>>        Set Form_Width    item 1 to 172
48364>>>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
48365>>>>>>>>>>>>>
48365>>>>>>>>>>>>>        Set Form_Width    item 2 to 16
48366>>>>>>>>>>>>>        set header_label  item 2 to "’ç§¦ª" 
48367>>>>>>>>>>>>>
48367>>>>>>>>>>>>>        Set Form_Width    item 3 to 83
48368>>>>>>>>>>>>>        set header_label  item 3 to "„ ©./¢ž¨." 
48369>>>>>>>>>>>>>
48369>>>>>>>>>>>>>    End_Object    // oSelList
48370>>>>>>>>>>>>>
48370>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
48372>>>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
48373>>>>>>>>>>>>>        Set Location to 172 180
48374>>>>>>>>>>>>>
48374>>>>>>>>>>>>>        //AB-StoreStart
48374>>>>>>>>>>>>>        Procedure OnClick
48376>>>>>>>>>>>>>            Send OK To oSelList
48377>>>>>>>>>>>>>        End_Procedure
48378>>>>>>>>>>>>>        //AB-StoreEnd
48378>>>>>>>>>>>>>
48378>>>>>>>>>>>>>    End_Object    // oOK_bn
48379>>>>>>>>>>>>>
48379>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
48381>>>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
48382>>>>>>>>>>>>>        Set Location to 172 234
48383>>>>>>>>>>>>>
48383>>>>>>>>>>>>>        //AB-StoreStart
48383>>>>>>>>>>>>>        Procedure OnClick
48385>>>>>>>>>>>>>            Send Cancel To oSelList
48386>>>>>>>>>>>>>        End_Procedure
48387>>>>>>>>>>>>>        //AB-StoreEnd
48387>>>>>>>>>>>>>
48387>>>>>>>>>>>>>    End_Object    // oCancel_bn
48388>>>>>>>>>>>>>
48388>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
48390>>>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
48391>>>>>>>>>>>>>        Set Location to 172 289
48392>>>>>>>>>>>>>
48392>>>>>>>>>>>>>        //AB-StoreStart
48392>>>>>>>>>>>>>        Procedure OnClick
48394>>>>>>>>>>>>>            Send Search To oSelList
48395>>>>>>>>>>>>>        End_Procedure
48396>>>>>>>>>>>>>        //AB-StoreEnd
48396>>>>>>>>>>>>>
48396>>>>>>>>>>>>>    End_Object    // oSearch_bn
48397>>>>>>>>>>>>>
48397>>>>>>>>>>>>>
48397>>>>>>>>>>>>>    //AB-StoreStart
48397>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
48398>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
48399>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
48400>>>>>>>>>>>>>    //AB-StoreEnd
48400>>>>>>>>>>>>>
48400>>>>>>>>>>>>>CD_End_Object    // SL034
48402>>>>>>>>>>>>>>
48402>>>>>>>>>>>>>
48402>>>>>>>>>>>>>//AB/ End_Object    // prj
48402>>>>>>>>>>>
48402>>>>>>>>>>>//DDB-Selection-pkg-End
48402>>>>>>>>>>>//DDB-FileEnd
48402>>>>>>>>>    Use SYSCURXR.DD
INCLUDING FILE: SYSCURXR.DD
48402>>>>>>>>>>>//DDB-FileStart
48402>>>>>>>>>>>//DDB-HeaderStart
48402>>>>>>>>>>>
48402>>>>>>>>>>>// File Name : SYSCURXR.DD
48402>>>>>>>>>>>// Class Name: Syscurxr_DataDictionary
48402>>>>>>>>>>>// Revision  : 8
48402>>>>>>>>>>>// Version   : 2
48402>>>>>>>>>>>
48402>>>>>>>>>>>Use  Windows           // Basic Definitions
48402>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48402>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48402>>>>>>>>>>>
48402>>>>>>>>>>>Open Syscurxr
48404>>>>>>>>>>>
48404>>>>>>>>>>>//DDB-HeaderEnd
48404>>>>>>>>>>>
48404>>>>>>>>>>>Class Syscurxr_DataDictionary  is a DataDictionary_Sec
48405>>>>>>>>>>>
48405>>>>>>>>>>>    // Define_Fields:
48405>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48405>>>>>>>>>>>
48405>>>>>>>>>>>    Procedure Define_Fields
48406>>>>>>>>>>>        Forward Send Define_Fields
48408>>>>>>>>>>>        //DDB-Generated-Code-Location
48408>>>>>>>>>>>        //DDB-DefineFieldStart
48408>>>>>>>>>>>
48408>>>>>>>>>>>        Set Main_File            To Syscurxr.File_Number
48409>>>>>>>>>>>
48409>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
48410>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
48411>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48412>>>>>>>>>>>
48412>>>>>>>>>>>        // Field-based properties.......................
48412>>>>>>>>>>>
48412>>>>>>>>>>>        // Syscurxr.Company_Code
48412>>>>>>>>>>>
48412>>>>>>>>>>>        // Syscurxr.Branch_Code
48412>>>>>>>>>>>
48412>>>>>>>>>>>        // Syscurxr.Year_Year
48412>>>>>>>>>>>
48412>>>>>>>>>>>        // Syscurxr.Branch_Site
48412>>>>>>>>>>>
48412>>>>>>>>>>>        // Syscurxr.Year_Recr
48412>>>>>>>>>>>
48412>>>>>>>>>>>        // Syscurxr.Company_Name
48412>>>>>>>>>>>
48412>>>>>>>>>>>        // Syscurxr.Branch_Name
48412>>>>>>>>>>>
48412>>>>>>>>>>>        // Syscurxr.Year_Descr
48412>>>>>>>>>>>
48412>>>>>>>>>>>        // Syscurxr.C_Code0
48412>>>>>>>>>>>
48412>>>>>>>>>>>        // Syscurxr.C_Code00
48412>>>>>>>>>>>
48412>>>>>>>>>>>        // Syscurxr.C_Coder
48412>>>>>>>>>>>
48412>>>>>>>>>>>        // Syscurxr.Year_Xrhshfrom
48412>>>>>>>>>>>
48412>>>>>>>>>>>        // Syscurxr.Year_Xrhshto
48412>>>>>>>>>>>
48412>>>>>>>>>>>        // Syscurxr.Beto_Site
48412>>>>>>>>>>>
48412>>>>>>>>>>>        // Syscurxr.Euro_Code
48412>>>>>>>>>>>
48412>>>>>>>>>>>        //DDB-DefineFieldEnd
48412>>>>>>>>>>>    End_Procedure    // Define_Fields
48413>>>>>>>>>>>
48413>>>>>>>>>>>    // Field_Defaults:
48413>>>>>>>>>>>    // This procedure is used to establish default field values.
48413>>>>>>>>>>>
48413>>>>>>>>>>>    Procedure Field_Defaults
48414>>>>>>>>>>>        Forward Send Field_Defaults
48416>>>>>>>>>>>        //DDB-Generated-Code-Location
48416>>>>>>>>>>>        //DDB-FieldDefaultStart
48416>>>>>>>>>>>        //DDB-FieldDefaultEnd
48416>>>>>>>>>>>    End_Procedure    // Field_Defaults
48417>>>>>>>>>>>
48417>>>>>>>>>>>End_Class    // Syscurxr_DataDictionary
48418>>>>>>>>>>>//DDB-FileEnd
48418>>>>>>>>>    Use PMSSXET.DD
48418>>>>>>>>>    Use SALESMEN.DD
INCLUDING FILE: SALESMEN.DD
48418>>>>>>>>>>>//DDB-FileStart
48418>>>>>>>>>>>//DDB-HeaderStart
48418>>>>>>>>>>>
48418>>>>>>>>>>>// File Name : SALESMEN.DD
48418>>>>>>>>>>>// Class Name: Salesmen_DataDictionary
48418>>>>>>>>>>>// Revision  : 57
48418>>>>>>>>>>>// Version   : 2
48418>>>>>>>>>>>
48418>>>>>>>>>>>Use  Windows           // Basic Definitions
48418>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48418>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48418>>>>>>>>>>>
48418>>>>>>>>>>>Open Salesmen
48420>>>>>>>>>>>Open Cn
48422>>>>>>>>>>>Open Sysrecc
48424>>>>>>>>>>>
48424>>>>>>>>>>>//DDB-HeaderEnd
48424>>>>>>>>>>>//DDB-ValidationStart
48424>>>>>>>>>>>
48424>>>>>>>>>>>Register_Object Salesmen_Sls_Doy_VT
48424>>>>>>>>>>>
48424>>>>>>>>>>>Object Salesmen_Sls_Doy_VT  is a CodeValidationTable
48426>>>>>>>>>>>    Set Type_Value        To "DOY"
48427>>>>>>>>>>>    Set Allow_Blank_State To TRUE
48428>>>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
48429>>>>>>>>>>>    //DDB-ValidationCustomStart
48429>>>>>>>>>>>    //DDB-ValidationCustomEnd
48429>>>>>>>>>>>End_Object   // Salesmen_Sls_Doy_VT
48430>>>>>>>>>>>//DDB-ValidationEnd
48430>>>>>>>>>>>//DDB-SelectionStart
48430>>>>>>>>>>>//DDB/ ExternalSelectionList sl108  sl108.sl
48430>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
48430>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
48430>>>>>>>>>>>Register_Object sl108
48430>>>>>>>>>>>Register_Object sl198
48430>>>>>>>>>>>Register_Object sl197
48430>>>>>>>>>>>//DDB-SelectionEnd
48430>>>>>>>>>>>
48430>>>>>>>>>>>Class Salesmen_DataDictionary  is a DataDictionary_Sec
48431>>>>>>>>>>> 
48431>>>>>>>>>>>    // Save_Main_File:
48431>>>>>>>>>>> 
48431>>>>>>>>>>>    Procedure Save_Main_File
48432>>>>>>>>>>>        If ((Operation_Origin<>Self) And (Salesmen.Sls_ID='')) Procedure_Return
48435>>>>>>>>>>>        Forward Send Save_Main_File
48437>>>>>>>>>>>    End_Procedure   // Save_Main_File
48438>>>>>>>>>>> 
48438>>>>>>>>>>>    // Define_Fields:
48438>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48438>>>>>>>>>>>     Procedure Update
48439>>>>>>>>>>>        Forward Send Update
48441>>>>>>>>>>>        // Insert Code Here
48441>>>>>>>>>>>        Move SysCurXR.Company_Code  to salesmen.Company_Code
48442>>>>>>>>>>>        Move SysCurXR.Branch_Code   to salesmen.Branch_Code
48443>>>>>>>>>>>        Move SysCurXR.Year_Year     to salesmen.Year_Year
48444>>>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
48444>>>>>>>>>>>        Move (salesmen.Xreosh-salesmen.Pistosh)   to salesmen.Ypoloipo
48445>>>>>>>>>>>        Move (salesmen.Plafon-salesmen.ypoloipo)  to salesmen.Overhead
48446>>>>>>>>>>>
48446>>>>>>>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
48446>>>>>>>>>>>
48446>>>>>>>>>>>        //betolink
48446>>>>>>>>>>>        Move SysCurXR.Beto_Site      to salesmen.sls_SiteW
48447>>>>>>>>>>>        Move salesmen.sls_Rec0       to salesmen.sls_SN
48448>>>>>>>>>>>        Move salesmen.sls_id         to salesmen.sls_Repm
48449>>>>>>>>>>>
48449>>>>>>>>>>>    End_Procedure   // Update
48450>>>>>>>>>>>
48450>>>>>>>>>>>     Procedure Creating
48451>>>>>>>>>>>        Forward Send Creating
48453>>>>>>>>>>>        // Insert Code Here
48453>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(salesmen.sls_Rec0))))));                                    to salesmen.sls_Recr
48454>>>>>>>>>>>        Move '1'                    to salesmen.sls_Active
48455>>>>>>>>>>>        get fsgCode_With_Zeroes salesmen.sls_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to salesmen.sls_ID
48456>>>>>>>>>>>    End_Procedure   // Creating
48457>>>>>>>>>>>
48457>>>>>>>>>>>    Procedure Define_Fields
48458>>>>>>>>>>>        Forward Send Define_Fields
48460>>>>>>>>>>>        //DDB-Generated-Code-Location
48460>>>>>>>>>>>        //DDB-DefineFieldStart
48460>>>>>>>>>>>
48460>>>>>>>>>>>        Set Main_File            To Salesmen.File_Number
48461>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
48462>>>>>>>>>>>
48462>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48463>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48464>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48465>>>>>>>>>>>
48465>>>>>>>>>>>        // Child (Client) file structure................
48465>>>>>>>>>>>        Send Add_Client_File  Cn.File_Number
48466>>>>>>>>>>>
48466>>>>>>>>>>>        // External (System) file structure.............
48466>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
48467>>>>>>>>>>>
48467>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Salesmen_Rec0  To Salesmen.Sls_Rec0
48470>>>>>>>>>>>
48470>>>>>>>>>>>        // Field-based properties.......................
48470>>>>>>>>>>>
48470>>>>>>>>>>>        // Salesmen.Company_Code
48470>>>>>>>>>>>
48470>>>>>>>>>>>        // Salesmen.Branch_Code
48470>>>>>>>>>>>
48470>>>>>>>>>>>        // Salesmen.Year_Year
48470>>>>>>>>>>>
48470>>>>>>>>>>>        // Salesmen.Sls_Id
48470>>>>>>>>>>>        Set Field_Options          Field Salesmen.Sls_Id To DD_AUTOFIND    DD_FINDREQ    
48471>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Id To (sl108(Self))
48472>>>>>>>>>>>        Set Key_Field_State        Field Salesmen.Sls_Id To TRUE
48473>>>>>>>>>>>
48473>>>>>>>>>>>        // Salesmen.Sls_Name
48473>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Name To (sl108(Self))
48474>>>>>>>>>>>
48474>>>>>>>>>>>        // Salesmen.Sls_Afm
48474>>>>>>>>>>>
48474>>>>>>>>>>>        // Salesmen.Sls_Rec0
48474>>>>>>>>>>>
48474>>>>>>>>>>>        // Salesmen.Sls_Recr
48474>>>>>>>>>>>
48474>>>>>>>>>>>        // Salesmen.Last_Xreosh
48474>>>>>>>>>>>
48474>>>>>>>>>>>        // Salesmen.Last_Pistosh
48474>>>>>>>>>>>
48474>>>>>>>>>>>        // Salesmen.Last_Order
48474>>>>>>>>>>>
48474>>>>>>>>>>>        // Salesmen.Sls_Doy
48474>>>>>>>>>>>        Set Field_Value_Table      Field Salesmen.Sls_Doy To (Salesmen_Sls_Doy_VT(Self))
48475>>>>>>>>>>>
48475>>>>>>>>>>>        // Salesmen.Sls_Address
48475>>>>>>>>>>>
48475>>>>>>>>>>>        // Salesmen.Sls_City
48475>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_City To (sl198(Self))
48476>>>>>>>>>>>
48476>>>>>>>>>>>        // Salesmen.Sls_Area
48476>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Area To (sl197(Self))
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Job
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Respons
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Zipcode
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Phone
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Fax
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Mobile
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Aoh
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Email
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Class
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Details
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Sitew
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Codem
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Categfpa
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Fpa
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Public
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Sn
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Repm
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Active
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Reported
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Lastupd
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Markexp
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Catjob
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Xreosh
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Pistosh
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Ypoloipo
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Plafon
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Overhead
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Add_No
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Nomos
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Sls_Xora
48477>>>>>>>>>>>
48477>>>>>>>>>>>        // Salesmen.Polh_Recr
48477>>>>>>>>>>>
48477>>>>>>>>>>>        //DDB-DefineFieldEnd
48477>>>>>>>>>>>    End_Procedure    // Define_Fields
48478>>>>>>>>>>>
48478>>>>>>>>>>>    // Field_Defaults:
48478>>>>>>>>>>>    // This procedure is used to establish default field values.
48478>>>>>>>>>>>
48478>>>>>>>>>>>    Procedure Field_Defaults
48479>>>>>>>>>>>        Forward Send Field_Defaults
48481>>>>>>>>>>>        //DDB-Generated-Code-Location
48481>>>>>>>>>>>        //DDB-FieldDefaultStart
48481>>>>>>>>>>>        Set Field_Changed_Value   Field Salesmen.Sls_Doy To "0"
48482>>>>>>>>>>>        //DDB-FieldDefaultEnd
48482>>>>>>>>>>>    End_Procedure    // Field_Defaults
48483>>>>>>>>>>>
48483>>>>>>>>>>>End_Class    // Salesmen_DataDictionary
48484>>>>>>>>>>>//DDB-Selection-pkg-Start
48484>>>>>>>>>>>
48484>>>>>>>>>>>Use sl108.sl         // sl108
INCLUDING FILE: SL108.SL
48484>>>>>>>>>>>>>//AB/ Project sl108:polhtes
48484>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
48484>>>>>>>>>>>>>//AB/     Set ProjectName to "sl108:polhtes"
48484>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl108.SL"
48484>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
48484>>>>>>>>>>>>>
48484>>>>>>>>>>>>>// Project Object Structure
48484>>>>>>>>>>>>>//   sl108 is a dbModalPanelSub
48484>>>>>>>>>>>>>//     Salesmen_DD is a DataDictionary
48484>>>>>>>>>>>>>//     oSelList is a dbListSub
48484>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
48484>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
48484>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
48484>>>>>>>>>>>>>
48484>>>>>>>>>>>>>// Register all objects
48484>>>>>>>>>>>>>Register_Object oCancel_bn
48484>>>>>>>>>>>>>Register_Object oOK_bn
48484>>>>>>>>>>>>>Register_Object oSearch_bn
48484>>>>>>>>>>>>>Register_Object oSelList
48484>>>>>>>>>>>>>Register_Object Salesmen_DD
48484>>>>>>>>>>>>>Register_Object sl108
48484>>>>>>>>>>>>>
48484>>>>>>>>>>>>>
48484>>>>>>>>>>>>>//AB-IgnoreStart
48484>>>>>>>>>>>>>
48484>>>>>>>>>>>>>Use DFAllEnt.pkg
48484>>>>>>>>>>>>>Use dbList.Sub
48484>>>>>>>>>>>>>Use Button.Sub
48484>>>>>>>>>>>>>
48484>>>>>>>>>>>>>
48484>>>>>>>>>>>>>Use SALESMEN.DD
48484>>>>>>>>>>>>>
48484>>>>>>>>>>>>>//AB-IgnoreEnd
48484>>>>>>>>>>>>>
48484>>>>>>>>>>>>>Object sl108 is a dbModalPanelSub
48486>>>>>>>>>>>>>    Set Label to "‹ž«¨é¦ à¢ž«é¤"
48487>>>>>>>>>>>>>    Set Size to 148 421
48488>>>>>>>>>>>>>    Set Location to 4 5
48489>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
48490>>>>>>>>>>>>>    Set Modal_State to FALSE
48491>>>>>>>>>>>>>
48491>>>>>>>>>>>>>    //AB-DDOStart
48491>>>>>>>>>>>>>
48491>>>>>>>>>>>>>    Object Salesmen_DD is a Salesmen_DataDictionary
48493>>>>>>>>>>>>>    End_Object    // Salesmen_DD
48494>>>>>>>>>>>>>
48494>>>>>>>>>>>>>    Set Main_DD to (Salesmen_DD(self))
48495>>>>>>>>>>>>>    Set Server to (Salesmen_DD(self))
48496>>>>>>>>>>>>>
48496>>>>>>>>>>>>>    //AB-DDOEnd
48496>>>>>>>>>>>>>
48496>>>>>>>>>>>>>    Object oSelList is a dbListSub
48498>>>>>>>>>>>>>        Set Main_File to Salesmen.File_Number
48499>>>>>>>>>>>>>        Set Size to 105 408
48500>>>>>>>>>>>>>        Set Location to 6 6
48501>>>>>>>>>>>>>
48501>>>>>>>>>>>>>        Begin_Row
48504>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_id
48505>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_name
48506>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_afm
48507>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_address
48508>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_phone
48509>>>>>>>>>>>>>        End_Row
48514>>>>>>>>>>>>>
48514>>>>>>>>>>>>>        Set Form_Width    item 0 to 60
48515>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
48516>>>>>>>>>>>>>        
48516>>>>>>>>>>>>>        Set Form_Width    item 1 to 100
48517>>>>>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
48518>>>>>>>>>>>>>        
48518>>>>>>>>>>>>>        Set Form_Width    item 2 to 60
48519>>>>>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
48520>>>>>>>>>>>>>        
48520>>>>>>>>>>>>>        Set Form_Width    item 3 to 125
48521>>>>>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
48522>>>>>>>>>>>>>        
48522>>>>>>>>>>>>>        Set Form_Width    item 4 to 54
48523>>>>>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
48524>>>>>>>>>>>>>        
48524>>>>>>>>>>>>>    End_Object    // oSelList
48525>>>>>>>>>>>>>
48525>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
48527>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
48528>>>>>>>>>>>>>        Set Location to 117 255
48529>>>>>>>>>>>>>
48529>>>>>>>>>>>>>        //AB-StoreStart
48529>>>>>>>>>>>>>        Procedure OnClick
48531>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
48532>>>>>>>>>>>>>        End_Procedure
48533>>>>>>>>>>>>>        //AB-StoreEnd
48533>>>>>>>>>>>>>
48533>>>>>>>>>>>>>    End_Object    // oOK_bn
48534>>>>>>>>>>>>>
48534>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
48536>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
48537>>>>>>>>>>>>>        Set Location to 117 310
48538>>>>>>>>>>>>>
48538>>>>>>>>>>>>>        //AB-StoreStart
48538>>>>>>>>>>>>>        Procedure OnClick
48540>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
48541>>>>>>>>>>>>>        End_Procedure
48542>>>>>>>>>>>>>        //AB-StoreEnd
48542>>>>>>>>>>>>>
48542>>>>>>>>>>>>>    End_Object    // oCancel_bn
48543>>>>>>>>>>>>>
48543>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
48545>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
48546>>>>>>>>>>>>>        Set Location to 117 365
48547>>>>>>>>>>>>>
48547>>>>>>>>>>>>>        //AB-StoreStart
48547>>>>>>>>>>>>>        Procedure OnClick
48549>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
48550>>>>>>>>>>>>>        End_Procedure
48551>>>>>>>>>>>>>        //AB-StoreEnd
48551>>>>>>>>>>>>>
48551>>>>>>>>>>>>>    End_Object    // oSearch_bn
48552>>>>>>>>>>>>>
48552>>>>>>>>>>>>>
48552>>>>>>>>>>>>>    //AB-StoreStart
48552>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
48553>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
48554>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
48555>>>>>>>>>>>>>    //AB-StoreEnd
48555>>>>>>>>>>>>>
48555>>>>>>>>>>>>>End_Object    // sl108
48556>>>>>>>>>>>>>
48556>>>>>>>>>>>>>//AB/ End_Object    // prj
48556>>>>>>>>>>>Use sl198.sl         // sl198
48556>>>>>>>>>>>Use sl197.SL         // sl197
48556>>>>>>>>>>>
48556>>>>>>>>>>>//DDB-Selection-pkg-End
48556>>>>>>>>>>>//DDB-FileEnd
48556>>>>>>>>>    Use CONSTRCT.DD
INCLUDING FILE: CONSTRCT.DD
48556>>>>>>>>>>>//DDB-FileStart
48556>>>>>>>>>>>//DDB-HeaderStart
48556>>>>>>>>>>>
48556>>>>>>>>>>>// File Name : CONSTRCT.DD
48556>>>>>>>>>>>// Class Name: Constrct_DataDictionary
48556>>>>>>>>>>>// Revision  : 49
48556>>>>>>>>>>>// Version   : 2
48556>>>>>>>>>>>
48556>>>>>>>>>>>Use  Windows           // Basic Definitions
48556>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48556>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48556>>>>>>>>>>>
48556>>>>>>>>>>>Open Constrct
48558>>>>>>>>>>>Open Cn
48560>>>>>>>>>>>Open Sysrecc
48562>>>>>>>>>>>
48562>>>>>>>>>>>//DDB-HeaderEnd
48562>>>>>>>>>>>//DDB-ValidationStart
48562>>>>>>>>>>>
48562>>>>>>>>>>>Register_Object Constrct_Cnt_Doy_VT1
48562>>>>>>>>>>>
48562>>>>>>>>>>>Object Constrct_Cnt_Doy_VT1  is a CodeValidationTable
48564>>>>>>>>>>>    Set Type_Value        To "DOY"
48565>>>>>>>>>>>    Set Allow_Blank_State To TRUE
48566>>>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
48567>>>>>>>>>>>    //DDB-ValidationCustomStart
48567>>>>>>>>>>>    //DDB-ValidationCustomEnd
48567>>>>>>>>>>>End_Object   // Constrct_Cnt_Doy_VT1
48568>>>>>>>>>>>//DDB-ValidationEnd
48568>>>>>>>>>>>//DDB-SelectionStart
48568>>>>>>>>>>>//DDB/ ExternalSelectionList sl109  sl109.SL
48568>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
48568>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
48568>>>>>>>>>>>Register_Object sl109
48568>>>>>>>>>>>Register_Object sl198
48568>>>>>>>>>>>Register_Object sl197
48568>>>>>>>>>>>//DDB-SelectionEnd
48568>>>>>>>>>>>
48568>>>>>>>>>>>Class Constrct_DataDictionary  is a DataDictionary_Sec
48569>>>>>>>>>>>    Procedure Update
48570>>>>>>>>>>>        Forward Send Update
48572>>>>>>>>>>>        // Insert Code Here
48572>>>>>>>>>>>        Move SysCurXR.Company_Code  to constrct.Company_Code
48573>>>>>>>>>>>        Move SysCurXR.Branch_Code   to constrct.Branch_Code
48574>>>>>>>>>>>        Move SysCurXR.Year_Year     to constrct.Year_Year
48575>>>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
48575>>>>>>>>>>>        Move (constrct.Xreosh-Constrct.Pistosh)   to Constrct.Ypoloipo
48576>>>>>>>>>>>        Move (constrct.Plafon-Constrct.Ypoloipo)  to Constrct.Overhead
48577>>>>>>>>>>>
48577>>>>>>>>>>>        //betolink
48577>>>>>>>>>>>        Move SysCurXR.Beto_Site      to Constrct.cnt_SiteW
48578>>>>>>>>>>>        Move Constrct.cnt_Rec0        to Constrct.cnt_SN
48579>>>>>>>>>>>        Move Constrct.cnt_id          to constrct.cnt_Repm
48580>>>>>>>>>>>
48580>>>>>>>>>>>    End_Procedure   // Update
48581>>>>>>>>>>>
48581>>>>>>>>>>>     Procedure Creating
48582>>>>>>>>>>>        Forward Send Creating
48584>>>>>>>>>>>        // Insert Code Here
48584>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Constrct.cnt_Rec0))))));                                    to Constrct.Cnt_Recr
48585>>>>>>>>>>>        Move '1'                    to Constrct.Cnt_Active
48586>>>>>>>>>>>        Get fsgCode_With_Zeroes Constrct.Cnt_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Constrct.cnt_ID
48587>>>>>>>>>>>    End_Procedure   // Creating
48588>>>>>>>>>>>
48588>>>>>>>>>>>
48588>>>>>>>>>>>    Procedure Define_Fields
48589>>>>>>>>>>>        Forward Send Define_Fields
48591>>>>>>>>>>>        //DDB-Generated-Code-Location
48591>>>>>>>>>>>        //DDB-DefineFieldStart
48591>>>>>>>>>>>
48591>>>>>>>>>>>        Set Main_File            To Constrct.File_Number
48592>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
48593>>>>>>>>>>>
48593>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48594>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48595>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48596>>>>>>>>>>>
48596>>>>>>>>>>>        // Child (Client) file structure................
48596>>>>>>>>>>>        Send Add_Client_File  Cn.File_Number
48597>>>>>>>>>>>
48597>>>>>>>>>>>        // External (System) file structure.............
48597>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
48598>>>>>>>>>>>
48598>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Constrct_Rec0  To Constrct.Cnt_Rec0
48601>>>>>>>>>>>
48601>>>>>>>>>>>        // Field-based properties.......................
48601>>>>>>>>>>>
48601>>>>>>>>>>>        // Constrct.Company_Code
48601>>>>>>>>>>>
48601>>>>>>>>>>>        // Constrct.Branch_Code
48601>>>>>>>>>>>
48601>>>>>>>>>>>        // Constrct.Year_Year
48601>>>>>>>>>>>
48601>>>>>>>>>>>        // Constrct.Cnt_Id
48601>>>>>>>>>>>        Set Field_Options          Field Constrct.Cnt_Id To DD_AUTOFIND    DD_NOPUT      
48602>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Id To (sl109(Self))
48603>>>>>>>>>>>        Set Key_Field_State        Field Constrct.Cnt_Id To TRUE
48604>>>>>>>>>>>
48604>>>>>>>>>>>        // Constrct.Cnt_Name
48604>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Name To (sl109(Self))
48605>>>>>>>>>>>
48605>>>>>>>>>>>        // Constrct.Cnt_Afm
48605>>>>>>>>>>>
48605>>>>>>>>>>>        // Constrct.Cnt_Rec0
48605>>>>>>>>>>>
48605>>>>>>>>>>>        // Constrct.Cnt_Recr
48605>>>>>>>>>>>
48605>>>>>>>>>>>        // Constrct.Last_Xreosh
48605>>>>>>>>>>>
48605>>>>>>>>>>>        // Constrct.Last_Pistosh
48605>>>>>>>>>>>
48605>>>>>>>>>>>        // Constrct.Last_Order
48605>>>>>>>>>>>
48605>>>>>>>>>>>        // Constrct.Cnt_Doy
48605>>>>>>>>>>>        Set Field_Value_Table      Field Constrct.Cnt_Doy To (Constrct_Cnt_Doy_VT1(Self))
48606>>>>>>>>>>>
48606>>>>>>>>>>>        // Constrct.Cnt_Address
48606>>>>>>>>>>>
48606>>>>>>>>>>>        // Constrct.Cnt_City
48606>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_City To (sl198(Self))
48607>>>>>>>>>>>
48607>>>>>>>>>>>        // Constrct.Cnt_Area
48607>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Area To (sl197(Self))
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Job
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Respons
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Zipcode
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Phone
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Fax
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Mobile
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Aoh
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Email
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Class
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Details
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Sitew
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Codem
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Categfpa
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Fpa
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Public
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Sn
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Repm
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Active
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Reported
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Pelprom
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Lastupdated
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Markexp
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Catjob
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Xreosh
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Pistosh
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Ypoloipo
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Plafon
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Overhead
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Add_No
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Nomos
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Cnt_Xora
48608>>>>>>>>>>>
48608>>>>>>>>>>>        // Constrct.Polh_Recr
48608>>>>>>>>>>>
48608>>>>>>>>>>>        //DDB-DefineFieldEnd
48608>>>>>>>>>>>    End_Procedure    // Define_Fields
48609>>>>>>>>>>>
48609>>>>>>>>>>>    // Field_Defaults:
48609>>>>>>>>>>>    // This procedure is used to establish default field values.
48609>>>>>>>>>>>
48609>>>>>>>>>>>    Procedure Field_Defaults
48610>>>>>>>>>>>        Forward Send Field_Defaults
48612>>>>>>>>>>>        //DDB-Generated-Code-Location
48612>>>>>>>>>>>        //DDB-FieldDefaultStart
48612>>>>>>>>>>>        Set Field_Changed_Value   Field Constrct.Cnt_Doy To "0"
48613>>>>>>>>>>>        //DDB-FieldDefaultEnd
48613>>>>>>>>>>>    End_Procedure    // Field_Defaults
48614>>>>>>>>>>>
48614>>>>>>>>>>>End_Class    // Constrct_DataDictionary
48615>>>>>>>>>>>//DDB-Selection-pkg-Start
48615>>>>>>>>>>>
48615>>>>>>>>>>>Use sl109.SL         // sl109
INCLUDING FILE: SL109.SL
48615>>>>>>>>>>>>>//AB/ Project sl109
48615>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
48615>>>>>>>>>>>>>//AB/     Set ProjectName to "sl109"
48615>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl109.SL"
48615>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
48615>>>>>>>>>>>>>
48615>>>>>>>>>>>>>// Project Object Structure
48615>>>>>>>>>>>>>//   sl109 is a dbModalPanelSub
48615>>>>>>>>>>>>>//     Constrct_DD is a DataDictionary
48615>>>>>>>>>>>>>//     oSelList is a dbListSub
48615>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
48615>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
48615>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
48615>>>>>>>>>>>>>
48615>>>>>>>>>>>>>// Register all objects
48615>>>>>>>>>>>>>Register_Object Constrct_DD
48615>>>>>>>>>>>>>Register_Object oCancel_bn
48615>>>>>>>>>>>>>Register_Object oOK_bn
48615>>>>>>>>>>>>>Register_Object oSearch_bn
48615>>>>>>>>>>>>>Register_Object oSelList
48615>>>>>>>>>>>>>Register_Object sl109
48615>>>>>>>>>>>>>
48615>>>>>>>>>>>>>
48615>>>>>>>>>>>>>//AB-IgnoreStart
48615>>>>>>>>>>>>>
48615>>>>>>>>>>>>>Use DFAllEnt.pkg
48615>>>>>>>>>>>>>Use dbList.Sub
48615>>>>>>>>>>>>>Use Button.Sub
48615>>>>>>>>>>>>>
48615>>>>>>>>>>>>>
48615>>>>>>>>>>>>>Use CONSTRCT.DD
48615>>>>>>>>>>>>>
48615>>>>>>>>>>>>>//AB-IgnoreEnd
48615>>>>>>>>>>>>>
48615>>>>>>>>>>>>>Object sl109 is a dbModalPanelSub
48617>>>>>>>>>>>>>    Set Label to "„¨š¦¢á™¦  "
48618>>>>>>>>>>>>>    Set Size to 148 427
48619>>>>>>>>>>>>>    Set Location to 4 5
48620>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
48621>>>>>>>>>>>>>    Set Modal_State to FALSE
48622>>>>>>>>>>>>>
48622>>>>>>>>>>>>>    //AB-DDOStart
48622>>>>>>>>>>>>>
48622>>>>>>>>>>>>>    Object Constrct_DD is a Constrct_DataDictionary
48624>>>>>>>>>>>>>    End_Object    // Constrct_DD
48625>>>>>>>>>>>>>
48625>>>>>>>>>>>>>    Set Main_DD to (Constrct_DD(self))
48626>>>>>>>>>>>>>    Set Server to (Constrct_DD(self))
48627>>>>>>>>>>>>>
48627>>>>>>>>>>>>>    //AB-DDOEnd
48627>>>>>>>>>>>>>
48627>>>>>>>>>>>>>    Object oSelList is a dbListSub
48629>>>>>>>>>>>>>        Set Main_File to Constrct.File_Number
48630>>>>>>>>>>>>>        Set Size to 105 415
48631>>>>>>>>>>>>>        Set Location to 6 6
48632>>>>>>>>>>>>>
48632>>>>>>>>>>>>>        Begin_Row
48635>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_id
48636>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_name
48637>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_afm
48638>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_address
48639>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_phone
48640>>>>>>>>>>>>>        End_Row
48645>>>>>>>>>>>>>
48645>>>>>>>>>>>>>        Set Form_Width    item 0 to 70
48646>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
48647>>>>>>>>>>>>>        
48647>>>>>>>>>>>>>        Set Form_Width    item 1 to 100
48648>>>>>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
48649>>>>>>>>>>>>>        
48649>>>>>>>>>>>>>        Set Form_Width    item 2 to 50
48650>>>>>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
48651>>>>>>>>>>>>>        
48651>>>>>>>>>>>>>        Set Form_Width    item 3 to 135
48652>>>>>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
48653>>>>>>>>>>>>>        
48653>>>>>>>>>>>>>        Set Form_Width    item 4 to 52
48654>>>>>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
48655>>>>>>>>>>>>>        
48655>>>>>>>>>>>>>    End_Object    // oSelList
48656>>>>>>>>>>>>>
48656>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
48658>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
48659>>>>>>>>>>>>>        Set Location to 116 261
48660>>>>>>>>>>>>>
48660>>>>>>>>>>>>>        //AB-StoreStart
48660>>>>>>>>>>>>>        Procedure OnClick
48662>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
48663>>>>>>>>>>>>>        End_Procedure
48664>>>>>>>>>>>>>        //AB-StoreEnd
48664>>>>>>>>>>>>>
48664>>>>>>>>>>>>>    End_Object    // oOK_bn
48665>>>>>>>>>>>>>
48665>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
48667>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
48668>>>>>>>>>>>>>        Set Location to 116 315
48669>>>>>>>>>>>>>
48669>>>>>>>>>>>>>        //AB-StoreStart
48669>>>>>>>>>>>>>        Procedure OnClick
48671>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
48672>>>>>>>>>>>>>        End_Procedure
48673>>>>>>>>>>>>>        //AB-StoreEnd
48673>>>>>>>>>>>>>
48673>>>>>>>>>>>>>    End_Object    // oCancel_bn
48674>>>>>>>>>>>>>
48674>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
48676>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
48677>>>>>>>>>>>>>        Set Location to 116 371
48678>>>>>>>>>>>>>
48678>>>>>>>>>>>>>        //AB-StoreStart
48678>>>>>>>>>>>>>        Procedure OnClick
48680>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
48681>>>>>>>>>>>>>        End_Procedure
48682>>>>>>>>>>>>>        //AB-StoreEnd
48682>>>>>>>>>>>>>
48682>>>>>>>>>>>>>    End_Object    // oSearch_bn
48683>>>>>>>>>>>>>
48683>>>>>>>>>>>>>
48683>>>>>>>>>>>>>    //AB-StoreStart
48683>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
48684>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
48685>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
48686>>>>>>>>>>>>>    //AB-StoreEnd
48686>>>>>>>>>>>>>
48686>>>>>>>>>>>>>End_Object    // sl109
48687>>>>>>>>>>>>>
48687>>>>>>>>>>>>>//AB/ End_Object    // prj
48687>>>>>>>>>>>Use sl198.sl         // sl198
48687>>>>>>>>>>>Use sl197.SL         // sl197
48687>>>>>>>>>>>
48687>>>>>>>>>>>//DDB-Selection-pkg-End
48687>>>>>>>>>>>//DDB-FileEnd
48687>>>>>>>>>    Use CN.DD
48687>>>>>>>>>    Use PSXETIKA.DD
INCLUDING FILE: PSXETIKA.DD
48687>>>>>>>>>>>//DDB-FileStart
48687>>>>>>>>>>>//DDB-HeaderStart
48687>>>>>>>>>>>
48687>>>>>>>>>>>// File Name : PSXETIKA.DD
48687>>>>>>>>>>>// Class Name: Psxetika_DataDictionary
48687>>>>>>>>>>>// Revision  : 14
48687>>>>>>>>>>>// Version   : 2
48687>>>>>>>>>>>
48687>>>>>>>>>>>Use  Windows           // Basic Definitions
48687>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48687>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48687>>>>>>>>>>>
48687>>>>>>>>>>>Open Psxetika
48689>>>>>>>>>>>Open Particle
48691>>>>>>>>>>>Open Sysrecp
48693>>>>>>>>>>>
48693>>>>>>>>>>>//DDB-HeaderEnd
48693>>>>>>>>>>>
48693>>>>>>>>>>>Class Psxetika_DataDictionary  is a DataDictionary_Sec
48694>>>>>>>>>>>
48694>>>>>>>>>>>    Procedure Creating
48695>>>>>>>>>>>        Integer iNextNo
48696>>>>>>>>>>>        Forward Send Creating
48698>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Psxetika.Psxetika_Rec0)))))) to Psxetika.Psxetika_Recr
48699>>>>>>>>>>>    End_Procedure   // Creating
48700>>>>>>>>>>>
48700>>>>>>>>>>>    Procedure Update
48701>>>>>>>>>>>        Forward Send Update
48703>>>>>>>>>>>        Move SysCurXR.Company_Code  to Psxetika.Company_Code
48704>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Psxetika.Branch_Code
48705>>>>>>>>>>>        Move SysCurXR.Year_Year     to Psxetika.Year_Year
48706>>>>>>>>>>>        Move Clients.Client_ID      to Psxetika.Client_ID
48707>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Psxetika.Ctypkin_Code
48708>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Psxetika.Wtypkin_Code
48709>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code   to Psxetika.Ptyppar_Code
48710>>>>>>>>>>>        Move Particle.Partl_Hmnia   to Psxetika.Partl_Hmnia
48711>>>>>>>>>>>        Move Particle.Pseira_Seira  to Psxetika.Pseira_Seira
48712>>>>>>>>>>>        Move Particle.Partl_No      to Psxetika.Partl_No
48713>>>>>>>>>>>    End_Procedure   // Update
48714>>>>>>>>>>>
48714>>>>>>>>>>>
48714>>>>>>>>>>>    Procedure Request_Save
48715>>>>>>>>>>>        Number  nQty
48716>>>>>>>>>>>        String  sParticleRecr sPsxetikaRecr
48716>>>>>>>>>>>
48716>>>>>>>>>>>        Forward Send Request_Save
48718>>>>>>>>>>>
48718>>>>>>>>>>>        Get File_Field_Current_Value File_Field Particle.Partl_Recr     to sParticleRecr
48719>>>>>>>>>>>        Get File_Field_Current_Value File_Field Psxetika.Psx_Partl_Recr to sPsxetikaRecr
48720>>>>>>>>>>>        If ((Trim(sParticleRecr)<>'') And (Trim(sPsxetikaRecr)<>'')) Begin
48722>>>>>>>>>>>            Get File_Field_Current_Value File_Field Psxetika.Pms_Sx_Qty to nQty
48723>>>>>>>>>>>            If (nQty=0) Begin
48725>>>>>>>>>>>                // An h posothta pou menei apo to athroisma posothtas ton Pmoves Sxetika
48725>>>>>>>>>>>                // Mhdenisei, ayto shmainei pos den yparxoun alla Pmoves Sxetika, ara
48725>>>>>>>>>>>                // prepei na diagrafei ayto to Psxetika record kai to antistrofo tou.
48725>>>>>>>>>>>                Delete Psxetika
48726>>>>>>>>>>>                Clear Psxetika
48727>>>>>>>>>>>                Move sPsxetikaRecr  to Psxetika.Partl_Recr
48728>>>>>>>>>>>                Move sParticleRecr  to Psxetika.Psx_Partl_Recr
48729>>>>>>>>>>>                Find Eq Psxetika by Index.4
48730>>>>>>>>>>>>
48730>>>>>>>>>>>                If (Found) Delete Psxetika
48733>>>>>>>>>>>            End
48733>>>>>>>>>>>>
48733>>>>>>>>>>>        End
48733>>>>>>>>>>>>
48733>>>>>>>>>>>    End_Procedure
48734>>>>>>>>>>>
48734>>>>>>>>>>>
48734>>>>>>>>>>>    // Define_Fields:
48734>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48734>>>>>>>>>>>
48734>>>>>>>>>>>    Procedure Define_Fields
48735>>>>>>>>>>>        Forward Send Define_Fields
48737>>>>>>>>>>>        //DDB-Generated-Code-Location
48737>>>>>>>>>>>        //DDB-DefineFieldStart
48737>>>>>>>>>>>
48737>>>>>>>>>>>        Set Main_File            To Psxetika.File_Number
48738>>>>>>>>>>>
48738>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
48739>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
48740>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48741>>>>>>>>>>>
48741>>>>>>>>>>>        // Parent (Server) file structure...............
48741>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
48742>>>>>>>>>>>
48742>>>>>>>>>>>        // External (System) file structure.............
48742>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
48743>>>>>>>>>>>
48743>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Psxetika_Rec0  To Psxetika.Psxetika_Rec0
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Field-based properties.......................
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Company_Code
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Branch_Code
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Year_Year
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Ctypkin_Code
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Wtypkin_Code
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Ptyppar_Code
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Pseira_Seira
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Custprom_Code
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Client_Id
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Partl_No
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Partl_Hmnia
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Partl_Recr
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Psx_Partl_Recr
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Psxetika_Recr
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Psxetika_Rec0
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Sx_Company_Code
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Sx_Branch_Code
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Sx_Year_Year
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Sx_Ctypkin_Code
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Sx_Wtypkin_Code
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Sx_Ptyppar_Code
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Sx_Pseira_Seira
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Sx_Custpromcode
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Sx_Client_Id
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Sx_Partl_No
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Sx_Partl_Hmnia
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Sx_Ctypkin_Desc
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Sx_Wtypkin_Desc
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Sx_Ptyppar_Desc
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Sx_Custpromdesc
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Sx_Client_Desc
48746>>>>>>>>>>>
48746>>>>>>>>>>>        // Psxetika.Pms_Sx_Qty
48746>>>>>>>>>>>
48746>>>>>>>>>>>        //DDB-DefineFieldEnd
48746>>>>>>>>>>>    End_Procedure    // Define_Fields
48747>>>>>>>>>>>
48747>>>>>>>>>>>    // Field_Defaults:
48747>>>>>>>>>>>    // This procedure is used to establish default field values.
48747>>>>>>>>>>>
48747>>>>>>>>>>>    Procedure Field_Defaults
48748>>>>>>>>>>>        Forward Send Field_Defaults
48750>>>>>>>>>>>        //DDB-Generated-Code-Location
48750>>>>>>>>>>>        //DDB-FieldDefaultStart
48750>>>>>>>>>>>        //DDB-FieldDefaultEnd
48750>>>>>>>>>>>    End_Procedure    // Field_Defaults
48751>>>>>>>>>>>
48751>>>>>>>>>>>End_Class    // Psxetika_DataDictionary
48752>>>>>>>>>>>//DDB-FileEnd
48752>>>>>>>>>    Use TPARTICL.DD
INCLUDING FILE: TPARTICL.DD
48752>>>>>>>>>>>//DDB-FileStart
48752>>>>>>>>>>>//DDB-HeaderStart
48752>>>>>>>>>>>
48752>>>>>>>>>>>// File Name : TPARTICL.DD
48752>>>>>>>>>>>// Class Name: Tparticl_DataDictionary
48752>>>>>>>>>>>// Revision  : 28
48752>>>>>>>>>>>// Version   : 2
48752>>>>>>>>>>>
48752>>>>>>>>>>>Use  Windows           // Basic Definitions
48752>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48752>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48752>>>>>>>>>>>
48752>>>>>>>>>>>Open Tparticl
48754>>>>>>>>>>>Open Particle
48756>>>>>>>>>>>Open Baxiokat
48758>>>>>>>>>>>Open Sysrecc
48760>>>>>>>>>>>
48760>>>>>>>>>>>//DDB-HeaderEnd
48760>>>>>>>>>>>//DDB-ValidationStart
48760>>>>>>>>>>>
48760>>>>>>>>>>>Register_Object Mera_Tou_Mhna_VT
48760>>>>>>>>>>>
48760>>>>>>>>>>>Object Mera_Tou_Mhna_VT  is a CodeValidationTable
48762>>>>>>>>>>>    Set Type_Value        To "HMERES"
48763>>>>>>>>>>>    Set Allow_Blank_State To TRUE
48764>>>>>>>>>>>    //DDB-ValidationCustomStart
48764>>>>>>>>>>>    //DDB-ValidationCustomEnd
48764>>>>>>>>>>>End_Object   // Mera_Tou_Mhna_VT
48765>>>>>>>>>>>//DDB-ValidationEnd
48765>>>>>>>>>>>
48765>>>>>>>>>>>Class Tparticl_DataDictionary  is a DataDictionary_Sec
48766>>>>>>>>>>>
48766>>>>>>>>>>>    Procedure Construct_Object
48767>>>>>>>>>>>        Forward Send Construct_Object
48769>>>>>>>>>>>        Property Integer piParticleID Public 0
48770>>>>>>>>>>>        Property Integer piBaxiokatID Public 0
48771>>>>>>>>>>>    End_Procedure
48772>>>>>>>>>>>
48772>>>>>>>>>>>    Procedure End_Construct_Object
48773>>>>>>>>>>>        Integer iID
48774>>>>>>>>>>>        Forward Send End_Construct_Object
48776>>>>>>>>>>>        Move (Find_Server_DDO(Self,Particle.File_Number )) to iID
48777>>>>>>>>>>>        Set piParticleID to iID
48778>>>>>>>>>>>        Move (Find_Server_DDO(Self,Baxiokat.File_Number )) to iID
48779>>>>>>>>>>>        Set piBaxiokatID to iID
48780>>>>>>>>>>>    End_Procedure
48781>>>>>>>>>>>
48781>>>>>>>>>>>    Procedure Calc_All_The_Fields
48782>>>>>>>>>>>        Number  nSynolo nPoso nPososto naxia
48783>>>>>>>>>>>        Date    dHmniaPlhromhs dHmniaParalabhs dHmniaTimologiou
48783>>>>>>>>>>>        Date    dProkeiptei dProsDate dAddDate dStartDate dEndDate
48783>>>>>>>>>>>        Integer iMeresXaritos iMeratouMhna iMeresParalabhs iID iInt iAdd
48783>>>>>>>>>>>        Integer iMeresPlhroteo iCode iXhmero iMhnasTimologiou  iMet
48783>>>>>>>>>>>
48783>>>>>>>>>>>        Get piBaxiokatID                                                to iID
48784>>>>>>>>>>>        Get Field_Current_Value Of iID Field Baxiokat.Baxiokat_Code     to iCode
48785>>>>>>>>>>>
48785>>>>>>>>>>>
48785>>>>>>>>>>>        Get piParticleID                                                to iID
48786>>>>>>>>>>>        Get Field_Current_Value Of iID Field Particle.Partl_Payam       to nSynolo
48787>>>>>>>>>>>        Get Field_Current_Value Of iID Field Particle.Partl_Hmnia       to dHmniaTimologiou
48788>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Pct_Epi_Synolou   to nPososto
48789>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Paralabh_Meres    to iMeresParalabhs
48790>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Xarhtos_Meres     to iMeresXaritos
48791>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Plhroteo_Meres    to iMeresPlhroteo
48792>>>>>>>>>>>
48792>>>>>>>>>>>        //////////////////////////////////////////////////////////////////////////
48792>>>>>>>>>>>        /////        10 (x)     -      10 (y)         /          30 (z)      /////
48792>>>>>>>>>>>        /////  iMeresParalabhs    iMeresXaritos              iMeresPlhroteo  /////
48792>>>>>>>>>>>        //////////////////////////////////////////////////////////////////////////
48792>>>>>>>>>>>
48792>>>>>>>>>>>        //  1. Kathorise thn 1h tou mhna, hmeromhniaka
48792>>>>>>>>>>>        Move ('01'+'/'+(String(TheMonthSegment(dHmniaTimologiou)))+'/'+;                       (String(TheYearSegment(dHmniaTimologiou)))) to dStartDate
48793>>>>>>>>>>>
48793>>>>>>>>>>>//        //  2. Vres thn Hmeromhnia paralabhs (Teleytaia hmera tou epomenou y hmerou
48793>>>>>>>>>>>//        //     sthn opoia meta tha prosthesoume tis hmeres paralabhs (x) )
48793>>>>>>>>>>>//        Move dStartDate to dHmniaParalabhs
48793>>>>>>>>>>>//        While (dHmniaParalabhs<(dHmniaTimologiou+iMeresXaritos))
48793>>>>>>>>>>>//            Add iMeresXaritos to dHmniaParalabhs
48793>>>>>>>>>>>//        Loop
48793>>>>>>>>>>>//        Add iMeresParalabhs to dHmniaParalabhs
48793>>>>>>>>>>>
48793>>>>>>>>>>>//        //  3. Vres thn Hmeromhnia Lhxhs ths epitaghs  (Teleytaia hmera tou trxontos y hmerou
48793>>>>>>>>>>>//        //     sthn opoia meta tha prosthesoume tis hmeres plhroteo (z) )
48793>>>>>>>>>>>//        Move dStartDate to dHmniaPlhromhs
48793>>>>>>>>>>>//        While (dHmniaPlhromhs<dHmniaTimologiou)
48793>>>>>>>>>>>//            Add iMeresXaritos to dHmniaPlhromhs
48793>>>>>>>>>>>//        Loop
48793>>>>>>>>>>>//        Add iMeresPlhroteo  to dHmniaPlhromhs
48793>>>>>>>>>>>
48793>>>>>>>>>>>        //  2. Vres thn Hmeromhnia  ths teleytaias hmera tou trexontos y hmerou
48793>>>>>>>>>>>        Move dStartDate to dHmniaParalabhs
48794>>>>>>>>>>>        If (iMeresXaritos<>0) Begin
48796>>>>>>>>>>>            While (dHmniaParalabhs<dHmniaTimologiou)
48800>>>>>>>>>>>                Add iMeresXaritos   to dHmniaParalabhs
48801>>>>>>>>>>>            Loop
48802>>>>>>>>>>>>
48802>>>>>>>>>>>        End
48802>>>>>>>>>>>>
48802>>>>>>>>>>>        Move dHmniaParalabhs    to dHmniaPlhromhs
48803>>>>>>>>>>>
48803>>>>>>>>>>>        Add (iMeresParalabhs-1) to dHmniaParalabhs
48804>>>>>>>>>>>        Add (iMeresPlhroteo-1)  to dHmniaPlhromhs
48805>>>>>>>>>>>
48805>>>>>>>>>>>        // Ypologise prota to poso bash posostou se sxesh me synolo parastatikou
48805>>>>>>>>>>>        Move (Round_number((nSynolo*nPososto/100),2))   to naxia
48806>>>>>>>>>>>
48806>>>>>>>>>>>        Set Field_Changed_Value Field TParticl.Poso     to naxia
48807>>>>>>>>>>>        Set Field_Changed_Value Field TParticl.Paralabh to dHmniaParalabhs
48808>>>>>>>>>>>        Set Field_Changed_Value Field TParticl.Exoflhsh to dHmniaPlhromhs
48809>>>>>>>>>>>
48809>>>>>>>>>>>    End_Procedure
48810>>>>>>>>>>>
48810>>>>>>>>>>>
48810>>>>>>>>>>>    Procedure Creating
48811>>>>>>>>>>>        Forward Send Creating
48813>>>>>>>>>>>        // Insert Code Here
48813>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Tparticl.Tparticl_Rec0))))));                                    to Tparticl.Tparticl_Recr
48814>>>>>>>>>>>    End_Procedure   // Creating
48815>>>>>>>>>>>
48815>>>>>>>>>>>
48815>>>>>>>>>>>    Procedure Save_Main_File
48816>>>>>>>>>>>        If (tparticl.isok <> '1') move ' ' to tparticl.isok
48819>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
48821>>>>>>>>>>>            If tparticl.Recnum Eq 0 Procedure_Return
48824>>>>>>>>>>>        End
48824>>>>>>>>>>>>
48824>>>>>>>>>>>      Forward Send Save_Main_File
48826>>>>>>>>>>>    End_Procedure   // Save_Main_File
48827>>>>>>>>>>>
48827>>>>>>>>>>>
48827>>>>>>>>>>>    // Define_Fields:
48827>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48827>>>>>>>>>>>
48827>>>>>>>>>>>    Procedure Define_Fields
48828>>>>>>>>>>>        Forward Send Define_Fields
48830>>>>>>>>>>>        //DDB-Generated-Code-Location
48830>>>>>>>>>>>        //DDB-DefineFieldStart
48830>>>>>>>>>>>
48830>>>>>>>>>>>        Set Main_File            To Tparticl.File_Number
48831>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
48832>>>>>>>>>>>
48832>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48833>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48834>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48835>>>>>>>>>>>
48835>>>>>>>>>>>        // Parent (Server) file structure...............
48835>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
48836>>>>>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
48837>>>>>>>>>>>
48837>>>>>>>>>>>        // External (System) file structure.............
48837>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
48838>>>>>>>>>>>
48838>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Tparticl_Rec0  To Tparticl.Tparticl_Rec0
48841>>>>>>>>>>>
48841>>>>>>>>>>>        // Field-based properties.......................
48841>>>>>>>>>>>
48841>>>>>>>>>>>        // Tparticl.Partl_Recr
48841>>>>>>>>>>>
48841>>>>>>>>>>>        // Tparticl.Baxiokat_Code
48841>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Baxiokat_Code To Calc_All_The_Fields
48842>>>>>>>>>>>
48842>>>>>>>>>>>        // Tparticl.Pct_Epi_Synolou
48842>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Pct_Epi_Synolou To Calc_All_The_Fields
48843>>>>>>>>>>>
48843>>>>>>>>>>>        // Tparticl.Paralabh_Meres
48843>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Paralabh_Meres To Calc_All_The_Fields
48844>>>>>>>>>>>
48844>>>>>>>>>>>        // Tparticl.Xarhtos_Meres
48844>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Xarhtos_Meres To Calc_All_The_Fields
48845>>>>>>>>>>>
48845>>>>>>>>>>>        // Tparticl.Plhroteo_Meres
48845>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Plhroteo_Meres To Calc_All_The_Fields
48846>>>>>>>>>>>
48846>>>>>>>>>>>        // Tparticl.Tparticl_Rec0
48846>>>>>>>>>>>
48846>>>>>>>>>>>        // Tparticl.Tparticl_Recr
48846>>>>>>>>>>>
48846>>>>>>>>>>>        // Tparticl.Mera_Tou_Mhna
48846>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Mera_Tou_Mhna To Calc_All_The_Fields
48847>>>>>>>>>>>        Set Field_Value_Table      Field Tparticl.Mera_Tou_Mhna To (Mera_Tou_Mhna_VT(Self))
48848>>>>>>>>>>>
48848>>>>>>>>>>>        // Tparticl.Poso
48848>>>>>>>>>>>
48848>>>>>>>>>>>        // Tparticl.Paralabh
48848>>>>>>>>>>>
48848>>>>>>>>>>>        // Tparticl.Exoflhsh
48848>>>>>>>>>>>
48848>>>>>>>>>>>        // Tparticl.Isok
48848>>>>>>>>>>>
48848>>>>>>>>>>>        //DDB-DefineFieldEnd
48848>>>>>>>>>>>    End_Procedure    // Define_Fields
48849>>>>>>>>>>>
48849>>>>>>>>>>>    // Field_Defaults:
48849>>>>>>>>>>>    // This procedure is used to establish default field values.
48849>>>>>>>>>>>
48849>>>>>>>>>>>    Procedure Field_Defaults
48850>>>>>>>>>>>        Forward Send Field_Defaults
48852>>>>>>>>>>>        //DDB-Generated-Code-Location
48852>>>>>>>>>>>        //DDB-FieldDefaultStart
48852>>>>>>>>>>>        //DDB-FieldDefaultEnd
48852>>>>>>>>>>>    End_Procedure    // Field_Defaults
48853>>>>>>>>>>>
48853>>>>>>>>>>>End_Class    // Tparticl_DataDictionary
48854>>>>>>>>>>>//DDB-FileEnd
48854>>>>>>>>>    Use PARTLFPA.DD
INCLUDING FILE: PARTLFPA.DD
48854>>>>>>>>>>>//DDB-FileStart
48854>>>>>>>>>>>//DDB-HeaderStart
48854>>>>>>>>>>>
48854>>>>>>>>>>>// File Name : PARTLFPA.DD
48854>>>>>>>>>>>// Class Name: Partlfpa_DataDictionary
48854>>>>>>>>>>>// Revision  : 7
48854>>>>>>>>>>>// Version   : 2
48854>>>>>>>>>>>
48854>>>>>>>>>>>Use  Windows           // Basic Definitions
48854>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48854>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48854>>>>>>>>>>>
48854>>>>>>>>>>>Open Partlfpa
48856>>>>>>>>>>>Open Particle
48858>>>>>>>>>>>Open Fpa
48860>>>>>>>>>>>
48860>>>>>>>>>>>//DDB-HeaderEnd
48860>>>>>>>>>>> 
48860>>>>>>>>>>>Class Partlfpa_DataDictionary  is a DataDictionary_Sec
48861>>>>>>>>>>>
48861>>>>>>>>>>>
48861>>>>>>>>>>>    // Define_Fields:
48861>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48861>>>>>>>>>>>
48861>>>>>>>>>>>    Procedure Define_Fields
48862>>>>>>>>>>>        Forward Send Define_Fields
48864>>>>>>>>>>>        //DDB-Generated-Code-Location
48864>>>>>>>>>>>        //DDB-DefineFieldStart
48864>>>>>>>>>>>
48864>>>>>>>>>>>        Set Main_File            To Partlfpa.File_Number
48865>>>>>>>>>>>
48865>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48866>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48867>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48868>>>>>>>>>>>
48868>>>>>>>>>>>        // Parent (Server) file structure...............
48868>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
48869>>>>>>>>>>>        Send Add_Server_File  Fpa.File_Number
48870>>>>>>>>>>>
48870>>>>>>>>>>>        // Field-based properties.......................
48870>>>>>>>>>>>
48870>>>>>>>>>>>        // Partlfpa.Partl_Recr
48870>>>>>>>>>>>
48870>>>>>>>>>>>        // Partlfpa.Fpa_Pososto
48870>>>>>>>>>>>
48870>>>>>>>>>>>        // Partlfpa.Partlfpa_Poso
48870>>>>>>>>>>>
48870>>>>>>>>>>>        // Partlfpa.Poso_Pro_Ekpt
48870>>>>>>>>>>>
48870>>>>>>>>>>>        // Partlfpa.Poso_Ekpt
48870>>>>>>>>>>>
48870>>>>>>>>>>>        // Partlfpa.Poso_Pro_Fpa
48870>>>>>>>>>>>
48870>>>>>>>>>>>        // Partlfpa.Poso_Fpa
48870>>>>>>>>>>>
48870>>>>>>>>>>>        // Partlfpa.Poso_Me_Fpa
48870>>>>>>>>>>>
48870>>>>>>>>>>>        //DDB-DefineFieldEnd
48870>>>>>>>>>>>    End_Procedure    // Define_Fields
48871>>>>>>>>>>>
48871>>>>>>>>>>>    // Field_Defaults:
48871>>>>>>>>>>>    // This procedure is used to establish default field values.
48871>>>>>>>>>>>
48871>>>>>>>>>>>    Procedure Field_Defaults
48872>>>>>>>>>>>        Forward Send Field_Defaults
48874>>>>>>>>>>>        //DDB-Generated-Code-Location
48874>>>>>>>>>>>        //DDB-FieldDefaultStart
48874>>>>>>>>>>>        //DDB-FieldDefaultEnd
48874>>>>>>>>>>>    End_Procedure    // Field_Defaults
48875>>>>>>>>>>>
48875>>>>>>>>>>>End_Class    // Partlfpa_DataDictionary
48876>>>>>>>>>>>//DDB-FileEnd
48876>>>>>>>>>
48876>>>>>>>>>    //AB-StoreTopEnd
48876>>>>>>>>>
48876>>>>>>>>>    //AB-IgnoreStart
48876>>>>>>>>>
48876>>>>>>>>>    Use Bproces.Sub
48876>>>>>>>>>
48876>>>>>>>>>
48876>>>>>>>>>    //AB-IgnoreEnd
48876>>>>>>>>>
48876>>>>>>>>>    Object Psx_Array is a BusinessProcessSub
48878>>>>>>>>>
48878>>>>>>>>>        //AB-StoreTopStart
48878>>>>>>>>>
48878>>>>>>>>>        Property    String  psParticleRecr0 Public ''
48880>>>>>>>>>        Property    String  psPsxetikaRecr0 Public ''
48882>>>>>>>>>        Property    String  psClient_Desc   Public ''
48884>>>>>>>>>        Property    String  psPtyppar_Desc  Public ''
48886>>>>>>>>>        Property    String  psSeira_Seira   Public ''
48888>>>>>>>>>        Property    Date    pdPartl_Hmnia   Public ''
48890>>>>>>>>>        Property    Integer piPartl_No      Public  0
48892>>>>>>>>>        Property    Number  pnPosothta      Public  0
48894>>>>>>>>>
48894>>>>>>>>>        Object Ctypkin_DD2 is a Ctypkin_DataDictionary
48896>>>>>>>>>        End_Object    // Ctypkin_DD2
48897>>>>>>>>>
48897>>>>>>>>>        Object Wtypkin_DD2 is a Wtypkin_DataDictionary
48899>>>>>>>>>        End_Object    // Wtypkin_DD2
48900>>>>>>>>>
48900>>>>>>>>>        Object Ptyppar_DD2 is a Ptyppar_DataDictionary
48902>>>>>>>>>            Set DDO_Server to (Ctypkin_DD2(self))
48903>>>>>>>>>            Set DDO_Server to (Wtypkin_DD2(self))
48904>>>>>>>>>        End_Object    // Ptyppar_DD2
48905>>>>>>>>>
48905>>>>>>>>>        Object Country_DD2 is a Country_DataDictionary
48907>>>>>>>>>        End_Object    // Country_DD2
48908>>>>>>>>>
48908>>>>>>>>>        Object Towns_DD2 is a Towns_DataDictionary
48910>>>>>>>>>            Set DDO_Server to (Country_DD2(self))
48911>>>>>>>>>        End_Object    // Towns_DD2
48912>>>>>>>>>
48912>>>>>>>>>        Object Cities_DD2 is a Cities_DataDictionary
48914>>>>>>>>>            Set DDO_Server to (Towns_DD2(self))
48915>>>>>>>>>        End_Object    // Cities_DD2
48916>>>>>>>>>
48916>>>>>>>>>        Object Areas_DD2 is a Areas_DataDictionary
48918>>>>>>>>>        End_Object    // Areas_DD2
48919>>>>>>>>>
48919>>>>>>>>>        Object Payresp_DD2 is a Payresp_DataDictionary
48921>>>>>>>>>        End_Object    // Payresp_DD2
48922>>>>>>>>>
48922>>>>>>>>>        Object Clients_DD2 is a Clients_DataDictionary
48924>>>>>>>>>            Set DDO_Server to (Cities_DD2(self))
48925>>>>>>>>>            Set DDO_Server to (Areas_DD2(self))
48926>>>>>>>>>            Set DDO_Server to (Payresp_DD2(self))
48927>>>>>>>>>        End_Object    // Clients_DD2
48928>>>>>>>>>
48928>>>>>>>>>        Object Nomisma_DD2 is a Nomisma_DataDictionary
48930>>>>>>>>>        End_Object    // Nomisma_DD2
48931>>>>>>>>>
48931>>>>>>>>>        Object Particle_DD2 is a Particle_DataDictionary
48933>>>>>>>>>            Set DDO_Server to (Clients_DD2(self))
48934>>>>>>>>>            Set DDO_Server to (Ptyppar_DD2(self))
48935>>>>>>>>>            Set DDO_Server to (Nomisma_DD2(self))
48936>>>>>>>>>        End_Object    // Particle_DD2
48937>>>>>>>>>
48937>>>>>>>>>
48937>>>>>>>>>        /////////////////////////////////////////////
48937>>>>>>>>>
48937>>>>>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
48939>>>>>>>>>        End_Object    // Ctypkin_DD
48940>>>>>>>>>
48940>>>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
48942>>>>>>>>>        End_Object    // Wtypkin_DD
48943>>>>>>>>>
48943>>>>>>>>>        Object Ptyppar_DD is a Ptyppar_DataDictionary
48945>>>>>>>>>            Set DDO_Server to (Ctypkin_DD(self))
48946>>>>>>>>>            Set DDO_Server to (Wtypkin_DD(self))
48947>>>>>>>>>        End_Object    // Ptyppar_DD
48948>>>>>>>>>
48948>>>>>>>>>        Object Country_DD is a Country_DataDictionary
48950>>>>>>>>>        End_Object    // Country_DD
48951>>>>>>>>>
48951>>>>>>>>>        Object Towns_DD is a Towns_DataDictionary
48953>>>>>>>>>            Set DDO_Server to (Country_DD(self))
48954>>>>>>>>>        End_Object    // Towns_DD
48955>>>>>>>>>
48955>>>>>>>>>        Object Cities_DD is a Cities_DataDictionary
48957>>>>>>>>>            Set DDO_Server to (Towns_DD(self))
48958>>>>>>>>>        End_Object    // Cities_DD
48959>>>>>>>>>
48959>>>>>>>>>        Object Areas_DD is a Areas_DataDictionary
48961>>>>>>>>>        End_Object    // Areas_DD
48962>>>>>>>>>
48962>>>>>>>>>        Object Payresp_DD is a Payresp_DataDictionary
48964>>>>>>>>>        End_Object    // Payresp_DD
48965>>>>>>>>>
48965>>>>>>>>>        Object Clients_DD is a Clients_DataDictionary
48967>>>>>>>>>            Set DDO_Server to (Cities_DD(self))
48968>>>>>>>>>            Set DDO_Server to (Areas_DD(self))
48969>>>>>>>>>            Set DDO_Server to (Payresp_DD(self))
48970>>>>>>>>>        End_Object    // Clients_DD
48971>>>>>>>>>
48971>>>>>>>>>        Object Nomisma_DD is a Nomisma_DataDictionary
48973>>>>>>>>>        End_Object    // Nomisma_DD
48974>>>>>>>>>
48974>>>>>>>>>        Object Particle_DD is a Particle_DataDictionary
48976>>>>>>>>>            Set DDO_Server to (Clients_DD(self))
48977>>>>>>>>>            Set DDO_Server to (Ptyppar_DD(self))
48978>>>>>>>>>            Set DDO_Server to (Nomisma_DD(self))
48979>>>>>>>>>        End_Object    // Particle_DD
48980>>>>>>>>>
48980>>>>>>>>>        Object Psxetika_DD is a Psxetika_DataDictionary
48982>>>>>>>>>            Set DDO_Server      to (Particle_DD(self))
48983>>>>>>>>>            Set Constrain_File  to Particle.File_Number
48984>>>>>>>>>        End_Object
48985>>>>>>>>>
48985>>>>>>>>>
48985>>>>>>>>>        //AB-StoreTopEnd
48985>>>>>>>>>
48985>>>>>>>>>        Set Size to 60 100
48986>>>>>>>>>
48986>>>>>>>>>        //AB-DDOStart
48986>>>>>>>>>
48986>>>>>>>>>
48986>>>>>>>>>        //AB-DDOEnd
48986>>>>>>>>>
48986>>>>>>>>>
48986>>>>>>>>>        //AB-StoreStart
48986>>>>>>>>>
48986>>>>>>>>>        Procedure Find_Sxetika_Data String asParentRecr
48988>>>>>>>>>            String  sClient_Desc sPtyppar_Desc sPseira_Seira
48989>>>>>>>>>            Date    dPartl_Hmnia
48989>>>>>>>>>            Integer iPartl_No
48989>>>>>>>>>
48989>>>>>>>>>            Send Clear          to Particle_DD2
48990>>>>>>>>>            Move asParentRecr   to Particle.Partl_Recr
48991>>>>>>>>>            Send Find           to Particle_DD2 Eq 2
48992>>>>>>>>>
48992>>>>>>>>>            Get Field_Current_Value Of Clients_DD2  Field Clients.Client_Name   to sClient_Desc
48993>>>>>>>>>            Get Field_Current_Value Of Ptyppar_DD2  Field Ptyppar.Ptyppar_Descr to sPtyppar_Desc
48994>>>>>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Pseira_Seira to sPseira_Seira
48995>>>>>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Partl_Hmnia  to dPartl_Hmnia
48996>>>>>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Partl_No     to iPartl_No
48997>>>>>>>>>
48997>>>>>>>>>            Set psPtyppar_Desc      to sPtyppar_Desc
48998>>>>>>>>>            Set psClient_Desc       to sClient_Desc
48999>>>>>>>>>            Set psSeira_Seira       to sPseira_Seira
49000>>>>>>>>>            Set pdPartl_Hmnia       to dPartl_Hmnia
49001>>>>>>>>>            Set piPartl_No          to iPartl_No
49002>>>>>>>>>        End_Procedure
49003>>>>>>>>>
49003>>>>>>>>>
49003>>>>>>>>>        Procedure Make_The_Record
49005>>>>>>>>>
49005>>>>>>>>>            Set psPtyppar_Desc      to ''
49006>>>>>>>>>            Set psClient_Desc       to ''
49007>>>>>>>>>            Set psSeira_Seira       to ''
49008>>>>>>>>>            Set pdPartl_Hmnia       to ''
49009>>>>>>>>>            Set piPartl_No          to 0
49010>>>>>>>>>
49010>>>>>>>>>            Clear Psxetika
49011>>>>>>>>>            Move (psParticleRecr0(Self)) to Psxetika.Partl_Recr
49012>>>>>>>>>            Move (psPsxetikaRecr0(Self)) to Psxetika.Psx_Partl_Recr
49013>>>>>>>>>            Find Eq Psxetika by index.4
49014>>>>>>>>>>
49014>>>>>>>>>
49014>>>>>>>>>            If (Not(Found)) Begin
49016>>>>>>>>>
49016>>>>>>>>>                Send Find_Sxetika_Data (psPsxetikaRecr0(Self))
49017>>>>>>>>>
49017>>>>>>>>>                Send Clear to Particle_DD
49018>>>>>>>>>                Send Clear to Psxetika_DD
49019>>>>>>>>>
49019>>>>>>>>>                // Vres ton mpampa
49019>>>>>>>>>                Move (psParticleRecr0(Self)) to Particle.Partl_Recr
49020>>>>>>>>>                Send Find to Particle_DD Eq 2
49021>>>>>>>>>
49021>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Psx_Partl_Recr    ;                                                to (psPsxetikaRecr0(Self))
49022>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Client_Desc    ;                                                to (psClient_Desc(Self))
49023>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Ptyppar_Desc   ;                                                to (psPtyppar_Desc(Self))
49024>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_Hmnia    ;                                                to (pdPartl_Hmnia(Self))
49025>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_No       ;                                                to (piPartl_No(Self))
49026>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.SX_Pseira_Seira   ;                                                to (psSeira_Seira(Self))
49027>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Pms_Sx_Qty        ;                                                to (pnPosothta(Self))
49028>>>>>>>>>
49028>>>>>>>>>                Send Request_Save               to Psxetika_DD
49029>>>>>>>>>
49029>>>>>>>>>
49029>>>>>>>>>                // Make also 2nd Record
49029>>>>>>>>>                Clear Psxetika
49030>>>>>>>>>                Move (psPsxetikaRecr0(Self)) to Psxetika.Partl_Recr
49031>>>>>>>>>                Move (psParticleRecr0(Self)) to Psxetika.Psx_Partl_Recr
49032>>>>>>>>>                Find Eq Psxetika by index.4
49033>>>>>>>>>>
49033>>>>>>>>>
49033>>>>>>>>>                If (Not(Found)) Begin
49035>>>>>>>>>
49035>>>>>>>>>                    Send Find_Sxetika_Data (psParticleRecr0(Self))
49036>>>>>>>>>
49036>>>>>>>>>                    Send Clear to Particle_DD
49037>>>>>>>>>                    Send Clear to Psxetika_DD
49038>>>>>>>>>
49038>>>>>>>>>                    Move (psPsxetikaRecr0(Self)) to Particle.Partl_Recr
49039>>>>>>>>>                    Send Find to Particle_DD Eq 2
49040>>>>>>>>>
49040>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Psx_Partl_Recr    ;                                                    to (psParticleRecr0(Self))
49041>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Client_Desc    ;                                                    to (psClient_Desc(Self))
49042>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Ptyppar_Desc   ;                                                    to (psPtyppar_Desc(Self))
49043>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_Hmnia    ;                                                    to (pdPartl_Hmnia(Self))
49044>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_No       ;                                                    to (piPartl_No(Self))
49045>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.SX_Pseira_Seira   ;                                                    to (psSeira_Seira(Self))
49046>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Pms_Sx_Qty        ;                                                    to (pnPosothta(Self))
49047>>>>>>>>>                    Send Request_Save               to Psxetika_DD
49048>>>>>>>>>                End
49048>>>>>>>>>>
49048>>>>>>>>>            End
49048>>>>>>>>>>
49048>>>>>>>>>        End_Procedure
49049>>>>>>>>>
49049>>>>>>>>>        //AB-StoreEnd
49049>>>>>>>>>
49049>>>>>>>>>    End_Object    // Psx_Array
49050>>>>>>>>>
49050>>>>>>>>>
49050>>>>>>>>>    //AB-StoreStart
49050>>>>>>>>>
49050>>>>>>>>>    //AB-StoreEnd
49050>>>>>>>>>
49050>>>>>>>>>//AB/     End_Object    // prj
49050>>>>>>>//Use bpMakeSx.dg
49050>>>>>>>
49050>>>>>>>Class PmsSxet_DataDictionary  is a DataDictionary_Sec
49051>>>>>>>
49051>>>>>>>    Procedure Construct_Object
49052>>>>>>>        Forward Send Construct_Object
49054>>>>>>>        Property Integer piFromCreate   Public 0
49055>>>>>>>    End_Procedure
49056>>>>>>>
49056>>>>>>>    Procedure Creating
49057>>>>>>>        Forward Send Creating
49059>>>>>>>        Set piFromCreate to 1
49060>>>>>>>    End_Procedure
49061>>>>>>>
49061>>>>>>>    Procedure Update
49062>>>>>>>        String  sRecr1 sRecr2 sPmsSxet
49063>>>>>>>        Number  nQty
49063>>>>>>>        Integer iLathos iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
49063>>>>>>>
49063>>>>>>>        Forward Send Update
49065>>>>>>>
49065>>>>>>>        Move (Trim(Particle.Partl_LastNo)='1')  to iAkyro
49066>>>>>>>        Move Particle.Partl_Recr                to sRecr1
49067>>>>>>>        Move Pmoves.Recnum                      to iCurrentPmoves
49068>>>>>>>        Move PmsSxet.Recnum                     to iCurrentPmsSxet
49069>>>>>>>        Move PmsSxet.Arx_Partl_Recr             to sRecr2
49070>>>>>>>        Move PmsSxet.Posothta                   to nQty
49071>>>>>>>        Move Particle.Recnum                    to iCurrentPartl
49072>>>>>>>
49072>>>>>>>
49072>>>>>>>        If (piFromCreate(Self)<>1) Begin
49074>>>>>>>            Add nQty to Pmoves.Pms_Qty
49075>>>>>>>            Saverecord Pmoves
49076>>>>>>>
49076>>>>>>>            Set pnQty               Of bpEnYpol to nQty
49077>>>>>>>            Set psRecr              Of bpEnYpol to PmsSxet.Sxetiko_Recr
49078>>>>>>>            Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
49079>>>>>>>            Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
49080>>>>>>>            Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
49081>>>>>>>            Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
49082>>>>>>>            Send DoProcess          to bpEnYpol
49083>>>>>>>
49083>>>>>>>            Get piLathos            Of bpEnYpol to iLathos
49084>>>>>>>
49084>>>>>>>                 If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
49087>>>>>>>            Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
49091>>>>>>>            Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
49095>>>>>>>            Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
49099>>>>>>>            Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
49103>>>>>>>            Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
49107>>>>>>>            Else If (iLathos=40006) Error 8006 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
49111>>>>>>>
49111>>>>>>>        End
49111>>>>>>>>
49111>>>>>>>
49111>>>>>>>        // Epanafora posothtas giati afou trexei h backout me timh px 3 eno h update exei timh 4
49111>>>>>>>        // sthn epanatopothethsh ths bpenypol xanavriskei to current pmssxet record
49111>>>>>>>        // kai xanei thn posothta thn kainourgia opote epanerxetai me thn posothta ths
49111>>>>>>>        // backout pou einai 3.
49111>>>>>>>        Move nQty to PmsSxet.Posothta
49112>>>>>>>
49112>>>>>>>
49112>>>>>>>        Clear Psxetika
49113>>>>>>>        Move sRecr1 to Psxetika.Partl_Recr
49114>>>>>>>        Move sRecr2 to Psxetika.Psx_Partl_Recr
49115>>>>>>>        Find Eq Psxetika by index.4
49116>>>>>>>>
49116>>>>>>>        If (Found) Begin
49118>>>>>>>            Add nQty to Psxetika.Pms_Sx_Qty
49119>>>>>>>            Saverecord Psxetika
49120>>>>>>>        End
49120>>>>>>>>
49120>>>>>>>
49120>>>>>>>        Clear Psxetika
49121>>>>>>>        Move sRecr2 to Psxetika.Partl_Recr
49122>>>>>>>        Move sRecr1 to Psxetika.Psx_Partl_Recr
49123>>>>>>>        Find Eq Psxetika by index.4
49124>>>>>>>>
49124>>>>>>>        If (Found) Begin
49126>>>>>>>            Add nQty to Psxetika.Pms_Sx_Qty
49127>>>>>>>            Saverecord Psxetika
49128>>>>>>>        End
49128>>>>>>>>
49128>>>>>>>    End_Procedure
49129>>>>>>>
49129>>>>>>>    Procedure Backout
49130>>>>>>>        String  sRecr1 sRecr2 sPmsSxet
49131>>>>>>>        Number  nQty
49131>>>>>>>        Integer iLathos iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
49131>>>>>>>
49131>>>>>>>        Move (Trim(Particle.Partl_LastNo)='1')  to iAkyro
49132>>>>>>>        Move Particle.Partl_Recr                to sRecr1
49133>>>>>>>        Move Pmoves.Recnum                      to iCurrentPmoves
49134>>>>>>>        Move PmsSxet.Recnum                     to iCurrentPmsSxet
49135>>>>>>>        Move PmsSxet.Arx_Partl_Recr             to sRecr2
49136>>>>>>>        Move PmsSxet.Posothta                   to nQty
49137>>>>>>>        Move Particle.Recnum                    to iCurrentPartl
49138>>>>>>>
49138>>>>>>>        Forward Send Backout
49140>>>>>>>
49140>>>>>>>        Set pnQty               Of bpEnYpol to (nQty*(-1))
49141>>>>>>>        Set psRecr              Of bpEnYpol to PmsSxet.Sxetiko_Recr
49142>>>>>>>        Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
49143>>>>>>>        Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
49144>>>>>>>        Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
49145>>>>>>>        Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
49146>>>>>>>        Send DoProcess          to bpEnYpol
49147>>>>>>>
49147>>>>>>>        Get piLathos            Of bpEnYpol to iLathos
49148>>>>>>>
49148>>>>>>>             If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
49151>>>>>>>        Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nBackout PmsSxet'
49155>>>>>>>        Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nBackout PmsSxet'
49159>>>>>>>        Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
49163>>>>>>>        Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nBackout PmsSxet'
49167>>>>>>>        Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nBackout PmsSxet'
49171>>>>>>>        Else If (iLathos=40006) Error 8006 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  > ˜¨® ¡ã §¦©æ«ž«˜.\nBackout PmsSxet'
49175>>>>>>>        Else If (iLathos=40007) Error 8007 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
49179>>>>>>>
49179>>>>>>>        Clear Psxetika
49180>>>>>>>        Move sRecr1 to Psxetika.Partl_Recr
49181>>>>>>>        Move sRecr2 to Psxetika.Psx_Partl_Recr
49182>>>>>>>        Find Eq Psxetika by index.4
49183>>>>>>>>
49183>>>>>>>        If (Found) Begin
49185>>>>>>>            Sub nQty from Psxetika.Pms_Sx_Qty
49186>>>>>>>            Saverecord Psxetika
49187>>>>>>>        End
49187>>>>>>>>
49187>>>>>>>
49187>>>>>>>        Clear Psxetika
49188>>>>>>>        Move sRecr2 to Psxetika.Partl_Recr
49189>>>>>>>        Move sRecr1 to Psxetika.Psx_Partl_Recr
49190>>>>>>>        Find Eq Psxetika by index.4
49191>>>>>>>>
49191>>>>>>>        If (Found) Begin
49193>>>>>>>            Sub nQty from Psxetika.Pms_Sx_Qty
49194>>>>>>>            Saverecord Psxetika
49195>>>>>>>        End
49195>>>>>>>>
49195>>>>>>>    End_Procedure
49196>>>>>>>
49196>>>>>>>    Procedure Request_Save
49197>>>>>>>        Integer iInt iLathos iMustDelete iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
49198>>>>>>>        String  sParticleRecr sPmsSxetRecr sPmovesRecr sArxPartlRecr sRecr1 sRecr2 sPmsSxet
49198>>>>>>>        Number  nQty
49198>>>>>>>
49198>>>>>>>        Set piFromCreate to 0
49199>>>>>>>
49199>>>>>>>        Forward Send Request_Save
49201>>>>>>>
49201>>>>>>>        If (piFromCreate(Self)=1) Begin
49203>>>>>>>            Set piFromCreate                                                to 0
49204>>>>>>>
49204>>>>>>>            Get File_Field_Current_Value File_Field Particle.Recnum         to iCurrentPartl
49205>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Recr     to sParticleRecr
49206>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Recr         to sPmovesRecr
49207>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Recnum           to iCurrentPmoves
49208>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Recnum          to iCurrentPmsSxet
49209>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Sxetiko_Recr    to sPmsSxetRecr
49210>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Arx_Partl_Recr  to sArxPartlRecr
49211>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Posothta        to nQty
49212>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_LastNo   to iAkyro
49213>>>>>>>            Move (iAkyro=1)                                                 to iAkyro
49214>>>>>>>
49214>>>>>>>            Set pnQty               Of bpEnYpol to nQty
49215>>>>>>>            Set psRecr              Of bpEnYpol to sPmsSxetRecr
49216>>>>>>>            Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
49217>>>>>>>            Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
49218>>>>>>>            Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
49219>>>>>>>            Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
49220>>>>>>>            Send DoProcess          to bpEnYpol
49221>>>>>>>            Get piLathos            Of bpEnYpol to iLathos
49222>>>>>>>
49222>>>>>>>                 If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
49225>>>>>>>            Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
49229>>>>>>>            Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
49233>>>>>>>            Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
49237>>>>>>>            Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
49241>>>>>>>            Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
49245>>>>>>>            Else If (iLathos=40006) Error 8006 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  > ˜¨® ¡ã §¦©æ«ž«˜.\nUpdate PmsSxet'
49249>>>>>>>            Else If (iLathos=40007) Error 8007 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
49253>>>>>>>
49253>>>>>>>            Set psParticleRecr0     Of Psx_Array to sParticleRecr
49254>>>>>>>            Set psPsxetikaRecr0     Of Psx_Array to sArxPartlRecr
49255>>>>>>>            Set pnPosothta          Of Psx_Array to nQty
49256>>>>>>>            Send Make_The_Record    Of Psx_Array
49257>>>>>>>
49257>>>>>>>            // Xana vres tis eggrafes
49257>>>>>>>            Clear Particle
49258>>>>>>>            Move sParticleRecr  to Particle.Partl_Recr
49259>>>>>>>            Find Eq Particle by index.2
49260>>>>>>>>
49260>>>>>>>
49260>>>>>>>            Clear Pmoves
49261>>>>>>>            Move sPmovesRecr    to Pmoves.Pms_Recr
49262>>>>>>>            Find Eq Pmoves by index.2
49263>>>>>>>>
49263>>>>>>>
49263>>>>>>>            Clear PmsSxet
49264>>>>>>>            Move sPmovesRecr    to PmsSxet.Pms_Recr
49265>>>>>>>            Move sPmsSxetRecr   to PmsSxet.Sxetiko_Recr
49266>>>>>>>            Find Eq PmsSxet by Index.1
49267>>>>>>>>
49267>>>>>>>
49267>>>>>>>        End
49267>>>>>>>>
49267>>>>>>>    End_Procedure
49268>>>>>>>
49268>>>>>>>
49268>>>>>>>    Procedure Define_Fields
49269>>>>>>>        Forward Send Define_Fields
49271>>>>>>>        //DDB-Generated-Code-Location
49271>>>>>>>        //DDB-DefineFieldStart
49271>>>>>>>
49271>>>>>>>        Set Main_File            To Pmssxet.File_Number
49272>>>>>>>
49272>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
49273>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
49274>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49275>>>>>>>
49275>>>>>>>        // Parent (Server) file structure...............
49275>>>>>>>        Send Add_Server_File  Pmoves.File_Number
49276>>>>>>>
49276>>>>>>>        // External (System) file structure.............
49276>>>>>>>        Send Add_System_File  Psxetika.File_Number  DD_LOCK_ON_ALL
49277>>>>>>>        Send Add_System_File  Pmoves.File_Number  DD_LOCK_ON_ALL
49278>>>>>>>
49278>>>>>>>        // Field-based properties.......................
49278>>>>>>>
49278>>>>>>>        // Pmssxet.Pms_Recr
49278>>>>>>>
49278>>>>>>>        // Pmssxet.Sxetiko_Recr
49278>>>>>>>
49278>>>>>>>        // Pmssxet.Posothta
49278>>>>>>>
49278>>>>>>>        // Pmssxet.Arx_Partl_Recr
49278>>>>>>>
49278>>>>>>>        // Pmssxet.Sx_Parast
49278>>>>>>>
49278>>>>>>>        // Pmssxet.Sx_Hmnia
49278>>>>>>>
49278>>>>>>>        // Pmssxet.Sx_Foreas
49278>>>>>>>
49278>>>>>>>        // Pmssxet.Sx_Arithmos
49278>>>>>>>
49278>>>>>>>        // Pmssxet.Sx_Seira
49278>>>>>>>
49278>>>>>>>        // Pmssxet.Sx_Posothta
49278>>>>>>>
49278>>>>>>>        //DDB-DefineFieldEnd
49278>>>>>>>    End_Procedure    // Define_Fields
49279>>>>>>>
49279>>>>>>>    Procedure Field_Defaults
49280>>>>>>>        Forward Send Field_Defaults
49282>>>>>>>        //DDB-Generated-Code-Location
49282>>>>>>>        //DDB-FieldDefaultStart
49282>>>>>>>        //DDB-FieldDefaultEnd
49282>>>>>>>    End_Procedure    // Field_Defaults
49283>>>>>>>
49283>>>>>>>End_Class    // Pmssxet_DataDictionary
49284>>>>>>>//DDB-FileEnd
49284>>>>>
49284>>>>>Class Cmoves_DataDictionary  is a DataDictionary
49285>>>>>
49285>>>>>    Procedure Construct_Object
49286>>>>>        Forward Send Construct_Object
49288>>>>>        Property Integer piFromBP           Public 0
49289>>>>>        Property Integer piNotMoveSyscurXr  Public 0   
49290>>>>>        Property Integer piFromSysxet       Public 0   
49291>>>>>        Property Integer piFromxrhsh        Public 0  //œ¤›œ ¥ž ¦«  œ¨®œ«˜  ˜§¦ £œ«˜­¦¨á ¬§¦¢¦å§à¤
49292>>>>>    End_Procedure
49293>>>>>
49293>>>>>    Function Validate_Save  Returns Integer
49294>>>>>        Integer iReturnVal iOpen_Items iCheck ifromxrhsh iYes
49295>>>>>        String sModule
49295>>>>>        get pifromxrhsh to ifromxrhsh
49296>>>>>        Forward Get Validate_Save  To iReturnVal
49298>>>>>        If (Not(iReturnVal)) Begin
49300>>>>>            if (cmoves.cmoves_recr='')  Send Operation_Not_Allowed 3263
49303>>>>>            Clear Branch
49304>>>>>            Move SyscurXr.Company_Code  to Branch.Company_Code
49305>>>>>            Move SyscurXr.Branch_Code   to Branch.Branch_Code
49306>>>>>            Find Eq Branch By Index.1
49307>>>>>>
49307>>>>>            If (Not(Found)) Move 6666 to iReturnVal
49310>>>>>            Else If ((Branch.Locked_Until<>'') And (Cmoves.Cmoves_Hmnia<=Branch.Locked_Until)) Move 6667 to iReturnVal
49314>>>>>            
49314>>>>>            If (Cmoves.Axia_Ypol_Sysx<0) Begin
49316>>>>>                Move 10101 to iReturnVal
49317>>>>>            End
49317>>>>>>
49317>>>>>            Else Begin
49318>>>>>                
49318>>>>>                Move Ctypkin.Check_Overhead to iCheck
49319>>>>>                If (iCheck) Begin
49321>>>>>                    If ((Clients.Plafon>0) And (Clients.Overhead<0) And (Sysfile.Over_Overhead<>'1')) Begin
49323>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 3000 Cmoves' to iYes
49324>>>>>                        If (iYes=MBR_NO) Move 11170 to iReturnVal
49327>>>>>                    End
49327>>>>>>
49327>>>>>                    Else If ((PayResp.Plafon>0) And (PayResp.Overhead<0) And (Sysfile.Over_Overhead<>'1')) Begin
49330>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 3001 Cmoves' to iYes
49331>>>>>                        If (iYes=MBR_NO) Move 11171 to iReturnVal
49334>>>>>                    End
49334>>>>>>
49334>>>>>                End
49334>>>>>>
49334>>>>>                
49334>>>>>                If (iReturnVal) Send Operation_Not_Allowed iReturnVal
49337>>>>>                
49337>>>>>                If ((Cmoves.Prn_Theor='1') And (piFromBP(Self)<>1)) Move 22278 to iReturnVal
49340>>>>>                Else If ((Clients.Client_Locked='1') And (piFromBP(Self)<>1)) Move 11172 to iReturnVal
49344>>>>>                
49344>>>>>                // ˜¤ œ¨®œ«˜  ˜§¦ £œ«˜­¦¨á ¬§¦¢¦å§à¤ £ž¤ «¦¤ ¡¦™œ ª ã ˜§¦ open items (©¬©®œ« ©œ ª)
49344>>>>>                Else If ((Cmoves.Cmoves_Hmnia<syscurxr.Year_Xrhshfrom and ifromxrhsh<>1 And (piFromSysxet(Self)<>1)) Or ;                         (Cmoves.Cmoves_Hmnia>Syscurxr.Year_Xrhshto and ifromxrhsh<>1 And (piFromSysxet(Self)<>1))) Move 22277 to iReturnVal
49348>>>>>                Else Begin
49349>>>>>                    If (Cmoves.Module_From='') Move 22250 to iReturnVal
49352>>>>>                    Else Begin
49353>>>>>                        If (piFromBP(Self)<>1) Begin // €¤ ›œ¤ §¨¦œ¨®œ«˜  ˜§¦ « ª 2 Business Process
49355>>>>>                            If (Cmoves.Module_From<>gs_Module_Code) Move 22288 to iReturnVal
49358>>>>>                            Else If (Cmoves.Recnum<>0) Begin // €¤ ›œ¤ ¡˜¤œ  create ¤œ˜ œšš¨˜­ž
49361>>>>>                                If (Cmoves.Barticl_Recr<>'') Move 22284 to iReturnVal
49364>>>>>                                Else If (Cmoves.Partl_Recr  <>'') Begin
49367>>>>>                                    If (Cmoves.Module_From='01') Move 22283 to iReturnVal
49370>>>>>                                    Else If (Cmoves.Module_From='02') Move 22282 to iReturnVal
49374>>>>>                                End
49374>>>>>>
49374>>>>>                            End
49374>>>>>>
49374>>>>>                        End
49374>>>>>>
49374>>>>>                    End
49374>>>>>>
49374>>>>>                End
49374>>>>>>
49374>>>>>            End
49374>>>>>>
49374>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
49377>>>>>        End
49377>>>>>>
49377>>>>>        Function_Return iReturnVal
49378>>>>>    End_Function   // Validate_Save
49379>>>>>
49379>>>>>    Function Validate_Delete  Returns Integer
49380>>>>>        Integer iReturnVal
49381>>>>>        String sModule
49381>>>>>        Forward Get Validate_Delete  To iReturnVal
49383>>>>>        If (Not(iReturnVal)) Begin
49385>>>>>
49385>>>>>            Clear Branch
49386>>>>>            Move SyscurXr.Company_Code  to Branch.Company_Code
49387>>>>>            Move SyscurXr.Branch_Code   to Branch.Branch_Code
49388>>>>>            Find Eq Branch By Index.1
49389>>>>>>
49389>>>>>            If (Not(Found)) Move 6668 to iReturnVal
49392>>>>>            Else If ((Branch.Locked_Until<>'') And (Cmoves.Cmoves_Hmnia<=Branch.Locked_Until)) Move 6669 to iReturnVal
49396>>>>>            
49396>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
49399>>>>>            
49399>>>>>            If (Cmoves.Prn_Theor='1') Move 22279 to iReturnVal
49402>>>>>            Else If (piFromBP(Self)<>1) Begin
49405>>>>>                If (Cmoves.Module_From<>gs_Module_Code) Move 22289 to iReturnVal
49408>>>>>                Else Begin
49409>>>>>                    If (Cmoves.Barticl_Recr<>'') Move 22287 to iReturnVal
49412>>>>>                    Else If (Cmoves.Partl_Recr  <>'') Begin
49415>>>>>                        If (Cmoves.Module_From='01') Move 22286 to iReturnVal
49418>>>>>                        Else If (Cmoves.Module_From='02') Move 22285 to iReturnVal
49422>>>>>                    End
49422>>>>>>
49422>>>>>                End
49422>>>>>>
49422>>>>>            End
49422>>>>>>
49422>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
49425>>>>>        End
49425>>>>>>
49425>>>>>        Function_Return iReturnVal
49426>>>>>    End_Function   // Validate_Delete
49427>>>>>
49427>>>>>    Procedure Save_Main_File
49428>>>>>        If (Operation_Origin<>Self) Begin
49430>>>>>            If Cmoves.Recnum Eq 0 Procedure_Return
49433>>>>>        End
49433>>>>>>
49433>>>>>        If (Cmoves.Cn_Code<>'') Begin
49435>>>>>            Clear Cn
49436>>>>>            Move Cmoves.Cn_Code to Cn.Cn_Code
49437>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
49438>>>>>>
49438>>>>>            Move Cn.Cn_Sls_ID      to Cmoves.Sls_ID
49439>>>>>            Move cn.Mhxanik_id     to Cmoves.Mhxanik_Id
49440>>>>>            Move Cn.CN_Cnt_ID      to Cmoves.Cnt_ID
49441>>>>>            Move Cn.Cn_Recr        to Cmoves.Cn_Recr
49442>>>>>        End
49442>>>>>>
49442>>>>>        Else Begin
49443>>>>>            Move ''     to Cmoves.Sls_ID
49444>>>>>            Move ''     to Cmoves.Cnt_ID
49445>>>>>            Move ''     to Cmoves.Cn_Recr
49446>>>>>            Move ''     to Cmoves.Mhxanik_id
49447>>>>>        End
49447>>>>>>
49447>>>>>        Forward Send Save_Main_File
49449>>>>>    End_Procedure   // Save_Main_File
49450>>>>>
49450>>>>>
49450>>>>>    Procedure Update
49451>>>>>        String sNomisma
49452>>>>>        Forward Send Update
49454>>>>>        
49454>>>>>        If (piNotMoveSyscurXr(Self)=0) Begin
49456>>>>>            Move SysCurXR.Company_Code      to Cmoves.Company_Code
49457>>>>>            Move SysCurXR.Branch_Code       to Cmoves.Branch_Code
49458>>>>>        End
49458>>>>>>
49458>>>>>        
49458>>>>>        //˜¤ šå¤œ«˜  £œ«˜­¦¨á ¬§¦¢¦å§à¤
49458>>>>>        if (pifromxrhsh(self)=1)            Move (SysCurXR.Year_Year+1) to Cmoves.Year_Year
49461>>>>>        else If (piNotMoveSyscurXr(Self)=0) Move SysCurXR.Year_Year     to Cmoves.Year_Year
49465>>>>>        
49465>>>>>        //Move Custprom.Custprom_Code to Cmoves.Custprom_Code
49465>>>>>        Move Clients.Client_ID          to Cmoves.Client_ID
49466>>>>>        Move Clients.Client_Name        to Cmoves.Client_Name
49467>>>>>        Move Ctypkin.Ctypkin_Descr      to Cmoves.Ctypkin_Descr
49468>>>>>
49468>>>>>        // js 28/03/2002 Gia na mhn allazei sta Copen me to Ctypkin tou CmovesA
49468>>>>>        If (Cmoves.Ctypkin_Code='') ;            Move Ctypkin.Ctypkin_Code   to Cmoves.Ctypkin_Code
49471>>>>>
49471>>>>>
49471>>>>>        Move payresp.presp_ID           to Cmoves.Presp_ID
49472>>>>>
49472>>>>>        ///an enhmeronei synolikh ofeilh pelath
49472>>>>>        if (Cmoves.enhm_ofeilh='1') begin
49474>>>>>            Add (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) to Clients.Synolikh_ofeilh
49475>>>>>            Add (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) to Payresp.Synolikh_ofeilh
49476>>>>>        end
49476>>>>>>
49476>>>>>
49476>>>>>        If (Cmoves.Enhm_Ypol_Pel='1') Begin
49478>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
49480>>>>>                Add Cmoves.Cmoves_x0 to Clients.Xreosh
49481>>>>>                Add Cmoves.Cmoves_x0 to PayResp.Xreosh
49482>>>>>            End
49482>>>>>>
49482>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
49485>>>>>                Add Cmoves.Cmoves_p0 to Clients.Pistosh
49486>>>>>                Add Cmoves.Cmoves_p0 to PayResp.Pistosh
49487>>>>>            End
49487>>>>>>
49487>>>>>            if ((clients.client_ptyppar='113') and (clients.client_public<>1)) begin
49489>>>>>                move 1 to clients.client_public  
49490>>>>>                Move '01/01/1753'   to Clients.SAP_Hmnia
49491>>>>>                move '' to clients.status
49492>>>>>            end     
49492>>>>>>
49492>>>>>        End
49492>>>>>>
49492>>>>>        If (Cmoves.Enhm_Hmnies_Pel='1') Begin
49494>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
49496>>>>>                Move Cmoves.Cmoves_Hmnia   to Clients.Last_Xreosh
49497>>>>>                Move Cmoves.Cmoves_Hmnia   to PayResp.Last_Xreosh
49498>>>>>            End
49498>>>>>>
49498>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
49501>>>>>                Move Cmoves.Cmoves_Hmnia   to Clients.Last_Pistosh
49502>>>>>                Move Cmoves.Cmoves_Hmnia   to PayResp.Last_Pistosh
49503>>>>>            End
49503>>>>>>
49503>>>>>            if ((clients.client_ptyppar='113') and (clients.client_public<>1)) begin 
49505>>>>>                move 1 to clients.client_public
49506>>>>>                move '' to clients.status  
49507>>>>>                Move '01/01/1753'   to Clients.SAP_Hmnia
49508>>>>>            end 
49508>>>>>>
49508>>>>>        End
49508>>>>>>
49508>>>>>
49508>>>>>             If ((Cmoves.Cmoves_M_Code='') And (Cmoves.Module_From  <>'')) Move Cmoves.Module_From     to Cmoves.Cmoves_M_Code
49511>>>>>        Else If ((Cmoves.Module_From  ='') And (Cmoves.Cmoves_M_Code<>'')) Move Cmoves.Cmoves_M_Code   to Cmoves.Module_From
49515>>>>>
49515>>>>>        If (Ctypkin.Open_Item='1') Move (Cmoves.Axia_Pros_Sysx-Cmoves.Axia_Sysxet) to Cmoves.Axia_Ypol_Sysx
49518>>>>>        Else Begin
49519>>>>>            Move 0 to Cmoves.Axia_Pros_Sysx
49520>>>>>            Move 0 to Cmoves.Axia_Sysxet
49521>>>>>            Move 0 to Cmoves.Axia_Ypol_Sysx
49522>>>>>        End
49522>>>>>>
49522>>>>>
49522>>>>>        // js 23/01/2002
49522>>>>>        // Enhmerosh Pediou Flag_Ypol to opoio antiprosopeyei
49522>>>>>        // to an h eggrafh exei diathesimo ypoloipo pros sysxetish
49522>>>>>        Move (Cmoves.Axia_Ypol_Sysx<>0) to Cmoves.Flag_Ypol
49523>>>>>
49523>>>>>        // js 23/01/2002
49523>>>>>        // Enhmerosh Pediou Flag_Open to opoio antiprosopeyei
49523>>>>>        // an einai xreosh=1, pistosh=2, arnhtikh xreosh=2 arnhtikh Pistosh=1
49523>>>>>        // gia na emfanizei ta antistrofa sto copen
49523>>>>>        If (Ctypkin.Open_Item='1') Begin
49525>>>>>            If ((Cmoves.Cmoves_X0<>0) And ((Cmoves.Cmoves_P0=0))) Begin
49527>>>>>                Move 1                          to Cmoves.Flag_Copen
49528>>>>>                If (Cmoves.Cmoves_X0<0) Move 2  to Cmoves.Flag_Copen
49531>>>>>            End
49531>>>>>>
49531>>>>>            Else If ((Cmoves.Cmoves_P0<>0) And ((Cmoves.Cmoves_X0=0))) Begin
49534>>>>>                Move 2                          to Cmoves.Flag_Copen
49535>>>>>                If (Cmoves.Cmoves_P0<0) Move 1  to Cmoves.Flag_Copen
49538>>>>>            End
49538>>>>>>
49538>>>>>            Else Move 0 to Cmoves.Flag_Copen
49540>>>>>        End
49540>>>>>>
49540>>>>>        Else Move 0 to Cmoves.Flag_Copen
49542>>>>>    End_Procedure   // Update
49543>>>>>
49543>>>>>    Procedure Backout
49544>>>>>        Forward Send Backout
49546>>>>>
49546>>>>>        if (Cmoves.enhm_ofeilh='1') begin
49548>>>>>            sub (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) from Clients.Synolikh_ofeilh
49549>>>>>            sub (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) from Payresp.Synolikh_ofeilh
49550>>>>>        end
49550>>>>>>
49550>>>>>
49550>>>>>//        if (Cmoves.enhm_ofeilh='2') begin
49550>>>>>//            sub ((Cmoves.Cmoves_x0-Cmoves.cmoves_p0)*-1) from Clients.Synolikh_ofeilh
49550>>>>>//            sub ((Cmoves.Cmoves_x0-Cmoves.cmoves_p0)*-1) from Payresp.Synolikh_ofeilh
49550>>>>>//        end
49550>>>>>
49550>>>>>        If (Cmoves.Enhm_Ypol_Pel='1') Begin
49552>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
49554>>>>>                Sub Cmoves.Cmoves_x0 From Clients.Xreosh
49555>>>>>                Sub Cmoves.Cmoves_x0 From PayResp.Xreosh
49556>>>>>            End
49556>>>>>>
49556>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
49559>>>>>                Sub Cmoves.Cmoves_p0 From Clients.Pistosh
49560>>>>>                Sub Cmoves.Cmoves_p0 From PayResp.Pistosh
49561>>>>>            End
49561>>>>>>
49561>>>>>        End
49561>>>>>>
49561>>>>>    End_Procedure
49562>>>>>
49562>>>>>    Procedure Creating
49563>>>>>        Forward Send Creating
49565>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Cmoves.Cmoves_Rec0)))))) to Cmoves.Cmoves_Recr
49566>>>>>
49566>>>>>        //If ((Cmoves.Module_From='' ) Or (piFromBP(Self)<>1)) Move gs_Module_Code to Cmoves.Module_From
49566>>>>>
49566>>>>>        If (Ctypkin.Open_Item ='1') Begin
49568>>>>>                 If (Cmoves.Cmoves_x0<>0) Move (Abs(Cmoves.Cmoves_x0)) to Cmoves.Axia_Pros_Sysx
49571>>>>>            Else If (Cmoves.Cmoves_p0<>0) Move (Abs(Cmoves.Cmoves_p0)) to Cmoves.Axia_Pros_Sysx
49575>>>>>        End
49575>>>>>>
49575>>>>>    End_Procedure   // Creating
49576>>>>>
49576>>>>>
49576>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
49577>>>>>        String lsError_Message
49578>>>>>
49578>>>>>        Case Begin
49578>>>>>            
49578>>>>>            Case (iError_Num = 3263)
49580>>>>>                Move "DDC 006: ‘­á¢£˜ 6666 €›ç¤˜«ž ž œšš¨˜­ž!\n‰œ¤æ Cmoverecr!! Protem !!" to lsError_Message
49581>>>>>            Case Break
49582>>>>>            
49582>>>>>            Case (iError_Num = 6666)
49585>>>>>                Move "DDC 006: ‘­á¢£˜ 6666 €›ç¤˜«ž ž œšš¨˜­ž!\nƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ ¬§¦¡˜«˜©«ž£á«à¤" to lsError_Message
49586>>>>>            Case Break
49587>>>>>
49587>>>>>            Case (iError_Num = 6667)
49590>>>>>                Move "DDC 006: ‘­á¢£˜ 6667 €›ç¤˜«ž ž œšš¨˜­ž!\n†£/¤å˜ ¡å¤ž©žª §¨¦šœ¤â©«œ¨ž ž£/¤å˜ª ¡¢œ ›é£˜«¦ª" to lsError_Message
49591>>>>>            Case Break
49592>>>>>
49592>>>>>            Case (iError_Num = 6668)
49595>>>>>                Move "DDC 006: ‘­á¢£˜ 6668 €›ç¤˜«ž ž › ˜š¨˜­ã!\nƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ ¬§¦¡˜«˜©«ž£á«à¤" to lsError_Message
49596>>>>>            Case Break
49597>>>>>
49597>>>>>            Case (iError_Num = 6669)
49600>>>>>                Move "DDC 006: ‘­á¢£˜ 6669 €›ç¤˜«ž ž › ˜š¨˜­ã!\n†£/¤å˜ ¡å¤ž©žª §¨¦šœ¤â©«œ¨ž ž£/¤å˜ª ¡¢œ ›é£˜«¦ª" to lsError_Message
49601>>>>>            Case Break
49602>>>>>
49602>>>>>            Case (iError_Num = 22277)
49605>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n†£œ¨¦£ž¤åœª œ¡«æª ¦¨åà¤ ®¨ã©žª" to lsError_Message
49606>>>>>            Case Break
49607>>>>>
49607>>>>>            Case (iError_Num = 22278)
49610>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ã!\n\„®œ  «¬§àŸœ  Ÿœà¨ž£â¤¦" to lsError_Message
49611>>>>>            Case Break
49612>>>>>
49612>>>>>            Case (iError_Num = 22279)
49615>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\„®œ  «¬§àŸœ  Ÿœà¨ž£â¤¦" to lsError_Message
49616>>>>>            Case Break
49617>>>>>
49617>>>>>            Case (iError_Num = 11170)
49620>>>>>                Move "DDC 006:’¦ § ©«à« ¡æ æ¨ ¦ «¦¬ ­¦¨â˜ â®œ  œ¥˜¤«¢žŸœå" to lsError_Message
49621>>>>>            Case Break
49622>>>>>
49622>>>>>            Case (iError_Num = 11171)
49625>>>>>                Move "DDC 006:’¦ § ©«à« ¡æ æ¨ ¦ «¦¬ “§. ¢ž¨à£é¤ â®œ  œ¥˜¤«¢žŸœå" to lsError_Message
49626>>>>>            Case Break
49627>>>>>
49627>>>>>            Case (iError_Num = 11172)
49630>>>>>                Move "DDC 006:Ž ­¦¨â˜ª œå¤˜  ¡¢œ ›à£â¤¦ª ¢æšà § ©«à« ¡¦ç ¦¨å¦¬" to lsError_Message
49631>>>>>            Case Break
49632>>>>>
49632>>>>>            Case (iError_Num = 22288)
49635>>>>>                Clear Codemast
49636>>>>>                Move "MODULE" to Codemast.Type
49637>>>>>                Move Cmoves.Module_From to Codemast.Code
49638>>>>>                Find Eq Codemast by Index.1 //type+code
49639>>>>>>
49639>>>>>                Move ("DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n(† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
49640>>>>>            Case Break
49641>>>>>
49641>>>>>            Case (iError_Num = 22250)
49644>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n’¦ ¡ç¡¢à£˜ (Module) «žª œšš¨˜­ãª œå¤˜  ¡œ¤æ" to lsError_Message
49645>>>>>            Case Break
49646>>>>>
49646>>>>>            Case (iError_Num = 22284)
49649>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ «˜ €¥ æš¨˜­˜" to lsError_Message
49650>>>>>            Case Break
49651>>>>>            Case (iError_Num = 22283)
49654>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ « ª à¢ã©œ ª" to lsError_Message
49655>>>>>            Case Break
49656>>>>>            Case (iError_Num = 22282)
49659>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ « ª €š¦¨âª" to lsError_Message
49660>>>>>            Case Break
49661>>>>>
49661>>>>>            //˜§æ validate delete
49661>>>>>            Case (iError_Num = 22289)
49664>>>>>                Clear Codemast
49665>>>>>                Move "MODULE" to Codemast.Type
49666>>>>>                Move Cmoves.Module_From to Codemast.Code
49667>>>>>                Find Eq Codemast by Index.1 //type+code
49668>>>>>>
49668>>>>>                Move ("DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n(† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
49669>>>>>            Case Break
49670>>>>>
49670>>>>>            Case (iError_Num = 22287)
49673>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ «˜ €¥ æš¨˜­˜" to lsError_Message
49674>>>>>            Case Break
49675>>>>>            Case (iError_Num = 22286)
49678>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ « ª à¢ã©œ ª" to lsError_Message
49679>>>>>            Case Break
49680>>>>>            Case (iError_Num = 22285)
49683>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ « ª €š¦¨âª" to lsError_Message
49684>>>>>            Case Break
49685>>>>>
49685>>>>>            //â¢œš®¦  open items
49685>>>>>            Case (iError_Num = 10101)
49688>>>>>                Move ("DDC 006:€¡˜«á¢¢ž¢ž „šš¨˜­ã.\n\n"+;                "’¦ ©¬©®œ« ©£â¤¦ §¦©æ œå¤˜  £œš˜¢ç«œ¨¦\n˜§¦ «¦ ˜¨® ¡á › ˜Ÿâ© £¦ §¨¦ª ©¬©®â« ©ž");                to lsError_Message
49689>>>>>            Case Break
49690>>>>>
49690>>>>>            Case Else
49690>>>>>                Forward Send Operation_Not_Allowed iError_Num
49692>>>>>        Case End
49692>>>>>
49692>>>>>        Error iError_Num lsError_Message
49693>>>>>>
49693>>>>>    End_Procedure // operation_not_allowed
49694>>>>>
49694>>>>>
49694>>>>>    // Define_Fields:
49694>>>>>    // This procedure is used to set up all data-dictionary rules.
49694>>>>>
49694>>>>>    Procedure Define_Fields
49695>>>>>        Forward Send Define_Fields
49697>>>>>        //DDB-Generated-Code-Location
49697>>>>>        //DDB-DefineFieldStart
49697>>>>>
49697>>>>>        Set Main_File            To Cmoves.File_Number
49698>>>>>        Set Cascade_Delete_State To FALSE
49699>>>>>
49699>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49700>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49701>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49702>>>>>
49702>>>>>        // Child (Client) file structure................
49702>>>>>        Send Add_Client_File  Copen.File_Number
49703>>>>>
49703>>>>>        // Parent (Server) file structure...............
49703>>>>>        Send Add_Server_File  Ctypkin.File_Number
49704>>>>>        Send Add_Server_File  Clients.File_Number
49705>>>>>
49705>>>>>        // External (System) file structure.............
49705>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_NEW_SAVE_DELETE
49706>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
49707>>>>>
49707>>>>>        Define_Auto_Increment  Sysrecc.Cmoves_Rec0  To Cmoves.Cmoves_Rec0
49710>>>>>
49710>>>>>        // Field-based properties.......................
49710>>>>>
49710>>>>>        // Cmoves.Company_Code
49710>>>>>
49710>>>>>        // Cmoves.Branch_Code
49710>>>>>
49710>>>>>        // Cmoves.Year_Year
49710>>>>>
49710>>>>>        // Cmoves.Custprom_Code
49710>>>>>
49710>>>>>        // Cmoves.Client_Id
49710>>>>>
49710>>>>>        // Cmoves.Ctypkin_Code
49710>>>>>
49710>>>>>        // Cmoves.Cmoves_Recr
49710>>>>>
49710>>>>>        // Cmoves.Cmoves_Rec0
49710>>>>>        Set Field_Options          Field Cmoves.Cmoves_Rec0 To DD_AUTOFIND   
49711>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Rec0 To (sl006(Self))
49712>>>>>
49712>>>>>        // Cmoves.Cmoves_Hmnia
49712>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Hmnia To (sl006(Self))
49713>>>>>
49713>>>>>        // Cmoves.Ctypkin_Recr
49713>>>>>
49713>>>>>        // Cmoves.Cmoves_Par
49713>>>>>
49713>>>>>        // Cmoves.Partl_Recr
49713>>>>>        //DDB/ Comment_Short       Field Cmoves.Partl_Recr To "‘¬¤›œ©ž record £œ ¡ç¡¢à£˜ à¢ã©œà¤"
49713>>>>>
49713>>>>>        // Cmoves.Cmoves_Axia
49713>>>>>
49713>>>>>        // Cmoves.Cmoves_X0
49713>>>>>
49713>>>>>        // Cmoves.Cmoves_P0
49713>>>>>
49713>>>>>        // Cmoves.Cmoves_X00
49713>>>>>
49713>>>>>        // Cmoves.Cmoves_P00
49713>>>>>
49713>>>>>        // Cmoves.Cmoves_X1
49713>>>>>
49713>>>>>        // Cmoves.Cmoves_P1
49713>>>>>
49713>>>>>        // Cmoves.Cmoves_X2
49713>>>>>
49713>>>>>        // Cmoves.Cmoves_P2
49713>>>>>
49713>>>>>        // Cmoves.Cmoves_Dlixis
49713>>>>>
49713>>>>>        // Cmoves.Cmoves_A_Code
49713>>>>>
49713>>>>>        // Cmoves.Cmoves_Status_E
49713>>>>>
49713>>>>>        // Cmoves.Cmoves_Status_A
49713>>>>>
49713>>>>>        // Cmoves.Cmoves_S0
49713>>>>>
49713>>>>>        // Cmoves.Cmoves_Ys0
49713>>>>>
49713>>>>>        // Cmoves.Cmoves_S1
49713>>>>>
49713>>>>>        // Cmoves.Cmoves_Ys1
49713>>>>>
49713>>>>>        // Cmoves.Cmoves_S2
49713>>>>>
49713>>>>>        // Cmoves.Cmoves_Ys2
49713>>>>>
49713>>>>>        // Cmoves.Cmoves_Sc_Code2
49713>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Sc_Code2 To (slNomism(Self))
49714>>>>>
49714>>>>>        // Cmoves.Cmoves_Open
49714>>>>>
49714>>>>>        // Cmoves.Cmoves_Aopen
49714>>>>>
49714>>>>>        // Cmoves.Cmoves_M_Code
49714>>>>>
49714>>>>>        // Cmoves.Cmoves_Yn_Myf
49714>>>>>
49714>>>>>        // Cmoves.Cmoves_Myf_Axia
49714>>>>>
49714>>>>>        // Cmoves.Cmoves_Kk
49714>>>>>
49714>>>>>        // Cmoves.Cmoves_C_Code2
49714>>>>>
49714>>>>>        // Cmoves.Cn_Code
49714>>>>>        Set Field_Prompt_Object    Field Cmoves.Cn_Code To (sl041(Self))
49715>>>>>
49715>>>>>        // Cmoves.Client_Recr
49715>>>>>
49715>>>>>        // Cmoves.Barticl_Recr
49715>>>>>
49715>>>>>        // Cmoves.Cmoves_Qty
49715>>>>>
49715>>>>>        // Cmoves.Cmove_Totambd0
49715>>>>>
49715>>>>>        // Cmoves.Cmove_Discam0
49715>>>>>
49715>>>>>        // Cmoves.Cmove_Totamad0
49715>>>>>
49715>>>>>        // Cmoves.Cmove_Vatam0
49715>>>>>
49715>>>>>        // Cmoves.Cmove_Extra0
49715>>>>>
49715>>>>>        // Cmoves.Cmove_Totambd00
49715>>>>>
49715>>>>>        // Cmoves.Cmove_Discam00
49715>>>>>
49715>>>>>        // Cmoves.Cmove_Totamad00
49715>>>>>
49715>>>>>        // Cmoves.Cmove_Vatam00
49715>>>>>
49715>>>>>        // Cmoves.Cmove_Extra00
49715>>>>>
49715>>>>>        // Cmoves.Cmove_Totambd1
49715>>>>>
49715>>>>>        // Cmoves.Cmove_Discam1
49715>>>>>
49715>>>>>        // Cmoves.Cmove_Totamad1
49715>>>>>
49715>>>>>        // Cmoves.Cmove_Vatam1
49715>>>>>
49715>>>>>        // Cmoves.Cmove_Extra1
49715>>>>>
49715>>>>>        // Cmoves.Module_From
49715>>>>>
49715>>>>>        // Cmoves.Parast_Abrev
49715>>>>>
49715>>>>>        // Cmoves.Enhm_Ypol_Pel
49715>>>>>
49715>>>>>        // Cmoves.Enhm_Hmnies_Pel
49715>>>>>
49715>>>>>        // Cmoves.Sls_Id
49715>>>>>
49715>>>>>        // Cmoves.Presp_Id
49715>>>>>
49715>>>>>        // Cmoves.Cnt_Id
49715>>>>>
49715>>>>>        // Cmoves.Cmoves_Open_Sx0
49715>>>>>
49715>>>>>        // Cmoves.Cmoves_Open_Sp0
49715>>>>>
49715>>>>>        // Cmoves.Cmoves_Open_Yx0
49715>>>>>
49715>>>>>        // Cmoves.Cmoves_Open_Yp0
49715>>>>>
49715>>>>>        // Cmoves.Cmoves_Open_Sx1
49715>>>>>
49715>>>>>        // Cmoves.Cmoves_Open_Sp1
49715>>>>>
49715>>>>>        // Cmoves.Cmoves_Open_Sx2
49715>>>>>
49715>>>>>        // Cmoves.Cmoves_Open_Sp2
49715>>>>>
49715>>>>>        // Cmoves.Cmoves_Topen
49715>>>>>
49715>>>>>        // Cmoves.Cn_Recr
49715>>>>>
49715>>>>>        // Cmoves.Axia_Pros_Sysx
49715>>>>>
49715>>>>>        // Cmoves.Axia_Sysxet
49715>>>>>
49715>>>>>        // Cmoves.Axia_Ypol_Sysx
49715>>>>>
49715>>>>>        // Cmoves.Axia_Pros_Sys00
49715>>>>>
49715>>>>>        // Cmoves.Axia_Sysxet00
49715>>>>>
49715>>>>>        // Cmoves.Axia_Ypol_Sys00
49715>>>>>
49715>>>>>        // Cmoves.Axia_Pros_Sysr
49715>>>>>
49715>>>>>        // Cmoves.Axia_Sysxetr
49715>>>>>
49715>>>>>        // Cmoves.Axia_Ypol_Sysr
49715>>>>>
49715>>>>>        // Cmoves.Mhxanik_Id
49715>>>>>
49715>>>>>        // Cmoves.Prn_Theor
49715>>>>>
49715>>>>>        // Cmoves.Is_Closed
49715>>>>>
49715>>>>>        // Cmoves.Flag_Copen
49715>>>>>
49715>>>>>        // Cmoves.Flag_Ypol
49715>>>>>
49715>>>>>        // Cmoves.Ctypkin_Descr
49715>>>>>
49715>>>>>        // Cmoves.Client_Name
49715>>>>>
49715>>>>>        // Cmoves.Enhm_Ofeilh
49715>>>>>
49715>>>>>        // Cmoves.Sap_Hmnia
49715>>>>>
49715>>>>>        //DDB-DefineFieldEnd
49715>>>>>    End_Procedure    // Define_Fields
49716>>>>>
49716>>>>>    // Field_Defaults:
49716>>>>>    // This procedure is used to establish default field values.
49716>>>>>
49716>>>>>    Procedure Field_Defaults
49717>>>>>        Forward Send Field_Defaults
49719>>>>>        //DDB-Generated-Code-Location
49719>>>>>        //DDB-FieldDefaultStart
49719>>>>>        //DDB-FieldDefaultEnd
49719>>>>>    End_Procedure    // Field_Defaults
49720>>>>>
49720>>>>>End_Class    // Cmoves_DataDictionary
49721>>>>>//DDB-Selection-pkg-Start
49721>>>>>
49721>>>>>Use sl006.SL         // sl006
INCLUDING FILE: SL006.SL
49721>>>>>>>//AB/ Project sl006:Cmoves lookup
49721>>>>>>>//AB/ Object prj is a Lookup_Project
49721>>>>>>>//AB/     Set ProjectName to "sl006:Cmoves lookup"
49721>>>>>>>//AB/     Set ProjectFileName to "sl006.SL"
49721>>>>>>>//AB/     Set GenerateFileName to "NONAME"
49721>>>>>>>
49721>>>>>>>// Project Object Structure
49721>>>>>>>//   sl006 is a dbModalPanelSub
49721>>>>>>>//     Ctypkin_DD is a DataDictionary
49721>>>>>>>//     Clients_DD is a DataDictionary
49721>>>>>>>//     Cmoves_DD is a DataDictionary
49721>>>>>>>//     oSelList is a dbListSub
49721>>>>>>>//     oOK_bn is a ButtonSub
49721>>>>>>>//     oCancel_bn is a ButtonSub
49721>>>>>>>//     oSearch_bn is a ButtonSub
49721>>>>>>>//     Cmoves_Axia_Pros_Sysx is a dbFormSub
49721>>>>>>>//     Cmoves_Axia_Sysxet is a dbFormSub
49721>>>>>>>//     Cmoves_Axia_Ypol_Sysx is a dbFormSub
49721>>>>>>>//     TextBoxSub1 is a TextBoxSub
49721>>>>>>>//     TextBoxSub2 is a TextBoxSub
49721>>>>>>>//     TextBoxSub3 is a TextBoxSub
49721>>>>>>>//     RadioGroupSub2 is a RadioGroupSub
49721>>>>>>>//       Radio4 is a RadioSub
49721>>>>>>>//       Radio5 is a RadioSub
49721>>>>>>>//       Radio6 is a RadioSub
49721>>>>>>>
49721>>>>>>>// Register all objects
49721>>>>>>>Register_Object Clients_DD
49721>>>>>>>Register_Object Cmoves_Axia_Pros_Sysx
49721>>>>>>>Register_Object Cmoves_Axia_Sysxet
49721>>>>>>>Register_Object Cmoves_Axia_Ypol_Sysx
49721>>>>>>>Register_Object Cmoves_DD
49721>>>>>>>Register_Object Ctypkin_DD
49721>>>>>>>Register_Object oCancel_bn
49721>>>>>>>Register_Object oOK_bn
49721>>>>>>>Register_Object oSearch_bn
49721>>>>>>>Register_Object oSelList
49721>>>>>>>Register_Object Radio4
49721>>>>>>>Register_Object Radio5
49721>>>>>>>Register_Object Radio6
49721>>>>>>>Register_Object RadioGroupSub2
49721>>>>>>>Register_Object sl006
49721>>>>>>>Register_Object TextBoxSub1
49721>>>>>>>Register_Object TextBoxSub2
49721>>>>>>>Register_Object TextBoxSub3
49721>>>>>>>
49721>>>>>>>
49721>>>>>>>//AB-IgnoreStart
49721>>>>>>>
49721>>>>>>>Use DFAllEnt.pkg
49721>>>>>>>Use dbList.Sub
49721>>>>>>>Use Button.Sub
49721>>>>>>>Use dbForm.Sub
49721>>>>>>>Use Txtbox.Sub
49721>>>>>>>Use Rgroup.Sub
49721>>>>>>>Use Radio.Sub
49721>>>>>>>
49721>>>>>>>
49721>>>>>>>Use CTYPKIN.DD
49721>>>>>>>Use CLIENTS.DD
49721>>>>>>>Use CMOVES.DD
49721>>>>>>>
49721>>>>>>>//AB-IgnoreEnd
49721>>>>>>>
49721>>>>>>>Object sl006 is a dbModalPanelSub
49723>>>>>>>
49723>>>>>>>    //AB-StoreTopStart
49723>>>>>>>                                        
49723>>>>>>>    Property String     psModule    Public ''
49725>>>>>>>    Property String     psClientID  Public ''
49727>>>>>>>    Property Date       pdApo       public ''
49729>>>>>>>    Property Date       pdEos       public ''
49731>>>>>>>    Property Integer    piXr_Or_Pi  public  0
49733>>>>>>>    Property Integer    piWhat      public  0
49735>>>>>>>    
49735>>>>>>>    //AB-StoreTopEnd
49735>>>>>>>
49735>>>>>>>    Set Label to "‰ ¤ã©œ ª ”¦¨âà¤"
49736>>>>>>>    Set Size to 270 519
49737>>>>>>>    Set Location to 5 7
49738>>>>>>>    Set Exit_Application_Local_State to FALSE
49739>>>>>>>    Set Modal_State to FALSE
49740>>>>>>>
49740>>>>>>>    //AB-DDOStart
49740>>>>>>>
49740>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
49742>>>>>>>    End_Object    // Ctypkin_DD
49743>>>>>>>
49743>>>>>>>    Object Clients_DD is a Clients_DataDictionary
49745>>>>>>>    End_Object    // Clients_DD
49746>>>>>>>
49746>>>>>>>    Object Cmoves_DD is a Cmoves_DataDictionary
49748>>>>>>>        Set DDO_Server to (Ctypkin_DD(self))
49749>>>>>>>        Set DDO_Server to (Clients_DD(self))
49750>>>>>>>
49750>>>>>>>        //AB-StoreStart
49750>>>>>>>        
49750>>>>>>>        Begin_Constraints
49752>>>>>>>        
49752>>>>>>>            Constrain Cmoves.Company_Code   Eq SyscurXr.Company_Code
49754>>>>>>>            Constrain Cmoves.Year_Year      Eq SyscurXr.Year_Year
49756>>>>>>>        
49756>>>>>>>            If (psClientID(Self)<>'')   Constrain Cmoves.Client_ID      Eq (psClientID(Self))
49760>>>>>>>            If (pdApo(Self)<>'')        Constrain Cmoves.Cmoves_Hmnia   Ge (pdApo(Self))
49764>>>>>>>            If (pdEos(Self)<>'')        Constrain Cmoves.Cmoves_Hmnia   Le (pdEos(Self))
49768>>>>>>>        
49768>>>>>>>            Constrain Cmoves.Module_From    Eq (psModule(Self))
49770>>>>>>>        
49770>>>>>>>                 If (piWhat(Self)=1) Constrain Cmoves.Flag_Ypol Eq 1
49774>>>>>>>            Else If (piWhat(Self)=2) Constrain Cmoves.Flag_Ypol Eq 0
49779>>>>>>>        
49779>>>>>>>        End_Constraints
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        
49782>>>>>>>        //AB-StoreEnd
49782>>>>>>>
49782>>>>>>>    End_Object    // Cmoves_DD
49783>>>>>>>
49783>>>>>>>    Set Main_DD to (Cmoves_DD(self))
49784>>>>>>>    Set Server to (Cmoves_DD(self))
49785>>>>>>>
49785>>>>>>>    //AB-DDOEnd
49785>>>>>>>
49785>>>>>>>    Object oSelList is a dbListSub
49787>>>>>>>
49787>>>>>>>        //AB-StoreTopStart
49787>>>>>>>                                                                                                                                                                                                                                                                                                                            
49787>>>>>>>        //AB-StoreTopEnd
49787>>>>>>>
49787>>>>>>>        Set Main_File to Cmoves.File_Number
49788>>>>>>>        Set Ordering to 4
49789>>>>>>>        Set Size to 199 505
49790>>>>>>>        Set Location to 31 7
49791>>>>>>>        Set Auto_Index_State to FALSE
49792>>>>>>>
49792>>>>>>>        Begin_Row
49795>>>>>>>            Entry_Item Cmoves.Cmoves_hmnia
49796>>>>>>>            Entry_Item Cmoves.Cmoves_par
49797>>>>>>>            Entry_Item Ctypkin.Ctypkin_descr
49798>>>>>>>            Entry_Item Clients.Client_name
49799>>>>>>>            Entry_Item Cmoves.Cmoves_axia
49800>>>>>>>            Entry_Item Cmoves.Cmoves_sc_code2
49801>>>>>>>            Entry_Item Cmoves.Branch_code
49802>>>>>>>        End_Row
49807>>>>>>>
49807>>>>>>>        Set Form_Width    item 0 to 57
49808>>>>>>>        Set Header_Label  item 0 to "†£œ¨/¤å˜"
49809>>>>>>>        
49809>>>>>>>        Set Form_Width    item 1 to 121
49810>>>>>>>        Set Header_Label  item 1 to "€ « ¦¢¦šå˜"
49811>>>>>>>        
49811>>>>>>>        Set Form_Width    item 2 to 65
49812>>>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
49813>>>>>>>        
49813>>>>>>>        Set Form_Width    item 3 to 107
49814>>>>>>>        Set Header_Label  item 3 to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
49815>>>>>>>        
49815>>>>>>>        Set Form_Width    item 4 to 63
49816>>>>>>>        Set Header_Label  item 4 to " €¥å˜"
49817>>>>>>>        
49817>>>>>>>        Set Form_Width    item 5 to 42
49818>>>>>>>        Set Header_Label  item 5 to "Œæ£ ©£˜"
49819>>>>>>>        
49819>>>>>>>        Set Form_Width    item 6 to 45
49820>>>>>>>        Set Header_Label  item 6 to "“§¦¡/£˜"
49821>>>>>>>        
49821>>>>>>>
49821>>>>>>>        //AB-StoreStart
49821>>>>>>>                                                                                                                                                                                                                                                                                                                            
49821>>>>>>>        Procedure End_Construct_Object
49823>>>>>>>            String  sNom
49824>>>>>>>            Integer iDecs
49824>>>>>>>            Forward Send End_Construct_Object
49826>>>>>>>            Move SysCurxr.C_Code0 to sNom
49827>>>>>>>            Clear Nomisma
49828>>>>>>>            Move sNom to Nomisma.Nomisma_Code
49829>>>>>>>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
49830>>>>>>>>
49830>>>>>>>            If (Found=1)    Move Nomisma.Dekadika to iDecs
49833>>>>>>>            Else            Move 0 to iDecs
49835>>>>>>>        
49835>>>>>>>            // Ž¨ ¦¬£œ §àª ˜¤ «¦ ™˜© ¡æ ¤¦£ ©£˜ ®¨ã©žª ƒ„Œ œ®œ  ›œ¡˜› ¡á
49835>>>>>>>            // «æ«œ œ¥' ¦¨ ©£¦ç ™á¦¬£œ œ£œ ª 2
49835>>>>>>>            If (iDecs=0) Move 2 to iDecs
49838>>>>>>>            //
49838>>>>>>>        
49838>>>>>>>            Set Points          Item 4 to       iDecs
49839>>>>>>>            Set Numeric_Mask    Item 4 to 14    iDecs '*, '
49840>>>>>>>        End_Procedure
49841>>>>>>>        
49841>>>>>>>        
49841>>>>>>>        
49841>>>>>>>        
49841>>>>>>>        
49841>>>>>>>        //AB-StoreEnd
49841>>>>>>>
49841>>>>>>>    End_Object    // oSelList
49842>>>>>>>
49842>>>>>>>    Object oOK_bn is a ButtonSub
49844>>>>>>>        Set Label to "&„§ ¢¦šã"
49845>>>>>>>        Set Location to 236 350
49846>>>>>>>
49846>>>>>>>        //AB-StoreStart
49846>>>>>>>        Procedure OnClick
49848>>>>>>>            Send OK To (oSelList(current_object))
49849>>>>>>>        End_Procedure
49850>>>>>>>        //AB-StoreEnd
49850>>>>>>>
49850>>>>>>>    End_Object    // oOK_bn
49851>>>>>>>
49851>>>>>>>    Object oCancel_bn is a ButtonSub
49853>>>>>>>        Set Label to "&€¡ç¨à©ž"
49854>>>>>>>        Set Location to 236 404
49855>>>>>>>
49855>>>>>>>        //AB-StoreStart
49855>>>>>>>        Procedure OnClick
49857>>>>>>>            Send Cancel To (oSelList(current_object))
49858>>>>>>>        End_Procedure
49859>>>>>>>        //AB-StoreEnd
49859>>>>>>>
49859>>>>>>>    End_Object    // oCancel_bn
49860>>>>>>>
49860>>>>>>>    Object oSearch_bn is a ButtonSub
49862>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
49863>>>>>>>        Set Location to 236 460
49864>>>>>>>
49864>>>>>>>        //AB-StoreStart
49864>>>>>>>        Procedure OnClick
49866>>>>>>>            Send Search To (oSelList(current_object))
49867>>>>>>>        End_Procedure
49868>>>>>>>        //AB-StoreEnd
49868>>>>>>>
49868>>>>>>>    End_Object    // oSearch_bn
49869>>>>>>>
49869>>>>>>>    Object Cmoves_Axia_Pros_Sysx is a dbFormSub
49871>>>>>>>        Entry_Item Cmoves.Axia_pros_sysx
49872>>>>>>>        Set Size to 13 54
49873>>>>>>>        Set Location to 236 24
49874>>>>>>>        Set Color to clBtnFace
49875>>>>>>>        Set Label_Col_Offset to 2
49876>>>>>>>        Set Label_Justification_Mode to jMode_Right
49877>>>>>>>        Set Enabled_State to FALSE
49878>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
49879>>>>>>>        Set Shadow_State Item 0 to TRUE
49880>>>>>>>
49880>>>>>>>        //AB-StoreStart
49880>>>>>>>        Set points item 0 to 2
49881>>>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
49882>>>>>>>        
49882>>>>>>>        //AB-StoreEnd
49882>>>>>>>
49882>>>>>>>    End_Object    // Cmoves_Axia_Pros_Sysx
49883>>>>>>>
49883>>>>>>>    Object Cmoves_Axia_Sysxet is a dbFormSub
49885>>>>>>>        Entry_Item Cmoves.Axia_sysxet
49886>>>>>>>        Set Size to 13 54
49887>>>>>>>        Set Location to 236 140
49888>>>>>>>        Set Color to clBtnFace
49889>>>>>>>        Set Label_Col_Offset to 2
49890>>>>>>>        Set Label_Justification_Mode to jMode_Right
49891>>>>>>>        Set Enabled_State to FALSE
49892>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
49893>>>>>>>        Set Shadow_State Item 0 to TRUE
49894>>>>>>>
49894>>>>>>>        //AB-StoreStart
49894>>>>>>>        Set points item 0 to 2
49895>>>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
49896>>>>>>>        
49896>>>>>>>        //AB-StoreEnd
49896>>>>>>>
49896>>>>>>>    End_Object    // Cmoves_Axia_Sysxet
49897>>>>>>>
49897>>>>>>>    Object Cmoves_Axia_Ypol_Sysx is a dbFormSub
49899>>>>>>>        Entry_Item Cmoves.Axia_ypol_sysx
49900>>>>>>>        Set Size to 13 54
49901>>>>>>>        Set Location to 236 248
49902>>>>>>>        Set Color to clBtnFace
49903>>>>>>>        Set Label_Col_Offset to 2
49904>>>>>>>        Set Label_Justification_Mode to jMode_Right
49905>>>>>>>        Set Enabled_State to FALSE
49906>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
49907>>>>>>>        Set Shadow_State Item 0 to TRUE
49908>>>>>>>
49908>>>>>>>        //AB-StoreStart
49908>>>>>>>                                                                                                    
49908>>>>>>>        Set points item 0 to 2
49909>>>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
49910>>>>>>>        
49910>>>>>>>        //AB-StoreEnd
49910>>>>>>>
49910>>>>>>>    End_Object    // Cmoves_Axia_Ypol_Sysx
49911>>>>>>>
49911>>>>>>>    Object TextBoxSub1 is a TextBoxSub
49913>>>>>>>        Set Label to "€¥å˜"
49914>>>>>>>        Set Location to 238 7
49915>>>>>>>        Set Size to 10 15
49916>>>>>>>    End_Object    // TextBoxSub1
49917>>>>>>>
49917>>>>>>>    Object TextBoxSub2 is a TextBoxSub
49919>>>>>>>        Set Label to "‘¬©®œ« ©£â¤ž"
49920>>>>>>>        Set Location to 238 89
49921>>>>>>>        Set Size to 10 49
49922>>>>>>>    End_Object    // TextBoxSub2
49923>>>>>>>
49923>>>>>>>    Object TextBoxSub3 is a TextBoxSub
49925>>>>>>>        Set Label to "ƒ ˜Ÿâ© £ž"
49926>>>>>>>        Set Location to 238 210
49927>>>>>>>        Set Size to 10 35
49928>>>>>>>    End_Object    // TextBoxSub3
49929>>>>>>>
49929>>>>>>>    Object RadioGroupSub2 is a RadioGroupSub
49931>>>>>>>        Set Label to "„§ ¢¦šã ‰ ¤ã©œà¤"
49932>>>>>>>        Set Size to 24 497
49933>>>>>>>        Set Location to 3 9
49934>>>>>>>        Object Radio4 is a RadioSub
49936>>>>>>>            Set Label to "Ž¢œª"
49937>>>>>>>            Set Size to 10 37
49938>>>>>>>            Set Location to 10 97
49939>>>>>>>        End_Object    // Radio4
49940>>>>>>>
49940>>>>>>>        Object Radio5 is a RadioSub
49942>>>>>>>            Set Label to "‹œ ¬§æ¢¦ §¦ ©¬©®â« ©žª"
49943>>>>>>>            Set Size to 10 97
49944>>>>>>>            Set Location to 10 167
49945>>>>>>>        End_Object    // Radio5
49946>>>>>>>
49946>>>>>>>        Object Radio6 is a RadioSub
49948>>>>>>>            Set Label to "•à¨åª ¬§æ¢¦ §¦ ©¬©®â« ©žª"
49949>>>>>>>            Set Size to 10 111
49950>>>>>>>            Set Location to 10 278
49951>>>>>>>        End_Object    // Radio6
49952>>>>>>>
49952>>>>>>>
49952>>>>>>>        //AB-StoreStart
49952>>>>>>>                                                                                        
49952>>>>>>>        Procedure Notify_Select_State integer iToItem integer iFromItem
49954>>>>>>>            Set piWhat to iToItem
49955>>>>>>>            Send Rebuild_Constraints to Cmoves_DD
49956>>>>>>>            Send Beginning_Of_Data To oSelList True
49957>>>>>>>        End_Procedure
49958>>>>>>>        
49958>>>>>>>        Set Current_Radio to 1
49959>>>>>>>        
49959>>>>>>>        
49959>>>>>>>        
49959>>>>>>>        
49959>>>>>>>        //AB-StoreEnd
49959>>>>>>>
49959>>>>>>>    End_Object    // RadioGroupSub2
49960>>>>>>>
49960>>>>>>>
49960>>>>>>>    //AB-StoreStart
49960>>>>>>>                                        
49960>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49961>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49962>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49963>>>>>>>    
49963>>>>>>>    Set Modal_State to True
49964>>>>>>>    
49964>>>>>>>    Procedure Activate
49966>>>>>>>        String  sNom
49967>>>>>>>        Integer iDecs rVal
49967>>>>>>>        Set piWhat to 1
49968>>>>>>>        Set Current_Radio Of RadioGroupSub2 to 1
49969>>>>>>>        Forward Send Activate
49971>>>>>>>        Send Rebuild_Constraints        to Cmoves_DD
49972>>>>>>>        Send Beginning_Of_Data          to oSelList True
49973>>>>>>>    End_procedure
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    
49974>>>>>>>    //AB-StoreEnd
49974>>>>>>>
49974>>>>>>>End_Object    // sl006
49975>>>>>>>
49975>>>>>>>//AB/ End_Object    // prj
49975>>>>>Use slnomism.sl      // slNomism
INCLUDING FILE: SLNOMISM.SL
49975>>>>>>>//AB/ Project slNomism
49975>>>>>>>//AB/ Object prj is a Lookup_Project
49975>>>>>>>//AB/     Set ProjectName to "slNomism"
49975>>>>>>>//AB/     Set ProjectFileName to "slNomism.SL"
49975>>>>>>>//AB/     Set GenerateFileName to "NONAME"
49975>>>>>>>
49975>>>>>>>// Project Object Structure
49975>>>>>>>//   slNomism is a dbModalPanelSub
49975>>>>>>>//     Nomisma_DD is a DataDictionary
49975>>>>>>>//     oSelList is a dbListSub
49975>>>>>>>//     oOK_bn is a ButtonSub
49975>>>>>>>//     oSearch_bn is a ButtonSub
49975>>>>>>>
49975>>>>>>>// Register all objects
49975>>>>>>>Register_Object Nomisma_DD
49975>>>>>>>Register_Object oOK_bn
49975>>>>>>>Register_Object oSearch_bn
49975>>>>>>>Register_Object oSelList
49975>>>>>>>Register_Object slNomism
49975>>>>>>>
49975>>>>>>>
49975>>>>>>>//AB-IgnoreStart
49975>>>>>>>
49975>>>>>>>Use DFAllEnt.pkg
49975>>>>>>>Use dbList.Sub
49975>>>>>>>Use Button.Sub
49975>>>>>>>
49975>>>>>>>
49975>>>>>>>Use NOMISMA.DD
49975>>>>>>>
49975>>>>>>>//AB-IgnoreEnd
49975>>>>>>>
49975>>>>>>>Object slNomism is a dbModalPanelSub
49977>>>>>>>
49977>>>>>>>    //AB-StoreTopStart
49977>>>>>>>    
49977>>>>>>>    
49977>>>>>>>    
49977>>>>>>>    //AB-StoreTopEnd
49977>>>>>>>
49977>>>>>>>    Set Label to "Œ¦£å©£˜«˜"
49978>>>>>>>    Set Size to 175 397
49979>>>>>>>    Set Location to 5 7
49980>>>>>>>    Set Exit_Application_Local_State to FALSE
49981>>>>>>>    Set Modal_State to FALSE
49982>>>>>>>
49982>>>>>>>    //AB-DDOStart
49982>>>>>>>
49982>>>>>>>    Object Nomisma_DD is a Nomisma_DataDictionary
49984>>>>>>>    End_Object    // Nomisma_DD
49985>>>>>>>
49985>>>>>>>    Set Main_DD to (Nomisma_DD(self))
49986>>>>>>>    Set Server to (Nomisma_DD(self))
49987>>>>>>>
49987>>>>>>>    //AB-DDOEnd
49987>>>>>>>
49987>>>>>>>    Object oSelList is a dbListSub
49989>>>>>>>        Set Main_File to Nomisma.File_Number
49990>>>>>>>        Set Size to 130 382
49991>>>>>>>        Set Location to 6 6
49992>>>>>>>
49992>>>>>>>        Begin_Row
49995>>>>>>>            Entry_Item Nomisma.Nomisma_code
49996>>>>>>>            Entry_Item Nomisma.Nomisma_descr
49997>>>>>>>            Entry_Item Nomisma.Dekadika
49998>>>>>>>            Entry_Item Nomisma.Euro_zone
49999>>>>>>>            Entry_Item Nomisma.Einai_drx
50000>>>>>>>            Entry_Item Nomisma.Einai_euro
50001>>>>>>>        End_Row
50006>>>>>>>
50006>>>>>>>        Set Form_Width    item 0 to 49
50007>>>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
50008>>>>>>>        
50008>>>>>>>        Set Form_Width    item 1 to 115
50009>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
50010>>>>>>>        
50010>>>>>>>        Set Form_Width    item 2 to 47
50011>>>>>>>        Set Header_Label  item 2 to "ƒœ¡˜› ¡á"
50012>>>>>>>        
50012>>>>>>>        Set Form_Width    item 3 to 55
50013>>>>>>>        Set Header_Label  item 3 to "…é¤ž EURO"
50014>>>>>>>        Set Column_Checkbox_State  item 3 to True
50015>>>>>>>        
50015>>>>>>>        Set Form_Width    item 4 to 55
50016>>>>>>>        Set Header_Label  item 4 to "„å¤˜  ƒ•"
50017>>>>>>>        Set Column_Checkbox_State  item 4 to True
50018>>>>>>>        
50018>>>>>>>        Set Form_Width    item 5 to 55
50019>>>>>>>        Set Header_Label  item 5 to "„å¤˜  „¬¨é"
50020>>>>>>>        Set Column_Checkbox_State  item 5 to True
50021>>>>>>>        
50021>>>>>>>
50021>>>>>>>        //AB-StoreStart
50021>>>>>>>        
50021>>>>>>>        //AB-StoreEnd
50021>>>>>>>
50021>>>>>>>    End_Object    // oSelList
50022>>>>>>>
50022>>>>>>>    Object oOK_bn is a ButtonSub
50024>>>>>>>        Set Label to "&„§ ¢¦šã"
50025>>>>>>>        Set Location to 140 279
50026>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
50027>>>>>>>
50027>>>>>>>        //AB-StoreStart
50027>>>>>>>        Procedure OnClick
50029>>>>>>>            Send OK To (oSelList(current_object))
50030>>>>>>>        End_Procedure
50031>>>>>>>        //AB-StoreEnd
50031>>>>>>>
50031>>>>>>>    End_Object    // oOK_bn
50032>>>>>>>
50032>>>>>>>    Object oSearch_bn is a ButtonSub
50034>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
50035>>>>>>>        Set Location to 140 339
50036>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
50037>>>>>>>
50037>>>>>>>        //AB-StoreStart
50037>>>>>>>        
50037>>>>>>>        Procedure OnClick
50039>>>>>>>            Send Search To (oSelList(current_object))
50040>>>>>>>        End_Procedure
50041>>>>>>>        
50041>>>>>>>        
50041>>>>>>>        Set Visible_State to False
50042>>>>>>>        Set Enabled_State to False
50043>>>>>>>        //AB-StoreEnd
50043>>>>>>>
50043>>>>>>>    End_Object    // oSearch_bn
50044>>>>>>>
50044>>>>>>>
50044>>>>>>>    //AB-StoreStart
50044>>>>>>>    
50044>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
50045>>>>>>>    
50045>>>>>>>    On_Key Key_Alt+Key_s Send KeyAction To (oSearch_bn(current_object))
50046>>>>>>>    
50046>>>>>>>    
50046>>>>>>>    
50046>>>>>>>    
50046>>>>>>>    //AB-StoreEnd
50046>>>>>>>
50046>>>>>>>End_Object    // slNomism
50047>>>>>>>
50047>>>>>>>//AB/ End_Object    // prj
50047>>>>>Use sl041.SL         // sl041
50047>>>>>
50047>>>>>//DDB-Selection-pkg-End
50047>>>>>//DDB-FileEnd
50047>>>    USE CMOVESA.DD
INCLUDING FILE: CMOVESA.DD
50047>>>>>//DDB-FileStart
50047>>>>>//DDB-HeaderStart
50047>>>>>
50047>>>>>// File Name : CMOVESA.DD
50047>>>>>// Class Name: Cmovesa_DataDictionary
50047>>>>>// Revision  : 58
50047>>>>>// Version   : 2
50047>>>>>
50047>>>>>Use  Windows           // Basic Definitions
50047>>>>>Use  DataDict          // DataDictionary Class Definition
50047>>>>>Use  DDvalTbl          // Validation Table Class Definitions
50047>>>>>
50047>>>>>Open Cmovesa
50049>>>>>Open Copen
50051>>>>>
50051>>>>>//DDB-HeaderEnd
50051>>>>>//DDB-SelectionStart
50051>>>>>//DDB/ ExternalSelectionList sl006a1  sl006a1.SL
50051>>>>>Register_Object sl006a1
50051>>>>>//DDB-SelectionEnd
50051>>>>>//open master file
50051>>>>>Open Cmoves
50053>>>>>
50053>>>>>//define alias-master condition
50053>>>>>Set_Attribute DF_FILE_ALIAS of Cmoves.File_Number  to DF_FILE_IS_MASTER
50056>>>>>Set_Attribute DF_FILE_ALIAS of Cmovesa.File_Number to DF_FILE_IS_ALIAS
50059>>>>>
50059>>>>>Set_Relate Cmovesa.Ctypkin_Recr     to |FN0,0
50060>>>>>>
50060>>>>>Set_Relate Cmovesa.Client_Recr      to |FN0,0
50061>>>>>>
50061>>>>>
50061>>>>>Class Cmovesa_DataDictionary  is a DataDictionary_Sec
50062>>>>>
50062>>>>>//    Procedure Do_Compute_Open_Itemsa
50062>>>>>//        Case Begin
50062>>>>>//                Case (Cmovesa.Cmoves_X0 > 0) //˜«æ­ ¦ ®¨œà©« ¡æ record
50062>>>>>//                    Move "+"                                              to Cmovesa.Cmoves_Topen
50062>>>>>//                    Move (Cmovesa.Cmoves_X0 - Cmovesa.Cmoves_Open_Sx0)    to Cmovesa.Cmoves_Open_Yx0
50062>>>>>//                    Move 0                                                to Cmovesa.Cmoves_Open_Yp0
50062>>>>>//                Case Break
50062>>>>>
50062>>>>>//                Case (Cmovesa.Cmoves_X0 < 0) //¯œ¬«¦- ®¨œà©« ¡æ record
50062>>>>>//                    Move "-"                                                 to Cmovesa.Cmoves_Topen
50062>>>>>//                    Move ((Abs(Cmovesa.Cmoves_X0))- Cmovesa.Cmoves_Open_Sp0) to Cmovesa.Cmoves_Open_Yp0
50062>>>>>//                    Move 0                                                   to Cmovesa.Cmoves_Open_Yx0
50062>>>>>//                Case Break
50062>>>>>
50062>>>>>//                Case (Cmovesa.Cmoves_P0 > 0) //˜«æ­ ¦ § ©«à« ¡æ record
50062>>>>>//                    Move "-"                                              to Cmovesa.Cmoves_Topen
50062>>>>>//                    Move (Cmovesa.Cmoves_P0 - Cmovesa.Cmoves_Open_Sp0)    to Cmovesa.Cmoves_Open_Yp0
50062>>>>>//                    Move 0                                                to Cmovesa.Cmoves_Open_Yx0
50062>>>>>//                Case Break
50062>>>>>
50062>>>>>//                Case (Cmovesa.Cmoves_P0 < 0) //¯œç«¦- § ©«à« ¡æ record
50062>>>>>//                    Move "+"                                                 to Cmovesa.Cmoves_Topen
50062>>>>>//                    Move ((Abs(Cmovesa.Cmoves_P0))-Cmovesa.Cmoves_Open_Sx0)  to Cmovesa.Cmoves_Open_Yx0
50062>>>>>//                    Move 0                                                   to Cmovesa.Cmoves_Open_Yp0
50062>>>>>//                Case Break
50062>>>>>//        Case End
50062>>>>>//    End_Procedure //do_compute_open_itemsa
50062>>>>>
50062>>>>>
50062>>>>>      //œ¢âš®œ  «˜ 13 §œ›å˜ open item
50062>>>>>      //¡˜¢œå«˜  ˜§æ validate save
50062>>>>>      Function  fi_Validate_Open_Itemsa Returns Integer
50063>>>>>
50063>>>>>                 //1101+1102+1103+1104:â¢œš®¦  £ã ˜¨¤ž« ¡é¤ ¬§¦¢¦å§à¤ §¨¦ª ©¬©®â« ©ž ¡˜  ©¬©®œ« ©Ÿâ¤«à¤ §¦©é¤
50063>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yx0 >= 0                       )) Function_Return 1101
50066>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yp0 >= 0                       )) Function_Return 1102
50069>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sx0 >= 0                       )) Function_Return 1103
50072>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sp0 >= 0                       )) Function_Return 1104
50075>>>>>
50075>>>>>                 Case Begin
50075>>>>>                      //1105+1106+1107+1108:â¢œš®¦  š ˜ ˜«æ­ ¦ ®¨œà©« ¡æ record
50075>>>>>                      Case (Cmovesa.Cmoves_X0 > 0)
50077>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yx0 <=      Cmovesa.Cmoves_X0  )) Function_Return 1105
50080>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sx0 <=      Cmovesa.Cmoves_X0  )) Function_Return 1106
50083>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yp0  = 0                       )) Function_Return 1107
50086>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sp0  = 0                       )) Function_Return 1108
50089>>>>>                      Case Break
50090>>>>>                      //1109+1110+1111+1112:â¢œš®¦  š ˜ ¯œ¬«¦- ®¨œà©« ¡æ record
50090>>>>>                      Case (Cmovesa.Cmoves_X0 < 0)
50093>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yx0  = 0                       )) Function_Return 1109
50096>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sx0  = 0                       )) Function_Return 1110
50099>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yp0 <= (Abs(Cmovesa.Cmoves_X0)))) Function_Return 1111
50102>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sp0 <= (Abs(Cmovesa.Cmoves_X0)))) Function_Return 1112
50105>>>>>                      Case Break
50106>>>>>                      //1113+1114+1115+1116:â¢œš®¦  š ˜ ˜«æ­ ¦ § ©«à« ¡æ record
50106>>>>>                      Case (Cmovesa.Cmoves_P0 > 0)
50109>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yx0  = 0                       )) Function_Return 1113
50112>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sx0  = 0                       )) Function_Return 1114
50115>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yp0 <=      Cmovesa.Cmoves_P0  )) Function_Return 1115
50118>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sp0 <=      Cmovesa.Cmoves_P0  )) Function_Return 1116
50121>>>>>                      Case Break
50122>>>>>                      //1117+1118+1119+1120:â¢œš®¦  š ˜ ¯œç«¦- ®¨œà©« ¡æ record
50122>>>>>                      Case (Cmovesa.Cmoves_P0 < 0)
50125>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yx0 <= (Abs(Cmovesa.Cmoves_P0)))) Function_Return 1117
50128>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sx0 <= (Abs(Cmovesa.Cmoves_P0)))) Function_Return 1118
50131>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yp0  = 0                       )) Function_Return 1119
50134>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sp0  = 0                       )) Function_Return 1120
50137>>>>>                      Case Break
50138>>>>>                 Case End
50138>>>>>
50138>>>>>                 Function_Return 0 //æ¢˜ ok
50139>>>>>      End_Function //fi_validate_open_itemsa
50140>>>>>
50140>>>>>
50140>>>>>    Procedure Update 
50141>>>>>        
50141>>>>>        Forward Send Update
50143>>>>>                        
50143>>>>>        If (Cmovesa.Cmoves_M_Code='') Move Cmovesa.Module_From to Cmovesa.Cmoves_M_Code
50146>>>>>//        Send Do_Compute_Open_Itemsa
50146>>>>>
50146>>>>>        If (Ctypkin.Open_Item='1') Move (CmovesA.Axia_Pros_Sysx-CmovesA.Axia_Sysxet) to CmovesA.Axia_Ypol_Sysx
50149>>>>>        Else Begin
50150>>>>>            Move 0 to CmovesA.Axia_Pros_Sysx
50151>>>>>            Move 0 to CmovesA.Axia_Sysxet 
50152>>>>>            Move 0 to CmovesA.Axia_Ypol_Sysx
50153>>>>>        End
50153>>>>>>
50153>>>>>
50153>>>>>        // js 23/01/2002
50153>>>>>        // Enhmerosh Pediou Flag_Ypol to opoio antiprosopeyei
50153>>>>>        // to an h eggrafh exei diathesimo ypoloipo pros sysxetish
50153>>>>>        Move (CmovesA.Axia_Ypol_Sysx<>0) to CmovesA.Flag_Ypol
50154>>>>>
50154>>>>>        // js 23/01/2002
50154>>>>>        // Enhmerosh Pediou Flag_Open to opoio antiprosopeyei
50154>>>>>        // an einai xreosh=1, pistosh=2, arnhtikh xreosh=2 arnhtikh Pistosh=1
50154>>>>>        // gia na emfanizei ta antistrofa sto copen
50154>>>>>        If (Ctypkin.Open_Item='1') Begin
50156>>>>>            If ((CmovesA.Cmoves_X0<>0) And ((CmovesA.Cmoves_P0=0))) Begin
50158>>>>>                Move 1                          to CmovesA.Flag_Copen
50159>>>>>                If (CmovesA.Cmoves_X0<0) Move 2 to CmovesA.Flag_Copen
50162>>>>>            End
50162>>>>>>
50162>>>>>            Else If ((CmovesA.Cmoves_P0<>0) And ((CmovesA.Cmoves_X0=0))) Begin
50165>>>>>                Move 2                          to CmovesA.Flag_Copen
50166>>>>>                If (CmovesA.Cmoves_P0<0) Move 1 to CmovesA.Flag_Copen
50169>>>>>            End
50169>>>>>>
50169>>>>>            Else Move 0 to CmovesA.Flag_Copen
50171>>>>>        End 
50171>>>>>>
50171>>>>>        Else Move 0 to CmovesA.Flag_Copen
50173>>>>>    End_Procedure //update
50174>>>>>
50174>>>>>
50174>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
50175>>>>>        String lsError_Message
50176>>>>>        Case Begin
50176>>>>>            //˜§æ validate save
50176>>>>>            Case (iError_Num = 88888)
50178>>>>>                Clear Codemast
50179>>>>>                Move "MODULE" to Codemast.Type
50180>>>>>                Move Cmovesa.Module_From to Codemast.Code
50181>>>>>                Find Eq Codemast by Index.1 //type+code
50182>>>>>>
50182>>>>>                Move ("DDC 006:A›ç¤˜«ž ž œšš¨˜­ž!\n\n(† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
50183>>>>>            Case Break
50184>>>>>
50184>>>>>            Case (iError_Num = 88850)
50187>>>>>                Move "DDC 006:A›ç¤˜«ž ž œšš¨˜­ž!\n\n’¦ ¡ç¡¢à£˜ (Module) «žª œšš¨˜­ãª œå˜¤  ¡œ¤æ" to lsError_Message
50188>>>>>            Case Break
50189>>>>>
50189>>>>>            Case (iError_Num = 88884)
50192>>>>>                Move "DDC 006:A›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ «˜ A¥ æš¨˜­˜" to lsError_Message
50193>>>>>            Case Break
50194>>>>>            Case (iError_Num = 88883)
50197>>>>>                Move "DDC 006:A›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ « ª à¢ã©œ ª" to lsError_Message
50198>>>>>            Case Break
50199>>>>>            Case (iError_Num = 88882)
50202>>>>>                Move "DDC 006:A›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ « ª Aš¦¨âª" to lsError_Message
50203>>>>>            Case Break
50204>>>>>
50204>>>>>            //˜§æ validate delete
50204>>>>>            Case (iError_Num = 88889)
50207>>>>>                Clear Codemast
50208>>>>>                Move "MODULE" to Codemast.Type
50209>>>>>                Move Cmovesa.Module_From to Codemast.Code
50210>>>>>                Find Eq Codemast by Index.1 //type+code
50211>>>>>>
50211>>>>>                Move ("DDC 006:A›ç¤˜«ž ž › ˜š¨˜­ã!\n\n(† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
50212>>>>>            Case Break
50213>>>>>
50213>>>>>            Case (iError_Num = 88887)
50216>>>>>                Move "DDC 006:A›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ «˜ A¥ æš¨˜­˜" to lsError_Message
50217>>>>>            Case Break
50218>>>>>            Case (iError_Num = 88886)
50221>>>>>                Move "DDC 006:A›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ « ª à¢ã©œ ª" to lsError_Message
50222>>>>>            Case Break
50223>>>>>            Case (iError_Num = 88885)
50226>>>>>                Move "DDC 006:A›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ « ª Aš¦¨âª" to lsError_Message
50227>>>>>            Case Break
50228>>>>>
50228>>>>>            //â¢œš®¦  open items
50228>>>>>            Case (iError_Num = 10101)
50231>>>>>                Move ("DDC 006:A¡˜«á¢¢ž¢ž „šš¨˜­ã.\n\n"+;                "’¦ ©¬©®œ« ©£â¤¦ §¦©æ œå¤˜  £œš˜¢ç«œ¨¦\n˜§¦ «¦ ˜¨® ¡á › ˜Ÿâ© £¦ §¨¦ª ©¬©®â« ©ž");                to lsError_Message
50232>>>>>            Case Break
50233>>>>>
50233>>>>>            Case Else
50233>>>>>                Forward Send Operation_Not_Allowed iError_Num
50235>>>>>        Case End
50235>>>>>
50235>>>>>        Error iError_Num lsError_Message
50236>>>>>>
50236>>>>>    End_Procedure // operation_not_allowed
50237>>>>>
50237>>>>>
50237>>>>>    Function Validate_Save Returns Integer
50238>>>>>         Integer iReturnVal liOpen_Itemsa
50239>>>>>         Forward Get Validate_Save to iReturnVal
50241>>>>>         If (Not(iReturnVal)) Begin
50243>>>>>            If (CmovesA.Axia_Ypol_Sysx<0) Move 10101 to ireturnVal
50246>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
50249>>>>>         End //«â¢¦ª ¡é› ¡˜ validation
50249>>>>>>
50249>>>>>         Function_Return iReturnVal
50250>>>>>    End_Function //validate_save
50251>>>>>
50251>>>>>
50251>>>>>    Function Validate_Delete  Returns Integer
50252>>>>>             Send Operation_Not_Allowed 2001 //¢áŸ¦ª «¦¬ ¡é› ¡˜ !!!
50253>>>>>    End_Function //validate_delete
50254>>>>>
50254>>>>>
50254>>>>>
50254>>>>>    // Define_Fields:
50254>>>>>    // This procedure is used to set up all data-dictionary rules.
50254>>>>>
50254>>>>>    Procedure Define_Fields
50255>>>>>        Forward Send Define_Fields
50257>>>>>        //DDB-Generated-Code-Location
50257>>>>>        //DDB-DefineFieldStart
50257>>>>>
50257>>>>>        Set Main_File            To Cmovesa.File_Number
50258>>>>>        Set Cascade_Delete_State To FALSE
50259>>>>>
50259>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
50260>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
50261>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
50262>>>>>
50262>>>>>        // Child (Client) file structure................
50262>>>>>        Send Add_Client_File  Copen.File_Number
50263>>>>>
50263>>>>>        // Field-based properties.......................
50263>>>>>
50263>>>>>        // Cmovesa.Company_Code
50263>>>>>
50263>>>>>        // Cmovesa.Branch_Code
50263>>>>>
50263>>>>>        // Cmovesa.Year_Year
50263>>>>>
50263>>>>>        // Cmovesa.Custprom_Code
50263>>>>>
50263>>>>>        // Cmovesa.Client_Id
50263>>>>>
50263>>>>>        // Cmovesa.Ctypkin_Code
50263>>>>>
50263>>>>>        // Cmovesa.Cmoves_Recr
50263>>>>>        Set Field_Prompt_Object    Field Cmovesa.Cmoves_Recr To (sl006a1(Self))
50264>>>>>
50264>>>>>        // Cmovesa.Cmoves_Rec0
50264>>>>>
50264>>>>>        // Cmovesa.Cmoves_Hmnia
50264>>>>>        Set Field_Prompt_Object    Field Cmovesa.Cmoves_Hmnia To (sl006a1(Self))
50265>>>>>
50265>>>>>        // Cmovesa.Ctypkin_Recr
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_Par
50265>>>>>
50265>>>>>        // Cmovesa.Partl_Recr
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_Axia
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_X0
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_P0
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_X00
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_P00
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_X1
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_P1
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_X2
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_P2
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_Dlixis
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_A_Code
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_Status_E
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_Status_A
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_S0
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_Ys0
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_S1
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_Ys1
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_S2
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_Ys2
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_Sc_Code2
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_Open
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_Aopen
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_M_Code
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_Yn_Myf
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_Myf_Axia
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_Kk
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_C_Code2
50265>>>>>
50265>>>>>        // Cmovesa.Cn_Code
50265>>>>>
50265>>>>>        // Cmovesa.Client_Recr
50265>>>>>
50265>>>>>        // Cmovesa.Barticl_Recr
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_Qty
50265>>>>>
50265>>>>>        // Cmovesa.Cmove_Totambd0
50265>>>>>
50265>>>>>        // Cmovesa.Cmove_Discam0
50265>>>>>
50265>>>>>        // Cmovesa.Cmove_Totamad0
50265>>>>>
50265>>>>>        // Cmovesa.Cmove_Vatam0
50265>>>>>
50265>>>>>        // Cmovesa.Cmove_Extra0
50265>>>>>
50265>>>>>        // Cmovesa.Cmove_Totambd00
50265>>>>>
50265>>>>>        // Cmovesa.Cmove_Discam00
50265>>>>>
50265>>>>>        // Cmovesa.Cmove_Totamad00
50265>>>>>
50265>>>>>        // Cmovesa.Cmove_Vatam00
50265>>>>>
50265>>>>>        // Cmovesa.Cmove_Extra00
50265>>>>>
50265>>>>>        // Cmovesa.Cmove_Totambd1
50265>>>>>
50265>>>>>        // Cmovesa.Cmove_Discam1
50265>>>>>
50265>>>>>        // Cmovesa.Cmove_Totamad1
50265>>>>>
50265>>>>>        // Cmovesa.Cmove_Vatam1
50265>>>>>
50265>>>>>        // Cmovesa.Cmove_Extra1
50265>>>>>
50265>>>>>        // Cmovesa.Module_From
50265>>>>>
50265>>>>>        // Cmovesa.Parast_Abrev
50265>>>>>
50265>>>>>        // Cmovesa.Enhm_Ypol_Pel
50265>>>>>
50265>>>>>        // Cmovesa.Enhm_Hmnies_Pel
50265>>>>>
50265>>>>>        // Cmovesa.Sls_Id
50265>>>>>
50265>>>>>        // Cmovesa.Presp_Id
50265>>>>>
50265>>>>>        // Cmovesa.Cnt_Id
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_Open_Sx0
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_Open_Sp0
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_Open_Yx0
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_Open_Yp0
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_Open_Sx1
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_Open_Sp1
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_Open_Sx2
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_Open_Sp2
50265>>>>>
50265>>>>>        // Cmovesa.Cmoves_Topen
50265>>>>>
50265>>>>>        // Cmovesa.Cn_Recr
50265>>>>>
50265>>>>>        // Cmovesa.Axia_Pros_Sysx
50265>>>>>
50265>>>>>        // Cmovesa.Axia_Sysxet
50265>>>>>
50265>>>>>        // Cmovesa.Axia_Ypol_Sysx
50265>>>>>
50265>>>>>        // Cmovesa.Axia_Pros_Sys00
50265>>>>>
50265>>>>>        // Cmovesa.Axia_Sysxet00
50265>>>>>
50265>>>>>        // Cmovesa.Axia_Ypol_Sys00
50265>>>>>
50265>>>>>        // Cmovesa.Axia_Pros_Sysr
50265>>>>>
50265>>>>>        // Cmovesa.Axia_Sysxetr
50265>>>>>
50265>>>>>        // Cmovesa.Axia_Ypol_Sysr
50265>>>>>
50265>>>>>        // Cmovesa.Mhxanik_Id
50265>>>>>
50265>>>>>        // Cmovesa.Prn_Theor
50265>>>>>
50265>>>>>        // Cmovesa.Is_Closed
50265>>>>>
50265>>>>>        // Cmovesa.Flag_Copen
50265>>>>>
50265>>>>>        // Cmovesa.Flag_Ypol
50265>>>>>
50265>>>>>        // Cmovesa.Ctypkin_Descr
50265>>>>>
50265>>>>>        // Cmovesa.Client_Name
50265>>>>>
50265>>>>>        // Cmovesa.Enhm_Ofeilh
50265>>>>>
50265>>>>>        //DDB-DefineFieldEnd
50265>>>>>    End_Procedure    // Define_Fields
50266>>>>>
50266>>>>>    // Field_Defaults:
50266>>>>>    // This procedure is used to establish default field values.
50266>>>>>
50266>>>>>    Procedure Field_Defaults
50267>>>>>        Forward Send Field_Defaults
50269>>>>>        //DDB-Generated-Code-Location
50269>>>>>        //DDB-FieldDefaultStart
50269>>>>>        //DDB-FieldDefaultEnd
50269>>>>>    End_Procedure    // Field_Defaults
50270>>>>>
50270>>>>>End_Class    // Cmovesa_DataDictionary
50271>>>>>//DDB-Selection-pkg-Start
50271>>>>>
50271>>>>>Use sl006a1.SL       // sl006a1
INCLUDING FILE: SL006A1.SL
50271>>>>>>>//AB/ Project sl006a1
50271>>>>>>>//AB/ Object prj is a Lookup_Project
50271>>>>>>>//AB/     Set ProjectName to "sl006a1"
50271>>>>>>>//AB/     Set ProjectFileName to "sl006a1.SL"
50271>>>>>>>//AB/     Set GenerateFileName to "NONAME"
50271>>>>>>>
50271>>>>>>>// Project Object Structure
50271>>>>>>>//   sl006a1 is a dbModalPanelSub
50271>>>>>>>//     Cmovesa_DD is a DataDictionary
50271>>>>>>>//     oSelList is a dbListSub
50271>>>>>>>//     oOK_bn is a ButtonSub
50271>>>>>>>//     oCancel_bn is a ButtonSub
50271>>>>>>>//     oSearch_bn is a ButtonSub
50271>>>>>>>//     Cmoves_Axia_Ypol_Sysx is a dbFormSub
50271>>>>>>>//     TextBoxSub1 is a TextBoxSub
50271>>>>>>>//     Cmoves_Axia_Sysxet is a dbFormSub
50271>>>>>>>//     TextBoxSub2 is a TextBoxSub
50271>>>>>>>//     Cmoves_Axia_Pros_Sysx is a dbFormSub
50271>>>>>>>//     TextBoxSub3 is a TextBoxSub
50271>>>>>>>
50271>>>>>>>// Register all objects
50271>>>>>>>Register_Object Cmoves_Axia_Pros_Sysx
50271>>>>>>>Register_Object Cmoves_Axia_Sysxet
50271>>>>>>>Register_Object Cmoves_Axia_Ypol_Sysx
50271>>>>>>>Register_Object Cmovesa_DD
50271>>>>>>>Register_Object oCancel_bn
50271>>>>>>>Register_Object oOK_bn
50271>>>>>>>Register_Object oSearch_bn
50271>>>>>>>Register_Object oSelList
50271>>>>>>>Register_Object sl006a1
50271>>>>>>>Register_Object TextBoxSub1
50271>>>>>>>Register_Object TextBoxSub2
50271>>>>>>>Register_Object TextBoxSub3
50271>>>>>>>
50271>>>>>>>
50271>>>>>>>//AB-IgnoreStart
50271>>>>>>>
50271>>>>>>>Use DFAllEnt.pkg
50271>>>>>>>Use dbList.Sub
50271>>>>>>>Use Button.Sub
50271>>>>>>>Use dbForm.Sub
50271>>>>>>>Use Txtbox.Sub
50271>>>>>>>
50271>>>>>>>
50271>>>>>>>Use CMOVESA.DD
50271>>>>>>>
50271>>>>>>>//AB-IgnoreEnd
50271>>>>>>>
50271>>>>>>>CD_Popup_Object sl006a1 is a dbModalPanelSub
50290>>>>>>>
50290>>>>>>>    //AB-StoreTopStart
50290>>>>>>>                                                        
50290>>>>>>>    Property String     FragmaClientID  Public ''
50292>>>>>>>    Property Integer    piXr_Or_Pi      Public  0
50294>>>>>>>    Property String     psModule        Public ''
50296>>>>>>>    Property Date       pdApo           public ''
50298>>>>>>>    Property Date       pdEos           public ''
50300>>>>>>>    Property Integer    piWhat          public  0
50302>>>>>>>    
50302>>>>>>>    
50302>>>>>>>    //AB-StoreTopEnd
50302>>>>>>>
50302>>>>>>>    Set Label to "‰ ¤ã©œ ª"
50303>>>>>>>    Set Size to 231 495
50304>>>>>>>    Set Location to 4 6
50305>>>>>>>    Set Exit_Application_Local_State to FALSE
50306>>>>>>>    Set Modal_State to FALSE
50307>>>>>>>
50307>>>>>>>    //AB-DDOStart
50307>>>>>>>
50307>>>>>>>    Object Cmovesa_DD is a Cmovesa_DataDictionary
50309>>>>>>>
50309>>>>>>>        //AB-StoreStart
50309>>>>>>>                    
50309>>>>>>>        Begin_Constraints
50311>>>>>>>            Constrain Cmovesa.Company_Code  Eq SyscurXr.Company_Code
50313>>>>>>>            Constrain Cmovesa.Year_Year     Eq SyscurXr.Year_Year
50315>>>>>>>            Constrain Cmovesa.Flag_Ypol     Eq 1
50317>>>>>>>            Constrain CmovesA.Client_ID     Eq (FragmaClientID(Self))
50319>>>>>>>            Constrain CmovesA.Module_From   Eq (psModule(Self))
50321>>>>>>>                 If (piXr_or_Pi(Self)=1)    Constrain Cmovesa.Flag_Copen Eq 2
50325>>>>>>>            Else If (piXr_or_Pi(Self)=2)    Constrain Cmovesa.Flag_Copen Eq 1
50330>>>>>>>            If (pdApo(Self)<>'')            Constrain Cmoves.Cmoves_Hmnia   Ge (pdApo(Self))
50334>>>>>>>            If (pdEos(Self)<>'')            Constrain Cmoves.Cmoves_Hmnia   Le (pdEos(Self))
50338>>>>>>>        End_Constraints
50341>>>>>>>        
50341>>>>>>>        
50341>>>>>>>        
50341>>>>>>>        
50341>>>>>>>        
50341>>>>>>>        
50341>>>>>>>        
50341>>>>>>>        
50341>>>>>>>        
50341>>>>>>>        
50341>>>>>>>        //AB-StoreEnd
50341>>>>>>>
50341>>>>>>>    End_Object    // Cmovesa_DD
50342>>>>>>>
50342>>>>>>>    Set Main_DD to (Cmovesa_DD(self))
50343>>>>>>>    Set Server to (Cmovesa_DD(self))
50344>>>>>>>
50344>>>>>>>    //AB-DDOEnd
50344>>>>>>>
50344>>>>>>>    Object oSelList is a dbListSub
50346>>>>>>>
50346>>>>>>>        //AB-StoreTopStart
50346>>>>>>>                                                                                                                                                        
50346>>>>>>>                                                                                                                                                        
50346>>>>>>>        //AB-StoreTopEnd
50346>>>>>>>
50346>>>>>>>        Set Main_File to Cmovesa.File_Number
50347>>>>>>>        Set Size to 191 478
50348>>>>>>>        Set Location to 6 6
50349>>>>>>>
50349>>>>>>>        Begin_Row
50352>>>>>>>            Entry_Item Cmovesa.Cmoves_hmnia
50353>>>>>>>            Entry_Item Cmovesa.Cmoves_par
50354>>>>>>>            Entry_Item Cmovesa.Ctypkin_descr
50355>>>>>>>            Entry_Item Cmovesa.Client_name
50356>>>>>>>            Entry_Item Cmovesa.Cmoves_axia
50357>>>>>>>            Entry_Item Cmovesa.Branch_code
50358>>>>>>>        End_Row
50363>>>>>>>
50363>>>>>>>        Set Form_Width    item 0 to 57
50364>>>>>>>        Set Header_Label  item 0 to "†£/¤å˜"
50365>>>>>>>        
50365>>>>>>>        Set Form_Width    item 1 to 102
50366>>>>>>>        Set Header_Label  item 1 to "€ « ¦¢¦šå˜"
50367>>>>>>>        
50367>>>>>>>        Set Form_Width    item 2 to 98
50368>>>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
50369>>>>>>>        
50369>>>>>>>        Set Form_Width    item 3 to 111
50370>>>>>>>        Set Header_Label  item 3 to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
50371>>>>>>>        
50371>>>>>>>        Set Form_Width    item 4 to 64
50372>>>>>>>        Set Header_Label  item 4 to " €¥å˜"
50373>>>>>>>        
50373>>>>>>>        Set Form_Width    item 5 to 40
50374>>>>>>>        Set Header_Label  item 5 to "“§¦¡/£˜"
50375>>>>>>>        
50375>>>>>>>
50375>>>>>>>        //AB-StoreStart
50375>>>>>>>                                                                                                                                                        
50375>>>>>>>        Property String StoreFragmaClientID Public ''
50377>>>>>>>        Property String StorepsModule       Public ''
50379>>>>>>>        //
50379>>>>>>>        Procedure Store_Defaults
50381>>>>>>>               Forward Send Store_Defaults
50383>>>>>>>               Set StoreFragmaClientID  to (FragmaClientID  (Self))
50384>>>>>>>               Set StorepsModule        to (psModule        (Self))
50385>>>>>>>        End_Procedure
50386>>>>>>>        //
50386>>>>>>>        Procedure ReStore_Defaults
50388>>>>>>>               Forward Send ReStore_Defaults
50390>>>>>>>               Set FragmaClientID   to (StoreFragmaClientID (Self))
50391>>>>>>>               Set psModule         to (StorepsModule       (Self))
50392>>>>>>>        End_Procedure
50393>>>>>>>        //
50393>>>>>>>        Procedure Activating
50395>>>>>>>           Forward Send Activating
50397>>>>>>>           Send Rebuild_Constraints to (Cmovesa_DD(Self))
50398>>>>>>>        End_Procedure
50399>>>>>>>        //
50399>>>>>>>        Procedure Activate
50401>>>>>>>            Forward Send Activate
50403>>>>>>>            Send Beginning_Of_Data          to oSelList True
50404>>>>>>>        End_procedure
50405>>>>>>>        
50405>>>>>>>        Procedure End_Construct_Object
50407>>>>>>>            String  sNom
50408>>>>>>>            Integer iDecs
50408>>>>>>>            Forward Send End_Construct_Object
50410>>>>>>>            Move SysCurxr.C_Code0 to sNom
50411>>>>>>>            Clear Nomisma
50412>>>>>>>            Move sNom to Nomisma.Nomisma_Code
50413>>>>>>>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
50414>>>>>>>>
50414>>>>>>>            If (Found=1)    Move Nomisma.Dekadika to iDecs
50417>>>>>>>            Else            Move 0 to iDecs
50419>>>>>>>        
50419>>>>>>>            // Ž¨ ¦¬£œ §àª ˜¤ «¦ ™˜© ¡æ ¤¦£ ©£˜ ®¨ã©žª ƒ„Œ œ®œ  ›œ¡˜› ¡á
50419>>>>>>>            // «æ«œ œ¥' ¦¨ ©£¦ç ™á¦¬£œ œ£œ ª 2
50419>>>>>>>            If (iDecs=0) Move 2 to iDecs
50422>>>>>>>            //
50422>>>>>>>        
50422>>>>>>>            Set Points          Item 4 to       iDecs
50423>>>>>>>            Set Numeric_Mask    Item 4 to 14    iDecs ' ,*'
50424>>>>>>>        End_Procedure
50425>>>>>>>        
50425>>>>>>>        
50425>>>>>>>        
50425>>>>>>>        
50425>>>>>>>        
50425>>>>>>>        
50425>>>>>>>        
50425>>>>>>>        
50425>>>>>>>        
50425>>>>>>>        
50425>>>>>>>        
50425>>>>>>>        
50425>>>>>>>        
50425>>>>>>>        //AB-StoreEnd
50425>>>>>>>
50425>>>>>>>    End_Object    // oSelList
50426>>>>>>>
50426>>>>>>>    Object oOK_bn is a ButtonSub
50428>>>>>>>        Set Label to "&„§ ¢¦šã"
50429>>>>>>>        Set Location to 199 325
50430>>>>>>>
50430>>>>>>>        //AB-StoreStart
50430>>>>>>>        Procedure OnClick
50432>>>>>>>            Send OK To (oSelList(current_object))
50433>>>>>>>        End_Procedure
50434>>>>>>>        //AB-StoreEnd
50434>>>>>>>
50434>>>>>>>    End_Object    // oOK_bn
50435>>>>>>>
50435>>>>>>>    Object oCancel_bn is a ButtonSub
50437>>>>>>>        Set Label to "&€¡ç¨à©ž"
50438>>>>>>>        Set Location to 199 379
50439>>>>>>>
50439>>>>>>>        //AB-StoreStart
50439>>>>>>>        Procedure OnClick
50441>>>>>>>            Send Cancel To (oSelList(current_object))
50442>>>>>>>        End_Procedure
50443>>>>>>>        //AB-StoreEnd
50443>>>>>>>
50443>>>>>>>    End_Object    // oCancel_bn
50444>>>>>>>
50444>>>>>>>    Object oSearch_bn is a ButtonSub
50446>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
50447>>>>>>>        Set Location to 199 435
50448>>>>>>>
50448>>>>>>>        //AB-StoreStart
50448>>>>>>>        Procedure OnClick
50450>>>>>>>            Send Search To (oSelList(current_object))
50451>>>>>>>        End_Procedure
50452>>>>>>>        //AB-StoreEnd
50452>>>>>>>
50452>>>>>>>    End_Object    // oSearch_bn
50453>>>>>>>
50453>>>>>>>    Object Cmoves_Axia_Ypol_Sysx is a dbFormSub
50455>>>>>>>        Entry_Item Cmovesa.Axia_ypol_sysx
50456>>>>>>>        Set Size to 13 54
50457>>>>>>>        Set Location to 199 249
50458>>>>>>>        Set Color to clBtnFace
50459>>>>>>>        Set Label_Col_Offset to 2
50460>>>>>>>        Set Label_Justification_Mode to jMode_Right
50461>>>>>>>        Set Enabled_State to FALSE
50462>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
50463>>>>>>>        Set Shadow_State Item 0 to TRUE
50464>>>>>>>
50464>>>>>>>        //AB-StoreStart
50464>>>>>>>                                                                                                
50464>>>>>>>        Set points item 0 to 2
50465>>>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
50466>>>>>>>        
50466>>>>>>>        //AB-StoreEnd
50466>>>>>>>
50466>>>>>>>    End_Object    // Cmoves_Axia_Ypol_Sysx
50467>>>>>>>
50467>>>>>>>    Object TextBoxSub1 is a TextBoxSub
50469>>>>>>>        Set Label to "ƒ ˜Ÿâ© £ž"
50470>>>>>>>        Set Location to 201 211
50471>>>>>>>        Set Size to 10 35
50472>>>>>>>    End_Object    // TextBoxSub1
50473>>>>>>>
50473>>>>>>>    Object Cmoves_Axia_Sysxet is a dbFormSub
50475>>>>>>>        Entry_Item Cmovesa.Axia_sysxet
50476>>>>>>>        Set Size to 13 54
50477>>>>>>>        Set Location to 199 141
50478>>>>>>>        Set Color to clBtnFace
50479>>>>>>>        Set Label_Col_Offset to 2
50480>>>>>>>        Set Label_Justification_Mode to jMode_Right
50481>>>>>>>        Set Enabled_State to FALSE
50482>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
50483>>>>>>>        Set Shadow_State Item 0 to TRUE
50484>>>>>>>
50484>>>>>>>        //AB-StoreStart
50484>>>>>>>        Set points item 0 to 2
50485>>>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
50486>>>>>>>        
50486>>>>>>>        //AB-StoreEnd
50486>>>>>>>
50486>>>>>>>    End_Object    // Cmoves_Axia_Sysxet
50487>>>>>>>
50487>>>>>>>    Object TextBoxSub2 is a TextBoxSub
50489>>>>>>>        Set Label to "‘¬©®œ« ©£â¤ž"
50490>>>>>>>        Set Location to 201 90
50491>>>>>>>        Set Size to 10 49
50492>>>>>>>    End_Object    // TextBoxSub2
50493>>>>>>>
50493>>>>>>>    Object Cmoves_Axia_Pros_Sysx is a dbFormSub
50495>>>>>>>        Entry_Item Cmovesa.Axia_pros_sysx
50496>>>>>>>        Set Size to 13 54
50497>>>>>>>        Set Location to 199 25
50498>>>>>>>        Set Color to clBtnFace
50499>>>>>>>        Set Label_Col_Offset to 2
50500>>>>>>>        Set Label_Justification_Mode to jMode_Right
50501>>>>>>>        Set Enabled_State to FALSE
50502>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
50503>>>>>>>        Set Shadow_State Item 0 to TRUE
50504>>>>>>>
50504>>>>>>>        //AB-StoreStart
50504>>>>>>>        Set points item 0 to 2
50505>>>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
50506>>>>>>>        
50506>>>>>>>        //AB-StoreEnd
50506>>>>>>>
50506>>>>>>>    End_Object    // Cmoves_Axia_Pros_Sysx
50507>>>>>>>
50507>>>>>>>    Object TextBoxSub3 is a TextBoxSub
50509>>>>>>>        Set Label to "€¥å˜"
50510>>>>>>>        Set Location to 201 6
50511>>>>>>>        Set Size to 10 15
50512>>>>>>>    End_Object    // TextBoxSub3
50513>>>>>>>
50513>>>>>>>
50513>>>>>>>    //AB-StoreStart
50513>>>>>>>                                                        
50513>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
50514>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
50515>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
50516>>>>>>>    
50516>>>>>>>    
50516>>>>>>>    
50516>>>>>>>    
50516>>>>>>>    
50516>>>>>>>    
50516>>>>>>>    
50516>>>>>>>    //AB-StoreEnd
50516>>>>>>>
50516>>>>>>>CD_End_Object    // sl006a1
50518>>>>>>>>
50518>>>>>>>
50518>>>>>>>//AB/ End_Object    // prj
50518>>>>>
50518>>>>>//DDB-Selection-pkg-End
50518>>>>>//DDB-FileEnd
50518>>>    USE SYSCURXR.DD
50518>>>    use docpresp.dg
INCLUDING FILE: DOCPRESP.DG
50518>>>>>
50518>>>>>// Register all objects
50518>>>>>Register_Object syscurxr_DD
50518>>>>>Register_Object Docpresp
50518>>>>>Register_Object payresp_DD
50518>>>>>Register_Object year_DD
50518>>>>>Register_Object rmetafyp.rv
50518>>>>>
50518>>>>>
50518>>>>>
50518>>>>>//AB-IgnoreStart
50518>>>>>
50518>>>>>Use Bproces.Sub
50518>>>>>Use DFAllEnt.pkg
50518>>>>>use syscurxr.dd
50518>>>>>use payresp.dd
50518>>>>>use year.dd
50518>>>>>
50518>>>>>//AB-IgnoreEnd
50518>>>>>
50518>>>>>Object Docpresp is a BusinessProcessSub
50520>>>>>
50520>>>>>    //AB-StoreTopStart
50520>>>>>
50520>>>>>    Property    Integer piError       Public  0
50522>>>>>    property    string  datefrom      public ''
50524>>>>>    property    integer piTxtID       public 0
50526>>>>>    property    integer piLathos      public 0
50528>>>>>    property    string  psclient      public ''
50530>>>>>    property    string  psmodule      public ''
50532>>>>>    property    string  pscode        public ''
50534>>>>>
50534>>>>>    Open SysCurXr
50536>>>>>    //reread syscurxr
50536>>>>>    //unlock
50536>>>>>
50536>>>>>    Set Status_Panel_State to False
50537>>>>>    Set Display_Error_State to True
50538>>>>>
50538>>>>>    //AB-StoreTopEnd
50538>>>>>
50538>>>>>    Set Size to 82 140
50539>>>>>    Set Location to 72 182
50540>>>>>
50540>>>>>    //AB-DDOStart
50540>>>>>
50540>>>>>
50540>>>>>    Object Payresp_DD is a Payresp_DataDictionary
50542>>>>>
50542>>>>>    End_Object    // Payresp_DD
50543>>>>>
50543>>>>>    Object year_DD is a year_DataDictionary
50545>>>>>
50545>>>>>    End_Object    // year_DD
50546>>>>>
50546>>>>>    Object syscurxr_DD is a syscurxr_DataDictionary
50548>>>>>
50548>>>>>    End_Object    // syscurxr
50549>>>>>
50549>>>>>
50549>>>>>    //AB-StoreEnd
50549>>>>>
50549>>>>>
50549>>>>>    //AB-DDOEnd
50549>>>>>
50549>>>>>
50549>>>>>    //AB-StoreStart
50549>>>>>
50549>>>>>    Procedure Start_Processing
50551>>>>>     String  scode smodule spar
50552>>>>>     Number  naxia nx0 np0 nx00 np00 nx1 np1 ndiaf tx0 tp0 tx00 tp00 tx1 tp1 nplafon nofeilh
50552>>>>>     Date    dHmnia
50552>>>>>     string  serr
50552>>>>>     integer iyear icount nyear ctypkinyear
50552>>>>>     Clear payresp
50553>>>>>     move syscurxr.company_code     to payresp.company_code
50554>>>>>     find gt payresp by index.5
50555>>>>>>
50555>>>>>     While ((found=1)and (syscurxr.company_code eq payresp.company_code))
50559>>>>>         add 1 to icount
50560>>>>>         clear year
50561>>>>>         move syscurxr.company_code     to year.company_code
50562>>>>>         move syscurxr.branch_code      to year.branch_code
50563>>>>>         move (syscurxr.year_year+1)    to year.year_year
50564>>>>>         find eq year by index.1
50565>>>>>>
50565>>>>>         if (not(found)) error 3002 'ƒœ¤ â®œ«œ ˜¤¦å¥œ  ¤â˜ ®¨ã©ž ©«¦ ¬§¦¡˜«á©«ž£˜ !!'
50568>>>>>         move payresp.presp_id to scode
50569>>>>>         move year.payresp_plafon to nplafon
50570>>>>>         move year.payresp_ofeilh to nofeilh
50571>>>>>         reread payresp
50575>>>>>         move 0 to payresp.pistosh
50576>>>>>         move 0 to payresp.xreosh
50577>>>>>         move 0 to payresp.ypoloipo
50578>>>>>         move 0 to payresp.overhead
50579>>>>>         // ›œ¤ ¥â¨à ˜¤ §¨â§œ  ¤˜ £ž›œ¤å¦¬¤ «˜ œ§ ©­˜¢ã §¦©á ¡˜  §¦©á ˜§¦ ƒ.€///
50579>>>>>     //    move 0 to payresp.poso_se_apait
50579>>>>>     //    move 0 to payresp.posa_apo_dap
50579>>>>>         move nplafon to payresp.plafon
50580>>>>>         move nofeilh to payresp.orio_syn_ofeilh
50581>>>>>         saverecord payresp
50582>>>>>         unlock
50583>>>>>>
50583>>>>>         Send UpdateWait to (piTxtID(Self))  ('‹ž›œ¤ ©£æª ¬§¦¢.¬§œ¬Ÿ.§¢ž¨à£ãª '+(String(scode)+ ' '+(string(icount))))
50584>>>>>     Find  gt payresp by index.5
50585>>>>>>
50585>>>>>     loop
50586>>>>>>
50586>>>>>
50586>>>>>      if (piTxtID(Self)<>0) Send Deactivate to (piTxtID(Self))
50589>>>>>    End_Procedure
50590>>>>>
50590>>>>>
50590>>>>>    Procedure OnProcess
50592>>>>>        Send Start_Processing
50593>>>>>    End_Procedure
50594>>>>>
50594>>>>>    Procedure Start_Process
50596>>>>>         Set piTxtID                         to (Wait(Self))
50597>>>>>         Set Button_State    of (Wait(Self)) to False
50598>>>>>         Set BarVisibleState of (Wait(Self)) to '' False
50599>>>>>         Send Popup                          to (Wait(Self))
50600>>>>>         Set piLathos                        to 0
50601>>>>>         Forward Send Start_Process
50603>>>>>    End_Procedure
50604>>>>>
50604>>>>>    Procedure OnError integer error_info string errMsg
50606>>>>>       If (piTxtID(Self)<>0) Send Deactivate to (piTxtID(Self))
50609>>>>>    End_Procedure
50610>>>>>
50610>>>>>
50610>>>>>    Procedure End_Process
50612>>>>>       Forward Send End_Process
50614>>>>>       If (piTxtID(Self)<>0) Send Deactivate to (piTxtID(Self))
50617>>>>>    End_Procedure
50618>>>>>
50618>>>>>
50618>>>>>    //AB-StoreEnd
50618>>>>>
50618>>>>>End_Object
50619>>>>>
50619>>>>>//AB/ End_Object    // prj
50619>>>    use docclients.dg
INCLUDING FILE: DOCCLIENTS.DG
50619>>>>>
50619>>>>>// Register all objects
50619>>>>>Register_Object syscurxr_DD
50619>>>>>Register_Object Docclients
50619>>>>>Register_Object clients_DD
50619>>>>>Register_Object year_DD
50619>>>>>Register_Object rmetafyp.rv
50619>>>>>
50619>>>>>
50619>>>>>
50619>>>>>//AB-IgnoreStart
50619>>>>>
50619>>>>>Use Bproces.Sub
50619>>>>>Use DFAllEnt.pkg
50619>>>>>use syscurxr.dd
50619>>>>>use clients.dd
50619>>>>>use year.dd
50619>>>>>
50619>>>>>//AB-IgnoreEnd
50619>>>>>
50619>>>>>Object Docclients is a BusinessProcessSub
50621>>>>>
50621>>>>>    //AB-StoreTopStart
50621>>>>>
50621>>>>>    Property    Integer piError       Public  0
50623>>>>>    property    string  datefrom      public ''
50625>>>>>    property    integer piTxtID       public 0
50627>>>>>    property    integer piLathos      public 0
50629>>>>>    property    string  psclient      public ''
50631>>>>>    property    string  psmodule      public ''
50633>>>>>    property    string  pscode        public ''
50635>>>>>
50635>>>>>    Open SysCurXr
50637>>>>>    //reread syscurxr
50637>>>>>    //unlock
50637>>>>>
50637>>>>>    Set Status_Panel_State to False
50638>>>>>    Set Display_Error_State to True
50639>>>>>
50639>>>>>    //AB-StoreTopEnd
50639>>>>>
50639>>>>>    Set Size to 82 140
50640>>>>>    Set Location to 72 182
50641>>>>>
50641>>>>>    //AB-DDOStart
50641>>>>>
50641>>>>>
50641>>>>>    Object clients_DD is a clients_DataDictionary
50643>>>>>
50643>>>>>    End_Object    // clients_DD
50644>>>>>
50644>>>>>    Object year_DD is a year_DataDictionary
50646>>>>>
50646>>>>>    End_Object    // year_DD
50647>>>>>
50647>>>>>    Object syscurxr_DD is a syscurxr_DataDictionary
50649>>>>>
50649>>>>>    End_Object    // syscurxr
50650>>>>>
50650>>>>>
50650>>>>>    //AB-StoreEnd
50650>>>>>
50650>>>>>
50650>>>>>    //AB-DDOEnd
50650>>>>>
50650>>>>>
50650>>>>>    //AB-StoreStart
50650>>>>>
50650>>>>>    Procedure Start_Processing
50652>>>>>     String  scode smodule spar
50653>>>>>     Number  naxia nx0 np0 nx00 np00 nx1 np1 ndiaf tx0 tp0 tx00 tp00 tx1 tp1 nplafon nofeilh
50653>>>>>     Date    dHmnia
50653>>>>>     string  serr
50653>>>>>     integer iyear icount nyear ctypkinyear
50653>>>>>
50653>>>>>     Get psModule to sModule
50654>>>>>     If (Trim(sModule)='') Error 1001 'ƒœ¤ ¬§á¨®œ  Module'
50657>>>>>
50657>>>>>     Clear clients
50658>>>>>     move syscurxr.company_code     to clients.company_code
50659>>>>>   //  move syscurxr.branch_code      to clients.branch_code
50659>>>>>  //   move 0                         to clients.year_year
50659>>>>>     find gt clients by index.5
50660>>>>>>
50660>>>>>     While ((found) and (syscurxr.company_code eq clients.company_code))
50664>>>>>
50664>>>>>         add 1 to icount
50665>>>>>
50665>>>>>         If (;            ((sModule='01') And (Clients.is_Client      ='1')) Or ;            ((sModule='02') And (Clients.is_Promhtheyths='1')) ;            ) Begin
50667>>>>>
50667>>>>>                clear year
50668>>>>>                move syscurxr.company_code     to year.company_code
50669>>>>>                move syscurxr.branch_code      to year.branch_code
50670>>>>>                move (syscurxr.year_year+1)    to year.year_year
50671>>>>>                find eq year by index.1
50672>>>>>>
50672>>>>>                if (not(found)) error 3002 'ƒœ¤ â®œ«œ ˜¤¦å¥œ  ¤â˜ ®¨ã©ž ©«¦ ¬§¦¡˜«á©«ž£˜ !!'
50675>>>>>                move clients.client_id to scode
50676>>>>>                move year.clients_plafon to nplafon
50677>>>>>                move year.clients_ofeilh to nofeilh
50678>>>>>                reread clients
50682>>>>>                move 0 to clients.pistosh
50683>>>>>                move 0 to clients.xreosh
50684>>>>>                move 0 to clients.ypoloipo
50685>>>>>                move 0 to clients.overhead
50686>>>>>                // ›œ¤ ¥â¨à ˜¤ §¨â§œ  ¤˜ £ž›œ¤å¦¬¤ «˜ œ§ ©­˜¢ã §¦©á ¡˜  §¦©á ˜§¦ ƒ.€///
50686>>>>>            //    move 0 to clients.poso_se_apait
50686>>>>>            //    move 0 to clients.posa_apo_dap
50686>>>>>
50686>>>>>                if (clients.is_client = '1') begin
50688>>>>>                    move nplafon to clients.plafon
50689>>>>>                    move nofeilh to clients.orio_syn_ofeilh
50690>>>>>                end
50690>>>>>>
50690>>>>>                saverecord clients
50691>>>>>                unlock
50692>>>>>>
50692>>>>>                Send UpdateWait to (piTxtID(Self))  ('‹ž›œ¤ ©£æª ¬§¦¢.”¦¨â˜ '+(String(scode)+ ' '+(string(icount))))
50693>>>>>
50693>>>>>         End
50693>>>>>>
50693>>>>>        Find  gt clients by index.5
50694>>>>>>
50694>>>>>     loop
50695>>>>>>
50695>>>>>
50695>>>>>      if (piTxtID(Self)<>0) Send Deactivate to (piTxtID(Self))
50698>>>>>    End_Procedure
50699>>>>>
50699>>>>>
50699>>>>>    Procedure OnProcess
50701>>>>>        Send Start_Processing
50702>>>>>    End_Procedure
50703>>>>>
50703>>>>>    Procedure Start_Process
50705>>>>>         Set piTxtID                         to (Wait(Self))
50706>>>>>         Set Button_State    of (Wait(Self)) to False
50707>>>>>         Set BarVisibleState of (Wait(Self)) to '' False
50708>>>>>         Send Popup                          to (Wait(Self))
50709>>>>>         Set piLathos                        to 0
50710>>>>>         Forward Send Start_Process
50712>>>>>    End_Procedure
50713>>>>>
50713>>>>>    Procedure OnError integer error_info string errMsg
50715>>>>>       If (piTxtID(Self)<>0) Send Deactivate to (piTxtID(Self))
50718>>>>>    End_Procedure
50719>>>>>
50719>>>>>
50719>>>>>    Procedure End_Process
50721>>>>>       Forward Send End_Process
50723>>>>>       If (piTxtID(Self)<>0) Send Deactivate to (piTxtID(Self))
50726>>>>>    End_Procedure
50727>>>>>
50727>>>>>
50727>>>>>    //AB-StoreEnd
50727>>>>>
50727>>>>>End_Object
50728>>>>>
50728>>>>>//AB/ End_Object    // prj
50728>>>    OPEN CN
50730>>>    //AB-StoreTopEnd
50730>>>
50730>>>    //AB-IgnoreStart
50730>>>
50730>>>    Use Rptvw.Sub
INCLUDING FILE: RPTVW.SUB
50730>>>>>Use DFRptvw.pkg
50730>>>>>Use dbRptvw.pkg
INCLUDING FILE: DBRPTVW.PKG
50730>>>>>>>
50730>>>>>>>Use Windows
50730>>>>>>>Use DfPanel
50730>>>>>>>Use EnClient
50730>>>>>>>Use DFNav_mx
50730>>>>>>>Use dfConfrm
50730>>>>>>>Use dfRptVw
50730>>>>>>>Use DFGSINI
50730>>>>>>>
50730>>>>>>>Class dbReportAppClient_ is a ReportView STARTMAC ECstart
50731>>>>>>>    Import_Class_Protocol Entry_Client
50732>>>>>>>    //  Defeat the activating augmentation for auto-locate
50732>>>>>>>    Procedure Activating Returns Integer
50733>>>>>>>      local integer RVal
50734>>>>>>>      forward get MSG_activating to rVal
50736>>>>>>>      Procedure_Return rVal
50737>>>>>>>    End_Procedure
50738>>>>>>>End_Class // dbReportAppClient_
50739>>>>>>>
50739>>>>>>>Class dbReportAppView_ is a dbReportAppClient_
50740>>>>>>>  import_Class_protocol entry_view_Client
50741>>>>>>>End_Class // dbReportAppView_
50742>>>>>>>
50742>>>>>>>
50742>>>>>>>Class dbReportView is a dbReportAppView_
50743>>>>>>>
50743>>>>>>>     Procedure Construct_Object
50744>>>>>>>      Forward Send Construct_Object No_Image
50746>>>>>>>      Send Define_DFNavigation  // GUI navigate changes
50747>>>>>>>      // dialog views get activated as popup objects.
50747>>>>>>>      set Dso_Detach_Mode to Detach_Always
50748>>>>>>>
50748>>>>>>>      Set Verify_Data_Loss_Msg TO GET_No_Confirmation
50749>>>>>>>      Set Verify_Delete_Msg    TO GET_No_Confirmation
50750>>>>>>>      Set Verify_Save_Msg      TO GET_No_Confirmation
50751>>>>>>>      Set Verify_Exit_Msg      TO GET_No_confirmation
50752>>>>>>>      //
50752>>>>>>>      // This reportview-client will almost always be a modalpanel, therefore minimizing
50752>>>>>>>      // is out of the question...
50752>>>>>>>      Set Minimize_Icon To False
50753>>>>>>>      Set Maximize_Icon To False
50754>>>>>>>   End_Procedure // Construct_Object
50755>>>>>>>
50755>>>>>>>   Procedure Request_Delete
50756>>>>>>>   End_Procedure // request_delete
50757>>>>>>>
50757>>>>>>>   Procedure Request_Save
50758>>>>>>>   End_Procedure // request_save
50759>>>>>>>
50759>>>>>>>   Function Exit_Application_Check Returns Integer
50760>>>>>>>     Function_return 0
50761>>>>>>>   End_Function
50762>>>>>>>
50762>>>>>>>   Import_Class_Protocol DFNavigate_Mixin
50763>>>>>>>
50763>>>>>>>  //  Returns TRUE to indicate that this is a DEO. This is used by
50763>>>>>>>  //  delegation to figure out if you are within a DEO and should therefore
50763>>>>>>>  //  send a DEO message. DEO clients set this true
50763>>>>>>>  Function DEO_Object Returns integer
50764>>>>>>>    Function_Return 1
50765>>>>>>>  End_Function // DEO_Object
50766>>>>>>>
50766>>>>>>>  //
50766>>>>>>>  //  Activate message for views that:
50766>>>>>>>  //  1. restores the view if it is minimized
50766>>>>>>>  //  2. Maintains the current scope's focus.
50766>>>>>>>  //
50766>>>>>>>  Procedure Activate_current_scope
50767>>>>>>>    If ( View_mode(Current_Object)=VIEWMODE_ICONIZE ) ;       Set view_mode to viewmode_normal
50770>>>>>>>    Set Current_Scope to Current_Object
50771>>>>>>>  End_Procedure // Activate_current_scope
50772>>>>>>>
50772>>>>>>>  //  Pass full object name - return the relative name
50772>>>>>>>  //  e.g.,  Main.View.Obj1 --> Obj1
50772>>>>>>>  Function Local_Object_name string nm returns string
50773>>>>>>>     local integer ps
50774>>>>>>>     Repeat
50774>>>>>>>>
50774>>>>>>>       pos "." in nm to ps
50776>>>>>>>>
50776>>>>>>>       If ps eq 0 function_return nm
50779>>>>>>>       increment ps
50780>>>>>>>       Mid Nm to Nm 255 ps
50783>>>>>>>>
50783>>>>>>>     Loop
50784>>>>>>>>
50784>>>>>>>  end_function
50785>>>>>>>
50785>>>>>>>  //  Take string "#1,#2" and return integer hi #1 + #2
50785>>>>>>>  Function Parse_Complex string sVal returns integer
50786>>>>>>>     Local integer ps
50787>>>>>>>     Pos "," in sVal to ps
50789>>>>>>>>
50789>>>>>>>     if ps ;        Function_Return ( integer(left(sVal,ps-1))*65536 + ;                          integer(mid(sVal,255,ps+1)) )
50792>>>>>>>  End_Function // Parse_Complex
50793>>>>>>>
50793>>>>>>>  // Convert a complex integer to a string "hi,Low"
50793>>>>>>>  //
50793>>>>>>>  Function Complex_to_String integer i1 returns string
50794>>>>>>>     function_return ( string(hi(i1)) - "," - String(low(i1)) )
50795>>>>>>>  End_function
50796>>>>>>>
50796>>>>>>>
50796>>>>>>>  // *WvA: I don't want to save locations of a reportview noted in the registry.
50796>>>>>>>  // These printing dialogs are centered on the panel anyway, so it doesn't make any
50796>>>>>>>  // sense to clutter up the registry with this kind of nonsense.
50796>>>>>>>  ////
50796>>>>>>>  ////  Save View information to dfwin.ini file. Save as:
50796>>>>>>>  ////  View_ObjectName=LOC:Row,Col  e.g., Cust_Ent=LOC:10,20
50796>>>>>>>  ////     Leaving room for growth here.
50796>>>>>>>  ////
50796>>>>>>>  Procedure Save_Environment
50797>>>>>>>  //   Local String nm Vn st
50797>>>>>>>  //   Local Integer H
50797>>>>>>>  //
50797>>>>>>>  //   Get System_Profile_String "SaveEnvironment" to St
50797>>>>>>>  //   Move (Uppercase(trim(st))) to st
50797>>>>>>>  //   If (st="YES" or st="ON" or st="TRUE") Begin
50797>>>>>>>  //     // Note with the 3.05 version we will have problems if the view has
50797>>>>>>>  //     // been maximized and then iconized. We still don't know what the normal
50797>>>>>>>  //     // size/loc is when maximized. We will take a chance and assume that an
50797>>>>>>>  //     // iconized view is always non-zoomed (since views don't support the zoom
50797>>>>>>>  //     // button).
50797>>>>>>>  //     If (View_mode(Current_Object)<>VIEWMODE_ZOOM) Begin
50797>>>>>>>  //
50797>>>>>>>  //       Get Name to Vn // full name of object
50797>>>>>>>  //       Get Local_Object_Name Vn to Vn   // just get the local name
50797>>>>>>>  //       Get GUILocation to H             // complex location
50797>>>>>>>  //       Get Complex_to_String h to nm    // convert complex to "hi,low"
50797>>>>>>>  //       Set System_Profile_String VN to ("LOC:"+Nm)
50797>>>>>>>  //     End
50797>>>>>>>  //   End
50797>>>>>>>  //
50797>>>>>>>  End_Procedure
50798>>>>>>>  //
50798>>>>>>>  //// Augment to check for view string in .INI. Currently, if found
50798>>>>>>>  //// set the location
50798>>>>>>>  ////
50798>>>>>>>  Procedure Load_Environment
50799>>>>>>>  //   Local String nm Vn Lc
50799>>>>>>>  //   Local Integer H ps
50799>>>>>>>  //   // see above for reasoning on this
50799>>>>>>>  //   If (View_mode(Current_Object)=VIEWMODE_NORMAL) Begin
50799>>>>>>>  //     Get Name to Vn
50799>>>>>>>  //     Get Local_Object_Name Vn to Vn
50799>>>>>>>  //     Get System_Profile_String Vn to Nm
50799>>>>>>>  //     IF Nm ne '' Begin
50799>>>>>>>  //        Pos "LOC:" in Nm to Ps   // look for LOC:row,col
50799>>>>>>>  //        If Ps Begin
50799>>>>>>>  //           Mid Nm to Lc 255 (Ps+4)
50799>>>>>>>  //           Pos " " in Lc to ps
50799>>>>>>>  //           if Ps left lc to lc (ps-1)
50799>>>>>>>  //           Get Parse_Complex lc to H
50799>>>>>>>  //           Set GUILocation to (Hi(H)) (Low(H))
50799>>>>>>>  //           Send Adjust_Logicals
50799>>>>>>>  //        End
50799>>>>>>>  //     End
50799>>>>>>>  //   End
50799>>>>>>>  End_Procedure
50800>>>>>>>
50800>>>>>>>  Function View_Changed returns Integer
50801>>>>>>>     Local Integer Changed
50802>>>>>>>     Broadcast Get Data_Set_Should_Save to Changed // Ask for changes in Data-sets
50804>>>>>>>     Function_Return Changed
50805>>>>>>>  End_Function
50806>>>>>>>
50806>>>>>>>  Procedure Notify_Exit_Application
50807>>>>>>>    Send Save_Environment
50808>>>>>>>  End_procedure
50809>>>>>>>
50809>>>>>>>  Procedure End_Construct_Object
50810>>>>>>>     Send Load_Environment
50811>>>>>>>     //Send Define_SysMenu
50811>>>>>>>     Forward Send End_Construct_Object
50813>>>>>>>  End_Procedure // End_Construct_Object
50814>>>>>>>
50814>>>>>>>  Procedure Close_Client
50815>>>>>>>     Send Exit_Function
50816>>>>>>>  End_Procedure
50817>>>>>>>
50817>>>>>>>  Procedure Entering_Scope returns Integer
50818>>>>>>>     Local Integer rVal
50819>>>>>>>     Forward Get MSG_Entering_Scope to rVal
50821>>>>>>>     If not rVal send Show_View_Name (Label(Current_Object))
50824>>>>>>>  End_Procedure
50825>>>>>>>
50825>>>>>>>  Procedure Exiting_Scope integer whereto returns Integer
50826>>>>>>>     Local Integer rVal
50827>>>>>>>     Forward Get MSG_Exiting_Scope whereto to rVal
50829>>>>>>>     If not rVal Send Show_View_Name ''
50832>>>>>>>  End_Procedure
50833>>>>>>>
50833>>>>>>>  Procedure Show_view_Name string sHelp
50834>>>>>>>     Local Integer rVal Id
50835>>>>>>>     Get Statusbar_id to id
50836>>>>>>>     If Id Send Show_View_Name to Id sHelp
50839>>>>>>>  End_Procedure
50840>>>>>>>
50840>>>>>>>  Function Should_Save_Recursive returns integer
50841>>>>>>>    Function_return (View_Changed(Current_Object))
50842>>>>>>>  End_Function
50843>>>>>>>
50843>>>>>>>End_Class // dbReportView
50844>>>>>
50844>>>>>Class ReportViewSub is a ReportView
50845>>>>>
50845>>>>>    Procedure Construct_Object
50846>>>>>        Forward Send Construct_Object
50848>>>>>        Property Integer Server 0
50849>>>>>    End_Procedure // Construct_Object
50850>>>>>
50850>>>>>    Procedure Page Integer PageMode
50851>>>>>        Integer hWnd
50852>>>>>        Forward Send Page PageMode
50854>>>>>        Get Window_Handle to hWnd
50855>>>>>        If (hWnd) Begin
50857>>>>>            Send GreekSysMenu
50858>>>>>        End
50858>>>>>>
50858>>>>>    End_Procedure
50859>>>>>
50859>>>>>    Procedure Close_Panel
50860>>>>>        Local Integer liScope
50861>>>>>        Move (Prior_Scope(Desktop)) To liScope
50862>>>>>        Move (Scope_Focus(liScope)) To liScope
50863>>>>>        Forward Send Close_Panel
50865>>>>>        Send Activate To liScope
50866>>>>>    End_Procedure // Close_Panel
50867>>>>>
50867>>>>>End_Class
50868>>>>>
50868>>>>>Class dbReportViewSub is a dbReportView
50869>>>>>
50869>>>>>    Procedure Construct_Object
50870>>>>>        Forward Send Construct_Object
50872>>>>>        Property Integer Server 0
50873>>>>>    End_Procedure // Construct_Object
50874>>>>>
50874>>>>>    Procedure Page Integer PageMode
50875>>>>>        Integer hWnd
50876>>>>>        Forward Send Page PageMode
50878>>>>>        Get Window_Handle to hWnd
50879>>>>>        If (hWnd) Begin
50881>>>>>            Send GreekSysMenu
50882>>>>>        End
50882>>>>>>
50882>>>>>    End_Procedure
50883>>>>>
50883>>>>>    Procedure Close_Panel
50884>>>>>        Local Integer liScope
50885>>>>>        Move (Prior_Scope(Desktop)) To liScope
50886>>>>>        Move (Scope_Focus(liScope)) To liScope
50887>>>>>        Forward Send Close_Panel
50889>>>>>        Send Activate To liScope
50890>>>>>    End_Procedure // Close_Panel
50891>>>>>End_Class
50892>>>>>
50892>>>    Use cSyDateForm.Pkg
50892>>>    Use Button.Sub
50892>>>    Use Txtbox.Sub
50892>>>    Use Chkbox.Sub
50892>>>    Use Form.Sub
50892>>>
50892>>>    //AB-IgnoreEnd
50892>>>
50892>>>    ACTIVATE_VIEW Activate_rMetafNoErg FOR rMetafNoErg
50896>>>
50896>>>    Object rMetafNoErg is a ReportViewSub
50898>>>
50898>>>        //AB-StoreTopStart
50898>>>        property integer pierr              public 0
50900>>>        Property Integer Sort_IndexRlog     Public 1
50902>>>        property integer pipayresp          public 0
50904>>>        property integer picount            public 0
50906>>>        property string  psmodule           public ''
50908>>>        property date    pddate             public ''
50910>>>        property number  px0                public 0
50912>>>        property number  pp0                public 0
50914>>>        property number  px00               public 0
50916>>>        property number  pp00               public 0
50918>>>        property number  px1                public 0
50920>>>        property number  pp1                public 0
50922>>>        
50922>>>        //AB-StoreTopEnd
50922>>>
50922>>>        Set Label to "‹œ«˜­¦¨á ¬§¦¢¦å§à¤ §˜¨˜¡˜£§«¦¤«˜ª ¡ ¤ã©œ ª ®à¨åª â¨š˜"
50923>>>        Set Size to 113 308
50924>>>        Set Location to 9 10
50925>>>        Set Color to 8555487
50926>>>
50926>>>        //AB-DDOStart
50926>>>
50926>>>
50926>>>        //AB-DDOEnd
50926>>>
50926>>>        Object cSyDateForm1 is a cSyDateForm
50928>>>            Set Size to 13 66
50929>>>            Set Location to 6 117
50930>>>            Set Label_Col_Offset to 2
50931>>>            Set Label_Justification_Mode to jMode_Right
50932>>>            Set Form_Mask Item 0 to "dd/MM/yyyy"
50933>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
50934>>>
50934>>>            //AB-StoreStart
50934>>>            set prompt_object to (ocalendar(self))
50935>>>            //AB-StoreEnd
50935>>>
50935>>>        End_Object    // cSyDateForm1
50936>>>
50936>>>        Object ButtonSub3 is a ButtonSub
50938>>>
50938>>>            //AB-StoreTopStart
50938>>>                    
50938>>>            //AB-StoreTopEnd
50938>>>
50938>>>            Set Bitmap to "RUNPROG.BMP"
50939>>>            Set Size to 20 23
50940>>>            Set Location to 2 236
50941>>>            Set Border_Style to Border_StaticEdge
50942>>>            Set Focus_Mode to Pointer_Only
50943>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
50944>>>
50944>>>            //AB-StoreStart
50944>>>                    
50944>>>            Set TooltipValue to '„¤˜¨¥ž › ˜› ¡˜©å˜ª'
50945>>>            
50945>>>            Procedure OnClick
50947>>>                String StartHmen sModule sMess
50948>>>                Integer ibpoid iYear iPayResp ibpoid1 iChkAkyr iYes
50948>>>            
50948>>>                get value           of csydateform1 to starthmen
50949>>>                Get checked_State   of f_payresp    to ipayresp
50950>>>                Get checked_State   of chkAkyr      to iChkAkyr
50951>>>                get psModule                        to sModule
50952>>>            
50952>>>                If (StartHmen='') Begin
50954>>>                    Send Stop_Box 'ƒœ¤ §¢ž¡«¨¦¢¦šã©˜«œ ž£œ¨¦£ž¤å˜ œšš¨˜­é¤' '‘­á¢£˜ 1001'
50955>>>                    Send Activate to cSyDateForm1
50956>>>                    Procedure_Return
50957>>>                End
50957>>>>
50957>>>            
50957>>>                Move (TheYearSegment(starthmen)) to iYear
50958>>>                If (iYear Lt syscurxr.year_year) Begin
50960>>>                    Send Stop_Box '„©­˜¢£â¤ž ž£œ¨¦£ž¤å˜ œšš¨˜­é¤' '‘­á¢£˜ 1002'
50961>>>                    Send Activate to cSyDateForm1
50962>>>                    Procedure_Return
50963>>>                End
50963>>>>
50963>>>                If ((sModule<>'01') And (sModule<>'02')) Begin
50965>>>                    Send Stop_Box 'ŠáŸ¦ª ©«¦ Module ¡¬¡¢é£˜«¦ª' '‘­á¢£˜ 1003'
50966>>>                    Send Activate to cSyDateForm1
50967>>>                    Procedure_Return
50968>>>                End
50968>>>>
50968>>>            
50968>>>                If (iChkAkyr) Begin
50970>>>                    Move '' to sMess
50971>>>                    Append sMess '„å©«œ ™â™˜ ¦  ¦«  Ÿâ¢œ«œ ¤˜ ˜¡¬¨é©œ«œ' '\n«ž¤ › ˜› ¡˜©å˜ £œ«˜­¦¨áª ¬§¦¢¦å§à¤ «žª ' StartHmen
50974>>>                    Get YesNo_Box sMess to iYes
50975>>>                    If (iYes=MBR_NO) Procedure_Return
50978>>>                    String sCtyp
50978>>>                    Begin_Transaction
50979>>>                        Send Clear      to Cmoves_DD
50980>>>                        Move StartHmen  to Cmoves.Cmoves_Hmnia
50981>>>                        Send Find       to Cmoves_DD Gt 3
50982>>>                        While ((Found) And (Cmoves.Cmoves_Hmnia=StartHmen))
50986>>>                            Set Label Of btnMess to (Trim(Cmoves.Cmoves_Hmnia)+' '+String(Cmoves.Recnum))
50987>>>                                 If ((sModule='01') And (Cmoves.Ctypkin_Code='101') And (Cmoves.Company_Code=SysCurXr.Company_Code) And (Cmoves.Branch_Code=SysCurXr.Branch_Code)) Send Request_Delete to Cmoves_DD
50990>>>                            Else If ((sModule='01') And (Cmoves.Ctypkin_Code='102') And (Cmoves.Company_Code=SysCurXr.Company_Code) And (Cmoves.Branch_Code=SysCurXr.Branch_Code)) Send Request_Delete to Cmoves_DD
50994>>>                            Else If ((sModule='02') And (Cmoves.Ctypkin_Code='201') And (Cmoves.Company_Code=SysCurXr.Company_Code) And (Cmoves.Branch_Code=SysCurXr.Branch_Code)) Send Request_Delete to Cmoves_DD
50998>>>                            Else If ((sModule='02') And (Cmoves.Ctypkin_Code='202') And (Cmoves.Company_Code=SysCurXr.Company_Code) And (Cmoves.Branch_Code=SysCurXr.Branch_Code)) Send Request_Delete to Cmoves_DD
51002>>>                            Send Find to Cmoves_DD GT 3
51003>>>                        Loop
51004>>>>
51004>>>                    End_Transaction
51005>>>                End
51005>>>>
51005>>>                Else Begin
51006>>>                    indicate err false
51007>>>                    Get YesNo_Box 'Œ˜ ¥œ¡ ¤ã©œ  ž › ˜› ¡˜©å˜ £œ«˜­¦¨áª ¬§¦¢¦å§à¤ ?' to iYes
51008>>>                    If (iYes=MBR_NO) Procedure_Return
51011>>>                 //   Begin_Transaction
51011>>>                        If ((iPayresp=1) And (sModule='01')) Begin
51013>>>                            Move (Docpresp(Self))   to iBPOID1
51014>>>                            Send DoProcess          to iBPOID1
51015>>>                            Move (Docclients(Self)) to iBPOID
51016>>>                            Set psModule Of iBPOID  to sModule
51017>>>                            Send DoProcess          to iBPOID
51018>>>                        End
51018>>>>
51018>>>            
51018>>>                        If (sModule='02') begin
51020>>>                           Move (Docclients(Self)) to iBPOID
51021>>>                           Set psModule Of iBPOID  to sModule
51022>>>                           Send DoProcess          to iBPOID
51023>>>                        End
51023>>>>
51023>>>                    begin_transaction
51024>>>                        Send StartReport
51025>>>                    End_Transaction
51026>>>                End
51026>>>>
51026>>>                if (not(err)) send info_box 'ƒ ˜› ¡˜©å˜ Ž¢¦¡¢ž¨éŸž¡œ' '¢ž¨¦­¦¨å˜'
51029>>>                else send info_box          '˜¨¦¬© á©«ž¡œ ¡á§¦ ¦ ¢áŸ¦ª ©«ž¤ ƒ ˜› ¡˜©å˜' '¢ž¨¦­¦¨å˜'
51031>>>                Set Label Of btnMess to ''
51032>>>            End_Procedure
51033>>>            
51033>>>            
51033>>>            
51033>>>            
51033>>>            
51033>>>            
51033>>>            
51033>>>            
51033>>>            
51033>>>            
51033>>>            
51033>>>            
51033>>>            
51033>>>            
51033>>>            
51033>>>            
51033>>>            
51033>>>            
51033>>>            
51033>>>            
51033>>>            
51033>>>            
51033>>>            
51033>>>            
51033>>>            
51033>>>            
51033>>>            
51033>>>            //AB-StoreEnd
51033>>>
51033>>>        End_Object    // ButtonSub3
51034>>>
51034>>>        Object TextBoxSub1 is a TextBoxSub
51036>>>            Set Label to "ƒé©«œ ž£/¤å˜ š ˜ « ª œšš¨˜­âª §¦¬ Ÿ˜ ›ž£ ¦¬¨šžŸ¦ç¤ ©«ž¤ ¤œ˜ ®¨ã©ž"
51037>>>            Set Color to 8555487
51038>>>            Set Location to 4 6
51039>>>            Set Size to 25 107
51040>>>            Set Justification_Mode to jMode_Center
51041>>>            Set TypeFace to "MS Sans Serif"
51042>>>        End_Object    // TextBoxSub1
51043>>>
51043>>>        Object TextBoxSub2 is a TextBoxSub
51045>>>            Set Label to "‹ž›œ¤ ©£æª ¬§¦¢¦å§à¤ “§œ¬Ÿ. ¢ž¨à£é¤ && ”¦¨âà¤"
51046>>>            Set Color to 8555487
51047>>>            Set Location to 32 16
51048>>>            Set Size to 10 186
51049>>>            Set FontWeight to 800
51050>>>            Set TypeFace to "MS Sans Serif"
51051>>>        End_Object    // TextBoxSub2
51052>>>
51052>>>        Object f_payresp is a CheckBoxSub
51054>>>            Set Size to 8 9
51055>>>            Set Location to 38 251
51056>>>            Set Color to clWindowText
51057>>>        End_Object    // f_payresp
51058>>>
51058>>>        Object TextBoxSub3 is a TextBoxSub
51060>>>            Set Label to "Œ˜ «¨â¥œ  ‹ŽŒŽ 1 ­¦¨˜, š ˜ «¦  §¨é«¦ ¬§¦¡˜«á©«ž£˜"
51061>>>            Set Color to 8555487
51062>>>            Set Location to 43 16
51063>>>            Set Size to 10 186
51064>>>            Set FontWeight to 800
51065>>>            Set TypeFace to "MS Sans Serif"
51066>>>        End_Object    // TextBoxSub3
51067>>>
51067>>>        Object chkAkyr is a CheckBoxSub
51069>>>            Set Size to 8 9
51070>>>            Set Location to 73 251
51071>>>            Set Color to 7302102
51072>>>        End_Object    // chkAkyr
51073>>>
51073>>>        Object TextBoxSub4 is a TextBoxSub
51075>>>            Set Label to "€¡ç¨à©ž ƒ ˜› ¡˜©å˜ª"
51076>>>            Set Transparent_State to TRUE
51077>>>            Set Color to 8555487
51078>>>            Set FontSize to 12 4
51079>>>            Set Location to 69 183
51080>>>            Set Size to 18 44
51081>>>            Set FontWeight to 600
51082>>>            Set Justification_Mode to jMode_Center
51083>>>            Set TypeFace to "MS Sans Serif"
51084>>>        End_Object    // TextBoxSub4
51085>>>
51085>>>        Object FormSub2 is a FormSub
51087>>>            Set Size to 5 268
51088>>>            Set Location to 58 0
51089>>>            Set Color to clRed
51090>>>            Set Label_Col_Offset to 2
51091>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
51092>>>
51092>>>            //AB-StoreStart
51092>>>                                                                                                                                                                                                                
51092>>>            Set Enabled_State   to False
51093>>>            Set Color           to clRed
51094>>>            
51094>>>            //AB-StoreEnd
51094>>>
51094>>>        End_Object    // FormSub2
51095>>>
51095>>>        Object btnMess is a ButtonSub
51097>>>            Set Size to 14 159
51098>>>            Set Location to 70 16
51099>>>            Set Border_Style to Border_StaticEdge
51100>>>            Set Focus_Mode to NonFocusable
51101>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
51102>>>
51102>>>            //AB-StoreStart
51102>>>            Procedure OnClick
51104>>>            
51104>>>            End_Procedure // OnClick
51105>>>            //AB-StoreEnd
51105>>>
51105>>>        End_Object    // btnMess
51106>>>
51106>>>
51106>>>        //AB-StoreStart
51106>>>        
51106>>>        Set Output_Device_Name to None
51107>>>        
51107>>>        ////////////////////////////////////////////
51107>>>        // Omada DD gia thn akyrosh ths diadikasia
51107>>>        // metaforas ypoloipon
51107>>>        ////////////////////////////////////////////
51107>>>        Object Areas_DD is a Areas_DataDictionary
51109>>>        End_Object
51110>>>        Object Payresp_DD is a Payresp_DataDictionary
51112>>>        End_Object
51113>>>        Object syscurxr_DD is a syscurxr_DataDictionary
51115>>>        End_Object
51116>>>        Object Country_DD is a Country_DataDictionary
51118>>>        End_Object
51119>>>        Object Towns_DD is a Towns_DataDictionary
51121>>>            Set DDO_Server to (Country_DD(self))
51122>>>        End_Object
51123>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
51125>>>            set piMustNOTConstrain to 1
51126>>>            Procedure Update
51128>>>            End_Procedure
51129>>>            Procedure Creating
51131>>>            End_Procedure
51132>>>        End_Object
51133>>>        Object Cities_DD is a Cities_DataDictionary
51135>>>            Set DDO_Server to (Towns_DD(self))
51136>>>        End_Object
51137>>>        Object Clients_DD is a Clients_DataDictionary
51139>>>            Set DDO_Server to (Cities_DD(self))
51140>>>            Set DDO_Server to (Payresp_DD(self))
51141>>>            Set DDO_Server to (Areas_DD(self))
51142>>>        End_Object
51143>>>        Object Cmoves_DD is a Cmoves_DataDictionary
51145>>>            Set DDO_Server to (Ctypkin_DD(self))
51146>>>            Set DDO_Server to (Clients_DD(self))
51147>>>            set pifromxrhsh to 1
51148>>>            set pifrombp    to 1
51149>>>        End_Object
51150>>>        ////////////////////////////////////////////
51150>>>        ////////////////////////////////////////////
51150>>>        
51150>>>        
51150>>>        
51150>>>        Procedure Activate_View Returns Integer
51152>>>            String sStr sModule StrDisp
51153>>>            Integer rVal
51153>>>        
51153>>>            Forward Get Msg_Activate_View to rVal
51155>>>        
51155>>>            Move '01'       to sModule
51156>>>            Set psModule    to sModule
51157>>>        
51157>>>            // ‰à› ¡˜ª §¦¬ ˜­¦¨˜ «¦ constrain «à¤ ©«¦ ®œ à¤ «¦¬ view ¦§àª §˜¨˜©«˜« ¡á
51157>>>            // ž ¡ ¤ã©œ ª §¦¬ „„ˆ ¤˜ œå¤˜  constrain ˜¤˜¢¦š˜ £œ «¦ ¡ç¡¢à£˜ ˜§¦
51157>>>            // «¦ ¦§¦ ¦ ¡˜¢œå«˜  «¦ view. .•. ˜¤ ¡¢žŸœå ˜§¦ à¢ã©œ ª/œ¢á«œª ¤˜ £ž¤
51157>>>            // ­˜å¤¦¤«˜  ©«˜ §˜¨˜©«˜« ¡á «˜ ctypkin €š¦¨é¤ ¡¢§....
51157>>>        
51157>>>            Move (gsfCode_mast("MODULE",(psModule(Self)))) to    StrDisp
51158>>>        
51158>>>            if (smodule = "01");                 Set Label Of rMetafNoErg to ("‹œ«˜­¦¨á ¬§¦¢¦å§à¤ œ¢˜«é¤"+ ' '+(trim(syscurxr.branch_name)))
51161>>>            if (smodule = "02");                 Set Label Of rMetafNoErg to ("‹œ«˜­¦¨á ¬§¦¢¦å§à¤ ¨¦£žŸœ¬«é¤"+' ' +(trim(syscurxr.branch_name)))
51164>>>        
51164>>>              if (psmodule(self) = "01");                 Set Report_Title of (metafyp_BasicReport(self)) to  "‹œ«˜­¦¨á ¬§¦¢¦å§à¤ œ¢˜«é¤         "
51167>>>            if (psmodule(self) = "02");                 Set Report_Title of (metafyp_BasicReport(self)) to  "‹œ«˜­¦¨á ¬§¦¢¦å§à¤ ¨¦£žŸœ¬«é¤          "
51170>>>        
51170>>>        End_Procedure
51171>>>        
51171>>>        Procedure StartReport
51173>>>            Local Integer iOutputDevice ipayresp
51174>>>            Local String  FileName
51174>>>            local date ddate
51174>>>            Get value of csydateform1 item 0 to ddate
51175>>>            set pddate to ddate
51176>>>            Get value of f_payresp  item 0 to ipayresp
51177>>>            set pipayresp to ipayresp
51178>>>            SEND RUN_REPORT
51179>>>        End_Procedure   // StartReport
51180>>>        
51180>>>        
51180>>>        Object metafyp_BasicReport is a BasicReport
51182>>>        
51182>>>            Set Report_Title to "‹œ«˜­¦¨á ¬§¦¢¦å§à¤                                  "
51183>>>            Set Report_Caption to "ƒ ˜› ¡˜©å˜ ©œ „¥â¢ ¥ž                             "
51184>>>            Object Areas_DD is a Areas_DataDictionary
51186>>>            End_Object    // Areas_DD
51187>>>        
51187>>>            Object Payresp_DD is a Payresp_DataDictionary
51189>>>            End_Object    // Payresp_DD
51190>>>        
51190>>>            Object syscurxr_DD is a syscurxr_DataDictionary
51192>>>            End_Object    // syscurxr
51193>>>        
51193>>>            Object Country_DD is a Country_DataDictionary
51195>>>            End_Object    // Country_DD
51196>>>        
51196>>>            Object Towns_DD is a Towns_DataDictionary
51198>>>                Set DDO_Server to (Country_DD(self))
51199>>>            End_Object    // Towns_DD
51200>>>        
51200>>>            Object Ctypkin_DD is a Ctypkin_DataDictionary
51202>>>                set piMustNOTConstrain to 1
51203>>>        
51203>>>                Procedure Update
51205>>>                End_Procedure
51206>>>        
51206>>>                Procedure Creating
51208>>>                End_Procedure
51209>>>            End_Object    // Ctypkin_DD
51210>>>        
51210>>>            Object Cities_DD is a Cities_DataDictionary
51212>>>                Set DDO_Server to (Towns_DD(self))
51213>>>            End_Object    // Cities_DD
51214>>>        
51214>>>            Object Clients_DD is a Clients_DataDictionary
51216>>>                Set DDO_Server to (Cities_DD(self))
51217>>>                Set DDO_Server to (Payresp_DD(self))
51218>>>                Set DDO_Server to (Areas_DD(self))
51219>>>            End_Object    // Clients_DD
51220>>>        
51220>>>            Object Cmoves_DD is a Cmoves_DataDictionary
51222>>>                Set DDO_Server to (Ctypkin_DD(self))
51223>>>                Set DDO_Server to (Clients_DD(self))
51224>>>                set pifromxrhsh to 1
51225>>>                set pifrombp    to 1
51226>>>            End_Object    // Cmoves_DD
51227>>>        
51227>>>            Object Cmovesa_DD is a Cmovesa_DataDictionary
51229>>>                //AB-StoreStart
51229>>>                Begin_Constraints
51231>>>                    date ddate
51232>>>                    string smodule
51232>>>                    get psmodule to smodule
51233>>>                    set ordering to 13
51234>>>                    constrain cmovesa.company_code eq syscurxr.company_code
51236>>>                    constrain cmovesa.branch_code  eq syscurxr.branch_code
51238>>>                    constrain cmovesa.year_year    eq syscurxr.year_year
51240>>>                    constrain cmovesa.module_from  eq smodule
51242>>>                End_Constraints
51245>>>            end_object
51246>>>            Set Server To (cmovesa_dd(Current_Object))
51247>>>        
51247>>>            //Breaks and Index for the report
51247>>>            Report_Index By Index.11
51249>>>            Report_breaks cmovesa.company_code cmovesa.branch_code cmovesa.module_from cmovesa.client_id cmovesa.cn_code
51266>>>            Function Starting_Main_Report Returns Integer
51268>>>              REREAD SYSCURXR
51272>>>              UNLOCK
51273>>>>
51273>>>              Integer iIndexRlog
51274>>>              Local Integer iRetVal
51274>>>              Forward Get Starting_Main_Report to iRetval
51276>>>              send rebuild_constraints to cmovesa_dd
51277>>>              Send Find to (cmovesa_dd(self)) First_Record 13
51278>>>            End_Function
51279>>>        
51279>>>            Procedure_Section subheader1
51281>>>                integer ino
51282>>>                move 0 to ino
51283>>>            End_Procedure
51284>>>        
51284>>>            Procedure_Section subheader2
51286>>>            End_Procedure
51287>>>        
51287>>>            Procedure_Section subheader3
51289>>>            End_Procedure
51290>>>        
51290>>>            Procedure_Section subheader4
51292>>>            End_Procedure
51293>>>        
51293>>>            Procedure_Section subheader5
51295>>>            End_Procedure
51296>>>            Procedure_Section  Body
51298>>>                String  scode smodule spar serr
51299>>>                Number  naxia nx0 np0 nx00 np00 nx1 np1 ndiaf tx0 tp0 tx00 tp00 tx1 tp1
51299>>>                Date    dHmnia
51299>>>                integer iyear icount nyear ctypkinyear
51299>>>                get px0    to nx0
51300>>>                get px1    to nx1
51301>>>                get px00   to nx00
51302>>>                get pp0    to np0
51303>>>                get pp1    to np1
51304>>>                get pp00   to np00
51305>>>                add cmovesa.cmoves_x0     to nx0
51306>>>                add cmovesa.cmoves_p0     to np0
51307>>>                add cmovesa.cmoves_x00    to nx00
51308>>>                add cmovesa.cmoves_p00    to np00
51309>>>                add cmovesa.cmoves_x1     to nx1
51310>>>                add cmovesa.cmoves_p1     to np1
51311>>>                set px0    to nx0
51312>>>                set px1    to nx1
51313>>>                set px00   to nx00
51314>>>                set pp0    to np0
51315>>>                set pp1    to np1
51316>>>                set pp00   to np00
51317>>>            End_Procedure
51318>>>        
51318>>>            Procedure_Section subTOTAL5
51320>>>        
51320>>>                 Number  naxia nx0 np0 nx00 np00 nx1 np1 ndiaf tx0 tp0 tx00 tp00 tx1 tp1
51321>>>                 integer icount
51321>>>                 string smodule spar msgstr SID scn
51321>>>                 date ddate
51321>>>                 get psmodule to smodule
51322>>>                 get pddate to ddate
51323>>>                 add 1 to icount
51324>>>                 get px0    to nx0
51325>>>                 get px1    to nx1
51326>>>                 get px00   to nx00
51327>>>                 get pp0    to np0
51328>>>                 get pp1    to np1
51329>>>                 get pp00   to np00
51330>>>                 if ((nx0 <> 0) or (np0 <>0)) begin
51332>>>                    if (nx0 > np0) begin
51334>>>                       move (nx0 - np0) to nx0
51335>>>                       move (nx00-np00) to nx00
51336>>>                       move (nx1-np1)   to nx1
51337>>>                       move 0           to np0
51338>>>                       move 0           to np00
51339>>>                       move 0           to np1
51340>>>                    end
51340>>>>
51340>>>                    else begin
51341>>>                       move (np0-nx0)   to np0
51342>>>                       move (np00-nx00) to np00
51343>>>                       move (np1-nx1)   to np1
51344>>>                       move 0           to nx0
51345>>>                       move 0           to nx00
51346>>>                       move 0           to nx1
51347>>>                    end
51347>>>>
51347>>>        
51347>>>                    send clear to cmoves_dd
51348>>>                    move cmovesa.client_id to clients.client_id
51349>>>                    send find to clients_dd eq 6
51350>>>                    if (not(found)) error 2999 'ƒœ¤ ™¨å©¡à œ¢á«ž'
51353>>>        
51353>>>                    move (trim(syscurxr.company_code))      to ctypkin.company_code
51354>>>                    move (trim(syscurxr.branch_code))       to ctypkin.branch_code
51355>>>                    move (TheYearSegment(ddate))            to ctypkin.year_year
51356>>>                    if ((smodule = '01') and (nx0 <> 0)) move '101' to ctypkin.ctypkin_code
51359>>>                    if ((smodule = '01') and (np0 <> 0)) move '102' to ctypkin.ctypkin_code
51362>>>                    if ((smodule = '02') and (nx0 <> 0)) move '201' to ctypkin.ctypkin_code
51365>>>                    if ((smodule = '02') and (np0 <> 0)) move '202' to ctypkin.ctypkin_code
51368>>>                    send find to ctypkin_dd eq 1
51369>>>                    if (found=1) begin
51371>>>        
51371>>>                        if (cmovesa.cn_code='') goto PROSPER1
51374>>>        
51374>>>                        set field_changed_value of cmoves_dd field cmoves.cmoves_x0 to nx0
51375>>>                        set field_changed_value of cmoves_dd field cmoves.cmoves_p0 to np0
51376>>>                        set field_changed_value of cmoves_dd field cmoves.cmoves_x00 to nx00
51377>>>                        set field_changed_value of cmoves_dd field cmoves.cmoves_p00 to np00
51378>>>                        if (nx0>np0) set field_changed_value of cmoves_dd field cmoves.cmoves_axia to nx0
51381>>>                        else if (np0>nx0) set field_changed_value of cmoves_dd field cmoves.cmoves_axia to np0
51385>>>                        set field_changed_value of cmoves_dd field cmoves.cmoves_x1 to nx1
51386>>>                        set field_changed_value of cmoves_dd field cmoves.cmoves_p1 to np1
51387>>>                        set field_changed_value of cmoves_dd field cmoves.cmoves_hmnia to ddate
51388>>>                        move '‹œ«˜­.¬§¦¢¦å§à¤ ' to spar
51389>>>                        append spar ddate
51390>>>                        set field_changed_value of cmoves_dd field cmoves.cmoves_par to spar
51391>>>                        set field_changed_value of cmoves_dd field cmoves.cmoves_sc_code2 to 'EUR'
51392>>>                        set field_changed_value of cmoves_dd field cmoves.cmoves_M_code to smodule
51393>>>                        set field_changed_value of cmoves_dd field cmoves.Module_from to smodule
51394>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Enhm_Ypol_Pel    to '1'
51395>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Enhm_Hmnies_Pel  to '1'
51396>>>                        set field_changed_value of cmoves_dd field cmoves.cn_code to cmovesa.cn_code
51397>>>                        set field_changed_value of cmoves_dd field cmoves.cn_recr to cmovesa.cn_recr
51398>>>                        set field_changed_value of cmoves_dd field cmoves.sls_id  to cmovesa.sls_id
51399>>>                        set field_changed_value of cmoves_dd field cmoves.presp_id to cmovesa.presp_id
51400>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.cnt_id   to cmovesa.cnt_id
51401>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.mhxanik_id to cmovesa.mhxanik_id
51402>>>                        send request_save to cmoves_dd
51403>>>                    end
51403>>>>
51403>>>                      MOVE cmovesa.client_id to sid
51404>>>                      MOVE cmovesa.cn_code to scn
51405>>>                      send update_status ('„šš¨˜­ã   ' + string(sid) + " : " + string(scn))
51406>>>                      PROSPER1:
51406>>>                      set px0  to 0
51407>>>                      set px1  to 0
51408>>>                      set px00 to 0
51409>>>                      set pp0  to 0
51410>>>                      set pp1  to 0
51411>>>                      set pp00 to 0
51412>>>                 end
51412>>>>
51412>>>            End_Procedure
51413>>>        
51413>>>        
51413>>>            Procedure_Section subtotal4
51415>>>               integer ino
51416>>>               move 0 to ino
51417>>>            End_Procedure
51418>>>        
51418>>>        
51418>>>            Procedure_Section subtotal3
51420>>>               integer ino
51421>>>               move 0 to ino
51422>>>            End_Procedure
51423>>>        
51423>>>            Procedure_Section subtotal2
51425>>>               integer ino
51426>>>               move 0 to ino
51427>>>            End_Procedure
51428>>>        
51428>>>            Procedure_Section subtotal1
51430>>>               integer ino
51431>>>               move 0 to ino
51432>>>            End_Procedure
51433>>>        
51433>>>        End_Object
51434>>>        
51434>>>        
51434>>>        
51434>>>        
51434>>>        
51434>>>        
51434>>>        
51434>>>        
51434>>>        
51434>>>        
51434>>>        
51434>>>        
51434>>>        
51434>>>        
51434>>>        
51434>>>        
51434>>>        
51434>>>        
51434>>>        
51434>>>        
51434>>>        
51434>>>        
51434>>>        
51434>>>        
51434>>>        
51434>>>        
51434>>>        //AB-StoreEnd
51434>>>
51434>>>    End_Object    // rMetafNoErg
51435>>>
51435>>>
51435>>>    //AB-StoreStart
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>                        
51435>>>    //AB-StoreEnd
51435>>>
51435>>>//AB/     End_Object    // prj
51435>
51435>        //AB-ClientStoreStart
51435>        
51435>        if (wait(self)) send deactivate to (wait(self))
51438>        
51438>        
51438>        
51438>        
51438>        
51438>        
51438>        
51438>        
51438>        
51438>        //AB-ClientStoreEnd
51438>
51438>
51438>    End_Object  // Client_Area
51439>    
51439>    On_Key Key_Ctrl+Key_1 Send Activate_rMetafNoErg To Client_Area
51440>    
51440>    Use DFStdSbr.pkg //  Status-Bar object.
INCLUDING FILE: DFSTDSBR.PKG
51440>>>// 07/23/96 JJT - New Class names
51440>>>// Very prototype global status bar
51440>>>//
51440>>>Use dfMainSt.pkg
INCLUDING FILE: DFMAINST.PKG
51440>>>>>// 07/23/96 JJT - New Class names
51440>>>>>Use dfAstbar.pkg
51440>>>>>
51440>>>>>Class StatusBar is a AppStatusBar
51441>>>>>
51441>>>>>    Procedure Construct_Object
51442>>>>>       Forward Send Construct_Object
51444>>>>>       //
51444>>>>>       Send Add_Item 350  ''     // micro-help
51445>>>>>       Send Add_Item  40  'View:'
51446>>>>>       Set Item_Display_Style To sbNORMAL
51447>>>>>       Send Add_Item 200  ''     // view name
51448>>>>>       Send Add_Item   0  ''     // spring 'normal' to end
51449>>>>>       Set Item_Display_Style To sbNORMAL
51450>>>>>    End_Procedure // Construct_Object
51451>>>>>
51451>>>>>    Procedure Show_View_Name String sName
51452>>>>>        Set Value item 2 to sName
51453>>>>>    End_Procedure
51454>>>>>
51454>>>>>End_Class
51455>>>
51455>>>If (Wait(Self)) Send Deactivate to (Wait(Self))
51458>>>
51458>>>Object oStatusBarSub  is a StatusBar
51460>>>    Use DFTimer // DfTimer Manager Must Have a WindowHandle
51460>>>    
51460>>>    Property Integer piStdPanes Public (PaneCount(Self))
51462>>>    
51462>>>    //Set Value     Item 1 to (ToANSI("„§ ¢¦šã:"))
51462>>>    Set PaneWidth item 1 to 50
51463>>>    
51463>>>    Send AddPane 55  ""        sbLOWERED
51464>>>    Send AddPane 70  ""        sbLOWERED
51465>>>    Send AddPane 55  ""        sbLOWERED
51466>>>    
51466>>>    Procedure pTimer
51468>>>        String lsDay lsHour lsHH lsMM lsSS
51469>>>        Integer liStdPanes lbState
51469>>>    
51469>>>        Get piStdPanes to liStdPanes
51470>>>        Sysdate lsDay lsHH lsMM lsSS
51474>>>        If (Length(lsHH)=1) Insert "0" In lsHH At 1
51478>>>        If (Length(lsMM)=1) Insert "0" In lsMM At 1
51482>>>        If (Length(lsSS)=1) Insert "0" In lsSS At 1
51486>>>        Move (lsHH+":"+lsMM+":"+lsSS) to lsHour
51487>>>        Get Simple_state to lbState
51488>>>        If  Not (lbState) Begin
51490>>>            Set Value Item liStdPanes     to lsHour
51491>>>            Set Value Item (liStdPanes+1) to lsDay
51492>>>        End
51492>>>>
51492>>>    
51492>>>    End_Procedure // pTimer
51493>>>    
51493>>>    
51493>>>    Object oTimerObj Is A DFTimer
51495>>>        Set Timeout to 1000
51496>>>        Set Timer_Active_State to TRUE
51497>>>        Set Timer_Object to (oStatusBarSub(Current_Object))
51498>>>        Set Timer_Message to pTimer
51499>>>    End_Object // oTimerOdj
51500>>>End_Object // oStatusBar
51501>>>
51501>>>
51501>
51501>    //AB-PanelStoreStart
51501>    Use StdAbout.pkg // Standard "About" package.
INCLUDING FILE: STDABOUT.PKG
51501>>>//************************************************************************
51501>>>// Confidential Trade Secret.
51501>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
51501>>>// as an unpublished work.  All rights reserved.
51501>>>// DataFlex is a registered trademark of Data Access Corporation.
51501>>>//
51501>>>//************************************************************************
51501>>>//************************************************************************
51501>>>//
51501>>>// $File name  : StdAbout.pkg
51501>>>// $File title : Standard about object package for VDF
51501>>>// Notice      :
51501>>>// $Author(s)  : John Tuohy
51501>>>//
51501>>>// $Rev History
51501>>>//
51501>>>// JT 06/27/97   File created
51501>>>//************************************************************************
51501>>>
51501>>>// This provides a quick and simple way to create an about package for a program.
51501>>>// You need to create a message inside you client area called Activate_About.
51501>>>// Within this message you should send the message DoAbout passing needed
51501>>>// string information.
51501>>>//
51501>>>//       Procedure Activate_About
51501>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
51501>>>//       End_Procedure
51501>>>//    where: sTitle =     Name of application. If none provided, uses caption
51501>>>//                        bar title
51501>>>//           sVersion   = Version Line. If none provided, will be blank
51501>>>//           sCopyRight = Copyright Line. If none provided, will be blank
51501>>>//           sAuthor    = Author name, blank if none provided
51501>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
51501>>>//                        is used.
51501>>>// It is expected that you will place this in your own object package. For
51501>>>// example an order about package may look like this:
51501>>>//
51501>>>//   // OrderAbout.pkg
51501>>>//   Use StdAbout.pkg
51501>>>//   Procedure Activate_About
51501>>>//      Local String sTitle sCopyright sVersion sAuthor
51501>>>//      Move "My Order Entry System" to sTitle
51501>>>//      Move "Version 2.1" to sVersion
51501>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
51501>>>//      Move "John Smith"  to sAuthor
51501>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
51501>>>//   end_procedure
51501>>>//   // end of file.
51501>>>
51501>>>Use DfAbout.pkg
INCLUDING FILE: DFABOUT.PKG
51501>>>>>//************************************************************************
51501>>>>>// Confidential Trade Secret.
51501>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
51501>>>>>// as an unpublished work.  All rights reserved.
51501>>>>>// DataFlex is a registered trademark of Data Access Corporation.
51501>>>>>//
51501>>>>>//************************************************************************
51501>>>>>//************************************************************************
51501>>>>>//
51501>>>>>// $File name  : DfAbout.pkg
51501>>>>>// $File title : About class support
51501>>>>>// Notice      :
51501>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
51501>>>>>//
51501>>>>>// $Rev History
51501>>>>>//
51501>>>>>// JJT 11/5/98    Added version information
51501>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
51501>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
51501>>>>>//                workspace package.
51501>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
51501>>>>>//                class can create this object.
51501>>>>>//                Cleaned up the interface (used correct classes and messages)
51501>>>>>//                Added workspace reporting support to sys-info.
51501>>>>>//                Turned off wrapping in the sys-info editor.
51501>>>>>// KR  ??/??/96   File created
51501>>>>>//************************************************************************
51501>>>>>Use windows.pkg
51501>>>>>Use DFbitmap.pkg
51501>>>>>
51501>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
51502>>>>>
51502>>>>>//****************************************************************************
51502>>>>>// $Module type: FUNCTION
51502>>>>>// $Module name: Network_User_Name
51502>>>>>// $Author     : AK/VOO/KCR
51502>>>>>// Created     : 24-09-96 @ 19:17
51502>>>>>//
51502>>>>>// Description
51502>>>>>//    This function reads the current username of windows and returns that
51502>>>>>//    name or an text unknown user
51502>>>>>//
51502>>>>>// $Rev History
51502>>>>>//    24-09-96  Module header created
51502>>>>>//****************************************************************************
51502>>>>>Function Network_User_Name Returns String
51504>>>>>    Local String sName sLength
51505>>>>>    Local Pointer lpName_Addr lpLength_Addr
51505>>>>>    Local Integer iRetval
51505>>>>>
51505>>>>>    Movestr (Repeat (Character (0), 255)) To sName
51506>>>>>>
51506>>>>>    GetAddress Of sName To lpName_Addr
51507>>>>>    Movestr (DwordToBytes (255)) To sLength
51508>>>>>>
51508>>>>>    GetAddress Of sLength To lpLength_Addr
51509>>>>>
51509>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
51510>>>>>>
51510>>>>>
51510>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
51513>>>>>    Else Function_Return "User Unknown"
51515>>>>>End_Function // Network_User_Name
51516>>>>>
51516>>>>>Type MEMORYSTATUS
51516>>>>>   Field MEMORYSTATUS.dwLength         As Dword // sizeof(MEMORYSTATUS)
51516>>>>>   Field MEMORYSTATUS.dwMemoryLoad     As Dword // percent of memory in use
51516>>>>>   Field MEMORYSTATUS.dwTotalPhys      As Dword // bytes of physical memory
51516>>>>>   Field MEMORYSTATUS.dwAvailPhys      As Dword // free physical memory bytes
51516>>>>>   Field MEMORYSTATUS.dwTotalPageFile  As Dword // bytes of paging file
51516>>>>>   Field MEMORYSTATUS.dwAvailPageFile  As Dword // free bytes of paging file
51516>>>>>   Field MEMORYSTATUS.dwTotalVirtual   As Dword // user bytes of address space
51516>>>>>   Field MEMORYSTATUS.dwAvailVirtual   As Dword // free user bytes
51516>>>>>End_Type // MEMORYSTATUS
51516>>>>>
51516>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
51517>>>>>
51517>>>>>// If a global workspace object exists it will use this variable to store
51517>>>>>// its object id.
51517>>>>>
51517>>>>>Class SysinfoDisplay Is An Edit
51518>>>>>    Procedure Construct_Object
51519>>>>>        forward send construct_object
51521>>>>>
51521>>>>>        Set Location To 6 6
51522>>>>>        Set Size To 110 255
51523>>>>>        Set Read_Only_State To True
51524>>>>>        Set wrap_state to False
51525>>>>>    end_Procedure
51526>>>>>
51526>>>>>    //****************************************************************************
51526>>>>>    // $Module type: PROCEDURE
51526>>>>>    // $Module name: Add_Line
51526>>>>>    // $Author     : VOO
51526>>>>>    // Created     : 06-10-96 @ 15:23
51526>>>>>    //
51526>>>>>    // Description
51526>>>>>    //    This method will add a line to this edit object, it should go simpler
51526>>>>>    //    but it seems to be done this way.
51526>>>>>    //
51526>>>>>    // $Rev History
51526>>>>>    //    06-10-96  Module header created
51526>>>>>    //****************************************************************************
51526>>>>>    Procedure Add_Line String sVal
51527>>>>>        Local Integer iLine
51528>>>>>
51528>>>>>        Moveint (Line_Count (Current_Object)) To iLine
51529>>>>>>
51529>>>>>        If (iLine = 1 And Changed_State (Current_Object) = False) Moveint 0 To iLine
51532>>>>>        Set Value Item iLine To sVal
51533>>>>>    End_Procedure // Add_Line
51534>>>>>
51534>>>>>    //****************************************************************************
51534>>>>>    // $Module type: PROCEDURE
51534>>>>>    // $Module name: Show_Current_Directory
51534>>>>>    // $Author     : VOO
51534>>>>>    // Created     : 06-10-96 @ 15:24
51534>>>>>    //
51534>>>>>    // Description
51534>>>>>    //    This method will show the name of the current directory in the system
51534>>>>>    //    information box
51534>>>>>    //
51534>>>>>    // $Rev History
51534>>>>>    //    06-10-96  Module header created
51534>>>>>    //****************************************************************************
51534>>>>>    Procedure Show_Current_Directory
51535>>>>>        Local String sDir
51536>>>>>
51536>>>>>        Get_Current_Directory To sDir
51537>>>>>        Send Add_Line ("Current Directory: " + sDir)
51538>>>>>    End_Procedure // Show_Current_Directory
51539>>>>>
51539>>>>>    Procedure Show_Windows_Directory
51540>>>>>        Local String sWindir
51541>>>>>
51541>>>>>        Get_Windows_Directory To sWindir
51542>>>>>        Send Add_Line ("Windows Directory: " * sWindir)
51543>>>>>    End_Procedure // Show_Windows_Directory
51544>>>>>
51544>>>>>    Procedure Show_Current_User
51545>>>>>        Send Add_Line ("Network User Name: " * Network_User_Name (Current_Object))
51546>>>>>    End_Procedure // Show_Current_User
51547>>>>>
51547>>>>>    Procedure Show_Number_Format
51548>>>>>        Local Integer iFormat
51549>>>>>
51549>>>>>        Get_Attribute Df_Thousands_Separator To iFormat
51552>>>>>        Send Add_Line ('Thousands Separator: "' - Character (iFormat) - '" (' - String (iFormat) - ')')
51553>>>>>        Get_Number_Format To iFormat
51554>>>>>        Send Add_Line ('Decimal Separator: "' - If (iFormat = 0, '.', ',') - '"')
51555>>>>>    End_Procedure // Show_Number_Format
51556>>>>>
51556>>>>>    Procedure Show_Filelist_Name
51557>>>>>        Local String sFilename
51558>>>>>
51558>>>>>        Get_Attribute Df_Filelist_Name To sFilename
51561>>>>>        Send Add_Line ("Current Filelist: " * sFilename)
51562>>>>>    End_Procedure // Show_Filelist_Name
51563>>>>>
51563>>>>>    Procedure Show_Lock_Delay
51564>>>>>        Local Integer iLockdelay
51565>>>>>
51565>>>>>        Get_Attribute Df_Lock_Delay To iLockdelay
51568>>>>>        Send Add_Line ("Database Locking Delay: " * String (iLockdelay) * "Milliseconds")
51569>>>>>    End_Procedure // Show_Lock_Delay
51570>>>>>
51570>>>>>    Procedure Show_Lock_Timeout
51571>>>>>        Local Integer iLockTimeout
51572>>>>>
51572>>>>>        Get_Attribute Df_Lock_Timeout To iLockTimeout
51575>>>>>        Send Add_Line ("Database Locking Timeout: " * String (iLockTimeout) * "Milliseconds")
51576>>>>>    End_Procedure // Show_Lock_Timeout
51577>>>>>
51577>>>>>    Procedure Show_Screen_Size
51578>>>>>        Local Integer iYscreensize iXscreensize
51579>>>>>
51579>>>>>        Moveint (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
51580>>>>>>
51580>>>>>        Moveint (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
51581>>>>>>
51581>>>>>
51581>>>>>        Send Add_Line ("Video Resolution: " * String (iXscreensize) * "by" * String (iYscreensize))
51582>>>>>    End_Procedure // Show_Screen_Size
51583>>>>>
51583>>>>>    Procedure Show_Page_Size
51584>>>>>        Send Add_Line ("Page End: " * String (Pageend) * "Form Feed: " * String (Pagefeed))
51585>>>>>    End_procedure
51586>>>>>
51586>>>>>    Procedure Show_Date
51587>>>>>        Local Date dToday
51588>>>>>
51588>>>>>        Sysdate4 dToday
51589>>>>>        Send Add_Line ("Current System Date: " * String (dToday))
51590>>>>>    End_procedure // Show_Date
51591>>>>>
51591>>>>>    Procedure Show_Date_Format
51592>>>>>        Local Integer iDateFormat
51593>>>>>        Local String sDateFormat
51593>>>>>
51593>>>>>        Get_Attribute Df_Date_Format To iDateFormat
51596>>>>>        if iDateFormat Eq DF_DATE_USA ;            Movestr "USA" To sDateFormat
51599>>>>>        else if iDateformat Eq DF_DATE_EUROPEAN ;            Movestr "European" To sDateFormat
51603>>>>>        else if iDateformat Eq DF_DATE_MILITARY ;            Movestr "Military" To sDateFormat
51607>>>>>        else ;            Movestr "Unknown Date Type" To sDateFormat
51609>>>>>        Send Add_Line ("Date Format: " * sDateformat)
51610>>>>>    End_Procedure // Show_Date_Format
51611>>>>>
51611>>>>>    Procedure Show_Memavail
51612>>>>>        Local Integer iMem
51613>>>>>
51613>>>>>        Memory iMem
51614>>>>>>
51614>>>>>        Send Add_Line ("Available Memory: " * String (iMem))
51615>>>>>    End_Procedure // Show_Memavail
51616>>>>>
51616>>>>>    Procedure Show_Systemresources
51617>>>>>        Local String sMemoryStatus
51618>>>>>        Local Pointer lpsMemoryStatus
51618>>>>>        Local Integer iVoid
51618>>>>>        Local Dword dwMemoryLoad dwTotalPhys dwAvailPhys dwTotalPageFile dwAvailPageFile dwTotalVirtual dwAvailVirtual
51618>>>>>
51618>>>>>        ZeroType MEMORYSTATUS To sMemoryStatus
51619>>>>>        GetAddress Of sMemoryStatus To lpsMemoryStatus
51620>>>>>
51620>>>>>        Moveint (GlobalMemoryStatus (lpsMemoryStatus)) To iVoid
51621>>>>>>
51621>>>>>
51621>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwMemoryLoad    To dwMemoryLoad
51622>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPhys     To dwTotalPhys
51623>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPhys     To dwAvailPhys
51624>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPageFile To dwTotalPageFile
51625>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPageFile To dwAvailPageFile
51626>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalVirtual  To dwTotalVirtual
51627>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailVirtual  To dwAvailVirtual
51628>>>>>
51628>>>>>        Send Add_Line ("Current memory utilization:" * String (dwMemoryLoad))
51629>>>>>        Send Add_Line ("Percentage available physical memory:" * String (dwAvailPhys / dwTotalPhys * 100.0) - "%")
51630>>>>>        Send Add_Line ("Percentage available pagefile space:" * String (dwAvailPageFile / dwTotalPageFile * 100.0) - "%")
51631>>>>>        Send Add_Line ("Percentage available virtual memory:" * String (dwAvailVirtual / dwTotalVirtual * 100.0) - "%")
51632>>>>>    End_Procedure // Show_Systemresources
51633>>>>>
51633>>>>>    Procedure Show_Registration
51634>>>>>        Local String sRegName
51635>>>>>        Local Integer iSN
51635>>>>>        Registration sRegName iSN
51636>>>>>>
51636>>>>>
51636>>>>>        Send Add_Line ("Serial# : " + (String(iSN)))
51637>>>>>        Send Add_Line ("Reg Name: " + sRegName)
51638>>>>>
51638>>>>>    End_Procedure // Show_Current_Directory
51639>>>>>
51639>>>>>
51639>>>>>
51639>>>>>    //****************************************************************************
51639>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
51639>>>>>    // to the workspace object passing the an object and message to send back
51639>>>>>    // to this object. It is expected that the workspace object will send this
51639>>>>>    // message for every line of information it wants displayed (passing the
51639>>>>>    // information to be displayed
51639>>>>>    //****************************************************************************
51639>>>>>    register_procedure EnumerateWorkspaceData integer hObjId integer hmMessId
51639>>>>>    Procedure Show_WorkspaceInformation
51640>>>>>        If ghoWorkspace ;            Send EnumerateWorkspaceData to ghoWorkspace Current_object Msg_add_Line
51643>>>>>    End_Procedure
51644>>>>>
51644>>>>>    Function VersionStr integer iVer integer iRev integer iBld Returns string
51645>>>>>        Function_Return (string(iVer)-"."-string(iRev)-"."-string(iBld))
51646>>>>>    End_Function
51647>>>>>
51647>>>>>    Procedure Show_Versions
51648>>>>>        local integer iVersion iRevision iBuild
51649>>>>>        Version_information iVersion iRevision iBuild
51651>>>>>        Send Add_Line ("Runtime Version:" * VersionStr(self,iVersion,iRevision,iBuild) )
51652>>>>>        Send Add_Line ("Package Version:" * VersionStr(self,PKG_VERSION, PKG_REVISION, PKG_BUILD) )
51653>>>>>        Send Add_Line ("FMAC Version:"    * VersionStr(self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) )
51654>>>>>    End_Procedure
51655>>>>>
51655>>>>>
51655>>>>>    //***
51655>>>>>    //*** BW
51655>>>>>    //*** Procedure: Show_Drivers
51655>>>>>    //*** Purpose  : Show loaed database drivers
51655>>>>>    //***
51655>>>>>
51655>>>>>    Procedure Show_Drivers
51656>>>>>        Local String  Current_drvr
51657>>>>>        Local String  Loadeddrvrs
51657>>>>>        Local Integer Number_of_drvrs
51657>>>>>        Local Integer Count
51657>>>>>
51657>>>>>        Move "" To Loadeddrvrs
51658>>>>>        Get_attribute DF_NUMBER_DRIVERS To Number_of_drvrs
51661>>>>>        For Count From 1 To Number_of_drvrs
51667>>>>>>
51667>>>>>            Get_attribute DF_DRIVER_NAME Of Count To Current_drvr
51670>>>>>            If (Loadeddrvrs <> "") ;                Move (Append(Loadeddrvrs, ", ")) To Loadeddrvrs
51673>>>>>            Move (Append(Loadeddrvrs, Current_drvr)) To Loadeddrvrs
51674>>>>>        Loop
51675>>>>>>
51675>>>>>        Send Add_Line ("Database driver(s):" * Loadeddrvrs)
51676>>>>>    End_Procedure // Show_Drivers
51677>>>>>
51677>>>>>    //****************************************************************************
51677>>>>>    // $Module type: PROCEDURE
51677>>>>>    // $Module name: Add_Focus
51677>>>>>    // $Author     : VOO
51677>>>>>    // Created     : 24-09-96 @ 19:43
51677>>>>>    //
51677>>>>>    // Description
51677>>>>>    //    During activation we will remove the old information and add the newly
51677>>>>>    //    found systeminformation
51677>>>>>    //
51677>>>>>    // $Rev History
51677>>>>>    //    24-09-96  Module header created
51677>>>>>    //****************************************************************************
51677>>>>>    Procedure Add_Focus Integer hoRoot
51678>>>>>        Forward Send Add_Focus hoRoot
51680>>>>>
51680>>>>>        Send Delete_Data
51681>>>>>        Set Changed_State To False
51682>>>>>        Set Read_Only_State To True
51683>>>>>        Send Show_WorkSpaceInformation // added to show WS info
51684>>>>>        SEnd Show_Drivers
51685>>>>>        Send Show_Current_User
51686>>>>>        Send Show_Windows_Directory
51687>>>>>        Send Show_Current_Directory
51688>>>>>        Send Show_Filelist_Name
51689>>>>>        Send Show_Versions
51690>>>>>        Send Show_Memavail
51691>>>>>        Send Show_Screen_Size
51692>>>>>        Send Show_Page_Size
51693>>>>>        Send Show_Number_Format
51694>>>>>        Send Show_Date_Format
51695>>>>>        Send Show_Lock_Delay
51696>>>>>        Send Show_Lock_Timeout
51697>>>>>        Send Show_Date
51698>>>>>        Send Show_Systemresources
51699>>>>>        Send Show_Registration
51700>>>>>    End_Procedure // Show_All_Info
51701>>>>>
51701>>>>>End_Class // SysinfoDisplay
51702>>>>>
51702>>>>>
51702>>>>>//****************************************************************************
51702>>>>>// $Module type: OBJECT
51702>>>>>// $Module name: Sysinfo_Dialog
51702>>>>>// $Author     : VOO
51702>>>>>// Created     : 24-09-96 @ 18:47
51702>>>>>//
51702>>>>>// Description
51702>>>>>//    This object shows the systeminformation on the screen
51702>>>>>//
51702>>>>>// $Rev History
51702>>>>>//    24-09-96  Module header created
51702>>>>>//****************************************************************************
51702>>>>>Class SysInfoDialog Is A ModalPanel
51703>>>>>    Procedure Construct_Object
51704>>>>>        forward send construct_object
51706>>>>>
51706>>>>>        Set Caption_Bar To True
51707>>>>>        Set Sysmenu_Icon To True
51708>>>>>        Set Label To "System Information"
51709>>>>>        Set Size To 152 270
51710>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
51711>>>>>        Set Minimize_Icon To False
51712>>>>>        Set Maximize_Icon To False
51713>>>>>        Set Border_Style To Border_Dialog
51714>>>>>
51714>>>>>        Object Sysinfo_Display Is A SysInfoDisplay
51716>>>>>        End_Object
51717>>>>>
51717>>>>>        Object Close_Button Is A Button
51719>>>>>            Set Label to "&Close"
51720>>>>>            Set Location To 120 212
51721>>>>>            Set Message item 0 to msg_Close_Panel
51722>>>>>            Set default_action_button to current_object
51723>>>>>        End_Object // Close_Button
51724>>>>>
51724>>>>>        On_Key Kcancel       Send Close_Panel
51725>>>>>        On_Key Key_Alt+Key_C Send Close_Panel
51726>>>>>    End_procedure
51727>>>>>
51727>>>>>End_Class // SysinfoDialog
51728>>>>>
51728>>>>>// Purpose:
51728>>>>>//
51728>>>>>// Ken Ross 12/17/96 5:16PM
51728>>>>>//
51728>>>>>Class AboutDialog Is A ModalPanel
51729>>>>>
51729>>>>>    Procedure construct_object
51730>>>>>        String sVdfRootDir
51731>>>>>        forward send construct_object
51733>>>>>        Set Label to "About..."
51734>>>>>        Set Size to 100 217
51735>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
51736>>>>>
51736>>>>>        Object SysInfo_Dialog is a SysInfoDialog
51738>>>>>        End_Object
51739>>>>>
51739>>>>>        Object oBox is a Container3d
51741>>>>>            Set Border_Style to Border_StaticEdge
51742>>>>>            Set Size to 63 202
51743>>>>>            Set Location to 4 5
51744>>>>>
51744>>>>>            Object AboutGraphic is a BitmapContainer
51746>>>>>                Set Border_Style to Border_None
51747>>>>>                Set Bitmap_Style to Bitmap_Center
51748>>>>>                Set Size to 48 48
51749>>>>>                Set Location to 7 2
51750>>>>>            End_Object    // AboutGraphic
51751>>>>>
51751>>>>>            Object ProductName is a TextBox
51753>>>>>                Set label to "ProductName"
51754>>>>>                Set Size to 10 45
51755>>>>>                Set Location to 8 53
51756>>>>>            End_Object    // ProductName
51757>>>>>
51757>>>>>            Object Version is a TextBox
51759>>>>>                Set label to "Version"
51760>>>>>                Set Size to 10 25
51761>>>>>                Set Location to 21 53
51762>>>>>            End_Object    // Version
51763>>>>>
51763>>>>>            Object Copyright is a TextBox
51765>>>>>                Set label to "Copyright"
51766>>>>>                Set Size to 10 31
51767>>>>>                Set Location to 34 53
51768>>>>>            End_Object    // Copyright
51769>>>>>
51769>>>>>            Object Author is a TextBox
51771>>>>>                Set label to "Author"
51772>>>>>                Set Size to 10 22
51773>>>>>                Set Location to 46 53
51774>>>>>            End_Object    // Author
51775>>>>>
51775>>>>>        End_Object    // oBox
51776>>>>>
51776>>>>>        Object OK_bn is a Button
51778>>>>>            On_Item "&OK" Send Close_Panel
51779>>>>>            Set Size to 14 50
51780>>>>>            Set Location to 71 157
51781>>>>>        End_Object    // OK_bn
51782>>>>>
51782>>>>>        Object SysInfo_bn is a Button
51784>>>>>            On_Item "&System Info" Send Show_Sysinfo
51785>>>>>            Set Size to 14 50
51786>>>>>            Set Location to 71 101
51787>>>>>        End_Object    // SysInfo_bn
51788>>>>>
51788>>>>>        On_Key Kcancel Send KeyAction to (Ok_bn(Current_Object))
51789>>>>>        On_Key Key_Alt+Key_O Send KeyAction to (Ok_bn(Current_Object))
51790>>>>>        On_Key Key_Alt+Key_S Send KeyAction to (SysInfo_bn(Current_Object))
51791>>>>>
51791>>>>>        Get_Profile_String "Defaults" "VdfRootDir" To sVdfRootDir
51794>>>>>        Set logo to (sVdfRootDir +"\Bitmaps\DacAbout.bmp")  // square bitmaps of 42x42 work best
51795>>>>>
51795>>>>>    End_Procedure
51796>>>>>
51796>>>>>    Procedure set productname string sval
51797>>>>>        set label of (productname(oBox(current_object))) to sval
51798>>>>>    End_Procedure
51799>>>>>
51799>>>>>    Procedure set version string sval
51800>>>>>        set label of (version(oBox(current_object))) to sval
51801>>>>>    End_Procedure
51802>>>>>
51802>>>>>    Procedure set copyright string sval
51803>>>>>        set label of (copyright(oBox(current_object))) to sval
51804>>>>>    End_Procedure
51805>>>>>
51805>>>>>    Procedure set author string sval
51806>>>>>        set label of (author(oBox(current_object))) to sval
51807>>>>>    End_Procedure
51808>>>>>
51808>>>>>    // square bitmaps of 42x42 work best
51808>>>>>    //
51808>>>>>    Procedure set logo string sval
51809>>>>>        set bitmap of (aboutgraphic(oBox(current_object))) to sval
51810>>>>>    End_Procedure
51811>>>>>
51811>>>>>    Procedure Show_Sysinfo
51812>>>>>        Send Popup_Modal To (Sysinfo_Dialog(Current_Object))
51813>>>>>    End_Procedure // Show_Sysinfo
51814>>>>>
51814>>>>>End_Class
51815>>>>>
51815>>>>>
51815>>>>>//Object About_Dialog is an AboutDialog
51815>>>>>//    set productname to "Visual DataFlex"
51815>>>>>//    set version to "version 4.0"
51815>>>>>//    set copyright to "Copyright 1997 Data Access Corporation"
51815>>>>>//    set author to ""
51815>>>>>//    set logo to "ablogo.bmp"  // square bitmaps of 42x42 work best
51815>>>>>//End_Object
51815>>>>>
51815>>>>>//Procedure Activate_About
51815>>>>>//   Send Popup_Modal To (About_Dialog (Current_Object))
51815>>>>>//End_Procedure
51815>>>
51815>>>// *************************************************************************
51815>>>//  Public message. This is the default message. It is expected that you will
51815>>>//   create your own message to override this
51815>>>// *************************************************************************
51815>>>
51815>>>Procedure Activate_About
51817>>>   Send DoAbout "" "" "" "" "" ""
51818>>>End_Procedure
51819>>>
51819>>>// *************************************************************************
51819>>>//  Public message. It is expected that you will send this message (most
51819>>>//  likely from Activate_About. This creates an about object, activates it
51819>>>//  and destroys it when done. It is not exepected that you will augment this.
51819>>>// *************************************************************************
51819>>>
51819>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
51821>>>        Local integer hoObj hoMain
51822>>>
51822>>>        // create object
51822>>>        Object About is an AboutDialog
51824>>>            // if no title passed use the label of the main panel
51824>>>            // (if a main panel exists).
51824>>>            if sTitle     eq '' Begin
51826>>>                Get Main_Window to hoMain
51827>>>                if hoMain Get Label of hoMain to sTitle
51830>>>            end
51830>>>>
51830>>>            set productname to sTitle
51831>>>            set version     to sVersion
51832>>>            set copyright   to sCopyRight
51833>>>            set author      to sAuthor
51834>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
51837>>>            Move Current_Object to hoObj // object Id
51838>>>        End_Object
51839>>>        Send Popup to hoObj    // popup the about object
51840>>>        Send Request_Destroy_Object to hoObj // when done, it will be destroyed
51841>>>End_procedure
51842>    Use Tooltip.Inc
INCLUDING FILE: TOOLTIP.INC
51842>>>Use Tooltip.pkg
51842>>>
51842>>>object StandardToolTip is a StandardToolTip000
51844>>>    move (current_object) to DefaultTooltipHintID
51845>>>end_object
51846>>>
51846>>>object ToolTipTimer is a ToolTipTimer000
51848>>>    move (current_object) to TooltipControllerID
51849>>>end_object
51850>    
51850>    
51850>    
51850>    
51850>    //AB-PanelStoreEnd
51850>
51850>
51850>End_Object
51851>
51851>
51851>//AB-StoreStart
51851>
51851>set bitmap of (client_area(main(self))) to "protem1.bmp"
51852>Send DoStoreFileModeInfo to ghoFileModeInfo
51853>
51853>Start_UI
51854>
51854>
51854>
51854>
51854>//AB-StoreEnd
51854>
51854>
Summary
Memory Available: 2147483647
Total Errors   : 0
Total Symbols  : 27674
Total Resources: 0
Total Commands : 51853
Total Windows  : 1
Total Pages    : 1
Static Data    : 362414
Message area   : 282122
Total Blocks   : 16958
