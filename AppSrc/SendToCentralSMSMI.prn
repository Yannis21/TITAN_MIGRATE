Compiling Program: L:\VDF14.1.Dev\TITAN_MIGRATE\AppSrc\SendToCentralSMSMI.src
Memory Available: 2147483647
1>//------------------------------------------------------
1>//------------------------------------------------------
1>// 1. Ola ta MI... arxeia briskontai ston kentriko server se mia bash SMSMI
1>// 2. To programma ayto se VDF14 trexei stiw diafores perifereiakes monades
1>//    kai skanarei tis markarismenes eggrafes sthn topikh SMS bash
1>//    tis opoies stelnei sta MIxxxxx arxeia ston kentriko server.
1>//----
1>// 3. To proto login na einai PANTA to login ston server sthn topikh SMS bash
1>// 4. To deytero login tha exei kleidomeno to IP tou kentrikou Server sta INT/TD
1>//    kai to mono pou allazoume einai h bash, epilegontas thn SMSMI anti 
1>//    ths SMS tou protou login.
1>//----------------------
1>//----------------------
1>// Xrhsimopoioume pedia tou CN / MICN pou den prpei na peiraxtoun 
1>// giati xrhsmeyoun eite gia calculated pedia tou Tolh pou enhmerothikan
1>// meso script h gia tiw zones ton ergvn sto MICN afou den exoume sta 
1>// arxeia MI, oute Brabch oute CNZones klp....
1>//----------------------
1>// MICN.CN_VDETAILS         Perigrafh Zonhs (apo to arxeio zones)
1>// MICN.CN_CLIENTMATCH      Zonh ID (apo to arxeio Zones)
1>// MICN.CN_ZONE             Brzones.BRZONE_RECR
1>// MICN.CN_PUMPID           Excel Column AM Sales Office
1>// MICN.CN_PUMPLICENSE      Excel Column AT „¨š¦©«á© ¦ «¨¦­¦› ©å˜ª
1>//----------------------
1>//----------------------
1>//------------------------------------------------------
1>//------------------------------------------------------
1>
1>Use DFAllEnt.pkg
Using pre-compiled package DFALLENT.PKG
Including file: dfallent.pkd    (C:\Program Files\Visual DataFlex 14.1\Pkg\dfallent.pkd)
48529>Use cCJStandardCommandBarSystem.pkg
Including file: cCJStandardCommandBarSystem.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\cCJStandardCommandBarSystem.pkg)
48529>>>// these are all the packages used in a standard MDI menubar/toolbar system
48529>>>
48529>>>Use cCJCommandBarSystem.pkg
48529>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\cCJStandardMenuItemClasses.pkg)
48529>>>>>Use Dfpanel.pkg
48529>>>>>Use cCJCommandBarSystem.pkg
48529>>>>>Use LanguageText.pkg
48529>>>>>
48529>>>>>
48529>>>>>Class cCJUndoMenuItem is a cCJMenuItem
48530>>>>>    
48530>>>>>    Procedure Construct_Object
48532>>>>>        Forward Send Construct_Object
48534>>>>>        Set psCaption   to C_$CaptionUndo
48535>>>>>        Set psToolTip to C_$ToolTipUndo
48536>>>>>        Set psDescription to C_$DescUndo
48537>>>>>        Set psImage to "ActionUndo.ico"
48538>>>>>        Set pbActiveUpdate to True
48539>>>>>        Set psCategory to C_$CategoryEdit
48540>>>>>        Set psShortcut to C_$Key_Ctrl_Z
48541>>>>>    End_Procedure
48542>>>>>
48542>>>>>    Procedure OnExecute Variant vCommandBarControl
48544>>>>>        Send Undo of (focus(Self))
48545>>>>>    End_Procedure
48546>>>>>    
48546>>>>>    Function IsEnabled Returns Boolean
48548>>>>>        Boolean bEnabled
48548>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
48549>>>>>        Function_Return bEnabled
48550>>>>>    End_Function
48551>>>>>         
48551>>>>>End_Class
48552>>>>>
48552>>>>>
48552>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
48553>>>>>    
48553>>>>>    Procedure Construct_Object
48555>>>>>        Forward Send Construct_Object
48557>>>>>        Set psCaption   to C_$CaptionDelete
48558>>>>>        Set psToolTip to C_$ToolTipDelete
48559>>>>>        Set psDescription to C_$DescDelete
48560>>>>>        Set psImage to "actionDelete.ico"
48561>>>>>        Set psShortcut to C_$Key_Delete
48562>>>>>        Set pbActiveUpdate to True
48563>>>>>        Set psCategory to C_$CategoryEdit
48564>>>>>    End_Procedure
48565>>>>>
48565>>>>>
48565>>>>>    Procedure OnExecute Variant vCommandBarControl
48567>>>>>        Send Delete of (focus(Self))
48568>>>>>    End_Procedure
48569>>>>>    
48569>>>>>    Function IsEnabled Returns Boolean
48571>>>>>        Boolean bEnabled
48571>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
48572>>>>>        Function_Return bEnabled
48573>>>>>    End_Function
48574>>>>>         
48574>>>>>End_Class
48575>>>>>
48575>>>>>
48575>>>>>Class cCJCutMenuItem is a cCJMenuItem
48576>>>>>    
48576>>>>>    Procedure Construct_Object
48578>>>>>        Forward Send Construct_Object
48580>>>>>        Set psCaption   to C_$CaptionCut
48581>>>>>        Set psToolTip to C_$TooltipCut
48582>>>>>        Set psDescription to C_$DescCut
48583>>>>>        Set psImage to "actionCut.ico"
48584>>>>>        Set psShortcut to C_$Key_Ctrl_X
48585>>>>>        Set pbActiveUpdate to True
48586>>>>>        Set psCategory to C_$CategoryEdit
48587>>>>>    End_Procedure
48588>>>>>
48588>>>>>
48588>>>>>    Procedure OnExecute Variant vCommandBarControl
48590>>>>>        Send Cut of (focus(Self))
48591>>>>>    End_Procedure
48592>>>>>    
48592>>>>>    Function IsEnabled Returns Boolean
48594>>>>>        Boolean bEnabled
48594>>>>>        Get CanCut of (Focus(Self)) to bEnabled
48595>>>>>        Function_Return bEnabled
48596>>>>>    End_Function
48597>>>>>         
48597>>>>>End_Class
48598>>>>>
48598>>>>>
48598>>>>>Class cCJCopyMenuItem is a cCJMenuItem
48599>>>>>    
48599>>>>>    Procedure Construct_Object
48601>>>>>        Forward Send Construct_Object
48603>>>>>        Set psCaption   to C_$CaptionCopy
48604>>>>>        Set psToolTip to C_$ToolTipCopy
48605>>>>>        Set psDescription to C_$DescCopy
48606>>>>>        Set psImage to "actionCopy.ico"
48607>>>>>        Set psShortcut to C_$Key_Ctrl_C
48608>>>>>        Set pbActiveUpdate to True
48609>>>>>        Set psCategory to C_$CategoryEdit
48610>>>>>    End_Procedure
48611>>>>>
48611>>>>>
48611>>>>>    Procedure OnExecute Variant vCommandBarControl
48613>>>>>        Send Copy of (focus(Self))
48614>>>>>    End_Procedure
48615>>>>>    
48615>>>>>    Function IsEnabled Returns Boolean
48617>>>>>        Boolean bEnabled
48617>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
48618>>>>>        Function_Return bEnabled
48619>>>>>    End_Function
48620>>>>>         
48620>>>>>End_Class
48621>>>>>
48621>>>>>
48621>>>>>Class cCJPasteMenuItem is a cCJMenuItem
48622>>>>>    
48622>>>>>    Procedure Construct_Object
48624>>>>>        Forward Send Construct_Object
48626>>>>>        Set psCaption   to C_$CaptionPaste
48627>>>>>        Set psToolTip to C_$ToolTipPaste
48628>>>>>        Set psDescription to C_$DescPaste
48629>>>>>        Set psImage to "actionPaste.ico"
48630>>>>>        Set pbActiveUpdate to True
48631>>>>>        Set psShortcut to C_$Key_Ctrl_V
48632>>>>>        Set psCategory to C_$CategoryEdit
48633>>>>>    End_Procedure
48634>>>>>
48634>>>>>
48634>>>>>    Procedure OnExecute Variant vCommandBarControl
48636>>>>>        Send Paste of (focus(Self))
48637>>>>>    End_Procedure
48638>>>>>    
48638>>>>>    Function IsEnabled Returns Boolean
48640>>>>>        Boolean bEnabled
48640>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
48641>>>>>        Function_Return bEnabled
48642>>>>>    End_Function
48643>>>>>         
48643>>>>>End_Class
48644>>>>>
48644>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
48645>>>>>    
48645>>>>>    Procedure Construct_Object
48647>>>>>        Forward Send Construct_Object
48649>>>>>        Set psCaption   to C_$CaptionSelectAll
48650>>>>>        Set psToolTip to C_$ToolTipSelectAll
48651>>>>>        Set psDescription to C_$DescSelectAll
48652>>>>>        Set pbActiveUpdate to True
48653>>>>>        Set psShortcut to C_$Key_Ctrl_A
48654>>>>>        Set psCategory to C_$CategoryEdit
48655>>>>>    End_Procedure
48656>>>>>
48656>>>>>
48656>>>>>    Procedure OnExecute Variant vCommandBarControl
48658>>>>>        Send Select_All of (focus(Self))
48659>>>>>    End_Procedure
48660>>>>>    
48660>>>>>    Function IsEnabled Returns Boolean
48662>>>>>        Boolean bEnabled
48662>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
48663>>>>>        Function_Return bEnabled
48664>>>>>    End_Function
48665>>>>>         
48665>>>>>End_Class
48666>>>>>
48666>>>>> 
48666>>>>>Class cCJExitMenuItem is a cCJMenuItem
48667>>>>>
48667>>>>>    Procedure Construct_Object
48669>>>>>        Forward Send Construct_Object
48671>>>>>        Set psCaption to C_$CaptionExit
48672>>>>>        Set psToolTip to C_$ToolTipExit
48673>>>>>        Set psDescription to C_$ToolTipExit
48674>>>>>        Set psShortcut to C_$Key_Alt_F4
48675>>>>>        Set psCategory to C_$CategoryFile
48676>>>>>    End_Procedure
48677>>>>>
48677>>>>>    Procedure OnExecute Variant vCommandBarControl
48679>>>>>        Send Exit_Application of Desktop
48680>>>>>    End_Procedure
48681>>>>>
48681>>>>>End_Class           
48682>>>>>
48682>>>>>Class cCJHelpMenuItem is a cCJMenuItem    
48683>>>>>
48683>>>>>    Procedure Construct_Object
48685>>>>>        Forward Send Construct_Object
48687>>>>>        Set psCaption to C_$CaptionHelp
48688>>>>>        Set psDescription to C_$ToolTipHelp
48689>>>>>        Set psToolTip to C_$DescHelp
48690>>>>>        Set psImage to "ActionHelp.ico"
48691>>>>>        Set psShortcut to "F1"
48692>>>>>        Set psCategory to C_$CategoryHelp
48693>>>>>    End_Procedure
48694>>>>>    
48694>>>>>    Procedure OnExecute Variant vCommandBarControl
48696>>>>>        Send Help of (Focus(Self))
48697>>>>>    End_Procedure
48698>>>>>
48698>>>>>End_Class
48699>>>>>
48699>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
48700>>>>>
48700>>>>>    Procedure Construct_Object
48702>>>>>        Forward Send Construct_Object
48704>>>>>        Set psCaption to C_$CaptionAddStatusbar
48705>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
48706>>>>>        Set psDescription to  C_$DescAddStatusbar
48707>>>>>        Set psCategory to C_$CategoryWindow
48708>>>>>    End_Procedure
48709>>>>>
48709>>>>>    Procedure OnExecute Variant vCommandBarControl
48711>>>>>        Handle hoCommandBars hoClientArea
48711>>>>>        Get CommandBarSystemObject to hoCommandBars
48712>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48713>>>>>        If hoClientArea Begin
48715>>>>>            // the clientarea's parent panel has message
48715>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
48716>>>>>        End
48716>>>>>>
48716>>>>>    End_Procedure
48717>>>>>
48717>>>>>     Function IsChecked Returns Boolean
48719>>>>>        Boolean bOn
48719>>>>>        Handle hoCommandBars hoClientArea
48719>>>>>        Get CommandBarSystemObject to hoCommandBars
48720>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48721>>>>>        If hoClientArea Begin
48723>>>>>            // the clientarea's parent panel has message
48723>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
48724>>>>>        End
48724>>>>>>
48724>>>>>        Function_Return bOn
48725>>>>>     End_Function
48726>>>>>End_Class
48727>>>>>
48727>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
48728>>>>>
48728>>>>>    Procedure Construct_Object
48730>>>>>        Forward Send Construct_Object
48732>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
48733>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
48734>>>>>        Set psDescription to C_$DescAutoArrangeIcons
48735>>>>>        Set psCategory to C_$CategoryWindow
48736>>>>>    End_Procedure
48737>>>>>
48737>>>>>    Procedure OnExecute Variant vCommandBarControl
48739>>>>>        Handle hoCommandBars hoClientArea
48739>>>>>        Get CommandBarSystemObject to hoCommandBars
48740>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48741>>>>>        If hoClientArea Begin
48743>>>>>            // the clientarea's parent panel has message
48743>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
48744>>>>>        End
48744>>>>>>
48744>>>>>    End_Procedure
48745>>>>>    
48745>>>>>     Function IsChecked Returns Boolean
48747>>>>>        Boolean bOn
48747>>>>>        Handle hoCommandBars hoClientArea
48747>>>>>        Get CommandBarSystemObject to hoCommandBars
48748>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48749>>>>>        If hoClientArea Begin
48751>>>>>            // the clientarea's parent panel has message
48751>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
48752>>>>>        End
48752>>>>>>
48752>>>>>        Function_Return bOn
48753>>>>>     End_Function
48754>>>>>End_Class
48755>>>>>
48755>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
48756>>>>>
48756>>>>>    Procedure Construct_Object
48758>>>>>        Forward Send Construct_Object
48760>>>>>        Set psCaption to C_$CaptionRestoreMenus
48761>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
48762>>>>>        Set psDescription to C_$DescRestoreMenus
48763>>>>>        Set psCategory to C_$CategoryWindow
48764>>>>>    End_Procedure
48765>>>>>
48765>>>>>    Procedure OnExecute Variant vCommandBarControl
48767>>>>>        Handle hoCommandBars
48767>>>>>        Get CommandBarSystemObject to hoCommandBars
48768>>>>>        Send RestoreLayout of hoCommandBars
48769>>>>>    End_Procedure
48770>>>>>    
48770>>>>>End_Class
48771>>>>>
48771>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
48772>>>>>
48772>>>>>    Procedure Construct_Object
48774>>>>>        Forward Send Construct_Object
48776>>>>>        Set psCaption to C_$CaptionCascade
48777>>>>>        Set psToolTip to C_$ToolTipCascade
48778>>>>>        Set psDescription to  C_$DescCascade
48779>>>>>        Set psImage to "ActionCascade.ico"
48780>>>>>        Set psCategory to C_$CategoryWindow
48781>>>>>    End_Procedure
48782>>>>>    
48782>>>>>    Procedure OnExecute Variant vCommandBarControl
48784>>>>>        Handle hoCommandBars hoClientArea
48784>>>>>        Get CommandBarSystemObject to hoCommandBars
48785>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48786>>>>>        If hoClientArea Begin
48788>>>>>            Send Cascade_Windows of hoClientArea
48789>>>>>        End
48789>>>>>>
48789>>>>>    End_Procedure
48790>>>>>End_Class
48791>>>>>
48791>>>>>Class cCJTileHorizontally is a cCJMenuItem
48792>>>>>
48792>>>>>    Procedure Construct_Object
48794>>>>>        Forward Send Construct_Object
48796>>>>>        Set psCaption to C_$CaptionTileHorizontally 
48797>>>>>        Set psToolTip to C_$ToolTipTileHorizontally  
48798>>>>>        Set psDescription to  C_$DescTileHorizontally
48799>>>>>        Set psImage to "ActionTileHorizontally.ico"
48800>>>>>        Set psCategory to C_$CategoryWindow
48801>>>>>    End_Procedure
48802>>>>>
48802>>>>>    Procedure OnExecute Variant vCommandBarControl
48804>>>>>        Handle hoCommandBars hoClientArea
48804>>>>>        Get CommandBarSystemObject to hoCommandBars
48805>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48806>>>>>        If hoClientArea Begin
48808>>>>>            Send Tile_Windows_Horizontal of hoClientArea
48809>>>>>        End
48809>>>>>>
48809>>>>>    End_Procedure
48810>>>>>End_Class
48811>>>>>
48811>>>>>Class cCJTileVertically is a cCJMenuItem
48812>>>>>
48812>>>>>    Procedure Construct_Object
48814>>>>>        Forward Send Construct_Object
48816>>>>>        Set psCaption to C_$CaptionTileVertically  
48817>>>>>        Set psToolTip to C_$ToolTipTileVertically
48818>>>>>        Set psDescription to  C_$DescTileVertically
48819>>>>>        Set psImage to "ActionTileVertically.ico"
48820>>>>>        Set psCategory to C_$CategoryWindow
48821>>>>>    End_Procedure
48822>>>>>
48822>>>>>    Procedure OnExecute Variant vCommandBarControl
48824>>>>>        Handle hoCommandBars hoClientArea
48824>>>>>        Get CommandBarSystemObject to hoCommandBars
48825>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48826>>>>>        If hoClientArea Begin
48828>>>>>            Send Tile_Windows_Vertical of hoClientArea
48829>>>>>        End
48829>>>>>>
48829>>>>>    End_Procedure
48830>>>>>End_Class
48831>>>>>
48831>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
48832>>>>>
48832>>>>>    Procedure Construct_Object
48834>>>>>        Forward Send Construct_Object
48836>>>>>        Set psCaption to C_$CaptionMinimizeWindows 
48837>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
48838>>>>>        Set psDescription to  C_$DescMinimizeWindows
48839>>>>>        Set psCategory to C_$CategoryWindow
48840>>>>>    End_Procedure
48841>>>>>
48841>>>>>    Procedure OnExecute Variant vCommandBarControl
48843>>>>>        Handle hoCommandBars hoClientArea
48843>>>>>        Get CommandBarSystemObject to hoCommandBars
48844>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48845>>>>>        If hoClientArea Begin
48847>>>>>            // the clientarea's parent panel has message
48847>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
48848>>>>>        End
48848>>>>>>
48848>>>>>    End_Procedure
48849>>>>>End_Class
48850>>>>>
48850>>>>>
48850>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
48851>>>>>
48851>>>>>    Procedure Construct_Object
48853>>>>>        Forward Send Construct_Object
48855>>>>>        Set psCaption to C_$CaptionRestoreWindows
48856>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
48857>>>>>        Set psDescription to  C_$DescRestoreWindows
48858>>>>>        Set psCategory to C_$CategoryWindow
48859>>>>>    End_Procedure
48860>>>>>
48860>>>>>    Procedure OnExecute Variant vCommandBarControl
48862>>>>>        Handle hoCommandBars hoClientArea
48862>>>>>        Get CommandBarSystemObject to hoCommandBars
48863>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48864>>>>>        If hoClientArea Begin
48866>>>>>            // the clientarea's parent panel has message
48866>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
48867>>>>>        End
48867>>>>>>
48867>>>>>    End_Procedure
48868>>>>>End_Class
48869>>>>>
48869>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
48870>>>>>
48870>>>>>    Procedure Construct_Object
48872>>>>>        Forward Send Construct_Object
48874>>>>>        Set psCaption to C_$CaptionArrangeIcons  
48875>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
48876>>>>>        Set psDescription to  C_$DescArrangeIcons
48877>>>>>        Set psCategory to C_$CategoryWindow
48878>>>>>    End_Procedure
48879>>>>>
48879>>>>>    Procedure OnExecute Variant vCommandBarControl
48881>>>>>        Handle hoCommandBars hoClientArea
48881>>>>>        Get CommandBarSystemObject to hoCommandBars
48882>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48883>>>>>        If hoClientArea Begin
48885>>>>>            Send Arrange_Icons of hoClientArea
48886>>>>>        End
48886>>>>>>
48886>>>>>    End_Procedure
48887>>>>>
48887>>>>>End_Class
48888>>>>>    
48888>>>Use cCJAboutMenuItem.pkg
Including file: cCJAboutMenuItem.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\cCJAboutMenuItem.pkg)
48888>>>>>Use cCJCommandBarSystem.pkg
48888>>>>>Use LanguageText.pkg
48888>>>>>
48888>>>>>// It is expected that if you use this class that you provide an about object that is
48888>>>>>// activated via activate_about such as DfAbout.pkg. We don't use this for you automatically
48888>>>>>// because you may wish to create your own custom about package.
48888>>>>>
48888>>>>>Class cCJAboutMenuItem is a cCJMenuItem    
48889>>>>>
48889>>>>>    Procedure Construct_Object
48891>>>>>        Forward Send Construct_Object
48893>>>>>        Set psCaption to C_$CaptionAbout
48894>>>>>        Set psDescription to C_$ToolTipAbout
48895>>>>>        Set psToolTip to C_$DescAbout
48896>>>>>        Set psImage to "ActionAbout.ico"
48897>>>>>        Set psCategory to C_$CategoryHelp
48898>>>>>    End_Procedure
48899>>>>>    
48899>>>>>    Procedure OnExecute Variant vCommandBarControl
48901>>>>>        Handle hoCommandBars hoClientArea
48901>>>>>        Get CommandBarSystemObject to hoCommandBars
48902>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48903>>>>>        If hoClientArea Begin
48905>>>>>            Send Activate_About of hoClientArea
48906>>>>>        End
48906>>>>>>
48906>>>>>    End_Procedure
48907>>>>>
48907>>>>>End_Class
48908>>>>>
48908>>>>>
48908>>>Use cCJDeoMenuItemClasses.pkg
Including file: cCJDeoMenuItemClasses.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\cCJDeoMenuItemClasses.pkg)
48908>>>>>// various DEO menu classes
48908>>>>>
48908>>>>>Use cCJCommandBarSystem.pkg
48908>>>>>Use LanguageText.pkg
48908>>>>>
48908>>>>>// Sub-class for all Date entry menu items
48908>>>>>
48908>>>>>Class cCJDeoMenuItem is a cCJMenuItem
48909>>>>>    
48909>>>>>    Procedure Construct_Object
48911>>>>>        Forward Send Construct_Object
48913>>>>>        Set psCategory to C_$CategoryDEO
48914>>>>>        Set pbActiveUpdate to True
48915>>>>>    End_Procedure
48916>>>>>
48916>>>>>    // This just redirects to cCJCommandBarsSystem object
48916>>>>>    // returns information about the Focus object. If it returns True its a DEO. If a DEO the
48916>>>>>    // server, hasRecord, changed and hasindex info will all be returned by ref.
48916>>>>>    // If false, these are all unchanged.
48916>>>>>    Function DEOInformation Handle ByRef hoServer Boolean ByRef bHasRecord Boolean ByRef bChanged Boolean ByRef bHasIndex Returns Boolean
48918>>>>>        Handle hoCommandBars
48918>>>>>        Boolean bISDeo
48918>>>>>        Get CommandBarSystemObject to hoCommandBars // must exist or a programming bug
48919>>>>>        Get DEOInformation of hoCommandBars (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDEO
48920>>>>>        Function_Return bISDeo        
48921>>>>>    End_Function
48922>>>>>
48922>>>>>End_Class
48923>>>>>
48923>>>>>// use by all navigate DEOs.
48923>>>>>
48923>>>>>Class cCJDEONavigateMenuItem is a cCJDeoMenuItem
48924>>>>>    Procedure Construct_Object
48926>>>>>        Forward Send Construct_Object
48928>>>>>        Set psCategory to C_$CategoryNavigate
48929>>>>>    End_Procedure
48930>>>>>    
48930>>>>>    Function IsEnabled Returns Boolean
48932>>>>>        Boolean bIsDEO bHasRecord bChanged bEnabled bHasIndex
48932>>>>>        Handle hoServer
48932>>>>>        Get DEOInformation (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDeo
48933>>>>>        Function_Return (bIsDEO)
48934>>>>>    End_Function
48935>>>>>         
48935>>>>>End_Class         
48936>>>>>
48936>>>>>
48936>>>>>Class cCJClearMenuItem is a cCJDeoMenuItem
48937>>>>>    
48937>>>>>    Procedure Construct_Object
48939>>>>>        Forward Send Construct_Object
48941>>>>>        Set psCaption   to C_$CaptionClear
48942>>>>>        Set psToolTip to C_$ToolTipClear
48943>>>>>        Set psDescription to C_$DescClear
48944>>>>>        Set psImage to "ActionClear.ico"
48945>>>>>        Set psShortcut to "F5"
48946>>>>>    End_Procedure
48947>>>>>
48947>>>>>
48947>>>>>    Procedure OnExecute Variant vCommandBarControl
48949>>>>>        Send Request_Clear of (focus(Self))
48950>>>>>    End_Procedure
48951>>>>>    
48951>>>>>    Function IsEnabled Returns Boolean
48953>>>>>        Boolean bIsDEO bHasRecord bChanged bEnabled bHasIndex
48953>>>>>        Handle hoServer
48953>>>>>        Get DEOInformation (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDeo
48954>>>>>        Function_Return (bIsDEO and hoServer and (bChanged or bHasRecord))
48955>>>>>    End_Function
48956>>>>>         
48956>>>>>End_Class         
48957>>>>>
48957>>>>>
48957>>>>>Class cCJClearAllMenuItem is a cCJDeoMenuItem
48958>>>>>    
48958>>>>>    Procedure Construct_Object
48960>>>>>        Forward Send Construct_Object
48962>>>>>        Set psCaption   to C_$CaptionClearAll
48963>>>>>        Set psToolTip to C_$ToolTipClearAll
48964>>>>>        Set psDescription to C_$DescClearAll
48965>>>>>        Set psImage to "ActionClearAll.ico"
48966>>>>>        Set psShortcut to C_$Key_Ctrl_F5
48967>>>>>    End_Procedure
48968>>>>>
48968>>>>>    Procedure OnExecute Variant vCommandBarControl
48970>>>>>        Send Request_Clear_All of (focus(Self))
48971>>>>>    End_Procedure
48972>>>>>    
48972>>>>>    Function IsEnabled Returns Boolean
48974>>>>>        Boolean bIsDEO bHasRecord bChanged bEnabled bHasIndex
48974>>>>>        Handle hoServer
48974>>>>>        Get DEOInformation (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDeo
48975>>>>>        Function_Return (bIsDEO and hoServer and (bChanged or bHasRecord))
48976>>>>>    End_Function
48977>>>>>    
48977>>>>>End_Class         
48978>>>>>
48978>>>>>
48978>>>>>
48978>>>>>Class cCJSaveMenuItem is a cCJDeoMenuItem
48979>>>>>    
48979>>>>>    Procedure Construct_Object
48981>>>>>        Forward Send Construct_Object
48983>>>>>        Set psCaption   to C_$CaptionSave
48984>>>>>        Set psToolTip to C_$ToolTipSave
48985>>>>>        Set psDescription to C_$DescSave
48986>>>>>        Set psImage to "ActionSaveRecord.ico"
48987>>>>>        Set psShortcut to "F2"
48988>>>>>    End_Procedure
48989>>>>>
48989>>>>>
48989>>>>>    Procedure OnExecute Variant vCommandBarControl
48991>>>>>        Send Request_save of (focus(Self))
48992>>>>>    End_Procedure
48993>>>>>    
48993>>>>>    Function IsEnabled Returns Boolean
48995>>>>>        Boolean bIsDEO bHasRecord bChanged bEnabled bHasIndex
48995>>>>>        Handle hoServer
48995>>>>>        Get DEOInformation (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDeo
48996>>>>>        Function_Return (bIsDEO and hoServer and bChanged)
48997>>>>>    End_Function
48998>>>>>         
48998>>>>>End_Class         
48999>>>>>
48999>>>>>
48999>>>>>Class cCJSaveNCMenuItem is a cCJDeoMenuItem
49000>>>>>
49000>>>>>    Procedure Construct_Object
49002>>>>>        Forward Send Construct_Object
49004>>>>>        Set psCaption   to C_$CaptionSaveNC
49005>>>>>        Set psToolTip to C_$ToolTipSaveNC
49006>>>>>        Set psDescription to C_$DescSaveNC
49007>>>>>        Set psImage to "ActionSave.ico"
49008>>>>>        Set psShortcut to "F12"
49009>>>>>    End_Procedure
49010>>>>>
49010>>>>>    Procedure OnExecute Variant vCommandBarControl
49012>>>>>        Send Request_save_No_Clear of (focus(Self))
49013>>>>>    End_Procedure
49014>>>>>
49014>>>>>    Function IsEnabled Returns Boolean
49016>>>>>        Boolean bIsDEO bHasRecord bChanged bEnabled bHasIndex
49016>>>>>        Handle hoServer
49016>>>>>        Get DEOInformation (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDeo
49017>>>>>        Function_Return (bIsDEO and hoServer and bChanged)
49018>>>>>    End_Function
49019>>>>>
49019>>>>>End_Class
49020>>>>>
49020>>>>>
49020>>>>>
49020>>>>>Class cCJDeleteMenuItem is a cCJDeoMenuItem
49021>>>>>
49021>>>>>    Procedure Construct_Object
49023>>>>>        Forward Send Construct_Object
49025>>>>>        Set psCaption   to C_$CaptionDeleteRec
49026>>>>>        Set psToolTip to C_$ToolTipDeleteRec
49027>>>>>        Set psDescription to C_$DescDeleteRec
49028>>>>>        Set psImage to "ActionDeleteRecord.ico"
49029>>>>>        Set psShortcut to C_$Key_Shift_F2
49030>>>>>    End_Procedure
49031>>>>>
49031>>>>>    Procedure OnExecute Variant vCommandBarControl
49033>>>>>        Send Request_Delete of (focus(Self))
49034>>>>>    End_Procedure
49035>>>>>
49035>>>>>    Function IsEnabled Returns Boolean
49037>>>>>        Boolean bIsDEO bHasRecord bChanged bEnabled bHasIndex
49037>>>>>        Handle hoServer
49037>>>>>        Get DEOInformation (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDeo
49038>>>>>        Function_Return (bIsDEO and hoServer and bHasRecord)
49039>>>>>    End_Function
49040>>>>>
49040>>>>>End_Class
49041>>>>>
49041>>>>>
49041>>>>>Class cCJPromptMenuItem is a cCJDeoMenuItem
49042>>>>>     Procedure Construct_Object
49044>>>>>        Forward Send Construct_Object
49046>>>>>        Set psCaption   to C_$CaptionPrompt
49047>>>>>        Set psToolTip to C_$ToolTipPrompt
49048>>>>>        Set psDescription to C_$DescPrompt
49049>>>>>        Set psImage to "ActionPrompt.Ico"
49050>>>>>        Set psShortcut to "F4"
49051>>>>>    End_Procedure
49052>>>>>
49052>>>>>    Procedure OnExecute Variant vCommandBarControl
49054>>>>>        Send Prompt of (focus(Self))
49055>>>>>    End_Procedure
49056>>>>>
49056>>>>>    Function IsEnabled Returns Boolean
49058>>>>>        Handle hoFocus hoPrompt
49058>>>>>        Integer iDelegate
49058>>>>>        Get Focus to hoFocus
49059>>>>>        If (hoFocus>Desktop) Begin
49061>>>>>            Get Delegation_mode of hoFocus to iDelegate
49062>>>>>            Set Delegation_mode of hoFocus to No_Delegate_or_Error
49063>>>>>            Get Prompt_object   of hoFocus to hoPrompt
49064>>>>>            Set Delegation_mode of hoFocus to iDelegate
49065>>>>>        End
49065>>>>>>
49065>>>>>        Function_Return (hoPrompt<>0)
49066>>>>>    End_Function
49067>>>>>   
49067>>>>>End_Class
49068>>>>>
49068>>>>>
49068>>>>>Class cCJZoomMenuItem is a cCJDeoMenuItem
49069>>>>>     Procedure Construct_Object
49071>>>>>        Forward Send Construct_Object
49073>>>>>        Set psCaption   to C_$CaptionZoom
49074>>>>>        Set psToolTip to C_$ToolTipZoom
49075>>>>>        Set psDescription to C_$DescZoom
49076>>>>>        Set psShortcut to C_$Key_Alt_F9
49077>>>>>    End_Procedure
49078>>>>>
49078>>>>>    Procedure OnExecute Variant vCommandBarControl
49080>>>>>        Send Zoom of (focus(Self))
49081>>>>>    End_Procedure
49082>>>>>    
49082>>>>>    Function IsEnabled Returns Boolean
49084>>>>>        Handle hoFocus hoZoom 
49084>>>>>        Integer iDelegate
49084>>>>>        Get Focus to hoFocus
49085>>>>>        If (hoFocus>Desktop) Begin
49087>>>>>            Get Delegation_mode of hoFocus to iDelegate
49088>>>>>            Set Delegation_mode of hoFocus to No_Delegate_or_Error
49089>>>>>            Get Zoom_object   of hoFocus to hoZoom
49090>>>>>            Set Delegation_mode of hoFocus to iDelegate
49091>>>>>        End
49091>>>>>>
49091>>>>>        Function_Return (hoZoom<>0)
49092>>>>>    End_Function
49093>>>>>   
49093>>>>>End_Class
49094>>>>>
49094>>>>>
49094>>>>>Class cCJFindMenuItem is a cCJDeoMenuItem
49095>>>>>    
49095>>>>>    Procedure Construct_Object
49097>>>>>        Forward Send Construct_Object
49099>>>>>        Set psCaption   to C_$CaptionFindGE
49100>>>>>        Set psToolTip to C_$ToolTipFindGE
49101>>>>>        Set psDescription to C_$DescFindGE
49102>>>>>        Set psImage to "ActionFindEq.ico"
49103>>>>>        Set psShortcut to "F9"
49104>>>>>        
49104>>>>>    End_Procedure
49105>>>>>
49105>>>>>    Procedure OnExecute Variant vCommandBarControl
49107>>>>>        Send Find_GE of (focus(Self)) 
49108>>>>>    End_Procedure
49109>>>>>    
49109>>>>>    Function IsEnabled Returns Boolean
49111>>>>>        Boolean bIsDEO bHasRecord bChanged bEnabled bHasIndex bIsFind
49111>>>>>        Handle hoServer hoFocus hoCommandBars
49111>>>>>        Get DEOInformation (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDeo
49112>>>>>        If (bIsDEO and hoServer and bHasIndex) Begin
49114>>>>>            // if it is a candidate for finding we must check if this supports the DEO Find protocol
49114>>>>>            Get Focus of desktop to hoFocus
49115>>>>>            Get CommandBarSystemObject to hoCommandBars // must exist or a programming bug
49116>>>>>            Get Is_Function of hoCommandBars Get_Deo_Find_Object hoFocus True to bIsFind
49117>>>>>            Function_Return bIsFind
49118>>>>>        End
49118>>>>>>
49118>>>>>        Function_Return False
49119>>>>>    End_Function
49120>>>>>         
49120>>>>>End_Class         
49121>>>>>
49121>>>>>
49121>>>>>Class cCJFindNextMenuItem is a cCJFindMenuItem
49122>>>>>    
49122>>>>>    Procedure Construct_Object
49124>>>>>        Forward Send Construct_Object
49126>>>>>        Set psCaption   to C_$CaptionFindGT
49127>>>>>        Set psToolTip to C_$ToolTipFindGT
49128>>>>>        Set psDescription to C_$DescFindGT
49129>>>>>        Set psImage to "ActionNext.ico"
49130>>>>>        Set psShortcut to "F8"
49131>>>>>    End_Procedure
49132>>>>>
49132>>>>>    Procedure OnExecute Variant vCommandBarControl
49134>>>>>        Send Find_Next of (focus(Self)) 
49135>>>>>    End_Procedure
49136>>>>>    
49136>>>>>End_Class         
49137>>>>>
49137>>>>>
49137>>>>>Class cCJFindPreviousMenuItem is a cCJFindMenuItem
49138>>>>>    
49138>>>>>    Procedure Construct_Object
49140>>>>>        Forward Send Construct_Object
49142>>>>>        Set psCaption   to C_$CaptionFindLT
49143>>>>>        Set psToolTip to C_$ToolTipFindLT
49144>>>>>        Set psDescription to C_$DescFindLT
49145>>>>>        Set psImage to "ActionPrevious.ico"
49146>>>>>        Set psShortcut to "F7"
49147>>>>>    End_Procedure
49148>>>>>
49148>>>>>    Procedure OnExecute Variant vCommandBarControl
49150>>>>>        Send Find_Previous of (focus(Self)) 
49151>>>>>    End_Procedure
49152>>>>>    
49152>>>>>End_Class        
49153>>>>>
49153>>>>>
49153>>>>>Class cCJFindFirstMenuItem is a cCJFindMenuItem
49154>>>>>    
49154>>>>>    Procedure Construct_Object
49156>>>>>        Forward Send Construct_Object
49158>>>>>        Set psCaption   to C_$CaptionFindFirst
49159>>>>>        Set psToolTip to C_$ToolTipFindFirst
49160>>>>>        Set psDescription to C_$DescFindFirst
49161>>>>>        Set psImage to "ActionFirst.ico"
49162>>>>>        Set psShortcut to C_$Key_Ctrl_Home
49163>>>>>    End_Procedure
49164>>>>>
49164>>>>>    Procedure OnExecute Variant vCommandBarControl
49166>>>>>        Send Find_First of (focus(Self)) 
49167>>>>>    End_Procedure
49168>>>>>    
49168>>>>>End_Class         
49169>>>>>
49169>>>>>
49169>>>>>Class cCJFindLastMenuItem is a cCJFindMenuItem
49170>>>>>    
49170>>>>>    Procedure Construct_Object
49172>>>>>        Forward Send Construct_Object
49174>>>>>        Set psCaption   to C_$CaptionFindLast
49175>>>>>        Set psToolTip to C_$ToolTipFindLast
49176>>>>>        Set psDescription to C_$DescFindLast
49177>>>>>        Set psImage to "ActionLast.ico"
49178>>>>>        Set psShortcut to C_$Key_Ctrl_End
49179>>>>>    End_Procedure
49180>>>>>
49180>>>>>    Procedure OnExecute Variant vCommandBarControl
49182>>>>>        Send Find_Last of (focus(Self)) 
49183>>>>>    End_Procedure
49184>>>>>    
49184>>>>>End_Class         
49185>>>>>
49185>>>>>
49185>>>>>
49185>>>>>Class cCJSuperFindMenuItem is a cCJFindMenuItem
49186>>>>>    
49186>>>>>    Procedure Construct_Object
49188>>>>>        Forward Send Construct_Object
49190>>>>>        Set psCaption   to C_$CaptionSuperFindGE
49191>>>>>        Set psToolTip to C_$ToolTipSuperFindGE
49192>>>>>        Set psDescription to C_$DescSuperFindGE
49193>>>>>        Set psImage to "ActionSuperFindEq.ico"
49194>>>>>        Set psShortcut to "F9"
49195>>>>>        
49195>>>>>    End_Procedure
49196>>>>>
49196>>>>>    Procedure OnExecute Variant vCommandBarControl
49198>>>>>        Send SuperFind of (focus(Self)) 
49199>>>>>    End_Procedure
49200>>>>>    
49200>>>>>    Function IsEnabled Returns Boolean
49202>>>>>        Boolean bIsDEO bHasRecord bChanged bEnabled bHasIndex
49202>>>>>        Handle hoServer
49202>>>>>        Get DEOInformation (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDeo
49203>>>>>        Function_Return (bIsDEO and hoServer and bHasIndex)
49204>>>>>    End_Function
49205>>>>>         
49205>>>>>End_Class         
49206>>>>>
49206>>>>>
49206>>>>>
49206>>>>>Class cCJSuperFindNextMenuItem is a cCJFindMenuItem
49207>>>>>    
49207>>>>>    Procedure Construct_Object
49209>>>>>        Forward Send Construct_Object
49211>>>>>        Set psCaption   to C_$CaptionSuperFindGT
49212>>>>>        Set psToolTip to C_$ToolTipSuperFindGT
49213>>>>>        Set psDescription to C_$DescSuperFindGT
49214>>>>>        Set psImage to "ActionSuperFindNext.ico"
49215>>>>>        Set psShortcut to "F8"
49216>>>>>    End_Procedure
49217>>>>>
49217>>>>>    Procedure OnExecute Variant vCommandBarControl
49219>>>>>        Send SuperFind_Next of (focus(Self)) 
49220>>>>>    End_Procedure
49221>>>>>    
49221>>>>>End_Class         
49222>>>>>
49222>>>>>
49222>>>>>Class cCJSuperFindPreviousMenuItem is a cCJFindMenuItem
49223>>>>>    
49223>>>>>    Procedure Construct_Object
49225>>>>>        Forward Send Construct_Object
49227>>>>>        Set psCaption   to C_$CaptionSuperFindLT
49228>>>>>        Set psToolTip to C_$ToolTipSuperFindLT
49229>>>>>        Set psDescription to C_$DescSuperFindLT
49230>>>>>        Set psImage to "ActionSuperFindPrev.ico"
49231>>>>>        Set psShortcut to "F7"
49232>>>>>    End_Procedure
49233>>>>>
49233>>>>>    Procedure OnExecute Variant vCommandBarControl
49235>>>>>        Send SuperFind_Previous of (focus(Self)) 
49236>>>>>    End_Procedure
49237>>>>>    
49237>>>>>End_Class        
49238>>>>>
49238>>>>>
49238>>>>>Class cCJNextAreaMenu is a cCJDeoNavigateMenuItem
49239>>>>>
49239>>>>>    Procedure Construct_Object
49241>>>>>        Forward Send Construct_Object
49243>>>>>        Set psCaption to C_$CaptionNextArea
49244>>>>>        Set psDescription to C_$DescNextArea
49245>>>>>        Set psToolTip to C_$ToolTipNextArea
49246>>>>>        Set psShortcut to "F6"
49247>>>>>        Set psImage to "ActionNextArea.ico"
49248>>>>>    End_Procedure
49249>>>>>        
49249>>>>>    Procedure OnExecute Variant vCommandBarControl
49251>>>>>        Send Switch_Next_Area of (Focus(Self))
49252>>>>>    End_Procedure
49253>>>>>        
49253>>>>>End_Class
49254>>>>>    
49254>>>>>Class cCJPriorAreaMenu is a cCJDeoNavigateMenuItem
49255>>>>>
49255>>>>>    Procedure Construct_Object
49257>>>>>        Forward Send Construct_Object
49259>>>>>        Set psCaption to C_$CaptionPriorArea
49260>>>>>        Set psDescription to C_$DescPriorArea
49261>>>>>        Set psToolTip to C_$ToolTipPriorArea
49262>>>>>        Set psShortcut to C_$Key_Shift_F6
49263>>>>>        Set psImage to "ActionPrevArea.ico"
49264>>>>>    End_Procedure
49265>>>>>        
49265>>>>>    Procedure OnExecute Variant vCommandBarControl
49267>>>>>        Send Switch_Prior_Area of (Focus(Self))
49268>>>>>    End_Procedure
49269>>>>>    
49269>>>>>End_Class
49270>>>>>    
49270>>>>>Class cCJNextViewMenu is a cCJDeoNavigateMenuItem
49271>>>>>
49271>>>>>    Procedure Construct_Object
49273>>>>>        Forward Send Construct_Object
49275>>>>>        Set psCaption to C_$CaptionNextView
49276>>>>>        Set psDescription to C_$DescNextView
49277>>>>>        Set psToolTip to C_$ToolTipNextView
49278>>>>>        Set psShortcut to C_$Key_Alt_F6
49279>>>>>        Set psImage to "ActionNextView.ico"
49280>>>>>    End_Procedure
49281>>>>>        
49281>>>>>    Procedure OnExecute Variant vCommandBarControl
49283>>>>>        Handle hoCommandBars hoClientArea
49283>>>>>        Get CommandBarSystemObject to hoCommandBars
49284>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
49285>>>>>        If hoClientArea Begin
49287>>>>>            Send Switch_Next_View of hoClientArea
49288>>>>>        End
49288>>>>>>
49288>>>>>    End_Procedure
49289>>>>>    
49289>>>>>End_Class
49290>>>>>    
49290>>>>>Class cCJPriorViewMenu is a cCJDeoNavigateMenuItem
49291>>>>>
49291>>>>>    Procedure Construct_Object
49293>>>>>        Forward Send Construct_Object
49295>>>>>        Set psCaption to C_$CaptionPriorView
49296>>>>>        Set psDescription to C_$DescPriorView
49297>>>>>        Set psToolTip to C_$ToolTipPriorView
49298>>>>>        Set psShortcut to C_$Key_Ctrl_F6
49299>>>>>        Set psImage to "ActionPrevView.ico"
49300>>>>>    End_Procedure
49301>>>>>        
49301>>>>>    Procedure OnExecute Variant vCommandBarControl
49303>>>>>        Handle hoCommandBars hoClientArea
49303>>>>>        Get CommandBarSystemObject to hoCommandBars
49304>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
49305>>>>>        If hoClientArea Begin
49307>>>>>            Send Switch_Prior_View of hoClientArea
49308>>>>>        End
49308>>>>>>
49308>>>>>    End_Procedure
49309>>>>>        
49309>>>>>End_Class
49310>>>Use cCJMDIWindowsMenuItem.pkg
Including file: cCJMDIWindowsMenuItem.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\cCJMDIWindowsMenuItem.pkg)
49310>>>>>Use cCJCommandBarSystem.pkg
49310>>>>>
49310>>>>>Register_Function Client_ID Returns Integer
49310>>>>>
49310>>>>>// only used by cCJMDIWIndowsMenuItem
49310>>>>>Class cCJMDIWindowItem is a cCJMenuItem
49311>>>>>
49311>>>>>    Procedure Construct_Object
49313>>>>>        Forward Send Construct_Object
49315>>>>>        Property Handle phWindow 0 // object id of view
49316>>>>>        Set pbControlFlagNoMovable to True
49317>>>>>        Set pbActiveUpdate to True
49318>>>>>    End_Procedure
49319>>>>>    
49319>>>>>    Procedure OnExecute Variant vCommandBarControl
49321>>>>>        Handle hWindow
49321>>>>>        Get phWindow to hWindow
49322>>>>>        Send Activate_View of hWindow
49323>>>>>    End_Procedure
49324>>>>>    
49324>>>>>End_Class                
49325>>>>>
49325>>>>>
49325>>>>>Class cCJMDIWindowsMenuItem is a cCJMenuItem
49326>>>>>    
49326>>>>>    Procedure Construct_Object
49328>>>>>        Forward Send Construct_Object
49330>>>>>        Property Handle[] phArrayOfWindows
49331>>>>>        Set peControlType to xtpControlPopup
49332>>>>>        Set psCategory to C_$CategoryWindow
49333>>>>>    End_Procedure
49334>>>>>    
49334>>>>>     // This adds MDI windows to the existing menu items.
49334>>>>>     // This removes any existing windows menus and always adds a new set to the end
49334>>>>>
49334>>>>>     Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
49336>>>>>        Handle  hClientArea hView
49336>>>>>        String  sLabel
49336>>>>>        Integer i iWindows
49336>>>>>        Handle[] hArrayOfWindows
49337>>>>>        Variant vItem
49337>>>>>        
49337>>>>>        // delete all windows actions and menu items. Assume we have an array of DF action objects for the windows
49337>>>>>        // also assume that destroying an action removes all menu instances of that action
49337>>>>>        Get phArrayOfWindows to hArrayOfWindows
49338>>>>>        Move (SizeOfArray(hArrayOfWindows)) to iWindows
49339>>>>>        For i from 0 to (iWindows-1)
49345>>>>>>
49345>>>>>            Send Destroy of hArrayOfWindows[i] // assume this removes all menu items of this action
49346>>>>>        Loop
49347>>>>>>
49347>>>>>        Move (ResizeArray(hArrayOfWindows,0)) to hArrayOfWindows
49348>>>>>
49348>>>>>        // Add all views to this menu. Create the action and add the item
49348>>>>>        Move 0 to i
49349>>>>>        Get Client_Id to hClientArea // object id of client area
49350>>>>>        If (hClientArea > 0) Begin
49352>>>>>            Get Next_Mdi_Dialog of hClientArea True to hView // find first view
49353>>>>>            While (hView <> 0)
49357>>>>>                If (Active_State(hView)) Begin
49359>>>>>                    // create the action
49359>>>>>                    Get Create U_cCJMDIWindowItem to hArrayOfWindows[i]
49360>>>>>                    Get Label of hView to sLabel // caption bar (name) of view
49361>>>>>                    Set psCaption of hArrayOfWindows[i] to sLabel
49362>>>>>                    Set psDescription of hArrayOfWindows[i] to ("Make this view (" - trim(sLabel) - ") the active window.")
49363>>>>>                    If (current_scope(desktop)=hView and View_mode(hView)<>VIEWMODE_ICONIZE) Begin
49365>>>>>                        Set pbChecked of hArrayOfWindows[i] to True
49366>>>>>                    End
49366>>>>>>
49366>>>>>                    Set phWindow of hArrayOfWindows[i] to hView // used by custom OnExecute
49367>>>>>                    If (i=0) Begin
49369>>>>>                        Set pbControlBeginGroup of hArrayOfWindows[i] to True
49370>>>>>                    End
49370>>>>>>
49370>>>>>                    // Create a menu item for this action
49370>>>>>                    Get AddDynamicControl of hArrayOfWindows[i] hCommandBarControls to vItem
49371>>>>>                    Increment i
49372>>>>>                End
49372>>>>>>
49372>>>>>                Get Next_Mdi_Dialog of hClientArea False to hView // find next
49373>>>>>            Loop
49374>>>>>>
49374>>>>>        End
49374>>>>>>
49374>>>>>
49374>>>>>        Set phArrayOfWindows to hArrayOfWindows
49375>>>>>
49375>>>>>     End_Procedure
49376>>>>>     
49376>>>>>End_Class
49377>>>>>
49377>Use cCJCommandBarSystem.pkg
49377>
49377>Object oHtmlHelp is a cHtmlHelp
49379>End_Object
49380>
49380>Object oApplication is a cApplication
49382>    Set peHelpType to htHtmlHelp
49383>
49383>    Procedure OnCreate
49386>        Handle hoCmdLine
49386>        Integer iNumArgs iArg
49386>        Get phoCommandLine to hoCmdLine
49387>    End_Procedure
49388>
49388>End_Object
49389>
49389>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\oEditContextMenu.pkg)
49389>>>Use cCJStandardMenuItemClasses.pkg
49389>>>
49389>>>Object oEditContextMenu is a cCJContextMenu
49391>>>    
49391>>>    Move Self to Default_Form_Floating_Menu_ID
49392>>>    
49392>>>    Object oUndoMenuItem is a cCJUndoMenuItem
49394>>>    End_Object
49395>>>    
49395>>>    Object oCutMenuItem is a cCJCutMenuItem
49397>>>        Set pbControlBeginGroup to True
49398>>>    End_Object
49399>>>    
49399>>>    Object oCopyMenuItem is a cCJCopyMenuItem
49401>>>    End_Object
49402>>>
49402>>>    Object oPasteMenuItem is a cCJPasteMenuItem
49404>>>    End_Object
49405>>>
49405>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
49407>>>    End_Object
49408>>>
49408>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
49410>>>        Set pbControlBeginGroup to True
49411>>>    End_Object
49412>>>
49412>>>End_Object
49413>>>
49413>Use oDEOEditContextMenu.pkg
Including file: oDEOEditContextMenu.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\oDEOEditContextMenu.pkg)
49413>>>Use Windows.pkg
49413>>>Use cCJStandardMenuItemClasses.pkg
49413>>>Use cCJDeoMenuItemClasses.pkg
49413>>>
49413>>>
49413>>>Object oDEOEditContextMenu is a cCJContextMenu
49415>>>    
49415>>>    Move Self to Default_dbFloating_Menu_ID
49416>>>    
49416>>>    Object oUndoMenuItem is a cCJUndoMenuItem
49418>>>    End_Object
49419>>>    
49419>>>    Object oCutMenuItem is a cCJCutMenuItem
49421>>>        Set pbControlBeginGroup to True
49422>>>    End_Object
49423>>>    
49423>>>    Object oCopyMenuItem is a cCJCopyMenuItem
49425>>>    End_Object
49426>>>
49426>>>    Object oPasteMenuItem is a cCJPasteMenuItem
49428>>>    End_Object
49429>>>
49429>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
49431>>>    End_Object
49432>>>
49432>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
49434>>>        Set pbControlBeginGroup to True
49435>>>    End_Object
49436>>>
49436>>>    Object oPromptMenuItem is a cCJPromptMenuItem
49438>>>        Set pbControlBeginGroup to True
49439>>>    End_Object
49440>>>
49440>>>    Object oFindNextMenu is a cCJFindNextMenuItem
49442>>>        Set pbControlBeginGroup to True
49443>>>    End_Object
49444>>>
49444>>>    Object oFindPreviousMenu is a cCJFindPreviousMenuItem
49446>>>    End_Object
49447>>>
49447>>>    Object oClearMenuItem is a cCJClearMenuItem
49449>>>        Set pbControlBeginGroup to True
49450>>>    End_Object
49451>>>
49451>>>    Object oClearAllMenu is a cCJClearAllMenuItem
49453>>>    End_Object
49454>>>
49454>>>    Object oSaveMenu is a cCJSaveMenuItem
49456>>>    End_Object
49457>>>    
49457>>>    Object oSaveNCMenu is a cCJSaveNCMenuItem
49459>>>    End_Object
49460>>>    Object oDeleteMenu is a cCJDeleteMenuItem
49462>>>    End_Object
49463>>>
49463>>>
49463>>>End_Object
49464>
49464>
49464>Use MERTECH.INC
Including file: MERTECH.INC    (C:\Program Files\Visual DataFlex 14.1\Pkg\MERTECH.INC)
49464>>>//*************************************************************************
49464>>>//*                                                                       *
49464>>>//*  Confidential Trade Secret.                                           *
49464>>>//*  Copyright (c) 1997-2008 Mertech Data Systems Inc, Miami Florida      *
49464>>>//*  All rights reserved.                                                 *
49464>>>//*  DataFlex is a registered trademark of Data Access Corporation.       *
49464>>>//*                                                                       *
49464>>>//*************************************************************************
49464>>>USE UI
49464>>>
#REM -----------------------------------------------
#REM MERTECH DATA SYSTEMS INC. - WWW.MERTECHDATA.COM
#REM MERTECH.INC VERSION 2.6.18
#REM -----------------------------------------------
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>// SQLFlex Lock Type
49464>>>
49464>>>// Extended Callback Types
49464>>>
49464>>>
49464>>>INTEGER _SAVEFILENUMBER#
49464>>>
49464>>>// dfStructureEnd Option bits
49464>>>
49464>>>//
49464>>>Enum_List  //  Call_Driver Functions
49464>>>    DEfine CALLDRV_LICENSE_ENVIRONMENT_SET      FOR 0
49464>>>    Define CALLDRV_ORA_CURRENT_SQL_SERVER       FOR 6
49464>>>    Define CALLDRV_CURRENT_SQL_SERVER           FOR 19
49464>>>    Define CALLDRV_SQL_MAX_CURSORS              FOR 26
49464>>>    Define CALLDRV_SQLLOADER_FIELDS_TERM        FOR 30
49464>>>    Define CALLDRV_CREATE_TABLE_FROM_DAT        FOR 30
49464>>>    Define CALLDRV_SQLLOADER_DECIMAL_SEP        FOR 31
49464>>>    Define CALLDRV_SQLFLEX_MAX_CURSORS          FOR 37
49464>>>
49464>>>    Define CALLDRV_GET_RETURNED_COLUMNS         FOR 39
49464>>>    Define CALLDRV_GET_RETURNED_ROWS            FOR 40
49464>>>    Define CALLDRV_GET_COLUMN_ATTRIBUTE         FOR 41
49464>>>    Define CALLDRV_START_TXTGEN_AFTER_RECNUM    FOR 42
49464>>>    Define CALLDRV_FINISH_TXTGEN_AFTER_RECNUM   FOR 43
49464>>>    Define CALLDRV_SET_ISOLATION_LEVEL          FOR 44
49464>>>    Define CALLDRV_GET_SERVER_CFG               FOR 45
49464>>>    Define CALLDRV_SET_SQL_LOCK_TIMEOUT         FOR 46
49464>>>    Define CALLDRV_GET_SQL_LOCK_TIMEOUT         FOR 47
49464>>>    Define CALLDRV_GET_RESULTS                  FOR 48
49464>>>    Define CALLDRV_GET_MORE_RESULTS             FOR 49
49464>>>    Define CALLDRV_GET_CURRENT_USER_NAME        FOR 50
49464>>>    Define CALLDRV_OPEN_EMBEDDED_CURSOR         FOR 51
49464>>>    Define CALLDRV_CLOSE_EMBEDDED_CURSOR        FOR 52
49464>>>    Define CALLDRV_SET_CURRENT_EMBEDDED_CURSOR  FOR 53
49464>>>    Define CALLDRV_GET_CURRENT_EMBEDDED_CURSOR  FOR 54
49464>>>    Define CALLDRV_SET_MAX_EMBEDDED_CURSOR      FOR 55
49464>>>    Define CALLDRV_GET_MAX_EMBEDDED_CURSOR      FOR 56
49464>>>    Define CALLDRV_SQL_TRANSACTION              FOR 57
49464>>>    Define CALLDRV_LOCAL_TD_PATH                FOR 58
49464>>>    Define CALLDRV_CREATE_DB                    FOR 59
49464>>>    Define CALLDRV_ESCAPE_STRING                FOR 60
49464>>>    Define CALLDRV_SET_PROC_ATTRIBUTE_TYPE      FOR 61
49464>>>    Define CALLDRV_SQL_REFRESH_CACHE            FOR 62
49464>>>    Define CALLDRV_GET_SQL_STMT                 FOR 63
49464>>>    Define CALLDRV_DIRECT_PATH_LOAD             FOR 64
49464>>>
49464>>>    Define CALLDRV_READ_LOB                     FOR 65
49464>>>    Define CALLDRV_WRITE_LOB                    FOR 66
49464>>>    Define CALLDRV_APPEND_LOB                   FOR 67
49464>>>    Define CALLDRV_LENGTH_LOB                   FOR 68
49464>>>    Define CALLDRV_LOADFROMFILE_LOB             FOR 69
49464>>>    Define CALLDRV_ERASE_LOB                    FOR 70
49464>>>    Define CALLDRV_TRUNCATE_LOB                 FOR 71
49464>>>    Define CALLDRV_INITIALIZE_SEQUENCE          FOR 72
49464>>>    Define CALLDRV_CLIENT_CFG                   FOR 73
49464>>>    Define CALLDRV_END_SAVERECORD               FOR 74
49464>>>    Define CALLDRV_ENABLE_RECONNECT             FOR 75
49464>>>    Define CALLDRV_ENUMERATE_SERVER             FOR 76
49464>>>    Define CALLDRV_USE_ROWCOUNT_IN_TRANSACTIONS FOR 77
49464>>>    Define CALLDRV_USE_DFLEX_DATE_FORMAT        FOR 78
49464>>>    Define CALLDRV_FORCE_FIELDS_NOT_NULL        FOR 79
49464>>>    Define CALLDRV_ORA_CREATE_TABLE_FROM_DAT    FOR 80
49464>>>    Define CALLDRV_MAX_DATA_SIZE                FOR 81
49464>>>    Define CALLDRV_CHUNK_SIZE                   FOR 82
49464>>>    Define CALLDRV_GET_DATA_CHUNK               FOR 83
49464>>>    Define CALLDRV_MIRROR_SERVER                FOR 84
49464>>>    Define CALLDRV_COPY_DATA                    FOR 85
49464>>>    Define CALLDRV_SET_SQL_CURSOR_TYPE          FOR 86
49464>>>    Define CALLDRV_ICF                          FOR 87
49464>>>    Define CALLDRV_CLEAR_INT_CACHE              FOR 88
49464>>>    Define CALLDRV_GET_CURRENT_USER_PASSWORD    FOR 89
49464>>>    Define CALLDRV_FORCE_FIELDS_NULL            FOR 90
49464>>>End_Enum_List
49464>>>
49464>>>// License and environment settings
49464>>>Enum_List
49464>>>    Define CALLDRV_DRIVER_REVISION             FOR 0
49464>>>    Define CALLDRV_COMPANY_NAME                FOR 1
49464>>>    Define CALLDRV_SERIAL_NUMBER               FOR 2
49464>>>    Define CALLDRV_LICENSED_USERS              FOR 3
49464>>>    Define CALLDRV_MAJOR_REVISION              FOR 4
49464>>>    Define CALLDRV_VERSION_COMMENTS            FOR 5
49464>>>    Define CALLDRV_OLEDB_OEM_TRANSLATION       FOR 6
49464>>>    Define CALLDRV_SET_DB_PORT                 FOR 7
49464>>>    Define CALLDRV_GET_DB_PORT                 FOR 8
49464>>>    Define CALLDRV_SET_DB_SOCKET               FOR 9
49464>>>    Define CALLDRV_GET_DB_SOCKET               FOR 10
49464>>>    Define CALLDRV_SET_AS_SYSDBA               FOR 11
49464>>>    Define CALLDRV_OEM_TRANSLATION_STATE       FOR 12
49464>>>End_Enum_List
49464>>>
49464>>>Enum_List  // CALLDRV_ENUMERATE_SERVER_OPTION
49464>>>    Define CALLDRV_ENUMERATE_SERVER_COUNT       FOR 0
49464>>>    Define CALLDRV_ENUMERATE_SERVER_SERVER      FOR 1
49464>>>End_Enum_List
49464>>>
49464>>>// Embedded SQL Cursor Types
49464>>>Enum_List
49464>>>    Define CALLDRV_ENUMERATE_CURSOR_TYPE_NONE           FOR 0
49464>>>    Define CALLDRV_ENUMERATE_CURSOR_TYPE_CLIENT         FOR 1
49464>>>    Define CALLDRV_ENUMERATE_CURSOR_TYPE_SERVER         FOR 2
49464>>>    Define CALLDRV_ENUMERATE_CURSOR_TYPE_PARAMETERIZED  FOR 3
49464>>>End_Enum_List
49464>>>
49464>>>Enum_List
49464>>>    Define CALLDRV_VALUE_GET                    FOR 0
49464>>>    Define CALLDRV_VALUE_SET                    FOR 1
49464>>>End_Enum_List
49464>>>
49464>>>// Inverse Key types
49464>>>Enum_List
49464>>>    Define REGULAR_SEG                          FOR -1
49464>>>    Define INVK_CASE_SEG                        FOR 0
49464>>>    Define INVK_DESC_SEG                        FOR 1
49464>>>    Define INVK_DESC_AND_CASE_SEG               FOR 2
49464>>>End_Enum_List
49464>>>
49464>>>// DB2 Index Types
49464>>>Enum_List
49464>>>    Define REG_INDEX                            FOR 0
49464>>>    Define REV_INDEX                            FOR 1
49464>>>    Define CLUST_INDEX                          FOR 2
49464>>>    Define REV_CLUST_INDEX                      FOR 3
49464>>>End_Enum_List
49464>>>
49464>>>// Oracle Procedure Arguments type
49464>>>Enum_List
49464>>>    Define IS_NONE                              FOR 0
49464>>>    Define IS_IN                                FOR 1
49464>>>    Define IS_OUT                               FOR 2
49464>>>    Define IS_IN_OUT                            FOR 3
49464>>>    Define IS_RSET                              FOR 4
49464>>>End_Enum_List
49464>>>
49464>>>//  SQL_GET_COL Attributes
49464>>>Enum_List
49464>>>    Define SQL_GET_COL_ATTRIB_SIZE              FOR 1
49464>>>    Define SQL_GET_COL_ATTRIB_DECIMALS          FOR 2
49464>>>    Define SQL_GET_COL_ATTRIB_LABEL             FOR 3
49464>>>    Define SQL_GET_COL_ATTRIB_COLUMN_NAME       FOR 4
49464>>>    Define SQL_GET_COL_ATTRIB_TABLE_NAME        FOR 5
49464>>>    Define SQL_GET_COL_ATTRIB_SQLTYPE           FOR 6
49464>>>    Define SQL_GET_COL_ATTRIB_NULLABLE          FOR 7
49464>>>    Define SQL_GET_COL_ATTRIB_DFTYPE            FOR 8
49464>>>    Define SQL_GET_COL_ATTRIB_DATA_LENGTH       FOR 9
49464>>>End_Enum_List
49464>>>
49464>>>// Declare Global variables
49464>>>    String _DRIVERNAME# 255
49464>>>
49464>>>
49464>>>//Last Revised: 2007-08-08 By: Marcelo
49464>>>Object oMertechInc Is An Array
49466>>>    Property String  psArg1      Public ""
49468>>>    Property String  psArg2      Public ""
49470>>>    Property Integer piRet       Public 0
49472>>>    Property Integer piDecSep    Public 0
49474>>>
49474>>>    Procedure FillsArg1 Integer iSize
49477>>>        Set psArg1 to (REPEAT(" ",iSize))
49478>>>    End_Procedure
49479>>>
49479>>>    Procedure FillsArg2 Integer iSize
49482>>>        Set psArg2 to (REPEAT(" ",iSize))
49483>>>    End_Procedure
49484>>>
49484>>>    Procedure SetDecimalSeparator
49487>>>        Local Integer liDecSep
49487>>>        GET_ATTRIBUTE DF_DECIMAL_SEPARATOR TO liDecSep
49490>>>        Set piDecSep to liDecSep
49491>>>
49491>>>        If liDecSep Ne 46 SET_ATTRIBUTE DF_DECIMAL_SEPARATOR TO 46 // (.) WILL BE DECIMAL SEPARATOR
49496>>>    End_Procedure
49497>>>
49497>>>    Procedure RestoreDecimalSeparator
49500>>>        Local Integer liDecSep
49500>>>        Get piDecSep to liDecSep
49501>>>        If liDecSep Ne 46 SET_ATTRIBUTE DF_DECIMAL_SEPARATOR TO liDecSep
49506>>>    End_Procedure
49507>>>
49507>>>    Procedure SetsArg1Numeric String sValue
49510>>>        Send SetDecimalSeparator
49511>>>        Set psArg1 to sValue
49512>>>        Send RestoreDecimalSeparator
49513>>>    End_Procedure
49514>>>
49514>>>    Procedure SetsArg2Numeric String sValue
49517>>>        Send SetDecimalSeparator
49518>>>        Set psArg2 to sValue
49519>>>        Send RestoreDecimalSeparator
49520>>>    End_Procedure
49521>>>
49521>>>    Function GetpsArg1 Returns String
49524>>>        Function_Return (psArg1(_SELF#))
49525>>>    End_Function
49526>>>
49526>>>    Function GetpsArg2 Returns String
49529>>>        Function_Return (psArg2(_SELF#))
49530>>>    End_Function
49531>>>
49531>>>    Function GetpiRet Returns String
49534>>>        Function_Return (piRet(_SELF#))
49535>>>    End_Function
49536>>>
49536>>>    Function doCallDriver# Integer iFileNumber String sDriverID Integer iFunction String sArg1 String sArg2 Integer iLong Returns Integer
49539>>>        Local Integer liRetval
49539>>>        Local String lsArg1 lsArg2
49539>>>
49539>>>        Move sArg1 to lsArg1
49540>>>        Move sArg2 to lsArg2
49541>>>
49541>>>        Call_Driver iFileNumber sDRiverID Function iFunction Callback 0 Passing lsArg1 lsArg2 iLong Result liRetval
49546>>>
49546>>>        Set psArg1 to lsArg1
49547>>>        Set psArg2 to lsArg2
49548>>>        Set piRet  to liRetval
49549>>>        Function_Return liRetval
49550>>>    End_Function
49551>>>
49551>>>    Function doCallDriver2# Integer iFileNumber String sDriverID Integer iFunction Integer iLong Returns Integer
49554>>>        Local Integer liRetval
49554>>>        Local String lsArg1 lsArg2
49554>>>
49554>>>        Move (psArg1(_SELF#)) to lsArg1
49555>>>        Move (psArg2(_SELF#)) to lsArg2
49556>>>
49556>>>        Call_Driver iFileNumber sDRiverID Function iFunction Callback 0 Passing lsArg1 lsArg2 iLong Result liRetval
49561>>>
49561>>>        Set psArg1 to lsArg1
49562>>>        Set psArg2 to lsArg2
49563>>>        Set piRet  to liRetval
49564>>>        Function_Return liRetval
49565>>>    End_Function
49566>>>
49566>>>End_Object
49567>>>
49567>>>//Last Revised: 2007-08-08 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-10-25 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-10-25 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-08-08 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-08-08 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2004-11-09 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-08-08 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-08-08 By: Marcelo
49567>>>
49567>>>//Last Revised: 2004-07-13 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//==========================================
49567>>>// SELECT STUFFS
49567>>>//==========================================
49567>>>
49567>>>//Last Revised: 2007-08-08 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-08-08 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-08-08 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2008-01-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2008-07-25 By: Thomas
49567>>>
49567>>>//Last Revised: 2008-01-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-09-06 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-09-07 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-09-06 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-09-06 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-09-06 By: Marcelo
49567>>>
49567>>>//Last Revised: 2003-03-27 By: Marcelo
49567>>>
49567>>>//Last Revised: 2003-03-27 By: Marcelo
49567>>>
49567>>>//Last Revised: 2003-03-27 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-09-22 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-09-22 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-08-03 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2008-08-10 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-08-08 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2008-02-25 By: Marcelo
49567>>>
49567>>>//Last Revised: 2003-08-27 By: Marcelo
49567>>>// SQL_GET_OUTPUT_VALUE <POSITION> TO <VARIABLE>
49567>>>
49567>>>//Last Revised: 2007-09-13 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-08-03 By: Marcelo
49567>>>
49567>>>//Last Revised: 2008-01-29 By: Marcelo
49567>>>
49567>>>//Last Revised: 2008-01-29 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-09-07 By: Marcelo
49567>>>
49567>>>
49567>>>//Last Revised: 2005-08-29 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-08-29 By: Marcelo
49567>>>
49567>>>//Last Revised: 2003-08-27 By: Marcelo
49567>>>
49567>>>
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-09-15 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2004-07-19 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2006-12-27 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-08-10 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//==================================
49567>>>// SQLFlex Commands
49567>>>//==================================
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-02-18 By: Marcelo
49567>>>
49567>>>//Last Revised: 2008-07-21 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2008-06-18 By: Marcelo
49567>>>
49567>>>//Last Revised: 2004-05-10 By: Marcelo
49567>>>
49567>>>//Last Revised: 2004-05-10 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-08-30 By: Marcelo
49567>>>
49567>>>//Last Revised: 2008-05-07 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//==========================================
49567>>>// SQL SERVER Stored Procedure Call engine
49567>>>//==========================================
49567>>>
49567>>>//Last Revised: 2008-04-30 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-08-10 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2008-02-06 By: Marcelo
49567>>>
49567>>>//Last Revised: 2008-02-06 By: Marcelo
49567>>>
49567>>>//Last Revised: 2008-02-15 By: Marcelo
49567>>>// Copy_Data {source-table} To {dest-table} [Callback {callback-object}] [Constrain {SQL-expression}]
49567>>>
49567>>>//============================
49567>>>// ORAFlex Commands
49567>>>//============================
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2006-03-21 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2004-07-19 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//===========================
49567>>>// BUFFER save stuffs
49567>>>//===========================
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2003-08-14 By: Marcelo
49567>>>// CREATE_TABLE_FROM_DAT_FILE <FILE NUMBER>
49567>>>
49567>>>//Last Revised: 2002-08-14 By: Marcelo
49567>>>// CONVERT_DAT_FILE <FILE NUMBER>
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-04-23 By: Marcelo
49567>>>// Syntax:
49567>>>//   GET_SERVER_CFG SERVER_REVISION|SUPPORT_DESC|SUPPORT_CASE|SERVER_VERSION|SERVER_ENCODING|CONNECTION_ACTIVE OF <SERVER NAME> TO <RESULT>
49567>>>// Description:
49567>>>//   Use this command to retrieve from database server the following informations :
49567>>>//   command arguments :
49567>>>//      SERVER_REVISON : Retrieve Server major revision
49567>>>//      SUPPORT_DESC : <RESULT> is 1 if Server supports Descending index segments
49567>>>//      SUPPORT_CASE : <RESULT> is 1 if Server supports Case Insensitive index segments
49567>>>//      SERVER_VERSION : Retrieve Complete Server Version Description
49567>>>//      SERVER_ENCODING : Retrieve the Server Encoding
49567>>>//      CONNECTION_ACTIVE : Retrieve the Connection status. DFTRUE means connection is active
49567>>>//
49567>>>
49567>>>//Last Revised: 2007-04-23 By: Marcelo
49567>>>// Syntax:
49567>>>//  GET_CONNECTION_STATUS of <serverName> [<databaseName>] to <variable>
49567>>>// Description:
49567>>>//  Use this command to retrieve the connection status from the specified server
49567>>>//  command argumetns :
49567>>>//    <serverName> : Server Name
49567>>>//    <databaseName> : Database Name
49567>>>//    <variable> : DFTRUE means connection is active
49567>>>
49567>>>//Last Revised: 2005-04-06 By: Marcelo
49567>>>// Syntax:
49567>>>//   GET_CLIENT_CFG ENCODING OF <SERVER NAME> [<DATABASE NAME>] TO <RESULT>
49567>>>// Description:
49567>>>//   Use this command to retrieve from database server the following informations :
49567>>>//   command arguments :
49567>>>//      ENCODING : Retrieve the Client Encoding
49567>>>//
49567>>>
49567>>>//Last Revised: 2006-05-26 By: Marcelo
49567>>>// Syntax:
49567>>>//   SET_CLIENT_CFG ENCODING OF <SERVER NAME> [<DATABASE NAME>] TO <RESULT>
49567>>>// Description:
49567>>>//   Use this command to Set the following client informations :
49567>>>//   command arguments :
49567>>>//      ENCODING : Set the Client Encoding
49567>>>//      UNIQUE_CHECKS {DFTRUE/DFFALSE}: enable/disable uniqueness checks for secondary indexes in InnoDB tables
49567>>>//
49567>>>
49567>>>//NEW
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>// Syntax:
49567>>>//   FORMAT TO USE : CALL_DB2_PROCEDURE <OWNER> <STORED_PROC_NAME> [PASSING <ARG1> <ARG2> ....<ARGn>]
49567>>>// Description:
49567>>>//   CALL_STORED_PROCEDURE will call a stored procedure passing arguments
49567>>>
49567>>>// GET_RESULT_SET INTO <Var1 Var2 Var3 ... Varn>
49567>>>
49567>>>// GET_RESULTS
49567>>>
49567>>>// GET_MORE_RESULTS
49567>>>
49567>>>// GET_RESULT_SET_NUM_COLS TO <VAR>
49567>>>
49567>>>// GET_RESULT_SET_COL_NAME <COL NUMBER> TO <VAR> {<SIZE>}
49567>>>
49567>>>
49567>>>
49567>>>// CREATE_DB2_DATABASE <DB Name> <DB Alias> <Code Set> <Territory> [<Path> <NodeName> < UserId> <Password>]
49567>>>
49567>>>//Last Revised: 2005-04-04 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-04-04 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-04-04 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-04-04 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-04-04 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-04-04 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-04-04 By: Hideraldo
49567>>>
49567>>>//Last Revised: 2005-04-04 By: Hideraldo
49567>>>
49567>>>//Last Revised: 2003-04-08 By: Marcelo
49567>>>
49567>>>
49567>>>
49567>>>//Last Revised: 2007-08-13 By: Marcelo
49567>>>
49567>>>//Last Revised: 2004-11-03 By: Marcelo
49567>>>
49567>>>//Last Revised: 2004-11-03 By: Marcelo
49567>>>
49567>>>//Last Revised: 2004-11-17 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-08-13 By: Marcelo
49567>>>
49567>>>//Last Revised: 2003-09-02 By: Marcelo
49567>>>FUNCTION SQLESCAPESTRING GLOBAL STRING SARG RETURNS STRING
49569>>>  LOCAL STRING LSARG
49569>>>  SQL_ESCAPE_STRING OF SARG TO LSARG
49613>>>  FUNCTION_RETURN LSARG
49614>>>END_FUNCTION
49615>>>
49615>>>//Last Revised: 2007-08-13 By: Marcelo
49615>>>
49615>>>//Last Revised: 2005-03-18 By: Marcelo
49615>>>
49615>>>//Last Revised: 2005-03-21 By: Marcelo
49615>>>
49615>>>//
49615>>>// LOB Columns Macro Commands Support
49615>>>//
49615>>>//Last Revised: 2007-10-04 By: Marcelo
49615>>>
49615>>>//Last Revised: 2008-08-19 By: Marcelo
49615>>>
49615>>>//Last Revised: 2008-06-20 By: Marcelo
49615>>>
49615>>>//Last Revised: 2007-10-04 By: Marcelo
49615>>>
49615>>>//Last Revised: 2007-10-04 By: Marcelo
49615>>>
49615>>>//Last Revised: 2007-10-04 By: Marcelo
49615>>>
49615>>>//Last Revised: 2007-10-04 By: Marcelo
49615>>>
49615>>>//
49615>>>// MYSQL Specific Macro Commands
49615>>>//
49615>>>
49615>>>
49615>>>//Last Revised: 2005-08-23 By: Marcelo
49615>>>
49615>>> ////////// Internal Macro Commands, Procedures and Functions
49615>>>
49615>>>//Last Revised: 2005-08-29 By: Marcelo
49615>>>
49615>>>//Last Revised: 2005-08-29 By: Marcelo
49615>>>
49615>>>//Last Revised: 2005-08-29 By: Marcelo
49615>>>
49615>>>//Last Revised: 2005-08-29 By: Marcelo
49615>>>
49615>>>//Last Revised: 2005-08-29 By: Marcelo
49615>>>
49615>>>//Last Revised: 2005-08-29 By: Marcelo
49615>>>
49615>>>//Last Revised: 2005-08-29 By: Marcelo
49615>>> Procedure MertechInc_SQL_PROCEDURE_EXECUTE for Desktop
49617>>>    SQL_EXECUTE_STMT
49659>>> End_Procedure
49660>>>
49660>>>//Last Revised: 2005-08-29 By: Marcelo
49660>>> Procedure MertechInc_SQL_FUNCTION_EXECUTE Desktop String sDriverName 
49662>>>    send MertechInc_SQL_PROCEDURE_EXECUTE
49663>>>    if (sDriverName = MYSQLFLEX) begin
49665>>>        SQL_FETCH_NEXT_ROW
49709>>>    end
49709>>>>
49709>>> End_Procedure
49710>>>
49710>>>//Last Revised: 2005-08-29 By: Marcelo
49710>>> Procedure MertechInc_SQL_SET_MYPROCEDURE_NAME Desktop String strProcName Integer iNumpar
49712>>>    Local Integer liPos#
49712>>>
49712>>>    DO_DECLARE_BASIC_VARIABLES#
49713>>>
49713>>>    MOVE 0 TO _NPAR#
49714>>>        INDICATE ERR FALSE
49715>>>
49715>>>    MOVE MySQLFlex TO _DRIVERNAME#
49716>>>
49716>>>    SQL_SET_STMT TO "CALL "
49756>>>    SQL_APPEND_STMT TO strProcName
49796>>>    SQL_APPEND_STMT TO "("
49836>>>    For liPos# From 1 TO iNumpar
49842>>>>
49842>>>        DO_PASS_ARGUMENTS liPos#
49938>>>    Loop
49939>>>>
49939>>>    SQL_APPEND_STMT TO ")"
49979>>>
49979>>>    SQL_PREPARE_STMT
50021>>> End_Procedure
50022>>>
50022>>>//Last Revised: 2005-08-29 By: Marcelo
50022>>> Procedure MertechInc_SQL_SET_ORAPROCEDURE_NAME Desktop String strProcName Integer iNumpar 
50024>>>    Local Integer liPos#
50024>>>
50024>>>    DO_DECLARE_BASIC_VARIABLES#
50025>>>
50025>>>    MOVE 0 TO _NPAR#
50026>>>        INDICATE ERR FALSE
50027>>>
50027>>>    MOVE ORAFlex TO _DRIVERNAME#
50028>>>
50028>>>    SQL_SET_STMT TO "BEGIN "
50068>>>    SQL_APPEND_STMT TO strProcName
50108>>>    SQL_APPEND_STMT TO "( "
50148>>>    For liPos# From 1 TO iNumpar
50154>>>>
50154>>>        DO_PASS_ARGUMENTS liPos#
50250>>>    Loop
50251>>>>
50251>>>    SQL_APPEND_STMT TO  " ); END;"
50291>>>    SQL_PREPARE_STMT
50333>>> End_Procedure
50334>>>
50334>>>//Last Revised: 2005-06-29 By: Marcelo
50334>>> Procedure MertechInc_SQL_SET_MYFUNCTION_NAME Desktop String strProcName Integer iNumparp
50336>>>     Local Integer liPos#
50336>>>
50336>>>    MOVE MySQLFlex TO _DRIVERNAME#
50337>>>
50337>>>    SQL_SET_STMT TO "SELECT "
50377>>>    SQL_APPEND_STMT TO strProcName
50417>>>    SQL_APPEND_STMT TO "("
50457>>>    For liPos# from 1 to 
50463>>>>
50463>>>        DO_PASS_ARGUMENTS liPos#
50559>>>    Loop
50560>>>>
50560>>>    SQL_APPEND_STMT TO ")"
50600>>>
50600>>>    SQL_PREPARE_STMT
50642>>> End_Procedure
50643>>>
50643>>>//Last Revised: 2005-06-29 By: Marcelo
50643>>> Procedure MertechInc_SQL_SET_ORAFUNCTION_NAME Desktop String strProcName Integer iNumpar
50645>>>    Local Integer liPos# liLLong#
50645>>>    Local String lsArg2# lsBlank#
50645>>>
50645>>>        SQL_SET_STMT TO "BEGIN "
50685>>>    SQL_APPEND_STMT TO ":PAR_RET := "
50725>>>    SQL_APPEND_STMT TO strProcName
50765>>>    SQL_APPEND_STMT TO "( "
50805>>>    For liPos# From 1 TO iNumpar
50811>>>>
50811>>>        DO_PASS_ARGUMENTS liPos#
50907>>>    Loop
50908>>>>
50908>>>    SQL_APPEND_STMT TO  " ); END;"
50948>>>    SQL_PREPARE_STMT
50990>>>
50990>>>    MOVE IS_OUT TO liLLong#
50991>>>    move " " to lsBlank#
50992>>>    CALL_DRIVER 0 ORAFLEX FUNCTION CALLDRV_SET_PROC_ATTRIBUTE_TYPE CALLBACK 0 PASSING lsBlank# lsBlank# liLLong# RESULT _RET#
50997>>>
50997>>>    INCREMENT _NPAR#
50998>>>    MOVE ":PAR_RET" TO lsArg2#
50999>>>    CALL_DRIVER 0 _DRIVERNAME# FUNCTION 23 CALLBACK 0 PASSING _BLANK# lsArg2# 16384 RESULT _RET#
51004>>>End_Procedure
51005>>>
51005>>>//Last Revised: 2008-02-26 By: Marcelo
51005>>>Function SQL_AVAILABLE_SQL_SERVERS Desktop Returns Integer 
51007>>>    Local Integer liRet#
51007>>>    Local String lsBlank#
51007>>>
51007>>>    move " " to lsBlank#
51008>>>    CALL_DRIVER 0 SQLFLEX FUNCTION CALLDRV_ENUMERATE_SERVER CALLBACK 0 PASSING lsBlank# lsBlank# CALLDRV_ENUMERATE_SERVER_COUNT RESULT liRet#
51013>>>
51013>>>    function_return liRet#
51014>>>End_Function
51015>>>
51015>>>//Last Revised: 2008-06-26 By: Marcelo
51015>>>Function SQL_AVAILABLE_SQL_SERVER_NAME Desktop Integer item# Returns String 
51017>>>    Local Integer liRet#
51017>>>    Local String lsArg1# lsArg2# lsBlank#
51017>>>
51017>>>    MOVE (REPEAT(" ", 80)) TO lsArg1#
51018>>>    move item# to lsArg2#
51019>>>    CALL_DRIVER 0 SQLFLEX FUNCTION CALLDRV_ENUMERATE_SERVER CALLBACK 0 PASSING lsArg1# lsArg2# CALLDRV_ENUMERATE_SERVER_SERVER RESULT liRet#
51024>>>
51024>>>    Function_Return lsArg1#
51025>>>End_Function
51026>>>
51026>>>//Last Revised: 2008-02-26 By: Marcelo
51026>>>Procedure Set SQL_USE_ROWCOUNT_IN_TRANSACTIONS global String server# Integer value#
51028>>>    Local Integer liRet#
51028>>>    Local String lsArg1# lsArg2#
51028>>>
51028>>>    DO_DECLARE_BASIC_VARIABLES#
51029>>>    DO_GETFILENUMBER_DRIVERNAME# 0
51060>>>
51060>>>    move server# to lsArg1#
51061>>>    move value# to lsArg2#
51062>>>
51062>>>    CALL_DRIVER 0 _DRIVERNAME# FUNCTION CALLDRV_USE_ROWCOUNT_IN_TRANSACTIONS CALLBACK 0 PASSING lsArg1# lsArg2# CALLDRV_VALUE_SET RESULT liRet#
51067>>>    IF liRet# EQ -1 INDICATE ERR TRUE
51070>>>
51070>>>    DO_RESTORE_FILENUMBER#
51071>>>End_Procedure
51072>>>//#REPLACE UseRowCountInTransactions SQL_USE_ROWCOUNT_IN_TRANSACTIONS
51072>>>
51072>>>//Last Revised: 2008-02-26 By: Marcelo
51072>>>Function SQL_USE_ROWCOUNT_IN_TRANSACTIONS Global String serverName# Returns Integer
51074>>>    Local Integer liRet#
51074>>>    Local String lsBlank#
51074>>>    Local String lsArg1#
51074>>>
51074>>>    DO_DECLARE_BASIC_VARIABLES#
51075>>>    DO_GETFILENUMBER_DRIVERNAME# 0
51106>>>
51106>>>    move serverName# to lsArg1#
51107>>>    move " " to lsBlank#
51108>>>    CALL_DRIVER 0 _DRIVERNAME# FUNCTION CALLDRV_USE_ROWCOUNT_IN_TRANSACTIONS CALLBACK 0 PASSING lsArg1# lsBlank# CALLDRV_VALUE_GET RESULT liRet#
51113>>>
51113>>>    DO_RESTORE_FILENUMBER#
51114>>>
51114>>>    function_return liRet#
51115>>>End_Function
51116>>>
51116>>>//Last Revised: 2008-02-26 By: Marcelo
51116>>>Procedure Set SQL_USE_DATAFLEX_DATEFORMAT global Integer value#
51118>>>    DO_DECLARE_BASIC_VARIABLES#
51119>>>    DO_GETFILENUMBER_DRIVERNAME# 0
51150>>>
51150>>>    If _DRIVERNAME# eq SQLFlex Begin
51152>>>        move value# to _ARG1#
51153>>>        CALL_DRIVER 0 _DRIVERNAME# FUNCTION CALLDRV_USE_DFLEX_DATE_FORMAT CALLBACK 0 PASSING _ARG1# _BLANK# CALLDRV_VALUE_SET RESULT _RET#
51158>>>        IF _RET# EQ -1 INDICATE ERR TRUE
51161>>>    End
51161>>>>
51161>>>
51161>>>    DO_RESTORE_FILENUMBER#
51162>>>End_Procedure
51163>>>//#REPLACE SqlUseDataflexDateFormat SQL_USE_DATAFLEX_DATEFORMAT
51163>>>
51163>>>//Last Revised: 2008-02-26 By: Marcelo
51163>>>Function SQL_USE_DATAFLEX_DATEFORMAT Global Returns Integer
51165>>>    DO_DECLARE_BASIC_VARIABLES#
51166>>>    DO_GETFILENUMBER_DRIVERNAME# 0
51197>>>
51197>>>    If _DRIVERNAME# eq SQLFlex Begin
51199>>>        CALL_DRIVER 0 _DRIVERNAME# FUNCTION CALLDRV_USE_DFLEX_DATE_FORMAT CALLBACK 0 PASSING _BLANK# _BLANK# CALLDRV_VALUE_GET RESULT _RET#
51204>>>    End
51204>>>>
51204>>>    Else Move DFFALSE to _RET#
51206>>>
51206>>>    DO_RESTORE_FILENUMBER#
51207>>>
51207>>>    function_return _RET#
51208>>>End_Function
51209>>>
51209>>>//Last Revised: 2008-08-27 By: Marcelo
51209>>>Procedure Set SQL_FORCE_FIELDS_NOT_NULL global Integer value#
51211>>>    DO_DECLARE_BASIC_VARIABLES#
51212>>>    DO_GETFILENUMBER_DRIVERNAME# 0
51243>>>
51243>>>    If (_DRIVERNAME# eq ORAFlex OR _DRIVERNAME# eq MySQLFlex) Begin
51245>>>        move value# to _ARG1#
51246>>>        CALL_DRIVER 0 _DRIVERNAME# FUNCTION CALLDRV_FORCE_FIELDS_NOT_NULL CALLBACK 0 PASSING _ARG1# _BLANK# CALLDRV_VALUE_SET RESULT _RET#
51251>>>        IF _RET# EQ -1 INDICATE ERR TRUE
51254>>>    End
51254>>>>
51254>>>
51254>>>    DO_RESTORE_FILENUMBER#
51255>>>End_Procedure
51256>>>
51256>>>//Last Revised: 2008-08-27 By: Marcelo
51256>>>Function SQL_FORCE_FIELDS_NOT_NULL Global Returns Integer
51258>>>    DO_DECLARE_BASIC_VARIABLES#
51259>>>    DO_GETFILENUMBER_DRIVERNAME# 0
51290>>>
51290>>>    If (_DRIVERNAME# eq ORAFlex OR _DRIVERNAME# eq MySQLFlex) Begin
51292>>>        CALL_DRIVER 0 _DRIVERNAME# FUNCTION CALLDRV_FORCE_FIELDS_NOT_NULL CALLBACK 0 PASSING _BLANK# _BLANK# CALLDRV_VALUE_GET RESULT _RET#
51297>>>    End
51297>>>>
51297>>>    Else Move DFFALSE to _RET#
51299>>>
51299>>>    DO_RESTORE_FILENUMBER#
51300>>>
51300>>>    function_return _RET#
51301>>>End_Function
51302>>>
51302>>>//Last Revised: 2008-08-27 By: Marcelo
51302>>>
51302>>>//Last Revised: 2008-08-27 By: Marcelo
51302>>>
51302>>>//Last Revised: 2008-08-22 By: Marcelo
51302>>>
51302>>>//Last Revised: 2008-08-22 By: Marcelo
51302>//Login 'PIS2003DEV'  'SA' '123' 'SQL_DRV'
51302>//Login 'PISDEV'      'SA' '123' 'SQL_DRV'
51302>
51302>Open CNZONES
Including file: CNZONES.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\CNZONES.FD)
51304>Open BRZONES
Including file: BRZONES.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\BRZONES.FD)
51306>Open ZONES
Including file: ZONES.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\ZONES.FD)
51308>Open item
Including file: ITEM.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\ITEM.FD)
51310>Open Sysfile
Including file: SYSFILE.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\SYSFILE.FD)
51312>Open Clients
Including file: CLIENTS.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\CLIENTS.FD)
51314>Open CN
Including file: CN.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\CN.FD)
51316>Open CONSTRCT
Including file: CONSTRCT.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\CONSTRCT.FD)
51318>Open Salesmen
Including file: Salesmen.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\Salesmen.FD)
51320>Open MHXANIK
Including file: MHXANIK.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MHXANIK.FD)
51322>Open PAYRESP
Including file: PAYRESP.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\PAYRESP.FD)
51324>Open CODEMAST 
51326>Open CODETYPE
51328>Open BTNORDH
Including file: BTNORDH.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\BTNORDH.FD)
51330>Open BTNORDD
Including file: BTNORDD.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\BTNORDD.FD)
51332>Open AREAS
Including file: AREAS.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\AREAS.FD)
51334>Open CITIES
Including file: CITIES.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\CITIES.FD)
51336>Open TOWNS
Including file: TOWNS.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\TOWNS.FD)
51338>Open COUNTRY
Including file: COUNTRY.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\COUNTRY.FD)
51340>
51340>Open MIClient
Including file: MICLIENT.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MICLIENT.FD)
51342>Open MICN
Including file: MICN.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MICN.FD)
51344>Open MICONSTR
Including file: MICONSTR.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MICONSTR.FD)
51346>Open MISalesm
Including file: MISALESM.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MISALESM.FD)
51348>Open MIMHXAN
Including file: MIMHXAN.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MIMHXAN.FD)
51350>Open MIPRESP
Including file: MIPRESP.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MIPRESP.FD)
51352>Open MICodtyp
Including file: MICODTYP.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MICODTYP.FD)
51354>Open MIcodema
Including file: MICODEMA.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MICODEMA.FD)
51356>Open MIORDH
Including file: MIORDH.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MIORDH.FD)
51358>Open MIORDD
Including file: MIORDD.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MIORDD.FD)
51360>Open MIAREAS
Including file: MIAREAS.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MIAREAS.FD)
51362>Open MICITIES
Including file: MICITIES.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MICITIES.FD)
51364>Open MITOWNS
Including file: MITOWNS.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MITOWNS.FD)
51366>Open MICOUNTR 
Including file: MICountr.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MICountr.FD)
51368>
51368>// this is a remark only for github
51368>Object oMain is a Panel
51370> 
51370>    Set Label to "€§¦©«¦¢ã ˜§¦ §œ¨ ­œ¨œ ˜¡ã ™á©ž SMS ©œ ¡œ¤«¨ ¡ã ™á©ž SMSMI"
51371>
51371>    Set Location to 4 3
51372>    Set Size to 300 450
51373>
51373>    Object oCommandBarSystem is a cCJCommandBarSystem
51375>        Set pbTimerUpdate to True
51376>//
51376>        Procedure OnCreateCommandBars 
51379>            Handle hoOptions
51379>            Get OptionsObject to hoOptions
51380>            Forward Send OnCreateCommandBars
51382>        End_Procedure
51383>
51383>        Object oMenuBar is a cCJMenuBar
51385>
51385>            Object oMainMenu1 is a cCJMenuItem
51387>                Set psCaption to "Ž‚€‹‹€’€ ‹„’€”Ž€‘ „‚‚€”—Œ"
51388>                Set psTooltip to "Ž‚€‹‹€’€ ‹„’€”Ž€‘ „‚‚€”—Œ"
51389>                Set peControlType to xtpControlPopup
51390>
51390>                Object oShowSendToMaster is a cCJMenuItem
51392>                    Set psCaption to "€§¦©«¦¢ã œ¢˜«é¤/ë¨šà¤/Š¦ §é¤ ˜§¦ ‹¦¤á›˜ ©«ž¤ „¤¦§¦ ž£â¤ž SMSMI"
51393>                    Set psTooltip to "€§¦©«¦¢ã œ¢˜«é¤/ë¨šà¤/Š¦ §é¤ ˜§¦ ‹¦¤á›˜ ©«ž¤ „¤¦§¦ ž£â¤ž SMSMI"
51394>                    
51394>                    Procedure OnExecute Variant vCommandBarControl
51397>                        Handle hoClient
51397>                        Get Client_Id to hoClient
51398>                        Send Activate_MI_Migrate_Send_Data_To_Master of hoClient
51399>                    End_Procedure
51400>    
51400>                End_Object
51401>
51401>                Object oSendDEOP is a cCJMenuItem
51403>                    Set psCaption to "€§¦©«¦¢ã „¤œ¨šé¤ ƒ„Ž ©«ž¤ „¤¦§¦ ž£â¤ž SMSMI"
51404>                    Set psTooltip to "€§¦©«¦¢ã „¤œ¨šé¤ ƒ„Ž ©«ž¤ „¤¦§¦ ž£â¤ž SMSMI"
51405>
51405>                    Procedure OnExecute Variant vCommandBarControl
51408>                        Handle hoClient
51408>                        Get Client_Id to hoClient
51409>                        Send Activate_MI_Migrate_DEOP_Send_To_Master_NEW of hoClient
51410>                    End_Procedure
51411>                End_Object
51412>
51412>                Object oYpdateZones is a cCJMenuItem
51414>                    Set psCaption to "„¤ž£â¨à©ž …é¤žª ë¨š¦¬ ©«¦ MICN ˜§¦ œ¨ ­œ¨œ ˜¡ã SMS"
51415>                    Set psTooltip to "„¤ž£â¨à©ž …é¤žª ë¨š¦¬ ©«¦ MICN ˜§¦ œ¨ ­œ¨œ ˜¡ã SMS"
51416>                    Set pbControlBeginGroup to True
51417>
51417>                    Procedure OnExecute Variant vCommandBarControl
51420>                        Handle hoClient
51420>                        Get Client_Id to hoClient
51421>                        Send Activate_UpdateZonesForCN of hoClient
51422>                    End_Procedure
51423>                End_Object
51424>
51424>                Object oShowClientCN is a cCJMenuItem
51426>                    Set psCaption to "ë¢œš®¦ª „šš¨˜­é¤ œ¢á«ž / „¨šà¤"
51427>                    Set psTooltip to "ë¢œš®¦ª „šš¨˜­é¤ œ¢á«ž / „¨šà¤"
51428>                    Set pbControlBeginGroup to True
51429>
51429>                    Procedure OnExecute Variant vCommandBarControl
51432>                        Handle hoClient
51432>                        Get Client_Id to hoClient
51433>                        Send Activate_ClientsCN of hoClient
51434>                    End_Procedure
51435>                End_Object
51436>
51436>                Object oShowDEOP is a cCJMenuItem
51438>                    Set psCaption to "ë¢œš®¦ª ‰˜«˜®à¨ž£â¤à¤ ƒ„Ž"
51439>                    Set psTooltip to "ë¢œš®¦ª ‰˜«˜®à¨ž£â¤à¤ ƒ„Ž"
51440>
51440>                    Procedure OnExecute Variant vCommandBarControl
51443>                        Handle hoClient
51443>                        Get Client_Id to hoClient
51444>                        Send Activate_DEOP_View of hoClient
51445>                    End_Procedure
51446>                End_Object
51447>
51447>            End_Object // Object oMainMenu1 is a cCJMenuItem
51448>
51448>        End_Object // Object oMenuBar is a cCJMenuBar
51449>  
51449>    End_Object // // Object oCommandBarSystem is a cCJCommandBarSystem
51450>
51450>    Object oClientArea is a ClientArea
51452>        Use StdAbout.pkg
Including file: STDABOUT.PKG    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\STDABOUT.PKG)
51452>>>//************************************************************************
51452>>>// Confidential Trade Secret.
51452>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
51452>>>// as an unpublished work.  All rights reserved.
51452>>>// DataFlex is a registered trademark of Data Access Corporation.
51452>>>//
51452>>>//************************************************************************
51452>>>//************************************************************************
51452>>>//
51452>>>// $File name  : StdAbout.pkg
51452>>>// $File title : Standard about object package for VDF
51452>>>// Notice      :
51452>>>// $Author(s)  : John Tuohy
51452>>>//
51452>>>// $Rev History
51452>>>//
51452>>>// JT 06/27/97   File created
51452>>>//************************************************************************
51452>>>
51452>>>// This provides a quick and simple way to create an about package for a program.
51452>>>// You need to create a message inside you client area called Activate_About.
51452>>>// Within this message you should send the message DoAbout passing needed
51452>>>// string information.
51452>>>//
51452>>>//       Procedure Activate_About
51452>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
51452>>>//       End_Procedure
51452>>>//    where: sTitle =     Name of application. If none provided, uses caption
51452>>>//                        bar title
51452>>>//           sVersion   = Version Line. If none provided, will be blank
51452>>>//           sCopyRight = Copyright Line. If none provided, will be blank
51452>>>//           sAuthor    = Author name, blank if none provided
51452>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
51452>>>//                        is used.
51452>>>// It is expected that you will place this in your own object package. For
51452>>>// example an order about package may look like this:
51452>>>//
51452>>>//   // OrderAbout.pkg
51452>>>//   Use StdAbout.pkg
51452>>>//   Procedure Activate_About
51452>>>//      Local String sTitle sCopyright sVersion sAuthor
51452>>>//      Move "My Order Entry System" to sTitle
51452>>>//      Move "Version 2.1" to sVersion
51452>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
51452>>>//      Move "John Smith"  to sAuthor
51452>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
51452>>>//   end_procedure
51452>>>//   // end of file.
51452>>>
51452>>>
51452>>>
51452>>>//Use DfAbout.Sub
51452>>>Use DfAbout.pkg
Including file: DFABOUT.PKG    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\DFABOUT.PKG)
51452>>>>>//************************************************************************
51452>>>>>// Confidential Trade Secret.
51452>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
51452>>>>>// as an unpublished work.  All rights reserved.
51452>>>>>// DataFlex is a registered trademark of Data Access Corporation.
51452>>>>>//
51452>>>>>//************************************************************************
51452>>>>>//************************************************************************
51452>>>>>//
51452>>>>>// $File name  : DfAbout.pkg
51452>>>>>// $File title : About class support
51452>>>>>// Notice      :
51452>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
51452>>>>>//
51452>>>>>// $Rev History
51452>>>>>//
51452>>>>>// JJT 10/23/2001 removed all ghoworkspace support. Uses app object or nothing
51452>>>>>// SWB 07/19/01   Added support of the Application object in preference to
51452>>>>>//                the global Workspace object, if it is present
51452>>>>>// JJT 11/05/98   Added version information
51452>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
51452>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
51452>>>>>//                workspace package.
51452>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
51452>>>>>//                class can create this object.
51452>>>>>//                Cleaned up the interface (used correct classes and messages)
51452>>>>>//                Added workspace reporting support to sys-info.
51452>>>>>//                Turned off wrapping in the sys-info editor.
51452>>>>>// KR  ??/??/96   File created
51452>>>>>//************************************************************************
51452>>>>>Use LanguageText.pkg
51452>>>>>Use windows.pkg
51452>>>>>Use DFbitmap.pkg
51452>>>>>Use GlobalFunctionsProcedures.pkg
51452>>>>>
51452>>>>>    External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;        Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
51453>>>>>
51453>>>>>//#IFDEF ghoApplication
51453>>>>>//#ELSE
51453>>>>>//    Global_Variable Integer ghoApplication
51453>>>>>//    Move 0 To ghoApplication
51453>>>>>//#ENDIF
51453>>>>>
51453>>>>>Register_Function phoWorkspace Returns Handle
51453>>>>>Register_Function psHelpFile Returns String
51453>>>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
51453>>>>>
51453>>>>>//****************************************************************************
51453>>>>>// $Module type: FUNCTION
51453>>>>>// $Module name: Network_User_Name
51453>>>>>// $Author     : AK/VOO/KCR
51453>>>>>// Created     : 24-09-96 @ 19:17
51453>>>>>//
51453>>>>>// Description
51453>>>>>//    This function reads the current username of windows and returns that
51453>>>>>//    name or an text unknown user
51453>>>>>//
51453>>>>>// $Rev History
51453>>>>>//    24-09-96  Module header created
51453>>>>>//****************************************************************************
51453>>>>>//Function Network_User_Name Returns String
51453>>>>>//    String sName sLength
51453>>>>>//    Pointer lpName_Addr lpLength_Addr
51453>>>>>//    Integer iRetval
51453>>>>>//
51453>>>>>//    Movestr (Repeat (Character (0), 255)) To sName
51453>>>>>//    GetAddress Of sName To lpName_Addr
51453>>>>>//    Movestr (DwordToBytes (255)) To sLength
51453>>>>>//    GetAddress Of sLength To lpLength_Addr
51453>>>>>//
51453>>>>>//    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
51453>>>>>//
51453>>>>>//    If iRetval Eq 0 Function_Return (CString (sName))
51453>>>>>//    Else Function_Return "€š¤à©«¦ª •¨ã©«žª"
51453>>>>>//End_Function // Network_User_Name
51453>>>>>
51453>>>>>Type MEMORYSTATUS
51453>>>>>   Field MEMORYSTATUS.dwLength         As Dword // sizeof(MEMORYSTATUS)
51453>>>>>   Field MEMORYSTATUS.dwMemoryLoad     As Dword // percent of memory in use
51453>>>>>   Field MEMORYSTATUS.dwTotalPhys      As Dword // bytes of physical memory
51453>>>>>   Field MEMORYSTATUS.dwAvailPhys      As Dword // free physical memory bytes
51453>>>>>   Field MEMORYSTATUS.dwTotalPageFile  As Dword // bytes of paging file
51453>>>>>   Field MEMORYSTATUS.dwAvailPageFile  As Dword // free bytes of paging file
51453>>>>>   Field MEMORYSTATUS.dwTotalVirtual   As Dword // user bytes of address space
51453>>>>>   Field MEMORYSTATUS.dwAvailVirtual   As Dword // free user bytes
51453>>>>>End_Type // MEMORYSTATUS
51453>>>>>
51453>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
51454>>>>>
51454>>>>>Class SysinfoDisplay Is An Edit
51455>>>>>    Procedure Construct_Object
51457>>>>>        Forward Send construct_object
51459>>>>>
51459>>>>>        Set Location To 6 6
51460>>>>>        Set Size To 110 255
51461>>>>>        Set Read_Only_State To True
51462>>>>>        Set wrap_state To False
51463>>>>>    End_Procedure
51464>>>>>
51464>>>>>    //****************************************************************************
51464>>>>>    // $Module type: PROCEDURE
51464>>>>>    // $Module name: Add_Line
51464>>>>>    // $Author     : VOO
51464>>>>>    // Created     : 06-10-96 @ 15:23
51464>>>>>    //
51464>>>>>    // Description
51464>>>>>    //    This method will add a line to this edit object, it should go simpler
51464>>>>>    //    but it seems to be done this way.
51464>>>>>    //
51464>>>>>    // $Rev History
51464>>>>>    //    06-10-96  Module header created
51464>>>>>    //****************************************************************************
51464>>>>>    Procedure Add_Line String sVal
51466>>>>>        Integer iLine
51466>>>>>
51466>>>>>        Moveint (Line_Count(Self)) To iLine
51467>>>>>>
51467>>>>>        If (iLine = 1 And Changed_State(Self) = False) Moveint 0 To iLine
51470>>>>>        Set Value Item iLine To sVal
51471>>>>>    End_Procedure // Add_Line
51472>>>>>
51472>>>>>    //****************************************************************************
51472>>>>>    // $Module type: PROCEDURE
51472>>>>>    // $Module name: Show_Current_Directory
51472>>>>>    // $Author     : VOO
51472>>>>>    // Created     : 06-10-96 @ 15:24
51472>>>>>    //
51472>>>>>    // Description
51472>>>>>    //    This method will show the name of the current directory in the system
51472>>>>>    //    information box
51472>>>>>    //
51472>>>>>    // $Rev History
51472>>>>>    //    06-10-96  Module header created
51472>>>>>    //****************************************************************************
51472>>>>>    Procedure Show_Current_Directory
51474>>>>>        String sDir
51474>>>>>
51474>>>>>        Get_Current_Directory To sDir
51475>>>>>        Send Add_Line (SFormat(C_$CurrentDirectory, sDir))
51476>>>>>    End_Procedure // Show_Current_Directory
51477>>>>>
51477>>>>>    Procedure Show_Windows_Directory
51479>>>>>        String sWindir
51479>>>>>
51479>>>>>        Get_Windows_Directory To sWindir
51480>>>>>        Send Add_Line (SFormat(C_$WindowsDirectory, sWindir))
51481>>>>>    End_Procedure // Show_Windows_Directory
51482>>>>>
51482>>>>>    Procedure Show_Current_User
51484>>>>>        //Send Add_Line (SFormat(C_$NetworkUserName, Network_User_Name(Self)))
51484>>>>>    End_Procedure // Show_Current_User
51485>>>>>
51485>>>>>    Procedure Show_Number_Format
51487>>>>>        Integer iFormat
51487>>>>>
51487>>>>>        Get_Attribute Df_Thousands_Separator To iFormat
51490>>>>>        Send Add_Line (SFormat(C_$ThousandsSeparator, Character(iFormat), iFormat))
51491>>>>>        Get_Number_Format To iFormat
51492>>>>>        Send Add_Line (SFormat(C_$DecimalSeparator, If (iFormat = 0, ".", ",")))
51493>>>>>    End_Procedure // Show_Number_Format
51494>>>>>
51494>>>>>    Procedure Show_Filelist_Name
51496>>>>>        String sFilename
51496>>>>>
51496>>>>>        Get_Attribute Df_Filelist_Name To sFilename
51499>>>>>        Send Add_Line (SFormat(C_$CurrentFilelist, sFilename))
51500>>>>>    End_Procedure // Show_Filelist_Name
51501>>>>>
51501>>>>>    Procedure Show_Lock_Delay
51503>>>>>        Integer iLockdelay
51503>>>>>
51503>>>>>        Get_Attribute Df_Lock_Delay To iLockdelay
51506>>>>>        Send Add_Line (SFormat(C_$DatabaseLockingDelay, iLockDelay))
51507>>>>>    End_Procedure // Show_Lock_Delay
51508>>>>>
51508>>>>>    Procedure Show_Lock_Timeout
51510>>>>>        Integer iLockTimeout
51510>>>>>
51510>>>>>        Get_Attribute Df_Lock_Timeout To iLockTimeout
51513>>>>>        Send Add_Line (SFormat(C_$DatabaseLockingTimeout, iLockTimeOut))
51514>>>>>    End_Procedure // Show_Lock_Timeout
51515>>>>>
51515>>>>>    Procedure Show_Screen_Size
51517>>>>>        Integer iYscreensize iXscreensize
51517>>>>>
51517>>>>>        Moveint (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
51518>>>>>>
51518>>>>>        Moveint (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
51519>>>>>>
51519>>>>>
51519>>>>>        Send Add_Line (SFormat(C_$VideoResolution, iXscreensize, iYscreensize))
51520>>>>>    End_Procedure // Show_Screen_Size
51521>>>>>
51521>>>>>    Procedure Show_Page_Size
51523>>>>>        Send Add_Line (SFormat(C_$PageEndFormFeed, Pageend, Pagefeed))
51524>>>>>    End_Procedure
51525>>>>>
51525>>>>>    Procedure Show_Date
51527>>>>>        Date dToday
51527>>>>>
51527>>>>>        Sysdate4 dToday
51528>>>>>        Send Add_Line (SFormat(C_$CurrentSystemDate, String(dToday)))
51529>>>>>    End_Procedure // Show_Date
51530>>>>>
51530>>>>>    Procedure Show_Date_Format
51532>>>>>        Integer iDateFormat
51532>>>>>        String sDateFormat
51532>>>>>
51532>>>>>        Get_Attribute Df_Date_Format To iDateFormat
51535>>>>>        If iDateFormat Eq DF_DATE_USA ;            Movestr C_$USA To sDateFormat
51538>>>>>        Else If iDateformat Eq DF_DATE_EUROPEAN ;            Movestr C_$European To sDateFormat
51542>>>>>        Else If iDateformat Eq DF_DATE_MILITARY ;            Movestr C_$Military To sDateFormat
51546>>>>>        Else ;            Movestr C_$UnknownDateType To sDateFormat
51548>>>>>        Send Add_Line (SFormat(C_$DateFormat, sDateformat))
51549>>>>>    End_Procedure // Show_Date_Format
51550>>>>>
51550>>>>>    Procedure Show_Memavail
51552>>>>>        Integer iMem
51552>>>>>
51552>>>>>        Memory iMem
51553>>>>>>
51553>>>>>        Send Add_Line (SFormat(C_$AvailableMemory, iMem))
51554>>>>>    End_Procedure // Show_Memavail
51555>>>>>
51555>>>>>    Procedure Show_Systemresources
51557>>>>>        String sMemoryStatus
51557>>>>>        Pointer lpsMemoryStatus
51557>>>>>        Integer iVoid
51557>>>>>        Dword dwMemoryLoad dwTotalPhys dwAvailPhys dwTotalPageFile dwAvailPageFile dwTotalVirtual dwAvailVirtual
51557>>>>>
51557>>>>>        ZeroType MEMORYSTATUS To sMemoryStatus
51558>>>>>        GetAddress Of sMemoryStatus To lpsMemoryStatus
51559>>>>>
51559>>>>>        Moveint (GlobalMemoryStatus (lpsMemoryStatus)) To iVoid
51560>>>>>>
51560>>>>>
51560>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwMemoryLoad    To dwMemoryLoad
51561>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPhys     To dwTotalPhys
51562>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPhys     To dwAvailPhys
51563>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPageFile To dwTotalPageFile
51564>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPageFile To dwAvailPageFile
51565>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalVirtual  To dwTotalVirtual
51566>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailVirtual  To dwAvailVirtual
51567>>>>>
51567>>>>>        Send Add_Line (SFormat(C_$MemoryUtilization, dwMemoryLoad))
51568>>>>>        Send Add_Line (SFormat(C_$AvailablePhysicalMemory, dwAvailPhys / dwTotalPhys * 100.0))
51569>>>>>        Send Add_Line (SFormat(C_$AvailablePagefileSpace, dwAvailPageFile / dwTotalPageFile * 100.0))
51570>>>>>        Send Add_Line (SFormat(C_$AvailableVirtualMemory, dwAvailVirtual / dwTotalVirtual * 100.0))
51571>>>>>    End_Procedure // Show_Systemresources
51572>>>>>
51572>>>>>    Procedure Show_Registration
51574>>>>>        String sRegName
51574>>>>>        Integer iSN
51574>>>>>        Registration sRegName iSN
51575>>>>>>
51575>>>>>
51575>>>>>        Send Add_Line (SFormat(C_$Serial, iSN))
51576>>>>>        Send Add_Line (SFormat(C_$RegName, sRegName))
51577>>>>>
51577>>>>>    End_Procedure // Show_Current_Directory
51578>>>>>
51578>>>>>
51578>>>>>
51578>>>>>    //****************************************************************************
51578>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
51578>>>>>    // to the workspace object passing the an object and message to send back
51578>>>>>    // to this object. It is expected that the workspace object will send this
51578>>>>>    // message for every line of information it wants displayed (passing the
51578>>>>>    // information to be displayed
51578>>>>>    //****************************************************************************
51578>>>>>    Register_Procedure EnumerateWorkspaceData Integer hObjId Integer hmMessId
51578>>>>>
51578>>>>>    Procedure Show_ServicePack
51580>>>>>        String sVersion
51580>>>>>        Get_Profile_String "" "CurrentVersionDescription" To sVersion
51583>>>>>        If (sVersion <> "") Begin
51585>>>>>           Send Add_Line sVersion
51586>>>>>           Send Add_Line ""
51587>>>>>        End
51587>>>>>>
51587>>>>>    End_Procedure
51588>>>>>
51588>>>>>    Procedure Show_WorkspaceInformation
51590>>>>>        If ghoApplication ;            Send EnumerateWorkspaceData Of (phoWorkspace(ghoApplication)) Self Msg_add_Line
51593>>>>>
51593>>>>>        // removed for VDF8
51593>>>>>        //Else If ghoWorkspace ;
51593>>>>>        //    Send EnumerateWorkspaceData of ghoWorkspace self Msg_add_Line
51593>>>>>    End_Procedure
51594>>>>>
51594>>>>>    Function VersionStr Integer iVer Integer iRev Integer iBld Returns String
51596>>>>>        Function_Return (String(iVer)-"."-String(iRev)-"."-String(iBld))
51597>>>>>    End_Function
51598>>>>>
51598>>>>>    Procedure Show_Versions
51600>>>>>        Integer iVersion iRevision iBuild
51600>>>>>        Version_information iVersion iRevision iBuild
51602>>>>>        Send Add_Line (SFormat(C_$RuntimeVersion, VersionStr(Self,iVersion,iRevision,iBuild) ))
51603>>>>>        Send Add_Line (SFormat(C_$PackageVersion, VersionStr(Self,PKG_VERSION, PKG_REVISION, PKG_BUILD) ))
51604>>>>>        Send Add_Line (SFormat(C_$FMACVersion, VersionStr(Self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) ))
51605>>>>>    End_Procedure
51606>>>>>
51606>>>>>
51606>>>>>    //***
51606>>>>>    //*** BW
51606>>>>>    //*** Procedure: Show_Drivers
51606>>>>>    //*** Purpose  : Show loaed database drivers
51606>>>>>    //***
51606>>>>>
51606>>>>>    Procedure Show_Drivers
51608>>>>>        String  Current_drvr
51608>>>>>        String  Loadeddrvrs
51608>>>>>        Integer Number_of_drvrs
51608>>>>>        Integer Count
51608>>>>>
51608>>>>>        Move "" To Loadeddrvrs
51609>>>>>        Get_Attribute DF_NUMBER_DRIVERS To Number_of_drvrs
51612>>>>>        For Count From 1 To Number_of_drvrs
51618>>>>>>
51618>>>>>            Get_Attribute DF_DRIVER_NAME Of Count To Current_drvr
51621>>>>>            If (Loadeddrvrs <> "") ;                Move (Append(Loadeddrvrs, ", ")) To Loadeddrvrs
51624>>>>>            Move (Append(Loadeddrvrs, Current_drvr)) To Loadeddrvrs
51625>>>>>        Loop
51626>>>>>>
51626>>>>>        Send Add_Line (SFormat(C_$DatabaseDriver, Loadeddrvrs))
51627>>>>>    End_Procedure // Show_Drivers
51628>>>>>
51628>>>>>    Procedure Show_HelpFile
51630>>>>>        Send Add_Line ""
51631>>>>>        Send Add_Line (SFormat(C_$HelpFile,  psHelpFile(ghoApplication)))
51632>>>>>    End_Procedure
51633>>>>>
51633>>>>>    Procedure Show_EnterAsTab
51635>>>>>        Send Add_Line (SFormat(C_$EnterKeyNavForward, If(pbEnterKeyAsTabKey(ghoApplication),"True","False")))
51636>>>>>    End_Procedure
51637>>>>>
51637>>>>>    //****************************************************************************
51637>>>>>    // $Module type: PROCEDURE
51637>>>>>    // $Module name: Add_Focus
51637>>>>>    // $Author     : VOO
51637>>>>>    // Created     : 24-09-96 @ 19:43
51637>>>>>    //
51637>>>>>    // Description
51637>>>>>    //    During activation we will remove the old information and add the newly
51637>>>>>    //    found systeminformation
51637>>>>>    //
51637>>>>>    // $Rev History
51637>>>>>    //    24-09-96  Module header created
51637>>>>>    //****************************************************************************
51637>>>>>    Procedure Add_Focus Integer hoRoot
51639>>>>>        Forward Send Add_Focus hoRoot
51641>>>>>
51641>>>>>        Send Delete_Data
51642>>>>>        Set Changed_State To False
51643>>>>>        Set Read_Only_State To True
51644>>>>>        Send Show_ServicePack
51645>>>>>        Send Show_WorkSpaceInformation // added to show WS info
51646>>>>>        If ghoApplication Begin
51648>>>>>            Send Show_HelpFile
51649>>>>>            Send Show_EnterAsTab
51650>>>>>        End
51650>>>>>>
51650>>>>>        Send Show_Drivers
51651>>>>>        Send Show_Current_User
51652>>>>>        Send Show_Windows_Directory
51653>>>>>        Send Show_Current_Directory
51654>>>>>        Send Show_Filelist_Name
51655>>>>>        Send Show_Versions
51656>>>>>        Send Show_Memavail
51657>>>>>        Send Show_Screen_Size
51658>>>>>        Send Show_Page_Size
51659>>>>>        Send Show_Number_Format
51660>>>>>        Send Show_Date_Format
51661>>>>>        Send Show_Lock_Delay
51662>>>>>        Send Show_Lock_Timeout
51663>>>>>        Send Show_Date
51664>>>>>        Send Show_Systemresources
51665>>>>>        //Send Show_Registration
51665>>>>>    End_Procedure // Show_All_Info
51666>>>>>
51666>>>>>End_Class // SysinfoDisplay
51667>>>>>
51667>>>>>
51667>>>>>//****************************************************************************
51667>>>>>// $Module type: OBJECT
51667>>>>>// $Module name: Sysinfo_Dialog
51667>>>>>// $Author     : VOO
51667>>>>>// Created     : 24-09-96 @ 18:47
51667>>>>>//
51667>>>>>// Description
51667>>>>>//    This object shows the systeminformation on the screen
51667>>>>>//
51667>>>>>// $Rev History
51667>>>>>//    24-09-96  Module header created
51667>>>>>//****************************************************************************
51667>>>>>Class SysInfoDialog Is A ModalPanel
51668>>>>>    Procedure Construct_Object
51670>>>>>        Forward Send construct_object
51672>>>>>
51672>>>>>        Set Caption_Bar To True
51673>>>>>        Set Sysmenu_Icon To True
51674>>>>>        Set Label To C_$SystemInformation
51675>>>>>        Set Size To 152 270
51676>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
51677>>>>>        Set Minimize_Icon To False
51678>>>>>        Set Maximize_Icon To False
51679>>>>>        Set Border_Style To Border_Thick
51680>>>>>
51680>>>>>        Object Sysinfo_Display Is A SysInfoDisplay
51682>>>>>        End_Object
51683>>>>>
51683>>>>>        Object Close_Button Is A Button
51685>>>>>            Set Label To C_$Close
51686>>>>>            Set Location To 120 212
51687>>>>>            Set Message Item 0 To msg_Close_Panel
51688>>>>>            Set default_action_button To Self
51689>>>>>        End_Object // Close_Button
51690>>>>>
51690>>>>>        On_Key Kcancel       Send Close_Panel
51691>>>>>    End_Procedure
51692>>>>>
51692>>>>>    //****************************************************************************
51692>>>>>    // $Module type: PROCEDURE
51692>>>>>    // $Module name: OnResize
51692>>>>>    // $Author     : VO
51692>>>>>    // Created     : 05/16/00 @ 3:40
51692>>>>>    //
51692>>>>>    // Description
51692>>>>>    //      When the dialog is resized relocate the edit object and button
51692>>>>>    //
51692>>>>>    // $Rev History
51692>>>>>    //      05/16/00 VO Module header created
51692>>>>>    //****************************************************************************
51692>>>>>    Procedure OnResize
51694>>>>>        Integer iPanelGuiSize
51694>>>>>
51694>>>>>        Get GuiSize To iPanelGuiSize
51695>>>>>        Set GuiSize Of Sysinfo_Display To (Hi (iPanelGuiSize) - 70) (Low (iPanelGuiSize) - 25)
51696>>>>>        Set GuiLocation Of Close_Button To (Hi (iPanelGuiSize) - 50) (Low (iPanelGuiSize) - 90)
51697>>>>>
51697>>>>>        Send Adjust_Logicals
51698>>>>>    End_Procedure // OnResize
51699>>>>>End_Class // SysinfoDialog
51700>>>>>
51700>>>>>// Purpose:
51700>>>>>//
51700>>>>>// Ken Ross 12/17/96 5:16PM
51700>>>>>//
51700>>>>>Class AboutDialog Is A ModalPanel
51701>>>>>
51701>>>>>    Procedure construct_object
51703>>>>>        String sVdfRootDir
51703>>>>>        Forward Send construct_object
51705>>>>>        Set Label To C_$About
51706>>>>>        Set Size To 100 217
51707>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
51708>>>>>
51708>>>>>        Object SysInfo_Dialog Is A SysInfoDialog
51710>>>>>        End_Object
51711>>>>>
51711>>>>>        Object oBox Is A Container3d
51713>>>>>            Set Border_Style To Border_StaticEdge
51714>>>>>            Set Size To 63 202
51715>>>>>            Set Location To 4 5
51716>>>>>
51716>>>>>            Object oAboutGraphic Is A BitmapContainer
51718>>>>>                Set Border_Style To Border_None
51719>>>>>                Set Bitmap_Style To Bitmap_Center
51720>>>>>                Set Size To 48 48
51721>>>>>                Set Location To 7 2
51722>>>>>            End_Object    // AboutGraphic
51723>>>>>
51723>>>>>            Object oProductName Is A TextBox
51725>>>>>                Set label To C_$ProductName
51726>>>>>                Set Size To 10 45
51727>>>>>                Set Location To 8 53
51728>>>>>            End_Object    // ProductName
51729>>>>>
51729>>>>>            Object oVersion Is A TextBox
51731>>>>>                Set label To C_$Version
51732>>>>>                Set Size To 10 25
51733>>>>>                Set Location To 21 53
51734>>>>>            End_Object    // Version
51735>>>>>
51735>>>>>            Object oCopyright Is A TextBox
51737>>>>>                Set label To C_$Copyright
51738>>>>>                Set Size To 10 31
51739>>>>>                Set Location To 34 53
51740>>>>>            End_Object    // Copyright
51741>>>>>
51741>>>>>            Object oAuthor Is A TextBox
51743>>>>>                Set label To C_$Author
51744>>>>>                Set Size To 10 22
51745>>>>>                Set Location To 46 53
51746>>>>>            End_Object    // Author
51747>>>>>
51747>>>>>        End_Object    // oBox
51748>>>>>
51748>>>>>        Object OK_bn Is A Button
51750>>>>>            On_Item C_$OK Send Close_Panel
51751>>>>>            Set Size To 14 50
51752>>>>>            Set Location To 71 157
51753>>>>>        End_Object    // OK_bn
51754>>>>>
51754>>>>>        Object SysInfo_bn Is A Button
51756>>>>>            On_Item C_$SystemInfo Send Show_Sysinfo
51757>>>>>            Set Size To 14 50
51758>>>>>            Set Location To 71 101
51759>>>>>        End_Object    // SysInfo_bn
51760>>>>>
51760>>>>>        On_Key Kcancel Send KeyAction Of Ok_bn
51761>>>>>
51761>>>>>//        Get_Profile_String "Defaults" "VdfRootDir" To sVdfRootDir
51761>>>>>//        Set logo to (sVdfRootDir +"\Bitmaps\DacAbout.bmp")  // square bitmaps of 42x42 work best
51761>>>>>        Set logo To "DacAbout.bmp"  // square bitmaps of 42x42 work best
51762>>>>>
51762>>>>>    End_Procedure
51763>>>>>
51763>>>>>    Procedure Set ProductName String sProductName
51765>>>>>        Set label Of oProductName To sProductName
51766>>>>>    End_Procedure
51767>>>>>
51767>>>>>    Procedure Set Version String sVersion
51769>>>>>        Set label Of oVersion To sVersion
51770>>>>>    End_Procedure
51771>>>>>
51771>>>>>    Procedure Set Copyright String sCopyright
51773>>>>>        Set label Of oCopyright To sCopyright
51774>>>>>    End_Procedure
51775>>>>>
51775>>>>>    Procedure Set Author String sAuthor
51777>>>>>        Set Label Of oAuthor To sAuthor
51778>>>>>    End_Procedure
51779>>>>>
51779>>>>>    Procedure Set Logo String sLogo
51781>>>>>        // square bitmaps of 42x42 work best
51781>>>>>        Set Bitmap Of oAboutGraphic To sLogo
51782>>>>>    End_Procedure
51783>>>>>
51783>>>>>    Procedure Show_Sysinfo
51785>>>>>        Send Popup_Modal Of Sysinfo_Dialog
51786>>>>>    End_Procedure // Show_Sysinfo
51787>>>>>
51787>>>>>    Procedure End_Construct_Object
51789>>>>>        Handle hoVersionInfo
51789>>>>>        Boolean bIncluded
51789>>>>>        Integer iMajor iMinor iRelease iBuild
51789>>>>>
51789>>>>>        If (Label(oVersion) = C_$VERSION) Begin
51791>>>>>            // set it to the version info of the program, if available
51791>>>>>            If (ghoApplication) Begin
51793>>>>>                Get phoVersionInfo Of ghoApplication To hoVersionInfo
51794>>>>>                Get pbIncluded Of hoVersionInfo To bIncluded
51795>>>>>                If bIncluded Begin
51797>>>>>                    Get piVersionMajor   Of hoVersionInfo To iMajor
51798>>>>>                    Get piVersionMinor   Of hoVersionInfo To iMinor
51799>>>>>                    Get piVersionRelease Of hoVersionInfo To iRelease
51800>>>>>                    Get piVersionBuild   Of hoVersionInfo To iBuild
51801>>>>>
51801>>>>>                    Set Version To (SFormat(C_$VERSION +": %1.%2.%3.%4", iMajor, iMinor, iRelease, iBuild))
51802>>>>>                End
51802>>>>>>
51802>>>>>            End
51802>>>>>>
51802>>>>>        End
51802>>>>>>
51802>>>>>        Forward Send End_Construct_Object
51804>>>>>    End_Procedure
51805>>>>>
51805>>>>>End_Class
51806>>>>>
51806>>>>>
51806>>>>>//Object About_Dialog is an AboutDialog
51806>>>>>//    set productname to "Visual DataFlex"
51806>>>>>//    set version to "version 4.0"
51806>>>>>//    set copyright to "Copyright 1997 Data Access Corporation"
51806>>>>>//    set author to ""
51806>>>>>//    set logo to "ablogo.bmp"  // square bitmaps of 42x42 work best
51806>>>>>//End_Object
51806>>>>>
51806>>>>>//Procedure Activate_About
51806>>>>>//   Send Popup_Modal of About_Dialog
51806>>>>>//End_Procedure
51806>>>
51806>>>
51806>>>
51806>>>
51806>>>// *************************************************************************
51806>>>//  Public message. This is the default message. It is expected that you will
51806>>>//   create your own message to override this
51806>>>// *************************************************************************
51806>>>
51806>>>Procedure Activate_About
51809>>>   Send DoAbout "" "" "" "" ""
51810>>>End_Procedure
51811>>>
51811>>>// *************************************************************************
51811>>>//  Public message. It is expected that you will send this message (most
51811>>>//  likely from Activate_About. This creates an about object, activates it
51811>>>//  and destroys it when done. It is not exepected that you will augment this.
51811>>>// *************************************************************************
51811>>>
51811>>>Procedure DoAbout String sTitle String sVersion String sCopyRight String sAuthor String sBitmap
51814>>>        Local Integer hoObj hoMain
51814>>>
51814>>>        // create object
51814>>>        Object About Is An AboutDialog
51816>>>            // if no title passed use the label of the main panel
51816>>>            // (if a main panel exists).
51816>>>            If sTitle     Eq '' Begin
51818>>>                Get Main_Window To hoMain
51819>>>                If hoMain Get Label Of hoMain To sTitle
51822>>>            End
51822>>>>
51822>>>            Set productname To sTitle
51823>>>            Set version     To sVersion
51824>>>            Set copyright   To sCopyRight
51825>>>            Set author      To sAuthor
51826>>>            If sBitmap    Ne '' ;               Set logo To sBitMap // square bitmaps of 42x42 work best
51829>>>            Move Current_Object To hoObj // object Id
51830>>>        End_Object
51831>>>        Send Popup To hoObj    // popup the about object
51832>>>        Send Request_Destroy_Object To hoObj // when done, it will be destroyed
51833>>>End_Procedure
51834>        //------
51834>        Use ClientsCN.vw
Including file: ClientsCN.vw    (L:\VDF14.1.Dev\TITAN_MIGRATE\AppSrc\ClientsCN.vw)
51834>>>// L:\VDF14.1.Dev\TITAN_MIGRATE\AppSrc\ClientsCN.vw
51834>>>// ClientsCN
51834>>>//
51834>>>
51834>>>Use DFClient.pkg
51834>>>Use DFEntry.pkg
51834>>>Use DfTable.pkg
51834>>>Use Micities.dd
Including file: Micities.dd    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\Micities.dd)
51834>>>>>Use DataDict.pkg
51834>>>>>
51834>>>>>Open MICITIES
51836>>>>>Open MICLIENT
51838>>>>>Open TOWNS
51840>>>>>
51840>>>>>Class Micities is a DataDictionary
51841>>>>>    
51841>>>>>    Procedure Construct_Object
51843>>>>>        Forward Send Construct_Object
51845>>>>>        Set Main_file to MICITIES.File_Number
51846>>>>>
51846>>>>>        Set Add_Server_File to TOWNS.File_Number
51847>>>>>
51847>>>>>        Set Add_Client_File to MICLIENT.File_Number
51848>>>>>
51848>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
51849>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
51850>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
51851>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
51852>>>>>
51852>>>>>    End_Procedure
51853>>>>>
51853>>>>>End_Class
51854>>>Use Miareas.dd
Including file: Miareas.dd    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\Miareas.dd)
51854>>>>>Use DataDict.pkg
51854>>>>>
51854>>>>>Open MIAREAS
51856>>>>>Open MICLIENT
51858>>>>>
51858>>>>>Class Miareas is a DataDictionary
51859>>>>>    
51859>>>>>    Procedure Construct_Object
51861>>>>>        Forward Send Construct_Object
51863>>>>>        Set Main_file to MIAREAS.File_Number
51864>>>>>
51864>>>>>        Set Add_Client_File to MICLIENT.File_Number
51865>>>>>
51865>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
51866>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
51867>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
51868>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
51869>>>>>
51869>>>>>    End_Procedure
51870>>>>>
51870>>>>>End_Class
51871>>>Use Mipresp.dd
Including file: Mipresp.dd    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\Mipresp.dd)
51871>>>>>Use DataDict.pkg
51871>>>>>
51871>>>>>Open MIPRESP
51873>>>>>Open MICLIENT
51875>>>>>
51875>>>>>Class Mipresp is a DataDictionary
51876>>>>>    
51876>>>>>    Procedure Construct_Object
51878>>>>>        Forward Send Construct_Object
51880>>>>>        Set Main_file to MIPRESP.File_Number
51881>>>>>
51881>>>>>        Set Add_Client_File to MICLIENT.File_Number
51882>>>>>
51882>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
51883>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
51884>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
51885>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
51886>>>>>
51886>>>>>    End_Procedure
51887>>>>>
51887>>>>>End_Class
51888>>>Use Miclient.dd
Including file: Miclient.dd    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\Miclient.dd)
51888>>>>>Use DataDict.pkg
51888>>>>>
51888>>>>>Open MICLIENT
51890>>>>>Open MICN
51892>>>>>Open MICITIES
51894>>>>>Open MIAREAS
51896>>>>>Open MIPRESP
51898>>>>>
51898>>>>>Register_Object Miclient_sl
51898>>>>>
51898>>>>>Class Miclient is a DataDictionary
51899>>>>>    
51899>>>>>    Procedure Construct_Object
51901>>>>>        Forward Send Construct_Object
51903>>>>>        Set Main_file to MICLIENT.File_Number
51904>>>>>
51904>>>>>        Set Add_Server_File to MICITIES.File_Number
51905>>>>>        Set Add_Server_File to MIAREAS.File_Number
51906>>>>>        Set Add_Server_File to MIPRESP.File_Number
51907>>>>>
51907>>>>>        Set Add_Client_File to MICN.File_Number
51908>>>>>
51908>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
51909>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
51910>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
51911>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
51912>>>>>
51912>>>>>        Set Field_Prompt_Object Field MICLIENT.CLIENT_ID to Miclient_sl
51913>>>>>
51913>>>>>        Set Field_Prompt_Object Field MICLIENT.CLIENT_NAME to Miclient_sl
51914>>>>>
51914>>>>>        Set Field_Prompt_Object Field MICLIENT.CLIENT_AFM to Miclient_sl
51915>>>>>
51915>>>>>    End_Procedure
51916>>>>>
51916>>>>>End_Class
51917>>>>>
51917>>>>>Use Miclient.sl
Including file: Miclient.sl    (L:\VDF14.1.Dev\TITAN_MIGRATE\AppSrc\Miclient.sl)
51917>>>>>>>// Miclient.sl
51917>>>>>>>// Miclient Lookup List
51917>>>>>>>
51917>>>>>>>Use DFClient.pkg
51917>>>>>>>Use DFSelLst.pkg
51917>>>>>>>Use Windows.pkg
51917>>>>>>>
51917>>>>>>>Use Micities.dd
51917>>>>>>>Use Miareas.dd
51917>>>>>>>Use Mipresp.dd
51917>>>>>>>Use Miclient.dd
51917>>>>>>>
51917>>>>>>>CD_Popup_Object Miclient_sl is a dbModalPanel
51935>>>>>>>>
51935>>>>>>>    Set Location to 5 5
51936>>>>>>>    Set Size to 134 610
51937>>>>>>>    Set Label To "Miclient Lookup List"
51938>>>>>>>    Set Border_Style to Border_Thick
51939>>>>>>>    Set Minimize_Icon to False
51940>>>>>>>
51940>>>>>>>
51940>>>>>>>    Object oMicities_DD Is A Micities
51942>>>>>>>    End_Object // oMicities_DD
51943>>>>>>>
51943>>>>>>>    Object oMiareas_DD Is A Miareas
51945>>>>>>>    End_Object // oMiareas_DD
51946>>>>>>>
51946>>>>>>>    Object oMipresp_DD Is A Mipresp
51948>>>>>>>    End_Object // oMipresp_DD
51949>>>>>>>
51949>>>>>>>    Object oMiclient_DD Is A Miclient
51951>>>>>>>        Set DDO_Server To oMicities_DD
51952>>>>>>>        Set DDO_Server To oMiareas_DD
51953>>>>>>>        Set DDO_Server To oMipresp_DD
51954>>>>>>>    End_Object // oMiclient_DD
51955>>>>>>>
51955>>>>>>>    Set Main_DD To oMiclient_DD
51956>>>>>>>    Set Server  To oMiclient_DD
51957>>>>>>>
51957>>>>>>>
51957>>>>>>>
51957>>>>>>>    Object oSelList Is A dbList
51959>>>>>>>        Set Size to 105 600
51960>>>>>>>        Set Location to 5 5
51961>>>>>>>        Set peAnchors to anAll
51962>>>>>>>        Set Main_File to Miclient.File_Number
51963>>>>>>>        Set Ordering to 1
51964>>>>>>>        Set peResizeColumn to rcAll
51965>>>>>>>        Set Auto_Server_State to True
51966>>>>>>>        Set pbHeaderTogglesDirection to True
51967>>>>>>>
51967>>>>>>>        Begin_row
51970>>>>>>>            Entry_Item Miclient.Client_Id
51971>>>>>>>            Entry_Item Miclient.Client_Name
51972>>>>>>>            Entry_Item Miclient.Client_Afm
51973>>>>>>>            Entry_Item Miclient.Client_Address
51974>>>>>>>            Entry_Item Miclient.Client_Phone
51975>>>>>>>        End_row
51980>>>>>>>
51980>>>>>>>        Set Form_Width 0 to 84
51981>>>>>>>        Set Header_Label 0 to "Client Id"
51982>>>>>>>
51982>>>>>>>        Set Form_Width 1 to 150
51983>>>>>>>        Set Header_Label 1 to "Client Name"
51984>>>>>>>
51984>>>>>>>        Set Form_Width 2 to 74
51985>>>>>>>        Set Header_Label 2 to "Client Afm"
51986>>>>>>>
51986>>>>>>>        Set Form_Width 3 to 150
51987>>>>>>>        Set Header_Label 3 to "Client Address"
51988>>>>>>>
51988>>>>>>>        Set Form_Width 4 to 137
51989>>>>>>>        Set Header_Label 4 to "Client Phone"
51990>>>>>>>
51990>>>>>>>    End_Object // oSelList
51991>>>>>>>
51991>>>>>>>    Object oOk_bn Is A Button
51993>>>>>>>        Set Label to "&Ok"
51994>>>>>>>        Set Location to 115 447
51995>>>>>>>        Set peAnchors to anBottomRight
51996>>>>>>>
51996>>>>>>>        Procedure OnClick
51999>>>>>>>            Send OK of oSelList
52000>>>>>>>        End_Procedure
52001>>>>>>>
52001>>>>>>>    End_Object // oOk_bn
52002>>>>>>>
52002>>>>>>>    Object oCancel_bn Is A Button
52004>>>>>>>        Set Label to "&Cancel"
52005>>>>>>>        Set Location to 115 501
52006>>>>>>>        Set peAnchors to anBottomRight
52007>>>>>>>
52007>>>>>>>        Procedure OnClick
52010>>>>>>>            Send Cancel of oSelList
52011>>>>>>>        End_Procedure
52012>>>>>>>
52012>>>>>>>    End_Object // oCancel_bn
52013>>>>>>>
52013>>>>>>>    Object oSearch_bn Is A Button
52015>>>>>>>        Set Label to "&Search..."
52016>>>>>>>        Set Location to 115 555
52017>>>>>>>        Set peAnchors to anBottomRight
52018>>>>>>>
52018>>>>>>>        Procedure OnClick
52021>>>>>>>            Send Search of oSelList
52022>>>>>>>        End_Procedure
52023>>>>>>>
52023>>>>>>>    End_Object // oSearch_bn
52024>>>>>>>
52024>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
52025>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
52026>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
52027>>>>>>>
52027>>>>>>>
52027>>>>>>>CD_End_Object // Miclient_sl
52029>>>>>>>>
52029>>>Use Miconstr.dd
Including file: Miconstr.dd    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\Miconstr.dd)
52029>>>>>Use DataDict.pkg
52029>>>>>
52029>>>>>Open MICONSTR
52031>>>>>Open MICN
52033>>>>>
52033>>>>>Class Miconstr is a DataDictionary
52034>>>>>    
52034>>>>>    Procedure Construct_Object
52036>>>>>        Forward Send Construct_Object
52038>>>>>        Set Main_file to MICONSTR.File_Number
52039>>>>>
52039>>>>>        Set Add_Client_File to MICN.File_Number
52040>>>>>
52040>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
52041>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
52042>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
52043>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
52044>>>>>
52044>>>>>    End_Procedure
52045>>>>>
52045>>>>>End_Class
52046>>>Use Misalesm.dd
Including file: Misalesm.dd    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\Misalesm.dd)
52046>>>>>Use DataDict.pkg
52046>>>>>
52046>>>>>Open MISALESM
52048>>>>>Open MICN
52050>>>>>
52050>>>>>Class Misalesm is a DataDictionary
52051>>>>>    
52051>>>>>    Procedure Construct_Object
52053>>>>>        Forward Send Construct_Object
52055>>>>>        Set Main_file to MISALESM.File_Number
52056>>>>>
52056>>>>>        Set Add_Client_File to MICN.File_Number
52057>>>>>
52057>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
52058>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
52059>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
52060>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
52061>>>>>
52061>>>>>    End_Procedure
52062>>>>>
52062>>>>>End_Class
52063>>>Use Mimhxan.dd
Including file: Mimhxan.dd    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\Mimhxan.dd)
52063>>>>>Use DataDict.pkg
52063>>>>>
52063>>>>>Open MIMHXAN
52065>>>>>Open MICN
52067>>>>>
52067>>>>>Class Mimhxan is a DataDictionary
52068>>>>>    
52068>>>>>    Procedure Construct_Object
52070>>>>>        Forward Send Construct_Object
52072>>>>>        Set Main_file to MIMHXAN.File_Number
52073>>>>>
52073>>>>>        Set Add_Client_File to MICN.File_Number
52074>>>>>
52074>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
52075>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
52076>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
52077>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
52078>>>>>
52078>>>>>    End_Procedure
52079>>>>>
52079>>>>>End_Class
52080>>>Use Micn.dd
Including file: Micn.dd    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\Micn.dd)
52080>>>>>Use DataDict.pkg
52080>>>>>
52080>>>>>Open MICN
52082>>>>>Open MICLIENT
52084>>>>>Open MICONSTR
52086>>>>>Open MISALESM
52088>>>>>Open MIMHXAN
52090>>>>>
52090>>>>>Register_Object Micn_sl
52090>>>>>
52090>>>>>Class Micn is a DataDictionary
52091>>>>>    
52091>>>>>    Procedure Construct_Object
52093>>>>>        Forward Send Construct_Object
52095>>>>>        Set Main_file to MICN.File_Number
52096>>>>>
52096>>>>>        Set Add_Server_File to MICLIENT.File_Number
52097>>>>>        Set Add_Server_File to MICONSTR.File_Number
52098>>>>>        Set Add_Server_File to MISALESM.File_Number
52099>>>>>        Set Add_Server_File to MIMHXAN.File_Number
52100>>>>>
52100>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
52101>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
52102>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
52103>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
52104>>>>>
52104>>>>>        Set Field_Prompt_Object Field MICN.CLIENT_ID to Micn_sl
52105>>>>>
52105>>>>>        Set Field_Prompt_Object Field MICN.CN_CODE to Micn_sl
52106>>>>>
52106>>>>>        Set Field_Prompt_Object Field MICN.CN_DESCR to Micn_sl
52107>>>>>
52107>>>>>        Set Field_Prompt_Object Field MICN.CN_ADDRESS to Micn_sl
52108>>>>>
52108>>>>>    End_Procedure
52109>>>>>
52109>>>>>End_Class
52110>>>>>
52110>>>>>Use Micn.sl
Including file: Micn.sl    (L:\VDF14.1.Dev\TITAN_MIGRATE\AppSrc\Micn.sl)
52110>>>>>>>// Micn.sl
52110>>>>>>>// Micn Lookup List
52110>>>>>>>
52110>>>>>>>Use DFClient.pkg
52110>>>>>>>Use DFSelLst.pkg
52110>>>>>>>Use Windows.pkg
52110>>>>>>>
52110>>>>>>>Use Micities.dd
52110>>>>>>>Use Miareas.dd
52110>>>>>>>Use Mipresp.dd
52110>>>>>>>Use Miclient.dd
52110>>>>>>>Use Miconstr.dd
52110>>>>>>>Use Misalesm.dd
52110>>>>>>>Use Mimhxan.dd
52110>>>>>>>Use Micn.dd
52110>>>>>>>
52110>>>>>>>CD_Popup_Object Micn_sl is a dbModalPanel
52128>>>>>>>>
52128>>>>>>>    Set Location to 5 5
52129>>>>>>>    Set Size to 134 530
52130>>>>>>>    Set Label To "Micn Lookup List"
52131>>>>>>>    Set Border_Style to Border_Thick
52132>>>>>>>    Set Minimize_Icon to False
52133>>>>>>>
52133>>>>>>>
52133>>>>>>>    Object oMicities_DD Is A Micities
52135>>>>>>>    End_Object // oMicities_DD
52136>>>>>>>
52136>>>>>>>    Object oMiareas_DD Is A Miareas
52138>>>>>>>    End_Object // oMiareas_DD
52139>>>>>>>
52139>>>>>>>    Object oMipresp_DD Is A Mipresp
52141>>>>>>>    End_Object // oMipresp_DD
52142>>>>>>>
52142>>>>>>>    Object oMiclient_DD Is A Miclient
52144>>>>>>>        Set DDO_Server To oMicities_DD
52145>>>>>>>        Set DDO_Server To oMiareas_DD
52146>>>>>>>        Set DDO_Server To oMipresp_DD
52147>>>>>>>    End_Object // oMiclient_DD
52148>>>>>>>
52148>>>>>>>    Object oMiconstr_DD Is A Miconstr
52150>>>>>>>    End_Object // oMiconstr_DD
52151>>>>>>>
52151>>>>>>>    Object oMisalesm_DD Is A Misalesm
52153>>>>>>>    End_Object // oMisalesm_DD
52154>>>>>>>
52154>>>>>>>    Object oMimhxan_DD Is A Mimhxan
52156>>>>>>>    End_Object // oMimhxan_DD
52157>>>>>>>
52157>>>>>>>    Object oMicn_DD Is A Micn
52159>>>>>>>        Set DDO_Server To oMiclient_DD
52160>>>>>>>        Set DDO_Server To oMiconstr_DD
52161>>>>>>>        Set DDO_Server To oMisalesm_DD
52162>>>>>>>        Set DDO_Server To oMimhxan_DD
52163>>>>>>>    End_Object // oMicn_DD
52164>>>>>>>
52164>>>>>>>    Set Main_DD To oMicn_DD
52165>>>>>>>    Set Server  To oMicn_DD
52166>>>>>>>
52166>>>>>>>
52166>>>>>>>
52166>>>>>>>    Object oSelList Is A dbList
52168>>>>>>>        Set Size to 105 520
52169>>>>>>>        Set Location to 5 5
52170>>>>>>>        Set peAnchors to anAll
52171>>>>>>>        Set Main_File to Micn.File_Number
52172>>>>>>>        Set Ordering to 1
52173>>>>>>>        Set peResizeColumn to rcAll
52174>>>>>>>        Set Auto_Server_State to True
52175>>>>>>>        Set pbHeaderTogglesDirection to True
52176>>>>>>>
52176>>>>>>>        Begin_row
52179>>>>>>>            Entry_Item Micn.Client_Id
52180>>>>>>>            Entry_Item MICLIENT.CLIENT_NAME
52181>>>>>>>            Entry_Item Micn.Cn_Code
52182>>>>>>>            Entry_Item Micn.Cn_Descr
52183>>>>>>>            Entry_Item Micn.Cn_Start_Date
52184>>>>>>>            Entry_Item Micn.Cn_End_Date
52185>>>>>>>        End_row
52190>>>>>>>
52190>>>>>>>        Set Form_Width 0 to 62
52191>>>>>>>        Set Header_Label 0 to "Client ID"
52192>>>>>>>
52192>>>>>>>        Set Form_Width 1 to 101
52193>>>>>>>        Set Header_Label 5 to "Cn End Date"
52194>>>>>>>
52194>>>>>>>        Set Form_Width 2 to 85
52195>>>>>>>        Set Header_Label 1 to "Name"
52196>>>>>>>
52196>>>>>>>        Set Form_Width 3 to 147
52197>>>>>>>        Set Header_Label 2 to "Cn Code"
52198>>>>>>>
52198>>>>>>>        Set Form_Width 4 to 60
52199>>>>>>>        Set Header_Label 3 to "Cn Descr"
52200>>>>>>>
52200>>>>>>>        Set Form_Width 5 to 60
52201>>>>>>>        Set Header_Label 4 to "Cn Start Date"
52202>>>>>>>
52202>>>>>>>    End_Object // oSelList
52203>>>>>>>
52203>>>>>>>    Object oOk_bn Is A Button
52205>>>>>>>        Set Label to "&Ok"
52206>>>>>>>        Set Location to 115 367
52207>>>>>>>        Set peAnchors to anBottomRight
52208>>>>>>>
52208>>>>>>>        Procedure OnClick
52211>>>>>>>            Send OK of oSelList
52212>>>>>>>        End_Procedure
52213>>>>>>>
52213>>>>>>>    End_Object // oOk_bn
52214>>>>>>>
52214>>>>>>>    Object oCancel_bn Is A Button
52216>>>>>>>        Set Label to "&Cancel"
52217>>>>>>>        Set Location to 115 421
52218>>>>>>>        Set peAnchors to anBottomRight
52219>>>>>>>
52219>>>>>>>        Procedure OnClick
52222>>>>>>>            Send Cancel of oSelList
52223>>>>>>>        End_Procedure
52224>>>>>>>
52224>>>>>>>    End_Object // oCancel_bn
52225>>>>>>>
52225>>>>>>>    Object oSearch_bn Is A Button
52227>>>>>>>        Set Label to "&Search..."
52228>>>>>>>        Set Location to 115 475
52229>>>>>>>        Set peAnchors to anBottomRight
52230>>>>>>>
52230>>>>>>>        Procedure OnClick
52233>>>>>>>            Send Search of oSelList
52234>>>>>>>        End_Procedure
52235>>>>>>>
52235>>>>>>>    End_Object // oSearch_bn
52236>>>>>>>
52236>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
52237>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
52238>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
52239>>>>>>>
52239>>>>>>>
52239>>>>>>>CD_End_Object // Micn_sl
52241>>>>>>>>
52241>>>
52241>>>ACTIVATE_VIEW Activate_ClientsCN FOR ClientsCN
52251>>>>
52251>>>Object ClientsCN Is A dbView
52253>>>    Object oMimhxan_DD is a Mimhxan
52255>>>    End_Object
52256>>>
52256>>>    Object oMisalesm_DD is a Misalesm
52258>>>    End_Object
52259>>>
52259>>>    Object oMiconstr_DD is a Miconstr
52261>>>    End_Object
52262>>>
52262>>>    Object oMipresp_DD is a Mipresp
52264>>>    End_Object
52265>>>
52265>>>    Object oMiareas_DD is a Miareas
52267>>>    End_Object
52268>>>
52268>>>    Object oMicities_DD is a Micities
52270>>>    End_Object
52271>>>
52271>>>    Object oMiclient_DD is a Miclient
52273>>>        Set DDO_Server to oMipresp_DD
52274>>>        Set DDO_Server to oMiareas_DD
52275>>>        Set DDO_Server to oMicities_DD
52276>>>    End_Object
52277>>>
52277>>>    Object oMicn_DD is a Micn
52279>>>        Set DDO_Server to oMimhxan_DD
52280>>>        Set DDO_Server to oMisalesm_DD
52281>>>        Set DDO_Server to oMiconstr_DD
52282>>>        Set Constrain_file to MICLIENT.File_number
52283>>>        Set DDO_Server to oMiclient_DD
52284>>>    End_Object
52285>>>
52285>>>    Set Main_DD to oMiclient_DD
52286>>>    Set Server to oMiclient_DD
52287>>>
52287>>>    Set Location to 5 5
52288>>>    Set Size to 249 560
52289>>>    Set Label To "ClientsCN"
52290>>>    Set Border_Style to Border_Thick
52291>>>
52291>>>
52291>>>
52291>>>    Object oMiclientClient_Id Is A dbForm
52293>>>        Entry_Item Miclient.Client_Id
52294>>>        Set Size to 13 126
52295>>>        Set Location to 5 45
52296>>>        Set peAnchors to anLeftRight
52297>>>        Set Label to "Client Id"
52298>>>        Set Label_Justification_mode to jMode_Left
52299>>>        Set Label_Col_Offset to 40
52300>>>        Set Label_row_Offset to 0
52301>>>    End_Object // oMiclientClient_Id
52302>>>
52302>>>    Object oMiclientClient_Name Is A dbForm
52304>>>        Entry_Item Miclient.Client_Name
52305>>>        Set Size to 13 486
52306>>>        Set Location to 20 45
52307>>>        Set peAnchors to anLeftRight
52308>>>        Set Label to "Client Name"
52309>>>        Set Label_Justification_mode to jMode_Left
52310>>>        Set Label_Col_Offset to 40
52311>>>        Set Label_row_Offset to 0
52312>>>    End_Object // oMiclientClient_Name
52313>>>
52313>>>    Object oMiclientClient_Afm Is A dbForm
52315>>>        Entry_Item Miclient.Client_Afm
52316>>>        Set Size to 13 126
52317>>>        Set Location to 35 45
52318>>>        Set peAnchors to anLeftRight
52319>>>        Set Label to "Client Afm"
52320>>>        Set Label_Justification_mode to jMode_Left
52321>>>        Set Label_Col_Offset to 40
52322>>>        Set Label_row_Offset to 0
52323>>>    End_Object // oMiclientClient_Afm
52324>>>
52324>>>    Object oDetailGrid Is A dbGrid
52326>>>        Set Size to 183 550
52327>>>        Set Location to 58 5
52328>>>
52328>>>        Begin_row
52331>>>            Entry_Item Micn.Cn_Code
52332>>>            Entry_Item Micn.Cn_Descr
52333>>>            Entry_Item Micn.Cn_Address
52334>>>            Entry_Item Micn.Cn_Start_Date
52335>>>            Entry_Item Micn.Cn_End_Date
52336>>>        End_row
52341>>>
52341>>>        Set Main_file to Micn.File_number
52342>>>
52342>>>        Set Form_Width 0 to 120
52343>>>        Set Header_Label 0 to "Cn Code"
52344>>>
52344>>>        Set Form_Width 1 to 150
52345>>>        Set Header_Label 1 to "Cn Descr"
52346>>>
52346>>>        Set Form_Width 2 to 150
52347>>>        Set Header_Label 2 to "Cn Address"
52348>>>
52348>>>        Set Form_Width 3 to 60
52349>>>        Set Header_Label 3 to "Cn Start Date"
52350>>>
52350>>>        Set Form_Width 4 to 60
52351>>>        Set Header_Label 4 to "Cn End Date"
52352>>>
52352>>>
52352>>>        Set Server to oMicn_DD
52353>>>        Set Ordering to 6
52354>>>        Set peResizeColumn to rcAll
52355>>>        Set peAnchors to anAll
52356>>>        Set Wrap_State to TRUE
52357>>>
52357>>>        // Setting child_table_state to true will
52357>>>        // cause the grid to save when exiting and
52357>>>        // attempt to save the header when entering.
52357>>>        Set Child_Table_State to True
52358>>>
52358>>>        // Often grids are set up, so that items can never be added out
52358>>>        // of order. New items are always added to the end of the table.
52358>>>        // By setting Auto_Regenerate_State to false we are telling the
52358>>>        // table to never bother reordering after adding records. This is
52358>>>        // a minor optimization.
52358>>>        //Set Auto_Regenerate_State to False // table is always in order.
52358>>>
52358>>>        // Child_Entering is called when entering the table. Check with the header if it
52358>>>        // has a valid saved record. If not, disallow entry.
52358>>>        Function Child_Entering returns Integer
52361>>>            Boolean bFail
52361>>>            // Check with header to see if it is saved.
52361>>>            Delegate Get SaveHeader to bFail
52363>>>            Function_Return bFail // if non-zero do not enter
52364>>>        End_Function // Child_Entering
52365>>>
52365>>>        // Assign insert-row key append a row
52365>>>        // Create new behavior to support append a row
52365>>>
52365>>>        On_key kAdd_Mode send Append_a_Row  // Hot Key for KAdd_Mode = Shift+F10
52366>>>
52366>>>        // Add new record to the end of the table.
52366>>>        Procedure Append_a_Row 
52369>>>            Send End_Of_Data
52370>>>            Send Down
52371>>>        End_Procedure // Append_a_Row
52372>>>
52372>>>    End_Object // oDetailGrid
52373>>>
52373>>>
52373>>>    //-----------------------------------------------------------------------
52373>>>    // Create custom confirmation messages for save and delete
52373>>>    // We must create the new functions and assign verify messages
52373>>>    // to them.
52373>>>    //-----------------------------------------------------------------------
52373>>>
52373>>>    Function ConfirmDeleteHeader Returns Boolean
52376>>>        Boolean bFail
52376>>>        Get Confirm "Delete Entire Header and all detail?" to bFail
52377>>>        Function_Return bFail
52378>>>    End_Function // ConfirmDeleteHeader
52379>>>
52379>>>    // Only confirm on the saving of new records
52379>>>    Function ConfirmSaveHeader Returns Boolean
52382>>>        Boolean bNoSave bHasRecord
52382>>>        Handle  hoSrvr
52382>>>        Get Server to hoSrvr
52383>>>        Get HasRecord of hoSrvr to bHasRecord
52384>>>        If not bHasRecord Begin
52386>>>            Get Confirm "Save this NEW header?" to bNoSave
52387>>>        End
52387>>>>
52387>>>        Function_Return bNoSave
52388>>>    End_Function // ConfirmSaveOrder
52389>>>
52389>>>    // Define alternate confirmation Messages
52389>>>    Set Verify_Save_MSG       to GET_ConfirmSaveHeader
52390>>>    Set Verify_Delete_MSG     to GET_ConfirmDeleteHeader
52391>>>
52391>>>    //-------------------------------------------------------------------
52391>>>    //  Table entry checking - attempt to save header record
52391>>>    //  before entering a table (this is called by table. Return
52391>>>    //  a non-zero if the save failed (i.e., do not enter table)
52391>>>    //-------------------------------------------------------------------
52391>>>
52391>>>    Function SaveHeader Returns Boolean
52394>>>        Integer iRec
52394>>>        Boolean bChanged bHasRecord
52394>>>        Handle  hoSrvr
52394>>>
52394>>>        Get Server to hoSrvr                   // The Header DDO.
52395>>>        Get HasRecord of hoSrvr to bHasRecord  // Is there a record?
52396>>>        Get Should_Save to bChanged            // Are there any current changes?
52397>>>
52397>>>        // If there is no record and no changes we have an error.
52397>>>        If (not(bHasRecord) AND not(bChanged) ) Begin  // no rec
52399>>>            Error DfErr_Operator "You must First Create & Save the Header"
52400>>>>
52400>>>            Function_Return True
52401>>>        End
52401>>>>
52401>>>
52401>>>        // Attempt to Save the current Record
52401>>>        // request_save_no_clear does a save without clearing.
52401>>>        Send Request_Save_No_Clear
52402>>>
52402>>>        // The save succeeded if there are now no changes, and we
52402>>>        // have a saved record. Should_save tells us if we've got changes.
52402>>>        // We must check the DDO's HasRecord property to see if
52402>>>        // we have a record. If it is false, we had no save.
52402>>>        Get Should_Save to bChanged  // is a save still needed
52403>>>        Get HasRecord of hoSrvr to bHasRecord // is there a record after the save?
52404>>>        // if no record or changes still exist, return an error code of 1
52404>>>        If (not(bHasRecord) OR (bChanged)) begin
52406>>>            Function_Return true
52407>>>        End
52407>>>>
52407>>>    End_Function // SaveHeader
52408>>>
52408>>>
52408>>>
52408>>>End_Object // ClientsCN
52409>        Use MI_Migrate_Send_Data_To_Master.vw
Including file: MI_Migrate_Send_Data_To_Master.vw    (L:\VDF14.1.Dev\TITAN_MIGRATE\AppSrc\MI_Migrate_Send_Data_To_Master.vw)
52409>>>
52409>>>Use DBVIEW.SUB
Including file: DBVIEW.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\DBVIEW.SUB)
52409>>>>>
52409>>>>>Use General.pkg
Including file: General.pkg    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\General.pkg)
52409>>>>>>>Use Winuser.pkg
52409>>>>>>>Use WinUsrez.pkg
Including file: WINUSREZ.PKG    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\WINUSREZ.PKG)
52409>>>>>>>>>// API Calls (Commands and Functions)
52409>>>>>>>>>// Author - SPY 10/11/98
52409>>>>>>>>>// Extension of VDF's WinUser.pkg
52409>>>>>>>>>// Created as a need to change the SystemMenu
52409>>>>>>>>>// This package will be changed (expand or shrink) according to our needs and VDF's changes
52409>>>>>>>>>
52409>>>>>>>>>Use DFTypes.pkg     // DataFlex Types (structures)
52409>>>>>>>>>Use Winuser.pkg
52409>>>>>>>>>
52409>>>>>>>>>// max_path is originally ci260, but we support a slightly smaller stringlength
52409>>>>>>>>>Define Max_Path               For |CI260
52409>>>>>>>>>
52409>>>>>>>>>// The defines below can be used to find out what kind of error has occured if
52409>>>>>>>>>// the API-call ShellExecute is used.
52409>>>>>>>>>Define ERROR_FILE_NOT_FOUND   For |CI0002
52409>>>>>>>>>Define ERROR_PATH_NOT_FOUND   For |CI0003
52409>>>>>>>>>Define ERROR_BAD_FORMAT       For |CI0011
52409>>>>>>>>>Define SE_ERR_ACCESSDENIED    For |CI0005
52409>>>>>>>>>Define SE_ERR_ASSOCINCOMPLETE For |CI0027
52409>>>>>>>>>Define SE_ERR_DDEBUSY         For |CI0030
52409>>>>>>>>>Define SE_ERR_DDEFAIL         For |CI0029
52409>>>>>>>>>Define SE_ERR_DDETIMEOUT      For |CI0028
52409>>>>>>>>>Define SE_ERR_DLLNOTFOUND     For |CI0032
52409>>>>>>>>>Define SE_ERR_FNF             For |CI0002
52409>>>>>>>>>Define SE_ERR_NOASSOC         For |CI0031
52409>>>>>>>>>Define SE_ERR_OOM             For |CI0008
52409>>>>>>>>>Define SE_ERR_PNF             For |CI0003
52409>>>>>>>>>Define SE_ERR_SHARE           For |CI0026
52409>>>>>>>>>
52409>>>>>>>>>Procedure DDE_Error_Handler Integer iErrorID
52412>>>>>>>>>  String sMessage
52412>>>>>>>>>  //Move "An error occurred during a DDE transaction.\n\n" To sMessage
52412>>>>>>>>>  Case Begin
52412>>>>>>>>>    Case (iErrorID = ERROR_FILE_NOT_FOUND)
52414>>>>>>>>>      Append sMessage "The specified file was not found.\n"
52415>>>>>>>>>      Case Break
52416>>>>>>>>>    Case (iErrorID = ERROR_PATH_NOT_FOUND)
52419>>>>>>>>>      Append sMessage "The specified path was not found.\n"
52420>>>>>>>>>      Case Break
52421>>>>>>>>>    Case (iErrorID = ERROR_BAD_FORMAT)
52424>>>>>>>>>      Append sMessage "The .EXE file is invalid.\n"
52425>>>>>>>>>      Case Break
52426>>>>>>>>>    Case (iErrorID = SE_ERR_ACCESSDENIED)
52429>>>>>>>>>      Append sMessage "The operating system denied access to the specified file.\n"
52430>>>>>>>>>      Case Break
52431>>>>>>>>>    Case (iErrorID = SE_ERR_ASSOCINCOMPLETE)
52434>>>>>>>>>      Append sMessage "The filename association is incomplete or invalid.\n"
52435>>>>>>>>>      Case Break
52436>>>>>>>>>    Case (iErrorID = SE_ERR_DDEBUSY)
52439>>>>>>>>>      Append sMessage "The DDE transaction could not be completed because other DDE\n"
52440>>>>>>>>>      Append sMessage "transactions were being processed.\n"
52441>>>>>>>>>      Case Break
52442>>>>>>>>>    Case (iErrorID = SE_ERR_DDEFAIL)
52445>>>>>>>>>      Append sMessage "The DDE transaction failed.\n"
52446>>>>>>>>>      Case Break
52447>>>>>>>>>    Case (iErrorID = SE_ERR_DDETIMEOUT)
52450>>>>>>>>>      Append sMessage "The DDE transaction could not be completed,\n"
52451>>>>>>>>>      Append sMessage "because the request timed out.\n"
52452>>>>>>>>>      Case Break
52453>>>>>>>>>    Case (iErrorID = SE_ERR_DLLNOTFOUND)
52456>>>>>>>>>      Append sMessage "The specified dynamic-link library was not found.\n"
52457>>>>>>>>>      Case Break
52458>>>>>>>>>    Case (iErrorID = SE_ERR_NOASSOC)
52461>>>>>>>>>      Append sMessage "There is no application associated with the given filename extension.\n"
52462>>>>>>>>>      Case Break
52463>>>>>>>>>    Case ((iErrorID = SE_ERR_OOM) Or (iErrorID = 0))
52466>>>>>>>>>      Append sMessage "There is not enough free memory available to complete the operation.\n"
52467>>>>>>>>>      Case Break
52468>>>>>>>>>    Case (iErrorID = SE_ERR_PNF)
52471>>>>>>>>>      Append sMessage "The specified path was not found.\n"
52472>>>>>>>>>      Case Break
52473>>>>>>>>>    Case (iErrorID = SE_ERR_SHARE)
52476>>>>>>>>>      Append sMessage "A sharing violation occurred.\n"
52477>>>>>>>>>      Case Break
52478>>>>>>>>>    Case Else
52478>>>>>>>>>      Append sMessage "Unknown DDE-error occurred.\n"
52479>>>>>>>>>      Append sMessage ("Errornumber"*Trim(iErrorID)*".\n")
52480>>>>>>>>>      Case Break
52481>>>>>>>>>  Case End
52481>>>>>>>>>  Append sMessage "\nPress OK to continue...\n\n"
52482>>>>>>>>>  Send Stop_Box sMessage "DDE-error occured"
52483>>>>>>>>>End_Procedure // DDE_Error_Handler hInstance
52484>>>>>>>>>
52484>>>>>>>>>// System Menu Command Values
52484>>>>>>>>>
52484>>>>>>>>>// Obsolete names
52484>>>>>>>>>
52484>>>>>>>>>
52484>>>>>>>>>
52484>>>>>>>>>
52484>>>>>>>>>
52484>>>>>>>>>
52484>>>>>>>>>// Date Flags for GetDateFormatW.
52484>>>>>>>>>//#replace DATE_SHORTDATE            |CI1        //  use short date picture
52484>>>>>>>>>//#replace DATE_LONGDATE             |CI2        //  use long date picture
52484>>>>>>>>>
52484>>>>>>>>>
52484>>>>>>>>>//Type tSystemTime
52484>>>>>>>>>//    Field tSystemTime.wYear As Integer
52484>>>>>>>>>//    Field tSystemTime.wMonth As Integer
52484>>>>>>>>>//    Field tSystemTime.wDayOfWeek As Integer
52484>>>>>>>>>//    Field tSystemTime.wDay As Integer
52484>>>>>>>>>//    Field tSystemTime.wHour As Integer
52484>>>>>>>>>//    Field tSystemTime.wMinute As Integer
52484>>>>>>>>>//    Field tSystemTime.wSecond As Integer
52484>>>>>>>>>//    Field tSystemTime.wMilliseconds As Integer
52484>>>>>>>>>//End_Type  // tSystemTime
52484>>>>>>>>>
52484>>>>>>>>>// Locale Dependent APIs
52484>>>>>>>>>// The Date Format
52484>>>>>>>>>//External Function GetDateFormat  "GetDateFormatA"  Kernel32.dll ;
52484>>>>>>>>>//        Integer Locale Integer dwFlags Pointer lpDate String lpFormat String lpDateStr Integer cchDate Returns Integer
52484>>>>>>>>>                                         //   as tSystemTime
52484>>>>>>>>>
52484>>>>>>>>>// Menu Functions
52484>>>>>>>>>// API call to return the menu handle
52484>>>>>>>>>External_Function GetSystemMenu "GetSystemMenu" User32.dll ;        Handle hWnd Integer bRevert Returns Handle
52485>>>>>>>>>
52485>>>>>>>>>// API call to return the menu Items Count
52485>>>>>>>>>External_Function GetMenuItemCount "GetMenuItemCount" User32.dll ;        Handle hWnd Returns Integer
52486>>>>>>>>>
52486>>>>>>>>>// API call to modify the menu items by position or by command
52486>>>>>>>>>External_Function ModifyMenu "ModifyMenuA" User32.dll ;        Handle hWnd Integer nPosition Integer wFlags Integer wIDNewItem String lpString Returns Integer
52487>>>>>>>>>
52487>>>>>>>>>// API call to get the value of a menu item
52487>>>>>>>>>External_Function GetMenuString "GetMenuStringA" User32.dll ;        Handle hWnd Integer wIDItem String lpString Integer nMaxCount Integer wFlags Returns Integer
52488>>>>>>>>>
52488>>>>>>>>>External_Function SetMenuItemInfo "SetMenuItemInfoA" User32.dll ;        Handle hWnd Integer un Integer bypos Integer lpMenuItemInfo Returns Integer
52489>>>>>>>>>
52489>>>>>>>>>External_Function GetMenuItemInfo "GetMenuItemInfoA" User32.dll ;        Handle hWnd Integer un Integer bypos Integer lpMenuItemInfo Returns Integer
52490>>>>>>>>>
52490>>>>>>>>>External_Function SetMenuItemBitmaps "SetMenuItemBitmaps" User32.dll ;        Handle hMenu Integer nPosition Integer wFlags Integer hBitmapUnchecked Integer hBitmapChecked Returns Integer
52491>>>>>>>>>
52491>>>>>>>>>// API call to delete the Items of a menu
52491>>>>>>>>>External_Function DeleteMenu "DeleteMenu" User32.dll ;        Handle hMenu Integer nPosition Integer wFlags Returns Integer
52492>>>>>>>>>
52492>>>>>>>>>// API call to return the active window associcated with the calling thread (ie DFRUN)
52492>>>>>>>>>External_Function GetActiveWindow "GetActiveWindow" user32.dll Returns Integer
52493>>>>>>>>>
52493>>>>>>>>>// change the window title so we can find the window
52493>>>>>>>>>External_Function SetConsoleTitle "SetConsoleTitleA" Kernel32.dll ;    String lpszTitle Returns Integer
52494>>>>>>>>>
52494>>>>>>>>>// Extracts an icon from a .DLL .EXE of .ICO
52494>>>>>>>>>External_Function ExtractIcon "ExtractIconA" Shell32.dll ;        Handle hInst ;        String lpIconName ;        Integer nIconIndex ;        Returns Handle
52495>>>>>>>>>
52495>>>>>>>>>//Procedure SetWindowsTitle Global String TheTitle
52495>>>>>>>>>//    Local Pointer Titlepointer
52495>>>>>>>>>//    Getaddress Of TheTitle To Titlepointer
52495>>>>>>>>>//    Move (Setconsoletitle(Titlepointer)) To Strmark
52495>>>>>>>>>//End_Procedure
52495>>>>>>>>>
52495>>>>>>>>>//Procedure SetWindowsIcon Global String TheIcon
52495>>>>>>>>>//    // Known problem!
52495>>>>>>>>>//    // The function "FINDWINDOW" finds any window with a titlebar with contents of s.1
52495>>>>>>>>>//    // when run multiple times this procedure could change the icon of an other task
52495>>>>>>>>>//    // the solution is to
52495>>>>>>>>>//    // 1. set the title to some temporary value,
52495>>>>>>>>>//    // 2. find the temporary value
52495>>>>>>>>>//    // 3. change the icon
52495>>>>>>>>>//    // 4. restore the old value of the title
52495>>>>>>>>>
52495>>>>>>>>>//    Local Handle TemHandle
52495>>>>>>>>>//    Move (FindWindow ("ConsoleWindowClass" ,s.1 )) to TemHandle     // Windows NT code!
52495>>>>>>>>>//    If TemHandle eq 0 Move (FindWindow ("tty" ,s.1 )) to TemHandle  // Windows '95/'98 code!
52495>>>>>>>>>//    Move (SendMessage(TemHandle, WM_SETICON, 0, ExtractIcon(0, TheIcon, 0))) to strmark
52495>>>>>>>>>//End_Procedure
52495>>>>>>>>>
52495>>>>>>>>>Define MAX_COMPUTERNAME_LENGTH For 15
52495>>>>>>>>>
52495>>>>>>>>>External_Function32 GetComputerName "GetComputerNameA" Kernel32.Dll ;    Pointer lpComputerName Dword nNameSize Returns Integer
52496>>>>>>>>>
52496>>>>>>>>>// LPTSTR  lpComputerName address of name buffer
52496>>>>>>>>>// LPDWORD nNameSize      address of size of name buffer
52496>>>>>>>>>
52496>>>>>>>>>
52496>>>>>>>>>// Used for printscreen
52496>>>>>>>>>//Define Byte For Integer
52496>>>>>>>>>
52496>>>>>>>>>External_Function Keybd_Event "keybd_event" User32.Dll ;    Integer bVk ;  // virtual-key code    Integer bScan ;   // hardware scan code    DWORD dwFlags ;   // flags specifying various function options    DWORD dwExtraInfo ;  // additional data associated with keystroke    Returns VOID_TYPE
52497>>>>>>>>>
52497>>>>>>>>>
52497>>>>>>>>>External_Function GetFreeResources "_MyGetFreeSystemResources32@4" ;    rsrc32.dll Integer nID Returns Integer
52498>>>>>>>>>
52498>>>>>>>>>
52498>>>>>>>>>External_Function GetEnvironmentVariable "GetEnvironmentVariableA" Kernel32.dll ;    Pointer lpVarName Pointer lpBuffer Integer nSize Returns Integer
52499>>>>>>>>>
52499>>>>>>>>>External_Function GetWindowsDirectory "GetWindowsDirectoryA" Kernel32.dll ;    Pointer lpBuffWinDir Integer nSize Returns Integer
52500>>>>>>>>>
52500>>>>>>>>>
52500>>>>>>>>>//Here are some replaces you can use for '%', '.' and '*'
52500>>>>>>>>>// Extra Keys not defined in FMAC
52500>>>>>>>>>
52500>>>>>>>>>
52500>>>>>>>>>// external function call used in Procedure DoStartDocument
52500>>>>>>>>>External_Function ShellExecute "ShellExecuteA" shell32.dll ;    Handle hWnd ;    Pointer lpOperation ;    Pointer lpFile ;    Pointer lpParameters ;    Pointer lpDirectory ;    Dword iShowCmd Returns Handle
52501>>>>>>>>>
52501>>>>>>>>>// this will perform an operation on a file (e.g. open) with the application
52501>>>>>>>>>// registered in the Windows Registry to open that type of file (via its extension)
52501>>>>>>>>>// sOperation would be "OPEN" (it could also be "PRINT" etc).
52501>>>>>>>>>Procedure DoShellExecute global String sOperation String sDocument String sParameters String sPath
52503>>>>>>>>>  Handle  hInstance hWnd
52503>>>>>>>>>  Pointer lpsOperation
52503>>>>>>>>>  Pointer lpsDocument
52503>>>>>>>>>  Pointer lpsParameters
52503>>>>>>>>>  Pointer lpsPath
52503>>>>>>>>>  // remove any leading/trailing spaces in the string
52503>>>>>>>>>  Move (Trim(sDocument)) To sDocument
52504>>>>>>>>>  Move (Trim(sPath))     To sPath
52505>>>>>>>>>  // Make the strings readable for windows API, by converting them to null-terminated
52505>>>>>>>>>  Append sOperation   (Character(0))
52506>>>>>>>>>  Append sDocument    (Character(0))
52507>>>>>>>>>  Append sParameters  (Character(0))
52508>>>>>>>>>  Append sPath        (Character(0))
52509>>>>>>>>>  // Connect the corresponding pointers to the strings
52509>>>>>>>>>  GetAddress Of sOperation  To lpsOperation
52510>>>>>>>>>  GetAddress Of sDocument   To lpsDocument
52511>>>>>>>>>  GetAddress Of sParameters To lpsParameters
52512>>>>>>>>>  GetAddress Of sPath       To lpsPath
52513>>>>>>>>>
52513>>>>>>>>>  Get Window_Handle To hWnd
52514>>>>>>>>>  Move (ShellExecute (hWnd, lpsOperation, lpsDocument, lpsParameters, lpsPath, 1)) To hInstance
52515>>>>>>>>>  If (hInstance <= 32) Begin
52517>>>>>>>>>    Send DDE_Error_Handler hInstance
52518>>>>>>>>>  End
52518>>>>>>>>>>
52518>>>>>>>>>End_Procedure // DoShellExecute
52519>>>>>>>>>
52519>>>>>>>>>// this will perform an operation on a file (e.g. open) with the application
52519>>>>>>>>>// registered in the Windows Registry to open that type of file (via its extension)
52519>>>>>>>>>// sOperation would be "OPEN" (it could also be "PRINT" etc).
52519>>>>>>>>>Procedure DoStartDocument GLOBAL String sOperation String sDocument
52521>>>>>>>>>    Send DoShellExecute sOperation (Trim (sDocument)) '' ''
52522>>>>>>>>>End_Procedure // DoStartDocument
52523>>>>>>>>>
52523>>>>>>>>>// returns default browser from Windows Registry
52523>>>>>>>>>Function DefaultBrowser Returns String
52526>>>>>>>>>    String sBrowser sRegPath
52526>>>>>>>>>
52526>>>>>>>>>    Move "Classes\http\shell\open\command" To sRegPath
52527>>>>>>>>>    Get_Foreign_Profile_String sRegPath "" "" To sBrowser
52531>>>>>>>>>    Move (Replaces('"', sBrowser, "")) To sBrowser
52532>>>>>>>>>    Function_Return sBrowser
52533>>>>>>>>>End_Function // DefaultBrowser
52534>>>>>>>>>
52534>>>>>>>>>External_Function LoadCursorFromFile  "LoadCursorFromFileA" User32.DLL ;     Pointer lpFileName Returns Integer
52535>>>>>>>>>
52535>>>>>>>>>External_Function GetCursor "GetCursor" User32.dll ;    Returns Integer
52536>>>>>>>>>
52536>>>>>>>>>
52536>>>>>>>>>Procedure ShowTaskBar
52539>>>>>>>>>    Integer iVal
52539>>>>>>>>>    Handle hWnd
52539>>>>>>>>>    Move (FindWindow("Shell_traywnd", "")) To hWnd
52540>>>>>>>>>    Move (SetWindowPos(hWnd, 0, 0, 0, 0, 0, SWP_SHOWWINDOW)) To iVal
52541>>>>>>>>>End_Procedure // ShowTaskBar
52542>>>>>>>>>
52542>>>>>>>>>
52542>>>>>>>>>Procedure HideTaskBar
52545>>>>>>>>>    Integer iVal
52545>>>>>>>>>    Handle hWnd
52545>>>>>>>>>    Move (FindWindow("Shell_traywnd", "")) To hWnd
52546>>>>>>>>>    Move (SetWindowPos(hWnd, 0, 0, 0, 0, 0, SWP_HIDEWINDOW)) To iVal
52547>>>>>>>>>End_Procedure // HideTaskBar
52548>>>>>>>>>
52548>>>>>>>>>Function DFKeyState Global Dword vKey Returns Integer
52550>>>>>>>>>    Integer rVal
52550>>>>>>>>>
52550>>>>>>>>>    Move (GetKeyState(vKey)) To rVal
52551>>>>>>>>>    // 1 vKey pressed 0 vKey is up
52551>>>>>>>>>    Move (Hi(rval)) To rVal
52552>>>>>>>>>    If (rVal) Move (65536-rVal) To rVal
52555>>>>>>>>>    Function_Return rVal
52556>>>>>>>>>End_Function // DFKeyState
52557>>>>>>>>>
52557>>>>>>>Use Dfdeoft.pkg
52557>>>>>>>
52557>>>>>>>//Open messages
52557>>>>>>>
52557>>>>>>>// Function Xlate Global String Item_Name## Returns String
52557>>>>>>>//    Local String S_Return_Val##
52557>>>>>>>//    //If sysfile.enable_xlate eq 1 Begin
52557>>>>>>>//        Clear Messages
52557>>>>>>>//        Move Item_Name## To Messages.Greek
52557>>>>>>>//        Find Eq Messages By Index.1 //Greek
52557>>>>>>>//        If (Not(Found)) Begin
52557>>>>>>>//            Saverecord Messages
52557>>>>>>>//            Unlock
52557>>>>>>>//        End
52557>>>>>>>
52557>>>>>>>//        If Messages.Local Ne ""         Move (Trim(Messages.Local))     To S_Return_Val##
52557>>>>>>>//        Else Begin
52557>>>>>>>//            If Messages.English Ne ""   Move (Trim(Messages.English))   To S_Return_Val##
52557>>>>>>>//            Else                        Move Item_Name##                To S_Return_Val##
52557>>>>>>>//        End
52557>>>>>>>//    //End
52557>>>>>>>//    //Else                                Move Item_Name##        to S_Return_Val##
52557>>>>>>>//    Function_Return S_Return_Val## Item_Name##
52557>>>>>>>//    Function_Return Item_Name##
52557>>>>>>>//End_Function //Xlate
52557>>>>>>>
52557>>>>>>>
52557>>>>>>>//Procedure Info_BoxT GLOBAL String sMessage String sTitle
52557>>>>>>>//    Forward Send Info_Box (Xlate(sMessage)) (Xlate(sTitle))
52557>>>>>>>//End_Procedure
52557>>>>>>>
52557>>>>>>>////Doc/ Interface=Public
52557>>>>>>>//Procedure Stop_BoxT GLOBAL String sMessage String sTitle
52557>>>>>>>//    Forward Send Stop_Box (Xlate(sMessage)) (Xlate(sTitle))
52557>>>>>>>//End_Procedure
52557>>>>>>>
52557>>>>>>>////Doc/ Interface=Public
52557>>>>>>>//Function YesNo_BoxT GLOBAL String sMessage String sTitle Integer DfltBtn ;
52557>>>>>>>//                           Returns Integer
52557>>>>>>>//    Integer rval
52557>>>>>>>//    Move (YesNo_Box( (Xlate(sMessage)), (Xlate(sTitle)), DfltBtn)) to rVal
52557>>>>>>>//    Function_Return rval
52557>>>>>>>//End_Function
52557>>>>>>>
52557>>>>>>>Procedure DoCustomizeDefaultFloatMenu Integer aiObj_id
52560>>>>>>>     Set Value of aiObj_id Item 0 to "„§˜¤˜­¦¨á"
52561>>>>>>>     Set Value of aiObj_id Item 2 to "€§¦¡¦§ã"
52562>>>>>>>     Set Value of aiObj_id Item 3 to "€¤« š¨˜­ã"
52563>>>>>>>     Set Value of aiObj_id Item 4 to "„§ ¡æ¢¢ž©ž"
52564>>>>>>>     Set Value of aiObj_id Item 5 to "ƒ ˜š¨˜­ã"
52565>>>>>>>     Set Value of aiObj_id Item 7 to "Ž¢ ¡ã „§ ¢¦šã"
52566>>>>>>>End_Procedure
52567>>>>>>>
52567>>>>>>>Procedure DoCustomizeDefaultdbFloatMenu Integer aiObj_id
52570>>>>>>>      Integer liFirstItem
52570>>>>>>>      Set Value of aiObj_id Item 0 to "&Šå©«˜"
52571>>>>>>>      Set Value of aiObj_id Item 1 to "&„§æ£œ¤¦"
52572>>>>>>>      Set Value of aiObj_id Item 2 to "&¨¦žš¦ç£œ¤¦"
52573>>>>>>>      Set Value of aiObj_id Item 3 to "€¡ç¨à©ž &Ž¢ ¡ã"
52574>>>>>>>      Set Value of aiObj_id Item 4 to "&€¡ç¨à©ž"
52575>>>>>>>      Set Value of aiObj_id Item 5 to "„&šš¨˜­ã"
52576>>>>>>>      Set Value of aiObj_id Item 6 to "&ƒ ˜š¨˜­ã „šš¨˜­ãª"
52577>>>>>>>End_Procedure
52578>>>>>>>
52578>>>>>>>Procedure GreekSysMenu
52581>>>>>>>   Local Integer hWnd hSmId iItems bState
52581>>>>>>>   Get Window_Handle to hWnd
52582>>>>>>>   If hWnd ne 0 Begin
52584>>>>>>>        Move (GetSystemMenu(hWnd,False)) to hSmId
52585>>>>>>>        Move (GetMenuItemCount(hSmId)) to iItems
52586>>>>>>>
52586>>>>>>>        Move (ModifyMenu(hSmId,SC_RESTORE,MF_BYCOMMAND + MF_STRING,SC_RESTORE,      ("    "+(ToAnsi("„§˜¤˜­¦&¨á")))))               to bState
52587>>>>>>>        Move (ModifyMenu(hSmId,SC_MOVE,MF_BYCOMMAND + MF_STRING,SC_MOVE,            ("    "+(ToAnsi("&‹œ«˜¡å¤ ©ž")))))              to bState
52588>>>>>>>        Move (ModifyMenu(hSmId,SC_SIZE,MF_BYCOMMAND + MF_STRING,SC_SIZE,            ("    "+(ToAnsi("‹â&šœŸ¦ª")))))                 to bState
52589>>>>>>>        Move (ModifyMenu(hSmId,SC_MINIMIZE,MF_BYCOMMAND + MF_STRING,SC_MINIMIZE,    ("    "+(ToAnsi("„&¢˜® ©«¦§¦åž©ž")))))          to bState
52590>>>>>>>        Move (ModifyMenu(hSmId,SC_MAXIMIZE,MF_BYCOMMAND + MF_STRING,SC_MAXIMIZE,    ("    "+(ToAnsi("‹œš &©«¦§¦åž©ž")))))           to bState
52591>>>>>>>        Move (ModifyMenu(hSmId,SC_CLOSE,MF_BYCOMMAND + MF_STRING,SC_CLOSE,          ("    "+(ToAnsi("&„¥¦›¦ª     Alt+F4")))))       to bState
52592>>>>>>>        Move (ModifyMenu(hSmId,SC_NEXTWINDOW,MF_BYCOMMAND + MF_STRING,SC_NEXTWINDOW,("    "+(ToAnsi("„&§æ£œ¤¦       Ctrl+F6")))))   to bState
52593>>>>>>>
52593>>>>>>>//        Move (ModifyMenu(hSmId,SC_RESTORE,MF_BYCOMMAND      + MF_STRING,SC_RESTORE      ,("    "+(ToAnsi"„§˜¤˜­¦&¨á")))))       to bState
52593>>>>>>>//        Move (ModifyMenu(hSmId,SC_MOVE,MF_BYCOMMAND         + MF_STRING,SC_MOVE         ,("    "+(ToAnsi"&‹œ«˜¡å¤ ©ž")))))      to bState
52593>>>>>>>//        Move (ModifyMenu(hSmId,SC_SIZE,MF_BYCOMMAND         + MF_STRING,SC_SIZE         ,("    "+(ToAnsi"‹â&šœŸ¦ª")))))         to bState
52593>>>>>>>//        Move (ModifyMenu(hSmId,SC_MINIMIZE,MF_BYCOMMAND     + MF_STRING,SC_MINIMIZE     ,("    "+(ToAnsi"„&¢˜® ©«¦§¦åž©ž")))))  to bState
52593>>>>>>>//        Move (ModifyMenu(hSmId,SC_MAXIMIZE,MF_BYCOMMAND     + MF_STRING,SC_MAXIMIZE     ,("    "+(ToAnsi"‹œš &©«¦§¦åž©ž")))))   to bState
52593>>>>>>>//        Move (ModifyMenu(hSmId,SC_CLOSE,MF_BYCOMMAND        + MF_STRING,SC_CLOSE        ,("    "+(ToAnsi"&„¥¦›¦ª  Alt+F4")))))  to bState
52593>>>>>>>//        Move (ModifyMenu(hSmId,SC_NEXTWINDOW,MF_BYCOMMAND   + MF_STRING,SC_NEXTWINDOW   ,("    "+(ToAnsi"„&§æ£œ¤¦ Ctrl+F6"))))) to bState
52593>>>>>>>   End
52593>>>>>>>>
52593>>>>>>>End_Procedure
52594>>>>>>>
52594>>>>>>>//****************************************************************************
52594>>>>>>>// $Module type: FUNCTION
52594>>>>>>>// $Module name: Computername
52594>>>>>>>// $Author     : SPY
52594>>>>>>>// Created     : 03-01-99 @ 9:53
52594>>>>>>>//
52594>>>>>>>// Description
52594>>>>>>>//
52594>>>>>>>// $Rev History
52594>>>>>>>//****************************************************************************
52594>>>>>>>Function Computername Global Returns String
52596>>>>>>>   Local Pointer lpComputerName lpNameSize
52596>>>>>>>   Local String sComputerName sNameSize
52596>>>>>>>   Local Integer iRetval
52596>>>>>>>
52596>>>>>>>   Movestr (Repeat (Character (0), MAX_COMPUTERNAME_LENGTH + 1)) To sComputerName
52597>>>>>>>>
52597>>>>>>>   GetAddress Of sComputerName To lpComputerName
52598>>>>>>>   Movestr (DwordToBytes (MAX_COMPUTERNAME_LENGTH + 1)) To sNameSize
52599>>>>>>>>
52599>>>>>>>   GetAddress Of sNameSize To lpNameSize
52600>>>>>>>
52600>>>>>>>   Moveint (GetComputerName (lpComputerName, lpNameSize)) To iRetval
52601>>>>>>>>
52601>>>>>>>
52601>>>>>>>   Function_Return (CString (sComputerName))
52602>>>>>>>End_Function // ComputerName
52603>>>>>>>
52603>>>>>>>
52603>>>>>>>//****************************************************************************
52603>>>>>>>// $Module type: FUNCTION
52603>>>>>>>// $Module name: DateToWeekDay
52603>>>>>>>// $Author     : SPY
52603>>>>>>>// Created     : 03-01-99 @ 9:53
52603>>>>>>>//
52603>>>>>>>// Description
52603>>>>>>>//
52603>>>>>>>// $Rev History
52603>>>>>>>//****************************************************************************
52603>>>>>>>
52603>>>>>>>Function DateToWeekDay Global date dDate returns Integer
52605>>>>>>>    local string sWeekday
52605>>>>>>>    local integer iDay
52605>>>>>>>
52605>>>>>>>    // convert to 4 digits if needed
52605>>>>>>>    //
52605>>>>>>>    //if dDate le 36524 calc (dDate+693975) to dDate
52605>>>>>>>
52605>>>>>>>    // 0 ž ‰¬¨ ˜¡ã 1 ž ƒœ¬«â¨˜ ... 6 «¦ ‘á™™˜«¦
52605>>>>>>>    move ((mod((dDate-2),7))) to iDay
52606>>>>>>>
52606>>>>>>>    function_return iDay
52607>>>>>>>End_Function  // DateToWeekDay
52608>>>>>>>
52608>>>>>>>
52608>>>>>>>//****************************************************************************
52608>>>>>>>// $Module type: FUNCTION
52608>>>>>>>// $Module name: DateToWeekDayName
52608>>>>>>>// $Author     : SPY
52608>>>>>>>// Created     : 03-01-99 @ 9:53
52608>>>>>>>//
52608>>>>>>>// Description
52608>>>>>>>//
52608>>>>>>>// $Rev History
52608>>>>>>>//****************************************************************************
52608>>>>>>>
52608>>>>>>>Function DateToWeekDayName Global date dDate returns String
52610>>>>>>>    local string sWeekday
52610>>>>>>>    local integer iDay
52610>>>>>>>
52610>>>>>>>    // convert to 4 digits if needed
52610>>>>>>>    //
52610>>>>>>>    //if dDate le 36524 calc (dDate+693975) to dDate
52610>>>>>>>
52610>>>>>>>    move (DateToWeekDay(dDate)) to iDay
52611>>>>>>>
52611>>>>>>>    if iDay eq 0 move "‰¬¨ ˜¡ã"         to sWeekday
52614>>>>>>>    else if iDay eq 1 move "ƒœ¬«â¨˜"    to sWeekday
52618>>>>>>>    else if iDay eq 2 move "’¨å«ž"      to sWeekday
52622>>>>>>>    else if iDay eq 3 move "’œ«á¨«ž"    to sWeekday
52626>>>>>>>    else if iDay eq 4 move "â£§«ž"     to sWeekday
52630>>>>>>>    else if iDay eq 5 move "˜¨˜©¡œ¬ã"  to sWeekday
52634>>>>>>>    else if iDay eq 6 move "‘á™™˜«¦"    to sWeekday
52638>>>>>>>
52638>>>>>>>    function_return sWeekday
52639>>>>>>>End_Function  // DateToWeekDay
52640>>>>>>>
52640>>>>>>>
52640>>>>>>>Function DateToWeekDayNameEnglish Global Date dDate Returns String
52642>>>>>>>    Local String sWeekday
52642>>>>>>>    Local Integer iDay
52642>>>>>>>    Move (DateToWeekDay(dDate)) To iDay
52643>>>>>>>
52643>>>>>>>         If iDay eq 0 Move "Sunday"     To sWeekday
52646>>>>>>>    Else If iDay eq 1 Move "Monday"     To sWeekday
52650>>>>>>>    Else If iDay eq 2 Move "Tuesday"    To sWeekday
52654>>>>>>>    Else If iDay eq 3 Move "Wednesday"  To sWeekday
52658>>>>>>>    Else If iDay eq 4 Move "Thursday"   To sWeekday
52662>>>>>>>    Else If iDay eq 5 Move "Friday"     To sWeekday
52666>>>>>>>    Else If iDay eq 6 Move "Saturday"   To sWeekday
52670>>>>>>>
52670>>>>>>>    Function_Return sWeekday
52671>>>>>>>End_Function  // DateToWeekDay
52672>>>>>>>
52672>>>>>>>
52672>>>>>>>//****************************************************************************
52672>>>>>>>// $Module type: FUNCTION
52672>>>>>>>// $Module name: TheFirstSegment - TheSecondSegment - TheThirdSegment of Date
52672>>>>>>>// $Author     : SPY
52672>>>>>>>// Created     : 03-01-99 @ 9:53
52672>>>>>>>//
52672>>>>>>>// Description
52672>>>>>>>//
52672>>>>>>>// $Rev History
52672>>>>>>>//****************************************************************************
52672>>>>>>>
52672>>>>>>>Function TheFirstSegment Global date dDate Returns Integer
52674>>>>>>>    Local Integer rVal rPlace
52674>>>>>>>    Local String sDSep
52674>>>>>>>    Get_attribute DF_Date_Separator to rval
52677>>>>>>>    Move (Character(rVal)) to sDSep
52678>>>>>>>    Pos sDSep in dDate to rPlace
52680>>>>>>>>
52680>>>>>>>    Move (Left(dDate,(rPlace-1))) to rVal
52681>>>>>>>    Function_Return rVal
52682>>>>>>>End_Function // TheFirstSegment
52683>>>>>>>
52683>>>>>>>Function TheSecondSegment Global Date dDate Returns Integer
52685>>>>>>>    Local Integer rVal rPlace
52685>>>>>>>    Local String sDSep sDay sTempDate
52685>>>>>>>    Move dDate to sTempDate
52686>>>>>>>    Get_attribute DF_Date_Separator to rval
52689>>>>>>>    Move (Character(rVal)) to sDSep
52690>>>>>>>    Pos sDSep in sTempDate to rPlace
52692>>>>>>>>
52692>>>>>>>    Move (Left(sTempDate,(rPlace-1))) to sDay
52693>>>>>>>    Replace (sDay+sDSep) in sTempDate With ""
52695>>>>>>>    Pos sDSep in sTempDate to rPlace
52697>>>>>>>>
52697>>>>>>>    Move (Left(sTempDate,(rPlace-1))) to rVal
52698>>>>>>>    Function_Return rVal
52699>>>>>>>End_Function // TheMonthSegment
52700>>>>>>>
52700>>>>>>>Function TheThirdSegment Global Date dDate Returns Integer
52702>>>>>>>    Local Integer rVal rPlace
52702>>>>>>>    Local String sDSep sDay sMonth sTempDate
52702>>>>>>>    Move dDate to sTempDate
52703>>>>>>>    Get_attribute DF_Date_Separator to rval
52706>>>>>>>    Move (Character(rVal)) to sDSep
52707>>>>>>>    Pos sDSep in sTempDate to rPlace
52709>>>>>>>>
52709>>>>>>>    Move (Left(sTempDate,(rPlace-1))) to sDay
52710>>>>>>>    Replace (sDay+sDSep) in sTempDate With ""
52712>>>>>>>    Pos sDSep in sTempDate to rPlace
52714>>>>>>>>
52714>>>>>>>    Move (Left(sTempDate,(rPlace-1))) to sMonth
52715>>>>>>>    Replace (sMonth+sDSep) in sTempDate With ""
52717>>>>>>>    Move sTempDate to rVal
52718>>>>>>>    Function_Return rVal
52719>>>>>>>End_Function // TheThirdSegment
52720>>>>>>>
52720>>>>>>>
52720>>>>>>>//****************************************************************************
52720>>>>>>>// $Module type: FUNCTION
52720>>>>>>>// $Module name: TheYearSegment
52720>>>>>>>// $Author     : SPY
52720>>>>>>>// Created     : 03-01-99 @ 9:53
52720>>>>>>>//
52720>>>>>>>// Description
52720>>>>>>>//
52720>>>>>>>// $Rev History
52720>>>>>>>//****************************************************************************
52720>>>>>>>
52720>>>>>>>Function TheYearSegment Global Date dDate Returns Integer
52722>>>>>>>    Local Integer rVal rPlace
52722>>>>>>>    Local String sDSep
52722>>>>>>>    Local Number lnDateFormat
52722>>>>>>>    Get_Attribute DF_DATE_FORMAT to lnDateFormat
52725>>>>>>>    Get_attribute DF_Date_Separator to rval
52728>>>>>>>    If lnDateFormat eq DF_DATE_MILITARY Move (TheFirstSegment(dDate)) to rVal
52731>>>>>>>    Else Move (TheThirdSegment(dDate)) to rVal
52733>>>>>>>    Function_Return rVal
52734>>>>>>>End_Function // TheYearSegment
52735>>>>>>>
52735>>>>>>>
52735>>>>>>>//****************************************************************************
52735>>>>>>>// $Module type: FUNCTION
52735>>>>>>>// $Module name: TheDaySegment
52735>>>>>>>// $Author     : SPY
52735>>>>>>>// Created     : 03-01-99 @ 9:53
52735>>>>>>>//
52735>>>>>>>// Description
52735>>>>>>>//
52735>>>>>>>// $Rev History
52735>>>>>>>//****************************************************************************
52735>>>>>>>
52735>>>>>>>Function TheDaySegment Global date dDate Returns Integer
52737>>>>>>>    Local Integer rVal rPlace
52737>>>>>>>    Local String sDSep
52737>>>>>>>    Local Number lnDateFormat
52737>>>>>>>    Get_Attribute DF_DATE_FORMAT to lnDateFormat
52740>>>>>>>    Get_attribute DF_Date_Separator to rval
52743>>>>>>>    If lnDateFormat eq DF_DATE_EUROPEAN Move (TheFirstSegment(dDate)) to rVal
52746>>>>>>>    Else If lnDateFormat eq DF_DATE_USA Move (TheSecondSegment(dDate)) to rVal
52750>>>>>>>    Else If lnDateFormat eq DF_DATE_MILITARY Move (TheThirdSegment(dDate)) to rVal
52754>>>>>>>    Function_Return rVal
52755>>>>>>>End_Function // TheDaySegment
52756>>>>>>>
52756>>>>>>>
52756>>>>>>>//****************************************************************************
52756>>>>>>>// $Module type: FUNCTION
52756>>>>>>>// $Module name: TheMonthSegment
52756>>>>>>>// $Author     : SPY
52756>>>>>>>// Created     : 03-01-99 @ 9:53
52756>>>>>>>//
52756>>>>>>>// Description
52756>>>>>>>//
52756>>>>>>>// $Rev History
52756>>>>>>>//****************************************************************************
52756>>>>>>>
52756>>>>>>>
52756>>>>>>>Function TheMonthSegment Global date dDate Returns Integer
52758>>>>>>>    Local Integer rVal rPlace
52758>>>>>>>    Local String sDSep
52758>>>>>>>    Local Number lnDateFormat
52758>>>>>>>    Get_Attribute DF_DATE_FORMAT to lnDateFormat
52761>>>>>>>    Get_attribute DF_Date_Separator to rval
52764>>>>>>>    If lnDateFormat eq DF_DATE_USA Move (TheFirstSegment(dDate)) to rVal
52767>>>>>>>    Else Move (TheSecondSegment(dDate)) to rVal
52769>>>>>>>    Function_Return rVal
52770>>>>>>>End_Function // TheMonthSegment
52771>>>>>>>
52771>>>>>>>Function Sysdate4_Year Global Returns Integer
52773>>>>>>>    Date ldHmnia
52773>>>>>>>    Sysdate4 ldHmnia
52774>>>>>>>    Function_Return (TheYearSegment(ldHmnia))
52775>>>>>>>End_Function //private.etos
52776>>>>>>>
52776>>>>>>>Function Sysdate4_Month Global Returns Integer
52778>>>>>>>    Date ldHmnia
52778>>>>>>>    Sysdate4 ldHmnia
52779>>>>>>>    Function_Return (TheMonthSegment(ldHmnia))
52780>>>>>>>End_Function //private.mhnas
52781>>>>>>>
52781>>>>>>>Function Sysdate4_Day Global Returns Integer
52783>>>>>>>    Date ldHmnia
52783>>>>>>>    Sysdate4 ldHmnia
52784>>>>>>>    Function_Return (TheDaySegment(ldHmnia))
52785>>>>>>>End_Function //private.mhnas
52786>>>>>>>
52786>>>>>>>
52786>>>>>>>//****************************************************************************
52786>>>>>>>// $Module type: FUNCTION
52786>>>>>>>// $Module name: TheMonthName (The Modes 0 The Default , 1 ‚œ¤ ¡ã «¦¬ £ã¤˜, 2 € « ˜« ¡ã
52786>>>>>>>// $Author     : SPY
52786>>>>>>>// Created     : 03-01-99 @ 9:53
52786>>>>>>>//
52786>>>>>>>// Description
52786>>>>>>>//
52786>>>>>>>// $Rev History
52786>>>>>>>//****************************************************************************
52786>>>>>>>
52786>>>>>>>Enumeration_List
52786>>>>>>>    Define mMonthOnom
52786>>>>>>>    Define mMonthGen
52786>>>>>>>    Define mMonthAit
52786>>>>>>>    Define mMonthEnglish
52786>>>>>>>End_Enumeration_List
52786>>>>>>>
52786>>>>>>>Function TheMonthName Global Integer iMonthNum Integer iMode Returns String
52788>>>>>>>    Local String rMonth
52788>>>>>>>
52788>>>>>>>    If iMode eq mMonthGen Begin
52790>>>>>>>             If iMonthNum eq 1  Move "ˆ˜¤¦¬˜¨å¦¬"  to rMonth
52793>>>>>>>        Else If iMonthNum eq 2  Move "”œ™¨¦¬˜¨å¦¬" to rMonth
52797>>>>>>>        Else If iMonthNum eq 3  Move "‹˜¨«å¦¬"     to rMonth
52801>>>>>>>        Else If iMonthNum eq 4  Move "€§¨ ¢å¦¬"    to rMonth
52805>>>>>>>        Else If iMonthNum eq 5  Move "‹˜å¦¬"       to rMonth
52809>>>>>>>        Else If iMonthNum eq 6  Move "ˆ¦¬¤å¦¬"     to rMonth
52813>>>>>>>        Else If iMonthNum eq 7  Move "ˆ¦¬¢å¦¬"     to rMonth
52817>>>>>>>        Else If iMonthNum eq 8  Move "€¬š¦ç©«¦¬"   to rMonth
52821>>>>>>>        Else If iMonthNum eq 9  Move "‘œ§«œ£™¨å¦¬" to rMonth
52825>>>>>>>        Else If iMonthNum eq 10 Move "Ž¡«à™¨å¦¬"   to rMonth
52829>>>>>>>        Else If iMonthNum eq 11 Move "Œ¦œ£™¨å¦¬"   to rMonth
52833>>>>>>>        Else If iMonthNum eq 12 Move "ƒœ¡œ£™¨å¦¬"  to rMonth
52837>>>>>>>    End
52837>>>>>>>>
52837>>>>>>>    Else Begin
52838>>>>>>>        If iMode eq mMonthAit Begin
52840>>>>>>>                 If iMonthNum eq 1  Move "ˆ˜¤¦¬á¨ ¦"  to rMonth
52843>>>>>>>            Else If iMonthNum eq 2  Move "”œ™¨¦¬á¨ ¦" to rMonth
52847>>>>>>>            Else If iMonthNum eq 3  Move "‹á¨« ¦"     to rMonth
52851>>>>>>>            Else If iMonthNum eq 4  Move "€§¨å¢ ¦"    to rMonth
52855>>>>>>>            Else If iMonthNum eq 5  Move "‹á ¦"       to rMonth
52859>>>>>>>            Else If iMonthNum eq 6  Move "ˆ¦ç¤ ¦"     to rMonth
52863>>>>>>>            Else If iMonthNum eq 7  Move "ˆ¦ç¢ ¦"     to rMonth
52867>>>>>>>            Else If iMonthNum eq 8  Move "€çš¦¬©«¦"   to rMonth
52871>>>>>>>            Else If iMonthNum eq 9  Move "‘œ§«â£™¨ ¦" to rMonth
52875>>>>>>>            Else If iMonthNum eq 10 Move "Ž¡«é™¨ ¦"   to rMonth
52879>>>>>>>            Else If iMonthNum eq 11 Move "Œ¦â£™¨ ¦"   to rMonth
52883>>>>>>>            Else If iMonthNum eq 12 Move "ƒœ¡â£™¨ ¦"  to rMonth
52887>>>>>>>        End
52887>>>>>>>>
52887>>>>>>>        Else Begin
52888>>>>>>>            If iMode eq mMonthOnom Begin
52890>>>>>>>                     If iMonthNum eq 1  Move "ˆ˜¤¦¬á¨ ¦ª"  To rMonth
52893>>>>>>>                Else If iMonthNum eq 2  Move "”œ™¨¦¬á¨ ¦ª" To rMonth
52897>>>>>>>                Else If iMonthNum eq 3  Move "‹á¨« ¦ª"     To rMonth
52901>>>>>>>                Else If iMonthNum eq 4  Move "€§¨å¢ ¦ª"    To rMonth
52905>>>>>>>                Else If iMonthNum eq 5  Move "‹á ¦ª"       To rMonth
52909>>>>>>>                Else If iMonthNum eq 6  Move "ˆ¦ç¤ ¦ª"     To rMonth
52913>>>>>>>                Else If iMonthNum eq 7  Move "ˆ¦ç¢ ¦ª"     To rMonth
52917>>>>>>>                Else If iMonthNum eq 8  Move "€çš¦¬©«¦ª"   To rMonth
52921>>>>>>>                Else If iMonthNum eq 9  Move "‘œ§«â£™¨ ¦ª" To rMonth
52925>>>>>>>                Else If iMonthNum eq 10 Move "Ž¡«é™¨ ¦ª"   To rMonth
52929>>>>>>>                Else If iMonthNum eq 11 Move "Œ¦â£™¨ ¦ª"   To rMonth
52933>>>>>>>                Else If iMonthNum eq 12 Move "ƒœ¡â£™¨ ¦ª"  To rMonth
52937>>>>>>>            End
52937>>>>>>>>
52937>>>>>>>            Else Begin
52938>>>>>>>                If iMode eq mMonthEnglish Begin
52940>>>>>>>                         If iMonthNum eq 1  Move "January"      To rMonth
52943>>>>>>>                    Else If iMonthNum eq 2  Move "February"     To rMonth
52947>>>>>>>                    Else If iMonthNum eq 3  Move "March"        To rMonth
52951>>>>>>>                    Else If iMonthNum eq 4  Move "April"        To rMonth
52955>>>>>>>                    Else If iMonthNum eq 5  Move "May"          To rMonth
52959>>>>>>>                    Else If iMonthNum eq 6  Move "June"         To rMonth
52963>>>>>>>                    Else If iMonthNum eq 7  Move "July"         To rMonth
52967>>>>>>>                    Else If iMonthNum eq 8  Move "August"       To rMonth
52971>>>>>>>                    Else If iMonthNum eq 9  Move "September"    To rMonth
52975>>>>>>>                    Else If iMonthNum eq 10 Move "October"      To rMonth
52979>>>>>>>                    Else If iMonthNum eq 11 Move "November"     To rMonth
52983>>>>>>>                    Else If iMonthNum eq 12 Move "December"     To rMonth
52987>>>>>>>                End
52987>>>>>>>>
52987>>>>>>>            End
52987>>>>>>>>
52987>>>>>>>
52987>>>>>>>        End
52987>>>>>>>>
52987>>>>>>>    End
52987>>>>>>>>
52987>>>>>>>
52987>>>>>>>    Function_Return rMonth
52988>>>>>>>End_Function // TheMonthName
52989>>>>>>>
52989>>>>>>>//****************************************************************************
52989>>>>>>>// $Module type: FUNCTION
52989>>>>>>>// $Module name: LongDateName
52989>>>>>>>// $Author     : SPY
52989>>>>>>>// Created     : 03-01-99 @ 9:53
52989>>>>>>>//
52989>>>>>>>// Description
52989>>>>>>>//
52989>>>>>>>// $Rev History
52989>>>>>>>//****************************************************************************
52989>>>>>>>
52989>>>>>>>Function LongDateName Global Date dDate Returns String
52991>>>>>>>    Local String sDay sDate sMonth sYear
52991>>>>>>>    Move (DateToWeekDayName(dDate))        to sDay
52992>>>>>>>    Move (TheDaySegment(dDate))                   to sDate
52993>>>>>>>    Move (TheMonthName((TheMonthSegment(dDate)),1)) to sMonth
52994>>>>>>>    Move (TheYearSegment(dDate))                  to sYear
52995>>>>>>>    Function_Return (sDay+","*sDate*sMonth*sYear)
52996>>>>>>>End_Function
52997>>>>>>>
52997>>>>>>>//****************************************************************************
52997>>>>>>>// $Module type: FUNCTION
52997>>>>>>>// $Module name: isDisekto
52997>>>>>>>// $Author     : SPY
52997>>>>>>>// Created     : 03-01-99 @ 9:53
52997>>>>>>>//
52997>>>>>>>// Description
52997>>>>>>>//
52997>>>>>>>// $Rev History
52997>>>>>>>//****************************************************************************
52997>>>>>>>
52997>>>>>>>Function isDisekto Global Integer liYear Returns Integer
52999>>>>>>>    Local Integer rVal
52999>>>>>>>    If (Mod(liYear,4) = 0) Begin
53001>>>>>>>        If (Mod(liYear,100) = 0) Begin
53003>>>>>>>            If (Mod(liYear,400) = 0) Move 1 to rVal
53006>>>>>>>        End
53006>>>>>>>>
53006>>>>>>>        Else Move 1 to rVal
53008>>>>>>>    End
53008>>>>>>>>
53008>>>>>>>    Function_Return rVal
53009>>>>>>>End_Function // isDisekto
53010>>>>>>>
53010>>>>>>>//****************************************************************************
53010>>>>>>>// $Module type: FUNCTION
53010>>>>>>>// $Module name: DaysOfYear
53010>>>>>>>// $Author     : SPY
53010>>>>>>>// Created     : 03-01-99 @ 9:53
53010>>>>>>>//
53010>>>>>>>// Description
53010>>>>>>>//
53010>>>>>>>// $Rev History
53010>>>>>>>//****************************************************************************
53010>>>>>>>
53010>>>>>>>Function DaysOfYear global Integer iYear Returns Integer
53012>>>>>>>    Local Integer rVal
53012>>>>>>>    Move 365 to rVal
53013>>>>>>>    If (isDisekto(iYear)) Move 366 to rVal
53016>>>>>>>    Function_Return rval
53017>>>>>>>End_Function // DaysOfYear
53018>>>>>>>
53018>>>>>>>//****************************************************************************
53018>>>>>>>// $Module type: FUNCTION
53018>>>>>>>// $Module name: BeginOfMonth
53018>>>>>>>// $Author     : SPY
53018>>>>>>>// Created     : 03-01-99 @ 9:53
53018>>>>>>>//
53018>>>>>>>// Description
53018>>>>>>>//
53018>>>>>>>// $Rev History
53018>>>>>>>//****************************************************************************
53018>>>>>>>
53018>>>>>>>Function BeginOfMonth Global Integer liMonth Integer liYear Returns Date
53020>>>>>>>    Local Integer rVal
53020>>>>>>>    Local Date rDate
53020>>>>>>>    Local String liMM lsDSep
53020>>>>>>>    Local Number lnDateFormat
53020>>>>>>>    Get_attribute DF_Date_Separator to rval
53023>>>>>>>    Move (Character(rVal)) to lsDSep
53024>>>>>>>    Get_Attribute DF_DATE_FORMAT to lnDateFormat
53027>>>>>>>    If (Length (liMonth) = 1) Move ("0" + String(liMonth)) to liMM
53030>>>>>>>    Else Move (String(liMonth)) to liMM
53032>>>>>>>    If lnDateFormat eq DF_DATE_EUROPEAN       Move ("01" + lsDSep + liMM + lsDSep + String(liYear)) to rDate
53035>>>>>>>    Else If lnDateFormat eq DF_DATE_USA       Move (liMM + lsDSep + "01" + lsDSep + String(liYear)) to rDate
53039>>>>>>>    Else If lnDateFormat eq DF_DATE_MILITARY  Move (String(liYear) + lsDSep + liMM + lsDSep + "01") to rDate
53043>>>>>>>    Function_Return rDate
53044>>>>>>>End_Function  //BeginOfMonth
53045>>>>>>>
53045>>>>>>>
53045>>>>>>>//****************************************************************************
53045>>>>>>>// $Module type: FUNCTION
53045>>>>>>>// $Module name: EndOfMonth
53045>>>>>>>// $Author     : SPY
53045>>>>>>>// Created     : 03-01-99 @ 9:53
53045>>>>>>>//
53045>>>>>>>// Description
53045>>>>>>>//
53045>>>>>>>// $Rev History
53045>>>>>>>//****************************************************************************
53045>>>>>>>
53045>>>>>>>Function EndOfMonth Global Integer liMonth Integer liYear Returns Date
53047>>>>>>>    Local Date rDate
53047>>>>>>>    If liMonth eq 12 Move (BeginOfMonth(1,(liYear+1))-1) to rDate
53050>>>>>>>    Else Move (BeginOfMonth((liMonth+1),liYear)-1) to rDate
53052>>>>>>>    Function_Return rDate
53053>>>>>>>End_Function  // EndOfMonth
53054>>>>>>>
53054>>>>>>>//****************************************************************************
53054>>>>>>>// $Module type: FUNCTION
53054>>>>>>>// $Module name: LastMonday
53054>>>>>>>// $Author     : SPY
53054>>>>>>>// Created     : 03-01-99 @ 9:53
53054>>>>>>>//
53054>>>>>>>// Description
53054>>>>>>>//
53054>>>>>>>// $Rev History
53054>>>>>>>//****************************************************************************
53054>>>>>>>
53054>>>>>>>Function LastMonday global Date dDate Returns Date
53056>>>>>>>    Local Integer iWeekDay
53056>>>>>>>    Local Date rVal
53056>>>>>>>    Move (DateToWeekDay(dDate)) to iWeekDay
53057>>>>>>>    If iWeekDay eq 0 Move (dDate-6) to rVal
53060>>>>>>>    Else Move (dDate-(iWeekDay-1)) to rVal
53062>>>>>>>    Function_Return rval
53063>>>>>>>End_Function // LastMonday
53064>>>>>>>
53064>>>>>>>
53064>>>>>>>//****************************************************************************
53064>>>>>>>// $Module type: FUNCTION
53064>>>>>>>// $Module name: DayOfTheYear
53064>>>>>>>// $Author     : SPY
53064>>>>>>>// Created     : 03-01-99 @ 9:53
53064>>>>>>>//
53064>>>>>>>// Description
53064>>>>>>>//
53064>>>>>>>// $Rev History
53064>>>>>>>//****************************************************************************
53064>>>>>>>
53064>>>>>>>Function DayOfTheYear global date dDate Returns Integer
53066>>>>>>>    local integer rVal
53066>>>>>>>    local string sYSeg
53066>>>>>>>    local date ldate lcheckdate
53066>>>>>>>    Local Number lnDateFormat
53066>>>>>>>    Get_Attribute DF_DATE_FORMAT to lnDateFormat
53069>>>>>>>    Move (BeginOfMonth(1,(TheYearSegment(dDate)))) to lDate
53070>>>>>>>    Move ((dDate-lDate)+1) to rval
53071>>>>>>>    If Not (isDisekto(TheYearSegment(dDate))=1) Begin
53073>>>>>>>        If lnDateFormat eq DF_DATE_EUROPEAN Move ("01/03/"+(String((TheYearSegment(dDate))))) to lcheckdate
53076>>>>>>>        Else If lnDateFormat eq DF_DATE_USA Move ("03/01/"+(String((TheYearSegment(dDate))))) to lcheckdate
53080>>>>>>>        Else If lnDateFormat eq DF_DATE_MILITARY Move ((String((TheYearSegment(dDate))))+"03/01/") to lcheckdate
53084>>>>>>>        If (((lCheckDate-lDate) = 60) and (dDate ge lcheckDate)) Move (dDate-lDate) to rval
53087>>>>>>>    End
53087>>>>>>>>
53087>>>>>>>    Function_Return rVal
53088>>>>>>>End_Function  // DayOfTheYear
53089>>>>>>>
53089>>>>>>>
53089>>>>>>>//****************************************************************************
53089>>>>>>>// $Module type: FUNCTION
53089>>>>>>>// $Module name: TheEasterDay
53089>>>>>>>// $Author     : SPY
53089>>>>>>>// Created     : 13-06-99 @ 9:53
53089>>>>>>>//
53089>>>>>>>// Description
53089>>>>>>>//
53089>>>>>>>// $Rev History
53089>>>>>>>//****************************************************************************
53089>>>>>>>
53089>>>>>>>Function TheEasterDay Global Integer aiTheYear Returns Date
53091>>>>>>>    Local Integer liMoonYearCycle liEpakth liEasterFullMoon liMonth
53091>>>>>>>    Local Integer liOldDateFormat liSeparator
53091>>>>>>>    Local Date ldEasterDay
53091>>>>>>>    Local String lsDSep
53091>>>>>>>    Get_attribute DF_Date_Separator to liSeparator
53094>>>>>>>    Get_Attribute DF_DATE_FORMAT to liOldDateFormat
53097>>>>>>>    Set_Attribute DF_DATE_FORMAT to DF_DATE_EUROPEAN
53100>>>>>>>    Move (Character(liSeparator)) to lsDSep
53101>>>>>>>    Move 3 to liMonth
53102>>>>>>>    Move (Mod((aiTheYear-2),19)) to liMoonYearCycle
53103>>>>>>>    Move (Mod((11*liMoonYearCycle),30)) to liEpakth
53104>>>>>>>    Move ((30-liEpakth)+14) to liEasterFullMoon
53105>>>>>>>    If liEasterFullMoon ge 21 Begin
53107>>>>>>>        If liEasterFullMoon gt 31 Begin
53109>>>>>>>            Move (liEasterFullMoon-31) to liEasterFullMoon
53110>>>>>>>            Move 4 to liMonth
53111>>>>>>>        End
53111>>>>>>>>
53111>>>>>>>    End
53111>>>>>>>>
53111>>>>>>>    Else Begin
53112>>>>>>>        Move (liEasterFullMoon-1) to liEasterFullMoon
53113>>>>>>>        Move 4 to liMonth
53114>>>>>>>    End
53114>>>>>>>>
53114>>>>>>>    Move (String(liEasterFullMoon) + lsDSep + String(liMonth) + lsDSep + String(aiTheYear)) to ldEasterDay
53115>>>>>>>    Set_Attribute DF_DATE_FORMAT to liOldDateFormat
53118>>>>>>>
53118>>>>>>>    //‰˜«á «¦ ˆ¦¬¢ ˜¤æ ž£œ¨¦¢æš ¦ ž §¨é«ž ‰¬¨ ˜¡ã ã ž œ§æ£œ¤ž ˜¤ ldEasterDay œå¤˜  ‰¬¨ ˜¡ã
53118>>>>>>>    //Move (ldEasterDay + (7- (DateToWeekDay(ldEasterDay)) )  ) to ldEasterDay
53118>>>>>>>
53118>>>>>>>    //Ž£àª £œ«á ˜§æ â¢œš®¦ œå¤˜  14 ž£â¨œª £œ«á «ž¤ §¨é«ž ¡¬¨ ˜¡ã ˜§æ ldEasterDay ˜¡æ£˜ ¡˜  ˜¤
53118>>>>>>>    //ldEasterDay œå¤˜  ‰¬¨ ˜¡ã (›œ¤ š¤à¨åà š ˜«å)
53118>>>>>>>    If (DateToWeekDay(ldEasterDay) <> 0) Move (ldEasterDay + (7-(DateToWeekDay(ldEasterDay)))) to ldEasterDay
53121>>>>>>>    Move (ldEasterDay+14) to ldEasterDay
53122>>>>>>>    Function_Return ldEasterDay
53123>>>>>>>End_Function
53124>>>>>>>
53124>>>>>>>
53124>>>>>>>// Remarked - “§á¨®¦¬¤ ˜¤«å©«¦ ®œª ©«ž¤ VDF (ToAnsi, ToOEM) 21/09/98 -Spy
53124>>>>>>>
53124>>>>>>>//You must be aware that due to compatibility of the database between DOS CM
53124>>>>>>>//versions and VDF, all data in DataFlex datafiles will be stored using the same
53124>>>>>>>//character set (like DOS cp850).
53124>>>>>>>//This means that if you want read data from an ascii file directly into the
53124>>>>>>>//record buffer, and this ascii file is in windows (ansi) format, you must
53124>>>>>>>//convert the data first, using the OemToAnsi function. (and v.v. with AnsiToOem
53124>>>>>>>//if you want to write a text file of windows format).
53124>>>>>>>
53124>>>>>>>//The AnsiToOem and OemToAnsi functions itself takes pointers as arguments, so it
53124>>>>>>>//will be convenient to create functions on top of these, so you can call these
53124>>>>>>>//functions with a normal string as argument. I have made functions like this:
53124>>>>>>>
53124>>>>>>>//            function wintilcpDOS global string sind returns string
53124>>>>>>>//                local pointer ip
53124>>>>>>>//                local integer itmp ilen
53124>>>>>>>//                move (length(sind)) to ilen
53124>>>>>>>//                append sind (character(0))
53124>>>>>>>//                getaddress of sind to ip
53124>>>>>>>//                Move (AnsiToOem(ip,ip)) To iTmp
53124>>>>>>>//                function_return (left(sind,ilen))
53124>>>>>>>//            end_function
53124>>>>>>>
53124>>>>>>>//            function cpDOStilwin global string sind returns string
53124>>>>>>>//                local pointer ip
53124>>>>>>>//                local integer itmp ilen
53124>>>>>>>//                move (length(sind)) to ilen
53124>>>>>>>//                append sind (character(0))
53124>>>>>>>//                getaddress of sind to ip
53124>>>>>>>//                Move (OemToAnsi(ip,ip)) To iTmp
53124>>>>>>>//                function_return (left(sind,ilen))
53124>>>>>>>//            end_function
53124>>>>>>>
53124>>>>>>>// Global Handle for Set Object
53124>>>>>>>Integer ghoExpSet
53124>>>>>>>
53124>>>>>>>Function Get_ExpOfTwo Global Real arNum Returns Integer
53126>>>>>>>    Local real lrNum lrTempNum
53126>>>>>>>    Local Integer liCounter
53126>>>>>>>
53126>>>>>>>    Move arNum to lrNum
53127>>>>>>>    If ((lrNum < 10e+306) and (lrNum > 0)) Begin
53129>>>>>>>        //destroy the set using the global integer that hold its handle
53129>>>>>>>        If (ghoExpSet) Send destroy_object to ghoExpSet
53132>>>>>>>        //Make an instance of a set to hold the Exp
53132>>>>>>>        Get Make_Set to ghoExpSet
53133>>>>>>>        Move 1 to lrTempnum
53134>>>>>>>        While (lrTempnum<lrNum)
53138>>>>>>>
53138>>>>>>>            Repeat
53138>>>>>>>>
53138>>>>>>>                If ((2*lrTempnum)<=lrNum) Begin
53140>>>>>>>                    Move (2*lrTempnum) to lrTempnum
53141>>>>>>>                    Add 1 to liCounter
53142>>>>>>>                End
53142>>>>>>>>
53142>>>>>>>            Until ((2*lrTempnum)>lrNum)
53144>>>>>>>            Send Add_Element to ghoExpSet liCounter
53145>>>>>>>            If (lrTempnum<lrNum) Begin
53147>>>>>>>                Move (lrnum-lrTempnum) to lrnum
53148>>>>>>>                Move 1 to lrTempnum
53149>>>>>>>                Move 0 to liCounter
53150>>>>>>>            End
53150>>>>>>>>
53150>>>>>>>
53150>>>>>>>        Loop
53151>>>>>>>>
53151>>>>>>>    End
53151>>>>>>>>
53151>>>>>>>    If ((lrNum = lrTempnum) and (lrNum <> 1)) Move 0 to lrNum
53154>>>>>>>    Function_Return  (String(lrNum))
53155>>>>>>>End_Function
53156>>>>>>>
53156>>>>>>>
53156>>>>>>>Function Get_PowerOfTwo Global Returns Real
53158>>>>>>>    Local Real liPowerOfTwo
53158>>>>>>>    Local Integer liCounter liExp
53158>>>>>>>    For liCounter From 0 to (Item_Count(ghoExpSet)-1)
53164>>>>>>>>
53164>>>>>>>        Get Value of ghoExpSet Item liCounter to liExp
53165>>>>>>>        Add (2^liExp) to liPowerOfTwo
53166>>>>>>>    Loop
53167>>>>>>>>
53167>>>>>>>    Function_Return liPowerOfTwo
53168>>>>>>>End_Function
53169>>>>>>>
53169>>>>>>>
53169>>>>>>>
53169>>>>>>>//Set Shadow_State of Item N to (Component_Shadow_State(**C**))
53169>>>>>>>Function Component_Shadow_State Global Integer liComponenet_Code Returns Integer
53171>>>>>>>         If liComponenet_Code eq 3  Function_Return 1 //disable
53174>>>>>>>         Function_Return 0 //enabled
53175>>>>>>>End_Function
53176>>>>>>>
53176>>>>>>>// 1 cm = 556,9291 twips
53176>>>>>>>// 1 in = 1440 twips
53176>>>>>>>// 1 in = 2,54 cm
53176>>>>>>>
53176>>>>>>>Function CmToTwips Global Number aiCm Returns Integer
53178>>>>>>>    Function_Return (Round(aiCm*566.9291))
53179>>>>>>>End_Function // CmToTwips
53180>>>>>>>
53180>>>>>>>Function CmToInches Global Number aiCm Returns Number
53182>>>>>>>    Function_Return (aiCm/2.54)
53183>>>>>>>End_Function // CmToInches
53184>>>>>>>
53184>>>>>>>Function InchesToCm Global Number aiIn Returns Number
53186>>>>>>>    Function_Return (aiIn*2.54)
53187>>>>>>>End_Function // InchesToCm
53188>>>>>>>
53188>>>>>>>Function TwipsToCm Global Integer aiTwips Returns Number
53190>>>>>>>    Function_Return (aiTwips/566.9291)
53191>>>>>>>End_Function // TwipsToCm
53192>>>>>>>
53192>>>>>>>
53192>>>>>>>///‚œ¤ ¡ã Function š ˜ ¡¢ã©ž «¦¬ Runtime 16/06/2000 Spy
53192>>>>>>>Procedure DoRunApplication For Baseclass String sAppName
53194>>>>>>>    String sRuntime
53194>>>>>>>    Integer bFileExists
53194>>>>>>>
53194>>>>>>>    get_profile_string "defaults" "VDFRootDir" to sRuntime
53197>>>>>>>    append sRuntime "\bin\dfrun.exe "
53198>>>>>>>    File_Exist sRuntime bFileExists
53199>>>>>>>    If (Not(bFileExists)) Begin
53201>>>>>>>        get_profile_string "defaults" "VDFBinDir" to sRuntime
53204>>>>>>>        append sRuntime "\dfrun.exe "
53205>>>>>>>        File_Exist sRuntime bFileExists
53206>>>>>>>        If (Not(bFileExists)) Begin
53208>>>>>>>            Send Stop_Box "¨¦©¦®ã. ƒœ¤ œ¬¨âŸž «¦ RunTime!" "‘­á¢£˜ ‘¬©«ã£˜«¦ª"
53209>>>>>>>            Procedure_Return
53210>>>>>>>        End
53210>>>>>>>>
53210>>>>>>>    End
53210>>>>>>>>
53210>>>>>>>    append sRuntime sAppName
53211>>>>>>>    runprogram background sRuntime
53212>>>>>>>End_procedure
53213>>>>>>>
53213>>>>>>>
53213>>>>>>>Function fsReturnFileFromPath Global String asFullPath Returns String
53215>>>>>>>    String rVal lsDirSep
53215>>>>>>>    Integer iPos iMet iLen iCnt
53215>>>>>>>    Move (Trim(asFullPath))                 To rVal
53216>>>>>>>    Move (Sysconf(SYSCONF_DIR_SEPARATOR))   To lsDirSep
53217>>>>>>>    If (rVal Contains lsDirSep) Begin
53219>>>>>>>        Move (Length(rVal)) to iLen
53220>>>>>>>        Move iLen to iCnt
53221>>>>>>>        While iCnt Gt 0
53225>>>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Begin
53227>>>>>>>                If (iCnt=iLen) Function_Return asFullPath
53230>>>>>>>                Else Function_Return (Right(rVal,(iLen-iCnt)))
53232>>>>>>>            End
53232>>>>>>>>
53232>>>>>>>            Decrement iCnt
53233>>>>>>>        End
53234>>>>>>>>
53234>>>>>>>    End
53234>>>>>>>>
53234>>>>>>>    Else  Function_Return (Trim(asFullPath))
53236>>>>>>>    Function_Return rVal
53237>>>>>>>End_Function
53238>>>>>>>
53238>>>>>>>
53238>>>>>>>
53238>>>>>>>
53238>>>>>Use WinusrEz.pkg
53238>>>>>Use ConfrmSc.pkg
Including file: CONFRMSC.PKG    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\CONFRMSC.PKG)
53238>>>>>>>USE msgbox
53238>>>>>>>
53238>>>>>>>Function fiConfirmation Global String item_name Returns Integer
53240>>>>>>>   Local Integer rval
53240>>>>>>>   Get YesNo_Box item_name "„§ ™œ™˜åà©ž" to rval
53241>>>>>>>   Function_Return (rval<>MBR_YES)
53242>>>>>>>End_function
53243>>>>>>>
53243>>>>>>>Function confirm FOR DESKTOP String item_name Returns Integer
53245>>>>>>>   Local Integer rval
53245>>>>>>>   Get fiConfirmation item_name to rval
53246>>>>>>>   Function_Return rval
53247>>>>>>>End_function
53248>>>>>>>
53248>>>>>>>Function Save_Confirmation FOR DESKTOP Returns integer
53250>>>>>>>  Function_return (confirm(Current_Object,"€§¦Ÿã¡œ¬©ž œšš¨˜­ãª ?"))
53251>>>>>>>End_function
53252>>>>>>>
53252>>>>>>>Function Delete_Confirmation FOR DESKTOP Returns integer
53254>>>>>>>  Function_return (confirm(Current_Object,"ƒ ˜š¨˜­ã œšš¨˜­ãª ?"))
53255>>>>>>>End_function
53256>>>>>>>
53256>>>>>>>Function Line_save_confirmation FOR DESKTOP Returns integer
53258>>>>>>>  Function_return (confirm(Current_Object,"€§¦Ÿã¡œ¬©ž š¨˜££ãª ?"))
53259>>>>>>>End_function
53260>>>>>>>
53260>>>>>>>Function Line_delete_confirmation FOR DESKTOP Returns integer
53262>>>>>>>  Function_return (confirm(Current_Object,"ƒ ˜š¨˜­ã š¨˜££ãª ?"))
53263>>>>>>>End_function
53264>>>>>>>
53264>>>>>>>Function Data_Loss_Confirmation FOR DESKTOP Returns integer
53266>>>>>>>  Function_return (confirm(Current_Object,"€¡¬¨œª ¦  ˜¢¢¢˜šâª ?"))
53267>>>>>>>End_function
53268>>>>>>>
53268>>>>>>>Function Exit_Loss_Confirmation FOR DESKTOP Returns integer
53270>>>>>>>  local integer tmp
53270>>>>>>>  get Should_save_recursive to tmp
53271>>>>>>>  if tmp ne 0 Function_return (confirm(Current_Object,"“§á¨®¦¬¤ ˜¢¢˜šâª. ‡˜ œ¥â¢Ÿœ«œ ?"))
53274>>>>>>>End_function
53275>>>>>>>
53275>>>>>>>Function No_Confirmation FOR DESKTOP Returns integer
53277>>>>>>>End_function
53278>>>>>>>
53278>>>>>>>Function Should_save for desktop returns integer
53280>>>>>>>end_function
53281>>>>>>>
53281>>>>>>>Function Should_Save_Recursive for desktop returns integer
53283>>>>>>>  Local Integer rVal
53283>>>>>>>  Get Should_Save to Rval
53284>>>>>>>  If rVal eq 0 BroadCast Get Should_Save_Recursive to Rval
53288>>>>>>>  Function_return rVal
53289>>>>>>>End_Function
53290>>>>>>>
53290>>>>>>>
53290>>>>>Use AccKeymx.ezc
Including file: ACCKEYMX.EZC    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\ACCKEYMX.EZC)
53290>>>>>>>Use dfClient
53290>>>>>>>Use cEdit_Mixin
53290>>>>>>>
53290>>>>>>>
53290>>>>>>>
53290>>>>>>>//Mixin ¡¢á©ž §¦¬ Ÿ˜ ˜§œ¤œ¨š¦§¦åž©ž «¦¬ §¢ž¡«¨¦¢¦šå¦¬
53290>>>>>>>
53290>>>>>>>Class DisableAcceleratorKey_Mixin is a Mixin
53291>>>>>>>
53291>>>>>>>    Procedure Define_DisableAcceleratorKey_Mixin
53293>>>>>>>
53293>>>>>>>        //If (phoWorkspace(ghoApplication)) Begin
53293>>>>>>>            //If (Disable_Keyboard_State(phoWorkspace(ghoApplication))) Begin
53293>>>>>>>                //on_key kBegin_of_Panel      SEND None PRIVATE
53293>>>>>>>                //on_key kCancel              SEND None PRIVATE
53293>>>>>>>                //on_key kEnd_of_Panel        SEND None PRIVATE
53293>>>>>>>                //on_key kExit_Function       SEND None PRIVATE
53293>>>>>>>                //on_key kExit_Application    SEND None PRIVATE
53293>>>>>>>                //on_key kSwitch              SEND None PRIVATE
53293>>>>>>>                //on_key kSwitch_Back         SEND None PRIVATE
53293>>>>>>>                //on_key kSwitch_Panel        SEND None PRIVATE
53293>>>>>>>                //on_key kSwitch_Panel_Back   SEND None PRIVATE
53293>>>>>>>                //on_key kSwitch              SEND None PRIVATE
53293>>>>>>>                //on_key kSwitch_Back         SEND None PRIVATE
53293>>>>>>>                //on_key kSwitch_Panel        SEND None Private
53293>>>>>>>                //on_key kSwitch_Panel_Back   SEND None Private
53293>>>>>>>                //on_key kClose_Panel         SEND None PRIVATE
53293>>>>>>>                //on_key kBegin_of_Data       SEND None PRIVATE
53293>>>>>>>                //on_key kClear               SEND None PRIVATE
53293>>>>>>>                //on_key kClear_All           SEND None PRIVATE
53293>>>>>>>                //on_key kDelete_Record       SEND None PRIVATE
53293>>>>>>>                //on_key kEnd_of_Data         SEND None PRIVATE
53293>>>>>>>                //on_key kFind                SEND None PRIVATE
53293>>>>>>>                //on_key kFind_Next           SEND None PRIVATE
53293>>>>>>>                //on_key kFind_Previous       SEND None PRIVATE
53293>>>>>>>                //on_key kSave_Record         SEND None PRIVATE
53293>>>>>>>                //on_key kSuper_Find          SEND None PRIVATE
53293>>>>>>>                //on_key kSuper_Find_Next     SEND None PRIVATE
53293>>>>>>>                //on_key kSuper_Find_Previous SEND None PRIVATE
53293>>>>>>>                //on_key kPrompt              SEND None PRIVATE
53293>>>>>>>                //on_key kZoom                SEND None PRIVATE
53293>>>>>>>                //on_key kUPARROW             send None PRIVATE
53293>>>>>>>                //on_key kDOWNARROW           send None PRIVATE
53293>>>>>>>                //on_key kADD_MODE            send None PRIVATE
53293>>>>>>>                //on_key key_F11              send None PRIVATE
53293>>>>>>>                //on_key key_F12              send None PRIVATE
53293>>>>>>>                //on_key key_F10              send None PRIVATE
53293>>>>>>>                //on_key key_F1               send None PRIVATE
53293>>>>>>>                //on_key kHelp                send None PRIVATE
53293>>>>>>>                //on_key kCancel              SEND None PRIVATE
53293>>>>>>>                //on_key kEnter               SEND None PRIVATE
53293>>>>>>>                //on_key kSpace               SEND None PRIVATE
53293>>>>>>>                //on_key kEnter               SEND None PRIVATE
53293>>>>>>>                //on_key key_Tab              SEND None PRIVATE
53293>>>>>>>                //on_key key_Shift+key_Tab    SEND None PRIVATE
53293>>>>>>>            //End
53293>>>>>>>        //End
53293>>>>>>>    End_Procedure
53294>>>>>>>
53294>>>>>>>    //Procedure key Integer key_Value
53294>>>>>>>        //If (phoWorkspace(ghoApplication)) Begin
53294>>>>>>>        //    If (Not(Disable_Keyboard_State(phoWorkspace(ghoApplication)))) ;
53294>>>>>>>        //        Forward Send key key_value
53294>>>>>>>        //End
53294>>>>>>>    //End_Procedure
53294>>>>>>>
53294>>>>>>>End_Class
53295>>>>>>>
53295>>>>>>>
53295>>>>>>>
53295>>>>>Use cSize_mx.pkg
Including file: CSIZE_MX.PKG    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\CSIZE_MX.PKG)
53295>>>>>>>Use dfclient
53295>>>>>>>Use dfallent
53295>>>>>>>
53295>>>>>>>
53295>>>>>>>// CSIZE_MX.PKG
53295>>>>>>>//
53295>>>>>>>//
53295>>>>>>>// cSize_mx.pkg
53295>>>>>>>
53295>>>>>>>// Collection of classes to support automatic size and location
53295>>>>>>>// of child objects
53295>>>>>>>
53295>>>>>>>Enumeration_List
53295>>>>>>>    Define amTopRight
53295>>>>>>>    Define amTopLeft
53295>>>>>>>    Define amBottomLeft
53295>>>>>>>    Define amBottomRight
53295>>>>>>>End_Enumeration_List
53295>>>>>>>
53295>>>>>>>Enumeration_List
53295>>>>>>>    Define smTopRight
53295>>>>>>>    Define smTopLeft
53295>>>>>>>    Define smBottomLeft
53295>>>>>>>    Define smBottomRight
53295>>>>>>>End_Enumeration_List
53295>>>>>>>
53295>>>>>>>
53295>>>>>>>Class cAlignModes Is An Array
53296>>>>>>>
53296>>>>>>>    Procedure DoAdd Integer ho Integer iMode
53298>>>>>>>        Local Integer cxy cxyho cy cx xyho yho xho cxho cyho
53298>>>>>>>        Delegate Get Size To cxy
53300>>>>>>>        Get Size of ho To cxyho
53301>>>>>>>
53301>>>>>>>        Move (Hi(cxy))    To cy
53302>>>>>>>        Move (Low(cxy))   To cx
53303>>>>>>>        Move (Hi(cxyho))  To cyho
53304>>>>>>>        Move (Low(cxyho)) To cxho
53305>>>>>>>
53305>>>>>>>        Get Location of ho To xyho
53306>>>>>>>        Move (Hi(xyho))  To yho
53307>>>>>>>        Move (Low(xyho)) To xho
53308>>>>>>>
53308>>>>>>>        If iMode eq amTopRight Begin
53310>>>>>>>            Set Value item (Item_Count(Current_Object)) To ;                ( String(ho) +'|' +String(iMode) +'|' ;                +String(cx - xho) +'|' +String(yho) +'|')
53311>>>>>>>        End
53311>>>>>>>>
53311>>>>>>>        Else If iMode eq amBottomRight Begin
53314>>>>>>>            Set Value item (Item_Count(Current_Object)) To ;                ( String(ho) +'|' +String(iMode) +'|' ;                +String(cx - xho) +'|' +String(cy -yho) +'|')
53315>>>>>>>        End
53315>>>>>>>>
53315>>>>>>>        Else If iMode eq amBottomLeft Begin
53318>>>>>>>            Set Value item (Item_Count(Current_Object)) To ;                ( String(ho) +'|' +String(iMode) +'|' ;                +String(xho) +'|' +String(cy -yho) +'|')
53319>>>>>>>        End
53319>>>>>>>>
53319>>>>>>>    End_Procedure
53320>>>>>>>
53320>>>>>>>
53320>>>>>>>    Procedure DoResize
53322>>>>>>>        Local Integer iLoop icItem iPos iMode ho x y cxy cx cy
53322>>>>>>>        Local String sItem
53322>>>>>>>        Get Item_Count To icItem
53323>>>>>>>        Delegate Send Adjust_Logicals
53325>>>>>>>        Delegate Get Size To cxy
53327>>>>>>>        Move (Hi(cxy)) To cy
53328>>>>>>>        Move (Low(cxy)) To cx
53329>>>>>>>        For iLoop From 0 To (icItem -1)
53335>>>>>>>>
53335>>>>>>>            Get Value item iLoop To sItem
53336>>>>>>>            Pos '|' In sItem To iPos
53338>>>>>>>>
53338>>>>>>>            Left sItem To ho (iPos -1)
53340>>>>>>>>
53340>>>>>>>            Right sItem To sItem (Length(sItem) -iPos)
53342>>>>>>>>
53342>>>>>>>
53342>>>>>>>            Pos '|' In sItem To iPos
53344>>>>>>>>
53344>>>>>>>            Left sItem To iMode (iPos -1)
53346>>>>>>>>
53346>>>>>>>            Right sItem To sItem (Length(sItem) -iPos)
53348>>>>>>>>
53348>>>>>>>
53348>>>>>>>            Pos '|' In sItem To iPos
53350>>>>>>>>
53350>>>>>>>            Left sItem To x (iPos -1)
53352>>>>>>>>
53352>>>>>>>            Right sItem To sItem (Length(sItem) -iPos)
53354>>>>>>>>
53354>>>>>>>
53354>>>>>>>            Pos '|' In sItem To iPos
53356>>>>>>>>
53356>>>>>>>            Left sItem To y (iPos -1)
53358>>>>>>>>
53358>>>>>>>            Right sItem To sItem (Length(sItem) -iPos)
53360>>>>>>>>
53360>>>>>>>
53360>>>>>>>            If iMode eq amTopRight         ;                Set Location of ho To y (cx -x)
53363>>>>>>>            Else If iMode eq amBottomRight ;                Set Location of ho To (cy -y) (cx -x)
53367>>>>>>>            Else If iMode eq amBottomLeft  ;                Set Location of ho To (cy -y) x
53371>>>>>>>
53371>>>>>>>        Loop
53372>>>>>>>>
53372>>>>>>>    End_Procedure
53373>>>>>>>
53373>>>>>>>End_Class
53374>>>>>>>
53374>>>>>>>//cSize_mx.pkg (Continued)
53374>>>>>>>Class cSizeModes Is An Array
53375>>>>>>>
53375>>>>>>>    Procedure DoAdd Integer ho Integer iMode
53377>>>>>>>        Local Integer cxy cxyho cy cx xyho yho xho cxho cyho
53377>>>>>>>        Delegate Get Size To cxy
53379>>>>>>>        Get Size of ho To cxyho
53380>>>>>>>
53380>>>>>>>        Move (Hi(cxy))    To cy
53381>>>>>>>        Move (Low(cxy))   To cx
53382>>>>>>>        Move (Hi(cxyho))  To cyho
53383>>>>>>>        Move (Low(cxyho)) To cxho
53384>>>>>>>
53384>>>>>>>        Get Location of ho To xyho
53385>>>>>>>        Move (Hi(xyho))  To yho
53386>>>>>>>        Move (Low(xyho)) To xho
53387>>>>>>>
53387>>>>>>>        If iMode eq smBottomRight Begin
53389>>>>>>>            Set Value item (Item_Count(Current_Object)) To ;                ( String(ho) +'|' +String(iMode) +'|' ;                +String(cx -xho -cxho) +'|' ;                                        +String(cy -yho -cyho) +'|')
53390>>>>>>>        End
53390>>>>>>>>
53390>>>>>>>        Else If iMode eq smTopRight Begin
53393>>>>>>>                Set Value item (Item_Count(Current_Object)) To ;                    ( String(ho) +'|' +String(iMode) +'|' ;                    +String(cx -xho -cxho) +'|' ;                        +String(cyho) +'|')
53394>>>>>>>        End
53394>>>>>>>>
53394>>>>>>>        Else If iMode eq smTopLeft Begin
53397>>>>>>>                Set Value item (Item_Count(Current_Object)) To ;                    ( String(ho) +'|' +String(iMode) +'|' ;                    +String(cx -xho) +'|' ;                        +String(cy -yHo) +'|')
53398>>>>>>>        End
53398>>>>>>>>
53398>>>>>>>        Else If iMode eq smBottomLeft Begin
53401>>>>>>>                Set Value item (Item_Count(Current_Object)) To ;                    ( String(ho) +'|' +String(iMode) +'|' ;                    +String(cxho) +'|' ;                        +String(cy -yho -cyho) +'|')
53402>>>>>>>        End
53402>>>>>>>>
53402>>>>>>>
53402>>>>>>>    End_Procedure
53403>>>>>>>
53403>>>>>>>    Procedure DoResize
53405>>>>>>>        Local Integer iLoop icItem iPos iMode ho x y cxy cx cy xy
53405>>>>>>>        Local String sItem
53405>>>>>>>        Get Item_Count To icItem
53406>>>>>>>        Delegate Get Size To cxy
53408>>>>>>>        Move (Hi(cxy)) To cy
53409>>>>>>>        Move (Low(cxy)) To cx
53410>>>>>>>        For iLoop From 0 To (icItem -1)
53416>>>>>>>>
53416>>>>>>>            Get Value item iLoop To sItem
53417>>>>>>>            Pos '|' In sItem To iPos
53419>>>>>>>>
53419>>>>>>>            Left sItem To ho (iPos -1)
53421>>>>>>>>
53421>>>>>>>            Right sItem To sItem (Length(sItem) -iPos)
53423>>>>>>>>
53423>>>>>>>            Get Location of ho To xy
53424>>>>>>>
53424>>>>>>>            Pos '|' In sItem To iPos
53426>>>>>>>>
53426>>>>>>>            Left sItem To iMode (iPos -1)
53428>>>>>>>>
53428>>>>>>>
53428>>>>>>>
53428>>>>>>>            Right sItem To sItem (Length(sItem) -iPos)
53430>>>>>>>>
53430>>>>>>>
53430>>>>>>>            Pos '|' In sItem To iPos
53432>>>>>>>>
53432>>>>>>>            Left sItem To x (iPos -1)
53434>>>>>>>>
53434>>>>>>>            Right sItem To sItem (Length(sItem) -iPos)
53436>>>>>>>>
53436>>>>>>>
53436>>>>>>>            Pos '|' In sItem To iPos
53438>>>>>>>>
53438>>>>>>>            Left sItem To y (iPos -1)
53440>>>>>>>>
53440>>>>>>>            Right sItem To sItem (Length(sItem) -iPos)
53442>>>>>>>>
53442>>>>>>>
53442>>>>>>>            If iMode eq smBottomRight ;                Set Size of ho To (cy -y -Hi(xy)) (cx -x -Low(xy))
53445>>>>>>>            If iMode eq smTopRight ;                Set Size of ho To y (cx -x -Low(xy))
53448>>>>>>>            If iMode eq smTopLeft ;                Set Size of ho To (cy -Hi(xy)) (cx -Low(xy))
53451>>>>>>>            If iMode eq smBottomLeft ;                Set Size of ho To (cy -y -Hi(xy)) x
53454>>>>>>>
53454>>>>>>>
53454>>>>>>>        Loop
53455>>>>>>>>
53455>>>>>>>    End_Procedure
53456>>>>>>>
53456>>>>>>>End_Class
53457>>>>>>>
53457>>>>>>>
53457>>>>>>>//cSize_mx.pkg (Continued)
53457>>>>>>>
53457>>>>>>>Class cSize_mx Is A Mixin
53458>>>>>>>    Procedure Define_cSize_mx
53460>>>>>>>        Forward Send Construct_Object
53462>>>>>>>
53462>>>>>>>        Object oAlignModes Is A cAlignModes
53464>>>>>>>        End_Object
53465>>>>>>>        Object oSizeModes Is A cSizeModes
53467>>>>>>>        End_Object
53468>>>>>>>
53468>>>>>>>    End_Procedure
53469>>>>>>>
53469>>>>>>>    Procedure DoRegAlign Integer ho Integer iMode
53471>>>>>>>        Send DoAdd To (oAlignModes(Current_Object)) ho iMode
53472>>>>>>>    End_Procedure
53473>>>>>>>
53473>>>>>>>    Procedure DoRegSize Integer ho Integer iMode
53475>>>>>>>        Send DoAdd To (oSizeModes(Current_Object)) ho iMode
53476>>>>>>>    End_Procedure
53477>>>>>>>
53477>>>>>>>    Procedure OnResize
53479>>>>>>>        Forward Send OnResize
53481>>>>>>>        Send DoResize To (oAlignModes(Current_Object))
53482>>>>>>>        Send DoResize To (oSizeModes(Current_Object))
53483>>>>>>>    End_Procedure
53484>>>>>>>
53484>>>>>>>End_Class
53485>>>>>>>
53485>>>>>
53485>>>>>Class DbviewSub Is A Dbview
53486>>>>>
53486>>>>>    Procedure Construct_Object
53488>>>>>        Forward Send Construct_Object
53490>>>>>        On_Key Key_F12 Send Request_Save_No_Clear
53491>>>>>        //Send Define_DisableAcceleratorKey_Mixin
53491>>>>>        Send Define_cSize_mx
53492>>>>>        Property Integer pbVerifyExitApplication True
53493>>>>>        Property Integer pidbViewID              0
53494>>>>>        Property String  psdbViewName            ''
53495>>>>>    End_Procedure //Construct_Object
53496>>>>>
53496>>>>>    Procedure End_Construct_Object
53498>>>>>        Forward Send End_Construct_Object
53500>>>>>        Local Integer   idbViewID
53500>>>>>        Local String    sdbViewName
53500>>>>>        Get Name           to sdbViewName
53501>>>>>        Set psdbViewName   to sdbViewName
53502>>>>>        Get Object_ID      to idbViewID
53503>>>>>        Set pidbViewID     to idbViewID
53504>>>>>
53504>>>>>
53504>>>>>
53504>>>>>    End_Procedure //Construct_Object
53505>>>>>
53505>>>>>
53505>>>>>
53505>>>>>    Procedure Page Integer PageMode
53507>>>>>        Integer hWnd
53507>>>>>        Forward Send Page PageMode
53509>>>>>        Get Window_Handle to hWnd
53510>>>>>        If (hWnd) Begin
53512>>>>>            Send GreekSysMenu
53513>>>>>        End
53513>>>>>>
53513>>>>>    End_Procedure
53514>>>>>
53514>>>>>    Function Verify_Exit_Application Returns Integer
53516>>>>>        Integer Fail bState
53516>>>>>
53516>>>>>        Get View_Changed to Fail // Ask for changes in Data-sets
53517>>>>>        Get pbVerifyExitApplication to bState
53518>>>>>        If (fail AND bState) ; // ok a change exist...activate changed view.            Get confirm ("“§á¨®¦¬¤ ˜¢¢˜šâª ©«¦ §˜¨áŸ¬¨¦ " + "'" + ;                        Label(Current_Object) + "'" + ;                        ".\n\n‡˜ œ¥â¢Ÿœ«œ ˜§æ «ž¤ œ­˜¨£¦šã;" ) to fail
53521>>>>>        Function_return (fail AND bState)
53522>>>>>    End_Function
53523>>>>>
53523>>>>>    //-------------------------------------------------------------------
53523>>>>>    // Change: Table entry checking - attempt to save header record
53523>>>>>    //         before entering a table (this is called by table. Return
53523>>>>>    //         a non-zero if the save failed (i.e., don't enter table)
53523>>>>>    //-------------------------------------------------------------------
53523>>>>>
53523>>>>>    Function Save_header returns integer
53525>>>>>        Local integer Rec Changed Srvr liSaveMsg
53525>>>>>        Get Server to Srvr                // The Header DDO.
53526>>>>>        If (Srvr) Begin
53528>>>>>            Get Current_Record of Srvr to Rec // The current order rec#.
53529>>>>>            Get Should_Save to Changed        // Are there any current changes?
53530>>>>>
53530>>>>>            // If there is no record and no changes we have an error.
53530>>>>>            //If (Rec=0 AND Changed=0) Begin // no rec
53530>>>>>            //    Error 300 'ƒž£ ¦ç¨šž©œ §¨é«˜ £å˜ ¡˜«žš¦¨å˜ ®˜¨˜¡«ž¨ ©« ¡¦ç \n\n¡˜  ç©«œ¨˜ ¡˜«˜®é¨ ©œ «˜ ®˜¨˜¡«ž¨ ©« ¡á!'
53530>>>>>            //    Function_Return 1
53530>>>>>            //End
53530>>>>>            Get Verify_Save_MSG to liSaveMsg         // the old confirmation
53531>>>>>            Set Verify_Save_MSG to GET_No_Confirmation // disable confirmation
53532>>>>>            If (Rec=0 AND Changed) Begin
53534>>>>>                // Attempt to Save the current Record
53534>>>>>                // request_save_no_clear does a save without clearing.
53534>>>>>                Send request_save_no_clear
53535>>>>>            End
53535>>>>>>
53535>>>>>            // The save succeeded if there are now no changes, and we
53535>>>>>            // have a saved record. Should_save tells us if we've got changes.
53535>>>>>            // We must check the data-sets current_record property to see if
53535>>>>>            // we have a record. If it is 0, we had no save.
53535>>>>>            Get Should_Save to Changed  // is a save still needed
53536>>>>>            Get Current_record of Srvr to Rec // current record of the DD
53537>>>>>            // if no record or changes still exist, return an error code of 1
53537>>>>>            Set Verify_Save_MSG to liSaveMsg         // restore old confirm
53538>>>>>        End
53538>>>>>>
53538>>>>>        If (Rec=0) ;            Function_return 1
53541>>>>>    end_function
53542>>>>>
53542>>>>>//    Procedure Close_Panel
53542>>>>>//        Local Integer liScope
53542>>>>>//        Move (Prior_Scope(Desktop)) To liScope
53542>>>>>//        Move (Scope_Focus(liScope)) To liScope
53542>>>>>//        Forward Send Close_Panel
53542>>>>>//        Send Activate To liScope
53542>>>>>//    End_Procedure // Close_Panel
53542>>>>>
53542>>>>>//    Procedure RefreshView
53542>>>>>//        Integer iChanged
53542>>>>>//        // Do not refresh the view if unsaved changes have been made.
53542>>>>>//        Broadcast Recursive Get Data_Set_Should_Save to iChanged
53542>>>>>//        If iChanged Procedure_Return
53542>>>>>//        // pInRefreshView and pAlreadyRefreshed are for optimization.
53542>>>>>//        // Without these properties, Refresh_Page may be sent as part of the Request_Assign
53542>>>>>//        // of a grid's Parent DD, and then in the Broadcast of Refresh_Current_Page.
53542>>>>>//        // Set pInRefreshView True first, and then False at the end so that this optimization
53542>>>>>//        // does not effect any other occurences of Refresh_Page.
53542>>>>>//        Broadcast Recursive Set pInRefreshView      to True
53542>>>>>//        Broadcast Recursive Set pAlreadyRefreshed   to False
53542>>>>>//        // Restore the record for the top row of any grid in the view.
53542>>>>>//        // This stops a grid for a child file from jumping to the top of the list when DDRefresh is sent to the parent DDO.
53542>>>>>//        Broadcast Recursive Send RestoreTopRecord
53542>>>>>//        Broadcast Recursive Send DDRefresh              // Sent to all child DDs to redisplay the current record, clearing if not found.
53542>>>>>//        // Refresh_Current_Page is really only needed for the case that the current record of a grid has been
53542>>>>>//        // deleted.  In that case, the DDRefresh has cleared a row and moved the deleted record down, so the grid
53542>>>>>//        // has to be refreshed again.
53542>>>>>//        Broadcast Recursive Send Refresh_Current_Page   // Sent to all dbGrids to refresh the entire grid without changing the top record.
53542>>>>>//        Broadcast Recursive Set pInRefreshView      to False
53542>>>>>//        Broadcast Recursive Set pAlreadyRefreshed   to False
53542>>>>>//    End_Procedure
53542>>>>>
53542>>>>>//    // Refresh the view during Entering_Scope
53542>>>>>//    Procedure Entering_Scope
53542>>>>>//        Send RefreshView
53542>>>>>//        Forward Send Entering_Scope
53542>>>>>//    End_Procedure
53542>>>>>
53542>>>>>
53542>>>>>    Import_Class_Protocol DisableAcceleratorKey_Mixin
53543>>>>>    Import_Class_Protocol cSize_mx
53544>>>>>
53544>>>>>End_Class //dbviewSub
53545>>>
53545>>>//AB/ Project Data Entry View
53545>>>//AB/ Object prj is a View_Project
53545>>>//AB/     Set Size to 230 325
53545>>>
53545>>>//Open SYSCURXR
53545>>>//Open COMPANY
53545>>>
53545>>>Use File_dlg.pkg
53545>>>Use cComDPDLG.pkg
Including file: cComDPDlg.pkg    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\cComDPDlg.pkg)
53545>>>>>// Visual DataFlex COM proxy classes generated from C:\WINNT\system32\DPDlg.ocx
53545>>>>>Use FlexCom20.pkg
53545>>>>>
53545>>>>>
53545>>>>>Define OLEROOTSHORT for Integer
53545>>>>>    // Desktop
53545>>>>>    Define OLEdpdDesktop for 0
53545>>>>>    // Control Panel
53545>>>>>    Define OLEdpdControlPanel for 1
53545>>>>>    // Desktop Directory
53545>>>>>    Define OLEdpdDesktopDir for 2
53545>>>>>    // My Computer
53545>>>>>    Define OLEdpdMyComputer for 3
53545>>>>>    // Font Directory
53545>>>>>    Define OLEdpdFontDir for 4
53545>>>>>    // Network Neighborhood
53545>>>>>    Define OLEdpdNetwork for 5
53545>>>>>    // Printers
53545>>>>>    Define OLEdpdPrinters for 6
53545>>>>>    // Programs
53545>>>>>    Define OLEdpdPrograms for 7
53545>>>>>    // Recent
53545>>>>>    Define OLEdpdRecent for 8
53545>>>>>    // Recycle Bin
53545>>>>>    Define OLEdpdRecycleBin for 9
53545>>>>>    // Send To
53545>>>>>    Define OLEdpdSendTo for 10
53545>>>>>    // Start Menu
53545>>>>>    Define OLEdpdStartMenu for 11
53545>>>>>    // Start Up
53545>>>>>    Define OLEdpdStartUp for 12
53545>>>>>    // Templates
53545>>>>>    Define OLEdpdTemplates for 13
53545>>>>>    // Custom Root
53545>>>>>    Define OLEdpdCustom for 14
53545>>>>>
53545>>>>>// CLSID: {BE5AB244-F888-11D0-9F5E-B42103C10710}
53545>>>>>// Dispatch interface for DPDlg Control
53545>>>>>Class cCom_DDPDlg is a Mixin
53546>>>>>
53546>>>>>    Function ComBrowseForComputer Returns Boolean
53548>>>>>        Boolean retVal
53548>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BOOL to retVal
53549>>>>>        Function_Return retVal
53550>>>>>    End_Function
53551>>>>>
53551>>>>>    Procedure Set ComBrowseForComputer Boolean value
53553>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BOOL to value
53554>>>>>    End_Procedure
53555>>>>>
53555>>>>>    Function ComBrowseForPrinter Returns Boolean
53557>>>>>        Boolean retVal
53557>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BOOL to retVal
53558>>>>>        Function_Return retVal
53559>>>>>    End_Function
53560>>>>>
53560>>>>>    Procedure Set ComBrowseForPrinter Boolean value
53562>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BOOL to value
53563>>>>>    End_Procedure
53564>>>>>
53564>>>>>    Function ComDontGoBelowDomain Returns Boolean
53566>>>>>        Boolean retVal
53566>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to retVal
53567>>>>>        Function_Return retVal
53568>>>>>    End_Function
53569>>>>>
53569>>>>>    Procedure Set ComDontGoBelowDomain Boolean value
53571>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to value
53572>>>>>    End_Procedure
53573>>>>>
53573>>>>>    Function ComReturnFSAncestors Returns Boolean
53575>>>>>        Boolean retVal
53575>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to retVal
53576>>>>>        Function_Return retVal
53577>>>>>    End_Function
53578>>>>>
53578>>>>>    Procedure Set ComReturnFSAncestors Boolean value
53580>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to value
53581>>>>>    End_Procedure
53582>>>>>
53582>>>>>    Function ComReturnOnlyFSDirs Returns Boolean
53584>>>>>        Boolean retVal
53584>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BOOL to retVal
53585>>>>>        Function_Return retVal
53586>>>>>    End_Function
53587>>>>>
53587>>>>>    Procedure Set ComReturnOnlyFSDirs Boolean value
53589>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BOOL to value
53590>>>>>    End_Procedure
53591>>>>>
53591>>>>>    Function ComRoot Returns OLEROOTSHORT
53593>>>>>        OLEROOTSHORT retVal
53593>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
53594>>>>>        Function_Return retVal
53595>>>>>    End_Function
53596>>>>>
53596>>>>>    Procedure Set ComRoot OLEROOTSHORT value
53598>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
53599>>>>>    End_Procedure
53600>>>>>
53600>>>>>    Function ComHWnd Returns OLE_HANDLE
53602>>>>>        OLE_HANDLE retVal
53602>>>>>        Get ComProperty of (phDispatchDriver(Self)) -515 OLE_VT_I4 to retVal
53603>>>>>        Function_Return retVal
53604>>>>>    End_Function
53605>>>>>
53605>>>>>    Procedure Set ComHWnd OLE_HANDLE value
53607>>>>>        Set ComProperty of (phDispatchDriver(Self)) -515 OLE_VT_I4 to value
53608>>>>>    End_Procedure
53609>>>>>
53609>>>>>    Function ComIcon Returns Variant
53611>>>>>        Variant retVal
53611>>>>>        Get ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_DISPATCH to retVal
53612>>>>>        Function_Return retVal
53613>>>>>    End_Function
53614>>>>>
53614>>>>>    Procedure Set ComIcon Variant value
53616>>>>>        Set ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_DISPATCH to value
53617>>>>>    End_Procedure
53618>>>>>
53618>>>>>    Function ComFolder Returns String
53620>>>>>        String retVal
53620>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to retVal
53621>>>>>        Function_Return retVal
53622>>>>>    End_Function
53623>>>>>
53623>>>>>    Procedure Set ComFolder String value
53625>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to value
53626>>>>>    End_Procedure
53627>>>>>
53627>>>>>    Function ComCaption Returns String
53629>>>>>        String retVal
53629>>>>>        Get ComProperty of (phDispatchDriver(Self)) -518 OLE_VT_BSTR to retVal
53630>>>>>        Function_Return retVal
53631>>>>>    End_Function
53632>>>>>
53632>>>>>    Procedure Set ComCaption String value
53634>>>>>        Set ComProperty of (phDispatchDriver(Self)) -518 OLE_VT_BSTR to value
53635>>>>>    End_Procedure
53636>>>>>
53636>>>>>    Function Com_Caption Returns String
53638>>>>>        String retVal
53638>>>>>        Get ComProperty of (phDispatchDriver(Self)) 0 OLE_VT_BSTR to retVal
53639>>>>>        Function_Return retVal
53640>>>>>    End_Function
53641>>>>>
53641>>>>>    Procedure Set Com_Caption String value
53643>>>>>        Set ComProperty of (phDispatchDriver(Self)) 0 OLE_VT_BSTR to value
53644>>>>>    End_Procedure
53645>>>>>
53645>>>>>    Function ComPath Returns String
53647>>>>>        String retVal
53647>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to retVal
53648>>>>>        Function_Return retVal
53649>>>>>    End_Function
53650>>>>>
53650>>>>>    Procedure Set ComPath String value
53652>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to value
53653>>>>>    End_Procedure
53654>>>>>
53654>>>>>    Function ComCustomRoot Returns String
53656>>>>>        String retVal
53656>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to retVal
53657>>>>>        Function_Return retVal
53658>>>>>    End_Function
53659>>>>>
53659>>>>>    Procedure Set ComCustomRoot String value
53661>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to value
53662>>>>>    End_Procedure
53663>>>>>
53663>>>>>    Function ComShow Returns Boolean
53665>>>>>        Handle hDispatchDriver
53665>>>>>        Boolean retVal
53665>>>>>        Get phDispatchDriver to hDispatchDriver
53666>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_BOOL to retVal
53667>>>>>        Function_Return retVal
53668>>>>>    End_Function
53669>>>>>
53669>>>>>    Procedure ComAboutBox
53671>>>>>        Handle hDispatchDriver
53671>>>>>        Get phDispatchDriver to hDispatchDriver
53672>>>>>        Send InvokeComMethod to hDispatchDriver -552 OLE_VT_VOID
53673>>>>>    End_Procedure
53674>>>>>End_Class
53675>>>>>
53675>>>>>// CLSID: {BE5AB245-F888-11D0-9F5E-B42103C10710}
53675>>>>>// Event interface for DPDlg Control
53675>>>>>Class cCom_DDPDlgEvents is a Mixin
53676>>>>>
53676>>>>>    Procedure OnComFolderSelected String llPath Boolean ByRef llAllow
53678>>>>>    End_Procedure
53679>>>>>
53679>>>>>    Procedure RegisterComEvents
53681>>>>>        Send RegisterComEvent 1 msg_OnComFolderSelected
53682>>>>>    End_Procedure
53683>>>>>End_Class
53684>>>>>
53684>>>>>// CoClass
53684>>>>>// ProgID: DPDLG.DPDlgCtrl.1
53684>>>>>// CLSID: {BE5AB246-F888-11D0-9F5E-B42103C10710}
53684>>>>>// DPDlg Control
53684>>>>>Class cComDPDlg is a cComActiveXControl
53685>>>>>    Import_Class_Protocol cCom_DDPDlg
53686>>>>>    Import_Class_Protocol cCom_DDPDlgEvents
53687>>>>>
53687>>>>>    Procedure Construct_Object
53689>>>>>        Forward Send Construct_Object
53691>>>>>        Set psProgID to "{BE5AB246-F888-11D0-9F5E-B42103C10710}"
53692>>>>>        Set psEventId to "{BE5AB245-F888-11D0-9F5E-B42103C10710}"
53693>>>>>        Set peAutoCreate to acAutoCreate
53694>>>>>    End_Procedure
53695>>>>>End_Class
53696>>>Use cComXFIND.pkg
Including file: cComXfind.pkg    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\cComXfind.pkg)
53696>>>>>// Visual DataFlex COM proxy classes generated from C:\WINNT\system32\xfind10DEMO.ocx
53696>>>>>Use FlexCom20.pkg
53696>>>>>
53696>>>>>
53696>>>>>// CLSID: {DF5A0221-37A0-11D4-881C-E7F891A83074}
53696>>>>>// Dispatch interface for xfind Control
53696>>>>>Class cComIxfind is a Mixin
53697>>>>>
53697>>>>>    Procedure ComAboutBox
53699>>>>>        Handle hDispatchDriver
53699>>>>>        Get phDispatchDriver to hDispatchDriver
53700>>>>>        Send InvokeComMethod to hDispatchDriver -552 OLE_VT_VOID
53701>>>>>    End_Procedure
53702>>>>>
53702>>>>>    Function ComSearchString Returns String
53704>>>>>        Handle hDispatchDriver
53704>>>>>        String retVal
53704>>>>>        Get phDispatchDriver to hDispatchDriver
53705>>>>>        Get InvokeComMethod of hDispatchDriver 6 OLE_VT_BSTR to retVal
53706>>>>>        Function_Return retVal
53707>>>>>    End_Function
53708>>>>>
53708>>>>>    Procedure Set ComSearchString String value
53710>>>>>        Handle hDispatchDriver
53710>>>>>        Get phDispatchDriver to hDispatchDriver
53711>>>>>        Send PrepareParams to hDispatchDriver 1
53712>>>>>        Set ComProperty of hDispatchDriver 6 OLE_VT_BSTR to value
53713>>>>>    End_Procedure
53714>>>>>
53714>>>>>    Function ComSearchFrom Returns String
53716>>>>>        Handle hDispatchDriver
53716>>>>>        String retVal
53716>>>>>        Get phDispatchDriver to hDispatchDriver
53717>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_BSTR to retVal
53718>>>>>        Function_Return retVal
53719>>>>>    End_Function
53720>>>>>
53720>>>>>    Procedure Set ComSearchFrom String value
53722>>>>>        Handle hDispatchDriver
53722>>>>>        Get phDispatchDriver to hDispatchDriver
53723>>>>>        Send PrepareParams to hDispatchDriver 1
53724>>>>>        Set ComProperty of hDispatchDriver 7 OLE_VT_BSTR to value
53725>>>>>    End_Procedure
53726>>>>>
53726>>>>>    Function ComSearchSubDirs Returns Boolean
53728>>>>>        Handle hDispatchDriver
53728>>>>>        Boolean retVal
53728>>>>>        Get phDispatchDriver to hDispatchDriver
53729>>>>>        Get InvokeComMethod of hDispatchDriver 8 OLE_VT_BOOL to retVal
53730>>>>>        Function_Return retVal
53731>>>>>    End_Function
53732>>>>>
53732>>>>>    Procedure Set ComSearchSubDirs Boolean value
53734>>>>>        Handle hDispatchDriver
53734>>>>>        Get phDispatchDriver to hDispatchDriver
53735>>>>>        Send PrepareParams to hDispatchDriver 1
53736>>>>>        Set ComProperty of hDispatchDriver 8 OLE_VT_BOOL to value
53737>>>>>    End_Procedure
53738>>>>>
53738>>>>>    Procedure ComStartSearching
53740>>>>>        Handle hDispatchDriver
53740>>>>>        Get phDispatchDriver to hDispatchDriver
53741>>>>>        Send InvokeComMethod to hDispatchDriver 2 OLE_VT_VOID
53742>>>>>    End_Procedure
53743>>>>>
53743>>>>>    Function ComIsSearching Returns Boolean
53745>>>>>        Handle hDispatchDriver
53745>>>>>        Boolean retVal
53745>>>>>        Get phDispatchDriver to hDispatchDriver
53746>>>>>        Get InvokeComMethod of hDispatchDriver 5 OLE_VT_BOOL to retVal
53747>>>>>        Function_Return retVal
53748>>>>>    End_Function
53749>>>>>
53749>>>>>    Procedure ComAbortSearch
53751>>>>>        Handle hDispatchDriver
53751>>>>>        Get phDispatchDriver to hDispatchDriver
53752>>>>>        Send InvokeComMethod to hDispatchDriver 9 OLE_VT_VOID
53753>>>>>    End_Procedure
53754>>>>>
53754>>>>>    Function ComFileName Returns String
53756>>>>>        Handle hDispatchDriver
53756>>>>>        String retVal
53756>>>>>        Get phDispatchDriver to hDispatchDriver
53757>>>>>        Get InvokeComMethod of hDispatchDriver 3 OLE_VT_BSTR to retVal
53758>>>>>        Function_Return retVal
53759>>>>>    End_Function
53760>>>>>
53760>>>>>    Function ComFileSize Returns Integer
53762>>>>>        Handle hDispatchDriver
53762>>>>>        Integer retVal
53762>>>>>        Get phDispatchDriver to hDispatchDriver
53763>>>>>        Get InvokeComMethod of hDispatchDriver 4 OLE_VT_I4 to retVal
53764>>>>>        Function_Return retVal
53765>>>>>    End_Function
53766>>>>>End_Class
53767>>>>>
53767>>>>>// CLSID: {DF5A0223-37A0-11D4-881C-E7F891A83074}
53767>>>>>// Events interface for xfind Control
53767>>>>>Class cComIxfindEvents is a Mixin
53768>>>>>
53768>>>>>    Procedure OnComFinishedSearch
53770>>>>>    End_Procedure
53771>>>>>
53771>>>>>    Procedure OnComFoundFile
53773>>>>>    End_Procedure
53774>>>>>
53774>>>>>    Procedure RegisterComEvents
53776>>>>>        Send RegisterComEvent 4 msg_OnComFinishedSearch
53777>>>>>        Send RegisterComEvent 8 msg_OnComFoundFile
53778>>>>>    End_Procedure
53779>>>>>End_Class
53780>>>>>
53780>>>>>// CoClass
53780>>>>>// ProgID: xfind10.xfind
53780>>>>>// CLSID: {DF5A0225-37A0-11D4-881C-E7F891A83074}
53780>>>>>// xfind Control
53780>>>>>Class cComXfind is a cComActiveXControl
53781>>>>>    Import_Class_Protocol cComIxfind
53782>>>>>    Import_Class_Protocol cComIxfindEvents
53783>>>>>
53783>>>>>    Procedure Construct_Object
53785>>>>>        Forward Send Construct_Object
53787>>>>>        Set psProgID to "{DF5A0225-37A0-11D4-881C-E7F891A83074}"
53788>>>>>        Set psEventId to "{DF5A0223-37A0-11D4-881C-E7F891A83074}"
53789>>>>>        Set peAutoCreate to acAutoCreate
53790>>>>>    End_Procedure
53791>>>>>End_Class
53792>>>Use BUTTON.Sub
Including file: BUTTON.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\BUTTON.SUB)
53792>>>>>
53792>>>>>Use Tooltip.pkg
Including file: TOOLTIP.PKG    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\TOOLTIP.PKG)
53792>>>>>>>
53792>>>>>>>Use dfclient
53792>>>>>>>Use dfallent
53792>>>>>>>Use WINUSREZ.PKG
53792>>>>>>>
53792>>>>>>>//========================================================================================
53792>>>>>>>//  DNS Technology
53792>>>>>>>//
53792>>>>>>>//  FileName     : TOOLTIP.PKG
53792>>>>>>>//  Author       : S G Munn    (sgmunn@compuserve.com)
53792>>>>>>>//  Date Created : 01/10/1997
53792>>>>>>>//  Version      : 1.0
53792>>>>>>>//
53792>>>>>>>//  Purpose      : Tooltip controller
53792>>>>>>>//========================================================================================
53792>>>>>>>//  Parameters   : none
53792>>>>>>>//               :
53792>>>>>>>//  Interface    :
53792>>>>>>>//               :
53792>>>>>>>//========================================================================================
53792>>>>>>>//  Usage        : Use tooltip.000 just before the end_object statement of the 'main'
53792>>>>>>>//               : object.
53792>>>>>>>//               :
53792>>>>>>>//               : Also, I have had problems with timers if the dftimer package is used
53792>>>>>>>//               : inside the 'main' object.  I use dftimer outside main (just after the
53792>>>>>>>//               : 'use dfallent'). (Fixed - SPY 15/11/98)
53792>>>>>>>//               :
53792>>>>>>>//               :
53792>>>>>>>//               :
53792>>>>>>>//               :
53792>>>>>>>//               :   use tooltip.PKG //Not neccesery anymore with the EZ classes 15/11/98 - SPY
53792>>>>>>>//               : end_object // main
53792>>>>>>>//               :
53792>>>>>>>//               : for any object you want a tool tip for, define the following in the
53792>>>>>>>//               : object (or class definition)
53792>>>>>>>//               :
53792>>>>>>>//               : function TooltipHint returns string
53792>>>>>>>//               :     function_return "tool tip string" // or property, or expression etc.
53792>>>>>>>//               : end_function
53792>>>>>>>//               :
53792>>>>>>>//               : <Optional>
53792>>>>>>>//               : function TooltipHintObject returns integer
53792>>>>>>>//               :     function_return Object_ID_Of_Alternate_Tool_Tip_Object
53792>>>>>>>//               : end_function
53792>>>>>>>//               :
53792>>>>>>>//========================================================================================
53792>>>>>>>//  History      :
53792>>>>>>>//    Task Id    : none
53792>>>>>>>//    Author     : SGM
53792>>>>>>>//    Date       : 21/10/1997
53792>>>>>>>//    Comments   : Added ability for tool tip timer to 'see' the window handle of objects
53792>>>>>>>//               : within a modal panel.
53792>>>>>>>//               :
53792>>>>>>>//    Task Id    : none
53792>>>>>>>//    Author     : SGM
53792>>>>>>>//    Date       : 15/12/1997
53792>>>>>>>//    Comments   : Fixed bug with getting size and location of panel (it was offset by the
53792>>>>>>>//               : panel's caption bar).
53792>>>>>>>//               : Removed function requirement to test if object should show a tool tip -
53792>>>>>>>//               : return a null tool tip string for no tool tip.
53792>>>>>>>//               : Added ability for object to specify a different tool tip object other
53792>>>>>>>//               : than the default 'windows like' tool tip.
53792>>>>>>>//               : The parent object of this PKG does not have to 'main'.  But the PKG
53792>>>>>>>//               : should still be used at the end of the object.
53792>>>>>>>//               : Uses PlusPak!'s cTimer class.  This can be changed to use DFTimer
53792>>>>>>>//               : by changing the compiler directive TOOLTIP_USE_PLUSPAK_CTIMER to NO
53792>>>>>>>//               :
53792>>>>>>>//               :
53792>>>>>>>//    Task Id    : none
53792>>>>>>>//    Author     : SGM
53792>>>>>>>//    Date       : 15/06/1998
53792>>>>>>>//    Comments   : Changed name type POINT to TOOLTIP_POINT to avoid compile problemns
53792>>>>>>>//               : with pkg's that define a point type as well.
53792>>>>>>>//               :
53792>>>>>>>//    Task Id    : none
53792>>>>>>>//    Author     : SPY
53792>>>>>>>//    Date       : 15/11/98
53792>>>>>>>//               : Fixed bug with DFTimer Manager Handler Error (Now Use DfTimer is inside
53792>>>>>>>//               : a message Object
53792>>>>>>>//               :
53792>>>>>>>//    Task Id    : none
53792>>>>>>>//    Author     : SPY
53792>>>>>>>//    Date       : 15/11/98
53792>>>>>>>//               : The Objects StandardToolTip and TooltipTimer now are in Tooltip.inc File
53792>>>>>>>//               : that is being included in the End_Construct_Object of the dbView_EZ Class
53792>>>>>>>//               : This Must Be changed
53792>>>>>>>//               :
53792>>>>>>>//               :
53792>>>>>>>//               :
53792>>>>>>>//               : TODO.
53792>>>>>>>//               : 1. Remove tool tip when mouse is clicked.
53792>>>>>>>//               : 2. Allow the 'use tooltip.000' to be anywhere.
53792>>>>>>>//               :
53792>>>>>>>//               :
53792>>>>>>>//               :
53792>>>>>>>//               :
53792>>>>>>>//               :
53792>>>>>>>//               :
53792>>>>>>>//               :
53792>>>>>>>//========================================================================================
53792>>>>>>>use Windows
53792>>>>>>>Use Txtbox.Sub
Including file: TXTBOX.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\TXTBOX.SUB)
53792>>>>>>>>>Use Tooltip.pkg
53792>>>>>>>>>//Use AccKeymx.ezc
53792>>>>>>>>>
53792>>>>>>>>>Class TextboxSub Is A Textbox
53793>>>>>>>>>
53793>>>>>>>>>    Procedure Construct_Object
53795>>>>>>>>>        Forward Send Construct_Object
53797>>>>>>>>>        Property String TooltipValue Public ""
53798>>>>>>>>>        //Send Define_DisableAcceleratorKey_Mixin
53798>>>>>>>>>    End_Procedure
53799>>>>>>>>>
53799>>>>>>>>>    Procedure End_Construct_Object
53801>>>>>>>>>        Forward Send End_Construct_Object
53803>>>>>>>>>    End_Procedure //Construct_Object
53804>>>>>>>>>
53804>>>>>>>>>    Function TooltipHint returns string
53806>>>>>>>>>        Function_Return (TooltipValue(Self))
53807>>>>>>>>>    End_function
53808>>>>>>>>>
53808>>>>>>>>>    //Import_Class_Protocol DisableAcceleratorKey_Mixin
53808>>>>>>>>>
53808>>>>>>>>>End_Class //TextboxSub
53809>>>>>>>>>
53809>>>>>>>
53809>>>>>>>Object Default_Timer is a Message
53811>>>>>>>    use DFTimer        // DF Timer class
Including file: Dftimer.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\Dftimer.pkg)
53811>>>>>>>>>//************************************************************************
53811>>>>>>>>>//--- DFTimer   Timer package for DataFlex programs
53811>>>>>>>>>//
53811>>>>>>>>>// Copyright (c) 1983-2002 Data Access Corporation, Miami Florida,
53811>>>>>>>>>// All rights reserved.
53811>>>>>>>>>// DataFlex is a registered trademark of Data Access Corporation.
53811>>>>>>>>>//
53811>>>>>>>>>//************************************************************************
53811>>>>>>>>>//  Description:
53811>>>>>>>>>//      This package contains all components needed to implement timers
53811>>>>>>>>>//      in a DataFlex 4 program.
53811>>>>>>>>>//
53811>>>>>>>>>//
53811>>>>>>>>>//  Author: Eddy Kleinjan, Data Access Nederland
53811>>>>>>>>>//************************************************************************
53811>>>>>>>>>// 03/03/2001 EK  Fixed Timer_Active_State to check for valid windows
53811>>>>>>>>>//                handle before trying to set or kill a timer.
53811>>>>>>>>>//                Fixed Kill_All_Timers to check for valid windows
53811>>>>>>>>>//                handle before trying to kill a timer.
53811>>>>>>>>>//                The windows handle might not exist anymore when the
53811>>>>>>>>>//                program is being exited using Exit_Application.
53811>>>>>>>>>// 12/13/2001 JJT fixed Timer_Active_State to check for -1 (not 0). Fixed a
53811>>>>>>>>>//                a bug where set Timeout started inactive timers.
53811>>>>>>>>>//                Added code to force timer object to desktop
53811>>>>>>>>>//************************************************************************
53811>>>>>>>>>// CLASS DFTimer
53811>>>>>>>>>//
53811>>>>>>>>>// Usage:
53811>>>>>>>>>//    Object MyTimer is a DFTimer
53811>>>>>>>>>//
53811>>>>>>>>>//        Set Timeout to 2000                             // Default 1000
53811>>>>>>>>>//        Set Auto_Start_State to TRUE|FALSE              // Default TRUE
53811>>>>>>>>>//        Set Auto_Stop_State to TRUE|FALSE               // Default TRUE
53811>>>>>>>>>//        Set Timer_Message to MyMessage                  // Default 0
53811>>>>>>>>>//        Set Timer_Object to (MyObject(self))            // Default 0
53811>>>>>>>>>//        Set Timer_Active_State to TRUE|FALSE            // Default FALSE
53811>>>>>>>>>//
53811>>>>>>>>>//        // Augment when no Timer_Message
53811>>>>>>>>>//        Procedure OnTimer
53811>>>>>>>>>//            Send Info_Box "HEY, WAKE UP!"
53811>>>>>>>>>//        End_Procedure
53811>>>>>>>>>//
53811>>>>>>>>>//    End_Object
53811>>>>>>>>>//
53811>>>>>>>>>// DESCRIPTION
53811>>>>>>>>>//      Objects of this class can be used to trigger an event after a
53811>>>>>>>>>//      certain amount of time has passed. You can specify this time
53811>>>>>>>>>//      by setting the Timeout property of the object. This timeout
53811>>>>>>>>>//      is in miliseconds.
53811>>>>>>>>>//
53811>>>>>>>>>//      Whenever a timer event happens, it will notify the object by
53811>>>>>>>>>//      sending an OnTimer event. You can trap this event to do whatever
53811>>>>>>>>>//      you want the timer to do. By default this OnTimer event
53811>>>>>>>>>//      will send the Timer_Message to Timer_Object, when these have
53811>>>>>>>>>//      been specified.
53811>>>>>>>>>//
53811>>>>>>>>>//      By default, you have to activate a timer by setting its
53811>>>>>>>>>//      Timer_Active_State to TRUE. When the timer has been placed
53811>>>>>>>>>//      inside a user-interface object, it can also be activated
53811>>>>>>>>>//      automatically when this user-interface object is being
53811>>>>>>>>>//      activated. This only happes when it Auto_Start_State is TRUE,
53811>>>>>>>>>//      which is the default setting. In such a case, the timer will
53811>>>>>>>>>//      also automatically being stopped when the user-interface
53811>>>>>>>>>//      object is taken of the screen. This depends on the
53811>>>>>>>>>//      Auto_Stop_Timer state to happen.
53811>>>>>>>>>//
53811>>>>>>>>>//      When you need to set a new timeout value, you can do so
53811>>>>>>>>>//      even when the timer is active. It will adjust the timeout
53811>>>>>>>>>//      immediately.
53811>>>>>>>>>//
53811>>>>>>>>>//      Note that timer events depend on Windows for the delivery of
53811>>>>>>>>>//      the event. Since timer events get a low priority in Windows,
53811>>>>>>>>>//      it might put your program on hold when other programs are very
53811>>>>>>>>>//      busy. In such a case, you will only receive one timer event
53811>>>>>>>>>//      after the process stopped. There is no way, other than
53811>>>>>>>>>//      calculating it yourself, to determine how many time has passed
53811>>>>>>>>>//      or how many timer event should have happened since the last
53811>>>>>>>>>//      timer event or timer activation.
53811>>>>>>>>>//
53811>>>>>>>>>// PUBLIC INTERFACE
53811>>>>>>>>>//
53811>>>>>>>>>//    PROPERTIES
53811>>>>>>>>>//
53811>>>>>>>>>//    Auto_Start_State When TRUE (default) the timer will be activated
53811>>>>>>>>>//                     automatically when the object will be (virtually)
53811>>>>>>>>>//                     paged on the screen.
53811>>>>>>>>>//                     Example: When a timer object has been placed
53811>>>>>>>>>//                     inside a view, then the timer will be activated
53811>>>>>>>>>//                     when the view is activated.
53811>>>>>>>>>//
53811>>>>>>>>>//    Auto_Stop_State  When TRUE (default) the timer will be deactivated
53811>>>>>>>>>//                     automatically when the object will be (virtually)
53811>>>>>>>>>//                     taken off the screen.
53811>>>>>>>>>//
53811>>>>>>>>>//    Timeout          The timeout value for the timer to fire. The
53811>>>>>>>>>//                     timeout value must be set in miliseconds.
53811>>>>>>>>>//                     This property may be set even when the timer is
53811>>>>>>>>>//                     active. The new timeout value will be applied
53811>>>>>>>>>//                     immediately.
53811>>>>>>>>>//                     NOTE: The timeout set here is never precise. It
53811>>>>>>>>>//                     depends on Windows to deliver the message to our
53811>>>>>>>>>//                     application.
53811>>>>>>>>>//                     Default 1000.
53811>>>>>>>>>//
53811>>>>>>>>>//    Timer_Active_State
53811>>>>>>>>>//                     Set to TRUE to activate the timer, to FALSE to
53811>>>>>>>>>//                     deactivate the timer.
53811>>>>>>>>>//
53811>>>>>>>>>//
53811>>>>>>>>>//    Timer_Message    This property can be set to a messageID which has
53811>>>>>>>>>//                     to be sent whenever a timer event occurs. Default
53811>>>>>>>>>//                     this message will be send to the object itself
53811>>>>>>>>>//                     unless a Timer_Object as been specified.
53811>>>>>>>>>//
53811>>>>>>>>>//    Timer_Object     This property can be set to an objectID which has
53811>>>>>>>>>//                     to receive the Timer_Message whenever a timer
53811>>>>>>>>>//                     event occurs. This value has no meaning when
53811>>>>>>>>>//                     no Timer_Message has been set.
53811>>>>>>>>>//
53811>>>>>>>>>//    METHODS
53811>>>>>>>>>//
53811>>>>>>>>>//    OnTimer          This event will happen whenever the specified
53811>>>>>>>>>//                     amount of time has passed and the timer is
53811>>>>>>>>>//                     active. By default it sends the message in
53811>>>>>>>>>//                     the Timer_Message property to the object in
53811>>>>>>>>>//                     the Timer_Object when these have been specified.
53811>>>>>>>>>//                     When you don't need this, you can just override
53811>>>>>>>>>//                     the OnTimer event.
53811>>>>>>>>>//
53811>>>>>>>>>// PUBLIC INTERFACE
53811>>>>>>>>>//
53811>>>>>>>>>//    Page_Object      Has been augmented to auto_start the timer when
53811>>>>>>>>>//                     it becomes active as part or a user-interface
53811>>>>>>>>>//                     object.
53811>>>>>>>>>//
53811>>>>>>>>>//    Page_Delete      Has been augmented to auto_stop the timer when
53811>>>>>>>>>//                     it is deactivated as part or a user-interface
53811>>>>>>>>>//                     object.
53811>>>>>>>>>//
53811>>>>>>>>>//    Destroy_Object   Has been augmented to deactivate the timer.
53811>>>>>>>>>//
53811>>>>>>>>>Use LanguageText.pkg
53811>>>>>>>>>Use Windows.pkg
53811>>>>>>>>>Use WinUser.pkg
53811>>>>>>>>>
53811>>>>>>>>>External_Function SetTimer "SetTimer" User32.DLL ;    Integer hWnd ;    Integer idTimer ;    Integer idTimeout ;    Pointer tmprc ;    Returns Integer
53812>>>>>>>>>
53812>>>>>>>>>External_Function KillTimer "KillTimer" User32.DLL ;    Integer hWnd ;    Integer idTimer ;    Returns Integer
53813>>>>>>>>>
53813>>>>>>>>>// This global integer holds the ID of the object
53813>>>>>>>>>// that manages all timers.
53813>>>>>>>>>Integer giTimerManager
53813>>>>>>>>>
53813>>>>>>>>>// This class is used to store the object IDs
53813>>>>>>>>>// of the active timer objects. It augments
53813>>>>>>>>>// the Destroy_Object procedure to notify
53813>>>>>>>>>// the DFTimerManager to kill all its active
53813>>>>>>>>>// timers.
53813>>>>>>>>>// NOTE: This class looks very much like the
53813>>>>>>>>>// Set class. I didn't want to use Set because
53813>>>>>>>>>// Remove_Element shifts items which I don't
53813>>>>>>>>>// want to happen because item numbers are used
53813>>>>>>>>>// as timerIDs.
53813>>>>>>>>>
53813>>>>>>>>>Class TimersArray is an Array
53814>>>>>>>>>
53814>>>>>>>>>    Function Find_Object Integer iObj Returns Integer
53816>>>>>>>>>        Integer iMax
53816>>>>>>>>>        Integer iItem
53816>>>>>>>>>        Integer iValue
53816>>>>>>>>>        Get Item_count to iMax
53817>>>>>>>>>        Decrement iMax
53818>>>>>>>>>        For iItem from 1 to iMax
53824>>>>>>>>>>
53824>>>>>>>>>            Get Integer_Value item iItem to iValue
53825>>>>>>>>>            If iValue EQ iObj;                Function_Return iItem
53828>>>>>>>>>        Loop
53829>>>>>>>>>>
53829>>>>>>>>>        Function_Return -1
53830>>>>>>>>>    End_Function
53831>>>>>>>>>
53831>>>>>>>>>    Procedure Add_Object Integer iObj Returns Integer
53833>>>>>>>>>        Integer iItem
53833>>>>>>>>>        Get Find_Object iObj to iItem
53834>>>>>>>>>        If iItem LT 0 Begin
53836>>>>>>>>>            Get Find_Object 0 to iItem
53837>>>>>>>>>            If iItem LT 0 ;                Get Item_Count to iItem
53840>>>>>>>>>        End
53840>>>>>>>>>>
53840>>>>>>>>>        Set Array_Value item iItem to iObj
53841>>>>>>>>>        Procedure_Return iItem
53842>>>>>>>>>    End_Procedure
53843>>>>>>>>>
53843>>>>>>>>>    Procedure Remove_Object Integer iObj
53845>>>>>>>>>        Integer iItem
53845>>>>>>>>>        Get Find_Object iObj to iItem
53846>>>>>>>>>        If iItem GT 0 ;            Set Array_Value item iItem to 0
53849>>>>>>>>>    End_Procedure
53850>>>>>>>>>
53850>>>>>>>>>    Procedure Destroy_Object
53852>>>>>>>>>        Delegate Send Kill_All_Timers
53854>>>>>>>>>        Forward Send Destroy_Object
53856>>>>>>>>>    End_Procedure
53857>>>>>>>>>
53857>>>>>>>>>End_Class // TimersArray
53858>>>>>>>>>
53858>>>>>>>>>// This class is the actual timer manager
53858>>>>>>>>>// A timer will be created when Message Set_Timer_Active_State
53858>>>>>>>>>// has been send. This message needs two arguments. The first
53858>>>>>>>>>// is the objectID of the object to receive the timer event,
53858>>>>>>>>>// and the second is state. The object which ID has been passed,
53858>>>>>>>>>// needs to have a Timeout property to return the timeout for the
53858>>>>>>>>>// timer and it also needs to handle the MSG_OnTimer whenever a
53858>>>>>>>>>// timer event occurs.
53858>>>>>>>>>// The objectID of the Object will be placed in an array which contains
53858>>>>>>>>>// the objectIDs of all active timers. The Windows timer ID of a timer
53858>>>>>>>>>// is the itemnumber of the object in the array.
53858>>>>>>>>>//
53858>>>>>>>>>Class DFTimerManager is a DfBaseControl
53859>>>>>>>>>
53859>>>>>>>>>    Procedure Construct_Object
53861>>>>>>>>>
53861>>>>>>>>>        Forward Send Construct_Object
53863>>>>>>>>>
53863>>>>>>>>>        Set Visible_State to FALSE
53864>>>>>>>>>
53864>>>>>>>>>        Set External_Class_Name "cVdfTimer" to "static"
53865>>>>>>>>>        Set External_Message WM_TIMER to OnTimer
53866>>>>>>>>>
53866>>>>>>>>>        Object TimersArray is a TimersArray
53868>>>>>>>>>            Set Array_Value item 0 to -9999 // So we don't use item 0
53869>>>>>>>>>        End_Object
53870>>>>>>>>>
53870>>>>>>>>>        Move self to giTimerManager
53871>>>>>>>>>
53871>>>>>>>>>    End_Procedure
53872>>>>>>>>>
53872>>>>>>>>>    Procedure Set Timer_Active_State Integer iObj Integer iState
53874>>>>>>>>>        Integer iTimerID
53874>>>>>>>>>        Integer iTimeout
53874>>>>>>>>>        Integer iResult
53874>>>>>>>>>        Integer iSet
53874>>>>>>>>>        Dword   nResult
53874>>>>>>>>>        Handle  hWnd
53874>>>>>>>>>
53874>>>>>>>>>        // Get the handle of this object
53874>>>>>>>>>        Get Window_Handle to hWnd
53875>>>>>>>>>        If (Not(hWnd)) Begin
53877>>>>>>>>>            Error DFERR_DFTIMER C_$TimerNoHandle
53878>>>>>>>>>>
53878>>>>>>>>>            Procedure_Return
53879>>>>>>>>>        End
53879>>>>>>>>>>
53879>>>>>>>>>
53879>>>>>>>>>        // Test if handle is valid. If not, we leave.
53879>>>>>>>>>        If (Not(IsWindow(hWnd))) ;            Procedure_Return
53882>>>>>>>>>
53882>>>>>>>>>        Move (TimersArray(self)) to iSet
53883>>>>>>>>>
53883>>>>>>>>>        If (iSet) Begin
53885>>>>>>>>>
53885>>>>>>>>>            // Let's create or modify a timer
53885>>>>>>>>>            If iState Begin
53887>>>>>>>>>
53887>>>>>>>>>                // Get the exising to new TimerID
53887>>>>>>>>>                Get MSG_Add_Object of iSet iObj to iTimerID
53888>>>>>>>>>
53888>>>>>>>>>                // Set/Modify the timer
53888>>>>>>>>>                Get Timeout of iObj to iTimeout
53889>>>>>>>>>                Move (SetTimer(hWnd, iTimerID, iTimeout, 0)) to iResult
53890>>>>>>>>>                If Not iResult Begin
53892>>>>>>>>>                    Error DFERR_DFTIMER C_$TooManyTimers
53893>>>>>>>>>>
53893>>>>>>>>>                    Procedure_Return
53894>>>>>>>>>                End
53894>>>>>>>>>>
53894>>>>>>>>>
53894>>>>>>>>>            End
53894>>>>>>>>>>
53894>>>>>>>>>
53894>>>>>>>>>            // Let's kill an existing timer
53894>>>>>>>>>            Else Begin
53895>>>>>>>>>
53895>>>>>>>>>                // Look up the object in the set
53895>>>>>>>>>                Get Find_Object of iSet iObj to iTimerID
53896>>>>>>>>>
53896>>>>>>>>>                If iTimerID EQ -1 ;                    Procedure_Return
53899>>>>>>>>>
53899>>>>>>>>>                // Kill the timer
53899>>>>>>>>>                Move (KillTimer(hWnd, iTimerID)) to iResult
53900>>>>>>>>>                If Not iResult Begin
53902>>>>>>>>>                    Move (GetLastError()) to nResult
53903>>>>>>>>>                    Error DFERR_DFTIMER (C_$CantKillTimer * string(nResult) - "!")
53904>>>>>>>>>>
53904>>>>>>>>>                    Procedure_Return
53905>>>>>>>>>                End
53905>>>>>>>>>>
53905>>>>>>>>>
53905>>>>>>>>>                // Remove the objectID
53905>>>>>>>>>                Send Remove_Object to iSet iObj
53906>>>>>>>>>            End
53906>>>>>>>>>>
53906>>>>>>>>>        End
53906>>>>>>>>>>
53906>>>>>>>>>    End_Procedure
53907>>>>>>>>>
53907>>>>>>>>>    Function Timer_Active_State Integer iObj Returns Integer
53909>>>>>>>>>        Integer iResult
53909>>>>>>>>>        Get Find_Object of (TimersArray(self)) iObj to iResult
53910>>>>>>>>>        Function_Return (iResult<>-1) // note: -1= not found
53911>>>>>>>>>    End_Function
53912>>>>>>>>>
53912>>>>>>>>>    // Will be called by the Set when it is being destroyed.
53912>>>>>>>>>    Procedure Kill_All_Timers
53914>>>>>>>>>        Integer iMax
53914>>>>>>>>>        Integer iSet
53914>>>>>>>>>        Integer iItem
53914>>>>>>>>>        Integer iObj
53914>>>>>>>>>        Integer iResult
53914>>>>>>>>>        Handle  hWnd
53914>>>>>>>>>
53914>>>>>>>>>        // Get the handle of this object
53914>>>>>>>>>        Get Window_Handle to hWnd
53915>>>>>>>>>        If (Not(hWnd)) Begin
53917>>>>>>>>>            Error DFERR_DFTIMER C_$TimerNoHandle
53918>>>>>>>>>>
53918>>>>>>>>>            Procedure_Return
53919>>>>>>>>>        End
53919>>>>>>>>>>
53919>>>>>>>>>
53919>>>>>>>>>        // If the window handle is no longer valid, we
53919>>>>>>>>>        // leave this procedure. This can happen when the
53919>>>>>>>>>        // program is begin aborted using Exit_Application
53919>>>>>>>>>        If (Not(IsWindow(hWnd))) ;            Procedure_Return
53922>>>>>>>>>
53922>>>>>>>>>        // Scan the set and kill all known timers
53922>>>>>>>>>        Move (TimersArray(self)) to iSet
53923>>>>>>>>>        If (iSet) Begin
53925>>>>>>>>>            Get Item_Count of iSet to iMax
53926>>>>>>>>>            Decrement iMax
53927>>>>>>>>>            For iItem From 1 to iMax
53933>>>>>>>>>>
53933>>>>>>>>>                Get Integer_Value of iSet item iItem to iObj
53934>>>>>>>>>                If iObj Begin
53936>>>>>>>>>                    Move (KillTimer(hWnd, iItem)) to iResult
53937>>>>>>>>>                    Set Array_Value of iSet item iItem to 0
53938>>>>>>>>>                End
53938>>>>>>>>>>
53938>>>>>>>>>            Loop
53939>>>>>>>>>>
53939>>>>>>>>>        End
53939>>>>>>>>>>
53939>>>>>>>>>
53939>>>>>>>>>    End_Procedure
53940>>>>>>>>>
53940>>>>>>>>>    Procedure OnTimer Integer wParam Integer lParam
53942>>>>>>>>>        Integer iObj
53942>>>>>>>>>        Get Integer_Value of (TimersArray(self)) item wParam to iObj
53943>>>>>>>>>        If Not iObj Begin
53945>>>>>>>>>            Error DFERR_DFTIMER C_$TimerWithoutObject
53946>>>>>>>>>>
53946>>>>>>>>>            Procedure_Return
53947>>>>>>>>>        End
53947>>>>>>>>>>
53947>>>>>>>>>        Send OnTimer to iObj wParam lParam
53948>>>>>>>>>    End_Procedure
53949>>>>>>>>>
53949>>>>>>>>>    Procedure Destroy_Object
53951>>>>>>>>>        Send Kill_All_Timers
53952>>>>>>>>>        Forward Send Destroy_Object
53954>>>>>>>>>        Move 0 to giTimerManager
53955>>>>>>>>>    End_Procedure
53956>>>>>>>>>
53956>>>>>>>>>End_Class // DFTimerManger
53957>>>>>>>>>
53957>>>>>>>>>
53957>>>>>>>>>
53957>>>>>>>>>
53957>>>>>>>>>// This class acts as a container for the
53957>>>>>>>>>// timer manager object. This is needed because
53957>>>>>>>>>// A DFTimerManager object created directly at the
53957>>>>>>>>>// desktop doesn't have a Window_Handle which we
53957>>>>>>>>>// need to create a Windoows timer. By placing
53957>>>>>>>>>// this non-visual container around the timer
53957>>>>>>>>>// manager, it does get a Window_Handle.
53957>>>>>>>>>// The procedure End_Construct_Object has been
53957>>>>>>>>>// augmented to create a window and also
53957>>>>>>>>>// automatically page all children, which will
53957>>>>>>>>>// be the timer manager.
53957>>>>>>>>>//
53957>>>>>>>>>Class DFTimerManagerPanel is a dfBasePanel
53958>>>>>>>>>
53958>>>>>>>>>    Procedure Construct_Object
53960>>>>>>>>>        Forward Send Construct_Object
53962>>>>>>>>>        Set Visible_State to FALSE
53963>>>>>>>>>        Object DFTimerManager is a DFTimerManager
53965>>>>>>>>>        End_Object
53966>>>>>>>>>    End_Procedure
53967>>>>>>>>>
53967>>>>>>>>>    Procedure End_Construct_Object
53969>>>>>>>>>        Forward Send End_Construct_Object
53971>>>>>>>>>        Send Page_Object TRUE
53972>>>>>>>>>        Broadcast Send Page_Object TRUE
53974>>>>>>>>>    End_Procedure
53975>>>>>>>>>
53975>>>>>>>>>End_Class
53976>>>>>>>>>
53976>>>>>>>>>// This is the class the user uses to create DFTimer objects
53976>>>>>>>>>
53976>>>>>>>>>
53976>>>>>>>>>//{ OverrideProperty=Skip_State DesignTime=False }
53976>>>>>>>>>//{ OverrideProperty=TypeFace DesignTime=False }
53976>>>>>>>>>Class DFTimer is a Textbox
53977>>>>>>>>>
53977>>>>>>>>>    Procedure Construct_Object
53979>>>>>>>>>        Forward Send Construct_Object
53981>>>>>>>>>
53981>>>>>>>>>        // Make sure this object never appears
53981>>>>>>>>>        Set Visible_State to FALSE
53982>>>>>>>>>
53982>>>>>>>>>        Property Integer Private.Timeout    1000
53983>>>>>>>>>
53983>>>>>>>>>        Property Integer Timer_Message      0
53984>>>>>>>>>        Property Integer Timer_Object       0
53985>>>>>>>>>        Property Integer Auto_Start_State   True
53986>>>>>>>>>        Property Integer Auto_Stop_State    True
53987>>>>>>>>>    End_Procedure
53988>>>>>>>>>
53988>>>>>>>>>    Procedure Set Timer_Active_State Integer iState
53990>>>>>>>>>        Integer iObj
53990>>>>>>>>>        Move self to iObj
53991>>>>>>>>>        If giTimerManager ;            Set Timer_Active_State of giTimerManager iObj to iState
53994>>>>>>>>>    End_Procedure
53995>>>>>>>>>
53995>>>>>>>>>    Function Timer_Active_State Returns Integer
53997>>>>>>>>>        Integer iState
53997>>>>>>>>>        Integer iObj
53997>>>>>>>>>        Move self to iObj
53998>>>>>>>>>        If giTimerManager ;            Get Timer_Active_State of giTimerManager iObj to iState
54001>>>>>>>>>        Function_Return iState
54002>>>>>>>>>    End_Function
54003>>>>>>>>>
54003>>>>>>>>>    Procedure Set Timeout Integer iTimeout
54005>>>>>>>>>        Integer iActive
54005>>>>>>>>>        Set Private.Timeout to iTimeout
54006>>>>>>>>>        Get Timer_Active_State to iActive
54007>>>>>>>>>        If iActive ;            Set Timer_Active_State to TRUE
54010>>>>>>>>>    End_Procedure
54011>>>>>>>>>
54011>>>>>>>>>    Function Timeout Returns Integer
54013>>>>>>>>>        Integer iTimeout
54013>>>>>>>>>        Get Private.Timeout to iTimeout
54014>>>>>>>>>        Function_Return iTimeout
54015>>>>>>>>>    End_Function
54016>>>>>>>>>
54016>>>>>>>>>    Procedure OnTimer Integer iwParam Integer ilParam
54018>>>>>>>>>        Integer iMsg
54018>>>>>>>>>        Integer iObj
54018>>>>>>>>>        Get Timer_Message to iMsg
54019>>>>>>>>>        If (iMsg) Begin
54021>>>>>>>>>            Get Timer_Object  to iObj
54022>>>>>>>>>            If iObj ;                Send iMsg to iObj iwParam ilParam
54025>>>>>>>>>            Else ;                Send iMsg iwParam ilParam
54027>>>>>>>>>        End
54027>>>>>>>>>>
54027>>>>>>>>>    End_Procedure
54028>>>>>>>>>
54028>>>>>>>>>    // Augmented to Auto_Start a timer
54028>>>>>>>>>    //
54028>>>>>>>>>    Procedure Page_Object Integer iState
54030>>>>>>>>>        Forward Send Page_Object iState
54032>>>>>>>>>        If (iState AND Auto_Start_State(self)) ;            Set Timer_Active_State to TRUE
54035>>>>>>>>>    End_Procedure
54036>>>>>>>>>
54036>>>>>>>>>    // Augmented to Auto_Stop a timer
54036>>>>>>>>>    //
54036>>>>>>>>>    Procedure Page_Delete
54038>>>>>>>>>        If (Auto_Stop_State(self)) ;            Set Timer_Active_State to FALSE
54041>>>>>>>>>        Forward Send Page_Delete
54043>>>>>>>>>    End_Procedure
54044>>>>>>>>>
54044>>>>>>>>>    // Augmented to stop the timer
54044>>>>>>>>>    //
54044>>>>>>>>>    Procedure Destroy_Object
54046>>>>>>>>>        Set Timer_Active_State to FALSE
54047>>>>>>>>>        Forward Send Destroy_Object
54049>>>>>>>>>    End_Procedure
54050>>>>>>>>>
54050>>>>>>>>>End_Class // DFTimer
54051>>>>>>>>>
54051>>>>>>>>>//
54051>>>>>>>>>// This was moved into a method so it can be reliable created
54051>>>>>>>>>// at the desktop. Note that cDesktop adds method to cDesktop class (class of desktop)
54051>>>>>>>>>//
54051>>>>>>>>>Procedure CreateDfTimerManagerPanel FOR cDesktop
54053>>>>>>>>>    // Create the Desktop Timer Manager Object.
54053>>>>>>>>>    Object DFTimerManagerPanel is a DFTimerManagerPanel
54055>>>>>>>>>    End_Object
54056>>>>>>>>>End_Procedure
54057>>>>>>>>>
54057>>>>>>>>>Send CreateDfTimerManagerPanel of DESKTOP
54058>>>>>>>>>
54058>>>>>>>End_Object
54059>>>>>>>
54059>>>>>>>integer TooltipControllerID     // the object id of the tool tip timer
54059>>>>>>>integer DefaultTooltipHintID    // the object id of the default tool tip object
54059>>>>>>>
54059>>>>>>>// Point type
54059>>>>>>>type TOOLTIP_POINT
54059>>>>>>>    field TOOLTIP_POINT.X as dword
54059>>>>>>>    field TOOLTIP_POINT.Y as dword
54059>>>>>>>end_type
54059>>>>>>>
54059>>>>>>>// default function for objects, returns the hint string of an object
54059>>>>>>>function TooltipHint for DFObject returns string
54061>>>>>>>    function_return ""
54062>>>>>>>end_function
54063>>>>>>>
54063>>>>>>>// default function for objects, returns the hint object of an object
54063>>>>>>>function TooltipHintObject for DFObject returns string
54065>>>>>>>    function_return DefaultTooltipHintID
54066>>>>>>>end_function
54067>>>>>>>
54067>>>>>>>// SGM : 21/10/1997
54067>>>>>>>// this is a hook for us to get the window handle of a dfpanel class object.
54067>>>>>>>// this will either be the 'main' window handle, or a dialog's window handle.
54067>>>>>>>function WindowHandleForToolTip for DFPanel returns integer
54069>>>>>>>    local integer hd
54069>>>>>>>    get Window_Handle to hd
54070>>>>>>>    function_return hd
54071>>>>>>>end_function
54072>>>>>>>
54072>>>>>>>// returns the DF object id that is currently under the mouse.
54072>>>>>>>// the 'side effect' of this is that it will return the df object id of
54072>>>>>>>// ANY df object (even ones in a different VDF program!)
54072>>>>>>>function GetDFObjectUnderMouse global returns integer
54074>>>>>>>    local string  pnt    //  a TOOLTIP_POINT type
54074>>>>>>>    local pointer pPnt   //  a pointer to a TOOLTIP_POINT type
54074>>>>>>>    local integer xx     //  x location
54074>>>>>>>    local integer yy     //  y location
54074>>>>>>>    local handle  hd     //  handle of window under mouse
54074>>>>>>>    local integer iObj   //  the DF object under the mouse location
54074>>>>>>>
54074>>>>>>>    filltype TOOLTIP_POINT with 0 to pnt
54075>>>>>>>
54075>>>>>>>    GetAddress of pnt to pPnt
54076>>>>>>>
54076>>>>>>>    move (GetCursorPos(pPnt)) to windowindex
54077>>>>>>>
54077>>>>>>>    getbuff from pnt at TOOLTIP_POINT.X to xx
54078>>>>>>>    getbuff from pnt at TOOLTIP_POINT.Y to yy
54079>>>>>>>
54079>>>>>>>    move (WindowFromPoint(xx,yy)) to hd
54080>>>>>>>
54080>>>>>>>    Get_Object_From_Window hd to iObj
54081>>>>>>>
54081>>>>>>>    function_return iObj
54082>>>>>>>end_function
54083>>>>>>>
54083>>>>>>>//========================================================================================
54083>>>>>>>//  Name         : StandardToolTipLabel000
54083>>>>>>>//  Purpose      : Our 'label' in the standard tool tip object.
54083>>>>>>>//========================================================================================
54083>>>>>>>class StandardToolTipLabel000 is a TextboxSub
54084>>>>>>>    // A form is used because a text box doesn't set object_color to 4103 4120
54084>>>>>>>    // which is the windows tool tip hint color.
54084>>>>>>>
54084>>>>>>>
54084>>>>>>>    //====================================================================================
54084>>>>>>>    //  Name         : Construct_Object
54084>>>>>>>    //  Scope        : PRIVATE
54084>>>>>>>    //  Purpose      : Augmentation
54084>>>>>>>    //====================================================================================
54084>>>>>>>    procedure Construct_Object
54086>>>>>>>        forward send Construct_Object
54088>>>>>>>        //set Object_Color to 4103 4120
54088>>>>>>>        Set Color to 14811135
54089>>>>>>>        Set TextColor to clNavy
54090>>>>>>>        set Border_Style to BORDER_NONE    // weird how border none still gives a border for a form
54091>>>>>>>        set Focus_Mode   to NONFOCUSABLE
54092>>>>>>>    end_procedure
54093>>>>>>>
54093>>>>>>>    //====================================================================================
54093>>>>>>>    //  Name         : Autosize
54093>>>>>>>    //  Scope        : PRIVATE
54093>>>>>>>    //  Purpose      : Auto size the label
54093>>>>>>>    //====================================================================================
54093>>>>>>>    // borrowed from textbox
54093>>>>>>>    procedure Autosize String Val
54095>>>>>>>        local integer ext
54095>>>>>>>        get Text_Extent (ToAnsi(Val)) to ext
54096>>>>>>>        //Set Guisize To (Hi(Ext)+3) (Low(Ext)+2)
54096>>>>>>>
54096>>>>>>>        // some hard coded sizes, works though
54096>>>>>>>        set Guisize to (hi(Ext)+8) (low(Ext)+5)
54097>>>>>>>        send Adjust_logicals
54098>>>>>>>    end_procedure
54099>>>>>>>
54099>>>>>>>    //====================================================================================
54099>>>>>>>    //  Name         : UpdateTip
54099>>>>>>>    //  Scope        : PUBLIC
54099>>>>>>>    //  Purpose      : Update the tool tip with the new one
54099>>>>>>>    //====================================================================================
54099>>>>>>>    procedure UpdateTip string sTip
54101>>>>>>>        // pad with some spaces 'cause we want a 'border' around the text
54101>>>>>>>        set Value Item 0 to ("  " + sTip + "  ")
54102>>>>>>>        send Autosize (" " + sTip + " ")
54103>>>>>>>    end_procedure
54104>>>>>>>
54104>>>>>>>    //====================================================================================
54104>>>>>>>    //  Name         : ToolTipValue
54104>>>>>>>    //  Scope        : PUBLIC
54104>>>>>>>    //  Purpose      : What is the current tool tip value
54104>>>>>>>    //====================================================================================
54104>>>>>>>    function ToolTipValue returns string
54106>>>>>>>        // return the trim of the value for comparisons
54106>>>>>>>        function_return (trim( (Value(current_object,0)) ))
54107>>>>>>>    end_function
54108>>>>>>>end_class
54109>>>>>>>
54109>>>>>>>
54109>>>>>>>//========================================================================================
54109>>>>>>>//  Name         : StandardToolTip000
54109>>>>>>>//  Purpose      : The standard tool tip class, looks like the normal windows one.
54109>>>>>>>//========================================================================================
54109>>>>>>>class StandardToolTip000 is a ToolPanel
54110>>>>>>>
54110>>>>>>>    //====================================================================================
54110>>>>>>>    //  Name         :
54110>>>>>>>    //  Scope        : PRIVATE
54110>>>>>>>    //  Purpose      :
54110>>>>>>>    //====================================================================================
54110>>>>>>>
54110>>>>>>>    //====================================================================================
54110>>>>>>>    //  Name         : Construct_Object
54110>>>>>>>    //  Scope        : PRIVATE
54110>>>>>>>    //  Purpose      : Augmentation
54110>>>>>>>    //====================================================================================
54110>>>>>>>    procedure Construct_Object
54112>>>>>>>        forward send Construct_Object
54114>>>>>>>        set Border_Style  to BORDER_NORMAL
54115>>>>>>>        set Caption_Bar   to false
54116>>>>>>>        set Visible_State to false
54117>>>>>>>        //set Object_Color  to 4103 4120
54117>>>>>>>        Set Color to 14811135
54118>>>>>>>        Set TextColor to clNavy
54119>>>>>>>
54119>>>>>>>        // our 'text label' for the tool tip.
54119>>>>>>>        object ToolTipLabel is a StandardToolTipLabel000
54121>>>>>>>            set Location     to -2 -2
54122>>>>>>>        end_object
54123>>>>>>>    end_procedure
54124>>>>>>>
54124>>>>>>>    //====================================================================================
54124>>>>>>>    //  Name         : LocateToolTip
54124>>>>>>>    //  Scope        : PRIVATE
54124>>>>>>>    //  Purpose      : locate the tip just below the mouse (at least off the hot spot)
54124>>>>>>>    //====================================================================================
54124>>>>>>>    procedure LocateToolTip
54126>>>>>>>        local string  pnt    //  a TOOLTIP_POINT type
54126>>>>>>>        local pointer pPnt   //  a pointer to a TOOLTIP_POINT type
54126>>>>>>>        local integer xx     //  x location
54126>>>>>>>        local integer yy     //  y location
54126>>>>>>>        local integer cxy cx cy
54126>>>>>>>        Local Integer iYscreensize iXscreensize
54126>>>>>>>
54126>>>>>>>        filltype TOOLTIP_POINT with 0 to pnt
54127>>>>>>>
54127>>>>>>>        GetAddress of pnt to pPnt
54128>>>>>>>
54128>>>>>>>        move (GetCursorPos(pPnt)) to windowindex
54129>>>>>>>
54129>>>>>>>        getbuff from pnt at TOOLTIP_POINT.X to xx
54130>>>>>>>        getbuff from pnt at TOOLTIP_POINT.Y to yy
54131>>>>>>>
54131>>>>>>>        // SPY - 17/11/98
54131>>>>>>>        // If Location of the tooltip is outside of the screen reset the coordinayes
54131>>>>>>>        // Get The screen size
54131>>>>>>>        Moveint (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
54132>>>>>>>>
54132>>>>>>>        Moveint (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
54133>>>>>>>>
54133>>>>>>>        // Get The Tooltip Size
54133>>>>>>>        get client_size to cxy
54134>>>>>>>        move (Hi(cxy)) to cy
54135>>>>>>>        move (Low(cxy)) to cx
54136>>>>>>>        //Reset
54136>>>>>>>        If ((iXscreensize-xx) < cx)       Move (iXscreensize-cx) To xx
54139>>>>>>>        If (((iYscreensize-yy)-50) < cy)  Move (yy-cy-40)        To yy
54142>>>>>>>
54142>>>>>>>        // a bit of hard coding, but what the hell
54142>>>>>>>        set GUILocation to (yy + 20) xx
54143>>>>>>>    end_procedure
54144>>>>>>>
54144>>>>>>>    //====================================================================================
54144>>>>>>>    //  Name         : ShowToolTip
54144>>>>>>>    //  Scope        : PRIVATE
54144>>>>>>>    //  Purpose      : Show the requested tool tip
54144>>>>>>>    //====================================================================================
54144>>>>>>>    procedure ShowToolTip string sTip
54146>>>>>>>        local integer sz
54146>>>>>>>
54146>>>>>>>        // don't do anything, if it is visible AND has the same value!
54146>>>>>>>        if (Visible_State(current_object)) begin
54148>>>>>>>            // we are already visible, so determine if we need to do anything
54148>>>>>>>            if ((ToolTipValue(ToolTipLabel(current_object))) eq sTip) begin
54150>>>>>>>                // we are already showing this one,
54150>>>>>>>                procedure_return
54151>>>>>>>            end
54151>>>>>>>>
54151>>>>>>>        end
54151>>>>>>>>
54151>>>>>>>        send UpdateTip to (ToolTipLabel(current_object)) sTip
54152>>>>>>>
54152>>>>>>>        get Size  of (ToolTipLabel(current_object)) to sz
54153>>>>>>>        //set Size to ((hi(sz)) + 2) ((low(sz)) + 4)
54153>>>>>>>        set Size to ((hi(sz)) - 2) ((low(sz)) - 2)
54154>>>>>>>        send LocateToolTip
54155>>>>>>>        set Visible_State to true
54156>>>>>>>    end_procedure
54157>>>>>>>
54157>>>>>>>    //====================================================================================
54157>>>>>>>    //  Name         : HideToolTip
54157>>>>>>>    //  Scope        : PRIVATE
54157>>>>>>>    //  Purpose      : get rid of the tool tip
54157>>>>>>>    //====================================================================================
54157>>>>>>>    procedure HideToolTip
54159>>>>>>>        set Visible_State to false
54160>>>>>>>        send UpdateTip to (ToolTipLabel(current_object)) ""
54161>>>>>>>        set Location      to -100 -100
54162>>>>>>>    end_procedure
54163>>>>>>>
54163>>>>>>>end_class
54164>>>>>>>
54164>>>>>>>
54164>>>>>>>//========================================================================================
54164>>>>>>>//  Name         : ToolTipTimer000
54164>>>>>>>//  Purpose      : Class of object to control the tool tips.  Timer turns them on and off.
54164>>>>>>>//========================================================================================
54164>>>>>>>
54164>>>>>>>Class ToolTipTimer000 is a DFTimer
54165>>>>>>>
54165>>>>>>>    //====================================================================================
54165>>>>>>>    //  Name         :
54165>>>>>>>    //  Scope        : PRIVATE
54165>>>>>>>    //  Purpose      :
54165>>>>>>>    //====================================================================================
54165>>>>>>>
54165>>>>>>>    //====================================================================================
54165>>>>>>>    //  Name         : Construct_Object
54165>>>>>>>    //  Scope        : PRIVATE
54165>>>>>>>    //  Purpose      : Augmentation
54165>>>>>>>    //====================================================================================
54165>>>>>>>    procedure Construct_Object
54167>>>>>>>        forward send Construct_Object
54169>>>>>>>
54169>>>>>>>        property integer ToolTipVisible    public false  // are we displaying the tool tip
54170>>>>>>>        property integer LastToolTipObject public 0      // what was the last tool tip obj
54171>>>>>>>    end_procedure
54172>>>>>>>
54172>>>>>>>    //====================================================================================
54172>>>>>>>    //  Name         : ShowToolTip
54172>>>>>>>    //  Scope        : PRIVATE
54172>>>>>>>    //  Purpose      : Show the requested tool tip
54172>>>>>>>    //====================================================================================
54172>>>>>>>    procedure ShowToolTip integer ToolTipObject string sTip
54174>>>>>>>        local integer currentTipObj
54174>>>>>>>
54174>>>>>>>        get LastToolTipObject to currentTipObj
54175>>>>>>>        if (ToolTipObject ne currentTipObj) begin
54177>>>>>>>            // the tool tip we want to use is different to the one we used last
54177>>>>>>>            // so turn it off
54177>>>>>>>            if (ToolTipVisible(current_object)) send HideToolTip
54180>>>>>>>        end
54180>>>>>>>>
54180>>>>>>>
54180>>>>>>>        if (ToolTipObject ne 0) begin
54182>>>>>>>            set LastToolTipObject to ToolTipObject
54183>>>>>>>            set ToolTipVisible    to true
54184>>>>>>>
54184>>>>>>>            send ShowToolTip      to ToolTipObject sTip
54185>>>>>>>        end
54185>>>>>>>>
54185>>>>>>>        else send HideToolTip
54187>>>>>>>    end_procedure
54188>>>>>>>
54188>>>>>>>    //====================================================================================
54188>>>>>>>    //  Name         : HideToolTip
54188>>>>>>>    //  Scope        : PRIVATE
54188>>>>>>>    //  Purpose      : get rid of the current tool tip
54188>>>>>>>    //====================================================================================
54188>>>>>>>    procedure HideToolTip
54190>>>>>>>        local integer currentTipObj
54190>>>>>>>        if (ToolTipVisible(current_object)) begin
54192>>>>>>>            get LastToolTipObject to currentTipObj
54193>>>>>>>            send HideToolTip      to currentTipObj
54194>>>>>>>            set ToolTipVisible    to false
54195>>>>>>>        end
54195>>>>>>>>
54195>>>>>>>    end_procedure
54196>>>>>>>
54196>>>>>>>    //====================================================================================
54196>>>>>>>    //  Name         : ChangeTimerInterval
54196>>>>>>>    //  Scope        : PRIVATE
54196>>>>>>>    //  Purpose      : Hook to change timer interval.  This is because PlusPak! cTimer
54196>>>>>>>    //               : must be stopped and started to change the timer interval
54196>>>>>>>    //====================================================================================
54196>>>>>>>    procedure ChangeTimerInterval integer NewInterval
54198>>>>>>>        Set Timeout to NewInterval
54199>>>>>>>    end_procedure
54200>>>>>>>
54200>>>>>>>    //====================================================================================
54200>>>>>>>    //  Name         : CheckHint
54200>>>>>>>    //  Scope        : PRIVATE
54200>>>>>>>    //  Purpose      : check to see if a tool tip should be shown
54200>>>>>>>    //====================================================================================
54200>>>>>>>    procedure CheckHint
54202>>>>>>>        local integer isTipActive
54202>>>>>>>        //local integer showTip
54202>>>>>>>        local integer iobj
54202>>>>>>>        local string  sTip
54202>>>>>>>
54202>>>>>>>        get ToolTipVisible to isTipActive      // are we already displaying ome?
54203>>>>>>>        move (GetDFObjectUnderMouse()) to iObj // what is the current df object
54204>>>>>>>        if (iObj ne 0) begin
54206>>>>>>>            // we have an object
54206>>>>>>>            // get the tool tip string
54206>>>>>>>            //get ShowTooltipHint of iObj to showTip        // do we display a hint
54206>>>>>>>            //if (showTip) get TooltipHint of iObj to sTip  // and what is it
54206>>>>>>>            get TooltipHint of iObj to sTip
54207>>>>>>>        end
54207>>>>>>>>
54207>>>>>>>
54207>>>>>>>        if (isTipActive) begin
54209>>>>>>>            // the tool tip is active, so we either want to turn it off or we've moved to a different object
54209>>>>>>>            if (sTip ne "") begin
54211>>>>>>>                // the tool tip is active and we have something to show
54211>>>>>>>                send ShowToolTip (TooltipHintObject(iObj)) sTip
54212>>>>>>>            end
54212>>>>>>>>
54212>>>>>>>            else begin
54213>>>>>>>                // the tool tip is active and we don't want to show one
54213>>>>>>>                send HideToolTip
54214>>>>>>>                send ChangeTimerInterval 1000
54215>>>>>>>            end
54215>>>>>>>>
54215>>>>>>>        end
54215>>>>>>>>
54215>>>>>>>        else begin
54216>>>>>>>            // the tool tip is not active
54216>>>>>>>            if (sTip ne "") begin
54218>>>>>>>                // the tool tip is not active and we have something to show
54218>>>>>>>                send ShowToolTip (TooltipHintObject(iObj)) sTip
54219>>>>>>>                send ChangeTimerInterval 200 // make the timer check more (smoother transition from object to object)
54220>>>>>>>            end
54220>>>>>>>>
54220>>>>>>>            else begin
54221>>>>>>>                // the tool tip is not active and we don't want to show one
54221>>>>>>>                // nothing to do
54221>>>>>>>            end
54221>>>>>>>>
54221>>>>>>>        end
54221>>>>>>>>
54221>>>>>>>    end_procedure
54222>>>>>>>
54222>>>>>>>    //====================================================================================
54222>>>>>>>    //  Name         : CheckRemoveToolTip
54222>>>>>>>    //  Scope        : PRIVATE
54222>>>>>>>    //  Purpose      : Check to see if we should hide the tool tip, given that it should
54222>>>>>>>    //               : not be there!
54222>>>>>>>    //====================================================================================
54222>>>>>>>    procedure CheckRemoveToolTip
54224>>>>>>>        // if the tool tip is active, then get rid of it.
54224>>>>>>>        if (ToolTipVisible(current_object)) begin
54226>>>>>>>            send HideToolTip
54227>>>>>>>            // SGM : 21/10/1997
54227>>>>>>>            // added this - slow the timer down if we removed it.
54227>>>>>>>            send ChangeTimerInterval 1000
54228>>>>>>>        end
54228>>>>>>>>
54228>>>>>>>    end_procedure
54229>>>>>>>
54229>>>>>>>    //====================================================================================
54229>>>>>>>    //  Name         : MouseIsOverWindow
54229>>>>>>>    //  Scope        : PRIVATE
54229>>>>>>>    //  Purpose      : returns true is the mouse is over this window
54229>>>>>>>    //====================================================================================
54229>>>>>>>    function MouseIsOverWindow handle hWind returns integer
54231>>>>>>>        local string  pnt       // a TOOLTIP_POINT type
54231>>>>>>>        local pointer pPnt      // a pointer to TOOLTIP_POINT
54231>>>>>>>        local string  rect      // a tRECT type
54231>>>>>>>        local pointer pRect     // a pointer to tRECT
54231>>>>>>>        local integer mx        // mouse x
54231>>>>>>>        local integer my        // mouse y
54231>>>>>>>        local integer winLeft   // win left loc
54231>>>>>>>        local integer winTop    // win top loc
54231>>>>>>>        local integer winRight  // win right loc
54231>>>>>>>        local integer winBottom // win bottom loc
54231>>>>>>>
54231>>>>>>>        // get the location of the mouse
54231>>>>>>>        filltype TOOLTIP_POINT with 0 to pnt
54232>>>>>>>        GetAddress of pnt to pPnt
54233>>>>>>>        move (GetCursorPos(pPnt)) to windowindex
54234>>>>>>>        getbuff from pnt at TOOLTIP_POINT.X to mx
54235>>>>>>>        getbuff from pnt at TOOLTIP_POINT.Y to my
54236>>>>>>>
54236>>>>>>>        // get the _real_ origin and extent of the application
54236>>>>>>>        // using DF's Absolute_GuiOrigin returns us the loctions offset by the
54236>>>>>>>        // apps caption bar which just causes too many problems
54236>>>>>>>
54236>>>>>>>        filltype tRECT with 0 to rect
54237>>>>>>>        GetAddress of rect to pRect
54238>>>>>>>        move (GetWindowRect(hWind, pRect)) to windowindex
54239>>>>>>>        getbuff from rect at tRECT.left    to winLeft
54240>>>>>>>        getbuff from rect at tRECT.top     to winTop
54241>>>>>>>        getbuff from rect at tRECT.right   to winRight
54242>>>>>>>        getbuff from rect at tRECT.bottom  to winBottom
54243>>>>>>>
54243>>>>>>>        function_return (((mx gt winLeft) and (mx lt winRight)) and ((my gt winTop) and (my lt winBottom)))
54244>>>>>>>    end_function
54245>>>>>>>
54245>>>>>>>    //====================================================================================
54245>>>>>>>    //  Name         : OnTimer
54245>>>>>>>    //  Scope        : PRIVATE
54245>>>>>>>    //  Purpose      : A timer event has gone, do the checks
54245>>>>>>>    //====================================================================================
54245>>>>>>>    procedure OnTimer
54247>>>>>>>        local handle  hdMain
54247>>>>>>>        local handle  hd
54247>>>>>>>        local integer iFoc iObj ibase
54247>>>>>>>
54247>>>>>>>        // we have to determine if we are the active window because if there is another df app running
54247>>>>>>>        // we will get the df object of the object in the other app if the mouse is located there.
54247>>>>>>>
54247>>>>>>>        // this causes us to get an unresolved object reference because we're trying to talk to an object
54247>>>>>>>        // that isn't even in this program!
54247>>>>>>>
54247>>>>>>>        move (GetActiveWindow())                    to hd      // the active (DF) window.
54248>>>>>>>
54248>>>>>>>        // if the active window handle doesn't equal the window handle of 'main' then we are either dealing
54248>>>>>>>        // with a modal panel (within our app) or some other app has the windows focus.  what we need to
54248>>>>>>>        // do now is get the window handle of the panel that is the parent of the focus and check
54248>>>>>>>        // that against the active window.
54248>>>>>>>
54248>>>>>>>        // get the focus
54248>>>>>>>        get Focus to iFoc
54249>>>>>>>        // get the window handle of the panel that is the parent (or grand.. parent) of the focus.
54249>>>>>>>        get WindowHandleForToolTip of (iFoc) to hdMain             // the handle of the window (panel) that has the focus
54250>>>>>>>
54250>>>>>>>        // do the tests.
54250>>>>>>>        if (hd eq hdMain) begin
54252>>>>>>>            // the active window is the same as the panel with the focus,
54252>>>>>>>            // but is the mouse over the active window?
54252>>>>>>>            if (MouseIsOverWindow(current_object,hd)) begin
54254>>>>>>>                // the window for this app is active and the mouse is actually over the application
54254>>>>>>>                // not a different VDF
54254>>>>>>>                //move (GetDFObjectUnderMouse()) to iObj // what is the current df object
54254>>>>>>>                //If (base_Class(iObj) = 1) Begin
54254>>>>>>>                    //If (Message(iObj,0) = WM_LBUTTONDOWN) Begin
54254>>>>>>>                    //    showln "   " iObj "   " ibase
54254>>>>>>>                    //    send CheckRemoveToolTip
54254>>>>>>>                    //    Set TooltipVisible to True
54254>>>>>>>                    //End
54254>>>>>>>                //End
54254>>>>>>>                // check for tool tip hints
54254>>>>>>>                send CheckHint
54255>>>>>>>            end
54255>>>>>>>>
54255>>>>>>>            else send CheckRemoveToolTip   // remove the tool tip if it is active
54257>>>>>>>        end
54257>>>>>>>>
54257>>>>>>>        else send CheckRemoveToolTip       // remove the tool tip if it is active
54259>>>>>>>
54259>>>>>>>    end_procedure
54260>>>>>>>
54260>>>>>>>
54260>>>>>>>    //====================================================================================
54260>>>>>>>    //  Name         : DisableToolTips
54260>>>>>>>    //  Scope        : PUBLIC
54260>>>>>>>    //  Purpose      : Turn off tool tips
54260>>>>>>>    //====================================================================================
54260>>>>>>>    procedure DisableToolTips
54262>>>>>>>        Set Timer_Active_State to False
54263>>>>>>>    end_procedure
54264>>>>>>>
54264>>>>>>>    //====================================================================================
54264>>>>>>>    //  Name         : EnableToolTips
54264>>>>>>>    //  Scope        : PUBLIC
54264>>>>>>>    //  Purpose      : Turn on tool tips
54264>>>>>>>    //====================================================================================
54264>>>>>>>    procedure EnableToolTips
54266>>>>>>>        Set Timer_Active_State to True
54267>>>>>>>    end_procedure
54268>>>>>>>end_class
54269>>>>>>>
54269>>>>>>>//These Objects now are in Tooltip.inc File that is being included in the End_Construct_Object
54269>>>>>>>//of the dbView_EZ Class - SPY 15/11/78 This Must Be changed
54269>>>>>>>
54269>>>>>>>//object StandardToolTip is a StandardToolTip000
54269>>>>>>>//    move (current_object) to DefaultTooltipHintID
54269>>>>>>>//end_object
54269>>>>>>>
54269>>>>>>>//object ToolTipTimer is a ToolTipTimer000
54269>>>>>>>//    move (current_object) to TooltipControllerID
54269>>>>>>>//end_object
54269>>>>>>>
54269>>>>>Use AccKeymx.ezc
54269>>>>>
54269>>>>>
54269>>>>>Define BPM_RIGHT          for 1
54269>>>>>Define BPM_LEFT           for 2
54269>>>>>Define BPM_TOP            for 3
54269>>>>>Define BPM_BOTTOM         for 4
54269>>>>>
54269>>>>>Class cButtonPopupMenuSub is a DFBaseEditPullDown
54270>>>>>
54270>>>>>    Procedure Construct_Object
54272>>>>>        Forward Send Construct_Object
54274>>>>>        Property Integer piParentWindowHandle (Parent(Self))
54275>>>>>        Property Integer piOrientation BPM_BOTTOM
54276>>>>>        Send Delete_Data
54277>>>>>    End_Procedure // Construct_Object
54278>>>>>
54278>>>>>    Procedure DoPopup
54280>>>>>        // Problem: need to display the menu underneath the button
54280>>>>>        Integer iVoid iLeft iTop iBottom liSize liY liX
54280>>>>>        String sRect
54280>>>>>        Pointer lpsRect
54280>>>>>
54280>>>>>        If (piParentWindowHandle(Self)=0) Procedure_Return
54283>>>>>
54283>>>>>        ZeroType tRect To sRect
54284>>>>>        GetAddress of sRect To lpsRect
54285>>>>>
54285>>>>>        Send Windows_Message of (piParentWindowHandle(self)) TB_GETITEMRECT 0 lpsRect // get bounding rectangle of the button
54286>>>>>
54286>>>>>        GetBuff from sRect at tRect.Bottom To iBottom
54287>>>>>        Put iBottom To sRect at tRect.Top
54288>>>>>
54288>>>>>        Move (ClientToScreen(window_handle(piParentWindowHandle(self)), lpsRect)) To iVoid // convert Client to Screen coordinates
54289>>>>>        GetBuff from sRect at tRect.left To iLeft
54290>>>>>        GetBuff from sRect at tRect.top To iTop
54291>>>>>
54291>>>>>        Get GuiSize of (piParentWindowHandle(Self)) to liSize
54292>>>>>        Move (Hi(liSize))  to liY
54293>>>>>        Move (Low(liSize)) to liX
54294>>>>>        If (piOrientation(self)=BPM_BOTTOM)     Set GuiLocation To (iTop+liY) iLeft
54297>>>>>        Else If (piOrientation(self)=BPM_RIGHT) Set GuiLocation To iTop (iLeft+liX)
54301>>>>>        Send Popup
54302>>>>>    End_Procedure // DoPopup
54303>>>>>
54303>>>>>End_Class // cButtonPopupMenu
54304>>>>>
54304>>>>>Class ButtonSub Is A Button
54305>>>>>
54305>>>>>    Procedure Construct_Object
54307>>>>>        Forward Send Construct_Object
54309>>>>>
54309>>>>>        Property String TooltipValue Public ""
54310>>>>>        Property Integer Private.Disable_State Public False
54311>>>>>        Property Integer MDI_Container Public (Parent(Self))
54312>>>>>        //Set Message Item 0 To Msg_Buttonclicked
54312>>>>>        //Property Integer Calling_Object Public 0
54312>>>>>        // What is the popup Menu
54312>>>>>        Property Integer piPopupMenuId 0
54313>>>>>        //Send Define_DisableAcceleratorKey_Mixin
54313>>>>>
54313>>>>>    End_Procedure
54314>>>>>
54314>>>>>    Procedure End_Construct_Object
54316>>>>>        If (piPopupMenuId(Self)) Set Label to (Label(Self) * ">>")
54319>>>>>        Forward Send End_Construct_Object
54321>>>>>        //Set Focus_Mode to Pointer_Only
54321>>>>>    End_procedure
54322>>>>>
54322>>>>>    Function TooltipHint returns string
54324>>>>>        Function_Return (TooltipValue(Self))
54325>>>>>    End_function
54326>>>>>
54326>>>>>    Procedure Enable_Window integer iState
54328>>>>>        Local integer hWnd
54328>>>>>        Get Window_Handle to hWnd
54329>>>>>        If hWnd Move (EnableWindow(hWnd,iState)) To hWnd
54332>>>>>    End_procedure
54333>>>>>
54333>>>>>    Procedure Set Disable_Not_Shadowed_State Integer iState
54335>>>>>        Set Private.Disable_State to iState
54336>>>>>        Send Enable_Window (1-iState)
54337>>>>>    End_Procedure
54338>>>>>
54338>>>>>    Function Disable_Not_Shadowed_State Returns Integer
54340>>>>>        Function_Return (Private.Disable_State(Self))
54341>>>>>    End_Function
54342>>>>>
54342>>>>>    Procedure OnClick
54344>>>>>        Local Integer bFocus liObjId
54344>>>>>        Get Focus_Mode to bFocus
54345>>>>>        If (bFocus = Pointer_Only) Begin
54347>>>>>            Get MDI_Container to liObjId
54348>>>>>            If (liObjId) Send mouse_down to liObjId
54351>>>>>        End
54351>>>>>>
54351>>>>>    End_Procedure
54352>>>>>
54352>>>>>    Procedure Add_Item Integer aimsg String asLabel
54354>>>>>        Integer liMenuId
54354>>>>>
54354>>>>>        If (piPopupMenuId(Self) = 0) Procedure_Return
54357>>>>>        Get piPopupMenuId to liMenuId
54358>>>>>        Send Add_Item of liMenuId aimsg asLabel
54359>>>>>        Set Aux_Value of liMenuId (Item_Count(Self)-1) To self
54360>>>>>    End_Procedure // Add_Item
54361>>>>>
54361>>>>>    Procedure DoPopupMenu
54363>>>>>        If (piPopupMenuId(Self)) Send DoPopup of (piPopupMenuId(Self))
54366>>>>>    End_Procedure // DoPopupMenu
54367>>>>>
54367>>>>>    Import_Class_Protocol DisableAcceleratorKey_Mixin
54368>>>>>
54368>>>>>End_Class //ButtonSub
54369>>>>>
54369>>>>>
54369>>>Use Windows.pkg
54369>>>
54369>>>//
54369>>>//Open Sysfile
54369>>>//Open Clients
54369>>>//Open CN
54369>>>//Open CONSTRCT
54369>>>//Open Salesmen
54369>>>//Open MHXANIK
54369>>>//Open PAYRESP
54369>>>//Open CODEMAST
54369>>>//Open CODETYPE
54369>>>//Open BTNORDH
54369>>>//Open BTNORDD
54369>>>//Open AREAS
54369>>>//Open CITIES
54369>>>//Open TOWNS
54369>>>//Open COUNTRY
54369>>>//Open CNZONES
54369>>>//Open BRZONES
54369>>>//Open ZONES
54369>>>//
54369>>>//Open MIClient
54369>>>//Open MICN
54369>>>//Open MICONSTR
54369>>>//Open MISalesm
54369>>>//Open MIMHXAN
54369>>>//Open MIPRESP
54369>>>//Open MICodtyp
54369>>>//Open MIcodema
54369>>>//Open MIORDH
54369>>>//Open MIORDD
54369>>>//Open MIAREAS
54369>>>//Open MICITIES
54369>>>//Open MITOWNS
54369>>>//Open MICOUNTR
54369>>>//
54369>>>
54369>>>Activate_View Activate_MI_Migrate_Send_Data_To_Master for MI_Migrate_Send_Data_To_Master
54379>>>>
54379>>>
54379>>>Object MI_Migrate_Send_Data_To_Master is a dbView
54381>>>
54381>>>    Set Border_Style to Border_Thick
54382>>>    Set Size to 219 404
54383>>>    Set Location to 15 14
54384>>>
54384>>>    Property Integer piChoice public 0
54386>>>
54386>>>    On_Key Key_Alt+Key_O Send OpenMe
54387>>>
54387>>>    Set Label to "€§¦©«¦¢ã £˜¨¡˜¨ ©£â¤à¤ „šš¨˜­é¤ ˜§¦ ‹¦¤á›˜ ©«ž¤ „¤¦§¦ ž£â¤ž á©ž"
54388>>>
54388>>>    Procedure OpenMe
54391>>>        Integer iState
54391>>>        Get Visible_State of frmJSBD        to iState
54392>>>        Set Visible_State of frmJSBD        to (1-iState)
54393>>>        Set Enabled_State of frmJSBD        to (1-iState)
54394>>>        //Set Visible_State of btnDelSMSMI    to (1-iState)
54394>>>        //Set Enabled_State of btnDelSMSMI    to (1-iState)
54394>>>    End_Procedure
54395>>>
54395>>>    Function Check_Afm Global String Afm_Num Returns Integer
54397>>>        Integer iii Num1 Num2
54397>>>        Move (Trim(Afm_Num)) to Afm_Num
54398>>>        For iii from 1 to (Length(Trim(Afm_Num)))
54404>>>>
54404>>>            If not (Mid(Afm_Num,1,iii)) In  "0123456789" Function_Return 3
54407>>>        Loop
54408>>>>
54408>>>        Move (Right(Afm_Num,1)) to Num2
54409>>>        If (Length(Afm_Num)<>9) Function_Return 2
54412>>>        Move 0 to Num1
54413>>>        For iii from 1 to 8
54419>>>>
54419>>>            Add ((Mid(Afm_Num,1,iii)) * (2 ^ (9 - iii))) to Num1
54420>>>        Loop
54421>>>>
54421>>>        Move (Mod(Num1,11)) to Num1
54422>>>        If (Num1=10) Move 0 to Num1
54425>>>        If (Num1=Num2)  Function_Return 0
54428>>>        Else            Function_Return 1
54430>>>    End_Function
54431>>>
54431>>>    //============
54431>>>    Function Write_City String asCityDescr Returns Integer
54434>>>        Integer rVal
54434>>>        Clear MICities
54435>>>        Move 9999 to MICities.City_ID
54436>>>        Find LE MICities by Index.1
54437>>>>
54437>>>        If (Found) Move (MICities.City_ID+1)    to rVal
54440>>>        Else       Move 1                       to rVal
54442>>>        Clear MICities
54443>>>        Move rVal           to MICities.CITY_ID
54444>>>        Move asCityDescr    to MICities.CITY_DESCR
54445>>>        SaveRecord MICities
54446>>>        Function_Return rVal
54447>>>    End_Function
54448>>>
54448>>>    Function Write_Area String asAreaDescr Returns Integer
54451>>>        Integer rVal
54451>>>        Clear MIAreas
54452>>>        Move 9999 to MIAreas.Area_ID
54453>>>        Find LE MIAreas by Index.1
54454>>>>
54454>>>        If (Found) Move (MIAreas.Area_ID+1) to rVal
54457>>>        Else       Move 1                   to rVal
54459>>>        Clear MIAREAS
54460>>>        Move rVal           to MIAreas.AREA_ID
54461>>>        Move asAreaDescr    to MIAreas.AREA_DESCR
54462>>>        SaveRecord MIAreas
54463>>>        Function_Return rVal
54464>>>    End_Function
54465>>>    //============
54465>>>
54465>>>
54465>>>
54465>>>
54465>>>
54465>>>
54465>>>    Procedure Activate_View Returns Integer
54468>>>        Integer rVal
54468>>>        String  sFolderInitial
54468>>>
54468>>>        Set Value of frmJSBD to ""
54469>>>        Forward Get Msg_Activate_View to rVal
54471>>>
54471>>>        Open tmplg
Including file: Tmplg.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\Tmplg.FD)
54473>>>        Open tmpPagia
Including file: TMPPAGIA.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\TMPPAGIA.FD)
54475>>>
54475>>>        Open tmpPagia Mode DF_EXCLUSIVE
54477>>>        ZeroFile tmpPagia
54478>>>        Open tmpPagia Mode DF_SHARE
54480>>>
54480>>>        Open tmplg Mode DF_EXCLUSIVE
54482>>>        ZeroFile tmplg
54483>>>        Open tmplg Mode DF_SHARE
54485>>>
54485>>>        Procedure_Return rVal
54486>>>    End_Procedure
54487>>>
54487>>>
54487>>>
54487>>>    Use chartranslate.pkg
Including file: CharTranslate.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\CharTranslate.pkg)
54487>>>>>//*************************************************************************
54487>>>>>//*
54487>>>>>//*  Copyright (c) 2001 Data Access Corporation, Miami Florida,
54487>>>>>//*  All rights reserved.
54487>>>>>//*  DataFlex is a registered trademark of Data Access Corporation.
54487>>>>>//*
54487>>>>>//*************************************************************************
54487>>>>>//*
54487>>>>>//*  Module Name:
54487>>>>>//*      CharTranslate.pkg
54487>>>>>//*
54487>>>>>//*  Creator:
54487>>>>>//*      SF
54487>>>>>//*
54487>>>>>//*
54487>>>>>//*  Purpose:
54487>>>>>//*      Various global functions to translate OEM to UTF.
54487>>>>>//*
54487>>>>>//*************************************************************************
54487>>>>>
54487>>>>>Use Windows.pkg
54487>>>>>
54487>>>>>
54487>>>>>External_Function32 MultiByteToWideChar "MultiByteToWideChar" kernel32.dll;    DWORD dwCodePage;    DWORD dwFlags;    Pointer pMultiByteStr;    Integer cbMultiByte;    Pointer pWideStr;    Integer cchWideChar;    Returns Integer
54488>>>>>
54488>>>>>External_Function32 WideCharToMultiByte "WideCharToMultiByte" kernel32.dll;    DWORD dwCodePage;    DWORD dwFlags;    Pointer pWideStr;    Integer cchWideChar;    Pointer pMultiByteStr;    Integer cbMultiByte;    Pointer pDefaultChar;    Pointer pUsedDefaultChar;    Returns Integer
54489>>>>>
54489>>>>>//dwCodePage = Multi Byte Code Page to convert from
54489>>>>>//pMultiBuf  = Pointer to Multi Byte string
54489>>>>>//iLen       = Length in bytes of Multi Byte string
54489>>>>>//ppWideBuf  = Contents of ppWideBuf contains a pointer to the destination buffer on return
54489>>>>>Function MultiToWideBuffer Global DWORD dwCodePage Address pMultiBuf Integer iLen Address ppWideBuf Returns Integer
54491>>>>>    Integer iWideSize
54491>>>>>    Integer iVoid
54491>>>>>    Address pWideBuf
54491>>>>>    Move (MultiByteToWideChar(dwCodePage,0,pMultiBuf,iLen,0,0)) to iWideSize
54492>>>>>    If (iWideSize=0);        Function_Return 0
54495>>>>>    Move (Alloc((iWideSize+1)*2)) to pWideBuf
54496>>>>>    If (pWideBuf=0);        Function_Return 0
54499>>>>>    Move (MultiByteToWideChar(dwCodePage,0,pMultiBuf,iLen,pWideBuf,iWideSize)) to iWideSize
54500>>>>>    If (iWideSize=0) ;        Move (Free(pWideBuf)) to iVoid
54503>>>>>    else begin
54504>>>>>        Move (StoreW(pWideBuf,(iWideSize*2),0)) to iVoid
54505>>>>>        Move (StoreDW(ppWideBuf,0,pWideBuf)) to iVoid
54506>>>>>    end
54506>>>>>>
54506>>>>>    Function_Return iWideSize
54507>>>>>End_Function
54508>>>>>
54508>>>>>//dwCodePage = Multi Byte Code Page to convert to
54508>>>>>//pWideBuf   = Pointer to Wide Character string
54508>>>>>//iLen       = Length in characters of Wide Character string
54508>>>>>//ppMultiBuf = Contents of ppMultiBuf contains a pointer to the destination buffer on return
54508>>>>>Function WideToMultiBuffer Global DWORD dwCodePage Address pWideBuf Integer iLen Address ppMultiBuf Returns Integer
54510>>>>>    Integer iMultiSize
54510>>>>>    Address pMultiBuf
54510>>>>>    Integer iVoid
54510>>>>>    Move (WideCharToMultiByte(dwCodePage,0,pWideBuf,iLen,0,0,0,0)) to iMultiSize
54511>>>>>    If (iMultiSize=0);        Function_Return 0
54514>>>>>    Move (Alloc(iMultiSize+1)) to pMultiBuf
54515>>>>>    If (pMultiBuf=0);        Function_Return 0
54518>>>>>    Move (WideCharToMultiByte(dwCodePage,0,pWideBuf,iLen,pMultiBuf,iMultiSize,0,0)) to iMultiSize
54519>>>>>    If (iMultiSize=0) ;        Move (Free(pMultiBuf)) to iVoid
54522>>>>>    else begin
54523>>>>>        Move (StoreC(pMultiBuf,iMultiSize,0)) to iVoid
54524>>>>>        Move (StoreDW(ppMultiBuf,0,pMultiBuf)) to iVoid
54525>>>>>    end
54525>>>>>>
54525>>>>>    Function_Return iMultiSize
54526>>>>>End_Function
54527>>>>>
54527>>>>>//Converts a UTF-8 string to OEM
54527>>>>>//pUtf8Buf   = Pointer to UTF-8 string
54527>>>>>//iLen       = Length of UTF-8 string in bytes
54527>>>>>//Returns pointer to OEM string, use free() to deallocate buffer when it's no longer needed
54527>>>>>Function Utf8ToOemBuffer Global Address pUtf8Buf Integer iLen Returns Address
54529>>>>>    Address pWideBuf
54529>>>>>    Address pOemBuf
54529>>>>>    Integer iWideBufLen
54529>>>>>    Integer iMultiBufLen
54529>>>>>    Integer iVoid
54529>>>>>    Move 0 to pWideBuf
54530>>>>>    Move 0 to pOemBuf
54531>>>>>    Move (MultiToWideBuffer(CP_UTF8,pUtf8Buf,iLen,AddressOf(pWideBuf))) to iWideBufLen
54532>>>>>    If (iWideBufLen=0);        Function_Return 0
54535>>>>>    Move (WideToMultiBuffer(CP_OEMCP,pWideBuf,iWideBufLen,AddressOf(pOemBuf))) to iMultiBufLen
54536>>>>>    Move (Free(pWideBuf)) to iVoid
54537>>>>>    Function_Return pOemBuf
54538>>>>>End_Function
54539>>>>>
54539>>>>>//Converts a OEM string to UTF-8
54539>>>>>//pOemBuf    = Pointer to OEM string
54539>>>>>//iLen       = Length of OEM string in bytes
54539>>>>>//Returns pointer to UTF-8 string, use free() to deallocate buffer when it's no longer needed
54539>>>>>Function OemToUtf8Buffer Global Address pOemBuf Integer iLen Returns Address
54541>>>>>    Address pWideBuf
54541>>>>>    Address pUtf8Buf
54541>>>>>    Integer iWideBufLen
54541>>>>>    Integer iMultiBufLen
54541>>>>>    Integer iVoid
54541>>>>>    Move 0 to pWideBuf
54542>>>>>    Move 0 to pUtf8Buf
54543>>>>>    Move (MultiToWideBuffer(CP_OEMCP,pOemBuf,iLen,AddressOf(pWideBuf))) to iWideBufLen
54544>>>>>    If (iWideBufLen=0);        Function_Return 0
54547>>>>>    Move (WideToMultiBuffer(CP_UTF8,pWideBuf,iWideBufLen,AddressOf(pUtf8Buf))) to iMultiBufLen
54548>>>>>    Move (Free(pWideBuf)) to iVoid
54549>>>>>    Function_Return pUtf8Buf
54550>>>>>End_Function
54551>>>
54551>>>    Function Utf8ToOemString Global String sUtf8String Returns String
54553>>>        Address aString
54553>>>        String sOemString
54553>>>        Boolean bVoid
54553>>>        //Move (Utf8ToOemBuffer(sUtf8String, CStringLength(sUtf8String))) to aString
54553>>>        Move (Utf8ToOemBuffer(AddressOf(sUtf8String), CStringLength(sUtf8String))) to aString
54554>>>        Move aString to sOemString
54555>>>        Move (Free(aString)) to bVoid
54556>>>        Function_Return sOemString
54557>>>    End_Function
54558>>>
54558>>>    Function OemToUtf8String Global String sUtf8String Returns String
54560>>>        Address aString
54560>>>        String sOemString
54560>>>        Boolean bVoid
54560>>>        //Move (OemToUtf8Buffer(sUtf8String, CStringLength(sUtf8String))) to aString
54560>>>        Move (OemToUtf8Buffer(AddressOf(sUtf8String), CStringLength(sUtf8String))) to aString
54561>>>        Move aString to sOemString
54562>>>        Move (Free(aString)) to bVoid
54563>>>        Function_Return sOemString
54564>>>    End_Function
54565>>>
54565>>>
54565>>>
54565>>>//    Object btnSub1 is a Button
54565>>>//        Set Size to 20 383
54565>>>//        Set Location to 87 8
54565>>>//        Set Label to "„§œ¥œ¨š˜©å˜ 1"
54565>>>//
54565>>>//        Set Visible_State to False
54565>>>//        Set Enabled_State to False
54565>>>//
54565>>>//        Procedure OnClick
54565>>>//            Integer iFileNumber iFields iField_Type
54565>>>//            String  sFullName sFileName sStr sPedio sLabel sName
54565>>>//
54565>>>//            Get Label to sLabel
54565>>>//
54565>>>//            Move Clients.File_Number to iFileNumber
54565>>>//            Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
54565>>>//            Clear Clients
54565>>>//            Move 1 to Clients.EXPORTFLAG
54565>>>//            Find GE Clients by Index.12
54565>>>//            While ((Found) and (Clients.EXPORTFLAG=1))
54565>>>//                Set Label to ("Updating Clients.... "+Trim(Clients.Client_ID))
54565>>>//
54565>>>//                String sClientCode sClientPresp
54565>>>//                Move Clients.CLIENT_ID to sClientCode
54565>>>//
54565>>>//                Clear MICLIENT
54565>>>//                Move Clients.CLIENT_AFM to MIClient.CLIENT_AFM
54565>>>//                Find GE MICLIENT by Index.8
54565>>>//                If ((Found) and (MIClient.CLIENT_AFM=Clients.CLIENT_AFM)) Begin
54565>>>//                    Move MIClient.CLIENT_ID to sClientCode
54565>>>//                    Move MIClient.PRESP_ID  to sClientPresp
54565>>>//                End
54565>>>//                Else Begin
54565>>>//                    Clear MIClient
54565>>>//                    For FieldIndex from 0 to iFields
54565>>>//                        Move (Trim(Clients.Recnum&)) to MIClient.Recnum&
54565>>>//                    Loop
54565>>>//                    SaveRecord MIClient
54565>>>//                    Move Clients.CLIENT_ID to sClientCode
54565>>>//                    Move Clients.PRESP_ID  to sClientPresp
54565>>>//                End
54565>>>//
54565>>>//
54565>>>//
54565>>>//
54565>>>//
54565>>>//                Find GT Clients by Index.12
54565>>>//            Loop
54565>>>//
54565>>>//
54565>>>////            Move CN.File_Number to iFileNumber
54565>>>////            Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
54565>>>////            Clear CN
54565>>>////            Move 1 to CN.EXPORTFLAG
54565>>>////            Find GE CN by Index.9
54565>>>////            While ((Found) and (CN.EXPORTFLAG=1))
54565>>>////                Set Label to ("Updating CN.... "+Trim(CN.CN_Code))
54565>>>////                Clear MICN
54565>>>////                For FieldIndex from 0 to iFields
54565>>>////                    Get_Attribute DF_FIELD_NAME of iFileNumber FieldIndex to sName
54565>>>////                    //Showln (String(FieldIndex)) "   " (Trim(sName)) "    "  (Trim(CN.Recnum&))
54565>>>////                    Move (Trim(CN.Recnum&)) to MICN.Recnum&
54565>>>////                Loop
54565>>>////                SaveRecord MICN
54565>>>////                Find GT CN by Index.9
54565>>>////            Loop
54565>>>//
54565>>>//            Move CN.File_Number to iFileNumber
54565>>>//            Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
54565>>>//            Clear CN
54565>>>//            Find GE CN.Recnum
54565>>>//            While (Found)
54565>>>//                Set Label to ("Updating CN.... "+Trim(CN.CN_Code))
54565>>>//                If (CN.EXPORTFLAG=1) Begin
54565>>>//                    Clear MICN
54565>>>//                    For FieldIndex from 0 to iFields
54565>>>//                        Get_Attribute DF_FIELD_NAME of iFileNumber FieldIndex to sName
54565>>>//                        Move (Trim(CN.Recnum&)) to MICN.Recnum&
54565>>>//                    Loop
54565>>>//                    SaveRecord MICN
54565>>>//                End
54565>>>//                Find GT CN.Recnum
54565>>>//            Loop
54565>>>//
54565>>>//
54565>>>//
54565>>>//            Move Constrct.File_Number to iFileNumber
54565>>>//            Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
54565>>>//            Clear Constrct
54565>>>//            Move 1 to Constrct.EXPORTFLAG
54565>>>//            Find GE Constrct by Index.6
54565>>>//            While ((Found) and (Constrct.EXPORTFLAG=1))
54565>>>//                Set Label to ("Updating Constrct.... "+Trim(Constrct.CNT_ID))
54565>>>//                Clear MIConstr
54565>>>//                For FieldIndex from 0 to iFields
54565>>>//                    Move (Trim(Constrct.Recnum&)) to MIConstr.Recnum&
54565>>>//                Loop
54565>>>//                SaveRecord MIConstr
54565>>>//                Find GT Constrct by Index.6
54565>>>//            Loop
54565>>>//
54565>>>//
54565>>>//            Move Mhxanik.File_Number to iFileNumber
54565>>>//            Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
54565>>>//            Clear Mhxanik
54565>>>//            Move 1 to Mhxanik.EXPORTFLAG
54565>>>//            Find GE Mhxanik by Index.5
54565>>>//            While ((Found) and (Mhxanik.EXPORTFLAG=1))
54565>>>//                Set Label to ("Updating Mhxanik.... "+Trim(Mhxanik.Mhx_ID))
54565>>>//                Clear MIMhxan
54565>>>//                For FieldIndex from 0 to iFields
54565>>>//                    Move (Trim(Mhxanik.Recnum&)) to MIMhxan.Recnum&
54565>>>//                Loop
54565>>>//                SaveRecord MIMhxan
54565>>>//                Find GT Mhxanik by Index.5
54565>>>//            Loop
54565>>>//
54565>>>//
54565>>>//            Move Payresp.File_Number to iFileNumber
54565>>>//            Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
54565>>>//            Clear Payresp
54565>>>//            Move 1 to Payresp.EXPORTFLAG
54565>>>//            Find GE Payresp by Index.9
54565>>>//            While ((Found) and (Payresp.EXPORTFLAG=1))
54565>>>//                Set Label to ("Updating Payresp.... "+Trim(Payresp.Presp_ID))
54565>>>//                Clear MIPresp
54565>>>//                For FieldIndex from 0 to iFields
54565>>>//                    Move (Trim(Payresp.Recnum&)) to MIPresp.Recnum&
54565>>>//                Loop
54565>>>//                SaveRecord MIPresp
54565>>>//                Find GT Payresp by Index.9
54565>>>//            Loop
54565>>>//
54565>>>//
54565>>>//            Move Salesmen.File_Number to iFileNumber
54565>>>//            Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
54565>>>//            Clear Salesmen
54565>>>//            Move 1 to Salesmen.EXPORTFLAG
54565>>>//            Find GE Salesmen by Index.5
54565>>>//            While ((Found) and (Salesmen.EXPORTFLAG=1))
54565>>>//                Set Label to ("Updating Salesmen.... "+Trim(Salesmen.SLS_ID))
54565>>>//                Clear MISalesm
54565>>>//                For FieldIndex from 0 to iFields
54565>>>//                    Move (Trim(Salesmen.Recnum&)) to MISalesm.Recnum&
54565>>>//                Loop
54565>>>//                SaveRecord MISalesm
54565>>>//                Find GT Salesmen by Index.5
54565>>>//            Loop
54565>>>//
54565>>>//
54565>>>//        End_Procedure // OnClick
54565>>>//
54565>>>//    End_Object
54565>>>
54565>>>    Object btnDelSMSMI is a ButtonSub
54567>>>        Set Size to 14 171
54568>>>        Set Location to 198 151
54569>>>        Set Label to "Clear all data in Master DB SMSMI"
54570>>>
54570>>>        Set Enabled_State to False
54571>>>        Set Visible_State to False
54572>>>
54572>>>            //AB-StoreStart
54572>>>            Procedure OnClick
54575>>>                Open MIClient   Mode DF_EXCLUSIVE
54577>>>                Open MICN       Mode DF_EXCLUSIVE
54579>>>                Open MICONSTR   Mode DF_EXCLUSIVE
54581>>>                Open MISalesm   Mode DF_EXCLUSIVE
54583>>>                Open MIMHXAN    Mode DF_EXCLUSIVE
54585>>>                Open MIPRESP    Mode DF_EXCLUSIVE
54587>>>                Open MICodtyp   Mode DF_EXCLUSIVE
54589>>>                Open MIcodema   Mode DF_EXCLUSIVE
54591>>>                Open MIORDH     Mode DF_EXCLUSIVE
54593>>>                Open MIORDD     Mode DF_EXCLUSIVE
54595>>>                Open MIAREAS    Mode DF_EXCLUSIVE
54597>>>                Open MICITIES   Mode DF_EXCLUSIVE
54599>>>                Open MITOWNS    Mode DF_EXCLUSIVE
54601>>>                Open MICOUNTR   Mode DF_EXCLUSIVE
54603>>>
54603>>>                ZeroFile MIClient
54604>>>                ZeroFile MICN
54605>>>                ZeroFile MICONSTR
54606>>>                ZeroFile MISalesm
54607>>>                ZeroFile MIMHXAN
54608>>>                ZeroFile MIPRESP
54609>>>                ZeroFile MICodtyp
54610>>>                ZeroFile MIcodema
54611>>>                ZeroFile MIORDH
54612>>>                ZeroFile MIORDD
54613>>>                ZeroFile MIAREAS
54614>>>                ZeroFile MICITIES
54615>>>                ZeroFile MITOWNS
54616>>>                ZeroFile MICOUNTR
54617>>>
54617>>>                Open MIClient   Mode DF_SHARE
54619>>>                Open MICN       Mode DF_SHARE
54621>>>                Open MICONSTR   Mode DF_SHARE
54623>>>                Open MISalesm   Mode DF_SHARE
54625>>>                Open MIMHXAN    Mode DF_SHARE
54627>>>                Open MIPRESP    Mode DF_SHARE
54629>>>                Open MICodtyp   Mode DF_SHARE
54631>>>                Open MIcodema   Mode DF_SHARE
54633>>>                Open MIORDH     Mode DF_SHARE
54635>>>                Open MIORDD     Mode DF_SHARE
54637>>>                Open MIAREAS    Mode DF_SHARE
54639>>>                Open MICITIES   Mode DF_SHARE
54641>>>                Open MITOWNS    Mode DF_SHARE
54643>>>                Open MICOUNTR   Mode DF_SHARE
54645>>>            End_Procedure // OnClick
54646>>>            //AB-StoreEnd
54646>>>    End_Object
54647>>>
54647>>>
54647>>>    //////////////////////////////////
54647>>>    // NEW BUTTON Yannis 26/07/2017 //
54647>>>    //////////////////////////////////
54647>>>    Object btnSub2 is a Button
54649>>>        Set Size to 20 383
54650>>>        Set Location to 175 13
54651>>>        Set Label to "€§¦©«¦¢ã"
54652>>>
54652>>>
54652>>>        Procedure OnClick
54655>>>            String sFilename sLabel sClientCode sClientRecr sClientAFM
54655>>>            Integer bIsCreated
54655>>>            Integer iWhat iVal
54655>>>            Get Label to sLabel
54656>>>
54656>>>            Integer iCnt iFS iExportFlag iRecn
54656>>>            Move 0 to iCnt
54657>>>            File_Size Clients to iFS
54660>>>            String sMess sExportStatus
54660>>>            Date dExportDate
54660>>>
54660>>>            Integer isChecked
54660>>>            Integer iCheckAFM iChkNines iChkZeroes iChkBlanks iChkStars
54660>>>            String  Zeroes Stars Nines
54660>>>                        Integer isGood
54660>>>
54660>>>
54660>>>            
54660>>>            // Yannis 16/10/20017
54660>>>            // Allaxame seira epexergasias bazontas prota ta erga giati an epexergastoume
54660>>>            // prota ton pekath kai to flag ta xemarkaristei einai energo, tote ta erga 
54660>>>            // den tha pernagane giati kai ayta exetazoun an o pelaths einai markarismenos
54660>>>            // gia na antigrafoun h oxi. Opote epexergazomaste prota ta erga (kai ta xemarkaroume)
54660>>>            // prin to kanoume ayti stous pelates.
54660>>>            File_Size CN to iFS
54663>>>            Get Checked_State of chkCN to isChecked
54664>>>            If (isChecked) Begin
54666>>>                Move 0 to iCnt
54667>>>                Clear CN
54668>>>                Find GE CN.Recnum
54669>>>>
54669>>>                While (Found)
54673>>>                    If (CN.ExportFlag=1) Begin
54675>>>                        Add 1 to iCnt
54676>>>                        //Move ("CN... "+String(iCnt)) to sMess
54676>>>                        Move ("CN - „¨š˜... "+String(iCnt)+" / "+String(iFS)) to sMess
54677>>>                        Set Label to sMess
54678>>>
54678>>>                        Clear CLIENTS
54679>>>                        Move CN.CLIENT_ID to Clients.CLIENT_ID
54680>>>                        Find Eq CLIENTS by Index.6
54681>>>>
54681>>>                        If (not(Found)) Begin
54683>>>                            Move ("‘¦™˜¨æ ‘­á¢£˜ ‹† „ç¨œ©ž œ¢á«ž £â©à „¨š¦¬  CN.Client_ID="+CN.CLIENT_ID+"   CN="+CN.CN_CODE) to sMess
54684>>>                            Send Stop_Box sMess "‘­á¢£˜ 8005"
54685>>>                            Procedure_Return
54686>>>                        End
54686>>>>
54686>>>                        Move Clients.CLIENT_ID      to sClientCode
54687>>>                        Move Clients.CLIENT_RECR    to sClientRecr
54688>>>                        Move Clients.CLIENT_AFM     to sClientAFM
54689>>>                        Move CN.RECNUM              to iRecn
54690>>>
54690>>>                        Integer iNoClientAllowed iNoCopy
54690>>>                        Move 0 to iNoCopy
54691>>>                        Get Checked_State of chkCNnoClient to iNoClientAllowed
54692>>>
54692>>>                        If ( (iNoClientAllowed=0) and (Clients.EXPORTFLAG=0) ) Move 1 to iNoCopy
54695>>>
54695>>>                        If (iNoCopy=0) Send CopyERGA CN.CN_Code sClientCode sClientRecr sClientAFM
54698>>>
54698>>>                        Clear CN
54699>>>                        Move iRecn to CN.RECNUM
54700>>>                    End
54700>>>>
54700>>>                    Find GT CN.Recnum
54701>>>>
54701>>>                Loop
54702>>>>
54702>>>            End // If (isChecked) chkCN
54702>>>>
54702>>>
54702>>>
54702>>>
54702>>>
54702>>>            Get Checked_State of chkClients to isChecked
54703>>>
54703>>>                        Get Checked_State of ChkAFM     to iCheckAFM
54704>>>                        Get Checked_State of chkNines   to iChkNines
54705>>>                        Get Checked_State of chkZeroes  to iChkZeroes
54706>>>                        Get Checked_State of chkStars   to iChkStars
54707>>>                        Get Checked_State of chkBlanks  to iChkBlanks
54708>>>
54708>>>            Move "000000"   to Zeroes
54709>>>            Move "*"        to Stars
54710>>>            Move "999999"   to Nines
54711>>>
54711>>>            File_Size Clients to iFS
54714>>>            String sCountMess
54714>>>
54714>>>            If (isChecked) Begin
54716>>>                Clear Clients
54717>>>                Find GE Clients.Recnum
54718>>>>
54718>>>                While (Found)
54722>>>                    Add 1 to iCnt
54723>>>                    Move ("Clients... "+String(iCnt)+" / "+String(iFS)) to sMess
54724>>>                    Set Label to sMess
54725>>>                    If (Clients.ExportFlag=1) Begin
54727>>>                                Move 1 to isGood
54728>>>                                If ((iCheckAFM =1) and (Check_AFM(Clients.Client_Afm)=0   )) Move 0 to isGood
54731>>>                                If ((iChkZeroes=1) and (Clients.Client_AFM contains Zeroes)) Move 0 to isGood
54734>>>                                If ((iChkNines =1) and (Clients.Client_AFM contains Nines )) Move 0 to isGood
54737>>>                                If ((iChkStars =1) and (Clients.Client_AFM contains Stars )) Move 0 to isGood
54740>>>                                If ((iChkBlanks=1) and (Trim(Clients.Client_AFM)=""       )) Move 0 to isGood
54743>>>                        If (isGood=1) Send CopyClients Clients.RECNUM
54746>>>                    End // If (Clients.ExportFlag=1) Begin
54746>>>>
54746>>>                    Find GT Clients.Recnum
54747>>>>
54747>>>                Loop
54748>>>>
54748>>>            End // If (isChecked) chkClients
54748>>>>
54748>>>
54748>>>            Set Label to sLabel
54749>>>            Send Info_Box "Process Finished" "Information"
54750>>>        End_Procedure // OnClick
54751>>>
54751>>>
54751>>>        Procedure CopyClients Integer aiRecnum
54754>>>            String  sClientID sDeli sPrespID sLabel sAFM sClientCode sClientPresp
54754>>>            Integer iCheckAFM iRecnum isFound iCountFound iCountNew ichkDebug iSKIPALL
54754>>>
54754>>>            Integer iFileNumber iFields iField_Type
54754>>>            String  sFullName sFileName sStr sPedio sName
54754>>>
54754>>>            Get Label to sLabel
54755>>>
54755>>>            Clear Clients
54756>>>            Move aiRecnum to Clients.Recnum
54757>>>            Find Eq Clients.Recnum
54758>>>>
54758>>>            If (not(Found)) Begin
54760>>>                Send Stop_Box "¨¦™¢ž£˜ ©¦™˜¨¦ ©«ž¤ œç¨œ©ž œ¢á«ž" "‘­á¢£˜ 8860"
54761>>>                Procedure_Return
54762>>>            End
54762>>>>
54762>>>
54762>>>            //========================
54762>>>            // Tsekaroyme ton Pelath
54762>>>            Move Clients.CLIENT_ID  to sClientCode
54763>>>            Move Clients.PRESP_ID   to sClientPresp
54764>>>            Move aiRecnum           to iRecnum
54765>>>
54765>>>            Integer isChecked
54765>>>            Move 0 to iSKIPALL
54766>>>            Move 0 to isFound
54767>>>            Get Checked_State of chkClientsEdit to isChecked
54768>>>            Get Checked_State of chkDebug       to ichkDebug
54769>>>
54769>>>            Move Clients.File_Number to iFileNumber
54770>>>            Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
54773>>>            Clear MIClient
54774>>>            Move Clients.Client_AFM to MIClient.Client_AFM
54775>>>            Find GE MICLIENT by Index.8
54776>>>>
54776>>>            If ((Found) and (MIClient.Client_AFM=Clients.Client_AFM)) Begin
54778>>>                If (not(Checked_State(chkClientsEdit(Self)))) Move 1 to iSKIPALL //Procedure_Return
54781>>>                If (isChecked=0) Move 1 to iSKIPALL //Procedure_Return
54784>>>
54784>>>                Move Clients.CLIENT_ID to sClientCode
54785>>>                Move Clients.PRESP_ID  to sClientPresp
54786>>>
54786>>>                If ((Clients.Client_ID<>MICLIENT.CLIENT_ID) And (iSKIPALL=0)) Begin
54788>>>                    Showln "Ž œ¢á«žª " Clients.Client_Id "  " (ToAnsi(Trim(Clients.Client_Name))) ;                        "  ™¨âŸž¡œ ™á©ž €”‹ ©«¦¤ ¡à› ¡æ " MIClient.CLIENT_ID "  ©«¦ æ¤¦£˜ " (ToAnsi(Trim(MIClient.Client_Name))) ;                        "  ¡¦ ¤æ €”‹ = " Clients.Client_AFM
54799>>>                    Reread MICLIENT
54803>>>                    For FieldIndex from 0 to iFields
54809>>>>
54809>>>                        Move (Trim(Clients.Recnum&)) to MIClient.Recnum&
54810>>>                    Loop
54811>>>>
54811>>>                    SaveRecord MIClient
54812>>>                    Unlock
54813>>>>
54813>>>                    Move MIClient.CLIENT_ID to sClientCode
54814>>>                    Move MIClient.PRESP_ID  to sClientPresp
54815>>>
54815>>>                    Reread CLIENTS
54819>>>                    Move "SENT" to Clients.EXPORTSTATUS
54820>>>                    Sysdate        Clients.EXPORTDATE
54821>>>                    SaveRecord CLIENTS
54822>>>                    
54822>>>                End
54822>>>>
54822>>>            End
54822>>>>
54822>>>            Else Begin
54823>>>                // An DEN yparxei pelaths me idio AFM tote ton anoigoyme
54823>>>                Clear MIClient
54824>>>                For FieldIndex from 0 to iFields
54830>>>>
54830>>>                    Move (Trim(Clients.Recnum&)) to MIClient.Recnum&
54831>>>                Loop
54832>>>>
54832>>>                SaveRecord MIClient
54833>>>                Move MIClient.CLIENT_ID to sClientCode
54834>>>                Move MIClient.PRESP_ID  to sClientPresp
54835>>>
54835>>>                Reread CLIENTS
54839>>>                Move "SENT" to Clients.EXPORTSTATUS
54840>>>                Sysdate        Clients.EXPORTDATE
54841>>>                SaveRecord CLIENTS
54842>>>            End
54842>>>>
54842>>>
54842>>>            //--------------------------------------------------
54842>>>            //---- AREAS & CITIES (+Cities have TOWNS & COUNTRY)
54842>>>            //--------------------------------------------------
54842>>>
54842>>>            Integer iCityID iAreaID iTownID iCountryID iNewID
54842>>>            String sCityDescr sAreaDescr sTownDescr sCountryDescr
54842>>>            Move 0 to isFound
54843>>>            Clear Areas
54844>>>            Move Clients.Client_Area to Areas.AREA_ID
54845>>>            Find EQ Areas by Index.1
54846>>>>
54846>>>            If (Found) Begin
54848>>>                Clear MIAreas
54849>>>                Move Areas.Area_DESCR to MIAreas.Area_DESCR
54850>>>                Find GE MIAreas by Index.2
54851>>>>
54851>>>                If (not((Found) and (MIAreas.Area_DESCR=Areas.Area_DESCR))) Begin
54853>>>                    Move (Write_Area(Self,Areas.AREA_DESCR)) to iAreaID
54854>>>                End
54854>>>>
54854>>>                Else Move MIAreas.AREA_ID to iAreaID
54856>>>                If (MiCLient.CLIENT_AREA<>iAreaID) Begin
54858>>>                    Reread MICLIENT
54862>>>                    Move iAreaID to MiCLient.CLIENT_AREA
54863>>>                    SaveRecord MICLIENT
54864>>>                    Unlock
54865>>>>
54865>>>                End
54865>>>>
54865>>>            End
54865>>>>
54865>>>
54865>>>            Clear Cities
54866>>>            Move Clients.CLIENT_CITY_ID to Cities.City_ID
54867>>>            Find EQ Cities by Index.1
54868>>>>
54868>>>            If (Found) Begin
54870>>>                Clear MICities
54871>>>                Move Cities.CITY_DESCR to MICities.City_DESCR
54872>>>                Find GE MICities by Index.2
54873>>>>
54873>>>                If (not((Found) and (MICities.City_DESCR=Cities.CITY_DESCR))) Begin
54875>>>                    Move (Write_City(Self,Cities.City_DESCR)) to iCityID
54876>>>                End
54876>>>>
54876>>>                Else Move MICities.City_ID to iCityID
54878>>>                If (MiCLient.CLIENT_City_ID<>iCityID) Begin
54880>>>                    Reread MICLIENT
54884>>>                    Move iCityID to MiCLient.CLIENT_City_ID
54885>>>                    SaveRecord MICLIENT
54886>>>                    Unlock
54887>>>>
54887>>>                End
54887>>>>
54887>>>            End
54887>>>>
54887>>>            //--------------------------------------------------
54887>>>            //--------------------------------------------------
54887>>>            Move 0 to isFound
54888>>>            Move 0 to iSKIPALL
54889>>>            Move Payresp.File_Number to iFileNumber
54890>>>            Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
54893>>>            Clear Payresp
54894>>>            Move sClientPresp to Payresp.PRESP_ID
54895>>>            Find EQ Payresp by Index.7
54896>>>>
54896>>>            If (Found) Begin
54898>>>                Clear MIPresp
54899>>>                Move sClientPresp to MIPresp.PRESP_ID
54900>>>                Find EQ MIPresp by Index.7
54901>>>>
54901>>>                If (Found) Move 1 to isFound
54904>>>                If ((isFound=1) and (isChecked=0)) Begin
54906>>>                    Move 1 to iSKIPALL //Procedure_Return
54907>>>                End
54907>>>>
54907>>>                If (iSKIPALL=0) Begin
54909>>>                    If (isFound=1) Reread MIPRESP
54915>>>                    For FieldIndex from 0 to iFields
54921>>>>
54921>>>                        Move (Trim(Payresp.Recnum&)) to MIPresp.Recnum&
54922>>>                    Loop
54923>>>>
54923>>>                    SaveRecord MIPresp
54924>>>                    If (isFound) Unlock
54927>>>                End
54927>>>>
54927>>>            End
54927>>>>
54927>>>
54927>>>            //// Aparaithth epanatopothethsh sto geniko loop
54927>>>            //// ton pelaton bash recnum afou endexetai na allaxame
54927>>>            //// trexon recod pelath and to afm tou yparxei hdh se allo pelath
54927>>>            //Clear Clients
54927>>>            //Move iRecnum to Clients.Recnum
54927>>>            //Find Eq Clients.Recnum
54927>>>
54927>>>            Move 0 to isChecked
54928>>>            Get Checked_State of chkUnmark to isChecked
54929>>>            If (isChecked>0) Begin
54931>>>                Reread CLIENTS
54935>>>                Move 0      to Clients.EXPORTFLAG
54936>>>//                Move "SENT" to Clients.EXPORTSTATUS
54936>>>//                Sysdate        Clients.EXPORTDATE
54936>>>                SaveRecord CLIENTS
54937>>>                Unlock
54938>>>>
54938>>>            End
54938>>>>
54938>>>        End_Procedure
54939>>>
54939>>>
54939>>>        Procedure CopyERGA String asCNCode String asClientID String asClientRecr String asClientAFM
54942>>>            Integer iFileNumber iFields iField_Type
54942>>>            String  sFullName sFileName sStr sPedio sLabel sName
54942>>>
54942>>>            String sSLS sCNT sMHX
54942>>>
54942>>>            Integer isFound ByPass ichkCNnoClient ichkDebug iSKIPALL
54942>>>
54942>>>            Move 0 to isFound
54943>>>            Move 0 to ByPass
54944>>>            Move 0 to iSKIPALL
54945>>>
54945>>>            Get Checked_State of chkCNnoClient  to ichkCNnoClient
54946>>>            Get Checked_State of chkDebug       to ichkDebug
54947>>>
54947>>>            Clear CN
54948>>>            Move asCNCode to CN.CN_CODE
54949>>>            Find EQ CN by Index.5
54950>>>>
54950>>>            If (not(Found)) Begin
54952>>>                Send Stop_Box ("¨¦™¢ž£˜ ©¦™˜¨¦ ©«ž¤ SMS - œç¨œ©ž ë¨š¦¬ §¨¦ª ˜¤« š¨˜­ã = "+asCNCode) "‘­á¢£˜ 9860"
54953>>>                Procedure_Return
54954>>>            End
54954>>>>
54954>>>            Clear CLIENTS
54955>>>            Move CN.CLIENT_ID to Clients.CLIENT_ID
54956>>>            Find Eq CLIENTS by Index.6
54957>>>>
54957>>>
54957>>>            Integer iNoClientAllowed iNoCopy
54957>>>            Move 0 to iNoCopy
54958>>>            Get Checked_State of chkCNnoClient to iNoClientAllowed
54959>>>
54959>>>            If ((iNoClientAllowed=0) and (Clients.EXPORTFLAG=0)) Move 1 to iNoCopy
54962>>>
54962>>>            If (iNoCopy=0) Begin
54964>>>
54964>>>                If (ichkDebug) Showln "SMS Client ID =" asClientID "   SMS Client_Recr = " asClientRecr "   SMS Client AFM = " asClientAFM "   SMS ERGO = " asCNCode
54975>>>
54975>>>                Clear MICLIENT
54976>>>                Move asClientAFM to MICLIENT.CLIENT_AFM
54977>>>                Find GE MICLIENT by Index.8
54978>>>>
54978>>>                If ((Found) and (MIClient.CLIENT_AFM=Clients.CLIENT_AFM)) Begin
54980>>>                    Move MIClient.CLIENT_ID      to asClientID
54981>>>                    Move MIClient.CLIENT_RECR    to asClientRecr
54982>>>                    If (ichkDebug) Showln "FOUND Client in SMSMI By AFM"
54986>>>                End
54986>>>>
54986>>>                Else Begin
54987>>>                    // Exoume energo record Clients apo thn SMS
54987>>>                    If (Clients.Recnum<=0) Begin
54989>>>                        Send Stop_Box "PROBLEM... NO CURRENT CLIENTS RECORD FROM SMS" "Error 3251"
54990>>>                        Procedure_Return
54991>>>                    End
54991>>>>
54991>>>                    Clear MIClient
54992>>>                    Move asClientID to MIClient.CLIENT_ID
54993>>>                    Find Eq MICLIENT by Index.6
54994>>>>
54994>>>                    If (not(Found)) Begin
54996>>>                        If (ichkDebug) Begin
54998>>>                            Showln "NOT FOUND Client in SMSMI By AFM or ID "
55000>>>                            Showln "¨âŸž¡œ ë¨š¦ £˜¨¡˜¨ ©£â¤¦ ®à¨åª ¤˜ §¨¦¬§á¨®œ  ¦ œ¢á«žª ©«ž¤ œ¤¦§¦ ž£â¤ž ™á©ž (œ¢á«žª="  asClientID "  ë¨š¦=" CN.CN_CODE
55005>>>                        End
55005>>>>
55005>>>                        If (ichkCNnoClient=1) Begin
55007>>>                            If (ichkDebug) Showln "‡˜ ˜¤¦ ®«œå «é¨˜ ¦ œ¢á«žª ˜¬«æ£˜«˜"
55011>>>                            Send CopyClients Clients.RECNUM
55012>>>                        End
55012>>>>
55012>>>                    End
55012>>>>
55012>>>                End
55012>>>>
55012>>>
55012>>>
55012>>>                //--------
55012>>>                // Check if we need to edit existing record
55012>>>                //--------
55012>>>                Move CN.File_Number to iFileNumber
55013>>>                Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
55016>>>                Move 0 to iSKIPALL
55017>>>                Move 0 to isFound
55018>>>
55018>>>                Clear MICN
55019>>>                Move asCNCode to MICN.CN_CODE
55020>>>                Find Eq MICN by Index.5
55021>>>>
55021>>>                If (Found) Move 1 to isFound
55024>>>
55024>>>                If ((isFound) and (not(Checked_State(chkCNEdit(Self))))) Move 1 to iSKIPALL //Procedure_Return
55027>>>
55027>>>                Integer isChecked
55027>>>                Get Checked_State of chkCNEdit to isChecked
55028>>>                If ((isFound) and (isChecked=0)) Move 1 to iSKIPALL  //Procedure_Return
55031>>>
55031>>>                If (iSKIPALL=0) Begin
55033>>>                    If (isFound) Reread MICN
55039>>>                    For FieldIndex from 0 to iFields
55045>>>>
55045>>>                        Move (Trim(CN.Recnum&)) to MICN.Recnum&
55046>>>                    Loop
55047>>>>
55047>>>                    Move asClientID   to MICN.CLIENT_ID
55048>>>                    Move asClientRecr to MICN.CLIENT_RECR
55049>>>
55049>>>                    Clear CNZONES
55050>>>                    Move CN.CN_CODE to CNZONES.CN_CODE
55051>>>                    Find GE CNZONES by Index.1
55052>>>>
55052>>>                    If ((Found=1) and (CN.CN_CODE=CNZONES.CN_CODE)) Begin
55054>>>
55054>>>                        Clear BRZONES
55055>>>                        Move CNZONES.BRZONE_RECR to BRZONES.BRZONE_RECR
55056>>>                        Find Eq BRZONES by Index.2
55057>>>>
55057>>>
55057>>>                        Clear ZONES
55058>>>                        Move BRZONES.ZONE_ID to Zones.ZONE_ID
55059>>>                        Find Eq ZONES by Index.1
55060>>>>
55060>>>
55060>>>                        Move (Trim(Zones.ZONE_DESCR))   to MICN.CN_VDETAILS
55061>>>                        Move Zones.ZONE_ID              to MICN.CN_CLIENTMATCH  // MICN.CN_PUMPLICENSE
55062>>>                        Move Brzones.BRZONE_RECR        to MICN.CN_ZONE
55063>>>
55063>>>                    End
55063>>>>
55063>>>                    SaveRecord MICN
55064>>>                    If (isFound) Unlock
55067>>>
55067>>>                    Reread CN
55071>>>                    Move "SENT" to CN.EXPORTSTATUS
55072>>>                    Sysdate        CN.EXPORTDATE
55073>>>                    SaveRecord CN
55074>>>                    
55074>>>                    //--------------------------------------------------
55074>>>                    //---- AREAS & CITIES (+Cities have TOWNS & COUNTRY)
55074>>>                    //--------------------------------------------------
55074>>>                        Move 0 to isFound
55075>>>                        Integer iAreaID iCityID
55075>>>                        Clear Areas
55076>>>                        Move CN.CN_Area to Areas.AREA_ID
55077>>>                        Find EQ Areas by Index.1
55078>>>>
55078>>>                        If (Found) Begin
55080>>>                            Clear MIAreas
55081>>>                            Move Areas.AREA_DESCR to MIAreas.Area_DESCR
55082>>>                            Find GE MIAreas by Index.2
55083>>>>
55083>>>                            If (not((Found) and (MIAreas.Area_DESCR=Areas.AREA_DESCR))) Begin
55085>>>                                Move (Write_Area(Self,Areas.AREA_DESCR)) to iAreaID
55086>>>                            End
55086>>>>
55086>>>                            Else Move MIAreas.AREA_ID to iAreaID
55088>>>                            If (MiCN.CN_AREA<>iAreaID) Begin
55090>>>                                Reread MICN
55094>>>                                Move iAreaID to MiCN.CN_AREA
55095>>>                                SaveRecord MICN
55096>>>                                Unlock
55097>>>>
55097>>>                            End
55097>>>>
55097>>>                        End
55097>>>>
55097>>>
55097>>>                        Clear Cities
55098>>>                        Move CN.CN_CITY to Cities.City_ID
55099>>>                        Find EQ Cities by Index.1
55100>>>>
55100>>>                        If (Found) Begin
55102>>>                            Clear MICities
55103>>>                            Move Cities.City_DESCR to MICities.City_DESCR
55104>>>                            Find GE MICities by Index.2
55105>>>>
55105>>>                            If (not((Found) and (MICities.City_DESCR=Cities.City_DESCR))) Begin
55107>>>                                Move (Write_City(Self,Cities.City_DESCR)) to iCityID
55108>>>                            End
55108>>>>
55108>>>                            Else Move MICities.City_ID to iCityID
55110>>>                            If (MiCN.CN_CITY<>iCityID) Begin
55112>>>                                Reread MICN
55116>>>                                Move iCityID to MiCN.CN_CITY
55117>>>                                SaveRecord MICN
55118>>>                                Unlock
55119>>>>
55119>>>                            End
55119>>>>
55119>>>                        End
55119>>>>
55119>>>
55119>>>                    //--------------------------------------------------
55119>>>                    //--------------------------------------------------
55119>>>                    Move 0 to isChecked
55120>>>                    Get Checked_State of chkUnmark to isChecked
55121>>>                    If (isChecked>0) Begin
55123>>>                        Reread CN
55127>>>                        Move 0      to CN.EXPORTFLAG
55128>>>                        Move 1      to CN.POLH_RECR
55129>>>//                        Move "SENT" to CN.EXPORTSTATUS
55129>>>//                        Sysdate        CN.EXPORTDATE
55129>>>                        SaveRecord CN
55130>>>                        Unlock
55131>>>>
55131>>>                    End
55131>>>>
55131>>>
55131>>>                    Move 0 to isFound
55132>>>                    Move Constrct.File_Number to iFileNumber
55133>>>                    Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
55136>>>                    Clear Constrct
55137>>>                    Move CN.CN_CNT_ID to Constrct.CNT_ID
55138>>>                    Find EQ Constrct by Index.5
55139>>>>
55139>>>                    If (Found) Begin
55141>>>                        Clear MIConstr
55142>>>                        Move Constrct.CNT_ID to MIConstr.CNT_ID
55143>>>                        Find EQ MIConstr by Index.5
55144>>>>
55144>>>                        If (Found) Move 1 to isFound
55147>>>                        If ((isFound) and (not(Checked_State(chkCNEdit(Self))))) Begin
55149>>>                        End
55149>>>>
55149>>>                        Else Begin
55150>>>                            If (isFound=1) Reread MIConstr
55156>>>                            For FieldIndex from 0 to iFields
55162>>>>
55162>>>                                Move (Trim(Constrct.Recnum&)) to MIConstr.Recnum&
55163>>>                            Loop
55164>>>>
55164>>>                            SaveRecord MIConstr
55165>>>                            If (isFound) Unlock
55168>>>                            //--------------------------------------------------
55168>>>                            //---- AREAS & CITIES (+Cities have TOWNS & COUNTRY)
55168>>>                            //--------------------------------------------------
55168>>>                            //Integer iCityID iAreaID iTownID iCountryID iNewID
55168>>>                            //String sCityDescr sAreaDescr sTownDescr sCountryDescr
55168>>>                            Move 0 to isFound
55169>>>                            Clear Areas
55170>>>                            Move Constrct.CNT_AREA to Areas.AREA_ID
55171>>>                            Find EQ Areas by Index.1
55172>>>>
55172>>>                            If (Found) Begin
55174>>>                                Clear MIAreas
55175>>>                                Move Areas.Area_DESCR to MIAreas.Area_DESCR
55176>>>                                Find GE MIAreas by Index.2
55177>>>>
55177>>>                                If (not((Found) and (MIAreas.Area_DESCR=Areas.Area_DESCR))) Begin
55179>>>                                    Move (Write_Area(Self,Areas.AREA_DESCR)) to iAreaID
55180>>>                                End
55180>>>>
55180>>>                                Else Move MIAreas.AREA_ID to iAreaID
55182>>>                                If (MIConstr.CNT_AREA<>iAreaID) Begin
55184>>>                                    Reread MIConstr
55188>>>                                    Move iAreaID to MIConstr.CNT_AREA
55189>>>                                    SaveRecord MIConstr
55190>>>                                    Unlock
55191>>>>
55191>>>                                End
55191>>>>
55191>>>                            End
55191>>>>
55191>>>
55191>>>                            Clear Cities
55192>>>                            Move Constrct.CNT_CITY to Cities.City_ID
55193>>>                            Find EQ Cities by Index.1
55194>>>>
55194>>>                            If (Found) Begin
55196>>>                                Clear MICities
55197>>>                                Move Cities.CITY_DESCR to MICities.City_DESCR
55198>>>                                Find GE MICities by Index.2
55199>>>>
55199>>>                                If (not((Found) and (MICities.City_DESCR=Cities.CITY_DESCR))) Begin
55201>>>                                    Move (Write_City(Self,Cities.City_DESCR)) to iCityID
55202>>>                                End
55202>>>>
55202>>>                                Else Move MICities.City_ID to iCityID
55204>>>                                If (MIConstr.CNT_CITY<>iCityID) Begin
55206>>>                                    Reread MIConstr
55210>>>                                    Move iCityID to MIConstr.CNT_CITY
55211>>>                                    SaveRecord MIConstr
55212>>>                                    Unlock
55213>>>>
55213>>>                                End
55213>>>>
55213>>>                            End
55213>>>>
55213>>>                            //--------------------------------------------------
55213>>>                            //--------------------------------------------------
55213>>>                        End
55213>>>>
55213>>>                    End
55213>>>>
55213>>>
55213>>>                    Move 0 to isFound
55214>>>                    Move Mhxanik.File_Number to iFileNumber
55215>>>                    Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
55218>>>                    Clear Mhxanik
55219>>>                    Move CN.MHXANIK_ID to Mhxanik.MHX_ID
55220>>>                    Find EQ Mhxanik by Index.4
55221>>>>
55221>>>                    If (Found) Begin
55223>>>                        Clear MIMHXAN
55224>>>                        Move Mhxanik.MHX_ID to MIMhxan.MHX_ID
55225>>>                        Find EQ MIMhxan by Index.4
55226>>>>
55226>>>                        If (Found) Move 1 to isFound
55229>>>                        If ((isFound) and (not(Checked_State(chkCNEdit(Self))))) Begin
55231>>>                        End
55231>>>>
55231>>>                        Else Begin
55232>>>                            If (isFound=1) Reread MIMhxan
55238>>>                            For FieldIndex from 0 to iFields
55244>>>>
55244>>>                                Move (Trim(Mhxanik.Recnum&)) to MIMhxan.Recnum&
55245>>>                            Loop
55246>>>>
55246>>>                            SaveRecord MIMhxan
55247>>>                            If (isFound) Unlock
55250>>>                            //--------------------------------------------------
55250>>>                            //---- AREAS & CITIES (+Cities have TOWNS & COUNTRY)
55250>>>                            //--------------------------------------------------
55250>>>                            //Integer iCityID iAreaID iTownID iCountryID iNewID
55250>>>                            //String sCityDescr sAreaDescr sTownDescr sCountryDescr
55250>>>                            Move 0 to isFound
55251>>>                            Clear Areas
55252>>>                            Move Mhxanik.MHX_AREA to Areas.AREA_ID
55253>>>                            Find EQ Areas by Index.1
55254>>>>
55254>>>                            If (Found) Begin
55256>>>                                Clear MIAreas
55257>>>                                Move Areas.Area_DESCR to MIAreas.Area_DESCR
55258>>>                                Find GE MIAreas by Index.2
55259>>>>
55259>>>                                If (not((Found) and (MIAreas.Area_DESCR=Areas.Area_DESCR))) Begin
55261>>>                                    Move (Write_Area(Self,Areas.AREA_DESCR)) to iAreaID
55262>>>                                End
55262>>>>
55262>>>                                Else Move MIAreas.AREA_ID to iAreaID
55264>>>                                If (MIMhxan.MHX_AREA<>iAreaID) Begin
55266>>>                                    Reread MIMhxan
55270>>>                                    Move iAreaID to MIMhxan.MHX_AREA
55271>>>                                    SaveRecord MIMhxan
55272>>>                                    Unlock
55273>>>>
55273>>>                                End
55273>>>>
55273>>>                            End
55273>>>>
55273>>>
55273>>>                            Clear Cities
55274>>>                            Move Mhxanik.MHX_CITY to Cities.City_ID
55275>>>                            Find EQ Cities by Index.1
55276>>>>
55276>>>                            If (Found) Begin
55278>>>                                Clear MICities
55279>>>                                Move Cities.CITY_DESCR to MICities.City_DESCR
55280>>>                                Find GE MICities by Index.2
55281>>>>
55281>>>                                If (not((Found) and (MICities.City_DESCR=Cities.CITY_DESCR))) Begin
55283>>>                                    Move (Write_City(Self,Cities.City_DESCR)) to iCityID
55284>>>                                End
55284>>>>
55284>>>                                Else Move MICities.City_ID to iCityID
55286>>>                                If (MIMhxan.MHX_CITY<>iCityID) Begin
55288>>>                                    Reread MIMhxan
55292>>>                                    Move iCityID to MIMhxan.MHX_City
55293>>>                                    SaveRecord MIMhxan
55294>>>                                    Unlock
55295>>>>
55295>>>                                End
55295>>>>
55295>>>                            End
55295>>>>
55295>>>                            //--------------------------------------------------
55295>>>                            //--------------------------------------------------
55295>>>                        End
55295>>>>
55295>>>                    End
55295>>>>
55295>>>
55295>>>                    Move 0 to isFound
55296>>>                    Move Salesmen.File_Number to iFileNumber
55297>>>                    Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
55300>>>                    Clear Salesmen
55301>>>                    Move CN.CN_SLS_ID to Salesmen.SLS_ID
55302>>>                    Find EQ Salesmen by Index.4
55303>>>>
55303>>>                    If (Found) Begin
55305>>>                        Clear MISalesm
55306>>>                        Move Salesmen.SLS_ID to MISalesm.SLS_ID
55307>>>                        Find EQ MISalesm by Index.4
55308>>>>
55308>>>                        If (Found) Move 1 to isFound
55311>>>                        If ((isFound) and (not(Checked_State(chkCNEdit(Self))))) Begin
55313>>>                        End
55313>>>>
55313>>>                        Else Begin
55314>>>                            If (isFound=1) Reread MISalesm
55320>>>                            For FieldIndex from 0 to iFields
55326>>>>
55326>>>                                Move (Trim(Salesmen.Recnum&)) to MISalesm.Recnum&
55327>>>                            Loop
55328>>>>
55328>>>                            SaveRecord MISalesm
55329>>>                            If (isFound) Unlock
55332>>>
55332>>>                            //--------------------------------------------------
55332>>>                            //---- AREAS & CITIES (+Cities have TOWNS & COUNTRY)
55332>>>                            //--------------------------------------------------
55332>>>                            //Integer iCityID iAreaID iTownID iCountryID iNewID
55332>>>                            //String sCityDescr sAreaDescr sTownDescr sCountryDescr
55332>>>                            Move 0 to isFound
55333>>>                            Clear Areas
55334>>>                            Move Salesmen.SLS_AREA to Areas.AREA_ID
55335>>>                            Find EQ Areas by Index.1
55336>>>>
55336>>>                            If (Found) Begin
55338>>>                                Clear MIAreas
55339>>>                                Move Areas.Area_DESCR to MIAreas.Area_DESCR
55340>>>                                Find GE MIAreas by Index.2
55341>>>>
55341>>>                                If (not((Found) and (MIAreas.Area_DESCR=Areas.Area_DESCR))) Begin
55343>>>                                    Move (Write_Area(Self,Areas.AREA_DESCR)) to iAreaID
55344>>>                                End
55344>>>>
55344>>>                                Else Move MIAreas.AREA_ID to iAreaID
55346>>>                                If (MISalesm.SLS_AREA<>iAreaID) Begin
55348>>>                                    Reread MISalesm
55352>>>                                    Move iAreaID to MISalesm.SLS_AREA
55353>>>                                    SaveRecord MISalesm
55354>>>                                    Unlock
55355>>>>
55355>>>                                End
55355>>>>
55355>>>                            End
55355>>>>
55355>>>
55355>>>                            Clear Cities
55356>>>                            Move Salesmen.SLS_CITY to Cities.City_ID
55357>>>                            Find EQ Cities by Index.1
55358>>>>
55358>>>                            If (Found) Begin
55360>>>                                Clear MICities
55361>>>                                Move Cities.CITY_DESCR to MICities.City_DESCR
55362>>>                                Find GE MICities by Index.2
55363>>>>
55363>>>                                If (not((Found) and (MICities.City_DESCR=Cities.CITY_DESCR))) Begin
55365>>>                                    Move (Write_City(Self,Cities.City_DESCR)) to iCityID
55366>>>                                End
55366>>>>
55366>>>                                Else Move MICities.City_ID to iCityID
55368>>>                                If (MISalesm.SLS_CITY<>iCityID) Begin
55370>>>                                    Reread MISalesm
55374>>>                                    Move iCityID to MISalesm.SLS_CITY
55375>>>                                    SaveRecord MISalesm
55376>>>                                    Unlock
55377>>>>
55377>>>                                End
55377>>>>
55377>>>                            End
55377>>>>
55377>>>                            //--------------------------------------------------
55377>>>                        End
55377>>>>
55377>>>                    End // If (Found) Begin
55377>>>>
55377>>>                End // If (iSKIPALL=0) Begin
55377>>>>
55377>>>            End // If (iNoCopy=0) Begin
55377>>>>
55377>>>        End_Procedure
55378>>>    End_Object
55379>>>
55379>>>    Object chkUnmark is a CheckBox
55381>>>        Set Size to 10 11
55382>>>        Set Location to 9 62
55383>>>        Set Label to "¥œ£á¡˜¨ž©œ œ§œ¥œ¨š˜©£â¤œª œšš¨˜­âª"
55384>>>        //AB-StoreStart
55384>>>        //Fires whenever the value of the control is changed
55384>>>        //Procedure OnChange
55384>>>        //    Boolean bChecked
55384>>>        //
55384>>>        //    Get Checked_State To bChecked
55384>>>        //End_Procedure // OnChange
55384>>>        //AB-StoreEnd
55384>>>    End_Object
55385>>>
55385>>>    Object chkClients is a CheckBox
55387>>>        Set Size to 10 50
55388>>>        Set Location to 33 62
55389>>>        Set Label to "„§œ¥œ¨š˜©å˜ œ¢˜«é¤"
55390>>>        Set Checked_State to True
55391>>>        //AB-StoreStart
55391>>>        //Fires whenever the value of the control is changed
55391>>>        //Procedure OnChange
55391>>>        //    Boolean bChecked
55391>>>        //
55391>>>        //    Get Checked_State To bChecked
55391>>>        //End_Procedure // OnChange
55391>>>        //AB-StoreEnd
55391>>>    End_Object
55392>>>
55392>>>    Object chkCN is a CheckBox
55394>>>        Set Size to 10 50
55395>>>        Set Location to 33 233
55396>>>        Set Label to "„§œ¥œ¨š˜©å˜ ë¨šà¤"
55397>>>        Set Checked_State to True
55398>>>        //AB-StoreStart
55398>>>        //Fires whenever the value of the control is changed
55398>>>        //Procedure OnChange
55398>>>        //    Boolean bChecked
55398>>>        //
55398>>>        //    Get Checked_State To bChecked
55398>>>        //End_Procedure // OnChange
55398>>>        //AB-StoreEnd
55398>>>    End_Object
55399>>>
55399>>>    Object frmJSBD is a Form
55401>>>        Set Size to 13 70
55402>>>        Set Location to 198 75
55403>>>        Set Label_Col_Offset to 25
55404>>>        Set Password_State to True
55405>>>        Set Label_Row_Offset to 1
55406>>>
55406>>>        Set Enabled_State to False
55407>>>        Set Visible_State to False
55408>>>
55408>>>        //AB-StoreStart
55408>>>        Procedure OnChange
55411>>>            String sStr
55411>>>            Get Value item 0 to sStr
55412>>>            Set Enabled_State of btnDelSMSMI  to (sStr="05091960")
55413>>>            Set Visible_State of btnDelSMSMI  to (sStr="05091960")
55414>>>        End_Procedure
55415>>>        //AB-StoreEnd
55415>>>
55415>>>    End_Object
55416>>>
55416>>>    Object chkClientsEdit is a CheckBox
55418>>>        Set Size to 10 50
55419>>>        Set Location to 47 62
55420>>>        Set Label to "„§å«¨œ¯œ EDIT ©«¦¬ª „Š€’„‘"
55421>>>        //AB-StoreStart
55421>>>        //Fires whenever the value of the control is changed
55421>>>        //Procedure OnChange
55421>>>        //    Boolean bChecked
55421>>>        //
55421>>>        //    Get Checked_State To bChecked
55421>>>        //End_Procedure // OnChange
55421>>>        //AB-StoreEnd
55421>>>    End_Object
55422>>>
55422>>>    Object chkCNEdit is a CheckBox
55424>>>        Set Size to 10 50
55425>>>        Set Location to 47 233
55426>>>        Set Label to "„§å«¨œ¯œ EDIT ©«˜ „‚€"
55427>>>        //AB-StoreStart
55427>>>        //Fires whenever the value of the control is changed
55427>>>        //Procedure OnChange
55427>>>        //    Boolean bChecked
55427>>>        //
55427>>>        //    Get Checked_State To bChecked
55427>>>        //End_Procedure // OnChange
55427>>>        //AB-StoreEnd
55427>>>    End_Object
55428>>>
55428>>>    Object chkAFM is a CheckBox
55430>>>        Set Size to 10 50
55431>>>        Set Location to 99 93
55432>>>        Set Label to "„ ©˜šàšã ™á©ž €”‹ š ˜ œ¢á«œª £œ Valid €”‹"
55433>>>        //AB-StoreStart
55433>>>        //Fires whenever the value of the control is changed
55433>>>        //Procedure OnChange
55433>>>        //    Boolean bChecked
55433>>>        //
55433>>>        //    Get Checked_State To bChecked
55433>>>        //End_Procedure // OnChange
55433>>>        //AB-StoreEnd
55433>>>    End_Object
55434>>>
55434>>>    Object chkNines is a CheckBox
55436>>>        Set Size to 10 50
55437>>>        Set Location to 115 93
55438>>>        Set Label to "€”‹ - „¥˜å¨œ©œ 999999"
55439>>>        //AB-StoreStart
55439>>>        //Fires whenever the value of the control is changed
55439>>>        //Procedure OnChange
55439>>>        //    Boolean bChecked
55439>>>        //
55439>>>        //    Get Checked_State To bChecked
55439>>>        //End_Procedure // OnChange
55439>>>        //AB-StoreEnd
55439>>>    End_Object
55440>>>
55440>>>    Object chkZeroes is a CheckBox
55442>>>        Set Size to 10 50
55443>>>        Set Location to 115 203
55444>>>        Set Label to "€”‹ - „¥˜å¨œ©œ 000000"
55445>>>        //AB-StoreStart
55445>>>        //Fires whenever the value of the control is changed
55445>>>        //Procedure OnChange
55445>>>        //    Boolean bChecked
55445>>>        //
55445>>>        //    Get Checked_State To bChecked
55445>>>        //End_Procedure // OnChange
55445>>>        //AB-StoreEnd
55445>>>    End_Object
55446>>>
55446>>>    Object chkStars is a CheckBox
55448>>>        Set Size to 10 50
55449>>>        Set Location to 131 93
55450>>>        Set Label to "€”‹ - „¥˜å¨œ©œ *"
55451>>>        //AB-StoreStart
55451>>>        //Fires whenever the value of the control is changed
55451>>>        //Procedure OnChange
55451>>>        //    Boolean bChecked
55451>>>        //
55451>>>        //    Get Checked_State To bChecked
55451>>>        //End_Procedure // OnChange
55451>>>        //AB-StoreEnd
55451>>>    End_Object
55452>>>
55452>>>    Object chkBlanks is a CheckBox
55454>>>        Set Size to 10 50
55455>>>        Set Location to 131 203
55456>>>        Set Label to "€”‹ - „¥˜å¨œ©œ ¡œ¤á"
55457>>>        //AB-StoreStart
55457>>>        //Fires whenever the value of the control is changed
55457>>>        //Procedure OnChange
55457>>>        //    Boolean bChecked
55457>>>        //
55457>>>        //    Get Checked_State To bChecked
55457>>>        //End_Procedure // OnChange
55457>>>        //AB-StoreEnd
55457>>>    End_Object
55458>>>
55458>>>    Object chkCNnoClient is a CheckBox
55460>>>        Set Size to 10 50
55461>>>        Set Location to 61 233
55462>>>        Set Label to "„§å«¨œ¯œ „‚€ ®à¨åª ¤˜ â®œ  ™¨œŸœå œ¢á«žª"
55463>>>        //AB-StoreStart
55463>>>        //Fires whenever the value of the control is changed
55463>>>        //Procedure OnChange
55463>>>        //    Boolean bChecked
55463>>>        //
55463>>>        //    Get Checked_State To bChecked
55463>>>        //End_Procedure // OnChange
55463>>>        //AB-StoreEnd
55463>>>    End_Object
55464>>>
55464>>>    Object oTextBox1 is a TextBox
55466>>>        Set Size to 50 10
55467>>>        Set Location to 70 243
55468>>>        Set Label to "(‡˜ ˜¤¦ ®«œå ¦ œ¢á«žª œ˜¤ ®¨œ ˜©«œå)"
55469>>>        Set TextColor to 2425272
55470>>>    End_Object
55471>>>
55471>>>    Object chkDebug is a CheckBox
55473>>>        Set Size to 10 50
55474>>>        Set Location to 161 145
55475>>>        Set Label to "šá¢œ ‹ž¤ç£˜«˜ ©«ž¤ ¦Ÿæ¤ž"
55476>>>        //AB-StoreStart
55476>>>        //Fires whenever the value of the control is changed
55476>>>        //Procedure OnChange
55476>>>        //    Boolean bChecked
55476>>>        //
55476>>>        //    Get Checked_State To bChecked
55476>>>        //End_Procedure // OnChange
55476>>>        //AB-StoreEnd
55476>>>    End_Object
55477>>>
55477>>>End_Object
55478>>>
55478>>>//AB/ End_Object    // prj
55478>        Use MI_Migrate_DEOP_Send_To_Master_NEW.vw
Including file: MI_Migrate_DEOP_Send_To_Master_NEW.vw    (L:\VDF14.1.Dev\TITAN_MIGRATE\AppSrc\MI_Migrate_DEOP_Send_To_Master_NEW.vw)
55478>>>
55478>>>Use DBVIEW.SUB
55478>>>
55478>>>//AB/ Project Data Entry View
55478>>>//AB/ Object prj is a View_Project
55478>>>//AB/     Set Size to 230 325
55478>>>
55478>>>//Open SYSCURXR
55478>>>//Open COMPANY
55478>>>
55478>>>Use File_dlg.pkg
55478>>>Use cComDPDLG.pkg
55478>>>Use cComXFIND.pkg
55478>>>Use BUTTON.Sub
55478>>>Use Windows.pkg
55478>>>
55478>>>
55478>>>Activate_View Activate_MI_Migrate_DEOP_Send_To_Master_NEW for MI_Migrate_DEOP_Send_To_Master_NEW
55488>>>>
55488>>>Object MI_Migrate_DEOP_Send_To_Master_NEW is a dbView
55490>>>
55490>>>    Set Border_Style to Border_Thick
55491>>>    Set Size to 119 411
55492>>>    Set Location to 15 14
55493>>>
55493>>>    Property Integer piChoice public 0
55495>>>
55495>>>
55495>>>    Set Label to "€§¦©«¦¢ã ƒ„Ž ˜§¦ ‹¦¤á›˜ ©«ž¤ „¤¦§¦ ž£â¤ž á©ž"
55496>>>    Set Color to 14742506
55497>>>
55497>>>    On_Key Key_Alt+Key_O Send OpenMe
55498>>>
55498>>>    Procedure OpenMe
55501>>>        Integer iState
55501>>>        Get Visible_State of frmJSBD        to iState
55502>>>        Set Visible_State of frmJSBD        to (1-iState)
55503>>>        Set Enabled_State of frmJSBD        to (1-iState)
55504>>>        //Set Visible_State of btnDelSMSMI    to (1-iState)
55504>>>        //Set Enabled_State of btnDelSMSMI    to (1-iState)
55504>>>    End_Procedure
55505>>>
55505>>>
55505>>>    Procedure Activate_View Returns Integer
55508>>>        Integer rVal
55508>>>        String  sFolderInitial
55508>>>        Forward Get Msg_Activate_View to rVal
55510>>>        Set Value of frmJSBD to ""
55511>>>        Procedure_Return rVal
55512>>>    End_Procedure
55513>>>     
55513>>>    Use chartranslate.pkg
55513>>>
55513>>>    Object btnDelSMSMI is a ButtonSub
55515>>>        Set Size to 14 171
55516>>>        Set Location to 99 139
55517>>>        Set Label to "Delete ALL DEOP in SMSMI"
55518>>>
55518>>>        Set Enabled_State to False
55519>>>        Set Visible_State to False
55520>>>
55520>>>            //AB-StoreStart
55520>>>            Procedure OnClick
55523>>>                Open MIORDH     Mode DF_EXCLUSIVE
55525>>>                Open MIORDD     Mode DF_EXCLUSIVE
55527>>>                ZeroFile MIORDH
55528>>>                ZeroFile MIORDD
55529>>>                Open MIORDH     Mode DF_SHARE
55531>>>                Open MIORDD     Mode DF_SHARE
55533>>>            End_Procedure // OnClick
55534>>>            //AB-StoreEnd
55534>>>    End_Object
55535>>>
55535>>>
55535>>>    Object frmJSBD is a Form
55537>>>        Set Size to 13 70
55538>>>        Set Location to 99 56
55539>>>        Set Label_Col_Offset to 25
55540>>>        Set Password_State to True
55541>>>        Set Label_Row_Offset to 1
55542>>>
55542>>>        Set Enabled_State to False
55543>>>        Set Visible_State to False
55544>>>
55544>>>        //AB-StoreStart
55544>>>        Procedure OnChange
55547>>>            String sStr
55547>>>            Get Value item 0 to sStr
55548>>>            Set Enabled_State of btnDelSMSMI  to (sStr="05091960")
55549>>>            Set Visible_State of btnDelSMSMI  to (sStr="05091960")
55550>>>        End_Procedure
55551>>>        //AB-StoreEnd
55551>>>
55551>>>    End_Object
55552>>>
55552>>>
55552>>>    Object btnSub2 is a Button
55554>>>        Set Size to 20 383
55555>>>        Set Location to 67 11
55556>>>        Set Label to "€§¦©«¦¢ã"
55557>>>
55557>>>        Procedure OnClick
55560>>>            Date dExportDate
55560>>>            String sMess sExportStatus sCountMess sPrespID
55560>>>            String sFilename sLabel sClientCode sClientRecr sClientAFM sCNRecr
55560>>>            Integer bIsCreated iWhat iVal isGood iCnt iFS iExportFlag
55560>>>            Integer iFileNumber iFields iField_Type iRecn ichkDebug ichkNoCN
55560>>>
55560>>>            Get Label to sLabel
55561>>>            Get Checked_State of chkDebug to ichkDebug
55562>>>
55562>>>            Move 0 to iCnt
55563>>>            Move "" to sClientCode
55564>>>
55564>>>            File_Size CN to iFS
55567>>>            Clear CN
55568>>>            Find GE CN.RECNUM
55569>>>>
55569>>>            While (Found)
55573>>>                Add 1 to iCnt
55574>>>                Move ("CN... "+String(iCnt)+" / "+String(iFS)) to sMess
55575>>>                Set Label to sMess
55576>>>
55576>>>                Integer iNoClientAllowed iNoCopy
55576>>>                Move 0 to iNoCopy
55577>>>
55577>>>                Clear CLIENTS
55578>>>                Move CN.CLIENT_ID to Clients.CLIENT_ID
55579>>>                Find Eq CLIENTS by Index.6
55580>>>>
55580>>>
55580>>>                If ( (Clients.EXPORTFLAG=1) and ((CN.EXPORTFLAG=1) or (Trim(CN.POLH_RECR)='1')) ) Begin
55582>>>                    
55582>>>                    String sRecr sCNCode
55582>>>                    Date dLastCreated
55582>>>                    Move "" to sRecr
55583>>>                    Move "" to sCNCode
55584>>>                    Move "" to dLastCreated
55585>>>                    Clear BtnOrdH
55586>>>                    Move CN.CN_CODE to BtnOrdH.CN_CODE
55587>>>                    Find GE BtnOrdH by Index.3
55588>>>>
55588>>>                    While ((Found) and (BtnOrdH.CN_CODE=CN.CN_CODE))
55592>>>                        If ((BtnOrdH.DEOP_ACTIVE=0) and (BTNORDH.LOCKED=1)) Begin
55594>>>                            If (Btnordh.DATE_CREATE>dLastCreated) Begin
55596>>>                                Move Btnordh.DATE_CREATE    to dLastCreated 
55597>>>                                Move BtnOrdh.CN_CODE        to sCNCode
55598>>>                                Move BtnOrdh.RECR           to sRecr
55599>>>                            End
55599>>>>
55599>>>                        End
55599>>>>
55599>>>                        Find GT BtnOrdH by Index.3
55600>>>>
55600>>>                    Loop
55601>>>>
55601>>>                    
55601>>>                    Clear BtnOrdH
55602>>>                    Move sCNCode    to BtnOrdH.CN_CODE
55603>>>                    Move sRecr      to BtnOrdH.RECR
55604>>>                    Find EQ BtnOrdH by Index.3
55605>>>>
55605>>>                    If (Found) Begin
55607>>>                        Move 1 to isGood
55608>>>
55608>>>                        Clear MICN
55609>>>                        Move CN.CN_CODE to MICN.CN_CODE
55610>>>                        Find Eq MICN by Index.5
55611>>>>
55611>>>                        If (not(Found)) Begin
55613>>>                            If (ichkDebug) Begin
55615>>>                                Showln "---"
55617>>>                                Showln "œ¢á«žª: " Clients.CLIENT_ID  "  ƒ„Ž:" BtnOrdH.AA_DEOP "  ë¨š¦:" CN.CN_CODE
55624>>>                                Showln "ƒœ¤ ™¨âŸž¡œ «¦ â¨š¦ ©«ž¤ SMSMI / MICN ¡˜  ƒœ¤ £œ«˜­â¨Ÿž¡˜¤ «˜ ˜¤«å©«¦ ®˜ ƒ„Ž"
55626>>>                                Move 0 to isGood
55627>>>                            End
55627>>>>
55627>>>                        End
55627>>>>
55627>>>
55627>>>                        If (isGood=1) Begin
55629>>>                            Move MICN.CLIENT_ID     to sClientCode
55630>>>                            Move MICN.CLIENT_RECR   to sClientRecr
55631>>>                            Move MICN.CN_RECR       to sCNRecr
55632>>>
55632>>>                            Clear MIORDH
55633>>>                            Move BtnOrdH.VBranch    to MIORDH.VBranch
55634>>>                            Move BtnOrdH.AA_DEOP    to MIORDH.AA_DEOP
55635>>>                            Find EQ MIORDH by Index.1
55636>>>>
55636>>>                            If (Found) Begin
55638>>>                                Clear MIORDD
55639>>>                                Move MIORDH.RECR to MIORDD.BTNORDH_RECR
55640>>>                                Find GE MIORDD by Index.1
55641>>>>
55641>>>                                While ((Found) and (MIORDD.BTNORDH_RECR=MIORDH.RECR))
55645>>>                                    Delete MIORDD
55646>>>                                    Find GT MIORDD by Index.1
55647>>>>
55647>>>                                Loop
55648>>>>
55648>>>                                Delete MIORDH
55649>>>                            End
55649>>>>
55649>>>
55649>>>                            Move BtnOrdH.File_Number to iFileNumber
55650>>>                            Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
55653>>>                            Clear MIORDH
55654>>>                            For FieldIndex from 0 to iFields
55660>>>>
55660>>>                                Move (Trim(BtnOrdH.Recnum&)) to MIORDH.Recnum&
55661>>>                            Loop
55662>>>>
55662>>>                            Move sClientCode    to MIORDH.CLIENT_ID
55663>>>                            Move sCNRecr        to MIORDH.CN_RECR
55664>>>                            SaveRecord MIORDH
55665>>>
55665>>>                            Move BtnOrdD.File_Number to iFileNumber
55666>>>                            Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
55669>>>                            Clear BTNORDD
55670>>>                            Move BTNOrdH.RECR to BTNOrdD.BTNORDH_RECR
55671>>>                            Find GE BTNORDD by Index.1
55672>>>>
55672>>>                            While ((Found) and (BTNOrdD.BTNORDH_RECR=BTNOrdH.RECR))
55676>>>                                Clear MIORDD
55677>>>                                For FieldIndex from 0 to iFields
55683>>>>
55683>>>                                    Move (Trim(BtnOrdD.Recnum&)) to MIORDD.Recnum&
55684>>>                                Loop
55685>>>>
55685>>>                                Move MIORDH.RECR to MIORDD.BTNORDH_RECR
55686>>>                                Clear item
55687>>>                                Move MIORDD.VITEM to item.ITEM_CODE
55688>>>                                Find Eq item by Index.5
55689>>>>
55689>>>                                If (not(Found)) Begin
55691>>>                                    Showln "¨æ™¢ž£˜ „ç¨œ©žª «¦¬ „å›¦¬ª:" (Trim(MIORDD.VITEM)) "   ‘­á¢£˜ 6891"
55695>>>                                End
55695>>>>
55695>>>                                If (item.WAPOKAT_CODE=Sysfile.WAPOKAT_ETOIMA) Move 1 to MIORDD.ITEM_TI_EINAI
55698>>>                                Else If (UPPERCASE(Left(MIORDD.VITEM,1))="P") Move 2 to MIORDD.ITEM_TI_EINAI
55702>>>                                Else If           (Left(MIORDD.VITEM,1) ="Š") Move 3 to MIORDD.ITEM_TI_EINAI
55706>>>                                Else If           (Left(MIORDD.VITEM,1) ="¢") Move 3 to MIORDD.ITEM_TI_EINAI
55710>>>                                SaveRecord MIORDD
55711>>>                                Find GT BTNORDD by Index.1
55712>>>>
55712>>>                            Loop
55713>>>>
55713>>>                        End // If (isGood) MICN
55713>>>>
55713>>>                    End // If (Found) Begin
55713>>>>
55713>>>                End // If ( (Clients.EXPORTFLAG=1) and ((CN.EXPORTFLAG=1) or (Trim(CN.POLH_RECR)='1')) ) Begin
55713>>>>
55713>>>                Find GT CN.RECNUM
55714>>>>
55714>>>            Loop
55715>>>>
55715>>>            Set Label to sLabel
55716>>>            Send Info_Box "Process Finished" "Information"
55717>>>        End_Procedure // OnClick
55718>>>
55718>>>    End_Object
55719>>>
55719>>>    Object chkDebug is a CheckBox
55721>>>        Set Size to 10 12
55722>>>        Set Location to 45 111
55723>>>        Set Checked_State to True
55724>>>        //AB-StoreStart
55724>>>        //Fires whenever the value of the control is changed
55724>>>        //Procedure OnChange
55724>>>        //    Boolean bChecked
55724>>>        //
55724>>>        //    Get Checked_State To bChecked
55724>>>        //End_Procedure // OnChange
55724>>>        //AB-StoreEnd
55724>>>    End_Object
55725>>>
55725>>>    Object chkNoCN is a CheckBox
55727>>>        Set Size to 10 9
55728>>>        Set Location to 16 111
55729>>>        //AB-StoreStart
55729>>>        //Fires whenever the value of the control is changed
55729>>>        //Procedure OnChange
55729>>>        //    Boolean bChecked
55729>>>        //
55729>>>        //    Get Checked_State To bChecked
55729>>>        //End_Procedure // OnChange
55729>>>        //AB-StoreEnd
55729>>>    End_Object
55730>>>
55730>>>    Object oTextBox1 is a TextBox
55732>>>        Set Auto_Size_State to False
55733>>>        Set Size to 17 163
55734>>>        Set Location to 17 131
55735>>>        Set Label to "„§œ¥œ¨š˜©å˜ î¢à¤ «à¤ „¤œ¨šé¤ ƒ„Ž ®à¨åª â¢œš®¦ ˜¤ «¦ â¨š¦ œå¤˜  £˜¨¡˜¨ ©£â¤¦"
55736>>>        Set Justification_Mode to JMode_Left
55737>>>        Set FontWeight to 600
55738>>>    End_Object
55739>>>
55739>>>    Object oTextBox2 is a TextBox
55741>>>        Set Size to 50 10
55742>>>        Set Location to 45 131
55743>>>        Set Label to "šá¢œ ‹ž¤ç£˜«˜ ©«ž¤ ¦Ÿæ¤ž"
55744>>>    End_Object
55745>>>
55745>>>End_Object
55746>>>
55746>>>//AB/ End_Object    // prj
55746>        Use DEOP.vw
Including file: DEOP.vw    (L:\VDF14.1.Dev\TITAN_MIGRATE\AppSrc\DEOP.vw)
55746>>>// L:\VDF14.1.Dev\TITAN_MIGRATE\AppSrc\ClientsCN.vw
55746>>>// ClientsCN
55746>>>//
55746>>>
55746>>>Use DFClient.pkg
55746>>>Use DFEntry.pkg
55746>>>Use DfTable.pkg
55746>>>Use Micities.dd
55746>>>Use Miareas.dd
55746>>>Use Mipresp.dd
55746>>>Use Miclient.dd
55746>>>Use Miconstr.dd
55746>>>Use Misalesm.dd
55746>>>Use Mimhxan.dd
55746>>>Use Micn.dd
55746>>>Use Miordh.dd
Including file: MIORDH.DD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MIORDH.DD)
55746>>>>>Use DataDict.pkg
55746>>>>>
55746>>>>>Open MIORDH
55748>>>>>Open MIORDD
55750>>>>>Open MICN
55752>>>>>
55752>>>>>Class Miordh is a DataDictionary
55753>>>>>    
55753>>>>>    Procedure Construct_Object
55755>>>>>        Forward Send Construct_Object
55757>>>>>        Set Main_file to MIORDH.File_Number
55758>>>>>
55758>>>>>        Set Add_Server_File to MICN.File_Number
55759>>>>>
55759>>>>>        Set Add_Client_File to MIORDD.File_Number
55760>>>>>
55760>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
55761>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
55762>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
55763>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
55764>>>>>
55764>>>>>    End_Procedure
55765>>>>>
55765>>>>>End_Class
55766>>>Use Miordd.dd
Including file: MIORDD.DD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MIORDD.DD)
55766>>>>>Use DataDict.pkg
55766>>>>>
55766>>>>>Open MIORDD
55768>>>>>Open MIORDH
55770>>>>>
55770>>>>>Class Miordd is a DataDictionary
55771>>>>>    
55771>>>>>    Procedure Construct_Object
55773>>>>>        Forward Send Construct_Object
55775>>>>>        Set Main_file to MIORDD.File_Number
55776>>>>>
55776>>>>>        Set Add_Server_File to MIORDH.File_Number
55777>>>>>
55777>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
55778>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
55779>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
55780>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
55781>>>>>
55781>>>>>    End_Procedure
55782>>>>>
55782>>>>>End_Class
55783>>>
55783>>>Activate_View Activate_DEOP_View for DEOP_View
55793>>>>
55793>>>Object DEOP_View is a dbView
55795>>>    Object oMimhxan_DD is a Mimhxan
55797>>>    End_Object
55798>>>
55798>>>    Object oMisalesm_DD is a Misalesm
55800>>>    End_Object
55801>>>
55801>>>    Object oMiconstr_DD is a Miconstr
55803>>>    End_Object
55804>>>
55804>>>    Object oMipresp_DD is a Mipresp
55806>>>    End_Object
55807>>>
55807>>>    Object oMiareas_DD is a Miareas
55809>>>    End_Object
55810>>>
55810>>>    Object oMicities_DD is a Micities
55812>>>    End_Object
55813>>>
55813>>>    Object oMiclient_DD is a Miclient
55815>>>        Set DDO_Server to oMipresp_DD
55816>>>        Set DDO_Server to oMiareas_DD
55817>>>        Set DDO_Server to oMicities_DD
55818>>>    End_Object
55819>>>
55819>>>    Object oMicn_DD is a Micn
55821>>>        Set DDO_Server to oMimhxan_DD
55822>>>        Set DDO_Server to oMisalesm_DD
55823>>>        Set DDO_Server to oMiconstr_DD
55824>>>        Set DDO_Server to oMiclient_DD
55825>>>    End_Object
55826>>>
55826>>>    Object oMiordh_DD is a Miordh
55828>>>        Set Constrain_file to MICN.File_number
55829>>>        Set DDO_Server to oMicn_DD
55830>>>    End_Object
55831>>>
55831>>>    Object oMiordd_DD is a Miordd
55833>>>        Set Constrain_file to MIORDH.File_number
55834>>>        Set DDO_Server to oMiordh_DD
55835>>>    End_Object
55836>>>
55836>>>    Set Main_DD to oMicn_DD
55837>>>    Set Server to oMicn_DD
55838>>>
55838>>>    Set Location to 5 5
55839>>>    Set Size to 363 560
55840>>>    Set Label to "ƒ„Ž "
55841>>>    Set Border_Style to Border_Thick
55842>>>
55842>>>
55842>>>    //-----------------------------------------------------------------------
55842>>>    // Create custom confirmation messages for save and delete
55842>>>    // We must create the new functions and assign verify messages
55842>>>    // to them.
55842>>>    //-----------------------------------------------------------------------
55842>>>
55842>>>    Function ConfirmDeleteHeader Returns Boolean
55845>>>        Boolean bFail
55845>>>        Get Confirm "Delete Entire Header and all detail?" to bFail
55846>>>        Function_Return bFail
55847>>>    End_Function // ConfirmDeleteHeader
55848>>>
55848>>>    // Only confirm on the saving of new records
55848>>>    Function ConfirmSaveHeader Returns Boolean
55851>>>        Boolean bNoSave bHasRecord
55851>>>        Handle  hoSrvr
55851>>>        Get Server to hoSrvr
55852>>>        Get HasRecord of hoSrvr to bHasRecord
55853>>>        If not bHasRecord Begin
55855>>>            Get Confirm "Save this NEW header?" to bNoSave
55856>>>        End
55856>>>>
55856>>>        Function_Return bNoSave
55857>>>    End_Function // ConfirmSaveOrder
55858>>>
55858>>>    // Define alternate confirmation Messages
55858>>>    Set Verify_Save_MSG       to GET_ConfirmSaveHeader
55859>>>    Set Verify_Delete_MSG     to GET_ConfirmDeleteHeader
55860>>>
55860>>>    Object oDbGrid1 is a dbGrid
55862>>>        Set Size to 121 550
55863>>>        Set Location to 107 5
55864>>>
55864>>>        Begin_Row
55867>>>            Entry_Item MIORDH.AA_DEOP
55868>>>            Entry_Item MIORDH.CN_CODE
55869>>>            Entry_Item MIORDH.CLIENT_ID
55870>>>            Entry_Item MIORDH.DEOP_DATE
55871>>>            Entry_Item MIORDH.DEOP_LHXH
55872>>>        End_Row
55877>>>
55877>>>        Set Main_File to MIORDH.File_number
55878>>>
55878>>>        Set Server to oMiordh_DD
55879>>>
55879>>>        Set Form_Width 0 to 150
55880>>>        Set Header_Label 0 to "AA DEOP"
55881>>>        Set Form_Width 1 to 120
55882>>>        Set Header_Label 1 to "CN CODE"
55883>>>        Set Form_Width 2 to 120
55884>>>        Set Header_Label 2 to "CLIENT ID"
55885>>>        Set Form_Width 3 to 60
55886>>>        Set Header_Label 3 to "DEOP DATE"
55887>>>        Set Form_Width 4 to 60
55888>>>        Set Header_Label 4 to "DEOP LHXH"
55889>>>    End_Object
55890>>>
55890>>>    Object oDbGrid2 is a dbGrid
55892>>>        Set Size to 115 550
55893>>>        Set Location to 238 5
55894>>>
55894>>>        Begin_Row
55897>>>            Entry_Item MIORDD.VITEM
55898>>>            Entry_Item MIORDD.VITEM_DESCR
55899>>>            Entry_Item MIORDD.VQTY
55900>>>            Entry_Item MIORDD.VUNITPRICE
55901>>>        End_Row
55906>>>
55906>>>        Set Main_File to MIORDD.File_number
55907>>>
55907>>>        Set Server to oMiordd_DD
55908>>>
55908>>>        Set Form_Width 0 to 120
55909>>>        Set Header_Label 0 to "VITEM"
55910>>>        Set Form_Width 1 to 180
55911>>>        Set Header_Label 1 to "VITEM DESCR"
55912>>>        Set Form_Width 2 to 96
55913>>>        Set Header_Label 2 to "VQTY"
55914>>>        Set Form_Width 3 to 108
55915>>>        Set Header_Label 3 to "VUNITPRICE"
55916>>>    End_Object
55917>>>
55917>>>    Object oMICN_CLIENT_ID is a dbForm
55919>>>        Entry_Item MICN.CLIENT_ID
55920>>>
55920>>>        Set Server to oMicn_DD
55921>>>        Set Location to 6 66
55922>>>        Set Size to 13 126
55923>>>        Set Label to "CLIENT ID:"
55924>>>        Set Enabled_State to False
55925>>>    End_Object
55926>>>
55926>>>    Object oMICN_CN_CODE is a dbForm
55928>>>        Entry_Item MICN.CN_CODE
55929>>>
55929>>>        Set Server to oMicn_DD
55930>>>        Set Location to 24 66
55931>>>        Set Size to 13 126
55932>>>        Set Label to "CN CODE:"
55933>>>    End_Object
55934>>>
55934>>>    Object oMICN_CN_DESCR is a dbForm
55936>>>        Entry_Item MICN.CN_DESCR
55937>>>
55937>>>        Set Server to oMicn_DD
55938>>>        Set Location to 39 66
55939>>>        Set Size to 13 279
55940>>>        Set Label to "CN DESCR:"
55941>>>    End_Object
55942>>>
55942>>>    Object oMICN_CN_ADDRESS is a dbForm
55944>>>        Entry_Item MICN.CN_ADDRESS
55945>>>
55945>>>        Set Server to oMicn_DD
55946>>>        Set Location to 54 66
55947>>>        Set Size to 13 279
55948>>>        Set Label to "CN ADDRESS:"
55949>>>    End_Object
55950>>>
55950>>>    Object oMICN_CN_START_DATE is a dbForm
55952>>>        Entry_Item MICN.CN_START_DATE
55953>>>
55953>>>        Set Server to oMicn_DD
55954>>>        Set Location to 69 66
55955>>>        Set Size to 13 66
55956>>>        Set Label to "CN START DATE:"
55957>>>    End_Object
55958>>>
55958>>>    Object oMICN_CN_END_DATE is a dbForm
55960>>>        Entry_Item MICN.CN_END_DATE
55961>>>
55961>>>        Set Server to oMicn_DD
55962>>>        Set Location to 84 66
55963>>>        Set Size to 13 66
55964>>>        Set Label to "CN END DATE:"
55965>>>    End_Object
55966>>>
55966>>>    Object oMICLIENT_CLIENT_NAME is a dbForm
55968>>>        Entry_Item MICLIENT.CLIENT_NAME
55969>>>        Set Location to 6 259
55970>>>        Set Size to 13 281
55971>>>        Set Label to "CLIENT NAME:"
55972>>>        Set Enabled_State to False
55973>>>    End_Object
55974>>>
55974>>>    Object oMICN_EXPORTFLAG is a dbForm
55976>>>        Entry_Item MICN.EXPORTFLAG
55977>>>        Set Location to 84 217
55978>>>        Set Size to 13 18
55979>>>        Set Label to "EXPORTFLAG:"
55980>>>    End_Object
55981>>>
55981>>>    //-------------------------------------------------------------------
55981>>>    //  Table entry checking - attempt to save header record
55981>>>    //  before entering a table (this is called by table. Return
55981>>>    //  a non-zero if the save failed (i.e., do not enter table)
55981>>>    //-------------------------------------------------------------------
55981>>>
55981>>>    Function SaveHeader Returns Boolean
55984>>>        Integer iRec
55984>>>        Boolean bChanged bHasRecord
55984>>>        Handle  hoSrvr
55984>>>
55984>>>        Get Server to hoSrvr                   // The Header DDO.
55985>>>        Get HasRecord of hoSrvr to bHasRecord  // Is there a record?
55986>>>        Get Should_Save to bChanged            // Are there any current changes?
55987>>>
55987>>>        // If there is no record and no changes we have an error.
55987>>>        If (not(bHasRecord) AND not(bChanged) ) Begin  // no rec
55989>>>            Error DfErr_Operator "You must First Create & Save the Header"
55990>>>>
55990>>>            Function_Return True
55991>>>        End
55991>>>>
55991>>>
55991>>>        // Attempt to Save the current Record
55991>>>        // request_save_no_clear does a save without clearing.
55991>>>        Send Request_Save_No_Clear
55992>>>
55992>>>        // The save succeeded if there are now no changes, and we
55992>>>        // have a saved record. Should_save tells us if we've got changes.
55992>>>        // We must check the DDO's HasRecord property to see if
55992>>>        // we have a record. If it is false, we had no save.
55992>>>        Get Should_Save to bChanged  // is a save still needed
55993>>>        Get HasRecord of hoSrvr to bHasRecord // is there a record after the save?
55994>>>        // if no record or changes still exist, return an error code of 1
55994>>>        If (not(bHasRecord) OR (bChanged)) begin
55996>>>            Function_Return true
55997>>>        End
55997>>>>
55997>>>    End_Function // SaveHeader
55998>>>
55998>>>
55998>>>
55998>>>End_Object
55999>        Use UpdateZonesForCN.vw
Including file: UpdateZonesForCN.vw    (L:\VDF14.1.Dev\TITAN_MIGRATE\AppSrc\UpdateZonesForCN.vw)
55999>>>
55999>>>Use DBVIEW.SUB
55999>>>
55999>>>//AB/ Project Data Entry View
55999>>>//AB/ Object prj is a View_Project
55999>>>//AB/     Set Size to 230 325
55999>>>
55999>>>Deferred_View Activate_UpdateZonesForCN for ;;Object UpdateZonesForCN is a dbView
56024>>>
56024>>>    Set Border_Style to Border_Thick
56025>>>    Set Size to 91 411
56026>>>    Set Location to 10 14
56027>>>    Set Label to "„¤ž£â¨à©ž ¨æ©Ÿœ«à¤ œ›åà¤ „‚—Œ £œ «ž¤ …é¤ž ©«ž¤ ¦§¦å˜ ˜¤ã¡¦¬¤"
56028>>>
56028>>>    Object btnSub2 is a Button
56030>>>        Set Size to 20 383
56031>>>        Set Location to 47 11
56032>>>        Set Label to "„¤ž£â¨à©ž"
56033>>>
56033>>>
56033>>>        Procedure OnClick
56036>>>            Integer iCnt iFS iExportFlag iRecn
56036>>>            Integer iFileNumber iFields iField_Type
56036>>>            String  sFullName sFileName sStr sPedio sLabel sName sMess
56036>>>            String sSLS sCNT sMHX
56036>>>            Integer isFound ByPass ichkCNnoClient ichkDebug iSKIPALL
56036>>>
56036>>>            Get Label to sLabel
56037>>>            Move 0 to iCnt
56038>>>            
56038>>>            File_Size Clients to iFS
56041>>>
56041>>>            Clear CLIENTS
56042>>>            Find GE CLIENTS.Recnum
56043>>>>
56043>>>            While (Found)
56047>>>                Add 1 to iCnt
56048>>>                Move (String(iCnt)+"/"+String(iFS)) to sMess
56049>>>                Set Label to (Trim(sMess))
56050>>>
56050>>>                If (Clients.EXPORTFLAG=1) Begin
56052>>>                    Clear CN
56053>>>                    Move Clients.CLIENT_ID to CN.CLIENT_ID
56054>>>                    Find GE CN by Index.4
56055>>>>
56055>>>                    While ((Found) and (CN.CLIENT_ID=Clients.CLIENT_ID))
56059>>>                        If (CN.EXPORTFLAG=1) Begin
56061>>>                            Clear MICN
56062>>>                            Move CN.CN_Code to MICN.CN_CODE
56063>>>                            Find Eq MICN by Index.5
56064>>>>
56064>>>                            If (Found) Begin
56066>>>                                Clear CNZONES
56067>>>                                Move CN.CN_CODE to CNZONES.CN_CODE
56068>>>                                Find GE CNZONES by Index.1
56069>>>>
56069>>>                                If ((Found=1) and (CN.CN_CODE=CNZONES.CN_CODE)) Begin
56071>>>                                    Clear BRZONES
56072>>>                                    Move CNZONES.BRZONE_RECR to BRZONES.BRZONE_RECR
56073>>>                                    Find Eq BRZONES by Index.2
56074>>>>
56074>>>                                    If (Found) Begin
56076>>>                                        Clear ZONES
56077>>>                                        Move BRZONES.ZONE_ID to Zones.ZONE_ID
56078>>>                                        Find Eq ZONES by Index.1 
56079>>>>
56079>>>                                        If (Found) Begin
56081>>>                                            //Showln "<<>><<>><<>>"
56081>>>                                            Reread MICN
56085>>>                                            Move (Trim(Zones.ZONE_DESCR))   to MICN.CN_VDETAILS
56086>>>                                            Move Zones.ZONE_ID              to MICN.CN_CLIENTMATCH  // MICN.CN_PUMPLICENSE
56087>>>                                            Move Brzones.BRZONE_RECR        to MICN.CN_ZONE
56088>>>                                            SaveRecord MICN
56089>>>                                            Unlock
56090>>>>
56090>>>                                        End
56090>>>>
56090>>>                                    End
56090>>>>
56090>>>                                End                        
56090>>>>
56090>>>                            End                    
56090>>>>
56090>>>                        End
56090>>>>
56090>>>                        Find GT CN by Index.4
56091>>>>
56091>>>                    Loop
56092>>>>
56092>>>                End
56092>>>>
56092>>>                Find GT CLIENTS.Recnum
56093>>>>
56093>>>            Loop
56094>>>>
56094>>>            Send Info_Box "† „¤ž£â¨à©ž Ž¢¦¡¢ž¨éŸž¡œ" "¢ž¨¦­¦¨å˜"
56095>>>            Set Label to sLabel
56096>>>        End_Procedure
56097>>>
56097>>>    End_Object
56098>>>
56098>>>    //AB-DDOStart
56098>>>
56098>>>    //AB-DDOEnd
56098>>>
56098>>>CD_End_Object    // oCustomerView
56100>>>>
56100>>>
56100>>>//AB/ End_Object    // prj
56100>
56100>        Procedure Activate_About
56103>            Send DoAbout "" "" "" "" ""
56104>        End_Procedure
56105>
56105>    End_Object
56106>    
56106>End_Object
56107>
56107>
56107>//Send Activate_MI_Migrate_Send_Data_To_Master of (oClientArea(oMain))
56107>Start_UI
56108>
Summary
Memory Available: 2147483647
Total Warnings : 0
Total Errors   : 0
Total Symbols  : 32424
Total Resources: 0
Total Commands : 56107
Total Windows  : 1
Total Pages    : 1
Static Data    : 376080
Message area   : 352534
Total Blocks   : 20372
