Compiling Program: L:\Vdf6\Develop\Empor\AppSrc\##quick_run.src
Memory Available: 2147483647
1>Use AllEntSc
Using pre-compiled package ALLENTSC
INCLUDING FILE: ALLENTSC.PKI
30325>
30325>Register_Object Client_Area
30325>
30325>//AB-StoreTopStart
30325>
30325>Use Workspc.pkg
30325>
30325>//  Set date attributes as needed
30325>Set_Date_Attribute sysdate4_State to (TRUE)
30326>Set_Date_Attribute Date4_State    to (TRUE)
30327>Set_Date_Attribute epoch_value    to 30
30328>
30328>Object ProgramWorkspace is a WorkspaceSub
30330>    Set WorkspaceName to CURRENT$WORKSPACE
30331>    Set kEnter_Next_State to True
30332>//    Set ModuleName    to 'ProgramName' // Special module name.
30332>//    Set HelpName      to 'HelpName.hlp'// Please provide the name of your Windows help file.
30332>End_Object
30333>
30333>Use Help_Ids.inc // Developer should provide this file of help context links.
INCLUDING FILE: HELP_IDS.INC
30333>>>// Help_ids.inc
30333>>>//
30333>>>// Context ids for the order entry system. This uses
30333>>>// help file ordentry.hlp.
30333>>>//
30333>>>// This is a sample version. YOU must supply
30333>>>// the ID values
30333>>>
30333>>>//  Generic Context Ids
30333>>>//
30333>>>
30333>>>// It is expected that file-names ids will be the same as their
30333>>>// filenumber.
30333>>>
30333>>>
30333>>>//  View and selection-list specific context ids
30333>>>//
30333>>>//..........add view, object, selection-list ids here....
30333>Use Std_Help.pkg
INCLUDING FILE: STD_HELP.PKG
30333>>>// STD_HELP.PKG
30333>>>//
30333>>>// Global Help Object
30333>>>//
30333>>>//  Creates all Help Support required to access WINDOWs help system
30333>>>//  with DataFlex. Creates a global object named Help_Object.
30333>>>//
30333>>>//  9/19/97 JJT - Modified to define stadnard help Ids if they are undefined
30333>>>
30333>>>use DFHlpSys // Context Sensitive Help Support
30333>>>
30333>>>
30333>>>// This file needs to be provided by the developer. It will contain
30333>>>// symbolic replacements for the ID integer values used to access the
30333>>>// the windows help file's topics.
30333>>>//
30333>>>use Help_ids.inc
30333>>>
30333>>>// If the following are not defined in help_ids.inc,
30333>>>//  create default 0 values for them
30333>>>Define GeneralHelpId    for    0
30333>>>Define KeysHelpId       for    0
30333>>>Define FileHelpId       for    0
30333>>>Define ErrorHelpId      for    0  // probably not used in VDF
30333>>>Define IndexHelpId      for    0  // probably not used in VDF
30333>>>
30333>>>object Help_Object is a HelpSystem // global help object
30335>>>
30335>>>   Set Help_Id_General to GeneralHelpId    // these should all be defined
30336>>>   Set Help_Id_Index   to IndexHelpId      // in help_ids.inc.
30337>>>   Set Help_Id_Keys    to KeysHelpId       //
30338>>>   Set Help_Id_Files   to FileHelpId       //
30339>>>   Set Help_Id_Errors  to ErrorHelpId      //
30340>>>
30340>>>end_object
30341>
30341>Use WinQlSQL.Sub
INCLUDING FILE: WINQLSQL.SUB
30341>>>Use CrystalReport.pkg
30341>>>
30341>>>Define PE_SUBREPORT_NAME_LEN       for 128
30341>>>
30341>>>Type PESubreportInfo
30341>>>  Field PESubreportInfo.structSize as Word
30341>>>  Field PESubreportInfo.name       as Char PE_SUBREPORT_NAME_LEN
30341>>>  Field PESubreportInfo.NLinks     as Short
30341>>>  Field PESubreportInfo.IsOnDemand as Short
30341>>>End_Type // PESubreportInfo
30341>>>
30341>>>
30341>>>External_Function PEGetNSections "PEGetNSections" CRPE32.DLL ;  Integer printJob ;  Returns Integer
30342>>>
30342>>>External_Function PEGetSectionCode "PEGetSectionCode" CRPE32.DLL ;  Integer printJob ;  Integer sectionN ;  Returns Integer
30343>>>
30343>>>External_Function PECloseSubreport "PECloseSubreport" CRPE32.DLL ;  Integer printJob ;  Returns Integer
30344>>>
30344>>>External_Function PEGetNSubreportsInSection "PEGetNSubreportsInSection" CRPE32.DLL ;  Integer printJob ;  Integer sectionCode ;  Returns Integer
30345>>>
30345>>>External_Function PEGetNthSubreportInSection "PEGetNthSubreportInSection" CRPE32.DLL ;  Integer printJob ;  Integer sectionCode ;  Integer subreportN ;  Returns Integer
30346>>>
30346>>>External_Function PEGetSubreportInfo "PEGetSubreportInfo" CRPE32.DLL ;  Integer printJob ;  Integer subreportHandle ;  Pointer subreportInfo ;  Returns Integer
30347>>>
30347>>>External_Function PEOpenSubreport "PEOpenSubreport" CRPE32.DLL ;  Integer parentJob ;  Pointer subreportName ;  Returns Integer
30348>>>
30348>>>
30348>>>Type PEWindowOptions
30348>>>  Field PEWindowOptions.StructSize As Word
30348>>>  Field PEWindowOptions.hasGroupTree As Word
30348>>>  Field PEWindowOptions.canDrillDown As Word
30348>>>  Field PEWindowOptions.hasNavigationControls As Word
30348>>>  Field PEWindowOptions.hasCancelButton As Word
30348>>>  Field PEWindowOptions.hasPrintButton As Word
30348>>>  Field PEWindowOptions.hasExportButton As Word
30348>>>  Field PEWindowOptions.hasZoomControl As Word
30348>>>  Field PEWindowOptions.hasCloseButton As Word
30348>>>  Field PEWindowOptions.hasProgressControls As Word
30348>>>  Field PEWindowOptions.hasSearchButton As Word
30348>>>  Field PEWindowOptions.hasPrintSetupButton As Word
30348>>>  Field PEWindowOptions.hasRefreshButton As Word
30348>>>End_Type // PEWindowOptions
30348>>>
30348>>>External_Function32 PESetWindowOptions "PESetWindowOptions" CRPE32.DLL ;  Integer printJob pointer Options Returns Integer
30349>>>
30349>>>Class CrystalReportSubSQL Is A CrystalReport
30350>>>
30350>>>    Procedure Construct_Object
30351>>>        Forward send Construct_Object
30353>>>        // Everything on except hasGroupTree by default
30353>>>        property integer hasGroupTree 0
30354>>>        property integer canDrillDown 1
30355>>>        property integer hasNavigationControls 1
30356>>>        property integer hasCancelButton 1
30357>>>        property integer hasPrintButton 1
30358>>>        property integer hasExportButton 1
30359>>>        property integer hasZoomControl 1
30360>>>        property integer hasCloseButton 1
30361>>>        property integer hasProgressControls 1
30362>>>        property integer hasSearchButton 1
30363>>>        property integer hasPrintSetupButton 1
30364>>>        property integer hasRefreshButton 1
30365>>>
30365>>>        Set WindowStyle To (WS_MAXIMIZE iOr WS_OVERLAPPEDWINDOW)
30366>>>    End_Procedure // Construct_Object
30367>>>
30367>>>    Procedure OutputToWindow String sTitle Integer iLeft Integer iTop Integer iWidth Integer iHeight Integer iStyle Handle hParent
30368>>>        Integer iPrintJob iResult
30369>>>        String sPEWindowOptions
30369>>>        Pointer pPeWindowOptions
30369>>>
30369>>>        Get PrintJob To iPrintJob
30370>>>        FillType PEWindowOptions with 0     to sPEWindowOptions
30371>>>        put PEWindowOptions_Size            to sPEWindowOptions at PEWindowOptions.StructSize
30372>>>        put (hasGroupTree(self))            to sPEWindowOptions at PEWindowOptions.hasGroupTree
30373>>>        put (canDrillDown(self))            to sPEWindowOptions at PEWindowOptions.canDrillDown
30374>>>        put (hasNavigationControls(self))   to sPEWindowOptions at PEWindowOptions.hasNavigationControls
30375>>>        put (hasCancelButton(self))         to sPEWindowOptions at PEWindowOptions.hasCancelButton
30376>>>        put (hasPrintButton(self))          to sPEWindowOptions at PEWindowOptions.hasPrintButton
30377>>>        put (hasExportButton(self))         to sPEWindowOptions at PEWindowOptions.hasExportButton
30378>>>        put (hasZoomControl(self))          to sPEWindowOptions at PEWindowOptions.hasZoomControl
30379>>>        put (hasCloseButton(self))          to sPEWindowOptions at PEWindowOptions.hasCloseButton
30380>>>        put (hasProgressControls(self))     to sPEWindowOptions at PEWindowOptions.hasProgressControls
30381>>>        put (hasSearchButton(self))         to sPEWindowOptions at PEWindowOptions.hasSearchButton
30382>>>        put (hasPrintSetupButton(self))     to sPEWindowOptions at PEWindowOptions.hasPrintSetupButton
30383>>>        put (hasRefreshButton(self))        to sPEWindowOptions at PEWindowOptions.hasrefreshButton
30384>>>        GetAddress of sPEWindowOptions      to pPEWindowOptions
30385>>>        Move (PESetWindowOptions(iPrintJob, pPEWindowOptions)) to iResult
30386>>>        Forward Send OutputToWindow sTitle iLeft iTop iWidth iHeight iStyle hParent
30388>>>    End_Procedure // OutputToWindow
30389>>>
30389>>>    Procedure Set TmpFileDir String aDir
30390>>>        String lsCurrWspc lsDir
30391>>>
30391>>>//        If (ghoWorkSpace <> 0) Begin
30391>>>//            Get WorkSpaceName of ghoWorkSpace to lsCurrWspc
30391>>>//            Insert "WorkSpaces\" in lsCurrWspc at 1
30391>>>//            Get_Profile_String lsCurrWspc aDir to lsDir
30391>>>//            Set Report_Data_Path to lsDir
30391>>>//        End
30391>>>    End_Procedure
30392>>>
30392>>>    Procedure DoWinQLReport
30393>>>        // This can be used when reports must be able to run in different data directories
30393>>>        Set TmpFileDir to "TmpFileDir"
30394>>>        Forward Send DoWinQLReport
30396>>>    End_Procedure
30397>>>
30397>>>
30397>>>  Function NSections Returns Integer
30398>>>    Integer iPrintJob iResult
30399>>>
30399>>>    Get PrintJob To iPrintJob
30400>>>    Move (PEGetNSections(iPrintJob)) To iResult
30401>>>    Move (Low(iResult)) To iResult
30402>>>    Function_Return iResult
30403>>>  End_Function // NSections
30404>>>
30404>>>  Function SectionCode Integer iSectionN Returns Integer
30405>>>    Integer iPrintJob iResult
30406>>>
30406>>>    Get PrintJob To iPrintJob
30407>>>    Move (PEGetSectionCode(iPrintJob,iSectionN)) To iResult
30408>>>    Move (Low(iResult)) To iResult
30409>>>    Function_Return iResult
30410>>>  End_Function // SectionCode
30411>>>
30411>>>  Function CloseSubreport Integer iSubreport Returns Integer
30412>>>    Integer iResult
30413>>>
30413>>>    Move (PECloseSubreport(iSubreport)) To iResult
30414>>>    Function_Return iResult
30415>>>  End_Function // CloseSubreport
30416>>>
30416>>>  Function NSubreportsInSection Integer iSectionCode Returns Integer
30417>>>    Integer iPrintJob iResult
30418>>>
30418>>>    Get PrintJob To iPrintJob
30419>>>    Move (PEGetNSubreportsInSection(iPrintJob,iSectionCode)) To iResult
30420>>>    Move (Low(iResult)) To iResult
30421>>>    Function_Return iResult
30422>>>  End_Function // nSubreportsInSection
30423>>>
30423>>>  Function NthSubreportInSection Integer iSectionCode Integer iSubreportN Returns Integer
30424>>>    Integer iPrintJob iResult
30425>>>
30425>>>    Get PrintJob To iPrintJob
30426>>>    Move (PEGetNthSubreportInSection(iPrintJob,iSectionCode,iSubreportN)) To iResult
30427>>>    Function_Return iResult
30428>>>  End_Function // NthSubreportInSection
30429>>>
30429>>>  Function SubreportName Integer iSubreportHandle Returns String
30430>>>    String sPESubreportInfo sResult
30431>>>    Pointer pPESubreportInfo
30431>>>    Integer iPrintJob iResult
30431>>>
30431>>>    ZeroType PESubreportInfo To sPESubreportInfo
30432>>>    Put PESubreportInfo_Size To sPESubreportInfo at PESubreportInfo.structSize
30433>>>    GetAddress Of sPESubreportInfo to pPESubreportInfo
30434>>>
30434>>>    Get PrintJob To iPrintJob
30435>>>    Move (PEGetsubreportInfo(iPrintJob,iSubreportHandle,pPESubreportInfo)) To iResult
30436>>>    If iResult GetBuff_String From sPESubreportInfo at PESubreportInfo.name To sResult
30439>>>    Function_Return (ToOEM(sResult))
30440>>>  End_Function // SubreportName
30441>>>
30441>>>  Function SubreportNLinks Integer iSubreportHandle Returns Integer
30442>>>    String sPESubreportInfo
30443>>>    Pointer pPESubreportInfo
30443>>>    Integer iPrintJob iResult
30443>>>
30443>>>    ZeroType PESubreportInfo To sPESubreportInfo
30444>>>    Put PESubreportInfo_Size To sPESubreportInfo at PESubreportInfo.structSize
30445>>>    GetAddress Of sPESubreportInfo to pPESubreportInfo
30446>>>
30446>>>    Get PrintJob To iPrintJob
30447>>>    Move (PEGetsubreportInfo(iPrintJob,iSubreportHandle,pPESubreportInfo)) To iResult
30448>>>    If iResult GetBuff From sPESubreportInfo at PESubreportInfo.NLinks To iResult
30451>>>    Function_Return iResult
30452>>>  End_Function // SubreportNLinks
30453>>>
30453>>>  Function SubreportIsOnDemand Integer iSubreportHandle Returns Integer
30454>>>    String sPESubreportInfo
30455>>>    Pointer pPESubreportInfo
30455>>>    Integer iPrintJob iResult
30455>>>
30455>>>    ZeroType PESubreportInfo To sPESubreportInfo
30456>>>    Put PESubreportInfo_Size To sPESubreportInfo at PESubreportInfo.structSize
30457>>>    GetAddress Of sPESubreportInfo to pPESubreportInfo
30458>>>
30458>>>    Get PrintJob To iPrintJob
30459>>>    Move (PEGetsubreportInfo(iPrintJob,iSubreportHandle,pPESubreportInfo)) To iResult
30460>>>    If iResult GetBuff From sPESubreportInfo at PESubreportInfo.IsOnDemand To iResult
30463>>>    Function_Return iResult
30464>>>  End_Function // SubreportIsOnDemand
30465>>>
30465>>>  Function OpenSubReport String sSubreport Returns Integer
30466>>>    Integer iPrintJob iResult
30467>>>    Pointer pSubreport
30467>>>
30467>>>    Get PrintJob To iPrintJob
30468>>>    GetAddress Of sSubreport To pSubreport
30469>>>    Move (PEOpenSubreport(iPrintJob,pSubreport)) To iResult
30470>>>    Move (Low(iResult)) To iResult
30471>>>    Function_Return iResult
30472>>>  End_Function // OpenSubReport
30473>>>
30473>>>  Function NTablesInSubreport Integer iSubreportHandle Returns Integer
30474>>>    Local Integer iResult
30475>>>
30475>>>    Move (PEGetNTables(iSubreportHandle)) To iResult
30476>>>    Move (Low(iResult)) To iResult
30477>>>    Function_Return iResult
30478>>>  End_Function // NTablesInSubreport
30479>>>
30479>>>  Function NthTableLocationInSubreport Integer iSubreportHandle Integer iTableN Returns String
30480>>>    Local String sPETableLocation sReturn
30481>>>    Local Pointer pPETableLocation
30481>>>    Local Integer iResult
30481>>>
30481>>>    FillType PETableLocation With 0 To sPETableLocation
30482>>>    Put PETableLocation_Size To sPETableLocation At PETableLocation.StructSize
30483>>>    GetAddress Of sPETableLocation To pPETableLocation
30484>>>    Move (PEGetNthTableLocation(iSubreportHandle,iTableN,pPETableLocation)) To iResult
30485>>>    If iResult GetBuff_String From sPETableLocation At PETableLocation.Location To sReturn
30488>>>    Function_Return (ToOEM(sReturn))
30489>>>  End_Function // NthTableLocationInSubreport
30490>>>
30490>>>  Procedure Set NthTableLocationInSubreport Integer iSubreportHandle Integer iTableN String sLocation
30491>>>    Local String sPETableLocation
30492>>>    Local Pointer pPETableLocation
30492>>>    Local Integer iResult
30492>>>
30492>>>    Move (ToANSI(sLocation+Character(0))) To sLocation
30493>>>    FillType PETableLocation With 0 To sPETableLocation
30494>>>    Put PETableLocation_Size To sPETableLocation At PETableLocation.StructSize
30495>>>    Put_String sLocation To sPETableLocation At PETableLocation.Location
30496>>>    GetAddress Of sPETableLocation To pPETableLocation
30497>>>    Move (PESetNthTableLocation(iSubreportHandle,iTableN,pPETableLocation)) To iResult
30498>>>  End_Procedure // Set NthTableLocationInSubreport
30499>>>
30499>>>
30499>>>    // This hook procedure is called after the print job has been opened.
30499>>>
30499>>>    Procedure OnInitializeReport
30500>>>
30500>>>    ////// SOS Na ginei xana OnInitializeReport ///////////
30500>>>
30500>>>        Integer iTables iMax iCount iType
30501>>>        String  sLocation sLocation2 sPath DirSep sPassw
30501>>>        String  sNewPath sNewLocation sDataPath sMyLocation
30501>>>
30501>>>        Integer lnSections lnSubreports lnTables iPrintJob iPath
30501>>>        Integer iSection iCode iSubreport iTable iNumPaths bExists
30501>>>        Handle hSubreport
30501>>>        String sTable sSubreport sTempFilePath sSApassw
30501>>>        Boolean bCheckforTempfile bTemp
30501>>>
30501>>>
30501>>>
30501>>>        Forward Send OnInitializeReport
30503>>>
30503>>>
30503>>>        Open Company
INCLUDING FILE: COMPANY.FD
30505>>>        Open Syscurxr
INCLUDING FILE: SYSCURXR.FD
30507>>>
30507>>>        Clear Company
30508>>>        Move SyscurXr.Company_Code to Company.Company_Code
30509>>>        Find Eq Company By Index.1
30510>>>>
30510>>>
30510>>>
30510>>>        If ((Found) And (Company.Company_C_CodeR='')) Procedure_Return
30513>>>
30513>>>        Move (Trim(COMPANY.COMPANY_EMAIL)) to sSApassw
30514>>>
30514>>>
30514>>>        String  sActualSQL
30514>>>        String  sActualTemp
30514>>>        String  sOldSQL
30514>>>        String  sOldTemp
30514>>>        String  sServerName
30514>>>        String  sDatabaseName
30514>>>        String  sUserID
30514>>>
30514>>>        //Move Company.Company_C_CodeR    to sServerName          // ODBC sto 1o pedio
30514>>>        //Move Company.Company_C_CodER    to sActualSQL           // Database sto 2o pedio
30514>>>        //Move Company.Company_C_CodER    to sDatabaseName        // Database sto 2o pedio
30514>>>
30514>>>        Move 'SMS'              to sOldSQL
30515>>>        Move 'C:\Dns_tmp\'      to sOldTemp
30516>>>
30516>>>
30516>>>        Move 'C:\Dns_tmp\'      to sActualTemp
30517>>>
30517>>>        Move (Trim(sActualSQL   )) to sActualSQL
30518>>>        Move (Trim(sActualTemp  )) to sActualTemp
30519>>>        Move (Trim(sOldSQL      )) to sOldSQL
30520>>>        Move (Trim(sOldTemp     )) to sOldTemp
30521>>>        Move (Trim(sServerName  )) to sServerName
30522>>>        Move (Trim(sDatabaseName)) to sDatabaseName
30523>>>        Move (Trim(sUserID      )) to sUserID
30524>>>
30524>>>
30524>>>
30524>>>        Move "SMSNT"    to sServerName
30525>>>        Move "SMS"      to sDatabaseName
30526>>>        Move "SMS"      to sActualSQL
30527>>>
30527>>>        Move "sa"       to sUserID
30528>>>        //////////  06/09/2011   Move "123"      to sPassw
30528>>>        Move sSApassw   to sPassw
30529>>>
30529>>>        Send LogOnServer "SQL_DRV" sServerName sDatabaseName sUserID sPassw
30530>>>
30530>>>
30530>>>        Move (Sysconf(SYSCONF_DIR_SEPARATOR)) To DirSep
30531>>>
30531>>>        Get NTables To iMax
30532>>>        Decrement iMax
30533>>>        Get Report_Data_Path                                    To sPath
30534>>>        If Not (Right(sPath,1)) Eq DirSep Move (sPath-DirSep)   To sPath
30537>>>        For iCount From 0 To iMax
30543>>>>
30543>>>            Get NthTableLocation iCount         To sLocation
30544>>>            Get Report_Base_File_Name sLocation To sLocation2
30545>>>            Get NthTableDBType           iCount to iType
30546>>>
30546>>>            // An einai type 1 topiko
30546>>>            //               2=SQL
30546>>>            If (iType=2) Begin
30548>>>                If (sLocation contains sOldSQL) Begin
30550>>>                    Move (Replace(sOldSQL,sLocation,sActualSQL))    to sLocation
30551>>>                    Set NthTableLocation iCount                     to (Trim(sLocation))
30552>>>                End
30552>>>>
30552>>>            End
30552>>>>
30552>>>            Else If (iType=1) Begin
30555>>>                If (sLocation contains sOldTemp) Begin
30557>>>                    Move (Replace(sOldTemp,sLocation,sActualTemp))  to sLocation
30558>>>                    Set NthTableLocation iCount                     to (Trim(sLocation))
30559>>>                End
30559>>>>
30559>>>            End
30559>>>>
30559>>>            Set nthTableLogOnServerName     iCount to sServerName     0
30560>>>            Set nthTableLogOnDataBaseName   iCount to sDatabaseName   0
30561>>>            Set nthTableLogOnUserID         iCount to sUserID         0 // 'sa'     0
30562>>>
30562>>>            // 2011
30562>>>            Set nthTableLogOnPassword       iCount to sPassw       0
30563>>>            // 2011
30563>>>
30563>>>
30563>>>        Loop // For iCount From 0 To iMax
30564>>>>
30564>>>
30564>>>        // Set the location of the tables for the subreports
30564>>>        Get NSections To lnSections
30565>>>        For iSection From 0 To (lnSections-1)
30571>>>>
30571>>>            Get SectionCode iSection To iCode
30572>>>            Get NSubreportsInSection iCode To lnSubreports
30573>>>            For iSubreport From 0 To (lnSubreports-1)
30579>>>>
30579>>>                Get NthSubreportInSection iCode iSubreport To hSubreport
30580>>>                Get SubreportName hSubreport To sSubreport
30581>>>                Get OpenSubreport sSubreport To iPrintJob
30582>>>                Get NTablesInSubreport iPrintJob To lnTables
30583>>>                For iTable From 0 To (lnTables-1)
30589>>>>
30589>>>                    Get NthTableLocationInSubreport iPrintJob iTable To sTable
30590>>>                    If (sTable contains sOldSQL) Begin
30592>>>                            Move '' to sLocation
30593>>>                            Move (Replace(sOldSQL,sTable,sActualSQL)) to sLocation
30594>>>                            Set NthTableLocationInSubreport iPrintJob iTable To (Trim(sLocation))
30595>>>                            Set nthTableLogOnServerName     iTable to sServerName     0
30596>>>                            Set nthTableLogOnDataBaseName   iTable to sDatabaseName   0
30597>>>                            Set nthTableLogOnUserID         iTable to sUserID         0 // 'sa'     0
30598>>>                                // 2011
30598>>>                                Set nthTableLogOnPassword       iTable to sPassw   0
30599>>>                                // 2011
30599>>>                    End
30599>>>>
30599>>>                Loop // For iTable From 0 To nTables
30600>>>>
30600>>>            Loop // For iSubreport From 0 To nSubreports
30601>>>>
30601>>>        Loop // For iSection From 0 To (iSections-1)
30602>>>>
30602>>>
30602>>>    End_Procedure // OnInitializeReport
30603>>>
30603>>>
30603>>>    // This hook procedure is called just before a print job is closed.
30603>>>    Procedure OnDeInitializeReport
30604>>>        Forward Send OnDEInitializeReport
30606>>>    End_Procedure // OnDeInitializeReport
30607>>>
30607>>>    // This hook procedure is called just before a the print job is started.
30607>>>    Procedure OnStartPrinting
30608>>>        Forward Send OnStartPrinting
30610>>>    End_Procedure // OnStartPrinting
30611>>>
30611>>>    // This hook procedure is called just after a print job has finished.
30611>>>    Procedure OnStopPrinting
30612>>>        Forward Send OnStopPrinting
30614>>>    End_Procedure // OnStopPrinting
30615>>>End_Class // CrystalReportSubSQL
30616>>>
30616>Integer giWait_Obj
30616>string sXrhs sKodi sDeCryptoPassw
30616>String gsMyStr
30616>//-----
30616>
30616>
30616>// General Functions-Procedures and Variables
30616>Use Globals.Inc
INCLUDING FILE: GLOBALS.INC
30616>>>
30616>>>        String  gs_Selected_Company_Code
30616>>>        String  gs_Selected_Branch_Code
30616>>>        Integer gi_Selected_Year
30616>>>        String gs_Selected_Year_Recr
30616>>>        String  gs_Module_Code
30616>>>
30616>>>
30616>>>//Open Currency
30616>>>//Function CurrDigits Global String asCurr Returns Integer
30616>>>//    Integer liDecX
30616>>>//    Clear Currency
30616>>>//    move asCurr to Currency.Currency_C_Code
30616>>>//    Find Eq Currency By Index.1
30616>>>//    move Currency.Currency_Dec to liDecX
30616>>>//    Function_Return liDecX
30616>>>//End_Function // CurrDigits
30616>>>
30616>>>Open Nomisma
INCLUDING FILE: NOMISMA.FD
30618>>>Open SysCurXr
30620>>>
30620>>>Function fiDekadika_Nomismatos Global String asNomisma Returns Integer
30621>>>    Move (Trim(asNomisma)) to asNomisma
30622>>>    Clear Nomisma
30623>>>    If ( asNomisma<>'' ) Move asNomisma         to Nomisma.Nomisma_Code
30626>>>    Else                 Move SysCurXr.C_Code0  to Nomisma.Nomisma_Code
30628>>>    Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
30629>>>>
30629>>>    Function_Return Nomisma.Dekadika
30630>>>End_Function //
30631>>>
30631>>>Function fsgCode_W_Zeroes Global Integer aiCode Integer aiPlaces Returns String
30632>>>    String rVal
30633>>>    Integer iLength iInt
30633>>>    Move aiCode to rVal
30634>>>    Move (trim(rVal)) to rVal
30635>>>    For iInt From 1 to (aiPlaces-(Length(rVal)))
30641>>>>
30641>>>        Move (Insert('0',rVal,1)) to rVal
30642>>>    Loop
30643>>>>
30643>>>    Function_Return rVal
30644>>>End_Function
30645>>>
30645>>>Function fsgCode_n_Zeroes Global number aiCode Integer aiPlaces Returns String
30646>>>    String rVal
30647>>>    Integer iLength iInt ipos
30647>>>    Move aiCode to rVal
30648>>>    Move (trim(rVal)) to rVal
30649>>>    MOVE (aiPlaces-(Length(rVal))) to ipos
30650>>>    For iInt From 1 to ipos
30656>>>>
30656>>>        Move (Insert('0',rVal,1)) to rVal
30657>>>    Loop
30658>>>>
30658>>>    Function_Return rVal
30659>>>End_Function
30660>>>
30660>>>
30660>>>Open Year
INCLUDING FILE: YEAR.FD
30662>>>Procedure EnumDDsForRebuildConstrain for DataDictionary integer aiMsg integer ahId
30663>>>    Send aiMsg to Self
30664>>>End_Procedure
30665>>>
30665>>>Procedure DoRefindYear for baseclass Integer aiPanel Integer aiYearDD
30666>>>    Integer liChanged
30667>>>
30667>>>    If ((aiYearDD = 0) or (Main_File(aiYearDD)<>Year.File_Number)) ;        Procedure_Return (Message_Box("Invalid Year_DD","Developer's Warning",MB_OK,MB_ICONWARNING))
30670>>>    If (Not(Current_Record(aiYearDD))) Begin
30672>>>        Get Should_Save of aiPanel to liChanged
30673>>>        Send Clear to aiYearDD
30674>>>        Move gs_Selected_Company_Code to Year.Company_Code
30675>>>        Move gs_Selected_Branch_Code  to Year.Branch_Code
30676>>>        Move gi_Selected_Year         to Year.Year_Year
30677>>>        Send Find to aiYearDD Eq 1 //Year.Index.1 - company_code+ranch_code+year_year
30678>>>        If (Not(liChanged)) Set Changed_State of aiPanel to False
30681>>>    End
30681>>>>
30681>>>End_Procedure
30682>>>
30682>>>Procedure RebuildConstrainIfYearChanged for baseclass Integer aiPanel String asCurrentYearRecr Integer aiYearDDId
30683>>>    Integer liSrvr
30684>>>    String  lsCurrentYearRecr
30684>>>
30684>>>    If (asCurrentYearRecr <> gs_Selected_Year_Recr) Begin
30686>>>        Broadcast Send EnumDDsForRebuildConstrain to aiPanel msg_Rebuild_Constraints Self
30688>>>    End
30688>>>>
30688>>>    Send DoRefindYear aiPanel aiYearDDId //(Year_DD(Self))
30689>>>    Get Server of aiPanel to liSrvr
30690>>>    // Respects Default values
30690>>>    If (liSrvr) If (Not(Current_Record(liSrvr))) Send Request_Clear to aiPanel
30695>>>End_Procedure
30696>>>
30696>>>//                                       ’¦ View            Property «¦¬ View             ’¦ Year DDO «¦¬ View
30696>>>//                                                          Holds the current year rec0
30696>>>// ‰¢ã©ž : Send RbldConstrIfYearChanged (Gplan_Test(Self))  (psCurrentYearRecr(Self))     (Year_DD(Self))
30696>>>
30696>>>
30696>>>Function fiRefindYear Global Returns Integer
30697>>>    Clear Year
30698>>>    Move gs_Selected_Company_Code to Year.Company_Code
30699>>>    Move gs_Selected_Branch_Code  to Year.Branch_Code
30700>>>    Move gi_Selected_Year         to Year.Year_Year
30701>>>    Find eq Year by Index.1 //company_code+ranch_code+year_year
30702>>>>
30702>>>    Function_Return (Found = 0)
30703>>>End_Function //fiRefindYear
30704>>>
30704>>>Procedure DoRunApplication for Baseclass String sAppName
30705>>>    string sRuntime  lsStr
30706>>>
30706>>>    Append lsStr 'C:\Dns.bat ' sAppName
30708>>>    RunProgram Wait  lsStr
30709>>>
30709>>>//    get_profile_string "defaults" "VDFBinDir" to sRuntime
30709>>>//    append sRuntime "\dfrun " sAppName
30709>>>    Append sRuntime 'C:\Program Files\Accessories\WORDPAD.EXE ' sAppName
30711>>>    runprogram background sRuntime
30712>>>End_procedure // DoRunApplication
30713>>>
30713>>>// Run the Editor
30713>>>Procedure DoRunEditor for Baseclass String asFile
30714>>>    string sRunPath lsWspcName
30715>>>    Move (WorkspaceName(ProgramWorkspace(Self))) to lsWspcName
30716>>>    get_profile_string ("workspaces\"+lsWspcName) "programpath" to sRunPath
30719>>>    //append sRunPath "\Editor "  asFile //// js 15/03/2002 " " lsWspcName
30719>>>    Move (Replace('.',asFile,'')) to asFile
30720>>>    append sRunPath asFile //// js 15/03/2002 " " lsWspcName
30721>>>    send DoRunApplication sRunPath
30722>>>End_Procedure // DoRunEditor
30723>>>
30723>>>//--------------------------------------
30723>>>
30723>>>//start of global functions and procedures
30723>>>
30723>>>
30723>>>//®¨ž© £¦§¦ œå«˜  ˜§æ: ˜) gmoves.dd    :private.update_gmhnes_ghmnies
30723>>>Function gsfFind_Previous Global String lsCode;                                 String lsDelimiter;                                 Returns String
30724>>>         String  lsTemp_Code1 lsTemp_Code2
30725>>>         Integer liCounter
30725>>>
30725>>>         //1.˜­˜å¨œ©ž ¡œ¤é¤
30725>>>         Move (Trim(lsCode)) to lsCode                                  //§® 30.12.345
30726>>>
30726>>>         //2.˜¤« ©«¨¦­ã
30726>>>         For liCounter From 1 to (Length(lsCode))
30732>>>>
30732>>>             Move (Insert(;                           (Mid(lsCode,1,liCounter)),;                           lsTemp_Code1,;                           1;                         )) to lsTemp_Code1                             //§® 543.21.03
30733>>>         Loop
30734>>>>
30734>>>
30734>>>         //3.˜­˜å¨œ©ž ¡œ¤é¤ (›â¤ ®¨œ áœ«˜ , safety only)
30734>>>         Move (Trim(lsTemp_Code1)) to lsTemp_Code1
30735>>>
30735>>>         //4.§˜å¨¤à £æ¤¦ «¦ ›œ¥ æ £â¨¦ª «¦¬ ˜¤«å©«¨¦­¦¬, £œ«á «¦ §¨é«¦ delimiter
30735>>>         Move (Right(;                      lsTemp_Code1,;                      ((Length(lsTemp_Code1))-((Pos(lsDelimiter,lsTemp_Code1))));                    )) to lsTemp_Code1                                  // §® 21.03
30736>>>
30736>>>         //5.¥˜¤á ˜¤« ©«¨¦­ã «¦¬ ˜¤«å©«¨¦­¦¬
30736>>>         For liCounter from 1 to (Length(lsTemp_Code1))
30742>>>>
30742>>>             Move (Insert(;                           (Mid(lsTemp_Code1,1,liCounter)),;                           lsTemp_Code2,;                           1;                         )) to lsTemp_Code2                             //§® 30.12
30743>>>         Loop
30744>>>>
30744>>>
30744>>>         Function_Return (Trim(lsTemp_Code2))
30745>>>End_Function //gsffind_previous
30746>>>
30746>>>
30746>>>Function gifSystem_Check Returns Integer
30747>>>         Integer liF_Gtypkins liF_Garicls liF_Gmoves liF_Gplans liF_Gmhnes liF_Ghmnies
30748>>>         Integer liS_Gtypkins liS_Garicls liS_Gmoves liS_Gplans liS_Gmhnes liS_Ghmnies
30748>>>//       Clear Company
30748>>>//       Find Gt Company.Recnum
30748>>>//       While (Found = 1)
30748>>>//             Add Company.Company_NumGtypkin to liS_Gtypkins § Ÿ˜¤é© ©«¦ sysfile ¤˜ «˜ ¡˜¨˜«áà ˜¬«á
30748>>>//             Add Company.Company_NumGarticl to liS_Garticls
30748>>>//             Add Company.Company_NumGmoves  to liS_Gmoves
30748>>>//             //d Company.Company_NumGtypkin to liS_Gtypkins
30748>>>//             Add Company.Company_NumGplan   to liS_GPlans
30748>>>//             Add Company.Company_NumGmhnes  to liS_Gmhnes
30748>>>//             Add Company.Company_NumGhmnies to liS_Ghmnies
30748>>>//             Find Gt Company.Recnum
30748>>>//       Loop
30748>>>//
30748>>>//       Get_Attribute {attribute} [of {file-handle} ;
30748>>>//                        [{field-num} | {index-num} [{segment-num}]]] ;
30748>>>//                        To {variable}
30748>>>//
30748>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30748>>>//       Get_Attribute DF_FILE_RECORDS_USED of Garticl.File_Number to liF_Garticls
30748>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmoves.File_Number  to liF_Gmoves
30748>>>//       //t_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30748>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gplan.File_Number   to liF_Gplans
30748>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmhnes.File_Number  to liF_Gmhnes
30748>>>//       Get_Attribute DF_FILE_RECORDS_USED of Ghmnies.File_Number to liF_Ghmnies
30748>>>//
30748>>>
30748>>>//       //â¢œš®¦ª DF_FILE_MAX_RECORDS+ £œ records used
30748>>>
30748>>>//       //â¢œš®¦ª last rec0 = sysrec rec0
30748>>>
30748>>>    Function_Return 0
30749>>>End_Function //gifSystem_Check
30750>>>
30750>>>/////////////////////////////////////////////////////////////////
30750>>>//‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª, £œ ž ®à¨åª ›œ¡˜› ¡á  JS
30750>>>Function Sfi_All_Numbers Global Number anValue Integer aiLengthAkeraios Integer aiLengthDekadika Returns String
30751>>>
30751>>>    String  lsRetval lsValue lsAkeraios lsDekadika
30752>>>    Integer liInt liInteger iTimes iStart
30752>>>    Number  lnDecimals
30752>>>
30752>>>    Move (Integer(anValue))                                         to liInteger
30753>>>    Move (Round(AnValue-(Integer(anValue))*(10^aiLengthDekadika)))  to lnDecimals
30754>>>
30754>>>    Move liInteger              to lsAkeraios
30755>>>    Move lnDecimals             to lsDekadika
30756>>>    Move (Trim(lsAkeraios))     to lsAkeraios
30757>>>    Move (Trim(lsDekadika))     to lsDekadika
30758>>>
30758>>>    Move (Length(lsAkeraios)) to iStart
30759>>>    For iTimes From iStart to (aiLengthAkeraios-1)
30765>>>>
30765>>>        Insert "0" in lsAkeraios at 1
30767>>>    Loop
30768>>>>
30768>>>    Move (Trim(lsAkeraios)) to lsAkeraios
30769>>>
30769>>>    Move (Length(lsDekadika)) to iStart
30770>>>    For iTimes From iStart to (aiLengthDekadika-1)
30776>>>>
30776>>>        Move (Append(lsDekadika,"0")) to lsDekadika
30777>>>    Loop
30778>>>>
30778>>>    Move (Trim(lsDekadika)) to lsDekadika
30779>>>
30779>>>    If (aiLengthDekadika=0) Move '' to lsDekadika
30782>>>    Move '' to lsRetVal
30783>>>    Move (Pad((lsAkeraios-lsDekadika),(aiLengthAkeraios+aiLengthDekadika))) to lsRetval
30784>>>    Function_Return lsRetval
30785>>>End_Function //sfi_All_Numbers  ‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª
30786>>>              //                 £œ ž ®à¨åª ›œ¡˜› ¡á (JS)
30786>>>
30786>>>Open Codemast
30788>>>
30788>>>
30788>>>Function gsfCode_Mast Global String lsType String lsValue Returns String
30789>>>         Clear Codemast
30790>>>         Move lsType  to Codemast.Type
30791>>>         Move lsValue to Codemast.Code
30792>>>         Find Eq Codemast by Index.1 //type+code
30793>>>>
30793>>>         Function_Return Codemast.Description
30794>>>End_Function //code_mast
30795>>>
30795>>>
30795>>>Open Branch
INCLUDING FILE: BRANCH.FD
30797>>>Function fsgCode_With_Zeroes Global Integer aiCode    ;                                    Integer aiPlaces  ;                                    String asCompany  ;                                    String asBranch   ;                               Returns String
30798>>>    String rVal
30799>>>    Integer iInt
30799>>>    Clear Branch
30800>>>    Move asCompany  to Branch.Company_Code
30801>>>    Move asBranch   to Branch.Branch_Code
30802>>>    Find Eq Branch by Index.1
30803>>>>
30803>>>    If (Trim(Branch.Tomeas_Code)<>'') Move (Trim(Branch.Tomeas_Code)) to asBranch
30806>>>    Move (Trim(asCompany))  to asCompany
30807>>>    Move (Trim(asBranch))   to asBranch
30808>>>    If (Length(asCompany)=1) Insert '0' In asCompany At 1
30812>>>    If (Length(asBranch) =1) Insert '0' In asBranch  At 1
30816>>>    Move ''                                           to rVal
30817>>>    Move (Sfi_All_Numbers(aiCode,aiPlaces,0))         to rVal
30818>>>    Move (Append((asCompany+'.'+asBranch+'.'),rVal))  to rVal
30819>>>    Move (Trim(rVal))                                 to rVal
30820>>>    Function_Return rVal
30821>>>End_Function
30822>>>
30822>>>Function fsgStripCodeFromID Global String asID Returns Integer
30823>>>      Integer iLen iPos iInt
30824>>>      If (Trim(asID)='') Function_Return 0
30827>>>      Move (Trim  (asID)) to asID
30828>>>      Move (Length(asID)) to iLen
30829>>>      For iInt From 1     to iLen
30835>>>>
30835>>>          If (Mid(asID,1,iInt)='.') Move iInt to iPos
30838>>>      Loop
30839>>>>
30839>>>      Function_Return (Right(asID,(iLen-iPos)))
30840>>>End_Function
30841>>>
30841>>>Function fsCityDescr Global Integer aiCityID Returns String
30842>>>    String rVal
30843>>>    Open Cities
INCLUDING FILE: CITIES.FD
30845>>>    Clear Cities
30846>>>    Move aiCityID to Cities.City_ID
30847>>>    Find Eq Cities By Index.1
30848>>>>
30848>>>    If (Found=1) Move Cities.City_descr to rVal
30851>>>    Else         Move '' to rVal
30853>>>    Function_Return rVal
30854>>>End_Function
30855>>>
30855>>>Function fiTownIDFromCity Global Integer aiCityID Returns Integer
30856>>>    Open Cities
30858>>>    Clear Cities
30859>>>    Move aiCityID to Cities.City_ID
30860>>>    Find Eq Cities By Index.1
30861>>>>
30861>>>    Function_Return Cities.Town_ID
30862>>>End_Function
30863>>>
30863>>>Function fiCountryIDFromTown Global Integer aiTownID Returns Integer
30864>>>    Open Towns
INCLUDING FILE: TOWNS.FD
30866>>>    Clear Towns
30867>>>    Move aiTownID to Towns.Town_ID
30868>>>    Find Eq Towns By Index.1
30869>>>>
30869>>>    Function_Return Towns.Country_ID
30870>>>End_Function
30871>>>
30871>>>Function fsTownDescr Global Integer aiTownID Returns String
30872>>>    String rVal
30873>>>    Open Towns
30875>>>    Clear Towns
30876>>>    Move aiTownID to Towns.Town_ID
30877>>>    Find Eq Towns By Index.1
30878>>>>
30878>>>    If (Found=1) Move Towns.Town_descr to rVal
30881>>>    Else         Move '' to rVal
30883>>>    Function_Return rVal
30884>>>End_Function
30885>>>
30885>>>Function fsCountryDescr Global Integer aiCountryID Returns String
30886>>>    String rVal
30887>>>    Open Country
INCLUDING FILE: COUNTRY.FD
30889>>>    Clear Country
30890>>>    Move aiCountryID to Country.Country_ID
30891>>>    Find Eq Country By Index.1
30892>>>>
30892>>>    If (Found=1) Move Country.Country_descr to rVal
30895>>>    Else         Move '' to rVal
30897>>>    Function_Return rVal
30898>>>End_Function
30899>>>
30899>>>Function fsAreaDescr Global Integer aiAreaID Returns String
30900>>>    String rVal
30901>>>    Open Areas
INCLUDING FILE: AREAS.FD
30903>>>    Clear Areas
30904>>>    Move aiAreaID to Areas.Area_ID
30905>>>    Find Eq Areas By Index.1
30906>>>>
30906>>>    If (Found=1) Move Areas.Area_descr to rVal
30909>>>    Else         Move '' to rVal
30911>>>    Function_Return rVal
30912>>>End_Function
30913>>>
30913>>>Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
30914>>>    Local String rVal lsTmp lsOO lsLL
30915>>>    Local Number lnOO lnLL
30915>>>
30915>>>    Move '' to lsOO
30916>>>    Move '' to lsLL
30917>>>    Move '' to rVal
30918>>>
30918>>>    Move (Integer(anTime))                              to lnOO
30919>>>
30919>>>    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
30920>>>
30920>>>    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
30923>>>    Else         Move (String(lnOO))                    to lsOO
30925>>>    Move (Trim(lsOO))                                   to lsOO
30926>>>
30926>>>    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
30929>>>    Else         Move (String(lnLL))                    to lsLL
30931>>>    Move (Trim(lsLL))                                   to lsLL
30932>>>
30932>>>    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
30933>>>
30933>>>    Move (Trim(rVal)) to rVal
30934>>>
30934>>>    Function_Return rVal
30935>>>End_Function
30936>>>
30936>>>Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
30937>>>    Local Number rVal nOres nLepta
30938>>>    Move (Integer(aiMinutes/60))    to nOres
30939>>>    Move (    Mod(aiMinutes,60))    to nLepta
30940>>>    Move (nOres+(nLepta/100))       to rVal
30941>>>    Function_Return rVal
30942>>>End_Function
30943>>>
30943>>>Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
30944>>>    Local Integer rVal
30945>>>    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
30946>>>    Function_Return rVal
30947>>>End_Function
30948>>>
30948>>>Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;                                                                    Number anEndTime    ;                                                                    Returns Integer
30949>>>    Local Integer rVal iMinStart iMinEnd
30950>>>
30950>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30953>>>
30953>>>    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
30954>>>    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
30955>>>    Move (iMinEnd-iMinStart)                                                     to rVal
30956>>>    Function_Return rVal
30957>>>End_Function
30958>>>
30958>>>
30958>>>Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;                                                                Number anEndTime    ;                                                                Returns Number
30959>>>    Local Integer iTmp
30960>>>    Local Number  rVal
30960>>>
30960>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30963>>>
30963>>>    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
30964>>>    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
30965>>>    Function_Return rVal
30966>>>End_Function
30967>>>
30967>>>
30967>>>Open WitemCL
INCLUDING FILE: WITEMCL.FD
30969>>>Open WitemCld
INCLUDING FILE: WITEMCLD.FD
30971>>>Open WitemxT
INCLUDING FILE: WITEMXT.FD
30973>>>
30973>>>Function fnTeleytaiaTimhAgoras String asPromCode String asItemCode  ;                               Date   adHmnia    Number anQty       ;                               Returns Number
30974>>>  Integer iExodos
30975>>>  Number nPoso nPct
30975>>>  Move 0 to nPoso
30976>>>  Move 0 to nPct
30977>>>  Move 0 to iExodos
30978>>>
30978>>>  Move (Trim(asItemCode)) to asItemCode
30979>>>  Move (Trim(asPromCode)) to asPromCode
30980>>>
30980>>>  // 1.Anazhthsh sto arxeio Witemcld
30980>>>  Clear Witemcld
30981>>>  Move asItemCode to Witemcld.Item_Code
30982>>>  Move asPromCode to Witemcld.Client_Code
30983>>>  Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30984>>>>
30984>>>  While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;                       (Witemcld.Client_Code= asPromCode) And ;                       (iExodos=0))
30988>>>      If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30990>>>          Move 1 to iExodos
30991>>>               If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30994>>>          Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30998>>>      End
30998>>>>
30998>>>      Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30999>>>>
30999>>>  Loop
31000>>>>
31000>>>  If (iExodos) Begin
31002>>>      If (nPoso) Function_Return nPoso
31005>>>      Else Function_Return nPct
31007>>>  End
31007>>>>
31007>>>
31007>>>  // 2.Anazhthsh sto arxeio Witemcl
31007>>>  Clear WitemCL
31008>>>  Move (Trim(asPromCode)) to WitemCL.Client_Code
31009>>>  Move (Trim(asItemCode)) to WitemCL.Item_Code
31010>>>  Find Eq WitemCL By Index.1
31011>>>>
31011>>>  If (Found=1) Function_Return WitemCL.Client_Price
31014>>>
31014>>>  Function_Return 0
31015>>>End_Function
31016>>>
31016>>>
31016>>>Open BtnOrdd
INCLUDING FILE: BTNORDD.FD
31018>>>
31018>>>Function fnTeleytaiaTimhPolhshs String asWitemxRecr String asClientID ;                                String asWitemxCode Date   adHmnia    ;                                String asItemCode   Number anQty      ;                                String asCNCode     Returns Number
31019>>>
31019>>>  Integer iExodos iCheckDeop
31020>>>  Number nPoso nPct
31020>>>
31020>>>  Move (Num_Arguments=7) to iCheckDeop
31021>>>
31021>>>  Move 0 to nPoso
31022>>>  Move 0 to nPct
31023>>>  Move 0 to iExodos
31024>>>
31024>>>  Move (Trim(asItemCode))                 to asItemCode
31025>>>  Move (Trim(asClientID))                 to asClientID
31026>>>  Move (Trim(asWitemxRecr))               to asWitemxRecr
31027>>>  Move (Trim(asWitemxCode))               to asWitemxCode
31028>>>  If (iCheckDeop) Move (Trim(asCNCode))   to asCNCode
31031>>>
31031>>>  // 1. Anazhthsh apo DEOP ef' oson yparxei kodikos ergou
31031>>>  If (iCheckDeop) Begin
31033>>>      Clear btnordd
31034>>>      Move asClientID   to btnordd.vclient_id
31035>>>      Move asCNCode     to btnordd.vcn_code
31036>>>      Move asWitemxCode to btnordd.vitem
31037>>>      Move 0            to btnordd.vactive
31038>>>      Move adHmnia      to btnordd.arxh_date
31039>>>      Find LE btnordd by index.4//client_id+cn_code+item+arxh_date
31040>>>>
31040>>>      If ((found=1) and (asWitemxCode=btnordd.vitem)    and (adHmnia>=btnordd.arxh_date) ;                    and (adHmnia<=btnordd.deop_date)    and (btnordd.vactive=0)          ;                    and (asCNCode=btnordd.vcn_code)) begin
31042>>>          move btnordd.vprice to nPoso
31043>>>          If (nPoso) Function_Return nPoso
31046>>>      End
31046>>>>
31046>>>  End
31046>>>>
31046>>>  // 19-03-2007 Tolhs na pernei times mono an brei apo deop
31046>>>  // 2.Anazhthsh sto arxeio Witemcld (Timokatalogos Pelath/Eidous)
31046>>> // Clear Witemcld
31046>>> // Move asItemCode to Witemcld.Item_Code
31046>>> // Move asClientID to Witemcld.Client_Code
31046>>> // Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
31046>>> // While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;
31046>>> //                      (Witemcld.Client_Code= asClientID) And ;
31046>>> //                      (iExodos=0))
31046>>> //     If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
31046>>> //         Move 1 to iExodos
31046>>> //              If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
31046>>> //         Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
31046>>> //     End
31046>>> //     Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
31046>>> // Loop
31046>>> // If (iExodos) Begin
31046>>> //     If (nPoso) Function_Return nPoso
31046>>> //     Else Function_Return nPct
31046>>> // End
31046>>>
31046>>>
31046>>>  // 3.Anazhthsh sto arxeio Witemxt (Timokatalogos Eidous)
31046>>>  //Clear Witemxt
31046>>>  //Move SysCurXr.Company_Code  to Witemxt.Company_Code
31046>>>  //Move SysCurXr.Branch_Code   to Witemxt.Branch_Code
31046>>>  //Move SysCurXr.Year_Year     to Witemxt.Year_Year
31046>>>  //Move asWitemxRecr           to Witemxt.Witemx_Recr
31046>>>  //Find Gt Witemxt By Index.1 // Witemxt:Index.1
31046>>>  //While ((Found=1) And (Witemxt.Company_Code = SysCurXr.Company_Code) And ;
31046>>>  //                     (Witemxt.Branch_Code  = SysCurXr.Branch_Code ) And ;
31046>>>  //                     (Witemxt.Year_Year    = SysCurXr.Year_Year   ) And ;
31046>>>  //                     (Witemxt.Witemx_Recr  = asWitemxRecr         ) And ;
31046>>>  //                     (iExodos=0))
31046>>>  //    If ((adHmnia>=Witemxt.Value_Date) And (anQty<=Witemxt.Qty)) Begin
31046>>>  //        Move 1 to iExodos
31046>>>  //             If (Witemxt.Axia0 <>0) Move  Witemxt.Axia0         to nPoso
31046>>>  //        Else If (Witemxt.PcDisc<>0) Move (Witemxt.PcDisc*(-1))  to nPct
31046>>>  //    End
31046>>>  //    Find Gt Witemxt By Index.1 // Witemxt:Index.1
31046>>>  //Loop
31046>>>  //If (iExodos) Begin
31046>>>  //    If (nPoso) Function_Return nPoso
31046>>>  //    Else Function_Return nPct
31046>>>  //End
31046>>>
31046>>>
31046>>>  // 4.Anazhthsh sto arxeio Witemcl (Teleytaia Timh Agoras)
31046>>>  //Clear WitemCL
31046>>>  //Move (Trim(asClientID)) to WitemCL.Client_Code
31046>>>  //Move (Trim(asItemCode)) to WitemCL.Item_Code
31046>>>  //Find Eq WitemCL By Index.1
31046>>>  //If (Found=1) Function_Return WitemCL.Client_Price
31046>>>
31046>>>  Function_Return 0
31047>>>End_Function
31048>>>
31048>>>Function fsStripTextFieldFromEnter Global String asStr Returns String
31049>>>    String sEnter
31050>>>    Move '' to sEnter
31051>>>    Move (Trim(asStr)) to asStr
31052>>>    Append sEnter (Character(13)) (Character(10))
31054>>>    Move (Replaces(sEnter,asStr,' ')) to asStr
31055>>>    Function_return (Trim(asStr))
31056>>>End_function
31057>>>
31057>>>
31057>>>//end   of global functions and procedures
31057>>>Use Wait.DG
INCLUDING FILE: WAIT.DG
31057>>>>>USE AllEntSc
31057>>>>>
31057>>>>>//AB-IgnoreEnd
31057>>>>>
31057>>>>>
31057>>>>>//AB-IgnoreEnd
31057>>>>>
31057>>>>>Object Wait is a ModalPanelSub
31059>>>>>
31059>>>>>    //AB-StoreTopStart
31059>>>>>
31059>>>>>    // How to Use It
31059>>>>>    // Get the maximum position of the bar
31059>>>>>    // Move (Bar_Maximum_position(Wait(self))) to iMax
31059>>>>>    //
31059>>>>>    // Set the maximum position of the bar
31059>>>>>    // Set Bar_Maximum_position of (Wait(self)) to iMax
31059>>>>>    //
31059>>>>>    // Start Bar Progress from beginning
31059>>>>>    // Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
31059>>>>>    //
31059>>>>>    // End Bar Progress
31059>>>>>    // Send Bar_Current_Position to (Wait(Self)) iMax iMax iMax False
31059>>>>>    //
31059>>>>>    // Update Bar Progress
31059>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax True OR
31059>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax False
31059>>>>>    // When you want the update to be done for every i (this is slower)
31059>>>>>    // Where i=Counter's current value, icounter=Counter's Max Value and iMax=Bar Max Position
31059>>>>>    //
31059>>>>>    // Display Buttons on the object
31059>>>>>    // Set Button_State of (Wait(Self)) to False/True
31059>>>>>    // If the Progress Bar gets initialized without buttons, it MUST be Deactivated
31059>>>>>    //
31059>>>>>    // Initialization of the Progress Bar
31059>>>>>    // Send Popup to (Wait(Self))
31059>>>>>    //
31059>>>>>    // Deactivation of the Progress Bar
31059>>>>>    // Send Deactivate to (Wait(Self))
31059>>>>>    //
31059>>>>>    // Message during the process
31059>>>>>    // Set Wait_Message of (Wait(Self)) to "Now Processing..."
31059>>>>>    //
31059>>>>>    // Extra Info for button "Info >>"
31059>>>>>    // Send Wait_Details to (Wait(Self)) sFile sDetail bInitData
31059>>>>>    // If sFile<>'' then reads the contents of the file
31059>>>>>    // Else Fills the Edit with the string of sDetail
31059>>>>>    // If bInitData is True then the edit object is cleared first else extra info is appended
31059>>>>>    //
31059>>>>>    // Remarks instead of Progress Bar
31059>>>>>    // Set Button_State of (Wait(Self))     to False
31059>>>>>    // Set BarVisibleState of (Wait(Self))  to 'Remarks' False
31059>>>>>    // Update During Process
31059>>>>>    // Send UpdateWait to (Wait(Self)) 'Remarks'
31059>>>>>
31059>>>>>    //AB-StoreTopEnd
31059>>>>>
31059>>>>>    Set Exit_Application_Local_State to FALSE
31060>>>>>    Set Modal_State to FALSE
31061>>>>>    Set Popup_State to TRUE
31062>>>>>    Set Border_Style to Border_Thick
31063>>>>>    Set Minimize_Icon to FALSE
31064>>>>>    Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
31065>>>>>    Set Size to 138 256
31066>>>>>
31066>>>>>    //AB-DDOStart
31066>>>>>
31066>>>>>
31066>>>>>    //AB-DDOEnd
31066>>>>>
31066>>>>>    Object WaitBar is a ProgressBarSub
31068>>>>>
31068>>>>>        //AB-StoreTopStart
31068>>>>>
31068>>>>>        //AB-StoreTopEnd
31068>>>>>
31068>>>>>        Set Size to 21 243
31069>>>>>        Set Location to 7 4
31070>>>>>
31070>>>>>        //AB-StoreStart
31070>>>>>        Send DoRegSize  self smTopRight
31071>>>>>        //AB-StoreEnd
31071>>>>>
31071>>>>>    End_Object
31072>>>>>
31072>>>>>    Object WaitText is a TextBoxSub
31074>>>>>
31074>>>>>        //AB-StoreTopStart
31074>>>>>
31074>>>>>        //AB-StoreTopEnd
31074>>>>>
31074>>>>>        Set Enabled_State to TRUE
31075>>>>>        Set Label to "Processing"
31076>>>>>        Set FontSize to 4 0
31077>>>>>        Set Size to 10 81
31078>>>>>        Set Location to 36 5
31079>>>>>
31079>>>>>        //AB-StoreStart
31079>>>>>
31079>>>>>        //AB-StoreEnd
31079>>>>>
31079>>>>>    End_Object
31080>>>>>
31080>>>>>    Object bnCancel is a ButtonSub
31082>>>>>
31082>>>>>        //AB-StoreTopStart
31082>>>>>
31082>>>>>        //AB-StoreTopEnd
31082>>>>>
31082>>>>>        Set Default_State to TRUE
31083>>>>>        Set Label to "OK"
31084>>>>>        Set Location to 34 143
31085>>>>>
31085>>>>>        //AB-StoreStart
31085>>>>>
31085>>>>>        Procedure OnClick
31087>>>>>             Send Deactivate to (Wait(Self))
31088>>>>>        End_Procedure
31089>>>>>
31089>>>>>        Send DoRegAlign self amTopRight
31090>>>>>        //AB-StoreEnd
31090>>>>>
31090>>>>>    End_Object
31091>>>>>
31091>>>>>    Object bnDetail is a ButtonSub
31093>>>>>
31093>>>>>        //AB-StoreTopStart
31093>>>>>
31093>>>>>        //AB-StoreTopEnd
31093>>>>>
31093>>>>>        Set Focus_Mode to Pointer_Only
31094>>>>>        Set Label to "Info >>"
31095>>>>>        Set Location to 34 197
31096>>>>>
31096>>>>>        //AB-StoreStart
31096>>>>>
31096>>>>>        Procedure OnClick
31098>>>>>            Delegate Send Show_Details False
31100>>>>>        End_Procedure
31101>>>>>
31101>>>>>        Send DoRegAlign self amTopRight
31102>>>>>        //AB-StoreEnd
31102>>>>>
31102>>>>>    End_Object
31103>>>>>
31103>>>>>    Object LineControlSub1 is a LineControlSub
31105>>>>>
31105>>>>>        //AB-StoreTopStart
31105>>>>>
31105>>>>>        //AB-StoreTopEnd
31105>>>>>
31105>>>>>        Set Size to 2 243
31106>>>>>        Set Location to 54 4
31107>>>>>
31107>>>>>        //AB-StoreStart
31107>>>>>
31107>>>>>        Send DoRegSize  self smTopRight
31108>>>>>        //AB-StoreEnd
31108>>>>>
31108>>>>>    End_Object
31109>>>>>
31109>>>>>    Object WaitEdit is a editSub
31111>>>>>
31111>>>>>        //AB-StoreTopStart
31111>>>>>
31111>>>>>        //AB-StoreTopEnd
31111>>>>>
31111>>>>>        Set Enabled_State to FALSE
31112>>>>>        Set Read_Only_State to TRUE
31113>>>>>        Set Size to 58 243
31114>>>>>        Set Location to 60 4
31115>>>>>        Set Color to clWhite
31116>>>>>
31116>>>>>        //AB-StoreStart
31116>>>>>
31116>>>>>        Send DoRegSize Self amBottomRight
31117>>>>>        Delegate Set Size to 66 256
31119>>>>>
31119>>>>>        //AB-StoreEnd
31119>>>>>
31119>>>>>    End_Object
31120>>>>>
31120>>>>>    Object oTxtAntiBar is a TextBoxSub
31122>>>>>        Set Enabled_State to TRUE
31123>>>>>        Set Visible_State to FALSE
31124>>>>>        Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
31125>>>>>        Set Justification_Mode to (jMode_Center IOR jMode_VCenter)
31126>>>>>        Set Auto_Size_State to FALSE
31127>>>>>        Set FontWeight to 600
31128>>>>>        Set FontSize to 4 0
31129>>>>>        Set Size to 10 209
31130>>>>>        Set Location to 10 4
31131>>>>>        Set TextColor to clNavy
31132>>>>>    End_Object
31133>>>>>
31133>>>>>
31133>>>>>    //AB-StoreStart
31133>>>>>    Property Integer piWaitSize  Public (Size(Self))
31135>>>>>    Property Integer piPrevSize  Public (Size(Self))
31137>>>>>    Property Integer piState     Public False
31139>>>>>
31139>>>>>    Set Locate_Mode to Center_On_Screen
31140>>>>>    Set Destroy_Object_State to True
31141>>>>>
31141>>>>>    Procedure Show_Details Integer bAlways
31143>>>>>        Local Integer liOriSize liSize hiSize hiOriSize lowSize bState
31144>>>>>        Local String sLabel
31144>>>>>        Get Size                to liSize
31145>>>>>        Get piState             to bState
31146>>>>>        Get piWaitSize          to liOriSize
31147>>>>>        Move (Hi(liSize))       to hiSize
31148>>>>>        Move (Low(liSize))      to lowSize
31149>>>>>        Move (Hi(liOriSize))    to hiOriSize
31150>>>>>        If (bAlways) Begin
31152>>>>>            Set piState         to False
31153>>>>>            Move 0              to bState
31154>>>>>        End
31154>>>>>>
31154>>>>>        If bState Begin
31156>>>>>             Set Size to hiOriSize lowSize
31157>>>>>             Set Label of (bnDetail(Self)) to "Info >>"
31158>>>>>        End
31158>>>>>>
31158>>>>>        Else Begin
31159>>>>>             Set Size to 138 lowSize
31160>>>>>             Set Label of (bnDetail(Self)) to "<< Info"
31161>>>>>        End
31161>>>>>>
31161>>>>>        Set piState to (1-bState)
31162>>>>>    End_Procedure
31163>>>>>
31163>>>>>    Procedure Bar_Current_Position Integer iCount Integer iOccurances Integer iMaximum Integer bState
31165>>>>>       If (bState) Begin
31167>>>>>         If (Mod(iCount,(iCount*((Number(iMaximum))/(Number(iOccurances)))))=0) ;            Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
31170>>>>>       End
31170>>>>>>
31170>>>>>       Else Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
31172>>>>>    End_Procedure
31173>>>>>
31173>>>>>    Procedure DoInitialize_WaitBar
31175>>>>>        Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
31176>>>>>    End_Procedure
31177>>>>>
31177>>>>>    Procedure DoTerminate_WaitBar
31179>>>>>        Local Integer iMax
31180>>>>>        Get Maximum_position of (WaitBar(Self)) to iMax
31181>>>>>        Send Bar_Current_Position to (Wait(Self)) iMax iMax Imax False
31182>>>>>    End_Procedure
31183>>>>>
31183>>>>>    Procedure Set Bar_Maximum_Position Integer iMaximum
31185>>>>>         Set Maximum_position of (WaitBar(Self)) to iMaximum
31186>>>>>    End_Procedure
31187>>>>>
31187>>>>>    Function Bar_Maximum_Position Returns Integer
31189>>>>>        Function_Return (Maximum_position(WaitBar(Self)))
31190>>>>>    End_Function
31191>>>>>
31191>>>>>    Procedure Set Bar_Minimum_Position Integer iMinimum
31193>>>>>         Set Minimum_position of (WaitBar(Self)) to iMinimum
31194>>>>>    End_Procedure
31195>>>>>
31195>>>>>    Function Bar_Minimum_Position Returns Integer
31197>>>>>        Function_Return (Minimum_position(WaitBar(Self)))
31198>>>>>    End_Function
31199>>>>>
31199>>>>>    Procedure Set Bar_Step_Value Integer iStep
31201>>>>>         Set Step_Value of (WaitBar(Self)) to iStep
31202>>>>>    End_Procedure
31203>>>>>
31203>>>>>    Function Bar_Step_Value Returns Integer
31205>>>>>        Function_Return (Step_Value(WaitBar(Self)))
31206>>>>>    End_Function
31207>>>>>
31207>>>>>    Procedure Set Wait_Message String sMessage
31209>>>>>        Set Value of (WaitText(Self)) to sMessage
31210>>>>>    End_Procedure
31211>>>>>
31211>>>>>    Procedure Wait_Details String sFile String sDetail Integer bInitData
31213>>>>>        Local Integer liEditId
31214>>>>>        Move (WaitEdit(Self)) to liEditId
31215>>>>>        If bInitData Send Delete_Data to liEditId
31218>>>>>        If sFile ne "" Begin
31220>>>>>           Send Read to liEditId sFile
31221>>>>>           Send Beginning_Of_Data to liEditId
31222>>>>>        End
31222>>>>>>
31222>>>>>        Else Begin
31223>>>>>           Send Insert to liEditId sDetail
31224>>>>>        End
31224>>>>>>
31224>>>>>    End_Procedure
31225>>>>>
31225>>>>>    Procedure OnResize
31227>>>>>        Local Integer liSize liHiSize liPrevSize liHiPrevSize bState liHiLoc liLoc
31228>>>>>        Get Size to liPrevSize
31229>>>>>        Move (Hi(liPrevSize)) to liHiPrevSize
31230>>>>>        Forward Send OnResize
31232>>>>>        Get Location of (WaitEdit(Self)) to liLoc
31233>>>>>        Move (Hi(liLoc)) to liHiLoc
31234>>>>>        Get piState to bState
31235>>>>>        Get Size to liSize
31236>>>>>        Move (Hi(liSize)) to liHiSize
31237>>>>>        If (liHiSize > (liHiLoc +30)) Begin
31239>>>>>            Set Value of (bnDetail(Self)) to "<< Info"
31240>>>>>            If (liHiPrevSize <= (liHiLoc +30)) Set piState to (1-bState)
31243>>>>>        End
31243>>>>>>
31243>>>>>        Else Begin
31244>>>>>            Set Value of (bnDetail(Self)) to "Info >>"
31245>>>>>            If (liHiPrevSize > (liHiLoc +30)) Set piState to (1-bState)
31248>>>>>        End
31248>>>>>>
31248>>>>>    End_Procedure
31249>>>>>
31249>>>>>    Procedure Set Button_State Integer bState
31251>>>>>        If bState Begin
31253>>>>>            Set Caption_Bar to True
31254>>>>>            Set Size to 66 256
31255>>>>>        End
31255>>>>>>
31255>>>>>        Else Begin
31256>>>>>            Set Caption_Bar to False
31257>>>>>            Set Size to 38 256
31258>>>>>        End
31258>>>>>>
31258>>>>>    End_Procedure
31259>>>>>
31259>>>>>    Procedure Set BarVisibleState String sMsg Integer bState
31261>>>>>        Set Visible_State of (oTxtAntiBar(Self)) to (bState = 0)
31262>>>>>        Set Visible_State of (WaitBar(Self))     to (bState = 1)
31263>>>>>        If (bState = 0) Begin
31265>>>>>            Set Size to 24 256
31266>>>>>            Set Location of (oTxtAntiBar(Self)) to 6 5
31267>>>>>        End
31267>>>>>>
31267>>>>>        If sMsg ne "" Set Value of (oTxtAntiBar(Self)) to sMsg
31270>>>>>    End_Procedure
31271>>>>>
31271>>>>>    Procedure Deactivating integer search_mode Returns Integer
31273>>>>>        local integer rval
31274>>>>>        Forward Get MSG_Deactivating search_mode to rval
31276>>>>>        Set Modal_State of (Wait(Self)) to False
31277>>>>>        Set BarVisibleState of (Wait(Self)) to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..." True
31278>>>>>        Procedure_Return rval
31279>>>>>    End_Procedure
31280>>>>>
31280>>>>>    Procedure UpdateWait String sMsg
31282>>>>>        Set Value of (oTxtAntiBar(Self)) to sMsg
31283>>>>>    End_Procedure
31284>>>>>
31284>>>>>
31284>>>>>    Procedure Set Horizontal_Justification Integer aiMode
31286>>>>>        Set Justification_Mode of oTxtAntiBar to (jMode_VCenter IOR aiMode)
31287>>>>>    End_Procedure
31288>>>>>
31288>>>>>
31288>>>>>
31288>>>>>
31288>>>>>
31288>>>>>
31288>>>>>    //AB-StoreEnd
31288>>>>>
31288>>>>>End_Object
31289>>>>>
31289>>>>>
31289>>>>>//AB-StoreStart
31289>>>>>
31289>>>>>//AB-StoreEnd
31289>>>>>
31289>>>>>//AB/ End_Object    // prj
31289>>>
31289>Use Calendar.sl
INCLUDING FILE: CALENDAR.SL
31289>>>//AB/ Project Calendar
31289>>>//AB/ Object prj is a Lookup_Project
31289>>>//AB/     Set ProjectName to "Calendar"
31289>>>//AB/     Set ProjectFileName to "Calendar.sl"
31289>>>
31289>>>// Project Object Structure
31289>>>//   oCalendar is a dbModalPanel
31289>>>//     Container3d1 is a Container3d
31289>>>//       Grid2 is a Grid
31289>>>//       Textbox2 is a Textbox
31289>>>//       Textbox3 is a Textbox
31289>>>//       Textbox4 is a Textbox
31289>>>//       Textbox5 is a Textbox
31289>>>//       Textbox6 is a Textbox
31289>>>//       Textbox7 is a Textbox
31289>>>//       Textbox8 is a Textbox
31289>>>//       LineControl1 is a LineControl
31289>>>//       Container3d2 is a Container3d
31289>>>//         oRght is a BitmapContainer
31289>>>//         oLeft is a BitmapContainer
31289>>>//         oMonth is a Textbox
31289>>>//           oSelectMonth is a FloatingPopupMenu
31289>>>//         oYear is a Textbox
31289>>>//         oSelectYear is a Form
31289>>>//     BitmapContainer3 is a BitmapContainer
31289>>>//     oToday is a Textbox
31289>>>
31289>>>// Register all objects
31289>>>Register_Object BitmapContainer3
31289>>>Register_Object Container3d1
31289>>>Register_Object Container3d2
31289>>>Register_Object Grid2
31289>>>Register_Object LineControl1
31289>>>Register_Object oCalendar
31289>>>Register_Object oLeft
31289>>>Register_Object oMonth
31289>>>Register_Object oRght
31289>>>Register_Object oSelectMonth
31289>>>Register_Object oSelectYear
31289>>>Register_Object oToday
31289>>>Register_Object oYear
31289>>>Register_Object Textbox2
31289>>>Register_Object Textbox3
31289>>>Register_Object Textbox4
31289>>>Register_Object Textbox5
31289>>>Register_Object Textbox6
31289>>>Register_Object Textbox7
31289>>>Register_Object Textbox8
31289>>>
31289>>>
31289>>>
31289>>>//AB-StoreTopStart
31289>>>Use dates.utl
INCLUDING FILE: DATES.UTL
31289>>>>>// **********************************************************************
31289>>>>>// Use Dates.utl    // Date manipulation for VDF and DF3.1
31289>>>>>//
31289>>>>>// by Sture Andersen (sa1@vd.dk)
31289>>>>>//
31289>>>>>// The file contains a number of global functions for manipulating
31289>>>>>// dates. The package may be used with DataFlex 3.1 and Visual DataFlex.
31289>>>>>// This package is public domain.
31289>>>>>//
31289>>>>>// The package file is accompanied by a Word document (dfutil.doc)
31289>>>>>// listing the functions and their use.
31289>>>>>//
31289>>>>>//
31289>>>>>// Create: Fri  06-06-1997 - Merger of s_utl020, 021, 022, 023, 024, 025.
31289>>>>>// Update: Thu  26-06-1997 - Fixes for strange behavior when date4_state is set.
31289>>>>>//                         - Addition of popup_calendar to VDF.
31289>>>>>//         Sun  29-06-1997 - Character mode popup calender.
31289>>>>>//         Fri  04-07-1997 - Function WeekToDate added.
31289>>>>>//         Thu  10-07-1997 - Fixes.
31289>>>>>//         Mon  11-08-1997 - WeekToDate fixed.
31289>>>>>//         Sun  24-08-1997 - Character mode popup calender finished.
31289>>>>>//         Mon  15-12-1997 - Procedure Request_Popup_Calendar added.
31289>>>>>//         Mon  29-12-1997 - Procedures ItemYear2to4, ItemDate2to4 and
31289>>>>>//                           ItemSysdate added.
31289>>>>>//         Mon  29-12-1997 - Procedures FieldYear2to4, FieldDate2to4 and
31289>>>>>//                           FieldSysdate added.
31289>>>>>//         Sun  01-02-1998 - Functions Module_Compile_Date and
31289>>>>>//                           Module_Compile_Time added.
31289>>>>>//         Wed  25-02-1998 - Request_Popup in calendar object now only
31289>>>>>//                           responds if entry_state of the calling object
31289>>>>>//                           is true (VDF version). (No apparent effect)
31289>>>>>//         Sat  28-03-1998 - Added the following functions:
31289>>>>>//                             TS_SysTime      TS_ExtractDate
31289>>>>>//                             TS_ExtractTime  TS_ConvertToString
31289>>>>>//         Tue  26-05-1998 - Procedure TS_UI_Update added
31289>>>>>//         Sat  01-08-1998 - mask_date_window taken into account
31289>>>>>//         Mon  10-08-1998 - Functions Module_Start_Date and
31289>>>>>//                           Module_Start_Time added.
31289>>>>>//         Wed  02-09-1998 - Parameter for Module_Start_Date removed
31289>>>>>//         Mon  12-10-1998 - Portuguese added
31289>>>>>//         Wed  04-11-1998 - TS_TimeEstimator class added
31289>>>>>//         Tue  29-12-1998 - Function DateAsString added
31289>>>>>//         Wed  13-01-1999 - Function DateWeekNumber changed according to
31289>>>>>//                           Kjetil Johanson
31289>>>>>//         Mon  18-01-1999 - Function DateWeekNumber changed according to
31289>>>>>//                           Kjetil Johanson (again)
31289>>>>>//         Tue  19-01-1999 - Changed procedure names in TS_TimeEstimator
31289>>>>>//                           class (Continue->TS_Continue and Pause->
31289>>>>>//                           TS_Pause)
31289>>>>>//         Thu  21-01-1999 - Procedures DateFormatAsString and DateFormatName
31289>>>>>//                           added.
31289>>>>>//                         - Procedures DateCurrentSeparator and
31289>>>>>//                           DateCurrentFormat added.
31289>>>>>//         Tue  13-04-1999 - Julian constants added: Jan1st1900, Jan1st2000
31289>>>>>//                           Jan1st1000 and Jan1st100
31289>>>>>//         Mon  26-04-1999 - Changed procedure FieldYear2to4 and ItemYear2to4
31289>>>>>//                           to trap 3 digit years.
31289>>>>>//         Wed  27-04-1999 - Changed Dutch abbriviated day names (to 2 characters)
31289>>>>>//         Sun  02-05-1999 - Added function TS_Compose2
31289>>>>>//                         - Fixed error in TS_ConvertToString
31289>>>>>//         Tue  01-06-1999 - Added procedure popup_no_export to calendar.
31289>>>>>//         Thu  15-06-1999 - Fixed Date4to2 function and exporting dates
31289>>>>>//                           from the calendar to forms with no form_margin.
31289>>>>>//         Tue  07-09-1999 - Added function DateAsText
31289>>>>>//         Wed  27-10-1999 - Temporary fix for Module_Compile_Date function
31289>>>>>//                           in combination with y2k.
31289>>>>>//         Wed  19-12-1999 - Function StringToDate added.
31289>>>>>//                         - Existing function DateAsString renamed to
31289>>>>>//                           DateToString.
31289>>>>>//         Mon  03-01-2000 - Fix for VDF4. Popup calendar on empty date field
31289>>>>>//                           would result in seeding the calendar on year 100.
31289>>>>>//                           This error was caused by the fact that VDF 4
31289>>>>>//                           ignores SYSDATE4_STATE such that the sysdate
31289>>>>>//                           command returns 03-01-100
31289>>>>>//         Wed  01-02-2000 - Define instead of #REPLACE
31289>>>>>//         Wed  23-08-2000 - Function TS_Module_Compile_Time added
31289>>>>>//
31289>>>>>// NOTE:  There is language dependent string constants in this file.
31289>>>>>//        Currently there are sections for dutch, english, danish, swedish,
31289>>>>>//        norwegian, spanish, german and portuguese
31289>>>>>//
31289>>>>>//        These sections may be identified by searching the symbol LNG_DEFAULT
31289>>>>>//
31289>>>>>// ***********************************************************************
31289>>>>>
31289>>>>>Use ui
31289>>>>>Use Language    // Set default languange if not set by compiler command line
INCLUDING FILE: LANGUAGE.PKG
31289>>>>>>>// Use Language     // Default language setup
31289>>>>>>>// Sets default languange if not set by compiler command line
31289>>>>>>>
31289>>>>>>>define lng_dutch      for 131
31289>>>>>>>define lng_french     for 133 // NOT TRANSLATED. DO NOT SELECT!
31289>>>>>>>define lng_spanish    for 134
31289>>>>>>>define lng_italian    for 139 // NOT TRANSLATED. DO NOT SELECT!
31289>>>>>>>define lng_english    for 144
31289>>>>>>>define lng_danish     for 145
31289>>>>>>>define lng_swedish    for 146
31289>>>>>>>define lng_norwegian  for 147
31289>>>>>>>define lng_Greek    for 148
31289>>>>>>>define lng_german     for 149
31289>>>>>>>define lng_portuguese for 155
31289>>>>>>>define lng_papiamentu for 199 // NOT TRANSLATED. DO NOT SELECT!
31289>>>>>>>
31289>>>>>>>
31289>>>>>>>define lng_default for !@
31289>>>>>>>
31289>>>>>>>  define _LANGUAGE_ for $ENGLISH$
31289>>>>>>>
#REM LANGUAGE SET BY LANGUAGE.PKG: $ENGLISH$
31289>>>>>Use Seq_Chnl    // Defines global sequential device management operations (DAC)
31289>>>>>Use Macros.utl  // Various macros (DESKTOP_SECTION)
INCLUDING FILE: MACROS.UTL
31289>>>>>>>// Use Macros.utl   // Various macros (FOR_EX...)
31289>>>>>>>
31289>>>>>>>//  FOR_EX (extended FOR command)
31289>>>>>>>//  -----------------------------
31289>>>>>>>//> The FOR_EX command is exactly like the standard FOR command except
31289>>>>>>>//> that it will allow you to use keyword "DOWN_TO" instead of "TO" if
31289>>>>>>>//> you need to do a decremental loop.
31289>>>>>>>
31289>>>>>>>
31289>>>>>>>//  DESKTOP_SECTION
31289>>>>>>>//  ---------------
31289>>>>>>>//> The DESKTOP_SECTION/END_DESKTOP_SECTION commands will make a sequence of
31289>>>>>>>//> code compile (or rather instantiate) as if it was situated on the DESKTOP
31289>>>>>>>//> even when it isn't. DESKTOP_SECTION's may not be nested.
31289>>>>>>>
31289>>>>>>>
31289>>>>>>>
31289>>>>>
31289>>>>>// Switches
31289>>>>>
31289>>>>>define DATES_INCLUDE_POPUP for 1   // If set to 0 the popup calendar will not be included
31289>>>>>define DATES_DF31B_EPOCH   for 40  // DF3.1b didn't have an epoch setting. Therefore this symbol defines the epoch value for that version.
31289>>>>>
31289>>>>> define t.calendar.year           for "Year"
31289>>>>> define t.calendar.month          for "Month"
31289>>>>> define t.calendar.day            for "Day"
31289>>>>> define t.calendar.week           for "Wk."
31289>>>>> define t.calendar.calendar_popup for "Calendar Popup"
31289>>>>> define t.calendar.Monday         for "Monday"
31289>>>>> define t.calendar.Tuesday        for "Tuesday"
31289>>>>> define t.calendar.Wednesday      for "Wednesday"
31289>>>>> define t.calendar.Thursday       for "Thursday"
31289>>>>> define t.calendar.Friday         for "Friday"
31289>>>>> define t.calendar.Saturday       for "Saturday"
31289>>>>> define t.calendar.Sunday         for "Sunday"
31289>>>>> define t.calendar.January        for "January"
31289>>>>> define t.calendar.February       for "February"
31289>>>>> define t.calendar.March          for "March"
31289>>>>> define t.calendar.April          for "April"
31289>>>>> define t.calendar.May            for "May"
31289>>>>> define t.calendar.June           for "June"
31289>>>>> define t.calendar.July           for "July"
31289>>>>> define t.calendar.August         for "August"
31289>>>>> define t.calendar.September      for "September"
31289>>>>> define t.calendar.October        for "October"
31289>>>>> define t.calendar.November       for "November"
31289>>>>> define t.calendar.December       for "December"
31289>>>>> define t.calendar.ok             for "OK"
31289>>>>> define t.calendar.Cancel         for "Cancel"
31289>>>>> define t.calendar.Activate       for "Activate popup calendar (Ctrl+D)"
31289>>>>>
31289>>>>>define LargestPossibleDate for 913490 // December 31st 2500
31289>>>>>define Jan1st1900          for 693975
31289>>>>>define Jan1st2000          for 730500
31289>>>>>define Jan1st1000          for 365250
31289>>>>>define Jan1st105           for 38352
31289>>>>>define Jan1st100           for 36525
31289>>>>>
31289>>>>>enumeration_list // Date Segments
31289>>>>>  define DS_DAY
31289>>>>>  define DS_WEEK
31289>>>>>  define DS_MONTH
31289>>>>>  define DS_YEAR
31289>>>>>end_enumeration_list
31289>>>>>
31289>>>>>integer Dates$Year Dates$Month Dates$Day // internal use
31289>>>>>
31289>>>>>procedure DateDecompose global date date# //very internal!!
31290>>>>>  local integer pos1# pos2# format#
31291>>>>>  local string str# sep#
31291>>>>>  get_attribute DF_DATE_FORMAT to format#
31294>>>>>  get_attribute DF_DATE_SEPARATOR to pos1# // overload
31297>>>>>  character pos1# to sep#                  // end overload
31298>>>>>>
31298>>>>>  move date# to str#
31299>>>>>  replace sep# in str# with "$"
31301>>>>>  move strmark to pos1#
31302>>>>>  if [found] begin
31304>>>>>    replace sep# in str# with "$"
31306>>>>>    move strmark to pos2#
31307>>>>>  end
31307>>>>>>
31307>>>>>  else begin
31308>>>>>    move 0 to Dates$Year
31309>>>>>    move 0 to Dates$Month
31310>>>>>    move 0 to Dates$Day
31311>>>>>  end
31311>>>>>>
31311>>>>>  [ found] begin
31313>>>>>>
31313>>>>>    if format# eq DF_DATE_EUROPEAN ;          left str# to Dates$Day    (pos1#-1)
31317>>>>>    if format# eq DF_DATE_USA begin
31319>>>>>          mid  str# to Dates$Day    (pos2#-pos1#-1) (pos1#+1)
31322>>>>>>
31322>>>>>          left str# to Dates$Month  (pos1#-1)
31324>>>>>>
31324>>>>>    end
31324>>>>>>
31324>>>>>    else  mid  str# to Dates$Month  (pos2#-pos1#-1) (pos1#+1)
31328>>>>>
31328>>>>>    if format# eq DF_DATE_MILITARY begin
31330>>>>>          mid  str# to Dates$Day  2 (pos2#+1)
31333>>>>>>
31333>>>>>          left str# to Dates$Year   (pos1#-1)
31335>>>>>>
31335>>>>>    end
31335>>>>>>
31335>>>>>    else  mid  str# to Dates$Year 4 (pos2#+1)
31339>>>>>  end
31339>>>>>>
31339>>>>>end_procedure
31340>>>>>
31340>>>>>function DateCompose global integer day# integer month# integer year# returns date
31341>>>>>  local integer format#
31342>>>>>  local date date#
31342>>>>>  local string sep#
31342>>>>>  ifnot (day#*month#*year#) function_return 0
31345>>>>>  get_attribute DF_DATE_SEPARATOR to format# // overload
31348>>>>>  character format# to sep#                  // end overload
31349>>>>>>
31349>>>>>  get_attribute DF_DATE_FORMAT to format#
31352>>>>>  if day# gt 28 begin
31354>>>>>    if format# eq DF_DATE_EUROPEAN move (date(string(day#)+sep#+string(month#)+sep#+string(year#))) to date# // DMY
31357>>>>>    if format# eq DF_DATE_USA      move (date(string(month#)+sep#+string(day#)+sep#+string(year#))) to date# // MDY
31360>>>>>    if format# eq DF_DATE_MILITARY move (date(string(year#)+sep#+string(month#)+sep#+string(day#))) to date# // YMD
31363>>>>>    send DateDecompose date#
31364>>>>>    if Dates$Month ne month# move (day#-Dates$Day) to day#
31367>>>>>  end
31367>>>>>>
31367>>>>>  if format# eq DF_DATE_EUROPEAN function_return (date(string(day#)+sep#+string(month#)+sep#+string(year#))) // DMY
31370>>>>>  if format# eq DF_DATE_USA function_return (date(string(month#)+sep#+string(day#)+sep#+string(year#))) // MDY
31373>>>>>  function_return (date(string(year#)+sep#+string(month#)+sep#+string(day#))) // YMD
31374>>>>>end_function
31375>>>>>
31375>>>>>function DateFormatName global integer format# returns string
31376>>>>>  if format# eq DF_DATE_EUROPEAN function_return "European"
31379>>>>>  if format# eq DF_DATE_USA      function_return "United States"
31382>>>>>  if format# eq DF_DATE_MILITARY function_return "Military"
31385>>>>>end_function
31386>>>>>
31386>>>>>function DateCurrentSeparator global returns string
31387>>>>>  local integer rval#
31388>>>>>  get_attribute DF_DATE_SEPARATOR to rval#
31391>>>>>  function_return (character(rval#))
31392>>>>>end_function
31393>>>>>
31393>>>>>function DateCurrentFormat global returns integer
31394>>>>>  local integer rval#
31395>>>>>  get_attribute DF_DATE_FORMAT to rval#
31398>>>>>  function_return rval#
31399>>>>>end_function
31400>>>>>
31400>>>>>function DateFormatAsString global integer format# integer long# string sep# returns string
31401>>>>>  local string rval# letter#
31402>>>>>  if format# eq DF_DATE_EUROPEAN move "3342241111" to rval#
31405>>>>>  if format# eq DF_DATE_USA      move "2243341111" to rval#
31408>>>>>  if format# eq DF_DATE_MILITARY move "1111422433" to rval#
31411>>>>>  left t.calendar.year to letter# 1
31413>>>>>>
31413>>>>>  replace "1" in rval# with letter#
31415>>>>>  replace "1" in rval# with letter#
31417>>>>>  ifnot long# move "" to letter#
31420>>>>>  move (replaces("1",rval#,letter#)) to rval#
31421>>>>>  move (replaces("2",rval#,left(t.calendar.month,1))) to rval#
31422>>>>>  move (replaces("3",rval#,left(t.calendar.day,1))) to rval#
31423>>>>>  if sep# eq "" begin
31425>>>>>    get_attribute DF_DATE_SEPARATOR to format#
31428>>>>>    character format# to sep#
31429>>>>>>
31429>>>>>  end
31429>>>>>>
31429>>>>>  move (replaces("4",rval#,sep#)) to rval#
31430>>>>>  function_return rval#
31431>>>>>end_function
31432>>>>>
31432>>>>>function StringToDate global string date# integer format# integer four_digit_year# string sep# returns date
31433>>>>>  local integer sep_len# day# month# year#
31434>>>>>  move (length(sep#)) to sep_len#
31435>>>>>  if four_digit_year# move 4 to four_digit_year#
31438>>>>>  else move 2 to four_digit_year#
31440>>>>>  if format# eq DF_DATE_EUROPEAN begin // DMY
31442>>>>>    move (mid(date#,2,1)) to day#
31443>>>>>    move (mid(date#,2,3+sep_len#)) to month#
31444>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31445>>>>>  end
31445>>>>>>
31445>>>>>  if format# eq DF_DATE_USA begin // MDY
31447>>>>>    move (mid(date#,2,1)) to month#
31448>>>>>    move (mid(date#,2,3+sep_len#)) to year#
31449>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31450>>>>>  end
31450>>>>>>
31450>>>>>  if format# eq DF_DATE_MILITARY begin // YMD
31452>>>>>    move (mid(date#,four_digit_year#,1)) to year#
31453>>>>>    move (mid(date#,2,1+four_digit_year#+sep_len#)) to month#
31454>>>>>    move (mid(date#,2,3+four_digit_year#+sep_len#+sep_len#)) to day#
31455>>>>>  end
31455>>>>>>
31455>>>>>  function_return (DateCompose(day#,month#,year#))
31456>>>>>end_function
31457>>>>>
31457>>>>>function DateToString global date date# integer format# integer four_digit_year# string sep# returns string
31458>>>>>  local string rval# day# month# year#
31459>>>>>  get Date2to4 date# to date#
31460>>>>>  if (integer(date#)) begin
31462>>>>>    send DateDecompose date#
31463>>>>>    move Dates$Day to day#
31464>>>>>    if Dates$Day lt 10 insert "0" in day# at 1
31468>>>>>    move Dates$Month to month#
31469>>>>>    if Dates$Month lt 10 insert "0" in month# at 1
31473>>>>>    move Dates$Year to year#
31474>>>>>    ifnot four_digit_year# move (right(year#,2)) to year#
31477>>>>>    if format# eq DF_DATE_EUROPEAN move (day#+sep#+month#+sep#+year#) to rval# // DMY
31480>>>>>    if format# eq DF_DATE_USA      move (month#+sep#+day#+sep#+year#) to rval# // MDY
31483>>>>>    if format# eq DF_DATE_MILITARY move (year#+sep#+month#+sep#+day#) to rval# // YMD
31486>>>>>  end
31486>>>>>>
31486>>>>>  function_return rval#
31487>>>>>end_function
31488>>>>>
31488>>>>>// Function DateAsString is only here for compatibility with earlier versions.
31488>>>>>// Use function DateToString instead.
31488>>>>>function DateAsString global date date# integer format# integer four_digit_year# string sep# returns string
31489>>>>>  function_return (DateToString(date#,format#,four_digit_year#,sep#))
31490>>>>>end_function
31491>>>>>
31491>>>>>function DateIncrement global date date# integer segment# integer amount# returns date
31492>>>>>  if (date#=0) function_return 0
31495>>>>>  if segment# eq DS_WEEK function_return (date#+(amount#*7)) //weeks
31498>>>>>  if (segment#<>DS_DAY) begin // months or years
31500>>>>>    send DateDecompose date#
31501>>>>>    if segment# eq DS_MONTH begin //months
31503>>>>>      move (Dates$Month+amount#) to Dates$Month
31504>>>>>      if amount# ge 0 function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-1)/12)*12),Dates$Year+((Dates$Month-1)/12)))
31507>>>>>      function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-12)/12)*12),Dates$Year+((Dates$Month-12)/12)))
31508>>>>>    end //years:
31508>>>>>>
31508>>>>>    if segment# eq DS_YEAR function_return (DateCompose(Dates$Day,Dates$Month,Dates$Year+amount#))
31511>>>>>  end
31511>>>>>>
31511>>>>>  else function_return (date#+amount#) //days
31513>>>>>end_function
31514>>>>>
31514>>>>>function DateSegment global date date# integer segment# returns integer
31515>>>>>  send DateDecompose date#
31516>>>>>  if segment# eq DS_DAY   function_return Dates$Day
31519>>>>>  if segment# eq DS_MONTH function_return Dates$Month
31522>>>>>  if segment# eq DS_YEAR  function_return Dates$Year
31525>>>>>end_function
31526>>>>>
31526>>>>>function DateToInteger global date date# returns integer
31527>>>>>  send DateDecompose date#
31528>>>>>  function_return (Dates$Year*100+Dates$Month*100+Dates$Day)
31529>>>>>end_function
31530>>>>>
31530>>>>>function FirstDayInMonth global date date# returns date
31531>>>>>  local integer month# year#
31532>>>>>  move (DateSegment(date#,DS_MONTH)) to month#
31533>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31534>>>>>  function_return (DateCompose(1,month#,year#))
31535>>>>>end_function
31536>>>>>
31536>>>>>function LastDayInMonth global date date# returns date
31537>>>>>  move (DateIncrement(date#,DS_MONTH,1)) to date#
31538>>>>>  function_return (FirstDayInMonth(date#)-1)
31539>>>>>end_function
31540>>>>>
31540>>>>>function FirstDayInYear global date date# returns date
31541>>>>>  local integer year#
31542>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31543>>>>>  function_return (DateCompose(1,1,year#))
31544>>>>>end_function
31545>>>>>
31545>>>>>function LastDayInYear global date date# returns date
31546>>>>>  move (DateIncrement(date#,DS_YEAR,1)) to date#
31547>>>>>  function_return (FirstDayInYear(date#)-1)
31548>>>>>end_function
31549>>>>>
31549>>>>>// Prior to 18/1-99 version of DateWeekNumber
31549>>>>>//function DateWeekNumber global date date# returns integer
31549>>>>>//  local integer week# first_wd# day_of_year# year#
31549>>>>>//  if (date#=0) function_return 0
31549>>>>>//  get Date2to4 date# to date#
31549>>>>>//  move (DateSegment(date#,DS_YEAR)) to year#
31549>>>>>//  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31549>>>>>//  move (date#-FirstDayInYear(date#)) to day_of_year#
31549>>>>>//  move (day_of_year#-1-7+first_wd#) to day_of_year#
31549>>>>>//  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31549>>>>>//  else move 0 to week#
31549>>>>>//  if first_wd# le 4 increment week#
31549>>>>>//  if week# gt 52 begin
31549>>>>>//    move 1 to week#
31549>>>>>//    if first_wd# eq 4 move 53 to week#
31549>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31549>>>>>//  end
31549>>>>>//  if week# eq 0 begin
31549>>>>>//    //get DateWeekNumber (DateIncrement(date#,DS_YEAR,-1)) to first_wd# // Original line
31549>>>>>//    get DateDayNumber  (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#ÿ // changed line
31549>>>>>//    move 52 to week#
31549>>>>>//    if first_wd# eq 4 move 53 to week#
31549>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31549>>>>>//  end
31549>>>>>//  function_return week#
31549>>>>>//end_function
31549>>>>>
31549>>>>>function DateWeekNumber global date date# returns integer
31550>>>>>  local integer week# first_wd# day_of_year# year# wd#
31551>>>>>  if (date#=0) function_return 0
31554>>>>>  get Date2to4 date# to date#
31555>>>>>  // Leap-year test for actual or previous year
31555>>>>>  // Year# only used for selection between 52 and
31555>>>>>  // Therefore get year# from the first day of actual week
31555>>>>>  get DateDayNumber date# to wd#
31556>>>>>  move (DateSegment(date#-wd#+1,DS_YEAR)) to year#
31557>>>>>
31557>>>>>  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31558>>>>>  move (date#-FirstDayInYear(date#)) to day_of_year#
31559>>>>>  move (day_of_year#-1-7+first_wd#) to day_of_year#
31560>>>>>  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31563>>>>>  else move 0 to week#
31565>>>>>  if first_wd# le 4 increment week#
31568>>>>>  if week# gt 52 begin
31570>>>>>    move 1 to week#
31571>>>>>    if first_wd# eq 4 move 53 to week#
31574>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31581>>>>>  end
31581>>>>>>
31581>>>>>  if week# eq 0 begin
31583>>>>>    // Week 52 or 53
31583>>>>>    get DateDayNumber (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#
31584>>>>>    move 52 to week#
31585>>>>>    if first_wd# eq 4 move 53 to week#
31588>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31595>>>>>  end
31595>>>>>>
31595>>>>>  function_return week#
31596>>>>>end_function
31597>>>>>
31597>>>>>function DayName global integer int# returns string
31598>>>>>  if int# eq 1 function_return t.calendar.Monday
31601>>>>>  if int# eq 2 function_return t.calendar.Tuesday
31604>>>>>  if int# eq 3 function_return t.calendar.Wednesday
31607>>>>>  if int# eq 4 function_return t.calendar.Thursday
31610>>>>>  if int# eq 5 function_return t.calendar.Friday
31613>>>>>  if int# eq 6 function_return t.calendar.Saturday
31616>>>>>  if int# eq 7 function_return t.calendar.Sunday
31619>>>>>  function_return ""
31620>>>>>end_function
31621>>>>>
31621>>>>>function DateDayNumber global date date# returns integer
31622>>>>>  local integer rval# // 1=Monday, ... , 7=Sunday
31623>>>>>  get Date2to4 date# to date#
31624>>>>>  move date# to rval#
31625>>>>>  if rval# begin
31627>>>>>    if rval# gt 693975 move (rval#-2) to rval#
31630>>>>>    move (rval#-((rval#/7)*7)) to rval#
31631>>>>>    if rval# eq 0 move 7 to rval#
31634>>>>>  end
31634>>>>>>
31634>>>>>  function_return rval#
31635>>>>>end_function
31636>>>>>
31636>>>>>function DateDayName global date date# returns string
31637>>>>>  function_return (DayName(DateDayNumber(date#)))
31638>>>>>end_function
31639>>>>>
31639>>>>>function YearMaxWeek global integer year# returns integer
31640>>>>>  local integer wk1# wk2#
31641>>>>>  get DateWeekNumber (DateCompose(31,12,year#)) to wk1#
31642>>>>>  get DateWeekNumber (DateCompose(24,12,year#)) to wk2#
31643>>>>>  function_return (wk1# max wk2#)
31644>>>>>end_function
31645>>>>>
31645>>>>>function WeekToDate global integer year# integer week# returns date
31646>>>>>  local date date#
31647>>>>>  move (DateCompose(1,1,year#)) to date#
31648>>>>>  if (DateWeekNumber(date#)) ne 1 move (date#+7) to date# // week 52 or 53
31651>>>>>  move (date#-DateDayNumber(date#)+1) to date# // Now it's a Monday
31652>>>>>  function_return (week#-1*7+date#)
31653>>>>>end_function
31654>>>>>
31654>>>>>function MonthName global integer int# returns string
31655>>>>>  if int# eq  1 function_return t.calendar.January
31658>>>>>  if int# eq  2 function_return t.calendar.February
31661>>>>>  if int# eq  3 function_return t.calendar.March
31664>>>>>  if int# eq  4 function_return t.calendar.April
31667>>>>>  if int# eq  5 function_return t.calendar.May
31670>>>>>  if int# eq  6 function_return t.calendar.June
31673>>>>>  if int# eq  7 function_return t.calendar.July
31676>>>>>  if int# eq  8 function_return t.calendar.August
31679>>>>>  if int# eq  9 function_return t.calendar.September
31682>>>>>  if int# eq 10 function_return t.calendar.October
31685>>>>>  if int# eq 11 function_return t.calendar.November
31688>>>>>  if int# eq 12 function_return t.calendar.December
31691>>>>>  function_return ""
31692>>>>>end_function
31693>>>>>
31693>>>>>function DateMonthName global date date# returns string
31694>>>>>  function_return (MonthName(DateSegment(date#,DS_MONTH)))
31695>>>>>end_function
31696>>>>>
31696>>>>>function DateAsText global date date# string format# returns string
31697>>>>>  if date# eq 0 function_return ""
31700>>>>>  move (replace("#DN",format#,DateDayName(date#)))                  to format#
31701>>>>>  move (replace("#MN",format#,DateMonthName(date#)))                to format#
31702>>>>>  move (replace("#D" ,format#,string(DateSegment(date#,DS_DAY))))   to format#
31703>>>>>  move (replace("#Y" ,format#,string(DateSegment(date#,DS_YEAR))))  to format#
31704>>>>>  move (replace("#M" ,format#,string(DateSegment(date#,DS_MONTH)))) to format#
31705>>>>>  function_return format#
31706>>>>>end_function
31707>>>>>
31707>>>>>function Year2to4 global integer year# returns integer
31708>>>>>  local integer epoch_value#
31709>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31710>>>>>  if year# lt 100 begin
31712>>>>>    if year# gt epoch_value# function_return (year#+1900)
31715>>>>>    function_return (year#+2000)
31716>>>>>  end
31716>>>>>>
31716>>>>>  function_return year# // No conversion done!
31717>>>>>end_function
31718>>>>>
31718>>>>>function Date2to4 global date date# returns date
31719>>>>>  local integer epoch_value#
31720>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31721>>>>>  if date# gt 0 begin // Only if there is a date to convert
31723>>>>>    if (DateSegment(date#,DS_YEAR)) lt 105 begin
31725>>>>>      if Dates$Year gt epoch_value# function_return (DateIncrement(date#,DS_YEAR,1900))
31728>>>>>      function_return (DateIncrement(date#,DS_YEAR,2000))
31729>>>>>    end
31729>>>>>>
31729>>>>>    function_return date# // No conversion done!
31730>>>>>  end
31730>>>>>>
31730>>>>>end_function
31731>>>>>
31731>>>>>function Date4to2 global date date# returns date
31732>>>>>  local integer epoch_value# year#
31733>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31734>>>>>  if date# gt 0 begin // Only if there is a date to convert
31736>>>>>    move (DateSegment(date#,DS_YEAR)) to year#
31737>>>>>    if year# ge 100 begin // Only then conversion is needed!
31739>>>>>      if (year#>=(1900+epoch_value#) and year#<(2000+epoch_value#)) begin
31741>>>>>        if year# lt 2000 function_return (DateIncrement(date#,DS_YEAR,-1900))
31744>>>>>        else             function_return (DateIncrement(date#,DS_YEAR,-2000))
31746>>>>>      end
31746>>>>>>
31746>>>>>      else error 301 "Date is out of epoch range"
31748>>>>>    end
31748>>>>>>
31748>>>>>  end
31748>>>>>>
31748>>>>>  function_return date# // No conversion done!
31749>>>>>end_function
31750>>>>>
31750>>>>>function dSysDate global returns date
31751>>>>>  local date date#
31752>>>>>  sysdate4 date#
31753>>>>>  function_return date#
31754>>>>>end_function
31755>>>>>
31755>>>>>function iSysYear global returns integer
31756>>>>>  local date date#
31757>>>>>  sysdate4 date#
31758>>>>>  function_return (DateSegment(date#,DS_YEAR))
31759>>>>>end_function
31760>>>>>
31760>>>>>procedure ItemSysdate for desktop integer itm#
31761>>>>>  local date date#
31762>>>>>  get value item itm# to date#
31763>>>>>  if date# eq 0 begin
31765>>>>>    sysdate4 date#
31766>>>>>    set changed_value item itm# to date#
31767>>>>>  end
31767>>>>>>
31767>>>>>end_procedure
31768>>>>>
31768>>>>>procedure ItemDate2to4 for desktop integer itm#
31769>>>>>  local integer year#
31770>>>>>  local date date# new_date#
31770>>>>>  get value item itm# to date#
31771>>>>>
31771>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31772>>>>>  if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31775>>>>>  else move date# to new_date#
31777>>>>>
31777>>>>>  move (Date2to4(new_date#)) to new_date#
31778>>>>>  move (DateSegment(new_date#,3)) to year#
31779>>>>>  if (year#>99 and year#<1000) begin
31781>>>>>    error 15 // Illegal entry in this window
31782>>>>>>
31782>>>>>    procedure_return 1
31783>>>>>  end
31783>>>>>>
31783>>>>>  if new_date# ne date# set value item itm# to new_date#
31786>>>>>end_procedure
31787>>>>>
31787>>>>>procedure ItemYear2to4 for desktop integer itm#
31788>>>>>  local integer year# new_year#
31789>>>>>  get value item itm# to year#
31790>>>>>  if (year#>99 and year#<1000) begin
31792>>>>>    error 15 // Illegal entry in this window
31793>>>>>>
31793>>>>>    procedure_return 1
31794>>>>>  end
31794>>>>>>
31794>>>>>  move (Year2to4(year#)) to new_year#
31795>>>>>  if new_year# ne year# set value item itm# to new_year#
31798>>>>>end_procedure
31799>>>>>
31799>>>>> procedure FieldSysdate for DataDictionary integer fld#
31800>>>>>   local date date#
31801>>>>>   get field_current_value fld# to date#
31802>>>>>   if date# eq 0 begin
31804>>>>>     sysdate4 date#
31805>>>>>     set field_changed_value fld# to date#
31806>>>>>   end
31806>>>>>>
31806>>>>> end_procedure
31807>>>>>
31807>>>>> procedure FieldDate2to4 for DataDictionary integer fld#
31808>>>>>   local integer year#
31809>>>>>   local date date# new_date#
31809>>>>>   get field_current_value fld# to date#
31810>>>>>
31810>>>>>   move (DateSegment(date#,DS_YEAR)) to year#
31811>>>>>   if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31814>>>>>   else move date# to new_date#
31816>>>>>
31816>>>>>   move (Date2to4(new_date#)) to new_date#
31817>>>>>   move (DateSegment(new_date#,3)) to year#
31818>>>>>   if (year#>99 and year# <=999) begin
31820>>>>>     error 15 // Illegal entry in this window
31821>>>>>>
31821>>>>>     procedure_return 1
31822>>>>>   end
31822>>>>>>
31822>>>>>   if new_date# ne date# set field_changed_value fld# to new_date#
31825>>>>> end_procedure
31826>>>>>
31826>>>>> procedure FieldYear2to4 for DataDictionary integer fld#
31827>>>>>   local integer year# new_year# changed#
31828>>>>>   get field_current_value fld# to year#
31829>>>>>   get field_changed_state fld# to changed#
31830>>>>>   if changed# begin
31832>>>>>     if (year#>99 and year#<1000) begin
31834>>>>>       error 15 // Illegal entry in this window
31835>>>>>>
31835>>>>>       procedure_return 1
31836>>>>>     end
31836>>>>>>
31836>>>>>     move (Year2to4(year#)) to new_year#
31837>>>>>     if new_year# ne year# set field_changed_value fld# to new_year#
31840>>>>>   end
31840>>>>>>
31840>>>>> end_procedure
31841>>>>>
31841>>>>> function SysDate global returns date
31842>>>>>   function_return (dSysDate())
31843>>>>> end_function
31844>>>>>
31844>>>>>function sSysTime global returns string
31845>>>>>  local integer h# m# s#
31846>>>>>  sysdate4 h# h# m# s#
31850>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31851>>>>>end_function
31852>>>>>
31852>>>>>function TS_SysTime global returns number
31853>>>>>  local integer d# h# m# s#
31854>>>>>  sysdate4 d# h# m# s#
31858>>>>>  function_return (d#*24.0+h#*60+m#*60+s#)
31859>>>>>end_function
31860>>>>>
31860>>>>>//> This function returns a TS value composed from the date and time
31860>>>>>//> passed to it. Note that the time variable must be of the format
31860>>>>>//> "hh:mm:ss".
31860>>>>>function TS_Compose global date date# string time# returns number
31861>>>>>  local integer h# m# s#
31862>>>>>  left time# to h# 2
31864>>>>>>
31864>>>>>  mid time# to m# 2 4
31867>>>>>>
31867>>>>>  mid time# to s# 2 7
31870>>>>>>
31870>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31871>>>>>end_function
31872>>>>>
31872>>>>>function TS_Compose2 global date date# integer h# integer m# integer s# returns number
31873>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31874>>>>>end_function
31875>>>>>
31875>>>>>function TS_ExtractDate global number time# returns date
31876>>>>>  function_return (time#/86400) // 86400=24*60*60
31877>>>>>end_function
31878>>>>>
31878>>>>>function TS_ExtractTime global number time# returns string
31879>>>>>  local integer h# m# s#
31880>>>>>  move (time#-(86400.0*integer(TS_ExtractDate(time#)))) to s#
31881>>>>>  move (s#/3600) to h#
31882>>>>>  move (s#-(h#*3600)) to s#
31883>>>>>  move (s#/60) to m#
31884>>>>>  move (s#-(m#*60)) to s#
31885>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31886>>>>>end_function
31887>>>>>
31887>>>>>function TS_ConvertToString global number time# returns string
31888>>>>>  local date d#
31889>>>>>  move (TS_ExtractDate(time#)) to d#
31890>>>>>  if (integer(d#)) function_return (string(d#)+" "+TS_ExtractTime(time#))
31893>>>>>  else function_return (TS_ExtractTime(time#))
31895>>>>>end_function
31896>>>>>
31896>>>>>function TS_ConvertToStringNoDate global number ts# returns string
31897>>>>>  local integer h# m#
31898>>>>>  move (ts#/3600) to h#
31899>>>>>  move (ts#-(h#*3600)) to ts#
31900>>>>>  move (ts#/60) to m#
31901>>>>>  move (ts#-(m#*60)) to ts#
31902>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(ts#<10,"0","")+string(ts#))
31903>>>>>end_function
31904>>>>>
31904>>>>>// This procedure is used when a TS-variable must be displayed on screen.
31904>>>>>procedure TS_UI_Update global number TS# integer obj1# integer itm1# integer tmp_obj2# integer tmp_itm2#
31905>>>>>  local integer obj2# itm2#
31906>>>>>  if num_arguments gt 3 begin
31908>>>>>    move tmp_obj2# to obj2#
31909>>>>>    move tmp_itm2# to itm2#
31910>>>>>  end
31910>>>>>>
31910>>>>>  else begin
31911>>>>>    move obj1# to obj2#
31912>>>>>    move (itm1#+1) to itm2#
31913>>>>>  end
31913>>>>>>
31913>>>>>  set value of obj1# item itm1# to (TS_ExtractDate(TS#))
31914>>>>>  set value of obj2# item itm2# to (TS_ExtractTime(TS#))
31915>>>>>end_procedure
31916>>>>>
31916>>>>>class TS_TimeEstimator is an array
31917>>>>>  procedure construct_object
31918>>>>>    forward send construct_object
31920>>>>>    set delegation_mode to delegate_to_parent
31921>>>>>    property number  pnTotal   public 0 // Seconds needed to run the loop.
31922>>>>>    property number  pnElapsed public 0 // Seconds elapsed so far.
31923>>>>>    property number  pnLeft    public 0 // Number of seconds left
31924>>>>>    property number  pnStart   public 0
31925>>>>>    property number  pnPause   public 0
31926>>>>>    property number  pnPercent public 0
31927>>>>>    property integer piMin     public 0
31928>>>>>    property integer piMax     public 0
31929>>>>>  end_procedure
31930>>>>>
31930>>>>>  procedure TS_Start integer min# integer max#
31931>>>>>    set piMin to min#
31932>>>>>    set piMax to max#
31933>>>>>    set pnStart to (TS_SysTime())
31934>>>>>    set pnElapsed to 0
31935>>>>>    set pnPercent to 0
31936>>>>>  end_procedure
31937>>>>>
31937>>>>>  procedure TS_Calculate integer pos#
31938>>>>>    local integer min# max#
31939>>>>>    get piMin to min#
31940>>>>>    get piMax to max#
31941>>>>>    set pnElapsed to (TS_SysTime()-pnStart(current_object))
31942>>>>>    set pnTotal   to (pnElapsed(current_object)*(max#-min#)/number(pos#-min#))
31943>>>>>    set pnLeft    to (pnTotal(current_object)-pnElapsed(current_object))
31944>>>>>    set pnPercent to (100.0*(pos#-min#)/(max#-min#))
31945>>>>>  end_procedure
31946>>>>>
31946>>>>>  procedure TS_Pause
31947>>>>>    set pnPause to (TS_SysTime())
31948>>>>>  end_procedure
31949>>>>>
31949>>>>>  procedure TS_Continue
31950>>>>>    set pnStart to (pnStart(current_object)+TS_SysTime()-pnPause(current_object))
31951>>>>>  end_procedure
31952>>>>>end_class
31953>>>>>
31953>>>>>function TS_Module_Compile_Time global string path# returns number
31954>>>>>  local integer pos# day# month# year# seqeof# ch#
31955>>>>>  local string date# str# time#
31955>>>>>  move path# to str#
31956>>>>>  if str# ne "" begin
31958>>>>>    get Seq_New_Channel to ch#   // This method and Seq_Release_Channel are
31959>>>>>    send Seq_Release_Channel ch# // We only need it for a second
31960>>>>>      direct_input channel ch# (trim(str#)+".vd6") // VDF 6
31962>>>>>      [seqeof] direct_input channel ch# (trim(str#)+".vd5") // VDF 5
31964>>>>>    [ seqeof] move 1 to seqeof#
31965>>>>>    [~seqeof] move 0 to seqeof#
31966>>>>>    [~seqeof] readln str#
31967>>>>>    close_input channel ch#
31969>>>>>  end
31969>>>>>>
31969>>>>>  if seqeof# function_return 0
31972>>>>>  pos "," in str# to pos#
31974>>>>>>
31974>>>>>  move (mid(str#,18,pos#+2)) to str#
31975>>>>>  move (integer(mid(str#,2,4))) to day#
31976>>>>>  move (integer(mid(str#,2,1))) to month#
31977>>>>>  move (integer(mid(str#,2,7))) to year#
31978>>>>>  if year# eq 10 begin
31980>>>>>    move (integer(mid(str#,3,7))+1900) to year#
31981>>>>>    move (mid(str#,8,11)) to str#
31982>>>>>  end
31982>>>>>>
31982>>>>>  else move (mid(str#,8,10)) to str#
31984>>>>>  move (DateCompose(day#,month#,year#)) to date#
31985>>>>>  move (Date2to4(date#)) to date#
31986>>>>>  pos ":" in str# to pos#
31988>>>>>>
31988>>>>>  function_return (TS_Compose(date#,mid(str#,8,pos#-2)))
31989>>>>>end_function
31990>>>>>
31990>>>>>string Dates$Module_Compile_Time
31990>>>>>move "" to Dates$Module_Compile_Time
31991>>>>>
31991>>>>>function Module_Compile_Date global returns date
31992>>>>>  local number ts#
31993>>>>>  local string str#
31993>>>>>  get module_name to str# // 'module_name' is most likely the name of the .flx file.
31994>>>>>  get TS_Module_Compile_Time str# to ts#
31995>>>>>  move (TS_ExtractTime(ts#)) to Dates$Module_Compile_Time
31996>>>>>  function_return (TS_ExtractDate(ts#))
31997>>>>>end_function
31998>>>>>
31998>>>>>function Module_Compile_Time global returns string
31999>>>>>  local date grb#
32000>>>>>  // Module_Compile_Date must be called before this one!
32000>>>>>  if Dates$Module_Compile_Time eq "" move (Module_Compile_Date()) to grb#
32003>>>>>  function_return Dates$Module_Compile_Time
32004>>>>>end_function
32005>>>>>
32005>>>>>date   Dates$ModuleStartDate
32005>>>>>string Dates$ModuleStartTime 8
32005>>>>>move (dSysDate()) to Dates$ModuleStartDate
32006>>>>>move (sSysTime()) to Dates$ModuleStartTime
32007>>>>>
32007>>>>>function Module_Start_Date global returns date
32008>>>>>  function_return Dates$ModuleStartDate
32009>>>>>end_function
32010>>>>>
32010>>>>>function Module_Start_Time global returns string
32011>>>>>  function_return Dates$ModuleStartTime
32012>>>>>end_function
32013>>>>>
32013>>>>> register_procedure NotifyPopupCalendarChange date date#
32013>>>>> register_procedure NotifyPopupCalendarSelect date date#
32013>>>>>  use dfAllent
32013>>>>>  class calendar.textbox is a textbox
32014>>>>>    procedure construct_object
32015>>>>>      forward send construct_object
32017>>>>>      Set Auto_Size_State To False
32018>>>>>      Set Justification_Mode To (jMode_vCenter+jMode_Center)
32019>>>>>    end_procedure
32020>>>>>  end_class
32021>>>>>
32021>>>>>  register_object btn1
32021>>>>>  register_object btn6
32021>>>>>
32021>>>>>  class calendar.button is a button
32022>>>>>
32022>>>>>    procedure construct_object
32023>>>>>      forward send construct_object
32025>>>>>      set size to 15 18
32026>>>>>      on_key kleftarrow   send prev_day
32027>>>>>      on_key krightarrow  send next_day
32028>>>>>      on_key kuparrow     send prev_week
32029>>>>>      on_key kdownarrow   send next_week
32030>>>>>      property date p_assigned_date public 0
32031>>>>>    end_procedure
32032>>>>>
32032>>>>>    procedure switch // This makes all 42 buttons act as if they are one focus
32033>>>>>      send activate to (btn1(current_object))
32034>>>>>    end_procedure
32035>>>>>    procedure switch_back
32036>>>>>      send activate to (btn6(current_object))
32037>>>>>    end_procedure
32038>>>>>
32038>>>>>    procedure mouse_down
32039>>>>>      local integer current_object#
32040>>>>>      forward send mouse_down
32042>>>>>      move current_object to current_object#
32043>>>>>      delegate set p_current_date to (p_assigned_date(current_object#))
32045>>>>>    end_procedure
32046>>>>>  end_class
32047>>>>>
32047>>>>>  desktop_section
32053>>>>>    object popup_calendar is a ModalPanel
32055>>>>>      set size to 160 250
32056>>>>>      property date    p_current_date  public 0
32058>>>>>      property integer p_current_year  public -1
32060>>>>>      property integer p_current_month public -1
32062>>>>>      property integer pExportState    public 1
32064>>>>>
32064>>>>>      on_key key_ctrl+key_pgup send prev_year
32065>>>>>      on_key key_ctrl+key_pgdn send next_year
32066>>>>>      on_key          key_pgup send prev_month
32067>>>>>      on_key          key_pgdn send next_month
32068>>>>>      on_key key_ctrl+key_d    send go_today
32069>>>>>      on_key kcancel           send cancel
32070>>>>>
32070>>>>>      object cont3d is a container3d
32072>>>>>        set location to 5 5
32073>>>>>        set size to 120 237
32074>>>>>        object textbox_year is a calendar.textbox
32076>>>>>          set location to 5 5
32077>>>>>          set size to 15 30
32078>>>>>          set border_style to border_staticedge
32079>>>>>          procedure display
32081>>>>>            set value to (p_current_year(current_object))
32082>>>>>          end_procedure
32083>>>>>        end_object
32084>>>>>        object dayname_header is a container3d
32086>>>>>          set location to 5 39
32087>>>>>          set size to 15 126
32088>>>>>          set border_style to border_staticedge
32089>>>>>          procedure initialize
32091>>>>>            local integer itm#
32092>>>>>            for itm# from 0 to 6
32098>>>>>>
32098>>>>>              object txt is a calendar.textbox
32100>>>>>                set size to 12 17
32101>>>>>                set location to 0 (itm#*17.6+1)
32102>>>>>                 set value to (left(DayName(itm#+1),3))
32103>>>>>              end_object
32104>>>>>            loop
32105>>>>>>
32105>>>>>          end_procedure
32106>>>>>          send initialize
32107>>>>>        end_object
32108>>>>>        object weeknumber_header is a container3d
32110>>>>>          set location to 24 5
32111>>>>>          set size     to 89 30
32112>>>>>          set border_style to border_staticedge
32113>>>>>          object obj_id_array is an array
32115>>>>>          end_object
32116>>>>>          procedure initialize
32118>>>>>            local integer itm# obj#
32119>>>>>            move (obj_id_array(current_object)) to obj#
32120>>>>>            for itm# from 0 to 5
32126>>>>>>
32126>>>>>              object txt is a textbox
32128>>>>>                set size to 15 30
32129>>>>>                set location to (itm#*15+1) 1
32130>>>>>                set value of obj# item (item_count(obj#)) to current_object
32131>>>>>              end_object
32132>>>>>            loop
32133>>>>>>
32133>>>>>          end_procedure
32134>>>>>          procedure display
32136>>>>>            local integer itm# obj#
32137>>>>>            local date date# last_date#
32137>>>>>            move (obj_id_array(current_object)) to obj#
32138>>>>>            get p_current_date to date#
32139>>>>>            move (FirstDayInMonth(date#)) to date#
32140>>>>>            move (LastDayInMonth(date#)) to last_date#
32141>>>>>            move (date#-DateDayNumber(date#)+1) to date#
32142>>>>>            for itm# from 0 to 5
32148>>>>>>
32148>>>>>              if (itm#*7+date#) le last_date# ;                set value of (integer(value(obj#,itm#))) to (t.calendar.week*string(DateWeekNumber(itm#*7+date#)))
32151>>>>>              else set value of (integer(value(obj#,itm#))) to ""
32153>>>>>            loop
32154>>>>>>
32154>>>>>          end_procedure
32155>>>>>          send initialize
32156>>>>>        end_object
32157>>>>>        object days_grid is a container3d
32159>>>>>          set location to 23 39
32160>>>>>          set size     to 100 127
32161>>>>>          set border_style to border_none
32162>>>>>          object btn_array is an array
32164>>>>>          end_object
32165>>>>>          procedure initialize
32167>>>>>            local integer row# col# button_array#
32168>>>>>            move (btn_array(current_object)) to button_array#
32169>>>>>            for row# from 0 to 5
32175>>>>>>
32175>>>>>              for col# from 0 to 6
32181>>>>>>
32181>>>>>                object btn is a calendar.button
32183>>>>>                  set location to (row#*15) (col#*18)
32184>>>>>                  set value of button_array# item (item_count(button_array#)) to current_object
32185>>>>>                  on_item "" send move_value_out_ok
32186>>>>>                end_object
32187>>>>>              loop
32188>>>>>>
32188>>>>>            loop
32189>>>>>>
32189>>>>>          end_procedure
32190>>>>>          send initialize
32191>>>>>
32191>>>>>          procedure display.iii integer itm# integer day# integer activate#
32193>>>>>            local integer obj# current_day#
32194>>>>>            move (integer(value(btn_array(current_object),itm#))) to obj#
32195>>>>>            move (DateSegment(p_current_date(current_object),DS_DAY)) to current_day#
32196>>>>>            if activate# begin
32198>>>>>              if day# eq current_day# send activate to obj#
32201>>>>>            end
32201>>>>>>
32201>>>>>            else begin
32202>>>>>              if day# begin
32204>>>>>                set value of obj# to day#
32205>>>>>                set visible_state of obj# to true
32206>>>>>                set p_assigned_date of obj# to (DateCompose(day#,p_current_month(current_object),p_current_year(current_object)))
32207>>>>>              end
32207>>>>>>
32207>>>>>              else set visible_state of obj# to false
32209>>>>>            end
32209>>>>>>
32209>>>>>          end_procedure
32210>>>>>
32210>>>>>          procedure display integer activate#
32212>>>>>            local integer first_item# last_item# itm# day# date#
32213>>>>>            get p_current_date to date#
32214>>>>>            move (FirstDayInMonth(date#)) to date#
32215>>>>>            move (DateDayNumber(date#)-1) to first_item#
32216>>>>>            move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32217>>>>>            ifnot activate# begin
32219>>>>>              for itm# from 0 to (first_item#-1)
32225>>>>>>
32225>>>>>                send display.iii itm# 0 0
32226>>>>>              loop
32227>>>>>>
32227>>>>>            end
32227>>>>>>
32227>>>>>            move 1 to day#
32228>>>>>            for itm# from first_item# to last_item#
32234>>>>>>
32234>>>>>              send display.iii itm# day# activate#
32235>>>>>              increment day#
32236>>>>>            loop
32237>>>>>>
32237>>>>>            ifnot activate# begin
32239>>>>>              for itm# from (last_item#+1) to 41
32245>>>>>>
32245>>>>>                send display.iii itm# 0 0
32246>>>>>              loop
32247>>>>>>
32247>>>>>            end
32247>>>>>>
32247>>>>>          end_procedure
32248>>>>>        end_object
32249>>>>>        object txt_month is a calendar.textbox
32251>>>>>          set size to 12 27
32252>>>>>          set location to 25 185
32253>>>>>          set value to t.calendar.month
32254>>>>>        end_object
32255>>>>>        object btn1 is a button
32257>>>>>          set size to 12 12
32258>>>>>          set location to 40 185
32259>>>>>          on_item "" send prev_month
32260>>>>>          set bitmap to "prev.bmp"
32261>>>>>          procedure switch_back
32263>>>>>            send display_main
32264>>>>>          end_procedure
32265>>>>>        end_object
32266>>>>>        object btn2 is a button
32268>>>>>          set size to 12 12
32269>>>>>          set location to 40 200
32270>>>>>          on_item "" send next_month
32271>>>>>          set bitmap to "next.bmp"
32272>>>>>        end_object
32273>>>>>        object txt_year is a calendar.textbox
32275>>>>>          set size to 12 27
32276>>>>>          set location to 70 185
32277>>>>>          set value to t.calendar.year
32278>>>>>        end_object
32279>>>>>        object btn3 is a button
32281>>>>>          set size to 12 12
32282>>>>>          set location to 85 185
32283>>>>>          on_item "" send prev_year
32284>>>>>          set bitmap to "prev.bmp"
32285>>>>>        end_object
32286>>>>>        object btn4 is a button
32288>>>>>          set size to 12 12
32289>>>>>          set location to 85 200
32290>>>>>          on_item "" send next_year
32291>>>>>          set bitmap to "next.bmp"
32292>>>>>        end_object
32293>>>>>      end_object
32294>>>>>      object btn5 is a button
32296>>>>>        set size to 14 60
32297>>>>>        set location to 129 115
32298>>>>>        on_item t.calendar.ok send move_value_out_ok
32299>>>>>      end_object
32300>>>>>      object btn6 is a button
32302>>>>>        set size to 14 60
32303>>>>>        set location to 129 182
32304>>>>>        on_item t.calendar.cancel send cancel
32305>>>>>        procedure switch
32307>>>>>          send display_main
32308>>>>>        end_procedure
32309>>>>>      end_object
32310>>>>>      procedure next_year
32312>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32313>>>>>        send display_main
32314>>>>>      end_procedure
32315>>>>>      procedure prev_year
32317>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32318>>>>>        send display_main
32319>>>>>      end_procedure
32320>>>>>      procedure next_month
32322>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32323>>>>>        send display_main
32324>>>>>      end_procedure
32325>>>>>      procedure prev_month
32327>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32328>>>>>        send display_main
32329>>>>>      end_procedure
32330>>>>>      procedure next_week
32332>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,1))
32333>>>>>        send display_main
32334>>>>>      end_procedure
32335>>>>>      procedure prev_week
32337>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,-1))
32338>>>>>        send display_main
32339>>>>>      end_procedure
32340>>>>>      procedure next_day
32342>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,1))
32343>>>>>        send display_main
32344>>>>>      end_procedure
32345>>>>>      procedure prev_day
32347>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,-1))
32348>>>>>        send display_main
32349>>>>>      end_procedure
32350>>>>>      procedure go_today
32352>>>>>        local date date#
32353>>>>>        sysdate4 date#
32354>>>>>        set p_current_date to date#
32355>>>>>        send display_main
32356>>>>>      end_procedure
32357>>>>>      property integer invoking_object_id public 0
32359>>>>>      procedure OnChange date date#
32361>>>>>        local integer focus# dm#
32362>>>>>        get invoking_object_id to focus#
32363>>>>>        if focus# gt desktop begin
32365>>>>>          get delegation_mode of focus# to dm#
32366>>>>>          set delegation_mode of focus# to no_delegate_or_error
32367>>>>>          send NotifyPopupCalendarChange to focus# date#
32368>>>>>          set delegation_mode of focus# to dm#
32369>>>>>        end
32369>>>>>>
32369>>>>>      end_procedure
32370>>>>>      procedure display
32372>>>>>        local integer date# month# year#
32373>>>>>        get p_current_date to date#
32374>>>>>        send OnChange date#
32375>>>>>        move (DateSegment(date#,DS_YEAR)) to year#
32376>>>>>        move (DateSegment(date#,DS_MONTH)) to month#
32377>>>>>        if (p_current_year(current_object)<>year# or p_current_month(current_object)<>month#) begin
32379>>>>>          set p_current_year to year#
32380>>>>>          set p_current_month to month#
32381>>>>>          set value to (t.calendar.calendar_popup+", "+MonthName(month#))
32382>>>>>          send display to (textbox_year(cont3d(current_object)))
32383>>>>>          send display to (weeknumber_header(cont3d(current_object)))
32384>>>>>          send display to (days_grid(cont3d(current_object))) 0
32385>>>>>        end
32385>>>>>>
32385>>>>>      end_procedure
32386>>>>>      procedure display_main
32388>>>>>        send display
32389>>>>>        send display to (days_grid(cont3d(current_object))) 1
32390>>>>>      end_procedure
32391>>>>>      procedure popup_no_export
32393>>>>>        set pExportState to false
32394>>>>>        send popup
32395>>>>>        set pExportState to true
32396>>>>>      end_procedure
32397>>>>>
32397>>>>>      procedure popup_group
32399>>>>>        local integer focus#
32400>>>>>        local date date#
32400>>>>>        move (focus(desktop)) to focus#
32401>>>>>        set invoking_object_id to focus#
32402>>>>>        get value of focus# item current to date#
32403>>>>>        ifnot (integer(date#)) move (dSysdate()) to date#
32406>>>>>        move (Date2to4(date#)) to date#
32407>>>>>        set p_current_date to date#
32408>>>>>        send display
32409>>>>>        forward send popup_group
32411>>>>>        send display to (days_grid(cont3d(current_object))) 1
32412>>>>>      end_procedure
32413>>>>>
32413>>>>>      procedure move_value_out
32415>>>>>        local integer focus# dm# margin# datatype#
32416>>>>>        if (pExportState(current_object)) begin
32418>>>>>          get invoking_object_id to focus#
32419>>>>>          if focus# gt desktop begin
32421>>>>>            get delegation_mode of focus# to dm#
32422>>>>>            set delegation_mode of focus# to no_delegate_or_error
32423>>>>>            send NotifyPopupCalendarSelect to focus# (p_current_date(current_object))
32424>>>>>            get form_margin of focus# item current to margin#
32425>>>>>            get form_datatype of focus# item current to datatype#
32426>>>>>            set delegation_mode of focus# to dm#
32427>>>>>            if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to (p_current_date(current_object))
32430>>>>>            else             set value of focus# item current to (Date4to2(p_current_date(current_object)))
32432>>>>>            set item_changed_state of focus# item current to true
32433>>>>>          end
32433>>>>>>
32433>>>>>        end
32433>>>>>>
32433>>>>>      end_procedure
32434>>>>>
32434>>>>>      procedure move_value_out_ok
32436>>>>>        send move_value_out
32437>>>>>        send deactivate
32438>>>>>      end_procedure
32439>>>>>
32439>>>>>      procedure request_popup
32441>>>>>        local integer focus# type# dm#
32442>>>>>        move (focus(desktop)) to focus#
32443>>>>>        if focus# gt desktop begin
32445>>>>>          get delegation_mode of focus# to dm#
32446>>>>>          set delegation_mode of focus# to no_delegate_or_error
32447>>>>>          get form_datatype of focus# item current to type#
32448>>>>>          if (type#=date_window or type#=mask_date_window) send popup
32451>>>>>          set delegation_mode of focus# to dm#
32452>>>>>        end
32452>>>>>>
32452>>>>>      end_procedure
32453>>>>>    end_object
32454>>>>>  end_desktop_section
32456>>>>>  // If the procedure below was not defined "for BaseClass" its symbolic
32456>>>>>  // substitute would become negative (because located on the desktop). This
32456>>>>>  // would result in the toolbar object not being able to handle it. Therefore:
32456>>>>>  procedure request_popup_calendar for BaseClass
32457>>>>>    send request_popup to (popup_calendar(current_object))
32458>>>>>  end_procedure
32459>>>>>  procedure popup_calendar_no_export
32460>>>>>    send popup_no_export to (popup_calendar(current_object))
32461>>>>>  end_procedure
32462>>>>>  register_procedure Add_Toolbar_Button_Bitmap string bmp# string Tip# string StHlp# integer msg# integer obj#
32462>>>>>  procedure Add_Calendar_tbButton integer oTb#
32463>>>>>    send Add_Toolbar_Button_Bitmap to oTb# "DfCalend.bmp" t.calendar.calendar_popup t.calendar.Activate msg_request_popup_calendar
32464>>>>>  end_procedure
32465>>>>> function s.calendar returns integer // Backwards compatible!!
32466>>>>>   function_return (popup_calendar(current_object))
32467>>>>> end_function
32468>>>>>
32468>>>>>// Karl,
32468>>>>>// Structure is as follows,
32468>>>>>//
32468>>>>>// //put this code in the top portion of the view code or in the program
32468>>>>>// code.
32468>>>>>//
32468>>>>>// Type SystemTime
32468>>>>>//   field SystemTime.iYear As Word
32468>>>>>//   field SystemTime.iMonth As Word
32468>>>>>//   field SystemTime.iDayOfWeek As Word
32468>>>>>//   field SystemTime.iDay As Word
32468>>>>>//   field SystemTime.iHour As Word
32468>>>>>//   field SystemTime.iMinute As Word
32468>>>>>//   field SystemTime.iSecond As Word
32468>>>>>//   field SystemTime.iMilliseconds As Word
32468>>>>>// End_Type
32468>>>>>//
32468>>>>>// external_function GetSystemTime "GetSystemTime" kernel32.dll Pointer lpGST Returns VOID_TYPE
32468>>>>>//
32468>>>>>// //put this code in an onClick or wherever
32468>>>>>// procedure onclick
32468>>>>>//   local integer iRetVal
32468>>>>>//   local string TimeData
32468>>>>>//   local pointer GST
32468>>>>>//
32468>>>>>//   ZeroType SystemTime to TimeData
32468>>>>>//   getAddress from TimeData to GST
32468>>>>>//
32468>>>>>//   move (GetSystemTime(GST)) to iRetVal
32468>>>>>// end_procedure
32468>>>>>//
32468>>>>>// To extract the data from the Structure after calling the function use
32468>>>>>// the getbuff command as follows:
32468>>>>>//
32468>>>>>// getbuff from TimeData as SystemTime.IVAL to var
32468>>>>>//
32468>>>>>// where IVAL is one of the vars such as iYear or iDay, etc.
32468>>>>>//
32468>>>>>// OLIVER NELSON
32468>>>>>//
32468>>>>>//
32468>>>
32468>>>//AB-StoreTopEnd
32468>>>
32468>>>//AB-IgnoreStart
32468>>>
32468>>>Use DFAllEnt.pkg
32468>>>
32468>>>
32468>>>//AB-IgnoreEnd
32468>>>
32468>>>CD_Popup_Object oCalendar is a dbModalPanel
32487>>>
32487>>>    //AB-StoreTopStart
32487>>>    on_key kcancel           send cancel
32488>>>    //AB-StoreTopEnd
32488>>>
32488>>>    Set Border_Style to Border_Normal
32489>>>    Set Caption_Bar to FALSE
32490>>>    Set Label to "Ÿ­¢ àì, 2001"
32491>>>    Set Size to 98 123
32492>>>    Set Location to 10 22
32493>>>    Set Color to clWhite
32494>>>
32494>>>    //AB-DDOStart
32494>>>
32494>>>
32494>>>    //AB-DDOEnd
32494>>>
32494>>>    Object Container3d1 is a Container3d
32496>>>        Set Size to 88 135
32497>>>        Set Location to -2 -1
32498>>>        Set Color to clWhite
32499>>>        Set Border_Style to Border_None
32500>>>        Object Grid2 is a Grid
32502>>>
32502>>>            //AB-StoreTopStart
32502>>>            property date    p_current_date     public 0
32504>>>            property integer p_current_year     public -1
32506>>>            property integer p_current_month    public -1
32508>>>            property integer p_selected_day     public -1
32510>>>            property integer pExportState       public 1
32512>>>            property integer invoking_object_id public 0
32514>>>            
32514>>>            Set Border_Style To BORDER_NONE
32515>>>            Set header_visible_state To False
32516>>>            set select_mode to no_select
32517>>>            Set Gridline_mode To GRID_VISIBLE_NONE
32518>>>            
32518>>>            on_key Key_F1 Send Help
32519>>>            on_key key_ctrl+key_pgup send prev_year
32520>>>            on_key key_ctrl+key_pgdn send next_year
32521>>>            on_key          key_pgup send prev_month
32522>>>            on_key          key_pgdn send next_month
32523>>>            on_key key_enter         send move_value_out
32524>>>            on_key key_ctrl+key_d    send go_today
32525>>>            
32525>>>            //AB-StoreTopEnd
32525>>>
32525>>>            Set Color to clWhite
32526>>>            Set CurrentCellColor to clWhite
32527>>>            Set CurrentCellTextColor to clWhite
32528>>>            Set Size to 61 145
32529>>>            Set Location to 30 1
32530>>>            Set Resize_Column_state to FALSE
32531>>>
32531>>>            Set Line_Width to 7 0
32532>>>
32532>>>            Set Form_Width    item 0 to 18
32533>>>            Set Header_Label  item 0 to "­"
32534>>>            
32534>>>            Set Form_Width    item 1 to 18
32535>>>            Set Header_Label  item 1 to "‚â"
32536>>>            
32536>>>            Set Form_Width    item 2 to 18
32537>>>            Set Header_Label  item 2 to "‘à"
32538>>>            
32538>>>            Set Form_Width    item 3 to 18
32539>>>            Set Header_Label  item 3 to "—â"
32540>>>            
32540>>>            Set Form_Width    item 4 to 18
32541>>>            Set Header_Label  item 4 to "â"
32542>>>            
32542>>>            Set Form_Width    item 5 to 18
32543>>>            Set Header_Label  item 5 to "‘¡"
32544>>>            
32544>>>            Set Form_Width    item 6 to 18
32545>>>            Set Header_Label  item 6 to "‚á"
32546>>>            
32546>>>
32546>>>            //AB-StoreStart
32546>>>            
32546>>>            procedure go_today
32548>>>                Date date#
32549>>>                sysdate4 date#
32550>>>                set p_current_date to date#
32551>>>                Send Update_Calendar
32552>>>            end_procedure
32553>>>            
32553>>>            procedure next_month
32555>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32556>>>                Send Update_Calendar
32557>>>            end_procedure
32558>>>            
32558>>>            procedure prev_month
32560>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32561>>>                Send Update_Calendar
32562>>>            end_procedure
32563>>>            
32563>>>            procedure next_year
32565>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32566>>>                Send Update_Calendar
32567>>>            end_procedure
32568>>>            
32568>>>            procedure prev_year
32570>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32571>>>                Send Update_Calendar
32572>>>            end_procedure
32573>>>            
32573>>>            Procedure Activate
32575>>>                Date date#
32576>>>                Forward Send Activate
32578>>>                Set current_item to (p_selected_day(Self))
32579>>>            End_Procedure
32580>>>            
32580>>>            Procedure Update_Calendar
32582>>>                Set Dynamic_Update_State To False
32583>>>                send Fill_List
32584>>>                Set Dynamic_Update_State To True
32585>>>                // Send Update_Label
32585>>>                Set current_item to (p_selected_day(Self))
32586>>>                Send Date_Changing to (oYear(Container3d2(self)))
32587>>>                Send Date_Changing to (oMonth(Container3d2(self)))
32588>>>            End_Procedure
32589>>>            
32589>>>            Procedure Fill_List
32591>>>                Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
32592>>>                Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
32592>>>                Date dToday
32592>>>                Send Delete_Data
32593>>>            
32593>>>                Get p_current_date to date#
32594>>>            
32594>>>                SysDate4 dToday
32595>>>                move (DateSegment(dToday,DS_DAY)) to cur_day#
32596>>>                move (DateSegment(dToday,DS_MONTH)) to cur_month#
32597>>>                move (DateSegment(dToday,DS_YEAR)) to cur_year#
32598>>>            
32598>>>                move (DateSegment(date#,DS_DAY)) to sel_day#
32599>>>                move (DateSegment(date#,DS_MONTH)) to sel_month#
32600>>>                move (DateSegment(date#,DS_YEAR)) to sel_year#
32601>>>                Set p_current_month To sel_month#
32602>>>                Set p_current_year To sel_year#
32603>>>            
32603>>>                move (FirstDayInMonth(date#)) to date#
32604>>>                move (DateDayNumber(date#)-1) to first_item#
32605>>>                move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32606>>>                move (DateIncrement(date#,DS_Month,-1)) To prevdate#
32607>>>                move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
32608>>>            
32608>>>                If (first_item# > 0) Begin
32610>>>                    Move (first_item#-1) to day#
32611>>>                    For iFor from 0 to (first_item#-1)
32617>>>>
32617>>>                        Send Add_Item msg_move_value_out (prev_last#-day#)
32618>>>                        Set Entry_State Item iFor To False
32619>>>                        Set ItemTextColor Item iFor To clGray
32620>>>                        Decrement day#
32621>>>                    Loop
32622>>>>
32622>>>                End
32622>>>>
32622>>>            
32622>>>                Move 1 To day#
32623>>>                For iFor from first_item# to last_item#
32629>>>>
32629>>>                    Send Add_Item Msg_Move_Value_Out day#
32630>>>                    Set Entry_State Item iFor To False
32631>>>                    If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Set Form_Bitmap Item iFor To "cdate.bmp"
32634>>>                    If Day# eq sel_day# Set p_selected_day To iFor
32637>>>                    Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
32638>>>                    Set form_datatype item iFor To mask_numeric_window
32639>>>                    Set form_Mask item iFor To "## "
32640>>>                    Increment day#
32641>>>                Loop
32642>>>>
32642>>>            
32642>>>                move (DateIncrement(date#,DS_Month,1)) To nextdate#
32643>>>                move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
32644>>>            
32644>>>                If (last_item# < 41) Begin
32646>>>                    Move 1 to day#
32647>>>                    For iFor from (last_item#+1) to 41
32653>>>>
32653>>>                        Send Add_Item msg_move_value_out day#
32654>>>                        Set Entry_State Item iFor To False
32655>>>                        Set ItemTextColor Item iFor To clGray
32656>>>                        Increment day#
32657>>>                    Loop
32658>>>>
32658>>>                End
32658>>>>
32658>>>            
32658>>>            End_Procedure
32659>>>            
32659>>>            Procedure Help
32661>>>                Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<PgUp>, <PgDn> - Select year.\n\n(c) 2001, SCR. Special thanks to Sture Andersen.") ("Help on Calendar")
32662>>>            End_Procedure
32663>>>            
32663>>>            procedure mouse_click integer window integer char_pos
32665>>>                Send Move_Value_Out
32666>>>                forward send mouse_click window char_pos
32668>>>            end_procedure
32669>>>            
32669>>>            Procedure Move_Value_Out
32671>>>                Integer iYear iMonth iDay iItm
32672>>>                Date Date# next_date# prev_date#
32672>>>                Get Current_Item To iItm
32673>>>                If (pExportState(Self)) Begin
32675>>>                    Get Value Item iItm To iDay
32676>>>                    Get p_current_month to iMonth
32677>>>                    Get p_current_year  to iYear
32678>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32679>>>            
32679>>>                    If ((iItm>27)and(iDay<15)) Begin
32681>>>                        Move (DateCompose(1,iMonth,iYear)) To next_date#
32682>>>                        move (DateIncrement(next_date#,DS_Month,1)) To next_date#
32683>>>                        move (DateSegment(next_date#,DS_MONTH)) to iMonth
32684>>>                        move (DateSegment(next_date#,DS_YEAR)) to iYear
32685>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32686>>>                    End
32686>>>>
32686>>>                    If ((iItm<7)and(iDay>20)) Begin
32688>>>                        Move (DateCompose(1,iMonth,iYear)) To prev_date#
32689>>>                        move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
32690>>>                        move (DateSegment(prev_date#,DS_MONTH)) to iMonth
32691>>>                        move (DateSegment(prev_date#,DS_YEAR)) to iYear
32692>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32693>>>                    End
32693>>>>
32693>>>            
32693>>>                    Send Export_Date date#
32694>>>                End
32694>>>>
32694>>>            End_Procedure
32695>>>            
32695>>>            Procedure Export_Date date date#
32697>>>                local integer focus# dm# margin# datatype#
32698>>>                get invoking_object_id to focus#
32699>>>            
32699>>>                if focus# gt desktop begin
32701>>>                     get delegation_mode of focus# to dm#
32702>>>                     set delegation_mode of focus# to no_delegate_or_error
32703>>>                     get form_margin of focus# item current to margin#
32704>>>                     get form_datatype of focus# item current to datatype#
32705>>>                     set delegation_mode of focus# to dm#
32706>>>                     if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
32709>>>                     else             set value of focus# item current to (Date4to2(date#))
32711>>>                     set item_changed_state of focus# item current to true
32712>>>                end
32712>>>>
32712>>>                Send Close_Calendar
32713>>>            End_Procedure
32714>>>            //AB-StoreEnd
32714>>>
32714>>>        End_Object    // Grid2
32715>>>
32715>>>        Object Textbox2 is a Textbox
32717>>>            Set Label to "­"
32718>>>            Set Auto_Size_State to FALSE
32719>>>            Set Transparent_State to TRUE
32720>>>            Set Color to clWhite
32721>>>            Set TextColor to clNavy
32722>>>            Set Location to 19 4
32723>>>            Set Size to 10 15
32724>>>
32724>>>            //AB-StoreStart
32724>>>                                        
32724>>>            Set Label To (left(t.calendar.Monday,2))
32725>>>            //AB-StoreEnd
32725>>>
32725>>>        End_Object    // Textbox2
32726>>>
32726>>>        Object Textbox3 is a Textbox
32728>>>            Set Label to "‚â"
32729>>>            Set Auto_Size_State to FALSE
32730>>>            Set Transparent_State to TRUE
32731>>>            Set Color to clWhite
32732>>>            Set TextColor to clNavy
32733>>>            Set Location to 19 22
32734>>>            Set Size to 10 12
32735>>>
32735>>>            //AB-StoreStart
32735>>>                                        
32735>>>            Set Label To (left(t.calendar.Tuesday,2))
32736>>>            //AB-StoreEnd
32736>>>
32736>>>        End_Object    // Textbox3
32737>>>
32737>>>        Object Textbox4 is a Textbox
32739>>>            Set Label to "‘à"
32740>>>            Set Auto_Size_State to FALSE
32741>>>            Set Transparent_State to TRUE
32742>>>            Set Color to clWhite
32743>>>            Set TextColor to clNavy
32744>>>            Set Location to 19 39
32745>>>            Set Size to 10 15
32746>>>
32746>>>            //AB-StoreStart
32746>>>                                        
32746>>>            Set Label To (left(t.calendar.Wednesday,2))
32747>>>            //AB-StoreEnd
32747>>>
32747>>>        End_Object    // Textbox4
32748>>>
32748>>>        Object Textbox5 is a Textbox
32750>>>            Set Label to "—â"
32751>>>            Set Auto_Size_State to FALSE
32752>>>            Set Transparent_State to TRUE
32753>>>            Set Color to clWhite
32754>>>            Set TextColor to clNavy
32755>>>            Set Location to 19 57
32756>>>            Set Size to 10 17
32757>>>
32757>>>            //AB-StoreStart
32757>>>                                        
32757>>>            Set Label To (left(t.calendar.Thursday,2))
32758>>>            //AB-StoreEnd
32758>>>
32758>>>        End_Object    // Textbox5
32759>>>
32759>>>        Object Textbox6 is a Textbox
32761>>>            Set Label to "â"
32762>>>            Set Auto_Size_State to FALSE
32763>>>            Set Transparent_State to TRUE
32764>>>            Set Color to clWhite
32765>>>            Set TextColor to clNavy
32766>>>            Set Location to 19 76
32767>>>            Set Size to 10 17
32768>>>
32768>>>            //AB-StoreStart
32768>>>                                        
32768>>>            Set Label To (left(t.calendar.Friday,2))
32769>>>            //AB-StoreEnd
32769>>>
32769>>>        End_Object    // Textbox6
32770>>>
32770>>>        Object Textbox7 is a Textbox
32772>>>            Set Label to "‘¡"
32773>>>            Set Auto_Size_State to FALSE
32774>>>            Set Transparent_State to TRUE
32775>>>            Set Color to clWhite
32776>>>            Set TextColor to clNavy
32777>>>            Set Location to 19 91
32778>>>            Set Size to 10 18
32779>>>
32779>>>            //AB-StoreStart
32779>>>                                        
32779>>>            Set Label To (left(t.calendar.Saturday,2))
32780>>>            //AB-StoreEnd
32780>>>
32780>>>        End_Object    // Textbox7
32781>>>
32781>>>        Object Textbox8 is a Textbox
32783>>>            Set Label to "‚á"
32784>>>            Set Auto_Size_State to FALSE
32785>>>            Set Transparent_State to TRUE
32786>>>            Set Color to clWhite
32787>>>            Set TextColor to clNavy
32788>>>            Set Location to 19 109
32789>>>            Set Size to 10 17
32790>>>
32790>>>            //AB-StoreStart
32790>>>                                        
32790>>>            Set Label To (left(t.calendar.Sunday,2))
32791>>>            //AB-StoreEnd
32791>>>
32791>>>        End_Object    // Textbox8
32792>>>
32792>>>        Object LineControl1 is a LineControl
32794>>>            Set Line_Style to lnSINGLE
32795>>>            Set Size to 1 116
32796>>>            Set Location to 28 4
32797>>>
32797>>>            //AB-StoreStart
32797>>>                                        
32797>>>            //AB-StoreEnd
32797>>>
32797>>>        End_Object    // LineControl1
32798>>>
32798>>>        Object Container3d2 is a Container3d
32800>>>            Set Size to 18 131
32801>>>            Set Location to 1 1
32802>>>            Set Color to clNavy
32803>>>            Set Border_Style to Border_None
32804>>>            Object oRght is a BitmapContainer
32806>>>                Set Size to 10 14
32807>>>                Set Location to 4 105
32808>>>                Set Bitmap to "rght.bmp"
32809>>>                Set Border_Style to Border_None
32810>>>
32810>>>                //AB-StoreStart
32810>>>                Procedure Mouse_Down
32812>>>                    Send Next_Month to Grid2
32813>>>                End_Procedure
32814>>>                //AB-StoreEnd
32814>>>
32814>>>            End_Object    // oRght
32815>>>
32815>>>            Object oLeft is a BitmapContainer
32817>>>                Set Size to 10 14
32818>>>                Set Location to 4 3
32819>>>                Set Bitmap to "lft.bmp"
32820>>>                Set Border_Style to Border_None
32821>>>
32821>>>                //AB-StoreStart
32821>>>                Procedure Mouse_Down
32823>>>                    Send Prev_Month to Grid2
32824>>>                End_Procedure
32825>>>                //AB-StoreEnd
32825>>>
32825>>>            End_Object    // oLeft
32826>>>
32826>>>            Object oMonth is a Textbox
32828>>>
32828>>>                //AB-StoreTopStart
32828>>>                Property integer piSelected_Month public 0
32830>>>                //AB-StoreTopEnd
32830>>>
32830>>>                Set Label to "January"
32831>>>                Set Auto_Size_State to FALSE
32832>>>                Set Transparent_State to TRUE
32833>>>                Set Color to clWhite
32834>>>                Set TextColor to clWhite
32835>>>                Set Location to 4 23
32836>>>                Set Size to 10 43
32837>>>                Set FontWeight to 800
32838>>>                Set Justification_Mode to jMode_Center
32839>>>
32839>>>                //AB-StoreStart
32839>>>                                    
32839>>>                Procedure Mouse_Down
32841>>>                    Integer iState
32842>>>                    Get Visible_State of oSelectYear to iState
32843>>>                    If (iState) Send OnKillFocus to oSelectYear
32846>>>                    Send Popup to oSelectMonth
32847>>>                End_Procedure
32848>>>                
32848>>>                Procedure pSelectJan
32850>>>                    Set Label to t.calendar.january
32851>>>                    Set piSelected_Month to 1
32852>>>                    Send Adjust_Calendar
32853>>>                End_Procedure
32854>>>                Procedure pSelectFeb
32856>>>                    Set Label to t.calendar.february
32857>>>                    Set piSelected_Month to 2
32858>>>                    Send Adjust_Calendar
32859>>>                End_Procedure
32860>>>                Procedure pSelectMar
32862>>>                    Set Label to t.calendar.march
32863>>>                    Set piSelected_Month to 3
32864>>>                    Send Adjust_Calendar
32865>>>                End_Procedure
32866>>>                Procedure pSelectApr
32868>>>                    Set Label to t.calendar.april
32869>>>                    Set piSelected_Month to 4
32870>>>                    Send Adjust_Calendar
32871>>>                End_Procedure
32872>>>                Procedure pSelectMay
32874>>>                    Set Label to t.calendar.may
32875>>>                    Set piSelected_Month to 5
32876>>>                    Send Adjust_Calendar
32877>>>                End_Procedure
32878>>>                Procedure pSelectJun
32880>>>                    Set Label to t.calendar.june
32881>>>                    Set piSelected_Month to 6
32882>>>                    Send Adjust_Calendar
32883>>>                End_Procedure
32884>>>                Procedure pSelectJul
32886>>>                    Set Label to t.calendar.july
32887>>>                    Set piSelected_Month to 7
32888>>>                    Send Adjust_Calendar
32889>>>                End_Procedure
32890>>>                Procedure pSelectAug
32892>>>                    Set Label to t.calendar.august
32893>>>                    Set piSelected_Month to 8
32894>>>                    Send Adjust_Calendar
32895>>>                End_Procedure
32896>>>                Procedure pSelectSep
32898>>>                    Set Label to t.calendar.september
32899>>>                    Set piSelected_Month to 9
32900>>>                    Send Adjust_Calendar
32901>>>                End_Procedure
32902>>>                Procedure pSelectOct
32904>>>                    Set Label to t.calendar.october
32905>>>                    Set piSelected_Month to 10
32906>>>                    Send Adjust_Calendar
32907>>>                End_Procedure
32908>>>                Procedure pSelectNov
32910>>>                    Set Label to t.calendar.november
32911>>>                    Set piSelected_Month to 11
32912>>>                    Send Adjust_Calendar
32913>>>                End_Procedure
32914>>>                Procedure pSelectDec
32916>>>                    Set Label to t.calendar.december
32917>>>                    Set piSelected_Month to 12
32918>>>                    Send Adjust_Calendar
32919>>>                End_Procedure
32920>>>                
32920>>>                Object oSelectMonth is a FloatingPopupMenu
32922>>>                    Send Add_Item msg_pSelectJan t.calendar.january
32923>>>                    Send Add_Item msg_pSelectFeb t.calendar.february
32924>>>                    Send Add_Item msg_pSelectMar t.calendar.march
32925>>>                    Send Add_Item msg_pSelectApr t.calendar.april
32926>>>                    Send Add_Item msg_pSelectMay t.calendar.may
32927>>>                    Send Add_Item msg_pSelectJun t.calendar.june
32928>>>                    Send Add_Item msg_pSelectJul t.calendar.july
32929>>>                    Send Add_Item msg_pSelectAug t.calendar.august
32930>>>                    Send Add_Item msg_pSelectSep t.calendar.september
32931>>>                    Send Add_Item msg_pSelectOct t.calendar.october
32932>>>                    Send Add_Item msg_pSelectNov t.calendar.november
32933>>>                    Send Add_Item msg_pSelectDec t.calendar.december
32934>>>                End_Object
32935>>>                
32935>>>                Procedure Adjust_Calendar
32937>>>                    Date date#
32938>>>                    Integer iDay iMonth iYear iItm
32938>>>                    Set Visible_State to false
32939>>>                    Set Visible_State to true
32940>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32941>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32942>>>                    Get piSelected_Month to iMonth
32943>>>                    Get Label of oYear to iYear
32944>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32945>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32946>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32947>>>                End_Procedure
32948>>>                
32948>>>                Procedure Activating
32950>>>                    Forward Send Activating
32952>>>                    Send Date_Changing
32953>>>                End_Procedure
32954>>>                
32954>>>                Procedure Date_Changing
32956>>>                    Set Visible_State to false
32957>>>                    Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
32958>>>                    Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
32959>>>                    Set Visible_State to true
32960>>>                End_Procedure
32961>>>                
32961>>>                
32961>>>                //AB-StoreEnd
32961>>>
32961>>>            End_Object    // oMonth
32962>>>
32962>>>            Object oYear is a Textbox
32964>>>                Set Label to "2001"
32965>>>                Set Transparent_State to TRUE
32966>>>                Set Color to clWhite
32967>>>                Set TextColor to clWhite
32968>>>                Set Location to 4 77
32969>>>                Set Size to 10 18
32970>>>                Set FontWeight to 800
32971>>>
32971>>>                //AB-StoreStart
32971>>>                                                    
32971>>>                Procedure Mouse_Down
32973>>>                    String sVal
32974>>>                    Get Label to sVal
32975>>>                    Set Value of oSelectYear item 0 to sVal
32976>>>                    Set Visible_State of oSelectYear to True
32977>>>                    Send Activate to (oSelectYear(Self))
32978>>>                End_Procedure
32979>>>                
32979>>>                Procedure Activating
32981>>>                    Forward Send Activating
32983>>>                    Send Date_Changing
32984>>>                End_Procedure
32985>>>                
32985>>>                Procedure Date_Changing
32987>>>                    Set Visible_State to false
32988>>>                    Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
32989>>>                    Set Visible_State to true
32990>>>                End_Procedure
32991>>>                //AB-StoreEnd
32991>>>
32991>>>            End_Object    // oYear
32992>>>
32992>>>            Object oSelectYear is a Form
32994>>>
32994>>>                //AB-StoreTopStart
32994>>>                Set Visible_State To False
32995>>>                //AB-StoreTopEnd
32995>>>
32995>>>                Set Size to 10 24
32996>>>                Set Location to 4 75
32997>>>                Set Color to clWhite
32998>>>                Set TextColor to clNavy
32999>>>                Set Form_Border Item 0 to Border_Normal
33000>>>
33000>>>                //AB-StoreStart
33000>>>                                                    
33000>>>                On_Key Key_Enter Send OnKillFocus
33001>>>                On_Key Key_Escape Send OnKillFocus
33002>>>                
33002>>>                Procedure SetFontWeight
33004>>>                    Set Form_FontWeight item 0 to 800
33005>>>                End_Procedure
33006>>>                
33006>>>                Procedure OnKillFocus
33008>>>                    String sVal
33009>>>                    Integer iMonth iDay iYear iItm
33009>>>                    Date date#
33009>>>                    Get Value item 0 to sVal
33010>>>                    Set Visible_State of oYear to false
33011>>>                    Set Label of oYear to sVal
33012>>>                    Set Visible_State of oYear to true
33013>>>                    Set Visible_State to false
33014>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
33015>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
33016>>>                    Get piSelected_Month of oMonth to iMonth
33017>>>                    Get Value item 0 to iYear
33018>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
33019>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
33020>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
33021>>>                End_Procedure
33022>>>                
33022>>>                Send SetFontWeight
33023>>>                //AB-StoreEnd
33023>>>
33023>>>            End_Object    // oSelectYear
33024>>>
33024>>>
33024>>>            //AB-StoreStart
33024>>>                            
33024>>>            Procedure Mouse_Down
33026>>>                Integer iState
33027>>>                Get Visible_State of oSelectYear to iState
33028>>>                If (iState) Send OnKillFocus to oSelectYear
33031>>>            End_Procedure
33032>>>            
33032>>>            //AB-StoreEnd
33032>>>
33032>>>        End_Object    // Container3d2
33033>>>
33033>>>
33033>>>        //AB-StoreStart
33033>>>                            
33033>>>        //AB-StoreEnd
33033>>>
33033>>>    End_Object    // Container3d1
33034>>>
33034>>>    Object BitmapContainer3 is a BitmapContainer
33036>>>        Set Size to 9 19
33037>>>        Set Location to 88 3
33038>>>        Set Color to clWhite
33039>>>        Set Bitmap to "cdate.bmp"
33040>>>        Set Border_Style to Border_None
33041>>>
33041>>>        //AB-StoreStart
33041>>>        Procedure Mouse_Down
33043>>>            Send go_today to (Grid2(Container3d1(Self)))
33044>>>            Send Adjust_Label to oToday
33045>>>        End_Procedure
33046>>>        //AB-StoreEnd
33046>>>
33046>>>    End_Object    // BitmapContainer3
33047>>>
33047>>>    Object oToday is a Textbox
33049>>>        Set Label to "Today: 01.01.2001"
33050>>>        Set Auto_Size_State to FALSE
33051>>>        Set Color to clWhite
33052>>>        Set Location to 88 22
33053>>>        Set Size to 8 73
33054>>>        Set FontWeight to 800
33055>>>
33055>>>        //AB-StoreStart
33055>>>        Procedure Mouse_Down
33057>>>            Send go_today to (Grid2(Container3d1(Self)))
33058>>>            Send Adjust_Label
33059>>>        End_Procedure
33060>>>        
33060>>>        Procedure Adjust_Label
33062>>>            date date#
33063>>>            SysDate4 date#
33064>>>            Set Visible_State To false
33065>>>            Set Label         to (t.calendar.today+": "+String(date#))
33066>>>            Set Visible_State To true
33067>>>        End_Procedure
33068>>>        
33068>>>        Procedure Activating
33070>>>            Forward Send Activating
33072>>>            Send Adjust_Label
33073>>>        End_Procedure
33074>>>        //AB-StoreEnd
33074>>>
33074>>>    End_Object    // oToday
33075>>>
33075>>>
33075>>>    //AB-StoreStart
33075>>>                
33075>>>    procedure popup
33077>>>        local integer focus# icItm iYear iMonth
33078>>>        local date date#
33078>>>        move (focus(desktop)) to focus#
33079>>>        set invoking_object_id of (Grid2(Container3d1(self))) to focus#
33080>>>        get value of focus# item current to date#
33081>>>        ifnot (integer(date#)) sysdate date#
33084>>>        move (Date2to4(date#)) to date#
33085>>>        set p_current_date of (Grid2(Container3d1(self))) to date#
33086>>>        send fill_list to (Grid2(Container3d1(self)))
33087>>>        move (DateSegment(date#,DS_YEAR)) to iYear
33088>>>        move (DateSegment(date#,DS_MONTH)) to iMonth
33089>>>        Set Label To (MonthName(iMonth)+', '+String(iYear))
33090>>>        forward send popup
33092>>>    end_procedure
33093>>>    
33093>>>    Procedure Close_Calendar
33095>>>        Send Exit
33096>>>    End_Procedure
33097>>>    //AB-StoreEnd
33097>>>
33097>>>CD_End_Object    // oCalendar
33099>>>>
33099>>>
33099>>>
33099>>>//AB-StoreStart
33099>>>    
33099>>>    
33099>>>//AB-StoreEnd
33099>>>
33099>>>//AB/ End_Object    // prj
33099>Use Dates.Utl
33099>Use Roundfn.Fnc
INCLUDING FILE: ROUNDFN.FNC
33099>>>// ===========================================================================
33099>>>//
33099>>>// The ROUND_NUMBER global function has been designed to return the rounded
33099>>>// value of a given 'numeric' argument at a specified rounding precision.
33099>>>//
33099>>>// ---------------------------------------------------------------------------
33099>>>// This version dispenses with the use of powers (10 ^ n) to perform the
33099>>>// necessary calculations.  It uses a string handling technique instead.
33099>>>// ---------------------------------------------------------------------------
33099>>>//
33099>>>// The function requires two arguments, as follows:-
33099>>>//
33099>>>// (a) The numeric value to be rounded, where the range of valid values is
33099>>>//     +/- 99,999,999,999,999.99999999.
33099>>>//
33099>>>// (b) The rounding precision required.  This must be an integer value in the
33099>>>//     range -13 to +8.  If a value outside this range is used, the nearest
33099>>>//     threshold value is substituted.
33099>>>//
33099>>>//     Values in the range +1 to +7 perform rounding on the decimal part of
33099>>>//     the number.  A value of +8 will perform no rounding at all.  A zero
33099>>>//     value will round to the nearest whole number.  Values -1 to -13 will
33099>>>//     round progressively to the left of the decimal point (a frequent
33099>>>//     requirement in financial reporting).
33099>>>//
33099>>>// If the result of the rounding produces a value outside the valid numeric
33099>>>// range (+/- 99,999,999,999,999.99999999) then a zero value is returned.
33099>>>//
33099>>>// Assumptions:-  The only assumptions made have been that the range of
33099>>>// numeric values and the limit of eight decimal places are unlikely to change
33099>>>// in the forseeable future.
33099>>>//
33099>>>// Examples:-
33099>>>//
33099>>>//  1st Argument      2nd Argument   Return Value
33099>>>//  ------------      ------------   ------------
33099>>>//  123456.87654321         8         123456.87654321
33099>>>//  123456.87654321         2         123456.88
33099>>>// -123456.87654321         2        -123456.88
33099>>>//  123456.98765432         0         123457
33099>>>// -123456.98765432        -1        -123460
33099>>>//  123456.98765432        -2         123500
33099>>>//  123456.98765432        -3         123000
33099>>>//  987654                 -4         990000
33099>>>//  987654                 -5        1000000
33099>>>//  987654                 -6        1000000
33099>>>//  987654                 -7              0
33099>>>//
33099>>>// ===========================================================================
33099>>>
33099>>>
33099>>>Function Round_Number GLOBAL number nVal integer iRnd returns Number
33100>>>
33100>>>  Local Number nAdj
33101>>>
33101>>>  Move 10000000000000 to nAdj
33102>>>
33102>>>  // If the rounding precision falls in the range 0 to 8, then return:-
33102>>>
33102>>>  If (iRnd >= 0) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 / (Number(Left(nAdj, ((iRnd + 1) ;      min 9)))) + nVal / (Number(Left(nAdj, (9 - (iRnd min 8))))) ;        * (Number(Left(nAdj, (9 - (iRnd min 8))))))
33105>>>
33105>>>  // Else, where the rounding precision is in the range -1 to -5, return:-
33105>>>
33105>>>  If (iRnd >= -5) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(Left(nAdj, (Abs(iRnd) + 9)))) ;        * (Number(Left(nAdj, (Abs(iRnd) + 9)))))
33108>>>
33108>>>  // Else, where the rounding precision is in the range -6 to -13, return:-
33108>>>
33108>>>  Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(nAdj)) / (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))) ;        * (Number(nAdj)) * (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))))
33109>>>
33109>>>End_Function
33110>
33110>use checkafm.pkg
INCLUDING FILE: CHECKAFM.PKG
33110>>>
33110>>>
33110>>>Function Check_Afm Global String Afm_Num Returns Integer
33111>>>    Integer iii Num1 Num2
33112>>>
33112>>>    Move (Trim(Afm_Num)) To Afm_Num
33113>>>
33113>>>    For iii From 1 To (Length(Trim(Afm_Num)))
33119>>>>
33119>>>        If Not (Mid(Afm_Num,1,iii)) In  "0123456789" Function_Return 3
33122>>>    Loop
33123>>>>
33123>>>
33123>>>    Move (Right(Afm_Num,1)) to Num2
33124>>>
33124>>>    If (Length(Afm_Num)<>9) Function_Return 2
33127>>>
33127>>>    Move 0 to Num1
33128>>>
33128>>>    For iii From 1 to 8
33134>>>>
33134>>>        Add ((Mid(Afm_Num,1,iii)) * (2 ^ (9 - iii))) to Num1
33135>>>    Loop
33136>>>>
33136>>>
33136>>>    Move (Mod(Num1,11)) to Num1
33137>>>    If (Num1=10) Move 0 to Num1
33140>>>
33140>>>    If (Num1=Num2)  Function_Return 0
33143>>>    Else            Function_Return 1
33145>>>End_Function
33146>>>
33146>use checklog.pkg
INCLUDING FILE: CHECKLOG.PKG
33146>>>open syscurgl
INCLUDING FILE: SYSCURGL.FD
33148>>>open syscurxr
33150>>>open gplan
INCLUDING FILE: GPLAN.FD
33152>>>//open gplanl
33152>>>open iteml
INCLUDING FILE: ITEML.FD
33154>>>open cn
INCLUDING FILE: CN.FD
33156>>>open payresp
INCLUDING FILE: PAYRESP.FD
33158>>>open salesmen
INCLUDING FILE: SALESMEN.FD
33160>>>open mhxanik
INCLUDING FILE: MHXANIK.FD
33162>>>open constrct
INCLUDING FILE: CONSTRCT.FD
33164>>>open clients
INCLUDING FILE: CLIENTS.FD
33166>>>open wtypkin
INCLUDING FILE: WTYPKIN.FD
33168>>>open wax
INCLUDING FILE: WAX.FD
33170>>>Function Check_log Global String slog Returns Integer
33171>>>    clear gplan
33172>>>    move syscurxr.company_code to gplan.company_code
33173>>>    move syscurxr.branch_code  to gplan.branch_code
33174>>>    move syscurxr.year_year    to gplan.year_year
33175>>>    move slog                  to gplan.gplan_code
33176>>>    find eq gplan by index.1
33177>>>>
33177>>>    if (found=1) function_return 0
33180>>>    else         function_return 1
33182>>>
33182>>>End_Function
33183>>>
33183>>>Function Check_last Global String slog Returns Integer
33184>>>    clear gplan
33185>>>    move syscurxr.company_code to gplan.company_code
33186>>>    move syscurxr.branch_code  to gplan.branch_code
33187>>>    move syscurxr.year_year    to gplan.year_year
33188>>>    move slog                  to gplan.gplan_code
33189>>>    find eq gplan by index.1
33190>>>>
33190>>>    if ((found=1) and (Gplan.Gplan_Yn_Last = 1)) Function_Return 0
33193>>>    else                                         Function_return 1
33195>>>
33195>>>End_Function
33196>>>
33196>>>Function fsgplandescr String slog Returns string
33197>>>    clear gplan
33198>>>    move syscurgl.company_code to gplan.company_code
33199>>>    move syscurgl.branch_code  to gplan.branch_code
33200>>>    move syscurgl.year_year    to gplan.year_year
33201>>>    move slog                  to gplan.gplan_code
33202>>>    find eq gplan by index.1
33203>>>>
33203>>>    if (found=1) function_return gplan.gplan_descr1
33206>>>    else         function_return ''
33208>>>
33208>>>End_Function
33209>>>
33209>>>
33209>>>
33209>>>Function fsclientAFM string code Returns string
33210>>>    string name
33211>>>    clear clients
33212>>>    move code to clients.client_id
33213>>>    find eq clients by index.6
33214>>>>
33214>>>    if (found) move clients.client_afm to name
33217>>>    else       move '' to name
33219>>>    function_return name
33220>>>end_Function
33221>>>
33221>>>Function fspayrespAFM string code Returns string
33222>>>    string name
33223>>>    clear payresp
33224>>>    move code to payresp.presp_id
33225>>>    find eq payresp by index.7
33226>>>>
33226>>>    if (found) move payresp.presp_AFM to name
33229>>>    else       move '' to name
33231>>>    function_return name
33232>>>end_Function
33233>>>
33233>>>Function fssalesmenAFM string code Returns string
33234>>>    string name
33235>>>    clear salesmen
33236>>>    move code to salesmen.sls_id
33237>>>    find eq salesmen by index.4
33238>>>>
33238>>>    if (found) move salesmen.sls_AFM to name
33241>>>    else       move '' to name
33243>>>    function_return name
33244>>>end_Function
33245>>>
33245>>>
33245>>>
33245>>>//Function fsgplanperi String slog Returns string
33245>>>//    string sdescr
33245>>>//    clear gplanl
33245>>>//    move syscurgl.company_code to  gplanl.company_code
33245>>>//    move syscurgl.branch_code  to  gplanl.branch_code
33245>>>//    move slog                  to  gplanl.gplan_code
33245>>>//    find eq gplanl by index.1
33245>>>//    if (found=1) begin
33245>>>//        move gplanl.gplan_descr1 to sdescr
33245>>>//        function_return sdescr
33245>>>//    end
33245>>>//    else         function_return ''
33245>>>//End_Function
33245>>>
33245>>>
33245>>>
33245>>>Function fsclient string code Returns string
33246>>>    string name
33247>>>    clear clients
33248>>>    move code to clients.client_id
33249>>>    find eq clients by index.6
33250>>>>
33250>>>    if (found) move clients.client_name to name
33253>>>    else       move '' to name
33255>>>    function_return name
33256>>>end_Function
33257>>>
33257>>>Function fspayresp string code Returns string
33258>>>    string name
33259>>>    clear payresp
33260>>>    move code to payresp.presp_id
33261>>>    find eq payresp by index.7
33262>>>>
33262>>>    if (found) move payresp.presp_name to name
33265>>>    else       move '' to name
33267>>>    function_return name
33268>>>end_Function
33269>>>
33269>>>Function fssalesmen string code Returns string
33270>>>    string name
33271>>>    clear salesmen
33272>>>    move code to salesmen.sls_id
33273>>>    find eq salesmen by index.4
33274>>>>
33274>>>    if (found) move salesmen.sls_name to name
33277>>>    else       move '' to name
33279>>>    function_return name
33280>>>end_Function
33281>>>
33281>>>Function fsconstrct string code Returns string
33282>>>    string name
33283>>>    clear constrct
33284>>>    move code to constrct.cnt_id
33285>>>    find eq constrct by index.5
33286>>>>
33286>>>    if (found) move constrct.cnt_name to name
33289>>>    else       move '' to name
33291>>>    function_return name
33292>>>end_Function
33293>>>
33293>>>Function fsmhxanik string code Returns string
33294>>>    string name
33295>>>    clear mhxanik
33296>>>    move code to mhxanik.mhx_id
33297>>>    find eq mhxanik by index.4
33298>>>>
33298>>>    if (found) move mhxanik.mhx_name to name
33301>>>    else       move '' to name
33303>>>    function_return name
33304>>>end_Function
33305>>>
33305>>>
33305>>>Function fsptyppar string code Returns string
33306>>>    string sdescr
33307>>>    clear ptypparl
INCLUDING FILE: PTYPPARL.FD
33308>>>    move syscurxr.company_code to ptypparl.company_code
33309>>>    move syscurxr.branch_code  to ptypparl.branch_code
33310>>> //   move syscurxr.year_year    to ptypparl.year_year
33310>>>    move code                  to ptypparl.ptyppar_code
33311>>>    find eq ptypparl by index.1
33312>>>>
33312>>>    move ptypparl.ptyppar_descr to sdescr
33313>>>    function_return sdescr
33314>>>end_Function
33315>>>
33315>>>Function fsgplan string code Returns string
33316>>>    string sdescr
33317>>>    clear gplan
33318>>>    move syscurxr.company_code to gplan.company_code
33319>>>    move syscurxr.branch_code  to gplan.branch_code
33320>>>    move syscurxr.year_year    to gplan.year_year
33321>>>    move code                  to gplan.gplan_code
33322>>>    find eq gplan by index.1
33323>>>>
33323>>>    move gplan.gplan_descr1    to sdescr
33324>>>    function_return sdescr
33325>>>end_Function
33326>>>
33326>>>Function fsitem string scode Returns string
33327>>>    clear iteml
33328>>>    move scode to iteml.item_code
33329>>>    find eq iteml by index.5
33330>>>>
33330>>>    function_return iteml.item_descr
33331>>>end_Function
33332>>>
33332>>>Function fswax string srecr Returns string
33333>>>    clear wax
33334>>>    move srecr to wax.wax_recr
33335>>>    find eq wax by index.2
33336>>>>
33336>>>    function_return wax.wax_descr
33337>>>end_Function
33338>>>
33338>>>
33338>>>Function fswitemx string code Returns string
33339>>>    string name
33340>>>    clear witemx
INCLUDING FILE: WITEMX.FD
33341>>>    move syscurxr.company_code to witemx.company_code
33342>>>    move syscurxr.branch_code  to witemx.branch_code
33343>>>    move syscurxr.year_year    to witemx.year_year
33344>>>    move code to witemx.witemx_code
33345>>>    find eq witemx by index.5
33346>>>>
33346>>>    move witemx.witemx_descr to name
33347>>>    function_return name
33348>>>end_Function
33349>>>
33349>>>Function fsCNDescr String asItem Returns String
33350>>>    Clear CN
33351>>>    move asItem to CN.CN_Code
33352>>>    Find Eq CN by Index.5
33353>>>>
33353>>>    Function_Return CN.CN_Descr
33354>>>End_Function
33355>>>
33355>>>Function fswtypkin String askin Returns String
33356>>>    Clear Wtypkin
33357>>>    move askin to Wtypkin.wtypkin_code
33358>>>    Find Eq wtypkin by Index.1
33359>>>>
33359>>>    Function_Return Wtypkin.wtypkin_descr
33360>>>End_Function
33361>>>
33361>>>Function FindGtypkinDescr Integer aiCode Returns String
33362>>>    String lsDescr
33363>>>    Clear Gtypkin
INCLUDING FILE: GTYPKIN.FD
33364>>>    Move syscurxr.company_code    to Gtypkin.Company_Code
33365>>>    Move syscurxr.Branch_Code     to Gtypkin.Branch_Code
33366>>>    Move syscurxr.Year_year       to Gtypkin.Year_Year
33367>>>    Move aiCode                   to Gtypkin.Gtypkin_Code
33368>>>    Find eq Gtypkin by Index.1
33369>>>>
33369>>>    [Found] Move Gtypkin.Gtypkin_Descr to lsDescr
33370>>>    Function_Return lsDescr
33371>>>End_Function // FindGtypkinDescr
33372>>>
33372>>>Function FindBtypkinDescr Integer aiCode Returns String
33373>>>    String lsDescr
33374>>>    Clear Btypkin
INCLUDING FILE: BTYPKIN.FD
33375>>>    Move syscurxr.company_code    to Btypkin.Company_Code
33376>>>    Move syscurxr.Branch_Code     to Btypkin.Branch_Code
33377>>>    Move syscurxr.Year_year       to Btypkin.Year_Year
33378>>>    Move aiCode                   to Btypkin.btypkin_Code
33379>>>    Find eq Btypkin by Index.1
33380>>>>
33380>>>    [Found] Move Btypkin.Btypkin_Descr to lsDescr
33381>>>    Function_Return lsDescr
33382>>>End_Function // FindGtypkinDescr
33383>>>
33383>>>
33383>
33383>Use Menu_Sec.Sub
INCLUDING FILE: MENU_SEC.SUB
33383>>>
33383>>>Use Idiotht.pkg
INCLUDING FILE: IDIOTHT.PKG
33383>>>>>
33383>>>>>Open Users
INCLUDING FILE: USERS.FD
33385>>>>>Open UserGrps
INCLUDING FILE: USERGRPS.FD
33387>>>>>Open Pedia
INCLUDING FILE: PEDIA.FD
33389>>>>>Open Arxeia
INCLUDING FILE: ARXEIA.FD
33391>>>>>Open GrpPedia
INCLUDING FILE: GRPPEDIA.FD
33393>>>>>Open GrpPed0
INCLUDING FILE: GRPPED0.FD
33395>>>>>Open GrpArx
INCLUDING FILE: GRPARX.FD
33397>>>>>Open GrpArx0
INCLUDING FILE: GRPARX0.FD
33399>>>>>Open ViewFlds
INCLUDING FILE: VIEWFLDS.FD
33401>>>>>Open Oth
INCLUDING FILE: OTH.FD
33403>>>>>Open GrpOth
INCLUDING FILE: GRPOTH.FD
33405>>>>>Open GrpOth0
INCLUDING FILE: GRPOTH0.FD
33407>>>>>Open Departm
INCLUDING FILE: DEPARTM.FD
33409>>>>>
33409>>>>>
33409>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
33410>>>>>
33410>>>>>Function Network_User_Name Returns String
33411>>>>>    Local String sName sLength
33412>>>>>    Local Pointer lpName_Addr lpLength_Addr
33412>>>>>    Local Integer iRetval
33412>>>>>    Movestr (Repeat (Character (0), 255)) To sName
33413>>>>>>
33413>>>>>    GetAddress Of sName To lpName_Addr
33414>>>>>    Movestr (DwordToBytes (255)) To sLength
33415>>>>>>
33415>>>>>    GetAddress Of sLength To lpLength_Addr
33416>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
33417>>>>>>
33417>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
33420>>>>>    Else Function_Return "User Unknown"
33422>>>>>End_Function // Network_User_Name
33423>>>>>
33423>>>>>Function fsGetOfficePath Global Returns String
33424>>>>>    String sRegistryKeyPath sRegOfficePath
33425>>>>>    Set_Registry_Root                                                   to HKEY_LOCAL_MACHINE "Software"
33426>>>>>    Move "Microsoft\Office\9.0\Word"                                    to sRegistryKeyPath
33427>>>>>    Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path"    to sRegOfficePath
33431>>>>>    Move (Trim(sRegOfficePath))                                         to sRegOfficePath
33432>>>>>    If (sRegOfficePath='') Begin
33434>>>>>        Move "Microsoft\Office\8.0\Word"                                to sRegistryKeyPath
33435>>>>>        Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
33439>>>>>        Move (Trim(sRegOfficePath))                                     to sRegOfficePath
33440>>>>>        If (sRegOfficePath='') Begin
33442>>>>>            Move "Microsoft\Office\7.0\Word"                             to sRegistryKeyPath
33443>>>>>            Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
33447>>>>>            Move (Trim(sRegOfficePath))                                     to sRegOfficePath
33448>>>>>            If (sRegOfficePath='') Begin
33450>>>>>                Move "Microsoft\Office\10.0\Word"                                to sRegistryKeyPath
33451>>>>>                Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
33455>>>>>                Move (Trim(sRegOfficePath))                                     to sRegOfficePath
33456>>>>>            End
33456>>>>>>
33456>>>>>        End
33456>>>>>>
33456>>>>>    End
33456>>>>>>
33456>>>>>    Function_Return sRegOfficePath
33457>>>>>End_Procedure
33458>>>>>
33458>>>>>
33458>>>>>Function fsGetLastDir Global Returns String
33459>>>>>    String sRegistryKeyPath sRegDir sUserName
33460>>>>>    Get Network_User_Name to sUserName
33461>>>>>
33461>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
33464>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
33467>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
33469>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
33471>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
33472>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
33473>>>>>    Get_profile_string sRegistryKeyPath "Path" to sRegDir
33476>>>>>    Function_Return sRegDir
33477>>>>>End_Procedure
33478>>>>>
33478>>>>>Function fiPutLastDir Global String asDirectory Returns Integer
33479>>>>>    String sRegistryKeyPath sRegDir sUserName
33480>>>>>    Get Network_User_Name to sUserName
33481>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
33484>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
33487>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
33489>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
33491>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
33492>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
33493>>>>>    Set_profile_string sRegistryKeyPath "Path" to asDirectory
33496>>>>>    Function_Return 0
33497>>>>>End_Procedure
33498>>>>>
33498>>>>>
33498>>>>>Function fsVresExt Global String asFileName Returns String
33499>>>>>    String rVal
33500>>>>>    Integer iPos iLen
33500>>>>>    Move (UpperCase(asFileName)) to asFileName
33501>>>>>    Move (Trim(asFileName)) to asFileName
33502>>>>>    Move 0 to iPos
33503>>>>>    For iLen from 1 to (length(asFileName))
33509>>>>>>
33509>>>>>        If (Mid(asFileName,1,iLen)='.') Move iLen to iPos
33512>>>>>    Loop
33513>>>>>>
33513>>>>>    If (Not(iPos)) Function_Return ''
33516>>>>>    Move (Right(asFileName,(Length(asFileName)-iPos))) to rVal
33517>>>>>    Move (Trim(rVal)) to rVal
33518>>>>>    Function_Return rVal
33519>>>>>End_Function
33520>>>>>
33520>>>>>
33520>>>>>Function fiScreenFieldStatus Global String asViewName String asDbFormName Returns Integer
33521>>>>>    Integer rVal iUser iGroup
33522>>>>>    String  sUser sRecr
33522>>>>>    Move (Trim(asViewName))     to asViewName
33523>>>>>    Move (Trim(asDbFormName))   to asDbFormName
33524>>>>>
33524>>>>>    If ((asViewName<>'') And (asDbFormName<>'')) Begin
33526>>>>>        Get fsLoginUserID to sUser
33527>>>>>        Clear Users
33528>>>>>        Move sUser        to Users.Login_ID
33529>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
33530>>>>>>
33530>>>>>        If (Found=1) Begin
33532>>>>>            Move Users.User_ID  to iUser
33533>>>>>            Move Users.Grp_ID   to iGroup
33534>>>>>            Clear GrpOth
33535>>>>>            Move iUser          to GrpOth.User_ID
33536>>>>>            Move asViewName     to GrpOth.View_Name
33537>>>>>            Move asDbFormName   to GrpOth.Scr_Field_Name
33538>>>>>            Find eq GrpOth by Index.2 // GrpOth:Index.2:User_ID+View_Name+Scr_Field_Name
33539>>>>>>
33539>>>>>            If (Found=1) Begin
33541>>>>>                // rVal=1 ==> NO READ ALLOWED
33541>>>>>                // rVal=2 ==> NO EDIT BUT CAN COPY
33541>>>>>                // rVal=3 ==> NO EDIT AND NO COPY
33541>>>>>                If (GrpOth.Allow_Read <>'1') Move 1 to rVal
33544>>>>>                Else Begin
33545>>>>>                    If (GrpOth.Allow_Change<>'1') Begin
33547>>>>>                        If (GrpOth.Allow_Copy<>'1') Move 3 to rVal
33550>>>>>                        Else                        Move 2 to rVal
33552>>>>>                    End
33552>>>>>>
33552>>>>>                End
33552>>>>>>
33552>>>>>            End
33552>>>>>>
33552>>>>>            Else Begin
33553>>>>>                Clear GrpOth0
33554>>>>>                Move iGroup         to GrpOth0.Group_ID
33555>>>>>                Move asViewName     to GrpOth0.View_Name
33556>>>>>                Move asDbFormName   to GrpOth0.Scr_Field_Name
33557>>>>>
33557>>>>>                Find eq GrpOth0 by Index.2 // GrpOth0:Index.2:Group_ID+View_Name+Scr_Field_Name
33558>>>>>>
33558>>>>>                If (Found=1) Begin
33560>>>>>                    // rVal=1 ==> NO READ ALLOWED
33560>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
33560>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
33560>>>>>                    If (GrpOth0.Allow_Read <>'1') Move 1 to rVal
33563>>>>>                    Else Begin
33564>>>>>                        If (GrpOth0.Allow_Change<>'1') Begin
33566>>>>>                            If (GrpOth0.Allow_Copy<>'1') Move 3 to rVal
33569>>>>>                            Else                         Move 2 to rVal
33571>>>>>                        End
33571>>>>>>
33571>>>>>                    End
33571>>>>>>
33571>>>>>                End
33571>>>>>>
33571>>>>>                Else Move 0 to rVal
33573>>>>>            End
33573>>>>>>
33573>>>>>        End
33573>>>>>>
33573>>>>>        Else Move 0 to rVal
33575>>>>>    End
33575>>>>>>
33575>>>>>    Function_Return rVal
33576>>>>>End_Function
33577>>>>>
33577>>>>>Function fiFieldStatus Global Integer aiFileNumber Integer aiFieldNumber Returns Integer
33578>>>>>    Integer rVal iUser iGroup
33579>>>>>    String  sUser sRecr
33579>>>>>    If ((aiFileNumber) And (aiFieldNumber)) Begin
33581>>>>>        Get fsLoginUserID to sUser
33582>>>>>        Clear Users
33583>>>>>        Move sUser        to Users.Login_ID
33584>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
33585>>>>>>
33585>>>>>        If (Found=1) Begin
33587>>>>>            Move Users.User_ID  to iUser
33588>>>>>            Move Users.Grp_ID   to iGroup
33589>>>>>            Clear Pedia
33590>>>>>            Move aiFileNumber  to Pedia.Arxeio_ID
33591>>>>>            Move aiFieldNumber to Pedia.Pedio_Number
33592>>>>>            Find eq Pedia By Index.1 // Pedia:Index.1:Arxeio_ID+Pedio_Number
33593>>>>>>
33593>>>>>            If (Found=1) Begin
33595>>>>>                Move (Trim(Pedia.Pedio_Recr))   to sRecr
33596>>>>>                // Find Combination User/File/Field in GRPPEDIA
33596>>>>>                Clear GrpPedia
33597>>>>>                Move iUser                      to GrpPedia.User_ID
33598>>>>>                Move (Trim(sRecr))              to GrpPedia.Pedio_Recr
33599>>>>>                Find eq GrpPedia by Index.4 // GrpPedia:Index.4:Pedio_Recr + User_ID
33600>>>>>>
33600>>>>>                If (Found=1) Begin
33602>>>>>                    // rVal=1 ==> NO READ ALLOWED
33602>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
33602>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
33602>>>>>                    If (GrpPedia.Allow_Read <>'1') Move 1 to rVal
33605>>>>>                    Else Begin
33606>>>>>                        If (GrpPedia.Allow_Change<>'1') Begin
33608>>>>>                            If (GrpPedia.Allow_Copy<>'1')   Move 3 to rVal
33611>>>>>                            Else                            Move 2 to rVal
33613>>>>>                        End
33613>>>>>>
33613>>>>>                    End
33613>>>>>>
33613>>>>>                End
33613>>>>>>
33613>>>>>                Else Begin
33614>>>>>                    // Find Combination UserGrps/File/Field in GRPPED0
33614>>>>>                    Clear GrpPed0
33615>>>>>                    Move iGroup         to GrpPed0.Group_ID
33616>>>>>                    Move (Trim(sRecr))  to GrpPed0.Pedio_Recr
33617>>>>>                    Find eq GrpPed0 by Index.4 // GrpPed0:Index.4:Pedio_Recr + Group_ID
33618>>>>>>
33618>>>>>                    If (Found=1) Begin
33620>>>>>                        // rVal=1 ==> NO READ ALLOWED
33620>>>>>                        // rVal=2 ==> NO EDIT BUT CAN COPY
33620>>>>>                        // rVal=3 ==> NO EDIT AND NO COPY
33620>>>>>                        If (GrpPed0.Allow_Read <>'1') Move 1 to rVal
33623>>>>>                        Else Begin
33624>>>>>                            If (GrpPed0.Allow_Change<>'1') Begin
33626>>>>>                                If (GrpPed0.Allow_Copy<>'1')   Move 3 to rVal
33629>>>>>                                Else                           Move 2 to rVal
33631>>>>>                            End
33631>>>>>>
33631>>>>>                        End
33631>>>>>>
33631>>>>>                    End
33631>>>>>>
33631>>>>>                End
33631>>>>>>
33631>>>>>            End
33631>>>>>>
33631>>>>>            Else Begin
33632>>>>>                Move 0 to rVal
33633>>>>>            End
33633>>>>>>
33633>>>>>        End
33633>>>>>>
33633>>>>>        Else Begin
33634>>>>>            Move 0 to rVal
33635>>>>>        End
33635>>>>>>
33635>>>>>    End
33635>>>>>>
33635>>>>>    Function_Return rVal
33636>>>>>End_Function
33637>>>>>
33637>>>>>Function fsReturnFileFromPath Global String asFullPath Returns String
33638>>>>>    String rVal lsDirSep
33639>>>>>    Integer iPos iMet iLen iCnt
33639>>>>>    Move (Trim(asFullPath))                 To rVal
33640>>>>>    Move (Sysconf(SYSCONF_DIR_SEPARATOR))   To lsDirSep
33641>>>>>    If (rVal Contains lsDirSep) Begin
33643>>>>>        Move (Length(rVal)) to iLen
33644>>>>>        Move iLen to iCnt
33645>>>>>        While iCnt Gt 0
33649>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Begin
33651>>>>>                If (iCnt=iLen) Function_Return asFullPath
33654>>>>>                Else Function_Return (Right(rVal,(iLen-iCnt)))
33656>>>>>            End
33656>>>>>>
33656>>>>>            Decrement iCnt
33657>>>>>        End // While iCnt Gt 0
33658>>>>>>
33658>>>>>    End
33658>>>>>>
33658>>>>>    Else  Function_Return (Trim(asFullPath))
33660>>>>>    Function_Return rVal
33661>>>>>End_Function
33662>>>>>
33662>>>>>Function fsReturnDirectoriesFromPath Global String asFullPath Returns String
33663>>>>>    String rVal lsDirSep
33664>>>>>    Integer iPos iMet iLen iCnt
33664>>>>>    Move (Trim(asFullPath))                 To rVal
33665>>>>>    Move (Sysconf(SYSCOnF_DIR_SEPARATOR))   To lsDirSep
33666>>>>>    If (rVal Contains lsDirSep) Begin
33668>>>>>        Move (Length(rVal)) to iLen
33669>>>>>        Move iLen to iCnt
33670>>>>>        While iCnt Gt 0
33674>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Function_Return (Left(rVal,iCnt))
33677>>>>>            Decrement iCnt
33678>>>>>        End // While iCnt Gt 0
33679>>>>>>
33679>>>>>    End
33679>>>>>>
33679>>>>>    Function_Return rVal
33680>>>>>End_Function
33681>>>>>
33681>>>>>//Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
33681>>>>>//    Local String rVal lsTmp lsOO lsLL
33681>>>>>//    Local Number lnOO lnLL
33681>>>>>
33681>>>>>//    Move '' to lsOO
33681>>>>>//    Move '' to lsLL
33681>>>>>//    Move '' to rVal
33681>>>>>
33681>>>>>//    Move (Integer(anTime))                              to lnOO
33681>>>>>//    ////////////////////////////////////////////
33681>>>>>//    // sos sos sos jsjsjsjsjs yannis 30/03/2000
33681>>>>>//    //If ((lnOO=24) and (lnll=0)) Move 0 to lnOO
33681>>>>>//    ////////////////////////////////////////////
33681>>>>>
33681>>>>>//    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
33681>>>>>
33681>>>>>//    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
33681>>>>>//    Else         Move (String(lnOO))                    to lsOO
33681>>>>>//    Move (Trim(lsOO))                                   to lsOO
33681>>>>>
33681>>>>>//    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
33681>>>>>//    Else         Move (String(lnLL))                    to lsLL
33681>>>>>//    Move (Trim(lsLL))                                   to lsLL
33681>>>>>
33681>>>>>//    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
33681>>>>>
33681>>>>>//    Move (Trim(rVal)) to rVal
33681>>>>>
33681>>>>>//    Function_Return rVal
33681>>>>>//End_Function
33681>>>>>
33681>>>>>//Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
33681>>>>>//    Local Number rVal nOres nLepta
33681>>>>>//    Move (Integer(aiMinutes/60))    to nOres
33681>>>>>//    Move (    Mod(aiMinutes,60))    to nLepta
33681>>>>>//    Move (nOres+(nLepta/100))       to rVal
33681>>>>>//    Function_Return rVal
33681>>>>>//End_Function
33681>>>>>
33681>>>>>//Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
33681>>>>>//    Local Integer rVal
33681>>>>>//    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
33681>>>>>//    Function_Return rVal
33681>>>>>//End_Function
33681>>>>>
33681>>>>>//Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;
33681>>>>>//                                                                    Number anEndTime    ;
33681>>>>>//                                                                    Returns Integer
33681>>>>>//    Local Integer rVal iMinStart iMinEnd
33681>>>>>
33681>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
33681>>>>>
33681>>>>>//    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
33681>>>>>//    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
33681>>>>>//    Move (iMinEnd-iMinStart)                                                     to rVal
33681>>>>>//    Function_Return rVal
33681>>>>>//End_Function
33681>>>>>
33681>>>>>
33681>>>>>//Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;
33681>>>>>//                                                                Number anEndTime    ;
33681>>>>>//                                                                Returns Number
33681>>>>>//    Local Integer iTmp
33681>>>>>//    Local Number  rVal
33681>>>>>
33681>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
33681>>>>>
33681>>>>>//    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
33681>>>>>//    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
33681>>>>>//    Function_Return rVal
33681>>>>>//End_Function
33681>>>>>
33681>>>>>
33681>>>>>Function fsLoginUserID Global Returns String
33682>>>>>    Local String LastLogin# LoginUserid#
33683>>>>>    get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin#
33686>>>>>    If LastLogin# eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin#
33689>>>>>    insert "WorkSpaces\" in LastLogin# at 1
33691>>>>>    Append LastLogin# "\" (Module_Name(Self)) "\LastLogin"
33694>>>>>    get_profile_string LastLogin# "LoginUserId"  to LoginUserId#
33697>>>>>    Trim LoginUserID# to LoginUserID#
33698>>>>>>
33698>>>>>    If LoginUserId# eq "" Move (Network_User_Name(Current_Object)) to LoginUserId#
33701>>>>>    Function_Return LoginUserID#
33702>>>>>End_Function
33703>>>>>
33703>>>>>Function fiWriteRegistryLastSDFPath Global String asLastPath Returns Integer
33704>>>>>    Integer rVal
33705>>>>>    String  lsCurrentWksp
33705>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33708>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33711>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33713>>>>>    // Œœ¦ ¡¢œ ›   - Last_SDF_Path -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
33713>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
33713>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
33716>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
33719>>>>>    Function_Return rVal
33720>>>>>End_Function
33721>>>>>
33721>>>>>
33721>>>>>Function fsReadRegistryLastSDFPath Global Returns String
33722>>>>>    String rVal lsCurrentWksp
33723>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33726>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33729>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33731>>>>>    // Œœ¦ ¡¢œ ›   - LastParastUsed -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
33731>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
33731>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
33734>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
33737>>>>>    Function_Return (Trim(rVal))
33738>>>>>End_Function
33739>>>>>
33739>>>>>
33739>>>>>Function fiWriteRegistryLastMCryptPath Global String asLastPath Returns Integer
33740>>>>>    Integer rVal
33741>>>>>    String  lsCurrentWksp
33741>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33744>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33747>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33749>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
33752>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
33755>>>>>    Function_Return rVal
33756>>>>>End_Function
33757>>>>>
33757>>>>>
33757>>>>>Function fsReadRegistryLastMCryptPath Global Returns String
33758>>>>>    String rVal lsCurrentWksp
33759>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33762>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33765>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33767>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
33770>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
33773>>>>>    Function_Return (Trim(rVal))
33774>>>>>End_Function
33775>>>>>
33775>>>>>Function fiWriteRegistryLastWEBPath Global String asLastPath Returns Integer
33776>>>>>    Integer rVal
33777>>>>>    String  lsCurrentWksp
33777>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33780>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33783>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33785>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
33788>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
33791>>>>>    Function_Return rVal
33792>>>>>End_Function
33793>>>>>
33793>>>>>
33793>>>>>Function fsReadRegistryLastWEBPath Global Returns String
33794>>>>>    String rVal lsCurrentWksp
33795>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33798>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33801>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33803>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
33806>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
33809>>>>>    Function_Return (Trim(rVal))
33810>>>>>End_Function
33811>>>>>
33811>>>>>Function fsReadRegistryFEMRootDir Global Returns String
33812>>>>>    String rVal lsCurrentWksp
33813>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33816>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33819>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33821>>>>>    Append lsCurrentWksp "\FEM"
33822>>>>>    Get_Profile_String lsCurrentWksp "RootDir"  to rVal
33825>>>>>    Function_Return (Trim(rVal))
33826>>>>>End_Function
33827>>>>>
33827>>>>>Function fsReadRegistryFEMDevicePath Global Returns String
33828>>>>>    String rVal lsCurrentWksp
33829>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33832>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33835>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33837>>>>>    Append lsCurrentWksp "\FEM"
33838>>>>>    Get_Profile_String lsCurrentWksp "DevicePath"  to rVal
33841>>>>>    Function_Return (Trim(rVal))
33842>>>>>End_Function
33843>>>>>
33843>>>>>Function fiWriteRegistryFEMRootDir Global Returns Integer
33844>>>>>    Integer rVal
33845>>>>>    String  lsCurrentWksp
33845>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33848>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33851>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33853>>>>>    Append lsCurrentWksp "\FEM"
33854>>>>>    Set_Profile_String lsCurrentWksp "RootDir"  to "C:\FEM_ROOT\"
33857>>>>>    Function_Return rVal
33858>>>>>End_Function
33859>>>>>
33859>>>>>Function fiWriteRegistryFEMDevicePath Global Returns Integer
33860>>>>>    Integer rVal
33861>>>>>    String  lsCurrentWksp
33861>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33864>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33867>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33869>>>>>    Append lsCurrentWksp "\FEM"
33870>>>>>    Set_Profile_String lsCurrentWksp "DevicePath"  to "C:\FEM_ROOT\Device_File1.dat"
33873>>>>>    Function_Return rVal
33874>>>>>End_Function
33875>>>>>
33875>>>>>
33875>>>>>
33875>>>>>
33875>>>>>        Function fiWriteRegistryLastDEDPath Global String asLastPath Returns Integer
33876>>>>>            Integer rVal
33877>>>>>            String  lsCurrentWksp
33877>>>>>            Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33880>>>>>            If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33883>>>>>            Insert "WorkSpaces\" in lsCurrentWksp at 1
33885>>>>>            Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_DED_Path"
33888>>>>>            Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
33891>>>>>            Function_Return rVal
33892>>>>>        End_Function
33893>>>>>
33893>>>>>
33893>>>>>        Function fsReadRegistryLastDEDPath Global Returns String
33894>>>>>            String rVal lsCurrentWksp
33895>>>>>            Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33898>>>>>            If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33901>>>>>            Insert "WorkSpaces\" in lsCurrentWksp at 1
33903>>>>>            Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_DED_Path"
33906>>>>>            Get_Profile_String lsCurrentWksp "Path"  to rVal
33909>>>>>            Function_Return (Trim(rVal))
33910>>>>>        End_Function
33911>>>>>
33911>>>>>
33911>>>>>
33911>>>>>Function fig_Is_Admin Global Returns Integer
33912>>>>>    String sUser
33913>>>>>    Integer rVal
33913>>>>>    Get fsLoginUserID to sUser
33914>>>>>    Move (trim(sUser)) to sUser
33915>>>>>    Clear Users
33916>>>>>    Move sUser to Users.Login_ID
33917>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
33918>>>>>>
33918>>>>>    Move Users.Admin_Rights to rVal
33919>>>>>    Function_Return rVal
33920>>>>>End_Function
33921>>>>>
33921>>>>>Function fig_The_User_Group Global Returns Integer
33922>>>>>    String sUser
33923>>>>>    Get fsLoginUserID   to sUser
33924>>>>>    Move (trim(sUser))  to sUser
33925>>>>>    Clear Users
33926>>>>>    Move sUser          to Users.Login_ID
33927>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
33928>>>>>>
33928>>>>>    Clear UserGrps
33929>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
33930>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
33931>>>>>>
33931>>>>>    Function_Return UserGrps.Grp_ID
33932>>>>>End_Function
33933>>>>>
33933>>>>>Function fsg_The_User_Department Global Returns String
33934>>>>>    String sUser
33935>>>>>    Get fsLoginUserID   to sUser
33936>>>>>    Move (trim(sUser))  to sUser
33937>>>>>    Clear Users
33938>>>>>    Move sUser          to Users.Login_ID
33939>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
33940>>>>>>
33940>>>>>    Clear Departm
33941>>>>>    Move Users.Departm_Code   to Departm.Code
33942>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
33943>>>>>>
33943>>>>>    Function_Return Departm.Code
33944>>>>>End_Function
33945>>>>>
33945>>>>>
33945>>>>>Function fig_Is_Specific_Admin Global String asUser Returns Integer
33946>>>>>    Integer rVal
33947>>>>>    Move (trim(asUser)) to asUser
33948>>>>>    Clear Users
33949>>>>>    Move asUser to Users.Login_ID
33950>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
33951>>>>>>
33951>>>>>    Move Users.Admin_Rights to rVal
33952>>>>>    Function_Return rVal
33953>>>>>End_Function
33954>>>>>
33954>>>>>Function fig_The_Specific_User_Group Global String asUser Returns Integer
33955>>>>>    Move (trim(asUser))  to asUser
33956>>>>>    Clear Users
33957>>>>>    Move asUser          to Users.Login_ID
33958>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
33959>>>>>>
33959>>>>>    Clear UserGrps
33960>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
33961>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
33962>>>>>>
33962>>>>>    Function_Return UserGrps.Grp_ID
33963>>>>>End_Function
33964>>>>>
33964>>>>>Function fsg_The_Specific_User_Department Global String asUser Returns String
33965>>>>>    Move (trim(asUser))  to asUser
33966>>>>>    Clear Users
33967>>>>>    Move asUser          to Users.Login_ID
33968>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
33969>>>>>>
33969>>>>>    Clear Departm
33970>>>>>    Move Users.Departm_Code   to Departm.Code
33971>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
33972>>>>>>
33972>>>>>    Function_Return Departm.Code
33973>>>>>End_Function
33974>>>>>
33974>>>>>
33974>>>
33974>>>Class ViewPopupMenu_Sec Is A ViewPopupMenu
33975>>>
33975>>>    Open Sysfile
INCLUDING FILE: SYSFILE.FD
33977>>>    Open Users
33979>>>    Open Views
INCLUDING FILE: VIEWS.FD
33981>>>    Open GrpViews
INCLUDING FILE: GRPVIEWS.FD
33983>>>    Open GrpView0
INCLUDING FILE: GRPVIEW0.FD
33985>>>    Open Arxeia
33987>>>    Open GrpArx
33989>>>
33989>>>    Function Find_User_Rights_In_Class String asView Returns Integer
33990>>>        String  lsView lsLogin
33991>>>        Integer liUser  liViews iGroup
33991>>>
33991>>>        Move (fsLoginUserID())      to lsLogin
33992>>>        Move (Trim(ToOEM(asView)))  to lsView
33993>>>
33993>>>        //////  /////////////////////////////////////
33993>>>        Clear Users
33994>>>        Move lsLogin    to Users.Login_ID
33995>>>
33995>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
33996>>>>
33996>>>        If (Found=1)  Begin
33998>>>            Move Users.User_ID  to liUser
33999>>>            Move Users.Grp_ID   to iGroup
34000>>>        End
34000>>>>
34000>>>        Else Function_Return 0
34002>>>
34002>>>        Clear Views
34003>>>        Move (Trim(lsView)) to Views.Menu_Name
34004>>>        Find eq Views by Index.2 // Views:Index.2:Views.Menu_Name
34005>>>>
34005>>>        If (Found=1) Begin
34007>>>            Move Views.View_ID to liViews
34008>>>            Clear GrpViews
34009>>>            Move liUser    to GrpViews.User_ID
34010>>>            Move liViews   to GrpViews.View_ID
34011>>>            Find Eq GrpViews by Index.1 // GrpViews:Index.1:GrpViews.User_ID+GrpViews.View_ID
34012>>>>
34012>>>            If (Found=1) Begin // And (liUser=GrpViews.User_ID) And (liViews=GrpViews.View_ID)) Begin
34014>>>                Function_Return (GrpViews.Allow_Read<>'1')
34015>>>            End
34015>>>>
34015>>>            Else Begin
34016>>>                Clear GrpView0
34017>>>                Move iGroup    to GrpView0.Group_ID
34018>>>                Move liViews   to GrpView0.View_ID
34019>>>                Find eq GrpView0 by Index.1 // GrpView0:Index.1:Group_ID+View_ID
34020>>>>
34020>>>                If (Found=1) Begin
34022>>>                    Function_Return (GrpView0.Allow_Read<>'1')
34023>>>                End
34023>>>>
34023>>>                Else         Function_Return 0
34025>>>            End
34025>>>>
34025>>>        End
34025>>>>
34025>>>        Else Function_Return 0
34027>>>    End_Function
34028>>>
34028>>>//    Procedure Enhmerose_Views_File_In_Class
34028>>>//        Integer liCount liInt liLastNo
34028>>>//        String lsStr
34028>>>//        Get Item_Count to liCount
34028>>>//        // find last view_id
34028>>>//        Clear Views
34028>>>//        Move 9999 to Views.View_ID
34028>>>//        Find lt Views by index.1 // view_id
34028>>>//        If (Found=1)    Move Views.View_ID  to liLastNo
34028>>>//        Else            Move 0              to liLastNo
34028>>>//        For liInt From 0 to (liCount-1)
34028>>>//            Get Value item liInt to lsStr
34028>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
34028>>>//            //Move (Trim(lsStr)) to lsStr
34028>>>//            If (lsStr<>'') Begin
34028>>>//                Clear Views
34028>>>//                Move lsStr to Views.Menu_Name
34028>>>//                Find eq Views by index.2 // Views.Menu_Name
34028>>>//                If (NOT(Found)) Begin
34028>>>//                    Add 1 to liLastNo
34028>>>//                    Move liLastNo to Views.View_ID
34028>>>//                    Saverecord Views
34028>>>//                End
34028>>>//            End
34028>>>//        Loop
34028>>>//        For liInt From 0 to (liCount-1)
34028>>>//            Get Value item liInt to lsStr
34028>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
34028>>>//            //Move (Trim(lsStr)) to lsStr
34028>>>//            If (lsStr<>'') Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
34028>>>//        Loop
34028>>>//    End_procedure
34028>>>
34028>>>    Procedure OnInitMenu
34029>>>        Integer liCount liInt liLastNo
34030>>>        String lsStr
34030>>>
34030>>>        Get Item_Count to liCount
34031>>>
34031>>>        // find last view_id
34031>>>        Clear Views
34032>>>        Move 9999 to Views.View_ID
34033>>>        Find lt Views by index.1 // view_id
34034>>>>
34034>>>        If (Found=1)    Move Views.View_ID  to liLastNo
34037>>>        Else            Move 0              to liLastNo
34039>>>        For liInt From 0 to (liCount-1)
34045>>>>
34045>>>            Get Value item liInt to lsStr
34046>>>            Move (Trim(lsStr)) to lsStr
34047>>>            If ((lsStr<>'') and (Length(lsStr)>2)) Begin
34049>>>                Clear Views
34050>>>                Move (ToOEM(lsStr)) to Views.Menu_Name
34051>>>                Find eq Views by index.2 // Views.Menu_Name
34052>>>>
34052>>>                If (NOT(Found)) Begin
34054>>>                    Add 1 to liLastNo
34055>>>                    Move liLastNo to Views.View_ID
34056>>>                    //Move (ToOEM(lsStr)) to Views.Menu_Name
34056>>>                    Saverecord Views
34057>>>                End
34057>>>>
34057>>>            End
34057>>>>
34057>>>        Loop
34058>>>>
34058>>>        For liInt From 0 to (liCount-1)
34064>>>>
34064>>>            Get Value item liInt to lsStr
34065>>>            Move (Trim(lsStr)) to lsStr
34066>>>            Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
34067>>>        Loop
34068>>>>
34068>>>
34068>>>    End_procedure
34069>>>
34069>>>//    Procedure End_Construct_Object
34069>>>//        Forward Send End_Construct_Object
34069>>>//        Send Enhmerose_Views_File_In_Class
34069>>>//    End_Procedure
34069>>>
34069>>>End_Class //ButtonSub
34070>>>
34070>>>
34070>Use DD_Sec.Sub
INCLUDING FILE: DD_SEC.SUB
34070>>>
34070>>>Open Sysfile
34072>>>Open UserGrps
34074>>>Open Users
34076>>>Open Views
34078>>>Open GrpViews
34080>>>Open Arxeia
34082>>>Open GrpArx
34084>>>Open GrpArx0
34086>>>Open GrpView0
34088>>>
34088>>>Use DD.Sub
34088>>>
34088>>>Class Datadictionary_Sec  Is A DatadictionarySub
34089>>>
34089>>>
34089>>>    Procedure Construct_Object
34090>>>        Forward Send Construct_Object
34092>>>        Property Integer cpiUpdate              0
34093>>>        Property Integer cpiBackout             0
34094>>>        Property Integer cpiEditing             0
34095>>>        Property Integer cpiFileNumber          0
34096>>>        Property String  cpsFileName            ''
34097>>>        Property String  cpsLoginID             ''
34098>>>        Property Integer cpiCannot_Read         0
34099>>>        Property Integer cpiCannot_Create       0
34100>>>        Property Integer cpiCannot_Delete       0
34101>>>        Property Integer cpiCannot_Edit         0
34102>>>        Property Integer piFN                   0
34103>>>    End_Procedure
34104>>>
34104>>>//    Procedure Save_Main_File
34104>>>//        If (Operation_Origin<>Self) Begin
34104>>>//            If Indirect_File.Recnum Eq 0 Procedure_Return
34104>>>//        End
34104>>>//        Forward Send Save_Main_File
34104>>>//    End_Procedure
34104>>>
34104>>>
34104>>>
34104>>>    Function Validate_Save Returns Integer
34105>>>        Integer rVal
34106>>>        Forward Get Validate_Save to rVal
34108>>>        If (Not(rVal)) Begin
34110>>>            Get cpiCannot_Read to rVal
34111>>>            If (Not(rVal)) Begin
34113>>>                Set cpiEditing to ((cpiBackout(Self)=1) and (cpiUpdate(Self)=1))
34114>>>                If (cpiEditing(Self)=1) Get cpiCannot_Edit      to rVal
34117>>>                Else                    Get cpiCannot_Create    to rVal
34119>>>            End
34119>>>>
34119>>>            If (rVal) Send Operation_Not_Allowed rVal
34122>>>        End
34122>>>>
34122>>>        Function_Return rVal
34123>>>    End_Function
34124>>>
34124>>>    Function Validate_Delete Returns Integer
34125>>>        Integer rVal
34126>>>        Forward Get Validate_Delete to rVal
34128>>>        If (Not(rVal)) Begin
34130>>>            Get cpiCannot_Read to rVal
34131>>>            If (Not(rVal)) Get cpiCannot_Delete to rVal
34134>>>            If (rVal) Send Operation_Not_Allowed rVal
34137>>>        End
34137>>>>
34137>>>        Function_Return rVal
34138>>>    End_Function
34139>>>
34139>>>    Procedure End_Construct_Object
34140>>>        Integer liSrv rVal
34141>>>        String lsStr
34141>>>        Forward Send End_Construct_Object
34143>>>        Get Main_File                                   To liSrv
34144>>>        Set cpiFileNumber                               To liSrv
34145>>>        Get_Attribute DF_FILE_PHYSICAL_NAME Of liSrv    To lsStr
34148>>>        Set cpsFileName                                 To (Trim(Uppercase(lsStr)))
34149>>>        Set cpsLoginID                                  To (fsLoginUserID())
34150>>>        Send Find_User_Rights
34151>>>        Set piFN to lisrv
34152>>>    End_Procedure
34153>>>
34153>>>    Procedure Find_User_Rights
34154>>>        String lsArxeio lsLogin
34155>>>        Integer liUser liArxeio iGroup
34155>>>
34155>>>        Get cpiFileNumber   to liArxeio
34156>>>        Get cpsFileName     to lsArxeio
34157>>>        Get cpsLoginID      to lsLogin
34158>>>
34158>>>        Clear Users
34159>>>        Move lsLogin    to Users.Login_ID
34160>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34161>>>>
34161>>>        If (Found=1)  Begin
34163>>>            Move Users.User_ID  to liUser
34164>>>            Move Users.Grp_ID   to iGroup
34165>>>        End
34165>>>>
34165>>>        //Else Send Operation_Not_Allowed 9999
34165>>>
34165>>>        Clear Arxeia
34166>>>
34166>>>        Move liArxeio to Arxeia.Arxeio_ID
34167>>>        Find eq Arxeia by Index.1 // Arxeia:Index.1:Arxeia.Arxeio_ID
34168>>>>
34168>>>
34168>>>        If (Found=1) Begin
34170>>>            Move Arxeia.Arxeio_ID to liArxeio
34171>>>
34171>>>            Clear GrpArx
34172>>>            Move liUser     to GrpArx.User_ID
34173>>>            Move liArxeio   to GrpArx.Arxeio_ID
34174>>>            Find eq GrpArx by Index.1 // GrpArx:Index.1:GrpArx.User_ID+GrpArx.Arxeio_ID
34175>>>>
34175>>>            If (Found=1) Begin
34177>>>               If (GrpArx.Allow_Read  ='1') Set cpiCannot_Read   to 0
34180>>>               Else                         Set cpiCannot_Read   to 10003
34182>>>               If (GrpArx.Allow_Create='1') Set cpiCannot_Create to 0
34185>>>               Else                         Set cpiCannot_Create to 10000
34187>>>               If (GrpArx.Allow_Change='1') Set cpiCannot_Edit   to 0
34190>>>               Else                         Set cpiCannot_Edit   to 10001
34192>>>               If (GrpArx.Allow_Delete='1') Set cpiCannot_Delete to 0
34195>>>               Else                         Set cpiCannot_Delete to 10002
34197>>>            End
34197>>>>
34197>>>            Else Begin
34198>>>                Clear GrpArx0
34199>>>                Move iGroup   to GrpArx0.Group_ID
34200>>>                Move liArxeio to GrpArx0.Arxeio_ID
34201>>>                Find eq GrpArx0 by Index.1 // GrpArx0:Index.1:Group_ID+Arxeio_ID
34202>>>>
34202>>>                If (Found=1) Begin
34204>>>                    If (GrpArx0.Allow_Read  ='1')   Set cpiCannot_Read   to 0
34207>>>                    Else                            Set cpiCannot_Read   to 20003
34209>>>                    If (GrpArx0.Allow_Create='1')   Set cpiCannot_Create to 0
34212>>>                    Else                            Set cpiCannot_Create to 20000
34214>>>                    If (GrpArx0.Allow_Change='1')   Set cpiCannot_Edit   to 0
34217>>>                    Else                            Set cpiCannot_Edit   to 20001
34219>>>                    If (GrpArx0.Allow_Delete='1')   Set cpiCannot_Delete to 0
34222>>>                    Else                            Set cpiCannot_Delete to 20002
34224>>>                End
34224>>>>
34224>>>                Else Begin
34225>>>                    Set cpiCannot_Read   to 0
34226>>>                    Set cpiCannot_Edit   to 0
34227>>>                    Set cpiCannot_Create to 0
34228>>>                    Set cpiCannot_Delete to 0
34229>>>                End
34229>>>>
34229>>>            End
34229>>>>
34229>>>        End
34229>>>>
34229>>>        Else Begin
34230>>>            // €¤ ›œ¤ ™¨œŸœ  «¦ ˜¨®œ ¦ «¦«œ Ÿœà¨¦¬£œ ¦«  ¦ ®¨ž©«žª œ®œ  §¨¦©™˜©ž ©'˜¬«¦
34230>>>            Set cpiCannot_Read   to 0
34231>>>            Set cpiCannot_Edit   to 0
34232>>>            Set cpiCannot_Create to 0
34233>>>            Set cpiCannot_Delete to 0
34234>>>        End
34234>>>>
34234>>>    End_Procedure
34235>>>
34235>>>    Procedure Clear_main_file
34236>>>        Forward Send Clear_main_file
34238>>>        Set cpiBackout to 0
34239>>>        Set cpiUpdate  to 0
34240>>>    End_Procedure
34241>>>
34241>>>    Procedure Update
34242>>>        Forward Send Update
34244>>>        Set cpiUpdate to 1
34245>>>    End_Procedure
34246>>>
34246>>>    Procedure Backout
34247>>>        Forward Send Backout
34249>>>        Set cpiBackout to 1
34250>>>    End_Procedure
34251>>>
34251>>>    Procedure OnConstrain
34252>>>        Integer rVal liSrv
34253>>>        Forward Send OnConstrain
34255>>>        Get cpiFileNumber  To liSrv
34256>>>        Move liSrv         To Filenumber
34257>>>        Get cpiCannot_Read to rVal
34258>>>        If (rVal) Constrain Indirect_File.Recnum eq 0
34262>>>    End_Procedure
34263>>>
34263>>>    Procedure Operation_Not_Allowed  Integer iError_Num
34264>>>        String sLektiko
34265>>>        Move '' to sLektiko
34266>>>
34266>>>             If iError_Num eq 10000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
34269>>>        Else If iError_Num eq 10001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Users permissions. Check with your Administrator"    to sLektiko
34273>>>        Else If iError_Num eq 10002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
34277>>>        Else If iError_Num eq 10003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
34281>>>        Else If iError_Num eq 20000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
34285>>>        Else If iError_Num eq 20001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Group permissions. Check with your Administrator"    to sLektiko
34289>>>        Else If iError_Num eq 20002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
34293>>>        Else If iError_Num eq 20003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
34297>>>        Else If iError_Num eq  9999 Move "Unknown User in Users File"                                                                                    to sLektiko
34301>>>        Else If iError_Num eq 20101 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Change its Data"                 to sLektiko
34305>>>        Else If iError_Num eq 20102 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Delete It"                       to sLektiko
34309>>>        Append sLektiko '\nFile = ' (String(cpiFileNumber(Self))) ' - ' (CpsFileName(Self))
34313>>>
34313>>>             If iError_Num eq 10000 Error 10000 sLektiko
34316>>>        Else If iError_Num eq 10001 Error 10001 sLektiko
34320>>>        Else If iError_Num eq 10002 Error 10002 sLektiko
34324>>>        Else If iError_Num eq 10003 Error 10003 sLektiko
34328>>>        Else If iError_Num eq 20000 Error 20000 sLektiko
34332>>>        Else If iError_Num eq 20001 Error 20001 sLektiko
34336>>>        Else If iError_Num eq 20002 Error 20002 sLektiko
34340>>>        Else If iError_Num eq 20003 Error 20003 sLektiko
34344>>>        Else If iError_Num eq  9999 Error  9999 sLektiko
34348>>>        Else If iError_Num eq 20101 Error 20101 sLektiko
34352>>>        Else If iError_Num eq 20102 Error 20102 sLektiko
34356>>>
34356>>>        Else Forward Send Operation_Not_Allowed  iError_Num
34359>>>    End_Procedure   // Operation_Not_Allowed
34360>>>
34360>>>
34360>>>End_Class //Datadictionary_Sec
34361>
34361>//------------------------------
34361>Use Flexole
INCLUDING FILE: FLEXOLE.PKG
34361>>>//****************************************************************************
34361>>>//
34361>>>// $File name  : FlexOLE
34361>>>// $File title : Base class for OLE Automation in DataFlex under win95/NT
34361>>>// Notice      : Copyright (c) ADB-UTVECKLING AB 1996-1998
34361>>>// $Author     : JW, SF
34361>>>// $System     : DFOLE
34361>>>// Created     : 96-05-30 @ 18.12.51
34361>>>// $Last Rev   : 96-10-09 @ 14.59.35
34361>>>//
34361>>>// $Description
34361>>>// This file contains the complete FlexOLE OLE2 implementation in DataFlex.
34361>>>// Including all DLL interface declarations and DataFlex classes
34361>>>//
34361>>>// $Rev History
34361>>>//   96-05-30 File header created
34361>>>//
34361>>>//****************************************************************************
34361>>>
34361>>>USE DLL
34361>>>USE FOLE_API
INCLUDING FILE: FOLE_API.PKG
34361>>>>>//****************************************************************************
34361>>>>>//
34361>>>>>// $File name  : FOLE_API
34361>>>>>// $File title : API for FlexOLE
34361>>>>>// Notice      : Copyright (c) ADB-UTVECKLING AB 1996-1998
34361>>>>>// $Author     : JW, SF
34361>>>>>// $System     : FlexOLE
34361>>>>>// Created     : 96-05-30 @ 18.12.51
34361>>>>>// $Last Rev   : 96-10-09 @ 14.59.35
34361>>>>>//
34361>>>>>// $Description
34361>>>>>//  DLL interface declarations
34361>>>>>//
34361>>>>>// $Rev History
34361>>>>>//   96-05-30 File header created
34361>>>>>//
34361>>>>>//****************************************************************************
34361>>>>>
34361>>>>>
34361>>>>>USE DLL
34361>>>>>
34361>>>>>// Global variable for OLE
34361>>>>>Integer WM_DFOCXEVENT // This is the message sent from the DLL
34361>>>>>Integer WM_DFOCXNOTIFYEVENT // This is the notify message sent from the DLL
34361>>>>>
34361>>>>>//Global integer for objectId
34361>>>>>Integer oOLEVariantId
34361>>>>>
34361>>>>>
34361>>>>>
34361>>>>>// Optional param for OLEVariant.
34361>>>>>// For optional parameters, pass OLE_VT_OPTIONAL instead of an OLEVariant
34361>>>>>
34361>>>>>// DISP_E_PARAMNOTFOUND is the constant used together with OLE_VT_ERROR
34361>>>>>// to signify that this parameter is optional and not specified.
34361>>>>>// It is only used internally, DON'T use it directly, see above constant.
34361>>>>>
34361>>>>>// The current maximum size of strings, used both for String and OLEVariant with OLE_VT_BSTR
34361>>>>>
34361>>>>>// Null terminating for C strings
34361>>>>>
34361>>>>>// Alias data types
34361>>>>>                            // but since DataFlex has no substitute data type
34361>>>>>                            // it is internally casted back and forth
34361>>>>>                            // into an Integer
34361>>>>>                            // NOTE! Might be changed to a one char string
34361>>>>>
34361>>>>>
34361>>>>>
34361>>>>>// Pointers to vars needs to be inside a Type to use GetAddress...
34361>>>>>// It looks like we have to create these anyway (to compile cleanly)
34361>>>>>
34361>>>>>
34361>>>>>Type TP_OLEVariant
34361>>>>>    Field Variant.vt     as DWORD      // An OLE_VT_XXX constant
34361>>>>>    Field Variant.iVal   as DWORD      // If vt is OLE_VT_I2 this field contains a Short value
34361>>>>>    Field Variant.lVal   as DWORD      // If vt is OLE_VT_I4 this field contains an Integer value
34361>>>>>    Field Variant.fltVal as Char 10    // If vt is OLE_VT_R4 this field contains a ShortReal value
34361>>>>>    Field Variant.dblVal as Char 20    // If vt is OLE_VT_R8 this field contains a Real value
34361>>>>>    Field Variant.cyVal  as Char 25    // If vt is OLE_VT_CY this field contains a Currency value
34361>>>>>    Field Variant.dtVal  as Date       // If vt is OLE_VT_DATE this field contains a Date value
34361>>>>>    Field Variant.strVal as Char 255   // If vt is OLE_VT_BSTR this field contains a pointer to a String
34361>>>>>    Field Variant.dspVal as LPDISPATCH // If vt is OLE_VT_DISPATCH this field contains an LPDISPATCH
34361>>>>>    Field Variant.errVal as OLEError   // If vt is OLE_VT_ERROR this field contains an OLEError
34361>>>>>    Field Variant.blVal  as Bool       // If vt is OLE_VT_BOOL this field contains a Bool value
34361>>>>>    Field Variant.uknVal as LPIUNKNOWN // If vt is OLE_VT_UNKNOWN this field contains an LPIUnknown
34361>>>>>    Field Variant.ui1Val as DWORD      // If vt is OLE_VT_UI1 this field contains a UChar value
34361>>>>>End_Type
34361>>>>>
34361>>>>>
34361>>>>>// VARIANT constants used with the vt field in an OLEVariant type
34361>>>>>
34361>>>>>
34361>>>>>
34361>>>>>// SetFocus/KillFocus event, sent in wParam of WM_DFOCXNOTIFYEVENT
34361>>>>>
34361>>>>>// Used to register the OCX event notification messages
34361>>>>>External_Function32 RegisterWindowMessage "RegisterWindowMessageA" USER32.DLL;                    String sWM_MSG;                    Returns Integer
34362>>>>>
34362>>>>>// External functions providing access to DFOLECLN.DLL
34362>>>>>// These functions are normally not accessed directly, they are
34362>>>>>// rather accessed through an Automation_Client/OCX_Client derived class/object
34362>>>>>
34362>>>>>//********DLL Interface OLE Auto General Functions************
34362>>>>>
34362>>>>>External_Function32 CreateAutomationClient "CreateAutomationClient" DFOLECLN.DLL;                    Returns DWORD
34363>>>>>
34363>>>>>
34363>>>>>External_Function32 DestroyAutomationClient "DestroyAutomationClient" DFOLECLN.DLL;                    Integer clientId;                    Returns DWORD
34364>>>>>
34364>>>>>External_Function32 CreateAutoClientDispatch "CreateAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    String progIdStr;                    Returns DWORD
34365>>>>>
34365>>>>>External_Function32 AttachAutoClientDispatch "AttachAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    LPDispatch disp;                    Integer addRef;                    Returns DWORD
34366>>>>>
34366>>>>>External_Function32 AttachAutoClientActiveObject "AttachAutoClientActiveObject" DFOLECLN.DLL;                    Integer clientId;                    String progIdStr;                    Returns DWORD
34367>>>>>
34367>>>>>External_Function32 ReleaseAutoClientDispatch "ReleaseAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    Returns DWORD
34368>>>>>
34368>>>>>External_Function32 GetAutoClientDispatch "GetAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    Returns LPDispatch
34369>>>>>
34369>>>>>//********DLL Interface OLE Auto Get Property Functions**************
34369>>>>>
34369>>>>>External_Function32 GetAutoClientBoolProperty "GetAutoClientBoolProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
34370>>>>>
34370>>>>>External_Function32 GetAutoClientCurrencyProperty "GetAutoClientCurrencyProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
34371>>>>>
34371>>>>>External_Function32 GetAutoClientDateProperty "GetAutoClientDateProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Date
34372>>>>>
34372>>>>>External_Function32 GetAutoClientLPDispatchProperty "GetAutoClientLPDispatchProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns LPDispatch
34373>>>>>
34373>>>>>External_Function32 GetAutoClientRealProperty "GetAutoClientRealProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
34374>>>>>
34374>>>>>External_Function32 GetAutoClientShortRealProperty "GetAutoClientShortRealProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Real
34375>>>>>
34375>>>>>External_Function32 GetAutoClientIntegerProperty "GetAutoClientIntegerProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
34376>>>>>
34376>>>>>External_Function32 GetAutoClientShortProperty "GetAutoClientShortProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Integer
34377>>>>>
34377>>>>>
34377>>>>>External_Function32 GetAutoClientStringProperty "GetAutoClientStringProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns DWORD
34378>>>>>
34378>>>>>External_Function32 GetAutoClientOLEVariantProperty "GetAutoClientOLEVariantProperty" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    LPOLEVar destVar;                    Returns  LPOLEVar
34379>>>>>
34379>>>>>
34379>>>>>//********DLL Interface OLE Auto Set Property Functions**************
34379>>>>>
34379>>>>>External_Function32 SetAutoClientBoolProperty "SetAutoClientBoolProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    DWORD    prop;                    Returns DWORD
34380>>>>>
34380>>>>>External_Function32 SetAutoClientCurrencyProperty "SetAutoClientCurrencyProperty" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    String prop;                    Returns  DWORD
34381>>>>>
34381>>>>>External_Function32 SetAutoClientDateProperty "SetAutoClientDateProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Date    prop;                    Returns DWORD
34382>>>>>
34382>>>>>External_Function32 SetAutoClientLPDispatchProperty "SetAutoClientLPDispatchProperty" DFOLECLN.DLL;                    Integer    clientId;                    DWORD    dwDispId;                    LPDispatch prop;                    Returns    DWORD
34383>>>>>
34383>>>>>External_Function32 SetAutoClientRealProperty "SetAutoClientRealProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    String   prop;                    Returns DWORD
34384>>>>>
34384>>>>>External_Function32 SetAutoClientShortRealProperty "SetAutoClientShortRealProperty" DFOLECLN.DLL;                    Integer   clientId;                    DWORD   dwDispId;                    String prop;                    Returns   DWORD
34385>>>>>
34385>>>>>External_Function32 SetAutoClientIntegerProperty "SetAutoClientIntegerProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    DWORD prop;                    Returns DWORD
34386>>>>>
34386>>>>>External_Function32 SetAutoClientShortProperty "SetAutoClientShortProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Integer   prop;                    Returns DWORD
34387>>>>>
34387>>>>>External_Function32 SetAutoClientStringProperty "SetAutoClientStringProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    String  prop;                    Returns DWORD
34388>>>>>
34388>>>>>External_Function32 SetAutoClientOLEVariantProperty "SetAutoClientOLEVariantProperty" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    String prop;                    Returns  DWORD
34389>>>>>
34389>>>>>
34389>>>>>//******DLL Interface OLE Auto Pre Invoke Functions**************
34389>>>>>
34389>>>>>External_Function32 DeclareAutoClientInvokeParams "DeclareAutoClientInvokeParams" DFOLECLN.DLL;                    Integer clientId;                    DWORD nrOfParams;                    Returns DWORD
34390>>>>>
34390>>>>>External_Function32 DefineAutoClientBoolParam "DefineAutoClientBoolParam" DFOLECLN.DLL;                    Integer clientId;                    DWORD    param;                    Returns DWORD
34391>>>>>
34391>>>>>External_Function32 DefineAutoClientCurrencyParam "DefineAutoClientCurrencyParam" DFOLECLN.DLL;                    Integer clientId;                    String  param;                    Returns DWORD
34392>>>>>
34392>>>>>External_Function32 DefineAutoClientDateParam "DefineAutoClientDateParam" DFOLECLN.DLL;                    Integer clientId;                    Date    param;                    Returns DWORD
34393>>>>>
34393>>>>>External_Function32 DefineAutoClientRealParam "DefineAutoClientRealParam" DFOLECLN.DLL;                    Integer clientId;                    String    param;                    Returns DWORD
34394>>>>>
34394>>>>>External_Function32 DefineAutoClientShortRealParam "DefineAutoClientShortRealParam" DFOLECLN.DLL;                    Integer   clientId;                    String param;                    Returns   DWORD
34395>>>>>
34395>>>>>External_Function32 DefineAutoClientIntegerParam "DefineAutoClientIntegerParam" DFOLECLN.DLL;                    Integer clientId;                    DWORD param;                    Returns DWORD
34396>>>>>
34396>>>>>External_Function32 DefineAutoClientShortParam "DefineAutoClientShortParam" DFOLECLN.DLL;                    Integer clientId;                    Integer   param;                    Returns DWORD
34397>>>>>
34397>>>>>External_Function32 DefineAutoClientLPDispatchParam "DefineAutoClientLPDispatchParam" DFOLECLN.DLL;                    Integer clientId;                    LPDispatch param;                    Returns DWORD
34398>>>>>
34398>>>>>External_Function32 DefineAutoClientStringParam "DefineAutoClientStringParam" DFOLECLN.DLL;                    Integer clientId;                    String  param;                    Returns DWORD
34399>>>>>
34399>>>>>External_Function32 DefineAutoClientOLEVariantParam "DefineAutoClientOLEVariantParam" DFOLECLN.DLL;                    Integer  clientId;                    OLEVariant param;                    Returns  DWORD
34400>>>>>
34400>>>>>//********DLL Interface OLE Auto Invoke Functions*********************
34400>>>>>
34400>>>>>External_Function32 InvokeAutoClientVoidFunction "InvokeAutoClientVoidFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
34401>>>>>
34401>>>>>External_Function32 InvokeAutoClientBoolFunction "InvokeAutoClientBoolFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
34402>>>>>
34402>>>>>External_Function32 InvokeAutoClientCurrencyFunction "InvokeAutoClientCurrencyFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
34403>>>>>
34403>>>>>External_Function32 InvokeAutoClientDateFunction "InvokeAutoClientDateFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Date
34404>>>>>
34404>>>>>External_Function32 InvokeAutoClientLPDispatchFunction "InvokeAutoClientLPDispatchFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns LPDispatch
34405>>>>>
34405>>>>>External_Function32 InvokeAutoClientRealFunction "InvokeAutoClientRealFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
34406>>>>>
34406>>>>>External_Function32 InvokeAutoClientShortRealFunction "InvokeAutoClientShortRealFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
34407>>>>>
34407>>>>>External_Function32 InvokeAutoClientIntegerFunction "InvokeAutoClientIntegerFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
34408>>>>>
34408>>>>>External_Function32 InvokeAutoClientShortFunction "InvokeAutoClientShortFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Integer
34409>>>>>
34409>>>>>External_Function32 InvokeAutoClientStringFunction "InvokeAutoClientStringFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer  destStr;                    Returns Integer
34410>>>>>
34410>>>>>
34410>>>>>External_Function32 InvokeAutoClientOLEVariantFunction "InvokeAutoClientOLEVariantFunction" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    LPOLEVar destVar;                    Returns  Integer
34411>>>>>
34411>>>>>//********DLL Interface OLE Control Functions*********************
34411>>>>>
34411>>>>>
34411>>>>>External_Function32 CreateOCXClient "CreateOCXClient" DFOLECLN.DLL;                    Returns Integer
34412>>>>>
34412>>>>>
34412>>>>>External_Function32 CreateOCXControl "CreateOCXControl" DFOLECLN.DLL;                    Integer iCId;                    Pointer pPar;                    String  sCId;                    String  sCap;                    Dword   wSty;                    String  sLic;                    String  sFile;                    Returns Integer
34413>>>>>
34413>>>>>External_Function32 DestroyOCXControl "DestroyOCXControl" DFOLECLN.DLL;                    Integer iClientId;                    Returns Integer
34414>>>>>
34414>>>>>External_Function32 GetOCXEventBoolParam "GetOCXEventBoolParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Integer
34415>>>>>
34415>>>>>External_Function32 GetOCXEventCurrencyParam "GetOCXEventCurrencyParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer destStr;                    Returns Integer
34416>>>>>
34416>>>>>External_Function32 GetOCXEventDateParam "GetOCXEventDateParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Date
34417>>>>>
34417>>>>>External_Function32 GetOCXEventRealParam "GetOCXEventRealParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer destStr;                    Returns Integer
34418>>>>>
34418>>>>>External_Function32 GetOCXEventShortRealParam "GetOCXEventShortRealParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer destStr;                    Returns Integer
34419>>>>>
34419>>>>>External_Function32 GetOCXEventIntegerParam "GetOCXEventIntegerParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Integer
34420>>>>>
34420>>>>>External_Function32 GetOCXEventShortParam "GetOCXEventShortParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Integer
34421>>>>>
34421>>>>>External_Function32 GetOCXEventStringParam "GetOCXEventStringParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer pDestStr;                    Returns Integer
34422>>>>>
34422>>>>>External_Function32 GetOCXEventOLEVariantParam "GetOCXEventOLEVariantParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    LPOLEVAR pDestVar;                    Returns Integer
34423>>>>>
34423>>>>>External_Function32 EnableOCXControl "EnableOCXControl" DFOLECLN.DLL;                    Integer iClientId;                    BOOL bEnable;                    Returns Integer
34424>>>>>
34424>>>>>External_Function32 GetOCXControlCaption "GetOCXControlCaption" DFOLECLN.DLL;                    Integer iClientId;                    Pointer lpDestStr;                    Returns Integer
34425>>>>>
34425>>>>>External_Function32 SetOCXControlCaption "SetOCXControlCaption" DFOLECLN.DLL;                    Integer iClientId;                    String  sCaption;                    Returns Integer
34426>>>>>
34426>>>>>External_Function32 LoadOlePicture "LoadOlePicture" DFOLECLN.DLL;                    String  sFilename;                    Returns LPDispatch
34427>>>>>
34427>>>>>External_Function32 ReleaseComPointer "ReleaseComPtr" DFOLECLN.DLL;                    LPIUnknown  comPtr;                    Returns Integer
34428>>>>>
34428>>>>>External_Function32 DFOleInit "DFOleInit" DFOLECLN.DLL;                    Returns Integer
34429>>>>>
34429>>>>>External_Function32 DFOleUninit "DFOleUninit" DFOLECLN.DLL;                    Returns Integer
34430>>>>>
34430>>>>>External_Function32 AlterOCXEventParam "AlterOCXEventParam" DFOLECLN.DLL;                    Pointer  pdispParams;                    Integer iparam;                    OLEVariant vNewValue;                    Returns  Integer
34431>>>>>
34431>>>>>
34431>>>>>
34431>>>>>// This command is only used internaly and should NOT be used by the developer
34431>>>>>
34431>>>USE DFEXTCLM
34431>>>USE EXTFRM
34431>>>USE DBEXTFRM
34431>>>
34431>>>//**********
34431>>>//*** Error messages***
34431>>>//**********
34431>>>
34431>>>    Enum_List
34431>>>        Define OLE_SV_LANG
34431>>>        Define OLE_US_LANG
34431>>>    End_Enum_List
34431>>>
34431>>>    Define OLE_CURR_LANG For OLE_US_LANG
34431>>>
34431>>>        //*** US
INCLUDING FILE: FLXOLEUS.INC
34431>>>>
34431>>>
34431>>>
34431>>>// This class encapsulates the behaviour of an OLEVariant, and simplifies
34431>>>// tasks involved working with the OLEVariant.
34431>>>Class cOLEVariant is an array
34432>>>    Procedure Construct_Object
34433>>>        Forward Send Construct_Object
34435>>>        Local Integer iRetVal
34436>>>        Move (DFOleInit()) to iRetVal
34437>>>        Send OCXInit
34438>>>    End_Procedure
34439>>>
34439>>>    Procedure Destroy_Object
34440>>>        Local Integer iRetVal
34441>>>        Move (DFOleUninit()) to iRetVal
34442>>>        Forward Send Destroy_Object
34444>>>    End_Procedure
34445>>>
34445>>>    Procedure OCXInit
34446>>>        Move (RegisterWindowMessage("WM_DFOCXEVENT")) to WM_DFOCXEVENT
34447>>>        Move (RegisterWindowMessage("WM_DFOCXNOTIFYEVENT")) to WM_DFOCXNOTIFYEVENT
34448>>>    End_Procedure
34449>>>
34449>>>    Function GetType  OLEVariant var Returns DWORD
34450>>>        Local DWORD varVt
34451>>>        GetBuff from var at Variant.vt to varVt
34452>>>        Function_Return varVt
34453>>>    End_Function
34454>>>
34454>>>    Function GetShort OLEVariant var Returns Integer
34455>>>        Local Integer iVal
34456>>>        GetBuff from var at Variant.iVal to iVal
34457>>>        Function_Return iVal
34458>>>    End_Function
34459>>>
34459>>>    Function GetInteger OLEVariant var Returns Integer
34460>>>        Local Integer lVal
34461>>>        GetBuff from var at Variant.lVal to lVal
34462>>>        Function_Return lVal
34463>>>    End_Function
34464>>>
34464>>>    Function GetFloat OLEVariant var Returns OLEReal
34465>>>        Local OLEReal fltVal
34466>>>        GetBuff_String from var at Variant.fltVal to fltVal
34467>>>        Function_Return fltVal
34468>>>    End_Function
34469>>>
34469>>>    Function GetDouble OLEVariant var Returns OLEReal
34470>>>        Local OLEReal dblVal
34471>>>        GetBuff_String from var at Variant.dblVal to dblVal
34472>>>        Function_Return dblVal
34473>>>    End_Function
34474>>>
34474>>>    Function GetCurrency OLEVariant var Returns Number
34475>>>        Local Number cyVal
34476>>>        GetBuff_String from var at Variant.cyVal to cyVal
34477>>>        Function_Return cyVal
34478>>>    End_Function
34479>>>
34479>>>    Function GetDate OLEVariant var Returns Date
34480>>>        Local Date dtVal
34481>>>        GetBuff from var at Variant.dtVal to dtVal
34482>>>        Function_Return dtVal
34483>>>    End_Function
34484>>>
34484>>>    Function GetString OLEVariant var Returns String
34485>>>        Local String strVal
34486>>>        GetBuff_String from var at Variant.strVal to strVal
34487>>>        Function_Return strVal
34488>>>    End_Function
34489>>>
34489>>>    Function GetLPDispatch OLEVariant var Returns LPDispatch
34490>>>        Local LPDispatch dspVal
34491>>>        GetBuff from var at Variant.dspVal to dspVal
34492>>>        Function_Return dspVal
34493>>>    End_Function
34494>>>
34494>>>    Function GetOLEError OLEVariant var Returns OLEError
34495>>>        Local OLEError errVal
34496>>>        GetBuff from var at Variant.errVal to errVal
34497>>>        Function_Return errVal
34498>>>    End_Function
34499>>>
34499>>>    Function GetBool OLEVariant var Returns Bool
34500>>>        Local Bool blVal
34501>>>        GetBuff from var at Variant.blVal to blVal
34502>>>        Function_Return blVal
34503>>>    End_Function
34504>>>
34504>>>    Function GetLPIUnknown OLEVariant var Returns LPIUnknown
34505>>>        Local LPIUnknown uknVal
34506>>>        GetBuff from var at Variant.uknVal to uknVal
34507>>>        Function_Return uknVal
34508>>>    End_Function
34509>>>
34509>>>    Function GetUChar OLEVariant var Returns UChar
34510>>>        Local UChar ui1Val
34511>>>        GetBuff from var at Variant.ui1Val to ui1Val
34512>>>        Function_Return ui1Val
34513>>>    End_Function
34514>>>
34514>>>    Function GetValue OLEVariant var Returns String
34515>>>        Local DWORD vt
34516>>>        Local String retVal
34516>>>        Get GetType var to vt
34517>>>             If vt Eq OLE_VT_I2        Get GetShort var to retVal
34520>>>        Else If vt Eq OLE_VT_I4        Get GetInteger var to retVal
34524>>>        Else If vt Eq OLE_VT_R4        Get GetFloat var to retVal
34528>>>        Else If vt Eq OLE_VT_R8        Get GetDouble var to retVal
34532>>>        Else If vt Eq OLE_VT_CY        Get GetCurrency var to retVal
34536>>>        Else If vt Eq OLE_VT_DATE      Get GetDate var to retVal
34540>>>        Else If vt Eq OLE_VT_BSTR      Get GetString var to retVal
34544>>>        Else If vt Eq OLE_VT_DISPATCH  Get GetLPDispatch var to retVal
34548>>>        Else If vt Eq OLE_VT_ERROR     Get GetOLEError var to retVal
34552>>>        Else If vt Eq OLE_VT_BOOL      Get GetBool var to retVal
34556>>>        Else If vt Eq OLE_VT_UNKNOWN   Get GetLPIUnknown var to retVal
34560>>>        Else If vt Eq OLE_VT_UI1       Get GetUChar var to retVal
34564>>>        Function_Return retVal
34565>>>    End_Function
34566>>>
34566>>>    Function PutValue DWORD vt String val Returns OLEVariant
34567>>>        Inst_OLEVariant var
34569>>>        Put vt to var at Variant.vt
34570>>>             If vt Eq OLE_VT_I2        Put (Integer(val)) to var at Variant.iVal
34573>>>        Else If vt Eq OLE_VT_I4        Put (Integer(val)) to var at Variant.lVal
34577>>>        Else If vt Eq OLE_VT_R4        Put_String val to var at Variant.fltVal
34581>>>        Else If vt Eq OLE_VT_R8        Put_String val to var at Variant.dblVal
34585>>>        Else If vt Eq OLE_VT_CY        Put_String val to var at Variant.cyVal
34589>>>        Else If vt Eq OLE_VT_DATE      Put (Date(val)) to var at Variant.dtVal
34593>>>        Else If vt Eq OLE_VT_BSTR      Put_String val to var at Variant.strVal
34597>>>        Else If vt Eq OLE_VT_DISPATCH  Put (LPDispatch(val)) to var at Variant.dspVal
34601>>>        Else If vt Eq OLE_VT_ERROR     Put (OLEError(val)) to var at Variant.errVal
34605>>>        Else If vt Eq OLE_VT_BOOL      Put (Bool(val)) to var at Variant.blVal
34609>>>        Else If vt Eq OLE_VT_UNKNOWN   Put (LPIUnknown(val)) to var at Variant.uknVal
34613>>>        Else If vt Eq OLE_VT_UI1       Put (UChar(val)) to var at Variant.ui1Val
34617>>>        Else begin
34618>>>            Put OLE_VT_ERROR to var at Variant.vt
34619>>>            Put DISP_E_PARAMNOTFOUND to var at Variant.errVal
34620>>>        End
34620>>>>
34620>>>        Function_Return var
34621>>>    End_Function
34622>>>
34622>>>End_Class
34623>>>
34623>>>// The one and only cOLEVariant helper object
34623>>>Object oOLEVariant is a cOLEVariant
34625>>>        Move Current_Object to oOLEVariantId
34626>>>End_Object
34627>>>
34627>>>//Command so we get nicer code for the events, only used internally
34627>>>
34627>>>// Command to extract the value of an OLEVariant no matter what datatype its currently holding
34627>>>
34627>>>// Command to both set the datatype and value to an OLEVariant
34627>>>
34627>>>
34627>>>// The OLE Base class, all OLE classes are derived from this class
34627>>>// Defines basic functionality and conversation with DLL interface
34627>>>
34627>>>Class cCOM_IDispatch is a Message
34628>>>
34628>>>    Procedure DefineCOM_IDispatch
34629>>>        Property String  progIdStr Public ""
34630>>>        Property Integer ClientId Public 0
34631>>>        Property Integer AutoAddRef Public 0
34632>>>    End_Procedure
34633>>>
34633>>>// GetProperty functions
34633>>>    Function GetIntegerProperty DWORD dwDispId returns Integer
34634>>>        Local Integer lpropVal iClientId
34635>>>        Get clientId to iClientId
34636>>>        Move (GetAutoClientIntegerProperty (iClientId,dwDispId)) to lpropVal
34637>>>        Function_Return lpropVal
34638>>>    End_Function
34639>>>
34639>>>    Function GetShortProperty DWORD dwDispId returns Integer
34640>>>        Local Integer lpropVal iClientId
34641>>>        Get clientId to iClientId
34642>>>        Move (GetAutoClientShortProperty (iClientId,dwDispId)) to lpropVal
34643>>>        Function_Return lpropVal
34644>>>    End_Function
34645>>>
34645>>>    Function GetBoolProperty DWORD dwDispId returns BOOL
34646>>>        Local BOOL lpropVal
34647>>>        Local Integer iClientId
34647>>>        Get clientId to iClientId
34648>>>        Move (GetAutoClientBoolProperty (iClientId,dwDispId)) to lpropVal
34649>>>        Function_Return lpropVal
34650>>>    End_Function
34651>>>
34651>>>    Function GetCurrencyProperty DWORD dwDispId returns Number
34652>>>        Local Number lpropVal
34653>>>        Local String lsProp
34653>>>        Local Integer iClientId iRetVal
34653>>>        Local Pointer llpsprop
34653>>>        Get clientId to iClientId
34654>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lsProp
34655>>>        GetAddress of lsprop to llpsprop
34656>>>        Move (GetAutoClientCurrencyProperty (iClientId,dwDispId,llpsprop)) to iRetVal
34657>>>        Move lsProp to lpropVal
34658>>>        Function_Return lpropVal
34659>>>    End_Function
34660>>>
34660>>>    Function GetDateProperty DWORD dwDispId returns Date
34661>>>        Local Date lpropVal
34662>>>        Local Integer iClientId
34662>>>        Get clientId to iClientId
34663>>>        Move (GetAutoClientDateProperty (iClientId,dwDispId)) to lpropVal
34664>>>        Function_Return lpropVal
34665>>>    End_Function
34666>>>
34666>>>    Function GetLPDispatchProperty DWORD dwDispId returns Date
34667>>>        Local LPDispatch lpropVal
34668>>>        Local Integer iClientId
34668>>>        Get clientId to iClientId
34669>>>        Move (GetAutoClientLPDispatchProperty (iClientId,dwDispId)) to lpropVal
34670>>>        Function_Return lpropVal
34671>>>    End_Function
34672>>>
34672>>>    Function GetRealProperty DWORD dwDispId returns OLEReal
34673>>>        Local OLEReal lpropVal
34674>>>        Local Integer iClientId iRetVal
34674>>>        Local String lsProp
34674>>>        Local Pointer llpsprop
34674>>>        Get clientId to iClientId
34675>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lsProp
34676>>>        GetAddress of lsprop to llpsprop
34677>>>        Move (GetAutoClientRealProperty (iClientId,dwDispId,llpsprop)) to iRetVal
34678>>>        Move lsProp to lpropVal
34679>>>        Function_Return lpropVal
34680>>>    End_Function
34681>>>
34681>>>    Function GetShortRealProperty DWORD dwDispId returns OLEReal
34682>>>        Local OLEReal lpropVal
34683>>>        Local Integer iClientId iRetVal
34683>>>        Local String lsProp
34683>>>        Local Pointer llpsprop
34683>>>        Get clientId to iClientId
34684>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lsProp
34685>>>        GetAddress of lsprop to llpsprop
34686>>>        Move (GetAutoClientShortRealProperty (iClientId,dwDispId,llpsprop)) to iRetVal
34687>>>        Move lsProp to lpropVal
34688>>>        Function_Return lpropVal
34689>>>    End_Function
34690>>>
34690>>>    Function GetStringProperty DWORD dwDispId returns String
34691>>>        Local String lpropVal
34692>>>        Local Integer iClientId iRetVal
34692>>>        Local Pointer llppropVal
34692>>>        Get clientId to iClientId
34693>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lpropVal
34694>>>        GetAddress of lpropVal to llppropval
34695>>>        Move (GetAutoClientStringProperty (iClientId,dwDispId,llppropVal)) to iRetVal
34696>>>        Function_Return (CString(lpropVal))
34697>>>    End_Function
34698>>>
34698>>>    Function GetOLEVariantProperty DWORD dwDispId returns OLEVariant
34699>>>        Local OLEVariant lpropVal
34700>>>        Local Integer iClientId iRetVal
34700>>>        Local Pointer llppropVal
34700>>>        Get clientId to iClientId
34701>>>        ZeroType TP_OLEVariant to lpropVal
34702>>>        GetAddress of lpropVal to llppropval
34703>>>        Move (GetAutoClientOLEVariantProperty (iClientId,dwDispId,llppropVal)) to iRetVal
34704>>>        Function_Return lpropVal
34705>>>    End_Function
34706>>>
34706>>>// SetProperty procedures
34706>>>    Procedure SetIntegerProperty DWORD dwDispId Integer lpropVal
34707>>>        Local Integer iClientId iRetVal
34708>>>        Get ClientId to iClientId
34709>>>        Move (SetAutoClientIntegerProperty (iClientId,dwDispId,lpropVal)) to iRetVal
34710>>>    End_Procedure
34711>>>
34711>>>    Procedure SetShortProperty DWORD dwDispId Integer lpropVal
34712>>>        Local Integer iClientId iRetVal
34713>>>        Get ClientId to iClientId
34714>>>        Move (SetAutoClientShortProperty (iClientId,dwDispId,lpropVal)) to iRetVal
34715>>>    End_Procedure
34716>>>
34716>>>    Procedure SetBoolProperty DWORD dwDispId BOOL lpropVal
34717>>>        Local Integer iClientId iRetVal
34718>>>        Get ClientId to iClientId
34719>>>        Move (SetAutoClientShortProperty (iClientId,dwDispId,lpropVal)) to iRetVal
34720>>>    End_Procedure
34721>>>
34721>>>    Procedure SetCurrencyProperty DWORD dwDispId Number lpropVal
34722>>>        Local Integer iClientId iRetVal
34723>>>        Local String lsprop
34723>>>        Get ClientId to iClientId
34724>>>        Move lpropVal to lsprop
34725>>>        Move (SetAutoClientCurrencyProperty(iClientId,dwDispId,lsprop)) to iRetVal
34726>>>    End_Procedure
34727>>>
34727>>>    Procedure SetDateProperty DWORD dwDispId Date lpropVal
34728>>>        Local Integer iClientId iRetVal
34729>>>        Get ClientId to iClientId
34730>>>        Move (SetAutoClientDateProperty(iClientId,dwDispId,lpropVal)) to iRetVal
34731>>>    End_Procedure
34732>>>
34732>>>    Procedure SetLPDispatchProperty DWORD dwDispId LPDispatch lpropVal
34733>>>        Local Integer iClientId iRetVal
34734>>>        Get ClientId to iClientId
34735>>>        Move (SetAutoClientLPDispatchProperty(iClientId,dwDispId,lpropVal)) to iRetVal
34736>>>    End_Procedure
34737>>>
34737>>>    Procedure SetRealProperty DWORD dwDispId OLEReal lpropVal
34738>>>        Local Integer iClientId iRetVal
34739>>>        Local String lsprop
34739>>>        Get ClientId to iClientId
34740>>>        Move lpropVal to lsprop
34741>>>        Move (SetAutoClientRealProperty(iClientId,dwDispId,lsprop)) to iRetVal
34742>>>    End_Procedure
34743>>>
34743>>>    Procedure SetShortRealProperty DWORD dwDispId OLEReal lpropVal
34744>>>        Local Integer iClientId iRetVal
34745>>>        Local String lsprop
34745>>>        Get ClientId to iClientId
34746>>>        Move lpropVal to lsprop
34747>>>        Move (SetAutoClientShortRealProperty(iClientId,dwDispId,lsprop)) to iRetVal
34748>>>    End_Procedure
34749>>>
34749>>>    Procedure SetStringProperty DWORD dwDispId String lpropVal
34750>>>        Local Integer iClientId iRetVal
34751>>>        Get ClientId to iClientId
34752>>>        Move (SetAutoClientStringProperty(iClientId,dwDispId,lpropVal)) to iRetVal
34753>>>    End_Procedure
34754>>>
34754>>>    Procedure SetOLEVariantProperty DWORD dwDispId OLEVariant lpropVal
34755>>>        Local Integer iClientId iRetVal
34756>>>        Get ClientId to iClientId
34757>>>        If (Length(lpropval)) Lt TP_OLEVariant_Size;            Get PutValue of oOLEVariantId OLE_VT_ERROR DISP_E_PARAMNOTFOUND to lpropVal
34760>>>        Move (SetAutoClientOLEVariantProperty(iClientId,dwDispId,lpropVal)) to iRetVal
34761>>>    End_Procedure
34762>>>
34762>>>// Pre-Invoke functions
34762>>>    Procedure DeclareParams Integer nrOfParams
34763>>>        Local Integer iClientId iRetVal
34764>>>        Get ClientId to iCLientId
34765>>>        Move (DeclareAutoClientInvokeParams(iClientId,nrOfParams)) to iRetVal
34766>>>    End_Procedure
34767>>>
34767>>>    Procedure DefineIntegerParam Integer param
34768>>>        Local Integer iClientId iRetVal
34769>>>        Get ClientId to iClientId
34770>>>        Move (DefineAutoClientIntegerParam(iClientId,param)) to iRetVal
34771>>>    End_Procedure
34772>>>
34772>>>    Procedure DefineShortParam Integer param
34773>>>        Local Integer iClientId iRetVal
34774>>>        Get ClientId to iClientId
34775>>>        Move (DefineAutoClientShortParam(iClientId,param)) to iRetVal
34776>>>    End_Procedure
34777>>>
34777>>>    Procedure DefineBoolParam BOOL param
34778>>>        Local Integer iClientId iRetVal
34779>>>        Get ClientId to iClientId
34780>>>        Move (DefineAutoClientBoolParam(iClientId,param)) to iRetVal
34781>>>    End_Procedure
34782>>>
34782>>>    Procedure DefineCurrencyParam Number param
34783>>>        Local Integer iClientId iRetVal
34784>>>        Local String lsparam
34784>>>        Get ClientId to iClientId
34785>>>        Move param to lsparam
34786>>>        Move (DefineAutoClientCurrencyParam(iClientId,lsparam)) to iRetVal
34787>>>    End_Procedure
34788>>>
34788>>>    Procedure DefineDateParam Date param
34789>>>        Local Integer iClientId iRetVal
34790>>>        Get ClientId to iClientId
34791>>>        Move (DefineAutoClientDateParam(iClientId,param)) to iRetVal
34792>>>    End_Procedure
34793>>>
34793>>>    Procedure DefineLPDispatchParam LPDispatch param
34794>>>        Local Integer iClientId iRetVal
34795>>>        Get ClientId to iClientId
34796>>>        Move (DefineAutoClientLPDispatchParam(iClientId,param)) to iRetVal
34797>>>    End_Procedure
34798>>>
34798>>>    Procedure DefineRealParam OLEReal param
34799>>>        Local Integer iClientId iRetVal
34800>>>        Local String lsparam
34800>>>        Get ClientId to iClientId
34801>>>        Move param to lsparam
34802>>>        Move (DefineAutoClientRealParam(iClientId,lsparam)) to iRetVal
34803>>>    End_Procedure
34804>>>
34804>>>    Procedure DefineShortRealParam OLEReal param
34805>>>        Local Integer iClientId iRetVal
34806>>>        Local String lsparam
34806>>>        Get ClientId to iClientId
34807>>>        Move param to lsparam
34808>>>        Move (DefineAutoClientShortRealParam(iClientId,lsparam)) to iRetVal
34809>>>    End_Procedure
34810>>>
34810>>>    Procedure DefineStringParam String param
34811>>>        Local Integer iClientId iRetVal
34812>>>        Get ClientId to iClientId
34813>>>        Append param OLENull
34814>>>        Move (DefineAutoClientStringParam(iClientId,param)) to iRetVal
34815>>>    End_Procedure
34816>>>
34816>>>    Procedure DefineOLEVariantParam OLEVariant param
34817>>>        Local Integer iClientId iRetVal
34818>>>        Get ClientId to iClientId
34819>>>        If (Length(param)) Lt TP_OLEVariant_Size ;            Get PutValue of oOLEVariantId OLE_VT_ERROR DISP_E_PARAMNOTFOUND to param
34822>>>        Move (DefineAutoClientOLEVariantParam(iClientId,param)) to iRetVal
34823>>>    End_Procedure
34824>>>
34824>>>// Invoke functions
34824>>>    Procedure InvokeVoidFunction DWORD dwDispId
34825>>>        Local Integer iClientId iRetVal
34826>>>        Get ClientId to iClientId
34827>>>        Move (InvokeAutoClientVoidFunction(iClientId,dwDispId)) to iRetVal
34828>>>    End_Procedure
34829>>>
34829>>>    Function InvokeIntegerFunction DWORD dwDispId returns Integer
34830>>>        Local Integer iClientId iRetVal
34831>>>        Get ClientId to iClientId
34832>>>        Move (InvokeAutoClientIntegerFunction(iClientId,dwDispId)) to iRetVal
34833>>>        Function_Return iRetVal
34834>>>    End_Function
34835>>>
34835>>>    Function InvokeShortFunction DWORD dwDispId returns Integer
34836>>>        Local Integer iClientId iRetVal
34837>>>        Get ClientId to iClientId
34838>>>        Move (InvokeAutoClientShortFunction(iClientId,dwDispId)) to iRetVal
34839>>>        Function_Return iRetVal
34840>>>    End_Function
34841>>>
34841>>>    Function InvokeBoolFunction DWORD dwDispId returns BOOL
34842>>>        Local Integer iClientId iRetVal
34843>>>        Get ClientId to iClientId
34844>>>        Move (InvokeAutoClientBoolFunction(iClientId,dwDispId)) to iRetVal
34845>>>        Function_Return iRetVal
34846>>>    End_Function
34847>>>
34847>>>    Function InvokeCurrencyFunction DWORD dwDispId returns Number
34848>>>        Local Integer iClientId iRetVal
34849>>>        Local Number nRetVal
34849>>>        Local String sRetVal
34849>>>        Local Pointer psRetVal
34849>>>        Get ClientId to iClientId
34850>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
34851>>>        GetAddress of sRetVal to psRetVal
34852>>>        Move (InvokeAutoClientCurrencyFunction(iClientId,dwDispId,psRetVal)) to iRetVal
34853>>>        Move sRetVal to nRetVal
34854>>>        Function_Return nRetVal
34855>>>    End_Function
34856>>>
34856>>>    Function InvokeDateFunction DWORD dwDispId returns Date
34857>>>        Local Integer iClientId
34858>>>        Local Date dRetVal
34858>>>        Get ClientId to iClientId
34859>>>        Move (InvokeAutoClientDateFunction(iClientId,dwDispId)) to dRetVal
34860>>>        Function_Return dRetVal
34861>>>    End_Function
34862>>>
34862>>>    Function InvokeLPDispatchFunction DWORD dwDispId returns LPDispatch
34863>>>        Local Integer iClientId
34864>>>        Local LPDispatch lpdRetVal
34864>>>        Get ClientId to iClientId
34865>>>        Move (InvokeAutoClientLPDispatchFunction(iClientId,dwDispId)) to lpdRetVal
34866>>>        Function_Return lpdRetVal
34867>>>    End_Function
34868>>>
34868>>>    Function InvokeRealFunction DWORD dwDispId returns OLEReal
34869>>>        Local Integer iClientId iRetVal
34870>>>        Local OLEReal rRetVal
34870>>>        Local String sRetVal
34870>>>        Local Pointer psRetVal
34870>>>        Get ClientId to iClientId
34871>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
34872>>>        GetAddress of sRetVal to psRetVal
34873>>>        Move (InvokeAutoClientRealFunction(iClientId,dwDispId,psRetVal)) to iRetVal
34874>>>        Move sRetVal to rRetVal
34875>>>        Function_Return rRetVal
34876>>>    End_Function
34877>>>
34877>>>    Function InvokeShortRealFunction DWORD dwDispId returns OLEReal
34878>>>        Local Integer iClientId iRetVal
34879>>>        Local OLEReal rRetVal
34879>>>        Local String sRetVal
34879>>>        Local Pointer psRetVal
34879>>>        Get ClientId to iClientId
34880>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
34881>>>        GetAddress of sRetVal to psRetVal
34882>>>        Move (InvokeAutoClientShortRealFunction(iClientId,dwDispId,psRetVal)) to iRetVal
34883>>>        Move sRetVal to rRetVal
34884>>>        Function_Return rRetVal
34885>>>    End_Function
34886>>>
34886>>>    Function InvokeStringFunction DWORD dwDispId returns String
34887>>>        Local Integer iClientId iRetVal
34888>>>        Local String sRetVal
34888>>>        Local Pointer psRetVal
34888>>>        Get ClientId to iClientId
34889>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
34890>>>        GetAddress of sRetVal to psRetVal
34891>>>        Move (InvokeAutoClientStringFunction(iClientId,dwDispId,psRetVal)) to iRetVal
34892>>>        Function_Return (CString(sRetVal))
34893>>>    End_Function
34894>>>
34894>>>    Function InvokeOleVariantFunction DWORD dwDispId returns OLEVariant
34895>>>        Local Integer iClientId iRetVal
34896>>>        Local OLEVariant vRetVal
34896>>>        Local Pointer pvRetVal
34896>>>        Get ClientId to iClientId
34897>>>        ZeroType TP_OLEVariant to vRetVal
34898>>>        GetAddress of vRetVal to pvRetVal
34899>>>        Move (InvokeAutoClientOLEVariantFunction(iClientId,dwDispId,pvRetVal)) to iRetVal
34900>>>        Function_Return vRetVal
34901>>>    End_Function
34902>>>
34902>>>
34902>>>// Event parameter functions, might be moved to cOCX_Client_Mixin or similar
34902>>>    Function GetEventIntegerParam DWORD lParam DWORD iPara returns Integer
34903>>>        Local Integer iRetVal
34904>>>        Move (GetOCXEventIntegerParam(lParam,iPara)) to iRetVal
34905>>>        Function_Return iRetVal
34906>>>    End_Function
34907>>>
34907>>>    Function GetEventShortParam DWORD lParam DWORD iPara returns Integer
34908>>>        Local Integer iRetVal
34909>>>        Move (GetOCXEventShortParam(lParam,iPara)) to iRetVal
34910>>>        Function_Return iRetVal
34911>>>    End_Function
34912>>>
34912>>>    Function GetEventBoolParam DWORD lParam DWORD iPara returns Bool
34913>>>        Local Bool iRetVal
34914>>>        Move (GetOCXEventBoolParam(lParam,iPara)) to iRetVal
34915>>>        Function_Return iRetVal
34916>>>    End_Function
34917>>>
34917>>>    Function GetEventCurrencyParam DWORD lParam DWORD iPara returns Currency
34918>>>        Local Integer iretVal
34919>>>        Local Currency cRetVal
34919>>>        Local String destStr
34919>>>        Local Pointer pdestStr
34919>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
34920>>>        GetAddress of destStr to pdestStr
34921>>>        Move (GetOCXEventCurrencyParam(lParam,iPara,pdestStr)) to iRetVal
34922>>>        Move (CString(destStr)) to cRetVal
34923>>>        Function_Return cRetVal
34924>>>    End_Function
34925>>>
34925>>>    Function GetEventDateParam DWORD lParam DWORD iPara returns Date
34926>>>        Local Date dRetVal
34927>>>        Move (GetOCXEventDateParam(lParam,iPara)) to dRetVal
34928>>>        Function_Return dRetVal
34929>>>    End_Function
34930>>>
34930>>>    Function GetEventLPDispatchParam DWORD lParam DWORD iPara returns LPDispatch
34931>>>        Local LPDispatch lpRetVal
34932>>>        Get GetEventIntegerParam lParam iPara to lpRetVal
34933>>>        Function_Return lpRetVal
34934>>>    End_Function
34935>>>
34935>>>    Function GetEventRealParam DWORD lParam DWORD iPara returns OLEReal
34936>>>        Local Integer iretVal
34937>>>        Local OLEReal rRetVal
34937>>>        Local String destStr
34937>>>        Local Pointer pdestStr
34937>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
34938>>>        GetAddress of destStr to pdestStr
34939>>>        Move (GetOCXEventRealParam(lParam,iPara,pdestStr)) to iRetVal
34940>>>        Move (CString(destStr)) to rRetVal
34941>>>        Function_Return rRetVal
34942>>>    End_Function
34943>>>
34943>>>    Function GetEventShortRealParam DWORD lParam DWORD iPara returns ShortReal
34944>>>        Local Integer iretVal
34945>>>        Local ShortReal rRetVal
34945>>>        Local String destStr
34945>>>        Local Pointer pdestStr
34945>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
34946>>>        GetAddress of destStr to pdestStr
34947>>>        Move (GetOCXEventShortRealParam(lParam,iPara,pdestStr)) to iRetVal
34948>>>        Move (CString(destStr)) to rRetVal
34949>>>        Function_Return rRetVal
34950>>>    End_Function
34951>>>
34951>>>    Function GetEventStringParam DWORD lParam DWORD iPara returns String
34952>>>        Local Integer iretVal
34953>>>        Local String sRetVal
34953>>>        Local Pointer psRetVal
34953>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
34954>>>        GetAddress of sRetVal to psRetVal
34955>>>        Move (GetOCXEventStringParam(lParam,iPara,psRetVal)) to iRetVal
34956>>>        Function_Return (CString(sRetVal))
34957>>>    End_Function
34958>>>
34958>>>    Function GetEventOLEVariantParam DWORD lParam DWORD iPara returns OLEVariant
34959>>>        Local Integer iretVal
34960>>>        Inst_OLEVariant vRetVal
34961>>>        Local Pointer pvRetVal
34961>>>        GetAddress of vRetVal to pvRetVal
34962>>>        Move (GetOCXEventOLEVariantParam(lParam,iPara,pvRetVal)) to iRetVal
34963>>>        Function_Return vRetVal
34964>>>    End_Function
34965>>>
34965>>>End_Class
34966>>>
34966>>>
34966>>>// The OLE Automation base class,
34966>>>// which all automation classes are derived from
34966>>>
34966>>>Class Automation_Client is a cCOM_IDispatch
34967>>>    Procedure Construct_Object
34968>>>        Forward Send Construct_Object
34970>>>        Send DefineCOM_IDispatch
34971>>>        Local Integer iClientId
34972>>>        Move (CreateAutomationClient()) To iClientId
34973>>>        If iClientId Eq 0 Begin
34975>>>            Set ClientId to 0
34976>>>            Error 1002 DFOLEError1002
34977>>>>
34977>>>        End
34977>>>>
34977>>>        Else Set ClientId To iClientId
34979>>>        End_Procedure
34980>>>
34980>>>    Procedure Destroy_Object
34981>>>        Local Integer iRetVal iClientId
34982>>>        Get ClientId to iClientId
34983>>>        Move (DestroyAutomationClient(iClientId)) to iRetVal
34984>>>        Forward Send Destroy_Object
34986>>>    End_Procedure
34987>>>
34987>>>    Procedure CreateDispatch
34988>>>                Local Integer iRetVal
34989>>>                Local Integer iClientId
34989>>>        Local String sCLSID
34989>>>        Get progIdStr to sCLSID
34990>>>        Append sCLSID OLENull
34991>>>
34991>>>                Get clientId to iClientId
34992>>>        Move (CreateAutoClientDispatch (iClientId,sCLSID)) To iRetVal
34993>>>                If iRetVal Eq 0 Begin
34995>>>            Error 1000 DFOLEError1000
34996>>>>
34996>>>                End
34996>>>>
34996>>>        End_Procedure
34997>>>
34997>>>        Procedure AttachDispatch LPDispatch pdisp
34998>>>                Local Integer iRetVal
34999>>>                Local Integer iClientId
34999>>>                Local Integer bAutoAddRef
34999>>>                Get clientId to iClientId
35000>>>                Get AutoAddRef to bAutoAddRef
35001>>>                Move (AttachAutoClientDispatch (iClientId,pdisp,bAutoAddRef)) To iRetVal
35002>>>                If iRetVal Eq 0 Begin
35004>>>                Error 1001 DFOLEError1001
35005>>>>
35005>>>                End
35005>>>>
35005>>>    End_Procedure
35006>>>
35006>>>    Function AttachActiveObject Returns Bool
35007>>>                Local Bool bRetVal
35008>>>                Local Integer iClientId
35008>>>                Local String sCLSID
35008>>>                Get progIdStr to sCLSID
35009>>>                Append sCLSID OLENull
35010>>>                Get clientId to iClientId
35011>>>                Move (AttachAutoClientActiveObject (iClientId,sCLSID)) To bRetVal
35012>>>                Function_Return bRetVal
35013>>>    End_Function
35014>>>
35014>>>    Procedure ReleaseDispatch
35015>>>        Local Integer iRetVal
35016>>>        Local Integer iClientId
35016>>>        Get clientId to iClientId
35017>>>        Move (ReleaseAutoClientDispatch (iClientId)) to iRetVal
35018>>>    End_Procedure
35019>>>
35019>>>    Function GetDispatch returns LPDispatch
35020>>>        Local LPDispatch retVal
35021>>>        Local Integer iClientId
35021>>>        Get clientId to iClientId
35022>>>        Move (GetAutoClientDispatch(iClientId)) to retVal
35023>>>        Function_Return retVal
35024>>>    End_Function
35025>>>
35025>>>End_Class
35026>>>
35026>>>
35026>>>//     cCom_IDispatch  External_Class_Mixin
35026>>>//                 |       |    
35026>>>//                 |       cOCXNavigation_Mixin
35026>>>//                 |         |    
35026>>>//               cOCX_Client_Mixin
35026>>>//                        |    |
35026>>>//                        |    |
35026>>>// Form_External_Control  |    |   dbForm_External_Control
35026>>>//                 |      |    |        |  
35026>>>//                OCX_Client   dbOCX_Client
35026>>>
35026>>>
35026>>>
35026>>>// The focus navigation mixin class for ActiveX controls
35026>>>Class cOCX_Navigation_Class_Mixin is a Mixin 
35027>>>    Import_Class_Protocol External_Class_Mixin
35028>>>    Register_Procedure WMDF_DFOCXNotifyEvent
35028>>>
35028>>>    Procedure WMDF_DFOCXNotifyEvent Integer wParam Integer lParam
35029>>>        ON_EVENT WM_DFOCX_FOCUSCHANGE Fire OCXFocusChange
35032>>>    End_Procedure
35033>>>
35033>>>    Procedure OCXFocusChange Integer lParam
35034>>>        If (lParam);            Send External_SetFocus
35037>>>        Else;            Send External_KillFocus
35039>>>    End_Procedure
35040>>>
35040>>>    //Provided just to cancel the External_Class_Mixin implementation
35040>>>    //It actually gets cancelled in the cOCX_Clint_Mixin, but hey!?
35040>>>    Procedure Page_Object Integer state
35041>>>        Forward Send Page_Object state        
35043>>>    End_Procedure
35044>>>
35044>>>    Procedure Enable_Window integer iState
35045>>>      // Here we switch iState again, for backwards compatibility
35045>>>      Set OcxShadow_State to (Not(iState))
35046>>>    End_procedure
35047>>>
35047>>>End_Class
35048>>>
35048>>>
35048>>>//The standard OCX class mixin, it is the 
35048>>>// OCX base class which all OLE Controls are derived from (read mixin'd)
35048>>>Class cOCX_Client_Mixin is a Mixin
35049>>>
35049>>>    Import_Class_Protocol cCOM_IDispatch
35050>>>    Import_Class_Protocol cOCX_Navigation_Class_Mixin
35051>>>    Register_Procedure WMDF_DFOCXEVENT Integer wParam Integer lParam
35051>>>
35051>>>    Procedure DefineOCX_Client
35052>>>        Send DefineCOM_IDispatch
35053>>>        Local Integer iClientId
35054>>>        Property integer Private.OCXShadowState Public 0
35055>>>        Property String  Private.OCXCaption Public ""
35056>>>        Property String  OCXLicense Public ""
35057>>>        Property String  OCXPropFile Public ""
35058>>>        Move (CreateOCXClient()) to iclientId
35059>>>                Set ClientId to iClientId
35060>>>        Send Use_Parent_Color
35061>>>    End_Procedure
35062>>>
35062>>>    Function OCXShadow_State Returns Integer
35063>>>        Local Integer bEnabled
35064>>>        Get Private.OCXShadowState to bEnabled
35065>>>        Function_Return bEnabled
35066>>>    End_Function
35067>>>
35067>>>    Procedure Set OCXShadow_State Integer bEnable
35068>>>        Local integer hWnd iSuccess iCLientId
35069>>>        Set Private.OCXShadowState to bEnable
35070>>>        Get clientId to iClientId
35071>>>        If bEnable;            Move (false) to bEnable
35074>>>        else;            Move (true) to bEnable
35076>>>        Get Window_Handle to hWnd
35077>>>        If hWnd;            Move (EnableOCXControl(iClientId,bEnable)) To iSuccess
35080>>>    End_Procedure
35081>>>
35081>>>    Procedure SetOCXCaption String sCaption
35082>>>        Local Integer iClientId iRetVal
35083>>>        Get ClientId to iClientId
35084>>>        Append sCaption OLENull
35085>>>        Move (SetOCXControlCaption(iClientId,sCaption)) to iRetVal
35086>>>        If (Not(iRetVal));            Error 1004 DFOLEError1004
35089>>>        Else;            Set Private.OCXCaption to sCaption
35091>>>    End_Procedure
35092>>>
35092>>>    Function GetOCXCaption Returns String
35093>>>        Local Integer iClientId iRetVal
35094>>>        Local String destStr
35094>>>        Local Pointer lpDestStr
35094>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
35095>>>        GetAddress of destStr to lpDestStr
35096>>>        Move (GetOCXControlCaption(iClientId,lpDestStr)) to iRetVal
35097>>>        If (not(iRetVal));            Error 1004 DFOLEError1004
35100>>>        Set Private.OCXCaption to (CString(destStr))
35101>>>        Function_Return (Private.OCXCaption(Current_Object))
35102>>>    End_Function
35103>>>
35103>>>    Procedure SET OCXCaption String sCaption
35104>>>        If (Window_Handle(Current_Object));            Send SetOCXCaption sCaption
35107>>>        Else;            Set Private.OCXCaption to sCaption
35109>>>    End_Procedure
35110>>>
35110>>>    Function OCXCaption Returns String
35111>>>        If (Window_Handle(Current_Object));            Function_Return (GetOCXCaption(Current_Object))
35114>>>        Else;            Function_Return (Private.OCXCaption(Current_Object))
35116>>>    End_Procedure
35117>>>
35117>>>    // To avoid flickering during resize operations
35117>>>    Procedure Use_Parent_Color
35118>>>        Local Integer Clr Txtclr Backclr
35119>>>        Delegate Get Object_Color To Clr
35121>>>        Move (Hi(Clr)) To Txtclr
35122>>>        Move (Low(Clr)) To Backclr
35123>>>        Set Object_Color To Txtclr Backclr
35124>>>    End_Procedure
35125>>>
35125>>>    Procedure Page_Object integer iState
35126>>>        Forward Send Page_Object iState
35128>>>        If iState Eq (True) Send LoadOCX
35131>>>    End_Procedure
35132>>>
35132>>>    Procedure Remove_Object
35133>>>        Send UnloadOCX
35134>>>        Forward send Remove_Object
35136>>>    End_Procedure
35137>>>
35137>>>    Procedure LoadOCX
35138>>>        Local Pointer HWnd
35139>>>        Local Integer iCLientId iRetVal iVisible iShadow dwSty
35139>>>        Local String sPrgId lic sCap sPropFile
35139>>>        Send PreCreateOCX
35140>>>        Get ClientId to iClientId
35141>>>        Get Window_Handle to hwnd
35142>>>        Get progIdStr to sPrgId
35143>>>        Append sPrgId OLENull
35144>>>        Get Private.OCXCaption To sCap
35145>>>        Append sCap OLENull
35146>>>        Get OCXLicense To Lic
35147>>>        Append Lic OLENull
35148>>>        Get OCXPropFile To sPropFile
35149>>>        Append sPropfile OLENull
35150>>>        Get Visible_State to iVisible
35151>>>        If (iVisible) Move WS_VISIBLE to dwSty
35154>>>        Else Move 0 to dwSty
35156>>>        Get Private.OCXShadowState to iShadow
35157>>>        If (iShadow) Move (dwSty ior WS_DISABLED) to dwSty
35160>>>        Move (dwSty ior WS_TABSTOP) to dwSty
35161>>>        Move (CreateOCXControl(iClientId,HWnd,sPrgId,sCap,dwSty,lic,sPropFile)) to iRetVal
35162>>>        Send PostCreateOCX
35163>>>    End_Procedure
35164>>>
35164>>>    Procedure UnloadOCX
35165>>>        Local Integer iRetVal
35166>>>                Local Integer iClientId
35166>>>                Get ClientId to iClientId
35167>>>                Move (DestroyOCXControl(iClientId)) to iRetVal
35168>>>    End_Procedure
35169>>>
35169>>>    //This procedure is triggered before the OCX control is created
35169>>>    Procedure PreCreateOCX
35170>>>    End_Procedure
35171>>>
35171>>>    //This procedure is triggered after the OCX control is created but
35171>>>    //before it's shown
35171>>>    Procedure PostCreateOCX
35172>>>    End_Procedure
35173>>>End_Class
35174>>>
35174>>>// The non data aware OCX class
35174>>>// Derive from this class if you DON'T want your ActiveX control to be data aware
35174>>>Class OCX_Client is a FormExternalControl
35175>>>    Import_Class_Protocol cOCX_Client_Mixin
35176>>>
35176>>>    //These allows us to use the VDF standard 'Value' to get and set the
35176>>>    // caption of the ActiveX control (e.g. Get/Set Value to someVariable)
35176>>>
35176>>>    Procedure Set ControlValue string sVal
35177>>>        Set OCXCaption to sVal
35178>>>    End_Procedure
35179>>>
35179>>>    Function Value Integer item_number Returns String
35180>>>        Function_Return (OCXCaption(Current_Object))
35181>>>    End_Function
35182>>>
35182>>>End_Class
35183>>>
35183>>>
35183>>>// The Data aware OCX class
35183>>>// Derive from this class if you want your ActiveX control to be data aware
35183>>>Class dbOCX_Client is a dbFormExternalControl
35184>>>    Import_Class_Protocol cOCX_Client_Mixin
35185>>>
35185>>>    Procedure DefinedbOCX_Client
35186>>>        Send DefineOCX_Client
35187>>>        Property String  Private.OCXdbValue public ""
35188>>>    End_Procedure
35189>>>
35189>>>    Procedure Set ControlValue string sVal
35190>>>        If (Window_Handle(Current_Object));            Send OnRefreshDbOcxValue sVal
35193>>>    End_Procedure
35194>>>
35194>>>    Function ControlValue Returns String
35195>>>        Function_Return (Private.OCXDbValue(Current_Object))
35196>>>    End_Function
35197>>>
35197>>>    //Triggered when the database value has changed,
35197>>>    // and the ActiveX control needs to be updated
35197>>>    //Override and perform necessary updating to the OCX
35197>>>    Procedure OnRefreshDbOcxValue String sVal
35198>>>    End_Procedure
35199>>>
35199>>>    //Should be called when the ActiveX control's value has changed,
35199>>>    // and the database value needs to be updated
35199>>>    Procedure UpdateDbOcxValue String sVal
35200>>>        Set Private.OCXdbValue to sVal
35201>>>        Send ControlValueChanged
35202>>>    End_Procedure
35203>>>
35203>>>End_Class
35204>>>
35204>>>
35204>>>// Command for common declarations of ActiveX control classes, only used internally
35204>>>
35204>>>
35204>>>Use FontDisp
INCLUDING FILE: FONTDISP.PKG
35204>>>>>// OLEStdFont Charset Constants
35204>>>>>Enum_List
35204>>>>>        Define OLEANSI_CHARSET for 0 
35204>>>>>        Define OLEDEFAULT_CHARSET for 1
35204>>>>>        Define OLESYMBOL_CHARSET for 2
35204>>>>>End_Enum_List
35204>>>>>
35204>>>>>
35204>>>>>// CLSID:{BEF6E003-A874-101A-8BBA-00AA00300CAB}
35204>>>>>// ProgId: 
35204>>>>>Class OLEFontMixin is a Automation_Client
35205>>>>>
35205>>>>>        Function StdFontName Returns String
35206>>>>>                Local String lpropVal
35207>>>>>                Get GetStringProperty 0 to lpropVal
35208>>>>>                Function_Return lpropVal
35209>>>>>        End_Function
35210>>>>>
35210>>>>>        Procedure SET StdFontName String lpropVal
35211>>>>>                Send SetStringProperty 0 lpropVal
35212>>>>>        End_Procedure
35213>>>>>
35213>>>>>        Function StdFontSize Returns Currency
35214>>>>>                Local Currency lpropVal
35215>>>>>                Get GetCurrencyProperty 2 to lpropVal
35216>>>>>                Function_Return lpropVal
35217>>>>>        End_Function
35218>>>>>
35218>>>>>        Procedure SET StdFontSize Currency lpropVal
35219>>>>>                Send SetCurrencyProperty 2 lpropVal
35220>>>>>        End_Procedure
35221>>>>>
35221>>>>>        Function StdFontBold Returns Bool
35222>>>>>                Local Bool lpropVal
35223>>>>>                Get GetBoolProperty 3 to lpropVal
35224>>>>>                Function_Return lpropVal
35225>>>>>        End_Function
35226>>>>>
35226>>>>>        Procedure SET StdFontBold Bool lpropVal
35227>>>>>                Send SetBoolProperty 3 lpropVal
35228>>>>>        End_Procedure
35229>>>>>
35229>>>>>        Function StdFontItalic Returns Bool
35230>>>>>                Local Bool lpropVal
35231>>>>>                Get GetBoolProperty 4 to lpropVal
35232>>>>>                Function_Return lpropVal
35233>>>>>        End_Function
35234>>>>>
35234>>>>>        Procedure SET StdFontItalic Bool lpropVal
35235>>>>>                Send SetBoolProperty 4 lpropVal
35236>>>>>        End_Procedure
35237>>>>>
35237>>>>>        Function StdFontUnderline Returns Bool
35238>>>>>                Local Bool lpropVal
35239>>>>>                Get GetBoolProperty 5 to lpropVal
35240>>>>>                Function_Return lpropVal
35241>>>>>        End_Function
35242>>>>>
35242>>>>>        Procedure SET StdFontUnderline Bool lpropVal
35243>>>>>                Send SetBoolProperty 5 lpropVal
35244>>>>>        End_Procedure
35245>>>>>
35245>>>>>        Function StdFontStrikethrough Returns Bool
35246>>>>>                Local Bool lpropVal
35247>>>>>                Get GetBoolProperty 6 to lpropVal
35248>>>>>                Function_Return lpropVal
35249>>>>>        End_Function
35250>>>>>
35250>>>>>        Procedure SET StdFontStrikethrough Bool lpropVal
35251>>>>>                Send SetBoolProperty 6 lpropVal
35252>>>>>        End_Procedure
35253>>>>>
35253>>>>>        Function StdFontWeight Returns Integer
35254>>>>>                Local Integer lpropVal
35255>>>>>                Get GetShortProperty 7 to lpropVal
35256>>>>>                Function_Return lpropVal
35257>>>>>        End_Function
35258>>>>>
35258>>>>>        Procedure SET StdFontWeight Integer lpropVal
35259>>>>>                Send SetShortProperty 7 lpropVal
35260>>>>>        End_Procedure
35261>>>>>
35261>>>>>        Function StdFontCharset Returns Integer
35262>>>>>                Local Integer lpropVal
35263>>>>>                Get GetShortProperty 8 to lpropVal
35264>>>>>                Function_Return lpropVal
35265>>>>>        End_Function
35266>>>>>
35266>>>>>        Procedure SET StdFontCharset Integer lpropVal
35267>>>>>                Send SetShortProperty 8 lpropVal
35268>>>>>        End_Procedure
35269>>>>>
35269>>>>>End_Class
35270>>>>>
35270>>>>>// CoClass CLSID:{0BE35203-8F91-11CE-9DE3-00AA004BB851}
35270>>>>>// ProgId: StdFont
35270>>>>>// Number of impl.Types:1
35270>>>>>// Referenced class Font
35270>>>>>Class OLEStdFont is a Automation_Client
35271>>>>>        Import_Class_Protocol OLEFontMixin
35272>>>>>
35272>>>>>        Procedure Construct_Object
35273>>>>>                Forward Send Construct_Object
35275>>>>>                Set progIdStr to "StdFont"
35276>>>>>        End_Procedure
35277>>>>>End_Class
35278>>>Use PicDisp
INCLUDING FILE: PICDISP.PKG
35278>>>>>
35278>>>>>// Picture Type Constants
35278>>>>>//Enum_List
35278>>>>>        Define OLEPICTYPE_UNINITIALIZED for -1 // Uninitialized
35278>>>>>        Define OLEPICTYPE_NONE for 0 // None
35278>>>>>        Define OLEPICTYPE_BITMAP for 1 // Bitmap
35278>>>>>        Define OLEPICTYPE_METAFILE for 2 // Windows Metafile
35278>>>>>        Define OLEPICTYPE_ICON for 3 // Icon
35278>>>>>        Define OLEPICTYPE_ENHMETAFILE for 4 // Enhanced Metafile
35278>>>>>//End_Enum_List
35278>>>>>
35278>>>>>// CLSID:{7BF80981-BF32-101A-8BBB-00AA00300CAB}
35278>>>>>// ProgId: 
35278>>>>>Class OLEPictureMixin is a Automation_Client
35279>>>>>
35279>>>>>        Function StdPictureHandle Returns OLE_HANDLE
35280>>>>>                Local OLE_HANDLE lpropVal
35281>>>>>                Get GetIntegerProperty 0 to lpropVal
35282>>>>>                Function_Return lpropVal
35283>>>>>        End_Function
35284>>>>>
35284>>>>>        Function StdPicturehPal Returns OLE_HANDLE
35285>>>>>                Local OLE_HANDLE lpropVal
35286>>>>>                Get GetIntegerProperty 2 to lpropVal
35287>>>>>                Function_Return lpropVal
35288>>>>>        End_Function
35289>>>>>
35289>>>>>        Procedure SET StdPicturehPal OLE_HANDLE lpropVal
35290>>>>>                Send SetIntegerProperty 2 lpropVal
35291>>>>>        End_Procedure
35292>>>>>
35292>>>>>        Function StdPictureType Returns Integer
35293>>>>>                Local Integer lpropVal
35294>>>>>                Get GetShortProperty 3 to lpropVal
35295>>>>>                Function_Return lpropVal
35296>>>>>        End_Function
35297>>>>>
35297>>>>>        Function StdPictureWidth Returns OLE_XSIZE_HIMETRIC
35298>>>>>                Local OLE_XSIZE_HIMETRIC lpropVal
35299>>>>>                Get GetIntegerProperty 4 to lpropVal
35300>>>>>                Function_Return lpropVal
35301>>>>>        End_Function
35302>>>>>
35302>>>>>        Function StdPictureHeight Returns OLE_YSIZE_HIMETRIC
35303>>>>>                Local OLE_YSIZE_HIMETRIC lpropVal
35304>>>>>                Get GetIntegerProperty 5 to lpropVal
35305>>>>>                Function_Return lpropVal
35306>>>>>        End_Function
35307>>>>>
35307>>>>>        Procedure StdPictureRender DWORD lhdc DWORD lx DWORD ly DWORD lcx DWORD lcy OLE_XPOS_HIMETRIC lxSrc OLE_YPOS_HIMETRIC lySrc OLE_XSIZE_HIMETRIC lcxSrc OLE_YSIZE_HIMETRIC lcySrc LPOLE_RECT lprcWBounds
35308>>>>>                Send DeclareParams 10
35309>>>>>                Send DefineIntegerParam lhdc
35310>>>>>                Send DefineIntegerParam lx
35311>>>>>                Send DefineIntegerParam ly
35312>>>>>                Send DefineIntegerParam lcx
35313>>>>>                Send DefineIntegerParam lcy
35314>>>>>                Send DefineIntegerParam lxSrc
35315>>>>>                Send DefineIntegerParam lySrc
35316>>>>>                Send DefineIntegerParam lcxSrc
35317>>>>>                Send DefineIntegerParam lcySrc
35318>>>>>                Send DefineIntegerParam lprcWBounds
35319>>>>>                Send InvokeVoidFunction 6
35320>>>>>        End_Procedure 
35321>>>>>
35321>>>>>End_Class
35322>>>>>
35322>>>>>// CoClass CLSID:{0BE35204-8F91-11CE-9DE3-00AA004BB851}
35322>>>>>// ProgId: StdPicture
35322>>>>>// Number of impl.Types:1
35322>>>>>// Referenced class Picture
35322>>>>>Class OLEStdPicture is a Automation_Client
35323>>>>>        Import_Class_Protocol OLEPictureMixin
35324>>>>>
35324>>>>>        Procedure Construct_Object
35325>>>>>                Forward Send Construct_Object
35327>>>>>                Set progIdStr to "StdPicture"
35328>>>>>        End_Procedure
35329>>>>>End_Class
35330>Use DPDlg    // Full Path Directory Picker
INCLUDING FILE: DPDLG.PKG
35330>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\DPDLG.OCX
35330>>>// Generated by FlexOLE Class Generator Friday, November 10, 2000 17:30:33
35330>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
35330>>>
35330>>>//Enum_List
35330>>>    Define OLEdpdDesktop        for  0 // Desktop
35330>>>    Define OLEdpdControlPanel   for  1 // Control Panel
35330>>>    Define OLEdpdDesktopDir     for  2 // Desktop Directory
35330>>>    Define OLEdpdMyComputer     for  3 // My Computer
35330>>>    Define OLEdpdFontDir        for  4 // Font Directory
35330>>>    Define OLEdpdNetwork        for  5 // Network Neighborhood
35330>>>    Define OLEdpdPrinters       for  6 // Printers
35330>>>    Define OLEdpdPrograms       for  7 // Programs
35330>>>    Define OLEdpdRecent         for  8 // Recent
35330>>>    Define OLEdpdRecycleBin     for  9 // Recycle Bin
35330>>>    Define OLEdpdSendTo         for 10 // Send To
35330>>>    Define OLEdpdStartMenu      for 11 // Start Menu
35330>>>    Define OLEdpdStartUp        for 12 // Start Up
35330>>>    Define OLEdpdTemplates      for 13 // Templates
35330>>>    Define OLEdpdCustom         for 14 // Custom Root
35330>>>//End_Enum_List
35330>>>
35330>>>// Dispatch interface for DPDlg Control
35330>>>// CLSID:{BE5AB244-F888-11D0-9F5E-B42103C10710}
35330>>>// ProgId:
35330>>>Class OLE_DDPDlg is a Message
35331>>>
35331>>>        Function DPDlgBrowseForComputer Returns Bool
35332>>>                Local Bool lpropVal
35333>>>                Get GetBoolProperty 1 to lpropVal
35334>>>                Function_Return lpropVal
35335>>>        End_Function
35336>>>
35336>>>        Procedure SET DPDlgBrowseForComputer Bool lpropVal
35337>>>                Send SetBoolProperty 1 lpropVal
35338>>>        End_Procedure
35339>>>
35339>>>        Function DPDlgBrowseForPrinter Returns Bool
35340>>>                Local Bool lpropVal
35341>>>                Get GetBoolProperty 2 to lpropVal
35342>>>                Function_Return lpropVal
35343>>>        End_Function
35344>>>
35344>>>        Procedure SET DPDlgBrowseForPrinter Bool lpropVal
35345>>>                Send SetBoolProperty 2 lpropVal
35346>>>        End_Procedure
35347>>>
35347>>>        Function DPDlgDontGoBelowDomain Returns Bool
35348>>>                Local Bool lpropVal
35349>>>                Get GetBoolProperty 3 to lpropVal
35350>>>                Function_Return lpropVal
35351>>>        End_Function
35352>>>
35352>>>        Procedure SET DPDlgDontGoBelowDomain Bool lpropVal
35353>>>                Send SetBoolProperty 3 lpropVal
35354>>>        End_Procedure
35355>>>
35355>>>        Function DPDlgReturnFSAncestors Returns Bool
35356>>>                Local Bool lpropVal
35357>>>                Get GetBoolProperty 4 to lpropVal
35358>>>                Function_Return lpropVal
35359>>>        End_Function
35360>>>
35360>>>        Procedure SET DPDlgReturnFSAncestors Bool lpropVal
35361>>>                Send SetBoolProperty 4 lpropVal
35362>>>        End_Procedure
35363>>>
35363>>>        Function DPDlgReturnOnlyFSDirs Returns Bool
35364>>>                Local Bool lpropVal
35365>>>                Get GetBoolProperty 5 to lpropVal
35366>>>                Function_Return lpropVal
35367>>>        End_Function
35368>>>
35368>>>        Procedure SET DPDlgReturnOnlyFSDirs Bool lpropVal
35369>>>                Send SetBoolProperty 5 lpropVal
35370>>>        End_Procedure
35371>>>
35371>>>        Function DPDlgRoot Returns OLE_ROOTSHORT
35372>>>                Local OLE_ROOTSHORT lpropVal
35373>>>                Get GetIntegerProperty 6 to lpropVal
35374>>>                Function_Return lpropVal
35375>>>        End_Function
35376>>>
35376>>>        Procedure SET DPDlgRoot OLE_ROOTSHORT lpropVal
35377>>>                Send SetIntegerProperty 6 lpropVal
35378>>>        End_Procedure
35379>>>
35379>>>        Function DPDlghWnd Returns OLE_HANDLE
35380>>>                Local OLE_HANDLE lpropVal
35381>>>                Get GetIntegerProperty -515 to lpropVal
35382>>>                Function_Return lpropVal
35383>>>        End_Function
35384>>>
35384>>>        Procedure SET DPDlghWnd OLE_HANDLE lpropVal
35385>>>                Send SetIntegerProperty -515 lpropVal
35386>>>        End_Procedure
35387>>>
35387>>>        Function DPDlgIcon Returns LPDispatch
35388>>>                Local LPDispatch lpropVal
35389>>>                Get GetLPDispatchProperty 7 to lpropVal
35390>>>                Function_Return lpropVal
35391>>>        End_Function
35392>>>
35392>>>        Procedure SET DPDlgIcon LPDispatch lpropVal
35393>>>                Send SetLPDispatchProperty 7 lpropVal
35394>>>        End_Procedure
35395>>>
35395>>>        Function DPDlgFolder Returns String
35396>>>                Local String lpropVal
35397>>>                Get GetStringProperty 8 to lpropVal
35398>>>                Function_Return lpropVal
35399>>>        End_Function
35400>>>
35400>>>        Procedure SET DPDlgFolder String lpropVal
35401>>>                Send SetStringProperty 8 lpropVal
35402>>>        End_Procedure
35403>>>
35403>>>        Function DPDlgCaption Returns String
35404>>>                Local String lpropVal
35405>>>                Get GetStringProperty -518 to lpropVal
35406>>>                Function_Return lpropVal
35407>>>        End_Function
35408>>>
35408>>>        Procedure SET DPDlgCaption String lpropVal
35409>>>                Send SetStringProperty -518 lpropVal
35410>>>        End_Procedure
35411>>>
35411>>>        Function DPDlg_Caption Returns String
35412>>>                Local String lpropVal
35413>>>                Get GetStringProperty 0 to lpropVal
35414>>>                Function_Return lpropVal
35415>>>        End_Function
35416>>>
35416>>>        Procedure SET DPDlg_Caption String lpropVal
35417>>>                Send SetStringProperty 0 lpropVal
35418>>>        End_Procedure
35419>>>
35419>>>        Function DPDlgPath Returns String
35420>>>                Local String lpropVal
35421>>>                Get GetStringProperty 9 to lpropVal
35422>>>                Function_Return lpropVal
35423>>>        End_Function
35424>>>
35424>>>        Procedure SET DPDlgPath String lpropVal
35425>>>                Send SetStringProperty 9 lpropVal
35426>>>        End_Procedure
35427>>>
35427>>>        Function DPDlgCustomRoot Returns String
35428>>>                Local String lpropVal
35429>>>                Get GetStringProperty 10 to lpropVal
35430>>>                Function_Return lpropVal
35431>>>        End_Function
35432>>>
35432>>>        Procedure SET DPDlgCustomRoot String lpropVal
35433>>>                Send SetStringProperty 10 lpropVal
35434>>>        End_Procedure
35435>>>
35435>>>        Function DPDlgShow Returns Bool
35436>>>                Local Bool lretVal
35437>>>                Get InvokeBoolFunction 11 to lretVal
35438>>>                Function_Return lretVal
35439>>>        End_Function
35440>>>
35440>>>        Procedure DPDlgAboutBox
35441>>>                Send InvokeVoidFunction -552
35442>>>        End_Procedure
35443>>>
35443>>>End_Class
35444>>>
35444>>>// Event interface for DPDlg Control
35444>>>// CLSID:{BE5AB245-F888-11D0-9F5E-B42103C10710}
35444>>>// ProgId:
35444>>>Class OLE_DDPDlgEvents is a Message
35445>>>
35445>>>        Procedure OnDPDlgFolderSelected String lPath Bool lAllow
35446>>>        End_Procedure
35447>>>
35447>>>End_Class
35448>>>
35448>>>// DPDlg Control
35448>>>// CoClass CLSID:{BE5AB246-F888-11D0-9F5E-B42103C10710}
35448>>>// ProgId: DPDLG.DPDlgCtrl.1
35448>>>// Number of impl.Types:2
35448>>>// Referenced class _DDPDlg
35448>>>// Referenced class _DDPDlgEvents
35448>>>Class OLEDPDlg is a OCX_Client
35449>>>        Import_Class_Protocol OLE_DDPDlg
35450>>>        Import_Class_Protocol OLE_DDPDlgEvents
35451>>>
35451>>>        Procedure Construct_Object
35452>>>                Forward Send Construct_Object
35454>>>                Send DefineOCX_Client
35455>>>                Set progIdStr to "DPDLG.DPDlgCtrl.1"
35456>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEDPDlg"
35459>>>        End_Procedure
35460>>>
35460>>>        Procedure PreDPDlgFolderSelected Integer lParam
35461>>>                Local String lPath
35462>>>                Local Bool lAllow
35462>>>                Get GetEventStringParam lParam 0 to lPath
35463>>>                Get GetEventBoolParam lParam 1 to lAllow
35464>>>                Send OnDPDlgFolderSelected lPath lAllow
35465>>>        End_Procedure
35466>>>
35466>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
35467>>>                ON_EVENT 1 Fire PreDPDlgFolderSelected
35470>>>        End_Procedure
35471>>>End_Class
35472>>>
35472>>>// DPDlg Control
35472>>>// CoClass CLSID:{BE5AB246-F888-11D0-9F5E-B42103C10710}
35472>>>// ProgId: DPDLG.DPDlgCtrl.1
35472>>>// Number of impl.Types:2
35472>>>// Referenced class _DDPDlg
35472>>>// Referenced class _DDPDlgEvents
35472>>>Class dbOLEDPDlg is a dbOCX_Client
35473>>>        Import_Class_Protocol OLE_DDPDlg
35474>>>        Import_Class_Protocol OLE_DDPDlgEvents
35475>>>
35475>>>        Procedure Construct_Object
35476>>>                Forward Send Construct_Object
35478>>>                Send DefineDbOCX_Client
35479>>>                Set progIdStr to "DPDLG.DPDlgCtrl.1"
35480>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEDPDlg"
35483>>>        End_Procedure
35484>>>
35484>>>        Procedure PreDPDlgFolderSelected Integer lParam
35485>>>                Local String lPath
35486>>>                Local Bool lAllow
35486>>>                Get GetEventStringParam lParam 0 to lPath
35487>>>                Get GetEventBoolParam lParam 1 to lAllow
35488>>>                Send OnDPDlgFolderSelected lPath lAllow
35489>>>        End_Procedure
35490>>>
35490>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
35491>>>                ON_EVENT 1 Fire PreDPDlgFolderSelected
35494>>>        End_Procedure
35495>>>End_Class
35496>Use RasxDll  // Ras Package
INCLUDING FILE: RASXDLL.PKG
35496>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\RASX.DLL
35496>>>// Generated by FlexOLE Class Generator Friday, November 08, 2002 15:47:23
35496>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
35496>>>
35496>>>//Enum_List
35496>>>    Define OLERasActionNone         for 0 // No action
35496>>>    Define OLERasActionConnect      for 1 // Connect server
35496>>>    Define OLERasActionGetEntry     for 2 // Get phonebook entry
35496>>>    Define OLERasActionDisconnect   for 3 // Hang up (disconnect from server)
35496>>>    Define OLERasActionRefresh      for 4 // Refresh entries list
35496>>>    Define OLERasActionCreateEntry  for 5 // Create phonebook entry
35496>>>    Define OLERasActionEditEntry    for 6 // Edit phonebook entry
35496>>>//End_Enum_List
35496>>>
35496>>>// IRasXCom Interface
35496>>>// CLSID:{8E71552C-4915-11D3-B4C3-0020AFD69DE6}
35496>>>// ProgId:
35496>>>Class OLEIRasXCom is a Automation_Client
35497>>>
35497>>>// Sets or returns the filename of the phonebook to use.
35497>>>        Function RasXComPhoneBook Returns String
35498>>>                Local String lpropVal
35499>>>                Get GetStringProperty 1 to lpropVal
35500>>>                Function_Return lpropVal
35501>>>        End_Function
35502>>>
35502>>>// Sets or returns the filename of the phonebook to use.
35502>>>        Procedure SET RasXComPhoneBook String lpropVal
35503>>>                Send SetStringProperty 1 lpropVal
35504>>>        End_Procedure
35505>>>
35505>>>// Sets or returns the phone number to dial.
35505>>>        Function RasXComPhoneNumber Returns String
35506>>>                Local String lpropVal
35507>>>                Get GetStringProperty 2 to lpropVal
35508>>>                Function_Return lpropVal
35509>>>        End_Function
35510>>>
35510>>>// Sets or returns the phone number to dial.
35510>>>        Procedure SET RasXComPhoneNumber String lpropVal
35511>>>                Send SetStringProperty 2 lpropVal
35512>>>        End_Procedure
35513>>>
35513>>>// Sets or returns the name to use when logging on.
35513>>>        Function RasXComLogonName Returns String
35514>>>                Local String lpropVal
35515>>>                Get GetStringProperty 3 to lpropVal
35516>>>                Function_Return lpropVal
35517>>>        End_Function
35518>>>
35518>>>// Sets or returns the name to use when logging on.
35518>>>        Procedure SET RasXComLogonName String lpropVal
35519>>>                Send SetStringProperty 3 lpropVal
35520>>>        End_Procedure
35521>>>
35521>>>// Sets or returns the password to use.
35521>>>        Function RasXComLogonPassword Returns String
35522>>>                Local String lpropVal
35523>>>                Get GetStringProperty 4 to lpropVal
35524>>>                Function_Return lpropVal
35525>>>        End_Function
35526>>>
35526>>>// Sets or returns the password to use.
35526>>>        Procedure SET RasXComLogonPassword String lpropVal
35527>>>                Send SetStringProperty 4 lpropVal
35528>>>        End_Procedure
35529>>>
35529>>>// Sets or returns the phone number that a server should call back for certain kinds of verification.
35529>>>        Function RasXComCallbackNumber Returns String
35530>>>                Local String lpropVal
35531>>>                Get GetStringProperty 5 to lpropVal
35532>>>                Function_Return lpropVal
35533>>>        End_Function
35534>>>
35534>>>// Sets or returns the phone number that a server should call back for certain kinds of verification.
35534>>>        Procedure SET RasXComCallbackNumber String lpropVal
35535>>>                Send SetStringProperty 5 lpropVal
35536>>>        End_Procedure
35537>>>
35537>>>// Sets or returns the name of the current phone book entry.
35537>>>        Function RasXComEntryName Returns String
35538>>>                Local String lpropVal
35539>>>                Get GetStringProperty 6 to lpropVal
35540>>>                Function_Return lpropVal
35541>>>        End_Function
35542>>>
35542>>>// Sets or returns the name of the current phone book entry.
35542>>>        Procedure SET RasXComEntryName String lpropVal
35543>>>                Send SetStringProperty 6 lpropVal
35544>>>        End_Procedure
35545>>>
35545>>>// Sets or returns the domain to use for user authentication.
35545>>>        Function RasXComDomain Returns String
35546>>>                Local String lpropVal
35547>>>                Get GetStringProperty 7 to lpropVal
35548>>>                Function_Return lpropVal
35549>>>        End_Function
35550>>>
35550>>>// Sets or returns the domain to use for user authentication.
35550>>>        Procedure SET RasXComDomain String lpropVal
35551>>>                Send SetStringProperty 7 lpropVal
35552>>>        End_Procedure
35553>>>
35553>>>// Determines if methods are blocking.
35553>>>        Function RasXComBlocking Returns Bool
35554>>>                Local Bool lpropVal
35555>>>                Get GetBoolProperty 8 to lpropVal
35556>>>                Function_Return lpropVal
35557>>>        End_Function
35558>>>
35558>>>// Determines if methods are blocking.
35558>>>        Procedure SET RasXComBlocking Bool lpropVal
35559>>>                Send SetBoolProperty 8 lpropVal
35560>>>        End_Procedure
35561>>>
35561>>>// Returns the version of the control.
35561>>>        Function RasXComVersion Returns String
35562>>>                Local String lpropVal
35563>>>                Get GetStringProperty 9 to lpropVal
35564>>>                Function_Return lpropVal
35565>>>        End_Function
35566>>>
35566>>>// Returns the number of names in the current phonebook.
35566>>>        Function RasXComEntryCount Returns Integer
35567>>>                Local Integer lpropVal
35568>>>                Get GetShortProperty 10 to lpropVal
35569>>>                Function_Return lpropVal
35570>>>        End_Function
35571>>>
35571>>>// Returns whether or not RAS services are available.
35571>>>        Function RasXComRASAvailable Returns Bool
35572>>>                Local Bool lpropVal
35573>>>                Get GetBoolProperty 11 to lpropVal
35574>>>                Function_Return lpropVal
35575>>>        End_Function
35576>>>
35576>>>// Holds the last error number reported.
35576>>>        Function RasXComLastError Returns Integer
35577>>>                Local Integer lpropVal
35578>>>                Get GetShortProperty 12 to lpropVal
35579>>>                Function_Return lpropVal
35580>>>        End_Function
35581>>>
35581>>>// Returns the last method executed.
35581>>>        Function RasXComLastMethod Returns OLE_MethodsEnum
35582>>>                Local OLE_MethodsEnum lpropVal
35583>>>                Get GetIntegerProperty 13 to lpropVal
35584>>>                Function_Return lpropVal
35585>>>        End_Function
35586>>>
35586>>>// Holds a description of the last error number reported.
35586>>>        Function RasXComLastErrorString Returns String
35587>>>                Local String lpropVal
35588>>>                Get GetStringProperty 14 to lpropVal
35589>>>                Function_Return lpropVal
35590>>>        End_Function
35591>>>
35591>>>// The current state of the control.
35591>>>        Function RasXComState Returns Integer
35592>>>                Local Integer lpropVal
35593>>>                Get GetShortProperty 15 to lpropVal
35594>>>                Function_Return lpropVal
35595>>>        End_Function
35596>>>
35596>>>// A user-friendly version of the current state of the control.
35596>>>        Function RasXComStateString Returns String
35597>>>                Local String lpropVal
35598>>>                Get GetStringProperty 16 to lpropVal
35599>>>                Function_Return lpropVal
35600>>>        End_Function
35601>>>
35601>>>// Returns the RAS handle of a connection.
35601>>>        Function RasXComHandle Returns DWORD
35602>>>                Local DWORD lpropVal
35603>>>                Get GetIntegerProperty 17 to lpropVal
35604>>>                Function_Return lpropVal
35605>>>        End_Function
35606>>>
35606>>>// Returns whether or not a connection is active.
35606>>>        Function RasXComEntryConnected Returns Bool
35607>>>                Local Bool lpropVal
35608>>>                Get GetBoolProperty 18 to lpropVal
35609>>>                Function_Return lpropVal
35610>>>        End_Function
35611>>>
35611>>>// Returns the list of names in a phone book.
35611>>>        Function RasXComEntryList Integer lIndex Returns String
35612>>>                Local String lpropVal
35613>>>                Send DeclareParams 1
35614>>>                Send DefineShortParam lIndex
35615>>>                Get GetStringProperty 19 to lpropVal
35616>>>                Function_Return lpropVal
35617>>>        End_Function
35618>>>
35618>>>// Holds licensing information.
35618>>>        Function RasXComLicenseKey Returns String
35619>>>                Local String lpropVal
35620>>>                Get GetStringProperty 20 to lpropVal
35621>>>                Function_Return lpropVal
35622>>>        End_Function
35623>>>
35623>>>// Holds licensing information.
35623>>>        Procedure SET RasXComLicenseKey String lpropVal
35624>>>                Send SetStringProperty 20 lpropVal
35625>>>        End_Procedure
35626>>>
35626>>>// Connects to a server.
35626>>>        Procedure RasXComConnect
35627>>>                Send InvokeVoidFunction 22
35628>>>        End_Procedure
35629>>>
35629>>>// Disconnects (logs off) from the server.
35629>>>        Procedure RasXComDisconnect
35630>>>                Send InvokeVoidFunction 23
35631>>>        End_Procedure
35632>>>
35632>>>// Retrives an entry from the current phonebook.
35632>>>        Procedure RasXComGetEntry
35633>>>                Send InvokeVoidFunction 24
35634>>>        End_Procedure
35635>>>
35635>>>// Creates and entry in the current phone book.
35635>>>        Procedure RasXComCreateEntry
35636>>>                Send InvokeVoidFunction 25
35637>>>        End_Procedure
35638>>>
35638>>>// Allows the user to edit a RAS phone book entry.
35638>>>        Procedure RasXComEditEntry
35639>>>                Send InvokeVoidFunction 26
35640>>>        End_Procedure
35641>>>
35641>>>// Resets the component to its original state and re-loads the phone book.
35641>>>        Procedure RasXComRefresh
35642>>>                Send InvokeVoidFunction -550
35643>>>        End_Procedure
35644>>>
35644>>>// Displays About Box.
35644>>>        Procedure RasXComAbout
35645>>>                Send InvokeVoidFunction -552
35646>>>        End_Procedure
35647>>>
35647>>>// Allows object to unload without disconnecting the current connection.
35647>>>        Function RasXComDisconnectOnDestroy Returns Bool
35648>>>                Local Bool lpropVal
35649>>>                Get GetBoolProperty 28 to lpropVal
35650>>>                Function_Return lpropVal
35651>>>        End_Function
35652>>>
35652>>>// Allows object to unload without disconnecting the current connection.
35652>>>        Procedure SET RasXComDisconnectOnDestroy Bool lpropVal
35653>>>                Send SetBoolProperty 28 lpropVal
35654>>>        End_Procedure
35655>>>
35655>>>// Sets or returns an object reference to an object supporting the Fast Notification interface.
35655>>>        Function RasXComNotificationObject Returns LPDispatch
35656>>>                Local LPDispatch lpropVal
35657>>>                Get GetLPDispatchProperty 27 to lpropVal
35658>>>                Function_Return lpropVal
35659>>>        End_Function
35660>>>
35660>>>// Sets or returns an object reference to an object supporting the Fast Notification interface.
35660>>>        Procedure SET RasXComNotificationObject LPDispatch lpropVal
35661>>>                Send SetLPDispatchProperty 27 lpropVal
35662>>>        End_Procedure
35663>>>
35663>>>// Returns the version of the control.
35663>>>        Procedure SET RasXComVersion String lpropVal
35664>>>                Send SetStringProperty 9 lpropVal
35665>>>        End_Procedure
35666>>>
35666>>>End_Class
35667>>>
35667>>>// _IRasXComEvents Interface
35667>>>// CLSID:{8E71552E-4915-11D3-B4C3-0020AFD69DE6}
35667>>>// ProgId:
35667>>>Class OLE_IRasXComEvents is a Automation_Client
35668>>>
35668>>>// Fired when a method finishes.
35668>>>        Procedure RasXComDone OLE_MethodsEnum lLastMethod Integer lErrorCode String lErrorString
35669>>>                Send DeclareParams 3
35670>>>                Send DefineIntegerParam lLastMethod
35671>>>                Send DefineShortParam lErrorCode
35672>>>                Send DefineStringParam lErrorString
35673>>>                Send InvokeVoidFunction 1
35674>>>        End_Procedure
35675>>>
35675>>>// Fired when the control's internal state changes.
35675>>>        Procedure RasXComStateChanged Integer lNewState Integer lOldState
35676>>>                Send DeclareParams 2
35677>>>                Send DefineShortParam lNewState
35678>>>                Send DefineShortParam lOldState
35679>>>                Send InvokeVoidFunction 2
35680>>>        End_Procedure
35681>>>
35681>>>End_Class
35682>>>
35682>>>// RasXCom Class
35682>>>// CoClass CLSID:{8E71552D-4915-11D3-B4C3-0020AFD69DE6}
35682>>>// ProgId: Mabry.RasXCom.1
35682>>>// Number of impl.Types:2
35682>>>// Referenced class IRasXCom
35682>>>// Referenced class _IRasXComEvents
35682>>>Class OLERasXCom is a Automation_Client
35683>>>        Import_Class_Protocol OLEIRasXCom
35684>>>        Import_Class_Protocol OLE_IRasXComEvents
35685>>>
35685>>>        Procedure Construct_Object
35686>>>                Forward Send Construct_Object
35688>>>        Set progIdStr to "Mabry.RasXCom"
35689>>>        End_Procedure
35690>>>End_Class
35691>>>
35691>>>// IRasXComNotify Interface
35691>>>// CLSID:{40B44160-49E0-11D3-B4C3-0020AFD69DE6}
35691>>>// ProgId:
35691>>>Class OLEIRasXComNotify is a Automation_Client
35692>>>
35692>>>// Done
35692>>>        Procedure IRasXComNotifyDone LPDispatch lPackageObject OLE_MethodsEnum lLastMethod Integer lErrorCode String lErrorString
35693>>>                Send DeclareParams 4
35694>>>                Send DefineLPDispatchParam lPackageObject
35695>>>                Send DefineIntegerParam lLastMethod
35696>>>                Send DefineShortParam lErrorCode
35697>>>                Send DefineStringParam lErrorString
35698>>>                Send InvokeVoidFunction 1
35699>>>        End_Procedure
35700>>>
35700>>>// Fired when the control's internal state changes.
35700>>>        Procedure IRasXComNotifyStateChanged LPDispatch lPackageObject Integer lNewState Integer lOldState
35701>>>                Send DeclareParams 3
35702>>>                Send DefineLPDispatchParam lPackageObject
35703>>>                Send DefineShortParam lNewState
35704>>>                Send DefineShortParam lOldState
35705>>>                Send InvokeVoidFunction 2
35706>>>        End_Procedure
35707>>>
35707>>>End_Class
35708>Use Xfind    // Recursive Directory FILE FINDER
INCLUDING FILE: XFIND.PKG
35708>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\XFIND10DEMO.OCX
35708>>>// Generated by FlexOLE Class Generator Friday, November 10, 2000 16:23:24
35708>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
35708>>>
35708>>>// Dispatch interface for xfind Control
35708>>>// CLSID:{DF5A0221-37A0-11D4-881C-E7F891A83074}
35708>>>// ProgId: 
35708>>>Class OLEIxfind is a Message
35709>>>
35709>>>        Procedure xfindAboutBox
35710>>>                Send InvokeVoidFunction -552
35711>>>        End_Procedure 
35712>>>
35712>>>        Function xfindSearchString Returns String
35713>>>                Local String lpropVal
35714>>>                Get GetStringProperty 6 to lpropVal
35715>>>                Function_Return lpropVal
35716>>>        End_Function
35717>>>
35717>>>        Procedure SET xfindSearchString String lpropVal
35718>>>                Send SetStringProperty 6 lpropVal
35719>>>        End_Procedure
35720>>>
35720>>>        Function xfindSearchFrom Returns String
35721>>>                Local String lpropVal
35722>>>                Get GetStringProperty 7 to lpropVal
35723>>>                Function_Return lpropVal
35724>>>        End_Function
35725>>>
35725>>>        Procedure SET xfindSearchFrom String lpropVal
35726>>>                Send SetStringProperty 7 lpropVal
35727>>>        End_Procedure
35728>>>
35728>>>        Function xfindSearchSubDirs Returns Bool
35729>>>                Local Bool lpropVal
35730>>>                Get GetBoolProperty 8 to lpropVal
35731>>>                Function_Return lpropVal
35732>>>        End_Function
35733>>>
35733>>>        Procedure SET xfindSearchSubDirs Bool lpropVal
35734>>>                Send SetBoolProperty 8 lpropVal
35735>>>        End_Procedure
35736>>>
35736>>>        Procedure xfindStartSearching
35737>>>                Send InvokeVoidFunction 2
35738>>>        End_Procedure 
35739>>>
35739>>>        Function xfindIsSearching Returns Bool
35740>>>                Local Bool lpropVal
35741>>>                Get GetBoolProperty 5 to lpropVal
35742>>>                Function_Return lpropVal
35743>>>        End_Function
35744>>>
35744>>>        Procedure xfindAbortSearch
35745>>>                Send InvokeVoidFunction 9
35746>>>        End_Procedure 
35747>>>
35747>>>        Function xfindFileName Returns String
35748>>>                Local String lpropVal
35749>>>                Get GetStringProperty 3 to lpropVal
35750>>>                Function_Return lpropVal
35751>>>        End_Function
35752>>>
35752>>>        Function xfindFileSize Returns DWORD
35753>>>                Local DWORD lpropVal
35754>>>                Get GetIntegerProperty 4 to lpropVal
35755>>>                Function_Return lpropVal
35756>>>        End_Function
35757>>>
35757>>>End_Class
35758>>>
35758>>>// Events interface for xfind Control
35758>>>// CLSID:{DF5A0223-37A0-11D4-881C-E7F891A83074}
35758>>>// ProgId: 
35758>>>Class OLEIxfindEvents is a Message
35759>>>
35759>>>        Procedure OnxfindActivate
35760>>>        End_Procedure
35761>>>
35761>>>        Procedure OnxfindClick
35762>>>        End_Procedure
35763>>>
35763>>>        Procedure OnxfindCreate
35764>>>        End_Procedure
35765>>>
35765>>>        Procedure OnxfindDblClick
35766>>>        End_Procedure
35767>>>
35767>>>        Procedure OnxfindDestroy
35768>>>        End_Procedure
35769>>>
35769>>>        Procedure OnxfindDeactivate
35770>>>        End_Procedure
35771>>>
35771>>>        Procedure OnxfindKeyPress Integer lKey
35772>>>        End_Procedure
35773>>>
35773>>>        Procedure OnxfindPaint
35774>>>        End_Procedure
35775>>>
35775>>>        Procedure OnxfindFinishedSearch
35776>>>        End_Procedure
35777>>>
35777>>>        Procedure OnxfindFoundFile
35778>>>        End_Procedure
35779>>>
35779>>>End_Class
35780>>>
35780>>>// xfind Control
35780>>>// CoClass CLSID:{DF5A0225-37A0-11D4-881C-E7F891A83074}
35780>>>// ProgId: xfind10.xfind
35780>>>// Number of impl.Types:2
35780>>>// Referenced class Ixfind
35780>>>// Referenced class IxfindEvents
35780>>>Class OLExfind is a OCX_Client
35781>>>        Import_Class_Protocol OLEIxfind
35782>>>        Import_Class_Protocol OLEIxfindEvents
35783>>>
35783>>>        Procedure Construct_Object
35784>>>                Forward Send Construct_Object
35786>>>                Send DefineOCX_Client
35787>>>                Set progIdStr to "xfind10.xfind"
35788>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLExfind"
35791>>>        End_Procedure
35792>>>
35792>>>        Procedure PrexfindKeyPress Integer lParam
35793>>>                Local Integer lKey
35794>>>                Get GetEventShortParam lParam 0 to lKey
35795>>>                Send OnxfindKeyPress lKey
35796>>>        End_Procedure
35797>>>
35797>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
35798>>>                ON_EVENT 1 Fire OnxfindActivate
35801>>>                ON_EVENT 2 Fire OnxfindClick
35804>>>                ON_EVENT 3 Fire OnxfindCreate
35807>>>                ON_EVENT 5 Fire OnxfindDblClick
35810>>>                ON_EVENT 6 Fire OnxfindDestroy
35813>>>                ON_EVENT 7 Fire OnxfindDeactivate
35816>>>                ON_EVENT 11 Fire PrexfindKeyPress
35819>>>                ON_EVENT 16 Fire OnxfindPaint
35822>>>                ON_EVENT 4 Fire OnxfindFinishedSearch
35825>>>                ON_EVENT 8 Fire OnxfindFoundFile
35828>>>        End_Procedure
35829>>>End_Class
35830>>>
35830>>>// xfind Control
35830>>>// CoClass CLSID:{DF5A0225-37A0-11D4-881C-E7F891A83074}
35830>>>// ProgId: xfind10.xfind
35830>>>// Number of impl.Types:2
35830>>>// Referenced class Ixfind
35830>>>// Referenced class IxfindEvents
35830>>>Class dbOLExfind is a dbOCX_Client
35831>>>        Import_Class_Protocol OLEIxfind
35832>>>        Import_Class_Protocol OLEIxfindEvents
35833>>>
35833>>>        Procedure Construct_Object
35834>>>                Forward Send Construct_Object
35836>>>                Send DefineDbOCX_Client
35837>>>                Set progIdStr to "xfind10.xfind"
35838>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLExfind"
35841>>>        End_Procedure
35842>>>
35842>>>        Procedure PrexfindKeyPress Integer lParam
35843>>>                Local Integer lKey
35844>>>                Get GetEventShortParam lParam 0 to lKey
35845>>>                Send OnxfindKeyPress lKey
35846>>>        End_Procedure
35847>>>
35847>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
35848>>>                ON_EVENT 1 Fire OnxfindActivate
35851>>>                ON_EVENT 2 Fire OnxfindClick
35854>>>                ON_EVENT 3 Fire OnxfindCreate
35857>>>                ON_EVENT 5 Fire OnxfindDblClick
35860>>>                ON_EVENT 6 Fire OnxfindDestroy
35863>>>                ON_EVENT 7 Fire OnxfindDeactivate
35866>>>                ON_EVENT 11 Fire PrexfindKeyPress
35869>>>                ON_EVENT 16 Fire OnxfindPaint
35872>>>                ON_EVENT 4 Fire OnxfindFinishedSearch
35875>>>                ON_EVENT 8 Fire OnxfindFoundFile
35878>>>        End_Procedure
35879>>>End_Class
35880>Use dvFtp    // FTP Package
INCLUDING FILE: DVFTP.PKG
35880>>>// DVFTP.PKG - Internet File Transfer Protocol (FTP) functions
35880>>>//             for Visual Dataflex
35880>>>//
35880>>>// Created by: Marcel J. Zwiebel
35880>>>//             Dataview - The Netherlands
35880>>>// E-mail    : marcel@dataview-sc.com
35880>>>// CIS id    : 100273,2473
35880>>>// Web URL   : http://www.dataview-sc.com
35880>>>//
35880>>>// Date      : 28/07/1997 
35880>>>
35880>>>Use Windows.pkg
35880>>>Use DLL.pkg
35880>>>
35880>>>// register external functions of the dvftp.dll
35880>>>
35880>>>
35880>>>// function   : dvInternetAttemptConnect
35880>>>//
35880>>>// description: Attemps to make a connection to the Internet. If the user has a dialup-connection
35880>>>//              to an Internet Service Provider (ISP) and the computer is not connected to this 
35880>>>//              ISP, the standard dialup dialog box will be evoked.
35880>>>//                   
35880>>>// parameters : none
35880>>>//
35880>>>// returns    : integer - Is 0 (ok) or error-number.
35880>>>//
35880>>>External_Function dvInternetAttemptConnect "dvInternetAttemptConnect" DVFTP.DLL ;     Returns Integer
35881>>>
35881>>>
35881>>>// function   : dvInternetOpen
35881>>>//
35881>>>// description: Initializes the application's use of the WIN32 Internet functions.
35881>>>//
35881>>>// parameters : none
35881>>>//
35881>>>// returns    : integer - Is 0 (ok) or error-number.
35881>>>//
35881>>>External_Function dvInternetOpen "dvInternetOpen" DVFTP.DLL ;     Returns Integer
35882>>>
35882>>>
35882>>>// function   : dvInternetConnect
35882>>>//
35882>>>// description: Opens an FTP-session with a server.
35882>>>//
35882>>>// parameters : string ServerName - Can be a DNS-name (for example: ftp.daccess.com) or 
35882>>>//                                  an ip-number (for example: 145.58.31.4).
35882>>>//              string UserName   - Login-name for the server, can be empty for 
35882>>>//                                  "anonymous" login (default for most FTP servers).
35882>>>//              string Password   - Password for the server, can be empty for 
35882>>>//                                  "anonymous" login (default for most FTP servers).
35882>>>//              integer Firewall  - Must be 1 for connecting through a SOCKS firewall
35882>>>//                                  server, otherwise 0.
35882>>>//
35882>>>// returns    : integer - Is 0 (ok) or error-number.
35882>>>//
35882>>>External_Function dvInternetConnect "dvInternetConnect" DVFTP.DLL ;     String szServerName String szUserName String szPassword Integer iFirewall;     Returns Integer
35883>>>
35883>>>
35883>>>// function   : dvFtpSetCurrentDirectory
35883>>>//
35883>>>// description: Changes to a different working directory on the FTP server.
35883>>>//
35883>>>// parameters : string directory - Name of the directory to change to on the remote system. 
35883>>>//                                 This can be either a fully qualified path or a name 
35883>>>//                                 relative to the current directory. 
35883>>>//                                 A backslash (\) or forward slash (/) can be used as the 
35883>>>//                                 directory separator for either name. dvFtpSetCurrentDirectory
35883>>>//                                 translates the directory name separators to the appropriate 
35883>>>//                                 character before they are used. 
35883>>>//                                 Use dvFtpGetCurrentDirectory to determine the remote site's 
35883>>>//                                 current working directory (not all remote systems use a
35883>>>//                                 hierarchical naming scheme for directories).
35883>>>//
35883>>>// returns    : integer - Is 0 (ok) or error-number.
35883>>>//
35883>>>External_Function dvFtpSetCurrentDirectory "dvFtpSetCurrentDirectory" DVFTP.DLL ;     String szDirectory Returns Integer
35884>>>
35884>>>
35884>>>// function   : dvFtpGetCurrentDirectory
35884>>>//
35884>>>// description: Retrieves the current directory for the specified FTP session.
35884>>>//
35884>>>// parameters : none
35884>>>//
35884>>>// returns    : string - Name of the current directory.
35884>>>//
35884>>>External_Function dvFtpGetCurrentDirectory "dvFtpGetCurrentDirectory" DVFTP.DLL ;     Returns String
35885>>>
35885>>>
35885>>>// function   : dvFtpCreateDirectory
35885>>>//
35885>>>// description: Creates a new directory on the FTP server. 
35885>>>//
35885>>>// parameters : string Directory - The name of the directory to create on the remote system.
35885>>>//                                 This can be either a fully qualified path or a name 
35885>>>//                                 relative to the current directory. 
35885>>>//                                 A backslash (\) or forward slash (/) can be used as the 
35885>>>//                                 directory separator for either name. dvFtpCreateDirectory
35885>>>//                                 translates the directory name separators to the appropriate 
35885>>>//                                 character before they are used. 
35885>>>//                                 Use dvFtpGetCurrentDirectory to determine the remote site's 
35885>>>//                                 current working directory (not all remote systems use a
35885>>>//                                 hierarchical naming scheme for directories).
35885>>>//
35885>>>// returns    : integer - Is 0 (ok) or error-number.
35885>>>//
35885>>>External_Function dvFtpCreateDirectory "dvFtpCreateDirectory" DVFTP.DLL ;     String szDirectory Returns Integer
35886>>>
35886>>>
35886>>>// function   : dvFtpRemoveDirectory
35886>>>//
35886>>>// description: Removes the specified directory on the FTP server. 
35886>>>//
35886>>>// parameters : string Directory - The name of the directory to remove on the remote system.
35886>>>//                                 This can be either a fully qualified path or a name 
35886>>>//                                 relative to the current directory. 
35886>>>//                                 A backslash (\) or forward slash (/) can be used as the 
35886>>>//                                 directory separator for either name. dvFtpRemoveDirectory
35886>>>//                                 translates the directory name separators to the appropriate 
35886>>>//                                 character before they are used. 
35886>>>//                                 Use dvFtpGetCurrentDirectory to determine the remote site's 
35886>>>//                                 current working directory (not all remote systems use a
35886>>>//                                 hierarchical naming scheme for directories).
35886>>>//
35886>>>// returns    : integer - Is 0 (ok) or error-number.
35886>>>//
35886>>>External_Function dvFtpRemoveDirectory "dvFtpRemoveDirectory" DVFTP.DLL ;     String szDirectory Returns Integer
35887>>>
35887>>>
35887>>>// function   : dvFtpFindFirstFile
35887>>>//
35887>>>// description: Searches the specified directory of the given FTP session.
35887>>>//
35887>>>// parameters : string FileSelect - A valid directory path or file name (wildcards allowed) for
35887>>>//                                  the FTP server's file system. If the string is empty the 
35887>>>//                                  first file in the current directory on the server will be 
35887>>>//                                  searched for. 
35887>>>//              integer UseCache  - Indicates using the local computer's cache.
35887>>>//                                  If the value is 0 then the the cache will be used. 
35887>>>//                                  If the value is 1 then a download of the requested file, 
35887>>>//                                  object, or directory listing from the origin server will be 
35887>>>//                                  forced, not from the cache.
35887>>>//
35887>>>// returns    : string - Name of the first file found or empty when no files found. When the 
35887>>>//                       searched directory is empty the string "directory is empty" is returned.
35887>>>//
35887>>>External_Function dvFtpFindFirstFile "dvFtpFindFirstFile" DVFTP.DLL ;     String szFileSelect Integer iUseCache Returns String
35888>>>
35888>>>
35888>>>// function   : dvFtpFindNextFile
35888>>>//
35888>>>// description: Continues a file search started as a result of executing dvFtpFindFirstFile.
35888>>>//
35888>>>// parameters : none
35888>>>//
35888>>>// returns    : string - Name of the next file found or empty when no more files are found.
35888>>>//
35888>>>External_Function dvFtpFindNextFile "dvFtpFindNextFile" DVFTP.DLL ;     Returns String
35889>>>
35889>>>
35889>>>// function   : dvFtpDeleteFile
35889>>>//
35889>>>// description: Deletes a file stored on the FTP server. 
35889>>>//
35889>>>// parameters : string FileSelect - Name of the file to be deleted.
35889>>>//                                  Can be file names relative to the current directory. 
35889>>>//                                  A backslash (\) or forward slash (/) can be used as 
35889>>>//                                  the directory separator. dvFtpDeleteFile translates the 
35889>>>//                                  directory name separators to the appropriate character 
35889>>>//                                  before they are used. 
35889>>>//
35889>>>// returns    : integer - Is 0 (ok) or error-number.
35889>>>//
35889>>>External_Function dvFtpDeleteFile "dvFtpDeleteFile" DVFTP.DLL ;     String szFileSelect Returns Integer
35890>>>
35890>>>
35890>>>// function   : dvFtpRenameFile
35890>>>//
35890>>>// description: Renames a file stored on the FTP server. 
35890>>>//
35890>>>// parameters : string Existing - The name of the file that will have its name changed on the
35890>>>//                                remote FTP server. 
35890>>>//              string New      - The new name for the remote file. 
35890>>>//
35890>>>//                                Both names can be relative to the current directory. A backslash 
35890>>>//                                (\) or forward slash (/) can be used as the directory separator 
35890>>>//                                for either name. dvFtpRenameFile translates the directory name 
35890>>>//                                separators to the appropriate character before they are used. 
35890>>>//
35890>>>// returns    : integer - Is 0 (ok) or error-number.
35890>>>//
35890>>>External_Function dvFtpRenameFile "dvFtpRenameFile" DVFTP.DLL ;     String szExisting String szNew Returns Integer
35891>>>
35891>>>
35891>>>// function   : dvFtpGetFile
35891>>>//
35891>>>// description: Retrieves a file from the FTP server and stores it under the specified file name, 
35891>>>//              creating a new local file in the process. 
35891>>>//
35891>>>// parameters : string  RemoteFile   - The name of the file to retrieve from the remote system. 
35891>>>//              string  NewFile      - The name of the file to create on the local system. 
35891>>>//              integer FailIfExists - Boolean flag that indicates whether the function should 
35891>>>//                                     proceed if a local file of the specified name already exists. 
35891>>>//                                     If value is 1 and the local file exists, dvFtpGetFile fails. 
35891>>>//              integer FileType     - Indicates the transfer method.
35891>>>//                                     If the value is 0 then the function transfers the file using 
35891>>>//                                     FTP's ASCII (Type A) transfer method. Control and formatting 
35891>>>//                                     information is converted to local equivalents. 
35891>>>//                                     If the value is 1 then the function transfers the file using 
35891>>>//                                     FTP's Image (Type I) transfer method. The file is transferred 
35891>>>//                                     exactly as it exists with no changes. 
35891>>>//
35891>>>// returns    : integer - Is 0 (ok) or error-number.
35891>>>//
35891>>>External_Function dvFtpGetFile "dvFtpGetFile" DVFTP.DLL ;     String szRemoteFile String szNewFile Integer bFailIfExists Integer iFileType Returns Integer
35892>>>
35892>>>
35892>>>// function   : dvFtpPutFile
35892>>>//
35892>>>// description: Stores a file on the FTP server. 
35892>>>//
35892>>>// parameters : string  LocalFile     - The name of the file to send from the local system. 
35892>>>//              string  NewRemoteFile - The name of the file to create on the remote system.
35892>>>//              integer FileType      - Indicates the transfer method.
35892>>>//                                      If the value is 0 then the function transfers the 
35892>>>//                                      file as ASCII. 
35892>>>//                                      If the value is 1 then the function transfres the
35892>>>//                                      file as binary. 
35892>>>//
35892>>>// returns    : integer - Is 0 (ok) or error-number.
35892>>>//
35892>>>External_Function dvFtpPutFile "dvFtpPutFile" DVFTP.DLL ;     String szLocalFile String szNewRemoteFile Integer iFileType Returns Integer
35893>>>
35893>>>
35893>>>
35893>>>// The following functions give common file-information after performing dvFtpFindFirstFile
35893>>>// and dvFtpFindNextFile. Because the FTP protocol provides no standard means of enumerating, 
35893>>>// some of the common information about files, such as file creation date and time, is not 
35893>>>// always available or correct. When this happens, dvFtpFindFirstFile and dvFtpFindNextFile 
35893>>>// fill in unavailable information with a best guess based on available information. For example,
35893>>>// creation and last access dates will often be the same as the file's modification date.
35893>>>
35893>>>
35893>>>// function   : dvFtpFilename
35893>>>//
35893>>>// description: The name of the file. 
35893>>>//
35893>>>// parameters : none
35893>>>//
35893>>>// returns    : string - Name of the file
35893>>>//
35893>>>External_Function dvFtpFilename "dvFtpFilename" DVFTP.DLL ;     Returns String
35894>>>
35894>>>
35894>>>// function   : dvFtpAlternateFilename
35894>>>//
35894>>>// description: An alternative name for the file. This name is in the classic 8.3 (filename.ext)
35894>>>//              filename format.
35894>>>//
35894>>>// parameters : none
35894>>>//
35894>>>// returns    : string - Alternate name for the file. If the file has a long filename, the complete 
35894>>>//                       name can be retrieved by the dvFtpFilename function, and the 8.3 format
35894>>>//                       truncated version of the name can be retrieved with this function. Otherwise, 
35894>>>//                       this function returns an empty string.
35894>>>//
35894>>>External_Function dvFtpAlternateFilename "dvFtpAlternateFilename" DVFTP.DLL ;     Returns String
35895>>>
35895>>>
35895>>>// function   : dvFtpFileCreated
35895>>>//              
35895>>>// description: The date/time the file was created in 24-hour format.
35895>>>//
35895>>>// parameters : integer DateFormat - The format of the date to be retrieved.
35895>>>//                                   If value is 0 then US-formatted date is returned (mm/dd/yyyy).
35895>>>//                                   If value is 1 then European-formatted date is returned (dd/mm/yyyy).
35895>>>//                                   If value is 2 then military-formatted date is returned (yyyy.mm.dd).
35895>>>//
35895>>>// returns    : string - The file creation-date/time
35895>>>//
35895>>>External_Function dvFtpFileCreated "dvFtpFileCreated" DVFTP.DLL ;     Integer iDateFormat Returns String
35896>>>
35896>>>
35896>>>// function   : dvFtpFileAccessed
35896>>>//              
35896>>>// description: The last date/time the file was accessed in 24-hour format.
35896>>>//
35896>>>// parameters : integer DateFormat - The format of the date to be retrieved.
35896>>>//                                   If value is 0 then US-formatted date is returned (mm/dd/yyyy).
35896>>>//                                   If value is 1 then European-formatted date is returned (dd/mm/yyyy).
35896>>>//                                   If value is 2 then military-formatted date is returned (yyyy.mm.dd).
35896>>>//
35896>>>// returns    : string - The last file access-date/time
35896>>>//
35896>>>External_Function dvFtpFileAccessed "dvFtpFileAccessed" DVFTP.DLL ;     Integer iDateFormat Returns String
35897>>>
35897>>>
35897>>>// function   : dvFtpFileWritten
35897>>>//              
35897>>>// description: The last date/time the file was written to in 24-hour format.
35897>>>//
35897>>>// parameters : integer DateFormat - The format of the date to be retrieved.
35897>>>//                                   If value is 0 then US-formatted date is returned (mm/dd/yyyy).
35897>>>//                                   If value is 1 then European-formatted date is returned (dd/mm/yyyy).
35897>>>//                                   If value is 2 then military-formatted date is returned (yyyy.mm.dd).
35897>>>//
35897>>>// returns    : string - The last file written to-date/time
35897>>>//
35897>>>External_Function dvFtpFileWritten "dvFtpFileWritten" DVFTP.DLL ;     Integer iDateFormat Returns String
35898>>>
35898>>>
35898>>>// function   : dvFtpFileSize
35898>>>//              
35898>>>// description: The size of the file in bytes.
35898>>>//
35898>>>// parameters : none
35898>>>//
35898>>>// returns    : integer - Filesize in bytes.
35898>>>//
35898>>>External_Function dvFtpFileSize "dvFtpFileSize" DVFTP.DLL ;     Returns Integer
35899>>>
35899>>>
35899>>>// function   : dvFtpIsDirectory
35899>>>//              
35899>>>// description: The file is an directory.
35899>>>//
35899>>>// parameters : none
35899>>>//
35899>>>// returns    : integer - If value is 1 the file is directory, otherwise 0 will be returned.
35899>>>//
35899>>>External_Function dvFtpIsDirectory "dvFtpIsDirectory" DVFTP.DLL ;     Returns Integer
35900>>>
35900>>>
35900>>>// function   : dvGetServerMsg
35900>>>//              
35900>>>// description: Gets the returned message from the FTP server (error-number will
35900>>>//              be 12003 "extended error").
35900>>>//
35900>>>// parameters : none
35900>>>//
35900>>>// returns    : string - Return message from the FTP server.
35900>>>//
35900>>>External_Function dvGetServerMsg "dvGetServerMsg" DVFTP.DLL;     Returns String
35901>>>
35901>>>
35901>>>// error-numbers returned
35901>>>//
35901>>>// 12001  "out of handles"            
35901>>>// 12002  "timeout"
35901>>>// 12003  "extended error"
35901>>>// 12004  "internal error"            
35901>>>// 12005  "invalid url"               
35901>>>// 12006  "unrecognized scheme"       
35901>>>// 12007  "name not resolved"         
35901>>>// 12008  "protocol not found"        
35901>>>// 12009  "invalid option"            
35901>>>// 12010  "bad option length"         
35901>>>// 12011  "option not settable"      
35901>>>// 12012  "shutdown"                  
35901>>>// 12013  "incorrect user name"       
35901>>>// 12014  "incorrect password"
35901>>>// 12015  "login failure"             
35901>>>// 12016  "invalid operation"         
35901>>>// 12017  "operation cancelled"       
35901>>>// 12018  "incorrect handle type"     
35901>>>// 12019  "incorrect handle state"
35901>>>// 12020  "not proxy request"         
35901>>>// 12021  "registry value not found"
35901>>>// 12022  "bad registry parameter"    
35901>>>// 12023  "no direct access"          
35901>>>// 12024  "no context"                
35901>>>// 12025  "no callback"               
35901>>>// 12026  "request pending"           
35901>>>// 12027  "incorrect format"          
35901>>>// 12028  "item not found"            
35901>>>// 12029  "cannot connect"            
35901>>>// 12030  "connection aborted"        
35901>>>// 12031  "connection reset"          
35901>>>// 12032  "force retry"               
35901>>>// 12033  "invalid proxy request"     
35901>>>// 12034  "need ui"                   
35901>>>// 12036  "handle exists"             
35901>>>// 12037  "sec cert date invalid"     
35901>>>// 12038  "sec cert cn invalid"       
35901>>>// 12039  "http to https on redir"    
35901>>>// 12040  "https to http on_redir"    
35901>>>// 12041  "mixed security"            
35901>>>// 12042  "chg post is non secure"    
35901>>>// 12043  "post is non_secure"        
35901>>>// 12044  "client auth cert needed"   
35901>>>// 12045  "invalid ca"                
35901>>>// 12046  "client auth not setup"     
35901>>>// 12047  "async thread failed"       
35901>>>// 12048  "redirect scheme change"    
35901>>>// 12049  "dialog pending"            
35901>>>// 12050  "retry dialog"              
35901>>>// 12110  "ftp transfer in progress"  
35901>>>// 12111  "ftp dropped"               
35901>>>// 12112  "ftp no passive mode"       
35901>>>// 12157  "security channel error"    
35901>>>// 12158  "unable to cache file"      
35901>>>// 12159  "tcpip not installed"       
35901>>>// 12163  "disconnected"              
35901>>>// 12164  "server unreachable"        
35901>>>// 12165  "proxy server unreachable"  
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>>>
35901>Use DVDIALER // Vdf6 Dialer
INCLUDING FILE: DVDIALER.PKG
35901>>>// DVDIALER.PKG - Automatic dialing functions for dial-up access to the Internet
35901>>>//
35901>>>// Created by: Marcel J. Zwiebel
35901>>>//             Dataview - The Netherlands
35901>>>// E-mail    : marcel@dataview-sc.com
35901>>>// Web URL   : http://www.dataview-sc.com
35901>>>//
35901>>>// Date      : 03/24/1999
35901>>>
35901>>>Use Windows.pkg
35901>>>Use DLL.pkg 
35901>>>
35901>>>
35901>>>// register external functions of the dvdailer.dll
35901>>>
35901>>>
35901>>>// function   : dvInternetGetConnectedState
35901>>>//
35901>>>// description: Retrieves the connected state of the local system.
35901>>>//                   
35901>>>// parameters : none
35901>>>//
35901>>>// returns    : integer - value 1 = the local system is (currently) connected by a modem to the Internet.
35901>>>//                              2 = the local system uses a local area network to connect to the Internet.
35901>>>//                              3 = the local system uses a proxy server to connect to the Internet.
35901>>>//                              4 = the local system's modem is busy with a non-Internet connection.
35901>>>//                              0 = there is no Internet connection.
35901>>>//
35901>>>External_Function32 dvInternetGetConnectedState "dvInternetGetConnectedState" DVDIALER.DLL Returns Integer
35902>>>
35902>>>
35902>>>// function   : dvInternetAutodial
35902>>>//
35902>>>// description: Automatically causes the modem to dial the default Internet connection.
35902>>>//              Use the function dvInternetAutodialHangup to hangup this connection.
35902>>>//                   
35902>>>// parameters : none
35902>>>//
35902>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
35902>>>//
35902>>>External_Function32 dvInternetAutodial "dvInternetAutodial" DVDIALER.DLL Returns Integer
35903>>>
35903>>>
35903>>>// function   : dvInternetAutodialHangup
35903>>>//
35903>>>// description: Disconnects an automatic dial-up connection invoked by dvInternetAutodial. 
35903>>>//                   
35903>>>// parameters : none
35903>>>//
35903>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
35903>>>//
35903>>>External_Function32 dvInternetAutodialHangup "dvInternetAutodialHangup" DVDIALER.DLL Returns Integer
35904>>>
35904>>>
35904>>>// function   : dvInternetDial
35904>>>//
35904>>>// description: Initiates a connection to the Internet using a modem connection and a phonebook entry.
35904>>>//              Use the function dvInternetHangup to hangup this connection.
35904>>>//                   
35904>>>// parameters : string - The name of the dial-up connection to use (phonebook entry).
35904>>>//
35904>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
35904>>>//
35904>>>External_Function32 dvInternetDial "dvInternetDial" DVDIALER.DLL String szConnectiontoid Returns Integer
35905>>>
35905>>>
35905>>>// function   : dvInternetHangup
35905>>>//
35905>>>// description: Instructs the modem to disconnect from the Internet (connection invoked by dvInternetDial). 
35905>>>//              
35905>>>// parameters : none
35905>>>//
35905>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
35905>>>//
35905>>>External_Function32 dvInternetHangUp "dvInternetHangUp" DVDIALER.DLL Returns Integer
35906>>>
35906>>>
35906>>>
35906>>>
35906>>>
35906>>>
35906>>>
35906>>>
35906>>>
35906>>>
35906>>>
35906>>>
35906>
35906>
35906>Function GetTheWorkSpace returns String
35907>    String lsWorkSpace
35908>    get_profile_string "WorkSpaces" "CurrentWorkspace" to lsWorkSpace
35911>    If lsWorkSpace eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to lsWorkSpace
35914>    insert "WorkSpaces\" in lsWorkSpace at 1
35916>    Function_Return lsWorkSpace
35917>End_Function
35918>
35918>Function GetTheAppPath Returns String
35919>   String lsWorkSpace lsModule lsTheAppPath
35920>   Move (GetTheWorkSpace(Self)) to lsWorkSpace
35921>   Move (Module_Name(Self)) to lsModule
35922>   Move (lsWorkSpace + "\" + lsModule) to lsTheAppPath
35923>   Function_Return lsTheAppPath
35924>End_Function
35925>
35925>
35925>
35925>//===========================================================
35925>//===========================================================
35925>Integer iMetrhthsProsp iHasAPassword
35925>Integer iMax00 iApotel iCountRemain iMustResetPass iAnenergos
35925>//--
35925>
35925>Open Sysrec
INCLUDING FILE: SYSREC.FD
35927>Open Users
35929>Open UsersH
INCLUDING FILE: USERSH.FD
35931>Open Usergrps
35933>
35933>Open Btnemp
INCLUDING FILE: BTNEMP.FD
35935>
35935>Register_Procedure ChangeMyPassword
35935>
35935>//--
35935>Use PasswVerif.pkg
INCLUDING FILE: PASSWVERIF.PKG
35935>>>
35935>>>
35935>>>Function fsCryptoNew String lsWay String lsOld Returns String
35936>>>    Local String lsNew sToumpa sStringEncrypted sTemp sStringDecrypted
35937>>>    Integer iCount iAsciiNum
35937>>>
35937>>>    Move (Trim(lsOld)) to lsOld
35938>>>    Move (Trim(lsWay)) to lsWay
35939>>>
35939>>>    If ((Uppercase(lsWay)) eq 'ENCRYPT') Begin
35941>>>        Move lsOld  to sStringDecrypted
35942>>>        Move ""     to sStringEncrypted
35943>>>        Move ""     to sToumpa
35944>>>
35944>>>        // 1. Prota to fernoume anapoda / toumpa
35944>>>        For iCount From 1 to (Length(sStringDecrypted))
35950>>>>
35950>>>            Move (Mid(sStringDecrypted,1,iCount))   to sTemp
35951>>>            Move (Insert(sTemp,sToumpa,1))          to sToumpa
35952>>>        Loop
35953>>>>
35953>>>
35953>>>        // 2. Ftiaxnoume to neo string prosthetontas ton xarakthra pou prokyptei
35953>>>        //    apo ton Ascii kodiko tou xarakthra + thn thesi tou mesa sto string
35953>>>        For iCount From 1 to (Length(sToumpa))
35959>>>>
35959>>>            Move (Mid(sToumpa,1,iCount))            to sTemp
35960>>>            Move (Ascii(sTemp) + iCount)            to iAsciiNum
35961>>>            Move (Character(iAsciiNum))             to sTemp
35962>>>            Move (Append(sStringEncrypted,sTemp))   to sStringEncrypted
35963>>>        Loop
35964>>>>
35964>>>        Move sStringEncrypted to lsNew
35965>>>    End
35965>>>>
35965>>>    Else If ((Uppercase(lsWay)) eq 'DECRYPT') Begin
35968>>>        Move lsOld to sStringEncrypted
35969>>>        Move "" to sStringDecrypted
35970>>>        Move "" to sToumpa
35971>>>
35971>>>        // 1. Ftiaxnoume to palio string afairontas ton xarakthra pou prokyptei
35971>>>        //    apo ton Ascii kodiko tou xarakthra + thn thesi tou mesa sto string
35971>>>        For iCount From 1 to (Length(sStringEncrypted))
35977>>>>
35977>>>            Move (Mid(sStringEncrypted,1,iCount))       to sTemp
35978>>>            Move (Ascii(sTemp) - iCount)                to iAsciiNum
35979>>>            Move (Character(iAsciiNum))                 to sTemp
35980>>>            Move (Append(sStringDecrypted,sTemp))       to sStringDecrypted
35981>>>        Loop
35982>>>>
35982>>>
35982>>>        // 2. Meta, to fernoume anapoda / toumpa
35982>>>        For iCount From 1 to (Length(sStringDecrypted))
35988>>>>
35988>>>            Move (Mid(sStringDecrypted,1,iCount))   to sTemp
35989>>>            Move (Insert(sTemp,sToumpa,1))          to sToumpa
35990>>>        Loop
35991>>>>
35991>>>        Move sToumpa to lsNew
35992>>>    End
35992>>>>
35992>>>    Else Send Info_Box ("The parameter lsWay must be ENCRYPT or DECRYPT\nThe returned string will be incorrect since you passed "+Trim(lsWay)) "Error 1001"
35994>>>    Function_Return (Trim(lsNew))
35995>>>End_Function
35996>>>
35996>>>
35996>>>Function HasOneCap string asPassw Integer aiGreek Returns Integer
35997>>>    Integer rVal
35998>>>    Integer iLength x
35998>>>    String  sChar
35998>>>    Move (Length(asPassw))  to iLength
35999>>>    Move 0                  to rVal
36000>>>    For x From 1 to iLength
36006>>>>
36006>>>        Move (Mid(asPassw,1,x)) to sChar
36007>>>        If (aiGreek=0) Begin
36009>>>            If ( ;                 ( (Ascii(sChar)>=65 ) And (Ascii(sChar)<= 90)) Or  ;                 ( (Ascii(ToAnsi(sChar))>=193) And (Ascii(ToAnsi(sChar))<=219))  ;               ) Begin
36011>>>                Move 1      to rVal
36012>>>                Move 9999   to x
36013>>>            End
36013>>>>
36013>>>        End
36013>>>>
36013>>>        Else Begin
36014>>>            If ( (Ascii(sChar)>=65) And (Ascii(sChar)<=90) ) Begin
36016>>>                Move 1      to rVal
36017>>>                Move 9999   to x
36018>>>            End
36018>>>>
36018>>>        End
36018>>>>
36018>>>    Loop
36019>>>>
36019>>>    Function_Return rVal
36020>>>End_Function
36021>>>
36021>>>Function HasOneSmall string asPassw Integer aiGreek Returns Integer
36022>>>    Integer rVal
36023>>>    Integer iLength x
36023>>>    String  sChar
36023>>>    Move (Length(asPassw))  to iLength
36024>>>    Move 0                  to rVal
36025>>>    For x From 1 to iLength
36031>>>>
36031>>>        Move (Mid(asPassw,1,x)) to sChar
36032>>>        If (aiGreek=0) Begin
36034>>>            If ( ;                 ( (Ascii(sChar)>= 97) And (Ascii(sChar)<=122)) Or ;                 ( (Ascii(ToAnsi(sChar))>=220) And (Ascii(ToAnsi(sChar))<=254))    ;               ) Begin
36036>>>                Move 1      to rVal
36037>>>                Move 9999   to x
36038>>>            End
36038>>>>
36038>>>        End
36038>>>>
36038>>>        Else Begin
36039>>>            If ( (Ascii(sChar)>=97) And (Ascii(sChar)<=122)) Begin
36041>>>                Move 1      to rVal
36042>>>                Move 9999   to x
36043>>>            End
36043>>>>
36043>>>        End
36043>>>>
36043>>>    Loop
36044>>>>
36044>>>    Function_Return rVal
36045>>>End_Function
36046>>>
36046>>>Function HasOneNumber string asPassw Returns Integer
36047>>>    Integer rVal
36048>>>    Integer iLength x
36048>>>    String  sChar
36048>>>    Move (Length(asPassw))  to iLength
36049>>>    Move 0                  to rVal
36050>>>    For x From 1 to iLength
36056>>>>
36056>>>        Move (Mid(asPassw,1,x)) to sChar
36057>>>        If ( (Ascii(sChar)>=48) And (Ascii(sChar)<=57)) Begin
36059>>>            Move 1      to rVal
36060>>>            Move 9999   to x
36061>>>        End
36061>>>>
36061>>>    Loop
36062>>>>
36062>>>    Function_Return rVal
36063>>>End_Function
36064>>>
36064>>>Function HasOneSpecial string asPassw Returns Integer
36065>>>    Integer rVal
36066>>>    Integer iLength x
36066>>>    String  sChar
36066>>>    Move (Length(asPassw))  to iLength
36067>>>    Move 0                  to rVal
36068>>>    For x From 1 to iLength
36074>>>>
36074>>>        Move (Mid(asPassw,1,x)) to sChar
36075>>>        If ( ;             ( (Ascii(sChar)>=33) And (Ascii(sChar)<=47)) Or ;             ( (Ascii(sChar)>=58) And (Ascii(sChar)<=64)) Or ;             ( (Ascii(sChar)>=91) And (Ascii(sChar)<=96))    ;           ) Begin
36077>>>            Move 1      to rVal
36078>>>            Move 9999   to x
36079>>>        End
36079>>>>
36079>>>
36079>>>    Loop
36080>>>>
36080>>>    Function_Return rVal
36081>>>End_Function
36082>>>
36082>>>Function HasOneGreek string asPassw Returns Integer
36083>>>    Integer rVal
36084>>>    Integer iLength x
36084>>>    String  sChar
36084>>>    Move (Length(asPassw))  to iLength
36085>>>    Move 0                  to rVal
36086>>>    For x From 1 to iLength
36092>>>>
36092>>>        Move (Mid(asPassw,1,x)) to sChar
36093>>>        If ( ;             ((Ascii(ToAnsi(sChar))>=193) And (Ascii(ToAnsi(sChar))<=219)) Or ;             ((Ascii(ToAnsi(sChar))>=220) And (Ascii(ToAnsi(sChar))<=254))    ;           ) Begin
36095>>>            Move 1      to rVal
36096>>>            Move 9999   to x
36097>>>            Move sChar to gsMyStr
36098>>>        End
36098>>>>
36098>>>    Loop
36099>>>>
36099>>>    Function_Return rVal
36100>>>End_Function
36101>>>
36101>>>Function HasDuplicates String asPassw Returns Integer
36102>>>    Integer iLength x
36103>>>    String  s1 s2
36103>>>    Move (Length(asPassw)) to iLength
36104>>>    If (iLength > 2) Begin
36106>>>        For x From 1 to iLength
36112>>>>
36112>>>            Move (Mid(asPassw, 1, x  )) to s1
36113>>>            If ((x+1)<=iLength) ;                Move (Mid(asPassw, 1, x+1)) to s2
36116>>>            Else Function_Return 0
36118>>>            If (s1=s2) Begin
36120>>>                Move (s1+s2) to gsMyStr
36121>>>                Function_Return 1
36122>>>            End
36122>>>>
36122>>>        Loop
36123>>>>
36123>>>    End
36123>>>>
36123>>>    Function_Return 0
36124>>>End_Function
36125>>>
36125>>>Function HasInRow string asPassw Integer aiGreek Returns Integer
36126>>>    Integer rVal iNum
36127>>>    Integer iLength x
36127>>>    String  sChar  sChar2  sChar3  sSet1  sSet2
36127>>>    String  ssChar ssChar2 ssChar3 ssSet1 ssSet2
36127>>>    String  s1 s2 s3 s4 s5
36127>>>
36127>>>    Move (Length(asPassw))  to iLength
36128>>>    Move 0                  to rVal
36129>>>
36129>>>    Move "" to gsMyStr
36130>>>
36130>>>    For x From 1 to iLength
36136>>>>
36136>>>        Move 0 to iNum
36137>>>        // Keep 3 consecutive characters
36137>>>        Move (Mid(asPassw,1,x))                         to sChar
36138>>>        If ((x+1)<=iLength) Move (Mid(asPassw,1,x+1))   to sChar2
36141>>>        Else                Move 1                      to iNum
36143>>>        If ((x+2)<=iLength) Move (Mid(asPassw,1,x+2))   to sChar3
36146>>>        Else                Move 1                      to iNum
36148>>>
36148>>>        If (iNum=0) Begin
36150>>>            // check if same type of character (Numbers)
36150>>>            If ( ((Ascii(sChar )>=48) And (Ascii(sChar )<=57)) And ;                 ((Ascii(sChar2)>=48) And (Ascii(sChar2)<=57)) And ;                 ((Ascii(sChar3)>=48) And (Ascii(sChar3)<=57))     ;               ) Begin
36152>>>                If (    ((Integer(sChar3)-Integer(sChar2))=1) And ;                        ((Integer(sChar2)-Integer(sChar ))=1)     ;                   ) Begin
36154>>>                   Move 1       to rVal
36155>>>                   Move 9999    to x
36156>>>                   Move (sChar+sChar2+sChar3) to gsMyStr
36157>>>
36157>>>                End
36157>>>>
36157>>>                Else If (    ((Integer(sChar2)-Integer(sChar3))=1) And ;                             ((Integer(sChar )-Integer(sChar2))=1)     ;                        ) Begin
36160>>>                   Move 1       to rVal
36161>>>                   Move 9999    to x
36162>>>                   Move (sChar+sChar2+sChar3) to gsMyStr
36163>>>                End
36163>>>>
36163>>>            End
36163>>>>
36163>>>            // check if same type of character (Capital Letters)
36163>>>            Else Begin
36164>>>                Move "ABCDEFGHIJKLMNOPQRSTUVWXYZ"   to s1
36165>>>                Move "QWERTYUIOPASDFGHJKLZXCVBNM"   to s2
36166>>>                Move (UpperCase(sChar ))        to ssChar
36167>>>                Move (UpperCase(sChar2))        to ssChar2
36168>>>                Move (UpperCase(sChar3))        to ssChar3
36169>>>                Move (sChar +sChar2+sChar3)     to sSet1
36170>>>                Move (sChar3+sChar2+sChar )     to sSet2
36171>>>                Move (ssChar +ssChar2+ssChar3)  to ssSet1
36172>>>                Move (ssChar3+ssChar2+ssChar )  to ssSet2
36173>>>
36173>>>                If ( ((Ascii(ssChar )>=65) And (Ascii(ssChar )<=90)) And ;                     ((Ascii(ssChar2)>=65) And (Ascii(ssChar2)<=90)) And ;                     ((Ascii(ssChar3)>=65) And (Ascii(ssChar2)<=90))     ;                   ) Begin
36175>>>                    If ( (Pos(ssSet1,s1)>0) Or (Pos(ssSet2,s1)>0) Or ;                         (Pos(ssSet1,s2)>0) Or (Pos(ssSet2,s2)>0)  ) Begin
36177>>>                        Move 1      to rVal
36178>>>                        Move 9999   to x
36179>>>                        Move sSet1 to gsMyStr
36180>>>                    End
36180>>>>
36180>>>                End
36180>>>>
36180>>>            End
36180>>>>
36180>>>        End
36180>>>>
36180>>>    Loop
36181>>>>
36181>>>    Function_Return rVal
36182>>>End_Function
36183>>>
36183>>>
36183>>>Function HasPasswordProblems string asPassw Integer i8Char    Integer i2Same  Integer iOneCap ;                                            Integer iOneSmall Integer iOneNum Integer iOneSpe ;                                            Integer iGreek    Integer iSeira  Integer iBlanks Returns Integer
36184>>>    Integer iHasProblems
36185>>>    Move 0 to iHasProblems
36186>>>
36186>>>         If ((i8Char   =1) And (Length(asPassw)<8))                     Move 1 to iHasProblems
36189>>>    Else If ((i2Same   =1) And (HasDuplicates (Self,asPassw       )=1)) Move 2 to iHasProblems
36193>>>    Else If ((iGreek   =1) And (HasOneGreek   (Self,asPassw       )=1)) Move 7 to iHasProblems
36197>>>    Else If ((iBlanks  =1) And (Pos(" ",asPassw)>0))                    Move 9 to iHasProblems
36201>>>    Else If ((iOneCap  =1) And (HasOneCap     (Self,asPassw,iGreek)=0)) Move 3 to iHasProblems
36205>>>    Else If ((iOneSmall=1) And (HasOneSmall   (Self,asPassw,iGreek)=0)) Move 4 to iHasProblems
36209>>>    Else If ((iOneNum  =1) And (HasOneNumber  (Self,asPassw       )=0)) Move 5 to iHasProblems
36213>>>    Else If ((iOneSpe  =1) And (HasOneSpecial (Self,asPassw       )=0)) Move 6 to iHasProblems
36217>>>    Else If ((iSeira   =1) And (HasInRow      (Self,asPassw,iGreek)=1)) Move 8 to iHasProblems
36221>>>
36221>>>    Function_Return iHasProblems
36222>>>End_Function
36223>>>
36223>>>
36223>>>Function fsVerifyThePasswordValidity String asPassword Returns Integer
36224>>>    Integer rVal bState
36225>>>    String  lsTheAppPath sPassw sMess
36225>>>    Integer i1 i2 i3 i4 i5 i6 i7 i8 i9 iMax iDays iResult
36225>>>
36225>>>    Reread Sysrec
36229>>>    Unlock
36230>>>>
36230>>>
36230>>>    Move Sysrec.LIBCAST_CODE    to i1
36231>>>    Move Sysrec.AWARD_CODE      to i2
36232>>>    Move Sysrec.GIVAWRD_CODE    to i3
36233>>>    Move Sysrec.MOVIE_LNK_CODE  to i4
36234>>>    Move Sysrec.CAST_LNK_CODE   to i5
36235>>>    Move Sysrec.AWARDTP_CODE    to i6
36236>>>    Move Sysrec.FESTIVAL_CODE   to i7 // No Greek characters Hard Coded to 1
36237>>>    Move Sysrec.STWHAT_CODE     to i8
36238>>>    Move Sysrec.SNWHAT_CODE     to i9
36239>>>    Move Sysrec.LIBVIS_CODE     to iDays
36240>>>    Move Sysrec.TIKANEI_CODE    to iMax
36241>>>
36241>>>    Move "" to gsMyStr
36242>>>    Move 0  to iResult
36243>>>
36243>>>    Move (HasPasswordProblems(Self,asPassword,i1,i2,i3,i4,i5,i6,i7,i8,i9)) to iResult
36244>>>
36244>>>    Move gsMyStr        to sMess
36245>>>    Move (Trim(sMess))  to sMess
36246>>>
36246>>>         If (iResult=7) Send Stop_Box "ƒœ¤ œ§ «¨â§¦¤«˜  „¢¢ž¤ ¡¦å ®˜¨˜¡«ã¨œª"                   ("‘­á¢£˜ 1007  -> "+sMess+" <-")
36249>>>    Else If (iResult=1) Send Stop_Box "Ž ¡à› ¡æª §¨â§œ  ¤˜ œå¤˜  á¤à «à¤ 8 ®˜¨˜¡«ã¨à¤ "          "‘­á¢£˜ 1001"
36253>>>    Else If (iResult=2) Send Stop_Box "ƒœ¤ œ§ «¨â§¦¤«˜  2 å› ¦  ®˜¨˜¡«ã¨œª ›å§¢˜ ›å§¢˜"         ("‘­á¢£˜ 1002  -> "+sMess+" <-")
36257>>>    Else If (iResult=3) Send Stop_Box "Ž ¡à› ¡æª §¨â§œ  ¤˜ â®œ  «¦¬¢á® ©«¦¤ 1 ¡œ­˜¢˜å¦ š¨á££˜"   "‘­á¢£˜ 1003"
36261>>>    Else If (iResult=4) Send Stop_Box "Ž ¡à› ¡æª §¨â§œ  ¤˜ â®œ  «¦¬¢á® ©«¦¤ 1 §œæ š¨á££˜"       "‘­á¢£˜ 1004"
36265>>>    Else If (iResult=5) Send Stop_Box "Ž ¡à› ¡æª §¨â§œ  ¤˜ â®œ  «¦¬¢á® ©«¦¤ 1 ˜¨ Ÿ£æ"            "‘­á¢£˜ 1005"
36269>>>    Else If (iResult=6) Send Stop_Box "Ž ¡à› ¡æª §¨â§œ  ¤˜ â®œ  «¦¬¢á® ©«¦¤ 1 œ › ¡æ ®˜¨˜¡«ã¨˜"  "‘­á¢£˜ 1006"
36273>>>    Else If (iResult=8) Send Stop_Box "ƒœ¤ œ§ «¨â§¦¤«˜  §á¤à ˜§¦ 2 ©¬¤œ®æ£œ¤¦  ®˜¨˜¡«ã¨œª"      ("‘­á¢£˜ 1008  -> "+sMess+" <-")
36277>>>    Else If (iResult=9) Send Stop_Box "ƒœ¤ œ§ «¨â§¦¤«˜  ¡œ¤á ˜¤á£œ©˜ ©«¦¬ª ®˜¨˜¡«ã¨œª"           "‘­á¢£˜ 1009"
36281>>>
36281>>>
36281>>>    Function_return iResult
36282>>>End_function
36283>>>
36283>//--
36283>
36283>Use Connect.dg
INCLUDING FILE: CONNECT.DG
36283>>>//AB/ Project Connect
36283>>>//AB/     Object prj is a Dialog_Project
36283>>>//AB/         Set ProjectName to "Connect"
36283>>>//AB/         Set ProjectFileName to "Connect.dg"
36283>>>
36283>>>// Project Object Structure
36283>>>//   Connect is a BasicPanelSub
36283>>>//     frmUser is a FormSub
36283>>>//     frmKodikos is a FormSub
36283>>>//     CheckBox1 is a CheckBoxSub
36283>>>//     oOK_bn is a ButtonSub
36283>>>//     oCancel_bn is a ButtonSub
36283>>>//     Textbox5 is a TextBoxSub
36283>>>//     ComboForm2 is a ComboFormSub
36283>>>//     Textbox6 is a TextBoxSub
36283>>>//     Form4 is a FormSub
36283>>>//     Textbox7 is a TextBoxSub
36283>>>//     Textbox8 is a TextBoxSub
36283>>>//     BitmapContainerSub2 is a BitmapContainerSub
36283>>>
36283>>>// Register all objects
36283>>>Register_Object BitmapContainerSub2
36283>>>Register_Object CheckBox1
36283>>>Register_Object ComboForm2
36283>>>Register_Object Connect
36283>>>Register_Object Form4
36283>>>Register_Object frmKodikos
36283>>>Register_Object frmUser
36283>>>Register_Object oCancel_bn
36283>>>Register_Object oOK_bn
36283>>>Register_Object Textbox5
36283>>>Register_Object Textbox6
36283>>>Register_Object Textbox7
36283>>>Register_Object Textbox8
36283>>>
36283>>>
36283>>>
36283>>>    //AB-StoreTopStart
36283>>>                
36283>>>    Use mertech.inc
INCLUDING FILE: MERTECH.INC
36283>>>>>USE UI
36283>>>>>
#REM -----------------------------------------------
#REM MERTECH DATA SYSTEMS INC. - WWW.MERTECHDATA.COM
#REM MERTECH.INC VERSION 2.1.9
#REM -----------------------------------------------
36283>>>>>
36283>>>>>
36283>>>>>
36283>>>>>
36283>>>>>
36283>>>>>//
36283>>>>>//
36283>>>>>//
36283>>>>>//
36283>>>>>//
36283>>>>>//-----------------------------------------------
36283>>>>>// SELECT_COLUMNS_FIND <FILE> <START> THRU <END>
36283>>>>>// SELECT_COLUMNS_FIND <FILE> <FIELD>
36283>>>>>// This command will issue a properly commands to define the FETCH attribute status
36283>>>>>// for file fields.
36283>>>>>//
36283>>>>>//------------------------------------------------------------------------------
36283>>>>>// RESET_FETCH_FIELDS <FILE NAME>|<FILE NUMBER> <DF_FETCH_TRUE>|<DF_FETCH_FALSE>
36283>>>>>//
36283>>>>>//
36283>>>>>//-----------------------------
36283>>>>>// SQL_FOR_ONEROW <file number>
36283>>>>>//
36283>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get just
36283>>>>>// one ROW for each DataFlex FIND command issued
36283>>>>>// In this case the DBMS optimizer will generate a query with just one row
36283>>>>>//
36283>>>>>//
36283>>>>>//-------------------------------------------------------------------------------
36283>>>>>// SQL_FOR_SET <file number> MAXROWS <number of rows> CACHE|NOCACHE <return code>
36283>>>>>//
36283>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get a SET of rows.
36283>>>>>// In this case the DBMS optimizer will generate a query with <number of rows> Rows.
36283>>>>>// if CACHE is passed as argument, all these rows will be transfered to ORAFlex and then it will
36283>>>>>// save them in a local CACHE buffer. Just the FIND GT and FIND LT will get local cache.
36283>>>>>// Otherwise, i.e NOCACHE,  ORAFLex won't create a local cache.
36283>>>>>//
36283>>>>>//
36283>>>>>//---------------
36283>>>>>// SQL_SET <stmt>
36283>>>>>//
36283>>>>>//-----------------------------------------
36283>>>>>// SQL_APPEND <stmt1> <stmt2> .... <stmtn>
36283>>>>>//
36283>>>>>//------------
36283>>>>>// SQL_EXECUTE
36283>>>>>//
36283>>>>>//----------------------------------------------------------------------
36283>>>>>// LOCK_TABLE [<FILE NAME>|<FILE NUMBER> <FILE NAME>|<FILE NUMBER> ....]
36283>>>>>//
36283>>>>>// LOCK_TABLE will lock the entire table specified as an argument
36283>>>>>// This command will start a new transaction if it still wasn't done.
36283>>>>>// LOCK_TABLE won't lock the other opened tables or the current rows present
36283>>>>>// in their buffers it will be necessary issue a REREAD command to Lock the current
36283>>>>>// rows and then atualize their buffers
36283>>>>>//
36283>>>>>//
36283>>>>>//-------------------------------------------
36283>>>>>// SQL_CHECK_TABLE <SCHEMA NAME> <TABLE NAME>
36283>>>>>//
36283>>>>>//-------------------------------
36283>>>>>// CREATE_TD_FILE  DFTRUE|DFFALSE
36283>>>>>// SET A GLOBAL ATTRIBUTE TO CREATE THE TD FILE AFTER CLOSING AN OPENED FILE
36283>>>>>//
36283>>>>>//-------------------------------------------------
36283>>>>>// OPEN_INT <DATAFLEX FILE NAME>
36283>>>>>// OPEN_INT <PHYSICAL NAME> AS <DATAFLEX FILE NAME>
36283>>>>>//
36283>>>>>// OPEN_INT will check if the OPEN done is an OPEN AS. IF it's true, OPEN_INT
36283>>>>>// will try to open an intermediate file, if there is one. Otherwise OPEN_INT
36283>>>>>// will issue a OPEN command
36283>>>>>// OPEN_INT must be inserted into FMAC file instead OPEN COMMAND
36283>>>>>//
36283>>>>>//=========================================================================================================
36283>>>>>// SELECT STUFFS
36283>>>>>//--------------
36283>>>>>// SQL_SET_STMT OF FILENAME|FILENUMBER TO <STATMENT1>
36283>>>>>//
36283>>>>>// SQL_APPEND_ OF FILENAME|FILENUMBER TO <STATMENT1> <STATMENT2> ... <STATMENTn>
36283>>>>>//
36283>>>>>//
36283>>>>>// SQL_APPEND_UPDCOL_STMT OF FILENAME|FILENUMBER VALUE EXPRESSION WITH FIELD1 FIELD2 ... FIELDN
36283>>>>>//
36283>>>>>// SQL_PREPARE_STMT OF FILENAME|FILENUMBER
36283>>>>>//
36283>>>>>// SQL_BIND_COLUMN [FILENAME|FILENUMBER] [FIELDNAME|FIELDNUMBER]
36283>>>>>//
36283>>>>>// SQL_BINDCOLUMNS_STMT OF FILENAME|FILENUMBER TO <COLUMN1> <COLUMN2> ... <COLUMNn>
36283>>>>>//
36283>>>>>// SQL_EXECUTE_STMT OF FILENAME|FILENUMBER
36283>>>>>//
36283>>>>>// SQL_COMMIT_STMT
36283>>>>>//
36283>>>>>// SQL_ROLLBACK_STMT
36283>>>>>//
36283>>>>>// SQL_FETCH_NEXT_ROW OF FILENAME|FILENUMBER
36283>>>>>//
36283>>>>>//
36283>>>>>//
36283>>>>>//
36283>>>>>// CALL_STORED_PROCEDURE will call a stored procedure passing arguments
36283>>>>>//
36283>>>>>// FORMAT TO USE : CALL_STORED_PROCEDURE <STORED_PROC_NAME> [PASSING <ARG1> <ARG2> ....<ARGn>]
36283>>>>>//
36283>>>>>//
36283>>>>>//---------------------------------------------------------------------------------------------
36283>>>>>// CALL_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
36283>>>>>// CALL_STORED_FUNCTION will call an Oracle stored function passing arguments
36283>>>>>//
36283>>>>>//---------------------------
36283>>>>>// SQL_TEXT_MESSAGE <MESSAGE>
36283>>>>>// Writes a message inside driver log trace file if this is activated
36283>>>>>//
36283>>>>>//-----------------------------------------------------
36283>>>>>// OUTPUT_INT_FILE FOR <FILE NUMBER> TO <INT FILE NAME>
36283>>>>>// Generating the INT file
36283>>>>>//
36283>>>>>// -----------------------
36283>>>>>// SQL_ERROR_MESSAGE <VAR>
36283>>>>>// SQL_ERROR_MESSAGE retrieve the native error message issued by server for error number 25000
36283>>>>>
36283>>>>>
36283>>>>>//=======================================================================================
36283>>>>>// SQLFlex Commands
36283>>>>>//-----------------
36283>>>>>//
36283>>>>>//-----------------------
36283>>>>>// SQLFlex_REVISION <VAR>
36283>>>>>// Retrieves SQLFlex revision
36283>>>>>//
36283>>>>>//-------------------------------------
36283>>>>>// SET_DATABASE_NAME TO <DATABASE NAME>
36283>>>>>// Sets current database
36283>>>>>//
36283>>>>>//---------------------------
36283>>>>>// GET_DATABASE_NAME TO <VAR>
36283>>>>>// Gets name of current database
36283>>>>>//
36283>>>>>//----------------------------------
36283>>>>>// SET_SCHEMA_NAME TO <SCHEMA NAME>
36283>>>>>// Sets current schema name
36283>>>>>//
36283>>>>>//-------------------------
36283>>>>>// GET_SCHEMA_NAME TO <VAR>
36283>>>>>// Gets current schema name
36283>>>>>//
36283>>>>>//--------------------------------
36283>>>>>// SQL_USEDATABASE <DATABASE NAME>
36283>>>>>// Specifies the current Database
36283>>>>>//
36283>>>>>//----------------------------
36283>>>>>// SET_CURRENT_SERVER TO <VAR>
36283>>>>>// Set the current logged server
36283>>>>>//
36283>>>>>//----------------------------
36283>>>>>// GET_CURRENT_SERVER TO <VAR>
36283>>>>>// Retrieves the current logged server
36283>>>>>//
36283>>>>>//-----------------------------
36283>>>>>// SET_HOST_NAME TO <HOST NAME>
36283>>>>>// Defines current host name
36283>>>>>//
36283>>>>>//-----------------------
36283>>>>>// GET_HOST_NAME TO <VAR>
36283>>>>>// Retrieves the current host name
36283>>>>>//
36283>>>>>//---------------------------------------------------------------
36283>>>>>// LOGIN_SQLFLEX <SERVER NAME> <USER NAME> <PASSWORD> <HOST NAME>
36283>>>>>// Specifies host name during login process
36283>>>>>//
36283>>>>>// SQL_CANCEL_QUERY_STMT
36283>>>>>//
36283>>>>>//========================================
36283>>>>>// SQL SERVER Stored Procedure Call engine
36283>>>>>//----------------------------------------
36283>>>>>//
36283>>>>>//
36283>>>>>
36283>>>>>//
36283>>>>>//--------------------------------------------------------------------------------------------------------------
36283>>>>>// CALL_SQLSERVER_PROCEDURE <procedure name> PASSING <VALUE1|VARIABLE1> [SQLOUT] <VALUE2|VARIABLE2> [SQLOUT] ...
36283>>>>>//
36283>>>>>// Executes a stored procedure. SQLOUT will be used to indicate that the stored procedure
36283>>>>>// returns a parameter. The matching parameter in the stored proceudre must have been created with
36283>>>>>// the keyword OUTPUT. Call all procedures that doesn't returns any query with this syntax
36283>>>>>//
36283>>>>>//
36283>>>>>//
36283>>>>>//-----------------------------------------------------------------------------
36283>>>>>
36283>>>>>
36283>>>>>//=============================================================================
36283>>>>>// ORAFlex Commands
36283>>>>>//-----------------
36283>>>>>//----------------------------
36283>>>>>// ORAFlex_REVISION <VARIABLE>
36283>>>>>// Retrieves ORAFlex revision
36283>>>>>//
36283>>>>>//---------------------------------
36283>>>>>// KEEP_FILES_OPEN OF <SERVER NAME>
36283>>>>>// Keeps all files opened even during a LOGOUT
36283>>>>>//
36283>>>>>//-----------------------------------------------
36283>>>>>// SET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
36283>>>>>// Defines the maximum number of cursors that ORAFlex will be allowed for using
36283>>>>>//
36283>>>>>//-----------------------------------------------
36283>>>>>// GET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
36283>>>>>// Retrieves the maximum number of cursors allowed for ORAFlex use
36283>>>>>//
36283>>>>>//---------------------------------------------
36283>>>>>// GET_OPENED_CURSORS OF <SERVER NAME> TO <VAR>
36283>>>>>// Retrieves the number of opened cursors
36283>>>>>//
36283>>>>>//-----------------------------------------------
36283>>>>>// ACTIVATE_TIME_STAMP OF <SERVER NAME> TO ON|OFF
36283>>>>>// Activates Time stamp for date columns
36283>>>>>//
36283>>>>>//----------------------------------------------------------------------------------------------------
36283>>>>>// CALL_ORACLE_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
36283>>>>>// CALL_ORACLE_STORED_FUNCTION will call an Oracle stored function passing arguments
36283>>>>>//
36283>>>>>//-----------------------------------------------------------------------------
36283>>>>>
36283>>>>>//=============================================================================
36283>>>>>// BUFFER save stuffs
36283>>>>>//-------------------
36283>>>>>
36283>>>>>//-------------------------------------------------------
36283>>>>>// SQL_SAVE_BUFFER_BEGIN OF <FILE NUMBER> TO <CACHE SIZE>
36283>>>>>// Initialize the BUFFER buffer
36283>>>>>//
36283>>>>>//---------------------------------
36283>>>>>// SQL_SAVE_BUFFER OF <FILE NUMBER>
36283>>>>>// Moves field buffer values to cache buffer
36283>>>>>//-------------------------------------
36283>>>>>// SQL_SAVE_BUFFER_END OF <FILE NUMBER>
36283>>>>>// Save rows that remains in cache
36283>>>>>//-----------------------------------------------------------------------------
36283>>>>>
36283>>>    //Use FlexOle
36283>>>    //Use ChilkatCrypt
36283>>>    
36283>>>    Open UsersH
36285>>>    
36285>>>    
36285>>>    //AB-StoreTopEnd
36285>>>
36285>>>    //AB-IgnoreStart
36285>>>
36285>>>    Use Panel.Sub
36285>>>    Use Form.Sub
36285>>>    Use Chkbox.Sub
36285>>>    Use Button.Sub
36285>>>    Use Txtbox.Sub
36285>>>    Use Cmbfrm.Sub
36285>>>    Use Bitmap.Sub
36285>>>
36285>>>
36285>>>    //AB-IgnoreEnd
36285>>>
36285>>>    Object Connect is a BasicPanelSub
36287>>>
36287>>>        //AB-StoreTopStart
36287>>>        
36287>>>        
36287>>>        //AB-StoreTopEnd
36287>>>
36287>>>        Set Sysmenu_Icon to FALSE
36288>>>        Set Minimize_Icon to FALSE
36289>>>        Set Label to "„§ ™œ™˜åà©ž ‘«¦ ®œåà¤ •¨ã©«ž"
36290>>>        Set Size to 84 340
36291>>>        Set Location to 17 12
36292>>>        Set Color to 13688273
36293>>>
36293>>>        //AB-DDOStart
36293>>>
36293>>>
36293>>>        //AB-DDOEnd
36293>>>
36293>>>        Object frmUser is a FormSub
36295>>>            Set Size to 13 163
36296>>>            Set Location to 12 118
36297>>>            Set Label_Col_Offset to 2
36298>>>            Set Label_Justification_Mode to jMode_Right
36299>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
36300>>>        End_Object    // frmUser
36301>>>
36301>>>        Object frmKodikos is a FormSub
36303>>>
36303>>>            //AB-StoreTopStart
36303>>>                                                                                                            
36303>>>            //AB-StoreTopEnd
36303>>>
36303>>>            Set Size to 13 163
36304>>>            Set Location to 36 118
36305>>>            Set Label_Col_Offset to 2
36306>>>            Set Label_Justification_Mode to jMode_Right
36307>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
36308>>>
36308>>>            //AB-StoreStart
36308>>>                                                                                                            
36308>>>            Set Password_State Item 0 to True
36309>>>            
36309>>>            
36309>>>            
36309>>>            
36309>>>            //AB-StoreEnd
36309>>>
36309>>>        End_Object    // frmKodikos
36310>>>
36310>>>        Object CheckBox1 is a CheckBoxSub
36312>>>
36312>>>            //AB-StoreTopStart
36312>>>                                    
36312>>>            //AB-StoreTopEnd
36312>>>
36312>>>            Set Label to "€§¦Ÿã¡œ¬©ž ‰à› ¡¦ç"
36313>>>            Set Size to 10 88
36314>>>            Set Location to 57 118
36315>>>            Set Status_Help to "Remember The Password at Next Login"
36316>>>            Set Color to 15395562
36317>>>
36317>>>            //AB-StoreStart
36317>>>                                    
36317>>>            Set Checked_State to False
36318>>>            Set Visible_State to False
36319>>>            
36319>>>            
36319>>>            //AB-StoreEnd
36319>>>
36319>>>        End_Object    // CheckBox1
36320>>>
36320>>>        Object oOK_bn is a ButtonSub
36322>>>
36322>>>            //AB-StoreTopStart
36322>>>                                                                                                            
36322>>>            //AB-StoreTopEnd
36322>>>
36322>>>            Set Label to "Co&nnect"
36323>>>            Set Default_State to TRUE
36324>>>            Set Bitmap to "Login-233.bmp"
36325>>>            Set Size to 26 28
36326>>>            Set Location to 7 296
36327>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
36328>>>
36328>>>            //AB-StoreStart
36328>>>                                                                                                            
36328>>>            Set tooltipvalue to "„ˆ‘ŽƒŽ‘ ‘’†Œ „”€‹Ž‚†"
36329>>>            
36329>>>            
36329>>>            Procedure OnClick
36331>>>                Set LoginOk to True
36332>>>                Send Stop_Modal_ui
36333>>>            End_Procedure
36334>>>            
36334>>>            Set Status_Help to "‘ç¤›œ©ž / „å©¦›¦ª"
36335>>>            
36335>>>            
36335>>>            //AB-StoreEnd
36335>>>
36335>>>        End_Object    // oOK_bn
36336>>>
36336>>>        Object oCancel_bn is a ButtonSub
36338>>>            Set Label to "&Cancel"
36339>>>            Set Bitmap to "Exit-233.bmp"
36340>>>            Set Size to 26 28
36341>>>            Set Location to 40 297
36342>>>            Set Focus_Mode to Pointer_Only
36343>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
36344>>>
36344>>>            //AB-StoreStart
36344>>>                                                                                                            
36344>>>            Set tooltipvalue to "„ŽƒŽ‘ €Ž ’†Œ „”€‹Ž‚†"
36345>>>            
36345>>>            ON_KEY KENTER SEND Exit_Application to (Connect(Current_Object))
36346>>>            
36346>>>            Procedure OnClick
36348>>>                Set LoginOk to False
36349>>>                Send Exit_Application to (Connect(Current_Object))
36350>>>            End_Procedure
36351>>>            
36351>>>            Set Status_Help to "€¡ç¨à©ž / „¥¦›¦ª"
36352>>>            
36352>>>            
36352>>>            
36352>>>            
36352>>>            //AB-StoreEnd
36352>>>
36352>>>        End_Object    // oCancel_bn
36353>>>
36353>>>        Object Textbox5 is a TextBoxSub
36355>>>            Set Label to "Ž›žšæª"
36356>>>            Set Color to 13688273
36357>>>            Set FontSize to 4 0
36358>>>            Set Location to 79 83
36359>>>            Set Size to 10 44
36360>>>            Set Justification_Mode to jMode_Left
36361>>>            Set TypeFace to "MS Sans Serif"
36362>>>            Set Enabled_State to TRUE
36363>>>        End_Object    // Textbox5
36364>>>
36364>>>        Object ComboForm2 is a ComboFormSub
36366>>>
36366>>>            //AB-StoreTopStart
36366>>>                                                                                                            
36366>>>            Set CapsLock_State to True
36367>>>            
36367>>>            //AB-StoreTopEnd
36367>>>
36367>>>            Set Size to 13 175
36368>>>            Set Location to 79 136
36369>>>            Set Label_Col_Offset to 2
36370>>>            Set Label_Justification_Mode to jMode_Right
36371>>>
36371>>>            //AB-StoreStart
36371>>>                                                                                                            
36371>>>            Set Enabled_State to False
36372>>>            Set Visible_State to False
36373>>>            
36373>>>            Procedure Combo_Fill_List
36375>>>                    Local String Availdrv## TempDrv##
36376>>>                    Local Integer HowMany i p1## p2##
36376>>>            
36376>>>                    get_profile_string "WorkSpaces" "CurrentWorkspace" to AvailDrv##
36379>>>                    If AvailDrv## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to AvailDrv##
36382>>>                    insert "WorkSpaces\" in AvailDrv## at 1
36384>>>                    get_profile_string AvailDrv## "AvailableDrivers" to AvailDrv##
36387>>>            
36387>>>                    Move Availdrv## to Tempdrv##
36388>>>                    Repeat
36388>>>>
36388>>>                        Replace "|" in Tempdrv## With ""
36390>>>                        [Found] Increment HowMany
36391>>>                    Until [Finderr]
36393>>>            
36393>>>                    Send Combo_add_Item ""
36394>>>            
36394>>>                    If HowMany lt 1 Begin
36396>>>                        If Availdrv## ne "" Send Combo_Add_Item (UpperCase(Availdrv##))
36399>>>                    End
36399>>>>
36399>>>                    Else Begin
36400>>>                        For i From 0 to HowMany
36406>>>>
36406>>>                            If i eq 0 Move 1 to p1##
36409>>>                            Else Begin
36410>>>                                Move ((Pos("|",Availdrv##))+1) to p1##
36411>>>                                Replace "|" in Availdrv## With ","
36413>>>                            End
36413>>>>
36413>>>                            Move ((Pos("|",Availdrv##))) to p2##
36414>>>                            Send Combo_Add_Item (UpperCase(Mid(Availdrv##,(p2##-p1##),p1##)))
36415>>>                        Loop
36416>>>>
36416>>>                    End
36416>>>>
36416>>>            End_Procedure
36417>>>            
36417>>>            Set Allow_Blank_state to True
36418>>>            
36418>>>            
36418>>>            
36418>>>            
36418>>>            
36418>>>            //AB-StoreEnd
36418>>>
36418>>>        End_Object    // ComboForm2
36419>>>
36419>>>        Object Textbox6 is a TextBoxSub
36421>>>            Set Label to "ƒ ˜¡¦£ ©«ãª"
36422>>>            Set Color to 13688273
36423>>>            Set FontSize to 4 0
36424>>>            Set Location to 66 -21787
36425>>>            Set Size to 10 44
36426>>>            Set Justification_Mode to jMode_Left
36427>>>            Set TypeFace to "MS Sans Serif"
36428>>>            Set Enabled_State to TRUE
36429>>>        End_Object    // Textbox6
36430>>>
36430>>>        Object Form4 is a FormSub
36432>>>
36432>>>            //AB-StoreTopStart
36432>>>                                                                                                            
36432>>>            //AB-StoreTopEnd
36432>>>
36432>>>            Set Size to 13 175
36433>>>            Set Location to 71 116
36434>>>            Set Label_Col_Offset to 2
36435>>>            Set Label_Justification_Mode to jMode_Right
36436>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
36437>>>
36437>>>            //AB-StoreStart
36437>>>                                                                                                            
36437>>>                                                                                                            
36437>>>            Set Enabled_State to False
36438>>>            Set Visible_State to False
36439>>>            
36439>>>            
36439>>>            //AB-StoreEnd
36439>>>
36439>>>        End_Object    // Form4
36440>>>
36440>>>        Object Textbox7 is a TextBoxSub
36442>>>            Set Label to "•¨ã©«žª"
36443>>>            Set Color to 13688273
36444>>>            Set FontSize to 4 0
36445>>>            Set Location to 14 81
36446>>>            Set Size to 10 33
36447>>>            Set Justification_Mode to jMode_Left
36448>>>            Set TypeFace to "MS Sans Serif"
36449>>>            Set Enabled_State to TRUE
36450>>>        End_Object    // Textbox7
36451>>>
36451>>>        Object Textbox8 is a TextBoxSub
36453>>>            Set Label to "‰à› ¡æª"
36454>>>            Set Color to 13688273
36455>>>            Set FontSize to 4 0
36456>>>            Set Location to 37 81
36457>>>            Set Size to 10 33
36458>>>            Set Justification_Mode to jMode_Left
36459>>>            Set TypeFace to "MS Sans Serif"
36460>>>            Set Enabled_State to TRUE
36461>>>        End_Object    // Textbox8
36462>>>
36462>>>        Object BitmapContainerSub2 is a BitmapContainerSub
36464>>>            Set Size to 60 71
36465>>>            Set Location to 6 4
36466>>>            Set Bitmap to "Protem-233.bmp"
36467>>>            Set Border_Style to Border_None
36468>>>            Set Bitmap_Style to Bitmap_Stretch
36469>>>        End_Object    // BitmapContainerSub2
36470>>>
36470>>>
36470>>>        //AB-StoreStart
36470>>>        
36470>>>        Set Modal_State to True
36471>>>        
36471>>>        ON_KEY KENTER SEND OnClick to (oOk_bn(Current_Object))
36472>>>        ON_KEY KSAVE_RECORD SEND OK
36473>>>        ON_KEY KCANCEL SEND EXIT_APPLICATION
36474>>>        ON_KEY KCLOSE_PANEL SEND EXIT_APPLICATION
36475>>>        
36475>>>        Set Locate_Mode to Center_On_Screen
36476>>>        Set Exit_Application_Local_State to False
36477>>>        Set Exit_MSG to Exit
36478>>>        Set Description_State to True
36479>>>        
36479>>>        Property Integer LoginOk public false
36481>>>        
36481>>>        External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;            Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
36482>>>        
36482>>>        Function Network_User_Name Returns String
36484>>>            Local String sName sLength
36485>>>            Local Pointer lpName_Addr lpLength_Addr
36485>>>            Local Integer iRetval
36485>>>        
36485>>>            Movestr (Repeat (Character (0), 255)) To sName
36486>>>>
36486>>>            GetAddress Of sName To lpName_Addr
36487>>>            Movestr (DwordToBytes (255)) To sLength
36488>>>>
36488>>>            GetAddress Of sLength To lpLength_Addr
36489>>>        
36489>>>            Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
36490>>>>
36490>>>        
36490>>>            If iRetval Eq 0 Function_Return (CString (sName))
36493>>>            Else Function_Return "User Unknown"
36495>>>        End_Function // Network_User_Name
36496>>>        
36496>>>        
36496>>>        //Object oCrypt is a dbOLEChilkatCrypt2
36496>>>        //End_Object
36496>>>        
36496>>>        //Function fsEncryptOrDecryptMyString Integer aiEncryptOrDecrypt String asText Returns String
36496>>>        //    String password sReturnText
36496>>>        //    Move "" to sReturnText
36496>>>        
36496>>>        //    //------------------------------------------------------------------------
36496>>>        //    // „«¦ £˜©œ « ª §˜¨˜£œ«¨¦¬ª š ˜ «¦ encryption / decryption
36496>>>        //    //------------------------------------------------------------------------
36496>>>        //    SET ChilkatCrypt2CryptAlgorithm Of oCrypt to "ARC4" //"aes"
36496>>>        //    SET ChilkatCrypt2CipherMode     Of oCrypt to "cbc"
36496>>>        //    SET ChilkatCrypt2KeyLength      Of oCrypt to  16
36496>>>        //    Move "YannisSecretPhrase"                 to password
36496>>>        //    //  Generate a binary secret key from a password string
36496>>>        //    //  of any length.  For 128-bit encryption, GenEncodedSecretKey
36496>>>        //    //  generates the MD5 hash of the password and returns it
36496>>>        //    //  in the encoded form requested.  The 2nd param can be
36496>>>        //    //  "hex", "base64", "url", "quoted-printable", etc.
36496>>>        //    String hexKey
36496>>>        //    Get ChilkatCrypt2GenEncodedSecretKey    Of oCrypt password "hex" to hexKey
36496>>>        //    Send ChilkatCrypt2SetEncodedKey         Of oCrypt hexKey   "hex"
36496>>>        //    SET ChilkatCrypt2EncodingMode           Of oCrypt                to "base32"
36496>>>        //    //------------------------------------------------------------------------
36496>>>        //    // „«¦ £˜©œ « ª §˜¨˜£œ«¨¦¬ª š ˜ «¦ encryption / decryption
36496>>>        //    //------------------------------------------------------------------------
36496>>>        
36496>>>        //    If (aiEncryptOrDecrypt=1) Begin
36496>>>        //        // Encrypt a string and return the binary encrypted data
36496>>>        //        //  in a base-64 encoded string.
36496>>>        //        Get ChilkatCrypt2EncryptStringENC Of oCrypt asText to sReturnText
36496>>>        //    End
36496>>>        //    Else If (aiEncryptOrDecrypt=2) Begin
36496>>>        //        //  Decrypt and show the original string:
36496>>>        //        Get ChilkatCrypt2DecryptStringENC Of oCrypt asText to sReturnText
36496>>>        //    End
36496>>>        //    Function_Return sReturnText
36496>>>        //End_Function
36496>>>        
36496>>>        
36496>>>        Procedure Activating
36498>>>            Local String LoginDriver## LoginServer## LoginUserid## LoginPassword##
36499>>>            Local String LastLogin## LoginSeq##
36499>>>            Local Integer SavePassword##
36499>>>        
36499>>>            Forward Send Activating
36501>>>        
36501>>>            Set Value of frmUser    Item 0 to ""
36502>>>            Set Value of frmKodikos Item 0 to ""
36503>>>        
36503>>>        //---------------
36503>>>        // REM 14/11/2011
36503>>>        //    get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
36503>>>        //    If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
36503>>>        //    insert "WorkSpaces\" in LastLogin## at 1
36503>>>        //    Append LastLogin## "\" (Module_Name(Self)) "\LastLogin"
36503>>>        //    get_profile_string LastLogin## "LoginDriver" to LoginSeq##
36503>>>        
36503>>>            Move "DATAFLEX|SQL_DRV.DLL|DATAFLEX"    to LoginSeq##
36504>>>            Move ""                                 to LoginServer##
36505>>>        
36505>>>            If "|" in LoginSeq## move (left(LoginSeq##,(pos("|",LoginSeq##) -1)))   to LoginDriver##
36508>>>            Else Move LoginSeq##                                                    to LoginDriver##
36510>>>        
36510>>>        //    get_profile_string LastLogin## "LoginServer"  to LoginServer##
36510>>>        //    get_profile_string LastLogin## "LoginUserId"  to LoginUserId##
36510>>>        //    get_profile_string LastLogin## "SavePassword" to SavePassword##
36510>>>        
36510>>>        //    If LoginUserId## eq "" Move (Network_User_Name(Current_Object)) to LoginUserId##
36510>>>        
36510>>>            If (((UpperCase(LoginDriver##)) eq "DATAFLEX") or (LoginDriver## eq "")) Begin
36512>>>                    Set Value of (ComboForm2(Current_Object)) Item 0 to ""
36513>>>                    Set Value of (Form4(Current_Object))      Item 0 to ""
36514>>>            End
36514>>>>
36514>>>            Else Begin
36515>>>                Set Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
36516>>>                Set Value of (Form4(Current_Object))      Item 0 to LoginServer##
36517>>>            End
36517>>>>
36517>>>        
36517>>>        //    Set Value of (frmUser(Current_Object))          Item 0 to LoginUserID##
36517>>>        //    Set Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
36517>>>        
36517>>>        //    If (SavePassword##) Begin
36517>>>        //        Set_Registry_Root TO HKEY_CURRENT_USER "Software"
36517>>>        //        get_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to LoginPassword##
36517>>>        
36517>>>        //        // 28/07/2011
36517>>>        //        //Set Value of (frmKodikos(Self)) Item 0 to LoginPassword##
36517>>>        
36517>>>        //        Clear Users
36517>>>        //        Move LoginUserId## to Users.Login_ID
36517>>>        //        Find Eq Users by Index.1
36517>>>        //        If (Trim(Users.Password)<>"") Set Value of (frmKodikos(Self)) Item 0 to (fsCryptoNew(Self,"Decrypt",LoginPassword##))
36517>>>        //        Else                          Set Value of (frmKodikos(Self)) Item 0 to ""
36517>>>        
36517>>>        //        // 28/07/2011 REM until we finish the securities
36517>>>        //        //Set Value of (frmKodikos(Self)) Item 0 to (fsCrypto(Self,"Backward",LoginPassword##))
36517>>>        //                                                  //(fsEncryptOrDecryptMyString(Self,2,LoginPassword##))
36517>>>        
36517>>>        //        SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
36517>>>        //    End
36517>>>        End_Procedure
36518>>>        
36518>>>        Function LoginUser Returns Integer
36520>>>            Integer SavePassword## Size## PasswordOk success
36521>>>            String LoginDriver## LoginServer## LoginUserid## LoginPassword## LoginSeq## LastLogin##
36521>>>            String lsLoginDate lsHH lsMM lsSS sDepartment
36521>>>            Integer liOpenCursors
36521>>>            String sUsrP
36521>>>            //String sDeCryptoPassw
36521>>>        
36521>>>            Send Popup_Modal
36522>>>        
36522>>>            // Trexei thn Activating kai meta epanerxetai edo
36522>>>        
36522>>>            //Send Activate Of oCrypt
36522>>>            //Get ChilkatCrypt2UnlockComponent Of oCrypt "Crypt12345678_4CC88148VHXA" to success
36522>>>        
36522>>>            //Get Checked_State Of CheckBox1 to SavePassword##
36522>>>        
36522>>>            //If (SavePassword##) Begin
36522>>>            //    Set_Registry_Root TO HKEY_CURRENT_USER "Software"
36522>>>            //    get_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to LoginPassword##
36522>>>            //    Set Value of (frmKodikos(Current_Object)) Item 0 to (fsEncryptOrDecryptMyString(Self,2,LoginPassword##))
36522>>>            //    SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
36522>>>            //End
36522>>>        
36522>>>            Get Value of (ComboForm2(Current_Object))       Item 0 to LoginDriver##
36523>>>            Get Value of (Form4(Current_Object))            Item 0 to LoginServer##
36524>>>        
36524>>>            Get Value of (frmUser(Current_Object))          Item 0 to LoginUserID##
36525>>>            Get Value of (frmKodikos(Current_Object))       Item 0 to LoginPassword##
36526>>>        
36526>>>            Get Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
36527>>>        
36527>>>            //---------------
36527>>>            // REM 14/11/2011
36527>>>            //Set Value of (frmKodikos(Current_Object))       Item 0 to ""
36527>>>                get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
36530>>>                If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
36533>>>                insert "WorkSpaces\" in LastLogin## at 1
36535>>>                Append LastLogin## "\" (Module_Name(Self))
36537>>>                Append LastLogin## "\LastLogin"
36538>>>                set_profile_string LastLogin## "LoginUserId" to LoginUserId##
36541>>>            //---------------
36541>>>            // REM 14/11/2011
36541>>>        
36541>>>        
36541>>>            If ((LoginDriver## <> "") and (UpperCase(LoginDriver##)<>"DATAFLEX"))  begin
36543>>>                Set LoginOk to True
36544>>>            End
36544>>>>
36544>>>            Else Begin
36545>>>                Set LoginOk to True
36546>>>                Open "Users" as Users
36548>>>                Move "DATAFLEX" To LoginDriver##
36549>>>                Move "" to LoginServer##
36550>>>                File_Size Users to Size##
36553>>>                If Size## ne 0 Begin
36555>>>                     Clear Users
36556>>>                     Move LoginUSerId##   to Users.Login_Id
36557>>>                     Find eq Users by Index.1
36558>>>>
36558>>>                     [Finderr] Begin
36560>>>>
36560>>>                        Error 9001 "Ž ®¨ã©«žª œå¤˜  áš¤à©«¦ª"
36561>>>>
36561>>>                        Set LoginOk to False
36562>>>                        Get LoginOk to PasswordOk
36563>>>                        Function_Return PasswordOk
36564>>>                     End
36564>>>>
36564>>>        
36564>>>                     [Found] Begin
36566>>>>
36566>>>        
36566>>>        
36566>>>                        // Yannis 09/03/2017
36566>>>                        If (Users.Admin_Rights=1) Begin
36568>>>                            Move 1 to iHasAPassword
36569>>>                            Move Users.Departm_Code  to sDepartment
36570>>>                            Move (Trim(sDepartment)) to sDepartment
36571>>>                            Goto NowOK
36572>>>>
36572>>>                        End
36572>>>>
36572>>>        
36572>>>        
36572>>>                        If (Users.Anenergos="1") Begin
36574>>>                            Move 1 to iAnenergos
36575>>>                            Error 9669 "Ž ®¨ã©«žª œå¤˜  ˜¤œ¤œ¨šæª"
36576>>>>
36576>>>                            Move 1 to iHasAPassword
36577>>>                            Set LoginOk to False
36578>>>                            Get LoginOk to PasswordOk
36579>>>                            Function_Return PasswordOk
36580>>>                        End
36580>>>>
36580>>>        
36580>>>                        Move (Trim(Users.Password)) to sUsrP
36581>>>        
36581>>>                        // 28/07/2011 REM until we finish the securities
36581>>>                        Move (fsCryptoNew(Self,"Decrypt",sUsrP))  to sUsrP
36582>>>        
36582>>>                        //If ((LoginPassword## <> sUsrP) And (Trim(sUsrP)<>"")) Begin
36582>>>                        If (LoginPassword## <> sUsrP) Begin
36584>>>                            Error 9002 "Ž ¡à› ¡æª œå¤˜  ¢˜¤Ÿ˜©£â¤¦ª"
36585>>>>
36585>>>                            Move 1 to iHasAPassword
36586>>>                            Set LoginOk to False
36587>>>                            Get LoginOk to PasswordOk
36588>>>                            Function_Return PasswordOk
36589>>>                        End
36589>>>>
36589>>>        //                Else If ((LoginPassword## <> sUsrP) And (Trim(LoginPassword##)<>"") And (Trim(sUsrP)<>"")) Begin
36589>>>        //                    Error 9002 "Ž ¡à› ¡æª œå¤˜  ¢˜¤Ÿ˜©£â¤¦ª"
36589>>>        //                    Move 1 to iHasAPassword
36589>>>        //                    Set LoginOk to False
36589>>>        //                    Get LoginOk to PasswordOk
36589>>>        //                    Function_Return PasswordOk
36589>>>        //                End
36589>>>                        Else Begin
36590>>>                            //If (LoginPassword## = sUsrP) Begin
36590>>>                            //And (Trim(LoginPassword##)<>"")) OR ;
36590>>>                            //      ((LoginPassword##=sUsrP) And (Trim(LoginPassword##) ="")) Begin
36590>>>                            Date dShmera
36590>>>                            String sHH sMM sSS sTime
36590>>>                            Sysdate dShmera sHH sMM sSS
36594>>>                            Move (Trim(sHH)) to sHH
36595>>>                            Move (Trim(sMM)) to sMM
36596>>>                            Move (Trim(sSS)) to sSS
36597>>>                            If (Length(sHH)=1) Insert '0' in sHH at 1
36601>>>                            If (Length(sMM)=1) Insert '0' in sMM at 1
36605>>>                            If (Length(sSS)=1) Insert '0' in sSS at 1
36609>>>                            Move (sHH+":"+sMM+"."+sSS) to sTime
36610>>>        
36610>>>                            Reread Users
36614>>>        
36614>>>                            If (Users.Next_Change<>"") Begin
36616>>>                                Reread Sysrec
36620>>>                                Unlock
36621>>>>
36621>>>                                Move (Users.Next_Change<dShmera) to iMustResetPass
36622>>>                            End
36622>>>>
36622>>>        
36622>>>                            Move dShmera                    to Users.Last_Login_Date
36623>>>                            Move sTime                      to Users.Last_Login_Time
36624>>>        
36624>>>                            If ((iMustResetPass) Or (Trim(sUsrP)="")) Begin
36626>>>        
36626>>>                                If (Trim(Users.Password)<>"") ;                                    Move Users.Password to Users.Last_Password
36629>>>        
36629>>>                                //Move ""                 to Users.Password
36629>>>                                Move ""                 to sUsrP
36630>>>        
36630>>>                                Send Info_Box "Ž › á¨¡œ ˜ «¦¬ §¨¦žš¦ç£œ¤¦¬ ¡à› ¡¦ç §˜¨ã¢Ÿœ\n¨â§œ  ¤˜ ¡˜«˜®à¨ã©œ«œ ¤œ¦ ¡à› ¡æ œ ©æ›¦¬" "¢ž¨¦­¦¨å˜"
36631>>>        
36631>>>        
36631>>>                                Saverecord Users
36632>>>                                Unlock
36633>>>>
36633>>>        
36633>>>                                Move 0 to iHasAPassword
36634>>>                                Set LoginOk to False
36635>>>                                Get LoginOk to PasswordOk
36636>>>                                Function_Return PasswordOk
36637>>>        
36637>>>                            End
36637>>>>
36637>>>                            Saverecord Users
36638>>>                            Unlock
36639>>>>
36639>>>                            //End
36639>>>                        End
36639>>>>
36639>>>                        Move (Trim(sUsrP)<>"")   to iHasAPassword
36640>>>                        Move Users.Departm_Code  to sDepartment
36641>>>                        Move (Trim(sDepartment)) to sDepartment
36642>>>        
36642>>>                        NowOK:
36642>>>                     End
36642>>>>
36642>>>                End
36642>>>>
36642>>>                Close Users
36643>>>            End
36643>>>>
36643>>>        
36643>>>            Open Users
36645>>>            File_Size Users to Size##
36648>>>            If Size## ne 0 Begin
36650>>>                Clear Users
36651>>>                Move LoginUSerId##   to Users.Login_Id
36652>>>                Find eq Users by Index.1
36653>>>>
36653>>>                [Finderr] Begin
36655>>>>
36655>>>                    Error 9003 "Ž ®¨ã©«žª œå¤˜  áš¤à©«¦ª"
36656>>>>
36656>>>                    Set LoginOk to False
36657>>>                    Get LoginOk to PasswordOk
36658>>>                    Function_Return PasswordOk
36659>>>                 End
36659>>>>
36659>>>                 [Found] Begin
36661>>>>
36661>>>        
36661>>>                        // Yannis 09/03/2017
36661>>>                        If (Users.Admin_Rights=1) Begin
36663>>>                            Goto NowOK2
36664>>>>
36664>>>                            Move 1 to iHasAPassword
36665>>>                            Move Users.Departm_Code  to sDepartment
36666>>>                            Move (Trim(sDepartment)) to sDepartment
36667>>>                            //Function_Return PasswordOk
36667>>>                        End
36667>>>>
36667>>>        
36667>>>                    Move (Trim(Users.Password)) to sUsrP
36668>>>        
36668>>>                    // 28/07/2011 REM until we finish the securities
36668>>>                    Move (fsCryptoNew(Self,"Decrypt",sUsrP))  to sUsrP
36669>>>        
36669>>>                    If ((LoginPassword## <> sUsrP) And (Trim(LoginPassword##)<>"")) Begin
36671>>>                        Error 9002 "Ž ¡à› ¡æª œå¤˜  ¢˜¤Ÿ˜©£â¤¦ª"
36672>>>>
36672>>>                        Move 1 to iHasAPassword
36673>>>                        Set LoginOk to False
36674>>>                        Get LoginOk to PasswordOk
36675>>>                        Function_Return PasswordOk
36676>>>                    End
36676>>>>
36676>>>                    Else Begin
36677>>>                        If ((LoginPassword## = sUsrP) And (Trim(LoginPassword##)<>"")) Begin
36679>>>                                Sysdate dShmera sHH sMM sSS
36683>>>                                Move (Trim(sHH)) to sHH
36684>>>                                Move (Trim(sMM)) to sMM
36685>>>                                Move (Trim(sSS)) to sSS
36686>>>                                If (Length(sHH)=1) Insert '0' in sHH at 1
36690>>>                                If (Length(sMM)=1) Insert '0' in sMM at 1
36694>>>                                If (Length(sSS)=1) Insert '0' in sSS at 1
36698>>>                                Move (sHH+":"+sMM+"."+sSS) to sTime
36699>>>        
36699>>>                                Reread Users
36703>>>        
36703>>>                                If (Users.Next_Change<>"") Begin
36705>>>                                    Reread Sysrec
36709>>>                                    Unlock
36710>>>>
36710>>>                                    Move (Users.Next_Change<dShmera) to iMustResetPass
36711>>>                                End
36711>>>>
36711>>>        
36711>>>                                Move dShmera                    to Users.Last_Login_Date
36712>>>                                Move sTime                      to Users.Last_Login_Time
36713>>>        
36713>>>                                If (iMustResetPass) Begin
36715>>>        
36715>>>                                    If (Trim(Users.Password)<>"") ;                                        Move Users.Password to Users.Last_Password
36718>>>        
36718>>>                                    Move ""                 to Users.Password
36719>>>                                    Move ""                 to sUsrP
36720>>>                                End
36720>>>>
36720>>>        
36720>>>                                Saverecord Users
36721>>>                                Unlock
36722>>>>
36722>>>        
36722>>>                        End
36722>>>>
36722>>>                    End
36722>>>>
36722>>>                    Move (Trim(sUsrP)<>"")   to iHasAPassword
36723>>>                    Move Users.Departm_Code  to sDepartment
36724>>>                    Move (Trim(sDepartment)) to sDepartment
36725>>>        
36725>>>                    NowOK2:
36725>>>                End
36725>>>>
36725>>>            End
36725>>>>
36725>>>            Close Users
36726>>>        
36726>>>            Get LoginOk to PasswordOk
36727>>>            Sysdate lsLoginDate lsHH lsMM lsSS
36731>>>            get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
36734>>>            If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
36737>>>            insert "WorkSpaces\" in LastLogin## at 1
36739>>>            get_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
36742>>>            If ((LoginDriver## ne "") and ((UpperCase(LoginDriver##)) ne "DATAFLEX")) Begin
36744>>>               If Not LoginDriver## in LoginSeq## Begin
36746>>>                     If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
36749>>>                     Else Move (LoginSeq##+"|"+LoginDriver##) to LoginSeq##
36751>>>                     set_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
36754>>>               End
36754>>>>
36754>>>            End
36754>>>>
36754>>>            Append LastLogin## "\" (Module_Name(Self))
36756>>>            Append LastLogin## "\LastLogin"
36757>>>            get_profile_string LastLogin## "LoginDriver" to LoginSeq##
36760>>>        
36760>>>            If "|" in LoginSeq## Begin
36762>>>                If ((left(LoginSeq##,(pos("|",LoginSeq##) -1))) ne LoginDriver##) Insert (LoginDriver##+"|") in LoginSeq## at 1
36766>>>            End
36766>>>>
36766>>>            Else Begin
36767>>>                If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
36770>>>                Else If LoginSeq## ne LoginDriver## Insert (LoginDriver##+"|") in LoginSeq## at 1
36775>>>            End
36775>>>>
36775>>>            Left LoginSeq## to LoginSeq## 250
36777>>>>
36777>>>            set_profile_string LastLogin## "LoginDriver" to (UpperCase(LoginSeq##))
36780>>>            set_profile_string LastLogin## "LoginServer" to LoginServer##
36783>>>            set_profile_string LastLogin## "LoginUserId" to LoginUserId##
36786>>>            set_profile_string LastLogin## "SavePassword" to SavePassword##
36789>>>            If lsHH lt 10 Insert 0 in lsHH at 1
36793>>>            If lsMM lt 10 Insert 0 in lsMM at 1
36797>>>            If lsSS lt 10 Insert 0 in lsSS at 1
36801>>>            Append lsLoginDate " - " lsHH ":" lsMM ":" lsSS
36807>>>            set_profile_string LastLogin## "LoginTime" to lsLoginDate
36810>>>            If (SavePassword##) Begin
36812>>>                Set_Registry_Root TO HKEY_CURRENT_USER "Software"
36813>>>        
36813>>>                // 28/07/2011 REM until we finish the securities and cryptography
36813>>>                //set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to LoginPassword##
36813>>>                set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to (fsCryptoNew(Self,"Encrypt",LoginPassword##))
36816>>>        
36816>>>                SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
36817>>>            End
36817>>>>
36817>>>            Else Begin
36818>>>                Set_Registry_Root TO HKEY_CURRENT_USER "Software"
36819>>>                set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to ""
36822>>>                SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
36823>>>            End
36823>>>>
36823>>>        
36823>>>            Function_Return PasswordOk
36824>>>        End_Function
36825>>>        
36825>>>        
36825>>>        Procedure Login For Desktop
36826>>>            Local Integer LoginPassword##
36827>>>        
36827>>>            Add 1 to iMetrhthsProsp
36828>>>        
36828>>>            Get LoginUser of (Connect(Current_Object)) to LoginPassword##
36829>>>        
36829>>>            If Not LoginPassword## Move 99 to iApotel // 30-08-2011  Send Exit_Application
36832>>>        End_Procedure
36833>>>        
36833>>>        Function CheckLogin For Desktop Returns Integer
36834>>>            Local Integer LoginPassword##
36835>>>            Get LoginUser of (Connect(Current_Object)) to LoginPassword##
36836>>>            Function_Return LoginPassword##
36837>>>        End_Function
36838>>>        
36838>>>        
36838>>>        
36838>>>        
36838>>>        //AB-StoreEnd
36838>>>
36838>>>    End_Object    // Connect
36839>>>
36839>>>
36839>>>    //AB-StoreStart
36839>>>                
36839>>>                
36839>>>                
36839>>>                
36839>>>                
36839>>>                
36839>>>                
36839>>>    //AB-StoreEnd
36839>>>
36839>>>//AB/     End_Object    // prj
36839>//use checkafm.pkg
36839>//use checklog.pkg
36839>
36839>Open Sysrec
36841>Open Users
36843>Open UsersH
36845>Open Usergrps
36847>
36847>Reread Sysrec
36851>Unlock
36852>Move Sysrec.TIKANEI_CODE    to iMax00
36853>Move 1                      to iMetrhthsProsp
36854>
36854>Use PASSDLG2.DG
INCLUDING FILE: PASSDLG2.DG
36854>>>//AB/ Project Password Dialog
36854>>>//AB/     Object prj is a Dialog_Project
36854>>>//AB/         Set ProjectName to "Password Dialog"
36854>>>//AB/         Set ProjectFileName to "PASSDLG2.DG"
36854>>>
36854>>>// Project Object Structure
36854>>>//   oNewPassDlg is a ModalPanelSub
36854>>>//     ConfirmPassForm is a FormSub
36854>>>//     NewPassForm is a FormSub
36854>>>//     NewPassForm2 is a FormSub
36854>>>//     oOK_bn is a ButtonSub
36854>>>//     TextBox_EZ1 is a TextBoxSub
36854>>>//     TextBox_EZ2 is a TextBoxSub
36854>>>//     TextBox_EZ3 is a TextBoxSub
36854>>>//     oCancel_bn is a ButtonSub
36854>>>//     chkLengthOverEight is a CheckBoxSub
36854>>>//     chk3Consecutive is a CheckBoxSub
36854>>>//     chkAtLeast1Upper is a CheckBoxSub
36854>>>//     chkAtLeast1Lower is a CheckBoxSub
36854>>>//     chkAtLeast1Number is a CheckBoxSub
36854>>>//     chkAtLeast1Special is a CheckBoxSub
36854>>>//     chkNoGreek is a CheckBoxSub
36854>>>//     chkSeiriakous is a CheckBoxSub
36854>>>//     chkBlanks is a CheckBoxSub
36854>>>//     TextBoxSub4 is a TextBoxSub
36854>>>//     TextBoxSub5 is a TextBoxSub
36854>>>//     TextBoxSub6 is a TextBoxSub
36854>>>//     TextBoxSub7 is a TextBoxSub
36854>>>//     TextBoxSub8 is a TextBoxSub
36854>>>//     TextBoxSub9 is a TextBoxSub
36854>>>//     TextBoxSub10 is a TextBoxSub
36854>>>//     TextBoxSub11 is a TextBoxSub
36854>>>//     TextBoxSub12 is a TextBoxSub
36854>>>//     TextBoxSub13 is a TextBoxSub
36854>>>//     TextBoxSub14 is a TextBoxSub
36854>>>//     TextBoxSub15 is a TextBoxSub
36854>>>//     TextBoxSub16 is a TextBoxSub
36854>>>//     txt1 is a TextBoxSub
36854>>>//     txt2 is a TextBoxSub
36854>>>//     txt3 is a TextBoxSub
36854>>>//     txt4 is a TextBoxSub
36854>>>//     txt5 is a TextBoxSub
36854>>>//     txt6 is a TextBoxSub
36854>>>//     txt7 is a TextBoxSub
36854>>>//     txt8 is a TextBoxSub
36854>>>//     txt9 is a TextBoxSub
36854>>>//     ButtonSub1 is a ButtonSub
36854>>>
36854>>>// Register all objects
36854>>>Register_Object ButtonSub1
36854>>>Register_Object ConfirmPassForm
36854>>>Register_Object chk3Consecutive
36854>>>Register_Object chkAtLeast1Lower
36854>>>Register_Object chkAtLeast1Number
36854>>>Register_Object chkAtLeast1Special
36854>>>Register_Object chkAtLeast1Upper
36854>>>Register_Object chkBlanks
36854>>>Register_Object chkLengthOverEight
36854>>>Register_Object chkNoGreek
36854>>>Register_Object chkSeiriakous
36854>>>Register_Object NewPassForm
36854>>>Register_Object NewPassForm2
36854>>>Register_Object oCancel_bn
36854>>>Register_Object oNewPassDlg
36854>>>Register_Object oOK_bn
36854>>>Register_Object TextBox_EZ1
36854>>>Register_Object TextBox_EZ2
36854>>>Register_Object TextBox_EZ3
36854>>>Register_Object TextBoxSub10
36854>>>Register_Object TextBoxSub11
36854>>>Register_Object TextBoxSub12
36854>>>Register_Object TextBoxSub13
36854>>>Register_Object TextBoxSub14
36854>>>Register_Object TextBoxSub15
36854>>>Register_Object TextBoxSub16
36854>>>Register_Object TextBoxSub4
36854>>>Register_Object TextBoxSub5
36854>>>Register_Object TextBoxSub6
36854>>>Register_Object TextBoxSub7
36854>>>Register_Object TextBoxSub8
36854>>>Register_Object TextBoxSub9
36854>>>Register_Object txt1
36854>>>Register_Object txt2
36854>>>Register_Object txt3
36854>>>Register_Object txt4
36854>>>Register_Object txt5
36854>>>Register_Object txt6
36854>>>Register_Object txt7
36854>>>Register_Object txt8
36854>>>Register_Object txt9
36854>>>
36854>>>
36854>>>
36854>>>    //AB-StoreTopStart
36854>>>                
36854>>>    Open Sysrec
36856>>>    Open Users
36858>>>    Open UsersH
36860>>>    
36860>>>    //Use FlexOle
36860>>>    //Use ChilkatCrypt
36860>>>    
36860>>>    //AB-StoreTopEnd
36860>>>
36860>>>    //AB-IgnoreStart
36860>>>
36860>>>    Use Panel.Sub
36860>>>    Use Form.Sub
36860>>>    Use Button.Sub
36860>>>    Use Txtbox.Sub
36860>>>    Use Chkbox.Sub
36860>>>
36860>>>
36860>>>    //AB-IgnoreEnd
36860>>>
36860>>>    Object oNewPassDlg is a ModalPanelSub
36862>>>
36862>>>        //AB-StoreTopStart
36862>>>        
36862>>>        Property String     psOldPassword   Public ""
36864>>>        Property String     psNewPassword   Public ""
36866>>>        Property String     piCanceled      Public False
36868>>>        Property String     piState         Public 0
36870>>>        Property Integer    piPasswordState Public 1
36872>>>        
36872>>>        Enum_List
36872>>>            Define All_Ok           // 0
36872>>>            Define Canceled         // 1
36872>>>            Define Same_Password    // 2
36872>>>            Define Wrong_Password   // 3
36872>>>            Define Not_Match        // 4
36872>>>            Define No_Password      // 5
36872>>>            Define Wrong_Prev_Passw // 6
36872>>>            Define Already_Used     // 7
36872>>>        End_Enum_List
36872>>>        
36872>>>        //AB-StoreTopEnd
36872>>>
36872>>>        Set Minimize_Icon to FALSE
36873>>>        Set Label to "€¢¢˜šã ‰à› ¡¦ç ¨æ©™˜©žª"
36874>>>        Set Size to 233 387
36875>>>        Set Location to 9 31
36876>>>        Set Color to 13688273
36877>>>        Set Popup_State to TRUE
36878>>>
36878>>>        //AB-DDOStart
36878>>>
36878>>>
36878>>>        //AB-DDOEnd
36878>>>
36878>>>        Object ConfirmPassForm is a FormSub
36880>>>
36880>>>            //AB-StoreTopStart
36880>>>                                                        
36880>>>            //AB-StoreTopEnd
36880>>>
36880>>>            Set Size to 13 110
36881>>>            Set Location to 14 157
36882>>>            Set Label_Col_Offset to 2
36883>>>            Set Label_Justification_Mode to jMode_Right
36884>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
36885>>>
36885>>>            //AB-StoreStart
36885>>>                                                        
36885>>>            Set Password_State to True
36886>>>            
36886>>>            //AB-StoreEnd
36886>>>
36886>>>        End_Object    // ConfirmPassForm
36887>>>
36887>>>        Object NewPassForm is a FormSub
36889>>>
36889>>>            //AB-StoreTopStart
36889>>>                                                        
36889>>>            //AB-StoreTopEnd
36889>>>
36889>>>            Set Size to 13 110
36890>>>            Set Location to 34 157
36891>>>            Set Label_Col_Offset to 2
36892>>>            Set Label_Justification_Mode to jMode_Right
36893>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
36894>>>
36894>>>            //AB-StoreStart
36894>>>                                                        
36894>>>            Set Password_State to True
36895>>>            
36895>>>            Procedure OnChange
36897>>>            
36897>>>                Integer rVal bState i1 i2 i3 i4 i5 i6 i7 i8 i9 iDays iMax iHasProblems
36898>>>                Integer iHasProblems1 iHasProblems2 iHasProblems3 iHasProblems4 iHasProblems5
36898>>>                Integer iHasProblems6 iHasProblems7 iHasProblems8 iHasProblems9
36898>>>                String  asPassw
36898>>>            
36898>>>                Move 0 to iHasProblems1
36899>>>                Move 0 to iHasProblems2
36900>>>                Move 0 to iHasProblems3
36901>>>                Move 0 to iHasProblems4
36902>>>                Move 0 to iHasProblems5
36903>>>                Move 0 to iHasProblems6
36904>>>                Move 0 to iHasProblems7
36905>>>                Move 0 to iHasProblems8
36906>>>                Move 0 to iHasProblems9
36907>>>            
36907>>>                Get Value Item 0 to asPassw
36908>>>                Move (Trim(asPassw)) to asPassw
36909>>>            
36909>>>                Reread Sysrec
36913>>>                Unlock
36914>>>>
36914>>>                Move Sysrec.LIBCAST_CODE    to i1
36915>>>                Move Sysrec.AWARD_CODE      to i2
36916>>>                Move Sysrec.GIVAWRD_CODE    to i3
36917>>>                Move Sysrec.MOVIE_LNK_CODE  to i4
36918>>>                Move Sysrec.CAST_LNK_CODE   to i5
36919>>>                Move Sysrec.AWARDTP_CODE    to i6
36920>>>                Move Sysrec.FESTIVAL_CODE   to i7 // No Greek characters Hard Coded to 1
36921>>>                Move Sysrec.STWHAT_CODE     to i8
36922>>>                Move Sysrec.SNWHAT_CODE     to i9
36923>>>            
36923>>>                If ((i1=1) And (Length(asPassw)<8))                Move 1 to iHasProblems1
36926>>>                If ((i2=1) And (HasDuplicates (Self,asPassw  )=1)) Move 1 to iHasProblems2
36929>>>                If ((i3=1) And (HasOneCap     (Self,asPassw,1)=0)) Move 1 to iHasProblems3
36932>>>                If ((i4=1) And (HasOneSmall   (Self,asPassw,1)=0)) Move 1 to iHasProblems4
36935>>>                If ((i5=1) And (HasOneNumber  (Self,asPassw  )=0)) Move 1 to iHasProblems5
36938>>>                If ((i6=1) And (HasOneSpecial (Self,asPassw  )=0)) Move 1 to iHasProblems6
36941>>>                If ((i7=1) And (HasOneGreek   (Self,asPassw  )=1)) Move 1 to iHasProblems7
36944>>>                If ((i8=1) And (HasInRow      (Self,asPassw,1)=1)) Move 1 to iHasProblems8
36947>>>                If ((i9=1) And (Pos(" ",asPassw)>0))               Move 1 to iHasProblems9
36950>>>            
36950>>>                If (iHasProblems1=1) Set TextColor Of txt1 to clRed
36953>>>                Else                 Set TextColor Of txt1 to clBlack
36955>>>            
36955>>>                If (iHasProblems2=1) Set TextColor Of txt2 to clRed
36958>>>                Else                 Set TextColor Of txt2 to clBlack
36960>>>            
36960>>>                If (iHasProblems3=1) Set TextColor Of txt3 to clRed
36963>>>                Else                 Set TextColor Of txt3 to clBlack
36965>>>            
36965>>>                If (iHasProblems4=1) Set TextColor Of txt4 to clRed
36968>>>                Else                 Set TextColor Of txt4 to clBlack
36970>>>            
36970>>>                If (iHasProblems5=1) Set TextColor Of txt5 to clRed
36973>>>                Else                 Set TextColor Of txt5 to clBlack
36975>>>            
36975>>>                If (iHasProblems6=1) Set TextColor Of txt6 to clRed
36978>>>                Else                 Set TextColor Of txt6 to clBlack
36980>>>            
36980>>>                If (iHasProblems7=1) Set TextColor Of txt7 to clRed
36983>>>                Else                 Set TextColor Of txt7 to clBlack
36985>>>            
36985>>>                If (iHasProblems8=1) Set TextColor Of txt8 to clRed
36988>>>                Else                 Set TextColor Of txt8 to clBlack
36990>>>            
36990>>>                If (iHasProblems9=1) Set TextColor Of txt9 to clRed
36993>>>                Else                 Set TextColor Of txt9 to clBlack
36995>>>            
36995>>>            
36995>>>            End_Procedure
36996>>>            
36996>>>            
36996>>>            
36996>>>            //AB-StoreEnd
36996>>>
36996>>>        End_Object    // NewPassForm
36997>>>
36997>>>        Object NewPassForm2 is a FormSub
36999>>>
36999>>>            //AB-StoreTopStart
36999>>>                                                        
36999>>>            //AB-StoreTopEnd
36999>>>
36999>>>            Set Size to 13 110
37000>>>            Set Location to 49 157
37001>>>            Set Label_Col_Offset to 2
37002>>>            Set Label_Justification_Mode to jMode_Right
37003>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
37004>>>
37004>>>            //AB-StoreStart
37004>>>                                                        
37004>>>            Set Password_State to True
37005>>>            
37005>>>            //AB-StoreEnd
37005>>>
37005>>>        End_Object    // NewPassForm2
37006>>>
37006>>>        Object oOK_bn is a ButtonSub
37008>>>
37008>>>            //AB-StoreTopStart
37008>>>                                                        
37008>>>            //AB-StoreTopEnd
37008>>>
37008>>>            Set Label to "€§¦›¦®ã"
37009>>>            Set Default_State to TRUE
37010>>>            Set Location to 70 217
37011>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
37012>>>
37012>>>            //AB-StoreStart
37012>>>                                                        
37012>>>            Procedure OnClick
37014>>>                Set piState to All_Ok
37015>>>                Delegate Send Stop_Modal_UI
37017>>>            End_Procedure
37018>>>            
37018>>>            
37018>>>            
37018>>>            
37018>>>            
37018>>>            
37018>>>            
37018>>>            
37018>>>            
37018>>>            
37018>>>            //AB-StoreEnd
37018>>>
37018>>>        End_Object    // oOK_bn
37019>>>
37019>>>        Object TextBox_EZ1 is a TextBoxSub
37021>>>            Set Label to "˜¢ æª ‰à› ¡æª"
37022>>>            Set Auto_Size_State to FALSE
37023>>>            Set Color to 13688273
37024>>>            Set FontSize to 4 0
37025>>>            Set Location to 14 51
37026>>>            Set Size to 13 85
37027>>>            Set TypeFace to "MS Sans Serif"
37028>>>            Set Enabled_State to TRUE
37029>>>        End_Object    // TextBox_EZ1
37030>>>
37030>>>        Object TextBox_EZ2 is a TextBoxSub
37032>>>            Set Label to "Œâ¦ª ‰à› ¡æª"
37033>>>            Set Color to 13688273
37034>>>            Set FontSize to 4 0
37035>>>            Set Location to 35 51
37036>>>            Set Size to 10 63
37037>>>            Set TypeFace to "MS Sans Serif"
37038>>>            Set Enabled_State to TRUE
37039>>>        End_Object    // TextBox_EZ2
37040>>>
37040>>>        Object TextBox_EZ3 is a TextBoxSub
37042>>>            Set Label to "Œâ¦ª ‰à› ¡æª („§ ™œ™˜åà©ž)"
37043>>>            Set Color to 13688273
37044>>>            Set FontSize to 4 0
37045>>>            Set Location to 50 51
37046>>>            Set Size to 10 98
37047>>>            Set TypeFace to "MS Sans Serif"
37048>>>            Set Enabled_State to TRUE
37049>>>        End_Object    // TextBox_EZ3
37050>>>
37050>>>        Object oCancel_bn is a ButtonSub
37052>>>
37052>>>            //AB-StoreTopStart
37052>>>                                                        
37052>>>            //AB-StoreTopEnd
37052>>>
37052>>>            Set Label to "€¡ç¨à©ž"
37053>>>            Set Location to 70 157
37054>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
37055>>>
37055>>>            //AB-StoreStart
37055>>>                                                        
37055>>>            Procedure OnClick
37057>>>                Set piState to Canceled
37058>>>                Delegate Send Stop_Modal_UI
37060>>>            End_Procedure
37061>>>            
37061>>>            
37061>>>            
37061>>>            
37061>>>            //AB-StoreEnd
37061>>>
37061>>>        End_Object    // oCancel_bn
37062>>>
37062>>>        Object chkLengthOverEight is a CheckBoxSub
37064>>>
37064>>>            //AB-StoreTopStart
37064>>>                                                        
37064>>>            //AB-StoreTopEnd
37064>>>
37064>>>            Set Size to 10 11
37065>>>            Set Location to 116 7
37066>>>            Set Checked_State to TRUE
37067>>>            Set Enabled_State to FALSE
37068>>>            Set Item_Shadow_State Item 0 to TRUE
37069>>>            Set Shadow_State Item 0 to TRUE
37070>>>
37070>>>            //AB-StoreStart
37070>>>                                                        
37070>>>            Procedure OnChange
37072>>>                Integer isChecked
37073>>>                String lsTheAppPath
37073>>>                Get Checked_State                                       To isChecked
37074>>>                Move (GetTheAppPath(Self))                              To lsTheAppPath
37075>>>                Set_Profile_String lsTheAppPath "Passw_LengthOverEight" To isChecked
37078>>>            End_Procedure
37079>>>            
37079>>>            
37079>>>            
37079>>>            //AB-StoreEnd
37079>>>
37079>>>        End_Object    // chkLengthOverEight
37080>>>
37080>>>        Object chk3Consecutive is a CheckBoxSub
37082>>>
37082>>>            //AB-StoreTopStart
37082>>>                                                        
37082>>>            //AB-StoreTopEnd
37082>>>
37082>>>            Set Size to 10 11
37083>>>            Set Location to 127 7
37084>>>            Set Checked_State to TRUE
37085>>>            Set Enabled_State to FALSE
37086>>>            Set Item_Shadow_State Item 0 to TRUE
37087>>>            Set Shadow_State Item 0 to TRUE
37088>>>
37088>>>            //AB-StoreStart
37088>>>                                                        
37088>>>            Procedure OnChange
37090>>>                Integer isChecked
37091>>>                String lsTheAppPath
37091>>>                Get Checked_State                                   To isChecked
37092>>>                Move (GetTheAppPath(Self))                          To lsTheAppPath
37093>>>                Set_Profile_String lsTheAppPath "Passw_3Consecutive"          To isChecked
37096>>>            End_Procedure
37097>>>            
37097>>>            
37097>>>            
37097>>>            //AB-StoreEnd
37097>>>
37097>>>        End_Object    // chk3Consecutive
37098>>>
37098>>>        Object chkAtLeast1Upper is a CheckBoxSub
37100>>>
37100>>>            //AB-StoreTopStart
37100>>>                                                        
37100>>>            //AB-StoreTopEnd
37100>>>
37100>>>            Set Size to 10 11
37101>>>            Set Location to 138 7
37102>>>            Set Checked_State to TRUE
37103>>>            Set Enabled_State to FALSE
37104>>>            Set Item_Shadow_State Item 0 to TRUE
37105>>>            Set Shadow_State Item 0 to TRUE
37106>>>
37106>>>            //AB-StoreStart
37106>>>                                                        
37106>>>            Procedure OnChange
37108>>>                Integer isChecked
37109>>>                String lsTheAppPath
37109>>>                Get Checked_State                                   To isChecked
37110>>>                Move (GetTheAppPath(Self))                          To lsTheAppPath
37111>>>                Set_Profile_String lsTheAppPath "Passw_AtLeast1Upper"          To isChecked
37114>>>            End_Procedure
37115>>>            
37115>>>            
37115>>>            
37115>>>            //AB-StoreEnd
37115>>>
37115>>>        End_Object    // chkAtLeast1Upper
37116>>>
37116>>>        Object chkAtLeast1Lower is a CheckBoxSub
37118>>>
37118>>>            //AB-StoreTopStart
37118>>>                                                        
37118>>>            //AB-StoreTopEnd
37118>>>
37118>>>            Set Size to 10 11
37119>>>            Set Location to 150 7
37120>>>            Set Checked_State to TRUE
37121>>>            Set Enabled_State to FALSE
37122>>>            Set Item_Shadow_State Item 0 to TRUE
37123>>>            Set Shadow_State Item 0 to TRUE
37124>>>
37124>>>            //AB-StoreStart
37124>>>                                                        
37124>>>            Procedure OnChange
37126>>>                Integer isChecked
37127>>>                String lsTheAppPath
37127>>>                Get Checked_State                                   To isChecked
37128>>>                Move (GetTheAppPath(Self))                          To lsTheAppPath
37129>>>                Set_Profile_String lsTheAppPath "Passw_AtLeast1Lower"          To isChecked
37132>>>            End_Procedure
37133>>>            
37133>>>            
37133>>>            
37133>>>            //AB-StoreEnd
37133>>>
37133>>>        End_Object    // chkAtLeast1Lower
37134>>>
37134>>>        Object chkAtLeast1Number is a CheckBoxSub
37136>>>
37136>>>            //AB-StoreTopStart
37136>>>                                                        
37136>>>            //AB-StoreTopEnd
37136>>>
37136>>>            Set Size to 10 11
37137>>>            Set Location to 161 7
37138>>>            Set Checked_State to TRUE
37139>>>            Set Enabled_State to FALSE
37140>>>            Set Item_Shadow_State Item 0 to TRUE
37141>>>            Set Shadow_State Item 0 to TRUE
37142>>>
37142>>>            //AB-StoreStart
37142>>>                                                        
37142>>>            Procedure OnChange
37144>>>                Integer isChecked
37145>>>                String lsTheAppPath
37145>>>                Get Checked_State                                   To isChecked
37146>>>                Move (GetTheAppPath(Self))                          To lsTheAppPath
37147>>>                Set_Profile_String lsTheAppPath "Passw_AtLeast1Number"          To isChecked
37150>>>            End_Procedure
37151>>>            
37151>>>            
37151>>>            
37151>>>            //AB-StoreEnd
37151>>>
37151>>>        End_Object    // chkAtLeast1Number
37152>>>
37152>>>        Object chkAtLeast1Special is a CheckBoxSub
37154>>>
37154>>>            //AB-StoreTopStart
37154>>>                                                        
37154>>>            //AB-StoreTopEnd
37154>>>
37154>>>            Set Size to 10 11
37155>>>            Set Location to 172 7
37156>>>            Set Checked_State to TRUE
37157>>>            Set Enabled_State to FALSE
37158>>>            Set Item_Shadow_State Item 0 to TRUE
37159>>>            Set Shadow_State Item 0 to TRUE
37160>>>
37160>>>            //AB-StoreStart
37160>>>                                                        
37160>>>            Procedure OnChange
37162>>>                Integer isChecked
37163>>>                String lsTheAppPath
37163>>>                Get Checked_State                                   To isChecked
37164>>>                Move (GetTheAppPath(Self))                          To lsTheAppPath
37165>>>                Set_Profile_String lsTheAppPath "Passw_AtLeast1Special"          To isChecked
37168>>>            End_Procedure
37169>>>            
37169>>>            
37169>>>            
37169>>>            //AB-StoreEnd
37169>>>
37169>>>        End_Object    // chkAtLeast1Special
37170>>>
37170>>>        Object chkNoGreek is a CheckBoxSub
37172>>>
37172>>>            //AB-StoreTopStart
37172>>>                                                        
37172>>>            //AB-StoreTopEnd
37172>>>
37172>>>            Set Size to 10 11
37173>>>            Set Location to 182 7
37174>>>            Set Checked_State to TRUE
37175>>>            Set Enabled_State to FALSE
37176>>>            Set Item_Shadow_State Item 0 to TRUE
37177>>>            Set Shadow_State Item 0 to TRUE
37178>>>
37178>>>            //AB-StoreStart
37178>>>                                                        
37178>>>                                                        
37178>>>                                                        
37178>>>                                                        
37178>>>                                                        
37178>>>                                                        
37178>>>            //AB-StoreEnd
37178>>>
37178>>>        End_Object    // chkNoGreek
37179>>>
37179>>>        Object chkSeiriakous is a CheckBoxSub
37181>>>
37181>>>            //AB-StoreTopStart
37181>>>                                                        
37181>>>            //AB-StoreTopEnd
37181>>>
37181>>>            Set Size to 10 11
37182>>>            Set Location to 193 7
37183>>>            Set Checked_State to TRUE
37184>>>            Set Enabled_State to FALSE
37185>>>            Set Item_Shadow_State Item 0 to TRUE
37186>>>            Set Shadow_State Item 0 to TRUE
37187>>>
37187>>>            //AB-StoreStart
37187>>>                                                        
37187>>>            Procedure OnChange
37189>>>                Integer isChecked
37190>>>                String lsTheAppPath
37190>>>                Get Checked_State                                   To isChecked
37191>>>                Move (GetTheAppPath(Self))                          To lsTheAppPath
37192>>>                Set_Profile_String lsTheAppPath "Passw_Seiriakous"          To isChecked
37195>>>            End_Procedure
37196>>>            
37196>>>            
37196>>>            
37196>>>            //AB-StoreEnd
37196>>>
37196>>>        End_Object    // chkSeiriakous
37197>>>
37197>>>        Object chkBlanks is a CheckBoxSub
37199>>>
37199>>>            //AB-StoreTopStart
37199>>>                                                        
37199>>>            //AB-StoreTopEnd
37199>>>
37199>>>            Set Size to 10 11
37200>>>            Set Location to 204 7
37201>>>            Set Checked_State to TRUE
37202>>>            Set Enabled_State to FALSE
37203>>>            Set Item_Shadow_State Item 0 to TRUE
37204>>>            Set Shadow_State Item 0 to TRUE
37205>>>
37205>>>            //AB-StoreStart
37205>>>                                                        
37205>>>            Procedure OnChange
37207>>>                Integer isChecked
37208>>>                String lsTheAppPath
37208>>>                Get Checked_State                                   To isChecked
37209>>>                Move (GetTheAppPath(Self))                          To lsTheAppPath
37210>>>                Set_Profile_String lsTheAppPath "Passw_Blanks"          To isChecked
37213>>>            End_Procedure
37214>>>            
37214>>>            
37214>>>            
37214>>>            //AB-StoreEnd
37214>>>
37214>>>        End_Object    // chkBlanks
37215>>>
37215>>>        Object TextBoxSub4 is a TextBoxSub
37217>>>            Set Label to "________________________"
37218>>>            Set Color to 13688273
37219>>>            Set Location to 191 257
37220>>>            Set Size to 10 32
37221>>>            Set Justification_Mode to jMode_Left
37222>>>            Set TypeFace to "MS Sans Serif"
37223>>>        End_Object    // TextBoxSub4
37224>>>
37224>>>        Object TextBoxSub5 is a TextBoxSub
37226>>>            Set Label to "_________________________"
37227>>>            Set Color to 13688273
37228>>>            Set Location to 170 193
37229>>>            Set Size to 10 94
37230>>>            Set Justification_Mode to jMode_Left
37231>>>            Set TypeFace to "MS Sans Serif"
37232>>>        End_Object    // TextBoxSub5
37233>>>
37233>>>        Object TextBoxSub6 is a TextBoxSub
37235>>>            Set Label to "_________________________________"
37236>>>            Set Color to 13688273
37237>>>            Set Location to 159 158
37238>>>            Set Size to 10 129
37239>>>            Set Justification_Mode to jMode_Left
37240>>>            Set TypeFace to "MS Sans Serif"
37241>>>        End_Object    // TextBoxSub6
37242>>>
37242>>>        Object TextBoxSub7 is a TextBoxSub
37244>>>            Set Label to "____________________________"
37245>>>            Set Color to 13688273
37246>>>            Set Location to 148 191
37247>>>            Set Size to 10 97
37248>>>            Set Justification_Mode to jMode_Left
37249>>>            Set TypeFace to "MS Sans Serif"
37250>>>        End_Object    // TextBoxSub7
37251>>>
37251>>>        Object TextBoxSub8 is a TextBoxSub
37253>>>            Set Label to "_______________________________________________"
37254>>>            Set Color to 13688273
37255>>>            Set Location to 138 207
37256>>>            Set Size to 10 82
37257>>>            Set Justification_Mode to jMode_Left
37258>>>            Set TypeFace to "MS Sans Serif"
37259>>>        End_Object    // TextBoxSub8
37260>>>
37260>>>        Object TextBoxSub9 is a TextBoxSub
37262>>>            Set Label to "______________"
37263>>>            Set Color to 13688273
37264>>>            Set Location to 126 249
37265>>>            Set Size to 10 41
37266>>>            Set Justification_Mode to jMode_Center
37267>>>            Set TypeFace to "MS Sans Serif"
37268>>>        End_Object    // TextBoxSub9
37269>>>
37269>>>        Object TextBoxSub10 is a TextBoxSub
37271>>>            Set Label to "(˜˜, LL, 44...)"
37272>>>            Set Color to 13688273
37273>>>            Set Location to 127 293
37274>>>            Set Size to 10 63
37275>>>            Set FontWeight to 600
37276>>>            Set TypeFace to "MS Sans Serif"
37277>>>        End_Object    // TextBoxSub10
37278>>>
37278>>>        Object TextBoxSub11 is a TextBoxSub
37280>>>            Set Label to "(AB...YZ)"
37281>>>            Set Color to 13688273
37282>>>            Set Location to 137 295
37283>>>            Set Size to 10 41
37284>>>            Set FontWeight to 600
37285>>>            Set TypeFace to "MS Sans Serif"
37286>>>        End_Object    // TextBoxSub11
37287>>>
37287>>>        Object TextBoxSub12 is a TextBoxSub
37289>>>            Set Label to "(ab...yz)"
37290>>>            Set Color to 13688273
37291>>>            Set Location to 148 295
37292>>>            Set Size to 10 28
37293>>>            Set FontWeight to 600
37294>>>            Set TypeFace to "MS Sans Serif"
37295>>>        End_Object    // TextBoxSub12
37296>>>
37296>>>        Object TextBoxSub13 is a TextBoxSub
37298>>>            Set Label to "(1234567890)"
37299>>>            Set Color to 13688273
37300>>>            Set Location to 159 293
37301>>>            Set Size to 10 73
37302>>>            Set FontWeight to 600
37303>>>            Set TypeFace to "MS Sans Serif"
37304>>>        End_Object    // TextBoxSub13
37305>>>
37305>>>        Object TextBoxSub14 is a TextBoxSub
37307>>>            Set Label to "(!@#$%^&/*)(_\=+-><|)"
37308>>>            Set Color to 13688273
37309>>>            Set Location to 172 292
37310>>>            Set Size to 10 75
37311>>>            Set FontWeight to 600
37312>>>            Set TypeFace to "MS Sans Serif"
37313>>>        End_Object    // TextBoxSub14
37314>>>
37314>>>        Object TextBoxSub15 is a TextBoxSub
37316>>>            Set Label to "(123...876...efg....MLK)"
37317>>>            Set Color to 13688273
37318>>>            Set Location to 193 293
37319>>>            Set Size to 10 78
37320>>>            Set FontWeight to 600
37321>>>            Set TypeFace to "MS Sans Serif"
37322>>>        End_Object    // TextBoxSub15
37323>>>
37323>>>        Object TextBoxSub16 is a TextBoxSub
37325>>>            Set Label to "‰˜¤æ¤œª ¡˜  œ¨ ¦¨ ©£¦å š ˜ «¦¤ ¡à› ¡æ œ ©æ›¦¬"
37326>>>            Set Color to 13688273
37327>>>            Set Location to 102 7
37328>>>            Set Size to 10 173
37329>>>            Set FontWeight to 600
37330>>>            Set TypeFace to "MS Sans Serif"
37331>>>        End_Object    // TextBoxSub16
37332>>>
37332>>>        Object txt1 is a TextBoxSub
37334>>>            Set Label to "Œ˜ â®œ  £ã¡¦ª ˜§¦ 8 ¡˜  §á¤à ®˜¨˜¡«ã¨œª"
37335>>>            Set Color to 13688273
37336>>>            Set Location to 114 21
37337>>>            Set Size to 10 179
37338>>>            Set TypeFace to "MS Sans Serif"
37339>>>        End_Object    // txt1
37340>>>
37340>>>        Object txt2 is a TextBoxSub
37342>>>            Set Label to "Œ˜ £ž¤ œ§˜¤˜¢˜£™á¤œ«˜  â¤˜ª ®˜¨˜¡«ã¨˜ª 2 ©¬¤œ®æ£œ¤œª ­¦¨âª"
37343>>>            Set Color to 13688273
37344>>>            Set Location to 127 21
37345>>>            Set Size to 10 225
37346>>>            Set TypeFace to "MS Sans Serif"
37347>>>        End_Object    // txt2
37348>>>
37348>>>        Object txt3 is a TextBoxSub
37350>>>            Set Label to "Œ˜ ¬§á¨®œ  «¦¬¢á® ©«¦¤ â¤˜ª ¡œ­˜¢˜å¦ª ®˜¨˜¡«ã¨˜ª"
37351>>>            Set Color to 13688273
37352>>>            Set Location to 138 21
37353>>>            Set Size to 10 184
37354>>>            Set TypeFace to "MS Sans Serif"
37355>>>        End_Object    // txt3
37356>>>
37356>>>        Object txt4 is a TextBoxSub
37358>>>            Set Label to "Œ˜ ¬§á¨®œ  «¦¬¢á® ©«¦¤ â¤˜ª §œæª ®˜¨˜¡«ã¨˜ª"
37359>>>            Set Color to 13688273
37360>>>            Set Location to 148 21
37361>>>            Set Size to 10 173
37362>>>            Set TypeFace to "MS Sans Serif"
37363>>>        End_Object    // txt4
37364>>>
37364>>>        Object txt5 is a TextBoxSub
37366>>>            Set Label to "Œ˜ ¬§á¨®œ  «¦¬¢á® ©«¦¤ â¤˜ª ˜¨ Ÿ£æª"
37367>>>            Set Color to 13688273
37368>>>            Set Location to 161 21
37369>>>            Set Size to 10 139
37370>>>            Set TypeFace to "MS Sans Serif"
37371>>>        End_Object    // txt5
37372>>>
37372>>>        Object txt6 is a TextBoxSub
37374>>>            Set Label to "Œ˜ ¬§á¨®œ  «¦¬¢á® ©«¦¤ â¤˜ª œ › ¡æª ®˜¨˜¡«ã¨˜ª"
37375>>>            Set Color to 13688273
37376>>>            Set Location to 172 21
37377>>>            Set Size to 10 176
37378>>>            Set TypeFace to "MS Sans Serif"
37379>>>        End_Object    // txt6
37380>>>
37380>>>        Object txt7 is a TextBoxSub
37382>>>
37382>>>            //AB-StoreTopStart
37382>>>                                                        
37382>>>            //AB-StoreTopEnd
37382>>>
37382>>>            Set Label to "Œ˜ £ž¤ ®¨ž© £¦§¦ ¦ç¤«˜  „¢¢ž¤ ¡¦å ®˜¨˜¡«ã¨œª"
37383>>>            Set Color to 13688273
37384>>>            Set Location to 182 21
37385>>>            Set Size to 10 171
37386>>>            Set TypeFace to "MS Sans Serif"
37387>>>
37387>>>            //AB-StoreStart
37387>>>                                                        
37387>>>                                                        
37387>>>            //AB-StoreEnd
37387>>>
37387>>>        End_Object    // txt7
37388>>>
37388>>>        Object txt8 is a TextBoxSub
37390>>>            Set Label to "Œ˜ £ž¤ œ§ «â§¦¤«˜  §á¤à ˜§¦ 2 ©¬¤œ®æ£œ¤¦¬ª ©œ ©œ ¨á ®˜¨˜¡«ã¨œª"
37391>>>            Set Color to 13688273
37392>>>            Set Location to 193 21
37393>>>            Set Size to 10 238
37394>>>            Set TypeFace to "MS Sans Serif"
37395>>>        End_Object    // txt8
37396>>>
37396>>>        Object txt9 is a TextBoxSub
37398>>>            Set Label to "Œ˜ £ž¤ œ§ «¨â§¦¤«˜  ¡œ¤á"
37399>>>            Set Color to 13688273
37400>>>            Set Location to 204 21
37401>>>            Set Size to 10 93
37402>>>            Set TypeFace to "MS Sans Serif"
37403>>>        End_Object    // txt9
37404>>>
37404>>>        Object ButtonSub1 is a ButtonSub
37406>>>
37406>>>            //AB-StoreTopStart
37406>>>                                                        
37406>>>            //AB-StoreTopEnd
37406>>>
37406>>>            Set Label to "Show Passwords"
37407>>>            Set Size to 14 72
37408>>>            Set Location to 212 218
37409>>>            Set Focus_Mode to Pointer_Only
37410>>>            Set Form_FontWeight Item 0 to 600
37411>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
37412>>>
37412>>>            //AB-StoreStart
37412>>>                                                        
37412>>>            Set Enabled_State to False
37413>>>            Set Visible_State to False
37414>>>            
37414>>>            // To-Do Mallon den paizei dynamika to password state
37414>>>            // opote den mporeis na emfanizeis dynamika ta asterakia
37414>>>            Procedure OnClick00
37416>>>                Integer iState
37417>>>                String sLabel
37417>>>                Get Password_State Of NewPassForm to iState
37418>>>                Set piPasswordState to (1-iState)
37419>>>                If (piPasswordState(Self)=1) Set Label to "Show Passwords"
37422>>>                Else                         Set Label to "Hide Passwords"
37424>>>                Set Password_State Of NewPassForm       to (piPasswordState(Self)=1)
37425>>>                Set Password_State Of NewPassForm2      to (piPasswordState(Self)=1)
37426>>>                Set Password_State Of ConfirmPassForm   to (piPasswordState(Self)=1)
37427>>>            End_Procedure // OnClick
37428>>>            
37428>>>            
37428>>>            
37428>>>            //AB-StoreEnd
37428>>>
37428>>>        End_Object    // ButtonSub1
37429>>>
37429>>>
37429>>>        //AB-StoreStart
37429>>>        
37429>>>        Function ConfirmNewCustomPass Returns Integer
37431>>>            Local Integer   bPasswordGood i1 i2 i3 i4 i5 i6 i7 i8 i9 iDays iTries success iMax
37432>>>            Local String    sNewPassword sNewPassword2 sConfirmPassword sOldPassword sPassw lsTheAppPath
37432>>>            Local String    sNewPasswordC sNewPassword2C sConfirmPasswordC sPasswC sLogin
37432>>>        
37432>>>            Date    dHmnia
37432>>>            String  sHH sMM sSS sTime
37432>>>            Sysdate dHmnia sHH sMM sSS
37436>>>            Move (Trim(sHH)) to sHH
37437>>>            Move (Trim(sMM)) to sMM
37438>>>            Move (Trim(sSS)) to sSS
37439>>>            If (Length(sHH)=1) Insert '0' in sHH at 1
37443>>>            If (Length(sMM)=1) Insert '0' in sMM at 1
37447>>>            If (Length(sSS)=1) Insert '0' in sSS at 1
37451>>>            Move (sHH+":"+sMM+"."+sSS) to sTime
37452>>>        
37452>>>        
37452>>>            Move "" to sConfirmPassword
37453>>>            Move "" to sNewPassword
37454>>>            Move "" to sNewPassword2
37455>>>            Move "" to sConfirmPasswordC
37456>>>            Move "" to sNewPasswordC
37457>>>            Move "" to sNewPassword2C
37458>>>            Move "" to sPasswC
37459>>>        
37459>>>        
37459>>>            Set value of (NewPassForm    (Current_Object)) item 0 to ""
37460>>>            Set value of (NewPassForm2   (Current_Object)) item 0 to ""
37461>>>            Set value of (ConfirmPassForm(Current_Object)) item 0 to ""
37462>>>        
37462>>>            Set piPasswordState to 1
37463>>>        
37463>>>            Set Password_State Of NewPassForm       to (piPasswordState(Self)=1)
37464>>>            Set Password_State Of NewPassForm2      to (piPasswordState(Self)=1)
37465>>>            Set Password_State Of ConfirmPassForm   to (piPasswordState(Self)=1)
37466>>>        
37466>>>            Open Sysrec
37468>>>            Open Users
37470>>>        
37470>>>            Move (fsLoginUserID())  to sLogin
37471>>>            Clear Users
37472>>>            Move sLogin    to Users.Login_ID
37473>>>            Find eq Users by Index.1
37474>>>>
37474>>>        
37474>>>            If (iCountRemain>0) Set Label of oNewPassDlg to ("‚œ ˜ ©¦¬ "+Trim(Users.NAME)+" - €¢¢˜šã ‰à› ¡¦ç ¨æ©™˜©žª, ˜§¦£â¤¦¬¤ "+String(iCountRemain)+" §¨¦©§áŸœ œª")
37477>>>            Else                Set Label of oNewPassDlg to ("‚œ ˜ ©¦¬ "+Trim(Users.NAME)+" - €¢¢˜šã ‰à› ¡¦ç ¨æ©™˜©žª")
37479>>>        
37479>>>            Reread Sysrec
37483>>>            Unlock
37484>>>>
37484>>>        
37484>>>            Set Locate_Mode to CENTER_ON_SCREEN
37485>>>        
37485>>>            Move Sysrec.LIBCAST_CODE    to i1
37486>>>            Move Sysrec.AWARD_CODE      to i2
37487>>>            Move Sysrec.GIVAWRD_CODE    to i3
37488>>>            Move Sysrec.MOVIE_LNK_CODE  to i4
37489>>>            Move Sysrec.CAST_LNK_CODE   to i5
37490>>>            Move Sysrec.AWARDTP_CODE    to i6
37491>>>            Move Sysrec.FESTIVAL_CODE   to i7 // No Greek characters Hard Coded to 1
37492>>>            Move Sysrec.STWHAT_CODE     to i8
37493>>>            Move Sysrec.SNWHAT_CODE     to i9
37494>>>            Move Sysrec.LIBVIS_CODE     to iDays
37495>>>            Move Sysrec.TIKANEI_CODE    to iMax
37496>>>        
37496>>>            Set Checked_State Of (chkLengthOverEight(Self))         To i1
37497>>>            Set Checked_State Of (chk3Consecutive(Self))            To i2
37498>>>            Set Checked_State Of (chkAtLeast1Upper(Self))           To i3
37499>>>            Set Checked_State Of (chkAtLeast1Lower(Self))           To i4
37500>>>            Set Checked_State Of (chkAtLeast1Number(Self))          To i5
37501>>>            Set Checked_State Of (chkAtLeast1Special(Self))         To i6
37502>>>            Set Checked_State Of (ChkNoGreek(Self))                 To i7
37503>>>            Set Checked_State Of (chkSeiriakous(Self))              To i8
37504>>>            Set Checked_State Of (chkBlanks(Self))                  To i9
37505>>>        //    Set Value Of frmChangePasswordEveryDays Item 0          to iDays
37505>>>        //    Set Value Of frmAttempts                Item 0          to iMax
37505>>>        
37505>>>            Send Popup_Modal
37506>>>        
37506>>>            Open Sysrec
37508>>>            Open Users
37510>>>        
37510>>>            Get value of (ConfirmPassForm(Current_Object)) item 0 to sConfirmPassword
37511>>>            Get value of (NewPassForm    (Current_Object)) item 0 to sNewPassword
37512>>>            Get value of (NewPassForm2   (Current_Object)) item 0 to sNewPassword2
37513>>>        
37513>>>            Move (Trim(sConfirmPassword))   to sConfirmPassword
37514>>>            Move (Trim(sNewPassword))       to sNewPassword
37515>>>            Move (Trim(sNewPassword2))      to sNewPassword2
37516>>>        
37516>>>            If (sConfirmPassword<>"") Move (fsCryptoNew(Self,"Encrypt",sConfirmPassword)) to sConfirmPasswordC
37519>>>            If (sNewPassword    <>"") Move (fsCryptoNew(Self,"Encrypt",sNewPassword ))    to sNewPasswordC
37522>>>            If (sNewPassword2   <>"") Move (fsCryptoNew(Self,"Encrypt",sNewPassword2))    to sNewPassword2C
37525>>>        
37525>>>            If (piState(Self)<>Canceled) Begin
37527>>>        
37527>>>                Move (fsLoginUserID())  to sLogin
37528>>>                Clear Users
37529>>>                Move sLogin    to Users.Login_ID
37530>>>                Find eq Users by Index.1
37531>>>>
37531>>>                If (Found) Begin
37533>>>        
37533>>>                    If (Trim(Users.PASSWORD)<>"") Move Users.PASSWORD to sPasswC
37536>>>        
37536>>>                    // --------------------------------------------------
37536>>>                    // Verify if not used in the last 5 passwords history
37536>>>                    Integer iRecs isAlreadyUsed
37536>>>                    Move 0 to iRecs
37537>>>                    Move 0 to isAlreadyUsed
37538>>>        
37538>>>                    Clear UsersH
37539>>>                    Move Users.Login_ID to UsersH.Login_ID
37540>>>                    Find GE UsersH By Index.1
37541>>>>
37541>>>                    While ((Found) And (Users.Login_ID=UsersH.Login_ID) And (isAlreadyUsed=0))
37545>>>                        Add 1 to iRecs
37546>>>                        If ((Trim(UsersH.New_Password)=sNewPasswordC) And (UsersH.Changed_Date<dHmnia)) Move 1 to isAlreadyUsed
37549>>>                        Find GT UsersH By Index.1
37550>>>>
37550>>>                    Loop
37551>>>>
37551>>>        
37551>>>                    If (isAlreadyUsed) Begin
37553>>>                        Set piState to Already_Used // 7
37554>>>                        Function_Return (piState(Self))
37555>>>                    End
37555>>>>
37555>>>        
37555>>>                    If ((Trim(Users.Password)<>"") And (Trim(Users.Password)<>sConfirmPasswordC)) Begin
37557>>>                        Set piState to Wrong_Prev_Passw // 6
37558>>>                    End
37558>>>>
37558>>>                    Else If (sNewPasswordC<>sNewPassword2C)  Begin
37561>>>                        Set piState to Not_Match // 4
37562>>>                    End
37562>>>>
37562>>>                    Else Begin
37563>>>                        If (Trim(sNewPasswordC)="") Begin
37565>>>                            Set piState to No_Password // 5
37566>>>                        End
37566>>>>
37566>>>                        Else If (sPasswC=sNewPasswordC) Begin
37569>>>                            Set piState to Same_Password // 2
37570>>>                        End
37570>>>>
37570>>>                        Else Begin
37571>>>        
37571>>>                            Integer isCheckedOK
37571>>>                            Move (fsVerifyThePasswordValidity(Self,sNewPassword)) to isCheckedOK
37572>>>                            If (isCheckedOK=0) Begin
37574>>>        
37574>>>                                Set piState to All_Ok // 0
37575>>>        
37575>>>                                Reread Users
37579>>>                                If (Trim(Users.Password)<>"")   Move Users.Password to Users.Last_Password
37582>>>                                Else                            Move sNewPasswordC  to Users.Last_Password
37584>>>                                Move sNewPasswordC                                  to Users.PASSWORD
37585>>>                                Move  dHmnia                                        to Users.Last_Change
37586>>>                                Move (dHmnia+iDays)                                 to Users.Next_Change
37587>>>                                Move  dHmnia                                        to Users.Last_Login_Date
37588>>>                                Move (Trim(sTime))                                  to Users.Last_Login_Time
37589>>>                                SaveRecord Users
37590>>>                                Unlock
37591>>>>
37591>>>        
37591>>>        
37591>>>                                Move 0 to iRecs
37592>>>                                Clear UsersH
37593>>>                                Move Users.Login_ID to UsersH.Login_ID
37594>>>                                Find GE UsersH By Index.1
37595>>>>
37595>>>                                While ((Found) And (Users.Login_ID=UsersH.Login_ID))
37599>>>                                    Add 1 to iRecs
37600>>>                                    If (UsersH.Is_Last=1) Begin
37602>>>                                        Reread UsersH
37606>>>                                        Move 0 to UsersH.Is_Last
37607>>>                                        Saverecord UsersH
37608>>>                                        Unlock
37609>>>>
37609>>>                                    End
37609>>>>
37609>>>                                    Find GT UsersH By Index.1
37610>>>>
37610>>>                                Loop
37611>>>>
37611>>>        
37611>>>                                If (iRecs<5) Begin
37613>>>                                        Clear UsersH
37614>>>                                        Move Users.Login_ID     to UsersH.Login_ID
37615>>>                                        Move dHmnia             to UsersH.Changed_Date
37616>>>                                        Find Eq UsersH By Index.1
37617>>>>
37617>>>                                        If (Found) Reread UsersH
37623>>>                                        Move sNewPasswordC      to UsersH.New_Password
37624>>>                                        Move 1                  to UsersH.Is_Last
37625>>>                                        Saverecord UsersH
37626>>>                                        If (Found) Unlock
37629>>>                                End
37629>>>>
37629>>>                                Else Begin
37630>>>                                    Integer   iX
37630>>>                                    Move 0 to iX
37631>>>                                    Move 0 to iRecs
37632>>>        
37632>>>                                    Clear UsersH
37633>>>                                    Move Users.Login_ID     to UsersH.Login_ID
37634>>>                                    Move dHmnia             to UsersH.Changed_Date
37635>>>                                    Find Eq UsersH By Index.1
37636>>>>
37636>>>                                    If (Found) Begin
37638>>>                                        Reread UsersH
37642>>>                                        Move sNewPasswordC  to UsersH.New_Password
37643>>>                                        Move 1              to UsersH.Is_Last
37644>>>                                        Saverecord UsersH
37645>>>                                        Unlock
37646>>>>
37646>>>                                    End
37646>>>>
37646>>>                                    Else Begin
37647>>>                                        Clear UsersH
37648>>>                                        Move Users.Login_ID to UsersH.Login_ID
37649>>>                                        Move ""             to UsersH.Changed_Date
37650>>>                                        Find GE UsersH By Index.1
37651>>>>
37651>>>                                        If ((Found) And (Users.Login_ID=UsersH.Login_ID) And (UsersH.Changed_Date<dHmnia)) Begin
37653>>>                                            Reread UsersH
37657>>>                                            Move dHmnia             to UsersH.Changed_Date
37658>>>                                            Move sNewPasswordC      to UsersH.New_Password
37659>>>                                            Move 1                  to UsersH.Is_Last
37660>>>                                            Saverecord UsersH
37661>>>                                            Unlock
37662>>>>
37662>>>                                        End
37662>>>>
37662>>>                                    End
37662>>>>
37662>>>                                End
37662>>>>
37662>>>                            End
37662>>>>
37662>>>                            Else Set piState to Canceled
37664>>>                        End
37664>>>>
37664>>>                    End
37664>>>>
37664>>>                End
37664>>>>
37664>>>                Else Set piState to Canceled
37666>>>            End
37666>>>>
37666>>>            // If Cancelled piState = 1
37666>>>            Function_Return (piState(Self))
37667>>>        End_Function
37668>>>        
37668>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
37669>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
37670>>>        
37670>>>        
37670>>>        
37670>>>        
37670>>>        
37670>>>        
37670>>>        
37670>>>        
37670>>>        
37670>>>        
37670>>>        //AB-StoreEnd
37670>>>
37670>>>    End_Object    // oNewPassDlg
37671>>>
37671>>>
37671>>>    //AB-StoreStart
37671>>>                
37671>>>                
37671>>>                
37671>>>                
37671>>>                
37671>>>                
37671>>>    //AB-StoreEnd
37671>>>
37671>>>//AB/     End_Object    // prj
37671>
37671>Open Sysrec
37673>Open Users
37675>Open UsersH
37677>Open Usergrps
37679>
37679>
37679>Procedure ChangeMyPassword
37680>    Integer iResult
37681>    Get ConfirmNewCustomPass of oNewPassDlg to iResult
37682>         If (iResult=0) Send Info_Box "Ž ¡à› ¡æª ©˜ª «¨¦§¦§¦ ãŸž¡œ œ§ «¬®éª"    "¢ž¨¦­¦¨å˜"
37685>    Else If (iResult=1) Send Info_Box ("Ž ¡à› ¡æª ©˜ª ƒ„Œ âš ¤œ ›œ¡«æª"+" \n"+"€¡¬¨éŸž¡œ ˜§¦ «¦¤ ®¨ã©«ž")
37689>    Else If (iResult=2) Send Info_Box ("Ž ¡à› ¡æª ©˜ª ƒ„Œ âš ¤œ ›œ¡«æª"+" \n"+"Ž ¤â¦ª ¡à› ¡æª œå¤˜  å› ¦ª £œ «¦¤ §˜¢ æ")
37693>    Else If (iResult=3) Send Info_Box ("Ž ¡à› ¡æª ©˜ª ƒ„Œ âš ¤œ ›œ¡«æª"+" \n"+"Ž ¡à› ¡æª œ ©æ›¦¬ œå˜¤  ¢áŸ¦ª")
37697>    Else If (iResult=4) Send Info_Box ("Ž ¡à› ¡æª ©˜ª ƒ„Œ âš ¤œ ›œ¡«æª"+" \n"+"Ž ¡à› ¡æª œ§ ™œ™˜åà©žª › ˜­â¨œ  ˜§¦ «¦¤ ¡à› ¡æ œ ©æ›¦¬")
37701>    Else If (iResult=5) Send Info_Box ("Ž ¡à› ¡æª ©˜ª ƒ„Œ âš ¤œ ›œ¡«æª"+" \n"+"Ž ¡à› ¡æª œå¤˜  ¡œ¤æª")
37705>    Else If (iResult=6) Send Info_Box ("Ž ¡à› ¡æª ©˜ª ƒ„Œ âš ¤œ ›œ¡«æª"+" \n"+"Ž §˜¢ æª ¡à› ¡æª œå˜¤  ¢áŸ¦ª")
37709>    Else If (iResult=7) Send Info_Box ("Ž ¡à› ¡æª ©˜ª ƒ„Œ âš ¤œ ›œ¡«æª"+" \n"+"Ž ¡à› ¡æª â®œ  ã›ž ¥˜¤˜®¨ž© £¦§¦ žŸœå £œ«˜¥ç «à¤ 5 «œ¢œ¬«˜åà¤ ˜¢¢˜šé¤")
37713>    Else                Send Info_Box ("Ž ¡à› ¡æª ©˜ª ƒ„Œ âš ¤œ ›œ¡«æª"+" \n"+"êš¤à©«¦ ‘­á¢£˜")
37715>    Move iResult to iApotel
37716>End_Procedure
37717>
37717>
37717>Move 0 to iMetrhthsProsp
37718>
37718>//=======================
37718>Start_Entry_Validation:
37718>//-----------------------
37718>Move 0 to iMustResetPass
37719>Move 0 to iAnenergos
37720>Move 0 to iApotel
37721>Move (iMax00-iMetrhthsProsp+1)  to iCountRemain
37722>If (iMetrhthsProsp>iMax00)      Send Exit_Application
37725>Send Login
37726>If (iHasAPassword=0) Send ChangeMyPassword
37729>If (iAnenergos   =1) Goto Start_Entry_Validation
37732>If (iApotel      >0) Goto Start_Entry_Validation
37735>
37735>Move 0 to iApotel
37736>Move 0 to iMetrhthsProsp
37737>Move 0 to iAnenergos
37738>Move 0 to iMustResetPass
37739>//=======================
37739>
37739>Open Sysrec
37741>Open Users
37743>Open UsersH
37745>Open Usergrps
37747>
37747>
37747>Use Xrhsh.pkg
INCLUDING FILE: XRHSH.PKG
37747>>>//------------------------------
37747>>>Use SelectXr.Dg
INCLUDING FILE: SELECTXR.DG
37747>>>>>//AB/ Project Select / Change Xrhsh
37747>>>>>//AB/     Object prj is a Dialog_Project
37747>>>>>//AB/         Set ProjectName to "Select / Change Xrhsh"
37747>>>>>//AB/         Set ProjectFileName to "SelectXR.DG"
37747>>>>>
37747>>>>>// Project Object Structure
37747>>>>>//   oSelectYear is a dbModalPanelSub
37747>>>>>//     Company_DD is a DataDictionary
37747>>>>>//     Branch_DD is a DataDictionary
37747>>>>>//     Year_DD is a DataDictionary
37747>>>>>//     Company_Company_Code is a dbFormSub
37747>>>>>//     Company_Company_Name is a dbFormSub
37747>>>>>//     Branch_Branch_Code is a dbFormSub
37747>>>>>//     Branch_Branch_Name is a dbFormSub
37747>>>>>//     Year_Year_Year is a dbFormSub
37747>>>>>//     Year_Year_Descr is a dbFormSub
37747>>>>>//     Year_Year_Entrydate is a dbFormSub
37747>>>>>//     oOk_bn is a ButtonSub
37747>>>>>//     oCancel_bn is a ButtonSub
37747>>>>>//     otxtCompany is a TextBoxSub
37747>>>>>//     otxtBranch is a TextBoxSub
37747>>>>>//     otxtYear is a TextBoxSub
37747>>>>>//     otxtWorkingDay is a TextBoxSub
37747>>>>>//     otxtWorkingDay is a TextBoxSub
37747>>>>>//     chkxr is a CheckBoxSub
37747>>>>>
37747>>>>>// Register all objects
37747>>>>>Register_Object Branch_Branch_Code
37747>>>>>Register_Object Branch_Branch_Name
37747>>>>>Register_Object Branch_DD
37747>>>>>Register_Object Company_Company_Code
37747>>>>>Register_Object Company_Company_Name
37747>>>>>Register_Object Company_DD
37747>>>>>Register_Object chkxr
37747>>>>>Register_Object oCancel_bn
37747>>>>>Register_Object oOk_bn
37747>>>>>Register_Object oSelectYear
37747>>>>>Register_Object otxtBranch
37747>>>>>Register_Object otxtCompany
37747>>>>>Register_Object otxtWorkingDay
37747>>>>>Register_Object otxtYear
37747>>>>>Register_Object Year_DD
37747>>>>>Register_Object Year_Year_Descr
37747>>>>>Register_Object Year_Year_Entrydate
37747>>>>>Register_Object Year_Year_Year
37747>>>>>
37747>>>>>
37747>>>>>
37747>>>>>    //AB-StoreTopStart
37747>>>>>    
37747>>>>>    
37747>>>>>    
37747>>>>>    
37747>>>>>           String  gs_selected_beto_site
37747>>>>>    
37747>>>>>    Open SysCurXR
37749>>>>>    Open Nomisma
37751>>>>>    
37751>>>>>    //AB-StoreTopEnd
37751>>>>>
37751>>>>>    //AB-IgnoreStart
37751>>>>>
37751>>>>>    Use DFAllEnt.pkg
37751>>>>>    Use dbForm.Sub
37751>>>>>    Use Button.Sub
37751>>>>>    Use Txtbox.Sub
37751>>>>>    Use Chkbox.Sub
37751>>>>>
37751>>>>>
37751>>>>>    Use COMPANY.DD
INCLUDING FILE: COMPANY.DD
37751>>>>>>>//DDB-FileStart
37751>>>>>>>//DDB-HeaderStart
37751>>>>>>>
37751>>>>>>>// File Name : COMPANY.DD
37751>>>>>>>// Class Name: Company_DataDictionary
37751>>>>>>>// Revision  : 64
37751>>>>>>>// Version   : 2
37751>>>>>>>
37751>>>>>>>Use  Windows           // Basic Definitions
37751>>>>>>>Use  DataDict          // DataDictionary Class Definition
37751>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37751>>>>>>>
37751>>>>>>>Open Company
37753>>>>>>>Open Branch
37755>>>>>>>
37755>>>>>>>//DDB-HeaderEnd
37755>>>>>>>//DDB-ValidationStart
37755>>>>>>>
37755>>>>>>>Register_Object Company_Company_Doy_VT
37755>>>>>>>Register_Object Company_Company_J_Code_VT
37755>>>>>>>
37755>>>>>>>Object Company_Company_Doy_VT  is a CodeValidationTable
37757>>>>>>>    Set Type_Value        To "DOY"
37758>>>>>>>    Set Allow_Blank_State To TRUE
37759>>>>>>>    //DDB-ValidationCustomStart
37759>>>>>>>    //DDB-ValidationCustomEnd
37759>>>>>>>End_Object   // Company_Company_Doy_VT
37760>>>>>>>
37760>>>>>>>Object Company_Company_J_Code_VT  is a CodeValidationTable
37762>>>>>>>    Set Type_Value        To "JOB"
37763>>>>>>>    Set Allow_Blank_State To TRUE
37764>>>>>>>    //DDB-ValidationCustomStart
37764>>>>>>>    //DDB-ValidationCustomEnd
37764>>>>>>>End_Object   // Company_Company_J_Code_VT
37765>>>>>>>//DDB-ValidationEnd
37765>>>>>>>//DDB-SelectionStart
37765>>>>>>>//DDB/ ExternalSelectionList sl001  sl001.sl
37765>>>>>>>Register_Object sl001
37765>>>>>>>//DDB-SelectionEnd
37765>>>>>>> 
37765>>>>>>>Class Company_DataDictionary  is a DataDictionary
37766>>>>>>> 
37766>>>>>>>    // Update:
37766>>>>>>> 
37766>>>>>>>    Procedure Update
37767>>>>>>>        Forward Send Update
37769>>>>>>>        move 'DOY' to company.doy_type
37770>>>>>>>        move 'JOB' to company.jcode_type 
37771>>>>>>>        // Insert Code Here
37771>>>>>>>    End_Procedure   // Update
37772>>>>>>> 
37772>>>>>>>
37772>>>>>>>    // Operation_Not_Allowed:
37772>>>>>>>
37772>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
37773>>>>>>>        // Insert Code Here
37773>>>>>>>        Case Begin
37773>>>>>>>             Case (iError_Num = 1001)
37775>>>>>>>                  Error 1001 "DDC 051:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª „«˜ ¨œå˜ª!\n\n‰œ¤æª ‰à› ¡æª"
37776>>>>>>>>
37776>>>>>>>             Case Break
37777>>>>>>>
37777>>>>>>>             Case Else
37777>>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
37779>>>>>>>        Case End
37779>>>>>>>    End_Procedure   // Operation_Not_Allowed
37780>>>>>>>
37780>>>>>>>
37780>>>>>>>    // Validate_Save:
37780>>>>>>>
37780>>>>>>>    Function Validate_Save  Returns Integer
37781>>>>>>>        Local Integer iReturnVal
37782>>>>>>>        Forward Get Validate_Save  To iReturnVal
37784>>>>>>>        If (Not(iReturnVal)) Begin
37786>>>>>>>            // Insert Code Here
37786>>>>>>>            If (Company.Company_Code="") Send Operation_Not_Allowed 1001
37789>>>>>>>        End
37789>>>>>>>>
37789>>>>>>>        Function_Return iReturnVal
37790>>>>>>>    End_Function   // Validate_Save
37791>>>>>>>
37791>>>>>>>
37791>>>>>>>    // Define_Fields:
37791>>>>>>>    // This procedure is used to set up all data-dictionary rules.
37791>>>>>>>
37791>>>>>>>    Procedure Define_Fields
37792>>>>>>>        Forward Send Define_Fields
37794>>>>>>>        //DDB-Generated-Code-Location
37794>>>>>>>        //DDB-DefineFieldStart
37794>>>>>>>
37794>>>>>>>        Set Main_File            To Company.File_Number
37795>>>>>>>        Set Cascade_Delete_State To FALSE
37796>>>>>>>
37796>>>>>>>
37796>>>>>>>        // Child (Client) file structure................
37796>>>>>>>        Send Add_Client_File  Branch.File_Number
37797>>>>>>>
37797>>>>>>>        // Field-based properties.......................
37797>>>>>>>
37797>>>>>>>        // Company.Company_Code
37797>>>>>>>        Set Field_Options          Field Company.Company_Code To DD_AUTOFIND   
37798>>>>>>>        Set Field_Prompt_Object    Field Company.Company_Code To (sl001(Self))
37799>>>>>>>
37799>>>>>>>        // Company.Company_Name
37799>>>>>>>        Set Field_Options          Field Company.Company_Name To DD_REQUIRED   
37800>>>>>>>        Set Field_Prompt_Object    Field Company.Company_Name To (sl001(Self))
37801>>>>>>>
37801>>>>>>>        // Company.Company_Afm
37801>>>>>>>        Set Field_Options          Field Company.Company_Afm To DD_AUTOFIND   
37802>>>>>>>
37802>>>>>>>        // Company.Company_Addr
37802>>>>>>>
37802>>>>>>>        // Company.Company_Tk
37802>>>>>>>
37802>>>>>>>        // Company.Company_Poli
37802>>>>>>>
37802>>>>>>>        // Company.Company_Doy
37802>>>>>>>        Set Field_Value_Table      Field Company.Company_Doy To (Company_Company_Doy_VT(Self))
37803>>>>>>>
37803>>>>>>>        // Company.Company_J_Code
37803>>>>>>>        Set Field_Value_Table      Field Company.Company_J_Code To (Company_Company_J_Code_VT(Self))
37804>>>>>>>
37804>>>>>>>        // Company.Company_C_Code0
37804>>>>>>>
37804>>>>>>>        // Company.Company_C_Cod00
37804>>>>>>>
37804>>>>>>>        // Company.Company_C_Coder
37804>>>>>>>
37804>>>>>>>        // Company.Company_Tel
37804>>>>>>>
37804>>>>>>>        // Company.Company_Fax
37804>>>>>>>
37804>>>>>>>        // Company.Company_Email
37804>>>>>>>
37804>>>>>>>        // Company.Company_Resp
37804>>>>>>>
37804>>>>>>>        // Company.Company_Bitmap
37804>>>>>>>
37804>>>>>>>        // Company.Beto_Site
37804>>>>>>>
37804>>>>>>>        // Company.Logo
37804>>>>>>>
37804>>>>>>>        // Company.Doy_Type
37804>>>>>>>
37804>>>>>>>        // Company.Jcode_Type
37804>>>>>>>
37804>>>>>>>        // Company.Sap_Code
37804>>>>>>>
37804>>>>>>>        // Company.Sap_Path
37804>>>>>>>
37804>>>>>>>        //DDB-DefineFieldEnd
37804>>>>>>>    End_Procedure    // Define_Fields
37805>>>>>>>
37805>>>>>>>    // Field_Defaults:
37805>>>>>>>    // This procedure is used to establish default field values.
37805>>>>>>>
37805>>>>>>>    Procedure Field_Defaults
37806>>>>>>>        Forward Send Field_Defaults
37808>>>>>>>        //DDB-Generated-Code-Location
37808>>>>>>>        //DDB-FieldDefaultStart
37808>>>>>>>        //DDB-FieldDefaultEnd
37808>>>>>>>    End_Procedure    // Field_Defaults
37809>>>>>>>End_Class    // Company_DataDictionary
37810>>>>>>>
37810>>>>>>>//DDB-Selection-pkg-Start
37810>>>>>>>
37810>>>>>>>Use sl001.sl         // sl001
INCLUDING FILE: SL001.SL
37810>>>>>>>>>//AB/ Project sl001 : Etairies
37810>>>>>>>>>//AB/     Object prj is a Lookup_Project
37810>>>>>>>>>//AB/         Set ProjectName to "sl001 : Etairies"
37810>>>>>>>>>//AB/         Set ProjectFileName to "sl001.SL"
37810>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
37810>>>>>>>>>
37810>>>>>>>>>// Project Object Structure
37810>>>>>>>>>//   sl001 is a dbModalPanel
37810>>>>>>>>>//     Company_DD is a DataDictionary
37810>>>>>>>>>//     oSelList is a dbList
37810>>>>>>>>>//     oOK_bn is a ButtonSub
37810>>>>>>>>>//     oCancel_bn is a ButtonSub
37810>>>>>>>>>//     oSearch_bn is a ButtonSub
37810>>>>>>>>>
37810>>>>>>>>>// Register all objects
37810>>>>>>>>>Register_Object Company_DD
37810>>>>>>>>>Register_Object oCancel_bn
37810>>>>>>>>>Register_Object oOK_bn
37810>>>>>>>>>Register_Object oSearch_bn
37810>>>>>>>>>Register_Object oSelList
37810>>>>>>>>>Register_Object sl001
37810>>>>>>>>>
37810>>>>>>>>>
37810>>>>>>>>>    //AB-IgnoreStart
37810>>>>>>>>>
37810>>>>>>>>>    Use DFAllEnt.pkg
37810>>>>>>>>>    Use Button.Sub
37810>>>>>>>>>
37810>>>>>>>>>
37810>>>>>>>>>    Use COMPANY.DD
37810>>>>>>>>>    
37810>>>>>>>>>    //AB-IgnoreEnd
37810>>>>>>>>>
37810>>>>>>>>>    CD_Popup_Object sl001 is a dbModalPanel
37829>>>>>>>>>        Set Label to "„«˜ ¨åœª"
37830>>>>>>>>>        Set Size to 148 297
37831>>>>>>>>>        Set Location to 12 27
37832>>>>>>>>>
37832>>>>>>>>>        //AB-DDOStart
37832>>>>>>>>>
37832>>>>>>>>>        Object Company_DD is a Company_DataDictionary
37834>>>>>>>>>        End_Object    // Company_DD
37835>>>>>>>>>
37835>>>>>>>>>        Set Main_DD to (Company_DD(self))
37836>>>>>>>>>        Set Server to (Company_DD(self))
37837>>>>>>>>>
37837>>>>>>>>>        //AB-DDOEnd
37837>>>>>>>>>
37837>>>>>>>>>        Object oSelList is a dbList
37839>>>>>>>>>            Set Main_File to Company.File_Number
37840>>>>>>>>>            Set Size to 105 280
37841>>>>>>>>>            Set Location to 6 6
37842>>>>>>>>>
37842>>>>>>>>>            Begin_Row
37845>>>>>>>>>                Entry_Item Company.Company_code
37846>>>>>>>>>                Entry_Item Company.Company_name
37847>>>>>>>>>                Entry_Item Company.Company_afm
37848>>>>>>>>>            End_Row
37853>>>>>>>>>
37853>>>>>>>>>            Set Form_Width    item 0 to 42
37854>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
37855>>>>>>>>>            
37855>>>>>>>>>            Set Form_Width    item 1 to 150
37856>>>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
37857>>>>>>>>>            
37857>>>>>>>>>            Set Form_Width    item 2 to 80
37858>>>>>>>>>            Set Header_Label  item 2 to "€.”.‹"
37859>>>>>>>>>            
37859>>>>>>>>>        End_Object    // oSelList
37860>>>>>>>>>
37860>>>>>>>>>        Object oOK_bn is a ButtonSub
37862>>>>>>>>>            Set Label to "&„§ ¢¦šã"
37863>>>>>>>>>            Set Location to 115 126
37864>>>>>>>>>
37864>>>>>>>>>            //AB-StoreStart
37864>>>>>>>>>            Procedure OnClick
37866>>>>>>>>>                Send OK To (oSelList(current_object))
37867>>>>>>>>>            End_Procedure
37868>>>>>>>>>            //AB-StoreEnd
37868>>>>>>>>>
37868>>>>>>>>>        End_Object    // oOK_bn
37869>>>>>>>>>
37869>>>>>>>>>        Object oCancel_bn is a ButtonSub
37871>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
37872>>>>>>>>>            Set Location to 115 181
37873>>>>>>>>>
37873>>>>>>>>>            //AB-StoreStart
37873>>>>>>>>>            Procedure OnClick
37875>>>>>>>>>                Send Cancel To (oSelList(current_object))
37876>>>>>>>>>            End_Procedure
37877>>>>>>>>>            //AB-StoreEnd
37877>>>>>>>>>
37877>>>>>>>>>        End_Object    // oCancel_bn
37878>>>>>>>>>
37878>>>>>>>>>        Object oSearch_bn is a ButtonSub
37880>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
37881>>>>>>>>>            Set Location to 115 236
37882>>>>>>>>>
37882>>>>>>>>>            //AB-StoreStart
37882>>>>>>>>>            Procedure OnClick
37884>>>>>>>>>                Send Search To (oSelList(current_object))
37885>>>>>>>>>            End_Procedure
37886>>>>>>>>>            //AB-StoreEnd
37886>>>>>>>>>
37886>>>>>>>>>        End_Object    // oSearch_bn
37887>>>>>>>>>
37887>>>>>>>>>
37887>>>>>>>>>        //AB-StoreStart
37887>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To oOk_bn
37888>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To oCancel_bn
37889>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To oSearch_bn
37890>>>>>>>>>        //AB-StoreEnd
37890>>>>>>>>>
37890>>>>>>>>>    CD_End_Object    // sl001
37892>>>>>>>>>>
37892>>>>>>>>>
37892>>>>>>>>>//AB/     End_Object    // prj
37892>>>>>>>
37892>>>>>>>//DDB-Selection-pkg-End
37892>>>>>>>//DDB-FileEnd
37892>>>>>    Use BRANCH.DD
INCLUDING FILE: BRANCH.DD
37892>>>>>>>//DDB-FileStart
37892>>>>>>>//DDB-HeaderStart
37892>>>>>>>
37892>>>>>>>// File Name : BRANCH.DD
37892>>>>>>>// Class Name: Branch_DataDictionary
37892>>>>>>>// Revision  : 96
37892>>>>>>>// Version   : 2
37892>>>>>>>
37892>>>>>>>Use  Windows           // Basic Definitions
37892>>>>>>>Use  DataDict          // DataDictionary Class Definition
37892>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
37892>>>>>>>
37892>>>>>>>Open Branch
37894>>>>>>>Open Year
37896>>>>>>>Open Brzones
INCLUDING FILE: BRZONES.FD
37898>>>>>>>Open Tpbranch
INCLUDING FILE: TPBRANCH.FD
37900>>>>>>>Open Company
37902>>>>>>>Open Sysrecg
INCLUDING FILE: SYSRECG.FD
37904>>>>>>>
37904>>>>>>>//DDB-HeaderEnd
37904>>>>>>>//DDB-ValidationStart
37904>>>>>>>
37904>>>>>>>Register_Object Branch_Branch_Doy_VT
37904>>>>>>>Register_Object Branch_Branch_C_Code0_VT
37904>>>>>>>
37904>>>>>>>Object Branch_Branch_Doy_VT  is a CodeValidationTable
37906>>>>>>>    Set Type_Value        To "DOY"
37907>>>>>>>    Set Validate_State    To FALSE
37908>>>>>>>    Set Allow_Blank_State To TRUE
37909>>>>>>>    //DDB-ValidationCustomStart
37909>>>>>>>    //DDB-ValidationCustomEnd
37909>>>>>>>End_Object   // Branch_Branch_Doy_VT
37910>>>>>>>
37910>>>>>>>Object Branch_Branch_C_Code0_VT  is a CodeValidationTable
37912>>>>>>>    Set Type_Value        To ""
37913>>>>>>>    Set Allow_Blank_State To TRUE
37914>>>>>>>    //DDB-ValidationCustomStart
37914>>>>>>>    //DDB-ValidationCustomEnd
37914>>>>>>>End_Object   // Branch_Branch_C_Code0_VT
37915>>>>>>>//DDB-ValidationEnd
37915>>>>>>>//DDB-SelectionStart
37915>>>>>>>//DDB/ ExternalSelectionList SL002  Sl002.sl
37915>>>>>>>Register_Object SL002
37915>>>>>>>//DDB-SelectionEnd
37915>>>>>>>
37915>>>>>>>Class Branch_DataDictionary  is a DataDictionary
37916>>>>>>> 
37916>>>>>>>    Procedure Save_Main_File
37917>>>>>>>        Forward Send Save_Main_File
37919>>>>>>>        // Insert Code Here
37919>>>>>>>    End_Procedure   // Save_Main_File
37920>>>>>>> 
37920>>>>>>>    Procedure Creating
37921>>>>>>>        Forward Send Creating
37923>>>>>>>        // Insert Code Here
37923>>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Branch.Branch_Rec0)))))) to Branch.Branch_Recr
37924>>>>>>>    End_Procedure   // Creating
37925>>>>>>>
37925>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
37926>>>>>>>        // Insert Code Here
37926>>>>>>>        Case Begin
37926>>>>>>>             Case (iError_Num = 1001)
37928>>>>>>>                  Error 1001 "DDC 002:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
37929>>>>>>>>
37929>>>>>>>             Case Break
37930>>>>>>>
37930>>>>>>>             Case Else
37930>>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
37932>>>>>>>        Case End
37932>>>>>>>    End_Procedure   // Operation_Not_Allowed
37933>>>>>>>
37933>>>>>>>
37933>>>>>>>    // Validate_Save:
37933>>>>>>>
37933>>>>>>>    Function Validate_Save  Returns Integer
37934>>>>>>>        Local Integer iReturnVal
37935>>>>>>>        Forward Get Validate_Save  To iReturnVal
37937>>>>>>>        If (Not(iReturnVal)) Begin
37939>>>>>>>            // Insert Code Here
37939>>>>>>>            If (Branch.Branch_Code="") Send Operation_Not_Allowed 1001
37942>>>>>>>        End
37942>>>>>>>>
37942>>>>>>>        Function_Return iReturnVal
37943>>>>>>>    End_Function   // Validate_Save
37944>>>>>>>
37944>>>>>>>
37944>>>>>>>    // Define_Fields:
37944>>>>>>>    // This procedure is used to set up all data-dictionary rules.
37944>>>>>>>
37944>>>>>>>    Procedure Define_Fields
37945>>>>>>>        Forward Send Define_Fields
37947>>>>>>>        //DDB-Generated-Code-Location
37947>>>>>>>        //DDB-DefineFieldStart
37947>>>>>>>
37947>>>>>>>        Set Main_File            To Branch.File_Number
37948>>>>>>>        Set Cascade_Delete_State To FALSE
37949>>>>>>>
37949>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
37950>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOENTER     DD_FINDREQ    
37951>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
37952>>>>>>>
37952>>>>>>>        // Child (Client) file structure................
37952>>>>>>>        Send Add_Client_File  Year.File_Number
37953>>>>>>>        Send Add_Client_File  Brzones.File_Number
37954>>>>>>>        Send Add_Client_File  Tpbranch.File_Number
37955>>>>>>>
37955>>>>>>>        // Parent (Server) file structure...............
37955>>>>>>>        Send Add_Server_File  Company.File_Number
37956>>>>>>>
37956>>>>>>>        // External (System) file structure.............
37956>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
37957>>>>>>>
37957>>>>>>>        Define_Auto_Increment  Sysrecg.Branch_Rec0  To Branch.Branch_Rec0
37960>>>>>>>
37960>>>>>>>        // Field-based properties.......................
37960>>>>>>>
37960>>>>>>>        // Branch.Company_Code
37960>>>>>>>
37960>>>>>>>        // Branch.Branch_Code
37960>>>>>>>        Set Field_Options          Field Branch.Branch_Code To DD_AUTOFIND   
37961>>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Code To (SL002(Self))
37962>>>>>>>        Set Key_Field_State        Field Branch.Branch_Code To TRUE
37963>>>>>>>
37963>>>>>>>        // Branch.Branch_Rec0
37963>>>>>>>
37963>>>>>>>        // Branch.Branch_Recr
37963>>>>>>>
37963>>>>>>>        // Branch.Branch_Name
37963>>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Name To (SL002(Self))
37964>>>>>>>
37964>>>>>>>        // Branch.Branch_Afm
37964>>>>>>>
37964>>>>>>>        // Branch.Branch_Addr
37964>>>>>>>
37964>>>>>>>        // Branch.Branch_Tk
37964>>>>>>>
37964>>>>>>>        // Branch.Branch_Poli
37964>>>>>>>
37964>>>>>>>        // Branch.Branch_Doy
37964>>>>>>>        Set Field_Value_Table      Field Branch.Branch_Doy To (Branch_Branch_Doy_VT(Self))
37965>>>>>>>
37965>>>>>>>        // Branch.Branch_J_Code
37965>>>>>>>
37965>>>>>>>        // Branch.Branch_C_Code0
37965>>>>>>>        Set Field_Value_Table      Field Branch.Branch_C_Code0 To (Branch_Branch_C_Code0_VT(Self))
37966>>>>>>>
37966>>>>>>>        // Branch.Branch_C_Code00
37966>>>>>>>
37966>>>>>>>        // Branch.Branch_C_Coder
37966>>>>>>>
37966>>>>>>>        // Branch.Branch_Tel
37966>>>>>>>
37966>>>>>>>        // Branch.Branch_Fax
37966>>>>>>>
37966>>>>>>>        // Branch.Branch_Email
37966>>>>>>>
37966>>>>>>>        // Branch.Branch_Resp
37966>>>>>>>
37966>>>>>>>        // Branch.Branch_Bitmap
37966>>>>>>>
37966>>>>>>>        // Branch.Branch_Site
37966>>>>>>>
37966>>>>>>>        // Branch.Branch_Apoth
37966>>>>>>>
37966>>>>>>>        // Branch.Beto_Site
37966>>>>>>>
37966>>>>>>>        // Branch.Path_Exp
37966>>>>>>>
37966>>>>>>>        // Branch.Exp_Txtname
37966>>>>>>>
37966>>>>>>>        // Branch.Send_Phone
37966>>>>>>>
37966>>>>>>>        // Branch.Send_Path_Files
37966>>>>>>>
37966>>>>>>>        // Branch.Send_Path_Conf
37966>>>>>>>
37966>>>>>>>        // Branch.Tomeas_Code
37966>>>>>>>
37966>>>>>>>        // Branch.Ftp_Sec_Retry
37966>>>>>>>
37966>>>>>>>        // Branch.Ftp_Sec_Exit
37966>>>>>>>
37966>>>>>>>        // Branch.Ras_Name
37966>>>>>>>
37966>>>>>>>        // Branch.Ras_Passw
37966>>>>>>>
37966>>>>>>>        // Branch.Ras_Domain
37966>>>>>>>
37966>>>>>>>        // Branch.Last_Hmnia_Ekt
37966>>>>>>>
37966>>>>>>>        // Branch.Deop_Logo
37966>>>>>>>
37966>>>>>>>        // Branch.Entolh
37966>>>>>>>
37966>>>>>>>        // Branch.Paragogh
37966>>>>>>>
37966>>>>>>>        // Branch.Locked_Until
37966>>>>>>>
37966>>>>>>>        // Branch.Sap_Code
37966>>>>>>>
37966>>>>>>>        // Branch.Perioxh
37966>>>>>>>
37966>>>>>>>        // Branch.Egkatastash
37966>>>>>>>
37966>>>>>>>        // Branch.Date_Locked
37966>>>>>>>        Set Field_Mask_Type        Field Branch.Date_Locked To MASK_DATE_WINDOW
37967>>>>>>>
37967>>>>>>>        // Branch.Ypokat1
37967>>>>>>>
37967>>>>>>>        // Branch.Ypokat1a
37967>>>>>>>
37967>>>>>>>        // Branch.Ypokat2
37967>>>>>>>
37967>>>>>>>        // Branch.Edra1
37967>>>>>>>
37967>>>>>>>        // Branch.Edra1a
37967>>>>>>>
37967>>>>>>>        // Branch.Edra2
37967>>>>>>>
37967>>>>>>>        //DDB-DefineFieldEnd
37967>>>>>>>    End_Procedure    // Define_Fields
37968>>>>>>>
37968>>>>>>>    // Field_Defaults:
37968>>>>>>>    // This procedure is used to establish default field values.
37968>>>>>>>
37968>>>>>>>    Procedure Field_Defaults
37969>>>>>>>        Forward Send Field_Defaults
37971>>>>>>>        //DDB-Generated-Code-Location
37971>>>>>>>        //DDB-FieldDefaultStart
37971>>>>>>>        //DDB-FieldDefaultEnd
37971>>>>>>>    End_Procedure    // Field_Defaults
37972>>>>>>>End_Class    // Branch_DataDictionary
37973>>>>>>>
37973>>>>>>>//DDB-Selection-pkg-Start
37973>>>>>>>
37973>>>>>>>Use Sl002.sl         // SL002
INCLUDING FILE: SL002.SL
37973>>>>>>>>>//AB/ Project SL002:Branch
37973>>>>>>>>>//AB/ Object prj is a Lookup_Project
37973>>>>>>>>>//AB/     Set ProjectName to "SL002:Branch"
37973>>>>>>>>>//AB/     Set ProjectFileName to "Sl002.sl"
37973>>>>>>>>>
37973>>>>>>>>>// Project Object Structure
37973>>>>>>>>>//   SL002 is a dbModalPanelSub
37973>>>>>>>>>//     Company_DD is a DataDictionary
37973>>>>>>>>>//     Branch_DD is a DataDictionary
37973>>>>>>>>>//     oSelList is a dbListSub
37973>>>>>>>>>//     oOK_bn is a ButtonSub
37973>>>>>>>>>//     oCancel_bn is a ButtonSub
37973>>>>>>>>>//     oSearch_bn is a ButtonSub
37973>>>>>>>>>
37973>>>>>>>>>// Register all objects
37973>>>>>>>>>Register_Object Branch_DD
37973>>>>>>>>>Register_Object Company_DD
37973>>>>>>>>>Register_Object oCancel_bn
37973>>>>>>>>>Register_Object oOK_bn
37973>>>>>>>>>Register_Object oSearch_bn
37973>>>>>>>>>Register_Object oSelList
37973>>>>>>>>>Register_Object SL002
37973>>>>>>>>>
37973>>>>>>>>>
37973>>>>>>>>>//AB-IgnoreStart
37973>>>>>>>>>
37973>>>>>>>>>Use DFAllEnt.pkg
37973>>>>>>>>>Use dbList.Sub
37973>>>>>>>>>Use Button.Sub
37973>>>>>>>>>
37973>>>>>>>>>
37973>>>>>>>>>Use COMPANY.DD
37973>>>>>>>>>Use BRANCH.DD
37973>>>>>>>>>
37973>>>>>>>>>//AB-IgnoreEnd
37973>>>>>>>>>
37973>>>>>>>>>Object SL002 is a dbModalPanelSub
37975>>>>>>>>>
37975>>>>>>>>>    //AB-StoreTopStart
37975>>>>>>>>>    Property String psFragmaCompanyCode  ""
37977>>>>>>>>>    
37977>>>>>>>>>    //AB-StoreTopEnd
37977>>>>>>>>>
37977>>>>>>>>>    Set Minimize_Icon to FALSE
37978>>>>>>>>>    Set Label to "“§¦¡˜«˜©«ã£˜«˜"
37979>>>>>>>>>    Set Size to 146 430
37980>>>>>>>>>    Set Location to 4 5
37981>>>>>>>>>    Set Exit_Application_Local_State to FALSE
37982>>>>>>>>>    Set Modal_State to FALSE
37983>>>>>>>>>
37983>>>>>>>>>    //AB-DDOStart
37983>>>>>>>>>
37983>>>>>>>>>    Object Company_DD is a Company_DataDictionary
37985>>>>>>>>>    End_Object    // Company_DD
37986>>>>>>>>>
37986>>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
37988>>>>>>>>>        Set DDO_Server to (Company_DD(self))
37989>>>>>>>>>
37989>>>>>>>>>        //AB-StoreStart
37989>>>>>>>>>        Procedure OnConstrain
37991>>>>>>>>>             String lsCompanyCode
37992>>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
37993>>>>>>>>>             If (lsCompanyCode <> "") Constrain Branch.Company_code eq lsCompanyCode
37997>>>>>>>>>        End_Procedure // OnConstrain
37998>>>>>>>>>        
37998>>>>>>>>>        
37998>>>>>>>>>        
37998>>>>>>>>>        //AB-StoreEnd
37998>>>>>>>>>
37998>>>>>>>>>    End_Object    // Branch_DD
37999>>>>>>>>>
37999>>>>>>>>>    Set Main_DD to (Branch_DD(self))
38000>>>>>>>>>    Set Server to (Branch_DD(self))
38001>>>>>>>>>
38001>>>>>>>>>    //AB-DDOEnd
38001>>>>>>>>>
38001>>>>>>>>>    Object oSelList is a dbListSub
38003>>>>>>>>>        Set Main_File to Branch.File_Number
38004>>>>>>>>>        Set Size to 105 415
38005>>>>>>>>>        Set Location to 6 6
38006>>>>>>>>>
38006>>>>>>>>>        Begin_Row
38009>>>>>>>>>            Entry_Item Branch.Branch_code
38010>>>>>>>>>            Entry_Item Branch.Branch_name
38011>>>>>>>>>            Entry_Item Company.Company_code
38012>>>>>>>>>            Entry_Item Company.Company_name
38013>>>>>>>>>            Entry_Item Branch.Beto_site
38014>>>>>>>>>            Entry_Item Branch.Branch_recr
38015>>>>>>>>>        End_Row
38020>>>>>>>>>
38020>>>>>>>>>        Set Form_Width    item 0 to 60
38021>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
38022>>>>>>>>>        
38022>>>>>>>>>        Set Form_Width    item 1 to 128
38023>>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜"
38024>>>>>>>>>        
38024>>>>>>>>>        Set Form_Width    item 2 to 69
38025>>>>>>>>>        Set Header_Label  item 2 to "‰à› ¡æª „«˜ ¨å˜ª"
38026>>>>>>>>>        
38026>>>>>>>>>        Set Form_Width    item 3 to 109
38027>>>>>>>>>        Set Header_Label  item 3 to "Ž¤¦£˜ „«˜ ¨å˜ª"
38028>>>>>>>>>        
38028>>>>>>>>>        Set Form_Width    item 4 to 42
38029>>>>>>>>>        Set Header_Label  item 4 to "Site"
38030>>>>>>>>>        
38030>>>>>>>>>        Set Form_Width    item 5 to 0
38031>>>>>>>>>        Set Header_Label  item 5 to ""
38032>>>>>>>>>        
38032>>>>>>>>>
38032>>>>>>>>>        //AB-StoreStart
38032>>>>>>>>>                
38032>>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
38034>>>>>>>>>        
38034>>>>>>>>>        Procedure Store_Defaults
38036>>>>>>>>>            forward send Store_Defaults
38038>>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
38039>>>>>>>>>        end_Procedure // Store_Defaults
38040>>>>>>>>>        
38040>>>>>>>>>        Procedure Restore_Defaults
38042>>>>>>>>>            forward send Restore_Defaults
38044>>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
38045>>>>>>>>>        end_Procedure // Restore_Defaults
38046>>>>>>>>>        
38046>>>>>>>>>        Procedure Activating
38048>>>>>>>>>            Forward Send Activating
38050>>>>>>>>>            Send Rebuild_Constraints to (Branch_DD(self))
38051>>>>>>>>>        End_Procedure // Activating
38052>>>>>>>>>        
38052>>>>>>>>>        Set Column_Options Item 5 to NoEnter True
38053>>>>>>>>>        
38053>>>>>>>>>        
38053>>>>>>>>>        //AB-StoreEnd
38053>>>>>>>>>
38053>>>>>>>>>    End_Object    // oSelList
38054>>>>>>>>>
38054>>>>>>>>>    Object oOK_bn is a ButtonSub
38056>>>>>>>>>        Set Label to "&„§ ¢¦šã"
38057>>>>>>>>>        Set Location to 112 262
38058>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
38059>>>>>>>>>
38059>>>>>>>>>        //AB-StoreStart
38059>>>>>>>>>        Procedure OnClick
38061>>>>>>>>>            Send OK To (oSelList(current_object))
38062>>>>>>>>>        End_Procedure
38063>>>>>>>>>        //AB-StoreEnd
38063>>>>>>>>>
38063>>>>>>>>>    End_Object    // oOK_bn
38064>>>>>>>>>
38064>>>>>>>>>    Object oCancel_bn is a ButtonSub
38066>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
38067>>>>>>>>>        Set Location to 112 317
38068>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
38069>>>>>>>>>
38069>>>>>>>>>        //AB-StoreStart
38069>>>>>>>>>        Procedure OnClick
38071>>>>>>>>>            Send Cancel To (oSelList(current_object))
38072>>>>>>>>>        End_Procedure
38073>>>>>>>>>        //AB-StoreEnd
38073>>>>>>>>>
38073>>>>>>>>>    End_Object    // oCancel_bn
38074>>>>>>>>>
38074>>>>>>>>>    Object oSearch_bn is a ButtonSub
38076>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
38077>>>>>>>>>        Set Location to 112 372
38078>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
38079>>>>>>>>>
38079>>>>>>>>>        //AB-StoreStart
38079>>>>>>>>>        Procedure OnClick
38081>>>>>>>>>            Send Search To (oSelList(current_object))
38082>>>>>>>>>        End_Procedure
38083>>>>>>>>>        //AB-StoreEnd
38083>>>>>>>>>
38083>>>>>>>>>    End_Object    // oSearch_bn
38084>>>>>>>>>
38084>>>>>>>>>
38084>>>>>>>>>    //AB-StoreStart
38084>>>>>>>>>    
38084>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
38085>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
38086>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
38087>>>>>>>>>    
38087>>>>>>>>>    
38087>>>>>>>>>    
38087>>>>>>>>>    //AB-StoreEnd
38087>>>>>>>>>
38087>>>>>>>>>End_Object    // SL002
38088>>>>>>>>>
38088>>>>>>>>>//AB/ End_Object    // prj
38088>>>>>>>
38088>>>>>>>//DDB-Selection-pkg-End
38088>>>>>>>//DDB-FileEnd
38088>>>>>    Use YEAR.DD
INCLUDING FILE: YEAR.DD
38088>>>>>>>//DDB-FileStart
38088>>>>>>>//DDB-HeaderStart
38088>>>>>>>
38088>>>>>>>// File Name : YEAR.DD
38088>>>>>>>// Class Name: Year_DataDictionary
38088>>>>>>>// Revision  : 119
38088>>>>>>>// Version   : 2
38088>>>>>>>
38088>>>>>>>Use  Windows           // Basic Definitions
38088>>>>>>>Use  DataDict          // DataDictionary Class Definition
38088>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38088>>>>>>>
38088>>>>>>>Open Year
38090>>>>>>>Open Branch
38092>>>>>>>Open Syscurxr
38094>>>>>>>
38094>>>>>>>//DDB-HeaderEnd
38094>>>>>>>//DDB-ValidationStart
38094>>>>>>>
38094>>>>>>>Register_Object Year_Year_C_Code0_VT1
38094>>>>>>>Register_Object Year_Year_C_Code00_VT1
38094>>>>>>>Register_Object Year_Year_C_Coder_VT1
38094>>>>>>>
38094>>>>>>>Object Year_Year_C_Code0_VT1  is a CodeValidationTable
38096>>>>>>>    Set Type_Value        To "CURRENCY"
38097>>>>>>>    //DDB-ValidationCustomStart
38097>>>>>>>    //DDB-ValidationCustomEnd
38097>>>>>>>End_Object   // Year_Year_C_Code0_VT1
38098>>>>>>>
38098>>>>>>>Object Year_Year_C_Code00_VT1  is a CodeValidationTable
38100>>>>>>>    Set Type_Value        To "CURRENCY"
38101>>>>>>>    //DDB-ValidationCustomStart
38101>>>>>>>    //DDB-ValidationCustomEnd
38101>>>>>>>End_Object   // Year_Year_C_Code00_VT1
38102>>>>>>>
38102>>>>>>>Object Year_Year_C_Coder_VT1  is a CodeValidationTable
38104>>>>>>>    Set Type_Value        To "CURRENCY"
38105>>>>>>>    //DDB-ValidationCustomStart
38105>>>>>>>    //DDB-ValidationCustomEnd
38105>>>>>>>End_Object   // Year_Year_C_Coder_VT1
38106>>>>>>>//DDB-ValidationEnd
38106>>>>>>>//DDB-SelectionStart
38106>>>>>>>//DDB/ ExternalSelectionList SL003  Sl003.sl
38106>>>>>>>Register_Object SL003
38106>>>>>>>//DDB-SelectionEnd
38106>>>>>>>            
38106>>>>>>>Class Year_DataDictionary  is a DataDictionary
38107>>>>>>>    
38107>>>>>>>    Procedure Creating
38108>>>>>>>        Forward Send Creating
38110>>>>>>>        // Insert Code Here
38110>>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Year.Year_Year)))))) to Year.Year_Recr
38111>>>>>>>    End_Procedure   // Creating
38112>>>>>>>
38112>>>>>>>
38112>>>>>>>    // Operation_Not_Allowed:
38112>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
38113>>>>>>>        // Insert Code Here
38113>>>>>>>        Case Begin    
38113>>>>>>>             Case (iError_Num = 1001)
38115>>>>>>>                  Error 1001 "DDC 053:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
38116>>>>>>>>
38116>>>>>>>             Case Break
38117>>>>>>>             Case (iError_Num=1002)
38120>>>>>>>                Error 1002 "DDC 053:Branch Site ¡˜«œ™˜å¤œ  ©«¦ Year ¡œ¤æ"
38121>>>>>>>>
38121>>>>>>>             Case Break
38122>>>>>>>             Case (iError_Num=1003)
38125>>>>>>>                Error 1003 "DDC 053:Company Code=0"
38126>>>>>>>>
38126>>>>>>>             Case Break
38127>>>>>>>             Case (iError_Num=1004)
38130>>>>>>>                Error 1004 "DDC 053:Branch Code=0"
38131>>>>>>>>
38131>>>>>>>             Case Break
38132>>>>>>>             Case Else
38132>>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
38134>>>>>>>        Case End
38134>>>>>>>    End_Procedure   // Operation_Not_Allowed
38135>>>>>>>
38135>>>>>>>
38135>>>>>>>    // Update:
38135>>>>>>>    // Use this message to effect changes in related-to files. The
38135>>>>>>>    // Backout message should be designed to reverse the effects of this
38135>>>>>>>    // message. It is invoked while the database is locked.
38135>>>>>>>
38135>>>>>>>    Procedure Update
38136>>>>>>>        Forward Send Update
38138>>>>>>>        // Insert Code Here
38138>>>>>>>        Move Company.Company_Code   to Year.Company_Code
38139>>>>>>>        Move Branch.Branch_Code     to Year.Branch_Code
38140>>>>>>>        move branch.beto_site       to year.beto_site
38141>>>>>>>
38141>>>>>>>        //sos:parametrika apo sysfile?
38141>>>>>>>       
38141>>>>>>>       // If ((Year.Year_EntryDate-14) < Year.Year_XrhshFrom) Begin
38141>>>>>>>       //     Move Year.Year_XrhshFrom to Year.Year_OpenFrom
38141>>>>>>>       // End
38141>>>>>>>       // Else Begin
38141>>>>>>>       //     Move (Year.Year_EntryDate-14) to Year.Year_OpenFrom
38141>>>>>>>       // End
38141>>>>>>>      //  Move Year.Year_EntryDate      to Year.Year_OpenTo
38141>>>>>>>    End_Procedure   // Update
38142>>>>>>>
38142>>>>>>>    // Validate_Save:
38142>>>>>>>
38142>>>>>>>    Function Validate_Save  Returns Integer
38143>>>>>>>        Local Integer iReturnVal
38144>>>>>>>        Forward Get Validate_Save  To iReturnVal
38146>>>>>>>        If (Not(iReturnVal)) Begin
38148>>>>>>>                 If (Year.Year_Year   = 0) Send Operation_Not_Allowed 1001
38151>>>>>>>            Else If (Year.Company_Code='') Send Operation_Not_Allowed 1003
38155>>>>>>>            Else If (Year.Branch_Code ='') Send Operation_Not_Allowed 1004
38159>>>>>>>        End
38159>>>>>>>>
38159>>>>>>>        Function_Return iReturnVal
38160>>>>>>>    End_Function   // Validate_Save
38161>>>>>>>
38161>>>>>>>
38161>>>>>>>    // Define_Fields:
38161>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38161>>>>>>>
38161>>>>>>>    Procedure Define_Fields
38162>>>>>>>        Forward Send Define_Fields
38164>>>>>>>        //DDB-Generated-Code-Location
38164>>>>>>>        //DDB-DefineFieldStart
38164>>>>>>>
38164>>>>>>>        Set Main_File            To Year.File_Number
38165>>>>>>>        Set Cascade_Delete_State To FALSE
38166>>>>>>>
38166>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38167>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38168>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38169>>>>>>>
38169>>>>>>>        // Parent (Server) file structure...............
38169>>>>>>>        Send Add_Server_File  Branch.File_Number
38170>>>>>>>
38170>>>>>>>        // External (System) file structure.............
38170>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
38171>>>>>>>
38171>>>>>>>        // Field-based properties.......................
38171>>>>>>>
38171>>>>>>>        // Year.Company_Code
38171>>>>>>>
38171>>>>>>>        // Year.Branch_Code
38171>>>>>>>
38171>>>>>>>        // Year.Year_Year
38171>>>>>>>        Set Field_Options          Field Year.Year_Year To DD_AUTOFIND    DD_REQUIRED   
38172>>>>>>>        Set Field_Prompt_Object    Field Year.Year_Year To (SL003(Self))
38173>>>>>>>        Set Key_Field_State        Field Year.Year_Year To TRUE
38174>>>>>>>
38174>>>>>>>        // Year.Year_Recr
38174>>>>>>>        Set Field_Prompt_Object    Field Year.Year_Recr To (SL003(Self))
38175>>>>>>>
38175>>>>>>>        // Year.Branch_Recr
38175>>>>>>>
38175>>>>>>>        // Year.Year_Descr
38175>>>>>>>
38175>>>>>>>        // Year.Year_Isolfrom
38175>>>>>>>
38175>>>>>>>        // Year.Year_Isolto
38175>>>>>>>
38175>>>>>>>        // Year.Year_Openfrom
38175>>>>>>>
38175>>>>>>>        // Year.Year_Opento
38175>>>>>>>
38175>>>>>>>        // Year.Year_Entrydate
38175>>>>>>>
38175>>>>>>>        // Year.Year_Dateaa
38175>>>>>>>
38175>>>>>>>        // Year.Year_Xrhshfrom
38175>>>>>>>
38175>>>>>>>        // Year.Year_Xrhshto
38175>>>>>>>
38175>>>>>>>        // Year.Year_Myflimit
38175>>>>>>>
38175>>>>>>>        // Year.Year_Numgtypkin
38175>>>>>>>
38175>>>>>>>        // Year.Year_Numgarticl
38175>>>>>>>
38175>>>>>>>        // Year.Year_Numgmove
38175>>>>>>>
38175>>>>>>>        // Year.Year_Numgplan
38175>>>>>>>
38175>>>>>>>        // Year.Year_Numgformat
38175>>>>>>>
38175>>>>>>>        // Year.Year_Numgthaa
38175>>>>>>>
38175>>>>>>>        // Year.Year_Numgopen
38175>>>>>>>
38175>>>>>>>        // Year.Year_Numbtypkin
38175>>>>>>>
38175>>>>>>>        // Year.Year_Numbaxio
38175>>>>>>>
38175>>>>>>>        // Year.Year_Numbarticl
38175>>>>>>>
38175>>>>>>>        // Year.Year_Numbmove
38175>>>>>>>
38175>>>>>>>        // Year.Year_Delimiter
38175>>>>>>>
38175>>>>>>>        // Year.Year_Printer
38175>>>>>>>
38175>>>>>>>        // Year.Year_Valid_Char
38175>>>>>>>
38175>>>>>>>        // Year.Year_C_Code0
38175>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0 To "dbComboFormSub"
38176>>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code0 To (Year_Year_C_Code0_VT1(Self))
38177>>>>>>>
38177>>>>>>>        // Year.Year_C_Code00
38177>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00 To "dbComboFormSub"
38178>>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code00 To (Year_Year_C_Code00_VT1(Self))
38179>>>>>>>
38179>>>>>>>        // Year.Year_C_Coder
38179>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder To "dbComboFormSub"
38180>>>>>>>        Set Field_Value_Table      Field Year.Year_C_Coder To (Year_Year_C_Coder_VT1(Self))
38181>>>>>>>
38181>>>>>>>        // Year.Beto_Site
38181>>>>>>>
38181>>>>>>>        // Year.Clients_Plafon
38181>>>>>>>
38181>>>>>>>        // Year.Payresp_Plafon
38181>>>>>>>
38181>>>>>>>        // Year.Clients_Ofeilh
38181>>>>>>>
38181>>>>>>>        // Year.Payresp_Ofeilh
38181>>>>>>>
38181>>>>>>>        // Year.Working
38181>>>>>>>
38181>>>>>>>        //DDB-DefineFieldEnd
38181>>>>>>>
38181>>>>>>>        Set Main_File            To Year.File_Number
38182>>>>>>>        Set Cascade_Delete_State To FALSE
38183>>>>>>>
38183>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
38184>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
38185>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38186>>>>>>>
38186>>>>>>>        // Child (Client) file structure................
38186>>>>>>>
38186>>>>>>>        // Parent (Server) file structure...............
38186>>>>>>>        Send Add_Server_File  Branch.File_Number
38187>>>>>>>
38187>>>>>>>        // Field-based properties.......................
38187>>>>>>>
38187>>>>>>>        // Year.Company_Code
38187>>>>>>>
38187>>>>>>>        // Year.Branch_Code
38187>>>>>>>
38187>>>>>>>        // Year.Year_Year
38187>>>>>>>        Set Field_Label_Long       Field Year.Year_Year           To "•¨ã©ž"
38188>>>>>>>        Set Field_Label_Short      Field Year.Year_Year           To "•¨ã©ž"
38189>>>>>>>        Set Field_Options          Field Year.Year_Year           To DD_REQUIRED
38190>>>>>>>        //Set Field_Prompt_Object    Field Year.Year_Year           To (SL053(Self))
38190>>>>>>>
38190>>>>>>>        // Year.Year_Descr
38190>>>>>>>        Set Field_Label_Long       Field Year.Year_Descr          To "œ¨ š¨˜­ã •¨ã©žª"
38191>>>>>>>        Set Field_Label_Short      Field Year.Year_Descr          To "œ¨.•¨ã©žª"
38192>>>>>>>
38192>>>>>>>        // Year.Year_C_Code0
38192>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0        To "dbComboForm"
38193>>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code0        To "‰ç¨ ¦ Œæ£ ©£˜"
38194>>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code0        To "‰¬¨.Œ¦£ ©£˜"
38195>>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code0        To (Year_Year_C_Code0_VT(Self))
38195>>>>>>>
38195>>>>>>>        // Year.Year_C_Code00
38195>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00       To "dbComboForm"
38196>>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
38197>>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
38198>>>>>>>        //Set Field_Options          Field Year.Year_C_Code00       To DD_REQUIRED
38198>>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code00       To (Year_Year_C_Code1_VT(Self))
38198>>>>>>>
38198>>>>>>>        // Year.Year_C_Coder
38198>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder        To "dbComboForm"
38199>>>>>>>        Set Field_Label_Long       Field Year.Year_C_Coder        To "Œæ£ ©£˜ REPORTING"
38200>>>>>>>        Set Field_Label_Short      Field Year.Year_C_Coder        To "Œæ£ ©£˜ REP"
38201>>>>>>>        //Set Field_Options          Field Year.Year_C_Coder        To DD_REQUIRED
38201>>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Coder        To (Year_Year_C_Coder_VT(Self))
38201>>>>>>>
38201>>>>>>>        // Year.Year_Isolfrom
38201>>>>>>>        Set Field_Label_Long       Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
38202>>>>>>>        Set Field_Label_Short      Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
38203>>>>>>>
38203>>>>>>>        // Year.Year_Isolto
38203>>>>>>>        Set Field_Label_Long       Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
38204>>>>>>>        Set Field_Label_Short      Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
38205>>>>>>>
38205>>>>>>>        // Year.Year_Openfrom
38205>>>>>>>        Set Field_Label_Long       Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
38206>>>>>>>        Set Field_Label_Short      Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
38207>>>>>>>
38207>>>>>>>        // Year.Year_Opento
38207>>>>>>>        Set Field_Label_Long       Field Year.Year_Opento         To "„šš¨˜­âª „àª"
38208>>>>>>>        Set Field_Label_Short      Field Year.Year_Opento         To "„šš¨˜­âª „àª"
38209>>>>>>>
38209>>>>>>>        // Year.Year_Entrydate
38209>>>>>>>        Set Field_Label_Long       Field Year.Year_Entrydate      To "†£œ¨¦£ž¤å˜ „¨š˜©å˜ª"
38210>>>>>>>        Set Field_Label_Short      Field Year.Year_Entrydate      To "†£/¤å˜ „¨š˜©å˜ª"
38211>>>>>>>
38211>>>>>>>        // Year.Year_Dateaa
38211>>>>>>>
38211>>>>>>>        // Year.Year_Xrhshfrom
38211>>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
38212>>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
38213>>>>>>>
38213>>>>>>>        // Year.Year_Xrhshto
38213>>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
38214>>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
38215>>>>>>>
38215>>>>>>>        // Year.Year_Myflimit
38215>>>>>>>        Set Field_Label_Long       Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
38216>>>>>>>        Set Field_Label_Short      Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
38217>>>>>>>
38217>>>>>>>        // Year.Year_Numgtypkin
38217>>>>>>>        Set Field_Options          Field Year.Year_Numgtypkin     To DD_DISPLAYONLY
38218>>>>>>>
38218>>>>>>>        // Year.Year_Numgarticl
38218>>>>>>>        Set Field_Options          Field Year.Year_Numgarticl     To DD_DISPLAYONLY
38219>>>>>>>
38219>>>>>>>        // Year.Year_Numgmove
38219>>>>>>>        Set Field_Options          Field Year.Year_Numgmove       To DD_DISPLAYONLY
38220>>>>>>>
38220>>>>>>>        // Year.Year_Numgplan
38220>>>>>>>        Set Field_Options          Field Year.Year_Numgplan       To DD_DISPLAYONLY
38221>>>>>>>
38221>>>>>>>        // Year.Year_Numgformat
38221>>>>>>>        Set Field_Options          Field Year.Year_Numgformat     To DD_DISPLAYONLY
38222>>>>>>>
38222>>>>>>>        // Year.Year_Numgthaa
38222>>>>>>>        Set Field_Options          Field Year.Year_Numgthaa       To DD_DISPLAYONLY
38223>>>>>>>
38223>>>>>>>        // Year.Year_Numgopen
38223>>>>>>>        Set Field_Options          Field Year.Year_Numgopen       To DD_DISPLAYONLY
38224>>>>>>>
38224>>>>>>>        // Year.Year_Numbaxio
38224>>>>>>>        Set Field_Options          Field Year.Year_Numbaxio       To DD_DISPLAYONLY
38225>>>>>>>
38225>>>>>>>        // Year.Year_Numbarticl
38225>>>>>>>        Set Field_Options          Field Year.Year_Numbarticl     To DD_DISPLAYONLY
38226>>>>>>>
38226>>>>>>>        // Year.Year_Numbmove
38226>>>>>>>        Set Field_Options          Field Year.Year_Numbmove       To DD_DISPLAYONLY
38227>>>>>>>
38227>>>>>>>        // Year.Year_Delimiter
38227>>>>>>>        Set Status_Help            Field Year.Year_Delimiter      To "ƒ ˜®à¨ ©« ¡æ š ˜ «¦ Š‘ «žª •¨ã©œàª"
38228>>>>>>>
38228>>>>>>>        // Year.Year_Printer
38228>>>>>>>
38228>>>>>>>        // Year.Year_Valid_Char
38228>>>>>>>
38228>>>>>>>    End_Procedure    // Define_Fields
38229>>>>>>>
38229>>>>>>>    // Field_Defaults:
38229>>>>>>>    // This procedure is used to establish default field values.
38229>>>>>>>
38229>>>>>>>    Procedure Field_Defaults
38230>>>>>>>        Forward Send Field_Defaults
38232>>>>>>>        //DDB-Generated-Code-Location
38232>>>>>>>        //DDB-FieldDefaultStart
38232>>>>>>>        //DDB-FieldDefaultEnd
38232>>>>>>>        Set Field_Changed_Value   Field Year.Year_Delimiter      To "."
38233>>>>>>>        Set Field_Changed_Value   Field Year.Year_Printer        To "LPT1:"
38234>>>>>>>        Set Field_Changed_Value   Field Year.Year_Valid_Char     To "1234567890"
38235>>>>>>>    End_Procedure    // Field_Defaults
38236>>>>>>>
38236>>>>>>>End_Class    // Year_DataDictionary
38237>>>>>>>//DDB-Selection-pkg-Start
38237>>>>>>>
38237>>>>>>>Use Sl003.sl         // SL003
INCLUDING FILE: SL003.SL
38237>>>>>>>>>//AB/ Project SL003:Year
38237>>>>>>>>>//AB/ Object prj is a Lookup_Project
38237>>>>>>>>>//AB/     Set ProjectName to "SL003:Year"
38237>>>>>>>>>//AB/     Set ProjectFileName to "Sl003.sl"
38237>>>>>>>>>
38237>>>>>>>>>// Project Object Structure
38237>>>>>>>>>//   SL003 is a dbModalPanelSub
38237>>>>>>>>>//     Company_DD is a DataDictionary
38237>>>>>>>>>//     Branch_DD is a DataDictionary
38237>>>>>>>>>//     Year_DD is a DataDictionary
38237>>>>>>>>>//     oSelList is a dbListSub
38237>>>>>>>>>//     oOK_bn is a ButtonSub
38237>>>>>>>>>//     oCancel_bn is a ButtonSub
38237>>>>>>>>>//     oSearch_bn is a ButtonSub
38237>>>>>>>>>
38237>>>>>>>>>// Register all objects
38237>>>>>>>>>Register_Object Branch_DD
38237>>>>>>>>>Register_Object Company_DD
38237>>>>>>>>>Register_Object oCancel_bn
38237>>>>>>>>>Register_Object oOK_bn
38237>>>>>>>>>Register_Object oSearch_bn
38237>>>>>>>>>Register_Object oSelList
38237>>>>>>>>>Register_Object SL003
38237>>>>>>>>>Register_Object Year_DD
38237>>>>>>>>>
38237>>>>>>>>>
38237>>>>>>>>>//AB-IgnoreStart
38237>>>>>>>>>
38237>>>>>>>>>Use DFAllEnt.pkg
38237>>>>>>>>>Use dbList.Sub
38237>>>>>>>>>Use Button.Sub
38237>>>>>>>>>
38237>>>>>>>>>
38237>>>>>>>>>Use COMPANY.DD
38237>>>>>>>>>Use BRANCH.DD
38237>>>>>>>>>Use YEAR.DD
38237>>>>>>>>>
38237>>>>>>>>>//AB-IgnoreEnd
38237>>>>>>>>>
38237>>>>>>>>>CD_Popup_Object SL003 is a dbModalPanelSub
38256>>>>>>>>>
38256>>>>>>>>>    //AB-StoreTopStart
38256>>>>>>>>>    Property String psFragmaCompanyCode  ""
38258>>>>>>>>>    Property String psFragmaBranchCode   ""
38260>>>>>>>>>    property integer pifragmaactive public 0
38262>>>>>>>>>    //AB-StoreTopEnd
38262>>>>>>>>>
38262>>>>>>>>>    Set Minimize_Icon to FALSE
38263>>>>>>>>>    Set Label to "•¨ã©œ ª"
38264>>>>>>>>>    Set Size to 149 449
38265>>>>>>>>>    Set Location to 4 7
38266>>>>>>>>>    Set Exit_Application_Local_State to FALSE
38267>>>>>>>>>    Set Modal_State to FALSE
38268>>>>>>>>>
38268>>>>>>>>>    //AB-DDOStart
38268>>>>>>>>>
38268>>>>>>>>>    Object Company_DD is a Company_DataDictionary
38270>>>>>>>>>    End_Object    // Company_DD
38271>>>>>>>>>
38271>>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
38273>>>>>>>>>        Set DDO_Server to (Company_DD(self))
38274>>>>>>>>>    End_Object    // Branch_DD
38275>>>>>>>>>
38275>>>>>>>>>    Object Year_DD is a Year_DataDictionary
38277>>>>>>>>>        Set DDO_Server to (Branch_DD(self))
38278>>>>>>>>>
38278>>>>>>>>>        //AB-StoreStart
38278>>>>>>>>>        Procedure OnConstrain
38280>>>>>>>>>             String lsCompanyCode lsBranchCode
38281>>>>>>>>>             integer iactive
38281>>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
38282>>>>>>>>>             get pifragmaactive to iactive
38283>>>>>>>>>             If (lsCompanyCode <> "") Begin
38285>>>>>>>>>                Get psFragmaBranchCode  to lsBranchCode
38286>>>>>>>>>                Constrain Year.Company_Code eq lsCompanyCode
38288>>>>>>>>>                If (lsBranchCode <> "") Constrain Year.Branch_code eq lsBranchCode
38292>>>>>>>>>             End
38292>>>>>>>>>>
38292>>>>>>>>>             if (iactive = 0) constrain year.working ne 1
38296>>>>>>>>>        End_Procedure // OnConstrain
38297>>>>>>>>>        
38297>>>>>>>>>        
38297>>>>>>>>>        
38297>>>>>>>>>        
38297>>>>>>>>>        
38297>>>>>>>>>        //AB-StoreEnd
38297>>>>>>>>>
38297>>>>>>>>>    End_Object    // Year_DD
38298>>>>>>>>>
38298>>>>>>>>>    Set Main_DD to (Year_DD(self))
38299>>>>>>>>>    Set Server to (Year_DD(self))
38300>>>>>>>>>
38300>>>>>>>>>    //AB-DDOEnd
38300>>>>>>>>>
38300>>>>>>>>>    Object oSelList is a dbListSub
38302>>>>>>>>>        Set Main_File to Year.File_Number
38303>>>>>>>>>        Set Size to 105 433
38304>>>>>>>>>        Set Location to 6 6
38305>>>>>>>>>
38305>>>>>>>>>        Begin_Row
38308>>>>>>>>>            Entry_Item Year.Year_year
38309>>>>>>>>>            Entry_Item Company.Company_code
38310>>>>>>>>>            Entry_Item Company.Company_name
38311>>>>>>>>>            Entry_Item Branch.Branch_code
38312>>>>>>>>>            Entry_Item Branch.Branch_name
38313>>>>>>>>>        End_Row
38318>>>>>>>>>
38318>>>>>>>>>        Set Form_Width    item 0 to 36
38319>>>>>>>>>        Set Header_Label  item 0 to "•¨ã©ž :          "
38320>>>>>>>>>        
38320>>>>>>>>>        Set Form_Width    item 1 to 71
38321>>>>>>>>>        Set Header_Label  item 1 to "‰à› ¡æª „«˜ ¨å˜ª"
38322>>>>>>>>>        
38322>>>>>>>>>        Set Form_Width    item 2 to 136
38323>>>>>>>>>        Set Header_Label  item 2 to "Ž¤¦£˜ „«˜ ¨å˜ª"
38324>>>>>>>>>        
38324>>>>>>>>>        Set Form_Width    item 3 to 73
38325>>>>>>>>>        Set Header_Label  item 3 to "‰à› ¡æª “§¦¡/«¦ª"
38326>>>>>>>>>        
38326>>>>>>>>>        Set Form_Width    item 4 to 109
38327>>>>>>>>>        Set Header_Label  item 4 to "Ž¤¦£˜ “§¦¡/«¦ª"
38328>>>>>>>>>        
38328>>>>>>>>>
38328>>>>>>>>>        //AB-StoreStart
38328>>>>>>>>>                                                
38328>>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
38330>>>>>>>>>        Property String psStoreFragmaBranchCode   ""
38332>>>>>>>>>        
38332>>>>>>>>>        Procedure Store_Defaults
38334>>>>>>>>>            forward send Store_Defaults
38336>>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
38337>>>>>>>>>            Set psStoreFragmaBranchCode  to (psFragmaBranchCode(Self))
38338>>>>>>>>>        end_Procedure // Store_Defaults
38339>>>>>>>>>        
38339>>>>>>>>>        Procedure Restore_Defaults
38341>>>>>>>>>            forward send Restore_Defaults
38343>>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
38344>>>>>>>>>            Set psFragmaBranchCode  to (psStoreFragmaBranchCode(self))
38345>>>>>>>>>        end_Procedure // Restore_Defaults
38346>>>>>>>>>        
38346>>>>>>>>>        Procedure Activating
38348>>>>>>>>>            Forward Send Activating
38350>>>>>>>>>            Send Rebuild_Constraints to (Year_DD(self))
38351>>>>>>>>>        End_Procedure // Activating
38352>>>>>>>>>        
38352>>>>>>>>>        
38352>>>>>>>>>        
38352>>>>>>>>>        //AB-StoreEnd
38352>>>>>>>>>
38352>>>>>>>>>    End_Object    // oSelList
38353>>>>>>>>>
38353>>>>>>>>>    Object oOK_bn is a ButtonSub
38355>>>>>>>>>        Set Label to "&„§ ¢¦šã"
38356>>>>>>>>>        Set Location to 112 280
38357>>>>>>>>>
38357>>>>>>>>>        //AB-StoreStart
38357>>>>>>>>>        Procedure OnClick
38359>>>>>>>>>            Send OK To (oSelList(current_object))
38360>>>>>>>>>        End_Procedure
38361>>>>>>>>>        //AB-StoreEnd
38361>>>>>>>>>
38361>>>>>>>>>    End_Object    // oOK_bn
38362>>>>>>>>>
38362>>>>>>>>>    Object oCancel_bn is a ButtonSub
38364>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
38365>>>>>>>>>        Set Location to 112 335
38366>>>>>>>>>
38366>>>>>>>>>        //AB-StoreStart
38366>>>>>>>>>        Procedure OnClick
38368>>>>>>>>>            Send Cancel To (oSelList(current_object))
38369>>>>>>>>>        End_Procedure
38370>>>>>>>>>        //AB-StoreEnd
38370>>>>>>>>>
38370>>>>>>>>>    End_Object    // oCancel_bn
38371>>>>>>>>>
38371>>>>>>>>>    Object oSearch_bn is a ButtonSub
38373>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
38374>>>>>>>>>        Set Location to 112 390
38375>>>>>>>>>
38375>>>>>>>>>        //AB-StoreStart
38375>>>>>>>>>        Procedure OnClick
38377>>>>>>>>>            Send Search To (oSelList(current_object))
38378>>>>>>>>>        End_Procedure
38379>>>>>>>>>        //AB-StoreEnd
38379>>>>>>>>>
38379>>>>>>>>>    End_Object    // oSearch_bn
38380>>>>>>>>>
38380>>>>>>>>>
38380>>>>>>>>>    //AB-StoreStart
38380>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
38381>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
38382>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
38383>>>>>>>>>    
38383>>>>>>>>>    
38383>>>>>>>>>    
38383>>>>>>>>>    //AB-StoreEnd
38383>>>>>>>>>
38383>>>>>>>>>CD_End_Object    // SL003
38385>>>>>>>>>>
38385>>>>>>>>>
38385>>>>>>>>>//AB/ End_Object    // prj
38385>>>>>>>
38385>>>>>>>//DDB-Selection-pkg-End
38385>>>>>>>//DDB-FileEnd
38385>>>>>    
38385>>>>>    //AB-IgnoreEnd
38385>>>>>
38385>>>>>    Object oSelectYear is a dbModalPanelSub
38387>>>>>
38387>>>>>        //AB-StoreTopStart
38387>>>>>        
38387>>>>>        Property String  psSelectedYearRecr  ''
38389>>>>>        Property Integer piChangeState False
38391>>>>>        
38391>>>>>        //AB-StoreTopEnd
38391>>>>>
38391>>>>>        Set Minimize_Icon to FALSE
38392>>>>>        Set Label to "„§ ¢¦šã „«˜ ¨œå˜ª - “§¦¡˜«˜©«ã£˜«¦ª - •¨ã©žª"
38393>>>>>        Set Size to 111 372
38394>>>>>        Set Location to -1 28
38395>>>>>        Set Color to 12232306
38396>>>>>
38396>>>>>        //AB-DDOStart
38396>>>>>
38396>>>>>        Object Company_DD is a Company_DataDictionary
38398>>>>>
38398>>>>>            //AB-StoreStart
38398>>>>>            Set Foreign_Field_Options DD_KEYFIELD                   to DD_Clear_Field_Options DD_FindReq
38399>>>>>            Set Foreign_Field_Options DD_INDEXFIELD                 to DD_Clear_Field_Options DD_FindReq
38400>>>>>            Set Foreign_Field_Options Field Company.Company_Name    to DD_DisplayOnly
38401>>>>>            
38401>>>>>            Procedure Request_Save
38403>>>>>            End_Procedure
38404>>>>>            
38404>>>>>            Procedure Request_Delete
38406>>>>>            End_Procedure
38407>>>>>            
38407>>>>>            Set Read_Only_State to True
38408>>>>>            
38408>>>>>            
38408>>>>>            
38408>>>>>            
38408>>>>>            //AB-StoreEnd
38408>>>>>
38408>>>>>        End_Object    // Company_DD
38409>>>>>
38409>>>>>        Object Branch_DD is a Branch_DataDictionary
38411>>>>>            Set DDO_Server to (Company_DD(self))
38412>>>>>
38412>>>>>            //AB-StoreStart
38412>>>>>            Set Foreign_Field_Options DD_KEYFIELD   to DD_Clear_Field_Options DD_FindReq
38413>>>>>            Set Foreign_Field_Options DD_INDEXFIELD to DD_Clear_Field_Options DD_FindReq
38414>>>>>            
38414>>>>>            Set Foreign_Field_Options DD_KEYFIELD   to DD_AutoFind_GE
38415>>>>>            Set Foreign_Field_Options DD_INDEXFIELD to DD_AutoFind_GE
38416>>>>>            
38416>>>>>            Set Foreign_Field_Options Field Branch.Branch_Name to DD_DisplayOnly
38417>>>>>            
38417>>>>>            Procedure Request_Save
38419>>>>>            End_Procedure
38420>>>>>            
38420>>>>>            Procedure Request_Delete
38422>>>>>            End_Procedure
38423>>>>>            
38423>>>>>            Set Read_Only_State to True
38424>>>>>            
38424>>>>>            //AB-StoreEnd
38424>>>>>
38424>>>>>        End_Object    // Branch_DD
38425>>>>>
38425>>>>>        Object Year_DD is a Year_DataDictionary
38427>>>>>            Set DDO_Server to (Branch_DD(self))
38428>>>>>
38428>>>>>            //AB-StoreStart
38428>>>>>                        
38428>>>>>            Set Field_Options Field Year.Year_Descr to DD_DisplayOnly
38429>>>>>            Set Field_Options Field Year.Year_Year to DD_AutoFind_GE
38430>>>>>            
38430>>>>>            Function Validate_Delete Returns Integer
38432>>>>>                Function_Return 1
38433>>>>>            End_Function
38434>>>>>            
38434>>>>>            Procedure Request_Save
38436>>>>>            End_Procedure
38437>>>>>            
38437>>>>>            Procedure Request_Delete
38439>>>>>            End_Procedure
38440>>>>>            
38440>>>>>            Set Read_Only_State to True
38441>>>>>            
38441>>>>>            //AB-StoreEnd
38441>>>>>
38441>>>>>        End_Object    // Year_DD
38442>>>>>
38442>>>>>        Set Main_DD to (Year_DD(self))
38443>>>>>        Set Server to (Year_DD(self))
38444>>>>>
38444>>>>>        //AB-DDOEnd
38444>>>>>
38444>>>>>        Object Company_Company_Code is a dbFormSub
38446>>>>>            Entry_Item Company.Company_code
38447>>>>>            Set Size to 13 71
38448>>>>>            Set Location to 9 112
38449>>>>>            Set Color to 12232306
38450>>>>>            Set Label_Col_Offset to 2
38451>>>>>            Set Label_Justification_Mode to jMode_Right
38452>>>>>            Set Prompt_Button_Mode to pb_PromptOn
38453>>>>>            Set Auto_Clear_Deo_State to FALSE
38454>>>>>            Set Enabled_State to FALSE
38455>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38456>>>>>            Set Item_Shadow_State Item 0 to TRUE
38457>>>>>            Set Shadow_State Item 0 to TRUE
38458>>>>>
38458>>>>>            //AB-StoreStart
38458>>>>>                                
38458>>>>>            Set Prompt_Object to (sl001(Self))
38459>>>>>            
38459>>>>>            
38459>>>>>            //AB-StoreEnd
38459>>>>>
38459>>>>>        End_Object    // Company_Company_Code
38460>>>>>
38460>>>>>        Object Company_Company_Name is a dbFormSub
38462>>>>>            Entry_Item Company.Company_name
38463>>>>>            Set Size to 13 168
38464>>>>>            Set Location to 9 188
38465>>>>>            Set Color to 12232306
38466>>>>>            Set Label_Col_Offset to 2
38467>>>>>            Set Label_Justification_Mode to jMode_Right
38468>>>>>            Set Enabled_State to FALSE
38469>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38470>>>>>            Set Item_Shadow_State Item 0 to TRUE
38471>>>>>            Set Shadow_State Item 0 to TRUE
38472>>>>>
38472>>>>>            //AB-StoreStart
38472>>>>>                                
38472>>>>>            //AB-StoreEnd
38472>>>>>
38472>>>>>        End_Object    // Company_Company_Name
38473>>>>>
38473>>>>>        Object Branch_Branch_Code is a dbFormSub
38475>>>>>            Entry_Item Branch.Branch_code
38476>>>>>            Set Size to 13 71
38477>>>>>            Set Location to 23 112
38478>>>>>            Set Color to 12232306
38479>>>>>            Set Label_Col_Offset to 2
38480>>>>>            Set Label_Justification_Mode to jMode_Right
38481>>>>>            Set Prompt_Button_Mode to pb_PromptOn
38482>>>>>            Set Auto_Clear_Deo_State to FALSE
38483>>>>>            Set Enabled_State to FALSE
38484>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38485>>>>>            Set Item_Shadow_State Item 0 to TRUE
38486>>>>>            Set Shadow_State Item 0 to TRUE
38487>>>>>
38487>>>>>            //AB-StoreStart
38487>>>>>            Set Prompt_Object to (sl002(Self))
38488>>>>>            
38488>>>>>            Procedure Prompt_CallBack Integer hPrompt
38490>>>>>                string lsCompanyCode
38491>>>>>                Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
38492>>>>>                Set psFragmaCompanyCode of hPrompt to lsCompanyCode
38493>>>>>            End_Procedure
38494>>>>>            
38494>>>>>            
38494>>>>>            
38494>>>>>            
38494>>>>>            //AB-StoreEnd
38494>>>>>
38494>>>>>        End_Object    // Branch_Branch_Code
38495>>>>>
38495>>>>>        Object Branch_Branch_Name is a dbFormSub
38497>>>>>            Entry_Item Branch.Branch_name
38498>>>>>            Set Size to 13 168
38499>>>>>            Set Location to 23 188
38500>>>>>            Set Color to 12232306
38501>>>>>            Set Label_Justification_Mode to jMode_Right
38502>>>>>            Set Enabled_State to FALSE
38503>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38504>>>>>            Set Item_Shadow_State Item 0 to TRUE
38505>>>>>            Set Shadow_State Item 0 to TRUE
38506>>>>>
38506>>>>>            //AB-StoreStart
38506>>>>>                                
38506>>>>>                                
38506>>>>>            //AB-StoreEnd
38506>>>>>
38506>>>>>        End_Object    // Branch_Branch_Name
38507>>>>>
38507>>>>>        Object Year_Year_Year is a dbFormSub
38509>>>>>            Entry_Item Year.Year_year
38510>>>>>            Set Size to 13 71
38511>>>>>            Set Location to 37 112
38512>>>>>            Set Label_Col_Offset to 2
38513>>>>>            Set Label_Justification_Mode to jMode_Right
38514>>>>>            Set Prompt_Button_Mode to pb_PromptOn
38515>>>>>            Set Auto_Clear_Deo_State to FALSE
38516>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38517>>>>>
38517>>>>>            //AB-StoreStart
38517>>>>>            Set Prompt_Object to (sl003(Self))
38518>>>>>            
38518>>>>>            Procedure Prompt_CallBack Integer hPrompt
38520>>>>>                String lsCompanyCode lsBranchCode
38521>>>>>                integer icheck
38521>>>>>                get checked_state of (chkxr(self)) to icheck
38522>>>>>                Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
38523>>>>>                Get Field_Current_Value of Branch_DD  Field Branch.Branch_Code   to lsBranchCode
38524>>>>>                Set psFragmaCompanyCode of hPrompt to lsCompanyCode
38525>>>>>                Set psFragmaBranchCode  of hPrompt to lsBranchCode
38526>>>>>                set pifragmaactive      of hPrompt to icheck
38527>>>>>            End_Procedure
38528>>>>>            
38528>>>>>            
38528>>>>>            
38528>>>>>            
38528>>>>>            
38528>>>>>            
38528>>>>>            //AB-StoreEnd
38528>>>>>
38528>>>>>        End_Object    // Year_Year_Year
38529>>>>>
38529>>>>>        Object Year_Year_Descr is a dbFormSub
38531>>>>>            Entry_Item Year.Year_descr
38532>>>>>            Set Size to 13 168
38533>>>>>            Set Location to 37 188
38534>>>>>            Set Color to 12232306
38535>>>>>            Set Label_Col_Offset to 2
38536>>>>>            Set Label_Justification_Mode to jMode_Right
38537>>>>>            Set Enabled_State to FALSE
38538>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38539>>>>>            Set Item_Shadow_State Item 0 to TRUE
38540>>>>>            Set Shadow_State Item 0 to TRUE
38541>>>>>
38541>>>>>            //AB-StoreStart
38541>>>>>                                
38541>>>>>            //AB-StoreEnd
38541>>>>>
38541>>>>>        End_Object    // Year_Year_Descr
38542>>>>>
38542>>>>>        Object Year_Year_Entrydate is a dbFormSub
38544>>>>>            Entry_Item Year.Year_entrydate
38545>>>>>            Set Size to 13 71
38546>>>>>            Set Location to 52 112
38547>>>>>            Set Label_Col_Offset to 2
38548>>>>>            Set Label_Justification_Mode to jMode_Right
38549>>>>>            Set Auto_Clear_Deo_State to FALSE
38550>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38551>>>>>        End_Object    // Year_Year_Entrydate
38552>>>>>
38552>>>>>        Object oOk_bn is a ButtonSub
38554>>>>>            Set Label to "„å©¦›¦ª"
38555>>>>>            Set Size to 17 54
38556>>>>>            Set Location to 74 188
38557>>>>>            Set Form_FontHeight Item 0 to 14
38558>>>>>            Set Form_FontWeight Item 0 to 600
38559>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38560>>>>>
38560>>>>>            //AB-StoreStart
38560>>>>>                        
38560>>>>>            Procedure OnClick
38562>>>>>                Delegate Send AcceptTheValues
38564>>>>>            End_Procedure
38565>>>>>            
38565>>>>>            
38565>>>>>            //AB-StoreEnd
38565>>>>>
38565>>>>>        End_Object    // oOk_bn
38566>>>>>
38566>>>>>        Object oCancel_bn is a ButtonSub
38568>>>>>            Set Label to "„¥¦›¦ª "
38569>>>>>            Set Size to 17 54
38570>>>>>            Set Location to 74 302
38571>>>>>            Set Form_FontHeight Item 0 to 14
38572>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38573>>>>>
38573>>>>>            //AB-StoreStart
38573>>>>>                                
38573>>>>>            Procedure OnClick
38575>>>>>               Send Exit_Application to oSelectYear
38576>>>>>            End_Procedure
38577>>>>>            
38577>>>>>            
38577>>>>>            
38577>>>>>            //AB-StoreEnd
38577>>>>>
38577>>>>>        End_Object    // oCancel_bn
38578>>>>>
38578>>>>>        Object otxtCompany is a TextBoxSub
38580>>>>>            Set Label to "„«˜ ¨œå˜"
38581>>>>>            Set Auto_Size_State to FALSE
38582>>>>>            Set Color to 12232306
38583>>>>>            Set FontSize to 14 8
38584>>>>>            Set Location to 9 10
38585>>>>>            Set Size to 10 35
38586>>>>>            Set FontWeight to 600
38587>>>>>            Set TypeFace to "MS Sans Serif"
38588>>>>>            Set Enabled_State to TRUE
38589>>>>>        End_Object    // otxtCompany
38590>>>>>
38590>>>>>        Object otxtBranch is a TextBoxSub
38592>>>>>            Set Label to "“§¦¡˜«˜©«ã£˜«˜"
38593>>>>>            Set Auto_Size_State to FALSE
38594>>>>>            Set Color to 12232306
38595>>>>>            Set FontSize to 14 8
38596>>>>>            Set Location to 23 10
38597>>>>>            Set Size to 10 63
38598>>>>>            Set FontWeight to 600
38599>>>>>            Set TypeFace to "MS Sans Serif"
38600>>>>>            Set Enabled_State to TRUE
38601>>>>>        End_Object    // otxtBranch
38602>>>>>
38602>>>>>        Object otxtYear is a TextBoxSub
38604>>>>>            Set Label to "•¨ã©ž :          "
38605>>>>>            Set Auto_Size_State to FALSE
38606>>>>>            Set Color to 12232306
38607>>>>>            Set FontSize to 14 8
38608>>>>>            Set Location to 38 10
38609>>>>>            Set Size to 10 40
38610>>>>>            Set FontWeight to 600
38611>>>>>            Set TypeFace to "MS Sans Serif"
38612>>>>>            Set Enabled_State to TRUE
38613>>>>>        End_Object    // otxtYear
38614>>>>>
38614>>>>>        Object otxtWorkingDay is a TextBoxSub
38616>>>>>            Set Label to "†£/¤å˜ „¨š˜©å˜ª"
38617>>>>>            Set Auto_Size_State to FALSE
38618>>>>>            Set Color to 12232306
38619>>>>>            Set FontSize to 14 8
38620>>>>>            Set Location to 52 10
38621>>>>>            Set Size to 10 63
38622>>>>>            Set FontWeight to 600
38623>>>>>            Set TypeFace to "MS Sans Serif"
38624>>>>>            Set Enabled_State to TRUE
38625>>>>>        End_Object    // otxtWorkingDay
38626>>>>>
38626>>>>>        Object otxtWorkingDay is a TextBoxSub
38628>>>>>            Set Label to "Ž¢œª ¦  ®¨ã©œ ª"
38629>>>>>            Set Auto_Size_State to FALSE
38630>>>>>            Set Color to 12232306
38631>>>>>            Set FontSize to 14 8
38632>>>>>            Set Location to 79 9
38633>>>>>            Set Size to 10 63
38634>>>>>            Set FontWeight to 600
38635>>>>>            Set TypeFace to "MS Sans Serif"
38636>>>>>            Set Enabled_State to TRUE
38637>>>>>        End_Object    // otxtWorkingDay
38638>>>>>
38638>>>>>        Object chkxr is a CheckBoxSub
38640>>>>>            Set Size to 13 22
38641>>>>>            Set Location to 79 113
38642>>>>>            Set Color to 12232306
38643>>>>>        End_Object    // chkxr
38644>>>>>
38644>>>>>
38644>>>>>        //AB-StoreStart
38644>>>>>        
38644>>>>>        On_Key Key_Ctrl+Key_X Send None
38645>>>>>        On_Key Key_Alt+Key_X  Send None
38646>>>>>        
38646>>>>>        Function ifSelect_Xrhsh Returns String
38648>>>>>            String  lsRecord_id
38649>>>>>            Set psSelectedYearRecr to gs_Selected_Year_Recr
38650>>>>>            send popup_modal
38651>>>>>            Get psSelectedYearRecr to lsRecord_id
38652>>>>>            Function_return lsRecord_Id
38653>>>>>        End_Function
38654>>>>>        
38654>>>>>        Procedure AcceptTheValues
38656>>>>>            Integer iRetVal liYearDD liCompanyDD liBranchDD
38657>>>>>            String ldcheck lsYearRecr lsSite sCname sBname sYname sNom1 sNom2 sNom3
38657>>>>>            Date ldYearXrhsh_From ldYearXrhsh_To
38657>>>>>            Move Year_DD to liYearDD
38658>>>>>            Get Field_Current_Value of liYearDD Field Year.Year_EntryDate to ldcheck
38659>>>>>            if (ldcheck = "") ;                Get Message_Box "ƒœ¤ œ§ ¢â¥˜«œ ©à©«ã ž£œ¨¦£ž¤å˜." "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
38662>>>>>            else begin
38663>>>>>                Get Field_Current_Value of liYearDD Field Year.Year_XrhshFrom   to ldYearXrhsh_From
38664>>>>>                Get Field_Current_Value of liYearDD Field Year.Year_XrhshTo     to ldYearXrhsh_To
38665>>>>>                if ((ldcheck < ldYearXrhsh_From) or (ldcheck > ldYearXrhsh_To)) ;                    Get Message_Box "†£œ¨/¤å˜ œ¡«éª ¦¨åà¤" "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
38668>>>>>                else begin
38669>>>>>                    Move Company_DD to liCompanyDD
38670>>>>>                    Move Branch_DD  to liBranchDD
38671>>>>>                    Move Year_DD    to liYearDD
38672>>>>>                    send Request_Save to liYearDD
38673>>>>>                    Get Field_Current_Value of liCompanyDD Field Company.Company_Code to gs_Selected_Company_Code
38674>>>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_Code   to gs_Selected_Branch_Code
38675>>>>>        
38675>>>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Beto_Site   to gs_Selected_Beto_Site
38676>>>>>        
38676>>>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_Site   to lsSite
38677>>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_Year       to gi_Selected_Year
38678>>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_Recr       to lsYearRecr
38679>>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_C_Code0    to sNom1
38680>>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_C_Code00   to sNom2
38681>>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_C_CodeR    to sNom3
38682>>>>>        
38682>>>>>                    Get Field_Current_Value of liCompanyDD Field Company.Company_Name to sCname
38683>>>>>                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_name   to sBname
38684>>>>>                    Get Field_Current_Value of liYearDD    Field Year.Year_Descr      to sYname
38685>>>>>        
38685>>>>>        
38685>>>>>                    Local String    sCode
38685>>>>>                    Local Integer   iBreak
38685>>>>>                    Move 0 to iBreak
38686>>>>>                    Clear Nomisma
38687>>>>>                    Find Gt Nomisma.Recnum
38688>>>>>>
38688>>>>>                    While ((Found=1) And (iBreak=0))
38692>>>>>                        If (Nomisma.Einai_Euro='1') Begin
38694>>>>>                            Move 1 to iBreak
38695>>>>>                            Move Nomisma.Nomisma_Code to sCode
38696>>>>>                        End
38696>>>>>>
38696>>>>>                        If (Not(iBreak)) Find Gt Nomisma.Recnum
38699>>>>>                    Loop
38700>>>>>>
38700>>>>>                    Move (Trim(sCode)) to sCode
38701>>>>>        
38701>>>>>        
38701>>>>>                    Reread SysCurXR
38705>>>>>                    Move gs_Selected_Company_Code   to SysCurXR.Company_Code
38706>>>>>                    Move gs_Selected_beto_site      to SysCurXR.beto_site
38707>>>>>                    Move gs_Selected_Branch_Code    to SysCurXR.Branch_Code
38708>>>>>                    Move gi_Selected_Year           to SysCurXR.Year_Year
38709>>>>>                    Move lsYearRecr                 to SysCurXR.Year_Recr
38710>>>>>                    Move lsSite                     to SysCurXR.Branch_Site
38711>>>>>        
38711>>>>>                    Move sCname                     to SysCurXR.Company_Name
38712>>>>>                    Move sBname                     to SysCurXR.Branch_Name
38713>>>>>                    Move sYname                     to SysCurXR.Year_Descr
38714>>>>>        
38714>>>>>                    Move ldYearXrhsh_From           to SysCurXr.Year_XrhshFrom
38715>>>>>                    Move ldYearXrhsh_To             to SysCurXr.Year_XrhshTo
38716>>>>>        
38716>>>>>                    Move  (Trim(sNom1))             to SysCurXR.C_Code0
38717>>>>>                    Move  (Trim(sNom2))             to SysCurXR.C_Code00
38718>>>>>                    Move  (Trim(sNom3))             to SysCurXR.C_CodeR
38719>>>>>        
38719>>>>>                    Move sCode                      to SysCurXR.Euro_Code
38720>>>>>        
38720>>>>>                    Saverecord SysCurXR
38721>>>>>                    Unlock
38722>>>>>>
38722>>>>>        
38722>>>>>                    Move lsYearRecr                 to gs_Selected_Year_Recr
38723>>>>>                    Set psSelectedYearRecr          to lsYearRecr
38724>>>>>        
38724>>>>>                    Send Stop_Modal_ui
38725>>>>>        
38725>>>>>                    Set kEnter_Next_State of ghoWorkSpace to TRUE
38726>>>>>                End
38726>>>>>>
38726>>>>>            end
38726>>>>>>
38726>>>>>        End_Procedure
38727>>>>>        
38727>>>>>        Set Locate_Mode to Center_On_Screen
38728>>>>>        
38728>>>>>        On_Key KCancel      Send KeyAction to (oCancel_Bn(Self))
38729>>>>>        On_Key KClose_Panel Send KeyAction to (oCancel_Bn(Self))
38730>>>>>        On_Key Ksave_record send KeyAction to (oOK_Bn(Self))
38731>>>>>        
38731>>>>>        On_Key Key_alt+Key_A send KeyAction to (oOK_Bn(Self))
38732>>>>>        On_Key Key_alt+Key_Q send KeyAction to (oCancel_Bn(Self))
38733>>>>>        
38733>>>>>        
38733>>>>>        
38733>>>>>        
38733>>>>>        
38733>>>>>        
38733>>>>>        
38733>>>>>        
38733>>>>>        
38733>>>>>        
38733>>>>>        
38733>>>>>        //AB-StoreEnd
38733>>>>>
38733>>>>>    End_Object    // oSelectYear
38734>>>>>
38734>>>>>
38734>>>>>    //AB-StoreStart
38734>>>>>        
38734>>>>>        
38734>>>>>    //AB-StoreEnd
38734>>>>>
38734>>>>>//AB/     End_Object    // prj
38734>>>
38734>>>Procedure Epelexe_Xrhsh
38735>>>    Integer liCompanyDD liBranchDD liYearDD liYear liModalId
38736>>>    String lsCompany lsBranch lsWhatXrhsh
38736>>>    Move oSelectYear to liModalId
38737>>>    Get ifSelect_Xrhsh Of liModalId to lsWhatXrhsh
38738>>>    if (Trim(lsWhatXrhsh)='') Send Exit_Application
38741>>>End_Procedure
38742>>>
38742>>>Procedure Allaxe_Xrhsh
38743>>>    Integer rVal liModalId iID
38744>>>    If (Close_All_Views(Self,True)=0) Begin
38746>>>        Move oSelectYear to liModalId
38747>>>        Send Epelexe_Xrhsh
38748>>>    End
38748>>>>
38748>>>End_Procedure
38749>>>
38749>>>On_Key Key_Ctrl+Key_X Send Allaxe_Xrhsh
38750>>>On_Key Key_Alt+Key_X  Send Allaxe_Xrhsh
38751>>>
38751>>>Send Epelexe_Xrhsh
38752>>>//------------------------------
38752>>>
38752>
38752>//AB-StoreTopEnd
38752>
38752>
38752>Object Main is a Panelsub
38754>
38754>    //AB-PanelStoreTopStart
38754>    
38754>    
38754>    //AB-PanelStoreTopEnd
38754>
38754>    Set Label To "##QUICK_RUN"
38755>    Use jsMenu.mn //  Menu package.
INCLUDING FILE: JSMENU.MN
38755>>>
38755>>>
38755>>>
38755>>>DFCreate_Menu Main_Menu      
38758>>>
38758>>>    Property String psMenuModule Public ''
38760>>>
38760>>>    DFCreate_Menu "Ž‚€‹‹€ „ˆƒˆ‰Ž" View1_PopupMenu IS A ViewPopupMenu
38764>>>        On_Item "DBLISTS - FormArray Lists"   Send Activate_Lists2
38765>>>        On_Item ""   Send None
38766>>>        //On_Item "DBLISTS - Ptyppar"   Send Activate_TestView2
38766>>>        //On_Item "DBLISTS - Formulas NEW"   Send Activate_TestView3
38766>>>        //On_Item "DBLISTS - Formulas"   Send Activate_FormulaLists
38766>>>        //On_Item "LISTS   - Formulas"   Send Activate_FormulaLists3
38766>>>        
38766>>>        Procedure OnInitMenu
38768>>>            Forward Send OnInitMenu
38770>>>            Set psMenuModule to '01'
38771>>>        End_Procedure
38772>>>
38772>>>    End_Pull_Down // "Ž‚€‹‹€ „ˆƒˆ‰Ž"  
38774>>>
38774>>>
38774>>>End_Menu // Main_Menu
38776>>>
38776>>>Register_Object Client_Area
38776>>>
38776>>>
38776>    
38776>    Use DFStdBtn.pkg //  Tool-Bar object.
INCLUDING FILE: DFSTDBTN.PKG
38776>>>// 07/23/96 JJT - New Class names
38776>>>// 10/03/97 KCR - removed leading separator
38776>>>
38776>>>Use DFMainBt  // dfMain_ButtonBar
INCLUDING FILE: DFMAINBT.PKG
38776>>>>>//-------------------------------------------------------------------------
38776>>>>>// DFMainBt.pkg - DfMain_ButtonBar class
38776>>>>>//
38776>>>>>//
38776>>>>>// 07/23/96 JJT - New Class names
38776>>>>>//-------------------------------------------------------------------------
38776>>>>>
38776>>>>>Use DfPanel // dfapp_buttonbar
38776>>>>>
38776>>>>>Class ToolBar is a AppToolBar
38777>>>>>
38777>>>>>    Function Is_Function Integer MsgId Integer ObjId Integer DelegateFg Returns Integer
38778>>>>>      Local integer rval MainObj#
38779>>>>>      Get Main_Panel_id to MainObj#
38780>>>>>      If (ObjId>Desktop AND MainObj#) ;         Get Is_Function of MainObj# MsgId ObjId DelegateFg to rVal
38783>>>>>      Function_Return rVal
38784>>>>>    End_Function
38785>>>>>
38785>>>>>    Procedure Redirect_Button_Message integer Itm
38786>>>>>         Local integer Msg# Aux# rval Understood
38787>>>>>         If (Shadow_State(Current_Object,itm)) Procedure_Return
38790>>>>>         Get Message   item itm  to Msg#
38791>>>>>         Get Aux_Value item itm  to Aux#
38792>>>>>         If Msg# Begin
38794>>>>>           If Aux# eq 0 Begin
38796>>>>>              Get Focus to Aux#
38797>>>>>              Get Is_Function Get_DEO_Object Aux# TRUE to Understood
38798>>>>>              If Not Understood Move 0 to Aux#
38801>>>>>           End
38801>>>>>>
38801>>>>>           If Aux# Get Msg# of Aux# to rval
38804>>>>>           Procedure_return rval
38805>>>>>         end
38805>>>>>>
38805>>>>>    End_Procedure // Redirect_Message
38806>>>>>
38806>>>>>End_Class
38807>>>>>
38807>>>>>
38807>>>
38807>>>//  Button bar object.
38807>>>//
38807>>>Object Tool_Bar is a ToolBar
38809>>>
38809>>>    Send ImageList_Add 'bgn.bmp'   // 0
38810>>>    Send ImageList_Add 'end.bmp'   // 1
38811>>>    Send ImageList_Add 'next.bmp'  // 2
38812>>>    Send ImageList_Add 'prev.bmp'  // 3
38813>>>    Send ImageList_Add 'clr.bmp'   // 4
38814>>>    Send ImageList_Add 'clra.bmp'  // 5
38815>>>
38815>>>    send Add_button (ico_user+0) msg_beginning_of_data
38816>>>    Send Add_ToolTip "Beginning of file"
38817>>>    Set  Status_Help To 'Find the First record (Ctrl+Home)'
38818>>>
38818>>>    send Add_button (ico_user+3) msg_find_previous
38819>>>    Send Add_ToolTip "Find Previous"
38820>>>    Set  Status_Help To 'Find the Previous record (F7)'
38821>>>
38821>>>    send Add_button (ico_user+2) msg_find_next
38822>>>    Send Add_ToolTip "Find Next"
38823>>>    Set  Status_Help To 'Find the Next record (F8)'
38824>>>
38824>>>    send Add_button (ico_user+1) msg_end_of_data
38825>>>    Send Add_ToolTip "End of File"
38826>>>    Set  Status_Help To 'Find the Last record (Ctrl+End)'
38827>>>
38827>>>    send Add_space
38828>>>
38828>>>    send Add_button ico_std_find msg_prompt
38829>>>    Send Add_ToolTip "Prompt"
38830>>>    Set  Status_Help To 'Show available selections (F4)'
38831>>>
38831>>>    send Add_button (ico_user+4) msg_request_clear
38832>>>    Send Add_ToolTip "Clear"
38833>>>    Set  Status_Help To 'Clear current record / Add a new record (F5)'
38834>>>
38834>>>    send Add_button (ico_user+5) msg_request_clear_all
38835>>>    Send Add_ToolTip "Clear All"
38836>>>    Set  Status_Help To 'Clear all data from view (Ctrl+F5)'
38837>>>
38837>>>    send Add_space
38838>>>
38838>>>    send Add_button ico_std_filesave msg_request_save
38839>>>    Send Add_ToolTip "Save"
38840>>>    Set  Status_Help To 'Save the current record (F2)'
38841>>>
38841>>>    send Add_button ico_std_delete msg_request_delete
38842>>>    Send Add_ToolTip "Delete"
38843>>>    Set  Status_Help To 'Delete the current record (Shift+F2)'
38844>>>
38844>>>    send Add_space
38845>>>
38845>>>    send Add_button ico_std_cut msg_cut
38846>>>    Send Add_ToolTip "Cut"
38847>>>    Set  Status_Help to "Cuts the selection and puts it on the Clipboard"
38848>>>
38848>>>    send Add_button ico_std_copy msg_copy
38849>>>    Send Add_ToolTip "Copy"
38850>>>    Set  Status_Help to "Copies the selection and puts it on the Clipboard"
38851>>>
38851>>>    send Add_button ico_std_paste msg_paste
38852>>>    Send Add_ToolTip "Paste"
38853>>>    Set  Status_Help to "Inserts Clipboard contents"
38854>>>
38854>>>End_Object
38855>>>
38855>    
38855>    Object Client_Area is a AppClientAreasub
38857>
38857>        //AB-ClientStoreTopStart
38857>        //==========================================
38857>        On_Key Key_Ctrl+Key_W Send ChangeMyPassword
38858>        //==========================================
38858>        
38858>        // Ž‘Ž•† ‚„Œˆ‰„‘ ‹„’€Š†’„‘ //
38858>        String Plhktro_BIP  Plhktro_Esc  Plhktro_N11  Plhktro_N00  Plhktro_FS  Plhktro_AAA  Plhktro_DSI
38858>        String Plhktro_SO   Plhktro_DC4     //expanded for 1 line
38858>        String Plhktro_SI   Plhktro_DC2     //condesed
38858>        String Plhktro_PAV                  //underline
38858>        String Plhktro_EEE  Plhktro_FFF     //emphasized
38858>        String Plhktro_GGG  Plhktro_HHH     //double strike
38858>        String Plhktro_WWW                  //expanded
38858>        string Plhktro_Q Plhktro_160
38858>        Integer giViewID
38858>        String  gsViewName
38858>        // Ž‘Ž•† ‚„Œˆ‰„‘ ‹„’€Š†’„‘ //
38858>        
38858>        Open Sysfile
38860>        Open Sysrec
38862>        
38862>        //Use dbViews.Sub
38862>        //Use dbForms.Sub
38862>        
38862>        //Use GrpPed00.vw
38862>        //Use GrpPedia.vw
38862>        //Use GrpView0.vw
38862>        //Use GrpViews.vw
38862>        //Use GrpOth0.vw
38862>        //Use GrpOth.vw
38862>        //Use Users.vw
38862>        //Use UserGrps.vw
38862>        //Use Departm.vw
38862>        //Use Othon.vw
38862>        //Use Views.vw
38862>        //Use Arxeia.vw
38862>        //Use Pedia.vw
38862>        //Use Viewflds.vw
38862>        
38862>        //Use Cflagkin.vw
38862>        //Use Wflagkin.vw
38862>        
38862>        //Use Listes
38862>        
38862>        //Use bpMakeSx.dg
38862>        
38862>        Use dbViews.Sub
INCLUDING FILE: DBVIEWS.SUB
38862>>>Open Oth 
38864>>>Open GrpAct
INCLUDING FILE: GRPACT.FD
38866>>>Open GrpAct0
INCLUDING FILE: GRPACT0.FD
38868>>>
38868>>>Class DbviewSubs Is A DbviewSub
38869>>>
38869>>>    Procedure Construct_Object
38870>>>        Integer iPos iCount
38871>>>        Forward Send Construct_Object
38873>>>
38873>>>        Property String     psMyViewName        Public ''
38874>>>        Property Integer    piMyViewID          Public  0
38875>>>        Property Integer    piDoNotActivateView Public  0
38876>>>
38876>>>        Get Name            to gsViewName
38877>>>        Get Object_ID       to giViewID
38878>>>
38878>>>        Move 0 to iPos
38879>>>        For iCount From 1 to (Length(gsViewName))
38885>>>>
38885>>>            If (Mid(gsViewName,1,iCount)='.') Move iCount to iPos
38888>>>        Loop
38889>>>>
38889>>>        Move (Right(gsViewName,(Length(gsViewName)-iPos))) to gsViewName
38890>>>        Move (Trim(gsViewName)) to gsViewName
38891>>>
38891>>>        Set psMyViewName    to (Trim(gsViewName))
38892>>>        Set piMyViewID      to giViewID
38893>>>
38893>>>    End_Procedure
38894>>>
38894>>>    Procedure End_Construct_Object
38895>>>        Integer iFileNumber iFieldNumber iUser iColor iLimit iBase iCurr iCol iDeo iPos
38896>>>        Integer iObj iPrototype iColumn iItem iInt iFieldStatus iCurCol iCount
38896>>>        String  sFileName sFieldName sUser sRecr sStr sDbFormName sViewLabel sDeo svn
38896>>>
38896>>>        Forward Send End_Construct_Object
38898>>>
38898>>>        Get psMyViewName        to gsViewName
38899>>>        Get piMyViewID          to giViewID
38900>>>        Get Label Of giViewID   to sViewLabel
38901>>>        Move (Trim(sViewLabel)) to sViewLabel
38902>>>
38902>>>        Clear Oth
38903>>>        Move gsViewName to Oth.View_Name
38904>>>        Find eq Oth By Index.2 // Oth:Index.2:View_Name
38905>>>>
38905>>>        If (Not(Found)) Begin
38907>>>            Move sViewLabel to Oth.View_Label
38908>>>            Move giViewID   to Oth.View_ID
38909>>>            Saverecord Oth
38910>>>        End
38910>>>>
38910>>>
38910>>>//        Set piDoNotActivateView to 0
38910>>>//        Send DisableActivateView
38910>>>
38910>>>    End_Procedure //End_Construct_Object
38911>>>
38911>>>    Procedure Activate_View Returns Integer
38912>>>        String  lsLogin
38913>>>        String sLektiko
38913>>>        Integer liUser iGroup rVal
38913>>>        Set piDoNotActivateView to 0
38914>>>        Send DisableActivateView
38915>>>        If (piDoNotActivateView(Self)=0) Forward get Msg_Activate_View to rVal
38919>>>        Else Move -1 to rVal
38921>>>        Procedure_Return rVal
38922>>>    End_procedure
38923>>>
38923>>>
38923>>>    Procedure DisableActivateView
38924>>>        String  lsLogin
38925>>>        String sLektiko
38925>>>        Integer liUser iGroup rVal
38925>>>
38925>>>        Move (fsLoginUserID())      to lsLogin
38926>>>        Clear Users
38927>>>        Move lsLogin    to Users.Login_ID
38928>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
38929>>>>
38929>>>        If (Found=1)  Begin
38931>>>            Move Users.User_ID  to liUser
38932>>>            Move Users.Grp_ID   to iGroup
38933>>>        End
38933>>>>
38933>>>        
38933>>>        Clear GrpAct
38934>>>        Move liUser                 to GrpAct.User_ID
38935>>>        Move (psMyViewName(Self))   to GrpAct.View_Name
38936>>>        Find Eq GrpAct By Index.1
38937>>>>
38937>>>        If (Found) Begin
38939>>>            If (GrpAct.Allow=0) Begin
38941>>>                Set piDoNotActivateView to 1
38942>>>                Move "€¤œ§˜¨¡ã › ˜¡ é£˜«˜ •¨ã©«ž š ˜ œ¤œ¨š¦§¦åž©ž «¦¬ §˜¨˜Ÿç¨¦¬\n„§ ¡¦ ¤à¤ã©«œ £œ «¦¤ ƒ ˜®œ ¨ ©«ã «¦¬ ©¬©«ã£˜«¦ª" to sLektiko
38943>>>                Send Stop_Box sLektiko "Error 30001"
38944>>>                Procedure_Return -1
38945>>>            End
38945>>>>
38945>>>        End
38945>>>>
38945>>>
38945>>>        Clear GrpAct0
38946>>>        Move iGroup                 to GrpAct0.Group_ID
38947>>>        Move (psMyViewName(Self))   to GrpAct0.View_Name
38948>>>        Find Eq GrpAct0 By Index.1
38949>>>>
38949>>>        If ((Found) And (GrpAct0.Allow=0)) Begin
38951>>>            Set piDoNotActivateView to 1
38952>>>            Move "€¤œ§˜¨¡ã › ˜¡ é£˜«˜ Ž£á›˜ª š ˜ œ¤œ¨š¦§¦åž©ž «¦¬ §˜¨˜Ÿç¨¦¬\n„§ ¡¦ ¤à¤ã©«œ £œ «¦¤ ƒ ˜®œ ¨ ©«ã «¦¬ ©¬©«ã£˜«¦ª" to sLektiko
38953>>>            Send Stop_Box sLektiko "Error 30002"
38954>>>            Procedure_Return -1
38955>>>        End
38955>>>>
38955>>>    End_procedure
38956>>>
38956>>>
38956>>>End_Class //dbviewSubs
38957>>>
38957>>>
38957>        
38957>        Open Nomisma
38959>        Open Isotimia
INCLUDING FILE: ISOTIMIA.FD
38961>        
38961>        
38961>        Use Baxio.DD
INCLUDING FILE: BAXIO.DD
38961>>>//DDB-FileStart
38961>>>//DDB-HeaderStart
38961>>>
38961>>>// File Name : BAXIO.DD
38961>>>// Class Name: Baxio_DataDictionary
38961>>>// Revision  : 112
38961>>>// Version   : 2
38961>>>
38961>>>Use  Windows           // Basic Definitions
38961>>>Use  DataDict          // DataDictionary Class Definition
38961>>>Use  DDvalTbl          // Validation Table Class Definitions
38961>>>
38961>>>Open Baxio
INCLUDING FILE: BAXIO.FD
38963>>>Open Bmove
INCLUDING FILE: BMOVE.FD
38965>>>Open Baxiokat
INCLUDING FILE: BAXIOKAT.FD
38967>>>Open Sysrecb
INCLUDING FILE: SYSRECB.FD
38969>>>
38969>>>//DDB-HeaderEnd
38969>>>//DDB-ValidationStart
38969>>>
38969>>>//DDB/ ExternalValidationTable Baxio_Status_VT  Baxio.pkg
38969>>>//DDB/ ExternalValidationTable Bfile_VT  Baxio.pkg
38969>>>
38969>>>Register_Object Baxio_Status_VT
38969>>>Register_Object Baxio_Baxio_Place_VT
38969>>>Register_Object Bfile_VT
38969>>>Register_Object Baxio_Baxio_Bank_VT
38969>>>Register_Object Baxio_Baxio_Banka_VT
38969>>>Register_Object Baxio_Baxio_From_VT
38969>>>Register_Object Baxio_Baxio_Topos_VT1
38969>>>Use Baxio.pkg        // Baxio_Status_VT, Bfile_VT
INCLUDING FILE: BAXIO.PKG
38969>>>>>// **************************************************************************
38969>>>>>// *Code Style   : Object                                                   *
38969>>>>>// *Name         : Baxio.vts                                                *
38969>>>>>// *Revision     : 1                                                        *
38969>>>>>// *Main File    :                                                          *
38969>>>>>// *Location     : \Home.Win\Easyware\ED\Appsrc                             *
38969>>>>>// *Creation Date: 01/09/99                                                 *
38969>>>>>// *Last Update  :                                                          *
38969>>>>>// *Author       : JA                                                       *
38969>>>>>// *Includes     :                                                          *
38969>>>>>// *Comments     : œ¨ â®œ  æ¢˜ «˜ static validation tables «¦¬             *
38969>>>>>// *             : module «à¤ ˜¥ ¦š¨á­à¤.                                   *
38969>>>>>// *             :                                                          *
38969>>>>>// *             :                                                          *
38969>>>>>// *Returns      :                                                          *
38969>>>>>// *             :                                                          *
38969>>>>>// *‰nown bugs   :                                                          *
38969>>>>>// *             :                                                          *
38969>>>>>// *Improvements :                                                          *
38969>>>>>// *             :                                                          *
38969>>>>>// *             :                                                          *
38969>>>>>// **************************************************************************
38969>>>>>// *                        A N A L Y S I S                                 *
38969>>>>>// **************************************************************************
38969>>>>>// *                                                                        *
38969>>>>>// **************************************************************************
38969>>>>>
38969>>>>>
38969>>>>>//Set Allow_Blank_State To TRUE
38969>>>>>
38969>>>>>//used by: 1. baxiokat.baxiokat_type
38969>>>>>Object Baxiokat_Type_VT  is a DescriptionValidationTable
38971>>>>>       set table_title to "„å›¦ª €¥ ¦š¨á­¦¬"
38972>>>>>       Procedure Fill_List
38974>>>>>                 Forward Send Fill_List
38976>>>>>                 Send Add_Table_Value  "1"  "„ ©§¨˜¡«â¦"
38977>>>>>                 send add_table_value  "2"  "¢ž¨à«â¦"
38978>>>>>       End_Procedure //fill_list
38979>>>>>End_Object   //Baxiokat_Type_VT
38980>>>>>
38980>>>>>
38980>>>>>//¡˜«˜©«á©œ ª ˜¥ ¦š¨á­à¤
38980>>>>>//used by: 1. bkinkat.baxio_stat_from :¡˜«á©«˜©ž ˜§æ
38980>>>>>//         2. bkinkat.baxio_stat_to   :¡˜«á©«˜©ž ©â
38980>>>>>//         3. baxio.baxio_status      :¡˜«á©«˜©ž
38980>>>>>//â¤˜ ˜¥ æš¨˜­¦ œå¤˜  § Ÿ˜¤æ ¤˜ ™¨œŸœå ©« ª §˜¨˜¡á«à 3 ¡˜«˜©«á©œ ª:
38980>>>>>Object Baxio_Status_VT  is a DescriptionValidationTable
38982>>>>>       set table_title to "‰˜«˜©«á©œ ª €¥ ¦š¨á­à¤"
38983>>>>>       Procedure Fill_List
38985>>>>>                 Forward Send Fill_List
38987>>>>>                 Send Add_Table_Value  "1"  "„¡¡¨œ£âª"
38988>>>>>                 Send Add_Table_Value  "2"  "„¥¦­¢ž£â¤¦"
38989>>>>>                 Send Add_Table_Value  "3"  "ƒ ˜£˜¨«¬¨ž£â¤¦"
38990>>>>>                 Send Add_Table_Value  "4"  "’˜£œå¦"
38991>>>>>                 Send Add_Table_Value  "5"  "ƒœ©£œ¬£â¤¦"
38992>>>>>
38992>>>>>       End_Procedure // fill_list
38993>>>>>End_Object   //Baxio_Status_VT1
38994>>>>>
38994>>>>>
38994>>>>>
38994>>>>>//used by: 1. btypkin.btypkin_anti1
38994>>>>>//         2. btypkin.btypkin_anti2
38994>>>>>//         3. baxio.baxio_file_in
38994>>>>>//         4. baxio.baxio_file_out
38994>>>>>//         5. baxio.baxio_lfile
38994>>>>>Object Bfile_VT  is a DescriptionValidationTable
38996>>>>>       set table_title to "‘¬¤˜¢¢˜©æ£œ¤¦ª/˜¨˜¢ã§«žª ˜§æ"
38997>>>>>       Procedure Fill_List
38999>>>>>                 Forward Send Fill_List
39001>>>>>                 Send Add_Table_Value  "-1" "ƒœ¤ “§á¨®œ "
39002>>>>>                 Send Add_Table_Value  "0"  "Data Entry"
39003>>>>>                 Send Add_Table_Value  "1"  "Š¦š˜¨ ˜©£é¤ ‚Š"
39004>>>>>                 send add_table_value  "2"  "”¦¨â˜ª"
39005>>>>>                 Send Add_Table_Value  "3"  "¨¦£žŸœ¬«é¤"
39006>>>>>                 Send Add_Table_Value  "5"  "Ž ‘¬¤˜¢¢˜©æ£œ¤¦ª"
39007>>>>>                 Send Add_Table_Value  "6"  "’œ¢.˜¨˜¢ã§«žª"
39008>>>>>       End_Procedure // fill_list
39009>>>>>End_Object   // Btypkin_Btypkin_Anti_VT
39010>>>>>
39010>>>
39010>>>Object Baxio_Baxio_Place_VT  is a CodeValidationTable
39012>>>    Set Type_Value        To "BAXIOPLACE"
39013>>>    //DDB-ValidationCustomStart
39013>>>    //DDB-ValidationCustomEnd
39013>>>End_Object   // Baxio_Baxio_Place_VT
39014>>>
39014>>>Object Baxio_Baxio_Bank_VT  is a CodeValidationTable
39016>>>    Set Type_Value        To "BANK"
39017>>>    Set Allow_Blank_State To TRUE
39018>>>    //DDB-ValidationCustomStart
39018>>>    //DDB-ValidationCustomEnd
39018>>>End_Object   // Baxio_Baxio_Bank_VT
39019>>>
39019>>>Object Baxio_Baxio_Banka_VT  is a CodeValidationTable
39021>>>    Set Type_Value        To "BANK"
39022>>>    Set Allow_Blank_State To TRUE
39023>>>    //DDB-ValidationCustomStart
39023>>>    //DDB-ValidationCustomEnd
39023>>>End_Object   // Baxio_Baxio_Banka_VT
39024>>>
39024>>>Object Baxio_Baxio_From_VT  is a DescriptionValidationTable
39026>>>    Set Allow_Blank_State To TRUE
39027>>>    Set Table_Title       To "€¥ æš¨˜­¦  ›å¦¬ / «¨å«¦¬"
39028>>>
39028>>>    Procedure Fill_List
39030>>>        Forward Send Fill_List
39032>>>        Send Add_Table_Value  "0"  "ˆ›å¦¬"
39033>>>        Send Add_Table_Value  "1"  "’¨å«¦¬"
39034>>>    End_Procedure    // Fill_List
39035>>>    //DDB-ValidationCustomStart
39035>>>    //DDB-ValidationCustomEnd
39035>>>End_Object   // Baxio_Baxio_From_VT
39036>>>
39036>>>Object Baxio_Baxio_Topos_VT1  is a DescriptionValidationTable
39038>>>    Set Allow_Blank_State To TRUE
39039>>>    Set Table_Title       To "€¥ æš¨˜­¦ €«« ¡ãª / „§˜¨®å˜ª"
39040>>>
39040>>>    Procedure Fill_List
39042>>>        Forward Send Fill_List
39044>>>        Send Add_Table_Value  "0"  "€«« ¡ãª"
39045>>>        Send Add_Table_Value  "1"  "„§˜¨®å˜ª"
39046>>>    End_Procedure    // Fill_List
39047>>>    //DDB-ValidationCustomStart
39047>>>    //DDB-ValidationCustomEnd
39047>>>End_Object   // Baxio_Baxio_Topos_VT1
39048>>>//DDB-ValidationEnd
39048>>>//DDB-SelectionStart
39048>>>//DDB/ ExternalSelectionList SL037  SL037.SL
39048>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
39048>>>Register_Object SL037
39048>>>Register_Object slNomism
39048>>>//DDB-SelectionEnd
39048>>>
39048>>>Class Baxio_DataDictionary  is a DataDictionary_Sec
39049>>>
39049>>>      Procedure Construct_Object
39050>>>                Forward Send Construct_Object
39052>>>
39052>>>                //btypkin related properties:
39052>>>                //œ¤ž£œ¨é¤¦¤«˜  ©«ã¤: update «¦¬ bmove,
39052>>>                //£ž›œ¤å¦¤«˜   ©«ž¤: request save & delete «¦¬ bmove.
39052>>>                Property Integer piBtypkin_Flag03 0
39053>>>                Property Integer piBtypkin_Flag04 0
39054>>>                Property Integer pifromxrhsh      0
39055>>>
39055>>>                //baxio related properties:
39055>>>                //œ¤ž£œ¨é¤œ«˜     ©«ž¤: creating,
39055>>>                //®¨ž© £¦§¦ œå«˜  ©«ž¤: update «¦¬ bmove š ˜ ¤˜ œ¤œ¨š¦§¦ ã©œ  «ž¤ private.created_baxio «¦¬ bmove,
39055>>>                //£ž›œ¤åœ«˜      ©«ž¤: request save & delete «¦¬ bmove.
39055>>>                Property Integer piCreated_Baxio  0
39056>>>
39056>>>                //œ¤ž£œ¨é¤¦¤«˜     ©«ž¤: backout,
39056>>>                //®¨ž© £¦§¦ ¦ç¤«˜  ©«ž¤: validate_save š ˜ «¦¤ â¢œš®¦ editing «¦¬ baxio,
39056>>>                //£ž›œ¤å¦¤«˜      ©«ž¤: request save & delete «¦¬ bmove.
39056>>>                Property Number  pnB_Baxio_V2      0
39057>>>                Property Number  pnB_Baxio_V0      0
39058>>>                Property Number  pnB_Baxio_V00     0
39059>>>                Property Number  pnB_Baxio_Vr      0
39060>>>                Property String  psB_Baxio_C_Code2 ""
39061>>>                Property Integer piB_Baxio_Status  0
39062>>>                Property Integer piB_Baxio_Place   0
39063>>>
39063>>>                //properties š ˜ œ¢âš®¦¬ª ˜¢˜ššãª parent records:
39063>>>                //œ¤ž£œ¨é¤¦¤«˜     ©«ž¤:backout,
39063>>>                //®¨ž© £¦§¦ ¦ç¤«˜  ©«ž¤: validate_save š ˜ «¦¤ â¢œš®¦ editing «à¤ §œ›åà¤,
39063>>>                //£ž›œ¤å¦¤«˜      ©«ž¤: request save & delete «¦¬ bmove.
39063>>>                Property Integer piB_Baxiokat_Code 0
39064>>>                Property Integer piB_Year_Year     0
39065>>>                Property Integer piMustNOTConstrain Public 0
39066>>>      End_Procedure //construct_object
39067>>>
39067>>>
39067>>>
39067>>>//    Function fngConvertPoso_Baxio String asNomismaCodeApo ;
39067>>>//                            Number anPoso           ;
39067>>>//                            String asNomismaCodeSe  ;
39067>>>//                            Date   adHmnia          ;
39067>>>//                            Number nIsotimia  Returns Number
39067>>>
39067>>>//        Number rVal nApo_Euro_Isot nSe_Euro_Isot
39067>>>//        Integer iApo_Einai_Euro_Zone iApo_Einai_DRX iApo_Einai_Euro iDekadika_Apo
39067>>>//        Integer iSe_Einai_Euro_Zone  iSe_Einai_DRX  iSe_Einai_Euro  iDekadika_Se
39067>>>
39067>>>//        If (asNomismaCodeApo=asNomismaCodeSe) Function_Return anPoso
39067>>>
39067>>>//        Clear Nomisma
39067>>>//        Move (Trim(asNomismaCodeApo)) to Nomisma.Nomisma_Code
39067>>>//        Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
39067>>>//        Move Nomisma.Euro_Zone      to iApo_Einai_Euro_Zone
39067>>>//        Move Nomisma.Einai_DRX      to iApo_Einai_DRX
39067>>>//        Move Nomisma.Einai_EURO     to iApo_Einai_Euro
39067>>>//        Move Nomisma.KL_ISOT_EURO   to nApo_Euro_Isot
39067>>>//        Move Nomisma.Dekadika       to iDekadika_Apo
39067>>>
39067>>>//        Clear Nomisma
39067>>>//        Move (Trim(asNomismaCodeSe)) to Nomisma.Nomisma_Code
39067>>>//        Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
39067>>>//        Move Nomisma.Euro_Zone      to iSe_Einai_Euro_Zone
39067>>>//        Move Nomisma.Einai_DRX      to iSe_Einai_DRX
39067>>>//        Move Nomisma.Einai_EURO     to iSe_Einai_Euro
39067>>>//        Move Nomisma.KL_ISOT_EURO   to nSe_Euro_Isot
39067>>>//        Move Nomisma.Dekadika       to iDekadika_Se
39067>>>
39067>>>//        //05a. ??ÿ??? ? --> ??? 
39067>>>//        Calc (anPoso/nApo_Euro_Isot) to rVal
39067>>>//        Move (Round_Number(rVal,6)) to rVal
39067>>>//        //05b. ???         --> ??ÿ??? ?™ *
39067>>>//        Calc (rVal*nSe_Euro_Isot) to rVal
39067>>>//        Move (Round_Number(rVal,iDekadika_Se)) to rVal
39067>>>//        Function_Return rVal
39067>>>//    End_Function
39067>>>
39067>>>
39067>>>
39067>>>      //¡˜Ÿ¦¨åœ  «ž¤ default « £ã «¦¬ ¤¦£å©£˜«¦ª ˜¤á¢¦š˜ £œ «¦ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
39067>>>      Function Default_Axio_C_Code2 Returns String
39068>>>               String lsBaxio_C_Code_2
39069>>>               //Get File_Field_Current_Value File_Field SyscurXr.C_Code0 to lsBaxio_C_Code_2
39069>>>               Move SyscurXr.C_Code0 to lsBaxio_C_Code_2
39070>>>               Function_Return (Trim(lsBaxio_C_Code_2))
39071>>>      End_Function //default_axio_c_code2
39072>>>
39072>>>
39072>>>      // js 09/02/2002 den yparxei enhmerosh ton nomismatvn xrhshs
39072>>>      Procedure Convert_Axio_Values
39073>>>
39073>>>                Integer liBtypkin_Flag03 liBtypkin_Flag04
39074>>>
39074>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_Code0    ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_Rate0       to Baxio.Baxio_V0
39075>>>
39075>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_Code00   ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_Rate00      to Baxio.Baxio_V00
39076>>>
39076>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_CodeR    ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_RateR       to Baxio.Baxio_VR
39077>>>
39077>>>
39077>>>//                Move (fngConvertPoso_Baxio(Self,Baxio.Baxio_C_Code2,   ;
39077>>>//                                     Baxio.Baxio_V2,        ;
39077>>>//                                     SyscurXr.C_Code0,      ;
39077>>>//                                     Baxio.Baxio_HmniaE,    ;
39077>>>//                                     Baxio.Baxio_Rate0)     ;
39077>>>//                                    ) to Baxio.Baxio_V0
39077>>>//                If (liBtypkin_Flag03 = TRUE);
39077>>>//                     Begin
39077>>>//                      //˜¥å˜ 2-->00
39077>>>//                      Move (fngConvertPoso_Baxio(Self, Baxio.Baxio_C_Code2, ;
39077>>>//                                            Baxio.Baxio_V2,      ;
39077>>>//                                            SyscurXr.C_Code00,   ;
39077>>>//                                            Baxio.Baxio_HmniaE,  ;
39077>>>//                                            Baxio.Baxio_Rate00)  ;
39077>>>//                                          ) to Baxio.Baxio_V00
39077>>>//                     End
39077>>>//                Else Begin
39077>>>//                      Move 0            to Baxio.Baxio_V00
39077>>>//                     End
39077>>>//                If (liBtypkin_Flag04 = TRUE);
39077>>>//                     Begin
39077>>>//                      //˜¥å˜ 2-->r
39077>>>//                      Move (fngConvertPoso_Baxio(Self,Baxio.Baxio_C_Code2, ;
39077>>>//                                       Baxio.Baxio_V2,      ;
39077>>>//                                       SyscurXr.C_CodeR,    ;
39077>>>//                                       Baxio.Baxio_HmniaE,  ;
39077>>>//                                       Baxio.Baxio_RateR)   ;
39077>>>//                                      ) to Baxio.Baxio_VR
39077>>>//                     End
39077>>>//                Else Begin
39077>>>//                      Move 0            to Baxio.Baxio_VR
39077>>>//                     End
39077>>>      End_Procedure
39078>>>
39078>>>
39078>>>
39078>>>      Procedure Constrain
39079>>>                Forward Send Constrain
39081>>>                If (piMustNOTConstrain(Self)=1) Begin
39083>>>                End 
39083>>>>
39083>>>                else If (piMustNOTConstrain(Self)=2) Begin 
39086>>>                    Constrain Baxio.Company_Code Eq Syscurxr.Company_Code
39088>>>                    Constrain Baxio.Branch_Code  Eq Syscurxr.Branch_Code
39090>>>                end    
39090>>>>
39090>>>                Else Begin
39091>>>                    Constrain Baxio.Company_Code Eq Syscurxr.Company_Code
39093>>>                    Constrain Baxio.Branch_Code  Eq Syscurxr.Branch_Code
39095>>>                    Constrain Baxio.Year_Year    Eq Syscurxr.Year_Year
39097>>>                End
39097>>>>
39097>>>      End_Procedure   //constrain
39098>>>
39098>>>
39098>>>      //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
39098>>>      //™) ˜¤áš¤à©ž properties
39098>>>      //š) › ˜®œå¨ ©ž calculated §œ›åà¤
39098>>>      //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
39098>>>      //œ) œ¤ž£â¨à©ž properties after
39098>>>      Procedure Update
39099>>>                Forward Send Update
39101>>>                
39101>>>                If (Baxio.Baxio_C_Code2='') Move SyscurXr.C_Code0 to Baxio.Baxio_C_Code2
39104>>>                
39104>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
39104>>>                Move Syscurxr.Company_Code  to Baxio.Company_Code
39105>>>                Move Syscurxr.Branch_Code   to Baxio.Branch_Code
39106>>>                Move Syscurxr.Year_Year     to Baxio.Year_Year
39107>>>                Move Syscurxr.Year_Recr     to Baxio.Year_Recr
39108>>>                Move Baxiokat.Baxiokat_Code to Baxio.Baxiokat_Code
39109>>>
39109>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
39109>>>                //š01:œ¥ ¦¨ ©£¦ç, «˜ §¢ž¨à«â˜ ›â¤ â®¦¬¤ ©«¦ ®œå˜ §˜¨˜¢¢˜™ãª
39109>>>                If (Baxiokat.Baxiokat_Type = 2);                Begin //˜¥ æš¨˜­˜ §¢ž¨à«â˜
39111>>>                     Move "" to Baxio.Baxio_Code_In
39112>>>                     Move "" to Baxio.Baxio_Epon_In
39113>>>                     Move 0  to Baxio.Baxio_Fpar_In
39114>>>                End
39114>>>>
39114>>>                //š02:yyyy + mm + dd ¢ã¥žª š ˜ «˜ reports
39114>>>                Move (TheYearSegment (Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_YYYY
39115>>>                Move (TheMonthSegment(Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_MM
39116>>>                Move (TheDaySegment  (Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_DD
39117>>>
39117>>>                //š03:§¨é«¦ª & «œ¢œ¬«˜å¦ª §˜¨˜¢ã§«žª
39117>>>                If (Baxio.Baxio_Lcode = "");                Begin
39119>>>                     Move (-1) to Baxio.Baxio_File_Out
39120>>>                     Move ""   to Baxio.Baxio_Code_Out
39121>>>                     Move ""   to Baxio.Baxio_Epon_Out
39122>>>                     Move ""   to Baxio.Baxio_Fpar_Out
39123>>>
39123>>>                     Move (-1) to Baxio.Baxio_Lfile
39124>>>                     Move ""   to Baxio.Baxio_Lepon
39125>>>                     Move ""   to Baxio.Baxio_Lpar
39126>>>                End
39126>>>>
39126>>>      End_Procedure //update
39127>>>
39127>>>
39127>>>      Procedure Backout
39128>>>                Forward Send Backout
39130>>>
39130>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
39130>>>                Set pnB_Baxio_V2      to Baxio.Baxio_V2
39131>>>                Set pnB_Baxio_V0      to Baxio.Baxio_V0
39132>>>                Set pnB_Baxio_V00     to Baxio.Baxio_V00
39133>>>                Set pnB_Baxio_Vr      to Baxio.Baxio_Vr
39134>>>                Set psB_Baxio_C_Code2 to Baxio.Baxio_C_Code2
39135>>>                Set piB_Baxio_Status  to Baxio.Baxio_Status
39136>>>                Set piB_Baxio_Place   to Baxio.Baxio_Place
39137>>>                Set piB_Baxiokat_Code to Baxio.Baxiokat_Code    //š ˜ â¢œš®¦ ˜¢˜ššãª parent
39138>>>                Set piB_Year_Year     to Baxio.Year_Year        //š ˜ â¢œš®¦ ˜¢˜ššãª parent
39139>>>      End_Procedure //backout
39140>>>
39140>>>
39140>>>      Procedure New_Current_Record Integer liOld_Record Integer liNew_Record
39141>>>                Forward Send New_Current_Record liOld_Record liNew_Record
39143>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
39143>>>                Set pnB_Baxio_V2      to Baxio.Baxio_V2
39144>>>                Set pnB_Baxio_V0      to Baxio.Baxio_V0
39145>>>                Set pnB_Baxio_V00     to Baxio.Baxio_V00
39146>>>                Set pnB_Baxio_Vr      to Baxio.Baxio_Vr
39147>>>                Set psB_Baxio_C_Code2 to Baxio.Baxio_C_Code2
39148>>>                Set piB_Baxio_Status  to Baxio.Baxio_Status
39149>>>                Set piB_Baxiokat_Code to Baxio.Baxiokat_Code    //š ˜ â¢œš®¦ ˜¢˜ššãª parent
39150>>>                Set piB_Year_Year     to Baxio.Year_Year        //š ˜ â¢œš®¦ ˜¢˜ššãª parent
39151>>>      End_Procedure //new_current_record
39152>>>
39152>>>
39152>>>      Procedure Creating
39153>>>                Forward Send Creating
39155>>>
39155>>>                //˜¨ Ÿ£æª ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
39155>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBaxio
39155>>>
39155>>>                //«œ¢œ¬«˜å¦ª ¡à› ¡æª ˜¨ Ÿ£æª ˜¥ ¦š¨á­¦¬
39155>>>                Add 1 to Baxiokat.Baxio_Lcode
39156>>>                Move Baxiokat.Baxio_Lcode to Baxio.Baxio_Code
39157>>>
39157>>>                //«¦ property ˜¬«æ œ¤œ¨š¦§¦ œå «ž¤ private.created_baxio
39157>>>                //£â©à «žª update ©«¦ bmove
39157>>>                Set piCreated_Baxio to TRUE
39158>>>
39158>>>//
39158>>>//                Move SysCurXr.C_Code0 to Baxio.Baxio_C_Code2
39158>>>
39158>>>                Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                 (Trim(String(Baxio.Baxio_Rec0)))))) to Baxio.Baxio_Recr
39159>>>
39159>>>      End_Procedure //creating
39160>>>
39160>>>
39160>>>      Procedure Operation_Not_Allowed Integer iError_Num
39161>>>                String lsError_Message
39162>>>                Case Begin
39162>>>                     //˜§æ validate save
39162>>>                     Case (iError_Num = 1001)
39164>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  ¦§à©›ã§¦«œ ž£œ¨¦£ž¤å˜ ¢ã¥œàª!");                          to lsError_Message
39165>>>                     Case Break
39166>>>                     Case (iError_Num = 1002)
39169>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
39170>>>                     Case Break
39171>>>                     Case (iError_Num = 1003)
39174>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  ¦§à©›ã§¦«œ ¤æ£ ©£˜!");                          to lsError_Message
39175>>>                     Case Break
39176>>>                     Case (iError_Num = 1004)
39179>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
39180>>>                     Case Break
39181>>>                     Case (iError_Num = 1005)
39184>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
39185>>>                     Case Break
39186>>>                     Case (iError_Num = 1006)
39189>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ Reporting).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
39190>>>                     Case Break
39191>>>
39191>>>                     Case (iError_Num = 1007)
39194>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\nŒâ˜ €¥ æš¨˜­˜ ›ž£ ¦¬¨š¦ç¤«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
39195>>>                     Case Break
39196>>>                     Case (iError_Num = 1008)
39199>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ¤æ£ ©£˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
39200>>>                     Case Break
39201>>>                     Case (iError_Num = 1009)
39204>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
39205>>>                     Case Break
39206>>>                     Case (iError_Num = 1010)
39209>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©žª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
39210>>>                     Case Break
39211>>>                     Case (iError_Num = 1011)
39214>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜ •¨ã©žª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
39215>>>                     Case Break
39216>>>                     Case (iError_Num = 1012)
39219>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (Œæ£ ©£˜ Reporting) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
39220>>>                     Case Break
39221>>>                     Case (iError_Num = 1013)
39224>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ˜¥ æš¨˜­¦ â®œ  œ¥¦­¢žŸœå !");                          to lsError_Message
39225>>>                     Case Break
39226>>>
39226>>>                     Case (iError_Num = 1014)
39229>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ ›â¤ œ§ «¨â§œ«˜  ¤˜ ˜¢¢á¥œ  ¡˜«žš¦¨å˜!");                          to lsError_Message
39230>>>                     Case Break
39231>>>                     Case (iError_Num = 1015)
39234>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ ›â¤ œ§ «¨â§œ«˜  ¤˜ ˜¢¢á¥œ  ®¨ã©ž!");                          to lsError_Message
39235>>>                     Case Break
39236>>>                     Case (iError_Num = 1100)
39239>>>                          Move "DDC 037:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
39240>>>                          Case Break
39241>>>
39241>>>                     //˜§æ validate delete
39241>>>                     Case (iError_Num = 2007)
39244>>>                          Move ("DDC 037:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n’¦ €¥ æš¨˜­¦ › ˜š¨á­œ«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
39245>>>                     Case Break
39246>>>                     Case (iError_Num = 2100)
39249>>>                          Move "DDC 037:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
39250>>>                          Case Break
39251>>>
39251>>>                     Case Else
39251>>>                          Forward Send Operation_Not_Allowed iError_Num
39253>>>                Case End
39253>>>
39253>>>                Error iError_Num lsError_Message
39254>>>>
39254>>>      End_Procedure // operation_not_allowed
39255>>>
39255>>>      //1001:baxio_hmnial > 0
39255>>>      //1002:baxio_v2 > 0            (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ œšš¨˜­ãª
39255>>>      //1003:baxio_c_code2 <> ""     (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ £ã¤ â®œ  ¤æ£ ©£˜)
39255>>>
39255>>>      //1004:baxio_v0 > 0            (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©žª
39255>>>      //1005:baxio_v00 > 0 if flag 3 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©žª
39255>>>      //1006:baxio_vr > 0  of flag 4 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ reporting
39255>>>
39255>>>
39255>>>      //1007:›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬ œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ «¦ bmove_dd, ›ž¢˜›ã §¨â§œ 
39255>>>      //       If (baxio.recnum=0) then operation_origin must be = bmove_dd
39255>>>      //1008:«¨¦§¦§¦åž©ž (edit) baxio_c_code2 £æ¤¦¤ ˜§æ bmove_dd
39255>>>      //1009:«¨¦§¦§¦åž©ž (edit) baxio_v2      £æ¤¦¤ ˜§æ bmove_dd
39255>>>      //1010:«¨¦§¦§¦åž©ž (edit) baxio_v0      £æ¤¦¤ ˜§æ bmove_dd
39255>>>      //1011:«¨¦§¦§¦åž©ž (edit) baxio_v00     £æ¤¦¤ ˜§æ bmove_dd
39255>>>      //1012:«¨¦§¦§¦åž©ž (edit) baxio_vr      £æ¤¦¤ ˜§æ bmove_dd
39255>>>
39255>>>      //1013:œá¤ «¦ status œå¤˜  œ¥¦­¢ž£â¤¦, ˜§˜š¦¨œçœ¦¤«˜  æ¢˜ «˜ §œ¨˜ «â¨à edits
39255>>>
39255>>>      //1014:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent baxiokat record
39255>>>      //1015:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent year     record
39255>>>      Function Validate_Save Returns Integer
39256>>>               Integer iReturnVal
39257>>>
39257>>>               Forward Get Validate_Save to iReturnVal
39259>>>
39259>>>               If (Not(iReturnVal));               Begin
39261>>>
39261>>>                //---------â¢œš®¦  ›ž£ ¦¬¨šå˜ª ¤â¦¬ baxio record----------------------
39261>>>                //sososo £ž§àª §¨œ§œ  ¤˜ §˜ ¥à £œ «ž¤ current record ????
39261>>>                If (Baxio.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ record
39263>>>                      //1007:â¢œš®¦ª ›ž£ ¦¬¨šå˜ª ¤â¦¬ ˜¥ ¦š¨á­¦¬ ˜§¦ «¦ baxio_dd
39263>>>
39263>>>                      If (pifromxrhsh(Self)=0) Begin
39265>>>                        If (Not((Main_File(OPERATION_ORIGIN)) =  Bmove.File_Number)) Send Operation_Not_Allowed 1007
39268>>>                      End
39268>>>>
39268>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ baxio record
39268>>>>
39268>>>
39268>>>
39268>>>                //---------â¢œš®¦  editing existing baxio records---------------------
39268>>>                Else;                Begin //edit an existing record
39269>>>                      //1008:«¨¦§¦§¦åž©ž (edit) baxio_c_code2 £æ¤¦¤ ˜§æ bmove_dd
39269>>>
39269>>>                      If (pifromxrhsh(Self)=0) Begin
39271>>>
39271>>>                        If (;                            ((psB_Baxio_C_Code2(Self))     <> Baxio.Baxio_C_Code2) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1008
39274>>>                        //1009:«¨¦§¦§¦åž©ž (edit) baxio_v2 £æ¤¦¤ ˜§æ bmove_dd
39274>>>                        If (;                            ((pnB_Baxio_V2(Self))          <> Baxio.Baxio_V2      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1009
39277>>>                        //1010:«¨¦§¦§¦åž©ž (edit) baxio_v0 £æ¤¦¤ ˜§æ bmove_dd
39277>>>                        If (;                            ((pnB_Baxio_V0(Self))          <> Baxio.Baxio_V0      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1010
39280>>>                        //1011:«¨¦§¦§¦åž©ž (edit) baxio_v00 £æ¤¦¤ ˜§æ bmove_dd
39280>>>                        If (;                            ((pnB_Baxio_V00(Self))         <> Baxio.Baxio_V00     ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1011
39283>>>                        //1012:«¨¦§¦§¦åž©ž (edit) baxio_vr £æ¤¦¤ ˜§æ bmove_dd
39283>>>                        If (;                            ((pnB_Baxio_Vr(Self))          <> Baxio.Baxio_Vr      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1012
39286>>>
39286>>>                      End
39286>>>>
39286>>>                        // Egine rem 20/12/2001 giati an orisoume sta metrhta gia paradeigma
39286>>>                        // oti to status SE einai exoflhmeno, tote xtypaei to validation sto
39286>>>                        // kleisimo toy barticle. Alloste den vlepoume giati den mporei na
39286>>>                        // anoigokleisei
39286>>>//                      //1013:œá¤ «¦ status œå¤˜  œ¥¦­¢ž£â¤¦, ˜§˜š¦¨œç¦¤«˜  æ¢˜ «˜ §œ¨˜ «â¨à edits ˜§¦ «¦ bmove
39286>>>//                      If (;
39286>>>//                           ((piB_Baxio_Status(Self))      = 2                    ) and;
39286>>>//                           ((Main_File(OPERATION_ORIGIN)) =  Bmove.File_Number);
39286>>>//                         )                                                       Send Operation_Not_Allowed 1013
39286>>>
39286>>>                      If (pifromxrhsh(Self)=0) Begin
39288>>>                        //1014:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent baxiokat record
39288>>>                        If (Not;                            ((piB_Baxiokat_Code(Self)) =  Baxiokat.Baxiokat_Code);                            )                                                       Send Operation_Not_Allowed 1014
39291>>>
39291>>>                        //1015:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent year record
39291>>>                        If (Not;                            ((piB_Year_Year    (Self)) =  SysCurXr.Year_Year        );                            )                                                       Send Operation_Not_Allowed 1015
39294>>>                      End
39294>>>>
39294>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing baxio records
39294>>>>
39294>>>
39294>>>                //¢¦§¦å â¢œš®¦ 
39294>>>                //1001:baxio_hmnial > 0
39294>>>                If (Not(Baxio.Baxio_Hmnial > 0 ))   Send Operation_Not_Allowed 1001
39297>>>                //1002:baxio_v2 > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ œšš¨˜­ãª
39297>>>                If (Not(Baxio.Baxio_V2 > 0))         Send Operation_Not_Allowed 1002
39300>>>                //1003:baxio_c_code2 <> ""
39300>>>                If (Not(Baxio.Baxio_C_Code2 <>""))    Send Operation_Not_Allowed 1003
39303>>>                //1004:baxio_v0 > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
39303>>>//--------------If (Not(Baxio.Baxio_V0 > 0))         Send Operation_Not_Allowed 1004
39303>>>                //1005:baxio_v00> 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©œàª
39303>>>//--------------If (Not(Baxio.Baxio_V00> 0))         Send Operation_Not_Allowed 1005
39303>>>                //1006:baxio_vr > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ reporting
39303>>>//--------------If (Not(Baxio.Baxio_VR > 0))         Send Operation_Not_Allowed 1006
39303>>>                //1100:cby = globals
39303>>>
39303>>>                If (pifromxrhsh(Self)=0) Begin
39305>>>
39305>>>                    If ( ;                        (Not(Baxio.Company_Code = SyscurXr.Company_Code)) or;                        (Not(Baxio.Branch_Code  = SyscurXr.Branch_Code )) or;                        (Not(Baxio.Year_Year    = SyscurXr.Year_Year   ));                        )                                                   Send Operation_Not_Allowed 1100
39308>>>
39308>>>               End
39308>>>>
39308>>>
39308>>>               End //«â¢¦ª ¡é› ¡˜ validation
39308>>>>
39308>>>               Function_Return iReturnVal
39309>>>      End_Function //validate_save
39310>>>
39310>>>
39310>>>      //2007:ž › ˜š¨˜­ã ˜¥ ¦š¨á­¦¬ œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ «¦ bmove_dd
39310>>>      Function Validate_Delete  Returns Integer
39311>>>               Integer iReturnVal
39312>>>               Forward Get Validate_Delete  To iReturnVal
39314>>>               If (Not(iReturnVal));               Begin
39316>>>
39316>>>                  //2007:â¢œš®¦ª › ˜š¨˜­ãª ˜¥ ¦š¨á­¦¬ (£æ¤¦¤ ˜§¦ bmove_dd)
39316>>>                  If ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number)          Send Operation_Not_Allowed 2007
39319>>>
39319>>>                  //2100:cby = globals
39319>>>                  If ( ;                      (Not(Baxio.Company_Code = Syscurxr.Company_Code)) or;                      (Not(Baxio.Branch_Code  = Syscurxr.Branch_Code )) or;                      (Not(Baxio.Year_Year    = Syscurxr.Year_Year        ));                      )                                                   Send Operation_Not_Allowed 2100
39322>>>               End //«â¢¦ª ¡é› ¡˜ validation
39322>>>>
39322>>>               Function_Return iReturnVal
39323>>>      End_Function //validate_delete
39324>>>
39324>>>
39324>>>//------------------------------------------------------------------
39324>>>    Procedure Define_Fields
39325>>>        Forward Send Define_Fields
39327>>>        //DDB-Generated-Code-Location
39327>>>        //DDB-DefineFieldStart
39327>>>
39327>>>        Set Main_File            To Baxio.File_Number
39328>>>        Set Cascade_Delete_State To FALSE
39329>>>
39329>>>
39329>>>        // Child (Client) file structure................
39329>>>        Send Add_Client_File  Bmove.File_Number
39330>>>
39330>>>        // Parent (Server) file structure...............
39330>>>        Send Add_Server_File  Baxiokat.File_Number
39331>>>
39331>>>        // External (System) file structure.............
39331>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
39332>>>
39332>>>        Define_Auto_Increment  Sysrecb.Baxio_Rec0  To Baxio.Baxio_Rec0
39335>>>
39335>>>        // Field-based properties.......................
39335>>>
39335>>>        // Baxio.Company_Code
39335>>>
39335>>>        // Baxio.Branch_Code
39335>>>
39335>>>        // Baxio.Year_Year
39335>>>
39335>>>        // Baxio.Baxiokat_Code
39335>>>
39335>>>        // Baxio.Baxio_Code
39335>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Code To (SL037(Self))
39336>>>
39336>>>        // Baxio.Baxio_Rec0
39336>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Rec0 To (SL037(Self))
39337>>>
39337>>>        // Baxio.Year_Recr
39337>>>
39337>>>        // Baxio.Baxiokat_Recr
39337>>>
39337>>>        // Baxio.Baxio_Recr
39337>>>
39337>>>        // Baxio.Baxio_Status
39337>>>        Set Field_Value_Table      Field Baxio.Baxio_Status To (Baxio_Status_VT(Self))
39338>>>
39338>>>        // Baxio.Baxio_Place
39338>>>        Set Field_Value_Table      Field Baxio.Baxio_Place To (Baxio_Baxio_Place_VT(Self))
39339>>>
39339>>>        // Baxio.Baxio_File_In
39339>>>        Set Field_Value_Table      Field Baxio.Baxio_File_In To (Bfile_VT(Self))
39340>>>
39340>>>        // Baxio.Baxio_Code_In
39340>>>        //DDB/ Comment_Short       Field Baxio.Baxio_Code_In To "To BIAXIOKAT_FILE ¡˜Ÿ¦¨åœ  «ž¤ ©®œ« ¡ã ¢å©«˜"
39340>>>
39340>>>        // Baxio.Baxio_Epon_In
39340>>>
39340>>>        // Baxio.Baxio_Fpar_In
39340>>>
39340>>>        // Baxio.Baxio_File_Out
39340>>>        Set Field_Value_Table      Field Baxio.Baxio_File_Out To (Bfile_VT(Self))
39341>>>
39341>>>        // Baxio.Baxio_Code_Out
39341>>>
39341>>>        // Baxio.Baxio_Epon_Out
39341>>>
39341>>>        // Baxio.Baxio_Fpar_Out
39341>>>
39341>>>        // Baxio.Baxio_Lfile
39341>>>
39341>>>        // Baxio.Baxio_Lcode
39341>>>        Set Field_Value_Table      Field Baxio.Baxio_Lcode To (Bfile_VT(Self))
39342>>>
39342>>>        // Baxio.Baxio_Lepon
39342>>>
39342>>>        // Baxio.Baxio_Lpar
39342>>>
39342>>>        // Baxio.Baxio_Bank00000
39342>>>        Set Field_Value_Table      Field Baxio.Baxio_Bank00000 To (Baxio_Baxio_Bank_VT(Self))
39343>>>
39343>>>        // Baxio.Baxio_Hmniae
39343>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniae To (SL037(Self))
39344>>>
39344>>>        // Baxio.Baxio_Hmniap000
39344>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniap000 To (SL037(Self))
39345>>>
39345>>>        // Baxio.Baxio_Hmnial
39345>>>        //DDB/ Comment_Short       Field Baxio.Baxio_Hmnial To "†£/¤å˜ Šã¥žª:"
39345>>>
39345>>>        // Baxio.Baxio_Ekdoths
39345>>>
39345>>>        // Baxio.Baxio_Ekdothse
39345>>>
39345>>>        // Baxio.Baxio_Sediatagh
39345>>>
39345>>>        // Baxio.Baxio_Sdiataghe
39345>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Sdiataghe To (SL037(Self))
39346>>>
39346>>>        // Baxio.Baxio_Banka
39346>>>        Set Field_Value_Table      Field Baxio.Baxio_Banka To (Baxio_Baxio_Banka_VT(Self))
39347>>>
39347>>>        // Baxio.Baxio_Opistho
39347>>>
39347>>>        // Baxio.Baxio_No
39347>>>
39347>>>        // Baxio.Baxio_V2
39347>>>
39347>>>        // Baxio.Baxio_V0
39347>>>
39347>>>        // Baxio.Baxio_V00
39347>>>
39347>>>        // Baxio.Baxio_Vr
39347>>>
39347>>>        // Baxio.Baxio_Rate0
39347>>>
39347>>>        // Baxio.Baxio_Rate00
39347>>>
39347>>>        // Baxio.Baxio_Rater
39347>>>
39347>>>        // Baxio.Baxio_C_Code2
39347>>>        Set Field_Entry_msg        Field Baxio.Baxio_C_Code2 To get_Default_Axio_C_Code2
39348>>>        Set Field_Options          Field Baxio.Baxio_C_Code2 To DD_CAPSLOCK   
39349>>>        Set Field_Prompt_Object    Field Baxio.Baxio_C_Code2 To (slNomism(Self))
39350>>>
39350>>>        // Baxio.Baxio_Lixi_Yyyy
39350>>>
39350>>>        // Baxio.Baxio_Lixi_Mm
39350>>>
39350>>>        // Baxio.Baxio_Lixi_Dd
39350>>>
39350>>>        // Baxio.Baxio_Bmove_Laa
39350>>>
39350>>>        // Baxio.Baxio_Desm
39350>>>
39350>>>        // Baxio.Baxio_From
39350>>>        Set Field_Value_Table      Field Baxio.Baxio_From To (Baxio_Baxio_From_VT(Self))
39351>>>
39351>>>        // Baxio.Baxio_Topos
39351>>>        Set Field_Value_Table      Field Baxio.Baxio_Topos To (Baxio_Baxio_Topos_VT1(Self))
39352>>>
39352>>>        //DDB-DefineFieldEnd
39352>>>
39352>>>        Set Main_File            To Baxio.File_Number
39353>>>        Set Cascade_Delete_State To FALSE
39354>>>
39354>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
39355>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
39356>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39357>>>
39357>>>        // Child (Client) file structure................
39357>>>        Send Add_Client_File  Bmove.File_Number
39358>>>
39358>>>        // Parent (Server) file structure...............
39358>>>        Send Add_Server_File  Baxiokat.File_Number
39359>>>
39359>>>        // External (System) file structure.............
39359>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
39360>>>
39360>>>        Define_Auto_Increment  Sysrecb.Baxio_Rec0  To Baxio.Baxio_Rec0
39363>>>
39363>>>        // Field-based properties.......................
39363>>>
39363>>>        // Baxio.Company_Code
39363>>>
39363>>>        // Baxio.Branch_Code
39363>>>
39363>>>        // Baxio.Year_Year
39363>>>
39363>>>        // Baxio.Baxiokat_Code
39363>>>
39363>>>        // Baxio.Baxio_Code
39363>>>        Set Field_Label_Long       Field Baxio.Baxio_Code         To "‰à› ¡æª €¥ ¦š¨á­¦¬"
39364>>>        Set Field_Label_Short      Field Baxio.Baxio_Code         To "‰à› ¡æª"
39365>>>        Set Field_Options          Field Baxio.Baxio_Code         To DD_AUTOFIND    DD_NOPUT
39366>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Code         To (sl037(Self))
39367>>>        Set Key_Field_State        Field Baxio.Baxio_Code         To TRUE
39368>>>
39368>>>        // Baxio.Baxio_Rec0
39368>>>        Set Field_Options          Field Baxio.Baxio_Rec0         To DD_AUTOFIND    DD_REQUIRED
39369>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Rec0         To (sl037(Self))
39370>>>        Set Key_Field_State        Field Baxio.Baxio_Rec0         To TRUE
39371>>>
39371>>>        // Baxio.Year_Rec0
39371>>>
39371>>>        // Baxio.Baxiokat_Rec0
39371>>>
39371>>>        // Baxio.Baxio_Status
39371>>>        Set Field_Class_Name       Field Baxio.Baxio_Status       To "dbComboForm_EZ"
39372>>>        Set Field_Label_Long       Field Baxio.Baxio_Status       To "‰˜«á©«˜©ž"
39373>>>        Set Field_Label_Short      Field Baxio.Baxio_Status       To "‰˜«á©«˜©ž"
39374>>>        Set Field_Options  Field Baxio.Baxio_Status  To DD_DISPLAYONLY
39375>>>        Set Field_Value_Table      Field Baxio.Baxio_Status       To (Baxio_Status_VT(Self))
39376>>>
39376>>>        // Baxio.Baxio_Place
39376>>>        Set Field_Class_Name       Field Baxio.Baxio_Place        To "dbComboForm_EZ"
39377>>>        Set Field_Label_Long       Field Baxio.Baxio_Place        To "„¬¨å©¡œ«˜ "
39378>>>        Set Field_Label_Short      Field Baxio.Baxio_Place        To "„¬¨å©¡œ«˜ "
39379>>>        Set Field_Options          Field Baxio.Baxio_Place        To DD_DISPLAYONLY
39380>>>        Set Field_Value_Table      Field Baxio.Baxio_Place        To (Baxio_Baxio_Place_VT(Self))
39381>>>
39381>>>        // Baxio.Baxio_File_In
39381>>>        Set Field_Value_Table      Field Baxio.Baxio_File_In      To (Bfile_VT(Self))
39382>>>
39382>>>        // Baxio.Baxio_Code_In
39382>>>        Set Field_Label_Long       Field Baxio.Baxio_Code_In      To "˜¨œ¢ã­Ÿž €§æ"
39383>>>        Set Field_Label_Short      Field Baxio.Baxio_Code_In      To "˜¨œ¢ã­Ÿž €§æ"
39384>>>        Set Field_Options          Field Baxio.Baxio_Code_In      To DD_DISPLAYONLY
39385>>>
39385>>>        // Baxio.Baxio_Epon_In
39385>>>        Set Field_Label_Long       Field Baxio.Baxio_Epon_In      To "„§à¤¬£å˜"
39386>>>        Set Field_Label_Short      Field Baxio.Baxio_Epon_In      To "„§à¤¬£å˜"
39387>>>        Set Field_Options          Field Baxio.Baxio_Epon_In      To DD_DISPLAYONLY
39388>>>
39388>>>        // Baxio.Baxio_Fpar_In
39388>>>        Set Field_Label_Long       Field Baxio.Baxio_Fpar_In      To "˜¨/¡æ ˜¨˜¢˜™ãª"
39389>>>        Set Field_Label_Short      Field Baxio.Baxio_Fpar_In      To "˜¨/¡æ ˜¨˜¢."
39390>>>        Set Field_Options          Field Baxio.Baxio_Fpar_In      To DD_DISPLAYONLY
39391>>>
39391>>>        // Baxio.Baxio_File_Out
39391>>>        Set Field_Value_Table      Field Baxio.Baxio_File_Out     To (Bfile_VT(Self))
39392>>>
39392>>>        // Baxio.Baxio_Code_Out
39392>>>        Set Field_Label_Long       Field Baxio.Baxio_Code_Out     To "¨é«¦ª ˜¨˜¢ã§«žª"
39393>>>        Set Field_Label_Short      Field Baxio.Baxio_Code_Out     To "¨é«¦ª ˜¨˜¢ã§«žª"
39394>>>        Set Field_Options          Field Baxio.Baxio_Code_Out     To DD_DISPLAYONLY
39395>>>
39395>>>        // Baxio.Baxio_Epon_Out
39395>>>        Set Field_Label_Long       Field Baxio.Baxio_Epon_Out     To "„§à¤¬£å˜"
39396>>>        Set Field_Label_Short      Field Baxio.Baxio_Epon_Out     To "„§à¤¬£å˜"
39397>>>        Set Field_Options          Field Baxio.Baxio_Epon_Out     To DD_DISPLAYONLY
39398>>>
39398>>>        // Baxio.Baxio_Fpar_Out
39398>>>        Set Field_Options          Field Baxio.Baxio_Fpar_Out     To DD_DISPLAYONLY
39399>>>
39399>>>        // Baxio.Baxio_Lfile
39399>>>        Set Field_Value_Table      Field Baxio.Baxio_Lfile        To (Bfile_VT(Self))
39400>>>
39400>>>        // Baxio.Baxio_Lcode
39400>>>        Set Field_Label_Long       Field Baxio.Baxio_Lcode        To "’œ¢œ¬«˜å¦ª ˜¨˜¢ã§«žª"
39401>>>        Set Field_Label_Short      Field Baxio.Baxio_Lcode        To "’œ¢.˜¨˜¢ã§«žª"
39402>>>        Set Field_Options          Field Baxio.Baxio_Lcode        To DD_DISPLAYONLY
39403>>>
39403>>>        // Baxio.Baxio_Lepon
39403>>>        Set Field_Options          Field Baxio.Baxio_Lepon        To DD_DISPLAYONLY
39404>>>
39404>>>        // Baxio.Baxio_Lpar
39404>>>        Set Field_Label_Long       Field Baxio.Baxio_Lpar         To "˜¨/¡æ ˜¨á›¦©žª"
39405>>>        Set Field_Label_Short      Field Baxio.Baxio_Lpar         To "˜¨/¡æ ˜¨á›¦©žª"
39406>>>        Set Field_Options          Field Baxio.Baxio_Lpar         To DD_DISPLAYONLY
39407>>>
39407>>>        // Baxio.Baxio_Bank00000
39407>>>        Set Field_Class_Name       Field Baxio.Baxio_Bank00000    To "dbComboForm_EZ"
39408>>>        Set Field_Value_Table      Field Baxio.Baxio_Bank00000    To (Baxio_Baxio_Bank_VT(Self))
39409>>>
39409>>>        // Baxio.Baxio_Hmniae
39409>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmniae       To "dbSpinForm_EZ"
39410>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmniae       To "†£/¤å˜ „¡›¦©žª"
39411>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmniae       To "†£/¤å˜ „¡›¦©žª"
39412>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniae       To (sl037(Self))
39413>>>
39413>>>        // Baxio.Baxio_Hmniap000
39413>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmniap000    To "dbSpinForm_EZ"
39414>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmniap000    To "†£/¤å˜ ˜¨˜¢˜™ãª"
39415>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmniap000    To "†£/¤å˜ ˜¨˜¢˜™ãª"
39416>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniap000    To (sl037(Self))
39417>>>
39417>>>        // Baxio.Baxio_Hmnial
39417>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmnial       To "dbSpinForm_EZ"
39418>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmnial       To "†£/¤å˜ Šã¥žª"
39419>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmnial       To "†£/¤å˜ Šã¥žª"
39420>>>        Set Field_Options          Field Baxio.Baxio_Hmnial       To DD_REQUIRED
39421>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmnial       To (sl037(Self))
39422>>>
39422>>>        // Baxio.Baxio_Ekdoths
39422>>>        Set Field_Label_Long       Field Baxio.Baxio_Ekdoths      To "€¨® ¡æª „¡›æ«žª"
39423>>>        Set Field_Label_Short      Field Baxio.Baxio_Ekdoths      To "€¨®.„¡›æ«žª"
39424>>>
39424>>>        // Baxio.Baxio_Ekdothse
39424>>>        Set Field_Label_Long       Field Baxio.Baxio_Ekdothse     To "„§à¤¬£å˜ €¨® ¡¦ç „¡›æ«ž"
39425>>>        Set Field_Label_Short      Field Baxio.Baxio_Ekdothse     To "„§à¤¬£å˜"
39426>>>
39426>>>        // Baxio.Baxio_Sediatagh
39426>>>        Set Field_Label_Long       Field Baxio.Baxio_Sediatagh    To "‘œ ƒ ˜«˜šã"
39427>>>        Set Field_Label_Short      Field Baxio.Baxio_Sediatagh    To "‘œ ƒ ˜«˜šã"
39428>>>
39428>>>        // Baxio.Baxio_Sdiataghe
39428>>>        Set Field_Label_Long       Field Baxio.Baxio_Sdiataghe    To "„§à¤¬£å˜ €¨® ¡¦ç ƒ ¡˜ ¦ç®¦¬"
39429>>>        Set Field_Label_Short      Field Baxio.Baxio_Sdiataghe    To "„§à¤¬£å˜"
39430>>>
39430>>>        // Baxio.Baxio_Banka
39430>>>        Set Field_Class_Name       Field Baxio.Baxio_Banka        To "dbComboForm_EZ"
39431>>>        Set Field_Label_Long       Field Baxio.Baxio_Banka        To "’¨á§œ˜"
39432>>>        Set Field_Label_Short      Field Baxio.Baxio_Banka        To "’¨á§œ˜"
39433>>>        Set Field_Value_Table      Field Baxio.Baxio_Banka        To (Baxio_Baxio_Banka_VT(Self))
39434>>>
39434>>>        // Baxio.Baxio_Opistho
39434>>>        Set Field_Label_Long       Field Baxio.Baxio_Opistho      To "Š¦ §¦å Ž§ ©Ÿ¦š¨á­¦ "
39435>>>
39435>>>        // Baxio.Baxio_No
39435>>>        Set Field_Label_Long       Field Baxio.Baxio_No           To "€¨ Ÿ£æª"
39436>>>        Set Field_Label_Short      Field Baxio.Baxio_No           To "€¨ Ÿ£æª"
39437>>>
39437>>>        // Baxio.Baxio_V2
39437>>>        Set Field_Label_Long       Field Baxio.Baxio_V2           To "¦©æ"
39438>>>        Set Field_Label_Short      Field Baxio.Baxio_V2           To "¦©æ"
39439>>>        Set Field_Options          Field Baxio.Baxio_V2           To DD_REQUIRED
39440>>>
39440>>>        // Baxio.Baxio_V0
39440>>>        Set Field_Label_Long       Field Baxio.Baxio_V0           To "¦©æ ‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª"
39441>>>        Set Field_Label_Short      Field Baxio.Baxio_V0           To "¦©æ(‰¬¨. Œæ£.•¨.)"
39442>>>
39442>>>        // Baxio.Baxio_V00
39442>>>        Set Field_Label_Long       Field Baxio.Baxio_V00          To "¦©æ ƒœ¬«œ¨œç¦¤  Œæ£ ©£˜ •¨ã©œàª"
39443>>>        Set Field_Label_Short      Field Baxio.Baxio_V00          To "¦©æ(ƒœ¬«. Œæ£.•¨.)"
39444>>>
39444>>>        // Baxio.Baxio_Vr
39444>>>        Set Field_Label_Long       Field Baxio.Baxio_Vr           To "¦©æ Œæ£ ©£˜ Reporting"
39445>>>        Set Field_Label_Short      Field Baxio.Baxio_Vr           To "¦©æ( Œæ£.Rep.)"
39446>>>
39446>>>        // Baxio.Baxio_Rate0
39446>>>        Set Field_Label_Long       Field Baxio.Baxio_Rate0        To "Rate 1"
39447>>>        Set Field_Label_Short      Field Baxio.Baxio_Rate0        To "Rate 1"
39448>>>
39448>>>        // Baxio.Baxio_Rate00
39448>>>        Set Field_Label_Long       Field Baxio.Baxio_Rate00       To "Rate 2"
39449>>>        Set Field_Label_Short      Field Baxio.Baxio_Rate00       To "Rate 2"
39450>>>
39450>>>        // Baxio.Baxio_Rater
39450>>>        Set Field_Label_Long       Field Baxio.Baxio_Rater        To "Rate 3"
39451>>>        Set Field_Label_Short      Field Baxio.Baxio_Rater        To "Rate 3"
39452>>>
39452>>>        // Baxio.Baxio_C_Code2
39452>>>        Set Field_Class_Name       Field Baxio.Baxio_C_Code2      To "dbComboForm_EZ"
39453>>>        Set Field_Label_Long       Field Baxio.Baxio_C_Code2      To "Œæ£ ©£˜"
39454>>>        Set Field_Label_Short      Field Baxio.Baxio_C_Code2      To "Œæ£ ©£˜"
39455>>>        Set Field_Options          Field Baxio.Baxio_C_Code2      To DD_REQUIRED
39456>>>
39456>>>        // Baxio.Baxio_Lixi_Yyyy
39456>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Yyyy    To DD_DISPLAYONLY
39457>>>
39457>>>        // Baxio.Baxio_Lixi_Mm
39457>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Mm      To DD_DISPLAYONLY
39458>>>
39458>>>        // Baxio.Baxio_Lixi_Dd
39458>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Dd      To DD_DISPLAYONLY
39459>>>
39459>>>        // Baxio.Baxio_Bmove_Laa
39459>>>        Set Field_Options          Field Baxio.Baxio_Bmove_Laa    To DD_DISPLAYONLY
39460>>>
39460>>>    End_Procedure    // Define_Fields
39461>>>
39461>>>
39461>>>    Procedure Field_Defaults
39462>>>        Forward Send Field_Defaults
39464>>>        //DDB-Generated-Code-Location
39464>>>        //DDB-FieldDefaultStart
39464>>>        Set Field_Changed_Value   Field Baxio.Baxio_Status To 1
39465>>>        Set Field_Changed_Value   Field Baxio.Baxio_Place To 1
39466>>>        //DDB-FieldDefaultEnd
39466>>>    End_Procedure    // Field_Defaults
39467>>>
39467>>>End_Class    // Baxio_DataDictionary
39468>>>//DDB-Selection-pkg-Start
39468>>>
39468>>>Use SL037.SL         // SL037
INCLUDING FILE: SL037.SL
39468>>>>>//AB/ Project SL037:BAXIO
39468>>>>>//AB/ Object prj is a Lookup_Project
39468>>>>>//AB/     Set ProjectName to "SL037:BAXIO"
39468>>>>>//AB/     Set ProjectFileName to "SL037.SL"
39468>>>>>
39468>>>>>// Project Object Structure
39468>>>>>//   SL037 is a dbModalPanelSub
39468>>>>>//     Baxiokat_DD is a DataDictionary
39468>>>>>//     Baxio_DD is a DataDictionary
39468>>>>>//     oSelList is a dbListSub
39468>>>>>//     TextBoxSub1 is a TextBoxSub
39468>>>>>//     cSyDateForm1 is a cSyDateForm
39468>>>>>//     TextBoxSub2 is a TextBoxSub
39468>>>>>//     cSyDateForm2 is a cSyDateForm
39468>>>>>//     TextBoxSub4 is a TextBoxSub
39468>>>>>//     TextBoxSub5 is a TextBoxSub
39468>>>>>//     FormSub1 is a FormSub
39468>>>>>//     FormSub2 is a FormSub
39468>>>>>//     FormSub3 is a FormSub
39468>>>>>//     FormSub4 is a FormSub
39468>>>>>//     ButtonSub1 is a ButtonSub
39468>>>>>//     oOK_bn is a ButtonSub
39468>>>>>
39468>>>>>// Register all objects
39468>>>>>Register_Object Baxio_DD
39468>>>>>Register_Object Baxiokat_DD
39468>>>>>Register_Object ButtonSub1
39468>>>>>Register_Object cSyDateForm1
39468>>>>>Register_Object cSyDateForm2
39468>>>>>Register_Object FormSub1
39468>>>>>Register_Object FormSub2
39468>>>>>Register_Object FormSub3
39468>>>>>Register_Object FormSub4
39468>>>>>Register_Object oOK_bn
39468>>>>>Register_Object oSelList
39468>>>>>Register_Object SL037
39468>>>>>Register_Object TextBoxSub1
39468>>>>>Register_Object TextBoxSub2
39468>>>>>Register_Object TextBoxSub4
39468>>>>>Register_Object TextBoxSub5
39468>>>>>
39468>>>>>
39468>>>>>
39468>>>>>//AB-StoreTopStart
39468>>>>>    
39468>>>>>Use sl100.sl
INCLUDING FILE: SL100.SL
39468>>>>>>>//AB/ Project SL100:PELATES
39468>>>>>>>//AB/     Object prj is a Lookup_Project
39468>>>>>>>//AB/         Set ProjectName to "SL100:PELATES"
39468>>>>>>>//AB/         Set ProjectFileName to "SL100.SL"
39468>>>>>>>
39468>>>>>>>// Project Object Structure
39468>>>>>>>//   sl100 is a dbModalPanelSub
39468>>>>>>>//     Clients_DD is a DataDictionary
39468>>>>>>>//     oSelList is a dbListSub
39468>>>>>>>//     oOK_bn is a ButtonSub
39468>>>>>>>//     oCancel_bn is a ButtonSub
39468>>>>>>>//     oSearch_bn is a ButtonSub
39468>>>>>>>
39468>>>>>>>// Register all objects
39468>>>>>>>Register_Object Clients_DD
39468>>>>>>>Register_Object oCancel_bn
39468>>>>>>>Register_Object oOK_bn
39468>>>>>>>Register_Object oSearch_bn
39468>>>>>>>Register_Object oSelList
39468>>>>>>>Register_Object sl100
39468>>>>>>>
39468>>>>>>>
39468>>>>>>>    //AB-IgnoreStart
39468>>>>>>>
39468>>>>>>>    Use DFAllEnt.pkg
39468>>>>>>>    Use dbList.Sub
39468>>>>>>>    Use Button.Sub
39468>>>>>>>
39468>>>>>>>
39468>>>>>>>    Use CLIENTS.DD
INCLUDING FILE: CLIENTS.DD
39468>>>>>>>>>//DDB-FileStart
39468>>>>>>>>>//DDB-HeaderStart
39468>>>>>>>>>
39468>>>>>>>>>// File Name : CLIENTS.DD
39468>>>>>>>>>// Class Name: Clients_DataDictionary
39468>>>>>>>>>// Revision  : 245
39468>>>>>>>>>// Version   : 2
39468>>>>>>>>>
39468>>>>>>>>>Use  Windows           // Basic Definitions
39468>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
39468>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39468>>>>>>>>>
39468>>>>>>>>>Open Clients
39470>>>>>>>>>Open Cmoves
INCLUDING FILE: CMOVES.FD
39472>>>>>>>>>Open Particle
INCLUDING FILE: PARTICLE.FD
39474>>>>>>>>>Open Cmovesa
INCLUDING FILE: CMOVESA.FD
39476>>>>>>>>>Open Cn
39478>>>>>>>>>Open Particll
INCLUDING FILE: PARTICLL.FD
39480>>>>>>>>>Open Clnbank
INCLUDING FILE: CLNBANK.FD
39482>>>>>>>>>Open Tpclient
INCLUDING FILE: TPCLIENT.FD
39484>>>>>>>>>Open Clorder
INCLUDING FILE: CLORDER.FD
39486>>>>>>>>>Open Clitem
INCLUDING FILE: CLITEM.FD
39488>>>>>>>>>Open Cities
39490>>>>>>>>>Open Areas
39492>>>>>>>>>Open Payresp
39494>>>>>>>>>Open Syscurxr
39496>>>>>>>>>Open Sysrecc
INCLUDING FILE: SYSRECC.FD
39498>>>>>>>>>Open Ptypparl
39500>>>>>>>>>Open Gmove
INCLUDING FILE: GMOVE.FD
39502>>>>>>>>>Open Sysrecg
39504>>>>>>>>>
39504>>>>>>>>>//DDB-HeaderEnd
39504>>>>>>>>>//DDB-ValidationStart
39504>>>>>>>>>
39504>>>>>>>>>Register_Object Clients_Client_Doy_VT
39504>>>>>>>>>Register_Object Clients_Client_Job_VT
39504>>>>>>>>>Register_Object Clients_Client_Categfpa_VT
39504>>>>>>>>>Register_Object Clients_Client_Catjob_VT1
39504>>>>>>>>>Register_Object Clients_Client_Idiot_VT
39504>>>>>>>>>Register_Object Clients_Feregios_VT
39504>>>>>>>>>
39504>>>>>>>>>Object Clients_Client_Doy_VT  is a CodeValidationTable
39506>>>>>>>>>    Set Type_Value        To "DOY"
39507>>>>>>>>>    Set Validate_State    To FALSE
39508>>>>>>>>>    Set Allow_Blank_State To TRUE
39509>>>>>>>>>    Set Table_Title       To "ƒ.Ž.“"
39510>>>>>>>>>    //DDB-ValidationCustomStart
39510>>>>>>>>>    //DDB-ValidationCustomEnd
39510>>>>>>>>>End_Object   // Clients_Client_Doy_VT
39511>>>>>>>>>
39511>>>>>>>>>Object Clients_Client_Job_VT  is a CodeValidationTable
39513>>>>>>>>>    Set Type_Value        To "JOB"
39514>>>>>>>>>    Set Validate_State    To FALSE
39515>>>>>>>>>    Set Allow_Blank_State To TRUE
39516>>>>>>>>>    Set Table_Title       To "„§˜ššâ¢£˜«˜"
39517>>>>>>>>>    //DDB-ValidationCustomStart
39517>>>>>>>>>    //DDB-ValidationCustomEnd
39517>>>>>>>>>End_Object   // Clients_Client_Job_VT
39518>>>>>>>>>
39518>>>>>>>>>Object Clients_Client_Categfpa_VT  is a CodeValidationTable
39520>>>>>>>>>    Set Type_Value        To "VAT_STATUS"
39521>>>>>>>>>    Set Validate_State    To FALSE
39522>>>>>>>>>    Set Allow_Blank_State To TRUE
39523>>>>>>>>>    //DDB-ValidationCustomStart
39523>>>>>>>>>    //DDB-ValidationCustomEnd
39523>>>>>>>>>End_Object   // Clients_Client_Categfpa_VT
39524>>>>>>>>>
39524>>>>>>>>>Object Clients_Client_Catjob_VT1  is a CodeValidationTable
39526>>>>>>>>>    Set Type_Value        To "JOB"
39527>>>>>>>>>    Set Validate_State    To FALSE
39528>>>>>>>>>    Set Allow_Blank_State To TRUE
39529>>>>>>>>>    //DDB-ValidationCustomStart
39529>>>>>>>>>    //DDB-ValidationCustomEnd
39529>>>>>>>>>End_Object   // Clients_Client_Catjob_VT1
39530>>>>>>>>>
39530>>>>>>>>>Object Clients_Client_Idiot_VT  is a CodeValidationTable
39532>>>>>>>>>    Set Type_Value        To "IDIOT"
39533>>>>>>>>>    Set Validate_State    To FALSE
39534>>>>>>>>>    Set Allow_Blank_State To TRUE
39535>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ˆ› ¦«ã«à¤"
39536>>>>>>>>>    //DDB-ValidationCustomStart
39536>>>>>>>>>    //DDB-ValidationCustomEnd
39536>>>>>>>>>End_Object   // Clients_Client_Idiot_VT
39537>>>>>>>>>
39537>>>>>>>>>Object Clients_Feregios_VT  is a CodeValidationTable
39539>>>>>>>>>    Set Type_Value        To "FEREGIOS"
39540>>>>>>>>>    Set Allow_Blank_State To TRUE
39541>>>>>>>>>    Set Table_Title       To "ƒœå¡«œª ”œ¨œšš¬æ«ž«˜ª ”¦¨âà¤"
39542>>>>>>>>>    //DDB-ValidationCustomStart
39542>>>>>>>>>    //DDB-ValidationCustomEnd
39542>>>>>>>>>End_Object   // Clients_Feregios_VT
39543>>>>>>>>>//DDB-ValidationEnd
39543>>>>>>>>>//DDB-SelectionStart
39543>>>>>>>>>//DDB/ ExternalSelectionList sl100  sl100.SL
39543>>>>>>>>>//DDB/ ExternalSelectionList slPayTerms  slPayTerms.SL
39543>>>>>>>>>Register_Object sl100
39543>>>>>>>>>Register_Object slPayTerms
39543>>>>>>>>>//DDB-SelectionEnd
39543>>>>>>>>>
39543>>>>>>>>>Open Sysfile
39545>>>>>>>>>open year
39547>>>>>>>>>
39547>>>>>>>>>Class Clients_DataDictionary  is a DataDictionary_Sec
39548>>>>>>>>>
39548>>>>>>>>>    Procedure Construct_Object
39549>>>>>>>>>        Forward Send Construct_Object
39551>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
39552>>>>>>>>>        Property Integer piCheckPlaf        Public 0
39553>>>>>>>>>        //------------------------------------------------
39553>>>>>>>>>        // Properties gia na kraththoun oi palies times
39553>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio
39553>>>>>>>>>        // einai 1     js 03/12/2007
39553>>>>>>>>>        //------------------------------------------------
39553>>>>>>>>>        Property Integer piCreateNew            Public  0
39554>>>>>>>>>        Property String  psAud_Old_Pelaths      Public ""
39555>>>>>>>>>        Property String  psAud_Old_PelathsN     Public ""
39556>>>>>>>>>        Property String  psAud_Old_AFM          Public ""
39557>>>>>>>>>        Property String  psAud_Old_DOY          Public ""
39558>>>>>>>>>        Property String  psAud_Old_DOYN         Public ""
39559>>>>>>>>>        Property Integer piAud_Old_HPAL         Public  0
39560>>>>>>>>>        Property Integer piAud_Old_HPSO         Public  0
39561>>>>>>>>>        Property String  psAud_Old_PartlRecr    Public ""
39562>>>>>>>>>        Property String  psAud_Old_PmsRecr      Public ""
39563>>>>>>>>>        //------------------------------------------------
39563>>>>>>>>>
39563>>>>>>>>>    End_Procedure
39564>>>>>>>>>
39564>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
39565>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
39567>>>>>>>>>        //------------------------------------------------
39567>>>>>>>>>        // Properties gia na kraththoun oi palies times
39567>>>>>>>>>        // ton pedion js 03/12/2007
39567>>>>>>>>>        //------------------------------------------------
39567>>>>>>>>>        Set psAud_Old_Pelaths      to Clients.Client_ID
39568>>>>>>>>>        Set psAud_Old_PelathsN     to Clients.Client_Name
39569>>>>>>>>>        Set psAud_Old_AFM          to Clients.Client_AFM
39570>>>>>>>>>        Set psAud_Old_DOY          to Clients.Client_Doy
39571>>>>>>>>>        Set psAud_Old_DOYN         to (gsfCode_Mast("DOY",Clients.Client_Doy))
39572>>>>>>>>>        Set piAud_Old_HPAL         to Clients.HPAL
39573>>>>>>>>>        Set piAud_Old_HPSO         to Clients.HPSO
39574>>>>>>>>>        Set psAud_Old_PartlRecr    to Clients.Client_Recr
39575>>>>>>>>>        Set psAud_Old_PmsRecr      to Clients.Client_Recr
39576>>>>>>>>>        //------------------------------------------------
39576>>>>>>>>>     End_Procedure   // New_Current_Record
39577>>>>>>>>>
39577>>>>>>>>>
39577>>>>>>>>>    // Backout:
39577>>>>>>>>>    Procedure Backout
39578>>>>>>>>>        Forward Send Backout
39580>>>>>>>>>        // Insert Code Here
39580>>>>>>>>>    End_Procedure   // Backout
39581>>>>>>>>>
39581>>>>>>>>>    Procedure Delete_Main_File
39582>>>>>>>>>        //---------------------------------------------
39582>>>>>>>>>        // Auditing / Katagrafh allagon
39582>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
39583>>>>>>>>>        Date    dDate  Shmer
39583>>>>>>>>>        Integer iMin iHour iSec iLen
39583>>>>>>>>>        Sysdate dDate iHour iMin iSec
39587>>>>>>>>>        Move iHour  to sHour
39588>>>>>>>>>        Move iMin   to sMin
39589>>>>>>>>>        Move iSec   to sSec
39590>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
39594>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
39598>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
39602>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
39603>>>>>>>>>
39603>>>>>>>>>        // Auditing / Diagrafh
39603>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
39605>>>>>>>>>            Get fsLoginUserID to sUser
39606>>>>>>>>>            clear gmove
39607>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
39608>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
39609>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
39610>>>>>>>>>            move  2                     to gmove.gtypkin_code// Apo Clients
39611>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
39612>>>>>>>>>            move suser                  to gmove.gplan_code
39613>>>>>>>>>            move Clients.Client_Recr    to gmove.garticl_recr
39614>>>>>>>>>            reread sysrecg
39618>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
39619>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
39620>>>>>>>>>            saverecord sysrecg
39621>>>>>>>>>            unlock
39622>>>>>>>>>>
39622>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
39623>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
39624>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs
39625>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
39626>>>>>>>>>
39626>>>>>>>>>            Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
39627>>>>>>>>>            Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
39628>>>>>>>>>            Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
39629>>>>>>>>>            Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy
39630>>>>>>>>>            Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
39631>>>>>>>>>            Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
39632>>>>>>>>>            Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
39633>>>>>>>>>
39633>>>>>>>>>
39633>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª œ¢á«ž"     to gmove.gmove_aitiol
39634>>>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
39635>>>>>>>>>            saverecord gmove
39636>>>>>>>>>        End
39636>>>>>>>>>>
39636>>>>>>>>>
39636>>>>>>>>>        Forward Send Delete_Main_File
39638>>>>>>>>>
39638>>>>>>>>>    End_Procedure
39639>>>>>>>>>
39639>>>>>>>>>
39639>>>>>>>>>    Procedure Update
39640>>>>>>>>>        Forward Send Update
39642>>>>>>>>>        // Insert Code Here
39642>>>>>>>>>        Move SysCurXR.Company_Code  to Clients.Company_Code
39643>>>>>>>>>        Move SysCurXR.Branch_Code   to Clients.Branch_Code
39644>>>>>>>>>        Move SysCurXR.Year_Year     to Clients.Year_Year
39645>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
39645>>>>>>>>>        Move (Clients.Xreosh-Clients.Pistosh)   to Clients.Ypoloipo
39646>>>>>>>>>        Move (Clients.Plafon-Clients.Ypoloipo)  to Clients.Overhead
39647>>>>>>>>>
39647>>>>>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
39647>>>>>>>>>
39647>>>>>>>>>        //betolink
39647>>>>>>>>>        Move SysCurXR.Beto_Site      to Clients.Client_SiteW
39648>>>>>>>>>        Move Clients.Client_Rec0     to Clients.Client_SN
39649>>>>>>>>>        Move Clients.Client_id       to Clients.Client_Repm
39650>>>>>>>>>        Move Clients.Company_Code    to Clients.CLIENT_COMPANY
39651>>>>>>>>>        Move Clients.Client_id       to Clients.Client_RepMatch
39652>>>>>>>>>     //   Move (gsfCode_Mast('JOB',Clients.Client_CatJob)) to Clients.Client_Job
39652>>>>>>>>>
39652>>>>>>>>>        //---------------------------------------------
39652>>>>>>>>>        // Auditing / Katagrafh allagon
39652>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
39653>>>>>>>>>        Date    dDate  Shmer
39653>>>>>>>>>        Integer iMin iHour iSec iLen
39653>>>>>>>>>        Sysdate dDate iHour iMin iSec
39657>>>>>>>>>        Move iHour  to sHour
39658>>>>>>>>>        Move iMin   to sMin
39659>>>>>>>>>        Move iSec   to sSec
39660>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
39664>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
39668>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
39672>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
39673>>>>>>>>>
39673>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
39673>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
39675>>>>>>>>>            Get fsLoginUserID to sUser
39676>>>>>>>>>            If (piCreateNew(Self)=1) Begin
39678>>>>>>>>>                clear gmove
39679>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
39680>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
39681>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
39682>>>>>>>>>                move  2                     to gmove.gtypkin_code// Apo Clients
39683>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
39684>>>>>>>>>                move suser                  to gmove.gplan_code
39685>>>>>>>>>                move Clients.Client_Recr    to gmove.garticl_recr
39686>>>>>>>>>                reread sysrecg
39690>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
39691>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
39692>>>>>>>>>                saverecord sysrecg
39693>>>>>>>>>                unlock
39694>>>>>>>>>>
39694>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
39695>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
39696>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs
39697>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
39698>>>>>>>>>                Move Clients.Client_ID              to Gmove.Cur_ID
39699>>>>>>>>>                Move Clients.CLient_Name            to Gmove.Cur_Name
39700>>>>>>>>>                Move Clients.Client_Recr            to Gmove.Partl_Recr
39701>>>>>>>>>                Move Clients.Client_Recr            to Gmove.Pms_Recr
39702>>>>>>>>>                Move Clients.Client_AFM             to Gmove.Cur_AFM
39703>>>>>>>>>                Move Clients.Client_DOY             to Gmove.Cur_DOY
39704>>>>>>>>>                Move (gsfCode_Mast("DOY",Clients.Client_Doy)) to Gmove.Txt4
39705>>>>>>>>>                Move Clients.HPAL                   to Gmove.Prev_Stoxos1
39706>>>>>>>>>                Move Clients.HPSO                   to Gmove.Prev_Stoxos2
39707>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â¦¬ œ¢á«ž"       to Gmove.Gmove_Aitiol
39708>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs
39709>>>>>>>>>                saverecord gmove
39710>>>>>>>>>                Set piCreateNew to 0
39711>>>>>>>>>            End
39711>>>>>>>>>>
39711>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin
39714>>>>>>>>>                Integer isChanged
39714>>>>>>>>>                Move 0 to isChanged
39715>>>>>>>>>
39715>>>>>>>>>                     If (psAud_Old_Pelaths  (Self)<>Clients.Client_ID   ) Move 1 to isChanged
39718>>>>>>>>>                Else If (psAud_Old_PelathsN (Self)<>Clients.Client_Name ) Move 1 to isChanged
39722>>>>>>>>>                Else If (psAud_Old_AFM      (Self)<>Clients.Client_AFM  ) Move 1 to isChanged
39726>>>>>>>>>                Else If (psAud_Old_DOY      (Self)<>Clients.Client_DOY  ) Move 1 to isChanged
39730>>>>>>>>>                Else If (piAud_Old_HPAL     (Self)<>Clients.HPAL        ) Move 1 to isChanged
39734>>>>>>>>>                Else If (piAud_Old_HPSO     (Self)<>Clients.HPSO        ) Move 1 to isChanged
39738>>>>>>>>>
39738>>>>>>>>>                If (isChanged>0) Begin
39740>>>>>>>>>                    clear gmove
39741>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
39742>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
39743>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
39744>>>>>>>>>                    move  2                     to gmove.gtypkin_code// Apo Clients
39745>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
39746>>>>>>>>>                    move suser                  to gmove.gplan_code
39747>>>>>>>>>                    move Clients.Client_Recr    to gmove.garticl_recr
39748>>>>>>>>>                    reread sysrecg
39752>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
39753>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
39754>>>>>>>>>                    saverecord sysrecg
39755>>>>>>>>>                    unlock
39756>>>>>>>>>>
39756>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
39757>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
39758>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs
39759>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
39760>>>>>>>>>                    Move Clients.Client_Recr            to Gmove.Partl_Recr
39761>>>>>>>>>                    Move Clients.Client_Recr            to Gmove.Pms_Recr
39762>>>>>>>>>                    //--
39762>>>>>>>>>                    Move Clients.Client_ID              to Gmove.Cur_ID
39763>>>>>>>>>                    Move Clients.CLient_Name            to Gmove.Cur_Name
39764>>>>>>>>>                    Move Clients.Client_AFM             to Gmove.Cur_AFM
39765>>>>>>>>>                    Move Clients.Client_DOY             to Gmove.Cur_DOY
39766>>>>>>>>>                    Move (gsfCode_Mast("DOY",Clients.Client_Doy)) to Gmove.Txt4
39767>>>>>>>>>                    Move Clients.HPAL                   to Gmove.Cur_Stoxos1
39768>>>>>>>>>                    Move Clients.HPSO                   to Gmove.Cur_Stoxos2
39769>>>>>>>>>                    //--
39769>>>>>>>>>                    Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
39770>>>>>>>>>                    Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
39771>>>>>>>>>                    Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
39772>>>>>>>>>                    Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy
39773>>>>>>>>>                    Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
39774>>>>>>>>>                    Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
39775>>>>>>>>>                    Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
39776>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª œ¢á«ž"     to gmove.gmove_aitiol
39777>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
39778>>>>>>>>>                    saverecord gmove
39779>>>>>>>>>                    Set piCreateNew to 0
39780>>>>>>>>>                End
39780>>>>>>>>>>
39780>>>>>>>>>            End
39780>>>>>>>>>>
39780>>>>>>>>>        End
39780>>>>>>>>>>
39780>>>>>>>>>
39780>>>>>>>>>
39780>>>>>>>>>    End_Procedure   // Update
39781>>>>>>>>>
39781>>>>>>>>>
39781>>>>>>>>>    Procedure Creating
39782>>>>>>>>>        date ddate iYes
39783>>>>>>>>>        Forward Send Creating
39785>>>>>>>>>        // Insert Code Here
39785>>>>>>>>>
39785>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Clients.Client_Rec0))))));                                    to Clients.Client_Recr
39786>>>>>>>>>        Move '1'                    to Clients.Client_Active
39787>>>>>>>>>        get fsgCode_With_Zeroes Clients.Client_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Clients.Client_ID
39788>>>>>>>>>        sysdate4 ddate
39789>>>>>>>>>        move ddate                  to Clients.Client_Hmnia
39790>>>>>>>>>        Set piCreateNew to 1
39791>>>>>>>>>    End_Procedure   // Creating
39792>>>>>>>>>
39792>>>>>>>>>    Function Validate_Save  Returns Integer
39793>>>>>>>>>        Integer iReturnVal iCheck iYes
39794>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
39796>>>>>>>>>        If (Not(iReturnVal)) Begin
39798>>>>>>>>>
39798>>>>>>>>>            If (clients.is_eksoter <> '1') begin
39800>>>>>>>>>                If (Clients.Is_Xondr='1') Begin
39802>>>>>>>>>                    If (Sysfile.Check_Afm=1) Begin
39804>>>>>>>>>                        Move (Check_AFM(Clients.Client_Afm)) to iCheck
39805>>>>>>>>>                        If (iCheck) Begin
39807>>>>>>>>>                                 If (iCheck=1) Move 4001 to iReturnVal
39810>>>>>>>>>                            Else If (iCheck=2) Move 4002 to iReturnVal
39814>>>>>>>>>                            Else If (iCheck=3) Move 4003 to iReturnVal
39818>>>>>>>>>                        End
39818>>>>>>>>>>
39818>>>>>>>>>                    End
39818>>>>>>>>>>
39818>>>>>>>>>                End
39818>>>>>>>>>>
39818>>>>>>>>>            End
39818>>>>>>>>>>
39818>>>>>>>>>
39818>>>>>>>>>            If (piCheckPlaf(Self)=1) Begin
39820>>>>>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Dap)>Clients.Plafon)) Begin
39822>>>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4000 Clients' to iYes
39823>>>>>>>>>                    If (iYes=MBR_NO) Error 4004 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž' //Move 4004 to iReturnVal
39826>>>>>>>>>                End
39826>>>>>>>>>>
39826>>>>>>>>>                Else If ((PayResp.Plafon<>0) And (PayResp.Plafon<=PayResp.Synolikh_Ofeilh)) Begin
39829>>>>>>>>>                    Get YesNo_Box 'Ž ¬§œçŸ¬¤¦ª §¢ž¨à£ãª ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž\nŒ˜ ©¬¤œ®å©à ©«ž¤ ›ž£ ¦¬¨šå˜ œšš¨˜­ãª §œ¢á«ž;' to iYes
39830>>>>>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
39833>>>>>>>>>                End
39833>>>>>>>>>>
39833>>>>>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Clients.Orio_Syn_Ofeilh)) Begin
39836>>>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4001 Clients' to iYes
39837>>>>>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
39840>>>>>>>>>                End
39840>>>>>>>>>>
39840>>>>>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (PayResp.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Payresp.Orio_Syn_Ofeilh)) Begin
39843>>>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4002 Clients' to iYes
39844>>>>>>>>>                    If (iYes=MBR_NO) Error 4006 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'   //Move 4006 to iReturnVal
39847>>>>>>>>>                End
39847>>>>>>>>>>
39847>>>>>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Parag)>Clients.Plafon)) Begin
39849>>>>>>>>>                    Send Info_Box '’˜ §¦©á «à¤ ž£œ¨ž©åà¤ §˜¨˜ššœ¢ é¤\n¬§œ¨™˜å¤¦¬¤ «¦ › ˜Ÿâ© £¦ ¬§æ¢¦ §¦\n™á©ž §¢˜­æ¤ «¦¬ §œ¢á«ž' '¨¦©¦®ã !!!'
39850>>>>>>>>>                End
39850>>>>>>>>>>
39850>>>>>>>>>            End
39850>>>>>>>>>>
39850>>>>>>>>>
39850>>>>>>>>>            If (iReturnVal) Begin
39852>>>>>>>>>                Send Operation_Not_Allowed iReturnVal
39853>>>>>>>>>            End
39853>>>>>>>>>>
39853>>>>>>>>>        End
39853>>>>>>>>>>
39853>>>>>>>>>        Function_Return iReturnVal
39854>>>>>>>>>    End_Function   // Validate_Save
39855>>>>>>>>>
39855>>>>>>>>>
39855>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
39856>>>>>>>>>        String lsError_Message
39857>>>>>>>>>
39857>>>>>>>>>        Case Begin
39857>>>>>>>>>            Case (iError_Num = 4001)
39859>>>>>>>>>                Move "DDC 100: Š˜¤Ÿ˜©£â¤¦ €”‹ œ¢á«ž" ;                    to lsError_Message
39860>>>>>>>>>              Case Break
39861>>>>>>>>>            Case (iError_Num = 4002)
39864>>>>>>>>>                Move "DDC 100: ’¦ €”‹ œ¢á«ž ›œ¤ œå¤˜  9 ¯ã­ ¦" ;                    to lsError_Message
39865>>>>>>>>>              Case Break
39866>>>>>>>>>            Case (iError_Num = 4003)
39869>>>>>>>>>                Move "DDC 100: €¡˜«á¢¢ž¢¦ª ®˜¨˜¡«ã¨˜ª ©«¦ €”‹ œ¢á«ž" ;                    to lsError_Message
39870>>>>>>>>>              Case Break
39871>>>>>>>>>            Case (iError_Num = 4004)
39874>>>>>>>>>                Move "DDC 100: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ §œ¢á«ž" ;                    to lsError_Message
39875>>>>>>>>>              Case Break
39876>>>>>>>>>            Case (iError_Num = 4005)
39879>>>>>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª" ;                    to lsError_Message
39880>>>>>>>>>              Case Break
39881>>>>>>>>>            Case (iError_Num = 4006)
39884>>>>>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª «¦¬ “§œ¬Ÿç¤¦¬" ;                    to lsError_Message
39885>>>>>>>>>              Case Break
39886>>>>>>>>>
39886>>>>>>>>>            Case Else
39886>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
39888>>>>>>>>>        Case End
39888>>>>>>>>>
39888>>>>>>>>>        Error iError_Num lsError_Message
39889>>>>>>>>>>
39889>>>>>>>>>    End_Procedure // operation_not_allowed
39890>>>>>>>>>
39890>>>>>>>>>
39890>>>>>>>>>    // Define_Fields:
39890>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39890>>>>>>>>>
39890>>>>>>>>>    Procedure Define_Fields
39891>>>>>>>>>        Forward Send Define_Fields
39893>>>>>>>>>        //DDB-Generated-Code-Location
39893>>>>>>>>>        //DDB-DefineFieldStart
39893>>>>>>>>>
39893>>>>>>>>>        Set Main_File            To Clients.File_Number
39894>>>>>>>>>        Set Cascade_Delete_State To FALSE
39895>>>>>>>>>
39895>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
39896>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
39897>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39898>>>>>>>>>
39898>>>>>>>>>        // Child (Client) file structure................
39898>>>>>>>>>        Send Add_Client_File  Cmoves.File_Number
39899>>>>>>>>>        Send Add_Client_File  Particle.File_Number
39900>>>>>>>>>        Send Add_Client_File  Cmovesa.File_Number
39901>>>>>>>>>        Send Add_Client_File  Cn.File_Number
39902>>>>>>>>>        Send Add_Client_File  Particll.File_Number
39903>>>>>>>>>        Send Add_Client_File  Clnbank.File_Number
39904>>>>>>>>>        Send Add_Client_File  Tpclient.File_Number
39905>>>>>>>>>        Send Add_Client_File  Clorder.File_Number
39906>>>>>>>>>        Send Add_Client_File  Clitem.File_Number
39907>>>>>>>>>
39907>>>>>>>>>        // Parent (Server) file structure...............
39907>>>>>>>>>        Send Add_Server_File  Cities.File_Number
39908>>>>>>>>>        Send Add_Server_File  Areas.File_Number
39909>>>>>>>>>        Send Add_Server_File  Payresp.File_Number
39910>>>>>>>>>
39910>>>>>>>>>        // External (System) file structure.............
39910>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
39911>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
39912>>>>>>>>>        Send Add_System_File  Ptypparl.File_Number  DD_LOCK_ON_ALL
39913>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
39914>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
39915>>>>>>>>>
39915>>>>>>>>>        Define_Auto_Increment  Sysrecc.Client_Rec0  To Clients.Client_Rec0
39918>>>>>>>>>
39918>>>>>>>>>        // Field-based properties.......................
39918>>>>>>>>>
39918>>>>>>>>>        // Clients.Company_Code
39918>>>>>>>>>
39918>>>>>>>>>        // Clients.Branch_Code
39918>>>>>>>>>
39918>>>>>>>>>        // Clients.Year_Year
39918>>>>>>>>>
39918>>>>>>>>>        // Clients.Custprom_Code
39918>>>>>>>>>
39918>>>>>>>>>        // Clients.Client_Id
39918>>>>>>>>>        Set Field_Options          Field Clients.Client_Id To DD_AUTOFIND    DD_NOPUT
39919>>>>>>>>>        Set Field_Prompt_Object    Field Clients.Client_Id To (sl100(Self))
39920>>>>>>>>>        Set Key_Field_State        Field Clients.Client_Id To TRUE
39921>>>>>>>>>
39921>>>>>>>>>        // Clients.Client_Name
39921>>>>>>>>>        Set Field_Prompt_Object    Field Clients.Client_Name To (sl100(Self))
39922>>>>>>>>>
39922>>>>>>>>>        // Clients.Client_Afm
39922>>>>>>>>>        Set Field_Options          Field Clients.Client_Afm To DD_AUTOFIND
39923>>>>>>>>>
39923>>>>>>>>>        // Clients.Client_Rec0
39923>>>>>>>>>        Set Field_Options          Field Clients.Client_Rec0 To DD_AUTOFIND
39924>>>>>>>>>
39924>>>>>>>>>        // Clients.Custprom_Recr
39924>>>>>>>>>
39924>>>>>>>>>        // Clients.Client_Recr
39924>>>>>>>>>        Set Field_Options          Field Clients.Client_Recr To DD_AUTOFIND
39925>>>>>>>>>
39925>>>>>>>>>        // Clients.Last_Xreosh
39925>>>>>>>>>
39925>>>>>>>>>        // Clients.Last_Pistosh
39925>>>>>>>>>
39925>>>>>>>>>        // Clients.Last_Order
39925>>>>>>>>>        Set Field_Class_Name       Field Clients.Last_Order To "dbComboFormSub"
39926>>>>>>>>>
39926>>>>>>>>>        // Clients.Client_Doy
39926>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Doy To (Clients_Client_Doy_VT(Self))
39927>>>>>>>>>
39927>>>>>>>>>        // Clients.Client_Address
39927>>>>>>>>>
39927>>>>>>>>>        // Clients.Client_City_Id
39927>>>>>>>>>
39927>>>>>>>>>        // Clients.Client_Area
39927>>>>>>>>>
39927>>>>>>>>>        // Clients.Client_Job
39927>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Job To (Clients_Client_Job_VT(Self))
39928>>>>>>>>>
39928>>>>>>>>>        // Clients.Client_Respons
39928>>>>>>>>>
39928>>>>>>>>>        // Clients.Client_Zipcode
39928>>>>>>>>>
39928>>>>>>>>>        // Clients.Client_Phone
39928>>>>>>>>>
39928>>>>>>>>>        // Clients.Client_Fax
39928>>>>>>>>>
39928>>>>>>>>>        // Clients.Client_Mobile
39928>>>>>>>>>
39928>>>>>>>>>        // Clients.Client_Aoh
39928>>>>>>>>>
39928>>>>>>>>>        // Clients.Client_Email
39928>>>>>>>>>
39928>>>>>>>>>        // Clients.Client_Class
39928>>>>>>>>>
39928>>>>>>>>>        // Clients.Client_Details
39928>>>>>>>>>
39928>>>>>>>>>        // Clients.Client_Sitew
39928>>>>>>>>>
39928>>>>>>>>>        // Clients.Client_Codem
39928>>>>>>>>>
39928>>>>>>>>>        // Clients.Client_Categfpa
39928>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Categfpa To (Clients_Client_Categfpa_VT(Self))
39929>>>>>>>>>
39929>>>>>>>>>        // Clients.Client_Fpa
39929>>>>>>>>>
39929>>>>>>>>>        // Clients.Client_Public
39929>>>>>>>>>
39929>>>>>>>>>        // Clients.Client_Sn
39929>>>>>>>>>
39929>>>>>>>>>        // Clients.Client_Repm
39929>>>>>>>>>
39929>>>>>>>>>        // Clients.Client_Active
39929>>>>>>>>>
39929>>>>>>>>>        // Clients.Client_Reported
39929>>>>>>>>>
39929>>>>>>>>>        // Clients.Client_Pelprom
39929>>>>>>>>>
39929>>>>>>>>>        // Clients.Client_Lastupd
39929>>>>>>>>>
39929>>>>>>>>>        // Clients.Client_Markexp
39929>>>>>>>>>
39929>>>>>>>>>        // Clients.Client_Catjob
39929>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Catjob To (Clients_Client_Catjob_VT1(Self))
39930>>>>>>>>>
39930>>>>>>>>>        // Clients.Is_Promhtheyths
39930>>>>>>>>>
39930>>>>>>>>>        // Clients.Xreosh
39930>>>>>>>>>
39930>>>>>>>>>        // Clients.Pistosh
39930>>>>>>>>>
39930>>>>>>>>>        // Clients.Ypoloipo
39930>>>>>>>>>
39930>>>>>>>>>        // Clients.Plafon
39930>>>>>>>>>
39930>>>>>>>>>        // Clients.Overhead
39930>>>>>>>>>
39930>>>>>>>>>        // Clients.Client_Company
39930>>>>>>>>>
39930>>>>>>>>>        // Clients.Client_Repmatch
39930>>>>>>>>>
39930>>>>>>>>>        // Clients.Client_Hmnia
39930>>>>>>>>>
39930>>>>>>>>>        // Clients.Client_Presp
39930>>>>>>>>>
39930>>>>>>>>>        // Clients.Client_Locked
39930>>>>>>>>>
39930>>>>>>>>>        // Clients.Synolikh_Ofeilh
39930>>>>>>>>>
39930>>>>>>>>>        // Clients.Client_Idiot
39930>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Idiot To (Clients_Client_Idiot_VT(Self))
39931>>>>>>>>>
39931>>>>>>>>>        // Clients.Client_Add_No
39931>>>>>>>>>
39931>>>>>>>>>        // Clients.Client_Nomos
39931>>>>>>>>>
39931>>>>>>>>>        // Clients.Client_Xora
39931>>>>>>>>>
39931>>>>>>>>>        // Clients.Polh_Recr
39931>>>>>>>>>        Set Field_Prompt_Object    Field Clients.Polh_Recr To (slPayTerms(Self))
39932>>>>>>>>>
39932>>>>>>>>>        // Clients.Presp_Id
39932>>>>>>>>>
39932>>>>>>>>>        // Clients.Sum_Pct_Tpcl
39932>>>>>>>>>
39932>>>>>>>>>        // Clients.Is_Client
39932>>>>>>>>>
39932>>>>>>>>>        // Clients.Sysxetish
39932>>>>>>>>>
39932>>>>>>>>>        // Clients.Poso_Se_Apait
39932>>>>>>>>>
39932>>>>>>>>>        // Clients.Client_Glcode
39932>>>>>>>>>
39932>>>>>>>>>        // Clients.Is_Eksoter
39932>>>>>>>>>
39932>>>>>>>>>        // Clients.Is_Xondr
39932>>>>>>>>>
39932>>>>>>>>>        // Clients.Orio_Syn_Ofeilh
39932>>>>>>>>>
39932>>>>>>>>>        // Clients.Posa_Apo_Dap
39932>>>>>>>>>
39932>>>>>>>>>        // Clients.Client_Doybtm
39932>>>>>>>>>
39932>>>>>>>>>        // Clients.Posa_Apo_Parag
39932>>>>>>>>>
39932>>>>>>>>>        // Clients.Client_Ptyppar
39932>>>>>>>>>
39932>>>>>>>>>        // Clients.Client_Seira
39932>>>>>>>>>
39932>>>>>>>>>        // Clients.Hpso
39932>>>>>>>>>
39932>>>>>>>>>        // Clients.Hpal
39932>>>>>>>>>
39932>>>>>>>>>        // Clients.Feregios
39932>>>>>>>>>        Set Field_Value_Table      Field Clients.Feregios To (Clients_Feregios_VT(Self))
39933>>>>>>>>>
39933>>>>>>>>>        // Clients.Diakin
39933>>>>>>>>>
39933>>>>>>>>>        // Clients.Status
39933>>>>>>>>>
39933>>>>>>>>>        // Clients.Anal
39933>>>>>>>>>
39933>>>>>>>>>        // Clients.Endoomil
39933>>>>>>>>>
39933>>>>>>>>>        // Clients.Npdd
39933>>>>>>>>>
39933>>>>>>>>>        // Clients.Sap_Hmnia
39933>>>>>>>>>
39933>>>>>>>>>        //DDB-DefineFieldEnd
39933>>>>>>>>>    End_Procedure    // Define_Fields
39934>>>>>>>>>
39934>>>>>>>>>    // Field_Defaults:
39934>>>>>>>>>    // This procedure is used to establish default field values.
39934>>>>>>>>>
39934>>>>>>>>>    Procedure Field_Defaults
39935>>>>>>>>>        Forward Send Field_Defaults
39937>>>>>>>>>        //DDB-Generated-Code-Location
39937>>>>>>>>>        //DDB-FieldDefaultStart
39937>>>>>>>>>        Set Field_Changed_Value   Field Clients.Client_Doy To "0"
39938>>>>>>>>>        //DDB-FieldDefaultEnd
39938>>>>>>>>>    End_Procedure    // Field_Defaults
39939>>>>>>>>>
39939>>>>>>>>>End_Class    // Clients_DataDictionary
39940>>>>>>>>>//DDB-Selection-pkg-Start
39940>>>>>>>>>
39940>>>>>>>>>Use sl100.SL         // sl100
39940>>>>>>>>>Use slPayTerms.SL    // slPayTerms
INCLUDING FILE: SLPAYTERMS.SL
39940>>>>>>>>>>>//AB/ Project slPayTerms
39940>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
39940>>>>>>>>>>>//AB/     Set ProjectName to "slPayTerms"
39940>>>>>>>>>>>//AB/     Set ProjectFileName to "slPayTerms.SL"
39940>>>>>>>>>>>
39940>>>>>>>>>>>// Project Object Structure
39940>>>>>>>>>>>//   slPayTerms is a dbModalPanelSub
39940>>>>>>>>>>>//     PayTerms_DD is a DataDictionary
39940>>>>>>>>>>>//     oSelList is a dbListSub
39940>>>>>>>>>>>//     oOK_bn is a ButtonSub
39940>>>>>>>>>>>//     oCancel_bn is a ButtonSub
39940>>>>>>>>>>>//     oSearch_bn is a ButtonSub
39940>>>>>>>>>>>
39940>>>>>>>>>>>// Register all objects
39940>>>>>>>>>>>Register_Object oCancel_bn
39940>>>>>>>>>>>Register_Object oOK_bn
39940>>>>>>>>>>>Register_Object oSearch_bn
39940>>>>>>>>>>>Register_Object oSelList
39940>>>>>>>>>>>Register_Object PayTerms_DD
39940>>>>>>>>>>>Register_Object slPayTerms
39940>>>>>>>>>>>
39940>>>>>>>>>>>
39940>>>>>>>>>>>//AB-IgnoreStart
39940>>>>>>>>>>>
39940>>>>>>>>>>>Use DFAllEnt.pkg
39940>>>>>>>>>>>Use dbList.Sub
39940>>>>>>>>>>>Use Button.Sub
39940>>>>>>>>>>>
39940>>>>>>>>>>>
39940>>>>>>>>>>>Use PAYTERMS.DD
INCLUDING FILE: PAYTERMS.DD
39940>>>>>>>>>>>>>//DDB-FileStart
39940>>>>>>>>>>>>>//DDB-HeaderStart
39940>>>>>>>>>>>>>
39940>>>>>>>>>>>>>// File Name : PAYTERMS.DD
39940>>>>>>>>>>>>>// Class Name: Payterms_DataDictionary
39940>>>>>>>>>>>>>// Revision  : 2
39940>>>>>>>>>>>>>// Version   : 2
39940>>>>>>>>>>>>>
39940>>>>>>>>>>>>>Use  Windows           // Basic Definitions
39940>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
39940>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39940>>>>>>>>>>>>>
39940>>>>>>>>>>>>>Open Payterms
INCLUDING FILE: PAYTERMS.FD
39942>>>>>>>>>>>>>
39942>>>>>>>>>>>>>//DDB-HeaderEnd
39942>>>>>>>>>>>>>//DDB-SelectionStart
39942>>>>>>>>>>>>>//DDB/ ExternalSelectionList slPayTerms  slPayTerms.SL
39942>>>>>>>>>>>>>Register_Object slPayTerms
39942>>>>>>>>>>>>>//DDB-SelectionEnd
39942>>>>>>>>>>>>>
39942>>>>>>>>>>>>>Class Payterms_DataDictionary  is a DataDictionary_sec
39943>>>>>>>>>>>>>
39943>>>>>>>>>>>>>    // Define_Fields:
39943>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39943>>>>>>>>>>>>>
39943>>>>>>>>>>>>>    Procedure Define_Fields
39944>>>>>>>>>>>>>        Forward Send Define_Fields
39946>>>>>>>>>>>>>        //DDB-Generated-Code-Location
39946>>>>>>>>>>>>>        //DDB-DefineFieldStart
39946>>>>>>>>>>>>>
39946>>>>>>>>>>>>>        Set Main_File            To Payterms.File_Number
39947>>>>>>>>>>>>>
39947>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39948>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39949>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39950>>>>>>>>>>>>>
39950>>>>>>>>>>>>>        // Field-based properties.......................
39950>>>>>>>>>>>>>
39950>>>>>>>>>>>>>        // Payterms.Payterms_Code
39950>>>>>>>>>>>>>        Set Field_Options          Field Payterms.Payterms_Code To DD_AUTOFIND   
39951>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Payterms.Payterms_Code To (slPayTerms(Self))
39952>>>>>>>>>>>>>
39952>>>>>>>>>>>>>        // Payterms.Payterms_Descr
39952>>>>>>>>>>>>>
39952>>>>>>>>>>>>>        // Payterms.Old_Description
39952>>>>>>>>>>>>>
39952>>>>>>>>>>>>>        //DDB-DefineFieldEnd
39952>>>>>>>>>>>>>    End_Procedure    // Define_Fields
39953>>>>>>>>>>>>>
39953>>>>>>>>>>>>>    // Field_Defaults:
39953>>>>>>>>>>>>>    // This procedure is used to establish default field values.
39953>>>>>>>>>>>>>
39953>>>>>>>>>>>>>    Procedure Field_Defaults
39954>>>>>>>>>>>>>        Forward Send Field_Defaults
39956>>>>>>>>>>>>>        //DDB-Generated-Code-Location
39956>>>>>>>>>>>>>        //DDB-FieldDefaultStart
39956>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
39956>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
39957>>>>>>>>>>>>>
39957>>>>>>>>>>>>>End_Class    // Payterms_DataDictionary
39958>>>>>>>>>>>>>//DDB-Selection-pkg-Start
39958>>>>>>>>>>>>>
39958>>>>>>>>>>>>>Use slPayTerms.SL    // slPayTerms
39958>>>>>>>>>>>>>
39958>>>>>>>>>>>>>//DDB-Selection-pkg-End
39958>>>>>>>>>>>>>//DDB-FileEnd
39958>>>>>>>>>>>
39958>>>>>>>>>>>//AB-IgnoreEnd
39958>>>>>>>>>>>
39958>>>>>>>>>>>Object slPayTerms is a dbModalPanelSub
39960>>>>>>>>>>>    Set Label to "î¨¦  ¢ž¨à£ãª"
39961>>>>>>>>>>>    Set Size to 223 461
39962>>>>>>>>>>>    Set Location to 7 15
39963>>>>>>>>>>>
39963>>>>>>>>>>>    //AB-DDOStart
39963>>>>>>>>>>>
39963>>>>>>>>>>>    Object PayTerms_DD is a Payterms_DataDictionary
39965>>>>>>>>>>>    End_Object    // PayTerms_DD
39966>>>>>>>>>>>
39966>>>>>>>>>>>    Set Main_DD to (PayTerms_DD(self))
39967>>>>>>>>>>>    Set Server to (PayTerms_DD(self))
39968>>>>>>>>>>>
39968>>>>>>>>>>>    //AB-DDOEnd
39968>>>>>>>>>>>
39968>>>>>>>>>>>    Object oSelList is a dbListSub
39970>>>>>>>>>>>        Set Main_File to Payterms.File_Number
39971>>>>>>>>>>>        Set Size to 181 445
39972>>>>>>>>>>>        Set Location to 6 6
39973>>>>>>>>>>>        Set Auto_Server_State to TRUE
39974>>>>>>>>>>>
39974>>>>>>>>>>>        Begin_Row
39977>>>>>>>>>>>            Entry_Item Payterms.Payterms_code
39978>>>>>>>>>>>            Entry_Item Payterms.Payterms_descr
39979>>>>>>>>>>>            Entry_Item Payterms.Old_description
39980>>>>>>>>>>>        End_Row
39985>>>>>>>>>>>
39985>>>>>>>>>>>        Set Form_Width    item 0 to 67
39986>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
39987>>>>>>>>>>>        
39987>>>>>>>>>>>        Set Form_Width    item 1 to 209
39988>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
39989>>>>>>>>>>>        
39989>>>>>>>>>>>        Set Form_Width    item 2 to 163
39990>>>>>>>>>>>        Set Header_Label  item 2 to "˜¢˜ á œ¨ š¨˜­ã"
39991>>>>>>>>>>>        
39991>>>>>>>>>>>    End_Object    // oSelList
39992>>>>>>>>>>>
39992>>>>>>>>>>>    Object oOK_bn is a ButtonSub
39994>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
39995>>>>>>>>>>>        Set Location to 191 293
39996>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
39997>>>>>>>>>>>
39997>>>>>>>>>>>        //AB-StoreStart
39997>>>>>>>>>>>        Procedure OnClick
39999>>>>>>>>>>>            Send OK To (oSelList(current_object))
40000>>>>>>>>>>>        End_Procedure
40001>>>>>>>>>>>        //AB-StoreEnd
40001>>>>>>>>>>>
40001>>>>>>>>>>>    End_Object    // oOK_bn
40002>>>>>>>>>>>
40002>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
40004>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
40005>>>>>>>>>>>        Set Location to 191 347
40006>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
40007>>>>>>>>>>>
40007>>>>>>>>>>>        //AB-StoreStart
40007>>>>>>>>>>>        Procedure OnClick
40009>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
40010>>>>>>>>>>>        End_Procedure
40011>>>>>>>>>>>        //AB-StoreEnd
40011>>>>>>>>>>>
40011>>>>>>>>>>>    End_Object    // oCancel_bn
40012>>>>>>>>>>>
40012>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
40014>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
40015>>>>>>>>>>>        Set Location to 191 403
40016>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
40017>>>>>>>>>>>
40017>>>>>>>>>>>        //AB-StoreStart
40017>>>>>>>>>>>        Procedure OnClick
40019>>>>>>>>>>>            Send Search To (oSelList(current_object))
40020>>>>>>>>>>>        End_Procedure
40021>>>>>>>>>>>        //AB-StoreEnd
40021>>>>>>>>>>>
40021>>>>>>>>>>>    End_Object    // oSearch_bn
40022>>>>>>>>>>>
40022>>>>>>>>>>>
40022>>>>>>>>>>>    //AB-StoreStart
40022>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
40023>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
40024>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
40025>>>>>>>>>>>    //AB-StoreEnd
40025>>>>>>>>>>>
40025>>>>>>>>>>>End_Object    // slPayTerms
40026>>>>>>>>>>>
40026>>>>>>>>>>>//AB/ End_Object    // prj
40026>>>>>>>>>
40026>>>>>>>>>//DDB-Selection-pkg-End
40026>>>>>>>>>//DDB-FileEnd
40026>>>>>>>    
40026>>>>>>>    //AB-IgnoreEnd
40026>>>>>>>
40026>>>>>>>    Object sl100 is a dbModalPanelSub
40028>>>>>>>
40028>>>>>>>        //AB-StoreTopStart
40028>>>>>>>                
40028>>>>>>>        Property String     FragmaClient        Public ''
40030>>>>>>>        Property String     psIsPromhtheyths    Public ''
40032>>>>>>>        Property Integer    piMustConstrain     Public  0
40034>>>>>>>        Property String     psModule            Public ''
40036>>>>>>>        
40036>>>>>>>        //AB-StoreTopEnd
40036>>>>>>>
40036>>>>>>>        Set Label to "(Xlate(Label(Self)))"
40037>>>>>>>        Set Size to 252 509
40038>>>>>>>        Set Location to 4 5
40039>>>>>>>
40039>>>>>>>        //AB-DDOStart
40039>>>>>>>
40039>>>>>>>        Object Clients_DD is a Clients_DataDictionary
40041>>>>>>>
40041>>>>>>>            //AB-StoreTopStart
40041>>>>>>>                                                        
40041>>>>>>>            //AB-StoreTopEnd
40041>>>>>>>
40041>>>>>>>
40041>>>>>>>            //AB-StoreStart
40041>>>>>>>                                                        
40041>>>>>>>            Begin_Constraints
40043>>>>>>>                     If (psModule(Self)='01') BEGIN
40045>>>>>>>                        Constrain Clients.is_Client        Eq '1'
40047>>>>>>>                     end
40047>>>>>>>>
40047>>>>>>>                     Else If (psModule(Self)='02') begin
40050>>>>>>>                        Constrain Clients.is_Promhtheyths  Eq '1'
40052>>>>>>>                     end
40052>>>>>>>>
40052>>>>>>>            End_Constraints
40055>>>>>>>            
40055>>>>>>>            
40055>>>>>>>            
40055>>>>>>>            
40055>>>>>>>            
40055>>>>>>>            //AB-StoreEnd
40055>>>>>>>
40055>>>>>>>        End_Object    // Clients_DD
40056>>>>>>>
40056>>>>>>>        Set Main_DD to (Clients_DD(self))
40057>>>>>>>        Set Server to (Clients_DD(self))
40058>>>>>>>
40058>>>>>>>        //AB-DDOEnd
40058>>>>>>>
40058>>>>>>>        Object oSelList is a dbListSub
40060>>>>>>>            Set Main_File to Clients.File_Number
40061>>>>>>>            Set Size to 204 496
40062>>>>>>>            Set Location to 7 5
40063>>>>>>>            Set Auto_Index_State to FALSE
40064>>>>>>>
40064>>>>>>>            Begin_Row
40067>>>>>>>                Entry_Item Clients.Client_id
40068>>>>>>>                Entry_Item Clients.Client_name
40069>>>>>>>                Entry_Item Clients.Client_afm
40070>>>>>>>                Entry_Item Clients.Last_xreosh
40071>>>>>>>                Entry_Item Clients.Last_pistosh
40072>>>>>>>                Entry_Item Clients.Client_codem
40073>>>>>>>                Entry_Item Clients.Is_client
40074>>>>>>>                Entry_Item Clients.Is_promhtheyths
40075>>>>>>>            End_Row
40080>>>>>>>
40080>>>>>>>            Set Form_Width    item 0 to 64
40081>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
40082>>>>>>>            
40082>>>>>>>            Set Form_Width    item 1 to 133
40083>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
40084>>>>>>>            
40084>>>>>>>            Set Form_Width    item 2 to 62
40085>>>>>>>            Set Header_Label  item 2 to "€”‹"
40086>>>>>>>            
40086>>>>>>>            Set Form_Width    item 3 to 60
40087>>>>>>>            Set Header_Label  item 3 to "’œ¢. •¨âà©ž"
40088>>>>>>>            
40088>>>>>>>            Set Form_Width    item 4 to 60
40089>>>>>>>            Set Header_Label  item 4 to "’œ¢. å©«à©ž"
40090>>>>>>>            
40090>>>>>>>            Set Form_Width    item 5 to 59
40091>>>>>>>            Set Header_Label  item 5 to "‰à›.‘ç¤›œ©žª"
40092>>>>>>>            
40092>>>>>>>            Set Form_Width    item 6 to 26
40093>>>>>>>            Set Header_Label  item 6 to "œ¢"
40094>>>>>>>            Set Column_Checkbox_State  item 6 to True
40095>>>>>>>            
40095>>>>>>>            Set Form_Width    item 7 to 26
40096>>>>>>>            Set Header_Label  item 7 to "¨¦£"
40097>>>>>>>            Set Column_Checkbox_State  item 7 to True
40098>>>>>>>            
40098>>>>>>>
40098>>>>>>>            //AB-StoreStart
40098>>>>>>>                                                                                
40098>>>>>>>            //Property String StoreFragmaClient   Public ''
40098>>>>>>>            //Property String StorePsModule       Public ''
40098>>>>>>>            
40098>>>>>>>            //Procedure Store_Defaults
40098>>>>>>>            //    Forward Send Store_Defaults
40098>>>>>>>            //    Set StoreFragmaClient   to (FragmaClient(Self))
40098>>>>>>>            //    Set StorePsModule       to (psModule    (Self))
40098>>>>>>>            //End_Procedure
40098>>>>>>>            
40098>>>>>>>            //Procedure ReStore_Defaults
40098>>>>>>>            //    Forward Send ReStore_Defaults
40098>>>>>>>            //    Set FragmaClient to (StoreFragmaClient(Self))
40098>>>>>>>            //    Set psModule     to (StorePsModule    (Self))
40098>>>>>>>            //End_Procedure
40098>>>>>>>            
40098>>>>>>>            Set Column_Option Item 6 to NoEnter True
40099>>>>>>>            Set Column_Option Item 7 to NoEnter True
40100>>>>>>>            
40100>>>>>>>            Procedure Activating
40102>>>>>>>                Forward Send Activating
40104>>>>>>>                Set Auto_Index_State to True
40105>>>>>>>            End_Procedure
40106>>>>>>>            
40106>>>>>>>            Procedure Activate
40108>>>>>>>                Send Rebuild_Constraints    to Clients_DD
40109>>>>>>>                If (FragmaClient(Self)<>'') Begin
40111>>>>>>>                    Clear Clients
40112>>>>>>>                    Move (FragmaClient(Self)) to Clients.Client_ID
40113>>>>>>>                    Find Eq Clients By Index.6
40114>>>>>>>>
40114>>>>>>>                    If (Found) Send Request_Find to Clients_DD Eq Clients.File_Number 6
40117>>>>>>>                End
40117>>>>>>>>
40117>>>>>>>                Forward Send Activate
40119>>>>>>>            End_procedure
40120>>>>>>>            
40120>>>>>>>            
40120>>>>>>>            
40120>>>>>>>            
40120>>>>>>>            //AB-StoreEnd
40120>>>>>>>
40120>>>>>>>        End_Object    // oSelList
40121>>>>>>>
40121>>>>>>>        Object oOK_bn is a ButtonSub
40123>>>>>>>            Set Label to "&„§ ¢¦šã"
40124>>>>>>>            Set Location to 218 341
40125>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
40126>>>>>>>
40126>>>>>>>            //AB-StoreStart
40126>>>>>>>            Procedure OnClick
40128>>>>>>>                Send OK To (oSelList(current_object))
40129>>>>>>>            End_Procedure
40130>>>>>>>            //AB-StoreEnd
40130>>>>>>>
40130>>>>>>>        End_Object    // oOK_bn
40131>>>>>>>
40131>>>>>>>        Object oCancel_bn is a ButtonSub
40133>>>>>>>            Set Label to "&€¡ç¨à©ž"
40134>>>>>>>            Set Location to 218 396
40135>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
40136>>>>>>>
40136>>>>>>>            //AB-StoreStart
40136>>>>>>>            Procedure OnClick
40138>>>>>>>                Send Cancel To (oSelList(current_object))
40139>>>>>>>            End_Procedure
40140>>>>>>>            //AB-StoreEnd
40140>>>>>>>
40140>>>>>>>        End_Object    // oCancel_bn
40141>>>>>>>
40141>>>>>>>        Object oSearch_bn is a ButtonSub
40143>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
40144>>>>>>>            Set Location to 218 451
40145>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
40146>>>>>>>
40146>>>>>>>            //AB-StoreStart
40146>>>>>>>            Procedure OnClick
40148>>>>>>>                Send Search To (oSelList(current_object))
40149>>>>>>>            End_Procedure
40150>>>>>>>            //AB-StoreEnd
40150>>>>>>>
40150>>>>>>>        End_Object    // oSearch_bn
40151>>>>>>>
40151>>>>>>>
40151>>>>>>>        //AB-StoreStart
40151>>>>>>>                
40151>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
40152>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
40153>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
40154>>>>>>>        
40154>>>>>>>        Set Modal_State to True
40155>>>>>>>        Set Locate_Mode to Center_On_Screen
40156>>>>>>>        
40156>>>>>>>        
40156>>>>>>>        Procedure Activating Returns Integer
40158>>>>>>>            Integer rVal
40159>>>>>>>            Forward Get Msg_Activating to rVal
40161>>>>>>>                 if (psmodule(self)='01') set label of sl100 to '‰˜«á¢¦š¦ª œ¢˜«é¤'
40164>>>>>>>            else if (psmodule(self)='02') set label of sl100 to '‰˜«á¢¦š¦ª ¨¦£žŸœ¬«é¤'
40168>>>>>>>            Procedure_Return rVal
40169>>>>>>>        End_procedure
40170>>>>>>>        
40170>>>>>>>        
40170>>>>>>>        
40170>>>>>>>        
40170>>>>>>>        
40170>>>>>>>        
40170>>>>>>>        
40170>>>>>>>        
40170>>>>>>>        
40170>>>>>>>        //AB-StoreEnd
40170>>>>>>>
40170>>>>>>>    End_Object    // sl100
40171>>>>>>>
40171>>>>>>>//AB/     End_Object    // prj
40171>>>>>
40171>>>>>
40171>>>>>//AB-StoreTopEnd
40171>>>>>
40171>>>>>//AB-IgnoreStart
40171>>>>>
40171>>>>>Use DFAllEnt.pkg
40171>>>>>Use dbList.Sub
40171>>>>>Use Txtbox.Sub
40171>>>>>Use cSyDateForm.Pkg
INCLUDING FILE: CSYDATEFORM.PKG
40171>>>>>>>Use cSyDateIntelliMix.pkg
INCLUDING FILE: CSYDATEINTELLIMIX.PKG
40171>>>>>>>>>Use cOutlook.Sl // Needed for date prompt.
INCLUDING FILE: COUTLOOK.SL
40171>>>>>>>>>>>//AB/ Project Calendar Outlook
40171>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
40171>>>>>>>>>>>//AB/         Set ProjectName to "Calendar Outlook"
40171>>>>>>>>>>>//AB/         Set ProjectFileName to "coutlook.sl"
40171>>>>>>>>>>>
40171>>>>>>>>>>>// Project Object Structure
40171>>>>>>>>>>>//   oCalendar is a BasicPanelSub
40171>>>>>>>>>>>//     Container3d1 is a Container3d
40171>>>>>>>>>>>//       Grid2 is a Grid
40171>>>>>>>>>>>//         cOutlookFloatingMenu is a FloatingPopupMenu
40171>>>>>>>>>>>//       Textbox2 is a Textbox
40171>>>>>>>>>>>//       Textbox3 is a Textbox
40171>>>>>>>>>>>//       Textbox4 is a Textbox
40171>>>>>>>>>>>//       Textbox5 is a Textbox
40171>>>>>>>>>>>//       Textbox6 is a Textbox
40171>>>>>>>>>>>//       Textbox7 is a Textbox
40171>>>>>>>>>>>//       Textbox8 is a Textbox
40171>>>>>>>>>>>//       LineControl1 is a LineControl
40171>>>>>>>>>>>//       Container3d2 is a Container3d
40171>>>>>>>>>>>//         oRght is a BitmapContainer
40171>>>>>>>>>>>//         oLeft is a BitmapContainer
40171>>>>>>>>>>>//         oMonth is a Textbox
40171>>>>>>>>>>>//           oSelectMonth is a FloatingPopupMenu
40171>>>>>>>>>>>//         oCalendarYear is a Textbox
40171>>>>>>>>>>>//         oSelectCalendarYear is a Form
40171>>>>>>>>>>>//     BitmapContainer3 is a BitmapContainer
40171>>>>>>>>>>>//     oToday is a Textbox
40171>>>>>>>>>>>//     oCloseCalendar_bn is a BitmapContainer
40171>>>>>>>>>>>//     Help_Container is a Container3d
40171>>>>>>>>>>>//       Help_Info is a Edit
40171>>>>>>>>>>>//         HelpFloatingMenu is a FloatingPopupMenu
40171>>>>>>>>>>>
40171>>>>>>>>>>>// Register all objects
40171>>>>>>>>>>>Register_Object BitmapContainer3
40171>>>>>>>>>>>Register_Object Container3d1
40171>>>>>>>>>>>Register_Object Container3d2
40171>>>>>>>>>>>Register_Object cOutlookFloatingMenu
40171>>>>>>>>>>>Register_Object Grid2
40171>>>>>>>>>>>Register_Object Help_Container
40171>>>>>>>>>>>Register_Object Help_Info
40171>>>>>>>>>>>Register_Object HelpFloatingMenu
40171>>>>>>>>>>>Register_Object LineControl1
40171>>>>>>>>>>>Register_Object oCalendar
40171>>>>>>>>>>>Register_Object oCalendarYear
40171>>>>>>>>>>>Register_Object oCloseCalendar_bn
40171>>>>>>>>>>>Register_Object oLeft
40171>>>>>>>>>>>Register_Object oMonth
40171>>>>>>>>>>>Register_Object oRght
40171>>>>>>>>>>>Register_Object oSelectCalendarYear
40171>>>>>>>>>>>Register_Object oSelectMonth
40171>>>>>>>>>>>Register_Object oToday
40171>>>>>>>>>>>Register_Object Textbox2
40171>>>>>>>>>>>Register_Object Textbox3
40171>>>>>>>>>>>Register_Object Textbox4
40171>>>>>>>>>>>Register_Object Textbox5
40171>>>>>>>>>>>Register_Object Textbox6
40171>>>>>>>>>>>Register_Object Textbox7
40171>>>>>>>>>>>Register_Object Textbox8
40171>>>>>>>>>>>
40171>>>>>>>>>>>
40171>>>>>>>>>>>
40171>>>>>>>>>>>    //AB-StoreTopStart
40171>>>>>>>>>>>    Use dates.utl
40171>>>>>>>>>>>
40171>>>>>>>>>>>
40171>>>>>>>>>>>    //AB-StoreTopEnd
40171>>>>>>>>>>>
40171>>>>>>>>>>>    //AB-IgnoreStart
40171>>>>>>>>>>>
40171>>>>>>>>>>>    Use Panel.Sub
40171>>>>>>>>>>>    Use DFAllEnt.pkg
40171>>>>>>>>>>>
40171>>>>>>>>>>>
40171>>>>>>>>>>>
40171>>>>>>>>>>>    //AB-IgnoreEnd
40171>>>>>>>>>>>
40171>>>>>>>>>>>    Object oCalendar is a BasicPanelSub
40173>>>>>>>>>>>        Set Border_Style to Border_Normal
40174>>>>>>>>>>>        Set Caption_Bar to FALSE
40175>>>>>>>>>>>        Set Label to "January, 2001"
40176>>>>>>>>>>>        Set Size to 98 123
40177>>>>>>>>>>>        Set Location to 10 22
40178>>>>>>>>>>>        Set Color to clWhite
40179>>>>>>>>>>>        Set Exit_Application_Local_State to TRUE
40180>>>>>>>>>>>        Set Popup_State to TRUE
40181>>>>>>>>>>>
40181>>>>>>>>>>>        //AB-DDOStart
40181>>>>>>>>>>>
40181>>>>>>>>>>>
40181>>>>>>>>>>>        //AB-DDOEnd
40181>>>>>>>>>>>
40181>>>>>>>>>>>        Object Container3d1 is a Container3d
40183>>>>>>>>>>>            Set Size to 88 135
40184>>>>>>>>>>>            Set Location to -2 -1
40185>>>>>>>>>>>            Set Color to clWhite
40186>>>>>>>>>>>            Set Border_Style to Border_None
40187>>>>>>>>>>>            Object Grid2 is a Grid
40189>>>>>>>>>>>
40189>>>>>>>>>>>                //AB-StoreTopStart
40189>>>>>>>>>>>                property date    p_current_date     0
40191>>>>>>>>>>>                property integer p_current_year     -1
40193>>>>>>>>>>>                property integer p_current_month    -1
40195>>>>>>>>>>>                property integer p_selected_day     -1
40197>>>>>>>>>>>                property integer pExportState       1
40199>>>>>>>>>>>                property integer invoking_object_id 0
40201>>>>>>>>>>>                Property integer piCurrentDayItem   -1
40203>>>>>>>>>>>
40203>>>>>>>>>>>                Set Border_Style To BORDER_NONE
40204>>>>>>>>>>>                Set header_visible_state To False
40205>>>>>>>>>>>                set select_mode to no_select
40206>>>>>>>>>>>                Set Gridline_mode To GRID_VISIBLE_NONE
40207>>>>>>>>>>>
40207>>>>>>>>>>>                on_key Key_F1 Send Help
40208>>>>>>>>>>>                on_key key_ctrl+key_pgup send prev_year
40209>>>>>>>>>>>                on_key key_ctrl+key_pgdn send next_year
40210>>>>>>>>>>>                on_key          key_pgup send prev_month
40211>>>>>>>>>>>                on_key          key_pgdn send next_month
40212>>>>>>>>>>>                on_key key_enter         send move_value_out
40213>>>>>>>>>>>                on_key key_ctrl+key_d    send go_today
40214>>>>>>>>>>>                on_key key_ctrl+key_y    send Change_Year
40215>>>>>>>>>>>
40215>>>>>>>>>>>                //AB-StoreTopEnd
40215>>>>>>>>>>>
40215>>>>>>>>>>>                Set Color to clWhite
40216>>>>>>>>>>>                Set CurrentCellColor to clWhite
40217>>>>>>>>>>>                Set CurrentCellTextColor to clWhite
40218>>>>>>>>>>>                Set Size to 61 145
40219>>>>>>>>>>>                Set Location to 30 1
40220>>>>>>>>>>>                Set Resize_Column_state to FALSE
40221>>>>>>>>>>>
40221>>>>>>>>>>>                Set Line_Width to 7 0
40222>>>>>>>>>>>
40222>>>>>>>>>>>                Set Form_Width    item 0 to 18
40223>>>>>>>>>>>                Set Header_Label  item 0 to "Mo"
40224>>>>>>>>>>>
40224>>>>>>>>>>>                Set Form_Width    item 1 to 18
40225>>>>>>>>>>>                Set Header_Label  item 1 to "Tu"
40226>>>>>>>>>>>
40226>>>>>>>>>>>                Set Form_Width    item 2 to 18
40227>>>>>>>>>>>                Set Header_Label  item 2 to "We"
40228>>>>>>>>>>>
40228>>>>>>>>>>>                Set Form_Width    item 3 to 18
40229>>>>>>>>>>>                Set Header_Label  item 3 to "Th"
40230>>>>>>>>>>>
40230>>>>>>>>>>>                Set Form_Width    item 4 to 18
40231>>>>>>>>>>>                Set Header_Label  item 4 to "Fr"
40232>>>>>>>>>>>
40232>>>>>>>>>>>                Set Form_Width    item 5 to 18
40233>>>>>>>>>>>                Set Header_Label  item 5 to "Sa"
40234>>>>>>>>>>>
40234>>>>>>>>>>>                Set Form_Width    item 6 to 18
40235>>>>>>>>>>>                Set Header_Label  item 6 to "Su"
40236>>>>>>>>>>>
40236>>>>>>>>>>>
40236>>>>>>>>>>>                //AB-StoreStart
40236>>>>>>>>>>>
40236>>>>>>>>>>>                Procedure Change_Year
40238>>>>>>>>>>>                    Send Mouse_Down to (oCalendarYear(Container3d2(Self)))
40239>>>>>>>>>>>                End_Procedure // Change_Year
40240>>>>>>>>>>>
40240>>>>>>>>>>>                procedure go_today
40242>>>>>>>>>>>                    Date date#
40243>>>>>>>>>>>                    sysdate4 date#
40244>>>>>>>>>>>                    set p_current_date to date#
40245>>>>>>>>>>>                    Send Update_Calendar
40246>>>>>>>>>>>                end_procedure
40247>>>>>>>>>>>
40247>>>>>>>>>>>                procedure next_month
40249>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
40250>>>>>>>>>>>                    Send Update_Calendar
40251>>>>>>>>>>>                end_procedure
40252>>>>>>>>>>>
40252>>>>>>>>>>>                procedure prev_month
40254>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
40255>>>>>>>>>>>                    Send Update_Calendar
40256>>>>>>>>>>>                end_procedure
40257>>>>>>>>>>>
40257>>>>>>>>>>>                procedure next_year
40259>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
40260>>>>>>>>>>>                    Send Update_Calendar
40261>>>>>>>>>>>                end_procedure
40262>>>>>>>>>>>
40262>>>>>>>>>>>                procedure prev_year
40264>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
40265>>>>>>>>>>>                    Send Update_Calendar
40266>>>>>>>>>>>                end_procedure
40267>>>>>>>>>>>
40267>>>>>>>>>>>                Procedure Activate
40269>>>>>>>>>>>                    Date date#
40270>>>>>>>>>>>                    Forward Send Activate
40272>>>>>>>>>>>                    Set current_item to (p_selected_day(Self))
40273>>>>>>>>>>>                End_Procedure
40274>>>>>>>>>>>
40274>>>>>>>>>>>                Procedure Update_Calendar
40276>>>>>>>>>>>                    Set Dynamic_Update_State To False
40277>>>>>>>>>>>                    send Fill_List
40278>>>>>>>>>>>                    Set Dynamic_Update_State To True
40279>>>>>>>>>>>                    // Send Update_Label
40279>>>>>>>>>>>                    Set current_item to (p_selected_day(Self))
40280>>>>>>>>>>>                    Send Date_Changing to (oCalendarYear(Container3d2(self)))
40281>>>>>>>>>>>                    Send Date_Changing to (oMonth(Container3d2(self)))
40282>>>>>>>>>>>                End_Procedure
40283>>>>>>>>>>>
40283>>>>>>>>>>>                Procedure Fill_List
40285>>>>>>>>>>>                    Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
40286>>>>>>>>>>>                    Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
40286>>>>>>>>>>>                    Date dToday
40286>>>>>>>>>>>                    Send Delete_Data
40287>>>>>>>>>>>
40287>>>>>>>>>>>                    Get p_current_date to date#
40288>>>>>>>>>>>
40288>>>>>>>>>>>                    SysDate4 dToday
40289>>>>>>>>>>>                    move (DateSegment(dToday,DS_DAY)) to cur_day#
40290>>>>>>>>>>>                    move (DateSegment(dToday,DS_MONTH)) to cur_month#
40291>>>>>>>>>>>                    move (DateSegment(dToday,DS_YEAR)) to cur_year#
40292>>>>>>>>>>>
40292>>>>>>>>>>>                    move (DateSegment(date#,DS_DAY)) to sel_day#
40293>>>>>>>>>>>                    move (DateSegment(date#,DS_MONTH)) to sel_month#
40294>>>>>>>>>>>                    move (DateSegment(date#,DS_YEAR)) to sel_year#
40295>>>>>>>>>>>                    Set p_current_month To sel_month#
40296>>>>>>>>>>>                    Set p_current_year To sel_year#
40297>>>>>>>>>>>
40297>>>>>>>>>>>                    move (FirstDayInMonth(date#)) to date#
40298>>>>>>>>>>>                    move (DateDayNumber(date#)-1) to first_item#
40299>>>>>>>>>>>                    move (LastDayInMonth(date#)-date#+first_item#) to last_item#
40300>>>>>>>>>>>                    move (DateIncrement(date#,DS_Month,-1)) To prevdate#
40301>>>>>>>>>>>                    move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
40302>>>>>>>>>>>
40302>>>>>>>>>>>                    If (first_item# > 0) Begin
40304>>>>>>>>>>>                        Move (first_item#-1) to day#
40305>>>>>>>>>>>                        For iFor from 0 to (first_item#-1)
40311>>>>>>>>>>>>
40311>>>>>>>>>>>                            Send Add_Item msg_move_value_out (prev_last#-day#)
40312>>>>>>>>>>>                            Set Entry_State Item iFor To False
40313>>>>>>>>>>>                            Set ItemTextColor Item iFor To clGray
40314>>>>>>>>>>>                            Decrement day#
40315>>>>>>>>>>>                        Loop
40316>>>>>>>>>>>>
40316>>>>>>>>>>>                    End
40316>>>>>>>>>>>>
40316>>>>>>>>>>>
40316>>>>>>>>>>>                    Move 1 To day#
40317>>>>>>>>>>>                    For iFor from first_item# to last_item#
40323>>>>>>>>>>>>
40323>>>>>>>>>>>                        Send Add_Item Msg_Move_Value_Out day#
40324>>>>>>>>>>>                        Set Entry_State Item iFor To False
40325>>>>>>>>>>>                        If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Begin
40327>>>>>>>>>>>                            Set Form_Bitmap Item iFor To "cdate.bmp"
40328>>>>>>>>>>>                            Set piCurrentDayItem to iFor
40329>>>>>>>>>>>                        End
40329>>>>>>>>>>>>
40329>>>>>>>>>>>                        If Day# eq sel_day# Set p_selected_day To iFor
40332>>>>>>>>>>>                        Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
40333>>>>>>>>>>>                        Set form_datatype item iFor To mask_numeric_window
40334>>>>>>>>>>>                        Set form_Mask item iFor To "## "
40335>>>>>>>>>>>                        Increment day#
40336>>>>>>>>>>>                    Loop
40337>>>>>>>>>>>>
40337>>>>>>>>>>>
40337>>>>>>>>>>>                    move (DateIncrement(date#,DS_Month,1)) To nextdate#
40338>>>>>>>>>>>                    move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
40339>>>>>>>>>>>
40339>>>>>>>>>>>                    If (last_item# < 41) Begin
40341>>>>>>>>>>>                        Move 1 to day#
40342>>>>>>>>>>>                        For iFor from (last_item#+1) to 41
40348>>>>>>>>>>>>
40348>>>>>>>>>>>                            Send Add_Item msg_move_value_out day#
40349>>>>>>>>>>>                            Set Entry_State Item iFor To False
40350>>>>>>>>>>>                            Set ItemTextColor Item iFor To clGray
40351>>>>>>>>>>>                            Increment day#
40352>>>>>>>>>>>                        Loop
40353>>>>>>>>>>>>
40353>>>>>>>>>>>                    End
40353>>>>>>>>>>>>
40353>>>>>>>>>>>
40353>>>>>>>>>>>                End_Procedure
40354>>>>>>>>>>>
40354>>>>>>>>>>>                Procedure Help
40356>>>>>>>>>>>                    //Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<Y> - select year.\n<Ctrl>+<PgUp>, <PgDn> - Select year.") ("Help on Calendar")
40356>>>>>>>>>>>                    Set Visible_State of Help_Container to True
40357>>>>>>>>>>>                    Set Enabled_State of Help_Container to True
40358>>>>>>>>>>>                    Send Activate to Help_Container
40359>>>>>>>>>>>                End_Procedure
40360>>>>>>>>>>>
40360>>>>>>>>>>>                procedure mouse_click integer window integer char_pos
40362>>>>>>>>>>>                    Send Move_Value_Out
40363>>>>>>>>>>>                    forward send mouse_click window char_pos
40365>>>>>>>>>>>                end_procedure
40366>>>>>>>>>>>
40366>>>>>>>>>>>                Procedure Move_Value_Out
40368>>>>>>>>>>>                    Integer iYear iMonth iDay iItm
40369>>>>>>>>>>>                    Date Date# next_date# prev_date#
40369>>>>>>>>>>>                    Get Current_Item To iItm
40370>>>>>>>>>>>                    If (pExportState(Self)) Begin
40372>>>>>>>>>>>                        Get Value Item iItm To iDay
40373>>>>>>>>>>>                        Get p_current_month to iMonth
40374>>>>>>>>>>>                        Get p_current_year  to iYear
40375>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
40376>>>>>>>>>>>
40376>>>>>>>>>>>                        If ((iItm>27)and(iDay<15)) Begin
40378>>>>>>>>>>>                            Move (DateCompose(1,iMonth,iYear)) To next_date#
40379>>>>>>>>>>>                            move (DateIncrement(next_date#,DS_Month,1)) To next_date#
40380>>>>>>>>>>>                            move (DateSegment(next_date#,DS_MONTH)) to iMonth
40381>>>>>>>>>>>                            move (DateSegment(next_date#,DS_YEAR)) to iYear
40382>>>>>>>>>>>                            move (DateCompose(iDay,iMonth,iYear)) to date#
40383>>>>>>>>>>>                        End
40383>>>>>>>>>>>>
40383>>>>>>>>>>>                        If ((iItm<7)and(iDay>20)) Begin
40385>>>>>>>>>>>                            Move (DateCompose(1,iMonth,iYear)) To prev_date#
40386>>>>>>>>>>>                            move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
40387>>>>>>>>>>>                            move (DateSegment(prev_date#,DS_MONTH)) to iMonth
40388>>>>>>>>>>>                            move (DateSegment(prev_date#,DS_YEAR)) to iYear
40389>>>>>>>>>>>                            move (DateCompose(iDay,iMonth,iYear)) to date#
40390>>>>>>>>>>>                        End
40390>>>>>>>>>>>>
40390>>>>>>>>>>>
40390>>>>>>>>>>>                        Send Export_Date date#
40391>>>>>>>>>>>                    End
40391>>>>>>>>>>>>
40391>>>>>>>>>>>                End_Procedure
40392>>>>>>>>>>>
40392>>>>>>>>>>>                Procedure Export_Date date date#
40394>>>>>>>>>>>                    local integer focus# dm# margin# datatype#
40395>>>>>>>>>>>                    get invoking_object_id to focus#
40396>>>>>>>>>>>
40396>>>>>>>>>>>                    if focus# gt desktop begin
40398>>>>>>>>>>>                         get delegation_mode of focus# to dm#
40399>>>>>>>>>>>                         set delegation_mode of focus# to no_delegate_or_error
40400>>>>>>>>>>>                         get form_margin of focus# item current to margin#
40401>>>>>>>>>>>                         get form_datatype of focus# item current to datatype#
40402>>>>>>>>>>>                         set delegation_mode of focus# to dm#
40403>>>>>>>>>>>                         if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
40406>>>>>>>>>>>                         else             set value of focus# item current to (Date4to2(date#))
40408>>>>>>>>>>>                         set item_changed_state of focus# item current to true
40409>>>>>>>>>>>                    end
40409>>>>>>>>>>>>
40409>>>>>>>>>>>                    Send Close_Calendar
40410>>>>>>>>>>>                End_Procedure
40411>>>>>>>>>>>
40411>>>>>>>>>>>                Object cOutlookFloatingMenu is a FloatingPopupMenu
40413>>>>>>>>>>>
40413>>>>>>>>>>>                    Procedure Close_Calendar
40415>>>>>>>>>>>                        Send Close_Calendar to (oCalendar(Self))
40416>>>>>>>>>>>                    End_Procedure // Close_Calendar
40417>>>>>>>>>>>
40417>>>>>>>>>>>                    Send Add_item msg_go_today         t.calendar.today
40418>>>>>>>>>>>                    Send Add_item msg_None             ""
40419>>>>>>>>>>>                    Send Add_Item msg_prev_year        t.calendar.PrevYear
40420>>>>>>>>>>>                    Send Add_Item msg_next_year        t.calendar.NextYear
40421>>>>>>>>>>>                    Send Add_Item msg_prev_month       t.calendar.PrevMonth
40422>>>>>>>>>>>                    Send Add_Item msg_next_month       t.calendar.NextMonth
40423>>>>>>>>>>>                    Send Add_item msg_None             ""
40424>>>>>>>>>>>                    Send Add_Item msg_move_value_out   t.calendar.Select
40425>>>>>>>>>>>                    Send Add_item msg_None             ""
40426>>>>>>>>>>>                    Send Add_item msg_Close_Calendar   t.calendar.Cancel
40427>>>>>>>>>>>                End_Object // cOutlookFloatingMenu
40428>>>>>>>>>>>
40428>>>>>>>>>>>                Set floating_menu_object to (cOutlookFloatingMenu(Self))
40429>>>>>>>>>>>
40429>>>>>>>>>>>                procedure item_change integer fromi integer toi returns integer
40431>>>>>>>>>>>                    Integer new_item liMonth
40432>>>>>>>>>>>                    Date    ldSysdate
40432>>>>>>>>>>>                    forward get msg_item_change fromi toi to new_item
40434>>>>>>>>>>>                    If (Focus(Desktop) = Self) Begin
40436>>>>>>>>>>>                        If (new_item >= 0) Begin
40438>>>>>>>>>>>                            Sysdate4 ldSysdate
40439>>>>>>>>>>>                            Move (TheMonthSegment(ldSysdate)) to liMonth
40440>>>>>>>>>>>                            If ((p_current_month(Self) = liMonth) and (piCurrentDayItem(Self) = fromi)) Set Form_Bitmap Item fromi to "Cdate.bmp"
40443>>>>>>>>>>>                            Else Set Form_Bitmap Item fromi to ""
40445>>>>>>>>>>>                            If (((p_current_month(Self) = liMonth) and (piCurrentDayItem(Self) <> new_item)) or;                                 (p_current_month(Self) <> liMonth)) Set Form_Bitmap Item new_item   to "Cdate1.bmp"
40448>>>>>>>>>>>                        End
40448>>>>>>>>>>>>
40448>>>>>>>>>>>                    End
40448>>>>>>>>>>>>
40448>>>>>>>>>>>                    procedure_return new_item
40449>>>>>>>>>>>                End_Procedure // Current_Item
40450>>>>>>>>>>>
40450>>>>>>>>>>>
40450>>>>>>>>>>>
40450>>>>>>>>>>>                //AB-StoreEnd
40450>>>>>>>>>>>
40450>>>>>>>>>>>            End_Object    // Grid2
40451>>>>>>>>>>>
40451>>>>>>>>>>>            Object Textbox2 is a Textbox
40453>>>>>>>>>>>                Set Label to "Mo"
40454>>>>>>>>>>>                Set Auto_Size_State to FALSE
40455>>>>>>>>>>>                Set Transparent_State to TRUE
40456>>>>>>>>>>>                Set Color to clWhite
40457>>>>>>>>>>>                Set TextColor to clNavy
40458>>>>>>>>>>>                Set Location to 19 4
40459>>>>>>>>>>>                Set Size to 10 15
40460>>>>>>>>>>>
40460>>>>>>>>>>>                //AB-StoreStart
40460>>>>>>>>>>>
40460>>>>>>>>>>>                Set Label To (left(t.calendar.Monday,2))
40461>>>>>>>>>>>                //AB-StoreEnd
40461>>>>>>>>>>>
40461>>>>>>>>>>>            End_Object    // Textbox2
40462>>>>>>>>>>>
40462>>>>>>>>>>>            Object Textbox3 is a Textbox
40464>>>>>>>>>>>                Set Label to "Tu"
40465>>>>>>>>>>>                Set Auto_Size_State to FALSE
40466>>>>>>>>>>>                Set Transparent_State to TRUE
40467>>>>>>>>>>>                Set Color to clWhite
40468>>>>>>>>>>>                Set TextColor to clNavy
40469>>>>>>>>>>>                Set Location to 19 22
40470>>>>>>>>>>>                Set Size to 10 12
40471>>>>>>>>>>>
40471>>>>>>>>>>>                //AB-StoreStart
40471>>>>>>>>>>>
40471>>>>>>>>>>>                Set Label To (left(t.calendar.Tuesday,2))
40472>>>>>>>>>>>                //AB-StoreEnd
40472>>>>>>>>>>>
40472>>>>>>>>>>>            End_Object    // Textbox3
40473>>>>>>>>>>>
40473>>>>>>>>>>>            Object Textbox4 is a Textbox
40475>>>>>>>>>>>                Set Label to "We"
40476>>>>>>>>>>>                Set Auto_Size_State to FALSE
40477>>>>>>>>>>>                Set Transparent_State to TRUE
40478>>>>>>>>>>>                Set Color to clWhite
40479>>>>>>>>>>>                Set TextColor to clNavy
40480>>>>>>>>>>>                Set Location to 19 39
40481>>>>>>>>>>>                Set Size to 10 15
40482>>>>>>>>>>>
40482>>>>>>>>>>>                //AB-StoreStart
40482>>>>>>>>>>>
40482>>>>>>>>>>>                Set Label To (left(t.calendar.Wednesday,2))
40483>>>>>>>>>>>                //AB-StoreEnd
40483>>>>>>>>>>>
40483>>>>>>>>>>>            End_Object    // Textbox4
40484>>>>>>>>>>>
40484>>>>>>>>>>>            Object Textbox5 is a Textbox
40486>>>>>>>>>>>                Set Label to "Th"
40487>>>>>>>>>>>                Set Auto_Size_State to FALSE
40488>>>>>>>>>>>                Set Transparent_State to TRUE
40489>>>>>>>>>>>                Set Color to clWhite
40490>>>>>>>>>>>                Set TextColor to clNavy
40491>>>>>>>>>>>                Set Location to 19 57
40492>>>>>>>>>>>                Set Size to 10 17
40493>>>>>>>>>>>
40493>>>>>>>>>>>                //AB-StoreStart
40493>>>>>>>>>>>
40493>>>>>>>>>>>                Set Label To (left(t.calendar.Thursday,2))
40494>>>>>>>>>>>                //AB-StoreEnd
40494>>>>>>>>>>>
40494>>>>>>>>>>>            End_Object    // Textbox5
40495>>>>>>>>>>>
40495>>>>>>>>>>>            Object Textbox6 is a Textbox
40497>>>>>>>>>>>                Set Label to "Fr"
40498>>>>>>>>>>>                Set Auto_Size_State to FALSE
40499>>>>>>>>>>>                Set Transparent_State to TRUE
40500>>>>>>>>>>>                Set Color to clWhite
40501>>>>>>>>>>>                Set TextColor to clNavy
40502>>>>>>>>>>>                Set Location to 19 76
40503>>>>>>>>>>>                Set Size to 10 17
40504>>>>>>>>>>>
40504>>>>>>>>>>>                //AB-StoreStart
40504>>>>>>>>>>>
40504>>>>>>>>>>>                Set Label To (left(t.calendar.Friday,2))
40505>>>>>>>>>>>                //AB-StoreEnd
40505>>>>>>>>>>>
40505>>>>>>>>>>>            End_Object    // Textbox6
40506>>>>>>>>>>>
40506>>>>>>>>>>>            Object Textbox7 is a Textbox
40508>>>>>>>>>>>                Set Label to "Sa"
40509>>>>>>>>>>>                Set Auto_Size_State to FALSE
40510>>>>>>>>>>>                Set Transparent_State to TRUE
40511>>>>>>>>>>>                Set Color to clWhite
40512>>>>>>>>>>>                Set TextColor to clNavy
40513>>>>>>>>>>>                Set Location to 19 91
40514>>>>>>>>>>>                Set Size to 10 18
40515>>>>>>>>>>>
40515>>>>>>>>>>>                //AB-StoreStart
40515>>>>>>>>>>>
40515>>>>>>>>>>>                Set Label To (left(t.calendar.Saturday,2))
40516>>>>>>>>>>>                //AB-StoreEnd
40516>>>>>>>>>>>
40516>>>>>>>>>>>            End_Object    // Textbox7
40517>>>>>>>>>>>
40517>>>>>>>>>>>            Object Textbox8 is a Textbox
40519>>>>>>>>>>>                Set Label to "Su"
40520>>>>>>>>>>>                Set Auto_Size_State to FALSE
40521>>>>>>>>>>>                Set Transparent_State to TRUE
40522>>>>>>>>>>>                Set Color to clWhite
40523>>>>>>>>>>>                Set TextColor to clNavy
40524>>>>>>>>>>>                Set Location to 19 109
40525>>>>>>>>>>>                Set Size to 10 17
40526>>>>>>>>>>>
40526>>>>>>>>>>>                //AB-StoreStart
40526>>>>>>>>>>>
40526>>>>>>>>>>>                Set Label To (left(t.calendar.Sunday,2))
40527>>>>>>>>>>>                //AB-StoreEnd
40527>>>>>>>>>>>
40527>>>>>>>>>>>            End_Object    // Textbox8
40528>>>>>>>>>>>
40528>>>>>>>>>>>            Object LineControl1 is a LineControl
40530>>>>>>>>>>>                Set Line_Style to lnSINGLE
40531>>>>>>>>>>>                Set Size to 1 116
40532>>>>>>>>>>>                Set Location to 28 4
40533>>>>>>>>>>>
40533>>>>>>>>>>>                //AB-StoreStart
40533>>>>>>>>>>>
40533>>>>>>>>>>>                //AB-StoreEnd
40533>>>>>>>>>>>
40533>>>>>>>>>>>            End_Object    // LineControl1
40534>>>>>>>>>>>
40534>>>>>>>>>>>            Object Container3d2 is a Container3d
40536>>>>>>>>>>>                Set Size to 18 131
40537>>>>>>>>>>>                Set Location to 1 1
40538>>>>>>>>>>>                Set Color to clNavy
40539>>>>>>>>>>>                Set Border_Style to Border_None
40540>>>>>>>>>>>                Object oRght is a BitmapContainer
40542>>>>>>>>>>>                    Set Size to 10 14
40543>>>>>>>>>>>                    Set Location to 4 105
40544>>>>>>>>>>>                    Set Bitmap to "rght.bmp"
40545>>>>>>>>>>>                    Set Border_Style to Border_None
40546>>>>>>>>>>>
40546>>>>>>>>>>>                    //AB-StoreStart
40546>>>>>>>>>>>                    Procedure Mouse_Down
40548>>>>>>>>>>>                        Send Next_Month to Grid2
40549>>>>>>>>>>>                    End_Procedure
40550>>>>>>>>>>>                    //AB-StoreEnd
40550>>>>>>>>>>>
40550>>>>>>>>>>>                End_Object    // oRght
40551>>>>>>>>>>>
40551>>>>>>>>>>>                Object oLeft is a BitmapContainer
40553>>>>>>>>>>>                    Set Size to 10 14
40554>>>>>>>>>>>                    Set Location to 4 3
40555>>>>>>>>>>>                    Set Bitmap to "lft.bmp"
40556>>>>>>>>>>>                    Set Border_Style to Border_None
40557>>>>>>>>>>>
40557>>>>>>>>>>>                    //AB-StoreStart
40557>>>>>>>>>>>                    Procedure Mouse_Down
40559>>>>>>>>>>>                        Send Prev_Month to Grid2
40560>>>>>>>>>>>                    End_Procedure
40561>>>>>>>>>>>                    //AB-StoreEnd
40561>>>>>>>>>>>
40561>>>>>>>>>>>                End_Object    // oLeft
40562>>>>>>>>>>>
40562>>>>>>>>>>>                Object oMonth is a Textbox
40564>>>>>>>>>>>
40564>>>>>>>>>>>                    //AB-StoreTopStart
40564>>>>>>>>>>>                    Property integer piSelected_Month public 0
40566>>>>>>>>>>>                    //AB-StoreTopEnd
40566>>>>>>>>>>>
40566>>>>>>>>>>>                    Set Label to "January"
40567>>>>>>>>>>>                    Set Auto_Size_State to FALSE
40568>>>>>>>>>>>                    Set Transparent_State to TRUE
40569>>>>>>>>>>>                    Set Color to clWhite
40570>>>>>>>>>>>                    Set TextColor to clWhite
40571>>>>>>>>>>>                    Set Location to 4 19
40572>>>>>>>>>>>                    Set Size to 10 46
40573>>>>>>>>>>>                    Set FontWeight to 800
40574>>>>>>>>>>>                    Set Justification_Mode to jMode_Center
40575>>>>>>>>>>>
40575>>>>>>>>>>>                    //AB-StoreStart
40575>>>>>>>>>>>
40575>>>>>>>>>>>                    Procedure Mouse_Down
40577>>>>>>>>>>>                        Integer iState
40578>>>>>>>>>>>                        Get Visible_State of oSelectCalendarYear to iState
40579>>>>>>>>>>>                        If (iState) Send OnKillFocus to oSelectCalendarYear
40582>>>>>>>>>>>                        Send Popup to oSelectMonth
40583>>>>>>>>>>>                    End_Procedure
40584>>>>>>>>>>>
40584>>>>>>>>>>>                    Procedure pSelectJan
40586>>>>>>>>>>>                        Set Label to t.calendar.january
40587>>>>>>>>>>>                        Set piSelected_Month to 1
40588>>>>>>>>>>>                        Send Adjust_Calendar
40589>>>>>>>>>>>                    End_Procedure
40590>>>>>>>>>>>                    Procedure pSelectFeb
40592>>>>>>>>>>>                        Set Label to t.calendar.february
40593>>>>>>>>>>>                        Set piSelected_Month to 2
40594>>>>>>>>>>>                        Send Adjust_Calendar
40595>>>>>>>>>>>                    End_Procedure
40596>>>>>>>>>>>                    Procedure pSelectMar
40598>>>>>>>>>>>                        Set Label to t.calendar.march
40599>>>>>>>>>>>                        Set piSelected_Month to 3
40600>>>>>>>>>>>                        Send Adjust_Calendar
40601>>>>>>>>>>>                    End_Procedure
40602>>>>>>>>>>>                    Procedure pSelectApr
40604>>>>>>>>>>>                        Set Label to t.calendar.april
40605>>>>>>>>>>>                        Set piSelected_Month to 4
40606>>>>>>>>>>>                        Send Adjust_Calendar
40607>>>>>>>>>>>                    End_Procedure
40608>>>>>>>>>>>                    Procedure pSelectMay
40610>>>>>>>>>>>                        Set Label to t.calendar.may
40611>>>>>>>>>>>                        Set piSelected_Month to 5
40612>>>>>>>>>>>                        Send Adjust_Calendar
40613>>>>>>>>>>>                    End_Procedure
40614>>>>>>>>>>>                    Procedure pSelectJun
40616>>>>>>>>>>>                        Set Label to t.calendar.june
40617>>>>>>>>>>>                        Set piSelected_Month to 6
40618>>>>>>>>>>>                        Send Adjust_Calendar
40619>>>>>>>>>>>                    End_Procedure
40620>>>>>>>>>>>                    Procedure pSelectJul
40622>>>>>>>>>>>                        Set Label to t.calendar.july
40623>>>>>>>>>>>                        Set piSelected_Month to 7
40624>>>>>>>>>>>                        Send Adjust_Calendar
40625>>>>>>>>>>>                    End_Procedure
40626>>>>>>>>>>>                    Procedure pSelectAug
40628>>>>>>>>>>>                        Set Label to t.calendar.august
40629>>>>>>>>>>>                        Set piSelected_Month to 8
40630>>>>>>>>>>>                        Send Adjust_Calendar
40631>>>>>>>>>>>                    End_Procedure
40632>>>>>>>>>>>                    Procedure pSelectSep
40634>>>>>>>>>>>                        Set Label to t.calendar.september
40635>>>>>>>>>>>                        Set piSelected_Month to 9
40636>>>>>>>>>>>                        Send Adjust_Calendar
40637>>>>>>>>>>>                    End_Procedure
40638>>>>>>>>>>>                    Procedure pSelectOct
40640>>>>>>>>>>>                        Set Label to t.calendar.october
40641>>>>>>>>>>>                        Set piSelected_Month to 10
40642>>>>>>>>>>>                        Send Adjust_Calendar
40643>>>>>>>>>>>                    End_Procedure
40644>>>>>>>>>>>                    Procedure pSelectNov
40646>>>>>>>>>>>                        Set Label to t.calendar.november
40647>>>>>>>>>>>                        Set piSelected_Month to 11
40648>>>>>>>>>>>                        Send Adjust_Calendar
40649>>>>>>>>>>>                    End_Procedure
40650>>>>>>>>>>>                    Procedure pSelectDec
40652>>>>>>>>>>>                        Set Label to t.calendar.december
40653>>>>>>>>>>>                        Set piSelected_Month to 12
40654>>>>>>>>>>>                        Send Adjust_Calendar
40655>>>>>>>>>>>                    End_Procedure
40656>>>>>>>>>>>
40656>>>>>>>>>>>                    Object oSelectMonth is a FloatingPopupMenu
40658>>>>>>>>>>>                        Send Add_Item msg_pSelectJan t.calendar.january
40659>>>>>>>>>>>                        Send Add_Item msg_pSelectFeb t.calendar.february
40660>>>>>>>>>>>                        Send Add_Item msg_pSelectMar t.calendar.march
40661>>>>>>>>>>>                        Send Add_Item msg_pSelectApr t.calendar.april
40662>>>>>>>>>>>                        Send Add_Item msg_pSelectMay t.calendar.may
40663>>>>>>>>>>>                        Send Add_Item msg_pSelectJun t.calendar.june
40664>>>>>>>>>>>                        Send Add_Item msg_pSelectJul t.calendar.july
40665>>>>>>>>>>>                        Send Add_Item msg_pSelectAug t.calendar.august
40666>>>>>>>>>>>                        Send Add_Item msg_pSelectSep t.calendar.september
40667>>>>>>>>>>>                        Send Add_Item msg_pSelectOct t.calendar.october
40668>>>>>>>>>>>                        Send Add_Item msg_pSelectNov t.calendar.november
40669>>>>>>>>>>>                        Send Add_Item msg_pSelectDec t.calendar.december
40670>>>>>>>>>>>                    End_Object
40671>>>>>>>>>>>
40671>>>>>>>>>>>                    Procedure Adjust_Calendar
40673>>>>>>>>>>>                        Date date#
40674>>>>>>>>>>>                        Integer iDay iMonth iYear iItm
40674>>>>>>>>>>>                        Set Visible_State to false
40675>>>>>>>>>>>                        Set Visible_State to true
40676>>>>>>>>>>>                        Get Current_Item of (Grid2(Container3D1(Self))) to iItm
40677>>>>>>>>>>>                        Get value of (Grid2(Container3D1(Self))) item iItm to iDay
40678>>>>>>>>>>>                        Get piSelected_Month to iMonth
40679>>>>>>>>>>>                        Get Label of oCalendarYear to iYear
40680>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
40681>>>>>>>>>>>                        Set p_current_date of (Grid2(Container3D1(Self))) to date#
40682>>>>>>>>>>>                        Send Update_Calendar to (Grid2(Container3D1(Self)))
40683>>>>>>>>>>>                    End_Procedure
40684>>>>>>>>>>>
40684>>>>>>>>>>>                    Procedure Activating
40686>>>>>>>>>>>                        Forward Send Activating
40688>>>>>>>>>>>                        Send Date_Changing
40689>>>>>>>>>>>                    End_Procedure
40690>>>>>>>>>>>
40690>>>>>>>>>>>                    Procedure Date_Changing
40692>>>>>>>>>>>                        Set Visible_State to false
40693>>>>>>>>>>>                        Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
40694>>>>>>>>>>>                        Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
40695>>>>>>>>>>>                        Set Visible_State to true
40696>>>>>>>>>>>                    End_Procedure
40697>>>>>>>>>>>
40697>>>>>>>>>>>
40697>>>>>>>>>>>
40697>>>>>>>>>>>                    //AB-StoreEnd
40697>>>>>>>>>>>
40697>>>>>>>>>>>                End_Object    // oMonth
40698>>>>>>>>>>>
40698>>>>>>>>>>>                Object oCalendarYear is a Textbox
40700>>>>>>>>>>>                    Set Label to "2001"
40701>>>>>>>>>>>                    Set Transparent_State to TRUE
40702>>>>>>>>>>>                    Set Color to clWhite
40703>>>>>>>>>>>                    Set TextColor to clWhite
40704>>>>>>>>>>>                    Set Location to 4 77
40705>>>>>>>>>>>                    Set Size to 10 18
40706>>>>>>>>>>>                    Set FontWeight to 800
40707>>>>>>>>>>>
40707>>>>>>>>>>>                    //AB-StoreStart
40707>>>>>>>>>>>
40707>>>>>>>>>>>                    Procedure Mouse_Down
40709>>>>>>>>>>>                        String sVal
40710>>>>>>>>>>>                        Get Label to sVal
40711>>>>>>>>>>>                        Set Value of oSelectCalendarYear item 0 to sVal
40712>>>>>>>>>>>                        Set Visible_State of oSelectCalendarYear to True
40713>>>>>>>>>>>                        Send Activate to (oSelectCalendarYear(Self))
40714>>>>>>>>>>>                    End_Procedure
40715>>>>>>>>>>>
40715>>>>>>>>>>>                    Procedure Activating
40717>>>>>>>>>>>                        Forward Send Activating
40719>>>>>>>>>>>                        Send Date_Changing
40720>>>>>>>>>>>                    End_Procedure
40721>>>>>>>>>>>
40721>>>>>>>>>>>                    Procedure Date_Changing
40723>>>>>>>>>>>                        Set Visible_State to false
40724>>>>>>>>>>>                        Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
40725>>>>>>>>>>>                        Set Visible_State to true
40726>>>>>>>>>>>                    End_Procedure
40727>>>>>>>>>>>
40727>>>>>>>>>>>                    //AB-StoreEnd
40727>>>>>>>>>>>
40727>>>>>>>>>>>                End_Object    // oCalendarYear
40728>>>>>>>>>>>
40728>>>>>>>>>>>                Object oSelectCalendarYear is a Form
40730>>>>>>>>>>>
40730>>>>>>>>>>>                    //AB-StoreTopStart
40730>>>>>>>>>>>                    Set Visible_State To False
40731>>>>>>>>>>>                    //AB-StoreTopEnd
40731>>>>>>>>>>>
40731>>>>>>>>>>>                    Set Size to 10 24
40732>>>>>>>>>>>                    Set Location to 4 75
40733>>>>>>>>>>>                    Set Color to clWhite
40734>>>>>>>>>>>                    Set TextColor to clNavy
40735>>>>>>>>>>>                    Set Form_Border Item 0 to Border_Normal
40736>>>>>>>>>>>
40736>>>>>>>>>>>                    //AB-StoreStart
40736>>>>>>>>>>>
40736>>>>>>>>>>>                    On_Key Key_Enter Send OnKillFocus
40737>>>>>>>>>>>                    On_Key Key_Escape Send OnKillFocus
40738>>>>>>>>>>>
40738>>>>>>>>>>>                    Procedure SetFontWeight
40740>>>>>>>>>>>                        Set Form_FontWeight item 0 to 800
40741>>>>>>>>>>>                    End_Procedure
40742>>>>>>>>>>>
40742>>>>>>>>>>>                    Procedure OnKillFocus
40744>>>>>>>>>>>                        String sVal
40745>>>>>>>>>>>                        Integer iMonth iDay iYear iItm
40745>>>>>>>>>>>                        Date date#
40745>>>>>>>>>>>                        Get Value item 0 to sVal
40746>>>>>>>>>>>                        Set Visible_State of oCalendarYear to false
40747>>>>>>>>>>>                        Set Label of oCalendarYear to sVal
40748>>>>>>>>>>>                        Set Visible_State of oCalendarYear to true
40749>>>>>>>>>>>                        Set Visible_State to false
40750>>>>>>>>>>>                        Get Current_Item of (Grid2(Container3D1(Self))) to iItm
40751>>>>>>>>>>>                        Get value of (Grid2(Container3D1(Self))) item iItm to iDay
40752>>>>>>>>>>>                        Get piSelected_Month of oMonth to iMonth
40753>>>>>>>>>>>                        Get Value item 0 to iYear
40754>>>>>>>>>>>                        If (iYear = 0) Move 2000 to iYear
40757>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
40758>>>>>>>>>>>                        Set p_current_date of (Grid2(Container3D1(Self))) to date#
40759>>>>>>>>>>>                        Send Update_Calendar to (Grid2(Container3D1(Self)))
40760>>>>>>>>>>>                        Send Activate        to (Grid2(Container3D1(Self)))
40761>>>>>>>>>>>                    End_Procedure
40762>>>>>>>>>>>
40762>>>>>>>>>>>                    Send SetFontWeight
40763>>>>>>>>>>>
40763>>>>>>>>>>>
40763>>>>>>>>>>>
40763>>>>>>>>>>>                    //AB-StoreEnd
40763>>>>>>>>>>>
40763>>>>>>>>>>>                End_Object    // oSelectCalendarYear
40764>>>>>>>>>>>
40764>>>>>>>>>>>
40764>>>>>>>>>>>                //AB-StoreStart
40764>>>>>>>>>>>
40764>>>>>>>>>>>                Procedure Mouse_Down
40766>>>>>>>>>>>                    Integer iState
40767>>>>>>>>>>>                    Get Visible_State of oSelectCalendarYear to iState
40768>>>>>>>>>>>                    If (iState) Send OnKillFocus to oSelectCalendarYear
40771>>>>>>>>>>>                End_Procedure
40772>>>>>>>>>>>
40772>>>>>>>>>>>
40772>>>>>>>>>>>                //AB-StoreEnd
40772>>>>>>>>>>>
40772>>>>>>>>>>>            End_Object    // Container3d2
40773>>>>>>>>>>>
40773>>>>>>>>>>>
40773>>>>>>>>>>>            //AB-StoreStart
40773>>>>>>>>>>>
40773>>>>>>>>>>>
40773>>>>>>>>>>>            //AB-StoreEnd
40773>>>>>>>>>>>
40773>>>>>>>>>>>        End_Object    // Container3d1
40774>>>>>>>>>>>
40774>>>>>>>>>>>        Object BitmapContainer3 is a BitmapContainer
40776>>>>>>>>>>>            Set Size to 9 19
40777>>>>>>>>>>>            Set Location to 88 3
40778>>>>>>>>>>>            Set Color to clWhite
40779>>>>>>>>>>>            Set Bitmap to "cdate.bmp"
40780>>>>>>>>>>>            Set Border_Style to Border_None
40781>>>>>>>>>>>
40781>>>>>>>>>>>            //AB-StoreStart
40781>>>>>>>>>>>            Procedure Mouse_Down
40783>>>>>>>>>>>                Send go_today to (Grid2(Container3d1(Self)))
40784>>>>>>>>>>>                Send Adjust_Label to oToday
40785>>>>>>>>>>>            End_Procedure
40786>>>>>>>>>>>            //AB-StoreEnd
40786>>>>>>>>>>>
40786>>>>>>>>>>>        End_Object    // BitmapContainer3
40787>>>>>>>>>>>
40787>>>>>>>>>>>        Object oToday is a Textbox
40789>>>>>>>>>>>            Set Label to "Today: 01.01.2001"
40790>>>>>>>>>>>            Set Auto_Size_State to FALSE
40791>>>>>>>>>>>            Set Color to clWhite
40792>>>>>>>>>>>            Set Location to 88 22
40793>>>>>>>>>>>            Set Size to 8 70
40794>>>>>>>>>>>            Set FontWeight to 800
40795>>>>>>>>>>>
40795>>>>>>>>>>>            //AB-StoreStart
40795>>>>>>>>>>>            Procedure Mouse_Down
40797>>>>>>>>>>>                Send go_today to (Grid2(Container3d1(Self)))
40798>>>>>>>>>>>                Send Adjust_Label
40799>>>>>>>>>>>            End_Procedure
40800>>>>>>>>>>>
40800>>>>>>>>>>>            Procedure Adjust_Label
40802>>>>>>>>>>>                date date#
40803>>>>>>>>>>>                SysDate4 date#
40804>>>>>>>>>>>                Set Visible_State To false
40805>>>>>>>>>>>                Set Label         to (t.calendar.today+": "+String(date#))
40806>>>>>>>>>>>                Set Visible_State To true
40807>>>>>>>>>>>            End_Procedure
40808>>>>>>>>>>>
40808>>>>>>>>>>>            Procedure Activating
40810>>>>>>>>>>>                Forward Send Activating
40812>>>>>>>>>>>                Send Adjust_Label
40813>>>>>>>>>>>            End_Procedure
40814>>>>>>>>>>>            //AB-StoreEnd
40814>>>>>>>>>>>
40814>>>>>>>>>>>        End_Object    // oToday
40815>>>>>>>>>>>
40815>>>>>>>>>>>        Object oCloseCalendar_bn is a BitmapContainer
40817>>>>>>>>>>>            Set Size to 9 10
40818>>>>>>>>>>>            Set Location to 88 112
40819>>>>>>>>>>>            Set Bitmap to "Cdate1.bmp"
40820>>>>>>>>>>>            Set Bitmap_Style to Bitmap_Center
40821>>>>>>>>>>>
40821>>>>>>>>>>>            //AB-StoreStart
40821>>>>>>>>>>>
40821>>>>>>>>>>>            Procedure Mouse_Up
40823>>>>>>>>>>>                Send Close_Calendar
40824>>>>>>>>>>>            End_Procedure // Mouse_Up
40825>>>>>>>>>>>
40825>>>>>>>>>>>
40825>>>>>>>>>>>
40825>>>>>>>>>>>
40825>>>>>>>>>>>            //AB-StoreEnd
40825>>>>>>>>>>>
40825>>>>>>>>>>>        End_Object    // oCloseCalendar_bn
40826>>>>>>>>>>>
40826>>>>>>>>>>>
40826>>>>>>>>>>>        //AB-StoreStart
40826>>>>>>>>>>>
40826>>>>>>>>>>>        Set Block_Mouse_State to True
40827>>>>>>>>>>>        Set Popup_State to True
40828>>>>>>>>>>>        Set Locate_Mode to Popup_Locate
40829>>>>>>>>>>>
40829>>>>>>>>>>>        procedure popup
40831>>>>>>>>>>>            local integer focus# icItm iYear iMonth
40832>>>>>>>>>>>            local date date#
40832>>>>>>>>>>>            move (focus(desktop)) to focus#
40833>>>>>>>>>>>            set invoking_object_id of (Grid2(Container3d1(self))) to focus#
40834>>>>>>>>>>>            get value of focus# item current to date#
40835>>>>>>>>>>>            ifnot (integer(date#)) sysdate date#
40838>>>>>>>>>>>            move (Date2to4(date#)) to date#
40839>>>>>>>>>>>            set p_current_date of (Grid2(Container3d1(self))) to date#
40840>>>>>>>>>>>            send fill_list to (Grid2(Container3d1(self)))
40841>>>>>>>>>>>            move (DateSegment(date#,DS_YEAR)) to iYear
40842>>>>>>>>>>>            move (DateSegment(date#,DS_MONTH)) to iMonth
40843>>>>>>>>>>>            Set Label To (MonthName(iMonth)+', '+String(iYear))
40844>>>>>>>>>>>            forward send popup
40846>>>>>>>>>>>        end_procedure
40847>>>>>>>>>>>
40847>>>>>>>>>>>        Procedure Close_Calendar
40849>>>>>>>>>>>            Send Close_Panel
40850>>>>>>>>>>>        End_Procedure // Close_Calendar
40851>>>>>>>>>>>
40851>>>>>>>>>>>        Object Help_Container is a Container3d
40853>>>>>>>>>>>            Set Location to 0 0
40854>>>>>>>>>>>            Set Size     to 98 122
40855>>>>>>>>>>>            Set Visible_State to False
40856>>>>>>>>>>>            Set Enabled_State to False
40857>>>>>>>>>>>            Set Border_Style to Border_None
40858>>>>>>>>>>>            Set TextColor to clNavy
40859>>>>>>>>>>>
40859>>>>>>>>>>>            Object Help_Info is an Edit
40861>>>>>>>>>>>                Set Location to 0 0
40862>>>>>>>>>>>                Set Size     to 98 122
40863>>>>>>>>>>>                Set read_only_state to true
40864>>>>>>>>>>>                Set Border_Style to Border_None
40865>>>>>>>>>>>                Set scroll_bar_visible_state to False
40866>>>>>>>>>>>                Set FontWeight to 800
40867>>>>>>>>>>>
40867>>>>>>>>>>>                Procedure ReadHelpComments
40869>>>>>>>>>>>                    String lsFile
40870>>>>>>>>>>>
40870>>>>>>>>>>>                    Get_File_Path "Calendar.txt" to lsFile
40871>>>>>>>>>>>                    If (lsFile <> "") Send read lsFile
40874>>>>>>>>>>>                End_Procedure // ReadHelpComments
40875>>>>>>>>>>>
40875>>>>>>>>>>>                Procedure SetComments
40877>>>>>>>>>>>                    Send append_text "Help on Calendar"
40878>>>>>>>>>>>                    Send Insert ""
40879>>>>>>>>>>>                    Send Insert ""
40880>>>>>>>>>>>                    Send append_text "1.<Up>,<Dn>,<Lft>,<Rgt>"
40881>>>>>>>>>>>                    Send Insert ""
40882>>>>>>>>>>>                    Send append_text "  - select date."
40883>>>>>>>>>>>                    Send Insert ""
40884>>>>>>>>>>>                    Send append_text "2.<PgUp>,<PgDn>"
40885>>>>>>>>>>>                    Send Insert ""
40886>>>>>>>>>>>                    Send append_text "  - select month."
40887>>>>>>>>>>>                    Send Insert ""
40888>>>>>>>>>>>                    Send append_text "3.<Ctrl>+<D>"
40889>>>>>>>>>>>                    Send Insert ""
40890>>>>>>>>>>>                    Send append_text "  - set current date."
40891>>>>>>>>>>>                    Send Insert ""
40892>>>>>>>>>>>                    Send append_text "4.<Ctrl>+<Y>"
40893>>>>>>>>>>>                    Send Insert ""
40894>>>>>>>>>>>                    Send append_text "  - Change year."
40895>>>>>>>>>>>                    Send Insert ""
40896>>>>>>>>>>>                    Send append_text "5.<Ctrl>+<PgUp>,<PgDn>"
40897>>>>>>>>>>>                    Send Insert ""
40898>>>>>>>>>>>                    Send append_text "  - Select year."
40899>>>>>>>>>>>                End_procedure // SetComments
40900>>>>>>>>>>>
40900>>>>>>>>>>>                //Send SetComments
40900>>>>>>>>>>>                Set Color     to clWhite
40901>>>>>>>>>>>                Set TextColor to clNavy
40902>>>>>>>>>>>
40902>>>>>>>>>>>                Procedure OnSetFocus
40904>>>>>>>>>>>                    Send ReadHelpComments
40905>>>>>>>>>>>                End_Procedure
40906>>>>>>>>>>>
40906>>>>>>>>>>>                Object HelpFloatingMenu is a FloatingPopupMenu
40908>>>>>>>>>>>
40908>>>>>>>>>>>                    Procedure Close_Help
40910>>>>>>>>>>>                        Send Close_Help to Help_Container
40911>>>>>>>>>>>                    End_Procedure // Close_Calendar
40912>>>>>>>>>>>
40912>>>>>>>>>>>                    Send Add_item msg_Close_Help   t.calendar.Ok
40913>>>>>>>>>>>                End_Object // cOutlookFloatingMenu
40914>>>>>>>>>>>
40914>>>>>>>>>>>                Procedure Mouse_Up2 Integer aiWindow Integer aiChar_Pos
40916>>>>>>>>>>>                    Send Popup to HelpFloatingMenu
40917>>>>>>>>>>>                End_Procedure // Mouse_Up2
40918>>>>>>>>>>>
40918>>>>>>>>>>>            End_Object
40919>>>>>>>>>>>
40919>>>>>>>>>>>            Procedure Close_Help
40921>>>>>>>>>>>                Send Delete_Data to Help_Info
40922>>>>>>>>>>>                Set Visible_State to False
40923>>>>>>>>>>>                Set Enabled_State to False
40924>>>>>>>>>>>                Send Activate to (Grid2(Container3D1(Self)))
40925>>>>>>>>>>>            End_Procedure // Close_Help
40926>>>>>>>>>>>
40926>>>>>>>>>>>            On_Key kCancel Send Close_Help
40927>>>>>>>>>>>            On_Key Key_F1  Send Close_Help
40928>>>>>>>>>>>            On_Key kEnter  Send Close_Help
40929>>>>>>>>>>>        End_Object // Help_Info
40930>>>>>>>>>>>
40930>>>>>>>>>>>        on_key kcancel           send Close_Calendar
40931>>>>>>>>>>>
40931>>>>>>>>>>>
40931>>>>>>>>>>>
40931>>>>>>>>>>>
40931>>>>>>>>>>>
40931>>>>>>>>>>>
40931>>>>>>>>>>>        //AB-StoreEnd
40931>>>>>>>>>>>
40931>>>>>>>>>>>    End_Object    // oCalendar
40932>>>>>>>>>>>
40932>>>>>>>>>>>
40932>>>>>>>>>>>    //AB-StoreStart
40932>>>>>>>>>>>
40932>>>>>>>>>>>    Procedure Request_Popup_cOutlookCalendar for BaseClass
40933>>>>>>>>>>>        Integer focus# type# dm#
40934>>>>>>>>>>>
40934>>>>>>>>>>>        move (focus(desktop)) to focus#
40935>>>>>>>>>>>        if focus# gt desktop begin
40937>>>>>>>>>>>          get delegation_mode of focus# to dm#
40938>>>>>>>>>>>          set delegation_mode of focus# to no_delegate_or_error
40939>>>>>>>>>>>          get form_datatype of focus# item current to type#
40940>>>>>>>>>>>          if (type#=date_window or type#=mask_date_window) send popup to oCalendar
40943>>>>>>>>>>>          set delegation_mode of focus# to dm#
40944>>>>>>>>>>>        end
40944>>>>>>>>>>>>
40944>>>>>>>>>>>    End_Procedure
40945>>>>>>>>>>>
40945>>>>>>>>>>>    On_Key Key_Ctrl+Key_F1 Send Request_Popup_cOutlookCalendar
40946>>>>>>>>>>>    On_Key Key_Ctrl+Key_H  Send Request_Popup_cOutlookCalendar
40947>>>>>>>>>>>
40947>>>>>>>>>>>
40947>>>>>>>>>>>    //AB-StoreEnd
40947>>>>>>>>>>>
40947>>>>>>>>>>>//AB/     End_Object    // prj
40947>>>>>>>>>Use Dates.Utl
40947>>>>>>>>>
40947>>>>>>>>>   Define cStatusHelp       for "F4 = Calendar. T = Today, B = Begin of month, E = End of month."
40947>>>>>>>>>   Define cDateToday        for "T"
40947>>>>>>>>>   Define cDateBeginOfMonth for "B"
40947>>>>>>>>>   Define cDateEndOfMonth   for "E"
40947>>>>>>>>>
40947>>>>>>>>>Class cSyIntelliSense_Date_Mixin is a Message
40948>>>>>>>>>   Procedure DoDefineIntelliSenseDateMixin
40949>>>>>>>>>      Property Date    pdOriginal_Value          Public 0
40950>>>>>>>>>      Property Integer pbIntelliSense_Date_State Public dfTrue
40951>>>>>>>>>      Property Integer pbEnableCalendarPrompt    Public dfTrue
40952>>>>>>>>>      On_Key KUpArrow         Send DoAddOneDay
40953>>>>>>>>>      On_Key KDownArrow       Send DoSubOneDay
40954>>>>>>>>>   End_Procedure // DoDefineIntelliSenseDateMixin
40955>>>>>>>>>
40955>>>>>>>>>   Procedure DoAddOneDay
40956>>>>>>>>>        Integer rVal
40957>>>>>>>>>        Date dHmnia
40957>>>>>>>>>
40957>>>>>>>>>        Get Value Item 0 to dHmnia
40958>>>>>>>>>        Add 1 to dHmnia
40959>>>>>>>>>        Set Value Item 0 to dHmnia
40960>>>>>>>>>    End_Procedure // Add_One_Day
40961>>>>>>>>>
40961>>>>>>>>>    Procedure DoSubOneDay
40962>>>>>>>>>        Integer rVal
40963>>>>>>>>>        Date dHmnia
40963>>>>>>>>>
40963>>>>>>>>>        Get Value Item 0 to dHmnia
40964>>>>>>>>>        Sub 1 to dHmnia
40965>>>>>>>>>        Set Value Item 0 to dHmnia
40966>>>>>>>>>    End_Procedure // Add_One_Day
40967>>>>>>>>>
40967>>>>>>>>>   // **WvA: Augmented to store the current date-value before any changes are made
40967>>>>>>>>>   Procedure Entering returns Integer
40968>>>>>>>>>      Integer iRetVal
40969>>>>>>>>>      Date    dOriginal
40969>>>>>>>>>      Forward Get Msg_Entering to iRetVal
40971>>>>>>>>>      If (iRetVal = 0) Begin
40973>>>>>>>>>         Send DoStoreOriginalDate
40974>>>>>>>>>      End
40974>>>>>>>>>>
40974>>>>>>>>>      Procedure_Return iRetVal
40975>>>>>>>>>   End_Procedure // Entering
40976>>>>>>>>>
40976>>>>>>>>>   //**WvA: This procedure is augmented to see if the user entered a 1 or 2 digit
40976>>>>>>>>>   //       value with the intention to only change the day-part of the current date.
40976>>>>>>>>>   Procedure Next
40977>>>>>>>>>      Send DoIntelliSenseDate
40978>>>>>>>>>      Forward Send Next
40980>>>>>>>>>   End_Procedure // Next
40981>>>>>>>>>
40981>>>>>>>>>   // **WvA: Store the current date-value before any changes are made
40981>>>>>>>>>   Procedure DoStoreOriginalDate
40982>>>>>>>>>      Date    dOriginal
40983>>>>>>>>>      //If (pbIntelliSense_Date_State(Self)) Begin
40983>>>>>>>>>         Get Value Item 0 to dOriginal
40984>>>>>>>>>         Set pdOriginal_Value to dOriginal
40985>>>>>>>>>      //End
40985>>>>>>>>>   End_Procedure // DoStoreOriginalDate
40986>>>>>>>>>
40986>>>>>>>>>   Procedure DoIntelliSenseDate
40987>>>>>>>>>      Integer iCurrent iStored iDaysOffSet iSep iDate_Format bChanged iYear
40988>>>>>>>>>      Date    dCurrent dOriginal
40988>>>>>>>>>      String  sStored  sCurrent sSep sMask
40988>>>>>>>>>
40988>>>>>>>>>      Get Item_Changed_State Item 0 to bChanged
40989>>>>>>>>>      Get pdOriginal_Value to dOriginal
40990>>>>>>>>>      If (pbIntelliSense_Date_State(Self) And (bChanged)) Begin
40992>>>>>>>>>         If (dOriginal Eq 0) Sysdate4 dOriginal
40995>>>>>>>>>
40995>>>>>>>>>         // We need the masked value, because the normal value is corrected by the runtime for
40995>>>>>>>>>         // USA dates.
40995>>>>>>>>>         Get Masked_Value Item 0 to sCurrent // getting a 2 digit entered date to a datavariable results in an error.
40996>>>>>>>>>         Move (Replaces(" ",sCurrent,"")) to sCurrent
40997>>>>>>>>>         Get_Attribute DF_DATE_SEPARATOR to iSep
41000>>>>>>>>>         Move (Character(iSep)) to sSep
41001>>>>>>>>>
41001>>>>>>>>>         // Although the sep value is "/" in the European date format, the mask seperator is "-".
41001>>>>>>>>>         Move (Replaces("-",sCurrent,sSep)) to sCurrent
41002>>>>>>>>>         Move (sSep+sSep) to sMask
41003>>>>>>>>>
41003>>>>>>>>>         // Now check if the user just entered a day or a day and a month.
41003>>>>>>>>>         // Something very special is going on here. We are interpreting a string, so the format
41003>>>>>>>>>         // will always be the same, even for USA or Military dates. "99//" where 9 can be any number
41003>>>>>>>>>         //If ( (length(sCurrent) > 2) And (Right(sCurrent,2) = sMask)  ) Begin
41003>>>>>>>>>         If ((length(sCurrent) <= 4) And (Right(sCurrent,2) = sMask)) Begin
41005>>>>>>>>>            Move (replace(sMask,sCurrent,"")) to sCurrent
41006>>>>>>>>>            Move sCurrent to iCurrent
41007>>>>>>>>>            If ((iCurrent >= 1) And (iCurrent <= 31)) Begin
41009>>>>>>>>>               Get_Attribute DF_DATE_FORMAT to iDate_Format
41012>>>>>>>>>               If (iDate_Format = DF_DATE_USA) Begin
41014>>>>>>>>>                  Move (Mid( String(dOriginal),2,4)) to iDaysOffSet
41015>>>>>>>>>               End
41015>>>>>>>>>>
41015>>>>>>>>>               Else If (iDate_Format = DF_DATE_EUROPEAN) Begin
41018>>>>>>>>>                  Move (Left( String(dOriginal),2 )) to iDaysOffSet
41019>>>>>>>>>               End
41019>>>>>>>>>>
41019>>>>>>>>>               Else If (iDate_Format = DF_DATE_MILITARY) Begin
41022>>>>>>>>>                  Move (Right( String(dOriginal),2 )) to iDaysOffSet
41023>>>>>>>>>               End
41023>>>>>>>>>>
41023>>>>>>>>>               Set Value Item 0 to (Date(dOriginal - iDaysOffSet + iCurrent))
41024>>>>>>>>>            End // Let the runtime handle the error if value not in the range 1..31
41024>>>>>>>>>>
41024>>>>>>>>>         End
41024>>>>>>>>>>
41024>>>>>>>>>         Else If ((length(sCurrent) > 4) And (Right(sCurrent,1) = sSep)) Begin
41027>>>>>>>>>            Get_Attribute DF_DATE_FORMAT to iDate_Format
41030>>>>>>>>>            If ((iDate_Format = DF_DATE_USA) Or (iDate_Format = DF_DATE_EUROPEAN)) Begin
41032>>>>>>>>>               Move (Right(dOriginal,4)) to iYear
41033>>>>>>>>>            End
41033>>>>>>>>>>
41033>>>>>>>>>            Else If (iDate_Format = DF_DATE_MILITARY) Begin
41036>>>>>>>>>               Move (Left(dOriginal,4))  to iYear
41037>>>>>>>>>            End
41037>>>>>>>>>>
41037>>>>>>>>>            Set Value Item 0 to (Date(sCurrent + String(iYear)))
41038>>>>>>>>>         End
41038>>>>>>>>>>
41038>>>>>>>>>      End
41038>>>>>>>>>>
41038>>>>>>>>>   End_Procedure // DoIntelliSenseDate
41039>>>>>>>>>
41039>>>>>>>>>   Procedure Key Integer iKey Returns Integer
41040>>>>>>>>>      Date dToday dTemp
41041>>>>>>>>>      Sysdate4 dToday
41042>>>>>>>>>
41042>>>>>>>>>      If ((Character(iKey) EQ cDateToday) OR (Character(iKey) EQ Lowercase(cDateToday))) Begin
41044>>>>>>>>>         Set Value to dToday
41045>>>>>>>>>      End
41045>>>>>>>>>>
41045>>>>>>>>>      Else If ((Character(iKey) EQ cDateBeginOfMonth) OR (Character(iKey) EQ Lowercase(cDateBeginOfMonth))) Begin
41048>>>>>>>>>         Get FirstDayInMonth dToday to dTemp
41049>>>>>>>>>         Set Value to dTemp
41050>>>>>>>>>      End
41050>>>>>>>>>>
41050>>>>>>>>>      Else If ((Character(iKey) EQ cDateEndOfMonth) OR (Character(iKey) EQ Lowercase(cDateEndOfMonth))) Begin
41053>>>>>>>>>         Get LastDayInMonth dToday to dTemp
41054>>>>>>>>>         Set Value to dTemp
41055>>>>>>>>>      End
41055>>>>>>>>>>
41055>>>>>>>>>      Else Forward Send Key iKey
41058>>>>>>>>>   End_procedure
41059>>>>>>>>>
41059>>>>>>>>>End_Class // cSyIntelliSense_Date_Mixin
41060>>>>>>>
41060>>>>>>>Class cSyDateForm Is A FormSub
41061>>>>>>>   Procedure Construct_Object
41062>>>>>>>      Forward Send Construct_Object
41064>>>>>>>
41064>>>>>>>      Set Prompt_Button_Mode   to PB_PromptOn
41065>>>>>>>      Set Form_Datatype Item 0 to Mask_Date_Window
41066>>>>>>>
41066>>>>>>>      Send DoDefineIntelliSenseDateMixin
41067>>>>>>>
41067>>>>>>>      On_Key kPrompt Send Prompt
41068>>>>>>>
41068>>>>>>>      Set Prompt_Object to (oCalendar(Self))
41069>>>>>>>      Set Status_Help   to cStatusHelp
41070>>>>>>>
41070>>>>>>>   End_Procedure // Construct_Object
41071>>>>>>>
41071>>>>>>>   Import_Class_Protocol cSyIntelliSense_Date_Mixin
41072>>>>>>>
41072>>>>>>>//   Function Form_Datatype Integer iItem Returns Integer
41072>>>>>>>//      Integer iDatatype
41072>>>>>>>//
41072>>>>>>>//      If (iItem = Current) Begin
41072>>>>>>>//         Get Current_Item to iItem
41072>>>>>>>//      End
41072>>>>>>>//
41072>>>>>>>//      Forward Get Form_Datatype Item iItem to iDataType
41072>>>>>>>//
41072>>>>>>>//      Function_Return iDatatype
41072>>>>>>>//   End_Function // Form_Datatype
41072>>>>>>>
41072>>>>>>>End_Class // cSyDateForm
41073>>>>>Use Form.Sub
41073>>>>>Use Button.Sub
41073>>>>>
41073>>>>>
41073>>>>>Use BAXIOKAT.DD
INCLUDING FILE: BAXIOKAT.DD
41073>>>>>>>//DDB-FileStart
41073>>>>>>>//DDB-HeaderStart
41073>>>>>>>
41073>>>>>>>// File Name : BAXIOKAT.DD
41073>>>>>>>// Class Name: Baxiokat_DataDictionary
41073>>>>>>>// Revision  : 45
41073>>>>>>>// Version   : 2
41073>>>>>>>
41073>>>>>>>Use  Windows           // Basic Definitions
41073>>>>>>>Use  DataDict          // DataDictionary Class Definition
41073>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41073>>>>>>>
41073>>>>>>>Open Baxiokat
41075>>>>>>>Open Baxio
41077>>>>>>>Open Bkinkat
INCLUDING FILE: BKINKAT.FD
41079>>>>>>>Open Tpclient
41081>>>>>>>Open Tperga
INCLUDING FILE: TPERGA.FD
41083>>>>>>>Open Tparticl
INCLUDING FILE: TPARTICL.FD
41085>>>>>>>Open Sysrecb
41087>>>>>>>
41087>>>>>>>//DDB-HeaderEnd
41087>>>>>>>//DDB-ValidationStart
41087>>>>>>>
41087>>>>>>>//DDB/ ExternalValidationTable Baxiokat_Type_VT  BAXIO.PKG
41087>>>>>>>
41087>>>>>>>Register_Object Baxiokat_Type_VT
41087>>>>>>>Register_Object Baxiokat_Baxiokat_Yn5390_VT
41087>>>>>>>Register_Object Baxiokat_Baxiokat_Bank_VT
41087>>>>>>>Register_Object Baxiokat_Baxiokat_Formul_VT
41087>>>>>>>Use BAXIO.PKG        // Baxiokat_Type_VT
41087>>>>>>>
41087>>>>>>>Object Baxiokat_Baxiokat_Yn5390_VT  is a DescriptionValidationTable
41089>>>>>>>
41089>>>>>>>    Procedure Fill_List
41091>>>>>>>        Forward Send Fill_List
41093>>>>>>>        Send Add_Table_Value  "0"  "Ž® "
41094>>>>>>>        Send Add_Table_Value  "1"  "Œ˜ "
41095>>>>>>>    End_Procedure    // Fill_List
41096>>>>>>>    //DDB-ValidationCustomStart
41096>>>>>>>    //DDB-ValidationCustomEnd
41096>>>>>>>End_Object   // Baxiokat_Baxiokat_Yn5390_VT
41097>>>>>>>
41097>>>>>>>Object Baxiokat_Baxiokat_Bank_VT  is a CodeValidationTable
41099>>>>>>>    Set Type_Value        To "BANK"
41100>>>>>>>    Set Allow_Blank_State To TRUE
41101>>>>>>>    //DDB-ValidationCustomStart
41101>>>>>>>    //DDB-ValidationCustomEnd
41101>>>>>>>End_Object   // Baxiokat_Baxiokat_Bank_VT
41102>>>>>>>
41102>>>>>>>Object Baxiokat_Baxiokat_Formul_VT  is a DescriptionValidationTable
41104>>>>>>>    Set Allow_Blank_State To TRUE
41105>>>>>>>
41105>>>>>>>    Procedure Fill_List
41107>>>>>>>        Forward Send Fill_List
41109>>>>>>>        Send Add_Table_Value  "0"  ""
41110>>>>>>>        Send Add_Table_Value  "1"  "’ç§¦ª 1"
41111>>>>>>>        Send Add_Table_Value  "2"  "’ç§¦ª 2"
41112>>>>>>>    End_Procedure    // Fill_List
41113>>>>>>>    //DDB-ValidationCustomStart
41113>>>>>>>    //DDB-ValidationCustomEnd
41113>>>>>>>End_Object   // Baxiokat_Baxiokat_Formul_VT
41114>>>>>>>//DDB-ValidationEnd
41114>>>>>>>//DDB-SelectionStart
41114>>>>>>>//DDB/ ExternalSelectionList SL034  SL034.SL
41114>>>>>>>Register_Object SL034
41114>>>>>>>//DDB-SelectionEnd
41114>>>>>>>
41114>>>>>>>Open Syscurxr
41116>>>>>>>Open Btypkin
41118>>>>>>>Open Bkinkat
41120>>>>>>>
41120>>>>>>>
41120>>>>>>>// Apo Baxio_DD
41120>>>>>>>Register_Function private.Default_Axio_C_Code2 Returns String
41120>>>>>>>//
41120>>>>>>>
41120>>>>>>>Class Baxiokat_DataDictionary  is a DataDictionary_Sec
41121>>>>>>>
41121>>>>>>>     Procedure Creating
41122>>>>>>>        Forward Send Creating
41124>>>>>>>        // Insert Code Here
41124>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Baxiokat.Baxiokat_Rec0)))))) to Baxiokat.Baxiokat_Recr
41125>>>>>>>    End_Procedure   // Creating
41126>>>>>>>
41126>>>>>>>     Procedure Construct_Object
41127>>>>>>>               Forward Send Construct_Object
41129>>>>>>>
41129>>>>>>>               //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
41129>>>>>>>               //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
41129>>>>>>>               //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
41129>>>>>>>               //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
41129>>>>>>>               Property Integer piBarticl_dd  0
41130>>>>>>>               Property Integer piBmove_dd    0
41131>>>>>>>               Property Integer piBaxio_dd    0
41132>>>>>>>               Property Integer piBtypkin_dd 0
41133>>>>>>>     End_Procedure   //construct_object
41134>>>>>>>
41134>>>>>>>
41134>>>>>>>     //private
41134>>>>>>>     //¡˜¢œå«˜  ˜§æ: iexit «¦¬ baxiokat_code
41134>>>>>>>     //©œ«á¨œ      : «ž¤ default « £ã «¦¬ baxio_c_code2, ˜¤á¢¦š˜ £œ «¦ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
41134>>>>>>>     Procedure private.Exit_Baxiokat_Code Integer liField Integer liBaxiokat_Code
41135>>>>>>>               String lsBaxio_C_Code_2
41136>>>>>>>        PROCEDURE_RETURN
41137>>>>>>>//jsjsjs 24/01/2001
41137>>>>>>>//               Get File_Field_Current_Value File_Field Year.Year_C_Code0 to lsBaxio_C_Code_2
41137>>>>>>>
41137>>>>>>>//               Set Field_Changed_Value of (piBaxio_dd(Self)) Field Baxio.Baxio_C_Code2 to  lsBaxio_C_Code_2 //(private.Default_Axio_C_Code2((piBAxio_dd(Self))))
41137>>>>>>>//jsjsjs 24/01/2001
41137>>>>>>>     End_Procedure //private.exit_baxiokat_code
41138>>>>>>>
41138>>>>>>>
41138>>>>>>>    //private
41138>>>>>>>    //¡˜¢œå«˜  ˜§æ:
41138>>>>>>>    //©œ«á¨œ : «ž¤ default value to baxiokat_code, ˜¤á¢¦š˜ £œ «¦ btypkin.baxiokat_num
41138>>>>>>>    Procedure private.Entry_Baxiokat_Code Integer liField Integer liBaxiokat_Code
41139>>>>>>>              Integer liBtypkin_dd liBkinkat_Num liBtypkin_Rec0
41140>>>>>>>
41140>>>>>>>        PROCEDURE_RETURN
41141>>>>>>>
41141>>>>>>>
41141>>>>>>>    End_Procedure //private.entry_gtypkin_code
41142>>>>>>>
41142>>>>>>>
41142>>>>>>>
41142>>>>>>>
41142>>>>>>>    Procedure Update
41143>>>>>>>          Forward Send Update
41145>>>>>>>          If (Baxiokat.Baxiokat_Yn5390 = 0);          Begin //œá¤ ›â¤ œå¤˜  £ž®˜¤¦š¨˜­ž£â¤œª œ§ «˜šâª, £ž›â¤ ©œ æ¢˜ «˜ ©®œ« ¡á §œ›å˜
41147>>>>>>>               Move "" to Baxiokat.Baxiokat_Bank
41148>>>>>>>               Move "" to Baxiokat.Baxiokat_Lno
41149>>>>>>>               Move 0  to Baxiokat.Baxiokat_Formul
41150>>>>>>>          End
41150>>>>>>>>
41150>>>>>>>    End_Procedure
41151>>>>>>>
41151>>>>>>>
41151>>>>>>>    Procedure Define_Fields
41152>>>>>>>        Forward Send Define_Fields
41154>>>>>>>        //DDB-Generated-Code-Location
41154>>>>>>>        //DDB-DefineFieldStart
41154>>>>>>>
41154>>>>>>>        Set Main_File            To Baxiokat.File_Number
41155>>>>>>>        Set Cascade_Delete_State To FALSE
41156>>>>>>>
41156>>>>>>>
41156>>>>>>>        // Child (Client) file structure................
41156>>>>>>>        Send Add_Client_File  Baxio.File_Number
41157>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
41158>>>>>>>        Send Add_Client_File  Tpclient.File_Number
41159>>>>>>>        Send Add_Client_File  Tperga.File_Number
41160>>>>>>>        Send Add_Client_File  Tparticl.File_Number
41161>>>>>>>
41161>>>>>>>        // External (System) file structure.............
41161>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
41162>>>>>>>
41162>>>>>>>        Define_Auto_Increment  Sysrecb.Baxiokat_Rec0  To Baxiokat.Baxiokat_Rec0
41165>>>>>>>
41165>>>>>>>        // Field-based properties.......................
41165>>>>>>>
41165>>>>>>>        // Baxiokat.Baxiokat_Code
41165>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Code To (SL034(Self))
41166>>>>>>>
41166>>>>>>>        // Baxiokat.Baxiokat_Descr
41166>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Descr To (SL034(Self))
41167>>>>>>>
41167>>>>>>>        // Baxiokat.Baxiokat_Rec0
41167>>>>>>>
41167>>>>>>>        // Baxiokat.Baxiokat_Recr
41167>>>>>>>
41167>>>>>>>        // Baxiokat.Baxiokat_Type
41167>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Type To (Baxiokat_Type_VT(Self))
41168>>>>>>>
41168>>>>>>>        // Baxiokat.Baxio_Lcode
41168>>>>>>>        //DDB/ Comment_Short       Field Baxiokat.Baxio_Lcode To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ creating/deleting «¦¬ baxio)"
41168>>>>>>>
41168>>>>>>>        // Baxiokat.Baxiokat_Yn5390
41168>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Yn5390 To (Baxiokat_Baxiokat_Yn5390_VT(Self))
41169>>>>>>>
41169>>>>>>>        // Baxiokat.Baxiokat_Bank
41169>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Bank To (Baxiokat_Baxiokat_Bank_VT(Self))
41170>>>>>>>
41170>>>>>>>        // Baxiokat.Baxiokat_Lno
41170>>>>>>>
41170>>>>>>>        // Baxiokat.Baxiokat_Formul
41170>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Formul To (Baxiokat_Baxiokat_Formul_VT(Self))
41171>>>>>>>
41171>>>>>>>        //DDB-DefineFieldEnd
41171>>>>>>>
41171>>>>>>>        Set Main_File            To Baxiokat.File_Number
41172>>>>>>>        Set Cascade_Delete_State To FALSE
41173>>>>>>>
41173>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
41174>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
41175>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41176>>>>>>>
41176>>>>>>>        // Child (Client) file structure................
41176>>>>>>>        Send Add_Client_File  Baxio.File_Number
41177>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
41178>>>>>>>
41178>>>>>>>        // External (System) file structure.............
41178>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
41179>>>>>>>
41179>>>>>>>        Define_Auto_Increment  Sysrecb.Baxiokat_Rec0  To Baxiokat.Baxiokat_Rec0
41182>>>>>>>
41182>>>>>>>        // Field-based properties.......................
41182>>>>>>>
41182>>>>>>>        // Baxiokat.Baxiokat_Code
41182>>>>>>>        Set Field_Entry_msg        Field Baxiokat.Baxiokat_Code   To private.Entry_Baxiokat_Code
41183>>>>>>>        Set Field_Exit_msg         Field Baxiokat.Baxiokat_Code   To private.Exit_Baxiokat_Code
41184>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Code   To "‰à› ¡æª „å›¦¬ª €¥ ¦š¨á­¦¬"
41185>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Code   To "„å›¦ª"
41186>>>>>>>        Set Field_Options          Field Baxiokat.Baxiokat_Code   To DD_AUTOFIND    DD_REQUIRED
41187>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Code   To (SL034(Self))
41188>>>>>>>        Set Key_Field_State        Field Baxiokat.Baxiokat_Code   To TRUE
41189>>>>>>>
41189>>>>>>>        // Baxiokat.Baxiokat_Descr
41189>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Descr  To "œ¨ š¨˜­ã „å›¦¬ª €¥ ¦š¨á­¦¬"
41190>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Descr  To "œ¨ š¨˜­ã"
41191>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Descr  To (SL034(Self))
41192>>>>>>>
41192>>>>>>>        // Baxiokat.Baxiokat_Rec0
41192>>>>>>>        Set Field_Options          Field Baxiokat.Baxiokat_Rec0   To DD_AUTOFIND    DD_REQUIRED
41193>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Rec0   To (SL034(Self))
41194>>>>>>>        Set Key_Field_State        Field Baxiokat.Baxiokat_Rec0   To TRUE
41195>>>>>>>
41195>>>>>>>        // Baxiokat.Baxiokat_Type
41195>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Type   To "dbComboForm_EZ"
41196>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Type   To "„ ©§¨˜¡«â¦/¢ž¨à«â¦"
41197>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Type   To "„ ©./¢ã¨."
41198>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Type   To (Baxiokat_Type_VT(Self))
41199>>>>>>>
41199>>>>>>>        // Baxiokat.Baxio_Lcode
41199>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxio_Lcode     To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª €¥ ¦šá­¦¬"
41200>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxio_Lcode     To "’œ¢.€¨ Ÿ£æª"
41201>>>>>>>        //Set Field_Options          Field Baxiokat.Baxio_Lcode     To DD_DISPLAYONLY
41201>>>>>>>
41201>>>>>>>        // Baxiokat.Baxiokat_Yn5390
41201>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Yn5390 To "dbComboForm_EZ"
41202>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Yn5390 To "‹ž®˜¤¦š¨˜­ž£â¤œª „§ «˜šâª ?"
41203>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Yn5390 To "‹ž®/¡âª „§ «˜šâª"
41204>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Yn5390 To (Baxiokat_Baxiokat_Yn5390_VT(Self))
41205>>>>>>>
41205>>>>>>>        // Baxiokat.Baxiokat_Bank
41205>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Bank   To "dbComboForm_EZ"
41206>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Bank   To "’¨á§œ˜"
41207>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Bank   To "’¨á§œ˜"
41208>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Bank   To (Baxiokat_Baxiokat_Bank_VT(Self))
41209>>>>>>>
41209>>>>>>>        // Baxiokat.Baxiokat_Lno
41209>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Lno    To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª"
41210>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Lno    To "’œ¢.€¨ Ÿ£æª"
41211>>>>>>>
41211>>>>>>>        // Baxiokat.Baxiokat_Formul
41211>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Formul To "dbComboForm_EZ"
41212>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Formul To "€¢šæ¨ Ÿ£¦ª Check Digit"
41213>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Formul To "Check Digit"
41214>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Formul To (Baxiokat_Baxiokat_Formul_VT(Self))
41215>>>>>>>
41215>>>>>>>    End_Procedure    // Define_Fields
41216>>>>>>>
41216>>>>>>>
41216>>>>>>>    Procedure Field_Defaults
41217>>>>>>>        Forward Send Field_Defaults
41219>>>>>>>        //DDB-Generated-Code-Location
41219>>>>>>>        //DDB-FieldDefaultStart
41219>>>>>>>        //DDB-FieldDefaultEnd
41219>>>>>>>        Set Field_Changed_Value   Field Baxiokat.Baxiokat_Yn5390 To 0
41220>>>>>>>    End_Procedure    // Field_Defaults
41221>>>>>>>
41221>>>>>>>End_Class    // Baxiokat_DataDictionary
41222>>>>>>>//DDB-Selection-pkg-Start
41222>>>>>>>
41222>>>>>>>Use SL034.SL         // SL034
INCLUDING FILE: SL034.SL
41222>>>>>>>>>//AB/ Project SL034:BAXIOKAT
41222>>>>>>>>>//AB/ Object prj is a Lookup_Project
41222>>>>>>>>>//AB/     Set ProjectName to "SL034:BAXIOKAT"
41222>>>>>>>>>//AB/     Set ProjectFileName to "SL034.SL"
41222>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
41222>>>>>>>>>
41222>>>>>>>>>// Project Object Structure
41222>>>>>>>>>//   SL034 is a dbModalPanelSub
41222>>>>>>>>>//     Baxiokat_DD is a DataDictionary
41222>>>>>>>>>//     oSelList is a dbListSub
41222>>>>>>>>>//     oOK_bn is a ButtonSub
41222>>>>>>>>>//     oCancel_bn is a ButtonSub
41222>>>>>>>>>//     oSearch_bn is a ButtonSub
41222>>>>>>>>>
41222>>>>>>>>>// Register all objects
41222>>>>>>>>>Register_Object Baxiokat_DD
41222>>>>>>>>>Register_Object oCancel_bn
41222>>>>>>>>>Register_Object oOK_bn
41222>>>>>>>>>Register_Object oSearch_bn
41222>>>>>>>>>Register_Object oSelList
41222>>>>>>>>>Register_Object SL034
41222>>>>>>>>>
41222>>>>>>>>>
41222>>>>>>>>>//AB-IgnoreStart
41222>>>>>>>>>
41222>>>>>>>>>Use DFAllEnt.pkg
41222>>>>>>>>>Use dbList.Sub
41222>>>>>>>>>Use Button.Sub
41222>>>>>>>>>
41222>>>>>>>>>
41222>>>>>>>>>Use BAXIOKAT.DD
41222>>>>>>>>>
41222>>>>>>>>>//AB-IgnoreEnd
41222>>>>>>>>>
41222>>>>>>>>>CD_Popup_Object SL034 is a dbModalPanelSub
41241>>>>>>>>>    set label to "‰˜«žš¦¨åœª €¥ ¦š¨á­à¤" 
41242>>>>>>>>>    Set Size to 206 347
41243>>>>>>>>>    Set Location to 4 5
41244>>>>>>>>>    Set Exit_Application_Local_State to FALSE
41245>>>>>>>>>    Set Modal_State to FALSE
41246>>>>>>>>>
41246>>>>>>>>>    //AB-DDOStart
41246>>>>>>>>>
41246>>>>>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
41248>>>>>>>>>    End_Object    // Baxiokat_DD
41249>>>>>>>>>
41249>>>>>>>>>    Set Main_DD to (Baxiokat_DD(self))
41250>>>>>>>>>    Set Server to (Baxiokat_DD(self))
41251>>>>>>>>>
41251>>>>>>>>>    //AB-DDOEnd
41251>>>>>>>>>
41251>>>>>>>>>    Object oSelList is a dbListSub
41253>>>>>>>>>        Set Main_File to Baxiokat.File_Number
41254>>>>>>>>>        Set Size to 164 335
41255>>>>>>>>>        Set Location to 5 4
41256>>>>>>>>>
41256>>>>>>>>>        Begin_Row
41259>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_code
41260>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_descr
41261>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_type
41262>>>>>>>>>            Entry_Item (Export_Code_Description(Self,2,Baxiokat.Baxiokat_type))
41263>>>>>>>>>        End_Row
41268>>>>>>>>>
41268>>>>>>>>>        Set Form_Width    item 0 to 55
41269>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
41270>>>>>>>>>
41270>>>>>>>>>        Set Form_Width    item 1 to 172
41271>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
41272>>>>>>>>>
41272>>>>>>>>>        Set Form_Width    item 2 to 16
41273>>>>>>>>>        set header_label  item 2 to "’ç§¦ª" 
41274>>>>>>>>>
41274>>>>>>>>>        Set Form_Width    item 3 to 83
41275>>>>>>>>>        set header_label  item 3 to "„ ©./¢ž¨." 
41276>>>>>>>>>
41276>>>>>>>>>    End_Object    // oSelList
41277>>>>>>>>>
41277>>>>>>>>>    Object oOK_bn is a ButtonSub
41279>>>>>>>>>        set label to "&„§ ¢¦šã" 
41280>>>>>>>>>        Set Location to 172 180
41281>>>>>>>>>
41281>>>>>>>>>        //AB-StoreStart
41281>>>>>>>>>        Procedure OnClick
41283>>>>>>>>>            Send OK To oSelList
41284>>>>>>>>>        End_Procedure
41285>>>>>>>>>        //AB-StoreEnd
41285>>>>>>>>>
41285>>>>>>>>>    End_Object    // oOK_bn
41286>>>>>>>>>
41286>>>>>>>>>    Object oCancel_bn is a ButtonSub
41288>>>>>>>>>        set label to "&€¡ç¨à©ž" 
41289>>>>>>>>>        Set Location to 172 234
41290>>>>>>>>>
41290>>>>>>>>>        //AB-StoreStart
41290>>>>>>>>>        Procedure OnClick
41292>>>>>>>>>            Send Cancel To oSelList
41293>>>>>>>>>        End_Procedure
41294>>>>>>>>>        //AB-StoreEnd
41294>>>>>>>>>
41294>>>>>>>>>    End_Object    // oCancel_bn
41295>>>>>>>>>
41295>>>>>>>>>    Object oSearch_bn is a ButtonSub
41297>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
41298>>>>>>>>>        Set Location to 172 289
41299>>>>>>>>>
41299>>>>>>>>>        //AB-StoreStart
41299>>>>>>>>>        Procedure OnClick
41301>>>>>>>>>            Send Search To oSelList
41302>>>>>>>>>        End_Procedure
41303>>>>>>>>>        //AB-StoreEnd
41303>>>>>>>>>
41303>>>>>>>>>    End_Object    // oSearch_bn
41304>>>>>>>>>
41304>>>>>>>>>
41304>>>>>>>>>    //AB-StoreStart
41304>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
41305>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
41306>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
41307>>>>>>>>>    //AB-StoreEnd
41307>>>>>>>>>
41307>>>>>>>>>CD_End_Object    // SL034
41309>>>>>>>>>>
41309>>>>>>>>>
41309>>>>>>>>>//AB/ End_Object    // prj
41309>>>>>>>
41309>>>>>>>//DDB-Selection-pkg-End
41309>>>>>>>//DDB-FileEnd
41309>>>>>Use BAXIO.DD
41309>>>>>
41309>>>>>//AB-IgnoreEnd
41309>>>>>
41309>>>>>Object SL037 is a dbModalPanelSub
41311>>>>>
41311>>>>>    //AB-StoreTopStart
41311>>>>>                        
41311>>>>>    Property Integer piFragmaBaxiokatRec0 Public  0
41313>>>>>    Property Integer piFragmaBaxiokatCode Public  0
41315>>>>>    Property Integer piFragmaBaxioStatus  Public  0
41317>>>>>    Property Integer piFragmaBaxioPlace   Public  0
41319>>>>>    Property string  psfragmaclient       Public ''
41321>>>>>    Property String  psFragmaBaxioStatus  Public ''
41323>>>>>    Property String  psEkdoths            Public ''
41325>>>>>    Property String  psApodekths          Public ''
41327>>>>>    Property Date pdApo                   Public ''
41329>>>>>    Property Date pdEos                   Public ''
41331>>>>>    
41331>>>>>    //AB-StoreTopEnd
41331>>>>>
41331>>>>>    Set Label to "‰˜«á¢¦š¦ª €¥ ¦š¨á­à¤"
41332>>>>>    Set Size to 287 527
41333>>>>>    Set Location to 2 3
41334>>>>>    Set Exit_Application_Local_State to FALSE
41335>>>>>    Set Modal_State to FALSE
41336>>>>>
41336>>>>>    //AB-DDOStart
41336>>>>>
41336>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
41338>>>>>    End_Object    // Baxiokat_DD
41339>>>>>
41339>>>>>    Object Baxio_DD is a Baxio_DataDictionary
41341>>>>>        Set DDO_Server to (Baxiokat_DD(self))
41342>>>>>
41342>>>>>        //AB-StoreStart
41342>>>>>                                                    
41342>>>>>        Function fiIsOK Returns Integer
41344>>>>>            String lsBaxioStatus sclient
41345>>>>>            Get psFragmaBaxioStatus  to lsBaxioStatus
41346>>>>>            Get psfragmaclient       to sclient
41347>>>>>            If (Trim(sClient)='') Begin
41349>>>>>                If (lsBaxioStatus Contains Baxio.Baxio_Status) Function_Return 1
41352>>>>>            End
41352>>>>>>
41352>>>>>            Else Begin
41353>>>>>                If (baxio.baxio_desm Eq sClient And lsBaxioStatus Contains Baxio.Baxio_Status) Function_Return 1
41356>>>>>            End
41356>>>>>>
41356>>>>>            Function_Return 0
41357>>>>>        End_Function
41358>>>>>        
41358>>>>>        Procedure OnConstrain
41360>>>>>        
41360>>>>>            Integer liBaxiokatCode liBaxioStatus liBaxioPlace
41361>>>>>            string  sclient lsBaxioStatus sApodekths sEkdoths
41361>>>>>            Date    dApo dEos
41361>>>>>        
41361>>>>>            Forward Send OnConstrain
41363>>>>>        
41363>>>>>            Get piFragmaBaxiokatCode    to liBaxiokatCode
41364>>>>>            Get psFragmaBaxioStatus     to lsBaxioStatus
41365>>>>>            Get piFragmaBaxioPlace      to liBaxioPlace
41366>>>>>        
41366>>>>>            Get psApodekths             to sApodekths
41367>>>>>            Get psEkdoths               to sEkdoths
41368>>>>>            Get pdApo                   to dApo
41369>>>>>            Get pdEos                   to dEos
41370>>>>>        
41370>>>>>            If (liBaxioKatCode <> 0) Begin
41372>>>>>                Constrain Baxio.Baxiokat_Code eq liBaxiokatCode
41374>>>>>                If (liBaxioPlace  <> 0)  Constrain Baxio.Baxio_Place eq liBaxioPlace
41378>>>>>                If (lsBaxioStatus <> '') Constrain Baxio as (fiIsOK(Self)=1)
41381>>>>>            End
41381>>>>>>
41381>>>>>        
41381>>>>>            If (sApodekths  <>'') Constrain Baxio.Baxio_Code_Out    Eq sApodekths
41385>>>>>            If (sEkdoths    <>'') Constrain Baxio.Baxio_Code_In     Eq sEkdoths
41389>>>>>            If (dApo        <>'') Constrain Baxio.Baxio_HmniaL      Ge dApo
41393>>>>>            If (dEos        <>'') Constrain Baxio.Baxio_HmniaL      Le dEos
41397>>>>>        
41397>>>>>        End_Procedure // OnConstrain
41398>>>>>        
41398>>>>>        
41398>>>>>        
41398>>>>>        
41398>>>>>        
41398>>>>>        
41398>>>>>        
41398>>>>>        
41398>>>>>        
41398>>>>>        
41398>>>>>        
41398>>>>>        
41398>>>>>        
41398>>>>>        //AB-StoreEnd
41398>>>>>
41398>>>>>    End_Object    // Baxio_DD
41399>>>>>
41399>>>>>    Set Main_DD to (Baxio_DD(self))
41400>>>>>    Set Server to (Baxio_DD(self))
41401>>>>>
41401>>>>>    //AB-DDOEnd
41401>>>>>
41401>>>>>    Object oSelList is a dbListSub
41403>>>>>        Set Main_File to Baxio.File_Number
41404>>>>>        Set Size to 228 514
41405>>>>>        Set Location to 4 6
41406>>>>>
41406>>>>>        Begin_Row
41409>>>>>            Entry_Item Baxio.Baxio_code
41410>>>>>            Entry_Item Baxio.Baxio_epon_in
41411>>>>>            Entry_Item Baxio.Baxio_epon_out
41412>>>>>            Entry_Item Baxiokat.Baxiokat_descr
41413>>>>>            Entry_Item Baxio.Baxio_hmnial
41414>>>>>            Entry_Item Baxio.Baxio_v2
41415>>>>>            Entry_Item Baxio.Baxio_banka
41416>>>>>            Entry_Item (Export_Code_Description(Self,6,Baxio.Baxio_banka))
41417>>>>>            Entry_Item Baxio.Baxio_no
41418>>>>>        End_Row
41423>>>>>
41423>>>>>        Set Form_Width    item 0 to 41
41424>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
41425>>>>>        
41425>>>>>        Set Form_Width    item 1 to 98
41426>>>>>        Set Header_Label  item 1 to "„¡›æ«žª"
41427>>>>>        
41427>>>>>        Set Form_Width    item 2 to 94
41428>>>>>        Set Header_Label  item 2 to "€§¦›â¡«žª"
41429>>>>>        
41429>>>>>        Set Form_Width    item 3 to 75
41430>>>>>        Set Header_Label  item 3 to "œ¨ š¨˜­ã"
41431>>>>>        
41431>>>>>        Set Form_Width    item 4 to 47
41432>>>>>        Set Header_Label  item 4 to "Šã¥ž"
41433>>>>>        
41433>>>>>        Set Form_Width    item 5 to 48
41434>>>>>        Set Header_Label  item 5 to "¦©æ"
41435>>>>>        
41435>>>>>        Set Form_Width    item 6 to 12
41436>>>>>        Set Header_Label  item 6 to "‰à› ¡æª ’¨á§œ˜"
41437>>>>>        
41437>>>>>        Set Form_Width    item 7 to 42
41438>>>>>        Set Header_Label  item 7 to "’¨á§œ˜"
41439>>>>>        
41439>>>>>        Set Form_Width    item 8 to 53
41440>>>>>        Set Header_Label  item 8 to "€¨ Ÿ£æª"
41441>>>>>        
41441>>>>>
41441>>>>>        //AB-StoreStart
41441>>>>>                
41441>>>>>        Property Integer piStoreFragmaBaxiokatRec0 Public 0
41443>>>>>        Property Integer piStoreFragmaBaxiokatCode Public 0
41445>>>>>        Property Integer piStoreFragmaBaxioStatus  Public 0
41447>>>>>        Property Integer piStoreFragmaBaxioPlace   Public 0
41449>>>>>        Property String  psStoreFragmaBaxioStatus  Public ''
41451>>>>>        
41451>>>>>        Procedure Store_Defaults
41453>>>>>            Forward Send Store_Defaults
41455>>>>>            Set piStoreFragmaBaxiokatRec0 to (piFragmaBaxiokatRec0(Self))
41456>>>>>            Set piStoreFragmaBaxiokatCode to (piFragmaBaxiokatCode(Self))
41457>>>>>            Set piStoreFragmaBaxioStatus  to (piFragmaBaxioStatus(Self))
41458>>>>>            Set piStoreFragmaBaxioPlace   to (piFragmaBaxioPlace(Self))
41459>>>>>            Set psStoreFragmaBaxioStatus  to (psFragmaBaxioStatus(Self))
41460>>>>>        End_Procedure // Store_Defaults
41461>>>>>        
41461>>>>>        Procedure Restore_Defaults
41463>>>>>            Forward Send Restore_Defaults
41465>>>>>            Set piFragmaBaxiokatRec0 to (piStoreFragmaBaxiokatRec0(Self))
41466>>>>>            Set piFragmaBaxiokatCode to (piStoreFragmaBaxiokatCode(Self))
41467>>>>>            Set piFragmaBaxioStatus  to (piStoreFragmaBaxioStatus(Self))
41468>>>>>            Set piFragmaBaxioPlace   to (piStoreFragmaBaxioPlace(Self))
41469>>>>>            Set psFragmaBaxioStatus  to (psStoreFragmaBaxioStatus(Self))
41470>>>>>        End_Procedure // Restore_Defaults
41471>>>>>        
41471>>>>>        Procedure Activating
41473>>>>>            Forward Send Activating
41475>>>>>         //   Set Auto_Index_State        to True
41475>>>>>            Send Rebuild_Constraints    to Baxio_DD
41476>>>>>        End_Procedure
41477>>>>>        
41477>>>>>        Procedure End_Construct_Object
41479>>>>>            Integer iDecs
41480>>>>>            Forward Send End_Construct_Object
41482>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    iDecs
41483>>>>>            Set Points Item 5 to iDecs
41484>>>>>            Set Numeric_Mask Item 5 to 10 iDecs ' ,*'
41485>>>>>        End_Procedure
41486>>>>>        
41486>>>>>        
41486>>>>>        
41486>>>>>        
41486>>>>>        
41486>>>>>        
41486>>>>>        
41486>>>>>        
41486>>>>>        
41486>>>>>        
41486>>>>>        
41486>>>>>        //AB-StoreEnd
41486>>>>>
41486>>>>>    End_Object    // oSelList
41487>>>>>
41487>>>>>    Object TextBoxSub1 is a TextBoxSub
41489>>>>>        Set Label to "Šã¥ž ˜§¦"
41490>>>>>        Set Location to 241 7
41491>>>>>        Set Size to 10 35
41492>>>>>        Set TypeFace to "MS Sans Serif"
41493>>>>>    End_Object    // TextBoxSub1
41494>>>>>
41494>>>>>    Object cSyDateForm1 is a cSyDateForm
41496>>>>>        Set Size to 13 66
41497>>>>>        Set Location to 240 45
41498>>>>>        Set Label_Col_Offset to 2
41499>>>>>        Set Label_Justification_Mode to jMode_Right
41500>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
41501>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
41502>>>>>
41502>>>>>        //AB-StoreStart
41502>>>>>                                                    
41502>>>>>        Procedure Key Integer iKey
41504>>>>>            Integer iRetVal
41505>>>>>            Forward Send Key iKey
41507>>>>>            If (iKey=277) Begin
41509>>>>>                Set Value Item 0 to ''
41510>>>>>                //Send KeyAction to ButtonSub1
41510>>>>>            End
41510>>>>>>
41510>>>>>        End_Procedure
41511>>>>>        
41511>>>>>        
41511>>>>>        //AB-StoreEnd
41511>>>>>
41511>>>>>    End_Object    // cSyDateForm1
41512>>>>>
41512>>>>>    Object TextBoxSub2 is a TextBoxSub
41514>>>>>        Set Label to "Šã¥ž œàª"
41515>>>>>        Set Location to 258 7
41516>>>>>        Set Size to 10 35
41517>>>>>        Set TypeFace to "MS Sans Serif"
41518>>>>>    End_Object    // TextBoxSub2
41519>>>>>
41519>>>>>    Object cSyDateForm2 is a cSyDateForm
41521>>>>>        Set Size to 13 66
41522>>>>>        Set Location to 256 45
41523>>>>>        Set Label_Col_Offset to 2
41524>>>>>        Set Label_Justification_Mode to jMode_Right
41525>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
41526>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
41527>>>>>
41527>>>>>        //AB-StoreStart
41527>>>>>                                                    
41527>>>>>        Procedure Key Integer iKey
41529>>>>>            Integer iRetVal
41530>>>>>            Forward Send Key iKey
41532>>>>>            If (iKey=277) Begin
41534>>>>>                Set Value Item 0 to ''
41535>>>>>                //Send KeyAction to ButtonSub1
41535>>>>>            End
41535>>>>>>
41535>>>>>        End_Procedure
41536>>>>>        
41536>>>>>        
41536>>>>>        //AB-StoreEnd
41536>>>>>
41536>>>>>    End_Object    // cSyDateForm2
41537>>>>>
41537>>>>>    Object TextBoxSub4 is a TextBoxSub
41539>>>>>        Set Label to "„¡›æ«žª"
41540>>>>>        Set Location to 241 118
41541>>>>>        Set Size to 10 33
41542>>>>>        Set TypeFace to "MS Sans Serif"
41543>>>>>    End_Object    // TextBoxSub4
41544>>>>>
41544>>>>>    Object TextBoxSub5 is a TextBoxSub
41546>>>>>        Set Label to "€§¦›â¡«žª"
41547>>>>>        Set Location to 258 118
41548>>>>>        Set Size to 10 39
41549>>>>>        Set TypeFace to "MS Sans Serif"
41550>>>>>    End_Object    // TextBoxSub5
41551>>>>>
41551>>>>>    Object FormSub1 is a FormSub
41553>>>>>        Set Size to 13 77
41554>>>>>        Set Location to 240 159
41555>>>>>        Set Label_Col_Offset to 2
41556>>>>>        Set Prompt_Button_Mode to pb_PromptOn
41557>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
41558>>>>>
41558>>>>>        //AB-StoreStart
41558>>>>>                                                    
41558>>>>>        Set Prompt_Object to (sl100(Self))
41559>>>>>        
41559>>>>>        Procedure OnChange
41561>>>>>            String s1
41562>>>>>            Get Value Item 0 to s1
41563>>>>>            Set Value Of FormSub2 Item 0 to (fsClient(Self,s1))
41564>>>>>            Set psEkdoths to s1
41565>>>>>        End_Procedure
41566>>>>>        
41566>>>>>        
41566>>>>>        
41566>>>>>        
41566>>>>>        
41566>>>>>        
41566>>>>>        
41566>>>>>        //AB-StoreEnd
41566>>>>>
41566>>>>>    End_Object    // FormSub1
41567>>>>>
41567>>>>>    Object FormSub2 is a FormSub
41569>>>>>        Set Size to 13 187
41570>>>>>        Set Location to 240 240
41571>>>>>        Set Color to clBtnFace
41572>>>>>        Set Label_Col_Offset to 2
41573>>>>>        Set Enabled_State to FALSE
41574>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
41575>>>>>        Set Item_Shadow_State Item 0 to TRUE
41576>>>>>        Set Shadow_State Item 0 to TRUE
41577>>>>>    End_Object    // FormSub2
41578>>>>>
41578>>>>>    Object FormSub3 is a FormSub
41580>>>>>        Set Size to 13 77
41581>>>>>        Set Location to 256 159
41582>>>>>        Set Label_Col_Offset to 2
41583>>>>>        Set Prompt_Button_Mode to pb_PromptOn
41584>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
41585>>>>>
41585>>>>>        //AB-StoreStart
41585>>>>>                                                    
41585>>>>>        Set Prompt_Object to (sl100(Self))
41586>>>>>        
41586>>>>>        Procedure OnChange
41588>>>>>            String s1
41589>>>>>            Get Value Item 0 to s1
41590>>>>>            Set Value Of FormSub4 Item 0 to (fsClient(Self,s1))
41591>>>>>            Set psApodekths to s1
41592>>>>>        End_Procedure
41593>>>>>        
41593>>>>>        
41593>>>>>        
41593>>>>>        
41593>>>>>        
41593>>>>>        
41593>>>>>        
41593>>>>>        //AB-StoreEnd
41593>>>>>
41593>>>>>    End_Object    // FormSub3
41594>>>>>
41594>>>>>    Object FormSub4 is a FormSub
41596>>>>>        Set Size to 13 187
41597>>>>>        Set Location to 256 240
41598>>>>>        Set Color to clBtnFace
41599>>>>>        Set Label_Col_Offset to 2
41600>>>>>        Set Enabled_State to FALSE
41601>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
41602>>>>>        Set Item_Shadow_State Item 0 to TRUE
41603>>>>>        Set Shadow_State Item 0 to TRUE
41604>>>>>    End_Object    // FormSub4
41605>>>>>
41605>>>>>    Object ButtonSub1 is a ButtonSub
41607>>>>>        Set Label to "œ¨ æ¨ ©œ"
41608>>>>>        Set Size to 14 43
41609>>>>>        Set Location to 256 430
41610>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
41611>>>>>
41611>>>>>        //AB-StoreStart
41611>>>>>                                                    
41611>>>>>        Procedure OnClick
41613>>>>>            Date dApo dEos
41614>>>>>            Get Value Of cSyDateForm1 Item 0 to dApo
41615>>>>>            Get Value Of cSyDateForm2 Item 0 to dEos
41616>>>>>            Set pdApo to dApo
41617>>>>>            Set pdEos to dEos
41618>>>>>            Send Rebuild_Constraints to Baxio_DD
41619>>>>>            Send Beginning_Of_Data to oSelList True
41620>>>>>        End_Procedure // OnClick
41621>>>>>        
41621>>>>>        
41621>>>>>        
41621>>>>>        
41621>>>>>        
41621>>>>>        
41621>>>>>        
41621>>>>>        
41621>>>>>        
41621>>>>>        
41621>>>>>        
41621>>>>>        
41621>>>>>        
41621>>>>>        //AB-StoreEnd
41621>>>>>
41621>>>>>    End_Object    // ButtonSub1
41622>>>>>
41622>>>>>    Object oOK_bn is a ButtonSub
41624>>>>>        Set Label to "&„§ ¢¦šã"
41625>>>>>        Set Size to 14 43
41626>>>>>        Set Location to 256 478
41627>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
41628>>>>>
41628>>>>>        //AB-StoreStart
41628>>>>>        Procedure OnClick
41630>>>>>            Send OK To oSelList
41631>>>>>        End_Procedure
41632>>>>>        //AB-StoreEnd
41632>>>>>
41632>>>>>    End_Object    // oOK_bn
41633>>>>>
41633>>>>>
41633>>>>>    //AB-StoreStart
41633>>>>>                        
41633>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
41634>>>>>    
41634>>>>>    Procedure Request_Cancel
41636>>>>>        Set Value Of cSyDateForm1 Item 0 to ''
41637>>>>>        Set Value Of cSyDateForm2 Item 0 to ''
41638>>>>>        Set Value Of FormSub1     Item 0 to ''
41639>>>>>        Set Value Of FormSub2     Item 0 to ''
41640>>>>>        Forward Send Request_Cancel
41642>>>>>    End_Procedure
41643>>>>>    
41643>>>>>    
41643>>>>>    
41643>>>>>    
41643>>>>>    
41643>>>>>    //AB-StoreEnd
41643>>>>>
41643>>>>>End_Object    // SL037
41644>>>>>
41644>>>>>
41644>>>>>//AB-StoreStart
41644>>>>>    
41644>>>>>//AB-StoreEnd
41644>>>>>
41644>>>>>//AB/ End_Object    // prj
41644>>>Use slnomism.sl      // slNomism
INCLUDING FILE: SLNOMISM.SL
41644>>>>>//AB/ Project slNomism
41644>>>>>//AB/ Object prj is a Lookup_Project
41644>>>>>//AB/     Set ProjectName to "slNomism"
41644>>>>>//AB/     Set ProjectFileName to "slNomism.SL"
41644>>>>>//AB/     Set GenerateFileName to "NONAME"
41644>>>>>
41644>>>>>// Project Object Structure
41644>>>>>//   slNomism is a dbModalPanelSub
41644>>>>>//     Nomisma_DD is a DataDictionary
41644>>>>>//     oSelList is a dbListSub
41644>>>>>//     oOK_bn is a ButtonSub
41644>>>>>//     oSearch_bn is a ButtonSub
41644>>>>>
41644>>>>>// Register all objects
41644>>>>>Register_Object Nomisma_DD
41644>>>>>Register_Object oOK_bn
41644>>>>>Register_Object oSearch_bn
41644>>>>>Register_Object oSelList
41644>>>>>Register_Object slNomism
41644>>>>>
41644>>>>>
41644>>>>>//AB-IgnoreStart
41644>>>>>
41644>>>>>Use DFAllEnt.pkg
41644>>>>>Use dbList.Sub
41644>>>>>Use Button.Sub
41644>>>>>
41644>>>>>
41644>>>>>Use NOMISMA.DD
INCLUDING FILE: NOMISMA.DD
41644>>>>>>>//DDB-FileStart
41644>>>>>>>//DDB-HeaderStart
41644>>>>>>>
41644>>>>>>>// File Name : NOMISMA.DD
41644>>>>>>>// Class Name: Nomisma_DataDictionary
41644>>>>>>>// Revision  : 52
41644>>>>>>>// Version   : 2
41644>>>>>>>
41644>>>>>>>Use  Windows           // Basic Definitions
41644>>>>>>>Use  DataDict          // DataDictionary Class Definition
41644>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41644>>>>>>>
41644>>>>>>>Open Nomisma
41646>>>>>>>Open Isotimia
41648>>>>>>>Open Particle
41650>>>>>>>
41650>>>>>>>//DDB-HeaderEnd
41650>>>>>>>//DDB-ValidationStart
41650>>>>>>>
41650>>>>>>>Register_Object Nomisma_Nomisma_Type_VT
41650>>>>>>>Register_Object Nomisma_Nomisma_Sign0_VT
41650>>>>>>>Register_Object Nomisma_Nomisma_Sign00_VT
41650>>>>>>>Register_Object Nomisma_Nomisma_Signr_VT
41650>>>>>>>
41650>>>>>>>Object Nomisma_Nomisma_Type_VT  is a DescriptionValidationTable
41652>>>>>>>
41652>>>>>>>    Procedure Fill_List
41654>>>>>>>        Forward Send Fill_List
41656>>>>>>>        Send Add_Table_Value  "1"  "Book1"
41657>>>>>>>        Send Add_Table_Value  "2"  "Book2"
41658>>>>>>>        Send Add_Table_Value  "3"  "Reporting"
41659>>>>>>>        Send Add_Table_Value  "0"  "Other"
41660>>>>>>>    End_Procedure    // Fill_List
41661>>>>>>>    //DDB-ValidationCustomStart
41661>>>>>>>    //DDB-ValidationCustomEnd
41661>>>>>>>End_Object   // Nomisma_Nomisma_Type_VT
41662>>>>>>>
41662>>>>>>>Object Nomisma_Nomisma_Sign0_VT  is a DescriptionValidationTable
41664>>>>>>>
41664>>>>>>>    Procedure Fill_List
41666>>>>>>>        Forward Send Fill_List
41668>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
41669>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
41670>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨œ¯ £¦"
41671>>>>>>>    End_Procedure    // Fill_List
41672>>>>>>>    //DDB-ValidationCustomStart
41672>>>>>>>    //DDB-ValidationCustomEnd
41672>>>>>>>End_Object   // Nomisma_Nomisma_Sign0_VT
41673>>>>>>>
41673>>>>>>>Object Nomisma_Nomisma_Sign00_VT  is a DescriptionValidationTable
41675>>>>>>>
41675>>>>>>>    Procedure Fill_List
41677>>>>>>>        Forward Send Fill_List
41679>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
41680>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
41681>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨â¯ £¦"
41682>>>>>>>    End_Procedure    // Fill_List
41683>>>>>>>    //DDB-ValidationCustomStart
41683>>>>>>>    //DDB-ValidationCustomEnd
41683>>>>>>>End_Object   // Nomisma_Nomisma_Sign00_VT
41684>>>>>>>
41684>>>>>>>Object Nomisma_Nomisma_Signr_VT  is a DescriptionValidationTable
41686>>>>>>>
41686>>>>>>>    Procedure Fill_List
41688>>>>>>>        Forward Send Fill_List
41690>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
41691>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
41692>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨â¯ £¦"
41693>>>>>>>    End_Procedure    // Fill_List
41694>>>>>>>    //DDB-ValidationCustomStart
41694>>>>>>>    //DDB-ValidationCustomEnd
41694>>>>>>>End_Object   // Nomisma_Nomisma_Signr_VT
41695>>>>>>>//DDB-ValidationEnd
41695>>>>>>>//DDB-SelectionStart
41695>>>>>>>//DDB/ ExternalSelectionList sl059  sl059.sl
41695>>>>>>>Register_Object sl059
41695>>>>>>>//DDB-SelectionEnd
41695>>>>>>>
41695>>>>>>>Class Nomisma_DataDictionary  is a DataDictionary_Sec
41696>>>>>>>
41696>>>>>>>    Procedure Construct_Object
41697>>>>>>>        Forward Send Construct_Object
41699>>>>>>>        Property String psOldCode Public ''
41700>>>>>>>    End_procedure
41701>>>>>>>
41701>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
41702>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
41704>>>>>>>        Set psOldCode to Nomisma.Nomisma_Code
41705>>>>>>>    End_Procedure   // New_Current_Record
41706>>>>>>>
41706>>>>>>>    Procedure Save_Main_File
41707>>>>>>>        If ((Operation_Origin<>Self) And;             (Nomisma.Recnum=0)) Procedure_Return
41710>>>>>>>        Forward Send Save_Main_File
41712>>>>>>>    End_Procedure   // Save_Main_File
41713>>>>>>>
41713>>>>>>>    Function Validate_Save  Returns Integer
41714>>>>>>>        Local Integer iReturnVal 
41715>>>>>>>        Forward Get Validate_Save  To iReturnVal
41717>>>>>>>        If (Not(iReturnVal)) ;            Begin
41719>>>>>>>                     If  Nomisma.nomisma_Code eq ''                 Move 6220 to iReturnVal
41722>>>>>>>                Else If (Nomisma.Nomisma_Code <>(psOldCode(Self)) And ;                         (psOldCode(Self)<>''))  Move 6030 to iReturnVal
41726>>>>>>>                if iReturnVal Send Operation_Not_Allowed iReturnVal
41729>>>>>>>            End
41729>>>>>>>>
41729>>>>>>>        Function_Return iReturnVal
41730>>>>>>>    End_Function   // Validate_Save
41731>>>>>>>
41731>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
41732>>>>>>>             if iError_num eq 6220 error 6220 "Œ¦£ ©£˜«˜ => ‰à› ¡æª ¡œ¤æª "
41735>>>>>>>        Else if iError_num eq 6030 error 6030 "„§ ¢â¥«œ ¤æ£ ©£˜ ˜§¦ «ž¤ ¢å©«˜ £œ (F4)\nž §˜«ã©«œ §¨é«˜ F5 ©«¦ ž›ž ¬§á¨®¦¤\nà©«œ ¤˜ ¡˜Ÿ˜¨å©œ  ž ˜¨® ¡ã «¦¬ « £ã\n§¨å¤ œ§ ¢â¥œ«œ á¢¢¦"
41739>>>>>>>        //Else if iError_num eq 6030 error 6030 "ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ©«¦ ¡à› ¡æ ¤¦£å©£˜«¦ª"
41739>>>>>>>        else Forward Send Operation_Not_Allowed  iError_Num
41742>>>>>>>    End_Procedure   // Operation_Not_Allowed
41743>>>>>>>
41743>>>>>>>    Procedure Update
41744>>>>>>>        Forward Send Update
41746>>>>>>>        // Insert Code Here
41746>>>>>>>        SYSDATE NOMISMA.LUP
41747>>>>>>>    End_Procedure   // Update
41748>>>>>>>
41748>>>>>>>    Procedure Creating
41749>>>>>>>        Forward Send Creating
41751>>>>>>>        // Insert Code Here
41751>>>>>>>        SYSDATE NOMISMA.FUP
41752>>>>>>>    End_Procedure   // Creating
41753>>>>>>>
41753>>>>>>>    // Define_Fields:
41753>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41753>>>>>>>
41753>>>>>>>    Procedure Define_Fields
41754>>>>>>>        Forward Send Define_Fields
41756>>>>>>>        //DDB-Generated-Code-Location
41756>>>>>>>        //DDB-DefineFieldStart
41756>>>>>>>
41756>>>>>>>        Set Main_File            To Nomisma.File_Number
41757>>>>>>>        Set Cascade_Delete_State To FALSE
41758>>>>>>>
41758>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41759>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41760>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41761>>>>>>>
41761>>>>>>>        // Child (Client) file structure................
41761>>>>>>>        Send Add_Client_File  Isotimia.File_Number
41762>>>>>>>        Send Add_Client_File  Particle.File_Number
41763>>>>>>>
41763>>>>>>>        // Field-based properties.......................
41763>>>>>>>
41763>>>>>>>        // Nomisma.Nomisma_Code
41763>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Code To DD_AUTOFIND    DD_CAPSLOCK   
41764>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Code To (sl059(Self))
41765>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Code To TRUE
41766>>>>>>>
41766>>>>>>>        // Nomisma.Nomisma_Descr
41766>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Descr To DD_CAPSLOCK   
41767>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Descr To (sl059(Self))
41768>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Descr To TRUE
41769>>>>>>>
41769>>>>>>>        // Nomisma.Nomisma_Short
41769>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Short To DD_CAPSLOCK   
41770>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Short To (sl059(Self))
41771>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Short To TRUE
41772>>>>>>>
41772>>>>>>>        // Nomisma.Dekadika
41772>>>>>>>
41772>>>>>>>        // Nomisma.Fup
41772>>>>>>>
41772>>>>>>>        // Nomisma.Lup
41772>>>>>>>
41772>>>>>>>        // Nomisma.Euro_Zone
41772>>>>>>>
41772>>>>>>>        // Nomisma.Einai_Drx
41772>>>>>>>
41772>>>>>>>        // Nomisma.Einai_Euro
41772>>>>>>>
41772>>>>>>>        // Nomisma.Monades
41772>>>>>>>
41772>>>>>>>        // Nomisma.Kl_Isot_Euro
41772>>>>>>>
41772>>>>>>>        // Nomisma.Nomisma_Type
41772>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Type To (Nomisma_Nomisma_Type_VT(Self))
41773>>>>>>>
41773>>>>>>>        // Nomisma.Nomisma_Sign0
41773>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Sign0 To (Nomisma_Nomisma_Sign0_VT(Self))
41774>>>>>>>
41774>>>>>>>        // Nomisma.Nomisma_Sign00
41774>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Sign00 To (Nomisma_Nomisma_Sign00_VT(Self))
41775>>>>>>>
41775>>>>>>>        // Nomisma.Nomisma_Signr
41775>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Signr To (Nomisma_Nomisma_Signr_VT(Self))
41776>>>>>>>
41776>>>>>>>        //DDB-DefineFieldEnd
41776>>>>>>>    End_Procedure    // Define_Fields
41777>>>>>>>
41777>>>>>>>    // Field_Defaults:
41777>>>>>>>    // This procedure is used to establish default field values.
41777>>>>>>>
41777>>>>>>>    Procedure Field_Defaults
41778>>>>>>>        Forward Send Field_Defaults
41780>>>>>>>        //DDB-Generated-Code-Location
41780>>>>>>>        //DDB-FieldDefaultStart
41780>>>>>>>        //DDB-FieldDefaultEnd
41780>>>>>>>    End_Procedure    // Field_Defaults
41781>>>>>>>
41781>>>>>>>End_Class    // Nomisma_DataDictionary
41782>>>>>>>//DDB-Selection-pkg-Start
41782>>>>>>>
41782>>>>>>>Use sl059.sl         // sl059
INCLUDING FILE: SL059.SL
41782>>>>>>>>>//AB/ Project sl059
41782>>>>>>>>>//AB/     Object prj is a LOOKUP_Project
41782>>>>>>>>>//AB/         Set ProjectName to "sl059"
41782>>>>>>>>>//AB/         Set ProjectFileName to "sl059.SL"
41782>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
41782>>>>>>>>>
41782>>>>>>>>>    //AB-IgnoreStart
41782>>>>>>>>>
41782>>>>>>>>>
41782>>>>>>>>>
41782>>>>>>>>>
41782>>>>>>>>>    Use NOMISMA.DD
41782>>>>>>>>>
41782>>>>>>>>>    //AB-IgnoreEnd
41782>>>>>>>>>
41782>>>>>>>>>    CD_Popup_Object sl059 is a dbModalPanelSub
41801>>>>>>>>>        Set Exit_Application_Local_State to FALSE
41802>>>>>>>>>        Set Modal_State to FALSE
41803>>>>>>>>>        Set Popup_State to FALSE
41804>>>>>>>>>        Set Minimize_Icon to FALSE
41805>>>>>>>>>        set label to "Œ¦£å©£˜«˜" 
41806>>>>>>>>>        Set Size to 148 295
41807>>>>>>>>>        Set Location to 4 5
41808>>>>>>>>>
41808>>>>>>>>>        //AB-DDOStart
41808>>>>>>>>>
41808>>>>>>>>>        Object Nomisma_DD is a Nomisma_DataDictionary
41810>>>>>>>>>        End_Object    // Nomisma_DD
41811>>>>>>>>>
41811>>>>>>>>>        Set Main_DD to (Nomisma_DD(Current_Object))
41812>>>>>>>>>        Set Server to (Nomisma_DD(Current_Object))
41813>>>>>>>>>
41813>>>>>>>>>        //AB-DDOEnd
41813>>>>>>>>>
41813>>>>>>>>>        Object oSelList is a dbListSub
41815>>>>>>>>>            Set Main_File to Nomisma.File_Number
41816>>>>>>>>>            Set Size to 105 278
41817>>>>>>>>>            Set Location to 6 6
41818>>>>>>>>>
41818>>>>>>>>>            Begin_Row
41821>>>>>>>>>                Entry_Item Nomisma.Nomisma_code
41822>>>>>>>>>                Entry_Item Nomisma.Nomisma_descr
41823>>>>>>>>>                Entry_Item Nomisma.Nomisma_short
41824>>>>>>>>>                Entry_Item Nomisma.Dekadika
41825>>>>>>>>>            End_Row
41830>>>>>>>>>
41830>>>>>>>>>            Set Form_Width    item 0 to 45
41831>>>>>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
41832>>>>>>>>>
41832>>>>>>>>>            Set Form_Width    item 1 to 115
41833>>>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
41834>>>>>>>>>
41834>>>>>>>>>            Set Form_Width    item 2 to 58
41835>>>>>>>>>            set header_label  item 2 to "‘ç¤«¦£ž" 
41836>>>>>>>>>
41836>>>>>>>>>            Set Form_Width    item 3 to 54
41837>>>>>>>>>            set header_label  item 3 to "ƒœ¡˜› ¡á" 
41838>>>>>>>>>
41838>>>>>>>>>        End_Object    // oSelList
41839>>>>>>>>>
41839>>>>>>>>>        Object oOK_bn is a ButtonSub
41841>>>>>>>>>            set label to "&„§ ¢¦šã" 
41842>>>>>>>>>            Set Location to 113 124
41843>>>>>>>>>
41843>>>>>>>>>            //AB-StoreStart
41843>>>>>>>>>            Procedure OnClick
41845>>>>>>>>>                Send OK To (oSelList(current_object))
41846>>>>>>>>>            End_Procedure
41847>>>>>>>>>            //AB-StoreEnd
41847>>>>>>>>>
41847>>>>>>>>>        End_Object    // oOK_bn
41848>>>>>>>>>
41848>>>>>>>>>        Object oCancel_bn is a ButtonSub
41850>>>>>>>>>            set label to "&€¡ç¨à©ž" 
41851>>>>>>>>>            Set Location to 113 179
41852>>>>>>>>>
41852>>>>>>>>>            //AB-StoreStart
41852>>>>>>>>>            Procedure OnClick
41854>>>>>>>>>                Send Cancel To (oSelList(current_object))
41855>>>>>>>>>            End_Procedure
41856>>>>>>>>>            //AB-StoreEnd
41856>>>>>>>>>
41856>>>>>>>>>        End_Object    // oCancel_bn
41857>>>>>>>>>
41857>>>>>>>>>        Object oSearch_bn is a ButtonSub
41859>>>>>>>>>            set label to "€&¤˜ã«ž©ž" 
41860>>>>>>>>>            Set Location to 113 234
41861>>>>>>>>>
41861>>>>>>>>>            //AB-StoreStart
41861>>>>>>>>>            Procedure OnClick
41863>>>>>>>>>                Send Search To (oSelList(current_object))
41864>>>>>>>>>            End_Procedure
41865>>>>>>>>>            //AB-StoreEnd
41865>>>>>>>>>
41865>>>>>>>>>        End_Object    // oSearch_bn
41866>>>>>>>>>
41866>>>>>>>>>
41866>>>>>>>>>        //AB-StoreStart
41866>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41867>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41868>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41869>>>>>>>>>        //AB-StoreEnd
41869>>>>>>>>>
41869>>>>>>>>>    CD_End_Object    // sl059
41871>>>>>>>>>>
41871>>>>>>>>>
41871>>>>>>>>>//AB/     End_Object    // prj
41871>>>>>>>
41871>>>>>>>//DDB-Selection-pkg-End
41871>>>>>>>//DDB-FileEnd
41871>>>>>
41871>>>>>//AB-IgnoreEnd
41871>>>>>
41871>>>>>Object slNomism is a dbModalPanelSub
41873>>>>>
41873>>>>>    //AB-StoreTopStart
41873>>>>>    
41873>>>>>    
41873>>>>>    
41873>>>>>    //AB-StoreTopEnd
41873>>>>>
41873>>>>>    Set Label to "Œ¦£å©£˜«˜"
41874>>>>>    Set Size to 175 397
41875>>>>>    Set Location to 5 7
41876>>>>>    Set Exit_Application_Local_State to FALSE
41877>>>>>    Set Modal_State to FALSE
41878>>>>>
41878>>>>>    //AB-DDOStart
41878>>>>>
41878>>>>>    Object Nomisma_DD is a Nomisma_DataDictionary
41880>>>>>    End_Object    // Nomisma_DD
41881>>>>>
41881>>>>>    Set Main_DD to (Nomisma_DD(self))
41882>>>>>    Set Server to (Nomisma_DD(self))
41883>>>>>
41883>>>>>    //AB-DDOEnd
41883>>>>>
41883>>>>>    Object oSelList is a dbListSub
41885>>>>>        Set Main_File to Nomisma.File_Number
41886>>>>>        Set Size to 130 382
41887>>>>>        Set Location to 6 6
41888>>>>>
41888>>>>>        Begin_Row
41891>>>>>            Entry_Item Nomisma.Nomisma_code
41892>>>>>            Entry_Item Nomisma.Nomisma_descr
41893>>>>>            Entry_Item Nomisma.Dekadika
41894>>>>>            Entry_Item Nomisma.Euro_zone
41895>>>>>            Entry_Item Nomisma.Einai_drx
41896>>>>>            Entry_Item Nomisma.Einai_euro
41897>>>>>        End_Row
41902>>>>>
41902>>>>>        Set Form_Width    item 0 to 49
41903>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
41904>>>>>        
41904>>>>>        Set Form_Width    item 1 to 115
41905>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
41906>>>>>        
41906>>>>>        Set Form_Width    item 2 to 47
41907>>>>>        Set Header_Label  item 2 to "ƒœ¡˜› ¡á"
41908>>>>>        
41908>>>>>        Set Form_Width    item 3 to 55
41909>>>>>        Set Header_Label  item 3 to "…é¤ž EURO"
41910>>>>>        Set Column_Checkbox_State  item 3 to True
41911>>>>>        
41911>>>>>        Set Form_Width    item 4 to 55
41912>>>>>        Set Header_Label  item 4 to "„å¤˜  ƒ•"
41913>>>>>        Set Column_Checkbox_State  item 4 to True
41914>>>>>        
41914>>>>>        Set Form_Width    item 5 to 55
41915>>>>>        Set Header_Label  item 5 to "„å¤˜  „¬¨é"
41916>>>>>        Set Column_Checkbox_State  item 5 to True
41917>>>>>        
41917>>>>>
41917>>>>>        //AB-StoreStart
41917>>>>>        
41917>>>>>        //AB-StoreEnd
41917>>>>>
41917>>>>>    End_Object    // oSelList
41918>>>>>
41918>>>>>    Object oOK_bn is a ButtonSub
41920>>>>>        Set Label to "&„§ ¢¦šã"
41921>>>>>        Set Location to 140 279
41922>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
41923>>>>>
41923>>>>>        //AB-StoreStart
41923>>>>>        Procedure OnClick
41925>>>>>            Send OK To (oSelList(current_object))
41926>>>>>        End_Procedure
41927>>>>>        //AB-StoreEnd
41927>>>>>
41927>>>>>    End_Object    // oOK_bn
41928>>>>>
41928>>>>>    Object oSearch_bn is a ButtonSub
41930>>>>>        Set Label to "€&¤˜ã«ž©ž"
41931>>>>>        Set Location to 140 339
41932>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
41933>>>>>
41933>>>>>        //AB-StoreStart
41933>>>>>        
41933>>>>>        Procedure OnClick
41935>>>>>            Send Search To (oSelList(current_object))
41936>>>>>        End_Procedure
41937>>>>>        
41937>>>>>        
41937>>>>>        Set Visible_State to False
41938>>>>>        Set Enabled_State to False
41939>>>>>        //AB-StoreEnd
41939>>>>>
41939>>>>>    End_Object    // oSearch_bn
41940>>>>>
41940>>>>>
41940>>>>>    //AB-StoreStart
41940>>>>>    
41940>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41941>>>>>    
41941>>>>>    On_Key Key_Alt+Key_s Send KeyAction To (oSearch_bn(current_object))
41942>>>>>    
41942>>>>>    
41942>>>>>    
41942>>>>>    
41942>>>>>    //AB-StoreEnd
41942>>>>>
41942>>>>>End_Object    // slNomism
41943>>>>>
41943>>>>>//AB/ End_Object    // prj
41943>>>
41943>>>//DDB-Selection-pkg-End
41943>>>//DDB-FileEnd
41943>        
41943>        
41943>        Function fngConvertPoso Global String asNomismaCodeApo Number anPoso ;                                       String asNomismaCodeSe  Date   adHmnia;                                       Number nIsotimia  Returns Number
41944>        
41944>            Number rVal nApo_Euro_Isot nSe_Euro_Isot
41945>            Integer iApo_Einai_Euro_Zone iApo_Einai_DRX iApo_Einai_Euro iDekadika_Apo
41945>            Integer iSe_Einai_Euro_Zone  iSe_Einai_DRX  iSe_Einai_Euro  iDekadika_Se
41945>            String  sCode
41945>        
41945>            If (asNomismaCodeApo=asNomismaCodeSe) Function_Return anPoso
41948>        
41948>            Clear Nomisma
41949>            Move (Trim(asNomismaCodeApo)) to Nomisma.Nomisma_Code
41950>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
41951>            Move Nomisma.Euro_Zone      to iApo_Einai_Euro_Zone
41952>            Move Nomisma.Einai_DRX      to iApo_Einai_DRX
41953>            Move Nomisma.Einai_EURO     to iApo_Einai_Euro
41954>            Move Nomisma.KL_ISOT_EURO   to nApo_Euro_Isot
41955>            Move Nomisma.Dekadika       to iDekadika_Apo
41956>            // 1. An to nomisma APO den einai ths zonhs euro prepei na vrethei h isotimia tou
41956>            If ((NOT(iApo_Einai_Euro_Zone)) And (nApo_Euro_Isot=0))  Begin
41958>                If (adHmnia='') Sysdate            adHmnia
41961>                Move (Trim(asNomismaCodeApo))   to sCode
41962>                Clear Isotimia
41963>                Move sCode                      to Isotimia.Nomisma_Code
41964>                Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
41965>                Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
41966>                Move Isotimia.Isotimia_Euro     to nApo_Euro_Isot
41967>            End
41967>        
41967>            Clear Nomisma
41968>            Move (Trim(asNomismaCodeSe)) to Nomisma.Nomisma_Code
41969>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
41970>            Move Nomisma.Euro_Zone      to iSe_Einai_Euro_Zone
41971>            Move Nomisma.Einai_DRX      to iSe_Einai_DRX
41972>            Move Nomisma.Einai_EURO     to iSe_Einai_Euro
41973>            Move Nomisma.KL_ISOT_EURO   to nSe_Euro_Isot
41974>            Move Nomisma.Dekadika       to iDekadika_Se
41975>            // 2. An to nomisma SE den einai ths zonhs euro prepei na vrethei h isotimia tou
41975>            If ((NOT(iSe_Einai_Euro_Zone)) And (nSe_Euro_Isot=0)) Begin
41977>                If (adHmnia='') Sysdate            adHmnia
41980>                Move (Trim(asNomismaCodeSe))    to sCode
41981>                Clear Isotimia
41982>                Move sCode                      to Isotimia.Nomisma_Code
41983>                Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
41984>                Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
41985>                Move Isotimia.Isotimia_Euro     to nSe_Euro_Isot
41986>            End
41986>        
41986>            Calc (anPoso/nApo_Euro_Isot) to rVal
41987>            Move (Round_Number(rVal,6)) to rVal
41988>            Calc (rVal*nSe_Euro_Isot) to rVal
41989>            Move (Round_Number(rVal,iDekadika_Se)) to rVal
41990>        
41990>            Function_Return rVal
41991>        End_Function
41992>        
41992>        Use Tranlock.pkg
INCLUDING FILE: TRANLOCK.PKG
41992>>>// Statement of purpose:
41992>>>// When using a reread command in VDF you will unfortunately lock many more
41992>>>// files than are necessary.  In order to only lock the files necessary I
41992>>>// use the following procedure to set all files to readonly, manually set
41992>>>// the files being worked on to (default) and then reset all back at the end.
41992>>>// This is what a data dictionary does in a VDF program for it's ddo tree.
41992>>>
41992>>>// The original package is a contribution of another programmer whom I cannot
41992>>>// remember their name (sorry).  The alteration I have done is to make sure that any file
41992>>>// with a non-default filemode will be set back to it's previous setting.
41992>>>
41992>>>Object FileModeArray Is An Array
41994>>>    // 0 = File Number
41994>>>    // 1 = Non-Default FileMode Existing Before Change By ChangeAllFileModes Procedure
41994>>>End_Object
41995>>>
41995>>>Procedure Write_Attribute_Array Integer iFile Integer iFileMode
41997>>>    Integer iCounter hArray iExists
41998>>>    Move (FileModeArray(Self)) To hArray
41999>>>    For iCounter From 0 To 1000
42005>>>>
42005>>>        Get Array_Value Of hArray Item ((iCounter * 2) + 0) To iExists
42006>>>        If (Not(iExists) Or (iExists = iFile)) Begin
42008>>>            Set Array_Value Of hArray Item ((iCounter * 2) + 0) To iFile
42009>>>            Set Array_Value Of hArray Item ((iCounter * 2) + 1) To iFileMode
42010>>>        End
42010>>>>
42010>>>        If (Not(iExists) Or (iExists = iFile)) Break
42013>>>    Loop
42014>>>>
42014>>>End_Procedure
42015>>>
42015>>>Procedure Clear_FileModeArray
42017>>>    Send Delete_Data To (FileModeArray(Self))
42018>>>End_Procedure
42019>>>
42019>>>Function Is_NonStandardFileMode Integer iFile Returns Integer
42021>>>    Integer iCounter iExists iNonStandardFileMode hArray
42022>>>    Move (FileModeArray(Self)) To hArray
42023>>>    For iCounter From 0 To 1000
42029>>>>
42029>>>        Get Array_Value Of hArray Item ((iCounter * 2) + 0) To iExists
42030>>>        If (Not(iExists)) Function_Return 0 // Not Listed In Array
42033>>>        If (iExists = iFile) Begin
42035>>>            Get Array_Value Of hArray Item ((iCounter * 2) + 1) To iNonStandardFileMode
42036>>>            Function_Return iNonStandardFileMode
42037>>>        End
42037>>>>
42037>>>    Loop
42038>>>>
42038>>>    Function_Return
42039>>>End_Function
42040>>>
42040>>>Procedure ChangeAllFileModes Integer iMode
42042>>>    Integer iFile iExistingFileMode iNonStandardFileMode
42043>>>    If (iMode = DF_FileMode_ReadOnly) Send Clear_FileModeArray
42046>>>    Repeat
42046>>>>
42046>>>        // Get Each Opened File, One At A Time...
42046>>>        Get_Attribute DF_File_Next_Opened Of iFile To iFile
42049>>>        If (Not(iFile)) Break
42052>>>        If (iMode = DF_Filemode_ReadOnly) Begin  // Setting All Files To Readonly: Check Alias Stuff
42054>>>            Get_Attribute DF_File_Mode Of iFile To iExistingFileMode
42057>>>            If (iExistingFileMode <> DF_Filemode_Default) Send Write_Attribute_Array iFile iExistingFileMode
42060>>>        End
42060>>>>
42060>>>        If (iMode = DF_Filemode_Default) Begin  // Setting All Files Back To Default
42062>>>            Get Is_NonStandardFileMode iFile To iNonStandardFileMode
42063>>>        End
42063>>>>
42063>>>        If (iNonStandardFileMode) Set_Attribute DF_File_Mode Of iFile To iNonStandardFileMode
42068>>>        Else                      Set_Attribute DF_File_Mode Of iFile To iMode
42072>>>    Loop
42073>>>>
42073>>>End_Procedure
42074>>>
42074>>>// // Comment: Example Of Usage:
42074>>>//    Send ChangeAllFileModes DF_Filemode_ReadOnly  // See Stark.Pkg for This Desktop Procedure
42074>>>// // Comment: Set All Open Files To ReadOnly Except For... (Files Used In Transaction Block)
42074>>>//    Set_Attribute DF_File_Mode Of MyFile1.File_Number To DF_Filemode_Default
42074>>>//    Set_Attribute DF_File_Mode Of MyFile2.File_Number  To DF_Filemode_Default
42074>>>//    Indicate Err False
42074>>>//    Begin_Transaction
42074>>>//
42074>>>//        Clear MyFile1
42074>>>//        Move 1 To MyFile1.Key
42074>>>//        Find EQ MyFile1 By Index.1
42074>>>//        Relate MyFile1
42074>>>//        Add MyFile2.Amount To MyFile1.Amount
42074>>>//        Saverecord MyFile1
42074>>>//        Saverecord MyFile2
42074>>>//        If (Condition) Error 300 "Error Message Here" // Saves Rolled Back
42074>>>//
42074>>>//    End_Transaction
42074>>>//    If (Err) Begin
42074>>>//        Send Info_Box "Errors Were Encountered: No Files Were Altered By This Process (All Changes Rolled Back)"
42074>>>//    End
42074>>>//    Send ChangeAllFileModes DF_Filemode_Default  // Set FileModes Back From Readonly To Normal
42074>        
42074>        //AB-ClientStoreTopEnd
42074>
42074>        //  Include all views
42074>        Use Lists2.VW                                                                       
INCLUDING FILE: LISTS2.VW
42074>>>//AB/ Project Lists2 - FormulaArray
42074>>>//AB/     Object prj is a View_Project
42074>>>//AB/         Set ProjectName to "Lists2 - FormulaArray"
42074>>>//AB/         Set ProjectFileName to "Lists2.VW"
42074>>>//AB/         Set GenerateFileName to "NONAME"
42074>>>
42074>>>// Project Object Structure
42074>>>//   Lists2 is a dbViewSubs
42074>>>//     frmKey is a FormSub
42074>>>//     oFormArrList1 is a ListSub
42074>>>//     oFormArrList2 is a ListSub
42074>>>//     oFormArrList3 is a ListSub
42074>>>//     oFormArrList4 is a ListSub
42074>>>//     oFormArrList5 is a ListSub
42074>>>//     oFormArrList6 is a ListSub
42074>>>//     oFormArrList7 is a ListSub
42074>>>//     oFormArrList8 is a ListSub
42074>>>
42074>>>// Register all objects
42074>>>Register_Object frmKey
42074>>>Register_Object Lists2
42074>>>Register_Object oFormArrList1
42074>>>Register_Object oFormArrList2
42074>>>Register_Object oFormArrList3
42074>>>Register_Object oFormArrList4
42074>>>Register_Object oFormArrList5
42074>>>Register_Object oFormArrList6
42074>>>Register_Object oFormArrList7
42074>>>Register_Object oFormArrList8
42074>>>
42074>>>
42074>>>//AB/     AppBuild VIEW
42074>>>
42074>>>
42074>>>    //AB-StoreTopStart
42074>>>    
42074>>>    Use FormlArr.DD
INCLUDING FILE: FORMLARR.DD
42074>>>>>//DDB-FileStart
42074>>>>>//DDB-HeaderStart
42074>>>>>
42074>>>>>// File Name : FORMLARR.DD
42074>>>>>// Class Name: Formlarr_DataDictionary
42074>>>>>// Revision  : 0
42074>>>>>// Version   : 2
42074>>>>>
42074>>>>>Use  Windows           // Basic Definitions
42074>>>>>Use  DataDict          // DataDictionary Class Definition
42074>>>>>Use  DDvalTbl          // Validation Table Class Definitions
42074>>>>>
42074>>>>>Open Formlarr
INCLUDING FILE: FORMLARR.FD
42076>>>>>
42076>>>>>//DDB-HeaderEnd
42076>>>>>
42076>>>>>Class Formlarr_DataDictionary  is a DataDictionary_sec
42077>>>>>
42077>>>>>    // Define_Fields:
42077>>>>>    // This procedure is used to set up all data-dictionary rules.
42077>>>>>
42077>>>>>    Procedure Define_Fields
42078>>>>>        Forward Send Define_Fields
42080>>>>>        //DDB-Generated-Code-Location
42080>>>>>        //DDB-DefineFieldStart
42080>>>>>
42080>>>>>        Set Main_File            To Formlarr.File_Number
42081>>>>>
42081>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
42082>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
42083>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
42084>>>>>
42084>>>>>        // Field-based properties.......................
42084>>>>>
42084>>>>>        // Formlarr.Formarr_Id
42084>>>>>
42084>>>>>        // Formlarr.Formarr_Array
42084>>>>>
42084>>>>>        // Formlarr.Formarr_Descr
42084>>>>>
42084>>>>>        //DDB-DefineFieldEnd
42084>>>>>    End_Procedure    // Define_Fields
42085>>>>>
42085>>>>>    // Field_Defaults:
42085>>>>>    // This procedure is used to establish default field values.
42085>>>>>
42085>>>>>    Procedure Field_Defaults
42086>>>>>        Forward Send Field_Defaults
42088>>>>>        //DDB-Generated-Code-Location
42088>>>>>        //DDB-FieldDefaultStart
42088>>>>>        //DDB-FieldDefaultEnd
42088>>>>>    End_Procedure    // Field_Defaults
42089>>>>>
42089>>>>>End_Class    // Formlarr_DataDictionary
42090>>>>>//DDB-FileEnd
42090>>>    
42090>>>    //AB-StoreTopEnd
42090>>>
42090>>>    //AB-IgnoreStart
42090>>>
42090>>>    Use dbViews.Sub
42090>>>    Use Form.Sub
42090>>>    Use List.Sub
42090>>>
42090>>>    //AB-IgnoreEnd
42090>>>
42090>>>    ACTIVATE_VIEW Activate_Lists2 FOR Lists2
42094>>>
42094>>>    Object Lists2 is a dbViewSubs
42096>>>
42096>>>        //AB-StoreTopStart
42096>>>        
42096>>>        //AB-StoreTopEnd
42096>>>
42096>>>        Set Label to "Formula Array Selections"
42097>>>        Set Size to 287 449
42098>>>        Set Location to 1 4
42099>>>
42099>>>        //AB-DDOStart
42099>>>
42099>>>
42099>>>        //AB-DDOEnd
42099>>>
42099>>>        Object frmKey is a FormSub
42101>>>            Set Size to 13 374
42102>>>            Set Location to 22 35
42103>>>            Set Label_Col_Offset to 2
42104>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
42105>>>        End_Object    // frmKey
42106>>>
42106>>>        Object oFormArrList1 is a ListSub
42108>>>
42108>>>            //AB-StoreTopStart
42108>>>            
42108>>>            //AB-StoreTopEnd
42108>>>
42108>>>            Set Size to 93 91
42109>>>            Set Location to 56 14
42110>>>            Set Color to 15794175
42111>>>            Set TextColor to clNavy
42112>>>            Set Label_Col_Offset to 0
42113>>>            Set Label_Row_Offset to 1
42114>>>            Set Label_Justification_Mode to jMode_Top
42115>>>
42115>>>            //AB-StoreStart
42115>>>            
42115>>>            procedure mouse_Down integer window integer char_pos
42117>>>                local integer hDD srv1# cr# srv2#
42118>>>                forward send mouse_Down window char_pos
42120>>>                Send ReconstructString
42121>>>            end_procedure
42122>>>            
42122>>>            //Set Color       to 15263976
42122>>>            Set TextColor   to clNavy
42123>>>            Set Select_Mode to Single_Select
42124>>>            
42124>>>            // Set Form_color item iCount to clPurple clBtnFace
42124>>>            
42124>>>            
42124>>>            
42124>>>            //AB-StoreEnd
42124>>>
42124>>>        End_Object    // oFormArrList1
42125>>>
42125>>>        Object oFormArrList2 is a ListSub
42127>>>
42127>>>            //AB-StoreTopStart
42127>>>            
42127>>>            //AB-StoreTopEnd
42127>>>
42127>>>            Set Size to 93 91
42128>>>            Set Location to 56 123
42129>>>            Set Color to 15794175
42130>>>            Set Label_Col_Offset to 0
42131>>>            Set Label_Row_Offset to 1
42132>>>            Set Label_Justification_Mode to jMode_Top
42133>>>
42133>>>            //AB-StoreStart
42133>>>            
42133>>>            procedure mouse_Down integer window integer char_pos
42135>>>                local integer hDD srv1# cr# srv2#
42136>>>                forward send mouse_Down window char_pos
42138>>>                Send ReconstructString
42139>>>            end_procedure
42140>>>            
42140>>>            //Set Color       to 15263976
42140>>>            Set TextColor   to clNavy
42141>>>            Set Select_Mode to Single_Select
42142>>>            
42142>>>            
42142>>>            
42142>>>            //AB-StoreEnd
42142>>>
42142>>>        End_Object    // oFormArrList2
42143>>>
42143>>>        Object oFormArrList3 is a ListSub
42145>>>
42145>>>            //AB-StoreTopStart
42145>>>            
42145>>>            //AB-StoreTopEnd
42145>>>
42145>>>            Set Size to 93 91
42146>>>            Set Location to 56 229
42147>>>            Set Color to 15794175
42148>>>            Set Label_Col_Offset to 0
42149>>>            Set Label_Row_Offset to 1
42150>>>            Set Label_Justification_Mode to jMode_Top
42151>>>
42151>>>            //AB-StoreStart
42151>>>            
42151>>>            procedure mouse_Down integer window integer char_pos
42153>>>                local integer hDD srv1# cr# srv2#
42154>>>                forward send mouse_Down window char_pos
42156>>>                Send ReconstructString
42157>>>            end_procedure
42158>>>            
42158>>>            //Set Color       to 15263976
42158>>>            Set TextColor   to clNavy
42159>>>            Set Select_Mode to Single_Select
42160>>>            
42160>>>            
42160>>>            
42160>>>            //AB-StoreEnd
42160>>>
42160>>>        End_Object    // oFormArrList3
42161>>>
42161>>>        Object oFormArrList4 is a ListSub
42163>>>
42163>>>            //AB-StoreTopStart
42163>>>            
42163>>>            //AB-StoreTopEnd
42163>>>
42163>>>            Set Size to 93 91
42164>>>            Set Location to 56 335
42165>>>            Set Color to 15794175
42166>>>            Set Label_Col_Offset to 0
42167>>>            Set Label_Row_Offset to 1
42168>>>            Set Label_Justification_Mode to jMode_Top
42169>>>
42169>>>            //AB-StoreStart
42169>>>            
42169>>>            procedure mouse_Down integer window integer char_pos
42171>>>                local integer hDD srv1# cr# srv2#
42172>>>                forward send mouse_Down window char_pos
42174>>>                Send ReconstructString
42175>>>            end_procedure
42176>>>            
42176>>>            //Set Color       to 15263976
42176>>>            Set TextColor   to clNavy
42177>>>            Set Select_Mode to Single_Select
42178>>>            
42178>>>            
42178>>>            
42178>>>            //AB-StoreEnd
42178>>>
42178>>>        End_Object    // oFormArrList4
42179>>>
42179>>>        Object oFormArrList5 is a ListSub
42181>>>
42181>>>            //AB-StoreTopStart
42181>>>            
42181>>>            //AB-StoreTopEnd
42181>>>
42181>>>            Set Size to 93 91
42182>>>            Set Location to 162 14
42183>>>            Set Color to 15794175
42184>>>            Set Label_Col_Offset to 0
42185>>>            Set Label_Row_Offset to 1
42186>>>            Set Label_Justification_Mode to jMode_Top
42187>>>
42187>>>            //AB-StoreStart
42187>>>            
42187>>>            procedure mouse_Down integer window integer char_pos
42189>>>                local integer hDD srv1# cr# srv2#
42190>>>                forward send mouse_Down window char_pos
42192>>>                Send ReconstructString
42193>>>            end_procedure
42194>>>            
42194>>>            //Set Color       to 15263976
42194>>>            Set TextColor   to clNavy
42195>>>            Set Select_Mode to Single_Select
42196>>>            
42196>>>            
42196>>>            
42196>>>            //AB-StoreEnd
42196>>>
42196>>>        End_Object    // oFormArrList5
42197>>>
42197>>>        Object oFormArrList6 is a ListSub
42199>>>
42199>>>            //AB-StoreTopStart
42199>>>            
42199>>>            //AB-StoreTopEnd
42199>>>
42199>>>            Set Size to 93 91
42200>>>            Set Location to 162 123
42201>>>            Set Color to 15794175
42202>>>            Set Label_Col_Offset to 0
42203>>>            Set Label_Row_Offset to 1
42204>>>            Set Label_Justification_Mode to jMode_Top
42205>>>
42205>>>            //AB-StoreStart
42205>>>            
42205>>>            procedure mouse_Down integer window integer char_pos
42207>>>                local integer hDD srv1# cr# srv2#
42208>>>                forward send mouse_Down window char_pos
42210>>>                Send ReconstructString
42211>>>            end_procedure
42212>>>            
42212>>>            //Set Color       to 15263976
42212>>>            Set TextColor   to clNavy
42213>>>            Set Select_Mode to Single_Select
42214>>>            
42214>>>            
42214>>>            
42214>>>            //AB-StoreEnd
42214>>>
42214>>>        End_Object    // oFormArrList6
42215>>>
42215>>>        Object oFormArrList7 is a ListSub
42217>>>
42217>>>            //AB-StoreTopStart
42217>>>            
42217>>>            //AB-StoreTopEnd
42217>>>
42217>>>            Set Size to 93 91
42218>>>            Set Location to 162 229
42219>>>            Set Color to 15794175
42220>>>            Set Label_Col_Offset to 0
42221>>>            Set Label_Row_Offset to 1
42222>>>            Set Label_Justification_Mode to jMode_Top
42223>>>
42223>>>            //AB-StoreStart
42223>>>            
42223>>>            procedure mouse_Down integer window integer char_pos
42225>>>                local integer hDD srv1# cr# srv2#
42226>>>                forward send mouse_Down window char_pos
42228>>>                Send ReconstructString
42229>>>            end_procedure
42230>>>            
42230>>>            //Set Color       to 15263976
42230>>>            Set TextColor   to clNavy
42231>>>            Set Select_Mode to Single_Select
42232>>>            
42232>>>            
42232>>>            
42232>>>            //AB-StoreEnd
42232>>>
42232>>>        End_Object    // oFormArrList7
42233>>>
42233>>>        Object oFormArrList8 is a ListSub
42235>>>
42235>>>            //AB-StoreTopStart
42235>>>            
42235>>>            //AB-StoreTopEnd
42235>>>
42235>>>            Set Size to 93 91
42236>>>            Set Location to 162 335
42237>>>            Set Color to 15794175
42238>>>            Set Label_Col_Offset to 0
42239>>>            Set Label_Row_Offset to 1
42240>>>            Set Label_Justification_Mode to jMode_Top
42241>>>
42241>>>            //AB-StoreStart
42241>>>            
42241>>>            procedure mouse_Down integer window integer char_pos
42243>>>                local integer hDD srv1# cr# srv2#
42244>>>                forward send mouse_Down window char_pos
42246>>>                Send ReconstructString
42247>>>            end_procedure
42248>>>            
42248>>>            //Set Color       to 15263976
42248>>>            Set TextColor   to clNavy
42249>>>            Set Select_Mode to Single_Select
42250>>>            
42250>>>            
42250>>>            
42250>>>            //AB-StoreEnd
42250>>>
42250>>>        End_Object    // oFormArrList8
42251>>>
42251>>>
42251>>>        //AB-StoreStart
42251>>>        
42251>>>        Function ScanList Integer aiID Returns String
42253>>>            String sValue
42254>>>            Integer iItemCount i
42254>>>            Move "" to sValue
42255>>>            Move (Item_Count(aiID)) to iItemCount
42256>>>            Move "" to sValue
42257>>>            For i from 0 to (iItemCount-1)
42263>>>>
42263>>>                If (Select_state(aiID,i)) Begin
42265>>>                    Get Value Of aiID Item i to sValue
42266>>>                    Function_Return (ToOEM(Trim(sValue)))
42267>>>                End
42267>>>>
42267>>>            Loop
42268>>>>
42268>>>            Function_Return sValue
42269>>>        End_Procedure
42270>>>        
42270>>>        
42270>>>        Procedure Fill_The_Lists integer aiListID String asConstrainFilter
42272>>>            Integer iFS iCount
42273>>>            File_Size FormlArr to iFS
42276>>>            Send Delete_Data Of aiListID
42277>>>            Send Add_Item to aiListID Msg_None ""
42278>>>            Clear FormlArr
42279>>>            Move asConstrainFilter to FormlArr.FormArr_ID
42280>>>            Find GE FormlArr By Index.1
42281>>>>
42281>>>            While ((Found) And (FormlArr.FormArr_ID=asConstrainFilter))
42285>>>                Send Add_Item to aiListID Msg_None (ToAnsi(Trim(FormlArr.FormArr_Descr)))
42286>>>                Find GT FormlArr By Index.1
42287>>>>
42287>>>            Loop
42288>>>>
42288>>>        End_Procedure
42289>>>        
42289>>>        Procedure Activate_View Returns Integer
42291>>>            Integer rVal i iID
42292>>>            Forward Get Msg_Activate_View to rVal
42294>>>            For i from 1 to 8
42300>>>>
42300>>>                String sObj
42300>>>                Move ("(oFormArrList"+String(i)+"(Self))") to sObj
42301>>>                Move (EVAL(sObj)) to iID
42302>>>                Send Fill_The_Lists iID (String(i-1))
42303>>>            Loop
42304>>>>
42304>>>            Procedure_Return rVal
42305>>>        End_Procedure
42306>>>        
42306>>>        Procedure ReconstructString
42308>>>            String s1 s2 s3 s4 s5 s6 s7 s8 sValue sSep sAll
42309>>>            Integer iItemCount iSelectedCount i iID
42309>>>            Move "_" to sSep
42310>>>            Move "" to sValue
42311>>>        
42311>>>        //==========================
42311>>>        // SOS WORKING PERFECTLY 1
42311>>>        //    Move (Item_Count(oFormArrList1(Self))) to iItemCount
42311>>>        //    Move "" to sValue
42311>>>        //    For i from 0 to (iItemCount-1)
42311>>>        //        If (Select_state(oFormArrList1(Self),i)) Begin
42311>>>        //            Get Value Of oFormArrList1 Item i to sValue
42311>>>        //            Move (Trim(sValue)) to s1
42311>>>        //            Break
42311>>>        //        End
42311>>>        //    Loop
42311>>>        //==========================
42311>>>        
42311>>>        //==========================
42311>>>        // SOS WORKING PERFECTLY 2
42311>>>        //    Move (oFormArrList1(Self))  to iID
42311>>>        //    //Move (ScanList(iID,Self))   to s1
42311>>>        //    Move (Item_Count(oFormArrList1(Self))) to iItemCount
42311>>>        //    Move "" to sValue
42311>>>        //    For i from 0 to (iItemCount-1)
42311>>>        //        If (Select_state(iID,i)) Begin
42311>>>        //            Get Value Of iID Item i to sValue
42311>>>        //            Move (ToOEM(Trim(sValue))) to s1
42311>>>        //            Break
42311>>>        //        End
42311>>>        //    Loop
42311>>>        //==========================
42311>>>        
42311>>>            Move (oFormArrList1(Self))  to iID
42312>>>            Move (ScanList(Self,iID))   to s1
42313>>>            Move (oFormArrList2(Self))  to iID
42314>>>            Move (ScanList(Self,iID))   to s2
42315>>>            Move (oFormArrList3(Self))  to iID
42316>>>            Move (ScanList(Self,iID))   to s3
42317>>>            Move (oFormArrList4(Self))  to iID
42318>>>            Move (ScanList(Self,iID))   to s4
42319>>>            Move (oFormArrList5(Self))  to iID
42320>>>            Move (ScanList(Self,iID))   to s5
42321>>>            Move (oFormArrList6(Self))  to iID
42322>>>            Move (ScanList(Self,iID))   to s6
42323>>>            Move (oFormArrList7(Self))  to iID
42324>>>            Move (ScanList(Self,iID))   to s7
42325>>>            Move (oFormArrList8(Self))  to iID
42326>>>            Move (ScanList(Self,iID))   to s8
42327>>>        
42327>>>            If (Trim(s1)<>"") Append sAll (Trim(s1)) sSep
42331>>>            If (Trim(s2)<>"") Append sAll (Trim(s2)) sSep
42335>>>            If (Trim(s3)<>"") Append sAll (Trim(s3)) sSep
42339>>>            If (Trim(s4)<>"") Append sAll (Trim(s4)) sSep
42343>>>            If (Trim(s5)<>"") Append sAll (Trim(s5)) sSep
42347>>>            If (Trim(s6)<>"") Append sAll (Trim(s6)) sSep
42351>>>            If (Trim(s7)<>"") Append sAll (Trim(s7)) sSep
42355>>>            If (Trim(s8)<>"") Append sAll (Trim(s8))
42358>>>        
42358>>>            If (sAll=sSep) Move "" to sAll
42361>>>            If (Right(sAll,1)=sSep) Move (Left(sAll,Length(sAll)-1)) to sAll
42364>>>        
42364>>>            Set Value Of frmKey Item 0 to (Trim(sAll))
42365>>>        End_Procedure
42366>>>        
42366>>>        
42366>>>        
42366>>>        
42366>>>        
42366>>>        
42366>>>        
42366>>>        //AB-StoreEnd
42366>>>
42366>>>    End_Object    // Lists2
42367>>>
42367>>>
42367>>>    //AB-StoreStart
42367>>>    
42367>>>    //AB-StoreEnd
42367>>>
42367>>>//AB/     End_Object    // prj
42367>
42367>        //AB-ClientStoreStart
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        
42367>        //AB-ClientStoreEnd
42367>
42367>
42367>    End_Object  // Client_Area
42368>    
42368>    Use DFStdSbr.pkg //  Status-Bar object.
INCLUDING FILE: DFSTDSBR.PKG
42368>>>// 07/23/96 JJT - New Class names
42368>>>// Very prototype global status bar
42368>>>//
42368>>>Use dfMainSt.pkg
INCLUDING FILE: DFMAINST.PKG
42368>>>>>// 07/23/96 JJT - New Class names
42368>>>>>Use dfAstbar.pkg
42368>>>>>
42368>>>>>Class StatusBar is a AppStatusBar
42369>>>>>
42369>>>>>    Procedure Construct_Object
42370>>>>>       Forward Send Construct_Object
42372>>>>>       //
42372>>>>>       Send Add_Item 350  ''     // micro-help
42373>>>>>       Send Add_Item  40  'View:'
42374>>>>>       Set Item_Display_Style To sbNORMAL
42375>>>>>       Send Add_Item 200  ''     // view name
42376>>>>>       Send Add_Item   0  ''     // spring 'normal' to end
42377>>>>>       Set Item_Display_Style To sbNORMAL
42378>>>>>    End_Procedure // Construct_Object
42379>>>>>
42379>>>>>    Procedure Show_View_Name String sName
42380>>>>>        Set Value item 2 to sName
42381>>>>>    End_Procedure
42382>>>>>
42382>>>>>End_Class
42383>>>
42383>>>Object Status_Bar is a StatusBar
42385>>>End_Object
42386>
42386>    //AB-PanelStoreStart
42386>    
42386>    
42386>    Use StdAbout.pkg // Standard "About" package.
INCLUDING FILE: STDABOUT.PKG
42386>>>//************************************************************************
42386>>>// Confidential Trade Secret.
42386>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
42386>>>// as an unpublished work.  All rights reserved.
42386>>>// DataFlex is a registered trademark of Data Access Corporation.
42386>>>//
42386>>>//************************************************************************
42386>>>//************************************************************************
42386>>>//
42386>>>// $File name  : StdAbout.pkg
42386>>>// $File title : Standard about object package for VDF
42386>>>// Notice      :
42386>>>// $Author(s)  : John Tuohy
42386>>>//
42386>>>// $Rev History
42386>>>//
42386>>>// JT 06/27/97   File created
42386>>>//************************************************************************
42386>>>
42386>>>// This provides a quick and simple way to create an about package for a program.
42386>>>// You need to create a message inside you client area called Activate_About.
42386>>>// Within this message you should send the message DoAbout passing needed
42386>>>// string information.
42386>>>//
42386>>>//       Procedure Activate_About
42386>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
42386>>>//       End_Procedure
42386>>>//    where: sTitle =     Name of application. If none provided, uses caption
42386>>>//                        bar title
42386>>>//           sVersion   = Version Line. If none provided, will be blank
42386>>>//           sCopyRight = Copyright Line. If none provided, will be blank
42386>>>//           sAuthor    = Author name, blank if none provided
42386>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
42386>>>//                        is used.
42386>>>// It is expected that you will place this in your own object package. For
42386>>>// example an order about package may look like this:
42386>>>//
42386>>>//   // OrderAbout.pkg
42386>>>//   Use StdAbout.pkg
42386>>>//   Procedure Activate_About
42386>>>//      Local String sTitle sCopyright sVersion sAuthor
42386>>>//      Move "My Order Entry System" to sTitle
42386>>>//      Move "Version 2.1" to sVersion
42386>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
42386>>>//      Move "John Smith"  to sAuthor
42386>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
42386>>>//   end_procedure
42386>>>//   // end of file.
42386>>>
42386>>>Use DfAbout.pkg
INCLUDING FILE: DFABOUT.PKG
42386>>>>>//************************************************************************
42386>>>>>// Confidential Trade Secret.
42386>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
42386>>>>>// as an unpublished work.  All rights reserved.
42386>>>>>// DataFlex is a registered trademark of Data Access Corporation.
42386>>>>>//
42386>>>>>//************************************************************************
42386>>>>>//************************************************************************
42386>>>>>//
42386>>>>>// $File name  : DfAbout.pkg
42386>>>>>// $File title : About class support
42386>>>>>// Notice      :
42386>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
42386>>>>>//
42386>>>>>// $Rev History
42386>>>>>//
42386>>>>>// JJT 11/5/98    Added version information
42386>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
42386>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
42386>>>>>//                workspace package.
42386>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
42386>>>>>//                class can create this object.
42386>>>>>//                Cleaned up the interface (used correct classes and messages)
42386>>>>>//                Added workspace reporting support to sys-info.
42386>>>>>//                Turned off wrapping in the sys-info editor.
42386>>>>>// KR  ??/??/96   File created
42386>>>>>//************************************************************************
42386>>>>>Use windows.pkg
42386>>>>>Use DFbitmap.pkg
42386>>>>>
42386>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
42387>>>>>
42387>>>>>//****************************************************************************
42387>>>>>// $Module type: FUNCTION
42387>>>>>// $Module name: Network_User_Name
42387>>>>>// $Author     : AK/VOO/KCR
42387>>>>>// Created     : 24-09-96 @ 19:17
42387>>>>>//
42387>>>>>// Description
42387>>>>>//    This function reads the current username of windows and returns that
42387>>>>>//    name or an text unknown user
42387>>>>>//
42387>>>>>// $Rev History
42387>>>>>//    24-09-96  Module header created
42387>>>>>//****************************************************************************
42387>>>>>Function Network_User_Name Returns String
42389>>>>>    Local String sName sLength
42390>>>>>    Local Pointer lpName_Addr lpLength_Addr
42390>>>>>    Local Integer iRetval
42390>>>>>
42390>>>>>    Movestr (Repeat (Character (0), 255)) To sName
42391>>>>>>
42391>>>>>    GetAddress Of sName To lpName_Addr
42392>>>>>    Movestr (DwordToBytes (255)) To sLength
42393>>>>>>
42393>>>>>    GetAddress Of sLength To lpLength_Addr
42394>>>>>
42394>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
42395>>>>>>
42395>>>>>
42395>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
42398>>>>>    Else Function_Return "User Unknown"
42400>>>>>End_Function // Network_User_Name
42401>>>>>
42401>>>>>Type MEMORYSTATUS
42401>>>>>   Field MEMORYSTATUS.dwLength         As Dword // sizeof(MEMORYSTATUS)
42401>>>>>   Field MEMORYSTATUS.dwMemoryLoad     As Dword // percent of memory in use
42401>>>>>   Field MEMORYSTATUS.dwTotalPhys      As Dword // bytes of physical memory
42401>>>>>   Field MEMORYSTATUS.dwAvailPhys      As Dword // free physical memory bytes
42401>>>>>   Field MEMORYSTATUS.dwTotalPageFile  As Dword // bytes of paging file
42401>>>>>   Field MEMORYSTATUS.dwAvailPageFile  As Dword // free bytes of paging file
42401>>>>>   Field MEMORYSTATUS.dwTotalVirtual   As Dword // user bytes of address space
42401>>>>>   Field MEMORYSTATUS.dwAvailVirtual   As Dword // free user bytes
42401>>>>>End_Type // MEMORYSTATUS
42401>>>>>
42401>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
42402>>>>>
42402>>>>>// If a global workspace object exists it will use this variable to store
42402>>>>>// its object id.
42402>>>>>
42402>>>>>Class SysinfoDisplay Is An Edit
42403>>>>>    Procedure Construct_Object
42404>>>>>        forward send construct_object
42406>>>>>
42406>>>>>        Set Location To 6 6
42407>>>>>        Set Size To 110 255
42408>>>>>        Set Read_Only_State To True
42409>>>>>        Set wrap_state to False
42410>>>>>    end_Procedure
42411>>>>>
42411>>>>>    //****************************************************************************
42411>>>>>    // $Module type: PROCEDURE
42411>>>>>    // $Module name: Add_Line
42411>>>>>    // $Author     : VOO
42411>>>>>    // Created     : 06-10-96 @ 15:23
42411>>>>>    //
42411>>>>>    // Description
42411>>>>>    //    This method will add a line to this edit object, it should go simpler
42411>>>>>    //    but it seems to be done this way.
42411>>>>>    //
42411>>>>>    // $Rev History
42411>>>>>    //    06-10-96  Module header created
42411>>>>>    //****************************************************************************
42411>>>>>    Procedure Add_Line String sVal
42412>>>>>        Local Integer iLine
42413>>>>>
42413>>>>>        Moveint (Line_Count (Current_Object)) To iLine
42414>>>>>>
42414>>>>>        If (iLine = 1 And Changed_State (Current_Object) = False) Moveint 0 To iLine
42417>>>>>        Set Value Item iLine To sVal
42418>>>>>    End_Procedure // Add_Line
42419>>>>>
42419>>>>>    //****************************************************************************
42419>>>>>    // $Module type: PROCEDURE
42419>>>>>    // $Module name: Show_Current_Directory
42419>>>>>    // $Author     : VOO
42419>>>>>    // Created     : 06-10-96 @ 15:24
42419>>>>>    //
42419>>>>>    // Description
42419>>>>>    //    This method will show the name of the current directory in the system
42419>>>>>    //    information box
42419>>>>>    //
42419>>>>>    // $Rev History
42419>>>>>    //    06-10-96  Module header created
42419>>>>>    //****************************************************************************
42419>>>>>    Procedure Show_Current_Directory
42420>>>>>        Local String sDir
42421>>>>>
42421>>>>>        Get_Current_Directory To sDir
42422>>>>>        Send Add_Line ("Current Directory: " + sDir)
42423>>>>>    End_Procedure // Show_Current_Directory
42424>>>>>
42424>>>>>    Procedure Show_Windows_Directory
42425>>>>>        Local String sWindir
42426>>>>>
42426>>>>>        Get_Windows_Directory To sWindir
42427>>>>>        Send Add_Line ("Windows Directory: " * sWindir)
42428>>>>>    End_Procedure // Show_Windows_Directory
42429>>>>>
42429>>>>>    Procedure Show_Current_User
42430>>>>>        Send Add_Line ("Network User Name: " * Network_User_Name (Current_Object))
42431>>>>>    End_Procedure // Show_Current_User
42432>>>>>
42432>>>>>    Procedure Show_Number_Format
42433>>>>>        Local Integer iFormat
42434>>>>>
42434>>>>>        Get_Attribute Df_Thousands_Separator To iFormat
42437>>>>>        Send Add_Line ('Thousands Separator: "' - Character (iFormat) - '" (' - String (iFormat) - ')')
42438>>>>>        Get_Number_Format To iFormat
42439>>>>>        Send Add_Line ('Decimal Separator: "' - If (iFormat = 0, '.', ',') - '"')
42440>>>>>    End_Procedure // Show_Number_Format
42441>>>>>
42441>>>>>    Procedure Show_Filelist_Name
42442>>>>>        Local String sFilename
42443>>>>>
42443>>>>>        Get_Attribute Df_Filelist_Name To sFilename
42446>>>>>        Send Add_Line ("Current Filelist: " * sFilename)
42447>>>>>    End_Procedure // Show_Filelist_Name
42448>>>>>
42448>>>>>    Procedure Show_Lock_Delay
42449>>>>>        Local Integer iLockdelay
42450>>>>>
42450>>>>>        Get_Attribute Df_Lock_Delay To iLockdelay
42453>>>>>        Send Add_Line ("Database Locking Delay: " * String (iLockdelay) * "Milliseconds")
42454>>>>>    End_Procedure // Show_Lock_Delay
42455>>>>>
42455>>>>>    Procedure Show_Lock_Timeout
42456>>>>>        Local Integer iLockTimeout
42457>>>>>
42457>>>>>        Get_Attribute Df_Lock_Timeout To iLockTimeout
42460>>>>>        Send Add_Line ("Database Locking Timeout: " * String (iLockTimeout) * "Milliseconds")
42461>>>>>    End_Procedure // Show_Lock_Timeout
42462>>>>>
42462>>>>>    Procedure Show_Screen_Size
42463>>>>>        Local Integer iYscreensize iXscreensize
42464>>>>>
42464>>>>>        Moveint (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
42465>>>>>>
42465>>>>>        Moveint (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
42466>>>>>>
42466>>>>>
42466>>>>>        Send Add_Line ("Video Resolution: " * String (iXscreensize) * "by" * String (iYscreensize))
42467>>>>>    End_Procedure // Show_Screen_Size
42468>>>>>
42468>>>>>    Procedure Show_Page_Size
42469>>>>>        Send Add_Line ("Page End: " * String (Pageend) * "Form Feed: " * String (Pagefeed))
42470>>>>>    End_procedure
42471>>>>>
42471>>>>>    Procedure Show_Date
42472>>>>>        Local Date dToday
42473>>>>>
42473>>>>>        Sysdate4 dToday
42474>>>>>        Send Add_Line ("Current System Date: " * String (dToday))
42475>>>>>    End_procedure // Show_Date
42476>>>>>
42476>>>>>    Procedure Show_Date_Format
42477>>>>>        Local Integer iDateFormat
42478>>>>>        Local String sDateFormat
42478>>>>>
42478>>>>>        Get_Attribute Df_Date_Format To iDateFormat
42481>>>>>        if iDateFormat Eq DF_DATE_USA ;            Movestr "USA" To sDateFormat
42484>>>>>        else if iDateformat Eq DF_DATE_EUROPEAN ;            Movestr "European" To sDateFormat
42488>>>>>        else if iDateformat Eq DF_DATE_MILITARY ;            Movestr "Military" To sDateFormat
42492>>>>>        else ;            Movestr "Unknown Date Type" To sDateFormat
42494>>>>>        Send Add_Line ("Date Format: " * sDateformat)
42495>>>>>    End_Procedure // Show_Date_Format
42496>>>>>
42496>>>>>    Procedure Show_Memavail
42497>>>>>        Local Integer iMem
42498>>>>>
42498>>>>>        Memory iMem
42499>>>>>>
42499>>>>>        Send Add_Line ("Available Memory: " * String (iMem))
42500>>>>>    End_Procedure // Show_Memavail
42501>>>>>
42501>>>>>    Procedure Show_Systemresources
42502>>>>>        Local String sMemoryStatus
42503>>>>>        Local Pointer lpsMemoryStatus
42503>>>>>        Local Integer iVoid
42503>>>>>        Local Dword dwMemoryLoad dwTotalPhys dwAvailPhys dwTotalPageFile dwAvailPageFile dwTotalVirtual dwAvailVirtual
42503>>>>>
42503>>>>>        ZeroType MEMORYSTATUS To sMemoryStatus
42504>>>>>        GetAddress Of sMemoryStatus To lpsMemoryStatus
42505>>>>>
42505>>>>>        Moveint (GlobalMemoryStatus (lpsMemoryStatus)) To iVoid
42506>>>>>>
42506>>>>>
42506>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwMemoryLoad    To dwMemoryLoad
42507>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPhys     To dwTotalPhys
42508>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPhys     To dwAvailPhys
42509>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPageFile To dwTotalPageFile
42510>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPageFile To dwAvailPageFile
42511>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalVirtual  To dwTotalVirtual
42512>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailVirtual  To dwAvailVirtual
42513>>>>>
42513>>>>>        Send Add_Line ("Current memory utilization:" * String (dwMemoryLoad))
42514>>>>>        Send Add_Line ("Percentage available physical memory:" * String (dwAvailPhys / dwTotalPhys * 100.0) - "%")
42515>>>>>        Send Add_Line ("Percentage available pagefile space:" * String (dwAvailPageFile / dwTotalPageFile * 100.0) - "%")
42516>>>>>        Send Add_Line ("Percentage available virtual memory:" * String (dwAvailVirtual / dwTotalVirtual * 100.0) - "%")
42517>>>>>    End_Procedure // Show_Systemresources
42518>>>>>
42518>>>>>    Procedure Show_Registration
42519>>>>>        Local String sRegName
42520>>>>>        Local Integer iSN
42520>>>>>        Registration sRegName iSN
42521>>>>>>
42521>>>>>
42521>>>>>        Send Add_Line ("Serial# : " + (String(iSN)))
42522>>>>>        Send Add_Line ("Reg Name: " + sRegName)
42523>>>>>
42523>>>>>    End_Procedure // Show_Current_Directory
42524>>>>>
42524>>>>>
42524>>>>>
42524>>>>>    //****************************************************************************
42524>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
42524>>>>>    // to the workspace object passing the an object and message to send back
42524>>>>>    // to this object. It is expected that the workspace object will send this
42524>>>>>    // message for every line of information it wants displayed (passing the
42524>>>>>    // information to be displayed
42524>>>>>    //****************************************************************************
42524>>>>>    register_procedure EnumerateWorkspaceData integer hObjId integer hmMessId
42524>>>>>    Procedure Show_WorkspaceInformation
42525>>>>>        If ghoWorkspace ;            Send EnumerateWorkspaceData to ghoWorkspace Current_object Msg_add_Line
42528>>>>>    End_Procedure
42529>>>>>
42529>>>>>    Function VersionStr integer iVer integer iRev integer iBld Returns string
42530>>>>>        Function_Return (string(iVer)-"."-string(iRev)-"."-string(iBld))
42531>>>>>    End_Function
42532>>>>>
42532>>>>>    Procedure Show_Versions
42533>>>>>        local integer iVersion iRevision iBuild
42534>>>>>        Version_information iVersion iRevision iBuild
42536>>>>>        Send Add_Line ("Runtime Version:" * VersionStr(self,iVersion,iRevision,iBuild) )
42537>>>>>        Send Add_Line ("Package Version:" * VersionStr(self,PKG_VERSION, PKG_REVISION, PKG_BUILD) )
42538>>>>>        Send Add_Line ("FMAC Version:"    * VersionStr(self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) )
42539>>>>>    End_Procedure
42540>>>>>
42540>>>>>
42540>>>>>    //***
42540>>>>>    //*** BW
42540>>>>>    //*** Procedure: Show_Drivers
42540>>>>>    //*** Purpose  : Show loaed database drivers
42540>>>>>    //***
42540>>>>>
42540>>>>>    Procedure Show_Drivers
42541>>>>>        Local String  Current_drvr
42542>>>>>        Local String  Loadeddrvrs
42542>>>>>        Local Integer Number_of_drvrs
42542>>>>>        Local Integer Count
42542>>>>>
42542>>>>>        Move "" To Loadeddrvrs
42543>>>>>        Get_attribute DF_NUMBER_DRIVERS To Number_of_drvrs
42546>>>>>        For Count From 1 To Number_of_drvrs
42552>>>>>>
42552>>>>>            Get_attribute DF_DRIVER_NAME Of Count To Current_drvr
42555>>>>>            If (Loadeddrvrs <> "") ;                Move (Append(Loadeddrvrs, ", ")) To Loadeddrvrs
42558>>>>>            Move (Append(Loadeddrvrs, Current_drvr)) To Loadeddrvrs
42559>>>>>        Loop
42560>>>>>>
42560>>>>>        Send Add_Line ("Database driver(s):" * Loadeddrvrs)
42561>>>>>    End_Procedure // Show_Drivers
42562>>>>>
42562>>>>>    //****************************************************************************
42562>>>>>    // $Module type: PROCEDURE
42562>>>>>    // $Module name: Add_Focus
42562>>>>>    // $Author     : VOO
42562>>>>>    // Created     : 24-09-96 @ 19:43
42562>>>>>    //
42562>>>>>    // Description
42562>>>>>    //    During activation we will remove the old information and add the newly
42562>>>>>    //    found systeminformation
42562>>>>>    //
42562>>>>>    // $Rev History
42562>>>>>    //    24-09-96  Module header created
42562>>>>>    //****************************************************************************
42562>>>>>    Procedure Add_Focus Integer hoRoot
42563>>>>>        Forward Send Add_Focus hoRoot
42565>>>>>
42565>>>>>        Send Delete_Data
42566>>>>>        Set Changed_State To False
42567>>>>>        Set Read_Only_State To True
42568>>>>>        Send Show_WorkSpaceInformation // added to show WS info
42569>>>>>        SEnd Show_Drivers
42570>>>>>        Send Show_Current_User
42571>>>>>        Send Show_Windows_Directory
42572>>>>>        Send Show_Current_Directory
42573>>>>>        Send Show_Filelist_Name
42574>>>>>        Send Show_Versions
42575>>>>>        Send Show_Memavail
42576>>>>>        Send Show_Screen_Size
42577>>>>>        Send Show_Page_Size
42578>>>>>        Send Show_Number_Format
42579>>>>>        Send Show_Date_Format
42580>>>>>        Send Show_Lock_Delay
42581>>>>>        Send Show_Lock_Timeout
42582>>>>>        Send Show_Date
42583>>>>>        Send Show_Systemresources
42584>>>>>        Send Show_Registration
42585>>>>>    End_Procedure // Show_All_Info
42586>>>>>
42586>>>>>End_Class // SysinfoDisplay
42587>>>>>
42587>>>>>
42587>>>>>//****************************************************************************
42587>>>>>// $Module type: OBJECT
42587>>>>>// $Module name: Sysinfo_Dialog
42587>>>>>// $Author     : VOO
42587>>>>>// Created     : 24-09-96 @ 18:47
42587>>>>>//
42587>>>>>// Description
42587>>>>>//    This object shows the systeminformation on the screen
42587>>>>>//
42587>>>>>// $Rev History
42587>>>>>//    24-09-96  Module header created
42587>>>>>//****************************************************************************
42587>>>>>Class SysInfoDialog Is A ModalPanel
42588>>>>>    Procedure Construct_Object
42589>>>>>        forward send construct_object
42591>>>>>
42591>>>>>        Set Caption_Bar To True
42592>>>>>        Set Sysmenu_Icon To True
42593>>>>>        Set Label To "System Information"
42594>>>>>        Set Size To 152 270
42595>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
42596>>>>>        Set Minimize_Icon To False
42597>>>>>        Set Maximize_Icon To False
42598>>>>>        Set Border_Style To Border_Dialog
42599>>>>>
42599>>>>>        Object Sysinfo_Display Is A SysInfoDisplay
42601>>>>>        End_Object
42602>>>>>
42602>>>>>        Object Close_Button Is A Button
42604>>>>>            Set Label to "&Close"
42605>>>>>            Set Location To 120 212
42606>>>>>            Set Message item 0 to msg_Close_Panel
42607>>>>>            Set default_action_button to current_object
42608>>>>>        End_Object // Close_Button
42609>>>>>
42609>>>>>        On_Key Kcancel       Send Close_Panel
42610>>>>>        On_Key Key_Alt+Key_C Send Close_Panel
42611>>>>>    End_procedure
42612>>>>>
42612>>>>>End_Class // SysinfoDialog
42613>>>>>
42613>>>>>// Purpose:
42613>>>>>//
42613>>>>>// Ken Ross 12/17/96 5:16PM
42613>>>>>//
42613>>>>>Class AboutDialog Is A ModalPanel
42614>>>>>
42614>>>>>    Procedure construct_object
42615>>>>>        String sVdfRootDir
42616>>>>>        forward send construct_object
42618>>>>>        Set Label to "About..."
42619>>>>>        Set Size to 100 217
42620>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
42621>>>>>
42621>>>>>        Object SysInfo_Dialog is a SysInfoDialog
42623>>>>>        End_Object
42624>>>>>
42624>>>>>        Object oBox is a Container3d
42626>>>>>            Set Border_Style to Border_StaticEdge
42627>>>>>            Set Size to 63 202
42628>>>>>            Set Location to 4 5
42629>>>>>
42629>>>>>            Object AboutGraphic is a BitmapContainer
42631>>>>>                Set Border_Style to Border_None
42632>>>>>                Set Bitmap_Style to Bitmap_Center
42633>>>>>                Set Size to 48 48
42634>>>>>                Set Location to 7 2
42635>>>>>            End_Object    // AboutGraphic
42636>>>>>
42636>>>>>            Object ProductName is a TextBox
42638>>>>>                Set label to "ProductName"
42639>>>>>                Set Size to 10 45
42640>>>>>                Set Location to 8 53
42641>>>>>            End_Object    // ProductName
42642>>>>>
42642>>>>>            Object Version is a TextBox
42644>>>>>                Set label to "Version"
42645>>>>>                Set Size to 10 25
42646>>>>>                Set Location to 21 53
42647>>>>>            End_Object    // Version
42648>>>>>
42648>>>>>            Object Copyright is a TextBox
42650>>>>>                Set label to "Copyright"
42651>>>>>                Set Size to 10 31
42652>>>>>                Set Location to 34 53
42653>>>>>            End_Object    // Copyright
42654>>>>>
42654>>>>>            Object Author is a TextBox
42656>>>>>                Set label to "Author"
42657>>>>>                Set Size to 10 22
42658>>>>>                Set Location to 46 53
42659>>>>>            End_Object    // Author
42660>>>>>
42660>>>>>        End_Object    // oBox
42661>>>>>
42661>>>>>        Object OK_bn is a Button
42663>>>>>            On_Item "&OK" Send Close_Panel
42664>>>>>            Set Size to 14 50
42665>>>>>            Set Location to 71 157
42666>>>>>        End_Object    // OK_bn
42667>>>>>
42667>>>>>        Object SysInfo_bn is a Button
42669>>>>>            On_Item "&System Info" Send Show_Sysinfo
42670>>>>>            Set Size to 14 50
42671>>>>>            Set Location to 71 101
42672>>>>>        End_Object    // SysInfo_bn
42673>>>>>
42673>>>>>        On_Key Kcancel Send KeyAction to (Ok_bn(Current_Object))
42674>>>>>        On_Key Key_Alt+Key_O Send KeyAction to (Ok_bn(Current_Object))
42675>>>>>        On_Key Key_Alt+Key_S Send KeyAction to (SysInfo_bn(Current_Object))
42676>>>>>
42676>>>>>        Get_Profile_String "Defaults" "VdfRootDir" To sVdfRootDir
42679>>>>>        Set logo to (sVdfRootDir +"\Bitmaps\DacAbout.bmp")  // square bitmaps of 42x42 work best
42680>>>>>
42680>>>>>    End_Procedure
42681>>>>>
42681>>>>>    Procedure set productname string sval
42682>>>>>        set label of (productname(oBox(current_object))) to sval
42683>>>>>    End_Procedure
42684>>>>>
42684>>>>>    Procedure set version string sval
42685>>>>>        set label of (version(oBox(current_object))) to sval
42686>>>>>    End_Procedure
42687>>>>>
42687>>>>>    Procedure set copyright string sval
42688>>>>>        set label of (copyright(oBox(current_object))) to sval
42689>>>>>    End_Procedure
42690>>>>>
42690>>>>>    Procedure set author string sval
42691>>>>>        set label of (author(oBox(current_object))) to sval
42692>>>>>    End_Procedure
42693>>>>>
42693>>>>>    // square bitmaps of 42x42 work best
42693>>>>>    //
42693>>>>>    Procedure set logo string sval
42694>>>>>        set bitmap of (aboutgraphic(oBox(current_object))) to sval
42695>>>>>    End_Procedure
42696>>>>>
42696>>>>>    Procedure Show_Sysinfo
42697>>>>>        Send Popup_Modal To (Sysinfo_Dialog(Current_Object))
42698>>>>>    End_Procedure // Show_Sysinfo
42699>>>>>
42699>>>>>End_Class
42700>>>>>
42700>>>>>
42700>>>>>//Object About_Dialog is an AboutDialog
42700>>>>>//    set productname to "Visual DataFlex"
42700>>>>>//    set version to "version 4.0"
42700>>>>>//    set copyright to "Copyright 1997 Data Access Corporation"
42700>>>>>//    set author to ""
42700>>>>>//    set logo to "ablogo.bmp"  // square bitmaps of 42x42 work best
42700>>>>>//End_Object
42700>>>>>
42700>>>>>//Procedure Activate_About
42700>>>>>//   Send Popup_Modal To (About_Dialog (Current_Object))
42700>>>>>//End_Procedure
42700>>>
42700>>>// *************************************************************************
42700>>>//  Public message. This is the default message. It is expected that you will
42700>>>//   create your own message to override this
42700>>>// *************************************************************************
42700>>>
42700>>>Procedure Activate_About
42702>>>   Send DoAbout "" "" "" "" "" ""
42703>>>End_Procedure
42704>>>
42704>>>// *************************************************************************
42704>>>//  Public message. It is expected that you will send this message (most
42704>>>//  likely from Activate_About. This creates an about object, activates it
42704>>>//  and destroys it when done. It is not exepected that you will augment this.
42704>>>// *************************************************************************
42704>>>
42704>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
42706>>>        Local integer hoObj hoMain
42707>>>
42707>>>        // create object
42707>>>        Object About is an AboutDialog
42709>>>            // if no title passed use the label of the main panel
42709>>>            // (if a main panel exists).
42709>>>            if sTitle     eq '' Begin
42711>>>                Get Main_Window to hoMain
42712>>>                if hoMain Get Label of hoMain to sTitle
42715>>>            end
42715>>>>
42715>>>            set productname to sTitle
42716>>>            set version     to sVersion
42717>>>            set copyright   to sCopyRight
42718>>>            set author      to sAuthor
42719>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
42722>>>            Move Current_Object to hoObj // object Id
42723>>>        End_Object
42724>>>        Send Popup to hoObj    // popup the about object
42725>>>        Send Request_Destroy_Object to hoObj // when done, it will be destroyed
42726>>>End_procedure
42727>    
42727>    Use Tooltip.Inc
INCLUDING FILE: TOOLTIP.INC
42727>>>Use Tooltip.pkg
42727>>>
42727>>>object StandardToolTip is a StandardToolTip000
42729>>>    move (current_object) to DefaultTooltipHintID
42730>>>end_object
42731>>>
42731>>>object ToolTipTimer is a ToolTipTimer000
42733>>>    move (current_object) to TooltipControllerID
42734>>>end_object
42735>    
42735>    
42735>    
42735>    
42735>    
42735>    
42735>    //AB-PanelStoreEnd
42735>
42735>
42735>End_Object
42736>
42736>
42736>//AB-StoreStart
42736>
42736>Start_UI
42737>
42737>
42737>
42737>
42737>
42737>
42737>
42737>
42737>
42737>//AB-StoreEnd
42737>
42737>
Summary
Memory Available: 2147483647
Total Errors   : 0
Total Symbols  : 24465
Total Resources: 0
Total Commands : 42736
Total Windows  : 1
Total Pages    : 1
Static Data    : 302381
Message area   : 222998
Total Blocks   : 14261
