Compiling Program: L:\VDF14.1.Dev\TITAN_MIGRATE\AppSrc\Migrate_Test1.src
Memory Available: 1738002431
1>Use DFAllEnt.pkg
Using pre-compiled package DFALLENT.PKG
Including file: dfallent.pkd    (C:\Program Files\Visual DataFlex 14.1\Pkg\dfallent.pkd)
48529>Use cCJStandardCommandBarSystem.pkg
Including file: cCJStandardCommandBarSystem.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\cCJStandardCommandBarSystem.pkg)
48529>>>// these are all the packages used in a standard MDI menubar/toolbar system
48529>>>
48529>>>Use cCJCommandBarSystem.pkg
48529>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\cCJStandardMenuItemClasses.pkg)
48529>>>>>Use Dfpanel.pkg
48529>>>>>Use cCJCommandBarSystem.pkg
48529>>>>>Use LanguageText.pkg
48529>>>>>
48529>>>>>
48529>>>>>Class cCJUndoMenuItem is a cCJMenuItem
48530>>>>>    
48530>>>>>    Procedure Construct_Object
48532>>>>>        Forward Send Construct_Object
48534>>>>>        Set psCaption   to C_$CaptionUndo
48535>>>>>        Set psToolTip to C_$ToolTipUndo
48536>>>>>        Set psDescription to C_$DescUndo
48537>>>>>        Set psImage to "ActionUndo.ico"
48538>>>>>        Set pbActiveUpdate to True
48539>>>>>        Set psCategory to C_$CategoryEdit
48540>>>>>        Set psShortcut to C_$Key_Ctrl_Z
48541>>>>>    End_Procedure
48542>>>>>
48542>>>>>    Procedure OnExecute Variant vCommandBarControl
48544>>>>>        Send Undo of (focus(Self))
48545>>>>>    End_Procedure
48546>>>>>    
48546>>>>>    Function IsEnabled Returns Boolean
48548>>>>>        Boolean bEnabled
48548>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
48549>>>>>        Function_Return bEnabled
48550>>>>>    End_Function
48551>>>>>         
48551>>>>>End_Class
48552>>>>>
48552>>>>>
48552>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
48553>>>>>    
48553>>>>>    Procedure Construct_Object
48555>>>>>        Forward Send Construct_Object
48557>>>>>        Set psCaption   to C_$CaptionDelete
48558>>>>>        Set psToolTip to C_$ToolTipDelete
48559>>>>>        Set psDescription to C_$DescDelete
48560>>>>>        Set psImage to "actionDelete.ico"
48561>>>>>        Set psShortcut to C_$Key_Delete
48562>>>>>        Set pbActiveUpdate to True
48563>>>>>        Set psCategory to C_$CategoryEdit
48564>>>>>    End_Procedure
48565>>>>>
48565>>>>>
48565>>>>>    Procedure OnExecute Variant vCommandBarControl
48567>>>>>        Send Delete of (focus(Self))
48568>>>>>    End_Procedure
48569>>>>>    
48569>>>>>    Function IsEnabled Returns Boolean
48571>>>>>        Boolean bEnabled
48571>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
48572>>>>>        Function_Return bEnabled
48573>>>>>    End_Function
48574>>>>>         
48574>>>>>End_Class
48575>>>>>
48575>>>>>
48575>>>>>Class cCJCutMenuItem is a cCJMenuItem
48576>>>>>    
48576>>>>>    Procedure Construct_Object
48578>>>>>        Forward Send Construct_Object
48580>>>>>        Set psCaption   to C_$CaptionCut
48581>>>>>        Set psToolTip to C_$TooltipCut
48582>>>>>        Set psDescription to C_$DescCut
48583>>>>>        Set psImage to "actionCut.ico"
48584>>>>>        Set psShortcut to C_$Key_Ctrl_X
48585>>>>>        Set pbActiveUpdate to True
48586>>>>>        Set psCategory to C_$CategoryEdit
48587>>>>>    End_Procedure
48588>>>>>
48588>>>>>
48588>>>>>    Procedure OnExecute Variant vCommandBarControl
48590>>>>>        Send Cut of (focus(Self))
48591>>>>>    End_Procedure
48592>>>>>    
48592>>>>>    Function IsEnabled Returns Boolean
48594>>>>>        Boolean bEnabled
48594>>>>>        Get CanCut of (Focus(Self)) to bEnabled
48595>>>>>        Function_Return bEnabled
48596>>>>>    End_Function
48597>>>>>         
48597>>>>>End_Class
48598>>>>>
48598>>>>>
48598>>>>>Class cCJCopyMenuItem is a cCJMenuItem
48599>>>>>    
48599>>>>>    Procedure Construct_Object
48601>>>>>        Forward Send Construct_Object
48603>>>>>        Set psCaption   to C_$CaptionCopy
48604>>>>>        Set psToolTip to C_$ToolTipCopy
48605>>>>>        Set psDescription to C_$DescCopy
48606>>>>>        Set psImage to "actionCopy.ico"
48607>>>>>        Set psShortcut to C_$Key_Ctrl_C
48608>>>>>        Set pbActiveUpdate to True
48609>>>>>        Set psCategory to C_$CategoryEdit
48610>>>>>    End_Procedure
48611>>>>>
48611>>>>>
48611>>>>>    Procedure OnExecute Variant vCommandBarControl
48613>>>>>        Send Copy of (focus(Self))
48614>>>>>    End_Procedure
48615>>>>>    
48615>>>>>    Function IsEnabled Returns Boolean
48617>>>>>        Boolean bEnabled
48617>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
48618>>>>>        Function_Return bEnabled
48619>>>>>    End_Function
48620>>>>>         
48620>>>>>End_Class
48621>>>>>
48621>>>>>
48621>>>>>Class cCJPasteMenuItem is a cCJMenuItem
48622>>>>>    
48622>>>>>    Procedure Construct_Object
48624>>>>>        Forward Send Construct_Object
48626>>>>>        Set psCaption   to C_$CaptionPaste
48627>>>>>        Set psToolTip to C_$ToolTipPaste
48628>>>>>        Set psDescription to C_$DescPaste
48629>>>>>        Set psImage to "actionPaste.ico"
48630>>>>>        Set pbActiveUpdate to True
48631>>>>>        Set psShortcut to C_$Key_Ctrl_V
48632>>>>>        Set psCategory to C_$CategoryEdit
48633>>>>>    End_Procedure
48634>>>>>
48634>>>>>
48634>>>>>    Procedure OnExecute Variant vCommandBarControl
48636>>>>>        Send Paste of (focus(Self))
48637>>>>>    End_Procedure
48638>>>>>    
48638>>>>>    Function IsEnabled Returns Boolean
48640>>>>>        Boolean bEnabled
48640>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
48641>>>>>        Function_Return bEnabled
48642>>>>>    End_Function
48643>>>>>         
48643>>>>>End_Class
48644>>>>>
48644>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
48645>>>>>    
48645>>>>>    Procedure Construct_Object
48647>>>>>        Forward Send Construct_Object
48649>>>>>        Set psCaption   to C_$CaptionSelectAll
48650>>>>>        Set psToolTip to C_$ToolTipSelectAll
48651>>>>>        Set psDescription to C_$DescSelectAll
48652>>>>>        Set pbActiveUpdate to True
48653>>>>>        Set psShortcut to C_$Key_Ctrl_A
48654>>>>>        Set psCategory to C_$CategoryEdit
48655>>>>>    End_Procedure
48656>>>>>
48656>>>>>
48656>>>>>    Procedure OnExecute Variant vCommandBarControl
48658>>>>>        Send Select_All of (focus(Self))
48659>>>>>    End_Procedure
48660>>>>>    
48660>>>>>    Function IsEnabled Returns Boolean
48662>>>>>        Boolean bEnabled
48662>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
48663>>>>>        Function_Return bEnabled
48664>>>>>    End_Function
48665>>>>>         
48665>>>>>End_Class
48666>>>>>
48666>>>>> 
48666>>>>>Class cCJExitMenuItem is a cCJMenuItem
48667>>>>>
48667>>>>>    Procedure Construct_Object
48669>>>>>        Forward Send Construct_Object
48671>>>>>        Set psCaption to C_$CaptionExit
48672>>>>>        Set psToolTip to C_$ToolTipExit
48673>>>>>        Set psDescription to C_$ToolTipExit
48674>>>>>        Set psShortcut to C_$Key_Alt_F4
48675>>>>>        Set psCategory to C_$CategoryFile
48676>>>>>    End_Procedure
48677>>>>>
48677>>>>>    Procedure OnExecute Variant vCommandBarControl
48679>>>>>        Send Exit_Application of Desktop
48680>>>>>    End_Procedure
48681>>>>>
48681>>>>>End_Class           
48682>>>>>
48682>>>>>Class cCJHelpMenuItem is a cCJMenuItem    
48683>>>>>
48683>>>>>    Procedure Construct_Object
48685>>>>>        Forward Send Construct_Object
48687>>>>>        Set psCaption to C_$CaptionHelp
48688>>>>>        Set psDescription to C_$ToolTipHelp
48689>>>>>        Set psToolTip to C_$DescHelp
48690>>>>>        Set psImage to "ActionHelp.ico"
48691>>>>>        Set psShortcut to "F1"
48692>>>>>        Set psCategory to C_$CategoryHelp
48693>>>>>    End_Procedure
48694>>>>>    
48694>>>>>    Procedure OnExecute Variant vCommandBarControl
48696>>>>>        Send Help of (Focus(Self))
48697>>>>>    End_Procedure
48698>>>>>
48698>>>>>End_Class
48699>>>>>
48699>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
48700>>>>>
48700>>>>>    Procedure Construct_Object
48702>>>>>        Forward Send Construct_Object
48704>>>>>        Set psCaption to C_$CaptionAddStatusbar
48705>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
48706>>>>>        Set psDescription to  C_$DescAddStatusbar
48707>>>>>        Set psCategory to C_$CategoryWindow
48708>>>>>    End_Procedure
48709>>>>>
48709>>>>>    Procedure OnExecute Variant vCommandBarControl
48711>>>>>        Handle hoCommandBars hoClientArea
48711>>>>>        Get CommandBarSystemObject to hoCommandBars
48712>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48713>>>>>        If hoClientArea Begin
48715>>>>>            // the clientarea's parent panel has message
48715>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
48716>>>>>        End
48716>>>>>>
48716>>>>>    End_Procedure
48717>>>>>
48717>>>>>     Function IsChecked Returns Boolean
48719>>>>>        Boolean bOn
48719>>>>>        Handle hoCommandBars hoClientArea
48719>>>>>        Get CommandBarSystemObject to hoCommandBars
48720>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48721>>>>>        If hoClientArea Begin
48723>>>>>            // the clientarea's parent panel has message
48723>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
48724>>>>>        End
48724>>>>>>
48724>>>>>        Function_Return bOn
48725>>>>>     End_Function
48726>>>>>End_Class
48727>>>>>
48727>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
48728>>>>>
48728>>>>>    Procedure Construct_Object
48730>>>>>        Forward Send Construct_Object
48732>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
48733>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
48734>>>>>        Set psDescription to C_$DescAutoArrangeIcons
48735>>>>>        Set psCategory to C_$CategoryWindow
48736>>>>>    End_Procedure
48737>>>>>
48737>>>>>    Procedure OnExecute Variant vCommandBarControl
48739>>>>>        Handle hoCommandBars hoClientArea
48739>>>>>        Get CommandBarSystemObject to hoCommandBars
48740>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48741>>>>>        If hoClientArea Begin
48743>>>>>            // the clientarea's parent panel has message
48743>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
48744>>>>>        End
48744>>>>>>
48744>>>>>    End_Procedure
48745>>>>>    
48745>>>>>     Function IsChecked Returns Boolean
48747>>>>>        Boolean bOn
48747>>>>>        Handle hoCommandBars hoClientArea
48747>>>>>        Get CommandBarSystemObject to hoCommandBars
48748>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48749>>>>>        If hoClientArea Begin
48751>>>>>            // the clientarea's parent panel has message
48751>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
48752>>>>>        End
48752>>>>>>
48752>>>>>        Function_Return bOn
48753>>>>>     End_Function
48754>>>>>End_Class
48755>>>>>
48755>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
48756>>>>>
48756>>>>>    Procedure Construct_Object
48758>>>>>        Forward Send Construct_Object
48760>>>>>        Set psCaption to C_$CaptionRestoreMenus
48761>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
48762>>>>>        Set psDescription to C_$DescRestoreMenus
48763>>>>>        Set psCategory to C_$CategoryWindow
48764>>>>>    End_Procedure
48765>>>>>
48765>>>>>    Procedure OnExecute Variant vCommandBarControl
48767>>>>>        Handle hoCommandBars
48767>>>>>        Get CommandBarSystemObject to hoCommandBars
48768>>>>>        Send RestoreLayout of hoCommandBars
48769>>>>>    End_Procedure
48770>>>>>    
48770>>>>>End_Class
48771>>>>>
48771>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
48772>>>>>
48772>>>>>    Procedure Construct_Object
48774>>>>>        Forward Send Construct_Object
48776>>>>>        Set psCaption to C_$CaptionCascade
48777>>>>>        Set psToolTip to C_$ToolTipCascade
48778>>>>>        Set psDescription to  C_$DescCascade
48779>>>>>        Set psImage to "ActionCascade.ico"
48780>>>>>        Set psCategory to C_$CategoryWindow
48781>>>>>    End_Procedure
48782>>>>>    
48782>>>>>    Procedure OnExecute Variant vCommandBarControl
48784>>>>>        Handle hoCommandBars hoClientArea
48784>>>>>        Get CommandBarSystemObject to hoCommandBars
48785>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48786>>>>>        If hoClientArea Begin
48788>>>>>            Send Cascade_Windows of hoClientArea
48789>>>>>        End
48789>>>>>>
48789>>>>>    End_Procedure
48790>>>>>End_Class
48791>>>>>
48791>>>>>Class cCJTileHorizontally is a cCJMenuItem
48792>>>>>
48792>>>>>    Procedure Construct_Object
48794>>>>>        Forward Send Construct_Object
48796>>>>>        Set psCaption to C_$CaptionTileHorizontally 
48797>>>>>        Set psToolTip to C_$ToolTipTileHorizontally  
48798>>>>>        Set psDescription to  C_$DescTileHorizontally
48799>>>>>        Set psImage to "ActionTileHorizontally.ico"
48800>>>>>        Set psCategory to C_$CategoryWindow
48801>>>>>    End_Procedure
48802>>>>>
48802>>>>>    Procedure OnExecute Variant vCommandBarControl
48804>>>>>        Handle hoCommandBars hoClientArea
48804>>>>>        Get CommandBarSystemObject to hoCommandBars
48805>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48806>>>>>        If hoClientArea Begin
48808>>>>>            Send Tile_Windows_Horizontal of hoClientArea
48809>>>>>        End
48809>>>>>>
48809>>>>>    End_Procedure
48810>>>>>End_Class
48811>>>>>
48811>>>>>Class cCJTileVertically is a cCJMenuItem
48812>>>>>
48812>>>>>    Procedure Construct_Object
48814>>>>>        Forward Send Construct_Object
48816>>>>>        Set psCaption to C_$CaptionTileVertically  
48817>>>>>        Set psToolTip to C_$ToolTipTileVertically
48818>>>>>        Set psDescription to  C_$DescTileVertically
48819>>>>>        Set psImage to "ActionTileVertically.ico"
48820>>>>>        Set psCategory to C_$CategoryWindow
48821>>>>>    End_Procedure
48822>>>>>
48822>>>>>    Procedure OnExecute Variant vCommandBarControl
48824>>>>>        Handle hoCommandBars hoClientArea
48824>>>>>        Get CommandBarSystemObject to hoCommandBars
48825>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48826>>>>>        If hoClientArea Begin
48828>>>>>            Send Tile_Windows_Vertical of hoClientArea
48829>>>>>        End
48829>>>>>>
48829>>>>>    End_Procedure
48830>>>>>End_Class
48831>>>>>
48831>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
48832>>>>>
48832>>>>>    Procedure Construct_Object
48834>>>>>        Forward Send Construct_Object
48836>>>>>        Set psCaption to C_$CaptionMinimizeWindows 
48837>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
48838>>>>>        Set psDescription to  C_$DescMinimizeWindows
48839>>>>>        Set psCategory to C_$CategoryWindow
48840>>>>>    End_Procedure
48841>>>>>
48841>>>>>    Procedure OnExecute Variant vCommandBarControl
48843>>>>>        Handle hoCommandBars hoClientArea
48843>>>>>        Get CommandBarSystemObject to hoCommandBars
48844>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48845>>>>>        If hoClientArea Begin
48847>>>>>            // the clientarea's parent panel has message
48847>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
48848>>>>>        End
48848>>>>>>
48848>>>>>    End_Procedure
48849>>>>>End_Class
48850>>>>>
48850>>>>>
48850>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
48851>>>>>
48851>>>>>    Procedure Construct_Object
48853>>>>>        Forward Send Construct_Object
48855>>>>>        Set psCaption to C_$CaptionRestoreWindows
48856>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
48857>>>>>        Set psDescription to  C_$DescRestoreWindows
48858>>>>>        Set psCategory to C_$CategoryWindow
48859>>>>>    End_Procedure
48860>>>>>
48860>>>>>    Procedure OnExecute Variant vCommandBarControl
48862>>>>>        Handle hoCommandBars hoClientArea
48862>>>>>        Get CommandBarSystemObject to hoCommandBars
48863>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48864>>>>>        If hoClientArea Begin
48866>>>>>            // the clientarea's parent panel has message
48866>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
48867>>>>>        End
48867>>>>>>
48867>>>>>    End_Procedure
48868>>>>>End_Class
48869>>>>>
48869>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
48870>>>>>
48870>>>>>    Procedure Construct_Object
48872>>>>>        Forward Send Construct_Object
48874>>>>>        Set psCaption to C_$CaptionArrangeIcons  
48875>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
48876>>>>>        Set psDescription to  C_$DescArrangeIcons
48877>>>>>        Set psCategory to C_$CategoryWindow
48878>>>>>    End_Procedure
48879>>>>>
48879>>>>>    Procedure OnExecute Variant vCommandBarControl
48881>>>>>        Handle hoCommandBars hoClientArea
48881>>>>>        Get CommandBarSystemObject to hoCommandBars
48882>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48883>>>>>        If hoClientArea Begin
48885>>>>>            Send Arrange_Icons of hoClientArea
48886>>>>>        End
48886>>>>>>
48886>>>>>    End_Procedure
48887>>>>>
48887>>>>>End_Class
48888>>>>>    
48888>>>Use cCJAboutMenuItem.pkg
Including file: cCJAboutMenuItem.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\cCJAboutMenuItem.pkg)
48888>>>>>Use cCJCommandBarSystem.pkg
48888>>>>>Use LanguageText.pkg
48888>>>>>
48888>>>>>// It is expected that if you use this class that you provide an about object that is
48888>>>>>// activated via activate_about such as DfAbout.pkg. We don't use this for you automatically
48888>>>>>// because you may wish to create your own custom about package.
48888>>>>>
48888>>>>>Class cCJAboutMenuItem is a cCJMenuItem    
48889>>>>>
48889>>>>>    Procedure Construct_Object
48891>>>>>        Forward Send Construct_Object
48893>>>>>        Set psCaption to C_$CaptionAbout
48894>>>>>        Set psDescription to C_$ToolTipAbout
48895>>>>>        Set psToolTip to C_$DescAbout
48896>>>>>        Set psImage to "ActionAbout.ico"
48897>>>>>        Set psCategory to C_$CategoryHelp
48898>>>>>    End_Procedure
48899>>>>>    
48899>>>>>    Procedure OnExecute Variant vCommandBarControl
48901>>>>>        Handle hoCommandBars hoClientArea
48901>>>>>        Get CommandBarSystemObject to hoCommandBars
48902>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48903>>>>>        If hoClientArea Begin
48905>>>>>            Send Activate_About of hoClientArea
48906>>>>>        End
48906>>>>>>
48906>>>>>    End_Procedure
48907>>>>>
48907>>>>>End_Class
48908>>>>>
48908>>>>>
48908>>>Use cCJDeoMenuItemClasses.pkg
Including file: cCJDeoMenuItemClasses.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\cCJDeoMenuItemClasses.pkg)
48908>>>>>// various DEO menu classes
48908>>>>>
48908>>>>>Use cCJCommandBarSystem.pkg
48908>>>>>Use LanguageText.pkg
48908>>>>>
48908>>>>>// Sub-class for all Date entry menu items
48908>>>>>
48908>>>>>Class cCJDeoMenuItem is a cCJMenuItem
48909>>>>>    
48909>>>>>    Procedure Construct_Object
48911>>>>>        Forward Send Construct_Object
48913>>>>>        Set psCategory to C_$CategoryDEO
48914>>>>>        Set pbActiveUpdate to True
48915>>>>>    End_Procedure
48916>>>>>
48916>>>>>    // This just redirects to cCJCommandBarsSystem object
48916>>>>>    // returns information about the Focus object. If it returns True its a DEO. If a DEO the
48916>>>>>    // server, hasRecord, changed and hasindex info will all be returned by ref.
48916>>>>>    // If false, these are all unchanged.
48916>>>>>    Function DEOInformation Handle ByRef hoServer Boolean ByRef bHasRecord Boolean ByRef bChanged Boolean ByRef bHasIndex Returns Boolean
48918>>>>>        Handle hoCommandBars
48918>>>>>        Boolean bISDeo
48918>>>>>        Get CommandBarSystemObject to hoCommandBars // must exist or a programming bug
48919>>>>>        Get DEOInformation of hoCommandBars (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDEO
48920>>>>>        Function_Return bISDeo        
48921>>>>>    End_Function
48922>>>>>
48922>>>>>End_Class
48923>>>>>
48923>>>>>// use by all navigate DEOs.
48923>>>>>
48923>>>>>Class cCJDEONavigateMenuItem is a cCJDeoMenuItem
48924>>>>>    Procedure Construct_Object
48926>>>>>        Forward Send Construct_Object
48928>>>>>        Set psCategory to C_$CategoryNavigate
48929>>>>>    End_Procedure
48930>>>>>    
48930>>>>>    Function IsEnabled Returns Boolean
48932>>>>>        Boolean bIsDEO bHasRecord bChanged bEnabled bHasIndex
48932>>>>>        Handle hoServer
48932>>>>>        Get DEOInformation (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDeo
48933>>>>>        Function_Return (bIsDEO)
48934>>>>>    End_Function
48935>>>>>         
48935>>>>>End_Class         
48936>>>>>
48936>>>>>
48936>>>>>Class cCJClearMenuItem is a cCJDeoMenuItem
48937>>>>>    
48937>>>>>    Procedure Construct_Object
48939>>>>>        Forward Send Construct_Object
48941>>>>>        Set psCaption   to C_$CaptionClear
48942>>>>>        Set psToolTip to C_$ToolTipClear
48943>>>>>        Set psDescription to C_$DescClear
48944>>>>>        Set psImage to "ActionClear.ico"
48945>>>>>        Set psShortcut to "F5"
48946>>>>>    End_Procedure
48947>>>>>
48947>>>>>
48947>>>>>    Procedure OnExecute Variant vCommandBarControl
48949>>>>>        Send Request_Clear of (focus(Self))
48950>>>>>    End_Procedure
48951>>>>>    
48951>>>>>    Function IsEnabled Returns Boolean
48953>>>>>        Boolean bIsDEO bHasRecord bChanged bEnabled bHasIndex
48953>>>>>        Handle hoServer
48953>>>>>        Get DEOInformation (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDeo
48954>>>>>        Function_Return (bIsDEO and hoServer and (bChanged or bHasRecord))
48955>>>>>    End_Function
48956>>>>>         
48956>>>>>End_Class         
48957>>>>>
48957>>>>>
48957>>>>>Class cCJClearAllMenuItem is a cCJDeoMenuItem
48958>>>>>    
48958>>>>>    Procedure Construct_Object
48960>>>>>        Forward Send Construct_Object
48962>>>>>        Set psCaption   to C_$CaptionClearAll
48963>>>>>        Set psToolTip to C_$ToolTipClearAll
48964>>>>>        Set psDescription to C_$DescClearAll
48965>>>>>        Set psImage to "ActionClearAll.ico"
48966>>>>>        Set psShortcut to C_$Key_Ctrl_F5
48967>>>>>    End_Procedure
48968>>>>>
48968>>>>>    Procedure OnExecute Variant vCommandBarControl
48970>>>>>        Send Request_Clear_All of (focus(Self))
48971>>>>>    End_Procedure
48972>>>>>    
48972>>>>>    Function IsEnabled Returns Boolean
48974>>>>>        Boolean bIsDEO bHasRecord bChanged bEnabled bHasIndex
48974>>>>>        Handle hoServer
48974>>>>>        Get DEOInformation (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDeo
48975>>>>>        Function_Return (bIsDEO and hoServer and (bChanged or bHasRecord))
48976>>>>>    End_Function
48977>>>>>    
48977>>>>>End_Class         
48978>>>>>
48978>>>>>
48978>>>>>
48978>>>>>Class cCJSaveMenuItem is a cCJDeoMenuItem
48979>>>>>    
48979>>>>>    Procedure Construct_Object
48981>>>>>        Forward Send Construct_Object
48983>>>>>        Set psCaption   to C_$CaptionSave
48984>>>>>        Set psToolTip to C_$ToolTipSave
48985>>>>>        Set psDescription to C_$DescSave
48986>>>>>        Set psImage to "ActionSaveRecord.ico"
48987>>>>>        Set psShortcut to "F2"
48988>>>>>    End_Procedure
48989>>>>>
48989>>>>>
48989>>>>>    Procedure OnExecute Variant vCommandBarControl
48991>>>>>        Send Request_save of (focus(Self))
48992>>>>>    End_Procedure
48993>>>>>    
48993>>>>>    Function IsEnabled Returns Boolean
48995>>>>>        Boolean bIsDEO bHasRecord bChanged bEnabled bHasIndex
48995>>>>>        Handle hoServer
48995>>>>>        Get DEOInformation (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDeo
48996>>>>>        Function_Return (bIsDEO and hoServer and bChanged)
48997>>>>>    End_Function
48998>>>>>         
48998>>>>>End_Class         
48999>>>>>
48999>>>>>
48999>>>>>Class cCJSaveNCMenuItem is a cCJDeoMenuItem
49000>>>>>
49000>>>>>    Procedure Construct_Object
49002>>>>>        Forward Send Construct_Object
49004>>>>>        Set psCaption   to C_$CaptionSaveNC
49005>>>>>        Set psToolTip to C_$ToolTipSaveNC
49006>>>>>        Set psDescription to C_$DescSaveNC
49007>>>>>        Set psImage to "ActionSave.ico"
49008>>>>>        Set psShortcut to "F12"
49009>>>>>    End_Procedure
49010>>>>>
49010>>>>>    Procedure OnExecute Variant vCommandBarControl
49012>>>>>        Send Request_save_No_Clear of (focus(Self))
49013>>>>>    End_Procedure
49014>>>>>
49014>>>>>    Function IsEnabled Returns Boolean
49016>>>>>        Boolean bIsDEO bHasRecord bChanged bEnabled bHasIndex
49016>>>>>        Handle hoServer
49016>>>>>        Get DEOInformation (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDeo
49017>>>>>        Function_Return (bIsDEO and hoServer and bChanged)
49018>>>>>    End_Function
49019>>>>>
49019>>>>>End_Class
49020>>>>>
49020>>>>>
49020>>>>>
49020>>>>>Class cCJDeleteMenuItem is a cCJDeoMenuItem
49021>>>>>
49021>>>>>    Procedure Construct_Object
49023>>>>>        Forward Send Construct_Object
49025>>>>>        Set psCaption   to C_$CaptionDeleteRec
49026>>>>>        Set psToolTip to C_$ToolTipDeleteRec
49027>>>>>        Set psDescription to C_$DescDeleteRec
49028>>>>>        Set psImage to "ActionDeleteRecord.ico"
49029>>>>>        Set psShortcut to C_$Key_Shift_F2
49030>>>>>    End_Procedure
49031>>>>>
49031>>>>>    Procedure OnExecute Variant vCommandBarControl
49033>>>>>        Send Request_Delete of (focus(Self))
49034>>>>>    End_Procedure
49035>>>>>
49035>>>>>    Function IsEnabled Returns Boolean
49037>>>>>        Boolean bIsDEO bHasRecord bChanged bEnabled bHasIndex
49037>>>>>        Handle hoServer
49037>>>>>        Get DEOInformation (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDeo
49038>>>>>        Function_Return (bIsDEO and hoServer and bHasRecord)
49039>>>>>    End_Function
49040>>>>>
49040>>>>>End_Class
49041>>>>>
49041>>>>>
49041>>>>>Class cCJPromptMenuItem is a cCJDeoMenuItem
49042>>>>>     Procedure Construct_Object
49044>>>>>        Forward Send Construct_Object
49046>>>>>        Set psCaption   to C_$CaptionPrompt
49047>>>>>        Set psToolTip to C_$ToolTipPrompt
49048>>>>>        Set psDescription to C_$DescPrompt
49049>>>>>        Set psImage to "ActionPrompt.Ico"
49050>>>>>        Set psShortcut to "F4"
49051>>>>>    End_Procedure
49052>>>>>
49052>>>>>    Procedure OnExecute Variant vCommandBarControl
49054>>>>>        Send Prompt of (focus(Self))
49055>>>>>    End_Procedure
49056>>>>>
49056>>>>>    Function IsEnabled Returns Boolean
49058>>>>>        Handle hoFocus hoPrompt
49058>>>>>        Integer iDelegate
49058>>>>>        Get Focus to hoFocus
49059>>>>>        If (hoFocus>Desktop) Begin
49061>>>>>            Get Delegation_mode of hoFocus to iDelegate
49062>>>>>            Set Delegation_mode of hoFocus to No_Delegate_or_Error
49063>>>>>            Get Prompt_object   of hoFocus to hoPrompt
49064>>>>>            Set Delegation_mode of hoFocus to iDelegate
49065>>>>>        End
49065>>>>>>
49065>>>>>        Function_Return (hoPrompt<>0)
49066>>>>>    End_Function
49067>>>>>   
49067>>>>>End_Class
49068>>>>>
49068>>>>>
49068>>>>>Class cCJZoomMenuItem is a cCJDeoMenuItem
49069>>>>>     Procedure Construct_Object
49071>>>>>        Forward Send Construct_Object
49073>>>>>        Set psCaption   to C_$CaptionZoom
49074>>>>>        Set psToolTip to C_$ToolTipZoom
49075>>>>>        Set psDescription to C_$DescZoom
49076>>>>>        Set psShortcut to C_$Key_Alt_F9
49077>>>>>    End_Procedure
49078>>>>>
49078>>>>>    Procedure OnExecute Variant vCommandBarControl
49080>>>>>        Send Zoom of (focus(Self))
49081>>>>>    End_Procedure
49082>>>>>    
49082>>>>>    Function IsEnabled Returns Boolean
49084>>>>>        Handle hoFocus hoZoom 
49084>>>>>        Integer iDelegate
49084>>>>>        Get Focus to hoFocus
49085>>>>>        If (hoFocus>Desktop) Begin
49087>>>>>            Get Delegation_mode of hoFocus to iDelegate
49088>>>>>            Set Delegation_mode of hoFocus to No_Delegate_or_Error
49089>>>>>            Get Zoom_object   of hoFocus to hoZoom
49090>>>>>            Set Delegation_mode of hoFocus to iDelegate
49091>>>>>        End
49091>>>>>>
49091>>>>>        Function_Return (hoZoom<>0)
49092>>>>>    End_Function
49093>>>>>   
49093>>>>>End_Class
49094>>>>>
49094>>>>>
49094>>>>>Class cCJFindMenuItem is a cCJDeoMenuItem
49095>>>>>    
49095>>>>>    Procedure Construct_Object
49097>>>>>        Forward Send Construct_Object
49099>>>>>        Set psCaption   to C_$CaptionFindGE
49100>>>>>        Set psToolTip to C_$ToolTipFindGE
49101>>>>>        Set psDescription to C_$DescFindGE
49102>>>>>        Set psImage to "ActionFindEq.ico"
49103>>>>>        Set psShortcut to "F9"
49104>>>>>        
49104>>>>>    End_Procedure
49105>>>>>
49105>>>>>    Procedure OnExecute Variant vCommandBarControl
49107>>>>>        Send Find_GE of (focus(Self)) 
49108>>>>>    End_Procedure
49109>>>>>    
49109>>>>>    Function IsEnabled Returns Boolean
49111>>>>>        Boolean bIsDEO bHasRecord bChanged bEnabled bHasIndex bIsFind
49111>>>>>        Handle hoServer hoFocus hoCommandBars
49111>>>>>        Get DEOInformation (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDeo
49112>>>>>        If (bIsDEO and hoServer and bHasIndex) Begin
49114>>>>>            // if it is a candidate for finding we must check if this supports the DEO Find protocol
49114>>>>>            Get Focus of desktop to hoFocus
49115>>>>>            Get CommandBarSystemObject to hoCommandBars // must exist or a programming bug
49116>>>>>            Get Is_Function of hoCommandBars Get_Deo_Find_Object hoFocus True to bIsFind
49117>>>>>            Function_Return bIsFind
49118>>>>>        End
49118>>>>>>
49118>>>>>        Function_Return False
49119>>>>>    End_Function
49120>>>>>         
49120>>>>>End_Class         
49121>>>>>
49121>>>>>
49121>>>>>Class cCJFindNextMenuItem is a cCJFindMenuItem
49122>>>>>    
49122>>>>>    Procedure Construct_Object
49124>>>>>        Forward Send Construct_Object
49126>>>>>        Set psCaption   to C_$CaptionFindGT
49127>>>>>        Set psToolTip to C_$ToolTipFindGT
49128>>>>>        Set psDescription to C_$DescFindGT
49129>>>>>        Set psImage to "ActionNext.ico"
49130>>>>>        Set psShortcut to "F8"
49131>>>>>    End_Procedure
49132>>>>>
49132>>>>>    Procedure OnExecute Variant vCommandBarControl
49134>>>>>        Send Find_Next of (focus(Self)) 
49135>>>>>    End_Procedure
49136>>>>>    
49136>>>>>End_Class         
49137>>>>>
49137>>>>>
49137>>>>>Class cCJFindPreviousMenuItem is a cCJFindMenuItem
49138>>>>>    
49138>>>>>    Procedure Construct_Object
49140>>>>>        Forward Send Construct_Object
49142>>>>>        Set psCaption   to C_$CaptionFindLT
49143>>>>>        Set psToolTip to C_$ToolTipFindLT
49144>>>>>        Set psDescription to C_$DescFindLT
49145>>>>>        Set psImage to "ActionPrevious.ico"
49146>>>>>        Set psShortcut to "F7"
49147>>>>>    End_Procedure
49148>>>>>
49148>>>>>    Procedure OnExecute Variant vCommandBarControl
49150>>>>>        Send Find_Previous of (focus(Self)) 
49151>>>>>    End_Procedure
49152>>>>>    
49152>>>>>End_Class        
49153>>>>>
49153>>>>>
49153>>>>>Class cCJFindFirstMenuItem is a cCJFindMenuItem
49154>>>>>    
49154>>>>>    Procedure Construct_Object
49156>>>>>        Forward Send Construct_Object
49158>>>>>        Set psCaption   to C_$CaptionFindFirst
49159>>>>>        Set psToolTip to C_$ToolTipFindFirst
49160>>>>>        Set psDescription to C_$DescFindFirst
49161>>>>>        Set psImage to "ActionFirst.ico"
49162>>>>>        Set psShortcut to C_$Key_Ctrl_Home
49163>>>>>    End_Procedure
49164>>>>>
49164>>>>>    Procedure OnExecute Variant vCommandBarControl
49166>>>>>        Send Find_First of (focus(Self)) 
49167>>>>>    End_Procedure
49168>>>>>    
49168>>>>>End_Class         
49169>>>>>
49169>>>>>
49169>>>>>Class cCJFindLastMenuItem is a cCJFindMenuItem
49170>>>>>    
49170>>>>>    Procedure Construct_Object
49172>>>>>        Forward Send Construct_Object
49174>>>>>        Set psCaption   to C_$CaptionFindLast
49175>>>>>        Set psToolTip to C_$ToolTipFindLast
49176>>>>>        Set psDescription to C_$DescFindLast
49177>>>>>        Set psImage to "ActionLast.ico"
49178>>>>>        Set psShortcut to C_$Key_Ctrl_End
49179>>>>>    End_Procedure
49180>>>>>
49180>>>>>    Procedure OnExecute Variant vCommandBarControl
49182>>>>>        Send Find_Last of (focus(Self)) 
49183>>>>>    End_Procedure
49184>>>>>    
49184>>>>>End_Class         
49185>>>>>
49185>>>>>
49185>>>>>
49185>>>>>Class cCJSuperFindMenuItem is a cCJFindMenuItem
49186>>>>>    
49186>>>>>    Procedure Construct_Object
49188>>>>>        Forward Send Construct_Object
49190>>>>>        Set psCaption   to C_$CaptionSuperFindGE
49191>>>>>        Set psToolTip to C_$ToolTipSuperFindGE
49192>>>>>        Set psDescription to C_$DescSuperFindGE
49193>>>>>        Set psImage to "ActionSuperFindEq.ico"
49194>>>>>        Set psShortcut to "F9"
49195>>>>>        
49195>>>>>    End_Procedure
49196>>>>>
49196>>>>>    Procedure OnExecute Variant vCommandBarControl
49198>>>>>        Send SuperFind of (focus(Self)) 
49199>>>>>    End_Procedure
49200>>>>>    
49200>>>>>    Function IsEnabled Returns Boolean
49202>>>>>        Boolean bIsDEO bHasRecord bChanged bEnabled bHasIndex
49202>>>>>        Handle hoServer
49202>>>>>        Get DEOInformation (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDeo
49203>>>>>        Function_Return (bIsDEO and hoServer and bHasIndex)
49204>>>>>    End_Function
49205>>>>>         
49205>>>>>End_Class         
49206>>>>>
49206>>>>>
49206>>>>>
49206>>>>>Class cCJSuperFindNextMenuItem is a cCJFindMenuItem
49207>>>>>    
49207>>>>>    Procedure Construct_Object
49209>>>>>        Forward Send Construct_Object
49211>>>>>        Set psCaption   to C_$CaptionSuperFindGT
49212>>>>>        Set psToolTip to C_$ToolTipSuperFindGT
49213>>>>>        Set psDescription to C_$DescSuperFindGT
49214>>>>>        Set psImage to "ActionSuperFindNext.ico"
49215>>>>>        Set psShortcut to "F8"
49216>>>>>    End_Procedure
49217>>>>>
49217>>>>>    Procedure OnExecute Variant vCommandBarControl
49219>>>>>        Send SuperFind_Next of (focus(Self)) 
49220>>>>>    End_Procedure
49221>>>>>    
49221>>>>>End_Class         
49222>>>>>
49222>>>>>
49222>>>>>Class cCJSuperFindPreviousMenuItem is a cCJFindMenuItem
49223>>>>>    
49223>>>>>    Procedure Construct_Object
49225>>>>>        Forward Send Construct_Object
49227>>>>>        Set psCaption   to C_$CaptionSuperFindLT
49228>>>>>        Set psToolTip to C_$ToolTipSuperFindLT
49229>>>>>        Set psDescription to C_$DescSuperFindLT
49230>>>>>        Set psImage to "ActionSuperFindPrev.ico"
49231>>>>>        Set psShortcut to "F7"
49232>>>>>    End_Procedure
49233>>>>>
49233>>>>>    Procedure OnExecute Variant vCommandBarControl
49235>>>>>        Send SuperFind_Previous of (focus(Self)) 
49236>>>>>    End_Procedure
49237>>>>>    
49237>>>>>End_Class        
49238>>>>>
49238>>>>>
49238>>>>>Class cCJNextAreaMenu is a cCJDeoNavigateMenuItem
49239>>>>>
49239>>>>>    Procedure Construct_Object
49241>>>>>        Forward Send Construct_Object
49243>>>>>        Set psCaption to C_$CaptionNextArea
49244>>>>>        Set psDescription to C_$DescNextArea
49245>>>>>        Set psToolTip to C_$ToolTipNextArea
49246>>>>>        Set psShortcut to "F6"
49247>>>>>        Set psImage to "ActionNextArea.ico"
49248>>>>>    End_Procedure
49249>>>>>        
49249>>>>>    Procedure OnExecute Variant vCommandBarControl
49251>>>>>        Send Switch_Next_Area of (Focus(Self))
49252>>>>>    End_Procedure
49253>>>>>        
49253>>>>>End_Class
49254>>>>>    
49254>>>>>Class cCJPriorAreaMenu is a cCJDeoNavigateMenuItem
49255>>>>>
49255>>>>>    Procedure Construct_Object
49257>>>>>        Forward Send Construct_Object
49259>>>>>        Set psCaption to C_$CaptionPriorArea
49260>>>>>        Set psDescription to C_$DescPriorArea
49261>>>>>        Set psToolTip to C_$ToolTipPriorArea
49262>>>>>        Set psShortcut to C_$Key_Shift_F6
49263>>>>>        Set psImage to "ActionPrevArea.ico"
49264>>>>>    End_Procedure
49265>>>>>        
49265>>>>>    Procedure OnExecute Variant vCommandBarControl
49267>>>>>        Send Switch_Prior_Area of (Focus(Self))
49268>>>>>    End_Procedure
49269>>>>>    
49269>>>>>End_Class
49270>>>>>    
49270>>>>>Class cCJNextViewMenu is a cCJDeoNavigateMenuItem
49271>>>>>
49271>>>>>    Procedure Construct_Object
49273>>>>>        Forward Send Construct_Object
49275>>>>>        Set psCaption to C_$CaptionNextView
49276>>>>>        Set psDescription to C_$DescNextView
49277>>>>>        Set psToolTip to C_$ToolTipNextView
49278>>>>>        Set psShortcut to C_$Key_Alt_F6
49279>>>>>        Set psImage to "ActionNextView.ico"
49280>>>>>    End_Procedure
49281>>>>>        
49281>>>>>    Procedure OnExecute Variant vCommandBarControl
49283>>>>>        Handle hoCommandBars hoClientArea
49283>>>>>        Get CommandBarSystemObject to hoCommandBars
49284>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
49285>>>>>        If hoClientArea Begin
49287>>>>>            Send Switch_Next_View of hoClientArea
49288>>>>>        End
49288>>>>>>
49288>>>>>    End_Procedure
49289>>>>>    
49289>>>>>End_Class
49290>>>>>    
49290>>>>>Class cCJPriorViewMenu is a cCJDeoNavigateMenuItem
49291>>>>>
49291>>>>>    Procedure Construct_Object
49293>>>>>        Forward Send Construct_Object
49295>>>>>        Set psCaption to C_$CaptionPriorView
49296>>>>>        Set psDescription to C_$DescPriorView
49297>>>>>        Set psToolTip to C_$ToolTipPriorView
49298>>>>>        Set psShortcut to C_$Key_Ctrl_F6
49299>>>>>        Set psImage to "ActionPrevView.ico"
49300>>>>>    End_Procedure
49301>>>>>        
49301>>>>>    Procedure OnExecute Variant vCommandBarControl
49303>>>>>        Handle hoCommandBars hoClientArea
49303>>>>>        Get CommandBarSystemObject to hoCommandBars
49304>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
49305>>>>>        If hoClientArea Begin
49307>>>>>            Send Switch_Prior_View of hoClientArea
49308>>>>>        End
49308>>>>>>
49308>>>>>    End_Procedure
49309>>>>>        
49309>>>>>End_Class
49310>>>Use cCJMDIWindowsMenuItem.pkg
Including file: cCJMDIWindowsMenuItem.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\cCJMDIWindowsMenuItem.pkg)
49310>>>>>Use cCJCommandBarSystem.pkg
49310>>>>>
49310>>>>>Register_Function Client_ID Returns Integer
49310>>>>>
49310>>>>>// only used by cCJMDIWIndowsMenuItem
49310>>>>>Class cCJMDIWindowItem is a cCJMenuItem
49311>>>>>
49311>>>>>    Procedure Construct_Object
49313>>>>>        Forward Send Construct_Object
49315>>>>>        Property Handle phWindow 0 // object id of view
49316>>>>>        Set pbControlFlagNoMovable to True
49317>>>>>        Set pbActiveUpdate to True
49318>>>>>    End_Procedure
49319>>>>>    
49319>>>>>    Procedure OnExecute Variant vCommandBarControl
49321>>>>>        Handle hWindow
49321>>>>>        Get phWindow to hWindow
49322>>>>>        Send Activate_View of hWindow
49323>>>>>    End_Procedure
49324>>>>>    
49324>>>>>End_Class                
49325>>>>>
49325>>>>>
49325>>>>>Class cCJMDIWindowsMenuItem is a cCJMenuItem
49326>>>>>    
49326>>>>>    Procedure Construct_Object
49328>>>>>        Forward Send Construct_Object
49330>>>>>        Property Handle[] phArrayOfWindows
49331>>>>>        Set peControlType to xtpControlPopup
49332>>>>>        Set psCategory to C_$CategoryWindow
49333>>>>>    End_Procedure
49334>>>>>    
49334>>>>>     // This adds MDI windows to the existing menu items.
49334>>>>>     // This removes any existing windows menus and always adds a new set to the end
49334>>>>>
49334>>>>>     Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
49336>>>>>        Handle  hClientArea hView
49336>>>>>        String  sLabel
49336>>>>>        Integer i iWindows
49336>>>>>        Handle[] hArrayOfWindows
49337>>>>>        Variant vItem
49337>>>>>        
49337>>>>>        // delete all windows actions and menu items. Assume we have an array of DF action objects for the windows
49337>>>>>        // also assume that destroying an action removes all menu instances of that action
49337>>>>>        Get phArrayOfWindows to hArrayOfWindows
49338>>>>>        Move (SizeOfArray(hArrayOfWindows)) to iWindows
49339>>>>>        For i from 0 to (iWindows-1)
49345>>>>>>
49345>>>>>            Send Destroy of hArrayOfWindows[i] // assume this removes all menu items of this action
49346>>>>>        Loop
49347>>>>>>
49347>>>>>        Move (ResizeArray(hArrayOfWindows,0)) to hArrayOfWindows
49348>>>>>
49348>>>>>        // Add all views to this menu. Create the action and add the item
49348>>>>>        Move 0 to i
49349>>>>>        Get Client_Id to hClientArea // object id of client area
49350>>>>>        If (hClientArea > 0) Begin
49352>>>>>            Get Next_Mdi_Dialog of hClientArea True to hView // find first view
49353>>>>>            While (hView <> 0)
49357>>>>>                If (Active_State(hView)) Begin
49359>>>>>                    // create the action
49359>>>>>                    Get Create U_cCJMDIWindowItem to hArrayOfWindows[i]
49360>>>>>                    Get Label of hView to sLabel // caption bar (name) of view
49361>>>>>                    Set psCaption of hArrayOfWindows[i] to sLabel
49362>>>>>                    Set psDescription of hArrayOfWindows[i] to ("Make this view (" - trim(sLabel) - ") the active window.")
49363>>>>>                    If (current_scope(desktop)=hView and View_mode(hView)<>VIEWMODE_ICONIZE) Begin
49365>>>>>                        Set pbChecked of hArrayOfWindows[i] to True
49366>>>>>                    End
49366>>>>>>
49366>>>>>                    Set phWindow of hArrayOfWindows[i] to hView // used by custom OnExecute
49367>>>>>                    If (i=0) Begin
49369>>>>>                        Set pbControlBeginGroup of hArrayOfWindows[i] to True
49370>>>>>                    End
49370>>>>>>
49370>>>>>                    // Create a menu item for this action
49370>>>>>                    Get AddDynamicControl of hArrayOfWindows[i] hCommandBarControls to vItem
49371>>>>>                    Increment i
49372>>>>>                End
49372>>>>>>
49372>>>>>                Get Next_Mdi_Dialog of hClientArea False to hView // find next
49373>>>>>            Loop
49374>>>>>>
49374>>>>>        End
49374>>>>>>
49374>>>>>
49374>>>>>        Set phArrayOfWindows to hArrayOfWindows
49375>>>>>
49375>>>>>     End_Procedure
49376>>>>>     
49376>>>>>End_Class
49377>>>>>
49377>
49377>Object oHtmlHelp is a cHtmlHelp
49379>End_Object
49380>
49380>Object oApplication is a cApplication
49382>    Set peHelpType to htHtmlHelp
49383>
49383>    Procedure OnCreate
49386>        Handle hoCmdLine
49386>        Integer iNumArgs iArg
49386>        Get phoCommandLine to hoCmdLine
49387>    End_Procedure
49388>
49388>End_Object
49389>
49389>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\oEditContextMenu.pkg)
49389>>>Use cCJStandardMenuItemClasses.pkg
49389>>>
49389>>>Object oEditContextMenu is a cCJContextMenu
49391>>>    
49391>>>    Move Self to Default_Form_Floating_Menu_ID
49392>>>    
49392>>>    Object oUndoMenuItem is a cCJUndoMenuItem
49394>>>    End_Object
49395>>>    
49395>>>    Object oCutMenuItem is a cCJCutMenuItem
49397>>>        Set pbControlBeginGroup to True
49398>>>    End_Object
49399>>>    
49399>>>    Object oCopyMenuItem is a cCJCopyMenuItem
49401>>>    End_Object
49402>>>
49402>>>    Object oPasteMenuItem is a cCJPasteMenuItem
49404>>>    End_Object
49405>>>
49405>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
49407>>>    End_Object
49408>>>
49408>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
49410>>>        Set pbControlBeginGroup to True
49411>>>    End_Object
49412>>>
49412>>>End_Object
49413>>>
49413>Use oDEOEditContextMenu.pkg
Including file: oDEOEditContextMenu.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\oDEOEditContextMenu.pkg)
49413>>>Use Windows.pkg
49413>>>Use cCJStandardMenuItemClasses.pkg
49413>>>Use cCJDeoMenuItemClasses.pkg
49413>>>
49413>>>
49413>>>Object oDEOEditContextMenu is a cCJContextMenu
49415>>>    
49415>>>    Move Self to Default_dbFloating_Menu_ID
49416>>>    
49416>>>    Object oUndoMenuItem is a cCJUndoMenuItem
49418>>>    End_Object
49419>>>    
49419>>>    Object oCutMenuItem is a cCJCutMenuItem
49421>>>        Set pbControlBeginGroup to True
49422>>>    End_Object
49423>>>    
49423>>>    Object oCopyMenuItem is a cCJCopyMenuItem
49425>>>    End_Object
49426>>>
49426>>>    Object oPasteMenuItem is a cCJPasteMenuItem
49428>>>    End_Object
49429>>>
49429>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
49431>>>    End_Object
49432>>>
49432>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
49434>>>        Set pbControlBeginGroup to True
49435>>>    End_Object
49436>>>
49436>>>    Object oPromptMenuItem is a cCJPromptMenuItem
49438>>>        Set pbControlBeginGroup to True
49439>>>    End_Object
49440>>>
49440>>>    Object oFindNextMenu is a cCJFindNextMenuItem
49442>>>        Set pbControlBeginGroup to True
49443>>>    End_Object
49444>>>
49444>>>    Object oFindPreviousMenu is a cCJFindPreviousMenuItem
49446>>>    End_Object
49447>>>
49447>>>    Object oClearMenuItem is a cCJClearMenuItem
49449>>>        Set pbControlBeginGroup to True
49450>>>    End_Object
49451>>>
49451>>>    Object oClearAllMenu is a cCJClearAllMenuItem
49453>>>    End_Object
49454>>>
49454>>>    Object oSaveMenu is a cCJSaveMenuItem
49456>>>    End_Object
49457>>>    
49457>>>    Object oSaveNCMenu is a cCJSaveNCMenuItem
49459>>>    End_Object
49460>>>    Object oDeleteMenu is a cCJDeleteMenuItem
49462>>>    End_Object
49463>>>
49463>>>
49463>>>End_Object
49464>
49464>
49464>Use MERTECH.INC
Including file: MERTECH.INC    (C:\Program Files\Visual DataFlex 14.1\Pkg\MERTECH.INC)
49464>>>//*************************************************************************
49464>>>//*                                                                       *
49464>>>//*  Confidential Trade Secret.                                           *
49464>>>//*  Copyright (c) 1997-2008 Mertech Data Systems Inc, Miami Florida      *
49464>>>//*  All rights reserved.                                                 *
49464>>>//*  DataFlex is a registered trademark of Data Access Corporation.       *
49464>>>//*                                                                       *
49464>>>//*************************************************************************
49464>>>USE UI
49464>>>
#REM -----------------------------------------------
#REM MERTECH DATA SYSTEMS INC. - WWW.MERTECHDATA.COM
#REM MERTECH.INC VERSION 2.6.18
#REM -----------------------------------------------
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>
49464>>>// SQLFlex Lock Type
49464>>>
49464>>>// Extended Callback Types
49464>>>
49464>>>
49464>>>INTEGER _SAVEFILENUMBER#
49464>>>
49464>>>// dfStructureEnd Option bits
49464>>>
49464>>>//
49464>>>Enum_List  //  Call_Driver Functions
49464>>>    DEfine CALLDRV_LICENSE_ENVIRONMENT_SET      FOR 0
49464>>>    Define CALLDRV_ORA_CURRENT_SQL_SERVER       FOR 6
49464>>>    Define CALLDRV_CURRENT_SQL_SERVER           FOR 19
49464>>>    Define CALLDRV_SQL_MAX_CURSORS              FOR 26
49464>>>    Define CALLDRV_SQLLOADER_FIELDS_TERM        FOR 30
49464>>>    Define CALLDRV_CREATE_TABLE_FROM_DAT        FOR 30
49464>>>    Define CALLDRV_SQLLOADER_DECIMAL_SEP        FOR 31
49464>>>    Define CALLDRV_SQLFLEX_MAX_CURSORS          FOR 37
49464>>>
49464>>>    Define CALLDRV_GET_RETURNED_COLUMNS         FOR 39
49464>>>    Define CALLDRV_GET_RETURNED_ROWS            FOR 40
49464>>>    Define CALLDRV_GET_COLUMN_ATTRIBUTE         FOR 41
49464>>>    Define CALLDRV_START_TXTGEN_AFTER_RECNUM    FOR 42
49464>>>    Define CALLDRV_FINISH_TXTGEN_AFTER_RECNUM   FOR 43
49464>>>    Define CALLDRV_SET_ISOLATION_LEVEL          FOR 44
49464>>>    Define CALLDRV_GET_SERVER_CFG               FOR 45
49464>>>    Define CALLDRV_SET_SQL_LOCK_TIMEOUT         FOR 46
49464>>>    Define CALLDRV_GET_SQL_LOCK_TIMEOUT         FOR 47
49464>>>    Define CALLDRV_GET_RESULTS                  FOR 48
49464>>>    Define CALLDRV_GET_MORE_RESULTS             FOR 49
49464>>>    Define CALLDRV_GET_CURRENT_USER_NAME        FOR 50
49464>>>    Define CALLDRV_OPEN_EMBEDDED_CURSOR         FOR 51
49464>>>    Define CALLDRV_CLOSE_EMBEDDED_CURSOR        FOR 52
49464>>>    Define CALLDRV_SET_CURRENT_EMBEDDED_CURSOR  FOR 53
49464>>>    Define CALLDRV_GET_CURRENT_EMBEDDED_CURSOR  FOR 54
49464>>>    Define CALLDRV_SET_MAX_EMBEDDED_CURSOR      FOR 55
49464>>>    Define CALLDRV_GET_MAX_EMBEDDED_CURSOR      FOR 56
49464>>>    Define CALLDRV_SQL_TRANSACTION              FOR 57
49464>>>    Define CALLDRV_LOCAL_TD_PATH                FOR 58
49464>>>    Define CALLDRV_CREATE_DB                    FOR 59
49464>>>    Define CALLDRV_ESCAPE_STRING                FOR 60
49464>>>    Define CALLDRV_SET_PROC_ATTRIBUTE_TYPE      FOR 61
49464>>>    Define CALLDRV_SQL_REFRESH_CACHE            FOR 62
49464>>>    Define CALLDRV_GET_SQL_STMT                 FOR 63
49464>>>    Define CALLDRV_DIRECT_PATH_LOAD             FOR 64
49464>>>
49464>>>    Define CALLDRV_READ_LOB                     FOR 65
49464>>>    Define CALLDRV_WRITE_LOB                    FOR 66
49464>>>    Define CALLDRV_APPEND_LOB                   FOR 67
49464>>>    Define CALLDRV_LENGTH_LOB                   FOR 68
49464>>>    Define CALLDRV_LOADFROMFILE_LOB             FOR 69
49464>>>    Define CALLDRV_ERASE_LOB                    FOR 70
49464>>>    Define CALLDRV_TRUNCATE_LOB                 FOR 71
49464>>>    Define CALLDRV_INITIALIZE_SEQUENCE          FOR 72
49464>>>    Define CALLDRV_CLIENT_CFG                   FOR 73
49464>>>    Define CALLDRV_END_SAVERECORD               FOR 74
49464>>>    Define CALLDRV_ENABLE_RECONNECT             FOR 75
49464>>>    Define CALLDRV_ENUMERATE_SERVER             FOR 76
49464>>>    Define CALLDRV_USE_ROWCOUNT_IN_TRANSACTIONS FOR 77
49464>>>    Define CALLDRV_USE_DFLEX_DATE_FORMAT        FOR 78
49464>>>    Define CALLDRV_FORCE_FIELDS_NOT_NULL        FOR 79
49464>>>    Define CALLDRV_ORA_CREATE_TABLE_FROM_DAT    FOR 80
49464>>>    Define CALLDRV_MAX_DATA_SIZE                FOR 81
49464>>>    Define CALLDRV_CHUNK_SIZE                   FOR 82
49464>>>    Define CALLDRV_GET_DATA_CHUNK               FOR 83
49464>>>    Define CALLDRV_MIRROR_SERVER                FOR 84
49464>>>    Define CALLDRV_COPY_DATA                    FOR 85
49464>>>    Define CALLDRV_SET_SQL_CURSOR_TYPE          FOR 86
49464>>>    Define CALLDRV_ICF                          FOR 87
49464>>>    Define CALLDRV_CLEAR_INT_CACHE              FOR 88
49464>>>    Define CALLDRV_GET_CURRENT_USER_PASSWORD    FOR 89
49464>>>    Define CALLDRV_FORCE_FIELDS_NULL            FOR 90
49464>>>End_Enum_List
49464>>>
49464>>>// License and environment settings
49464>>>Enum_List
49464>>>    Define CALLDRV_DRIVER_REVISION             FOR 0
49464>>>    Define CALLDRV_COMPANY_NAME                FOR 1
49464>>>    Define CALLDRV_SERIAL_NUMBER               FOR 2
49464>>>    Define CALLDRV_LICENSED_USERS              FOR 3
49464>>>    Define CALLDRV_MAJOR_REVISION              FOR 4
49464>>>    Define CALLDRV_VERSION_COMMENTS            FOR 5
49464>>>    Define CALLDRV_OLEDB_OEM_TRANSLATION       FOR 6
49464>>>    Define CALLDRV_SET_DB_PORT                 FOR 7
49464>>>    Define CALLDRV_GET_DB_PORT                 FOR 8
49464>>>    Define CALLDRV_SET_DB_SOCKET               FOR 9
49464>>>    Define CALLDRV_GET_DB_SOCKET               FOR 10
49464>>>    Define CALLDRV_SET_AS_SYSDBA               FOR 11
49464>>>    Define CALLDRV_OEM_TRANSLATION_STATE       FOR 12
49464>>>End_Enum_List
49464>>>
49464>>>Enum_List  // CALLDRV_ENUMERATE_SERVER_OPTION
49464>>>    Define CALLDRV_ENUMERATE_SERVER_COUNT       FOR 0
49464>>>    Define CALLDRV_ENUMERATE_SERVER_SERVER      FOR 1
49464>>>End_Enum_List
49464>>>
49464>>>// Embedded SQL Cursor Types
49464>>>Enum_List
49464>>>    Define CALLDRV_ENUMERATE_CURSOR_TYPE_NONE           FOR 0
49464>>>    Define CALLDRV_ENUMERATE_CURSOR_TYPE_CLIENT         FOR 1
49464>>>    Define CALLDRV_ENUMERATE_CURSOR_TYPE_SERVER         FOR 2
49464>>>    Define CALLDRV_ENUMERATE_CURSOR_TYPE_PARAMETERIZED  FOR 3
49464>>>End_Enum_List
49464>>>
49464>>>Enum_List
49464>>>    Define CALLDRV_VALUE_GET                    FOR 0
49464>>>    Define CALLDRV_VALUE_SET                    FOR 1
49464>>>End_Enum_List
49464>>>
49464>>>// Inverse Key types
49464>>>Enum_List
49464>>>    Define REGULAR_SEG                          FOR -1
49464>>>    Define INVK_CASE_SEG                        FOR 0
49464>>>    Define INVK_DESC_SEG                        FOR 1
49464>>>    Define INVK_DESC_AND_CASE_SEG               FOR 2
49464>>>End_Enum_List
49464>>>
49464>>>// DB2 Index Types
49464>>>Enum_List
49464>>>    Define REG_INDEX                            FOR 0
49464>>>    Define REV_INDEX                            FOR 1
49464>>>    Define CLUST_INDEX                          FOR 2
49464>>>    Define REV_CLUST_INDEX                      FOR 3
49464>>>End_Enum_List
49464>>>
49464>>>// Oracle Procedure Arguments type
49464>>>Enum_List
49464>>>    Define IS_NONE                              FOR 0
49464>>>    Define IS_IN                                FOR 1
49464>>>    Define IS_OUT                               FOR 2
49464>>>    Define IS_IN_OUT                            FOR 3
49464>>>    Define IS_RSET                              FOR 4
49464>>>End_Enum_List
49464>>>
49464>>>//  SQL_GET_COL Attributes
49464>>>Enum_List
49464>>>    Define SQL_GET_COL_ATTRIB_SIZE              FOR 1
49464>>>    Define SQL_GET_COL_ATTRIB_DECIMALS          FOR 2
49464>>>    Define SQL_GET_COL_ATTRIB_LABEL             FOR 3
49464>>>    Define SQL_GET_COL_ATTRIB_COLUMN_NAME       FOR 4
49464>>>    Define SQL_GET_COL_ATTRIB_TABLE_NAME        FOR 5
49464>>>    Define SQL_GET_COL_ATTRIB_SQLTYPE           FOR 6
49464>>>    Define SQL_GET_COL_ATTRIB_NULLABLE          FOR 7
49464>>>    Define SQL_GET_COL_ATTRIB_DFTYPE            FOR 8
49464>>>    Define SQL_GET_COL_ATTRIB_DATA_LENGTH       FOR 9
49464>>>End_Enum_List
49464>>>
49464>>>// Declare Global variables
49464>>>    String _DRIVERNAME# 255
49464>>>
49464>>>
49464>>>//Last Revised: 2007-08-08 By: Marcelo
49464>>>Object oMertechInc Is An Array
49466>>>    Property String  psArg1      Public ""
49468>>>    Property String  psArg2      Public ""
49470>>>    Property Integer piRet       Public 0
49472>>>    Property Integer piDecSep    Public 0
49474>>>
49474>>>    Procedure FillsArg1 Integer iSize
49477>>>        Set psArg1 to (REPEAT(" ",iSize))
49478>>>    End_Procedure
49479>>>
49479>>>    Procedure FillsArg2 Integer iSize
49482>>>        Set psArg2 to (REPEAT(" ",iSize))
49483>>>    End_Procedure
49484>>>
49484>>>    Procedure SetDecimalSeparator
49487>>>        Local Integer liDecSep
49487>>>        GET_ATTRIBUTE DF_DECIMAL_SEPARATOR TO liDecSep
49490>>>        Set piDecSep to liDecSep
49491>>>
49491>>>        If liDecSep Ne 46 SET_ATTRIBUTE DF_DECIMAL_SEPARATOR TO 46 // (.) WILL BE DECIMAL SEPARATOR
49496>>>    End_Procedure
49497>>>
49497>>>    Procedure RestoreDecimalSeparator
49500>>>        Local Integer liDecSep
49500>>>        Get piDecSep to liDecSep
49501>>>        If liDecSep Ne 46 SET_ATTRIBUTE DF_DECIMAL_SEPARATOR TO liDecSep
49506>>>    End_Procedure
49507>>>
49507>>>    Procedure SetsArg1Numeric String sValue
49510>>>        Send SetDecimalSeparator
49511>>>        Set psArg1 to sValue
49512>>>        Send RestoreDecimalSeparator
49513>>>    End_Procedure
49514>>>
49514>>>    Procedure SetsArg2Numeric String sValue
49517>>>        Send SetDecimalSeparator
49518>>>        Set psArg2 to sValue
49519>>>        Send RestoreDecimalSeparator
49520>>>    End_Procedure
49521>>>
49521>>>    Function GetpsArg1 Returns String
49524>>>        Function_Return (psArg1(_SELF#))
49525>>>    End_Function
49526>>>
49526>>>    Function GetpsArg2 Returns String
49529>>>        Function_Return (psArg2(_SELF#))
49530>>>    End_Function
49531>>>
49531>>>    Function GetpiRet Returns String
49534>>>        Function_Return (piRet(_SELF#))
49535>>>    End_Function
49536>>>
49536>>>    Function doCallDriver# Integer iFileNumber String sDriverID Integer iFunction String sArg1 String sArg2 Integer iLong Returns Integer
49539>>>        Local Integer liRetval
49539>>>        Local String lsArg1 lsArg2
49539>>>
49539>>>        Move sArg1 to lsArg1
49540>>>        Move sArg2 to lsArg2
49541>>>
49541>>>        Call_Driver iFileNumber sDRiverID Function iFunction Callback 0 Passing lsArg1 lsArg2 iLong Result liRetval
49546>>>
49546>>>        Set psArg1 to lsArg1
49547>>>        Set psArg2 to lsArg2
49548>>>        Set piRet  to liRetval
49549>>>        Function_Return liRetval
49550>>>    End_Function
49551>>>
49551>>>    Function doCallDriver2# Integer iFileNumber String sDriverID Integer iFunction Integer iLong Returns Integer
49554>>>        Local Integer liRetval
49554>>>        Local String lsArg1 lsArg2
49554>>>
49554>>>        Move (psArg1(_SELF#)) to lsArg1
49555>>>        Move (psArg2(_SELF#)) to lsArg2
49556>>>
49556>>>        Call_Driver iFileNumber sDRiverID Function iFunction Callback 0 Passing lsArg1 lsArg2 iLong Result liRetval
49561>>>
49561>>>        Set psArg1 to lsArg1
49562>>>        Set psArg2 to lsArg2
49563>>>        Set piRet  to liRetval
49564>>>        Function_Return liRetval
49565>>>    End_Function
49566>>>
49566>>>End_Object
49567>>>
49567>>>//Last Revised: 2007-08-08 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-10-25 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-10-25 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-08-08 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-08-08 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2004-11-09 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-08-08 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-08-08 By: Marcelo
49567>>>
49567>>>//Last Revised: 2004-07-13 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//==========================================
49567>>>// SELECT STUFFS
49567>>>//==========================================
49567>>>
49567>>>//Last Revised: 2007-08-08 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-08-08 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-08-08 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2008-01-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2008-07-25 By: Thomas
49567>>>
49567>>>//Last Revised: 2008-01-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-09-06 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-09-07 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-09-06 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-09-06 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-09-06 By: Marcelo
49567>>>
49567>>>//Last Revised: 2003-03-27 By: Marcelo
49567>>>
49567>>>//Last Revised: 2003-03-27 By: Marcelo
49567>>>
49567>>>//Last Revised: 2003-03-27 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-09-22 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-09-22 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-08-03 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2008-08-10 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-08-08 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2008-02-25 By: Marcelo
49567>>>
49567>>>//Last Revised: 2003-08-27 By: Marcelo
49567>>>// SQL_GET_OUTPUT_VALUE <POSITION> TO <VARIABLE>
49567>>>
49567>>>//Last Revised: 2007-09-13 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-08-03 By: Marcelo
49567>>>
49567>>>//Last Revised: 2008-01-29 By: Marcelo
49567>>>
49567>>>//Last Revised: 2008-01-29 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-09-07 By: Marcelo
49567>>>
49567>>>
49567>>>//Last Revised: 2005-08-29 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-08-29 By: Marcelo
49567>>>
49567>>>//Last Revised: 2003-08-27 By: Marcelo
49567>>>
49567>>>
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-09-15 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2004-07-19 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2006-12-27 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-08-10 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//==================================
49567>>>// SQLFlex Commands
49567>>>//==================================
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-02-18 By: Marcelo
49567>>>
49567>>>//Last Revised: 2008-07-21 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2008-06-18 By: Marcelo
49567>>>
49567>>>//Last Revised: 2004-05-10 By: Marcelo
49567>>>
49567>>>//Last Revised: 2004-05-10 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-08-30 By: Marcelo
49567>>>
49567>>>//Last Revised: 2008-05-07 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//==========================================
49567>>>// SQL SERVER Stored Procedure Call engine
49567>>>//==========================================
49567>>>
49567>>>//Last Revised: 2008-04-30 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-08-10 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2008-02-06 By: Marcelo
49567>>>
49567>>>//Last Revised: 2008-02-06 By: Marcelo
49567>>>
49567>>>//Last Revised: 2008-02-15 By: Marcelo
49567>>>// Copy_Data {source-table} To {dest-table} [Callback {callback-object}] [Constrain {SQL-expression}]
49567>>>
49567>>>//============================
49567>>>// ORAFlex Commands
49567>>>//============================
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2006-03-21 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2004-07-19 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//===========================
49567>>>// BUFFER save stuffs
49567>>>//===========================
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2003-08-14 By: Marcelo
49567>>>// CREATE_TABLE_FROM_DAT_FILE <FILE NUMBER>
49567>>>
49567>>>//Last Revised: 2002-08-14 By: Marcelo
49567>>>// CONVERT_DAT_FILE <FILE NUMBER>
49567>>>
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-04-23 By: Marcelo
49567>>>// Syntax:
49567>>>//   GET_SERVER_CFG SERVER_REVISION|SUPPORT_DESC|SUPPORT_CASE|SERVER_VERSION|SERVER_ENCODING|CONNECTION_ACTIVE OF <SERVER NAME> TO <RESULT>
49567>>>// Description:
49567>>>//   Use this command to retrieve from database server the following informations :
49567>>>//   command arguments :
49567>>>//      SERVER_REVISON : Retrieve Server major revision
49567>>>//      SUPPORT_DESC : <RESULT> is 1 if Server supports Descending index segments
49567>>>//      SUPPORT_CASE : <RESULT> is 1 if Server supports Case Insensitive index segments
49567>>>//      SERVER_VERSION : Retrieve Complete Server Version Description
49567>>>//      SERVER_ENCODING : Retrieve the Server Encoding
49567>>>//      CONNECTION_ACTIVE : Retrieve the Connection status. DFTRUE means connection is active
49567>>>//
49567>>>
49567>>>//Last Revised: 2007-04-23 By: Marcelo
49567>>>// Syntax:
49567>>>//  GET_CONNECTION_STATUS of <serverName> [<databaseName>] to <variable>
49567>>>// Description:
49567>>>//  Use this command to retrieve the connection status from the specified server
49567>>>//  command argumetns :
49567>>>//    <serverName> : Server Name
49567>>>//    <databaseName> : Database Name
49567>>>//    <variable> : DFTRUE means connection is active
49567>>>
49567>>>//Last Revised: 2005-04-06 By: Marcelo
49567>>>// Syntax:
49567>>>//   GET_CLIENT_CFG ENCODING OF <SERVER NAME> [<DATABASE NAME>] TO <RESULT>
49567>>>// Description:
49567>>>//   Use this command to retrieve from database server the following informations :
49567>>>//   command arguments :
49567>>>//      ENCODING : Retrieve the Client Encoding
49567>>>//
49567>>>
49567>>>//Last Revised: 2006-05-26 By: Marcelo
49567>>>// Syntax:
49567>>>//   SET_CLIENT_CFG ENCODING OF <SERVER NAME> [<DATABASE NAME>] TO <RESULT>
49567>>>// Description:
49567>>>//   Use this command to Set the following client informations :
49567>>>//   command arguments :
49567>>>//      ENCODING : Set the Client Encoding
49567>>>//      UNIQUE_CHECKS {DFTRUE/DFFALSE}: enable/disable uniqueness checks for secondary indexes in InnoDB tables
49567>>>//
49567>>>
49567>>>//NEW
49567>>>//Last Revised: 2002-08-23 By: Marcelo
49567>>>// Syntax:
49567>>>//   FORMAT TO USE : CALL_DB2_PROCEDURE <OWNER> <STORED_PROC_NAME> [PASSING <ARG1> <ARG2> ....<ARGn>]
49567>>>// Description:
49567>>>//   CALL_STORED_PROCEDURE will call a stored procedure passing arguments
49567>>>
49567>>>// GET_RESULT_SET INTO <Var1 Var2 Var3 ... Varn>
49567>>>
49567>>>// GET_RESULTS
49567>>>
49567>>>// GET_MORE_RESULTS
49567>>>
49567>>>// GET_RESULT_SET_NUM_COLS TO <VAR>
49567>>>
49567>>>// GET_RESULT_SET_COL_NAME <COL NUMBER> TO <VAR> {<SIZE>}
49567>>>
49567>>>
49567>>>
49567>>>// CREATE_DB2_DATABASE <DB Name> <DB Alias> <Code Set> <Territory> [<Path> <NodeName> < UserId> <Password>]
49567>>>
49567>>>//Last Revised: 2005-04-04 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-04-04 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-04-04 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-04-04 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-04-04 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-04-04 By: Marcelo
49567>>>
49567>>>//Last Revised: 2005-04-04 By: Hideraldo
49567>>>
49567>>>//Last Revised: 2005-04-04 By: Hideraldo
49567>>>
49567>>>//Last Revised: 2003-04-08 By: Marcelo
49567>>>
49567>>>
49567>>>
49567>>>//Last Revised: 2007-08-13 By: Marcelo
49567>>>
49567>>>//Last Revised: 2004-11-03 By: Marcelo
49567>>>
49567>>>//Last Revised: 2004-11-03 By: Marcelo
49567>>>
49567>>>//Last Revised: 2004-11-17 By: Marcelo
49567>>>
49567>>>//Last Revised: 2007-08-13 By: Marcelo
49567>>>
49567>>>//Last Revised: 2003-09-02 By: Marcelo
49567>>>FUNCTION SQLESCAPESTRING GLOBAL STRING SARG RETURNS STRING
49569>>>  LOCAL STRING LSARG
49569>>>  SQL_ESCAPE_STRING OF SARG TO LSARG
49613>>>  FUNCTION_RETURN LSARG
49614>>>END_FUNCTION
49615>>>
49615>>>//Last Revised: 2007-08-13 By: Marcelo
49615>>>
49615>>>//Last Revised: 2005-03-18 By: Marcelo
49615>>>
49615>>>//Last Revised: 2005-03-21 By: Marcelo
49615>>>
49615>>>//
49615>>>// LOB Columns Macro Commands Support
49615>>>//
49615>>>//Last Revised: 2007-10-04 By: Marcelo
49615>>>
49615>>>//Last Revised: 2008-08-19 By: Marcelo
49615>>>
49615>>>//Last Revised: 2008-06-20 By: Marcelo
49615>>>
49615>>>//Last Revised: 2007-10-04 By: Marcelo
49615>>>
49615>>>//Last Revised: 2007-10-04 By: Marcelo
49615>>>
49615>>>//Last Revised: 2007-10-04 By: Marcelo
49615>>>
49615>>>//Last Revised: 2007-10-04 By: Marcelo
49615>>>
49615>>>//
49615>>>// MYSQL Specific Macro Commands
49615>>>//
49615>>>
49615>>>
49615>>>//Last Revised: 2005-08-23 By: Marcelo
49615>>>
49615>>> ////////// Internal Macro Commands, Procedures and Functions
49615>>>
49615>>>//Last Revised: 2005-08-29 By: Marcelo
49615>>>
49615>>>//Last Revised: 2005-08-29 By: Marcelo
49615>>>
49615>>>//Last Revised: 2005-08-29 By: Marcelo
49615>>>
49615>>>//Last Revised: 2005-08-29 By: Marcelo
49615>>>
49615>>>//Last Revised: 2005-08-29 By: Marcelo
49615>>>
49615>>>//Last Revised: 2005-08-29 By: Marcelo
49615>>>
49615>>>//Last Revised: 2005-08-29 By: Marcelo
49615>>> Procedure MertechInc_SQL_PROCEDURE_EXECUTE for Desktop
49617>>>    SQL_EXECUTE_STMT
49659>>> End_Procedure
49660>>>
49660>>>//Last Revised: 2005-08-29 By: Marcelo
49660>>> Procedure MertechInc_SQL_FUNCTION_EXECUTE Desktop String sDriverName 
49662>>>    send MertechInc_SQL_PROCEDURE_EXECUTE
49663>>>    if (sDriverName = MYSQLFLEX) begin
49665>>>        SQL_FETCH_NEXT_ROW
49709>>>    end
49709>>>>
49709>>> End_Procedure
49710>>>
49710>>>//Last Revised: 2005-08-29 By: Marcelo
49710>>> Procedure MertechInc_SQL_SET_MYPROCEDURE_NAME Desktop String strProcName Integer iNumpar
49712>>>    Local Integer liPos#
49712>>>
49712>>>    DO_DECLARE_BASIC_VARIABLES#
49713>>>
49713>>>    MOVE 0 TO _NPAR#
49714>>>        INDICATE ERR FALSE
49715>>>
49715>>>    MOVE MySQLFlex TO _DRIVERNAME#
49716>>>
49716>>>    SQL_SET_STMT TO "CALL "
49756>>>    SQL_APPEND_STMT TO strProcName
49796>>>    SQL_APPEND_STMT TO "("
49836>>>    For liPos# From 1 TO iNumpar
49842>>>>
49842>>>        DO_PASS_ARGUMENTS liPos#
49938>>>    Loop
49939>>>>
49939>>>    SQL_APPEND_STMT TO ")"
49979>>>
49979>>>    SQL_PREPARE_STMT
50021>>> End_Procedure
50022>>>
50022>>>//Last Revised: 2005-08-29 By: Marcelo
50022>>> Procedure MertechInc_SQL_SET_ORAPROCEDURE_NAME Desktop String strProcName Integer iNumpar 
50024>>>    Local Integer liPos#
50024>>>
50024>>>    DO_DECLARE_BASIC_VARIABLES#
50025>>>
50025>>>    MOVE 0 TO _NPAR#
50026>>>        INDICATE ERR FALSE
50027>>>
50027>>>    MOVE ORAFlex TO _DRIVERNAME#
50028>>>
50028>>>    SQL_SET_STMT TO "BEGIN "
50068>>>    SQL_APPEND_STMT TO strProcName
50108>>>    SQL_APPEND_STMT TO "( "
50148>>>    For liPos# From 1 TO iNumpar
50154>>>>
50154>>>        DO_PASS_ARGUMENTS liPos#
50250>>>    Loop
50251>>>>
50251>>>    SQL_APPEND_STMT TO  " ); END;"
50291>>>    SQL_PREPARE_STMT
50333>>> End_Procedure
50334>>>
50334>>>//Last Revised: 2005-06-29 By: Marcelo
50334>>> Procedure MertechInc_SQL_SET_MYFUNCTION_NAME Desktop String strProcName Integer iNumparp
50336>>>     Local Integer liPos#
50336>>>
50336>>>    MOVE MySQLFlex TO _DRIVERNAME#
50337>>>
50337>>>    SQL_SET_STMT TO "SELECT "
50377>>>    SQL_APPEND_STMT TO strProcName
50417>>>    SQL_APPEND_STMT TO "("
50457>>>    For liPos# from 1 to 
50463>>>>
50463>>>        DO_PASS_ARGUMENTS liPos#
50559>>>    Loop
50560>>>>
50560>>>    SQL_APPEND_STMT TO ")"
50600>>>
50600>>>    SQL_PREPARE_STMT
50642>>> End_Procedure
50643>>>
50643>>>//Last Revised: 2005-06-29 By: Marcelo
50643>>> Procedure MertechInc_SQL_SET_ORAFUNCTION_NAME Desktop String strProcName Integer iNumpar
50645>>>    Local Integer liPos# liLLong#
50645>>>    Local String lsArg2# lsBlank#
50645>>>
50645>>>        SQL_SET_STMT TO "BEGIN "
50685>>>    SQL_APPEND_STMT TO ":PAR_RET := "
50725>>>    SQL_APPEND_STMT TO strProcName
50765>>>    SQL_APPEND_STMT TO "( "
50805>>>    For liPos# From 1 TO iNumpar
50811>>>>
50811>>>        DO_PASS_ARGUMENTS liPos#
50907>>>    Loop
50908>>>>
50908>>>    SQL_APPEND_STMT TO  " ); END;"
50948>>>    SQL_PREPARE_STMT
50990>>>
50990>>>    MOVE IS_OUT TO liLLong#
50991>>>    move " " to lsBlank#
50992>>>    CALL_DRIVER 0 ORAFLEX FUNCTION CALLDRV_SET_PROC_ATTRIBUTE_TYPE CALLBACK 0 PASSING lsBlank# lsBlank# liLLong# RESULT _RET#
50997>>>
50997>>>    INCREMENT _NPAR#
50998>>>    MOVE ":PAR_RET" TO lsArg2#
50999>>>    CALL_DRIVER 0 _DRIVERNAME# FUNCTION 23 CALLBACK 0 PASSING _BLANK# lsArg2# 16384 RESULT _RET#
51004>>>End_Procedure
51005>>>
51005>>>//Last Revised: 2008-02-26 By: Marcelo
51005>>>Function SQL_AVAILABLE_SQL_SERVERS Desktop Returns Integer 
51007>>>    Local Integer liRet#
51007>>>    Local String lsBlank#
51007>>>
51007>>>    move " " to lsBlank#
51008>>>    CALL_DRIVER 0 SQLFLEX FUNCTION CALLDRV_ENUMERATE_SERVER CALLBACK 0 PASSING lsBlank# lsBlank# CALLDRV_ENUMERATE_SERVER_COUNT RESULT liRet#
51013>>>
51013>>>    function_return liRet#
51014>>>End_Function
51015>>>
51015>>>//Last Revised: 2008-06-26 By: Marcelo
51015>>>Function SQL_AVAILABLE_SQL_SERVER_NAME Desktop Integer item# Returns String 
51017>>>    Local Integer liRet#
51017>>>    Local String lsArg1# lsArg2# lsBlank#
51017>>>
51017>>>    MOVE (REPEAT(" ", 80)) TO lsArg1#
51018>>>    move item# to lsArg2#
51019>>>    CALL_DRIVER 0 SQLFLEX FUNCTION CALLDRV_ENUMERATE_SERVER CALLBACK 0 PASSING lsArg1# lsArg2# CALLDRV_ENUMERATE_SERVER_SERVER RESULT liRet#
51024>>>
51024>>>    Function_Return lsArg1#
51025>>>End_Function
51026>>>
51026>>>//Last Revised: 2008-02-26 By: Marcelo
51026>>>Procedure Set SQL_USE_ROWCOUNT_IN_TRANSACTIONS global String server# Integer value#
51028>>>    Local Integer liRet#
51028>>>    Local String lsArg1# lsArg2#
51028>>>
51028>>>    DO_DECLARE_BASIC_VARIABLES#
51029>>>    DO_GETFILENUMBER_DRIVERNAME# 0
51060>>>
51060>>>    move server# to lsArg1#
51061>>>    move value# to lsArg2#
51062>>>
51062>>>    CALL_DRIVER 0 _DRIVERNAME# FUNCTION CALLDRV_USE_ROWCOUNT_IN_TRANSACTIONS CALLBACK 0 PASSING lsArg1# lsArg2# CALLDRV_VALUE_SET RESULT liRet#
51067>>>    IF liRet# EQ -1 INDICATE ERR TRUE
51070>>>
51070>>>    DO_RESTORE_FILENUMBER#
51071>>>End_Procedure
51072>>>//#REPLACE UseRowCountInTransactions SQL_USE_ROWCOUNT_IN_TRANSACTIONS
51072>>>
51072>>>//Last Revised: 2008-02-26 By: Marcelo
51072>>>Function SQL_USE_ROWCOUNT_IN_TRANSACTIONS Global String serverName# Returns Integer
51074>>>    Local Integer liRet#
51074>>>    Local String lsBlank#
51074>>>    Local String lsArg1#
51074>>>
51074>>>    DO_DECLARE_BASIC_VARIABLES#
51075>>>    DO_GETFILENUMBER_DRIVERNAME# 0
51106>>>
51106>>>    move serverName# to lsArg1#
51107>>>    move " " to lsBlank#
51108>>>    CALL_DRIVER 0 _DRIVERNAME# FUNCTION CALLDRV_USE_ROWCOUNT_IN_TRANSACTIONS CALLBACK 0 PASSING lsArg1# lsBlank# CALLDRV_VALUE_GET RESULT liRet#
51113>>>
51113>>>    DO_RESTORE_FILENUMBER#
51114>>>
51114>>>    function_return liRet#
51115>>>End_Function
51116>>>
51116>>>//Last Revised: 2008-02-26 By: Marcelo
51116>>>Procedure Set SQL_USE_DATAFLEX_DATEFORMAT global Integer value#
51118>>>    DO_DECLARE_BASIC_VARIABLES#
51119>>>    DO_GETFILENUMBER_DRIVERNAME# 0
51150>>>
51150>>>    If _DRIVERNAME# eq SQLFlex Begin
51152>>>        move value# to _ARG1#
51153>>>        CALL_DRIVER 0 _DRIVERNAME# FUNCTION CALLDRV_USE_DFLEX_DATE_FORMAT CALLBACK 0 PASSING _ARG1# _BLANK# CALLDRV_VALUE_SET RESULT _RET#
51158>>>        IF _RET# EQ -1 INDICATE ERR TRUE
51161>>>    End
51161>>>>
51161>>>
51161>>>    DO_RESTORE_FILENUMBER#
51162>>>End_Procedure
51163>>>//#REPLACE SqlUseDataflexDateFormat SQL_USE_DATAFLEX_DATEFORMAT
51163>>>
51163>>>//Last Revised: 2008-02-26 By: Marcelo
51163>>>Function SQL_USE_DATAFLEX_DATEFORMAT Global Returns Integer
51165>>>    DO_DECLARE_BASIC_VARIABLES#
51166>>>    DO_GETFILENUMBER_DRIVERNAME# 0
51197>>>
51197>>>    If _DRIVERNAME# eq SQLFlex Begin
51199>>>        CALL_DRIVER 0 _DRIVERNAME# FUNCTION CALLDRV_USE_DFLEX_DATE_FORMAT CALLBACK 0 PASSING _BLANK# _BLANK# CALLDRV_VALUE_GET RESULT _RET#
51204>>>    End
51204>>>>
51204>>>    Else Move DFFALSE to _RET#
51206>>>
51206>>>    DO_RESTORE_FILENUMBER#
51207>>>
51207>>>    function_return _RET#
51208>>>End_Function
51209>>>
51209>>>//Last Revised: 2008-08-27 By: Marcelo
51209>>>Procedure Set SQL_FORCE_FIELDS_NOT_NULL global Integer value#
51211>>>    DO_DECLARE_BASIC_VARIABLES#
51212>>>    DO_GETFILENUMBER_DRIVERNAME# 0
51243>>>
51243>>>    If (_DRIVERNAME# eq ORAFlex OR _DRIVERNAME# eq MySQLFlex) Begin
51245>>>        move value# to _ARG1#
51246>>>        CALL_DRIVER 0 _DRIVERNAME# FUNCTION CALLDRV_FORCE_FIELDS_NOT_NULL CALLBACK 0 PASSING _ARG1# _BLANK# CALLDRV_VALUE_SET RESULT _RET#
51251>>>        IF _RET# EQ -1 INDICATE ERR TRUE
51254>>>    End
51254>>>>
51254>>>
51254>>>    DO_RESTORE_FILENUMBER#
51255>>>End_Procedure
51256>>>
51256>>>//Last Revised: 2008-08-27 By: Marcelo
51256>>>Function SQL_FORCE_FIELDS_NOT_NULL Global Returns Integer
51258>>>    DO_DECLARE_BASIC_VARIABLES#
51259>>>    DO_GETFILENUMBER_DRIVERNAME# 0
51290>>>
51290>>>    If (_DRIVERNAME# eq ORAFlex OR _DRIVERNAME# eq MySQLFlex) Begin
51292>>>        CALL_DRIVER 0 _DRIVERNAME# FUNCTION CALLDRV_FORCE_FIELDS_NOT_NULL CALLBACK 0 PASSING _BLANK# _BLANK# CALLDRV_VALUE_GET RESULT _RET#
51297>>>    End
51297>>>>
51297>>>    Else Move DFFALSE to _RET#
51299>>>
51299>>>    DO_RESTORE_FILENUMBER#
51300>>>
51300>>>    function_return _RET#
51301>>>End_Function
51302>>>
51302>>>//Last Revised: 2008-08-27 By: Marcelo
51302>>>
51302>>>//Last Revised: 2008-08-27 By: Marcelo
51302>>>
51302>>>//Last Revised: 2008-08-22 By: Marcelo
51302>>>
51302>>>//Last Revised: 2008-08-22 By: Marcelo
51302>//Login 'PIS2003DEV'  'SA' '123' 'SQL_DRV'
51302>//Login 'PISDEV'      'SA' '123' 'SQL_DRV'
51302>
51302>Open CLIENTS
Including file: CLIENTS.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\CLIENTS.FD)
51304>Open MICLIENT
Including file: MICLIENT.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MICLIENT.FD)
51306>
51306>
51306>Object oMain is a Panel
51308>
51308>    Set Label to "Test1 "
51309>
51309>    Set Location to 4 3
51310>    Set Size to 300 450
51311>
51311>    Object oCommandBarSystem is a cCJCommandBarSystem
51313>        Set pbTimerUpdate to True
51314>//
51314>        Procedure OnCreateCommandBars
51317>            Handle hoOptions
51317>            Get OptionsObject to hoOptions
51318>            Forward Send OnCreateCommandBars
51320>        End_Procedure
51321>//
51321>        Object oMenuBar is a cCJMenuBar
51323>
51323>            Object oShowCallsMenuItem is a cCJMenuItem
51325>                Set psCaption to "Test1 "
51326>                Set psTooltip to "Test1 "
51327>                
51327>                Procedure OnExecute Variant vCommandBarControl
51330>                    Handle hoClient
51330>                    Get Client_Id to hoClient
51331>                    Send Activate_Migrate101 of hoClient
51332>                End_Procedure
51333>
51333>            End_Object
51334>
51334>        End_Object
51335>  
51335>    End_Object
51336>
51336>    Object oClientArea is a ClientArea
51338>        Use StdAbout.pkg
Including file: STDABOUT.PKG    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\STDABOUT.PKG)
51338>>>//************************************************************************
51338>>>// Confidential Trade Secret.
51338>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
51338>>>// as an unpublished work.  All rights reserved.
51338>>>// DataFlex is a registered trademark of Data Access Corporation.
51338>>>//
51338>>>//************************************************************************
51338>>>//************************************************************************
51338>>>//
51338>>>// $File name  : StdAbout.pkg
51338>>>// $File title : Standard about object package for VDF
51338>>>// Notice      :
51338>>>// $Author(s)  : John Tuohy
51338>>>//
51338>>>// $Rev History
51338>>>//
51338>>>// JT 06/27/97   File created
51338>>>//************************************************************************
51338>>>
51338>>>// This provides a quick and simple way to create an about package for a program.
51338>>>// You need to create a message inside you client area called Activate_About.
51338>>>// Within this message you should send the message DoAbout passing needed
51338>>>// string information.
51338>>>//
51338>>>//       Procedure Activate_About
51338>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
51338>>>//       End_Procedure
51338>>>//    where: sTitle =     Name of application. If none provided, uses caption
51338>>>//                        bar title
51338>>>//           sVersion   = Version Line. If none provided, will be blank
51338>>>//           sCopyRight = Copyright Line. If none provided, will be blank
51338>>>//           sAuthor    = Author name, blank if none provided
51338>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
51338>>>//                        is used.
51338>>>// It is expected that you will place this in your own object package. For
51338>>>// example an order about package may look like this:
51338>>>//
51338>>>//   // OrderAbout.pkg
51338>>>//   Use StdAbout.pkg
51338>>>//   Procedure Activate_About
51338>>>//      Local String sTitle sCopyright sVersion sAuthor
51338>>>//      Move "My Order Entry System" to sTitle
51338>>>//      Move "Version 2.1" to sVersion
51338>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
51338>>>//      Move "John Smith"  to sAuthor
51338>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
51338>>>//   end_procedure
51338>>>//   // end of file.
51338>>>
51338>>>
51338>>>
51338>>>//Use DfAbout.Sub
51338>>>Use DfAbout.pkg
Including file: DFABOUT.PKG    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\DFABOUT.PKG)
51338>>>>>//************************************************************************
51338>>>>>// Confidential Trade Secret.
51338>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
51338>>>>>// as an unpublished work.  All rights reserved.
51338>>>>>// DataFlex is a registered trademark of Data Access Corporation.
51338>>>>>//
51338>>>>>//************************************************************************
51338>>>>>//************************************************************************
51338>>>>>//
51338>>>>>// $File name  : DfAbout.pkg
51338>>>>>// $File title : About class support
51338>>>>>// Notice      :
51338>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
51338>>>>>//
51338>>>>>// $Rev History
51338>>>>>//
51338>>>>>// JJT 10/23/2001 removed all ghoworkspace support. Uses app object or nothing
51338>>>>>// SWB 07/19/01   Added support of the Application object in preference to
51338>>>>>//                the global Workspace object, if it is present
51338>>>>>// JJT 11/05/98   Added version information
51338>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
51338>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
51338>>>>>//                workspace package.
51338>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
51338>>>>>//                class can create this object.
51338>>>>>//                Cleaned up the interface (used correct classes and messages)
51338>>>>>//                Added workspace reporting support to sys-info.
51338>>>>>//                Turned off wrapping in the sys-info editor.
51338>>>>>// KR  ??/??/96   File created
51338>>>>>//************************************************************************
51338>>>>>Use LanguageText.pkg
51338>>>>>Use windows.pkg
51338>>>>>Use DFbitmap.pkg
51338>>>>>Use GlobalFunctionsProcedures.pkg
51338>>>>>
51338>>>>>    External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;        Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
51339>>>>>
51339>>>>>//#IFDEF ghoApplication
51339>>>>>//#ELSE
51339>>>>>//    Global_Variable Integer ghoApplication
51339>>>>>//    Move 0 To ghoApplication
51339>>>>>//#ENDIF
51339>>>>>
51339>>>>>Register_Function phoWorkspace Returns Handle
51339>>>>>Register_Function psHelpFile Returns String
51339>>>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
51339>>>>>
51339>>>>>//****************************************************************************
51339>>>>>// $Module type: FUNCTION
51339>>>>>// $Module name: Network_User_Name
51339>>>>>// $Author     : AK/VOO/KCR
51339>>>>>// Created     : 24-09-96 @ 19:17
51339>>>>>//
51339>>>>>// Description
51339>>>>>//    This function reads the current username of windows and returns that
51339>>>>>//    name or an text unknown user
51339>>>>>//
51339>>>>>// $Rev History
51339>>>>>//    24-09-96  Module header created
51339>>>>>//****************************************************************************
51339>>>>>//Function Network_User_Name Returns String
51339>>>>>//    String sName sLength
51339>>>>>//    Pointer lpName_Addr lpLength_Addr
51339>>>>>//    Integer iRetval
51339>>>>>//
51339>>>>>//    Movestr (Repeat (Character (0), 255)) To sName
51339>>>>>//    GetAddress Of sName To lpName_Addr
51339>>>>>//    Movestr (DwordToBytes (255)) To sLength
51339>>>>>//    GetAddress Of sLength To lpLength_Addr
51339>>>>>//
51339>>>>>//    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
51339>>>>>//
51339>>>>>//    If iRetval Eq 0 Function_Return (CString (sName))
51339>>>>>//    Else Function_Return " "
51339>>>>>//End_Function // Network_User_Name
51339>>>>>
51339>>>>>Type MEMORYSTATUS
51339>>>>>   Field MEMORYSTATUS.dwLength         As Dword // sizeof(MEMORYSTATUS)
51339>>>>>   Field MEMORYSTATUS.dwMemoryLoad     As Dword // percent of memory in use
51339>>>>>   Field MEMORYSTATUS.dwTotalPhys      As Dword // bytes of physical memory
51339>>>>>   Field MEMORYSTATUS.dwAvailPhys      As Dword // free physical memory bytes
51339>>>>>   Field MEMORYSTATUS.dwTotalPageFile  As Dword // bytes of paging file
51339>>>>>   Field MEMORYSTATUS.dwAvailPageFile  As Dword // free bytes of paging file
51339>>>>>   Field MEMORYSTATUS.dwTotalVirtual   As Dword // user bytes of address space
51339>>>>>   Field MEMORYSTATUS.dwAvailVirtual   As Dword // free user bytes
51339>>>>>End_Type // MEMORYSTATUS
51339>>>>>
51339>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
51340>>>>>
51340>>>>>Class SysinfoDisplay Is An Edit
51341>>>>>    Procedure Construct_Object
51343>>>>>        Forward Send construct_object
51345>>>>>
51345>>>>>        Set Location To 6 6
51346>>>>>        Set Size To 110 255
51347>>>>>        Set Read_Only_State To True
51348>>>>>        Set wrap_state To False
51349>>>>>    End_Procedure
51350>>>>>
51350>>>>>    //****************************************************************************
51350>>>>>    // $Module type: PROCEDURE
51350>>>>>    // $Module name: Add_Line
51350>>>>>    // $Author     : VOO
51350>>>>>    // Created     : 06-10-96 @ 15:23
51350>>>>>    //
51350>>>>>    // Description
51350>>>>>    //    This method will add a line to this edit object, it should go simpler
51350>>>>>    //    but it seems to be done this way.
51350>>>>>    //
51350>>>>>    // $Rev History
51350>>>>>    //    06-10-96  Module header created
51350>>>>>    //****************************************************************************
51350>>>>>    Procedure Add_Line String sVal
51352>>>>>        Integer iLine
51352>>>>>
51352>>>>>        Moveint (Line_Count(Self)) To iLine
51353>>>>>>
51353>>>>>        If (iLine = 1 And Changed_State(Self) = False) Moveint 0 To iLine
51356>>>>>        Set Value Item iLine To sVal
51357>>>>>    End_Procedure // Add_Line
51358>>>>>
51358>>>>>    //****************************************************************************
51358>>>>>    // $Module type: PROCEDURE
51358>>>>>    // $Module name: Show_Current_Directory
51358>>>>>    // $Author     : VOO
51358>>>>>    // Created     : 06-10-96 @ 15:24
51358>>>>>    //
51358>>>>>    // Description
51358>>>>>    //    This method will show the name of the current directory in the system
51358>>>>>    //    information box
51358>>>>>    //
51358>>>>>    // $Rev History
51358>>>>>    //    06-10-96  Module header created
51358>>>>>    //****************************************************************************
51358>>>>>    Procedure Show_Current_Directory
51360>>>>>        String sDir
51360>>>>>
51360>>>>>        Get_Current_Directory To sDir
51361>>>>>        Send Add_Line (SFormat(C_$CurrentDirectory, sDir))
51362>>>>>    End_Procedure // Show_Current_Directory
51363>>>>>
51363>>>>>    Procedure Show_Windows_Directory
51365>>>>>        String sWindir
51365>>>>>
51365>>>>>        Get_Windows_Directory To sWindir
51366>>>>>        Send Add_Line (SFormat(C_$WindowsDirectory, sWindir))
51367>>>>>    End_Procedure // Show_Windows_Directory
51368>>>>>
51368>>>>>    Procedure Show_Current_User
51370>>>>>        //Send Add_Line (SFormat(C_$NetworkUserName, Network_User_Name(Self)))
51370>>>>>    End_Procedure // Show_Current_User
51371>>>>>
51371>>>>>    Procedure Show_Number_Format
51373>>>>>        Integer iFormat
51373>>>>>
51373>>>>>        Get_Attribute Df_Thousands_Separator To iFormat
51376>>>>>        Send Add_Line (SFormat(C_$ThousandsSeparator, Character(iFormat), iFormat))
51377>>>>>        Get_Number_Format To iFormat
51378>>>>>        Send Add_Line (SFormat(C_$DecimalSeparator, If (iFormat = 0, ".", ",")))
51379>>>>>    End_Procedure // Show_Number_Format
51380>>>>>
51380>>>>>    Procedure Show_Filelist_Name
51382>>>>>        String sFilename
51382>>>>>
51382>>>>>        Get_Attribute Df_Filelist_Name To sFilename
51385>>>>>        Send Add_Line (SFormat(C_$CurrentFilelist, sFilename))
51386>>>>>    End_Procedure // Show_Filelist_Name
51387>>>>>
51387>>>>>    Procedure Show_Lock_Delay
51389>>>>>        Integer iLockdelay
51389>>>>>
51389>>>>>        Get_Attribute Df_Lock_Delay To iLockdelay
51392>>>>>        Send Add_Line (SFormat(C_$DatabaseLockingDelay, iLockDelay))
51393>>>>>    End_Procedure // Show_Lock_Delay
51394>>>>>
51394>>>>>    Procedure Show_Lock_Timeout
51396>>>>>        Integer iLockTimeout
51396>>>>>
51396>>>>>        Get_Attribute Df_Lock_Timeout To iLockTimeout
51399>>>>>        Send Add_Line (SFormat(C_$DatabaseLockingTimeout, iLockTimeOut))
51400>>>>>    End_Procedure // Show_Lock_Timeout
51401>>>>>
51401>>>>>    Procedure Show_Screen_Size
51403>>>>>        Integer iYscreensize iXscreensize
51403>>>>>
51403>>>>>        Moveint (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
51404>>>>>>
51404>>>>>        Moveint (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
51405>>>>>>
51405>>>>>
51405>>>>>        Send Add_Line (SFormat(C_$VideoResolution, iXscreensize, iYscreensize))
51406>>>>>    End_Procedure // Show_Screen_Size
51407>>>>>
51407>>>>>    Procedure Show_Page_Size
51409>>>>>        Send Add_Line (SFormat(C_$PageEndFormFeed, Pageend, Pagefeed))
51410>>>>>    End_Procedure
51411>>>>>
51411>>>>>    Procedure Show_Date
51413>>>>>        Date dToday
51413>>>>>
51413>>>>>        Sysdate4 dToday
51414>>>>>        Send Add_Line (SFormat(C_$CurrentSystemDate, String(dToday)))
51415>>>>>    End_Procedure // Show_Date
51416>>>>>
51416>>>>>    Procedure Show_Date_Format
51418>>>>>        Integer iDateFormat
51418>>>>>        String sDateFormat
51418>>>>>
51418>>>>>        Get_Attribute Df_Date_Format To iDateFormat
51421>>>>>        If iDateFormat Eq DF_DATE_USA ;            Movestr C_$USA To sDateFormat
51424>>>>>        Else If iDateformat Eq DF_DATE_EUROPEAN ;            Movestr C_$European To sDateFormat
51428>>>>>        Else If iDateformat Eq DF_DATE_MILITARY ;            Movestr C_$Military To sDateFormat
51432>>>>>        Else ;            Movestr C_$UnknownDateType To sDateFormat
51434>>>>>        Send Add_Line (SFormat(C_$DateFormat, sDateformat))
51435>>>>>    End_Procedure // Show_Date_Format
51436>>>>>
51436>>>>>    Procedure Show_Memavail
51438>>>>>        Integer iMem
51438>>>>>
51438>>>>>        Memory iMem
51439>>>>>>
51439>>>>>        Send Add_Line (SFormat(C_$AvailableMemory, iMem))
51440>>>>>    End_Procedure // Show_Memavail
51441>>>>>
51441>>>>>    Procedure Show_Systemresources
51443>>>>>        String sMemoryStatus
51443>>>>>        Pointer lpsMemoryStatus
51443>>>>>        Integer iVoid
51443>>>>>        Dword dwMemoryLoad dwTotalPhys dwAvailPhys dwTotalPageFile dwAvailPageFile dwTotalVirtual dwAvailVirtual
51443>>>>>
51443>>>>>        ZeroType MEMORYSTATUS To sMemoryStatus
51444>>>>>        GetAddress Of sMemoryStatus To lpsMemoryStatus
51445>>>>>
51445>>>>>        Moveint (GlobalMemoryStatus (lpsMemoryStatus)) To iVoid
51446>>>>>>
51446>>>>>
51446>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwMemoryLoad    To dwMemoryLoad
51447>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPhys     To dwTotalPhys
51448>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPhys     To dwAvailPhys
51449>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPageFile To dwTotalPageFile
51450>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPageFile To dwAvailPageFile
51451>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalVirtual  To dwTotalVirtual
51452>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailVirtual  To dwAvailVirtual
51453>>>>>
51453>>>>>        Send Add_Line (SFormat(C_$MemoryUtilization, dwMemoryLoad))
51454>>>>>        Send Add_Line (SFormat(C_$AvailablePhysicalMemory, dwAvailPhys / dwTotalPhys * 100.0))
51455>>>>>        Send Add_Line (SFormat(C_$AvailablePagefileSpace, dwAvailPageFile / dwTotalPageFile * 100.0))
51456>>>>>        Send Add_Line (SFormat(C_$AvailableVirtualMemory, dwAvailVirtual / dwTotalVirtual * 100.0))
51457>>>>>    End_Procedure // Show_Systemresources
51458>>>>>
51458>>>>>    Procedure Show_Registration
51460>>>>>        String sRegName
51460>>>>>        Integer iSN
51460>>>>>        Registration sRegName iSN
51461>>>>>>
51461>>>>>
51461>>>>>        Send Add_Line (SFormat(C_$Serial, iSN))
51462>>>>>        Send Add_Line (SFormat(C_$RegName, sRegName))
51463>>>>>
51463>>>>>    End_Procedure // Show_Current_Directory
51464>>>>>
51464>>>>>
51464>>>>>
51464>>>>>    //****************************************************************************
51464>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
51464>>>>>    // to the workspace object passing the an object and message to send back
51464>>>>>    // to this object. It is expected that the workspace object will send this
51464>>>>>    // message for every line of information it wants displayed (passing the
51464>>>>>    // information to be displayed
51464>>>>>    //****************************************************************************
51464>>>>>    Register_Procedure EnumerateWorkspaceData Integer hObjId Integer hmMessId
51464>>>>>
51464>>>>>    Procedure Show_ServicePack
51466>>>>>        String sVersion
51466>>>>>        Get_Profile_String "" "CurrentVersionDescription" To sVersion
51469>>>>>        If (sVersion <> "") Begin
51471>>>>>           Send Add_Line sVersion
51472>>>>>           Send Add_Line ""
51473>>>>>        End
51473>>>>>>
51473>>>>>    End_Procedure
51474>>>>>
51474>>>>>    Procedure Show_WorkspaceInformation
51476>>>>>        If ghoApplication ;            Send EnumerateWorkspaceData Of (phoWorkspace(ghoApplication)) Self Msg_add_Line
51479>>>>>
51479>>>>>        // removed for VDF8
51479>>>>>        //Else If ghoWorkspace ;
51479>>>>>        //    Send EnumerateWorkspaceData of ghoWorkspace self Msg_add_Line
51479>>>>>    End_Procedure
51480>>>>>
51480>>>>>    Function VersionStr Integer iVer Integer iRev Integer iBld Returns String
51482>>>>>        Function_Return (String(iVer)-"."-String(iRev)-"."-String(iBld))
51483>>>>>    End_Function
51484>>>>>
51484>>>>>    Procedure Show_Versions
51486>>>>>        Integer iVersion iRevision iBuild
51486>>>>>        Version_information iVersion iRevision iBuild
51488>>>>>        Send Add_Line (SFormat(C_$RuntimeVersion, VersionStr(Self,iVersion,iRevision,iBuild) ))
51489>>>>>        Send Add_Line (SFormat(C_$PackageVersion, VersionStr(Self,PKG_VERSION, PKG_REVISION, PKG_BUILD) ))
51490>>>>>        Send Add_Line (SFormat(C_$FMACVersion, VersionStr(Self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) ))
51491>>>>>    End_Procedure
51492>>>>>
51492>>>>>
51492>>>>>    //***
51492>>>>>    //*** BW
51492>>>>>    //*** Procedure: Show_Drivers
51492>>>>>    //*** Purpose  : Show loaed database drivers
51492>>>>>    //***
51492>>>>>
51492>>>>>    Procedure Show_Drivers
51494>>>>>        String  Current_drvr
51494>>>>>        String  Loadeddrvrs
51494>>>>>        Integer Number_of_drvrs
51494>>>>>        Integer Count
51494>>>>>
51494>>>>>        Move "" To Loadeddrvrs
51495>>>>>        Get_Attribute DF_NUMBER_DRIVERS To Number_of_drvrs
51498>>>>>        For Count From 1 To Number_of_drvrs
51504>>>>>>
51504>>>>>            Get_Attribute DF_DRIVER_NAME Of Count To Current_drvr
51507>>>>>            If (Loadeddrvrs <> "") ;                Move (Append(Loadeddrvrs, ", ")) To Loadeddrvrs
51510>>>>>            Move (Append(Loadeddrvrs, Current_drvr)) To Loadeddrvrs
51511>>>>>        Loop
51512>>>>>>
51512>>>>>        Send Add_Line (SFormat(C_$DatabaseDriver, Loadeddrvrs))
51513>>>>>    End_Procedure // Show_Drivers
51514>>>>>
51514>>>>>    Procedure Show_HelpFile
51516>>>>>        Send Add_Line ""
51517>>>>>        Send Add_Line (SFormat(C_$HelpFile,  psHelpFile(ghoApplication)))
51518>>>>>    End_Procedure
51519>>>>>
51519>>>>>    Procedure Show_EnterAsTab
51521>>>>>        Send Add_Line (SFormat(C_$EnterKeyNavForward, If(pbEnterKeyAsTabKey(ghoApplication),"True","False")))
51522>>>>>    End_Procedure
51523>>>>>
51523>>>>>    //****************************************************************************
51523>>>>>    // $Module type: PROCEDURE
51523>>>>>    // $Module name: Add_Focus
51523>>>>>    // $Author     : VOO
51523>>>>>    // Created     : 24-09-96 @ 19:43
51523>>>>>    //
51523>>>>>    // Description
51523>>>>>    //    During activation we will remove the old information and add the newly
51523>>>>>    //    found systeminformation
51523>>>>>    //
51523>>>>>    // $Rev History
51523>>>>>    //    24-09-96  Module header created
51523>>>>>    //****************************************************************************
51523>>>>>    Procedure Add_Focus Integer hoRoot
51525>>>>>        Forward Send Add_Focus hoRoot
51527>>>>>
51527>>>>>        Send Delete_Data
51528>>>>>        Set Changed_State To False
51529>>>>>        Set Read_Only_State To True
51530>>>>>        Send Show_ServicePack
51531>>>>>        Send Show_WorkSpaceInformation // added to show WS info
51532>>>>>        If ghoApplication Begin
51534>>>>>            Send Show_HelpFile
51535>>>>>            Send Show_EnterAsTab
51536>>>>>        End
51536>>>>>>
51536>>>>>        Send Show_Drivers
51537>>>>>        Send Show_Current_User
51538>>>>>        Send Show_Windows_Directory
51539>>>>>        Send Show_Current_Directory
51540>>>>>        Send Show_Filelist_Name
51541>>>>>        Send Show_Versions
51542>>>>>        Send Show_Memavail
51543>>>>>        Send Show_Screen_Size
51544>>>>>        Send Show_Page_Size
51545>>>>>        Send Show_Number_Format
51546>>>>>        Send Show_Date_Format
51547>>>>>        Send Show_Lock_Delay
51548>>>>>        Send Show_Lock_Timeout
51549>>>>>        Send Show_Date
51550>>>>>        Send Show_Systemresources
51551>>>>>        //Send Show_Registration
51551>>>>>    End_Procedure // Show_All_Info
51552>>>>>
51552>>>>>End_Class // SysinfoDisplay
51553>>>>>
51553>>>>>
51553>>>>>//****************************************************************************
51553>>>>>// $Module type: OBJECT
51553>>>>>// $Module name: Sysinfo_Dialog
51553>>>>>// $Author     : VOO
51553>>>>>// Created     : 24-09-96 @ 18:47
51553>>>>>//
51553>>>>>// Description
51553>>>>>//    This object shows the systeminformation on the screen
51553>>>>>//
51553>>>>>// $Rev History
51553>>>>>//    24-09-96  Module header created
51553>>>>>//****************************************************************************
51553>>>>>Class SysInfoDialog Is A ModalPanel
51554>>>>>    Procedure Construct_Object
51556>>>>>        Forward Send construct_object
51558>>>>>
51558>>>>>        Set Caption_Bar To True
51559>>>>>        Set Sysmenu_Icon To True
51560>>>>>        Set Label To C_$SystemInformation
51561>>>>>        Set Size To 152 270
51562>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
51563>>>>>        Set Minimize_Icon To False
51564>>>>>        Set Maximize_Icon To False
51565>>>>>        Set Border_Style To Border_Thick
51566>>>>>
51566>>>>>        Object Sysinfo_Display Is A SysInfoDisplay
51568>>>>>        End_Object
51569>>>>>
51569>>>>>        Object Close_Button Is A Button
51571>>>>>            Set Label To C_$Close
51572>>>>>            Set Location To 120 212
51573>>>>>            Set Message Item 0 To msg_Close_Panel
51574>>>>>            Set default_action_button To Self
51575>>>>>        End_Object // Close_Button
51576>>>>>
51576>>>>>        On_Key Kcancel       Send Close_Panel
51577>>>>>    End_Procedure
51578>>>>>
51578>>>>>    //****************************************************************************
51578>>>>>    // $Module type: PROCEDURE
51578>>>>>    // $Module name: OnResize
51578>>>>>    // $Author     : VO
51578>>>>>    // Created     : 05/16/00 @ 3:40
51578>>>>>    //
51578>>>>>    // Description
51578>>>>>    //      When the dialog is resized relocate the edit object and button
51578>>>>>    //
51578>>>>>    // $Rev History
51578>>>>>    //      05/16/00 VO Module header created
51578>>>>>    //****************************************************************************
51578>>>>>    Procedure OnResize
51580>>>>>        Integer iPanelGuiSize
51580>>>>>
51580>>>>>        Get GuiSize To iPanelGuiSize
51581>>>>>        Set GuiSize Of Sysinfo_Display To (Hi (iPanelGuiSize) - 70) (Low (iPanelGuiSize) - 25)
51582>>>>>        Set GuiLocation Of Close_Button To (Hi (iPanelGuiSize) - 50) (Low (iPanelGuiSize) - 90)
51583>>>>>
51583>>>>>        Send Adjust_Logicals
51584>>>>>    End_Procedure // OnResize
51585>>>>>End_Class // SysinfoDialog
51586>>>>>
51586>>>>>// Purpose:
51586>>>>>//
51586>>>>>// Ken Ross 12/17/96 5:16PM
51586>>>>>//
51586>>>>>Class AboutDialog Is A ModalPanel
51587>>>>>
51587>>>>>    Procedure construct_object
51589>>>>>        String sVdfRootDir
51589>>>>>        Forward Send construct_object
51591>>>>>        Set Label To C_$About
51592>>>>>        Set Size To 100 217
51593>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
51594>>>>>
51594>>>>>        Object SysInfo_Dialog Is A SysInfoDialog
51596>>>>>        End_Object
51597>>>>>
51597>>>>>        Object oBox Is A Container3d
51599>>>>>            Set Border_Style To Border_StaticEdge
51600>>>>>            Set Size To 63 202
51601>>>>>            Set Location To 4 5
51602>>>>>
51602>>>>>            Object oAboutGraphic Is A BitmapContainer
51604>>>>>                Set Border_Style To Border_None
51605>>>>>                Set Bitmap_Style To Bitmap_Center
51606>>>>>                Set Size To 48 48
51607>>>>>                Set Location To 7 2
51608>>>>>            End_Object    // AboutGraphic
51609>>>>>
51609>>>>>            Object oProductName Is A TextBox
51611>>>>>                Set label To C_$ProductName
51612>>>>>                Set Size To 10 45
51613>>>>>                Set Location To 8 53
51614>>>>>            End_Object    // ProductName
51615>>>>>
51615>>>>>            Object oVersion Is A TextBox
51617>>>>>                Set label To C_$Version
51618>>>>>                Set Size To 10 25
51619>>>>>                Set Location To 21 53
51620>>>>>            End_Object    // Version
51621>>>>>
51621>>>>>            Object oCopyright Is A TextBox
51623>>>>>                Set label To C_$Copyright
51624>>>>>                Set Size To 10 31
51625>>>>>                Set Location To 34 53
51626>>>>>            End_Object    // Copyright
51627>>>>>
51627>>>>>            Object oAuthor Is A TextBox
51629>>>>>                Set label To C_$Author
51630>>>>>                Set Size To 10 22
51631>>>>>                Set Location To 46 53
51632>>>>>            End_Object    // Author
51633>>>>>
51633>>>>>        End_Object    // oBox
51634>>>>>
51634>>>>>        Object OK_bn Is A Button
51636>>>>>            On_Item C_$OK Send Close_Panel
51637>>>>>            Set Size To 14 50
51638>>>>>            Set Location To 71 157
51639>>>>>        End_Object    // OK_bn
51640>>>>>
51640>>>>>        Object SysInfo_bn Is A Button
51642>>>>>            On_Item C_$SystemInfo Send Show_Sysinfo
51643>>>>>            Set Size To 14 50
51644>>>>>            Set Location To 71 101
51645>>>>>        End_Object    // SysInfo_bn
51646>>>>>
51646>>>>>        On_Key Kcancel Send KeyAction Of Ok_bn
51647>>>>>
51647>>>>>//        Get_Profile_String "Defaults" "VdfRootDir" To sVdfRootDir
51647>>>>>//        Set logo to (sVdfRootDir +"\Bitmaps\DacAbout.bmp")  // square bitmaps of 42x42 work best
51647>>>>>        Set logo To "DacAbout.bmp"  // square bitmaps of 42x42 work best
51648>>>>>
51648>>>>>    End_Procedure
51649>>>>>
51649>>>>>    Procedure Set ProductName String sProductName
51651>>>>>        Set label Of oProductName To sProductName
51652>>>>>    End_Procedure
51653>>>>>
51653>>>>>    Procedure Set Version String sVersion
51655>>>>>        Set label Of oVersion To sVersion
51656>>>>>    End_Procedure
51657>>>>>
51657>>>>>    Procedure Set Copyright String sCopyright
51659>>>>>        Set label Of oCopyright To sCopyright
51660>>>>>    End_Procedure
51661>>>>>
51661>>>>>    Procedure Set Author String sAuthor
51663>>>>>        Set Label Of oAuthor To sAuthor
51664>>>>>    End_Procedure
51665>>>>>
51665>>>>>    Procedure Set Logo String sLogo
51667>>>>>        // square bitmaps of 42x42 work best
51667>>>>>        Set Bitmap Of oAboutGraphic To sLogo
51668>>>>>    End_Procedure
51669>>>>>
51669>>>>>    Procedure Show_Sysinfo
51671>>>>>        Send Popup_Modal Of Sysinfo_Dialog
51672>>>>>    End_Procedure // Show_Sysinfo
51673>>>>>
51673>>>>>    Procedure End_Construct_Object
51675>>>>>        Handle hoVersionInfo
51675>>>>>        Boolean bIncluded
51675>>>>>        Integer iMajor iMinor iRelease iBuild
51675>>>>>
51675>>>>>        If (Label(oVersion) = C_$VERSION) Begin
51677>>>>>            // set it to the version info of the program, if available
51677>>>>>            If (ghoApplication) Begin
51679>>>>>                Get phoVersionInfo Of ghoApplication To hoVersionInfo
51680>>>>>                Get pbIncluded Of hoVersionInfo To bIncluded
51681>>>>>                If bIncluded Begin
51683>>>>>                    Get piVersionMajor   Of hoVersionInfo To iMajor
51684>>>>>                    Get piVersionMinor   Of hoVersionInfo To iMinor
51685>>>>>                    Get piVersionRelease Of hoVersionInfo To iRelease
51686>>>>>                    Get piVersionBuild   Of hoVersionInfo To iBuild
51687>>>>>
51687>>>>>                    Set Version To (SFormat(C_$VERSION +": %1.%2.%3.%4", iMajor, iMinor, iRelease, iBuild))
51688>>>>>                End
51688>>>>>>
51688>>>>>            End
51688>>>>>>
51688>>>>>        End
51688>>>>>>
51688>>>>>        Forward Send End_Construct_Object
51690>>>>>    End_Procedure
51691>>>>>
51691>>>>>End_Class
51692>>>>>
51692>>>>>
51692>>>>>//Object About_Dialog is an AboutDialog
51692>>>>>//    set productname to "Visual DataFlex"
51692>>>>>//    set version to "version 4.0"
51692>>>>>//    set copyright to "Copyright 1997 Data Access Corporation"
51692>>>>>//    set author to ""
51692>>>>>//    set logo to "ablogo.bmp"  // square bitmaps of 42x42 work best
51692>>>>>//End_Object
51692>>>>>
51692>>>>>//Procedure Activate_About
51692>>>>>//   Send Popup_Modal of About_Dialog
51692>>>>>//End_Procedure
51692>>>
51692>>>
51692>>>
51692>>>
51692>>>// *************************************************************************
51692>>>//  Public message. This is the default message. It is expected that you will
51692>>>//   create your own message to override this
51692>>>// *************************************************************************
51692>>>
51692>>>Procedure Activate_About
51695>>>   Send DoAbout "" "" "" "" ""
51696>>>End_Procedure
51697>>>
51697>>>// *************************************************************************
51697>>>//  Public message. It is expected that you will send this message (most
51697>>>//  likely from Activate_About. This creates an about object, activates it
51697>>>//  and destroys it when done. It is not exepected that you will augment this.
51697>>>// *************************************************************************
51697>>>
51697>>>Procedure DoAbout String sTitle String sVersion String sCopyRight String sAuthor String sBitmap
51700>>>        Local Integer hoObj hoMain
51700>>>
51700>>>        // create object
51700>>>        Object About Is An AboutDialog
51702>>>            // if no title passed use the label of the main panel
51702>>>            // (if a main panel exists).
51702>>>            If sTitle     Eq '' Begin
51704>>>                Get Main_Window To hoMain
51705>>>                If hoMain Get Label Of hoMain To sTitle
51708>>>            End
51708>>>>
51708>>>            Set productname To sTitle
51709>>>            Set version     To sVersion
51710>>>            Set copyright   To sCopyRight
51711>>>            Set author      To sAuthor
51712>>>            If sBitmap    Ne '' ;               Set logo To sBitMap // square bitmaps of 42x42 work best
51715>>>            Move Current_Object To hoObj // object Id
51716>>>        End_Object
51717>>>        Send Popup To hoObj    // popup the about object
51718>>>        Send Request_Destroy_Object To hoObj // when done, it will be destroyed
51719>>>End_Procedure
51720>
51720>        Procedure Activate_About
51723>            Send DoAbout "" "" "" "" ""
51724>        End_Procedure
51725>
51725>        //------
51725>        Use Migrate101.vw
Including file: Migrate101.vw    (L:\VDF14.1.Dev\TITAN_MIGRATE\AppSrc\Migrate101.vw)
51725>>>
51725>>>Use DBVIEW.SUB
Including file: DBVIEW.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\DBVIEW.SUB)
51725>>>>>
51725>>>>>Use General.pkg
Including file: General.pkg    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\General.pkg)
51725>>>>>>>Use Winuser.pkg
51725>>>>>>>Use WinUsrez.pkg
Including file: WINUSREZ.PKG    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\WINUSREZ.PKG)
51725>>>>>>>>>// API Calls (Commands and Functions)
51725>>>>>>>>>// Author - SPY 10/11/98
51725>>>>>>>>>// Extension of VDF's WinUser.pkg
51725>>>>>>>>>// Created as a need to change the SystemMenu
51725>>>>>>>>>// This package will be changed (expand or shrink) according to our needs and VDF's changes
51725>>>>>>>>>
51725>>>>>>>>>Use DFTypes.pkg     // DataFlex Types (structures)
51725>>>>>>>>>Use Winuser.pkg
51725>>>>>>>>>
51725>>>>>>>>>// max_path is originally ci260, but we support a slightly smaller stringlength
51725>>>>>>>>>Define Max_Path               For |CI260
51725>>>>>>>>>
51725>>>>>>>>>// The defines below can be used to find out what kind of error has occured if
51725>>>>>>>>>// the API-call ShellExecute is used.
51725>>>>>>>>>Define ERROR_FILE_NOT_FOUND   For |CI0002
51725>>>>>>>>>Define ERROR_PATH_NOT_FOUND   For |CI0003
51725>>>>>>>>>Define ERROR_BAD_FORMAT       For |CI0011
51725>>>>>>>>>Define SE_ERR_ACCESSDENIED    For |CI0005
51725>>>>>>>>>Define SE_ERR_ASSOCINCOMPLETE For |CI0027
51725>>>>>>>>>Define SE_ERR_DDEBUSY         For |CI0030
51725>>>>>>>>>Define SE_ERR_DDEFAIL         For |CI0029
51725>>>>>>>>>Define SE_ERR_DDETIMEOUT      For |CI0028
51725>>>>>>>>>Define SE_ERR_DLLNOTFOUND     For |CI0032
51725>>>>>>>>>Define SE_ERR_FNF             For |CI0002
51725>>>>>>>>>Define SE_ERR_NOASSOC         For |CI0031
51725>>>>>>>>>Define SE_ERR_OOM             For |CI0008
51725>>>>>>>>>Define SE_ERR_PNF             For |CI0003
51725>>>>>>>>>Define SE_ERR_SHARE           For |CI0026
51725>>>>>>>>>
51725>>>>>>>>>Procedure DDE_Error_Handler Integer iErrorID
51728>>>>>>>>>  String sMessage
51728>>>>>>>>>  //Move "An error occurred during a DDE transaction.\n\n" To sMessage
51728>>>>>>>>>  Case Begin
51728>>>>>>>>>    Case (iErrorID = ERROR_FILE_NOT_FOUND)
51730>>>>>>>>>      Append sMessage "The specified file was not found.\n"
51731>>>>>>>>>      Case Break
51732>>>>>>>>>    Case (iErrorID = ERROR_PATH_NOT_FOUND)
51735>>>>>>>>>      Append sMessage "The specified path was not found.\n"
51736>>>>>>>>>      Case Break
51737>>>>>>>>>    Case (iErrorID = ERROR_BAD_FORMAT)
51740>>>>>>>>>      Append sMessage "The .EXE file is invalid.\n"
51741>>>>>>>>>      Case Break
51742>>>>>>>>>    Case (iErrorID = SE_ERR_ACCESSDENIED)
51745>>>>>>>>>      Append sMessage "The operating system denied access to the specified file.\n"
51746>>>>>>>>>      Case Break
51747>>>>>>>>>    Case (iErrorID = SE_ERR_ASSOCINCOMPLETE)
51750>>>>>>>>>      Append sMessage "The filename association is incomplete or invalid.\n"
51751>>>>>>>>>      Case Break
51752>>>>>>>>>    Case (iErrorID = SE_ERR_DDEBUSY)
51755>>>>>>>>>      Append sMessage "The DDE transaction could not be completed because other DDE\n"
51756>>>>>>>>>      Append sMessage "transactions were being processed.\n"
51757>>>>>>>>>      Case Break
51758>>>>>>>>>    Case (iErrorID = SE_ERR_DDEFAIL)
51761>>>>>>>>>      Append sMessage "The DDE transaction failed.\n"
51762>>>>>>>>>      Case Break
51763>>>>>>>>>    Case (iErrorID = SE_ERR_DDETIMEOUT)
51766>>>>>>>>>      Append sMessage "The DDE transaction could not be completed,\n"
51767>>>>>>>>>      Append sMessage "because the request timed out.\n"
51768>>>>>>>>>      Case Break
51769>>>>>>>>>    Case (iErrorID = SE_ERR_DLLNOTFOUND)
51772>>>>>>>>>      Append sMessage "The specified dynamic-link library was not found.\n"
51773>>>>>>>>>      Case Break
51774>>>>>>>>>    Case (iErrorID = SE_ERR_NOASSOC)
51777>>>>>>>>>      Append sMessage "There is no application associated with the given filename extension.\n"
51778>>>>>>>>>      Case Break
51779>>>>>>>>>    Case ((iErrorID = SE_ERR_OOM) Or (iErrorID = 0))
51782>>>>>>>>>      Append sMessage "There is not enough free memory available to complete the operation.\n"
51783>>>>>>>>>      Case Break
51784>>>>>>>>>    Case (iErrorID = SE_ERR_PNF)
51787>>>>>>>>>      Append sMessage "The specified path was not found.\n"
51788>>>>>>>>>      Case Break
51789>>>>>>>>>    Case (iErrorID = SE_ERR_SHARE)
51792>>>>>>>>>      Append sMessage "A sharing violation occurred.\n"
51793>>>>>>>>>      Case Break
51794>>>>>>>>>    Case Else
51794>>>>>>>>>      Append sMessage "Unknown DDE-error occurred.\n"
51795>>>>>>>>>      Append sMessage ("Errornumber"*Trim(iErrorID)*".\n")
51796>>>>>>>>>      Case Break
51797>>>>>>>>>  Case End
51797>>>>>>>>>  Append sMessage "\nPress OK to continue...\n\n"
51798>>>>>>>>>  Send Stop_Box sMessage "DDE-error occured"
51799>>>>>>>>>End_Procedure // DDE_Error_Handler hInstance
51800>>>>>>>>>
51800>>>>>>>>>// System Menu Command Values
51800>>>>>>>>>
51800>>>>>>>>>// Obsolete names
51800>>>>>>>>>
51800>>>>>>>>>
51800>>>>>>>>>
51800>>>>>>>>>
51800>>>>>>>>>
51800>>>>>>>>>
51800>>>>>>>>>// Date Flags for GetDateFormatW.
51800>>>>>>>>>//#replace DATE_SHORTDATE            |CI1        //  use short date picture
51800>>>>>>>>>//#replace DATE_LONGDATE             |CI2        //  use long date picture
51800>>>>>>>>>
51800>>>>>>>>>
51800>>>>>>>>>//Type tSystemTime
51800>>>>>>>>>//    Field tSystemTime.wYear As Integer
51800>>>>>>>>>//    Field tSystemTime.wMonth As Integer
51800>>>>>>>>>//    Field tSystemTime.wDayOfWeek As Integer
51800>>>>>>>>>//    Field tSystemTime.wDay As Integer
51800>>>>>>>>>//    Field tSystemTime.wHour As Integer
51800>>>>>>>>>//    Field tSystemTime.wMinute As Integer
51800>>>>>>>>>//    Field tSystemTime.wSecond As Integer
51800>>>>>>>>>//    Field tSystemTime.wMilliseconds As Integer
51800>>>>>>>>>//End_Type  // tSystemTime
51800>>>>>>>>>
51800>>>>>>>>>// Locale Dependent APIs
51800>>>>>>>>>// The Date Format
51800>>>>>>>>>//External Function GetDateFormat  "GetDateFormatA"  Kernel32.dll ;
51800>>>>>>>>>//        Integer Locale Integer dwFlags Pointer lpDate String lpFormat String lpDateStr Integer cchDate Returns Integer
51800>>>>>>>>>                                         //   as tSystemTime
51800>>>>>>>>>
51800>>>>>>>>>// Menu Functions
51800>>>>>>>>>// API call to return the menu handle
51800>>>>>>>>>External_Function GetSystemMenu "GetSystemMenu" User32.dll ;        Handle hWnd Integer bRevert Returns Handle
51801>>>>>>>>>
51801>>>>>>>>>// API call to return the menu Items Count
51801>>>>>>>>>External_Function GetMenuItemCount "GetMenuItemCount" User32.dll ;        Handle hWnd Returns Integer
51802>>>>>>>>>
51802>>>>>>>>>// API call to modify the menu items by position or by command
51802>>>>>>>>>External_Function ModifyMenu "ModifyMenuA" User32.dll ;        Handle hWnd Integer nPosition Integer wFlags Integer wIDNewItem String lpString Returns Integer
51803>>>>>>>>>
51803>>>>>>>>>// API call to get the value of a menu item
51803>>>>>>>>>External_Function GetMenuString "GetMenuStringA" User32.dll ;        Handle hWnd Integer wIDItem String lpString Integer nMaxCount Integer wFlags Returns Integer
51804>>>>>>>>>
51804>>>>>>>>>External_Function SetMenuItemInfo "SetMenuItemInfoA" User32.dll ;        Handle hWnd Integer un Integer bypos Integer lpMenuItemInfo Returns Integer
51805>>>>>>>>>
51805>>>>>>>>>External_Function GetMenuItemInfo "GetMenuItemInfoA" User32.dll ;        Handle hWnd Integer un Integer bypos Integer lpMenuItemInfo Returns Integer
51806>>>>>>>>>
51806>>>>>>>>>External_Function SetMenuItemBitmaps "SetMenuItemBitmaps" User32.dll ;        Handle hMenu Integer nPosition Integer wFlags Integer hBitmapUnchecked Integer hBitmapChecked Returns Integer
51807>>>>>>>>>
51807>>>>>>>>>// API call to delete the Items of a menu
51807>>>>>>>>>External_Function DeleteMenu "DeleteMenu" User32.dll ;        Handle hMenu Integer nPosition Integer wFlags Returns Integer
51808>>>>>>>>>
51808>>>>>>>>>// API call to return the active window associcated with the calling thread (ie DFRUN)
51808>>>>>>>>>External_Function GetActiveWindow "GetActiveWindow" user32.dll Returns Integer
51809>>>>>>>>>
51809>>>>>>>>>// change the window title so we can find the window
51809>>>>>>>>>External_Function SetConsoleTitle "SetConsoleTitleA" Kernel32.dll ;    String lpszTitle Returns Integer
51810>>>>>>>>>
51810>>>>>>>>>// Extracts an icon from a .DLL .EXE of .ICO
51810>>>>>>>>>External_Function ExtractIcon "ExtractIconA" Shell32.dll ;        Handle hInst ;        String lpIconName ;        Integer nIconIndex ;        Returns Handle
51811>>>>>>>>>
51811>>>>>>>>>//Procedure SetWindowsTitle Global String TheTitle
51811>>>>>>>>>//    Local Pointer Titlepointer
51811>>>>>>>>>//    Getaddress Of TheTitle To Titlepointer
51811>>>>>>>>>//    Move (Setconsoletitle(Titlepointer)) To Strmark
51811>>>>>>>>>//End_Procedure
51811>>>>>>>>>
51811>>>>>>>>>//Procedure SetWindowsIcon Global String TheIcon
51811>>>>>>>>>//    // Known problem!
51811>>>>>>>>>//    // The function "FINDWINDOW" finds any window with a titlebar with contents of s.1
51811>>>>>>>>>//    // when run multiple times this procedure could change the icon of an other task
51811>>>>>>>>>//    // the solution is to
51811>>>>>>>>>//    // 1. set the title to some temporary value,
51811>>>>>>>>>//    // 2. find the temporary value
51811>>>>>>>>>//    // 3. change the icon
51811>>>>>>>>>//    // 4. restore the old value of the title
51811>>>>>>>>>
51811>>>>>>>>>//    Local Handle TemHandle
51811>>>>>>>>>//    Move (FindWindow ("ConsoleWindowClass" ,s.1 )) to TemHandle     // Windows NT code!
51811>>>>>>>>>//    If TemHandle eq 0 Move (FindWindow ("tty" ,s.1 )) to TemHandle  // Windows '95/'98 code!
51811>>>>>>>>>//    Move (SendMessage(TemHandle, WM_SETICON, 0, ExtractIcon(0, TheIcon, 0))) to strmark
51811>>>>>>>>>//End_Procedure
51811>>>>>>>>>
51811>>>>>>>>>Define MAX_COMPUTERNAME_LENGTH For 15
51811>>>>>>>>>
51811>>>>>>>>>External_Function32 GetComputerName "GetComputerNameA" Kernel32.Dll ;    Pointer lpComputerName Dword nNameSize Returns Integer
51812>>>>>>>>>
51812>>>>>>>>>// LPTSTR  lpComputerName address of name buffer
51812>>>>>>>>>// LPDWORD nNameSize      address of size of name buffer
51812>>>>>>>>>
51812>>>>>>>>>
51812>>>>>>>>>// Used for printscreen
51812>>>>>>>>>//Define Byte For Integer
51812>>>>>>>>>
51812>>>>>>>>>External_Function Keybd_Event "keybd_event" User32.Dll ;    Integer bVk ;  // virtual-key code    Integer bScan ;   // hardware scan code    DWORD dwFlags ;   // flags specifying various function options    DWORD dwExtraInfo ;  // additional data associated with keystroke    Returns VOID_TYPE
51813>>>>>>>>>
51813>>>>>>>>>
51813>>>>>>>>>External_Function GetFreeResources "_MyGetFreeSystemResources32@4" ;    rsrc32.dll Integer nID Returns Integer
51814>>>>>>>>>
51814>>>>>>>>>
51814>>>>>>>>>External_Function GetEnvironmentVariable "GetEnvironmentVariableA" Kernel32.dll ;    Pointer lpVarName Pointer lpBuffer Integer nSize Returns Integer
51815>>>>>>>>>
51815>>>>>>>>>External_Function GetWindowsDirectory "GetWindowsDirectoryA" Kernel32.dll ;    Pointer lpBuffWinDir Integer nSize Returns Integer
51816>>>>>>>>>
51816>>>>>>>>>
51816>>>>>>>>>//Here are some replaces you can use for '%', '.' and '*'
51816>>>>>>>>>// Extra Keys not defined in FMAC
51816>>>>>>>>>
51816>>>>>>>>>
51816>>>>>>>>>// external function call used in Procedure DoStartDocument
51816>>>>>>>>>External_Function ShellExecute "ShellExecuteA" shell32.dll ;    Handle hWnd ;    Pointer lpOperation ;    Pointer lpFile ;    Pointer lpParameters ;    Pointer lpDirectory ;    Dword iShowCmd Returns Handle
51817>>>>>>>>>
51817>>>>>>>>>// this will perform an operation on a file (e.g. open) with the application
51817>>>>>>>>>// registered in the Windows Registry to open that type of file (via its extension)
51817>>>>>>>>>// sOperation would be "OPEN" (it could also be "PRINT" etc).
51817>>>>>>>>>Procedure DoShellExecute global String sOperation String sDocument String sParameters String sPath
51819>>>>>>>>>  Handle  hInstance hWnd
51819>>>>>>>>>  Pointer lpsOperation
51819>>>>>>>>>  Pointer lpsDocument
51819>>>>>>>>>  Pointer lpsParameters
51819>>>>>>>>>  Pointer lpsPath
51819>>>>>>>>>  // remove any leading/trailing spaces in the string
51819>>>>>>>>>  Move (Trim(sDocument)) To sDocument
51820>>>>>>>>>  Move (Trim(sPath))     To sPath
51821>>>>>>>>>  // Make the strings readable for windows API, by converting them to null-terminated
51821>>>>>>>>>  Append sOperation   (Character(0))
51822>>>>>>>>>  Append sDocument    (Character(0))
51823>>>>>>>>>  Append sParameters  (Character(0))
51824>>>>>>>>>  Append sPath        (Character(0))
51825>>>>>>>>>  // Connect the corresponding pointers to the strings
51825>>>>>>>>>  GetAddress Of sOperation  To lpsOperation
51826>>>>>>>>>  GetAddress Of sDocument   To lpsDocument
51827>>>>>>>>>  GetAddress Of sParameters To lpsParameters
51828>>>>>>>>>  GetAddress Of sPath       To lpsPath
51829>>>>>>>>>
51829>>>>>>>>>  Get Window_Handle To hWnd
51830>>>>>>>>>  Move (ShellExecute (hWnd, lpsOperation, lpsDocument, lpsParameters, lpsPath, 1)) To hInstance
51831>>>>>>>>>  If (hInstance <= 32) Begin
51833>>>>>>>>>    Send DDE_Error_Handler hInstance
51834>>>>>>>>>  End
51834>>>>>>>>>>
51834>>>>>>>>>End_Procedure // DoShellExecute
51835>>>>>>>>>
51835>>>>>>>>>// this will perform an operation on a file (e.g. open) with the application
51835>>>>>>>>>// registered in the Windows Registry to open that type of file (via its extension)
51835>>>>>>>>>// sOperation would be "OPEN" (it could also be "PRINT" etc).
51835>>>>>>>>>Procedure DoStartDocument GLOBAL String sOperation String sDocument
51837>>>>>>>>>    Send DoShellExecute sOperation (Trim (sDocument)) '' ''
51838>>>>>>>>>End_Procedure // DoStartDocument
51839>>>>>>>>>
51839>>>>>>>>>// returns default browser from Windows Registry
51839>>>>>>>>>Function DefaultBrowser Returns String
51842>>>>>>>>>    String sBrowser sRegPath
51842>>>>>>>>>
51842>>>>>>>>>    Move "Classes\http\shell\open\command" To sRegPath
51843>>>>>>>>>    Get_Foreign_Profile_String sRegPath "" "" To sBrowser
51847>>>>>>>>>    Move (Replaces('"', sBrowser, "")) To sBrowser
51848>>>>>>>>>    Function_Return sBrowser
51849>>>>>>>>>End_Function // DefaultBrowser
51850>>>>>>>>>
51850>>>>>>>>>External_Function LoadCursorFromFile  "LoadCursorFromFileA" User32.DLL ;     Pointer lpFileName Returns Integer
51851>>>>>>>>>
51851>>>>>>>>>External_Function GetCursor "GetCursor" User32.dll ;    Returns Integer
51852>>>>>>>>>
51852>>>>>>>>>
51852>>>>>>>>>Procedure ShowTaskBar
51855>>>>>>>>>    Integer iVal
51855>>>>>>>>>    Handle hWnd
51855>>>>>>>>>    Move (FindWindow("Shell_traywnd", "")) To hWnd
51856>>>>>>>>>    Move (SetWindowPos(hWnd, 0, 0, 0, 0, 0, SWP_SHOWWINDOW)) To iVal
51857>>>>>>>>>End_Procedure // ShowTaskBar
51858>>>>>>>>>
51858>>>>>>>>>
51858>>>>>>>>>Procedure HideTaskBar
51861>>>>>>>>>    Integer iVal
51861>>>>>>>>>    Handle hWnd
51861>>>>>>>>>    Move (FindWindow("Shell_traywnd", "")) To hWnd
51862>>>>>>>>>    Move (SetWindowPos(hWnd, 0, 0, 0, 0, 0, SWP_HIDEWINDOW)) To iVal
51863>>>>>>>>>End_Procedure // HideTaskBar
51864>>>>>>>>>
51864>>>>>>>>>Function DFKeyState Global Dword vKey Returns Integer
51866>>>>>>>>>    Integer rVal
51866>>>>>>>>>
51866>>>>>>>>>    Move (GetKeyState(vKey)) To rVal
51867>>>>>>>>>    // 1 vKey pressed 0 vKey is up
51867>>>>>>>>>    Move (Hi(rval)) To rVal
51868>>>>>>>>>    If (rVal) Move (65536-rVal) To rVal
51871>>>>>>>>>    Function_Return rVal
51872>>>>>>>>>End_Function // DFKeyState
51873>>>>>>>>>
51873>>>>>>>Use Dfdeoft.pkg
51873>>>>>>>
51873>>>>>>>//Open messages
51873>>>>>>>
51873>>>>>>>// Function Xlate Global String Item_Name## Returns String
51873>>>>>>>//    Local String S_Return_Val##
51873>>>>>>>//    //If sysfile.enable_xlate eq 1 Begin
51873>>>>>>>//        Clear Messages
51873>>>>>>>//        Move Item_Name## To Messages.Greek
51873>>>>>>>//        Find Eq Messages By Index.1 //Greek
51873>>>>>>>//        If (Not(Found)) Begin
51873>>>>>>>//            Saverecord Messages
51873>>>>>>>//            Unlock
51873>>>>>>>//        End
51873>>>>>>>
51873>>>>>>>//        If Messages.Local Ne ""         Move (Trim(Messages.Local))     To S_Return_Val##
51873>>>>>>>//        Else Begin
51873>>>>>>>//            If Messages.English Ne ""   Move (Trim(Messages.English))   To S_Return_Val##
51873>>>>>>>//            Else                        Move Item_Name##                To S_Return_Val##
51873>>>>>>>//        End
51873>>>>>>>//    //End
51873>>>>>>>//    //Else                                Move Item_Name##        to S_Return_Val##
51873>>>>>>>//    Function_Return S_Return_Val## Item_Name##
51873>>>>>>>//    Function_Return Item_Name##
51873>>>>>>>//End_Function //Xlate
51873>>>>>>>
51873>>>>>>>
51873>>>>>>>//Procedure Info_BoxT GLOBAL String sMessage String sTitle
51873>>>>>>>//    Forward Send Info_Box (Xlate(sMessage)) (Xlate(sTitle))
51873>>>>>>>//End_Procedure
51873>>>>>>>
51873>>>>>>>////Doc/ Interface=Public
51873>>>>>>>//Procedure Stop_BoxT GLOBAL String sMessage String sTitle
51873>>>>>>>//    Forward Send Stop_Box (Xlate(sMessage)) (Xlate(sTitle))
51873>>>>>>>//End_Procedure
51873>>>>>>>
51873>>>>>>>////Doc/ Interface=Public
51873>>>>>>>//Function YesNo_BoxT GLOBAL String sMessage String sTitle Integer DfltBtn ;
51873>>>>>>>//                           Returns Integer
51873>>>>>>>//    Integer rval
51873>>>>>>>//    Move (YesNo_Box( (Xlate(sMessage)), (Xlate(sTitle)), DfltBtn)) to rVal
51873>>>>>>>//    Function_Return rval
51873>>>>>>>//End_Function
51873>>>>>>>
51873>>>>>>>Procedure DoCustomizeDefaultFloatMenu Integer aiObj_id
51876>>>>>>>     Set Value of aiObj_id Item 0 to ""
51877>>>>>>>     Set Value of aiObj_id Item 2 to ""
51878>>>>>>>     Set Value of aiObj_id Item 3 to ""
51879>>>>>>>     Set Value of aiObj_id Item 4 to ""
51880>>>>>>>     Set Value of aiObj_id Item 5 to ""
51881>>>>>>>     Set Value of aiObj_id Item 7 to " "
51882>>>>>>>End_Procedure
51883>>>>>>>
51883>>>>>>>Procedure DoCustomizeDefaultdbFloatMenu Integer aiObj_id
51886>>>>>>>      Integer liFirstItem
51886>>>>>>>      Set Value of aiObj_id Item 0 to "&"
51887>>>>>>>      Set Value of aiObj_id Item 1 to "&"
51888>>>>>>>      Set Value of aiObj_id Item 2 to "&"
51889>>>>>>>      Set Value of aiObj_id Item 3 to " &"
51890>>>>>>>      Set Value of aiObj_id Item 4 to "&"
51891>>>>>>>      Set Value of aiObj_id Item 5 to "&"
51892>>>>>>>      Set Value of aiObj_id Item 6 to "& "
51893>>>>>>>End_Procedure
51894>>>>>>>
51894>>>>>>>Procedure GreekSysMenu
51897>>>>>>>   Local Integer hWnd hSmId iItems bState
51897>>>>>>>   Get Window_Handle to hWnd
51898>>>>>>>   If hWnd ne 0 Begin
51900>>>>>>>        Move (GetSystemMenu(hWnd,False)) to hSmId
51901>>>>>>>        Move (GetMenuItemCount(hSmId)) to iItems
51902>>>>>>>
51902>>>>>>>        Move (ModifyMenu(hSmId,SC_RESTORE,MF_BYCOMMAND + MF_STRING,SC_RESTORE,      ("    "+(ToAnsi("&")))))               to bState
51903>>>>>>>        Move (ModifyMenu(hSmId,SC_MOVE,MF_BYCOMMAND + MF_STRING,SC_MOVE,            ("    "+(ToAnsi("&")))))              to bState
51904>>>>>>>        Move (ModifyMenu(hSmId,SC_SIZE,MF_BYCOMMAND + MF_STRING,SC_SIZE,            ("    "+(ToAnsi("&")))))                 to bState
51905>>>>>>>        Move (ModifyMenu(hSmId,SC_MINIMIZE,MF_BYCOMMAND + MF_STRING,SC_MINIMIZE,    ("    "+(ToAnsi("&")))))          to bState
51906>>>>>>>        Move (ModifyMenu(hSmId,SC_MAXIMIZE,MF_BYCOMMAND + MF_STRING,SC_MAXIMIZE,    ("    "+(ToAnsi("&")))))           to bState
51907>>>>>>>        Move (ModifyMenu(hSmId,SC_CLOSE,MF_BYCOMMAND + MF_STRING,SC_CLOSE,          ("    "+(ToAnsi("&     Alt+F4")))))       to bState
51908>>>>>>>        Move (ModifyMenu(hSmId,SC_NEXTWINDOW,MF_BYCOMMAND + MF_STRING,SC_NEXTWINDOW,("    "+(ToAnsi("&       Ctrl+F6")))))   to bState
51909>>>>>>>
51909>>>>>>>//        Move (ModifyMenu(hSmId,SC_RESTORE,MF_BYCOMMAND      + MF_STRING,SC_RESTORE      ,("    "+(ToAnsi"&")))))       to bState
51909>>>>>>>//        Move (ModifyMenu(hSmId,SC_MOVE,MF_BYCOMMAND         + MF_STRING,SC_MOVE         ,("    "+(ToAnsi"&")))))      to bState
51909>>>>>>>//        Move (ModifyMenu(hSmId,SC_SIZE,MF_BYCOMMAND         + MF_STRING,SC_SIZE         ,("    "+(ToAnsi"&")))))         to bState
51909>>>>>>>//        Move (ModifyMenu(hSmId,SC_MINIMIZE,MF_BYCOMMAND     + MF_STRING,SC_MINIMIZE     ,("    "+(ToAnsi"&")))))  to bState
51909>>>>>>>//        Move (ModifyMenu(hSmId,SC_MAXIMIZE,MF_BYCOMMAND     + MF_STRING,SC_MAXIMIZE     ,("    "+(ToAnsi"&")))))   to bState
51909>>>>>>>//        Move (ModifyMenu(hSmId,SC_CLOSE,MF_BYCOMMAND        + MF_STRING,SC_CLOSE        ,("    "+(ToAnsi"&  Alt+F4")))))  to bState
51909>>>>>>>//        Move (ModifyMenu(hSmId,SC_NEXTWINDOW,MF_BYCOMMAND   + MF_STRING,SC_NEXTWINDOW   ,("    "+(ToAnsi"& Ctrl+F6"))))) to bState
51909>>>>>>>   End
51909>>>>>>>>
51909>>>>>>>End_Procedure
51910>>>>>>>
51910>>>>>>>//****************************************************************************
51910>>>>>>>// $Module type: FUNCTION
51910>>>>>>>// $Module name: Computername
51910>>>>>>>// $Author     : SPY
51910>>>>>>>// Created     : 03-01-99 @ 9:53
51910>>>>>>>//
51910>>>>>>>// Description
51910>>>>>>>//
51910>>>>>>>// $Rev History
51910>>>>>>>//****************************************************************************
51910>>>>>>>Function Computername Global Returns String
51912>>>>>>>   Local Pointer lpComputerName lpNameSize
51912>>>>>>>   Local String sComputerName sNameSize
51912>>>>>>>   Local Integer iRetval
51912>>>>>>>
51912>>>>>>>   Movestr (Repeat (Character (0), MAX_COMPUTERNAME_LENGTH + 1)) To sComputerName
51913>>>>>>>>
51913>>>>>>>   GetAddress Of sComputerName To lpComputerName
51914>>>>>>>   Movestr (DwordToBytes (MAX_COMPUTERNAME_LENGTH + 1)) To sNameSize
51915>>>>>>>>
51915>>>>>>>   GetAddress Of sNameSize To lpNameSize
51916>>>>>>>
51916>>>>>>>   Moveint (GetComputerName (lpComputerName, lpNameSize)) To iRetval
51917>>>>>>>>
51917>>>>>>>
51917>>>>>>>   Function_Return (CString (sComputerName))
51918>>>>>>>End_Function // ComputerName
51919>>>>>>>
51919>>>>>>>
51919>>>>>>>//****************************************************************************
51919>>>>>>>// $Module type: FUNCTION
51919>>>>>>>// $Module name: DateToWeekDay
51919>>>>>>>// $Author     : SPY
51919>>>>>>>// Created     : 03-01-99 @ 9:53
51919>>>>>>>//
51919>>>>>>>// Description
51919>>>>>>>//
51919>>>>>>>// $Rev History
51919>>>>>>>//****************************************************************************
51919>>>>>>>
51919>>>>>>>Function DateToWeekDay Global date dDate returns Integer
51921>>>>>>>    local string sWeekday
51921>>>>>>>    local integer iDay
51921>>>>>>>
51921>>>>>>>    // convert to 4 digits if needed
51921>>>>>>>    //
51921>>>>>>>    //if dDate le 36524 calc (dDate+693975) to dDate
51921>>>>>>>
51921>>>>>>>    // 0   1   ... 6  
51921>>>>>>>    move ((mod((dDate-2),7))) to iDay
51922>>>>>>>
51922>>>>>>>    function_return iDay
51923>>>>>>>End_Function  // DateToWeekDay
51924>>>>>>>
51924>>>>>>>
51924>>>>>>>//****************************************************************************
51924>>>>>>>// $Module type: FUNCTION
51924>>>>>>>// $Module name: DateToWeekDayName
51924>>>>>>>// $Author     : SPY
51924>>>>>>>// Created     : 03-01-99 @ 9:53
51924>>>>>>>//
51924>>>>>>>// Description
51924>>>>>>>//
51924>>>>>>>// $Rev History
51924>>>>>>>//****************************************************************************
51924>>>>>>>
51924>>>>>>>Function DateToWeekDayName Global date dDate returns String
51926>>>>>>>    local string sWeekday
51926>>>>>>>    local integer iDay
51926>>>>>>>
51926>>>>>>>    // convert to 4 digits if needed
51926>>>>>>>    //
51926>>>>>>>    //if dDate le 36524 calc (dDate+693975) to dDate
51926>>>>>>>
51926>>>>>>>    move (DateToWeekDay(dDate)) to iDay
51927>>>>>>>
51927>>>>>>>    if iDay eq 0 move ""         to sWeekday
51930>>>>>>>    else if iDay eq 1 move ""    to sWeekday
51934>>>>>>>    else if iDay eq 2 move ""      to sWeekday
51938>>>>>>>    else if iDay eq 3 move ""    to sWeekday
51942>>>>>>>    else if iDay eq 4 move ""     to sWeekday
51946>>>>>>>    else if iDay eq 5 move ""  to sWeekday
51950>>>>>>>    else if iDay eq 6 move ""    to sWeekday
51954>>>>>>>
51954>>>>>>>    function_return sWeekday
51955>>>>>>>End_Function  // DateToWeekDay
51956>>>>>>>
51956>>>>>>>
51956>>>>>>>Function DateToWeekDayNameEnglish Global Date dDate Returns String
51958>>>>>>>    Local String sWeekday
51958>>>>>>>    Local Integer iDay
51958>>>>>>>    Move (DateToWeekDay(dDate)) To iDay
51959>>>>>>>
51959>>>>>>>         If iDay eq 0 Move "Sunday"     To sWeekday
51962>>>>>>>    Else If iDay eq 1 Move "Monday"     To sWeekday
51966>>>>>>>    Else If iDay eq 2 Move "Tuesday"    To sWeekday
51970>>>>>>>    Else If iDay eq 3 Move "Wednesday"  To sWeekday
51974>>>>>>>    Else If iDay eq 4 Move "Thursday"   To sWeekday
51978>>>>>>>    Else If iDay eq 5 Move "Friday"     To sWeekday
51982>>>>>>>    Else If iDay eq 6 Move "Saturday"   To sWeekday
51986>>>>>>>
51986>>>>>>>    Function_Return sWeekday
51987>>>>>>>End_Function  // DateToWeekDay
51988>>>>>>>
51988>>>>>>>
51988>>>>>>>//****************************************************************************
51988>>>>>>>// $Module type: FUNCTION
51988>>>>>>>// $Module name: TheFirstSegment - TheSecondSegment - TheThirdSegment of Date
51988>>>>>>>// $Author     : SPY
51988>>>>>>>// Created     : 03-01-99 @ 9:53
51988>>>>>>>//
51988>>>>>>>// Description
51988>>>>>>>//
51988>>>>>>>// $Rev History
51988>>>>>>>//****************************************************************************
51988>>>>>>>
51988>>>>>>>Function TheFirstSegment Global date dDate Returns Integer
51990>>>>>>>    Local Integer rVal rPlace
51990>>>>>>>    Local String sDSep
51990>>>>>>>    Get_attribute DF_Date_Separator to rval
51993>>>>>>>    Move (Character(rVal)) to sDSep
51994>>>>>>>    Pos sDSep in dDate to rPlace
51996>>>>>>>>
51996>>>>>>>    Move (Left(dDate,(rPlace-1))) to rVal
51997>>>>>>>    Function_Return rVal
51998>>>>>>>End_Function // TheFirstSegment
51999>>>>>>>
51999>>>>>>>Function TheSecondSegment Global Date dDate Returns Integer
52001>>>>>>>    Local Integer rVal rPlace
52001>>>>>>>    Local String sDSep sDay sTempDate
52001>>>>>>>    Move dDate to sTempDate
52002>>>>>>>    Get_attribute DF_Date_Separator to rval
52005>>>>>>>    Move (Character(rVal)) to sDSep
52006>>>>>>>    Pos sDSep in sTempDate to rPlace
52008>>>>>>>>
52008>>>>>>>    Move (Left(sTempDate,(rPlace-1))) to sDay
52009>>>>>>>    Replace (sDay+sDSep) in sTempDate With ""
52011>>>>>>>    Pos sDSep in sTempDate to rPlace
52013>>>>>>>>
52013>>>>>>>    Move (Left(sTempDate,(rPlace-1))) to rVal
52014>>>>>>>    Function_Return rVal
52015>>>>>>>End_Function // TheMonthSegment
52016>>>>>>>
52016>>>>>>>Function TheThirdSegment Global Date dDate Returns Integer
52018>>>>>>>    Local Integer rVal rPlace
52018>>>>>>>    Local String sDSep sDay sMonth sTempDate
52018>>>>>>>    Move dDate to sTempDate
52019>>>>>>>    Get_attribute DF_Date_Separator to rval
52022>>>>>>>    Move (Character(rVal)) to sDSep
52023>>>>>>>    Pos sDSep in sTempDate to rPlace
52025>>>>>>>>
52025>>>>>>>    Move (Left(sTempDate,(rPlace-1))) to sDay
52026>>>>>>>    Replace (sDay+sDSep) in sTempDate With ""
52028>>>>>>>    Pos sDSep in sTempDate to rPlace
52030>>>>>>>>
52030>>>>>>>    Move (Left(sTempDate,(rPlace-1))) to sMonth
52031>>>>>>>    Replace (sMonth+sDSep) in sTempDate With ""
52033>>>>>>>    Move sTempDate to rVal
52034>>>>>>>    Function_Return rVal
52035>>>>>>>End_Function // TheThirdSegment
52036>>>>>>>
52036>>>>>>>
52036>>>>>>>//****************************************************************************
52036>>>>>>>// $Module type: FUNCTION
52036>>>>>>>// $Module name: TheYearSegment
52036>>>>>>>// $Author     : SPY
52036>>>>>>>// Created     : 03-01-99 @ 9:53
52036>>>>>>>//
52036>>>>>>>// Description
52036>>>>>>>//
52036>>>>>>>// $Rev History
52036>>>>>>>//****************************************************************************
52036>>>>>>>
52036>>>>>>>Function TheYearSegment Global Date dDate Returns Integer
52038>>>>>>>    Local Integer rVal rPlace
52038>>>>>>>    Local String sDSep
52038>>>>>>>    Local Number lnDateFormat
52038>>>>>>>    Get_Attribute DF_DATE_FORMAT to lnDateFormat
52041>>>>>>>    Get_attribute DF_Date_Separator to rval
52044>>>>>>>    If lnDateFormat eq DF_DATE_MILITARY Move (TheFirstSegment(dDate)) to rVal
52047>>>>>>>    Else Move (TheThirdSegment(dDate)) to rVal
52049>>>>>>>    Function_Return rVal
52050>>>>>>>End_Function // TheYearSegment
52051>>>>>>>
52051>>>>>>>
52051>>>>>>>//****************************************************************************
52051>>>>>>>// $Module type: FUNCTION
52051>>>>>>>// $Module name: TheDaySegment
52051>>>>>>>// $Author     : SPY
52051>>>>>>>// Created     : 03-01-99 @ 9:53
52051>>>>>>>//
52051>>>>>>>// Description
52051>>>>>>>//
52051>>>>>>>// $Rev History
52051>>>>>>>//****************************************************************************
52051>>>>>>>
52051>>>>>>>Function TheDaySegment Global date dDate Returns Integer
52053>>>>>>>    Local Integer rVal rPlace
52053>>>>>>>    Local String sDSep
52053>>>>>>>    Local Number lnDateFormat
52053>>>>>>>    Get_Attribute DF_DATE_FORMAT to lnDateFormat
52056>>>>>>>    Get_attribute DF_Date_Separator to rval
52059>>>>>>>    If lnDateFormat eq DF_DATE_EUROPEAN Move (TheFirstSegment(dDate)) to rVal
52062>>>>>>>    Else If lnDateFormat eq DF_DATE_USA Move (TheSecondSegment(dDate)) to rVal
52066>>>>>>>    Else If lnDateFormat eq DF_DATE_MILITARY Move (TheThirdSegment(dDate)) to rVal
52070>>>>>>>    Function_Return rVal
52071>>>>>>>End_Function // TheDaySegment
52072>>>>>>>
52072>>>>>>>
52072>>>>>>>//****************************************************************************
52072>>>>>>>// $Module type: FUNCTION
52072>>>>>>>// $Module name: TheMonthSegment
52072>>>>>>>// $Author     : SPY
52072>>>>>>>// Created     : 03-01-99 @ 9:53
52072>>>>>>>//
52072>>>>>>>// Description
52072>>>>>>>//
52072>>>>>>>// $Rev History
52072>>>>>>>//****************************************************************************
52072>>>>>>>
52072>>>>>>>
52072>>>>>>>Function TheMonthSegment Global date dDate Returns Integer
52074>>>>>>>    Local Integer rVal rPlace
52074>>>>>>>    Local String sDSep
52074>>>>>>>    Local Number lnDateFormat
52074>>>>>>>    Get_Attribute DF_DATE_FORMAT to lnDateFormat
52077>>>>>>>    Get_attribute DF_Date_Separator to rval
52080>>>>>>>    If lnDateFormat eq DF_DATE_USA Move (TheFirstSegment(dDate)) to rVal
52083>>>>>>>    Else Move (TheSecondSegment(dDate)) to rVal
52085>>>>>>>    Function_Return rVal
52086>>>>>>>End_Function // TheMonthSegment
52087>>>>>>>
52087>>>>>>>Function Sysdate4_Year Global Returns Integer
52089>>>>>>>    Date ldHmnia
52089>>>>>>>    Sysdate4 ldHmnia
52090>>>>>>>    Function_Return (TheYearSegment(ldHmnia))
52091>>>>>>>End_Function //private.etos
52092>>>>>>>
52092>>>>>>>Function Sysdate4_Month Global Returns Integer
52094>>>>>>>    Date ldHmnia
52094>>>>>>>    Sysdate4 ldHmnia
52095>>>>>>>    Function_Return (TheMonthSegment(ldHmnia))
52096>>>>>>>End_Function //private.mhnas
52097>>>>>>>
52097>>>>>>>Function Sysdate4_Day Global Returns Integer
52099>>>>>>>    Date ldHmnia
52099>>>>>>>    Sysdate4 ldHmnia
52100>>>>>>>    Function_Return (TheDaySegment(ldHmnia))
52101>>>>>>>End_Function //private.mhnas
52102>>>>>>>
52102>>>>>>>
52102>>>>>>>//****************************************************************************
52102>>>>>>>// $Module type: FUNCTION
52102>>>>>>>// $Module name: TheMonthName (The Modes 0 The Default , 1   , 2 
52102>>>>>>>// $Author     : SPY
52102>>>>>>>// Created     : 03-01-99 @ 9:53
52102>>>>>>>//
52102>>>>>>>// Description
52102>>>>>>>//
52102>>>>>>>// $Rev History
52102>>>>>>>//****************************************************************************
52102>>>>>>>
52102>>>>>>>Enumeration_List
52102>>>>>>>    Define mMonthOnom
52102>>>>>>>    Define mMonthGen
52102>>>>>>>    Define mMonthAit
52102>>>>>>>    Define mMonthEnglish
52102>>>>>>>End_Enumeration_List
52102>>>>>>>
52102>>>>>>>Function TheMonthName Global Integer iMonthNum Integer iMode Returns String
52104>>>>>>>    Local String rMonth
52104>>>>>>>
52104>>>>>>>    If iMode eq mMonthGen Begin
52106>>>>>>>             If iMonthNum eq 1  Move ""  to rMonth
52109>>>>>>>        Else If iMonthNum eq 2  Move "" to rMonth
52113>>>>>>>        Else If iMonthNum eq 3  Move ""     to rMonth
52117>>>>>>>        Else If iMonthNum eq 4  Move ""    to rMonth
52121>>>>>>>        Else If iMonthNum eq 5  Move ""       to rMonth
52125>>>>>>>        Else If iMonthNum eq 6  Move ""     to rMonth
52129>>>>>>>        Else If iMonthNum eq 7  Move ""     to rMonth
52133>>>>>>>        Else If iMonthNum eq 8  Move ""   to rMonth
52137>>>>>>>        Else If iMonthNum eq 9  Move "" to rMonth
52141>>>>>>>        Else If iMonthNum eq 10 Move ""   to rMonth
52145>>>>>>>        Else If iMonthNum eq 11 Move ""   to rMonth
52149>>>>>>>        Else If iMonthNum eq 12 Move ""  to rMonth
52153>>>>>>>    End
52153>>>>>>>>
52153>>>>>>>    Else Begin
52154>>>>>>>        If iMode eq mMonthAit Begin
52156>>>>>>>                 If iMonthNum eq 1  Move ""  to rMonth
52159>>>>>>>            Else If iMonthNum eq 2  Move "" to rMonth
52163>>>>>>>            Else If iMonthNum eq 3  Move ""     to rMonth
52167>>>>>>>            Else If iMonthNum eq 4  Move ""    to rMonth
52171>>>>>>>            Else If iMonthNum eq 5  Move ""       to rMonth
52175>>>>>>>            Else If iMonthNum eq 6  Move ""     to rMonth
52179>>>>>>>            Else If iMonthNum eq 7  Move ""     to rMonth
52183>>>>>>>            Else If iMonthNum eq 8  Move ""   to rMonth
52187>>>>>>>            Else If iMonthNum eq 9  Move "" to rMonth
52191>>>>>>>            Else If iMonthNum eq 10 Move ""   to rMonth
52195>>>>>>>            Else If iMonthNum eq 11 Move ""   to rMonth
52199>>>>>>>            Else If iMonthNum eq 12 Move ""  to rMonth
52203>>>>>>>        End
52203>>>>>>>>
52203>>>>>>>        Else Begin
52204>>>>>>>            If iMode eq mMonthOnom Begin
52206>>>>>>>                     If iMonthNum eq 1  Move ""  To rMonth
52209>>>>>>>                Else If iMonthNum eq 2  Move "" To rMonth
52213>>>>>>>                Else If iMonthNum eq 3  Move ""     To rMonth
52217>>>>>>>                Else If iMonthNum eq 4  Move ""    To rMonth
52221>>>>>>>                Else If iMonthNum eq 5  Move ""       To rMonth
52225>>>>>>>                Else If iMonthNum eq 6  Move ""     To rMonth
52229>>>>>>>                Else If iMonthNum eq 7  Move ""     To rMonth
52233>>>>>>>                Else If iMonthNum eq 8  Move ""   To rMonth
52237>>>>>>>                Else If iMonthNum eq 9  Move "" To rMonth
52241>>>>>>>                Else If iMonthNum eq 10 Move ""   To rMonth
52245>>>>>>>                Else If iMonthNum eq 11 Move ""   To rMonth
52249>>>>>>>                Else If iMonthNum eq 12 Move ""  To rMonth
52253>>>>>>>            End
52253>>>>>>>>
52253>>>>>>>            Else Begin
52254>>>>>>>                If iMode eq mMonthEnglish Begin
52256>>>>>>>                         If iMonthNum eq 1  Move "January"      To rMonth
52259>>>>>>>                    Else If iMonthNum eq 2  Move "February"     To rMonth
52263>>>>>>>                    Else If iMonthNum eq 3  Move "March"        To rMonth
52267>>>>>>>                    Else If iMonthNum eq 4  Move "April"        To rMonth
52271>>>>>>>                    Else If iMonthNum eq 5  Move "May"          To rMonth
52275>>>>>>>                    Else If iMonthNum eq 6  Move "June"         To rMonth
52279>>>>>>>                    Else If iMonthNum eq 7  Move "July"         To rMonth
52283>>>>>>>                    Else If iMonthNum eq 8  Move "August"       To rMonth
52287>>>>>>>                    Else If iMonthNum eq 9  Move "September"    To rMonth
52291>>>>>>>                    Else If iMonthNum eq 10 Move "October"      To rMonth
52295>>>>>>>                    Else If iMonthNum eq 11 Move "November"     To rMonth
52299>>>>>>>                    Else If iMonthNum eq 12 Move "December"     To rMonth
52303>>>>>>>                End
52303>>>>>>>>
52303>>>>>>>            End
52303>>>>>>>>
52303>>>>>>>
52303>>>>>>>        End
52303>>>>>>>>
52303>>>>>>>    End
52303>>>>>>>>
52303>>>>>>>
52303>>>>>>>    Function_Return rMonth
52304>>>>>>>End_Function // TheMonthName
52305>>>>>>>
52305>>>>>>>//****************************************************************************
52305>>>>>>>// $Module type: FUNCTION
52305>>>>>>>// $Module name: LongDateName
52305>>>>>>>// $Author     : SPY
52305>>>>>>>// Created     : 03-01-99 @ 9:53
52305>>>>>>>//
52305>>>>>>>// Description
52305>>>>>>>//
52305>>>>>>>// $Rev History
52305>>>>>>>//****************************************************************************
52305>>>>>>>
52305>>>>>>>Function LongDateName Global Date dDate Returns String
52307>>>>>>>    Local String sDay sDate sMonth sYear
52307>>>>>>>    Move (DateToWeekDayName(dDate))        to sDay
52308>>>>>>>    Move (TheDaySegment(dDate))                   to sDate
52309>>>>>>>    Move (TheMonthName((TheMonthSegment(dDate)),1)) to sMonth
52310>>>>>>>    Move (TheYearSegment(dDate))                  to sYear
52311>>>>>>>    Function_Return (sDay+","*sDate*sMonth*sYear)
52312>>>>>>>End_Function
52313>>>>>>>
52313>>>>>>>//****************************************************************************
52313>>>>>>>// $Module type: FUNCTION
52313>>>>>>>// $Module name: isDisekto
52313>>>>>>>// $Author     : SPY
52313>>>>>>>// Created     : 03-01-99 @ 9:53
52313>>>>>>>//
52313>>>>>>>// Description
52313>>>>>>>//
52313>>>>>>>// $Rev History
52313>>>>>>>//****************************************************************************
52313>>>>>>>
52313>>>>>>>Function isDisekto Global Integer liYear Returns Integer
52315>>>>>>>    Local Integer rVal
52315>>>>>>>    If (Mod(liYear,4) = 0) Begin
52317>>>>>>>        If (Mod(liYear,100) = 0) Begin
52319>>>>>>>            If (Mod(liYear,400) = 0) Move 1 to rVal
52322>>>>>>>        End
52322>>>>>>>>
52322>>>>>>>        Else Move 1 to rVal
52324>>>>>>>    End
52324>>>>>>>>
52324>>>>>>>    Function_Return rVal
52325>>>>>>>End_Function // isDisekto
52326>>>>>>>
52326>>>>>>>//****************************************************************************
52326>>>>>>>// $Module type: FUNCTION
52326>>>>>>>// $Module name: DaysOfYear
52326>>>>>>>// $Author     : SPY
52326>>>>>>>// Created     : 03-01-99 @ 9:53
52326>>>>>>>//
52326>>>>>>>// Description
52326>>>>>>>//
52326>>>>>>>// $Rev History
52326>>>>>>>//****************************************************************************
52326>>>>>>>
52326>>>>>>>Function DaysOfYear global Integer iYear Returns Integer
52328>>>>>>>    Local Integer rVal
52328>>>>>>>    Move 365 to rVal
52329>>>>>>>    If (isDisekto(iYear)) Move 366 to rVal
52332>>>>>>>    Function_Return rval
52333>>>>>>>End_Function // DaysOfYear
52334>>>>>>>
52334>>>>>>>//****************************************************************************
52334>>>>>>>// $Module type: FUNCTION
52334>>>>>>>// $Module name: BeginOfMonth
52334>>>>>>>// $Author     : SPY
52334>>>>>>>// Created     : 03-01-99 @ 9:53
52334>>>>>>>//
52334>>>>>>>// Description
52334>>>>>>>//
52334>>>>>>>// $Rev History
52334>>>>>>>//****************************************************************************
52334>>>>>>>
52334>>>>>>>Function BeginOfMonth Global Integer liMonth Integer liYear Returns Date
52336>>>>>>>    Local Integer rVal
52336>>>>>>>    Local Date rDate
52336>>>>>>>    Local String liMM lsDSep
52336>>>>>>>    Local Number lnDateFormat
52336>>>>>>>    Get_attribute DF_Date_Separator to rval
52339>>>>>>>    Move (Character(rVal)) to lsDSep
52340>>>>>>>    Get_Attribute DF_DATE_FORMAT to lnDateFormat
52343>>>>>>>    If (Length (liMonth) = 1) Move ("0" + String(liMonth)) to liMM
52346>>>>>>>    Else Move (String(liMonth)) to liMM
52348>>>>>>>    If lnDateFormat eq DF_DATE_EUROPEAN       Move ("01" + lsDSep + liMM + lsDSep + String(liYear)) to rDate
52351>>>>>>>    Else If lnDateFormat eq DF_DATE_USA       Move (liMM + lsDSep + "01" + lsDSep + String(liYear)) to rDate
52355>>>>>>>    Else If lnDateFormat eq DF_DATE_MILITARY  Move (String(liYear) + lsDSep + liMM + lsDSep + "01") to rDate
52359>>>>>>>    Function_Return rDate
52360>>>>>>>End_Function  //BeginOfMonth
52361>>>>>>>
52361>>>>>>>
52361>>>>>>>//****************************************************************************
52361>>>>>>>// $Module type: FUNCTION
52361>>>>>>>// $Module name: EndOfMonth
52361>>>>>>>// $Author     : SPY
52361>>>>>>>// Created     : 03-01-99 @ 9:53
52361>>>>>>>//
52361>>>>>>>// Description
52361>>>>>>>//
52361>>>>>>>// $Rev History
52361>>>>>>>//****************************************************************************
52361>>>>>>>
52361>>>>>>>Function EndOfMonth Global Integer liMonth Integer liYear Returns Date
52363>>>>>>>    Local Date rDate
52363>>>>>>>    If liMonth eq 12 Move (BeginOfMonth(1,(liYear+1))-1) to rDate
52366>>>>>>>    Else Move (BeginOfMonth((liMonth+1),liYear)-1) to rDate
52368>>>>>>>    Function_Return rDate
52369>>>>>>>End_Function  // EndOfMonth
52370>>>>>>>
52370>>>>>>>//****************************************************************************
52370>>>>>>>// $Module type: FUNCTION
52370>>>>>>>// $Module name: LastMonday
52370>>>>>>>// $Author     : SPY
52370>>>>>>>// Created     : 03-01-99 @ 9:53
52370>>>>>>>//
52370>>>>>>>// Description
52370>>>>>>>//
52370>>>>>>>// $Rev History
52370>>>>>>>//****************************************************************************
52370>>>>>>>
52370>>>>>>>Function LastMonday global Date dDate Returns Date
52372>>>>>>>    Local Integer iWeekDay
52372>>>>>>>    Local Date rVal
52372>>>>>>>    Move (DateToWeekDay(dDate)) to iWeekDay
52373>>>>>>>    If iWeekDay eq 0 Move (dDate-6) to rVal
52376>>>>>>>    Else Move (dDate-(iWeekDay-1)) to rVal
52378>>>>>>>    Function_Return rval
52379>>>>>>>End_Function // LastMonday
52380>>>>>>>
52380>>>>>>>
52380>>>>>>>//****************************************************************************
52380>>>>>>>// $Module type: FUNCTION
52380>>>>>>>// $Module name: DayOfTheYear
52380>>>>>>>// $Author     : SPY
52380>>>>>>>// Created     : 03-01-99 @ 9:53
52380>>>>>>>//
52380>>>>>>>// Description
52380>>>>>>>//
52380>>>>>>>// $Rev History
52380>>>>>>>//****************************************************************************
52380>>>>>>>
52380>>>>>>>Function DayOfTheYear global date dDate Returns Integer
52382>>>>>>>    local integer rVal
52382>>>>>>>    local string sYSeg
52382>>>>>>>    local date ldate lcheckdate
52382>>>>>>>    Local Number lnDateFormat
52382>>>>>>>    Get_Attribute DF_DATE_FORMAT to lnDateFormat
52385>>>>>>>    Move (BeginOfMonth(1,(TheYearSegment(dDate)))) to lDate
52386>>>>>>>    Move ((dDate-lDate)+1) to rval
52387>>>>>>>    If Not (isDisekto(TheYearSegment(dDate))=1) Begin
52389>>>>>>>        If lnDateFormat eq DF_DATE_EUROPEAN Move ("01/03/"+(String((TheYearSegment(dDate))))) to lcheckdate
52392>>>>>>>        Else If lnDateFormat eq DF_DATE_USA Move ("03/01/"+(String((TheYearSegment(dDate))))) to lcheckdate
52396>>>>>>>        Else If lnDateFormat eq DF_DATE_MILITARY Move ((String((TheYearSegment(dDate))))+"03/01/") to lcheckdate
52400>>>>>>>        If (((lCheckDate-lDate) = 60) and (dDate ge lcheckDate)) Move (dDate-lDate) to rval
52403>>>>>>>    End
52403>>>>>>>>
52403>>>>>>>    Function_Return rVal
52404>>>>>>>End_Function  // DayOfTheYear
52405>>>>>>>
52405>>>>>>>
52405>>>>>>>//****************************************************************************
52405>>>>>>>// $Module type: FUNCTION
52405>>>>>>>// $Module name: TheEasterDay
52405>>>>>>>// $Author     : SPY
52405>>>>>>>// Created     : 13-06-99 @ 9:53
52405>>>>>>>//
52405>>>>>>>// Description
52405>>>>>>>//
52405>>>>>>>// $Rev History
52405>>>>>>>//****************************************************************************
52405>>>>>>>
52405>>>>>>>Function TheEasterDay Global Integer aiTheYear Returns Date
52407>>>>>>>    Local Integer liMoonYearCycle liEpakth liEasterFullMoon liMonth
52407>>>>>>>    Local Integer liOldDateFormat liSeparator
52407>>>>>>>    Local Date ldEasterDay
52407>>>>>>>    Local String lsDSep
52407>>>>>>>    Get_attribute DF_Date_Separator to liSeparator
52410>>>>>>>    Get_Attribute DF_DATE_FORMAT to liOldDateFormat
52413>>>>>>>    Set_Attribute DF_DATE_FORMAT to DF_DATE_EUROPEAN
52416>>>>>>>    Move (Character(liSeparator)) to lsDSep
52417>>>>>>>    Move 3 to liMonth
52418>>>>>>>    Move (Mod((aiTheYear-2),19)) to liMoonYearCycle
52419>>>>>>>    Move (Mod((11*liMoonYearCycle),30)) to liEpakth
52420>>>>>>>    Move ((30-liEpakth)+14) to liEasterFullMoon
52421>>>>>>>    If liEasterFullMoon ge 21 Begin
52423>>>>>>>        If liEasterFullMoon gt 31 Begin
52425>>>>>>>            Move (liEasterFullMoon-31) to liEasterFullMoon
52426>>>>>>>            Move 4 to liMonth
52427>>>>>>>        End
52427>>>>>>>>
52427>>>>>>>    End
52427>>>>>>>>
52427>>>>>>>    Else Begin
52428>>>>>>>        Move (liEasterFullMoon-1) to liEasterFullMoon
52429>>>>>>>        Move 4 to liMonth
52430>>>>>>>    End
52430>>>>>>>>
52430>>>>>>>    Move (String(liEasterFullMoon) + lsDSep + String(liMonth) + lsDSep + String(aiTheYear)) to ldEasterDay
52431>>>>>>>    Set_Attribute DF_DATE_FORMAT to liOldDateFormat
52434>>>>>>>
52434>>>>>>>    //           ldEasterDay  
52434>>>>>>>    //Move (ldEasterDay + (7- (DateToWeekDay(ldEasterDay)) )  ) to ldEasterDay
52434>>>>>>>
52434>>>>>>>    //     14       ldEasterDay   
52434>>>>>>>    //ldEasterDay   (  )
52434>>>>>>>    If (DateToWeekDay(ldEasterDay) <> 0) Move (ldEasterDay + (7-(DateToWeekDay(ldEasterDay)))) to ldEasterDay
52437>>>>>>>    Move (ldEasterDay+14) to ldEasterDay
52438>>>>>>>    Function_Return ldEasterDay
52439>>>>>>>End_Function
52440>>>>>>>
52440>>>>>>>
52440>>>>>>>// Remarked -    VDF (ToAnsi, ToOEM) 21/09/98 -Spy
52440>>>>>>>
52440>>>>>>>//You must be aware that due to compatibility of the database between DOS CM
52440>>>>>>>//versions and VDF, all data in DataFlex datafiles will be stored using the same
52440>>>>>>>//character set (like DOS cp850).
52440>>>>>>>//This means that if you want read data from an ascii file directly into the
52440>>>>>>>//record buffer, and this ascii file is in windows (ansi) format, you must
52440>>>>>>>//convert the data first, using the OemToAnsi function. (and v.v. with AnsiToOem
52440>>>>>>>//if you want to write a text file of windows format).
52440>>>>>>>
52440>>>>>>>//The AnsiToOem and OemToAnsi functions itself takes pointers as arguments, so it
52440>>>>>>>//will be convenient to create functions on top of these, so you can call these
52440>>>>>>>//functions with a normal string as argument. I have made functions like this:
52440>>>>>>>
52440>>>>>>>//            function wintilcpDOS global string sind returns string
52440>>>>>>>//                local pointer ip
52440>>>>>>>//                local integer itmp ilen
52440>>>>>>>//                move (length(sind)) to ilen
52440>>>>>>>//                append sind (character(0))
52440>>>>>>>//                getaddress of sind to ip
52440>>>>>>>//                Move (AnsiToOem(ip,ip)) To iTmp
52440>>>>>>>//                function_return (left(sind,ilen))
52440>>>>>>>//            end_function
52440>>>>>>>
52440>>>>>>>//            function cpDOStilwin global string sind returns string
52440>>>>>>>//                local pointer ip
52440>>>>>>>//                local integer itmp ilen
52440>>>>>>>//                move (length(sind)) to ilen
52440>>>>>>>//                append sind (character(0))
52440>>>>>>>//                getaddress of sind to ip
52440>>>>>>>//                Move (OemToAnsi(ip,ip)) To iTmp
52440>>>>>>>//                function_return (left(sind,ilen))
52440>>>>>>>//            end_function
52440>>>>>>>
52440>>>>>>>// Global Handle for Set Object
52440>>>>>>>Integer ghoExpSet
52440>>>>>>>
52440>>>>>>>Function Get_ExpOfTwo Global Real arNum Returns Integer
52442>>>>>>>    Local real lrNum lrTempNum
52442>>>>>>>    Local Integer liCounter
52442>>>>>>>
52442>>>>>>>    Move arNum to lrNum
52443>>>>>>>    If ((lrNum < 10e+306) and (lrNum > 0)) Begin
52445>>>>>>>        //destroy the set using the global integer that hold its handle
52445>>>>>>>        If (ghoExpSet) Send destroy_object to ghoExpSet
52448>>>>>>>        //Make an instance of a set to hold the Exp
52448>>>>>>>        Get Make_Set to ghoExpSet
52449>>>>>>>        Move 1 to lrTempnum
52450>>>>>>>        While (lrTempnum<lrNum)
52454>>>>>>>
52454>>>>>>>            Repeat
52454>>>>>>>>
52454>>>>>>>                If ((2*lrTempnum)<=lrNum) Begin
52456>>>>>>>                    Move (2*lrTempnum) to lrTempnum
52457>>>>>>>                    Add 1 to liCounter
52458>>>>>>>                End
52458>>>>>>>>
52458>>>>>>>            Until ((2*lrTempnum)>lrNum)
52460>>>>>>>            Send Add_Element to ghoExpSet liCounter
52461>>>>>>>            If (lrTempnum<lrNum) Begin
52463>>>>>>>                Move (lrnum-lrTempnum) to lrnum
52464>>>>>>>                Move 1 to lrTempnum
52465>>>>>>>                Move 0 to liCounter
52466>>>>>>>            End
52466>>>>>>>>
52466>>>>>>>
52466>>>>>>>        Loop
52467>>>>>>>>
52467>>>>>>>    End
52467>>>>>>>>
52467>>>>>>>    If ((lrNum = lrTempnum) and (lrNum <> 1)) Move 0 to lrNum
52470>>>>>>>    Function_Return  (String(lrNum))
52471>>>>>>>End_Function
52472>>>>>>>
52472>>>>>>>
52472>>>>>>>Function Get_PowerOfTwo Global Returns Real
52474>>>>>>>    Local Real liPowerOfTwo
52474>>>>>>>    Local Integer liCounter liExp
52474>>>>>>>    For liCounter From 0 to (Item_Count(ghoExpSet)-1)
52480>>>>>>>>
52480>>>>>>>        Get Value of ghoExpSet Item liCounter to liExp
52481>>>>>>>        Add (2^liExp) to liPowerOfTwo
52482>>>>>>>    Loop
52483>>>>>>>>
52483>>>>>>>    Function_Return liPowerOfTwo
52484>>>>>>>End_Function
52485>>>>>>>
52485>>>>>>>
52485>>>>>>>
52485>>>>>>>//Set Shadow_State of Item N to (Component_Shadow_State(**C**))
52485>>>>>>>Function Component_Shadow_State Global Integer liComponenet_Code Returns Integer
52487>>>>>>>         If liComponenet_Code eq 3  Function_Return 1 //disable
52490>>>>>>>         Function_Return 0 //enabled
52491>>>>>>>End_Function
52492>>>>>>>
52492>>>>>>>// 1 cm = 556,9291 twips
52492>>>>>>>// 1 in = 1440 twips
52492>>>>>>>// 1 in = 2,54 cm
52492>>>>>>>
52492>>>>>>>Function CmToTwips Global Number aiCm Returns Integer
52494>>>>>>>    Function_Return (Round(aiCm*566.9291))
52495>>>>>>>End_Function // CmToTwips
52496>>>>>>>
52496>>>>>>>Function CmToInches Global Number aiCm Returns Number
52498>>>>>>>    Function_Return (aiCm/2.54)
52499>>>>>>>End_Function // CmToInches
52500>>>>>>>
52500>>>>>>>Function InchesToCm Global Number aiIn Returns Number
52502>>>>>>>    Function_Return (aiIn*2.54)
52503>>>>>>>End_Function // InchesToCm
52504>>>>>>>
52504>>>>>>>Function TwipsToCm Global Integer aiTwips Returns Number
52506>>>>>>>    Function_Return (aiTwips/566.9291)
52507>>>>>>>End_Function // TwipsToCm
52508>>>>>>>
52508>>>>>>>
52508>>>>>>>/// Function    Runtime 16/06/2000 Spy
52508>>>>>>>Procedure DoRunApplication For Baseclass String sAppName
52510>>>>>>>    String sRuntime
52510>>>>>>>    Integer bFileExists
52510>>>>>>>
52510>>>>>>>    get_profile_string "defaults" "VDFRootDir" to sRuntime
52513>>>>>>>    append sRuntime "\bin\dfrun.exe "
52514>>>>>>>    File_Exist sRuntime bFileExists
52515>>>>>>>    If (Not(bFileExists)) Begin
52517>>>>>>>        get_profile_string "defaults" "VDFBinDir" to sRuntime
52520>>>>>>>        append sRuntime "\dfrun.exe "
52521>>>>>>>        File_Exist sRuntime bFileExists
52522>>>>>>>        If (Not(bFileExists)) Begin
52524>>>>>>>            Send Stop_Box ".    RunTime!" " "
52525>>>>>>>            Procedure_Return
52526>>>>>>>        End
52526>>>>>>>>
52526>>>>>>>    End
52526>>>>>>>>
52526>>>>>>>    append sRuntime sAppName
52527>>>>>>>    runprogram background sRuntime
52528>>>>>>>End_procedure
52529>>>>>>>
52529>>>>>>>
52529>>>>>>>Function fsReturnFileFromPath Global String asFullPath Returns String
52531>>>>>>>    String rVal lsDirSep
52531>>>>>>>    Integer iPos iMet iLen iCnt
52531>>>>>>>    Move (Trim(asFullPath))                 To rVal
52532>>>>>>>    Move (Sysconf(SYSCONF_DIR_SEPARATOR))   To lsDirSep
52533>>>>>>>    If (rVal Contains lsDirSep) Begin
52535>>>>>>>        Move (Length(rVal)) to iLen
52536>>>>>>>        Move iLen to iCnt
52537>>>>>>>        While iCnt Gt 0
52541>>>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Begin
52543>>>>>>>                If (iCnt=iLen) Function_Return asFullPath
52546>>>>>>>                Else Function_Return (Right(rVal,(iLen-iCnt)))
52548>>>>>>>            End
52548>>>>>>>>
52548>>>>>>>            Decrement iCnt
52549>>>>>>>        End
52550>>>>>>>>
52550>>>>>>>    End
52550>>>>>>>>
52550>>>>>>>    Else  Function_Return (Trim(asFullPath))
52552>>>>>>>    Function_Return rVal
52553>>>>>>>End_Function
52554>>>>>>>
52554>>>>>>>
52554>>>>>>>
52554>>>>>>>
52554>>>>>Use WinusrEz.pkg
52554>>>>>Use ConfrmSc.pkg
Including file: CONFRMSC.PKG    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\CONFRMSC.PKG)
52554>>>>>>>USE msgbox
52554>>>>>>>
52554>>>>>>>Function fiConfirmation Global String item_name Returns Integer
52556>>>>>>>   Local Integer rval
52556>>>>>>>   Get YesNo_Box item_name "" to rval
52557>>>>>>>   Function_Return (rval<>MBR_YES)
52558>>>>>>>End_function
52559>>>>>>>
52559>>>>>>>Function confirm FOR DESKTOP String item_name Returns Integer
52561>>>>>>>   Local Integer rval
52561>>>>>>>   Get fiConfirmation item_name to rval
52562>>>>>>>   Function_Return rval
52563>>>>>>>End_function
52564>>>>>>>
52564>>>>>>>Function Save_Confirmation FOR DESKTOP Returns integer
52566>>>>>>>  Function_return (confirm(Current_Object,"  ?"))
52567>>>>>>>End_function
52568>>>>>>>
52568>>>>>>>Function Delete_Confirmation FOR DESKTOP Returns integer
52570>>>>>>>  Function_return (confirm(Current_Object,"  ?"))
52571>>>>>>>End_function
52572>>>>>>>
52572>>>>>>>Function Line_save_confirmation FOR DESKTOP Returns integer
52574>>>>>>>  Function_return (confirm(Current_Object,"  ?"))
52575>>>>>>>End_function
52576>>>>>>>
52576>>>>>>>Function Line_delete_confirmation FOR DESKTOP Returns integer
52578>>>>>>>  Function_return (confirm(Current_Object,"  ?"))
52579>>>>>>>End_function
52580>>>>>>>
52580>>>>>>>Function Data_Loss_Confirmation FOR DESKTOP Returns integer
52582>>>>>>>  Function_return (confirm(Current_Object,"   ?"))
52583>>>>>>>End_function
52584>>>>>>>
52584>>>>>>>Function Exit_Loss_Confirmation FOR DESKTOP Returns integer
52586>>>>>>>  local integer tmp
52586>>>>>>>  get Should_save_recursive to tmp
52587>>>>>>>  if tmp ne 0 Function_return (confirm(Current_Object," .   ?"))
52590>>>>>>>End_function
52591>>>>>>>
52591>>>>>>>Function No_Confirmation FOR DESKTOP Returns integer
52593>>>>>>>End_function
52594>>>>>>>
52594>>>>>>>Function Should_save for desktop returns integer
52596>>>>>>>end_function
52597>>>>>>>
52597>>>>>>>Function Should_Save_Recursive for desktop returns integer
52599>>>>>>>  Local Integer rVal
52599>>>>>>>  Get Should_Save to Rval
52600>>>>>>>  If rVal eq 0 BroadCast Get Should_Save_Recursive to Rval
52604>>>>>>>  Function_return rVal
52605>>>>>>>End_Function
52606>>>>>>>
52606>>>>>>>
52606>>>>>Use AccKeymx.ezc
Including file: ACCKEYMX.EZC    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\ACCKEYMX.EZC)
52606>>>>>>>Use dfClient
52606>>>>>>>Use cEdit_Mixin
52606>>>>>>>
52606>>>>>>>
52606>>>>>>>
52606>>>>>>>//Mixin      
52606>>>>>>>
52606>>>>>>>Class DisableAcceleratorKey_Mixin is a Mixin
52607>>>>>>>
52607>>>>>>>    Procedure Define_DisableAcceleratorKey_Mixin
52609>>>>>>>
52609>>>>>>>        //If (phoWorkspace(ghoApplication)) Begin
52609>>>>>>>            //If (Disable_Keyboard_State(phoWorkspace(ghoApplication))) Begin
52609>>>>>>>                //on_key kBegin_of_Panel      SEND None PRIVATE
52609>>>>>>>                //on_key kCancel              SEND None PRIVATE
52609>>>>>>>                //on_key kEnd_of_Panel        SEND None PRIVATE
52609>>>>>>>                //on_key kExit_Function       SEND None PRIVATE
52609>>>>>>>                //on_key kExit_Application    SEND None PRIVATE
52609>>>>>>>                //on_key kSwitch              SEND None PRIVATE
52609>>>>>>>                //on_key kSwitch_Back         SEND None PRIVATE
52609>>>>>>>                //on_key kSwitch_Panel        SEND None PRIVATE
52609>>>>>>>                //on_key kSwitch_Panel_Back   SEND None PRIVATE
52609>>>>>>>                //on_key kSwitch              SEND None PRIVATE
52609>>>>>>>                //on_key kSwitch_Back         SEND None PRIVATE
52609>>>>>>>                //on_key kSwitch_Panel        SEND None Private
52609>>>>>>>                //on_key kSwitch_Panel_Back   SEND None Private
52609>>>>>>>                //on_key kClose_Panel         SEND None PRIVATE
52609>>>>>>>                //on_key kBegin_of_Data       SEND None PRIVATE
52609>>>>>>>                //on_key kClear               SEND None PRIVATE
52609>>>>>>>                //on_key kClear_All           SEND None PRIVATE
52609>>>>>>>                //on_key kDelete_Record       SEND None PRIVATE
52609>>>>>>>                //on_key kEnd_of_Data         SEND None PRIVATE
52609>>>>>>>                //on_key kFind                SEND None PRIVATE
52609>>>>>>>                //on_key kFind_Next           SEND None PRIVATE
52609>>>>>>>                //on_key kFind_Previous       SEND None PRIVATE
52609>>>>>>>                //on_key kSave_Record         SEND None PRIVATE
52609>>>>>>>                //on_key kSuper_Find          SEND None PRIVATE
52609>>>>>>>                //on_key kSuper_Find_Next     SEND None PRIVATE
52609>>>>>>>                //on_key kSuper_Find_Previous SEND None PRIVATE
52609>>>>>>>                //on_key kPrompt              SEND None PRIVATE
52609>>>>>>>                //on_key kZoom                SEND None PRIVATE
52609>>>>>>>                //on_key kUPARROW             send None PRIVATE
52609>>>>>>>                //on_key kDOWNARROW           send None PRIVATE
52609>>>>>>>                //on_key kADD_MODE            send None PRIVATE
52609>>>>>>>                //on_key key_F11              send None PRIVATE
52609>>>>>>>                //on_key key_F12              send None PRIVATE
52609>>>>>>>                //on_key key_F10              send None PRIVATE
52609>>>>>>>                //on_key key_F1               send None PRIVATE
52609>>>>>>>                //on_key kHelp                send None PRIVATE
52609>>>>>>>                //on_key kCancel              SEND None PRIVATE
52609>>>>>>>                //on_key kEnter               SEND None PRIVATE
52609>>>>>>>                //on_key kSpace               SEND None PRIVATE
52609>>>>>>>                //on_key kEnter               SEND None PRIVATE
52609>>>>>>>                //on_key key_Tab              SEND None PRIVATE
52609>>>>>>>                //on_key key_Shift+key_Tab    SEND None PRIVATE
52609>>>>>>>            //End
52609>>>>>>>        //End
52609>>>>>>>    End_Procedure
52610>>>>>>>
52610>>>>>>>    //Procedure key Integer key_Value
52610>>>>>>>        //If (phoWorkspace(ghoApplication)) Begin
52610>>>>>>>        //    If (Not(Disable_Keyboard_State(phoWorkspace(ghoApplication)))) ;
52610>>>>>>>        //        Forward Send key key_value
52610>>>>>>>        //End
52610>>>>>>>    //End_Procedure
52610>>>>>>>
52610>>>>>>>End_Class
52611>>>>>>>
52611>>>>>>>
52611>>>>>>>
52611>>>>>Use cSize_mx.pkg
Including file: CSIZE_MX.PKG    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\CSIZE_MX.PKG)
52611>>>>>>>Use dfclient
52611>>>>>>>Use dfallent
52611>>>>>>>
52611>>>>>>>
52611>>>>>>>// CSIZE_MX.PKG
52611>>>>>>>//
52611>>>>>>>//
52611>>>>>>>// cSize_mx.pkg
52611>>>>>>>
52611>>>>>>>// Collection of classes to support automatic size and location
52611>>>>>>>// of child objects
52611>>>>>>>
52611>>>>>>>Enumeration_List
52611>>>>>>>    Define amTopRight
52611>>>>>>>    Define amTopLeft
52611>>>>>>>    Define amBottomLeft
52611>>>>>>>    Define amBottomRight
52611>>>>>>>End_Enumeration_List
52611>>>>>>>
52611>>>>>>>Enumeration_List
52611>>>>>>>    Define smTopRight
52611>>>>>>>    Define smTopLeft
52611>>>>>>>    Define smBottomLeft
52611>>>>>>>    Define smBottomRight
52611>>>>>>>End_Enumeration_List
52611>>>>>>>
52611>>>>>>>
52611>>>>>>>Class cAlignModes Is An Array
52612>>>>>>>
52612>>>>>>>    Procedure DoAdd Integer ho Integer iMode
52614>>>>>>>        Local Integer cxy cxyho cy cx xyho yho xho cxho cyho
52614>>>>>>>        Delegate Get Size To cxy
52616>>>>>>>        Get Size of ho To cxyho
52617>>>>>>>
52617>>>>>>>        Move (Hi(cxy))    To cy
52618>>>>>>>        Move (Low(cxy))   To cx
52619>>>>>>>        Move (Hi(cxyho))  To cyho
52620>>>>>>>        Move (Low(cxyho)) To cxho
52621>>>>>>>
52621>>>>>>>        Get Location of ho To xyho
52622>>>>>>>        Move (Hi(xyho))  To yho
52623>>>>>>>        Move (Low(xyho)) To xho
52624>>>>>>>
52624>>>>>>>        If iMode eq amTopRight Begin
52626>>>>>>>            Set Value item (Item_Count(Current_Object)) To ;                ( String(ho) +'|' +String(iMode) +'|' ;                +String(cx - xho) +'|' +String(yho) +'|')
52627>>>>>>>        End
52627>>>>>>>>
52627>>>>>>>        Else If iMode eq amBottomRight Begin
52630>>>>>>>            Set Value item (Item_Count(Current_Object)) To ;                ( String(ho) +'|' +String(iMode) +'|' ;                +String(cx - xho) +'|' +String(cy -yho) +'|')
52631>>>>>>>        End
52631>>>>>>>>
52631>>>>>>>        Else If iMode eq amBottomLeft Begin
52634>>>>>>>            Set Value item (Item_Count(Current_Object)) To ;                ( String(ho) +'|' +String(iMode) +'|' ;                +String(xho) +'|' +String(cy -yho) +'|')
52635>>>>>>>        End
52635>>>>>>>>
52635>>>>>>>    End_Procedure
52636>>>>>>>
52636>>>>>>>
52636>>>>>>>    Procedure DoResize
52638>>>>>>>        Local Integer iLoop icItem iPos iMode ho x y cxy cx cy
52638>>>>>>>        Local String sItem
52638>>>>>>>        Get Item_Count To icItem
52639>>>>>>>        Delegate Send Adjust_Logicals
52641>>>>>>>        Delegate Get Size To cxy
52643>>>>>>>        Move (Hi(cxy)) To cy
52644>>>>>>>        Move (Low(cxy)) To cx
52645>>>>>>>        For iLoop From 0 To (icItem -1)
52651>>>>>>>>
52651>>>>>>>            Get Value item iLoop To sItem
52652>>>>>>>            Pos '|' In sItem To iPos
52654>>>>>>>>
52654>>>>>>>            Left sItem To ho (iPos -1)
52656>>>>>>>>
52656>>>>>>>            Right sItem To sItem (Length(sItem) -iPos)
52658>>>>>>>>
52658>>>>>>>
52658>>>>>>>            Pos '|' In sItem To iPos
52660>>>>>>>>
52660>>>>>>>            Left sItem To iMode (iPos -1)
52662>>>>>>>>
52662>>>>>>>            Right sItem To sItem (Length(sItem) -iPos)
52664>>>>>>>>
52664>>>>>>>
52664>>>>>>>            Pos '|' In sItem To iPos
52666>>>>>>>>
52666>>>>>>>            Left sItem To x (iPos -1)
52668>>>>>>>>
52668>>>>>>>            Right sItem To sItem (Length(sItem) -iPos)
52670>>>>>>>>
52670>>>>>>>
52670>>>>>>>            Pos '|' In sItem To iPos
52672>>>>>>>>
52672>>>>>>>            Left sItem To y (iPos -1)
52674>>>>>>>>
52674>>>>>>>            Right sItem To sItem (Length(sItem) -iPos)
52676>>>>>>>>
52676>>>>>>>
52676>>>>>>>            If iMode eq amTopRight         ;                Set Location of ho To y (cx -x)
52679>>>>>>>            Else If iMode eq amBottomRight ;                Set Location of ho To (cy -y) (cx -x)
52683>>>>>>>            Else If iMode eq amBottomLeft  ;                Set Location of ho To (cy -y) x
52687>>>>>>>
52687>>>>>>>        Loop
52688>>>>>>>>
52688>>>>>>>    End_Procedure
52689>>>>>>>
52689>>>>>>>End_Class
52690>>>>>>>
52690>>>>>>>//cSize_mx.pkg (Continued)
52690>>>>>>>Class cSizeModes Is An Array
52691>>>>>>>
52691>>>>>>>    Procedure DoAdd Integer ho Integer iMode
52693>>>>>>>        Local Integer cxy cxyho cy cx xyho yho xho cxho cyho
52693>>>>>>>        Delegate Get Size To cxy
52695>>>>>>>        Get Size of ho To cxyho
52696>>>>>>>
52696>>>>>>>        Move (Hi(cxy))    To cy
52697>>>>>>>        Move (Low(cxy))   To cx
52698>>>>>>>        Move (Hi(cxyho))  To cyho
52699>>>>>>>        Move (Low(cxyho)) To cxho
52700>>>>>>>
52700>>>>>>>        Get Location of ho To xyho
52701>>>>>>>        Move (Hi(xyho))  To yho
52702>>>>>>>        Move (Low(xyho)) To xho
52703>>>>>>>
52703>>>>>>>        If iMode eq smBottomRight Begin
52705>>>>>>>            Set Value item (Item_Count(Current_Object)) To ;                ( String(ho) +'|' +String(iMode) +'|' ;                +String(cx -xho -cxho) +'|' ;                                        +String(cy -yho -cyho) +'|')
52706>>>>>>>        End
52706>>>>>>>>
52706>>>>>>>        Else If iMode eq smTopRight Begin
52709>>>>>>>                Set Value item (Item_Count(Current_Object)) To ;                    ( String(ho) +'|' +String(iMode) +'|' ;                    +String(cx -xho -cxho) +'|' ;                        +String(cyho) +'|')
52710>>>>>>>        End
52710>>>>>>>>
52710>>>>>>>        Else If iMode eq smTopLeft Begin
52713>>>>>>>                Set Value item (Item_Count(Current_Object)) To ;                    ( String(ho) +'|' +String(iMode) +'|' ;                    +String(cx -xho) +'|' ;                        +String(cy -yHo) +'|')
52714>>>>>>>        End
52714>>>>>>>>
52714>>>>>>>        Else If iMode eq smBottomLeft Begin
52717>>>>>>>                Set Value item (Item_Count(Current_Object)) To ;                    ( String(ho) +'|' +String(iMode) +'|' ;                    +String(cxho) +'|' ;                        +String(cy -yho -cyho) +'|')
52718>>>>>>>        End
52718>>>>>>>>
52718>>>>>>>
52718>>>>>>>    End_Procedure
52719>>>>>>>
52719>>>>>>>    Procedure DoResize
52721>>>>>>>        Local Integer iLoop icItem iPos iMode ho x y cxy cx cy xy
52721>>>>>>>        Local String sItem
52721>>>>>>>        Get Item_Count To icItem
52722>>>>>>>        Delegate Get Size To cxy
52724>>>>>>>        Move (Hi(cxy)) To cy
52725>>>>>>>        Move (Low(cxy)) To cx
52726>>>>>>>        For iLoop From 0 To (icItem -1)
52732>>>>>>>>
52732>>>>>>>            Get Value item iLoop To sItem
52733>>>>>>>            Pos '|' In sItem To iPos
52735>>>>>>>>
52735>>>>>>>            Left sItem To ho (iPos -1)
52737>>>>>>>>
52737>>>>>>>            Right sItem To sItem (Length(sItem) -iPos)
52739>>>>>>>>
52739>>>>>>>            Get Location of ho To xy
52740>>>>>>>
52740>>>>>>>            Pos '|' In sItem To iPos
52742>>>>>>>>
52742>>>>>>>            Left sItem To iMode (iPos -1)
52744>>>>>>>>
52744>>>>>>>
52744>>>>>>>
52744>>>>>>>            Right sItem To sItem (Length(sItem) -iPos)
52746>>>>>>>>
52746>>>>>>>
52746>>>>>>>            Pos '|' In sItem To iPos
52748>>>>>>>>
52748>>>>>>>            Left sItem To x (iPos -1)
52750>>>>>>>>
52750>>>>>>>            Right sItem To sItem (Length(sItem) -iPos)
52752>>>>>>>>
52752>>>>>>>
52752>>>>>>>            Pos '|' In sItem To iPos
52754>>>>>>>>
52754>>>>>>>            Left sItem To y (iPos -1)
52756>>>>>>>>
52756>>>>>>>            Right sItem To sItem (Length(sItem) -iPos)
52758>>>>>>>>
52758>>>>>>>
52758>>>>>>>            If iMode eq smBottomRight ;                Set Size of ho To (cy -y -Hi(xy)) (cx -x -Low(xy))
52761>>>>>>>            If iMode eq smTopRight ;                Set Size of ho To y (cx -x -Low(xy))
52764>>>>>>>            If iMode eq smTopLeft ;                Set Size of ho To (cy -Hi(xy)) (cx -Low(xy))
52767>>>>>>>            If iMode eq smBottomLeft ;                Set Size of ho To (cy -y -Hi(xy)) x
52770>>>>>>>
52770>>>>>>>
52770>>>>>>>        Loop
52771>>>>>>>>
52771>>>>>>>    End_Procedure
52772>>>>>>>
52772>>>>>>>End_Class
52773>>>>>>>
52773>>>>>>>
52773>>>>>>>//cSize_mx.pkg (Continued)
52773>>>>>>>
52773>>>>>>>Class cSize_mx Is A Mixin
52774>>>>>>>    Procedure Define_cSize_mx
52776>>>>>>>        Forward Send Construct_Object
52778>>>>>>>
52778>>>>>>>        Object oAlignModes Is A cAlignModes
52780>>>>>>>        End_Object
52781>>>>>>>        Object oSizeModes Is A cSizeModes
52783>>>>>>>        End_Object
52784>>>>>>>
52784>>>>>>>    End_Procedure
52785>>>>>>>
52785>>>>>>>    Procedure DoRegAlign Integer ho Integer iMode
52787>>>>>>>        Send DoAdd To (oAlignModes(Current_Object)) ho iMode
52788>>>>>>>    End_Procedure
52789>>>>>>>
52789>>>>>>>    Procedure DoRegSize Integer ho Integer iMode
52791>>>>>>>        Send DoAdd To (oSizeModes(Current_Object)) ho iMode
52792>>>>>>>    End_Procedure
52793>>>>>>>
52793>>>>>>>    Procedure OnResize
52795>>>>>>>        Forward Send OnResize
52797>>>>>>>        Send DoResize To (oAlignModes(Current_Object))
52798>>>>>>>        Send DoResize To (oSizeModes(Current_Object))
52799>>>>>>>    End_Procedure
52800>>>>>>>
52800>>>>>>>End_Class
52801>>>>>>>
52801>>>>>
52801>>>>>Class DbviewSub Is A Dbview
52802>>>>>
52802>>>>>    Procedure Construct_Object
52804>>>>>        Forward Send Construct_Object
52806>>>>>        On_Key Key_F12 Send Request_Save_No_Clear
52807>>>>>        //Send Define_DisableAcceleratorKey_Mixin
52807>>>>>        Send Define_cSize_mx
52808>>>>>        Property Integer pbVerifyExitApplication True
52809>>>>>        Property Integer pidbViewID              0
52810>>>>>        Property String  psdbViewName            ''
52811>>>>>    End_Procedure //Construct_Object
52812>>>>>
52812>>>>>    Procedure End_Construct_Object
52814>>>>>        Forward Send End_Construct_Object
52816>>>>>        Local Integer   idbViewID
52816>>>>>        Local String    sdbViewName
52816>>>>>        Get Name           to sdbViewName
52817>>>>>        Set psdbViewName   to sdbViewName
52818>>>>>        Get Object_ID      to idbViewID
52819>>>>>        Set pidbViewID     to idbViewID
52820>>>>>
52820>>>>>
52820>>>>>
52820>>>>>    End_Procedure //Construct_Object
52821>>>>>
52821>>>>>
52821>>>>>
52821>>>>>    Procedure Page Integer PageMode
52823>>>>>        Integer hWnd
52823>>>>>        Forward Send Page PageMode
52825>>>>>        Get Window_Handle to hWnd
52826>>>>>        If (hWnd) Begin
52828>>>>>            Send GreekSysMenu
52829>>>>>        End
52829>>>>>>
52829>>>>>    End_Procedure
52830>>>>>
52830>>>>>    Function Verify_Exit_Application Returns Integer
52832>>>>>        Integer Fail bState
52832>>>>>
52832>>>>>        Get View_Changed to Fail // Ask for changes in Data-sets
52833>>>>>        Get pbVerifyExitApplication to bState
52834>>>>>        If (fail AND bState) ; // ok a change exist...activate changed view.            Get confirm ("    " + "'" + ;                        Label(Current_Object) + "'" + ;                        ".\n\n    ;" ) to fail
52837>>>>>        Function_return (fail AND bState)
52838>>>>>    End_Function
52839>>>>>
52839>>>>>    //-------------------------------------------------------------------
52839>>>>>    // Change: Table entry checking - attempt to save header record
52839>>>>>    //         before entering a table (this is called by table. Return
52839>>>>>    //         a non-zero if the save failed (i.e., don't enter table)
52839>>>>>    //-------------------------------------------------------------------
52839>>>>>
52839>>>>>    Function Save_header returns integer
52841>>>>>        Local integer Rec Changed Srvr liSaveMsg
52841>>>>>        Get Server to Srvr                // The Header DDO.
52842>>>>>        If (Srvr) Begin
52844>>>>>            Get Current_Record of Srvr to Rec // The current order rec#.
52845>>>>>            Get Should_Save to Changed        // Are there any current changes?
52846>>>>>
52846>>>>>            // If there is no record and no changes we have an error.
52846>>>>>            //If (Rec=0 AND Changed=0) Begin // no rec
52846>>>>>            //    Error 300 '     \n\n    !'
52846>>>>>            //    Function_Return 1
52846>>>>>            //End
52846>>>>>            Get Verify_Save_MSG to liSaveMsg         // the old confirmation
52847>>>>>            Set Verify_Save_MSG to GET_No_Confirmation // disable confirmation
52848>>>>>            If (Rec=0 AND Changed) Begin
52850>>>>>                // Attempt to Save the current Record
52850>>>>>                // request_save_no_clear does a save without clearing.
52850>>>>>                Send request_save_no_clear
52851>>>>>            End
52851>>>>>>
52851>>>>>            // The save succeeded if there are now no changes, and we
52851>>>>>            // have a saved record. Should_save tells us if we've got changes.
52851>>>>>            // We must check the data-sets current_record property to see if
52851>>>>>            // we have a record. If it is 0, we had no save.
52851>>>>>            Get Should_Save to Changed  // is a save still needed
52852>>>>>            Get Current_record of Srvr to Rec // current record of the DD
52853>>>>>            // if no record or changes still exist, return an error code of 1
52853>>>>>            Set Verify_Save_MSG to liSaveMsg         // restore old confirm
52854>>>>>        End
52854>>>>>>
52854>>>>>        If (Rec=0) ;            Function_return 1
52857>>>>>    end_function
52858>>>>>
52858>>>>>//    Procedure Close_Panel
52858>>>>>//        Local Integer liScope
52858>>>>>//        Move (Prior_Scope(Desktop)) To liScope
52858>>>>>//        Move (Scope_Focus(liScope)) To liScope
52858>>>>>//        Forward Send Close_Panel
52858>>>>>//        Send Activate To liScope
52858>>>>>//    End_Procedure // Close_Panel
52858>>>>>
52858>>>>>//    Procedure RefreshView
52858>>>>>//        Integer iChanged
52858>>>>>//        // Do not refresh the view if unsaved changes have been made.
52858>>>>>//        Broadcast Recursive Get Data_Set_Should_Save to iChanged
52858>>>>>//        If iChanged Procedure_Return
52858>>>>>//        // pInRefreshView and pAlreadyRefreshed are for optimization.
52858>>>>>//        // Without these properties, Refresh_Page may be sent as part of the Request_Assign
52858>>>>>//        // of a grid's Parent DD, and then in the Broadcast of Refresh_Current_Page.
52858>>>>>//        // Set pInRefreshView True first, and then False at the end so that this optimization
52858>>>>>//        // does not effect any other occurences of Refresh_Page.
52858>>>>>//        Broadcast Recursive Set pInRefreshView      to True
52858>>>>>//        Broadcast Recursive Set pAlreadyRefreshed   to False
52858>>>>>//        // Restore the record for the top row of any grid in the view.
52858>>>>>//        // This stops a grid for a child file from jumping to the top of the list when DDRefresh is sent to the parent DDO.
52858>>>>>//        Broadcast Recursive Send RestoreTopRecord
52858>>>>>//        Broadcast Recursive Send DDRefresh              // Sent to all child DDs to redisplay the current record, clearing if not found.
52858>>>>>//        // Refresh_Current_Page is really only needed for the case that the current record of a grid has been
52858>>>>>//        // deleted.  In that case, the DDRefresh has cleared a row and moved the deleted record down, so the grid
52858>>>>>//        // has to be refreshed again.
52858>>>>>//        Broadcast Recursive Send Refresh_Current_Page   // Sent to all dbGrids to refresh the entire grid without changing the top record.
52858>>>>>//        Broadcast Recursive Set pInRefreshView      to False
52858>>>>>//        Broadcast Recursive Set pAlreadyRefreshed   to False
52858>>>>>//    End_Procedure
52858>>>>>
52858>>>>>//    // Refresh the view during Entering_Scope
52858>>>>>//    Procedure Entering_Scope
52858>>>>>//        Send RefreshView
52858>>>>>//        Forward Send Entering_Scope
52858>>>>>//    End_Procedure
52858>>>>>
52858>>>>>
52858>>>>>    Import_Class_Protocol DisableAcceleratorKey_Mixin
52859>>>>>    Import_Class_Protocol cSize_mx
52860>>>>>
52860>>>>>End_Class //dbviewSub
52861>>>
52861>>>//AB/ Project Data Entry View
52861>>>//AB/ Object prj is a View_Project
52861>>>//AB/     Set Size to 230 325
52861>>>
52861>>>//Open SYSCURXR
52861>>>//Open COMPANY
52861>>>
52861>>>Use File_dlg.pkg
52861>>>Use cComDPDLG.pkg
Including file: cComDPDlg.pkg    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\cComDPDlg.pkg)
52861>>>>>// Visual DataFlex COM proxy classes generated from C:\WINNT\system32\DPDlg.ocx
52861>>>>>Use FlexCom20.pkg
52861>>>>>
52861>>>>>
52861>>>>>Define OLEROOTSHORT for Integer
52861>>>>>    // Desktop
52861>>>>>    Define OLEdpdDesktop for 0
52861>>>>>    // Control Panel
52861>>>>>    Define OLEdpdControlPanel for 1
52861>>>>>    // Desktop Directory
52861>>>>>    Define OLEdpdDesktopDir for 2
52861>>>>>    // My Computer
52861>>>>>    Define OLEdpdMyComputer for 3
52861>>>>>    // Font Directory
52861>>>>>    Define OLEdpdFontDir for 4
52861>>>>>    // Network Neighborhood
52861>>>>>    Define OLEdpdNetwork for 5
52861>>>>>    // Printers
52861>>>>>    Define OLEdpdPrinters for 6
52861>>>>>    // Programs
52861>>>>>    Define OLEdpdPrograms for 7
52861>>>>>    // Recent
52861>>>>>    Define OLEdpdRecent for 8
52861>>>>>    // Recycle Bin
52861>>>>>    Define OLEdpdRecycleBin for 9
52861>>>>>    // Send To
52861>>>>>    Define OLEdpdSendTo for 10
52861>>>>>    // Start Menu
52861>>>>>    Define OLEdpdStartMenu for 11
52861>>>>>    // Start Up
52861>>>>>    Define OLEdpdStartUp for 12
52861>>>>>    // Templates
52861>>>>>    Define OLEdpdTemplates for 13
52861>>>>>    // Custom Root
52861>>>>>    Define OLEdpdCustom for 14
52861>>>>>
52861>>>>>// CLSID: {BE5AB244-F888-11D0-9F5E-B42103C10710}
52861>>>>>// Dispatch interface for DPDlg Control
52861>>>>>Class cCom_DDPDlg is a Mixin
52862>>>>>
52862>>>>>    Function ComBrowseForComputer Returns Boolean
52864>>>>>        Boolean retVal
52864>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BOOL to retVal
52865>>>>>        Function_Return retVal
52866>>>>>    End_Function
52867>>>>>
52867>>>>>    Procedure Set ComBrowseForComputer Boolean value
52869>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BOOL to value
52870>>>>>    End_Procedure
52871>>>>>
52871>>>>>    Function ComBrowseForPrinter Returns Boolean
52873>>>>>        Boolean retVal
52873>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BOOL to retVal
52874>>>>>        Function_Return retVal
52875>>>>>    End_Function
52876>>>>>
52876>>>>>    Procedure Set ComBrowseForPrinter Boolean value
52878>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BOOL to value
52879>>>>>    End_Procedure
52880>>>>>
52880>>>>>    Function ComDontGoBelowDomain Returns Boolean
52882>>>>>        Boolean retVal
52882>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to retVal
52883>>>>>        Function_Return retVal
52884>>>>>    End_Function
52885>>>>>
52885>>>>>    Procedure Set ComDontGoBelowDomain Boolean value
52887>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to value
52888>>>>>    End_Procedure
52889>>>>>
52889>>>>>    Function ComReturnFSAncestors Returns Boolean
52891>>>>>        Boolean retVal
52891>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to retVal
52892>>>>>        Function_Return retVal
52893>>>>>    End_Function
52894>>>>>
52894>>>>>    Procedure Set ComReturnFSAncestors Boolean value
52896>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to value
52897>>>>>    End_Procedure
52898>>>>>
52898>>>>>    Function ComReturnOnlyFSDirs Returns Boolean
52900>>>>>        Boolean retVal
52900>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BOOL to retVal
52901>>>>>        Function_Return retVal
52902>>>>>    End_Function
52903>>>>>
52903>>>>>    Procedure Set ComReturnOnlyFSDirs Boolean value
52905>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BOOL to value
52906>>>>>    End_Procedure
52907>>>>>
52907>>>>>    Function ComRoot Returns OLEROOTSHORT
52909>>>>>        OLEROOTSHORT retVal
52909>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
52910>>>>>        Function_Return retVal
52911>>>>>    End_Function
52912>>>>>
52912>>>>>    Procedure Set ComRoot OLEROOTSHORT value
52914>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
52915>>>>>    End_Procedure
52916>>>>>
52916>>>>>    Function ComHWnd Returns OLE_HANDLE
52918>>>>>        OLE_HANDLE retVal
52918>>>>>        Get ComProperty of (phDispatchDriver(Self)) -515 OLE_VT_I4 to retVal
52919>>>>>        Function_Return retVal
52920>>>>>    End_Function
52921>>>>>
52921>>>>>    Procedure Set ComHWnd OLE_HANDLE value
52923>>>>>        Set ComProperty of (phDispatchDriver(Self)) -515 OLE_VT_I4 to value
52924>>>>>    End_Procedure
52925>>>>>
52925>>>>>    Function ComIcon Returns Variant
52927>>>>>        Variant retVal
52927>>>>>        Get ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_DISPATCH to retVal
52928>>>>>        Function_Return retVal
52929>>>>>    End_Function
52930>>>>>
52930>>>>>    Procedure Set ComIcon Variant value
52932>>>>>        Set ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_DISPATCH to value
52933>>>>>    End_Procedure
52934>>>>>
52934>>>>>    Function ComFolder Returns String
52936>>>>>        String retVal
52936>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to retVal
52937>>>>>        Function_Return retVal
52938>>>>>    End_Function
52939>>>>>
52939>>>>>    Procedure Set ComFolder String value
52941>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to value
52942>>>>>    End_Procedure
52943>>>>>
52943>>>>>    Function ComCaption Returns String
52945>>>>>        String retVal
52945>>>>>        Get ComProperty of (phDispatchDriver(Self)) -518 OLE_VT_BSTR to retVal
52946>>>>>        Function_Return retVal
52947>>>>>    End_Function
52948>>>>>
52948>>>>>    Procedure Set ComCaption String value
52950>>>>>        Set ComProperty of (phDispatchDriver(Self)) -518 OLE_VT_BSTR to value
52951>>>>>    End_Procedure
52952>>>>>
52952>>>>>    Function Com_Caption Returns String
52954>>>>>        String retVal
52954>>>>>        Get ComProperty of (phDispatchDriver(Self)) 0 OLE_VT_BSTR to retVal
52955>>>>>        Function_Return retVal
52956>>>>>    End_Function
52957>>>>>
52957>>>>>    Procedure Set Com_Caption String value
52959>>>>>        Set ComProperty of (phDispatchDriver(Self)) 0 OLE_VT_BSTR to value
52960>>>>>    End_Procedure
52961>>>>>
52961>>>>>    Function ComPath Returns String
52963>>>>>        String retVal
52963>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to retVal
52964>>>>>        Function_Return retVal
52965>>>>>    End_Function
52966>>>>>
52966>>>>>    Procedure Set ComPath String value
52968>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to value
52969>>>>>    End_Procedure
52970>>>>>
52970>>>>>    Function ComCustomRoot Returns String
52972>>>>>        String retVal
52972>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to retVal
52973>>>>>        Function_Return retVal
52974>>>>>    End_Function
52975>>>>>
52975>>>>>    Procedure Set ComCustomRoot String value
52977>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to value
52978>>>>>    End_Procedure
52979>>>>>
52979>>>>>    Function ComShow Returns Boolean
52981>>>>>        Handle hDispatchDriver
52981>>>>>        Boolean retVal
52981>>>>>        Get phDispatchDriver to hDispatchDriver
52982>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_BOOL to retVal
52983>>>>>        Function_Return retVal
52984>>>>>    End_Function
52985>>>>>
52985>>>>>    Procedure ComAboutBox
52987>>>>>        Handle hDispatchDriver
52987>>>>>        Get phDispatchDriver to hDispatchDriver
52988>>>>>        Send InvokeComMethod to hDispatchDriver -552 OLE_VT_VOID
52989>>>>>    End_Procedure
52990>>>>>End_Class
52991>>>>>
52991>>>>>// CLSID: {BE5AB245-F888-11D0-9F5E-B42103C10710}
52991>>>>>// Event interface for DPDlg Control
52991>>>>>Class cCom_DDPDlgEvents is a Mixin
52992>>>>>
52992>>>>>    Procedure OnComFolderSelected String llPath Boolean ByRef llAllow
52994>>>>>    End_Procedure
52995>>>>>
52995>>>>>    Procedure RegisterComEvents
52997>>>>>        Send RegisterComEvent 1 msg_OnComFolderSelected
52998>>>>>    End_Procedure
52999>>>>>End_Class
53000>>>>>
53000>>>>>// CoClass
53000>>>>>// ProgID: DPDLG.DPDlgCtrl.1
53000>>>>>// CLSID: {BE5AB246-F888-11D0-9F5E-B42103C10710}
53000>>>>>// DPDlg Control
53000>>>>>Class cComDPDlg is a cComActiveXControl
53001>>>>>    Import_Class_Protocol cCom_DDPDlg
53002>>>>>    Import_Class_Protocol cCom_DDPDlgEvents
53003>>>>>
53003>>>>>    Procedure Construct_Object
53005>>>>>        Forward Send Construct_Object
53007>>>>>        Set psProgID to "{BE5AB246-F888-11D0-9F5E-B42103C10710}"
53008>>>>>        Set psEventId to "{BE5AB245-F888-11D0-9F5E-B42103C10710}"
53009>>>>>        Set peAutoCreate to acAutoCreate
53010>>>>>    End_Procedure
53011>>>>>End_Class
53012>>>Use cComXFIND.pkg
Including file: cComXfind.pkg    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\cComXfind.pkg)
53012>>>>>// Visual DataFlex COM proxy classes generated from C:\WINNT\system32\xfind10DEMO.ocx
53012>>>>>Use FlexCom20.pkg
53012>>>>>
53012>>>>>
53012>>>>>// CLSID: {DF5A0221-37A0-11D4-881C-E7F891A83074}
53012>>>>>// Dispatch interface for xfind Control
53012>>>>>Class cComIxfind is a Mixin
53013>>>>>
53013>>>>>    Procedure ComAboutBox
53015>>>>>        Handle hDispatchDriver
53015>>>>>        Get phDispatchDriver to hDispatchDriver
53016>>>>>        Send InvokeComMethod to hDispatchDriver -552 OLE_VT_VOID
53017>>>>>    End_Procedure
53018>>>>>
53018>>>>>    Function ComSearchString Returns String
53020>>>>>        Handle hDispatchDriver
53020>>>>>        String retVal
53020>>>>>        Get phDispatchDriver to hDispatchDriver
53021>>>>>        Get InvokeComMethod of hDispatchDriver 6 OLE_VT_BSTR to retVal
53022>>>>>        Function_Return retVal
53023>>>>>    End_Function
53024>>>>>
53024>>>>>    Procedure Set ComSearchString String value
53026>>>>>        Handle hDispatchDriver
53026>>>>>        Get phDispatchDriver to hDispatchDriver
53027>>>>>        Send PrepareParams to hDispatchDriver 1
53028>>>>>        Set ComProperty of hDispatchDriver 6 OLE_VT_BSTR to value
53029>>>>>    End_Procedure
53030>>>>>
53030>>>>>    Function ComSearchFrom Returns String
53032>>>>>        Handle hDispatchDriver
53032>>>>>        String retVal
53032>>>>>        Get phDispatchDriver to hDispatchDriver
53033>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_BSTR to retVal
53034>>>>>        Function_Return retVal
53035>>>>>    End_Function
53036>>>>>
53036>>>>>    Procedure Set ComSearchFrom String value
53038>>>>>        Handle hDispatchDriver
53038>>>>>        Get phDispatchDriver to hDispatchDriver
53039>>>>>        Send PrepareParams to hDispatchDriver 1
53040>>>>>        Set ComProperty of hDispatchDriver 7 OLE_VT_BSTR to value
53041>>>>>    End_Procedure
53042>>>>>
53042>>>>>    Function ComSearchSubDirs Returns Boolean
53044>>>>>        Handle hDispatchDriver
53044>>>>>        Boolean retVal
53044>>>>>        Get phDispatchDriver to hDispatchDriver
53045>>>>>        Get InvokeComMethod of hDispatchDriver 8 OLE_VT_BOOL to retVal
53046>>>>>        Function_Return retVal
53047>>>>>    End_Function
53048>>>>>
53048>>>>>    Procedure Set ComSearchSubDirs Boolean value
53050>>>>>        Handle hDispatchDriver
53050>>>>>        Get phDispatchDriver to hDispatchDriver
53051>>>>>        Send PrepareParams to hDispatchDriver 1
53052>>>>>        Set ComProperty of hDispatchDriver 8 OLE_VT_BOOL to value
53053>>>>>    End_Procedure
53054>>>>>
53054>>>>>    Procedure ComStartSearching
53056>>>>>        Handle hDispatchDriver
53056>>>>>        Get phDispatchDriver to hDispatchDriver
53057>>>>>        Send InvokeComMethod to hDispatchDriver 2 OLE_VT_VOID
53058>>>>>    End_Procedure
53059>>>>>
53059>>>>>    Function ComIsSearching Returns Boolean
53061>>>>>        Handle hDispatchDriver
53061>>>>>        Boolean retVal
53061>>>>>        Get phDispatchDriver to hDispatchDriver
53062>>>>>        Get InvokeComMethod of hDispatchDriver 5 OLE_VT_BOOL to retVal
53063>>>>>        Function_Return retVal
53064>>>>>    End_Function
53065>>>>>
53065>>>>>    Procedure ComAbortSearch
53067>>>>>        Handle hDispatchDriver
53067>>>>>        Get phDispatchDriver to hDispatchDriver
53068>>>>>        Send InvokeComMethod to hDispatchDriver 9 OLE_VT_VOID
53069>>>>>    End_Procedure
53070>>>>>
53070>>>>>    Function ComFileName Returns String
53072>>>>>        Handle hDispatchDriver
53072>>>>>        String retVal
53072>>>>>        Get phDispatchDriver to hDispatchDriver
53073>>>>>        Get InvokeComMethod of hDispatchDriver 3 OLE_VT_BSTR to retVal
53074>>>>>        Function_Return retVal
53075>>>>>    End_Function
53076>>>>>
53076>>>>>    Function ComFileSize Returns Integer
53078>>>>>        Handle hDispatchDriver
53078>>>>>        Integer retVal
53078>>>>>        Get phDispatchDriver to hDispatchDriver
53079>>>>>        Get InvokeComMethod of hDispatchDriver 4 OLE_VT_I4 to retVal
53080>>>>>        Function_Return retVal
53081>>>>>    End_Function
53082>>>>>End_Class
53083>>>>>
53083>>>>>// CLSID: {DF5A0223-37A0-11D4-881C-E7F891A83074}
53083>>>>>// Events interface for xfind Control
53083>>>>>Class cComIxfindEvents is a Mixin
53084>>>>>
53084>>>>>    Procedure OnComFinishedSearch
53086>>>>>    End_Procedure
53087>>>>>
53087>>>>>    Procedure OnComFoundFile
53089>>>>>    End_Procedure
53090>>>>>
53090>>>>>    Procedure RegisterComEvents
53092>>>>>        Send RegisterComEvent 4 msg_OnComFinishedSearch
53093>>>>>        Send RegisterComEvent 8 msg_OnComFoundFile
53094>>>>>    End_Procedure
53095>>>>>End_Class
53096>>>>>
53096>>>>>// CoClass
53096>>>>>// ProgID: xfind10.xfind
53096>>>>>// CLSID: {DF5A0225-37A0-11D4-881C-E7F891A83074}
53096>>>>>// xfind Control
53096>>>>>Class cComXfind is a cComActiveXControl
53097>>>>>    Import_Class_Protocol cComIxfind
53098>>>>>    Import_Class_Protocol cComIxfindEvents
53099>>>>>
53099>>>>>    Procedure Construct_Object
53101>>>>>        Forward Send Construct_Object
53103>>>>>        Set psProgID to "{DF5A0225-37A0-11D4-881C-E7F891A83074}"
53104>>>>>        Set psEventId to "{DF5A0223-37A0-11D4-881C-E7F891A83074}"
53105>>>>>        Set peAutoCreate to acAutoCreate
53106>>>>>    End_Procedure
53107>>>>>End_Class
53108>>>Use BUTTON.Sub
Including file: BUTTON.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\BUTTON.SUB)
53108>>>>>
53108>>>>>Use Tooltip.pkg
Including file: TOOLTIP.PKG    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\TOOLTIP.PKG)
53108>>>>>>>
53108>>>>>>>Use dfclient
53108>>>>>>>Use dfallent
53108>>>>>>>Use WINUSREZ.PKG
53108>>>>>>>
53108>>>>>>>//========================================================================================
53108>>>>>>>//  DNS Technology
53108>>>>>>>//
53108>>>>>>>//  FileName     : TOOLTIP.PKG
53108>>>>>>>//  Author       : S G Munn    (sgmunn@compuserve.com)
53108>>>>>>>//  Date Created : 01/10/1997
53108>>>>>>>//  Version      : 1.0
53108>>>>>>>//
53108>>>>>>>//  Purpose      : Tooltip controller
53108>>>>>>>//========================================================================================
53108>>>>>>>//  Parameters   : none
53108>>>>>>>//               :
53108>>>>>>>//  Interface    :
53108>>>>>>>//               :
53108>>>>>>>//========================================================================================
53108>>>>>>>//  Usage        : Use tooltip.000 just before the end_object statement of the 'main'
53108>>>>>>>//               : object.
53108>>>>>>>//               :
53108>>>>>>>//               : Also, I have had problems with timers if the dftimer package is used
53108>>>>>>>//               : inside the 'main' object.  I use dftimer outside main (just after the
53108>>>>>>>//               : 'use dfallent'). (Fixed - SPY 15/11/98)
53108>>>>>>>//               :
53108>>>>>>>//               :
53108>>>>>>>//               :
53108>>>>>>>//               :
53108>>>>>>>//               :   use tooltip.PKG //Not neccesery anymore with the EZ classes 15/11/98 - SPY
53108>>>>>>>//               : end_object // main
53108>>>>>>>//               :
53108>>>>>>>//               : for any object you want a tool tip for, define the following in the
53108>>>>>>>//               : object (or class definition)
53108>>>>>>>//               :
53108>>>>>>>//               : function TooltipHint returns string
53108>>>>>>>//               :     function_return "tool tip string" // or property, or expression etc.
53108>>>>>>>//               : end_function
53108>>>>>>>//               :
53108>>>>>>>//               : <Optional>
53108>>>>>>>//               : function TooltipHintObject returns integer
53108>>>>>>>//               :     function_return Object_ID_Of_Alternate_Tool_Tip_Object
53108>>>>>>>//               : end_function
53108>>>>>>>//               :
53108>>>>>>>//========================================================================================
53108>>>>>>>//  History      :
53108>>>>>>>//    Task Id    : none
53108>>>>>>>//    Author     : SGM
53108>>>>>>>//    Date       : 21/10/1997
53108>>>>>>>//    Comments   : Added ability for tool tip timer to 'see' the window handle of objects
53108>>>>>>>//               : within a modal panel.
53108>>>>>>>//               :
53108>>>>>>>//    Task Id    : none
53108>>>>>>>//    Author     : SGM
53108>>>>>>>//    Date       : 15/12/1997
53108>>>>>>>//    Comments   : Fixed bug with getting size and location of panel (it was offset by the
53108>>>>>>>//               : panel's caption bar).
53108>>>>>>>//               : Removed function requirement to test if object should show a tool tip -
53108>>>>>>>//               : return a null tool tip string for no tool tip.
53108>>>>>>>//               : Added ability for object to specify a different tool tip object other
53108>>>>>>>//               : than the default 'windows like' tool tip.
53108>>>>>>>//               : The parent object of this PKG does not have to 'main'.  But the PKG
53108>>>>>>>//               : should still be used at the end of the object.
53108>>>>>>>//               : Uses PlusPak!'s cTimer class.  This can be changed to use DFTimer
53108>>>>>>>//               : by changing the compiler directive TOOLTIP_USE_PLUSPAK_CTIMER to NO
53108>>>>>>>//               :
53108>>>>>>>//               :
53108>>>>>>>//    Task Id    : none
53108>>>>>>>//    Author     : SGM
53108>>>>>>>//    Date       : 15/06/1998
53108>>>>>>>//    Comments   : Changed name type POINT to TOOLTIP_POINT to avoid compile problemns
53108>>>>>>>//               : with pkg's that define a point type as well.
53108>>>>>>>//               :
53108>>>>>>>//    Task Id    : none
53108>>>>>>>//    Author     : SPY
53108>>>>>>>//    Date       : 15/11/98
53108>>>>>>>//               : Fixed bug with DFTimer Manager Handler Error (Now Use DfTimer is inside
53108>>>>>>>//               : a message Object
53108>>>>>>>//               :
53108>>>>>>>//    Task Id    : none
53108>>>>>>>//    Author     : SPY
53108>>>>>>>//    Date       : 15/11/98
53108>>>>>>>//               : The Objects StandardToolTip and TooltipTimer now are in Tooltip.inc File
53108>>>>>>>//               : that is being included in the End_Construct_Object of the dbView_EZ Class
53108>>>>>>>//               : This Must Be changed
53108>>>>>>>//               :
53108>>>>>>>//               :
53108>>>>>>>//               :
53108>>>>>>>//               : TODO.
53108>>>>>>>//               : 1. Remove tool tip when mouse is clicked.
53108>>>>>>>//               : 2. Allow the 'use tooltip.000' to be anywhere.
53108>>>>>>>//               :
53108>>>>>>>//               :
53108>>>>>>>//               :
53108>>>>>>>//               :
53108>>>>>>>//               :
53108>>>>>>>//               :
53108>>>>>>>//               :
53108>>>>>>>//========================================================================================
53108>>>>>>>use Windows
53108>>>>>>>Use Txtbox.Sub
Including file: TXTBOX.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\TXTBOX.SUB)
53108>>>>>>>>>Use Tooltip.pkg
53108>>>>>>>>>//Use AccKeymx.ezc
53108>>>>>>>>>
53108>>>>>>>>>Class TextboxSub Is A Textbox
53109>>>>>>>>>
53109>>>>>>>>>    Procedure Construct_Object
53111>>>>>>>>>        Forward Send Construct_Object
53113>>>>>>>>>        Property String TooltipValue Public ""
53114>>>>>>>>>        //Send Define_DisableAcceleratorKey_Mixin
53114>>>>>>>>>    End_Procedure
53115>>>>>>>>>
53115>>>>>>>>>    Procedure End_Construct_Object
53117>>>>>>>>>        Forward Send End_Construct_Object
53119>>>>>>>>>    End_Procedure //Construct_Object
53120>>>>>>>>>
53120>>>>>>>>>    Function TooltipHint returns string
53122>>>>>>>>>        Function_Return (TooltipValue(Self))
53123>>>>>>>>>    End_function
53124>>>>>>>>>
53124>>>>>>>>>    //Import_Class_Protocol DisableAcceleratorKey_Mixin
53124>>>>>>>>>
53124>>>>>>>>>End_Class //TextboxSub
53125>>>>>>>>>
53125>>>>>>>
53125>>>>>>>Object Default_Timer is a Message
53127>>>>>>>    use DFTimer        // DF Timer class
Including file: Dftimer.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\Dftimer.pkg)
53127>>>>>>>>>//************************************************************************
53127>>>>>>>>>//--- DFTimer   Timer package for DataFlex programs
53127>>>>>>>>>//
53127>>>>>>>>>// Copyright (c) 1983-2002 Data Access Corporation, Miami Florida,
53127>>>>>>>>>// All rights reserved.
53127>>>>>>>>>// DataFlex is a registered trademark of Data Access Corporation.
53127>>>>>>>>>//
53127>>>>>>>>>//************************************************************************
53127>>>>>>>>>//  Description:
53127>>>>>>>>>//      This package contains all components needed to implement timers
53127>>>>>>>>>//      in a DataFlex 4 program.
53127>>>>>>>>>//
53127>>>>>>>>>//
53127>>>>>>>>>//  Author: Eddy Kleinjan, Data Access Nederland
53127>>>>>>>>>//************************************************************************
53127>>>>>>>>>// 03/03/2001 EK  Fixed Timer_Active_State to check for valid windows
53127>>>>>>>>>//                handle before trying to set or kill a timer.
53127>>>>>>>>>//                Fixed Kill_All_Timers to check for valid windows
53127>>>>>>>>>//                handle before trying to kill a timer.
53127>>>>>>>>>//                The windows handle might not exist anymore when the
53127>>>>>>>>>//                program is being exited using Exit_Application.
53127>>>>>>>>>// 12/13/2001 JJT fixed Timer_Active_State to check for -1 (not 0). Fixed a
53127>>>>>>>>>//                a bug where set Timeout started inactive timers.
53127>>>>>>>>>//                Added code to force timer object to desktop
53127>>>>>>>>>//************************************************************************
53127>>>>>>>>>// CLASS DFTimer
53127>>>>>>>>>//
53127>>>>>>>>>// Usage:
53127>>>>>>>>>//    Object MyTimer is a DFTimer
53127>>>>>>>>>//
53127>>>>>>>>>//        Set Timeout to 2000                             // Default 1000
53127>>>>>>>>>//        Set Auto_Start_State to TRUE|FALSE              // Default TRUE
53127>>>>>>>>>//        Set Auto_Stop_State to TRUE|FALSE               // Default TRUE
53127>>>>>>>>>//        Set Timer_Message to MyMessage                  // Default 0
53127>>>>>>>>>//        Set Timer_Object to (MyObject(self))            // Default 0
53127>>>>>>>>>//        Set Timer_Active_State to TRUE|FALSE            // Default FALSE
53127>>>>>>>>>//
53127>>>>>>>>>//        // Augment when no Timer_Message
53127>>>>>>>>>//        Procedure OnTimer
53127>>>>>>>>>//            Send Info_Box "HEY, WAKE UP!"
53127>>>>>>>>>//        End_Procedure
53127>>>>>>>>>//
53127>>>>>>>>>//    End_Object
53127>>>>>>>>>//
53127>>>>>>>>>// DESCRIPTION
53127>>>>>>>>>//      Objects of this class can be used to trigger an event after a
53127>>>>>>>>>//      certain amount of time has passed. You can specify this time
53127>>>>>>>>>//      by setting the Timeout property of the object. This timeout
53127>>>>>>>>>//      is in miliseconds.
53127>>>>>>>>>//
53127>>>>>>>>>//      Whenever a timer event happens, it will notify the object by
53127>>>>>>>>>//      sending an OnTimer event. You can trap this event to do whatever
53127>>>>>>>>>//      you want the timer to do. By default this OnTimer event
53127>>>>>>>>>//      will send the Timer_Message to Timer_Object, when these have
53127>>>>>>>>>//      been specified.
53127>>>>>>>>>//
53127>>>>>>>>>//      By default, you have to activate a timer by setting its
53127>>>>>>>>>//      Timer_Active_State to TRUE. When the timer has been placed
53127>>>>>>>>>//      inside a user-interface object, it can also be activated
53127>>>>>>>>>//      automatically when this user-interface object is being
53127>>>>>>>>>//      activated. This only happes when it Auto_Start_State is TRUE,
53127>>>>>>>>>//      which is the default setting. In such a case, the timer will
53127>>>>>>>>>//      also automatically being stopped when the user-interface
53127>>>>>>>>>//      object is taken of the screen. This depends on the
53127>>>>>>>>>//      Auto_Stop_Timer state to happen.
53127>>>>>>>>>//
53127>>>>>>>>>//      When you need to set a new timeout value, you can do so
53127>>>>>>>>>//      even when the timer is active. It will adjust the timeout
53127>>>>>>>>>//      immediately.
53127>>>>>>>>>//
53127>>>>>>>>>//      Note that timer events depend on Windows for the delivery of
53127>>>>>>>>>//      the event. Since timer events get a low priority in Windows,
53127>>>>>>>>>//      it might put your program on hold when other programs are very
53127>>>>>>>>>//      busy. In such a case, you will only receive one timer event
53127>>>>>>>>>//      after the process stopped. There is no way, other than
53127>>>>>>>>>//      calculating it yourself, to determine how many time has passed
53127>>>>>>>>>//      or how many timer event should have happened since the last
53127>>>>>>>>>//      timer event or timer activation.
53127>>>>>>>>>//
53127>>>>>>>>>// PUBLIC INTERFACE
53127>>>>>>>>>//
53127>>>>>>>>>//    PROPERTIES
53127>>>>>>>>>//
53127>>>>>>>>>//    Auto_Start_State When TRUE (default) the timer will be activated
53127>>>>>>>>>//                     automatically when the object will be (virtually)
53127>>>>>>>>>//                     paged on the screen.
53127>>>>>>>>>//                     Example: When a timer object has been placed
53127>>>>>>>>>//                     inside a view, then the timer will be activated
53127>>>>>>>>>//                     when the view is activated.
53127>>>>>>>>>//
53127>>>>>>>>>//    Auto_Stop_State  When TRUE (default) the timer will be deactivated
53127>>>>>>>>>//                     automatically when the object will be (virtually)
53127>>>>>>>>>//                     taken off the screen.
53127>>>>>>>>>//
53127>>>>>>>>>//    Timeout          The timeout value for the timer to fire. The
53127>>>>>>>>>//                     timeout value must be set in miliseconds.
53127>>>>>>>>>//                     This property may be set even when the timer is
53127>>>>>>>>>//                     active. The new timeout value will be applied
53127>>>>>>>>>//                     immediately.
53127>>>>>>>>>//                     NOTE: The timeout set here is never precise. It
53127>>>>>>>>>//                     depends on Windows to deliver the message to our
53127>>>>>>>>>//                     application.
53127>>>>>>>>>//                     Default 1000.
53127>>>>>>>>>//
53127>>>>>>>>>//    Timer_Active_State
53127>>>>>>>>>//                     Set to TRUE to activate the timer, to FALSE to
53127>>>>>>>>>//                     deactivate the timer.
53127>>>>>>>>>//
53127>>>>>>>>>//
53127>>>>>>>>>//    Timer_Message    This property can be set to a messageID which has
53127>>>>>>>>>//                     to be sent whenever a timer event occurs. Default
53127>>>>>>>>>//                     this message will be send to the object itself
53127>>>>>>>>>//                     unless a Timer_Object as been specified.
53127>>>>>>>>>//
53127>>>>>>>>>//    Timer_Object     This property can be set to an objectID which has
53127>>>>>>>>>//                     to receive the Timer_Message whenever a timer
53127>>>>>>>>>//                     event occurs. This value has no meaning when
53127>>>>>>>>>//                     no Timer_Message has been set.
53127>>>>>>>>>//
53127>>>>>>>>>//    METHODS
53127>>>>>>>>>//
53127>>>>>>>>>//    OnTimer          This event will happen whenever the specified
53127>>>>>>>>>//                     amount of time has passed and the timer is
53127>>>>>>>>>//                     active. By default it sends the message in
53127>>>>>>>>>//                     the Timer_Message property to the object in
53127>>>>>>>>>//                     the Timer_Object when these have been specified.
53127>>>>>>>>>//                     When you don't need this, you can just override
53127>>>>>>>>>//                     the OnTimer event.
53127>>>>>>>>>//
53127>>>>>>>>>// PUBLIC INTERFACE
53127>>>>>>>>>//
53127>>>>>>>>>//    Page_Object      Has been augmented to auto_start the timer when
53127>>>>>>>>>//                     it becomes active as part or a user-interface
53127>>>>>>>>>//                     object.
53127>>>>>>>>>//
53127>>>>>>>>>//    Page_Delete      Has been augmented to auto_stop the timer when
53127>>>>>>>>>//                     it is deactivated as part or a user-interface
53127>>>>>>>>>//                     object.
53127>>>>>>>>>//
53127>>>>>>>>>//    Destroy_Object   Has been augmented to deactivate the timer.
53127>>>>>>>>>//
53127>>>>>>>>>Use LanguageText.pkg
53127>>>>>>>>>Use Windows.pkg
53127>>>>>>>>>Use WinUser.pkg
53127>>>>>>>>>
53127>>>>>>>>>External_Function SetTimer "SetTimer" User32.DLL ;    Integer hWnd ;    Integer idTimer ;    Integer idTimeout ;    Pointer tmprc ;    Returns Integer
53128>>>>>>>>>
53128>>>>>>>>>External_Function KillTimer "KillTimer" User32.DLL ;    Integer hWnd ;    Integer idTimer ;    Returns Integer
53129>>>>>>>>>
53129>>>>>>>>>// This global integer holds the ID of the object
53129>>>>>>>>>// that manages all timers.
53129>>>>>>>>>Integer giTimerManager
53129>>>>>>>>>
53129>>>>>>>>>// This class is used to store the object IDs
53129>>>>>>>>>// of the active timer objects. It augments
53129>>>>>>>>>// the Destroy_Object procedure to notify
53129>>>>>>>>>// the DFTimerManager to kill all its active
53129>>>>>>>>>// timers.
53129>>>>>>>>>// NOTE: This class looks very much like the
53129>>>>>>>>>// Set class. I didn't want to use Set because
53129>>>>>>>>>// Remove_Element shifts items which I don't
53129>>>>>>>>>// want to happen because item numbers are used
53129>>>>>>>>>// as timerIDs.
53129>>>>>>>>>
53129>>>>>>>>>Class TimersArray is an Array
53130>>>>>>>>>
53130>>>>>>>>>    Function Find_Object Integer iObj Returns Integer
53132>>>>>>>>>        Integer iMax
53132>>>>>>>>>        Integer iItem
53132>>>>>>>>>        Integer iValue
53132>>>>>>>>>        Get Item_count to iMax
53133>>>>>>>>>        Decrement iMax
53134>>>>>>>>>        For iItem from 1 to iMax
53140>>>>>>>>>>
53140>>>>>>>>>            Get Integer_Value item iItem to iValue
53141>>>>>>>>>            If iValue EQ iObj;                Function_Return iItem
53144>>>>>>>>>        Loop
53145>>>>>>>>>>
53145>>>>>>>>>        Function_Return -1
53146>>>>>>>>>    End_Function
53147>>>>>>>>>
53147>>>>>>>>>    Procedure Add_Object Integer iObj Returns Integer
53149>>>>>>>>>        Integer iItem
53149>>>>>>>>>        Get Find_Object iObj to iItem
53150>>>>>>>>>        If iItem LT 0 Begin
53152>>>>>>>>>            Get Find_Object 0 to iItem
53153>>>>>>>>>            If iItem LT 0 ;                Get Item_Count to iItem
53156>>>>>>>>>        End
53156>>>>>>>>>>
53156>>>>>>>>>        Set Array_Value item iItem to iObj
53157>>>>>>>>>        Procedure_Return iItem
53158>>>>>>>>>    End_Procedure
53159>>>>>>>>>
53159>>>>>>>>>    Procedure Remove_Object Integer iObj
53161>>>>>>>>>        Integer iItem
53161>>>>>>>>>        Get Find_Object iObj to iItem
53162>>>>>>>>>        If iItem GT 0 ;            Set Array_Value item iItem to 0
53165>>>>>>>>>    End_Procedure
53166>>>>>>>>>
53166>>>>>>>>>    Procedure Destroy_Object
53168>>>>>>>>>        Delegate Send Kill_All_Timers
53170>>>>>>>>>        Forward Send Destroy_Object
53172>>>>>>>>>    End_Procedure
53173>>>>>>>>>
53173>>>>>>>>>End_Class // TimersArray
53174>>>>>>>>>
53174>>>>>>>>>// This class is the actual timer manager
53174>>>>>>>>>// A timer will be created when Message Set_Timer_Active_State
53174>>>>>>>>>// has been send. This message needs two arguments. The first
53174>>>>>>>>>// is the objectID of the object to receive the timer event,
53174>>>>>>>>>// and the second is state. The object which ID has been passed,
53174>>>>>>>>>// needs to have a Timeout property to return the timeout for the
53174>>>>>>>>>// timer and it also needs to handle the MSG_OnTimer whenever a
53174>>>>>>>>>// timer event occurs.
53174>>>>>>>>>// The objectID of the Object will be placed in an array which contains
53174>>>>>>>>>// the objectIDs of all active timers. The Windows timer ID of a timer
53174>>>>>>>>>// is the itemnumber of the object in the array.
53174>>>>>>>>>//
53174>>>>>>>>>Class DFTimerManager is a DfBaseControl
53175>>>>>>>>>
53175>>>>>>>>>    Procedure Construct_Object
53177>>>>>>>>>
53177>>>>>>>>>        Forward Send Construct_Object
53179>>>>>>>>>
53179>>>>>>>>>        Set Visible_State to FALSE
53180>>>>>>>>>
53180>>>>>>>>>        Set External_Class_Name "cVdfTimer" to "static"
53181>>>>>>>>>        Set External_Message WM_TIMER to OnTimer
53182>>>>>>>>>
53182>>>>>>>>>        Object TimersArray is a TimersArray
53184>>>>>>>>>            Set Array_Value item 0 to -9999 // So we don't use item 0
53185>>>>>>>>>        End_Object
53186>>>>>>>>>
53186>>>>>>>>>        Move self to giTimerManager
53187>>>>>>>>>
53187>>>>>>>>>    End_Procedure
53188>>>>>>>>>
53188>>>>>>>>>    Procedure Set Timer_Active_State Integer iObj Integer iState
53190>>>>>>>>>        Integer iTimerID
53190>>>>>>>>>        Integer iTimeout
53190>>>>>>>>>        Integer iResult
53190>>>>>>>>>        Integer iSet
53190>>>>>>>>>        Dword   nResult
53190>>>>>>>>>        Handle  hWnd
53190>>>>>>>>>
53190>>>>>>>>>        // Get the handle of this object
53190>>>>>>>>>        Get Window_Handle to hWnd
53191>>>>>>>>>        If (Not(hWnd)) Begin
53193>>>>>>>>>            Error DFERR_DFTIMER C_$TimerNoHandle
53194>>>>>>>>>>
53194>>>>>>>>>            Procedure_Return
53195>>>>>>>>>        End
53195>>>>>>>>>>
53195>>>>>>>>>
53195>>>>>>>>>        // Test if handle is valid. If not, we leave.
53195>>>>>>>>>        If (Not(IsWindow(hWnd))) ;            Procedure_Return
53198>>>>>>>>>
53198>>>>>>>>>        Move (TimersArray(self)) to iSet
53199>>>>>>>>>
53199>>>>>>>>>        If (iSet) Begin
53201>>>>>>>>>
53201>>>>>>>>>            // Let's create or modify a timer
53201>>>>>>>>>            If iState Begin
53203>>>>>>>>>
53203>>>>>>>>>                // Get the exising to new TimerID
53203>>>>>>>>>                Get MSG_Add_Object of iSet iObj to iTimerID
53204>>>>>>>>>
53204>>>>>>>>>                // Set/Modify the timer
53204>>>>>>>>>                Get Timeout of iObj to iTimeout
53205>>>>>>>>>                Move (SetTimer(hWnd, iTimerID, iTimeout, 0)) to iResult
53206>>>>>>>>>                If Not iResult Begin
53208>>>>>>>>>                    Error DFERR_DFTIMER C_$TooManyTimers
53209>>>>>>>>>>
53209>>>>>>>>>                    Procedure_Return
53210>>>>>>>>>                End
53210>>>>>>>>>>
53210>>>>>>>>>
53210>>>>>>>>>            End
53210>>>>>>>>>>
53210>>>>>>>>>
53210>>>>>>>>>            // Let's kill an existing timer
53210>>>>>>>>>            Else Begin
53211>>>>>>>>>
53211>>>>>>>>>                // Look up the object in the set
53211>>>>>>>>>                Get Find_Object of iSet iObj to iTimerID
53212>>>>>>>>>
53212>>>>>>>>>                If iTimerID EQ -1 ;                    Procedure_Return
53215>>>>>>>>>
53215>>>>>>>>>                // Kill the timer
53215>>>>>>>>>                Move (KillTimer(hWnd, iTimerID)) to iResult
53216>>>>>>>>>                If Not iResult Begin
53218>>>>>>>>>                    Move (GetLastError()) to nResult
53219>>>>>>>>>                    Error DFERR_DFTIMER (C_$CantKillTimer * string(nResult) - "!")
53220>>>>>>>>>>
53220>>>>>>>>>                    Procedure_Return
53221>>>>>>>>>                End
53221>>>>>>>>>>
53221>>>>>>>>>
53221>>>>>>>>>                // Remove the objectID
53221>>>>>>>>>                Send Remove_Object to iSet iObj
53222>>>>>>>>>            End
53222>>>>>>>>>>
53222>>>>>>>>>        End
53222>>>>>>>>>>
53222>>>>>>>>>    End_Procedure
53223>>>>>>>>>
53223>>>>>>>>>    Function Timer_Active_State Integer iObj Returns Integer
53225>>>>>>>>>        Integer iResult
53225>>>>>>>>>        Get Find_Object of (TimersArray(self)) iObj to iResult
53226>>>>>>>>>        Function_Return (iResult<>-1) // note: -1= not found
53227>>>>>>>>>    End_Function
53228>>>>>>>>>
53228>>>>>>>>>    // Will be called by the Set when it is being destroyed.
53228>>>>>>>>>    Procedure Kill_All_Timers
53230>>>>>>>>>        Integer iMax
53230>>>>>>>>>        Integer iSet
53230>>>>>>>>>        Integer iItem
53230>>>>>>>>>        Integer iObj
53230>>>>>>>>>        Integer iResult
53230>>>>>>>>>        Handle  hWnd
53230>>>>>>>>>
53230>>>>>>>>>        // Get the handle of this object
53230>>>>>>>>>        Get Window_Handle to hWnd
53231>>>>>>>>>        If (Not(hWnd)) Begin
53233>>>>>>>>>            Error DFERR_DFTIMER C_$TimerNoHandle
53234>>>>>>>>>>
53234>>>>>>>>>            Procedure_Return
53235>>>>>>>>>        End
53235>>>>>>>>>>
53235>>>>>>>>>
53235>>>>>>>>>        // If the window handle is no longer valid, we
53235>>>>>>>>>        // leave this procedure. This can happen when the
53235>>>>>>>>>        // program is begin aborted using Exit_Application
53235>>>>>>>>>        If (Not(IsWindow(hWnd))) ;            Procedure_Return
53238>>>>>>>>>
53238>>>>>>>>>        // Scan the set and kill all known timers
53238>>>>>>>>>        Move (TimersArray(self)) to iSet
53239>>>>>>>>>        If (iSet) Begin
53241>>>>>>>>>            Get Item_Count of iSet to iMax
53242>>>>>>>>>            Decrement iMax
53243>>>>>>>>>            For iItem From 1 to iMax
53249>>>>>>>>>>
53249>>>>>>>>>                Get Integer_Value of iSet item iItem to iObj
53250>>>>>>>>>                If iObj Begin
53252>>>>>>>>>                    Move (KillTimer(hWnd, iItem)) to iResult
53253>>>>>>>>>                    Set Array_Value of iSet item iItem to 0
53254>>>>>>>>>                End
53254>>>>>>>>>>
53254>>>>>>>>>            Loop
53255>>>>>>>>>>
53255>>>>>>>>>        End
53255>>>>>>>>>>
53255>>>>>>>>>
53255>>>>>>>>>    End_Procedure
53256>>>>>>>>>
53256>>>>>>>>>    Procedure OnTimer Integer wParam Integer lParam
53258>>>>>>>>>        Integer iObj
53258>>>>>>>>>        Get Integer_Value of (TimersArray(self)) item wParam to iObj
53259>>>>>>>>>        If Not iObj Begin
53261>>>>>>>>>            Error DFERR_DFTIMER C_$TimerWithoutObject
53262>>>>>>>>>>
53262>>>>>>>>>            Procedure_Return
53263>>>>>>>>>        End
53263>>>>>>>>>>
53263>>>>>>>>>        Send OnTimer to iObj wParam lParam
53264>>>>>>>>>    End_Procedure
53265>>>>>>>>>
53265>>>>>>>>>    Procedure Destroy_Object
53267>>>>>>>>>        Send Kill_All_Timers
53268>>>>>>>>>        Forward Send Destroy_Object
53270>>>>>>>>>        Move 0 to giTimerManager
53271>>>>>>>>>    End_Procedure
53272>>>>>>>>>
53272>>>>>>>>>End_Class // DFTimerManger
53273>>>>>>>>>
53273>>>>>>>>>
53273>>>>>>>>>
53273>>>>>>>>>
53273>>>>>>>>>// This class acts as a container for the
53273>>>>>>>>>// timer manager object. This is needed because
53273>>>>>>>>>// A DFTimerManager object created directly at the
53273>>>>>>>>>// desktop doesn't have a Window_Handle which we
53273>>>>>>>>>// need to create a Windoows timer. By placing
53273>>>>>>>>>// this non-visual container around the timer
53273>>>>>>>>>// manager, it does get a Window_Handle.
53273>>>>>>>>>// The procedure End_Construct_Object has been
53273>>>>>>>>>// augmented to create a window and also
53273>>>>>>>>>// automatically page all children, which will
53273>>>>>>>>>// be the timer manager.
53273>>>>>>>>>//
53273>>>>>>>>>Class DFTimerManagerPanel is a dfBasePanel
53274>>>>>>>>>
53274>>>>>>>>>    Procedure Construct_Object
53276>>>>>>>>>        Forward Send Construct_Object
53278>>>>>>>>>        Set Visible_State to FALSE
53279>>>>>>>>>        Object DFTimerManager is a DFTimerManager
53281>>>>>>>>>        End_Object
53282>>>>>>>>>    End_Procedure
53283>>>>>>>>>
53283>>>>>>>>>    Procedure End_Construct_Object
53285>>>>>>>>>        Forward Send End_Construct_Object
53287>>>>>>>>>        Send Page_Object TRUE
53288>>>>>>>>>        Broadcast Send Page_Object TRUE
53290>>>>>>>>>    End_Procedure
53291>>>>>>>>>
53291>>>>>>>>>End_Class
53292>>>>>>>>>
53292>>>>>>>>>// This is the class the user uses to create DFTimer objects
53292>>>>>>>>>
53292>>>>>>>>>
53292>>>>>>>>>//{ OverrideProperty=Skip_State DesignTime=False }
53292>>>>>>>>>//{ OverrideProperty=TypeFace DesignTime=False }
53292>>>>>>>>>Class DFTimer is a Textbox
53293>>>>>>>>>
53293>>>>>>>>>    Procedure Construct_Object
53295>>>>>>>>>        Forward Send Construct_Object
53297>>>>>>>>>
53297>>>>>>>>>        // Make sure this object never appears
53297>>>>>>>>>        Set Visible_State to FALSE
53298>>>>>>>>>
53298>>>>>>>>>        Property Integer Private.Timeout    1000
53299>>>>>>>>>
53299>>>>>>>>>        Property Integer Timer_Message      0
53300>>>>>>>>>        Property Integer Timer_Object       0
53301>>>>>>>>>        Property Integer Auto_Start_State   True
53302>>>>>>>>>        Property Integer Auto_Stop_State    True
53303>>>>>>>>>    End_Procedure
53304>>>>>>>>>
53304>>>>>>>>>    Procedure Set Timer_Active_State Integer iState
53306>>>>>>>>>        Integer iObj
53306>>>>>>>>>        Move self to iObj
53307>>>>>>>>>        If giTimerManager ;            Set Timer_Active_State of giTimerManager iObj to iState
53310>>>>>>>>>    End_Procedure
53311>>>>>>>>>
53311>>>>>>>>>    Function Timer_Active_State Returns Integer
53313>>>>>>>>>        Integer iState
53313>>>>>>>>>        Integer iObj
53313>>>>>>>>>        Move self to iObj
53314>>>>>>>>>        If giTimerManager ;            Get Timer_Active_State of giTimerManager iObj to iState
53317>>>>>>>>>        Function_Return iState
53318>>>>>>>>>    End_Function
53319>>>>>>>>>
53319>>>>>>>>>    Procedure Set Timeout Integer iTimeout
53321>>>>>>>>>        Integer iActive
53321>>>>>>>>>        Set Private.Timeout to iTimeout
53322>>>>>>>>>        Get Timer_Active_State to iActive
53323>>>>>>>>>        If iActive ;            Set Timer_Active_State to TRUE
53326>>>>>>>>>    End_Procedure
53327>>>>>>>>>
53327>>>>>>>>>    Function Timeout Returns Integer
53329>>>>>>>>>        Integer iTimeout
53329>>>>>>>>>        Get Private.Timeout to iTimeout
53330>>>>>>>>>        Function_Return iTimeout
53331>>>>>>>>>    End_Function
53332>>>>>>>>>
53332>>>>>>>>>    Procedure OnTimer Integer iwParam Integer ilParam
53334>>>>>>>>>        Integer iMsg
53334>>>>>>>>>        Integer iObj
53334>>>>>>>>>        Get Timer_Message to iMsg
53335>>>>>>>>>        If (iMsg) Begin
53337>>>>>>>>>            Get Timer_Object  to iObj
53338>>>>>>>>>            If iObj ;                Send iMsg to iObj iwParam ilParam
53341>>>>>>>>>            Else ;                Send iMsg iwParam ilParam
53343>>>>>>>>>        End
53343>>>>>>>>>>
53343>>>>>>>>>    End_Procedure
53344>>>>>>>>>
53344>>>>>>>>>    // Augmented to Auto_Start a timer
53344>>>>>>>>>    //
53344>>>>>>>>>    Procedure Page_Object Integer iState
53346>>>>>>>>>        Forward Send Page_Object iState
53348>>>>>>>>>        If (iState AND Auto_Start_State(self)) ;            Set Timer_Active_State to TRUE
53351>>>>>>>>>    End_Procedure
53352>>>>>>>>>
53352>>>>>>>>>    // Augmented to Auto_Stop a timer
53352>>>>>>>>>    //
53352>>>>>>>>>    Procedure Page_Delete
53354>>>>>>>>>        If (Auto_Stop_State(self)) ;            Set Timer_Active_State to FALSE
53357>>>>>>>>>        Forward Send Page_Delete
53359>>>>>>>>>    End_Procedure
53360>>>>>>>>>
53360>>>>>>>>>    // Augmented to stop the timer
53360>>>>>>>>>    //
53360>>>>>>>>>    Procedure Destroy_Object
53362>>>>>>>>>        Set Timer_Active_State to FALSE
53363>>>>>>>>>        Forward Send Destroy_Object
53365>>>>>>>>>    End_Procedure
53366>>>>>>>>>
53366>>>>>>>>>End_Class // DFTimer
53367>>>>>>>>>
53367>>>>>>>>>//
53367>>>>>>>>>// This was moved into a method so it can be reliable created
53367>>>>>>>>>// at the desktop. Note that cDesktop adds method to cDesktop class (class of desktop)
53367>>>>>>>>>//
53367>>>>>>>>>Procedure CreateDfTimerManagerPanel FOR cDesktop
53369>>>>>>>>>    // Create the Desktop Timer Manager Object.
53369>>>>>>>>>    Object DFTimerManagerPanel is a DFTimerManagerPanel
53371>>>>>>>>>    End_Object
53372>>>>>>>>>End_Procedure
53373>>>>>>>>>
53373>>>>>>>>>Send CreateDfTimerManagerPanel of DESKTOP
53374>>>>>>>>>
53374>>>>>>>End_Object
53375>>>>>>>
53375>>>>>>>integer TooltipControllerID     // the object id of the tool tip timer
53375>>>>>>>integer DefaultTooltipHintID    // the object id of the default tool tip object
53375>>>>>>>
53375>>>>>>>// Point type
53375>>>>>>>type TOOLTIP_POINT
53375>>>>>>>    field TOOLTIP_POINT.X as dword
53375>>>>>>>    field TOOLTIP_POINT.Y as dword
53375>>>>>>>end_type
53375>>>>>>>
53375>>>>>>>// default function for objects, returns the hint string of an object
53375>>>>>>>function TooltipHint for DFObject returns string
53377>>>>>>>    function_return ""
53378>>>>>>>end_function
53379>>>>>>>
53379>>>>>>>// default function for objects, returns the hint object of an object
53379>>>>>>>function TooltipHintObject for DFObject returns string
53381>>>>>>>    function_return DefaultTooltipHintID
53382>>>>>>>end_function
53383>>>>>>>
53383>>>>>>>// SGM : 21/10/1997
53383>>>>>>>// this is a hook for us to get the window handle of a dfpanel class object.
53383>>>>>>>// this will either be the 'main' window handle, or a dialog's window handle.
53383>>>>>>>function WindowHandleForToolTip for DFPanel returns integer
53385>>>>>>>    local integer hd
53385>>>>>>>    get Window_Handle to hd
53386>>>>>>>    function_return hd
53387>>>>>>>end_function
53388>>>>>>>
53388>>>>>>>// returns the DF object id that is currently under the mouse.
53388>>>>>>>// the 'side effect' of this is that it will return the df object id of
53388>>>>>>>// ANY df object (even ones in a different VDF program!)
53388>>>>>>>function GetDFObjectUnderMouse global returns integer
53390>>>>>>>    local string  pnt    //  a TOOLTIP_POINT type
53390>>>>>>>    local pointer pPnt   //  a pointer to a TOOLTIP_POINT type
53390>>>>>>>    local integer xx     //  x location
53390>>>>>>>    local integer yy     //  y location
53390>>>>>>>    local handle  hd     //  handle of window under mouse
53390>>>>>>>    local integer iObj   //  the DF object under the mouse location
53390>>>>>>>
53390>>>>>>>    filltype TOOLTIP_POINT with 0 to pnt
53391>>>>>>>
53391>>>>>>>    GetAddress of pnt to pPnt
53392>>>>>>>
53392>>>>>>>    move (GetCursorPos(pPnt)) to windowindex
53393>>>>>>>
53393>>>>>>>    getbuff from pnt at TOOLTIP_POINT.X to xx
53394>>>>>>>    getbuff from pnt at TOOLTIP_POINT.Y to yy
53395>>>>>>>
53395>>>>>>>    move (WindowFromPoint(xx,yy)) to hd
53396>>>>>>>
53396>>>>>>>    Get_Object_From_Window hd to iObj
53397>>>>>>>
53397>>>>>>>    function_return iObj
53398>>>>>>>end_function
53399>>>>>>>
53399>>>>>>>//========================================================================================
53399>>>>>>>//  Name         : StandardToolTipLabel000
53399>>>>>>>//  Purpose      : Our 'label' in the standard tool tip object.
53399>>>>>>>//========================================================================================
53399>>>>>>>class StandardToolTipLabel000 is a TextboxSub
53400>>>>>>>    // A form is used because a text box doesn't set object_color to 4103 4120
53400>>>>>>>    // which is the windows tool tip hint color.
53400>>>>>>>
53400>>>>>>>
53400>>>>>>>    //====================================================================================
53400>>>>>>>    //  Name         : Construct_Object
53400>>>>>>>    //  Scope        : PRIVATE
53400>>>>>>>    //  Purpose      : Augmentation
53400>>>>>>>    //====================================================================================
53400>>>>>>>    procedure Construct_Object
53402>>>>>>>        forward send Construct_Object
53404>>>>>>>        //set Object_Color to 4103 4120
53404>>>>>>>        Set Color to 14811135
53405>>>>>>>        Set TextColor to clNavy
53406>>>>>>>        set Border_Style to BORDER_NONE    // weird how border none still gives a border for a form
53407>>>>>>>        set Focus_Mode   to NONFOCUSABLE
53408>>>>>>>    end_procedure
53409>>>>>>>
53409>>>>>>>    //====================================================================================
53409>>>>>>>    //  Name         : Autosize
53409>>>>>>>    //  Scope        : PRIVATE
53409>>>>>>>    //  Purpose      : Auto size the label
53409>>>>>>>    //====================================================================================
53409>>>>>>>    // borrowed from textbox
53409>>>>>>>    procedure Autosize String Val
53411>>>>>>>        local integer ext
53411>>>>>>>        get Text_Extent (ToAnsi(Val)) to ext
53412>>>>>>>        //Set Guisize To (Hi(Ext)+3) (Low(Ext)+2)
53412>>>>>>>
53412>>>>>>>        // some hard coded sizes, works though
53412>>>>>>>        set Guisize to (hi(Ext)+8) (low(Ext)+5)
53413>>>>>>>        send Adjust_logicals
53414>>>>>>>    end_procedure
53415>>>>>>>
53415>>>>>>>    //====================================================================================
53415>>>>>>>    //  Name         : UpdateTip
53415>>>>>>>    //  Scope        : PUBLIC
53415>>>>>>>    //  Purpose      : Update the tool tip with the new one
53415>>>>>>>    //====================================================================================
53415>>>>>>>    procedure UpdateTip string sTip
53417>>>>>>>        // pad with some spaces 'cause we want a 'border' around the text
53417>>>>>>>        set Value Item 0 to ("  " + sTip + "  ")
53418>>>>>>>        send Autosize (" " + sTip + " ")
53419>>>>>>>    end_procedure
53420>>>>>>>
53420>>>>>>>    //====================================================================================
53420>>>>>>>    //  Name         : ToolTipValue
53420>>>>>>>    //  Scope        : PUBLIC
53420>>>>>>>    //  Purpose      : What is the current tool tip value
53420>>>>>>>    //====================================================================================
53420>>>>>>>    function ToolTipValue returns string
53422>>>>>>>        // return the trim of the value for comparisons
53422>>>>>>>        function_return (trim( (Value(current_object,0)) ))
53423>>>>>>>    end_function
53424>>>>>>>end_class
53425>>>>>>>
53425>>>>>>>
53425>>>>>>>//========================================================================================
53425>>>>>>>//  Name         : StandardToolTip000
53425>>>>>>>//  Purpose      : The standard tool tip class, looks like the normal windows one.
53425>>>>>>>//========================================================================================
53425>>>>>>>class StandardToolTip000 is a ToolPanel
53426>>>>>>>
53426>>>>>>>    //====================================================================================
53426>>>>>>>    //  Name         :
53426>>>>>>>    //  Scope        : PRIVATE
53426>>>>>>>    //  Purpose      :
53426>>>>>>>    //====================================================================================
53426>>>>>>>
53426>>>>>>>    //====================================================================================
53426>>>>>>>    //  Name         : Construct_Object
53426>>>>>>>    //  Scope        : PRIVATE
53426>>>>>>>    //  Purpose      : Augmentation
53426>>>>>>>    //====================================================================================
53426>>>>>>>    procedure Construct_Object
53428>>>>>>>        forward send Construct_Object
53430>>>>>>>        set Border_Style  to BORDER_NORMAL
53431>>>>>>>        set Caption_Bar   to false
53432>>>>>>>        set Visible_State to false
53433>>>>>>>        //set Object_Color  to 4103 4120
53433>>>>>>>        Set Color to 14811135
53434>>>>>>>        Set TextColor to clNavy
53435>>>>>>>
53435>>>>>>>        // our 'text label' for the tool tip.
53435>>>>>>>        object ToolTipLabel is a StandardToolTipLabel000
53437>>>>>>>            set Location     to -2 -2
53438>>>>>>>        end_object
53439>>>>>>>    end_procedure
53440>>>>>>>
53440>>>>>>>    //====================================================================================
53440>>>>>>>    //  Name         : LocateToolTip
53440>>>>>>>    //  Scope        : PRIVATE
53440>>>>>>>    //  Purpose      : locate the tip just below the mouse (at least off the hot spot)
53440>>>>>>>    //====================================================================================
53440>>>>>>>    procedure LocateToolTip
53442>>>>>>>        local string  pnt    //  a TOOLTIP_POINT type
53442>>>>>>>        local pointer pPnt   //  a pointer to a TOOLTIP_POINT type
53442>>>>>>>        local integer xx     //  x location
53442>>>>>>>        local integer yy     //  y location
53442>>>>>>>        local integer cxy cx cy
53442>>>>>>>        Local Integer iYscreensize iXscreensize
53442>>>>>>>
53442>>>>>>>        filltype TOOLTIP_POINT with 0 to pnt
53443>>>>>>>
53443>>>>>>>        GetAddress of pnt to pPnt
53444>>>>>>>
53444>>>>>>>        move (GetCursorPos(pPnt)) to windowindex
53445>>>>>>>
53445>>>>>>>        getbuff from pnt at TOOLTIP_POINT.X to xx
53446>>>>>>>        getbuff from pnt at TOOLTIP_POINT.Y to yy
53447>>>>>>>
53447>>>>>>>        // SPY - 17/11/98
53447>>>>>>>        // If Location of the tooltip is outside of the screen reset the coordinayes
53447>>>>>>>        // Get The screen size
53447>>>>>>>        Moveint (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
53448>>>>>>>>
53448>>>>>>>        Moveint (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
53449>>>>>>>>
53449>>>>>>>        // Get The Tooltip Size
53449>>>>>>>        get client_size to cxy
53450>>>>>>>        move (Hi(cxy)) to cy
53451>>>>>>>        move (Low(cxy)) to cx
53452>>>>>>>        //Reset
53452>>>>>>>        If ((iXscreensize-xx) < cx)       Move (iXscreensize-cx) To xx
53455>>>>>>>        If (((iYscreensize-yy)-50) < cy)  Move (yy-cy-40)        To yy
53458>>>>>>>
53458>>>>>>>        // a bit of hard coding, but what the hell
53458>>>>>>>        set GUILocation to (yy + 20) xx
53459>>>>>>>    end_procedure
53460>>>>>>>
53460>>>>>>>    //====================================================================================
53460>>>>>>>    //  Name         : ShowToolTip
53460>>>>>>>    //  Scope        : PRIVATE
53460>>>>>>>    //  Purpose      : Show the requested tool tip
53460>>>>>>>    //====================================================================================
53460>>>>>>>    procedure ShowToolTip string sTip
53462>>>>>>>        local integer sz
53462>>>>>>>
53462>>>>>>>        // don't do anything, if it is visible AND has the same value!
53462>>>>>>>        if (Visible_State(current_object)) begin
53464>>>>>>>            // we are already visible, so determine if we need to do anything
53464>>>>>>>            if ((ToolTipValue(ToolTipLabel(current_object))) eq sTip) begin
53466>>>>>>>                // we are already showing this one,
53466>>>>>>>                procedure_return
53467>>>>>>>            end
53467>>>>>>>>
53467>>>>>>>        end
53467>>>>>>>>
53467>>>>>>>        send UpdateTip to (ToolTipLabel(current_object)) sTip
53468>>>>>>>
53468>>>>>>>        get Size  of (ToolTipLabel(current_object)) to sz
53469>>>>>>>        //set Size to ((hi(sz)) + 2) ((low(sz)) + 4)
53469>>>>>>>        set Size to ((hi(sz)) - 2) ((low(sz)) - 2)
53470>>>>>>>        send LocateToolTip
53471>>>>>>>        set Visible_State to true
53472>>>>>>>    end_procedure
53473>>>>>>>
53473>>>>>>>    //====================================================================================
53473>>>>>>>    //  Name         : HideToolTip
53473>>>>>>>    //  Scope        : PRIVATE
53473>>>>>>>    //  Purpose      : get rid of the tool tip
53473>>>>>>>    //====================================================================================
53473>>>>>>>    procedure HideToolTip
53475>>>>>>>        set Visible_State to false
53476>>>>>>>        send UpdateTip to (ToolTipLabel(current_object)) ""
53477>>>>>>>        set Location      to -100 -100
53478>>>>>>>    end_procedure
53479>>>>>>>
53479>>>>>>>end_class
53480>>>>>>>
53480>>>>>>>
53480>>>>>>>//========================================================================================
53480>>>>>>>//  Name         : ToolTipTimer000
53480>>>>>>>//  Purpose      : Class of object to control the tool tips.  Timer turns them on and off.
53480>>>>>>>//========================================================================================
53480>>>>>>>
53480>>>>>>>Class ToolTipTimer000 is a DFTimer
53481>>>>>>>
53481>>>>>>>    //====================================================================================
53481>>>>>>>    //  Name         :
53481>>>>>>>    //  Scope        : PRIVATE
53481>>>>>>>    //  Purpose      :
53481>>>>>>>    //====================================================================================
53481>>>>>>>
53481>>>>>>>    //====================================================================================
53481>>>>>>>    //  Name         : Construct_Object
53481>>>>>>>    //  Scope        : PRIVATE
53481>>>>>>>    //  Purpose      : Augmentation
53481>>>>>>>    //====================================================================================
53481>>>>>>>    procedure Construct_Object
53483>>>>>>>        forward send Construct_Object
53485>>>>>>>
53485>>>>>>>        property integer ToolTipVisible    public false  // are we displaying the tool tip
53486>>>>>>>        property integer LastToolTipObject public 0      // what was the last tool tip obj
53487>>>>>>>    end_procedure
53488>>>>>>>
53488>>>>>>>    //====================================================================================
53488>>>>>>>    //  Name         : ShowToolTip
53488>>>>>>>    //  Scope        : PRIVATE
53488>>>>>>>    //  Purpose      : Show the requested tool tip
53488>>>>>>>    //====================================================================================
53488>>>>>>>    procedure ShowToolTip integer ToolTipObject string sTip
53490>>>>>>>        local integer currentTipObj
53490>>>>>>>
53490>>>>>>>        get LastToolTipObject to currentTipObj
53491>>>>>>>        if (ToolTipObject ne currentTipObj) begin
53493>>>>>>>            // the tool tip we want to use is different to the one we used last
53493>>>>>>>            // so turn it off
53493>>>>>>>            if (ToolTipVisible(current_object)) send HideToolTip
53496>>>>>>>        end
53496>>>>>>>>
53496>>>>>>>
53496>>>>>>>        if (ToolTipObject ne 0) begin
53498>>>>>>>            set LastToolTipObject to ToolTipObject
53499>>>>>>>            set ToolTipVisible    to true
53500>>>>>>>
53500>>>>>>>            send ShowToolTip      to ToolTipObject sTip
53501>>>>>>>        end
53501>>>>>>>>
53501>>>>>>>        else send HideToolTip
53503>>>>>>>    end_procedure
53504>>>>>>>
53504>>>>>>>    //====================================================================================
53504>>>>>>>    //  Name         : HideToolTip
53504>>>>>>>    //  Scope        : PRIVATE
53504>>>>>>>    //  Purpose      : get rid of the current tool tip
53504>>>>>>>    //====================================================================================
53504>>>>>>>    procedure HideToolTip
53506>>>>>>>        local integer currentTipObj
53506>>>>>>>        if (ToolTipVisible(current_object)) begin
53508>>>>>>>            get LastToolTipObject to currentTipObj
53509>>>>>>>            send HideToolTip      to currentTipObj
53510>>>>>>>            set ToolTipVisible    to false
53511>>>>>>>        end
53511>>>>>>>>
53511>>>>>>>    end_procedure
53512>>>>>>>
53512>>>>>>>    //====================================================================================
53512>>>>>>>    //  Name         : ChangeTimerInterval
53512>>>>>>>    //  Scope        : PRIVATE
53512>>>>>>>    //  Purpose      : Hook to change timer interval.  This is because PlusPak! cTimer
53512>>>>>>>    //               : must be stopped and started to change the timer interval
53512>>>>>>>    //====================================================================================
53512>>>>>>>    procedure ChangeTimerInterval integer NewInterval
53514>>>>>>>        Set Timeout to NewInterval
53515>>>>>>>    end_procedure
53516>>>>>>>
53516>>>>>>>    //====================================================================================
53516>>>>>>>    //  Name         : CheckHint
53516>>>>>>>    //  Scope        : PRIVATE
53516>>>>>>>    //  Purpose      : check to see if a tool tip should be shown
53516>>>>>>>    //====================================================================================
53516>>>>>>>    procedure CheckHint
53518>>>>>>>        local integer isTipActive
53518>>>>>>>        //local integer showTip
53518>>>>>>>        local integer iobj
53518>>>>>>>        local string  sTip
53518>>>>>>>
53518>>>>>>>        get ToolTipVisible to isTipActive      // are we already displaying ome?
53519>>>>>>>        move (GetDFObjectUnderMouse()) to iObj // what is the current df object
53520>>>>>>>        if (iObj ne 0) begin
53522>>>>>>>            // we have an object
53522>>>>>>>            // get the tool tip string
53522>>>>>>>            //get ShowTooltipHint of iObj to showTip        // do we display a hint
53522>>>>>>>            //if (showTip) get TooltipHint of iObj to sTip  // and what is it
53522>>>>>>>            get TooltipHint of iObj to sTip
53523>>>>>>>        end
53523>>>>>>>>
53523>>>>>>>
53523>>>>>>>        if (isTipActive) begin
53525>>>>>>>            // the tool tip is active, so we either want to turn it off or we've moved to a different object
53525>>>>>>>            if (sTip ne "") begin
53527>>>>>>>                // the tool tip is active and we have something to show
53527>>>>>>>                send ShowToolTip (TooltipHintObject(iObj)) sTip
53528>>>>>>>            end
53528>>>>>>>>
53528>>>>>>>            else begin
53529>>>>>>>                // the tool tip is active and we don't want to show one
53529>>>>>>>                send HideToolTip
53530>>>>>>>                send ChangeTimerInterval 1000
53531>>>>>>>            end
53531>>>>>>>>
53531>>>>>>>        end
53531>>>>>>>>
53531>>>>>>>        else begin
53532>>>>>>>            // the tool tip is not active
53532>>>>>>>            if (sTip ne "") begin
53534>>>>>>>                // the tool tip is not active and we have something to show
53534>>>>>>>                send ShowToolTip (TooltipHintObject(iObj)) sTip
53535>>>>>>>                send ChangeTimerInterval 200 // make the timer check more (smoother transition from object to object)
53536>>>>>>>            end
53536>>>>>>>>
53536>>>>>>>            else begin
53537>>>>>>>                // the tool tip is not active and we don't want to show one
53537>>>>>>>                // nothing to do
53537>>>>>>>            end
53537>>>>>>>>
53537>>>>>>>        end
53537>>>>>>>>
53537>>>>>>>    end_procedure
53538>>>>>>>
53538>>>>>>>    //====================================================================================
53538>>>>>>>    //  Name         : CheckRemoveToolTip
53538>>>>>>>    //  Scope        : PRIVATE
53538>>>>>>>    //  Purpose      : Check to see if we should hide the tool tip, given that it should
53538>>>>>>>    //               : not be there!
53538>>>>>>>    //====================================================================================
53538>>>>>>>    procedure CheckRemoveToolTip
53540>>>>>>>        // if the tool tip is active, then get rid of it.
53540>>>>>>>        if (ToolTipVisible(current_object)) begin
53542>>>>>>>            send HideToolTip
53543>>>>>>>            // SGM : 21/10/1997
53543>>>>>>>            // added this - slow the timer down if we removed it.
53543>>>>>>>            send ChangeTimerInterval 1000
53544>>>>>>>        end
53544>>>>>>>>
53544>>>>>>>    end_procedure
53545>>>>>>>
53545>>>>>>>    //====================================================================================
53545>>>>>>>    //  Name         : MouseIsOverWindow
53545>>>>>>>    //  Scope        : PRIVATE
53545>>>>>>>    //  Purpose      : returns true is the mouse is over this window
53545>>>>>>>    //====================================================================================
53545>>>>>>>    function MouseIsOverWindow handle hWind returns integer
53547>>>>>>>        local string  pnt       // a TOOLTIP_POINT type
53547>>>>>>>        local pointer pPnt      // a pointer to TOOLTIP_POINT
53547>>>>>>>        local string  rect      // a tRECT type
53547>>>>>>>        local pointer pRect     // a pointer to tRECT
53547>>>>>>>        local integer mx        // mouse x
53547>>>>>>>        local integer my        // mouse y
53547>>>>>>>        local integer winLeft   // win left loc
53547>>>>>>>        local integer winTop    // win top loc
53547>>>>>>>        local integer winRight  // win right loc
53547>>>>>>>        local integer winBottom // win bottom loc
53547>>>>>>>
53547>>>>>>>        // get the location of the mouse
53547>>>>>>>        filltype TOOLTIP_POINT with 0 to pnt
53548>>>>>>>        GetAddress of pnt to pPnt
53549>>>>>>>        move (GetCursorPos(pPnt)) to windowindex
53550>>>>>>>        getbuff from pnt at TOOLTIP_POINT.X to mx
53551>>>>>>>        getbuff from pnt at TOOLTIP_POINT.Y to my
53552>>>>>>>
53552>>>>>>>        // get the _real_ origin and extent of the application
53552>>>>>>>        // using DF's Absolute_GuiOrigin returns us the loctions offset by the
53552>>>>>>>        // apps caption bar which just causes too many problems
53552>>>>>>>
53552>>>>>>>        filltype tRECT with 0 to rect
53553>>>>>>>        GetAddress of rect to pRect
53554>>>>>>>        move (GetWindowRect(hWind, pRect)) to windowindex
53555>>>>>>>        getbuff from rect at tRECT.left    to winLeft
53556>>>>>>>        getbuff from rect at tRECT.top     to winTop
53557>>>>>>>        getbuff from rect at tRECT.right   to winRight
53558>>>>>>>        getbuff from rect at tRECT.bottom  to winBottom
53559>>>>>>>
53559>>>>>>>        function_return (((mx gt winLeft) and (mx lt winRight)) and ((my gt winTop) and (my lt winBottom)))
53560>>>>>>>    end_function
53561>>>>>>>
53561>>>>>>>    //====================================================================================
53561>>>>>>>    //  Name         : OnTimer
53561>>>>>>>    //  Scope        : PRIVATE
53561>>>>>>>    //  Purpose      : A timer event has gone, do the checks
53561>>>>>>>    //====================================================================================
53561>>>>>>>    procedure OnTimer
53563>>>>>>>        local handle  hdMain
53563>>>>>>>        local handle  hd
53563>>>>>>>        local integer iFoc iObj ibase
53563>>>>>>>
53563>>>>>>>        // we have to determine if we are the active window because if there is another df app running
53563>>>>>>>        // we will get the df object of the object in the other app if the mouse is located there.
53563>>>>>>>
53563>>>>>>>        // this causes us to get an unresolved object reference because we're trying to talk to an object
53563>>>>>>>        // that isn't even in this program!
53563>>>>>>>
53563>>>>>>>        move (GetActiveWindow())                    to hd      // the active (DF) window.
53564>>>>>>>
53564>>>>>>>        // if the active window handle doesn't equal the window handle of 'main' then we are either dealing
53564>>>>>>>        // with a modal panel (within our app) or some other app has the windows focus.  what we need to
53564>>>>>>>        // do now is get the window handle of the panel that is the parent of the focus and check
53564>>>>>>>        // that against the active window.
53564>>>>>>>
53564>>>>>>>        // get the focus
53564>>>>>>>        get Focus to iFoc
53565>>>>>>>        // get the window handle of the panel that is the parent (or grand.. parent) of the focus.
53565>>>>>>>        get WindowHandleForToolTip of (iFoc) to hdMain             // the handle of the window (panel) that has the focus
53566>>>>>>>
53566>>>>>>>        // do the tests.
53566>>>>>>>        if (hd eq hdMain) begin
53568>>>>>>>            // the active window is the same as the panel with the focus,
53568>>>>>>>            // but is the mouse over the active window?
53568>>>>>>>            if (MouseIsOverWindow(current_object,hd)) begin
53570>>>>>>>                // the window for this app is active and the mouse is actually over the application
53570>>>>>>>                // not a different VDF
53570>>>>>>>                //move (GetDFObjectUnderMouse()) to iObj // what is the current df object
53570>>>>>>>                //If (base_Class(iObj) = 1) Begin
53570>>>>>>>                    //If (Message(iObj,0) = WM_LBUTTONDOWN) Begin
53570>>>>>>>                    //    showln "   " iObj "   " ibase
53570>>>>>>>                    //    send CheckRemoveToolTip
53570>>>>>>>                    //    Set TooltipVisible to True
53570>>>>>>>                    //End
53570>>>>>>>                //End
53570>>>>>>>                // check for tool tip hints
53570>>>>>>>                send CheckHint
53571>>>>>>>            end
53571>>>>>>>>
53571>>>>>>>            else send CheckRemoveToolTip   // remove the tool tip if it is active
53573>>>>>>>        end
53573>>>>>>>>
53573>>>>>>>        else send CheckRemoveToolTip       // remove the tool tip if it is active
53575>>>>>>>
53575>>>>>>>    end_procedure
53576>>>>>>>
53576>>>>>>>
53576>>>>>>>    //====================================================================================
53576>>>>>>>    //  Name         : DisableToolTips
53576>>>>>>>    //  Scope        : PUBLIC
53576>>>>>>>    //  Purpose      : Turn off tool tips
53576>>>>>>>    //====================================================================================
53576>>>>>>>    procedure DisableToolTips
53578>>>>>>>        Set Timer_Active_State to False
53579>>>>>>>    end_procedure
53580>>>>>>>
53580>>>>>>>    //====================================================================================
53580>>>>>>>    //  Name         : EnableToolTips
53580>>>>>>>    //  Scope        : PUBLIC
53580>>>>>>>    //  Purpose      : Turn on tool tips
53580>>>>>>>    //====================================================================================
53580>>>>>>>    procedure EnableToolTips
53582>>>>>>>        Set Timer_Active_State to True
53583>>>>>>>    end_procedure
53584>>>>>>>end_class
53585>>>>>>>
53585>>>>>>>//These Objects now are in Tooltip.inc File that is being included in the End_Construct_Object
53585>>>>>>>//of the dbView_EZ Class - SPY 15/11/78 This Must Be changed
53585>>>>>>>
53585>>>>>>>//object StandardToolTip is a StandardToolTip000
53585>>>>>>>//    move (current_object) to DefaultTooltipHintID
53585>>>>>>>//end_object
53585>>>>>>>
53585>>>>>>>//object ToolTipTimer is a ToolTipTimer000
53585>>>>>>>//    move (current_object) to TooltipControllerID
53585>>>>>>>//end_object
53585>>>>>>>
53585>>>>>Use AccKeymx.ezc
53585>>>>>
53585>>>>>
53585>>>>>Define BPM_RIGHT          for 1
53585>>>>>Define BPM_LEFT           for 2
53585>>>>>Define BPM_TOP            for 3
53585>>>>>Define BPM_BOTTOM         for 4
53585>>>>>
53585>>>>>Class cButtonPopupMenuSub is a DFBaseEditPullDown
53586>>>>>
53586>>>>>    Procedure Construct_Object
53588>>>>>        Forward Send Construct_Object
53590>>>>>        Property Integer piParentWindowHandle (Parent(Self))
53591>>>>>        Property Integer piOrientation BPM_BOTTOM
53592>>>>>        Send Delete_Data
53593>>>>>    End_Procedure // Construct_Object
53594>>>>>
53594>>>>>    Procedure DoPopup
53596>>>>>        // Problem: need to display the menu underneath the button
53596>>>>>        Integer iVoid iLeft iTop iBottom liSize liY liX
53596>>>>>        String sRect
53596>>>>>        Pointer lpsRect
53596>>>>>
53596>>>>>        If (piParentWindowHandle(Self)=0) Procedure_Return
53599>>>>>
53599>>>>>        ZeroType tRect To sRect
53600>>>>>        GetAddress of sRect To lpsRect
53601>>>>>
53601>>>>>        Send Windows_Message of (piParentWindowHandle(self)) TB_GETITEMRECT 0 lpsRect // get bounding rectangle of the button
53602>>>>>
53602>>>>>        GetBuff from sRect at tRect.Bottom To iBottom
53603>>>>>        Put iBottom To sRect at tRect.Top
53604>>>>>
53604>>>>>        Move (ClientToScreen(window_handle(piParentWindowHandle(self)), lpsRect)) To iVoid // convert Client to Screen coordinates
53605>>>>>        GetBuff from sRect at tRect.left To iLeft
53606>>>>>        GetBuff from sRect at tRect.top To iTop
53607>>>>>
53607>>>>>        Get GuiSize of (piParentWindowHandle(Self)) to liSize
53608>>>>>        Move (Hi(liSize))  to liY
53609>>>>>        Move (Low(liSize)) to liX
53610>>>>>        If (piOrientation(self)=BPM_BOTTOM)     Set GuiLocation To (iTop+liY) iLeft
53613>>>>>        Else If (piOrientation(self)=BPM_RIGHT) Set GuiLocation To iTop (iLeft+liX)
53617>>>>>        Send Popup
53618>>>>>    End_Procedure // DoPopup
53619>>>>>
53619>>>>>End_Class // cButtonPopupMenu
53620>>>>>
53620>>>>>Class ButtonSub Is A Button
53621>>>>>
53621>>>>>    Procedure Construct_Object
53623>>>>>        Forward Send Construct_Object
53625>>>>>
53625>>>>>        Property String TooltipValue Public ""
53626>>>>>        Property Integer Private.Disable_State Public False
53627>>>>>        Property Integer MDI_Container Public (Parent(Self))
53628>>>>>        //Set Message Item 0 To Msg_Buttonclicked
53628>>>>>        //Property Integer Calling_Object Public 0
53628>>>>>        // What is the popup Menu
53628>>>>>        Property Integer piPopupMenuId 0
53629>>>>>        //Send Define_DisableAcceleratorKey_Mixin
53629>>>>>
53629>>>>>    End_Procedure
53630>>>>>
53630>>>>>    Procedure End_Construct_Object
53632>>>>>        If (piPopupMenuId(Self)) Set Label to (Label(Self) * ">>")
53635>>>>>        Forward Send End_Construct_Object
53637>>>>>        //Set Focus_Mode to Pointer_Only
53637>>>>>    End_procedure
53638>>>>>
53638>>>>>    Function TooltipHint returns string
53640>>>>>        Function_Return (TooltipValue(Self))
53641>>>>>    End_function
53642>>>>>
53642>>>>>    Procedure Enable_Window integer iState
53644>>>>>        Local integer hWnd
53644>>>>>        Get Window_Handle to hWnd
53645>>>>>        If hWnd Move (EnableWindow(hWnd,iState)) To hWnd
53648>>>>>    End_procedure
53649>>>>>
53649>>>>>    Procedure Set Disable_Not_Shadowed_State Integer iState
53651>>>>>        Set Private.Disable_State to iState
53652>>>>>        Send Enable_Window (1-iState)
53653>>>>>    End_Procedure
53654>>>>>
53654>>>>>    Function Disable_Not_Shadowed_State Returns Integer
53656>>>>>        Function_Return (Private.Disable_State(Self))
53657>>>>>    End_Function
53658>>>>>
53658>>>>>    Procedure OnClick
53660>>>>>        Local Integer bFocus liObjId
53660>>>>>        Get Focus_Mode to bFocus
53661>>>>>        If (bFocus = Pointer_Only) Begin
53663>>>>>            Get MDI_Container to liObjId
53664>>>>>            If (liObjId) Send mouse_down to liObjId
53667>>>>>        End
53667>>>>>>
53667>>>>>    End_Procedure
53668>>>>>
53668>>>>>    Procedure Add_Item Integer aimsg String asLabel
53670>>>>>        Integer liMenuId
53670>>>>>
53670>>>>>        If (piPopupMenuId(Self) = 0) Procedure_Return
53673>>>>>        Get piPopupMenuId to liMenuId
53674>>>>>        Send Add_Item of liMenuId aimsg asLabel
53675>>>>>        Set Aux_Value of liMenuId (Item_Count(Self)-1) To self
53676>>>>>    End_Procedure // Add_Item
53677>>>>>
53677>>>>>    Procedure DoPopupMenu
53679>>>>>        If (piPopupMenuId(Self)) Send DoPopup of (piPopupMenuId(Self))
53682>>>>>    End_Procedure // DoPopupMenu
53683>>>>>
53683>>>>>    Import_Class_Protocol DisableAcceleratorKey_Mixin
53684>>>>>
53684>>>>>End_Class //ButtonSub
53685>>>>>
53685>>>>>
53685>>>
53685>>>
53685>>>Open Clients
53687>>>Open CN
Including file: CN.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\CN.FD)
53689>>>Open CONSTRCT
Including file: CONSTRCT.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\CONSTRCT.FD)
53691>>>Open Salesmen
Including file: Salesmen.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\Salesmen.FD)
53693>>>Open MHXANIK
Including file: MHXANIK.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MHXANIK.FD)
53695>>>Open PAYRESP
Including file: PAYRESP.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\PAYRESP.FD)
53697>>>Open CODEMAST 
53699>>>Open CODETYPE
53701>>>Open BTNORDH
Including file: BTNORDH.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\BTNORDH.FD)
53703>>>Open BTNORDD
Including file: BTNORDD.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\BTNORDD.FD)
53705>>>Open AREAS
Including file: AREAS.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\AREAS.FD)
53707>>>Open CITIES
Including file: CITIES.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\CITIES.FD)
53709>>>Open TOWNS
Including file: TOWNS.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\TOWNS.FD)
53711>>>Open COUNTRY
Including file: COUNTRY.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\COUNTRY.FD)
53713>>>
53713>>>Open MIClient
53715>>>Open MICN
Including file: MICN.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MICN.FD)
53717>>>Open MICONSTR
Including file: MICONSTR.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MICONSTR.FD)
53719>>>Open MISalesm
Including file: MISALESM.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MISALESM.FD)
53721>>>Open MIMHXAN
Including file: MIMHXAN.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MIMHXAN.FD)
53723>>>Open MIPRESP
Including file: MIPRESP.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MIPRESP.FD)
53725>>>Open MICodtyp
Including file: MICODTYP.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MICODTYP.FD)
53727>>>Open MIcodema
Including file: MICODEMA.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MICODEMA.FD)
53729>>>Open MIORDH
Including file: MIORDH.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MIORDH.FD)
53731>>>Open MIORDD
Including file: MIORDD.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MIORDD.FD)
53733>>>Open MIAREAS
Including file: MIAREAS.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MIAREAS.FD)
53735>>>Open MICITIES
Including file: MICITIES.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MICITIES.FD)
53737>>>Open MITOWNS
Including file: MITOWNS.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MITOWNS.FD)
53739>>>Open MICOUNTR
Including file: MICountr.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\MICountr.FD)
53741>>>
53741>>>
53741>>>
53741>>>
53741>>>Activate_View Activate_Migrate101 for Migrate101
53751>>>>
53751>>>
53751>>>Object Migrate101 is a dbView
53753>>>
53753>>>    Set Border_Style to Border_Thick
53754>>>    Set Size to 121 404
53755>>>    Set Location to 7 13
53756>>>
53756>>>    Property Integer piChoice public 0
53758>>>
53758>>>    Set Label to "       "
53759>>>
53759>>>    Procedure Activate_View Returns Integer
53762>>>        Integer rVal
53762>>>        String  sFolderInitial
53762>>>        Set Label to "Test1"
53763>>>
53763>>>        Forward Get Msg_Activate_View to rVal
53765>>>
53765>>>        Open tmplg
Including file: Tmplg.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\Tmplg.FD)
53767>>>        Open tmpPagia
Including file: TMPPAGIA.FD    (L:\VDF14.1.Dev\TITAN_MIGRATE\DDSrc\TMPPAGIA.FD)
53769>>>        
53769>>>        Open tmpPagia Mode DF_EXCLUSIVE
53771>>>        ZeroFile tmpPagia
53772>>>        Open tmpPagia Mode DF_SHARE
53774>>>        
53774>>>        Open tmplg Mode DF_EXCLUSIVE
53776>>>        ZeroFile tmplg
53777>>>        Open tmplg Mode DF_SHARE
53779>>>
53779>>>        Procedure_Return rVal
53780>>>    End_Procedure
53781>>>
53781>>>
53781>>>
53781>>>    Use chartranslate.pkg
Including file: CharTranslate.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\CharTranslate.pkg)
53781>>>>>//*************************************************************************
53781>>>>>//*
53781>>>>>//*  Copyright (c) 2001 Data Access Corporation, Miami Florida,
53781>>>>>//*  All rights reserved.
53781>>>>>//*  DataFlex is a registered trademark of Data Access Corporation.
53781>>>>>//*
53781>>>>>//*************************************************************************
53781>>>>>//*
53781>>>>>//*  Module Name:
53781>>>>>//*      CharTranslate.pkg
53781>>>>>//*
53781>>>>>//*  Creator:
53781>>>>>//*      SF
53781>>>>>//*
53781>>>>>//*
53781>>>>>//*  Purpose:
53781>>>>>//*      Various global functions to translate OEM to UTF.
53781>>>>>//*
53781>>>>>//*************************************************************************
53781>>>>>
53781>>>>>Use Windows.pkg
53781>>>>>
53781>>>>>
53781>>>>>External_Function32 MultiByteToWideChar "MultiByteToWideChar" kernel32.dll;    DWORD dwCodePage;    DWORD dwFlags;    Pointer pMultiByteStr;    Integer cbMultiByte;    Pointer pWideStr;    Integer cchWideChar;    Returns Integer
53782>>>>>
53782>>>>>External_Function32 WideCharToMultiByte "WideCharToMultiByte" kernel32.dll;    DWORD dwCodePage;    DWORD dwFlags;    Pointer pWideStr;    Integer cchWideChar;    Pointer pMultiByteStr;    Integer cbMultiByte;    Pointer pDefaultChar;    Pointer pUsedDefaultChar;    Returns Integer
53783>>>>>
53783>>>>>//dwCodePage = Multi Byte Code Page to convert from
53783>>>>>//pMultiBuf  = Pointer to Multi Byte string
53783>>>>>//iLen       = Length in bytes of Multi Byte string
53783>>>>>//ppWideBuf  = Contents of ppWideBuf contains a pointer to the destination buffer on return
53783>>>>>Function MultiToWideBuffer Global DWORD dwCodePage Address pMultiBuf Integer iLen Address ppWideBuf Returns Integer
53785>>>>>    Integer iWideSize
53785>>>>>    Integer iVoid
53785>>>>>    Address pWideBuf
53785>>>>>    Move (MultiByteToWideChar(dwCodePage,0,pMultiBuf,iLen,0,0)) to iWideSize
53786>>>>>    If (iWideSize=0);        Function_Return 0
53789>>>>>    Move (Alloc((iWideSize+1)*2)) to pWideBuf
53790>>>>>    If (pWideBuf=0);        Function_Return 0
53793>>>>>    Move (MultiByteToWideChar(dwCodePage,0,pMultiBuf,iLen,pWideBuf,iWideSize)) to iWideSize
53794>>>>>    If (iWideSize=0) ;        Move (Free(pWideBuf)) to iVoid
53797>>>>>    else begin
53798>>>>>        Move (StoreW(pWideBuf,(iWideSize*2),0)) to iVoid
53799>>>>>        Move (StoreDW(ppWideBuf,0,pWideBuf)) to iVoid
53800>>>>>    end
53800>>>>>>
53800>>>>>    Function_Return iWideSize
53801>>>>>End_Function
53802>>>>>
53802>>>>>//dwCodePage = Multi Byte Code Page to convert to
53802>>>>>//pWideBuf   = Pointer to Wide Character string
53802>>>>>//iLen       = Length in characters of Wide Character string
53802>>>>>//ppMultiBuf = Contents of ppMultiBuf contains a pointer to the destination buffer on return
53802>>>>>Function WideToMultiBuffer Global DWORD dwCodePage Address pWideBuf Integer iLen Address ppMultiBuf Returns Integer
53804>>>>>    Integer iMultiSize
53804>>>>>    Address pMultiBuf
53804>>>>>    Integer iVoid
53804>>>>>    Move (WideCharToMultiByte(dwCodePage,0,pWideBuf,iLen,0,0,0,0)) to iMultiSize
53805>>>>>    If (iMultiSize=0);        Function_Return 0
53808>>>>>    Move (Alloc(iMultiSize+1)) to pMultiBuf
53809>>>>>    If (pMultiBuf=0);        Function_Return 0
53812>>>>>    Move (WideCharToMultiByte(dwCodePage,0,pWideBuf,iLen,pMultiBuf,iMultiSize,0,0)) to iMultiSize
53813>>>>>    If (iMultiSize=0) ;        Move (Free(pMultiBuf)) to iVoid
53816>>>>>    else begin
53817>>>>>        Move (StoreC(pMultiBuf,iMultiSize,0)) to iVoid
53818>>>>>        Move (StoreDW(ppMultiBuf,0,pMultiBuf)) to iVoid
53819>>>>>    end
53819>>>>>>
53819>>>>>    Function_Return iMultiSize
53820>>>>>End_Function
53821>>>>>
53821>>>>>//Converts a UTF-8 string to OEM
53821>>>>>//pUtf8Buf   = Pointer to UTF-8 string
53821>>>>>//iLen       = Length of UTF-8 string in bytes
53821>>>>>//Returns pointer to OEM string, use free() to deallocate buffer when it's no longer needed
53821>>>>>Function Utf8ToOemBuffer Global Address pUtf8Buf Integer iLen Returns Address
53823>>>>>    Address pWideBuf
53823>>>>>    Address pOemBuf
53823>>>>>    Integer iWideBufLen
53823>>>>>    Integer iMultiBufLen
53823>>>>>    Integer iVoid
53823>>>>>    Move 0 to pWideBuf
53824>>>>>    Move 0 to pOemBuf
53825>>>>>    Move (MultiToWideBuffer(CP_UTF8,pUtf8Buf,iLen,AddressOf(pWideBuf))) to iWideBufLen
53826>>>>>    If (iWideBufLen=0);        Function_Return 0
53829>>>>>    Move (WideToMultiBuffer(CP_OEMCP,pWideBuf,iWideBufLen,AddressOf(pOemBuf))) to iMultiBufLen
53830>>>>>    Move (Free(pWideBuf)) to iVoid
53831>>>>>    Function_Return pOemBuf
53832>>>>>End_Function
53833>>>>>
53833>>>>>//Converts a OEM string to UTF-8
53833>>>>>//pOemBuf    = Pointer to OEM string
53833>>>>>//iLen       = Length of OEM string in bytes
53833>>>>>//Returns pointer to UTF-8 string, use free() to deallocate buffer when it's no longer needed
53833>>>>>Function OemToUtf8Buffer Global Address pOemBuf Integer iLen Returns Address
53835>>>>>    Address pWideBuf
53835>>>>>    Address pUtf8Buf
53835>>>>>    Integer iWideBufLen
53835>>>>>    Integer iMultiBufLen
53835>>>>>    Integer iVoid
53835>>>>>    Move 0 to pWideBuf
53836>>>>>    Move 0 to pUtf8Buf
53837>>>>>    Move (MultiToWideBuffer(CP_OEMCP,pOemBuf,iLen,AddressOf(pWideBuf))) to iWideBufLen
53838>>>>>    If (iWideBufLen=0);        Function_Return 0
53841>>>>>    Move (WideToMultiBuffer(CP_UTF8,pWideBuf,iWideBufLen,AddressOf(pUtf8Buf))) to iMultiBufLen
53842>>>>>    Move (Free(pWideBuf)) to iVoid
53843>>>>>    Function_Return pUtf8Buf
53844>>>>>End_Function
53845>>>
53845>>>    Function Utf8ToOemString Global String sUtf8String Returns String
53847>>>        Address aString
53847>>>        String sOemString
53847>>>        Boolean bVoid
53847>>>        //Move (Utf8ToOemBuffer(sUtf8String, CStringLength(sUtf8String))) to aString
53847>>>        Move (Utf8ToOemBuffer(AddressOf(sUtf8String), CStringLength(sUtf8String))) to aString
53848>>>        Move aString to sOemString
53849>>>        Move (Free(aString)) to bVoid
53850>>>        Function_Return sOemString
53851>>>    End_Function
53852>>>
53852>>>    Function OemToUtf8String Global String sUtf8String Returns String
53854>>>        Address aString
53854>>>        String sOemString
53854>>>        Boolean bVoid
53854>>>        //Move (OemToUtf8Buffer(sUtf8String, CStringLength(sUtf8String))) to aString
53854>>>        Move (OemToUtf8Buffer(AddressOf(sUtf8String), CStringLength(sUtf8String))) to aString
53855>>>        Move aString to sOemString
53856>>>        Move (Free(aString)) to bVoid
53857>>>        Function_Return sOemString
53858>>>    End_Function
53859>>>
53859>>>    Object btnSub1 is a Button
53861>>>        Set Size to 20 383
53862>>>        Set Location to 50 11
53863>>>        Set Label to " 1"
53864>>>
53864>>>        Procedure OnClick
53867>>>            Integer iFileNumber iFields iField_Type
53867>>>            String  sFullName sFileName sStr sPedio sLabel sName
53867>>>
53867>>>            Get Label to sLabel
53868>>>
53868>>>            Move Clients.File_Number to iFileNumber
53869>>>            Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
53872>>>            Clear Clients
53873>>>            Move 1 to Clients.EXPORTFLAG
53874>>>            Find GE Clients by Index.12
53875>>>>
53875>>>            While ((Found) and (Clients.EXPORTFLAG=1))
53879>>>                Set Label to ("Updating Clients.... "+Trim(Clients.Client_ID))
53880>>>                
53880>>>                String sClientCode sClientPresp
53880>>>                Move Clients.CLIENT_ID to sClientCode
53881>>>                
53881>>>                Clear MICLIENT
53882>>>                Move Clients.CLIENT_AFM to MIClient.CLIENT_AFM
53883>>>                Find GE MICLIENT by Index.8
53884>>>>
53884>>>                If ((Found) and (MIClient.CLIENT_AFM=Clients.CLIENT_AFM)) Begin
53886>>>                    Move MIClient.CLIENT_ID to sClientCode
53887>>>                    Move MIClient.PRESP_ID  to sClientPresp
53888>>>                End
53888>>>>
53888>>>                Else Begin
53889>>>                    Clear MIClient
53890>>>                    For FieldIndex from 0 to iFields
53896>>>>
53896>>>                        Move (Trim(Clients.Recnum&)) to MIClient.Recnum&
53897>>>                    Loop
53898>>>>
53898>>>                    SaveRecord MIClient
53899>>>                    Move Clients.CLIENT_ID to sClientCode
53900>>>                    Move Clients.PRESP_ID  to sClientPresp
53901>>>                End
53901>>>>
53901>>>
53901>>>
53901>>>
53901>>>
53901>>>
53901>>>                Find GT Clients by Index.12
53902>>>>
53902>>>            Loop
53903>>>>
53903>>>
53903>>>            
53903>>>//            Move CN.File_Number to iFileNumber
53903>>>//            Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
53903>>>//            Clear CN
53903>>>//            Move 1 to CN.EXPORTFLAG
53903>>>//            Find GE CN by Index.9
53903>>>//            While ((Found) and (CN.EXPORTFLAG=1))
53903>>>//                Set Label to ("Updating CN.... "+Trim(CN.CN_Code))
53903>>>//                Clear MICN
53903>>>//                For FieldIndex from 0 to iFields
53903>>>//                    Get_Attribute DF_FIELD_NAME of iFileNumber FieldIndex to sName
53903>>>//                    //Showln (String(FieldIndex)) "   " (Trim(sName)) "    "  (Trim(CN.Recnum&))
53903>>>//                    Move (Trim(CN.Recnum&)) to MICN.Recnum&
53903>>>//                Loop
53903>>>//                SaveRecord MICN
53903>>>//                Find GT CN by Index.9
53903>>>//            Loop
53903>>>
53903>>>            Move CN.File_Number to iFileNumber
53904>>>            Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
53907>>>            Clear CN
53908>>>            Find GE CN.Recnum
53909>>>>
53909>>>            While (Found) 
53913>>>                Set Label to ("Updating CN.... "+Trim(CN.CN_Code))
53914>>>                If (CN.EXPORTFLAG=1) Begin
53916>>>                    Clear MICN
53917>>>                    For FieldIndex from 0 to iFields
53923>>>>
53923>>>                        Get_Attribute DF_FIELD_NAME of iFileNumber FieldIndex to sName
53926>>>                        Move (Trim(CN.Recnum&)) to MICN.Recnum&
53927>>>                    Loop
53928>>>>
53928>>>                    SaveRecord MICN
53929>>>                End
53929>>>>
53929>>>                Find GT CN.Recnum
53930>>>>
53930>>>            Loop
53931>>>>
53931>>>
53931>>>
53931>>>
53931>>>            Move Constrct.File_Number to iFileNumber
53932>>>            Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
53935>>>            Clear Constrct
53936>>>            Move 1 to Constrct.EXPORTFLAG
53937>>>            Find GE Constrct by Index.6
53938>>>>
53938>>>            While ((Found) and (Constrct.EXPORTFLAG=1))
53942>>>                Set Label to ("Updating Constrct.... "+Trim(Constrct.CNT_ID))
53943>>>                Clear MIConstr
53944>>>                For FieldIndex from 0 to iFields
53950>>>>
53950>>>                    Move (Trim(Constrct.Recnum&)) to MIConstr.Recnum&
53951>>>                Loop
53952>>>>
53952>>>                SaveRecord MIConstr
53953>>>                Find GT Constrct by Index.6
53954>>>>
53954>>>            Loop
53955>>>>
53955>>>
53955>>>
53955>>>            Move Mhxanik.File_Number to iFileNumber
53956>>>            Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
53959>>>            Clear Mhxanik
53960>>>            Move 1 to Mhxanik.EXPORTFLAG
53961>>>            Find GE Mhxanik by Index.5
53962>>>>
53962>>>            While ((Found) and (Mhxanik.EXPORTFLAG=1))
53966>>>                Set Label to ("Updating Mhxanik.... "+Trim(Mhxanik.Mhx_ID))
53967>>>                Clear MIMhxan
53968>>>                For FieldIndex from 0 to iFields
53974>>>>
53974>>>                    Move (Trim(Mhxanik.Recnum&)) to MIMhxan.Recnum&
53975>>>                Loop
53976>>>>
53976>>>                SaveRecord MIMhxan
53977>>>                Find GT Mhxanik by Index.5
53978>>>>
53978>>>            Loop
53979>>>>
53979>>>
53979>>>
53979>>>            Move Payresp.File_Number to iFileNumber
53980>>>            Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
53983>>>            Clear Payresp
53984>>>            Move 1 to Payresp.EXPORTFLAG
53985>>>            Find GE Payresp by Index.9
53986>>>>
53986>>>            While ((Found) and (Payresp.EXPORTFLAG=1))
53990>>>                Set Label to ("Updating Payresp.... "+Trim(Payresp.Presp_ID))
53991>>>                Clear MIPresp
53992>>>                For FieldIndex from 0 to iFields
53998>>>>
53998>>>                    Move (Trim(Payresp.Recnum&)) to MIPresp.Recnum&
53999>>>                Loop
54000>>>>
54000>>>                SaveRecord MIPresp
54001>>>                Find GT Payresp by Index.9
54002>>>>
54002>>>            Loop
54003>>>>
54003>>>
54003>>>
54003>>>            Move Salesmen.File_Number to iFileNumber
54004>>>            Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
54007>>>            Clear Salesmen
54008>>>            Move 1 to Salesmen.EXPORTFLAG
54009>>>            Find GE Salesmen by Index.5
54010>>>>
54010>>>            While ((Found) and (Salesmen.EXPORTFLAG=1))
54014>>>                Set Label to ("Updating Salesmen.... "+Trim(Salesmen.SLS_ID))
54015>>>                Clear MISalesm
54016>>>                For FieldIndex from 0 to iFields
54022>>>>
54022>>>                    Move (Trim(Salesmen.Recnum&)) to MISalesm.Recnum&
54023>>>                Loop
54024>>>>
54024>>>                SaveRecord MISalesm
54025>>>                Find GT Salesmen by Index.5
54026>>>>
54026>>>            Loop
54027>>>>
54027>>>
54027>>>
54027>>>        End_Procedure // OnClick
54028>>>
54028>>>    End_Object
54029>>>
54029>>>    Object oButtonSub1 is a ButtonSub
54031>>>        Set Size to 14 95
54032>>>        Set Location to 102 151
54033>>>        Set Label to "Clear all data"
54034>>>            //AB-StoreStart
54034>>>            Procedure OnClick
54037>>>                Open MIClient   Mode DF_EXCLUSIVE
54039>>>                Open MICN       Mode DF_EXCLUSIVE
54041>>>                Open MICONSTR   Mode DF_EXCLUSIVE
54043>>>                Open MISalesm   Mode DF_EXCLUSIVE
54045>>>                Open MIMHXAN    Mode DF_EXCLUSIVE
54047>>>                Open MIPRESP    Mode DF_EXCLUSIVE
54049>>>                
54049>>>                ZeroFile MICLIENT
54050>>>                ZeroFile MICN
54051>>>                ZeroFile MIConstr
54052>>>                ZeroFile MISalesm
54053>>>                ZeroFile MIMhxan
54054>>>                ZeroFile MIPresp
54055>>>    
54055>>>                Open MIClient   Mode DF_SHARE
54057>>>                Open MICN       Mode DF_SHARE
54059>>>                Open MICONSTR   Mode DF_SHARE
54061>>>                Open MISalesm   Mode DF_SHARE
54063>>>                Open MIMHXAN    Mode DF_SHARE
54065>>>                Open MIPRESP    Mode DF_SHARE
54067>>>            End_Procedure // OnClick
54068>>>            //AB-StoreEnd
54068>>>    End_Object
54069>>>
54069>>>
54069>>>    //////////////////////////////////
54069>>>    // NEW BUTTON Yannis 26/07/2017 //
54069>>>    //////////////////////////////////
54069>>>    Object btnSub2 is a Button
54071>>>        Set Size to 20 383
54072>>>        Set Location to 70 11
54073>>>        Set Label to " 2"
54074>>>
54074>>>
54074>>>        Procedure OnClick
54077>>>            String sFilename sLabel sClientCode sClientRecr 
54077>>>            Integer bIsCreated
54077>>>            Integer iWhat iVal
54077>>>            Get Label to sLabel
54078>>>        
54078>>>            Integer iCnt iFS iExportFlag iRecn
54078>>>            Move 0 to iCnt
54079>>>            File_Size Clients to iFS
54082>>>            String sMess sExportStatus 
54082>>>            Date dExportDate
54082>>>        
54082>>>            Clear Clients
54083>>>            Move 1 to Clients.ExportFlag
54084>>>            Find GE Clients by Index.12
54085>>>>
54085>>>            While ((Found) and (Clients.ExportFlag=1))
54089>>>                Add 1 to iCnt
54090>>>                // Keep values
54090>>>                Move Clients.EXPORTFLAG     to iExportFlag
54091>>>                Move Clients.EXPORTSTATUS   to sExportStatus
54092>>>                Move Clients.EXPORTDATE     to dExportDate
54093>>>                Move Clients.Recnum         to iRecn
54094>>>                //                
54094>>>                Move ("Clients... "+String(iCnt)) to sMess
54095>>>                Set Label to sMess
54096>>>        
54096>>>                Send ReadClient
54097>>>
54097>>>                // Restore values
54097>>>                Clear Clients
54098>>>                Move iExportFlag    to Clients.EXPORTFLAG
54099>>>                Move sExportStatus  to Clients.EXPORTSTATUS
54100>>>                Move dExportDate    to Clients.EXPORTDATE
54101>>>                Move iRecn          to Clients.Recnum
54102>>>                //                
54102>>>
54102>>>                Find GT Clients by Index.12
54103>>>>
54103>>>            Loop
54104>>>>
54104>>>
54104>>>            
54104>>>            Move 0 to iCnt
54105>>>            Clear CN
54106>>>            Move 1 to CN.ExportFlag
54107>>>            Find GE CN by Index.9
54108>>>>
54108>>>            While ((Found) and (CN.ExportFlag=1))
54112>>>                Add 1 to iCnt
54113>>>                // Keep values
54113>>>                Move CN.EXPORTFLAG     to iExportFlag
54114>>>                Move CN.EXPORTSTATUS   to sExportStatus
54115>>>                Move CN.EXPORTDATE     to dExportDate
54116>>>                Move CN.Recnum         to iRecn
54117>>>                //                
54117>>>                Move ("CN... "+String(iCnt)) to sMess
54118>>>                Set Label to sMess
54119>>>        
54119>>>                Clear CLIENTS
54120>>>                Move CN.CLIENT_ID to Clients.CLIENT_ID
54121>>>                Find Eq CLIENTS by Index.6
54122>>>>
54122>>>                Clear MICLient
54123>>>                Move Clients.CLIENT_AFM to MIClient.CLIENT_AFM
54124>>>                Find GE MICLIENT by Index.8
54125>>>>
54125>>>                
54125>>>                If (not ((Found) and (MIClient.CLIENT_AFM=Clients.CLIENT_AFM)) ) Begin
54127>>>                    Send Stop_Box ("Found CN = "+CN.CN_CODE+"  But not MIClient AFM = "+Clients.CLIENT_AFM) "Error 3001"
54128>>>                    Procedure_Return
54129>>>                End
54129>>>>
54129>>>                
54129>>>                Move MICLient.CLient_ID to sClientCode
54130>>>                Send readCN CN.CN_Code ;                            MIClient.CLIENT_ID ;                            MIClient.CLIENT_RECR
54131>>>
54131>>>                // Restore values
54131>>>                Clear CN
54132>>>                Move iExportFlag    to CN.EXPORTFLAG
54133>>>                Move sExportStatus  to CN.EXPORTSTATUS
54134>>>                Move dExportDate    to CN.EXPORTDATE
54135>>>                Move iRecn          to CN.Recnum
54136>>>                //                
54136>>>                Find GT CN by Index.9
54137>>>>
54137>>>            Loop
54138>>>>
54138>>>
54138>>>
54138>>>            Set Label to sLabel
54139>>>            Send Info_Box "Process Finished" "Information"
54140>>>        End_Procedure // OnClick
54141>>>        
54141>>>        
54141>>>        Procedure ReadClient
54144>>>            String  sClientID sDeli sPrespID sLabel sAFM sClientCode sClientPresp
54144>>>            Integer iCheckAFM iRecnum
54144>>>
54144>>>            Integer iFileNumber iFields iField_Type
54144>>>            String  sFullName sFileName sStr sPedio sName
54144>>>
54144>>>            Get Label to sLabel
54145>>>
54145>>>            //========================
54145>>>            // Tsekaroyme ton Pelath
54145>>>            Move Clients.File_Number to iFileNumber
54146>>>            Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
54149>>>            Clear MIClient
54150>>>            Move Clients.Client_AFM to MIClient.Client_AFM
54151>>>            Find GE MICLIENT by Index.8
54152>>>>
54152>>>            If ((Found) and (MIClient.Client_AFM=Clients.Client_AFM)) Begin
54154>>>                // An yparxei pelaths me idio AFM pou epexergasthkame
54154>>>                // prohgoymena tote that xrhsimopoihsoume ta stoixeia
54154>>>                // aytou tou pelath, kai s' ayton tha desoume kai ta erga
54154>>>                Move MIClient.CLIENT_ID to sClientCode
54155>>>                Move MIClient.PRESP_ID  to sClientPresp
54156>>>                //
54156>>>                //
54156>>>            End
54156>>>>
54156>>>            Else Begin
54157>>>                // An DEN yparxei pelaths me idio AFM tote ton anoigoyme
54157>>>                Clear MIClient
54158>>>                For FieldIndex from 0 to iFields
54164>>>>
54164>>>                    Move (Trim(Clients.Recnum&)) to MIClient.Recnum&
54165>>>                Loop
54166>>>>
54166>>>                SaveRecord MIClient
54167>>>                Move MIClient.CLIENT_ID to sClientCode
54168>>>                Move MIClient.PRESP_ID  to sClientPresp
54169>>>            End
54169>>>>
54169>>>            
54169>>>            //========================
54169>>>            // Tsekaroyme ton Payresp
54169>>>            Move Payresp.File_Number to iFileNumber
54170>>>            Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
54173>>>            Clear MIPresp
54174>>>            Move sClientPresp to MIPresp.PRESP_ID
54175>>>            Find EQ MIPresp by Index.7
54176>>>>
54176>>>            If (not(Found)) Begin
54178>>>                Clear MIPresp
54179>>>                For FieldIndex from 0 to iFields
54185>>>>
54185>>>                    Move (Trim(Payresp.Recnum&)) to MIPresp.Recnum&
54186>>>                Loop
54187>>>>
54187>>>                SaveRecord MIPresp
54188>>>            End
54188>>>>
54188>>>
54188>>>         
54188>>>
54188>>>//            Clear Areas
54188>>>//            Move Clients.Client_Area to Areas.Area_id
54188>>>//            Find Eq Areas by Index.1
54188>>>//            Clear MIDHMOS
54188>>>//            Move (Trim(Areas.Area_Descr)) to MIDHMOS.Dhmos
54188>>>//            Find EQ MIDHMOS by Index.1
54188>>>//            If (Found)  Move (Trim(MIDHMOS.Dhmos))  to s1
54188>>>//            Else Begin
54188>>>//                Set psNotFoundClientDhmos to ("*** (Y) "+Trim(Areas.Area_Descr))
54188>>>//                Move "ZZZZ"               to s1
54188>>>//            End
54188>>>//
54188>>>//            Clear Cities
54188>>>//            Move Clients.Client_City_ID to cities.City_id
54188>>>//            Find Eq Cities by Index.1
54188>>>//            Clear MINOMOS
54188>>>//            Move (Trim(Cities.City_Descr)) to MINOMOS.DESCR
54188>>>//            Find EQ MINOMOS by Index.2
54188>>>//            If (Found)  Move (Trim(MINOMOS.CODE)) to s1
54188>>>//            Else Begin
54188>>>//                Set psNotFoundClientNomos to ("*** (AA) "+Trim(Cities.City_Descr))
54188>>>//                Move "ZZZZ"               to s1
54188>>>//            End
54188>>>//
54188>>>//            Clear Codemast
54188>>>//            Move "JOB"              to Codemast.Type
54188>>>//            Move Clients.Client_Job to Codemast.Code
54188>>>//            Find Eq Codemast by Index.1
54188>>>//            Clear MIDRAST
54188>>>//            Move (Trim(Codemast.Description)) to MIDRAST.Descr
54188>>>//            Find Eq MIDRAST by Index.2
54188>>>//            If (Found) Move MIDRAST.Code to s1
54188>>>//            Else Begin
54188>>>//                Set psNotFoundClientDrast to ("*** (AI) "+Trim(Codemast.Description))
54188>>>//                Move "ZZZZ" to s1
54188>>>//            End
54188>>>
54188>>>        
54188>>>            // Aparaithth epanatopothethsh sto geniko loop
54188>>>            // ton pelaton bash recnum afou endexetai na allaxame
54188>>>            // trexon recod pelath and to afm tou yparxei hdh se allo pelath
54188>>>            Clear Clients
54189>>>            Move iRecnum to Clients.Recnum
54190>>>            Find Eq Clients.Recnum
54191>>>>
54191>>>        
54191>>>        End_Procedure
54192>>>        
54192>>>        
54192>>>        
54192>>>        Procedure ReadCN String asCNCode String asActualClientID String asActualClientRecr
54195>>>        
54195>>>            String sSLS sCNT sMHX
54195>>>        
54195>>>            Clear CN
54196>>>            Move asCNCode to CN.CN_CODE
54197>>>            Find EQ CN by Index.5
54198>>>>
54198>>>            If ((Found) and (CN.EXPORTFLAG=1)) Begin
54200>>>                Clear MICLIENT
54201>>>                Move asActualClientID to MIClient.CLIENT_ID
54202>>>                Find Eq MICLIENT by Index.6
54203>>>>
54203>>>                If (not(Found)) Begin
54205>>>                    Send Stop_Box ("Found CN = "+CN.CN_CODE+"  But MIClient ID is UNKNOWN ID = "+asActualClientID) "Error 30021"
54206>>>                    Procedure_Return
54207>>>                End
54207>>>>
54207>>>            End
54207>>>>
54207>>>            Else Begin
54208>>>                Send Stop_Box ("CANNOT FIND CN = "+asCNCode) "Error 3003"
54209>>>                Procedure_Return
54210>>>            End
54210>>>>
54210>>>
54210>>>
54210>>>        
54210>>>//
54210>>>//            asActualClientRecr
54210>>>//
54210>>>//            Move MIClient.Client_ID     to CN.Client_ID
54210>>>//            Move Cn.Cn_Rec0              to CN.Cn_SN
54210>>>//            Move Cn.Client_id            to Cn.Cn_clientid
54210>>>//            Move Cn.cn_code              to Cn.Cn_Repmatch
54210>>>//            Move Cn.Cn_Code              to Cn.Constraction_ID
54210>>>//            Move PayResp.Presp_ID        to Cn.Cn_Presp_ID
54210>>>//            Move Salesmen.Sls_ID         to Cn.Cn_Sls_ID
54210>>>//            Move Constrct.Cnt_ID         to Cn.Cn_Cnt_ID
54210>>>//            Move mhxanik.mhx_id          to Cn.mhxanik_ID
54210>>>//
54210>>>//        
54210>>>//        
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   (Trim(CN.CN_Code))
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column C  ?????? ????? ?????? ?????
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   (Trim(CN.Client_ID))
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column D  ???. ??????
54210>>>//                    Write   channel 9   sDeli // End of Excel Column E  ?? ??????? ?? ? ??????? ?????? ?? ??? Operational Customer, ???? Operational ??????? ? ???????
54210>>>//                    Write   channel 9   sDeli // End of Excel Column F  ?? ??????? ?? ? ??????? ?????? ?? ??? Operational Customer, ???? Operational ??????? ? ???????
54210>>>//                    Write   channel 9   sDeli // End of Excel Column G  ?? ??????? ?? ? ??????? ?????? ?? ??? Operational Customer, ???? Operational ??????? ? ???????
54210>>>//        
54210>>>//                    Clear Constrct
54210>>>//                    Move CN.CN_Cnt_Recr to Constrct.Cnt_Recr
54210>>>//                    Find Eq Constrct by Index.2
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   (Trim(Constrct.Cnt_ID))
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column H  ??????? ? ????????? & ??????????? ? ?????? ?? ??? ??????????? ??? ?????? "Customer Master Records_GR Others"
54210>>>//        
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   (Trim(CN.Mhxanik_ID))
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column I  ??????? ? ???????? & ??????????? ? ?????? ?? ??? ??????????? ??? ?????? "Customer Master Records_GR Others"
54210>>>//        
54210>>>//                    Clear Salesmen
54210>>>//                    Move CN.CN_Sls_Recr to Salesmen.Sls_Recr
54210>>>//                    Find Eq Salesmen by Index.2
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   (Trim(Salesmen.Sls_ID))
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column J  ??????? ? ?????? & ??????????? ? ?????? ?? ??? ??????????? ??? ?????? ????????? ??????
54210>>>//        
54210>>>//                    Move (Trim(Salesmen.Sls_ID))    to sSLS
54210>>>//                    Move (Trim(Constrct.Cnt_ID))    to sCNT
54210>>>//                    Move (Trim(CN.Mhxanik_ID))      to sMHX
54210>>>//        
54210>>>//        
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   'GR02'
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column K  ?????? ??????? ???????
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   'GR02'
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column L ????????? ???????? ???????
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   '03'
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column M ????? ???????
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   '04'
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column N ????? (Segment)
54210>>>//                    Write   channel 9   sDeli // End of Excel Column O  ?????? ????? ????????
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   (Trim(Left(CN.CN_Descr,35)))
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column P  ???????? ?????
54210>>>//                    String s1
54210>>>//                    Move "" to s1
54210>>>//                    If (Trim(Mid(CN.CN_Descr,35,36))<>"") Move ('"'+Trim(Mid(CN.CN_Descr,35,36))+'"') to s1
54210>>>//                    Write   channel 9   (Trim(s1))
54210>>>//                    Write   channel 9   sDeli // End of Excel Column Q  ???????????? ???? ?? ??????? ?? ????? ??? ????? Name 1 ??? ???? ??????
54210>>>//                    Move "" to s1
54210>>>//                    If (Trim(Mid(CN.CN_Descr,35,71))<>"") Move ('"'+Trim(Mid(CN.CN_Descr,35,71))+'"') to s1
54210>>>//                    Write   channel 9   (Trim(s1))
54210>>>//                    Write   channel 9   sDeli // End of Excel Column R  ?????? ??????? ?????
54210>>>//                    Write   channel 9   sDeli // End of Excel Column S
54210>>>//                    Write   channel 9   sDeli // End of Excel Column T  ???????? ???????? ????? - ??????????? ?? ??????? ?????????
54210>>>//                    Write   channel 9   sDeli // End of Excel Column U  ???????? ???????? ????? ? ?????? ??????? - ??????????? ?? ??????? ?????????
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   (Trim(CN.CN_Address))
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column V  ???? ?????
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   (Trim(CN.CN_add_no))
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column W  ??????
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   (Trim(CN.CN_Zipcode))
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column X  ?.?.
54210>>>//        
54210>>>//                    //If (CN.CN_Code="01.AC.03565") Begin
54210>>>//                    //    Showln "01.AC.03565"
54210>>>//                    //End
54210>>>//        
54210>>>//                    Move "" to s1
54210>>>//                    Clear Areas
54210>>>//                    Move CN.CN_Area to Areas.Area_id
54210>>>//                    Find Eq Areas by Index.1
54210>>>//                    Clear MIDHMOS
54210>>>//                    Move (Trim(Areas.Area_Descr)) to MIDHMOS.Dhmos
54210>>>//                    Find EQ MIDHMOS by Index.1
54210>>>//                    If (Found)  Move (Trim(MIDHMOS.Dhmos))  to s1
54210>>>//                    Else Begin
54210>>>//                        Set psNotFoundErgoDhmos to ("*** (Y) "+Trim(Areas.Area_Descr))
54210>>>//                        Move "ZZZZ"             to s1
54210>>>//                    End
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   s1
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column Y  ?????
54210>>>//        
54210>>>//                    Move "GR" to s1
54210>>>//                    String sIsGreece
54210>>>//                    Move s1 to sIsGreece
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   (Trim(s1))
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column Z  ???
54210>>>//        
54210>>>//                    Move "" to s1
54210>>>//                    Clear Cities
54210>>>//                    Move CN.CN_City to cities.City_id
54210>>>//                    Find Eq Cities by Index.1
54210>>>//                    Clear MINOMOS
54210>>>//                    Move (Trim(Cities.City_Descr)) to MINOMOS.DESCR
54210>>>//                    Find EQ MINOMOS by Index.2
54210>>>//                    If (Found)  Move (Trim(MINOMOS.CODE)) to s1
54210>>>//                    Else Begin
54210>>>//                        Set psNotFoundErgoNomos to ("*** (AA) "+Trim(Cities.City_Descr))
54210>>>//                        Move "ZZZZ"             to s1
54210>>>//                    End
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   s1
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column AA ?????
54210>>>//                    Write   channel 9   sDeli // End of Excel Column AB ??????? ???????
54210>>>//                    Write   channel 9   sDeli // End of Excel Column AC ??????
54210>>>//                    Write   channel 9   sDeli // End of Excel Column AD ???????? ????? (?????????? ?????????? ????????? ??? sheet Communication)
54210>>>//                    Write   channel 9   sDeli // End of Excel Column AE "????? ????? (?????????? ?????????? ?????? ??? sheet Communication)
54210>>>//                    Write   channel 9   sDeli // End of Excel Column AF Fax ????? (?????????? ?????????? fax ??? sheet Communication)
54210>>>//                    Write   channel 9   sDeli // End of Excel Column AG Email ????? (?????????? ?????????? e-mail ??? sheet Communication)
54210>>>//                    Write   channel 9   sDeli // End of Excel Column AH ??????????? ? reference ?????? ????????? ??? ? ?????? ???? ?? ??????????
54210>>>//                    Write   channel 9   sDeli // End of Excel Column AI ???????????? ?????
54210>>>//                    Write   channel 9   sDeli // End of Excel Column AJ "??? ????????? ?? GR ??????
54210>>>//                    Write   channel 9   sDeli // End of Excel Column AK EL+??? ????????? ?? ?????? ????????? ??????
54210>>>//                    Write   channel 9   sDeli // End of Excel Column AL ??????? ???????
54210>>>//        
54210>>>//                    Clear Branch
54210>>>//                    Move CN.Company_Code    to Branch.Company_Code
54210>>>//                    Move CN.Branch_Code     to Branch.Branch_Code
54210>>>//                    Find Eq Branch by Index.1
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   (Trim(Branch.Branch_Resp))
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column AM Sales Office
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   (Trim(Branch.Branch_Bitmap))
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column AN Sales Group
54210>>>//                    Write   channel 9   sDeli // End of Excel Column AO Customer Group ????????? / ????????
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   'EUR'
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column AP ?????? ??????
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   '1'
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column AQ ?????????? ??? ???????? ??????????
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   '1'
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column AR ?????????? ??? ????? ????????? ?????
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   '11'
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column AS ??????? ????????
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   (Trim(Branch.Branch_Email))
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column AT ????????? ??????????
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   'X'
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column AU ??????????? ??? ? ???????? ?????????? ???????????? ?? ??? ?????
54210>>>//                    Write   channel 9   sDeli // End of Excel Column AV Incoterms
54210>>>//                    Write   channel 9   sDeli // End of Excel Column AW ??? ????????
54210>>>//                    Write   channel 9   sDeli // End of Excel Column A ?????????? ?? ??? ????????? ?????????? ??????
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   'GR'
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column AY ??? ???????????
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   'MWST'
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column A? ????????? ?????
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   '0'
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli // End of Excel Column ?A ????????????? ?????
54210>>>//                    Write   channel 9   sDeli // End of Excel Column ?B ??. ????????
54210>>>//                    Write   channel 9   sDeli // End of Excel Column ?C ?????? ?????????
54210>>>//                    Write   channel 9   sDeli // End of Excel Column ?D ???????? ??????????
54210>>>//        
54210>>>//                    Move "" to s1
54210>>>//                    Date dHm
54210>>>//                    Move "31/12/2100" to dHm
54210>>>//                    Clear BtnOrdH
54210>>>//                    Move asClientID     to BtnOrdH.Client_ID
54210>>>//                    Move CN.CN_Code     to BtnOrdH.CN_Code
54210>>>//                    Move dHm            to BtnOrdH.Deop_Lhxh
54210>>>//                    Move "ZZZZZZZZZZ"   to BtnOrdH.AA_Deop
54210>>>//                    Move "ZZZZZZZZZZ"   to BtnOrdH.Recr
54210>>>//                    Find LE BtnOrdH by Index.6
54210>>>//                    If ((Found) and (BtnOrdH.Client_ID=asClientID) and (BtnOrdH.CN_Code=CN.CN_Code)) Begin
54210>>>//                        Move ('"'+String(Btnordh.Eleiph)+'"') to s1
54210>>>//                    End
54210>>>//                    Write   channel 9   (Trim(s1))
54210>>>//                    Write   channel 9   sDeli // End of Excel Column ?E ?????? ??????
54210>>>//        
54210>>>//                    Write   channel 9   sDeli // End of Excel Column ?F ?????? ???????? ?????????
54210>>>//                    Write   channel 9   sDeli // End of Excel Column ?G ?????? ????? ??????
54210>>>//                    Write   channel 9   sDeli // End of Excel Column ?H ??. ????? ?????
54210>>>//                    Write   channel 9   sDeli // End of Excel Column ?I ??. ????? ?????
54210>>>//                    Write   channel 9   sDeli // End of Excel Column ?J ?????????? ?????????
54210>>>//                    Write   channel 9   sDeli // End of Excel Column ?K ?????????? ?????? ?? ?????? cash flow
54210>>>//                    Write   channel 9   sDeli // End of Excel Column ?L ????????? ???????? - ???????????. ??????????? ?? ??? ?? ???? (header Ship - to) ?? ?? ???? (ship - to)
54210>>>//                    Write   channel 9   sDeli // End of Excel Column ?M ??????? ??????? ???
54210>>>//                    Write   channel 9   sDeli // End of Excel Column ?N
54210>>>//                    //---
54210>>>//        
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   (Trim(psNotFoundErgoDhmos(Self)))
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli
54210>>>//        
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   (Trim(psNotFoundErgoNomos(Self)))
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli
54210>>>//        
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   (Trim(psNotFoundErgoTrPlh(Self)))
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   sDeli
54210>>>//        
54210>>>//                    Write   channel 9   '"'
54210>>>//                    Write   channel 9   (Trim(psNotFoundErgoDrast(Self)))
54210>>>//                    Write   channel 9   '"'
54210>>>//                    //Write   Channel 9   sDeli
54210>>>//        
54210>>>//                    //---
54210>>>//                    Writeln channel 9
54210>>>//        
54210>>>//        
54210>>>//                    Send Output_Others
54210>>>        
54210>>>//                End // If (CN.Exportflag=1)
54210>>>        
54210>>>//                Find GT CN by Index.4 // Client_ID+CN_Code
54210>>>//            Loop
54210>>>        End_Procedure
54211>>>        
54211>>>        
54211>>>//        Procedure Output_Others
54211>>>//            String sDeli s1
54211>>>//            Move "," to sDeli
54211>>>//        
54211>>>//            Set psNotFoundMhxanDhmos to ""
54211>>>//            Set psNotFoundMhxanNomos to ""
54211>>>//            Set psNotFoundMhxanDrast to ""
54211>>>//            Set psNotFoundMhxanTrPlh to ""
54211>>>//        
54211>>>//            Set psNotFoundConstrDhmos to ""
54211>>>//            Set psNotFoundConstrNomos to ""
54211>>>//            Set psNotFoundConstrDrast to ""
54211>>>//            Set psNotFoundConstrTrPlh to ""
54211>>>//        
54211>>>//            Set psNotFoundSalesDhmos to ""
54211>>>//            Set psNotFoundSalesNomos to ""
54211>>>//            Set psNotFoundSalesDrast to ""
54211>>>//            Set psNotFoundSalesTrPlh to ""
54211>>>//        
54211>>>//            If (CN.Mhxanik_ID<>"") Begin
54211>>>//                Clear Mhxanik
54211>>>//                Move CN.Mhxanik_ID to Mhxanik.Mhx_ID
54211>>>//                Find Eq Mhxanik by Index.4
54211>>>//                If (Found) Begin
54211>>>//                    Clear tmpPagia
54211>>>//                    Move "02"           to tmpPagia.Company_Code
54211>>>//                    Move CN.Mhxanik_ID  to tmpPagia.Pagia_Code
54211>>>//                    Find Eq tmpPagia by Index.1
54211>>>//                    If (not(Found)) Begin
54211>>>//                        SaveRecord tmpPagia
54211>>>//                        //---
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   '02'
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   sDeli // End of Excel Column B  ????? ?????????? (.?. ??????, Ship - to ??)
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   (Trim(Mhxanik.Mhx_ID))
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   sDeli // End of Excel Column C  ?????? ????? ?????? ????? SAP
54211>>>//                        Write   channel 7   sDeli // End of Excel Column D  ??????????? ?? ???? Ship - to
54211>>>//                        Write   channel 7   sDeli // End of Excel Column E  ?? ??????? ?? ? ??????? ?????? ?? ??? Operational Customer, ???? Operational ??????? ? ???????
54211>>>//                        Write   channel 7   sDeli // End of Excel Column F  ?? ??????? ?? ? ??????? ?????? ?? ??? Operational Customer, ???? Operational ??????? ? ???????
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   (Trim(Left(Mhxanik.Mhx_Name,35)))
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   sDeli // End of Excel Column G  ????? ?. ????
54211>>>//                        Move "" to s1
54211>>>//                        If (Trim(Mid(Mhxanik.Mhx_Name,35,36))<>"") Move ('"'+Trim(Mid(Mhxanik.Mhx_Name,35,36))+'"') to s1
54211>>>//                        Write   channel 7   (Trim(s1))
54211>>>//                        Write   channel 7   sDeli // End of Excel Column H  ???????????? ???? ?? ??????? ?? ????? ??? ????? Name 1 ??? ???? ??????
54211>>>//                        Write   channel 7   sDeli // End of Excel Column I  ??????? ? ???????? & ??????????? ? ?????? ?? ??? ??????????? ??? ?????? "Customer Master Records_GR Others"
54211>>>//                        Write   channel 7   sDeli // End of Excel Column J  ??????? ? ?????? & ??????????? ? ?????? ?? ??? ??????????? ??? ?????? ????????? ??????
54211>>>//        
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   (Trim(Mhxanik.Mhx_Address))
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   sDeli // End of Excel Column K  ???? ?????
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   (Trim(Mhxanik.Mhx_add_no))
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   sDeli // End of Excel Column L  ??????
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   (Trim(Mhxanik.Mhx_Zipcode))
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   sDeli // End of Excel Column M  ?.?.
54211>>>//        
54211>>>//                        Move "" to s1
54211>>>//                        Clear Areas
54211>>>//                        Move Mhxanik.Mhx_Area to Areas.Area_id
54211>>>//                        Find Eq Areas by Index.1
54211>>>//                        Clear MIDHMOS
54211>>>//                        Move (Trim(Areas.Area_Descr)) to MIDHMOS.Dhmos
54211>>>//                        Find EQ MIDHMOS by Index.1
54211>>>//                        If (Found)  Move (Trim(MIDHMOS.Dhmos))  to s1
54211>>>//                        Else Begin
54211>>>//                            Set psNotFoundMhxanDhmos to ("*** (N) "+Trim(Areas.Area_Descr))
54211>>>//                            Move "ZZZZ"              to s1
54211>>>//                        End
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   s1
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   sDeli // End of Excel Column N  ?????
54211>>>//        
54211>>>//                        Move "GR" to s1
54211>>>//                        String sIsGreece
54211>>>//                        Move s1 to sIsGreece
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   (Trim(s1))
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   sDeli // End of Excel Column O  ???
54211>>>//        
54211>>>//        
54211>>>//                        Move "" to s1
54211>>>//                        Clear Cities
54211>>>//                        Move Mhxanik.Mhx_City to cities.City_id
54211>>>//                        Find Eq Cities by Index.1
54211>>>//                        Clear MINOMOS
54211>>>//                        Move (Trim(Cities.City_Descr)) to MINOMOS.DESCR
54211>>>//                        Find EQ MINOMOS by Index.2
54211>>>//                        If (Found)  Move (Trim(MINOMOS.CODE)) to s1
54211>>>//                        Else Begin
54211>>>//                            Set psNotFoundMhxanNomos to ("*** (P) "+Trim(Cities.City_Descr))
54211>>>//                            Move "ZZZZ"              to s1
54211>>>//                        End
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   s1
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   sDeli // End of Excel Column P
54211>>>//                        Write   channel 7   sDeli // End of Excel Column Q
54211>>>//                        Write   channel 7   sDeli // End of Excel Column R
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   (Trim(Mhxanik.Mhx_Phone))
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   sDeli // End of Excel Column S
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   (Trim(Mhxanik.Mhx_Mobile))
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   sDeli // End of Excel Column T
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   (Trim(Mhxanik.Mhx_Fax))
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   sDeli // End of Excel Column U
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   (Trim(Mhxanik.Mhx_Email))
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   sDeli // End of Excel Column V
54211>>>//                        Write   channel 7   sDeli // End of Excel Column W
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   (Trim(Mhxanik.Mhx_AFM))
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   sDeli // End of Excel Column X
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   ("EL"+Trim(Mhxanik.Mhx_AFM))
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   sDeli // End of Excel Column Y
54211>>>//                        Write   channel 7   sDeli // End of Excel Column Z
54211>>>//                        Write   channel 7   sDeli // End of Excel Column AA
54211>>>//                        //---
54211>>>//        
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   (Trim(psNotFoundMhxanDhmos(Self)))
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   sDeli
54211>>>//        
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   (Trim(psNotFoundMhxanNomos(Self)))
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   sDeli
54211>>>//        
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   (Trim(psNotFoundMhxanTrPlh(Self)))
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   sDeli
54211>>>//        
54211>>>//                        Write   channel 7   '"'
54211>>>//                        Write   channel 7   (Trim(psNotFoundMhxanDrast(Self)))
54211>>>//                        Write   channel 7   '"'
54211>>>//                        //Write   Channel 7   sDeli
54211>>>//        
54211>>>//                        //---
54211>>>//                        Writeln channel 7
54211>>>//                    End // If not found tmpPagia
54211>>>//                End // If (Found) Begin
54211>>>//            End // If (CN.Mhxanik_ID<>"") Begin
54211>>>//        
54211>>>//        
54211>>>//        
54211>>>//            If (CN.CN_CNT_ID<>"") Begin
54211>>>//                Clear Constrct
54211>>>//                Move CN.CN_CNT_ID to Constrct.CNT_ID
54211>>>//                Find Eq Constrct by Index.5
54211>>>//                If (Found) Begin
54211>>>//                    //---
54211>>>//                    Clear tmpPagia
54211>>>//                    Move "03"           to tmpPagia.Company_Code
54211>>>//                    Move CN.CN_CNT_ID   to tmpPagia.Pagia_Code
54211>>>//                    Find Eq tmpPagia by Index.1
54211>>>//                    If (not(Found)) Begin
54211>>>//                        SaveRecord tmpPagia
54211>>>//                        //---
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   '03'
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   sDeli // End of Excel Column B  ????? ?????????? (.?. ??????, Ship - to ??)
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   (Trim(Constrct.CNT_ID))
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   sDeli // End of Excel Column C  ?????? ????? ?????? ????? SAP
54211>>>//                        Write   channel 8   sDeli // End of Excel Column D  ??????????? ?? ???? Ship - to
54211>>>//                        Write   channel 8   sDeli // End of Excel Column E  ?? ??????? ?? ? ??????? ?????? ?? ??? Operational Customer, ???? Operational ??????? ? ???????
54211>>>//                        Write   channel 8   sDeli // End of Excel Column F  ?? ??????? ?? ? ??????? ?????? ?? ??? Operational Customer, ???? Operational ??????? ? ???????
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   (Trim(Left(Constrct.CNT_Name,35)))
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   sDeli // End of Excel Column G  ????? ?. ????
54211>>>//                        Move "" to s1
54211>>>//                        If (Trim(Mid(Constrct.CNT_Name,35,36))<>"") Move ('"'+Trim(Mid(Constrct.CNT_Name,35,36))+'"') to s1
54211>>>//                        Write   channel 8   (Trim(s1))
54211>>>//                        Write   channel 8   sDeli // End of Excel Column H  ???????????? ???? ?? ??????? ?? ????? ??? ????? Name 1 ??? ???? ??????
54211>>>//                        Write   channel 8   sDeli // End of Excel Column I  ??????? ? ???????? & ??????????? ? ?????? ?? ??? ??????????? ??? ?????? "Customer Master Records_GR Others"
54211>>>//                        Write   channel 8   sDeli // End of Excel Column J  ??????? ? ?????? & ??????????? ? ?????? ?? ??? ??????????? ??? ?????? ????????? ??????
54211>>>//        
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   (Trim(Constrct.CNT_Address))
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   sDeli // End of Excel Column K  ???? ?????
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   (Trim(Constrct.CNT_add_no))
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   sDeli // End of Excel Column L  ??????
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   (Trim(Constrct.CNT_Zipcode))
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   sDeli // End of Excel Column M  ?.?.
54211>>>//        
54211>>>//                        Move "" to s1
54211>>>//                        Clear Areas
54211>>>//                        Move Constrct.CNT_Area to Areas.Area_id
54211>>>//                        Find Eq Areas by Index.1
54211>>>//                        Clear MIDHMOS
54211>>>//                        Move (Trim(Areas.Area_Descr)) to MIDHMOS.Dhmos
54211>>>//                        Find EQ MIDHMOS by Index.1
54211>>>//                        If (Found)  Move (Trim(MIDHMOS.Dhmos))  to s1
54211>>>//                        Else Begin
54211>>>//                            Set psNotFoundConstrDhmos to ("*** (N) "+Trim(Areas.Area_Descr))
54211>>>//                            Move "ZZZZ"              to s1
54211>>>//                        End
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   s1
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   sDeli // End of Excel Column N  ?????
54211>>>//        
54211>>>//                        Move "GR" to s1
54211>>>//                        Move s1 to sIsGreece
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   (Trim(s1))
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   sDeli // End of Excel Column O  ???
54211>>>//        
54211>>>//                        Move "" to s1
54211>>>//                        Clear Cities
54211>>>//                        Move Constrct.CNT_City to cities.City_id
54211>>>//                        Find Eq Cities by Index.1
54211>>>//                        Clear MINOMOS
54211>>>//                        Move (Trim(Cities.City_Descr)) to MINOMOS.DESCR
54211>>>//                        Find EQ MINOMOS by Index.2
54211>>>//                        If (Found)  Move (Trim(MINOMOS.CODE)) to s1
54211>>>//                        Else Begin
54211>>>//                            Set psNotFoundConstrNomos to ("*** (P) "+Trim(Cities.City_Descr))
54211>>>//                            Move "ZZZZ"              to s1
54211>>>//                        End
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   s1
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   sDeli // End of Excel Column P
54211>>>//                        Write   channel 8   sDeli // End of Excel Column Q
54211>>>//                        Write   channel 8   sDeli // End of Excel Column R
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   (Trim(Constrct.CNT_Phone))
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   sDeli // End of Excel Column S
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   (Trim(Constrct.CNT_Mobile))
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   sDeli // End of Excel Column T
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   (Trim(Constrct.CNT_Fax))
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   sDeli // End of Excel Column U
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   (Trim(Constrct.CNT_Email))
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   sDeli // End of Excel Column V
54211>>>//                        Write   channel 8   sDeli // End of Excel Column W
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   (Trim(Constrct.CNT_AFM))
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   sDeli // End of Excel Column X
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   ("EL"+Trim(Constrct.CNT_AFM))
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   sDeli // End of Excel Column Y
54211>>>//                        Write   channel 8   sDeli // End of Excel Column Z
54211>>>//                        Write   channel 8   sDeli // End of Excel Column AA
54211>>>//                        //---
54211>>>//        
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   (Trim(psNotFoundConstrDhmos(Self)))
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   sDeli
54211>>>//        
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   (Trim(psNotFoundConstrNomos(Self)))
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   sDeli
54211>>>//        
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   (Trim(psNotFoundConstrTrPlh(Self)))
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   sDeli
54211>>>//        
54211>>>//                        Write   channel 8   '"'
54211>>>//                        Write   channel 8   (Trim(psNotFoundConstrDrast(Self)))
54211>>>//                        Write   channel 8   '"'
54211>>>//                        //Write   Channel 8   sDeli
54211>>>//        
54211>>>//                        //---
54211>>>//                        Writeln channel 8
54211>>>//                    End // If not found tmpPagia
54211>>>//                End // If (Found) Begin
54211>>>//            End // If (CN.CN_CNT_ID<>"") Begin
54211>>>//        
54211>>>//        
54211>>>//        
54211>>>//            If (CN.CN_SLS_ID<>"") Begin
54211>>>//                Clear Salesmen
54211>>>//                Move CN.CN_SLS_ID to Salesmen.SLS_ID
54211>>>//                Find Eq Salesmen by Index.4
54211>>>//                If (Found) Begin
54211>>>//                    //---
54211>>>//                    Clear tmpPagia
54211>>>//                    Move "04"           to tmpPagia.Company_Code
54211>>>//                    Move CN.CN_SLS_ID   to tmpPagia.Pagia_Code
54211>>>//                    Find Eq tmpPagia by Index.1
54211>>>//                    If (not(Found)) Begin
54211>>>//                        SaveRecord tmpPagia
54211>>>//                        //---
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   '04'
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   sDeli // End of Excel Column B  ????? ?????????? (.?. ??????, Ship - to ??)
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   (Trim(Salesmen.SLS_ID))
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   sDeli // End of Excel Column C  ?????? ????? ?????? ????? SAP
54211>>>//                        Write   channel 6   sDeli // End of Excel Column D  ??????????? ?? ???? Ship - to
54211>>>//                        Write   channel 6   sDeli // End of Excel Column E  ?? ??????? ?? ? ??????? ?????? ?? ??? Operational Customer, ???? Operational ??????? ? ???????
54211>>>//                        Write   channel 6   sDeli // End of Excel Column F  ?? ??????? ?? ? ??????? ?????? ?? ??? Operational Customer, ???? Operational ??????? ? ???????
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   (Trim(Left(Salesmen.SLS_Name,35)))
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   sDeli // End of Excel Column G  ????? ?. ????
54211>>>//                        Move "" to s1
54211>>>//                        If (Trim(Mid(Salesmen.SLS_Name,35,36))<>"") Move ('"'+Trim(Mid(Salesmen.SLS_Name,35,36))+'"') to s1
54211>>>//                        Write   channel 6   (Trim(s1))
54211>>>//                        Write   channel 6   sDeli // End of Excel Column H  ???????????? ???? ?? ??????? ?? ????? ??? ????? Name 1 ??? ???? ??????
54211>>>//                        Write   channel 6   sDeli // End of Excel Column I  ??????? ? ???????? & ??????????? ? ?????? ?? ??? ??????????? ??? ?????? "Customer Master Records_GR Others"
54211>>>//                        Write   channel 6   sDeli // End of Excel Column J  ??????? ? ?????? & ??????????? ? ?????? ?? ??? ??????????? ??? ?????? ????????? ??????
54211>>>//        
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   (Trim(Salesmen.SLS_Address))
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   sDeli // End of Excel Column K  ???? ?????
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   (Trim(Salesmen.SLS_add_no))
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   sDeli // End of Excel Column L  ??????
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   (Trim(Salesmen.SLS_Zipcode))
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   sDeli // End of Excel Column M  ?.?.
54211>>>//        
54211>>>//                        Move "" to s1
54211>>>//                        Clear Areas
54211>>>//                        Move Salesmen.SLS_Area to Areas.Area_id
54211>>>//                        Find Eq Areas by Index.1
54211>>>//                        Clear MIDHMOS
54211>>>//                        Move (Trim(Areas.Area_Descr)) to MIDHMOS.Dhmos
54211>>>//                        Find EQ MIDHMOS by Index.1
54211>>>//                        If (Found)  Move (Trim(MIDHMOS.Dhmos))  to s1
54211>>>//                        Else Begin
54211>>>//                            Set psNotFoundSalesDhmos to ("*** (N) "+Trim(Areas.Area_Descr))
54211>>>//                            Move "ZZZZ"              to s1
54211>>>//                        End
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   s1
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   sDeli // End of Excel Column N  ?????
54211>>>//        
54211>>>//                        Move "GR" to s1
54211>>>//                        Move s1 to sIsGreece
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   (Trim(s1))
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   sDeli // End of Excel Column O  ???
54211>>>//        
54211>>>//                        Move "" to s1
54211>>>//                        Clear Cities
54211>>>//                        Move Salesmen.SLS_City to cities.City_id
54211>>>//                        Find Eq Cities by Index.1
54211>>>//                        Clear MINOMOS
54211>>>//                        Move (Trim(Cities.City_Descr)) to MINOMOS.DESCR
54211>>>//                        Find EQ MINOMOS by Index.2
54211>>>//                        If (Found)  Move (Trim(MINOMOS.CODE)) to s1
54211>>>//                        Else Begin
54211>>>//                            Set psNotFoundSalesNomos to ("*** (P) "+Trim(Cities.City_Descr))
54211>>>//                            Move "ZZZZ"              to s1
54211>>>//                        End
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   s1
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   sDeli // End of Excel Column P
54211>>>//                        Write   channel 6   sDeli // End of Excel Column Q
54211>>>//                        Write   channel 6   sDeli // End of Excel Column R
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   (Trim(Salesmen.SLS_Phone))
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   sDeli // End of Excel Column S
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   (Trim(Salesmen.SLS_Mobile))
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   sDeli // End of Excel Column T
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   (Trim(Salesmen.SLS_Fax))
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   sDeli // End of Excel Column U
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   (Trim(Salesmen.SLS_Email))
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   sDeli // End of Excel Column V
54211>>>//                        Write   channel 6   sDeli // End of Excel Column W
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   (Trim(Salesmen.SLS_AFM))
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   sDeli // End of Excel Column X
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   ("EL"+Trim(Salesmen.SLS_AFM))
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   sDeli // End of Excel Column Y
54211>>>//                        Write   channel 6   sDeli // End of Excel Column Z
54211>>>//                        Write   channel 6   sDeli // End of Excel Column AA
54211>>>//                        //---
54211>>>//        
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   (Trim(psNotFoundSalesDhmos(Self)))
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   sDeli
54211>>>//        
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   (Trim(psNotFoundSalesNomos(Self)))
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   sDeli
54211>>>//        
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   (Trim(psNotFoundSalesTrPlh(Self)))
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   sDeli
54211>>>//        
54211>>>//                        Write   channel 6   '"'
54211>>>//                        Write   channel 6   (Trim(psNotFoundSalesDrast(Self)))
54211>>>//                        Write   channel 6   '"'
54211>>>//                        //Write   Channel 6   sDeli
54211>>>//        
54211>>>//                        //---
54211>>>//                        Writeln channel 6
54211>>>//                    End // If not found tmpPagia
54211>>>//                End // If (Found) Begin
54211>>>//            End // If (CN.CN_SLS_ID<>"") Begin
54211>>>//        
54211>>>//        
54211>>>//        End_Procedure
54211>>>        
54211>>>
54211>>>
54211>>>    End_Object
54212>>>
54212>>>    Object btnTestRW is a Button  
54214>>>        Set Size to 20 383
54215>>>        Set Location to 10 10
54216>>>        Set Label to "Read Clients SMS Server PIS2003  >>  Write CLients Server PISDEV"
54217>>>
54217>>>        Procedure OnClick
54220>>>            Integer iFileNumber iFields iField_Type
54220>>>            String  sFullName sFileName sStr sPedio sLabel sName
54220>>>
54220>>>            Get Label to sLabel
54221>>>
54221>>>
54221>>>            Clear MICLIENT
54222>>>            Find GE MICLIENT by Index.1
54223>>>>
54223>>>            While (Found)
54227>>>                Set Label to ("Deleting Old MiClient records... "+Trim(MiClient.CLIENT_NAME))
54228>>>                Delete MICLIENT
54229>>>                Find GT MICLIENT by Index.1
54230>>>>
54230>>>            Loop
54231>>>>
54231>>>    
54231>>>    Pause 24 00 "DELETION DONE.... Check Database"
54234>>>    
54234>>>            Move Clients.File_Number to iFileNumber
54235>>>            Get_Attribute DF_FILE_NUMBER_FIELDS of iFileNumber to iFields
54238>>>            Clear Clients
54239>>>            Move 1 to Clients.EXPORTFLAG
54240>>>            Find GE Clients by Index.12
54241>>>>
54241>>>            While ((Found) and (Clients.EXPORTFLAG=1))
54245>>>                Set Label to ("Updating Clients.... "+Trim(Clients.Client_ID))
54246>>>                
54246>>>                String sClientCode sClientPresp
54246>>>                Move Clients.CLIENT_ID to sClientCode
54247>>>                
54247>>>                Clear MICLIENT
54248>>>                Move Clients.CLIENT_AFM to MIClient.CLIENT_AFM
54249>>>                Find GE MICLIENT by Index.8
54250>>>>
54250>>>                If ((Found) and (MIClient.CLIENT_AFM=Clients.CLIENT_AFM)) Begin
54252>>>                    Move MIClient.CLIENT_ID to sClientCode
54253>>>                    Move MIClient.PRESP_ID  to sClientPresp
54254>>>                End
54254>>>>
54254>>>                Else Begin
54255>>>                    Clear MIClient
54256>>>                    For FieldIndex from 0 to iFields
54262>>>>
54262>>>                        Move (Trim(Clients.Recnum&)) to MIClient.Recnum&
54263>>>                    Loop
54264>>>>
54264>>>                    SaveRecord MIClient
54265>>>                    Move Clients.CLIENT_ID to sClientCode
54266>>>                    Move Clients.PRESP_ID  to sClientPresp
54267>>>                End
54267>>>>
54267>>>                Find GT Clients by Index.12
54268>>>>
54268>>>            Loop
54269>>>>
54269>>>
54269>>>            Set Label to sLabel
54270>>>
54270>>>        End_Procedure // OnClick
54271>>>
54271>>>    End_Object
54272>>>
54272>>>End_Object
54273>>>
54273>>>//AB/ End_Object    // prj
54273>
54273>        //------
54273>    End_Object
54274>    
54274>End_Object
54275>
54275>
54275>Send Activate_Migrate101 of (oClientArea(oMain))
54276>Start_UI
54277>
Summary
Memory Available: 1736130559
Total Warnings : 0
Total Errors   : 0
Total Symbols  : 31959
Total Resources: 0
Total Commands : 54276
Total Windows  : 1
Total Pages    : 1
Static Data    : 362877
Message area   : 338085
Total Blocks   : 19811
